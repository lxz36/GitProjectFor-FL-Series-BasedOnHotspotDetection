#clients of iccad2012: 2
#clients of asml1: 2
select ratio: 1.0
Total num clients: 4
client model path: ['models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0', 'models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1', 'models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0', 'models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (24958, 144, 26)
Resampled dataset to size (32814, 144, 26)
Using transform option: train
#pos = 17102, #neg = 15712
Allocated dataset with size (24958, 144, 26)
Resampled dataset to size (32737, 144, 26)
Using transform option: train
#pos = 17179, #neg = 15558
loading data into the main memory...
Allocated dataset with size (9150, 144, 26)
Resampled dataset to size (16703, 144, 26)
Using transform option: train
#pos = 8134, #neg = 8569
Allocated dataset with size (9150, 144, 26)
Resampled dataset to size (16626, 144, 26)
Using transform option: train
#pos = 8099, #neg = 8527
loading data into the main memory...
Allocated dataset with size (24958, 144, 26)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 26)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36223 | Reg=0.00353 | acc=0.4219 | L2-Norm=18.784 | L2-Norm(final)=1.995 | 3100.9 samples/s | 48.5 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.34525 | Reg=0.00353 | acc=0.6250 | L2-Norm=18.784 | L2-Norm(final)=1.998 | 6265.0 samples/s | 97.9 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.34342 | Reg=0.00353 | acc=0.5000 | L2-Norm=18.784 | L2-Norm(final)=2.004 | 6162.1 samples/s | 96.3 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.34005 | Reg=0.00353 | acc=0.7656 | L2-Norm=18.784 | L2-Norm(final)=2.015 | 6222.3 samples/s | 97.2 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.33796 | Reg=0.00353 | acc=0.5781 | L2-Norm=18.784 | L2-Norm(final)=2.034 | 6019.4 samples/s | 94.1 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.33562 | Reg=0.00353 | acc=0.5469 | L2-Norm=18.784 | L2-Norm(final)=2.058 | 6151.5 samples/s | 96.1 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.33431 | Reg=0.00353 | acc=0.6875 | L2-Norm=18.784 | L2-Norm(final)=2.086 | 6214.3 samples/s | 97.1 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.33286 | Reg=0.00353 | acc=0.5625 | L2-Norm=18.784 | L2-Norm(final)=2.115 | 6142.7 samples/s | 96.0 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.33166 | Reg=0.00353 | acc=0.6094 | L2-Norm=18.784 | L2-Norm(final)=2.144 | 6219.8 samples/s | 97.2 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.33012 | Reg=0.00353 | acc=0.6562 | L2-Norm=18.784 | L2-Norm(final)=2.173 | 6253.5 samples/s | 97.7 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.32867 | Reg=0.00353 | acc=0.6250 | L2-Norm=18.784 | L2-Norm(final)=2.204 | 7840.4 samples/s | 122.5 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.0] | Loss=0.32695 | Reg=0.00353 | acc=0.6250 | L2-Norm=18.784 | L2-Norm(final)=2.517 | 4298.4 samples/s | 67.2 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.28698 | Reg=0.00341 | acc=0.8438 | L2-Norm=18.478 | L2-Norm(final)=2.523 | 4848.3 samples/s | 75.8 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.24482 | Reg=0.00338 | acc=0.7969 | L2-Norm=18.375 | L2-Norm(final)=2.544 | 4843.9 samples/s | 75.7 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.22128 | Reg=0.00335 | acc=0.7969 | L2-Norm=18.312 | L2-Norm(final)=2.559 | 4839.6 samples/s | 75.6 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.20169 | Reg=0.00334 | acc=0.9062 | L2-Norm=18.266 | L2-Norm(final)=2.569 | 4836.3 samples/s | 75.6 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.19005 | Reg=0.00332 | acc=0.9219 | L2-Norm=18.232 | L2-Norm(final)=2.582 | 4890.7 samples/s | 76.4 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.17995 | Reg=0.00331 | acc=0.9219 | L2-Norm=18.206 | L2-Norm(final)=2.591 | 4799.4 samples/s | 75.0 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.17258 | Reg=0.00331 | acc=0.8906 | L2-Norm=18.186 | L2-Norm(final)=2.599 | 4894.0 samples/s | 76.5 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.16560 | Reg=0.00330 | acc=0.9219 | L2-Norm=18.170 | L2-Norm(final)=2.606 | 4786.5 samples/s | 74.8 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.15933 | Reg=0.00330 | acc=0.9531 | L2-Norm=18.158 | L2-Norm(final)=2.611 | 4837.9 samples/s | 75.6 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.15292 | Reg=0.00329 | acc=0.8438 | L2-Norm=18.149 | L2-Norm(final)=2.618 | 5872.9 samples/s | 91.8 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.14674 | Reg=0.00329 | acc=0.9219 | L2-Norm=18.142 | L2-Norm(final)=2.625 | 2083.2 samples/s | 32.6 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.14147 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.137 | L2-Norm(final)=2.631 | 4835.8 samples/s | 75.6 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.13695 | Reg=0.00329 | acc=0.9062 | L2-Norm=18.133 | L2-Norm(final)=2.638 | 4835.2 samples/s | 75.6 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.13258 | Reg=0.00329 | acc=0.9531 | L2-Norm=18.130 | L2-Norm(final)=2.644 | 4795.5 samples/s | 74.9 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.12881 | Reg=0.00329 | acc=0.9531 | L2-Norm=18.128 | L2-Norm(final)=2.649 | 4851.5 samples/s | 75.8 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.12525 | Reg=0.00329 | acc=0.8906 | L2-Norm=18.127 | L2-Norm(final)=2.655 | 4621.6 samples/s | 72.2 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.12184 | Reg=0.00329 | acc=0.9062 | L2-Norm=18.128 | L2-Norm(final)=2.661 | 4784.4 samples/s | 74.8 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.11867 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.128 | L2-Norm(final)=2.667 | 4826.8 samples/s | 75.4 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.11589 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.128 | L2-Norm(final)=2.673 | 4788.5 samples/s | 74.8 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.11323 | Reg=0.00329 | acc=0.9531 | L2-Norm=18.129 | L2-Norm(final)=2.678 | 5149.0 samples/s | 80.5 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.11053 | Reg=0.00329 | acc=0.9375 | L2-Norm=18.130 | L2-Norm(final)=2.683 | 2129.1 samples/s | 33.3 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.10765 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.131 | L2-Norm(final)=2.688 | 4926.3 samples/s | 77.0 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.10525 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.133 | L2-Norm(final)=2.693 | 4747.1 samples/s | 74.2 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.10303 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.136 | L2-Norm(final)=2.698 | 4777.3 samples/s | 74.6 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.10110 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.138 | L2-Norm(final)=2.703 | 4841.8 samples/s | 75.7 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.09939 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.141 | L2-Norm(final)=2.707 | 4771.9 samples/s | 74.6 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.09786 | Reg=0.00329 | acc=0.9531 | L2-Norm=18.144 | L2-Norm(final)=2.710 | 4784.2 samples/s | 74.8 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.09626 | Reg=0.00329 | acc=0.9375 | L2-Norm=18.146 | L2-Norm(final)=2.714 | 4819.6 samples/s | 75.3 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.09466 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.149 | L2-Norm(final)=2.717 | 4847.4 samples/s | 75.7 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.09315 | Reg=0.00330 | acc=0.9688 | L2-Norm=18.153 | L2-Norm(final)=2.720 | 4832.3 samples/s | 75.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step2000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37065 | Reg=0.00353 | acc=0.4219 | L2-Norm=18.784 | L2-Norm(final)=1.995 | 4803.4 samples/s | 75.1 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.35105 | Reg=0.00353 | acc=0.4844 | L2-Norm=18.784 | L2-Norm(final)=1.992 | 4662.8 samples/s | 72.9 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.34649 | Reg=0.00353 | acc=0.5938 | L2-Norm=18.784 | L2-Norm(final)=1.992 | 6143.4 samples/s | 96.0 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.34426 | Reg=0.00353 | acc=0.5781 | L2-Norm=18.784 | L2-Norm(final)=2.001 | 6048.5 samples/s | 94.5 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.34189 | Reg=0.00353 | acc=0.6719 | L2-Norm=18.784 | L2-Norm(final)=2.015 | 5987.3 samples/s | 93.6 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.34009 | Reg=0.00353 | acc=0.7188 | L2-Norm=18.784 | L2-Norm(final)=2.034 | 6007.3 samples/s | 93.9 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.33775 | Reg=0.00353 | acc=0.6094 | L2-Norm=18.784 | L2-Norm(final)=2.057 | 6600.5 samples/s | 103.1 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.33587 | Reg=0.00353 | acc=0.6719 | L2-Norm=18.784 | L2-Norm(final)=2.084 | 5674.1 samples/s | 88.7 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.33440 | Reg=0.00353 | acc=0.5000 | L2-Norm=18.784 | L2-Norm(final)=2.113 | 6074.2 samples/s | 94.9 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.33277 | Reg=0.00353 | acc=0.6406 | L2-Norm=18.784 | L2-Norm(final)=2.144 | 6099.4 samples/s | 95.3 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.33151 | Reg=0.00353 | acc=0.6406 | L2-Norm=18.784 | L2-Norm(final)=2.175 | 8016.3 samples/s | 125.3 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.0] | Loss=0.32259 | Reg=0.00353 | acc=0.6406 | L2-Norm=18.784 | L2-Norm(final)=2.498 | 4604.0 samples/s | 71.9 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.28950 | Reg=0.00342 | acc=0.8438 | L2-Norm=18.488 | L2-Norm(final)=2.504 | 4721.7 samples/s | 73.8 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.24759 | Reg=0.00339 | acc=0.8438 | L2-Norm=18.404 | L2-Norm(final)=2.528 | 4846.6 samples/s | 75.7 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.22320 | Reg=0.00337 | acc=0.8594 | L2-Norm=18.356 | L2-Norm(final)=2.544 | 4773.4 samples/s | 74.6 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.20836 | Reg=0.00336 | acc=0.8438 | L2-Norm=18.324 | L2-Norm(final)=2.555 | 4796.0 samples/s | 74.9 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.19649 | Reg=0.00335 | acc=0.8438 | L2-Norm=18.299 | L2-Norm(final)=2.565 | 4704.2 samples/s | 73.5 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.18613 | Reg=0.00334 | acc=0.9062 | L2-Norm=18.280 | L2-Norm(final)=2.575 | 4796.7 samples/s | 74.9 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.17675 | Reg=0.00334 | acc=0.9219 | L2-Norm=18.267 | L2-Norm(final)=2.584 | 4762.3 samples/s | 74.4 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.16830 | Reg=0.00333 | acc=0.9062 | L2-Norm=18.258 | L2-Norm(final)=2.593 | 4784.3 samples/s | 74.8 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.16176 | Reg=0.00333 | acc=0.9375 | L2-Norm=18.252 | L2-Norm(final)=2.600 | 4805.2 samples/s | 75.1 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.15575 | Reg=0.00333 | acc=0.9531 | L2-Norm=18.249 | L2-Norm(final)=2.607 | 5890.4 samples/s | 92.0 steps/s
[Step=1050 Epoch= 2.1] | Loss=0.14852 | Reg=0.00333 | acc=0.9375 | L2-Norm=18.249 | L2-Norm(final)=2.614 | 2103.3 samples/s | 32.9 steps/s
[Step=1100 Epoch= 2.2] | Loss=0.14311 | Reg=0.00333 | acc=0.9531 | L2-Norm=18.250 | L2-Norm(final)=2.621 | 4742.2 samples/s | 74.1 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.13817 | Reg=0.00333 | acc=0.9375 | L2-Norm=18.252 | L2-Norm(final)=2.627 | 4830.0 samples/s | 75.5 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.13396 | Reg=0.00333 | acc=0.9688 | L2-Norm=18.253 | L2-Norm(final)=2.634 | 4764.9 samples/s | 74.5 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.12999 | Reg=0.00333 | acc=0.9062 | L2-Norm=18.256 | L2-Norm(final)=2.640 | 4776.5 samples/s | 74.6 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.12675 | Reg=0.00333 | acc=0.9375 | L2-Norm=18.258 | L2-Norm(final)=2.645 | 4843.5 samples/s | 75.7 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.12365 | Reg=0.00333 | acc=0.9375 | L2-Norm=18.261 | L2-Norm(final)=2.650 | 4776.2 samples/s | 74.6 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.12077 | Reg=0.00334 | acc=0.9531 | L2-Norm=18.265 | L2-Norm(final)=2.655 | 4775.3 samples/s | 74.6 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.11790 | Reg=0.00334 | acc=0.9688 | L2-Norm=18.269 | L2-Norm(final)=2.660 | 4777.0 samples/s | 74.6 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.11504 | Reg=0.00334 | acc=0.9844 | L2-Norm=18.272 | L2-Norm(final)=2.664 | 5197.6 samples/s | 81.2 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.11208 | Reg=0.00334 | acc=0.9688 | L2-Norm=18.275 | L2-Norm(final)=2.669 | 2217.5 samples/s | 34.6 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.10945 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.279 | L2-Norm(final)=2.674 | 4764.6 samples/s | 74.4 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.10704 | Reg=0.00334 | acc=0.9844 | L2-Norm=18.283 | L2-Norm(final)=2.678 | 4799.6 samples/s | 75.0 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.10505 | Reg=0.00334 | acc=0.9844 | L2-Norm=18.287 | L2-Norm(final)=2.682 | 4781.5 samples/s | 74.7 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.10269 | Reg=0.00335 | acc=0.9844 | L2-Norm=18.291 | L2-Norm(final)=2.686 | 4781.2 samples/s | 74.7 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.10056 | Reg=0.00335 | acc=0.9375 | L2-Norm=18.295 | L2-Norm(final)=2.690 | 4803.9 samples/s | 75.1 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.09911 | Reg=0.00335 | acc=0.9844 | L2-Norm=18.299 | L2-Norm(final)=2.694 | 4790.6 samples/s | 74.9 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.09752 | Reg=0.00335 | acc=0.9688 | L2-Norm=18.303 | L2-Norm(final)=2.698 | 4827.3 samples/s | 75.4 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.09604 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.309 | L2-Norm(final)=2.701 | 4785.5 samples/s | 74.8 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.09453 | Reg=0.00335 | acc=0.9375 | L2-Norm=18.314 | L2-Norm(final)=2.704 | 4846.7 samples/s | 75.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step2000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36653 | Reg=0.00353 | acc=0.3438 | L2-Norm=18.784 | L2-Norm(final)=1.996 | 4697.0 samples/s | 73.4 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.32760 | Reg=0.00353 | acc=0.6094 | L2-Norm=18.784 | L2-Norm(final)=2.003 | 4449.7 samples/s | 69.5 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.31397 | Reg=0.00353 | acc=0.6094 | L2-Norm=18.784 | L2-Norm(final)=2.031 | 5611.0 samples/s | 87.7 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.30207 | Reg=0.00353 | acc=0.7500 | L2-Norm=18.784 | L2-Norm(final)=2.085 | 5642.2 samples/s | 88.2 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.29123 | Reg=0.00353 | acc=0.7812 | L2-Norm=18.784 | L2-Norm(final)=2.156 | 5797.3 samples/s | 90.6 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.28237 | Reg=0.00353 | acc=0.7500 | L2-Norm=18.784 | L2-Norm(final)=2.241 | 7485.8 samples/s | 117.0 steps/s
[Step= 300 Epoch= 1.1] | Loss=0.27427 | Reg=0.00353 | acc=0.9062 | L2-Norm=18.784 | L2-Norm(final)=2.333 | 2266.4 samples/s | 35.4 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.26655 | Reg=0.00353 | acc=0.9531 | L2-Norm=18.784 | L2-Norm(final)=2.428 | 5559.7 samples/s | 86.9 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.25998 | Reg=0.00353 | acc=0.8906 | L2-Norm=18.784 | L2-Norm(final)=2.524 | 5729.6 samples/s | 89.5 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.25417 | Reg=0.00353 | acc=0.8750 | L2-Norm=18.784 | L2-Norm(final)=2.620 | 5760.2 samples/s | 90.0 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.24867 | Reg=0.00353 | acc=0.9531 | L2-Norm=18.784 | L2-Norm(final)=2.716 | 6402.9 samples/s | 100.0 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.9] | Loss=0.20151 | Reg=0.00353 | acc=0.8594 | L2-Norm=18.784 | L2-Norm(final)=3.673 | 4452.3 samples/s | 69.6 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.12448 | Reg=0.00344 | acc=0.9688 | L2-Norm=18.559 | L2-Norm(final)=3.710 | 4564.4 samples/s | 71.3 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.08409 | Reg=0.00342 | acc=0.9688 | L2-Norm=18.498 | L2-Norm(final)=3.739 | 4575.4 samples/s | 71.5 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.06434 | Reg=0.00341 | acc=0.9844 | L2-Norm=18.463 | L2-Norm(final)=3.755 | 4584.9 samples/s | 71.6 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.05336 | Reg=0.00340 | acc=0.9844 | L2-Norm=18.439 | L2-Norm(final)=3.768 | 4534.1 samples/s | 70.8 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.04548 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.421 | L2-Norm(final)=3.775 | 5492.9 samples/s | 85.8 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.03851 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.404 | L2-Norm(final)=3.783 | 1913.9 samples/s | 29.9 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.03324 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.385 | L2-Norm(final)=3.791 | 4440.0 samples/s | 69.4 steps/s
[Step= 900 Epoch= 3.4] | Loss=0.02919 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.363 | L2-Norm(final)=3.798 | 4572.9 samples/s | 71.5 steps/s
[Step= 950 Epoch= 3.6] | Loss=0.02609 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.340 | L2-Norm(final)=3.804 | 4544.7 samples/s | 71.0 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.02359 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.316 | L2-Norm(final)=3.810 | 5053.8 samples/s | 79.0 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.02148 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.291 | L2-Norm(final)=3.816 | 2125.0 samples/s | 33.2 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01971 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.265 | L2-Norm(final)=3.821 | 4560.4 samples/s | 71.3 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01821 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.238 | L2-Norm(final)=3.826 | 4590.5 samples/s | 71.7 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01729 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.211 | L2-Norm(final)=3.830 | 4608.1 samples/s | 72.0 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.01621 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.187 | L2-Norm(final)=3.834 | 4534.2 samples/s | 70.8 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.01528 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.162 | L2-Norm(final)=3.838 | 2210.4 samples/s | 34.5 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.01439 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.138 | L2-Norm(final)=3.841 | 4643.8 samples/s | 72.6 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.01360 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.112 | L2-Norm(final)=3.845 | 4513.7 samples/s | 70.5 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.01288 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.085 | L2-Norm(final)=3.848 | 4506.4 samples/s | 70.4 steps/s
[Step=1500 Epoch= 5.7] | Loss=0.01226 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.058 | L2-Norm(final)=3.851 | 4575.5 samples/s | 71.5 steps/s
[Step=1550 Epoch= 5.9] | Loss=0.01171 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.031 | L2-Norm(final)=3.854 | 2208.5 samples/s | 34.5 steps/s
[Step=1600 Epoch= 6.1] | Loss=0.01118 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.004 | L2-Norm(final)=3.857 | 4574.0 samples/s | 71.5 steps/s
[Step=1650 Epoch= 6.3] | Loss=0.01070 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.976 | L2-Norm(final)=3.860 | 4540.8 samples/s | 71.0 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.01026 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.947 | L2-Norm(final)=3.862 | 4618.9 samples/s | 72.2 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.00985 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.918 | L2-Norm(final)=3.865 | 4541.0 samples/s | 71.0 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.00947 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.889 | L2-Norm(final)=3.867 | 6122.0 samples/s | 95.7 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00912 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.859 | L2-Norm(final)=3.870 | 1979.5 samples/s | 30.9 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00880 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.829 | L2-Norm(final)=3.872 | 4573.1 samples/s | 71.5 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00849 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.799 | L2-Norm(final)=3.874 | 4557.7 samples/s | 71.2 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00821 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.768 | L2-Norm(final)=3.876 | 4592.7 samples/s | 71.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step2000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35842 | Reg=0.00353 | acc=0.4219 | L2-Norm=18.784 | L2-Norm(final)=1.997 | 4451.6 samples/s | 69.6 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.32511 | Reg=0.00353 | acc=0.5000 | L2-Norm=18.784 | L2-Norm(final)=2.002 | 4563.6 samples/s | 71.3 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.31165 | Reg=0.00353 | acc=0.5625 | L2-Norm=18.784 | L2-Norm(final)=2.040 | 5194.3 samples/s | 81.2 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.30044 | Reg=0.00353 | acc=0.7500 | L2-Norm=18.784 | L2-Norm(final)=2.102 | 5614.4 samples/s | 87.7 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.29003 | Reg=0.00353 | acc=0.9219 | L2-Norm=18.784 | L2-Norm(final)=2.182 | 5749.9 samples/s | 89.8 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.28043 | Reg=0.00353 | acc=0.9062 | L2-Norm=18.784 | L2-Norm(final)=2.273 | 7781.8 samples/s | 121.6 steps/s
[Step= 300 Epoch= 1.2] | Loss=0.27195 | Reg=0.00353 | acc=0.8125 | L2-Norm=18.784 | L2-Norm(final)=2.370 | 2215.0 samples/s | 34.6 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.26501 | Reg=0.00353 | acc=0.8438 | L2-Norm=18.784 | L2-Norm(final)=2.471 | 5666.8 samples/s | 88.5 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.25905 | Reg=0.00353 | acc=0.8906 | L2-Norm=18.784 | L2-Norm(final)=2.572 | 5730.3 samples/s | 89.5 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.25284 | Reg=0.00353 | acc=0.8906 | L2-Norm=18.784 | L2-Norm(final)=2.674 | 5674.9 samples/s | 88.7 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.24761 | Reg=0.00353 | acc=0.8125 | L2-Norm=18.784 | L2-Norm(final)=2.776 | 6640.0 samples/s | 103.7 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.9] | Loss=0.17903 | Reg=0.00353 | acc=0.8906 | L2-Norm=18.784 | L2-Norm(final)=3.795 | 4520.8 samples/s | 70.6 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.11704 | Reg=0.00344 | acc=0.9531 | L2-Norm=18.555 | L2-Norm(final)=3.839 | 4288.5 samples/s | 67.0 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.07808 | Reg=0.00342 | acc=0.9844 | L2-Norm=18.493 | L2-Norm(final)=3.862 | 4559.6 samples/s | 71.2 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.05865 | Reg=0.00341 | acc=0.9844 | L2-Norm=18.460 | L2-Norm(final)=3.881 | 4512.5 samples/s | 70.5 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.04681 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.436 | L2-Norm(final)=3.898 | 4608.8 samples/s | 72.0 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.04002 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.416 | L2-Norm(final)=3.910 | 5773.6 samples/s | 90.2 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.03562 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.400 | L2-Norm(final)=3.918 | 2003.4 samples/s | 31.3 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.03100 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.385 | L2-Norm(final)=3.925 | 4566.8 samples/s | 71.4 steps/s
[Step= 900 Epoch= 3.5] | Loss=0.02741 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.369 | L2-Norm(final)=3.932 | 4511.0 samples/s | 70.5 steps/s
[Step= 950 Epoch= 3.7] | Loss=0.02496 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.352 | L2-Norm(final)=3.939 | 4575.0 samples/s | 71.5 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.02295 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.336 | L2-Norm(final)=3.945 | 5133.5 samples/s | 80.2 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.02094 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.319 | L2-Norm(final)=3.951 | 2116.4 samples/s | 33.1 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01921 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.301 | L2-Norm(final)=3.956 | 4553.1 samples/s | 71.1 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01774 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.280 | L2-Norm(final)=3.960 | 4512.3 samples/s | 70.5 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01648 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.258 | L2-Norm(final)=3.964 | 4607.2 samples/s | 72.0 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.01539 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.235 | L2-Norm(final)=3.968 | 4636.3 samples/s | 72.4 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.01443 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.210 | L2-Norm(final)=3.971 | 2193.5 samples/s | 34.3 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.01358 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.184 | L2-Norm(final)=3.974 | 4618.7 samples/s | 72.2 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.01283 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.158 | L2-Norm(final)=3.977 | 4506.1 samples/s | 70.4 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.01216 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.130 | L2-Norm(final)=3.979 | 4524.7 samples/s | 70.7 steps/s
[Step=1500 Epoch= 5.8] | Loss=0.01155 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.102 | L2-Norm(final)=3.981 | 4581.1 samples/s | 71.6 steps/s
[Step=1550 Epoch= 6.0] | Loss=0.01100 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.073 | L2-Norm(final)=3.984 | 2190.1 samples/s | 34.2 steps/s
[Step=1600 Epoch= 6.2] | Loss=0.01050 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=3.986 | 4626.0 samples/s | 72.3 steps/s
[Step=1650 Epoch= 6.4] | Loss=0.01005 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.014 | L2-Norm(final)=3.988 | 4570.1 samples/s | 71.4 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.00963 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.984 | L2-Norm(final)=3.989 | 4567.7 samples/s | 71.4 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.00925 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.953 | L2-Norm(final)=3.991 | 4577.6 samples/s | 71.5 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.00889 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.922 | L2-Norm(final)=3.993 | 6500.4 samples/s | 101.6 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00856 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.890 | L2-Norm(final)=3.994 | 1920.1 samples/s | 30.0 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00826 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.858 | L2-Norm(final)=3.996 | 4577.5 samples/s | 71.5 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00797 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.826 | L2-Norm(final)=3.997 | 4560.9 samples/s | 71.3 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00771 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.794 | L2-Norm(final)=3.998 | 4587.7 samples/s | 71.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08188 | acc=0.9411 | tpr=0.9461 | fpr=0.0699 | 4190.9 samples/s | 16.4 steps/s
Avg test loss: 0.08130, Avg test acc: 0.94102, Avg tpr: 0.94597, Avg fpr: 0.06986, total FA: 545

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08156 | acc=0.9403 | tpr=0.9401 | fpr=0.0592 | 4232.8 samples/s | 16.5 steps/s
Avg test loss: 0.08445, Avg test acc: 0.93862, Avg tpr: 0.93898, Avg fpr: 0.06217, total FA: 485

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.58331 | acc=0.3168 | tpr=0.0317 | fpr=0.0642 | 4168.3 samples/s | 16.3 steps/s
Avg test loss: 5.60094, Avg test acc: 0.31537, Avg tpr: 0.03235, Avg fpr: 0.06217, total FA: 485

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.28935 | acc=0.3106 | tpr=0.0146 | fpr=0.0466 | 4206.3 samples/s | 16.4 steps/s
Avg test loss: 5.29221, Avg test acc: 0.30880, Avg tpr: 0.01562, Avg fpr: 0.04640, total FA: 362

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=2.27518 | acc=0.1256 | tpr=0.5000 | fpr=0.8811 | 4174.8 samples/s | 16.3 steps/s
[Step= 100] | Loss=2.27460 | acc=0.1259 | tpr=0.5203 | fpr=0.8815 | 7768.9 samples/s | 30.3 steps/s
[Step= 150] | Loss=2.27519 | acc=0.1244 | tpr=0.5303 | fpr=0.8831 | 8125.9 samples/s | 31.7 steps/s
[Step= 200] | Loss=2.26986 | acc=0.1248 | tpr=0.5399 | fpr=0.8827 | 7629.4 samples/s | 29.8 steps/s
[Step= 250] | Loss=2.27590 | acc=0.1249 | tpr=0.5528 | fpr=0.8829 | 8144.6 samples/s | 31.8 steps/s
[Step= 300] | Loss=2.27749 | acc=0.1249 | tpr=0.5549 | fpr=0.8829 | 7845.8 samples/s | 30.6 steps/s
[Step= 350] | Loss=2.27728 | acc=0.1246 | tpr=0.5485 | fpr=0.8831 | 8412.7 samples/s | 32.9 steps/s
[Step= 400] | Loss=2.27641 | acc=0.1242 | tpr=0.5460 | fpr=0.8835 | 7389.9 samples/s | 28.9 steps/s
[Step= 450] | Loss=2.27755 | acc=0.1236 | tpr=0.5492 | fpr=0.8841 | 7906.7 samples/s | 30.9 steps/s
[Step= 500] | Loss=2.27874 | acc=0.1240 | tpr=0.5520 | fpr=0.8837 | 7705.7 samples/s | 30.1 steps/s
[Step= 550] | Loss=2.27827 | acc=0.1241 | tpr=0.5543 | fpr=0.8837 | 14688.6 samples/s | 57.4 steps/s
Avg test loss: 2.27851, Avg test acc: 0.12411, Avg tpr: 0.55468, Avg fpr: 0.88371, total FA: 122702

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=2.41283 | acc=0.1383 | tpr=0.6991 | fpr=0.8718 | 4152.5 samples/s | 16.2 steps/s
[Step= 100] | Loss=2.39320 | acc=0.1378 | tpr=0.6994 | fpr=0.8727 | 8212.6 samples/s | 32.1 steps/s
[Step= 150] | Loss=2.39708 | acc=0.1378 | tpr=0.7017 | fpr=0.8726 | 7628.3 samples/s | 29.8 steps/s
[Step= 200] | Loss=2.39454 | acc=0.1380 | tpr=0.6809 | fpr=0.8719 | 8006.9 samples/s | 31.3 steps/s
[Step= 250] | Loss=2.39776 | acc=0.1379 | tpr=0.6690 | fpr=0.8718 | 7759.2 samples/s | 30.3 steps/s
[Step= 300] | Loss=2.40137 | acc=0.1374 | tpr=0.6625 | fpr=0.8722 | 7747.7 samples/s | 30.3 steps/s
[Step= 350] | Loss=2.40052 | acc=0.1378 | tpr=0.6631 | fpr=0.8718 | 7903.3 samples/s | 30.9 steps/s
[Step= 400] | Loss=2.39861 | acc=0.1381 | tpr=0.6658 | fpr=0.8715 | 8281.9 samples/s | 32.4 steps/s
[Step= 450] | Loss=2.39681 | acc=0.1382 | tpr=0.6699 | fpr=0.8715 | 7447.8 samples/s | 29.1 steps/s
[Step= 500] | Loss=2.39797 | acc=0.1386 | tpr=0.6780 | fpr=0.8711 | 7836.9 samples/s | 30.6 steps/s
[Step= 550] | Loss=2.39805 | acc=0.1386 | tpr=0.6761 | fpr=0.8712 | 15278.4 samples/s | 59.7 steps/s
Avg test loss: 2.39935, Avg test acc: 0.13854, Avg tpr: 0.67670, Avg fpr: 0.87124, total FA: 120970

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09871 | acc=0.9757 | tpr=0.8717 | fpr=0.0224 | 4167.2 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.10144 | acc=0.9762 | tpr=0.9041 | fpr=0.0225 | 7779.8 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.10369 | acc=0.9756 | tpr=0.9121 | fpr=0.0232 | 7944.3 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.10513 | acc=0.9757 | tpr=0.9180 | fpr=0.0232 | 7888.3 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.10501 | acc=0.9759 | tpr=0.9170 | fpr=0.0230 | 7941.1 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.10585 | acc=0.9757 | tpr=0.9193 | fpr=0.0232 | 7785.5 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.10642 | acc=0.9755 | tpr=0.9186 | fpr=0.0235 | 7320.6 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.10655 | acc=0.9755 | tpr=0.9152 | fpr=0.0234 | 7750.8 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.10869 | acc=0.9753 | tpr=0.9124 | fpr=0.0236 | 7808.5 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.10808 | acc=0.9752 | tpr=0.9145 | fpr=0.0237 | 7823.0 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.10776 | acc=0.9753 | tpr=0.9113 | fpr=0.0236 | 14391.7 samples/s | 56.2 steps/s
Avg test loss: 0.10753, Avg test acc: 0.97531, Avg tpr: 0.91125, Avg fpr: 0.02352, total FA: 3266

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09037 | acc=0.9764 | tpr=0.9027 | fpr=0.0223 | 4215.1 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.09331 | acc=0.9765 | tpr=0.9296 | fpr=0.0226 | 7753.2 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.09538 | acc=0.9757 | tpr=0.9352 | fpr=0.0236 | 7706.3 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.09587 | acc=0.9757 | tpr=0.9388 | fpr=0.0236 | 8139.5 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.09455 | acc=0.9760 | tpr=0.9371 | fpr=0.0233 | 7884.8 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.09576 | acc=0.9758 | tpr=0.9353 | fpr=0.0235 | 7776.3 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.09521 | acc=0.9759 | tpr=0.9361 | fpr=0.0234 | 7781.0 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.09555 | acc=0.9757 | tpr=0.9349 | fpr=0.0235 | 8010.2 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.09717 | acc=0.9753 | tpr=0.9338 | fpr=0.0240 | 7912.6 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.09635 | acc=0.9754 | tpr=0.9366 | fpr=0.0239 | 7738.7 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.09563 | acc=0.9755 | tpr=0.9351 | fpr=0.0238 | 14296.6 samples/s | 55.8 steps/s
Avg test loss: 0.09541, Avg test acc: 0.97553, Avg tpr: 0.93542, Avg fpr: 0.02374, total FA: 3296

server round 1/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 3.9] | Loss=0.16362 | Reg=0.00271 | acc=0.8281 | L2-Norm=16.467 | L2-Norm(final)=2.814 | 4362.0 samples/s | 68.2 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.16258 | Reg=0.00271 | acc=0.9219 | L2-Norm=16.467 | L2-Norm(final)=2.871 | 4824.8 samples/s | 75.4 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.15722 | Reg=0.00271 | acc=0.9062 | L2-Norm=16.468 | L2-Norm(final)=2.930 | 5537.6 samples/s | 86.5 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.15407 | Reg=0.00271 | acc=0.8906 | L2-Norm=16.468 | L2-Norm(final)=2.987 | 5684.1 samples/s | 88.8 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.15362 | Reg=0.00271 | acc=0.8906 | L2-Norm=16.468 | L2-Norm(final)=3.039 | 5458.8 samples/s | 85.3 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.15158 | Reg=0.00271 | acc=0.9219 | L2-Norm=16.468 | L2-Norm(final)=3.089 | 5555.7 samples/s | 86.8 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.15133 | Reg=0.00271 | acc=0.8281 | L2-Norm=16.468 | L2-Norm(final)=3.143 | 5671.5 samples/s | 88.6 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.14959 | Reg=0.00271 | acc=0.8906 | L2-Norm=16.468 | L2-Norm(final)=3.195 | 5420.3 samples/s | 84.7 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.14761 | Reg=0.00271 | acc=0.8750 | L2-Norm=16.468 | L2-Norm(final)=3.246 | 5564.8 samples/s | 87.0 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.14716 | Reg=0.00271 | acc=0.8750 | L2-Norm=16.468 | L2-Norm(final)=3.297 | 5601.7 samples/s | 87.5 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.14784 | Reg=0.00271 | acc=0.9062 | L2-Norm=16.468 | L2-Norm(final)=3.343 | 6969.3 samples/s | 108.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 4.9] | Loss=0.19632 | Reg=0.00271 | acc=0.8125 | L2-Norm=16.468 | L2-Norm(final)=3.780 | 4925.1 samples/s | 77.0 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.13878 | Reg=0.00279 | acc=0.9375 | L2-Norm=16.707 | L2-Norm(final)=3.773 | 4270.4 samples/s | 66.7 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.13038 | Reg=0.00283 | acc=0.8750 | L2-Norm=16.833 | L2-Norm(final)=3.770 | 4803.8 samples/s | 75.1 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.12098 | Reg=0.00286 | acc=0.9375 | L2-Norm=16.908 | L2-Norm(final)=3.766 | 4707.8 samples/s | 73.6 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.11406 | Reg=0.00288 | acc=0.9531 | L2-Norm=16.956 | L2-Norm(final)=3.762 | 4810.9 samples/s | 75.2 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.10869 | Reg=0.00289 | acc=0.9219 | L2-Norm=16.993 | L2-Norm(final)=3.758 | 4834.8 samples/s | 75.5 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.10460 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.025 | L2-Norm(final)=3.754 | 4786.0 samples/s | 74.8 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.10104 | Reg=0.00291 | acc=0.9688 | L2-Norm=17.052 | L2-Norm(final)=3.753 | 4833.9 samples/s | 75.5 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.09884 | Reg=0.00292 | acc=0.9219 | L2-Norm=17.077 | L2-Norm(final)=3.751 | 4776.1 samples/s | 74.6 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.09683 | Reg=0.00292 | acc=0.9844 | L2-Norm=17.101 | L2-Norm(final)=3.749 | 4855.1 samples/s | 75.9 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.09403 | Reg=0.00293 | acc=0.9375 | L2-Norm=17.122 | L2-Norm(final)=3.748 | 5840.5 samples/s | 91.3 steps/s
[Step=3050 Epoch= 5.9] | Loss=0.09061 | Reg=0.00294 | acc=0.9688 | L2-Norm=17.142 | L2-Norm(final)=3.747 | 2025.5 samples/s | 31.6 steps/s
[Step=3100 Epoch= 6.0] | Loss=0.08701 | Reg=0.00295 | acc=0.9688 | L2-Norm=17.160 | L2-Norm(final)=3.747 | 4800.1 samples/s | 75.0 steps/s
[Step=3150 Epoch= 6.1] | Loss=0.08391 | Reg=0.00295 | acc=0.9375 | L2-Norm=17.177 | L2-Norm(final)=3.747 | 4754.9 samples/s | 74.3 steps/s
[Step=3200 Epoch= 6.2] | Loss=0.08224 | Reg=0.00296 | acc=0.9844 | L2-Norm=17.192 | L2-Norm(final)=3.746 | 4769.8 samples/s | 74.5 steps/s
[Step=3250 Epoch= 6.3] | Loss=0.08065 | Reg=0.00296 | acc=0.9219 | L2-Norm=17.206 | L2-Norm(final)=3.745 | 4802.1 samples/s | 75.0 steps/s
[Step=3300 Epoch= 6.4] | Loss=0.07930 | Reg=0.00297 | acc=0.9688 | L2-Norm=17.220 | L2-Norm(final)=3.744 | 4783.1 samples/s | 74.7 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.07809 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.234 | L2-Norm(final)=3.743 | 4828.6 samples/s | 75.4 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.07712 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.247 | L2-Norm(final)=3.741 | 4748.4 samples/s | 74.2 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.07580 | Reg=0.00298 | acc=0.9375 | L2-Norm=17.260 | L2-Norm(final)=3.740 | 4799.5 samples/s | 75.0 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.07451 | Reg=0.00298 | acc=0.9531 | L2-Norm=17.272 | L2-Norm(final)=3.739 | 5078.6 samples/s | 79.4 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.07347 | Reg=0.00299 | acc=0.9688 | L2-Norm=17.285 | L2-Norm(final)=3.738 | 2110.7 samples/s | 33.0 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.07193 | Reg=0.00299 | acc=0.9531 | L2-Norm=17.298 | L2-Norm(final)=3.737 | 4842.3 samples/s | 75.7 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.07034 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.310 | L2-Norm(final)=3.736 | 4852.9 samples/s | 75.8 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.06898 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.322 | L2-Norm(final)=3.736 | 4745.6 samples/s | 74.1 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.06786 | Reg=0.00301 | acc=0.9531 | L2-Norm=17.334 | L2-Norm(final)=3.736 | 4795.8 samples/s | 74.9 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.06691 | Reg=0.00301 | acc=0.9688 | L2-Norm=17.345 | L2-Norm(final)=3.735 | 4863.1 samples/s | 76.0 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.06584 | Reg=0.00301 | acc=0.9531 | L2-Norm=17.356 | L2-Norm(final)=3.735 | 4781.7 samples/s | 74.7 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.06536 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.367 | L2-Norm(final)=3.734 | 4793.5 samples/s | 74.9 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.06439 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.379 | L2-Norm(final)=3.734 | 4771.3 samples/s | 74.6 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.06354 | Reg=0.00302 | acc=0.9375 | L2-Norm=17.390 | L2-Norm(final)=3.734 | 4809.5 samples/s | 75.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 3.9] | Loss=0.16244 | Reg=0.00271 | acc=0.8906 | L2-Norm=16.467 | L2-Norm(final)=2.797 | 4408.4 samples/s | 68.9 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.15584 | Reg=0.00271 | acc=0.8125 | L2-Norm=16.467 | L2-Norm(final)=2.886 | 5244.3 samples/s | 81.9 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.14911 | Reg=0.00271 | acc=0.8281 | L2-Norm=16.467 | L2-Norm(final)=2.990 | 5521.0 samples/s | 86.3 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.14783 | Reg=0.00271 | acc=0.9062 | L2-Norm=16.467 | L2-Norm(final)=3.083 | 5600.0 samples/s | 87.5 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.14777 | Reg=0.00271 | acc=0.9062 | L2-Norm=16.467 | L2-Norm(final)=3.162 | 5411.5 samples/s | 84.6 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.14625 | Reg=0.00271 | acc=0.8906 | L2-Norm=16.467 | L2-Norm(final)=3.236 | 5544.7 samples/s | 86.6 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.14521 | Reg=0.00271 | acc=0.8438 | L2-Norm=16.467 | L2-Norm(final)=3.304 | 5590.2 samples/s | 87.3 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.14444 | Reg=0.00271 | acc=0.8281 | L2-Norm=16.467 | L2-Norm(final)=3.366 | 5447.3 samples/s | 85.1 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.14304 | Reg=0.00271 | acc=0.8125 | L2-Norm=16.467 | L2-Norm(final)=3.426 | 5569.2 samples/s | 87.0 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.14235 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.467 | L2-Norm(final)=3.485 | 5584.7 samples/s | 87.3 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.14107 | Reg=0.00271 | acc=0.9375 | L2-Norm=16.467 | L2-Norm(final)=3.542 | 6950.4 samples/s | 108.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 4.9] | Loss=0.17500 | Reg=0.00271 | acc=0.8281 | L2-Norm=16.467 | L2-Norm(final)=4.109 | 4556.9 samples/s | 71.2 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.14623 | Reg=0.00278 | acc=0.8750 | L2-Norm=16.683 | L2-Norm(final)=4.098 | 4744.3 samples/s | 74.1 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.13362 | Reg=0.00283 | acc=0.8125 | L2-Norm=16.814 | L2-Norm(final)=4.090 | 4788.6 samples/s | 74.8 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.12626 | Reg=0.00285 | acc=0.8906 | L2-Norm=16.891 | L2-Norm(final)=4.084 | 4822.1 samples/s | 75.3 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.11640 | Reg=0.00287 | acc=0.9688 | L2-Norm=16.945 | L2-Norm(final)=4.081 | 4737.4 samples/s | 74.0 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.11272 | Reg=0.00289 | acc=0.9062 | L2-Norm=16.993 | L2-Norm(final)=4.077 | 4805.6 samples/s | 75.1 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.10837 | Reg=0.00290 | acc=0.8906 | L2-Norm=17.031 | L2-Norm(final)=4.073 | 4774.5 samples/s | 74.6 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.10525 | Reg=0.00291 | acc=0.9219 | L2-Norm=17.064 | L2-Norm(final)=4.069 | 4830.1 samples/s | 75.5 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.10166 | Reg=0.00292 | acc=0.9844 | L2-Norm=17.094 | L2-Norm(final)=4.066 | 4770.3 samples/s | 74.5 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.09838 | Reg=0.00293 | acc=0.9531 | L2-Norm=17.121 | L2-Norm(final)=4.063 | 4838.3 samples/s | 75.6 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.09581 | Reg=0.00294 | acc=0.9375 | L2-Norm=17.146 | L2-Norm(final)=4.062 | 5931.0 samples/s | 92.7 steps/s
[Step=3050 Epoch= 6.0] | Loss=0.09147 | Reg=0.00295 | acc=0.9688 | L2-Norm=17.171 | L2-Norm(final)=4.062 | 2118.7 samples/s | 33.1 steps/s
[Step=3100 Epoch= 6.1] | Loss=0.08799 | Reg=0.00296 | acc=0.9375 | L2-Norm=17.195 | L2-Norm(final)=4.064 | 4715.9 samples/s | 73.7 steps/s
[Step=3150 Epoch= 6.2] | Loss=0.08559 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.218 | L2-Norm(final)=4.065 | 4777.2 samples/s | 74.6 steps/s
[Step=3200 Epoch= 6.3] | Loss=0.08451 | Reg=0.00297 | acc=0.9688 | L2-Norm=17.238 | L2-Norm(final)=4.065 | 4779.6 samples/s | 74.7 steps/s
[Step=3250 Epoch= 6.4] | Loss=0.08263 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.256 | L2-Norm(final)=4.064 | 4803.2 samples/s | 75.0 steps/s
[Step=3300 Epoch= 6.5] | Loss=0.08051 | Reg=0.00298 | acc=0.9688 | L2-Norm=17.274 | L2-Norm(final)=4.064 | 4693.3 samples/s | 73.3 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.07898 | Reg=0.00299 | acc=0.9531 | L2-Norm=17.290 | L2-Norm(final)=4.063 | 4816.1 samples/s | 75.3 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.07735 | Reg=0.00300 | acc=0.9375 | L2-Norm=17.305 | L2-Norm(final)=4.063 | 4752.7 samples/s | 74.3 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.07620 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.320 | L2-Norm(final)=4.062 | 4792.1 samples/s | 74.9 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.07508 | Reg=0.00301 | acc=0.9219 | L2-Norm=17.336 | L2-Norm(final)=4.061 | 5186.6 samples/s | 81.0 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.07385 | Reg=0.00301 | acc=0.9531 | L2-Norm=17.350 | L2-Norm(final)=4.060 | 2223.4 samples/s | 34.7 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.07202 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.364 | L2-Norm(final)=4.060 | 4757.3 samples/s | 74.3 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.07045 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.377 | L2-Norm(final)=4.060 | 4733.9 samples/s | 74.0 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.06894 | Reg=0.00302 | acc=0.9844 | L2-Norm=17.389 | L2-Norm(final)=4.060 | 4770.9 samples/s | 74.5 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.06795 | Reg=0.00303 | acc=0.9531 | L2-Norm=17.402 | L2-Norm(final)=4.060 | 4714.6 samples/s | 73.7 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.06697 | Reg=0.00303 | acc=0.9531 | L2-Norm=17.415 | L2-Norm(final)=4.060 | 4827.7 samples/s | 75.4 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.06623 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.427 | L2-Norm(final)=4.060 | 4915.0 samples/s | 76.8 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.06543 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.441 | L2-Norm(final)=4.060 | 4782.6 samples/s | 74.7 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.06471 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.454 | L2-Norm(final)=4.059 | 4795.1 samples/s | 74.9 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.06381 | Reg=0.00305 | acc=0.9688 | L2-Norm=17.467 | L2-Norm(final)=4.059 | 4738.2 samples/s | 74.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step4000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 7.7] | Loss=0.27683 | Reg=0.00271 | acc=0.6250 | L2-Norm=16.467 | L2-Norm(final)=3.924 | 4438.9 samples/s | 69.4 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.08660 | Reg=0.00271 | acc=0.9531 | L2-Norm=16.456 | L2-Norm(final)=3.812 | 5148.0 samples/s | 80.4 steps/s
[Step=2100 Epoch= 8.0] | Loss=0.06870 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.455 | L2-Norm(final)=3.939 | 5140.0 samples/s | 80.3 steps/s
[Step=2150 Epoch= 8.2] | Loss=0.06240 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.454 | L2-Norm(final)=4.044 | 5117.7 samples/s | 80.0 steps/s
[Step=2200 Epoch= 8.4] | Loss=0.05876 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.454 | L2-Norm(final)=4.139 | 5197.7 samples/s | 81.2 steps/s
[Step=2250 Epoch= 8.6] | Loss=0.05663 | Reg=0.00271 | acc=0.9531 | L2-Norm=16.454 | L2-Norm(final)=4.223 | 6819.7 samples/s | 106.6 steps/s
[Step=2300 Epoch= 8.8] | Loss=0.05489 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.454 | L2-Norm(final)=4.301 | 2138.6 samples/s | 33.4 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.05281 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.454 | L2-Norm(final)=4.374 | 5232.9 samples/s | 81.8 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.05191 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.454 | L2-Norm(final)=4.444 | 5222.7 samples/s | 81.6 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.05112 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.454 | L2-Norm(final)=4.510 | 5290.8 samples/s | 82.7 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.05042 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.454 | L2-Norm(final)=4.572 | 5829.8 samples/s | 91.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 9.6] | Loss=0.05946 | Reg=0.00271 | acc=0.9375 | L2-Norm=16.453 | L2-Norm(final)=5.180 | 4532.1 samples/s | 70.8 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.05267 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.796 | L2-Norm(final)=5.148 | 4391.9 samples/s | 68.6 steps/s
[Step=2600 Epoch=10.0] | Loss=0.03516 | Reg=0.00286 | acc=0.9844 | L2-Norm=16.909 | L2-Norm(final)=5.136 | 4548.5 samples/s | 71.1 steps/s
[Step=2650 Epoch=10.2] | Loss=0.02602 | Reg=0.00287 | acc=0.9844 | L2-Norm=16.946 | L2-Norm(final)=5.134 | 4578.3 samples/s | 71.5 steps/s
[Step=2700 Epoch=10.3] | Loss=0.02030 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.961 | L2-Norm(final)=5.136 | 4611.7 samples/s | 72.1 steps/s
[Step=2750 Epoch=10.5] | Loss=0.01749 | Reg=0.00288 | acc=0.9844 | L2-Norm=16.960 | L2-Norm(final)=5.137 | 5720.9 samples/s | 89.4 steps/s
[Step=2800 Epoch=10.7] | Loss=0.01475 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.956 | L2-Norm(final)=5.139 | 2015.6 samples/s | 31.5 steps/s
[Step=2850 Epoch=10.9] | Loss=0.01277 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.946 | L2-Norm(final)=5.141 | 4565.0 samples/s | 71.3 steps/s
[Step=2900 Epoch=11.1] | Loss=0.01123 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.932 | L2-Norm(final)=5.143 | 4561.1 samples/s | 71.3 steps/s
[Step=2950 Epoch=11.3] | Loss=0.01006 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.914 | L2-Norm(final)=5.145 | 4529.1 samples/s | 70.8 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00911 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.894 | L2-Norm(final)=5.147 | 5042.2 samples/s | 78.8 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00829 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.873 | L2-Norm(final)=5.149 | 2129.1 samples/s | 33.3 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00761 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.850 | L2-Norm(final)=5.151 | 4538.4 samples/s | 70.9 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00702 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.825 | L2-Norm(final)=5.153 | 4535.3 samples/s | 70.9 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00652 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.799 | L2-Norm(final)=5.155 | 4550.2 samples/s | 71.1 steps/s
[Step=3250 Epoch=12.5] | Loss=0.00609 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.772 | L2-Norm(final)=5.156 | 4537.5 samples/s | 70.9 steps/s
[Step=3300 Epoch=12.6] | Loss=0.00571 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.744 | L2-Norm(final)=5.157 | 2219.6 samples/s | 34.7 steps/s
[Step=3350 Epoch=12.8] | Loss=0.00538 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.716 | L2-Norm(final)=5.158 | 4666.3 samples/s | 72.9 steps/s
[Step=3400 Epoch=13.0] | Loss=0.00508 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.687 | L2-Norm(final)=5.159 | 4481.9 samples/s | 70.0 steps/s
[Step=3450 Epoch=13.2] | Loss=0.00481 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.657 | L2-Norm(final)=5.160 | 4546.1 samples/s | 71.0 steps/s
[Step=3500 Epoch=13.4] | Loss=0.00457 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.627 | L2-Norm(final)=5.161 | 4587.0 samples/s | 71.7 steps/s
[Step=3550 Epoch=13.6] | Loss=0.00435 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.596 | L2-Norm(final)=5.162 | 2189.8 samples/s | 34.2 steps/s
[Step=3600 Epoch=13.8] | Loss=0.00416 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.566 | L2-Norm(final)=5.163 | 4577.5 samples/s | 71.5 steps/s
[Step=3650 Epoch=14.0] | Loss=0.00398 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.534 | L2-Norm(final)=5.164 | 4506.5 samples/s | 70.4 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00381 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.503 | L2-Norm(final)=5.164 | 4591.8 samples/s | 71.7 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00366 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.472 | L2-Norm(final)=5.165 | 4519.9 samples/s | 70.6 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00352 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.440 | L2-Norm(final)=5.166 | 6172.1 samples/s | 96.4 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00339 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.408 | L2-Norm(final)=5.166 | 1958.6 samples/s | 30.6 steps/s
[Step=3900 Epoch=14.9] | Loss=0.00327 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.376 | L2-Norm(final)=5.167 | 4595.9 samples/s | 71.8 steps/s
[Step=3950 Epoch=15.1] | Loss=0.00316 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.343 | L2-Norm(final)=5.167 | 4601.8 samples/s | 71.9 steps/s
[Step=4000 Epoch=15.3] | Loss=0.00305 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.311 | L2-Norm(final)=5.168 | 4507.1 samples/s | 70.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step4000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 7.7] | Loss=0.33086 | Reg=0.00271 | acc=0.6875 | L2-Norm=16.467 | L2-Norm(final)=4.029 | 4839.4 samples/s | 75.6 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.09274 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.457 | L2-Norm(final)=3.881 | 4283.7 samples/s | 66.9 steps/s
[Step=2100 Epoch= 8.1] | Loss=0.07364 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.455 | L2-Norm(final)=3.990 | 5135.1 samples/s | 80.2 steps/s
[Step=2150 Epoch= 8.3] | Loss=0.06964 | Reg=0.00271 | acc=0.9375 | L2-Norm=16.455 | L2-Norm(final)=4.084 | 4991.1 samples/s | 78.0 steps/s
[Step=2200 Epoch= 8.5] | Loss=0.06587 | Reg=0.00271 | acc=0.9531 | L2-Norm=16.455 | L2-Norm(final)=4.167 | 4933.2 samples/s | 77.1 steps/s
[Step=2250 Epoch= 8.7] | Loss=0.06289 | Reg=0.00271 | acc=0.9219 | L2-Norm=16.455 | L2-Norm(final)=4.249 | 6924.0 samples/s | 108.2 steps/s
[Step=2300 Epoch= 8.9] | Loss=0.06026 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.454 | L2-Norm(final)=4.329 | 2144.2 samples/s | 33.5 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.05843 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.454 | L2-Norm(final)=4.406 | 5340.8 samples/s | 83.4 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.05770 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.454 | L2-Norm(final)=4.479 | 5093.9 samples/s | 79.6 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.05669 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.454 | L2-Norm(final)=4.548 | 5260.8 samples/s | 82.2 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.05598 | Reg=0.00271 | acc=0.9219 | L2-Norm=16.454 | L2-Norm(final)=4.614 | 6024.5 samples/s | 94.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 9.6] | Loss=0.07190 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.454 | L2-Norm(final)=5.271 | 4888.8 samples/s | 76.4 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.04632 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.752 | L2-Norm(final)=5.265 | 3986.2 samples/s | 62.3 steps/s
[Step=2600 Epoch=10.0] | Loss=0.03877 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.896 | L2-Norm(final)=5.252 | 4584.2 samples/s | 71.6 steps/s
[Step=2650 Epoch=10.2] | Loss=0.02977 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.970 | L2-Norm(final)=5.247 | 4474.3 samples/s | 69.9 steps/s
[Step=2700 Epoch=10.4] | Loss=0.02415 | Reg=0.00289 | acc=0.9844 | L2-Norm=17.010 | L2-Norm(final)=5.246 | 4604.9 samples/s | 72.0 steps/s
[Step=2750 Epoch=10.6] | Loss=0.02017 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.029 | L2-Norm(final)=5.246 | 5752.2 samples/s | 89.9 steps/s
[Step=2800 Epoch=10.8] | Loss=0.01710 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.036 | L2-Norm(final)=5.248 | 2033.5 samples/s | 31.8 steps/s
[Step=2850 Epoch=11.0] | Loss=0.01472 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.033 | L2-Norm(final)=5.249 | 4518.1 samples/s | 70.6 steps/s
[Step=2900 Epoch=11.2] | Loss=0.01292 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.022 | L2-Norm(final)=5.251 | 4531.9 samples/s | 70.8 steps/s
[Step=2950 Epoch=11.4] | Loss=0.01151 | Reg=0.00289 | acc=1.0000 | L2-Norm=17.007 | L2-Norm(final)=5.253 | 4525.5 samples/s | 70.7 steps/s
[Step=3000 Epoch=11.5] | Loss=0.01046 | Reg=0.00289 | acc=0.9844 | L2-Norm=16.988 | L2-Norm(final)=5.255 | 5183.8 samples/s | 81.0 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00978 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.968 | L2-Norm(final)=5.256 | 2085.5 samples/s | 32.6 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00933 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.951 | L2-Norm(final)=5.257 | 4501.6 samples/s | 70.3 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00873 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.934 | L2-Norm(final)=5.258 | 4598.2 samples/s | 71.8 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00812 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.917 | L2-Norm(final)=5.259 | 4525.8 samples/s | 70.7 steps/s
[Step=3250 Epoch=12.5] | Loss=0.00758 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.897 | L2-Norm(final)=5.260 | 4675.2 samples/s | 73.0 steps/s
[Step=3300 Epoch=12.7] | Loss=0.00715 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.877 | L2-Norm(final)=5.261 | 2186.2 samples/s | 34.2 steps/s
[Step=3350 Epoch=12.9] | Loss=0.00675 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.856 | L2-Norm(final)=5.262 | 4569.5 samples/s | 71.4 steps/s
[Step=3400 Epoch=13.1] | Loss=0.00638 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.834 | L2-Norm(final)=5.263 | 4578.0 samples/s | 71.5 steps/s
[Step=3450 Epoch=13.3] | Loss=0.00607 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.812 | L2-Norm(final)=5.265 | 4556.2 samples/s | 71.2 steps/s
[Step=3500 Epoch=13.5] | Loss=0.00577 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.788 | L2-Norm(final)=5.266 | 4550.6 samples/s | 71.1 steps/s
[Step=3550 Epoch=13.7] | Loss=0.00550 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.764 | L2-Norm(final)=5.267 | 2227.4 samples/s | 34.8 steps/s
[Step=3600 Epoch=13.9] | Loss=0.00525 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.738 | L2-Norm(final)=5.268 | 4456.1 samples/s | 69.6 steps/s
[Step=3650 Epoch=14.1] | Loss=0.00502 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.712 | L2-Norm(final)=5.269 | 4404.7 samples/s | 68.8 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00482 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.685 | L2-Norm(final)=5.270 | 4582.8 samples/s | 71.6 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00462 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.658 | L2-Norm(final)=5.271 | 4548.7 samples/s | 71.1 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00445 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.630 | L2-Norm(final)=5.272 | 6669.8 samples/s | 104.2 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00428 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.601 | L2-Norm(final)=5.273 | 1939.5 samples/s | 30.3 steps/s
[Step=3900 Epoch=15.0] | Loss=0.00413 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.572 | L2-Norm(final)=5.273 | 4591.6 samples/s | 71.7 steps/s
[Step=3950 Epoch=15.2] | Loss=0.00399 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.542 | L2-Norm(final)=5.274 | 4546.3 samples/s | 71.0 steps/s
[Step=4000 Epoch=15.4] | Loss=0.00385 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.512 | L2-Norm(final)=5.275 | 4570.9 samples/s | 71.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07836 | acc=0.9512 | tpr=0.9722 | fpr=0.0944 | 4079.5 samples/s | 15.9 steps/s
Avg test loss: 0.07879, Avg test acc: 0.95060, Avg tpr: 0.97162, Avg fpr: 0.09563, total FA: 746

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07292 | acc=0.9533 | tpr=0.9605 | fpr=0.0624 | 4191.9 samples/s | 16.4 steps/s
Avg test loss: 0.07445, Avg test acc: 0.95236, Avg tpr: 0.95897, Avg fpr: 0.06217, total FA: 485

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.26539 | acc=0.3178 | tpr=0.0160 | fpr=0.0268 | 4170.2 samples/s | 16.3 steps/s
Avg test loss: 5.27820, Avg test acc: 0.31553, Avg tpr: 0.01626, Avg fpr: 0.02628, total FA: 205

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.49059 | acc=0.3132 | tpr=0.0067 | fpr=0.0213 | 4156.8 samples/s | 16.2 steps/s
Avg test loss: 5.49813, Avg test acc: 0.31096, Avg tpr: 0.00717, Avg fpr: 0.02089, total FA: 163

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.63194 | acc=0.0983 | tpr=0.6460 | fpr=0.9116 | 4210.1 samples/s | 16.4 steps/s
[Step= 100] | Loss=3.62256 | acc=0.0997 | tpr=0.6738 | fpr=0.9110 | 7728.4 samples/s | 30.2 steps/s
[Step= 150] | Loss=3.63546 | acc=0.0990 | tpr=0.6801 | fpr=0.9117 | 8295.6 samples/s | 32.4 steps/s
[Step= 200] | Loss=3.62375 | acc=0.0996 | tpr=0.6896 | fpr=0.9111 | 7569.2 samples/s | 29.6 steps/s
[Step= 250] | Loss=3.62979 | acc=0.1007 | tpr=0.6978 | fpr=0.9102 | 7965.5 samples/s | 31.1 steps/s
[Step= 300] | Loss=3.63735 | acc=0.1006 | tpr=0.7018 | fpr=0.9103 | 7818.9 samples/s | 30.5 steps/s
[Step= 350] | Loss=3.63716 | acc=0.1007 | tpr=0.7001 | fpr=0.9101 | 8082.4 samples/s | 31.6 steps/s
[Step= 400] | Loss=3.63361 | acc=0.1003 | tpr=0.6969 | fpr=0.9105 | 7553.6 samples/s | 29.5 steps/s
[Step= 450] | Loss=3.63205 | acc=0.0997 | tpr=0.6972 | fpr=0.9111 | 7828.1 samples/s | 30.6 steps/s
[Step= 500] | Loss=3.63311 | acc=0.0996 | tpr=0.6934 | fpr=0.9112 | 7931.9 samples/s | 31.0 steps/s
[Step= 550] | Loss=3.63333 | acc=0.0996 | tpr=0.6964 | fpr=0.9113 | 14466.1 samples/s | 56.5 steps/s
Avg test loss: 3.63428, Avg test acc: 0.09954, Avg tpr: 0.69651, Avg fpr: 0.91131, total FA: 126534

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.53188 | acc=0.1330 | tpr=0.7611 | fpr=0.8783 | 4227.9 samples/s | 16.5 steps/s
[Step= 100] | Loss=3.52345 | acc=0.1306 | tpr=0.7548 | fpr=0.8810 | 7746.9 samples/s | 30.3 steps/s
[Step= 150] | Loss=3.53935 | acc=0.1291 | tpr=0.7550 | fpr=0.8824 | 7848.2 samples/s | 30.7 steps/s
[Step= 200] | Loss=3.53295 | acc=0.1301 | tpr=0.7530 | fpr=0.8812 | 8126.8 samples/s | 31.7 steps/s
[Step= 250] | Loss=3.53521 | acc=0.1300 | tpr=0.7563 | fpr=0.8815 | 7515.1 samples/s | 29.4 steps/s
[Step= 300] | Loss=3.53741 | acc=0.1296 | tpr=0.7607 | fpr=0.8819 | 7893.2 samples/s | 30.8 steps/s
[Step= 350] | Loss=3.53766 | acc=0.1294 | tpr=0.7608 | fpr=0.8821 | 7838.7 samples/s | 30.6 steps/s
[Step= 400] | Loss=3.53637 | acc=0.1293 | tpr=0.7609 | fpr=0.8821 | 7943.9 samples/s | 31.0 steps/s
[Step= 450] | Loss=3.53840 | acc=0.1291 | tpr=0.7614 | fpr=0.8823 | 7784.6 samples/s | 30.4 steps/s
[Step= 500] | Loss=3.54099 | acc=0.1289 | tpr=0.7595 | fpr=0.8825 | 7714.1 samples/s | 30.1 steps/s
[Step= 550] | Loss=3.54043 | acc=0.1293 | tpr=0.7596 | fpr=0.8821 | 14761.4 samples/s | 57.7 steps/s
Avg test loss: 3.54150, Avg test acc: 0.12921, Avg tpr: 0.75911, Avg fpr: 0.88224, total FA: 122497

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11019 | acc=0.9808 | tpr=0.8894 | fpr=0.0176 | 4222.2 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.11284 | acc=0.9802 | tpr=0.9104 | fpr=0.0185 | 7825.2 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.11600 | acc=0.9796 | tpr=0.9265 | fpr=0.0194 | 7891.7 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.11790 | acc=0.9795 | tpr=0.9301 | fpr=0.0196 | 8146.9 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.11680 | acc=0.9796 | tpr=0.9301 | fpr=0.0195 | 7533.5 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.11839 | acc=0.9792 | tpr=0.9280 | fpr=0.0198 | 8331.0 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.11902 | acc=0.9790 | tpr=0.9305 | fpr=0.0201 | 7657.7 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.11964 | acc=0.9788 | tpr=0.9272 | fpr=0.0203 | 7982.7 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.12200 | acc=0.9785 | tpr=0.9270 | fpr=0.0206 | 7499.3 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.12121 | acc=0.9785 | tpr=0.9282 | fpr=0.0206 | 8014.6 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.12048 | acc=0.9787 | tpr=0.9264 | fpr=0.0204 | 14096.9 samples/s | 55.1 steps/s
Avg test loss: 0.12022, Avg test acc: 0.97867, Avg tpr: 0.92631, Avg fpr: 0.02037, total FA: 2829

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10755 | acc=0.9787 | tpr=0.8894 | fpr=0.0197 | 4152.7 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.11314 | acc=0.9779 | tpr=0.9019 | fpr=0.0207 | 8055.4 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.11671 | acc=0.9771 | tpr=0.9207 | fpr=0.0219 | 7697.8 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.11697 | acc=0.9777 | tpr=0.9311 | fpr=0.0215 | 7812.9 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.11681 | acc=0.9778 | tpr=0.9249 | fpr=0.0212 | 7778.1 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.11878 | acc=0.9774 | tpr=0.9200 | fpr=0.0215 | 8009.3 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.11879 | acc=0.9773 | tpr=0.9230 | fpr=0.0217 | 7930.0 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.12009 | acc=0.9770 | tpr=0.9207 | fpr=0.0219 | 7725.8 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.12266 | acc=0.9768 | tpr=0.9206 | fpr=0.0222 | 7695.7 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.12216 | acc=0.9768 | tpr=0.9220 | fpr=0.0222 | 7762.4 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.12160 | acc=0.9769 | tpr=0.9216 | fpr=0.0221 | 14852.2 samples/s | 58.0 steps/s
Avg test loss: 0.12143, Avg test acc: 0.97690, Avg tpr: 0.92155, Avg fpr: 0.02209, total FA: 3067

server round 2/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.15282 | Reg=0.00243 | acc=0.8594 | L2-Norm=15.594 | L2-Norm(final)=3.745 | 4670.9 samples/s | 73.0 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.13678 | Reg=0.00243 | acc=0.8594 | L2-Norm=15.599 | L2-Norm(final)=3.829 | 5003.8 samples/s | 78.2 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.13254 | Reg=0.00243 | acc=0.8750 | L2-Norm=15.600 | L2-Norm(final)=3.937 | 5571.3 samples/s | 87.1 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.13033 | Reg=0.00243 | acc=0.8906 | L2-Norm=15.600 | L2-Norm(final)=4.033 | 5460.4 samples/s | 85.3 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.12744 | Reg=0.00243 | acc=0.8750 | L2-Norm=15.600 | L2-Norm(final)=4.123 | 5600.0 samples/s | 87.5 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.12486 | Reg=0.00243 | acc=0.9219 | L2-Norm=15.600 | L2-Norm(final)=4.205 | 5510.8 samples/s | 86.1 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.12435 | Reg=0.00243 | acc=0.8906 | L2-Norm=15.601 | L2-Norm(final)=4.281 | 5597.1 samples/s | 87.5 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.12394 | Reg=0.00243 | acc=0.9062 | L2-Norm=15.601 | L2-Norm(final)=4.350 | 5598.4 samples/s | 87.5 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.12315 | Reg=0.00243 | acc=0.9062 | L2-Norm=15.601 | L2-Norm(final)=4.415 | 5528.0 samples/s | 86.4 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.12279 | Reg=0.00243 | acc=0.8906 | L2-Norm=15.601 | L2-Norm(final)=4.478 | 5559.9 samples/s | 86.9 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.12213 | Reg=0.00243 | acc=0.8906 | L2-Norm=15.601 | L2-Norm(final)=4.538 | 6989.2 samples/s | 109.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch= 8.8] | Loss=0.09759 | Reg=0.00243 | acc=0.9062 | L2-Norm=15.601 | L2-Norm(final)=5.137 | 4092.6 samples/s | 63.9 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.10521 | Reg=0.00250 | acc=0.8906 | L2-Norm=15.799 | L2-Norm(final)=5.144 | 4789.8 samples/s | 74.8 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.09512 | Reg=0.00254 | acc=0.9375 | L2-Norm=15.930 | L2-Norm(final)=5.127 | 4781.3 samples/s | 74.7 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.08798 | Reg=0.00256 | acc=0.9531 | L2-Norm=16.014 | L2-Norm(final)=5.115 | 4865.7 samples/s | 76.0 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.08410 | Reg=0.00259 | acc=0.9219 | L2-Norm=16.077 | L2-Norm(final)=5.105 | 4842.6 samples/s | 75.7 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.08165 | Reg=0.00260 | acc=0.9688 | L2-Norm=16.128 | L2-Norm(final)=5.096 | 4786.0 samples/s | 74.8 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.07986 | Reg=0.00262 | acc=0.8906 | L2-Norm=16.173 | L2-Norm(final)=5.088 | 4815.7 samples/s | 75.2 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.07741 | Reg=0.00263 | acc=0.9844 | L2-Norm=16.213 | L2-Norm(final)=5.081 | 4794.3 samples/s | 74.9 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.07661 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.254 | L2-Norm(final)=5.074 | 4822.9 samples/s | 75.4 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.07545 | Reg=0.00265 | acc=0.9375 | L2-Norm=16.291 | L2-Norm(final)=5.068 | 4849.3 samples/s | 75.8 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.07408 | Reg=0.00267 | acc=0.9531 | L2-Norm=16.326 | L2-Norm(final)=5.061 | 5661.1 samples/s | 88.5 steps/s
[Step=5050 Epoch= 9.8] | Loss=0.07106 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.360 | L2-Norm(final)=5.057 | 2034.1 samples/s | 31.8 steps/s
[Step=5100 Epoch= 9.9] | Loss=0.06959 | Reg=0.00269 | acc=0.9062 | L2-Norm=16.392 | L2-Norm(final)=5.052 | 4788.3 samples/s | 74.8 steps/s
[Step=5150 Epoch=10.0] | Loss=0.06828 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.424 | L2-Norm(final)=5.048 | 4839.4 samples/s | 75.6 steps/s
[Step=5200 Epoch=10.1] | Loss=0.06668 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.455 | L2-Norm(final)=5.044 | 4764.6 samples/s | 74.4 steps/s
[Step=5250 Epoch=10.2] | Loss=0.06583 | Reg=0.00272 | acc=0.9688 | L2-Norm=16.485 | L2-Norm(final)=5.040 | 4754.2 samples/s | 74.3 steps/s
[Step=5300 Epoch=10.3] | Loss=0.06455 | Reg=0.00273 | acc=0.9531 | L2-Norm=16.512 | L2-Norm(final)=5.037 | 4824.9 samples/s | 75.4 steps/s
[Step=5350 Epoch=10.4] | Loss=0.06310 | Reg=0.00274 | acc=0.9531 | L2-Norm=16.537 | L2-Norm(final)=5.034 | 4776.0 samples/s | 74.6 steps/s
[Step=5400 Epoch=10.5] | Loss=0.06225 | Reg=0.00274 | acc=0.9844 | L2-Norm=16.561 | L2-Norm(final)=5.032 | 4805.3 samples/s | 75.1 steps/s
[Step=5450 Epoch=10.6] | Loss=0.06108 | Reg=0.00275 | acc=0.9688 | L2-Norm=16.585 | L2-Norm(final)=5.030 | 4788.3 samples/s | 74.8 steps/s
[Step=5500 Epoch=10.7] | Loss=0.06024 | Reg=0.00276 | acc=0.9531 | L2-Norm=16.609 | L2-Norm(final)=5.028 | 5089.0 samples/s | 79.5 steps/s
[Step=5550 Epoch=10.8] | Loss=0.05911 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.633 | L2-Norm(final)=5.026 | 2182.6 samples/s | 34.1 steps/s
[Step=5600 Epoch=10.9] | Loss=0.05802 | Reg=0.00278 | acc=0.9531 | L2-Norm=16.657 | L2-Norm(final)=5.025 | 4806.4 samples/s | 75.1 steps/s
[Step=5650 Epoch=11.0] | Loss=0.05724 | Reg=0.00278 | acc=0.9688 | L2-Norm=16.681 | L2-Norm(final)=5.024 | 4862.1 samples/s | 76.0 steps/s
[Step=5700 Epoch=11.1] | Loss=0.05620 | Reg=0.00279 | acc=0.9844 | L2-Norm=16.704 | L2-Norm(final)=5.022 | 4746.3 samples/s | 74.2 steps/s
[Step=5750 Epoch=11.2] | Loss=0.05544 | Reg=0.00280 | acc=0.9844 | L2-Norm=16.727 | L2-Norm(final)=5.020 | 4891.9 samples/s | 76.4 steps/s
[Step=5800 Epoch=11.3] | Loss=0.05491 | Reg=0.00281 | acc=0.9688 | L2-Norm=16.750 | L2-Norm(final)=5.019 | 4841.1 samples/s | 75.6 steps/s
[Step=5850 Epoch=11.4] | Loss=0.05430 | Reg=0.00281 | acc=0.9844 | L2-Norm=16.773 | L2-Norm(final)=5.017 | 4788.5 samples/s | 74.8 steps/s
[Step=5900 Epoch=11.5] | Loss=0.05377 | Reg=0.00282 | acc=0.9219 | L2-Norm=16.795 | L2-Norm(final)=5.015 | 4836.9 samples/s | 75.6 steps/s
[Step=5950 Epoch=11.6] | Loss=0.05305 | Reg=0.00283 | acc=0.9688 | L2-Norm=16.816 | L2-Norm(final)=5.013 | 4872.3 samples/s | 76.1 steps/s
[Step=6000 Epoch=11.7] | Loss=0.05260 | Reg=0.00284 | acc=0.9844 | L2-Norm=16.838 | L2-Norm(final)=5.012 | 4834.9 samples/s | 75.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step6000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.15274 | Reg=0.00243 | acc=0.8281 | L2-Norm=15.594 | L2-Norm(final)=4.055 | 4410.0 samples/s | 68.9 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.13101 | Reg=0.00243 | acc=0.9219 | L2-Norm=15.595 | L2-Norm(final)=4.112 | 4700.3 samples/s | 73.4 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.12820 | Reg=0.00243 | acc=0.9375 | L2-Norm=15.596 | L2-Norm(final)=4.201 | 5258.0 samples/s | 82.2 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.12668 | Reg=0.00243 | acc=0.8906 | L2-Norm=15.596 | L2-Norm(final)=4.274 | 5490.1 samples/s | 85.8 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.12391 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.596 | L2-Norm(final)=4.343 | 5547.0 samples/s | 86.7 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.12423 | Reg=0.00243 | acc=0.8438 | L2-Norm=15.596 | L2-Norm(final)=4.407 | 5550.8 samples/s | 86.7 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.12283 | Reg=0.00243 | acc=0.9219 | L2-Norm=15.596 | L2-Norm(final)=4.463 | 5526.9 samples/s | 86.4 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.12250 | Reg=0.00243 | acc=0.9062 | L2-Norm=15.596 | L2-Norm(final)=4.517 | 5544.4 samples/s | 86.6 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.12172 | Reg=0.00243 | acc=0.9375 | L2-Norm=15.596 | L2-Norm(final)=4.569 | 5666.2 samples/s | 88.5 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.12008 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.596 | L2-Norm(final)=4.619 | 5480.6 samples/s | 85.6 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.12025 | Reg=0.00243 | acc=0.8750 | L2-Norm=15.596 | L2-Norm(final)=4.668 | 7034.7 samples/s | 109.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch= 8.8] | Loss=0.12346 | Reg=0.00243 | acc=0.9062 | L2-Norm=15.596 | L2-Norm(final)=5.129 | 4862.5 samples/s | 76.0 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.10039 | Reg=0.00250 | acc=0.9688 | L2-Norm=15.799 | L2-Norm(final)=5.136 | 4604.4 samples/s | 71.9 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.09266 | Reg=0.00254 | acc=0.8594 | L2-Norm=15.941 | L2-Norm(final)=5.129 | 4806.9 samples/s | 75.1 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.09231 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.029 | L2-Norm(final)=5.119 | 4753.1 samples/s | 74.3 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.08825 | Reg=0.00259 | acc=0.8750 | L2-Norm=16.098 | L2-Norm(final)=5.111 | 4800.8 samples/s | 75.0 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.08387 | Reg=0.00261 | acc=0.9219 | L2-Norm=16.154 | L2-Norm(final)=5.104 | 4721.8 samples/s | 73.8 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.08127 | Reg=0.00263 | acc=0.9531 | L2-Norm=16.203 | L2-Norm(final)=5.098 | 4744.2 samples/s | 74.1 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.07874 | Reg=0.00264 | acc=0.9375 | L2-Norm=16.249 | L2-Norm(final)=5.093 | 4790.1 samples/s | 74.8 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.07622 | Reg=0.00265 | acc=0.9531 | L2-Norm=16.291 | L2-Norm(final)=5.089 | 4751.0 samples/s | 74.2 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.07529 | Reg=0.00267 | acc=0.9219 | L2-Norm=16.332 | L2-Norm(final)=5.085 | 4824.8 samples/s | 75.4 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.07354 | Reg=0.00268 | acc=0.9062 | L2-Norm=16.369 | L2-Norm(final)=5.081 | 5876.2 samples/s | 91.8 steps/s
[Step=5050 Epoch= 9.9] | Loss=0.07083 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.404 | L2-Norm(final)=5.078 | 2046.8 samples/s | 32.0 steps/s
[Step=5100 Epoch=10.0] | Loss=0.06820 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.437 | L2-Norm(final)=5.076 | 4871.8 samples/s | 76.1 steps/s
[Step=5150 Epoch=10.1] | Loss=0.06655 | Reg=0.00271 | acc=0.9531 | L2-Norm=16.467 | L2-Norm(final)=5.074 | 4725.0 samples/s | 73.8 steps/s
[Step=5200 Epoch=10.2] | Loss=0.06482 | Reg=0.00272 | acc=0.9688 | L2-Norm=16.496 | L2-Norm(final)=5.072 | 4816.9 samples/s | 75.3 steps/s
[Step=5250 Epoch=10.3] | Loss=0.06379 | Reg=0.00273 | acc=0.9219 | L2-Norm=16.523 | L2-Norm(final)=5.071 | 4759.9 samples/s | 74.4 steps/s
[Step=5300 Epoch=10.4] | Loss=0.06233 | Reg=0.00274 | acc=0.9844 | L2-Norm=16.548 | L2-Norm(final)=5.069 | 4807.4 samples/s | 75.1 steps/s
[Step=5350 Epoch=10.5] | Loss=0.06148 | Reg=0.00275 | acc=0.9688 | L2-Norm=16.572 | L2-Norm(final)=5.067 | 4818.7 samples/s | 75.3 steps/s
[Step=5400 Epoch=10.6] | Loss=0.06063 | Reg=0.00276 | acc=0.9688 | L2-Norm=16.595 | L2-Norm(final)=5.065 | 4840.1 samples/s | 75.6 steps/s
[Step=5450 Epoch=10.7] | Loss=0.05945 | Reg=0.00276 | acc=0.9531 | L2-Norm=16.617 | L2-Norm(final)=5.063 | 4817.6 samples/s | 75.3 steps/s
[Step=5500 Epoch=10.8] | Loss=0.05863 | Reg=0.00277 | acc=0.9531 | L2-Norm=16.638 | L2-Norm(final)=5.061 | 5204.7 samples/s | 81.3 steps/s
[Step=5550 Epoch=10.9] | Loss=0.05789 | Reg=0.00278 | acc=0.9844 | L2-Norm=16.659 | L2-Norm(final)=5.059 | 2194.8 samples/s | 34.3 steps/s
[Step=5600 Epoch=10.9] | Loss=0.05675 | Reg=0.00278 | acc=0.8750 | L2-Norm=16.680 | L2-Norm(final)=5.058 | 4874.8 samples/s | 76.2 steps/s
[Step=5650 Epoch=11.0] | Loss=0.05575 | Reg=0.00279 | acc=0.9688 | L2-Norm=16.700 | L2-Norm(final)=5.058 | 4693.4 samples/s | 73.3 steps/s
[Step=5700 Epoch=11.1] | Loss=0.05480 | Reg=0.00280 | acc=0.9531 | L2-Norm=16.719 | L2-Norm(final)=5.057 | 4773.4 samples/s | 74.6 steps/s
[Step=5750 Epoch=11.2] | Loss=0.05412 | Reg=0.00280 | acc=0.9219 | L2-Norm=16.737 | L2-Norm(final)=5.056 | 4785.5 samples/s | 74.8 steps/s
[Step=5800 Epoch=11.3] | Loss=0.05345 | Reg=0.00281 | acc=0.9844 | L2-Norm=16.754 | L2-Norm(final)=5.055 | 4904.4 samples/s | 76.6 steps/s
[Step=5850 Epoch=11.4] | Loss=0.05264 | Reg=0.00281 | acc=0.9531 | L2-Norm=16.772 | L2-Norm(final)=5.054 | 4730.1 samples/s | 73.9 steps/s
[Step=5900 Epoch=11.5] | Loss=0.05201 | Reg=0.00282 | acc=0.9375 | L2-Norm=16.789 | L2-Norm(final)=5.053 | 4763.9 samples/s | 74.4 steps/s
[Step=5950 Epoch=11.6] | Loss=0.05138 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.806 | L2-Norm(final)=5.051 | 4834.2 samples/s | 75.5 steps/s
[Step=6000 Epoch=11.7] | Loss=0.05092 | Reg=0.00283 | acc=0.9688 | L2-Norm=16.822 | L2-Norm(final)=5.050 | 4841.6 samples/s | 75.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step6000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=15.3] | Loss=0.01964 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.594 | L2-Norm(final)=5.184 | 4492.0 samples/s | 70.2 steps/s
[Step=4050 Epoch=15.5] | Loss=0.03754 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.584 | L2-Norm(final)=5.170 | 4545.6 samples/s | 71.0 steps/s
[Step=4100 Epoch=15.7] | Loss=0.03276 | Reg=0.00243 | acc=0.9531 | L2-Norm=15.583 | L2-Norm(final)=5.216 | 5335.7 samples/s | 83.4 steps/s
[Step=4150 Epoch=15.9] | Loss=0.03006 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.582 | L2-Norm(final)=5.280 | 5198.4 samples/s | 81.2 steps/s
[Step=4200 Epoch=16.1] | Loss=0.02894 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.582 | L2-Norm(final)=5.348 | 5141.6 samples/s | 80.3 steps/s
[Step=4250 Epoch=16.3] | Loss=0.02757 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.582 | L2-Norm(final)=5.417 | 6902.5 samples/s | 107.9 steps/s
[Step=4300 Epoch=16.5] | Loss=0.02678 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.582 | L2-Norm(final)=5.484 | 2140.3 samples/s | 33.4 steps/s
[Step=4350 Epoch=16.7] | Loss=0.02614 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.582 | L2-Norm(final)=5.549 | 5142.5 samples/s | 80.4 steps/s
[Step=4400 Epoch=16.9] | Loss=0.02547 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.582 | L2-Norm(final)=5.612 | 5044.9 samples/s | 78.8 steps/s
[Step=4450 Epoch=17.1] | Loss=0.02528 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.582 | L2-Norm(final)=5.673 | 5248.9 samples/s | 82.0 steps/s
[Step=4500 Epoch=17.2] | Loss=0.02494 | Reg=0.00243 | acc=0.9375 | L2-Norm=15.582 | L2-Norm(final)=5.731 | 5801.2 samples/s | 90.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=17.2] | Loss=0.01841 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.581 | L2-Norm(final)=6.311 | 4741.7 samples/s | 74.1 steps/s
[Step=4550 Epoch=17.4] | Loss=0.02573 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.839 | L2-Norm(final)=6.311 | 4295.8 samples/s | 67.1 steps/s
[Step=4600 Epoch=17.6] | Loss=0.01945 | Reg=0.00258 | acc=0.9844 | L2-Norm=16.065 | L2-Norm(final)=6.291 | 4540.7 samples/s | 70.9 steps/s
[Step=4650 Epoch=17.8] | Loss=0.01842 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.180 | L2-Norm(final)=6.281 | 4501.7 samples/s | 70.3 steps/s
[Step=4700 Epoch=18.0] | Loss=0.01479 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.245 | L2-Norm(final)=6.273 | 4583.2 samples/s | 71.6 steps/s
[Step=4750 Epoch=18.2] | Loss=0.01239 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.275 | L2-Norm(final)=6.271 | 5563.7 samples/s | 86.9 steps/s
[Step=4800 Epoch=18.4] | Loss=0.01046 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.289 | L2-Norm(final)=6.271 | 2043.0 samples/s | 31.9 steps/s
[Step=4850 Epoch=18.6] | Loss=0.00902 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.289 | L2-Norm(final)=6.272 | 4526.5 samples/s | 70.7 steps/s
[Step=4900 Epoch=18.8] | Loss=0.00790 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.279 | L2-Norm(final)=6.273 | 4573.3 samples/s | 71.5 steps/s
[Step=4950 Epoch=19.0] | Loss=0.00707 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.262 | L2-Norm(final)=6.274 | 4548.1 samples/s | 71.1 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00638 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.241 | L2-Norm(final)=6.275 | 5070.4 samples/s | 79.2 steps/s
[Step=5050 Epoch=19.3] | Loss=0.00580 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.217 | L2-Norm(final)=6.277 | 2139.7 samples/s | 33.4 steps/s
[Step=5100 Epoch=19.5] | Loss=0.00532 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.189 | L2-Norm(final)=6.278 | 4532.3 samples/s | 70.8 steps/s
[Step=5150 Epoch=19.7] | Loss=0.00491 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.160 | L2-Norm(final)=6.279 | 4576.3 samples/s | 71.5 steps/s
[Step=5200 Epoch=19.9] | Loss=0.00456 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.129 | L2-Norm(final)=6.280 | 4537.7 samples/s | 70.9 steps/s
[Step=5250 Epoch=20.1] | Loss=0.00426 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.096 | L2-Norm(final)=6.280 | 4613.0 samples/s | 72.1 steps/s
[Step=5300 Epoch=20.3] | Loss=0.00399 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.063 | L2-Norm(final)=6.281 | 2191.3 samples/s | 34.2 steps/s
[Step=5350 Epoch=20.5] | Loss=0.00376 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.029 | L2-Norm(final)=6.282 | 4671.9 samples/s | 73.0 steps/s
[Step=5400 Epoch=20.7] | Loss=0.00355 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.994 | L2-Norm(final)=6.282 | 4507.1 samples/s | 70.4 steps/s
[Step=5450 Epoch=20.9] | Loss=0.00336 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.959 | L2-Norm(final)=6.283 | 4551.2 samples/s | 71.1 steps/s
[Step=5500 Epoch=21.1] | Loss=0.00319 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.923 | L2-Norm(final)=6.284 | 4549.8 samples/s | 71.1 steps/s
[Step=5550 Epoch=21.3] | Loss=0.00304 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.886 | L2-Norm(final)=6.284 | 2203.3 samples/s | 34.4 steps/s
[Step=5600 Epoch=21.5] | Loss=0.00290 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.850 | L2-Norm(final)=6.285 | 4640.1 samples/s | 72.5 steps/s
[Step=5650 Epoch=21.6] | Loss=0.00278 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.813 | L2-Norm(final)=6.285 | 4534.1 samples/s | 70.8 steps/s
[Step=5700 Epoch=21.8] | Loss=0.00266 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.776 | L2-Norm(final)=6.286 | 4547.6 samples/s | 71.1 steps/s
[Step=5750 Epoch=22.0] | Loss=0.00256 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.739 | L2-Norm(final)=6.286 | 4533.4 samples/s | 70.8 steps/s
[Step=5800 Epoch=22.2] | Loss=0.00246 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.701 | L2-Norm(final)=6.287 | 6220.9 samples/s | 97.2 steps/s
[Step=5850 Epoch=22.4] | Loss=0.00237 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.664 | L2-Norm(final)=6.287 | 1977.4 samples/s | 30.9 steps/s
[Step=5900 Epoch=22.6] | Loss=0.00228 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.626 | L2-Norm(final)=6.288 | 4526.1 samples/s | 70.7 steps/s
[Step=5950 Epoch=22.8] | Loss=0.00220 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.588 | L2-Norm(final)=6.288 | 4516.6 samples/s | 70.6 steps/s
[Step=6000 Epoch=23.0] | Loss=0.00213 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.551 | L2-Norm(final)=6.288 | 4655.2 samples/s | 72.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step6000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=15.4] | Loss=0.07912 | Reg=0.00243 | acc=0.9375 | L2-Norm=15.594 | L2-Norm(final)=5.293 | 4334.9 samples/s | 67.7 steps/s
[Step=4050 Epoch=15.6] | Loss=0.03832 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.583 | L2-Norm(final)=5.289 | 5050.4 samples/s | 78.9 steps/s
[Step=4100 Epoch=15.8] | Loss=0.03219 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.582 | L2-Norm(final)=5.343 | 5192.6 samples/s | 81.1 steps/s
[Step=4150 Epoch=16.0] | Loss=0.02993 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.582 | L2-Norm(final)=5.414 | 5162.2 samples/s | 80.7 steps/s
[Step=4200 Epoch=16.2] | Loss=0.02795 | Reg=0.00243 | acc=0.9531 | L2-Norm=15.581 | L2-Norm(final)=5.483 | 5242.3 samples/s | 81.9 steps/s
[Step=4250 Epoch=16.4] | Loss=0.02790 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.581 | L2-Norm(final)=5.552 | 6974.9 samples/s | 109.0 steps/s
[Step=4300 Epoch=16.6] | Loss=0.02758 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.581 | L2-Norm(final)=5.614 | 2157.2 samples/s | 33.7 steps/s
[Step=4350 Epoch=16.7] | Loss=0.02676 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.581 | L2-Norm(final)=5.674 | 5004.7 samples/s | 78.2 steps/s
[Step=4400 Epoch=16.9] | Loss=0.02616 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.581 | L2-Norm(final)=5.734 | 5242.8 samples/s | 81.9 steps/s
[Step=4450 Epoch=17.1] | Loss=0.02552 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.581 | L2-Norm(final)=5.791 | 5328.0 samples/s | 83.3 steps/s
[Step=4500 Epoch=17.3] | Loss=0.02492 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.581 | L2-Norm(final)=5.847 | 5908.2 samples/s | 92.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=17.3] | Loss=0.02716 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.581 | L2-Norm(final)=6.406 | 4501.2 samples/s | 70.3 steps/s
[Step=4550 Epoch=17.5] | Loss=0.03707 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.835 | L2-Norm(final)=6.403 | 4313.8 samples/s | 67.4 steps/s
[Step=4600 Epoch=17.7] | Loss=0.03086 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.070 | L2-Norm(final)=6.369 | 4668.7 samples/s | 72.9 steps/s
[Step=4650 Epoch=17.9] | Loss=0.02499 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.184 | L2-Norm(final)=6.351 | 4490.4 samples/s | 70.2 steps/s
[Step=4700 Epoch=18.1] | Loss=0.01987 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.240 | L2-Norm(final)=6.344 | 4553.5 samples/s | 71.1 steps/s
[Step=4750 Epoch=18.3] | Loss=0.01657 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.263 | L2-Norm(final)=6.340 | 5803.3 samples/s | 90.7 steps/s
[Step=4800 Epoch=18.5] | Loss=0.01389 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.266 | L2-Norm(final)=6.339 | 1959.0 samples/s | 30.6 steps/s
[Step=4850 Epoch=18.7] | Loss=0.01209 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.258 | L2-Norm(final)=6.339 | 4322.2 samples/s | 67.5 steps/s
[Step=4900 Epoch=18.9] | Loss=0.01094 | Reg=0.00264 | acc=0.9688 | L2-Norm=16.244 | L2-Norm(final)=6.339 | 4538.6 samples/s | 70.9 steps/s
[Step=4950 Epoch=19.1] | Loss=0.01047 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.233 | L2-Norm(final)=6.337 | 4552.8 samples/s | 71.1 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00996 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.225 | L2-Norm(final)=6.334 | 5158.8 samples/s | 80.6 steps/s
[Step=5050 Epoch=19.4] | Loss=0.00985 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.218 | L2-Norm(final)=6.331 | 2099.8 samples/s | 32.8 steps/s
[Step=5100 Epoch=19.6] | Loss=0.00920 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.208 | L2-Norm(final)=6.326 | 4653.1 samples/s | 72.7 steps/s
[Step=5150 Epoch=19.8] | Loss=0.00853 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.196 | L2-Norm(final)=6.323 | 4466.0 samples/s | 69.8 steps/s
[Step=5200 Epoch=20.0] | Loss=0.00794 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.181 | L2-Norm(final)=6.321 | 4563.7 samples/s | 71.3 steps/s
[Step=5250 Epoch=20.2] | Loss=0.00742 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.163 | L2-Norm(final)=6.319 | 4615.6 samples/s | 72.1 steps/s
[Step=5300 Epoch=20.4] | Loss=0.00696 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.142 | L2-Norm(final)=6.318 | 2187.4 samples/s | 34.2 steps/s
[Step=5350 Epoch=20.6] | Loss=0.00655 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.120 | L2-Norm(final)=6.317 | 4568.9 samples/s | 71.4 steps/s
[Step=5400 Epoch=20.8] | Loss=0.00619 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.096 | L2-Norm(final)=6.316 | 4625.5 samples/s | 72.3 steps/s
[Step=5450 Epoch=21.0] | Loss=0.00586 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.070 | L2-Norm(final)=6.315 | 4607.5 samples/s | 72.0 steps/s
[Step=5500 Epoch=21.2] | Loss=0.00557 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.044 | L2-Norm(final)=6.315 | 4478.3 samples/s | 70.0 steps/s
[Step=5550 Epoch=21.4] | Loss=0.00531 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.016 | L2-Norm(final)=6.315 | 2204.3 samples/s | 34.4 steps/s
[Step=5600 Epoch=21.6] | Loss=0.00507 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.988 | L2-Norm(final)=6.314 | 4495.2 samples/s | 70.2 steps/s
[Step=5650 Epoch=21.7] | Loss=0.00485 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.959 | L2-Norm(final)=6.314 | 4569.4 samples/s | 71.4 steps/s
[Step=5700 Epoch=21.9] | Loss=0.00465 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.929 | L2-Norm(final)=6.314 | 4548.6 samples/s | 71.1 steps/s
[Step=5750 Epoch=22.1] | Loss=0.00446 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.899 | L2-Norm(final)=6.314 | 4576.0 samples/s | 71.5 steps/s
[Step=5800 Epoch=22.3] | Loss=0.00429 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.869 | L2-Norm(final)=6.314 | 6604.0 samples/s | 103.2 steps/s
[Step=5850 Epoch=22.5] | Loss=0.00413 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.838 | L2-Norm(final)=6.314 | 1912.4 samples/s | 29.9 steps/s
[Step=5900 Epoch=22.7] | Loss=0.00398 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.806 | L2-Norm(final)=6.314 | 4487.7 samples/s | 70.1 steps/s
[Step=5950 Epoch=22.9] | Loss=0.00385 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.775 | L2-Norm(final)=6.314 | 4520.8 samples/s | 70.6 steps/s
[Step=6000 Epoch=23.1] | Loss=0.00372 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.743 | L2-Norm(final)=6.314 | 4556.3 samples/s | 71.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06958 | acc=0.9510 | tpr=0.9533 | fpr=0.0540 | 4259.9 samples/s | 16.6 steps/s
Avg test loss: 0.06939, Avg test acc: 0.95132, Avg tpr: 0.95355, Avg fpr: 0.05358, total FA: 418

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06486 | acc=0.9548 | tpr=0.9676 | fpr=0.0728 | 4187.4 samples/s | 16.4 steps/s
Avg test loss: 0.06747, Avg test acc: 0.95336, Avg tpr: 0.96649, Avg fpr: 0.07550, total FA: 589

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.27164 | acc=0.3152 | tpr=0.0050 | fpr=0.0111 | 4157.7 samples/s | 16.2 steps/s
Avg test loss: 5.28155, Avg test acc: 0.31224, Avg tpr: 0.00466, Avg fpr: 0.01128, total FA: 88

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.36415 | acc=0.3115 | tpr=0.0027 | fpr=0.0181 | 4297.0 samples/s | 16.8 steps/s
Avg test loss: 5.37231, Avg test acc: 0.30912, Avg tpr: 0.00356, Avg fpr: 0.01884, total FA: 147

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.69934 | acc=0.1145 | tpr=0.6991 | fpr=0.8960 | 4184.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=3.67944 | acc=0.1139 | tpr=0.6972 | fpr=0.8970 | 7952.5 samples/s | 31.1 steps/s
[Step= 150] | Loss=3.68444 | acc=0.1123 | tpr=0.6974 | fpr=0.8985 | 7712.3 samples/s | 30.1 steps/s
[Step= 200] | Loss=3.67813 | acc=0.1124 | tpr=0.6951 | fpr=0.8982 | 7887.1 samples/s | 30.8 steps/s
[Step= 250] | Loss=3.67918 | acc=0.1130 | tpr=0.6952 | fpr=0.8976 | 7804.8 samples/s | 30.5 steps/s
[Step= 300] | Loss=3.68433 | acc=0.1127 | tpr=0.6858 | fpr=0.8978 | 8176.1 samples/s | 31.9 steps/s
[Step= 350] | Loss=3.68422 | acc=0.1126 | tpr=0.6744 | fpr=0.8976 | 7542.3 samples/s | 29.5 steps/s
[Step= 400] | Loss=3.68310 | acc=0.1125 | tpr=0.6696 | fpr=0.8976 | 8094.1 samples/s | 31.6 steps/s
[Step= 450] | Loss=3.68425 | acc=0.1124 | tpr=0.6680 | fpr=0.8977 | 7852.1 samples/s | 30.7 steps/s
[Step= 500] | Loss=3.68476 | acc=0.1120 | tpr=0.6683 | fpr=0.8980 | 7570.2 samples/s | 29.6 steps/s
[Step= 550] | Loss=3.68650 | acc=0.1117 | tpr=0.6689 | fpr=0.8985 | 14586.6 samples/s | 57.0 steps/s
Avg test loss: 3.68762, Avg test acc: 0.11161, Avg tpr: 0.66878, Avg fpr: 0.89851, total FA: 124757

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.08729 | acc=0.1287 | tpr=0.8097 | fpr=0.8836 | 4125.4 samples/s | 16.1 steps/s
[Step= 100] | Loss=4.07280 | acc=0.1271 | tpr=0.7612 | fpr=0.8847 | 8035.0 samples/s | 31.4 steps/s
[Step= 150] | Loss=4.08061 | acc=0.1268 | tpr=0.7565 | fpr=0.8848 | 7578.0 samples/s | 29.6 steps/s
[Step= 200] | Loss=4.07892 | acc=0.1265 | tpr=0.7443 | fpr=0.8847 | 8109.2 samples/s | 31.7 steps/s
[Step= 250] | Loss=4.07848 | acc=0.1264 | tpr=0.7450 | fpr=0.8849 | 7738.5 samples/s | 30.2 steps/s
[Step= 300] | Loss=4.07949 | acc=0.1264 | tpr=0.7447 | fpr=0.8849 | 7924.4 samples/s | 31.0 steps/s
[Step= 350] | Loss=4.08012 | acc=0.1261 | tpr=0.7395 | fpr=0.8850 | 8093.7 samples/s | 31.6 steps/s
[Step= 400] | Loss=4.07787 | acc=0.1260 | tpr=0.7418 | fpr=0.8852 | 7790.9 samples/s | 30.4 steps/s
[Step= 450] | Loss=4.07845 | acc=0.1258 | tpr=0.7405 | fpr=0.8853 | 7862.0 samples/s | 30.7 steps/s
[Step= 500] | Loss=4.08141 | acc=0.1258 | tpr=0.7436 | fpr=0.8853 | 8352.8 samples/s | 32.6 steps/s
[Step= 550] | Loss=4.08137 | acc=0.1262 | tpr=0.7445 | fpr=0.8851 | 12794.6 samples/s | 50.0 steps/s
Avg test loss: 4.08243, Avg test acc: 0.12607, Avg tpr: 0.74485, Avg fpr: 0.88518, total FA: 122905

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11372 | acc=0.9788 | tpr=0.9204 | fpr=0.0201 | 4190.9 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.11808 | acc=0.9781 | tpr=0.9382 | fpr=0.0212 | 7485.2 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.12124 | acc=0.9775 | tpr=0.9452 | fpr=0.0219 | 7942.4 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.12229 | acc=0.9774 | tpr=0.9443 | fpr=0.0220 | 8092.6 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.12226 | acc=0.9775 | tpr=0.9397 | fpr=0.0218 | 7754.0 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.12353 | acc=0.9770 | tpr=0.9382 | fpr=0.0223 | 7542.8 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.12396 | acc=0.9769 | tpr=0.9374 | fpr=0.0223 | 8554.6 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.12505 | acc=0.9767 | tpr=0.9322 | fpr=0.0225 | 7470.4 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.12704 | acc=0.9765 | tpr=0.9299 | fpr=0.0227 | 7780.5 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.12672 | acc=0.9764 | tpr=0.9304 | fpr=0.0228 | 7712.9 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.12592 | acc=0.9766 | tpr=0.9284 | fpr=0.0225 | 14864.8 samples/s | 58.1 steps/s
Avg test loss: 0.12561, Avg test acc: 0.97663, Avg tpr: 0.92829, Avg fpr: 0.02249, total FA: 3123

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08661 | acc=0.9820 | tpr=0.9336 | fpr=0.0171 | 4163.6 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.09416 | acc=0.9807 | tpr=0.9403 | fpr=0.0185 | 7972.8 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.09835 | acc=0.9798 | tpr=0.9524 | fpr=0.0197 | 7925.5 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.09923 | acc=0.9795 | tpr=0.9563 | fpr=0.0201 | 7946.0 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.09827 | acc=0.9796 | tpr=0.9528 | fpr=0.0199 | 8389.7 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.09853 | acc=0.9794 | tpr=0.9513 | fpr=0.0201 | 7466.8 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.09795 | acc=0.9795 | tpr=0.9518 | fpr=0.0200 | 7899.9 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.09917 | acc=0.9792 | tpr=0.9502 | fpr=0.0202 | 7585.5 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.10109 | acc=0.9791 | tpr=0.9499 | fpr=0.0204 | 7943.6 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.10084 | acc=0.9791 | tpr=0.9493 | fpr=0.0203 | 7916.8 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.10036 | acc=0.9791 | tpr=0.9487 | fpr=0.0203 | 14283.7 samples/s | 55.8 steps/s
Avg test loss: 0.10021, Avg test acc: 0.97915, Avg tpr: 0.94849, Avg fpr: 0.02030, total FA: 2818

server round 3/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=11.7] | Loss=0.16349 | Reg=0.00221 | acc=0.8438 | L2-Norm=14.860 | L2-Norm(final)=4.958 | 4909.6 samples/s | 76.7 steps/s
[Step=6050 Epoch=11.8] | Loss=0.22160 | Reg=0.00221 | acc=0.8750 | L2-Norm=14.870 | L2-Norm(final)=4.846 | 4348.5 samples/s | 67.9 steps/s
[Step=6100 Epoch=11.9] | Loss=0.18808 | Reg=0.00221 | acc=0.8906 | L2-Norm=14.872 | L2-Norm(final)=4.875 | 5376.4 samples/s | 84.0 steps/s
[Step=6150 Epoch=12.0] | Loss=0.17221 | Reg=0.00221 | acc=0.8594 | L2-Norm=14.872 | L2-Norm(final)=4.955 | 5602.0 samples/s | 87.5 steps/s
[Step=6200 Epoch=12.1] | Loss=0.16606 | Reg=0.00221 | acc=0.7969 | L2-Norm=14.873 | L2-Norm(final)=5.041 | 5338.0 samples/s | 83.4 steps/s
[Step=6250 Epoch=12.2] | Loss=0.16077 | Reg=0.00221 | acc=0.8750 | L2-Norm=14.873 | L2-Norm(final)=5.123 | 5551.7 samples/s | 86.7 steps/s
[Step=6300 Epoch=12.3] | Loss=0.15793 | Reg=0.00221 | acc=0.9219 | L2-Norm=14.873 | L2-Norm(final)=5.201 | 5522.0 samples/s | 86.3 steps/s
[Step=6350 Epoch=12.4] | Loss=0.15565 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.873 | L2-Norm(final)=5.273 | 5600.6 samples/s | 87.5 steps/s
[Step=6400 Epoch=12.5] | Loss=0.15345 | Reg=0.00221 | acc=0.9062 | L2-Norm=14.873 | L2-Norm(final)=5.340 | 5451.1 samples/s | 85.2 steps/s
[Step=6450 Epoch=12.6] | Loss=0.15128 | Reg=0.00221 | acc=0.9062 | L2-Norm=14.873 | L2-Norm(final)=5.406 | 5504.1 samples/s | 86.0 steps/s
[Step=6500 Epoch=12.7] | Loss=0.14982 | Reg=0.00221 | acc=0.8750 | L2-Norm=14.873 | L2-Norm(final)=5.469 | 7039.0 samples/s | 110.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=12.7] | Loss=0.12507 | Reg=0.00221 | acc=0.9062 | L2-Norm=14.873 | L2-Norm(final)=6.078 | 4543.9 samples/s | 71.0 steps/s
[Step=6550 Epoch=12.8] | Loss=0.08953 | Reg=0.00228 | acc=0.9375 | L2-Norm=15.084 | L2-Norm(final)=6.097 | 4474.7 samples/s | 69.9 steps/s
[Step=6600 Epoch=12.9] | Loss=0.08209 | Reg=0.00233 | acc=0.9531 | L2-Norm=15.253 | L2-Norm(final)=6.083 | 4826.2 samples/s | 75.4 steps/s
[Step=6650 Epoch=13.0] | Loss=0.08009 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.373 | L2-Norm(final)=6.072 | 4823.1 samples/s | 75.4 steps/s
[Step=6700 Epoch=13.1] | Loss=0.07589 | Reg=0.00239 | acc=0.9375 | L2-Norm=15.464 | L2-Norm(final)=6.061 | 4739.6 samples/s | 74.1 steps/s
[Step=6750 Epoch=13.2] | Loss=0.07414 | Reg=0.00242 | acc=0.9531 | L2-Norm=15.541 | L2-Norm(final)=6.050 | 4890.5 samples/s | 76.4 steps/s
[Step=6800 Epoch=13.3] | Loss=0.07313 | Reg=0.00244 | acc=0.9688 | L2-Norm=15.607 | L2-Norm(final)=6.040 | 4764.3 samples/s | 74.4 steps/s
[Step=6850 Epoch=13.4] | Loss=0.07000 | Reg=0.00245 | acc=0.9219 | L2-Norm=15.664 | L2-Norm(final)=6.031 | 4826.1 samples/s | 75.4 steps/s
[Step=6900 Epoch=13.5] | Loss=0.06836 | Reg=0.00247 | acc=0.9688 | L2-Norm=15.715 | L2-Norm(final)=6.023 | 4873.4 samples/s | 76.1 steps/s
[Step=6950 Epoch=13.6] | Loss=0.06688 | Reg=0.00249 | acc=0.9219 | L2-Norm=15.763 | L2-Norm(final)=6.017 | 4767.6 samples/s | 74.5 steps/s
[Step=7000 Epoch=13.7] | Loss=0.06539 | Reg=0.00250 | acc=0.9531 | L2-Norm=15.809 | L2-Norm(final)=6.011 | 5825.9 samples/s | 91.0 steps/s
[Step=7050 Epoch=13.8] | Loss=0.06208 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.851 | L2-Norm(final)=6.005 | 2014.6 samples/s | 31.5 steps/s
[Step=7100 Epoch=13.8] | Loss=0.05994 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.889 | L2-Norm(final)=6.001 | 4769.5 samples/s | 74.5 steps/s
[Step=7150 Epoch=13.9] | Loss=0.05834 | Reg=0.00254 | acc=0.9375 | L2-Norm=15.924 | L2-Norm(final)=5.998 | 4859.2 samples/s | 75.9 steps/s
[Step=7200 Epoch=14.0] | Loss=0.05699 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.957 | L2-Norm(final)=5.994 | 4777.3 samples/s | 74.6 steps/s
[Step=7250 Epoch=14.1] | Loss=0.05544 | Reg=0.00256 | acc=0.9688 | L2-Norm=15.988 | L2-Norm(final)=5.991 | 4764.8 samples/s | 74.4 steps/s
[Step=7300 Epoch=14.2] | Loss=0.05453 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.017 | L2-Norm(final)=5.987 | 4817.0 samples/s | 75.3 steps/s
[Step=7350 Epoch=14.3] | Loss=0.05401 | Reg=0.00258 | acc=0.9844 | L2-Norm=16.045 | L2-Norm(final)=5.984 | 4825.7 samples/s | 75.4 steps/s
[Step=7400 Epoch=14.4] | Loss=0.05313 | Reg=0.00258 | acc=0.9844 | L2-Norm=16.072 | L2-Norm(final)=5.981 | 4797.7 samples/s | 75.0 steps/s
[Step=7450 Epoch=14.5] | Loss=0.05238 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.097 | L2-Norm(final)=5.978 | 4803.2 samples/s | 75.0 steps/s
[Step=7500 Epoch=14.6] | Loss=0.05163 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.122 | L2-Norm(final)=5.975 | 5047.8 samples/s | 78.9 steps/s
[Step=7550 Epoch=14.7] | Loss=0.05076 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.147 | L2-Norm(final)=5.972 | 2088.9 samples/s | 32.6 steps/s
[Step=7600 Epoch=14.8] | Loss=0.04954 | Reg=0.00262 | acc=0.9688 | L2-Norm=16.171 | L2-Norm(final)=5.971 | 4825.4 samples/s | 75.4 steps/s
[Step=7650 Epoch=14.9] | Loss=0.04850 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.193 | L2-Norm(final)=5.969 | 4820.8 samples/s | 75.3 steps/s
[Step=7700 Epoch=15.0] | Loss=0.04792 | Reg=0.00263 | acc=0.9375 | L2-Norm=16.216 | L2-Norm(final)=5.967 | 4721.7 samples/s | 73.8 steps/s
[Step=7750 Epoch=15.1] | Loss=0.04744 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.239 | L2-Norm(final)=5.964 | 4834.2 samples/s | 75.5 steps/s
[Step=7800 Epoch=15.2] | Loss=0.04697 | Reg=0.00265 | acc=0.9688 | L2-Norm=16.261 | L2-Norm(final)=5.962 | 4796.3 samples/s | 74.9 steps/s
[Step=7850 Epoch=15.3] | Loss=0.04639 | Reg=0.00265 | acc=0.9531 | L2-Norm=16.284 | L2-Norm(final)=5.959 | 4824.8 samples/s | 75.4 steps/s
[Step=7900 Epoch=15.4] | Loss=0.04581 | Reg=0.00266 | acc=0.9375 | L2-Norm=16.305 | L2-Norm(final)=5.957 | 4804.9 samples/s | 75.1 steps/s
[Step=7950 Epoch=15.5] | Loss=0.04519 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.326 | L2-Norm(final)=5.954 | 4833.5 samples/s | 75.5 steps/s
[Step=8000 Epoch=15.6] | Loss=0.04473 | Reg=0.00267 | acc=0.9531 | L2-Norm=16.348 | L2-Norm(final)=5.952 | 4767.8 samples/s | 74.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=11.7] | Loss=0.08659 | Reg=0.00221 | acc=0.9531 | L2-Norm=14.860 | L2-Norm(final)=5.003 | 4719.7 samples/s | 73.7 steps/s
[Step=6050 Epoch=11.8] | Loss=0.13204 | Reg=0.00221 | acc=0.8906 | L2-Norm=14.867 | L2-Norm(final)=5.089 | 5188.3 samples/s | 81.1 steps/s
[Step=6100 Epoch=11.9] | Loss=0.12736 | Reg=0.00221 | acc=0.9219 | L2-Norm=14.868 | L2-Norm(final)=5.199 | 5533.8 samples/s | 86.5 steps/s
[Step=6150 Epoch=12.0] | Loss=0.12631 | Reg=0.00221 | acc=0.8750 | L2-Norm=14.869 | L2-Norm(final)=5.301 | 5481.0 samples/s | 85.6 steps/s
[Step=6200 Epoch=12.1] | Loss=0.12362 | Reg=0.00221 | acc=0.9219 | L2-Norm=14.869 | L2-Norm(final)=5.402 | 5531.8 samples/s | 86.4 steps/s
[Step=6250 Epoch=12.2] | Loss=0.12223 | Reg=0.00221 | acc=0.8906 | L2-Norm=14.869 | L2-Norm(final)=5.501 | 5538.7 samples/s | 86.5 steps/s
[Step=6300 Epoch=12.3] | Loss=0.12145 | Reg=0.00221 | acc=0.8750 | L2-Norm=14.869 | L2-Norm(final)=5.592 | 5484.0 samples/s | 85.7 steps/s
[Step=6350 Epoch=12.4] | Loss=0.11931 | Reg=0.00221 | acc=0.8438 | L2-Norm=14.869 | L2-Norm(final)=5.678 | 5582.6 samples/s | 87.2 steps/s
[Step=6400 Epoch=12.5] | Loss=0.11956 | Reg=0.00221 | acc=0.8750 | L2-Norm=14.869 | L2-Norm(final)=5.760 | 5508.0 samples/s | 86.1 steps/s
[Step=6450 Epoch=12.6] | Loss=0.11918 | Reg=0.00221 | acc=0.9062 | L2-Norm=14.869 | L2-Norm(final)=5.836 | 5616.0 samples/s | 87.7 steps/s
[Step=6500 Epoch=12.7] | Loss=0.11870 | Reg=0.00221 | acc=0.9531 | L2-Norm=14.869 | L2-Norm(final)=5.909 | 7017.1 samples/s | 109.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=12.7] | Loss=0.09481 | Reg=0.00221 | acc=0.9531 | L2-Norm=14.870 | L2-Norm(final)=6.631 | 4536.7 samples/s | 70.9 steps/s
[Step=6550 Epoch=12.8] | Loss=0.08886 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.048 | L2-Norm(final)=6.660 | 4752.3 samples/s | 74.3 steps/s
[Step=6600 Epoch=12.9] | Loss=0.08195 | Reg=0.00232 | acc=0.9531 | L2-Norm=15.217 | L2-Norm(final)=6.640 | 4747.0 samples/s | 74.2 steps/s
[Step=6650 Epoch=13.0] | Loss=0.07737 | Reg=0.00235 | acc=0.9688 | L2-Norm=15.335 | L2-Norm(final)=6.624 | 4805.1 samples/s | 75.1 steps/s
[Step=6700 Epoch=13.1] | Loss=0.07414 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.419 | L2-Norm(final)=6.611 | 4800.7 samples/s | 75.0 steps/s
[Step=6750 Epoch=13.2] | Loss=0.07038 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.486 | L2-Norm(final)=6.602 | 4741.1 samples/s | 74.1 steps/s
[Step=6800 Epoch=13.3] | Loss=0.06890 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.546 | L2-Norm(final)=6.595 | 4829.5 samples/s | 75.5 steps/s
[Step=6850 Epoch=13.4] | Loss=0.06733 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.599 | L2-Norm(final)=6.589 | 4778.0 samples/s | 74.7 steps/s
[Step=6900 Epoch=13.5] | Loss=0.06611 | Reg=0.00245 | acc=0.9688 | L2-Norm=15.645 | L2-Norm(final)=6.583 | 4825.5 samples/s | 75.4 steps/s
[Step=6950 Epoch=13.6] | Loss=0.06463 | Reg=0.00246 | acc=0.9531 | L2-Norm=15.688 | L2-Norm(final)=6.578 | 4786.1 samples/s | 74.8 steps/s
[Step=7000 Epoch=13.7] | Loss=0.06376 | Reg=0.00247 | acc=0.9531 | L2-Norm=15.728 | L2-Norm(final)=6.572 | 5890.0 samples/s | 92.0 steps/s
[Step=7050 Epoch=13.8] | Loss=0.06124 | Reg=0.00249 | acc=0.9688 | L2-Norm=15.765 | L2-Norm(final)=6.568 | 2109.3 samples/s | 33.0 steps/s
[Step=7100 Epoch=13.9] | Loss=0.05916 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.800 | L2-Norm(final)=6.564 | 4720.1 samples/s | 73.8 steps/s
[Step=7150 Epoch=14.0] | Loss=0.05725 | Reg=0.00251 | acc=0.9531 | L2-Norm=15.834 | L2-Norm(final)=6.562 | 4743.3 samples/s | 74.1 steps/s
[Step=7200 Epoch=14.1] | Loss=0.05589 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.867 | L2-Norm(final)=6.559 | 4771.4 samples/s | 74.6 steps/s
[Step=7250 Epoch=14.2] | Loss=0.05450 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.895 | L2-Norm(final)=6.556 | 4804.4 samples/s | 75.1 steps/s
[Step=7300 Epoch=14.3] | Loss=0.05379 | Reg=0.00254 | acc=0.9219 | L2-Norm=15.921 | L2-Norm(final)=6.554 | 4830.5 samples/s | 75.5 steps/s
[Step=7350 Epoch=14.4] | Loss=0.05282 | Reg=0.00254 | acc=0.9531 | L2-Norm=15.946 | L2-Norm(final)=6.551 | 4722.8 samples/s | 73.8 steps/s
[Step=7400 Epoch=14.5] | Loss=0.05229 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.969 | L2-Norm(final)=6.548 | 4815.5 samples/s | 75.2 steps/s
[Step=7450 Epoch=14.6] | Loss=0.05176 | Reg=0.00256 | acc=0.9688 | L2-Norm=15.992 | L2-Norm(final)=6.545 | 4735.9 samples/s | 74.0 steps/s
[Step=7500 Epoch=14.7] | Loss=0.05105 | Reg=0.00257 | acc=0.9219 | L2-Norm=16.015 | L2-Norm(final)=6.542 | 5208.4 samples/s | 81.4 steps/s
[Step=7550 Epoch=14.8] | Loss=0.05045 | Reg=0.00257 | acc=0.9688 | L2-Norm=16.038 | L2-Norm(final)=6.539 | 2165.7 samples/s | 33.8 steps/s
[Step=7600 Epoch=14.9] | Loss=0.04946 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.061 | L2-Norm(final)=6.537 | 4659.3 samples/s | 72.8 steps/s
[Step=7650 Epoch=15.0] | Loss=0.04850 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.083 | L2-Norm(final)=6.535 | 4708.9 samples/s | 73.6 steps/s
[Step=7700 Epoch=15.1] | Loss=0.04772 | Reg=0.00260 | acc=0.9688 | L2-Norm=16.104 | L2-Norm(final)=6.533 | 4785.4 samples/s | 74.8 steps/s
[Step=7750 Epoch=15.2] | Loss=0.04705 | Reg=0.00260 | acc=0.9375 | L2-Norm=16.125 | L2-Norm(final)=6.531 | 4820.2 samples/s | 75.3 steps/s
[Step=7800 Epoch=15.2] | Loss=0.04655 | Reg=0.00261 | acc=0.9531 | L2-Norm=16.146 | L2-Norm(final)=6.529 | 4732.8 samples/s | 74.0 steps/s
[Step=7850 Epoch=15.3] | Loss=0.04587 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.166 | L2-Norm(final)=6.527 | 4792.8 samples/s | 74.9 steps/s
[Step=7900 Epoch=15.4] | Loss=0.04525 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.186 | L2-Norm(final)=6.524 | 4840.1 samples/s | 75.6 steps/s
[Step=7950 Epoch=15.5] | Loss=0.04495 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.206 | L2-Norm(final)=6.522 | 4799.0 samples/s | 75.0 steps/s
[Step=8000 Epoch=15.6] | Loss=0.04460 | Reg=0.00263 | acc=0.9219 | L2-Norm=16.226 | L2-Norm(final)=6.519 | 4798.0 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step8000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=23.0] | Loss=0.03001 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.860 | L2-Norm(final)=6.301 | 4641.4 samples/s | 72.5 steps/s
[Step=6050 Epoch=23.2] | Loss=0.02364 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.848 | L2-Norm(final)=6.379 | 4354.5 samples/s | 68.0 steps/s
[Step=6100 Epoch=23.4] | Loss=0.02110 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.847 | L2-Norm(final)=6.490 | 5141.6 samples/s | 80.3 steps/s
[Step=6150 Epoch=23.6] | Loss=0.01948 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.846 | L2-Norm(final)=6.601 | 5327.8 samples/s | 83.2 steps/s
[Step=6200 Epoch=23.8] | Loss=0.01890 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.846 | L2-Norm(final)=6.709 | 5139.5 samples/s | 80.3 steps/s
[Step=6250 Epoch=23.9] | Loss=0.01816 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.846 | L2-Norm(final)=6.811 | 6946.1 samples/s | 108.5 steps/s
[Step=6300 Epoch=24.1] | Loss=0.01767 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.846 | L2-Norm(final)=6.906 | 2135.9 samples/s | 33.4 steps/s
[Step=6350 Epoch=24.3] | Loss=0.01700 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.846 | L2-Norm(final)=6.998 | 5310.8 samples/s | 83.0 steps/s
[Step=6400 Epoch=24.5] | Loss=0.01661 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.846 | L2-Norm(final)=7.087 | 5301.9 samples/s | 82.8 steps/s
[Step=6450 Epoch=24.7] | Loss=0.01621 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.846 | L2-Norm(final)=7.171 | 5136.7 samples/s | 80.3 steps/s
[Step=6500 Epoch=24.9] | Loss=0.01592 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.846 | L2-Norm(final)=7.251 | 5840.7 samples/s | 91.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=24.9] | Loss=0.00733 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.845 | L2-Norm(final)=8.022 | 4329.8 samples/s | 67.7 steps/s
[Step=6550 Epoch=25.1] | Loss=0.02636 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.123 | L2-Norm(final)=8.012 | 4550.7 samples/s | 71.1 steps/s
[Step=6600 Epoch=25.3] | Loss=0.02245 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.412 | L2-Norm(final)=7.971 | 4639.2 samples/s | 72.5 steps/s
[Step=6650 Epoch=25.5] | Loss=0.01855 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.557 | L2-Norm(final)=7.951 | 4523.0 samples/s | 70.7 steps/s
[Step=6700 Epoch=25.7] | Loss=0.01554 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.632 | L2-Norm(final)=7.938 | 4560.7 samples/s | 71.3 steps/s
[Step=6750 Epoch=25.9] | Loss=0.01355 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.672 | L2-Norm(final)=7.927 | 5731.8 samples/s | 89.6 steps/s
[Step=6800 Epoch=26.1] | Loss=0.01178 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.690 | L2-Norm(final)=7.919 | 2023.0 samples/s | 31.6 steps/s
[Step=6850 Epoch=26.2] | Loss=0.01030 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.695 | L2-Norm(final)=7.913 | 4578.2 samples/s | 71.5 steps/s
[Step=6900 Epoch=26.4] | Loss=0.00912 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.689 | L2-Norm(final)=7.910 | 4519.4 samples/s | 70.6 steps/s
[Step=6950 Epoch=26.6] | Loss=0.00811 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.676 | L2-Norm(final)=7.909 | 4584.4 samples/s | 71.6 steps/s
[Step=7000 Epoch=26.8] | Loss=0.00731 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.657 | L2-Norm(final)=7.908 | 4959.9 samples/s | 77.5 steps/s
[Step=7050 Epoch=27.0] | Loss=0.00665 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.633 | L2-Norm(final)=7.908 | 2124.1 samples/s | 33.2 steps/s
[Step=7100 Epoch=27.2] | Loss=0.00609 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.606 | L2-Norm(final)=7.908 | 4576.2 samples/s | 71.5 steps/s
[Step=7150 Epoch=27.4] | Loss=0.00563 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.576 | L2-Norm(final)=7.908 | 4583.6 samples/s | 71.6 steps/s
[Step=7200 Epoch=27.6] | Loss=0.00523 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.544 | L2-Norm(final)=7.909 | 4574.6 samples/s | 71.5 steps/s
[Step=7250 Epoch=27.8] | Loss=0.00488 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.511 | L2-Norm(final)=7.909 | 4609.2 samples/s | 72.0 steps/s
[Step=7300 Epoch=28.0] | Loss=0.00458 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.477 | L2-Norm(final)=7.909 | 2187.3 samples/s | 34.2 steps/s
[Step=7350 Epoch=28.2] | Loss=0.00431 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.442 | L2-Norm(final)=7.910 | 4660.2 samples/s | 72.8 steps/s
[Step=7400 Epoch=28.4] | Loss=0.00407 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.407 | L2-Norm(final)=7.910 | 4306.2 samples/s | 67.3 steps/s
[Step=7450 Epoch=28.5] | Loss=0.00385 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.371 | L2-Norm(final)=7.911 | 4346.6 samples/s | 67.9 steps/s
[Step=7500 Epoch=28.7] | Loss=0.00366 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.334 | L2-Norm(final)=7.911 | 4275.4 samples/s | 66.8 steps/s
[Step=7550 Epoch=28.9] | Loss=0.00349 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.297 | L2-Norm(final)=7.912 | 2157.8 samples/s | 33.7 steps/s
[Step=7600 Epoch=29.1] | Loss=0.00333 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.260 | L2-Norm(final)=7.912 | 4510.4 samples/s | 70.5 steps/s
[Step=7650 Epoch=29.3] | Loss=0.00319 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.223 | L2-Norm(final)=7.912 | 4562.6 samples/s | 71.3 steps/s
[Step=7700 Epoch=29.5] | Loss=0.00305 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.186 | L2-Norm(final)=7.913 | 4550.8 samples/s | 71.1 steps/s
[Step=7750 Epoch=29.7] | Loss=0.00293 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.148 | L2-Norm(final)=7.913 | 4584.6 samples/s | 71.6 steps/s
[Step=7800 Epoch=29.9] | Loss=0.00282 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.111 | L2-Norm(final)=7.914 | 6159.6 samples/s | 96.2 steps/s
[Step=7850 Epoch=30.1] | Loss=0.00272 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.073 | L2-Norm(final)=7.914 | 1949.4 samples/s | 30.5 steps/s
[Step=7900 Epoch=30.3] | Loss=0.00262 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.036 | L2-Norm(final)=7.915 | 4551.0 samples/s | 71.1 steps/s
[Step=7950 Epoch=30.5] | Loss=0.00253 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.998 | L2-Norm(final)=7.915 | 4545.5 samples/s | 71.0 steps/s
[Step=8000 Epoch=30.7] | Loss=0.00244 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.961 | L2-Norm(final)=7.916 | 4489.3 samples/s | 70.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step8000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=23.1] | Loss=0.01537 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.860 | L2-Norm(final)=6.316 | 4234.3 samples/s | 66.2 steps/s
[Step=6050 Epoch=23.3] | Loss=0.02446 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.849 | L2-Norm(final)=6.403 | 4620.7 samples/s | 72.2 steps/s
[Step=6100 Epoch=23.5] | Loss=0.02281 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.848 | L2-Norm(final)=6.512 | 5157.6 samples/s | 80.6 steps/s
[Step=6150 Epoch=23.7] | Loss=0.02181 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.847 | L2-Norm(final)=6.625 | 5184.6 samples/s | 81.0 steps/s
[Step=6200 Epoch=23.9] | Loss=0.02133 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.847 | L2-Norm(final)=6.728 | 5255.0 samples/s | 82.1 steps/s
[Step=6250 Epoch=24.1] | Loss=0.02064 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.847 | L2-Norm(final)=6.825 | 6876.0 samples/s | 107.4 steps/s
[Step=6300 Epoch=24.3] | Loss=0.02012 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.847 | L2-Norm(final)=6.918 | 2133.1 samples/s | 33.3 steps/s
[Step=6350 Epoch=24.4] | Loss=0.01978 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.847 | L2-Norm(final)=7.008 | 5222.0 samples/s | 81.6 steps/s
[Step=6400 Epoch=24.6] | Loss=0.01937 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.847 | L2-Norm(final)=7.094 | 5225.3 samples/s | 81.6 steps/s
[Step=6450 Epoch=24.8] | Loss=0.01897 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.846 | L2-Norm(final)=7.175 | 5243.0 samples/s | 81.9 steps/s
[Step=6500 Epoch=25.0] | Loss=0.01848 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.846 | L2-Norm(final)=7.253 | 5957.8 samples/s | 93.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=25.0] | Loss=0.02686 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.846 | L2-Norm(final)=8.016 | 4850.0 samples/s | 75.8 steps/s
[Step=6550 Epoch=25.2] | Loss=0.01881 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.041 | L2-Norm(final)=8.020 | 4203.7 samples/s | 65.7 steps/s
[Step=6600 Epoch=25.4] | Loss=0.01555 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.246 | L2-Norm(final)=8.003 | 4530.1 samples/s | 70.8 steps/s
[Step=6650 Epoch=25.6] | Loss=0.01291 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.352 | L2-Norm(final)=7.991 | 4552.1 samples/s | 71.1 steps/s
[Step=6700 Epoch=25.8] | Loss=0.01089 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.412 | L2-Norm(final)=7.985 | 4611.3 samples/s | 72.1 steps/s
[Step=6750 Epoch=26.0] | Loss=0.00947 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.454 | L2-Norm(final)=7.981 | 5759.9 samples/s | 90.0 steps/s
[Step=6800 Epoch=26.2] | Loss=0.00854 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.476 | L2-Norm(final)=7.979 | 2002.6 samples/s | 31.3 steps/s
[Step=6850 Epoch=26.4] | Loss=0.00856 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.494 | L2-Norm(final)=7.972 | 4510.8 samples/s | 70.5 steps/s
[Step=6900 Epoch=26.6] | Loss=0.00765 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.505 | L2-Norm(final)=7.966 | 4534.5 samples/s | 70.9 steps/s
[Step=6950 Epoch=26.8] | Loss=0.00685 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.505 | L2-Norm(final)=7.963 | 4610.8 samples/s | 72.0 steps/s
[Step=7000 Epoch=26.9] | Loss=0.00620 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.498 | L2-Norm(final)=7.960 | 5048.4 samples/s | 78.9 steps/s
[Step=7050 Epoch=27.1] | Loss=0.00578 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.484 | L2-Norm(final)=7.958 | 2088.3 samples/s | 32.6 steps/s
[Step=7100 Epoch=27.3] | Loss=0.00535 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.465 | L2-Norm(final)=7.956 | 4626.6 samples/s | 72.3 steps/s
[Step=7150 Epoch=27.5] | Loss=0.00498 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.444 | L2-Norm(final)=7.954 | 4489.3 samples/s | 70.1 steps/s
[Step=7200 Epoch=27.7] | Loss=0.00464 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.421 | L2-Norm(final)=7.953 | 4563.1 samples/s | 71.3 steps/s
[Step=7250 Epoch=27.9] | Loss=0.00434 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.396 | L2-Norm(final)=7.953 | 4609.1 samples/s | 72.0 steps/s
[Step=7300 Epoch=28.1] | Loss=0.00407 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.369 | L2-Norm(final)=7.953 | 2193.3 samples/s | 34.3 steps/s
[Step=7350 Epoch=28.3] | Loss=0.00384 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.341 | L2-Norm(final)=7.953 | 4592.3 samples/s | 71.8 steps/s
[Step=7400 Epoch=28.5] | Loss=0.00363 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.313 | L2-Norm(final)=7.953 | 4620.0 samples/s | 72.2 steps/s
[Step=7450 Epoch=28.7] | Loss=0.00344 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.284 | L2-Norm(final)=7.953 | 4543.7 samples/s | 71.0 steps/s
[Step=7500 Epoch=28.9] | Loss=0.00327 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.253 | L2-Norm(final)=7.953 | 4492.2 samples/s | 70.2 steps/s
[Step=7550 Epoch=29.1] | Loss=0.00311 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.222 | L2-Norm(final)=7.953 | 2186.6 samples/s | 34.2 steps/s
[Step=7600 Epoch=29.3] | Loss=0.00297 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.190 | L2-Norm(final)=7.953 | 4675.3 samples/s | 73.1 steps/s
[Step=7650 Epoch=29.4] | Loss=0.00284 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.158 | L2-Norm(final)=7.953 | 4549.9 samples/s | 71.1 steps/s
[Step=7700 Epoch=29.6] | Loss=0.00272 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.125 | L2-Norm(final)=7.953 | 4581.3 samples/s | 71.6 steps/s
[Step=7750 Epoch=29.8] | Loss=0.00261 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.092 | L2-Norm(final)=7.954 | 4482.7 samples/s | 70.0 steps/s
[Step=7800 Epoch=30.0] | Loss=0.00251 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.059 | L2-Norm(final)=7.954 | 6671.4 samples/s | 104.2 steps/s
[Step=7850 Epoch=30.2] | Loss=0.00242 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.025 | L2-Norm(final)=7.954 | 1911.0 samples/s | 29.9 steps/s
[Step=7900 Epoch=30.4] | Loss=0.00233 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.991 | L2-Norm(final)=7.954 | 4515.6 samples/s | 70.6 steps/s
[Step=7950 Epoch=30.6] | Loss=0.00225 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.958 | L2-Norm(final)=7.954 | 4557.8 samples/s | 71.2 steps/s
[Step=8000 Epoch=30.8] | Loss=0.00218 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.924 | L2-Norm(final)=7.955 | 4536.3 samples/s | 70.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07753 | acc=0.9536 | tpr=0.9641 | fpr=0.0691 | 4189.8 samples/s | 16.4 steps/s
Avg test loss: 0.07668, Avg test acc: 0.95300, Avg tpr: 0.96305, Avg fpr: 0.06909, total FA: 539

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07564 | acc=0.9470 | tpr=0.9414 | fpr=0.0409 | 4135.1 samples/s | 16.2 steps/s
Avg test loss: 0.07640, Avg test acc: 0.94675, Avg tpr: 0.94201, Avg fpr: 0.04282, total FA: 334

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.09902 | acc=0.3118 | tpr=0.0017 | fpr=0.0149 | 4182.1 samples/s | 16.3 steps/s
Avg test loss: 5.09956, Avg test acc: 0.30948, Avg tpr: 0.00251, Avg fpr: 0.01538, total FA: 120

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.07901 | acc=0.3140 | tpr=0.0016 | fpr=0.0077 | 4169.8 samples/s | 16.3 steps/s
Avg test loss: 6.09507, Avg test acc: 0.31136, Avg tpr: 0.00175, Avg fpr: 0.00769, total FA: 60

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.34586 | acc=0.0834 | tpr=0.7080 | fpr=0.9278 | 4232.0 samples/s | 16.5 steps/s
[Step= 100] | Loss=4.32346 | acc=0.0842 | tpr=0.7335 | fpr=0.9279 | 7773.3 samples/s | 30.4 steps/s
[Step= 150] | Loss=4.33240 | acc=0.0836 | tpr=0.7435 | fpr=0.9285 | 7948.1 samples/s | 31.0 steps/s
[Step= 200] | Loss=4.33308 | acc=0.0837 | tpr=0.7410 | fpr=0.9283 | 7729.7 samples/s | 30.2 steps/s
[Step= 250] | Loss=4.33643 | acc=0.0833 | tpr=0.7266 | fpr=0.9284 | 7917.0 samples/s | 30.9 steps/s
[Step= 300] | Loss=4.34002 | acc=0.0832 | tpr=0.7222 | fpr=0.9285 | 7856.3 samples/s | 30.7 steps/s
[Step= 350] | Loss=4.33853 | acc=0.0829 | tpr=0.7201 | fpr=0.9287 | 7897.3 samples/s | 30.8 steps/s
[Step= 400] | Loss=4.33707 | acc=0.0826 | tpr=0.7144 | fpr=0.9289 | 7936.6 samples/s | 31.0 steps/s
[Step= 450] | Loss=4.33771 | acc=0.0823 | tpr=0.7108 | fpr=0.9291 | 7660.7 samples/s | 29.9 steps/s
[Step= 500] | Loss=4.33994 | acc=0.0819 | tpr=0.7079 | fpr=0.9294 | 7723.7 samples/s | 30.2 steps/s
[Step= 550] | Loss=4.34007 | acc=0.0820 | tpr=0.7087 | fpr=0.9294 | 14845.9 samples/s | 58.0 steps/s
Avg test loss: 4.34208, Avg test acc: 0.08196, Avg tpr: 0.70800, Avg fpr: 0.92942, total FA: 129048

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.47831 | acc=0.1491 | tpr=0.5133 | fpr=0.8574 | 4245.4 samples/s | 16.6 steps/s
[Step= 100] | Loss=3.45694 | acc=0.1470 | tpr=0.5203 | fpr=0.8599 | 7606.0 samples/s | 29.7 steps/s
[Step= 150] | Loss=3.47416 | acc=0.1466 | tpr=0.5173 | fpr=0.8602 | 7997.3 samples/s | 31.2 steps/s
[Step= 200] | Loss=3.46487 | acc=0.1480 | tpr=0.5213 | fpr=0.8588 | 7702.7 samples/s | 30.1 steps/s
[Step= 250] | Loss=3.46759 | acc=0.1472 | tpr=0.5153 | fpr=0.8595 | 8117.5 samples/s | 31.7 steps/s
[Step= 300] | Loss=3.46612 | acc=0.1465 | tpr=0.5149 | fpr=0.8602 | 7623.4 samples/s | 29.8 steps/s
[Step= 350] | Loss=3.46601 | acc=0.1465 | tpr=0.5160 | fpr=0.8602 | 8181.5 samples/s | 32.0 steps/s
[Step= 400] | Loss=3.45987 | acc=0.1464 | tpr=0.5186 | fpr=0.8603 | 7739.7 samples/s | 30.2 steps/s
[Step= 450] | Loss=3.46032 | acc=0.1464 | tpr=0.5175 | fpr=0.8603 | 7895.3 samples/s | 30.8 steps/s
[Step= 500] | Loss=3.46263 | acc=0.1466 | tpr=0.5203 | fpr=0.8601 | 7551.0 samples/s | 29.5 steps/s
[Step= 550] | Loss=3.46169 | acc=0.1470 | tpr=0.5205 | fpr=0.8598 | 14648.5 samples/s | 57.2 steps/s
Avg test loss: 3.46265, Avg test acc: 0.14696, Avg tpr: 0.52100, Avg fpr: 0.85984, total FA: 119387

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11523 | acc=0.9809 | tpr=0.9248 | fpr=0.0181 | 4185.2 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.12069 | acc=0.9803 | tpr=0.9360 | fpr=0.0189 | 7753.6 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.12616 | acc=0.9789 | tpr=0.9380 | fpr=0.0203 | 7911.4 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.12859 | acc=0.9790 | tpr=0.9399 | fpr=0.0203 | 7727.6 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.12690 | acc=0.9792 | tpr=0.9389 | fpr=0.0201 | 7802.4 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.12760 | acc=0.9790 | tpr=0.9375 | fpr=0.0202 | 7987.2 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.12831 | acc=0.9789 | tpr=0.9374 | fpr=0.0203 | 8138.4 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.12945 | acc=0.9787 | tpr=0.9333 | fpr=0.0205 | 7746.3 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.13178 | acc=0.9784 | tpr=0.9284 | fpr=0.0207 | 7698.9 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.13135 | acc=0.9784 | tpr=0.9278 | fpr=0.0207 | 7864.6 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.13078 | acc=0.9785 | tpr=0.9268 | fpr=0.0206 | 14257.7 samples/s | 55.7 steps/s
Avg test loss: 0.13054, Avg test acc: 0.97851, Avg tpr: 0.92710, Avg fpr: 0.02055, total FA: 2854

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08782 | acc=0.9827 | tpr=0.9071 | fpr=0.0160 | 4133.0 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.09048 | acc=0.9814 | tpr=0.9190 | fpr=0.0174 | 8088.3 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.09341 | acc=0.9805 | tpr=0.9395 | fpr=0.0187 | 7681.6 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.09381 | acc=0.9807 | tpr=0.9454 | fpr=0.0186 | 8035.4 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.09404 | acc=0.9807 | tpr=0.9441 | fpr=0.0186 | 7832.9 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.09504 | acc=0.9804 | tpr=0.9433 | fpr=0.0189 | 7837.1 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.09553 | acc=0.9804 | tpr=0.9436 | fpr=0.0189 | 7823.4 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.09628 | acc=0.9803 | tpr=0.9415 | fpr=0.0190 | 7950.2 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.09789 | acc=0.9801 | tpr=0.9387 | fpr=0.0191 | 7757.2 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.09729 | acc=0.9802 | tpr=0.9388 | fpr=0.0190 | 7879.2 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.09707 | acc=0.9803 | tpr=0.9371 | fpr=0.0189 | 14739.1 samples/s | 57.6 steps/s
Avg test loss: 0.09696, Avg test acc: 0.98031, Avg tpr: 0.93700, Avg fpr: 0.01890, total FA: 2624

server round 4/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=15.6] | Loss=0.10752 | Reg=0.00201 | acc=0.9375 | L2-Norm=14.176 | L2-Norm(final)=5.885 | 4079.6 samples/s | 63.7 steps/s
[Step=8050 Epoch=15.7] | Loss=0.13176 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.187 | L2-Norm(final)=5.986 | 5311.9 samples/s | 83.0 steps/s
[Step=8100 Epoch=15.8] | Loss=0.13072 | Reg=0.00201 | acc=0.9062 | L2-Norm=14.189 | L2-Norm(final)=6.109 | 5612.8 samples/s | 87.7 steps/s
[Step=8150 Epoch=15.9] | Loss=0.13059 | Reg=0.00201 | acc=0.9375 | L2-Norm=14.189 | L2-Norm(final)=6.222 | 5467.2 samples/s | 85.4 steps/s
[Step=8200 Epoch=16.0] | Loss=0.12892 | Reg=0.00201 | acc=0.8594 | L2-Norm=14.190 | L2-Norm(final)=6.329 | 5580.5 samples/s | 87.2 steps/s
[Step=8250 Epoch=16.1] | Loss=0.12752 | Reg=0.00201 | acc=0.8750 | L2-Norm=14.190 | L2-Norm(final)=6.430 | 5483.1 samples/s | 85.7 steps/s
[Step=8300 Epoch=16.2] | Loss=0.12552 | Reg=0.00201 | acc=0.9219 | L2-Norm=14.190 | L2-Norm(final)=6.527 | 5548.5 samples/s | 86.7 steps/s
[Step=8350 Epoch=16.3] | Loss=0.12433 | Reg=0.00201 | acc=0.9062 | L2-Norm=14.190 | L2-Norm(final)=6.620 | 5573.3 samples/s | 87.1 steps/s
[Step=8400 Epoch=16.4] | Loss=0.12280 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.190 | L2-Norm(final)=6.708 | 5527.4 samples/s | 86.4 steps/s
[Step=8450 Epoch=16.5] | Loss=0.12270 | Reg=0.00201 | acc=0.9219 | L2-Norm=14.190 | L2-Norm(final)=6.791 | 5574.2 samples/s | 87.1 steps/s
[Step=8500 Epoch=16.6] | Loss=0.12190 | Reg=0.00201 | acc=0.8750 | L2-Norm=14.190 | L2-Norm(final)=6.870 | 6885.6 samples/s | 107.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=16.6] | Loss=0.11750 | Reg=0.00201 | acc=0.8906 | L2-Norm=14.191 | L2-Norm(final)=7.637 | 5027.3 samples/s | 78.6 steps/s
[Step=8550 Epoch=16.7] | Loss=0.07935 | Reg=0.00207 | acc=0.9375 | L2-Norm=14.382 | L2-Norm(final)=7.655 | 4563.0 samples/s | 71.3 steps/s
[Step=8600 Epoch=16.8] | Loss=0.07168 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.567 | L2-Norm(final)=7.644 | 4745.8 samples/s | 74.2 steps/s
[Step=8650 Epoch=16.9] | Loss=0.06868 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.705 | L2-Norm(final)=7.630 | 4700.0 samples/s | 73.4 steps/s
[Step=8700 Epoch=17.0] | Loss=0.06616 | Reg=0.00219 | acc=0.9375 | L2-Norm=14.811 | L2-Norm(final)=7.619 | 4805.4 samples/s | 75.1 steps/s
[Step=8750 Epoch=17.1] | Loss=0.06484 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.894 | L2-Norm(final)=7.608 | 4815.7 samples/s | 75.2 steps/s
[Step=8800 Epoch=17.2] | Loss=0.06371 | Reg=0.00224 | acc=0.9375 | L2-Norm=14.964 | L2-Norm(final)=7.598 | 4784.0 samples/s | 74.7 steps/s
[Step=8850 Epoch=17.3] | Loss=0.06129 | Reg=0.00226 | acc=0.9375 | L2-Norm=15.024 | L2-Norm(final)=7.588 | 4760.8 samples/s | 74.4 steps/s
[Step=8900 Epoch=17.4] | Loss=0.05993 | Reg=0.00227 | acc=0.9219 | L2-Norm=15.078 | L2-Norm(final)=7.579 | 4756.5 samples/s | 74.3 steps/s
[Step=8950 Epoch=17.5] | Loss=0.05877 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.128 | L2-Norm(final)=7.570 | 4861.1 samples/s | 76.0 steps/s
[Step=9000 Epoch=17.6] | Loss=0.05780 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.175 | L2-Norm(final)=7.563 | 5837.8 samples/s | 91.2 steps/s
[Step=9050 Epoch=17.7] | Loss=0.05597 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.221 | L2-Norm(final)=7.556 | 2046.6 samples/s | 32.0 steps/s
[Step=9100 Epoch=17.7] | Loss=0.05414 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.265 | L2-Norm(final)=7.550 | 4748.5 samples/s | 74.2 steps/s
[Step=9150 Epoch=17.8] | Loss=0.05319 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.306 | L2-Norm(final)=7.544 | 4891.7 samples/s | 76.4 steps/s
[Step=9200 Epoch=17.9] | Loss=0.05218 | Reg=0.00236 | acc=0.9531 | L2-Norm=15.345 | L2-Norm(final)=7.538 | 4746.4 samples/s | 74.2 steps/s
[Step=9250 Epoch=18.0] | Loss=0.05136 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.382 | L2-Norm(final)=7.532 | 4817.5 samples/s | 75.3 steps/s
[Step=9300 Epoch=18.1] | Loss=0.05014 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.416 | L2-Norm(final)=7.527 | 4845.7 samples/s | 75.7 steps/s
[Step=9350 Epoch=18.2] | Loss=0.04935 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.450 | L2-Norm(final)=7.523 | 4842.2 samples/s | 75.7 steps/s
[Step=9400 Epoch=18.3] | Loss=0.04870 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.483 | L2-Norm(final)=7.519 | 4795.4 samples/s | 74.9 steps/s
[Step=9450 Epoch=18.4] | Loss=0.04814 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.515 | L2-Norm(final)=7.514 | 4854.8 samples/s | 75.9 steps/s
[Step=9500 Epoch=18.5] | Loss=0.04761 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.546 | L2-Norm(final)=7.510 | 5086.9 samples/s | 79.5 steps/s
[Step=9550 Epoch=18.6] | Loss=0.04699 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.576 | L2-Norm(final)=7.505 | 2161.5 samples/s | 33.8 steps/s
[Step=9600 Epoch=18.7] | Loss=0.04599 | Reg=0.00244 | acc=0.9688 | L2-Norm=15.606 | L2-Norm(final)=7.500 | 4763.0 samples/s | 74.4 steps/s
[Step=9650 Epoch=18.8] | Loss=0.04521 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.635 | L2-Norm(final)=7.496 | 4723.4 samples/s | 73.8 steps/s
[Step=9700 Epoch=18.9] | Loss=0.04449 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.663 | L2-Norm(final)=7.493 | 4818.0 samples/s | 75.3 steps/s
[Step=9750 Epoch=19.0] | Loss=0.04392 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.689 | L2-Norm(final)=7.489 | 4795.1 samples/s | 74.9 steps/s
[Step=9800 Epoch=19.1] | Loss=0.04335 | Reg=0.00247 | acc=0.9531 | L2-Norm=15.716 | L2-Norm(final)=7.486 | 4782.7 samples/s | 74.7 steps/s
[Step=9850 Epoch=19.2] | Loss=0.04292 | Reg=0.00248 | acc=0.9688 | L2-Norm=15.741 | L2-Norm(final)=7.483 | 4774.9 samples/s | 74.6 steps/s
[Step=9900 Epoch=19.3] | Loss=0.04246 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.766 | L2-Norm(final)=7.480 | 4730.5 samples/s | 73.9 steps/s
[Step=9950 Epoch=19.4] | Loss=0.04201 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.790 | L2-Norm(final)=7.477 | 4819.6 samples/s | 75.3 steps/s
[Step=10000 Epoch=19.5] | Loss=0.04156 | Reg=0.00250 | acc=0.9531 | L2-Norm=15.814 | L2-Norm(final)=7.473 | 4826.6 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step10000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=15.6] | Loss=0.16973 | Reg=0.00201 | acc=0.8906 | L2-Norm=14.176 | L2-Norm(final)=6.436 | 4466.2 samples/s | 69.8 steps/s
[Step=8050 Epoch=15.7] | Loss=0.12918 | Reg=0.00201 | acc=0.9375 | L2-Norm=14.182 | L2-Norm(final)=6.523 | 5397.2 samples/s | 84.3 steps/s
[Step=8100 Epoch=15.8] | Loss=0.12177 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.183 | L2-Norm(final)=6.672 | 5531.8 samples/s | 86.4 steps/s
[Step=8150 Epoch=15.9] | Loss=0.11939 | Reg=0.00201 | acc=0.8906 | L2-Norm=14.183 | L2-Norm(final)=6.817 | 5601.4 samples/s | 87.5 steps/s
[Step=8200 Epoch=16.0] | Loss=0.11549 | Reg=0.00201 | acc=0.9062 | L2-Norm=14.184 | L2-Norm(final)=6.951 | 5404.4 samples/s | 84.4 steps/s
[Step=8250 Epoch=16.1] | Loss=0.11514 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.184 | L2-Norm(final)=7.076 | 5575.9 samples/s | 87.1 steps/s
[Step=8300 Epoch=16.2] | Loss=0.11351 | Reg=0.00201 | acc=0.8750 | L2-Norm=14.184 | L2-Norm(final)=7.190 | 5500.5 samples/s | 85.9 steps/s
[Step=8350 Epoch=16.3] | Loss=0.11271 | Reg=0.00201 | acc=0.9062 | L2-Norm=14.184 | L2-Norm(final)=7.297 | 5605.9 samples/s | 87.6 steps/s
[Step=8400 Epoch=16.4] | Loss=0.11105 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.184 | L2-Norm(final)=7.401 | 5470.5 samples/s | 85.5 steps/s
[Step=8450 Epoch=16.5] | Loss=0.11029 | Reg=0.00201 | acc=0.9375 | L2-Norm=14.184 | L2-Norm(final)=7.500 | 5493.4 samples/s | 85.8 steps/s
[Step=8500 Epoch=16.6] | Loss=0.10988 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.184 | L2-Norm(final)=7.592 | 7001.5 samples/s | 109.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=16.6] | Loss=0.09402 | Reg=0.00201 | acc=0.9219 | L2-Norm=14.184 | L2-Norm(final)=8.490 | 4574.9 samples/s | 71.5 steps/s
[Step=8550 Epoch=16.7] | Loss=0.07555 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.383 | L2-Norm(final)=8.502 | 4699.3 samples/s | 73.4 steps/s
[Step=8600 Epoch=16.8] | Loss=0.07074 | Reg=0.00212 | acc=0.9375 | L2-Norm=14.575 | L2-Norm(final)=8.478 | 4784.9 samples/s | 74.8 steps/s
[Step=8650 Epoch=16.9] | Loss=0.06659 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.708 | L2-Norm(final)=8.463 | 4761.5 samples/s | 74.4 steps/s
[Step=8700 Epoch=17.0] | Loss=0.06507 | Reg=0.00219 | acc=0.9531 | L2-Norm=14.810 | L2-Norm(final)=8.452 | 4789.8 samples/s | 74.8 steps/s
[Step=8750 Epoch=17.1] | Loss=0.06302 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.892 | L2-Norm(final)=8.441 | 4762.1 samples/s | 74.4 steps/s
[Step=8800 Epoch=17.2] | Loss=0.06130 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.966 | L2-Norm(final)=8.433 | 4763.9 samples/s | 74.4 steps/s
[Step=8850 Epoch=17.3] | Loss=0.05953 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.031 | L2-Norm(final)=8.425 | 4770.1 samples/s | 74.5 steps/s
[Step=8900 Epoch=17.4] | Loss=0.05847 | Reg=0.00228 | acc=0.9375 | L2-Norm=15.091 | L2-Norm(final)=8.417 | 4778.0 samples/s | 74.7 steps/s
[Step=8950 Epoch=17.5] | Loss=0.05729 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.147 | L2-Norm(final)=8.410 | 4743.2 samples/s | 74.1 steps/s
[Step=9000 Epoch=17.6] | Loss=0.05737 | Reg=0.00231 | acc=0.9688 | L2-Norm=15.199 | L2-Norm(final)=8.402 | 5927.8 samples/s | 92.6 steps/s
[Step=9050 Epoch=17.7] | Loss=0.05507 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.248 | L2-Norm(final)=8.395 | 2124.6 samples/s | 33.2 steps/s
[Step=9100 Epoch=17.8] | Loss=0.05300 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.293 | L2-Norm(final)=8.390 | 4665.7 samples/s | 72.9 steps/s
[Step=9150 Epoch=17.9] | Loss=0.05172 | Reg=0.00235 | acc=0.9531 | L2-Norm=15.334 | L2-Norm(final)=8.384 | 4604.4 samples/s | 71.9 steps/s
[Step=9200 Epoch=18.0] | Loss=0.05033 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.372 | L2-Norm(final)=8.379 | 4625.5 samples/s | 72.3 steps/s
[Step=9250 Epoch=18.1] | Loss=0.04924 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.408 | L2-Norm(final)=8.374 | 4593.3 samples/s | 71.8 steps/s
[Step=9300 Epoch=18.2] | Loss=0.04831 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.441 | L2-Norm(final)=8.369 | 4612.0 samples/s | 72.1 steps/s
[Step=9350 Epoch=18.3] | Loss=0.04800 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.474 | L2-Norm(final)=8.364 | 4783.3 samples/s | 74.7 steps/s
[Step=9400 Epoch=18.4] | Loss=0.04736 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.504 | L2-Norm(final)=8.358 | 4769.7 samples/s | 74.5 steps/s
[Step=9450 Epoch=18.5] | Loss=0.04673 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.534 | L2-Norm(final)=8.353 | 4766.5 samples/s | 74.5 steps/s
[Step=9500 Epoch=18.6] | Loss=0.04592 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.562 | L2-Norm(final)=8.348 | 5180.8 samples/s | 80.9 steps/s
[Step=9550 Epoch=18.7] | Loss=0.04532 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.590 | L2-Norm(final)=8.343 | 2165.5 samples/s | 33.8 steps/s
[Step=9600 Epoch=18.8] | Loss=0.04453 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.618 | L2-Norm(final)=8.339 | 4802.3 samples/s | 75.0 steps/s
[Step=9650 Epoch=18.9] | Loss=0.04361 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.645 | L2-Norm(final)=8.335 | 4756.6 samples/s | 74.3 steps/s
[Step=9700 Epoch=19.0] | Loss=0.04300 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.670 | L2-Norm(final)=8.331 | 4813.8 samples/s | 75.2 steps/s
[Step=9750 Epoch=19.1] | Loss=0.04255 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.695 | L2-Norm(final)=8.327 | 4797.8 samples/s | 75.0 steps/s
[Step=9800 Epoch=19.2] | Loss=0.04195 | Reg=0.00247 | acc=0.9688 | L2-Norm=15.721 | L2-Norm(final)=8.323 | 4852.7 samples/s | 75.8 steps/s
[Step=9850 Epoch=19.3] | Loss=0.04163 | Reg=0.00248 | acc=0.9531 | L2-Norm=15.745 | L2-Norm(final)=8.319 | 4755.6 samples/s | 74.3 steps/s
[Step=9900 Epoch=19.4] | Loss=0.04143 | Reg=0.00249 | acc=0.9688 | L2-Norm=15.771 | L2-Norm(final)=8.315 | 4814.0 samples/s | 75.2 steps/s
[Step=9950 Epoch=19.5] | Loss=0.04116 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.796 | L2-Norm(final)=8.311 | 4754.2 samples/s | 74.3 steps/s
[Step=10000 Epoch=19.5] | Loss=0.04059 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.822 | L2-Norm(final)=8.307 | 4774.1 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step10000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=30.7] | Loss=0.02057 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.176 | L2-Norm(final)=7.929 | 4152.3 samples/s | 64.9 steps/s
[Step=8050 Epoch=30.8] | Loss=0.01671 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.164 | L2-Norm(final)=7.972 | 4915.3 samples/s | 76.8 steps/s
[Step=8100 Epoch=31.0] | Loss=0.01499 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.163 | L2-Norm(final)=8.055 | 5356.9 samples/s | 83.7 steps/s
[Step=8150 Epoch=31.2] | Loss=0.01396 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.162 | L2-Norm(final)=8.147 | 5046.4 samples/s | 78.9 steps/s
[Step=8200 Epoch=31.4] | Loss=0.01343 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.162 | L2-Norm(final)=8.243 | 5191.0 samples/s | 81.1 steps/s
[Step=8250 Epoch=31.6] | Loss=0.01277 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.162 | L2-Norm(final)=8.336 | 6901.9 samples/s | 107.8 steps/s
[Step=8300 Epoch=31.8] | Loss=0.01236 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.162 | L2-Norm(final)=8.426 | 2166.0 samples/s | 33.8 steps/s
[Step=8350 Epoch=32.0] | Loss=0.01199 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.162 | L2-Norm(final)=8.513 | 5294.2 samples/s | 82.7 steps/s
[Step=8400 Epoch=32.2] | Loss=0.01150 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.162 | L2-Norm(final)=8.597 | 5106.1 samples/s | 79.8 steps/s
[Step=8450 Epoch=32.4] | Loss=0.01151 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.162 | L2-Norm(final)=8.676 | 5164.8 samples/s | 80.7 steps/s
[Step=8500 Epoch=32.6] | Loss=0.01136 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.162 | L2-Norm(final)=8.750 | 5945.2 samples/s | 92.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=32.6] | Loss=0.00616 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.161 | L2-Norm(final)=9.478 | 4607.4 samples/s | 72.0 steps/s
[Step=8550 Epoch=32.8] | Loss=0.02129 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.451 | L2-Norm(final)=9.466 | 4320.6 samples/s | 67.5 steps/s
[Step=8600 Epoch=33.0] | Loss=0.02192 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.723 | L2-Norm(final)=9.416 | 4631.8 samples/s | 72.4 steps/s
[Step=8650 Epoch=33.1] | Loss=0.01639 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.848 | L2-Norm(final)=9.384 | 4571.8 samples/s | 71.4 steps/s
[Step=8700 Epoch=33.3] | Loss=0.01328 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.909 | L2-Norm(final)=9.369 | 4588.6 samples/s | 71.7 steps/s
[Step=8750 Epoch=33.5] | Loss=0.01105 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.940 | L2-Norm(final)=9.360 | 5760.0 samples/s | 90.0 steps/s
[Step=8800 Epoch=33.7] | Loss=0.00951 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.951 | L2-Norm(final)=9.356 | 2015.7 samples/s | 31.5 steps/s
[Step=8850 Epoch=33.9] | Loss=0.00835 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.947 | L2-Norm(final)=9.354 | 4542.2 samples/s | 71.0 steps/s
[Step=8900 Epoch=34.1] | Loss=0.00744 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.934 | L2-Norm(final)=9.353 | 4540.7 samples/s | 70.9 steps/s
[Step=8950 Epoch=34.3] | Loss=0.00664 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.915 | L2-Norm(final)=9.353 | 4544.4 samples/s | 71.0 steps/s
[Step=9000 Epoch=34.5] | Loss=0.00598 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.892 | L2-Norm(final)=9.354 | 5040.8 samples/s | 78.8 steps/s
[Step=9050 Epoch=34.7] | Loss=0.00544 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.865 | L2-Norm(final)=9.355 | 2138.9 samples/s | 33.4 steps/s
[Step=9100 Epoch=34.9] | Loss=0.00499 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.836 | L2-Norm(final)=9.356 | 4544.8 samples/s | 71.0 steps/s
[Step=9150 Epoch=35.1] | Loss=0.00461 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.805 | L2-Norm(final)=9.356 | 4638.2 samples/s | 72.5 steps/s
[Step=9200 Epoch=35.3] | Loss=0.00428 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.774 | L2-Norm(final)=9.357 | 4503.8 samples/s | 70.4 steps/s
[Step=9250 Epoch=35.4] | Loss=0.00399 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.741 | L2-Norm(final)=9.358 | 4609.1 samples/s | 72.0 steps/s
[Step=9300 Epoch=35.6] | Loss=0.00374 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.707 | L2-Norm(final)=9.359 | 2184.9 samples/s | 34.1 steps/s
[Step=9350 Epoch=35.8] | Loss=0.00352 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.673 | L2-Norm(final)=9.359 | 4640.0 samples/s | 72.5 steps/s
[Step=9400 Epoch=36.0] | Loss=0.00333 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.639 | L2-Norm(final)=9.360 | 4566.9 samples/s | 71.4 steps/s
[Step=9450 Epoch=36.2] | Loss=0.00315 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.605 | L2-Norm(final)=9.361 | 4556.3 samples/s | 71.2 steps/s
[Step=9500 Epoch=36.4] | Loss=0.00300 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.571 | L2-Norm(final)=9.361 | 4638.6 samples/s | 72.5 steps/s
[Step=9550 Epoch=36.6] | Loss=0.00285 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.536 | L2-Norm(final)=9.362 | 2171.1 samples/s | 33.9 steps/s
[Step=9600 Epoch=36.8] | Loss=0.00273 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.502 | L2-Norm(final)=9.363 | 4558.0 samples/s | 71.2 steps/s
[Step=9650 Epoch=37.0] | Loss=0.00261 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.468 | L2-Norm(final)=9.363 | 4598.7 samples/s | 71.9 steps/s
[Step=9700 Epoch=37.2] | Loss=0.00250 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.433 | L2-Norm(final)=9.364 | 4494.5 samples/s | 70.2 steps/s
[Step=9750 Epoch=37.4] | Loss=0.00240 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.399 | L2-Norm(final)=9.364 | 4541.3 samples/s | 71.0 steps/s
[Step=9800 Epoch=37.6] | Loss=0.00231 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.365 | L2-Norm(final)=9.365 | 6188.7 samples/s | 96.7 steps/s
[Step=9850 Epoch=37.7] | Loss=0.00222 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.332 | L2-Norm(final)=9.366 | 1959.5 samples/s | 30.6 steps/s
[Step=9900 Epoch=37.9] | Loss=0.00214 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.298 | L2-Norm(final)=9.366 | 4559.8 samples/s | 71.2 steps/s
[Step=9950 Epoch=38.1] | Loss=0.00207 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.264 | L2-Norm(final)=9.367 | 4640.9 samples/s | 72.5 steps/s
[Step=10000 Epoch=38.3] | Loss=0.00200 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.231 | L2-Norm(final)=9.367 | 4551.0 samples/s | 71.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step10000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=30.8] | Loss=0.03152 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.176 | L2-Norm(final)=7.961 | 4680.2 samples/s | 73.1 steps/s
[Step=8050 Epoch=31.0] | Loss=0.01756 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.165 | L2-Norm(final)=8.009 | 4419.7 samples/s | 69.1 steps/s
[Step=8100 Epoch=31.2] | Loss=0.01496 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.164 | L2-Norm(final)=8.096 | 5225.6 samples/s | 81.7 steps/s
[Step=8150 Epoch=31.4] | Loss=0.01418 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.163 | L2-Norm(final)=8.199 | 5248.1 samples/s | 82.0 steps/s
[Step=8200 Epoch=31.6] | Loss=0.01348 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.163 | L2-Norm(final)=8.305 | 5275.1 samples/s | 82.4 steps/s
[Step=8250 Epoch=31.8] | Loss=0.01332 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.163 | L2-Norm(final)=8.404 | 6951.9 samples/s | 108.6 steps/s
[Step=8300 Epoch=31.9] | Loss=0.01269 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.163 | L2-Norm(final)=8.498 | 2138.3 samples/s | 33.4 steps/s
[Step=8350 Epoch=32.1] | Loss=0.01260 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.163 | L2-Norm(final)=8.589 | 5173.3 samples/s | 80.8 steps/s
[Step=8400 Epoch=32.3] | Loss=0.01217 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.163 | L2-Norm(final)=8.675 | 5256.0 samples/s | 82.1 steps/s
[Step=8450 Epoch=32.5] | Loss=0.01197 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.163 | L2-Norm(final)=8.759 | 5190.2 samples/s | 81.1 steps/s
[Step=8500 Epoch=32.7] | Loss=0.01179 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.163 | L2-Norm(final)=8.840 | 5915.4 samples/s | 92.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=32.7] | Loss=0.01379 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.162 | L2-Norm(final)=9.619 | 4239.3 samples/s | 66.2 steps/s
[Step=8550 Epoch=32.9] | Loss=0.03112 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.454 | L2-Norm(final)=9.596 | 4646.9 samples/s | 72.6 steps/s
[Step=8600 Epoch=33.1] | Loss=0.02153 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.779 | L2-Norm(final)=9.545 | 4541.0 samples/s | 71.0 steps/s
[Step=8650 Epoch=33.3] | Loss=0.01566 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.921 | L2-Norm(final)=9.519 | 4588.0 samples/s | 71.7 steps/s
[Step=8700 Epoch=33.5] | Loss=0.01320 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.986 | L2-Norm(final)=9.508 | 4498.0 samples/s | 70.3 steps/s
[Step=8750 Epoch=33.7] | Loss=0.01125 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.021 | L2-Norm(final)=9.501 | 5820.6 samples/s | 90.9 steps/s
[Step=8800 Epoch=33.9] | Loss=0.00975 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.041 | L2-Norm(final)=9.496 | 2015.9 samples/s | 31.5 steps/s
[Step=8850 Epoch=34.1] | Loss=0.00869 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.047 | L2-Norm(final)=9.494 | 4510.7 samples/s | 70.5 steps/s
[Step=8900 Epoch=34.3] | Loss=0.00770 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.046 | L2-Norm(final)=9.492 | 4520.7 samples/s | 70.6 steps/s
[Step=8950 Epoch=34.5] | Loss=0.00701 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.039 | L2-Norm(final)=9.491 | 4564.2 samples/s | 71.3 steps/s
[Step=9000 Epoch=34.6] | Loss=0.00655 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.030 | L2-Norm(final)=9.489 | 5124.9 samples/s | 80.1 steps/s
[Step=9050 Epoch=34.8] | Loss=0.00598 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.019 | L2-Norm(final)=9.488 | 2092.5 samples/s | 32.7 steps/s
[Step=9100 Epoch=35.0] | Loss=0.00575 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.005 | L2-Norm(final)=9.486 | 4624.2 samples/s | 72.3 steps/s
[Step=9150 Epoch=35.2] | Loss=0.00532 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.989 | L2-Norm(final)=9.483 | 4446.1 samples/s | 69.5 steps/s
[Step=9200 Epoch=35.4] | Loss=0.00494 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.970 | L2-Norm(final)=9.481 | 4522.4 samples/s | 70.7 steps/s
[Step=9250 Epoch=35.6] | Loss=0.00469 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.950 | L2-Norm(final)=9.479 | 4651.6 samples/s | 72.7 steps/s
[Step=9300 Epoch=35.8] | Loss=0.00440 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.929 | L2-Norm(final)=9.478 | 2200.0 samples/s | 34.4 steps/s
[Step=9350 Epoch=36.0] | Loss=0.00414 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.906 | L2-Norm(final)=9.477 | 4619.2 samples/s | 72.2 steps/s
[Step=9400 Epoch=36.2] | Loss=0.00391 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.882 | L2-Norm(final)=9.476 | 4497.3 samples/s | 70.3 steps/s
[Step=9450 Epoch=36.4] | Loss=0.00370 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.858 | L2-Norm(final)=9.475 | 4567.6 samples/s | 71.4 steps/s
[Step=9500 Epoch=36.6] | Loss=0.00352 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.832 | L2-Norm(final)=9.474 | 4582.3 samples/s | 71.6 steps/s
[Step=9550 Epoch=36.8] | Loss=0.00335 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.805 | L2-Norm(final)=9.474 | 2218.5 samples/s | 34.7 steps/s
[Step=9600 Epoch=37.0] | Loss=0.00320 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.779 | L2-Norm(final)=9.473 | 4555.3 samples/s | 71.2 steps/s
[Step=9650 Epoch=37.1] | Loss=0.00306 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.751 | L2-Norm(final)=9.473 | 4542.3 samples/s | 71.0 steps/s
[Step=9700 Epoch=37.3] | Loss=0.00293 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.723 | L2-Norm(final)=9.473 | 4538.5 samples/s | 70.9 steps/s
[Step=9750 Epoch=37.5] | Loss=0.00282 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.696 | L2-Norm(final)=9.473 | 4586.8 samples/s | 71.7 steps/s
[Step=9800 Epoch=37.7] | Loss=0.00271 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.667 | L2-Norm(final)=9.472 | 6597.1 samples/s | 103.1 steps/s
[Step=9850 Epoch=37.9] | Loss=0.00261 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.639 | L2-Norm(final)=9.472 | 1928.9 samples/s | 30.1 steps/s
[Step=9900 Epoch=38.1] | Loss=0.00252 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.610 | L2-Norm(final)=9.472 | 4530.7 samples/s | 70.8 steps/s
[Step=9950 Epoch=38.3] | Loss=0.00243 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.582 | L2-Norm(final)=9.472 | 4549.3 samples/s | 71.1 steps/s
[Step=10000 Epoch=38.5] | Loss=0.00235 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.553 | L2-Norm(final)=9.472 | 4558.4 samples/s | 71.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08030 | acc=0.9571 | tpr=0.9686 | fpr=0.0679 | 4242.3 samples/s | 16.6 steps/s
Avg test loss: 0.07979, Avg test acc: 0.95569, Avg tpr: 0.96654, Avg fpr: 0.06820, total FA: 532

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07897 | acc=0.9553 | tpr=0.9603 | fpr=0.0555 | 4161.6 samples/s | 16.3 steps/s
Avg test loss: 0.07988, Avg test acc: 0.95440, Avg tpr: 0.95920, Avg fpr: 0.05615, total FA: 438

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.76176 | acc=0.3137 | tpr=0.0037 | fpr=0.0129 | 4123.1 samples/s | 16.1 steps/s
Avg test loss: 5.77102, Avg test acc: 0.31100, Avg tpr: 0.00356, Avg fpr: 0.01282, total FA: 100

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.94270 | acc=0.3117 | tpr=0.0037 | fpr=0.0193 | 4174.3 samples/s | 16.3 steps/s
Avg test loss: 4.94391, Avg test acc: 0.30948, Avg tpr: 0.00443, Avg fpr: 0.01961, total FA: 153

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.62517 | acc=0.0827 | tpr=0.6903 | fpr=0.9283 | 4187.2 samples/s | 16.4 steps/s
[Step= 100] | Loss=5.59206 | acc=0.0827 | tpr=0.6695 | fpr=0.9283 | 7723.6 samples/s | 30.2 steps/s
[Step= 150] | Loss=5.59760 | acc=0.0814 | tpr=0.6801 | fpr=0.9296 | 7894.9 samples/s | 30.8 steps/s
[Step= 200] | Loss=5.60045 | acc=0.0814 | tpr=0.6732 | fpr=0.9293 | 7835.7 samples/s | 30.6 steps/s
[Step= 250] | Loss=5.60136 | acc=0.0813 | tpr=0.6769 | fpr=0.9295 | 7875.9 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.59957 | acc=0.0815 | tpr=0.6713 | fpr=0.9293 | 7868.7 samples/s | 30.7 steps/s
[Step= 350] | Loss=5.59937 | acc=0.0810 | tpr=0.6675 | fpr=0.9297 | 7998.0 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.59338 | acc=0.0808 | tpr=0.6658 | fpr=0.9298 | 7820.9 samples/s | 30.6 steps/s
[Step= 450] | Loss=5.59371 | acc=0.0806 | tpr=0.6650 | fpr=0.9300 | 7857.6 samples/s | 30.7 steps/s
[Step= 500] | Loss=5.59455 | acc=0.0806 | tpr=0.6665 | fpr=0.9300 | 7805.3 samples/s | 30.5 steps/s
[Step= 550] | Loss=5.59191 | acc=0.0809 | tpr=0.6677 | fpr=0.9297 | 14432.3 samples/s | 56.4 steps/s
Avg test loss: 5.59383, Avg test acc: 0.08089, Avg tpr: 0.66799, Avg fpr: 0.92979, total FA: 129099

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.11027 | acc=0.1152 | tpr=0.7876 | fpr=0.8969 | 4005.2 samples/s | 15.6 steps/s
[Step= 100] | Loss=6.08261 | acc=0.1158 | tpr=0.7505 | fpr=0.8961 | 7723.1 samples/s | 30.2 steps/s
[Step= 150] | Loss=6.09589 | acc=0.1151 | tpr=0.7565 | fpr=0.8967 | 7904.9 samples/s | 30.9 steps/s
[Step= 200] | Loss=6.08504 | acc=0.1157 | tpr=0.7541 | fpr=0.8959 | 7769.6 samples/s | 30.4 steps/s
[Step= 250] | Loss=6.08261 | acc=0.1161 | tpr=0.7528 | fpr=0.8955 | 7878.0 samples/s | 30.8 steps/s
[Step= 300] | Loss=6.08678 | acc=0.1159 | tpr=0.7491 | fpr=0.8956 | 8104.7 samples/s | 31.7 steps/s
[Step= 350] | Loss=6.08711 | acc=0.1154 | tpr=0.7376 | fpr=0.8959 | 7724.7 samples/s | 30.2 steps/s
[Step= 400] | Loss=6.07410 | acc=0.1156 | tpr=0.7407 | fpr=0.8958 | 7878.3 samples/s | 30.8 steps/s
[Step= 450] | Loss=6.07797 | acc=0.1155 | tpr=0.7425 | fpr=0.8959 | 7757.9 samples/s | 30.3 steps/s
[Step= 500] | Loss=6.07942 | acc=0.1154 | tpr=0.7458 | fpr=0.8960 | 7682.1 samples/s | 30.0 steps/s
[Step= 550] | Loss=6.07990 | acc=0.1156 | tpr=0.7473 | fpr=0.8958 | 14471.5 samples/s | 56.5 steps/s
Avg test loss: 6.08130, Avg test acc: 0.11552, Avg tpr: 0.74762, Avg fpr: 0.89597, total FA: 124403

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10863 | acc=0.9814 | tpr=0.9115 | fpr=0.0173 | 4177.6 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.11700 | acc=0.9810 | tpr=0.9339 | fpr=0.0181 | 7751.9 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.12063 | acc=0.9806 | tpr=0.9409 | fpr=0.0187 | 7831.1 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.12246 | acc=0.9805 | tpr=0.9421 | fpr=0.0188 | 7909.3 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.12239 | acc=0.9805 | tpr=0.9389 | fpr=0.0188 | 7907.2 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.12312 | acc=0.9801 | tpr=0.9404 | fpr=0.0191 | 7951.5 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.12350 | acc=0.9801 | tpr=0.9399 | fpr=0.0192 | 7775.8 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.12507 | acc=0.9797 | tpr=0.9349 | fpr=0.0195 | 7895.4 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.12753 | acc=0.9794 | tpr=0.9328 | fpr=0.0197 | 7781.0 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.12714 | acc=0.9795 | tpr=0.9322 | fpr=0.0197 | 8142.4 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.12671 | acc=0.9796 | tpr=0.9304 | fpr=0.0195 | 14044.2 samples/s | 54.9 steps/s
Avg test loss: 0.12648, Avg test acc: 0.97959, Avg tpr: 0.93027, Avg fpr: 0.01952, total FA: 2710

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12440 | acc=0.9805 | tpr=0.9292 | fpr=0.0185 | 4196.2 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.13172 | acc=0.9800 | tpr=0.9424 | fpr=0.0193 | 7775.0 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.13412 | acc=0.9793 | tpr=0.9496 | fpr=0.0201 | 7958.6 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.13608 | acc=0.9792 | tpr=0.9530 | fpr=0.0203 | 7586.9 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.13592 | acc=0.9791 | tpr=0.9493 | fpr=0.0203 | 8160.7 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.13779 | acc=0.9787 | tpr=0.9469 | fpr=0.0207 | 7911.0 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.13827 | acc=0.9784 | tpr=0.9474 | fpr=0.0211 | 7710.3 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.13956 | acc=0.9783 | tpr=0.9447 | fpr=0.0211 | 7806.2 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.14182 | acc=0.9780 | tpr=0.9440 | fpr=0.0214 | 7820.1 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.14083 | acc=0.9781 | tpr=0.9463 | fpr=0.0213 | 7960.2 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.14008 | acc=0.9782 | tpr=0.9455 | fpr=0.0212 | 14543.5 samples/s | 56.8 steps/s
Avg test loss: 0.13997, Avg test acc: 0.97819, Avg tpr: 0.94572, Avg fpr: 0.02122, total FA: 2947

server round 5/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=19.5] | Loss=0.12384 | Reg=0.00189 | acc=0.8906 | L2-Norm=13.757 | L2-Norm(final)=7.381 | 4013.0 samples/s | 62.7 steps/s
[Step=10050 Epoch=19.6] | Loss=0.11049 | Reg=0.00189 | acc=0.8125 | L2-Norm=13.763 | L2-Norm(final)=7.443 | 5231.0 samples/s | 81.7 steps/s
[Step=10100 Epoch=19.7] | Loss=0.10968 | Reg=0.00189 | acc=0.8906 | L2-Norm=13.765 | L2-Norm(final)=7.533 | 5489.4 samples/s | 85.8 steps/s
[Step=10150 Epoch=19.8] | Loss=0.10885 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.765 | L2-Norm(final)=7.630 | 5564.4 samples/s | 86.9 steps/s
[Step=10200 Epoch=19.9] | Loss=0.10782 | Reg=0.00189 | acc=0.8750 | L2-Norm=13.765 | L2-Norm(final)=7.724 | 5615.7 samples/s | 87.7 steps/s
[Step=10250 Epoch=20.0] | Loss=0.10680 | Reg=0.00189 | acc=0.9375 | L2-Norm=13.766 | L2-Norm(final)=7.815 | 5420.4 samples/s | 84.7 steps/s
[Step=10300 Epoch=20.1] | Loss=0.10582 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.766 | L2-Norm(final)=7.903 | 5542.3 samples/s | 86.6 steps/s
[Step=10350 Epoch=20.2] | Loss=0.10450 | Reg=0.00189 | acc=0.9375 | L2-Norm=13.766 | L2-Norm(final)=7.987 | 5582.4 samples/s | 87.2 steps/s
[Step=10400 Epoch=20.3] | Loss=0.10394 | Reg=0.00189 | acc=0.9062 | L2-Norm=13.766 | L2-Norm(final)=8.069 | 5570.2 samples/s | 87.0 steps/s
[Step=10450 Epoch=20.4] | Loss=0.10354 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.766 | L2-Norm(final)=8.147 | 5505.3 samples/s | 86.0 steps/s
[Step=10500 Epoch=20.5] | Loss=0.10293 | Reg=0.00189 | acc=0.9219 | L2-Norm=13.766 | L2-Norm(final)=8.224 | 6926.3 samples/s | 108.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=20.5] | Loss=0.08108 | Reg=0.00190 | acc=0.9375 | L2-Norm=13.766 | L2-Norm(final)=8.977 | 4405.6 samples/s | 68.8 steps/s
[Step=10550 Epoch=20.6] | Loss=0.07214 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.943 | L2-Norm(final)=8.996 | 4443.2 samples/s | 69.4 steps/s
[Step=10600 Epoch=20.7] | Loss=0.06674 | Reg=0.00199 | acc=0.9375 | L2-Norm=14.101 | L2-Norm(final)=8.975 | 4773.4 samples/s | 74.6 steps/s
[Step=10650 Epoch=20.8] | Loss=0.06243 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.219 | L2-Norm(final)=8.962 | 4829.9 samples/s | 75.5 steps/s
[Step=10700 Epoch=20.9] | Loss=0.06121 | Reg=0.00205 | acc=0.9062 | L2-Norm=14.321 | L2-Norm(final)=8.952 | 4748.7 samples/s | 74.2 steps/s
[Step=10750 Epoch=21.0] | Loss=0.05967 | Reg=0.00208 | acc=0.9531 | L2-Norm=14.408 | L2-Norm(final)=8.945 | 4885.3 samples/s | 76.3 steps/s
[Step=10800 Epoch=21.1] | Loss=0.05746 | Reg=0.00210 | acc=0.9219 | L2-Norm=14.482 | L2-Norm(final)=8.937 | 4798.0 samples/s | 75.0 steps/s
[Step=10850 Epoch=21.2] | Loss=0.05718 | Reg=0.00212 | acc=0.9375 | L2-Norm=14.549 | L2-Norm(final)=8.927 | 4891.5 samples/s | 76.4 steps/s
[Step=10900 Epoch=21.3] | Loss=0.05552 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.614 | L2-Norm(final)=8.917 | 4733.6 samples/s | 74.0 steps/s
[Step=10950 Epoch=21.4] | Loss=0.05531 | Reg=0.00215 | acc=0.9375 | L2-Norm=14.674 | L2-Norm(final)=8.908 | 4891.8 samples/s | 76.4 steps/s
[Step=11000 Epoch=21.5] | Loss=0.05418 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.731 | L2-Norm(final)=8.899 | 5808.7 samples/s | 90.8 steps/s
[Step=11050 Epoch=21.6] | Loss=0.05240 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.781 | L2-Norm(final)=8.890 | 2031.0 samples/s | 31.7 steps/s
[Step=11100 Epoch=21.6] | Loss=0.05063 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.827 | L2-Norm(final)=8.882 | 4766.9 samples/s | 74.5 steps/s
[Step=11150 Epoch=21.7] | Loss=0.04977 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.870 | L2-Norm(final)=8.875 | 4883.3 samples/s | 76.3 steps/s
[Step=11200 Epoch=21.8] | Loss=0.04852 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.909 | L2-Norm(final)=8.867 | 4687.2 samples/s | 73.2 steps/s
[Step=11250 Epoch=21.9] | Loss=0.04731 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.947 | L2-Norm(final)=8.861 | 4775.4 samples/s | 74.6 steps/s
[Step=11300 Epoch=22.0] | Loss=0.04644 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.983 | L2-Norm(final)=8.855 | 4845.1 samples/s | 75.7 steps/s
[Step=11350 Epoch=22.1] | Loss=0.04558 | Reg=0.00226 | acc=0.9531 | L2-Norm=15.017 | L2-Norm(final)=8.850 | 4810.7 samples/s | 75.2 steps/s
[Step=11400 Epoch=22.2] | Loss=0.04499 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.050 | L2-Norm(final)=8.844 | 4824.7 samples/s | 75.4 steps/s
[Step=11450 Epoch=22.3] | Loss=0.04442 | Reg=0.00228 | acc=0.9688 | L2-Norm=15.081 | L2-Norm(final)=8.838 | 4848.1 samples/s | 75.8 steps/s
[Step=11500 Epoch=22.4] | Loss=0.04406 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.112 | L2-Norm(final)=8.833 | 5034.3 samples/s | 78.7 steps/s
[Step=11550 Epoch=22.5] | Loss=0.04327 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.143 | L2-Norm(final)=8.828 | 2152.3 samples/s | 33.6 steps/s
[Step=11600 Epoch=22.6] | Loss=0.04252 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.173 | L2-Norm(final)=8.824 | 4756.4 samples/s | 74.3 steps/s
[Step=11650 Epoch=22.7] | Loss=0.04200 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.202 | L2-Norm(final)=8.820 | 4789.3 samples/s | 74.8 steps/s
[Step=11700 Epoch=22.8] | Loss=0.04150 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.231 | L2-Norm(final)=8.816 | 4769.3 samples/s | 74.5 steps/s
[Step=11750 Epoch=22.9] | Loss=0.04101 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.260 | L2-Norm(final)=8.812 | 4767.5 samples/s | 74.5 steps/s
[Step=11800 Epoch=23.0] | Loss=0.04036 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.289 | L2-Norm(final)=8.808 | 4831.4 samples/s | 75.5 steps/s
[Step=11850 Epoch=23.1] | Loss=0.03988 | Reg=0.00235 | acc=0.9688 | L2-Norm=15.317 | L2-Norm(final)=8.804 | 4822.8 samples/s | 75.4 steps/s
[Step=11900 Epoch=23.2] | Loss=0.03963 | Reg=0.00236 | acc=0.9531 | L2-Norm=15.345 | L2-Norm(final)=8.800 | 4830.8 samples/s | 75.5 steps/s
[Step=11950 Epoch=23.3] | Loss=0.03931 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.372 | L2-Norm(final)=8.796 | 4840.5 samples/s | 75.6 steps/s
[Step=12000 Epoch=23.4] | Loss=0.03915 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.401 | L2-Norm(final)=8.792 | 4813.1 samples/s | 75.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step12000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=19.6] | Loss=0.09080 | Reg=0.00189 | acc=0.9219 | L2-Norm=13.757 | L2-Norm(final)=8.193 | 4195.6 samples/s | 65.6 steps/s
[Step=10050 Epoch=19.6] | Loss=0.13422 | Reg=0.00189 | acc=0.9375 | L2-Norm=13.764 | L2-Norm(final)=8.216 | 5260.8 samples/s | 82.2 steps/s
[Step=10100 Epoch=19.7] | Loss=0.12174 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.765 | L2-Norm(final)=8.316 | 5549.2 samples/s | 86.7 steps/s
[Step=10150 Epoch=19.8] | Loss=0.11833 | Reg=0.00189 | acc=0.9062 | L2-Norm=13.765 | L2-Norm(final)=8.432 | 5606.8 samples/s | 87.6 steps/s
[Step=10200 Epoch=19.9] | Loss=0.11555 | Reg=0.00189 | acc=0.8594 | L2-Norm=13.766 | L2-Norm(final)=8.544 | 5542.6 samples/s | 86.6 steps/s
[Step=10250 Epoch=20.0] | Loss=0.11406 | Reg=0.00189 | acc=0.8750 | L2-Norm=13.766 | L2-Norm(final)=8.652 | 5626.9 samples/s | 87.9 steps/s
[Step=10300 Epoch=20.1] | Loss=0.11344 | Reg=0.00189 | acc=0.9219 | L2-Norm=13.766 | L2-Norm(final)=8.753 | 5514.6 samples/s | 86.2 steps/s
[Step=10350 Epoch=20.2] | Loss=0.11222 | Reg=0.00190 | acc=0.8594 | L2-Norm=13.766 | L2-Norm(final)=8.847 | 5624.1 samples/s | 87.9 steps/s
[Step=10400 Epoch=20.3] | Loss=0.11115 | Reg=0.00190 | acc=0.9375 | L2-Norm=13.766 | L2-Norm(final)=8.938 | 5492.0 samples/s | 85.8 steps/s
[Step=10450 Epoch=20.4] | Loss=0.11009 | Reg=0.00190 | acc=0.9531 | L2-Norm=13.766 | L2-Norm(final)=9.027 | 5582.0 samples/s | 87.2 steps/s
[Step=10500 Epoch=20.5] | Loss=0.10936 | Reg=0.00190 | acc=0.8438 | L2-Norm=13.766 | L2-Norm(final)=9.113 | 7027.1 samples/s | 109.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=20.5] | Loss=0.10099 | Reg=0.00190 | acc=0.9062 | L2-Norm=13.766 | L2-Norm(final)=9.960 | 4512.7 samples/s | 70.5 steps/s
[Step=10550 Epoch=20.6] | Loss=0.06966 | Reg=0.00196 | acc=0.9375 | L2-Norm=13.993 | L2-Norm(final)=9.973 | 4710.3 samples/s | 73.6 steps/s
[Step=10600 Epoch=20.7] | Loss=0.06932 | Reg=0.00201 | acc=0.9375 | L2-Norm=14.175 | L2-Norm(final)=9.950 | 4850.4 samples/s | 75.8 steps/s
[Step=10650 Epoch=20.8] | Loss=0.06381 | Reg=0.00204 | acc=0.9531 | L2-Norm=14.294 | L2-Norm(final)=9.934 | 4720.9 samples/s | 73.8 steps/s
[Step=10700 Epoch=20.9] | Loss=0.06034 | Reg=0.00207 | acc=0.9531 | L2-Norm=14.385 | L2-Norm(final)=9.922 | 4735.9 samples/s | 74.0 steps/s
[Step=10750 Epoch=21.0] | Loss=0.05952 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.464 | L2-Norm(final)=9.909 | 4833.8 samples/s | 75.5 steps/s
[Step=10800 Epoch=21.1] | Loss=0.05847 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.533 | L2-Norm(final)=9.894 | 4765.0 samples/s | 74.5 steps/s
[Step=10850 Epoch=21.2] | Loss=0.05769 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.594 | L2-Norm(final)=9.882 | 4754.5 samples/s | 74.3 steps/s
[Step=10900 Epoch=21.3] | Loss=0.05574 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.648 | L2-Norm(final)=9.871 | 4794.7 samples/s | 74.9 steps/s
[Step=10950 Epoch=21.4] | Loss=0.05460 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.697 | L2-Norm(final)=9.862 | 4792.2 samples/s | 74.9 steps/s
[Step=11000 Epoch=21.5] | Loss=0.05392 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.743 | L2-Norm(final)=9.854 | 5891.7 samples/s | 92.1 steps/s
[Step=11050 Epoch=21.6] | Loss=0.05179 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.788 | L2-Norm(final)=9.846 | 2089.2 samples/s | 32.6 steps/s
[Step=11100 Epoch=21.7] | Loss=0.05024 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.830 | L2-Norm(final)=9.840 | 4717.3 samples/s | 73.7 steps/s
[Step=11150 Epoch=21.8] | Loss=0.04906 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.870 | L2-Norm(final)=9.834 | 4764.2 samples/s | 74.4 steps/s
[Step=11200 Epoch=21.9] | Loss=0.04747 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.907 | L2-Norm(final)=9.828 | 4766.9 samples/s | 74.5 steps/s
[Step=11250 Epoch=22.0] | Loss=0.04636 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.942 | L2-Norm(final)=9.823 | 4792.5 samples/s | 74.9 steps/s
[Step=11300 Epoch=22.1] | Loss=0.04569 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.975 | L2-Norm(final)=9.819 | 4755.2 samples/s | 74.3 steps/s
[Step=11350 Epoch=22.2] | Loss=0.04509 | Reg=0.00225 | acc=0.9688 | L2-Norm=15.008 | L2-Norm(final)=9.814 | 4694.0 samples/s | 73.3 steps/s
[Step=11400 Epoch=22.3] | Loss=0.04502 | Reg=0.00226 | acc=0.9531 | L2-Norm=15.042 | L2-Norm(final)=9.809 | 4739.5 samples/s | 74.1 steps/s
[Step=11450 Epoch=22.4] | Loss=0.04490 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.074 | L2-Norm(final)=9.803 | 4783.6 samples/s | 74.7 steps/s
[Step=11500 Epoch=22.5] | Loss=0.04408 | Reg=0.00228 | acc=0.9688 | L2-Norm=15.107 | L2-Norm(final)=9.797 | 5206.6 samples/s | 81.4 steps/s
[Step=11550 Epoch=22.6] | Loss=0.04339 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.138 | L2-Norm(final)=9.791 | 2158.5 samples/s | 33.7 steps/s
[Step=11600 Epoch=22.7] | Loss=0.04260 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.169 | L2-Norm(final)=9.786 | 4708.3 samples/s | 73.6 steps/s
[Step=11650 Epoch=22.8] | Loss=0.04177 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.198 | L2-Norm(final)=9.781 | 4590.3 samples/s | 71.7 steps/s
[Step=11700 Epoch=22.9] | Loss=0.04123 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.225 | L2-Norm(final)=9.776 | 4565.0 samples/s | 71.3 steps/s
[Step=11750 Epoch=23.0] | Loss=0.04054 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.252 | L2-Norm(final)=9.771 | 4773.2 samples/s | 74.6 steps/s
[Step=11800 Epoch=23.1] | Loss=0.04006 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.278 | L2-Norm(final)=9.766 | 4839.9 samples/s | 75.6 steps/s
[Step=11850 Epoch=23.2] | Loss=0.03935 | Reg=0.00234 | acc=0.9531 | L2-Norm=15.303 | L2-Norm(final)=9.762 | 4823.2 samples/s | 75.4 steps/s
[Step=11900 Epoch=23.3] | Loss=0.03903 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.327 | L2-Norm(final)=9.757 | 4804.2 samples/s | 75.1 steps/s
[Step=11950 Epoch=23.4] | Loss=0.03884 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.351 | L2-Norm(final)=9.753 | 4865.2 samples/s | 76.0 steps/s
[Step=12000 Epoch=23.5] | Loss=0.03854 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.375 | L2-Norm(final)=9.748 | 4765.9 samples/s | 74.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step12000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=38.3] | Loss=0.00372 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.757 | L2-Norm(final)=9.383 | 4364.6 samples/s | 68.2 steps/s
[Step=10050 Epoch=38.5] | Loss=0.01199 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.747 | L2-Norm(final)=9.453 | 4998.6 samples/s | 78.1 steps/s
[Step=10100 Epoch=38.7] | Loss=0.01108 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.746 | L2-Norm(final)=9.567 | 4930.4 samples/s | 77.0 steps/s
[Step=10150 Epoch=38.9] | Loss=0.01089 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.746 | L2-Norm(final)=9.678 | 4932.8 samples/s | 77.1 steps/s
[Step=10200 Epoch=39.1] | Loss=0.00999 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.745 | L2-Norm(final)=9.783 | 5106.3 samples/s | 79.8 steps/s
[Step=10250 Epoch=39.3] | Loss=0.00981 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.745 | L2-Norm(final)=9.878 | 6643.5 samples/s | 103.8 steps/s
[Step=10300 Epoch=39.5] | Loss=0.00962 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.745 | L2-Norm(final)=9.966 | 2123.3 samples/s | 33.2 steps/s
[Step=10350 Epoch=39.7] | Loss=0.00920 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.745 | L2-Norm(final)=10.052 | 5119.5 samples/s | 80.0 steps/s
[Step=10400 Epoch=39.8] | Loss=0.00902 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.745 | L2-Norm(final)=10.139 | 5139.5 samples/s | 80.3 steps/s
[Step=10450 Epoch=40.0] | Loss=0.00883 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.745 | L2-Norm(final)=10.221 | 5179.8 samples/s | 80.9 steps/s
[Step=10500 Epoch=40.2] | Loss=0.00875 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.745 | L2-Norm(final)=10.299 | 5870.4 samples/s | 91.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=40.2] | Loss=0.00459 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.745 | L2-Norm(final)=11.065 | 4600.3 samples/s | 71.9 steps/s
[Step=10550 Epoch=40.4] | Loss=0.01502 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.974 | L2-Norm(final)=11.070 | 4314.1 samples/s | 67.4 steps/s
[Step=10600 Epoch=40.6] | Loss=0.01189 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.246 | L2-Norm(final)=11.035 | 4460.4 samples/s | 69.7 steps/s
[Step=10650 Epoch=40.8] | Loss=0.01127 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.400 | L2-Norm(final)=11.011 | 4567.5 samples/s | 71.4 steps/s
[Step=10700 Epoch=41.0] | Loss=0.01068 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.510 | L2-Norm(final)=10.983 | 4591.0 samples/s | 71.7 steps/s
[Step=10750 Epoch=41.2] | Loss=0.00891 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.572 | L2-Norm(final)=10.964 | 5770.3 samples/s | 90.2 steps/s
[Step=10800 Epoch=41.4] | Loss=0.00800 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.608 | L2-Norm(final)=10.954 | 2004.4 samples/s | 31.3 steps/s
[Step=10850 Epoch=41.6] | Loss=0.00690 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.630 | L2-Norm(final)=10.946 | 4532.7 samples/s | 70.8 steps/s
[Step=10900 Epoch=41.8] | Loss=0.00642 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.644 | L2-Norm(final)=10.941 | 4614.4 samples/s | 72.1 steps/s
[Step=10950 Epoch=42.0] | Loss=0.00574 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.654 | L2-Norm(final)=10.938 | 4528.2 samples/s | 70.8 steps/s
[Step=11000 Epoch=42.1] | Loss=0.00522 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.654 | L2-Norm(final)=10.937 | 5064.1 samples/s | 79.1 steps/s
[Step=11050 Epoch=42.3] | Loss=0.00477 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.649 | L2-Norm(final)=10.936 | 2092.7 samples/s | 32.7 steps/s
[Step=11100 Epoch=42.5] | Loss=0.00439 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.640 | L2-Norm(final)=10.936 | 4641.6 samples/s | 72.5 steps/s
[Step=11150 Epoch=42.7] | Loss=0.00405 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.626 | L2-Norm(final)=10.936 | 4477.6 samples/s | 70.0 steps/s
[Step=11200 Epoch=42.9] | Loss=0.00376 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.610 | L2-Norm(final)=10.936 | 4581.3 samples/s | 71.6 steps/s
[Step=11250 Epoch=43.1] | Loss=0.00351 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.591 | L2-Norm(final)=10.937 | 4571.2 samples/s | 71.4 steps/s
[Step=11300 Epoch=43.3] | Loss=0.00329 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.571 | L2-Norm(final)=10.937 | 2193.1 samples/s | 34.3 steps/s
[Step=11350 Epoch=43.5] | Loss=0.00310 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.549 | L2-Norm(final)=10.937 | 4650.4 samples/s | 72.7 steps/s
[Step=11400 Epoch=43.7] | Loss=0.00293 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.526 | L2-Norm(final)=10.938 | 4617.9 samples/s | 72.2 steps/s
[Step=11450 Epoch=43.9] | Loss=0.00277 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.502 | L2-Norm(final)=10.938 | 4573.4 samples/s | 71.5 steps/s
[Step=11500 Epoch=44.1] | Loss=0.00263 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.477 | L2-Norm(final)=10.939 | 4651.2 samples/s | 72.7 steps/s
[Step=11550 Epoch=44.3] | Loss=0.00251 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.452 | L2-Norm(final)=10.939 | 2190.3 samples/s | 34.2 steps/s
[Step=11600 Epoch=44.4] | Loss=0.00240 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.426 | L2-Norm(final)=10.939 | 4584.9 samples/s | 71.6 steps/s
[Step=11650 Epoch=44.6] | Loss=0.00229 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.400 | L2-Norm(final)=10.940 | 4553.0 samples/s | 71.1 steps/s
[Step=11700 Epoch=44.8] | Loss=0.00220 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.373 | L2-Norm(final)=10.940 | 4515.3 samples/s | 70.6 steps/s
[Step=11750 Epoch=45.0] | Loss=0.00211 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.347 | L2-Norm(final)=10.940 | 4561.5 samples/s | 71.3 steps/s
[Step=11800 Epoch=45.2] | Loss=0.00203 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.320 | L2-Norm(final)=10.941 | 6218.6 samples/s | 97.2 steps/s
[Step=11850 Epoch=45.4] | Loss=0.00195 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.293 | L2-Norm(final)=10.941 | 1957.3 samples/s | 30.6 steps/s
[Step=11900 Epoch=45.6] | Loss=0.00188 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.266 | L2-Norm(final)=10.941 | 4573.8 samples/s | 71.5 steps/s
[Step=11950 Epoch=45.8] | Loss=0.00182 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.239 | L2-Norm(final)=10.942 | 4503.0 samples/s | 70.4 steps/s
[Step=12000 Epoch=46.0] | Loss=0.00176 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.212 | L2-Norm(final)=10.942 | 4531.3 samples/s | 70.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step12000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=38.5] | Loss=0.01830 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.757 | L2-Norm(final)=9.472 | 4662.1 samples/s | 72.8 steps/s
[Step=10050 Epoch=38.7] | Loss=0.01494 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.748 | L2-Norm(final)=9.517 | 4848.4 samples/s | 75.8 steps/s
[Step=10100 Epoch=38.9] | Loss=0.01325 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.747 | L2-Norm(final)=9.590 | 5305.7 samples/s | 82.9 steps/s
[Step=10150 Epoch=39.1] | Loss=0.01246 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.747 | L2-Norm(final)=9.673 | 4974.9 samples/s | 77.7 steps/s
[Step=10200 Epoch=39.3] | Loss=0.01188 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.746 | L2-Norm(final)=9.763 | 5147.0 samples/s | 80.4 steps/s
[Step=10250 Epoch=39.5] | Loss=0.01115 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.746 | L2-Norm(final)=9.855 | 7048.2 samples/s | 110.1 steps/s
[Step=10300 Epoch=39.6] | Loss=0.01104 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.746 | L2-Norm(final)=9.946 | 2149.5 samples/s | 33.6 steps/s
[Step=10350 Epoch=39.8] | Loss=0.01075 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.746 | L2-Norm(final)=10.034 | 5067.7 samples/s | 79.2 steps/s
[Step=10400 Epoch=40.0] | Loss=0.01070 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.746 | L2-Norm(final)=10.121 | 5214.1 samples/s | 81.5 steps/s
[Step=10450 Epoch=40.2] | Loss=0.01046 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.746 | L2-Norm(final)=10.205 | 5283.5 samples/s | 82.6 steps/s
[Step=10500 Epoch=40.4] | Loss=0.01012 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.746 | L2-Norm(final)=10.285 | 5915.5 samples/s | 92.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=40.4] | Loss=0.01240 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.746 | L2-Norm(final)=11.082 | 4396.9 samples/s | 68.7 steps/s
[Step=10550 Epoch=40.6] | Loss=0.01197 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.926 | L2-Norm(final)=11.101 | 4426.4 samples/s | 69.2 steps/s
[Step=10600 Epoch=40.8] | Loss=0.01344 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.264 | L2-Norm(final)=11.058 | 4561.8 samples/s | 71.3 steps/s
[Step=10650 Epoch=41.0] | Loss=0.01336 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.464 | L2-Norm(final)=11.021 | 4524.1 samples/s | 70.7 steps/s
[Step=10700 Epoch=41.2] | Loss=0.01089 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.577 | L2-Norm(final)=10.996 | 4551.2 samples/s | 71.1 steps/s
[Step=10750 Epoch=41.4] | Loss=0.00932 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.633 | L2-Norm(final)=10.983 | 5786.2 samples/s | 90.4 steps/s
[Step=10800 Epoch=41.6] | Loss=0.00807 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.671 | L2-Norm(final)=10.977 | 2020.3 samples/s | 31.6 steps/s
[Step=10850 Epoch=41.8] | Loss=0.00694 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.692 | L2-Norm(final)=10.973 | 4511.4 samples/s | 70.5 steps/s
[Step=10900 Epoch=42.0] | Loss=0.00608 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.698 | L2-Norm(final)=10.970 | 4545.8 samples/s | 71.0 steps/s
[Step=10950 Epoch=42.2] | Loss=0.00541 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.694 | L2-Norm(final)=10.969 | 4534.4 samples/s | 70.8 steps/s
[Step=11000 Epoch=42.3] | Loss=0.00487 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.683 | L2-Norm(final)=10.968 | 5139.6 samples/s | 80.3 steps/s
[Step=11050 Epoch=42.5] | Loss=0.00443 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.667 | L2-Norm(final)=10.967 | 2117.8 samples/s | 33.1 steps/s
[Step=11100 Epoch=42.7] | Loss=0.00406 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.647 | L2-Norm(final)=10.967 | 4596.1 samples/s | 71.8 steps/s
[Step=11150 Epoch=42.9] | Loss=0.00375 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.625 | L2-Norm(final)=10.966 | 4573.0 samples/s | 71.5 steps/s
[Step=11200 Epoch=43.1] | Loss=0.00348 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.602 | L2-Norm(final)=10.966 | 4603.6 samples/s | 71.9 steps/s
[Step=11250 Epoch=43.3] | Loss=0.00325 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.576 | L2-Norm(final)=10.966 | 4605.3 samples/s | 72.0 steps/s
[Step=11300 Epoch=43.5] | Loss=0.00305 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.550 | L2-Norm(final)=10.966 | 2193.9 samples/s | 34.3 steps/s
[Step=11350 Epoch=43.7] | Loss=0.00287 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.524 | L2-Norm(final)=10.966 | 4529.5 samples/s | 70.8 steps/s
[Step=11400 Epoch=43.9] | Loss=0.00271 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.496 | L2-Norm(final)=10.966 | 4547.8 samples/s | 71.1 steps/s
[Step=11450 Epoch=44.1] | Loss=0.00257 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.469 | L2-Norm(final)=10.966 | 4666.8 samples/s | 72.9 steps/s
[Step=11500 Epoch=44.3] | Loss=0.00244 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.441 | L2-Norm(final)=10.967 | 4451.8 samples/s | 69.6 steps/s
[Step=11550 Epoch=44.5] | Loss=0.00232 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.413 | L2-Norm(final)=10.967 | 2240.6 samples/s | 35.0 steps/s
[Step=11600 Epoch=44.7] | Loss=0.00222 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.384 | L2-Norm(final)=10.967 | 4489.6 samples/s | 70.1 steps/s
[Step=11650 Epoch=44.8] | Loss=0.00212 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.356 | L2-Norm(final)=10.967 | 4510.9 samples/s | 70.5 steps/s
[Step=11700 Epoch=45.0] | Loss=0.00203 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.328 | L2-Norm(final)=10.967 | 4539.4 samples/s | 70.9 steps/s
[Step=11750 Epoch=45.2] | Loss=0.00195 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.299 | L2-Norm(final)=10.968 | 4506.0 samples/s | 70.4 steps/s
[Step=11800 Epoch=45.4] | Loss=0.00188 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.271 | L2-Norm(final)=10.968 | 6728.4 samples/s | 105.1 steps/s
[Step=11850 Epoch=45.6] | Loss=0.00181 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.242 | L2-Norm(final)=10.968 | 1919.5 samples/s | 30.0 steps/s
[Step=11900 Epoch=45.8] | Loss=0.00174 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.214 | L2-Norm(final)=10.968 | 4566.6 samples/s | 71.4 steps/s
[Step=11950 Epoch=46.0] | Loss=0.00168 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.186 | L2-Norm(final)=10.969 | 4539.8 samples/s | 70.9 steps/s
[Step=12000 Epoch=46.2] | Loss=0.00163 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.158 | L2-Norm(final)=10.969 | 4572.1 samples/s | 71.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07248 | acc=0.9564 | tpr=0.9617 | fpr=0.0550 | 4181.9 samples/s | 16.3 steps/s
Avg test loss: 0.07219, Avg test acc: 0.95673, Avg tpr: 0.96281, Avg fpr: 0.05666, total FA: 442

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07872 | acc=0.9527 | tpr=0.9505 | fpr=0.0426 | 4106.6 samples/s | 16.0 steps/s
Avg test loss: 0.07958, Avg test acc: 0.95184, Avg tpr: 0.94947, Avg fpr: 0.04294, total FA: 335

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.13637 | acc=0.3141 | tpr=0.0016 | fpr=0.0074 | 4185.1 samples/s | 16.3 steps/s
Avg test loss: 7.14549, Avg test acc: 0.31104, Avg tpr: 0.00187, Avg fpr: 0.00897, total FA: 70

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.25277 | acc=0.3124 | tpr=0.0015 | fpr=0.0124 | 4246.2 samples/s | 16.6 steps/s
Avg test loss: 7.25578, Avg test acc: 0.30956, Avg tpr: 0.00198, Avg fpr: 0.01397, total FA: 109

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.48309 | acc=0.1006 | tpr=0.5310 | fpr=0.9071 | 4213.6 samples/s | 16.5 steps/s
[Step= 100] | Loss=4.46183 | acc=0.1045 | tpr=0.5309 | fpr=0.9035 | 7833.4 samples/s | 30.6 steps/s
[Step= 150] | Loss=4.47149 | acc=0.1036 | tpr=0.5432 | fpr=0.9044 | 7787.8 samples/s | 30.4 steps/s
[Step= 200] | Loss=4.47157 | acc=0.1040 | tpr=0.5366 | fpr=0.9038 | 8008.5 samples/s | 31.3 steps/s
[Step= 250] | Loss=4.46992 | acc=0.1051 | tpr=0.5406 | fpr=0.9029 | 7739.1 samples/s | 30.2 steps/s
[Step= 300] | Loss=4.46928 | acc=0.1055 | tpr=0.5382 | fpr=0.9024 | 7814.7 samples/s | 30.5 steps/s
[Step= 350] | Loss=4.46917 | acc=0.1056 | tpr=0.5348 | fpr=0.9022 | 7895.5 samples/s | 30.8 steps/s
[Step= 400] | Loss=4.46430 | acc=0.1055 | tpr=0.5377 | fpr=0.9024 | 7819.1 samples/s | 30.5 steps/s
[Step= 450] | Loss=4.46684 | acc=0.1054 | tpr=0.5389 | fpr=0.9025 | 7887.0 samples/s | 30.8 steps/s
[Step= 500] | Loss=4.46823 | acc=0.1052 | tpr=0.5441 | fpr=0.9027 | 7777.1 samples/s | 30.4 steps/s
[Step= 550] | Loss=4.47006 | acc=0.1052 | tpr=0.5464 | fpr=0.9028 | 14559.9 samples/s | 56.9 steps/s
Avg test loss: 4.47114, Avg test acc: 0.10516, Avg tpr: 0.54675, Avg fpr: 0.90287, total FA: 125361

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.25897 | acc=0.1682 | tpr=0.6239 | fpr=0.8400 | 4196.7 samples/s | 16.4 steps/s
[Step= 100] | Loss=5.20158 | acc=0.1677 | tpr=0.5842 | fpr=0.8400 | 8011.4 samples/s | 31.3 steps/s
[Step= 150] | Loss=5.20799 | acc=0.1667 | tpr=0.5706 | fpr=0.8407 | 7668.7 samples/s | 30.0 steps/s
[Step= 200] | Loss=5.20467 | acc=0.1660 | tpr=0.5639 | fpr=0.8412 | 7866.3 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.19994 | acc=0.1650 | tpr=0.5528 | fpr=0.8421 | 7845.3 samples/s | 30.6 steps/s
[Step= 300] | Loss=5.19960 | acc=0.1657 | tpr=0.5505 | fpr=0.8414 | 7936.4 samples/s | 31.0 steps/s
[Step= 350] | Loss=5.19990 | acc=0.1649 | tpr=0.5429 | fpr=0.8419 | 7818.6 samples/s | 30.5 steps/s
[Step= 400] | Loss=5.19073 | acc=0.1646 | tpr=0.5438 | fpr=0.8423 | 7917.7 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.19211 | acc=0.1642 | tpr=0.5424 | fpr=0.8427 | 8114.1 samples/s | 31.7 steps/s
[Step= 500] | Loss=5.19258 | acc=0.1644 | tpr=0.5427 | fpr=0.8424 | 7444.1 samples/s | 29.1 steps/s
[Step= 550] | Loss=5.19387 | acc=0.1647 | tpr=0.5495 | fpr=0.8423 | 15189.7 samples/s | 59.3 steps/s
Avg test loss: 5.19507, Avg test acc: 0.16466, Avg tpr: 0.54913, Avg fpr: 0.84233, total FA: 116956

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12746 | acc=0.9762 | tpr=0.9115 | fpr=0.0226 | 4200.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.13476 | acc=0.9753 | tpr=0.9190 | fpr=0.0236 | 7970.6 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.13655 | acc=0.9746 | tpr=0.9265 | fpr=0.0245 | 7828.6 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.13655 | acc=0.9749 | tpr=0.9301 | fpr=0.0243 | 8303.8 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.13559 | acc=0.9751 | tpr=0.9345 | fpr=0.0242 | 7409.3 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.13738 | acc=0.9748 | tpr=0.9360 | fpr=0.0245 | 7991.8 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.13881 | acc=0.9747 | tpr=0.9349 | fpr=0.0246 | 7656.5 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.14032 | acc=0.9744 | tpr=0.9316 | fpr=0.0248 | 7819.2 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.14271 | acc=0.9741 | tpr=0.9299 | fpr=0.0251 | 7870.5 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.14249 | acc=0.9742 | tpr=0.9308 | fpr=0.0250 | 7762.8 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.14188 | acc=0.9744 | tpr=0.9296 | fpr=0.0248 | 15006.2 samples/s | 58.6 steps/s
Avg test loss: 0.14168, Avg test acc: 0.97438, Avg tpr: 0.92987, Avg fpr: 0.02481, total FA: 3445

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15259 | acc=0.9766 | tpr=0.9336 | fpr=0.0227 | 4118.5 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.16180 | acc=0.9759 | tpr=0.9467 | fpr=0.0236 | 7828.0 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.16643 | acc=0.9752 | tpr=0.9553 | fpr=0.0244 | 8147.7 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.16840 | acc=0.9751 | tpr=0.9530 | fpr=0.0245 | 7853.1 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.16725 | acc=0.9752 | tpr=0.9485 | fpr=0.0243 | 7976.8 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.16923 | acc=0.9748 | tpr=0.9462 | fpr=0.0247 | 7825.5 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.16986 | acc=0.9745 | tpr=0.9474 | fpr=0.0250 | 7730.2 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.17152 | acc=0.9743 | tpr=0.9447 | fpr=0.0251 | 8404.9 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.17407 | acc=0.9742 | tpr=0.9440 | fpr=0.0253 | 7425.9 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.17318 | acc=0.9742 | tpr=0.9454 | fpr=0.0252 | 7810.6 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.17172 | acc=0.9744 | tpr=0.9459 | fpr=0.0250 | 14408.6 samples/s | 56.3 steps/s
Avg test loss: 0.17142, Avg test acc: 0.97445, Avg tpr: 0.94612, Avg fpr: 0.02503, total FA: 3476

server round 6/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=12001 Epoch=23.4] | Loss=0.06499 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.527 | L2-Norm(final)=8.677 | 4531.7 samples/s | 70.8 steps/s
[Step=12050 Epoch=23.5] | Loss=0.09431 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.543 | L2-Norm(final)=8.755 | 4902.7 samples/s | 76.6 steps/s
[Step=12100 Epoch=23.6] | Loss=0.09604 | Reg=0.00183 | acc=0.9531 | L2-Norm=13.545 | L2-Norm(final)=8.873 | 5478.3 samples/s | 85.6 steps/s
[Step=12150 Epoch=23.7] | Loss=0.09584 | Reg=0.00183 | acc=0.8594 | L2-Norm=13.546 | L2-Norm(final)=8.996 | 5515.4 samples/s | 86.2 steps/s
[Step=12200 Epoch=23.8] | Loss=0.09455 | Reg=0.00184 | acc=0.9219 | L2-Norm=13.547 | L2-Norm(final)=9.115 | 5571.8 samples/s | 87.1 steps/s
[Step=12250 Epoch=23.9] | Loss=0.09380 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.547 | L2-Norm(final)=9.225 | 5567.0 samples/s | 87.0 steps/s
[Step=12300 Epoch=24.0] | Loss=0.09259 | Reg=0.00184 | acc=0.9375 | L2-Norm=13.547 | L2-Norm(final)=9.330 | 5530.8 samples/s | 86.4 steps/s
[Step=12350 Epoch=24.1] | Loss=0.09261 | Reg=0.00184 | acc=0.8281 | L2-Norm=13.547 | L2-Norm(final)=9.429 | 5508.7 samples/s | 86.1 steps/s
[Step=12400 Epoch=24.2] | Loss=0.09170 | Reg=0.00184 | acc=0.9375 | L2-Norm=13.547 | L2-Norm(final)=9.524 | 5518.8 samples/s | 86.2 steps/s
[Step=12450 Epoch=24.3] | Loss=0.09136 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.547 | L2-Norm(final)=9.616 | 5685.7 samples/s | 88.8 steps/s
[Step=12500 Epoch=24.4] | Loss=0.09073 | Reg=0.00184 | acc=0.9219 | L2-Norm=13.547 | L2-Norm(final)=9.704 | 6865.2 samples/s | 107.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=24.4] | Loss=0.08623 | Reg=0.00184 | acc=0.9219 | L2-Norm=13.548 | L2-Norm(final)=10.568 | 4276.9 samples/s | 66.8 steps/s
[Step=12550 Epoch=24.5] | Loss=0.06621 | Reg=0.00189 | acc=0.9375 | L2-Norm=13.765 | L2-Norm(final)=10.578 | 4608.2 samples/s | 72.0 steps/s
[Step=12600 Epoch=24.6] | Loss=0.06155 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.922 | L2-Norm(final)=10.558 | 4771.8 samples/s | 74.6 steps/s
[Step=12650 Epoch=24.7] | Loss=0.05862 | Reg=0.00197 | acc=0.9375 | L2-Norm=14.026 | L2-Norm(final)=10.544 | 4749.7 samples/s | 74.2 steps/s
[Step=12700 Epoch=24.8] | Loss=0.05728 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.112 | L2-Norm(final)=10.531 | 4775.2 samples/s | 74.6 steps/s
[Step=12750 Epoch=24.9] | Loss=0.05571 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.186 | L2-Norm(final)=10.520 | 4782.5 samples/s | 74.7 steps/s
[Step=12800 Epoch=25.0] | Loss=0.05488 | Reg=0.00203 | acc=0.9531 | L2-Norm=14.255 | L2-Norm(final)=10.511 | 4833.5 samples/s | 75.5 steps/s
[Step=12850 Epoch=25.1] | Loss=0.05408 | Reg=0.00205 | acc=0.9688 | L2-Norm=14.324 | L2-Norm(final)=10.502 | 4791.1 samples/s | 74.9 steps/s
[Step=12900 Epoch=25.2] | Loss=0.05223 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.392 | L2-Norm(final)=10.493 | 4808.3 samples/s | 75.1 steps/s
[Step=12950 Epoch=25.3] | Loss=0.05178 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.453 | L2-Norm(final)=10.485 | 4814.5 samples/s | 75.2 steps/s
[Step=13000 Epoch=25.4] | Loss=0.05026 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.510 | L2-Norm(final)=10.477 | 5836.5 samples/s | 91.2 steps/s
[Step=13050 Epoch=25.5] | Loss=0.04901 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.562 | L2-Norm(final)=10.469 | 2027.6 samples/s | 31.7 steps/s
[Step=13100 Epoch=25.6] | Loss=0.04724 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.611 | L2-Norm(final)=10.462 | 4729.5 samples/s | 73.9 steps/s
[Step=13150 Epoch=25.6] | Loss=0.04597 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.656 | L2-Norm(final)=10.456 | 4774.9 samples/s | 74.6 steps/s
[Step=13200 Epoch=25.7] | Loss=0.04516 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.699 | L2-Norm(final)=10.450 | 4809.7 samples/s | 75.2 steps/s
[Step=13250 Epoch=25.8] | Loss=0.04418 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.741 | L2-Norm(final)=10.445 | 4763.3 samples/s | 74.4 steps/s
[Step=13300 Epoch=25.9] | Loss=0.04330 | Reg=0.00219 | acc=0.9531 | L2-Norm=14.780 | L2-Norm(final)=10.441 | 4834.5 samples/s | 75.5 steps/s
[Step=13350 Epoch=26.0] | Loss=0.04277 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.818 | L2-Norm(final)=10.436 | 4803.5 samples/s | 75.1 steps/s
[Step=13400 Epoch=26.1] | Loss=0.04223 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.855 | L2-Norm(final)=10.431 | 4787.2 samples/s | 74.8 steps/s
[Step=13450 Epoch=26.2] | Loss=0.04172 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.892 | L2-Norm(final)=10.426 | 4800.6 samples/s | 75.0 steps/s
[Step=13500 Epoch=26.3] | Loss=0.04127 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.926 | L2-Norm(final)=10.421 | 5078.4 samples/s | 79.4 steps/s
[Step=13550 Epoch=26.4] | Loss=0.04086 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.959 | L2-Norm(final)=10.417 | 2128.1 samples/s | 33.3 steps/s
[Step=13600 Epoch=26.5] | Loss=0.04010 | Reg=0.00225 | acc=0.9688 | L2-Norm=14.990 | L2-Norm(final)=10.412 | 4762.2 samples/s | 74.4 steps/s
[Step=13650 Epoch=26.6] | Loss=0.03911 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.020 | L2-Norm(final)=10.408 | 4772.6 samples/s | 74.6 steps/s
[Step=13700 Epoch=26.7] | Loss=0.03847 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.049 | L2-Norm(final)=10.405 | 4801.7 samples/s | 75.0 steps/s
[Step=13750 Epoch=26.8] | Loss=0.03805 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.077 | L2-Norm(final)=10.402 | 4737.6 samples/s | 74.0 steps/s
[Step=13800 Epoch=26.9] | Loss=0.03733 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.104 | L2-Norm(final)=10.398 | 4821.3 samples/s | 75.3 steps/s
[Step=13850 Epoch=27.0] | Loss=0.03697 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.129 | L2-Norm(final)=10.395 | 4821.5 samples/s | 75.3 steps/s
[Step=13900 Epoch=27.1] | Loss=0.03652 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.154 | L2-Norm(final)=10.392 | 4756.8 samples/s | 74.3 steps/s
[Step=13950 Epoch=27.2] | Loss=0.03620 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.179 | L2-Norm(final)=10.389 | 4818.1 samples/s | 75.3 steps/s
[Step=14000 Epoch=27.3] | Loss=0.03595 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.203 | L2-Norm(final)=10.385 | 4828.7 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step14000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=12001 Epoch=23.5] | Loss=0.09248 | Reg=0.00183 | acc=0.9219 | L2-Norm=13.527 | L2-Norm(final)=9.610 | 4544.2 samples/s | 71.0 steps/s
[Step=12050 Epoch=23.6] | Loss=0.09312 | Reg=0.00183 | acc=0.9531 | L2-Norm=13.542 | L2-Norm(final)=9.704 | 5054.4 samples/s | 79.0 steps/s
[Step=12100 Epoch=23.7] | Loss=0.09267 | Reg=0.00183 | acc=0.8906 | L2-Norm=13.545 | L2-Norm(final)=9.819 | 5414.9 samples/s | 84.6 steps/s
[Step=12150 Epoch=23.8] | Loss=0.09044 | Reg=0.00183 | acc=0.9531 | L2-Norm=13.546 | L2-Norm(final)=9.930 | 5519.4 samples/s | 86.2 steps/s
[Step=12200 Epoch=23.9] | Loss=0.08981 | Reg=0.00183 | acc=0.9531 | L2-Norm=13.546 | L2-Norm(final)=10.036 | 5754.1 samples/s | 89.9 steps/s
[Step=12250 Epoch=23.9] | Loss=0.08990 | Reg=0.00184 | acc=0.9062 | L2-Norm=13.546 | L2-Norm(final)=10.134 | 5336.4 samples/s | 83.4 steps/s
[Step=12300 Epoch=24.0] | Loss=0.08947 | Reg=0.00184 | acc=0.9219 | L2-Norm=13.547 | L2-Norm(final)=10.224 | 5556.0 samples/s | 86.8 steps/s
[Step=12350 Epoch=24.1] | Loss=0.08873 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.547 | L2-Norm(final)=10.312 | 5574.1 samples/s | 87.1 steps/s
[Step=12400 Epoch=24.2] | Loss=0.08796 | Reg=0.00184 | acc=0.9062 | L2-Norm=13.547 | L2-Norm(final)=10.398 | 5495.8 samples/s | 85.9 steps/s
[Step=12450 Epoch=24.3] | Loss=0.08845 | Reg=0.00184 | acc=0.9219 | L2-Norm=13.547 | L2-Norm(final)=10.480 | 5530.2 samples/s | 86.4 steps/s
[Step=12500 Epoch=24.4] | Loss=0.08808 | Reg=0.00184 | acc=0.9219 | L2-Norm=13.547 | L2-Norm(final)=10.559 | 7120.0 samples/s | 111.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=24.4] | Loss=0.04554 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.547 | L2-Norm(final)=11.334 | 4301.5 samples/s | 67.2 steps/s
[Step=12550 Epoch=24.5] | Loss=0.06106 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.757 | L2-Norm(final)=11.346 | 4964.8 samples/s | 77.6 steps/s
[Step=12600 Epoch=24.6] | Loss=0.05955 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.919 | L2-Norm(final)=11.331 | 4715.7 samples/s | 73.7 steps/s
[Step=12650 Epoch=24.7] | Loss=0.05722 | Reg=0.00197 | acc=0.9375 | L2-Norm=14.047 | L2-Norm(final)=11.318 | 4799.7 samples/s | 75.0 steps/s
[Step=12700 Epoch=24.8] | Loss=0.05704 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.155 | L2-Norm(final)=11.308 | 4764.5 samples/s | 74.4 steps/s
[Step=12750 Epoch=24.9] | Loss=0.05471 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.243 | L2-Norm(final)=11.299 | 4732.9 samples/s | 74.0 steps/s
[Step=12800 Epoch=25.0] | Loss=0.05348 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.317 | L2-Norm(final)=11.292 | 4795.0 samples/s | 74.9 steps/s
[Step=12850 Epoch=25.1] | Loss=0.05208 | Reg=0.00207 | acc=0.9531 | L2-Norm=14.382 | L2-Norm(final)=11.284 | 4790.2 samples/s | 74.8 steps/s
[Step=12900 Epoch=25.2] | Loss=0.05094 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.441 | L2-Norm(final)=11.277 | 4774.5 samples/s | 74.6 steps/s
[Step=12950 Epoch=25.3] | Loss=0.04976 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.495 | L2-Norm(final)=11.268 | 4767.2 samples/s | 74.5 steps/s
[Step=13000 Epoch=25.4] | Loss=0.04856 | Reg=0.00212 | acc=0.9531 | L2-Norm=14.545 | L2-Norm(final)=11.258 | 5926.9 samples/s | 92.6 steps/s
[Step=13050 Epoch=25.5] | Loss=0.04769 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.593 | L2-Norm(final)=11.249 | 2099.0 samples/s | 32.8 steps/s
[Step=13100 Epoch=25.6] | Loss=0.04631 | Reg=0.00214 | acc=0.9531 | L2-Norm=14.637 | L2-Norm(final)=11.241 | 4770.4 samples/s | 74.5 steps/s
[Step=13150 Epoch=25.7] | Loss=0.04533 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.679 | L2-Norm(final)=11.233 | 4753.3 samples/s | 74.3 steps/s
[Step=13200 Epoch=25.8] | Loss=0.04439 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.717 | L2-Norm(final)=11.226 | 4766.3 samples/s | 74.5 steps/s
[Step=13250 Epoch=25.9] | Loss=0.04325 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.753 | L2-Norm(final)=11.219 | 4766.7 samples/s | 74.5 steps/s
[Step=13300 Epoch=26.0] | Loss=0.04230 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.785 | L2-Norm(final)=11.213 | 4805.8 samples/s | 75.1 steps/s
[Step=13350 Epoch=26.1] | Loss=0.04167 | Reg=0.00220 | acc=0.9375 | L2-Norm=14.816 | L2-Norm(final)=11.207 | 4792.0 samples/s | 74.9 steps/s
[Step=13400 Epoch=26.2] | Loss=0.04106 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.846 | L2-Norm(final)=11.202 | 4814.7 samples/s | 75.2 steps/s
[Step=13450 Epoch=26.3] | Loss=0.04024 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.876 | L2-Norm(final)=11.196 | 4827.7 samples/s | 75.4 steps/s
[Step=13500 Epoch=26.4] | Loss=0.03990 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.904 | L2-Norm(final)=11.191 | 5245.0 samples/s | 82.0 steps/s
[Step=13550 Epoch=26.5] | Loss=0.03918 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.932 | L2-Norm(final)=11.186 | 2214.8 samples/s | 34.6 steps/s
[Step=13600 Epoch=26.6] | Loss=0.03840 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.960 | L2-Norm(final)=11.182 | 4803.7 samples/s | 75.1 steps/s
[Step=13650 Epoch=26.7] | Loss=0.03786 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.987 | L2-Norm(final)=11.178 | 4793.6 samples/s | 74.9 steps/s
[Step=13700 Epoch=26.8] | Loss=0.03746 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.013 | L2-Norm(final)=11.174 | 4731.8 samples/s | 73.9 steps/s
[Step=13750 Epoch=26.9] | Loss=0.03699 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.039 | L2-Norm(final)=11.170 | 4828.8 samples/s | 75.5 steps/s
[Step=13800 Epoch=27.0] | Loss=0.03667 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.064 | L2-Norm(final)=11.166 | 4776.3 samples/s | 74.6 steps/s
[Step=13850 Epoch=27.1] | Loss=0.03649 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.090 | L2-Norm(final)=11.162 | 4730.7 samples/s | 73.9 steps/s
[Step=13900 Epoch=27.2] | Loss=0.03603 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.116 | L2-Norm(final)=11.158 | 4866.4 samples/s | 76.0 steps/s
[Step=13950 Epoch=27.3] | Loss=0.03565 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.140 | L2-Norm(final)=11.154 | 4643.6 samples/s | 72.6 steps/s
[Step=14000 Epoch=27.4] | Loss=0.03530 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.164 | L2-Norm(final)=11.150 | 4822.3 samples/s | 75.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step14000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=12001 Epoch=46.0] | Loss=0.00889 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.527 | L2-Norm(final)=10.951 | 4383.9 samples/s | 68.5 steps/s
[Step=12050 Epoch=46.2] | Loss=0.00842 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.519 | L2-Norm(final)=11.005 | 4719.6 samples/s | 73.7 steps/s
[Step=12100 Epoch=46.4] | Loss=0.00801 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=11.078 | 5170.5 samples/s | 80.8 steps/s
[Step=12150 Epoch=46.6] | Loss=0.00753 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=11.158 | 5222.1 samples/s | 81.6 steps/s
[Step=12200 Epoch=46.7] | Loss=0.00718 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=11.237 | 5303.8 samples/s | 82.9 steps/s
[Step=12250 Epoch=46.9] | Loss=0.00742 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=11.315 | 6736.9 samples/s | 105.3 steps/s
[Step=12300 Epoch=47.1] | Loss=0.00719 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=11.390 | 2135.0 samples/s | 33.4 steps/s
[Step=12350 Epoch=47.3] | Loss=0.00762 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.517 | L2-Norm(final)=11.458 | 5199.5 samples/s | 81.2 steps/s
[Step=12400 Epoch=47.5] | Loss=0.00751 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.517 | L2-Norm(final)=11.520 | 5321.9 samples/s | 83.2 steps/s
[Step=12450 Epoch=47.7] | Loss=0.00736 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.517 | L2-Norm(final)=11.581 | 5244.0 samples/s | 81.9 steps/s
[Step=12500 Epoch=47.9] | Loss=0.00719 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.517 | L2-Norm(final)=11.641 | 5699.4 samples/s | 89.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=47.9] | Loss=0.00252 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.517 | L2-Norm(final)=12.244 | 4813.9 samples/s | 75.2 steps/s
[Step=12550 Epoch=48.1] | Loss=0.02638 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.799 | L2-Norm(final)=12.208 | 4129.1 samples/s | 64.5 steps/s
[Step=12600 Epoch=48.3] | Loss=0.01887 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=12.130 | 4555.6 samples/s | 71.2 steps/s
[Step=12650 Epoch=48.5] | Loss=0.01597 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.267 | L2-Norm(final)=12.082 | 4546.5 samples/s | 71.0 steps/s
[Step=12700 Epoch=48.7] | Loss=0.01294 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.349 | L2-Norm(final)=12.056 | 4530.7 samples/s | 70.8 steps/s
[Step=12750 Epoch=48.9] | Loss=0.01114 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.398 | L2-Norm(final)=12.045 | 5746.3 samples/s | 89.8 steps/s
[Step=12800 Epoch=49.0] | Loss=0.00953 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.427 | L2-Norm(final)=12.036 | 2031.6 samples/s | 31.7 steps/s
[Step=12850 Epoch=49.2] | Loss=0.00831 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.443 | L2-Norm(final)=12.030 | 4554.7 samples/s | 71.2 steps/s
[Step=12900 Epoch=49.4] | Loss=0.00736 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.448 | L2-Norm(final)=12.026 | 4504.7 samples/s | 70.4 steps/s
[Step=12950 Epoch=49.6] | Loss=0.00657 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.446 | L2-Norm(final)=12.024 | 4551.2 samples/s | 71.1 steps/s
[Step=13000 Epoch=49.8] | Loss=0.00600 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.439 | L2-Norm(final)=12.022 | 5066.4 samples/s | 79.2 steps/s
[Step=13050 Epoch=50.0] | Loss=0.00547 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.428 | L2-Norm(final)=12.021 | 2121.9 samples/s | 33.2 steps/s
[Step=13100 Epoch=50.2] | Loss=0.00501 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.414 | L2-Norm(final)=12.021 | 4544.6 samples/s | 71.0 steps/s
[Step=13150 Epoch=50.4] | Loss=0.00463 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.398 | L2-Norm(final)=12.021 | 4634.7 samples/s | 72.4 steps/s
[Step=13200 Epoch=50.6] | Loss=0.00430 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.380 | L2-Norm(final)=12.021 | 4453.5 samples/s | 69.6 steps/s
[Step=13250 Epoch=50.8] | Loss=0.00401 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.360 | L2-Norm(final)=12.021 | 4593.2 samples/s | 71.8 steps/s
[Step=13300 Epoch=51.0] | Loss=0.00376 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.339 | L2-Norm(final)=12.021 | 2200.3 samples/s | 34.4 steps/s
[Step=13350 Epoch=51.2] | Loss=0.00354 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.318 | L2-Norm(final)=12.021 | 4632.8 samples/s | 72.4 steps/s
[Step=13400 Epoch=51.3] | Loss=0.00334 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.295 | L2-Norm(final)=12.021 | 4545.7 samples/s | 71.0 steps/s
[Step=13450 Epoch=51.5] | Loss=0.00317 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.273 | L2-Norm(final)=12.021 | 4602.2 samples/s | 71.9 steps/s
[Step=13500 Epoch=51.7] | Loss=0.00301 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.249 | L2-Norm(final)=12.022 | 4476.8 samples/s | 69.9 steps/s
[Step=13550 Epoch=51.9] | Loss=0.00287 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.226 | L2-Norm(final)=12.022 | 2199.2 samples/s | 34.4 steps/s
[Step=13600 Epoch=52.1] | Loss=0.00274 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.202 | L2-Norm(final)=12.023 | 4537.8 samples/s | 70.9 steps/s
[Step=13650 Epoch=52.3] | Loss=0.00262 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.179 | L2-Norm(final)=12.023 | 4502.3 samples/s | 70.3 steps/s
[Step=13700 Epoch=52.5] | Loss=0.00251 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.155 | L2-Norm(final)=12.024 | 4524.7 samples/s | 70.7 steps/s
[Step=13750 Epoch=52.7] | Loss=0.00241 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.131 | L2-Norm(final)=12.024 | 4594.2 samples/s | 71.8 steps/s
[Step=13800 Epoch=52.9] | Loss=0.00232 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.107 | L2-Norm(final)=12.025 | 6134.1 samples/s | 95.8 steps/s
[Step=13850 Epoch=53.1] | Loss=0.00223 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.082 | L2-Norm(final)=12.026 | 1968.4 samples/s | 30.8 steps/s
[Step=13900 Epoch=53.3] | Loss=0.00215 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.058 | L2-Norm(final)=12.027 | 4545.5 samples/s | 71.0 steps/s
[Step=13950 Epoch=53.5] | Loss=0.00208 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.034 | L2-Norm(final)=12.028 | 4598.7 samples/s | 71.9 steps/s
[Step=14000 Epoch=53.6] | Loss=0.00201 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.010 | L2-Norm(final)=12.029 | 4560.7 samples/s | 71.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step14000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=12001 Epoch=46.2] | Loss=0.00148 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.527 | L2-Norm(final)=10.977 | 4373.1 samples/s | 68.3 steps/s
[Step=12050 Epoch=46.4] | Loss=0.00782 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.520 | L2-Norm(final)=11.054 | 4725.5 samples/s | 73.8 steps/s
[Step=12100 Epoch=46.6] | Loss=0.00770 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.519 | L2-Norm(final)=11.156 | 5298.5 samples/s | 82.8 steps/s
[Step=12150 Epoch=46.8] | Loss=0.00785 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=11.263 | 5354.9 samples/s | 83.7 steps/s
[Step=12200 Epoch=47.0] | Loss=0.00818 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=11.369 | 5050.6 samples/s | 78.9 steps/s
[Step=12250 Epoch=47.2] | Loss=0.00808 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=11.469 | 6986.0 samples/s | 109.2 steps/s
[Step=12300 Epoch=47.3] | Loss=0.00798 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=11.566 | 2138.7 samples/s | 33.4 steps/s
[Step=12350 Epoch=47.5] | Loss=0.00781 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=11.658 | 5197.0 samples/s | 81.2 steps/s
[Step=12400 Epoch=47.7] | Loss=0.00774 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=11.746 | 5378.3 samples/s | 84.0 steps/s
[Step=12450 Epoch=47.9] | Loss=0.00759 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=11.831 | 5112.6 samples/s | 79.9 steps/s
[Step=12500 Epoch=48.1] | Loss=0.00763 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=11.914 | 6007.0 samples/s | 93.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=48.1] | Loss=0.01022 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.518 | L2-Norm(final)=12.717 | 4589.5 samples/s | 71.7 steps/s
[Step=12550 Epoch=48.3] | Loss=0.02360 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.811 | L2-Norm(final)=12.690 | 4316.4 samples/s | 67.4 steps/s
[Step=12600 Epoch=48.5] | Loss=0.02010 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.255 | L2-Norm(final)=12.610 | 4584.1 samples/s | 71.6 steps/s
[Step=12650 Epoch=48.7] | Loss=0.01676 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.465 | L2-Norm(final)=12.563 | 4596.7 samples/s | 71.8 steps/s
[Step=12700 Epoch=48.9] | Loss=0.01365 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.586 | L2-Norm(final)=12.537 | 4574.2 samples/s | 71.5 steps/s
[Step=12750 Epoch=49.1] | Loss=0.01311 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.658 | L2-Norm(final)=12.516 | 5824.7 samples/s | 91.0 steps/s
[Step=12800 Epoch=49.3] | Loss=0.01106 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.707 | L2-Norm(final)=12.499 | 1992.1 samples/s | 31.1 steps/s
[Step=12850 Epoch=49.5] | Loss=0.00960 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.733 | L2-Norm(final)=12.488 | 4578.1 samples/s | 71.5 steps/s
[Step=12900 Epoch=49.7] | Loss=0.00845 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.745 | L2-Norm(final)=12.482 | 4626.4 samples/s | 72.3 steps/s
[Step=12950 Epoch=49.8] | Loss=0.00752 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.747 | L2-Norm(final)=12.478 | 4488.0 samples/s | 70.1 steps/s
[Step=13000 Epoch=50.0] | Loss=0.00678 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.742 | L2-Norm(final)=12.475 | 5196.5 samples/s | 81.2 steps/s
[Step=13050 Epoch=50.2] | Loss=0.00616 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.733 | L2-Norm(final)=12.474 | 2093.5 samples/s | 32.7 steps/s
[Step=13100 Epoch=50.4] | Loss=0.00565 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.720 | L2-Norm(final)=12.472 | 4527.5 samples/s | 70.7 steps/s
[Step=13150 Epoch=50.6] | Loss=0.00522 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.705 | L2-Norm(final)=12.471 | 4625.7 samples/s | 72.3 steps/s
[Step=13200 Epoch=50.8] | Loss=0.00485 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.688 | L2-Norm(final)=12.471 | 4586.9 samples/s | 71.7 steps/s
[Step=13250 Epoch=51.0] | Loss=0.00452 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.669 | L2-Norm(final)=12.470 | 4560.0 samples/s | 71.3 steps/s
[Step=13300 Epoch=51.2] | Loss=0.00424 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.649 | L2-Norm(final)=12.470 | 2185.3 samples/s | 34.1 steps/s
[Step=13350 Epoch=51.4] | Loss=0.00399 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.629 | L2-Norm(final)=12.470 | 4569.0 samples/s | 71.4 steps/s
[Step=13400 Epoch=51.6] | Loss=0.00377 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.608 | L2-Norm(final)=12.469 | 4614.4 samples/s | 72.1 steps/s
[Step=13450 Epoch=51.8] | Loss=0.00357 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.586 | L2-Norm(final)=12.469 | 4486.8 samples/s | 70.1 steps/s
[Step=13500 Epoch=52.0] | Loss=0.00340 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.564 | L2-Norm(final)=12.469 | 4499.8 samples/s | 70.3 steps/s
[Step=13550 Epoch=52.2] | Loss=0.00323 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.541 | L2-Norm(final)=12.469 | 2157.2 samples/s | 33.7 steps/s
[Step=13600 Epoch=52.4] | Loss=0.00309 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.519 | L2-Norm(final)=12.470 | 4521.1 samples/s | 70.6 steps/s
[Step=13650 Epoch=52.5] | Loss=0.00295 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.496 | L2-Norm(final)=12.470 | 4555.9 samples/s | 71.2 steps/s
[Step=13700 Epoch=52.7] | Loss=0.00283 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.473 | L2-Norm(final)=12.470 | 4561.9 samples/s | 71.3 steps/s
[Step=13750 Epoch=52.9] | Loss=0.00272 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.450 | L2-Norm(final)=12.470 | 4510.9 samples/s | 70.5 steps/s
[Step=13800 Epoch=53.1] | Loss=0.00261 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.427 | L2-Norm(final)=12.471 | 6667.5 samples/s | 104.2 steps/s
[Step=13850 Epoch=53.3] | Loss=0.00252 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.404 | L2-Norm(final)=12.471 | 1921.1 samples/s | 30.0 steps/s
[Step=13900 Epoch=53.5] | Loss=0.00243 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.380 | L2-Norm(final)=12.472 | 4541.0 samples/s | 71.0 steps/s
[Step=13950 Epoch=53.7] | Loss=0.00234 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.357 | L2-Norm(final)=12.472 | 4510.0 samples/s | 70.5 steps/s
[Step=14000 Epoch=53.9] | Loss=0.00227 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.334 | L2-Norm(final)=12.473 | 4557.7 samples/s | 71.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step14000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06529 | acc=0.9604 | tpr=0.9696 | fpr=0.0597 | 4188.9 samples/s | 16.4 steps/s
Avg test loss: 0.06680, Avg test acc: 0.95797, Avg tpr: 0.96893, Avg fpr: 0.06615, total FA: 516

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07174 | acc=0.9576 | tpr=0.9635 | fpr=0.0553 | 4207.8 samples/s | 16.4 steps/s
Avg test loss: 0.07255, Avg test acc: 0.95697, Avg tpr: 0.96235, Avg fpr: 0.05486, total FA: 428

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.45774 | acc=0.3148 | tpr=0.0021 | fpr=0.0062 | 4194.9 samples/s | 16.4 steps/s
Avg test loss: 6.45978, Avg test acc: 0.31244, Avg tpr: 0.00274, Avg fpr: 0.00641, total FA: 50

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.57333 | acc=0.3126 | tpr=0.0027 | fpr=0.0146 | 4174.7 samples/s | 16.3 steps/s
Avg test loss: 6.57826, Avg test acc: 0.30908, Avg tpr: 0.00268, Avg fpr: 0.01705, total FA: 133

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.07868 | acc=0.1351 | tpr=0.6283 | fpr=0.8738 | 4277.0 samples/s | 16.7 steps/s
[Step= 100] | Loss=5.04847 | acc=0.1350 | tpr=0.6567 | fpr=0.8748 | 7550.4 samples/s | 29.5 steps/s
[Step= 150] | Loss=5.04685 | acc=0.1343 | tpr=0.6585 | fpr=0.8754 | 8001.7 samples/s | 31.3 steps/s
[Step= 200] | Loss=5.04314 | acc=0.1338 | tpr=0.6492 | fpr=0.8756 | 7863.7 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.03660 | acc=0.1339 | tpr=0.6480 | fpr=0.8755 | 7747.4 samples/s | 30.3 steps/s
[Step= 300] | Loss=5.03551 | acc=0.1341 | tpr=0.6465 | fpr=0.8752 | 7945.4 samples/s | 31.0 steps/s
[Step= 350] | Loss=5.04119 | acc=0.1334 | tpr=0.6450 | fpr=0.8758 | 7827.2 samples/s | 30.6 steps/s
[Step= 400] | Loss=5.03263 | acc=0.1334 | tpr=0.6379 | fpr=0.8758 | 7917.7 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.03430 | acc=0.1328 | tpr=0.6378 | fpr=0.8764 | 4896.4 samples/s | 19.1 steps/s
[Step= 500] | Loss=5.03664 | acc=0.1327 | tpr=0.6432 | fpr=0.8765 | 7734.2 samples/s | 30.2 steps/s
[Step= 550] | Loss=5.03693 | acc=0.1327 | tpr=0.6423 | fpr=0.8765 | 15006.7 samples/s | 58.6 steps/s
Avg test loss: 5.03881, Avg test acc: 0.13259, Avg tpr: 0.64184, Avg fpr: 0.87666, total FA: 121723

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.22043 | acc=0.1293 | tpr=0.6593 | fpr=0.8802 | 4183.7 samples/s | 16.3 steps/s
[Step= 100] | Loss=5.17252 | acc=0.1325 | tpr=0.6311 | fpr=0.8768 | 7826.6 samples/s | 30.6 steps/s
[Step= 150] | Loss=5.18221 | acc=0.1323 | tpr=0.6441 | fpr=0.8771 | 7928.4 samples/s | 31.0 steps/s
[Step= 200] | Loss=5.17351 | acc=0.1314 | tpr=0.6284 | fpr=0.8776 | 8088.6 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.16827 | acc=0.1314 | tpr=0.6218 | fpr=0.8775 | 7637.9 samples/s | 29.8 steps/s
[Step= 300] | Loss=5.16791 | acc=0.1312 | tpr=0.6218 | fpr=0.8778 | 7771.9 samples/s | 30.4 steps/s
[Step= 350] | Loss=5.17328 | acc=0.1307 | tpr=0.6149 | fpr=0.8781 | 7951.4 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.16570 | acc=0.1308 | tpr=0.6132 | fpr=0.8779 | 7856.0 samples/s | 30.7 steps/s
[Step= 450] | Loss=5.16837 | acc=0.1307 | tpr=0.6149 | fpr=0.8781 | 4826.5 samples/s | 18.9 steps/s
[Step= 500] | Loss=5.16743 | acc=0.1306 | tpr=0.6203 | fpr=0.8782 | 7890.8 samples/s | 30.8 steps/s
[Step= 550] | Loss=5.16721 | acc=0.1307 | tpr=0.6204 | fpr=0.8782 | 14771.9 samples/s | 57.7 steps/s
Avg test loss: 5.16766, Avg test acc: 0.13065, Avg tpr: 0.62005, Avg fpr: 0.87825, total FA: 121943

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10982 | acc=0.9777 | tpr=0.9292 | fpr=0.0214 | 4210.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.11761 | acc=0.9772 | tpr=0.9403 | fpr=0.0221 | 7552.5 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.11957 | acc=0.9766 | tpr=0.9467 | fpr=0.0228 | 8117.9 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.12076 | acc=0.9766 | tpr=0.9508 | fpr=0.0229 | 7788.1 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.12045 | acc=0.9768 | tpr=0.9476 | fpr=0.0227 | 7743.3 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.12233 | acc=0.9767 | tpr=0.9476 | fpr=0.0227 | 7918.6 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.12355 | acc=0.9765 | tpr=0.9455 | fpr=0.0230 | 7985.7 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.12519 | acc=0.9762 | tpr=0.9409 | fpr=0.0231 | 7504.8 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.12768 | acc=0.9758 | tpr=0.9377 | fpr=0.0235 | 5894.0 samples/s | 23.0 steps/s
[Step= 500] | Loss=0.12698 | acc=0.9759 | tpr=0.9388 | fpr=0.0234 | 7599.2 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.12591 | acc=0.9761 | tpr=0.9375 | fpr=0.0232 | 15150.5 samples/s | 59.2 steps/s
Avg test loss: 0.12565, Avg test acc: 0.97611, Avg tpr: 0.93780, Avg fpr: 0.02319, total FA: 3220

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10866 | acc=0.9801 | tpr=0.9159 | fpr=0.0188 | 4235.7 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.11510 | acc=0.9798 | tpr=0.9275 | fpr=0.0193 | 7684.9 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.11881 | acc=0.9791 | tpr=0.9424 | fpr=0.0203 | 7648.7 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.12064 | acc=0.9793 | tpr=0.9486 | fpr=0.0201 | 7288.9 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.12015 | acc=0.9793 | tpr=0.9467 | fpr=0.0201 | 7823.2 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.12075 | acc=0.9792 | tpr=0.9455 | fpr=0.0201 | 7716.8 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.12159 | acc=0.9790 | tpr=0.9455 | fpr=0.0204 | 8091.0 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.12238 | acc=0.9790 | tpr=0.9458 | fpr=0.0204 | 7854.8 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.12457 | acc=0.9788 | tpr=0.9440 | fpr=0.0205 | 7840.1 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.12358 | acc=0.9790 | tpr=0.9436 | fpr=0.0204 | 7756.1 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.12306 | acc=0.9790 | tpr=0.9411 | fpr=0.0203 | 14527.7 samples/s | 56.7 steps/s
Avg test loss: 0.12300, Avg test acc: 0.97898, Avg tpr: 0.94097, Avg fpr: 0.02033, total FA: 2823

server round 7/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=14001 Epoch=27.3] | Loss=0.10831 | Reg=0.00182 | acc=0.9062 | L2-Norm=13.494 | L2-Norm(final)=10.274 | 4589.8 samples/s | 71.7 steps/s
[Step=14050 Epoch=27.4] | Loss=0.09717 | Reg=0.00182 | acc=0.9375 | L2-Norm=13.500 | L2-Norm(final)=10.355 | 5029.3 samples/s | 78.6 steps/s
[Step=14100 Epoch=27.5] | Loss=0.09711 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.502 | L2-Norm(final)=10.459 | 5338.7 samples/s | 83.4 steps/s
[Step=14150 Epoch=27.6] | Loss=0.09478 | Reg=0.00182 | acc=0.8906 | L2-Norm=13.502 | L2-Norm(final)=10.563 | 5540.9 samples/s | 86.6 steps/s
[Step=14200 Epoch=27.7] | Loss=0.09305 | Reg=0.00182 | acc=0.9219 | L2-Norm=13.502 | L2-Norm(final)=10.664 | 5595.4 samples/s | 87.4 steps/s
[Step=14250 Epoch=27.8] | Loss=0.09123 | Reg=0.00182 | acc=0.9062 | L2-Norm=13.502 | L2-Norm(final)=10.759 | 5542.4 samples/s | 86.6 steps/s
[Step=14300 Epoch=27.9] | Loss=0.09065 | Reg=0.00182 | acc=0.9062 | L2-Norm=13.503 | L2-Norm(final)=10.848 | 5642.7 samples/s | 88.2 steps/s
[Step=14350 Epoch=28.0] | Loss=0.09112 | Reg=0.00182 | acc=0.9062 | L2-Norm=13.503 | L2-Norm(final)=10.932 | 5540.7 samples/s | 86.6 steps/s
[Step=14400 Epoch=28.1] | Loss=0.08958 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.503 | L2-Norm(final)=11.014 | 5548.3 samples/s | 86.7 steps/s
[Step=14450 Epoch=28.2] | Loss=0.08891 | Reg=0.00182 | acc=0.9375 | L2-Norm=13.503 | L2-Norm(final)=11.093 | 5626.6 samples/s | 87.9 steps/s
[Step=14500 Epoch=28.3] | Loss=0.08845 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.503 | L2-Norm(final)=11.170 | 6907.1 samples/s | 107.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=14501 Epoch=28.3] | Loss=0.10014 | Reg=0.00182 | acc=0.8906 | L2-Norm=13.503 | L2-Norm(final)=11.934 | 4549.7 samples/s | 71.1 steps/s
[Step=14550 Epoch=28.4] | Loss=0.06337 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.753 | L2-Norm(final)=11.946 | 4482.9 samples/s | 70.0 steps/s
[Step=14600 Epoch=28.5] | Loss=0.06005 | Reg=0.00195 | acc=0.9531 | L2-Norm=13.946 | L2-Norm(final)=11.924 | 4784.1 samples/s | 74.8 steps/s
[Step=14650 Epoch=28.6] | Loss=0.05726 | Reg=0.00198 | acc=0.9219 | L2-Norm=14.080 | L2-Norm(final)=11.908 | 4858.7 samples/s | 75.9 steps/s
[Step=14700 Epoch=28.7] | Loss=0.05597 | Reg=0.00201 | acc=0.9062 | L2-Norm=14.184 | L2-Norm(final)=11.896 | 4866.3 samples/s | 76.0 steps/s
[Step=14750 Epoch=28.8] | Loss=0.05312 | Reg=0.00204 | acc=0.9531 | L2-Norm=14.266 | L2-Norm(final)=11.883 | 4795.5 samples/s | 74.9 steps/s
[Step=14800 Epoch=28.9] | Loss=0.05162 | Reg=0.00206 | acc=0.9219 | L2-Norm=14.337 | L2-Norm(final)=11.872 | 4815.3 samples/s | 75.2 steps/s
[Step=14850 Epoch=29.0] | Loss=0.05018 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.400 | L2-Norm(final)=11.863 | 4850.1 samples/s | 75.8 steps/s
[Step=14900 Epoch=29.1] | Loss=0.04983 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.453 | L2-Norm(final)=11.853 | 4836.6 samples/s | 75.6 steps/s
[Step=14950 Epoch=29.2] | Loss=0.04907 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.503 | L2-Norm(final)=11.843 | 4836.0 samples/s | 75.6 steps/s
[Step=15000 Epoch=29.3] | Loss=0.04755 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.548 | L2-Norm(final)=11.834 | 5769.9 samples/s | 90.2 steps/s
[Step=15050 Epoch=29.4] | Loss=0.04651 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.590 | L2-Norm(final)=11.826 | 2063.0 samples/s | 32.2 steps/s
[Step=15100 Epoch=29.5] | Loss=0.04462 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.630 | L2-Norm(final)=11.818 | 4772.4 samples/s | 74.6 steps/s
[Step=15150 Epoch=29.5] | Loss=0.04339 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.666 | L2-Norm(final)=11.812 | 4744.9 samples/s | 74.1 steps/s
[Step=15200 Epoch=29.6] | Loss=0.04224 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.700 | L2-Norm(final)=11.805 | 4799.5 samples/s | 75.0 steps/s
[Step=15250 Epoch=29.7] | Loss=0.04124 | Reg=0.00217 | acc=0.9531 | L2-Norm=14.733 | L2-Norm(final)=11.799 | 4897.8 samples/s | 76.5 steps/s
[Step=15300 Epoch=29.8] | Loss=0.04044 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.765 | L2-Norm(final)=11.794 | 4738.0 samples/s | 74.0 steps/s
[Step=15350 Epoch=29.9] | Loss=0.04029 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.795 | L2-Norm(final)=11.788 | 4804.3 samples/s | 75.1 steps/s
[Step=15400 Epoch=30.0] | Loss=0.03970 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.824 | L2-Norm(final)=11.783 | 4792.6 samples/s | 74.9 steps/s
[Step=15450 Epoch=30.1] | Loss=0.03975 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.855 | L2-Norm(final)=11.777 | 4794.4 samples/s | 74.9 steps/s
[Step=15500 Epoch=30.2] | Loss=0.03929 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.887 | L2-Norm(final)=11.772 | 5099.2 samples/s | 79.7 steps/s
[Step=15550 Epoch=30.3] | Loss=0.03859 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.917 | L2-Norm(final)=11.767 | 2146.0 samples/s | 33.5 steps/s
[Step=15600 Epoch=30.4] | Loss=0.03772 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.947 | L2-Norm(final)=11.763 | 4781.8 samples/s | 74.7 steps/s
[Step=15650 Epoch=30.5] | Loss=0.03709 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.975 | L2-Norm(final)=11.759 | 4761.4 samples/s | 74.4 steps/s
[Step=15700 Epoch=30.6] | Loss=0.03672 | Reg=0.00225 | acc=0.9688 | L2-Norm=15.002 | L2-Norm(final)=11.755 | 4783.2 samples/s | 74.7 steps/s
[Step=15750 Epoch=30.7] | Loss=0.03621 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.030 | L2-Norm(final)=11.751 | 4818.5 samples/s | 75.3 steps/s
[Step=15800 Epoch=30.8] | Loss=0.03560 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.057 | L2-Norm(final)=11.748 | 4844.1 samples/s | 75.7 steps/s
[Step=15850 Epoch=30.9] | Loss=0.03519 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.083 | L2-Norm(final)=11.745 | 4776.3 samples/s | 74.6 steps/s
[Step=15900 Epoch=31.0] | Loss=0.03488 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.110 | L2-Norm(final)=11.741 | 4808.2 samples/s | 75.1 steps/s
[Step=15950 Epoch=31.1] | Loss=0.03452 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.135 | L2-Norm(final)=11.738 | 4797.3 samples/s | 75.0 steps/s
[Step=16000 Epoch=31.2] | Loss=0.03423 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.161 | L2-Norm(final)=11.735 | 4819.1 samples/s | 75.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=14001 Epoch=27.4] | Loss=0.08426 | Reg=0.00182 | acc=0.9375 | L2-Norm=13.494 | L2-Norm(final)=11.043 | 4454.1 samples/s | 69.6 steps/s
[Step=14050 Epoch=27.5] | Loss=0.09931 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.502 | L2-Norm(final)=11.127 | 4542.2 samples/s | 71.0 steps/s
[Step=14100 Epoch=27.6] | Loss=0.09889 | Reg=0.00182 | acc=0.9062 | L2-Norm=13.503 | L2-Norm(final)=11.231 | 5162.7 samples/s | 80.7 steps/s
[Step=14150 Epoch=27.7] | Loss=0.09769 | Reg=0.00182 | acc=0.9375 | L2-Norm=13.503 | L2-Norm(final)=11.339 | 5457.5 samples/s | 85.3 steps/s
[Step=14200 Epoch=27.8] | Loss=0.09662 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.504 | L2-Norm(final)=11.441 | 5461.5 samples/s | 85.3 steps/s
[Step=14250 Epoch=27.9] | Loss=0.09640 | Reg=0.00182 | acc=0.8906 | L2-Norm=13.504 | L2-Norm(final)=11.530 | 5598.2 samples/s | 87.5 steps/s
[Step=14300 Epoch=28.0] | Loss=0.09573 | Reg=0.00182 | acc=0.9062 | L2-Norm=13.504 | L2-Norm(final)=11.610 | 5575.1 samples/s | 87.1 steps/s
[Step=14350 Epoch=28.1] | Loss=0.09410 | Reg=0.00182 | acc=0.9375 | L2-Norm=13.504 | L2-Norm(final)=11.687 | 5574.8 samples/s | 87.1 steps/s
[Step=14400 Epoch=28.2] | Loss=0.09367 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.504 | L2-Norm(final)=11.763 | 5489.8 samples/s | 85.8 steps/s
[Step=14450 Epoch=28.2] | Loss=0.09281 | Reg=0.00182 | acc=0.8906 | L2-Norm=13.504 | L2-Norm(final)=11.836 | 5486.0 samples/s | 85.7 steps/s
[Step=14500 Epoch=28.3] | Loss=0.09209 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.504 | L2-Norm(final)=11.907 | 7201.3 samples/s | 112.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=14501 Epoch=28.3] | Loss=0.07436 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.504 | L2-Norm(final)=12.598 | 4511.2 samples/s | 70.5 steps/s
[Step=14550 Epoch=28.4] | Loss=0.06822 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.753 | L2-Norm(final)=12.589 | 4754.3 samples/s | 74.3 steps/s
[Step=14600 Epoch=28.5] | Loss=0.05546 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.930 | L2-Norm(final)=12.569 | 4784.5 samples/s | 74.8 steps/s
[Step=14650 Epoch=28.6] | Loss=0.05435 | Reg=0.00198 | acc=0.9375 | L2-Norm=14.061 | L2-Norm(final)=12.551 | 4758.8 samples/s | 74.4 steps/s
[Step=14700 Epoch=28.7] | Loss=0.05252 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.168 | L2-Norm(final)=12.538 | 4758.7 samples/s | 74.4 steps/s
[Step=14750 Epoch=28.8] | Loss=0.05056 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.255 | L2-Norm(final)=12.526 | 4746.2 samples/s | 74.2 steps/s
[Step=14800 Epoch=28.9] | Loss=0.05041 | Reg=0.00205 | acc=0.9375 | L2-Norm=14.327 | L2-Norm(final)=12.515 | 4822.6 samples/s | 75.4 steps/s
[Step=14850 Epoch=29.0] | Loss=0.05020 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.390 | L2-Norm(final)=12.504 | 4878.9 samples/s | 76.2 steps/s
[Step=14900 Epoch=29.1] | Loss=0.04895 | Reg=0.00209 | acc=0.9219 | L2-Norm=14.446 | L2-Norm(final)=12.493 | 4750.3 samples/s | 74.2 steps/s
[Step=14950 Epoch=29.2] | Loss=0.04805 | Reg=0.00210 | acc=0.9531 | L2-Norm=14.497 | L2-Norm(final)=12.484 | 4826.4 samples/s | 75.4 steps/s
[Step=15000 Epoch=29.3] | Loss=0.04766 | Reg=0.00212 | acc=0.9531 | L2-Norm=14.542 | L2-Norm(final)=12.475 | 5806.9 samples/s | 90.7 steps/s
[Step=15050 Epoch=29.4] | Loss=0.04555 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.585 | L2-Norm(final)=12.468 | 2085.1 samples/s | 32.6 steps/s
[Step=15100 Epoch=29.5] | Loss=0.04423 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.623 | L2-Norm(final)=12.462 | 4828.3 samples/s | 75.4 steps/s
[Step=15150 Epoch=29.6] | Loss=0.04292 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.658 | L2-Norm(final)=12.456 | 4720.5 samples/s | 73.8 steps/s
[Step=15200 Epoch=29.7] | Loss=0.04218 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.693 | L2-Norm(final)=12.450 | 4841.6 samples/s | 75.7 steps/s
[Step=15250 Epoch=29.8] | Loss=0.04157 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.727 | L2-Norm(final)=12.445 | 4786.7 samples/s | 74.8 steps/s
[Step=15300 Epoch=29.9] | Loss=0.04084 | Reg=0.00218 | acc=0.9531 | L2-Norm=14.760 | L2-Norm(final)=12.439 | 4788.9 samples/s | 74.8 steps/s
[Step=15350 Epoch=30.0] | Loss=0.04040 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.792 | L2-Norm(final)=12.434 | 4799.4 samples/s | 75.0 steps/s
[Step=15400 Epoch=30.1] | Loss=0.03971 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.823 | L2-Norm(final)=12.430 | 4769.8 samples/s | 74.5 steps/s
[Step=15450 Epoch=30.2] | Loss=0.03926 | Reg=0.00221 | acc=0.9531 | L2-Norm=14.853 | L2-Norm(final)=12.426 | 4804.2 samples/s | 75.1 steps/s
[Step=15500 Epoch=30.3] | Loss=0.03898 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.882 | L2-Norm(final)=12.422 | 5217.1 samples/s | 81.5 steps/s
[Step=15550 Epoch=30.4] | Loss=0.03810 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.910 | L2-Norm(final)=12.418 | 2213.8 samples/s | 34.6 steps/s
[Step=15600 Epoch=30.5] | Loss=0.03749 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.936 | L2-Norm(final)=12.414 | 4810.8 samples/s | 75.2 steps/s
[Step=15650 Epoch=30.6] | Loss=0.03685 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.962 | L2-Norm(final)=12.411 | 4687.5 samples/s | 73.2 steps/s
[Step=15700 Epoch=30.7] | Loss=0.03618 | Reg=0.00225 | acc=0.9688 | L2-Norm=14.986 | L2-Norm(final)=12.408 | 4768.6 samples/s | 74.5 steps/s
[Step=15750 Epoch=30.8] | Loss=0.03561 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.010 | L2-Norm(final)=12.405 | 4773.5 samples/s | 74.6 steps/s
[Step=15800 Epoch=30.9] | Loss=0.03543 | Reg=0.00226 | acc=0.9531 | L2-Norm=15.035 | L2-Norm(final)=12.401 | 4839.5 samples/s | 75.6 steps/s
[Step=15850 Epoch=31.0] | Loss=0.03504 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.060 | L2-Norm(final)=12.398 | 4777.0 samples/s | 74.6 steps/s
[Step=15900 Epoch=31.1] | Loss=0.03460 | Reg=0.00228 | acc=0.9531 | L2-Norm=15.084 | L2-Norm(final)=12.395 | 4812.6 samples/s | 75.2 steps/s
[Step=15950 Epoch=31.2] | Loss=0.03455 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.108 | L2-Norm(final)=12.392 | 4858.9 samples/s | 75.9 steps/s
[Step=16000 Epoch=31.3] | Loss=0.03425 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.132 | L2-Norm(final)=12.389 | 4828.0 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step16000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=14001 Epoch=53.6] | Loss=0.00133 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.494 | L2-Norm(final)=12.059 | 4283.8 samples/s | 66.9 steps/s
[Step=14050 Epoch=53.8] | Loss=0.00822 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.487 | L2-Norm(final)=12.103 | 4676.4 samples/s | 73.1 steps/s
[Step=14100 Epoch=54.0] | Loss=0.00793 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=12.171 | 5200.0 samples/s | 81.3 steps/s
[Step=14150 Epoch=54.2] | Loss=0.00752 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=12.230 | 5315.1 samples/s | 83.0 steps/s
[Step=14200 Epoch=54.4] | Loss=0.00717 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=12.289 | 5255.3 samples/s | 82.1 steps/s
[Step=14250 Epoch=54.6] | Loss=0.00703 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=12.347 | 6610.0 samples/s | 103.3 steps/s
[Step=14300 Epoch=54.8] | Loss=0.00690 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=12.407 | 2160.2 samples/s | 33.8 steps/s
[Step=14350 Epoch=55.0] | Loss=0.00685 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=12.465 | 5167.9 samples/s | 80.7 steps/s
[Step=14400 Epoch=55.2] | Loss=0.00690 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=12.520 | 5248.8 samples/s | 82.0 steps/s
[Step=14450 Epoch=55.4] | Loss=0.00680 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=12.573 | 5253.1 samples/s | 82.1 steps/s
[Step=14500 Epoch=55.6] | Loss=0.00675 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=12.626 | 5907.8 samples/s | 92.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=14501 Epoch=55.6] | Loss=0.00071 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=13.142 | 4416.9 samples/s | 69.0 steps/s
[Step=14550 Epoch=55.8] | Loss=0.00997 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.653 | L2-Norm(final)=13.120 | 4482.5 samples/s | 70.0 steps/s
[Step=14600 Epoch=55.9] | Loss=0.01176 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.859 | L2-Norm(final)=13.094 | 4524.4 samples/s | 70.7 steps/s
[Step=14650 Epoch=56.1] | Loss=0.01626 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.079 | L2-Norm(final)=13.043 | 4654.4 samples/s | 72.7 steps/s
[Step=14700 Epoch=56.3] | Loss=0.01491 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.251 | L2-Norm(final)=13.004 | 4547.3 samples/s | 71.1 steps/s
[Step=14750 Epoch=56.5] | Loss=0.01295 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.373 | L2-Norm(final)=12.976 | 5690.5 samples/s | 88.9 steps/s
[Step=14800 Epoch=56.7] | Loss=0.01102 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.452 | L2-Norm(final)=12.956 | 2025.0 samples/s | 31.6 steps/s
[Step=14850 Epoch=56.9] | Loss=0.00947 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.501 | L2-Norm(final)=12.943 | 4573.9 samples/s | 71.5 steps/s
[Step=14900 Epoch=57.1] | Loss=0.00832 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.530 | L2-Norm(final)=12.935 | 4474.7 samples/s | 69.9 steps/s
[Step=14950 Epoch=57.3] | Loss=0.00740 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.548 | L2-Norm(final)=12.928 | 4559.9 samples/s | 71.2 steps/s
[Step=15000 Epoch=57.5] | Loss=0.00667 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.556 | L2-Norm(final)=12.924 | 5025.2 samples/s | 78.5 steps/s
[Step=15050 Epoch=57.7] | Loss=0.00611 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.559 | L2-Norm(final)=12.920 | 2122.2 samples/s | 33.2 steps/s
[Step=15100 Epoch=57.9] | Loss=0.00560 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.559 | L2-Norm(final)=12.917 | 4579.4 samples/s | 71.6 steps/s
[Step=15150 Epoch=58.0] | Loss=0.00520 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.556 | L2-Norm(final)=12.915 | 4539.9 samples/s | 70.9 steps/s
[Step=15200 Epoch=58.2] | Loss=0.00484 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.550 | L2-Norm(final)=12.912 | 4599.0 samples/s | 71.9 steps/s
[Step=15250 Epoch=58.4] | Loss=0.00452 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.542 | L2-Norm(final)=12.910 | 4537.5 samples/s | 70.9 steps/s
[Step=15300 Epoch=58.6] | Loss=0.00424 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.532 | L2-Norm(final)=12.909 | 2208.0 samples/s | 34.5 steps/s
[Step=15350 Epoch=58.8] | Loss=0.00399 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.521 | L2-Norm(final)=12.907 | 4646.2 samples/s | 72.6 steps/s
[Step=15400 Epoch=59.0] | Loss=0.00377 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.508 | L2-Norm(final)=12.906 | 4544.9 samples/s | 71.0 steps/s
[Step=15450 Epoch=59.2] | Loss=0.00357 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.495 | L2-Norm(final)=12.905 | 4597.8 samples/s | 71.8 steps/s
[Step=15500 Epoch=59.4] | Loss=0.00339 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.480 | L2-Norm(final)=12.905 | 4511.9 samples/s | 70.5 steps/s
[Step=15550 Epoch=59.6] | Loss=0.00323 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.465 | L2-Norm(final)=12.904 | 2199.6 samples/s | 34.4 steps/s
[Step=15600 Epoch=59.8] | Loss=0.00308 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.449 | L2-Norm(final)=12.904 | 4550.7 samples/s | 71.1 steps/s
[Step=15650 Epoch=60.0] | Loss=0.00295 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.433 | L2-Norm(final)=12.903 | 4536.0 samples/s | 70.9 steps/s
[Step=15700 Epoch=60.2] | Loss=0.00283 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.416 | L2-Norm(final)=12.903 | 4589.7 samples/s | 71.7 steps/s
[Step=15750 Epoch=60.3] | Loss=0.00271 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.399 | L2-Norm(final)=12.902 | 4512.6 samples/s | 70.5 steps/s
[Step=15800 Epoch=60.5] | Loss=0.00261 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.381 | L2-Norm(final)=12.902 | 6178.7 samples/s | 96.5 steps/s
[Step=15850 Epoch=60.7] | Loss=0.00251 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.363 | L2-Norm(final)=12.902 | 1971.4 samples/s | 30.8 steps/s
[Step=15900 Epoch=60.9] | Loss=0.00242 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.346 | L2-Norm(final)=12.902 | 4486.9 samples/s | 70.1 steps/s
[Step=15950 Epoch=61.1] | Loss=0.00234 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.327 | L2-Norm(final)=12.901 | 4578.1 samples/s | 71.5 steps/s
[Step=16000 Epoch=61.3] | Loss=0.00226 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.309 | L2-Norm(final)=12.901 | 4555.2 samples/s | 71.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step16000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=14001 Epoch=53.9] | Loss=0.00965 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.494 | L2-Norm(final)=12.490 | 4137.0 samples/s | 64.6 steps/s
[Step=14050 Epoch=54.1] | Loss=0.00624 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.487 | L2-Norm(final)=12.563 | 5107.0 samples/s | 79.8 steps/s
[Step=14100 Epoch=54.3] | Loss=0.00555 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.487 | L2-Norm(final)=12.654 | 5230.5 samples/s | 81.7 steps/s
[Step=14150 Epoch=54.5] | Loss=0.00548 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=12.744 | 5127.6 samples/s | 80.1 steps/s
[Step=14200 Epoch=54.7] | Loss=0.00584 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=12.829 | 5142.2 samples/s | 80.3 steps/s
[Step=14250 Epoch=54.9] | Loss=0.00577 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=12.907 | 7036.4 samples/s | 109.9 steps/s
[Step=14300 Epoch=55.0] | Loss=0.00578 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.486 | L2-Norm(final)=12.981 | 2133.0 samples/s | 33.3 steps/s
[Step=14350 Epoch=55.2] | Loss=0.00575 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=13.050 | 5111.5 samples/s | 79.9 steps/s
[Step=14400 Epoch=55.4] | Loss=0.00564 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=13.117 | 5194.7 samples/s | 81.2 steps/s
[Step=14450 Epoch=55.6] | Loss=0.00553 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=13.185 | 5248.7 samples/s | 82.0 steps/s
[Step=14500 Epoch=55.8] | Loss=0.00542 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=13.252 | 6027.5 samples/s | 94.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=14501 Epoch=55.8] | Loss=0.00628 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.486 | L2-Norm(final)=13.922 | 4316.5 samples/s | 67.4 steps/s
[Step=14550 Epoch=56.0] | Loss=0.01523 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.664 | L2-Norm(final)=13.902 | 4591.6 samples/s | 71.7 steps/s
[Step=14600 Epoch=56.2] | Loss=0.01268 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.936 | L2-Norm(final)=13.838 | 4533.4 samples/s | 70.8 steps/s
[Step=14650 Epoch=56.4] | Loss=0.01379 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.091 | L2-Norm(final)=13.795 | 4601.0 samples/s | 71.9 steps/s
[Step=14700 Epoch=56.6] | Loss=0.01139 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.208 | L2-Norm(final)=13.762 | 4507.8 samples/s | 70.4 steps/s
[Step=14750 Epoch=56.8] | Loss=0.00999 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.287 | L2-Norm(final)=13.744 | 5763.0 samples/s | 90.0 steps/s
[Step=14800 Epoch=57.0] | Loss=0.00849 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.336 | L2-Norm(final)=13.729 | 2003.0 samples/s | 31.3 steps/s
[Step=14850 Epoch=57.2] | Loss=0.00730 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.364 | L2-Norm(final)=13.720 | 4521.3 samples/s | 70.6 steps/s
[Step=14900 Epoch=57.4] | Loss=0.00640 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.378 | L2-Norm(final)=13.713 | 4499.9 samples/s | 70.3 steps/s
[Step=14950 Epoch=57.5] | Loss=0.00570 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.382 | L2-Norm(final)=13.708 | 4221.7 samples/s | 66.0 steps/s
[Step=15000 Epoch=57.7] | Loss=0.00513 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.380 | L2-Norm(final)=13.705 | 4977.2 samples/s | 77.8 steps/s
[Step=15050 Epoch=57.9] | Loss=0.00467 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.374 | L2-Norm(final)=13.702 | 2093.5 samples/s | 32.7 steps/s
[Step=15100 Epoch=58.1] | Loss=0.00428 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.364 | L2-Norm(final)=13.700 | 4651.2 samples/s | 72.7 steps/s
[Step=15150 Epoch=58.3] | Loss=0.00395 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.352 | L2-Norm(final)=13.699 | 4470.5 samples/s | 69.9 steps/s
[Step=15200 Epoch=58.5] | Loss=0.00367 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.337 | L2-Norm(final)=13.698 | 4585.1 samples/s | 71.6 steps/s
[Step=15250 Epoch=58.7] | Loss=0.00343 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.322 | L2-Norm(final)=13.697 | 4611.1 samples/s | 72.0 steps/s
[Step=15300 Epoch=58.9] | Loss=0.00321 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.305 | L2-Norm(final)=13.696 | 2191.5 samples/s | 34.2 steps/s
[Step=15350 Epoch=59.1] | Loss=0.00303 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.287 | L2-Norm(final)=13.695 | 4593.0 samples/s | 71.8 steps/s
[Step=15400 Epoch=59.3] | Loss=0.00286 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.269 | L2-Norm(final)=13.695 | 4524.0 samples/s | 70.7 steps/s
[Step=15450 Epoch=59.5] | Loss=0.00271 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.250 | L2-Norm(final)=13.695 | 4595.9 samples/s | 71.8 steps/s
[Step=15500 Epoch=59.7] | Loss=0.00257 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.230 | L2-Norm(final)=13.695 | 4549.5 samples/s | 71.1 steps/s
[Step=15550 Epoch=59.9] | Loss=0.00245 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.211 | L2-Norm(final)=13.694 | 2223.3 samples/s | 34.7 steps/s
[Step=15600 Epoch=60.1] | Loss=0.00234 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.191 | L2-Norm(final)=13.694 | 4511.6 samples/s | 70.5 steps/s
[Step=15650 Epoch=60.2] | Loss=0.00224 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.170 | L2-Norm(final)=13.694 | 4499.0 samples/s | 70.3 steps/s
[Step=15700 Epoch=60.4] | Loss=0.00214 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.150 | L2-Norm(final)=13.694 | 4522.5 samples/s | 70.7 steps/s
[Step=15750 Epoch=60.6] | Loss=0.00206 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.129 | L2-Norm(final)=13.694 | 4542.4 samples/s | 71.0 steps/s
[Step=15800 Epoch=60.8] | Loss=0.00198 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.108 | L2-Norm(final)=13.695 | 6648.7 samples/s | 103.9 steps/s
[Step=15850 Epoch=61.0] | Loss=0.00191 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=13.695 | 1918.9 samples/s | 30.0 steps/s
[Step=15900 Epoch=61.2] | Loss=0.00184 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.066 | L2-Norm(final)=13.695 | 4579.8 samples/s | 71.6 steps/s
[Step=15950 Epoch=61.4] | Loss=0.00178 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.045 | L2-Norm(final)=13.695 | 4593.3 samples/s | 71.8 steps/s
[Step=16000 Epoch=61.6] | Loss=0.00172 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.024 | L2-Norm(final)=13.695 | 4496.8 samples/s | 70.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07072 | acc=0.9579 | tpr=0.9637 | fpr=0.0548 | 3075.4 samples/s | 12.0 steps/s
Avg test loss: 0.07203, Avg test acc: 0.95725, Avg tpr: 0.96351, Avg fpr: 0.05653, total FA: 441

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07356 | acc=0.9591 | tpr=0.9746 | fpr=0.0746 | 4187.3 samples/s | 16.4 steps/s
Avg test loss: 0.07065, Avg test acc: 0.95965, Avg tpr: 0.97599, Avg fpr: 0.07627, total FA: 595

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.24680 | acc=0.3136 | tpr=0.0013 | fpr=0.0082 | 4180.6 samples/s | 16.3 steps/s
Avg test loss: 7.25625, Avg test acc: 0.31092, Avg tpr: 0.00152, Avg fpr: 0.00859, total FA: 67

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=8.19618 | acc=0.3127 | tpr=0.0017 | fpr=0.0121 | 4236.6 samples/s | 16.5 steps/s
Avg test loss: 8.18420, Avg test acc: 0.31028, Avg tpr: 0.00233, Avg fpr: 0.01243, total FA: 97

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.16936 | acc=0.1263 | tpr=0.6239 | fpr=0.8826 | 4204.1 samples/s | 16.4 steps/s
[Step= 100] | Loss=5.13048 | acc=0.1250 | tpr=0.6333 | fpr=0.8845 | 7733.1 samples/s | 30.2 steps/s
[Step= 150] | Loss=5.14639 | acc=0.1240 | tpr=0.6354 | fpr=0.8854 | 7977.5 samples/s | 31.2 steps/s
[Step= 200] | Loss=5.13794 | acc=0.1232 | tpr=0.6153 | fpr=0.8858 | 7938.8 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.12760 | acc=0.1229 | tpr=0.5983 | fpr=0.8858 | 7739.6 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.13546 | acc=0.1236 | tpr=0.5964 | fpr=0.8850 | 7858.0 samples/s | 30.7 steps/s
[Step= 350] | Loss=5.13909 | acc=0.1231 | tpr=0.5980 | fpr=0.8855 | 7941.2 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.13106 | acc=0.1229 | tpr=0.5881 | fpr=0.8855 | 8037.6 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.13191 | acc=0.1223 | tpr=0.5852 | fpr=0.8861 | 7599.3 samples/s | 29.7 steps/s
[Step= 500] | Loss=5.12841 | acc=0.1225 | tpr=0.5907 | fpr=0.8859 | 8104.6 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.13034 | acc=0.1226 | tpr=0.5913 | fpr=0.8859 | 13525.3 samples/s | 52.8 steps/s
Avg test loss: 5.13221, Avg test acc: 0.12257, Avg tpr: 0.59113, Avg fpr: 0.88595, total FA: 123012

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.86775 | acc=0.1204 | tpr=0.7301 | fpr=0.8906 | 4204.1 samples/s | 16.4 steps/s
[Step= 100] | Loss=5.79165 | acc=0.1219 | tpr=0.7399 | fpr=0.8897 | 7898.1 samples/s | 30.9 steps/s
[Step= 150] | Loss=5.80152 | acc=0.1211 | tpr=0.7507 | fpr=0.8905 | 7779.1 samples/s | 30.4 steps/s
[Step= 200] | Loss=5.79607 | acc=0.1209 | tpr=0.7475 | fpr=0.8905 | 7757.5 samples/s | 30.3 steps/s
[Step= 250] | Loss=5.78612 | acc=0.1214 | tpr=0.7476 | fpr=0.8900 | 7949.3 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.78678 | acc=0.1215 | tpr=0.7469 | fpr=0.8899 | 7790.5 samples/s | 30.4 steps/s
[Step= 350] | Loss=5.79186 | acc=0.1215 | tpr=0.7508 | fpr=0.8899 | 7639.9 samples/s | 29.8 steps/s
[Step= 400] | Loss=5.78314 | acc=0.1215 | tpr=0.7429 | fpr=0.8898 | 7921.4 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.78546 | acc=0.1216 | tpr=0.7420 | fpr=0.8896 | 7783.3 samples/s | 30.4 steps/s
[Step= 500] | Loss=5.78293 | acc=0.1218 | tpr=0.7498 | fpr=0.8895 | 7856.3 samples/s | 30.7 steps/s
[Step= 550] | Loss=5.78175 | acc=0.1222 | tpr=0.7509 | fpr=0.8892 | 14122.4 samples/s | 55.2 steps/s
Avg test loss: 5.78381, Avg test acc: 0.12213, Avg tpr: 0.75079, Avg fpr: 0.88930, total FA: 123477

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11045 | acc=0.9808 | tpr=0.9469 | fpr=0.0186 | 4158.0 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.11555 | acc=0.9806 | tpr=0.9531 | fpr=0.0189 | 7890.8 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.11934 | acc=0.9800 | tpr=0.9510 | fpr=0.0194 | 8319.4 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.12018 | acc=0.9800 | tpr=0.9563 | fpr=0.0196 | 7960.9 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.11904 | acc=0.9802 | tpr=0.9537 | fpr=0.0193 | 7677.8 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.12051 | acc=0.9798 | tpr=0.9513 | fpr=0.0196 | 7753.9 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.12206 | acc=0.9794 | tpr=0.9487 | fpr=0.0200 | 7989.1 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.12300 | acc=0.9792 | tpr=0.9469 | fpr=0.0202 | 7911.2 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.12539 | acc=0.9789 | tpr=0.9440 | fpr=0.0204 | 7784.7 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.12496 | acc=0.9790 | tpr=0.9449 | fpr=0.0204 | 7761.8 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.12422 | acc=0.9790 | tpr=0.9431 | fpr=0.0203 | 14790.8 samples/s | 57.8 steps/s
Avg test loss: 0.12403, Avg test acc: 0.97901, Avg tpr: 0.94334, Avg fpr: 0.02035, total FA: 2825

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11809 | acc=0.9796 | tpr=0.9159 | fpr=0.0192 | 4160.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.12645 | acc=0.9786 | tpr=0.9318 | fpr=0.0205 | 7853.2 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.12957 | acc=0.9780 | tpr=0.9452 | fpr=0.0213 | 7942.6 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.13048 | acc=0.9782 | tpr=0.9432 | fpr=0.0212 | 7901.9 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.12978 | acc=0.9782 | tpr=0.9441 | fpr=0.0212 | 7828.1 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.13100 | acc=0.9779 | tpr=0.9447 | fpr=0.0215 | 7892.7 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.13170 | acc=0.9777 | tpr=0.9449 | fpr=0.0217 | 7693.2 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.13284 | acc=0.9776 | tpr=0.9437 | fpr=0.0217 | 7933.3 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.13485 | acc=0.9774 | tpr=0.9411 | fpr=0.0219 | 7776.0 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.13427 | acc=0.9775 | tpr=0.9419 | fpr=0.0218 | 7836.5 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.13360 | acc=0.9777 | tpr=0.9419 | fpr=0.0217 | 15216.3 samples/s | 59.4 steps/s
Avg test loss: 0.13343, Avg test acc: 0.97768, Avg tpr: 0.94176, Avg fpr: 0.02167, total FA: 3009

server round 8/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=16001 Epoch=31.2] | Loss=0.10622 | Reg=0.00184 | acc=0.9062 | L2-Norm=13.554 | L2-Norm(final)=11.635 | 4116.2 samples/s | 64.3 steps/s
[Step=16050 Epoch=31.3] | Loss=0.08823 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.564 | L2-Norm(final)=11.717 | 5038.2 samples/s | 78.7 steps/s
[Step=16100 Epoch=31.4] | Loss=0.08773 | Reg=0.00184 | acc=0.9375 | L2-Norm=13.565 | L2-Norm(final)=11.808 | 5328.0 samples/s | 83.2 steps/s
[Step=16150 Epoch=31.5] | Loss=0.08817 | Reg=0.00184 | acc=0.9375 | L2-Norm=13.566 | L2-Norm(final)=11.885 | 5539.9 samples/s | 86.6 steps/s
[Step=16200 Epoch=31.6] | Loss=0.08736 | Reg=0.00184 | acc=0.9219 | L2-Norm=13.566 | L2-Norm(final)=11.950 | 5642.5 samples/s | 88.2 steps/s
[Step=16250 Epoch=31.7] | Loss=0.08551 | Reg=0.00184 | acc=0.9375 | L2-Norm=13.566 | L2-Norm(final)=12.014 | 5462.0 samples/s | 85.3 steps/s
[Step=16300 Epoch=31.8] | Loss=0.08517 | Reg=0.00184 | acc=0.9219 | L2-Norm=13.566 | L2-Norm(final)=12.074 | 5557.2 samples/s | 86.8 steps/s
[Step=16350 Epoch=31.9] | Loss=0.08528 | Reg=0.00184 | acc=0.9375 | L2-Norm=13.566 | L2-Norm(final)=12.135 | 5494.5 samples/s | 85.9 steps/s
[Step=16400 Epoch=32.0] | Loss=0.08499 | Reg=0.00184 | acc=0.9375 | L2-Norm=13.566 | L2-Norm(final)=12.195 | 5784.6 samples/s | 90.4 steps/s
[Step=16450 Epoch=32.1] | Loss=0.08458 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.566 | L2-Norm(final)=12.253 | 5350.3 samples/s | 83.6 steps/s
[Step=16500 Epoch=32.2] | Loss=0.08387 | Reg=0.00184 | acc=0.9375 | L2-Norm=13.566 | L2-Norm(final)=12.311 | 6971.0 samples/s | 108.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=16501 Epoch=32.2] | Loss=0.10243 | Reg=0.00184 | acc=0.9219 | L2-Norm=13.567 | L2-Norm(final)=12.898 | 5144.2 samples/s | 80.4 steps/s
[Step=16550 Epoch=32.3] | Loss=0.05743 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.743 | L2-Norm(final)=12.910 | 3735.1 samples/s | 58.4 steps/s
[Step=16600 Epoch=32.4] | Loss=0.05752 | Reg=0.00193 | acc=0.9219 | L2-Norm=13.895 | L2-Norm(final)=12.889 | 4454.8 samples/s | 69.6 steps/s
[Step=16650 Epoch=32.5] | Loss=0.05475 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.005 | L2-Norm(final)=12.873 | 4739.3 samples/s | 74.1 steps/s
[Step=16700 Epoch=32.6] | Loss=0.05301 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.093 | L2-Norm(final)=12.861 | 4889.6 samples/s | 76.4 steps/s
[Step=16750 Epoch=32.7] | Loss=0.05180 | Reg=0.00201 | acc=0.9375 | L2-Norm=14.167 | L2-Norm(final)=12.851 | 4715.4 samples/s | 73.7 steps/s
[Step=16800 Epoch=32.8] | Loss=0.04929 | Reg=0.00203 | acc=0.9531 | L2-Norm=14.234 | L2-Norm(final)=12.842 | 4854.8 samples/s | 75.9 steps/s
[Step=16850 Epoch=32.9] | Loss=0.04830 | Reg=0.00204 | acc=0.9531 | L2-Norm=14.294 | L2-Norm(final)=12.833 | 4860.7 samples/s | 75.9 steps/s
[Step=16900 Epoch=33.0] | Loss=0.04800 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.352 | L2-Norm(final)=12.825 | 4743.1 samples/s | 74.1 steps/s
[Step=16950 Epoch=33.1] | Loss=0.04697 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.407 | L2-Norm(final)=12.817 | 4849.6 samples/s | 75.8 steps/s
[Step=17000 Epoch=33.2] | Loss=0.04623 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.457 | L2-Norm(final)=12.809 | 5874.6 samples/s | 91.8 steps/s
[Step=17050 Epoch=33.3] | Loss=0.04476 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.503 | L2-Norm(final)=12.802 | 2031.9 samples/s | 31.7 steps/s
[Step=17100 Epoch=33.4] | Loss=0.04327 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.545 | L2-Norm(final)=12.797 | 4774.2 samples/s | 74.6 steps/s
[Step=17150 Epoch=33.4] | Loss=0.04198 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.583 | L2-Norm(final)=12.791 | 4782.0 samples/s | 74.7 steps/s
[Step=17200 Epoch=33.5] | Loss=0.04121 | Reg=0.00214 | acc=0.9531 | L2-Norm=14.621 | L2-Norm(final)=12.786 | 4870.0 samples/s | 76.1 steps/s
[Step=17250 Epoch=33.6] | Loss=0.04022 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.657 | L2-Norm(final)=12.781 | 4736.0 samples/s | 74.0 steps/s
[Step=17300 Epoch=33.7] | Loss=0.03965 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.691 | L2-Norm(final)=12.775 | 4834.5 samples/s | 75.5 steps/s
[Step=17350 Epoch=33.8] | Loss=0.03909 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.724 | L2-Norm(final)=12.769 | 4853.6 samples/s | 75.8 steps/s
[Step=17400 Epoch=33.9] | Loss=0.03859 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.756 | L2-Norm(final)=12.763 | 4815.5 samples/s | 75.2 steps/s
[Step=17450 Epoch=34.0] | Loss=0.03836 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.787 | L2-Norm(final)=12.757 | 4692.5 samples/s | 73.3 steps/s
[Step=17500 Epoch=34.1] | Loss=0.03804 | Reg=0.00220 | acc=0.9531 | L2-Norm=14.817 | L2-Norm(final)=12.751 | 5139.3 samples/s | 80.3 steps/s
[Step=17550 Epoch=34.2] | Loss=0.03751 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.848 | L2-Norm(final)=12.746 | 2121.1 samples/s | 33.1 steps/s
[Step=17600 Epoch=34.3] | Loss=0.03680 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.877 | L2-Norm(final)=12.741 | 4898.2 samples/s | 76.5 steps/s
[Step=17650 Epoch=34.4] | Loss=0.03613 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.905 | L2-Norm(final)=12.736 | 4786.3 samples/s | 74.8 steps/s
[Step=17700 Epoch=34.5] | Loss=0.03546 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.932 | L2-Norm(final)=12.732 | 4785.1 samples/s | 74.8 steps/s
[Step=17750 Epoch=34.6] | Loss=0.03481 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.958 | L2-Norm(final)=12.729 | 4771.9 samples/s | 74.6 steps/s
[Step=17800 Epoch=34.7] | Loss=0.03450 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.983 | L2-Norm(final)=12.725 | 4794.3 samples/s | 74.9 steps/s
[Step=17850 Epoch=34.8] | Loss=0.03424 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.009 | L2-Norm(final)=12.721 | 4810.0 samples/s | 75.2 steps/s
[Step=17900 Epoch=34.9] | Loss=0.03397 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.035 | L2-Norm(final)=12.717 | 4828.3 samples/s | 75.4 steps/s
[Step=17950 Epoch=35.0] | Loss=0.03374 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.062 | L2-Norm(final)=12.713 | 4844.4 samples/s | 75.7 steps/s
[Step=18000 Epoch=35.1] | Loss=0.03348 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.089 | L2-Norm(final)=12.710 | 4796.1 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step18000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=16001 Epoch=31.3] | Loss=0.04837 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.554 | L2-Norm(final)=12.289 | 4244.3 samples/s | 66.3 steps/s
[Step=16050 Epoch=31.4] | Loss=0.12059 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.563 | L2-Norm(final)=12.217 | 5475.6 samples/s | 85.6 steps/s
[Step=16100 Epoch=31.5] | Loss=0.10539 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.565 | L2-Norm(final)=12.205 | 5478.6 samples/s | 85.6 steps/s
[Step=16150 Epoch=31.6] | Loss=0.10020 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.566 | L2-Norm(final)=12.242 | 5525.2 samples/s | 86.3 steps/s
[Step=16200 Epoch=31.7] | Loss=0.09890 | Reg=0.00184 | acc=0.9375 | L2-Norm=13.566 | L2-Norm(final)=12.291 | 5521.9 samples/s | 86.3 steps/s
[Step=16250 Epoch=31.8] | Loss=0.09689 | Reg=0.00184 | acc=0.9219 | L2-Norm=13.566 | L2-Norm(final)=12.344 | 5492.3 samples/s | 85.8 steps/s
[Step=16300 Epoch=31.9] | Loss=0.09588 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.566 | L2-Norm(final)=12.398 | 5536.2 samples/s | 86.5 steps/s
[Step=16350 Epoch=32.0] | Loss=0.09382 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.566 | L2-Norm(final)=12.452 | 5543.9 samples/s | 86.6 steps/s
[Step=16400 Epoch=32.1] | Loss=0.09384 | Reg=0.00184 | acc=0.9062 | L2-Norm=13.566 | L2-Norm(final)=12.506 | 5453.4 samples/s | 85.2 steps/s
[Step=16450 Epoch=32.2] | Loss=0.09382 | Reg=0.00184 | acc=0.9062 | L2-Norm=13.566 | L2-Norm(final)=12.557 | 5494.9 samples/s | 85.9 steps/s
[Step=16500 Epoch=32.3] | Loss=0.09295 | Reg=0.00184 | acc=0.9219 | L2-Norm=13.566 | L2-Norm(final)=12.607 | 7121.1 samples/s | 111.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=16501 Epoch=32.3] | Loss=0.12616 | Reg=0.00184 | acc=0.9219 | L2-Norm=13.567 | L2-Norm(final)=13.108 | 4388.2 samples/s | 68.6 steps/s
[Step=16550 Epoch=32.4] | Loss=0.06504 | Reg=0.00190 | acc=0.9375 | L2-Norm=13.793 | L2-Norm(final)=13.133 | 4701.2 samples/s | 73.5 steps/s
[Step=16600 Epoch=32.5] | Loss=0.05872 | Reg=0.00195 | acc=0.9531 | L2-Norm=13.951 | L2-Norm(final)=13.119 | 4734.4 samples/s | 74.0 steps/s
[Step=16650 Epoch=32.6] | Loss=0.05395 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.051 | L2-Norm(final)=13.110 | 4702.8 samples/s | 73.5 steps/s
[Step=16700 Epoch=32.6] | Loss=0.05119 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.135 | L2-Norm(final)=13.101 | 4796.9 samples/s | 75.0 steps/s
[Step=16750 Epoch=32.7] | Loss=0.04942 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.212 | L2-Norm(final)=13.090 | 4784.2 samples/s | 74.8 steps/s
[Step=16800 Epoch=32.8] | Loss=0.04840 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.281 | L2-Norm(final)=13.080 | 4816.0 samples/s | 75.2 steps/s
[Step=16850 Epoch=32.9] | Loss=0.04769 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.343 | L2-Norm(final)=13.071 | 4779.3 samples/s | 74.7 steps/s
[Step=16900 Epoch=33.0] | Loss=0.04664 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.399 | L2-Norm(final)=13.061 | 4793.9 samples/s | 74.9 steps/s
[Step=16950 Epoch=33.1] | Loss=0.04569 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.450 | L2-Norm(final)=13.052 | 4788.7 samples/s | 74.8 steps/s
[Step=17000 Epoch=33.2] | Loss=0.04502 | Reg=0.00210 | acc=0.9219 | L2-Norm=14.496 | L2-Norm(final)=13.044 | 5931.9 samples/s | 92.7 steps/s
[Step=17050 Epoch=33.3] | Loss=0.04307 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.539 | L2-Norm(final)=13.037 | 2106.7 samples/s | 32.9 steps/s
[Step=17100 Epoch=33.4] | Loss=0.04189 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.578 | L2-Norm(final)=13.031 | 4729.4 samples/s | 73.9 steps/s
[Step=17150 Epoch=33.5] | Loss=0.04038 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.614 | L2-Norm(final)=13.025 | 4796.3 samples/s | 74.9 steps/s
[Step=17200 Epoch=33.6] | Loss=0.03944 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.648 | L2-Norm(final)=13.020 | 4763.8 samples/s | 74.4 steps/s
[Step=17250 Epoch=33.7] | Loss=0.03839 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.680 | L2-Norm(final)=13.015 | 4782.0 samples/s | 74.7 steps/s
[Step=17300 Epoch=33.8] | Loss=0.03790 | Reg=0.00217 | acc=0.9531 | L2-Norm=14.711 | L2-Norm(final)=13.011 | 4843.4 samples/s | 75.7 steps/s
[Step=17350 Epoch=33.9] | Loss=0.03751 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.743 | L2-Norm(final)=13.006 | 4826.8 samples/s | 75.4 steps/s
[Step=17400 Epoch=34.0] | Loss=0.03727 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.775 | L2-Norm(final)=13.001 | 4738.5 samples/s | 74.0 steps/s
[Step=17450 Epoch=34.1] | Loss=0.03705 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.806 | L2-Norm(final)=12.995 | 4805.1 samples/s | 75.1 steps/s
[Step=17500 Epoch=34.2] | Loss=0.03669 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.835 | L2-Norm(final)=12.990 | 5135.3 samples/s | 80.2 steps/s
[Step=17550 Epoch=34.3] | Loss=0.03618 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.865 | L2-Norm(final)=12.984 | 2191.9 samples/s | 34.2 steps/s
[Step=17600 Epoch=34.4] | Loss=0.03545 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.893 | L2-Norm(final)=12.979 | 4789.4 samples/s | 74.8 steps/s
[Step=17650 Epoch=34.5] | Loss=0.03498 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.921 | L2-Norm(final)=12.973 | 4788.5 samples/s | 74.8 steps/s
[Step=17700 Epoch=34.6] | Loss=0.03449 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.947 | L2-Norm(final)=12.969 | 4763.7 samples/s | 74.4 steps/s
[Step=17750 Epoch=34.7] | Loss=0.03412 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.974 | L2-Norm(final)=12.964 | 4764.3 samples/s | 74.4 steps/s
[Step=17800 Epoch=34.8] | Loss=0.03355 | Reg=0.00225 | acc=0.9688 | L2-Norm=15.000 | L2-Norm(final)=12.960 | 4823.6 samples/s | 75.4 steps/s
[Step=17850 Epoch=34.9] | Loss=0.03317 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.026 | L2-Norm(final)=12.955 | 4808.3 samples/s | 75.1 steps/s
[Step=17900 Epoch=35.0] | Loss=0.03278 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.051 | L2-Norm(final)=12.951 | 4817.0 samples/s | 75.3 steps/s
[Step=17950 Epoch=35.1] | Loss=0.03251 | Reg=0.00228 | acc=0.9688 | L2-Norm=15.076 | L2-Norm(final)=12.948 | 4850.9 samples/s | 75.8 steps/s
[Step=18000 Epoch=35.2] | Loss=0.03211 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.100 | L2-Norm(final)=12.944 | 4760.4 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step18000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=16001 Epoch=61.3] | Loss=0.02592 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.554 | L2-Norm(final)=12.897 | 4360.6 samples/s | 68.1 steps/s
[Step=16050 Epoch=61.5] | Loss=0.00343 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.548 | L2-Norm(final)=12.930 | 5092.3 samples/s | 79.6 steps/s
[Step=16100 Epoch=61.7] | Loss=0.00430 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=12.971 | 5236.6 samples/s | 81.8 steps/s
[Step=16150 Epoch=61.9] | Loss=0.00494 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=13.005 | 5137.4 samples/s | 80.3 steps/s
[Step=16200 Epoch=62.1] | Loss=0.00469 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=13.039 | 5156.5 samples/s | 80.6 steps/s
[Step=16250 Epoch=62.3] | Loss=0.00485 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=13.073 | 6837.5 samples/s | 106.8 steps/s
[Step=16300 Epoch=62.5] | Loss=0.00492 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=13.105 | 2172.2 samples/s | 33.9 steps/s
[Step=16350 Epoch=62.6] | Loss=0.00482 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=13.134 | 5107.3 samples/s | 79.8 steps/s
[Step=16400 Epoch=62.8] | Loss=0.00469 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=13.165 | 5234.3 samples/s | 81.8 steps/s
[Step=16450 Epoch=63.0] | Loss=0.00469 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=13.195 | 5241.8 samples/s | 81.9 steps/s
[Step=16500 Epoch=63.2] | Loss=0.00471 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=13.226 | 5868.1 samples/s | 91.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=16501 Epoch=63.2] | Loss=0.00064 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=13.533 | 4687.1 samples/s | 73.2 steps/s
[Step=16550 Epoch=63.4] | Loss=0.00600 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.648 | L2-Norm(final)=13.539 | 4269.5 samples/s | 66.7 steps/s
[Step=16600 Epoch=63.6] | Loss=0.00718 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=13.508 | 4474.3 samples/s | 69.9 steps/s
[Step=16650 Epoch=63.8] | Loss=0.00655 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.959 | L2-Norm(final)=13.485 | 4629.9 samples/s | 72.3 steps/s
[Step=16700 Epoch=64.0] | Loss=0.00535 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.022 | L2-Norm(final)=13.474 | 4496.1 samples/s | 70.3 steps/s
[Step=16750 Epoch=64.2] | Loss=0.00544 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.070 | L2-Norm(final)=13.469 | 5714.3 samples/s | 89.3 steps/s
[Step=16800 Epoch=64.4] | Loss=0.00648 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.131 | L2-Norm(final)=13.453 | 2046.4 samples/s | 32.0 steps/s
[Step=16850 Epoch=64.6] | Loss=0.00577 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.184 | L2-Norm(final)=13.438 | 4613.3 samples/s | 72.1 steps/s
[Step=16900 Epoch=64.8] | Loss=0.00513 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.221 | L2-Norm(final)=13.428 | 4449.2 samples/s | 69.5 steps/s
[Step=16950 Epoch=64.9] | Loss=0.00459 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.245 | L2-Norm(final)=13.421 | 4549.5 samples/s | 71.1 steps/s
[Step=17000 Epoch=65.1] | Loss=0.00414 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.260 | L2-Norm(final)=13.416 | 5045.4 samples/s | 78.8 steps/s
[Step=17050 Epoch=65.3] | Loss=0.00376 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.268 | L2-Norm(final)=13.412 | 2072.9 samples/s | 32.4 steps/s
[Step=17100 Epoch=65.5] | Loss=0.00345 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.270 | L2-Norm(final)=13.409 | 4522.5 samples/s | 70.7 steps/s
[Step=17150 Epoch=65.7] | Loss=0.00319 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.269 | L2-Norm(final)=13.406 | 4585.9 samples/s | 71.7 steps/s
[Step=17200 Epoch=65.9] | Loss=0.00296 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.264 | L2-Norm(final)=13.404 | 4639.1 samples/s | 72.5 steps/s
[Step=17250 Epoch=66.1] | Loss=0.00277 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.257 | L2-Norm(final)=13.403 | 4515.2 samples/s | 70.5 steps/s
[Step=17300 Epoch=66.3] | Loss=0.00259 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.248 | L2-Norm(final)=13.401 | 2170.5 samples/s | 33.9 steps/s
[Step=17350 Epoch=66.5] | Loss=0.00244 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.237 | L2-Norm(final)=13.400 | 4607.1 samples/s | 72.0 steps/s
[Step=17400 Epoch=66.7] | Loss=0.00231 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.226 | L2-Norm(final)=13.399 | 4526.9 samples/s | 70.7 steps/s
[Step=17450 Epoch=66.9] | Loss=0.00219 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.213 | L2-Norm(final)=13.399 | 4547.7 samples/s | 71.1 steps/s
[Step=17500 Epoch=67.1] | Loss=0.00208 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.199 | L2-Norm(final)=13.398 | 4528.3 samples/s | 70.8 steps/s
[Step=17550 Epoch=67.2] | Loss=0.00198 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.185 | L2-Norm(final)=13.397 | 2176.1 samples/s | 34.0 steps/s
[Step=17600 Epoch=67.4] | Loss=0.00189 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.170 | L2-Norm(final)=13.397 | 4514.9 samples/s | 70.5 steps/s
[Step=17650 Epoch=67.6] | Loss=0.00181 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.155 | L2-Norm(final)=13.397 | 4570.6 samples/s | 71.4 steps/s
[Step=17700 Epoch=67.8] | Loss=0.00173 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.139 | L2-Norm(final)=13.396 | 4561.5 samples/s | 71.3 steps/s
[Step=17750 Epoch=68.0] | Loss=0.00166 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=13.396 | 4529.7 samples/s | 70.8 steps/s
[Step=17800 Epoch=68.2] | Loss=0.00160 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.106 | L2-Norm(final)=13.396 | 6238.7 samples/s | 97.5 steps/s
[Step=17850 Epoch=68.4] | Loss=0.00154 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=13.396 | 1947.0 samples/s | 30.4 steps/s
[Step=17900 Epoch=68.6] | Loss=0.00148 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.072 | L2-Norm(final)=13.396 | 4558.0 samples/s | 71.2 steps/s
[Step=17950 Epoch=68.8] | Loss=0.00143 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.055 | L2-Norm(final)=13.396 | 4543.2 samples/s | 71.0 steps/s
[Step=18000 Epoch=69.0] | Loss=0.00139 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.038 | L2-Norm(final)=13.396 | 4528.3 samples/s | 70.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step18000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=16001 Epoch=61.6] | Loss=0.00194 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.554 | L2-Norm(final)=13.701 | 4422.7 samples/s | 69.1 steps/s
[Step=16050 Epoch=61.8] | Loss=0.00685 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=13.750 | 4711.4 samples/s | 73.6 steps/s
[Step=16100 Epoch=62.0] | Loss=0.00643 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=13.813 | 5222.9 samples/s | 81.6 steps/s
[Step=16150 Epoch=62.2] | Loss=0.00579 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=13.874 | 5222.1 samples/s | 81.6 steps/s
[Step=16200 Epoch=62.4] | Loss=0.00569 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=13.935 | 5313.2 samples/s | 83.0 steps/s
[Step=16250 Epoch=62.6] | Loss=0.00566 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=13.994 | 6728.5 samples/s | 105.1 steps/s
[Step=16300 Epoch=62.7] | Loss=0.00546 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=14.047 | 2143.1 samples/s | 33.5 steps/s
[Step=16350 Epoch=62.9] | Loss=0.00539 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=14.100 | 5397.7 samples/s | 84.3 steps/s
[Step=16400 Epoch=63.1] | Loss=0.00552 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.546 | L2-Norm(final)=14.151 | 4876.9 samples/s | 76.2 steps/s
[Step=16450 Epoch=63.3] | Loss=0.00541 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=14.200 | 5229.7 samples/s | 81.7 steps/s
[Step=16500 Epoch=63.5] | Loss=0.00547 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=14.248 | 5971.9 samples/s | 93.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=16501 Epoch=63.5] | Loss=0.00043 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=14.720 | 4451.5 samples/s | 69.6 steps/s
[Step=16550 Epoch=63.7] | Loss=0.01188 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.713 | L2-Norm(final)=14.725 | 4502.9 samples/s | 70.4 steps/s
[Step=16600 Epoch=63.9] | Loss=0.01414 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.997 | L2-Norm(final)=14.680 | 4512.0 samples/s | 70.5 steps/s
[Step=16650 Epoch=64.1] | Loss=0.01268 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.188 | L2-Norm(final)=14.641 | 4588.2 samples/s | 71.7 steps/s
[Step=16700 Epoch=64.3] | Loss=0.01135 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.322 | L2-Norm(final)=14.611 | 4615.8 samples/s | 72.1 steps/s
[Step=16750 Epoch=64.5] | Loss=0.00952 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.410 | L2-Norm(final)=14.594 | 5673.4 samples/s | 88.6 steps/s
[Step=16800 Epoch=64.7] | Loss=0.00901 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.472 | L2-Norm(final)=14.582 | 1989.9 samples/s | 31.1 steps/s
[Step=16850 Epoch=64.9] | Loss=0.00815 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.526 | L2-Norm(final)=14.569 | 4557.9 samples/s | 71.2 steps/s
[Step=16900 Epoch=65.1] | Loss=0.00725 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.565 | L2-Norm(final)=14.560 | 4591.5 samples/s | 71.7 steps/s
[Step=16950 Epoch=65.2] | Loss=0.00649 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.590 | L2-Norm(final)=14.554 | 4581.2 samples/s | 71.6 steps/s
[Step=17000 Epoch=65.4] | Loss=0.00605 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.607 | L2-Norm(final)=14.549 | 5172.0 samples/s | 80.8 steps/s
[Step=17050 Epoch=65.6] | Loss=0.00555 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.618 | L2-Norm(final)=14.544 | 2088.2 samples/s | 32.6 steps/s
[Step=17100 Epoch=65.8] | Loss=0.00510 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.626 | L2-Norm(final)=14.541 | 4538.6 samples/s | 70.9 steps/s
[Step=17150 Epoch=66.0] | Loss=0.00475 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.630 | L2-Norm(final)=14.539 | 4562.6 samples/s | 71.3 steps/s
[Step=17200 Epoch=66.2] | Loss=0.00450 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.632 | L2-Norm(final)=14.536 | 4539.8 samples/s | 70.9 steps/s
[Step=17250 Epoch=66.4] | Loss=0.00420 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.633 | L2-Norm(final)=14.535 | 4677.1 samples/s | 73.1 steps/s
[Step=17300 Epoch=66.6] | Loss=0.00395 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.631 | L2-Norm(final)=14.533 | 2199.7 samples/s | 34.4 steps/s
[Step=17350 Epoch=66.8] | Loss=0.00371 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.626 | L2-Norm(final)=14.532 | 4518.3 samples/s | 70.6 steps/s
[Step=17400 Epoch=67.0] | Loss=0.00351 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.619 | L2-Norm(final)=14.531 | 4580.7 samples/s | 71.6 steps/s
[Step=17450 Epoch=67.2] | Loss=0.00332 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.611 | L2-Norm(final)=14.530 | 4557.7 samples/s | 71.2 steps/s
[Step=17500 Epoch=67.4] | Loss=0.00316 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.602 | L2-Norm(final)=14.529 | 4508.1 samples/s | 70.4 steps/s
[Step=17550 Epoch=67.6] | Loss=0.00301 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.591 | L2-Norm(final)=14.529 | 2182.9 samples/s | 34.1 steps/s
[Step=17600 Epoch=67.7] | Loss=0.00287 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.580 | L2-Norm(final)=14.528 | 4424.6 samples/s | 69.1 steps/s
[Step=17650 Epoch=67.9] | Loss=0.00275 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.568 | L2-Norm(final)=14.528 | 4465.0 samples/s | 69.8 steps/s
[Step=17700 Epoch=68.1] | Loss=0.00263 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.555 | L2-Norm(final)=14.527 | 4550.7 samples/s | 71.1 steps/s
[Step=17750 Epoch=68.3] | Loss=0.00253 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.542 | L2-Norm(final)=14.527 | 4565.4 samples/s | 71.3 steps/s
[Step=17800 Epoch=68.5] | Loss=0.00243 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.528 | L2-Norm(final)=14.527 | 6721.1 samples/s | 105.0 steps/s
[Step=17850 Epoch=68.7] | Loss=0.00234 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.513 | L2-Norm(final)=14.527 | 1912.5 samples/s | 29.9 steps/s
[Step=17900 Epoch=68.9] | Loss=0.00226 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.499 | L2-Norm(final)=14.526 | 4595.6 samples/s | 71.8 steps/s
[Step=17950 Epoch=69.1] | Loss=0.00218 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.484 | L2-Norm(final)=14.526 | 4586.5 samples/s | 71.7 steps/s
[Step=18000 Epoch=69.3] | Loss=0.00211 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.468 | L2-Norm(final)=14.526 | 4534.2 samples/s | 70.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step18000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07985 | acc=0.9552 | tpr=0.9612 | fpr=0.0577 | 4129.0 samples/s | 16.1 steps/s
Avg test loss: 0.08202, Avg test acc: 0.95432, Avg tpr: 0.95903, Avg fpr: 0.05602, total FA: 437

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07835 | acc=0.9601 | tpr=0.9683 | fpr=0.0577 | 4182.5 samples/s | 16.3 steps/s
Avg test loss: 0.07629, Avg test acc: 0.95981, Avg tpr: 0.96841, Avg fpr: 0.05909, total FA: 461

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.75491 | acc=0.3165 | tpr=0.0094 | fpr=0.0166 | 4208.6 samples/s | 16.4 steps/s
Avg test loss: 5.76600, Avg test acc: 0.31417, Avg tpr: 0.00991, Avg fpr: 0.01666, total FA: 130

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=8.16684 | acc=0.3016 | tpr=0.0059 | fpr=0.0562 | 4194.8 samples/s | 16.4 steps/s
Avg test loss: 8.17491, Avg test acc: 0.29906, Avg tpr: 0.00624, Avg fpr: 0.05692, total FA: 444

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.15463 | acc=0.1264 | tpr=0.5841 | fpr=0.8818 | 4259.7 samples/s | 16.6 steps/s
[Step= 100] | Loss=5.10580 | acc=0.1246 | tpr=0.5736 | fpr=0.8838 | 7558.8 samples/s | 29.5 steps/s
[Step= 150] | Loss=5.11923 | acc=0.1231 | tpr=0.5605 | fpr=0.8849 | 8172.1 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.11178 | acc=0.1225 | tpr=0.5541 | fpr=0.8853 | 7700.3 samples/s | 30.1 steps/s
[Step= 250] | Loss=5.10336 | acc=0.1221 | tpr=0.5424 | fpr=0.8856 | 7781.7 samples/s | 30.4 steps/s
[Step= 300] | Loss=5.10612 | acc=0.1224 | tpr=0.5404 | fpr=0.8853 | 7832.5 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.10917 | acc=0.1217 | tpr=0.5366 | fpr=0.8859 | 7914.3 samples/s | 30.9 steps/s
[Step= 400] | Loss=5.10248 | acc=0.1213 | tpr=0.5295 | fpr=0.8861 | 7910.9 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.10395 | acc=0.1207 | tpr=0.5278 | fpr=0.8867 | 7746.5 samples/s | 30.3 steps/s
[Step= 500] | Loss=5.10144 | acc=0.1209 | tpr=0.5269 | fpr=0.8864 | 7801.9 samples/s | 30.5 steps/s
[Step= 550] | Loss=5.10396 | acc=0.1212 | tpr=0.5288 | fpr=0.8863 | 15017.7 samples/s | 58.7 steps/s
Avg test loss: 5.10581, Avg test acc: 0.12106, Avg tpr: 0.52932, Avg fpr: 0.88636, total FA: 123069

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.47029 | acc=0.1280 | tpr=0.5531 | fpr=0.8796 | 4144.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=6.42449 | acc=0.1296 | tpr=0.5757 | fpr=0.8787 | 7762.3 samples/s | 30.3 steps/s
[Step= 150] | Loss=6.44584 | acc=0.1288 | tpr=0.5821 | fpr=0.8795 | 7962.4 samples/s | 31.1 steps/s
[Step= 200] | Loss=6.43854 | acc=0.1281 | tpr=0.5770 | fpr=0.8800 | 7890.3 samples/s | 30.8 steps/s
[Step= 250] | Loss=6.43909 | acc=0.1281 | tpr=0.5721 | fpr=0.8800 | 7991.5 samples/s | 31.2 steps/s
[Step= 300] | Loss=6.43988 | acc=0.1284 | tpr=0.5702 | fpr=0.8797 | 7833.8 samples/s | 30.6 steps/s
[Step= 350] | Loss=6.44419 | acc=0.1277 | tpr=0.5604 | fpr=0.8801 | 7922.5 samples/s | 30.9 steps/s
[Step= 400] | Loss=6.43188 | acc=0.1276 | tpr=0.5531 | fpr=0.8801 | 7944.7 samples/s | 31.0 steps/s
[Step= 450] | Loss=6.43263 | acc=0.1277 | tpr=0.5516 | fpr=0.8800 | 7791.6 samples/s | 30.4 steps/s
[Step= 500] | Loss=6.43078 | acc=0.1277 | tpr=0.5599 | fpr=0.8801 | 7995.0 samples/s | 31.2 steps/s
[Step= 550] | Loss=6.43380 | acc=0.1278 | tpr=0.5571 | fpr=0.8800 | 13416.0 samples/s | 52.4 steps/s
Avg test loss: 6.43543, Avg test acc: 0.12774, Avg tpr: 0.55705, Avg fpr: 0.88006, total FA: 122195

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10712 | acc=0.9815 | tpr=0.9425 | fpr=0.0178 | 4122.2 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.11709 | acc=0.9807 | tpr=0.9510 | fpr=0.0188 | 8085.0 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.11819 | acc=0.9803 | tpr=0.9553 | fpr=0.0193 | 7757.5 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.11986 | acc=0.9803 | tpr=0.9585 | fpr=0.0193 | 7642.2 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.12098 | acc=0.9800 | tpr=0.9528 | fpr=0.0195 | 7937.9 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.12190 | acc=0.9798 | tpr=0.9491 | fpr=0.0196 | 7760.9 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.12318 | acc=0.9796 | tpr=0.9474 | fpr=0.0199 | 7974.2 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.12424 | acc=0.9794 | tpr=0.9447 | fpr=0.0200 | 7247.3 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.12594 | acc=0.9792 | tpr=0.9440 | fpr=0.0201 | 7338.1 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.12576 | acc=0.9793 | tpr=0.9458 | fpr=0.0201 | 7271.1 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.12550 | acc=0.9793 | tpr=0.9431 | fpr=0.0200 | 14828.0 samples/s | 57.9 steps/s
Avg test loss: 0.12518, Avg test acc: 0.97935, Avg tpr: 0.94295, Avg fpr: 0.01999, total FA: 2775

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11078 | acc=0.9802 | tpr=0.9292 | fpr=0.0188 | 4133.7 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.11763 | acc=0.9798 | tpr=0.9510 | fpr=0.0196 | 7764.4 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.11968 | acc=0.9793 | tpr=0.9568 | fpr=0.0203 | 7825.1 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.12082 | acc=0.9795 | tpr=0.9639 | fpr=0.0202 | 7865.4 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.12098 | acc=0.9795 | tpr=0.9616 | fpr=0.0202 | 7884.7 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.12233 | acc=0.9794 | tpr=0.9600 | fpr=0.0203 | 7947.0 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.12325 | acc=0.9792 | tpr=0.9606 | fpr=0.0204 | 7725.8 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.12535 | acc=0.9789 | tpr=0.9557 | fpr=0.0207 | 7894.8 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.12736 | acc=0.9786 | tpr=0.9547 | fpr=0.0209 | 7548.2 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.12640 | acc=0.9788 | tpr=0.9551 | fpr=0.0208 | 7893.7 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.12597 | acc=0.9789 | tpr=0.9538 | fpr=0.0206 | 14724.9 samples/s | 57.5 steps/s
Avg test loss: 0.12562, Avg test acc: 0.97894, Avg tpr: 0.95365, Avg fpr: 0.02060, total FA: 2860

server round 9/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=18001 Epoch=35.1] | Loss=0.14634 | Reg=0.00188 | acc=0.8906 | L2-Norm=13.704 | L2-Norm(final)=12.595 | 4436.9 samples/s | 69.3 steps/s
[Step=18050 Epoch=35.2] | Loss=0.08261 | Reg=0.00188 | acc=0.9375 | L2-Norm=13.713 | L2-Norm(final)=12.615 | 5150.1 samples/s | 80.5 steps/s
[Step=18100 Epoch=35.3] | Loss=0.07933 | Reg=0.00188 | acc=0.9219 | L2-Norm=13.714 | L2-Norm(final)=12.652 | 5578.3 samples/s | 87.2 steps/s
[Step=18150 Epoch=35.4] | Loss=0.07856 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=12.692 | 5627.0 samples/s | 87.9 steps/s
[Step=18200 Epoch=35.5] | Loss=0.07818 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.715 | L2-Norm(final)=12.730 | 5453.4 samples/s | 85.2 steps/s
[Step=18250 Epoch=35.6] | Loss=0.07763 | Reg=0.00188 | acc=0.8906 | L2-Norm=13.715 | L2-Norm(final)=12.769 | 5563.7 samples/s | 86.9 steps/s
[Step=18300 Epoch=35.7] | Loss=0.07794 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.715 | L2-Norm(final)=12.808 | 5603.1 samples/s | 87.5 steps/s
[Step=18350 Epoch=35.8] | Loss=0.07742 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.715 | L2-Norm(final)=12.846 | 5626.2 samples/s | 87.9 steps/s
[Step=18400 Epoch=35.9] | Loss=0.07673 | Reg=0.00188 | acc=0.9375 | L2-Norm=13.715 | L2-Norm(final)=12.885 | 5392.1 samples/s | 84.3 steps/s
[Step=18450 Epoch=36.0] | Loss=0.07654 | Reg=0.00188 | acc=0.8906 | L2-Norm=13.715 | L2-Norm(final)=12.921 | 5603.6 samples/s | 87.6 steps/s
[Step=18500 Epoch=36.1] | Loss=0.07645 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.715 | L2-Norm(final)=12.957 | 6898.8 samples/s | 107.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=18501 Epoch=36.1] | Loss=0.13937 | Reg=0.00188 | acc=0.8906 | L2-Norm=13.715 | L2-Norm(final)=13.315 | 4426.8 samples/s | 69.2 steps/s
[Step=18550 Epoch=36.2] | Loss=0.06126 | Reg=0.00193 | acc=0.9219 | L2-Norm=13.890 | L2-Norm(final)=13.316 | 4569.0 samples/s | 71.4 steps/s
[Step=18600 Epoch=36.3] | Loss=0.05492 | Reg=0.00197 | acc=0.9219 | L2-Norm=14.041 | L2-Norm(final)=13.301 | 4832.5 samples/s | 75.5 steps/s
[Step=18650 Epoch=36.4] | Loss=0.05271 | Reg=0.00200 | acc=0.9062 | L2-Norm=14.140 | L2-Norm(final)=13.290 | 4755.3 samples/s | 74.3 steps/s
[Step=18700 Epoch=36.5] | Loss=0.05145 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.220 | L2-Norm(final)=13.279 | 4823.6 samples/s | 75.4 steps/s
[Step=18750 Epoch=36.6] | Loss=0.04966 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.293 | L2-Norm(final)=13.269 | 4788.3 samples/s | 74.8 steps/s
[Step=18800 Epoch=36.7] | Loss=0.04801 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.359 | L2-Norm(final)=13.260 | 4802.5 samples/s | 75.0 steps/s
[Step=18850 Epoch=36.8] | Loss=0.04712 | Reg=0.00208 | acc=0.9531 | L2-Norm=14.419 | L2-Norm(final)=13.252 | 4794.8 samples/s | 74.9 steps/s
[Step=18900 Epoch=36.9] | Loss=0.04607 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.474 | L2-Norm(final)=13.245 | 4775.9 samples/s | 74.6 steps/s
[Step=18950 Epoch=37.0] | Loss=0.04569 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.525 | L2-Norm(final)=13.238 | 4836.1 samples/s | 75.6 steps/s
[Step=19000 Epoch=37.1] | Loss=0.04453 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.572 | L2-Norm(final)=13.232 | 5835.4 samples/s | 91.2 steps/s
[Step=19050 Epoch=37.2] | Loss=0.04339 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.616 | L2-Norm(final)=13.226 | 2040.0 samples/s | 31.9 steps/s
[Step=19100 Epoch=37.3] | Loss=0.04202 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.657 | L2-Norm(final)=13.221 | 4749.3 samples/s | 74.2 steps/s
[Step=19150 Epoch=37.3] | Loss=0.04083 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.696 | L2-Norm(final)=13.215 | 4802.1 samples/s | 75.0 steps/s
[Step=19200 Epoch=37.4] | Loss=0.04003 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.734 | L2-Norm(final)=13.209 | 4739.5 samples/s | 74.1 steps/s
[Step=19250 Epoch=37.5] | Loss=0.03936 | Reg=0.00218 | acc=0.9531 | L2-Norm=14.770 | L2-Norm(final)=13.203 | 4783.9 samples/s | 74.7 steps/s
[Step=19300 Epoch=37.6] | Loss=0.03855 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.804 | L2-Norm(final)=13.197 | 4863.2 samples/s | 76.0 steps/s
[Step=19350 Epoch=37.7] | Loss=0.03811 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.837 | L2-Norm(final)=13.192 | 4722.8 samples/s | 73.8 steps/s
[Step=19400 Epoch=37.8] | Loss=0.03757 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.869 | L2-Norm(final)=13.186 | 4830.4 samples/s | 75.5 steps/s
[Step=19450 Epoch=37.9] | Loss=0.03727 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.900 | L2-Norm(final)=13.180 | 4782.5 samples/s | 74.7 steps/s
[Step=19500 Epoch=38.0] | Loss=0.03661 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.930 | L2-Norm(final)=13.174 | 5082.7 samples/s | 79.4 steps/s
[Step=19550 Epoch=38.1] | Loss=0.03627 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.960 | L2-Norm(final)=13.170 | 2136.3 samples/s | 33.4 steps/s
[Step=19600 Epoch=38.2] | Loss=0.03548 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.990 | L2-Norm(final)=13.165 | 4742.7 samples/s | 74.1 steps/s
[Step=19650 Epoch=38.3] | Loss=0.03488 | Reg=0.00226 | acc=0.9375 | L2-Norm=15.019 | L2-Norm(final)=13.161 | 4759.2 samples/s | 74.4 steps/s
[Step=19700 Epoch=38.4] | Loss=0.03474 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.047 | L2-Norm(final)=13.156 | 4767.9 samples/s | 74.5 steps/s
[Step=19750 Epoch=38.5] | Loss=0.03411 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.075 | L2-Norm(final)=13.151 | 4827.6 samples/s | 75.4 steps/s
[Step=19800 Epoch=38.6] | Loss=0.03369 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.102 | L2-Norm(final)=13.147 | 4756.5 samples/s | 74.3 steps/s
[Step=19850 Epoch=38.7] | Loss=0.03341 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.129 | L2-Norm(final)=13.143 | 4833.5 samples/s | 75.5 steps/s
[Step=19900 Epoch=38.8] | Loss=0.03311 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.156 | L2-Norm(final)=13.139 | 4749.9 samples/s | 74.2 steps/s
[Step=19950 Epoch=38.9] | Loss=0.03272 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.182 | L2-Norm(final)=13.135 | 4748.9 samples/s | 74.2 steps/s
[Step=20000 Epoch=39.0] | Loss=0.03239 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.208 | L2-Norm(final)=13.132 | 4795.5 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step20000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=18001 Epoch=35.2] | Loss=0.05350 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.704 | L2-Norm(final)=12.830 | 4547.9 samples/s | 71.1 steps/s
[Step=18050 Epoch=35.3] | Loss=0.08287 | Reg=0.00188 | acc=0.9062 | L2-Norm=13.714 | L2-Norm(final)=12.898 | 5163.4 samples/s | 80.7 steps/s
[Step=18100 Epoch=35.4] | Loss=0.08104 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.716 | L2-Norm(final)=12.974 | 5539.5 samples/s | 86.6 steps/s
[Step=18150 Epoch=35.5] | Loss=0.07873 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.716 | L2-Norm(final)=13.037 | 5479.1 samples/s | 85.6 steps/s
[Step=18200 Epoch=35.6] | Loss=0.07739 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.717 | L2-Norm(final)=13.094 | 5458.3 samples/s | 85.3 steps/s
[Step=18250 Epoch=35.7] | Loss=0.07651 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.717 | L2-Norm(final)=13.151 | 5567.6 samples/s | 87.0 steps/s
[Step=18300 Epoch=35.8] | Loss=0.07648 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.717 | L2-Norm(final)=13.206 | 5545.2 samples/s | 86.6 steps/s
[Step=18350 Epoch=35.9] | Loss=0.07537 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.717 | L2-Norm(final)=13.262 | 5608.7 samples/s | 87.6 steps/s
[Step=18400 Epoch=36.0] | Loss=0.07575 | Reg=0.00188 | acc=0.9062 | L2-Norm=13.717 | L2-Norm(final)=13.316 | 5502.5 samples/s | 86.0 steps/s
[Step=18450 Epoch=36.1] | Loss=0.07570 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.717 | L2-Norm(final)=13.369 | 5517.4 samples/s | 86.2 steps/s
[Step=18500 Epoch=36.2] | Loss=0.07531 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.717 | L2-Norm(final)=13.421 | 7104.6 samples/s | 111.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=18501 Epoch=36.2] | Loss=0.03487 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.718 | L2-Norm(final)=13.934 | 4940.6 samples/s | 77.2 steps/s
[Step=18550 Epoch=36.3] | Loss=0.05545 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.895 | L2-Norm(final)=13.945 | 4327.0 samples/s | 67.6 steps/s
[Step=18600 Epoch=36.4] | Loss=0.05141 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.048 | L2-Norm(final)=13.933 | 4773.5 samples/s | 74.6 steps/s
[Step=18650 Epoch=36.5] | Loss=0.04968 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.163 | L2-Norm(final)=13.921 | 4804.4 samples/s | 75.1 steps/s
[Step=18700 Epoch=36.6] | Loss=0.04845 | Reg=0.00203 | acc=0.9531 | L2-Norm=14.252 | L2-Norm(final)=13.912 | 4675.1 samples/s | 73.0 steps/s
[Step=18750 Epoch=36.7] | Loss=0.04776 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.329 | L2-Norm(final)=13.903 | 4769.6 samples/s | 74.5 steps/s
[Step=18800 Epoch=36.8] | Loss=0.04660 | Reg=0.00208 | acc=0.9531 | L2-Norm=14.403 | L2-Norm(final)=13.895 | 4848.4 samples/s | 75.8 steps/s
[Step=18850 Epoch=36.9] | Loss=0.04654 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.469 | L2-Norm(final)=13.886 | 4799.6 samples/s | 75.0 steps/s
[Step=18900 Epoch=36.9] | Loss=0.04532 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.528 | L2-Norm(final)=13.878 | 4717.9 samples/s | 73.7 steps/s
[Step=18950 Epoch=37.0] | Loss=0.04415 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.583 | L2-Norm(final)=13.871 | 4762.1 samples/s | 74.4 steps/s
[Step=19000 Epoch=37.1] | Loss=0.04404 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.634 | L2-Norm(final)=13.864 | 5862.5 samples/s | 91.6 steps/s
[Step=19050 Epoch=37.2] | Loss=0.04297 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.684 | L2-Norm(final)=13.857 | 2093.6 samples/s | 32.7 steps/s
[Step=19100 Epoch=37.3] | Loss=0.04083 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.730 | L2-Norm(final)=13.852 | 4758.0 samples/s | 74.3 steps/s
[Step=19150 Epoch=37.4] | Loss=0.03992 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.773 | L2-Norm(final)=13.848 | 4736.2 samples/s | 74.0 steps/s
[Step=19200 Epoch=37.5] | Loss=0.03887 | Reg=0.00220 | acc=0.9219 | L2-Norm=14.811 | L2-Norm(final)=13.844 | 4760.6 samples/s | 74.4 steps/s
[Step=19250 Epoch=37.6] | Loss=0.03790 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.848 | L2-Norm(final)=13.839 | 4775.3 samples/s | 74.6 steps/s
[Step=19300 Epoch=37.7] | Loss=0.03732 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.882 | L2-Norm(final)=13.835 | 4757.0 samples/s | 74.3 steps/s
[Step=19350 Epoch=37.8] | Loss=0.03676 | Reg=0.00223 | acc=0.9375 | L2-Norm=14.914 | L2-Norm(final)=13.830 | 4827.1 samples/s | 75.4 steps/s
[Step=19400 Epoch=37.9] | Loss=0.03642 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.944 | L2-Norm(final)=13.826 | 4800.3 samples/s | 75.0 steps/s
[Step=19450 Epoch=38.0] | Loss=0.03604 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.974 | L2-Norm(final)=13.821 | 4813.5 samples/s | 75.2 steps/s
[Step=19500 Epoch=38.1] | Loss=0.03581 | Reg=0.00225 | acc=0.9844 | L2-Norm=15.002 | L2-Norm(final)=13.816 | 5123.2 samples/s | 80.0 steps/s
[Step=19550 Epoch=38.2] | Loss=0.03528 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.030 | L2-Norm(final)=13.811 | 2200.3 samples/s | 34.4 steps/s
[Step=19600 Epoch=38.3] | Loss=0.03439 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.057 | L2-Norm(final)=13.807 | 4880.7 samples/s | 76.3 steps/s
[Step=19650 Epoch=38.4] | Loss=0.03373 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.083 | L2-Norm(final)=13.803 | 4751.4 samples/s | 74.2 steps/s
[Step=19700 Epoch=38.5] | Loss=0.03328 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.108 | L2-Norm(final)=13.799 | 4774.4 samples/s | 74.6 steps/s
[Step=19750 Epoch=38.6] | Loss=0.03285 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.133 | L2-Norm(final)=13.796 | 4757.6 samples/s | 74.3 steps/s
[Step=19800 Epoch=38.7] | Loss=0.03248 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.157 | L2-Norm(final)=13.792 | 4767.9 samples/s | 74.5 steps/s
[Step=19850 Epoch=38.8] | Loss=0.03196 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.181 | L2-Norm(final)=13.789 | 4743.0 samples/s | 74.1 steps/s
[Step=19900 Epoch=38.9] | Loss=0.03187 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.205 | L2-Norm(final)=13.785 | 4785.7 samples/s | 74.8 steps/s
[Step=19950 Epoch=39.0] | Loss=0.03182 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.229 | L2-Norm(final)=13.781 | 4787.6 samples/s | 74.8 steps/s
[Step=20000 Epoch=39.1] | Loss=0.03150 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.253 | L2-Norm(final)=13.777 | 4797.1 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step20000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=18001 Epoch=69.0] | Loss=0.00074 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=13.405 | 4917.3 samples/s | 76.8 steps/s
[Step=18050 Epoch=69.2] | Loss=0.00349 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.699 | L2-Norm(final)=13.432 | 4288.3 samples/s | 67.0 steps/s
[Step=18100 Epoch=69.4] | Loss=0.00337 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=13.460 | 5268.1 samples/s | 82.3 steps/s
[Step=18150 Epoch=69.5] | Loss=0.00352 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.698 | L2-Norm(final)=13.481 | 5329.8 samples/s | 83.3 steps/s
[Step=18200 Epoch=69.7] | Loss=0.00323 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=13.505 | 5117.8 samples/s | 80.0 steps/s
[Step=18250 Epoch=69.9] | Loss=0.00307 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=13.528 | 6881.4 samples/s | 107.5 steps/s
[Step=18300 Epoch=70.1] | Loss=0.00297 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=13.553 | 2144.8 samples/s | 33.5 steps/s
[Step=18350 Epoch=70.3] | Loss=0.00303 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=13.577 | 5221.6 samples/s | 81.6 steps/s
[Step=18400 Epoch=70.5] | Loss=0.00303 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=13.601 | 5131.6 samples/s | 80.2 steps/s
[Step=18450 Epoch=70.7] | Loss=0.00294 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=13.626 | 5246.0 samples/s | 82.0 steps/s
[Step=18500 Epoch=70.9] | Loss=0.00296 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.698 | L2-Norm(final)=13.650 | 5802.1 samples/s | 90.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=18501 Epoch=70.9] | Loss=0.00131 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.697 | L2-Norm(final)=13.893 | 4561.2 samples/s | 71.3 steps/s
[Step=18550 Epoch=71.1] | Loss=0.00430 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.782 | L2-Norm(final)=13.892 | 4216.6 samples/s | 65.9 steps/s
[Step=18600 Epoch=71.3] | Loss=0.00821 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.970 | L2-Norm(final)=13.864 | 4601.4 samples/s | 71.9 steps/s
[Step=18650 Epoch=71.5] | Loss=0.00839 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.120 | L2-Norm(final)=13.841 | 4546.6 samples/s | 71.0 steps/s
[Step=18700 Epoch=71.7] | Loss=0.00718 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.244 | L2-Norm(final)=13.820 | 4495.6 samples/s | 70.2 steps/s
[Step=18750 Epoch=71.8] | Loss=0.00743 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.339 | L2-Norm(final)=13.801 | 5600.6 samples/s | 87.5 steps/s
[Step=18800 Epoch=72.0] | Loss=0.00653 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.407 | L2-Norm(final)=13.780 | 2013.7 samples/s | 31.5 steps/s
[Step=18850 Epoch=72.2] | Loss=0.00568 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.452 | L2-Norm(final)=13.767 | 4496.8 samples/s | 70.3 steps/s
[Step=18900 Epoch=72.4] | Loss=0.00498 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.480 | L2-Norm(final)=13.758 | 4652.4 samples/s | 72.7 steps/s
[Step=18950 Epoch=72.6] | Loss=0.00444 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.496 | L2-Norm(final)=13.752 | 4487.1 samples/s | 70.1 steps/s
[Step=19000 Epoch=72.8] | Loss=0.00400 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.505 | L2-Norm(final)=13.747 | 5056.5 samples/s | 79.0 steps/s
[Step=19050 Epoch=73.0] | Loss=0.00363 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.507 | L2-Norm(final)=13.743 | 2118.2 samples/s | 33.1 steps/s
[Step=19100 Epoch=73.2] | Loss=0.00333 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.505 | L2-Norm(final)=13.740 | 4502.0 samples/s | 70.3 steps/s
[Step=19150 Epoch=73.4] | Loss=0.00308 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.499 | L2-Norm(final)=13.738 | 4583.3 samples/s | 71.6 steps/s
[Step=19200 Epoch=73.6] | Loss=0.00286 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.491 | L2-Norm(final)=13.736 | 4478.7 samples/s | 70.0 steps/s
[Step=19250 Epoch=73.8] | Loss=0.00267 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.481 | L2-Norm(final)=13.734 | 4557.5 samples/s | 71.2 steps/s
[Step=19300 Epoch=74.0] | Loss=0.00250 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.469 | L2-Norm(final)=13.732 | 2197.1 samples/s | 34.3 steps/s
[Step=19350 Epoch=74.1] | Loss=0.00235 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.456 | L2-Norm(final)=13.731 | 4624.6 samples/s | 72.3 steps/s
[Step=19400 Epoch=74.3] | Loss=0.00222 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.442 | L2-Norm(final)=13.730 | 4579.8 samples/s | 71.6 steps/s
[Step=19450 Epoch=74.5] | Loss=0.00211 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.427 | L2-Norm(final)=13.729 | 4549.8 samples/s | 71.1 steps/s
[Step=19500 Epoch=74.7] | Loss=0.00200 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.412 | L2-Norm(final)=13.729 | 4523.1 samples/s | 70.7 steps/s
[Step=19550 Epoch=74.9] | Loss=0.00191 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.396 | L2-Norm(final)=13.728 | 2200.6 samples/s | 34.4 steps/s
[Step=19600 Epoch=75.1] | Loss=0.00182 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.379 | L2-Norm(final)=13.728 | 4611.4 samples/s | 72.1 steps/s
[Step=19650 Epoch=75.3] | Loss=0.00174 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.363 | L2-Norm(final)=13.727 | 4492.7 samples/s | 70.2 steps/s
[Step=19700 Epoch=75.5] | Loss=0.00167 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.345 | L2-Norm(final)=13.727 | 4507.1 samples/s | 70.4 steps/s
[Step=19750 Epoch=75.7] | Loss=0.00160 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.328 | L2-Norm(final)=13.727 | 4574.0 samples/s | 71.5 steps/s
[Step=19800 Epoch=75.9] | Loss=0.00154 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.310 | L2-Norm(final)=13.728 | 6132.6 samples/s | 95.8 steps/s
[Step=19850 Epoch=76.1] | Loss=0.00148 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.292 | L2-Norm(final)=13.728 | 1945.7 samples/s | 30.4 steps/s
[Step=19900 Epoch=76.2] | Loss=0.00143 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.274 | L2-Norm(final)=13.728 | 4600.6 samples/s | 71.9 steps/s
[Step=19950 Epoch=76.4] | Loss=0.00138 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.256 | L2-Norm(final)=13.728 | 4511.4 samples/s | 70.5 steps/s
[Step=20000 Epoch=76.6] | Loss=0.00133 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.238 | L2-Norm(final)=13.729 | 4499.2 samples/s | 70.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step20000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=18001 Epoch=69.3] | Loss=0.00049 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=14.522 | 4849.2 samples/s | 75.8 steps/s
[Step=18050 Epoch=69.5] | Loss=0.00344 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.699 | L2-Norm(final)=14.554 | 4273.9 samples/s | 66.8 steps/s
[Step=18100 Epoch=69.7] | Loss=0.00357 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=14.593 | 5322.3 samples/s | 83.2 steps/s
[Step=18150 Epoch=69.9] | Loss=0.00384 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=14.628 | 5100.2 samples/s | 79.7 steps/s
[Step=18200 Epoch=70.1] | Loss=0.00421 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.698 | L2-Norm(final)=14.660 | 5346.4 samples/s | 83.5 steps/s
[Step=18250 Epoch=70.3] | Loss=0.00406 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=14.687 | 6849.6 samples/s | 107.0 steps/s
[Step=18300 Epoch=70.4] | Loss=0.00401 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=14.716 | 2149.5 samples/s | 33.6 steps/s
[Step=18350 Epoch=70.6] | Loss=0.00428 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=14.744 | 5068.9 samples/s | 79.2 steps/s
[Step=18400 Epoch=70.8] | Loss=0.00416 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=14.773 | 5202.1 samples/s | 81.3 steps/s
[Step=18450 Epoch=71.0] | Loss=0.00399 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=14.801 | 5193.2 samples/s | 81.1 steps/s
[Step=18500 Epoch=71.2] | Loss=0.00402 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=14.828 | 6045.1 samples/s | 94.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=18501 Epoch=71.2] | Loss=0.00516 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.697 | L2-Norm(final)=15.092 | 4756.5 samples/s | 74.3 steps/s
[Step=18550 Epoch=71.4] | Loss=0.00604 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.796 | L2-Norm(final)=15.100 | 4099.8 samples/s | 64.1 steps/s
[Step=18600 Epoch=71.6] | Loss=0.00954 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.977 | L2-Norm(final)=15.092 | 4470.8 samples/s | 69.9 steps/s
[Step=18650 Epoch=71.8] | Loss=0.01090 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.134 | L2-Norm(final)=15.053 | 4526.4 samples/s | 70.7 steps/s
[Step=18700 Epoch=72.0] | Loss=0.00974 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.261 | L2-Norm(final)=15.017 | 4528.9 samples/s | 70.8 steps/s
[Step=18750 Epoch=72.2] | Loss=0.00930 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.360 | L2-Norm(final)=14.986 | 5726.0 samples/s | 89.5 steps/s
[Step=18800 Epoch=72.4] | Loss=0.00821 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.431 | L2-Norm(final)=14.963 | 1998.6 samples/s | 31.2 steps/s
[Step=18850 Epoch=72.6] | Loss=0.00714 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.478 | L2-Norm(final)=14.946 | 4521.7 samples/s | 70.7 steps/s
[Step=18900 Epoch=72.8] | Loss=0.00627 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.510 | L2-Norm(final)=14.935 | 4532.7 samples/s | 70.8 steps/s
[Step=18950 Epoch=72.9] | Loss=0.00563 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.532 | L2-Norm(final)=14.926 | 4501.3 samples/s | 70.3 steps/s
[Step=19000 Epoch=73.1] | Loss=0.00549 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.553 | L2-Norm(final)=14.918 | 5150.4 samples/s | 80.5 steps/s
[Step=19050 Epoch=73.3] | Loss=0.00512 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.575 | L2-Norm(final)=14.909 | 2081.7 samples/s | 32.5 steps/s
[Step=19100 Epoch=73.5] | Loss=0.00474 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.592 | L2-Norm(final)=14.903 | 4524.3 samples/s | 70.7 steps/s
[Step=19150 Epoch=73.7] | Loss=0.00440 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.604 | L2-Norm(final)=14.898 | 4600.4 samples/s | 71.9 steps/s
[Step=19200 Epoch=73.9] | Loss=0.00409 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.613 | L2-Norm(final)=14.894 | 4495.8 samples/s | 70.2 steps/s
[Step=19250 Epoch=74.1] | Loss=0.00382 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.617 | L2-Norm(final)=14.891 | 4666.5 samples/s | 72.9 steps/s
[Step=19300 Epoch=74.3] | Loss=0.00358 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.619 | L2-Norm(final)=14.888 | 2172.9 samples/s | 34.0 steps/s
[Step=19350 Epoch=74.5] | Loss=0.00337 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.618 | L2-Norm(final)=14.885 | 4642.7 samples/s | 72.5 steps/s
[Step=19400 Epoch=74.7] | Loss=0.00319 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.614 | L2-Norm(final)=14.883 | 4511.3 samples/s | 70.5 steps/s
[Step=19450 Epoch=74.9] | Loss=0.00302 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.609 | L2-Norm(final)=14.882 | 4583.1 samples/s | 71.6 steps/s
[Step=19500 Epoch=75.1] | Loss=0.00287 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.603 | L2-Norm(final)=14.880 | 4586.5 samples/s | 71.7 steps/s
[Step=19550 Epoch=75.3] | Loss=0.00273 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.595 | L2-Norm(final)=14.879 | 2157.1 samples/s | 33.7 steps/s
[Step=19600 Epoch=75.4] | Loss=0.00261 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.586 | L2-Norm(final)=14.878 | 4432.9 samples/s | 69.3 steps/s
[Step=19650 Epoch=75.6] | Loss=0.00250 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.576 | L2-Norm(final)=14.877 | 4584.3 samples/s | 71.6 steps/s
[Step=19700 Epoch=75.8] | Loss=0.00239 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.566 | L2-Norm(final)=14.876 | 4626.6 samples/s | 72.3 steps/s
[Step=19750 Epoch=76.0] | Loss=0.00230 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.555 | L2-Norm(final)=14.875 | 4462.8 samples/s | 69.7 steps/s
[Step=19800 Epoch=76.2] | Loss=0.00221 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.543 | L2-Norm(final)=14.874 | 6631.3 samples/s | 103.6 steps/s
[Step=19850 Epoch=76.4] | Loss=0.00213 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.531 | L2-Norm(final)=14.874 | 1922.5 samples/s | 30.0 steps/s
[Step=19900 Epoch=76.6] | Loss=0.00205 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.518 | L2-Norm(final)=14.873 | 4551.0 samples/s | 71.1 steps/s
[Step=19950 Epoch=76.8] | Loss=0.00198 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.505 | L2-Norm(final)=14.873 | 4519.9 samples/s | 70.6 steps/s
[Step=20000 Epoch=77.0] | Loss=0.00191 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.491 | L2-Norm(final)=14.872 | 4585.1 samples/s | 71.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07134 | acc=0.9606 | tpr=0.9701 | fpr=0.0600 | 4002.7 samples/s | 15.6 steps/s
Avg test loss: 0.06948, Avg test acc: 0.96053, Avg tpr: 0.97062, Avg fpr: 0.06166, total FA: 481

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08765 | acc=0.9601 | tpr=0.9667 | fpr=0.0543 | 4169.7 samples/s | 16.3 steps/s
Avg test loss: 0.08585, Avg test acc: 0.95997, Avg tpr: 0.96672, Avg fpr: 0.05486, total FA: 428

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.90225 | acc=0.3136 | tpr=0.0045 | fpr=0.0151 | 4217.0 samples/s | 16.5 steps/s
Avg test loss: 7.91990, Avg test acc: 0.31052, Avg tpr: 0.00513, Avg fpr: 0.01782, total FA: 139

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.27929 | acc=0.3105 | tpr=0.0031 | fpr=0.0221 | 4261.9 samples/s | 16.6 steps/s
Avg test loss: 7.28736, Avg test acc: 0.30776, Avg tpr: 0.00315, Avg fpr: 0.02230, total FA: 174

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.58257 | acc=0.1282 | tpr=0.6239 | fpr=0.8807 | 4240.4 samples/s | 16.6 steps/s
[Step= 100] | Loss=5.55622 | acc=0.1293 | tpr=0.6141 | fpr=0.8798 | 7745.1 samples/s | 30.3 steps/s
[Step= 150] | Loss=5.55929 | acc=0.1283 | tpr=0.6210 | fpr=0.8808 | 7741.4 samples/s | 30.2 steps/s
[Step= 200] | Loss=5.55144 | acc=0.1275 | tpr=0.6131 | fpr=0.8813 | 7631.8 samples/s | 29.8 steps/s
[Step= 250] | Loss=5.53898 | acc=0.1281 | tpr=0.6000 | fpr=0.8805 | 7718.3 samples/s | 30.1 steps/s
[Step= 300] | Loss=5.54039 | acc=0.1281 | tpr=0.5964 | fpr=0.8804 | 7878.3 samples/s | 30.8 steps/s
[Step= 350] | Loss=5.54676 | acc=0.1281 | tpr=0.5974 | fpr=0.8804 | 7856.9 samples/s | 30.7 steps/s
[Step= 400] | Loss=5.53791 | acc=0.1279 | tpr=0.5952 | fpr=0.8806 | 7676.7 samples/s | 30.0 steps/s
[Step= 450] | Loss=5.54220 | acc=0.1278 | tpr=0.5940 | fpr=0.8807 | 8050.6 samples/s | 31.4 steps/s
[Step= 500] | Loss=5.54033 | acc=0.1277 | tpr=0.5978 | fpr=0.8808 | 7668.5 samples/s | 30.0 steps/s
[Step= 550] | Loss=5.53939 | acc=0.1281 | tpr=0.5977 | fpr=0.8805 | 14167.5 samples/s | 55.3 steps/s
Avg test loss: 5.54126, Avg test acc: 0.12799, Avg tpr: 0.59746, Avg fpr: 0.88055, total FA: 122262

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.14516 | acc=0.1316 | tpr=0.6283 | fpr=0.8773 | 4160.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=7.10411 | acc=0.1326 | tpr=0.6226 | fpr=0.8766 | 7853.2 samples/s | 30.7 steps/s
[Step= 150] | Loss=7.11667 | acc=0.1307 | tpr=0.6297 | fpr=0.8785 | 7934.9 samples/s | 31.0 steps/s
[Step= 200] | Loss=7.10985 | acc=0.1304 | tpr=0.6251 | fpr=0.8786 | 7994.1 samples/s | 31.2 steps/s
[Step= 250] | Loss=7.10235 | acc=0.1297 | tpr=0.6201 | fpr=0.8792 | 7795.6 samples/s | 30.5 steps/s
[Step= 300] | Loss=7.10466 | acc=0.1291 | tpr=0.6153 | fpr=0.8798 | 7800.8 samples/s | 30.5 steps/s
[Step= 350] | Loss=7.10397 | acc=0.1286 | tpr=0.6130 | fpr=0.8802 | 8324.5 samples/s | 32.5 steps/s
[Step= 400] | Loss=7.09264 | acc=0.1285 | tpr=0.6078 | fpr=0.8802 | 7590.9 samples/s | 29.7 steps/s
[Step= 450] | Loss=7.09662 | acc=0.1287 | tpr=0.6086 | fpr=0.8800 | 7665.6 samples/s | 29.9 steps/s
[Step= 500] | Loss=7.09708 | acc=0.1286 | tpr=0.6154 | fpr=0.8802 | 8035.5 samples/s | 31.4 steps/s
[Step= 550] | Loss=7.09989 | acc=0.1289 | tpr=0.6128 | fpr=0.8799 | 14804.0 samples/s | 57.8 steps/s
Avg test loss: 7.10006, Avg test acc: 0.12883, Avg tpr: 0.61212, Avg fpr: 0.87996, total FA: 122180

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10228 | acc=0.9832 | tpr=0.9469 | fpr=0.0161 | 4210.8 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.10732 | acc=0.9824 | tpr=0.9595 | fpr=0.0172 | 7592.5 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.10973 | acc=0.9811 | tpr=0.9568 | fpr=0.0184 | 7916.4 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.11186 | acc=0.9810 | tpr=0.9563 | fpr=0.0185 | 7912.7 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.11164 | acc=0.9810 | tpr=0.9502 | fpr=0.0184 | 7937.0 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.11262 | acc=0.9807 | tpr=0.9491 | fpr=0.0187 | 8080.3 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.11414 | acc=0.9805 | tpr=0.9487 | fpr=0.0189 | 7415.2 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.11495 | acc=0.9804 | tpr=0.9464 | fpr=0.0190 | 8240.8 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.11718 | acc=0.9801 | tpr=0.9450 | fpr=0.0193 | 7582.6 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.11665 | acc=0.9801 | tpr=0.9463 | fpr=0.0193 | 7814.4 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.11600 | acc=0.9802 | tpr=0.9443 | fpr=0.0192 | 14464.0 samples/s | 56.5 steps/s
Avg test loss: 0.11574, Avg test acc: 0.98021, Avg tpr: 0.94414, Avg fpr: 0.01914, total FA: 2657

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11144 | acc=0.9812 | tpr=0.9071 | fpr=0.0174 | 4188.9 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.11508 | acc=0.9806 | tpr=0.9232 | fpr=0.0183 | 7789.5 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.11777 | acc=0.9803 | tpr=0.9409 | fpr=0.0190 | 7941.6 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.12019 | acc=0.9802 | tpr=0.9454 | fpr=0.0192 | 7953.2 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.11983 | acc=0.9802 | tpr=0.9432 | fpr=0.0191 | 7877.4 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.12247 | acc=0.9798 | tpr=0.9411 | fpr=0.0195 | 7850.4 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.12294 | acc=0.9797 | tpr=0.9405 | fpr=0.0196 | 7777.9 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.12383 | acc=0.9795 | tpr=0.9393 | fpr=0.0198 | 7872.9 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.12564 | acc=0.9793 | tpr=0.9372 | fpr=0.0200 | 7848.8 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.12511 | acc=0.9793 | tpr=0.9383 | fpr=0.0200 | 7654.4 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.12502 | acc=0.9793 | tpr=0.9371 | fpr=0.0199 | 15059.3 samples/s | 58.8 steps/s
Avg test loss: 0.12472, Avg test acc: 0.97935, Avg tpr: 0.93661, Avg fpr: 0.01987, total FA: 2759

server round 10/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=39.0] | Loss=0.14015 | Reg=0.00192 | acc=0.8438 | L2-Norm=13.853 | L2-Norm(final)=13.013 | 4400.3 samples/s | 68.8 steps/s
[Step=20050 Epoch=39.1] | Loss=0.09325 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.856 | L2-Norm(final)=13.017 | 5175.2 samples/s | 80.9 steps/s
[Step=20100 Epoch=39.2] | Loss=0.08529 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.856 | L2-Norm(final)=13.041 | 5585.1 samples/s | 87.3 steps/s
[Step=20150 Epoch=39.3] | Loss=0.08434 | Reg=0.00192 | acc=0.9062 | L2-Norm=13.856 | L2-Norm(final)=13.070 | 5646.8 samples/s | 88.2 steps/s
[Step=20200 Epoch=39.4] | Loss=0.08192 | Reg=0.00192 | acc=0.9062 | L2-Norm=13.857 | L2-Norm(final)=13.101 | 5450.3 samples/s | 85.2 steps/s
[Step=20250 Epoch=39.5] | Loss=0.08009 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.857 | L2-Norm(final)=13.132 | 5623.8 samples/s | 87.9 steps/s
[Step=20300 Epoch=39.6] | Loss=0.07961 | Reg=0.00192 | acc=0.9062 | L2-Norm=13.857 | L2-Norm(final)=13.164 | 5600.9 samples/s | 87.5 steps/s
[Step=20350 Epoch=39.7] | Loss=0.08001 | Reg=0.00192 | acc=0.9375 | L2-Norm=13.857 | L2-Norm(final)=13.196 | 5529.1 samples/s | 86.4 steps/s
[Step=20400 Epoch=39.8] | Loss=0.07942 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.857 | L2-Norm(final)=13.227 | 5525.9 samples/s | 86.3 steps/s
[Step=20450 Epoch=39.9] | Loss=0.07951 | Reg=0.00192 | acc=0.9375 | L2-Norm=13.857 | L2-Norm(final)=13.258 | 5441.7 samples/s | 85.0 steps/s
[Step=20500 Epoch=40.0] | Loss=0.07941 | Reg=0.00192 | acc=0.9219 | L2-Norm=13.857 | L2-Norm(final)=13.289 | 6980.0 samples/s | 109.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=40.0] | Loss=0.07016 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.857 | L2-Norm(final)=13.594 | 4276.5 samples/s | 66.8 steps/s
[Step=20550 Epoch=40.1] | Loss=0.05098 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.936 | L2-Norm(final)=13.612 | 4414.2 samples/s | 69.0 steps/s
[Step=20600 Epoch=40.2] | Loss=0.04184 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.991 | L2-Norm(final)=13.611 | 4749.1 samples/s | 74.2 steps/s
[Step=20650 Epoch=40.3] | Loss=0.03779 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.025 | L2-Norm(final)=13.609 | 4830.6 samples/s | 75.5 steps/s
[Step=20700 Epoch=40.4] | Loss=0.03567 | Reg=0.00197 | acc=0.9531 | L2-Norm=14.051 | L2-Norm(final)=13.609 | 4903.9 samples/s | 76.6 steps/s
[Step=20750 Epoch=40.5] | Loss=0.03385 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.071 | L2-Norm(final)=13.608 | 4817.2 samples/s | 75.3 steps/s
[Step=20800 Epoch=40.6] | Loss=0.03204 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=13.607 | 4824.0 samples/s | 75.4 steps/s
[Step=20850 Epoch=40.7] | Loss=0.03119 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.105 | L2-Norm(final)=13.608 | 4846.2 samples/s | 75.7 steps/s
[Step=20900 Epoch=40.8] | Loss=0.03033 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.118 | L2-Norm(final)=13.608 | 4816.4 samples/s | 75.3 steps/s
[Step=20950 Epoch=40.9] | Loss=0.02955 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.131 | L2-Norm(final)=13.608 | 4822.6 samples/s | 75.4 steps/s
[Step=21000 Epoch=41.0] | Loss=0.02904 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.143 | L2-Norm(final)=13.607 | 5824.0 samples/s | 91.0 steps/s
[Step=21050 Epoch=41.1] | Loss=0.02792 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.154 | L2-Norm(final)=13.607 | 1995.8 samples/s | 31.2 steps/s
[Step=21100 Epoch=41.2] | Loss=0.02716 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.165 | L2-Norm(final)=13.606 | 4815.3 samples/s | 75.2 steps/s
[Step=21150 Epoch=41.3] | Loss=0.02627 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.175 | L2-Norm(final)=13.606 | 4845.1 samples/s | 75.7 steps/s
[Step=21200 Epoch=41.3] | Loss=0.02549 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.184 | L2-Norm(final)=13.605 | 4732.6 samples/s | 73.9 steps/s
[Step=21250 Epoch=41.4] | Loss=0.02492 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.193 | L2-Norm(final)=13.604 | 4804.5 samples/s | 75.1 steps/s
[Step=21300 Epoch=41.5] | Loss=0.02445 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.201 | L2-Norm(final)=13.603 | 4824.1 samples/s | 75.4 steps/s
[Step=21350 Epoch=41.6] | Loss=0.02396 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.210 | L2-Norm(final)=13.602 | 4837.4 samples/s | 75.6 steps/s
[Step=21400 Epoch=41.7] | Loss=0.02361 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.217 | L2-Norm(final)=13.601 | 4750.0 samples/s | 74.2 steps/s
[Step=21450 Epoch=41.8] | Loss=0.02329 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.225 | L2-Norm(final)=13.600 | 4856.4 samples/s | 75.9 steps/s
[Step=21500 Epoch=41.9] | Loss=0.02280 | Reg=0.00203 | acc=0.9531 | L2-Norm=14.233 | L2-Norm(final)=13.600 | 5024.1 samples/s | 78.5 steps/s
[Step=21550 Epoch=42.0] | Loss=0.02231 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.241 | L2-Norm(final)=13.600 | 2147.2 samples/s | 33.6 steps/s
[Step=21600 Epoch=42.1] | Loss=0.02187 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.248 | L2-Norm(final)=13.600 | 4890.2 samples/s | 76.4 steps/s
[Step=21650 Epoch=42.2] | Loss=0.02135 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.255 | L2-Norm(final)=13.600 | 4742.6 samples/s | 74.1 steps/s
[Step=21700 Epoch=42.3] | Loss=0.02100 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.261 | L2-Norm(final)=13.600 | 4784.5 samples/s | 74.8 steps/s
[Step=21750 Epoch=42.4] | Loss=0.02066 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.268 | L2-Norm(final)=13.601 | 4792.2 samples/s | 74.9 steps/s
[Step=21800 Epoch=42.5] | Loss=0.02059 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.274 | L2-Norm(final)=13.601 | 4784.7 samples/s | 74.8 steps/s
[Step=21850 Epoch=42.6] | Loss=0.02030 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.280 | L2-Norm(final)=13.601 | 4825.3 samples/s | 75.4 steps/s
[Step=21900 Epoch=42.7] | Loss=0.02005 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.286 | L2-Norm(final)=13.601 | 4864.7 samples/s | 76.0 steps/s
[Step=21950 Epoch=42.8] | Loss=0.01982 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.292 | L2-Norm(final)=13.602 | 4802.3 samples/s | 75.0 steps/s
[Step=22000 Epoch=42.9] | Loss=0.01974 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.298 | L2-Norm(final)=13.602 | 4824.8 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step22000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=39.1] | Loss=0.12903 | Reg=0.00192 | acc=0.9375 | L2-Norm=13.853 | L2-Norm(final)=13.646 | 4787.2 samples/s | 74.8 steps/s
[Step=20050 Epoch=39.2] | Loss=0.08712 | Reg=0.00192 | acc=0.8750 | L2-Norm=13.858 | L2-Norm(final)=13.658 | 4822.6 samples/s | 75.4 steps/s
[Step=20100 Epoch=39.3] | Loss=0.08490 | Reg=0.00192 | acc=0.9375 | L2-Norm=13.859 | L2-Norm(final)=13.680 | 5571.2 samples/s | 87.0 steps/s
[Step=20150 Epoch=39.4] | Loss=0.08504 | Reg=0.00192 | acc=0.9375 | L2-Norm=13.859 | L2-Norm(final)=13.701 | 5491.5 samples/s | 85.8 steps/s
[Step=20200 Epoch=39.5] | Loss=0.08420 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.859 | L2-Norm(final)=13.725 | 5539.8 samples/s | 86.6 steps/s
[Step=20250 Epoch=39.6] | Loss=0.08465 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.859 | L2-Norm(final)=13.749 | 5433.0 samples/s | 84.9 steps/s
[Step=20300 Epoch=39.7] | Loss=0.08454 | Reg=0.00192 | acc=0.9062 | L2-Norm=13.859 | L2-Norm(final)=13.772 | 5552.7 samples/s | 86.8 steps/s
[Step=20350 Epoch=39.8] | Loss=0.08342 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.859 | L2-Norm(final)=13.795 | 5543.9 samples/s | 86.6 steps/s
[Step=20400 Epoch=39.9] | Loss=0.08253 | Reg=0.00192 | acc=0.9062 | L2-Norm=13.859 | L2-Norm(final)=13.820 | 5511.8 samples/s | 86.1 steps/s
[Step=20450 Epoch=40.0] | Loss=0.08160 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.859 | L2-Norm(final)=13.844 | 5568.6 samples/s | 87.0 steps/s
[Step=20500 Epoch=40.1] | Loss=0.08099 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.859 | L2-Norm(final)=13.869 | 7084.9 samples/s | 110.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=40.1] | Loss=0.10833 | Reg=0.00192 | acc=0.9062 | L2-Norm=13.859 | L2-Norm(final)=14.114 | 4369.6 samples/s | 68.3 steps/s
[Step=20550 Epoch=40.2] | Loss=0.04984 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.926 | L2-Norm(final)=14.123 | 4921.3 samples/s | 76.9 steps/s
[Step=20600 Epoch=40.3] | Loss=0.03973 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.975 | L2-Norm(final)=14.123 | 4731.6 samples/s | 73.9 steps/s
[Step=20650 Epoch=40.4] | Loss=0.03879 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.009 | L2-Norm(final)=14.118 | 4711.9 samples/s | 73.6 steps/s
[Step=20700 Epoch=40.5] | Loss=0.03650 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.035 | L2-Norm(final)=14.114 | 4771.1 samples/s | 74.5 steps/s
[Step=20750 Epoch=40.6] | Loss=0.03499 | Reg=0.00198 | acc=0.9375 | L2-Norm=14.054 | L2-Norm(final)=14.111 | 4734.6 samples/s | 74.0 steps/s
[Step=20800 Epoch=40.7] | Loss=0.03345 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.070 | L2-Norm(final)=14.109 | 4841.5 samples/s | 75.6 steps/s
[Step=20850 Epoch=40.8] | Loss=0.03237 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.083 | L2-Norm(final)=14.108 | 4716.5 samples/s | 73.7 steps/s
[Step=20900 Epoch=40.9] | Loss=0.03137 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.096 | L2-Norm(final)=14.107 | 4807.9 samples/s | 75.1 steps/s
[Step=20950 Epoch=41.0] | Loss=0.03062 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.107 | L2-Norm(final)=14.106 | 4757.6 samples/s | 74.3 steps/s
[Step=21000 Epoch=41.1] | Loss=0.02983 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.118 | L2-Norm(final)=14.106 | 5930.9 samples/s | 92.7 steps/s
[Step=21050 Epoch=41.2] | Loss=0.02851 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.128 | L2-Norm(final)=14.106 | 2087.1 samples/s | 32.6 steps/s
[Step=21100 Epoch=41.2] | Loss=0.02726 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.138 | L2-Norm(final)=14.106 | 4745.9 samples/s | 74.2 steps/s
[Step=21150 Epoch=41.3] | Loss=0.02647 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.146 | L2-Norm(final)=14.106 | 4783.2 samples/s | 74.7 steps/s
[Step=21200 Epoch=41.4] | Loss=0.02566 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.155 | L2-Norm(final)=14.107 | 4799.2 samples/s | 75.0 steps/s
[Step=21250 Epoch=41.5] | Loss=0.02482 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.163 | L2-Norm(final)=14.107 | 4693.1 samples/s | 73.3 steps/s
[Step=21300 Epoch=41.6] | Loss=0.02442 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.170 | L2-Norm(final)=14.107 | 4811.5 samples/s | 75.2 steps/s
[Step=21350 Epoch=41.7] | Loss=0.02376 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.177 | L2-Norm(final)=14.107 | 4881.5 samples/s | 76.3 steps/s
[Step=21400 Epoch=41.8] | Loss=0.02337 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.185 | L2-Norm(final)=14.108 | 4798.8 samples/s | 75.0 steps/s
[Step=21450 Epoch=41.9] | Loss=0.02304 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.191 | L2-Norm(final)=14.108 | 4712.6 samples/s | 73.6 steps/s
[Step=21500 Epoch=42.0] | Loss=0.02267 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.198 | L2-Norm(final)=14.108 | 5163.5 samples/s | 80.7 steps/s
[Step=21550 Epoch=42.1] | Loss=0.02225 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.205 | L2-Norm(final)=14.108 | 2192.2 samples/s | 34.3 steps/s
[Step=21600 Epoch=42.2] | Loss=0.02176 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.211 | L2-Norm(final)=14.108 | 4844.9 samples/s | 75.7 steps/s
[Step=21650 Epoch=42.3] | Loss=0.02131 | Reg=0.00202 | acc=0.9688 | L2-Norm=14.218 | L2-Norm(final)=14.108 | 4709.4 samples/s | 73.6 steps/s
[Step=21700 Epoch=42.4] | Loss=0.02098 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.224 | L2-Norm(final)=14.109 | 4793.7 samples/s | 74.9 steps/s
[Step=21750 Epoch=42.5] | Loss=0.02059 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.230 | L2-Norm(final)=14.109 | 4789.4 samples/s | 74.8 steps/s
[Step=21800 Epoch=42.6] | Loss=0.02038 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.236 | L2-Norm(final)=14.109 | 4800.7 samples/s | 75.0 steps/s
[Step=21850 Epoch=42.7] | Loss=0.02006 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.242 | L2-Norm(final)=14.110 | 4802.4 samples/s | 75.0 steps/s
[Step=21900 Epoch=42.8] | Loss=0.01977 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.247 | L2-Norm(final)=14.110 | 4810.1 samples/s | 75.2 steps/s
[Step=21950 Epoch=42.9] | Loss=0.01951 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.253 | L2-Norm(final)=14.110 | 4821.6 samples/s | 75.3 steps/s
[Step=22000 Epoch=43.0] | Loss=0.01945 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.258 | L2-Norm(final)=14.111 | 4811.0 samples/s | 75.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step22000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=76.6] | Loss=0.02843 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.853 | L2-Norm(final)=13.741 | 4628.9 samples/s | 72.3 steps/s
[Step=20050 Epoch=76.8] | Loss=0.00573 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.851 | L2-Norm(final)=13.756 | 4986.4 samples/s | 77.9 steps/s
[Step=20100 Epoch=77.0] | Loss=0.00482 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=13.766 | 5220.7 samples/s | 81.6 steps/s
[Step=20150 Epoch=77.2] | Loss=0.00441 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=13.781 | 5273.6 samples/s | 82.4 steps/s
[Step=20200 Epoch=77.4] | Loss=0.00398 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=13.797 | 5229.1 samples/s | 81.7 steps/s
[Step=20250 Epoch=77.6] | Loss=0.00401 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.850 | L2-Norm(final)=13.813 | 6874.4 samples/s | 107.4 steps/s
[Step=20300 Epoch=77.8] | Loss=0.00405 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=13.828 | 2127.8 samples/s | 33.2 steps/s
[Step=20350 Epoch=78.0] | Loss=0.00386 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=13.841 | 5247.9 samples/s | 82.0 steps/s
[Step=20400 Epoch=78.2] | Loss=0.00379 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=13.855 | 5265.5 samples/s | 82.3 steps/s
[Step=20450 Epoch=78.4] | Loss=0.00366 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=13.870 | 5295.9 samples/s | 82.7 steps/s
[Step=20500 Epoch=78.5] | Loss=0.00367 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=13.885 | 5709.1 samples/s | 89.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=78.6] | Loss=0.00193 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=14.037 | 4366.8 samples/s | 68.2 steps/s
[Step=20550 Epoch=78.7] | Loss=0.00393 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.854 | L2-Norm(final)=14.046 | 4526.3 samples/s | 70.7 steps/s
[Step=20600 Epoch=78.9] | Loss=0.00413 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.908 | L2-Norm(final)=14.043 | 4597.1 samples/s | 71.8 steps/s
[Step=20650 Epoch=79.1] | Loss=0.00335 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.943 | L2-Norm(final)=14.041 | 4530.8 samples/s | 70.8 steps/s
[Step=20700 Epoch=79.3] | Loss=0.00267 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.959 | L2-Norm(final)=14.041 | 4572.5 samples/s | 71.4 steps/s
[Step=20750 Epoch=79.5] | Loss=0.00244 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.964 | L2-Norm(final)=14.042 | 5739.7 samples/s | 89.7 steps/s
[Step=20800 Epoch=79.7] | Loss=0.00227 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.967 | L2-Norm(final)=14.043 | 1995.4 samples/s | 31.2 steps/s
[Step=20850 Epoch=79.9] | Loss=0.00195 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.967 | L2-Norm(final)=14.044 | 4530.5 samples/s | 70.8 steps/s
[Step=20900 Epoch=80.1] | Loss=0.00172 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.964 | L2-Norm(final)=14.046 | 4565.2 samples/s | 71.3 steps/s
[Step=20950 Epoch=80.3] | Loss=0.00155 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.959 | L2-Norm(final)=14.048 | 4516.6 samples/s | 70.6 steps/s
[Step=21000 Epoch=80.5] | Loss=0.00140 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.952 | L2-Norm(final)=14.049 | 5076.8 samples/s | 79.3 steps/s
[Step=21050 Epoch=80.7] | Loss=0.00127 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.945 | L2-Norm(final)=14.051 | 2139.3 samples/s | 33.4 steps/s
[Step=21100 Epoch=80.8] | Loss=0.00117 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.936 | L2-Norm(final)=14.052 | 4490.4 samples/s | 70.2 steps/s
[Step=21150 Epoch=81.0] | Loss=0.00108 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.926 | L2-Norm(final)=14.053 | 4563.2 samples/s | 71.3 steps/s
[Step=21200 Epoch=81.2] | Loss=0.00100 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.916 | L2-Norm(final)=14.054 | 4519.2 samples/s | 70.6 steps/s
[Step=21250 Epoch=81.4] | Loss=0.00094 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.906 | L2-Norm(final)=14.055 | 4579.8 samples/s | 71.6 steps/s
[Step=21300 Epoch=81.6] | Loss=0.00088 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.895 | L2-Norm(final)=14.056 | 2197.0 samples/s | 34.3 steps/s
[Step=21350 Epoch=81.8] | Loss=0.00083 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.885 | L2-Norm(final)=14.057 | 4622.0 samples/s | 72.2 steps/s
[Step=21400 Epoch=82.0] | Loss=0.00078 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.873 | L2-Norm(final)=14.058 | 4565.4 samples/s | 71.3 steps/s
[Step=21450 Epoch=82.2] | Loss=0.00074 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.862 | L2-Norm(final)=14.058 | 4515.6 samples/s | 70.6 steps/s
[Step=21500 Epoch=82.4] | Loss=0.00070 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.851 | L2-Norm(final)=14.059 | 4534.8 samples/s | 70.9 steps/s
[Step=21550 Epoch=82.6] | Loss=0.00067 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=14.060 | 2204.1 samples/s | 34.4 steps/s
[Step=21600 Epoch=82.8] | Loss=0.00064 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.828 | L2-Norm(final)=14.060 | 4657.1 samples/s | 72.8 steps/s
[Step=21650 Epoch=83.0] | Loss=0.00061 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.816 | L2-Norm(final)=14.061 | 4499.9 samples/s | 70.3 steps/s
[Step=21700 Epoch=83.1] | Loss=0.00059 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.805 | L2-Norm(final)=14.062 | 4518.6 samples/s | 70.6 steps/s
[Step=21750 Epoch=83.3] | Loss=0.00056 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.793 | L2-Norm(final)=14.062 | 4576.1 samples/s | 71.5 steps/s
[Step=21800 Epoch=83.5] | Loss=0.00054 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=14.063 | 6165.0 samples/s | 96.3 steps/s
[Step=21850 Epoch=83.7] | Loss=0.00052 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.769 | L2-Norm(final)=14.063 | 1952.5 samples/s | 30.5 steps/s
[Step=21900 Epoch=83.9] | Loss=0.00050 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.757 | L2-Norm(final)=14.064 | 4576.1 samples/s | 71.5 steps/s
[Step=21950 Epoch=84.1] | Loss=0.00049 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.745 | L2-Norm(final)=14.064 | 4550.3 samples/s | 71.1 steps/s
[Step=22000 Epoch=84.3] | Loss=0.00047 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.733 | L2-Norm(final)=14.065 | 4554.1 samples/s | 71.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step22000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=77.0] | Loss=0.00565 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.853 | L2-Norm(final)=14.862 | 4355.0 samples/s | 68.0 steps/s
[Step=20050 Epoch=77.2] | Loss=0.00475 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.851 | L2-Norm(final)=14.877 | 5199.8 samples/s | 81.2 steps/s
[Step=20100 Epoch=77.4] | Loss=0.00435 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.851 | L2-Norm(final)=14.896 | 5184.0 samples/s | 81.0 steps/s
[Step=20150 Epoch=77.6] | Loss=0.00409 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.851 | L2-Norm(final)=14.916 | 5178.8 samples/s | 80.9 steps/s
[Step=20200 Epoch=77.8] | Loss=0.00389 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=14.938 | 5205.0 samples/s | 81.3 steps/s
[Step=20250 Epoch=78.0] | Loss=0.00392 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=14.960 | 6975.1 samples/s | 109.0 steps/s
[Step=20300 Epoch=78.1] | Loss=0.00380 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.850 | L2-Norm(final)=14.979 | 2115.3 samples/s | 33.1 steps/s
[Step=20350 Epoch=78.3] | Loss=0.00370 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=14.999 | 5170.6 samples/s | 80.8 steps/s
[Step=20400 Epoch=78.5] | Loss=0.00384 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=15.018 | 5193.8 samples/s | 81.2 steps/s
[Step=20450 Epoch=78.7] | Loss=0.00380 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=15.037 | 5200.0 samples/s | 81.3 steps/s
[Step=20500 Epoch=78.9] | Loss=0.00378 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=15.056 | 5986.3 samples/s | 93.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=78.9] | Loss=0.00179 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=15.252 | 4609.0 samples/s | 72.0 steps/s
[Step=20550 Epoch=79.1] | Loss=0.00212 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.857 | L2-Norm(final)=15.267 | 4486.3 samples/s | 70.1 steps/s
[Step=20600 Epoch=79.3] | Loss=0.00145 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.872 | L2-Norm(final)=15.271 | 4548.0 samples/s | 71.1 steps/s
[Step=20650 Epoch=79.5] | Loss=0.00221 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.878 | L2-Norm(final)=15.271 | 4599.2 samples/s | 71.9 steps/s
[Step=20700 Epoch=79.7] | Loss=0.00185 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.895 | L2-Norm(final)=15.266 | 4519.7 samples/s | 70.6 steps/s
[Step=20750 Epoch=79.9] | Loss=0.00177 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.909 | L2-Norm(final)=15.265 | 5883.8 samples/s | 91.9 steps/s
[Step=20800 Epoch=80.1] | Loss=0.00169 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.920 | L2-Norm(final)=15.264 | 2010.5 samples/s | 31.4 steps/s
[Step=20850 Epoch=80.3] | Loss=0.00147 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.928 | L2-Norm(final)=15.263 | 4611.4 samples/s | 72.1 steps/s
[Step=20900 Epoch=80.5] | Loss=0.00129 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.930 | L2-Norm(final)=15.263 | 4605.6 samples/s | 72.0 steps/s
[Step=20950 Epoch=80.6] | Loss=0.00131 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.930 | L2-Norm(final)=15.263 | 4490.4 samples/s | 70.2 steps/s
[Step=21000 Epoch=80.8] | Loss=0.00119 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.929 | L2-Norm(final)=15.262 | 5161.8 samples/s | 80.7 steps/s
[Step=21050 Epoch=81.0] | Loss=0.00109 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.926 | L2-Norm(final)=15.262 | 2108.6 samples/s | 32.9 steps/s
[Step=21100 Epoch=81.2] | Loss=0.00100 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.922 | L2-Norm(final)=15.262 | 4583.4 samples/s | 71.6 steps/s
[Step=21150 Epoch=81.4] | Loss=0.00092 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.916 | L2-Norm(final)=15.262 | 4486.3 samples/s | 70.1 steps/s
[Step=21200 Epoch=81.6] | Loss=0.00086 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.909 | L2-Norm(final)=15.262 | 4573.5 samples/s | 71.5 steps/s
[Step=21250 Epoch=81.8] | Loss=0.00080 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.902 | L2-Norm(final)=15.262 | 4654.4 samples/s | 72.7 steps/s
[Step=21300 Epoch=82.0] | Loss=0.00075 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.894 | L2-Norm(final)=15.263 | 2204.1 samples/s | 34.4 steps/s
[Step=21350 Epoch=82.2] | Loss=0.00071 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.886 | L2-Norm(final)=15.263 | 4528.7 samples/s | 70.8 steps/s
[Step=21400 Epoch=82.4] | Loss=0.00067 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.878 | L2-Norm(final)=15.263 | 4600.5 samples/s | 71.9 steps/s
[Step=21450 Epoch=82.6] | Loss=0.00063 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.869 | L2-Norm(final)=15.263 | 4569.3 samples/s | 71.4 steps/s
[Step=21500 Epoch=82.8] | Loss=0.00060 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.859 | L2-Norm(final)=15.263 | 4504.1 samples/s | 70.4 steps/s
[Step=21550 Epoch=83.0] | Loss=0.00057 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=15.263 | 2199.6 samples/s | 34.4 steps/s
[Step=21600 Epoch=83.1] | Loss=0.00055 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.840 | L2-Norm(final)=15.264 | 4668.2 samples/s | 72.9 steps/s
[Step=21650 Epoch=83.3] | Loss=0.00052 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.831 | L2-Norm(final)=15.264 | 4536.9 samples/s | 70.9 steps/s
[Step=21700 Epoch=83.5] | Loss=0.00050 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.821 | L2-Norm(final)=15.264 | 4591.3 samples/s | 71.7 steps/s
[Step=21750 Epoch=83.7] | Loss=0.00048 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.811 | L2-Norm(final)=15.264 | 4513.2 samples/s | 70.5 steps/s
[Step=21800 Epoch=83.9] | Loss=0.00046 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.801 | L2-Norm(final)=15.264 | 6690.8 samples/s | 104.5 steps/s
[Step=21850 Epoch=84.1] | Loss=0.00045 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.790 | L2-Norm(final)=15.265 | 1933.0 samples/s | 30.2 steps/s
[Step=21900 Epoch=84.3] | Loss=0.00043 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.780 | L2-Norm(final)=15.265 | 4545.7 samples/s | 71.0 steps/s
[Step=21950 Epoch=84.5] | Loss=0.00041 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.769 | L2-Norm(final)=15.265 | 4602.0 samples/s | 71.9 steps/s
[Step=22000 Epoch=84.7] | Loss=0.00040 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.759 | L2-Norm(final)=15.265 | 4499.9 samples/s | 70.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step22000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08038 | acc=0.9630 | tpr=0.9688 | fpr=0.0498 | 4127.7 samples/s | 16.1 steps/s
Avg test loss: 0.07579, Avg test acc: 0.96330, Avg tpr: 0.96946, Avg fpr: 0.05025, total FA: 392

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06162 | acc=0.9694 | tpr=0.9746 | fpr=0.0419 | 4220.6 samples/s | 16.5 steps/s
Avg test loss: 0.06033, Avg test acc: 0.96831, Avg tpr: 0.97412, Avg fpr: 0.04448, total FA: 347

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.82410 | acc=0.3095 | tpr=0.0078 | fpr=0.0354 | 4131.0 samples/s | 16.1 steps/s
Avg test loss: 7.85049, Avg test acc: 0.30716, Avg tpr: 0.00851, Avg fpr: 0.03602, total FA: 281

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.81286 | acc=0.3046 | tpr=0.0042 | fpr=0.0431 | 4182.1 samples/s | 16.3 steps/s
Avg test loss: 6.83931, Avg test acc: 0.30187, Avg tpr: 0.00478, Avg fpr: 0.04474, total FA: 349

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.61863 | acc=0.1295 | tpr=0.5442 | fpr=0.8780 | 4169.7 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.55435 | acc=0.1291 | tpr=0.5544 | fpr=0.8788 | 8045.2 samples/s | 31.4 steps/s
[Step= 150] | Loss=6.56560 | acc=0.1277 | tpr=0.5591 | fpr=0.8803 | 7874.3 samples/s | 30.8 steps/s
[Step= 200] | Loss=6.55268 | acc=0.1273 | tpr=0.5530 | fpr=0.8805 | 7761.1 samples/s | 30.3 steps/s
[Step= 250] | Loss=6.54105 | acc=0.1279 | tpr=0.5459 | fpr=0.8797 | 7891.7 samples/s | 30.8 steps/s
[Step= 300] | Loss=6.54502 | acc=0.1274 | tpr=0.5455 | fpr=0.8802 | 7843.0 samples/s | 30.6 steps/s
[Step= 350] | Loss=6.55588 | acc=0.1270 | tpr=0.5435 | fpr=0.8806 | 7886.5 samples/s | 30.8 steps/s
[Step= 400] | Loss=6.54563 | acc=0.1270 | tpr=0.5388 | fpr=0.8805 | 7859.7 samples/s | 30.7 steps/s
[Step= 450] | Loss=6.55150 | acc=0.1267 | tpr=0.5326 | fpr=0.8807 | 7818.5 samples/s | 30.5 steps/s
[Step= 500] | Loss=6.55201 | acc=0.1268 | tpr=0.5374 | fpr=0.8806 | 7746.1 samples/s | 30.3 steps/s
[Step= 550] | Loss=6.55363 | acc=0.1270 | tpr=0.5408 | fpr=0.8805 | 15195.1 samples/s | 59.4 steps/s
Avg test loss: 6.55451, Avg test acc: 0.12693, Avg tpr: 0.54041, Avg fpr: 0.88059, total FA: 122268

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.59314 | acc=0.1466 | tpr=0.5575 | fpr=0.8608 | 4139.5 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.54173 | acc=0.1459 | tpr=0.5480 | fpr=0.8616 | 7996.2 samples/s | 31.2 steps/s
[Step= 150] | Loss=5.54973 | acc=0.1476 | tpr=0.5533 | fpr=0.8599 | 7607.7 samples/s | 29.7 steps/s
[Step= 200] | Loss=5.54312 | acc=0.1477 | tpr=0.5541 | fpr=0.8597 | 8019.0 samples/s | 31.3 steps/s
[Step= 250] | Loss=5.53644 | acc=0.1479 | tpr=0.5511 | fpr=0.8594 | 7898.5 samples/s | 30.9 steps/s
[Step= 300] | Loss=5.53802 | acc=0.1476 | tpr=0.5476 | fpr=0.8597 | 7939.5 samples/s | 31.0 steps/s
[Step= 350] | Loss=5.54371 | acc=0.1468 | tpr=0.5398 | fpr=0.8604 | 7820.1 samples/s | 30.5 steps/s
[Step= 400] | Loss=5.53424 | acc=0.1470 | tpr=0.5334 | fpr=0.8600 | 7855.7 samples/s | 30.7 steps/s
[Step= 450] | Loss=5.53990 | acc=0.1469 | tpr=0.5331 | fpr=0.8602 | 8011.4 samples/s | 31.3 steps/s
[Step= 500] | Loss=5.53852 | acc=0.1470 | tpr=0.5383 | fpr=0.8600 | 7823.5 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.53951 | acc=0.1472 | tpr=0.5420 | fpr=0.8600 | 14408.3 samples/s | 56.3 steps/s
Avg test loss: 5.54028, Avg test acc: 0.14710, Avg tpr: 0.54160, Avg fpr: 0.86007, total FA: 119419

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.16530 | acc=0.9777 | tpr=0.9248 | fpr=0.0214 | 4284.0 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.17885 | acc=0.9770 | tpr=0.9446 | fpr=0.0224 | 7462.7 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.18597 | acc=0.9758 | tpr=0.9452 | fpr=0.0237 | 7697.6 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.18713 | acc=0.9759 | tpr=0.9454 | fpr=0.0236 | 8308.3 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.18435 | acc=0.9760 | tpr=0.9476 | fpr=0.0235 | 7601.2 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.18670 | acc=0.9756 | tpr=0.9498 | fpr=0.0239 | 7992.8 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.18693 | acc=0.9755 | tpr=0.9499 | fpr=0.0240 | 8031.4 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.18886 | acc=0.9753 | tpr=0.9464 | fpr=0.0242 | 7464.1 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.19178 | acc=0.9749 | tpr=0.9440 | fpr=0.0245 | 7951.9 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.19056 | acc=0.9751 | tpr=0.9441 | fpr=0.0243 | 7806.4 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.18951 | acc=0.9753 | tpr=0.9435 | fpr=0.0241 | 14266.2 samples/s | 55.7 steps/s
Avg test loss: 0.18901, Avg test acc: 0.97537, Avg tpr: 0.94334, Avg fpr: 0.02405, total FA: 3339

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12624 | acc=0.9787 | tpr=0.9292 | fpr=0.0204 | 4152.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.13642 | acc=0.9777 | tpr=0.9446 | fpr=0.0216 | 8032.1 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.14074 | acc=0.9769 | tpr=0.9524 | fpr=0.0227 | 7660.5 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.14201 | acc=0.9768 | tpr=0.9552 | fpr=0.0228 | 8117.4 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.14120 | acc=0.9769 | tpr=0.9572 | fpr=0.0228 | 7666.7 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.14445 | acc=0.9764 | tpr=0.9571 | fpr=0.0233 | 7862.0 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.14550 | acc=0.9764 | tpr=0.9574 | fpr=0.0232 | 8200.1 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.14634 | acc=0.9763 | tpr=0.9557 | fpr=0.0234 | 7610.5 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.14839 | acc=0.9760 | tpr=0.9542 | fpr=0.0237 | 7900.1 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.14750 | acc=0.9760 | tpr=0.9559 | fpr=0.0236 | 7863.6 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.14657 | acc=0.9762 | tpr=0.9550 | fpr=0.0235 | 14372.1 samples/s | 56.1 steps/s
Avg test loss: 0.14622, Avg test acc: 0.97620, Avg tpr: 0.95523, Avg fpr: 0.02342, total FA: 3252

server round 11/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=42.9] | Loss=0.03399 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.595 | L2-Norm(final)=13.610 | 4093.1 samples/s | 64.0 steps/s
[Step=22050 Epoch=43.0] | Loss=0.03921 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.599 | L2-Norm(final)=13.614 | 5574.9 samples/s | 87.1 steps/s
[Step=22100 Epoch=43.1] | Loss=0.03743 | Reg=0.00185 | acc=0.9531 | L2-Norm=13.600 | L2-Norm(final)=13.617 | 5327.8 samples/s | 83.2 steps/s
[Step=22150 Epoch=43.2] | Loss=0.03551 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.600 | L2-Norm(final)=13.625 | 5536.0 samples/s | 86.5 steps/s
[Step=22200 Epoch=43.3] | Loss=0.03539 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.600 | L2-Norm(final)=13.637 | 5666.1 samples/s | 88.5 steps/s
[Step=22250 Epoch=43.4] | Loss=0.03542 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.601 | L2-Norm(final)=13.650 | 5501.6 samples/s | 86.0 steps/s
[Step=22300 Epoch=43.5] | Loss=0.03499 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.601 | L2-Norm(final)=13.664 | 5508.0 samples/s | 86.1 steps/s
[Step=22350 Epoch=43.6] | Loss=0.03476 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.601 | L2-Norm(final)=13.679 | 5450.6 samples/s | 85.2 steps/s
[Step=22400 Epoch=43.7] | Loss=0.03459 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.601 | L2-Norm(final)=13.694 | 5641.8 samples/s | 88.2 steps/s
[Step=22450 Epoch=43.8] | Loss=0.03424 | Reg=0.00185 | acc=0.9531 | L2-Norm=13.601 | L2-Norm(final)=13.710 | 5651.8 samples/s | 88.3 steps/s
[Step=22500 Epoch=43.9] | Loss=0.03432 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.601 | L2-Norm(final)=13.726 | 6958.7 samples/s | 108.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=43.9] | Loss=0.01459 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.601 | L2-Norm(final)=13.882 | 4707.5 samples/s | 73.6 steps/s
[Step=22550 Epoch=44.0] | Loss=0.02766 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.652 | L2-Norm(final)=13.888 | 4521.4 samples/s | 70.6 steps/s
[Step=22600 Epoch=44.1] | Loss=0.02803 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.701 | L2-Norm(final)=13.885 | 4806.8 samples/s | 75.1 steps/s
[Step=22650 Epoch=44.2] | Loss=0.02789 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.737 | L2-Norm(final)=13.880 | 4829.1 samples/s | 75.5 steps/s
[Step=22700 Epoch=44.3] | Loss=0.02724 | Reg=0.00190 | acc=0.9531 | L2-Norm=13.767 | L2-Norm(final)=13.877 | 4801.7 samples/s | 75.0 steps/s
[Step=22750 Epoch=44.4] | Loss=0.02679 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.795 | L2-Norm(final)=13.874 | 4837.3 samples/s | 75.6 steps/s
[Step=22800 Epoch=44.5] | Loss=0.02684 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.819 | L2-Norm(final)=13.871 | 4799.3 samples/s | 75.0 steps/s
[Step=22850 Epoch=44.6] | Loss=0.02611 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.840 | L2-Norm(final)=13.869 | 4768.9 samples/s | 74.5 steps/s
[Step=22900 Epoch=44.7] | Loss=0.02563 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.858 | L2-Norm(final)=13.868 | 4823.2 samples/s | 75.4 steps/s
[Step=22950 Epoch=44.8] | Loss=0.02497 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.874 | L2-Norm(final)=13.867 | 4799.0 samples/s | 75.0 steps/s
[Step=23000 Epoch=44.9] | Loss=0.02500 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.890 | L2-Norm(final)=13.867 | 5840.0 samples/s | 91.3 steps/s
[Step=23050 Epoch=45.0] | Loss=0.02409 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.905 | L2-Norm(final)=13.865 | 2087.1 samples/s | 32.6 steps/s
[Step=23100 Epoch=45.1] | Loss=0.02323 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.919 | L2-Norm(final)=13.865 | 4784.4 samples/s | 74.8 steps/s
[Step=23150 Epoch=45.2] | Loss=0.02255 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.932 | L2-Norm(final)=13.864 | 4793.8 samples/s | 74.9 steps/s
[Step=23200 Epoch=45.2] | Loss=0.02199 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.944 | L2-Norm(final)=13.864 | 4793.3 samples/s | 74.9 steps/s
[Step=23250 Epoch=45.3] | Loss=0.02169 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.956 | L2-Norm(final)=13.864 | 4778.1 samples/s | 74.7 steps/s
[Step=23300 Epoch=45.4] | Loss=0.02124 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.968 | L2-Norm(final)=13.864 | 4810.4 samples/s | 75.2 steps/s
[Step=23350 Epoch=45.5] | Loss=0.02090 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.979 | L2-Norm(final)=13.864 | 4772.3 samples/s | 74.6 steps/s
[Step=23400 Epoch=45.6] | Loss=0.02051 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.991 | L2-Norm(final)=13.865 | 4801.7 samples/s | 75.0 steps/s
[Step=23450 Epoch=45.7] | Loss=0.02019 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.001 | L2-Norm(final)=13.865 | 4831.6 samples/s | 75.5 steps/s
[Step=23500 Epoch=45.8] | Loss=0.01990 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.011 | L2-Norm(final)=13.866 | 5081.0 samples/s | 79.4 steps/s
[Step=23550 Epoch=45.9] | Loss=0.01973 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.021 | L2-Norm(final)=13.867 | 2138.0 samples/s | 33.4 steps/s
[Step=23600 Epoch=46.0] | Loss=0.01933 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.030 | L2-Norm(final)=13.867 | 4768.7 samples/s | 74.5 steps/s
[Step=23650 Epoch=46.1] | Loss=0.01900 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.039 | L2-Norm(final)=13.867 | 4799.1 samples/s | 75.0 steps/s
[Step=23700 Epoch=46.2] | Loss=0.01866 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.048 | L2-Norm(final)=13.868 | 4732.6 samples/s | 73.9 steps/s
[Step=23750 Epoch=46.3] | Loss=0.01830 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.057 | L2-Norm(final)=13.869 | 4814.7 samples/s | 75.2 steps/s
[Step=23800 Epoch=46.4] | Loss=0.01815 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.065 | L2-Norm(final)=13.869 | 4790.3 samples/s | 74.8 steps/s
[Step=23850 Epoch=46.5] | Loss=0.01794 | Reg=0.00198 | acc=0.9531 | L2-Norm=14.073 | L2-Norm(final)=13.870 | 4752.1 samples/s | 74.3 steps/s
[Step=23900 Epoch=46.6] | Loss=0.01777 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.081 | L2-Norm(final)=13.870 | 4778.3 samples/s | 74.7 steps/s
[Step=23950 Epoch=46.7] | Loss=0.01759 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=13.870 | 4835.5 samples/s | 75.6 steps/s
[Step=24000 Epoch=46.8] | Loss=0.01756 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.097 | L2-Norm(final)=13.871 | 4834.6 samples/s | 75.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step24000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=43.0] | Loss=0.02874 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.595 | L2-Norm(final)=14.107 | 4579.4 samples/s | 71.6 steps/s
[Step=22050 Epoch=43.1] | Loss=0.03509 | Reg=0.00185 | acc=0.9219 | L2-Norm=13.597 | L2-Norm(final)=14.111 | 5090.6 samples/s | 79.5 steps/s
[Step=22100 Epoch=43.2] | Loss=0.03457 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.597 | L2-Norm(final)=14.123 | 5486.5 samples/s | 85.7 steps/s
[Step=22150 Epoch=43.3] | Loss=0.03391 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.597 | L2-Norm(final)=14.138 | 5544.0 samples/s | 86.6 steps/s
[Step=22200 Epoch=43.4] | Loss=0.03349 | Reg=0.00185 | acc=0.9531 | L2-Norm=13.597 | L2-Norm(final)=14.154 | 5454.3 samples/s | 85.2 steps/s
[Step=22250 Epoch=43.5] | Loss=0.03412 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.597 | L2-Norm(final)=14.171 | 5459.3 samples/s | 85.3 steps/s
[Step=22300 Epoch=43.6] | Loss=0.03479 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.597 | L2-Norm(final)=14.187 | 5557.5 samples/s | 86.8 steps/s
[Step=22350 Epoch=43.7] | Loss=0.03504 | Reg=0.00185 | acc=0.9531 | L2-Norm=13.597 | L2-Norm(final)=14.202 | 5528.4 samples/s | 86.4 steps/s
[Step=22400 Epoch=43.8] | Loss=0.03508 | Reg=0.00185 | acc=0.9531 | L2-Norm=13.597 | L2-Norm(final)=14.216 | 5620.0 samples/s | 87.8 steps/s
[Step=22450 Epoch=43.9] | Loss=0.03529 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.597 | L2-Norm(final)=14.231 | 5629.3 samples/s | 88.0 steps/s
[Step=22500 Epoch=44.0] | Loss=0.03552 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.597 | L2-Norm(final)=14.246 | 6986.2 samples/s | 109.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=44.0] | Loss=0.04069 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.597 | L2-Norm(final)=14.395 | 4923.1 samples/s | 76.9 steps/s
[Step=22550 Epoch=44.1] | Loss=0.03368 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.654 | L2-Norm(final)=14.396 | 4309.7 samples/s | 67.3 steps/s
[Step=22600 Epoch=44.2] | Loss=0.02956 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.706 | L2-Norm(final)=14.390 | 4750.1 samples/s | 74.2 steps/s
[Step=22650 Epoch=44.3] | Loss=0.03094 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.745 | L2-Norm(final)=14.386 | 4776.9 samples/s | 74.6 steps/s
[Step=22700 Epoch=44.4] | Loss=0.02897 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.776 | L2-Norm(final)=14.382 | 4750.3 samples/s | 74.2 steps/s
[Step=22750 Epoch=44.5] | Loss=0.02769 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.800 | L2-Norm(final)=14.379 | 4801.7 samples/s | 75.0 steps/s
[Step=22800 Epoch=44.6] | Loss=0.02765 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.821 | L2-Norm(final)=14.377 | 4794.5 samples/s | 74.9 steps/s
[Step=22850 Epoch=44.7] | Loss=0.02701 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.841 | L2-Norm(final)=14.375 | 4796.9 samples/s | 75.0 steps/s
[Step=22900 Epoch=44.8] | Loss=0.02575 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.860 | L2-Norm(final)=14.374 | 4778.3 samples/s | 74.7 steps/s
[Step=22950 Epoch=44.9] | Loss=0.02533 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.878 | L2-Norm(final)=14.372 | 4765.3 samples/s | 74.5 steps/s
[Step=23000 Epoch=45.0] | Loss=0.02465 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.894 | L2-Norm(final)=14.371 | 5806.5 samples/s | 90.7 steps/s
[Step=23050 Epoch=45.1] | Loss=0.02404 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.910 | L2-Norm(final)=14.370 | 2041.2 samples/s | 31.9 steps/s
[Step=23100 Epoch=45.2] | Loss=0.02300 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.925 | L2-Norm(final)=14.370 | 4746.6 samples/s | 74.2 steps/s
[Step=23150 Epoch=45.3] | Loss=0.02218 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.939 | L2-Norm(final)=14.370 | 4760.1 samples/s | 74.4 steps/s
[Step=23200 Epoch=45.4] | Loss=0.02165 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.951 | L2-Norm(final)=14.369 | 4797.0 samples/s | 75.0 steps/s
[Step=23250 Epoch=45.5] | Loss=0.02120 | Reg=0.00195 | acc=0.9531 | L2-Norm=13.962 | L2-Norm(final)=14.369 | 4773.5 samples/s | 74.6 steps/s
[Step=23300 Epoch=45.6] | Loss=0.02098 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.973 | L2-Norm(final)=14.368 | 4688.0 samples/s | 73.2 steps/s
[Step=23350 Epoch=45.6] | Loss=0.02081 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.985 | L2-Norm(final)=14.368 | 4833.4 samples/s | 75.5 steps/s
[Step=23400 Epoch=45.7] | Loss=0.02067 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.995 | L2-Norm(final)=14.367 | 4704.7 samples/s | 73.5 steps/s
[Step=23450 Epoch=45.8] | Loss=0.02038 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.006 | L2-Norm(final)=14.366 | 4784.5 samples/s | 74.8 steps/s
[Step=23500 Epoch=45.9] | Loss=0.02017 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.015 | L2-Norm(final)=14.366 | 5169.3 samples/s | 80.8 steps/s
[Step=23550 Epoch=46.0] | Loss=0.01973 | Reg=0.00197 | acc=0.9531 | L2-Norm=14.024 | L2-Norm(final)=14.365 | 2208.3 samples/s | 34.5 steps/s
[Step=23600 Epoch=46.1] | Loss=0.01936 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.033 | L2-Norm(final)=14.365 | 4771.2 samples/s | 74.5 steps/s
[Step=23650 Epoch=46.2] | Loss=0.01908 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.041 | L2-Norm(final)=14.365 | 4704.4 samples/s | 73.5 steps/s
[Step=23700 Epoch=46.3] | Loss=0.01872 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.049 | L2-Norm(final)=14.365 | 4802.1 samples/s | 75.0 steps/s
[Step=23750 Epoch=46.4] | Loss=0.01840 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.056 | L2-Norm(final)=14.365 | 4733.9 samples/s | 74.0 steps/s
[Step=23800 Epoch=46.5] | Loss=0.01824 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.063 | L2-Norm(final)=14.365 | 4826.9 samples/s | 75.4 steps/s
[Step=23850 Epoch=46.6] | Loss=0.01815 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.070 | L2-Norm(final)=14.365 | 4760.6 samples/s | 74.4 steps/s
[Step=23900 Epoch=46.7] | Loss=0.01796 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.077 | L2-Norm(final)=14.365 | 4790.5 samples/s | 74.9 steps/s
[Step=23950 Epoch=46.8] | Loss=0.01785 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.084 | L2-Norm(final)=14.365 | 4786.3 samples/s | 74.8 steps/s
[Step=24000 Epoch=46.9] | Loss=0.01765 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.091 | L2-Norm(final)=14.365 | 4731.3 samples/s | 73.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step24000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=84.3] | Loss=0.00002 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.595 | L2-Norm(final)=14.080 | 5060.4 samples/s | 79.1 steps/s
[Step=22050 Epoch=84.5] | Loss=0.00273 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.591 | L2-Norm(final)=14.080 | 4421.3 samples/s | 69.1 steps/s
[Step=22100 Epoch=84.7] | Loss=0.00208 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.591 | L2-Norm(final)=14.081 | 5187.7 samples/s | 81.1 steps/s
[Step=22150 Epoch=84.9] | Loss=0.00213 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.591 | L2-Norm(final)=14.084 | 5141.8 samples/s | 80.3 steps/s
[Step=22200 Epoch=85.1] | Loss=0.00205 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.591 | L2-Norm(final)=14.085 | 5170.5 samples/s | 80.8 steps/s
[Step=22250 Epoch=85.3] | Loss=0.00173 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=14.089 | 6881.8 samples/s | 107.5 steps/s
[Step=22300 Epoch=85.4] | Loss=0.00168 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=14.093 | 2132.1 samples/s | 33.3 steps/s
[Step=22350 Epoch=85.6] | Loss=0.00183 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=14.097 | 5142.1 samples/s | 80.3 steps/s
[Step=22400 Epoch=85.8] | Loss=0.00168 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=14.101 | 5234.2 samples/s | 81.8 steps/s
[Step=22450 Epoch=86.0] | Loss=0.00162 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=14.105 | 5228.5 samples/s | 81.7 steps/s
[Step=22500 Epoch=86.2] | Loss=0.00154 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=14.109 | 5791.3 samples/s | 90.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=86.2] | Loss=0.00003 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=14.153 | 4543.4 samples/s | 71.0 steps/s
[Step=22550 Epoch=86.4] | Loss=0.00430 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.588 | L2-Norm(final)=14.151 | 4217.8 samples/s | 65.9 steps/s
[Step=22600 Epoch=86.6] | Loss=0.00342 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.653 | L2-Norm(final)=14.141 | 4585.8 samples/s | 71.7 steps/s
[Step=22650 Epoch=86.8] | Loss=0.00250 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.691 | L2-Norm(final)=14.138 | 4567.3 samples/s | 71.4 steps/s
[Step=22700 Epoch=87.0] | Loss=0.00198 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.705 | L2-Norm(final)=14.139 | 4561.2 samples/s | 71.3 steps/s
[Step=22750 Epoch=87.2] | Loss=0.00159 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.710 | L2-Norm(final)=14.140 | 5739.0 samples/s | 89.7 steps/s
[Step=22800 Epoch=87.4] | Loss=0.00133 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.708 | L2-Norm(final)=14.141 | 2001.4 samples/s | 31.3 steps/s
[Step=22850 Epoch=87.6] | Loss=0.00115 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=14.142 | 4575.1 samples/s | 71.5 steps/s
[Step=22900 Epoch=87.7] | Loss=0.00102 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=14.143 | 4653.9 samples/s | 72.7 steps/s
[Step=22950 Epoch=87.9] | Loss=0.00091 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.692 | L2-Norm(final)=14.145 | 4454.3 samples/s | 69.6 steps/s
[Step=23000 Epoch=88.1] | Loss=0.00082 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=14.146 | 5027.8 samples/s | 78.6 steps/s
[Step=23050 Epoch=88.3] | Loss=0.00074 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.676 | L2-Norm(final)=14.147 | 2079.4 samples/s | 32.5 steps/s
[Step=23100 Epoch=88.5] | Loss=0.00068 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.666 | L2-Norm(final)=14.147 | 4614.7 samples/s | 72.1 steps/s
[Step=23150 Epoch=88.7] | Loss=0.00063 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.657 | L2-Norm(final)=14.148 | 4593.5 samples/s | 71.8 steps/s
[Step=23200 Epoch=88.9] | Loss=0.00059 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.647 | L2-Norm(final)=14.149 | 4589.4 samples/s | 71.7 steps/s
[Step=23250 Epoch=89.1] | Loss=0.00055 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.637 | L2-Norm(final)=14.150 | 4551.2 samples/s | 71.1 steps/s
[Step=23300 Epoch=89.3] | Loss=0.00051 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.626 | L2-Norm(final)=14.150 | 2190.9 samples/s | 34.2 steps/s
[Step=23350 Epoch=89.5] | Loss=0.00048 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=14.151 | 4693.4 samples/s | 73.3 steps/s
[Step=23400 Epoch=89.7] | Loss=0.00046 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.604 | L2-Norm(final)=14.152 | 4555.6 samples/s | 71.2 steps/s
[Step=23450 Epoch=89.9] | Loss=0.00043 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.594 | L2-Norm(final)=14.152 | 4498.8 samples/s | 70.3 steps/s
[Step=23500 Epoch=90.0] | Loss=0.00041 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.582 | L2-Norm(final)=14.153 | 4567.2 samples/s | 71.4 steps/s
[Step=23550 Epoch=90.2] | Loss=0.00039 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.571 | L2-Norm(final)=14.153 | 2232.7 samples/s | 34.9 steps/s
[Step=23600 Epoch=90.4] | Loss=0.00037 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.560 | L2-Norm(final)=14.154 | 4529.7 samples/s | 70.8 steps/s
[Step=23650 Epoch=90.6] | Loss=0.00036 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.549 | L2-Norm(final)=14.154 | 4557.9 samples/s | 71.2 steps/s
[Step=23700 Epoch=90.8] | Loss=0.00034 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.537 | L2-Norm(final)=14.155 | 4568.6 samples/s | 71.4 steps/s
[Step=23750 Epoch=91.0] | Loss=0.00033 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.526 | L2-Norm(final)=14.155 | 4541.9 samples/s | 71.0 steps/s
[Step=23800 Epoch=91.2] | Loss=0.00032 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.514 | L2-Norm(final)=14.156 | 6191.1 samples/s | 96.7 steps/s
[Step=23850 Epoch=91.4] | Loss=0.00030 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.503 | L2-Norm(final)=14.156 | 1970.6 samples/s | 30.8 steps/s
[Step=23900 Epoch=91.6] | Loss=0.00029 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.491 | L2-Norm(final)=14.156 | 4559.0 samples/s | 71.2 steps/s
[Step=23950 Epoch=91.8] | Loss=0.00028 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=14.157 | 4561.1 samples/s | 71.3 steps/s
[Step=24000 Epoch=92.0] | Loss=0.00027 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.467 | L2-Norm(final)=14.157 | 4557.2 samples/s | 71.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step24000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=84.7] | Loss=0.00118 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.595 | L2-Norm(final)=15.272 | 4663.5 samples/s | 72.9 steps/s
[Step=22050 Epoch=84.9] | Loss=0.00287 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.592 | L2-Norm(final)=15.277 | 4726.1 samples/s | 73.8 steps/s
[Step=22100 Epoch=85.1] | Loss=0.00262 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.591 | L2-Norm(final)=15.285 | 5273.6 samples/s | 82.4 steps/s
[Step=22150 Epoch=85.3] | Loss=0.00309 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.591 | L2-Norm(final)=15.290 | 5270.6 samples/s | 82.4 steps/s
[Step=22200 Epoch=85.5] | Loss=0.00254 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.591 | L2-Norm(final)=15.294 | 5194.4 samples/s | 81.2 steps/s
[Step=22250 Epoch=85.6] | Loss=0.00242 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.591 | L2-Norm(final)=15.300 | 6930.1 samples/s | 108.3 steps/s
[Step=22300 Epoch=85.8] | Loss=0.00229 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.591 | L2-Norm(final)=15.306 | 2129.5 samples/s | 33.3 steps/s
[Step=22350 Epoch=86.0] | Loss=0.00220 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.591 | L2-Norm(final)=15.312 | 5199.3 samples/s | 81.2 steps/s
[Step=22400 Epoch=86.2] | Loss=0.00206 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.591 | L2-Norm(final)=15.317 | 5174.4 samples/s | 80.8 steps/s
[Step=22450 Epoch=86.4] | Loss=0.00222 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.591 | L2-Norm(final)=15.323 | 5264.4 samples/s | 82.3 steps/s
[Step=22500 Epoch=86.6] | Loss=0.00216 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.591 | L2-Norm(final)=15.329 | 5975.0 samples/s | 93.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=86.6] | Loss=0.00000 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.591 | L2-Norm(final)=15.390 | 4471.0 samples/s | 69.9 steps/s
[Step=22550 Epoch=86.8] | Loss=0.00218 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=15.392 | 4364.0 samples/s | 68.2 steps/s
[Step=22600 Epoch=87.0] | Loss=0.00144 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=15.394 | 4565.9 samples/s | 71.3 steps/s
[Step=22650 Epoch=87.2] | Loss=0.00099 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.633 | L2-Norm(final)=15.398 | 4583.7 samples/s | 71.6 steps/s
[Step=22700 Epoch=87.4] | Loss=0.00075 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.631 | L2-Norm(final)=15.401 | 4540.8 samples/s | 70.9 steps/s
[Step=22750 Epoch=87.6] | Loss=0.00094 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.625 | L2-Norm(final)=15.404 | 5758.5 samples/s | 90.0 steps/s
[Step=22800 Epoch=87.8] | Loss=0.00171 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.639 | L2-Norm(final)=15.400 | 1930.0 samples/s | 30.2 steps/s
[Step=22850 Epoch=88.0] | Loss=0.00193 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.668 | L2-Norm(final)=15.393 | 4634.3 samples/s | 72.4 steps/s
[Step=22900 Epoch=88.2] | Loss=0.00180 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.696 | L2-Norm(final)=15.387 | 4502.5 samples/s | 70.4 steps/s
[Step=22950 Epoch=88.3] | Loss=0.00192 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.719 | L2-Norm(final)=15.382 | 4565.5 samples/s | 71.3 steps/s
[Step=23000 Epoch=88.5] | Loss=0.00175 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=15.377 | 5159.4 samples/s | 80.6 steps/s
[Step=23050 Epoch=88.7] | Loss=0.00159 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.756 | L2-Norm(final)=15.374 | 2090.6 samples/s | 32.7 steps/s
[Step=23100 Epoch=88.9] | Loss=0.00146 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.768 | L2-Norm(final)=15.371 | 4604.2 samples/s | 71.9 steps/s
[Step=23150 Epoch=89.1] | Loss=0.00135 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.777 | L2-Norm(final)=15.368 | 4503.1 samples/s | 70.4 steps/s
[Step=23200 Epoch=89.3] | Loss=0.00126 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.783 | L2-Norm(final)=15.366 | 4556.9 samples/s | 71.2 steps/s
[Step=23250 Epoch=89.5] | Loss=0.00118 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.787 | L2-Norm(final)=15.364 | 4658.6 samples/s | 72.8 steps/s
[Step=23300 Epoch=89.7] | Loss=0.00110 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.789 | L2-Norm(final)=15.363 | 2189.1 samples/s | 34.2 steps/s
[Step=23350 Epoch=89.9] | Loss=0.00104 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.791 | L2-Norm(final)=15.362 | 4666.7 samples/s | 72.9 steps/s
[Step=23400 Epoch=90.1] | Loss=0.00098 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.791 | L2-Norm(final)=15.361 | 4589.6 samples/s | 71.7 steps/s
[Step=23450 Epoch=90.3] | Loss=0.00093 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.790 | L2-Norm(final)=15.361 | 4548.2 samples/s | 71.1 steps/s
[Step=23500 Epoch=90.5] | Loss=0.00088 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.788 | L2-Norm(final)=15.361 | 4529.8 samples/s | 70.8 steps/s
[Step=23550 Epoch=90.7] | Loss=0.00084 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=15.361 | 2197.7 samples/s | 34.3 steps/s
[Step=23600 Epoch=90.8] | Loss=0.00080 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.782 | L2-Norm(final)=15.361 | 4614.8 samples/s | 72.1 steps/s
[Step=23650 Epoch=91.0] | Loss=0.00077 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.778 | L2-Norm(final)=15.361 | 4584.1 samples/s | 71.6 steps/s
[Step=23700 Epoch=91.2] | Loss=0.00074 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.774 | L2-Norm(final)=15.361 | 4530.2 samples/s | 70.8 steps/s
[Step=23750 Epoch=91.4] | Loss=0.00071 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.770 | L2-Norm(final)=15.361 | 4563.3 samples/s | 71.3 steps/s
[Step=23800 Epoch=91.6] | Loss=0.00068 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.765 | L2-Norm(final)=15.362 | 6637.6 samples/s | 103.7 steps/s
[Step=23850 Epoch=91.8] | Loss=0.00066 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.759 | L2-Norm(final)=15.362 | 1913.9 samples/s | 29.9 steps/s
[Step=23900 Epoch=92.0] | Loss=0.00063 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.754 | L2-Norm(final)=15.362 | 4578.0 samples/s | 71.5 steps/s
[Step=23950 Epoch=92.2] | Loss=0.00061 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.748 | L2-Norm(final)=15.363 | 4555.6 samples/s | 71.2 steps/s
[Step=24000 Epoch=92.4] | Loss=0.00059 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.742 | L2-Norm(final)=15.363 | 4540.3 samples/s | 70.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07016 | acc=0.9650 | tpr=0.9727 | fpr=0.0518 | 4206.9 samples/s | 16.4 steps/s
Avg test loss: 0.06709, Avg test acc: 0.96494, Avg tpr: 0.97342, Avg fpr: 0.05371, total FA: 419

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06846 | acc=0.9656 | tpr=0.9701 | fpr=0.0441 | 4156.4 samples/s | 16.2 steps/s
Avg test loss: 0.06767, Avg test acc: 0.96542, Avg tpr: 0.97109, Avg fpr: 0.04705, total FA: 367

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=8.12555 | acc=0.3114 | tpr=0.0030 | fpr=0.0188 | 4156.5 samples/s | 16.2 steps/s
Avg test loss: 8.15341, Avg test acc: 0.30904, Avg tpr: 0.00332, Avg fpr: 0.01859, total FA: 145

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=8.71898 | acc=0.3081 | tpr=0.0098 | fpr=0.0441 | 4198.4 samples/s | 16.4 steps/s
Avg test loss: 8.73610, Avg test acc: 0.30523, Avg tpr: 0.00938, Avg fpr: 0.04410, total FA: 344

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.47729 | acc=0.1298 | tpr=0.5177 | fpr=0.8772 | 4165.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=5.42495 | acc=0.1302 | tpr=0.5181 | fpr=0.8770 | 7914.6 samples/s | 30.9 steps/s
[Step= 150] | Loss=5.43010 | acc=0.1301 | tpr=0.5346 | fpr=0.8773 | 7616.2 samples/s | 29.8 steps/s
[Step= 200] | Loss=5.42252 | acc=0.1295 | tpr=0.5311 | fpr=0.8778 | 7906.5 samples/s | 30.9 steps/s
[Step= 250] | Loss=5.41448 | acc=0.1297 | tpr=0.5205 | fpr=0.8774 | 7850.7 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.41527 | acc=0.1292 | tpr=0.5244 | fpr=0.8780 | 8069.9 samples/s | 31.5 steps/s
[Step= 350] | Loss=5.42174 | acc=0.1285 | tpr=0.5241 | fpr=0.8787 | 7980.6 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.41288 | acc=0.1285 | tpr=0.5197 | fpr=0.8786 | 8016.2 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.41605 | acc=0.1283 | tpr=0.5166 | fpr=0.8788 | 7586.9 samples/s | 29.6 steps/s
[Step= 500] | Loss=5.41645 | acc=0.1283 | tpr=0.5194 | fpr=0.8788 | 7692.8 samples/s | 30.1 steps/s
[Step= 550] | Loss=5.41701 | acc=0.1286 | tpr=0.5249 | fpr=0.8786 | 14517.3 samples/s | 56.7 steps/s
Avg test loss: 5.41824, Avg test acc: 0.12854, Avg tpr: 0.52456, Avg fpr: 0.87866, total FA: 122000

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.21708 | acc=0.1360 | tpr=0.4690 | fpr=0.8700 | 4185.6 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.16554 | acc=0.1376 | tpr=0.4691 | fpr=0.8686 | 7781.3 samples/s | 30.4 steps/s
[Step= 150] | Loss=6.17726 | acc=0.1370 | tpr=0.4726 | fpr=0.8692 | 8040.5 samples/s | 31.4 steps/s
[Step= 200] | Loss=6.16726 | acc=0.1371 | tpr=0.4667 | fpr=0.8689 | 7630.9 samples/s | 29.8 steps/s
[Step= 250] | Loss=6.15996 | acc=0.1371 | tpr=0.4594 | fpr=0.8688 | 7999.1 samples/s | 31.2 steps/s
[Step= 300] | Loss=6.15700 | acc=0.1370 | tpr=0.4604 | fpr=0.8689 | 7881.3 samples/s | 30.8 steps/s
[Step= 350] | Loss=6.16141 | acc=0.1362 | tpr=0.4540 | fpr=0.8695 | 7821.3 samples/s | 30.6 steps/s
[Step= 400] | Loss=6.15462 | acc=0.1362 | tpr=0.4458 | fpr=0.8695 | 7970.3 samples/s | 31.1 steps/s
[Step= 450] | Loss=6.15880 | acc=0.1359 | tpr=0.4455 | fpr=0.8697 | 7801.7 samples/s | 30.5 steps/s
[Step= 500] | Loss=6.15902 | acc=0.1360 | tpr=0.4502 | fpr=0.8697 | 7737.7 samples/s | 30.2 steps/s
[Step= 550] | Loss=6.16113 | acc=0.1361 | tpr=0.4513 | fpr=0.8697 | 14782.4 samples/s | 57.7 steps/s
Avg test loss: 6.16182, Avg test acc: 0.13602, Avg tpr: 0.45127, Avg fpr: 0.86971, total FA: 120758

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14307 | acc=0.9805 | tpr=0.9336 | fpr=0.0187 | 4073.2 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.15382 | acc=0.9795 | tpr=0.9424 | fpr=0.0198 | 7797.0 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.15747 | acc=0.9792 | tpr=0.9452 | fpr=0.0202 | 7738.1 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.15990 | acc=0.9794 | tpr=0.9486 | fpr=0.0201 | 7937.5 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.15788 | acc=0.9796 | tpr=0.9493 | fpr=0.0199 | 7718.8 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.16054 | acc=0.9791 | tpr=0.9484 | fpr=0.0204 | 8128.8 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.16059 | acc=0.9791 | tpr=0.9480 | fpr=0.0203 | 7710.2 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.16219 | acc=0.9788 | tpr=0.9464 | fpr=0.0206 | 8182.7 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.16404 | acc=0.9787 | tpr=0.9460 | fpr=0.0207 | 7401.5 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.16302 | acc=0.9789 | tpr=0.9467 | fpr=0.0206 | 7587.0 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.16202 | acc=0.9790 | tpr=0.9447 | fpr=0.0204 | 14249.7 samples/s | 55.7 steps/s
Avg test loss: 0.16167, Avg test acc: 0.97899, Avg tpr: 0.94493, Avg fpr: 0.02039, total FA: 2831

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16934 | acc=0.9784 | tpr=0.9204 | fpr=0.0205 | 4181.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.18262 | acc=0.9774 | tpr=0.9382 | fpr=0.0219 | 7593.5 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.18546 | acc=0.9769 | tpr=0.9481 | fpr=0.0226 | 7853.5 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.18665 | acc=0.9768 | tpr=0.9519 | fpr=0.0227 | 7994.3 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.18498 | acc=0.9767 | tpr=0.9528 | fpr=0.0229 | 7922.7 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.18802 | acc=0.9765 | tpr=0.9535 | fpr=0.0231 | 7924.0 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.18772 | acc=0.9766 | tpr=0.9530 | fpr=0.0230 | 7816.6 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.18913 | acc=0.9766 | tpr=0.9513 | fpr=0.0229 | 7857.0 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.19172 | acc=0.9765 | tpr=0.9499 | fpr=0.0230 | 7755.1 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.19066 | acc=0.9766 | tpr=0.9498 | fpr=0.0229 | 7723.4 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.18941 | acc=0.9768 | tpr=0.9491 | fpr=0.0227 | 14813.1 samples/s | 57.9 steps/s
Avg test loss: 0.18896, Avg test acc: 0.97684, Avg tpr: 0.94889, Avg fpr: 0.02265, total FA: 3145

server round 12/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=24001 Epoch=46.8] | Loss=0.05177 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.483 | L2-Norm(final)=13.880 | 4123.3 samples/s | 64.4 steps/s
[Step=24050 Epoch=46.9] | Loss=0.03373 | Reg=0.00182 | acc=0.9375 | L2-Norm=13.488 | L2-Norm(final)=13.890 | 4809.9 samples/s | 75.2 steps/s
[Step=24100 Epoch=47.0] | Loss=0.03231 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.489 | L2-Norm(final)=13.908 | 5566.1 samples/s | 87.0 steps/s
[Step=24150 Epoch=47.1] | Loss=0.03127 | Reg=0.00182 | acc=0.9219 | L2-Norm=13.489 | L2-Norm(final)=13.929 | 5422.3 samples/s | 84.7 steps/s
[Step=24200 Epoch=47.2] | Loss=0.03265 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.489 | L2-Norm(final)=13.946 | 5543.0 samples/s | 86.6 steps/s
[Step=24250 Epoch=47.3] | Loss=0.03211 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.489 | L2-Norm(final)=13.963 | 5542.5 samples/s | 86.6 steps/s
[Step=24300 Epoch=47.4] | Loss=0.03185 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.489 | L2-Norm(final)=13.981 | 5629.8 samples/s | 88.0 steps/s
[Step=24350 Epoch=47.5] | Loss=0.03175 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.489 | L2-Norm(final)=13.999 | 5587.4 samples/s | 87.3 steps/s
[Step=24400 Epoch=47.6] | Loss=0.03136 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.489 | L2-Norm(final)=14.017 | 5609.0 samples/s | 87.6 steps/s
[Step=24450 Epoch=47.7] | Loss=0.03128 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.489 | L2-Norm(final)=14.035 | 5412.7 samples/s | 84.6 steps/s
[Step=24500 Epoch=47.8] | Loss=0.03103 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.489 | L2-Norm(final)=14.052 | 6976.9 samples/s | 109.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=47.8] | Loss=0.00977 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.490 | L2-Norm(final)=14.225 | 5046.3 samples/s | 78.8 steps/s
[Step=24550 Epoch=47.9] | Loss=0.03026 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.550 | L2-Norm(final)=14.229 | 4504.9 samples/s | 70.4 steps/s
[Step=24600 Epoch=48.0] | Loss=0.02967 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.601 | L2-Norm(final)=14.224 | 4733.3 samples/s | 74.0 steps/s
[Step=24650 Epoch=48.1] | Loss=0.02836 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.635 | L2-Norm(final)=14.220 | 4821.4 samples/s | 75.3 steps/s
[Step=24700 Epoch=48.2] | Loss=0.02692 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.662 | L2-Norm(final)=14.218 | 4816.9 samples/s | 75.3 steps/s
[Step=24750 Epoch=48.3] | Loss=0.02590 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.687 | L2-Norm(final)=14.216 | 4710.1 samples/s | 73.6 steps/s
[Step=24800 Epoch=48.4] | Loss=0.02469 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.710 | L2-Norm(final)=14.214 | 4814.4 samples/s | 75.2 steps/s
[Step=24850 Epoch=48.5] | Loss=0.02470 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.730 | L2-Norm(final)=14.213 | 4855.1 samples/s | 75.9 steps/s
[Step=24900 Epoch=48.6] | Loss=0.02471 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.751 | L2-Norm(final)=14.211 | 4871.9 samples/s | 76.1 steps/s
[Step=24950 Epoch=48.7] | Loss=0.02475 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.771 | L2-Norm(final)=14.209 | 4764.2 samples/s | 74.4 steps/s
[Step=25000 Epoch=48.8] | Loss=0.02427 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.788 | L2-Norm(final)=14.207 | 5828.9 samples/s | 91.1 steps/s
[Step=25050 Epoch=48.9] | Loss=0.02340 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.805 | L2-Norm(final)=14.206 | 2016.9 samples/s | 31.5 steps/s
[Step=25100 Epoch=49.0] | Loss=0.02270 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.820 | L2-Norm(final)=14.205 | 4766.0 samples/s | 74.5 steps/s
[Step=25150 Epoch=49.1] | Loss=0.02211 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.834 | L2-Norm(final)=14.204 | 4814.7 samples/s | 75.2 steps/s
[Step=25200 Epoch=49.1] | Loss=0.02132 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.847 | L2-Norm(final)=14.203 | 4794.5 samples/s | 74.9 steps/s
[Step=25250 Epoch=49.2] | Loss=0.02081 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.860 | L2-Norm(final)=14.203 | 4799.9 samples/s | 75.0 steps/s
[Step=25300 Epoch=49.3] | Loss=0.02042 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.871 | L2-Norm(final)=14.202 | 4819.6 samples/s | 75.3 steps/s
[Step=25350 Epoch=49.4] | Loss=0.02024 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=14.202 | 4783.4 samples/s | 74.7 steps/s
[Step=25400 Epoch=49.5] | Loss=0.02000 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.892 | L2-Norm(final)=14.201 | 4815.8 samples/s | 75.2 steps/s
[Step=25450 Epoch=49.6] | Loss=0.01967 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.902 | L2-Norm(final)=14.200 | 4786.5 samples/s | 74.8 steps/s
[Step=25500 Epoch=49.7] | Loss=0.01933 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.911 | L2-Norm(final)=14.200 | 5069.2 samples/s | 79.2 steps/s
[Step=25550 Epoch=49.8] | Loss=0.01898 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.920 | L2-Norm(final)=14.200 | 2126.6 samples/s | 33.2 steps/s
[Step=25600 Epoch=49.9] | Loss=0.01865 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.929 | L2-Norm(final)=14.199 | 4787.0 samples/s | 74.8 steps/s
[Step=25650 Epoch=50.0] | Loss=0.01833 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.937 | L2-Norm(final)=14.199 | 4814.0 samples/s | 75.2 steps/s
[Step=25700 Epoch=50.1] | Loss=0.01811 | Reg=0.00195 | acc=0.9531 | L2-Norm=13.945 | L2-Norm(final)=14.199 | 4781.5 samples/s | 74.7 steps/s
[Step=25750 Epoch=50.2] | Loss=0.01784 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.953 | L2-Norm(final)=14.198 | 4859.8 samples/s | 75.9 steps/s
[Step=25800 Epoch=50.3] | Loss=0.01764 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.961 | L2-Norm(final)=14.198 | 4743.3 samples/s | 74.1 steps/s
[Step=25850 Epoch=50.4] | Loss=0.01740 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.968 | L2-Norm(final)=14.197 | 4816.7 samples/s | 75.3 steps/s
[Step=25900 Epoch=50.5] | Loss=0.01715 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.976 | L2-Norm(final)=14.196 | 4827.2 samples/s | 75.4 steps/s
[Step=25950 Epoch=50.6] | Loss=0.01702 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.983 | L2-Norm(final)=14.196 | 4788.5 samples/s | 74.8 steps/s
[Step=26000 Epoch=50.7] | Loss=0.01687 | Reg=0.00196 | acc=0.9531 | L2-Norm=13.990 | L2-Norm(final)=14.196 | 4844.0 samples/s | 75.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step26000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=24001 Epoch=46.9] | Loss=0.04660 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.483 | L2-Norm(final)=14.367 | 4482.4 samples/s | 70.0 steps/s
[Step=24050 Epoch=47.0] | Loss=0.02567 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=14.384 | 5044.2 samples/s | 78.8 steps/s
[Step=24100 Epoch=47.1] | Loss=0.02494 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.484 | L2-Norm(final)=14.405 | 5290.8 samples/s | 82.7 steps/s
[Step=24150 Epoch=47.2] | Loss=0.02679 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.484 | L2-Norm(final)=14.424 | 5368.7 samples/s | 83.9 steps/s
[Step=24200 Epoch=47.3] | Loss=0.02686 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.484 | L2-Norm(final)=14.444 | 5453.6 samples/s | 85.2 steps/s
[Step=24250 Epoch=47.4] | Loss=0.02751 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.484 | L2-Norm(final)=14.464 | 5505.6 samples/s | 86.0 steps/s
[Step=24300 Epoch=47.5] | Loss=0.02713 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.484 | L2-Norm(final)=14.483 | 5429.9 samples/s | 84.8 steps/s
[Step=24350 Epoch=47.6] | Loss=0.02695 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=14.501 | 5508.4 samples/s | 86.1 steps/s
[Step=24400 Epoch=47.7] | Loss=0.02748 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.484 | L2-Norm(final)=14.519 | 5618.5 samples/s | 87.8 steps/s
[Step=24450 Epoch=47.8] | Loss=0.02703 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.484 | L2-Norm(final)=14.537 | 5487.6 samples/s | 85.7 steps/s
[Step=24500 Epoch=47.9] | Loss=0.02737 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.484 | L2-Norm(final)=14.554 | 6990.5 samples/s | 109.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=47.9] | Loss=0.01266 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=14.727 | 4870.4 samples/s | 76.1 steps/s
[Step=24550 Epoch=48.0] | Loss=0.02438 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.546 | L2-Norm(final)=14.728 | 4337.5 samples/s | 67.8 steps/s
[Step=24600 Epoch=48.1] | Loss=0.02539 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.597 | L2-Norm(final)=14.716 | 4777.8 samples/s | 74.7 steps/s
[Step=24650 Epoch=48.2] | Loss=0.02388 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.633 | L2-Norm(final)=14.707 | 4681.0 samples/s | 73.1 steps/s
[Step=24700 Epoch=48.3] | Loss=0.02378 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.662 | L2-Norm(final)=14.701 | 4764.1 samples/s | 74.4 steps/s
[Step=24750 Epoch=48.4] | Loss=0.02331 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.685 | L2-Norm(final)=14.696 | 4752.7 samples/s | 74.3 steps/s
[Step=24800 Epoch=48.5] | Loss=0.02329 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=14.692 | 4761.9 samples/s | 74.4 steps/s
[Step=24850 Epoch=48.6] | Loss=0.02413 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.725 | L2-Norm(final)=14.688 | 4816.8 samples/s | 75.3 steps/s
[Step=24900 Epoch=48.7] | Loss=0.02432 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.743 | L2-Norm(final)=14.684 | 4761.8 samples/s | 74.4 steps/s
[Step=24950 Epoch=48.8] | Loss=0.02430 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.759 | L2-Norm(final)=14.681 | 4751.9 samples/s | 74.2 steps/s
[Step=25000 Epoch=48.9] | Loss=0.02372 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.775 | L2-Norm(final)=14.679 | 5896.3 samples/s | 92.1 steps/s
[Step=25050 Epoch=49.0] | Loss=0.02305 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.790 | L2-Norm(final)=14.677 | 2094.9 samples/s | 32.7 steps/s
[Step=25100 Epoch=49.1] | Loss=0.02252 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.804 | L2-Norm(final)=14.675 | 4750.2 samples/s | 74.2 steps/s
[Step=25150 Epoch=49.2] | Loss=0.02215 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.817 | L2-Norm(final)=14.674 | 4741.3 samples/s | 74.1 steps/s
[Step=25200 Epoch=49.3] | Loss=0.02175 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.828 | L2-Norm(final)=14.673 | 4765.7 samples/s | 74.5 steps/s
[Step=25250 Epoch=49.4] | Loss=0.02131 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.839 | L2-Norm(final)=14.672 | 4830.7 samples/s | 75.5 steps/s
[Step=25300 Epoch=49.5] | Loss=0.02088 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.849 | L2-Norm(final)=14.671 | 4702.6 samples/s | 73.5 steps/s
[Step=25350 Epoch=49.6] | Loss=0.02053 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.859 | L2-Norm(final)=14.670 | 4791.1 samples/s | 74.9 steps/s
[Step=25400 Epoch=49.7] | Loss=0.02001 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.868 | L2-Norm(final)=14.670 | 4745.3 samples/s | 74.1 steps/s
[Step=25450 Epoch=49.8] | Loss=0.01985 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.877 | L2-Norm(final)=14.669 | 4783.2 samples/s | 74.7 steps/s
[Step=25500 Epoch=49.9] | Loss=0.01963 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.885 | L2-Norm(final)=14.669 | 5213.7 samples/s | 81.5 steps/s
[Step=25550 Epoch=49.9] | Loss=0.01921 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.893 | L2-Norm(final)=14.669 | 2195.2 samples/s | 34.3 steps/s
[Step=25600 Epoch=50.0] | Loss=0.01875 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.901 | L2-Norm(final)=14.668 | 4758.4 samples/s | 74.3 steps/s
[Step=25650 Epoch=50.1] | Loss=0.01852 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.908 | L2-Norm(final)=14.668 | 4827.6 samples/s | 75.4 steps/s
[Step=25700 Epoch=50.2] | Loss=0.01817 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.915 | L2-Norm(final)=14.668 | 4717.8 samples/s | 73.7 steps/s
[Step=25750 Epoch=50.3] | Loss=0.01796 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.922 | L2-Norm(final)=14.668 | 4747.0 samples/s | 74.2 steps/s
[Step=25800 Epoch=50.4] | Loss=0.01774 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.928 | L2-Norm(final)=14.668 | 4802.7 samples/s | 75.0 steps/s
[Step=25850 Epoch=50.5] | Loss=0.01754 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.935 | L2-Norm(final)=14.668 | 4766.9 samples/s | 74.5 steps/s
[Step=25900 Epoch=50.6] | Loss=0.01735 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.941 | L2-Norm(final)=14.668 | 4796.2 samples/s | 74.9 steps/s
[Step=25950 Epoch=50.7] | Loss=0.01717 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.948 | L2-Norm(final)=14.669 | 4791.9 samples/s | 74.9 steps/s
[Step=26000 Epoch=50.8] | Loss=0.01696 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.954 | L2-Norm(final)=14.669 | 4825.3 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step26000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=24001 Epoch=92.0] | Loss=0.00009 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.483 | L2-Norm(final)=14.169 | 4724.6 samples/s | 73.8 steps/s
[Step=24050 Epoch=92.2] | Loss=0.00186 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=14.169 | 4554.9 samples/s | 71.2 steps/s
[Step=24100 Epoch=92.3] | Loss=0.00130 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=14.171 | 5206.0 samples/s | 81.3 steps/s
[Step=24150 Epoch=92.5] | Loss=0.00116 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=14.176 | 5294.4 samples/s | 82.7 steps/s
[Step=24200 Epoch=92.7] | Loss=0.00096 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=14.182 | 5087.4 samples/s | 79.5 steps/s
[Step=24250 Epoch=92.9] | Loss=0.00095 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=14.187 | 6818.9 samples/s | 106.5 steps/s
[Step=24300 Epoch=93.1] | Loss=0.00091 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.478 | L2-Norm(final)=14.191 | 2136.5 samples/s | 33.4 steps/s
[Step=24350 Epoch=93.3] | Loss=0.00090 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=14.196 | 5348.3 samples/s | 83.6 steps/s
[Step=24400 Epoch=93.5] | Loss=0.00092 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=14.201 | 5057.9 samples/s | 79.0 steps/s
[Step=24450 Epoch=93.7] | Loss=0.00093 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=14.206 | 5179.4 samples/s | 80.9 steps/s
[Step=24500 Epoch=93.9] | Loss=0.00086 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=14.211 | 5870.6 samples/s | 91.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=93.9] | Loss=0.00003 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=14.255 | 4648.7 samples/s | 72.6 steps/s
[Step=24550 Epoch=94.1] | Loss=0.00085 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.475 | L2-Norm(final)=14.256 | 4155.9 samples/s | 64.9 steps/s
[Step=24600 Epoch=94.3] | Loss=0.00092 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=14.257 | 4553.0 samples/s | 71.1 steps/s
[Step=24650 Epoch=94.5] | Loss=0.00300 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.507 | L2-Norm(final)=14.252 | 4513.8 samples/s | 70.5 steps/s
[Step=24700 Epoch=94.6] | Loss=0.00320 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=14.240 | 4545.3 samples/s | 71.0 steps/s
[Step=24750 Epoch=94.8] | Loss=0.00300 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.608 | L2-Norm(final)=14.229 | 5669.5 samples/s | 88.6 steps/s
[Step=24800 Epoch=95.0] | Loss=0.00256 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=14.221 | 2024.5 samples/s | 31.6 steps/s
[Step=24850 Epoch=95.2] | Loss=0.00223 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.658 | L2-Norm(final)=14.215 | 4490.3 samples/s | 70.2 steps/s
[Step=24900 Epoch=95.4] | Loss=0.00200 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.672 | L2-Norm(final)=14.211 | 4532.3 samples/s | 70.8 steps/s
[Step=24950 Epoch=95.6] | Loss=0.00178 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.683 | L2-Norm(final)=14.208 | 4619.3 samples/s | 72.2 steps/s
[Step=25000 Epoch=95.8] | Loss=0.00160 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.689 | L2-Norm(final)=14.206 | 4955.1 samples/s | 77.4 steps/s
[Step=25050 Epoch=96.0] | Loss=0.00146 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.692 | L2-Norm(final)=14.204 | 2092.8 samples/s | 32.7 steps/s
[Step=25100 Epoch=96.2] | Loss=0.00134 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.694 | L2-Norm(final)=14.202 | 4575.9 samples/s | 71.5 steps/s
[Step=25150 Epoch=96.4] | Loss=0.00123 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.693 | L2-Norm(final)=14.201 | 4574.0 samples/s | 71.5 steps/s
[Step=25200 Epoch=96.6] | Loss=0.00115 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.691 | L2-Norm(final)=14.200 | 4512.5 samples/s | 70.5 steps/s
[Step=25250 Epoch=96.7] | Loss=0.00107 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.689 | L2-Norm(final)=14.200 | 4532.7 samples/s | 70.8 steps/s
[Step=25300 Epoch=96.9] | Loss=0.00100 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.685 | L2-Norm(final)=14.199 | 2194.1 samples/s | 34.3 steps/s
[Step=25350 Epoch=97.1] | Loss=0.00094 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.681 | L2-Norm(final)=14.199 | 4619.5 samples/s | 72.2 steps/s
[Step=25400 Epoch=97.3] | Loss=0.00089 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.676 | L2-Norm(final)=14.199 | 4536.2 samples/s | 70.9 steps/s
[Step=25450 Epoch=97.5] | Loss=0.00084 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.671 | L2-Norm(final)=14.198 | 4555.7 samples/s | 71.2 steps/s
[Step=25500 Epoch=97.7] | Loss=0.00080 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.665 | L2-Norm(final)=14.198 | 4543.0 samples/s | 71.0 steps/s
[Step=25550 Epoch=97.9] | Loss=0.00076 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.659 | L2-Norm(final)=14.198 | 2225.2 samples/s | 34.8 steps/s
[Step=25600 Epoch=98.1] | Loss=0.00073 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.653 | L2-Norm(final)=14.198 | 4537.6 samples/s | 70.9 steps/s
[Step=25650 Epoch=98.3] | Loss=0.00070 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.647 | L2-Norm(final)=14.199 | 4552.8 samples/s | 71.1 steps/s
[Step=25700 Epoch=98.5] | Loss=0.00067 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.640 | L2-Norm(final)=14.199 | 4546.1 samples/s | 71.0 steps/s
[Step=25750 Epoch=98.7] | Loss=0.00064 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.633 | L2-Norm(final)=14.199 | 4546.2 samples/s | 71.0 steps/s
[Step=25800 Epoch=98.9] | Loss=0.00062 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.626 | L2-Norm(final)=14.200 | 6140.4 samples/s | 95.9 steps/s
[Step=25850 Epoch=99.0] | Loss=0.00059 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=14.200 | 1966.7 samples/s | 30.7 steps/s
[Step=25900 Epoch=99.2] | Loss=0.00057 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.611 | L2-Norm(final)=14.200 | 4534.8 samples/s | 70.9 steps/s
[Step=25950 Epoch=99.4] | Loss=0.00055 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.604 | L2-Norm(final)=14.201 | 4585.6 samples/s | 71.6 steps/s
[Step=26000 Epoch=99.6] | Loss=0.00054 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.596 | L2-Norm(final)=14.201 | 4513.0 samples/s | 70.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step26000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=24001 Epoch=92.4] | Loss=0.00036 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.483 | L2-Norm(final)=15.376 | 4479.4 samples/s | 70.0 steps/s
[Step=24050 Epoch=92.6] | Loss=0.00195 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=15.382 | 4354.8 samples/s | 68.0 steps/s
[Step=24100 Epoch=92.8] | Loss=0.00159 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=15.391 | 4933.2 samples/s | 77.1 steps/s
[Step=24150 Epoch=93.0] | Loss=0.00127 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=15.399 | 4925.3 samples/s | 77.0 steps/s
[Step=24200 Epoch=93.2] | Loss=0.00103 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=15.406 | 5150.7 samples/s | 80.5 steps/s
[Step=24250 Epoch=93.3] | Loss=0.00119 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=15.414 | 6954.6 samples/s | 108.7 steps/s
[Step=24300 Epoch=93.5] | Loss=0.00118 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=15.420 | 2101.3 samples/s | 32.8 steps/s
[Step=24350 Epoch=93.7] | Loss=0.00119 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=15.426 | 5229.7 samples/s | 81.7 steps/s
[Step=24400 Epoch=93.9] | Loss=0.00111 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=15.433 | 5210.9 samples/s | 81.4 steps/s
[Step=24450 Epoch=94.1] | Loss=0.00105 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=15.441 | 5232.1 samples/s | 81.8 steps/s
[Step=24500 Epoch=94.3] | Loss=0.00102 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=15.450 | 6027.8 samples/s | 94.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=94.3] | Loss=0.00202 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=15.533 | 4649.5 samples/s | 72.6 steps/s
[Step=24550 Epoch=94.5] | Loss=0.00080 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.487 | L2-Norm(final)=15.535 | 4165.9 samples/s | 65.1 steps/s
[Step=24600 Epoch=94.7] | Loss=0.00134 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.493 | L2-Norm(final)=15.537 | 4612.9 samples/s | 72.1 steps/s
[Step=24650 Epoch=94.9] | Loss=0.00349 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.544 | L2-Norm(final)=15.529 | 4497.9 samples/s | 70.3 steps/s
[Step=24700 Epoch=95.1] | Loss=0.00270 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.598 | L2-Norm(final)=15.519 | 4575.7 samples/s | 71.5 steps/s
[Step=24750 Epoch=95.3] | Loss=0.00242 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.631 | L2-Norm(final)=15.515 | 5819.1 samples/s | 90.9 steps/s
[Step=24800 Epoch=95.5] | Loss=0.00206 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.652 | L2-Norm(final)=15.512 | 2006.4 samples/s | 31.4 steps/s
[Step=24850 Epoch=95.7] | Loss=0.00177 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.666 | L2-Norm(final)=15.510 | 4469.0 samples/s | 69.8 steps/s
[Step=24900 Epoch=95.8] | Loss=0.00164 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.675 | L2-Norm(final)=15.509 | 4558.5 samples/s | 71.2 steps/s
[Step=24950 Epoch=96.0] | Loss=0.00155 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.683 | L2-Norm(final)=15.507 | 4591.9 samples/s | 71.7 steps/s
[Step=25000 Epoch=96.2] | Loss=0.00152 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.689 | L2-Norm(final)=15.505 | 5191.3 samples/s | 81.1 steps/s
[Step=25050 Epoch=96.4] | Loss=0.00138 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.693 | L2-Norm(final)=15.503 | 2093.3 samples/s | 32.7 steps/s
[Step=25100 Epoch=96.6] | Loss=0.00127 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.696 | L2-Norm(final)=15.502 | 4471.9 samples/s | 69.9 steps/s
[Step=25150 Epoch=96.8] | Loss=0.00117 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.696 | L2-Norm(final)=15.501 | 4607.1 samples/s | 72.0 steps/s
[Step=25200 Epoch=97.0] | Loss=0.00109 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.696 | L2-Norm(final)=15.500 | 4543.9 samples/s | 71.0 steps/s
[Step=25250 Epoch=97.2] | Loss=0.00102 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.694 | L2-Norm(final)=15.499 | 4640.3 samples/s | 72.5 steps/s
[Step=25300 Epoch=97.4] | Loss=0.00096 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.692 | L2-Norm(final)=15.498 | 2171.2 samples/s | 33.9 steps/s
[Step=25350 Epoch=97.6] | Loss=0.00090 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.690 | L2-Norm(final)=15.498 | 4618.9 samples/s | 72.2 steps/s
[Step=25400 Epoch=97.8] | Loss=0.00085 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.687 | L2-Norm(final)=15.497 | 4527.0 samples/s | 70.7 steps/s
[Step=25450 Epoch=98.0] | Loss=0.00081 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=15.497 | 4568.0 samples/s | 71.4 steps/s
[Step=25500 Epoch=98.2] | Loss=0.00077 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.680 | L2-Norm(final)=15.497 | 4556.5 samples/s | 71.2 steps/s
[Step=25550 Epoch=98.4] | Loss=0.00073 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.676 | L2-Norm(final)=15.497 | 2219.7 samples/s | 34.7 steps/s
[Step=25600 Epoch=98.5] | Loss=0.00070 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.671 | L2-Norm(final)=15.497 | 4516.1 samples/s | 70.6 steps/s
[Step=25650 Epoch=98.7] | Loss=0.00067 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.666 | L2-Norm(final)=15.496 | 4611.4 samples/s | 72.1 steps/s
[Step=25700 Epoch=98.9] | Loss=0.00064 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.661 | L2-Norm(final)=15.496 | 4510.3 samples/s | 70.5 steps/s
[Step=25750 Epoch=99.1] | Loss=0.00062 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.656 | L2-Norm(final)=15.496 | 4564.2 samples/s | 71.3 steps/s
[Step=25800 Epoch=99.3] | Loss=0.00059 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.650 | L2-Norm(final)=15.496 | 6544.6 samples/s | 102.3 steps/s
[Step=25850 Epoch=99.5] | Loss=0.00057 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.644 | L2-Norm(final)=15.497 | 1916.2 samples/s | 29.9 steps/s
[Step=25900 Epoch=99.7] | Loss=0.00055 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=15.497 | 4592.5 samples/s | 71.8 steps/s
[Step=25950 Epoch=99.9] | Loss=0.00053 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.631 | L2-Norm(final)=15.497 | 4512.1 samples/s | 70.5 steps/s
[Step=26000 Epoch=100.1] | Loss=0.00051 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.625 | L2-Norm(final)=15.497 | 4559.8 samples/s | 71.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step26000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07089 | acc=0.9661 | tpr=0.9741 | fpr=0.0513 | 4198.8 samples/s | 16.4 steps/s
Avg test loss: 0.06966, Avg test acc: 0.96558, Avg tpr: 0.97418, Avg fpr: 0.05333, total FA: 416

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07123 | acc=0.9660 | tpr=0.9746 | fpr=0.0525 | 4182.5 samples/s | 16.3 steps/s
Avg test loss: 0.07092, Avg test acc: 0.96546, Avg tpr: 0.97395, Avg fpr: 0.05320, total FA: 415

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=8.38646 | acc=0.3109 | tpr=0.0032 | fpr=0.0208 | 4160.9 samples/s | 16.3 steps/s
Avg test loss: 8.42208, Avg test acc: 0.30816, Avg tpr: 0.00361, Avg fpr: 0.02205, total FA: 172

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.80025 | acc=0.3045 | tpr=0.0184 | fpr=0.0741 | 4133.0 samples/s | 16.1 steps/s
Avg test loss: 7.80241, Avg test acc: 0.30083, Avg tpr: 0.01818, Avg fpr: 0.07755, total FA: 605

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.26099 | acc=0.1331 | tpr=0.5310 | fpr=0.8740 | 4144.5 samples/s | 16.2 steps/s
[Step= 100] | Loss=6.19849 | acc=0.1335 | tpr=0.5224 | fpr=0.8737 | 8035.0 samples/s | 31.4 steps/s
[Step= 150] | Loss=6.20677 | acc=0.1332 | tpr=0.5245 | fpr=0.8740 | 7831.1 samples/s | 30.6 steps/s
[Step= 200] | Loss=6.20084 | acc=0.1339 | tpr=0.5071 | fpr=0.8729 | 7845.6 samples/s | 30.6 steps/s
[Step= 250] | Loss=6.18908 | acc=0.1340 | tpr=0.4943 | fpr=0.8725 | 7810.3 samples/s | 30.5 steps/s
[Step= 300] | Loss=6.18954 | acc=0.1335 | tpr=0.4931 | fpr=0.8731 | 7813.6 samples/s | 30.5 steps/s
[Step= 350] | Loss=6.19739 | acc=0.1328 | tpr=0.4865 | fpr=0.8737 | 7882.9 samples/s | 30.8 steps/s
[Step= 400] | Loss=6.18919 | acc=0.1326 | tpr=0.4836 | fpr=0.8737 | 8067.1 samples/s | 31.5 steps/s
[Step= 450] | Loss=6.19178 | acc=0.1320 | tpr=0.4830 | fpr=0.8743 | 7752.6 samples/s | 30.3 steps/s
[Step= 500] | Loss=6.19032 | acc=0.1319 | tpr=0.4881 | fpr=0.8745 | 7830.9 samples/s | 30.6 steps/s
[Step= 550] | Loss=6.19257 | acc=0.1321 | tpr=0.4903 | fpr=0.8744 | 14657.0 samples/s | 57.3 steps/s
Avg test loss: 6.19483, Avg test acc: 0.13202, Avg tpr: 0.48970, Avg fpr: 0.87448, total FA: 121420

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.37977 | acc=0.1374 | tpr=0.5088 | fpr=0.8693 | 4214.0 samples/s | 16.5 steps/s
[Step= 100] | Loss=6.31533 | acc=0.1393 | tpr=0.5330 | fpr=0.8681 | 7600.6 samples/s | 29.7 steps/s
[Step= 150] | Loss=6.32790 | acc=0.1394 | tpr=0.5216 | fpr=0.8677 | 7766.2 samples/s | 30.3 steps/s
[Step= 200] | Loss=6.31771 | acc=0.1393 | tpr=0.5148 | fpr=0.8675 | 7956.8 samples/s | 31.1 steps/s
[Step= 250] | Loss=6.31275 | acc=0.1391 | tpr=0.5004 | fpr=0.8675 | 8011.9 samples/s | 31.3 steps/s
[Step= 300] | Loss=6.31399 | acc=0.1385 | tpr=0.4967 | fpr=0.8681 | 7578.0 samples/s | 29.6 steps/s
[Step= 350] | Loss=6.31961 | acc=0.1382 | tpr=0.4928 | fpr=0.8682 | 8385.6 samples/s | 32.8 steps/s
[Step= 400] | Loss=6.30987 | acc=0.1381 | tpr=0.4830 | fpr=0.8682 | 7597.5 samples/s | 29.7 steps/s
[Step= 450] | Loss=6.31295 | acc=0.1378 | tpr=0.4791 | fpr=0.8684 | 7834.8 samples/s | 30.6 steps/s
[Step= 500] | Loss=6.31152 | acc=0.1379 | tpr=0.4841 | fpr=0.8684 | 8249.2 samples/s | 32.2 steps/s
[Step= 550] | Loss=6.31270 | acc=0.1382 | tpr=0.4863 | fpr=0.8681 | 13061.9 samples/s | 51.0 steps/s
Avg test loss: 6.31375, Avg test acc: 0.13813, Avg tpr: 0.48534, Avg fpr: 0.86818, total FA: 120545

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12100 | acc=0.9842 | tpr=0.9071 | fpr=0.0144 | 4224.3 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.12903 | acc=0.9838 | tpr=0.9296 | fpr=0.0152 | 7594.9 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.13182 | acc=0.9831 | tpr=0.9366 | fpr=0.0160 | 7970.7 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.13174 | acc=0.9832 | tpr=0.9432 | fpr=0.0160 | 7960.0 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.13165 | acc=0.9833 | tpr=0.9432 | fpr=0.0159 | 7843.2 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.13387 | acc=0.9829 | tpr=0.9404 | fpr=0.0163 | 7844.2 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.13450 | acc=0.9827 | tpr=0.9386 | fpr=0.0165 | 7800.0 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.13595 | acc=0.9826 | tpr=0.9365 | fpr=0.0166 | 7992.5 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.13838 | acc=0.9823 | tpr=0.9357 | fpr=0.0168 | 7742.4 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.13762 | acc=0.9825 | tpr=0.9370 | fpr=0.0167 | 7818.4 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.13720 | acc=0.9825 | tpr=0.9359 | fpr=0.0166 | 14524.0 samples/s | 56.7 steps/s
Avg test loss: 0.13692, Avg test acc: 0.98256, Avg tpr: 0.93582, Avg fpr: 0.01659, total FA: 2303

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13771 | acc=0.9790 | tpr=0.9292 | fpr=0.0201 | 4153.4 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.14916 | acc=0.9782 | tpr=0.9531 | fpr=0.0213 | 7795.7 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.15172 | acc=0.9780 | tpr=0.9568 | fpr=0.0216 | 8063.8 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.15367 | acc=0.9782 | tpr=0.9596 | fpr=0.0214 | 7667.3 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.15217 | acc=0.9784 | tpr=0.9607 | fpr=0.0212 | 7913.6 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.15468 | acc=0.9786 | tpr=0.9622 | fpr=0.0211 | 7773.6 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.15515 | acc=0.9784 | tpr=0.9618 | fpr=0.0212 | 8136.5 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.15600 | acc=0.9783 | tpr=0.9601 | fpr=0.0214 | 7899.5 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.15805 | acc=0.9779 | tpr=0.9586 | fpr=0.0217 | 7763.3 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.15729 | acc=0.9780 | tpr=0.9590 | fpr=0.0216 | 7694.5 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.15656 | acc=0.9781 | tpr=0.9578 | fpr=0.0216 | 14660.5 samples/s | 57.3 steps/s
Avg test loss: 0.15647, Avg test acc: 0.97809, Avg tpr: 0.95761, Avg fpr: 0.02154, total FA: 2991

server round 13/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=26001 Epoch=50.7] | Loss=0.01560 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.456 | L2-Norm(final)=14.187 | 3973.5 samples/s | 62.1 steps/s
[Step=26050 Epoch=50.8] | Loss=0.03503 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.458 | L2-Norm(final)=14.202 | 5258.1 samples/s | 82.2 steps/s
[Step=26100 Epoch=50.9] | Loss=0.03245 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.458 | L2-Norm(final)=14.221 | 5515.9 samples/s | 86.2 steps/s
[Step=26150 Epoch=51.0] | Loss=0.03046 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.458 | L2-Norm(final)=14.239 | 5593.8 samples/s | 87.4 steps/s
[Step=26200 Epoch=51.1] | Loss=0.02997 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.458 | L2-Norm(final)=14.255 | 5531.5 samples/s | 86.4 steps/s
[Step=26250 Epoch=51.2] | Loss=0.02977 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.458 | L2-Norm(final)=14.271 | 5535.4 samples/s | 86.5 steps/s
[Step=26300 Epoch=51.3] | Loss=0.02960 | Reg=0.00181 | acc=0.9531 | L2-Norm=13.459 | L2-Norm(final)=14.286 | 5445.3 samples/s | 85.1 steps/s
[Step=26350 Epoch=51.4] | Loss=0.02933 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.459 | L2-Norm(final)=14.301 | 5579.2 samples/s | 87.2 steps/s
[Step=26400 Epoch=51.5] | Loss=0.02900 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.459 | L2-Norm(final)=14.315 | 5552.2 samples/s | 86.8 steps/s
[Step=26450 Epoch=51.6] | Loss=0.02866 | Reg=0.00181 | acc=0.9531 | L2-Norm=13.459 | L2-Norm(final)=14.329 | 5533.2 samples/s | 86.5 steps/s
[Step=26500 Epoch=51.7] | Loss=0.02869 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.459 | L2-Norm(final)=14.343 | 7019.8 samples/s | 109.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=26501 Epoch=51.7] | Loss=0.01592 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.459 | L2-Norm(final)=14.482 | 4250.8 samples/s | 66.4 steps/s
[Step=26550 Epoch=51.8] | Loss=0.02692 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.524 | L2-Norm(final)=14.488 | 4626.3 samples/s | 72.3 steps/s
[Step=26600 Epoch=51.9] | Loss=0.02393 | Reg=0.00184 | acc=0.9375 | L2-Norm=13.579 | L2-Norm(final)=14.484 | 4808.5 samples/s | 75.1 steps/s
[Step=26650 Epoch=52.0] | Loss=0.02346 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.618 | L2-Norm(final)=14.481 | 4784.7 samples/s | 74.8 steps/s
[Step=26700 Epoch=52.1] | Loss=0.02369 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.651 | L2-Norm(final)=14.478 | 4783.8 samples/s | 74.7 steps/s
[Step=26750 Epoch=52.2] | Loss=0.02385 | Reg=0.00187 | acc=0.9375 | L2-Norm=13.679 | L2-Norm(final)=14.475 | 4794.1 samples/s | 74.9 steps/s
[Step=26800 Epoch=52.3] | Loss=0.02377 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.705 | L2-Norm(final)=14.472 | 4785.4 samples/s | 74.8 steps/s
[Step=26850 Epoch=52.4] | Loss=0.02317 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.729 | L2-Norm(final)=14.470 | 4846.4 samples/s | 75.7 steps/s
[Step=26900 Epoch=52.5] | Loss=0.02354 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.750 | L2-Norm(final)=14.469 | 4785.0 samples/s | 74.8 steps/s
[Step=26950 Epoch=52.6] | Loss=0.02367 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.769 | L2-Norm(final)=14.467 | 4848.0 samples/s | 75.7 steps/s
[Step=27000 Epoch=52.7] | Loss=0.02310 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.788 | L2-Norm(final)=14.465 | 5789.8 samples/s | 90.5 steps/s
[Step=27050 Epoch=52.8] | Loss=0.02249 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.805 | L2-Norm(final)=14.464 | 2006.8 samples/s | 31.4 steps/s
[Step=27100 Epoch=52.9] | Loss=0.02229 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.820 | L2-Norm(final)=14.463 | 4653.1 samples/s | 72.7 steps/s
[Step=27150 Epoch=53.0] | Loss=0.02148 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.835 | L2-Norm(final)=14.462 | 4781.1 samples/s | 74.7 steps/s
[Step=27200 Epoch=53.1] | Loss=0.02113 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.849 | L2-Norm(final)=14.461 | 4831.2 samples/s | 75.5 steps/s
[Step=27250 Epoch=53.1] | Loss=0.02096 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.862 | L2-Norm(final)=14.461 | 4818.3 samples/s | 75.3 steps/s
[Step=27300 Epoch=53.2] | Loss=0.02062 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.875 | L2-Norm(final)=14.460 | 4778.5 samples/s | 74.7 steps/s
[Step=27350 Epoch=53.3] | Loss=0.02017 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.886 | L2-Norm(final)=14.459 | 4816.2 samples/s | 75.3 steps/s
[Step=27400 Epoch=53.4] | Loss=0.01994 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.897 | L2-Norm(final)=14.459 | 4806.4 samples/s | 75.1 steps/s
[Step=27450 Epoch=53.5] | Loss=0.01968 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.907 | L2-Norm(final)=14.458 | 4857.0 samples/s | 75.9 steps/s
[Step=27500 Epoch=53.6] | Loss=0.01943 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.917 | L2-Norm(final)=14.458 | 5078.8 samples/s | 79.4 steps/s
[Step=27550 Epoch=53.7] | Loss=0.01920 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.927 | L2-Norm(final)=14.457 | 2100.6 samples/s | 32.8 steps/s
[Step=27600 Epoch=53.8] | Loss=0.01877 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.936 | L2-Norm(final)=14.457 | 4749.9 samples/s | 74.2 steps/s
[Step=27650 Epoch=53.9] | Loss=0.01846 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.944 | L2-Norm(final)=14.457 | 4805.1 samples/s | 75.1 steps/s
[Step=27700 Epoch=54.0] | Loss=0.01831 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.953 | L2-Norm(final)=14.456 | 4832.7 samples/s | 75.5 steps/s
[Step=27750 Epoch=54.1] | Loss=0.01809 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=14.456 | 4810.9 samples/s | 75.2 steps/s
[Step=27800 Epoch=54.2] | Loss=0.01790 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.969 | L2-Norm(final)=14.456 | 4797.5 samples/s | 75.0 steps/s
[Step=27850 Epoch=54.3] | Loss=0.01759 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.976 | L2-Norm(final)=14.456 | 4829.4 samples/s | 75.5 steps/s
[Step=27900 Epoch=54.4] | Loss=0.01730 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.984 | L2-Norm(final)=14.455 | 4835.4 samples/s | 75.6 steps/s
[Step=27950 Epoch=54.5] | Loss=0.01727 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.991 | L2-Norm(final)=14.455 | 4762.0 samples/s | 74.4 steps/s
[Step=28000 Epoch=54.6] | Loss=0.01705 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.998 | L2-Norm(final)=14.455 | 4804.6 samples/s | 75.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step28000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=26001 Epoch=50.8] | Loss=0.03315 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.456 | L2-Norm(final)=14.674 | 4743.4 samples/s | 74.1 steps/s
[Step=26050 Epoch=50.9] | Loss=0.02648 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.458 | L2-Norm(final)=14.683 | 4970.0 samples/s | 77.7 steps/s
[Step=26100 Epoch=51.0] | Loss=0.02909 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.458 | L2-Norm(final)=14.697 | 5506.1 samples/s | 86.0 steps/s
[Step=26150 Epoch=51.1] | Loss=0.02914 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.459 | L2-Norm(final)=14.710 | 5499.2 samples/s | 85.9 steps/s
[Step=26200 Epoch=51.2] | Loss=0.02823 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.459 | L2-Norm(final)=14.723 | 5527.2 samples/s | 86.4 steps/s
[Step=26250 Epoch=51.3] | Loss=0.02757 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.459 | L2-Norm(final)=14.737 | 5557.6 samples/s | 86.8 steps/s
[Step=26300 Epoch=51.4] | Loss=0.02764 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.459 | L2-Norm(final)=14.752 | 5519.5 samples/s | 86.2 steps/s
[Step=26350 Epoch=51.5] | Loss=0.02851 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.459 | L2-Norm(final)=14.766 | 5561.5 samples/s | 86.9 steps/s
[Step=26400 Epoch=51.6] | Loss=0.02855 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.459 | L2-Norm(final)=14.779 | 5492.3 samples/s | 85.8 steps/s
[Step=26450 Epoch=51.7] | Loss=0.02857 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.459 | L2-Norm(final)=14.793 | 5556.5 samples/s | 86.8 steps/s
[Step=26500 Epoch=51.8] | Loss=0.02846 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.459 | L2-Norm(final)=14.806 | 6987.7 samples/s | 109.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=26501 Epoch=51.8] | Loss=0.01162 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.459 | L2-Norm(final)=14.945 | 4463.9 samples/s | 69.7 steps/s
[Step=26550 Epoch=51.9] | Loss=0.02520 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.512 | L2-Norm(final)=14.947 | 4719.2 samples/s | 73.7 steps/s
[Step=26600 Epoch=52.0] | Loss=0.02304 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.566 | L2-Norm(final)=14.939 | 4747.8 samples/s | 74.2 steps/s
[Step=26650 Epoch=52.1] | Loss=0.02586 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.604 | L2-Norm(final)=14.927 | 4782.0 samples/s | 74.7 steps/s
[Step=26700 Epoch=52.2] | Loss=0.02596 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=14.915 | 4817.6 samples/s | 75.3 steps/s
[Step=26750 Epoch=52.3] | Loss=0.02515 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.665 | L2-Norm(final)=14.906 | 4793.3 samples/s | 74.9 steps/s
[Step=26800 Epoch=52.4] | Loss=0.02470 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.688 | L2-Norm(final)=14.901 | 4858.2 samples/s | 75.9 steps/s
[Step=26850 Epoch=52.5] | Loss=0.02381 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.707 | L2-Norm(final)=14.897 | 4693.6 samples/s | 73.3 steps/s
[Step=26900 Epoch=52.6] | Loss=0.02323 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.725 | L2-Norm(final)=14.893 | 4826.1 samples/s | 75.4 steps/s
[Step=26950 Epoch=52.7] | Loss=0.02309 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.741 | L2-Norm(final)=14.889 | 4794.5 samples/s | 74.9 steps/s
[Step=27000 Epoch=52.8] | Loss=0.02306 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.755 | L2-Norm(final)=14.885 | 5864.2 samples/s | 91.6 steps/s
[Step=27050 Epoch=52.9] | Loss=0.02243 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.769 | L2-Norm(final)=14.882 | 2093.5 samples/s | 32.7 steps/s
[Step=27100 Epoch=53.0] | Loss=0.02152 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=14.880 | 4752.1 samples/s | 74.3 steps/s
[Step=27150 Epoch=53.1] | Loss=0.02075 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.793 | L2-Norm(final)=14.879 | 4751.1 samples/s | 74.2 steps/s
[Step=27200 Epoch=53.2] | Loss=0.02052 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=14.877 | 4873.2 samples/s | 76.1 steps/s
[Step=27250 Epoch=53.3] | Loss=0.02017 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.813 | L2-Norm(final)=14.876 | 4630.5 samples/s | 72.4 steps/s
[Step=27300 Epoch=53.4] | Loss=0.01962 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.823 | L2-Norm(final)=14.874 | 4753.4 samples/s | 74.3 steps/s
[Step=27350 Epoch=53.5] | Loss=0.01914 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.832 | L2-Norm(final)=14.873 | 4791.0 samples/s | 74.9 steps/s
[Step=27400 Epoch=53.6] | Loss=0.01891 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.840 | L2-Norm(final)=14.872 | 4839.6 samples/s | 75.6 steps/s
[Step=27450 Epoch=53.7] | Loss=0.01863 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.849 | L2-Norm(final)=14.871 | 4781.6 samples/s | 74.7 steps/s
[Step=27500 Epoch=53.8] | Loss=0.01825 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.857 | L2-Norm(final)=14.869 | 5176.0 samples/s | 80.9 steps/s
[Step=27550 Epoch=53.9] | Loss=0.01802 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.865 | L2-Norm(final)=14.868 | 2197.2 samples/s | 34.3 steps/s
[Step=27600 Epoch=54.0] | Loss=0.01784 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.873 | L2-Norm(final)=14.867 | 4787.7 samples/s | 74.8 steps/s
[Step=27650 Epoch=54.1] | Loss=0.01756 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.880 | L2-Norm(final)=14.866 | 4804.5 samples/s | 75.1 steps/s
[Step=27700 Epoch=54.2] | Loss=0.01742 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.888 | L2-Norm(final)=14.865 | 4765.7 samples/s | 74.5 steps/s
[Step=27750 Epoch=54.3] | Loss=0.01709 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.895 | L2-Norm(final)=14.865 | 4811.3 samples/s | 75.2 steps/s
[Step=27800 Epoch=54.3] | Loss=0.01683 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.903 | L2-Norm(final)=14.864 | 4761.9 samples/s | 74.4 steps/s
[Step=27850 Epoch=54.4] | Loss=0.01685 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.910 | L2-Norm(final)=14.864 | 4802.8 samples/s | 75.0 steps/s
[Step=27900 Epoch=54.5] | Loss=0.01657 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.916 | L2-Norm(final)=14.863 | 4831.3 samples/s | 75.5 steps/s
[Step=27950 Epoch=54.6] | Loss=0.01630 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.923 | L2-Norm(final)=14.863 | 4794.4 samples/s | 74.9 steps/s
[Step=28000 Epoch=54.7] | Loss=0.01613 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.929 | L2-Norm(final)=14.862 | 4760.3 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step28000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=26001 Epoch=99.6] | Loss=0.00031 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.456 | L2-Norm(final)=14.217 | 4718.1 samples/s | 73.7 steps/s
[Step=26050 Epoch=99.8] | Loss=0.00057 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=14.213 | 4693.0 samples/s | 73.3 steps/s
[Step=26100 Epoch=100.0] | Loss=0.00132 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=14.210 | 5262.8 samples/s | 82.2 steps/s
[Step=26150 Epoch=100.2] | Loss=0.00095 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=14.208 | 5197.5 samples/s | 81.2 steps/s
[Step=26200 Epoch=100.4] | Loss=0.00093 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=14.207 | 5290.1 samples/s | 82.7 steps/s
[Step=26250 Epoch=100.6] | Loss=0.00099 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=14.208 | 6779.8 samples/s | 105.9 steps/s
[Step=26300 Epoch=100.8] | Loss=0.00091 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=14.209 | 2141.3 samples/s | 33.5 steps/s
[Step=26350 Epoch=101.0] | Loss=0.00096 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=14.210 | 5154.0 samples/s | 80.5 steps/s
[Step=26400 Epoch=101.2] | Loss=0.00093 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=14.211 | 5303.2 samples/s | 82.9 steps/s
[Step=26450 Epoch=101.3] | Loss=0.00090 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=14.213 | 5225.1 samples/s | 81.6 steps/s
[Step=26500 Epoch=101.5] | Loss=0.00092 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=14.216 | 5827.1 samples/s | 91.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=26501 Epoch=101.5] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=14.237 | 4385.5 samples/s | 68.5 steps/s
[Step=26550 Epoch=101.7] | Loss=0.00033 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.447 | L2-Norm(final)=14.241 | 4490.1 samples/s | 70.2 steps/s
[Step=26600 Epoch=101.9] | Loss=0.00021 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.447 | L2-Norm(final)=14.245 | 4612.4 samples/s | 72.1 steps/s
[Step=26650 Epoch=102.1] | Loss=0.00015 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.437 | L2-Norm(final)=14.248 | 4588.7 samples/s | 71.7 steps/s
[Step=26700 Epoch=102.3] | Loss=0.00014 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=14.251 | 4576.4 samples/s | 71.5 steps/s
[Step=26750 Epoch=102.5] | Loss=0.00011 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.413 | L2-Norm(final)=14.253 | 5729.9 samples/s | 89.5 steps/s
[Step=26800 Epoch=102.7] | Loss=0.00009 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.400 | L2-Norm(final)=14.254 | 2030.7 samples/s | 31.7 steps/s
[Step=26850 Epoch=102.9] | Loss=0.00008 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.385 | L2-Norm(final)=14.256 | 4562.4 samples/s | 71.3 steps/s
[Step=26900 Epoch=103.1] | Loss=0.00007 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=14.257 | 4516.0 samples/s | 70.6 steps/s
[Step=26950 Epoch=103.3] | Loss=0.00006 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=14.258 | 4598.0 samples/s | 71.8 steps/s
[Step=27000 Epoch=103.5] | Loss=0.00006 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.341 | L2-Norm(final)=14.258 | 5010.4 samples/s | 78.3 steps/s
[Step=27050 Epoch=103.6] | Loss=0.00005 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.326 | L2-Norm(final)=14.259 | 2085.8 samples/s | 32.6 steps/s
[Step=27100 Epoch=103.8] | Loss=0.00005 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=14.260 | 4593.6 samples/s | 71.8 steps/s
[Step=27150 Epoch=104.0] | Loss=0.00004 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.296 | L2-Norm(final)=14.261 | 4523.2 samples/s | 70.7 steps/s
[Step=27200 Epoch=104.2] | Loss=0.00004 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.280 | L2-Norm(final)=14.261 | 4545.1 samples/s | 71.0 steps/s
[Step=27250 Epoch=104.4] | Loss=0.00004 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.265 | L2-Norm(final)=14.262 | 4630.6 samples/s | 72.4 steps/s
[Step=27300 Epoch=104.6] | Loss=0.00004 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.250 | L2-Norm(final)=14.263 | 2194.7 samples/s | 34.3 steps/s
[Step=27350 Epoch=104.8] | Loss=0.00003 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.236 | L2-Norm(final)=14.264 | 4652.8 samples/s | 72.7 steps/s
[Step=27400 Epoch=105.0] | Loss=0.00003 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.221 | L2-Norm(final)=14.265 | 4540.5 samples/s | 70.9 steps/s
[Step=27450 Epoch=105.2] | Loss=0.00003 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.206 | L2-Norm(final)=14.266 | 4611.2 samples/s | 72.0 steps/s
[Step=27500 Epoch=105.4] | Loss=0.00003 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.191 | L2-Norm(final)=14.267 | 4514.9 samples/s | 70.5 steps/s
[Step=27550 Epoch=105.6] | Loss=0.00003 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.176 | L2-Norm(final)=14.268 | 2188.0 samples/s | 34.2 steps/s
[Step=27600 Epoch=105.8] | Loss=0.00003 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.161 | L2-Norm(final)=14.270 | 4605.2 samples/s | 72.0 steps/s
[Step=27650 Epoch=105.9] | Loss=0.00003 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.146 | L2-Norm(final)=14.271 | 4483.2 samples/s | 70.1 steps/s
[Step=27700 Epoch=106.1] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.131 | L2-Norm(final)=14.272 | 4547.0 samples/s | 71.0 steps/s
[Step=27750 Epoch=106.3] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.116 | L2-Norm(final)=14.273 | 4602.2 samples/s | 71.9 steps/s
[Step=27800 Epoch=106.5] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=14.274 | 6117.8 samples/s | 95.6 steps/s
[Step=27850 Epoch=106.7] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.086 | L2-Norm(final)=14.276 | 1951.4 samples/s | 30.5 steps/s
[Step=27900 Epoch=106.9] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.071 | L2-Norm(final)=14.277 | 4592.2 samples/s | 71.8 steps/s
[Step=27950 Epoch=107.1] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.056 | L2-Norm(final)=14.278 | 4541.5 samples/s | 71.0 steps/s
[Step=28000 Epoch=107.3] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.040 | L2-Norm(final)=14.280 | 4577.4 samples/s | 71.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step28000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=26001 Epoch=100.1] | Loss=0.00521 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.456 | L2-Norm(final)=15.502 | 5085.3 samples/s | 79.5 steps/s
[Step=26050 Epoch=100.3] | Loss=0.00075 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=15.505 | 4459.0 samples/s | 69.7 steps/s
[Step=26100 Epoch=100.5] | Loss=0.00072 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=15.512 | 5290.2 samples/s | 82.7 steps/s
[Step=26150 Epoch=100.7] | Loss=0.00066 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=15.518 | 5281.6 samples/s | 82.5 steps/s
[Step=26200 Epoch=100.9] | Loss=0.00062 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=15.524 | 5105.4 samples/s | 79.8 steps/s
[Step=26250 Epoch=101.0] | Loss=0.00061 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=15.529 | 6895.2 samples/s | 107.7 steps/s
[Step=26300 Epoch=101.2] | Loss=0.00060 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=15.534 | 2167.0 samples/s | 33.9 steps/s
[Step=26350 Epoch=101.4] | Loss=0.00063 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=15.540 | 5046.8 samples/s | 78.9 steps/s
[Step=26400 Epoch=101.6] | Loss=0.00065 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=15.545 | 5148.9 samples/s | 80.5 steps/s
[Step=26450 Epoch=101.8] | Loss=0.00061 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=15.551 | 5223.7 samples/s | 81.6 steps/s
[Step=26500 Epoch=102.0] | Loss=0.00061 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=15.556 | 6079.8 samples/s | 95.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=26501 Epoch=102.0] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=15.613 | 4899.7 samples/s | 76.6 steps/s
[Step=26550 Epoch=102.2] | Loss=0.00492 | Reg=0.00181 | acc=0.9531 | L2-Norm=13.456 | L2-Norm(final)=15.617 | 4121.1 samples/s | 64.4 steps/s
[Step=26600 Epoch=102.4] | Loss=0.00577 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=15.604 | 4504.5 samples/s | 70.4 steps/s
[Step=26650 Epoch=102.6] | Loss=0.00478 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.602 | L2-Norm(final)=15.594 | 4545.6 samples/s | 71.0 steps/s
[Step=26700 Epoch=102.8] | Loss=0.00369 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.631 | L2-Norm(final)=15.591 | 4592.3 samples/s | 71.8 steps/s
[Step=26750 Epoch=103.0] | Loss=0.00297 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.646 | L2-Norm(final)=15.590 | 5764.3 samples/s | 90.1 steps/s
[Step=26800 Epoch=103.2] | Loss=0.00249 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.653 | L2-Norm(final)=15.591 | 2003.7 samples/s | 31.3 steps/s
[Step=26850 Epoch=103.4] | Loss=0.00213 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.655 | L2-Norm(final)=15.592 | 4545.6 samples/s | 71.0 steps/s
[Step=26900 Epoch=103.5] | Loss=0.00187 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.655 | L2-Norm(final)=15.593 | 4570.8 samples/s | 71.4 steps/s
[Step=26950 Epoch=103.7] | Loss=0.00166 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.653 | L2-Norm(final)=15.594 | 4584.9 samples/s | 71.6 steps/s
[Step=27000 Epoch=103.9] | Loss=0.00150 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.650 | L2-Norm(final)=15.595 | 5157.2 samples/s | 80.6 steps/s
[Step=27050 Epoch=104.1] | Loss=0.00136 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.646 | L2-Norm(final)=15.596 | 2095.1 samples/s | 32.7 steps/s
[Step=27100 Epoch=104.3] | Loss=0.00125 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.640 | L2-Norm(final)=15.598 | 4614.4 samples/s | 72.1 steps/s
[Step=27150 Epoch=104.5] | Loss=0.00115 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.635 | L2-Norm(final)=15.600 | 4548.5 samples/s | 71.1 steps/s
[Step=27200 Epoch=104.7] | Loss=0.00107 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.629 | L2-Norm(final)=15.601 | 4497.3 samples/s | 70.3 steps/s
[Step=27250 Epoch=104.9] | Loss=0.00100 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.622 | L2-Norm(final)=15.603 | 4648.1 samples/s | 72.6 steps/s
[Step=27300 Epoch=105.1] | Loss=0.00094 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.616 | L2-Norm(final)=15.604 | 2188.3 samples/s | 34.2 steps/s
[Step=27350 Epoch=105.3] | Loss=0.00088 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.609 | L2-Norm(final)=15.606 | 4686.6 samples/s | 73.2 steps/s
[Step=27400 Epoch=105.5] | Loss=0.00084 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.602 | L2-Norm(final)=15.607 | 4548.1 samples/s | 71.1 steps/s
[Step=27450 Epoch=105.7] | Loss=0.00079 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.594 | L2-Norm(final)=15.609 | 4583.2 samples/s | 71.6 steps/s
[Step=27500 Epoch=105.9] | Loss=0.00075 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.587 | L2-Norm(final)=15.610 | 4531.3 samples/s | 70.8 steps/s
[Step=27550 Epoch=106.1] | Loss=0.00072 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.579 | L2-Norm(final)=15.612 | 2226.5 samples/s | 34.8 steps/s
[Step=27600 Epoch=106.2] | Loss=0.00068 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.572 | L2-Norm(final)=15.613 | 4552.2 samples/s | 71.1 steps/s
[Step=27650 Epoch=106.4] | Loss=0.00065 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=15.614 | 4580.6 samples/s | 71.6 steps/s
[Step=27700 Epoch=106.6] | Loss=0.00063 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.556 | L2-Norm(final)=15.616 | 4211.1 samples/s | 65.8 steps/s
[Step=27750 Epoch=106.8] | Loss=0.00060 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.548 | L2-Norm(final)=15.617 | 4413.8 samples/s | 69.0 steps/s
[Step=27800 Epoch=107.0] | Loss=0.00058 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.540 | L2-Norm(final)=15.619 | 6499.6 samples/s | 101.6 steps/s
[Step=27850 Epoch=107.2] | Loss=0.00056 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.532 | L2-Norm(final)=15.620 | 1915.5 samples/s | 29.9 steps/s
[Step=27900 Epoch=107.4] | Loss=0.00054 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.524 | L2-Norm(final)=15.621 | 4501.3 samples/s | 70.3 steps/s
[Step=27950 Epoch=107.6] | Loss=0.00052 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.516 | L2-Norm(final)=15.623 | 4623.2 samples/s | 72.2 steps/s
[Step=28000 Epoch=107.8] | Loss=0.00050 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.507 | L2-Norm(final)=15.624 | 4458.7 samples/s | 69.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07413 | acc=0.9670 | tpr=0.9758 | fpr=0.0520 | 3997.1 samples/s | 15.6 steps/s
Avg test loss: 0.07152, Avg test acc: 0.96618, Avg tpr: 0.97570, Avg fpr: 0.05474, total FA: 427

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09606 | acc=0.9637 | tpr=0.9833 | fpr=0.0788 | 4189.3 samples/s | 16.4 steps/s
Avg test loss: 0.09290, Avg test acc: 0.96478, Avg tpr: 0.98403, Avg fpr: 0.07755, total FA: 605

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.69080 | acc=0.2941 | tpr=0.0075 | fpr=0.0837 | 4139.0 samples/s | 16.2 steps/s
Avg test loss: 7.71274, Avg test acc: 0.29057, Avg tpr: 0.00664, Avg fpr: 0.08499, total FA: 663

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.54786 | acc=0.3039 | tpr=0.0059 | fpr=0.0491 | 4181.3 samples/s | 16.3 steps/s
Avg test loss: 6.57143, Avg test acc: 0.30135, Avg tpr: 0.00664, Avg fpr: 0.05051, total FA: 394

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.43789 | acc=0.1231 | tpr=0.5973 | fpr=0.8854 | 4174.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.39437 | acc=0.1221 | tpr=0.5885 | fpr=0.8866 | 7816.3 samples/s | 30.5 steps/s
[Step= 150] | Loss=6.39995 | acc=0.1214 | tpr=0.5836 | fpr=0.8871 | 7928.7 samples/s | 31.0 steps/s
[Step= 200] | Loss=6.39548 | acc=0.1211 | tpr=0.5727 | fpr=0.8871 | 8019.4 samples/s | 31.3 steps/s
[Step= 250] | Loss=6.38283 | acc=0.1211 | tpr=0.5624 | fpr=0.8869 | 7509.8 samples/s | 29.3 steps/s
[Step= 300] | Loss=6.38604 | acc=0.1206 | tpr=0.5651 | fpr=0.8875 | 8018.4 samples/s | 31.3 steps/s
[Step= 350] | Loss=6.39290 | acc=0.1200 | tpr=0.5636 | fpr=0.8881 | 7736.2 samples/s | 30.2 steps/s
[Step= 400] | Loss=6.38193 | acc=0.1196 | tpr=0.5580 | fpr=0.8884 | 8056.6 samples/s | 31.5 steps/s
[Step= 450] | Loss=6.38600 | acc=0.1191 | tpr=0.5565 | fpr=0.8888 | 8139.1 samples/s | 31.8 steps/s
[Step= 500] | Loss=6.38411 | acc=0.1190 | tpr=0.5612 | fpr=0.8890 | 7425.6 samples/s | 29.0 steps/s
[Step= 550] | Loss=6.38634 | acc=0.1190 | tpr=0.5619 | fpr=0.8890 | 15138.3 samples/s | 59.1 steps/s
Avg test loss: 6.38720, Avg test acc: 0.11896, Avg tpr: 0.56181, Avg fpr: 0.88909, total FA: 123448

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=8.51461 | acc=0.1134 | tpr=0.6681 | fpr=0.8966 | 4148.1 samples/s | 16.2 steps/s
[Step= 100] | Loss=8.44715 | acc=0.1133 | tpr=0.6567 | fpr=0.8968 | 7762.9 samples/s | 30.3 steps/s
[Step= 150] | Loss=8.46840 | acc=0.1125 | tpr=0.6614 | fpr=0.8976 | 8286.5 samples/s | 32.4 steps/s
[Step= 200] | Loss=8.46569 | acc=0.1123 | tpr=0.6481 | fpr=0.8974 | 7513.6 samples/s | 29.3 steps/s
[Step= 250] | Loss=8.46047 | acc=0.1123 | tpr=0.6393 | fpr=0.8973 | 7884.6 samples/s | 30.8 steps/s
[Step= 300] | Loss=8.46653 | acc=0.1122 | tpr=0.6356 | fpr=0.8974 | 7949.0 samples/s | 31.1 steps/s
[Step= 350] | Loss=8.47426 | acc=0.1117 | tpr=0.6399 | fpr=0.8979 | 7798.7 samples/s | 30.5 steps/s
[Step= 400] | Loss=8.46416 | acc=0.1116 | tpr=0.6291 | fpr=0.8978 | 8116.5 samples/s | 31.7 steps/s
[Step= 450] | Loss=8.46838 | acc=0.1115 | tpr=0.6266 | fpr=0.8978 | 7942.6 samples/s | 31.0 steps/s
[Step= 500] | Loss=8.47089 | acc=0.1114 | tpr=0.6295 | fpr=0.8979 | 7617.7 samples/s | 29.8 steps/s
[Step= 550] | Loss=8.47148 | acc=0.1118 | tpr=0.6311 | fpr=0.8977 | 14305.0 samples/s | 55.9 steps/s
Avg test loss: 8.47272, Avg test acc: 0.11169, Avg tpr: 0.63074, Avg fpr: 0.89774, total FA: 124650

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11300 | acc=0.9821 | tpr=0.9115 | fpr=0.0166 | 4154.5 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.12168 | acc=0.9818 | tpr=0.9232 | fpr=0.0171 | 7955.5 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.12243 | acc=0.9815 | tpr=0.9308 | fpr=0.0176 | 7798.4 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.12359 | acc=0.9817 | tpr=0.9377 | fpr=0.0175 | 7678.4 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.12264 | acc=0.9819 | tpr=0.9415 | fpr=0.0173 | 7956.3 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.12491 | acc=0.9817 | tpr=0.9440 | fpr=0.0176 | 7835.3 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.12504 | acc=0.9818 | tpr=0.9436 | fpr=0.0175 | 7986.8 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.12593 | acc=0.9816 | tpr=0.9420 | fpr=0.0177 | 7969.5 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.12777 | acc=0.9814 | tpr=0.9411 | fpr=0.0179 | 7636.3 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.12695 | acc=0.9816 | tpr=0.9427 | fpr=0.0177 | 7767.9 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.12612 | acc=0.9816 | tpr=0.9419 | fpr=0.0176 | 14146.2 samples/s | 55.3 steps/s
Avg test loss: 0.12580, Avg test acc: 0.98166, Avg tpr: 0.94216, Avg fpr: 0.01762, total FA: 2447

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12144 | acc=0.9745 | tpr=0.9336 | fpr=0.0247 | 4189.4 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.12957 | acc=0.9741 | tpr=0.9446 | fpr=0.0253 | 7998.3 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.13363 | acc=0.9730 | tpr=0.9496 | fpr=0.0265 | 7725.8 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.13426 | acc=0.9734 | tpr=0.9530 | fpr=0.0262 | 7906.4 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.13351 | acc=0.9737 | tpr=0.9563 | fpr=0.0260 | 7738.0 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.13555 | acc=0.9735 | tpr=0.9556 | fpr=0.0262 | 7885.1 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.13564 | acc=0.9736 | tpr=0.9549 | fpr=0.0261 | 7904.0 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.13734 | acc=0.9734 | tpr=0.9546 | fpr=0.0262 | 7846.9 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.13875 | acc=0.9733 | tpr=0.9537 | fpr=0.0264 | 7856.0 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.13778 | acc=0.9734 | tpr=0.9546 | fpr=0.0263 | 8106.3 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.13711 | acc=0.9736 | tpr=0.9546 | fpr=0.0261 | 14156.3 samples/s | 55.3 steps/s
Avg test loss: 0.13681, Avg test acc: 0.97362, Avg tpr: 0.95483, Avg fpr: 0.02604, total FA: 3616

server round 14/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=28001 Epoch=54.6] | Loss=0.01135 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.289 | L2-Norm(final)=14.441 | 4225.9 samples/s | 66.0 steps/s
[Step=28050 Epoch=54.7] | Loss=0.01935 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.291 | L2-Norm(final)=14.461 | 5260.7 samples/s | 82.2 steps/s
[Step=28100 Epoch=54.8] | Loss=0.01979 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.291 | L2-Norm(final)=14.482 | 5514.3 samples/s | 86.2 steps/s
[Step=28150 Epoch=54.9] | Loss=0.01964 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.291 | L2-Norm(final)=14.503 | 5518.6 samples/s | 86.2 steps/s
[Step=28200 Epoch=55.0] | Loss=0.01878 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.291 | L2-Norm(final)=14.524 | 5577.9 samples/s | 87.2 steps/s
[Step=28250 Epoch=55.1] | Loss=0.01914 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.291 | L2-Norm(final)=14.544 | 5615.4 samples/s | 87.7 steps/s
[Step=28300 Epoch=55.2] | Loss=0.01876 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.292 | L2-Norm(final)=14.563 | 5490.1 samples/s | 85.8 steps/s
[Step=28350 Epoch=55.3] | Loss=0.01867 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.292 | L2-Norm(final)=14.582 | 5561.2 samples/s | 86.9 steps/s
[Step=28400 Epoch=55.4] | Loss=0.01854 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.292 | L2-Norm(final)=14.600 | 5613.4 samples/s | 87.7 steps/s
[Step=28450 Epoch=55.5] | Loss=0.01880 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.292 | L2-Norm(final)=14.616 | 5532.5 samples/s | 86.4 steps/s
[Step=28500 Epoch=55.6] | Loss=0.01891 | Reg=0.00177 | acc=0.9375 | L2-Norm=13.292 | L2-Norm(final)=14.631 | 7057.6 samples/s | 110.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=28501 Epoch=55.6] | Loss=0.01563 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.292 | L2-Norm(final)=14.782 | 4860.0 samples/s | 75.9 steps/s
[Step=28550 Epoch=55.7] | Loss=0.01945 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=14.778 | 4318.4 samples/s | 67.5 steps/s
[Step=28600 Epoch=55.8] | Loss=0.01897 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.399 | L2-Norm(final)=14.777 | 4739.2 samples/s | 74.0 steps/s
[Step=28650 Epoch=55.9] | Loss=0.01953 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.432 | L2-Norm(final)=14.775 | 4825.8 samples/s | 75.4 steps/s
[Step=28700 Epoch=56.0] | Loss=0.01974 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=14.772 | 4755.6 samples/s | 74.3 steps/s
[Step=28750 Epoch=56.1] | Loss=0.01996 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.491 | L2-Norm(final)=14.770 | 4773.6 samples/s | 74.6 steps/s
[Step=28800 Epoch=56.2] | Loss=0.02018 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.515 | L2-Norm(final)=14.768 | 4793.3 samples/s | 74.9 steps/s
[Step=28850 Epoch=56.3] | Loss=0.01971 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.536 | L2-Norm(final)=14.766 | 4775.0 samples/s | 74.6 steps/s
[Step=28900 Epoch=56.4] | Loss=0.01974 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.554 | L2-Norm(final)=14.764 | 4815.9 samples/s | 75.2 steps/s
[Step=28950 Epoch=56.5] | Loss=0.01976 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.572 | L2-Norm(final)=14.763 | 4802.6 samples/s | 75.0 steps/s
[Step=29000 Epoch=56.6] | Loss=0.01947 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.588 | L2-Norm(final)=14.762 | 5828.6 samples/s | 91.1 steps/s
[Step=29050 Epoch=56.7] | Loss=0.01886 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.603 | L2-Norm(final)=14.761 | 1975.7 samples/s | 30.9 steps/s
[Step=29100 Epoch=56.8] | Loss=0.01852 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=14.761 | 4781.5 samples/s | 74.7 steps/s
[Step=29150 Epoch=56.9] | Loss=0.01798 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.632 | L2-Norm(final)=14.761 | 4815.9 samples/s | 75.2 steps/s
[Step=29200 Epoch=57.0] | Loss=0.01765 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.645 | L2-Norm(final)=14.761 | 4846.1 samples/s | 75.7 steps/s
[Step=29250 Epoch=57.0] | Loss=0.01725 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.658 | L2-Norm(final)=14.761 | 4757.7 samples/s | 74.3 steps/s
[Step=29300 Epoch=57.1] | Loss=0.01712 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.669 | L2-Norm(final)=14.761 | 4819.6 samples/s | 75.3 steps/s
[Step=29350 Epoch=57.2] | Loss=0.01669 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.680 | L2-Norm(final)=14.761 | 4793.8 samples/s | 74.9 steps/s
[Step=29400 Epoch=57.3] | Loss=0.01673 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.690 | L2-Norm(final)=14.761 | 4785.9 samples/s | 74.8 steps/s
[Step=29450 Epoch=57.4] | Loss=0.01665 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.700 | L2-Norm(final)=14.761 | 4792.6 samples/s | 74.9 steps/s
[Step=29500 Epoch=57.5] | Loss=0.01647 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.709 | L2-Norm(final)=14.761 | 5038.0 samples/s | 78.7 steps/s
[Step=29550 Epoch=57.6] | Loss=0.01631 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.719 | L2-Norm(final)=14.761 | 2176.5 samples/s | 34.0 steps/s
[Step=29600 Epoch=57.7] | Loss=0.01609 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.728 | L2-Norm(final)=14.761 | 4792.3 samples/s | 74.9 steps/s
[Step=29650 Epoch=57.8] | Loss=0.01596 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.736 | L2-Norm(final)=14.761 | 4808.5 samples/s | 75.1 steps/s
[Step=29700 Epoch=57.9] | Loss=0.01586 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.744 | L2-Norm(final)=14.760 | 4784.7 samples/s | 74.8 steps/s
[Step=29750 Epoch=58.0] | Loss=0.01569 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.753 | L2-Norm(final)=14.760 | 4785.9 samples/s | 74.8 steps/s
[Step=29800 Epoch=58.1] | Loss=0.01551 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.761 | L2-Norm(final)=14.760 | 4843.8 samples/s | 75.7 steps/s
[Step=29850 Epoch=58.2] | Loss=0.01535 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.769 | L2-Norm(final)=14.760 | 4765.6 samples/s | 74.5 steps/s
[Step=29900 Epoch=58.3] | Loss=0.01523 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.776 | L2-Norm(final)=14.760 | 4839.5 samples/s | 75.6 steps/s
[Step=29950 Epoch=58.4] | Loss=0.01520 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.784 | L2-Norm(final)=14.760 | 4772.0 samples/s | 74.6 steps/s
[Step=30000 Epoch=58.5] | Loss=0.01515 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.792 | L2-Norm(final)=14.760 | 4802.2 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step30000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=28001 Epoch=54.7] | Loss=0.01145 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.289 | L2-Norm(final)=14.846 | 4353.3 samples/s | 68.0 steps/s
[Step=28050 Epoch=54.8] | Loss=0.01655 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=14.864 | 4982.7 samples/s | 77.9 steps/s
[Step=28100 Epoch=54.9] | Loss=0.01837 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.290 | L2-Norm(final)=14.888 | 5580.1 samples/s | 87.2 steps/s
[Step=28150 Epoch=55.0] | Loss=0.01794 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=14.909 | 5425.4 samples/s | 84.8 steps/s
[Step=28200 Epoch=55.1] | Loss=0.01774 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.290 | L2-Norm(final)=14.927 | 5439.7 samples/s | 85.0 steps/s
[Step=28250 Epoch=55.2] | Loss=0.01803 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.290 | L2-Norm(final)=14.945 | 5591.5 samples/s | 87.4 steps/s
[Step=28300 Epoch=55.3] | Loss=0.01848 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.290 | L2-Norm(final)=14.962 | 5487.1 samples/s | 85.7 steps/s
[Step=28350 Epoch=55.4] | Loss=0.01856 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.290 | L2-Norm(final)=14.977 | 5478.7 samples/s | 85.6 steps/s
[Step=28400 Epoch=55.5] | Loss=0.01855 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=14.991 | 5478.6 samples/s | 85.6 steps/s
[Step=28450 Epoch=55.6] | Loss=0.01830 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.290 | L2-Norm(final)=15.006 | 5480.1 samples/s | 85.6 steps/s
[Step=28500 Epoch=55.7] | Loss=0.01822 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.290 | L2-Norm(final)=15.020 | 7150.7 samples/s | 111.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=28501 Epoch=55.7] | Loss=0.00873 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=15.166 | 4747.8 samples/s | 74.2 steps/s
[Step=28550 Epoch=55.8] | Loss=0.01921 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.353 | L2-Norm(final)=15.172 | 4428.4 samples/s | 69.2 steps/s
[Step=28600 Epoch=55.9] | Loss=0.02056 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.399 | L2-Norm(final)=15.162 | 4770.7 samples/s | 74.5 steps/s
[Step=28650 Epoch=56.0] | Loss=0.02109 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.433 | L2-Norm(final)=15.155 | 4841.6 samples/s | 75.7 steps/s
[Step=28700 Epoch=56.1] | Loss=0.02042 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.460 | L2-Norm(final)=15.150 | 4716.5 samples/s | 73.7 steps/s
[Step=28750 Epoch=56.2] | Loss=0.02056 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.483 | L2-Norm(final)=15.146 | 4707.0 samples/s | 73.5 steps/s
[Step=28800 Epoch=56.3] | Loss=0.02058 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.502 | L2-Norm(final)=15.141 | 4826.0 samples/s | 75.4 steps/s
[Step=28850 Epoch=56.4] | Loss=0.02082 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.519 | L2-Norm(final)=15.138 | 4753.4 samples/s | 74.3 steps/s
[Step=28900 Epoch=56.5] | Loss=0.02096 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.538 | L2-Norm(final)=15.134 | 4821.0 samples/s | 75.3 steps/s
[Step=28950 Epoch=56.6] | Loss=0.02093 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.555 | L2-Norm(final)=15.132 | 4731.1 samples/s | 73.9 steps/s
[Step=29000 Epoch=56.7] | Loss=0.02030 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.571 | L2-Norm(final)=15.130 | 5908.9 samples/s | 92.3 steps/s
[Step=29050 Epoch=56.8] | Loss=0.01974 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.585 | L2-Norm(final)=15.129 | 2093.5 samples/s | 32.7 steps/s
[Step=29100 Epoch=56.9] | Loss=0.01918 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.598 | L2-Norm(final)=15.128 | 4755.5 samples/s | 74.3 steps/s
[Step=29150 Epoch=57.0] | Loss=0.01830 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.610 | L2-Norm(final)=15.128 | 4785.0 samples/s | 74.8 steps/s
[Step=29200 Epoch=57.1] | Loss=0.01797 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.621 | L2-Norm(final)=15.128 | 4740.1 samples/s | 74.1 steps/s
[Step=29250 Epoch=57.2] | Loss=0.01772 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.631 | L2-Norm(final)=15.127 | 4784.1 samples/s | 74.8 steps/s
[Step=29300 Epoch=57.3] | Loss=0.01746 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.641 | L2-Norm(final)=15.127 | 4805.0 samples/s | 75.1 steps/s
[Step=29350 Epoch=57.4] | Loss=0.01716 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.650 | L2-Norm(final)=15.127 | 4825.4 samples/s | 75.4 steps/s
[Step=29400 Epoch=57.5] | Loss=0.01716 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.659 | L2-Norm(final)=15.127 | 4820.5 samples/s | 75.3 steps/s
[Step=29450 Epoch=57.6] | Loss=0.01697 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.667 | L2-Norm(final)=15.127 | 4804.9 samples/s | 75.1 steps/s
[Step=29500 Epoch=57.7] | Loss=0.01698 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.675 | L2-Norm(final)=15.127 | 5112.8 samples/s | 79.9 steps/s
[Step=29550 Epoch=57.8] | Loss=0.01664 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=15.127 | 2199.6 samples/s | 34.4 steps/s
[Step=29600 Epoch=57.9] | Loss=0.01632 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.692 | L2-Norm(final)=15.127 | 4817.7 samples/s | 75.3 steps/s
[Step=29650 Epoch=58.0] | Loss=0.01623 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.700 | L2-Norm(final)=15.127 | 4840.5 samples/s | 75.6 steps/s
[Step=29700 Epoch=58.1] | Loss=0.01600 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.708 | L2-Norm(final)=15.127 | 4731.2 samples/s | 73.9 steps/s
[Step=29750 Epoch=58.2] | Loss=0.01583 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.716 | L2-Norm(final)=15.127 | 4782.0 samples/s | 74.7 steps/s
[Step=29800 Epoch=58.3] | Loss=0.01572 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.724 | L2-Norm(final)=15.127 | 4777.7 samples/s | 74.7 steps/s
[Step=29850 Epoch=58.4] | Loss=0.01562 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.732 | L2-Norm(final)=15.127 | 4802.6 samples/s | 75.0 steps/s
[Step=29900 Epoch=58.5] | Loss=0.01551 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.740 | L2-Norm(final)=15.127 | 4777.5 samples/s | 74.6 steps/s
[Step=29950 Epoch=58.6] | Loss=0.01534 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.748 | L2-Norm(final)=15.127 | 4782.8 samples/s | 74.7 steps/s
[Step=30000 Epoch=58.6] | Loss=0.01534 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.756 | L2-Norm(final)=15.127 | 4790.8 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step30000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=28001 Epoch=107.3] | Loss=0.00004 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.289 | L2-Norm(final)=14.318 | 4565.1 samples/s | 71.3 steps/s
[Step=28050 Epoch=107.5] | Loss=0.00143 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=14.328 | 4403.2 samples/s | 68.8 steps/s
[Step=28100 Epoch=107.7] | Loss=0.00111 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=14.338 | 5083.4 samples/s | 79.4 steps/s
[Step=28150 Epoch=107.9] | Loss=0.00123 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=14.349 | 5175.4 samples/s | 80.9 steps/s
[Step=28200 Epoch=108.1] | Loss=0.00151 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=14.358 | 5293.1 samples/s | 82.7 steps/s
[Step=28250 Epoch=108.2] | Loss=0.00152 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=14.365 | 6764.3 samples/s | 105.7 steps/s
[Step=28300 Epoch=108.4] | Loss=0.00161 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=14.372 | 2145.8 samples/s | 33.5 steps/s
[Step=28350 Epoch=108.6] | Loss=0.00163 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=14.381 | 5105.5 samples/s | 79.8 steps/s
[Step=28400 Epoch=108.8] | Loss=0.00150 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=14.389 | 5293.4 samples/s | 82.7 steps/s
[Step=28450 Epoch=109.0] | Loss=0.00142 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=14.397 | 5168.2 samples/s | 80.8 steps/s
[Step=28500 Epoch=109.2] | Loss=0.00142 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=14.406 | 5901.6 samples/s | 92.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=28501 Epoch=109.2] | Loss=0.00008 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=14.489 | 4323.5 samples/s | 67.6 steps/s
[Step=28550 Epoch=109.4] | Loss=0.00310 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.298 | L2-Norm(final)=14.488 | 4511.9 samples/s | 70.5 steps/s
[Step=28600 Epoch=109.6] | Loss=0.00375 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.412 | L2-Norm(final)=14.477 | 4574.6 samples/s | 71.5 steps/s
[Step=28650 Epoch=109.8] | Loss=0.00441 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.491 | L2-Norm(final)=14.463 | 4586.1 samples/s | 71.7 steps/s
[Step=28700 Epoch=110.0] | Loss=0.00455 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.543 | L2-Norm(final)=14.449 | 4550.3 samples/s | 71.1 steps/s
[Step=28750 Epoch=110.2] | Loss=0.00404 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.582 | L2-Norm(final)=14.438 | 5714.8 samples/s | 89.3 steps/s
[Step=28800 Epoch=110.4] | Loss=0.00382 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=14.429 | 1998.0 samples/s | 31.2 steps/s
[Step=28850 Epoch=110.5] | Loss=0.00344 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.640 | L2-Norm(final)=14.422 | 4562.7 samples/s | 71.3 steps/s
[Step=28900 Epoch=110.7] | Loss=0.00305 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.658 | L2-Norm(final)=14.416 | 4578.6 samples/s | 71.5 steps/s
[Step=28950 Epoch=110.9] | Loss=0.00271 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.672 | L2-Norm(final)=14.413 | 4469.2 samples/s | 69.8 steps/s
[Step=29000 Epoch=111.1] | Loss=0.00247 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.680 | L2-Norm(final)=14.410 | 4799.3 samples/s | 75.0 steps/s
[Step=29050 Epoch=111.3] | Loss=0.00225 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.686 | L2-Norm(final)=14.408 | 2006.3 samples/s | 31.3 steps/s
[Step=29100 Epoch=111.5] | Loss=0.00206 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.690 | L2-Norm(final)=14.406 | 4183.7 samples/s | 65.4 steps/s
[Step=29150 Epoch=111.7] | Loss=0.00190 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.691 | L2-Norm(final)=14.405 | 4093.4 samples/s | 64.0 steps/s
[Step=29200 Epoch=111.9] | Loss=0.00177 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.691 | L2-Norm(final)=14.404 | 4336.8 samples/s | 67.8 steps/s
[Step=29250 Epoch=112.1] | Loss=0.00165 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.690 | L2-Norm(final)=14.403 | 4557.0 samples/s | 71.2 steps/s
[Step=29300 Epoch=112.3] | Loss=0.00155 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.688 | L2-Norm(final)=14.402 | 2190.6 samples/s | 34.2 steps/s
[Step=29350 Epoch=112.5] | Loss=0.00146 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.685 | L2-Norm(final)=14.402 | 4640.1 samples/s | 72.5 steps/s
[Step=29400 Epoch=112.7] | Loss=0.00138 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.682 | L2-Norm(final)=14.401 | 4498.6 samples/s | 70.3 steps/s
[Step=29450 Epoch=112.8] | Loss=0.00130 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.678 | L2-Norm(final)=14.401 | 4625.7 samples/s | 72.3 steps/s
[Step=29500 Epoch=113.0] | Loss=0.00124 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.674 | L2-Norm(final)=14.400 | 4499.9 samples/s | 70.3 steps/s
[Step=29550 Epoch=113.2] | Loss=0.00118 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.669 | L2-Norm(final)=14.400 | 2193.3 samples/s | 34.3 steps/s
[Step=29600 Epoch=113.4] | Loss=0.00113 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.664 | L2-Norm(final)=14.400 | 4573.8 samples/s | 71.5 steps/s
[Step=29650 Epoch=113.6] | Loss=0.00108 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.659 | L2-Norm(final)=14.400 | 4483.8 samples/s | 70.1 steps/s
[Step=29700 Epoch=113.8] | Loss=0.00103 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.654 | L2-Norm(final)=14.400 | 4576.2 samples/s | 71.5 steps/s
[Step=29750 Epoch=114.0] | Loss=0.00099 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.648 | L2-Norm(final)=14.401 | 4545.2 samples/s | 71.0 steps/s
[Step=29800 Epoch=114.2] | Loss=0.00095 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.642 | L2-Norm(final)=14.401 | 6190.0 samples/s | 96.7 steps/s
[Step=29850 Epoch=114.4] | Loss=0.00092 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.636 | L2-Norm(final)=14.402 | 1960.7 samples/s | 30.6 steps/s
[Step=29900 Epoch=114.6] | Loss=0.00089 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.629 | L2-Norm(final)=14.403 | 4489.9 samples/s | 70.2 steps/s
[Step=29950 Epoch=114.8] | Loss=0.00086 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.623 | L2-Norm(final)=14.404 | 4593.5 samples/s | 71.8 steps/s
[Step=30000 Epoch=114.9] | Loss=0.00083 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.616 | L2-Norm(final)=14.405 | 4540.7 samples/s | 70.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step30000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=28001 Epoch=107.8] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.289 | L2-Norm(final)=15.667 | 4440.8 samples/s | 69.4 steps/s
[Step=28050 Epoch=108.0] | Loss=0.00145 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.287 | L2-Norm(final)=15.664 | 4933.8 samples/s | 77.1 steps/s
[Step=28100 Epoch=108.2] | Loss=0.00101 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.286 | L2-Norm(final)=15.669 | 5214.3 samples/s | 81.5 steps/s
[Step=28150 Epoch=108.4] | Loss=0.00079 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=15.674 | 5213.5 samples/s | 81.5 steps/s
[Step=28200 Epoch=108.6] | Loss=0.00062 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=15.679 | 5332.4 samples/s | 83.3 steps/s
[Step=28250 Epoch=108.7] | Loss=0.00077 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=15.683 | 6745.9 samples/s | 105.4 steps/s
[Step=28300 Epoch=108.9] | Loss=0.00067 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=15.687 | 2141.7 samples/s | 33.5 steps/s
[Step=28350 Epoch=109.1] | Loss=0.00066 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=15.690 | 5181.2 samples/s | 81.0 steps/s
[Step=28400 Epoch=109.3] | Loss=0.00060 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=15.694 | 5209.3 samples/s | 81.4 steps/s
[Step=28450 Epoch=109.5] | Loss=0.00060 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=15.698 | 5227.9 samples/s | 81.7 steps/s
[Step=28500 Epoch=109.7] | Loss=0.00064 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=15.703 | 6010.0 samples/s | 93.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=28501 Epoch=109.7] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=15.749 | 4466.7 samples/s | 69.8 steps/s
[Step=28550 Epoch=109.9] | Loss=0.00268 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.294 | L2-Norm(final)=15.750 | 4453.8 samples/s | 69.6 steps/s
[Step=28600 Epoch=110.1] | Loss=0.00477 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.393 | L2-Norm(final)=15.739 | 4564.8 samples/s | 71.3 steps/s
[Step=28650 Epoch=110.3] | Loss=0.00404 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.465 | L2-Norm(final)=15.726 | 4529.1 samples/s | 70.8 steps/s
[Step=28700 Epoch=110.5] | Loss=0.00325 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.508 | L2-Norm(final)=15.720 | 4565.6 samples/s | 71.3 steps/s
[Step=28750 Epoch=110.7] | Loss=0.00266 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.532 | L2-Norm(final)=15.718 | 5783.8 samples/s | 90.4 steps/s
[Step=28800 Epoch=110.9] | Loss=0.00224 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=15.717 | 2005.0 samples/s | 31.3 steps/s
[Step=28850 Epoch=111.1] | Loss=0.00237 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=15.715 | 4496.2 samples/s | 70.3 steps/s
[Step=28900 Epoch=111.2] | Loss=0.00209 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.567 | L2-Norm(final)=15.712 | 4547.9 samples/s | 71.1 steps/s
[Step=28950 Epoch=111.4] | Loss=0.00186 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.574 | L2-Norm(final)=15.710 | 4553.0 samples/s | 71.1 steps/s
[Step=29000 Epoch=111.6] | Loss=0.00168 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.577 | L2-Norm(final)=15.708 | 5193.5 samples/s | 81.1 steps/s
[Step=29050 Epoch=111.8] | Loss=0.00153 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.579 | L2-Norm(final)=15.707 | 2087.7 samples/s | 32.6 steps/s
[Step=29100 Epoch=112.0] | Loss=0.00140 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.579 | L2-Norm(final)=15.706 | 4563.2 samples/s | 71.3 steps/s
[Step=29150 Epoch=112.2] | Loss=0.00129 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.577 | L2-Norm(final)=15.705 | 4600.9 samples/s | 71.9 steps/s
[Step=29200 Epoch=112.4] | Loss=0.00120 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.575 | L2-Norm(final)=15.704 | 4540.2 samples/s | 70.9 steps/s
[Step=29250 Epoch=112.6] | Loss=0.00112 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.572 | L2-Norm(final)=15.704 | 4632.5 samples/s | 72.4 steps/s
[Step=29300 Epoch=112.8] | Loss=0.00105 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.568 | L2-Norm(final)=15.703 | 2153.1 samples/s | 33.6 steps/s
[Step=29350 Epoch=113.0] | Loss=0.00099 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=15.703 | 4640.6 samples/s | 72.5 steps/s
[Step=29400 Epoch=113.2] | Loss=0.00094 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.560 | L2-Norm(final)=15.703 | 4594.0 samples/s | 71.8 steps/s
[Step=29450 Epoch=113.4] | Loss=0.00089 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.555 | L2-Norm(final)=15.703 | 4474.4 samples/s | 69.9 steps/s
[Step=29500 Epoch=113.6] | Loss=0.00084 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.550 | L2-Norm(final)=15.702 | 4576.4 samples/s | 71.5 steps/s
[Step=29550 Epoch=113.7] | Loss=0.00080 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.545 | L2-Norm(final)=15.702 | 2213.3 samples/s | 34.6 steps/s
[Step=29600 Epoch=113.9] | Loss=0.00077 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.539 | L2-Norm(final)=15.702 | 4531.3 samples/s | 70.8 steps/s
[Step=29650 Epoch=114.1] | Loss=0.00073 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.533 | L2-Norm(final)=15.702 | 4623.8 samples/s | 72.2 steps/s
[Step=29700 Epoch=114.3] | Loss=0.00070 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.527 | L2-Norm(final)=15.702 | 4570.5 samples/s | 71.4 steps/s
[Step=29750 Epoch=114.5] | Loss=0.00067 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.521 | L2-Norm(final)=15.702 | 4480.0 samples/s | 70.0 steps/s
[Step=29800 Epoch=114.7] | Loss=0.00065 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.515 | L2-Norm(final)=15.702 | 6681.1 samples/s | 104.4 steps/s
[Step=29850 Epoch=114.9] | Loss=0.00062 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.508 | L2-Norm(final)=15.702 | 1912.0 samples/s | 29.9 steps/s
[Step=29900 Epoch=115.1] | Loss=0.00060 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.501 | L2-Norm(final)=15.702 | 4601.0 samples/s | 71.9 steps/s
[Step=29950 Epoch=115.3] | Loss=0.00058 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.495 | L2-Norm(final)=15.702 | 4558.4 samples/s | 71.2 steps/s
[Step=30000 Epoch=115.5] | Loss=0.00056 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.488 | L2-Norm(final)=15.702 | 4476.2 samples/s | 69.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step30000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07777 | acc=0.9654 | tpr=0.9773 | fpr=0.0605 | 4152.4 samples/s | 16.2 steps/s
Avg test loss: 0.07750, Avg test acc: 0.96370, Avg tpr: 0.97575, Avg fpr: 0.06281, total FA: 490

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07522 | acc=0.9643 | tpr=0.9695 | fpr=0.0471 | 4183.8 samples/s | 16.3 steps/s
Avg test loss: 0.07745, Avg test acc: 0.96334, Avg tpr: 0.96870, Avg fpr: 0.04846, total FA: 378

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.57340 | acc=0.3097 | tpr=0.0083 | fpr=0.0359 | 4237.0 samples/s | 16.6 steps/s
Avg test loss: 6.58598, Avg test acc: 0.30680, Avg tpr: 0.00863, Avg fpr: 0.03743, total FA: 292

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.98674 | acc=0.3048 | tpr=0.0080 | fpr=0.0505 | 4202.8 samples/s | 16.4 steps/s
Avg test loss: 7.01949, Avg test acc: 0.30179, Avg tpr: 0.00775, Avg fpr: 0.05153, total FA: 402

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.61457 | acc=0.1353 | tpr=0.5044 | fpr=0.8713 | 4187.9 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.56346 | acc=0.1354 | tpr=0.5096 | fpr=0.8716 | 7861.2 samples/s | 30.7 steps/s
[Step= 150] | Loss=6.56439 | acc=0.1350 | tpr=0.5058 | fpr=0.8719 | 8042.6 samples/s | 31.4 steps/s
[Step= 200] | Loss=6.56169 | acc=0.1347 | tpr=0.4973 | fpr=0.8719 | 7808.9 samples/s | 30.5 steps/s
[Step= 250] | Loss=6.55489 | acc=0.1346 | tpr=0.4882 | fpr=0.8719 | 7898.3 samples/s | 30.9 steps/s
[Step= 300] | Loss=6.55529 | acc=0.1340 | tpr=0.4822 | fpr=0.8723 | 7736.1 samples/s | 30.2 steps/s
[Step= 350] | Loss=6.56179 | acc=0.1331 | tpr=0.4778 | fpr=0.8731 | 7944.8 samples/s | 31.0 steps/s
[Step= 400] | Loss=6.55017 | acc=0.1331 | tpr=0.4699 | fpr=0.8730 | 7977.1 samples/s | 31.2 steps/s
[Step= 450] | Loss=6.55428 | acc=0.1325 | tpr=0.4684 | fpr=0.8736 | 7992.7 samples/s | 31.2 steps/s
[Step= 500] | Loss=6.55247 | acc=0.1323 | tpr=0.4714 | fpr=0.8739 | 7547.5 samples/s | 29.5 steps/s
[Step= 550] | Loss=6.55508 | acc=0.1325 | tpr=0.4739 | fpr=0.8737 | 14748.9 samples/s | 57.6 steps/s
Avg test loss: 6.55714, Avg test acc: 0.13237, Avg tpr: 0.47385, Avg fpr: 0.87384, total FA: 121331

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.29442 | acc=0.1578 | tpr=0.5752 | fpr=0.8497 | 4219.6 samples/s | 16.5 steps/s
[Step= 100] | Loss=6.23876 | acc=0.1574 | tpr=0.5800 | fpr=0.8505 | 7728.7 samples/s | 30.2 steps/s
[Step= 150] | Loss=6.24414 | acc=0.1562 | tpr=0.5720 | fpr=0.8514 | 7824.5 samples/s | 30.6 steps/s
[Step= 200] | Loss=6.24223 | acc=0.1563 | tpr=0.5617 | fpr=0.8510 | 7797.3 samples/s | 30.5 steps/s
[Step= 250] | Loss=6.23624 | acc=0.1568 | tpr=0.5546 | fpr=0.8504 | 7947.7 samples/s | 31.0 steps/s
[Step= 300] | Loss=6.24232 | acc=0.1567 | tpr=0.5476 | fpr=0.8505 | 7855.3 samples/s | 30.7 steps/s
[Step= 350] | Loss=6.24999 | acc=0.1563 | tpr=0.5448 | fpr=0.8507 | 7995.1 samples/s | 31.2 steps/s
[Step= 400] | Loss=6.23994 | acc=0.1558 | tpr=0.5388 | fpr=0.8512 | 7651.7 samples/s | 29.9 steps/s
[Step= 450] | Loss=6.24218 | acc=0.1557 | tpr=0.5380 | fpr=0.8512 | 7868.0 samples/s | 30.7 steps/s
[Step= 500] | Loss=6.24227 | acc=0.1558 | tpr=0.5454 | fpr=0.8513 | 8028.8 samples/s | 31.4 steps/s
[Step= 550] | Loss=6.24238 | acc=0.1561 | tpr=0.5476 | fpr=0.8511 | 14776.1 samples/s | 57.7 steps/s
Avg test loss: 6.24339, Avg test acc: 0.15593, Avg tpr: 0.54635, Avg fpr: 0.85117, total FA: 118183

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10954 | acc=0.9794 | tpr=0.9248 | fpr=0.0196 | 4179.8 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.11921 | acc=0.9784 | tpr=0.9424 | fpr=0.0209 | 7881.1 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.12180 | acc=0.9777 | tpr=0.9510 | fpr=0.0218 | 7837.9 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.12234 | acc=0.9780 | tpr=0.9552 | fpr=0.0216 | 7920.6 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.12260 | acc=0.9782 | tpr=0.9546 | fpr=0.0214 | 7945.0 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.12403 | acc=0.9779 | tpr=0.9535 | fpr=0.0216 | 7800.3 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.12433 | acc=0.9778 | tpr=0.9524 | fpr=0.0217 | 8062.7 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.12596 | acc=0.9775 | tpr=0.9486 | fpr=0.0220 | 7680.9 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.12748 | acc=0.9773 | tpr=0.9484 | fpr=0.0222 | 7822.7 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.12739 | acc=0.9772 | tpr=0.9485 | fpr=0.0222 | 7666.3 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.12656 | acc=0.9774 | tpr=0.9483 | fpr=0.0220 | 14953.1 samples/s | 58.4 steps/s
Avg test loss: 0.12621, Avg test acc: 0.97747, Avg tpr: 0.94810, Avg fpr: 0.02200, total FA: 3054

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15987 | acc=0.9763 | tpr=0.9115 | fpr=0.0225 | 4221.3 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.17537 | acc=0.9753 | tpr=0.9339 | fpr=0.0239 | 7664.5 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.17911 | acc=0.9748 | tpr=0.9452 | fpr=0.0247 | 7833.3 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.17841 | acc=0.9749 | tpr=0.9497 | fpr=0.0247 | 8088.3 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.17808 | acc=0.9749 | tpr=0.9502 | fpr=0.0247 | 7822.1 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.18019 | acc=0.9748 | tpr=0.9520 | fpr=0.0248 | 7828.6 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.17970 | acc=0.9749 | tpr=0.9518 | fpr=0.0247 | 8107.5 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.18060 | acc=0.9748 | tpr=0.9519 | fpr=0.0248 | 7752.4 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.18387 | acc=0.9746 | tpr=0.9513 | fpr=0.0250 | 7914.1 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.18357 | acc=0.9746 | tpr=0.9520 | fpr=0.0249 | 7820.7 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.18251 | acc=0.9749 | tpr=0.9507 | fpr=0.0247 | 14493.4 samples/s | 56.6 steps/s
Avg test loss: 0.18215, Avg test acc: 0.97493, Avg tpr: 0.95087, Avg fpr: 0.02463, total FA: 3420

server round 15/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=30001 Epoch=58.5] | Loss=0.03151 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.334 | L2-Norm(final)=14.763 | 4153.8 samples/s | 64.9 steps/s
[Step=30050 Epoch=58.6] | Loss=0.03930 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.339 | L2-Norm(final)=14.773 | 4987.3 samples/s | 77.9 steps/s
[Step=30100 Epoch=58.7] | Loss=0.03558 | Reg=0.00178 | acc=0.9375 | L2-Norm=13.339 | L2-Norm(final)=14.793 | 5524.1 samples/s | 86.3 steps/s
[Step=30150 Epoch=58.8] | Loss=0.03568 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.339 | L2-Norm(final)=14.815 | 5539.6 samples/s | 86.6 steps/s
[Step=30200 Epoch=58.9] | Loss=0.03426 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.340 | L2-Norm(final)=14.837 | 5539.6 samples/s | 86.6 steps/s
[Step=30250 Epoch=59.0] | Loss=0.03350 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.340 | L2-Norm(final)=14.859 | 5624.9 samples/s | 87.9 steps/s
[Step=30300 Epoch=59.1] | Loss=0.03303 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.340 | L2-Norm(final)=14.881 | 5461.4 samples/s | 85.3 steps/s
[Step=30350 Epoch=59.2] | Loss=0.03246 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.340 | L2-Norm(final)=14.903 | 5530.4 samples/s | 86.4 steps/s
[Step=30400 Epoch=59.3] | Loss=0.03199 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.340 | L2-Norm(final)=14.926 | 5579.0 samples/s | 87.2 steps/s
[Step=30450 Epoch=59.4] | Loss=0.03192 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=14.949 | 5606.0 samples/s | 87.6 steps/s
[Step=30500 Epoch=59.5] | Loss=0.03209 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=14.972 | 6872.3 samples/s | 107.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=30501 Epoch=59.5] | Loss=0.01429 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.340 | L2-Norm(final)=15.201 | 4458.7 samples/s | 69.7 steps/s
[Step=30550 Epoch=59.6] | Loss=0.02433 | Reg=0.00180 | acc=0.9375 | L2-Norm=13.407 | L2-Norm(final)=15.217 | 4284.1 samples/s | 66.9 steps/s
[Step=30600 Epoch=59.7] | Loss=0.02364 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=15.207 | 4792.8 samples/s | 74.9 steps/s
[Step=30650 Epoch=59.8] | Loss=0.02399 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.526 | L2-Norm(final)=15.200 | 4760.1 samples/s | 74.4 steps/s
[Step=30700 Epoch=59.9] | Loss=0.02342 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.556 | L2-Norm(final)=15.196 | 4771.7 samples/s | 74.6 steps/s
[Step=30750 Epoch=60.0] | Loss=0.02404 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.581 | L2-Norm(final)=15.192 | 4757.9 samples/s | 74.3 steps/s
[Step=30800 Epoch=60.1] | Loss=0.02437 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.606 | L2-Norm(final)=15.189 | 4782.9 samples/s | 74.7 steps/s
[Step=30850 Epoch=60.2] | Loss=0.02377 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.628 | L2-Norm(final)=15.186 | 4797.0 samples/s | 75.0 steps/s
[Step=30900 Epoch=60.3] | Loss=0.02314 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.647 | L2-Norm(final)=15.184 | 4832.8 samples/s | 75.5 steps/s
[Step=30950 Epoch=60.4] | Loss=0.02264 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.663 | L2-Norm(final)=15.182 | 4708.0 samples/s | 73.6 steps/s
[Step=31000 Epoch=60.5] | Loss=0.02231 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.678 | L2-Norm(final)=15.181 | 5840.3 samples/s | 91.3 steps/s
[Step=31050 Epoch=60.6] | Loss=0.02131 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.691 | L2-Norm(final)=15.179 | 2074.5 samples/s | 32.4 steps/s
[Step=31100 Epoch=60.7] | Loss=0.02062 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.703 | L2-Norm(final)=15.178 | 4792.2 samples/s | 74.9 steps/s
[Step=31150 Epoch=60.8] | Loss=0.01993 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.713 | L2-Norm(final)=15.177 | 4887.6 samples/s | 76.4 steps/s
[Step=31200 Epoch=60.9] | Loss=0.01950 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.722 | L2-Norm(final)=15.177 | 4723.8 samples/s | 73.8 steps/s
[Step=31250 Epoch=60.9] | Loss=0.01916 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.732 | L2-Norm(final)=15.176 | 4786.9 samples/s | 74.8 steps/s
[Step=31300 Epoch=61.0] | Loss=0.01882 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=15.175 | 4795.3 samples/s | 74.9 steps/s
[Step=31350 Epoch=61.1] | Loss=0.01825 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.749 | L2-Norm(final)=15.174 | 4786.4 samples/s | 74.8 steps/s
[Step=31400 Epoch=61.2] | Loss=0.01777 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.757 | L2-Norm(final)=15.174 | 4765.6 samples/s | 74.5 steps/s
[Step=31450 Epoch=61.3] | Loss=0.01772 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=15.173 | 4891.5 samples/s | 76.4 steps/s
[Step=31500 Epoch=61.4] | Loss=0.01770 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.772 | L2-Norm(final)=15.173 | 5003.4 samples/s | 78.2 steps/s
[Step=31550 Epoch=61.5] | Loss=0.01733 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.780 | L2-Norm(final)=15.172 | 2182.9 samples/s | 34.1 steps/s
[Step=31600 Epoch=61.6] | Loss=0.01713 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.788 | L2-Norm(final)=15.172 | 4741.8 samples/s | 74.1 steps/s
[Step=31650 Epoch=61.7] | Loss=0.01683 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.796 | L2-Norm(final)=15.172 | 4780.8 samples/s | 74.7 steps/s
[Step=31700 Epoch=61.8] | Loss=0.01661 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=15.172 | 4843.8 samples/s | 75.7 steps/s
[Step=31750 Epoch=61.9] | Loss=0.01636 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.811 | L2-Norm(final)=15.171 | 4677.1 samples/s | 73.1 steps/s
[Step=31800 Epoch=62.0] | Loss=0.01609 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.818 | L2-Norm(final)=15.171 | 4859.8 samples/s | 75.9 steps/s
[Step=31850 Epoch=62.1] | Loss=0.01584 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.825 | L2-Norm(final)=15.171 | 4758.7 samples/s | 74.4 steps/s
[Step=31900 Epoch=62.2] | Loss=0.01569 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.832 | L2-Norm(final)=15.171 | 4807.1 samples/s | 75.1 steps/s
[Step=31950 Epoch=62.3] | Loss=0.01551 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=15.171 | 4798.0 samples/s | 75.0 steps/s
[Step=32000 Epoch=62.4] | Loss=0.01532 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.845 | L2-Norm(final)=15.171 | 4828.6 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step32000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=30001 Epoch=58.7] | Loss=0.01586 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=15.122 | 4720.8 samples/s | 73.8 steps/s
[Step=30050 Epoch=58.7] | Loss=0.03201 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=15.146 | 5074.0 samples/s | 79.3 steps/s
[Step=30100 Epoch=58.8] | Loss=0.03186 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.339 | L2-Norm(final)=15.176 | 5537.7 samples/s | 86.5 steps/s
[Step=30150 Epoch=58.9] | Loss=0.03003 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.339 | L2-Norm(final)=15.208 | 5539.3 samples/s | 86.6 steps/s
[Step=30200 Epoch=59.0] | Loss=0.02939 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.339 | L2-Norm(final)=15.241 | 5545.1 samples/s | 86.6 steps/s
[Step=30250 Epoch=59.1] | Loss=0.02898 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.340 | L2-Norm(final)=15.274 | 5584.1 samples/s | 87.3 steps/s
[Step=30300 Epoch=59.2] | Loss=0.02892 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=15.306 | 5440.7 samples/s | 85.0 steps/s
[Step=30350 Epoch=59.3] | Loss=0.02911 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=15.338 | 5605.8 samples/s | 87.6 steps/s
[Step=30400 Epoch=59.4] | Loss=0.02922 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=15.369 | 5493.9 samples/s | 85.8 steps/s
[Step=30450 Epoch=59.5] | Loss=0.02891 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=15.400 | 5532.6 samples/s | 86.4 steps/s
[Step=30500 Epoch=59.6] | Loss=0.02871 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.340 | L2-Norm(final)=15.430 | 7134.3 samples/s | 111.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=30501 Epoch=59.6] | Loss=0.01810 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.340 | L2-Norm(final)=15.725 | 4861.6 samples/s | 76.0 steps/s
[Step=30550 Epoch=59.7] | Loss=0.02333 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.405 | L2-Norm(final)=15.735 | 4361.9 samples/s | 68.2 steps/s
[Step=30600 Epoch=59.8] | Loss=0.02302 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.457 | L2-Norm(final)=15.725 | 4774.6 samples/s | 74.6 steps/s
[Step=30650 Epoch=59.9] | Loss=0.02303 | Reg=0.00182 | acc=0.9219 | L2-Norm=13.493 | L2-Norm(final)=15.719 | 4821.4 samples/s | 75.3 steps/s
[Step=30700 Epoch=60.0] | Loss=0.02310 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=15.714 | 4812.4 samples/s | 75.2 steps/s
[Step=30750 Epoch=60.1] | Loss=0.02205 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.541 | L2-Norm(final)=15.709 | 4808.8 samples/s | 75.1 steps/s
[Step=30800 Epoch=60.2] | Loss=0.02097 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.563 | L2-Norm(final)=15.707 | 4723.9 samples/s | 73.8 steps/s
[Step=30850 Epoch=60.3] | Loss=0.02105 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.583 | L2-Norm(final)=15.704 | 4821.5 samples/s | 75.3 steps/s
[Step=30900 Epoch=60.4] | Loss=0.02130 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.601 | L2-Norm(final)=15.701 | 4868.0 samples/s | 76.1 steps/s
[Step=30950 Epoch=60.5] | Loss=0.02125 | Reg=0.00185 | acc=0.9531 | L2-Norm=13.619 | L2-Norm(final)=15.698 | 4766.3 samples/s | 74.5 steps/s
[Step=31000 Epoch=60.6] | Loss=0.02065 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.634 | L2-Norm(final)=15.695 | 5867.2 samples/s | 91.7 steps/s
[Step=31050 Epoch=60.7] | Loss=0.02022 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.648 | L2-Norm(final)=15.693 | 2085.8 samples/s | 32.6 steps/s
[Step=31100 Epoch=60.8] | Loss=0.01952 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.660 | L2-Norm(final)=15.692 | 4731.2 samples/s | 73.9 steps/s
[Step=31150 Epoch=60.9] | Loss=0.01903 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.671 | L2-Norm(final)=15.691 | 4750.4 samples/s | 74.2 steps/s
[Step=31200 Epoch=61.0] | Loss=0.01875 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.682 | L2-Norm(final)=15.691 | 4734.7 samples/s | 74.0 steps/s
[Step=31250 Epoch=61.1] | Loss=0.01827 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.692 | L2-Norm(final)=15.690 | 4863.2 samples/s | 76.0 steps/s
[Step=31300 Epoch=61.2] | Loss=0.01803 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.702 | L2-Norm(final)=15.690 | 4800.3 samples/s | 75.0 steps/s
[Step=31350 Epoch=61.3] | Loss=0.01778 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.712 | L2-Norm(final)=15.689 | 4780.9 samples/s | 74.7 steps/s
[Step=31400 Epoch=61.4] | Loss=0.01744 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.722 | L2-Norm(final)=15.689 | 4766.9 samples/s | 74.5 steps/s
[Step=31450 Epoch=61.5] | Loss=0.01723 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.731 | L2-Norm(final)=15.688 | 4793.7 samples/s | 74.9 steps/s
[Step=31500 Epoch=61.6] | Loss=0.01723 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.740 | L2-Norm(final)=15.687 | 5153.0 samples/s | 80.5 steps/s
[Step=31550 Epoch=61.7] | Loss=0.01715 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.750 | L2-Norm(final)=15.687 | 2199.7 samples/s | 34.4 steps/s
[Step=31600 Epoch=61.8] | Loss=0.01677 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.759 | L2-Norm(final)=15.686 | 4807.6 samples/s | 75.1 steps/s
[Step=31650 Epoch=61.9] | Loss=0.01650 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.767 | L2-Norm(final)=15.686 | 4735.0 samples/s | 74.0 steps/s
[Step=31700 Epoch=62.0] | Loss=0.01634 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.775 | L2-Norm(final)=15.685 | 4780.0 samples/s | 74.7 steps/s
[Step=31750 Epoch=62.1] | Loss=0.01615 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.783 | L2-Norm(final)=15.684 | 4802.4 samples/s | 75.0 steps/s
[Step=31800 Epoch=62.2] | Loss=0.01596 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.790 | L2-Norm(final)=15.683 | 4779.4 samples/s | 74.7 steps/s
[Step=31850 Epoch=62.3] | Loss=0.01592 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.798 | L2-Norm(final)=15.683 | 4782.9 samples/s | 74.7 steps/s
[Step=31900 Epoch=62.4] | Loss=0.01571 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.805 | L2-Norm(final)=15.682 | 4792.0 samples/s | 74.9 steps/s
[Step=31950 Epoch=62.5] | Loss=0.01552 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.811 | L2-Norm(final)=15.681 | 4768.8 samples/s | 74.5 steps/s
[Step=32000 Epoch=62.6] | Loss=0.01541 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.818 | L2-Norm(final)=15.681 | 4814.4 samples/s | 75.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step32000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=30001 Epoch=115.0] | Loss=0.00003 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=14.437 | 5687.0 samples/s | 88.9 steps/s
[Step=30050 Epoch=115.1] | Loss=0.00115 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.332 | L2-Norm(final)=14.448 | 4104.2 samples/s | 64.1 steps/s
[Step=30100 Epoch=115.3] | Loss=0.00083 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.332 | L2-Norm(final)=14.456 | 5241.8 samples/s | 81.9 steps/s
[Step=30150 Epoch=115.5] | Loss=0.00082 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.332 | L2-Norm(final)=14.464 | 5296.9 samples/s | 82.8 steps/s
[Step=30200 Epoch=115.7] | Loss=0.00069 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.332 | L2-Norm(final)=14.470 | 5112.6 samples/s | 79.9 steps/s
[Step=30250 Epoch=115.9] | Loss=0.00068 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.332 | L2-Norm(final)=14.478 | 6907.1 samples/s | 107.9 steps/s
[Step=30300 Epoch=116.1] | Loss=0.00068 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.332 | L2-Norm(final)=14.485 | 2152.2 samples/s | 33.6 steps/s
[Step=30350 Epoch=116.3] | Loss=0.00067 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=14.494 | 5366.5 samples/s | 83.9 steps/s
[Step=30400 Epoch=116.5] | Loss=0.00071 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=14.502 | 5010.5 samples/s | 78.3 steps/s
[Step=30450 Epoch=116.7] | Loss=0.00071 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=14.509 | 5255.2 samples/s | 82.1 steps/s
[Step=30500 Epoch=116.9] | Loss=0.00067 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=14.517 | 5764.7 samples/s | 90.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=30501 Epoch=116.9] | Loss=0.00003 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=14.589 | 4924.5 samples/s | 76.9 steps/s
[Step=30550 Epoch=117.1] | Loss=0.00138 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=14.590 | 4214.1 samples/s | 65.8 steps/s
[Step=30600 Epoch=117.2] | Loss=0.00163 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=14.590 | 4570.9 samples/s | 71.4 steps/s
[Step=30650 Epoch=117.4] | Loss=0.00208 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.410 | L2-Norm(final)=14.582 | 4577.0 samples/s | 71.5 steps/s
[Step=30700 Epoch=117.6] | Loss=0.00235 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.451 | L2-Norm(final)=14.571 | 4497.8 samples/s | 70.3 steps/s
[Step=30750 Epoch=117.8] | Loss=0.00192 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=14.562 | 5710.7 samples/s | 89.2 steps/s
[Step=30800 Epoch=118.0] | Loss=0.00161 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.497 | L2-Norm(final)=14.557 | 2011.5 samples/s | 31.4 steps/s
[Step=30850 Epoch=118.2] | Loss=0.00153 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.507 | L2-Norm(final)=14.553 | 4505.4 samples/s | 70.4 steps/s
[Step=30900 Epoch=118.4] | Loss=0.00146 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.515 | L2-Norm(final)=14.550 | 4620.2 samples/s | 72.2 steps/s
[Step=30950 Epoch=118.6] | Loss=0.00139 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.523 | L2-Norm(final)=14.547 | 4461.2 samples/s | 69.7 steps/s
[Step=31000 Epoch=118.8] | Loss=0.00127 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.529 | L2-Norm(final)=14.545 | 5035.2 samples/s | 78.7 steps/s
[Step=31050 Epoch=119.0] | Loss=0.00116 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.532 | L2-Norm(final)=14.544 | 2126.8 samples/s | 33.2 steps/s
[Step=31100 Epoch=119.2] | Loss=0.00106 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.533 | L2-Norm(final)=14.543 | 4540.0 samples/s | 70.9 steps/s
[Step=31150 Epoch=119.4] | Loss=0.00098 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.532 | L2-Norm(final)=14.542 | 4552.7 samples/s | 71.1 steps/s
[Step=31200 Epoch=119.5] | Loss=0.00091 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.530 | L2-Norm(final)=14.542 | 4549.5 samples/s | 71.1 steps/s
[Step=31250 Epoch=119.7] | Loss=0.00085 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.527 | L2-Norm(final)=14.542 | 4644.3 samples/s | 72.6 steps/s
[Step=31300 Epoch=119.9] | Loss=0.00080 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.524 | L2-Norm(final)=14.542 | 2197.6 samples/s | 34.3 steps/s
[Step=31350 Epoch=120.1] | Loss=0.00075 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.519 | L2-Norm(final)=14.542 | 4625.2 samples/s | 72.3 steps/s
[Step=31400 Epoch=120.3] | Loss=0.00071 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.514 | L2-Norm(final)=14.542 | 4545.5 samples/s | 71.0 steps/s
[Step=31450 Epoch=120.5] | Loss=0.00067 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.509 | L2-Norm(final)=14.542 | 4537.1 samples/s | 70.9 steps/s
[Step=31500 Epoch=120.7] | Loss=0.00064 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.503 | L2-Norm(final)=14.543 | 4540.0 samples/s | 70.9 steps/s
[Step=31550 Epoch=120.9] | Loss=0.00061 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.497 | L2-Norm(final)=14.543 | 2232.5 samples/s | 34.9 steps/s
[Step=31600 Epoch=121.1] | Loss=0.00058 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.490 | L2-Norm(final)=14.544 | 4474.6 samples/s | 69.9 steps/s
[Step=31650 Epoch=121.3] | Loss=0.00056 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.483 | L2-Norm(final)=14.545 | 4569.9 samples/s | 71.4 steps/s
[Step=31700 Epoch=121.5] | Loss=0.00053 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.476 | L2-Norm(final)=14.546 | 4540.0 samples/s | 70.9 steps/s
[Step=31750 Epoch=121.7] | Loss=0.00051 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.469 | L2-Norm(final)=14.547 | 4567.1 samples/s | 71.4 steps/s
[Step=31800 Epoch=121.8] | Loss=0.00049 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=14.548 | 6149.8 samples/s | 96.1 steps/s
[Step=31850 Epoch=122.0] | Loss=0.00047 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.454 | L2-Norm(final)=14.549 | 1946.0 samples/s | 30.4 steps/s
[Step=31900 Epoch=122.2] | Loss=0.00046 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.446 | L2-Norm(final)=14.550 | 4499.6 samples/s | 70.3 steps/s
[Step=31950 Epoch=122.4] | Loss=0.00044 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=14.552 | 4548.6 samples/s | 71.1 steps/s
[Step=32000 Epoch=122.6] | Loss=0.00043 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.430 | L2-Norm(final)=14.554 | 4581.6 samples/s | 71.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step32000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=30001 Epoch=115.5] | Loss=0.00007 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=15.702 | 4348.6 samples/s | 67.9 steps/s
[Step=30050 Epoch=115.7] | Loss=0.00056 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=15.707 | 4904.3 samples/s | 76.6 steps/s
[Step=30100 Epoch=115.9] | Loss=0.00096 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=15.717 | 5226.4 samples/s | 81.7 steps/s
[Step=30150 Epoch=116.1] | Loss=0.00090 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=15.728 | 5237.0 samples/s | 81.8 steps/s
[Step=30200 Epoch=116.3] | Loss=0.00087 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=15.740 | 5144.5 samples/s | 80.4 steps/s
[Step=30250 Epoch=116.4] | Loss=0.00084 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=15.751 | 7005.1 samples/s | 109.5 steps/s
[Step=30300 Epoch=116.6] | Loss=0.00085 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=15.762 | 2152.1 samples/s | 33.6 steps/s
[Step=30350 Epoch=116.8] | Loss=0.00090 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.333 | L2-Norm(final)=15.773 | 5305.6 samples/s | 82.9 steps/s
[Step=30400 Epoch=117.0] | Loss=0.00087 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=15.784 | 5044.9 samples/s | 78.8 steps/s
[Step=30450 Epoch=117.2] | Loss=0.00080 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=15.794 | 5324.9 samples/s | 83.2 steps/s
[Step=30500 Epoch=117.4] | Loss=0.00078 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=15.804 | 5938.6 samples/s | 92.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=30501 Epoch=117.4] | Loss=0.00367 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=15.904 | 4647.4 samples/s | 72.6 steps/s
[Step=30550 Epoch=117.6] | Loss=0.00233 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=15.906 | 4324.9 samples/s | 67.6 steps/s
[Step=30600 Epoch=117.8] | Loss=0.00288 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.422 | L2-Norm(final)=15.903 | 4559.3 samples/s | 71.2 steps/s
[Step=30650 Epoch=118.0] | Loss=0.00310 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.469 | L2-Norm(final)=15.892 | 4566.3 samples/s | 71.3 steps/s
[Step=30700 Epoch=118.2] | Loss=0.00273 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.510 | L2-Norm(final)=15.884 | 4521.8 samples/s | 70.7 steps/s
[Step=30750 Epoch=118.4] | Loss=0.00236 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.540 | L2-Norm(final)=15.879 | 5893.2 samples/s | 92.1 steps/s
[Step=30800 Epoch=118.6] | Loss=0.00198 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.560 | L2-Norm(final)=15.876 | 1994.9 samples/s | 31.2 steps/s
[Step=30850 Epoch=118.8] | Loss=0.00170 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.572 | L2-Norm(final)=15.875 | 4537.9 samples/s | 70.9 steps/s
[Step=30900 Epoch=118.9] | Loss=0.00149 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.579 | L2-Norm(final)=15.873 | 4546.0 samples/s | 71.0 steps/s
[Step=30950 Epoch=119.1] | Loss=0.00133 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.583 | L2-Norm(final)=15.872 | 4571.1 samples/s | 71.4 steps/s
[Step=31000 Epoch=119.3] | Loss=0.00120 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.584 | L2-Norm(final)=15.872 | 5173.4 samples/s | 80.8 steps/s
[Step=31050 Epoch=119.5] | Loss=0.00109 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.583 | L2-Norm(final)=15.871 | 2096.2 samples/s | 32.8 steps/s
[Step=31100 Epoch=119.7] | Loss=0.00100 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.581 | L2-Norm(final)=15.871 | 4494.6 samples/s | 70.2 steps/s
[Step=31150 Epoch=119.9] | Loss=0.00092 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.578 | L2-Norm(final)=15.872 | 4546.0 samples/s | 71.0 steps/s
[Step=31200 Epoch=120.1] | Loss=0.00085 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.574 | L2-Norm(final)=15.872 | 4562.8 samples/s | 71.3 steps/s
[Step=31250 Epoch=120.3] | Loss=0.00080 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.570 | L2-Norm(final)=15.873 | 4584.0 samples/s | 71.6 steps/s
[Step=31300 Epoch=120.5] | Loss=0.00075 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.565 | L2-Norm(final)=15.873 | 2204.0 samples/s | 34.4 steps/s
[Step=31350 Epoch=120.7] | Loss=0.00070 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.560 | L2-Norm(final)=15.874 | 4625.6 samples/s | 72.3 steps/s
[Step=31400 Epoch=120.9] | Loss=0.00067 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.554 | L2-Norm(final)=15.874 | 4516.1 samples/s | 70.6 steps/s
[Step=31450 Epoch=121.1] | Loss=0.00063 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.548 | L2-Norm(final)=15.875 | 4551.7 samples/s | 71.1 steps/s
[Step=31500 Epoch=121.3] | Loss=0.00060 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.542 | L2-Norm(final)=15.876 | 4606.2 samples/s | 72.0 steps/s
[Step=31550 Epoch=121.4] | Loss=0.00057 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.535 | L2-Norm(final)=15.876 | 2234.0 samples/s | 34.9 steps/s
[Step=31600 Epoch=121.6] | Loss=0.00054 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.528 | L2-Norm(final)=15.877 | 4527.3 samples/s | 70.7 steps/s
[Step=31650 Epoch=121.8] | Loss=0.00052 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.521 | L2-Norm(final)=15.877 | 4538.9 samples/s | 70.9 steps/s
[Step=31700 Epoch=122.0] | Loss=0.00050 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.514 | L2-Norm(final)=15.878 | 4595.9 samples/s | 71.8 steps/s
[Step=31750 Epoch=122.2] | Loss=0.00048 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.507 | L2-Norm(final)=15.879 | 4582.2 samples/s | 71.6 steps/s
[Step=31800 Epoch=122.4] | Loss=0.00046 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.500 | L2-Norm(final)=15.879 | 6568.1 samples/s | 102.6 steps/s
[Step=31850 Epoch=122.6] | Loss=0.00044 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=15.880 | 1918.0 samples/s | 30.0 steps/s
[Step=31900 Epoch=122.8] | Loss=0.00043 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=15.881 | 4580.4 samples/s | 71.6 steps/s
[Step=31950 Epoch=123.0] | Loss=0.00041 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.477 | L2-Norm(final)=15.882 | 4520.0 samples/s | 70.6 steps/s
[Step=32000 Epoch=123.2] | Loss=0.00040 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.469 | L2-Norm(final)=15.882 | 4609.6 samples/s | 72.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07693 | acc=0.9670 | tpr=0.9739 | fpr=0.0481 | 4147.0 samples/s | 16.2 steps/s
Avg test loss: 0.07559, Avg test acc: 0.96610, Avg tpr: 0.97307, Avg fpr: 0.04922, total FA: 384

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07092 | acc=0.9660 | tpr=0.9735 | fpr=0.0503 | 4218.4 samples/s | 16.5 steps/s
Avg test loss: 0.07077, Avg test acc: 0.96638, Avg tpr: 0.97476, Avg fpr: 0.05204, total FA: 406

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.43130 | acc=0.3081 | tpr=0.0050 | fpr=0.0337 | 4178.6 samples/s | 16.3 steps/s
Avg test loss: 6.44785, Avg test acc: 0.30475, Avg tpr: 0.00495, Avg fpr: 0.03589, total FA: 280

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=8.14562 | acc=0.3056 | tpr=0.0051 | fpr=0.0419 | 4206.2 samples/s | 16.4 steps/s
Avg test loss: 8.17485, Avg test acc: 0.30211, Avg tpr: 0.00466, Avg fpr: 0.04371, total FA: 341

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.43949 | acc=0.1284 | tpr=0.5221 | fpr=0.8787 | 4181.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.38155 | acc=0.1289 | tpr=0.5139 | fpr=0.8783 | 7863.6 samples/s | 30.7 steps/s
[Step= 150] | Loss=6.38221 | acc=0.1295 | tpr=0.5245 | fpr=0.8778 | 7889.4 samples/s | 30.8 steps/s
[Step= 200] | Loss=6.37914 | acc=0.1290 | tpr=0.5246 | fpr=0.8782 | 7859.2 samples/s | 30.7 steps/s
[Step= 250] | Loss=6.36757 | acc=0.1292 | tpr=0.5205 | fpr=0.8779 | 8003.0 samples/s | 31.3 steps/s
[Step= 300] | Loss=6.36670 | acc=0.1289 | tpr=0.5215 | fpr=0.8782 | 7677.6 samples/s | 30.0 steps/s
[Step= 350] | Loss=6.37299 | acc=0.1282 | tpr=0.5191 | fpr=0.8789 | 8120.5 samples/s | 31.7 steps/s
[Step= 400] | Loss=6.36493 | acc=0.1281 | tpr=0.5159 | fpr=0.8789 | 7746.6 samples/s | 30.3 steps/s
[Step= 450] | Loss=6.37129 | acc=0.1273 | tpr=0.5107 | fpr=0.8796 | 7847.7 samples/s | 30.7 steps/s
[Step= 500] | Loss=6.37160 | acc=0.1274 | tpr=0.5132 | fpr=0.8796 | 7854.7 samples/s | 30.7 steps/s
[Step= 550] | Loss=6.37506 | acc=0.1275 | tpr=0.5157 | fpr=0.8796 | 14954.6 samples/s | 58.4 steps/s
Avg test loss: 6.37705, Avg test acc: 0.12737, Avg tpr: 0.51624, Avg fpr: 0.87970, total FA: 122145

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.74654 | acc=0.1405 | tpr=0.5708 | fpr=0.8673 | 4141.0 samples/s | 16.2 steps/s
[Step= 100] | Loss=6.68470 | acc=0.1403 | tpr=0.5693 | fpr=0.8677 | 7837.0 samples/s | 30.6 steps/s
[Step= 150] | Loss=6.69383 | acc=0.1397 | tpr=0.5706 | fpr=0.8682 | 7431.9 samples/s | 29.0 steps/s
[Step= 200] | Loss=6.69096 | acc=0.1394 | tpr=0.5628 | fpr=0.8683 | 7730.2 samples/s | 30.2 steps/s
[Step= 250] | Loss=6.68387 | acc=0.1396 | tpr=0.5590 | fpr=0.8680 | 7944.5 samples/s | 31.0 steps/s
[Step= 300] | Loss=6.68998 | acc=0.1398 | tpr=0.5593 | fpr=0.8679 | 7731.2 samples/s | 30.2 steps/s
[Step= 350] | Loss=6.69493 | acc=0.1388 | tpr=0.5604 | fpr=0.8688 | 8112.8 samples/s | 31.7 steps/s
[Step= 400] | Loss=6.68593 | acc=0.1384 | tpr=0.5558 | fpr=0.8692 | 7977.5 samples/s | 31.2 steps/s
[Step= 450] | Loss=6.68762 | acc=0.1380 | tpr=0.5555 | fpr=0.8696 | 7569.2 samples/s | 29.6 steps/s
[Step= 500] | Loss=6.68711 | acc=0.1380 | tpr=0.5634 | fpr=0.8697 | 7740.1 samples/s | 30.2 steps/s
[Step= 550] | Loss=6.68958 | acc=0.1382 | tpr=0.5674 | fpr=0.8696 | 14636.6 samples/s | 57.2 steps/s
Avg test loss: 6.69008, Avg test acc: 0.13819, Avg tpr: 0.56696, Avg fpr: 0.86961, total FA: 120743

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13145 | acc=0.9778 | tpr=0.9292 | fpr=0.0213 | 4183.7 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.14135 | acc=0.9774 | tpr=0.9446 | fpr=0.0220 | 7732.6 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.14491 | acc=0.9767 | tpr=0.9496 | fpr=0.0228 | 7910.6 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.14611 | acc=0.9767 | tpr=0.9508 | fpr=0.0228 | 7887.5 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.14576 | acc=0.9767 | tpr=0.9485 | fpr=0.0228 | 7865.7 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.14847 | acc=0.9766 | tpr=0.9491 | fpr=0.0229 | 7808.6 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.14857 | acc=0.9767 | tpr=0.9493 | fpr=0.0228 | 8171.2 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.15009 | acc=0.9764 | tpr=0.9486 | fpr=0.0231 | 7755.3 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.15205 | acc=0.9761 | tpr=0.9489 | fpr=0.0234 | 7877.2 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.15159 | acc=0.9762 | tpr=0.9489 | fpr=0.0233 | 7905.9 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.15059 | acc=0.9764 | tpr=0.9491 | fpr=0.0231 | 14209.2 samples/s | 55.5 steps/s
Avg test loss: 0.15027, Avg test acc: 0.97645, Avg tpr: 0.94889, Avg fpr: 0.02305, total FA: 3200

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13102 | acc=0.9811 | tpr=0.9336 | fpr=0.0181 | 4225.2 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.14383 | acc=0.9795 | tpr=0.9318 | fpr=0.0196 | 7956.8 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.14585 | acc=0.9791 | tpr=0.9438 | fpr=0.0203 | 7818.0 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.14742 | acc=0.9793 | tpr=0.9475 | fpr=0.0202 | 7912.1 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.14659 | acc=0.9794 | tpr=0.9459 | fpr=0.0200 | 7700.1 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.14926 | acc=0.9793 | tpr=0.9498 | fpr=0.0202 | 8027.0 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.14990 | acc=0.9791 | tpr=0.9493 | fpr=0.0203 | 7788.1 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.15023 | acc=0.9790 | tpr=0.9486 | fpr=0.0205 | 7916.3 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.15268 | acc=0.9787 | tpr=0.9479 | fpr=0.0207 | 7832.9 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.15164 | acc=0.9789 | tpr=0.9489 | fpr=0.0205 | 7582.3 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.15070 | acc=0.9790 | tpr=0.9471 | fpr=0.0204 | 14707.7 samples/s | 57.5 steps/s
Avg test loss: 0.15039, Avg test acc: 0.97907, Avg tpr: 0.94691, Avg fpr: 0.02035, total FA: 2825

server round 16/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=32001 Epoch=62.4] | Loss=0.01790 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.327 | L2-Norm(final)=15.174 | 3982.5 samples/s | 62.2 steps/s
[Step=32050 Epoch=62.5] | Loss=0.02417 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.327 | L2-Norm(final)=15.182 | 5392.4 samples/s | 84.3 steps/s
[Step=32100 Epoch=62.6] | Loss=0.02256 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.328 | L2-Norm(final)=15.195 | 5423.4 samples/s | 84.7 steps/s
[Step=32150 Epoch=62.7] | Loss=0.02180 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.328 | L2-Norm(final)=15.208 | 5671.0 samples/s | 88.6 steps/s
[Step=32200 Epoch=62.8] | Loss=0.02173 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.328 | L2-Norm(final)=15.222 | 5564.7 samples/s | 86.9 steps/s
[Step=32250 Epoch=62.9] | Loss=0.02123 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.328 | L2-Norm(final)=15.238 | 5380.5 samples/s | 84.1 steps/s
[Step=32300 Epoch=63.0] | Loss=0.02219 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.328 | L2-Norm(final)=15.255 | 5535.2 samples/s | 86.5 steps/s
[Step=32350 Epoch=63.1] | Loss=0.02214 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.328 | L2-Norm(final)=15.272 | 5591.6 samples/s | 87.4 steps/s
[Step=32400 Epoch=63.2] | Loss=0.02202 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.328 | L2-Norm(final)=15.290 | 5648.3 samples/s | 88.3 steps/s
[Step=32450 Epoch=63.3] | Loss=0.02224 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.328 | L2-Norm(final)=15.307 | 5559.6 samples/s | 86.9 steps/s
[Step=32500 Epoch=63.4] | Loss=0.02235 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.328 | L2-Norm(final)=15.324 | 6837.6 samples/s | 106.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=32501 Epoch=63.4] | Loss=0.04420 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.328 | L2-Norm(final)=15.491 | 4353.6 samples/s | 68.0 steps/s
[Step=32550 Epoch=63.5] | Loss=0.02032 | Reg=0.00179 | acc=0.9531 | L2-Norm=13.392 | L2-Norm(final)=15.493 | 4468.9 samples/s | 69.8 steps/s
[Step=32600 Epoch=63.6] | Loss=0.02091 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.435 | L2-Norm(final)=15.487 | 4832.2 samples/s | 75.5 steps/s
[Step=32650 Epoch=63.7] | Loss=0.02030 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.465 | L2-Norm(final)=15.485 | 4759.5 samples/s | 74.4 steps/s
[Step=32700 Epoch=63.8] | Loss=0.01979 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.490 | L2-Norm(final)=15.481 | 4791.1 samples/s | 74.9 steps/s
[Step=32750 Epoch=63.9] | Loss=0.01952 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.514 | L2-Norm(final)=15.478 | 4823.4 samples/s | 75.4 steps/s
[Step=32800 Epoch=64.0] | Loss=0.01934 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.536 | L2-Norm(final)=15.475 | 4740.7 samples/s | 74.1 steps/s
[Step=32850 Epoch=64.1] | Loss=0.02013 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.556 | L2-Norm(final)=15.471 | 4788.4 samples/s | 74.8 steps/s
[Step=32900 Epoch=64.2] | Loss=0.02069 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.576 | L2-Norm(final)=15.468 | 4820.1 samples/s | 75.3 steps/s
[Step=32950 Epoch=64.3] | Loss=0.02050 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.595 | L2-Norm(final)=15.464 | 4848.1 samples/s | 75.8 steps/s
[Step=33000 Epoch=64.4] | Loss=0.02011 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.613 | L2-Norm(final)=15.462 | 5744.4 samples/s | 89.8 steps/s
[Step=33050 Epoch=64.5] | Loss=0.01958 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.629 | L2-Norm(final)=15.460 | 2009.3 samples/s | 31.4 steps/s
[Step=33100 Epoch=64.6] | Loss=0.01903 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.644 | L2-Norm(final)=15.458 | 4754.7 samples/s | 74.3 steps/s
[Step=33150 Epoch=64.7] | Loss=0.01853 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.657 | L2-Norm(final)=15.457 | 4784.2 samples/s | 74.8 steps/s
[Step=33200 Epoch=64.8] | Loss=0.01820 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.670 | L2-Norm(final)=15.456 | 4805.7 samples/s | 75.1 steps/s
[Step=33250 Epoch=64.9] | Loss=0.01771 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.681 | L2-Norm(final)=15.455 | 4743.9 samples/s | 74.1 steps/s
[Step=33300 Epoch=64.9] | Loss=0.01767 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.693 | L2-Norm(final)=15.454 | 4834.9 samples/s | 75.5 steps/s
[Step=33350 Epoch=65.0] | Loss=0.01747 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.705 | L2-Norm(final)=15.454 | 4813.8 samples/s | 75.2 steps/s
[Step=33400 Epoch=65.1] | Loss=0.01712 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.716 | L2-Norm(final)=15.453 | 4765.5 samples/s | 74.5 steps/s
[Step=33450 Epoch=65.2] | Loss=0.01703 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.727 | L2-Norm(final)=15.453 | 4796.1 samples/s | 74.9 steps/s
[Step=33500 Epoch=65.3] | Loss=0.01689 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.738 | L2-Norm(final)=15.452 | 5089.1 samples/s | 79.5 steps/s
[Step=33550 Epoch=65.4] | Loss=0.01663 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.748 | L2-Norm(final)=15.451 | 2085.3 samples/s | 32.6 steps/s
[Step=33600 Epoch=65.5] | Loss=0.01627 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.758 | L2-Norm(final)=15.451 | 4882.8 samples/s | 76.3 steps/s
[Step=33650 Epoch=65.6] | Loss=0.01605 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.767 | L2-Norm(final)=15.450 | 4774.7 samples/s | 74.6 steps/s
[Step=33700 Epoch=65.7] | Loss=0.01580 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.776 | L2-Norm(final)=15.450 | 4855.6 samples/s | 75.9 steps/s
[Step=33750 Epoch=65.8] | Loss=0.01569 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.784 | L2-Norm(final)=15.449 | 4765.2 samples/s | 74.5 steps/s
[Step=33800 Epoch=65.9] | Loss=0.01542 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.792 | L2-Norm(final)=15.449 | 4785.1 samples/s | 74.8 steps/s
[Step=33850 Epoch=66.0] | Loss=0.01534 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.800 | L2-Norm(final)=15.449 | 4812.5 samples/s | 75.2 steps/s
[Step=33900 Epoch=66.1] | Loss=0.01526 | Reg=0.00191 | acc=0.9531 | L2-Norm=13.808 | L2-Norm(final)=15.449 | 4816.6 samples/s | 75.3 steps/s
[Step=33950 Epoch=66.2] | Loss=0.01521 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.816 | L2-Norm(final)=15.448 | 4808.4 samples/s | 75.1 steps/s
[Step=34000 Epoch=66.3] | Loss=0.01507 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.823 | L2-Norm(final)=15.448 | 4765.7 samples/s | 74.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step34000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=32001 Epoch=62.6] | Loss=0.01941 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.327 | L2-Norm(final)=15.666 | 4538.1 samples/s | 70.9 steps/s
[Step=32050 Epoch=62.7] | Loss=0.02355 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.328 | L2-Norm(final)=15.691 | 5411.9 samples/s | 84.6 steps/s
[Step=32100 Epoch=62.8] | Loss=0.02109 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.328 | L2-Norm(final)=15.716 | 5607.3 samples/s | 87.6 steps/s
[Step=32150 Epoch=62.9] | Loss=0.02123 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.328 | L2-Norm(final)=15.740 | 5511.7 samples/s | 86.1 steps/s
[Step=32200 Epoch=63.0] | Loss=0.02101 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.328 | L2-Norm(final)=15.763 | 5368.4 samples/s | 83.9 steps/s
[Step=32250 Epoch=63.0] | Loss=0.02061 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.328 | L2-Norm(final)=15.783 | 5491.0 samples/s | 85.8 steps/s
[Step=32300 Epoch=63.1] | Loss=0.02132 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.328 | L2-Norm(final)=15.803 | 5530.5 samples/s | 86.4 steps/s
[Step=32350 Epoch=63.2] | Loss=0.02158 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.328 | L2-Norm(final)=15.822 | 5556.8 samples/s | 86.8 steps/s
[Step=32400 Epoch=63.3] | Loss=0.02144 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.328 | L2-Norm(final)=15.841 | 5536.5 samples/s | 86.5 steps/s
[Step=32450 Epoch=63.4] | Loss=0.02115 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.328 | L2-Norm(final)=15.860 | 5611.4 samples/s | 87.7 steps/s
[Step=32500 Epoch=63.5] | Loss=0.02065 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.328 | L2-Norm(final)=15.880 | 7002.0 samples/s | 109.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=32501 Epoch=63.5] | Loss=0.00657 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.328 | L2-Norm(final)=16.075 | 4528.3 samples/s | 70.8 steps/s
[Step=32550 Epoch=63.6] | Loss=0.01397 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.382 | L2-Norm(final)=16.082 | 4803.4 samples/s | 75.1 steps/s
[Step=32600 Epoch=63.7] | Loss=0.01722 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.427 | L2-Norm(final)=16.073 | 4792.8 samples/s | 74.9 steps/s
[Step=32650 Epoch=63.8] | Loss=0.01768 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.459 | L2-Norm(final)=16.069 | 4804.5 samples/s | 75.1 steps/s
[Step=32700 Epoch=63.9] | Loss=0.01775 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=16.066 | 4737.9 samples/s | 74.0 steps/s
[Step=32750 Epoch=64.0] | Loss=0.01776 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.506 | L2-Norm(final)=16.065 | 4787.8 samples/s | 74.8 steps/s
[Step=32800 Epoch=64.1] | Loss=0.01745 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.525 | L2-Norm(final)=16.064 | 4730.0 samples/s | 73.9 steps/s
[Step=32850 Epoch=64.2] | Loss=0.01756 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.542 | L2-Norm(final)=16.063 | 4806.0 samples/s | 75.1 steps/s
[Step=32900 Epoch=64.3] | Loss=0.01792 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=16.061 | 4880.6 samples/s | 76.3 steps/s
[Step=32950 Epoch=64.4] | Loss=0.01778 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.572 | L2-Norm(final)=16.060 | 4744.5 samples/s | 74.1 steps/s
[Step=33000 Epoch=64.5] | Loss=0.01820 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.586 | L2-Norm(final)=16.059 | 5928.6 samples/s | 92.6 steps/s
[Step=33050 Epoch=64.6] | Loss=0.01784 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.600 | L2-Norm(final)=16.058 | 2083.6 samples/s | 32.6 steps/s
[Step=33100 Epoch=64.7] | Loss=0.01763 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.614 | L2-Norm(final)=16.057 | 4744.8 samples/s | 74.1 steps/s
[Step=33150 Epoch=64.8] | Loss=0.01707 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.626 | L2-Norm(final)=16.056 | 4800.5 samples/s | 75.0 steps/s
[Step=33200 Epoch=64.9] | Loss=0.01672 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.638 | L2-Norm(final)=16.055 | 4822.3 samples/s | 75.3 steps/s
[Step=33250 Epoch=65.0] | Loss=0.01636 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.649 | L2-Norm(final)=16.054 | 4752.8 samples/s | 74.3 steps/s
[Step=33300 Epoch=65.1] | Loss=0.01623 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.659 | L2-Norm(final)=16.053 | 4778.2 samples/s | 74.7 steps/s
[Step=33350 Epoch=65.2] | Loss=0.01639 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.670 | L2-Norm(final)=16.052 | 4830.5 samples/s | 75.5 steps/s
[Step=33400 Epoch=65.3] | Loss=0.01625 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.680 | L2-Norm(final)=16.051 | 4851.3 samples/s | 75.8 steps/s
[Step=33450 Epoch=65.4] | Loss=0.01618 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.689 | L2-Norm(final)=16.049 | 4768.8 samples/s | 74.5 steps/s
[Step=33500 Epoch=65.5] | Loss=0.01602 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.699 | L2-Norm(final)=16.048 | 5197.5 samples/s | 81.2 steps/s
[Step=33550 Epoch=65.6] | Loss=0.01576 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.708 | L2-Norm(final)=16.046 | 2193.4 samples/s | 34.3 steps/s
[Step=33600 Epoch=65.7] | Loss=0.01551 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.717 | L2-Norm(final)=16.045 | 4815.7 samples/s | 75.2 steps/s
[Step=33650 Epoch=65.8] | Loss=0.01534 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.725 | L2-Norm(final)=16.044 | 4777.0 samples/s | 74.6 steps/s
[Step=33700 Epoch=65.9] | Loss=0.01511 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.734 | L2-Norm(final)=16.044 | 4808.4 samples/s | 75.1 steps/s
[Step=33750 Epoch=66.0] | Loss=0.01500 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.742 | L2-Norm(final)=16.043 | 4785.4 samples/s | 74.8 steps/s
[Step=33800 Epoch=66.1] | Loss=0.01475 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.750 | L2-Norm(final)=16.042 | 4787.2 samples/s | 74.8 steps/s
[Step=33850 Epoch=66.2] | Loss=0.01477 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.758 | L2-Norm(final)=16.041 | 4852.4 samples/s | 75.8 steps/s
[Step=33900 Epoch=66.3] | Loss=0.01459 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.766 | L2-Norm(final)=16.040 | 4716.5 samples/s | 73.7 steps/s
[Step=33950 Epoch=66.4] | Loss=0.01447 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.773 | L2-Norm(final)=16.040 | 4806.9 samples/s | 75.1 steps/s
[Step=34000 Epoch=66.5] | Loss=0.01437 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=16.039 | 4788.7 samples/s | 74.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step34000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=32001 Epoch=122.6] | Loss=0.00002 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.327 | L2-Norm(final)=14.606 | 4458.4 samples/s | 69.7 steps/s
[Step=32050 Epoch=122.8] | Loss=0.00026 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.325 | L2-Norm(final)=14.619 | 5079.4 samples/s | 79.4 steps/s
[Step=32100 Epoch=123.0] | Loss=0.00034 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=14.628 | 5317.6 samples/s | 83.1 steps/s
[Step=32150 Epoch=123.2] | Loss=0.00033 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=14.638 | 5158.7 samples/s | 80.6 steps/s
[Step=32200 Epoch=123.4] | Loss=0.00034 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=14.649 | 5246.5 samples/s | 82.0 steps/s
[Step=32250 Epoch=123.6] | Loss=0.00032 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=14.661 | 6823.7 samples/s | 106.6 steps/s
[Step=32300 Epoch=123.8] | Loss=0.00038 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=14.671 | 2138.9 samples/s | 33.4 steps/s
[Step=32350 Epoch=124.0] | Loss=0.00042 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=14.681 | 5273.1 samples/s | 82.4 steps/s
[Step=32400 Epoch=124.1] | Loss=0.00040 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=14.690 | 5155.0 samples/s | 80.5 steps/s
[Step=32450 Epoch=124.3] | Loss=0.00042 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=14.700 | 5256.2 samples/s | 82.1 steps/s
[Step=32500 Epoch=124.5] | Loss=0.00040 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=14.709 | 5844.8 samples/s | 91.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=32501 Epoch=124.5] | Loss=0.00015 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=14.800 | 4778.8 samples/s | 74.7 steps/s
[Step=32550 Epoch=124.7] | Loss=0.00028 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.338 | L2-Norm(final)=14.803 | 4325.5 samples/s | 67.6 steps/s
[Step=32600 Epoch=124.9] | Loss=0.00304 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=14.798 | 4516.7 samples/s | 70.6 steps/s
[Step=32650 Epoch=125.1] | Loss=0.00289 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.427 | L2-Norm(final)=14.780 | 4588.4 samples/s | 71.7 steps/s
[Step=32700 Epoch=125.3] | Loss=0.00239 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.460 | L2-Norm(final)=14.770 | 4600.5 samples/s | 71.9 steps/s
[Step=32750 Epoch=125.5] | Loss=0.00197 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=14.765 | 5664.6 samples/s | 88.5 steps/s
[Step=32800 Epoch=125.7] | Loss=0.00172 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=14.761 | 2007.9 samples/s | 31.4 steps/s
[Step=32850 Epoch=125.9] | Loss=0.00149 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.498 | L2-Norm(final)=14.759 | 4620.7 samples/s | 72.2 steps/s
[Step=32900 Epoch=126.1] | Loss=0.00130 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.499 | L2-Norm(final)=14.758 | 4500.6 samples/s | 70.3 steps/s
[Step=32950 Epoch=126.3] | Loss=0.00116 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.498 | L2-Norm(final)=14.757 | 4564.8 samples/s | 71.3 steps/s
[Step=33000 Epoch=126.4] | Loss=0.00105 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.496 | L2-Norm(final)=14.756 | 5028.1 samples/s | 78.6 steps/s
[Step=33050 Epoch=126.6] | Loss=0.00095 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.491 | L2-Norm(final)=14.756 | 2119.2 samples/s | 33.1 steps/s
[Step=33100 Epoch=126.8] | Loss=0.00087 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=14.756 | 4609.5 samples/s | 72.0 steps/s
[Step=33150 Epoch=127.0] | Loss=0.00081 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=14.756 | 4541.5 samples/s | 71.0 steps/s
[Step=33200 Epoch=127.2] | Loss=0.00075 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.474 | L2-Norm(final)=14.756 | 4513.8 samples/s | 70.5 steps/s
[Step=33250 Epoch=127.4] | Loss=0.00070 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.467 | L2-Norm(final)=14.756 | 4595.4 samples/s | 71.8 steps/s
[Step=33300 Epoch=127.6] | Loss=0.00066 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.460 | L2-Norm(final)=14.756 | 2204.6 samples/s | 34.4 steps/s
[Step=33350 Epoch=127.8] | Loss=0.00062 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=14.756 | 4633.3 samples/s | 72.4 steps/s
[Step=33400 Epoch=128.0] | Loss=0.00058 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.444 | L2-Norm(final)=14.756 | 4601.9 samples/s | 71.9 steps/s
[Step=33450 Epoch=128.2] | Loss=0.00055 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.436 | L2-Norm(final)=14.756 | 4576.2 samples/s | 71.5 steps/s
[Step=33500 Epoch=128.4] | Loss=0.00053 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.427 | L2-Norm(final)=14.757 | 4579.7 samples/s | 71.6 steps/s
[Step=33550 Epoch=128.6] | Loss=0.00050 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.419 | L2-Norm(final)=14.757 | 2170.0 samples/s | 33.9 steps/s
[Step=33600 Epoch=128.7] | Loss=0.00048 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.410 | L2-Norm(final)=14.757 | 4606.2 samples/s | 72.0 steps/s
[Step=33650 Epoch=128.9] | Loss=0.00046 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=14.758 | 4553.4 samples/s | 71.1 steps/s
[Step=33700 Epoch=129.1] | Loss=0.00044 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.392 | L2-Norm(final)=14.758 | 4462.5 samples/s | 69.7 steps/s
[Step=33750 Epoch=129.3] | Loss=0.00042 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.383 | L2-Norm(final)=14.758 | 4539.6 samples/s | 70.9 steps/s
[Step=33800 Epoch=129.5] | Loss=0.00040 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=14.759 | 6221.1 samples/s | 97.2 steps/s
[Step=33850 Epoch=129.7] | Loss=0.00039 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=14.759 | 1958.9 samples/s | 30.6 steps/s
[Step=33900 Epoch=129.9] | Loss=0.00038 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=14.760 | 4544.1 samples/s | 71.0 steps/s
[Step=33950 Epoch=130.1] | Loss=0.00036 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=14.760 | 4575.0 samples/s | 71.5 steps/s
[Step=34000 Epoch=130.3] | Loss=0.00035 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.336 | L2-Norm(final)=14.761 | 4528.0 samples/s | 70.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step34000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=32001 Epoch=123.2] | Loss=0.00002 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.327 | L2-Norm(final)=15.907 | 4508.5 samples/s | 70.4 steps/s
[Step=32050 Epoch=123.4] | Loss=0.00082 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.325 | L2-Norm(final)=15.916 | 4838.5 samples/s | 75.6 steps/s
[Step=32100 Epoch=123.6] | Loss=0.00048 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=15.922 | 5135.0 samples/s | 80.2 steps/s
[Step=32150 Epoch=123.8] | Loss=0.00058 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=15.928 | 5258.1 samples/s | 82.2 steps/s
[Step=32200 Epoch=124.0] | Loss=0.00049 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=15.934 | 5268.2 samples/s | 82.3 steps/s
[Step=32250 Epoch=124.1] | Loss=0.00043 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=15.941 | 6760.6 samples/s | 105.6 steps/s
[Step=32300 Epoch=124.3] | Loss=0.00039 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=15.948 | 2134.8 samples/s | 33.4 steps/s
[Step=32350 Epoch=124.5] | Loss=0.00037 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=15.955 | 5124.8 samples/s | 80.1 steps/s
[Step=32400 Epoch=124.7] | Loss=0.00049 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=15.963 | 5203.8 samples/s | 81.3 steps/s
[Step=32450 Epoch=124.9] | Loss=0.00045 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=15.970 | 5308.3 samples/s | 82.9 steps/s
[Step=32500 Epoch=125.1] | Loss=0.00042 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=15.977 | 5973.3 samples/s | 93.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=32501 Epoch=125.1] | Loss=0.00005 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=16.049 | 4357.2 samples/s | 68.1 steps/s
[Step=32550 Epoch=125.3] | Loss=0.00067 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.325 | L2-Norm(final)=16.056 | 4476.2 samples/s | 69.9 steps/s
[Step=32600 Epoch=125.5] | Loss=0.00191 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.356 | L2-Norm(final)=16.060 | 4567.2 samples/s | 71.4 steps/s
[Step=32650 Epoch=125.7] | Loss=0.00403 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.439 | L2-Norm(final)=16.048 | 4627.9 samples/s | 72.3 steps/s
[Step=32700 Epoch=125.9] | Loss=0.00359 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.505 | L2-Norm(final)=16.036 | 4520.5 samples/s | 70.6 steps/s
[Step=32750 Epoch=126.1] | Loss=0.00300 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=16.030 | 5787.1 samples/s | 90.4 steps/s
[Step=32800 Epoch=126.3] | Loss=0.00250 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.571 | L2-Norm(final)=16.026 | 2011.6 samples/s | 31.4 steps/s
[Step=32850 Epoch=126.5] | Loss=0.00215 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.586 | L2-Norm(final)=16.024 | 4535.7 samples/s | 70.9 steps/s
[Step=32900 Epoch=126.6] | Loss=0.00188 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.596 | L2-Norm(final)=16.022 | 4666.4 samples/s | 72.9 steps/s
[Step=32950 Epoch=126.8] | Loss=0.00169 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.602 | L2-Norm(final)=16.021 | 4519.9 samples/s | 70.6 steps/s
[Step=33000 Epoch=127.0] | Loss=0.00152 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.605 | L2-Norm(final)=16.020 | 5136.3 samples/s | 80.3 steps/s
[Step=33050 Epoch=127.2] | Loss=0.00138 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.607 | L2-Norm(final)=16.020 | 2093.9 samples/s | 32.7 steps/s
[Step=33100 Epoch=127.4] | Loss=0.00127 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.607 | L2-Norm(final)=16.020 | 4559.2 samples/s | 71.2 steps/s
[Step=33150 Epoch=127.6] | Loss=0.00117 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.606 | L2-Norm(final)=16.020 | 4547.8 samples/s | 71.1 steps/s
[Step=33200 Epoch=127.8] | Loss=0.00109 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.604 | L2-Norm(final)=16.020 | 4585.8 samples/s | 71.7 steps/s
[Step=33250 Epoch=128.0] | Loss=0.00102 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.601 | L2-Norm(final)=16.020 | 4599.3 samples/s | 71.9 steps/s
[Step=33300 Epoch=128.2] | Loss=0.00095 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.597 | L2-Norm(final)=16.020 | 2196.1 samples/s | 34.3 steps/s
[Step=33350 Epoch=128.4] | Loss=0.00090 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.594 | L2-Norm(final)=16.020 | 4523.8 samples/s | 70.7 steps/s
[Step=33400 Epoch=128.6] | Loss=0.00085 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.589 | L2-Norm(final)=16.021 | 4633.6 samples/s | 72.4 steps/s
[Step=33450 Epoch=128.8] | Loss=0.00080 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.585 | L2-Norm(final)=16.021 | 4581.7 samples/s | 71.6 steps/s
[Step=33500 Epoch=129.0] | Loss=0.00076 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.580 | L2-Norm(final)=16.021 | 4517.0 samples/s | 70.6 steps/s
[Step=33550 Epoch=129.1] | Loss=0.00073 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.575 | L2-Norm(final)=16.021 | 2202.9 samples/s | 34.4 steps/s
[Step=33600 Epoch=129.3] | Loss=0.00069 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.570 | L2-Norm(final)=16.022 | 4563.2 samples/s | 71.3 steps/s
[Step=33650 Epoch=129.5] | Loss=0.00066 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=16.022 | 4556.6 samples/s | 71.2 steps/s
[Step=33700 Epoch=129.7] | Loss=0.00064 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.558 | L2-Norm(final)=16.022 | 4581.7 samples/s | 71.6 steps/s
[Step=33750 Epoch=129.9] | Loss=0.00061 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.552 | L2-Norm(final)=16.022 | 4582.1 samples/s | 71.6 steps/s
[Step=33800 Epoch=130.1] | Loss=0.00059 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=16.023 | 6584.3 samples/s | 102.9 steps/s
[Step=33850 Epoch=130.3] | Loss=0.00057 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.540 | L2-Norm(final)=16.023 | 1906.2 samples/s | 29.8 steps/s
[Step=33900 Epoch=130.5] | Loss=0.00055 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.534 | L2-Norm(final)=16.023 | 4513.1 samples/s | 70.5 steps/s
[Step=33950 Epoch=130.7] | Loss=0.00053 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.528 | L2-Norm(final)=16.024 | 4563.9 samples/s | 71.3 steps/s
[Step=34000 Epoch=130.9] | Loss=0.00051 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.521 | L2-Norm(final)=16.024 | 4516.6 samples/s | 70.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step34000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07785 | acc=0.9674 | tpr=0.9736 | fpr=0.0461 | 4142.6 samples/s | 16.2 steps/s
Avg test loss: 0.07749, Avg test acc: 0.96558, Avg tpr: 0.97162, Avg fpr: 0.04769, total FA: 372

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06740 | acc=0.9668 | tpr=0.9740 | fpr=0.0488 | 4194.9 samples/s | 16.4 steps/s
Avg test loss: 0.07147, Avg test acc: 0.96610, Avg tpr: 0.97389, Avg fpr: 0.05102, total FA: 398

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.00130 | acc=0.3023 | tpr=0.0051 | fpr=0.0525 | 4109.5 samples/s | 16.1 steps/s
Avg test loss: 7.02142, Avg test acc: 0.29990, Avg tpr: 0.00583, Avg fpr: 0.05333, total FA: 416

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.97006 | acc=0.3081 | tpr=0.0108 | fpr=0.0463 | 4132.0 samples/s | 16.1 steps/s
Avg test loss: 6.98145, Avg test acc: 0.30547, Avg tpr: 0.01119, Avg fpr: 0.04730, total FA: 369

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.82984 | acc=0.1441 | tpr=0.5133 | fpr=0.8626 | 4133.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=6.78863 | acc=0.1439 | tpr=0.5309 | fpr=0.8634 | 8021.1 samples/s | 31.3 steps/s
[Step= 150] | Loss=6.79417 | acc=0.1424 | tpr=0.5346 | fpr=0.8648 | 7891.0 samples/s | 30.8 steps/s
[Step= 200] | Loss=6.79262 | acc=0.1417 | tpr=0.5191 | fpr=0.8652 | 7792.3 samples/s | 30.4 steps/s
[Step= 250] | Loss=6.78296 | acc=0.1412 | tpr=0.5100 | fpr=0.8655 | 7986.7 samples/s | 31.2 steps/s
[Step= 300] | Loss=6.78590 | acc=0.1406 | tpr=0.5018 | fpr=0.8660 | 7708.4 samples/s | 30.1 steps/s
[Step= 350] | Loss=6.79807 | acc=0.1399 | tpr=0.5028 | fpr=0.8667 | 7892.1 samples/s | 30.8 steps/s
[Step= 400] | Loss=6.78757 | acc=0.1393 | tpr=0.4912 | fpr=0.8671 | 7857.1 samples/s | 30.7 steps/s
[Step= 450] | Loss=6.79161 | acc=0.1388 | tpr=0.4864 | fpr=0.8676 | 7858.2 samples/s | 30.7 steps/s
[Step= 500] | Loss=6.79260 | acc=0.1388 | tpr=0.4885 | fpr=0.8676 | 7638.2 samples/s | 29.8 steps/s
[Step= 550] | Loss=6.79386 | acc=0.1388 | tpr=0.4887 | fpr=0.8676 | 14681.9 samples/s | 57.4 steps/s
Avg test loss: 6.79604, Avg test acc: 0.13865, Avg tpr: 0.48811, Avg fpr: 0.86770, total FA: 120479

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.29855 | acc=0.1370 | tpr=0.5177 | fpr=0.8698 | 4157.8 samples/s | 16.2 steps/s
[Step= 100] | Loss=6.23339 | acc=0.1403 | tpr=0.5309 | fpr=0.8670 | 8098.3 samples/s | 31.6 steps/s
[Step= 150] | Loss=6.23655 | acc=0.1401 | tpr=0.5173 | fpr=0.8668 | 7713.6 samples/s | 30.1 steps/s
[Step= 200] | Loss=6.22999 | acc=0.1402 | tpr=0.5180 | fpr=0.8667 | 7906.7 samples/s | 30.9 steps/s
[Step= 250] | Loss=6.22467 | acc=0.1405 | tpr=0.5162 | fpr=0.8663 | 7745.0 samples/s | 30.3 steps/s
[Step= 300] | Loss=6.23017 | acc=0.1401 | tpr=0.5135 | fpr=0.8667 | 8123.0 samples/s | 31.7 steps/s
[Step= 350] | Loss=6.23967 | acc=0.1394 | tpr=0.5091 | fpr=0.8673 | 7909.3 samples/s | 30.9 steps/s
[Step= 400] | Loss=6.22753 | acc=0.1388 | tpr=0.5011 | fpr=0.8678 | 7705.9 samples/s | 30.1 steps/s
[Step= 450] | Loss=6.22814 | acc=0.1383 | tpr=0.5000 | fpr=0.8682 | 8039.4 samples/s | 31.4 steps/s
[Step= 500] | Loss=6.22692 | acc=0.1383 | tpr=0.5062 | fpr=0.8683 | 7630.1 samples/s | 29.8 steps/s
[Step= 550] | Loss=6.22943 | acc=0.1386 | tpr=0.5050 | fpr=0.8680 | 14160.7 samples/s | 55.3 steps/s
Avg test loss: 6.23034, Avg test acc: 0.13851, Avg tpr: 0.50475, Avg fpr: 0.86814, total FA: 120540

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13202 | acc=0.9800 | tpr=0.9336 | fpr=0.0192 | 4195.5 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.14330 | acc=0.9786 | tpr=0.9446 | fpr=0.0208 | 7735.5 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.14586 | acc=0.9781 | tpr=0.9524 | fpr=0.0215 | 7853.5 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.14795 | acc=0.9782 | tpr=0.9519 | fpr=0.0214 | 7873.7 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.14667 | acc=0.9781 | tpr=0.9502 | fpr=0.0214 | 7905.3 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.14965 | acc=0.9778 | tpr=0.9484 | fpr=0.0216 | 7590.4 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.14972 | acc=0.9776 | tpr=0.9487 | fpr=0.0218 | 7977.9 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.15073 | acc=0.9774 | tpr=0.9458 | fpr=0.0221 | 7864.9 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.15298 | acc=0.9770 | tpr=0.9445 | fpr=0.0224 | 7796.1 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.15175 | acc=0.9772 | tpr=0.9427 | fpr=0.0221 | 8002.6 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.15069 | acc=0.9774 | tpr=0.9419 | fpr=0.0220 | 13568.2 samples/s | 53.0 steps/s
Avg test loss: 0.15036, Avg test acc: 0.97742, Avg tpr: 0.94176, Avg fpr: 0.02193, total FA: 3045

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13895 | acc=0.9798 | tpr=0.9336 | fpr=0.0194 | 4195.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.14779 | acc=0.9791 | tpr=0.9446 | fpr=0.0202 | 7767.8 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.15031 | acc=0.9785 | tpr=0.9553 | fpr=0.0211 | 8112.4 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.15408 | acc=0.9785 | tpr=0.9563 | fpr=0.0211 | 7587.9 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.15326 | acc=0.9785 | tpr=0.9581 | fpr=0.0211 | 7874.6 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.15697 | acc=0.9782 | tpr=0.9571 | fpr=0.0214 | 7850.4 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.15777 | acc=0.9781 | tpr=0.9555 | fpr=0.0215 | 7894.7 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.15887 | acc=0.9778 | tpr=0.9557 | fpr=0.0218 | 7698.2 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.16104 | acc=0.9775 | tpr=0.9542 | fpr=0.0221 | 7823.3 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.15985 | acc=0.9777 | tpr=0.9542 | fpr=0.0219 | 7578.5 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.15873 | acc=0.9778 | tpr=0.9542 | fpr=0.0217 | 15033.1 samples/s | 58.7 steps/s
Avg test loss: 0.15841, Avg test acc: 0.97784, Avg tpr: 0.95444, Avg fpr: 0.02174, total FA: 3018

server round 17/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=34001 Epoch=66.3] | Loss=0.01734 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.313 | L2-Norm(final)=15.446 | 4584.6 samples/s | 71.6 steps/s
[Step=34050 Epoch=66.4] | Loss=0.02195 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.315 | L2-Norm(final)=15.458 | 5110.0 samples/s | 79.8 steps/s
[Step=34100 Epoch=66.5] | Loss=0.02305 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.315 | L2-Norm(final)=15.479 | 5402.9 samples/s | 84.4 steps/s
[Step=34150 Epoch=66.6] | Loss=0.02391 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.315 | L2-Norm(final)=15.501 | 5472.5 samples/s | 85.5 steps/s
[Step=34200 Epoch=66.7] | Loss=0.02340 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.316 | L2-Norm(final)=15.522 | 5673.9 samples/s | 88.7 steps/s
[Step=34250 Epoch=66.8] | Loss=0.02269 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.316 | L2-Norm(final)=15.544 | 5549.8 samples/s | 86.7 steps/s
[Step=34300 Epoch=66.9] | Loss=0.02290 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.316 | L2-Norm(final)=15.564 | 5475.8 samples/s | 85.6 steps/s
[Step=34350 Epoch=67.0] | Loss=0.02340 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.316 | L2-Norm(final)=15.583 | 5486.3 samples/s | 85.7 steps/s
[Step=34400 Epoch=67.1] | Loss=0.02342 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.316 | L2-Norm(final)=15.602 | 5559.8 samples/s | 86.9 steps/s
[Step=34450 Epoch=67.2] | Loss=0.02333 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.316 | L2-Norm(final)=15.620 | 5577.3 samples/s | 87.1 steps/s
[Step=34500 Epoch=67.3] | Loss=0.02331 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.316 | L2-Norm(final)=15.639 | 6963.1 samples/s | 108.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=34501 Epoch=67.3] | Loss=0.02377 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.316 | L2-Norm(final)=15.824 | 4556.9 samples/s | 71.2 steps/s
[Step=34550 Epoch=67.4] | Loss=0.01723 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.380 | L2-Norm(final)=15.832 | 4402.8 samples/s | 68.8 steps/s
[Step=34600 Epoch=67.5] | Loss=0.01889 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.427 | L2-Norm(final)=15.827 | 4763.6 samples/s | 74.4 steps/s
[Step=34650 Epoch=67.6] | Loss=0.01934 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.460 | L2-Norm(final)=15.822 | 4831.9 samples/s | 75.5 steps/s
[Step=34700 Epoch=67.7] | Loss=0.01902 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.486 | L2-Norm(final)=15.819 | 4732.4 samples/s | 73.9 steps/s
[Step=34750 Epoch=67.8] | Loss=0.01979 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.508 | L2-Norm(final)=15.816 | 4793.1 samples/s | 74.9 steps/s
[Step=34800 Epoch=67.9] | Loss=0.01931 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.528 | L2-Norm(final)=15.814 | 4808.0 samples/s | 75.1 steps/s
[Step=34850 Epoch=68.0] | Loss=0.01918 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.548 | L2-Norm(final)=15.813 | 4844.6 samples/s | 75.7 steps/s
[Step=34900 Epoch=68.1] | Loss=0.01867 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.567 | L2-Norm(final)=15.811 | 4795.6 samples/s | 74.9 steps/s
[Step=34950 Epoch=68.2] | Loss=0.01854 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.585 | L2-Norm(final)=15.810 | 4819.3 samples/s | 75.3 steps/s
[Step=35000 Epoch=68.3] | Loss=0.01880 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.601 | L2-Norm(final)=15.808 | 5875.5 samples/s | 91.8 steps/s
[Step=35050 Epoch=68.4] | Loss=0.01824 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.616 | L2-Norm(final)=15.807 | 2088.5 samples/s | 32.6 steps/s
[Step=35100 Epoch=68.5] | Loss=0.01755 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.629 | L2-Norm(final)=15.806 | 4714.5 samples/s | 73.7 steps/s
[Step=35150 Epoch=68.6] | Loss=0.01697 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.641 | L2-Norm(final)=15.805 | 4838.0 samples/s | 75.6 steps/s
[Step=35200 Epoch=68.7] | Loss=0.01668 | Reg=0.00186 | acc=0.9531 | L2-Norm=13.653 | L2-Norm(final)=15.805 | 4737.9 samples/s | 74.0 steps/s
[Step=35250 Epoch=68.8] | Loss=0.01618 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.664 | L2-Norm(final)=15.805 | 4771.3 samples/s | 74.6 steps/s
[Step=35300 Epoch=68.8] | Loss=0.01600 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.674 | L2-Norm(final)=15.805 | 4644.7 samples/s | 72.6 steps/s
[Step=35350 Epoch=68.9] | Loss=0.01598 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=15.804 | 4777.4 samples/s | 74.6 steps/s
[Step=35400 Epoch=69.0] | Loss=0.01567 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.694 | L2-Norm(final)=15.803 | 4810.3 samples/s | 75.2 steps/s
[Step=35450 Epoch=69.1] | Loss=0.01563 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.703 | L2-Norm(final)=15.803 | 4806.9 samples/s | 75.1 steps/s
[Step=35500 Epoch=69.2] | Loss=0.01557 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.713 | L2-Norm(final)=15.803 | 5081.0 samples/s | 79.4 steps/s
[Step=35550 Epoch=69.3] | Loss=0.01536 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.722 | L2-Norm(final)=15.802 | 2208.2 samples/s | 34.5 steps/s
[Step=35600 Epoch=69.4] | Loss=0.01512 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.730 | L2-Norm(final)=15.802 | 4827.7 samples/s | 75.4 steps/s
[Step=35650 Epoch=69.5] | Loss=0.01478 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.739 | L2-Norm(final)=15.802 | 4736.8 samples/s | 74.0 steps/s
[Step=35700 Epoch=69.6] | Loss=0.01453 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.747 | L2-Norm(final)=15.803 | 4781.1 samples/s | 74.7 steps/s
[Step=35750 Epoch=69.7] | Loss=0.01436 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.754 | L2-Norm(final)=15.803 | 4795.8 samples/s | 74.9 steps/s
[Step=35800 Epoch=69.8] | Loss=0.01425 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.761 | L2-Norm(final)=15.803 | 4822.8 samples/s | 75.4 steps/s
[Step=35850 Epoch=69.9] | Loss=0.01413 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.769 | L2-Norm(final)=15.803 | 4737.6 samples/s | 74.0 steps/s
[Step=35900 Epoch=70.0] | Loss=0.01407 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.777 | L2-Norm(final)=15.803 | 4840.6 samples/s | 75.6 steps/s
[Step=35950 Epoch=70.1] | Loss=0.01401 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.784 | L2-Norm(final)=15.804 | 4754.0 samples/s | 74.3 steps/s
[Step=36000 Epoch=70.2] | Loss=0.01397 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.792 | L2-Norm(final)=15.804 | 4811.7 samples/s | 75.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step36000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=34001 Epoch=66.5] | Loss=0.02729 | Reg=0.00177 | acc=0.9531 | L2-Norm=13.313 | L2-Norm(final)=16.020 | 4655.2 samples/s | 72.7 steps/s
[Step=34050 Epoch=66.6] | Loss=0.02401 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.314 | L2-Norm(final)=16.029 | 5262.4 samples/s | 82.2 steps/s
[Step=34100 Epoch=66.7] | Loss=0.02511 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.314 | L2-Norm(final)=16.043 | 5513.0 samples/s | 86.1 steps/s
[Step=34150 Epoch=66.8] | Loss=0.02448 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.314 | L2-Norm(final)=16.056 | 5502.3 samples/s | 86.0 steps/s
[Step=34200 Epoch=66.9] | Loss=0.02338 | Reg=0.00177 | acc=0.9219 | L2-Norm=13.314 | L2-Norm(final)=16.071 | 5480.7 samples/s | 85.6 steps/s
[Step=34250 Epoch=67.0] | Loss=0.02305 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.314 | L2-Norm(final)=16.086 | 5539.1 samples/s | 86.5 steps/s
[Step=34300 Epoch=67.1] | Loss=0.02278 | Reg=0.00177 | acc=0.9375 | L2-Norm=13.314 | L2-Norm(final)=16.102 | 5624.7 samples/s | 87.9 steps/s
[Step=34350 Epoch=67.2] | Loss=0.02272 | Reg=0.00177 | acc=0.9531 | L2-Norm=13.314 | L2-Norm(final)=16.117 | 5453.3 samples/s | 85.2 steps/s
[Step=34400 Epoch=67.3] | Loss=0.02243 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.314 | L2-Norm(final)=16.132 | 5515.8 samples/s | 86.2 steps/s
[Step=34450 Epoch=67.3] | Loss=0.02203 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.314 | L2-Norm(final)=16.148 | 5700.9 samples/s | 89.1 steps/s
[Step=34500 Epoch=67.4] | Loss=0.02182 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.314 | L2-Norm(final)=16.163 | 6786.5 samples/s | 106.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=34501 Epoch=67.4] | Loss=0.02715 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.314 | L2-Norm(final)=16.318 | 4539.3 samples/s | 70.9 steps/s
[Step=34550 Epoch=67.5] | Loss=0.02313 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.375 | L2-Norm(final)=16.316 | 4624.4 samples/s | 72.3 steps/s
[Step=34600 Epoch=67.6] | Loss=0.02163 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.421 | L2-Norm(final)=16.306 | 4855.0 samples/s | 75.9 steps/s
[Step=34650 Epoch=67.7] | Loss=0.02280 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.455 | L2-Norm(final)=16.298 | 4764.2 samples/s | 74.4 steps/s
[Step=34700 Epoch=67.8] | Loss=0.02187 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.481 | L2-Norm(final)=16.291 | 4828.7 samples/s | 75.4 steps/s
[Step=34750 Epoch=67.9] | Loss=0.02104 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.503 | L2-Norm(final)=16.287 | 4769.1 samples/s | 74.5 steps/s
[Step=34800 Epoch=68.0] | Loss=0.02128 | Reg=0.00183 | acc=0.9531 | L2-Norm=13.522 | L2-Norm(final)=16.283 | 4784.3 samples/s | 74.8 steps/s
[Step=34850 Epoch=68.1] | Loss=0.02032 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.538 | L2-Norm(final)=16.280 | 4750.8 samples/s | 74.2 steps/s
[Step=34900 Epoch=68.2] | Loss=0.01969 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.553 | L2-Norm(final)=16.276 | 4837.9 samples/s | 75.6 steps/s
[Step=34950 Epoch=68.3] | Loss=0.01953 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=16.274 | 4789.0 samples/s | 74.8 steps/s
[Step=35000 Epoch=68.4] | Loss=0.01942 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.579 | L2-Norm(final)=16.271 | 5901.6 samples/s | 92.2 steps/s
[Step=35050 Epoch=68.5] | Loss=0.01875 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.591 | L2-Norm(final)=16.269 | 2018.3 samples/s | 31.5 steps/s
[Step=35100 Epoch=68.6] | Loss=0.01838 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.601 | L2-Norm(final)=16.267 | 4621.4 samples/s | 72.2 steps/s
[Step=35150 Epoch=68.7] | Loss=0.01791 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.611 | L2-Norm(final)=16.266 | 4765.1 samples/s | 74.5 steps/s
[Step=35200 Epoch=68.8] | Loss=0.01749 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.620 | L2-Norm(final)=16.265 | 4727.3 samples/s | 73.9 steps/s
[Step=35250 Epoch=68.9] | Loss=0.01711 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.628 | L2-Norm(final)=16.264 | 4800.9 samples/s | 75.0 steps/s
[Step=35300 Epoch=69.0] | Loss=0.01699 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.637 | L2-Norm(final)=16.264 | 4810.2 samples/s | 75.2 steps/s
[Step=35350 Epoch=69.1] | Loss=0.01658 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.644 | L2-Norm(final)=16.263 | 4774.1 samples/s | 74.6 steps/s
[Step=35400 Epoch=69.2] | Loss=0.01645 | Reg=0.00186 | acc=0.9531 | L2-Norm=13.652 | L2-Norm(final)=16.262 | 4738.8 samples/s | 74.0 steps/s
[Step=35450 Epoch=69.3] | Loss=0.01626 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.659 | L2-Norm(final)=16.261 | 4797.6 samples/s | 75.0 steps/s
[Step=35500 Epoch=69.4] | Loss=0.01617 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.667 | L2-Norm(final)=16.260 | 5165.2 samples/s | 80.7 steps/s
[Step=35550 Epoch=69.5] | Loss=0.01601 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.674 | L2-Norm(final)=16.259 | 2145.8 samples/s | 33.5 steps/s
[Step=35600 Epoch=69.6] | Loss=0.01581 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.682 | L2-Norm(final)=16.257 | 4620.0 samples/s | 72.2 steps/s
[Step=35650 Epoch=69.7] | Loss=0.01560 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.690 | L2-Norm(final)=16.256 | 4732.8 samples/s | 74.0 steps/s
[Step=35700 Epoch=69.8] | Loss=0.01540 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.698 | L2-Norm(final)=16.255 | 4777.7 samples/s | 74.7 steps/s
[Step=35750 Epoch=69.9] | Loss=0.01523 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.705 | L2-Norm(final)=16.254 | 4815.5 samples/s | 75.2 steps/s
[Step=35800 Epoch=70.0] | Loss=0.01507 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.712 | L2-Norm(final)=16.253 | 4735.7 samples/s | 74.0 steps/s
[Step=35850 Epoch=70.1] | Loss=0.01492 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.718 | L2-Norm(final)=16.252 | 4799.9 samples/s | 75.0 steps/s
[Step=35900 Epoch=70.2] | Loss=0.01473 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.725 | L2-Norm(final)=16.251 | 4789.0 samples/s | 74.8 steps/s
[Step=35950 Epoch=70.3] | Loss=0.01453 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.731 | L2-Norm(final)=16.250 | 4814.9 samples/s | 75.2 steps/s
[Step=36000 Epoch=70.4] | Loss=0.01444 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.737 | L2-Norm(final)=16.249 | 4803.1 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step36000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=34001 Epoch=130.3] | Loss=0.00101 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.313 | L2-Norm(final)=14.780 | 4463.9 samples/s | 69.7 steps/s
[Step=34050 Epoch=130.5] | Loss=0.00105 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=14.783 | 4691.8 samples/s | 73.3 steps/s
[Step=34100 Epoch=130.7] | Loss=0.00074 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=14.790 | 5280.9 samples/s | 82.5 steps/s
[Step=34150 Epoch=130.9] | Loss=0.00057 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=14.797 | 5158.0 samples/s | 80.6 steps/s
[Step=34200 Epoch=131.0] | Loss=0.00049 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=14.805 | 5172.3 samples/s | 80.8 steps/s
[Step=34250 Epoch=131.2] | Loss=0.00043 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=14.812 | 6889.5 samples/s | 107.6 steps/s
[Step=34300 Epoch=131.4] | Loss=0.00045 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=14.819 | 2129.8 samples/s | 33.3 steps/s
[Step=34350 Epoch=131.6] | Loss=0.00042 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=14.825 | 5192.4 samples/s | 81.1 steps/s
[Step=34400 Epoch=131.8] | Loss=0.00044 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=14.832 | 5270.3 samples/s | 82.3 steps/s
[Step=34450 Epoch=132.0] | Loss=0.00042 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=14.839 | 5217.4 samples/s | 81.5 steps/s
[Step=34500 Epoch=132.2] | Loss=0.00039 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=14.845 | 5755.0 samples/s | 89.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=34501 Epoch=132.2] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=14.911 | 4307.3 samples/s | 67.3 steps/s
[Step=34550 Epoch=132.4] | Loss=0.00007 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.305 | L2-Norm(final)=14.919 | 4484.1 samples/s | 70.1 steps/s
[Step=34600 Epoch=132.6] | Loss=0.00005 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.294 | L2-Norm(final)=14.924 | 4545.2 samples/s | 71.0 steps/s
[Step=34650 Epoch=132.8] | Loss=0.00004 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.277 | L2-Norm(final)=14.928 | 4620.2 samples/s | 72.2 steps/s
[Step=34700 Epoch=133.0] | Loss=0.00003 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.261 | L2-Norm(final)=14.931 | 4566.2 samples/s | 71.3 steps/s
[Step=34750 Epoch=133.1] | Loss=0.00005 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.244 | L2-Norm(final)=14.934 | 5656.8 samples/s | 88.4 steps/s
[Step=34800 Epoch=133.3] | Loss=0.00004 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.234 | L2-Norm(final)=14.936 | 2006.7 samples/s | 31.4 steps/s
[Step=34850 Epoch=133.5] | Loss=0.00004 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.223 | L2-Norm(final)=14.937 | 4581.9 samples/s | 71.6 steps/s
[Step=34900 Epoch=133.7] | Loss=0.00003 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.208 | L2-Norm(final)=14.938 | 4492.9 samples/s | 70.2 steps/s
[Step=34950 Epoch=133.9] | Loss=0.00003 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.192 | L2-Norm(final)=14.939 | 4556.6 samples/s | 71.2 steps/s
[Step=35000 Epoch=134.1] | Loss=0.00003 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.175 | L2-Norm(final)=14.940 | 5032.4 samples/s | 78.6 steps/s
[Step=35050 Epoch=134.3] | Loss=0.00002 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.157 | L2-Norm(final)=14.941 | 2095.5 samples/s | 32.7 steps/s
[Step=35100 Epoch=134.5] | Loss=0.00002 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.140 | L2-Norm(final)=14.941 | 4582.3 samples/s | 71.6 steps/s
[Step=35150 Epoch=134.7] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.122 | L2-Norm(final)=14.942 | 4527.8 samples/s | 70.7 steps/s
[Step=35200 Epoch=134.9] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=14.943 | 4586.2 samples/s | 71.7 steps/s
[Step=35250 Epoch=135.1] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.086 | L2-Norm(final)=14.943 | 4487.8 samples/s | 70.1 steps/s
[Step=35300 Epoch=135.3] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.068 | L2-Norm(final)=14.944 | 2187.5 samples/s | 34.2 steps/s
[Step=35350 Epoch=135.4] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.050 | L2-Norm(final)=14.944 | 4620.5 samples/s | 72.2 steps/s
[Step=35400 Epoch=135.6] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.032 | L2-Norm(final)=14.945 | 4521.0 samples/s | 70.6 steps/s
[Step=35450 Epoch=135.8] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.014 | L2-Norm(final)=14.945 | 4550.8 samples/s | 71.1 steps/s
[Step=35500 Epoch=136.0] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.996 | L2-Norm(final)=14.945 | 4535.1 samples/s | 70.9 steps/s
[Step=35550 Epoch=136.2] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.978 | L2-Norm(final)=14.946 | 2205.4 samples/s | 34.5 steps/s
[Step=35600 Epoch=136.4] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.959 | L2-Norm(final)=14.946 | 4530.0 samples/s | 70.8 steps/s
[Step=35650 Epoch=136.6] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.941 | L2-Norm(final)=14.947 | 4546.2 samples/s | 71.0 steps/s
[Step=35700 Epoch=136.8] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.923 | L2-Norm(final)=14.947 | 4624.6 samples/s | 72.3 steps/s
[Step=35750 Epoch=137.0] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=14.948 | 4512.3 samples/s | 70.5 steps/s
[Step=35800 Epoch=137.2] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=14.948 | 6061.8 samples/s | 94.7 steps/s
[Step=35850 Epoch=137.4] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.868 | L2-Norm(final)=14.948 | 1940.2 samples/s | 30.3 steps/s
[Step=35900 Epoch=137.6] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.849 | L2-Norm(final)=14.949 | 4427.4 samples/s | 69.2 steps/s
[Step=35950 Epoch=137.7] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.831 | L2-Norm(final)=14.949 | 4494.9 samples/s | 70.2 steps/s
[Step=36000 Epoch=137.9] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.812 | L2-Norm(final)=14.950 | 4546.6 samples/s | 71.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step36000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=34001 Epoch=130.9] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.313 | L2-Norm(final)=16.035 | 4625.4 samples/s | 72.3 steps/s
[Step=34050 Epoch=131.1] | Loss=0.00020 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=16.045 | 4772.1 samples/s | 74.6 steps/s
[Step=34100 Epoch=131.3] | Loss=0.00053 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=16.056 | 5177.9 samples/s | 80.9 steps/s
[Step=34150 Epoch=131.5] | Loss=0.00055 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=16.066 | 5229.1 samples/s | 81.7 steps/s
[Step=34200 Epoch=131.6] | Loss=0.00050 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=16.077 | 5232.3 samples/s | 81.8 steps/s
[Step=34250 Epoch=131.8] | Loss=0.00044 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=16.086 | 7046.5 samples/s | 110.1 steps/s
[Step=34300 Epoch=132.0] | Loss=0.00049 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=16.094 | 2118.8 samples/s | 33.1 steps/s
[Step=34350 Epoch=132.2] | Loss=0.00045 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=16.102 | 5281.9 samples/s | 82.5 steps/s
[Step=34400 Epoch=132.4] | Loss=0.00042 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=16.109 | 5113.1 samples/s | 79.9 steps/s
[Step=34450 Epoch=132.6] | Loss=0.00045 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=16.116 | 5226.0 samples/s | 81.7 steps/s
[Step=34500 Epoch=132.8] | Loss=0.00043 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=16.124 | 6036.6 samples/s | 94.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=34501 Epoch=132.8] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=16.202 | 4700.9 samples/s | 73.5 steps/s
[Step=34550 Epoch=133.0] | Loss=0.00011 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.306 | L2-Norm(final)=16.206 | 4121.6 samples/s | 64.4 steps/s
[Step=34600 Epoch=133.2] | Loss=0.00011 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.308 | L2-Norm(final)=16.210 | 4521.3 samples/s | 70.6 steps/s
[Step=34650 Epoch=133.4] | Loss=0.00008 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.307 | L2-Norm(final)=16.214 | 4587.3 samples/s | 71.7 steps/s
[Step=34700 Epoch=133.6] | Loss=0.00007 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.300 | L2-Norm(final)=16.216 | 4591.3 samples/s | 71.7 steps/s
[Step=34750 Epoch=133.8] | Loss=0.00006 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=16.217 | 5685.0 samples/s | 88.8 steps/s
[Step=34800 Epoch=134.0] | Loss=0.00005 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.279 | L2-Norm(final)=16.218 | 1971.1 samples/s | 30.8 steps/s
[Step=34850 Epoch=134.2] | Loss=0.00004 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.266 | L2-Norm(final)=16.220 | 4429.0 samples/s | 69.2 steps/s
[Step=34900 Epoch=134.3] | Loss=0.00004 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.254 | L2-Norm(final)=16.221 | 4547.3 samples/s | 71.1 steps/s
[Step=34950 Epoch=134.5] | Loss=0.00003 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=16.222 | 4555.3 samples/s | 71.2 steps/s
[Step=35000 Epoch=134.7] | Loss=0.00003 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.228 | L2-Norm(final)=16.222 | 5169.7 samples/s | 80.8 steps/s
[Step=35050 Epoch=134.9] | Loss=0.00003 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.215 | L2-Norm(final)=16.223 | 2105.1 samples/s | 32.9 steps/s
[Step=35100 Epoch=135.1] | Loss=0.00002 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.203 | L2-Norm(final)=16.224 | 4440.8 samples/s | 69.4 steps/s
[Step=35150 Epoch=135.3] | Loss=0.00002 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.190 | L2-Norm(final)=16.224 | 4569.4 samples/s | 71.4 steps/s
[Step=35200 Epoch=135.5] | Loss=0.00002 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.177 | L2-Norm(final)=16.225 | 4652.6 samples/s | 72.7 steps/s
[Step=35250 Epoch=135.7] | Loss=0.00002 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.164 | L2-Norm(final)=16.226 | 4559.1 samples/s | 71.2 steps/s
[Step=35300 Epoch=135.9] | Loss=0.00002 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.151 | L2-Norm(final)=16.226 | 2197.8 samples/s | 34.3 steps/s
[Step=35350 Epoch=136.1] | Loss=0.00002 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.139 | L2-Norm(final)=16.227 | 4548.0 samples/s | 71.1 steps/s
[Step=35400 Epoch=136.3] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.126 | L2-Norm(final)=16.228 | 4567.7 samples/s | 71.4 steps/s
[Step=35450 Epoch=136.5] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.113 | L2-Norm(final)=16.228 | 4567.1 samples/s | 71.4 steps/s
[Step=35500 Epoch=136.7] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.100 | L2-Norm(final)=16.229 | 4663.0 samples/s | 72.9 steps/s
[Step=35550 Epoch=136.8] | Loss=0.00001 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.087 | L2-Norm(final)=16.230 | 2165.8 samples/s | 33.8 steps/s
[Step=35600 Epoch=137.0] | Loss=0.00001 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.074 | L2-Norm(final)=16.231 | 4572.5 samples/s | 71.4 steps/s
[Step=35650 Epoch=137.2] | Loss=0.00001 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=16.231 | 4562.5 samples/s | 71.3 steps/s
[Step=35700 Epoch=137.4] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.048 | L2-Norm(final)=16.232 | 4557.7 samples/s | 71.2 steps/s
[Step=35750 Epoch=137.6] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.035 | L2-Norm(final)=16.233 | 4546.5 samples/s | 71.0 steps/s
[Step=35800 Epoch=137.8] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.022 | L2-Norm(final)=16.233 | 6709.0 samples/s | 104.8 steps/s
[Step=35850 Epoch=138.0] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.008 | L2-Norm(final)=16.234 | 1917.6 samples/s | 30.0 steps/s
[Step=35900 Epoch=138.2] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=16.235 | 4559.8 samples/s | 71.2 steps/s
[Step=35950 Epoch=138.4] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.982 | L2-Norm(final)=16.236 | 4504.8 samples/s | 70.4 steps/s
[Step=36000 Epoch=138.6] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.968 | L2-Norm(final)=16.236 | 4555.2 samples/s | 71.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07981 | acc=0.9666 | tpr=0.9798 | fpr=0.0622 | 4216.6 samples/s | 16.5 steps/s
Avg test loss: 0.07648, Avg test acc: 0.96670, Avg tpr: 0.97931, Avg fpr: 0.06102, total FA: 476

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06927 | acc=0.9658 | tpr=0.9709 | fpr=0.0453 | 4160.5 samples/s | 16.3 steps/s
Avg test loss: 0.07002, Avg test acc: 0.96530, Avg tpr: 0.97097, Avg fpr: 0.04717, total FA: 368

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.99186 | acc=0.2991 | tpr=0.0084 | fpr=0.0699 | 4208.2 samples/s | 16.4 steps/s
Avg test loss: 7.00876, Avg test acc: 0.29586, Avg tpr: 0.00810, Avg fpr: 0.07127, total FA: 556

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.32154 | acc=0.2890 | tpr=0.0107 | fpr=0.1068 | 4209.1 samples/s | 16.4 steps/s
Avg test loss: 7.32590, Avg test acc: 0.28596, Avg tpr: 0.01061, Avg fpr: 0.10845, total FA: 846

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.82848 | acc=0.1265 | tpr=0.5354 | fpr=0.8809 | 4195.5 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.78460 | acc=0.1265 | tpr=0.5373 | fpr=0.8811 | 7818.9 samples/s | 30.5 steps/s
[Step= 150] | Loss=6.78776 | acc=0.1262 | tpr=0.5346 | fpr=0.8813 | 8177.7 samples/s | 31.9 steps/s
[Step= 200] | Loss=6.78286 | acc=0.1258 | tpr=0.5333 | fpr=0.8816 | 5452.4 samples/s | 21.3 steps/s
[Step= 250] | Loss=6.77868 | acc=0.1258 | tpr=0.5328 | fpr=0.8816 | 8017.9 samples/s | 31.3 steps/s
[Step= 300] | Loss=6.78269 | acc=0.1251 | tpr=0.5251 | fpr=0.8822 | 7788.3 samples/s | 30.4 steps/s
[Step= 350] | Loss=6.79679 | acc=0.1246 | tpr=0.5216 | fpr=0.8827 | 7878.4 samples/s | 30.8 steps/s
[Step= 400] | Loss=6.78463 | acc=0.1240 | tpr=0.5153 | fpr=0.8831 | 6162.3 samples/s | 24.1 steps/s
[Step= 450] | Loss=6.78724 | acc=0.1234 | tpr=0.5175 | fpr=0.8837 | 7507.1 samples/s | 29.3 steps/s
[Step= 500] | Loss=6.78855 | acc=0.1236 | tpr=0.5194 | fpr=0.8836 | 7926.2 samples/s | 31.0 steps/s
[Step= 550] | Loss=6.79089 | acc=0.1237 | tpr=0.5233 | fpr=0.8835 | 14827.8 samples/s | 57.9 steps/s
Avg test loss: 6.79187, Avg test acc: 0.12365, Avg tpr: 0.52338, Avg fpr: 0.88361, total FA: 122688

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.34726 | acc=0.1502 | tpr=0.6018 | fpr=0.8579 | 4202.5 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.26781 | acc=0.1496 | tpr=0.5800 | fpr=0.8584 | 7826.3 samples/s | 30.6 steps/s
[Step= 150] | Loss=6.27116 | acc=0.1493 | tpr=0.5908 | fpr=0.8588 | 7915.7 samples/s | 30.9 steps/s
[Step= 200] | Loss=6.26771 | acc=0.1492 | tpr=0.5902 | fpr=0.8589 | 4953.8 samples/s | 19.4 steps/s
[Step= 250] | Loss=6.26258 | acc=0.1493 | tpr=0.5895 | fpr=0.8587 | 8027.5 samples/s | 31.4 steps/s
[Step= 300] | Loss=6.26771 | acc=0.1491 | tpr=0.5847 | fpr=0.8588 | 7708.5 samples/s | 30.1 steps/s
[Step= 350] | Loss=6.27406 | acc=0.1485 | tpr=0.5867 | fpr=0.8595 | 7378.2 samples/s | 28.8 steps/s
[Step= 400] | Loss=6.25986 | acc=0.1486 | tpr=0.5810 | fpr=0.8593 | 7437.6 samples/s | 29.1 steps/s
[Step= 450] | Loss=6.26285 | acc=0.1483 | tpr=0.5798 | fpr=0.8595 | 7737.8 samples/s | 30.2 steps/s
[Step= 500] | Loss=6.26442 | acc=0.1485 | tpr=0.5855 | fpr=0.8593 | 7803.1 samples/s | 30.5 steps/s
[Step= 550] | Loss=6.26576 | acc=0.1486 | tpr=0.5834 | fpr=0.8593 | 14445.0 samples/s | 56.4 steps/s
Avg test loss: 6.26610, Avg test acc: 0.14858, Avg tpr: 0.58320, Avg fpr: 0.85932, total FA: 119315

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13660 | acc=0.9805 | tpr=0.9248 | fpr=0.0185 | 4176.6 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.14608 | acc=0.9794 | tpr=0.9424 | fpr=0.0199 | 8034.4 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.14835 | acc=0.9788 | tpr=0.9481 | fpr=0.0207 | 5681.5 samples/s | 22.2 steps/s
[Step= 200] | Loss=0.15031 | acc=0.9791 | tpr=0.9519 | fpr=0.0204 | 6888.1 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.14961 | acc=0.9792 | tpr=0.9520 | fpr=0.0203 | 7856.7 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.15254 | acc=0.9790 | tpr=0.9564 | fpr=0.0205 | 8069.8 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.15297 | acc=0.9790 | tpr=0.9555 | fpr=0.0206 | 6817.7 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.15419 | acc=0.9788 | tpr=0.9546 | fpr=0.0208 | 7742.7 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.15651 | acc=0.9785 | tpr=0.9513 | fpr=0.0210 | 7800.8 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.15531 | acc=0.9787 | tpr=0.9520 | fpr=0.0209 | 7837.3 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.15420 | acc=0.9788 | tpr=0.9522 | fpr=0.0207 | 14352.3 samples/s | 56.1 steps/s
Avg test loss: 0.15384, Avg test acc: 0.97889, Avg tpr: 0.95246, Avg fpr: 0.02063, total FA: 2865

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14974 | acc=0.9788 | tpr=0.9336 | fpr=0.0204 | 4131.6 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.15940 | acc=0.9778 | tpr=0.9488 | fpr=0.0216 | 7981.0 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.16173 | acc=0.9772 | tpr=0.9553 | fpr=0.0224 | 5632.0 samples/s | 22.0 steps/s
[Step= 200] | Loss=0.16465 | acc=0.9775 | tpr=0.9574 | fpr=0.0221 | 7781.9 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.16383 | acc=0.9775 | tpr=0.9572 | fpr=0.0221 | 7681.3 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.16745 | acc=0.9774 | tpr=0.9578 | fpr=0.0223 | 7907.0 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.16832 | acc=0.9772 | tpr=0.9562 | fpr=0.0224 | 6289.6 samples/s | 24.6 steps/s
[Step= 400] | Loss=0.16978 | acc=0.9770 | tpr=0.9551 | fpr=0.0226 | 7883.6 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.17202 | acc=0.9768 | tpr=0.9537 | fpr=0.0228 | 7808.4 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.17077 | acc=0.9769 | tpr=0.9542 | fpr=0.0227 | 7689.1 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.16951 | acc=0.9772 | tpr=0.9550 | fpr=0.0224 | 14461.4 samples/s | 56.5 steps/s
Avg test loss: 0.16915, Avg test acc: 0.97725, Avg tpr: 0.95523, Avg fpr: 0.02235, total FA: 3103

server round 18/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=36001 Epoch=70.2] | Loss=0.00136 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=15.805 | 4142.4 samples/s | 64.7 steps/s
[Step=36050 Epoch=70.3] | Loss=0.01259 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.996 | L2-Norm(final)=15.810 | 4980.1 samples/s | 77.8 steps/s
[Step=36100 Epoch=70.4] | Loss=0.01297 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.997 | L2-Norm(final)=15.816 | 5517.2 samples/s | 86.2 steps/s
[Step=36150 Epoch=70.5] | Loss=0.01241 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.997 | L2-Norm(final)=15.823 | 5507.4 samples/s | 86.1 steps/s
[Step=36200 Epoch=70.6] | Loss=0.01245 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=15.830 | 5568.7 samples/s | 87.0 steps/s
[Step=36250 Epoch=70.7] | Loss=0.01224 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.997 | L2-Norm(final)=15.838 | 5518.4 samples/s | 86.2 steps/s
[Step=36300 Epoch=70.8] | Loss=0.01275 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=15.846 | 5636.6 samples/s | 88.1 steps/s
[Step=36350 Epoch=70.9] | Loss=0.01265 | Reg=0.00169 | acc=0.9531 | L2-Norm=12.997 | L2-Norm(final)=15.852 | 5476.9 samples/s | 85.6 steps/s
[Step=36400 Epoch=71.0] | Loss=0.01262 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.997 | L2-Norm(final)=15.858 | 5612.0 samples/s | 87.7 steps/s
[Step=36450 Epoch=71.1] | Loss=0.01232 | Reg=0.00169 | acc=0.9688 | L2-Norm=12.997 | L2-Norm(final)=15.865 | 5535.1 samples/s | 86.5 steps/s
[Step=36500 Epoch=71.2] | Loss=0.01196 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=15.872 | 7007.9 samples/s | 109.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=36501 Epoch=71.2] | Loss=0.00870 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=15.949 | 4150.5 samples/s | 64.9 steps/s
[Step=36550 Epoch=71.3] | Loss=0.01691 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.046 | L2-Norm(final)=15.949 | 4718.4 samples/s | 73.7 steps/s
[Step=36600 Epoch=71.4] | Loss=0.01700 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.091 | L2-Norm(final)=15.938 | 4852.0 samples/s | 75.8 steps/s
[Step=36650 Epoch=71.5] | Loss=0.01848 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.125 | L2-Norm(final)=15.927 | 4733.8 samples/s | 74.0 steps/s
[Step=36700 Epoch=71.6] | Loss=0.01789 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.154 | L2-Norm(final)=15.920 | 4758.7 samples/s | 74.4 steps/s
[Step=36750 Epoch=71.7] | Loss=0.01760 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.179 | L2-Norm(final)=15.916 | 4799.3 samples/s | 75.0 steps/s
[Step=36800 Epoch=71.8] | Loss=0.01834 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.202 | L2-Norm(final)=15.911 | 4869.5 samples/s | 76.1 steps/s
[Step=36850 Epoch=71.9] | Loss=0.01788 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.223 | L2-Norm(final)=15.906 | 4800.3 samples/s | 75.0 steps/s
[Step=36900 Epoch=72.0] | Loss=0.01811 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.242 | L2-Norm(final)=15.902 | 4769.9 samples/s | 74.5 steps/s
[Step=36950 Epoch=72.1] | Loss=0.01813 | Reg=0.00176 | acc=0.9375 | L2-Norm=13.260 | L2-Norm(final)=15.899 | 4782.4 samples/s | 74.7 steps/s
[Step=37000 Epoch=72.2] | Loss=0.01787 | Reg=0.00176 | acc=0.9688 | L2-Norm=13.277 | L2-Norm(final)=15.897 | 5829.0 samples/s | 91.1 steps/s
[Step=37050 Epoch=72.3] | Loss=0.01793 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.293 | L2-Norm(final)=15.895 | 2075.4 samples/s | 32.4 steps/s
[Step=37100 Epoch=72.4] | Loss=0.01755 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.307 | L2-Norm(final)=15.894 | 4708.0 samples/s | 73.6 steps/s
[Step=37150 Epoch=72.5] | Loss=0.01727 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.321 | L2-Norm(final)=15.893 | 4782.1 samples/s | 74.7 steps/s
[Step=37200 Epoch=72.6] | Loss=0.01718 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=15.892 | 4811.3 samples/s | 75.2 steps/s
[Step=37250 Epoch=72.7] | Loss=0.01681 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=15.892 | 4817.8 samples/s | 75.3 steps/s
[Step=37300 Epoch=72.7] | Loss=0.01654 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.357 | L2-Norm(final)=15.892 | 4819.4 samples/s | 75.3 steps/s
[Step=37350 Epoch=72.8] | Loss=0.01627 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.367 | L2-Norm(final)=15.891 | 4742.6 samples/s | 74.1 steps/s
[Step=37400 Epoch=72.9] | Loss=0.01628 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.377 | L2-Norm(final)=15.890 | 4821.7 samples/s | 75.3 steps/s
[Step=37450 Epoch=73.0] | Loss=0.01593 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.387 | L2-Norm(final)=15.890 | 4855.6 samples/s | 75.9 steps/s
[Step=37500 Epoch=73.1] | Loss=0.01565 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.396 | L2-Norm(final)=15.890 | 5075.2 samples/s | 79.3 steps/s
[Step=37550 Epoch=73.2] | Loss=0.01537 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.405 | L2-Norm(final)=15.890 | 2111.2 samples/s | 33.0 steps/s
[Step=37600 Epoch=73.3] | Loss=0.01502 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.413 | L2-Norm(final)=15.890 | 4800.2 samples/s | 75.0 steps/s
[Step=37650 Epoch=73.4] | Loss=0.01496 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.421 | L2-Norm(final)=15.890 | 4817.3 samples/s | 75.3 steps/s
[Step=37700 Epoch=73.5] | Loss=0.01474 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.429 | L2-Norm(final)=15.890 | 4813.5 samples/s | 75.2 steps/s
[Step=37750 Epoch=73.6] | Loss=0.01456 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.436 | L2-Norm(final)=15.890 | 4747.2 samples/s | 74.2 steps/s
[Step=37800 Epoch=73.7] | Loss=0.01433 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.443 | L2-Norm(final)=15.890 | 4810.9 samples/s | 75.2 steps/s
[Step=37850 Epoch=73.8] | Loss=0.01425 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.451 | L2-Norm(final)=15.891 | 4802.0 samples/s | 75.0 steps/s
[Step=37900 Epoch=73.9] | Loss=0.01406 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.458 | L2-Norm(final)=15.892 | 4800.3 samples/s | 75.0 steps/s
[Step=37950 Epoch=74.0] | Loss=0.01402 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.465 | L2-Norm(final)=15.892 | 4834.0 samples/s | 75.5 steps/s
[Step=38000 Epoch=74.1] | Loss=0.01396 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.473 | L2-Norm(final)=15.893 | 4762.6 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step38000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=36001 Epoch=70.4] | Loss=0.01906 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.995 | L2-Norm(final)=16.226 | 5003.1 samples/s | 78.2 steps/s
[Step=36050 Epoch=70.5] | Loss=0.01342 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.998 | L2-Norm(final)=16.233 | 4861.8 samples/s | 76.0 steps/s
[Step=36100 Epoch=70.6] | Loss=0.01353 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.998 | L2-Norm(final)=16.240 | 5543.6 samples/s | 86.6 steps/s
[Step=36150 Epoch=70.7] | Loss=0.01334 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=16.249 | 5492.5 samples/s | 85.8 steps/s
[Step=36200 Epoch=70.8] | Loss=0.01321 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=16.258 | 5597.8 samples/s | 87.5 steps/s
[Step=36250 Epoch=70.9] | Loss=0.01353 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=16.268 | 5444.3 samples/s | 85.1 steps/s
[Step=36300 Epoch=71.0] | Loss=0.01353 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=16.278 | 5502.0 samples/s | 86.0 steps/s
[Step=36350 Epoch=71.1] | Loss=0.01358 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.999 | L2-Norm(final)=16.289 | 5562.6 samples/s | 86.9 steps/s
[Step=36400 Epoch=71.2] | Loss=0.01365 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.999 | L2-Norm(final)=16.300 | 5504.5 samples/s | 86.0 steps/s
[Step=36450 Epoch=71.3] | Loss=0.01388 | Reg=0.00169 | acc=0.9531 | L2-Norm=12.999 | L2-Norm(final)=16.309 | 5515.7 samples/s | 86.2 steps/s
[Step=36500 Epoch=71.4] | Loss=0.01397 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.999 | L2-Norm(final)=16.317 | 7073.2 samples/s | 110.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=36501 Epoch=71.4] | Loss=0.01443 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=16.397 | 4649.6 samples/s | 72.6 steps/s
[Step=36550 Epoch=71.5] | Loss=0.00989 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.066 | L2-Norm(final)=16.402 | 4538.4 samples/s | 70.9 steps/s
[Step=36600 Epoch=71.6] | Loss=0.01353 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.116 | L2-Norm(final)=16.398 | 4862.9 samples/s | 76.0 steps/s
[Step=36650 Epoch=71.6] | Loss=0.01574 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.155 | L2-Norm(final)=16.393 | 4696.0 samples/s | 73.4 steps/s
[Step=36700 Epoch=71.7] | Loss=0.01639 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.185 | L2-Norm(final)=16.388 | 4705.1 samples/s | 73.5 steps/s
[Step=36750 Epoch=71.8] | Loss=0.01718 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.208 | L2-Norm(final)=16.383 | 4801.7 samples/s | 75.0 steps/s
[Step=36800 Epoch=71.9] | Loss=0.01706 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.228 | L2-Norm(final)=16.378 | 4796.2 samples/s | 74.9 steps/s
[Step=36850 Epoch=72.0] | Loss=0.01713 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.247 | L2-Norm(final)=16.375 | 4766.9 samples/s | 74.5 steps/s
[Step=36900 Epoch=72.1] | Loss=0.01729 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.264 | L2-Norm(final)=16.372 | 4782.4 samples/s | 74.7 steps/s
[Step=36950 Epoch=72.2] | Loss=0.01755 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.280 | L2-Norm(final)=16.370 | 4791.9 samples/s | 74.9 steps/s
[Step=37000 Epoch=72.3] | Loss=0.01732 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.296 | L2-Norm(final)=16.368 | 5922.1 samples/s | 92.5 steps/s
[Step=37050 Epoch=72.4] | Loss=0.01701 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.310 | L2-Norm(final)=16.366 | 2093.0 samples/s | 32.7 steps/s
[Step=37100 Epoch=72.5] | Loss=0.01650 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.322 | L2-Norm(final)=16.365 | 4798.3 samples/s | 75.0 steps/s
[Step=37150 Epoch=72.6] | Loss=0.01668 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=16.363 | 4751.5 samples/s | 74.2 steps/s
[Step=37200 Epoch=72.7] | Loss=0.01653 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=16.361 | 4870.7 samples/s | 76.1 steps/s
[Step=37250 Epoch=72.8] | Loss=0.01635 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.357 | L2-Norm(final)=16.359 | 4688.0 samples/s | 73.2 steps/s
[Step=37300 Epoch=72.9] | Loss=0.01601 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.367 | L2-Norm(final)=16.358 | 4789.2 samples/s | 74.8 steps/s
[Step=37350 Epoch=73.0] | Loss=0.01597 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.376 | L2-Norm(final)=16.356 | 4806.4 samples/s | 75.1 steps/s
[Step=37400 Epoch=73.1] | Loss=0.01577 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.385 | L2-Norm(final)=16.355 | 4778.0 samples/s | 74.7 steps/s
[Step=37450 Epoch=73.2] | Loss=0.01575 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.394 | L2-Norm(final)=16.354 | 4808.1 samples/s | 75.1 steps/s
[Step=37500 Epoch=73.3] | Loss=0.01552 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.403 | L2-Norm(final)=16.353 | 5161.5 samples/s | 80.6 steps/s
[Step=37550 Epoch=73.4] | Loss=0.01537 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.411 | L2-Norm(final)=16.352 | 2187.2 samples/s | 34.2 steps/s
[Step=37600 Epoch=73.5] | Loss=0.01516 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.419 | L2-Norm(final)=16.351 | 4826.3 samples/s | 75.4 steps/s
[Step=37650 Epoch=73.6] | Loss=0.01497 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.426 | L2-Norm(final)=16.350 | 4807.5 samples/s | 75.1 steps/s
[Step=37700 Epoch=73.7] | Loss=0.01484 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.434 | L2-Norm(final)=16.349 | 4722.6 samples/s | 73.8 steps/s
[Step=37750 Epoch=73.8] | Loss=0.01482 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.441 | L2-Norm(final)=16.349 | 4845.6 samples/s | 75.7 steps/s
[Step=37800 Epoch=73.9] | Loss=0.01467 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.448 | L2-Norm(final)=16.348 | 4721.7 samples/s | 73.8 steps/s
[Step=37850 Epoch=74.0] | Loss=0.01448 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.455 | L2-Norm(final)=16.347 | 4801.8 samples/s | 75.0 steps/s
[Step=37900 Epoch=74.1] | Loss=0.01430 | Reg=0.00181 | acc=0.9531 | L2-Norm=13.461 | L2-Norm(final)=16.347 | 4787.8 samples/s | 74.8 steps/s
[Step=37950 Epoch=74.2] | Loss=0.01411 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.467 | L2-Norm(final)=16.346 | 4764.2 samples/s | 74.4 steps/s
[Step=38000 Epoch=74.3] | Loss=0.01393 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.473 | L2-Norm(final)=16.345 | 4750.2 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step38000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=36001 Epoch=137.9] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=14.965 | 4532.2 samples/s | 70.8 steps/s
[Step=36050 Epoch=138.1] | Loss=0.00074 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.988 | L2-Norm(final)=14.976 | 4959.6 samples/s | 77.5 steps/s
[Step=36100 Epoch=138.3] | Loss=0.00052 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.988 | L2-Norm(final)=14.990 | 5239.5 samples/s | 81.9 steps/s
[Step=36150 Epoch=138.5] | Loss=0.00039 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=15.004 | 5247.1 samples/s | 82.0 steps/s
[Step=36200 Epoch=138.7] | Loss=0.00035 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=15.016 | 5242.8 samples/s | 81.9 steps/s
[Step=36250 Epoch=138.9] | Loss=0.00032 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=15.028 | 6682.0 samples/s | 104.4 steps/s
[Step=36300 Epoch=139.1] | Loss=0.00039 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=15.039 | 2140.7 samples/s | 33.4 steps/s
[Step=36350 Epoch=139.3] | Loss=0.00035 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=15.048 | 5142.6 samples/s | 80.4 steps/s
[Step=36400 Epoch=139.5] | Loss=0.00034 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=15.057 | 5188.6 samples/s | 81.1 steps/s
[Step=36450 Epoch=139.7] | Loss=0.00033 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=15.067 | 5233.0 samples/s | 81.8 steps/s
[Step=36500 Epoch=139.9] | Loss=0.00031 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=15.078 | 5828.4 samples/s | 91.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=36501 Epoch=139.9] | Loss=0.00000 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=15.185 | 4529.3 samples/s | 70.8 steps/s
[Step=36550 Epoch=140.0] | Loss=0.00880 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.139 | L2-Norm(final)=15.166 | 4254.9 samples/s | 66.5 steps/s
[Step=36600 Epoch=140.2] | Loss=0.00669 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=15.140 | 4624.8 samples/s | 72.3 steps/s
[Step=36650 Epoch=140.4] | Loss=0.00585 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=15.124 | 4507.3 samples/s | 70.4 steps/s
[Step=36700 Epoch=140.6] | Loss=0.00453 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=15.114 | 4591.0 samples/s | 71.7 steps/s
[Step=36750 Epoch=140.8] | Loss=0.00366 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.392 | L2-Norm(final)=15.109 | 5575.2 samples/s | 87.1 steps/s
[Step=36800 Epoch=141.0] | Loss=0.00305 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.400 | L2-Norm(final)=15.107 | 2023.5 samples/s | 31.6 steps/s
[Step=36850 Epoch=141.2] | Loss=0.00272 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.404 | L2-Norm(final)=15.105 | 4322.3 samples/s | 67.5 steps/s
[Step=36900 Epoch=141.4] | Loss=0.00239 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.404 | L2-Norm(final)=15.104 | 4502.0 samples/s | 70.3 steps/s
[Step=36950 Epoch=141.6] | Loss=0.00212 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.403 | L2-Norm(final)=15.103 | 4507.8 samples/s | 70.4 steps/s
[Step=37000 Epoch=141.8] | Loss=0.00194 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.400 | L2-Norm(final)=15.103 | 5024.7 samples/s | 78.5 steps/s
[Step=37050 Epoch=142.0] | Loss=0.00176 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.396 | L2-Norm(final)=15.103 | 2097.5 samples/s | 32.8 steps/s
[Step=37100 Epoch=142.2] | Loss=0.00162 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.392 | L2-Norm(final)=15.103 | 4569.1 samples/s | 71.4 steps/s
[Step=37150 Epoch=142.3] | Loss=0.00150 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=15.103 | 4562.1 samples/s | 71.3 steps/s
[Step=37200 Epoch=142.5] | Loss=0.00139 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=15.104 | 4568.5 samples/s | 71.4 steps/s
[Step=37250 Epoch=142.7] | Loss=0.00130 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.377 | L2-Norm(final)=15.104 | 4508.4 samples/s | 70.4 steps/s
[Step=37300 Epoch=142.9] | Loss=0.00122 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=15.105 | 2192.3 samples/s | 34.3 steps/s
[Step=37350 Epoch=143.1] | Loss=0.00114 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=15.105 | 4624.9 samples/s | 72.3 steps/s
[Step=37400 Epoch=143.3] | Loss=0.00108 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=15.106 | 4523.5 samples/s | 70.7 steps/s
[Step=37450 Epoch=143.5] | Loss=0.00102 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=15.107 | 4567.6 samples/s | 71.4 steps/s
[Step=37500 Epoch=143.7] | Loss=0.00097 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=15.107 | 4525.9 samples/s | 70.7 steps/s
[Step=37550 Epoch=143.9] | Loss=0.00093 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.336 | L2-Norm(final)=15.108 | 2210.1 samples/s | 34.5 steps/s
[Step=37600 Epoch=144.1] | Loss=0.00089 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.329 | L2-Norm(final)=15.108 | 4527.4 samples/s | 70.7 steps/s
[Step=37650 Epoch=144.3] | Loss=0.00085 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.321 | L2-Norm(final)=15.109 | 4565.5 samples/s | 71.3 steps/s
[Step=37700 Epoch=144.5] | Loss=0.00081 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.314 | L2-Norm(final)=15.109 | 4546.5 samples/s | 71.0 steps/s
[Step=37750 Epoch=144.6] | Loss=0.00078 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.306 | L2-Norm(final)=15.110 | 4544.2 samples/s | 71.0 steps/s
[Step=37800 Epoch=144.8] | Loss=0.00075 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.298 | L2-Norm(final)=15.110 | 6183.1 samples/s | 96.6 steps/s
[Step=37850 Epoch=145.0] | Loss=0.00072 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=15.111 | 1945.0 samples/s | 30.4 steps/s
[Step=37900 Epoch=145.2] | Loss=0.00070 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.282 | L2-Norm(final)=15.112 | 4575.1 samples/s | 71.5 steps/s
[Step=37950 Epoch=145.4] | Loss=0.00067 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=15.113 | 4494.3 samples/s | 70.2 steps/s
[Step=38000 Epoch=145.6] | Loss=0.00065 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.266 | L2-Norm(final)=15.114 | 4556.1 samples/s | 71.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step38000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=36001 Epoch=138.6] | Loss=0.00000 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=16.261 | 4619.5 samples/s | 72.2 steps/s
[Step=36050 Epoch=138.8] | Loss=0.00020 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.990 | L2-Norm(final)=16.270 | 4619.2 samples/s | 72.2 steps/s
[Step=36100 Epoch=139.0] | Loss=0.00074 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.990 | L2-Norm(final)=16.280 | 5291.3 samples/s | 82.7 steps/s
[Step=36150 Epoch=139.2] | Loss=0.00065 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.989 | L2-Norm(final)=16.290 | 5090.0 samples/s | 79.5 steps/s
[Step=36200 Epoch=139.3] | Loss=0.00059 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.989 | L2-Norm(final)=16.304 | 5221.2 samples/s | 81.6 steps/s
[Step=36250 Epoch=139.5] | Loss=0.00051 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.989 | L2-Norm(final)=16.318 | 7019.1 samples/s | 109.7 steps/s
[Step=36300 Epoch=139.7] | Loss=0.00051 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.989 | L2-Norm(final)=16.332 | 2120.9 samples/s | 33.1 steps/s
[Step=36350 Epoch=139.9] | Loss=0.00051 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.989 | L2-Norm(final)=16.347 | 5195.7 samples/s | 81.2 steps/s
[Step=36400 Epoch=140.1] | Loss=0.00047 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.989 | L2-Norm(final)=16.361 | 5193.4 samples/s | 81.1 steps/s
[Step=36450 Epoch=140.3] | Loss=0.00048 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.989 | L2-Norm(final)=16.374 | 5350.1 samples/s | 83.6 steps/s
[Step=36500 Epoch=140.5] | Loss=0.00049 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.989 | L2-Norm(final)=16.387 | 5942.4 samples/s | 92.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=36501 Epoch=140.5] | Loss=0.00000 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.989 | L2-Norm(final)=16.513 | 4745.7 samples/s | 74.2 steps/s
[Step=36550 Epoch=140.7] | Loss=0.01641 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.074 | L2-Norm(final)=16.505 | 4080.8 samples/s | 63.8 steps/s
[Step=36600 Epoch=140.9] | Loss=0.01153 | Reg=0.00175 | acc=0.9531 | L2-Norm=13.225 | L2-Norm(final)=16.486 | 4584.4 samples/s | 71.6 steps/s
[Step=36650 Epoch=141.1] | Loss=0.00844 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=16.475 | 4626.9 samples/s | 72.3 steps/s
[Step=36700 Epoch=141.3] | Loss=0.00655 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=16.468 | 4507.3 samples/s | 70.4 steps/s
[Step=36750 Epoch=141.5] | Loss=0.00528 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=16.465 | 5808.8 samples/s | 90.8 steps/s
[Step=36800 Epoch=141.7] | Loss=0.00441 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=16.464 | 2011.3 samples/s | 31.4 steps/s
[Step=36850 Epoch=141.9] | Loss=0.00379 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=16.463 | 4554.4 samples/s | 71.2 steps/s
[Step=36900 Epoch=142.0] | Loss=0.00332 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=16.463 | 4456.4 samples/s | 69.6 steps/s
[Step=36950 Epoch=142.2] | Loss=0.00295 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=16.463 | 4551.7 samples/s | 71.1 steps/s
[Step=37000 Epoch=142.4] | Loss=0.00266 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=16.463 | 5162.4 samples/s | 80.7 steps/s
[Step=37050 Epoch=142.6] | Loss=0.00242 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=16.463 | 1635.6 samples/s | 25.6 steps/s
[Step=37100 Epoch=142.8] | Loss=0.00222 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=16.463 | 4211.3 samples/s | 65.8 steps/s
[Step=37150 Epoch=143.0] | Loss=0.00205 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=16.464 | 4568.6 samples/s | 71.4 steps/s
[Step=37200 Epoch=143.2] | Loss=0.00191 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=16.464 | 4678.6 samples/s | 73.1 steps/s
[Step=37250 Epoch=143.4] | Loss=0.00178 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=16.465 | 4548.9 samples/s | 71.1 steps/s
[Step=37300 Epoch=143.6] | Loss=0.00167 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=16.465 | 2148.3 samples/s | 33.6 steps/s
[Step=37350 Epoch=143.8] | Loss=0.00157 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=16.466 | 4554.3 samples/s | 71.2 steps/s
[Step=37400 Epoch=144.0] | Loss=0.00148 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=16.466 | 4547.3 samples/s | 71.1 steps/s
[Step=37450 Epoch=144.2] | Loss=0.00141 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.338 | L2-Norm(final)=16.467 | 4594.0 samples/s | 71.8 steps/s
[Step=37500 Epoch=144.4] | Loss=0.00134 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=16.467 | 4566.4 samples/s | 71.3 steps/s
[Step=37550 Epoch=144.5] | Loss=0.00127 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.328 | L2-Norm(final)=16.468 | 2231.2 samples/s | 34.9 steps/s
[Step=37600 Epoch=144.7] | Loss=0.00122 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.322 | L2-Norm(final)=16.468 | 4525.8 samples/s | 70.7 steps/s
[Step=37650 Epoch=144.9] | Loss=0.00116 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.317 | L2-Norm(final)=16.469 | 4480.8 samples/s | 70.0 steps/s
[Step=37700 Epoch=145.1] | Loss=0.00111 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=16.470 | 4508.5 samples/s | 70.4 steps/s
[Step=37750 Epoch=145.3] | Loss=0.00107 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.306 | L2-Norm(final)=16.471 | 4559.5 samples/s | 71.2 steps/s
[Step=37800 Epoch=145.5] | Loss=0.00103 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.300 | L2-Norm(final)=16.471 | 6647.8 samples/s | 103.9 steps/s
[Step=37850 Epoch=145.7] | Loss=0.00099 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.294 | L2-Norm(final)=16.472 | 1936.8 samples/s | 30.3 steps/s
[Step=37900 Epoch=145.9] | Loss=0.00096 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.289 | L2-Norm(final)=16.473 | 4584.0 samples/s | 71.6 steps/s
[Step=37950 Epoch=146.1] | Loss=0.00092 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=16.474 | 4507.2 samples/s | 70.4 steps/s
[Step=38000 Epoch=146.3] | Loss=0.00089 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.277 | L2-Norm(final)=16.474 | 4599.0 samples/s | 71.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step38000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08287 | acc=0.9662 | tpr=0.9758 | fpr=0.0548 | 4191.8 samples/s | 16.4 steps/s
Avg test loss: 0.07967, Avg test acc: 0.96566, Avg tpr: 0.97604, Avg fpr: 0.05717, total FA: 446

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08274 | acc=0.9682 | tpr=0.9806 | fpr=0.0587 | 4231.8 samples/s | 16.5 steps/s
Avg test loss: 0.08314, Avg test acc: 0.96755, Avg tpr: 0.98042, Avg fpr: 0.06076, total FA: 474

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=8.79900 | acc=0.3041 | tpr=0.0049 | fpr=0.0463 | 4180.6 samples/s | 16.3 steps/s
Avg test loss: 8.78975, Avg test acc: 0.30235, Avg tpr: 0.00583, Avg fpr: 0.04551, total FA: 355

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=8.30146 | acc=0.3062 | tpr=0.0065 | fpr=0.0431 | 4199.9 samples/s | 16.4 steps/s
Avg test loss: 8.32416, Avg test acc: 0.30459, Avg tpr: 0.00729, Avg fpr: 0.04153, total FA: 324

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.57977 | acc=0.1194 | tpr=0.6637 | fpr=0.8904 | 4184.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=7.50796 | acc=0.1209 | tpr=0.6738 | fpr=0.8894 | 7839.6 samples/s | 30.6 steps/s
[Step= 150] | Loss=7.50962 | acc=0.1211 | tpr=0.6643 | fpr=0.8889 | 7945.6 samples/s | 31.0 steps/s
[Step= 200] | Loss=7.50725 | acc=0.1209 | tpr=0.6623 | fpr=0.8890 | 7862.4 samples/s | 30.7 steps/s
[Step= 250] | Loss=7.50203 | acc=0.1207 | tpr=0.6507 | fpr=0.8889 | 7915.9 samples/s | 30.9 steps/s
[Step= 300] | Loss=7.50418 | acc=0.1200 | tpr=0.6444 | fpr=0.8896 | 8157.1 samples/s | 31.9 steps/s
[Step= 350] | Loss=7.51592 | acc=0.1189 | tpr=0.6368 | fpr=0.8905 | 7531.6 samples/s | 29.4 steps/s
[Step= 400] | Loss=7.50713 | acc=0.1183 | tpr=0.6286 | fpr=0.8910 | 7893.9 samples/s | 30.8 steps/s
[Step= 450] | Loss=7.51300 | acc=0.1179 | tpr=0.6251 | fpr=0.8913 | 7877.0 samples/s | 30.8 steps/s
[Step= 500] | Loss=7.51275 | acc=0.1182 | tpr=0.6304 | fpr=0.8911 | 7824.1 samples/s | 30.6 steps/s
[Step= 550] | Loss=7.51348 | acc=0.1185 | tpr=0.6303 | fpr=0.8908 | 14273.9 samples/s | 55.8 steps/s
Avg test loss: 7.51389, Avg test acc: 0.11842, Avg tpr: 0.63074, Avg fpr: 0.89090, total FA: 123699

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.67130 | acc=0.1262 | tpr=0.6460 | fpr=0.8832 | 4195.7 samples/s | 16.4 steps/s
[Step= 100] | Loss=7.58394 | acc=0.1282 | tpr=0.6375 | fpr=0.8813 | 7801.2 samples/s | 30.5 steps/s
[Step= 150] | Loss=7.60137 | acc=0.1275 | tpr=0.6354 | fpr=0.8818 | 8167.3 samples/s | 31.9 steps/s
[Step= 200] | Loss=7.59519 | acc=0.1276 | tpr=0.6328 | fpr=0.8816 | 7575.7 samples/s | 29.6 steps/s
[Step= 250] | Loss=7.58840 | acc=0.1276 | tpr=0.6297 | fpr=0.8815 | 7881.9 samples/s | 30.8 steps/s
[Step= 300] | Loss=7.59065 | acc=0.1274 | tpr=0.6262 | fpr=0.8817 | 7715.0 samples/s | 30.1 steps/s
[Step= 350] | Loss=7.59773 | acc=0.1267 | tpr=0.6312 | fpr=0.8824 | 8024.4 samples/s | 31.3 steps/s
[Step= 400] | Loss=7.58140 | acc=0.1264 | tpr=0.6258 | fpr=0.8827 | 7812.2 samples/s | 30.5 steps/s
[Step= 450] | Loss=7.58393 | acc=0.1262 | tpr=0.6227 | fpr=0.8829 | 7906.9 samples/s | 30.9 steps/s
[Step= 500] | Loss=7.58488 | acc=0.1259 | tpr=0.6247 | fpr=0.8831 | 7962.8 samples/s | 31.1 steps/s
[Step= 550] | Loss=7.58721 | acc=0.1262 | tpr=0.6228 | fpr=0.8828 | 14362.3 samples/s | 56.1 steps/s
Avg test loss: 7.58727, Avg test acc: 0.12613, Avg tpr: 0.62242, Avg fpr: 0.88289, total FA: 122588

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11681 | acc=0.9808 | tpr=0.9292 | fpr=0.0183 | 4187.9 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.12763 | acc=0.9796 | tpr=0.9360 | fpr=0.0196 | 8181.9 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.12885 | acc=0.9792 | tpr=0.9380 | fpr=0.0200 | 7555.7 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.13064 | acc=0.9788 | tpr=0.9421 | fpr=0.0205 | 8267.2 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.12888 | acc=0.9790 | tpr=0.9459 | fpr=0.0204 | 7544.3 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.13094 | acc=0.9787 | tpr=0.9425 | fpr=0.0206 | 8273.3 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.13080 | acc=0.9788 | tpr=0.9443 | fpr=0.0206 | 7453.8 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.13212 | acc=0.9784 | tpr=0.9404 | fpr=0.0209 | 7689.5 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.13382 | acc=0.9782 | tpr=0.9377 | fpr=0.0211 | 8085.2 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.13270 | acc=0.9784 | tpr=0.9383 | fpr=0.0209 | 7857.7 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.13164 | acc=0.9785 | tpr=0.9383 | fpr=0.0207 | 13743.7 samples/s | 53.7 steps/s
Avg test loss: 0.13137, Avg test acc: 0.97855, Avg tpr: 0.93780, Avg fpr: 0.02071, total FA: 2876

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13799 | acc=0.9804 | tpr=0.9381 | fpr=0.0188 | 4222.3 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.15256 | acc=0.9795 | tpr=0.9531 | fpr=0.0200 | 7749.6 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.15535 | acc=0.9785 | tpr=0.9625 | fpr=0.0212 | 7876.5 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.15649 | acc=0.9787 | tpr=0.9650 | fpr=0.0210 | 7778.2 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.15662 | acc=0.9787 | tpr=0.9624 | fpr=0.0210 | 7952.0 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.16035 | acc=0.9782 | tpr=0.9578 | fpr=0.0215 | 7766.1 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.16137 | acc=0.9780 | tpr=0.9543 | fpr=0.0216 | 7905.4 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.16239 | acc=0.9777 | tpr=0.9535 | fpr=0.0218 | 7980.6 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.16390 | acc=0.9776 | tpr=0.9518 | fpr=0.0219 | 7727.5 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.16315 | acc=0.9776 | tpr=0.9520 | fpr=0.0219 | 7995.6 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.16225 | acc=0.9778 | tpr=0.9515 | fpr=0.0217 | 14441.1 samples/s | 56.4 steps/s
Avg test loss: 0.16188, Avg test acc: 0.97781, Avg tpr: 0.95166, Avg fpr: 0.02171, total FA: 3015

server round 19/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=38001 Epoch=74.1] | Loss=0.05069 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.063 | L2-Norm(final)=15.906 | 4465.1 samples/s | 69.8 steps/s
[Step=38050 Epoch=74.2] | Loss=0.02112 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.067 | L2-Norm(final)=15.918 | 5241.1 samples/s | 81.9 steps/s
[Step=38100 Epoch=74.3] | Loss=0.02265 | Reg=0.00171 | acc=0.9531 | L2-Norm=13.068 | L2-Norm(final)=15.942 | 5478.5 samples/s | 85.6 steps/s
[Step=38150 Epoch=74.4] | Loss=0.02284 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.068 | L2-Norm(final)=15.966 | 5534.5 samples/s | 86.5 steps/s
[Step=38200 Epoch=74.5] | Loss=0.02411 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.068 | L2-Norm(final)=15.989 | 5559.4 samples/s | 86.9 steps/s
[Step=38250 Epoch=74.6] | Loss=0.02393 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.068 | L2-Norm(final)=16.011 | 5562.1 samples/s | 86.9 steps/s
[Step=38300 Epoch=74.7] | Loss=0.02341 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.068 | L2-Norm(final)=16.033 | 5682.3 samples/s | 88.8 steps/s
[Step=38350 Epoch=74.8] | Loss=0.02290 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.068 | L2-Norm(final)=16.056 | 5442.8 samples/s | 85.0 steps/s
[Step=38400 Epoch=74.9] | Loss=0.02308 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.068 | L2-Norm(final)=16.079 | 5608.1 samples/s | 87.6 steps/s
[Step=38450 Epoch=75.0] | Loss=0.02282 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.068 | L2-Norm(final)=16.102 | 5520.6 samples/s | 86.3 steps/s
[Step=38500 Epoch=75.1] | Loss=0.02257 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.068 | L2-Norm(final)=16.124 | 7030.8 samples/s | 109.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=38501 Epoch=75.1] | Loss=0.02175 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.068 | L2-Norm(final)=16.344 | 4119.0 samples/s | 64.4 steps/s
[Step=38550 Epoch=75.2] | Loss=0.02118 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.147 | L2-Norm(final)=16.351 | 4636.5 samples/s | 72.4 steps/s
[Step=38600 Epoch=75.3] | Loss=0.01918 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.200 | L2-Norm(final)=16.345 | 4803.5 samples/s | 75.1 steps/s
[Step=38650 Epoch=75.4] | Loss=0.01927 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.236 | L2-Norm(final)=16.339 | 4694.1 samples/s | 73.3 steps/s
[Step=38700 Epoch=75.5] | Loss=0.01835 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.264 | L2-Norm(final)=16.335 | 4797.2 samples/s | 75.0 steps/s
[Step=38750 Epoch=75.6] | Loss=0.01785 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.288 | L2-Norm(final)=16.333 | 4800.8 samples/s | 75.0 steps/s
[Step=38800 Epoch=75.7] | Loss=0.01810 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.309 | L2-Norm(final)=16.330 | 4876.1 samples/s | 76.2 steps/s
[Step=38850 Epoch=75.8] | Loss=0.01829 | Reg=0.00178 | acc=0.9375 | L2-Norm=13.328 | L2-Norm(final)=16.327 | 4784.5 samples/s | 74.8 steps/s
[Step=38900 Epoch=75.9] | Loss=0.01802 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=16.324 | 4779.0 samples/s | 74.7 steps/s
[Step=38950 Epoch=76.0] | Loss=0.01815 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.362 | L2-Norm(final)=16.321 | 4787.0 samples/s | 74.8 steps/s
[Step=39000 Epoch=76.1] | Loss=0.01840 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.377 | L2-Norm(final)=16.318 | 5845.5 samples/s | 91.3 steps/s
[Step=39050 Epoch=76.2] | Loss=0.01798 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.391 | L2-Norm(final)=16.315 | 2066.5 samples/s | 32.3 steps/s
[Step=39100 Epoch=76.3] | Loss=0.01743 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.404 | L2-Norm(final)=16.313 | 4708.4 samples/s | 73.6 steps/s
[Step=39150 Epoch=76.4] | Loss=0.01689 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.417 | L2-Norm(final)=16.311 | 4825.1 samples/s | 75.4 steps/s
[Step=39200 Epoch=76.5] | Loss=0.01657 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.428 | L2-Norm(final)=16.310 | 4780.8 samples/s | 74.7 steps/s
[Step=39250 Epoch=76.6] | Loss=0.01608 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=16.309 | 4827.1 samples/s | 75.4 steps/s
[Step=39300 Epoch=76.7] | Loss=0.01604 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.448 | L2-Norm(final)=16.309 | 4793.2 samples/s | 74.9 steps/s
[Step=39350 Epoch=76.7] | Loss=0.01585 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.458 | L2-Norm(final)=16.308 | 4818.4 samples/s | 75.3 steps/s
[Step=39400 Epoch=76.8] | Loss=0.01566 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.468 | L2-Norm(final)=16.307 | 4774.9 samples/s | 74.6 steps/s
[Step=39450 Epoch=76.9] | Loss=0.01562 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=16.307 | 4832.4 samples/s | 75.5 steps/s
[Step=39500 Epoch=77.0] | Loss=0.01553 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.487 | L2-Norm(final)=16.306 | 5067.4 samples/s | 79.2 steps/s
[Step=39550 Epoch=77.1] | Loss=0.01522 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.497 | L2-Norm(final)=16.306 | 2101.3 samples/s | 32.8 steps/s
[Step=39600 Epoch=77.2] | Loss=0.01494 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.505 | L2-Norm(final)=16.306 | 4776.3 samples/s | 74.6 steps/s
[Step=39650 Epoch=77.3] | Loss=0.01465 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.514 | L2-Norm(final)=16.306 | 4820.2 samples/s | 75.3 steps/s
[Step=39700 Epoch=77.4] | Loss=0.01443 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.522 | L2-Norm(final)=16.306 | 4790.7 samples/s | 74.9 steps/s
[Step=39750 Epoch=77.5] | Loss=0.01437 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.530 | L2-Norm(final)=16.306 | 4777.8 samples/s | 74.7 steps/s
[Step=39800 Epoch=77.6] | Loss=0.01426 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.537 | L2-Norm(final)=16.306 | 4810.5 samples/s | 75.2 steps/s
[Step=39850 Epoch=77.7] | Loss=0.01421 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.545 | L2-Norm(final)=16.305 | 4832.5 samples/s | 75.5 steps/s
[Step=39900 Epoch=77.8] | Loss=0.01415 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.552 | L2-Norm(final)=16.305 | 4837.3 samples/s | 75.6 steps/s
[Step=39950 Epoch=77.9] | Loss=0.01411 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.560 | L2-Norm(final)=16.305 | 4798.1 samples/s | 75.0 steps/s
[Step=40000 Epoch=78.0] | Loss=0.01402 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.567 | L2-Norm(final)=16.304 | 4757.3 samples/s | 74.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step40000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=38001 Epoch=74.3] | Loss=0.02810 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.063 | L2-Norm(final)=16.330 | 4742.4 samples/s | 74.1 steps/s
[Step=38050 Epoch=74.4] | Loss=0.02256 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.064 | L2-Norm(final)=16.349 | 5022.1 samples/s | 78.5 steps/s
[Step=38100 Epoch=74.5] | Loss=0.02229 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.064 | L2-Norm(final)=16.373 | 5573.1 samples/s | 87.1 steps/s
[Step=38150 Epoch=74.6] | Loss=0.02274 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.064 | L2-Norm(final)=16.398 | 5583.8 samples/s | 87.2 steps/s
[Step=38200 Epoch=74.7] | Loss=0.02198 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.064 | L2-Norm(final)=16.422 | 5411.0 samples/s | 84.5 steps/s
[Step=38250 Epoch=74.8] | Loss=0.02286 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.064 | L2-Norm(final)=16.444 | 5545.7 samples/s | 86.7 steps/s
[Step=38300 Epoch=74.9] | Loss=0.02265 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.064 | L2-Norm(final)=16.465 | 5542.4 samples/s | 86.6 steps/s
[Step=38350 Epoch=75.0] | Loss=0.02284 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.064 | L2-Norm(final)=16.486 | 5550.3 samples/s | 86.7 steps/s
[Step=38400 Epoch=75.1] | Loss=0.02275 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.064 | L2-Norm(final)=16.507 | 5563.8 samples/s | 86.9 steps/s
[Step=38450 Epoch=75.2] | Loss=0.02255 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.064 | L2-Norm(final)=16.527 | 5556.1 samples/s | 86.8 steps/s
[Step=38500 Epoch=75.3] | Loss=0.02228 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.064 | L2-Norm(final)=16.547 | 6920.3 samples/s | 108.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=38501 Epoch=75.3] | Loss=0.01443 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.064 | L2-Norm(final)=16.744 | 4658.1 samples/s | 72.8 steps/s
[Step=38550 Epoch=75.4] | Loss=0.02197 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.130 | L2-Norm(final)=16.748 | 4521.5 samples/s | 70.6 steps/s
[Step=38600 Epoch=75.5] | Loss=0.02032 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.184 | L2-Norm(final)=16.745 | 4723.7 samples/s | 73.8 steps/s
[Step=38650 Epoch=75.6] | Loss=0.02151 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.220 | L2-Norm(final)=16.739 | 4817.9 samples/s | 75.3 steps/s
[Step=38700 Epoch=75.7] | Loss=0.02060 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.250 | L2-Norm(final)=16.733 | 4700.9 samples/s | 73.5 steps/s
[Step=38750 Epoch=75.8] | Loss=0.02048 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.275 | L2-Norm(final)=16.729 | 4821.8 samples/s | 75.3 steps/s
[Step=38800 Epoch=75.9] | Loss=0.02032 | Reg=0.00177 | acc=0.9531 | L2-Norm=13.295 | L2-Norm(final)=16.724 | 4805.5 samples/s | 75.1 steps/s
[Step=38850 Epoch=76.0] | Loss=0.01987 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.313 | L2-Norm(final)=16.720 | 4816.7 samples/s | 75.3 steps/s
[Step=38900 Epoch=76.0] | Loss=0.01930 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.329 | L2-Norm(final)=16.717 | 4718.7 samples/s | 73.7 steps/s
[Step=38950 Epoch=76.1] | Loss=0.01929 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.345 | L2-Norm(final)=16.715 | 4786.9 samples/s | 74.8 steps/s
[Step=39000 Epoch=76.2] | Loss=0.01919 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=16.712 | 5920.5 samples/s | 92.5 steps/s
[Step=39050 Epoch=76.3] | Loss=0.01869 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=16.710 | 2097.5 samples/s | 32.8 steps/s
[Step=39100 Epoch=76.4] | Loss=0.01802 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.384 | L2-Norm(final)=16.708 | 4730.6 samples/s | 73.9 steps/s
[Step=39150 Epoch=76.5] | Loss=0.01764 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.395 | L2-Norm(final)=16.707 | 4764.2 samples/s | 74.4 steps/s
[Step=39200 Epoch=76.6] | Loss=0.01734 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.405 | L2-Norm(final)=16.706 | 4767.2 samples/s | 74.5 steps/s
[Step=39250 Epoch=76.7] | Loss=0.01718 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.415 | L2-Norm(final)=16.704 | 4795.0 samples/s | 74.9 steps/s
[Step=39300 Epoch=76.8] | Loss=0.01705 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.425 | L2-Norm(final)=16.703 | 4821.2 samples/s | 75.3 steps/s
[Step=39350 Epoch=76.9] | Loss=0.01694 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.434 | L2-Norm(final)=16.702 | 4763.8 samples/s | 74.4 steps/s
[Step=39400 Epoch=77.0] | Loss=0.01652 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.442 | L2-Norm(final)=16.702 | 4767.4 samples/s | 74.5 steps/s
[Step=39450 Epoch=77.1] | Loss=0.01651 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.451 | L2-Norm(final)=16.702 | 4780.9 samples/s | 74.7 steps/s
[Step=39500 Epoch=77.2] | Loss=0.01633 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.459 | L2-Norm(final)=16.701 | 5205.7 samples/s | 81.3 steps/s
[Step=39550 Epoch=77.3] | Loss=0.01609 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.467 | L2-Norm(final)=16.701 | 2194.8 samples/s | 34.3 steps/s
[Step=39600 Epoch=77.4] | Loss=0.01583 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.475 | L2-Norm(final)=16.701 | 4814.3 samples/s | 75.2 steps/s
[Step=39650 Epoch=77.5] | Loss=0.01554 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=16.701 | 4819.2 samples/s | 75.3 steps/s
[Step=39700 Epoch=77.6] | Loss=0.01538 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.489 | L2-Norm(final)=16.701 | 4703.9 samples/s | 73.5 steps/s
[Step=39750 Epoch=77.7] | Loss=0.01523 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.496 | L2-Norm(final)=16.701 | 4774.9 samples/s | 74.6 steps/s
[Step=39800 Epoch=77.8] | Loss=0.01512 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.503 | L2-Norm(final)=16.701 | 4817.6 samples/s | 75.3 steps/s
[Step=39850 Epoch=77.9] | Loss=0.01491 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.510 | L2-Norm(final)=16.700 | 4806.4 samples/s | 75.1 steps/s
[Step=39900 Epoch=78.0] | Loss=0.01483 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.516 | L2-Norm(final)=16.700 | 4737.8 samples/s | 74.0 steps/s
[Step=39950 Epoch=78.1] | Loss=0.01482 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.522 | L2-Norm(final)=16.699 | 4792.9 samples/s | 74.9 steps/s
[Step=40000 Epoch=78.2] | Loss=0.01459 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.529 | L2-Norm(final)=16.699 | 4758.5 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step40000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=38001 Epoch=145.6] | Loss=0.00062 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.063 | L2-Norm(final)=15.150 | 4332.9 samples/s | 67.7 steps/s
[Step=38050 Epoch=145.8] | Loss=0.00063 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=15.155 | 4561.2 samples/s | 71.3 steps/s
[Step=38100 Epoch=146.0] | Loss=0.00048 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.060 | L2-Norm(final)=15.161 | 5176.0 samples/s | 80.9 steps/s
[Step=38150 Epoch=146.2] | Loss=0.00040 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.060 | L2-Norm(final)=15.169 | 5214.2 samples/s | 81.5 steps/s
[Step=38200 Epoch=146.4] | Loss=0.00036 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.060 | L2-Norm(final)=15.177 | 5229.6 samples/s | 81.7 steps/s
[Step=38250 Epoch=146.6] | Loss=0.00041 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.060 | L2-Norm(final)=15.184 | 6860.1 samples/s | 107.2 steps/s
[Step=38300 Epoch=146.8] | Loss=0.00038 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.060 | L2-Norm(final)=15.192 | 2123.2 samples/s | 33.2 steps/s
[Step=38350 Epoch=146.9] | Loss=0.00039 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.060 | L2-Norm(final)=15.199 | 5377.7 samples/s | 84.0 steps/s
[Step=38400 Epoch=147.1] | Loss=0.00036 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.060 | L2-Norm(final)=15.207 | 5090.7 samples/s | 79.5 steps/s
[Step=38450 Epoch=147.3] | Loss=0.00037 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.060 | L2-Norm(final)=15.215 | 5161.1 samples/s | 80.6 steps/s
[Step=38500 Epoch=147.5] | Loss=0.00039 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.060 | L2-Norm(final)=15.222 | 5954.9 samples/s | 93.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=38501 Epoch=147.5] | Loss=0.00001 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.060 | L2-Norm(final)=15.292 | 4631.9 samples/s | 72.4 steps/s
[Step=38550 Epoch=147.7] | Loss=0.00020 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.059 | L2-Norm(final)=15.299 | 4075.6 samples/s | 63.7 steps/s
[Step=38600 Epoch=147.9] | Loss=0.00014 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.066 | L2-Norm(final)=15.303 | 4512.2 samples/s | 70.5 steps/s
[Step=38650 Epoch=148.1] | Loss=0.00010 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.060 | L2-Norm(final)=15.305 | 4547.2 samples/s | 71.1 steps/s
[Step=38700 Epoch=148.3] | Loss=0.00008 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.048 | L2-Norm(final)=15.307 | 4573.3 samples/s | 71.5 steps/s
[Step=38750 Epoch=148.5] | Loss=0.00006 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=15.308 | 5726.7 samples/s | 89.5 steps/s
[Step=38800 Epoch=148.7] | Loss=0.00005 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.019 | L2-Norm(final)=15.310 | 2012.6 samples/s | 31.4 steps/s
[Step=38850 Epoch=148.9] | Loss=0.00005 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.004 | L2-Norm(final)=15.311 | 4547.6 samples/s | 71.1 steps/s
[Step=38900 Epoch=149.1] | Loss=0.00004 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.990 | L2-Norm(final)=15.311 | 4633.2 samples/s | 72.4 steps/s
[Step=38950 Epoch=149.2] | Loss=0.00004 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.975 | L2-Norm(final)=15.312 | 4477.6 samples/s | 70.0 steps/s
[Step=39000 Epoch=149.4] | Loss=0.00003 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.960 | L2-Norm(final)=15.313 | 5043.6 samples/s | 78.8 steps/s
[Step=39050 Epoch=149.6] | Loss=0.00003 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.946 | L2-Norm(final)=15.314 | 2071.8 samples/s | 32.4 steps/s
[Step=39100 Epoch=149.8] | Loss=0.00003 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=15.316 | 4580.0 samples/s | 71.6 steps/s
[Step=39150 Epoch=150.0] | Loss=0.00003 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.917 | L2-Norm(final)=15.318 | 4548.9 samples/s | 71.1 steps/s
[Step=39200 Epoch=150.2] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.903 | L2-Norm(final)=15.320 | 4511.2 samples/s | 70.5 steps/s
[Step=39250 Epoch=150.4] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.888 | L2-Norm(final)=15.322 | 4564.9 samples/s | 71.3 steps/s
[Step=39300 Epoch=150.6] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.874 | L2-Norm(final)=15.324 | 2173.5 samples/s | 34.0 steps/s
[Step=39350 Epoch=150.8] | Loss=0.00002 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.860 | L2-Norm(final)=15.326 | 4649.8 samples/s | 72.7 steps/s
[Step=39400 Epoch=151.0] | Loss=0.00002 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.846 | L2-Norm(final)=15.328 | 4552.0 samples/s | 71.1 steps/s
[Step=39450 Epoch=151.2] | Loss=0.00002 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.831 | L2-Norm(final)=15.331 | 4519.5 samples/s | 70.6 steps/s
[Step=39500 Epoch=151.4] | Loss=0.00002 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.817 | L2-Norm(final)=15.333 | 4497.7 samples/s | 70.3 steps/s
[Step=39550 Epoch=151.5] | Loss=0.00002 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.803 | L2-Norm(final)=15.336 | 2181.7 samples/s | 34.1 steps/s
[Step=39600 Epoch=151.7] | Loss=0.00002 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=15.338 | 4526.7 samples/s | 70.7 steps/s
[Step=39650 Epoch=151.9] | Loss=0.00002 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=15.341 | 4533.0 samples/s | 70.8 steps/s
[Step=39700 Epoch=152.1] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.760 | L2-Norm(final)=15.344 | 4624.9 samples/s | 72.3 steps/s
[Step=39750 Epoch=152.3] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.746 | L2-Norm(final)=15.346 | 4478.1 samples/s | 70.0 steps/s
[Step=39800 Epoch=152.5] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.732 | L2-Norm(final)=15.349 | 6226.6 samples/s | 97.3 steps/s
[Step=39850 Epoch=152.7] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.717 | L2-Norm(final)=15.351 | 1952.6 samples/s | 30.5 steps/s
[Step=39900 Epoch=152.9] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.703 | L2-Norm(final)=15.354 | 4537.9 samples/s | 70.9 steps/s
[Step=39950 Epoch=153.1] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.688 | L2-Norm(final)=15.356 | 4562.9 samples/s | 71.3 steps/s
[Step=40000 Epoch=153.3] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.674 | L2-Norm(final)=15.358 | 4578.7 samples/s | 71.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step40000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=38001 Epoch=146.3] | Loss=0.00004 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.063 | L2-Norm(final)=16.498 | 4276.9 samples/s | 66.8 steps/s
[Step=38050 Epoch=146.5] | Loss=0.00039 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=16.503 | 5210.3 samples/s | 81.4 steps/s
[Step=38100 Epoch=146.7] | Loss=0.00029 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=16.509 | 5208.0 samples/s | 81.4 steps/s
[Step=38150 Epoch=146.9] | Loss=0.00033 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=16.513 | 5210.0 samples/s | 81.4 steps/s
[Step=38200 Epoch=147.0] | Loss=0.00033 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=16.518 | 5252.6 samples/s | 82.1 steps/s
[Step=38250 Epoch=147.2] | Loss=0.00040 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=16.523 | 6923.4 samples/s | 108.2 steps/s
[Step=38300 Epoch=147.4] | Loss=0.00040 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=16.528 | 2173.2 samples/s | 34.0 steps/s
[Step=38350 Epoch=147.6] | Loss=0.00040 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=16.534 | 4999.9 samples/s | 78.1 steps/s
[Step=38400 Epoch=147.8] | Loss=0.00040 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=16.539 | 5179.6 samples/s | 80.9 steps/s
[Step=38450 Epoch=148.0] | Loss=0.00039 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=16.544 | 5358.5 samples/s | 83.7 steps/s
[Step=38500 Epoch=148.2] | Loss=0.00041 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=16.550 | 5908.0 samples/s | 92.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=38501 Epoch=148.2] | Loss=0.00193 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=16.602 | 4707.9 samples/s | 73.6 steps/s
[Step=38550 Epoch=148.4] | Loss=0.00031 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.080 | L2-Norm(final)=16.607 | 4146.8 samples/s | 64.8 steps/s
[Step=38600 Epoch=148.6] | Loss=0.00019 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.088 | L2-Norm(final)=16.611 | 4596.8 samples/s | 71.8 steps/s
[Step=38650 Epoch=148.8] | Loss=0.00014 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.088 | L2-Norm(final)=16.613 | 4529.6 samples/s | 70.8 steps/s
[Step=38700 Epoch=149.0] | Loss=0.00011 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=16.615 | 4595.8 samples/s | 71.8 steps/s
[Step=38750 Epoch=149.2] | Loss=0.00009 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.072 | L2-Norm(final)=16.617 | 5741.1 samples/s | 89.7 steps/s
[Step=38800 Epoch=149.4] | Loss=0.00007 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.062 | L2-Norm(final)=16.618 | 2000.7 samples/s | 31.3 steps/s
[Step=38850 Epoch=149.5] | Loss=0.00006 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.051 | L2-Norm(final)=16.620 | 4515.8 samples/s | 70.6 steps/s
[Step=38900 Epoch=149.7] | Loss=0.00006 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.041 | L2-Norm(final)=16.621 | 4597.8 samples/s | 71.8 steps/s
[Step=38950 Epoch=149.9] | Loss=0.00005 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=16.621 | 4511.0 samples/s | 70.5 steps/s
[Step=39000 Epoch=150.1] | Loss=0.00005 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.019 | L2-Norm(final)=16.622 | 5132.4 samples/s | 80.2 steps/s
[Step=39050 Epoch=150.3] | Loss=0.00004 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.008 | L2-Norm(final)=16.623 | 2095.5 samples/s | 32.7 steps/s
[Step=39100 Epoch=150.5] | Loss=0.00004 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=16.624 | 4501.1 samples/s | 70.3 steps/s
[Step=39150 Epoch=150.7] | Loss=0.00004 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=16.624 | 4590.4 samples/s | 71.7 steps/s
[Step=39200 Epoch=150.9] | Loss=0.00003 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.976 | L2-Norm(final)=16.625 | 4621.5 samples/s | 72.2 steps/s
[Step=39250 Epoch=151.1] | Loss=0.00003 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.965 | L2-Norm(final)=16.626 | 4642.5 samples/s | 72.5 steps/s
[Step=39300 Epoch=151.3] | Loss=0.00003 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.954 | L2-Norm(final)=16.627 | 2176.6 samples/s | 34.0 steps/s
[Step=39350 Epoch=151.5] | Loss=0.00003 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.944 | L2-Norm(final)=16.627 | 4602.3 samples/s | 71.9 steps/s
[Step=39400 Epoch=151.7] | Loss=0.00003 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.933 | L2-Norm(final)=16.628 | 4500.2 samples/s | 70.3 steps/s
[Step=39450 Epoch=151.9] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.923 | L2-Norm(final)=16.629 | 4547.8 samples/s | 71.1 steps/s
[Step=39500 Epoch=152.1] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.912 | L2-Norm(final)=16.630 | 4515.5 samples/s | 70.6 steps/s
[Step=39550 Epoch=152.2] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=16.631 | 2208.4 samples/s | 34.5 steps/s
[Step=39600 Epoch=152.4] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=16.632 | 4566.9 samples/s | 71.4 steps/s
[Step=39650 Epoch=152.6] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.880 | L2-Norm(final)=16.632 | 4537.6 samples/s | 70.9 steps/s
[Step=39700 Epoch=152.8] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.869 | L2-Norm(final)=16.633 | 4536.7 samples/s | 70.9 steps/s
[Step=39750 Epoch=153.0] | Loss=0.00002 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.859 | L2-Norm(final)=16.634 | 4505.5 samples/s | 70.4 steps/s
[Step=39800 Epoch=153.2] | Loss=0.00002 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.848 | L2-Norm(final)=16.635 | 6755.3 samples/s | 105.6 steps/s
[Step=39850 Epoch=153.4] | Loss=0.00002 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.837 | L2-Norm(final)=16.636 | 1906.1 samples/s | 29.8 steps/s
[Step=39900 Epoch=153.6] | Loss=0.00002 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.827 | L2-Norm(final)=16.637 | 4587.3 samples/s | 71.7 steps/s
[Step=39950 Epoch=153.8] | Loss=0.00002 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.816 | L2-Norm(final)=16.638 | 4583.6 samples/s | 71.6 steps/s
[Step=40000 Epoch=154.0] | Loss=0.00002 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.805 | L2-Norm(final)=16.639 | 4565.1 samples/s | 71.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08096 | acc=0.9664 | tpr=0.9726 | fpr=0.0471 | 4094.2 samples/s | 16.0 steps/s
Avg test loss: 0.07784, Avg test acc: 0.96618, Avg tpr: 0.97284, Avg fpr: 0.04846, total FA: 378

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07960 | acc=0.9664 | tpr=0.9741 | fpr=0.0503 | 3921.7 samples/s | 15.3 steps/s
Avg test loss: 0.08076, Avg test acc: 0.96566, Avg tpr: 0.97336, Avg fpr: 0.05128, total FA: 400

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.26575 | acc=0.3049 | tpr=0.0066 | fpr=0.0473 | 4177.9 samples/s | 16.3 steps/s
Avg test loss: 7.27197, Avg test acc: 0.30083, Avg tpr: 0.00624, Avg fpr: 0.05128, total FA: 400

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.80932 | acc=0.2912 | tpr=0.0100 | fpr=0.0984 | 4212.9 samples/s | 16.5 steps/s
Avg test loss: 7.81011, Avg test acc: 0.28832, Avg tpr: 0.00968, Avg fpr: 0.09883, total FA: 771

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.14346 | acc=0.1296 | tpr=0.5265 | fpr=0.8775 | 4197.9 samples/s | 16.4 steps/s
[Step= 100] | Loss=7.07948 | acc=0.1305 | tpr=0.5139 | fpr=0.8766 | 7641.4 samples/s | 29.8 steps/s
[Step= 150] | Loss=7.07708 | acc=0.1309 | tpr=0.5130 | fpr=0.8761 | 7834.9 samples/s | 30.6 steps/s
[Step= 200] | Loss=7.06562 | acc=0.1301 | tpr=0.5104 | fpr=0.8768 | 7937.6 samples/s | 31.0 steps/s
[Step= 250] | Loss=7.06059 | acc=0.1300 | tpr=0.5013 | fpr=0.8767 | 8023.4 samples/s | 31.3 steps/s
[Step= 300] | Loss=7.06878 | acc=0.1295 | tpr=0.5018 | fpr=0.8773 | 7603.5 samples/s | 29.7 steps/s
[Step= 350] | Loss=7.07894 | acc=0.1291 | tpr=0.4947 | fpr=0.8775 | 8091.1 samples/s | 31.6 steps/s
[Step= 400] | Loss=7.07066 | acc=0.1286 | tpr=0.4852 | fpr=0.8779 | 7745.5 samples/s | 30.3 steps/s
[Step= 450] | Loss=7.07267 | acc=0.1285 | tpr=0.4859 | fpr=0.8780 | 7790.7 samples/s | 30.4 steps/s
[Step= 500] | Loss=7.07651 | acc=0.1284 | tpr=0.4859 | fpr=0.8781 | 7880.4 samples/s | 30.8 steps/s
[Step= 550] | Loss=7.08028 | acc=0.1286 | tpr=0.4863 | fpr=0.8779 | 14918.5 samples/s | 58.3 steps/s
Avg test loss: 7.08220, Avg test acc: 0.12850, Avg tpr: 0.48613, Avg fpr: 0.87800, total FA: 121908

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.60337 | acc=0.1351 | tpr=0.5708 | fpr=0.8728 | 4220.7 samples/s | 16.5 steps/s
[Step= 100] | Loss=6.53730 | acc=0.1358 | tpr=0.5906 | fpr=0.8727 | 7891.7 samples/s | 30.8 steps/s
[Step= 150] | Loss=6.55263 | acc=0.1351 | tpr=0.5850 | fpr=0.8732 | 8051.3 samples/s | 31.5 steps/s
[Step= 200] | Loss=6.54735 | acc=0.1350 | tpr=0.5770 | fpr=0.8730 | 7780.2 samples/s | 30.4 steps/s
[Step= 250] | Loss=6.54413 | acc=0.1350 | tpr=0.5755 | fpr=0.8730 | 7774.2 samples/s | 30.4 steps/s
[Step= 300] | Loss=6.54992 | acc=0.1349 | tpr=0.5738 | fpr=0.8731 | 7318.6 samples/s | 28.6 steps/s
[Step= 350] | Loss=6.55672 | acc=0.1346 | tpr=0.5755 | fpr=0.8734 | 7324.5 samples/s | 28.6 steps/s
[Step= 400] | Loss=6.54500 | acc=0.1343 | tpr=0.5662 | fpr=0.8736 | 7285.9 samples/s | 28.5 steps/s
[Step= 450] | Loss=6.54806 | acc=0.1339 | tpr=0.5682 | fpr=0.8740 | 7710.9 samples/s | 30.1 steps/s
[Step= 500] | Loss=6.54961 | acc=0.1338 | tpr=0.5714 | fpr=0.8742 | 8034.9 samples/s | 31.4 steps/s
[Step= 550] | Loss=6.55145 | acc=0.1341 | tpr=0.5730 | fpr=0.8739 | 13681.4 samples/s | 53.4 steps/s
Avg test loss: 6.55139, Avg test acc: 0.13398, Avg tpr: 0.57290, Avg fpr: 0.87400, total FA: 121353

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13716 | acc=0.9799 | tpr=0.9204 | fpr=0.0190 | 4174.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.14762 | acc=0.9784 | tpr=0.9382 | fpr=0.0209 | 7836.4 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.14913 | acc=0.9782 | tpr=0.9452 | fpr=0.0212 | 7636.8 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.15117 | acc=0.9783 | tpr=0.9497 | fpr=0.0211 | 7897.5 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.15012 | acc=0.9784 | tpr=0.9511 | fpr=0.0211 | 8110.5 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.15326 | acc=0.9781 | tpr=0.9527 | fpr=0.0214 | 7650.4 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.15339 | acc=0.9782 | tpr=0.9518 | fpr=0.0213 | 7873.9 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.15454 | acc=0.9780 | tpr=0.9508 | fpr=0.0215 | 7805.7 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.15626 | acc=0.9778 | tpr=0.9484 | fpr=0.0217 | 7832.9 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.15510 | acc=0.9780 | tpr=0.9489 | fpr=0.0214 | 7823.9 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.15369 | acc=0.9783 | tpr=0.9491 | fpr=0.0211 | 14976.1 samples/s | 58.5 steps/s
Avg test loss: 0.15336, Avg test acc: 0.97837, Avg tpr: 0.94929, Avg fpr: 0.02110, total FA: 2930

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14820 | acc=0.9786 | tpr=0.9292 | fpr=0.0205 | 4155.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.16096 | acc=0.9771 | tpr=0.9382 | fpr=0.0222 | 7884.4 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.16334 | acc=0.9768 | tpr=0.9481 | fpr=0.0226 | 7955.4 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.16507 | acc=0.9771 | tpr=0.9519 | fpr=0.0224 | 7832.0 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.16388 | acc=0.9771 | tpr=0.9546 | fpr=0.0225 | 7946.1 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.16746 | acc=0.9770 | tpr=0.9571 | fpr=0.0227 | 7867.4 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.16826 | acc=0.9770 | tpr=0.9555 | fpr=0.0226 | 7834.2 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.17013 | acc=0.9767 | tpr=0.9557 | fpr=0.0229 | 7677.1 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.17220 | acc=0.9764 | tpr=0.9533 | fpr=0.0231 | 8062.6 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.17075 | acc=0.9766 | tpr=0.9551 | fpr=0.0230 | 7849.3 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.16952 | acc=0.9768 | tpr=0.9558 | fpr=0.0228 | 14223.7 samples/s | 55.6 steps/s
Avg test loss: 0.16918, Avg test acc: 0.97687, Avg tpr: 0.95602, Avg fpr: 0.02275, total FA: 3159

server round 20/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=40001 Epoch=78.0] | Loss=0.01036 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.857 | L2-Norm(final)=16.289 | 4195.6 samples/s | 65.6 steps/s
[Step=40050 Epoch=78.1] | Loss=0.01227 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.858 | L2-Norm(final)=16.290 | 5303.4 samples/s | 82.9 steps/s
[Step=40100 Epoch=78.2] | Loss=0.01213 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.859 | L2-Norm(final)=16.293 | 5497.4 samples/s | 85.9 steps/s
[Step=40150 Epoch=78.3] | Loss=0.01175 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.859 | L2-Norm(final)=16.296 | 5539.7 samples/s | 86.6 steps/s
[Step=40200 Epoch=78.4] | Loss=0.01249 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.859 | L2-Norm(final)=16.298 | 5611.2 samples/s | 87.7 steps/s
[Step=40250 Epoch=78.5] | Loss=0.01271 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.859 | L2-Norm(final)=16.299 | 5512.3 samples/s | 86.1 steps/s
[Step=40300 Epoch=78.6] | Loss=0.01224 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.859 | L2-Norm(final)=16.301 | 5473.4 samples/s | 85.5 steps/s
[Step=40350 Epoch=78.7] | Loss=0.01234 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.859 | L2-Norm(final)=16.303 | 5612.3 samples/s | 87.7 steps/s
[Step=40400 Epoch=78.8] | Loss=0.01243 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.859 | L2-Norm(final)=16.305 | 5441.1 samples/s | 85.0 steps/s
[Step=40450 Epoch=78.9] | Loss=0.01222 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.859 | L2-Norm(final)=16.307 | 5567.9 samples/s | 87.0 steps/s
[Step=40500 Epoch=79.0] | Loss=0.01245 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.859 | L2-Norm(final)=16.310 | 6962.3 samples/s | 108.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=40501 Epoch=79.0] | Loss=0.00142 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.859 | L2-Norm(final)=16.340 | 4357.9 samples/s | 68.1 steps/s
[Step=40550 Epoch=79.1] | Loss=0.00981 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.868 | L2-Norm(final)=16.340 | 4369.7 samples/s | 68.3 steps/s
[Step=40600 Epoch=79.2] | Loss=0.01134 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.877 | L2-Norm(final)=16.341 | 4765.2 samples/s | 74.5 steps/s
[Step=40650 Epoch=79.3] | Loss=0.00999 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.883 | L2-Norm(final)=16.343 | 4828.2 samples/s | 75.4 steps/s
[Step=40700 Epoch=79.4] | Loss=0.00985 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.888 | L2-Norm(final)=16.344 | 4806.2 samples/s | 75.1 steps/s
[Step=40750 Epoch=79.5] | Loss=0.00983 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.893 | L2-Norm(final)=16.345 | 4770.4 samples/s | 74.5 steps/s
[Step=40800 Epoch=79.6] | Loss=0.01025 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.899 | L2-Norm(final)=16.346 | 4836.0 samples/s | 75.6 steps/s
[Step=40850 Epoch=79.7] | Loss=0.01017 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=16.347 | 4750.4 samples/s | 74.2 steps/s
[Step=40900 Epoch=79.8] | Loss=0.01041 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.908 | L2-Norm(final)=16.347 | 4804.6 samples/s | 75.1 steps/s
[Step=40950 Epoch=79.9] | Loss=0.01034 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.912 | L2-Norm(final)=16.348 | 4821.5 samples/s | 75.3 steps/s
[Step=41000 Epoch=80.0] | Loss=0.01039 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.917 | L2-Norm(final)=16.349 | 5752.1 samples/s | 89.9 steps/s
[Step=41050 Epoch=80.1] | Loss=0.01019 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.920 | L2-Norm(final)=16.350 | 2042.2 samples/s | 31.9 steps/s
[Step=41100 Epoch=80.2] | Loss=0.00992 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.924 | L2-Norm(final)=16.351 | 4794.2 samples/s | 74.9 steps/s
[Step=41150 Epoch=80.3] | Loss=0.00956 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.927 | L2-Norm(final)=16.352 | 4826.7 samples/s | 75.4 steps/s
[Step=41200 Epoch=80.4] | Loss=0.00936 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.930 | L2-Norm(final)=16.353 | 4760.7 samples/s | 74.4 steps/s
[Step=41250 Epoch=80.5] | Loss=0.00937 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.933 | L2-Norm(final)=16.354 | 4738.3 samples/s | 74.0 steps/s
[Step=41300 Epoch=80.6] | Loss=0.00928 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.936 | L2-Norm(final)=16.355 | 4746.4 samples/s | 74.2 steps/s
[Step=41350 Epoch=80.6] | Loss=0.00926 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.939 | L2-Norm(final)=16.356 | 4835.5 samples/s | 75.6 steps/s
[Step=41400 Epoch=80.7] | Loss=0.00917 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.941 | L2-Norm(final)=16.357 | 4752.5 samples/s | 74.3 steps/s
[Step=41450 Epoch=80.8] | Loss=0.00910 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.943 | L2-Norm(final)=16.358 | 4810.9 samples/s | 75.2 steps/s
[Step=41500 Epoch=80.9] | Loss=0.00899 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.945 | L2-Norm(final)=16.359 | 5064.8 samples/s | 79.1 steps/s
[Step=41550 Epoch=81.0] | Loss=0.00891 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=16.360 | 2161.1 samples/s | 33.8 steps/s
[Step=41600 Epoch=81.1] | Loss=0.00889 | Reg=0.00168 | acc=0.9688 | L2-Norm=12.950 | L2-Norm(final)=16.361 | 4907.0 samples/s | 76.7 steps/s
[Step=41650 Epoch=81.2] | Loss=0.00886 | Reg=0.00168 | acc=0.9688 | L2-Norm=12.952 | L2-Norm(final)=16.361 | 4843.7 samples/s | 75.7 steps/s
[Step=41700 Epoch=81.3] | Loss=0.00875 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.954 | L2-Norm(final)=16.362 | 4741.2 samples/s | 74.1 steps/s
[Step=41750 Epoch=81.4] | Loss=0.00863 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.957 | L2-Norm(final)=16.363 | 4801.9 samples/s | 75.0 steps/s
[Step=41800 Epoch=81.5] | Loss=0.00858 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.959 | L2-Norm(final)=16.364 | 4829.4 samples/s | 75.5 steps/s
[Step=41850 Epoch=81.6] | Loss=0.00852 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=16.365 | 4861.2 samples/s | 76.0 steps/s
[Step=41900 Epoch=81.7] | Loss=0.00850 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.962 | L2-Norm(final)=16.365 | 4772.1 samples/s | 74.6 steps/s
[Step=41950 Epoch=81.8] | Loss=0.00840 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=16.366 | 4794.7 samples/s | 74.9 steps/s
[Step=42000 Epoch=81.9] | Loss=0.00836 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.966 | L2-Norm(final)=16.367 | 4830.1 samples/s | 75.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step42000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=40001 Epoch=78.2] | Loss=0.01375 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.857 | L2-Norm(final)=16.692 | 4253.8 samples/s | 66.5 steps/s
[Step=40050 Epoch=78.3] | Loss=0.01029 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.859 | L2-Norm(final)=16.695 | 4976.4 samples/s | 77.8 steps/s
[Step=40100 Epoch=78.4] | Loss=0.01017 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.859 | L2-Norm(final)=16.698 | 5145.8 samples/s | 80.4 steps/s
[Step=40150 Epoch=78.5] | Loss=0.01081 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.859 | L2-Norm(final)=16.701 | 5586.3 samples/s | 87.3 steps/s
[Step=40200 Epoch=78.6] | Loss=0.01122 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.859 | L2-Norm(final)=16.704 | 5385.8 samples/s | 84.2 steps/s
[Step=40250 Epoch=78.7] | Loss=0.01110 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.859 | L2-Norm(final)=16.706 | 5482.4 samples/s | 85.7 steps/s
[Step=40300 Epoch=78.8] | Loss=0.01107 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.859 | L2-Norm(final)=16.709 | 5617.9 samples/s | 87.8 steps/s
[Step=40350 Epoch=78.9] | Loss=0.01109 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.859 | L2-Norm(final)=16.711 | 5567.7 samples/s | 87.0 steps/s
[Step=40400 Epoch=79.0] | Loss=0.01102 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.859 | L2-Norm(final)=16.714 | 5552.8 samples/s | 86.8 steps/s
[Step=40450 Epoch=79.1] | Loss=0.01122 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.859 | L2-Norm(final)=16.716 | 5381.7 samples/s | 84.1 steps/s
[Step=40500 Epoch=79.2] | Loss=0.01100 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.859 | L2-Norm(final)=16.719 | 7108.9 samples/s | 111.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=40501 Epoch=79.2] | Loss=0.00495 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.859 | L2-Norm(final)=16.747 | 4530.1 samples/s | 70.8 steps/s
[Step=40550 Epoch=79.3] | Loss=0.01090 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.875 | L2-Norm(final)=16.749 | 4644.3 samples/s | 72.6 steps/s
[Step=40600 Epoch=79.4] | Loss=0.01133 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.887 | L2-Norm(final)=16.749 | 4750.3 samples/s | 74.2 steps/s
[Step=40650 Epoch=79.5] | Loss=0.01013 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.896 | L2-Norm(final)=16.748 | 4780.5 samples/s | 74.7 steps/s
[Step=40700 Epoch=79.6] | Loss=0.01010 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.903 | L2-Norm(final)=16.748 | 4843.4 samples/s | 75.7 steps/s
[Step=40750 Epoch=79.7] | Loss=0.01012 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.909 | L2-Norm(final)=16.747 | 4821.9 samples/s | 75.3 steps/s
[Step=40800 Epoch=79.8] | Loss=0.00998 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=16.747 | 4743.1 samples/s | 74.1 steps/s
[Step=40850 Epoch=79.9] | Loss=0.00984 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.918 | L2-Norm(final)=16.747 | 4812.4 samples/s | 75.2 steps/s
[Step=40900 Epoch=80.0] | Loss=0.01001 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.922 | L2-Norm(final)=16.747 | 4756.5 samples/s | 74.3 steps/s
[Step=40950 Epoch=80.1] | Loss=0.00996 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.925 | L2-Norm(final)=16.747 | 4831.9 samples/s | 75.5 steps/s
[Step=41000 Epoch=80.2] | Loss=0.00991 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.928 | L2-Norm(final)=16.747 | 5877.1 samples/s | 91.8 steps/s
[Step=41050 Epoch=80.3] | Loss=0.00970 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.930 | L2-Norm(final)=16.747 | 1978.2 samples/s | 30.9 steps/s
[Step=41100 Epoch=80.3] | Loss=0.00950 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.932 | L2-Norm(final)=16.747 | 4630.4 samples/s | 72.4 steps/s
[Step=41150 Epoch=80.4] | Loss=0.00923 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.934 | L2-Norm(final)=16.748 | 4522.1 samples/s | 70.7 steps/s
[Step=41200 Epoch=80.5] | Loss=0.00910 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.936 | L2-Norm(final)=16.748 | 4708.4 samples/s | 73.6 steps/s
[Step=41250 Epoch=80.6] | Loss=0.00909 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.938 | L2-Norm(final)=16.749 | 4781.9 samples/s | 74.7 steps/s
[Step=41300 Epoch=80.7] | Loss=0.00890 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=16.749 | 4819.0 samples/s | 75.3 steps/s
[Step=41350 Epoch=80.8] | Loss=0.00879 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.942 | L2-Norm(final)=16.750 | 4721.4 samples/s | 73.8 steps/s
[Step=41400 Epoch=80.9] | Loss=0.00871 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.944 | L2-Norm(final)=16.750 | 4778.8 samples/s | 74.7 steps/s
[Step=41450 Epoch=81.0] | Loss=0.00864 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.946 | L2-Norm(final)=16.751 | 4841.0 samples/s | 75.6 steps/s
[Step=41500 Epoch=81.1] | Loss=0.00860 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=16.751 | 5120.0 samples/s | 80.0 steps/s
[Step=41550 Epoch=81.2] | Loss=0.00860 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.950 | L2-Norm(final)=16.752 | 2180.0 samples/s | 34.1 steps/s
[Step=41600 Epoch=81.3] | Loss=0.00845 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.951 | L2-Norm(final)=16.752 | 4818.0 samples/s | 75.3 steps/s
[Step=41650 Epoch=81.4] | Loss=0.00842 | Reg=0.00168 | acc=0.9688 | L2-Norm=12.953 | L2-Norm(final)=16.752 | 4783.1 samples/s | 74.7 steps/s
[Step=41700 Epoch=81.5] | Loss=0.00832 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.955 | L2-Norm(final)=16.753 | 4766.7 samples/s | 74.5 steps/s
[Step=41750 Epoch=81.6] | Loss=0.00833 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.956 | L2-Norm(final)=16.753 | 4714.2 samples/s | 73.7 steps/s
[Step=41800 Epoch=81.7] | Loss=0.00830 | Reg=0.00168 | acc=0.9688 | L2-Norm=12.958 | L2-Norm(final)=16.753 | 4783.7 samples/s | 74.7 steps/s
[Step=41850 Epoch=81.8] | Loss=0.00824 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.960 | L2-Norm(final)=16.753 | 4847.9 samples/s | 75.7 steps/s
[Step=41900 Epoch=81.9] | Loss=0.00817 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=16.754 | 4760.5 samples/s | 74.4 steps/s
[Step=41950 Epoch=82.0] | Loss=0.00816 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.963 | L2-Norm(final)=16.754 | 4789.6 samples/s | 74.8 steps/s
[Step=42000 Epoch=82.1] | Loss=0.00813 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.964 | L2-Norm(final)=16.754 | 4831.0 samples/s | 75.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step42000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=40001 Epoch=153.3] | Loss=0.00092 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.857 | L2-Norm(final)=15.422 | 4376.3 samples/s | 68.4 steps/s
[Step=40050 Epoch=153.5] | Loss=0.00048 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=15.426 | 5027.4 samples/s | 78.6 steps/s
[Step=40100 Epoch=153.6] | Loss=0.00035 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.854 | L2-Norm(final)=15.432 | 5113.1 samples/s | 79.9 steps/s
[Step=40150 Epoch=153.8] | Loss=0.00046 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.854 | L2-Norm(final)=15.438 | 4860.6 samples/s | 75.9 steps/s
[Step=40200 Epoch=154.0] | Loss=0.00042 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.854 | L2-Norm(final)=15.442 | 5068.6 samples/s | 79.2 steps/s
[Step=40250 Epoch=154.2] | Loss=0.00045 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.854 | L2-Norm(final)=15.447 | 6652.3 samples/s | 103.9 steps/s
[Step=40300 Epoch=154.4] | Loss=0.00052 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.854 | L2-Norm(final)=15.451 | 2177.0 samples/s | 34.0 steps/s
[Step=40350 Epoch=154.6] | Loss=0.00049 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.854 | L2-Norm(final)=15.455 | 5134.3 samples/s | 80.2 steps/s
[Step=40400 Epoch=154.8] | Loss=0.00045 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.854 | L2-Norm(final)=15.460 | 5020.3 samples/s | 78.4 steps/s
[Step=40450 Epoch=155.0] | Loss=0.00042 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.854 | L2-Norm(final)=15.464 | 5360.8 samples/s | 83.8 steps/s
[Step=40500 Epoch=155.2] | Loss=0.00040 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.854 | L2-Norm(final)=15.469 | 5801.5 samples/s | 90.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=40501 Epoch=155.2] | Loss=0.00018 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.854 | L2-Norm(final)=15.513 | 4963.2 samples/s | 77.5 steps/s
[Step=40550 Epoch=155.4] | Loss=0.00187 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.861 | L2-Norm(final)=15.514 | 3990.8 samples/s | 62.4 steps/s
[Step=40600 Epoch=155.6] | Loss=0.00120 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.887 | L2-Norm(final)=15.516 | 4564.1 samples/s | 71.3 steps/s
[Step=40650 Epoch=155.8] | Loss=0.00097 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=15.518 | 4585.9 samples/s | 71.7 steps/s
[Step=40700 Epoch=155.9] | Loss=0.00078 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=15.520 | 4574.8 samples/s | 71.5 steps/s
[Step=40750 Epoch=156.1] | Loss=0.00064 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.910 | L2-Norm(final)=15.521 | 5751.9 samples/s | 89.9 steps/s
[Step=40800 Epoch=156.3] | Loss=0.00054 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.912 | L2-Norm(final)=15.523 | 2012.5 samples/s | 31.4 steps/s
[Step=40850 Epoch=156.5] | Loss=0.00047 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=15.525 | 4549.0 samples/s | 71.1 steps/s
[Step=40900 Epoch=156.7] | Loss=0.00041 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.910 | L2-Norm(final)=15.526 | 4600.8 samples/s | 71.9 steps/s
[Step=40950 Epoch=156.9] | Loss=0.00036 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=15.527 | 4492.8 samples/s | 70.2 steps/s
[Step=41000 Epoch=157.1] | Loss=0.00033 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=15.528 | 4997.8 samples/s | 78.1 steps/s
[Step=41050 Epoch=157.3] | Loss=0.00030 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=15.529 | 2110.4 samples/s | 33.0 steps/s
[Step=41100 Epoch=157.5] | Loss=0.00027 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.897 | L2-Norm(final)=15.529 | 4601.8 samples/s | 71.9 steps/s
[Step=41150 Epoch=157.7] | Loss=0.00025 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.893 | L2-Norm(final)=15.530 | 4528.2 samples/s | 70.8 steps/s
[Step=41200 Epoch=157.9] | Loss=0.00023 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.888 | L2-Norm(final)=15.531 | 4585.2 samples/s | 71.6 steps/s
[Step=41250 Epoch=158.1] | Loss=0.00022 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.884 | L2-Norm(final)=15.531 | 4554.5 samples/s | 71.2 steps/s
[Step=41300 Epoch=158.2] | Loss=0.00021 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.879 | L2-Norm(final)=15.531 | 2185.7 samples/s | 34.2 steps/s
[Step=41350 Epoch=158.4] | Loss=0.00019 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.874 | L2-Norm(final)=15.532 | 4656.2 samples/s | 72.8 steps/s
[Step=41400 Epoch=158.6] | Loss=0.00018 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.869 | L2-Norm(final)=15.532 | 4516.9 samples/s | 70.6 steps/s
[Step=41450 Epoch=158.8] | Loss=0.00017 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.864 | L2-Norm(final)=15.533 | 4600.4 samples/s | 71.9 steps/s
[Step=41500 Epoch=159.0] | Loss=0.00017 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.859 | L2-Norm(final)=15.533 | 4569.5 samples/s | 71.4 steps/s
[Step=41550 Epoch=159.2] | Loss=0.00016 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.854 | L2-Norm(final)=15.533 | 2221.7 samples/s | 34.7 steps/s
[Step=41600 Epoch=159.4] | Loss=0.00015 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.849 | L2-Norm(final)=15.533 | 4493.6 samples/s | 70.2 steps/s
[Step=41650 Epoch=159.6] | Loss=0.00014 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.843 | L2-Norm(final)=15.534 | 4593.3 samples/s | 71.8 steps/s
[Step=41700 Epoch=159.8] | Loss=0.00014 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.838 | L2-Norm(final)=15.534 | 4521.7 samples/s | 70.7 steps/s
[Step=41750 Epoch=160.0] | Loss=0.00013 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.832 | L2-Norm(final)=15.534 | 4525.6 samples/s | 70.7 steps/s
[Step=41800 Epoch=160.2] | Loss=0.00013 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.827 | L2-Norm(final)=15.535 | 6199.2 samples/s | 96.9 steps/s
[Step=41850 Epoch=160.4] | Loss=0.00012 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.821 | L2-Norm(final)=15.535 | 1965.6 samples/s | 30.7 steps/s
[Step=41900 Epoch=160.5] | Loss=0.00012 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.815 | L2-Norm(final)=15.535 | 4480.4 samples/s | 70.0 steps/s
[Step=41950 Epoch=160.7] | Loss=0.00011 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.809 | L2-Norm(final)=15.535 | 4541.5 samples/s | 71.0 steps/s
[Step=42000 Epoch=160.9] | Loss=0.00011 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.804 | L2-Norm(final)=15.536 | 4569.9 samples/s | 71.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step42000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=40001 Epoch=154.0] | Loss=0.00834 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.857 | L2-Norm(final)=16.664 | 4607.4 samples/s | 72.0 steps/s
[Step=40050 Epoch=154.2] | Loss=0.00092 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.856 | L2-Norm(final)=16.666 | 4735.7 samples/s | 74.0 steps/s
[Step=40100 Epoch=154.4] | Loss=0.00077 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=16.670 | 5207.6 samples/s | 81.4 steps/s
[Step=40150 Epoch=154.6] | Loss=0.00057 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=16.674 | 5151.9 samples/s | 80.5 steps/s
[Step=40200 Epoch=154.7] | Loss=0.00054 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=16.678 | 5275.7 samples/s | 82.4 steps/s
[Step=40250 Epoch=154.9] | Loss=0.00059 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=16.682 | 6930.1 samples/s | 108.3 steps/s
[Step=40300 Epoch=155.1] | Loss=0.00062 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=16.685 | 2097.0 samples/s | 32.8 steps/s
[Step=40350 Epoch=155.3] | Loss=0.00063 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=16.688 | 5163.9 samples/s | 80.7 steps/s
[Step=40400 Epoch=155.5] | Loss=0.00060 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=16.691 | 5256.9 samples/s | 82.1 steps/s
[Step=40450 Epoch=155.7] | Loss=0.00063 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=16.695 | 5214.2 samples/s | 81.5 steps/s
[Step=40500 Epoch=155.9] | Loss=0.00066 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=16.698 | 5977.0 samples/s | 93.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=40501 Epoch=155.9] | Loss=0.00003 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=16.732 | 4697.9 samples/s | 73.4 steps/s
[Step=40550 Epoch=156.1] | Loss=0.00154 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.860 | L2-Norm(final)=16.735 | 4209.5 samples/s | 65.8 steps/s
[Step=40600 Epoch=156.3] | Loss=0.00187 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.876 | L2-Norm(final)=16.735 | 4487.4 samples/s | 70.1 steps/s
[Step=40650 Epoch=156.5] | Loss=0.00134 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.888 | L2-Norm(final)=16.733 | 4634.9 samples/s | 72.4 steps/s
[Step=40700 Epoch=156.7] | Loss=0.00113 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.894 | L2-Norm(final)=16.733 | 4506.5 samples/s | 70.4 steps/s
[Step=40750 Epoch=156.9] | Loss=0.00096 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.898 | L2-Norm(final)=16.732 | 5709.7 samples/s | 89.2 steps/s
[Step=40800 Epoch=157.1] | Loss=0.00080 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=16.732 | 1985.3 samples/s | 31.0 steps/s
[Step=40850 Epoch=157.2] | Loss=0.00069 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.902 | L2-Norm(final)=16.732 | 4537.8 samples/s | 70.9 steps/s
[Step=40900 Epoch=157.4] | Loss=0.00060 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.902 | L2-Norm(final)=16.732 | 4528.3 samples/s | 70.8 steps/s
[Step=40950 Epoch=157.6] | Loss=0.00054 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=16.732 | 4578.5 samples/s | 71.5 steps/s
[Step=41000 Epoch=157.8] | Loss=0.00048 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.899 | L2-Norm(final)=16.732 | 5097.3 samples/s | 79.6 steps/s
[Step=41050 Epoch=158.0] | Loss=0.00044 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.897 | L2-Norm(final)=16.732 | 2093.4 samples/s | 32.7 steps/s
[Step=41100 Epoch=158.2] | Loss=0.00040 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.894 | L2-Norm(final)=16.733 | 4537.5 samples/s | 70.9 steps/s
[Step=41150 Epoch=158.4] | Loss=0.00037 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.892 | L2-Norm(final)=16.733 | 4544.2 samples/s | 71.0 steps/s
[Step=41200 Epoch=158.6] | Loss=0.00035 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.889 | L2-Norm(final)=16.733 | 4575.6 samples/s | 71.5 steps/s
[Step=41250 Epoch=158.8] | Loss=0.00032 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=16.733 | 4661.2 samples/s | 72.8 steps/s
[Step=41300 Epoch=159.0] | Loss=0.00030 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.883 | L2-Norm(final)=16.733 | 2171.1 samples/s | 33.9 steps/s
[Step=41350 Epoch=159.2] | Loss=0.00029 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.880 | L2-Norm(final)=16.733 | 4567.2 samples/s | 71.4 steps/s
[Step=41400 Epoch=159.4] | Loss=0.00027 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.876 | L2-Norm(final)=16.734 | 4580.8 samples/s | 71.6 steps/s
[Step=41450 Epoch=159.6] | Loss=0.00026 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.873 | L2-Norm(final)=16.734 | 4550.5 samples/s | 71.1 steps/s
[Step=41500 Epoch=159.7] | Loss=0.00024 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.869 | L2-Norm(final)=16.734 | 4557.3 samples/s | 71.2 steps/s
[Step=41550 Epoch=159.9] | Loss=0.00023 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.866 | L2-Norm(final)=16.734 | 2167.0 samples/s | 33.9 steps/s
[Step=41600 Epoch=160.1] | Loss=0.00022 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.862 | L2-Norm(final)=16.734 | 4692.9 samples/s | 73.3 steps/s
[Step=41650 Epoch=160.3] | Loss=0.00021 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.858 | L2-Norm(final)=16.735 | 4486.6 samples/s | 70.1 steps/s
[Step=41700 Epoch=160.5] | Loss=0.00020 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.854 | L2-Norm(final)=16.735 | 4576.2 samples/s | 71.5 steps/s
[Step=41750 Epoch=160.7] | Loss=0.00020 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.850 | L2-Norm(final)=16.735 | 4497.7 samples/s | 70.3 steps/s
[Step=41800 Epoch=160.9] | Loss=0.00019 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.846 | L2-Norm(final)=16.735 | 6702.6 samples/s | 104.7 steps/s
[Step=41850 Epoch=161.1] | Loss=0.00018 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.842 | L2-Norm(final)=16.735 | 1913.4 samples/s | 29.9 steps/s
[Step=41900 Epoch=161.3] | Loss=0.00018 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.838 | L2-Norm(final)=16.735 | 4583.7 samples/s | 71.6 steps/s
[Step=41950 Epoch=161.5] | Loss=0.00017 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.834 | L2-Norm(final)=16.736 | 4498.0 samples/s | 70.3 steps/s
[Step=42000 Epoch=161.7] | Loss=0.00016 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.830 | L2-Norm(final)=16.736 | 4539.8 samples/s | 70.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step42000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08195 | acc=0.9695 | tpr=0.9784 | fpr=0.0498 | 4190.2 samples/s | 16.4 steps/s
Avg test loss: 0.07965, Avg test acc: 0.96903, Avg tpr: 0.97855, Avg fpr: 0.05192, total FA: 405

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07011 | acc=0.9707 | tpr=0.9758 | fpr=0.0404 | 4160.4 samples/s | 16.3 steps/s
Avg test loss: 0.07191, Avg test acc: 0.96927, Avg tpr: 0.97482, Avg fpr: 0.04294, total FA: 335

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=8.14122 | acc=0.3022 | tpr=0.0080 | fpr=0.0590 | 4295.5 samples/s | 16.8 steps/s
Avg test loss: 8.15435, Avg test acc: 0.29850, Avg tpr: 0.00769, Avg fpr: 0.06192, total FA: 483

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.32805 | acc=0.2866 | tpr=0.0131 | fpr=0.1194 | 4159.4 samples/s | 16.2 steps/s
Avg test loss: 7.32667, Avg test acc: 0.28464, Avg tpr: 0.01341, Avg fpr: 0.11883, total FA: 927

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.53422 | acc=0.1241 | tpr=0.4779 | fpr=0.8823 | 4364.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=7.46452 | acc=0.1253 | tpr=0.4904 | fpr=0.8815 | 7324.6 samples/s | 28.6 steps/s
[Step= 150] | Loss=7.47040 | acc=0.1247 | tpr=0.4899 | fpr=0.8820 | 7732.6 samples/s | 30.2 steps/s
[Step= 200] | Loss=7.46428 | acc=0.1250 | tpr=0.4885 | fpr=0.8816 | 7832.3 samples/s | 30.6 steps/s
[Step= 250] | Loss=7.45782 | acc=0.1247 | tpr=0.4812 | fpr=0.8818 | 7786.1 samples/s | 30.4 steps/s
[Step= 300] | Loss=7.46566 | acc=0.1240 | tpr=0.4771 | fpr=0.8824 | 7936.4 samples/s | 31.0 steps/s
[Step= 350] | Loss=7.47643 | acc=0.1234 | tpr=0.4759 | fpr=0.8830 | 7924.8 samples/s | 31.0 steps/s
[Step= 400] | Loss=7.46438 | acc=0.1232 | tpr=0.4672 | fpr=0.8830 | 7794.5 samples/s | 30.4 steps/s
[Step= 450] | Loss=7.46744 | acc=0.1227 | tpr=0.4688 | fpr=0.8836 | 7800.7 samples/s | 30.5 steps/s
[Step= 500] | Loss=7.46992 | acc=0.1227 | tpr=0.4714 | fpr=0.8836 | 8180.0 samples/s | 32.0 steps/s
[Step= 550] | Loss=7.47235 | acc=0.1228 | tpr=0.4715 | fpr=0.8836 | 13544.4 samples/s | 52.9 steps/s
Avg test loss: 7.47345, Avg test acc: 0.12268, Avg tpr: 0.47147, Avg fpr: 0.88366, total FA: 122694

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.21562 | acc=0.1508 | tpr=0.4469 | fpr=0.8545 | 4173.9 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.15374 | acc=0.1500 | tpr=0.4392 | fpr=0.8554 | 7701.2 samples/s | 30.1 steps/s
[Step= 150] | Loss=6.16645 | acc=0.1502 | tpr=0.4409 | fpr=0.8551 | 7937.1 samples/s | 31.0 steps/s
[Step= 200] | Loss=6.16247 | acc=0.1505 | tpr=0.4503 | fpr=0.8549 | 7945.0 samples/s | 31.0 steps/s
[Step= 250] | Loss=6.15740 | acc=0.1503 | tpr=0.4445 | fpr=0.8550 | 8170.5 samples/s | 31.9 steps/s
[Step= 300] | Loss=6.16650 | acc=0.1502 | tpr=0.4429 | fpr=0.8552 | 7491.9 samples/s | 29.3 steps/s
[Step= 350] | Loss=6.17423 | acc=0.1498 | tpr=0.4458 | fpr=0.8556 | 7804.1 samples/s | 30.5 steps/s
[Step= 400] | Loss=6.16439 | acc=0.1494 | tpr=0.4360 | fpr=0.8558 | 7919.1 samples/s | 30.9 steps/s
[Step= 450] | Loss=6.16688 | acc=0.1491 | tpr=0.4352 | fpr=0.8561 | 7636.9 samples/s | 29.8 steps/s
[Step= 500] | Loss=6.16802 | acc=0.1490 | tpr=0.4361 | fpr=0.8562 | 7881.5 samples/s | 30.8 steps/s
[Step= 550] | Loss=6.17112 | acc=0.1490 | tpr=0.4345 | fpr=0.8561 | 14639.0 samples/s | 57.2 steps/s
Avg test loss: 6.17138, Avg test acc: 0.14893, Avg tpr: 0.43463, Avg fpr: 0.85626, total FA: 118890

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13429 | acc=0.9805 | tpr=0.9248 | fpr=0.0185 | 4150.8 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.14501 | acc=0.9798 | tpr=0.9339 | fpr=0.0194 | 7828.7 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.14700 | acc=0.9793 | tpr=0.9395 | fpr=0.0199 | 8050.9 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.14929 | acc=0.9796 | tpr=0.9464 | fpr=0.0198 | 8040.0 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.14821 | acc=0.9798 | tpr=0.9476 | fpr=0.0196 | 7535.4 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.15149 | acc=0.9794 | tpr=0.9462 | fpr=0.0200 | 7867.3 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.15130 | acc=0.9795 | tpr=0.9461 | fpr=0.0199 | 7785.0 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.15223 | acc=0.9792 | tpr=0.9431 | fpr=0.0201 | 7960.4 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.15392 | acc=0.9790 | tpr=0.9416 | fpr=0.0203 | 7925.0 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.15308 | acc=0.9792 | tpr=0.9414 | fpr=0.0202 | 7686.1 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.15186 | acc=0.9794 | tpr=0.9419 | fpr=0.0200 | 14562.2 samples/s | 56.9 steps/s
Avg test loss: 0.15149, Avg test acc: 0.97937, Avg tpr: 0.94216, Avg fpr: 0.01996, total FA: 2771

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13240 | acc=0.9784 | tpr=0.9248 | fpr=0.0206 | 4028.2 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.14208 | acc=0.9778 | tpr=0.9467 | fpr=0.0216 | 7722.0 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.14369 | acc=0.9776 | tpr=0.9568 | fpr=0.0220 | 7853.4 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.14532 | acc=0.9777 | tpr=0.9617 | fpr=0.0220 | 7903.1 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.14479 | acc=0.9778 | tpr=0.9616 | fpr=0.0219 | 8024.4 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.14820 | acc=0.9774 | tpr=0.9622 | fpr=0.0224 | 7814.1 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.14828 | acc=0.9775 | tpr=0.9606 | fpr=0.0222 | 7885.4 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.14948 | acc=0.9773 | tpr=0.9595 | fpr=0.0224 | 7926.7 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.15099 | acc=0.9772 | tpr=0.9576 | fpr=0.0225 | 7749.9 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.15019 | acc=0.9773 | tpr=0.9577 | fpr=0.0224 | 7785.8 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.14922 | acc=0.9775 | tpr=0.9590 | fpr=0.0221 | 14592.5 samples/s | 57.0 steps/s
Avg test loss: 0.14889, Avg test acc: 0.97753, Avg tpr: 0.95919, Avg fpr: 0.02214, total FA: 3074

server round 21/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=42001 Epoch=81.9] | Loss=0.01490 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.757 | L2-Norm(final)=16.395 | 4746.0 samples/s | 74.2 steps/s
[Step=42050 Epoch=82.0] | Loss=0.00987 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=16.399 | 5374.4 samples/s | 84.0 steps/s
[Step=42100 Epoch=82.1] | Loss=0.01091 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=16.406 | 5344.5 samples/s | 83.5 steps/s
[Step=42150 Epoch=82.2] | Loss=0.01081 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=16.411 | 5489.2 samples/s | 85.8 steps/s
[Step=42200 Epoch=82.3] | Loss=0.01089 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=16.416 | 5588.2 samples/s | 87.3 steps/s
[Step=42250 Epoch=82.4] | Loss=0.01079 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.758 | L2-Norm(final)=16.421 | 5531.6 samples/s | 86.4 steps/s
[Step=42300 Epoch=82.5] | Loss=0.01072 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=16.427 | 5480.2 samples/s | 85.6 steps/s
[Step=42350 Epoch=82.6] | Loss=0.01111 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.758 | L2-Norm(final)=16.431 | 5603.4 samples/s | 87.6 steps/s
[Step=42400 Epoch=82.7] | Loss=0.01107 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.758 | L2-Norm(final)=16.436 | 5558.1 samples/s | 86.8 steps/s
[Step=42450 Epoch=82.8] | Loss=0.01110 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=16.440 | 5541.5 samples/s | 86.6 steps/s
[Step=42500 Epoch=82.9] | Loss=0.01145 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.758 | L2-Norm(final)=16.444 | 6943.1 samples/s | 108.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=42501 Epoch=82.9] | Loss=0.01692 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.758 | L2-Norm(final)=16.481 | 4116.6 samples/s | 64.3 steps/s
[Step=42550 Epoch=83.0] | Loss=0.01013 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.774 | L2-Norm(final)=16.483 | 4624.7 samples/s | 72.3 steps/s
[Step=42600 Epoch=83.1] | Loss=0.01144 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=16.481 | 4786.9 samples/s | 74.8 steps/s
[Step=42650 Epoch=83.2] | Loss=0.01154 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.802 | L2-Norm(final)=16.480 | 4758.0 samples/s | 74.3 steps/s
[Step=42700 Epoch=83.3] | Loss=0.01254 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.812 | L2-Norm(final)=16.478 | 4785.3 samples/s | 74.8 steps/s
[Step=42750 Epoch=83.4] | Loss=0.01217 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.821 | L2-Norm(final)=16.476 | 4807.6 samples/s | 75.1 steps/s
[Step=42800 Epoch=83.5] | Loss=0.01220 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.829 | L2-Norm(final)=16.475 | 4726.3 samples/s | 73.8 steps/s
[Step=42850 Epoch=83.6] | Loss=0.01188 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.836 | L2-Norm(final)=16.475 | 4842.0 samples/s | 75.7 steps/s
[Step=42900 Epoch=83.7] | Loss=0.01201 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.843 | L2-Norm(final)=16.474 | 4747.2 samples/s | 74.2 steps/s
[Step=42950 Epoch=83.8] | Loss=0.01181 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.848 | L2-Norm(final)=16.474 | 4793.1 samples/s | 74.9 steps/s
[Step=43000 Epoch=83.9] | Loss=0.01172 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.854 | L2-Norm(final)=16.474 | 5856.7 samples/s | 91.5 steps/s
[Step=43050 Epoch=84.0] | Loss=0.01147 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.859 | L2-Norm(final)=16.474 | 2061.5 samples/s | 32.2 steps/s
[Step=43100 Epoch=84.1] | Loss=0.01124 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.864 | L2-Norm(final)=16.475 | 4701.6 samples/s | 73.5 steps/s
[Step=43150 Epoch=84.2] | Loss=0.01081 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.869 | L2-Norm(final)=16.476 | 4770.4 samples/s | 74.5 steps/s
[Step=43200 Epoch=84.3] | Loss=0.01054 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.873 | L2-Norm(final)=16.477 | 4793.0 samples/s | 74.9 steps/s
[Step=43250 Epoch=84.4] | Loss=0.01044 | Reg=0.00166 | acc=0.9531 | L2-Norm=12.877 | L2-Norm(final)=16.478 | 4779.0 samples/s | 74.7 steps/s
[Step=43300 Epoch=84.5] | Loss=0.01031 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.880 | L2-Norm(final)=16.479 | 4799.3 samples/s | 75.0 steps/s
[Step=43350 Epoch=84.5] | Loss=0.01026 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.884 | L2-Norm(final)=16.480 | 4776.3 samples/s | 74.6 steps/s
[Step=43400 Epoch=84.6] | Loss=0.01012 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.887 | L2-Norm(final)=16.481 | 4798.0 samples/s | 75.0 steps/s
[Step=43450 Epoch=84.7] | Loss=0.00993 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.890 | L2-Norm(final)=16.482 | 4815.3 samples/s | 75.2 steps/s
[Step=43500 Epoch=84.8] | Loss=0.00983 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.894 | L2-Norm(final)=16.483 | 5023.6 samples/s | 78.5 steps/s
[Step=43550 Epoch=84.9] | Loss=0.00972 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.897 | L2-Norm(final)=16.483 | 2141.5 samples/s | 33.5 steps/s
[Step=43600 Epoch=85.0] | Loss=0.00960 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.899 | L2-Norm(final)=16.484 | 4855.5 samples/s | 75.9 steps/s
[Step=43650 Epoch=85.1] | Loss=0.00941 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.902 | L2-Norm(final)=16.485 | 4708.6 samples/s | 73.6 steps/s
[Step=43700 Epoch=85.2] | Loss=0.00933 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=16.486 | 4794.3 samples/s | 74.9 steps/s
[Step=43750 Epoch=85.3] | Loss=0.00925 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=16.487 | 4840.6 samples/s | 75.6 steps/s
[Step=43800 Epoch=85.4] | Loss=0.00925 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.910 | L2-Norm(final)=16.487 | 4792.1 samples/s | 74.9 steps/s
[Step=43850 Epoch=85.5] | Loss=0.00913 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.912 | L2-Norm(final)=16.488 | 4778.3 samples/s | 74.7 steps/s
[Step=43900 Epoch=85.6] | Loss=0.00904 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=16.489 | 4778.7 samples/s | 74.7 steps/s
[Step=43950 Epoch=85.7] | Loss=0.00897 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.916 | L2-Norm(final)=16.490 | 4756.4 samples/s | 74.3 steps/s
[Step=44000 Epoch=85.8] | Loss=0.00890 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=16.491 | 4837.0 samples/s | 75.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step44000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=42001 Epoch=82.1] | Loss=0.00078 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=16.761 | 4676.6 samples/s | 73.1 steps/s
[Step=42050 Epoch=82.2] | Loss=0.01077 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.757 | L2-Norm(final)=16.763 | 5359.2 samples/s | 83.7 steps/s
[Step=42100 Epoch=82.3] | Loss=0.01201 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.757 | L2-Norm(final)=16.765 | 5524.6 samples/s | 86.3 steps/s
[Step=42150 Epoch=82.4] | Loss=0.01185 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=16.767 | 5395.3 samples/s | 84.3 steps/s
[Step=42200 Epoch=82.5] | Loss=0.01175 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=16.770 | 5523.5 samples/s | 86.3 steps/s
[Step=42250 Epoch=82.6] | Loss=0.01211 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=16.773 | 5540.8 samples/s | 86.6 steps/s
[Step=42300 Epoch=82.7] | Loss=0.01181 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=16.777 | 5571.8 samples/s | 87.1 steps/s
[Step=42350 Epoch=82.8] | Loss=0.01150 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.758 | L2-Norm(final)=16.781 | 5485.0 samples/s | 85.7 steps/s
[Step=42400 Epoch=82.9] | Loss=0.01130 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=16.785 | 5600.3 samples/s | 87.5 steps/s
[Step=42450 Epoch=83.0] | Loss=0.01109 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=16.789 | 5531.7 samples/s | 86.4 steps/s
[Step=42500 Epoch=83.1] | Loss=0.01103 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=16.794 | 6982.8 samples/s | 109.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=42501 Epoch=83.1] | Loss=0.00452 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=16.839 | 4568.6 samples/s | 71.4 steps/s
[Step=42550 Epoch=83.2] | Loss=0.00838 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.770 | L2-Norm(final)=16.840 | 4563.9 samples/s | 71.3 steps/s
[Step=42600 Epoch=83.3] | Loss=0.00937 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=16.841 | 4778.1 samples/s | 74.7 steps/s
[Step=42650 Epoch=83.4] | Loss=0.00931 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=16.842 | 4807.1 samples/s | 75.1 steps/s
[Step=42700 Epoch=83.5] | Loss=0.00918 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=16.842 | 4746.4 samples/s | 74.2 steps/s
[Step=42750 Epoch=83.6] | Loss=0.00989 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.804 | L2-Norm(final)=16.842 | 4852.1 samples/s | 75.8 steps/s
[Step=42800 Epoch=83.7] | Loss=0.01003 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.810 | L2-Norm(final)=16.842 | 4776.6 samples/s | 74.6 steps/s
[Step=42850 Epoch=83.8] | Loss=0.00980 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.816 | L2-Norm(final)=16.842 | 4707.0 samples/s | 73.5 steps/s
[Step=42900 Epoch=83.9] | Loss=0.01021 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.822 | L2-Norm(final)=16.842 | 4767.4 samples/s | 74.5 steps/s
[Step=42950 Epoch=84.0] | Loss=0.01015 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.827 | L2-Norm(final)=16.842 | 4763.1 samples/s | 74.4 steps/s
[Step=43000 Epoch=84.1] | Loss=0.01019 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.832 | L2-Norm(final)=16.842 | 5866.4 samples/s | 91.7 steps/s
[Step=43050 Epoch=84.2] | Loss=0.01018 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.836 | L2-Norm(final)=16.842 | 2078.7 samples/s | 32.5 steps/s
[Step=43100 Epoch=84.3] | Loss=0.00989 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.840 | L2-Norm(final)=16.842 | 4728.9 samples/s | 73.9 steps/s
[Step=43150 Epoch=84.4] | Loss=0.00988 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.844 | L2-Norm(final)=16.842 | 4777.3 samples/s | 74.6 steps/s
[Step=43200 Epoch=84.5] | Loss=0.00994 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.848 | L2-Norm(final)=16.841 | 4792.9 samples/s | 74.9 steps/s
[Step=43250 Epoch=84.6] | Loss=0.00960 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.851 | L2-Norm(final)=16.841 | 4793.0 samples/s | 74.9 steps/s
[Step=43300 Epoch=84.7] | Loss=0.00942 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.855 | L2-Norm(final)=16.842 | 4809.2 samples/s | 75.1 steps/s
[Step=43350 Epoch=84.7] | Loss=0.00936 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.858 | L2-Norm(final)=16.842 | 4806.2 samples/s | 75.1 steps/s
[Step=43400 Epoch=84.8] | Loss=0.00949 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.861 | L2-Norm(final)=16.842 | 4711.2 samples/s | 73.6 steps/s
[Step=43450 Epoch=84.9] | Loss=0.00941 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.864 | L2-Norm(final)=16.841 | 4813.2 samples/s | 75.2 steps/s
[Step=43500 Epoch=85.0] | Loss=0.00920 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.867 | L2-Norm(final)=16.841 | 5172.4 samples/s | 80.8 steps/s
[Step=43550 Epoch=85.1] | Loss=0.00912 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.869 | L2-Norm(final)=16.841 | 2190.8 samples/s | 34.2 steps/s
[Step=43600 Epoch=85.2] | Loss=0.00899 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.872 | L2-Norm(final)=16.841 | 4752.1 samples/s | 74.3 steps/s
[Step=43650 Epoch=85.3] | Loss=0.00879 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.875 | L2-Norm(final)=16.841 | 4767.8 samples/s | 74.5 steps/s
[Step=43700 Epoch=85.4] | Loss=0.00880 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.877 | L2-Norm(final)=16.841 | 4750.2 samples/s | 74.2 steps/s
[Step=43750 Epoch=85.5] | Loss=0.00868 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.880 | L2-Norm(final)=16.841 | 4780.9 samples/s | 74.7 steps/s
[Step=43800 Epoch=85.6] | Loss=0.00865 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.882 | L2-Norm(final)=16.842 | 4755.0 samples/s | 74.3 steps/s
[Step=43850 Epoch=85.7] | Loss=0.00861 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.884 | L2-Norm(final)=16.842 | 4802.5 samples/s | 75.0 steps/s
[Step=43900 Epoch=85.8] | Loss=0.00855 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.887 | L2-Norm(final)=16.842 | 4821.8 samples/s | 75.3 steps/s
[Step=43950 Epoch=85.9] | Loss=0.00847 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.889 | L2-Norm(final)=16.842 | 4667.8 samples/s | 72.9 steps/s
[Step=44000 Epoch=86.0] | Loss=0.00839 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.891 | L2-Norm(final)=16.842 | 4790.5 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step44000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=42001 Epoch=160.9] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=15.543 | 4634.6 samples/s | 72.4 steps/s
[Step=42050 Epoch=161.1] | Loss=0.00040 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=15.549 | 4819.8 samples/s | 75.3 steps/s
[Step=42100 Epoch=161.3] | Loss=0.00022 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=15.554 | 5180.3 samples/s | 80.9 steps/s
[Step=42150 Epoch=161.5] | Loss=0.00016 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=15.557 | 5133.2 samples/s | 80.2 steps/s
[Step=42200 Epoch=161.7] | Loss=0.00024 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=15.558 | 5205.5 samples/s | 81.3 steps/s
[Step=42250 Epoch=161.9] | Loss=0.00024 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=15.560 | 6813.7 samples/s | 106.5 steps/s
[Step=42300 Epoch=162.1] | Loss=0.00023 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=15.563 | 2155.8 samples/s | 33.7 steps/s
[Step=42350 Epoch=162.3] | Loss=0.00024 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=15.566 | 5249.6 samples/s | 82.0 steps/s
[Step=42400 Epoch=162.5] | Loss=0.00028 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=15.570 | 5180.9 samples/s | 81.0 steps/s
[Step=42450 Epoch=162.7] | Loss=0.00026 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=15.573 | 5230.7 samples/s | 81.7 steps/s
[Step=42500 Epoch=162.8] | Loss=0.00024 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=15.576 | 5749.4 samples/s | 89.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=42501 Epoch=162.8] | Loss=0.00002 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=15.606 | 4926.5 samples/s | 77.0 steps/s
[Step=42550 Epoch=163.0] | Loss=0.00103 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.759 | L2-Norm(final)=15.606 | 4048.4 samples/s | 63.3 steps/s
[Step=42600 Epoch=163.2] | Loss=0.00085 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.768 | L2-Norm(final)=15.606 | 4542.4 samples/s | 71.0 steps/s
[Step=42650 Epoch=163.4] | Loss=0.00060 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.779 | L2-Norm(final)=15.606 | 4538.9 samples/s | 70.9 steps/s
[Step=42700 Epoch=163.6] | Loss=0.00046 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.782 | L2-Norm(final)=15.606 | 4557.1 samples/s | 71.2 steps/s
[Step=42750 Epoch=163.8] | Loss=0.00037 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.782 | L2-Norm(final)=15.607 | 5737.9 samples/s | 89.7 steps/s
[Step=42800 Epoch=164.0] | Loss=0.00031 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=15.607 | 2019.9 samples/s | 31.6 steps/s
[Step=42850 Epoch=164.2] | Loss=0.00026 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.776 | L2-Norm(final)=15.607 | 4528.5 samples/s | 70.8 steps/s
[Step=42900 Epoch=164.4] | Loss=0.00023 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.772 | L2-Norm(final)=15.608 | 4600.8 samples/s | 71.9 steps/s
[Step=42950 Epoch=164.6] | Loss=0.00021 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.768 | L2-Norm(final)=15.608 | 4494.1 samples/s | 70.2 steps/s
[Step=43000 Epoch=164.8] | Loss=0.00018 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.763 | L2-Norm(final)=15.608 | 4973.7 samples/s | 77.7 steps/s
[Step=43050 Epoch=165.0] | Loss=0.00017 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=15.608 | 2110.5 samples/s | 33.0 steps/s
[Step=43100 Epoch=165.1] | Loss=0.00015 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.753 | L2-Norm(final)=15.608 | 4564.4 samples/s | 71.3 steps/s
[Step=43150 Epoch=165.3] | Loss=0.00014 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.747 | L2-Norm(final)=15.608 | 4542.9 samples/s | 71.0 steps/s
[Step=43200 Epoch=165.5] | Loss=0.00013 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.741 | L2-Norm(final)=15.609 | 4528.6 samples/s | 70.8 steps/s
[Step=43250 Epoch=165.7] | Loss=0.00012 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.736 | L2-Norm(final)=15.609 | 4516.4 samples/s | 70.6 steps/s
[Step=43300 Epoch=165.9] | Loss=0.00012 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.730 | L2-Norm(final)=15.609 | 2190.0 samples/s | 34.2 steps/s
[Step=43350 Epoch=166.1] | Loss=0.00011 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.724 | L2-Norm(final)=15.609 | 4647.8 samples/s | 72.6 steps/s
[Step=43400 Epoch=166.3] | Loss=0.00010 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.718 | L2-Norm(final)=15.609 | 4509.7 samples/s | 70.5 steps/s
[Step=43450 Epoch=166.5] | Loss=0.00010 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.711 | L2-Norm(final)=15.609 | 4526.4 samples/s | 70.7 steps/s
[Step=43500 Epoch=166.7] | Loss=0.00009 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.705 | L2-Norm(final)=15.609 | 4549.0 samples/s | 71.1 steps/s
[Step=43550 Epoch=166.9] | Loss=0.00009 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.699 | L2-Norm(final)=15.609 | 2209.6 samples/s | 34.5 steps/s
[Step=43600 Epoch=167.1] | Loss=0.00008 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=15.609 | 4548.9 samples/s | 71.1 steps/s
[Step=43650 Epoch=167.3] | Loss=0.00008 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.685 | L2-Norm(final)=15.609 | 4573.5 samples/s | 71.5 steps/s
[Step=43700 Epoch=167.4] | Loss=0.00008 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.679 | L2-Norm(final)=15.610 | 4513.1 samples/s | 70.5 steps/s
[Step=43750 Epoch=167.6] | Loss=0.00007 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=15.610 | 4554.0 samples/s | 71.2 steps/s
[Step=43800 Epoch=167.8] | Loss=0.00007 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.665 | L2-Norm(final)=15.610 | 6182.6 samples/s | 96.6 steps/s
[Step=43850 Epoch=168.0] | Loss=0.00007 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=15.610 | 1966.7 samples/s | 30.7 steps/s
[Step=43900 Epoch=168.2] | Loss=0.00007 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=15.610 | 4544.9 samples/s | 71.0 steps/s
[Step=43950 Epoch=168.4] | Loss=0.00006 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.644 | L2-Norm(final)=15.610 | 4565.9 samples/s | 71.3 steps/s
[Step=44000 Epoch=168.6] | Loss=0.00006 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.637 | L2-Norm(final)=15.610 | 4548.1 samples/s | 71.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step44000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=42001 Epoch=161.7] | Loss=0.00002 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=16.741 | 4318.0 samples/s | 67.5 steps/s
[Step=42050 Epoch=161.9] | Loss=0.00016 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.756 | L2-Norm(final)=16.743 | 4728.8 samples/s | 73.9 steps/s
[Step=42100 Epoch=162.1] | Loss=0.00027 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=16.747 | 5204.6 samples/s | 81.3 steps/s
[Step=42150 Epoch=162.3] | Loss=0.00029 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=16.750 | 5287.5 samples/s | 82.6 steps/s
[Step=42200 Epoch=162.4] | Loss=0.00032 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=16.753 | 5234.5 samples/s | 81.8 steps/s
[Step=42250 Epoch=162.6] | Loss=0.00027 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=16.757 | 6812.3 samples/s | 106.4 steps/s
[Step=42300 Epoch=162.8] | Loss=0.00024 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=16.760 | 2102.4 samples/s | 32.9 steps/s
[Step=42350 Epoch=163.0] | Loss=0.00027 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=16.763 | 5332.0 samples/s | 83.3 steps/s
[Step=42400 Epoch=163.2] | Loss=0.00027 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=16.767 | 5305.9 samples/s | 82.9 steps/s
[Step=42450 Epoch=163.4] | Loss=0.00026 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=16.770 | 5021.2 samples/s | 78.5 steps/s
[Step=42500 Epoch=163.6] | Loss=0.00026 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=16.773 | 6097.3 samples/s | 95.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=42501 Epoch=163.6] | Loss=0.00014 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=16.807 | 4563.9 samples/s | 71.3 steps/s
[Step=42550 Epoch=163.8] | Loss=0.00004 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.752 | L2-Norm(final)=16.811 | 4287.8 samples/s | 67.0 steps/s
[Step=42600 Epoch=164.0] | Loss=0.00005 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.750 | L2-Norm(final)=16.813 | 4549.2 samples/s | 71.1 steps/s
[Step=42650 Epoch=164.2] | Loss=0.00015 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.754 | L2-Norm(final)=16.815 | 4596.0 samples/s | 71.8 steps/s
[Step=42700 Epoch=164.4] | Loss=0.00014 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=16.816 | 4427.9 samples/s | 69.2 steps/s
[Step=42750 Epoch=164.6] | Loss=0.00087 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.766 | L2-Norm(final)=16.816 | 5839.3 samples/s | 91.2 steps/s
[Step=42800 Epoch=164.8] | Loss=0.00084 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.778 | L2-Norm(final)=16.813 | 1984.1 samples/s | 31.0 steps/s
[Step=42850 Epoch=164.9] | Loss=0.00073 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.786 | L2-Norm(final)=16.811 | 4553.9 samples/s | 71.2 steps/s
[Step=42900 Epoch=165.1] | Loss=0.00064 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.792 | L2-Norm(final)=16.810 | 4539.6 samples/s | 70.9 steps/s
[Step=42950 Epoch=165.3] | Loss=0.00057 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=16.809 | 4582.0 samples/s | 71.6 steps/s
[Step=43000 Epoch=165.5] | Loss=0.00052 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.799 | L2-Norm(final)=16.809 | 5148.7 samples/s | 80.4 steps/s
[Step=43050 Epoch=165.7] | Loss=0.00048 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.800 | L2-Norm(final)=16.808 | 2100.0 samples/s | 32.8 steps/s
[Step=43100 Epoch=165.9] | Loss=0.00044 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.801 | L2-Norm(final)=16.808 | 4588.8 samples/s | 71.7 steps/s
[Step=43150 Epoch=166.1] | Loss=0.00040 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.801 | L2-Norm(final)=16.808 | 4543.8 samples/s | 71.0 steps/s
[Step=43200 Epoch=166.3] | Loss=0.00038 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.801 | L2-Norm(final)=16.808 | 4503.1 samples/s | 70.4 steps/s
[Step=43250 Epoch=166.5] | Loss=0.00035 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.800 | L2-Norm(final)=16.808 | 4640.0 samples/s | 72.5 steps/s
[Step=43300 Epoch=166.7] | Loss=0.00033 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.798 | L2-Norm(final)=16.808 | 2190.0 samples/s | 34.2 steps/s
[Step=43350 Epoch=166.9] | Loss=0.00031 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.797 | L2-Norm(final)=16.808 | 4574.5 samples/s | 71.5 steps/s
[Step=43400 Epoch=167.1] | Loss=0.00029 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=16.808 | 4556.6 samples/s | 71.2 steps/s
[Step=43450 Epoch=167.3] | Loss=0.00028 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.793 | L2-Norm(final)=16.808 | 4639.3 samples/s | 72.5 steps/s
[Step=43500 Epoch=167.4] | Loss=0.00026 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.791 | L2-Norm(final)=16.808 | 4491.8 samples/s | 70.2 steps/s
[Step=43550 Epoch=167.6] | Loss=0.00025 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=16.808 | 2182.7 samples/s | 34.1 steps/s
[Step=43600 Epoch=167.8] | Loss=0.00024 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.786 | L2-Norm(final)=16.808 | 4636.5 samples/s | 72.4 steps/s
[Step=43650 Epoch=168.0] | Loss=0.00023 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.783 | L2-Norm(final)=16.808 | 4512.2 samples/s | 70.5 steps/s
[Step=43700 Epoch=168.2] | Loss=0.00022 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.781 | L2-Norm(final)=16.808 | 4606.5 samples/s | 72.0 steps/s
[Step=43750 Epoch=168.4] | Loss=0.00021 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.778 | L2-Norm(final)=16.808 | 4566.3 samples/s | 71.3 steps/s
[Step=43800 Epoch=168.6] | Loss=0.00020 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.775 | L2-Norm(final)=16.808 | 6568.8 samples/s | 102.6 steps/s
[Step=43850 Epoch=168.8] | Loss=0.00020 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.772 | L2-Norm(final)=16.808 | 1928.1 samples/s | 30.1 steps/s
[Step=43900 Epoch=169.0] | Loss=0.00019 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.769 | L2-Norm(final)=16.808 | 4559.6 samples/s | 71.2 steps/s
[Step=43950 Epoch=169.2] | Loss=0.00018 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.765 | L2-Norm(final)=16.808 | 4530.4 samples/s | 70.8 steps/s
[Step=44000 Epoch=169.4] | Loss=0.00018 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.762 | L2-Norm(final)=16.809 | 4555.4 samples/s | 71.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step44000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07754 | acc=0.9698 | tpr=0.9764 | fpr=0.0444 | 4356.9 samples/s | 17.0 steps/s
Avg test loss: 0.07671, Avg test acc: 0.96907, Avg tpr: 0.97593, Avg fpr: 0.04602, total FA: 359

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08191 | acc=0.9687 | tpr=0.9787 | fpr=0.0530 | 4231.8 samples/s | 16.5 steps/s
Avg test loss: 0.08050, Avg test acc: 0.96923, Avg tpr: 0.97966, Avg fpr: 0.05371, total FA: 419

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=8.17472 | acc=0.3016 | tpr=0.0091 | fpr=0.0634 | 4178.2 samples/s | 16.3 steps/s
Avg test loss: 8.18840, Avg test acc: 0.29794, Avg tpr: 0.00874, Avg fpr: 0.06602, total FA: 515

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.76752 | acc=0.3058 | tpr=0.0096 | fpr=0.0510 | 4160.3 samples/s | 16.3 steps/s
Avg test loss: 7.77027, Avg test acc: 0.30295, Avg tpr: 0.01037, Avg fpr: 0.05358, total FA: 418

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.22963 | acc=0.1432 | tpr=0.4381 | fpr=0.8621 | 4200.2 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.16422 | acc=0.1438 | tpr=0.4286 | fpr=0.8615 | 7664.1 samples/s | 29.9 steps/s
[Step= 150] | Loss=6.17283 | acc=0.1427 | tpr=0.4395 | fpr=0.8628 | 7854.6 samples/s | 30.7 steps/s
[Step= 200] | Loss=6.16619 | acc=0.1430 | tpr=0.4481 | fpr=0.8625 | 7923.6 samples/s | 31.0 steps/s
[Step= 250] | Loss=6.16177 | acc=0.1429 | tpr=0.4341 | fpr=0.8624 | 7803.8 samples/s | 30.5 steps/s
[Step= 300] | Loss=6.16899 | acc=0.1420 | tpr=0.4342 | fpr=0.8633 | 7792.3 samples/s | 30.4 steps/s
[Step= 350] | Loss=6.17779 | acc=0.1414 | tpr=0.4352 | fpr=0.8640 | 7979.9 samples/s | 31.2 steps/s
[Step= 400] | Loss=6.16728 | acc=0.1411 | tpr=0.4261 | fpr=0.8641 | 7815.9 samples/s | 30.5 steps/s
[Step= 450] | Loss=6.16989 | acc=0.1405 | tpr=0.4231 | fpr=0.8646 | 7765.2 samples/s | 30.3 steps/s
[Step= 500] | Loss=6.17145 | acc=0.1405 | tpr=0.4238 | fpr=0.8646 | 7782.2 samples/s | 30.4 steps/s
[Step= 550] | Loss=6.17283 | acc=0.1405 | tpr=0.4258 | fpr=0.8647 | 14823.2 samples/s | 57.9 steps/s
Avg test loss: 6.17362, Avg test acc: 0.14045, Avg tpr: 0.42591, Avg fpr: 0.86474, total FA: 120068

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.17310 | acc=0.1208 | tpr=0.4956 | fpr=0.8860 | 4155.7 samples/s | 16.2 steps/s
[Step= 100] | Loss=7.10521 | acc=0.1225 | tpr=0.5096 | fpr=0.8847 | 7903.3 samples/s | 30.9 steps/s
[Step= 150] | Loss=7.12306 | acc=0.1215 | tpr=0.5014 | fpr=0.8855 | 7708.4 samples/s | 30.1 steps/s
[Step= 200] | Loss=7.11199 | acc=0.1216 | tpr=0.5027 | fpr=0.8854 | 7911.2 samples/s | 30.9 steps/s
[Step= 250] | Loss=7.10668 | acc=0.1210 | tpr=0.4978 | fpr=0.8859 | 8497.2 samples/s | 33.2 steps/s
[Step= 300] | Loss=7.11579 | acc=0.1204 | tpr=0.4967 | fpr=0.8864 | 7401.0 samples/s | 28.9 steps/s
[Step= 350] | Loss=7.12414 | acc=0.1199 | tpr=0.5009 | fpr=0.8870 | 7805.9 samples/s | 30.5 steps/s
[Step= 400] | Loss=7.11221 | acc=0.1195 | tpr=0.4902 | fpr=0.8872 | 8164.3 samples/s | 31.9 steps/s
[Step= 450] | Loss=7.11452 | acc=0.1194 | tpr=0.4888 | fpr=0.8873 | 7692.8 samples/s | 30.1 steps/s
[Step= 500] | Loss=7.11905 | acc=0.1194 | tpr=0.4894 | fpr=0.8873 | 7838.3 samples/s | 30.6 steps/s
[Step= 550] | Loss=7.12084 | acc=0.1197 | tpr=0.4926 | fpr=0.8871 | 14632.6 samples/s | 57.2 steps/s
Avg test loss: 7.12083, Avg test acc: 0.11964, Avg tpr: 0.49287, Avg fpr: 0.88714, total FA: 123178

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.16473 | acc=0.9791 | tpr=0.9159 | fpr=0.0198 | 4190.9 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.17717 | acc=0.9782 | tpr=0.9382 | fpr=0.0210 | 7704.1 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.18202 | acc=0.9778 | tpr=0.9438 | fpr=0.0216 | 8014.7 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.18424 | acc=0.9781 | tpr=0.9486 | fpr=0.0214 | 7999.7 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.18227 | acc=0.9782 | tpr=0.9511 | fpr=0.0213 | 7856.7 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.18677 | acc=0.9779 | tpr=0.9498 | fpr=0.0216 | 7851.6 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.18743 | acc=0.9780 | tpr=0.9480 | fpr=0.0215 | 7655.6 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.18927 | acc=0.9777 | tpr=0.9458 | fpr=0.0218 | 8174.1 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.19155 | acc=0.9775 | tpr=0.9455 | fpr=0.0220 | 7857.0 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.18991 | acc=0.9777 | tpr=0.9467 | fpr=0.0218 | 7516.7 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.18841 | acc=0.9779 | tpr=0.9471 | fpr=0.0215 | 15122.7 samples/s | 59.1 steps/s
Avg test loss: 0.18799, Avg test acc: 0.97792, Avg tpr: 0.94731, Avg fpr: 0.02153, total FA: 2989

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13273 | acc=0.9793 | tpr=0.9336 | fpr=0.0199 | 4110.6 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.14328 | acc=0.9779 | tpr=0.9446 | fpr=0.0215 | 8005.0 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.14582 | acc=0.9773 | tpr=0.9524 | fpr=0.0223 | 7835.2 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.14778 | acc=0.9773 | tpr=0.9552 | fpr=0.0223 | 7706.7 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.14726 | acc=0.9772 | tpr=0.9563 | fpr=0.0224 | 7771.1 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.15092 | acc=0.9768 | tpr=0.9564 | fpr=0.0228 | 7998.3 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.15165 | acc=0.9767 | tpr=0.9543 | fpr=0.0229 | 7698.5 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.15335 | acc=0.9764 | tpr=0.9524 | fpr=0.0231 | 8196.7 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.15514 | acc=0.9763 | tpr=0.9499 | fpr=0.0233 | 7548.4 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.15392 | acc=0.9764 | tpr=0.9515 | fpr=0.0231 | 7981.9 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.15290 | acc=0.9767 | tpr=0.9515 | fpr=0.0229 | 14491.9 samples/s | 56.6 steps/s
Avg test loss: 0.15268, Avg test acc: 0.97669, Avg tpr: 0.95166, Avg fpr: 0.02286, total FA: 3174

server round 22/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=44001 Epoch=85.8] | Loss=0.00264 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=16.519 | 4233.5 samples/s | 66.1 steps/s
[Step=44050 Epoch=85.9] | Loss=0.00904 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.675 | L2-Norm(final)=16.522 | 5348.4 samples/s | 83.6 steps/s
[Step=44100 Epoch=86.0] | Loss=0.00970 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.675 | L2-Norm(final)=16.528 | 5504.2 samples/s | 86.0 steps/s
[Step=44150 Epoch=86.1] | Loss=0.01045 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=16.533 | 5479.7 samples/s | 85.6 steps/s
[Step=44200 Epoch=86.2] | Loss=0.01006 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.675 | L2-Norm(final)=16.538 | 5489.8 samples/s | 85.8 steps/s
[Step=44250 Epoch=86.3] | Loss=0.01037 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=16.543 | 5596.8 samples/s | 87.5 steps/s
[Step=44300 Epoch=86.4] | Loss=0.01007 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=16.548 | 5594.2 samples/s | 87.4 steps/s
[Step=44350 Epoch=86.5] | Loss=0.00990 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=16.553 | 5495.9 samples/s | 85.9 steps/s
[Step=44400 Epoch=86.6] | Loss=0.00974 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=16.559 | 5567.1 samples/s | 87.0 steps/s
[Step=44450 Epoch=86.7] | Loss=0.00962 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.675 | L2-Norm(final)=16.564 | 5491.1 samples/s | 85.8 steps/s
[Step=44500 Epoch=86.8] | Loss=0.00967 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.675 | L2-Norm(final)=16.570 | 7050.8 samples/s | 110.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=44501 Epoch=86.8] | Loss=0.01826 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.675 | L2-Norm(final)=16.624 | 4425.7 samples/s | 69.2 steps/s
[Step=44550 Epoch=86.9] | Loss=0.00859 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.690 | L2-Norm(final)=16.626 | 4237.4 samples/s | 66.2 steps/s
[Step=44600 Epoch=87.0] | Loss=0.00946 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.703 | L2-Norm(final)=16.627 | 4737.2 samples/s | 74.0 steps/s
[Step=44650 Epoch=87.1] | Loss=0.00934 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.713 | L2-Norm(final)=16.629 | 4647.7 samples/s | 72.6 steps/s
[Step=44700 Epoch=87.2] | Loss=0.01093 | Reg=0.00162 | acc=0.9531 | L2-Norm=12.722 | L2-Norm(final)=16.629 | 4662.8 samples/s | 72.9 steps/s
[Step=44750 Epoch=87.3] | Loss=0.01108 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.731 | L2-Norm(final)=16.629 | 4839.4 samples/s | 75.6 steps/s
[Step=44800 Epoch=87.4] | Loss=0.01118 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.739 | L2-Norm(final)=16.629 | 4838.0 samples/s | 75.6 steps/s
[Step=44850 Epoch=87.5] | Loss=0.01089 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.746 | L2-Norm(final)=16.629 | 4741.5 samples/s | 74.1 steps/s
[Step=44900 Epoch=87.6] | Loss=0.01090 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.753 | L2-Norm(final)=16.629 | 4864.9 samples/s | 76.0 steps/s
[Step=44950 Epoch=87.7] | Loss=0.01081 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.758 | L2-Norm(final)=16.630 | 4706.5 samples/s | 73.5 steps/s
[Step=45000 Epoch=87.8] | Loss=0.01062 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.764 | L2-Norm(final)=16.631 | 5829.3 samples/s | 91.1 steps/s
[Step=45050 Epoch=87.9] | Loss=0.01015 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.770 | L2-Norm(final)=16.631 | 2046.2 samples/s | 32.0 steps/s
[Step=45100 Epoch=88.0] | Loss=0.00997 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.775 | L2-Norm(final)=16.632 | 4762.1 samples/s | 74.4 steps/s
[Step=45150 Epoch=88.1] | Loss=0.00989 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=16.633 | 4835.6 samples/s | 75.6 steps/s
[Step=45200 Epoch=88.2] | Loss=0.00983 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.784 | L2-Norm(final)=16.634 | 4800.5 samples/s | 75.0 steps/s
[Step=45250 Epoch=88.3] | Loss=0.00961 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=16.635 | 4783.4 samples/s | 74.7 steps/s
[Step=45300 Epoch=88.4] | Loss=0.00943 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.792 | L2-Norm(final)=16.635 | 4814.2 samples/s | 75.2 steps/s
[Step=45350 Epoch=88.5] | Loss=0.00938 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=16.636 | 4791.2 samples/s | 74.9 steps/s
[Step=45400 Epoch=88.5] | Loss=0.00932 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.799 | L2-Norm(final)=16.637 | 4770.8 samples/s | 74.5 steps/s
[Step=45450 Epoch=88.6] | Loss=0.00918 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.803 | L2-Norm(final)=16.638 | 4802.6 samples/s | 75.0 steps/s
[Step=45500 Epoch=88.7] | Loss=0.00923 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.806 | L2-Norm(final)=16.639 | 5091.5 samples/s | 79.6 steps/s
[Step=45550 Epoch=88.8] | Loss=0.00917 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.809 | L2-Norm(final)=16.639 | 2082.8 samples/s | 32.5 steps/s
[Step=45600 Epoch=88.9] | Loss=0.00904 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.812 | L2-Norm(final)=16.640 | 4836.9 samples/s | 75.6 steps/s
[Step=45650 Epoch=89.0] | Loss=0.00895 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.816 | L2-Norm(final)=16.641 | 4793.8 samples/s | 74.9 steps/s
[Step=45700 Epoch=89.1] | Loss=0.00875 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.818 | L2-Norm(final)=16.642 | 4848.2 samples/s | 75.8 steps/s
[Step=45750 Epoch=89.2] | Loss=0.00865 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.821 | L2-Norm(final)=16.643 | 4789.9 samples/s | 74.8 steps/s
[Step=45800 Epoch=89.3] | Loss=0.00853 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.824 | L2-Norm(final)=16.643 | 4769.9 samples/s | 74.5 steps/s
[Step=45850 Epoch=89.4] | Loss=0.00846 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.826 | L2-Norm(final)=16.644 | 4806.1 samples/s | 75.1 steps/s
[Step=45900 Epoch=89.5] | Loss=0.00843 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.829 | L2-Norm(final)=16.645 | 4875.4 samples/s | 76.2 steps/s
[Step=45950 Epoch=89.6] | Loss=0.00837 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.831 | L2-Norm(final)=16.646 | 4819.5 samples/s | 75.3 steps/s
[Step=46000 Epoch=89.7] | Loss=0.00846 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.834 | L2-Norm(final)=16.647 | 4748.9 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step46000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=44001 Epoch=86.0] | Loss=0.01158 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.675 | L2-Norm(final)=16.847 | 4561.7 samples/s | 71.3 steps/s
[Step=44050 Epoch=86.1] | Loss=0.01105 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=16.849 | 5065.9 samples/s | 79.2 steps/s
[Step=44100 Epoch=86.2] | Loss=0.01169 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=16.851 | 5563.7 samples/s | 86.9 steps/s
[Step=44150 Epoch=86.3] | Loss=0.01204 | Reg=0.00161 | acc=0.9531 | L2-Norm=12.675 | L2-Norm(final)=16.854 | 5432.7 samples/s | 84.9 steps/s
[Step=44200 Epoch=86.4] | Loss=0.01185 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=16.857 | 5545.0 samples/s | 86.6 steps/s
[Step=44250 Epoch=86.5] | Loss=0.01148 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.675 | L2-Norm(final)=16.860 | 5554.9 samples/s | 86.8 steps/s
[Step=44300 Epoch=86.6] | Loss=0.01122 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.675 | L2-Norm(final)=16.863 | 5533.5 samples/s | 86.5 steps/s
[Step=44350 Epoch=86.7] | Loss=0.01101 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=16.866 | 5504.0 samples/s | 86.0 steps/s
[Step=44400 Epoch=86.8] | Loss=0.01101 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=16.869 | 5562.1 samples/s | 86.9 steps/s
[Step=44450 Epoch=86.9] | Loss=0.01087 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.675 | L2-Norm(final)=16.872 | 5519.8 samples/s | 86.2 steps/s
[Step=44500 Epoch=87.0] | Loss=0.01093 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.675 | L2-Norm(final)=16.875 | 7076.6 samples/s | 110.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=44501 Epoch=87.0] | Loss=0.00700 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=16.910 | 4540.3 samples/s | 70.9 steps/s
[Step=44550 Epoch=87.1] | Loss=0.01417 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.689 | L2-Norm(final)=16.908 | 4690.1 samples/s | 73.3 steps/s
[Step=44600 Epoch=87.2] | Loss=0.01161 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.701 | L2-Norm(final)=16.908 | 4738.5 samples/s | 74.0 steps/s
[Step=44650 Epoch=87.3] | Loss=0.01141 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.710 | L2-Norm(final)=16.909 | 4767.3 samples/s | 74.5 steps/s
[Step=44700 Epoch=87.4] | Loss=0.01066 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.718 | L2-Norm(final)=16.909 | 4755.9 samples/s | 74.3 steps/s
[Step=44750 Epoch=87.5] | Loss=0.01018 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.724 | L2-Norm(final)=16.909 | 4851.2 samples/s | 75.8 steps/s
[Step=44800 Epoch=87.6] | Loss=0.01014 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.731 | L2-Norm(final)=16.910 | 4735.0 samples/s | 74.0 steps/s
[Step=44850 Epoch=87.7] | Loss=0.01034 | Reg=0.00162 | acc=0.9531 | L2-Norm=12.737 | L2-Norm(final)=16.910 | 4824.6 samples/s | 75.4 steps/s
[Step=44900 Epoch=87.8] | Loss=0.01070 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.742 | L2-Norm(final)=16.910 | 4734.9 samples/s | 74.0 steps/s
[Step=44950 Epoch=87.9] | Loss=0.01050 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.746 | L2-Norm(final)=16.909 | 4770.0 samples/s | 74.5 steps/s
[Step=45000 Epoch=88.0] | Loss=0.01061 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.751 | L2-Norm(final)=16.909 | 5920.0 samples/s | 92.5 steps/s
[Step=45050 Epoch=88.1] | Loss=0.01033 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.756 | L2-Norm(final)=16.909 | 2085.8 samples/s | 32.6 steps/s
[Step=45100 Epoch=88.2] | Loss=0.01000 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.759 | L2-Norm(final)=16.909 | 4800.3 samples/s | 75.0 steps/s
[Step=45150 Epoch=88.3] | Loss=0.00984 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.763 | L2-Norm(final)=16.909 | 4747.8 samples/s | 74.2 steps/s
[Step=45200 Epoch=88.4] | Loss=0.00976 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.766 | L2-Norm(final)=16.909 | 4789.7 samples/s | 74.8 steps/s
[Step=45250 Epoch=88.5] | Loss=0.00956 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.769 | L2-Norm(final)=16.909 | 4718.1 samples/s | 73.7 steps/s
[Step=45300 Epoch=88.6] | Loss=0.00945 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=16.909 | 4810.8 samples/s | 75.2 steps/s
[Step=45350 Epoch=88.7] | Loss=0.00933 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.776 | L2-Norm(final)=16.909 | 4773.7 samples/s | 74.6 steps/s
[Step=45400 Epoch=88.8] | Loss=0.00920 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.779 | L2-Norm(final)=16.910 | 4779.6 samples/s | 74.7 steps/s
[Step=45450 Epoch=88.9] | Loss=0.00918 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.782 | L2-Norm(final)=16.910 | 4821.7 samples/s | 75.3 steps/s
[Step=45500 Epoch=89.0] | Loss=0.00914 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.785 | L2-Norm(final)=16.910 | 5189.9 samples/s | 81.1 steps/s
[Step=45550 Epoch=89.0] | Loss=0.00902 | Reg=0.00164 | acc=0.9375 | L2-Norm=12.788 | L2-Norm(final)=16.910 | 2139.8 samples/s | 33.4 steps/s
[Step=45600 Epoch=89.1] | Loss=0.00896 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.791 | L2-Norm(final)=16.911 | 4785.8 samples/s | 74.8 steps/s
[Step=45650 Epoch=89.2] | Loss=0.00881 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.794 | L2-Norm(final)=16.911 | 4823.3 samples/s | 75.4 steps/s
[Step=45700 Epoch=89.3] | Loss=0.00868 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.797 | L2-Norm(final)=16.911 | 4863.0 samples/s | 76.0 steps/s
[Step=45750 Epoch=89.4] | Loss=0.00858 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.800 | L2-Norm(final)=16.912 | 4705.9 samples/s | 73.5 steps/s
[Step=45800 Epoch=89.5] | Loss=0.00851 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.803 | L2-Norm(final)=16.912 | 4819.1 samples/s | 75.3 steps/s
[Step=45850 Epoch=89.6] | Loss=0.00849 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.806 | L2-Norm(final)=16.912 | 4768.3 samples/s | 74.5 steps/s
[Step=45900 Epoch=89.7] | Loss=0.00841 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.808 | L2-Norm(final)=16.912 | 4859.4 samples/s | 75.9 steps/s
[Step=45950 Epoch=89.8] | Loss=0.00840 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.811 | L2-Norm(final)=16.913 | 4724.6 samples/s | 73.8 steps/s
[Step=46000 Epoch=89.9] | Loss=0.00839 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.813 | L2-Norm(final)=16.913 | 4789.6 samples/s | 74.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step46000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=44001 Epoch=168.6] | Loss=0.00000 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=15.612 | 4560.1 samples/s | 71.3 steps/s
[Step=44050 Epoch=168.8] | Loss=0.00003 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=15.615 | 4896.7 samples/s | 76.5 steps/s
[Step=44100 Epoch=169.0] | Loss=0.00002 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=15.617 | 5151.5 samples/s | 80.5 steps/s
[Step=44150 Epoch=169.2] | Loss=0.00005 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=15.618 | 5255.7 samples/s | 82.1 steps/s
[Step=44200 Epoch=169.4] | Loss=0.00004 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=15.620 | 5199.0 samples/s | 81.2 steps/s
[Step=44250 Epoch=169.6] | Loss=0.00005 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=15.622 | 6874.9 samples/s | 107.4 steps/s
[Step=44300 Epoch=169.7] | Loss=0.00005 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=15.625 | 2123.5 samples/s | 33.2 steps/s
[Step=44350 Epoch=169.9] | Loss=0.00005 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=15.627 | 5138.5 samples/s | 80.3 steps/s
[Step=44400 Epoch=170.1] | Loss=0.00005 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=15.629 | 5158.3 samples/s | 80.6 steps/s
[Step=44450 Epoch=170.3] | Loss=0.00005 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=15.631 | 5291.9 samples/s | 82.7 steps/s
[Step=44500 Epoch=170.5] | Loss=0.00005 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=15.633 | 5756.8 samples/s | 89.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=44501 Epoch=170.5] | Loss=0.00000 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.671 | L2-Norm(final)=15.653 | 4468.6 samples/s | 69.8 steps/s
[Step=44550 Epoch=170.7] | Loss=0.00002 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.664 | L2-Norm(final)=15.654 | 4368.9 samples/s | 68.3 steps/s
[Step=44600 Epoch=170.9] | Loss=0.00002 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.657 | L2-Norm(final)=15.655 | 4512.9 samples/s | 70.5 steps/s
[Step=44650 Epoch=171.1] | Loss=0.00002 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.647 | L2-Norm(final)=15.656 | 4561.2 samples/s | 71.3 steps/s
[Step=44700 Epoch=171.3] | Loss=0.00002 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.634 | L2-Norm(final)=15.656 | 4541.9 samples/s | 71.0 steps/s
[Step=44750 Epoch=171.5] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.622 | L2-Norm(final)=15.657 | 5609.2 samples/s | 87.6 steps/s
[Step=44800 Epoch=171.7] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.609 | L2-Norm(final)=15.658 | 1988.4 samples/s | 31.1 steps/s
[Step=44850 Epoch=171.8] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.596 | L2-Norm(final)=15.659 | 4572.1 samples/s | 71.4 steps/s
[Step=44900 Epoch=172.0] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.583 | L2-Norm(final)=15.659 | 4537.2 samples/s | 70.9 steps/s
[Step=44950 Epoch=172.2] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.569 | L2-Norm(final)=15.660 | 4581.6 samples/s | 71.6 steps/s
[Step=45000 Epoch=172.4] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.556 | L2-Norm(final)=15.661 | 5057.5 samples/s | 79.0 steps/s
[Step=45050 Epoch=172.6] | Loss=0.00001 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.542 | L2-Norm(final)=15.661 | 2110.2 samples/s | 33.0 steps/s
[Step=45100 Epoch=172.8] | Loss=0.00001 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=15.662 | 4508.2 samples/s | 70.4 steps/s
[Step=45150 Epoch=173.0] | Loss=0.00001 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=15.663 | 4423.2 samples/s | 69.1 steps/s
[Step=45200 Epoch=173.2] | Loss=0.00001 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=15.663 | 4517.4 samples/s | 70.6 steps/s
[Step=45250 Epoch=173.4] | Loss=0.00000 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=15.664 | 4576.3 samples/s | 71.5 steps/s
[Step=45300 Epoch=173.6] | Loss=0.00000 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=15.664 | 2194.8 samples/s | 34.3 steps/s
[Step=45350 Epoch=173.8] | Loss=0.00000 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=15.665 | 4597.8 samples/s | 71.8 steps/s
[Step=45400 Epoch=174.0] | Loss=0.00000 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.446 | L2-Norm(final)=15.665 | 4540.2 samples/s | 70.9 steps/s
[Step=45450 Epoch=174.1] | Loss=0.00000 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.431 | L2-Norm(final)=15.666 | 4532.9 samples/s | 70.8 steps/s
[Step=45500 Epoch=174.3] | Loss=0.00000 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.417 | L2-Norm(final)=15.666 | 4589.9 samples/s | 71.7 steps/s
[Step=45550 Epoch=174.5] | Loss=0.00000 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.403 | L2-Norm(final)=15.667 | 2189.8 samples/s | 34.2 steps/s
[Step=45600 Epoch=174.7] | Loss=0.00000 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.388 | L2-Norm(final)=15.667 | 4549.4 samples/s | 71.1 steps/s
[Step=45650 Epoch=174.9] | Loss=0.00000 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.374 | L2-Norm(final)=15.668 | 4569.0 samples/s | 71.4 steps/s
[Step=45700 Epoch=175.1] | Loss=0.00000 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.359 | L2-Norm(final)=15.668 | 4497.2 samples/s | 70.3 steps/s
[Step=45750 Epoch=175.3] | Loss=0.00000 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.344 | L2-Norm(final)=15.669 | 4567.7 samples/s | 71.4 steps/s
[Step=45800 Epoch=175.5] | Loss=0.00000 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.329 | L2-Norm(final)=15.669 | 6198.8 samples/s | 96.9 steps/s
[Step=45850 Epoch=175.7] | Loss=0.00000 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=15.670 | 1949.4 samples/s | 30.5 steps/s
[Step=45900 Epoch=175.9] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=15.670 | 4542.8 samples/s | 71.0 steps/s
[Step=45950 Epoch=176.1] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=15.671 | 4486.9 samples/s | 70.1 steps/s
[Step=46000 Epoch=176.3] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=15.671 | 4570.3 samples/s | 71.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step46000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=44001 Epoch=169.4] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=16.813 | 4707.9 samples/s | 73.6 steps/s
[Step=44050 Epoch=169.6] | Loss=0.00016 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=16.815 | 4682.4 samples/s | 73.2 steps/s
[Step=44100 Epoch=169.8] | Loss=0.00013 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=16.817 | 5238.2 samples/s | 81.8 steps/s
[Step=44150 Epoch=170.0] | Loss=0.00011 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=16.820 | 5253.2 samples/s | 82.1 steps/s
[Step=44200 Epoch=170.1] | Loss=0.00011 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=16.822 | 5141.1 samples/s | 80.3 steps/s
[Step=44250 Epoch=170.3] | Loss=0.00010 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=16.825 | 7014.1 samples/s | 109.6 steps/s
[Step=44300 Epoch=170.5] | Loss=0.00009 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=16.828 | 2121.6 samples/s | 33.1 steps/s
[Step=44350 Epoch=170.7] | Loss=0.00008 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=16.830 | 5402.0 samples/s | 84.4 steps/s
[Step=44400 Epoch=170.9] | Loss=0.00010 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=16.833 | 5090.4 samples/s | 79.5 steps/s
[Step=44450 Epoch=171.1] | Loss=0.00010 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=16.836 | 5208.0 samples/s | 81.4 steps/s
[Step=44500 Epoch=171.3] | Loss=0.00010 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=16.838 | 5970.6 samples/s | 93.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=44501 Epoch=171.3] | Loss=0.00002 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=16.866 | 4341.3 samples/s | 67.8 steps/s
[Step=44550 Epoch=171.5] | Loss=0.00004 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=16.869 | 4431.0 samples/s | 69.2 steps/s
[Step=44600 Epoch=171.7] | Loss=0.00003 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.669 | L2-Norm(final)=16.871 | 4541.4 samples/s | 71.0 steps/s
[Step=44650 Epoch=171.9] | Loss=0.00002 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.664 | L2-Norm(final)=16.872 | 4551.8 samples/s | 71.1 steps/s
[Step=44700 Epoch=172.1] | Loss=0.00002 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.660 | L2-Norm(final)=16.874 | 4529.1 samples/s | 70.8 steps/s
[Step=44750 Epoch=172.3] | Loss=0.00002 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.654 | L2-Norm(final)=16.875 | 5831.2 samples/s | 91.1 steps/s
[Step=44800 Epoch=172.5] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.649 | L2-Norm(final)=16.876 | 2001.8 samples/s | 31.3 steps/s
[Step=44850 Epoch=172.6] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.643 | L2-Norm(final)=16.876 | 4533.7 samples/s | 70.8 steps/s
[Step=44900 Epoch=172.8] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.637 | L2-Norm(final)=16.877 | 4554.2 samples/s | 71.2 steps/s
[Step=44950 Epoch=173.0] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.631 | L2-Norm(final)=16.878 | 4568.5 samples/s | 71.4 steps/s
[Step=45000 Epoch=173.2] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.624 | L2-Norm(final)=16.878 | 5118.1 samples/s | 80.0 steps/s
[Step=45050 Epoch=173.4] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.618 | L2-Norm(final)=16.878 | 2084.4 samples/s | 32.6 steps/s
[Step=45100 Epoch=173.6] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.611 | L2-Norm(final)=16.879 | 4524.0 samples/s | 70.7 steps/s
[Step=45150 Epoch=173.8] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.604 | L2-Norm(final)=16.879 | 4587.9 samples/s | 71.7 steps/s
[Step=45200 Epoch=174.0] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.597 | L2-Norm(final)=16.880 | 4577.8 samples/s | 71.5 steps/s
[Step=45250 Epoch=174.2] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.591 | L2-Norm(final)=16.880 | 4613.3 samples/s | 72.1 steps/s
[Step=45300 Epoch=174.4] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.584 | L2-Norm(final)=16.880 | 2158.2 samples/s | 33.7 steps/s
[Step=45350 Epoch=174.6] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=16.881 | 4530.5 samples/s | 70.8 steps/s
[Step=45400 Epoch=174.8] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.570 | L2-Norm(final)=16.881 | 4532.5 samples/s | 70.8 steps/s
[Step=45450 Epoch=175.0] | Loss=0.00000 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.562 | L2-Norm(final)=16.881 | 4552.2 samples/s | 71.1 steps/s
[Step=45500 Epoch=175.1] | Loss=0.00000 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.555 | L2-Norm(final)=16.882 | 4482.0 samples/s | 70.0 steps/s
[Step=45550 Epoch=175.3] | Loss=0.00000 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.548 | L2-Norm(final)=16.882 | 2181.6 samples/s | 34.1 steps/s
[Step=45600 Epoch=175.5] | Loss=0.00000 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.540 | L2-Norm(final)=16.882 | 4632.9 samples/s | 72.4 steps/s
[Step=45650 Epoch=175.7] | Loss=0.00000 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=16.883 | 4585.1 samples/s | 71.6 steps/s
[Step=45700 Epoch=175.9] | Loss=0.00000 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=16.883 | 4484.7 samples/s | 70.1 steps/s
[Step=45750 Epoch=176.1] | Loss=0.00000 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.518 | L2-Norm(final)=16.883 | 4516.8 samples/s | 70.6 steps/s
[Step=45800 Epoch=176.3] | Loss=0.00000 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.510 | L2-Norm(final)=16.884 | 6686.5 samples/s | 104.5 steps/s
[Step=45850 Epoch=176.5] | Loss=0.00000 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.502 | L2-Norm(final)=16.884 | 1907.7 samples/s | 29.8 steps/s
[Step=45900 Epoch=176.7] | Loss=0.00000 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=16.884 | 4555.4 samples/s | 71.2 steps/s
[Step=45950 Epoch=176.9] | Loss=0.00000 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=16.884 | 4568.1 samples/s | 71.4 steps/s
[Step=46000 Epoch=177.1] | Loss=0.00000 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=16.885 | 4523.7 samples/s | 70.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step46000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07438 | acc=0.9677 | tpr=0.9754 | fpr=0.0491 | 4147.0 samples/s | 16.2 steps/s
Avg test loss: 0.07271, Avg test acc: 0.96751, Avg tpr: 0.97546, Avg fpr: 0.04999, total FA: 390

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07881 | acc=0.9683 | tpr=0.9711 | fpr=0.0379 | 4246.4 samples/s | 16.6 steps/s
Avg test loss: 0.07913, Avg test acc: 0.96775, Avg tpr: 0.97173, Avg fpr: 0.04102, total FA: 320

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.33107 | acc=0.2923 | tpr=0.0087 | fpr=0.0917 | 4196.6 samples/s | 16.4 steps/s
Avg test loss: 7.33512, Avg test acc: 0.29009, Avg tpr: 0.00915, Avg fpr: 0.09204, total FA: 718

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.00026 | acc=0.2913 | tpr=0.0134 | fpr=0.1053 | 4207.9 samples/s | 16.4 steps/s
Avg test loss: 6.99836, Avg test acc: 0.28973, Avg tpr: 0.01434, Avg fpr: 0.10460, total FA: 816

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.32749 | acc=0.1319 | tpr=0.4602 | fpr=0.8740 | 4142.7 samples/s | 16.2 steps/s
[Step= 100] | Loss=6.25112 | acc=0.1338 | tpr=0.4435 | fpr=0.8720 | 8026.2 samples/s | 31.4 steps/s
[Step= 150] | Loss=6.25559 | acc=0.1335 | tpr=0.4597 | fpr=0.8725 | 7970.4 samples/s | 31.1 steps/s
[Step= 200] | Loss=6.24776 | acc=0.1339 | tpr=0.4579 | fpr=0.8720 | 7622.2 samples/s | 29.8 steps/s
[Step= 250] | Loss=6.24001 | acc=0.1334 | tpr=0.4489 | fpr=0.8724 | 8071.2 samples/s | 31.5 steps/s
[Step= 300] | Loss=6.24588 | acc=0.1326 | tpr=0.4509 | fpr=0.8732 | 7740.3 samples/s | 30.2 steps/s
[Step= 350] | Loss=6.25447 | acc=0.1321 | tpr=0.4527 | fpr=0.8738 | 7881.4 samples/s | 30.8 steps/s
[Step= 400] | Loss=6.24483 | acc=0.1320 | tpr=0.4409 | fpr=0.8737 | 7881.5 samples/s | 30.8 steps/s
[Step= 450] | Loss=6.24779 | acc=0.1314 | tpr=0.4396 | fpr=0.8742 | 7766.8 samples/s | 30.3 steps/s
[Step= 500] | Loss=6.25025 | acc=0.1312 | tpr=0.4405 | fpr=0.8744 | 7842.5 samples/s | 30.6 steps/s
[Step= 550] | Loss=6.25225 | acc=0.1313 | tpr=0.4409 | fpr=0.8744 | 14456.9 samples/s | 56.5 steps/s
Avg test loss: 6.25342, Avg test acc: 0.13121, Avg tpr: 0.44136, Avg fpr: 0.87443, total FA: 121413

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.67158 | acc=0.1391 | tpr=0.4735 | fpr=0.8669 | 4104.7 samples/s | 16.0 steps/s
[Step= 100] | Loss=6.59989 | acc=0.1406 | tpr=0.4819 | fpr=0.8658 | 7834.1 samples/s | 30.6 steps/s
[Step= 150] | Loss=6.61613 | acc=0.1412 | tpr=0.4899 | fpr=0.8652 | 7805.9 samples/s | 30.5 steps/s
[Step= 200] | Loss=6.60771 | acc=0.1411 | tpr=0.4940 | fpr=0.8653 | 7725.9 samples/s | 30.2 steps/s
[Step= 250] | Loss=6.60161 | acc=0.1407 | tpr=0.4882 | fpr=0.8656 | 7854.2 samples/s | 30.7 steps/s
[Step= 300] | Loss=6.61523 | acc=0.1405 | tpr=0.4873 | fpr=0.8659 | 7886.1 samples/s | 30.8 steps/s
[Step= 350] | Loss=6.62418 | acc=0.1401 | tpr=0.4859 | fpr=0.8662 | 7874.5 samples/s | 30.8 steps/s
[Step= 400] | Loss=6.61198 | acc=0.1395 | tpr=0.4732 | fpr=0.8666 | 8019.8 samples/s | 31.3 steps/s
[Step= 450] | Loss=6.61500 | acc=0.1392 | tpr=0.4727 | fpr=0.8668 | 7788.1 samples/s | 30.4 steps/s
[Step= 500] | Loss=6.61773 | acc=0.1390 | tpr=0.4767 | fpr=0.8671 | 7581.0 samples/s | 29.6 steps/s
[Step= 550] | Loss=6.61956 | acc=0.1393 | tpr=0.4779 | fpr=0.8669 | 14948.8 samples/s | 58.4 steps/s
Avg test loss: 6.61934, Avg test acc: 0.13921, Avg tpr: 0.47781, Avg fpr: 0.86695, total FA: 120374

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13110 | acc=0.9802 | tpr=0.9336 | fpr=0.0190 | 4204.0 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.14110 | acc=0.9788 | tpr=0.9424 | fpr=0.0205 | 7743.1 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.14311 | acc=0.9784 | tpr=0.9452 | fpr=0.0210 | 8276.8 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.14463 | acc=0.9787 | tpr=0.9497 | fpr=0.0208 | 7605.7 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.14375 | acc=0.9788 | tpr=0.9511 | fpr=0.0207 | 7888.7 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.14695 | acc=0.9786 | tpr=0.9513 | fpr=0.0209 | 7889.3 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.14739 | acc=0.9785 | tpr=0.9499 | fpr=0.0209 | 7910.4 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.14895 | acc=0.9782 | tpr=0.9491 | fpr=0.0212 | 7843.6 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.15085 | acc=0.9781 | tpr=0.9469 | fpr=0.0214 | 7664.4 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.14970 | acc=0.9782 | tpr=0.9480 | fpr=0.0212 | 7711.2 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.14859 | acc=0.9784 | tpr=0.9487 | fpr=0.0210 | 14252.9 samples/s | 55.7 steps/s
Avg test loss: 0.14828, Avg test acc: 0.97845, Avg tpr: 0.94889, Avg fpr: 0.02101, total FA: 2917

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15583 | acc=0.9776 | tpr=0.9425 | fpr=0.0218 | 4168.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.16755 | acc=0.9767 | tpr=0.9510 | fpr=0.0228 | 7819.5 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.17054 | acc=0.9765 | tpr=0.9568 | fpr=0.0232 | 7894.8 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.17258 | acc=0.9767 | tpr=0.9596 | fpr=0.0230 | 7753.1 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.17177 | acc=0.9766 | tpr=0.9590 | fpr=0.0231 | 7930.4 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.17576 | acc=0.9764 | tpr=0.9607 | fpr=0.0234 | 7861.5 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.17638 | acc=0.9763 | tpr=0.9580 | fpr=0.0234 | 8128.6 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.17805 | acc=0.9760 | tpr=0.9573 | fpr=0.0237 | 7799.2 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.18009 | acc=0.9758 | tpr=0.9542 | fpr=0.0238 | 7853.4 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.17864 | acc=0.9760 | tpr=0.9555 | fpr=0.0236 | 7701.1 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.17726 | acc=0.9763 | tpr=0.9562 | fpr=0.0234 | 14457.2 samples/s | 56.5 steps/s
Avg test loss: 0.17692, Avg test acc: 0.97630, Avg tpr: 0.95642, Avg fpr: 0.02334, total FA: 3241

server round 23/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=46001 Epoch=89.7] | Loss=0.01839 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.398 | L2-Norm(final)=16.669 | 4183.4 samples/s | 65.4 steps/s
[Step=46050 Epoch=89.8] | Loss=0.00824 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.399 | L2-Norm(final)=16.671 | 5391.2 samples/s | 84.2 steps/s
[Step=46100 Epoch=89.9] | Loss=0.00877 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.399 | L2-Norm(final)=16.673 | 5508.7 samples/s | 86.1 steps/s
[Step=46150 Epoch=90.0] | Loss=0.00857 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.399 | L2-Norm(final)=16.676 | 5585.3 samples/s | 87.3 steps/s
[Step=46200 Epoch=90.1] | Loss=0.00809 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.399 | L2-Norm(final)=16.679 | 5524.4 samples/s | 86.3 steps/s
[Step=46250 Epoch=90.2] | Loss=0.00795 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.399 | L2-Norm(final)=16.682 | 5434.2 samples/s | 84.9 steps/s
[Step=46300 Epoch=90.3] | Loss=0.00778 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.399 | L2-Norm(final)=16.687 | 5565.9 samples/s | 87.0 steps/s
[Step=46350 Epoch=90.4] | Loss=0.00775 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.399 | L2-Norm(final)=16.691 | 5548.6 samples/s | 86.7 steps/s
[Step=46400 Epoch=90.5] | Loss=0.00795 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.399 | L2-Norm(final)=16.696 | 5548.2 samples/s | 86.7 steps/s
[Step=46450 Epoch=90.6] | Loss=0.00812 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.399 | L2-Norm(final)=16.700 | 5574.6 samples/s | 87.1 steps/s
[Step=46500 Epoch=90.7] | Loss=0.00825 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.399 | L2-Norm(final)=16.704 | 6951.3 samples/s | 108.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=46501 Epoch=90.7] | Loss=0.00497 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.399 | L2-Norm(final)=16.741 | 4004.8 samples/s | 62.6 steps/s
[Step=46550 Epoch=90.8] | Loss=0.00790 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.417 | L2-Norm(final)=16.744 | 4872.4 samples/s | 76.1 steps/s
[Step=46600 Epoch=90.9] | Loss=0.00825 | Reg=0.00155 | acc=0.9531 | L2-Norm=12.430 | L2-Norm(final)=16.746 | 4840.9 samples/s | 75.6 steps/s
[Step=46650 Epoch=91.0] | Loss=0.00904 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=16.747 | 4791.3 samples/s | 74.9 steps/s
[Step=46700 Epoch=91.1] | Loss=0.01001 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.450 | L2-Norm(final)=16.746 | 4798.9 samples/s | 75.0 steps/s
[Step=46750 Epoch=91.2] | Loss=0.01026 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=16.746 | 4851.3 samples/s | 75.8 steps/s
[Step=46800 Epoch=91.3] | Loss=0.01036 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.468 | L2-Norm(final)=16.746 | 4813.8 samples/s | 75.2 steps/s
[Step=46850 Epoch=91.4] | Loss=0.01020 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=16.746 | 4841.9 samples/s | 75.7 steps/s
[Step=46900 Epoch=91.5] | Loss=0.01011 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=16.747 | 4827.9 samples/s | 75.4 steps/s
[Step=46950 Epoch=91.6] | Loss=0.01046 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.489 | L2-Norm(final)=16.747 | 4724.2 samples/s | 73.8 steps/s
[Step=47000 Epoch=91.7] | Loss=0.01043 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.495 | L2-Norm(final)=16.748 | 5869.3 samples/s | 91.7 steps/s
[Step=47050 Epoch=91.8] | Loss=0.01029 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.501 | L2-Norm(final)=16.748 | 2005.0 samples/s | 31.3 steps/s
[Step=47100 Epoch=91.9] | Loss=0.00996 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=16.749 | 4786.5 samples/s | 74.8 steps/s
[Step=47150 Epoch=92.0] | Loss=0.00987 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.511 | L2-Norm(final)=16.750 | 4790.0 samples/s | 74.8 steps/s
[Step=47200 Epoch=92.1] | Loss=0.00977 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=16.751 | 4766.5 samples/s | 74.5 steps/s
[Step=47250 Epoch=92.2] | Loss=0.00964 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=16.752 | 4782.1 samples/s | 74.7 steps/s
[Step=47300 Epoch=92.3] | Loss=0.00956 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=16.753 | 4822.4 samples/s | 75.3 steps/s
[Step=47350 Epoch=92.4] | Loss=0.00950 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.528 | L2-Norm(final)=16.755 | 4770.0 samples/s | 74.5 steps/s
[Step=47400 Epoch=92.4] | Loss=0.00948 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=16.756 | 4771.2 samples/s | 74.5 steps/s
[Step=47450 Epoch=92.5] | Loss=0.00951 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.536 | L2-Norm(final)=16.757 | 4820.3 samples/s | 75.3 steps/s
[Step=47500 Epoch=92.6] | Loss=0.00948 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.540 | L2-Norm(final)=16.757 | 5074.1 samples/s | 79.3 steps/s
[Step=47550 Epoch=92.7] | Loss=0.00928 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.544 | L2-Norm(final)=16.758 | 2110.0 samples/s | 33.0 steps/s
[Step=47600 Epoch=92.8] | Loss=0.00908 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.548 | L2-Norm(final)=16.760 | 4807.0 samples/s | 75.1 steps/s
[Step=47650 Epoch=92.9] | Loss=0.00901 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=16.761 | 4727.8 samples/s | 73.9 steps/s
[Step=47700 Epoch=93.0] | Loss=0.00886 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.555 | L2-Norm(final)=16.762 | 4780.7 samples/s | 74.7 steps/s
[Step=47750 Epoch=93.1] | Loss=0.00879 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=16.763 | 4812.4 samples/s | 75.2 steps/s
[Step=47800 Epoch=93.2] | Loss=0.00874 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.561 | L2-Norm(final)=16.764 | 4755.4 samples/s | 74.3 steps/s
[Step=47850 Epoch=93.3] | Loss=0.00865 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.564 | L2-Norm(final)=16.765 | 4790.0 samples/s | 74.8 steps/s
[Step=47900 Epoch=93.4] | Loss=0.00861 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.567 | L2-Norm(final)=16.766 | 4819.1 samples/s | 75.3 steps/s
[Step=47950 Epoch=93.5] | Loss=0.00858 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.570 | L2-Norm(final)=16.767 | 4801.8 samples/s | 75.0 steps/s
[Step=48000 Epoch=93.6] | Loss=0.00850 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.573 | L2-Norm(final)=16.767 | 4777.6 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step48000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=46001 Epoch=89.9] | Loss=0.01601 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.398 | L2-Norm(final)=16.922 | 4742.9 samples/s | 74.1 steps/s
[Step=46050 Epoch=90.0] | Loss=0.00745 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.398 | L2-Norm(final)=16.922 | 5319.0 samples/s | 83.1 steps/s
[Step=46100 Epoch=90.1] | Loss=0.00729 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=16.924 | 5357.1 samples/s | 83.7 steps/s
[Step=46150 Epoch=90.2] | Loss=0.00763 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=16.928 | 5474.2 samples/s | 85.5 steps/s
[Step=46200 Epoch=90.3] | Loss=0.00804 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=16.931 | 5533.5 samples/s | 86.5 steps/s
[Step=46250 Epoch=90.4] | Loss=0.00801 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=16.934 | 5555.1 samples/s | 86.8 steps/s
[Step=46300 Epoch=90.5] | Loss=0.00800 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=16.937 | 5593.0 samples/s | 87.4 steps/s
[Step=46350 Epoch=90.6] | Loss=0.00812 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=16.940 | 5589.3 samples/s | 87.3 steps/s
[Step=46400 Epoch=90.7] | Loss=0.00804 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=16.944 | 5366.1 samples/s | 83.8 steps/s
[Step=46450 Epoch=90.8] | Loss=0.00807 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=16.947 | 5527.1 samples/s | 86.4 steps/s
[Step=46500 Epoch=90.9] | Loss=0.00799 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=16.951 | 7082.0 samples/s | 110.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=46501 Epoch=90.9] | Loss=0.00650 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=16.987 | 5204.0 samples/s | 81.3 steps/s
[Step=46550 Epoch=91.0] | Loss=0.00653 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.415 | L2-Norm(final)=16.988 | 4452.0 samples/s | 69.6 steps/s
[Step=46600 Epoch=91.1] | Loss=0.00757 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=16.989 | 4712.2 samples/s | 73.6 steps/s
[Step=46650 Epoch=91.2] | Loss=0.00711 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.433 | L2-Norm(final)=16.990 | 4769.5 samples/s | 74.5 steps/s
[Step=46700 Epoch=91.3] | Loss=0.00879 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.441 | L2-Norm(final)=16.990 | 4734.5 samples/s | 74.0 steps/s
[Step=46750 Epoch=91.4] | Loss=0.00910 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.449 | L2-Norm(final)=16.990 | 4808.7 samples/s | 75.1 steps/s
[Step=46800 Epoch=91.5] | Loss=0.00906 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.456 | L2-Norm(final)=16.990 | 4754.3 samples/s | 74.3 steps/s
[Step=46850 Epoch=91.6] | Loss=0.00934 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.463 | L2-Norm(final)=16.989 | 4801.6 samples/s | 75.0 steps/s
[Step=46900 Epoch=91.7] | Loss=0.00976 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.469 | L2-Norm(final)=16.989 | 4780.5 samples/s | 74.7 steps/s
[Step=46950 Epoch=91.8] | Loss=0.00979 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=16.988 | 4792.8 samples/s | 74.9 steps/s
[Step=47000 Epoch=91.9] | Loss=0.00963 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=16.988 | 5925.3 samples/s | 92.6 steps/s
[Step=47050 Epoch=92.0] | Loss=0.00980 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.486 | L2-Norm(final)=16.989 | 2035.3 samples/s | 31.8 steps/s
[Step=47100 Epoch=92.1] | Loss=0.00957 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=16.989 | 4747.3 samples/s | 74.2 steps/s
[Step=47150 Epoch=92.2] | Loss=0.00927 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.496 | L2-Norm(final)=16.990 | 4739.6 samples/s | 74.1 steps/s
[Step=47200 Epoch=92.3] | Loss=0.00901 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.500 | L2-Norm(final)=16.991 | 4817.5 samples/s | 75.3 steps/s
[Step=47250 Epoch=92.4] | Loss=0.00881 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.504 | L2-Norm(final)=16.992 | 4694.4 samples/s | 73.4 steps/s
[Step=47300 Epoch=92.5] | Loss=0.00881 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.508 | L2-Norm(final)=16.993 | 4819.2 samples/s | 75.3 steps/s
[Step=47350 Epoch=92.6] | Loss=0.00883 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.511 | L2-Norm(final)=16.994 | 4749.6 samples/s | 74.2 steps/s
[Step=47400 Epoch=92.7] | Loss=0.00880 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=16.995 | 4768.5 samples/s | 74.5 steps/s
[Step=47450 Epoch=92.8] | Loss=0.00874 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=16.995 | 4842.6 samples/s | 75.7 steps/s
[Step=47500 Epoch=92.9] | Loss=0.00870 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.522 | L2-Norm(final)=16.996 | 5105.3 samples/s | 79.8 steps/s
[Step=47550 Epoch=93.0] | Loss=0.00863 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=16.997 | 2159.5 samples/s | 33.7 steps/s
[Step=47600 Epoch=93.1] | Loss=0.00852 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=16.998 | 4716.3 samples/s | 73.7 steps/s
[Step=47650 Epoch=93.2] | Loss=0.00840 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.532 | L2-Norm(final)=16.999 | 4796.6 samples/s | 74.9 steps/s
[Step=47700 Epoch=93.3] | Loss=0.00831 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=16.999 | 4771.0 samples/s | 74.5 steps/s
[Step=47750 Epoch=93.4] | Loss=0.00820 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.538 | L2-Norm(final)=17.000 | 4772.2 samples/s | 74.6 steps/s
[Step=47800 Epoch=93.4] | Loss=0.00810 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.541 | L2-Norm(final)=17.001 | 4753.3 samples/s | 74.3 steps/s
[Step=47850 Epoch=93.5] | Loss=0.00816 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.544 | L2-Norm(final)=17.002 | 4809.1 samples/s | 75.1 steps/s
[Step=47900 Epoch=93.6] | Loss=0.00811 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.546 | L2-Norm(final)=17.002 | 4803.1 samples/s | 75.0 steps/s
[Step=47950 Epoch=93.7] | Loss=0.00805 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=17.003 | 4757.3 samples/s | 74.3 steps/s
[Step=48000 Epoch=93.8] | Loss=0.00800 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.552 | L2-Norm(final)=17.003 | 4791.0 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step48000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=46001 Epoch=176.3] | Loss=0.00001 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=15.685 | 4192.1 samples/s | 65.5 steps/s
[Step=46050 Epoch=176.4] | Loss=0.00041 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.393 | L2-Norm(final)=15.693 | 4883.5 samples/s | 76.3 steps/s
[Step=46100 Epoch=176.6] | Loss=0.00032 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=15.702 | 5004.2 samples/s | 78.2 steps/s
[Step=46150 Epoch=176.8] | Loss=0.00027 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=15.707 | 5360.4 samples/s | 83.8 steps/s
[Step=46200 Epoch=177.0] | Loss=0.00023 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=15.713 | 5079.0 samples/s | 79.4 steps/s
[Step=46250 Epoch=177.2] | Loss=0.00026 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=15.720 | 6771.0 samples/s | 105.8 steps/s
[Step=46300 Epoch=177.4] | Loss=0.00025 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=15.726 | 2140.9 samples/s | 33.5 steps/s
[Step=46350 Epoch=177.6] | Loss=0.00023 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=15.731 | 5246.2 samples/s | 82.0 steps/s
[Step=46400 Epoch=177.8] | Loss=0.00021 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=15.736 | 5278.2 samples/s | 82.5 steps/s
[Step=46450 Epoch=178.0] | Loss=0.00020 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=15.740 | 5187.8 samples/s | 81.1 steps/s
[Step=46500 Epoch=178.2] | Loss=0.00021 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=15.745 | 5777.7 samples/s | 90.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=46501 Epoch=178.2] | Loss=0.00000 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=15.790 | 4377.0 samples/s | 68.4 steps/s
[Step=46550 Epoch=178.4] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.381 | L2-Norm(final)=15.792 | 4544.8 samples/s | 71.0 steps/s
[Step=46600 Epoch=178.6] | Loss=0.00030 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.358 | L2-Norm(final)=15.792 | 4592.1 samples/s | 71.8 steps/s
[Step=46650 Epoch=178.7] | Loss=0.00173 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.368 | L2-Norm(final)=15.783 | 4593.1 samples/s | 71.8 steps/s
[Step=46700 Epoch=178.9] | Loss=0.00158 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.383 | L2-Norm(final)=15.775 | 4496.8 samples/s | 70.3 steps/s
[Step=46750 Epoch=179.1] | Loss=0.00128 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.393 | L2-Norm(final)=15.771 | 5699.5 samples/s | 89.1 steps/s
[Step=46800 Epoch=179.3] | Loss=0.00107 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.399 | L2-Norm(final)=15.769 | 2003.4 samples/s | 31.3 steps/s
[Step=46850 Epoch=179.5] | Loss=0.00092 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=15.768 | 4571.1 samples/s | 71.4 steps/s
[Step=46900 Epoch=179.7] | Loss=0.00081 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.403 | L2-Norm(final)=15.767 | 4468.0 samples/s | 69.8 steps/s
[Step=46950 Epoch=179.9] | Loss=0.00072 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.403 | L2-Norm(final)=15.766 | 4579.7 samples/s | 71.6 steps/s
[Step=47000 Epoch=180.1] | Loss=0.00065 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=15.766 | 5029.4 samples/s | 78.6 steps/s
[Step=47050 Epoch=180.3] | Loss=0.00059 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.401 | L2-Norm(final)=15.766 | 2105.4 samples/s | 32.9 steps/s
[Step=47100 Epoch=180.5] | Loss=0.00054 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.399 | L2-Norm(final)=15.767 | 4490.9 samples/s | 70.2 steps/s
[Step=47150 Epoch=180.7] | Loss=0.00050 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.396 | L2-Norm(final)=15.767 | 4548.0 samples/s | 71.1 steps/s
[Step=47200 Epoch=180.9] | Loss=0.00047 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.394 | L2-Norm(final)=15.767 | 4551.4 samples/s | 71.1 steps/s
[Step=47250 Epoch=181.0] | Loss=0.00043 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.391 | L2-Norm(final)=15.768 | 4527.6 samples/s | 70.7 steps/s
[Step=47300 Epoch=181.2] | Loss=0.00041 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.388 | L2-Norm(final)=15.768 | 2202.0 samples/s | 34.4 steps/s
[Step=47350 Epoch=181.4] | Loss=0.00038 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.384 | L2-Norm(final)=15.769 | 4651.2 samples/s | 72.7 steps/s
[Step=47400 Epoch=181.6] | Loss=0.00036 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.381 | L2-Norm(final)=15.769 | 4481.0 samples/s | 70.0 steps/s
[Step=47450 Epoch=181.8] | Loss=0.00034 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.377 | L2-Norm(final)=15.770 | 4626.3 samples/s | 72.3 steps/s
[Step=47500 Epoch=182.0] | Loss=0.00033 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=15.771 | 4528.6 samples/s | 70.8 steps/s
[Step=47550 Epoch=182.2] | Loss=0.00031 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=15.772 | 2215.8 samples/s | 34.6 steps/s
[Step=47600 Epoch=182.4] | Loss=0.00030 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.365 | L2-Norm(final)=15.773 | 4531.8 samples/s | 70.8 steps/s
[Step=47650 Epoch=182.6] | Loss=0.00028 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.361 | L2-Norm(final)=15.774 | 4582.5 samples/s | 71.6 steps/s
[Step=47700 Epoch=182.8] | Loss=0.00027 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.357 | L2-Norm(final)=15.775 | 4591.1 samples/s | 71.7 steps/s
[Step=47750 Epoch=183.0] | Loss=0.00026 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.353 | L2-Norm(final)=15.776 | 4460.6 samples/s | 69.7 steps/s
[Step=47800 Epoch=183.2] | Loss=0.00025 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.349 | L2-Norm(final)=15.777 | 6140.0 samples/s | 95.9 steps/s
[Step=47850 Epoch=183.3] | Loss=0.00024 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.344 | L2-Norm(final)=15.778 | 1929.7 samples/s | 30.2 steps/s
[Step=47900 Epoch=183.5] | Loss=0.00023 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.340 | L2-Norm(final)=15.780 | 4559.2 samples/s | 71.2 steps/s
[Step=47950 Epoch=183.7] | Loss=0.00023 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.335 | L2-Norm(final)=15.781 | 4579.4 samples/s | 71.6 steps/s
[Step=48000 Epoch=183.9] | Loss=0.00022 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.331 | L2-Norm(final)=15.782 | 4560.9 samples/s | 71.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step48000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=46001 Epoch=177.1] | Loss=0.00011 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=16.893 | 4290.7 samples/s | 67.0 steps/s
[Step=46050 Epoch=177.3] | Loss=0.00005 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.396 | L2-Norm(final)=16.895 | 4776.6 samples/s | 74.6 steps/s
[Step=46100 Epoch=177.5] | Loss=0.00030 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=16.903 | 5040.3 samples/s | 78.8 steps/s
[Step=46150 Epoch=177.6] | Loss=0.00032 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=16.913 | 5098.3 samples/s | 79.7 steps/s
[Step=46200 Epoch=177.8] | Loss=0.00036 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=16.922 | 5164.7 samples/s | 80.7 steps/s
[Step=46250 Epoch=178.0] | Loss=0.00033 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=16.930 | 6987.2 samples/s | 109.2 steps/s
[Step=46300 Epoch=178.2] | Loss=0.00034 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=16.936 | 2126.6 samples/s | 33.2 steps/s
[Step=46350 Epoch=178.4] | Loss=0.00031 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=16.942 | 5170.4 samples/s | 80.8 steps/s
[Step=46400 Epoch=178.6] | Loss=0.00029 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=16.947 | 5282.2 samples/s | 82.5 steps/s
[Step=46450 Epoch=178.8] | Loss=0.00030 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=16.952 | 5191.9 samples/s | 81.1 steps/s
[Step=46500 Epoch=179.0] | Loss=0.00028 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=16.957 | 5986.9 samples/s | 93.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=46501 Epoch=179.0] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=17.004 | 4911.4 samples/s | 76.7 steps/s
[Step=46550 Epoch=179.2] | Loss=0.00003 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.394 | L2-Norm(final)=17.006 | 4053.0 samples/s | 63.3 steps/s
[Step=46600 Epoch=179.4] | Loss=0.00003 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.387 | L2-Norm(final)=17.006 | 4567.2 samples/s | 71.4 steps/s
[Step=46650 Epoch=179.6] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.376 | L2-Norm(final)=17.007 | 4523.9 samples/s | 70.7 steps/s
[Step=46700 Epoch=179.8] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.363 | L2-Norm(final)=17.007 | 4549.6 samples/s | 71.1 steps/s
[Step=46750 Epoch=180.0] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.350 | L2-Norm(final)=17.007 | 5809.1 samples/s | 90.8 steps/s
[Step=46800 Epoch=180.2] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=17.007 | 1993.5 samples/s | 31.1 steps/s
[Step=46850 Epoch=180.3] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=17.008 | 4546.5 samples/s | 71.0 steps/s
[Step=46900 Epoch=180.5] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.308 | L2-Norm(final)=17.008 | 4524.0 samples/s | 70.7 steps/s
[Step=46950 Epoch=180.7] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=17.008 | 4526.1 samples/s | 70.7 steps/s
[Step=47000 Epoch=180.9] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=17.008 | 5134.9 samples/s | 80.2 steps/s
[Step=47050 Epoch=181.1] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=17.008 | 2111.5 samples/s | 33.0 steps/s
[Step=47100 Epoch=181.3] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=17.009 | 4487.5 samples/s | 70.1 steps/s
[Step=47150 Epoch=181.5] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=17.009 | 4552.5 samples/s | 71.1 steps/s
[Step=47200 Epoch=181.7] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.222 | L2-Norm(final)=17.009 | 4514.7 samples/s | 70.5 steps/s
[Step=47250 Epoch=181.9] | Loss=0.00000 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.207 | L2-Norm(final)=17.009 | 4644.1 samples/s | 72.6 steps/s
[Step=47300 Epoch=182.1] | Loss=0.00000 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.192 | L2-Norm(final)=17.010 | 2156.4 samples/s | 33.7 steps/s
[Step=47350 Epoch=182.3] | Loss=0.00000 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=17.010 | 4575.3 samples/s | 71.5 steps/s
[Step=47400 Epoch=182.5] | Loss=0.00000 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=17.010 | 4571.9 samples/s | 71.4 steps/s
[Step=47450 Epoch=182.7] | Loss=0.00000 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=17.011 | 4543.8 samples/s | 71.0 steps/s
[Step=47500 Epoch=182.8] | Loss=0.00000 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.131 | L2-Norm(final)=17.011 | 4527.2 samples/s | 70.7 steps/s
[Step=47550 Epoch=183.0] | Loss=0.00000 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.116 | L2-Norm(final)=17.011 | 2209.9 samples/s | 34.5 steps/s
[Step=47600 Epoch=183.2] | Loss=0.00000 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=17.012 | 4537.9 samples/s | 70.9 steps/s
[Step=47650 Epoch=183.4] | Loss=0.00000 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.085 | L2-Norm(final)=17.012 | 4496.7 samples/s | 70.3 steps/s
[Step=47700 Epoch=183.6] | Loss=0.00000 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.069 | L2-Norm(final)=17.012 | 4570.9 samples/s | 71.4 steps/s
[Step=47750 Epoch=183.8] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.053 | L2-Norm(final)=17.013 | 4533.4 samples/s | 70.8 steps/s
[Step=47800 Epoch=184.0] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.037 | L2-Norm(final)=17.013 | 6686.9 samples/s | 104.5 steps/s
[Step=47850 Epoch=184.2] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.021 | L2-Norm(final)=17.014 | 1893.2 samples/s | 29.6 steps/s
[Step=47900 Epoch=184.4] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.005 | L2-Norm(final)=17.014 | 4536.9 samples/s | 70.9 steps/s
[Step=47950 Epoch=184.6] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.988 | L2-Norm(final)=17.014 | 4538.6 samples/s | 70.9 steps/s
[Step=48000 Epoch=184.8] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=17.015 | 4557.5 samples/s | 71.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step48000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07979 | acc=0.9688 | tpr=0.9764 | fpr=0.0476 | 4175.9 samples/s | 16.3 steps/s
Avg test loss: 0.07624, Avg test acc: 0.96855, Avg tpr: 0.97698, Avg fpr: 0.04999, total FA: 390

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07801 | acc=0.9684 | tpr=0.9724 | fpr=0.0404 | 4185.8 samples/s | 16.4 steps/s
Avg test loss: 0.07668, Avg test acc: 0.96831, Avg tpr: 0.97296, Avg fpr: 0.04192, total FA: 327

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.37441 | acc=0.3003 | tpr=0.0064 | fpr=0.0614 | 4138.4 samples/s | 16.2 steps/s
Avg test loss: 7.38105, Avg test acc: 0.29750, Avg tpr: 0.00641, Avg fpr: 0.06230, total FA: 486

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.62178 | acc=0.2882 | tpr=0.0123 | fpr=0.1127 | 4194.6 samples/s | 16.4 steps/s
Avg test loss: 6.62104, Avg test acc: 0.28672, Avg tpr: 0.01306, Avg fpr: 0.11140, total FA: 869

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.83888 | acc=0.1254 | tpr=0.5531 | fpr=0.8823 | 4225.2 samples/s | 16.5 steps/s
[Step= 100] | Loss=6.76524 | acc=0.1260 | tpr=0.5501 | fpr=0.8819 | 7710.3 samples/s | 30.1 steps/s
[Step= 150] | Loss=6.77427 | acc=0.1251 | tpr=0.5519 | fpr=0.8828 | 7752.8 samples/s | 30.3 steps/s
[Step= 200] | Loss=6.76774 | acc=0.1258 | tpr=0.5530 | fpr=0.8820 | 7929.2 samples/s | 31.0 steps/s
[Step= 250] | Loss=6.76025 | acc=0.1255 | tpr=0.5485 | fpr=0.8822 | 7839.2 samples/s | 30.6 steps/s
[Step= 300] | Loss=6.76821 | acc=0.1250 | tpr=0.5455 | fpr=0.8827 | 7757.1 samples/s | 30.3 steps/s
[Step= 350] | Loss=6.77827 | acc=0.1248 | tpr=0.5423 | fpr=0.8828 | 7900.9 samples/s | 30.9 steps/s
[Step= 400] | Loss=6.76528 | acc=0.1245 | tpr=0.5284 | fpr=0.8829 | 7878.6 samples/s | 30.8 steps/s
[Step= 450] | Loss=6.76919 | acc=0.1239 | tpr=0.5273 | fpr=0.8834 | 7914.6 samples/s | 30.9 steps/s
[Step= 500] | Loss=6.77202 | acc=0.1237 | tpr=0.5308 | fpr=0.8836 | 7740.6 samples/s | 30.2 steps/s
[Step= 550] | Loss=6.77369 | acc=0.1239 | tpr=0.5360 | fpr=0.8836 | 14616.4 samples/s | 57.1 steps/s
Avg test loss: 6.77463, Avg test acc: 0.12387, Avg tpr: 0.53645, Avg fpr: 0.88363, total FA: 122690

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.44067 | acc=0.1427 | tpr=0.5487 | fpr=0.8646 | 4232.2 samples/s | 16.5 steps/s
[Step= 100] | Loss=6.37211 | acc=0.1427 | tpr=0.5522 | fpr=0.8649 | 7682.0 samples/s | 30.0 steps/s
[Step= 150] | Loss=6.38911 | acc=0.1421 | tpr=0.5519 | fpr=0.8655 | 8014.0 samples/s | 31.3 steps/s
[Step= 200] | Loss=6.38175 | acc=0.1423 | tpr=0.5508 | fpr=0.8651 | 7846.5 samples/s | 30.7 steps/s
[Step= 250] | Loss=6.37784 | acc=0.1417 | tpr=0.5511 | fpr=0.8658 | 7737.1 samples/s | 30.2 steps/s
[Step= 300] | Loss=6.38888 | acc=0.1413 | tpr=0.5520 | fpr=0.8662 | 7912.8 samples/s | 30.9 steps/s
[Step= 350] | Loss=6.40042 | acc=0.1405 | tpr=0.5560 | fpr=0.8671 | 7906.9 samples/s | 30.9 steps/s
[Step= 400] | Loss=6.38968 | acc=0.1400 | tpr=0.5465 | fpr=0.8674 | 7760.8 samples/s | 30.3 steps/s
[Step= 450] | Loss=6.39284 | acc=0.1394 | tpr=0.5448 | fpr=0.8680 | 7781.8 samples/s | 30.4 steps/s
[Step= 500] | Loss=6.39573 | acc=0.1391 | tpr=0.5467 | fpr=0.8683 | 7881.1 samples/s | 30.8 steps/s
[Step= 550] | Loss=6.39733 | acc=0.1393 | tpr=0.5480 | fpr=0.8681 | 14349.6 samples/s | 56.1 steps/s
Avg test loss: 6.39789, Avg test acc: 0.13923, Avg tpr: 0.54834, Avg fpr: 0.86821, total FA: 120549

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11894 | acc=0.9814 | tpr=0.9425 | fpr=0.0179 | 4204.8 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.12525 | acc=0.9804 | tpr=0.9552 | fpr=0.0192 | 7778.0 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.12762 | acc=0.9797 | tpr=0.9524 | fpr=0.0198 | 7957.7 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.12922 | acc=0.9799 | tpr=0.9552 | fpr=0.0197 | 7831.0 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.12837 | acc=0.9800 | tpr=0.9520 | fpr=0.0195 | 7813.8 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.13095 | acc=0.9798 | tpr=0.9535 | fpr=0.0197 | 8162.0 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.13229 | acc=0.9797 | tpr=0.9530 | fpr=0.0198 | 7850.7 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.13362 | acc=0.9795 | tpr=0.9519 | fpr=0.0200 | 7718.2 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.13569 | acc=0.9792 | tpr=0.9503 | fpr=0.0202 | 7827.0 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.13476 | acc=0.9794 | tpr=0.9515 | fpr=0.0201 | 7610.7 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.13371 | acc=0.9796 | tpr=0.9515 | fpr=0.0199 | 15048.1 samples/s | 58.8 steps/s
Avg test loss: 0.13338, Avg test acc: 0.97959, Avg tpr: 0.95127, Avg fpr: 0.01989, total FA: 2762

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15007 | acc=0.9783 | tpr=0.9425 | fpr=0.0211 | 4169.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.16100 | acc=0.9771 | tpr=0.9488 | fpr=0.0224 | 7997.1 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.16355 | acc=0.9767 | tpr=0.9568 | fpr=0.0229 | 7761.8 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.16558 | acc=0.9769 | tpr=0.9596 | fpr=0.0228 | 7912.8 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.16499 | acc=0.9766 | tpr=0.9590 | fpr=0.0230 | 7671.4 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.16886 | acc=0.9763 | tpr=0.9607 | fpr=0.0234 | 8008.3 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.16945 | acc=0.9762 | tpr=0.9580 | fpr=0.0235 | 7745.7 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.17106 | acc=0.9758 | tpr=0.9573 | fpr=0.0238 | 7901.4 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.17311 | acc=0.9756 | tpr=0.9542 | fpr=0.0240 | 7772.4 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.17182 | acc=0.9758 | tpr=0.9546 | fpr=0.0238 | 7910.6 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.17045 | acc=0.9760 | tpr=0.9542 | fpr=0.0236 | 14224.0 samples/s | 55.6 steps/s
Avg test loss: 0.17013, Avg test acc: 0.97606, Avg tpr: 0.95444, Avg fpr: 0.02354, total FA: 3269

server round 24/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=48001 Epoch=93.6] | Loss=0.00821 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.157 | L2-Norm(final)=16.792 | 4217.5 samples/s | 65.9 steps/s
[Step=48050 Epoch=93.7] | Loss=0.00779 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=16.795 | 5099.0 samples/s | 79.7 steps/s
[Step=48100 Epoch=93.8] | Loss=0.00950 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=16.796 | 5520.6 samples/s | 86.3 steps/s
[Step=48150 Epoch=93.9] | Loss=0.00954 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.158 | L2-Norm(final)=16.798 | 5428.5 samples/s | 84.8 steps/s
[Step=48200 Epoch=94.0] | Loss=0.00952 | Reg=0.00148 | acc=0.9531 | L2-Norm=12.158 | L2-Norm(final)=16.801 | 5503.9 samples/s | 86.0 steps/s
[Step=48250 Epoch=94.1] | Loss=0.00936 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.158 | L2-Norm(final)=16.805 | 5469.7 samples/s | 85.5 steps/s
[Step=48300 Epoch=94.2] | Loss=0.00912 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.158 | L2-Norm(final)=16.809 | 5532.4 samples/s | 86.4 steps/s
[Step=48350 Epoch=94.3] | Loss=0.00935 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=16.813 | 5574.8 samples/s | 87.1 steps/s
[Step=48400 Epoch=94.4] | Loss=0.00913 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.158 | L2-Norm(final)=16.818 | 5500.4 samples/s | 85.9 steps/s
[Step=48450 Epoch=94.5] | Loss=0.00892 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=16.822 | 5552.7 samples/s | 86.8 steps/s
[Step=48500 Epoch=94.6] | Loss=0.00890 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=16.827 | 7037.9 samples/s | 110.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=48501 Epoch=94.6] | Loss=0.02081 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.158 | L2-Norm(final)=16.871 | 4561.8 samples/s | 71.3 steps/s
[Step=48550 Epoch=94.7] | Loss=0.01099 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.182 | L2-Norm(final)=16.873 | 4426.1 samples/s | 69.2 steps/s
[Step=48600 Epoch=94.8] | Loss=0.00992 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.200 | L2-Norm(final)=16.871 | 4793.8 samples/s | 74.9 steps/s
[Step=48650 Epoch=94.9] | Loss=0.00998 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.212 | L2-Norm(final)=16.869 | 4808.6 samples/s | 75.1 steps/s
[Step=48700 Epoch=95.0] | Loss=0.01033 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.223 | L2-Norm(final)=16.869 | 4734.7 samples/s | 74.0 steps/s
[Step=48750 Epoch=95.1] | Loss=0.01019 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=16.870 | 4807.4 samples/s | 75.1 steps/s
[Step=48800 Epoch=95.2] | Loss=0.01024 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.240 | L2-Norm(final)=16.871 | 4787.2 samples/s | 74.8 steps/s
[Step=48850 Epoch=95.3] | Loss=0.01019 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.248 | L2-Norm(final)=16.872 | 4850.9 samples/s | 75.8 steps/s
[Step=48900 Epoch=95.4] | Loss=0.01034 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.255 | L2-Norm(final)=16.873 | 4805.3 samples/s | 75.1 steps/s
[Step=48950 Epoch=95.5] | Loss=0.01029 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.262 | L2-Norm(final)=16.874 | 4746.8 samples/s | 74.2 steps/s
[Step=49000 Epoch=95.6] | Loss=0.01092 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=16.874 | 5833.6 samples/s | 91.1 steps/s
[Step=49050 Epoch=95.7] | Loss=0.01067 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=16.874 | 2042.3 samples/s | 31.9 steps/s
[Step=49100 Epoch=95.8] | Loss=0.01027 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=16.875 | 4812.5 samples/s | 75.2 steps/s
[Step=49150 Epoch=95.9] | Loss=0.01014 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.286 | L2-Norm(final)=16.875 | 4806.1 samples/s | 75.1 steps/s
[Step=49200 Epoch=96.0] | Loss=0.01007 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.290 | L2-Norm(final)=16.876 | 4768.7 samples/s | 74.5 steps/s
[Step=49250 Epoch=96.1] | Loss=0.00986 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.294 | L2-Norm(final)=16.876 | 4816.1 samples/s | 75.3 steps/s
[Step=49300 Epoch=96.2] | Loss=0.00978 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=16.877 | 4784.3 samples/s | 74.8 steps/s
[Step=49350 Epoch=96.3] | Loss=0.00966 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=16.877 | 4791.5 samples/s | 74.9 steps/s
[Step=49400 Epoch=96.3] | Loss=0.00948 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=16.878 | 4767.7 samples/s | 74.5 steps/s
[Step=49450 Epoch=96.4] | Loss=0.00952 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.311 | L2-Norm(final)=16.878 | 4812.0 samples/s | 75.2 steps/s
[Step=49500 Epoch=96.5] | Loss=0.00944 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=16.879 | 5105.2 samples/s | 79.8 steps/s
[Step=49550 Epoch=96.6] | Loss=0.00937 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.319 | L2-Norm(final)=16.880 | 2171.5 samples/s | 33.9 steps/s
[Step=49600 Epoch=96.7] | Loss=0.00937 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=16.880 | 4866.6 samples/s | 76.0 steps/s
[Step=49650 Epoch=96.8] | Loss=0.00925 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.326 | L2-Norm(final)=16.881 | 4758.4 samples/s | 74.4 steps/s
[Step=49700 Epoch=96.9] | Loss=0.00913 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.329 | L2-Norm(final)=16.882 | 4781.4 samples/s | 74.7 steps/s
[Step=49750 Epoch=97.0] | Loss=0.00904 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.333 | L2-Norm(final)=16.882 | 4771.1 samples/s | 74.5 steps/s
[Step=49800 Epoch=97.1] | Loss=0.00891 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=16.883 | 4811.8 samples/s | 75.2 steps/s
[Step=49850 Epoch=97.2] | Loss=0.00874 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.339 | L2-Norm(final)=16.884 | 4805.9 samples/s | 75.1 steps/s
[Step=49900 Epoch=97.3] | Loss=0.00865 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.342 | L2-Norm(final)=16.884 | 4806.8 samples/s | 75.1 steps/s
[Step=49950 Epoch=97.4] | Loss=0.00863 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.345 | L2-Norm(final)=16.885 | 4691.7 samples/s | 73.3 steps/s
[Step=50000 Epoch=97.5] | Loss=0.00861 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.348 | L2-Norm(final)=16.886 | 4725.7 samples/s | 73.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step50000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=48001 Epoch=93.8] | Loss=0.00136 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=17.021 | 4540.2 samples/s | 70.9 steps/s
[Step=48050 Epoch=93.9] | Loss=0.00864 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=17.023 | 5296.7 samples/s | 82.8 steps/s
[Step=48100 Epoch=94.0] | Loss=0.00850 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.158 | L2-Norm(final)=17.027 | 5561.0 samples/s | 86.9 steps/s
[Step=48150 Epoch=94.1] | Loss=0.00813 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=17.033 | 5650.1 samples/s | 88.3 steps/s
[Step=48200 Epoch=94.2] | Loss=0.00819 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=17.039 | 5413.1 samples/s | 84.6 steps/s
[Step=48250 Epoch=94.3] | Loss=0.00860 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=17.044 | 5502.0 samples/s | 86.0 steps/s
[Step=48300 Epoch=94.4] | Loss=0.00844 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.158 | L2-Norm(final)=17.049 | 5497.5 samples/s | 85.9 steps/s
[Step=48350 Epoch=94.5] | Loss=0.00846 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.158 | L2-Norm(final)=17.055 | 5536.9 samples/s | 86.5 steps/s
[Step=48400 Epoch=94.6] | Loss=0.00832 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=17.060 | 5515.0 samples/s | 86.2 steps/s
[Step=48450 Epoch=94.7] | Loss=0.00830 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=17.066 | 5597.9 samples/s | 87.5 steps/s
[Step=48500 Epoch=94.8] | Loss=0.00817 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=17.072 | 6935.2 samples/s | 108.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=48501 Epoch=94.8] | Loss=0.00143 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=17.131 | 4723.2 samples/s | 73.8 steps/s
[Step=48550 Epoch=94.9] | Loss=0.00765 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=17.133 | 4582.8 samples/s | 71.6 steps/s
[Step=48600 Epoch=95.0] | Loss=0.00807 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.193 | L2-Norm(final)=17.133 | 4774.3 samples/s | 74.6 steps/s
[Step=48650 Epoch=95.1] | Loss=0.00884 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.205 | L2-Norm(final)=17.133 | 4804.0 samples/s | 75.1 steps/s
[Step=48700 Epoch=95.2] | Loss=0.00961 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.215 | L2-Norm(final)=17.133 | 4805.3 samples/s | 75.1 steps/s
[Step=48750 Epoch=95.3] | Loss=0.00970 | Reg=0.00149 | acc=0.9531 | L2-Norm=12.224 | L2-Norm(final)=17.133 | 4776.3 samples/s | 74.6 steps/s
[Step=48800 Epoch=95.4] | Loss=0.01049 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=17.133 | 4764.6 samples/s | 74.4 steps/s
[Step=48850 Epoch=95.5] | Loss=0.01034 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.239 | L2-Norm(final)=17.133 | 4818.0 samples/s | 75.3 steps/s
[Step=48900 Epoch=95.6] | Loss=0.01003 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.245 | L2-Norm(final)=17.134 | 4734.8 samples/s | 74.0 steps/s
[Step=48950 Epoch=95.7] | Loss=0.00995 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.251 | L2-Norm(final)=17.135 | 4777.4 samples/s | 74.6 steps/s
[Step=49000 Epoch=95.8] | Loss=0.00971 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.257 | L2-Norm(final)=17.136 | 5880.7 samples/s | 91.9 steps/s
[Step=49050 Epoch=95.9] | Loss=0.00950 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=17.137 | 2098.0 samples/s | 32.8 steps/s
[Step=49100 Epoch=96.0] | Loss=0.00938 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.267 | L2-Norm(final)=17.138 | 4688.1 samples/s | 73.3 steps/s
[Step=49150 Epoch=96.1] | Loss=0.00921 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.271 | L2-Norm(final)=17.140 | 4742.5 samples/s | 74.1 steps/s
[Step=49200 Epoch=96.2] | Loss=0.00914 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=17.141 | 4776.1 samples/s | 74.6 steps/s
[Step=49250 Epoch=96.3] | Loss=0.00912 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=17.142 | 4827.3 samples/s | 75.4 steps/s
[Step=49300 Epoch=96.4] | Loss=0.00893 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=17.143 | 4750.3 samples/s | 74.2 steps/s
[Step=49350 Epoch=96.5] | Loss=0.00891 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=17.144 | 4808.9 samples/s | 75.1 steps/s
[Step=49400 Epoch=96.6] | Loss=0.00882 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.290 | L2-Norm(final)=17.145 | 4767.8 samples/s | 74.5 steps/s
[Step=49450 Epoch=96.7] | Loss=0.00860 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.293 | L2-Norm(final)=17.146 | 4754.5 samples/s | 74.3 steps/s
[Step=49500 Epoch=96.8] | Loss=0.00859 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=17.148 | 5158.6 samples/s | 80.6 steps/s
[Step=49550 Epoch=96.9] | Loss=0.00848 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.299 | L2-Norm(final)=17.149 | 2197.7 samples/s | 34.3 steps/s
[Step=49600 Epoch=97.0] | Loss=0.00832 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.302 | L2-Norm(final)=17.150 | 4729.6 samples/s | 73.9 steps/s
[Step=49650 Epoch=97.1] | Loss=0.00834 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.305 | L2-Norm(final)=17.151 | 4790.4 samples/s | 74.9 steps/s
[Step=49700 Epoch=97.2] | Loss=0.00819 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.308 | L2-Norm(final)=17.152 | 4734.9 samples/s | 74.0 steps/s
[Step=49750 Epoch=97.3] | Loss=0.00812 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=17.153 | 4797.3 samples/s | 75.0 steps/s
[Step=49800 Epoch=97.4] | Loss=0.00800 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=17.154 | 4741.9 samples/s | 74.1 steps/s
[Step=49850 Epoch=97.5] | Loss=0.00789 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=17.156 | 4766.6 samples/s | 74.5 steps/s
[Step=49900 Epoch=97.6] | Loss=0.00789 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.318 | L2-Norm(final)=17.157 | 4762.0 samples/s | 74.4 steps/s
[Step=49950 Epoch=97.7] | Loss=0.00782 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.321 | L2-Norm(final)=17.158 | 4796.9 samples/s | 75.0 steps/s
[Step=50000 Epoch=97.7] | Loss=0.00780 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.323 | L2-Norm(final)=17.159 | 4807.3 samples/s | 75.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step50000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=48001 Epoch=183.9] | Loss=0.00002 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=15.816 | 4692.2 samples/s | 73.3 steps/s
[Step=48050 Epoch=184.1] | Loss=0.00014 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=15.819 | 4848.6 samples/s | 75.8 steps/s
[Step=48100 Epoch=184.3] | Loss=0.00017 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=15.820 | 5236.2 samples/s | 81.8 steps/s
[Step=48150 Epoch=184.5] | Loss=0.00012 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=15.822 | 5231.4 samples/s | 81.7 steps/s
[Step=48200 Epoch=184.7] | Loss=0.00011 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=15.825 | 5231.3 samples/s | 81.7 steps/s
[Step=48250 Epoch=184.9] | Loss=0.00009 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=15.827 | 6900.2 samples/s | 107.8 steps/s
[Step=48300 Epoch=185.1] | Loss=0.00009 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=15.830 | 2114.4 samples/s | 33.0 steps/s
[Step=48350 Epoch=185.3] | Loss=0.00008 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=15.832 | 5288.4 samples/s | 82.6 steps/s
[Step=48400 Epoch=185.5] | Loss=0.00010 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=15.835 | 5200.9 samples/s | 81.3 steps/s
[Step=48450 Epoch=185.6] | Loss=0.00009 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=15.837 | 5244.2 samples/s | 81.9 steps/s
[Step=48500 Epoch=185.8] | Loss=0.00009 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=15.840 | 5709.4 samples/s | 89.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=48501 Epoch=185.8] | Loss=0.00002 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=15.864 | 4415.3 samples/s | 69.0 steps/s
[Step=48550 Epoch=186.0] | Loss=0.00030 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=15.865 | 4424.1 samples/s | 69.1 steps/s
[Step=48600 Epoch=186.2] | Loss=0.00024 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=15.865 | 4553.3 samples/s | 71.1 steps/s
[Step=48650 Epoch=186.4] | Loss=0.00020 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.186 | L2-Norm(final)=15.866 | 4618.2 samples/s | 72.2 steps/s
[Step=48700 Epoch=186.6] | Loss=0.00015 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.186 | L2-Norm(final)=15.867 | 4505.6 samples/s | 70.4 steps/s
[Step=48750 Epoch=186.8] | Loss=0.00012 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=15.868 | 5739.6 samples/s | 89.7 steps/s
[Step=48800 Epoch=187.0] | Loss=0.00010 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=15.869 | 2022.5 samples/s | 31.6 steps/s
[Step=48850 Epoch=187.2] | Loss=0.00009 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=15.870 | 4583.6 samples/s | 71.6 steps/s
[Step=48900 Epoch=187.4] | Loss=0.00008 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=15.870 | 4565.5 samples/s | 71.3 steps/s
[Step=48950 Epoch=187.6] | Loss=0.00007 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=15.871 | 4476.7 samples/s | 69.9 steps/s
[Step=49000 Epoch=187.8] | Loss=0.00006 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=15.872 | 5075.4 samples/s | 79.3 steps/s
[Step=49050 Epoch=187.9] | Loss=0.00006 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=15.873 | 2120.2 samples/s | 33.1 steps/s
[Step=49100 Epoch=188.1] | Loss=0.00005 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=15.874 | 4550.6 samples/s | 71.1 steps/s
[Step=49150 Epoch=188.3] | Loss=0.00005 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=15.875 | 4576.6 samples/s | 71.5 steps/s
[Step=49200 Epoch=188.5] | Loss=0.00004 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=15.876 | 4605.3 samples/s | 72.0 steps/s
[Step=49250 Epoch=188.7] | Loss=0.00004 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.125 | L2-Norm(final)=15.877 | 4659.3 samples/s | 72.8 steps/s
[Step=49300 Epoch=188.9] | Loss=0.00004 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.119 | L2-Norm(final)=15.878 | 2145.6 samples/s | 33.5 steps/s
[Step=49350 Epoch=189.1] | Loss=0.00004 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.112 | L2-Norm(final)=15.879 | 4690.9 samples/s | 73.3 steps/s
[Step=49400 Epoch=189.3] | Loss=0.00004 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.105 | L2-Norm(final)=15.880 | 4550.4 samples/s | 71.1 steps/s
[Step=49450 Epoch=189.5] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.099 | L2-Norm(final)=15.881 | 4564.9 samples/s | 71.3 steps/s
[Step=49500 Epoch=189.7] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.092 | L2-Norm(final)=15.882 | 4564.6 samples/s | 71.3 steps/s
[Step=49550 Epoch=189.9] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.085 | L2-Norm(final)=15.883 | 2207.0 samples/s | 34.5 steps/s
[Step=49600 Epoch=190.0] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.078 | L2-Norm(final)=15.884 | 4537.3 samples/s | 70.9 steps/s
[Step=49650 Epoch=190.2] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.071 | L2-Norm(final)=15.885 | 4556.0 samples/s | 71.2 steps/s
[Step=49700 Epoch=190.4] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.064 | L2-Norm(final)=15.886 | 4599.9 samples/s | 71.9 steps/s
[Step=49750 Epoch=190.6] | Loss=0.00003 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.057 | L2-Norm(final)=15.887 | 4536.7 samples/s | 70.9 steps/s
[Step=49800 Epoch=190.8] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.050 | L2-Norm(final)=15.888 | 6201.4 samples/s | 96.9 steps/s
[Step=49850 Epoch=191.0] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.043 | L2-Norm(final)=15.889 | 1952.0 samples/s | 30.5 steps/s
[Step=49900 Epoch=191.2] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.035 | L2-Norm(final)=15.890 | 4605.4 samples/s | 72.0 steps/s
[Step=49950 Epoch=191.4] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.028 | L2-Norm(final)=15.891 | 4533.8 samples/s | 70.8 steps/s
[Step=50000 Epoch=191.6] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.021 | L2-Norm(final)=15.892 | 4591.9 samples/s | 71.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step50000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=48001 Epoch=184.8] | Loss=0.00003 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=17.027 | 4441.9 samples/s | 69.4 steps/s
[Step=48050 Epoch=185.0] | Loss=0.00018 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=17.032 | 5139.5 samples/s | 80.3 steps/s
[Step=48100 Epoch=185.2] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=17.039 | 5230.7 samples/s | 81.7 steps/s
[Step=48150 Epoch=185.3] | Loss=0.00025 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=17.047 | 5205.2 samples/s | 81.3 steps/s
[Step=48200 Epoch=185.5] | Loss=0.00029 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=17.055 | 5260.7 samples/s | 82.2 steps/s
[Step=48250 Epoch=185.7] | Loss=0.00024 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=17.062 | 6886.8 samples/s | 107.6 steps/s
[Step=48300 Epoch=185.9] | Loss=0.00022 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=17.068 | 2139.4 samples/s | 33.4 steps/s
[Step=48350 Epoch=186.1] | Loss=0.00025 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=17.075 | 5291.4 samples/s | 82.7 steps/s
[Step=48400 Epoch=186.3] | Loss=0.00023 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=17.082 | 5155.7 samples/s | 80.6 steps/s
[Step=48450 Epoch=186.5] | Loss=0.00022 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=17.088 | 5240.1 samples/s | 81.9 steps/s
[Step=48500 Epoch=186.7] | Loss=0.00021 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=17.094 | 6020.5 samples/s | 94.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=48501 Epoch=186.7] | Loss=0.00002 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=17.158 | 4875.1 samples/s | 76.2 steps/s
[Step=48550 Epoch=186.9] | Loss=0.00056 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=17.160 | 4057.3 samples/s | 63.4 steps/s
[Step=48600 Epoch=187.1] | Loss=0.00169 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.191 | L2-Norm(final)=17.153 | 4593.0 samples/s | 71.8 steps/s
[Step=48650 Epoch=187.3] | Loss=0.00287 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.231 | L2-Norm(final)=17.143 | 4559.4 samples/s | 71.2 steps/s
[Step=48700 Epoch=187.5] | Loss=0.00256 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=17.136 | 4545.7 samples/s | 71.0 steps/s
[Step=48750 Epoch=187.7] | Loss=0.00206 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=17.131 | 5798.1 samples/s | 90.6 steps/s
[Step=48800 Epoch=187.9] | Loss=0.00172 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=17.129 | 1983.1 samples/s | 31.0 steps/s
[Step=48850 Epoch=188.0] | Loss=0.00147 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=17.127 | 4610.0 samples/s | 72.0 steps/s
[Step=48900 Epoch=188.2] | Loss=0.00136 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=17.125 | 4483.9 samples/s | 70.1 steps/s
[Step=48950 Epoch=188.4] | Loss=0.00121 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.300 | L2-Norm(final)=17.124 | 4561.9 samples/s | 71.3 steps/s
[Step=49000 Epoch=188.6] | Loss=0.00109 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=17.123 | 5193.2 samples/s | 81.1 steps/s
[Step=49050 Epoch=188.8] | Loss=0.00103 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=17.123 | 2072.3 samples/s | 32.4 steps/s
[Step=49100 Epoch=189.0] | Loss=0.00095 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.308 | L2-Norm(final)=17.122 | 4531.8 samples/s | 70.8 steps/s
[Step=49150 Epoch=189.2] | Loss=0.00088 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.310 | L2-Norm(final)=17.122 | 4528.2 samples/s | 70.8 steps/s
[Step=49200 Epoch=189.4] | Loss=0.00081 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=17.121 | 4583.0 samples/s | 71.6 steps/s
[Step=49250 Epoch=189.6] | Loss=0.00076 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=17.121 | 4571.7 samples/s | 71.4 steps/s
[Step=49300 Epoch=189.8] | Loss=0.00071 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=17.121 | 2179.3 samples/s | 34.1 steps/s
[Step=49350 Epoch=190.0] | Loss=0.00067 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=17.121 | 4648.1 samples/s | 72.6 steps/s
[Step=49400 Epoch=190.2] | Loss=0.00063 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=17.121 | 4604.3 samples/s | 71.9 steps/s
[Step=49450 Epoch=190.4] | Loss=0.00060 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.310 | L2-Norm(final)=17.120 | 4452.4 samples/s | 69.6 steps/s
[Step=49500 Epoch=190.5] | Loss=0.00057 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=17.120 | 4571.2 samples/s | 71.4 steps/s
[Step=49550 Epoch=190.7] | Loss=0.00054 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.308 | L2-Norm(final)=17.120 | 2181.1 samples/s | 34.1 steps/s
[Step=49600 Epoch=190.9] | Loss=0.00052 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=17.120 | 4552.5 samples/s | 71.1 steps/s
[Step=49650 Epoch=191.1] | Loss=0.00050 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=17.120 | 4578.5 samples/s | 71.5 steps/s
[Step=49700 Epoch=191.3] | Loss=0.00048 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=17.120 | 4479.1 samples/s | 70.0 steps/s
[Step=49750 Epoch=191.5] | Loss=0.00046 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=17.120 | 4599.2 samples/s | 71.9 steps/s
[Step=49800 Epoch=191.7] | Loss=0.00044 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=17.120 | 6654.6 samples/s | 104.0 steps/s
[Step=49850 Epoch=191.9] | Loss=0.00042 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=17.120 | 1909.6 samples/s | 29.8 steps/s
[Step=49900 Epoch=192.1] | Loss=0.00041 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=17.121 | 4488.1 samples/s | 70.1 steps/s
[Step=49950 Epoch=192.3] | Loss=0.00039 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=17.121 | 4603.8 samples/s | 71.9 steps/s
[Step=50000 Epoch=192.5] | Loss=0.00038 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=17.121 | 4570.4 samples/s | 71.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step50000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07819 | acc=0.9673 | tpr=0.9762 | fpr=0.0518 | 4160.4 samples/s | 16.3 steps/s
Avg test loss: 0.07541, Avg test acc: 0.96783, Avg tpr: 0.97628, Avg fpr: 0.05076, total FA: 396

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07841 | acc=0.9696 | tpr=0.9797 | fpr=0.0523 | 4196.0 samples/s | 16.4 steps/s
Avg test loss: 0.07803, Avg test acc: 0.96903, Avg tpr: 0.98001, Avg fpr: 0.05512, total FA: 430

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.05062 | acc=0.3034 | tpr=0.0058 | fpr=0.0503 | 4169.0 samples/s | 16.3 steps/s
Avg test loss: 7.05920, Avg test acc: 0.30091, Avg tpr: 0.00618, Avg fpr: 0.05089, total FA: 397

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=8.16043 | acc=0.3014 | tpr=0.0057 | fpr=0.0565 | 4188.7 samples/s | 16.4 steps/s
Avg test loss: 8.16844, Avg test acc: 0.29858, Avg tpr: 0.00571, Avg fpr: 0.05730, total FA: 447

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.36352 | acc=0.1286 | tpr=0.4823 | fpr=0.8778 | 4188.5 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.29087 | acc=0.1296 | tpr=0.4904 | fpr=0.8771 | 7759.8 samples/s | 30.3 steps/s
[Step= 150] | Loss=6.28823 | acc=0.1290 | tpr=0.4928 | fpr=0.8777 | 7674.9 samples/s | 30.0 steps/s
[Step= 200] | Loss=6.28405 | acc=0.1294 | tpr=0.4984 | fpr=0.8773 | 8173.7 samples/s | 31.9 steps/s
[Step= 250] | Loss=6.27708 | acc=0.1290 | tpr=0.4917 | fpr=0.8776 | 7526.5 samples/s | 29.4 steps/s
[Step= 300] | Loss=6.28453 | acc=0.1280 | tpr=0.4829 | fpr=0.8785 | 8000.1 samples/s | 31.3 steps/s
[Step= 350] | Loss=6.29277 | acc=0.1277 | tpr=0.4809 | fpr=0.8787 | 7801.9 samples/s | 30.5 steps/s
[Step= 400] | Loss=6.28235 | acc=0.1274 | tpr=0.4721 | fpr=0.8789 | 8116.1 samples/s | 31.7 steps/s
[Step= 450] | Loss=6.28531 | acc=0.1267 | tpr=0.4684 | fpr=0.8795 | 7700.7 samples/s | 30.1 steps/s
[Step= 500] | Loss=6.28890 | acc=0.1264 | tpr=0.4696 | fpr=0.8798 | 7954.1 samples/s | 31.1 steps/s
[Step= 550] | Loss=6.28979 | acc=0.1266 | tpr=0.4704 | fpr=0.8797 | 14087.7 samples/s | 55.0 steps/s
Avg test loss: 6.29066, Avg test acc: 0.12654, Avg tpr: 0.47068, Avg fpr: 0.87972, total FA: 122147

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.79481 | acc=0.1252 | tpr=0.5398 | fpr=0.8823 | 4182.1 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.72354 | acc=0.1269 | tpr=0.5608 | fpr=0.8812 | 7897.0 samples/s | 30.8 steps/s
[Step= 150] | Loss=6.73939 | acc=0.1263 | tpr=0.5490 | fpr=0.8815 | 7936.0 samples/s | 31.0 steps/s
[Step= 200] | Loss=6.72907 | acc=0.1263 | tpr=0.5464 | fpr=0.8814 | 7723.8 samples/s | 30.2 steps/s
[Step= 250] | Loss=6.72397 | acc=0.1262 | tpr=0.5502 | fpr=0.8816 | 7987.5 samples/s | 31.2 steps/s
[Step= 300] | Loss=6.73429 | acc=0.1258 | tpr=0.5455 | fpr=0.8818 | 7982.4 samples/s | 31.2 steps/s
[Step= 350] | Loss=6.74425 | acc=0.1252 | tpr=0.5510 | fpr=0.8825 | 7786.2 samples/s | 30.4 steps/s
[Step= 400] | Loss=6.73338 | acc=0.1248 | tpr=0.5394 | fpr=0.8827 | 7861.6 samples/s | 30.7 steps/s
[Step= 450] | Loss=6.73707 | acc=0.1245 | tpr=0.5385 | fpr=0.8831 | 7647.7 samples/s | 29.9 steps/s
[Step= 500] | Loss=6.73898 | acc=0.1244 | tpr=0.5414 | fpr=0.8832 | 7870.2 samples/s | 30.7 steps/s
[Step= 550] | Loss=6.74007 | acc=0.1245 | tpr=0.5420 | fpr=0.8831 | 14936.4 samples/s | 58.3 steps/s
Avg test loss: 6.74065, Avg test acc: 0.12443, Avg tpr: 0.54239, Avg fpr: 0.88317, total FA: 122626

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11516 | acc=0.9819 | tpr=0.9248 | fpr=0.0171 | 4245.6 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.12368 | acc=0.9812 | tpr=0.9403 | fpr=0.0181 | 7565.2 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.12459 | acc=0.9808 | tpr=0.9424 | fpr=0.0185 | 7930.1 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.12671 | acc=0.9809 | tpr=0.9454 | fpr=0.0185 | 7667.0 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.12563 | acc=0.9810 | tpr=0.9485 | fpr=0.0184 | 7899.8 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.12807 | acc=0.9808 | tpr=0.9498 | fpr=0.0186 | 7842.2 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.12861 | acc=0.9807 | tpr=0.9487 | fpr=0.0187 | 7752.5 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.12979 | acc=0.9804 | tpr=0.9464 | fpr=0.0189 | 7875.9 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.13152 | acc=0.9803 | tpr=0.9450 | fpr=0.0191 | 7881.3 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.13060 | acc=0.9804 | tpr=0.9458 | fpr=0.0189 | 7564.4 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.12947 | acc=0.9807 | tpr=0.9455 | fpr=0.0187 | 14998.1 samples/s | 58.6 steps/s
Avg test loss: 0.12917, Avg test acc: 0.98069, Avg tpr: 0.94572, Avg fpr: 0.01868, total FA: 2593

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13230 | acc=0.9788 | tpr=0.9248 | fpr=0.0203 | 4177.6 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.14552 | acc=0.9778 | tpr=0.9339 | fpr=0.0214 | 7756.5 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.14893 | acc=0.9773 | tpr=0.9438 | fpr=0.0221 | 7868.6 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.14968 | acc=0.9776 | tpr=0.9486 | fpr=0.0219 | 7832.9 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.14873 | acc=0.9775 | tpr=0.9485 | fpr=0.0220 | 7785.2 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.15193 | acc=0.9772 | tpr=0.9498 | fpr=0.0223 | 8070.2 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.15227 | acc=0.9771 | tpr=0.9487 | fpr=0.0224 | 7888.0 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.15407 | acc=0.9767 | tpr=0.9491 | fpr=0.0228 | 7724.5 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.15593 | acc=0.9765 | tpr=0.9469 | fpr=0.0230 | 7810.2 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.15489 | acc=0.9766 | tpr=0.9480 | fpr=0.0229 | 7607.1 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.15407 | acc=0.9768 | tpr=0.9491 | fpr=0.0227 | 14735.5 samples/s | 57.6 steps/s
Avg test loss: 0.15372, Avg test acc: 0.97686, Avg tpr: 0.94929, Avg fpr: 0.02264, total FA: 3144

server round 25/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=50001 Epoch=97.5] | Loss=0.00700 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.121 | L2-Norm(final)=16.910 | 4088.4 samples/s | 63.9 steps/s
[Step=50050 Epoch=97.6] | Loss=0.00885 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=16.922 | 5410.7 samples/s | 84.5 steps/s
[Step=50100 Epoch=97.7] | Loss=0.00887 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=16.933 | 5563.6 samples/s | 86.9 steps/s
[Step=50150 Epoch=97.8] | Loss=0.00983 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.122 | L2-Norm(final)=16.943 | 5475.1 samples/s | 85.5 steps/s
[Step=50200 Epoch=97.9] | Loss=0.01002 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=16.954 | 5464.0 samples/s | 85.4 steps/s
[Step=50250 Epoch=98.0] | Loss=0.00958 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.122 | L2-Norm(final)=16.964 | 5584.9 samples/s | 87.3 steps/s
[Step=50300 Epoch=98.1] | Loss=0.00959 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=16.974 | 5466.4 samples/s | 85.4 steps/s
[Step=50350 Epoch=98.2] | Loss=0.00944 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=16.983 | 5553.5 samples/s | 86.8 steps/s
[Step=50400 Epoch=98.3] | Loss=0.00954 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=16.991 | 5468.8 samples/s | 85.5 steps/s
[Step=50450 Epoch=98.4] | Loss=0.00938 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.122 | L2-Norm(final)=17.000 | 5616.4 samples/s | 87.8 steps/s
[Step=50500 Epoch=98.5] | Loss=0.00951 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=17.008 | 6897.4 samples/s | 107.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=50501 Epoch=98.5] | Loss=0.00437 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=17.085 | 4874.8 samples/s | 76.2 steps/s
[Step=50550 Epoch=98.6] | Loss=0.00899 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=17.086 | 4230.1 samples/s | 66.1 steps/s
[Step=50600 Epoch=98.7] | Loss=0.01010 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.166 | L2-Norm(final)=17.085 | 4780.5 samples/s | 74.7 steps/s
[Step=50650 Epoch=98.8] | Loss=0.01154 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.182 | L2-Norm(final)=17.082 | 4819.3 samples/s | 75.3 steps/s
[Step=50700 Epoch=98.9] | Loss=0.01203 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.193 | L2-Norm(final)=17.079 | 4825.6 samples/s | 75.4 steps/s
[Step=50750 Epoch=99.0] | Loss=0.01200 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.202 | L2-Norm(final)=17.077 | 4706.4 samples/s | 73.5 steps/s
[Step=50800 Epoch=99.1] | Loss=0.01156 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.210 | L2-Norm(final)=17.076 | 4835.0 samples/s | 75.5 steps/s
[Step=50850 Epoch=99.2] | Loss=0.01141 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=17.076 | 4789.7 samples/s | 74.8 steps/s
[Step=50900 Epoch=99.3] | Loss=0.01147 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.224 | L2-Norm(final)=17.075 | 4843.0 samples/s | 75.7 steps/s
[Step=50950 Epoch=99.4] | Loss=0.01108 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.230 | L2-Norm(final)=17.076 | 4791.7 samples/s | 74.9 steps/s
[Step=51000 Epoch=99.5] | Loss=0.01095 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=17.076 | 5814.8 samples/s | 90.9 steps/s
[Step=51050 Epoch=99.6] | Loss=0.01070 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.242 | L2-Norm(final)=17.077 | 2077.1 samples/s | 32.5 steps/s
[Step=51100 Epoch=99.7] | Loss=0.01019 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.247 | L2-Norm(final)=17.078 | 4780.3 samples/s | 74.7 steps/s
[Step=51150 Epoch=99.8] | Loss=0.00996 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=17.080 | 4780.4 samples/s | 74.7 steps/s
[Step=51200 Epoch=99.9] | Loss=0.00976 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=17.081 | 4787.0 samples/s | 74.8 steps/s
[Step=51250 Epoch=100.0] | Loss=0.00957 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=17.083 | 4744.4 samples/s | 74.1 steps/s
[Step=51300 Epoch=100.1] | Loss=0.00951 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=17.084 | 4805.6 samples/s | 75.1 steps/s
[Step=51350 Epoch=100.2] | Loss=0.00946 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.270 | L2-Norm(final)=17.085 | 4780.3 samples/s | 74.7 steps/s
[Step=51400 Epoch=100.2] | Loss=0.00929 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.274 | L2-Norm(final)=17.086 | 4807.0 samples/s | 75.1 steps/s
[Step=51450 Epoch=100.3] | Loss=0.00908 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.278 | L2-Norm(final)=17.088 | 4809.1 samples/s | 75.1 steps/s
[Step=51500 Epoch=100.4] | Loss=0.00906 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=17.089 | 5069.2 samples/s | 79.2 steps/s
[Step=51550 Epoch=100.5] | Loss=0.00892 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=17.090 | 2156.1 samples/s | 33.7 steps/s
[Step=51600 Epoch=100.6] | Loss=0.00876 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=17.092 | 4871.0 samples/s | 76.1 steps/s
[Step=51650 Epoch=100.7] | Loss=0.00867 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=17.093 | 4742.9 samples/s | 74.1 steps/s
[Step=51700 Epoch=100.8] | Loss=0.00859 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=17.094 | 4781.8 samples/s | 74.7 steps/s
[Step=51750 Epoch=100.9] | Loss=0.00852 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=17.096 | 4787.4 samples/s | 74.8 steps/s
[Step=51800 Epoch=101.0] | Loss=0.00845 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.300 | L2-Norm(final)=17.097 | 4713.6 samples/s | 73.6 steps/s
[Step=51850 Epoch=101.1] | Loss=0.00837 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=17.098 | 4777.6 samples/s | 74.7 steps/s
[Step=51900 Epoch=101.2] | Loss=0.00837 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.306 | L2-Norm(final)=17.100 | 4801.7 samples/s | 75.0 steps/s
[Step=51950 Epoch=101.3] | Loss=0.00834 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.308 | L2-Norm(final)=17.101 | 4746.5 samples/s | 74.2 steps/s
[Step=52000 Epoch=101.4] | Loss=0.00829 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=17.102 | 4819.7 samples/s | 75.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step52000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=50001 Epoch=97.8] | Loss=0.00958 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.121 | L2-Norm(final)=17.192 | 4635.2 samples/s | 72.4 steps/s
[Step=50050 Epoch=97.8] | Loss=0.01109 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=17.206 | 5131.1 samples/s | 80.2 steps/s
[Step=50100 Epoch=97.9] | Loss=0.01114 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=17.217 | 5518.4 samples/s | 86.2 steps/s
[Step=50150 Epoch=98.0] | Loss=0.01154 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.122 | L2-Norm(final)=17.226 | 5472.5 samples/s | 85.5 steps/s
[Step=50200 Epoch=98.1] | Loss=0.01114 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=17.235 | 5471.1 samples/s | 85.5 steps/s
[Step=50250 Epoch=98.2] | Loss=0.01104 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.122 | L2-Norm(final)=17.243 | 5476.7 samples/s | 85.6 steps/s
[Step=50300 Epoch=98.3] | Loss=0.01056 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.122 | L2-Norm(final)=17.251 | 5632.7 samples/s | 88.0 steps/s
[Step=50350 Epoch=98.4] | Loss=0.01042 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=17.259 | 5539.0 samples/s | 86.5 steps/s
[Step=50400 Epoch=98.5] | Loss=0.01048 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=17.267 | 5459.5 samples/s | 85.3 steps/s
[Step=50450 Epoch=98.6] | Loss=0.01034 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=17.276 | 5469.2 samples/s | 85.5 steps/s
[Step=50500 Epoch=98.7] | Loss=0.01025 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.122 | L2-Norm(final)=17.284 | 7095.1 samples/s | 110.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=50501 Epoch=98.7] | Loss=0.00589 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=17.366 | 4934.3 samples/s | 77.1 steps/s
[Step=50550 Epoch=98.8] | Loss=0.00864 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=17.368 | 4262.7 samples/s | 66.6 steps/s
[Step=50600 Epoch=98.9] | Loss=0.01002 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=17.366 | 4781.1 samples/s | 74.7 steps/s
[Step=50650 Epoch=99.0] | Loss=0.01076 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.185 | L2-Norm(final)=17.362 | 4796.8 samples/s | 74.9 steps/s
[Step=50700 Epoch=99.1] | Loss=0.01039 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.198 | L2-Norm(final)=17.360 | 4730.6 samples/s | 73.9 steps/s
[Step=50750 Epoch=99.2] | Loss=0.01038 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=17.359 | 4839.8 samples/s | 75.6 steps/s
[Step=50800 Epoch=99.3] | Loss=0.01049 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=17.359 | 4760.8 samples/s | 74.4 steps/s
[Step=50850 Epoch=99.4] | Loss=0.01079 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.225 | L2-Norm(final)=17.358 | 4823.3 samples/s | 75.4 steps/s
[Step=50900 Epoch=99.5] | Loss=0.01074 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=17.358 | 4667.5 samples/s | 72.9 steps/s
[Step=50950 Epoch=99.6] | Loss=0.01070 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=17.358 | 4756.7 samples/s | 74.3 steps/s
[Step=51000 Epoch=99.7] | Loss=0.01052 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.247 | L2-Norm(final)=17.359 | 5898.6 samples/s | 92.2 steps/s
[Step=51050 Epoch=99.8] | Loss=0.01008 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=17.359 | 2089.9 samples/s | 32.7 steps/s
[Step=51100 Epoch=99.9] | Loss=0.00998 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=17.360 | 4761.8 samples/s | 74.4 steps/s
[Step=51150 Epoch=100.0] | Loss=0.00976 | Reg=0.00150 | acc=0.9531 | L2-Norm=12.263 | L2-Norm(final)=17.361 | 4828.3 samples/s | 75.4 steps/s
[Step=51200 Epoch=100.1] | Loss=0.00973 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.267 | L2-Norm(final)=17.361 | 4762.4 samples/s | 74.4 steps/s
[Step=51250 Epoch=100.2] | Loss=0.00980 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.272 | L2-Norm(final)=17.361 | 4742.5 samples/s | 74.1 steps/s
[Step=51300 Epoch=100.3] | Loss=0.00969 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.276 | L2-Norm(final)=17.362 | 4842.2 samples/s | 75.7 steps/s
[Step=51350 Epoch=100.4] | Loss=0.00951 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.279 | L2-Norm(final)=17.362 | 4761.0 samples/s | 74.4 steps/s
[Step=51400 Epoch=100.5] | Loss=0.00930 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=17.363 | 4770.4 samples/s | 74.5 steps/s
[Step=51450 Epoch=100.6] | Loss=0.00919 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=17.364 | 4781.5 samples/s | 74.7 steps/s
[Step=51500 Epoch=100.7] | Loss=0.00911 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=17.364 | 5197.7 samples/s | 81.2 steps/s
[Step=51550 Epoch=100.8] | Loss=0.00900 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.293 | L2-Norm(final)=17.365 | 2189.8 samples/s | 34.2 steps/s
[Step=51600 Epoch=100.9] | Loss=0.00886 | Reg=0.00151 | acc=0.9531 | L2-Norm=12.296 | L2-Norm(final)=17.366 | 4824.7 samples/s | 75.4 steps/s
[Step=51650 Epoch=101.0] | Loss=0.00864 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=17.367 | 4737.9 samples/s | 74.0 steps/s
[Step=51700 Epoch=101.1] | Loss=0.00857 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.302 | L2-Norm(final)=17.367 | 4773.9 samples/s | 74.6 steps/s
[Step=51750 Epoch=101.2] | Loss=0.00857 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.305 | L2-Norm(final)=17.368 | 4767.7 samples/s | 74.5 steps/s
[Step=51800 Epoch=101.3] | Loss=0.00849 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.308 | L2-Norm(final)=17.369 | 4819.2 samples/s | 75.3 steps/s
[Step=51850 Epoch=101.4] | Loss=0.00844 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.310 | L2-Norm(final)=17.370 | 4718.8 samples/s | 73.7 steps/s
[Step=51900 Epoch=101.5] | Loss=0.00834 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=17.371 | 4754.9 samples/s | 74.3 steps/s
[Step=51950 Epoch=101.6] | Loss=0.00829 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=17.371 | 4800.5 samples/s | 75.0 steps/s
[Step=52000 Epoch=101.7] | Loss=0.00823 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.318 | L2-Norm(final)=17.372 | 4759.0 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step52000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=50001 Epoch=191.6] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.121 | L2-Norm(final)=15.924 | 4596.6 samples/s | 71.8 steps/s
[Step=50050 Epoch=191.8] | Loss=0.00003 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=15.929 | 4793.8 samples/s | 74.9 steps/s
[Step=50100 Epoch=192.0] | Loss=0.00003 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=15.933 | 5193.6 samples/s | 81.1 steps/s
[Step=50150 Epoch=192.2] | Loss=0.00002 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=15.937 | 5213.1 samples/s | 81.5 steps/s
[Step=50200 Epoch=192.3] | Loss=0.00003 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=15.942 | 5270.0 samples/s | 82.3 steps/s
[Step=50250 Epoch=192.5] | Loss=0.00003 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=15.945 | 6816.6 samples/s | 106.5 steps/s
[Step=50300 Epoch=192.7] | Loss=0.00003 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=15.949 | 2117.6 samples/s | 33.1 steps/s
[Step=50350 Epoch=192.9] | Loss=0.00003 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=15.952 | 5244.8 samples/s | 82.0 steps/s
[Step=50400 Epoch=193.1] | Loss=0.00003 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=15.956 | 5167.5 samples/s | 80.7 steps/s
[Step=50450 Epoch=193.3] | Loss=0.00003 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=15.959 | 5320.5 samples/s | 83.1 steps/s
[Step=50500 Epoch=193.5] | Loss=0.00003 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=15.963 | 5729.5 samples/s | 89.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=50501 Epoch=193.5] | Loss=0.00007 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=15.996 | 4511.4 samples/s | 70.5 steps/s
[Step=50550 Epoch=193.7] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.111 | L2-Norm(final)=15.998 | 4328.3 samples/s | 67.6 steps/s
[Step=50600 Epoch=193.9] | Loss=0.00002 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.099 | L2-Norm(final)=16.001 | 4523.4 samples/s | 70.7 steps/s
[Step=50650 Epoch=194.1] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.092 | L2-Norm(final)=16.003 | 4580.6 samples/s | 71.6 steps/s
[Step=50700 Epoch=194.3] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.080 | L2-Norm(final)=16.006 | 4548.7 samples/s | 71.1 steps/s
[Step=50750 Epoch=194.5] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.068 | L2-Norm(final)=16.007 | 5611.9 samples/s | 87.7 steps/s
[Step=50800 Epoch=194.6] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.054 | L2-Norm(final)=16.009 | 1914.7 samples/s | 29.9 steps/s
[Step=50850 Epoch=194.8] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.041 | L2-Norm(final)=16.010 | 4291.6 samples/s | 67.1 steps/s
[Step=50900 Epoch=195.0] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.027 | L2-Norm(final)=16.012 | 4341.5 samples/s | 67.8 steps/s
[Step=50950 Epoch=195.2] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.013 | L2-Norm(final)=16.013 | 4623.4 samples/s | 72.2 steps/s
[Step=51000 Epoch=195.4] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.999 | L2-Norm(final)=16.014 | 4989.6 samples/s | 78.0 steps/s
[Step=51050 Epoch=195.6] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.984 | L2-Norm(final)=16.015 | 2083.6 samples/s | 32.6 steps/s
[Step=51100 Epoch=195.8] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.970 | L2-Norm(final)=16.016 | 4641.7 samples/s | 72.5 steps/s
[Step=51150 Epoch=196.0] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.956 | L2-Norm(final)=16.017 | 4476.5 samples/s | 69.9 steps/s
[Step=51200 Epoch=196.2] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.942 | L2-Norm(final)=16.017 | 4541.2 samples/s | 71.0 steps/s
[Step=51250 Epoch=196.4] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.927 | L2-Norm(final)=16.018 | 4534.1 samples/s | 70.8 steps/s
[Step=51300 Epoch=196.6] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.913 | L2-Norm(final)=16.019 | 2163.5 samples/s | 33.8 steps/s
[Step=51350 Epoch=196.8] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.899 | L2-Norm(final)=16.020 | 4711.2 samples/s | 73.6 steps/s
[Step=51400 Epoch=196.9] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.884 | L2-Norm(final)=16.021 | 4530.0 samples/s | 70.8 steps/s
[Step=51450 Epoch=197.1] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.869 | L2-Norm(final)=16.022 | 4533.5 samples/s | 70.8 steps/s
[Step=51500 Epoch=197.3] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.855 | L2-Norm(final)=16.022 | 4541.5 samples/s | 71.0 steps/s
[Step=51550 Epoch=197.5] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.840 | L2-Norm(final)=16.023 | 2209.0 samples/s | 34.5 steps/s
[Step=51600 Epoch=197.7] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.825 | L2-Norm(final)=16.024 | 4504.3 samples/s | 70.4 steps/s
[Step=51650 Epoch=197.9] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=16.025 | 4550.5 samples/s | 71.1 steps/s
[Step=51700 Epoch=198.1] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.795 | L2-Norm(final)=16.026 | 4535.1 samples/s | 70.9 steps/s
[Step=51750 Epoch=198.3] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.779 | L2-Norm(final)=16.026 | 4529.5 samples/s | 70.8 steps/s
[Step=51800 Epoch=198.5] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.764 | L2-Norm(final)=16.027 | 6161.1 samples/s | 96.3 steps/s
[Step=51850 Epoch=198.7] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.749 | L2-Norm(final)=16.028 | 1941.0 samples/s | 30.3 steps/s
[Step=51900 Epoch=198.9] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.733 | L2-Norm(final)=16.029 | 4545.1 samples/s | 71.0 steps/s
[Step=51950 Epoch=199.1] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.717 | L2-Norm(final)=16.030 | 4536.1 samples/s | 70.9 steps/s
[Step=52000 Epoch=199.2] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.701 | L2-Norm(final)=16.031 | 4529.9 samples/s | 70.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step52000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=50001 Epoch=192.5] | Loss=0.00024 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.121 | L2-Norm(final)=17.126 | 4732.2 samples/s | 73.9 steps/s
[Step=50050 Epoch=192.7] | Loss=0.00005 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=17.130 | 4683.3 samples/s | 73.2 steps/s
[Step=50100 Epoch=192.9] | Loss=0.00005 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=17.133 | 5185.0 samples/s | 81.0 steps/s
[Step=50150 Epoch=193.0] | Loss=0.00005 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=17.136 | 5294.3 samples/s | 82.7 steps/s
[Step=50200 Epoch=193.2] | Loss=0.00006 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=17.137 | 5305.8 samples/s | 82.9 steps/s
[Step=50250 Epoch=193.4] | Loss=0.00006 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=17.139 | 6773.3 samples/s | 105.8 steps/s
[Step=50300 Epoch=193.6] | Loss=0.00006 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=17.140 | 2109.5 samples/s | 33.0 steps/s
[Step=50350 Epoch=193.8] | Loss=0.00006 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=17.142 | 5339.1 samples/s | 83.4 steps/s
[Step=50400 Epoch=194.0] | Loss=0.00007 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=17.143 | 5205.3 samples/s | 81.3 steps/s
[Step=50450 Epoch=194.2] | Loss=0.00006 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=17.144 | 5168.1 samples/s | 80.8 steps/s
[Step=50500 Epoch=194.4] | Loss=0.00006 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=17.146 | 6052.2 samples/s | 94.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=50501 Epoch=194.4] | Loss=0.00006 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=17.159 | 4561.6 samples/s | 71.3 steps/s
[Step=50550 Epoch=194.6] | Loss=0.00003 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.121 | L2-Norm(final)=17.160 | 4588.7 samples/s | 71.7 steps/s
[Step=50600 Epoch=194.8] | Loss=0.00002 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=17.162 | 4579.9 samples/s | 71.6 steps/s
[Step=50650 Epoch=195.0] | Loss=0.00002 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.119 | L2-Norm(final)=17.164 | 4571.6 samples/s | 71.4 steps/s
[Step=50700 Epoch=195.2] | Loss=0.00002 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.117 | L2-Norm(final)=17.166 | 4505.4 samples/s | 70.4 steps/s
[Step=50750 Epoch=195.4] | Loss=0.00002 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.115 | L2-Norm(final)=17.167 | 5884.6 samples/s | 91.9 steps/s
[Step=50800 Epoch=195.5] | Loss=0.00002 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.112 | L2-Norm(final)=17.169 | 1992.8 samples/s | 31.1 steps/s
[Step=50850 Epoch=195.7] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.108 | L2-Norm(final)=17.170 | 4585.0 samples/s | 71.6 steps/s
[Step=50900 Epoch=195.9] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.105 | L2-Norm(final)=17.171 | 4567.8 samples/s | 71.4 steps/s
[Step=50950 Epoch=196.1] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.101 | L2-Norm(final)=17.173 | 4616.3 samples/s | 72.1 steps/s
[Step=51000 Epoch=196.3] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.097 | L2-Norm(final)=17.174 | 5091.4 samples/s | 79.6 steps/s
[Step=51050 Epoch=196.5] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.094 | L2-Norm(final)=17.175 | 2105.0 samples/s | 32.9 steps/s
[Step=51100 Epoch=196.7] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.090 | L2-Norm(final)=17.176 | 4469.3 samples/s | 69.8 steps/s
[Step=51150 Epoch=196.9] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.086 | L2-Norm(final)=17.178 | 4512.9 samples/s | 70.5 steps/s
[Step=51200 Epoch=197.1] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.082 | L2-Norm(final)=17.179 | 4528.4 samples/s | 70.8 steps/s
[Step=51250 Epoch=197.3] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.078 | L2-Norm(final)=17.181 | 4618.8 samples/s | 72.2 steps/s
[Step=51300 Epoch=197.5] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.074 | L2-Norm(final)=17.182 | 2161.1 samples/s | 33.8 steps/s
[Step=51350 Epoch=197.7] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=17.184 | 4607.0 samples/s | 72.0 steps/s
[Step=51400 Epoch=197.9] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.066 | L2-Norm(final)=17.185 | 4535.3 samples/s | 70.9 steps/s
[Step=51450 Epoch=198.1] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.062 | L2-Norm(final)=17.187 | 4551.5 samples/s | 71.1 steps/s
[Step=51500 Epoch=198.2] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.057 | L2-Norm(final)=17.188 | 4557.4 samples/s | 71.2 steps/s
[Step=51550 Epoch=198.4] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.053 | L2-Norm(final)=17.189 | 2200.3 samples/s | 34.4 steps/s
[Step=51600 Epoch=198.6] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.049 | L2-Norm(final)=17.191 | 4551.1 samples/s | 71.1 steps/s
[Step=51650 Epoch=198.8] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.045 | L2-Norm(final)=17.192 | 4541.8 samples/s | 71.0 steps/s
[Step=51700 Epoch=199.0] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.040 | L2-Norm(final)=17.193 | 4564.6 samples/s | 71.3 steps/s
[Step=51750 Epoch=199.2] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.036 | L2-Norm(final)=17.194 | 4542.0 samples/s | 71.0 steps/s
[Step=51800 Epoch=199.4] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.031 | L2-Norm(final)=17.196 | 6682.6 samples/s | 104.4 steps/s
[Step=51850 Epoch=199.6] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.027 | L2-Norm(final)=17.197 | 1911.7 samples/s | 29.9 steps/s
[Step=51900 Epoch=199.8] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.022 | L2-Norm(final)=17.198 | 4614.3 samples/s | 72.1 steps/s
[Step=51950 Epoch=200.0] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.018 | L2-Norm(final)=17.199 | 4488.6 samples/s | 70.1 steps/s
[Step=52000 Epoch=200.2] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.013 | L2-Norm(final)=17.200 | 4540.8 samples/s | 70.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step52000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08204 | acc=0.9675 | tpr=0.9734 | fpr=0.0453 | 4010.7 samples/s | 15.7 steps/s
Avg test loss: 0.08100, Avg test acc: 0.96706, Avg tpr: 0.97307, Avg fpr: 0.04615, total FA: 360

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08220 | acc=0.9693 | tpr=0.9789 | fpr=0.0515 | 4148.0 samples/s | 16.2 steps/s
Avg test loss: 0.08076, Avg test acc: 0.96915, Avg tpr: 0.97925, Avg fpr: 0.05307, total FA: 414

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.81495 | acc=0.2998 | tpr=0.0071 | fpr=0.0644 | 4191.6 samples/s | 16.4 steps/s
Avg test loss: 6.82172, Avg test acc: 0.29718, Avg tpr: 0.00729, Avg fpr: 0.06525, total FA: 509

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.07319 | acc=0.2807 | tpr=0.0131 | fpr=0.1383 | 4179.6 samples/s | 16.3 steps/s
Avg test loss: 7.07304, Avg test acc: 0.27871, Avg tpr: 0.01317, Avg fpr: 0.13729, total FA: 1071

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.63180 | acc=0.1398 | tpr=0.4204 | fpr=0.8653 | 4284.4 samples/s | 16.7 steps/s
[Step= 100] | Loss=6.55681 | acc=0.1413 | tpr=0.4222 | fpr=0.8639 | 7552.1 samples/s | 29.5 steps/s
[Step= 150] | Loss=6.56337 | acc=0.1415 | tpr=0.4251 | fpr=0.8637 | 7858.8 samples/s | 30.7 steps/s
[Step= 200] | Loss=6.55564 | acc=0.1421 | tpr=0.4251 | fpr=0.8631 | 8043.2 samples/s | 31.4 steps/s
[Step= 250] | Loss=6.55069 | acc=0.1418 | tpr=0.4210 | fpr=0.8633 | 7830.0 samples/s | 30.6 steps/s
[Step= 300] | Loss=6.55761 | acc=0.1413 | tpr=0.4167 | fpr=0.8637 | 7634.8 samples/s | 29.8 steps/s
[Step= 350] | Loss=6.56701 | acc=0.1411 | tpr=0.4133 | fpr=0.8638 | 7979.3 samples/s | 31.2 steps/s
[Step= 400] | Loss=6.55456 | acc=0.1408 | tpr=0.4043 | fpr=0.8640 | 7853.7 samples/s | 30.7 steps/s
[Step= 450] | Loss=6.55769 | acc=0.1404 | tpr=0.4056 | fpr=0.8644 | 7736.3 samples/s | 30.2 steps/s
[Step= 500] | Loss=6.56099 | acc=0.1399 | tpr=0.4088 | fpr=0.8649 | 7898.9 samples/s | 30.9 steps/s
[Step= 550] | Loss=6.56303 | acc=0.1400 | tpr=0.4119 | fpr=0.8649 | 15121.6 samples/s | 59.1 steps/s
Avg test loss: 6.56401, Avg test acc: 0.13991, Avg tpr: 0.41244, Avg fpr: 0.86504, total FA: 120109

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.94396 | acc=0.1304 | tpr=0.4425 | fpr=0.8752 | 4193.7 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.87278 | acc=0.1316 | tpr=0.4435 | fpr=0.8742 | 7788.5 samples/s | 30.4 steps/s
[Step= 150] | Loss=6.88672 | acc=0.1313 | tpr=0.4452 | fpr=0.8745 | 7954.1 samples/s | 31.1 steps/s
[Step= 200] | Loss=6.88134 | acc=0.1318 | tpr=0.4437 | fpr=0.8739 | 8143.5 samples/s | 31.8 steps/s
[Step= 250] | Loss=6.87352 | acc=0.1313 | tpr=0.4419 | fpr=0.8744 | 7867.4 samples/s | 30.7 steps/s
[Step= 300] | Loss=6.88264 | acc=0.1308 | tpr=0.4444 | fpr=0.8749 | 7528.8 samples/s | 29.4 steps/s
[Step= 350] | Loss=6.89227 | acc=0.1301 | tpr=0.4396 | fpr=0.8755 | 7851.2 samples/s | 30.7 steps/s
[Step= 400] | Loss=6.88167 | acc=0.1296 | tpr=0.4316 | fpr=0.8759 | 7798.5 samples/s | 30.5 steps/s
[Step= 450] | Loss=6.88509 | acc=0.1292 | tpr=0.4299 | fpr=0.8763 | 7810.0 samples/s | 30.5 steps/s
[Step= 500] | Loss=6.88814 | acc=0.1290 | tpr=0.4322 | fpr=0.8765 | 7760.6 samples/s | 30.3 steps/s
[Step= 550] | Loss=6.89075 | acc=0.1290 | tpr=0.4329 | fpr=0.8765 | 14463.9 samples/s | 56.5 steps/s
Avg test loss: 6.89103, Avg test acc: 0.12890, Avg tpr: 0.43265, Avg fpr: 0.87662, total FA: 121717

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12347 | acc=0.9803 | tpr=0.9336 | fpr=0.0188 | 4146.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.13171 | acc=0.9794 | tpr=0.9403 | fpr=0.0199 | 7802.1 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.13341 | acc=0.9790 | tpr=0.9467 | fpr=0.0204 | 8011.1 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.13492 | acc=0.9790 | tpr=0.9519 | fpr=0.0205 | 7893.0 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.13415 | acc=0.9790 | tpr=0.9528 | fpr=0.0205 | 7789.9 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.13687 | acc=0.9789 | tpr=0.9549 | fpr=0.0207 | 8282.2 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.13755 | acc=0.9787 | tpr=0.9537 | fpr=0.0208 | 7467.0 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.13880 | acc=0.9785 | tpr=0.9524 | fpr=0.0210 | 7740.6 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.14064 | acc=0.9783 | tpr=0.9503 | fpr=0.0212 | 8032.2 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.13949 | acc=0.9785 | tpr=0.9511 | fpr=0.0210 | 7718.6 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.13847 | acc=0.9787 | tpr=0.9522 | fpr=0.0208 | 14384.9 samples/s | 56.2 steps/s
Avg test loss: 0.13815, Avg test acc: 0.97872, Avg tpr: 0.95246, Avg fpr: 0.02081, total FA: 2889

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15495 | acc=0.9768 | tpr=0.9425 | fpr=0.0226 | 4135.5 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.16620 | acc=0.9761 | tpr=0.9488 | fpr=0.0234 | 8040.6 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.16842 | acc=0.9760 | tpr=0.9568 | fpr=0.0237 | 7671.1 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.17023 | acc=0.9764 | tpr=0.9596 | fpr=0.0233 | 7919.9 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.16939 | acc=0.9763 | tpr=0.9598 | fpr=0.0234 | 7851.3 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.17305 | acc=0.9761 | tpr=0.9607 | fpr=0.0236 | 7817.2 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.17365 | acc=0.9760 | tpr=0.9587 | fpr=0.0237 | 8275.1 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.17552 | acc=0.9757 | tpr=0.9573 | fpr=0.0240 | 8031.6 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.17754 | acc=0.9754 | tpr=0.9542 | fpr=0.0242 | 7341.0 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.17640 | acc=0.9756 | tpr=0.9555 | fpr=0.0240 | 7710.0 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.17522 | acc=0.9759 | tpr=0.9562 | fpr=0.0237 | 14825.5 samples/s | 57.9 steps/s
Avg test loss: 0.17491, Avg test acc: 0.97594, Avg tpr: 0.95642, Avg fpr: 0.02370, total FA: 3291

server round 26/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=52001 Epoch=101.4] | Loss=0.02302 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.905 | L2-Norm(final)=17.139 | 4717.8 samples/s | 73.7 steps/s
[Step=52050 Epoch=101.5] | Loss=0.01027 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.905 | L2-Norm(final)=17.139 | 4676.6 samples/s | 73.1 steps/s
[Step=52100 Epoch=101.6] | Loss=0.00882 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.905 | L2-Norm(final)=17.144 | 5530.0 samples/s | 86.4 steps/s
[Step=52150 Epoch=101.7] | Loss=0.00869 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.905 | L2-Norm(final)=17.149 | 5542.7 samples/s | 86.6 steps/s
[Step=52200 Epoch=101.8] | Loss=0.00836 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.905 | L2-Norm(final)=17.155 | 5552.8 samples/s | 86.8 steps/s
[Step=52250 Epoch=101.9] | Loss=0.00804 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.905 | L2-Norm(final)=17.160 | 5444.9 samples/s | 85.1 steps/s
[Step=52300 Epoch=102.0] | Loss=0.00774 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.905 | L2-Norm(final)=17.165 | 5789.1 samples/s | 90.5 steps/s
[Step=52350 Epoch=102.1] | Loss=0.00808 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.905 | L2-Norm(final)=17.170 | 5433.2 samples/s | 84.9 steps/s
[Step=52400 Epoch=102.2] | Loss=0.00827 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.905 | L2-Norm(final)=17.175 | 5480.7 samples/s | 85.6 steps/s
[Step=52450 Epoch=102.3] | Loss=0.00836 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.905 | L2-Norm(final)=17.180 | 5573.8 samples/s | 87.1 steps/s
[Step=52500 Epoch=102.4] | Loss=0.00830 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.905 | L2-Norm(final)=17.184 | 6924.1 samples/s | 108.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=52501 Epoch=102.4] | Loss=0.00276 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.905 | L2-Norm(final)=17.231 | 4377.9 samples/s | 68.4 steps/s
[Step=52550 Epoch=102.5] | Loss=0.00912 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.924 | L2-Norm(final)=17.231 | 4492.6 samples/s | 70.2 steps/s
[Step=52600 Epoch=102.6] | Loss=0.00881 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.940 | L2-Norm(final)=17.233 | 4737.3 samples/s | 74.0 steps/s
[Step=52650 Epoch=102.7] | Loss=0.00946 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.951 | L2-Norm(final)=17.236 | 4774.8 samples/s | 74.6 steps/s
[Step=52700 Epoch=102.8] | Loss=0.01037 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.960 | L2-Norm(final)=17.238 | 4826.0 samples/s | 75.4 steps/s
[Step=52750 Epoch=102.9] | Loss=0.01063 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.968 | L2-Norm(final)=17.238 | 4754.8 samples/s | 74.3 steps/s
[Step=52800 Epoch=103.0] | Loss=0.01055 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.976 | L2-Norm(final)=17.239 | 4794.8 samples/s | 74.9 steps/s
[Step=52850 Epoch=103.1] | Loss=0.01020 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.984 | L2-Norm(final)=17.241 | 4806.4 samples/s | 75.1 steps/s
[Step=52900 Epoch=103.2] | Loss=0.01030 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.991 | L2-Norm(final)=17.242 | 4722.9 samples/s | 73.8 steps/s
[Step=52950 Epoch=103.3] | Loss=0.01020 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.998 | L2-Norm(final)=17.243 | 4806.1 samples/s | 75.1 steps/s
[Step=53000 Epoch=103.4] | Loss=0.01016 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.004 | L2-Norm(final)=17.245 | 5842.0 samples/s | 91.3 steps/s
[Step=53050 Epoch=103.5] | Loss=0.00993 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.010 | L2-Norm(final)=17.247 | 2043.0 samples/s | 31.9 steps/s
[Step=53100 Epoch=103.6] | Loss=0.00961 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.016 | L2-Norm(final)=17.249 | 4767.1 samples/s | 74.5 steps/s
[Step=53150 Epoch=103.7] | Loss=0.00940 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.021 | L2-Norm(final)=17.250 | 4735.6 samples/s | 74.0 steps/s
[Step=53200 Epoch=103.8] | Loss=0.00919 | Reg=0.00145 | acc=0.9531 | L2-Norm=12.026 | L2-Norm(final)=17.252 | 4778.0 samples/s | 74.7 steps/s
[Step=53250 Epoch=103.9] | Loss=0.00912 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.031 | L2-Norm(final)=17.254 | 4788.3 samples/s | 74.8 steps/s
[Step=53300 Epoch=104.0] | Loss=0.00901 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.035 | L2-Norm(final)=17.257 | 4810.5 samples/s | 75.2 steps/s
[Step=53350 Epoch=104.1] | Loss=0.00900 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.040 | L2-Norm(final)=17.259 | 4791.9 samples/s | 74.9 steps/s
[Step=53400 Epoch=104.2] | Loss=0.00881 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.044 | L2-Norm(final)=17.261 | 4814.9 samples/s | 75.2 steps/s
[Step=53450 Epoch=104.2] | Loss=0.00884 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.048 | L2-Norm(final)=17.262 | 4762.6 samples/s | 74.4 steps/s
[Step=53500 Epoch=104.3] | Loss=0.00886 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.052 | L2-Norm(final)=17.264 | 5067.6 samples/s | 79.2 steps/s
[Step=53550 Epoch=104.4] | Loss=0.00876 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.056 | L2-Norm(final)=17.266 | 2142.8 samples/s | 33.5 steps/s
[Step=53600 Epoch=104.5] | Loss=0.00858 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.060 | L2-Norm(final)=17.268 | 4829.9 samples/s | 75.5 steps/s
[Step=53650 Epoch=104.6] | Loss=0.00843 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.064 | L2-Norm(final)=17.269 | 4785.1 samples/s | 74.8 steps/s
[Step=53700 Epoch=104.7] | Loss=0.00836 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.067 | L2-Norm(final)=17.271 | 4844.3 samples/s | 75.7 steps/s
[Step=53750 Epoch=104.8] | Loss=0.00828 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.071 | L2-Norm(final)=17.273 | 4741.5 samples/s | 74.1 steps/s
[Step=53800 Epoch=104.9] | Loss=0.00822 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.074 | L2-Norm(final)=17.274 | 4824.3 samples/s | 75.4 steps/s
[Step=53850 Epoch=105.0] | Loss=0.00817 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.077 | L2-Norm(final)=17.276 | 4799.6 samples/s | 75.0 steps/s
[Step=53900 Epoch=105.1] | Loss=0.00816 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.080 | L2-Norm(final)=17.278 | 4817.6 samples/s | 75.3 steps/s
[Step=53950 Epoch=105.2] | Loss=0.00811 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.083 | L2-Norm(final)=17.279 | 4799.4 samples/s | 75.0 steps/s
[Step=54000 Epoch=105.3] | Loss=0.00798 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.086 | L2-Norm(final)=17.281 | 4848.4 samples/s | 75.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step54000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=52001 Epoch=101.7] | Loss=0.00157 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.905 | L2-Norm(final)=17.395 | 4389.8 samples/s | 68.6 steps/s
[Step=52050 Epoch=101.8] | Loss=0.00668 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.906 | L2-Norm(final)=17.399 | 5458.0 samples/s | 85.3 steps/s
[Step=52100 Epoch=101.9] | Loss=0.00681 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.906 | L2-Norm(final)=17.405 | 5567.3 samples/s | 87.0 steps/s
[Step=52150 Epoch=102.0] | Loss=0.00704 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.906 | L2-Norm(final)=17.410 | 5583.5 samples/s | 87.2 steps/s
[Step=52200 Epoch=102.0] | Loss=0.00785 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.906 | L2-Norm(final)=17.415 | 5524.4 samples/s | 86.3 steps/s
[Step=52250 Epoch=102.1] | Loss=0.00790 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.906 | L2-Norm(final)=17.419 | 5525.2 samples/s | 86.3 steps/s
[Step=52300 Epoch=102.2] | Loss=0.00814 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.906 | L2-Norm(final)=17.423 | 5485.1 samples/s | 85.7 steps/s
[Step=52350 Epoch=102.3] | Loss=0.00824 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.906 | L2-Norm(final)=17.426 | 5573.9 samples/s | 87.1 steps/s
[Step=52400 Epoch=102.4] | Loss=0.00812 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.906 | L2-Norm(final)=17.429 | 5608.1 samples/s | 87.6 steps/s
[Step=52450 Epoch=102.5] | Loss=0.00814 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.906 | L2-Norm(final)=17.433 | 5652.0 samples/s | 88.3 steps/s
[Step=52500 Epoch=102.6] | Loss=0.00827 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.906 | L2-Norm(final)=17.436 | 6943.6 samples/s | 108.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=52501 Epoch=102.6] | Loss=0.00908 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.906 | L2-Norm(final)=17.474 | 4833.3 samples/s | 75.5 steps/s
[Step=52550 Epoch=102.7] | Loss=0.00934 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.928 | L2-Norm(final)=17.477 | 4410.1 samples/s | 68.9 steps/s
[Step=52600 Epoch=102.8] | Loss=0.00915 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.943 | L2-Norm(final)=17.478 | 4785.0 samples/s | 74.8 steps/s
[Step=52650 Epoch=102.9] | Loss=0.01016 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.956 | L2-Norm(final)=17.477 | 4821.8 samples/s | 75.3 steps/s
[Step=52700 Epoch=103.0] | Loss=0.01020 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.965 | L2-Norm(final)=17.477 | 4794.4 samples/s | 74.9 steps/s
[Step=52750 Epoch=103.1] | Loss=0.00991 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=17.478 | 4731.2 samples/s | 73.9 steps/s
[Step=52800 Epoch=103.2] | Loss=0.00945 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.981 | L2-Norm(final)=17.479 | 4769.7 samples/s | 74.5 steps/s
[Step=52850 Epoch=103.3] | Loss=0.00922 | Reg=0.00144 | acc=0.9688 | L2-Norm=11.988 | L2-Norm(final)=17.481 | 4798.9 samples/s | 75.0 steps/s
[Step=52900 Epoch=103.4] | Loss=0.00954 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.995 | L2-Norm(final)=17.482 | 4759.9 samples/s | 74.4 steps/s
[Step=52950 Epoch=103.5] | Loss=0.00922 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.001 | L2-Norm(final)=17.483 | 4820.2 samples/s | 75.3 steps/s
[Step=53000 Epoch=103.6] | Loss=0.00918 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.006 | L2-Norm(final)=17.484 | 5920.4 samples/s | 92.5 steps/s
[Step=53050 Epoch=103.7] | Loss=0.00895 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.012 | L2-Norm(final)=17.485 | 2102.2 samples/s | 32.8 steps/s
[Step=53100 Epoch=103.8] | Loss=0.00894 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.017 | L2-Norm(final)=17.486 | 4769.8 samples/s | 74.5 steps/s
[Step=53150 Epoch=103.9] | Loss=0.00896 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.022 | L2-Norm(final)=17.487 | 4782.3 samples/s | 74.7 steps/s
[Step=53200 Epoch=104.0] | Loss=0.00881 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.027 | L2-Norm(final)=17.488 | 4722.3 samples/s | 73.8 steps/s
[Step=53250 Epoch=104.1] | Loss=0.00867 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.032 | L2-Norm(final)=17.489 | 4814.6 samples/s | 75.2 steps/s
[Step=53300 Epoch=104.2] | Loss=0.00886 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.037 | L2-Norm(final)=17.490 | 4833.3 samples/s | 75.5 steps/s
[Step=53350 Epoch=104.3] | Loss=0.00879 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.041 | L2-Norm(final)=17.491 | 4771.1 samples/s | 74.5 steps/s
[Step=53400 Epoch=104.4] | Loss=0.00883 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.045 | L2-Norm(final)=17.491 | 4813.1 samples/s | 75.2 steps/s
[Step=53450 Epoch=104.5] | Loss=0.00882 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.050 | L2-Norm(final)=17.492 | 4754.2 samples/s | 74.3 steps/s
[Step=53500 Epoch=104.6] | Loss=0.00864 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.054 | L2-Norm(final)=17.493 | 5197.2 samples/s | 81.2 steps/s
[Step=53550 Epoch=104.7] | Loss=0.00852 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.058 | L2-Norm(final)=17.494 | 2188.3 samples/s | 34.2 steps/s
[Step=53600 Epoch=104.8] | Loss=0.00839 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.062 | L2-Norm(final)=17.495 | 4801.3 samples/s | 75.0 steps/s
[Step=53650 Epoch=104.9] | Loss=0.00830 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.065 | L2-Norm(final)=17.496 | 4784.5 samples/s | 74.8 steps/s
[Step=53700 Epoch=105.0] | Loss=0.00816 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.069 | L2-Norm(final)=17.497 | 4812.7 samples/s | 75.2 steps/s
[Step=53750 Epoch=105.1] | Loss=0.00806 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.072 | L2-Norm(final)=17.498 | 4729.2 samples/s | 73.9 steps/s
[Step=53800 Epoch=105.2] | Loss=0.00803 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.075 | L2-Norm(final)=17.499 | 4751.9 samples/s | 74.2 steps/s
[Step=53850 Epoch=105.3] | Loss=0.00797 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.078 | L2-Norm(final)=17.500 | 4791.6 samples/s | 74.9 steps/s
[Step=53900 Epoch=105.4] | Loss=0.00798 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.081 | L2-Norm(final)=17.501 | 4809.5 samples/s | 75.1 steps/s
[Step=53950 Epoch=105.5] | Loss=0.00797 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.083 | L2-Norm(final)=17.502 | 4771.2 samples/s | 74.6 steps/s
[Step=54000 Epoch=105.6] | Loss=0.00793 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.086 | L2-Norm(final)=17.503 | 4775.9 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step54000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=52001 Epoch=199.2] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.905 | L2-Norm(final)=16.060 | 4558.7 samples/s | 71.2 steps/s
[Step=52050 Epoch=199.4] | Loss=0.00006 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.899 | L2-Norm(final)=16.070 | 4813.3 samples/s | 75.2 steps/s
[Step=52100 Epoch=199.6] | Loss=0.00005 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.899 | L2-Norm(final)=16.081 | 5179.2 samples/s | 80.9 steps/s
[Step=52150 Epoch=199.8] | Loss=0.00004 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=16.089 | 5207.4 samples/s | 81.4 steps/s
[Step=52200 Epoch=200.0] | Loss=0.00004 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=16.097 | 5153.4 samples/s | 80.5 steps/s
[Step=52250 Epoch=200.2] | Loss=0.00004 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=16.104 | 6910.6 samples/s | 108.0 steps/s
[Step=52300 Epoch=200.4] | Loss=0.00004 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=16.113 | 2149.1 samples/s | 33.6 steps/s
[Step=52350 Epoch=200.6] | Loss=0.00004 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=16.121 | 5320.8 samples/s | 83.1 steps/s
[Step=52400 Epoch=200.8] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=16.130 | 5143.0 samples/s | 80.4 steps/s
[Step=52450 Epoch=201.0] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=16.138 | 5262.2 samples/s | 82.2 steps/s
[Step=52500 Epoch=201.2] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=16.146 | 5870.4 samples/s | 91.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=52501 Epoch=201.2] | Loss=0.00006 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=16.228 | 4706.3 samples/s | 73.5 steps/s
[Step=52550 Epoch=201.4] | Loss=0.00043 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=16.233 | 4330.3 samples/s | 67.7 steps/s
[Step=52600 Epoch=201.5] | Loss=0.00156 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.931 | L2-Norm(final)=16.226 | 4464.1 samples/s | 69.8 steps/s
[Step=52650 Epoch=201.7] | Loss=0.00170 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.960 | L2-Norm(final)=16.220 | 4586.6 samples/s | 71.7 steps/s
[Step=52700 Epoch=201.9] | Loss=0.00130 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.977 | L2-Norm(final)=16.217 | 4516.8 samples/s | 70.6 steps/s
[Step=52750 Epoch=202.1] | Loss=0.00106 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.987 | L2-Norm(final)=16.215 | 5716.1 samples/s | 89.3 steps/s
[Step=52800 Epoch=202.3] | Loss=0.00089 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.993 | L2-Norm(final)=16.215 | 2033.9 samples/s | 31.8 steps/s
[Step=52850 Epoch=202.5] | Loss=0.00077 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.996 | L2-Norm(final)=16.216 | 4502.9 samples/s | 70.4 steps/s
[Step=52900 Epoch=202.7] | Loss=0.00067 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.999 | L2-Norm(final)=16.216 | 4547.4 samples/s | 71.1 steps/s
[Step=52950 Epoch=202.9] | Loss=0.00060 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.999 | L2-Norm(final)=16.216 | 4640.8 samples/s | 72.5 steps/s
[Step=53000 Epoch=203.1] | Loss=0.00054 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.999 | L2-Norm(final)=16.216 | 4984.9 samples/s | 77.9 steps/s
[Step=53050 Epoch=203.3] | Loss=0.00049 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.997 | L2-Norm(final)=16.217 | 2110.0 samples/s | 33.0 steps/s
[Step=53100 Epoch=203.5] | Loss=0.00045 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.995 | L2-Norm(final)=16.217 | 4585.8 samples/s | 71.7 steps/s
[Step=53150 Epoch=203.7] | Loss=0.00042 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.993 | L2-Norm(final)=16.217 | 4571.7 samples/s | 71.4 steps/s
[Step=53200 Epoch=203.8] | Loss=0.00039 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.990 | L2-Norm(final)=16.218 | 4549.0 samples/s | 71.1 steps/s
[Step=53250 Epoch=204.0] | Loss=0.00036 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.987 | L2-Norm(final)=16.218 | 4591.1 samples/s | 71.7 steps/s
[Step=53300 Epoch=204.2] | Loss=0.00034 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.983 | L2-Norm(final)=16.218 | 2202.7 samples/s | 34.4 steps/s
[Step=53350 Epoch=204.4] | Loss=0.00032 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.980 | L2-Norm(final)=16.218 | 4646.5 samples/s | 72.6 steps/s
[Step=53400 Epoch=204.6] | Loss=0.00030 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.976 | L2-Norm(final)=16.219 | 4539.9 samples/s | 70.9 steps/s
[Step=53450 Epoch=204.8] | Loss=0.00028 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=16.219 | 4545.4 samples/s | 71.0 steps/s
[Step=53500 Epoch=205.0] | Loss=0.00027 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.968 | L2-Norm(final)=16.219 | 4566.6 samples/s | 71.4 steps/s
[Step=53550 Epoch=205.2] | Loss=0.00026 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.964 | L2-Norm(final)=16.219 | 2225.4 samples/s | 34.8 steps/s
[Step=53600 Epoch=205.4] | Loss=0.00025 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.960 | L2-Norm(final)=16.219 | 4570.1 samples/s | 71.4 steps/s
[Step=53650 Epoch=205.6] | Loss=0.00024 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.955 | L2-Norm(final)=16.219 | 4526.8 samples/s | 70.7 steps/s
[Step=53700 Epoch=205.8] | Loss=0.00023 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.951 | L2-Norm(final)=16.220 | 4540.4 samples/s | 70.9 steps/s
[Step=53750 Epoch=206.0] | Loss=0.00022 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.947 | L2-Norm(final)=16.220 | 4544.6 samples/s | 71.0 steps/s
[Step=53800 Epoch=206.1] | Loss=0.00021 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.942 | L2-Norm(final)=16.220 | 6207.7 samples/s | 97.0 steps/s
[Step=53850 Epoch=206.3] | Loss=0.00020 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.938 | L2-Norm(final)=16.220 | 1960.4 samples/s | 30.6 steps/s
[Step=53900 Epoch=206.5] | Loss=0.00019 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.933 | L2-Norm(final)=16.220 | 4567.1 samples/s | 71.4 steps/s
[Step=53950 Epoch=206.7] | Loss=0.00019 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.928 | L2-Norm(final)=16.221 | 4502.0 samples/s | 70.3 steps/s
[Step=54000 Epoch=206.9] | Loss=0.00018 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.924 | L2-Norm(final)=16.221 | 4550.4 samples/s | 71.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step54000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=52001 Epoch=200.2] | Loss=0.00002 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.905 | L2-Norm(final)=17.231 | 4370.2 samples/s | 68.3 steps/s
[Step=52050 Epoch=200.4] | Loss=0.00009 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.237 | 5172.9 samples/s | 80.8 steps/s
[Step=52100 Epoch=200.6] | Loss=0.00007 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.243 | 5195.8 samples/s | 81.2 steps/s
[Step=52150 Epoch=200.7] | Loss=0.00009 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.250 | 5223.5 samples/s | 81.6 steps/s
[Step=52200 Epoch=200.9] | Loss=0.00009 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.255 | 5343.8 samples/s | 83.5 steps/s
[Step=52250 Epoch=201.1] | Loss=0.00009 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.261 | 6731.7 samples/s | 105.2 steps/s
[Step=52300 Epoch=201.3] | Loss=0.00010 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.267 | 2117.2 samples/s | 33.1 steps/s
[Step=52350 Epoch=201.5] | Loss=0.00009 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.273 | 5199.4 samples/s | 81.2 steps/s
[Step=52400 Epoch=201.7] | Loss=0.00009 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.278 | 5320.1 samples/s | 83.1 steps/s
[Step=52450 Epoch=201.9] | Loss=0.00009 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.284 | 5063.4 samples/s | 79.1 steps/s
[Step=52500 Epoch=202.1] | Loss=0.00009 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.289 | 6104.9 samples/s | 95.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=52501 Epoch=202.1] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.342 | 4514.6 samples/s | 70.5 steps/s
[Step=52550 Epoch=202.3] | Loss=0.00033 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.907 | L2-Norm(final)=17.346 | 4307.3 samples/s | 67.3 steps/s
[Step=52600 Epoch=202.5] | Loss=0.00216 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.944 | L2-Norm(final)=17.338 | 4602.8 samples/s | 71.9 steps/s
[Step=52650 Epoch=202.7] | Loss=0.00177 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.977 | L2-Norm(final)=17.331 | 4542.2 samples/s | 71.0 steps/s
[Step=52700 Epoch=202.9] | Loss=0.00139 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.994 | L2-Norm(final)=17.327 | 4596.3 samples/s | 71.8 steps/s
[Step=52750 Epoch=203.1] | Loss=0.00113 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.004 | L2-Norm(final)=17.326 | 5830.0 samples/s | 91.1 steps/s
[Step=52800 Epoch=203.2] | Loss=0.00095 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.010 | L2-Norm(final)=17.326 | 2014.6 samples/s | 31.5 steps/s
[Step=52850 Epoch=203.4] | Loss=0.00081 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.014 | L2-Norm(final)=17.325 | 4598.4 samples/s | 71.8 steps/s
[Step=52900 Epoch=203.6] | Loss=0.00072 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.015 | L2-Norm(final)=17.325 | 4495.3 samples/s | 70.2 steps/s
[Step=52950 Epoch=203.8] | Loss=0.00064 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.016 | L2-Norm(final)=17.325 | 4530.8 samples/s | 70.8 steps/s
[Step=53000 Epoch=204.0] | Loss=0.00058 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.016 | L2-Norm(final)=17.325 | 5183.5 samples/s | 81.0 steps/s
[Step=53050 Epoch=204.2] | Loss=0.00053 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.015 | L2-Norm(final)=17.325 | 2105.7 samples/s | 32.9 steps/s
[Step=53100 Epoch=204.4] | Loss=0.00048 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.014 | L2-Norm(final)=17.326 | 4588.7 samples/s | 71.7 steps/s
[Step=53150 Epoch=204.6] | Loss=0.00045 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.013 | L2-Norm(final)=17.326 | 4536.5 samples/s | 70.9 steps/s
[Step=53200 Epoch=204.8] | Loss=0.00041 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.011 | L2-Norm(final)=17.326 | 4574.8 samples/s | 71.5 steps/s
[Step=53250 Epoch=205.0] | Loss=0.00039 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.009 | L2-Norm(final)=17.326 | 4640.6 samples/s | 72.5 steps/s
[Step=53300 Epoch=205.2] | Loss=0.00036 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.007 | L2-Norm(final)=17.326 | 2193.0 samples/s | 34.3 steps/s
[Step=53350 Epoch=205.4] | Loss=0.00034 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.004 | L2-Norm(final)=17.327 | 4555.3 samples/s | 71.2 steps/s
[Step=53400 Epoch=205.6] | Loss=0.00032 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.002 | L2-Norm(final)=17.327 | 4542.7 samples/s | 71.0 steps/s
[Step=53450 Epoch=205.8] | Loss=0.00031 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.999 | L2-Norm(final)=17.327 | 4573.8 samples/s | 71.5 steps/s
[Step=53500 Epoch=205.9] | Loss=0.00029 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.996 | L2-Norm(final)=17.327 | 4530.0 samples/s | 70.8 steps/s
[Step=53550 Epoch=206.1] | Loss=0.00028 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.993 | L2-Norm(final)=17.328 | 2180.4 samples/s | 34.1 steps/s
[Step=53600 Epoch=206.3] | Loss=0.00027 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.990 | L2-Norm(final)=17.328 | 4640.8 samples/s | 72.5 steps/s
[Step=53650 Epoch=206.5] | Loss=0.00025 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.987 | L2-Norm(final)=17.328 | 4607.6 samples/s | 72.0 steps/s
[Step=53700 Epoch=206.7] | Loss=0.00024 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.984 | L2-Norm(final)=17.329 | 4532.5 samples/s | 70.8 steps/s
[Step=53750 Epoch=206.9] | Loss=0.00023 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.981 | L2-Norm(final)=17.329 | 4513.7 samples/s | 70.5 steps/s
[Step=53800 Epoch=207.1] | Loss=0.00022 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.978 | L2-Norm(final)=17.329 | 6651.3 samples/s | 103.9 steps/s
[Step=53850 Epoch=207.3] | Loss=0.00022 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.975 | L2-Norm(final)=17.330 | 1914.1 samples/s | 29.9 steps/s
[Step=53900 Epoch=207.5] | Loss=0.00021 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.971 | L2-Norm(final)=17.330 | 4502.4 samples/s | 70.4 steps/s
[Step=53950 Epoch=207.7] | Loss=0.00020 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.968 | L2-Norm(final)=17.331 | 4534.8 samples/s | 70.9 steps/s
[Step=54000 Epoch=207.9] | Loss=0.00019 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.965 | L2-Norm(final)=17.331 | 4537.2 samples/s | 70.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step54000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08803 | acc=0.9691 | tpr=0.9789 | fpr=0.0520 | 4130.1 samples/s | 16.1 steps/s
Avg test loss: 0.08502, Avg test acc: 0.96831, Avg tpr: 0.97873, Avg fpr: 0.05461, total FA: 426

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07578 | acc=0.9695 | tpr=0.9788 | fpr=0.0505 | 4150.9 samples/s | 16.2 steps/s
Avg test loss: 0.07394, Avg test acc: 0.96923, Avg tpr: 0.97878, Avg fpr: 0.05179, total FA: 404

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=8.01175 | acc=0.3087 | tpr=0.0052 | fpr=0.0325 | 4202.3 samples/s | 16.4 steps/s
Avg test loss: 8.02645, Avg test acc: 0.30411, Avg tpr: 0.00507, Avg fpr: 0.03820, total FA: 298

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.40025 | acc=0.2958 | tpr=0.0070 | fpr=0.0771 | 4272.1 samples/s | 16.7 steps/s
Avg test loss: 7.40294, Avg test acc: 0.29393, Avg tpr: 0.00822, Avg fpr: 0.07768, total FA: 606

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.98233 | acc=0.1290 | tpr=0.4867 | fpr=0.8774 | 4192.8 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.91117 | acc=0.1303 | tpr=0.4797 | fpr=0.8762 | 7877.6 samples/s | 30.8 steps/s
[Step= 150] | Loss=6.91560 | acc=0.1304 | tpr=0.4928 | fpr=0.8763 | 7786.1 samples/s | 30.4 steps/s
[Step= 200] | Loss=6.90738 | acc=0.1312 | tpr=0.5005 | fpr=0.8756 | 7697.6 samples/s | 30.1 steps/s
[Step= 250] | Loss=6.90134 | acc=0.1308 | tpr=0.4917 | fpr=0.8757 | 7937.5 samples/s | 31.0 steps/s
[Step= 300] | Loss=6.90983 | acc=0.1299 | tpr=0.4865 | fpr=0.8766 | 8159.5 samples/s | 31.9 steps/s
[Step= 350] | Loss=6.92005 | acc=0.1296 | tpr=0.4859 | fpr=0.8769 | 7877.0 samples/s | 30.8 steps/s
[Step= 400] | Loss=6.90950 | acc=0.1295 | tpr=0.4699 | fpr=0.8767 | 7569.2 samples/s | 29.6 steps/s
[Step= 450] | Loss=6.91419 | acc=0.1290 | tpr=0.4669 | fpr=0.8771 | 8019.4 samples/s | 31.3 steps/s
[Step= 500] | Loss=6.91745 | acc=0.1288 | tpr=0.4687 | fpr=0.8773 | 7678.1 samples/s | 30.0 steps/s
[Step= 550] | Loss=6.92089 | acc=0.1289 | tpr=0.4715 | fpr=0.8773 | 14887.1 samples/s | 58.2 steps/s
Avg test loss: 6.92196, Avg test acc: 0.12888, Avg tpr: 0.47227, Avg fpr: 0.87736, total FA: 121820

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.46994 | acc=0.1307 | tpr=0.5088 | fpr=0.8761 | 4200.5 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.41064 | acc=0.1312 | tpr=0.5075 | fpr=0.8759 | 8522.9 samples/s | 33.3 steps/s
[Step= 150] | Loss=6.42542 | acc=0.1304 | tpr=0.5072 | fpr=0.8766 | 7307.6 samples/s | 28.5 steps/s
[Step= 200] | Loss=6.42180 | acc=0.1308 | tpr=0.5038 | fpr=0.8760 | 8470.0 samples/s | 33.1 steps/s
[Step= 250] | Loss=6.41917 | acc=0.1312 | tpr=0.5048 | fpr=0.8757 | 7443.1 samples/s | 29.1 steps/s
[Step= 300] | Loss=6.42718 | acc=0.1307 | tpr=0.5076 | fpr=0.8762 | 7699.2 samples/s | 30.1 steps/s
[Step= 350] | Loss=6.43746 | acc=0.1303 | tpr=0.5103 | fpr=0.8766 | 8095.4 samples/s | 31.6 steps/s
[Step= 400] | Loss=6.42790 | acc=0.1300 | tpr=0.4995 | fpr=0.8767 | 7755.8 samples/s | 30.3 steps/s
[Step= 450] | Loss=6.42942 | acc=0.1296 | tpr=0.4990 | fpr=0.8771 | 7708.2 samples/s | 30.1 steps/s
[Step= 500] | Loss=6.43254 | acc=0.1293 | tpr=0.5026 | fpr=0.8774 | 7733.0 samples/s | 30.2 steps/s
[Step= 550] | Loss=6.43532 | acc=0.1296 | tpr=0.5022 | fpr=0.8772 | 14408.5 samples/s | 56.3 steps/s
Avg test loss: 6.43546, Avg test acc: 0.12948, Avg tpr: 0.50238, Avg fpr: 0.87730, total FA: 121811

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13335 | acc=0.9807 | tpr=0.9204 | fpr=0.0182 | 4168.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.14294 | acc=0.9799 | tpr=0.9382 | fpr=0.0193 | 7876.2 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.14499 | acc=0.9796 | tpr=0.9452 | fpr=0.0198 | 7742.4 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.14803 | acc=0.9793 | tpr=0.9464 | fpr=0.0201 | 7890.6 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.14704 | acc=0.9793 | tpr=0.9450 | fpr=0.0201 | 8013.2 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.15027 | acc=0.9790 | tpr=0.9440 | fpr=0.0203 | 7822.6 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.15019 | acc=0.9790 | tpr=0.9424 | fpr=0.0203 | 7865.7 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.15202 | acc=0.9789 | tpr=0.9409 | fpr=0.0204 | 7680.1 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.15388 | acc=0.9787 | tpr=0.9396 | fpr=0.0206 | 7693.0 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.15270 | acc=0.9788 | tpr=0.9419 | fpr=0.0205 | 8006.6 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.15172 | acc=0.9790 | tpr=0.9411 | fpr=0.0203 | 14326.4 samples/s | 56.0 steps/s
Avg test loss: 0.15139, Avg test acc: 0.97901, Avg tpr: 0.94097, Avg fpr: 0.02030, total FA: 2819

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13202 | acc=0.9790 | tpr=0.9292 | fpr=0.0201 | 4173.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.14345 | acc=0.9780 | tpr=0.9424 | fpr=0.0214 | 7797.4 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.14417 | acc=0.9779 | tpr=0.9510 | fpr=0.0216 | 7807.2 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.14496 | acc=0.9782 | tpr=0.9563 | fpr=0.0214 | 7717.7 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.14409 | acc=0.9781 | tpr=0.9546 | fpr=0.0214 | 7929.4 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.14759 | acc=0.9777 | tpr=0.9556 | fpr=0.0218 | 7881.2 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.14783 | acc=0.9778 | tpr=0.9530 | fpr=0.0218 | 7822.1 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.14944 | acc=0.9774 | tpr=0.9524 | fpr=0.0221 | 8003.8 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.15101 | acc=0.9773 | tpr=0.9503 | fpr=0.0222 | 7751.3 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.14970 | acc=0.9774 | tpr=0.9515 | fpr=0.0221 | 7715.1 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.14871 | acc=0.9777 | tpr=0.9526 | fpr=0.0219 | 14533.0 samples/s | 56.8 steps/s
Avg test loss: 0.14849, Avg test acc: 0.97771, Avg tpr: 0.95285, Avg fpr: 0.02184, total FA: 3032

server round 27/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=54001 Epoch=105.3] | Loss=0.00983 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=17.331 | 4246.5 samples/s | 66.4 steps/s
[Step=54050 Epoch=105.4] | Loss=0.00672 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=17.340 | 5361.5 samples/s | 83.8 steps/s
[Step=54100 Epoch=105.5] | Loss=0.00949 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.902 | L2-Norm(final)=17.352 | 5508.7 samples/s | 86.1 steps/s
[Step=54150 Epoch=105.6] | Loss=0.01020 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.902 | L2-Norm(final)=17.359 | 5526.2 samples/s | 86.3 steps/s
[Step=54200 Epoch=105.7] | Loss=0.01024 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=17.365 | 5620.0 samples/s | 87.8 steps/s
[Step=54250 Epoch=105.8] | Loss=0.01030 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=17.371 | 5463.5 samples/s | 85.4 steps/s
[Step=54300 Epoch=105.9] | Loss=0.01040 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=17.378 | 5575.7 samples/s | 87.1 steps/s
[Step=54350 Epoch=106.0] | Loss=0.01034 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=17.385 | 5464.8 samples/s | 85.4 steps/s
[Step=54400 Epoch=106.1] | Loss=0.01009 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.902 | L2-Norm(final)=17.392 | 5559.8 samples/s | 86.9 steps/s
[Step=54450 Epoch=106.2] | Loss=0.00988 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.902 | L2-Norm(final)=17.399 | 5538.2 samples/s | 86.5 steps/s
[Step=54500 Epoch=106.3] | Loss=0.00995 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.902 | L2-Norm(final)=17.406 | 6866.6 samples/s | 107.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=54501 Epoch=106.3] | Loss=0.00782 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=17.479 | 4537.9 samples/s | 70.9 steps/s
[Step=54550 Epoch=106.4] | Loss=0.00860 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.923 | L2-Norm(final)=17.481 | 4342.4 samples/s | 67.9 steps/s
[Step=54600 Epoch=106.5] | Loss=0.00865 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.939 | L2-Norm(final)=17.483 | 4736.8 samples/s | 74.0 steps/s
[Step=54650 Epoch=106.6] | Loss=0.00964 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.951 | L2-Norm(final)=17.483 | 4747.4 samples/s | 74.2 steps/s
[Step=54700 Epoch=106.7] | Loss=0.00985 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.960 | L2-Norm(final)=17.483 | 4800.8 samples/s | 75.0 steps/s
[Step=54750 Epoch=106.8] | Loss=0.01003 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.969 | L2-Norm(final)=17.483 | 4811.8 samples/s | 75.2 steps/s
[Step=54800 Epoch=106.9] | Loss=0.01023 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.978 | L2-Norm(final)=17.482 | 4796.8 samples/s | 74.9 steps/s
[Step=54850 Epoch=107.0] | Loss=0.01019 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.987 | L2-Norm(final)=17.483 | 4873.4 samples/s | 76.1 steps/s
[Step=54900 Epoch=107.1] | Loss=0.01035 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.994 | L2-Norm(final)=17.483 | 4797.5 samples/s | 75.0 steps/s
[Step=54950 Epoch=107.2] | Loss=0.01043 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.001 | L2-Norm(final)=17.484 | 4807.1 samples/s | 75.1 steps/s
[Step=55000 Epoch=107.3] | Loss=0.01051 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.008 | L2-Norm(final)=17.485 | 5842.3 samples/s | 91.3 steps/s
[Step=55050 Epoch=107.4] | Loss=0.01018 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.014 | L2-Norm(final)=17.485 | 2033.1 samples/s | 31.8 steps/s
[Step=55100 Epoch=107.5] | Loss=0.00996 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.020 | L2-Norm(final)=17.487 | 4768.3 samples/s | 74.5 steps/s
[Step=55150 Epoch=107.6] | Loss=0.00980 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.025 | L2-Norm(final)=17.488 | 4757.9 samples/s | 74.3 steps/s
[Step=55200 Epoch=107.7] | Loss=0.00974 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.030 | L2-Norm(final)=17.489 | 4717.5 samples/s | 73.7 steps/s
[Step=55250 Epoch=107.8] | Loss=0.00966 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.035 | L2-Norm(final)=17.490 | 4853.8 samples/s | 75.8 steps/s
[Step=55300 Epoch=107.9] | Loss=0.00944 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.039 | L2-Norm(final)=17.491 | 4849.5 samples/s | 75.8 steps/s
[Step=55350 Epoch=108.0] | Loss=0.00927 | Reg=0.00145 | acc=0.9531 | L2-Norm=12.043 | L2-Norm(final)=17.492 | 4736.1 samples/s | 74.0 steps/s
[Step=55400 Epoch=108.1] | Loss=0.00906 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.047 | L2-Norm(final)=17.493 | 4805.2 samples/s | 75.1 steps/s
[Step=55450 Epoch=108.1] | Loss=0.00893 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.051 | L2-Norm(final)=17.494 | 4788.0 samples/s | 74.8 steps/s
[Step=55500 Epoch=108.2] | Loss=0.00882 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.054 | L2-Norm(final)=17.496 | 5081.1 samples/s | 79.4 steps/s
[Step=55550 Epoch=108.3] | Loss=0.00885 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.058 | L2-Norm(final)=17.496 | 2169.4 samples/s | 33.9 steps/s
[Step=55600 Epoch=108.4] | Loss=0.00878 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.062 | L2-Norm(final)=17.497 | 4823.8 samples/s | 75.4 steps/s
[Step=55650 Epoch=108.5] | Loss=0.00884 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.065 | L2-Norm(final)=17.498 | 4818.8 samples/s | 75.3 steps/s
[Step=55700 Epoch=108.6] | Loss=0.00876 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.068 | L2-Norm(final)=17.499 | 4803.5 samples/s | 75.1 steps/s
[Step=55750 Epoch=108.7] | Loss=0.00864 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.072 | L2-Norm(final)=17.499 | 4684.1 samples/s | 73.2 steps/s
[Step=55800 Epoch=108.8] | Loss=0.00859 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.075 | L2-Norm(final)=17.500 | 4780.2 samples/s | 74.7 steps/s
[Step=55850 Epoch=108.9] | Loss=0.00854 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.078 | L2-Norm(final)=17.501 | 4833.4 samples/s | 75.5 steps/s
[Step=55900 Epoch=109.0] | Loss=0.00845 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.081 | L2-Norm(final)=17.502 | 4704.6 samples/s | 73.5 steps/s
[Step=55950 Epoch=109.1] | Loss=0.00842 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.084 | L2-Norm(final)=17.503 | 4752.5 samples/s | 74.3 steps/s
[Step=56000 Epoch=109.2] | Loss=0.00836 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.087 | L2-Norm(final)=17.504 | 4802.1 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step56000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=54001 Epoch=105.6] | Loss=0.00711 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=17.529 | 4497.4 samples/s | 70.3 steps/s
[Step=54050 Epoch=105.7] | Loss=0.01284 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.903 | L2-Norm(final)=17.532 | 5322.0 samples/s | 83.2 steps/s
[Step=54100 Epoch=105.8] | Loss=0.01211 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.903 | L2-Norm(final)=17.536 | 5474.8 samples/s | 85.5 steps/s
[Step=54150 Epoch=105.9] | Loss=0.01134 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.542 | 5607.2 samples/s | 87.6 steps/s
[Step=54200 Epoch=106.0] | Loss=0.01093 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.549 | 5492.3 samples/s | 85.8 steps/s
[Step=54250 Epoch=106.1] | Loss=0.01127 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.556 | 5434.3 samples/s | 84.9 steps/s
[Step=54300 Epoch=106.2] | Loss=0.01115 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.903 | L2-Norm(final)=17.563 | 5554.7 samples/s | 86.8 steps/s
[Step=54350 Epoch=106.3] | Loss=0.01082 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.570 | 5533.1 samples/s | 86.5 steps/s
[Step=54400 Epoch=106.4] | Loss=0.01085 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.577 | 5520.2 samples/s | 86.3 steps/s
[Step=54450 Epoch=106.4] | Loss=0.01101 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.585 | 5617.0 samples/s | 87.8 steps/s
[Step=54500 Epoch=106.5] | Loss=0.01083 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.593 | 7008.4 samples/s | 109.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=54501 Epoch=106.5] | Loss=0.00253 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.667 | 4767.4 samples/s | 74.5 steps/s
[Step=54550 Epoch=106.6] | Loss=0.01075 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.929 | L2-Norm(final)=17.670 | 4434.3 samples/s | 69.3 steps/s
[Step=54600 Epoch=106.7] | Loss=0.01089 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.948 | L2-Norm(final)=17.669 | 4682.3 samples/s | 73.2 steps/s
[Step=54650 Epoch=106.8] | Loss=0.01164 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.963 | L2-Norm(final)=17.666 | 4776.8 samples/s | 74.6 steps/s
[Step=54700 Epoch=106.9] | Loss=0.01190 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.975 | L2-Norm(final)=17.664 | 4774.3 samples/s | 74.6 steps/s
[Step=54750 Epoch=107.0] | Loss=0.01148 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.986 | L2-Norm(final)=17.662 | 4681.6 samples/s | 73.1 steps/s
[Step=54800 Epoch=107.1] | Loss=0.01107 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.994 | L2-Norm(final)=17.662 | 4655.8 samples/s | 72.7 steps/s
[Step=54850 Epoch=107.2] | Loss=0.01085 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.001 | L2-Norm(final)=17.662 | 4801.8 samples/s | 75.0 steps/s
[Step=54900 Epoch=107.3] | Loss=0.01091 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.007 | L2-Norm(final)=17.663 | 4765.1 samples/s | 74.5 steps/s
[Step=54950 Epoch=107.4] | Loss=0.01086 | Reg=0.00144 | acc=0.9688 | L2-Norm=12.014 | L2-Norm(final)=17.663 | 4808.7 samples/s | 75.1 steps/s
[Step=55000 Epoch=107.5] | Loss=0.01089 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.020 | L2-Norm(final)=17.663 | 5881.0 samples/s | 91.9 steps/s
[Step=55050 Epoch=107.6] | Loss=0.01052 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.026 | L2-Norm(final)=17.664 | 2097.0 samples/s | 32.8 steps/s
[Step=55100 Epoch=107.7] | Loss=0.01047 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.032 | L2-Norm(final)=17.665 | 4774.9 samples/s | 74.6 steps/s
[Step=55150 Epoch=107.8] | Loss=0.01024 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.037 | L2-Norm(final)=17.665 | 4738.5 samples/s | 74.0 steps/s
[Step=55200 Epoch=107.9] | Loss=0.01014 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.042 | L2-Norm(final)=17.666 | 4733.6 samples/s | 74.0 steps/s
[Step=55250 Epoch=108.0] | Loss=0.00998 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.046 | L2-Norm(final)=17.666 | 4775.4 samples/s | 74.6 steps/s
[Step=55300 Epoch=108.1] | Loss=0.00975 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.051 | L2-Norm(final)=17.667 | 4784.9 samples/s | 74.8 steps/s
[Step=55350 Epoch=108.2] | Loss=0.00964 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.055 | L2-Norm(final)=17.667 | 4796.4 samples/s | 74.9 steps/s
[Step=55400 Epoch=108.3] | Loss=0.00952 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.058 | L2-Norm(final)=17.667 | 4776.5 samples/s | 74.6 steps/s
[Step=55450 Epoch=108.4] | Loss=0.00936 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.062 | L2-Norm(final)=17.668 | 4818.6 samples/s | 75.3 steps/s
[Step=55500 Epoch=108.5] | Loss=0.00925 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.066 | L2-Norm(final)=17.668 | 4994.7 samples/s | 78.0 steps/s
[Step=55550 Epoch=108.6] | Loss=0.00915 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.069 | L2-Norm(final)=17.669 | 2192.4 samples/s | 34.3 steps/s
[Step=55600 Epoch=108.7] | Loss=0.00895 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.072 | L2-Norm(final)=17.670 | 4790.2 samples/s | 74.8 steps/s
[Step=55650 Epoch=108.8] | Loss=0.00885 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.076 | L2-Norm(final)=17.670 | 4759.3 samples/s | 74.4 steps/s
[Step=55700 Epoch=108.9] | Loss=0.00879 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.079 | L2-Norm(final)=17.671 | 4791.1 samples/s | 74.9 steps/s
[Step=55750 Epoch=109.0] | Loss=0.00868 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.082 | L2-Norm(final)=17.672 | 4854.2 samples/s | 75.8 steps/s
[Step=55800 Epoch=109.1] | Loss=0.00859 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.084 | L2-Norm(final)=17.672 | 4768.7 samples/s | 74.5 steps/s
[Step=55850 Epoch=109.2] | Loss=0.00857 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.087 | L2-Norm(final)=17.673 | 4736.1 samples/s | 74.0 steps/s
[Step=55900 Epoch=109.3] | Loss=0.00849 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.090 | L2-Norm(final)=17.673 | 4819.6 samples/s | 75.3 steps/s
[Step=55950 Epoch=109.4] | Loss=0.00840 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.093 | L2-Norm(final)=17.674 | 4760.9 samples/s | 74.4 steps/s
[Step=56000 Epoch=109.5] | Loss=0.00842 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.095 | L2-Norm(final)=17.674 | 4826.3 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step56000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=54001 Epoch=206.9] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=16.226 | 4386.0 samples/s | 68.5 steps/s
[Step=54050 Epoch=207.1] | Loss=0.00004 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=16.228 | 5099.6 samples/s | 79.7 steps/s
[Step=54100 Epoch=207.3] | Loss=0.00004 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=16.230 | 5147.8 samples/s | 80.4 steps/s
[Step=54150 Epoch=207.5] | Loss=0.00004 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=16.232 | 5243.7 samples/s | 81.9 steps/s
[Step=54200 Epoch=207.7] | Loss=0.00004 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=16.234 | 5223.8 samples/s | 81.6 steps/s
[Step=54250 Epoch=207.9] | Loss=0.00004 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=16.236 | 6803.0 samples/s | 106.3 steps/s
[Step=54300 Epoch=208.1] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=16.238 | 2132.8 samples/s | 33.3 steps/s
[Step=54350 Epoch=208.3] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=16.241 | 5364.8 samples/s | 83.8 steps/s
[Step=54400 Epoch=208.4] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=16.243 | 5044.2 samples/s | 78.8 steps/s
[Step=54450 Epoch=208.6] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=16.245 | 5185.6 samples/s | 81.0 steps/s
[Step=54500 Epoch=208.8] | Loss=0.00004 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=16.248 | 5897.7 samples/s | 92.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=54501 Epoch=208.8] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=16.272 | 4447.6 samples/s | 69.5 steps/s
[Step=54550 Epoch=209.0] | Loss=0.00002 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.896 | L2-Norm(final)=16.274 | 4550.4 samples/s | 71.1 steps/s
[Step=54600 Epoch=209.2] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.888 | L2-Norm(final)=16.275 | 4508.6 samples/s | 70.4 steps/s
[Step=54650 Epoch=209.4] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.880 | L2-Norm(final)=16.277 | 4538.2 samples/s | 70.9 steps/s
[Step=54700 Epoch=209.6] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=16.279 | 4538.4 samples/s | 70.9 steps/s
[Step=54750 Epoch=209.8] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.864 | L2-Norm(final)=16.281 | 5720.1 samples/s | 89.4 steps/s
[Step=54800 Epoch=210.0] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.855 | L2-Norm(final)=16.282 | 2013.7 samples/s | 31.5 steps/s
[Step=54850 Epoch=210.2] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.846 | L2-Norm(final)=16.284 | 4529.6 samples/s | 70.8 steps/s
[Step=54900 Epoch=210.4] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=16.285 | 4393.2 samples/s | 68.6 steps/s
[Step=54950 Epoch=210.5] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.828 | L2-Norm(final)=16.286 | 4388.9 samples/s | 68.6 steps/s
[Step=55000 Epoch=210.7] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.819 | L2-Norm(final)=16.287 | 4869.9 samples/s | 76.1 steps/s
[Step=55050 Epoch=210.9] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=16.288 | 2102.5 samples/s | 32.9 steps/s
[Step=55100 Epoch=211.1] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.801 | L2-Norm(final)=16.289 | 4498.2 samples/s | 70.3 steps/s
[Step=55150 Epoch=211.3] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.792 | L2-Norm(final)=16.290 | 4610.4 samples/s | 72.0 steps/s
[Step=55200 Epoch=211.5] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.783 | L2-Norm(final)=16.291 | 4526.5 samples/s | 70.7 steps/s
[Step=55250 Epoch=211.7] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.774 | L2-Norm(final)=16.292 | 4486.3 samples/s | 70.1 steps/s
[Step=55300 Epoch=211.9] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.765 | L2-Norm(final)=16.293 | 2193.3 samples/s | 34.3 steps/s
[Step=55350 Epoch=212.1] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.756 | L2-Norm(final)=16.294 | 4572.7 samples/s | 71.4 steps/s
[Step=55400 Epoch=212.3] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.747 | L2-Norm(final)=16.294 | 4569.6 samples/s | 71.4 steps/s
[Step=55450 Epoch=212.5] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=16.295 | 4539.3 samples/s | 70.9 steps/s
[Step=55500 Epoch=212.7] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.728 | L2-Norm(final)=16.296 | 4549.2 samples/s | 71.1 steps/s
[Step=55550 Epoch=212.8] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.719 | L2-Norm(final)=16.297 | 2209.7 samples/s | 34.5 steps/s
[Step=55600 Epoch=213.0] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.710 | L2-Norm(final)=16.298 | 4408.0 samples/s | 68.9 steps/s
[Step=55650 Epoch=213.2] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.700 | L2-Norm(final)=16.299 | 4511.1 samples/s | 70.5 steps/s
[Step=55700 Epoch=213.4] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.691 | L2-Norm(final)=16.300 | 4583.7 samples/s | 71.6 steps/s
[Step=55750 Epoch=213.6] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.681 | L2-Norm(final)=16.301 | 4554.7 samples/s | 71.2 steps/s
[Step=55800 Epoch=213.8] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=16.302 | 6240.4 samples/s | 97.5 steps/s
[Step=55850 Epoch=214.0] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.662 | L2-Norm(final)=16.302 | 1961.0 samples/s | 30.6 steps/s
[Step=55900 Epoch=214.2] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.652 | L2-Norm(final)=16.303 | 4576.1 samples/s | 71.5 steps/s
[Step=55950 Epoch=214.4] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.642 | L2-Norm(final)=16.304 | 4567.2 samples/s | 71.4 steps/s
[Step=56000 Epoch=214.6] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.632 | L2-Norm(final)=16.305 | 4619.6 samples/s | 72.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step56000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=54001 Epoch=207.9] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=17.345 | 4727.5 samples/s | 73.9 steps/s
[Step=54050 Epoch=208.1] | Loss=0.00007 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.901 | L2-Norm(final)=17.348 | 4842.5 samples/s | 75.7 steps/s
[Step=54100 Epoch=208.3] | Loss=0.00007 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=17.351 | 5276.1 samples/s | 82.4 steps/s
[Step=54150 Epoch=208.4] | Loss=0.00006 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=17.354 | 4979.3 samples/s | 77.8 steps/s
[Step=54200 Epoch=208.6] | Loss=0.00006 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=17.357 | 5238.9 samples/s | 81.9 steps/s
[Step=54250 Epoch=208.8] | Loss=0.00006 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=17.360 | 7013.1 samples/s | 109.6 steps/s
[Step=54300 Epoch=209.0] | Loss=0.00006 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=17.362 | 2106.7 samples/s | 32.9 steps/s
[Step=54350 Epoch=209.2] | Loss=0.00006 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=17.365 | 5175.2 samples/s | 80.9 steps/s
[Step=54400 Epoch=209.4] | Loss=0.00006 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=17.368 | 5214.7 samples/s | 81.5 steps/s
[Step=54450 Epoch=209.6] | Loss=0.00006 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=17.371 | 5354.3 samples/s | 83.7 steps/s
[Step=54500 Epoch=209.8] | Loss=0.00006 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=17.373 | 5854.0 samples/s | 91.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=54501 Epoch=209.8] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=17.403 | 4800.3 samples/s | 75.0 steps/s
[Step=54550 Epoch=210.0] | Loss=0.00004 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.406 | 4020.9 samples/s | 62.8 steps/s
[Step=54600 Epoch=210.2] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.906 | L2-Norm(final)=17.407 | 4531.9 samples/s | 70.8 steps/s
[Step=54650 Epoch=210.4] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.904 | L2-Norm(final)=17.408 | 4526.6 samples/s | 70.7 steps/s
[Step=54700 Epoch=210.6] | Loss=0.00002 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=17.409 | 4545.6 samples/s | 71.0 steps/s
[Step=54750 Epoch=210.8] | Loss=0.00002 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.894 | L2-Norm(final)=17.410 | 5870.6 samples/s | 91.7 steps/s
[Step=54800 Epoch=210.9] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.889 | L2-Norm(final)=17.411 | 2005.3 samples/s | 31.3 steps/s
[Step=54850 Epoch=211.1] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.883 | L2-Norm(final)=17.411 | 4475.4 samples/s | 69.9 steps/s
[Step=54900 Epoch=211.3] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.876 | L2-Norm(final)=17.412 | 4561.1 samples/s | 71.3 steps/s
[Step=54950 Epoch=211.5] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.870 | L2-Norm(final)=17.413 | 4566.7 samples/s | 71.4 steps/s
[Step=55000 Epoch=211.7] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.864 | L2-Norm(final)=17.413 | 5088.3 samples/s | 79.5 steps/s
[Step=55050 Epoch=211.9] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.857 | L2-Norm(final)=17.414 | 2087.3 samples/s | 32.6 steps/s
[Step=55100 Epoch=212.1] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.851 | L2-Norm(final)=17.414 | 4510.1 samples/s | 70.5 steps/s
[Step=55150 Epoch=212.3] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.844 | L2-Norm(final)=17.415 | 4531.3 samples/s | 70.8 steps/s
[Step=55200 Epoch=212.5] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=17.415 | 4525.8 samples/s | 70.7 steps/s
[Step=55250 Epoch=212.7] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.831 | L2-Norm(final)=17.416 | 4626.3 samples/s | 72.3 steps/s
[Step=55300 Epoch=212.9] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=17.416 | 2184.4 samples/s | 34.1 steps/s
[Step=55350 Epoch=213.1] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.817 | L2-Norm(final)=17.417 | 4681.6 samples/s | 73.1 steps/s
[Step=55400 Epoch=213.3] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=17.417 | 4523.5 samples/s | 70.7 steps/s
[Step=55450 Epoch=213.4] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.803 | L2-Norm(final)=17.418 | 4509.4 samples/s | 70.5 steps/s
[Step=55500 Epoch=213.6] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.796 | L2-Norm(final)=17.418 | 4531.7 samples/s | 70.8 steps/s
[Step=55550 Epoch=213.8] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.789 | L2-Norm(final)=17.419 | 2204.1 samples/s | 34.4 steps/s
[Step=55600 Epoch=214.0] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.782 | L2-Norm(final)=17.419 | 4513.5 samples/s | 70.5 steps/s
[Step=55650 Epoch=214.2] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.775 | L2-Norm(final)=17.419 | 4545.8 samples/s | 71.0 steps/s
[Step=55700 Epoch=214.4] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.768 | L2-Norm(final)=17.420 | 4553.5 samples/s | 71.1 steps/s
[Step=55750 Epoch=214.6] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.760 | L2-Norm(final)=17.420 | 4526.1 samples/s | 70.7 steps/s
[Step=55800 Epoch=214.8] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.753 | L2-Norm(final)=17.421 | 6600.5 samples/s | 103.1 steps/s
[Step=55850 Epoch=215.0] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.745 | L2-Norm(final)=17.421 | 1901.2 samples/s | 29.7 steps/s
[Step=55900 Epoch=215.2] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=17.421 | 4576.5 samples/s | 71.5 steps/s
[Step=55950 Epoch=215.4] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.730 | L2-Norm(final)=17.422 | 4512.6 samples/s | 70.5 steps/s
[Step=56000 Epoch=215.6] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.722 | L2-Norm(final)=17.422 | 4627.6 samples/s | 72.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step56000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08042 | acc=0.9684 | tpr=0.9773 | fpr=0.0508 | 4152.8 samples/s | 16.2 steps/s
Avg test loss: 0.07921, Avg test acc: 0.96807, Avg tpr: 0.97698, Avg fpr: 0.05153, total FA: 402

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07474 | acc=0.9695 | tpr=0.9739 | fpr=0.0401 | 4172.0 samples/s | 16.3 steps/s
Avg test loss: 0.07369, Avg test acc: 0.96827, Avg tpr: 0.97383, Avg fpr: 0.04397, total FA: 343

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.94380 | acc=0.2934 | tpr=0.0087 | fpr=0.0882 | 4124.2 samples/s | 16.1 steps/s
Avg test loss: 6.94644, Avg test acc: 0.29061, Avg tpr: 0.00874, Avg fpr: 0.08948, total FA: 698

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.92740 | acc=0.2867 | tpr=0.0106 | fpr=0.1137 | 4177.3 samples/s | 16.3 steps/s
Avg test loss: 6.93050, Avg test acc: 0.28368, Avg tpr: 0.01078, Avg fpr: 0.11614, total FA: 906

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.49903 | acc=0.1313 | tpr=0.5619 | fpr=0.8765 | 4263.4 samples/s | 16.7 steps/s
[Step= 100] | Loss=6.42787 | acc=0.1317 | tpr=0.5714 | fpr=0.8765 | 7626.7 samples/s | 29.8 steps/s
[Step= 150] | Loss=6.43406 | acc=0.1308 | tpr=0.5677 | fpr=0.8773 | 7735.5 samples/s | 30.2 steps/s
[Step= 200] | Loss=6.42587 | acc=0.1319 | tpr=0.5705 | fpr=0.8761 | 7942.5 samples/s | 31.0 steps/s
[Step= 250] | Loss=6.42333 | acc=0.1317 | tpr=0.5607 | fpr=0.8761 | 7990.1 samples/s | 31.2 steps/s
[Step= 300] | Loss=6.43222 | acc=0.1309 | tpr=0.5556 | fpr=0.8768 | 7910.1 samples/s | 30.9 steps/s
[Step= 350] | Loss=6.44224 | acc=0.1307 | tpr=0.5560 | fpr=0.8770 | 8341.4 samples/s | 32.6 steps/s
[Step= 400] | Loss=6.43282 | acc=0.1304 | tpr=0.5460 | fpr=0.8771 | 7476.5 samples/s | 29.2 steps/s
[Step= 450] | Loss=6.43557 | acc=0.1300 | tpr=0.5438 | fpr=0.8775 | 8291.0 samples/s | 32.4 steps/s
[Step= 500] | Loss=6.43922 | acc=0.1298 | tpr=0.5480 | fpr=0.8777 | 7251.8 samples/s | 28.3 steps/s
[Step= 550] | Loss=6.44141 | acc=0.1300 | tpr=0.5535 | fpr=0.8777 | 14737.2 samples/s | 57.6 steps/s
Avg test loss: 6.44161, Avg test acc: 0.12986, Avg tpr: 0.55349, Avg fpr: 0.87784, total FA: 121886

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.11787 | acc=0.1479 | tpr=0.4204 | fpr=0.8570 | 4193.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.04500 | acc=0.1493 | tpr=0.4350 | fpr=0.8560 | 7907.9 samples/s | 30.9 steps/s
[Step= 150] | Loss=6.06203 | acc=0.1482 | tpr=0.4323 | fpr=0.8571 | 7563.4 samples/s | 29.5 steps/s
[Step= 200] | Loss=6.05479 | acc=0.1489 | tpr=0.4339 | fpr=0.8563 | 7888.9 samples/s | 30.8 steps/s
[Step= 250] | Loss=6.05185 | acc=0.1492 | tpr=0.4332 | fpr=0.8560 | 8058.2 samples/s | 31.5 steps/s
[Step= 300] | Loss=6.05881 | acc=0.1484 | tpr=0.4305 | fpr=0.8567 | 7890.4 samples/s | 30.8 steps/s
[Step= 350] | Loss=6.06868 | acc=0.1479 | tpr=0.4296 | fpr=0.8572 | 7742.6 samples/s | 30.2 steps/s
[Step= 400] | Loss=6.05814 | acc=0.1474 | tpr=0.4168 | fpr=0.8575 | 8076.9 samples/s | 31.6 steps/s
[Step= 450] | Loss=6.05916 | acc=0.1468 | tpr=0.4158 | fpr=0.8581 | 7753.8 samples/s | 30.3 steps/s
[Step= 500] | Loss=6.06192 | acc=0.1466 | tpr=0.4167 | fpr=0.8583 | 7574.2 samples/s | 29.6 steps/s
[Step= 550] | Loss=6.06574 | acc=0.1466 | tpr=0.4158 | fpr=0.8583 | 15590.2 samples/s | 60.9 steps/s
Avg test loss: 6.06634, Avg test acc: 0.14656, Avg tpr: 0.41521, Avg fpr: 0.85833, total FA: 119177

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13676 | acc=0.9794 | tpr=0.9336 | fpr=0.0198 | 4141.8 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.14645 | acc=0.9783 | tpr=0.9446 | fpr=0.0210 | 7956.0 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.14796 | acc=0.9779 | tpr=0.9510 | fpr=0.0216 | 8273.4 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.14986 | acc=0.9780 | tpr=0.9552 | fpr=0.0216 | 7524.6 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.14887 | acc=0.9778 | tpr=0.9546 | fpr=0.0217 | 8215.6 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.15175 | acc=0.9776 | tpr=0.9556 | fpr=0.0220 | 7668.3 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.15182 | acc=0.9776 | tpr=0.9530 | fpr=0.0219 | 7784.9 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.15336 | acc=0.9774 | tpr=0.9524 | fpr=0.0221 | 8077.4 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.15516 | acc=0.9772 | tpr=0.9499 | fpr=0.0223 | 7843.5 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.15378 | acc=0.9774 | tpr=0.9515 | fpr=0.0221 | 7585.8 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.15255 | acc=0.9776 | tpr=0.9522 | fpr=0.0219 | 14503.5 samples/s | 56.7 steps/s
Avg test loss: 0.15220, Avg test acc: 0.97763, Avg tpr: 0.95246, Avg fpr: 0.02192, total FA: 3043

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15313 | acc=0.9777 | tpr=0.9381 | fpr=0.0216 | 4385.9 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.16468 | acc=0.9771 | tpr=0.9510 | fpr=0.0224 | 7032.4 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.16636 | acc=0.9768 | tpr=0.9582 | fpr=0.0228 | 8002.7 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.16848 | acc=0.9770 | tpr=0.9607 | fpr=0.0228 | 7841.9 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.16763 | acc=0.9768 | tpr=0.9590 | fpr=0.0229 | 7940.2 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.17115 | acc=0.9765 | tpr=0.9600 | fpr=0.0232 | 8054.7 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.17139 | acc=0.9764 | tpr=0.9574 | fpr=0.0233 | 7833.7 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.17319 | acc=0.9761 | tpr=0.9568 | fpr=0.0236 | 7823.4 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.17511 | acc=0.9758 | tpr=0.9542 | fpr=0.0238 | 7801.8 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.17361 | acc=0.9760 | tpr=0.9555 | fpr=0.0237 | 7742.8 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.17235 | acc=0.9762 | tpr=0.9562 | fpr=0.0235 | 14423.7 samples/s | 56.3 steps/s
Avg test loss: 0.17202, Avg test acc: 0.97620, Avg tpr: 0.95642, Avg fpr: 0.02344, total FA: 3254

server round 28/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=56001 Epoch=109.2] | Loss=0.00576 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=17.534 | 4437.0 samples/s | 69.3 steps/s
[Step=56050 Epoch=109.3] | Loss=0.00727 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.732 | L2-Norm(final)=17.540 | 5086.2 samples/s | 79.5 steps/s
[Step=56100 Epoch=109.4] | Loss=0.00713 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.733 | L2-Norm(final)=17.544 | 5542.5 samples/s | 86.6 steps/s
[Step=56150 Epoch=109.5] | Loss=0.00758 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.733 | L2-Norm(final)=17.547 | 5598.6 samples/s | 87.5 steps/s
[Step=56200 Epoch=109.6] | Loss=0.00743 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.733 | L2-Norm(final)=17.551 | 5459.8 samples/s | 85.3 steps/s
[Step=56250 Epoch=109.7] | Loss=0.00797 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.733 | L2-Norm(final)=17.555 | 5548.9 samples/s | 86.7 steps/s
[Step=56300 Epoch=109.8] | Loss=0.00778 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.733 | L2-Norm(final)=17.559 | 5486.6 samples/s | 85.7 steps/s
[Step=56350 Epoch=109.9] | Loss=0.00752 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.733 | L2-Norm(final)=17.564 | 5501.6 samples/s | 86.0 steps/s
[Step=56400 Epoch=110.0] | Loss=0.00748 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.733 | L2-Norm(final)=17.568 | 5519.2 samples/s | 86.2 steps/s
[Step=56450 Epoch=110.1] | Loss=0.00753 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.733 | L2-Norm(final)=17.573 | 5538.1 samples/s | 86.5 steps/s
[Step=56500 Epoch=110.2] | Loss=0.00755 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.733 | L2-Norm(final)=17.578 | 7013.4 samples/s | 109.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=56501 Epoch=110.2] | Loss=0.00422 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.733 | L2-Norm(final)=17.626 | 4278.5 samples/s | 66.9 steps/s
[Step=56550 Epoch=110.3] | Loss=0.00945 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.748 | L2-Norm(final)=17.626 | 4612.5 samples/s | 72.1 steps/s
[Step=56600 Epoch=110.4] | Loss=0.01085 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.761 | L2-Norm(final)=17.625 | 4791.9 samples/s | 74.9 steps/s
[Step=56650 Epoch=110.5] | Loss=0.00996 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.772 | L2-Norm(final)=17.625 | 4686.1 samples/s | 73.2 steps/s
[Step=56700 Epoch=110.6] | Loss=0.01007 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.782 | L2-Norm(final)=17.626 | 4778.3 samples/s | 74.7 steps/s
[Step=56750 Epoch=110.7] | Loss=0.00942 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.792 | L2-Norm(final)=17.627 | 4745.7 samples/s | 74.2 steps/s
[Step=56800 Epoch=110.8] | Loss=0.00996 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.801 | L2-Norm(final)=17.629 | 4795.0 samples/s | 74.9 steps/s
[Step=56850 Epoch=110.9] | Loss=0.00995 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.809 | L2-Norm(final)=17.630 | 4793.7 samples/s | 74.9 steps/s
[Step=56900 Epoch=111.0] | Loss=0.00992 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.817 | L2-Norm(final)=17.632 | 4803.4 samples/s | 75.1 steps/s
[Step=56950 Epoch=111.1] | Loss=0.00981 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.824 | L2-Norm(final)=17.634 | 4770.6 samples/s | 74.5 steps/s
[Step=57000 Epoch=111.2] | Loss=0.00983 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.831 | L2-Norm(final)=17.635 | 5797.6 samples/s | 90.6 steps/s
[Step=57050 Epoch=111.3] | Loss=0.00956 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=17.637 | 2051.3 samples/s | 32.1 steps/s
[Step=57100 Epoch=111.4] | Loss=0.00929 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.844 | L2-Norm(final)=17.639 | 4678.8 samples/s | 73.1 steps/s
[Step=57150 Epoch=111.5] | Loss=0.00923 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.849 | L2-Norm(final)=17.640 | 4787.5 samples/s | 74.8 steps/s
[Step=57200 Epoch=111.6] | Loss=0.00912 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.854 | L2-Norm(final)=17.642 | 4759.3 samples/s | 74.4 steps/s
[Step=57250 Epoch=111.7] | Loss=0.00913 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.860 | L2-Norm(final)=17.643 | 4789.4 samples/s | 74.8 steps/s
[Step=57300 Epoch=111.8] | Loss=0.00898 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.865 | L2-Norm(final)=17.644 | 4819.6 samples/s | 75.3 steps/s
[Step=57350 Epoch=111.9] | Loss=0.00902 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.869 | L2-Norm(final)=17.646 | 4749.5 samples/s | 74.2 steps/s
[Step=57400 Epoch=112.0] | Loss=0.00894 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.874 | L2-Norm(final)=17.647 | 4822.2 samples/s | 75.3 steps/s
[Step=57450 Epoch=112.0] | Loss=0.00882 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.879 | L2-Norm(final)=17.649 | 4752.4 samples/s | 74.3 steps/s
[Step=57500 Epoch=112.1] | Loss=0.00876 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.883 | L2-Norm(final)=17.650 | 5113.3 samples/s | 79.9 steps/s
[Step=57550 Epoch=112.2] | Loss=0.00872 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.887 | L2-Norm(final)=17.652 | 2118.1 samples/s | 33.1 steps/s
[Step=57600 Epoch=112.3] | Loss=0.00859 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.891 | L2-Norm(final)=17.653 | 4715.0 samples/s | 73.7 steps/s
[Step=57650 Epoch=112.4] | Loss=0.00852 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.895 | L2-Norm(final)=17.655 | 4822.4 samples/s | 75.4 steps/s
[Step=57700 Epoch=112.5] | Loss=0.00844 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.899 | L2-Norm(final)=17.657 | 4784.1 samples/s | 74.8 steps/s
[Step=57750 Epoch=112.6] | Loss=0.00830 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.903 | L2-Norm(final)=17.658 | 4798.2 samples/s | 75.0 steps/s
[Step=57800 Epoch=112.7] | Loss=0.00827 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.906 | L2-Norm(final)=17.660 | 4840.8 samples/s | 75.6 steps/s
[Step=57850 Epoch=112.8] | Loss=0.00821 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.910 | L2-Norm(final)=17.661 | 4815.3 samples/s | 75.2 steps/s
[Step=57900 Epoch=112.9] | Loss=0.00816 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.913 | L2-Norm(final)=17.663 | 4781.1 samples/s | 74.7 steps/s
[Step=57950 Epoch=113.0] | Loss=0.00804 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.917 | L2-Norm(final)=17.664 | 4806.6 samples/s | 75.1 steps/s
[Step=58000 Epoch=113.1] | Loss=0.00810 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.920 | L2-Norm(final)=17.666 | 4793.9 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step58000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=56001 Epoch=109.5] | Loss=0.00099 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=17.686 | 4941.4 samples/s | 77.2 steps/s
[Step=56050 Epoch=109.6] | Loss=0.00821 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=17.689 | 4535.9 samples/s | 70.9 steps/s
[Step=56100 Epoch=109.7] | Loss=0.00733 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=17.694 | 5505.8 samples/s | 86.0 steps/s
[Step=56150 Epoch=109.8] | Loss=0.00691 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=17.700 | 5639.9 samples/s | 88.1 steps/s
[Step=56200 Epoch=109.9] | Loss=0.00741 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=17.705 | 5394.3 samples/s | 84.3 steps/s
[Step=56250 Epoch=110.0] | Loss=0.00722 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=17.710 | 5549.9 samples/s | 86.7 steps/s
[Step=56300 Epoch=110.1] | Loss=0.00737 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=17.714 | 5486.6 samples/s | 85.7 steps/s
[Step=56350 Epoch=110.2] | Loss=0.00731 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=17.719 | 5593.3 samples/s | 87.4 steps/s
[Step=56400 Epoch=110.3] | Loss=0.00743 | Reg=0.00138 | acc=0.9531 | L2-Norm=11.732 | L2-Norm(final)=17.723 | 5659.3 samples/s | 88.4 steps/s
[Step=56450 Epoch=110.4] | Loss=0.00764 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.732 | L2-Norm(final)=17.728 | 5550.1 samples/s | 86.7 steps/s
[Step=56500 Epoch=110.5] | Loss=0.00754 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=17.732 | 7006.8 samples/s | 109.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=56501 Epoch=110.5] | Loss=0.00672 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=17.777 | 4684.2 samples/s | 73.2 steps/s
[Step=56550 Epoch=110.6] | Loss=0.00603 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.749 | L2-Norm(final)=17.779 | 4481.9 samples/s | 70.0 steps/s
[Step=56600 Epoch=110.7] | Loss=0.00875 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.763 | L2-Norm(final)=17.782 | 4812.7 samples/s | 75.2 steps/s
[Step=56650 Epoch=110.7] | Loss=0.00945 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.773 | L2-Norm(final)=17.781 | 4740.3 samples/s | 74.1 steps/s
[Step=56700 Epoch=110.8] | Loss=0.00966 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.784 | L2-Norm(final)=17.781 | 4752.7 samples/s | 74.3 steps/s
[Step=56750 Epoch=110.9] | Loss=0.00931 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.794 | L2-Norm(final)=17.781 | 4767.5 samples/s | 74.5 steps/s
[Step=56800 Epoch=111.0] | Loss=0.00910 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.803 | L2-Norm(final)=17.783 | 4797.5 samples/s | 75.0 steps/s
[Step=56850 Epoch=111.1] | Loss=0.00904 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.810 | L2-Norm(final)=17.784 | 4755.9 samples/s | 74.3 steps/s
[Step=56900 Epoch=111.2] | Loss=0.00919 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.816 | L2-Norm(final)=17.785 | 4806.5 samples/s | 75.1 steps/s
[Step=56950 Epoch=111.3] | Loss=0.00935 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.822 | L2-Norm(final)=17.786 | 4739.6 samples/s | 74.1 steps/s
[Step=57000 Epoch=111.4] | Loss=0.00937 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.828 | L2-Norm(final)=17.787 | 5935.1 samples/s | 92.7 steps/s
[Step=57050 Epoch=111.5] | Loss=0.00917 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.833 | L2-Norm(final)=17.789 | 2086.9 samples/s | 32.6 steps/s
[Step=57100 Epoch=111.6] | Loss=0.00896 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=17.790 | 4763.7 samples/s | 74.4 steps/s
[Step=57150 Epoch=111.7] | Loss=0.00882 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.842 | L2-Norm(final)=17.791 | 4787.7 samples/s | 74.8 steps/s
[Step=57200 Epoch=111.8] | Loss=0.00877 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.846 | L2-Norm(final)=17.793 | 4778.4 samples/s | 74.7 steps/s
[Step=57250 Epoch=111.9] | Loss=0.00867 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.850 | L2-Norm(final)=17.794 | 4864.8 samples/s | 76.0 steps/s
[Step=57300 Epoch=112.0] | Loss=0.00845 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.854 | L2-Norm(final)=17.795 | 4768.0 samples/s | 74.5 steps/s
[Step=57350 Epoch=112.1] | Loss=0.00836 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.857 | L2-Norm(final)=17.796 | 4769.9 samples/s | 74.5 steps/s
[Step=57400 Epoch=112.2] | Loss=0.00825 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.861 | L2-Norm(final)=17.798 | 4808.8 samples/s | 75.1 steps/s
[Step=57450 Epoch=112.3] | Loss=0.00817 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.864 | L2-Norm(final)=17.799 | 4833.3 samples/s | 75.5 steps/s
[Step=57500 Epoch=112.4] | Loss=0.00803 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.868 | L2-Norm(final)=17.800 | 5144.0 samples/s | 80.4 steps/s
[Step=57550 Epoch=112.5] | Loss=0.00793 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.871 | L2-Norm(final)=17.802 | 2191.5 samples/s | 34.2 steps/s
[Step=57600 Epoch=112.6] | Loss=0.00793 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.874 | L2-Norm(final)=17.803 | 4843.4 samples/s | 75.7 steps/s
[Step=57650 Epoch=112.7] | Loss=0.00783 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.878 | L2-Norm(final)=17.804 | 4710.5 samples/s | 73.6 steps/s
[Step=57700 Epoch=112.8] | Loss=0.00791 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.881 | L2-Norm(final)=17.806 | 4761.4 samples/s | 74.4 steps/s
[Step=57750 Epoch=112.9] | Loss=0.00801 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.884 | L2-Norm(final)=17.807 | 4796.3 samples/s | 74.9 steps/s
[Step=57800 Epoch=113.0] | Loss=0.00797 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.887 | L2-Norm(final)=17.807 | 4844.0 samples/s | 75.7 steps/s
[Step=57850 Epoch=113.1] | Loss=0.00789 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.890 | L2-Norm(final)=17.808 | 4694.8 samples/s | 73.4 steps/s
[Step=57900 Epoch=113.2] | Loss=0.00782 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.894 | L2-Norm(final)=17.809 | 4793.1 samples/s | 74.9 steps/s
[Step=57950 Epoch=113.3] | Loss=0.00781 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.897 | L2-Norm(final)=17.810 | 4777.9 samples/s | 74.7 steps/s
[Step=58000 Epoch=113.4] | Loss=0.00773 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=17.811 | 4822.0 samples/s | 75.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step58000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=56001 Epoch=214.6] | Loss=0.00005 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=16.333 | 4477.8 samples/s | 70.0 steps/s
[Step=56050 Epoch=214.8] | Loss=0.00003 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.728 | L2-Norm(final)=16.340 | 4554.3 samples/s | 71.2 steps/s
[Step=56100 Epoch=215.0] | Loss=0.00005 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.728 | L2-Norm(final)=16.350 | 5273.6 samples/s | 82.4 steps/s
[Step=56150 Epoch=215.1] | Loss=0.00005 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.728 | L2-Norm(final)=16.359 | 5142.7 samples/s | 80.4 steps/s
[Step=56200 Epoch=215.3] | Loss=0.00006 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.727 | L2-Norm(final)=16.370 | 5345.0 samples/s | 83.5 steps/s
[Step=56250 Epoch=215.5] | Loss=0.00006 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.727 | L2-Norm(final)=16.379 | 6620.8 samples/s | 103.5 steps/s
[Step=56300 Epoch=215.7] | Loss=0.00006 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.727 | L2-Norm(final)=16.387 | 2138.5 samples/s | 33.4 steps/s
[Step=56350 Epoch=215.9] | Loss=0.00006 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.727 | L2-Norm(final)=16.396 | 5167.8 samples/s | 80.7 steps/s
[Step=56400 Epoch=216.1] | Loss=0.00005 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.727 | L2-Norm(final)=16.404 | 5392.7 samples/s | 84.3 steps/s
[Step=56450 Epoch=216.3] | Loss=0.00005 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.727 | L2-Norm(final)=16.412 | 5032.9 samples/s | 78.6 steps/s
[Step=56500 Epoch=216.5] | Loss=0.00005 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.727 | L2-Norm(final)=16.419 | 5845.6 samples/s | 91.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=56501 Epoch=216.5] | Loss=0.00008 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.727 | L2-Norm(final)=16.494 | 4369.6 samples/s | 68.3 steps/s
[Step=56550 Epoch=216.7] | Loss=0.00002 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.720 | L2-Norm(final)=16.498 | 4378.6 samples/s | 68.4 steps/s
[Step=56600 Epoch=216.9] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.707 | L2-Norm(final)=16.501 | 4517.9 samples/s | 70.6 steps/s
[Step=56650 Epoch=217.1] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.689 | L2-Norm(final)=16.503 | 4521.0 samples/s | 70.6 steps/s
[Step=56700 Epoch=217.3] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=16.505 | 4581.8 samples/s | 71.6 steps/s
[Step=56750 Epoch=217.4] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=16.505 | 5621.2 samples/s | 87.8 steps/s
[Step=56800 Epoch=217.6] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.637 | L2-Norm(final)=16.506 | 1998.5 samples/s | 31.2 steps/s
[Step=56850 Epoch=217.8] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.618 | L2-Norm(final)=16.507 | 4524.5 samples/s | 70.7 steps/s
[Step=56900 Epoch=218.0] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.600 | L2-Norm(final)=16.507 | 4535.7 samples/s | 70.9 steps/s
[Step=56950 Epoch=218.2] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=16.508 | 4572.0 samples/s | 71.4 steps/s
[Step=57000 Epoch=218.4] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.562 | L2-Norm(final)=16.508 | 5014.3 samples/s | 78.3 steps/s
[Step=57050 Epoch=218.6] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.543 | L2-Norm(final)=16.509 | 2106.3 samples/s | 32.9 steps/s
[Step=57100 Epoch=218.8] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=16.509 | 4584.8 samples/s | 71.6 steps/s
[Step=57150 Epoch=219.0] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.505 | L2-Norm(final)=16.510 | 4519.9 samples/s | 70.6 steps/s
[Step=57200 Epoch=219.2] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.486 | L2-Norm(final)=16.510 | 4623.0 samples/s | 72.2 steps/s
[Step=57250 Epoch=219.4] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.467 | L2-Norm(final)=16.511 | 4546.8 samples/s | 71.0 steps/s
[Step=57300 Epoch=219.6] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.448 | L2-Norm(final)=16.511 | 2215.3 samples/s | 34.6 steps/s
[Step=57350 Epoch=219.7] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=16.512 | 4562.0 samples/s | 71.3 steps/s
[Step=57400 Epoch=219.9] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.410 | L2-Norm(final)=16.512 | 4559.5 samples/s | 71.2 steps/s
[Step=57450 Epoch=220.1] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.391 | L2-Norm(final)=16.513 | 4545.0 samples/s | 71.0 steps/s
[Step=57500 Epoch=220.3] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.371 | L2-Norm(final)=16.513 | 4538.0 samples/s | 70.9 steps/s
[Step=57550 Epoch=220.5] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=16.514 | 2189.2 samples/s | 34.2 steps/s
[Step=57600 Epoch=220.7] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.332 | L2-Norm(final)=16.514 | 4541.2 samples/s | 71.0 steps/s
[Step=57650 Epoch=220.9] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.313 | L2-Norm(final)=16.515 | 4586.6 samples/s | 71.7 steps/s
[Step=57700 Epoch=221.1] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=16.515 | 4601.0 samples/s | 71.9 steps/s
[Step=57750 Epoch=221.3] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.273 | L2-Norm(final)=16.516 | 4514.1 samples/s | 70.5 steps/s
[Step=57800 Epoch=221.5] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.253 | L2-Norm(final)=16.517 | 6184.4 samples/s | 96.6 steps/s
[Step=57850 Epoch=221.7] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.233 | L2-Norm(final)=16.517 | 1950.5 samples/s | 30.5 steps/s
[Step=57900 Epoch=221.9] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.213 | L2-Norm(final)=16.518 | 4500.6 samples/s | 70.3 steps/s
[Step=57950 Epoch=222.0] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=16.519 | 4548.1 samples/s | 71.1 steps/s
[Step=58000 Epoch=222.2] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=16.520 | 4608.4 samples/s | 72.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step58000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=56001 Epoch=215.6] | Loss=0.00004 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=17.434 | 4843.5 samples/s | 75.7 steps/s
[Step=56050 Epoch=215.8] | Loss=0.00004 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=17.440 | 4930.5 samples/s | 77.0 steps/s
[Step=56100 Epoch=216.0] | Loss=0.00006 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=17.447 | 5121.5 samples/s | 80.0 steps/s
[Step=56150 Epoch=216.1] | Loss=0.00008 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=17.456 | 5255.6 samples/s | 82.1 steps/s
[Step=56200 Epoch=216.3] | Loss=0.00007 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=17.466 | 5195.5 samples/s | 81.2 steps/s
[Step=56250 Epoch=216.5] | Loss=0.00008 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=17.474 | 6863.7 samples/s | 107.2 steps/s
[Step=56300 Epoch=216.7] | Loss=0.00008 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=17.482 | 2128.2 samples/s | 33.3 steps/s
[Step=56350 Epoch=216.9] | Loss=0.00007 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=17.490 | 5108.3 samples/s | 79.8 steps/s
[Step=56400 Epoch=217.1] | Loss=0.00007 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.728 | L2-Norm(final)=17.497 | 5343.6 samples/s | 83.5 steps/s
[Step=56450 Epoch=217.3] | Loss=0.00007 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.728 | L2-Norm(final)=17.504 | 5083.0 samples/s | 79.4 steps/s
[Step=56500 Epoch=217.5] | Loss=0.00007 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.728 | L2-Norm(final)=17.511 | 5968.7 samples/s | 93.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=56501 Epoch=217.5] | Loss=0.00008 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.728 | L2-Norm(final)=17.576 | 4438.7 samples/s | 69.4 steps/s
[Step=56550 Epoch=217.7] | Loss=0.00009 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=17.578 | 4378.9 samples/s | 68.4 steps/s
[Step=56600 Epoch=217.9] | Loss=0.00006 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.734 | L2-Norm(final)=17.580 | 4548.5 samples/s | 71.1 steps/s
[Step=56650 Epoch=218.1] | Loss=0.00005 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=17.582 | 4523.8 samples/s | 70.7 steps/s
[Step=56700 Epoch=218.3] | Loss=0.00004 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.726 | L2-Norm(final)=17.584 | 4551.3 samples/s | 71.1 steps/s
[Step=56750 Epoch=218.5] | Loss=0.00003 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.718 | L2-Norm(final)=17.585 | 5851.1 samples/s | 91.4 steps/s
[Step=56800 Epoch=218.6] | Loss=0.00003 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.708 | L2-Norm(final)=17.586 | 2005.8 samples/s | 31.3 steps/s
[Step=56850 Epoch=218.8] | Loss=0.00002 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=17.587 | 4528.4 samples/s | 70.8 steps/s
[Step=56900 Epoch=219.0] | Loss=0.00002 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.686 | L2-Norm(final)=17.588 | 4602.5 samples/s | 71.9 steps/s
[Step=56950 Epoch=219.2] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=17.588 | 4603.5 samples/s | 71.9 steps/s
[Step=57000 Epoch=219.4] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.663 | L2-Norm(final)=17.589 | 5129.7 samples/s | 80.2 steps/s
[Step=57050 Epoch=219.6] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.652 | L2-Norm(final)=17.589 | 2077.5 samples/s | 32.5 steps/s
[Step=57100 Epoch=219.8] | Loss=0.00002 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.640 | L2-Norm(final)=17.590 | 4590.5 samples/s | 71.7 steps/s
[Step=57150 Epoch=220.0] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.628 | L2-Norm(final)=17.590 | 4586.9 samples/s | 71.7 steps/s
[Step=57200 Epoch=220.2] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.615 | L2-Norm(final)=17.591 | 4535.3 samples/s | 70.9 steps/s
[Step=57250 Epoch=220.4] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.603 | L2-Norm(final)=17.591 | 4611.9 samples/s | 72.1 steps/s
[Step=57300 Epoch=220.6] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.590 | L2-Norm(final)=17.591 | 2184.6 samples/s | 34.1 steps/s
[Step=57350 Epoch=220.8] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.577 | L2-Norm(final)=17.592 | 4647.5 samples/s | 72.6 steps/s
[Step=57400 Epoch=221.0] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.564 | L2-Norm(final)=17.592 | 4506.1 samples/s | 70.4 steps/s
[Step=57450 Epoch=221.1] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.551 | L2-Norm(final)=17.592 | 4585.8 samples/s | 71.7 steps/s
[Step=57500 Epoch=221.3] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.538 | L2-Norm(final)=17.593 | 4516.7 samples/s | 70.6 steps/s
[Step=57550 Epoch=221.5] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=17.593 | 2176.2 samples/s | 34.0 steps/s
[Step=57600 Epoch=221.7] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=17.593 | 4728.9 samples/s | 73.9 steps/s
[Step=57650 Epoch=221.9] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.497 | L2-Norm(final)=17.593 | 4592.6 samples/s | 71.8 steps/s
[Step=57700 Epoch=222.1] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.483 | L2-Norm(final)=17.594 | 4513.2 samples/s | 70.5 steps/s
[Step=57750 Epoch=222.3] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.469 | L2-Norm(final)=17.594 | 4641.4 samples/s | 72.5 steps/s
[Step=57800 Epoch=222.5] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.455 | L2-Norm(final)=17.594 | 6516.4 samples/s | 101.8 steps/s
[Step=57850 Epoch=222.7] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.440 | L2-Norm(final)=17.595 | 1898.1 samples/s | 29.7 steps/s
[Step=57900 Epoch=222.9] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.426 | L2-Norm(final)=17.595 | 4554.7 samples/s | 71.2 steps/s
[Step=57950 Epoch=223.1] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.411 | L2-Norm(final)=17.595 | 4575.1 samples/s | 71.5 steps/s
[Step=58000 Epoch=223.3] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.397 | L2-Norm(final)=17.596 | 4560.2 samples/s | 71.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step58000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07468 | acc=0.9686 | tpr=0.9763 | fpr=0.0481 | 4105.9 samples/s | 16.0 steps/s
Avg test loss: 0.07345, Avg test acc: 0.96759, Avg tpr: 0.97610, Avg fpr: 0.05115, total FA: 399

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07328 | acc=0.9696 | tpr=0.9741 | fpr=0.0401 | 4193.5 samples/s | 16.4 steps/s
Avg test loss: 0.07168, Avg test acc: 0.96939, Avg tpr: 0.97459, Avg fpr: 0.04205, total FA: 328

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.72058 | acc=0.2991 | tpr=0.0078 | fpr=0.0684 | 4201.0 samples/s | 16.4 steps/s
Avg test loss: 6.72778, Avg test acc: 0.29602, Avg tpr: 0.00769, Avg fpr: 0.06986, total FA: 545

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.23902 | acc=0.2835 | tpr=0.0126 | fpr=0.1281 | 4197.3 samples/s | 16.4 steps/s
Avg test loss: 7.24264, Avg test acc: 0.28063, Avg tpr: 0.01212, Avg fpr: 0.12883, total FA: 1005

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.27817 | acc=0.1220 | tpr=0.5088 | fpr=0.8850 | 4201.0 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.21839 | acc=0.1234 | tpr=0.5203 | fpr=0.8840 | 7769.9 samples/s | 30.4 steps/s
[Step= 150] | Loss=6.22270 | acc=0.1222 | tpr=0.5245 | fpr=0.8852 | 4749.1 samples/s | 18.6 steps/s
[Step= 200] | Loss=6.21940 | acc=0.1225 | tpr=0.5213 | fpr=0.8847 | 7819.0 samples/s | 30.5 steps/s
[Step= 250] | Loss=6.21373 | acc=0.1219 | tpr=0.5135 | fpr=0.8852 | 7741.8 samples/s | 30.2 steps/s
[Step= 300] | Loss=6.22252 | acc=0.1213 | tpr=0.5062 | fpr=0.8857 | 8371.0 samples/s | 32.7 steps/s
[Step= 350] | Loss=6.23021 | acc=0.1210 | tpr=0.5022 | fpr=0.8859 | 7284.8 samples/s | 28.5 steps/s
[Step= 400] | Loss=6.21965 | acc=0.1207 | tpr=0.4940 | fpr=0.8860 | 7959.0 samples/s | 31.1 steps/s
[Step= 450] | Loss=6.22306 | acc=0.1202 | tpr=0.4912 | fpr=0.8865 | 8166.1 samples/s | 31.9 steps/s
[Step= 500] | Loss=6.22554 | acc=0.1200 | tpr=0.4960 | fpr=0.8868 | 7246.8 samples/s | 28.3 steps/s
[Step= 550] | Loss=6.22894 | acc=0.1201 | tpr=0.4970 | fpr=0.8868 | 14200.3 samples/s | 55.5 steps/s
Avg test loss: 6.23046, Avg test acc: 0.11997, Avg tpr: 0.49723, Avg fpr: 0.88688, total FA: 123142

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.01745 | acc=0.1457 | tpr=0.4204 | fpr=0.8592 | 4171.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=5.94110 | acc=0.1473 | tpr=0.4392 | fpr=0.8581 | 5004.0 samples/s | 19.5 steps/s
[Step= 150] | Loss=5.95356 | acc=0.1471 | tpr=0.4380 | fpr=0.8582 | 7159.1 samples/s | 28.0 steps/s
[Step= 200] | Loss=5.94613 | acc=0.1473 | tpr=0.4383 | fpr=0.8580 | 7798.1 samples/s | 30.5 steps/s
[Step= 250] | Loss=5.94696 | acc=0.1470 | tpr=0.4306 | fpr=0.8581 | 7947.9 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.95735 | acc=0.1461 | tpr=0.4276 | fpr=0.8591 | 7753.1 samples/s | 30.3 steps/s
[Step= 350] | Loss=5.96719 | acc=0.1457 | tpr=0.4233 | fpr=0.8594 | 7811.4 samples/s | 30.5 steps/s
[Step= 400] | Loss=5.95780 | acc=0.1449 | tpr=0.4136 | fpr=0.8599 | 8034.2 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.95941 | acc=0.1447 | tpr=0.4133 | fpr=0.8602 | 7591.4 samples/s | 29.7 steps/s
[Step= 500] | Loss=5.96175 | acc=0.1444 | tpr=0.4167 | fpr=0.8605 | 7797.6 samples/s | 30.5 steps/s
[Step= 550] | Loss=5.96527 | acc=0.1446 | tpr=0.4170 | fpr=0.8604 | 14303.7 samples/s | 55.9 steps/s
Avg test loss: 5.96559, Avg test acc: 0.14449, Avg tpr: 0.41680, Avg fpr: 0.86046, total FA: 119473

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13239 | acc=0.9791 | tpr=0.9336 | fpr=0.0201 | 4135.1 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.14127 | acc=0.9781 | tpr=0.9446 | fpr=0.0213 | 4719.8 samples/s | 18.4 steps/s
[Step= 150] | Loss=0.14316 | acc=0.9777 | tpr=0.9496 | fpr=0.0218 | 7954.4 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.14486 | acc=0.9779 | tpr=0.9541 | fpr=0.0217 | 7900.4 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.14398 | acc=0.9777 | tpr=0.9528 | fpr=0.0218 | 7751.9 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.14650 | acc=0.9774 | tpr=0.9549 | fpr=0.0222 | 8009.8 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.14644 | acc=0.9774 | tpr=0.9530 | fpr=0.0221 | 8197.9 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.14792 | acc=0.9772 | tpr=0.9524 | fpr=0.0224 | 7498.1 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.14959 | acc=0.9769 | tpr=0.9503 | fpr=0.0226 | 7635.8 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.14826 | acc=0.9772 | tpr=0.9520 | fpr=0.0224 | 7791.4 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.14699 | acc=0.9774 | tpr=0.9530 | fpr=0.0222 | 14803.1 samples/s | 57.8 steps/s
Avg test loss: 0.14663, Avg test acc: 0.97743, Avg tpr: 0.95325, Avg fpr: 0.02213, total FA: 3073

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16433 | acc=0.9767 | tpr=0.9381 | fpr=0.0226 | 4223.2 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.17616 | acc=0.9761 | tpr=0.9488 | fpr=0.0234 | 4745.7 samples/s | 18.5 steps/s
[Step= 150] | Loss=0.17703 | acc=0.9759 | tpr=0.9582 | fpr=0.0238 | 7727.4 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.17834 | acc=0.9761 | tpr=0.9628 | fpr=0.0236 | 7857.2 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.17802 | acc=0.9759 | tpr=0.9624 | fpr=0.0238 | 7804.5 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.18107 | acc=0.9757 | tpr=0.9629 | fpr=0.0241 | 7978.9 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.18124 | acc=0.9757 | tpr=0.9599 | fpr=0.0240 | 7814.1 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.18338 | acc=0.9753 | tpr=0.9595 | fpr=0.0244 | 7604.0 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.18541 | acc=0.9751 | tpr=0.9567 | fpr=0.0245 | 7841.9 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.18415 | acc=0.9753 | tpr=0.9573 | fpr=0.0244 | 7926.8 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.18287 | acc=0.9755 | tpr=0.9578 | fpr=0.0241 | 14769.5 samples/s | 57.7 steps/s
Avg test loss: 0.18249, Avg test acc: 0.97557, Avg tpr: 0.95800, Avg fpr: 0.02411, total FA: 3348

server round 29/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=58001 Epoch=113.1] | Loss=0.00501 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.302 | L2-Norm(final)=17.706 | 4770.5 samples/s | 74.5 steps/s
[Step=58050 Epoch=113.2] | Loss=0.01006 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.303 | L2-Norm(final)=17.714 | 4675.5 samples/s | 73.1 steps/s
[Step=58100 Epoch=113.3] | Loss=0.00971 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=17.725 | 5610.7 samples/s | 87.7 steps/s
[Step=58150 Epoch=113.4] | Loss=0.00989 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.303 | L2-Norm(final)=17.735 | 5501.5 samples/s | 86.0 steps/s
[Step=58200 Epoch=113.5] | Loss=0.00965 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=17.742 | 5495.5 samples/s | 85.9 steps/s
[Step=58250 Epoch=113.6] | Loss=0.00959 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.303 | L2-Norm(final)=17.749 | 5552.9 samples/s | 86.8 steps/s
[Step=58300 Epoch=113.7] | Loss=0.00945 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.303 | L2-Norm(final)=17.757 | 5575.2 samples/s | 87.1 steps/s
[Step=58350 Epoch=113.8] | Loss=0.00935 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=17.764 | 5624.9 samples/s | 87.9 steps/s
[Step=58400 Epoch=113.9] | Loss=0.00945 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.303 | L2-Norm(final)=17.771 | 5428.6 samples/s | 84.8 steps/s
[Step=58450 Epoch=114.0] | Loss=0.00932 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=17.778 | 5554.4 samples/s | 86.8 steps/s
[Step=58500 Epoch=114.1] | Loss=0.00904 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.303 | L2-Norm(final)=17.786 | 7055.0 samples/s | 110.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=58501 Epoch=114.1] | Loss=0.00104 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=17.860 | 4029.7 samples/s | 63.0 steps/s
[Step=58550 Epoch=114.2] | Loss=0.00974 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.322 | L2-Norm(final)=17.864 | 4854.5 samples/s | 75.9 steps/s
[Step=58600 Epoch=114.3] | Loss=0.01135 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=17.866 | 4818.6 samples/s | 75.3 steps/s
[Step=58650 Epoch=114.4] | Loss=0.01167 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.359 | L2-Norm(final)=17.868 | 4785.9 samples/s | 74.8 steps/s
[Step=58700 Epoch=114.5] | Loss=0.01135 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.373 | L2-Norm(final)=17.869 | 4850.7 samples/s | 75.8 steps/s
[Step=58750 Epoch=114.6] | Loss=0.01112 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.385 | L2-Norm(final)=17.871 | 4764.2 samples/s | 74.4 steps/s
[Step=58800 Epoch=114.7] | Loss=0.01062 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.395 | L2-Norm(final)=17.873 | 4816.7 samples/s | 75.3 steps/s
[Step=58850 Epoch=114.8] | Loss=0.01050 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.403 | L2-Norm(final)=17.875 | 4789.7 samples/s | 74.8 steps/s
[Step=58900 Epoch=114.9] | Loss=0.01043 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.411 | L2-Norm(final)=17.877 | 4868.7 samples/s | 76.1 steps/s
[Step=58950 Epoch=115.0] | Loss=0.01035 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.418 | L2-Norm(final)=17.879 | 4869.9 samples/s | 76.1 steps/s
[Step=59000 Epoch=115.1] | Loss=0.01015 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.424 | L2-Norm(final)=17.881 | 5799.2 samples/s | 90.6 steps/s
[Step=59050 Epoch=115.2] | Loss=0.00972 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.431 | L2-Norm(final)=17.883 | 2068.1 samples/s | 32.3 steps/s
[Step=59100 Epoch=115.3] | Loss=0.00964 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.436 | L2-Norm(final)=17.885 | 4778.1 samples/s | 74.7 steps/s
[Step=59150 Epoch=115.4] | Loss=0.00948 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.442 | L2-Norm(final)=17.887 | 4800.6 samples/s | 75.0 steps/s
[Step=59200 Epoch=115.5] | Loss=0.00941 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.447 | L2-Norm(final)=17.888 | 4813.5 samples/s | 75.2 steps/s
[Step=59250 Epoch=115.6] | Loss=0.00926 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.452 | L2-Norm(final)=17.890 | 4861.6 samples/s | 76.0 steps/s
[Step=59300 Epoch=115.7] | Loss=0.00915 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.457 | L2-Norm(final)=17.892 | 4743.6 samples/s | 74.1 steps/s
[Step=59350 Epoch=115.8] | Loss=0.00907 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.461 | L2-Norm(final)=17.894 | 4842.1 samples/s | 75.7 steps/s
[Step=59400 Epoch=115.9] | Loss=0.00890 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.465 | L2-Norm(final)=17.896 | 4780.5 samples/s | 74.7 steps/s
[Step=59450 Epoch=116.0] | Loss=0.00884 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.469 | L2-Norm(final)=17.897 | 4851.9 samples/s | 75.8 steps/s
[Step=59500 Epoch=116.0] | Loss=0.00879 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.473 | L2-Norm(final)=17.899 | 5100.6 samples/s | 79.7 steps/s
[Step=59550 Epoch=116.1] | Loss=0.00866 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.477 | L2-Norm(final)=17.901 | 2153.0 samples/s | 33.6 steps/s
[Step=59600 Epoch=116.2] | Loss=0.00856 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.480 | L2-Norm(final)=17.904 | 4822.4 samples/s | 75.3 steps/s
[Step=59650 Epoch=116.3] | Loss=0.00849 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.484 | L2-Norm(final)=17.906 | 4798.1 samples/s | 75.0 steps/s
[Step=59700 Epoch=116.4] | Loss=0.00841 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.487 | L2-Norm(final)=17.908 | 4843.0 samples/s | 75.7 steps/s
[Step=59750 Epoch=116.5] | Loss=0.00833 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=17.910 | 4840.7 samples/s | 75.6 steps/s
[Step=59800 Epoch=116.6] | Loss=0.00824 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.494 | L2-Norm(final)=17.913 | 4729.1 samples/s | 73.9 steps/s
[Step=59850 Epoch=116.7] | Loss=0.00815 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.498 | L2-Norm(final)=17.915 | 4767.9 samples/s | 74.5 steps/s
[Step=59900 Epoch=116.8] | Loss=0.00800 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.501 | L2-Norm(final)=17.917 | 4819.0 samples/s | 75.3 steps/s
[Step=59950 Epoch=116.9] | Loss=0.00793 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.504 | L2-Norm(final)=17.920 | 4854.1 samples/s | 75.8 steps/s
[Step=60000 Epoch=117.0] | Loss=0.00790 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=17.922 | 4779.4 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step60000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=58001 Epoch=113.4] | Loss=0.00696 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.302 | L2-Norm(final)=17.833 | 4063.9 samples/s | 63.5 steps/s
[Step=58050 Epoch=113.5] | Loss=0.00819 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=17.837 | 2371.8 samples/s | 37.1 steps/s
[Step=58100 Epoch=113.6] | Loss=0.00804 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.303 | L2-Norm(final)=17.844 | 4789.6 samples/s | 74.8 steps/s
[Step=58150 Epoch=113.7] | Loss=0.00762 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=17.851 | 5494.8 samples/s | 85.9 steps/s
[Step=58200 Epoch=113.8] | Loss=0.00763 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=17.858 | 5509.3 samples/s | 86.1 steps/s
[Step=58250 Epoch=113.9] | Loss=0.00796 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=17.866 | 4925.8 samples/s | 77.0 steps/s
[Step=58300 Epoch=114.0] | Loss=0.00787 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.303 | L2-Norm(final)=17.875 | 5635.8 samples/s | 88.1 steps/s
[Step=58350 Epoch=114.1] | Loss=0.00780 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.303 | L2-Norm(final)=17.883 | 5137.3 samples/s | 80.3 steps/s
[Step=58400 Epoch=114.2] | Loss=0.00772 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=17.891 | 5275.5 samples/s | 82.4 steps/s
[Step=58450 Epoch=114.3] | Loss=0.00776 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=17.900 | 5590.1 samples/s | 87.3 steps/s
[Step=58500 Epoch=114.4] | Loss=0.00786 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.303 | L2-Norm(final)=17.908 | 6069.8 samples/s | 94.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=58501 Epoch=114.4] | Loss=0.00937 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.303 | L2-Norm(final)=17.988 | 4403.8 samples/s | 68.8 steps/s
[Step=58550 Epoch=114.5] | Loss=0.01015 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.320 | L2-Norm(final)=17.994 | 4763.1 samples/s | 74.4 steps/s
[Step=58600 Epoch=114.6] | Loss=0.00838 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.334 | L2-Norm(final)=17.998 | 4803.1 samples/s | 75.0 steps/s
[Step=58650 Epoch=114.7] | Loss=0.00935 | Reg=0.00129 | acc=0.9531 | L2-Norm=11.347 | L2-Norm(final)=18.001 | 4765.4 samples/s | 74.5 steps/s
[Step=58700 Epoch=114.8] | Loss=0.00998 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=18.002 | 4716.3 samples/s | 73.7 steps/s
[Step=58750 Epoch=114.9] | Loss=0.00987 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.368 | L2-Norm(final)=18.002 | 4811.8 samples/s | 75.2 steps/s
[Step=58800 Epoch=115.0] | Loss=0.00988 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.378 | L2-Norm(final)=18.003 | 4825.4 samples/s | 75.4 steps/s
[Step=58850 Epoch=115.1] | Loss=0.01015 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.386 | L2-Norm(final)=18.005 | 4774.0 samples/s | 74.6 steps/s
[Step=58900 Epoch=115.1] | Loss=0.01027 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.395 | L2-Norm(final)=18.006 | 4830.0 samples/s | 75.5 steps/s
[Step=58950 Epoch=115.2] | Loss=0.01045 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.403 | L2-Norm(final)=18.008 | 4765.7 samples/s | 74.5 steps/s
[Step=59000 Epoch=115.3] | Loss=0.01026 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.411 | L2-Norm(final)=18.009 | 5918.9 samples/s | 92.5 steps/s
[Step=59050 Epoch=115.4] | Loss=0.01001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.419 | L2-Norm(final)=18.011 | 2074.7 samples/s | 32.4 steps/s
[Step=59100 Epoch=115.5] | Loss=0.00977 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=18.012 | 4789.3 samples/s | 74.8 steps/s
[Step=59150 Epoch=115.6] | Loss=0.00955 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.432 | L2-Norm(final)=18.014 | 4721.8 samples/s | 73.8 steps/s
[Step=59200 Epoch=115.7] | Loss=0.00960 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.437 | L2-Norm(final)=18.015 | 4762.2 samples/s | 74.4 steps/s
[Step=59250 Epoch=115.8] | Loss=0.00937 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.443 | L2-Norm(final)=18.016 | 4810.2 samples/s | 75.2 steps/s
[Step=59300 Epoch=115.9] | Loss=0.00929 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.448 | L2-Norm(final)=18.018 | 4794.2 samples/s | 74.9 steps/s
[Step=59350 Epoch=116.0] | Loss=0.00905 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=18.019 | 4849.4 samples/s | 75.8 steps/s
[Step=59400 Epoch=116.1] | Loss=0.00903 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.457 | L2-Norm(final)=18.021 | 4802.7 samples/s | 75.0 steps/s
[Step=59450 Epoch=116.2] | Loss=0.00894 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.461 | L2-Norm(final)=18.022 | 4831.9 samples/s | 75.5 steps/s
[Step=59500 Epoch=116.3] | Loss=0.00897 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.466 | L2-Norm(final)=18.023 | 5249.4 samples/s | 82.0 steps/s
[Step=59550 Epoch=116.4] | Loss=0.00887 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.470 | L2-Norm(final)=18.024 | 2195.1 samples/s | 34.3 steps/s
[Step=59600 Epoch=116.5] | Loss=0.00877 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.474 | L2-Norm(final)=18.026 | 4800.3 samples/s | 75.0 steps/s
[Step=59650 Epoch=116.6] | Loss=0.00872 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.478 | L2-Norm(final)=18.027 | 4696.7 samples/s | 73.4 steps/s
[Step=59700 Epoch=116.7] | Loss=0.00857 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.482 | L2-Norm(final)=18.028 | 4769.3 samples/s | 74.5 steps/s
[Step=59750 Epoch=116.8] | Loss=0.00856 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.486 | L2-Norm(final)=18.030 | 4746.2 samples/s | 74.2 steps/s
[Step=59800 Epoch=116.9] | Loss=0.00847 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.490 | L2-Norm(final)=18.031 | 4803.7 samples/s | 75.1 steps/s
[Step=59850 Epoch=117.0] | Loss=0.00839 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.493 | L2-Norm(final)=18.033 | 4771.6 samples/s | 74.6 steps/s
[Step=59900 Epoch=117.1] | Loss=0.00829 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.497 | L2-Norm(final)=18.034 | 4803.8 samples/s | 75.1 steps/s
[Step=59950 Epoch=117.2] | Loss=0.00833 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.501 | L2-Norm(final)=18.036 | 4751.7 samples/s | 74.2 steps/s
[Step=60000 Epoch=117.3] | Loss=0.00822 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.504 | L2-Norm(final)=18.037 | 4741.6 samples/s | 74.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step60000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=58001 Epoch=222.2] | Loss=0.00002 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.302 | L2-Norm(final)=16.543 | 5173.1 samples/s | 80.8 steps/s
[Step=58050 Epoch=222.4] | Loss=0.00009 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.295 | L2-Norm(final)=16.558 | 4399.7 samples/s | 68.7 steps/s
[Step=58100 Epoch=222.6] | Loss=0.00007 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=16.572 | 5183.0 samples/s | 81.0 steps/s
[Step=58150 Epoch=222.8] | Loss=0.00007 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=16.585 | 5261.8 samples/s | 82.2 steps/s
[Step=58200 Epoch=223.0] | Loss=0.00007 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=16.598 | 5208.0 samples/s | 81.4 steps/s
[Step=58250 Epoch=223.2] | Loss=0.00008 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=16.612 | 6850.2 samples/s | 107.0 steps/s
[Step=58300 Epoch=223.4] | Loss=0.00008 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=16.627 | 2143.6 samples/s | 33.5 steps/s
[Step=58350 Epoch=223.6] | Loss=0.00008 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=16.642 | 5252.2 samples/s | 82.1 steps/s
[Step=58400 Epoch=223.8] | Loss=0.00008 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=16.655 | 5166.7 samples/s | 80.7 steps/s
[Step=58450 Epoch=224.0] | Loss=0.00008 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=16.668 | 5228.8 samples/s | 81.7 steps/s
[Step=58500 Epoch=224.2] | Loss=0.00008 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=16.681 | 5898.9 samples/s | 92.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=58501 Epoch=224.2] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=16.801 | 4900.6 samples/s | 76.6 steps/s
[Step=58550 Epoch=224.3] | Loss=0.00034 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.308 | L2-Norm(final)=16.807 | 4060.9 samples/s | 63.5 steps/s
[Step=58600 Epoch=224.5] | Loss=0.00242 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.360 | L2-Norm(final)=16.806 | 4623.2 samples/s | 72.2 steps/s
[Step=58650 Epoch=224.7] | Loss=0.00238 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=16.800 | 4493.1 samples/s | 70.2 steps/s
[Step=58700 Epoch=224.9] | Loss=0.00192 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.432 | L2-Norm(final)=16.797 | 4507.6 samples/s | 70.4 steps/s
[Step=58750 Epoch=225.1] | Loss=0.00155 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=16.795 | 5744.0 samples/s | 89.8 steps/s
[Step=58800 Epoch=225.3] | Loss=0.00129 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.459 | L2-Norm(final)=16.793 | 2029.6 samples/s | 31.7 steps/s
[Step=58850 Epoch=225.5] | Loss=0.00111 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.466 | L2-Norm(final)=16.793 | 4439.5 samples/s | 69.4 steps/s
[Step=58900 Epoch=225.7] | Loss=0.00097 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.470 | L2-Norm(final)=16.792 | 4540.3 samples/s | 70.9 steps/s
[Step=58950 Epoch=225.9] | Loss=0.00087 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.473 | L2-Norm(final)=16.792 | 4597.7 samples/s | 71.8 steps/s
[Step=59000 Epoch=226.1] | Loss=0.00079 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=16.793 | 5049.8 samples/s | 78.9 steps/s
[Step=59050 Epoch=226.3] | Loss=0.00072 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.477 | L2-Norm(final)=16.793 | 2113.8 samples/s | 33.0 steps/s
[Step=59100 Epoch=226.5] | Loss=0.00066 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.478 | L2-Norm(final)=16.793 | 4530.1 samples/s | 70.8 steps/s
[Step=59150 Epoch=226.6] | Loss=0.00061 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.478 | L2-Norm(final)=16.793 | 4585.9 samples/s | 71.7 steps/s
[Step=59200 Epoch=226.8] | Loss=0.00056 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.478 | L2-Norm(final)=16.793 | 4474.2 samples/s | 69.9 steps/s
[Step=59250 Epoch=227.0] | Loss=0.00053 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.477 | L2-Norm(final)=16.794 | 4574.4 samples/s | 71.5 steps/s
[Step=59300 Epoch=227.2] | Loss=0.00049 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=16.794 | 2193.1 samples/s | 34.3 steps/s
[Step=59350 Epoch=227.4] | Loss=0.00046 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.475 | L2-Norm(final)=16.794 | 4665.7 samples/s | 72.9 steps/s
[Step=59400 Epoch=227.6] | Loss=0.00044 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.474 | L2-Norm(final)=16.794 | 4570.4 samples/s | 71.4 steps/s
[Step=59450 Epoch=227.8] | Loss=0.00042 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.472 | L2-Norm(final)=16.794 | 4556.2 samples/s | 71.2 steps/s
[Step=59500 Epoch=228.0] | Loss=0.00040 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.471 | L2-Norm(final)=16.795 | 4526.6 samples/s | 70.7 steps/s
[Step=59550 Epoch=228.2] | Loss=0.00038 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.469 | L2-Norm(final)=16.795 | 2228.7 samples/s | 34.8 steps/s
[Step=59600 Epoch=228.4] | Loss=0.00036 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.467 | L2-Norm(final)=16.795 | 4601.4 samples/s | 71.9 steps/s
[Step=59650 Epoch=228.6] | Loss=0.00034 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.465 | L2-Norm(final)=16.795 | 4503.6 samples/s | 70.4 steps/s
[Step=59700 Epoch=228.7] | Loss=0.00033 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.463 | L2-Norm(final)=16.796 | 4633.5 samples/s | 72.4 steps/s
[Step=59750 Epoch=228.9] | Loss=0.00032 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.461 | L2-Norm(final)=16.796 | 4498.6 samples/s | 70.3 steps/s
[Step=59800 Epoch=229.1] | Loss=0.00030 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.459 | L2-Norm(final)=16.796 | 6122.5 samples/s | 95.7 steps/s
[Step=59850 Epoch=229.3] | Loss=0.00029 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.457 | L2-Norm(final)=16.796 | 1972.1 samples/s | 30.8 steps/s
[Step=59900 Epoch=229.5] | Loss=0.00028 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.455 | L2-Norm(final)=16.797 | 4553.6 samples/s | 71.2 steps/s
[Step=59950 Epoch=229.7] | Loss=0.00027 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=16.797 | 4643.3 samples/s | 72.6 steps/s
[Step=60000 Epoch=229.9] | Loss=0.00026 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.450 | L2-Norm(final)=16.797 | 4560.0 samples/s | 71.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step60000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=58001 Epoch=223.3] | Loss=0.00003 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.302 | L2-Norm(final)=17.606 | 4699.4 samples/s | 73.4 steps/s
[Step=58050 Epoch=223.5] | Loss=0.00007 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.297 | L2-Norm(final)=17.612 | 4705.1 samples/s | 73.5 steps/s
[Step=58100 Epoch=223.6] | Loss=0.00011 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.297 | L2-Norm(final)=17.627 | 5156.2 samples/s | 80.6 steps/s
[Step=58150 Epoch=223.8] | Loss=0.00010 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.296 | L2-Norm(final)=17.639 | 5263.5 samples/s | 82.2 steps/s
[Step=58200 Epoch=224.0] | Loss=0.00009 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.296 | L2-Norm(final)=17.649 | 5257.0 samples/s | 82.1 steps/s
[Step=58250 Epoch=224.2] | Loss=0.00009 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.296 | L2-Norm(final)=17.660 | 6917.3 samples/s | 108.1 steps/s
[Step=58300 Epoch=224.4] | Loss=0.00009 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.296 | L2-Norm(final)=17.669 | 2107.2 samples/s | 32.9 steps/s
[Step=58350 Epoch=224.6] | Loss=0.00009 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.296 | L2-Norm(final)=17.678 | 5164.3 samples/s | 80.7 steps/s
[Step=58400 Epoch=224.8] | Loss=0.00009 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.296 | L2-Norm(final)=17.688 | 5204.6 samples/s | 81.3 steps/s
[Step=58450 Epoch=225.0] | Loss=0.00008 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.296 | L2-Norm(final)=17.697 | 5284.5 samples/s | 82.6 steps/s
[Step=58500 Epoch=225.2] | Loss=0.00008 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.296 | L2-Norm(final)=17.705 | 5924.6 samples/s | 92.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=58501 Epoch=225.2] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.296 | L2-Norm(final)=17.793 | 4602.7 samples/s | 71.9 steps/s
[Step=58550 Epoch=225.4] | Loss=0.00082 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.312 | L2-Norm(final)=17.797 | 4282.5 samples/s | 66.9 steps/s
[Step=58600 Epoch=225.6] | Loss=0.00327 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.361 | L2-Norm(final)=17.782 | 4589.5 samples/s | 71.7 steps/s
[Step=58650 Epoch=225.8] | Loss=0.00258 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.397 | L2-Norm(final)=17.771 | 4550.6 samples/s | 71.1 steps/s
[Step=58700 Epoch=226.0] | Loss=0.00207 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.420 | L2-Norm(final)=17.764 | 4590.7 samples/s | 71.7 steps/s
[Step=58750 Epoch=226.2] | Loss=0.00171 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.436 | L2-Norm(final)=17.760 | 5743.6 samples/s | 89.7 steps/s
[Step=58800 Epoch=226.3] | Loss=0.00143 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.446 | L2-Norm(final)=17.758 | 1909.1 samples/s | 29.8 steps/s
[Step=58850 Epoch=226.5] | Loss=0.00123 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.453 | L2-Norm(final)=17.757 | 4402.7 samples/s | 68.8 steps/s
[Step=58900 Epoch=226.7] | Loss=0.00108 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.457 | L2-Norm(final)=17.756 | 4421.6 samples/s | 69.1 steps/s
[Step=58950 Epoch=226.9] | Loss=0.00101 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.460 | L2-Norm(final)=17.755 | 4529.6 samples/s | 70.8 steps/s
[Step=59000 Epoch=227.1] | Loss=0.00093 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.464 | L2-Norm(final)=17.754 | 5169.4 samples/s | 80.8 steps/s
[Step=59050 Epoch=227.3] | Loss=0.00085 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.467 | L2-Norm(final)=17.753 | 2085.0 samples/s | 32.6 steps/s
[Step=59100 Epoch=227.5] | Loss=0.00078 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.469 | L2-Norm(final)=17.753 | 4494.7 samples/s | 70.2 steps/s
[Step=59150 Epoch=227.7] | Loss=0.00072 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.471 | L2-Norm(final)=17.753 | 4540.0 samples/s | 70.9 steps/s
[Step=59200 Epoch=227.9] | Loss=0.00067 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.472 | L2-Norm(final)=17.753 | 4526.6 samples/s | 70.7 steps/s
[Step=59250 Epoch=228.1] | Loss=0.00062 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.472 | L2-Norm(final)=17.753 | 4639.0 samples/s | 72.5 steps/s
[Step=59300 Epoch=228.3] | Loss=0.00058 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.472 | L2-Norm(final)=17.752 | 2168.3 samples/s | 33.9 steps/s
[Step=59350 Epoch=228.5] | Loss=0.00055 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.472 | L2-Norm(final)=17.752 | 4637.2 samples/s | 72.5 steps/s
[Step=59400 Epoch=228.7] | Loss=0.00052 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.471 | L2-Norm(final)=17.752 | 4471.1 samples/s | 69.9 steps/s
[Step=59450 Epoch=228.8] | Loss=0.00049 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.471 | L2-Norm(final)=17.752 | 4529.9 samples/s | 70.8 steps/s
[Step=59500 Epoch=229.0] | Loss=0.00047 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.470 | L2-Norm(final)=17.752 | 4577.3 samples/s | 71.5 steps/s
[Step=59550 Epoch=229.2] | Loss=0.00045 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.469 | L2-Norm(final)=17.752 | 2195.5 samples/s | 34.3 steps/s
[Step=59600 Epoch=229.4] | Loss=0.00043 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.467 | L2-Norm(final)=17.752 | 4632.8 samples/s | 72.4 steps/s
[Step=59650 Epoch=229.6] | Loss=0.00041 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.466 | L2-Norm(final)=17.752 | 4534.5 samples/s | 70.9 steps/s
[Step=59700 Epoch=229.8] | Loss=0.00039 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.465 | L2-Norm(final)=17.752 | 4549.4 samples/s | 71.1 steps/s
[Step=59750 Epoch=230.0] | Loss=0.00038 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.463 | L2-Norm(final)=17.752 | 4553.5 samples/s | 71.1 steps/s
[Step=59800 Epoch=230.2] | Loss=0.00036 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.461 | L2-Norm(final)=17.753 | 6593.3 samples/s | 103.0 steps/s
[Step=59850 Epoch=230.4] | Loss=0.00035 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.460 | L2-Norm(final)=17.753 | 1900.5 samples/s | 29.7 steps/s
[Step=59900 Epoch=230.6] | Loss=0.00034 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.458 | L2-Norm(final)=17.753 | 4546.3 samples/s | 71.0 steps/s
[Step=59950 Epoch=230.8] | Loss=0.00032 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.456 | L2-Norm(final)=17.753 | 4534.5 samples/s | 70.9 steps/s
[Step=60000 Epoch=231.0] | Loss=0.00031 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.454 | L2-Norm(final)=17.753 | 4636.5 samples/s | 72.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step60000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08405 | acc=0.9691 | tpr=0.9795 | fpr=0.0533 | 4290.3 samples/s | 16.8 steps/s
Avg test loss: 0.08353, Avg test acc: 0.96855, Avg tpr: 0.97925, Avg fpr: 0.05499, total FA: 429

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07451 | acc=0.9694 | tpr=0.9741 | fpr=0.0409 | 4174.6 samples/s | 16.3 steps/s
Avg test loss: 0.07465, Avg test acc: 0.96863, Avg tpr: 0.97406, Avg fpr: 0.04333, total FA: 338

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.39306 | acc=0.3017 | tpr=0.0065 | fpr=0.0572 | 4208.3 samples/s | 16.4 steps/s
Avg test loss: 7.41469, Avg test acc: 0.29846, Avg tpr: 0.00612, Avg fpr: 0.05858, total FA: 457

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.23026 | acc=0.2997 | tpr=0.0087 | fpr=0.0684 | 4210.9 samples/s | 16.4 steps/s
Avg test loss: 7.23940, Avg test acc: 0.29730, Avg tpr: 0.00845, Avg fpr: 0.06743, total FA: 526

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.97983 | acc=0.1159 | tpr=0.5088 | fpr=0.8912 | 4243.9 samples/s | 16.6 steps/s
[Step= 100] | Loss=6.90522 | acc=0.1189 | tpr=0.5096 | fpr=0.8884 | 7606.0 samples/s | 29.7 steps/s
[Step= 150] | Loss=6.91413 | acc=0.1179 | tpr=0.5159 | fpr=0.8894 | 7910.0 samples/s | 30.9 steps/s
[Step= 200] | Loss=6.90832 | acc=0.1187 | tpr=0.5169 | fpr=0.8886 | 7987.4 samples/s | 31.2 steps/s
[Step= 250] | Loss=6.90564 | acc=0.1183 | tpr=0.5127 | fpr=0.8889 | 7801.6 samples/s | 30.5 steps/s
[Step= 300] | Loss=6.91088 | acc=0.1176 | tpr=0.5069 | fpr=0.8895 | 7950.8 samples/s | 31.1 steps/s
[Step= 350] | Loss=6.91903 | acc=0.1175 | tpr=0.5103 | fpr=0.8896 | 7923.7 samples/s | 31.0 steps/s
[Step= 400] | Loss=6.90928 | acc=0.1171 | tpr=0.4973 | fpr=0.8898 | 7934.4 samples/s | 31.0 steps/s
[Step= 450] | Loss=6.91387 | acc=0.1164 | tpr=0.4985 | fpr=0.8905 | 7752.0 samples/s | 30.3 steps/s
[Step= 500] | Loss=6.91747 | acc=0.1160 | tpr=0.5013 | fpr=0.8910 | 7830.8 samples/s | 30.6 steps/s
[Step= 550] | Loss=6.92088 | acc=0.1160 | tpr=0.5018 | fpr=0.8910 | 15081.8 samples/s | 58.9 steps/s
Avg test loss: 6.92153, Avg test acc: 0.11594, Avg tpr: 0.50158, Avg fpr: 0.89108, total FA: 123724

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.68899 | acc=0.1434 | tpr=0.4071 | fpr=0.8614 | 4169.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=5.62642 | acc=0.1446 | tpr=0.4264 | fpr=0.8607 | 7930.7 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.63876 | acc=0.1435 | tpr=0.4337 | fpr=0.8618 | 7963.2 samples/s | 31.1 steps/s
[Step= 200] | Loss=5.63381 | acc=0.1441 | tpr=0.4383 | fpr=0.8613 | 7924.6 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.63110 | acc=0.1440 | tpr=0.4341 | fpr=0.8613 | 7989.4 samples/s | 31.2 steps/s
[Step= 300] | Loss=5.63941 | acc=0.1436 | tpr=0.4349 | fpr=0.8618 | 7908.3 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.64916 | acc=0.1432 | tpr=0.4352 | fpr=0.8621 | 7818.2 samples/s | 30.5 steps/s
[Step= 400] | Loss=5.64000 | acc=0.1427 | tpr=0.4272 | fpr=0.8624 | 7646.9 samples/s | 29.9 steps/s
[Step= 450] | Loss=5.64195 | acc=0.1424 | tpr=0.4294 | fpr=0.8628 | 7719.0 samples/s | 30.2 steps/s
[Step= 500] | Loss=5.64590 | acc=0.1424 | tpr=0.4339 | fpr=0.8629 | 7830.4 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.64860 | acc=0.1424 | tpr=0.4333 | fpr=0.8629 | 15109.9 samples/s | 59.0 steps/s
Avg test loss: 5.64943, Avg test acc: 0.14231, Avg tpr: 0.43304, Avg fpr: 0.86297, total FA: 119822

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13905 | acc=0.9787 | tpr=0.9204 | fpr=0.0203 | 4226.1 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.15038 | acc=0.9776 | tpr=0.9382 | fpr=0.0217 | 7644.9 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.15240 | acc=0.9773 | tpr=0.9467 | fpr=0.0221 | 7932.2 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.15383 | acc=0.9774 | tpr=0.9508 | fpr=0.0221 | 7837.5 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.15302 | acc=0.9776 | tpr=0.9502 | fpr=0.0219 | 7884.9 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.15668 | acc=0.9773 | tpr=0.9498 | fpr=0.0222 | 7566.2 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.15677 | acc=0.9774 | tpr=0.9493 | fpr=0.0221 | 7811.5 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.15813 | acc=0.9773 | tpr=0.9486 | fpr=0.0222 | 8092.3 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.15942 | acc=0.9771 | tpr=0.9479 | fpr=0.0223 | 7825.2 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.15859 | acc=0.9773 | tpr=0.9480 | fpr=0.0222 | 7837.6 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.15742 | acc=0.9775 | tpr=0.9491 | fpr=0.0220 | 15209.4 samples/s | 59.4 steps/s
Avg test loss: 0.15713, Avg test acc: 0.97751, Avg tpr: 0.94889, Avg fpr: 0.02197, total FA: 3051

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14409 | acc=0.9784 | tpr=0.9204 | fpr=0.0206 | 4173.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.15528 | acc=0.9774 | tpr=0.9382 | fpr=0.0218 | 7934.8 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.15722 | acc=0.9769 | tpr=0.9452 | fpr=0.0225 | 8073.6 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.15996 | acc=0.9769 | tpr=0.9497 | fpr=0.0226 | 7524.6 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.15915 | acc=0.9770 | tpr=0.9502 | fpr=0.0225 | 8027.3 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.16228 | acc=0.9767 | tpr=0.9520 | fpr=0.0228 | 7797.9 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.16228 | acc=0.9767 | tpr=0.9512 | fpr=0.0229 | 7724.8 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.16396 | acc=0.9765 | tpr=0.9502 | fpr=0.0230 | 7885.0 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.16569 | acc=0.9765 | tpr=0.9489 | fpr=0.0230 | 7746.0 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.16467 | acc=0.9765 | tpr=0.9485 | fpr=0.0230 | 7793.0 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.16373 | acc=0.9767 | tpr=0.9491 | fpr=0.0228 | 14353.8 samples/s | 56.1 steps/s
Avg test loss: 0.16346, Avg test acc: 0.97670, Avg tpr: 0.94889, Avg fpr: 0.02279, total FA: 3165

server round 30/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=60001 Epoch=117.0] | Loss=0.02329 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.381 | L2-Norm(final)=17.990 | 3993.2 samples/s | 62.4 steps/s
[Step=60050 Epoch=117.1] | Loss=0.01496 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=17.992 | 5407.2 samples/s | 84.5 steps/s
[Step=60100 Epoch=117.2] | Loss=0.01614 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=17.993 | 5507.2 samples/s | 86.0 steps/s
[Step=60150 Epoch=117.3] | Loss=0.01614 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.381 | L2-Norm(final)=17.995 | 5610.7 samples/s | 87.7 steps/s
[Step=60200 Epoch=117.4] | Loss=0.01562 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=17.997 | 5695.3 samples/s | 89.0 steps/s
[Step=60250 Epoch=117.5] | Loss=0.01530 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.381 | L2-Norm(final)=17.999 | 5310.7 samples/s | 83.0 steps/s
[Step=60300 Epoch=117.6] | Loss=0.01526 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=18.001 | 5610.4 samples/s | 87.7 steps/s
[Step=60350 Epoch=117.7] | Loss=0.01506 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.381 | L2-Norm(final)=18.004 | 5521.7 samples/s | 86.3 steps/s
[Step=60400 Epoch=117.8] | Loss=0.01501 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.381 | L2-Norm(final)=18.006 | 5595.6 samples/s | 87.4 steps/s
[Step=60450 Epoch=117.9] | Loss=0.01483 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=18.008 | 5528.6 samples/s | 86.4 steps/s
[Step=60500 Epoch=118.0] | Loss=0.01484 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=18.010 | 6986.6 samples/s | 109.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=60501 Epoch=118.0] | Loss=0.00579 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=18.035 | 4416.6 samples/s | 69.0 steps/s
[Step=60550 Epoch=118.1] | Loss=0.01056 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.390 | L2-Norm(final)=18.036 | 4321.8 samples/s | 67.5 steps/s
[Step=60600 Epoch=118.2] | Loss=0.00922 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.398 | L2-Norm(final)=18.038 | 4768.0 samples/s | 74.5 steps/s
[Step=60650 Epoch=118.3] | Loss=0.00913 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.404 | L2-Norm(final)=18.039 | 4816.8 samples/s | 75.3 steps/s
[Step=60700 Epoch=118.4] | Loss=0.00855 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.409 | L2-Norm(final)=18.041 | 4834.2 samples/s | 75.5 steps/s
[Step=60750 Epoch=118.5] | Loss=0.00847 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.413 | L2-Norm(final)=18.042 | 4812.8 samples/s | 75.2 steps/s
[Step=60800 Epoch=118.6] | Loss=0.00822 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.417 | L2-Norm(final)=18.043 | 4740.5 samples/s | 74.1 steps/s
[Step=60850 Epoch=118.7] | Loss=0.00855 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.420 | L2-Norm(final)=18.044 | 4765.0 samples/s | 74.5 steps/s
[Step=60900 Epoch=118.8] | Loss=0.00816 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.423 | L2-Norm(final)=18.045 | 4850.2 samples/s | 75.8 steps/s
[Step=60950 Epoch=118.9] | Loss=0.00817 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.426 | L2-Norm(final)=18.046 | 4856.7 samples/s | 75.9 steps/s
[Step=61000 Epoch=119.0] | Loss=0.00805 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.428 | L2-Norm(final)=18.047 | 5777.3 samples/s | 90.3 steps/s
[Step=61050 Epoch=119.1] | Loss=0.00778 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.431 | L2-Norm(final)=18.048 | 2057.4 samples/s | 32.1 steps/s
[Step=61100 Epoch=119.2] | Loss=0.00764 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=18.049 | 4794.6 samples/s | 74.9 steps/s
[Step=61150 Epoch=119.3] | Loss=0.00747 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.435 | L2-Norm(final)=18.050 | 4806.4 samples/s | 75.1 steps/s
[Step=61200 Epoch=119.4] | Loss=0.00732 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.437 | L2-Norm(final)=18.051 | 4822.7 samples/s | 75.4 steps/s
[Step=61250 Epoch=119.5] | Loss=0.00714 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.439 | L2-Norm(final)=18.052 | 4419.4 samples/s | 69.1 steps/s
[Step=61300 Epoch=119.6] | Loss=0.00704 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.441 | L2-Norm(final)=18.053 | 4336.8 samples/s | 67.8 steps/s
[Step=61350 Epoch=119.7] | Loss=0.00698 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.442 | L2-Norm(final)=18.054 | 4364.1 samples/s | 68.2 steps/s
[Step=61400 Epoch=119.8] | Loss=0.00683 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.444 | L2-Norm(final)=18.055 | 4638.3 samples/s | 72.5 steps/s
[Step=61450 Epoch=119.9] | Loss=0.00673 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.446 | L2-Norm(final)=18.056 | 4629.8 samples/s | 72.3 steps/s
[Step=61500 Epoch=119.9] | Loss=0.00671 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.447 | L2-Norm(final)=18.057 | 4924.8 samples/s | 77.0 steps/s
[Step=61550 Epoch=120.0] | Loss=0.00667 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=18.058 | 2087.4 samples/s | 32.6 steps/s
[Step=61600 Epoch=120.1] | Loss=0.00657 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.450 | L2-Norm(final)=18.059 | 4834.8 samples/s | 75.5 steps/s
[Step=61650 Epoch=120.2] | Loss=0.00646 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=18.060 | 4788.4 samples/s | 74.8 steps/s
[Step=61700 Epoch=120.3] | Loss=0.00634 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.453 | L2-Norm(final)=18.061 | 4776.4 samples/s | 74.6 steps/s
[Step=61750 Epoch=120.4] | Loss=0.00629 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.455 | L2-Norm(final)=18.062 | 4809.0 samples/s | 75.1 steps/s
[Step=61800 Epoch=120.5] | Loss=0.00623 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.456 | L2-Norm(final)=18.063 | 4852.4 samples/s | 75.8 steps/s
[Step=61850 Epoch=120.6] | Loss=0.00623 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.458 | L2-Norm(final)=18.064 | 4773.3 samples/s | 74.6 steps/s
[Step=61900 Epoch=120.7] | Loss=0.00623 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.459 | L2-Norm(final)=18.065 | 4848.3 samples/s | 75.8 steps/s
[Step=61950 Epoch=120.8] | Loss=0.00617 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.460 | L2-Norm(final)=18.066 | 4742.5 samples/s | 74.1 steps/s
[Step=62000 Epoch=120.9] | Loss=0.00613 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.462 | L2-Norm(final)=18.067 | 4820.4 samples/s | 75.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step62000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=60001 Epoch=117.3] | Loss=0.01022 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=18.082 | 4826.5 samples/s | 75.4 steps/s
[Step=60050 Epoch=117.4] | Loss=0.01256 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=18.082 | 4688.0 samples/s | 73.2 steps/s
[Step=60100 Epoch=117.5] | Loss=0.01238 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=18.085 | 5537.1 samples/s | 86.5 steps/s
[Step=60150 Epoch=117.6] | Loss=0.01262 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=18.089 | 5556.6 samples/s | 86.8 steps/s
[Step=60200 Epoch=117.7] | Loss=0.01291 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=18.092 | 5501.8 samples/s | 86.0 steps/s
[Step=60250 Epoch=117.8] | Loss=0.01234 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.381 | L2-Norm(final)=18.095 | 5614.1 samples/s | 87.7 steps/s
[Step=60300 Epoch=117.9] | Loss=0.01205 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.381 | L2-Norm(final)=18.099 | 5487.5 samples/s | 85.7 steps/s
[Step=60350 Epoch=118.0] | Loss=0.01204 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=18.103 | 5517.7 samples/s | 86.2 steps/s
[Step=60400 Epoch=118.1] | Loss=0.01202 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.381 | L2-Norm(final)=18.107 | 5430.1 samples/s | 84.8 steps/s
[Step=60450 Epoch=118.2] | Loss=0.01204 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=18.112 | 5304.1 samples/s | 82.9 steps/s
[Step=60500 Epoch=118.3] | Loss=0.01240 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.381 | L2-Norm(final)=18.116 | 7157.8 samples/s | 111.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=60501 Epoch=118.3] | Loss=0.03171 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.381 | L2-Norm(final)=18.159 | 4843.4 samples/s | 75.7 steps/s
[Step=60550 Epoch=118.4] | Loss=0.01015 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.391 | L2-Norm(final)=18.162 | 4336.1 samples/s | 67.8 steps/s
[Step=60600 Epoch=118.5] | Loss=0.00928 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.399 | L2-Norm(final)=18.164 | 4768.0 samples/s | 74.5 steps/s
[Step=60650 Epoch=118.6] | Loss=0.00932 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.404 | L2-Norm(final)=18.164 | 4761.5 samples/s | 74.4 steps/s
[Step=60700 Epoch=118.7] | Loss=0.00898 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=18.165 | 4806.8 samples/s | 75.1 steps/s
[Step=60750 Epoch=118.8] | Loss=0.00875 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.412 | L2-Norm(final)=18.166 | 4722.2 samples/s | 73.8 steps/s
[Step=60800 Epoch=118.9] | Loss=0.00845 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.415 | L2-Norm(final)=18.166 | 4805.6 samples/s | 75.1 steps/s
[Step=60850 Epoch=119.0] | Loss=0.00817 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.418 | L2-Norm(final)=18.167 | 4831.8 samples/s | 75.5 steps/s
[Step=60900 Epoch=119.1] | Loss=0.00811 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.421 | L2-Norm(final)=18.168 | 4770.9 samples/s | 74.5 steps/s
[Step=60950 Epoch=119.2] | Loss=0.00796 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.423 | L2-Norm(final)=18.169 | 4777.6 samples/s | 74.6 steps/s
[Step=61000 Epoch=119.3] | Loss=0.00772 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=18.170 | 5869.7 samples/s | 91.7 steps/s
[Step=61050 Epoch=119.4] | Loss=0.00756 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=18.171 | 2089.5 samples/s | 32.6 steps/s
[Step=61100 Epoch=119.4] | Loss=0.00726 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=18.173 | 4770.5 samples/s | 74.5 steps/s
[Step=61150 Epoch=119.5] | Loss=0.00708 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.431 | L2-Norm(final)=18.174 | 4778.2 samples/s | 74.7 steps/s
[Step=61200 Epoch=119.6] | Loss=0.00696 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=18.175 | 4830.6 samples/s | 75.5 steps/s
[Step=61250 Epoch=119.7] | Loss=0.00688 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=18.176 | 4766.7 samples/s | 74.5 steps/s
[Step=61300 Epoch=119.8] | Loss=0.00677 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.436 | L2-Norm(final)=18.177 | 4741.3 samples/s | 74.1 steps/s
[Step=61350 Epoch=119.9] | Loss=0.00678 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.438 | L2-Norm(final)=18.178 | 4793.4 samples/s | 74.9 steps/s
[Step=61400 Epoch=120.0] | Loss=0.00673 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.439 | L2-Norm(final)=18.178 | 4785.3 samples/s | 74.8 steps/s
[Step=61450 Epoch=120.1] | Loss=0.00657 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.440 | L2-Norm(final)=18.179 | 4812.1 samples/s | 75.2 steps/s
[Step=61500 Epoch=120.2] | Loss=0.00660 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.442 | L2-Norm(final)=18.180 | 5136.3 samples/s | 80.3 steps/s
[Step=61550 Epoch=120.3] | Loss=0.00649 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.443 | L2-Norm(final)=18.181 | 2190.5 samples/s | 34.2 steps/s
[Step=61600 Epoch=120.4] | Loss=0.00636 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.444 | L2-Norm(final)=18.182 | 4822.1 samples/s | 75.3 steps/s
[Step=61650 Epoch=120.5] | Loss=0.00629 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.446 | L2-Norm(final)=18.183 | 4766.9 samples/s | 74.5 steps/s
[Step=61700 Epoch=120.6] | Loss=0.00620 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.447 | L2-Norm(final)=18.184 | 4801.0 samples/s | 75.0 steps/s
[Step=61750 Epoch=120.7] | Loss=0.00613 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.448 | L2-Norm(final)=18.185 | 4729.7 samples/s | 73.9 steps/s
[Step=61800 Epoch=120.8] | Loss=0.00607 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=18.186 | 4820.6 samples/s | 75.3 steps/s
[Step=61850 Epoch=120.9] | Loss=0.00600 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.451 | L2-Norm(final)=18.187 | 4741.3 samples/s | 74.1 steps/s
[Step=61900 Epoch=121.0] | Loss=0.00598 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.452 | L2-Norm(final)=18.188 | 4795.3 samples/s | 74.9 steps/s
[Step=61950 Epoch=121.1] | Loss=0.00600 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.453 | L2-Norm(final)=18.189 | 4807.8 samples/s | 75.1 steps/s
[Step=62000 Epoch=121.2] | Loss=0.00598 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.454 | L2-Norm(final)=18.190 | 4782.7 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step62000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=60001 Epoch=229.9] | Loss=0.00004 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=16.804 | 4370.9 samples/s | 68.3 steps/s
[Step=60050 Epoch=230.1] | Loss=0.00003 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=16.804 | 5040.0 samples/s | 78.7 steps/s
[Step=60100 Epoch=230.3] | Loss=0.00003 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=16.805 | 5146.7 samples/s | 80.4 steps/s
[Step=60150 Epoch=230.5] | Loss=0.00003 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=16.805 | 5239.9 samples/s | 81.9 steps/s
[Step=60200 Epoch=230.7] | Loss=0.00004 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=16.806 | 5201.7 samples/s | 81.3 steps/s
[Step=60250 Epoch=230.9] | Loss=0.00004 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=16.806 | 6909.8 samples/s | 108.0 steps/s
[Step=60300 Epoch=231.0] | Loss=0.00004 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=16.807 | 2119.7 samples/s | 33.1 steps/s
[Step=60350 Epoch=231.2] | Loss=0.00004 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=16.808 | 5135.4 samples/s | 80.2 steps/s
[Step=60400 Epoch=231.4] | Loss=0.00004 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=16.808 | 5359.5 samples/s | 83.7 steps/s
[Step=60450 Epoch=231.6] | Loss=0.00004 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=16.809 | 5264.5 samples/s | 82.3 steps/s
[Step=60500 Epoch=231.8] | Loss=0.00004 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=16.810 | 5688.6 samples/s | 88.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=60501 Epoch=231.8] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=16.817 | 4545.9 samples/s | 71.0 steps/s
[Step=60550 Epoch=232.0] | Loss=0.00006 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=16.818 | 4155.6 samples/s | 64.9 steps/s
[Step=60600 Epoch=232.2] | Loss=0.00004 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=16.820 | 4528.3 samples/s | 70.8 steps/s
[Step=60650 Epoch=232.4] | Loss=0.00003 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.379 | L2-Norm(final)=16.821 | 4544.1 samples/s | 71.0 steps/s
[Step=60700 Epoch=232.6] | Loss=0.00003 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.377 | L2-Norm(final)=16.822 | 4540.9 samples/s | 71.0 steps/s
[Step=60750 Epoch=232.8] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.375 | L2-Norm(final)=16.823 | 5698.4 samples/s | 89.0 steps/s
[Step=60800 Epoch=233.0] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.373 | L2-Norm(final)=16.824 | 1986.9 samples/s | 31.0 steps/s
[Step=60850 Epoch=233.2] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.371 | L2-Norm(final)=16.824 | 4581.6 samples/s | 71.6 steps/s
[Step=60900 Epoch=233.3] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=16.825 | 4548.1 samples/s | 71.1 steps/s
[Step=60950 Epoch=233.5] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.366 | L2-Norm(final)=16.826 | 4637.2 samples/s | 72.5 steps/s
[Step=61000 Epoch=233.7] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=16.827 | 4920.0 samples/s | 76.9 steps/s
[Step=61050 Epoch=233.9] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.362 | L2-Norm(final)=16.828 | 2039.5 samples/s | 31.9 steps/s
[Step=61100 Epoch=234.1] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.359 | L2-Norm(final)=16.828 | 4592.6 samples/s | 71.8 steps/s
[Step=61150 Epoch=234.3] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=16.829 | 4434.9 samples/s | 69.3 steps/s
[Step=61200 Epoch=234.5] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=16.830 | 4617.0 samples/s | 72.1 steps/s
[Step=61250 Epoch=234.7] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=16.831 | 4549.3 samples/s | 71.1 steps/s
[Step=61300 Epoch=234.9] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=16.831 | 2166.4 samples/s | 33.8 steps/s
[Step=61350 Epoch=235.1] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.347 | L2-Norm(final)=16.832 | 4571.5 samples/s | 71.4 steps/s
[Step=61400 Epoch=235.3] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.344 | L2-Norm(final)=16.833 | 4553.4 samples/s | 71.1 steps/s
[Step=61450 Epoch=235.5] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=16.834 | 4595.7 samples/s | 71.8 steps/s
[Step=61500 Epoch=235.6] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.339 | L2-Norm(final)=16.834 | 4559.9 samples/s | 71.2 steps/s
[Step=61550 Epoch=235.8] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.336 | L2-Norm(final)=16.835 | 2196.7 samples/s | 34.3 steps/s
[Step=61600 Epoch=236.0] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.333 | L2-Norm(final)=16.836 | 4519.7 samples/s | 70.6 steps/s
[Step=61650 Epoch=236.2] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.331 | L2-Norm(final)=16.837 | 4554.4 samples/s | 71.2 steps/s
[Step=61700 Epoch=236.4] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.328 | L2-Norm(final)=16.837 | 4550.7 samples/s | 71.1 steps/s
[Step=61750 Epoch=236.6] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.325 | L2-Norm(final)=16.838 | 4569.3 samples/s | 71.4 steps/s
[Step=61800 Epoch=236.8] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.322 | L2-Norm(final)=16.839 | 6168.1 samples/s | 96.4 steps/s
[Step=61850 Epoch=237.0] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.319 | L2-Norm(final)=16.839 | 1961.2 samples/s | 30.6 steps/s
[Step=61900 Epoch=237.2] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.316 | L2-Norm(final)=16.840 | 4448.3 samples/s | 69.5 steps/s
[Step=61950 Epoch=237.4] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.313 | L2-Norm(final)=16.841 | 4558.5 samples/s | 71.2 steps/s
[Step=62000 Epoch=237.6] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.310 | L2-Norm(final)=16.841 | 4533.9 samples/s | 70.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step62000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=60001 Epoch=231.0] | Loss=0.00020 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=17.756 | 4886.9 samples/s | 76.4 steps/s
[Step=60050 Epoch=231.2] | Loss=0.00009 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=17.756 | 4514.7 samples/s | 70.5 steps/s
[Step=60100 Epoch=231.3] | Loss=0.00009 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=17.757 | 5197.8 samples/s | 81.2 steps/s
[Step=60150 Epoch=231.5] | Loss=0.00009 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=17.758 | 5279.7 samples/s | 82.5 steps/s
[Step=60200 Epoch=231.7] | Loss=0.00008 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=17.759 | 5160.5 samples/s | 80.6 steps/s
[Step=60250 Epoch=231.9] | Loss=0.00008 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=17.760 | 6870.6 samples/s | 107.4 steps/s
[Step=60300 Epoch=232.1] | Loss=0.00008 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=17.761 | 2140.4 samples/s | 33.4 steps/s
[Step=60350 Epoch=232.3] | Loss=0.00008 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=17.762 | 5243.7 samples/s | 81.9 steps/s
[Step=60400 Epoch=232.5] | Loss=0.00008 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=17.764 | 5243.7 samples/s | 81.9 steps/s
[Step=60450 Epoch=232.7] | Loss=0.00008 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=17.765 | 5025.6 samples/s | 78.5 steps/s
[Step=60500 Epoch=232.9] | Loss=0.00008 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=17.766 | 6083.3 samples/s | 95.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=60501 Epoch=232.9] | Loss=0.00006 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=17.777 | 4402.9 samples/s | 68.8 steps/s
[Step=60550 Epoch=233.1] | Loss=0.00004 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=17.778 | 4463.5 samples/s | 69.7 steps/s
[Step=60600 Epoch=233.3] | Loss=0.00004 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.379 | L2-Norm(final)=17.780 | 4524.4 samples/s | 70.7 steps/s
[Step=60650 Epoch=233.5] | Loss=0.00003 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.378 | L2-Norm(final)=17.781 | 4572.3 samples/s | 71.4 steps/s
[Step=60700 Epoch=233.7] | Loss=0.00003 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.377 | L2-Norm(final)=17.782 | 4546.7 samples/s | 71.0 steps/s
[Step=60750 Epoch=233.9] | Loss=0.00003 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.376 | L2-Norm(final)=17.783 | 5776.7 samples/s | 90.3 steps/s
[Step=60800 Epoch=234.0] | Loss=0.00003 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=17.784 | 2000.2 samples/s | 31.3 steps/s
[Step=60850 Epoch=234.2] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.372 | L2-Norm(final)=17.785 | 4530.3 samples/s | 70.8 steps/s
[Step=60900 Epoch=234.4] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.371 | L2-Norm(final)=17.785 | 4551.8 samples/s | 71.1 steps/s
[Step=60950 Epoch=234.6] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=17.786 | 4521.0 samples/s | 70.6 steps/s
[Step=61000 Epoch=234.8] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=17.787 | 5149.2 samples/s | 80.5 steps/s
[Step=61050 Epoch=235.0] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.365 | L2-Norm(final)=17.788 | 2086.3 samples/s | 32.6 steps/s
[Step=61100 Epoch=235.2] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.363 | L2-Norm(final)=17.788 | 4517.8 samples/s | 70.6 steps/s
[Step=61150 Epoch=235.4] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.360 | L2-Norm(final)=17.789 | 4571.3 samples/s | 71.4 steps/s
[Step=61200 Epoch=235.6] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=17.789 | 4548.0 samples/s | 71.1 steps/s
[Step=61250 Epoch=235.8] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.356 | L2-Norm(final)=17.790 | 4606.4 samples/s | 72.0 steps/s
[Step=61300 Epoch=236.0] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=17.791 | 2194.9 samples/s | 34.3 steps/s
[Step=61350 Epoch=236.2] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=17.791 | 4500.3 samples/s | 70.3 steps/s
[Step=61400 Epoch=236.4] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=17.792 | 4548.0 samples/s | 71.1 steps/s
[Step=61450 Epoch=236.5] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.347 | L2-Norm(final)=17.792 | 4537.8 samples/s | 70.9 steps/s
[Step=61500 Epoch=236.7] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.345 | L2-Norm(final)=17.793 | 4589.2 samples/s | 71.7 steps/s
[Step=61550 Epoch=236.9] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=17.793 | 2219.1 samples/s | 34.7 steps/s
[Step=61600 Epoch=237.1] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=17.794 | 4565.0 samples/s | 71.3 steps/s
[Step=61650 Epoch=237.3] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.338 | L2-Norm(final)=17.794 | 4546.7 samples/s | 71.0 steps/s
[Step=61700 Epoch=237.5] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.335 | L2-Norm(final)=17.795 | 4558.1 samples/s | 71.2 steps/s
[Step=61750 Epoch=237.7] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.333 | L2-Norm(final)=17.796 | 4635.6 samples/s | 72.4 steps/s
[Step=61800 Epoch=237.9] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.330 | L2-Norm(final)=17.796 | 6556.2 samples/s | 102.4 steps/s
[Step=61850 Epoch=238.1] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=17.797 | 1902.2 samples/s | 29.7 steps/s
[Step=61900 Epoch=238.3] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.325 | L2-Norm(final)=17.797 | 4558.7 samples/s | 71.2 steps/s
[Step=61950 Epoch=238.5] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.322 | L2-Norm(final)=17.798 | 4585.2 samples/s | 71.6 steps/s
[Step=62000 Epoch=238.7] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.319 | L2-Norm(final)=17.798 | 4676.1 samples/s | 73.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step62000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08464 | acc=0.9699 | tpr=0.9807 | fpr=0.0535 | 4055.5 samples/s | 15.8 steps/s
Avg test loss: 0.08288, Avg test acc: 0.96903, Avg tpr: 0.97989, Avg fpr: 0.05486, total FA: 428

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08061 | acc=0.9715 | tpr=0.9811 | fpr=0.0493 | 4157.8 samples/s | 16.2 steps/s
Avg test loss: 0.07986, Avg test acc: 0.97099, Avg tpr: 0.98123, Avg fpr: 0.05153, total FA: 402

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.71866 | acc=0.2977 | tpr=0.0079 | fpr=0.0731 | 4247.3 samples/s | 16.6 steps/s
Avg test loss: 6.72577, Avg test acc: 0.29526, Avg tpr: 0.00740, Avg fpr: 0.07166, total FA: 559

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.57959 | acc=0.2861 | tpr=0.0131 | fpr=0.1212 | 4148.0 samples/s | 16.2 steps/s
Avg test loss: 6.58247, Avg test acc: 0.28440, Avg tpr: 0.01253, Avg fpr: 0.11768, total FA: 918

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.74104 | acc=0.1205 | tpr=0.4646 | fpr=0.8857 | 4133.0 samples/s | 16.1 steps/s
[Step= 100] | Loss=6.66671 | acc=0.1223 | tpr=0.4691 | fpr=0.8842 | 8110.2 samples/s | 31.7 steps/s
[Step= 150] | Loss=6.67389 | acc=0.1223 | tpr=0.4741 | fpr=0.8842 | 7906.4 samples/s | 30.9 steps/s
[Step= 200] | Loss=6.66982 | acc=0.1224 | tpr=0.4721 | fpr=0.8840 | 7764.0 samples/s | 30.3 steps/s
[Step= 250] | Loss=6.66834 | acc=0.1220 | tpr=0.4638 | fpr=0.8842 | 7776.2 samples/s | 30.4 steps/s
[Step= 300] | Loss=6.67604 | acc=0.1209 | tpr=0.4604 | fpr=0.8853 | 8016.8 samples/s | 31.3 steps/s
[Step= 350] | Loss=6.68667 | acc=0.1206 | tpr=0.4577 | fpr=0.8855 | 7831.7 samples/s | 30.6 steps/s
[Step= 400] | Loss=6.67691 | acc=0.1203 | tpr=0.4453 | fpr=0.8856 | 7882.5 samples/s | 30.8 steps/s
[Step= 450] | Loss=6.67908 | acc=0.1196 | tpr=0.4450 | fpr=0.8863 | 7664.7 samples/s | 29.9 steps/s
[Step= 500] | Loss=6.68230 | acc=0.1193 | tpr=0.4489 | fpr=0.8867 | 8042.7 samples/s | 31.4 steps/s
[Step= 550] | Loss=6.68469 | acc=0.1194 | tpr=0.4497 | fpr=0.8866 | 14088.3 samples/s | 55.0 steps/s
Avg test loss: 6.68557, Avg test acc: 0.11935, Avg tpr: 0.45008, Avg fpr: 0.88666, total FA: 123111

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.42161 | acc=0.1298 | tpr=0.4204 | fpr=0.8754 | 4158.6 samples/s | 16.2 steps/s
[Step= 100] | Loss=6.35879 | acc=0.1306 | tpr=0.4307 | fpr=0.8750 | 7826.4 samples/s | 30.6 steps/s
[Step= 150] | Loss=6.36970 | acc=0.1297 | tpr=0.4337 | fpr=0.8759 | 8507.2 samples/s | 33.2 steps/s
[Step= 200] | Loss=6.36369 | acc=0.1301 | tpr=0.4317 | fpr=0.8754 | 7247.3 samples/s | 28.3 steps/s
[Step= 250] | Loss=6.36244 | acc=0.1298 | tpr=0.4271 | fpr=0.8756 | 8257.1 samples/s | 32.3 steps/s
[Step= 300] | Loss=6.37084 | acc=0.1292 | tpr=0.4262 | fpr=0.8762 | 8070.9 samples/s | 31.5 steps/s
[Step= 350] | Loss=6.38117 | acc=0.1291 | tpr=0.4271 | fpr=0.8763 | 7315.3 samples/s | 28.6 steps/s
[Step= 400] | Loss=6.37123 | acc=0.1285 | tpr=0.4163 | fpr=0.8767 | 7934.0 samples/s | 31.0 steps/s
[Step= 450] | Loss=6.37247 | acc=0.1281 | tpr=0.4158 | fpr=0.8771 | 7655.4 samples/s | 29.9 steps/s
[Step= 500] | Loss=6.37608 | acc=0.1278 | tpr=0.4163 | fpr=0.8775 | 7262.6 samples/s | 28.4 steps/s
[Step= 550] | Loss=6.37920 | acc=0.1279 | tpr=0.4178 | fpr=0.8774 | 13460.9 samples/s | 52.6 steps/s
Avg test loss: 6.37954, Avg test acc: 0.12782, Avg tpr: 0.41799, Avg fpr: 0.87746, total FA: 121833

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12551 | acc=0.9788 | tpr=0.9292 | fpr=0.0204 | 4132.6 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.13447 | acc=0.9779 | tpr=0.9467 | fpr=0.0216 | 8135.4 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.13553 | acc=0.9777 | tpr=0.9524 | fpr=0.0218 | 7668.2 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.13692 | acc=0.9781 | tpr=0.9563 | fpr=0.0215 | 7719.5 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.13632 | acc=0.9781 | tpr=0.9563 | fpr=0.0215 | 8030.9 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.13932 | acc=0.9779 | tpr=0.9578 | fpr=0.0217 | 7923.9 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.13960 | acc=0.9779 | tpr=0.9562 | fpr=0.0217 | 8050.0 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.14104 | acc=0.9775 | tpr=0.9551 | fpr=0.0220 | 7691.5 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.14249 | acc=0.9774 | tpr=0.9533 | fpr=0.0222 | 7736.8 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.14148 | acc=0.9775 | tpr=0.9546 | fpr=0.0221 | 7803.8 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.14042 | acc=0.9777 | tpr=0.9554 | fpr=0.0219 | 14012.8 samples/s | 54.7 steps/s
Avg test loss: 0.14013, Avg test acc: 0.97775, Avg tpr: 0.95563, Avg fpr: 0.02185, total FA: 3034

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15206 | acc=0.9761 | tpr=0.9425 | fpr=0.0233 | 4174.7 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.16244 | acc=0.9754 | tpr=0.9574 | fpr=0.0242 | 8044.0 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.16387 | acc=0.9753 | tpr=0.9625 | fpr=0.0245 | 7666.4 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.16541 | acc=0.9755 | tpr=0.9639 | fpr=0.0243 | 7867.9 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.16486 | acc=0.9754 | tpr=0.9633 | fpr=0.0244 | 7845.4 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.16836 | acc=0.9751 | tpr=0.9636 | fpr=0.0247 | 7937.4 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.16859 | acc=0.9751 | tpr=0.9618 | fpr=0.0247 | 7723.3 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.17030 | acc=0.9748 | tpr=0.9612 | fpr=0.0250 | 7870.5 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.17181 | acc=0.9747 | tpr=0.9591 | fpr=0.0250 | 7722.1 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.17065 | acc=0.9748 | tpr=0.9604 | fpr=0.0249 | 7942.8 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.16940 | acc=0.9750 | tpr=0.9606 | fpr=0.0247 | 14178.0 samples/s | 55.4 steps/s
Avg test loss: 0.16906, Avg test acc: 0.97505, Avg tpr: 0.96078, Avg fpr: 0.02469, total FA: 3428

server round 31/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=62001 Epoch=120.9] | Loss=0.00589 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=18.097 | 4052.5 samples/s | 63.3 steps/s
[Step=62050 Epoch=121.0] | Loss=0.00773 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=18.100 | 5285.7 samples/s | 82.6 steps/s
[Step=62100 Epoch=121.1] | Loss=0.00806 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.342 | L2-Norm(final)=18.103 | 5595.2 samples/s | 87.4 steps/s
[Step=62150 Epoch=121.2] | Loss=0.00891 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=18.105 | 5650.5 samples/s | 88.3 steps/s
[Step=62200 Epoch=121.3] | Loss=0.00828 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=18.107 | 5325.3 samples/s | 83.2 steps/s
[Step=62250 Epoch=121.4] | Loss=0.00857 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=18.108 | 5528.6 samples/s | 86.4 steps/s
[Step=62300 Epoch=121.5] | Loss=0.00856 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=18.109 | 5538.7 samples/s | 86.5 steps/s
[Step=62350 Epoch=121.6] | Loss=0.00884 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.342 | L2-Norm(final)=18.111 | 5502.5 samples/s | 86.0 steps/s
[Step=62400 Epoch=121.7] | Loss=0.00876 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=18.112 | 5597.2 samples/s | 87.5 steps/s
[Step=62450 Epoch=121.8] | Loss=0.00873 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.342 | L2-Norm(final)=18.114 | 5569.9 samples/s | 87.0 steps/s
[Step=62500 Epoch=121.9] | Loss=0.00854 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=18.115 | 6808.0 samples/s | 106.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=62501 Epoch=121.9] | Loss=0.00092 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=18.131 | 4516.5 samples/s | 70.6 steps/s
[Step=62550 Epoch=122.0] | Loss=0.00675 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.348 | L2-Norm(final)=18.133 | 4314.5 samples/s | 67.4 steps/s
[Step=62600 Epoch=122.1] | Loss=0.00792 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.354 | L2-Norm(final)=18.133 | 4755.0 samples/s | 74.3 steps/s
[Step=62650 Epoch=122.2] | Loss=0.00758 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.360 | L2-Norm(final)=18.134 | 4754.9 samples/s | 74.3 steps/s
[Step=62700 Epoch=122.3] | Loss=0.00723 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.365 | L2-Norm(final)=18.135 | 4784.7 samples/s | 74.8 steps/s
[Step=62750 Epoch=122.4] | Loss=0.00708 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=18.137 | 4840.5 samples/s | 75.6 steps/s
[Step=62800 Epoch=122.5] | Loss=0.00721 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.374 | L2-Norm(final)=18.138 | 4724.2 samples/s | 73.8 steps/s
[Step=62850 Epoch=122.6] | Loss=0.00743 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.377 | L2-Norm(final)=18.139 | 4785.4 samples/s | 74.8 steps/s
[Step=62900 Epoch=122.7] | Loss=0.00716 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=18.140 | 4769.4 samples/s | 74.5 steps/s
[Step=62950 Epoch=122.8] | Loss=0.00730 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.383 | L2-Norm(final)=18.140 | 4810.8 samples/s | 75.2 steps/s
[Step=63000 Epoch=122.9] | Loss=0.00732 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.386 | L2-Norm(final)=18.141 | 5871.5 samples/s | 91.7 steps/s
[Step=63050 Epoch=123.0] | Loss=0.00716 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.389 | L2-Norm(final)=18.142 | 2015.7 samples/s | 31.5 steps/s
[Step=63100 Epoch=123.1] | Loss=0.00686 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.391 | L2-Norm(final)=18.144 | 4802.3 samples/s | 75.0 steps/s
[Step=63150 Epoch=123.2] | Loss=0.00672 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.394 | L2-Norm(final)=18.145 | 4735.8 samples/s | 74.0 steps/s
[Step=63200 Epoch=123.3] | Loss=0.00655 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.396 | L2-Norm(final)=18.146 | 4808.7 samples/s | 75.1 steps/s
[Step=63250 Epoch=123.4] | Loss=0.00668 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.398 | L2-Norm(final)=18.147 | 4743.8 samples/s | 74.1 steps/s
[Step=63300 Epoch=123.5] | Loss=0.00662 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.400 | L2-Norm(final)=18.148 | 4788.2 samples/s | 74.8 steps/s
[Step=63350 Epoch=123.6] | Loss=0.00655 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.402 | L2-Norm(final)=18.149 | 4797.9 samples/s | 75.0 steps/s
[Step=63400 Epoch=123.7] | Loss=0.00649 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.404 | L2-Norm(final)=18.150 | 4754.3 samples/s | 74.3 steps/s
[Step=63450 Epoch=123.8] | Loss=0.00645 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.406 | L2-Norm(final)=18.151 | 4823.0 samples/s | 75.4 steps/s
[Step=63500 Epoch=123.8] | Loss=0.00644 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.408 | L2-Norm(final)=18.152 | 5052.6 samples/s | 78.9 steps/s
[Step=63550 Epoch=123.9] | Loss=0.00638 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.409 | L2-Norm(final)=18.153 | 2134.0 samples/s | 33.3 steps/s
[Step=63600 Epoch=124.0] | Loss=0.00623 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.411 | L2-Norm(final)=18.154 | 4792.1 samples/s | 74.9 steps/s
[Step=63650 Epoch=124.1] | Loss=0.00619 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=18.155 | 4815.9 samples/s | 75.2 steps/s
[Step=63700 Epoch=124.2] | Loss=0.00614 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.414 | L2-Norm(final)=18.156 | 4766.0 samples/s | 74.5 steps/s
[Step=63750 Epoch=124.3] | Loss=0.00612 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.416 | L2-Norm(final)=18.157 | 4768.9 samples/s | 74.5 steps/s
[Step=63800 Epoch=124.4] | Loss=0.00601 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.417 | L2-Norm(final)=18.158 | 4830.5 samples/s | 75.5 steps/s
[Step=63850 Epoch=124.5] | Loss=0.00594 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.419 | L2-Norm(final)=18.159 | 4769.3 samples/s | 74.5 steps/s
[Step=63900 Epoch=124.6] | Loss=0.00594 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.420 | L2-Norm(final)=18.160 | 4858.5 samples/s | 75.9 steps/s
[Step=63950 Epoch=124.7] | Loss=0.00591 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.422 | L2-Norm(final)=18.161 | 4769.3 samples/s | 74.5 steps/s
[Step=64000 Epoch=124.8] | Loss=0.00590 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.423 | L2-Norm(final)=18.162 | 4823.8 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step64000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=62001 Epoch=121.2] | Loss=0.00623 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=18.218 | 4484.4 samples/s | 70.1 steps/s
[Step=62050 Epoch=121.3] | Loss=0.00610 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.341 | L2-Norm(final)=18.221 | 5308.0 samples/s | 82.9 steps/s
[Step=62100 Epoch=121.4] | Loss=0.00616 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.341 | L2-Norm(final)=18.225 | 5467.0 samples/s | 85.4 steps/s
[Step=62150 Epoch=121.5] | Loss=0.00639 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=18.228 | 5559.2 samples/s | 86.9 steps/s
[Step=62200 Epoch=121.6] | Loss=0.00682 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=18.231 | 5435.5 samples/s | 84.9 steps/s
[Step=62250 Epoch=121.7] | Loss=0.00647 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=18.234 | 5557.5 samples/s | 86.8 steps/s
[Step=62300 Epoch=121.8] | Loss=0.00642 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=18.237 | 5554.9 samples/s | 86.8 steps/s
[Step=62350 Epoch=121.9] | Loss=0.00663 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=18.240 | 5449.4 samples/s | 85.1 steps/s
[Step=62400 Epoch=122.0] | Loss=0.00685 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=18.244 | 5550.2 samples/s | 86.7 steps/s
[Step=62450 Epoch=122.1] | Loss=0.00686 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=18.247 | 5509.7 samples/s | 86.1 steps/s
[Step=62500 Epoch=122.2] | Loss=0.00692 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=18.250 | 7118.1 samples/s | 111.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=62501 Epoch=122.2] | Loss=0.01363 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.341 | L2-Norm(final)=18.283 | 4349.1 samples/s | 68.0 steps/s
[Step=62550 Epoch=122.3] | Loss=0.00768 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.346 | L2-Norm(final)=18.286 | 4746.2 samples/s | 74.2 steps/s
[Step=62600 Epoch=122.4] | Loss=0.00793 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.353 | L2-Norm(final)=18.287 | 4731.3 samples/s | 73.9 steps/s
[Step=62650 Epoch=122.5] | Loss=0.00750 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=18.288 | 4773.9 samples/s | 74.6 steps/s
[Step=62700 Epoch=122.6] | Loss=0.00749 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.362 | L2-Norm(final)=18.289 | 4649.2 samples/s | 72.6 steps/s
[Step=62750 Epoch=122.7] | Loss=0.00761 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.365 | L2-Norm(final)=18.290 | 4806.0 samples/s | 75.1 steps/s
[Step=62800 Epoch=122.8] | Loss=0.00707 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.368 | L2-Norm(final)=18.292 | 4774.6 samples/s | 74.6 steps/s
[Step=62850 Epoch=122.9] | Loss=0.00712 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.371 | L2-Norm(final)=18.293 | 4798.8 samples/s | 75.0 steps/s
[Step=62900 Epoch=123.0] | Loss=0.00720 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=18.294 | 4774.0 samples/s | 74.6 steps/s
[Step=62950 Epoch=123.1] | Loss=0.00695 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.377 | L2-Norm(final)=18.295 | 4827.7 samples/s | 75.4 steps/s
[Step=63000 Epoch=123.2] | Loss=0.00686 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=18.296 | 5891.6 samples/s | 92.1 steps/s
[Step=63050 Epoch=123.3] | Loss=0.00671 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.383 | L2-Norm(final)=18.298 | 2096.5 samples/s | 32.8 steps/s
[Step=63100 Epoch=123.4] | Loss=0.00650 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.385 | L2-Norm(final)=18.299 | 4797.1 samples/s | 75.0 steps/s
[Step=63150 Epoch=123.5] | Loss=0.00631 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.388 | L2-Norm(final)=18.300 | 4718.7 samples/s | 73.7 steps/s
[Step=63200 Epoch=123.6] | Loss=0.00632 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.390 | L2-Norm(final)=18.301 | 4765.6 samples/s | 74.5 steps/s
[Step=63250 Epoch=123.7] | Loss=0.00627 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.392 | L2-Norm(final)=18.302 | 4810.7 samples/s | 75.2 steps/s
[Step=63300 Epoch=123.7] | Loss=0.00615 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.394 | L2-Norm(final)=18.303 | 4796.5 samples/s | 74.9 steps/s
[Step=63350 Epoch=123.8] | Loss=0.00613 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.396 | L2-Norm(final)=18.305 | 4746.5 samples/s | 74.2 steps/s
[Step=63400 Epoch=123.9] | Loss=0.00608 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.398 | L2-Norm(final)=18.306 | 4819.5 samples/s | 75.3 steps/s
[Step=63450 Epoch=124.0] | Loss=0.00612 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.400 | L2-Norm(final)=18.307 | 4755.7 samples/s | 74.3 steps/s
[Step=63500 Epoch=124.1] | Loss=0.00611 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.401 | L2-Norm(final)=18.308 | 5185.1 samples/s | 81.0 steps/s
[Step=63550 Epoch=124.2] | Loss=0.00607 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.403 | L2-Norm(final)=18.309 | 2199.0 samples/s | 34.4 steps/s
[Step=63600 Epoch=124.3] | Loss=0.00603 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=18.310 | 4765.2 samples/s | 74.5 steps/s
[Step=63650 Epoch=124.4] | Loss=0.00595 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.406 | L2-Norm(final)=18.311 | 4714.4 samples/s | 73.7 steps/s
[Step=63700 Epoch=124.5] | Loss=0.00587 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=18.312 | 4764.4 samples/s | 74.4 steps/s
[Step=63750 Epoch=124.6] | Loss=0.00583 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.409 | L2-Norm(final)=18.314 | 4815.5 samples/s | 75.2 steps/s
[Step=63800 Epoch=124.7] | Loss=0.00584 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.411 | L2-Norm(final)=18.315 | 4827.9 samples/s | 75.4 steps/s
[Step=63850 Epoch=124.8] | Loss=0.00576 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.412 | L2-Norm(final)=18.316 | 4719.0 samples/s | 73.7 steps/s
[Step=63900 Epoch=124.9] | Loss=0.00574 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=18.317 | 4724.9 samples/s | 73.8 steps/s
[Step=63950 Epoch=125.0] | Loss=0.00569 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.415 | L2-Norm(final)=18.318 | 4797.3 samples/s | 75.0 steps/s
[Step=64000 Epoch=125.1] | Loss=0.00562 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.416 | L2-Norm(final)=18.319 | 4810.0 samples/s | 75.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step64000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=62001 Epoch=237.6] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=16.861 | 4692.1 samples/s | 73.3 steps/s
[Step=62050 Epoch=237.8] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=16.862 | 4605.1 samples/s | 72.0 steps/s
[Step=62100 Epoch=237.9] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=16.864 | 5120.0 samples/s | 80.0 steps/s
[Step=62150 Epoch=238.1] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=16.866 | 5224.3 samples/s | 81.6 steps/s
[Step=62200 Epoch=238.3] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=16.868 | 5276.1 samples/s | 82.4 steps/s
[Step=62250 Epoch=238.5] | Loss=0.00003 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=16.869 | 6773.1 samples/s | 105.8 steps/s
[Step=62300 Epoch=238.7] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=16.871 | 2124.2 samples/s | 33.2 steps/s
[Step=62350 Epoch=238.9] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=16.873 | 5258.0 samples/s | 82.2 steps/s
[Step=62400 Epoch=239.1] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=16.875 | 5243.5 samples/s | 81.9 steps/s
[Step=62450 Epoch=239.3] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=16.876 | 5272.6 samples/s | 82.4 steps/s
[Step=62500 Epoch=239.5] | Loss=0.00003 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=16.878 | 5766.8 samples/s | 90.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=62501 Epoch=239.5] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=16.896 | 4737.7 samples/s | 74.0 steps/s
[Step=62550 Epoch=239.7] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.338 | L2-Norm(final)=16.897 | 4491.8 samples/s | 70.2 steps/s
[Step=62600 Epoch=239.9] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.333 | L2-Norm(final)=16.899 | 4602.6 samples/s | 71.9 steps/s
[Step=62650 Epoch=240.1] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.328 | L2-Norm(final)=16.900 | 4503.5 samples/s | 70.4 steps/s
[Step=62700 Epoch=240.2] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.323 | L2-Norm(final)=16.901 | 4560.9 samples/s | 71.3 steps/s
[Step=62750 Epoch=240.4] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.317 | L2-Norm(final)=16.902 | 5702.7 samples/s | 89.1 steps/s
[Step=62800 Epoch=240.6] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.312 | L2-Norm(final)=16.902 | 1999.3 samples/s | 31.2 steps/s
[Step=62850 Epoch=240.8] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.307 | L2-Norm(final)=16.903 | 4559.3 samples/s | 71.2 steps/s
[Step=62900 Epoch=241.0] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.301 | L2-Norm(final)=16.904 | 4493.7 samples/s | 70.2 steps/s
[Step=62950 Epoch=241.2] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.295 | L2-Norm(final)=16.904 | 4549.5 samples/s | 71.1 steps/s
[Step=63000 Epoch=241.4] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.290 | L2-Norm(final)=16.905 | 5027.1 samples/s | 78.5 steps/s
[Step=63050 Epoch=241.6] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.284 | L2-Norm(final)=16.906 | 2150.9 samples/s | 33.6 steps/s
[Step=63100 Epoch=241.8] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.278 | L2-Norm(final)=16.906 | 4558.3 samples/s | 71.2 steps/s
[Step=63150 Epoch=242.0] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.272 | L2-Norm(final)=16.907 | 4472.5 samples/s | 69.9 steps/s
[Step=63200 Epoch=242.2] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.267 | L2-Norm(final)=16.907 | 4595.7 samples/s | 71.8 steps/s
[Step=63250 Epoch=242.4] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.261 | L2-Norm(final)=16.908 | 4554.8 samples/s | 71.2 steps/s
[Step=63300 Epoch=242.5] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.255 | L2-Norm(final)=16.908 | 2177.1 samples/s | 34.0 steps/s
[Step=63350 Epoch=242.7] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.249 | L2-Norm(final)=16.909 | 4668.6 samples/s | 72.9 steps/s
[Step=63400 Epoch=242.9] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.243 | L2-Norm(final)=16.910 | 4574.6 samples/s | 71.5 steps/s
[Step=63450 Epoch=243.1] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.237 | L2-Norm(final)=16.910 | 4549.1 samples/s | 71.1 steps/s
[Step=63500 Epoch=243.3] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.230 | L2-Norm(final)=16.911 | 4501.7 samples/s | 70.3 steps/s
[Step=63550 Epoch=243.5] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=16.911 | 2199.2 samples/s | 34.4 steps/s
[Step=63600 Epoch=243.7] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=16.912 | 4513.5 samples/s | 70.5 steps/s
[Step=63650 Epoch=243.9] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.211 | L2-Norm(final)=16.912 | 4574.1 samples/s | 71.5 steps/s
[Step=63700 Epoch=244.1] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=16.913 | 4511.9 samples/s | 70.5 steps/s
[Step=63750 Epoch=244.3] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.198 | L2-Norm(final)=16.914 | 4582.6 samples/s | 71.6 steps/s
[Step=63800 Epoch=244.5] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.192 | L2-Norm(final)=16.914 | 6139.0 samples/s | 95.9 steps/s
[Step=63850 Epoch=244.7] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.185 | L2-Norm(final)=16.915 | 1946.6 samples/s | 30.4 steps/s
[Step=63900 Epoch=244.8] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=16.915 | 4515.2 samples/s | 70.5 steps/s
[Step=63950 Epoch=245.0] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.171 | L2-Norm(final)=16.916 | 4557.4 samples/s | 71.2 steps/s
[Step=64000 Epoch=245.2] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.165 | L2-Norm(final)=16.917 | 4524.2 samples/s | 70.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step64000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=62001 Epoch=238.7] | Loss=0.00004 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=17.815 | 4512.9 samples/s | 70.5 steps/s
[Step=62050 Epoch=238.9] | Loss=0.00013 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=17.818 | 5118.4 samples/s | 80.0 steps/s
[Step=62100 Epoch=239.0] | Loss=0.00008 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=17.823 | 5065.2 samples/s | 79.1 steps/s
[Step=62150 Epoch=239.2] | Loss=0.00008 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=17.827 | 5255.8 samples/s | 82.1 steps/s
[Step=62200 Epoch=239.4] | Loss=0.00007 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=17.830 | 5201.6 samples/s | 81.3 steps/s
[Step=62250 Epoch=239.6] | Loss=0.00006 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=17.833 | 6940.8 samples/s | 108.5 steps/s
[Step=62300 Epoch=239.8] | Loss=0.00007 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=17.835 | 2120.4 samples/s | 33.1 steps/s
[Step=62350 Epoch=240.0] | Loss=0.00006 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=17.838 | 5310.9 samples/s | 83.0 steps/s
[Step=62400 Epoch=240.2] | Loss=0.00006 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=17.841 | 5085.5 samples/s | 79.5 steps/s
[Step=62450 Epoch=240.4] | Loss=0.00006 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=17.844 | 5172.6 samples/s | 80.8 steps/s
[Step=62500 Epoch=240.6] | Loss=0.00006 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=17.846 | 6008.7 samples/s | 93.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=62501 Epoch=240.6] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=17.870 | 4991.7 samples/s | 78.0 steps/s
[Step=62550 Epoch=240.8] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.337 | L2-Norm(final)=17.871 | 3901.5 samples/s | 61.0 steps/s
[Step=62600 Epoch=241.0] | Loss=0.00002 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.334 | L2-Norm(final)=17.872 | 4574.5 samples/s | 71.5 steps/s
[Step=62650 Epoch=241.2] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.331 | L2-Norm(final)=17.873 | 4524.1 samples/s | 70.7 steps/s
[Step=62700 Epoch=241.4] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=17.874 | 4559.2 samples/s | 71.2 steps/s
[Step=62750 Epoch=241.5] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.322 | L2-Norm(final)=17.875 | 5776.7 samples/s | 90.3 steps/s
[Step=62800 Epoch=241.7] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.318 | L2-Norm(final)=17.876 | 1992.2 samples/s | 31.1 steps/s
[Step=62850 Epoch=241.9] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.313 | L2-Norm(final)=17.877 | 4544.7 samples/s | 71.0 steps/s
[Step=62900 Epoch=242.1] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.308 | L2-Norm(final)=17.878 | 4605.5 samples/s | 72.0 steps/s
[Step=62950 Epoch=242.3] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=17.878 | 4560.9 samples/s | 71.3 steps/s
[Step=63000 Epoch=242.5] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.298 | L2-Norm(final)=17.879 | 5109.8 samples/s | 79.8 steps/s
[Step=63050 Epoch=242.7] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=17.879 | 2081.5 samples/s | 32.5 steps/s
[Step=63100 Epoch=242.9] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=17.880 | 4674.2 samples/s | 73.0 steps/s
[Step=63150 Epoch=243.1] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=17.880 | 4495.5 samples/s | 70.2 steps/s
[Step=63200 Epoch=243.3] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.278 | L2-Norm(final)=17.880 | 4603.1 samples/s | 71.9 steps/s
[Step=63250 Epoch=243.5] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.272 | L2-Norm(final)=17.881 | 4604.3 samples/s | 71.9 steps/s
[Step=63300 Epoch=243.7] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.267 | L2-Norm(final)=17.881 | 2182.3 samples/s | 34.1 steps/s
[Step=63350 Epoch=243.9] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.262 | L2-Norm(final)=17.882 | 4617.8 samples/s | 72.2 steps/s
[Step=63400 Epoch=244.1] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.256 | L2-Norm(final)=17.882 | 4481.1 samples/s | 70.0 steps/s
[Step=63450 Epoch=244.2] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.251 | L2-Norm(final)=17.883 | 4564.8 samples/s | 71.3 steps/s
[Step=63500 Epoch=244.4] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=17.883 | 4378.5 samples/s | 68.4 steps/s
[Step=63550 Epoch=244.6] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.239 | L2-Norm(final)=17.883 | 2215.4 samples/s | 34.6 steps/s
[Step=63600 Epoch=244.8] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.233 | L2-Norm(final)=17.884 | 4509.4 samples/s | 70.5 steps/s
[Step=63650 Epoch=245.0] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.228 | L2-Norm(final)=17.884 | 4600.3 samples/s | 71.9 steps/s
[Step=63700 Epoch=245.2] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.222 | L2-Norm(final)=17.884 | 4517.9 samples/s | 70.6 steps/s
[Step=63750 Epoch=245.4] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.216 | L2-Norm(final)=17.885 | 4516.5 samples/s | 70.6 steps/s
[Step=63800 Epoch=245.6] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.210 | L2-Norm(final)=17.885 | 6692.2 samples/s | 104.6 steps/s
[Step=63850 Epoch=245.8] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.204 | L2-Norm(final)=17.886 | 1912.9 samples/s | 29.9 steps/s
[Step=63900 Epoch=246.0] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.197 | L2-Norm(final)=17.886 | 4531.4 samples/s | 70.8 steps/s
[Step=63950 Epoch=246.2] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=17.886 | 4564.1 samples/s | 71.3 steps/s
[Step=64000 Epoch=246.4] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.185 | L2-Norm(final)=17.887 | 4558.6 samples/s | 71.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step64000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08426 | acc=0.9694 | tpr=0.9808 | fpr=0.0555 | 4161.1 samples/s | 16.3 steps/s
Avg test loss: 0.08209, Avg test acc: 0.96971, Avg tpr: 0.98077, Avg fpr: 0.05461, total FA: 426

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07929 | acc=0.9708 | tpr=0.9783 | fpr=0.0456 | 4213.3 samples/s | 16.5 steps/s
Avg test loss: 0.07882, Avg test acc: 0.97095, Avg tpr: 0.97913, Avg fpr: 0.04705, total FA: 367

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.90942 | acc=0.2950 | tpr=0.0078 | fpr=0.0813 | 4190.3 samples/s | 16.4 steps/s
Avg test loss: 6.91766, Avg test acc: 0.29261, Avg tpr: 0.00717, Avg fpr: 0.07961, total FA: 621

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.85109 | acc=0.2852 | tpr=0.0124 | fpr=0.1224 | 4207.6 samples/s | 16.4 steps/s
Avg test loss: 6.85619, Avg test acc: 0.28316, Avg tpr: 0.01189, Avg fpr: 0.12024, total FA: 938

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.67061 | acc=0.1195 | tpr=0.4823 | fpr=0.8871 | 4171.1 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.60231 | acc=0.1204 | tpr=0.4947 | fpr=0.8866 | 8094.5 samples/s | 31.6 steps/s
[Step= 150] | Loss=6.61173 | acc=0.1195 | tpr=0.4986 | fpr=0.8875 | 7473.9 samples/s | 29.2 steps/s
[Step= 200] | Loss=6.60680 | acc=0.1196 | tpr=0.4951 | fpr=0.8872 | 8014.6 samples/s | 31.3 steps/s
[Step= 250] | Loss=6.60765 | acc=0.1195 | tpr=0.4856 | fpr=0.8872 | 7979.0 samples/s | 31.2 steps/s
[Step= 300] | Loss=6.61484 | acc=0.1186 | tpr=0.4800 | fpr=0.8880 | 7857.7 samples/s | 30.7 steps/s
[Step= 350] | Loss=6.62471 | acc=0.1182 | tpr=0.4790 | fpr=0.8883 | 7925.3 samples/s | 31.0 steps/s
[Step= 400] | Loss=6.61534 | acc=0.1179 | tpr=0.4661 | fpr=0.8884 | 7768.1 samples/s | 30.3 steps/s
[Step= 450] | Loss=6.61720 | acc=0.1173 | tpr=0.4654 | fpr=0.8890 | 7830.0 samples/s | 30.6 steps/s
[Step= 500] | Loss=6.62017 | acc=0.1171 | tpr=0.4709 | fpr=0.8893 | 7657.6 samples/s | 29.9 steps/s
[Step= 550] | Loss=6.62165 | acc=0.1172 | tpr=0.4712 | fpr=0.8892 | 14796.6 samples/s | 57.8 steps/s
Avg test loss: 6.62228, Avg test acc: 0.11717, Avg tpr: 0.47187, Avg fpr: 0.88928, total FA: 123475

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.20173 | acc=0.1387 | tpr=0.4381 | fpr=0.8667 | 4196.4 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.13695 | acc=0.1401 | tpr=0.4286 | fpr=0.8653 | 7902.9 samples/s | 30.9 steps/s
[Step= 150] | Loss=6.14727 | acc=0.1393 | tpr=0.4366 | fpr=0.8662 | 7813.1 samples/s | 30.5 steps/s
[Step= 200] | Loss=6.13873 | acc=0.1398 | tpr=0.4306 | fpr=0.8655 | 8071.1 samples/s | 31.5 steps/s
[Step= 250] | Loss=6.13751 | acc=0.1400 | tpr=0.4279 | fpr=0.8652 | 7594.0 samples/s | 29.7 steps/s
[Step= 300] | Loss=6.14596 | acc=0.1392 | tpr=0.4225 | fpr=0.8659 | 7895.5 samples/s | 30.8 steps/s
[Step= 350] | Loss=6.15623 | acc=0.1391 | tpr=0.4220 | fpr=0.8661 | 8011.0 samples/s | 31.3 steps/s
[Step= 400] | Loss=6.14695 | acc=0.1386 | tpr=0.4119 | fpr=0.8663 | 7690.5 samples/s | 30.0 steps/s
[Step= 450] | Loss=6.14746 | acc=0.1383 | tpr=0.4094 | fpr=0.8666 | 7670.4 samples/s | 30.0 steps/s
[Step= 500] | Loss=6.15019 | acc=0.1380 | tpr=0.4123 | fpr=0.8670 | 7793.4 samples/s | 30.4 steps/s
[Step= 550] | Loss=6.15350 | acc=0.1381 | tpr=0.4138 | fpr=0.8669 | 14987.1 samples/s | 58.5 steps/s
Avg test loss: 6.15394, Avg test acc: 0.13800, Avg tpr: 0.41363, Avg fpr: 0.86701, total FA: 120383

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13156 | acc=0.9788 | tpr=0.9292 | fpr=0.0203 | 4165.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.14053 | acc=0.9780 | tpr=0.9403 | fpr=0.0213 | 7778.5 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.14148 | acc=0.9778 | tpr=0.9496 | fpr=0.0217 | 7933.7 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.14274 | acc=0.9780 | tpr=0.9530 | fpr=0.0216 | 7905.4 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.14211 | acc=0.9780 | tpr=0.9546 | fpr=0.0216 | 8106.3 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.14509 | acc=0.9778 | tpr=0.9564 | fpr=0.0218 | 7633.2 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.14527 | acc=0.9777 | tpr=0.9555 | fpr=0.0219 | 7818.3 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.14676 | acc=0.9774 | tpr=0.9540 | fpr=0.0221 | 7811.3 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.14831 | acc=0.9773 | tpr=0.9528 | fpr=0.0222 | 7959.2 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.14728 | acc=0.9775 | tpr=0.9542 | fpr=0.0221 | 7921.5 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.14610 | acc=0.9777 | tpr=0.9550 | fpr=0.0219 | 13706.6 samples/s | 53.5 steps/s
Avg test loss: 0.14577, Avg test acc: 0.97775, Avg tpr: 0.95523, Avg fpr: 0.02184, total FA: 3032

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15832 | acc=0.9773 | tpr=0.9381 | fpr=0.0220 | 4076.4 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.16818 | acc=0.9764 | tpr=0.9531 | fpr=0.0232 | 8259.5 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.16929 | acc=0.9759 | tpr=0.9597 | fpr=0.0238 | 7784.1 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.17094 | acc=0.9761 | tpr=0.9617 | fpr=0.0236 | 7757.3 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.17033 | acc=0.9760 | tpr=0.9607 | fpr=0.0238 | 7850.2 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.17395 | acc=0.9757 | tpr=0.9615 | fpr=0.0241 | 7905.2 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.17422 | acc=0.9756 | tpr=0.9612 | fpr=0.0241 | 8004.8 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.17603 | acc=0.9753 | tpr=0.9601 | fpr=0.0244 | 7699.4 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.17762 | acc=0.9752 | tpr=0.9576 | fpr=0.0245 | 7860.2 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.17644 | acc=0.9753 | tpr=0.9590 | fpr=0.0244 | 7810.8 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.17515 | acc=0.9756 | tpr=0.9602 | fpr=0.0242 | 14678.0 samples/s | 57.3 steps/s
Avg test loss: 0.17478, Avg test acc: 0.97560, Avg tpr: 0.96038, Avg fpr: 0.02413, total FA: 3350

server round 32/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=64001 Epoch=124.8] | Loss=0.00042 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=18.190 | 4455.0 samples/s | 69.6 steps/s
[Step=64050 Epoch=124.9] | Loss=0.00569 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=18.192 | 5178.2 samples/s | 80.9 steps/s
[Step=64100 Epoch=125.0] | Loss=0.00578 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=18.196 | 5528.3 samples/s | 86.4 steps/s
[Step=64150 Epoch=125.1] | Loss=0.00588 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=18.200 | 5449.7 samples/s | 85.2 steps/s
[Step=64200 Epoch=125.2] | Loss=0.00567 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=18.203 | 5521.6 samples/s | 86.3 steps/s
[Step=64250 Epoch=125.3] | Loss=0.00572 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.194 | L2-Norm(final)=18.207 | 5606.0 samples/s | 87.6 steps/s
[Step=64300 Epoch=125.4] | Loss=0.00596 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.194 | L2-Norm(final)=18.210 | 5558.6 samples/s | 86.9 steps/s
[Step=64350 Epoch=125.5] | Loss=0.00599 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=18.213 | 5540.6 samples/s | 86.6 steps/s
[Step=64400 Epoch=125.6] | Loss=0.00606 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=18.216 | 5599.0 samples/s | 87.5 steps/s
[Step=64450 Epoch=125.7] | Loss=0.00619 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.194 | L2-Norm(final)=18.219 | 5401.8 samples/s | 84.4 steps/s
[Step=64500 Epoch=125.8] | Loss=0.00612 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=18.222 | 6979.6 samples/s | 109.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=64501 Epoch=125.8] | Loss=0.00439 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=18.250 | 4390.7 samples/s | 68.6 steps/s
[Step=64550 Epoch=125.9] | Loss=0.00680 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.201 | L2-Norm(final)=18.254 | 4413.7 samples/s | 69.0 steps/s
[Step=64600 Epoch=126.0] | Loss=0.00725 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.207 | L2-Norm(final)=18.253 | 4817.1 samples/s | 75.3 steps/s
[Step=64650 Epoch=126.1] | Loss=0.00706 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.212 | L2-Norm(final)=18.253 | 4728.0 samples/s | 73.9 steps/s
[Step=64700 Epoch=126.2] | Loss=0.00730 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.217 | L2-Norm(final)=18.253 | 4796.7 samples/s | 74.9 steps/s
[Step=64750 Epoch=126.3] | Loss=0.00700 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.221 | L2-Norm(final)=18.254 | 4799.6 samples/s | 75.0 steps/s
[Step=64800 Epoch=126.4] | Loss=0.00719 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.225 | L2-Norm(final)=18.255 | 4820.8 samples/s | 75.3 steps/s
[Step=64850 Epoch=126.5] | Loss=0.00721 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.229 | L2-Norm(final)=18.257 | 4797.8 samples/s | 75.0 steps/s
[Step=64900 Epoch=126.6] | Loss=0.00724 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.233 | L2-Norm(final)=18.258 | 4835.7 samples/s | 75.6 steps/s
[Step=64950 Epoch=126.7] | Loss=0.00706 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.236 | L2-Norm(final)=18.260 | 4795.6 samples/s | 74.9 steps/s
[Step=65000 Epoch=126.8] | Loss=0.00702 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.240 | L2-Norm(final)=18.261 | 5820.7 samples/s | 90.9 steps/s
[Step=65050 Epoch=126.9] | Loss=0.00705 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.243 | L2-Norm(final)=18.263 | 2044.5 samples/s | 31.9 steps/s
[Step=65100 Epoch=127.0] | Loss=0.00692 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.246 | L2-Norm(final)=18.264 | 4762.6 samples/s | 74.4 steps/s
[Step=65150 Epoch=127.1] | Loss=0.00666 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.249 | L2-Norm(final)=18.266 | 4808.9 samples/s | 75.1 steps/s
[Step=65200 Epoch=127.2] | Loss=0.00659 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.252 | L2-Norm(final)=18.268 | 4805.5 samples/s | 75.1 steps/s
[Step=65250 Epoch=127.3] | Loss=0.00656 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.254 | L2-Norm(final)=18.269 | 4740.4 samples/s | 74.1 steps/s
[Step=65300 Epoch=127.4] | Loss=0.00657 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.256 | L2-Norm(final)=18.271 | 4819.9 samples/s | 75.3 steps/s
[Step=65350 Epoch=127.5] | Loss=0.00668 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.259 | L2-Norm(final)=18.272 | 4830.5 samples/s | 75.5 steps/s
[Step=65400 Epoch=127.6] | Loss=0.00649 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.261 | L2-Norm(final)=18.273 | 4832.0 samples/s | 75.5 steps/s
[Step=65450 Epoch=127.7] | Loss=0.00639 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.263 | L2-Norm(final)=18.275 | 4783.4 samples/s | 74.7 steps/s
[Step=65500 Epoch=127.8] | Loss=0.00635 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.265 | L2-Norm(final)=18.276 | 5099.2 samples/s | 79.7 steps/s
[Step=65550 Epoch=127.8] | Loss=0.00623 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.266 | L2-Norm(final)=18.277 | 2074.7 samples/s | 32.4 steps/s
[Step=65600 Epoch=127.9] | Loss=0.00619 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.268 | L2-Norm(final)=18.279 | 4821.6 samples/s | 75.3 steps/s
[Step=65650 Epoch=128.0] | Loss=0.00621 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.270 | L2-Norm(final)=18.280 | 4819.4 samples/s | 75.3 steps/s
[Step=65700 Epoch=128.1] | Loss=0.00614 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.272 | L2-Norm(final)=18.282 | 4905.9 samples/s | 76.7 steps/s
[Step=65750 Epoch=128.2] | Loss=0.00608 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.274 | L2-Norm(final)=18.283 | 4750.3 samples/s | 74.2 steps/s
[Step=65800 Epoch=128.3] | Loss=0.00598 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.275 | L2-Norm(final)=18.285 | 4819.5 samples/s | 75.3 steps/s
[Step=65850 Epoch=128.4] | Loss=0.00593 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.277 | L2-Norm(final)=18.286 | 4785.4 samples/s | 74.8 steps/s
[Step=65900 Epoch=128.5] | Loss=0.00587 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.278 | L2-Norm(final)=18.288 | 4811.7 samples/s | 75.2 steps/s
[Step=65950 Epoch=128.6] | Loss=0.00593 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.280 | L2-Norm(final)=18.289 | 4856.7 samples/s | 75.9 steps/s
[Step=66000 Epoch=128.7] | Loss=0.00588 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.281 | L2-Norm(final)=18.290 | 4794.4 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step66000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=64001 Epoch=125.1] | Loss=0.00590 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.193 | L2-Norm(final)=18.351 | 4715.1 samples/s | 73.7 steps/s
[Step=64050 Epoch=125.2] | Loss=0.00612 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=18.356 | 4992.2 samples/s | 78.0 steps/s
[Step=64100 Epoch=125.3] | Loss=0.00527 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.194 | L2-Norm(final)=18.360 | 5614.8 samples/s | 87.7 steps/s
[Step=64150 Epoch=125.4] | Loss=0.00547 | Reg=0.00125 | acc=0.9688 | L2-Norm=11.194 | L2-Norm(final)=18.364 | 5614.4 samples/s | 87.7 steps/s
[Step=64200 Epoch=125.5] | Loss=0.00582 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.194 | L2-Norm(final)=18.368 | 5368.6 samples/s | 83.9 steps/s
[Step=64250 Epoch=125.6] | Loss=0.00566 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=18.372 | 5530.4 samples/s | 86.4 steps/s
[Step=64300 Epoch=125.7] | Loss=0.00578 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=18.376 | 5570.2 samples/s | 87.0 steps/s
[Step=64350 Epoch=125.8] | Loss=0.00577 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=18.379 | 5548.1 samples/s | 86.7 steps/s
[Step=64400 Epoch=125.9] | Loss=0.00607 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=18.383 | 5557.6 samples/s | 86.8 steps/s
[Step=64450 Epoch=126.0] | Loss=0.00612 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.194 | L2-Norm(final)=18.386 | 5647.2 samples/s | 88.2 steps/s
[Step=64500 Epoch=126.1] | Loss=0.00621 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.194 | L2-Norm(final)=18.389 | 6955.2 samples/s | 108.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=64501 Epoch=126.1] | Loss=0.01513 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.194 | L2-Norm(final)=18.422 | 4767.2 samples/s | 74.5 steps/s
[Step=64550 Epoch=126.2] | Loss=0.00775 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.204 | L2-Norm(final)=18.422 | 4437.7 samples/s | 69.3 steps/s
[Step=64600 Epoch=126.3] | Loss=0.00726 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.211 | L2-Norm(final)=18.424 | 4743.7 samples/s | 74.1 steps/s
[Step=64650 Epoch=126.4] | Loss=0.00675 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.216 | L2-Norm(final)=18.425 | 4780.1 samples/s | 74.7 steps/s
[Step=64700 Epoch=126.5] | Loss=0.00671 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.220 | L2-Norm(final)=18.427 | 4769.3 samples/s | 74.5 steps/s
[Step=64750 Epoch=126.6] | Loss=0.00626 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.224 | L2-Norm(final)=18.428 | 4838.6 samples/s | 75.6 steps/s
[Step=64800 Epoch=126.7] | Loss=0.00637 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.228 | L2-Norm(final)=18.430 | 4748.0 samples/s | 74.2 steps/s
[Step=64850 Epoch=126.8] | Loss=0.00655 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.231 | L2-Norm(final)=18.431 | 4853.8 samples/s | 75.8 steps/s
[Step=64900 Epoch=126.9] | Loss=0.00648 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.234 | L2-Norm(final)=18.433 | 4732.7 samples/s | 73.9 steps/s
[Step=64950 Epoch=127.0] | Loss=0.00654 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.236 | L2-Norm(final)=18.434 | 4723.4 samples/s | 73.8 steps/s
[Step=65000 Epoch=127.1] | Loss=0.00660 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.239 | L2-Norm(final)=18.435 | 5921.3 samples/s | 92.5 steps/s
[Step=65050 Epoch=127.2] | Loss=0.00651 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.241 | L2-Norm(final)=18.436 | 2078.8 samples/s | 32.5 steps/s
[Step=65100 Epoch=127.3] | Loss=0.00632 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.243 | L2-Norm(final)=18.438 | 4760.7 samples/s | 74.4 steps/s
[Step=65150 Epoch=127.4] | Loss=0.00620 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=18.439 | 4765.6 samples/s | 74.5 steps/s
[Step=65200 Epoch=127.5] | Loss=0.00603 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.247 | L2-Norm(final)=18.441 | 4864.5 samples/s | 76.0 steps/s
[Step=65250 Epoch=127.6] | Loss=0.00617 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.249 | L2-Norm(final)=18.442 | 4792.1 samples/s | 74.9 steps/s
[Step=65300 Epoch=127.7] | Loss=0.00610 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.251 | L2-Norm(final)=18.443 | 4730.0 samples/s | 73.9 steps/s
[Step=65350 Epoch=127.8] | Loss=0.00611 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.253 | L2-Norm(final)=18.444 | 4803.8 samples/s | 75.1 steps/s
[Step=65400 Epoch=127.9] | Loss=0.00611 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.255 | L2-Norm(final)=18.445 | 4782.7 samples/s | 74.7 steps/s
[Step=65450 Epoch=128.0] | Loss=0.00605 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.257 | L2-Norm(final)=18.447 | 4761.5 samples/s | 74.4 steps/s
[Step=65500 Epoch=128.1] | Loss=0.00605 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.258 | L2-Norm(final)=18.448 | 5181.7 samples/s | 81.0 steps/s
[Step=65550 Epoch=128.1] | Loss=0.00603 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=18.449 | 2205.8 samples/s | 34.5 steps/s
[Step=65600 Epoch=128.2] | Loss=0.00599 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.262 | L2-Norm(final)=18.450 | 4762.2 samples/s | 74.4 steps/s
[Step=65650 Epoch=128.3] | Loss=0.00587 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.263 | L2-Norm(final)=18.451 | 4739.4 samples/s | 74.1 steps/s
[Step=65700 Epoch=128.4] | Loss=0.00576 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.265 | L2-Norm(final)=18.453 | 4785.1 samples/s | 74.8 steps/s
[Step=65750 Epoch=128.5] | Loss=0.00576 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.266 | L2-Norm(final)=18.454 | 4750.0 samples/s | 74.2 steps/s
[Step=65800 Epoch=128.6] | Loss=0.00578 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.268 | L2-Norm(final)=18.455 | 4809.8 samples/s | 75.2 steps/s
[Step=65850 Epoch=128.7] | Loss=0.00576 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.269 | L2-Norm(final)=18.456 | 4766.6 samples/s | 74.5 steps/s
[Step=65900 Epoch=128.8] | Loss=0.00569 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.270 | L2-Norm(final)=18.457 | 4790.3 samples/s | 74.8 steps/s
[Step=65950 Epoch=128.9] | Loss=0.00562 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.272 | L2-Norm(final)=18.458 | 4812.3 samples/s | 75.2 steps/s
[Step=66000 Epoch=129.0] | Loss=0.00560 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.273 | L2-Norm(final)=18.459 | 4848.9 samples/s | 75.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step66000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=64001 Epoch=245.2] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=16.934 | 4350.9 samples/s | 68.0 steps/s
[Step=64050 Epoch=245.4] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=16.937 | 5186.3 samples/s | 81.0 steps/s
[Step=64100 Epoch=245.6] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=16.942 | 5265.8 samples/s | 82.3 steps/s
[Step=64150 Epoch=245.8] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=16.947 | 5135.0 samples/s | 80.2 steps/s
[Step=64200 Epoch=246.0] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=16.951 | 5289.0 samples/s | 82.6 steps/s
[Step=64250 Epoch=246.2] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=16.955 | 6434.8 samples/s | 100.5 steps/s
[Step=64300 Epoch=246.4] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=16.959 | 2156.7 samples/s | 33.7 steps/s
[Step=64350 Epoch=246.6] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=16.963 | 5109.1 samples/s | 79.8 steps/s
[Step=64400 Epoch=246.8] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=16.967 | 5237.2 samples/s | 81.8 steps/s
[Step=64450 Epoch=246.9] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=16.971 | 5183.5 samples/s | 81.0 steps/s
[Step=64500 Epoch=247.1] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=16.975 | 5884.6 samples/s | 91.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=64501 Epoch=247.1] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=17.012 | 4641.5 samples/s | 72.5 steps/s
[Step=64550 Epoch=247.3] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=17.013 | 4257.8 samples/s | 66.5 steps/s
[Step=64600 Epoch=247.5] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.171 | L2-Norm(final)=17.015 | 4481.5 samples/s | 70.0 steps/s
[Step=64650 Epoch=247.7] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.159 | L2-Norm(final)=17.016 | 4571.5 samples/s | 71.4 steps/s
[Step=64700 Epoch=247.9] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.147 | L2-Norm(final)=17.017 | 4591.0 samples/s | 71.7 steps/s
[Step=64750 Epoch=248.1] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.134 | L2-Norm(final)=17.019 | 5664.2 samples/s | 88.5 steps/s
[Step=64800 Epoch=248.3] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.122 | L2-Norm(final)=17.020 | 2022.4 samples/s | 31.6 steps/s
[Step=64850 Epoch=248.5] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.109 | L2-Norm(final)=17.021 | 4484.9 samples/s | 70.1 steps/s
[Step=64900 Epoch=248.7] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.096 | L2-Norm(final)=17.022 | 4644.1 samples/s | 72.6 steps/s
[Step=64950 Epoch=248.9] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.083 | L2-Norm(final)=17.023 | 4582.2 samples/s | 71.6 steps/s
[Step=65000 Epoch=249.1] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.070 | L2-Norm(final)=17.024 | 4991.3 samples/s | 78.0 steps/s
[Step=65050 Epoch=249.2] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.057 | L2-Norm(final)=17.025 | 2140.2 samples/s | 33.4 steps/s
[Step=65100 Epoch=249.4] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.044 | L2-Norm(final)=17.026 | 4475.9 samples/s | 69.9 steps/s
[Step=65150 Epoch=249.6] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.030 | L2-Norm(final)=17.027 | 4595.8 samples/s | 71.8 steps/s
[Step=65200 Epoch=249.8] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=17.028 | 4493.6 samples/s | 70.2 steps/s
[Step=65250 Epoch=250.0] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.004 | L2-Norm(final)=17.029 | 4536.2 samples/s | 70.9 steps/s
[Step=65300 Epoch=250.2] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.990 | L2-Norm(final)=17.030 | 2188.4 samples/s | 34.2 steps/s
[Step=65350 Epoch=250.4] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.976 | L2-Norm(final)=17.031 | 4671.5 samples/s | 73.0 steps/s
[Step=65400 Epoch=250.6] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=17.031 | 4586.0 samples/s | 71.7 steps/s
[Step=65450 Epoch=250.8] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.949 | L2-Norm(final)=17.032 | 4532.9 samples/s | 70.8 steps/s
[Step=65500 Epoch=251.0] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.935 | L2-Norm(final)=17.033 | 4617.8 samples/s | 72.2 steps/s
[Step=65550 Epoch=251.2] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.921 | L2-Norm(final)=17.034 | 2223.1 samples/s | 34.7 steps/s
[Step=65600 Epoch=251.4] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.906 | L2-Norm(final)=17.035 | 4589.5 samples/s | 71.7 steps/s
[Step=65650 Epoch=251.5] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.892 | L2-Norm(final)=17.036 | 4463.6 samples/s | 69.7 steps/s
[Step=65700 Epoch=251.7] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.878 | L2-Norm(final)=17.037 | 4588.3 samples/s | 71.7 steps/s
[Step=65750 Epoch=251.9] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.863 | L2-Norm(final)=17.038 | 4557.5 samples/s | 71.2 steps/s
[Step=65800 Epoch=252.1] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.849 | L2-Norm(final)=17.039 | 6124.9 samples/s | 95.7 steps/s
[Step=65850 Epoch=252.3] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=17.040 | 1959.1 samples/s | 30.6 steps/s
[Step=65900 Epoch=252.5] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.819 | L2-Norm(final)=17.041 | 4535.0 samples/s | 70.9 steps/s
[Step=65950 Epoch=252.7] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.804 | L2-Norm(final)=17.042 | 4574.3 samples/s | 71.5 steps/s
[Step=66000 Epoch=252.9] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.789 | L2-Norm(final)=17.044 | 4564.2 samples/s | 71.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step66000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=64001 Epoch=246.4] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=17.898 | 4413.1 samples/s | 69.0 steps/s
[Step=64050 Epoch=246.6] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=17.901 | 4791.1 samples/s | 74.9 steps/s
[Step=64100 Epoch=246.7] | Loss=0.00006 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=17.903 | 5059.3 samples/s | 79.1 steps/s
[Step=64150 Epoch=246.9] | Loss=0.00005 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=17.907 | 5218.6 samples/s | 81.5 steps/s
[Step=64200 Epoch=247.1] | Loss=0.00005 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=17.910 | 5135.9 samples/s | 80.2 steps/s
[Step=64250 Epoch=247.3] | Loss=0.00004 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=17.914 | 7068.7 samples/s | 110.4 steps/s
[Step=64300 Epoch=247.5] | Loss=0.00004 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=17.917 | 2120.4 samples/s | 33.1 steps/s
[Step=64350 Epoch=247.7] | Loss=0.00004 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=17.920 | 5134.7 samples/s | 80.2 steps/s
[Step=64400 Epoch=247.9] | Loss=0.00004 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=17.924 | 5223.2 samples/s | 81.6 steps/s
[Step=64450 Epoch=248.1] | Loss=0.00004 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=17.927 | 5288.0 samples/s | 82.6 steps/s
[Step=64500 Epoch=248.3] | Loss=0.00003 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=17.930 | 5928.3 samples/s | 92.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=64501 Epoch=248.3] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=17.959 | 4579.4 samples/s | 71.6 steps/s
[Step=64550 Epoch=248.5] | Loss=0.00004 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.192 | L2-Norm(final)=17.960 | 4291.4 samples/s | 67.1 steps/s
[Step=64600 Epoch=248.7] | Loss=0.00003 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.189 | L2-Norm(final)=17.962 | 4592.5 samples/s | 71.8 steps/s
[Step=64650 Epoch=248.9] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=17.962 | 4555.4 samples/s | 71.2 steps/s
[Step=64700 Epoch=249.1] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=17.963 | 4602.0 samples/s | 71.9 steps/s
[Step=64750 Epoch=249.2] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.165 | L2-Norm(final)=17.964 | 5799.5 samples/s | 90.6 steps/s
[Step=64800 Epoch=249.4] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=17.964 | 1993.5 samples/s | 31.1 steps/s
[Step=64850 Epoch=249.6] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.146 | L2-Norm(final)=17.964 | 4562.8 samples/s | 71.3 steps/s
[Step=64900 Epoch=249.8] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.136 | L2-Norm(final)=17.965 | 4567.7 samples/s | 71.4 steps/s
[Step=64950 Epoch=250.0] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.127 | L2-Norm(final)=17.965 | 4620.3 samples/s | 72.2 steps/s
[Step=65000 Epoch=250.2] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.117 | L2-Norm(final)=17.965 | 5118.0 samples/s | 80.0 steps/s
[Step=65050 Epoch=250.4] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.107 | L2-Norm(final)=17.966 | 2089.9 samples/s | 32.7 steps/s
[Step=65100 Epoch=250.6] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.097 | L2-Norm(final)=17.966 | 4500.4 samples/s | 70.3 steps/s
[Step=65150 Epoch=250.8] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=17.966 | 4603.0 samples/s | 71.9 steps/s
[Step=65200 Epoch=251.0] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.076 | L2-Norm(final)=17.967 | 4592.9 samples/s | 71.8 steps/s
[Step=65250 Epoch=251.2] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.066 | L2-Norm(final)=17.967 | 4577.8 samples/s | 71.5 steps/s
[Step=65300 Epoch=251.4] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.056 | L2-Norm(final)=17.967 | 2175.8 samples/s | 34.0 steps/s
[Step=65350 Epoch=251.6] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.045 | L2-Norm(final)=17.968 | 4574.1 samples/s | 71.5 steps/s
[Step=65400 Epoch=251.8] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.034 | L2-Norm(final)=17.968 | 4593.3 samples/s | 71.8 steps/s
[Step=65450 Epoch=251.9] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=17.968 | 4572.1 samples/s | 71.4 steps/s
[Step=65500 Epoch=252.1] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.013 | L2-Norm(final)=17.969 | 4596.8 samples/s | 71.8 steps/s
[Step=65550 Epoch=252.3] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.002 | L2-Norm(final)=17.969 | 2138.4 samples/s | 33.4 steps/s
[Step=65600 Epoch=252.5] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.991 | L2-Norm(final)=17.969 | 4608.4 samples/s | 72.0 steps/s
[Step=65650 Epoch=252.7] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.979 | L2-Norm(final)=17.970 | 4591.4 samples/s | 71.7 steps/s
[Step=65700 Epoch=252.9] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.968 | L2-Norm(final)=17.970 | 4599.9 samples/s | 71.9 steps/s
[Step=65750 Epoch=253.1] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=17.970 | 4610.0 samples/s | 72.0 steps/s
[Step=65800 Epoch=253.3] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=17.971 | 6632.2 samples/s | 103.6 steps/s
[Step=65850 Epoch=253.5] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=17.971 | 1899.5 samples/s | 29.7 steps/s
[Step=65900 Epoch=253.7] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.921 | L2-Norm(final)=17.972 | 4539.1 samples/s | 70.9 steps/s
[Step=65950 Epoch=253.9] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.909 | L2-Norm(final)=17.972 | 4588.0 samples/s | 71.7 steps/s
[Step=66000 Epoch=254.1] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.897 | L2-Norm(final)=17.972 | 4505.8 samples/s | 70.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step66000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07982 | acc=0.9698 | tpr=0.9773 | fpr=0.0466 | 4161.2 samples/s | 16.3 steps/s
Avg test loss: 0.07767, Avg test acc: 0.96975, Avg tpr: 0.97733, Avg fpr: 0.04692, total FA: 366

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07860 | acc=0.9691 | tpr=0.9751 | fpr=0.0439 | 4212.2 samples/s | 16.5 steps/s
Avg test loss: 0.07759, Avg test acc: 0.96907, Avg tpr: 0.97593, Avg fpr: 0.04602, total FA: 359

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.77223 | acc=0.2966 | tpr=0.0072 | fpr=0.0748 | 4164.6 samples/s | 16.3 steps/s
Avg test loss: 6.78244, Avg test acc: 0.29357, Avg tpr: 0.00682, Avg fpr: 0.07576, total FA: 591

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.86245 | acc=0.2877 | tpr=0.0082 | fpr=0.1053 | 4184.9 samples/s | 16.3 steps/s
Avg test loss: 6.86828, Avg test acc: 0.28564, Avg tpr: 0.00851, Avg fpr: 0.10486, total FA: 818

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.85756 | acc=0.1353 | tpr=0.4204 | fpr=0.8698 | 4206.4 samples/s | 16.4 steps/s
[Step= 100] | Loss=5.79509 | acc=0.1372 | tpr=0.4307 | fpr=0.8683 | 7785.2 samples/s | 30.4 steps/s
[Step= 150] | Loss=5.80138 | acc=0.1365 | tpr=0.4366 | fpr=0.8690 | 7897.0 samples/s | 30.8 steps/s
[Step= 200] | Loss=5.79716 | acc=0.1370 | tpr=0.4306 | fpr=0.8684 | 7926.8 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.79591 | acc=0.1369 | tpr=0.4245 | fpr=0.8683 | 7733.8 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.80281 | acc=0.1362 | tpr=0.4153 | fpr=0.8689 | 7969.7 samples/s | 31.1 steps/s
[Step= 350] | Loss=5.81306 | acc=0.1357 | tpr=0.4145 | fpr=0.8693 | 7984.0 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.80447 | acc=0.1356 | tpr=0.4032 | fpr=0.8692 | 7559.3 samples/s | 29.5 steps/s
[Step= 450] | Loss=5.80631 | acc=0.1352 | tpr=0.3992 | fpr=0.8696 | 7961.6 samples/s | 31.1 steps/s
[Step= 500] | Loss=5.80906 | acc=0.1350 | tpr=0.4040 | fpr=0.8698 | 7538.2 samples/s | 29.4 steps/s
[Step= 550] | Loss=5.81153 | acc=0.1348 | tpr=0.4007 | fpr=0.8700 | 14637.5 samples/s | 57.2 steps/s
Avg test loss: 5.81204, Avg test acc: 0.13477, Avg tpr: 0.40095, Avg fpr: 0.87007, total FA: 120807

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.96042 | acc=0.1363 | tpr=0.4159 | fpr=0.8687 | 4125.7 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.89661 | acc=0.1370 | tpr=0.4115 | fpr=0.8681 | 7858.8 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.90674 | acc=0.1363 | tpr=0.4193 | fpr=0.8689 | 7934.6 samples/s | 31.0 steps/s
[Step= 200] | Loss=5.90061 | acc=0.1367 | tpr=0.4087 | fpr=0.8683 | 7771.1 samples/s | 30.4 steps/s
[Step= 250] | Loss=5.89965 | acc=0.1367 | tpr=0.4044 | fpr=0.8682 | 7921.0 samples/s | 30.9 steps/s
[Step= 300] | Loss=5.90791 | acc=0.1361 | tpr=0.4015 | fpr=0.8688 | 8428.8 samples/s | 32.9 steps/s
[Step= 350] | Loss=5.91803 | acc=0.1356 | tpr=0.3970 | fpr=0.8692 | 7435.7 samples/s | 29.0 steps/s
[Step= 400] | Loss=5.90920 | acc=0.1352 | tpr=0.3889 | fpr=0.8694 | 7970.1 samples/s | 31.1 steps/s
[Step= 450] | Loss=5.90980 | acc=0.1347 | tpr=0.3856 | fpr=0.8698 | 7529.6 samples/s | 29.4 steps/s
[Step= 500] | Loss=5.91165 | acc=0.1343 | tpr=0.3859 | fpr=0.8702 | 7895.7 samples/s | 30.8 steps/s
[Step= 550] | Loss=5.91493 | acc=0.1344 | tpr=0.3852 | fpr=0.8702 | 14595.2 samples/s | 57.0 steps/s
Avg test loss: 5.91523, Avg test acc: 0.13429, Avg tpr: 0.38550, Avg fpr: 0.87028, total FA: 120836

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13025 | acc=0.9793 | tpr=0.9336 | fpr=0.0199 | 4062.0 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.13858 | acc=0.9781 | tpr=0.9467 | fpr=0.0213 | 7784.5 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.14006 | acc=0.9779 | tpr=0.9496 | fpr=0.0216 | 7960.0 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.14146 | acc=0.9781 | tpr=0.9530 | fpr=0.0215 | 7872.6 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.14092 | acc=0.9781 | tpr=0.9528 | fpr=0.0214 | 8049.2 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.14374 | acc=0.9778 | tpr=0.9549 | fpr=0.0218 | 7811.1 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.14383 | acc=0.9778 | tpr=0.9549 | fpr=0.0218 | 7754.5 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.14534 | acc=0.9775 | tpr=0.9535 | fpr=0.0221 | 7996.6 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.14694 | acc=0.9773 | tpr=0.9518 | fpr=0.0222 | 7625.3 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.14591 | acc=0.9775 | tpr=0.9533 | fpr=0.0221 | 7670.0 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.14473 | acc=0.9777 | tpr=0.9550 | fpr=0.0219 | 14612.2 samples/s | 57.1 steps/s
Avg test loss: 0.14438, Avg test acc: 0.97775, Avg tpr: 0.95523, Avg fpr: 0.02184, total FA: 3033

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14823 | acc=0.9788 | tpr=0.9381 | fpr=0.0205 | 4073.4 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.15706 | acc=0.9778 | tpr=0.9552 | fpr=0.0218 | 7878.0 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.15811 | acc=0.9773 | tpr=0.9611 | fpr=0.0224 | 7765.9 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.15985 | acc=0.9774 | tpr=0.9628 | fpr=0.0224 | 7934.9 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.15910 | acc=0.9772 | tpr=0.9616 | fpr=0.0225 | 7681.4 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.16216 | acc=0.9768 | tpr=0.9622 | fpr=0.0229 | 7978.2 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.16219 | acc=0.9768 | tpr=0.9612 | fpr=0.0229 | 7877.9 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.16377 | acc=0.9765 | tpr=0.9595 | fpr=0.0232 | 7937.6 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.16546 | acc=0.9764 | tpr=0.9572 | fpr=0.0233 | 7677.8 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.16431 | acc=0.9765 | tpr=0.9586 | fpr=0.0232 | 7954.9 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.16309 | acc=0.9767 | tpr=0.9594 | fpr=0.0230 | 13930.9 samples/s | 54.4 steps/s
Avg test loss: 0.16274, Avg test acc: 0.97676, Avg tpr: 0.95959, Avg fpr: 0.02292, total FA: 3183

server round 33/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=66001 Epoch=128.7] | Loss=0.00123 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=18.327 | 5239.3 samples/s | 81.9 steps/s
[Step=66050 Epoch=128.8] | Loss=0.00629 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=18.334 | 4378.7 samples/s | 68.4 steps/s
[Step=66100 Epoch=128.9] | Loss=0.00593 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=18.340 | 5570.2 samples/s | 87.0 steps/s
[Step=66150 Epoch=129.0] | Loss=0.00614 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.841 | L2-Norm(final)=18.346 | 5533.1 samples/s | 86.5 steps/s
[Step=66200 Epoch=129.1] | Loss=0.00618 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=18.350 | 5476.6 samples/s | 85.6 steps/s
[Step=66250 Epoch=129.2] | Loss=0.00644 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=18.355 | 5558.5 samples/s | 86.9 steps/s
[Step=66300 Epoch=129.3] | Loss=0.00650 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=18.360 | 5510.7 samples/s | 86.1 steps/s
[Step=66350 Epoch=129.4] | Loss=0.00668 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.841 | L2-Norm(final)=18.365 | 5539.7 samples/s | 86.6 steps/s
[Step=66400 Epoch=129.5] | Loss=0.00669 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=18.370 | 5539.1 samples/s | 86.5 steps/s
[Step=66450 Epoch=129.6] | Loss=0.00694 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.841 | L2-Norm(final)=18.375 | 5612.3 samples/s | 87.7 steps/s
[Step=66500 Epoch=129.7] | Loss=0.00711 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=18.379 | 6941.8 samples/s | 108.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=66501 Epoch=129.7] | Loss=0.00318 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=18.420 | 4756.9 samples/s | 74.3 steps/s
[Step=66550 Epoch=129.8] | Loss=0.00650 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.849 | L2-Norm(final)=18.421 | 4331.5 samples/s | 67.7 steps/s
[Step=66600 Epoch=129.9] | Loss=0.00707 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=18.423 | 4761.5 samples/s | 74.4 steps/s
[Step=66650 Epoch=130.0] | Loss=0.00685 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.864 | L2-Norm(final)=18.425 | 4759.5 samples/s | 74.4 steps/s
[Step=66700 Epoch=130.1] | Loss=0.00722 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.870 | L2-Norm(final)=18.427 | 4859.2 samples/s | 75.9 steps/s
[Step=66750 Epoch=130.2] | Loss=0.00746 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.875 | L2-Norm(final)=18.428 | 4728.4 samples/s | 73.9 steps/s
[Step=66800 Epoch=130.3] | Loss=0.00761 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=18.430 | 4798.3 samples/s | 75.0 steps/s
[Step=66850 Epoch=130.4] | Loss=0.00784 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.885 | L2-Norm(final)=18.432 | 4798.3 samples/s | 75.0 steps/s
[Step=66900 Epoch=130.5] | Loss=0.00784 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.889 | L2-Norm(final)=18.434 | 4834.6 samples/s | 75.5 steps/s
[Step=66950 Epoch=130.6] | Loss=0.00773 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=18.436 | 4818.8 samples/s | 75.3 steps/s
[Step=67000 Epoch=130.7] | Loss=0.00748 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.897 | L2-Norm(final)=18.437 | 5825.0 samples/s | 91.0 steps/s
[Step=67050 Epoch=130.8] | Loss=0.00736 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.900 | L2-Norm(final)=18.439 | 1989.6 samples/s | 31.1 steps/s
[Step=67100 Epoch=130.9] | Loss=0.00718 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.904 | L2-Norm(final)=18.441 | 4751.9 samples/s | 74.2 steps/s
[Step=67150 Epoch=131.0] | Loss=0.00700 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.907 | L2-Norm(final)=18.443 | 4762.2 samples/s | 74.4 steps/s
[Step=67200 Epoch=131.1] | Loss=0.00699 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.910 | L2-Norm(final)=18.446 | 4770.0 samples/s | 74.5 steps/s
[Step=67250 Epoch=131.2] | Loss=0.00683 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.913 | L2-Norm(final)=18.447 | 4780.1 samples/s | 74.7 steps/s
[Step=67300 Epoch=131.3] | Loss=0.00675 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.916 | L2-Norm(final)=18.449 | 4822.2 samples/s | 75.3 steps/s
[Step=67350 Epoch=131.4] | Loss=0.00672 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.918 | L2-Norm(final)=18.451 | 4790.1 samples/s | 74.8 steps/s
[Step=67400 Epoch=131.5] | Loss=0.00669 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.921 | L2-Norm(final)=18.453 | 4768.5 samples/s | 74.5 steps/s
[Step=67450 Epoch=131.6] | Loss=0.00667 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.924 | L2-Norm(final)=18.455 | 4756.9 samples/s | 74.3 steps/s
[Step=67500 Epoch=131.7] | Loss=0.00665 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.926 | L2-Norm(final)=18.457 | 4804.3 samples/s | 75.1 steps/s
[Step=67550 Epoch=131.7] | Loss=0.00654 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.928 | L2-Norm(final)=18.458 | 2092.9 samples/s | 32.7 steps/s
[Step=67600 Epoch=131.8] | Loss=0.00642 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.930 | L2-Norm(final)=18.460 | 4774.7 samples/s | 74.6 steps/s
[Step=67650 Epoch=131.9] | Loss=0.00632 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=18.462 | 4748.2 samples/s | 74.2 steps/s
[Step=67700 Epoch=132.0] | Loss=0.00631 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.935 | L2-Norm(final)=18.464 | 4764.9 samples/s | 74.5 steps/s
[Step=67750 Epoch=132.1] | Loss=0.00622 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.937 | L2-Norm(final)=18.466 | 4831.5 samples/s | 75.5 steps/s
[Step=67800 Epoch=132.2] | Loss=0.00617 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.939 | L2-Norm(final)=18.467 | 4772.0 samples/s | 74.6 steps/s
[Step=67850 Epoch=132.3] | Loss=0.00614 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.940 | L2-Norm(final)=18.469 | 4817.2 samples/s | 75.3 steps/s
[Step=67900 Epoch=132.4] | Loss=0.00615 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.942 | L2-Norm(final)=18.471 | 4779.4 samples/s | 74.7 steps/s
[Step=67950 Epoch=132.5] | Loss=0.00611 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.944 | L2-Norm(final)=18.472 | 4783.2 samples/s | 74.7 steps/s
[Step=68000 Epoch=132.6] | Loss=0.00607 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.946 | L2-Norm(final)=18.474 | 4763.0 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step68000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=66001 Epoch=129.0] | Loss=0.00972 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.841 | L2-Norm(final)=18.488 | 4563.8 samples/s | 71.3 steps/s
[Step=66050 Epoch=129.1] | Loss=0.00733 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.841 | L2-Norm(final)=18.493 | 5058.9 samples/s | 79.0 steps/s
[Step=66100 Epoch=129.2] | Loss=0.00685 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=18.500 | 5538.7 samples/s | 86.5 steps/s
[Step=66150 Epoch=129.3] | Loss=0.00668 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=18.506 | 5285.2 samples/s | 82.6 steps/s
[Step=66200 Epoch=129.4] | Loss=0.00665 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=18.511 | 5489.8 samples/s | 85.8 steps/s
[Step=66250 Epoch=129.5] | Loss=0.00664 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=18.517 | 5540.8 samples/s | 86.6 steps/s
[Step=66300 Epoch=129.6] | Loss=0.00681 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.841 | L2-Norm(final)=18.523 | 5585.4 samples/s | 87.3 steps/s
[Step=66350 Epoch=129.7] | Loss=0.00699 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=18.528 | 5502.2 samples/s | 86.0 steps/s
[Step=66400 Epoch=129.8] | Loss=0.00684 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.841 | L2-Norm(final)=18.534 | 5584.6 samples/s | 87.3 steps/s
[Step=66450 Epoch=129.9] | Loss=0.00690 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.841 | L2-Norm(final)=18.539 | 5438.6 samples/s | 85.0 steps/s
[Step=66500 Epoch=130.0] | Loss=0.00686 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.841 | L2-Norm(final)=18.545 | 7027.0 samples/s | 109.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=66501 Epoch=130.0] | Loss=0.01144 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=18.599 | 4463.4 samples/s | 69.7 steps/s
[Step=66550 Epoch=130.1] | Loss=0.00678 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.852 | L2-Norm(final)=18.600 | 4747.9 samples/s | 74.2 steps/s
[Step=66600 Epoch=130.2] | Loss=0.00749 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.861 | L2-Norm(final)=18.601 | 4699.7 samples/s | 73.4 steps/s
[Step=66650 Epoch=130.3] | Loss=0.00730 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.868 | L2-Norm(final)=18.602 | 4773.2 samples/s | 74.6 steps/s
[Step=66700 Epoch=130.4] | Loss=0.00747 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.873 | L2-Norm(final)=18.604 | 4718.2 samples/s | 73.7 steps/s
[Step=66750 Epoch=130.5] | Loss=0.00760 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.878 | L2-Norm(final)=18.606 | 4751.3 samples/s | 74.2 steps/s
[Step=66800 Epoch=130.6] | Loss=0.00766 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.883 | L2-Norm(final)=18.608 | 4782.6 samples/s | 74.7 steps/s
[Step=66850 Epoch=130.7] | Loss=0.00774 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.887 | L2-Norm(final)=18.610 | 4770.4 samples/s | 74.5 steps/s
[Step=66900 Epoch=130.8] | Loss=0.00761 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.891 | L2-Norm(final)=18.611 | 4750.8 samples/s | 74.2 steps/s
[Step=66950 Epoch=130.9] | Loss=0.00741 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.895 | L2-Norm(final)=18.613 | 4823.8 samples/s | 75.4 steps/s
[Step=67000 Epoch=131.0] | Loss=0.00718 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.898 | L2-Norm(final)=18.615 | 5834.0 samples/s | 91.2 steps/s
[Step=67050 Epoch=131.1] | Loss=0.00721 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.902 | L2-Norm(final)=18.617 | 2086.9 samples/s | 32.6 steps/s
[Step=67100 Epoch=131.2] | Loss=0.00704 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.905 | L2-Norm(final)=18.619 | 4781.4 samples/s | 74.7 steps/s
[Step=67150 Epoch=131.3] | Loss=0.00685 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.908 | L2-Norm(final)=18.621 | 4768.8 samples/s | 74.5 steps/s
[Step=67200 Epoch=131.4] | Loss=0.00672 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.910 | L2-Norm(final)=18.622 | 4758.6 samples/s | 74.4 steps/s
[Step=67250 Epoch=131.5] | Loss=0.00671 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.913 | L2-Norm(final)=18.624 | 4783.4 samples/s | 74.7 steps/s
[Step=67300 Epoch=131.6] | Loss=0.00657 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.915 | L2-Norm(final)=18.626 | 4765.9 samples/s | 74.5 steps/s
[Step=67350 Epoch=131.7] | Loss=0.00658 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.918 | L2-Norm(final)=18.628 | 4797.6 samples/s | 75.0 steps/s
[Step=67400 Epoch=131.8] | Loss=0.00653 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.920 | L2-Norm(final)=18.629 | 4764.0 samples/s | 74.4 steps/s
[Step=67450 Epoch=131.9] | Loss=0.00648 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.922 | L2-Norm(final)=18.631 | 4817.4 samples/s | 75.3 steps/s
[Step=67500 Epoch=132.0] | Loss=0.00638 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.925 | L2-Norm(final)=18.633 | 5124.9 samples/s | 80.1 steps/s
[Step=67550 Epoch=132.1] | Loss=0.00626 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.927 | L2-Norm(final)=18.634 | 2184.9 samples/s | 34.1 steps/s
[Step=67600 Epoch=132.2] | Loss=0.00622 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.929 | L2-Norm(final)=18.636 | 4778.6 samples/s | 74.7 steps/s
[Step=67650 Epoch=132.3] | Loss=0.00616 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.931 | L2-Norm(final)=18.638 | 4755.0 samples/s | 74.3 steps/s
[Step=67700 Epoch=132.4] | Loss=0.00609 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.933 | L2-Norm(final)=18.640 | 4756.5 samples/s | 74.3 steps/s
[Step=67750 Epoch=132.4] | Loss=0.00602 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.935 | L2-Norm(final)=18.641 | 4774.1 samples/s | 74.6 steps/s
[Step=67800 Epoch=132.5] | Loss=0.00596 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.937 | L2-Norm(final)=18.643 | 4842.2 samples/s | 75.7 steps/s
[Step=67850 Epoch=132.6] | Loss=0.00592 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.939 | L2-Norm(final)=18.645 | 4731.2 samples/s | 73.9 steps/s
[Step=67900 Epoch=132.7] | Loss=0.00587 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.940 | L2-Norm(final)=18.646 | 4843.3 samples/s | 75.7 steps/s
[Step=67950 Epoch=132.8] | Loss=0.00589 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.942 | L2-Norm(final)=18.648 | 4738.0 samples/s | 74.0 steps/s
[Step=68000 Epoch=132.9] | Loss=0.00584 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.944 | L2-Norm(final)=18.649 | 4797.8 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step68000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=66001 Epoch=252.9] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=17.077 | 4446.6 samples/s | 69.5 steps/s
[Step=66050 Epoch=253.1] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.835 | L2-Norm(final)=17.081 | 4969.8 samples/s | 77.7 steps/s
[Step=66100 Epoch=253.3] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.835 | L2-Norm(final)=17.086 | 5039.8 samples/s | 78.7 steps/s
[Step=66150 Epoch=253.5] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=17.090 | 5193.6 samples/s | 81.1 steps/s
[Step=66200 Epoch=253.7] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=17.094 | 5285.8 samples/s | 82.6 steps/s
[Step=66250 Epoch=253.8] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=17.098 | 6721.3 samples/s | 105.0 steps/s
[Step=66300 Epoch=254.0] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=17.102 | 2150.1 samples/s | 33.6 steps/s
[Step=66350 Epoch=254.2] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=17.106 | 5233.1 samples/s | 81.8 steps/s
[Step=66400 Epoch=254.4] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=17.110 | 5071.6 samples/s | 79.2 steps/s
[Step=66450 Epoch=254.6] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=17.115 | 5247.6 samples/s | 82.0 steps/s
[Step=66500 Epoch=254.8] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=17.119 | 5779.4 samples/s | 90.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=66501 Epoch=254.8] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=17.160 | 4561.0 samples/s | 71.3 steps/s
[Step=66550 Epoch=255.0] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.819 | L2-Norm(final)=17.162 | 4212.8 samples/s | 65.8 steps/s
[Step=66600 Epoch=255.2] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.795 | L2-Norm(final)=17.163 | 4513.0 samples/s | 70.5 steps/s
[Step=66650 Epoch=255.4] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.768 | L2-Norm(final)=17.164 | 4613.6 samples/s | 72.1 steps/s
[Step=66700 Epoch=255.6] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.742 | L2-Norm(final)=17.164 | 4442.7 samples/s | 69.4 steps/s
[Step=66750 Epoch=255.8] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.715 | L2-Norm(final)=17.165 | 5677.7 samples/s | 88.7 steps/s
[Step=66800 Epoch=256.0] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.688 | L2-Norm(final)=17.166 | 2006.8 samples/s | 31.4 steps/s
[Step=66850 Epoch=256.1] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.661 | L2-Norm(final)=17.167 | 4503.8 samples/s | 70.4 steps/s
[Step=66900 Epoch=256.3] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.635 | L2-Norm(final)=17.168 | 4598.5 samples/s | 71.9 steps/s
[Step=66950 Epoch=256.5] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.608 | L2-Norm(final)=17.169 | 4478.6 samples/s | 70.0 steps/s
[Step=67000 Epoch=256.7] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.581 | L2-Norm(final)=17.169 | 4975.4 samples/s | 77.7 steps/s
[Step=67050 Epoch=256.9] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.554 | L2-Norm(final)=17.170 | 2120.5 samples/s | 33.1 steps/s
[Step=67100 Epoch=257.1] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.526 | L2-Norm(final)=17.171 | 4478.0 samples/s | 70.0 steps/s
[Step=67150 Epoch=257.3] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.499 | L2-Norm(final)=17.172 | 4559.6 samples/s | 71.2 steps/s
[Step=67200 Epoch=257.5] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=17.173 | 4553.1 samples/s | 71.1 steps/s
[Step=67250 Epoch=257.7] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.444 | L2-Norm(final)=17.174 | 4537.1 samples/s | 70.9 steps/s
[Step=67300 Epoch=257.9] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.417 | L2-Norm(final)=17.175 | 2191.1 samples/s | 34.2 steps/s
[Step=67350 Epoch=258.1] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=17.176 | 4603.1 samples/s | 71.9 steps/s
[Step=67400 Epoch=258.3] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.361 | L2-Norm(final)=17.177 | 4537.7 samples/s | 70.9 steps/s
[Step=67450 Epoch=258.4] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.333 | L2-Norm(final)=17.178 | 4531.8 samples/s | 70.8 steps/s
[Step=67500 Epoch=258.6] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.306 | L2-Norm(final)=17.179 | 4524.2 samples/s | 70.7 steps/s
[Step=67550 Epoch=258.8] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.277 | L2-Norm(final)=17.180 | 2210.1 samples/s | 34.5 steps/s
[Step=67600 Epoch=259.0] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.249 | L2-Norm(final)=17.181 | 4543.4 samples/s | 71.0 steps/s
[Step=67650 Epoch=259.2] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.221 | L2-Norm(final)=17.183 | 4561.5 samples/s | 71.3 steps/s
[Step=67700 Epoch=259.4] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.192 | L2-Norm(final)=17.184 | 4553.0 samples/s | 71.1 steps/s
[Step=67750 Epoch=259.6] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.163 | L2-Norm(final)=17.186 | 4627.2 samples/s | 72.3 steps/s
[Step=67800 Epoch=259.8] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=17.187 | 6107.0 samples/s | 95.4 steps/s
[Step=67850 Epoch=260.0] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.106 | L2-Norm(final)=17.189 | 1947.9 samples/s | 30.4 steps/s
[Step=67900 Epoch=260.2] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.077 | L2-Norm(final)=17.191 | 4516.7 samples/s | 70.6 steps/s
[Step=67950 Epoch=260.4] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.048 | L2-Norm(final)=17.192 | 4572.2 samples/s | 71.4 steps/s
[Step=68000 Epoch=260.6] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.018 | L2-Norm(final)=17.194 | 4516.4 samples/s | 70.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step68000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=66001 Epoch=254.1] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=17.985 | 4324.0 samples/s | 67.6 steps/s
[Step=66050 Epoch=254.3] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.836 | L2-Norm(final)=17.988 | 5085.2 samples/s | 79.5 steps/s
[Step=66100 Epoch=254.4] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.836 | L2-Norm(final)=17.993 | 5220.0 samples/s | 81.6 steps/s
[Step=66150 Epoch=254.6] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.836 | L2-Norm(final)=17.997 | 5241.8 samples/s | 81.9 steps/s
[Step=66200 Epoch=254.8] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.836 | L2-Norm(final)=18.002 | 5142.5 samples/s | 80.4 steps/s
[Step=66250 Epoch=255.0] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.836 | L2-Norm(final)=18.007 | 6896.0 samples/s | 107.7 steps/s
[Step=66300 Epoch=255.2] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.835 | L2-Norm(final)=18.012 | 2118.3 samples/s | 33.1 steps/s
[Step=66350 Epoch=255.4] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.835 | L2-Norm(final)=18.017 | 5144.3 samples/s | 80.4 steps/s
[Step=66400 Epoch=255.6] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.835 | L2-Norm(final)=18.022 | 5205.2 samples/s | 81.3 steps/s
[Step=66450 Epoch=255.8] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.835 | L2-Norm(final)=18.026 | 5115.3 samples/s | 79.9 steps/s
[Step=66500 Epoch=256.0] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.835 | L2-Norm(final)=18.031 | 5969.6 samples/s | 93.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=66501 Epoch=256.0] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.835 | L2-Norm(final)=18.072 | 4486.5 samples/s | 70.1 steps/s
[Step=66550 Epoch=256.2] | Loss=0.00024 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.833 | L2-Norm(final)=18.074 | 4323.5 samples/s | 67.6 steps/s
[Step=66600 Epoch=256.4] | Loss=0.00026 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.843 | L2-Norm(final)=18.073 | 4496.4 samples/s | 70.3 steps/s
[Step=66650 Epoch=256.6] | Loss=0.00019 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.849 | L2-Norm(final)=18.073 | 4540.7 samples/s | 70.9 steps/s
[Step=66700 Epoch=256.8] | Loss=0.00014 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.851 | L2-Norm(final)=18.073 | 4486.6 samples/s | 70.1 steps/s
[Step=66750 Epoch=256.9] | Loss=0.00012 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.851 | L2-Norm(final)=18.073 | 5759.0 samples/s | 90.0 steps/s
[Step=66800 Epoch=257.1] | Loss=0.00010 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.851 | L2-Norm(final)=18.073 | 2004.8 samples/s | 31.3 steps/s
[Step=66850 Epoch=257.3] | Loss=0.00009 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.850 | L2-Norm(final)=18.074 | 4561.7 samples/s | 71.3 steps/s
[Step=66900 Epoch=257.5] | Loss=0.00008 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.848 | L2-Norm(final)=18.074 | 4513.1 samples/s | 70.5 steps/s
[Step=66950 Epoch=257.7] | Loss=0.00007 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.846 | L2-Norm(final)=18.075 | 4530.6 samples/s | 70.8 steps/s
[Step=67000 Epoch=257.9] | Loss=0.00006 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.844 | L2-Norm(final)=18.075 | 5171.7 samples/s | 80.8 steps/s
[Step=67050 Epoch=258.1] | Loss=0.00006 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.842 | L2-Norm(final)=18.075 | 2096.1 samples/s | 32.8 steps/s
[Step=67100 Epoch=258.3] | Loss=0.00005 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.839 | L2-Norm(final)=18.076 | 4508.8 samples/s | 70.4 steps/s
[Step=67150 Epoch=258.5] | Loss=0.00005 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.837 | L2-Norm(final)=18.076 | 4556.2 samples/s | 71.2 steps/s
[Step=67200 Epoch=258.7] | Loss=0.00005 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=18.076 | 4551.1 samples/s | 71.1 steps/s
[Step=67250 Epoch=258.9] | Loss=0.00004 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.831 | L2-Norm(final)=18.076 | 4591.6 samples/s | 71.7 steps/s
[Step=67300 Epoch=259.1] | Loss=0.00004 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.828 | L2-Norm(final)=18.077 | 2175.3 samples/s | 34.0 steps/s
[Step=67350 Epoch=259.3] | Loss=0.00004 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.825 | L2-Norm(final)=18.077 | 4670.8 samples/s | 73.0 steps/s
[Step=67400 Epoch=259.4] | Loss=0.00004 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.822 | L2-Norm(final)=18.077 | 4585.0 samples/s | 71.6 steps/s
[Step=67450 Epoch=259.6] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.819 | L2-Norm(final)=18.077 | 4533.5 samples/s | 70.8 steps/s
[Step=67500 Epoch=259.8] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.816 | L2-Norm(final)=18.078 | 4593.3 samples/s | 71.8 steps/s
[Step=67550 Epoch=260.0] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.813 | L2-Norm(final)=18.078 | 2205.3 samples/s | 34.5 steps/s
[Step=67600 Epoch=260.2] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.809 | L2-Norm(final)=18.078 | 4541.4 samples/s | 71.0 steps/s
[Step=67650 Epoch=260.4] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.806 | L2-Norm(final)=18.078 | 4582.9 samples/s | 71.6 steps/s
[Step=67700 Epoch=260.6] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.803 | L2-Norm(final)=18.078 | 4498.5 samples/s | 70.3 steps/s
[Step=67750 Epoch=260.8] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.799 | L2-Norm(final)=18.079 | 4541.3 samples/s | 71.0 steps/s
[Step=67800 Epoch=261.0] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.796 | L2-Norm(final)=18.079 | 6656.1 samples/s | 104.0 steps/s
[Step=67850 Epoch=261.2] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.792 | L2-Norm(final)=18.079 | 1928.7 samples/s | 30.1 steps/s
[Step=67900 Epoch=261.4] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.789 | L2-Norm(final)=18.079 | 4509.8 samples/s | 70.5 steps/s
[Step=67950 Epoch=261.6] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.785 | L2-Norm(final)=18.079 | 4628.9 samples/s | 72.3 steps/s
[Step=68000 Epoch=261.8] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.781 | L2-Norm(final)=18.080 | 4534.1 samples/s | 70.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step68000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07964 | acc=0.9692 | tpr=0.9755 | fpr=0.0444 | 4144.4 samples/s | 16.2 steps/s
Avg test loss: 0.07880, Avg test acc: 0.96887, Avg tpr: 0.97540, Avg fpr: 0.04551, total FA: 355

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07576 | acc=0.9685 | tpr=0.9732 | fpr=0.0416 | 4238.9 samples/s | 16.6 steps/s
Avg test loss: 0.07504, Avg test acc: 0.96859, Avg tpr: 0.97406, Avg fpr: 0.04346, total FA: 339

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.34668 | acc=0.3045 | tpr=0.0062 | fpr=0.0476 | 4187.9 samples/s | 16.4 steps/s
Avg test loss: 6.35643, Avg test acc: 0.30050, Avg tpr: 0.00577, Avg fpr: 0.05128, total FA: 400

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.05338 | acc=0.2957 | tpr=0.0080 | fpr=0.0795 | 4134.2 samples/s | 16.1 steps/s
Avg test loss: 7.06658, Avg test acc: 0.29297, Avg tpr: 0.00810, Avg fpr: 0.08050, total FA: 628

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.83018 | acc=0.1337 | tpr=0.4292 | fpr=0.8716 | 4161.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=5.76766 | acc=0.1351 | tpr=0.4264 | fpr=0.8703 | 7826.1 samples/s | 30.6 steps/s
[Step= 150] | Loss=5.77310 | acc=0.1345 | tpr=0.4323 | fpr=0.8710 | 8190.7 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.76814 | acc=0.1351 | tpr=0.4273 | fpr=0.8702 | 7766.5 samples/s | 30.3 steps/s
[Step= 250] | Loss=5.76705 | acc=0.1348 | tpr=0.4175 | fpr=0.8704 | 7831.7 samples/s | 30.6 steps/s
[Step= 300] | Loss=5.77324 | acc=0.1336 | tpr=0.4073 | fpr=0.8714 | 7800.3 samples/s | 30.5 steps/s
[Step= 350] | Loss=5.78191 | acc=0.1334 | tpr=0.4058 | fpr=0.8716 | 8007.9 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.77373 | acc=0.1331 | tpr=0.3961 | fpr=0.8717 | 8005.9 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.77576 | acc=0.1325 | tpr=0.3934 | fpr=0.8722 | 7624.8 samples/s | 29.8 steps/s
[Step= 500] | Loss=5.77849 | acc=0.1323 | tpr=0.3982 | fpr=0.8725 | 7896.5 samples/s | 30.8 steps/s
[Step= 550] | Loss=5.78036 | acc=0.1323 | tpr=0.3963 | fpr=0.8725 | 14216.2 samples/s | 55.5 steps/s
Avg test loss: 5.78091, Avg test acc: 0.13220, Avg tpr: 0.39659, Avg fpr: 0.87261, total FA: 121160

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.20186 | acc=0.1503 | tpr=0.3894 | fpr=0.8540 | 4191.8 samples/s | 16.4 steps/s
[Step= 100] | Loss=5.14671 | acc=0.1519 | tpr=0.3966 | fpr=0.8527 | 7868.2 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.15446 | acc=0.1518 | tpr=0.4121 | fpr=0.8530 | 7910.2 samples/s | 30.9 steps/s
[Step= 200] | Loss=5.14974 | acc=0.1522 | tpr=0.4066 | fpr=0.8524 | 7959.3 samples/s | 31.1 steps/s
[Step= 250] | Loss=5.14808 | acc=0.1524 | tpr=0.4026 | fpr=0.8522 | 7729.5 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.15379 | acc=0.1516 | tpr=0.3978 | fpr=0.8529 | 7978.3 samples/s | 31.2 steps/s
[Step= 350] | Loss=5.16359 | acc=0.1510 | tpr=0.3970 | fpr=0.8535 | 7968.6 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.15596 | acc=0.1506 | tpr=0.3873 | fpr=0.8537 | 7798.3 samples/s | 30.5 steps/s
[Step= 450] | Loss=5.15575 | acc=0.1503 | tpr=0.3856 | fpr=0.8540 | 7664.6 samples/s | 29.9 steps/s
[Step= 500] | Loss=5.15805 | acc=0.1503 | tpr=0.3885 | fpr=0.8540 | 7898.2 samples/s | 30.9 steps/s
[Step= 550] | Loss=5.16067 | acc=0.1503 | tpr=0.3868 | fpr=0.8540 | 14524.1 samples/s | 56.7 steps/s
Avg test loss: 5.16098, Avg test acc: 0.15019, Avg tpr: 0.38629, Avg fpr: 0.85411, total FA: 118591

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12362 | acc=0.9786 | tpr=0.9425 | fpr=0.0208 | 4172.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.13158 | acc=0.9775 | tpr=0.9552 | fpr=0.0221 | 8016.7 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.13392 | acc=0.9771 | tpr=0.9539 | fpr=0.0225 | 7685.1 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.13541 | acc=0.9773 | tpr=0.9563 | fpr=0.0223 | 7949.2 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.13489 | acc=0.9773 | tpr=0.9572 | fpr=0.0224 | 7884.9 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.13725 | acc=0.9770 | tpr=0.9585 | fpr=0.0226 | 7909.1 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.13721 | acc=0.9772 | tpr=0.9593 | fpr=0.0225 | 7820.2 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.13855 | acc=0.9768 | tpr=0.9573 | fpr=0.0228 | 7871.9 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.14025 | acc=0.9767 | tpr=0.9557 | fpr=0.0229 | 8053.1 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.13933 | acc=0.9768 | tpr=0.9573 | fpr=0.0228 | 7683.1 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.13824 | acc=0.9771 | tpr=0.9586 | fpr=0.0226 | 14336.6 samples/s | 56.0 steps/s
Avg test loss: 0.13791, Avg test acc: 0.97712, Avg tpr: 0.95880, Avg fpr: 0.02254, total FA: 3130

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16975 | acc=0.9786 | tpr=0.9425 | fpr=0.0208 | 4186.5 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.17988 | acc=0.9777 | tpr=0.9510 | fpr=0.0218 | 7712.0 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.18167 | acc=0.9771 | tpr=0.9582 | fpr=0.0225 | 7999.8 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.18373 | acc=0.9771 | tpr=0.9607 | fpr=0.0226 | 7766.0 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.18389 | acc=0.9769 | tpr=0.9590 | fpr=0.0228 | 7825.0 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.18804 | acc=0.9765 | tpr=0.9585 | fpr=0.0232 | 7971.9 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.18743 | acc=0.9765 | tpr=0.9587 | fpr=0.0232 | 8339.4 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.18918 | acc=0.9761 | tpr=0.9579 | fpr=0.0235 | 7550.1 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.19159 | acc=0.9759 | tpr=0.9552 | fpr=0.0237 | 8153.0 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.19062 | acc=0.9761 | tpr=0.9564 | fpr=0.0235 | 7383.1 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.18883 | acc=0.9763 | tpr=0.9566 | fpr=0.0233 | 15020.0 samples/s | 58.7 steps/s
Avg test loss: 0.18842, Avg test acc: 0.97636, Avg tpr: 0.95681, Avg fpr: 0.02328, total FA: 3233

server round 34/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=68001 Epoch=132.6] | Loss=0.00850 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.397 | L2-Norm(final)=18.523 | 4417.3 samples/s | 69.0 steps/s
[Step=68050 Epoch=132.7] | Loss=0.00872 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.398 | L2-Norm(final)=18.528 | 5416.3 samples/s | 84.6 steps/s
[Step=68100 Epoch=132.8] | Loss=0.00973 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.536 | 5473.0 samples/s | 85.5 steps/s
[Step=68150 Epoch=132.9] | Loss=0.00929 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.544 | 5571.1 samples/s | 87.0 steps/s
[Step=68200 Epoch=133.0] | Loss=0.00894 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.551 | 5453.6 samples/s | 85.2 steps/s
[Step=68250 Epoch=133.1] | Loss=0.00894 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.398 | L2-Norm(final)=18.559 | 5531.1 samples/s | 86.4 steps/s
[Step=68300 Epoch=133.2] | Loss=0.00876 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.567 | 5500.3 samples/s | 85.9 steps/s
[Step=68350 Epoch=133.3] | Loss=0.00866 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.574 | 5610.5 samples/s | 87.7 steps/s
[Step=68400 Epoch=133.4] | Loss=0.00845 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.582 | 5410.7 samples/s | 84.5 steps/s
[Step=68450 Epoch=133.5] | Loss=0.00843 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.398 | L2-Norm(final)=18.590 | 5614.6 samples/s | 87.7 steps/s
[Step=68500 Epoch=133.6] | Loss=0.00842 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.398 | L2-Norm(final)=18.598 | 6894.6 samples/s | 107.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=68501 Epoch=133.6] | Loss=0.00619 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.673 | 4709.2 samples/s | 73.6 steps/s
[Step=68550 Epoch=133.7] | Loss=0.00796 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.410 | L2-Norm(final)=18.679 | 4784.2 samples/s | 74.8 steps/s
[Step=68600 Epoch=133.8] | Loss=0.00911 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.422 | L2-Norm(final)=18.684 | 4752.6 samples/s | 74.3 steps/s
[Step=68650 Epoch=133.9] | Loss=0.01026 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.432 | L2-Norm(final)=18.686 | 4770.3 samples/s | 74.5 steps/s
[Step=68700 Epoch=134.0] | Loss=0.00987 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.441 | L2-Norm(final)=18.688 | 4792.9 samples/s | 74.9 steps/s
[Step=68750 Epoch=134.1] | Loss=0.00995 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.448 | L2-Norm(final)=18.690 | 4825.9 samples/s | 75.4 steps/s
[Step=68800 Epoch=134.2] | Loss=0.00982 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.455 | L2-Norm(final)=18.692 | 4808.5 samples/s | 75.1 steps/s
[Step=68850 Epoch=134.3] | Loss=0.00973 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.461 | L2-Norm(final)=18.695 | 4839.8 samples/s | 75.6 steps/s
[Step=68900 Epoch=134.4] | Loss=0.00959 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.467 | L2-Norm(final)=18.697 | 4879.8 samples/s | 76.2 steps/s
[Step=68950 Epoch=134.5] | Loss=0.00930 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=18.700 | 4716.0 samples/s | 73.7 steps/s
[Step=69000 Epoch=134.6] | Loss=0.00916 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.477 | L2-Norm(final)=18.702 | 5889.3 samples/s | 92.0 steps/s
[Step=69050 Epoch=134.7] | Loss=0.00889 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.482 | L2-Norm(final)=18.705 | 1994.2 samples/s | 31.2 steps/s
[Step=69100 Epoch=134.8] | Loss=0.00870 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.486 | L2-Norm(final)=18.707 | 4780.0 samples/s | 74.7 steps/s
[Step=69150 Epoch=134.9] | Loss=0.00852 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.490 | L2-Norm(final)=18.709 | 4766.3 samples/s | 74.5 steps/s
[Step=69200 Epoch=135.0] | Loss=0.00824 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.494 | L2-Norm(final)=18.712 | 4789.7 samples/s | 74.8 steps/s
[Step=69250 Epoch=135.1] | Loss=0.00801 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=18.714 | 4783.4 samples/s | 74.7 steps/s
[Step=69300 Epoch=135.2] | Loss=0.00794 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.501 | L2-Norm(final)=18.717 | 4856.3 samples/s | 75.9 steps/s
[Step=69350 Epoch=135.3] | Loss=0.00777 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.504 | L2-Norm(final)=18.719 | 4765.7 samples/s | 74.5 steps/s
[Step=69400 Epoch=135.4] | Loss=0.00782 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.507 | L2-Norm(final)=18.721 | 4797.8 samples/s | 75.0 steps/s
[Step=69450 Epoch=135.5] | Loss=0.00771 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.510 | L2-Norm(final)=18.723 | 4861.0 samples/s | 76.0 steps/s
[Step=69500 Epoch=135.6] | Loss=0.00758 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.513 | L2-Norm(final)=18.726 | 5023.4 samples/s | 78.5 steps/s
[Step=69550 Epoch=135.6] | Loss=0.00747 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.515 | L2-Norm(final)=18.728 | 2090.5 samples/s | 32.7 steps/s
[Step=69600 Epoch=135.7] | Loss=0.00742 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.518 | L2-Norm(final)=18.730 | 4836.8 samples/s | 75.6 steps/s
[Step=69650 Epoch=135.8] | Loss=0.00730 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.521 | L2-Norm(final)=18.732 | 4785.8 samples/s | 74.8 steps/s
[Step=69700 Epoch=135.9] | Loss=0.00719 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.523 | L2-Norm(final)=18.735 | 4862.0 samples/s | 76.0 steps/s
[Step=69750 Epoch=136.0] | Loss=0.00715 | Reg=0.00111 | acc=0.9531 | L2-Norm=10.526 | L2-Norm(final)=18.737 | 4720.6 samples/s | 73.8 steps/s
[Step=69800 Epoch=136.1] | Loss=0.00713 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.528 | L2-Norm(final)=18.739 | 4788.9 samples/s | 74.8 steps/s
[Step=69850 Epoch=136.2] | Loss=0.00708 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.530 | L2-Norm(final)=18.741 | 4804.0 samples/s | 75.1 steps/s
[Step=69900 Epoch=136.3] | Loss=0.00703 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.533 | L2-Norm(final)=18.743 | 4799.0 samples/s | 75.0 steps/s
[Step=69950 Epoch=136.4] | Loss=0.00693 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.535 | L2-Norm(final)=18.744 | 4795.0 samples/s | 74.9 steps/s
[Step=70000 Epoch=136.5] | Loss=0.00684 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.537 | L2-Norm(final)=18.746 | 4818.0 samples/s | 75.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step70000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=68001 Epoch=132.9] | Loss=0.02626 | Reg=0.00108 | acc=0.9531 | L2-Norm=10.397 | L2-Norm(final)=18.693 | 4654.0 samples/s | 72.7 steps/s
[Step=68050 Epoch=133.0] | Loss=0.00951 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.695 | 5206.6 samples/s | 81.4 steps/s
[Step=68100 Epoch=133.1] | Loss=0.00982 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.699 | 5281.5 samples/s | 82.5 steps/s
[Step=68150 Epoch=133.2] | Loss=0.00904 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.703 | 5528.1 samples/s | 86.4 steps/s
[Step=68200 Epoch=133.3] | Loss=0.00858 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.708 | 5529.1 samples/s | 86.4 steps/s
[Step=68250 Epoch=133.4] | Loss=0.00883 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.712 | 5582.8 samples/s | 87.2 steps/s
[Step=68300 Epoch=133.5] | Loss=0.00864 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.717 | 5502.1 samples/s | 86.0 steps/s
[Step=68350 Epoch=133.6] | Loss=0.00840 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.722 | 5482.5 samples/s | 85.7 steps/s
[Step=68400 Epoch=133.7] | Loss=0.00871 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.398 | L2-Norm(final)=18.726 | 5477.3 samples/s | 85.6 steps/s
[Step=68450 Epoch=133.8] | Loss=0.00875 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.731 | 5636.6 samples/s | 88.1 steps/s
[Step=68500 Epoch=133.9] | Loss=0.00869 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.736 | 6888.4 samples/s | 107.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=68501 Epoch=133.9] | Loss=0.00154 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.783 | 4428.3 samples/s | 69.2 steps/s
[Step=68550 Epoch=134.0] | Loss=0.00976 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.408 | L2-Norm(final)=18.786 | 4768.4 samples/s | 74.5 steps/s
[Step=68600 Epoch=134.1] | Loss=0.00961 | Reg=0.00109 | acc=0.9688 | L2-Norm=10.420 | L2-Norm(final)=18.788 | 4765.2 samples/s | 74.5 steps/s
[Step=68650 Epoch=134.2] | Loss=0.00966 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.429 | L2-Norm(final)=18.789 | 4804.9 samples/s | 75.1 steps/s
[Step=68700 Epoch=134.3] | Loss=0.00910 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.436 | L2-Norm(final)=18.792 | 4726.4 samples/s | 73.9 steps/s
[Step=68750 Epoch=134.4] | Loss=0.00865 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.442 | L2-Norm(final)=18.794 | 4757.8 samples/s | 74.3 steps/s
[Step=68800 Epoch=134.5] | Loss=0.00817 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.448 | L2-Norm(final)=18.797 | 4653.0 samples/s | 72.7 steps/s
[Step=68850 Epoch=134.6] | Loss=0.00840 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.454 | L2-Norm(final)=18.800 | 4703.5 samples/s | 73.5 steps/s
[Step=68900 Epoch=134.7] | Loss=0.00843 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.459 | L2-Norm(final)=18.802 | 4799.7 samples/s | 75.0 steps/s
[Step=68950 Epoch=134.8] | Loss=0.00827 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.464 | L2-Norm(final)=18.804 | 4775.3 samples/s | 74.6 steps/s
[Step=69000 Epoch=134.9] | Loss=0.00842 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.468 | L2-Norm(final)=18.806 | 5852.8 samples/s | 91.4 steps/s
[Step=69050 Epoch=135.0] | Loss=0.00814 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=18.808 | 2081.5 samples/s | 32.5 steps/s
[Step=69100 Epoch=135.1] | Loss=0.00792 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.476 | L2-Norm(final)=18.810 | 4748.7 samples/s | 74.2 steps/s
[Step=69150 Epoch=135.2] | Loss=0.00788 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.480 | L2-Norm(final)=18.812 | 4757.1 samples/s | 74.3 steps/s
[Step=69200 Epoch=135.3] | Loss=0.00776 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.483 | L2-Norm(final)=18.814 | 4730.9 samples/s | 73.9 steps/s
[Step=69250 Epoch=135.4] | Loss=0.00750 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=18.816 | 4755.3 samples/s | 74.3 steps/s
[Step=69300 Epoch=135.5] | Loss=0.00748 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.490 | L2-Norm(final)=18.818 | 4773.7 samples/s | 74.6 steps/s
[Step=69350 Epoch=135.6] | Loss=0.00732 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.493 | L2-Norm(final)=18.820 | 4763.5 samples/s | 74.4 steps/s
[Step=69400 Epoch=135.7] | Loss=0.00726 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.496 | L2-Norm(final)=18.822 | 4798.6 samples/s | 75.0 steps/s
[Step=69450 Epoch=135.8] | Loss=0.00725 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.499 | L2-Norm(final)=18.823 | 4795.2 samples/s | 74.9 steps/s
[Step=69500 Epoch=135.9] | Loss=0.00716 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.501 | L2-Norm(final)=18.825 | 5140.5 samples/s | 80.3 steps/s
[Step=69550 Epoch=136.0] | Loss=0.00707 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.504 | L2-Norm(final)=18.827 | 2198.8 samples/s | 34.4 steps/s
[Step=69600 Epoch=136.1] | Loss=0.00694 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.507 | L2-Norm(final)=18.829 | 4798.4 samples/s | 75.0 steps/s
[Step=69650 Epoch=136.2] | Loss=0.00684 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.509 | L2-Norm(final)=18.830 | 4766.5 samples/s | 74.5 steps/s
[Step=69700 Epoch=136.3] | Loss=0.00680 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.512 | L2-Norm(final)=18.832 | 4841.5 samples/s | 75.6 steps/s
[Step=69750 Epoch=136.4] | Loss=0.00681 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.514 | L2-Norm(final)=18.834 | 4777.6 samples/s | 74.6 steps/s
[Step=69800 Epoch=136.5] | Loss=0.00678 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.516 | L2-Norm(final)=18.836 | 4820.0 samples/s | 75.3 steps/s
[Step=69850 Epoch=136.6] | Loss=0.00668 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.519 | L2-Norm(final)=18.838 | 4787.2 samples/s | 74.8 steps/s
[Step=69900 Epoch=136.7] | Loss=0.00660 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.521 | L2-Norm(final)=18.839 | 4780.2 samples/s | 74.7 steps/s
[Step=69950 Epoch=136.8] | Loss=0.00648 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.523 | L2-Norm(final)=18.841 | 4761.6 samples/s | 74.4 steps/s
[Step=70000 Epoch=136.8] | Loss=0.00642 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.525 | L2-Norm(final)=18.843 | 4753.6 samples/s | 74.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step70000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=68001 Epoch=260.6] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.397 | L2-Norm(final)=17.250 | 4143.7 samples/s | 64.7 steps/s
[Step=68050 Epoch=260.7] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.387 | L2-Norm(final)=17.259 | 5158.4 samples/s | 80.6 steps/s
[Step=68100 Epoch=260.9] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.386 | L2-Norm(final)=17.269 | 5200.1 samples/s | 81.3 steps/s
[Step=68150 Epoch=261.1] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.386 | L2-Norm(final)=17.277 | 5294.4 samples/s | 82.7 steps/s
[Step=68200 Epoch=261.3] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=17.282 | 5205.7 samples/s | 81.3 steps/s
[Step=68250 Epoch=261.5] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=17.287 | 6634.7 samples/s | 103.7 steps/s
[Step=68300 Epoch=261.7] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=17.292 | 2116.5 samples/s | 33.1 steps/s
[Step=68350 Epoch=261.9] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=17.296 | 5070.1 samples/s | 79.2 steps/s
[Step=68400 Epoch=262.1] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=17.300 | 5259.9 samples/s | 82.2 steps/s
[Step=68450 Epoch=262.3] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=17.304 | 5181.3 samples/s | 81.0 steps/s
[Step=68500 Epoch=262.5] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=17.308 | 5887.7 samples/s | 92.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=68501 Epoch=262.5] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=17.344 | 4548.3 samples/s | 71.1 steps/s
[Step=68550 Epoch=262.7] | Loss=0.00017 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.387 | L2-Norm(final)=17.346 | 4290.5 samples/s | 67.0 steps/s
[Step=68600 Epoch=262.9] | Loss=0.00009 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.393 | L2-Norm(final)=17.345 | 4549.2 samples/s | 71.1 steps/s
[Step=68650 Epoch=263.0] | Loss=0.00006 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.390 | L2-Norm(final)=17.346 | 4562.0 samples/s | 71.3 steps/s
[Step=68700 Epoch=263.2] | Loss=0.00008 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.386 | L2-Norm(final)=17.346 | 4535.8 samples/s | 70.9 steps/s
[Step=68750 Epoch=263.4] | Loss=0.00014 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.386 | L2-Norm(final)=17.345 | 5708.1 samples/s | 89.2 steps/s
[Step=68800 Epoch=263.6] | Loss=0.00012 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.387 | L2-Norm(final)=17.344 | 2002.5 samples/s | 31.3 steps/s
[Step=68850 Epoch=263.8] | Loss=0.00011 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.386 | L2-Norm(final)=17.343 | 4524.5 samples/s | 70.7 steps/s
[Step=68900 Epoch=264.0] | Loss=0.00010 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.386 | L2-Norm(final)=17.343 | 4553.3 samples/s | 71.1 steps/s
[Step=68950 Epoch=264.2] | Loss=0.00009 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=17.343 | 4600.9 samples/s | 71.9 steps/s
[Step=69000 Epoch=264.4] | Loss=0.00008 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.383 | L2-Norm(final)=17.343 | 4976.2 samples/s | 77.8 steps/s
[Step=69050 Epoch=264.6] | Loss=0.00007 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.381 | L2-Norm(final)=17.344 | 2104.4 samples/s | 32.9 steps/s
[Step=69100 Epoch=264.8] | Loss=0.00007 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.380 | L2-Norm(final)=17.344 | 4567.6 samples/s | 71.4 steps/s
[Step=69150 Epoch=265.0] | Loss=0.00006 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.377 | L2-Norm(final)=17.344 | 4572.5 samples/s | 71.4 steps/s
[Step=69200 Epoch=265.1] | Loss=0.00006 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.375 | L2-Norm(final)=17.344 | 4596.8 samples/s | 71.8 steps/s
[Step=69250 Epoch=265.3] | Loss=0.00005 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.373 | L2-Norm(final)=17.345 | 4552.9 samples/s | 71.1 steps/s
[Step=69300 Epoch=265.5] | Loss=0.00005 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.370 | L2-Norm(final)=17.345 | 2188.9 samples/s | 34.2 steps/s
[Step=69350 Epoch=265.7] | Loss=0.00005 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.368 | L2-Norm(final)=17.345 | 4594.9 samples/s | 71.8 steps/s
[Step=69400 Epoch=265.9] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.365 | L2-Norm(final)=17.346 | 4558.9 samples/s | 71.2 steps/s
[Step=69450 Epoch=266.1] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.362 | L2-Norm(final)=17.346 | 4572.3 samples/s | 71.4 steps/s
[Step=69500 Epoch=266.3] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=17.347 | 4543.6 samples/s | 71.0 steps/s
[Step=69550 Epoch=266.5] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.357 | L2-Norm(final)=17.347 | 2178.6 samples/s | 34.0 steps/s
[Step=69600 Epoch=266.7] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.354 | L2-Norm(final)=17.347 | 4545.5 samples/s | 71.0 steps/s
[Step=69650 Epoch=266.9] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.351 | L2-Norm(final)=17.348 | 4592.6 samples/s | 71.8 steps/s
[Step=69700 Epoch=267.1] | Loss=0.00003 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.348 | L2-Norm(final)=17.348 | 4581.5 samples/s | 71.6 steps/s
[Step=69750 Epoch=267.3] | Loss=0.00003 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.345 | L2-Norm(final)=17.349 | 4567.9 samples/s | 71.4 steps/s
[Step=69800 Epoch=267.4] | Loss=0.00003 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.341 | L2-Norm(final)=17.349 | 6069.0 samples/s | 94.8 steps/s
[Step=69850 Epoch=267.6] | Loss=0.00003 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.338 | L2-Norm(final)=17.349 | 1969.9 samples/s | 30.8 steps/s
[Step=69900 Epoch=267.8] | Loss=0.00003 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.335 | L2-Norm(final)=17.350 | 4512.8 samples/s | 70.5 steps/s
[Step=69950 Epoch=268.0] | Loss=0.00003 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.332 | L2-Norm(final)=17.350 | 4477.5 samples/s | 70.0 steps/s
[Step=70000 Epoch=268.2] | Loss=0.00003 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.328 | L2-Norm(final)=17.351 | 4535.2 samples/s | 70.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step70000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=68001 Epoch=261.8] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.397 | L2-Norm(final)=18.085 | 4493.4 samples/s | 70.2 steps/s
[Step=68050 Epoch=262.0] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=18.086 | 4668.7 samples/s | 72.9 steps/s
[Step=68100 Epoch=262.1] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=18.089 | 5230.4 samples/s | 81.7 steps/s
[Step=68150 Epoch=262.3] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=18.092 | 5169.5 samples/s | 80.8 steps/s
[Step=68200 Epoch=262.5] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=18.094 | 5275.4 samples/s | 82.4 steps/s
[Step=68250 Epoch=262.7] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=18.097 | 6895.0 samples/s | 107.7 steps/s
[Step=68300 Epoch=262.9] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=18.099 | 2162.6 samples/s | 33.8 steps/s
[Step=68350 Epoch=263.1] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=18.101 | 5040.7 samples/s | 78.8 steps/s
[Step=68400 Epoch=263.3] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=18.103 | 5262.3 samples/s | 82.2 steps/s
[Step=68450 Epoch=263.5] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=18.105 | 5277.5 samples/s | 82.5 steps/s
[Step=68500 Epoch=263.7] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=18.108 | 5988.0 samples/s | 93.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=68501 Epoch=263.7] | Loss=0.00011 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=18.130 | 4779.1 samples/s | 74.7 steps/s
[Step=68550 Epoch=263.9] | Loss=0.00038 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.395 | L2-Norm(final)=18.131 | 4194.3 samples/s | 65.5 steps/s
[Step=68600 Epoch=264.1] | Loss=0.00036 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=18.128 | 4444.5 samples/s | 69.4 steps/s
[Step=68650 Epoch=264.3] | Loss=0.00026 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.410 | L2-Norm(final)=18.128 | 4644.1 samples/s | 72.6 steps/s
[Step=68700 Epoch=264.5] | Loss=0.00020 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.414 | L2-Norm(final)=18.129 | 4542.3 samples/s | 71.0 steps/s
[Step=68750 Epoch=264.6] | Loss=0.00019 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.415 | L2-Norm(final)=18.129 | 5811.3 samples/s | 90.8 steps/s
[Step=68800 Epoch=264.8] | Loss=0.00016 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.417 | L2-Norm(final)=18.130 | 1979.1 samples/s | 30.9 steps/s
[Step=68850 Epoch=265.0] | Loss=0.00014 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.417 | L2-Norm(final)=18.131 | 4529.9 samples/s | 70.8 steps/s
[Step=68900 Epoch=265.2] | Loss=0.00012 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.417 | L2-Norm(final)=18.131 | 4543.7 samples/s | 71.0 steps/s
[Step=68950 Epoch=265.4] | Loss=0.00011 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.416 | L2-Norm(final)=18.132 | 4559.2 samples/s | 71.2 steps/s
[Step=69000 Epoch=265.6] | Loss=0.00010 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.415 | L2-Norm(final)=18.132 | 5159.8 samples/s | 80.6 steps/s
[Step=69050 Epoch=265.8] | Loss=0.00009 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.414 | L2-Norm(final)=18.133 | 2084.7 samples/s | 32.6 steps/s
[Step=69100 Epoch=266.0] | Loss=0.00008 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.412 | L2-Norm(final)=18.134 | 4563.6 samples/s | 71.3 steps/s
[Step=69150 Epoch=266.2] | Loss=0.00008 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.411 | L2-Norm(final)=18.134 | 4553.1 samples/s | 71.1 steps/s
[Step=69200 Epoch=266.4] | Loss=0.00007 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.409 | L2-Norm(final)=18.135 | 4559.6 samples/s | 71.2 steps/s
[Step=69250 Epoch=266.6] | Loss=0.00007 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.407 | L2-Norm(final)=18.135 | 4634.1 samples/s | 72.4 steps/s
[Step=69300 Epoch=266.8] | Loss=0.00006 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=18.136 | 2178.2 samples/s | 34.0 steps/s
[Step=69350 Epoch=267.0] | Loss=0.00006 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.403 | L2-Norm(final)=18.136 | 4541.6 samples/s | 71.0 steps/s
[Step=69400 Epoch=267.1] | Loss=0.00006 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.401 | L2-Norm(final)=18.137 | 4530.0 samples/s | 70.8 steps/s
[Step=69450 Epoch=267.3] | Loss=0.00005 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=18.137 | 4602.5 samples/s | 71.9 steps/s
[Step=69500 Epoch=267.5] | Loss=0.00005 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.397 | L2-Norm(final)=18.138 | 4605.2 samples/s | 72.0 steps/s
[Step=69550 Epoch=267.7] | Loss=0.00005 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.395 | L2-Norm(final)=18.138 | 2191.7 samples/s | 34.2 steps/s
[Step=69600 Epoch=267.9] | Loss=0.00005 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.392 | L2-Norm(final)=18.139 | 4563.4 samples/s | 71.3 steps/s
[Step=69650 Epoch=268.1] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.390 | L2-Norm(final)=18.139 | 4503.1 samples/s | 70.4 steps/s
[Step=69700 Epoch=268.3] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.388 | L2-Norm(final)=18.139 | 4551.7 samples/s | 71.1 steps/s
[Step=69750 Epoch=268.5] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=18.140 | 4527.5 samples/s | 70.7 steps/s
[Step=69800 Epoch=268.7] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.383 | L2-Norm(final)=18.140 | 6675.6 samples/s | 104.3 steps/s
[Step=69850 Epoch=268.9] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.380 | L2-Norm(final)=18.141 | 1906.9 samples/s | 29.8 steps/s
[Step=69900 Epoch=269.1] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.378 | L2-Norm(final)=18.141 | 4611.7 samples/s | 72.1 steps/s
[Step=69950 Epoch=269.3] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.375 | L2-Norm(final)=18.142 | 4547.2 samples/s | 71.0 steps/s
[Step=70000 Epoch=269.5] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.373 | L2-Norm(final)=18.142 | 4545.4 samples/s | 71.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step70000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07712 | acc=0.9689 | tpr=0.9730 | fpr=0.0399 | 4181.3 samples/s | 16.3 steps/s
Avg test loss: 0.07691, Avg test acc: 0.96823, Avg tpr: 0.97301, Avg fpr: 0.04230, total FA: 330

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07756 | acc=0.9690 | tpr=0.9804 | fpr=0.0557 | 4209.2 samples/s | 16.4 steps/s
Avg test loss: 0.07737, Avg test acc: 0.96955, Avg tpr: 0.98152, Avg fpr: 0.05679, total FA: 443

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.09983 | acc=0.3046 | tpr=0.0055 | fpr=0.0458 | 4220.0 samples/s | 16.5 steps/s
Avg test loss: 7.11525, Avg test acc: 0.30087, Avg tpr: 0.00466, Avg fpr: 0.04769, total FA: 372

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.32009 | acc=0.2909 | tpr=0.0092 | fpr=0.0974 | 4169.7 samples/s | 16.3 steps/s
Avg test loss: 7.33218, Avg test acc: 0.28816, Avg tpr: 0.00816, Avg fpr: 0.09601, total FA: 749

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.28879 | acc=0.1405 | tpr=0.4204 | fpr=0.8646 | 4209.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=5.23570 | acc=0.1419 | tpr=0.4179 | fpr=0.8632 | 7702.0 samples/s | 30.1 steps/s
[Step= 150] | Loss=5.24292 | acc=0.1414 | tpr=0.4280 | fpr=0.8639 | 7828.2 samples/s | 30.6 steps/s
[Step= 200] | Loss=5.23877 | acc=0.1417 | tpr=0.4208 | fpr=0.8634 | 7878.0 samples/s | 30.8 steps/s
[Step= 250] | Loss=5.23904 | acc=0.1416 | tpr=0.4114 | fpr=0.8633 | 8047.5 samples/s | 31.4 steps/s
[Step= 300] | Loss=5.24517 | acc=0.1406 | tpr=0.4044 | fpr=0.8642 | 7755.8 samples/s | 30.3 steps/s
[Step= 350] | Loss=5.25542 | acc=0.1402 | tpr=0.4045 | fpr=0.8646 | 7812.6 samples/s | 30.5 steps/s
[Step= 400] | Loss=5.24821 | acc=0.1401 | tpr=0.3977 | fpr=0.8646 | 7880.6 samples/s | 30.8 steps/s
[Step= 450] | Loss=5.24965 | acc=0.1397 | tpr=0.3948 | fpr=0.8650 | 8019.7 samples/s | 31.3 steps/s
[Step= 500] | Loss=5.25187 | acc=0.1397 | tpr=0.4000 | fpr=0.8650 | 7633.4 samples/s | 29.8 steps/s
[Step= 550] | Loss=5.25370 | acc=0.1396 | tpr=0.3991 | fpr=0.8651 | 14239.3 samples/s | 55.6 steps/s
Avg test loss: 5.25408, Avg test acc: 0.13954, Avg tpr: 0.39976, Avg fpr: 0.86519, total FA: 120130

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.21022 | acc=0.1202 | tpr=0.4867 | fpr=0.8864 | 4182.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.15279 | acc=0.1207 | tpr=0.5032 | fpr=0.8864 | 7874.3 samples/s | 30.8 steps/s
[Step= 150] | Loss=6.16042 | acc=0.1202 | tpr=0.5058 | fpr=0.8869 | 7908.6 samples/s | 30.9 steps/s
[Step= 200] | Loss=6.15473 | acc=0.1206 | tpr=0.5038 | fpr=0.8863 | 8117.9 samples/s | 31.7 steps/s
[Step= 250] | Loss=6.15500 | acc=0.1205 | tpr=0.4978 | fpr=0.8864 | 7980.6 samples/s | 31.2 steps/s
[Step= 300] | Loss=6.16343 | acc=0.1203 | tpr=0.4960 | fpr=0.8866 | 7786.7 samples/s | 30.4 steps/s
[Step= 350] | Loss=6.17296 | acc=0.1196 | tpr=0.4984 | fpr=0.8873 | 7643.0 samples/s | 29.9 steps/s
[Step= 400] | Loss=6.16527 | acc=0.1191 | tpr=0.4885 | fpr=0.8876 | 8076.9 samples/s | 31.6 steps/s
[Step= 450] | Loss=6.16590 | acc=0.1187 | tpr=0.4878 | fpr=0.8880 | 7757.2 samples/s | 30.3 steps/s
[Step= 500] | Loss=6.16873 | acc=0.1184 | tpr=0.4934 | fpr=0.8884 | 7804.4 samples/s | 30.5 steps/s
[Step= 550] | Loss=6.17134 | acc=0.1185 | tpr=0.4934 | fpr=0.8883 | 14586.1 samples/s | 57.0 steps/s
Avg test loss: 6.17147, Avg test acc: 0.11848, Avg tpr: 0.49366, Avg fpr: 0.88834, total FA: 123344

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12244 | acc=0.9812 | tpr=0.9248 | fpr=0.0177 | 4221.8 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.12892 | acc=0.9801 | tpr=0.9424 | fpr=0.0192 | 7784.1 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.13114 | acc=0.9799 | tpr=0.9496 | fpr=0.0195 | 7778.4 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.13214 | acc=0.9802 | tpr=0.9541 | fpr=0.0193 | 7658.8 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.13180 | acc=0.9803 | tpr=0.9537 | fpr=0.0192 | 7898.1 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.13445 | acc=0.9802 | tpr=0.9535 | fpr=0.0193 | 7844.7 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.13462 | acc=0.9802 | tpr=0.9524 | fpr=0.0193 | 7948.1 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.13571 | acc=0.9800 | tpr=0.9513 | fpr=0.0195 | 7897.5 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.13745 | acc=0.9798 | tpr=0.9499 | fpr=0.0197 | 7854.1 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.13670 | acc=0.9800 | tpr=0.9498 | fpr=0.0195 | 7784.1 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.13537 | acc=0.9802 | tpr=0.9507 | fpr=0.0193 | 14349.1 samples/s | 56.1 steps/s
Avg test loss: 0.13504, Avg test acc: 0.98021, Avg tpr: 0.95087, Avg fpr: 0.01926, total FA: 2674

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15860 | acc=0.9785 | tpr=0.9381 | fpr=0.0208 | 4157.7 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.16823 | acc=0.9775 | tpr=0.9488 | fpr=0.0220 | 7970.1 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.17121 | acc=0.9772 | tpr=0.9582 | fpr=0.0225 | 8064.4 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.17233 | acc=0.9775 | tpr=0.9607 | fpr=0.0222 | 7590.5 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.17135 | acc=0.9774 | tpr=0.9598 | fpr=0.0223 | 7839.6 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.17479 | acc=0.9770 | tpr=0.9615 | fpr=0.0227 | 7852.2 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.17537 | acc=0.9770 | tpr=0.9606 | fpr=0.0227 | 7773.7 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.17717 | acc=0.9767 | tpr=0.9595 | fpr=0.0230 | 8062.5 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.17928 | acc=0.9764 | tpr=0.9572 | fpr=0.0232 | 7889.1 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.17796 | acc=0.9766 | tpr=0.9586 | fpr=0.0231 | 7754.9 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.17655 | acc=0.9768 | tpr=0.9594 | fpr=0.0229 | 15228.3 samples/s | 59.5 steps/s
Avg test loss: 0.17611, Avg test acc: 0.97685, Avg tpr: 0.95959, Avg fpr: 0.02284, total FA: 3171

server round 35/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=70001 Epoch=136.5] | Loss=0.00398 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.390 | L2-Norm(final)=18.807 | 4399.0 samples/s | 68.7 steps/s
[Step=70050 Epoch=136.6] | Loss=0.00766 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.390 | L2-Norm(final)=18.811 | 5187.7 samples/s | 81.1 steps/s
[Step=70100 Epoch=136.7] | Loss=0.00799 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.390 | L2-Norm(final)=18.815 | 5548.2 samples/s | 86.7 steps/s
[Step=70150 Epoch=136.8] | Loss=0.00800 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=18.821 | 5458.8 samples/s | 85.3 steps/s
[Step=70200 Epoch=136.9] | Loss=0.00803 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=18.825 | 5728.8 samples/s | 89.5 steps/s
[Step=70250 Epoch=137.0] | Loss=0.00800 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=18.830 | 5425.3 samples/s | 84.8 steps/s
[Step=70300 Epoch=137.1] | Loss=0.00782 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=18.835 | 5573.4 samples/s | 87.1 steps/s
[Step=70350 Epoch=137.2] | Loss=0.00783 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.391 | L2-Norm(final)=18.840 | 5429.9 samples/s | 84.8 steps/s
[Step=70400 Epoch=137.3] | Loss=0.00801 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=18.846 | 5703.5 samples/s | 89.1 steps/s
[Step=70450 Epoch=137.4] | Loss=0.00823 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.391 | L2-Norm(final)=18.851 | 5458.7 samples/s | 85.3 steps/s
[Step=70500 Epoch=137.5] | Loss=0.00826 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=18.856 | 6881.9 samples/s | 107.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=70501 Epoch=137.5] | Loss=0.00212 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=18.907 | 5036.2 samples/s | 78.7 steps/s
[Step=70550 Epoch=137.6] | Loss=0.01149 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=18.911 | 4250.2 samples/s | 66.4 steps/s
[Step=70600 Epoch=137.7] | Loss=0.01034 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.416 | L2-Norm(final)=18.914 | 4791.2 samples/s | 74.9 steps/s
[Step=70650 Epoch=137.8] | Loss=0.01058 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.423 | L2-Norm(final)=18.915 | 4784.7 samples/s | 74.8 steps/s
[Step=70700 Epoch=137.9] | Loss=0.00996 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.429 | L2-Norm(final)=18.916 | 4813.1 samples/s | 75.2 steps/s
[Step=70750 Epoch=138.0] | Loss=0.00973 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.435 | L2-Norm(final)=18.918 | 4803.8 samples/s | 75.1 steps/s
[Step=70800 Epoch=138.1] | Loss=0.00923 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.440 | L2-Norm(final)=18.920 | 4798.6 samples/s | 75.0 steps/s
[Step=70850 Epoch=138.2] | Loss=0.00889 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.445 | L2-Norm(final)=18.922 | 4836.5 samples/s | 75.6 steps/s
[Step=70900 Epoch=138.3] | Loss=0.00876 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.449 | L2-Norm(final)=18.924 | 4814.7 samples/s | 75.2 steps/s
[Step=70950 Epoch=138.4] | Loss=0.00845 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.452 | L2-Norm(final)=18.926 | 4848.9 samples/s | 75.8 steps/s
[Step=71000 Epoch=138.5] | Loss=0.00835 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.456 | L2-Norm(final)=18.928 | 5745.5 samples/s | 89.8 steps/s
[Step=71050 Epoch=138.6] | Loss=0.00807 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.459 | L2-Norm(final)=18.930 | 2043.8 samples/s | 31.9 steps/s
[Step=71100 Epoch=138.7] | Loss=0.00780 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.462 | L2-Norm(final)=18.932 | 4803.8 samples/s | 75.1 steps/s
[Step=71150 Epoch=138.8] | Loss=0.00761 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.465 | L2-Norm(final)=18.934 | 4789.9 samples/s | 74.8 steps/s
[Step=71200 Epoch=138.9] | Loss=0.00748 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.468 | L2-Norm(final)=18.936 | 4801.3 samples/s | 75.0 steps/s
[Step=71250 Epoch=139.0] | Loss=0.00758 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.471 | L2-Norm(final)=18.939 | 4783.7 samples/s | 74.7 steps/s
[Step=71300 Epoch=139.1] | Loss=0.00745 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.474 | L2-Norm(final)=18.940 | 4802.9 samples/s | 75.0 steps/s
[Step=71350 Epoch=139.2] | Loss=0.00726 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.476 | L2-Norm(final)=18.943 | 4870.5 samples/s | 76.1 steps/s
[Step=71400 Epoch=139.3] | Loss=0.00723 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.479 | L2-Norm(final)=18.945 | 4735.2 samples/s | 74.0 steps/s
[Step=71450 Epoch=139.4] | Loss=0.00719 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.481 | L2-Norm(final)=18.946 | 4820.2 samples/s | 75.3 steps/s
[Step=71500 Epoch=139.5] | Loss=0.00709 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.484 | L2-Norm(final)=18.948 | 5029.2 samples/s | 78.6 steps/s
[Step=71550 Epoch=139.6] | Loss=0.00699 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.486 | L2-Norm(final)=18.950 | 2131.2 samples/s | 33.3 steps/s
[Step=71600 Epoch=139.6] | Loss=0.00696 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.488 | L2-Norm(final)=18.952 | 4895.9 samples/s | 76.5 steps/s
[Step=71650 Epoch=139.7] | Loss=0.00681 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.490 | L2-Norm(final)=18.954 | 4772.9 samples/s | 74.6 steps/s
[Step=71700 Epoch=139.8] | Loss=0.00669 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.492 | L2-Norm(final)=18.957 | 4759.0 samples/s | 74.4 steps/s
[Step=71750 Epoch=139.9] | Loss=0.00667 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.494 | L2-Norm(final)=18.959 | 4821.6 samples/s | 75.3 steps/s
[Step=71800 Epoch=140.0] | Loss=0.00665 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.497 | L2-Norm(final)=18.961 | 4751.1 samples/s | 74.2 steps/s
[Step=71850 Epoch=140.1] | Loss=0.00669 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.499 | L2-Norm(final)=18.963 | 4783.0 samples/s | 74.7 steps/s
[Step=71900 Epoch=140.2] | Loss=0.00661 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.501 | L2-Norm(final)=18.965 | 4768.6 samples/s | 74.5 steps/s
[Step=71950 Epoch=140.3] | Loss=0.00654 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.503 | L2-Norm(final)=18.967 | 4803.7 samples/s | 75.1 steps/s
[Step=72000 Epoch=140.4] | Loss=0.00650 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.505 | L2-Norm(final)=18.968 | 4778.8 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step72000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=70001 Epoch=136.9] | Loss=0.01546 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.390 | L2-Norm(final)=18.897 | 4536.3 samples/s | 70.9 steps/s
[Step=70050 Epoch=136.9] | Loss=0.00802 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.391 | L2-Norm(final)=18.904 | 5195.6 samples/s | 81.2 steps/s
[Step=70100 Epoch=137.0] | Loss=0.00822 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.391 | L2-Norm(final)=18.914 | 5443.6 samples/s | 85.1 steps/s
[Step=70150 Epoch=137.1] | Loss=0.00828 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=18.923 | 5512.5 samples/s | 86.1 steps/s
[Step=70200 Epoch=137.2] | Loss=0.00835 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=18.932 | 5534.9 samples/s | 86.5 steps/s
[Step=70250 Epoch=137.3] | Loss=0.00818 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=18.940 | 5587.1 samples/s | 87.3 steps/s
[Step=70300 Epoch=137.4] | Loss=0.00796 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=18.948 | 5534.1 samples/s | 86.5 steps/s
[Step=70350 Epoch=137.5] | Loss=0.00828 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.391 | L2-Norm(final)=18.956 | 5487.5 samples/s | 85.7 steps/s
[Step=70400 Epoch=137.6] | Loss=0.00830 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=18.963 | 5569.4 samples/s | 87.0 steps/s
[Step=70450 Epoch=137.7] | Loss=0.00823 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=18.970 | 5592.3 samples/s | 87.4 steps/s
[Step=70500 Epoch=137.8] | Loss=0.00814 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=18.977 | 7010.7 samples/s | 109.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=70501 Epoch=137.8] | Loss=0.00363 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=19.049 | 4773.8 samples/s | 74.6 steps/s
[Step=70550 Epoch=137.9] | Loss=0.00875 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.401 | L2-Norm(final)=19.053 | 4458.1 samples/s | 69.7 steps/s
[Step=70600 Epoch=138.0] | Loss=0.00847 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.409 | L2-Norm(final)=19.055 | 4755.2 samples/s | 74.3 steps/s
[Step=70650 Epoch=138.1] | Loss=0.00850 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.416 | L2-Norm(final)=19.057 | 4804.3 samples/s | 75.1 steps/s
[Step=70700 Epoch=138.2] | Loss=0.00842 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.422 | L2-Norm(final)=19.059 | 4768.8 samples/s | 74.5 steps/s
[Step=70750 Epoch=138.3] | Loss=0.00837 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.427 | L2-Norm(final)=19.061 | 4777.5 samples/s | 74.6 steps/s
[Step=70800 Epoch=138.4] | Loss=0.00822 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.432 | L2-Norm(final)=19.063 | 4792.7 samples/s | 74.9 steps/s
[Step=70850 Epoch=138.5] | Loss=0.00816 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.437 | L2-Norm(final)=19.065 | 4804.3 samples/s | 75.1 steps/s
[Step=70900 Epoch=138.6] | Loss=0.00802 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.441 | L2-Norm(final)=19.067 | 4800.2 samples/s | 75.0 steps/s
[Step=70950 Epoch=138.7] | Loss=0.00781 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.445 | L2-Norm(final)=19.069 | 4779.4 samples/s | 74.7 steps/s
[Step=71000 Epoch=138.8] | Loss=0.00790 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.449 | L2-Norm(final)=19.071 | 5853.2 samples/s | 91.5 steps/s
[Step=71050 Epoch=138.9] | Loss=0.00781 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.453 | L2-Norm(final)=19.073 | 2062.5 samples/s | 32.2 steps/s
[Step=71100 Epoch=139.0] | Loss=0.00744 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.456 | L2-Norm(final)=19.075 | 4737.1 samples/s | 74.0 steps/s
[Step=71150 Epoch=139.1] | Loss=0.00730 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.459 | L2-Norm(final)=19.077 | 4753.8 samples/s | 74.3 steps/s
[Step=71200 Epoch=139.2] | Loss=0.00706 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.462 | L2-Norm(final)=19.079 | 4789.8 samples/s | 74.8 steps/s
[Step=71250 Epoch=139.3] | Loss=0.00707 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.465 | L2-Norm(final)=19.081 | 4832.7 samples/s | 75.5 steps/s
[Step=71300 Epoch=139.4] | Loss=0.00697 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.468 | L2-Norm(final)=19.083 | 4732.9 samples/s | 74.0 steps/s
[Step=71350 Epoch=139.5] | Loss=0.00687 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=19.085 | 4780.8 samples/s | 74.7 steps/s
[Step=71400 Epoch=139.6] | Loss=0.00685 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.473 | L2-Norm(final)=19.087 | 4815.7 samples/s | 75.2 steps/s
[Step=71450 Epoch=139.7] | Loss=0.00678 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.475 | L2-Norm(final)=19.089 | 4749.7 samples/s | 74.2 steps/s
[Step=71500 Epoch=139.8] | Loss=0.00670 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.477 | L2-Norm(final)=19.091 | 5179.0 samples/s | 80.9 steps/s
[Step=71550 Epoch=139.9] | Loss=0.00657 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.480 | L2-Norm(final)=19.092 | 2190.0 samples/s | 34.2 steps/s
[Step=71600 Epoch=140.0] | Loss=0.00645 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=19.094 | 4768.6 samples/s | 74.5 steps/s
[Step=71650 Epoch=140.1] | Loss=0.00636 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.484 | L2-Norm(final)=19.096 | 4771.8 samples/s | 74.6 steps/s
[Step=71700 Epoch=140.2] | Loss=0.00623 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.486 | L2-Norm(final)=19.098 | 4761.7 samples/s | 74.4 steps/s
[Step=71750 Epoch=140.3] | Loss=0.00615 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.488 | L2-Norm(final)=19.100 | 4839.6 samples/s | 75.6 steps/s
[Step=71800 Epoch=140.4] | Loss=0.00612 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.490 | L2-Norm(final)=19.102 | 4847.2 samples/s | 75.7 steps/s
[Step=71850 Epoch=140.5] | Loss=0.00608 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.492 | L2-Norm(final)=19.103 | 4776.0 samples/s | 74.6 steps/s
[Step=71900 Epoch=140.6] | Loss=0.00610 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.494 | L2-Norm(final)=19.105 | 4809.8 samples/s | 75.2 steps/s
[Step=71950 Epoch=140.7] | Loss=0.00610 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.496 | L2-Norm(final)=19.107 | 4794.6 samples/s | 74.9 steps/s
[Step=72000 Epoch=140.8] | Loss=0.00606 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.498 | L2-Norm(final)=19.108 | 4779.5 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step72000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=70001 Epoch=268.2] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.390 | L2-Norm(final)=17.365 | 4669.1 samples/s | 73.0 steps/s
[Step=70050 Epoch=268.4] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=17.366 | 4602.7 samples/s | 71.9 steps/s
[Step=70100 Epoch=268.6] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=17.366 | 5204.3 samples/s | 81.3 steps/s
[Step=70150 Epoch=268.8] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=17.367 | 5308.5 samples/s | 82.9 steps/s
[Step=70200 Epoch=269.0] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=17.367 | 5331.9 samples/s | 83.3 steps/s
[Step=70250 Epoch=269.2] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=17.368 | 6547.8 samples/s | 102.3 steps/s
[Step=70300 Epoch=269.4] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=17.370 | 2148.0 samples/s | 33.6 steps/s
[Step=70350 Epoch=269.6] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=17.371 | 5201.4 samples/s | 81.3 steps/s
[Step=70400 Epoch=269.7] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=17.372 | 5244.0 samples/s | 81.9 steps/s
[Step=70450 Epoch=269.9] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=17.373 | 5101.7 samples/s | 79.7 steps/s
[Step=70500 Epoch=270.1] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=17.375 | 5934.3 samples/s | 92.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=70501 Epoch=270.1] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=17.388 | 4512.0 samples/s | 70.5 steps/s
[Step=70550 Epoch=270.3] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=17.390 | 4375.2 samples/s | 68.4 steps/s
[Step=70600 Epoch=270.5] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.381 | L2-Norm(final)=17.393 | 4496.2 samples/s | 70.3 steps/s
[Step=70650 Epoch=270.7] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.376 | L2-Norm(final)=17.394 | 4557.0 samples/s | 71.2 steps/s
[Step=70700 Epoch=270.9] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.370 | L2-Norm(final)=17.396 | 4612.4 samples/s | 72.1 steps/s
[Step=70750 Epoch=271.1] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.364 | L2-Norm(final)=17.397 | 5684.9 samples/s | 88.8 steps/s
[Step=70800 Epoch=271.3] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.357 | L2-Norm(final)=17.398 | 1990.4 samples/s | 31.1 steps/s
[Step=70850 Epoch=271.5] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.351 | L2-Norm(final)=17.399 | 4513.6 samples/s | 70.5 steps/s
[Step=70900 Epoch=271.7] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.344 | L2-Norm(final)=17.399 | 4549.1 samples/s | 71.1 steps/s
[Step=70950 Epoch=271.9] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.338 | L2-Norm(final)=17.400 | 4548.3 samples/s | 71.1 steps/s
[Step=71000 Epoch=272.0] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.331 | L2-Norm(final)=17.401 | 5032.0 samples/s | 78.6 steps/s
[Step=71050 Epoch=272.2] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.324 | L2-Norm(final)=17.402 | 2114.9 samples/s | 33.0 steps/s
[Step=71100 Epoch=272.4] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.318 | L2-Norm(final)=17.403 | 4661.3 samples/s | 72.8 steps/s
[Step=71150 Epoch=272.6] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.311 | L2-Norm(final)=17.404 | 4525.0 samples/s | 70.7 steps/s
[Step=71200 Epoch=272.8] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.304 | L2-Norm(final)=17.405 | 4542.8 samples/s | 71.0 steps/s
[Step=71250 Epoch=273.0] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.297 | L2-Norm(final)=17.405 | 4604.5 samples/s | 71.9 steps/s
[Step=71300 Epoch=273.2] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=17.406 | 2207.0 samples/s | 34.5 steps/s
[Step=71350 Epoch=273.4] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.283 | L2-Norm(final)=17.407 | 4552.4 samples/s | 71.1 steps/s
[Step=71400 Epoch=273.6] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.276 | L2-Norm(final)=17.408 | 4555.4 samples/s | 71.2 steps/s
[Step=71450 Epoch=273.8] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.269 | L2-Norm(final)=17.409 | 4605.7 samples/s | 72.0 steps/s
[Step=71500 Epoch=274.0] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.261 | L2-Norm(final)=17.410 | 4593.1 samples/s | 71.8 steps/s
[Step=71550 Epoch=274.2] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.254 | L2-Norm(final)=17.411 | 2181.9 samples/s | 34.1 steps/s
[Step=71600 Epoch=274.3] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=17.412 | 4476.6 samples/s | 69.9 steps/s
[Step=71650 Epoch=274.5] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.239 | L2-Norm(final)=17.412 | 4559.8 samples/s | 71.2 steps/s
[Step=71700 Epoch=274.7] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.232 | L2-Norm(final)=17.413 | 4603.5 samples/s | 71.9 steps/s
[Step=71750 Epoch=274.9] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.224 | L2-Norm(final)=17.414 | 4565.9 samples/s | 71.3 steps/s
[Step=71800 Epoch=275.1] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.216 | L2-Norm(final)=17.415 | 6057.3 samples/s | 94.6 steps/s
[Step=71850 Epoch=275.3] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.209 | L2-Norm(final)=17.416 | 1955.7 samples/s | 30.6 steps/s
[Step=71900 Epoch=275.5] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.201 | L2-Norm(final)=17.417 | 4543.6 samples/s | 71.0 steps/s
[Step=71950 Epoch=275.7] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.193 | L2-Norm(final)=17.418 | 4489.8 samples/s | 70.2 steps/s
[Step=72000 Epoch=275.9] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.185 | L2-Norm(final)=17.419 | 4535.1 samples/s | 70.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step72000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=70001 Epoch=269.5] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.390 | L2-Norm(final)=18.154 | 4661.6 samples/s | 72.8 steps/s
[Step=70050 Epoch=269.6] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.155 | 4822.7 samples/s | 75.4 steps/s
[Step=70100 Epoch=269.8] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.156 | 5174.2 samples/s | 80.8 steps/s
[Step=70150 Epoch=270.0] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.157 | 5138.1 samples/s | 80.3 steps/s
[Step=70200 Epoch=270.2] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.159 | 5237.7 samples/s | 81.8 steps/s
[Step=70250 Epoch=270.4] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.160 | 7059.9 samples/s | 110.3 steps/s
[Step=70300 Epoch=270.6] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.162 | 2113.7 samples/s | 33.0 steps/s
[Step=70350 Epoch=270.8] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.163 | 5260.0 samples/s | 82.2 steps/s
[Step=70400 Epoch=271.0] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.164 | 5093.8 samples/s | 79.6 steps/s
[Step=70450 Epoch=271.2] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.165 | 5260.1 samples/s | 82.2 steps/s
[Step=70500 Epoch=271.4] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.166 | 6026.5 samples/s | 94.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=70501 Epoch=271.4] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.180 | 4879.5 samples/s | 76.2 steps/s
[Step=70550 Epoch=271.6] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.387 | L2-Norm(final)=18.181 | 4127.5 samples/s | 64.5 steps/s
[Step=70600 Epoch=271.8] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=18.182 | 4573.0 samples/s | 71.5 steps/s
[Step=70650 Epoch=272.0] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.382 | L2-Norm(final)=18.182 | 4552.2 samples/s | 71.1 steps/s
[Step=70700 Epoch=272.2] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.378 | L2-Norm(final)=18.183 | 4560.1 samples/s | 71.3 steps/s
[Step=70750 Epoch=272.3] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.373 | L2-Norm(final)=18.183 | 5765.0 samples/s | 90.1 steps/s
[Step=70800 Epoch=272.5] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.369 | L2-Norm(final)=18.184 | 1997.0 samples/s | 31.2 steps/s
[Step=70850 Epoch=272.7] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.364 | L2-Norm(final)=18.184 | 4507.2 samples/s | 70.4 steps/s
[Step=70900 Epoch=272.9] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.360 | L2-Norm(final)=18.185 | 4657.8 samples/s | 72.8 steps/s
[Step=70950 Epoch=273.1] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.355 | L2-Norm(final)=18.185 | 4455.8 samples/s | 69.6 steps/s
[Step=71000 Epoch=273.3] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.350 | L2-Norm(final)=18.186 | 5153.2 samples/s | 80.5 steps/s
[Step=71050 Epoch=273.5] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.345 | L2-Norm(final)=18.186 | 2079.4 samples/s | 32.5 steps/s
[Step=71100 Epoch=273.7] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.339 | L2-Norm(final)=18.186 | 4490.8 samples/s | 70.2 steps/s
[Step=71150 Epoch=273.9] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.334 | L2-Norm(final)=18.187 | 4544.0 samples/s | 71.0 steps/s
[Step=71200 Epoch=274.1] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.329 | L2-Norm(final)=18.187 | 4588.9 samples/s | 71.7 steps/s
[Step=71250 Epoch=274.3] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.323 | L2-Norm(final)=18.188 | 4620.4 samples/s | 72.2 steps/s
[Step=71300 Epoch=274.5] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.318 | L2-Norm(final)=18.188 | 2162.9 samples/s | 33.8 steps/s
[Step=71350 Epoch=274.7] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.312 | L2-Norm(final)=18.188 | 4642.4 samples/s | 72.5 steps/s
[Step=71400 Epoch=274.8] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.307 | L2-Norm(final)=18.189 | 4501.0 samples/s | 70.3 steps/s
[Step=71450 Epoch=275.0] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.301 | L2-Norm(final)=18.189 | 4562.0 samples/s | 71.3 steps/s
[Step=71500 Epoch=275.2] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=18.190 | 4533.0 samples/s | 70.8 steps/s
[Step=71550 Epoch=275.4] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.289 | L2-Norm(final)=18.190 | 2216.2 samples/s | 34.6 steps/s
[Step=71600 Epoch=275.6] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.283 | L2-Norm(final)=18.190 | 4482.8 samples/s | 70.0 steps/s
[Step=71650 Epoch=275.8] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.277 | L2-Norm(final)=18.191 | 4627.8 samples/s | 72.3 steps/s
[Step=71700 Epoch=276.0] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.271 | L2-Norm(final)=18.191 | 4502.8 samples/s | 70.4 steps/s
[Step=71750 Epoch=276.2] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.265 | L2-Norm(final)=18.192 | 4561.8 samples/s | 71.3 steps/s
[Step=71800 Epoch=276.4] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.259 | L2-Norm(final)=18.192 | 6633.2 samples/s | 103.6 steps/s
[Step=71850 Epoch=276.6] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.253 | L2-Norm(final)=18.193 | 1918.4 samples/s | 30.0 steps/s
[Step=71900 Epoch=276.8] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=18.193 | 4544.4 samples/s | 71.0 steps/s
[Step=71950 Epoch=277.0] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.240 | L2-Norm(final)=18.194 | 4659.1 samples/s | 72.8 steps/s
[Step=72000 Epoch=277.2] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.233 | L2-Norm(final)=18.195 | 4505.9 samples/s | 70.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step72000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07644 | acc=0.9700 | tpr=0.9815 | fpr=0.0550 | 4128.6 samples/s | 16.1 steps/s
Avg test loss: 0.07555, Avg test acc: 0.96967, Avg tpr: 0.98117, Avg fpr: 0.05563, total FA: 434

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07481 | acc=0.9690 | tpr=0.9743 | fpr=0.0426 | 4196.0 samples/s | 16.4 steps/s
Avg test loss: 0.07461, Avg test acc: 0.96863, Avg tpr: 0.97459, Avg fpr: 0.04448, total FA: 347

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.74303 | acc=0.3005 | tpr=0.0062 | fpr=0.0602 | 4153.1 samples/s | 16.2 steps/s
Avg test loss: 6.75535, Avg test acc: 0.29698, Avg tpr: 0.00560, Avg fpr: 0.06217, total FA: 485

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.45930 | acc=0.2888 | tpr=0.0094 | fpr=0.1043 | 4211.2 samples/s | 16.5 steps/s
Avg test loss: 6.47040, Avg test acc: 0.28612, Avg tpr: 0.00892, Avg fpr: 0.10422, total FA: 813

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.92108 | acc=0.1142 | tpr=0.4159 | fpr=0.8912 | 4175.8 samples/s | 16.3 steps/s
[Step= 100] | Loss=5.86277 | acc=0.1152 | tpr=0.4136 | fpr=0.8904 | 7759.1 samples/s | 30.3 steps/s
[Step= 150] | Loss=5.86771 | acc=0.1149 | tpr=0.4207 | fpr=0.8907 | 7545.6 samples/s | 29.5 steps/s
[Step= 200] | Loss=5.86598 | acc=0.1155 | tpr=0.4142 | fpr=0.8900 | 7954.8 samples/s | 31.1 steps/s
[Step= 250] | Loss=5.86628 | acc=0.1150 | tpr=0.4061 | fpr=0.8903 | 7935.8 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.87235 | acc=0.1143 | tpr=0.4022 | fpr=0.8910 | 7952.2 samples/s | 31.1 steps/s
[Step= 350] | Loss=5.88165 | acc=0.1139 | tpr=0.3989 | fpr=0.8913 | 7743.4 samples/s | 30.2 steps/s
[Step= 400] | Loss=5.87466 | acc=0.1136 | tpr=0.3922 | fpr=0.8915 | 7746.6 samples/s | 30.3 steps/s
[Step= 450] | Loss=5.87608 | acc=0.1130 | tpr=0.3885 | fpr=0.8920 | 7472.7 samples/s | 29.2 steps/s
[Step= 500] | Loss=5.87780 | acc=0.1129 | tpr=0.3916 | fpr=0.8921 | 7828.1 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.87962 | acc=0.1130 | tpr=0.3912 | fpr=0.8921 | 14609.9 samples/s | 57.1 steps/s
Avg test loss: 5.88031, Avg test acc: 0.11293, Avg tpr: 0.39144, Avg fpr: 0.89213, total FA: 123871

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.11929 | acc=0.1445 | tpr=0.3363 | fpr=0.8590 | 4165.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=5.06734 | acc=0.1455 | tpr=0.3433 | fpr=0.8581 | 7846.6 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.07059 | acc=0.1452 | tpr=0.3545 | fpr=0.8587 | 7852.4 samples/s | 30.7 steps/s
[Step= 200] | Loss=5.06568 | acc=0.1458 | tpr=0.3530 | fpr=0.8579 | 8070.2 samples/s | 31.5 steps/s
[Step= 250] | Loss=5.06434 | acc=0.1455 | tpr=0.3450 | fpr=0.8581 | 7785.1 samples/s | 30.4 steps/s
[Step= 300] | Loss=5.07012 | acc=0.1448 | tpr=0.3462 | fpr=0.8589 | 7756.7 samples/s | 30.3 steps/s
[Step= 350] | Loss=5.08009 | acc=0.1442 | tpr=0.3431 | fpr=0.8594 | 7956.4 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.07292 | acc=0.1438 | tpr=0.3353 | fpr=0.8597 | 7873.3 samples/s | 30.8 steps/s
[Step= 450] | Loss=5.07308 | acc=0.1432 | tpr=0.3340 | fpr=0.8603 | 7720.1 samples/s | 30.2 steps/s
[Step= 500] | Loss=5.07475 | acc=0.1429 | tpr=0.3348 | fpr=0.8606 | 7753.2 samples/s | 30.3 steps/s
[Step= 550] | Loss=5.07767 | acc=0.1430 | tpr=0.3351 | fpr=0.8605 | 15383.6 samples/s | 60.1 steps/s
Avg test loss: 5.07800, Avg test acc: 0.14289, Avg tpr: 0.33439, Avg fpr: 0.86059, total FA: 119491

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12124 | acc=0.9802 | tpr=0.9292 | fpr=0.0188 | 4142.6 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.12797 | acc=0.9792 | tpr=0.9446 | fpr=0.0201 | 7836.7 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.12950 | acc=0.9790 | tpr=0.9481 | fpr=0.0204 | 7902.4 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.13084 | acc=0.9792 | tpr=0.9508 | fpr=0.0203 | 7676.1 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.13038 | acc=0.9790 | tpr=0.9511 | fpr=0.0205 | 7658.5 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.13281 | acc=0.9789 | tpr=0.9527 | fpr=0.0207 | 7834.0 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.13283 | acc=0.9789 | tpr=0.9524 | fpr=0.0206 | 8021.3 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.13414 | acc=0.9786 | tpr=0.9513 | fpr=0.0209 | 7904.3 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.13579 | acc=0.9785 | tpr=0.9499 | fpr=0.0210 | 7645.4 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.13482 | acc=0.9787 | tpr=0.9511 | fpr=0.0208 | 7611.9 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.13369 | acc=0.9789 | tpr=0.9526 | fpr=0.0207 | 14477.9 samples/s | 56.6 steps/s
Avg test loss: 0.13336, Avg test acc: 0.97890, Avg tpr: 0.95285, Avg fpr: 0.02063, total FA: 2864

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14624 | acc=0.9785 | tpr=0.9381 | fpr=0.0208 | 4028.1 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.15420 | acc=0.9774 | tpr=0.9574 | fpr=0.0222 | 8022.8 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.15604 | acc=0.9770 | tpr=0.9625 | fpr=0.0228 | 7929.4 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.15769 | acc=0.9773 | tpr=0.9639 | fpr=0.0225 | 7838.2 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.15731 | acc=0.9771 | tpr=0.9633 | fpr=0.0227 | 7750.3 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.16044 | acc=0.9767 | tpr=0.9644 | fpr=0.0231 | 8048.1 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.16060 | acc=0.9767 | tpr=0.9643 | fpr=0.0231 | 7667.0 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.16212 | acc=0.9764 | tpr=0.9623 | fpr=0.0233 | 7901.1 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.16401 | acc=0.9762 | tpr=0.9596 | fpr=0.0235 | 7961.1 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.16297 | acc=0.9763 | tpr=0.9612 | fpr=0.0234 | 7378.9 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.16171 | acc=0.9766 | tpr=0.9622 | fpr=0.0232 | 15182.8 samples/s | 59.3 steps/s
Avg test loss: 0.16133, Avg test acc: 0.97660, Avg tpr: 0.96236, Avg fpr: 0.02314, total FA: 3213

server round 36/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=72001 Epoch=140.4] | Loss=0.00533 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=19.026 | 4425.1 samples/s | 69.1 steps/s
[Step=72050 Epoch=140.5] | Loss=0.00730 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=19.031 | 5253.4 samples/s | 82.1 steps/s
[Step=72100 Epoch=140.6] | Loss=0.00652 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.247 | L2-Norm(final)=19.037 | 5565.6 samples/s | 87.0 steps/s
[Step=72150 Epoch=140.7] | Loss=0.00683 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=19.043 | 5484.8 samples/s | 85.7 steps/s
[Step=72200 Epoch=140.8] | Loss=0.00720 | Reg=0.00105 | acc=0.9688 | L2-Norm=10.247 | L2-Norm(final)=19.048 | 5563.8 samples/s | 86.9 steps/s
[Step=72250 Epoch=140.9] | Loss=0.00727 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.247 | L2-Norm(final)=19.054 | 5433.3 samples/s | 84.9 steps/s
[Step=72300 Epoch=141.0] | Loss=0.00734 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.247 | L2-Norm(final)=19.060 | 5592.4 samples/s | 87.4 steps/s
[Step=72350 Epoch=141.1] | Loss=0.00764 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=19.066 | 5510.2 samples/s | 86.1 steps/s
[Step=72400 Epoch=141.2] | Loss=0.00766 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=19.071 | 5568.1 samples/s | 87.0 steps/s
[Step=72450 Epoch=141.3] | Loss=0.00761 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=19.077 | 5594.3 samples/s | 87.4 steps/s
[Step=72500 Epoch=141.4] | Loss=0.00749 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=19.083 | 6985.1 samples/s | 109.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=72501 Epoch=141.4] | Loss=0.01909 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.247 | L2-Norm(final)=19.140 | 4615.1 samples/s | 72.1 steps/s
[Step=72550 Epoch=141.5] | Loss=0.00775 | Reg=0.00105 | acc=0.9688 | L2-Norm=10.256 | L2-Norm(final)=19.144 | 4478.9 samples/s | 70.0 steps/s
[Step=72600 Epoch=141.6] | Loss=0.00840 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.268 | L2-Norm(final)=19.146 | 4744.4 samples/s | 74.1 steps/s
[Step=72650 Epoch=141.7] | Loss=0.00904 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.276 | L2-Norm(final)=19.148 | 4821.3 samples/s | 75.3 steps/s
[Step=72700 Epoch=141.8] | Loss=0.00911 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.283 | L2-Norm(final)=19.150 | 4796.6 samples/s | 74.9 steps/s
[Step=72750 Epoch=141.9] | Loss=0.00913 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.289 | L2-Norm(final)=19.152 | 4791.6 samples/s | 74.9 steps/s
[Step=72800 Epoch=142.0] | Loss=0.00903 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.294 | L2-Norm(final)=19.154 | 4825.4 samples/s | 75.4 steps/s
[Step=72850 Epoch=142.1] | Loss=0.00861 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.299 | L2-Norm(final)=19.156 | 4778.0 samples/s | 74.7 steps/s
[Step=72900 Epoch=142.2] | Loss=0.00862 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.304 | L2-Norm(final)=19.159 | 4765.7 samples/s | 74.5 steps/s
[Step=72950 Epoch=142.3] | Loss=0.00841 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.309 | L2-Norm(final)=19.162 | 4814.2 samples/s | 75.2 steps/s
[Step=73000 Epoch=142.4] | Loss=0.00810 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.314 | L2-Norm(final)=19.165 | 5855.3 samples/s | 91.5 steps/s
[Step=73050 Epoch=142.5] | Loss=0.00803 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.318 | L2-Norm(final)=19.167 | 2002.7 samples/s | 31.3 steps/s
[Step=73100 Epoch=142.6] | Loss=0.00784 | Reg=0.00107 | acc=0.9688 | L2-Norm=10.322 | L2-Norm(final)=19.170 | 4716.7 samples/s | 73.7 steps/s
[Step=73150 Epoch=142.7] | Loss=0.00775 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.325 | L2-Norm(final)=19.173 | 4815.9 samples/s | 75.2 steps/s
[Step=73200 Epoch=142.8] | Loss=0.00759 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.329 | L2-Norm(final)=19.175 | 4774.7 samples/s | 74.6 steps/s
[Step=73250 Epoch=142.9] | Loss=0.00758 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.332 | L2-Norm(final)=19.177 | 4787.8 samples/s | 74.8 steps/s
[Step=73300 Epoch=143.0] | Loss=0.00751 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.335 | L2-Norm(final)=19.180 | 4810.9 samples/s | 75.2 steps/s
[Step=73350 Epoch=143.1] | Loss=0.00735 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.338 | L2-Norm(final)=19.182 | 4763.8 samples/s | 74.4 steps/s
[Step=73400 Epoch=143.2] | Loss=0.00729 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.341 | L2-Norm(final)=19.184 | 4829.0 samples/s | 75.5 steps/s
[Step=73450 Epoch=143.3] | Loss=0.00724 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.344 | L2-Norm(final)=19.186 | 4804.2 samples/s | 75.1 steps/s
[Step=73500 Epoch=143.4] | Loss=0.00717 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.347 | L2-Norm(final)=19.188 | 5008.2 samples/s | 78.3 steps/s
[Step=73550 Epoch=143.5] | Loss=0.00704 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.349 | L2-Norm(final)=19.190 | 2191.5 samples/s | 34.2 steps/s
[Step=73600 Epoch=143.5] | Loss=0.00694 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.352 | L2-Norm(final)=19.193 | 4804.2 samples/s | 75.1 steps/s
[Step=73650 Epoch=143.6] | Loss=0.00689 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.354 | L2-Norm(final)=19.195 | 4846.6 samples/s | 75.7 steps/s
[Step=73700 Epoch=143.7] | Loss=0.00686 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.357 | L2-Norm(final)=19.197 | 4724.4 samples/s | 73.8 steps/s
[Step=73750 Epoch=143.8] | Loss=0.00672 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=19.199 | 4760.1 samples/s | 74.4 steps/s
[Step=73800 Epoch=143.9] | Loss=0.00675 | Reg=0.00107 | acc=0.9688 | L2-Norm=10.361 | L2-Norm(final)=19.201 | 4829.0 samples/s | 75.5 steps/s
[Step=73850 Epoch=144.0] | Loss=0.00667 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.363 | L2-Norm(final)=19.203 | 4789.3 samples/s | 74.8 steps/s
[Step=73900 Epoch=144.1] | Loss=0.00661 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.366 | L2-Norm(final)=19.205 | 4808.4 samples/s | 75.1 steps/s
[Step=73950 Epoch=144.2] | Loss=0.00658 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.368 | L2-Norm(final)=19.207 | 4794.3 samples/s | 74.9 steps/s
[Step=74000 Epoch=144.3] | Loss=0.00651 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.370 | L2-Norm(final)=19.209 | 4841.3 samples/s | 75.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step74000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=72001 Epoch=140.8] | Loss=0.00686 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=19.159 | 4540.1 samples/s | 70.9 steps/s
[Step=72050 Epoch=140.9] | Loss=0.00601 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=19.165 | 5251.8 samples/s | 82.1 steps/s
[Step=72100 Epoch=141.0] | Loss=0.00675 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=19.172 | 5571.5 samples/s | 87.1 steps/s
[Step=72150 Epoch=141.1] | Loss=0.00684 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=19.179 | 5150.0 samples/s | 80.5 steps/s
[Step=72200 Epoch=141.1] | Loss=0.00698 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=19.186 | 4871.8 samples/s | 76.1 steps/s
[Step=72250 Epoch=141.2] | Loss=0.00706 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.247 | L2-Norm(final)=19.193 | 5250.0 samples/s | 82.0 steps/s
[Step=72300 Epoch=141.3] | Loss=0.00687 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=19.200 | 5412.4 samples/s | 84.6 steps/s
[Step=72350 Epoch=141.4] | Loss=0.00674 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=19.206 | 5593.6 samples/s | 87.4 steps/s
[Step=72400 Epoch=141.5] | Loss=0.00676 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=19.212 | 5517.4 samples/s | 86.2 steps/s
[Step=72450 Epoch=141.6] | Loss=0.00679 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=19.219 | 5587.3 samples/s | 87.3 steps/s
[Step=72500 Epoch=141.7] | Loss=0.00673 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=19.225 | 6911.7 samples/s | 108.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=72501 Epoch=141.7] | Loss=0.00371 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=19.288 | 4805.3 samples/s | 75.1 steps/s
[Step=72550 Epoch=141.8] | Loss=0.00685 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.255 | L2-Norm(final)=19.293 | 4706.6 samples/s | 73.5 steps/s
[Step=72600 Epoch=141.9] | Loss=0.00773 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.265 | L2-Norm(final)=19.296 | 4829.8 samples/s | 75.5 steps/s
[Step=72650 Epoch=142.0] | Loss=0.00747 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.271 | L2-Norm(final)=19.298 | 4778.6 samples/s | 74.7 steps/s
[Step=72700 Epoch=142.1] | Loss=0.00726 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.277 | L2-Norm(final)=19.302 | 4742.8 samples/s | 74.1 steps/s
[Step=72750 Epoch=142.2] | Loss=0.00682 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.283 | L2-Norm(final)=19.305 | 4777.9 samples/s | 74.7 steps/s
[Step=72800 Epoch=142.3] | Loss=0.00697 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.289 | L2-Norm(final)=19.309 | 4758.3 samples/s | 74.3 steps/s
[Step=72850 Epoch=142.4] | Loss=0.00685 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.294 | L2-Norm(final)=19.312 | 4790.6 samples/s | 74.9 steps/s
[Step=72900 Epoch=142.5] | Loss=0.00697 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.298 | L2-Norm(final)=19.315 | 4787.7 samples/s | 74.8 steps/s
[Step=72950 Epoch=142.6] | Loss=0.00705 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.303 | L2-Norm(final)=19.318 | 4785.5 samples/s | 74.8 steps/s
[Step=73000 Epoch=142.7] | Loss=0.00723 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.307 | L2-Norm(final)=19.321 | 5932.5 samples/s | 92.7 steps/s
[Step=73050 Epoch=142.8] | Loss=0.00702 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.311 | L2-Norm(final)=19.324 | 2098.2 samples/s | 32.8 steps/s
[Step=73100 Epoch=142.9] | Loss=0.00687 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.315 | L2-Norm(final)=19.327 | 4774.3 samples/s | 74.6 steps/s
[Step=73150 Epoch=143.0] | Loss=0.00675 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.319 | L2-Norm(final)=19.330 | 4767.5 samples/s | 74.5 steps/s
[Step=73200 Epoch=143.1] | Loss=0.00677 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.322 | L2-Norm(final)=19.333 | 4817.6 samples/s | 75.3 steps/s
[Step=73250 Epoch=143.2] | Loss=0.00662 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.325 | L2-Norm(final)=19.335 | 4728.3 samples/s | 73.9 steps/s
[Step=73300 Epoch=143.3] | Loss=0.00663 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.328 | L2-Norm(final)=19.338 | 4800.3 samples/s | 75.0 steps/s
[Step=73350 Epoch=143.4] | Loss=0.00661 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.331 | L2-Norm(final)=19.340 | 4804.7 samples/s | 75.1 steps/s
[Step=73400 Epoch=143.5] | Loss=0.00659 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.334 | L2-Norm(final)=19.342 | 4651.0 samples/s | 72.7 steps/s
[Step=73450 Epoch=143.6] | Loss=0.00651 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.337 | L2-Norm(final)=19.344 | 4640.7 samples/s | 72.5 steps/s
[Step=73500 Epoch=143.7] | Loss=0.00638 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.339 | L2-Norm(final)=19.347 | 5174.4 samples/s | 80.9 steps/s
[Step=73550 Epoch=143.8] | Loss=0.00633 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.342 | L2-Norm(final)=19.349 | 2202.3 samples/s | 34.4 steps/s
[Step=73600 Epoch=143.9] | Loss=0.00621 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.344 | L2-Norm(final)=19.351 | 4696.4 samples/s | 73.4 steps/s
[Step=73650 Epoch=144.0] | Loss=0.00607 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.347 | L2-Norm(final)=19.354 | 4764.6 samples/s | 74.4 steps/s
[Step=73700 Epoch=144.1] | Loss=0.00599 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.349 | L2-Norm(final)=19.356 | 4807.1 samples/s | 75.1 steps/s
[Step=73750 Epoch=144.2] | Loss=0.00598 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.351 | L2-Norm(final)=19.358 | 4779.6 samples/s | 74.7 steps/s
[Step=73800 Epoch=144.3] | Loss=0.00604 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.353 | L2-Norm(final)=19.360 | 4795.6 samples/s | 74.9 steps/s
[Step=73850 Epoch=144.4] | Loss=0.00604 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.355 | L2-Norm(final)=19.362 | 4801.5 samples/s | 75.0 steps/s
[Step=73900 Epoch=144.5] | Loss=0.00603 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.357 | L2-Norm(final)=19.364 | 4800.9 samples/s | 75.0 steps/s
[Step=73950 Epoch=144.6] | Loss=0.00596 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=19.366 | 4767.4 samples/s | 74.5 steps/s
[Step=74000 Epoch=144.7] | Loss=0.00596 | Reg=0.00107 | acc=0.9688 | L2-Norm=10.361 | L2-Norm(final)=19.368 | 4829.8 samples/s | 75.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step74000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=72001 Epoch=275.9] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=17.448 | 4353.0 samples/s | 68.0 steps/s
[Step=72050 Epoch=276.1] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=17.451 | 5126.8 samples/s | 80.1 steps/s
[Step=72100 Epoch=276.3] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=17.454 | 5183.6 samples/s | 81.0 steps/s
[Step=72150 Epoch=276.5] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=17.458 | 5142.6 samples/s | 80.4 steps/s
[Step=72200 Epoch=276.6] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=17.462 | 5200.5 samples/s | 81.3 steps/s
[Step=72250 Epoch=276.8] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=17.466 | 6907.7 samples/s | 107.9 steps/s
[Step=72300 Epoch=277.0] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=17.470 | 2111.9 samples/s | 33.0 steps/s
[Step=72350 Epoch=277.2] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=17.474 | 5161.5 samples/s | 80.6 steps/s
[Step=72400 Epoch=277.4] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=17.478 | 5191.0 samples/s | 81.1 steps/s
[Step=72450 Epoch=277.6] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=17.481 | 5175.8 samples/s | 80.9 steps/s
[Step=72500 Epoch=277.8] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=17.485 | 5884.8 samples/s | 92.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=72501 Epoch=277.8] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=17.525 | 4901.4 samples/s | 76.6 steps/s
[Step=72550 Epoch=278.0] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.233 | L2-Norm(final)=17.528 | 4161.0 samples/s | 65.0 steps/s
[Step=72600 Epoch=278.2] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.219 | L2-Norm(final)=17.531 | 4418.9 samples/s | 69.0 steps/s
[Step=72650 Epoch=278.4] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.206 | L2-Norm(final)=17.533 | 4432.3 samples/s | 69.3 steps/s
[Step=72700 Epoch=278.6] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.191 | L2-Norm(final)=17.534 | 4175.4 samples/s | 65.2 steps/s
[Step=72750 Epoch=278.8] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.177 | L2-Norm(final)=17.536 | 5177.0 samples/s | 80.9 steps/s
[Step=72800 Epoch=278.9] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=17.537 | 1932.0 samples/s | 30.2 steps/s
[Step=72850 Epoch=279.1] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.147 | L2-Norm(final)=17.539 | 4444.7 samples/s | 69.4 steps/s
[Step=72900 Epoch=279.3] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.132 | L2-Norm(final)=17.540 | 4585.9 samples/s | 71.7 steps/s
[Step=72950 Epoch=279.5] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.117 | L2-Norm(final)=17.541 | 4476.6 samples/s | 69.9 steps/s
[Step=73000 Epoch=279.7] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.102 | L2-Norm(final)=17.543 | 5024.9 samples/s | 78.5 steps/s
[Step=73050 Epoch=279.9] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.086 | L2-Norm(final)=17.544 | 2082.0 samples/s | 32.5 steps/s
[Step=73100 Epoch=280.1] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.071 | L2-Norm(final)=17.545 | 4579.8 samples/s | 71.6 steps/s
[Step=73150 Epoch=280.3] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.056 | L2-Norm(final)=17.547 | 4525.7 samples/s | 70.7 steps/s
[Step=73200 Epoch=280.5] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.040 | L2-Norm(final)=17.548 | 4591.7 samples/s | 71.7 steps/s
[Step=73250 Epoch=280.7] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.024 | L2-Norm(final)=17.550 | 4510.4 samples/s | 70.5 steps/s
[Step=73300 Epoch=280.9] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.009 | L2-Norm(final)=17.551 | 2193.4 samples/s | 34.3 steps/s
[Step=73350 Epoch=281.1] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.993 | L2-Norm(final)=17.552 | 4634.8 samples/s | 72.4 steps/s
[Step=73400 Epoch=281.2] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.977 | L2-Norm(final)=17.554 | 4481.8 samples/s | 70.0 steps/s
[Step=73450 Epoch=281.4] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.961 | L2-Norm(final)=17.555 | 4535.7 samples/s | 70.9 steps/s
[Step=73500 Epoch=281.6] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.945 | L2-Norm(final)=17.557 | 4613.0 samples/s | 72.1 steps/s
[Step=73550 Epoch=281.8] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.929 | L2-Norm(final)=17.559 | 2215.5 samples/s | 34.6 steps/s
[Step=73600 Epoch=282.0] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.912 | L2-Norm(final)=17.560 | 4521.1 samples/s | 70.6 steps/s
[Step=73650 Epoch=282.2] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.896 | L2-Norm(final)=17.562 | 4626.7 samples/s | 72.3 steps/s
[Step=73700 Epoch=282.4] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.879 | L2-Norm(final)=17.564 | 4485.8 samples/s | 70.1 steps/s
[Step=73750 Epoch=282.6] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.862 | L2-Norm(final)=17.565 | 4567.8 samples/s | 71.4 steps/s
[Step=73800 Epoch=282.8] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.846 | L2-Norm(final)=17.567 | 6162.6 samples/s | 96.3 steps/s
[Step=73850 Epoch=283.0] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.829 | L2-Norm(final)=17.569 | 1949.9 samples/s | 30.5 steps/s
[Step=73900 Epoch=283.2] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.811 | L2-Norm(final)=17.571 | 4533.2 samples/s | 70.8 steps/s
[Step=73950 Epoch=283.4] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.794 | L2-Norm(final)=17.573 | 4617.6 samples/s | 72.1 steps/s
[Step=74000 Epoch=283.5] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.777 | L2-Norm(final)=17.575 | 4437.3 samples/s | 69.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step74000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=72001 Epoch=277.2] | Loss=0.00004 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=18.213 | 4546.6 samples/s | 71.0 steps/s
[Step=72050 Epoch=277.3] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.244 | L2-Norm(final)=18.217 | 4853.3 samples/s | 75.8 steps/s
[Step=72100 Epoch=277.5] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.244 | L2-Norm(final)=18.221 | 5126.0 samples/s | 80.1 steps/s
[Step=72150 Epoch=277.7] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.244 | L2-Norm(final)=18.225 | 5209.0 samples/s | 81.4 steps/s
[Step=72200 Epoch=277.9] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.244 | L2-Norm(final)=18.228 | 5222.5 samples/s | 81.6 steps/s
[Step=72250 Epoch=278.1] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=18.232 | 6983.6 samples/s | 109.1 steps/s
[Step=72300 Epoch=278.3] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=18.236 | 2097.9 samples/s | 32.8 steps/s
[Step=72350 Epoch=278.5] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=18.240 | 5255.6 samples/s | 82.1 steps/s
[Step=72400 Epoch=278.7] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=18.244 | 5293.2 samples/s | 82.7 steps/s
[Step=72450 Epoch=278.9] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=18.248 | 5230.3 samples/s | 81.7 steps/s
[Step=72500 Epoch=279.1] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=18.251 | 5911.1 samples/s | 92.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=72501 Epoch=279.1] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=18.290 | 4439.8 samples/s | 69.4 steps/s
[Step=72550 Epoch=279.3] | Loss=0.00003 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.238 | L2-Norm(final)=18.293 | 4424.3 samples/s | 69.1 steps/s
[Step=72600 Epoch=279.5] | Loss=0.00004 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.238 | L2-Norm(final)=18.294 | 4509.7 samples/s | 70.5 steps/s
[Step=72650 Epoch=279.7] | Loss=0.00003 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.234 | L2-Norm(final)=18.295 | 4505.9 samples/s | 70.4 steps/s
[Step=72700 Epoch=279.9] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=18.297 | 4596.9 samples/s | 71.8 steps/s
[Step=72750 Epoch=280.0] | Loss=0.00002 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.221 | L2-Norm(final)=18.298 | 5674.3 samples/s | 88.7 steps/s
[Step=72800 Epoch=280.2] | Loss=0.00002 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.213 | L2-Norm(final)=18.299 | 2018.8 samples/s | 31.5 steps/s
[Step=72850 Epoch=280.4] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.204 | L2-Norm(final)=18.300 | 4564.3 samples/s | 71.3 steps/s
[Step=72900 Epoch=280.6] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.196 | L2-Norm(final)=18.301 | 4485.9 samples/s | 70.1 steps/s
[Step=72950 Epoch=280.8] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.187 | L2-Norm(final)=18.302 | 4486.3 samples/s | 70.1 steps/s
[Step=73000 Epoch=281.0] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.178 | L2-Norm(final)=18.303 | 5202.0 samples/s | 81.3 steps/s
[Step=73050 Epoch=281.2] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.169 | L2-Norm(final)=18.303 | 2080.5 samples/s | 32.5 steps/s
[Step=73100 Epoch=281.4] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.159 | L2-Norm(final)=18.304 | 4551.0 samples/s | 71.1 steps/s
[Step=73150 Epoch=281.6] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.150 | L2-Norm(final)=18.304 | 4576.5 samples/s | 71.5 steps/s
[Step=73200 Epoch=281.8] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.140 | L2-Norm(final)=18.305 | 4546.5 samples/s | 71.0 steps/s
[Step=73250 Epoch=282.0] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.130 | L2-Norm(final)=18.306 | 4616.6 samples/s | 72.1 steps/s
[Step=73300 Epoch=282.2] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.120 | L2-Norm(final)=18.306 | 2176.3 samples/s | 34.0 steps/s
[Step=73350 Epoch=282.4] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.110 | L2-Norm(final)=18.307 | 4626.4 samples/s | 72.3 steps/s
[Step=73400 Epoch=282.5] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.100 | L2-Norm(final)=18.308 | 4571.1 samples/s | 71.4 steps/s
[Step=73450 Epoch=282.7] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.089 | L2-Norm(final)=18.308 | 4660.7 samples/s | 72.8 steps/s
[Step=73500 Epoch=282.9] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.079 | L2-Norm(final)=18.309 | 4473.3 samples/s | 69.9 steps/s
[Step=73550 Epoch=283.1] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.068 | L2-Norm(final)=18.309 | 2212.7 samples/s | 34.6 steps/s
[Step=73600 Epoch=283.3] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.058 | L2-Norm(final)=18.310 | 4564.8 samples/s | 71.3 steps/s
[Step=73650 Epoch=283.5] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.047 | L2-Norm(final)=18.311 | 4513.8 samples/s | 70.5 steps/s
[Step=73700 Epoch=283.7] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.036 | L2-Norm(final)=18.311 | 4546.3 samples/s | 71.0 steps/s
[Step=73750 Epoch=283.9] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=18.312 | 4521.4 samples/s | 70.6 steps/s
[Step=73800 Epoch=284.1] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=18.313 | 6634.2 samples/s | 103.7 steps/s
[Step=73850 Epoch=284.3] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.002 | L2-Norm(final)=18.313 | 1912.1 samples/s | 29.9 steps/s
[Step=73900 Epoch=284.5] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.991 | L2-Norm(final)=18.314 | 4506.2 samples/s | 70.4 steps/s
[Step=73950 Epoch=284.7] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=18.315 | 4600.6 samples/s | 71.9 steps/s
[Step=74000 Epoch=284.9] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.967 | L2-Norm(final)=18.316 | 4610.9 samples/s | 72.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step74000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07994 | acc=0.9695 | tpr=0.9777 | fpr=0.0486 | 4118.9 samples/s | 16.1 steps/s
Avg test loss: 0.07889, Avg test acc: 0.96923, Avg tpr: 0.97744, Avg fpr: 0.04884, total FA: 381

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07743 | acc=0.9699 | tpr=0.9763 | fpr=0.0439 | 4266.7 samples/s | 16.7 steps/s
Avg test loss: 0.07725, Avg test acc: 0.97003, Avg tpr: 0.97739, Avg fpr: 0.04615, total FA: 360

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.44271 | acc=0.3048 | tpr=0.0056 | fpr=0.0456 | 4188.4 samples/s | 16.4 steps/s
Avg test loss: 6.45471, Avg test acc: 0.30103, Avg tpr: 0.00577, Avg fpr: 0.04961, total FA: 387

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.21122 | acc=0.2923 | tpr=0.0067 | fpr=0.0877 | 4151.5 samples/s | 16.2 steps/s
Avg test loss: 6.22496, Avg test acc: 0.28937, Avg tpr: 0.00676, Avg fpr: 0.08909, total FA: 695

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.98252 | acc=0.1191 | tpr=0.4336 | fpr=0.8866 | 4116.5 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.91775 | acc=0.1186 | tpr=0.4243 | fpr=0.8871 | 8221.9 samples/s | 32.1 steps/s
[Step= 150] | Loss=5.92397 | acc=0.1177 | tpr=0.4251 | fpr=0.8879 | 7662.4 samples/s | 29.9 steps/s
[Step= 200] | Loss=5.92058 | acc=0.1183 | tpr=0.4175 | fpr=0.8871 | 7696.1 samples/s | 30.1 steps/s
[Step= 250] | Loss=5.92045 | acc=0.1182 | tpr=0.4087 | fpr=0.8871 | 7964.5 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.92653 | acc=0.1173 | tpr=0.3978 | fpr=0.8879 | 7832.0 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.93596 | acc=0.1168 | tpr=0.3932 | fpr=0.8882 | 7851.4 samples/s | 30.7 steps/s
[Step= 400] | Loss=5.92795 | acc=0.1165 | tpr=0.3835 | fpr=0.8883 | 7919.5 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.92978 | acc=0.1160 | tpr=0.3807 | fpr=0.8888 | 7692.5 samples/s | 30.0 steps/s
[Step= 500] | Loss=5.93216 | acc=0.1158 | tpr=0.3837 | fpr=0.8890 | 7864.1 samples/s | 30.7 steps/s
[Step= 550] | Loss=5.93408 | acc=0.1158 | tpr=0.3820 | fpr=0.8890 | 14962.4 samples/s | 58.4 steps/s
Avg test loss: 5.93456, Avg test acc: 0.11577, Avg tpr: 0.38193, Avg fpr: 0.88907, total FA: 123446

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.76036 | acc=0.1355 | tpr=0.3761 | fpr=0.8689 | 4161.8 samples/s | 16.3 steps/s
[Step= 100] | Loss=5.70046 | acc=0.1361 | tpr=0.3774 | fpr=0.8684 | 7889.9 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.70773 | acc=0.1354 | tpr=0.3905 | fpr=0.8693 | 7775.3 samples/s | 30.4 steps/s
[Step= 200] | Loss=5.70385 | acc=0.1352 | tpr=0.3858 | fpr=0.8694 | 7819.9 samples/s | 30.5 steps/s
[Step= 250] | Loss=5.70288 | acc=0.1350 | tpr=0.3782 | fpr=0.8695 | 7757.8 samples/s | 30.3 steps/s
[Step= 300] | Loss=5.70965 | acc=0.1343 | tpr=0.3760 | fpr=0.8701 | 8214.0 samples/s | 32.1 steps/s
[Step= 350] | Loss=5.72018 | acc=0.1340 | tpr=0.3719 | fpr=0.8704 | 7713.4 samples/s | 30.1 steps/s
[Step= 400] | Loss=5.71232 | acc=0.1335 | tpr=0.3632 | fpr=0.8707 | 7882.1 samples/s | 30.8 steps/s
[Step= 450] | Loss=5.71278 | acc=0.1330 | tpr=0.3603 | fpr=0.8711 | 7754.2 samples/s | 30.3 steps/s
[Step= 500] | Loss=5.71501 | acc=0.1327 | tpr=0.3621 | fpr=0.8714 | 7686.2 samples/s | 30.0 steps/s
[Step= 550] | Loss=5.71763 | acc=0.1329 | tpr=0.3637 | fpr=0.8713 | 14549.2 samples/s | 56.8 steps/s
Avg test loss: 5.71811, Avg test acc: 0.13281, Avg tpr: 0.36292, Avg fpr: 0.87138, total FA: 120989

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11808 | acc=0.9801 | tpr=0.9248 | fpr=0.0189 | 4151.0 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.12466 | acc=0.9791 | tpr=0.9446 | fpr=0.0202 | 7896.4 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.12646 | acc=0.9789 | tpr=0.9467 | fpr=0.0206 | 7957.8 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.12804 | acc=0.9789 | tpr=0.9497 | fpr=0.0206 | 8015.8 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.12764 | acc=0.9787 | tpr=0.9502 | fpr=0.0208 | 8031.5 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.12986 | acc=0.9786 | tpr=0.9527 | fpr=0.0209 | 7622.1 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.12973 | acc=0.9786 | tpr=0.9537 | fpr=0.0210 | 7906.0 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.13093 | acc=0.9783 | tpr=0.9524 | fpr=0.0212 | 7711.9 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.13260 | acc=0.9781 | tpr=0.9508 | fpr=0.0214 | 7888.6 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.13172 | acc=0.9782 | tpr=0.9524 | fpr=0.0213 | 7553.7 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.13065 | acc=0.9785 | tpr=0.9542 | fpr=0.0211 | 14774.2 samples/s | 57.7 steps/s
Avg test loss: 0.13033, Avg test acc: 0.97849, Avg tpr: 0.95444, Avg fpr: 0.02107, total FA: 2926

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13690 | acc=0.9782 | tpr=0.9381 | fpr=0.0211 | 4036.0 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.14499 | acc=0.9777 | tpr=0.9638 | fpr=0.0220 | 7817.1 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.14665 | acc=0.9773 | tpr=0.9669 | fpr=0.0225 | 7941.5 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.14834 | acc=0.9774 | tpr=0.9683 | fpr=0.0225 | 7757.8 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.14836 | acc=0.9772 | tpr=0.9677 | fpr=0.0226 | 7904.1 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.15131 | acc=0.9769 | tpr=0.9680 | fpr=0.0229 | 7890.5 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.15147 | acc=0.9771 | tpr=0.9674 | fpr=0.0228 | 7789.7 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.15297 | acc=0.9767 | tpr=0.9650 | fpr=0.0231 | 8034.9 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.15489 | acc=0.9766 | tpr=0.9620 | fpr=0.0232 | 7698.3 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.15403 | acc=0.9767 | tpr=0.9634 | fpr=0.0231 | 7678.8 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.15290 | acc=0.9769 | tpr=0.9642 | fpr=0.0229 | 14319.0 samples/s | 55.9 steps/s
Avg test loss: 0.15257, Avg test acc: 0.97693, Avg tpr: 0.96434, Avg fpr: 0.02285, total FA: 3172

server round 37/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=74001 Epoch=144.3] | Loss=0.00566 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=19.269 | 4014.1 samples/s | 62.7 steps/s
[Step=74050 Epoch=144.4] | Loss=0.00726 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=19.280 | 5213.8 samples/s | 81.5 steps/s
[Step=74100 Epoch=144.5] | Loss=0.00807 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.890 | L2-Norm(final)=19.290 | 5543.0 samples/s | 86.6 steps/s
[Step=74150 Epoch=144.6] | Loss=0.00800 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=19.299 | 5566.9 samples/s | 87.0 steps/s
[Step=74200 Epoch=144.7] | Loss=0.00834 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=19.307 | 5549.0 samples/s | 86.7 steps/s
[Step=74250 Epoch=144.8] | Loss=0.00842 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.890 | L2-Norm(final)=19.316 | 5501.1 samples/s | 86.0 steps/s
[Step=74300 Epoch=144.9] | Loss=0.00828 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=19.324 | 5627.6 samples/s | 87.9 steps/s
[Step=74350 Epoch=145.0] | Loss=0.00822 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.890 | L2-Norm(final)=19.332 | 5509.2 samples/s | 86.1 steps/s
[Step=74400 Epoch=145.1] | Loss=0.00835 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.890 | L2-Norm(final)=19.339 | 5566.0 samples/s | 87.0 steps/s
[Step=74450 Epoch=145.2] | Loss=0.00844 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.890 | L2-Norm(final)=19.347 | 5546.2 samples/s | 86.7 steps/s
[Step=74500 Epoch=145.3] | Loss=0.00856 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=19.355 | 6954.3 samples/s | 108.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=74501 Epoch=145.3] | Loss=0.00989 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=19.430 | 4662.2 samples/s | 72.8 steps/s
[Step=74550 Epoch=145.4] | Loss=0.00825 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.903 | L2-Norm(final)=19.436 | 4465.2 samples/s | 69.8 steps/s
[Step=74600 Epoch=145.5] | Loss=0.00848 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.915 | L2-Norm(final)=19.441 | 4716.5 samples/s | 73.7 steps/s
[Step=74650 Epoch=145.6] | Loss=0.00962 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.924 | L2-Norm(final)=19.445 | 4746.6 samples/s | 74.2 steps/s
[Step=74700 Epoch=145.7] | Loss=0.00929 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.931 | L2-Norm(final)=19.448 | 4745.3 samples/s | 74.1 steps/s
[Step=74750 Epoch=145.8] | Loss=0.00933 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.938 | L2-Norm(final)=19.451 | 4777.9 samples/s | 74.7 steps/s
[Step=74800 Epoch=145.9] | Loss=0.00898 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.945 | L2-Norm(final)=19.454 | 4818.5 samples/s | 75.3 steps/s
[Step=74850 Epoch=146.0] | Loss=0.00908 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.951 | L2-Norm(final)=19.457 | 4798.2 samples/s | 75.0 steps/s
[Step=74900 Epoch=146.1] | Loss=0.00899 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.957 | L2-Norm(final)=19.460 | 4814.6 samples/s | 75.2 steps/s
[Step=74950 Epoch=146.2] | Loss=0.00875 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.962 | L2-Norm(final)=19.464 | 4749.0 samples/s | 74.2 steps/s
[Step=75000 Epoch=146.3] | Loss=0.00869 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.967 | L2-Norm(final)=19.467 | 5874.4 samples/s | 91.8 steps/s
[Step=75050 Epoch=146.4] | Loss=0.00858 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.972 | L2-Norm(final)=19.470 | 1975.3 samples/s | 30.9 steps/s
[Step=75100 Epoch=146.5] | Loss=0.00829 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=19.474 | 4736.7 samples/s | 74.0 steps/s
[Step=75150 Epoch=146.6] | Loss=0.00811 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.980 | L2-Norm(final)=19.477 | 4838.1 samples/s | 75.6 steps/s
[Step=75200 Epoch=146.7] | Loss=0.00801 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.984 | L2-Norm(final)=19.480 | 4757.1 samples/s | 74.3 steps/s
[Step=75250 Epoch=146.8] | Loss=0.00788 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.988 | L2-Norm(final)=19.483 | 4838.2 samples/s | 75.6 steps/s
[Step=75300 Epoch=146.9] | Loss=0.00777 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.991 | L2-Norm(final)=19.486 | 4741.1 samples/s | 74.1 steps/s
[Step=75350 Epoch=147.0] | Loss=0.00769 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.994 | L2-Norm(final)=19.489 | 4787.0 samples/s | 74.8 steps/s
[Step=75400 Epoch=147.1] | Loss=0.00767 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.998 | L2-Norm(final)=19.491 | 4764.7 samples/s | 74.4 steps/s
[Step=75450 Epoch=147.2] | Loss=0.00762 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.001 | L2-Norm(final)=19.494 | 4816.9 samples/s | 75.3 steps/s
[Step=75500 Epoch=147.3] | Loss=0.00752 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.004 | L2-Norm(final)=19.497 | 5068.6 samples/s | 79.2 steps/s
[Step=75550 Epoch=147.4] | Loss=0.00743 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.007 | L2-Norm(final)=19.499 | 2107.3 samples/s | 32.9 steps/s
[Step=75600 Epoch=147.4] | Loss=0.00733 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=19.502 | 4854.1 samples/s | 75.8 steps/s
[Step=75650 Epoch=147.5] | Loss=0.00716 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.013 | L2-Norm(final)=19.505 | 4688.7 samples/s | 73.3 steps/s
[Step=75700 Epoch=147.6] | Loss=0.00707 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.016 | L2-Norm(final)=19.508 | 4802.3 samples/s | 75.0 steps/s
[Step=75750 Epoch=147.7] | Loss=0.00705 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.019 | L2-Norm(final)=19.510 | 4789.6 samples/s | 74.8 steps/s
[Step=75800 Epoch=147.8] | Loss=0.00702 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.021 | L2-Norm(final)=19.513 | 4835.0 samples/s | 75.5 steps/s
[Step=75850 Epoch=147.9] | Loss=0.00701 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.024 | L2-Norm(final)=19.515 | 4745.4 samples/s | 74.1 steps/s
[Step=75900 Epoch=148.0] | Loss=0.00698 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.027 | L2-Norm(final)=19.518 | 4810.1 samples/s | 75.2 steps/s
[Step=75950 Epoch=148.1] | Loss=0.00689 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.029 | L2-Norm(final)=19.520 | 4789.0 samples/s | 74.8 steps/s
[Step=76000 Epoch=148.2] | Loss=0.00687 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.032 | L2-Norm(final)=19.522 | 4787.7 samples/s | 74.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step76000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=74001 Epoch=144.7] | Loss=0.00709 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=19.429 | 4611.7 samples/s | 72.1 steps/s
[Step=74050 Epoch=144.8] | Loss=0.00964 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.890 | L2-Norm(final)=19.440 | 4576.6 samples/s | 71.5 steps/s
[Step=74100 Epoch=144.9] | Loss=0.00985 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.891 | L2-Norm(final)=19.454 | 5127.9 samples/s | 80.1 steps/s
[Step=74150 Epoch=145.0] | Loss=0.00990 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.891 | L2-Norm(final)=19.467 | 5454.9 samples/s | 85.2 steps/s
[Step=74200 Epoch=145.1] | Loss=0.00983 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.891 | L2-Norm(final)=19.479 | 5553.0 samples/s | 86.8 steps/s
[Step=74250 Epoch=145.2] | Loss=0.00997 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.891 | L2-Norm(final)=19.491 | 5595.5 samples/s | 87.4 steps/s
[Step=74300 Epoch=145.3] | Loss=0.01006 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.891 | L2-Norm(final)=19.502 | 5476.1 samples/s | 85.6 steps/s
[Step=74350 Epoch=145.4] | Loss=0.01031 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.891 | L2-Norm(final)=19.512 | 5664.2 samples/s | 88.5 steps/s
[Step=74400 Epoch=145.5] | Loss=0.01040 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.891 | L2-Norm(final)=19.521 | 5491.8 samples/s | 85.8 steps/s
[Step=74450 Epoch=145.5] | Loss=0.01019 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.891 | L2-Norm(final)=19.530 | 5632.5 samples/s | 88.0 steps/s
[Step=74500 Epoch=145.6] | Loss=0.01002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.891 | L2-Norm(final)=19.539 | 7048.4 samples/s | 110.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=74501 Epoch=145.6] | Loss=0.00762 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.891 | L2-Norm(final)=19.626 | 4780.0 samples/s | 74.7 steps/s
[Step=74550 Epoch=145.7] | Loss=0.01167 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=19.629 | 4573.2 samples/s | 71.5 steps/s
[Step=74600 Epoch=145.8] | Loss=0.01013 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.917 | L2-Norm(final)=19.633 | 4768.7 samples/s | 74.5 steps/s
[Step=74650 Epoch=145.9] | Loss=0.00997 | Reg=0.00099 | acc=0.9688 | L2-Norm=9.928 | L2-Norm(final)=19.637 | 4741.7 samples/s | 74.1 steps/s
[Step=74700 Epoch=146.0] | Loss=0.00983 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.936 | L2-Norm(final)=19.641 | 4751.0 samples/s | 74.2 steps/s
[Step=74750 Epoch=146.1] | Loss=0.00958 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.944 | L2-Norm(final)=19.645 | 4846.1 samples/s | 75.7 steps/s
[Step=74800 Epoch=146.2] | Loss=0.00909 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.951 | L2-Norm(final)=19.649 | 4700.1 samples/s | 73.4 steps/s
[Step=74850 Epoch=146.3] | Loss=0.00903 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.958 | L2-Norm(final)=19.653 | 4793.9 samples/s | 74.9 steps/s
[Step=74900 Epoch=146.4] | Loss=0.00904 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.964 | L2-Norm(final)=19.656 | 4833.8 samples/s | 75.5 steps/s
[Step=74950 Epoch=146.5] | Loss=0.00898 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.970 | L2-Norm(final)=19.659 | 4743.3 samples/s | 74.1 steps/s
[Step=75000 Epoch=146.6] | Loss=0.00865 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.975 | L2-Norm(final)=19.662 | 5891.3 samples/s | 92.1 steps/s
[Step=75050 Epoch=146.7] | Loss=0.00828 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.980 | L2-Norm(final)=19.665 | 2082.0 samples/s | 32.5 steps/s
[Step=75100 Epoch=146.8] | Loss=0.00805 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.984 | L2-Norm(final)=19.668 | 4723.1 samples/s | 73.8 steps/s
[Step=75150 Epoch=146.9] | Loss=0.00789 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.988 | L2-Norm(final)=19.671 | 4793.8 samples/s | 74.9 steps/s
[Step=75200 Epoch=147.0] | Loss=0.00782 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.992 | L2-Norm(final)=19.673 | 4795.0 samples/s | 74.9 steps/s
[Step=75250 Epoch=147.1] | Loss=0.00772 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.996 | L2-Norm(final)=19.676 | 4883.7 samples/s | 76.3 steps/s
[Step=75300 Epoch=147.2] | Loss=0.00753 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.000 | L2-Norm(final)=19.679 | 4843.7 samples/s | 75.7 steps/s
[Step=75350 Epoch=147.3] | Loss=0.00748 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.003 | L2-Norm(final)=19.681 | 4807.5 samples/s | 75.1 steps/s
[Step=75400 Epoch=147.4] | Loss=0.00749 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.007 | L2-Norm(final)=19.684 | 4658.2 samples/s | 72.8 steps/s
[Step=75450 Epoch=147.5] | Loss=0.00748 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=19.686 | 4843.2 samples/s | 75.7 steps/s
[Step=75500 Epoch=147.6] | Loss=0.00734 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.013 | L2-Norm(final)=19.689 | 5113.0 samples/s | 79.9 steps/s
[Step=75550 Epoch=147.7] | Loss=0.00727 | Reg=0.00100 | acc=0.9531 | L2-Norm=10.016 | L2-Norm(final)=19.691 | 2178.1 samples/s | 34.0 steps/s
[Step=75600 Epoch=147.8] | Loss=0.00718 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.019 | L2-Norm(final)=19.693 | 4749.3 samples/s | 74.2 steps/s
[Step=75650 Epoch=147.9] | Loss=0.00712 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.022 | L2-Norm(final)=19.695 | 4776.2 samples/s | 74.6 steps/s
[Step=75700 Epoch=148.0] | Loss=0.00700 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=19.698 | 4854.2 samples/s | 75.8 steps/s
[Step=75750 Epoch=148.1] | Loss=0.00691 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.028 | L2-Norm(final)=19.700 | 4726.6 samples/s | 73.9 steps/s
[Step=75800 Epoch=148.2] | Loss=0.00685 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.031 | L2-Norm(final)=19.702 | 4771.1 samples/s | 74.5 steps/s
[Step=75850 Epoch=148.3] | Loss=0.00682 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.033 | L2-Norm(final)=19.704 | 4792.8 samples/s | 74.9 steps/s
[Step=75900 Epoch=148.4] | Loss=0.00675 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.036 | L2-Norm(final)=19.706 | 4776.1 samples/s | 74.6 steps/s
[Step=75950 Epoch=148.5] | Loss=0.00666 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.038 | L2-Norm(final)=19.709 | 4790.1 samples/s | 74.8 steps/s
[Step=76000 Epoch=148.6] | Loss=0.00662 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.041 | L2-Norm(final)=19.711 | 4751.8 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step76000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=74001 Epoch=283.5] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=17.634 | 4278.2 samples/s | 66.8 steps/s
[Step=74050 Epoch=283.7] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.883 | L2-Norm(final)=17.641 | 4948.8 samples/s | 77.3 steps/s
[Step=74100 Epoch=283.9] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.883 | L2-Norm(final)=17.651 | 5082.5 samples/s | 79.4 steps/s
[Step=74150 Epoch=284.1] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=17.660 | 5298.7 samples/s | 82.8 steps/s
[Step=74200 Epoch=284.3] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=17.668 | 5333.8 samples/s | 83.3 steps/s
[Step=74250 Epoch=284.5] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=17.676 | 6554.4 samples/s | 102.4 steps/s
[Step=74300 Epoch=284.7] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=17.683 | 2122.8 samples/s | 33.2 steps/s
[Step=74350 Epoch=284.9] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=17.690 | 5139.8 samples/s | 80.3 steps/s
[Step=74400 Epoch=285.1] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=17.697 | 5209.1 samples/s | 81.4 steps/s
[Step=74450 Epoch=285.3] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=17.705 | 5141.1 samples/s | 80.3 steps/s
[Step=74500 Epoch=285.5] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=17.712 | 5793.3 samples/s | 90.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=74501 Epoch=285.5] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=17.780 | 4798.6 samples/s | 75.0 steps/s
[Step=74550 Epoch=285.6] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.860 | L2-Norm(final)=17.785 | 4111.3 samples/s | 64.2 steps/s
[Step=74600 Epoch=285.8] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.831 | L2-Norm(final)=17.788 | 4530.6 samples/s | 70.8 steps/s
[Step=74650 Epoch=286.0] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.801 | L2-Norm(final)=17.790 | 4532.0 samples/s | 70.8 steps/s
[Step=74700 Epoch=286.2] | Loss=0.00019 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.778 | L2-Norm(final)=17.791 | 4552.3 samples/s | 71.1 steps/s
[Step=74750 Epoch=286.4] | Loss=0.00023 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.773 | L2-Norm(final)=17.789 | 5727.1 samples/s | 89.5 steps/s
[Step=74800 Epoch=286.6] | Loss=0.00019 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.772 | L2-Norm(final)=17.786 | 2028.9 samples/s | 31.7 steps/s
[Step=74850 Epoch=286.8] | Loss=0.00017 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.770 | L2-Norm(final)=17.784 | 4540.5 samples/s | 70.9 steps/s
[Step=74900 Epoch=287.0] | Loss=0.00015 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=17.783 | 4546.6 samples/s | 71.0 steps/s
[Step=74950 Epoch=287.2] | Loss=0.00013 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=17.782 | 4585.4 samples/s | 71.6 steps/s
[Step=75000 Epoch=287.4] | Loss=0.00012 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=17.781 | 5051.4 samples/s | 78.9 steps/s
[Step=75050 Epoch=287.6] | Loss=0.00011 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.763 | L2-Norm(final)=17.780 | 2099.6 samples/s | 32.8 steps/s
[Step=75100 Epoch=287.8] | Loss=0.00010 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.762 | L2-Norm(final)=17.780 | 4672.9 samples/s | 73.0 steps/s
[Step=75150 Epoch=287.9] | Loss=0.00010 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.760 | L2-Norm(final)=17.779 | 4486.6 samples/s | 70.1 steps/s
[Step=75200 Epoch=288.1] | Loss=0.00009 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.758 | L2-Norm(final)=17.779 | 4525.1 samples/s | 70.7 steps/s
[Step=75250 Epoch=288.3] | Loss=0.00008 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.756 | L2-Norm(final)=17.779 | 4550.1 samples/s | 71.1 steps/s
[Step=75300 Epoch=288.5] | Loss=0.00008 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.754 | L2-Norm(final)=17.779 | 2202.5 samples/s | 34.4 steps/s
[Step=75350 Epoch=288.7] | Loss=0.00007 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.752 | L2-Norm(final)=17.779 | 4658.3 samples/s | 72.8 steps/s
[Step=75400 Epoch=288.9] | Loss=0.00007 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=17.778 | 4529.3 samples/s | 70.8 steps/s
[Step=75450 Epoch=289.1] | Loss=0.00007 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=17.778 | 4573.6 samples/s | 71.5 steps/s
[Step=75500 Epoch=289.3] | Loss=0.00006 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.746 | L2-Norm(final)=17.778 | 4527.3 samples/s | 70.7 steps/s
[Step=75550 Epoch=289.5] | Loss=0.00006 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.744 | L2-Norm(final)=17.778 | 2213.7 samples/s | 34.6 steps/s
[Step=75600 Epoch=289.7] | Loss=0.00006 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.742 | L2-Norm(final)=17.778 | 4521.5 samples/s | 70.6 steps/s
[Step=75650 Epoch=289.9] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.740 | L2-Norm(final)=17.778 | 4550.6 samples/s | 71.1 steps/s
[Step=75700 Epoch=290.1] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=17.778 | 4553.7 samples/s | 71.2 steps/s
[Step=75750 Epoch=290.2] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.736 | L2-Norm(final)=17.778 | 4565.5 samples/s | 71.3 steps/s
[Step=75800 Epoch=290.4] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.734 | L2-Norm(final)=17.778 | 6179.0 samples/s | 96.5 steps/s
[Step=75850 Epoch=290.6] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.732 | L2-Norm(final)=17.778 | 1959.2 samples/s | 30.6 steps/s
[Step=75900 Epoch=290.8] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.729 | L2-Norm(final)=17.778 | 4476.2 samples/s | 69.9 steps/s
[Step=75950 Epoch=291.0] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.727 | L2-Norm(final)=17.778 | 4507.7 samples/s | 70.4 steps/s
[Step=76000 Epoch=291.2] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.725 | L2-Norm(final)=17.778 | 4556.8 samples/s | 71.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step76000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=74001 Epoch=284.9] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=18.338 | 4510.4 samples/s | 70.5 steps/s
[Step=74050 Epoch=285.0] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=18.341 | 4681.2 samples/s | 73.1 steps/s
[Step=74100 Epoch=285.2] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=18.348 | 5177.0 samples/s | 80.9 steps/s
[Step=74150 Epoch=285.4] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=18.356 | 5209.4 samples/s | 81.4 steps/s
[Step=74200 Epoch=285.6] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=18.364 | 5241.8 samples/s | 81.9 steps/s
[Step=74250 Epoch=285.8] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=18.370 | 6990.4 samples/s | 109.2 steps/s
[Step=74300 Epoch=286.0] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=18.377 | 2128.2 samples/s | 33.3 steps/s
[Step=74350 Epoch=286.2] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=18.384 | 5179.3 samples/s | 80.9 steps/s
[Step=74400 Epoch=286.4] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=18.392 | 5173.4 samples/s | 80.8 steps/s
[Step=74450 Epoch=286.6] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.884 | L2-Norm(final)=18.399 | 5133.6 samples/s | 80.2 steps/s
[Step=74500 Epoch=286.8] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.884 | L2-Norm(final)=18.406 | 6069.4 samples/s | 94.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=74501 Epoch=286.8] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.884 | L2-Norm(final)=18.475 | 4539.4 samples/s | 70.9 steps/s
[Step=74550 Epoch=287.0] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=18.481 | 4376.0 samples/s | 68.4 steps/s
[Step=74600 Epoch=287.2] | Loss=0.00009 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.869 | L2-Norm(final)=18.483 | 4555.2 samples/s | 71.2 steps/s
[Step=74650 Epoch=287.4] | Loss=0.00044 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=18.484 | 4531.7 samples/s | 70.8 steps/s
[Step=74700 Epoch=287.5] | Loss=0.00034 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=18.483 | 4542.0 samples/s | 71.0 steps/s
[Step=74750 Epoch=287.7] | Loss=0.00031 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.891 | L2-Norm(final)=18.482 | 5820.5 samples/s | 90.9 steps/s
[Step=74800 Epoch=287.9] | Loss=0.00026 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.894 | L2-Norm(final)=18.482 | 2008.2 samples/s | 31.4 steps/s
[Step=74850 Epoch=288.1] | Loss=0.00022 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.897 | L2-Norm(final)=18.481 | 4509.1 samples/s | 70.5 steps/s
[Step=74900 Epoch=288.3] | Loss=0.00020 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=18.481 | 4555.4 samples/s | 71.2 steps/s
[Step=74950 Epoch=288.5] | Loss=0.00018 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=18.481 | 4627.2 samples/s | 72.3 steps/s
[Step=75000 Epoch=288.7] | Loss=0.00016 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=18.481 | 5142.9 samples/s | 80.4 steps/s
[Step=75050 Epoch=288.9] | Loss=0.00015 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=18.481 | 2086.5 samples/s | 32.6 steps/s
[Step=75100 Epoch=289.1] | Loss=0.00013 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=18.481 | 4626.2 samples/s | 72.3 steps/s
[Step=75150 Epoch=289.3] | Loss=0.00012 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.897 | L2-Norm(final)=18.481 | 4501.1 samples/s | 70.3 steps/s
[Step=75200 Epoch=289.5] | Loss=0.00012 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.896 | L2-Norm(final)=18.481 | 4531.2 samples/s | 70.8 steps/s
[Step=75250 Epoch=289.7] | Loss=0.00011 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.895 | L2-Norm(final)=18.481 | 4634.9 samples/s | 72.4 steps/s
[Step=75300 Epoch=289.9] | Loss=0.00010 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.894 | L2-Norm(final)=18.482 | 2176.2 samples/s | 34.0 steps/s
[Step=75350 Epoch=290.1] | Loss=0.00010 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.893 | L2-Norm(final)=18.482 | 4627.6 samples/s | 72.3 steps/s
[Step=75400 Epoch=290.2] | Loss=0.00009 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.892 | L2-Norm(final)=18.482 | 4524.2 samples/s | 70.7 steps/s
[Step=75450 Epoch=290.4] | Loss=0.00009 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=18.482 | 4550.2 samples/s | 71.1 steps/s
[Step=75500 Epoch=290.6] | Loss=0.00008 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=18.482 | 4628.5 samples/s | 72.3 steps/s
[Step=75550 Epoch=290.8] | Loss=0.00008 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.887 | L2-Norm(final)=18.482 | 2179.2 samples/s | 34.1 steps/s
[Step=75600 Epoch=291.0] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=18.482 | 4618.2 samples/s | 72.2 steps/s
[Step=75650 Epoch=291.2] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.884 | L2-Norm(final)=18.483 | 4547.6 samples/s | 71.1 steps/s
[Step=75700 Epoch=291.4] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=18.483 | 4498.0 samples/s | 70.3 steps/s
[Step=75750 Epoch=291.6] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.880 | L2-Norm(final)=18.483 | 4584.8 samples/s | 71.6 steps/s
[Step=75800 Epoch=291.8] | Loss=0.00006 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.878 | L2-Norm(final)=18.483 | 6595.3 samples/s | 103.1 steps/s
[Step=75850 Epoch=292.0] | Loss=0.00006 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=18.483 | 1924.9 samples/s | 30.1 steps/s
[Step=75900 Epoch=292.2] | Loss=0.00006 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=18.483 | 4600.4 samples/s | 71.9 steps/s
[Step=75950 Epoch=292.4] | Loss=0.00006 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=18.484 | 4544.6 samples/s | 71.0 steps/s
[Step=76000 Epoch=292.6] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.871 | L2-Norm(final)=18.484 | 4553.1 samples/s | 71.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step76000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07504 | acc=0.9685 | tpr=0.9775 | fpr=0.0510 | 4233.8 samples/s | 16.5 steps/s
Avg test loss: 0.07394, Avg test acc: 0.96863, Avg tpr: 0.97797, Avg fpr: 0.05192, total FA: 405

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07328 | acc=0.9705 | tpr=0.9785 | fpr=0.0468 | 4184.0 samples/s | 16.3 steps/s
Avg test loss: 0.07281, Avg test acc: 0.96987, Avg tpr: 0.97890, Avg fpr: 0.04999, total FA: 390

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.64743 | acc=0.3089 | tpr=0.0058 | fpr=0.0330 | 4211.0 samples/s | 16.4 steps/s
Avg test loss: 6.66602, Avg test acc: 0.30539, Avg tpr: 0.00554, Avg fpr: 0.03512, total FA: 274

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.46839 | acc=0.3005 | tpr=0.0067 | fpr=0.0614 | 4189.2 samples/s | 16.4 steps/s
Avg test loss: 6.48965, Avg test acc: 0.29694, Avg tpr: 0.00624, Avg fpr: 0.06371, total FA: 497

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.40279 | acc=0.1228 | tpr=0.4027 | fpr=0.8822 | 4204.2 samples/s | 16.4 steps/s
[Step= 100] | Loss=5.34313 | acc=0.1222 | tpr=0.3881 | fpr=0.8827 | 7836.0 samples/s | 30.6 steps/s
[Step= 150] | Loss=5.34885 | acc=0.1218 | tpr=0.3963 | fpr=0.8833 | 7945.5 samples/s | 31.0 steps/s
[Step= 200] | Loss=5.34588 | acc=0.1223 | tpr=0.3913 | fpr=0.8826 | 7766.7 samples/s | 30.3 steps/s
[Step= 250] | Loss=5.34665 | acc=0.1219 | tpr=0.3817 | fpr=0.8828 | 7903.3 samples/s | 30.9 steps/s
[Step= 300] | Loss=5.35270 | acc=0.1209 | tpr=0.3760 | fpr=0.8838 | 7876.2 samples/s | 30.8 steps/s
[Step= 350] | Loss=5.36219 | acc=0.1204 | tpr=0.3707 | fpr=0.8842 | 7784.6 samples/s | 30.4 steps/s
[Step= 400] | Loss=5.35589 | acc=0.1201 | tpr=0.3643 | fpr=0.8843 | 8090.7 samples/s | 31.6 steps/s
[Step= 450] | Loss=5.35762 | acc=0.1196 | tpr=0.3647 | fpr=0.8848 | 7625.7 samples/s | 29.8 steps/s
[Step= 500] | Loss=5.35939 | acc=0.1193 | tpr=0.3652 | fpr=0.8852 | 8032.2 samples/s | 31.4 steps/s
[Step= 550] | Loss=5.36160 | acc=0.1195 | tpr=0.3641 | fpr=0.8850 | 14078.9 samples/s | 55.0 steps/s
Avg test loss: 5.36216, Avg test acc: 0.11938, Avg tpr: 0.36410, Avg fpr: 0.88507, total FA: 122890

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.21142 | acc=0.1359 | tpr=0.4027 | fpr=0.8689 | 4222.7 samples/s | 16.5 steps/s
[Step= 100] | Loss=5.16134 | acc=0.1366 | tpr=0.4009 | fpr=0.8684 | 7670.2 samples/s | 30.0 steps/s
[Step= 150] | Loss=5.16697 | acc=0.1360 | tpr=0.4121 | fpr=0.8691 | 7859.2 samples/s | 30.7 steps/s
[Step= 200] | Loss=5.16281 | acc=0.1363 | tpr=0.4131 | fpr=0.8687 | 7886.9 samples/s | 30.8 steps/s
[Step= 250] | Loss=5.16292 | acc=0.1364 | tpr=0.4061 | fpr=0.8685 | 7702.2 samples/s | 30.1 steps/s
[Step= 300] | Loss=5.16950 | acc=0.1360 | tpr=0.4044 | fpr=0.8689 | 8146.1 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.17856 | acc=0.1356 | tpr=0.4020 | fpr=0.8692 | 7777.4 samples/s | 30.4 steps/s
[Step= 400] | Loss=5.17113 | acc=0.1351 | tpr=0.3922 | fpr=0.8696 | 7802.9 samples/s | 30.5 steps/s
[Step= 450] | Loss=5.17149 | acc=0.1348 | tpr=0.3924 | fpr=0.8699 | 7907.4 samples/s | 30.9 steps/s
[Step= 500] | Loss=5.17279 | acc=0.1344 | tpr=0.3943 | fpr=0.8702 | 7653.4 samples/s | 29.9 steps/s
[Step= 550] | Loss=5.17532 | acc=0.1346 | tpr=0.3932 | fpr=0.8701 | 14646.0 samples/s | 57.2 steps/s
Avg test loss: 5.17565, Avg test acc: 0.13452, Avg tpr: 0.39263, Avg fpr: 0.87017, total FA: 120821

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12439 | acc=0.9806 | tpr=0.9204 | fpr=0.0183 | 4197.5 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.13135 | acc=0.9798 | tpr=0.9382 | fpr=0.0195 | 7729.6 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.13319 | acc=0.9793 | tpr=0.9395 | fpr=0.0199 | 7765.1 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.13404 | acc=0.9796 | tpr=0.9454 | fpr=0.0197 | 7887.1 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.13317 | acc=0.9797 | tpr=0.9467 | fpr=0.0197 | 7856.2 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.13559 | acc=0.9795 | tpr=0.9484 | fpr=0.0200 | 7981.9 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.13566 | acc=0.9795 | tpr=0.9468 | fpr=0.0199 | 7823.2 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.13707 | acc=0.9792 | tpr=0.9453 | fpr=0.0202 | 8065.9 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.13871 | acc=0.9790 | tpr=0.9450 | fpr=0.0204 | 7839.3 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.13757 | acc=0.9791 | tpr=0.9463 | fpr=0.0203 | 7438.4 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.13680 | acc=0.9793 | tpr=0.9475 | fpr=0.0201 | 14860.8 samples/s | 58.1 steps/s
Avg test loss: 0.13645, Avg test acc: 0.97932, Avg tpr: 0.94770, Avg fpr: 0.02010, total FA: 2791

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12222 | acc=0.9808 | tpr=0.9292 | fpr=0.0183 | 4211.0 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.13052 | acc=0.9801 | tpr=0.9531 | fpr=0.0194 | 7650.1 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.13196 | acc=0.9797 | tpr=0.9611 | fpr=0.0199 | 8647.1 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.13326 | acc=0.9798 | tpr=0.9628 | fpr=0.0199 | 7269.9 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.13374 | acc=0.9796 | tpr=0.9624 | fpr=0.0201 | 8015.7 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.13579 | acc=0.9794 | tpr=0.9636 | fpr=0.0204 | 7800.7 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.13595 | acc=0.9792 | tpr=0.9606 | fpr=0.0204 | 7795.9 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.13733 | acc=0.9790 | tpr=0.9584 | fpr=0.0207 | 7994.0 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.13872 | acc=0.9789 | tpr=0.9562 | fpr=0.0207 | 7736.2 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.13767 | acc=0.9790 | tpr=0.9577 | fpr=0.0206 | 7519.9 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.13688 | acc=0.9792 | tpr=0.9586 | fpr=0.0204 | 14854.9 samples/s | 58.0 steps/s
Avg test loss: 0.13659, Avg test acc: 0.97923, Avg tpr: 0.95880, Avg fpr: 0.02040, total FA: 2833

server round 38/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=76001 Epoch=148.2] | Loss=0.03942 | Reg=0.00098 | acc=0.9531 | L2-Norm=9.874 | L2-Norm(final)=19.594 | 3968.3 samples/s | 62.0 steps/s
[Step=76050 Epoch=148.3] | Loss=0.01182 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=19.600 | 4959.2 samples/s | 77.5 steps/s
[Step=76100 Epoch=148.4] | Loss=0.01074 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=19.610 | 5180.4 samples/s | 80.9 steps/s
[Step=76150 Epoch=148.5] | Loss=0.00988 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=19.619 | 5627.0 samples/s | 87.9 steps/s
[Step=76200 Epoch=148.6] | Loss=0.00965 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=19.629 | 5466.1 samples/s | 85.4 steps/s
[Step=76250 Epoch=148.7] | Loss=0.00993 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=19.638 | 5496.4 samples/s | 85.9 steps/s
[Step=76300 Epoch=148.8] | Loss=0.00972 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.875 | L2-Norm(final)=19.646 | 5578.2 samples/s | 87.2 steps/s
[Step=76350 Epoch=148.9] | Loss=0.00979 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.875 | L2-Norm(final)=19.655 | 5519.7 samples/s | 86.2 steps/s
[Step=76400 Epoch=149.0] | Loss=0.00980 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=19.662 | 5637.2 samples/s | 88.1 steps/s
[Step=76450 Epoch=149.1] | Loss=0.00979 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=19.670 | 5391.7 samples/s | 84.2 steps/s
[Step=76500 Epoch=149.2] | Loss=0.01000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=19.678 | 7027.8 samples/s | 109.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=76501 Epoch=149.2] | Loss=0.00911 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.875 | L2-Norm(final)=19.756 | 4723.4 samples/s | 73.8 steps/s
[Step=76550 Epoch=149.3] | Loss=0.00831 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.887 | L2-Norm(final)=19.763 | 4061.5 samples/s | 63.5 steps/s
[Step=76600 Epoch=149.4] | Loss=0.00905 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.896 | L2-Norm(final)=19.768 | 4790.3 samples/s | 74.8 steps/s
[Step=76650 Epoch=149.5] | Loss=0.00947 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=19.772 | 4755.2 samples/s | 74.3 steps/s
[Step=76700 Epoch=149.6] | Loss=0.00901 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.912 | L2-Norm(final)=19.776 | 4738.7 samples/s | 74.0 steps/s
[Step=76750 Epoch=149.7] | Loss=0.00875 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.918 | L2-Norm(final)=19.779 | 4846.5 samples/s | 75.7 steps/s
[Step=76800 Epoch=149.8] | Loss=0.00872 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.925 | L2-Norm(final)=19.783 | 4748.5 samples/s | 74.2 steps/s
[Step=76850 Epoch=149.9] | Loss=0.00855 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.930 | L2-Norm(final)=19.786 | 4777.0 samples/s | 74.6 steps/s
[Step=76900 Epoch=150.0] | Loss=0.00877 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.936 | L2-Norm(final)=19.789 | 4795.7 samples/s | 74.9 steps/s
[Step=76950 Epoch=150.1] | Loss=0.00872 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.941 | L2-Norm(final)=19.791 | 4819.5 samples/s | 75.3 steps/s
[Step=77000 Epoch=150.2] | Loss=0.00864 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.945 | L2-Norm(final)=19.794 | 5763.8 samples/s | 90.1 steps/s
[Step=77050 Epoch=150.3] | Loss=0.00850 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.950 | L2-Norm(final)=19.797 | 2022.3 samples/s | 31.6 steps/s
[Step=77100 Epoch=150.4] | Loss=0.00815 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.954 | L2-Norm(final)=19.799 | 4885.3 samples/s | 76.3 steps/s
[Step=77150 Epoch=150.5] | Loss=0.00789 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.958 | L2-Norm(final)=19.802 | 4708.9 samples/s | 73.6 steps/s
[Step=77200 Epoch=150.6] | Loss=0.00787 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.961 | L2-Norm(final)=19.805 | 4781.5 samples/s | 74.7 steps/s
[Step=77250 Epoch=150.7] | Loss=0.00782 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.965 | L2-Norm(final)=19.807 | 4828.6 samples/s | 75.4 steps/s
[Step=77300 Epoch=150.8] | Loss=0.00773 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.968 | L2-Norm(final)=19.809 | 4716.8 samples/s | 73.7 steps/s
[Step=77350 Epoch=150.9] | Loss=0.00762 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.971 | L2-Norm(final)=19.812 | 4805.7 samples/s | 75.1 steps/s
[Step=77400 Epoch=151.0] | Loss=0.00748 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.974 | L2-Norm(final)=19.814 | 4798.9 samples/s | 75.0 steps/s
[Step=77450 Epoch=151.1] | Loss=0.00737 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.977 | L2-Norm(final)=19.817 | 4784.8 samples/s | 74.8 steps/s
[Step=77500 Epoch=151.2] | Loss=0.00730 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.980 | L2-Norm(final)=19.819 | 5071.6 samples/s | 79.2 steps/s
[Step=77550 Epoch=151.3] | Loss=0.00726 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.983 | L2-Norm(final)=19.821 | 2095.3 samples/s | 32.7 steps/s
[Step=77600 Epoch=151.4] | Loss=0.00715 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.986 | L2-Norm(final)=19.824 | 4911.2 samples/s | 76.7 steps/s
[Step=77650 Epoch=151.4] | Loss=0.00710 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.988 | L2-Norm(final)=19.826 | 4768.9 samples/s | 74.5 steps/s
[Step=77700 Epoch=151.5] | Loss=0.00704 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.991 | L2-Norm(final)=19.828 | 4791.2 samples/s | 74.9 steps/s
[Step=77750 Epoch=151.6] | Loss=0.00692 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.993 | L2-Norm(final)=19.830 | 4894.9 samples/s | 76.5 steps/s
[Step=77800 Epoch=151.7] | Loss=0.00686 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.996 | L2-Norm(final)=19.832 | 4774.7 samples/s | 74.6 steps/s
[Step=77850 Epoch=151.8] | Loss=0.00685 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.998 | L2-Norm(final)=19.834 | 4828.2 samples/s | 75.4 steps/s
[Step=77900 Epoch=151.9] | Loss=0.00680 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.000 | L2-Norm(final)=19.836 | 4817.7 samples/s | 75.3 steps/s
[Step=77950 Epoch=152.0] | Loss=0.00674 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.003 | L2-Norm(final)=19.839 | 4782.7 samples/s | 74.7 steps/s
[Step=78000 Epoch=152.1] | Loss=0.00666 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.005 | L2-Norm(final)=19.841 | 4861.7 samples/s | 76.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step78000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=76001 Epoch=148.6] | Loss=0.01494 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.874 | L2-Norm(final)=19.774 | 4447.3 samples/s | 69.5 steps/s
[Step=76050 Epoch=148.7] | Loss=0.00969 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.874 | L2-Norm(final)=19.778 | 5081.0 samples/s | 79.4 steps/s
[Step=76100 Epoch=148.8] | Loss=0.01100 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=19.780 | 5212.0 samples/s | 81.4 steps/s
[Step=76150 Epoch=148.9] | Loss=0.01081 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=19.783 | 5644.9 samples/s | 88.2 steps/s
[Step=76200 Epoch=149.0] | Loss=0.01043 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.874 | L2-Norm(final)=19.786 | 5368.8 samples/s | 83.9 steps/s
[Step=76250 Epoch=149.1] | Loss=0.01023 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.874 | L2-Norm(final)=19.790 | 5463.9 samples/s | 85.4 steps/s
[Step=76300 Epoch=149.2] | Loss=0.01041 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=19.794 | 5508.9 samples/s | 86.1 steps/s
[Step=76350 Epoch=149.3] | Loss=0.01039 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.874 | L2-Norm(final)=19.798 | 5463.4 samples/s | 85.4 steps/s
[Step=76400 Epoch=149.4] | Loss=0.01020 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.874 | L2-Norm(final)=19.802 | 5423.4 samples/s | 84.7 steps/s
[Step=76450 Epoch=149.5] | Loss=0.01010 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=19.806 | 5610.9 samples/s | 87.7 steps/s
[Step=76500 Epoch=149.6] | Loss=0.01002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=19.811 | 7093.8 samples/s | 110.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=76501 Epoch=149.6] | Loss=0.03894 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.874 | L2-Norm(final)=19.858 | 4821.6 samples/s | 75.3 steps/s
[Step=76550 Epoch=149.7] | Loss=0.01066 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=19.863 | 4511.1 samples/s | 70.5 steps/s
[Step=76600 Epoch=149.8] | Loss=0.01009 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.896 | L2-Norm(final)=19.866 | 4780.5 samples/s | 74.7 steps/s
[Step=76650 Epoch=149.8] | Loss=0.01037 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=19.869 | 4784.2 samples/s | 74.8 steps/s
[Step=76700 Epoch=149.9] | Loss=0.01003 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.913 | L2-Norm(final)=19.871 | 4803.0 samples/s | 75.0 steps/s
[Step=76750 Epoch=150.0] | Loss=0.00977 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.920 | L2-Norm(final)=19.873 | 4727.1 samples/s | 73.9 steps/s
[Step=76800 Epoch=150.1] | Loss=0.00940 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.926 | L2-Norm(final)=19.876 | 4825.2 samples/s | 75.4 steps/s
[Step=76850 Epoch=150.2] | Loss=0.00941 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.931 | L2-Norm(final)=19.878 | 4813.2 samples/s | 75.2 steps/s
[Step=76900 Epoch=150.3] | Loss=0.00931 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.937 | L2-Norm(final)=19.880 | 4782.3 samples/s | 74.7 steps/s
[Step=76950 Epoch=150.4] | Loss=0.00912 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.941 | L2-Norm(final)=19.883 | 4828.5 samples/s | 75.4 steps/s
[Step=77000 Epoch=150.5] | Loss=0.00887 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.946 | L2-Norm(final)=19.885 | 5861.9 samples/s | 91.6 steps/s
[Step=77050 Epoch=150.6] | Loss=0.00852 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.950 | L2-Norm(final)=19.888 | 2092.8 samples/s | 32.7 steps/s
[Step=77100 Epoch=150.7] | Loss=0.00822 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.954 | L2-Norm(final)=19.890 | 4734.1 samples/s | 74.0 steps/s
[Step=77150 Epoch=150.8] | Loss=0.00800 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.958 | L2-Norm(final)=19.893 | 4796.9 samples/s | 75.0 steps/s
[Step=77200 Epoch=150.9] | Loss=0.00789 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.961 | L2-Norm(final)=19.895 | 4744.2 samples/s | 74.1 steps/s
[Step=77250 Epoch=151.0] | Loss=0.00768 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.965 | L2-Norm(final)=19.897 | 4837.7 samples/s | 75.6 steps/s
[Step=77300 Epoch=151.1] | Loss=0.00759 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.968 | L2-Norm(final)=19.900 | 4761.8 samples/s | 74.4 steps/s
[Step=77350 Epoch=151.2] | Loss=0.00744 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.971 | L2-Norm(final)=19.902 | 4770.4 samples/s | 74.5 steps/s
[Step=77400 Epoch=151.3] | Loss=0.00738 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.974 | L2-Norm(final)=19.904 | 4756.7 samples/s | 74.3 steps/s
[Step=77450 Epoch=151.4] | Loss=0.00729 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.977 | L2-Norm(final)=19.907 | 4793.3 samples/s | 74.9 steps/s
[Step=77500 Epoch=151.5] | Loss=0.00725 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.980 | L2-Norm(final)=19.909 | 5153.6 samples/s | 80.5 steps/s
[Step=77550 Epoch=151.6] | Loss=0.00716 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.983 | L2-Norm(final)=19.911 | 2211.9 samples/s | 34.6 steps/s
[Step=77600 Epoch=151.7] | Loss=0.00702 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.985 | L2-Norm(final)=19.913 | 4745.3 samples/s | 74.1 steps/s
[Step=77650 Epoch=151.8] | Loss=0.00692 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.988 | L2-Norm(final)=19.915 | 4808.7 samples/s | 75.1 steps/s
[Step=77700 Epoch=151.9] | Loss=0.00684 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.990 | L2-Norm(final)=19.917 | 4778.4 samples/s | 74.7 steps/s
[Step=77750 Epoch=152.0] | Loss=0.00676 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.993 | L2-Norm(final)=19.920 | 4774.6 samples/s | 74.6 steps/s
[Step=77800 Epoch=152.1] | Loss=0.00667 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.995 | L2-Norm(final)=19.922 | 4825.4 samples/s | 75.4 steps/s
[Step=77850 Epoch=152.2] | Loss=0.00666 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.998 | L2-Norm(final)=19.924 | 4818.2 samples/s | 75.3 steps/s
[Step=77900 Epoch=152.3] | Loss=0.00662 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.000 | L2-Norm(final)=19.926 | 4790.2 samples/s | 74.8 steps/s
[Step=77950 Epoch=152.4] | Loss=0.00658 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.002 | L2-Norm(final)=19.928 | 4767.5 samples/s | 74.5 steps/s
[Step=78000 Epoch=152.5] | Loss=0.00660 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.005 | L2-Norm(final)=19.930 | 4791.8 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step78000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=76001 Epoch=291.2] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=17.780 | 4637.4 samples/s | 72.5 steps/s
[Step=76050 Epoch=291.4] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=17.781 | 4580.4 samples/s | 71.6 steps/s
[Step=76100 Epoch=291.6] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=17.782 | 5339.0 samples/s | 83.4 steps/s
[Step=76150 Epoch=291.8] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=17.782 | 5098.7 samples/s | 79.7 steps/s
[Step=76200 Epoch=292.0] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=17.783 | 5132.5 samples/s | 80.2 steps/s
[Step=76250 Epoch=292.2] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=17.784 | 6912.5 samples/s | 108.0 steps/s
[Step=76300 Epoch=292.4] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=17.785 | 2133.5 samples/s | 33.3 steps/s
[Step=76350 Epoch=292.5] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=17.786 | 5315.4 samples/s | 83.1 steps/s
[Step=76400 Epoch=292.7] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=17.787 | 5200.4 samples/s | 81.3 steps/s
[Step=76450 Epoch=292.9] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=17.788 | 5128.4 samples/s | 80.1 steps/s
[Step=76500 Epoch=293.1] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=17.789 | 5824.6 samples/s | 91.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=76501 Epoch=293.1] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=17.798 | 4473.7 samples/s | 69.9 steps/s
[Step=76550 Epoch=293.3] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.870 | L2-Norm(final)=17.800 | 4214.0 samples/s | 65.8 steps/s
[Step=76600 Epoch=293.5] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.867 | L2-Norm(final)=17.801 | 4552.3 samples/s | 71.1 steps/s
[Step=76650 Epoch=293.7] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.863 | L2-Norm(final)=17.802 | 4571.3 samples/s | 71.4 steps/s
[Step=76700 Epoch=293.9] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.860 | L2-Norm(final)=17.802 | 4497.1 samples/s | 70.3 steps/s
[Step=76750 Epoch=294.1] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.856 | L2-Norm(final)=17.803 | 5719.5 samples/s | 89.4 steps/s
[Step=76800 Epoch=294.3] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.852 | L2-Norm(final)=17.804 | 2016.7 samples/s | 31.5 steps/s
[Step=76850 Epoch=294.5] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.848 | L2-Norm(final)=17.805 | 4493.5 samples/s | 70.2 steps/s
[Step=76900 Epoch=294.7] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.843 | L2-Norm(final)=17.805 | 4605.7 samples/s | 72.0 steps/s
[Step=76950 Epoch=294.8] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.839 | L2-Norm(final)=17.806 | 4493.9 samples/s | 70.2 steps/s
[Step=77000 Epoch=295.0] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.835 | L2-Norm(final)=17.806 | 5050.7 samples/s | 78.9 steps/s
[Step=77050 Epoch=295.2] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.831 | L2-Norm(final)=17.807 | 2080.9 samples/s | 32.5 steps/s
[Step=77100 Epoch=295.4] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=17.807 | 4560.2 samples/s | 71.3 steps/s
[Step=77150 Epoch=295.6] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.822 | L2-Norm(final)=17.808 | 4564.3 samples/s | 71.3 steps/s
[Step=77200 Epoch=295.8] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.817 | L2-Norm(final)=17.808 | 4569.9 samples/s | 71.4 steps/s
[Step=77250 Epoch=296.0] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=17.809 | 4561.4 samples/s | 71.3 steps/s
[Step=77300 Epoch=296.2] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.808 | L2-Norm(final)=17.809 | 2203.2 samples/s | 34.4 steps/s
[Step=77350 Epoch=296.4] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.804 | L2-Norm(final)=17.810 | 4631.8 samples/s | 72.4 steps/s
[Step=77400 Epoch=296.6] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.799 | L2-Norm(final)=17.811 | 4616.9 samples/s | 72.1 steps/s
[Step=77450 Epoch=296.8] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.795 | L2-Norm(final)=17.811 | 4488.1 samples/s | 70.1 steps/s
[Step=77500 Epoch=297.0] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.790 | L2-Norm(final)=17.812 | 4527.9 samples/s | 70.7 steps/s
[Step=77550 Epoch=297.1] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.785 | L2-Norm(final)=17.812 | 2207.1 samples/s | 34.5 steps/s
[Step=77600 Epoch=297.3] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.780 | L2-Norm(final)=17.813 | 4478.0 samples/s | 70.0 steps/s
[Step=77650 Epoch=297.5] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.775 | L2-Norm(final)=17.813 | 4696.1 samples/s | 73.4 steps/s
[Step=77700 Epoch=297.7] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.770 | L2-Norm(final)=17.814 | 4435.2 samples/s | 69.3 steps/s
[Step=77750 Epoch=297.9] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=17.815 | 4589.7 samples/s | 71.7 steps/s
[Step=77800 Epoch=298.1] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.760 | L2-Norm(final)=17.815 | 6140.9 samples/s | 96.0 steps/s
[Step=77850 Epoch=298.3] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.755 | L2-Norm(final)=17.816 | 1941.8 samples/s | 30.3 steps/s
[Step=77900 Epoch=298.5] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=17.817 | 4551.9 samples/s | 71.1 steps/s
[Step=77950 Epoch=298.7] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.745 | L2-Norm(final)=17.817 | 4429.9 samples/s | 69.2 steps/s
[Step=78000 Epoch=298.9] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.740 | L2-Norm(final)=17.818 | 4504.6 samples/s | 70.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step78000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=76001 Epoch=292.6] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=18.489 | 4157.0 samples/s | 65.0 steps/s
[Step=76050 Epoch=292.7] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=18.490 | 4681.7 samples/s | 73.2 steps/s
[Step=76100 Epoch=292.9] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=18.491 | 5174.5 samples/s | 80.9 steps/s
[Step=76150 Epoch=293.1] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=18.492 | 5184.7 samples/s | 81.0 steps/s
[Step=76200 Epoch=293.3] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=18.492 | 5171.0 samples/s | 80.8 steps/s
[Step=76250 Epoch=293.5] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=18.493 | 7000.0 samples/s | 109.4 steps/s
[Step=76300 Epoch=293.7] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=18.495 | 2125.0 samples/s | 33.2 steps/s
[Step=76350 Epoch=293.9] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=18.496 | 5248.7 samples/s | 82.0 steps/s
[Step=76400 Epoch=294.1] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=18.497 | 5142.4 samples/s | 80.3 steps/s
[Step=76450 Epoch=294.3] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=18.498 | 5304.9 samples/s | 82.9 steps/s
[Step=76500 Epoch=294.5] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=18.499 | 5879.2 samples/s | 91.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=76501 Epoch=294.5] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=18.512 | 4819.9 samples/s | 75.3 steps/s
[Step=76550 Epoch=294.7] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.872 | L2-Norm(final)=18.513 | 4052.0 samples/s | 63.3 steps/s
[Step=76600 Epoch=294.9] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.869 | L2-Norm(final)=18.515 | 4588.6 samples/s | 71.7 steps/s
[Step=76650 Epoch=295.1] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.866 | L2-Norm(final)=18.516 | 4549.6 samples/s | 71.1 steps/s
[Step=76700 Epoch=295.2] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.863 | L2-Norm(final)=18.517 | 4596.9 samples/s | 71.8 steps/s
[Step=76750 Epoch=295.4] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.859 | L2-Norm(final)=18.518 | 5658.8 samples/s | 88.4 steps/s
[Step=76800 Epoch=295.6] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.856 | L2-Norm(final)=18.520 | 2006.2 samples/s | 31.3 steps/s
[Step=76850 Epoch=295.8] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.852 | L2-Norm(final)=18.521 | 4532.5 samples/s | 70.8 steps/s
[Step=76900 Epoch=296.0] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.848 | L2-Norm(final)=18.522 | 4570.7 samples/s | 71.4 steps/s
[Step=76950 Epoch=296.2] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=18.522 | 4469.7 samples/s | 69.8 steps/s
[Step=77000 Epoch=296.4] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.841 | L2-Norm(final)=18.523 | 5135.2 samples/s | 80.2 steps/s
[Step=77050 Epoch=296.6] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.837 | L2-Norm(final)=18.524 | 2106.7 samples/s | 32.9 steps/s
[Step=77100 Epoch=296.8] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.833 | L2-Norm(final)=18.525 | 4521.8 samples/s | 70.7 steps/s
[Step=77150 Epoch=297.0] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.829 | L2-Norm(final)=18.526 | 4593.2 samples/s | 71.8 steps/s
[Step=77200 Epoch=297.2] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.825 | L2-Norm(final)=18.527 | 4545.2 samples/s | 71.0 steps/s
[Step=77250 Epoch=297.4] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.821 | L2-Norm(final)=18.528 | 4651.2 samples/s | 72.7 steps/s
[Step=77300 Epoch=297.6] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.817 | L2-Norm(final)=18.528 | 2148.4 samples/s | 33.6 steps/s
[Step=77350 Epoch=297.8] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=18.529 | 4599.1 samples/s | 71.9 steps/s
[Step=77400 Epoch=297.9] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.809 | L2-Norm(final)=18.530 | 4575.7 samples/s | 71.5 steps/s
[Step=77450 Epoch=298.1] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.804 | L2-Norm(final)=18.531 | 4554.2 samples/s | 71.2 steps/s
[Step=77500 Epoch=298.3] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.800 | L2-Norm(final)=18.532 | 4552.0 samples/s | 71.1 steps/s
[Step=77550 Epoch=298.5] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.796 | L2-Norm(final)=18.533 | 2225.3 samples/s | 34.8 steps/s
[Step=77600 Epoch=298.7] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.791 | L2-Norm(final)=18.533 | 4522.8 samples/s | 70.7 steps/s
[Step=77650 Epoch=298.9] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.787 | L2-Norm(final)=18.534 | 4547.5 samples/s | 71.1 steps/s
[Step=77700 Epoch=299.1] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.782 | L2-Norm(final)=18.535 | 4556.0 samples/s | 71.2 steps/s
[Step=77750 Epoch=299.3] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.778 | L2-Norm(final)=18.536 | 4594.8 samples/s | 71.8 steps/s
[Step=77800 Epoch=299.5] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.773 | L2-Norm(final)=18.537 | 6554.7 samples/s | 102.4 steps/s
[Step=77850 Epoch=299.7] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.769 | L2-Norm(final)=18.538 | 1917.6 samples/s | 30.0 steps/s
[Step=77900 Epoch=299.9] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.764 | L2-Norm(final)=18.539 | 4531.8 samples/s | 70.8 steps/s
[Step=77950 Epoch=300.1] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.759 | L2-Norm(final)=18.539 | 4521.1 samples/s | 70.6 steps/s
[Step=78000 Epoch=300.3] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.754 | L2-Norm(final)=18.540 | 4531.8 samples/s | 70.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step78000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07823 | acc=0.9683 | tpr=0.9789 | fpr=0.0548 | 4212.6 samples/s | 16.5 steps/s
Avg test loss: 0.07816, Avg test acc: 0.96915, Avg tpr: 0.97972, Avg fpr: 0.05410, total FA: 422

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07259 | acc=0.9694 | tpr=0.9801 | fpr=0.0540 | 4120.4 samples/s | 16.1 steps/s
Avg test loss: 0.07309, Avg test acc: 0.96915, Avg tpr: 0.98071, Avg fpr: 0.05627, total FA: 439

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.69076 | acc=0.3038 | tpr=0.0046 | fpr=0.0463 | 4184.7 samples/s | 16.3 steps/s
Avg test loss: 6.70668, Avg test acc: 0.30034, Avg tpr: 0.00449, Avg fpr: 0.04897, total FA: 382

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.07858 | acc=0.2964 | tpr=0.0091 | fpr=0.0798 | 4172.6 samples/s | 16.3 steps/s
Avg test loss: 6.09241, Avg test acc: 0.29269, Avg tpr: 0.00816, Avg fpr: 0.08153, total FA: 636

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.97111 | acc=0.1232 | tpr=0.4513 | fpr=0.8827 | 4170.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=5.91121 | acc=0.1232 | tpr=0.4435 | fpr=0.8828 | 7950.1 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.92009 | acc=0.1221 | tpr=0.4539 | fpr=0.8840 | 8015.2 samples/s | 31.3 steps/s
[Step= 200] | Loss=5.91556 | acc=0.1227 | tpr=0.4459 | fpr=0.8832 | 7646.9 samples/s | 29.9 steps/s
[Step= 250] | Loss=5.91600 | acc=0.1224 | tpr=0.4384 | fpr=0.8834 | 7963.5 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.92329 | acc=0.1215 | tpr=0.4305 | fpr=0.8841 | 7704.4 samples/s | 30.1 steps/s
[Step= 350] | Loss=5.93323 | acc=0.1210 | tpr=0.4277 | fpr=0.8846 | 7930.9 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.92648 | acc=0.1206 | tpr=0.4174 | fpr=0.8848 | 4741.4 samples/s | 18.5 steps/s
[Step= 450] | Loss=5.92881 | acc=0.1201 | tpr=0.4163 | fpr=0.8853 | 7886.5 samples/s | 30.8 steps/s
[Step= 500] | Loss=5.93172 | acc=0.1198 | tpr=0.4198 | fpr=0.8856 | 7555.5 samples/s | 29.5 steps/s
[Step= 550] | Loss=5.93434 | acc=0.1199 | tpr=0.4202 | fpr=0.8855 | 14742.8 samples/s | 57.6 steps/s
Avg test loss: 5.93490, Avg test acc: 0.11983, Avg tpr: 0.41997, Avg fpr: 0.88562, total FA: 122967

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.62224 | acc=0.1227 | tpr=0.4115 | fpr=0.8825 | 4167.1 samples/s | 16.3 steps/s
[Step= 100] | Loss=5.56609 | acc=0.1242 | tpr=0.4158 | fpr=0.8812 | 7807.4 samples/s | 30.5 steps/s
[Step= 150] | Loss=5.57460 | acc=0.1234 | tpr=0.4236 | fpr=0.8821 | 7916.6 samples/s | 30.9 steps/s
[Step= 200] | Loss=5.56806 | acc=0.1235 | tpr=0.4197 | fpr=0.8819 | 7793.4 samples/s | 30.4 steps/s
[Step= 250] | Loss=5.56922 | acc=0.1229 | tpr=0.4105 | fpr=0.8824 | 7865.2 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.57522 | acc=0.1223 | tpr=0.4073 | fpr=0.8829 | 7795.0 samples/s | 30.4 steps/s
[Step= 350] | Loss=5.58413 | acc=0.1218 | tpr=0.4058 | fpr=0.8834 | 6908.0 samples/s | 27.0 steps/s
[Step= 400] | Loss=5.57706 | acc=0.1215 | tpr=0.3939 | fpr=0.8834 | 5181.7 samples/s | 20.2 steps/s
[Step= 450] | Loss=5.57748 | acc=0.1212 | tpr=0.3914 | fpr=0.8837 | 7823.5 samples/s | 30.6 steps/s
[Step= 500] | Loss=5.57860 | acc=0.1208 | tpr=0.3930 | fpr=0.8841 | 7661.6 samples/s | 29.9 steps/s
[Step= 550] | Loss=5.58126 | acc=0.1210 | tpr=0.3936 | fpr=0.8840 | 14813.4 samples/s | 57.9 steps/s
Avg test loss: 5.58147, Avg test acc: 0.12092, Avg tpr: 0.39263, Avg fpr: 0.88402, total FA: 122745

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11446 | acc=0.9809 | tpr=0.9204 | fpr=0.0180 | 4157.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.12073 | acc=0.9800 | tpr=0.9403 | fpr=0.0192 | 7881.3 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.12217 | acc=0.9799 | tpr=0.9452 | fpr=0.0195 | 7822.0 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.12372 | acc=0.9801 | tpr=0.9486 | fpr=0.0193 | 8022.6 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.12325 | acc=0.9800 | tpr=0.9485 | fpr=0.0194 | 7939.5 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.12542 | acc=0.9799 | tpr=0.9498 | fpr=0.0195 | 7960.6 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.12539 | acc=0.9800 | tpr=0.9487 | fpr=0.0195 | 4668.2 samples/s | 18.2 steps/s
[Step= 400] | Loss=0.12669 | acc=0.9797 | tpr=0.9475 | fpr=0.0197 | 7708.7 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.12830 | acc=0.9795 | tpr=0.9464 | fpr=0.0199 | 7590.2 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.12729 | acc=0.9798 | tpr=0.9485 | fpr=0.0196 | 8031.7 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.12635 | acc=0.9800 | tpr=0.9507 | fpr=0.0195 | 14076.1 samples/s | 55.0 steps/s
Avg test loss: 0.12602, Avg test acc: 0.98005, Avg tpr: 0.95087, Avg fpr: 0.01942, total FA: 2697

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13543 | acc=0.9781 | tpr=0.9336 | fpr=0.0211 | 4169.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.14337 | acc=0.9775 | tpr=0.9574 | fpr=0.0221 | 7890.9 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.14504 | acc=0.9774 | tpr=0.9625 | fpr=0.0223 | 7887.8 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.14668 | acc=0.9776 | tpr=0.9639 | fpr=0.0222 | 7828.1 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.14644 | acc=0.9774 | tpr=0.9642 | fpr=0.0224 | 7783.3 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.14902 | acc=0.9770 | tpr=0.9644 | fpr=0.0228 | 8058.2 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.14914 | acc=0.9769 | tpr=0.9637 | fpr=0.0229 | 4613.9 samples/s | 18.0 steps/s
[Step= 400] | Loss=0.15069 | acc=0.9766 | tpr=0.9617 | fpr=0.0232 | 7933.6 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.15237 | acc=0.9764 | tpr=0.9591 | fpr=0.0233 | 7684.8 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.15120 | acc=0.9766 | tpr=0.9608 | fpr=0.0231 | 7856.4 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.15021 | acc=0.9768 | tpr=0.9618 | fpr=0.0229 | 13982.2 samples/s | 54.6 steps/s
Avg test loss: 0.14983, Avg test acc: 0.97683, Avg tpr: 0.96197, Avg fpr: 0.02290, total FA: 3180

server round 39/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=78001 Epoch=152.1] | Loss=0.00242 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.805 | L2-Norm(final)=19.904 | 4316.8 samples/s | 67.4 steps/s
[Step=78050 Epoch=152.2] | Loss=0.00816 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=19.912 | 4890.4 samples/s | 76.4 steps/s
[Step=78100 Epoch=152.3] | Loss=0.00865 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=19.921 | 5437.9 samples/s | 85.0 steps/s
[Step=78150 Epoch=152.4] | Loss=0.00884 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.806 | L2-Norm(final)=19.929 | 5534.8 samples/s | 86.5 steps/s
[Step=78200 Epoch=152.5] | Loss=0.00884 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=19.937 | 5527.9 samples/s | 86.4 steps/s
[Step=78250 Epoch=152.6] | Loss=0.00862 | Reg=0.00096 | acc=0.9688 | L2-Norm=9.806 | L2-Norm(final)=19.945 | 5583.0 samples/s | 87.2 steps/s
[Step=78300 Epoch=152.7] | Loss=0.00844 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=19.952 | 5525.0 samples/s | 86.3 steps/s
[Step=78350 Epoch=152.8] | Loss=0.00817 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=19.960 | 5574.1 samples/s | 87.1 steps/s
[Step=78400 Epoch=152.9] | Loss=0.00812 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=19.967 | 5514.6 samples/s | 86.2 steps/s
[Step=78450 Epoch=153.0] | Loss=0.00819 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=19.974 | 5528.3 samples/s | 86.4 steps/s
[Step=78500 Epoch=153.1] | Loss=0.00816 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=19.981 | 6932.8 samples/s | 108.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=78501 Epoch=153.1] | Loss=0.00255 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=20.049 | 4487.7 samples/s | 70.1 steps/s
[Step=78550 Epoch=153.2] | Loss=0.00767 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=20.052 | 4573.9 samples/s | 71.5 steps/s
[Step=78600 Epoch=153.3] | Loss=0.00839 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.827 | L2-Norm(final)=20.055 | 4711.2 samples/s | 73.6 steps/s
[Step=78650 Epoch=153.4] | Loss=0.00785 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.835 | L2-Norm(final)=20.059 | 4805.3 samples/s | 75.1 steps/s
[Step=78700 Epoch=153.5] | Loss=0.00793 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=20.062 | 4761.5 samples/s | 74.4 steps/s
[Step=78750 Epoch=153.6] | Loss=0.00806 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.848 | L2-Norm(final)=20.064 | 4791.4 samples/s | 74.9 steps/s
[Step=78800 Epoch=153.7] | Loss=0.00783 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.853 | L2-Norm(final)=20.067 | 4822.3 samples/s | 75.3 steps/s
[Step=78850 Epoch=153.8] | Loss=0.00806 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.858 | L2-Norm(final)=20.069 | 4801.2 samples/s | 75.0 steps/s
[Step=78900 Epoch=153.9] | Loss=0.00799 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.863 | L2-Norm(final)=20.072 | 4815.9 samples/s | 75.2 steps/s
[Step=78950 Epoch=154.0] | Loss=0.00793 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.867 | L2-Norm(final)=20.074 | 4770.4 samples/s | 74.5 steps/s
[Step=79000 Epoch=154.1] | Loss=0.00810 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.871 | L2-Norm(final)=20.077 | 5847.5 samples/s | 91.4 steps/s
[Step=79050 Epoch=154.2] | Loss=0.00814 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=20.080 | 2067.0 samples/s | 32.3 steps/s
[Step=79100 Epoch=154.3] | Loss=0.00782 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.879 | L2-Norm(final)=20.082 | 4784.3 samples/s | 74.8 steps/s
[Step=79150 Epoch=154.4] | Loss=0.00787 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.883 | L2-Norm(final)=20.085 | 4776.1 samples/s | 74.6 steps/s
[Step=79200 Epoch=154.5] | Loss=0.00776 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=20.087 | 4804.2 samples/s | 75.1 steps/s
[Step=79250 Epoch=154.6] | Loss=0.00769 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=20.089 | 4802.6 samples/s | 75.0 steps/s
[Step=79300 Epoch=154.7] | Loss=0.00749 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.893 | L2-Norm(final)=20.091 | 4811.4 samples/s | 75.2 steps/s
[Step=79350 Epoch=154.8] | Loss=0.00730 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.896 | L2-Norm(final)=20.094 | 4814.6 samples/s | 75.2 steps/s
[Step=79400 Epoch=154.9] | Loss=0.00723 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.899 | L2-Norm(final)=20.096 | 4803.3 samples/s | 75.1 steps/s
[Step=79450 Epoch=155.0] | Loss=0.00723 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.902 | L2-Norm(final)=20.099 | 4850.6 samples/s | 75.8 steps/s
[Step=79500 Epoch=155.1] | Loss=0.00721 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=20.101 | 5070.6 samples/s | 79.2 steps/s
[Step=79550 Epoch=155.2] | Loss=0.00711 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.908 | L2-Norm(final)=20.103 | 2055.7 samples/s | 32.1 steps/s
[Step=79600 Epoch=155.3] | Loss=0.00698 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.911 | L2-Norm(final)=20.106 | 4781.5 samples/s | 74.7 steps/s
[Step=79650 Epoch=155.3] | Loss=0.00694 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.914 | L2-Norm(final)=20.108 | 4776.1 samples/s | 74.6 steps/s
[Step=79700 Epoch=155.4] | Loss=0.00680 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.916 | L2-Norm(final)=20.110 | 4784.5 samples/s | 74.8 steps/s
[Step=79750 Epoch=155.5] | Loss=0.00673 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.919 | L2-Norm(final)=20.113 | 4788.6 samples/s | 74.8 steps/s
[Step=79800 Epoch=155.6] | Loss=0.00673 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.921 | L2-Norm(final)=20.115 | 4805.8 samples/s | 75.1 steps/s
[Step=79850 Epoch=155.7] | Loss=0.00665 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.924 | L2-Norm(final)=20.117 | 4770.3 samples/s | 74.5 steps/s
[Step=79900 Epoch=155.8] | Loss=0.00660 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.926 | L2-Norm(final)=20.120 | 4827.9 samples/s | 75.4 steps/s
[Step=79950 Epoch=155.9] | Loss=0.00665 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.929 | L2-Norm(final)=20.122 | 4757.6 samples/s | 74.3 steps/s
[Step=80000 Epoch=156.0] | Loss=0.00657 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.931 | L2-Norm(final)=20.124 | 4787.4 samples/s | 74.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step80000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=78001 Epoch=152.5] | Loss=0.00162 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.805 | L2-Norm(final)=19.990 | 4353.3 samples/s | 68.0 steps/s
[Step=78050 Epoch=152.6] | Loss=0.00783 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=19.999 | 4616.9 samples/s | 72.1 steps/s
[Step=78100 Epoch=152.7] | Loss=0.00895 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.806 | L2-Norm(final)=20.012 | 5422.4 samples/s | 84.7 steps/s
[Step=78150 Epoch=152.8] | Loss=0.00848 | Reg=0.00096 | acc=0.9688 | L2-Norm=9.806 | L2-Norm(final)=20.023 | 5522.3 samples/s | 86.3 steps/s
[Step=78200 Epoch=152.9] | Loss=0.00866 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=20.034 | 5518.3 samples/s | 86.2 steps/s
[Step=78250 Epoch=153.0] | Loss=0.00857 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=20.045 | 5477.1 samples/s | 85.6 steps/s
[Step=78300 Epoch=153.1] | Loss=0.00842 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=20.054 | 5549.1 samples/s | 86.7 steps/s
[Step=78350 Epoch=153.2] | Loss=0.00844 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=20.064 | 5651.7 samples/s | 88.3 steps/s
[Step=78400 Epoch=153.3] | Loss=0.00830 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=20.073 | 5384.3 samples/s | 84.1 steps/s
[Step=78450 Epoch=153.4] | Loss=0.00831 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=20.082 | 5644.9 samples/s | 88.2 steps/s
[Step=78500 Epoch=153.5] | Loss=0.00826 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.806 | L2-Norm(final)=20.090 | 6993.4 samples/s | 109.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=78501 Epoch=153.5] | Loss=0.01036 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.806 | L2-Norm(final)=20.177 | 4608.9 samples/s | 72.0 steps/s
[Step=78550 Epoch=153.6] | Loss=0.00788 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.817 | L2-Norm(final)=20.180 | 4608.6 samples/s | 72.0 steps/s
[Step=78600 Epoch=153.7] | Loss=0.00810 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.827 | L2-Norm(final)=20.182 | 4745.2 samples/s | 74.1 steps/s
[Step=78650 Epoch=153.8] | Loss=0.00830 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.834 | L2-Norm(final)=20.184 | 4757.8 samples/s | 74.3 steps/s
[Step=78700 Epoch=153.9] | Loss=0.00825 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.841 | L2-Norm(final)=20.187 | 4825.4 samples/s | 75.4 steps/s
[Step=78750 Epoch=154.0] | Loss=0.00821 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=20.190 | 4758.3 samples/s | 74.3 steps/s
[Step=78800 Epoch=154.1] | Loss=0.00782 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.853 | L2-Norm(final)=20.193 | 4755.7 samples/s | 74.3 steps/s
[Step=78850 Epoch=154.1] | Loss=0.00766 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.858 | L2-Norm(final)=20.196 | 4797.3 samples/s | 75.0 steps/s
[Step=78900 Epoch=154.2] | Loss=0.00756 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.863 | L2-Norm(final)=20.199 | 4808.7 samples/s | 75.1 steps/s
[Step=78950 Epoch=154.3] | Loss=0.00756 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.868 | L2-Norm(final)=20.202 | 4780.4 samples/s | 74.7 steps/s
[Step=79000 Epoch=154.4] | Loss=0.00752 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.873 | L2-Norm(final)=20.204 | 5927.6 samples/s | 92.6 steps/s
[Step=79050 Epoch=154.5] | Loss=0.00729 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=20.206 | 2097.5 samples/s | 32.8 steps/s
[Step=79100 Epoch=154.6] | Loss=0.00708 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.881 | L2-Norm(final)=20.209 | 4770.0 samples/s | 74.5 steps/s
[Step=79150 Epoch=154.7] | Loss=0.00691 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.884 | L2-Norm(final)=20.212 | 4803.5 samples/s | 75.1 steps/s
[Step=79200 Epoch=154.8] | Loss=0.00693 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.888 | L2-Norm(final)=20.214 | 4736.4 samples/s | 74.0 steps/s
[Step=79250 Epoch=154.9] | Loss=0.00679 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.891 | L2-Norm(final)=20.217 | 4789.3 samples/s | 74.8 steps/s
[Step=79300 Epoch=155.0] | Loss=0.00674 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.894 | L2-Norm(final)=20.219 | 4788.6 samples/s | 74.8 steps/s
[Step=79350 Epoch=155.1] | Loss=0.00668 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.897 | L2-Norm(final)=20.222 | 4786.3 samples/s | 74.8 steps/s
[Step=79400 Epoch=155.2] | Loss=0.00661 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=20.224 | 4770.0 samples/s | 74.5 steps/s
[Step=79450 Epoch=155.3] | Loss=0.00659 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.903 | L2-Norm(final)=20.226 | 4824.0 samples/s | 75.4 steps/s
[Step=79500 Epoch=155.4] | Loss=0.00656 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.905 | L2-Norm(final)=20.229 | 5137.0 samples/s | 80.3 steps/s
[Step=79550 Epoch=155.5] | Loss=0.00646 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.908 | L2-Norm(final)=20.231 | 2188.3 samples/s | 34.2 steps/s
[Step=79600 Epoch=155.6] | Loss=0.00636 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.910 | L2-Norm(final)=20.233 | 4809.9 samples/s | 75.2 steps/s
[Step=79650 Epoch=155.7] | Loss=0.00623 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.913 | L2-Norm(final)=20.236 | 4777.5 samples/s | 74.6 steps/s
[Step=79700 Epoch=155.8] | Loss=0.00636 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.915 | L2-Norm(final)=20.238 | 4764.4 samples/s | 74.4 steps/s
[Step=79750 Epoch=155.9] | Loss=0.00632 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.917 | L2-Norm(final)=20.240 | 4736.9 samples/s | 74.0 steps/s
[Step=79800 Epoch=156.0] | Loss=0.00633 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.920 | L2-Norm(final)=20.242 | 4817.9 samples/s | 75.3 steps/s
[Step=79850 Epoch=156.1] | Loss=0.00622 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.922 | L2-Norm(final)=20.244 | 4847.1 samples/s | 75.7 steps/s
[Step=79900 Epoch=156.2] | Loss=0.00622 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.924 | L2-Norm(final)=20.246 | 4711.3 samples/s | 73.6 steps/s
[Step=79950 Epoch=156.3] | Loss=0.00619 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.926 | L2-Norm(final)=20.248 | 4791.6 samples/s | 74.9 steps/s
[Step=80000 Epoch=156.4] | Loss=0.00613 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.928 | L2-Norm(final)=20.250 | 4798.9 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step80000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=78001 Epoch=298.9] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.805 | L2-Norm(final)=17.838 | 4505.5 samples/s | 70.4 steps/s
[Step=78050 Epoch=299.1] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=17.843 | 4227.6 samples/s | 66.1 steps/s
[Step=78100 Epoch=299.3] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=17.845 | 5036.5 samples/s | 78.7 steps/s
[Step=78150 Epoch=299.4] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=17.849 | 4927.1 samples/s | 77.0 steps/s
[Step=78200 Epoch=299.6] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.802 | L2-Norm(final)=17.853 | 5165.9 samples/s | 80.7 steps/s
[Step=78250 Epoch=299.8] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.802 | L2-Norm(final)=17.856 | 6877.6 samples/s | 107.5 steps/s
[Step=78300 Epoch=300.0] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.802 | L2-Norm(final)=17.859 | 2138.2 samples/s | 33.4 steps/s
[Step=78350 Epoch=300.2] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.802 | L2-Norm(final)=17.862 | 5174.9 samples/s | 80.9 steps/s
[Step=78400 Epoch=300.4] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.802 | L2-Norm(final)=17.866 | 5198.0 samples/s | 81.2 steps/s
[Step=78450 Epoch=300.6] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.802 | L2-Norm(final)=17.869 | 5221.3 samples/s | 81.6 steps/s
[Step=78500 Epoch=300.8] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.802 | L2-Norm(final)=17.872 | 5797.3 samples/s | 90.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=78501 Epoch=300.8] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.802 | L2-Norm(final)=17.905 | 4263.4 samples/s | 66.6 steps/s
[Step=78550 Epoch=301.0] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.797 | L2-Norm(final)=17.909 | 4647.6 samples/s | 72.6 steps/s
[Step=78600 Epoch=301.2] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.789 | L2-Norm(final)=17.911 | 4535.1 samples/s | 70.9 steps/s
[Step=78650 Epoch=301.4] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.779 | L2-Norm(final)=17.912 | 4527.3 samples/s | 70.7 steps/s
[Step=78700 Epoch=301.6] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.769 | L2-Norm(final)=17.914 | 4557.2 samples/s | 71.2 steps/s
[Step=78750 Epoch=301.7] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.759 | L2-Norm(final)=17.915 | 5706.2 samples/s | 89.2 steps/s
[Step=78800 Epoch=301.9] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.749 | L2-Norm(final)=17.916 | 2023.8 samples/s | 31.6 steps/s
[Step=78850 Epoch=302.1] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.739 | L2-Norm(final)=17.917 | 4553.9 samples/s | 71.2 steps/s
[Step=78900 Epoch=302.3] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.729 | L2-Norm(final)=17.917 | 4489.1 samples/s | 70.1 steps/s
[Step=78950 Epoch=302.5] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.719 | L2-Norm(final)=17.918 | 4556.2 samples/s | 71.2 steps/s
[Step=79000 Epoch=302.7] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.709 | L2-Norm(final)=17.919 | 5026.2 samples/s | 78.5 steps/s
[Step=79050 Epoch=302.9] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.698 | L2-Norm(final)=17.920 | 2108.5 samples/s | 32.9 steps/s
[Step=79100 Epoch=303.1] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.688 | L2-Norm(final)=17.921 | 4602.6 samples/s | 71.9 steps/s
[Step=79150 Epoch=303.3] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.677 | L2-Norm(final)=17.922 | 4521.0 samples/s | 70.6 steps/s
[Step=79200 Epoch=303.5] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=17.923 | 4572.0 samples/s | 71.4 steps/s
[Step=79250 Epoch=303.7] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.656 | L2-Norm(final)=17.924 | 4545.5 samples/s | 71.0 steps/s
[Step=79300 Epoch=303.8] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.645 | L2-Norm(final)=17.925 | 2182.3 samples/s | 34.1 steps/s
[Step=79350 Epoch=304.0] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.635 | L2-Norm(final)=17.925 | 4661.1 samples/s | 72.8 steps/s
[Step=79400 Epoch=304.2] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.624 | L2-Norm(final)=17.926 | 4570.5 samples/s | 71.4 steps/s
[Step=79450 Epoch=304.4] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.613 | L2-Norm(final)=17.927 | 4638.6 samples/s | 72.5 steps/s
[Step=79500 Epoch=304.6] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.602 | L2-Norm(final)=17.928 | 4485.6 samples/s | 70.1 steps/s
[Step=79550 Epoch=304.8] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=17.929 | 2252.9 samples/s | 35.2 steps/s
[Step=79600 Epoch=305.0] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.579 | L2-Norm(final)=17.930 | 4457.7 samples/s | 69.7 steps/s
[Step=79650 Epoch=305.2] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.568 | L2-Norm(final)=17.931 | 4589.7 samples/s | 71.7 steps/s
[Step=79700 Epoch=305.4] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.556 | L2-Norm(final)=17.932 | 4513.3 samples/s | 70.5 steps/s
[Step=79750 Epoch=305.6] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.545 | L2-Norm(final)=17.933 | 4586.9 samples/s | 71.7 steps/s
[Step=79800 Epoch=305.8] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.533 | L2-Norm(final)=17.934 | 6130.6 samples/s | 95.8 steps/s
[Step=79850 Epoch=306.0] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.521 | L2-Norm(final)=17.936 | 1967.6 samples/s | 30.7 steps/s
[Step=79900 Epoch=306.1] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.509 | L2-Norm(final)=17.937 | 4547.8 samples/s | 71.1 steps/s
[Step=79950 Epoch=306.3] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.497 | L2-Norm(final)=17.938 | 4565.6 samples/s | 71.3 steps/s
[Step=80000 Epoch=306.5] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.485 | L2-Norm(final)=17.939 | 4541.9 samples/s | 71.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step80000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=78001 Epoch=300.3] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.805 | L2-Norm(final)=18.566 | 4649.0 samples/s | 72.6 steps/s
[Step=78050 Epoch=300.4] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=18.568 | 4647.0 samples/s | 72.6 steps/s
[Step=78100 Epoch=300.6] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=18.572 | 5070.7 samples/s | 79.2 steps/s
[Step=78150 Epoch=300.8] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=18.576 | 5179.6 samples/s | 80.9 steps/s
[Step=78200 Epoch=301.0] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=18.579 | 5143.2 samples/s | 80.4 steps/s
[Step=78250 Epoch=301.2] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=18.584 | 7033.4 samples/s | 109.9 steps/s
[Step=78300 Epoch=301.4] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=18.588 | 2129.2 samples/s | 33.3 steps/s
[Step=78350 Epoch=301.6] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=18.592 | 5171.4 samples/s | 80.8 steps/s
[Step=78400 Epoch=301.8] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=18.597 | 5238.9 samples/s | 81.9 steps/s
[Step=78450 Epoch=302.0] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=18.601 | 5193.5 samples/s | 81.1 steps/s
[Step=78500 Epoch=302.2] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=18.605 | 6075.3 samples/s | 94.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=78501 Epoch=302.2] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=18.647 | 4324.7 samples/s | 67.6 steps/s
[Step=78550 Epoch=302.4] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.800 | L2-Norm(final)=18.650 | 4504.1 samples/s | 70.4 steps/s
[Step=78600 Epoch=302.6] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.796 | L2-Norm(final)=18.653 | 4670.2 samples/s | 73.0 steps/s
[Step=78650 Epoch=302.8] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.788 | L2-Norm(final)=18.654 | 4477.9 samples/s | 70.0 steps/s
[Step=78700 Epoch=302.9] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.779 | L2-Norm(final)=18.656 | 4555.0 samples/s | 71.2 steps/s
[Step=78750 Epoch=303.1] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.771 | L2-Norm(final)=18.658 | 5834.6 samples/s | 91.2 steps/s
[Step=78800 Epoch=303.3] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.762 | L2-Norm(final)=18.659 | 2003.1 samples/s | 31.3 steps/s
[Step=78850 Epoch=303.5] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.753 | L2-Norm(final)=18.660 | 4563.9 samples/s | 71.3 steps/s
[Step=78900 Epoch=303.7] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.744 | L2-Norm(final)=18.661 | 4521.6 samples/s | 70.6 steps/s
[Step=78950 Epoch=303.9] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.735 | L2-Norm(final)=18.662 | 4564.2 samples/s | 71.3 steps/s
[Step=79000 Epoch=304.1] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.726 | L2-Norm(final)=18.664 | 5179.1 samples/s | 80.9 steps/s
[Step=79050 Epoch=304.3] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.717 | L2-Norm(final)=18.665 | 1356.3 samples/s | 21.2 steps/s
[Step=79100 Epoch=304.5] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.707 | L2-Norm(final)=18.666 | 4582.3 samples/s | 71.6 steps/s
[Step=79150 Epoch=304.7] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.698 | L2-Norm(final)=18.667 | 4134.8 samples/s | 64.6 steps/s
[Step=79200 Epoch=304.9] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.689 | L2-Norm(final)=18.668 | 4557.4 samples/s | 71.2 steps/s
[Step=79250 Epoch=305.1] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=18.669 | 4151.4 samples/s | 64.9 steps/s
[Step=79300 Epoch=305.3] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.670 | L2-Norm(final)=18.670 | 2155.1 samples/s | 33.7 steps/s
[Step=79350 Epoch=305.4] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.660 | L2-Norm(final)=18.671 | 4582.4 samples/s | 71.6 steps/s
[Step=79400 Epoch=305.6] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=18.672 | 4567.4 samples/s | 71.4 steps/s
[Step=79450 Epoch=305.8] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.640 | L2-Norm(final)=18.673 | 4631.9 samples/s | 72.4 steps/s
[Step=79500 Epoch=306.0] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.631 | L2-Norm(final)=18.674 | 4532.8 samples/s | 70.8 steps/s
[Step=79550 Epoch=306.2] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.621 | L2-Norm(final)=18.675 | 2272.3 samples/s | 35.5 steps/s
[Step=79600 Epoch=306.4] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.610 | L2-Norm(final)=18.677 | 4488.9 samples/s | 70.1 steps/s
[Step=79650 Epoch=306.6] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.600 | L2-Norm(final)=18.678 | 4614.8 samples/s | 72.1 steps/s
[Step=79700 Epoch=306.8] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.590 | L2-Norm(final)=18.679 | 4467.8 samples/s | 69.8 steps/s
[Step=79750 Epoch=307.0] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.580 | L2-Norm(final)=18.680 | 4512.2 samples/s | 70.5 steps/s
[Step=79800 Epoch=307.2] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.569 | L2-Norm(final)=18.681 | 6638.7 samples/s | 103.7 steps/s
[Step=79850 Epoch=307.4] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.559 | L2-Norm(final)=18.682 | 1936.8 samples/s | 30.3 steps/s
[Step=79900 Epoch=307.6] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.548 | L2-Norm(final)=18.684 | 4592.0 samples/s | 71.7 steps/s
[Step=79950 Epoch=307.8] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.537 | L2-Norm(final)=18.685 | 4520.1 samples/s | 70.6 steps/s
[Step=80000 Epoch=308.0] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.526 | L2-Norm(final)=18.686 | 4541.8 samples/s | 71.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step80000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07458 | acc=0.9684 | tpr=0.9764 | fpr=0.0488 | 4128.5 samples/s | 16.1 steps/s
Avg test loss: 0.07406, Avg test acc: 0.96863, Avg tpr: 0.97686, Avg fpr: 0.04948, total FA: 386

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07695 | acc=0.9694 | tpr=0.9795 | fpr=0.0525 | 4199.6 samples/s | 16.4 steps/s
Avg test loss: 0.07735, Avg test acc: 0.96951, Avg tpr: 0.98030, Avg fpr: 0.05422, total FA: 423

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.44738 | acc=0.3045 | tpr=0.0056 | fpr=0.0466 | 4138.3 samples/s | 16.2 steps/s
Avg test loss: 6.46110, Avg test acc: 0.30071, Avg tpr: 0.00536, Avg fpr: 0.04974, total FA: 388

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.24319 | acc=0.2965 | tpr=0.0073 | fpr=0.0756 | 4182.8 samples/s | 16.3 steps/s
Avg test loss: 6.25686, Avg test acc: 0.29309, Avg tpr: 0.00670, Avg fpr: 0.07704, total FA: 601

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.47820 | acc=0.1269 | tpr=0.3850 | fpr=0.8778 | 4159.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.42005 | acc=0.1278 | tpr=0.3817 | fpr=0.8770 | 7955.2 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.42607 | acc=0.1272 | tpr=0.3890 | fpr=0.8777 | 7873.4 samples/s | 30.8 steps/s
[Step= 200] | Loss=5.42371 | acc=0.1280 | tpr=0.3880 | fpr=0.8768 | 7668.7 samples/s | 30.0 steps/s
[Step= 250] | Loss=5.42252 | acc=0.1279 | tpr=0.3790 | fpr=0.8767 | 7994.5 samples/s | 31.2 steps/s
[Step= 300] | Loss=5.42736 | acc=0.1272 | tpr=0.3731 | fpr=0.8773 | 7678.2 samples/s | 30.0 steps/s
[Step= 350] | Loss=5.43675 | acc=0.1268 | tpr=0.3657 | fpr=0.8775 | 7882.8 samples/s | 30.8 steps/s
[Step= 400] | Loss=5.43084 | acc=0.1264 | tpr=0.3567 | fpr=0.8778 | 8038.8 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.43198 | acc=0.1260 | tpr=0.3544 | fpr=0.8782 | 7724.5 samples/s | 30.2 steps/s
[Step= 500] | Loss=5.43366 | acc=0.1257 | tpr=0.3555 | fpr=0.8785 | 7912.7 samples/s | 30.9 steps/s
[Step= 550] | Loss=5.43618 | acc=0.1257 | tpr=0.3558 | fpr=0.8784 | 13905.9 samples/s | 54.3 steps/s
Avg test loss: 5.43671, Avg test acc: 0.12565, Avg tpr: 0.35539, Avg fpr: 0.87852, total FA: 121981

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.76235 | acc=0.1255 | tpr=0.3938 | fpr=0.8794 | 4156.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.70368 | acc=0.1269 | tpr=0.3902 | fpr=0.8780 | 7997.1 samples/s | 31.2 steps/s
[Step= 150] | Loss=5.71172 | acc=0.1264 | tpr=0.3991 | fpr=0.8787 | 8308.1 samples/s | 32.5 steps/s
[Step= 200] | Loss=5.70699 | acc=0.1265 | tpr=0.3967 | fpr=0.8784 | 7313.1 samples/s | 28.6 steps/s
[Step= 250] | Loss=5.70676 | acc=0.1260 | tpr=0.3843 | fpr=0.8788 | 7709.1 samples/s | 30.1 steps/s
[Step= 300] | Loss=5.71328 | acc=0.1253 | tpr=0.3811 | fpr=0.8793 | 8130.6 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.72274 | acc=0.1248 | tpr=0.3770 | fpr=0.8798 | 7338.9 samples/s | 28.7 steps/s
[Step= 400] | Loss=5.71531 | acc=0.1244 | tpr=0.3687 | fpr=0.8801 | 7671.3 samples/s | 30.0 steps/s
[Step= 450] | Loss=5.71533 | acc=0.1239 | tpr=0.3671 | fpr=0.8805 | 8045.2 samples/s | 31.4 steps/s
[Step= 500] | Loss=5.71683 | acc=0.1235 | tpr=0.3665 | fpr=0.8809 | 7849.4 samples/s | 30.7 steps/s
[Step= 550] | Loss=5.71968 | acc=0.1237 | tpr=0.3665 | fpr=0.8808 | 14259.3 samples/s | 55.7 steps/s
Avg test loss: 5.71992, Avg test acc: 0.12359, Avg tpr: 0.36609, Avg fpr: 0.88082, total FA: 122300

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11393 | acc=0.9804 | tpr=0.9292 | fpr=0.0187 | 4166.2 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.12027 | acc=0.9793 | tpr=0.9446 | fpr=0.0201 | 7909.2 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.12197 | acc=0.9792 | tpr=0.9467 | fpr=0.0202 | 7833.7 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.12351 | acc=0.9796 | tpr=0.9508 | fpr=0.0199 | 7883.6 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.12314 | acc=0.9794 | tpr=0.9511 | fpr=0.0201 | 7834.8 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.12528 | acc=0.9793 | tpr=0.9520 | fpr=0.0202 | 8707.1 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.12523 | acc=0.9793 | tpr=0.9530 | fpr=0.0202 | 7227.7 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.12645 | acc=0.9790 | tpr=0.9513 | fpr=0.0205 | 7838.2 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.12814 | acc=0.9788 | tpr=0.9494 | fpr=0.0207 | 7668.4 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.12717 | acc=0.9791 | tpr=0.9511 | fpr=0.0204 | 8007.0 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.12614 | acc=0.9793 | tpr=0.9530 | fpr=0.0202 | 13991.0 samples/s | 54.7 steps/s
Avg test loss: 0.12582, Avg test acc: 0.97932, Avg tpr: 0.95325, Avg fpr: 0.02021, total FA: 2806

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12901 | acc=0.9791 | tpr=0.9336 | fpr=0.0200 | 4190.9 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.13679 | acc=0.9783 | tpr=0.9531 | fpr=0.0212 | 7906.7 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.13863 | acc=0.9779 | tpr=0.9568 | fpr=0.0217 | 7747.2 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.14021 | acc=0.9780 | tpr=0.9596 | fpr=0.0217 | 7789.1 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.13999 | acc=0.9778 | tpr=0.9590 | fpr=0.0219 | 7921.5 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.14248 | acc=0.9774 | tpr=0.9593 | fpr=0.0223 | 7811.0 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.14243 | acc=0.9774 | tpr=0.9593 | fpr=0.0223 | 7830.0 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.14385 | acc=0.9771 | tpr=0.9573 | fpr=0.0225 | 7939.4 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.14557 | acc=0.9769 | tpr=0.9547 | fpr=0.0227 | 7725.6 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.14447 | acc=0.9771 | tpr=0.9564 | fpr=0.0225 | 7622.7 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.14346 | acc=0.9773 | tpr=0.9578 | fpr=0.0223 | 15162.3 samples/s | 59.2 steps/s
Avg test loss: 0.14310, Avg test acc: 0.97734, Avg tpr: 0.95800, Avg fpr: 0.02231, total FA: 3098

server round 40/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=80001 Epoch=156.0] | Loss=0.00075 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.191 | 4818.8 samples/s | 75.3 steps/s
[Step=80050 Epoch=156.1] | Loss=0.00841 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.539 | L2-Norm(final)=20.197 | 4621.3 samples/s | 72.2 steps/s
[Step=80100 Epoch=156.2] | Loss=0.00826 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.201 | 5547.4 samples/s | 86.7 steps/s
[Step=80150 Epoch=156.3] | Loss=0.00829 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.206 | 5549.9 samples/s | 86.7 steps/s
[Step=80200 Epoch=156.4] | Loss=0.00829 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.211 | 5613.1 samples/s | 87.7 steps/s
[Step=80250 Epoch=156.5] | Loss=0.00821 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.215 | 5483.8 samples/s | 85.7 steps/s
[Step=80300 Epoch=156.6] | Loss=0.00831 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.219 | 5560.8 samples/s | 86.9 steps/s
[Step=80350 Epoch=156.7] | Loss=0.00814 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.224 | 5705.7 samples/s | 89.2 steps/s
[Step=80400 Epoch=156.8] | Loss=0.00813 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.228 | 5444.6 samples/s | 85.1 steps/s
[Step=80450 Epoch=156.9] | Loss=0.00825 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.232 | 5532.7 samples/s | 86.4 steps/s
[Step=80500 Epoch=157.0] | Loss=0.00831 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.236 | 7011.2 samples/s | 109.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=80501 Epoch=157.0] | Loss=0.00188 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.276 | 4381.8 samples/s | 68.5 steps/s
[Step=80550 Epoch=157.1] | Loss=0.00763 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.542 | L2-Norm(final)=20.278 | 4467.5 samples/s | 69.8 steps/s
[Step=80600 Epoch=157.2] | Loss=0.00848 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.547 | L2-Norm(final)=20.281 | 4753.2 samples/s | 74.3 steps/s
[Step=80650 Epoch=157.3] | Loss=0.00836 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.552 | L2-Norm(final)=20.284 | 4776.9 samples/s | 74.6 steps/s
[Step=80700 Epoch=157.4] | Loss=0.00824 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.556 | L2-Norm(final)=20.287 | 4754.5 samples/s | 74.3 steps/s
[Step=80750 Epoch=157.5] | Loss=0.00797 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.560 | L2-Norm(final)=20.290 | 4728.5 samples/s | 73.9 steps/s
[Step=80800 Epoch=157.6] | Loss=0.00794 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.564 | L2-Norm(final)=20.293 | 4788.9 samples/s | 74.8 steps/s
[Step=80850 Epoch=157.7] | Loss=0.00765 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.567 | L2-Norm(final)=20.295 | 4808.5 samples/s | 75.1 steps/s
[Step=80900 Epoch=157.8] | Loss=0.00766 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.570 | L2-Norm(final)=20.298 | 4814.1 samples/s | 75.2 steps/s
[Step=80950 Epoch=157.9] | Loss=0.00744 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.574 | L2-Norm(final)=20.301 | 4807.2 samples/s | 75.1 steps/s
[Step=81000 Epoch=158.0] | Loss=0.00739 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=20.304 | 5792.5 samples/s | 90.5 steps/s
[Step=81050 Epoch=158.1] | Loss=0.00724 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.580 | L2-Norm(final)=20.306 | 2073.3 samples/s | 32.4 steps/s
[Step=81100 Epoch=158.2] | Loss=0.00705 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.582 | L2-Norm(final)=20.309 | 4778.5 samples/s | 74.7 steps/s
[Step=81150 Epoch=158.3] | Loss=0.00687 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.585 | L2-Norm(final)=20.311 | 4802.1 samples/s | 75.0 steps/s
[Step=81200 Epoch=158.4] | Loss=0.00674 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.587 | L2-Norm(final)=20.314 | 4812.0 samples/s | 75.2 steps/s
[Step=81250 Epoch=158.5] | Loss=0.00653 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.590 | L2-Norm(final)=20.317 | 4755.7 samples/s | 74.3 steps/s
[Step=81300 Epoch=158.6] | Loss=0.00640 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.592 | L2-Norm(final)=20.319 | 4809.0 samples/s | 75.1 steps/s
[Step=81350 Epoch=158.7] | Loss=0.00643 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.595 | L2-Norm(final)=20.322 | 4831.1 samples/s | 75.5 steps/s
[Step=81400 Epoch=158.8] | Loss=0.00639 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.597 | L2-Norm(final)=20.324 | 4864.7 samples/s | 76.0 steps/s
[Step=81450 Epoch=158.9] | Loss=0.00634 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.599 | L2-Norm(final)=20.326 | 4729.7 samples/s | 73.9 steps/s
[Step=81500 Epoch=159.0] | Loss=0.00634 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.601 | L2-Norm(final)=20.329 | 5085.5 samples/s | 79.5 steps/s
[Step=81550 Epoch=159.1] | Loss=0.00622 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=20.331 | 2138.4 samples/s | 33.4 steps/s
[Step=81600 Epoch=159.2] | Loss=0.00615 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.605 | L2-Norm(final)=20.333 | 4787.9 samples/s | 74.8 steps/s
[Step=81650 Epoch=159.2] | Loss=0.00613 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.607 | L2-Norm(final)=20.335 | 4808.5 samples/s | 75.1 steps/s
[Step=81700 Epoch=159.3] | Loss=0.00604 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.608 | L2-Norm(final)=20.338 | 4729.9 samples/s | 73.9 steps/s
[Step=81750 Epoch=159.4] | Loss=0.00599 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.610 | L2-Norm(final)=20.340 | 4796.0 samples/s | 74.9 steps/s
[Step=81800 Epoch=159.5] | Loss=0.00589 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.612 | L2-Norm(final)=20.342 | 4786.1 samples/s | 74.8 steps/s
[Step=81850 Epoch=159.6] | Loss=0.00583 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.614 | L2-Norm(final)=20.344 | 4827.9 samples/s | 75.4 steps/s
[Step=81900 Epoch=159.7] | Loss=0.00577 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.615 | L2-Norm(final)=20.346 | 4800.0 samples/s | 75.0 steps/s
[Step=81950 Epoch=159.8] | Loss=0.00575 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.617 | L2-Norm(final)=20.349 | 4759.9 samples/s | 74.4 steps/s
[Step=82000 Epoch=159.9] | Loss=0.00573 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.619 | L2-Norm(final)=20.351 | 4790.5 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step82000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=80001 Epoch=156.4] | Loss=0.00188 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.308 | 4421.5 samples/s | 69.1 steps/s
[Step=80050 Epoch=156.5] | Loss=0.00680 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.311 | 5457.0 samples/s | 85.3 steps/s
[Step=80100 Epoch=156.6] | Loss=0.00771 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.314 | 5499.1 samples/s | 85.9 steps/s
[Step=80150 Epoch=156.7] | Loss=0.00761 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.318 | 5489.7 samples/s | 85.8 steps/s
[Step=80200 Epoch=156.8] | Loss=0.00732 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.322 | 5492.3 samples/s | 85.8 steps/s
[Step=80250 Epoch=156.9] | Loss=0.00724 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.539 | L2-Norm(final)=20.326 | 5465.1 samples/s | 85.4 steps/s
[Step=80300 Epoch=157.0] | Loss=0.00720 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.330 | 5597.4 samples/s | 87.5 steps/s
[Step=80350 Epoch=157.1] | Loss=0.00758 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.334 | 5538.1 samples/s | 86.5 steps/s
[Step=80400 Epoch=157.2] | Loss=0.00745 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.539 | L2-Norm(final)=20.338 | 5567.0 samples/s | 87.0 steps/s
[Step=80450 Epoch=157.3] | Loss=0.00733 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.342 | 5539.2 samples/s | 86.5 steps/s
[Step=80500 Epoch=157.4] | Loss=0.00746 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=20.346 | 7104.8 samples/s | 111.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=80501 Epoch=157.4] | Loss=0.01225 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.539 | L2-Norm(final)=20.390 | 4374.7 samples/s | 68.4 steps/s
[Step=80550 Epoch=157.5] | Loss=0.00728 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.543 | L2-Norm(final)=20.393 | 4755.1 samples/s | 74.3 steps/s
[Step=80600 Epoch=157.6] | Loss=0.00678 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.548 | L2-Norm(final)=20.397 | 4836.9 samples/s | 75.6 steps/s
[Step=80650 Epoch=157.7] | Loss=0.00705 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.553 | L2-Norm(final)=20.401 | 4697.5 samples/s | 73.4 steps/s
[Step=80700 Epoch=157.8] | Loss=0.00722 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.557 | L2-Norm(final)=20.404 | 4759.9 samples/s | 74.4 steps/s
[Step=80750 Epoch=157.9] | Loss=0.00702 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.561 | L2-Norm(final)=20.406 | 4806.3 samples/s | 75.1 steps/s
[Step=80800 Epoch=158.0] | Loss=0.00691 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.565 | L2-Norm(final)=20.409 | 4777.4 samples/s | 74.6 steps/s
[Step=80850 Epoch=158.1] | Loss=0.00677 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.568 | L2-Norm(final)=20.412 | 4817.0 samples/s | 75.3 steps/s
[Step=80900 Epoch=158.2] | Loss=0.00687 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.572 | L2-Norm(final)=20.415 | 4841.2 samples/s | 75.6 steps/s
[Step=80950 Epoch=158.3] | Loss=0.00684 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.575 | L2-Norm(final)=20.418 | 4733.4 samples/s | 74.0 steps/s
[Step=81000 Epoch=158.4] | Loss=0.00671 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.578 | L2-Norm(final)=20.420 | 5925.9 samples/s | 92.6 steps/s
[Step=81050 Epoch=158.5] | Loss=0.00678 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.580 | L2-Norm(final)=20.423 | 2079.0 samples/s | 32.5 steps/s
[Step=81100 Epoch=158.5] | Loss=0.00654 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.583 | L2-Norm(final)=20.426 | 4745.6 samples/s | 74.2 steps/s
[Step=81150 Epoch=158.6] | Loss=0.00643 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.586 | L2-Norm(final)=20.428 | 4777.9 samples/s | 74.7 steps/s
[Step=81200 Epoch=158.7] | Loss=0.00631 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.588 | L2-Norm(final)=20.431 | 4743.7 samples/s | 74.1 steps/s
[Step=81250 Epoch=158.8] | Loss=0.00613 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.590 | L2-Norm(final)=20.433 | 4802.4 samples/s | 75.0 steps/s
[Step=81300 Epoch=158.9] | Loss=0.00598 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.592 | L2-Norm(final)=20.436 | 4807.1 samples/s | 75.1 steps/s
[Step=81350 Epoch=159.0] | Loss=0.00596 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=20.438 | 4856.3 samples/s | 75.9 steps/s
[Step=81400 Epoch=159.1] | Loss=0.00596 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.596 | L2-Norm(final)=20.441 | 4713.8 samples/s | 73.7 steps/s
[Step=81450 Epoch=159.2] | Loss=0.00584 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.598 | L2-Norm(final)=20.443 | 4824.7 samples/s | 75.4 steps/s
[Step=81500 Epoch=159.3] | Loss=0.00574 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.600 | L2-Norm(final)=20.445 | 5186.1 samples/s | 81.0 steps/s
[Step=81550 Epoch=159.4] | Loss=0.00572 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.602 | L2-Norm(final)=20.448 | 2184.4 samples/s | 34.1 steps/s
[Step=81600 Epoch=159.5] | Loss=0.00564 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=20.450 | 4749.9 samples/s | 74.2 steps/s
[Step=81650 Epoch=159.6] | Loss=0.00559 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=20.452 | 4772.1 samples/s | 74.6 steps/s
[Step=81700 Epoch=159.7] | Loss=0.00557 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.608 | L2-Norm(final)=20.455 | 4754.5 samples/s | 74.3 steps/s
[Step=81750 Epoch=159.8] | Loss=0.00547 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.610 | L2-Norm(final)=20.457 | 4778.9 samples/s | 74.7 steps/s
[Step=81800 Epoch=159.9] | Loss=0.00544 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.612 | L2-Norm(final)=20.459 | 4801.0 samples/s | 75.0 steps/s
[Step=81850 Epoch=160.0] | Loss=0.00538 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.613 | L2-Norm(final)=20.461 | 4812.6 samples/s | 75.2 steps/s
[Step=81900 Epoch=160.1] | Loss=0.00537 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.615 | L2-Norm(final)=20.463 | 4829.7 samples/s | 75.5 steps/s
[Step=81950 Epoch=160.2] | Loss=0.00533 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.617 | L2-Norm(final)=20.465 | 4758.6 samples/s | 74.4 steps/s
[Step=82000 Epoch=160.3] | Loss=0.00533 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.618 | L2-Norm(final)=20.467 | 4786.3 samples/s | 74.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step82000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=80001 Epoch=306.5] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=17.976 | 4770.4 samples/s | 74.5 steps/s
[Step=80050 Epoch=306.7] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=17.980 | 4622.8 samples/s | 72.2 steps/s
[Step=80100 Epoch=306.9] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=17.986 | 5138.6 samples/s | 80.3 steps/s
[Step=80150 Epoch=307.1] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=17.990 | 5182.1 samples/s | 81.0 steps/s
[Step=80200 Epoch=307.3] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=17.995 | 5243.3 samples/s | 81.9 steps/s
[Step=80250 Epoch=307.5] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=17.999 | 6749.6 samples/s | 105.5 steps/s
[Step=80300 Epoch=307.7] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=18.004 | 2130.3 samples/s | 33.3 steps/s
[Step=80350 Epoch=307.9] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=18.008 | 5095.1 samples/s | 79.6 steps/s
[Step=80400 Epoch=308.1] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=18.012 | 5131.9 samples/s | 80.2 steps/s
[Step=80450 Epoch=308.3] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=18.017 | 5419.7 samples/s | 84.7 steps/s
[Step=80500 Epoch=308.4] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=18.021 | 5612.9 samples/s | 87.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=80501 Epoch=308.5] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=18.063 | 4584.1 samples/s | 71.6 steps/s
[Step=80550 Epoch=308.6] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.529 | L2-Norm(final)=18.067 | 4281.4 samples/s | 66.9 steps/s
[Step=80600 Epoch=308.8] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.520 | L2-Norm(final)=18.070 | 4516.7 samples/s | 70.6 steps/s
[Step=80650 Epoch=309.0] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.509 | L2-Norm(final)=18.071 | 4559.5 samples/s | 71.2 steps/s
[Step=80700 Epoch=309.2] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.499 | L2-Norm(final)=18.073 | 4582.7 samples/s | 71.6 steps/s
[Step=80750 Epoch=309.4] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.489 | L2-Norm(final)=18.074 | 5677.1 samples/s | 88.7 steps/s
[Step=80800 Epoch=309.6] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.478 | L2-Norm(final)=18.075 | 1986.1 samples/s | 31.0 steps/s
[Step=80850 Epoch=309.8] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.468 | L2-Norm(final)=18.077 | 4471.9 samples/s | 69.9 steps/s
[Step=80900 Epoch=310.0] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.457 | L2-Norm(final)=18.078 | 4360.5 samples/s | 68.1 steps/s
[Step=80950 Epoch=310.2] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.446 | L2-Norm(final)=18.079 | 4532.9 samples/s | 70.8 steps/s
[Step=81000 Epoch=310.4] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.435 | L2-Norm(final)=18.079 | 5062.4 samples/s | 79.1 steps/s
[Step=81050 Epoch=310.6] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.424 | L2-Norm(final)=18.080 | 2093.4 samples/s | 32.7 steps/s
[Step=81100 Epoch=310.7] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.413 | L2-Norm(final)=18.081 | 4530.4 samples/s | 70.8 steps/s
[Step=81150 Epoch=310.9] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.402 | L2-Norm(final)=18.082 | 4547.0 samples/s | 71.0 steps/s
[Step=81200 Epoch=311.1] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.390 | L2-Norm(final)=18.083 | 4518.4 samples/s | 70.6 steps/s
[Step=81250 Epoch=311.3] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.379 | L2-Norm(final)=18.084 | 4591.1 samples/s | 71.7 steps/s
[Step=81300 Epoch=311.5] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.367 | L2-Norm(final)=18.084 | 2174.0 samples/s | 34.0 steps/s
[Step=81350 Epoch=311.7] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.355 | L2-Norm(final)=18.085 | 4586.7 samples/s | 71.7 steps/s
[Step=81400 Epoch=311.9] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.344 | L2-Norm(final)=18.086 | 4538.4 samples/s | 70.9 steps/s
[Step=81450 Epoch=312.1] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.332 | L2-Norm(final)=18.087 | 4535.5 samples/s | 70.9 steps/s
[Step=81500 Epoch=312.3] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.320 | L2-Norm(final)=18.088 | 4490.7 samples/s | 70.2 steps/s
[Step=81550 Epoch=312.5] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.307 | L2-Norm(final)=18.089 | 2196.3 samples/s | 34.3 steps/s
[Step=81600 Epoch=312.7] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=18.090 | 4561.9 samples/s | 71.3 steps/s
[Step=81650 Epoch=312.9] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.283 | L2-Norm(final)=18.091 | 4599.4 samples/s | 71.9 steps/s
[Step=81700 Epoch=313.0] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.270 | L2-Norm(final)=18.092 | 4531.0 samples/s | 70.8 steps/s
[Step=81750 Epoch=313.2] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.257 | L2-Norm(final)=18.093 | 4519.0 samples/s | 70.6 steps/s
[Step=81800 Epoch=313.4] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.245 | L2-Norm(final)=18.094 | 6192.2 samples/s | 96.8 steps/s
[Step=81850 Epoch=313.6] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.232 | L2-Norm(final)=18.095 | 1951.7 samples/s | 30.5 steps/s
[Step=81900 Epoch=313.8] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.219 | L2-Norm(final)=18.096 | 4507.5 samples/s | 70.4 steps/s
[Step=81950 Epoch=314.0] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.205 | L2-Norm(final)=18.097 | 4560.1 samples/s | 71.3 steps/s
[Step=82000 Epoch=314.2] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.192 | L2-Norm(final)=18.098 | 4503.7 samples/s | 70.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step82000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=80001 Epoch=308.0] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=18.724 | 4610.0 samples/s | 72.0 steps/s
[Step=80050 Epoch=308.1] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.537 | L2-Norm(final)=18.727 | 4769.6 samples/s | 74.5 steps/s
[Step=80100 Epoch=308.3] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=18.731 | 5279.1 samples/s | 82.5 steps/s
[Step=80150 Epoch=308.5] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=18.736 | 5162.8 samples/s | 80.7 steps/s
[Step=80200 Epoch=308.7] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=18.742 | 5135.2 samples/s | 80.2 steps/s
[Step=80250 Epoch=308.9] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=18.746 | 7001.0 samples/s | 109.4 steps/s
[Step=80300 Epoch=309.1] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=18.751 | 2107.5 samples/s | 32.9 steps/s
[Step=80350 Epoch=309.3] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=18.756 | 5194.1 samples/s | 81.2 steps/s
[Step=80400 Epoch=309.5] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=18.761 | 5199.9 samples/s | 81.2 steps/s
[Step=80450 Epoch=309.7] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=18.766 | 5238.8 samples/s | 81.9 steps/s
[Step=80500 Epoch=309.9] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=18.770 | 6056.6 samples/s | 94.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=80501 Epoch=309.9] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=18.817 | 4906.1 samples/s | 76.7 steps/s
[Step=80550 Epoch=310.1] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.531 | L2-Norm(final)=18.820 | 3982.6 samples/s | 62.2 steps/s
[Step=80600 Epoch=310.3] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.525 | L2-Norm(final)=18.823 | 4598.2 samples/s | 71.8 steps/s
[Step=80650 Epoch=310.5] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.517 | L2-Norm(final)=18.824 | 4583.8 samples/s | 71.6 steps/s
[Step=80700 Epoch=310.6] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.509 | L2-Norm(final)=18.826 | 4535.2 samples/s | 70.9 steps/s
[Step=80750 Epoch=310.8] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.500 | L2-Norm(final)=18.827 | 5723.6 samples/s | 89.4 steps/s
[Step=80800 Epoch=311.0] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.491 | L2-Norm(final)=18.828 | 2002.6 samples/s | 31.3 steps/s
[Step=80850 Epoch=311.2] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.482 | L2-Norm(final)=18.829 | 4565.7 samples/s | 71.3 steps/s
[Step=80900 Epoch=311.4] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.472 | L2-Norm(final)=18.830 | 4565.3 samples/s | 71.3 steps/s
[Step=80950 Epoch=311.6] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.463 | L2-Norm(final)=18.831 | 4519.6 samples/s | 70.6 steps/s
[Step=81000 Epoch=311.8] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.453 | L2-Norm(final)=18.832 | 5173.1 samples/s | 80.8 steps/s
[Step=81050 Epoch=312.0] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.443 | L2-Norm(final)=18.833 | 2093.9 samples/s | 32.7 steps/s
[Step=81100 Epoch=312.2] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.434 | L2-Norm(final)=18.834 | 4529.4 samples/s | 70.8 steps/s
[Step=81150 Epoch=312.4] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.424 | L2-Norm(final)=18.835 | 4620.1 samples/s | 72.2 steps/s
[Step=81200 Epoch=312.6] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.414 | L2-Norm(final)=18.836 | 4528.3 samples/s | 70.8 steps/s
[Step=81250 Epoch=312.8] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.403 | L2-Norm(final)=18.837 | 4610.1 samples/s | 72.0 steps/s
[Step=81300 Epoch=313.0] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.393 | L2-Norm(final)=18.838 | 2207.5 samples/s | 34.5 steps/s
[Step=81350 Epoch=313.1] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.383 | L2-Norm(final)=18.839 | 4520.4 samples/s | 70.6 steps/s
[Step=81400 Epoch=313.3] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.372 | L2-Norm(final)=18.839 | 4596.7 samples/s | 71.8 steps/s
[Step=81450 Epoch=313.5] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.362 | L2-Norm(final)=18.840 | 4499.2 samples/s | 70.3 steps/s
[Step=81500 Epoch=313.7] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.351 | L2-Norm(final)=18.841 | 4559.5 samples/s | 71.2 steps/s
[Step=81550 Epoch=313.9] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.340 | L2-Norm(final)=18.842 | 2194.8 samples/s | 34.3 steps/s
[Step=81600 Epoch=314.1] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.329 | L2-Norm(final)=18.843 | 4517.8 samples/s | 70.6 steps/s
[Step=81650 Epoch=314.3] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.318 | L2-Norm(final)=18.844 | 4518.8 samples/s | 70.6 steps/s
[Step=81700 Epoch=314.5] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.307 | L2-Norm(final)=18.845 | 4580.9 samples/s | 71.6 steps/s
[Step=81750 Epoch=314.7] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.296 | L2-Norm(final)=18.846 | 4539.5 samples/s | 70.9 steps/s
[Step=81800 Epoch=314.9] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=18.847 | 6702.7 samples/s | 104.7 steps/s
[Step=81850 Epoch=315.1] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.273 | L2-Norm(final)=18.848 | 1913.6 samples/s | 29.9 steps/s
[Step=81900 Epoch=315.3] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.261 | L2-Norm(final)=18.849 | 4535.9 samples/s | 70.9 steps/s
[Step=81950 Epoch=315.5] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.249 | L2-Norm(final)=18.850 | 4599.1 samples/s | 71.9 steps/s
[Step=82000 Epoch=315.7] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.237 | L2-Norm(final)=18.851 | 4453.0 samples/s | 69.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step82000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07314 | acc=0.9699 | tpr=0.9811 | fpr=0.0543 | 4161.1 samples/s | 16.3 steps/s
Avg test loss: 0.07390, Avg test acc: 0.96923, Avg tpr: 0.98071, Avg fpr: 0.05602, total FA: 437

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07148 | acc=0.9698 | tpr=0.9785 | fpr=0.0491 | 4170.5 samples/s | 16.3 steps/s
Avg test loss: 0.07161, Avg test acc: 0.96947, Avg tpr: 0.97896, Avg fpr: 0.05140, total FA: 401

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.26406 | acc=0.3047 | tpr=0.0055 | fpr=0.0456 | 4211.7 samples/s | 16.5 steps/s
Avg test loss: 6.27682, Avg test acc: 0.30087, Avg tpr: 0.00548, Avg fpr: 0.04948, total FA: 386

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.08344 | acc=0.2970 | tpr=0.0076 | fpr=0.0746 | 4153.6 samples/s | 16.2 steps/s
Avg test loss: 6.09729, Avg test acc: 0.29413, Avg tpr: 0.00717, Avg fpr: 0.07473, total FA: 583

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.54326 | acc=0.1213 | tpr=0.4027 | fpr=0.8837 | 4206.4 samples/s | 16.4 steps/s
[Step= 100] | Loss=5.48827 | acc=0.1215 | tpr=0.3902 | fpr=0.8835 | 7797.9 samples/s | 30.5 steps/s
[Step= 150] | Loss=5.49399 | acc=0.1210 | tpr=0.3963 | fpr=0.8841 | 7760.6 samples/s | 30.3 steps/s
[Step= 200] | Loss=5.49119 | acc=0.1210 | tpr=0.3923 | fpr=0.8839 | 7833.6 samples/s | 30.6 steps/s
[Step= 250] | Loss=5.49097 | acc=0.1206 | tpr=0.3817 | fpr=0.8841 | 7940.1 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.49593 | acc=0.1197 | tpr=0.3709 | fpr=0.8849 | 8085.3 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.50538 | acc=0.1190 | tpr=0.3644 | fpr=0.8854 | 7590.6 samples/s | 29.7 steps/s
[Step= 400] | Loss=5.49961 | acc=0.1186 | tpr=0.3572 | fpr=0.8858 | 8019.4 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.50131 | acc=0.1180 | tpr=0.3554 | fpr=0.8863 | 7711.1 samples/s | 30.1 steps/s
[Step= 500] | Loss=5.50326 | acc=0.1177 | tpr=0.3559 | fpr=0.8866 | 7757.0 samples/s | 30.3 steps/s
[Step= 550] | Loss=5.50543 | acc=0.1177 | tpr=0.3554 | fpr=0.8866 | 14657.1 samples/s | 57.3 steps/s
Avg test loss: 5.50578, Avg test acc: 0.11764, Avg tpr: 0.35539, Avg fpr: 0.88668, total FA: 123114

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.36572 | acc=0.1305 | tpr=0.3938 | fpr=0.8742 | 4091.9 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.31581 | acc=0.1309 | tpr=0.3923 | fpr=0.8739 | 7801.9 samples/s | 30.5 steps/s
[Step= 150] | Loss=5.32322 | acc=0.1305 | tpr=0.4035 | fpr=0.8745 | 7905.2 samples/s | 30.9 steps/s
[Step= 200] | Loss=5.31947 | acc=0.1304 | tpr=0.3945 | fpr=0.8745 | 7906.4 samples/s | 30.9 steps/s
[Step= 250] | Loss=5.31911 | acc=0.1299 | tpr=0.3869 | fpr=0.8747 | 7884.5 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.32446 | acc=0.1295 | tpr=0.3855 | fpr=0.8752 | 7612.6 samples/s | 29.7 steps/s
[Step= 350] | Loss=5.33384 | acc=0.1291 | tpr=0.3826 | fpr=0.8755 | 7811.8 samples/s | 30.5 steps/s
[Step= 400] | Loss=5.32743 | acc=0.1284 | tpr=0.3736 | fpr=0.8760 | 7957.1 samples/s | 31.1 steps/s
[Step= 450] | Loss=5.32794 | acc=0.1280 | tpr=0.3695 | fpr=0.8763 | 8077.5 samples/s | 31.6 steps/s
[Step= 500] | Loss=5.32903 | acc=0.1277 | tpr=0.3692 | fpr=0.8767 | 7637.8 samples/s | 29.8 steps/s
[Step= 550] | Loss=5.33200 | acc=0.1278 | tpr=0.3701 | fpr=0.8766 | 13950.1 samples/s | 54.5 steps/s
Avg test loss: 5.33226, Avg test acc: 0.12771, Avg tpr: 0.36926, Avg fpr: 0.87669, total FA: 121726

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11305 | acc=0.9802 | tpr=0.9292 | fpr=0.0189 | 4164.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.11960 | acc=0.9791 | tpr=0.9510 | fpr=0.0203 | 7823.5 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.12148 | acc=0.9790 | tpr=0.9524 | fpr=0.0206 | 8194.3 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.12287 | acc=0.9792 | tpr=0.9552 | fpr=0.0203 | 7669.1 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.12264 | acc=0.9791 | tpr=0.9555 | fpr=0.0205 | 7958.7 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.12476 | acc=0.9789 | tpr=0.9564 | fpr=0.0207 | 7933.1 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.12472 | acc=0.9790 | tpr=0.9568 | fpr=0.0206 | 7802.2 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.12590 | acc=0.9787 | tpr=0.9546 | fpr=0.0209 | 8265.8 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.12756 | acc=0.9784 | tpr=0.9533 | fpr=0.0211 | 7376.0 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.12661 | acc=0.9786 | tpr=0.9546 | fpr=0.0209 | 7874.5 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.12560 | acc=0.9789 | tpr=0.9562 | fpr=0.0207 | 14492.1 samples/s | 56.6 steps/s
Avg test loss: 0.12527, Avg test acc: 0.97890, Avg tpr: 0.95642, Avg fpr: 0.02069, total FA: 2873

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13066 | acc=0.9782 | tpr=0.9381 | fpr=0.0211 | 4171.9 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.13822 | acc=0.9776 | tpr=0.9616 | fpr=0.0221 | 7894.5 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.14025 | acc=0.9771 | tpr=0.9625 | fpr=0.0227 | 7682.7 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.14177 | acc=0.9773 | tpr=0.9650 | fpr=0.0225 | 7988.6 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.14168 | acc=0.9771 | tpr=0.9642 | fpr=0.0227 | 8010.0 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.14416 | acc=0.9766 | tpr=0.9651 | fpr=0.0232 | 7773.2 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.14422 | acc=0.9766 | tpr=0.9643 | fpr=0.0232 | 7700.9 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.14565 | acc=0.9763 | tpr=0.9623 | fpr=0.0234 | 7967.2 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.14739 | acc=0.9761 | tpr=0.9596 | fpr=0.0236 | 7738.9 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.14634 | acc=0.9763 | tpr=0.9612 | fpr=0.0234 | 7799.0 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.14530 | acc=0.9766 | tpr=0.9622 | fpr=0.0231 | 14451.9 samples/s | 56.5 steps/s
Avg test loss: 0.14494, Avg test acc: 0.97663, Avg tpr: 0.96236, Avg fpr: 0.02311, total FA: 3209

server round 41/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=82001 Epoch=159.9] | Loss=0.00266 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.223 | L2-Norm(final)=20.414 | 5295.9 samples/s | 82.7 steps/s
[Step=82050 Epoch=160.0] | Loss=0.00994 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.223 | L2-Norm(final)=20.420 | 4409.8 samples/s | 68.9 steps/s
[Step=82100 Epoch=160.1] | Loss=0.01007 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.223 | L2-Norm(final)=20.425 | 5550.9 samples/s | 86.7 steps/s
[Step=82150 Epoch=160.2] | Loss=0.00960 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.223 | L2-Norm(final)=20.429 | 5665.3 samples/s | 88.5 steps/s
[Step=82200 Epoch=160.3] | Loss=0.00992 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.223 | L2-Norm(final)=20.434 | 5476.6 samples/s | 85.6 steps/s
[Step=82250 Epoch=160.4] | Loss=0.01023 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.223 | L2-Norm(final)=20.438 | 5546.1 samples/s | 86.7 steps/s
[Step=82300 Epoch=160.5] | Loss=0.01027 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.223 | L2-Norm(final)=20.442 | 5549.0 samples/s | 86.7 steps/s
[Step=82350 Epoch=160.6] | Loss=0.01044 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.224 | L2-Norm(final)=20.447 | 5531.3 samples/s | 86.4 steps/s
[Step=82400 Epoch=160.7] | Loss=0.01045 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.224 | L2-Norm(final)=20.451 | 5553.1 samples/s | 86.8 steps/s
[Step=82450 Epoch=160.8] | Loss=0.01033 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.224 | L2-Norm(final)=20.455 | 5569.7 samples/s | 87.0 steps/s
[Step=82500 Epoch=160.9] | Loss=0.01031 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.224 | L2-Norm(final)=20.460 | 7007.6 samples/s | 109.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=82501 Epoch=160.9] | Loss=0.00688 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.224 | L2-Norm(final)=20.504 | 4076.4 samples/s | 63.7 steps/s
[Step=82550 Epoch=161.0] | Loss=0.01042 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.231 | L2-Norm(final)=20.508 | 4610.3 samples/s | 72.0 steps/s
[Step=82600 Epoch=161.1] | Loss=0.01079 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.238 | L2-Norm(final)=20.511 | 4760.5 samples/s | 74.4 steps/s
[Step=82650 Epoch=161.2] | Loss=0.01062 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.244 | L2-Norm(final)=20.514 | 4804.8 samples/s | 75.1 steps/s
[Step=82700 Epoch=161.3] | Loss=0.00986 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.249 | L2-Norm(final)=20.517 | 4764.3 samples/s | 74.4 steps/s
[Step=82750 Epoch=161.4] | Loss=0.00980 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.253 | L2-Norm(final)=20.520 | 4739.0 samples/s | 74.0 steps/s
[Step=82800 Epoch=161.5] | Loss=0.00960 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.258 | L2-Norm(final)=20.523 | 4812.2 samples/s | 75.2 steps/s
[Step=82850 Epoch=161.6] | Loss=0.00943 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.262 | L2-Norm(final)=20.525 | 4825.1 samples/s | 75.4 steps/s
[Step=82900 Epoch=161.7] | Loss=0.00910 | Reg=0.00086 | acc=0.9688 | L2-Norm=9.265 | L2-Norm(final)=20.528 | 4815.3 samples/s | 75.2 steps/s
[Step=82950 Epoch=161.8] | Loss=0.00881 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.269 | L2-Norm(final)=20.530 | 4767.3 samples/s | 74.5 steps/s
[Step=83000 Epoch=161.9] | Loss=0.00875 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.273 | L2-Norm(final)=20.533 | 5823.9 samples/s | 91.0 steps/s
[Step=83050 Epoch=162.0] | Loss=0.00833 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.276 | L2-Norm(final)=20.536 | 2018.2 samples/s | 31.5 steps/s
[Step=83100 Epoch=162.1] | Loss=0.00808 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.279 | L2-Norm(final)=20.539 | 4820.7 samples/s | 75.3 steps/s
[Step=83150 Epoch=162.2] | Loss=0.00791 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.283 | L2-Norm(final)=20.541 | 4729.6 samples/s | 73.9 steps/s
[Step=83200 Epoch=162.3] | Loss=0.00768 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.285 | L2-Norm(final)=20.544 | 4787.9 samples/s | 74.8 steps/s
[Step=83250 Epoch=162.4] | Loss=0.00769 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.288 | L2-Norm(final)=20.547 | 4766.3 samples/s | 74.5 steps/s
[Step=83300 Epoch=162.5] | Loss=0.00752 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.291 | L2-Norm(final)=20.549 | 4802.4 samples/s | 75.0 steps/s
[Step=83350 Epoch=162.6] | Loss=0.00741 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.294 | L2-Norm(final)=20.552 | 4811.2 samples/s | 75.2 steps/s
[Step=83400 Epoch=162.7] | Loss=0.00734 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.296 | L2-Norm(final)=20.554 | 4874.0 samples/s | 76.2 steps/s
[Step=83450 Epoch=162.8] | Loss=0.00725 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.298 | L2-Norm(final)=20.557 | 4826.9 samples/s | 75.4 steps/s
[Step=83500 Epoch=162.9] | Loss=0.00726 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.301 | L2-Norm(final)=20.559 | 4982.1 samples/s | 77.8 steps/s
[Step=83550 Epoch=163.0] | Loss=0.00717 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.303 | L2-Norm(final)=20.562 | 2180.1 samples/s | 34.1 steps/s
[Step=83600 Epoch=163.1] | Loss=0.00708 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.305 | L2-Norm(final)=20.564 | 4846.6 samples/s | 75.7 steps/s
[Step=83650 Epoch=163.1] | Loss=0.00702 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.308 | L2-Norm(final)=20.566 | 4747.1 samples/s | 74.2 steps/s
[Step=83700 Epoch=163.2] | Loss=0.00693 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.310 | L2-Norm(final)=20.568 | 4760.2 samples/s | 74.4 steps/s
[Step=83750 Epoch=163.3] | Loss=0.00689 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.312 | L2-Norm(final)=20.571 | 4887.6 samples/s | 76.4 steps/s
[Step=83800 Epoch=163.4] | Loss=0.00678 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.314 | L2-Norm(final)=20.573 | 4767.6 samples/s | 74.5 steps/s
[Step=83850 Epoch=163.5] | Loss=0.00670 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.316 | L2-Norm(final)=20.575 | 4836.8 samples/s | 75.6 steps/s
[Step=83900 Epoch=163.6] | Loss=0.00664 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.318 | L2-Norm(final)=20.577 | 4745.8 samples/s | 74.2 steps/s
[Step=83950 Epoch=163.7] | Loss=0.00663 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.320 | L2-Norm(final)=20.579 | 4794.5 samples/s | 74.9 steps/s
[Step=84000 Epoch=163.8] | Loss=0.00655 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.322 | L2-Norm(final)=20.582 | 4821.5 samples/s | 75.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step84000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=82001 Epoch=160.3] | Loss=0.00827 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.223 | L2-Norm(final)=20.528 | 4326.0 samples/s | 67.6 steps/s
[Step=82050 Epoch=160.4] | Loss=0.00822 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.224 | L2-Norm(final)=20.533 | 5453.4 samples/s | 85.2 steps/s
[Step=82100 Epoch=160.5] | Loss=0.00826 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.224 | L2-Norm(final)=20.537 | 5498.5 samples/s | 85.9 steps/s
[Step=82150 Epoch=160.6] | Loss=0.00917 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.224 | L2-Norm(final)=20.542 | 5397.2 samples/s | 84.3 steps/s
[Step=82200 Epoch=160.7] | Loss=0.00874 | Reg=0.00085 | acc=0.9688 | L2-Norm=9.224 | L2-Norm(final)=20.547 | 5536.5 samples/s | 86.5 steps/s
[Step=82250 Epoch=160.8] | Loss=0.00935 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.224 | L2-Norm(final)=20.553 | 5422.3 samples/s | 84.7 steps/s
[Step=82300 Epoch=160.9] | Loss=0.00937 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.224 | L2-Norm(final)=20.558 | 5542.6 samples/s | 86.6 steps/s
[Step=82350 Epoch=161.0] | Loss=0.00916 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.224 | L2-Norm(final)=20.563 | 5518.1 samples/s | 86.2 steps/s
[Step=82400 Epoch=161.1] | Loss=0.00911 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.224 | L2-Norm(final)=20.568 | 5573.3 samples/s | 87.1 steps/s
[Step=82450 Epoch=161.2] | Loss=0.00897 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.224 | L2-Norm(final)=20.572 | 5566.9 samples/s | 87.0 steps/s
[Step=82500 Epoch=161.3] | Loss=0.00907 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.224 | L2-Norm(final)=20.577 | 7019.5 samples/s | 109.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=82501 Epoch=161.3] | Loss=0.00554 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.224 | L2-Norm(final)=20.626 | 4774.0 samples/s | 74.6 steps/s
[Step=82550 Epoch=161.4] | Loss=0.00812 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.230 | L2-Norm(final)=20.630 | 4513.3 samples/s | 70.5 steps/s
[Step=82600 Epoch=161.5] | Loss=0.00788 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.237 | L2-Norm(final)=20.634 | 4739.2 samples/s | 74.1 steps/s
[Step=82650 Epoch=161.6] | Loss=0.00769 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.244 | L2-Norm(final)=20.638 | 4759.9 samples/s | 74.4 steps/s
[Step=82700 Epoch=161.7] | Loss=0.00786 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.250 | L2-Norm(final)=20.642 | 4807.7 samples/s | 75.1 steps/s
[Step=82750 Epoch=161.8] | Loss=0.00795 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.255 | L2-Norm(final)=20.645 | 4800.0 samples/s | 75.0 steps/s
[Step=82800 Epoch=161.9] | Loss=0.00750 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.260 | L2-Norm(final)=20.649 | 4769.8 samples/s | 74.5 steps/s
[Step=82850 Epoch=162.0] | Loss=0.00735 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.264 | L2-Norm(final)=20.652 | 4822.9 samples/s | 75.4 steps/s
[Step=82900 Epoch=162.1] | Loss=0.00745 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.268 | L2-Norm(final)=20.656 | 4795.4 samples/s | 74.9 steps/s
[Step=82950 Epoch=162.2] | Loss=0.00767 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.272 | L2-Norm(final)=20.659 | 4786.4 samples/s | 74.8 steps/s
[Step=83000 Epoch=162.3] | Loss=0.00772 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.276 | L2-Norm(final)=20.662 | 5931.2 samples/s | 92.7 steps/s
[Step=83050 Epoch=162.4] | Loss=0.00765 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.280 | L2-Norm(final)=20.665 | 2081.7 samples/s | 32.5 steps/s
[Step=83100 Epoch=162.5] | Loss=0.00737 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.283 | L2-Norm(final)=20.668 | 4721.9 samples/s | 73.8 steps/s
[Step=83150 Epoch=162.6] | Loss=0.00730 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.286 | L2-Norm(final)=20.671 | 4776.8 samples/s | 74.6 steps/s
[Step=83200 Epoch=162.7] | Loss=0.00718 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.290 | L2-Norm(final)=20.674 | 4786.6 samples/s | 74.8 steps/s
[Step=83250 Epoch=162.8] | Loss=0.00708 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.293 | L2-Norm(final)=20.676 | 4764.9 samples/s | 74.5 steps/s
[Step=83300 Epoch=162.8] | Loss=0.00690 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.296 | L2-Norm(final)=20.679 | 4816.4 samples/s | 75.3 steps/s
[Step=83350 Epoch=162.9] | Loss=0.00679 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.298 | L2-Norm(final)=20.682 | 4818.7 samples/s | 75.3 steps/s
[Step=83400 Epoch=163.0] | Loss=0.00684 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.301 | L2-Norm(final)=20.684 | 4779.6 samples/s | 74.7 steps/s
[Step=83450 Epoch=163.1] | Loss=0.00679 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.303 | L2-Norm(final)=20.687 | 4811.2 samples/s | 75.2 steps/s
[Step=83500 Epoch=163.2] | Loss=0.00677 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.306 | L2-Norm(final)=20.689 | 5149.6 samples/s | 80.5 steps/s
[Step=83550 Epoch=163.3] | Loss=0.00666 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.308 | L2-Norm(final)=20.691 | 2169.2 samples/s | 33.9 steps/s
[Step=83600 Epoch=163.4] | Loss=0.00657 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.311 | L2-Norm(final)=20.694 | 4464.5 samples/s | 69.8 steps/s
[Step=83650 Epoch=163.5] | Loss=0.00643 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.313 | L2-Norm(final)=20.696 | 4744.3 samples/s | 74.1 steps/s
[Step=83700 Epoch=163.6] | Loss=0.00637 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.315 | L2-Norm(final)=20.698 | 4807.0 samples/s | 75.1 steps/s
[Step=83750 Epoch=163.7] | Loss=0.00631 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.317 | L2-Norm(final)=20.700 | 4788.7 samples/s | 74.8 steps/s
[Step=83800 Epoch=163.8] | Loss=0.00622 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.320 | L2-Norm(final)=20.703 | 4758.9 samples/s | 74.4 steps/s
[Step=83850 Epoch=163.9] | Loss=0.00616 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.322 | L2-Norm(final)=20.705 | 4772.1 samples/s | 74.6 steps/s
[Step=83900 Epoch=164.0] | Loss=0.00613 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.324 | L2-Norm(final)=20.707 | 4830.5 samples/s | 75.5 steps/s
[Step=83950 Epoch=164.1] | Loss=0.00609 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.326 | L2-Norm(final)=20.709 | 4800.4 samples/s | 75.0 steps/s
[Step=84000 Epoch=164.2] | Loss=0.00603 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.327 | L2-Norm(final)=20.711 | 4773.4 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step84000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=82001 Epoch=314.2] | Loss=0.00003 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.223 | L2-Norm(final)=18.131 | 4733.7 samples/s | 74.0 steps/s
[Step=82050 Epoch=314.4] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.219 | L2-Norm(final)=18.136 | 4643.4 samples/s | 72.6 steps/s
[Step=82100 Epoch=314.6] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=18.143 | 5216.5 samples/s | 81.5 steps/s
[Step=82150 Epoch=314.8] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=18.150 | 5195.7 samples/s | 81.2 steps/s
[Step=82200 Epoch=315.0] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=18.157 | 5245.7 samples/s | 82.0 steps/s
[Step=82250 Epoch=315.2] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=18.164 | 6757.1 samples/s | 105.6 steps/s
[Step=82300 Epoch=315.3] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=18.171 | 2134.6 samples/s | 33.4 steps/s
[Step=82350 Epoch=315.5] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=18.178 | 5197.0 samples/s | 81.2 steps/s
[Step=82400 Epoch=315.7] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=18.185 | 5048.5 samples/s | 78.9 steps/s
[Step=82450 Epoch=315.9] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=18.191 | 5224.1 samples/s | 81.6 steps/s
[Step=82500 Epoch=316.1] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=18.198 | 5861.1 samples/s | 91.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=82501 Epoch=316.1] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.217 | L2-Norm(final)=18.261 | 4973.3 samples/s | 77.7 steps/s
[Step=82550 Epoch=316.3] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.204 | L2-Norm(final)=18.266 | 4178.9 samples/s | 65.3 steps/s
[Step=82600 Epoch=316.5] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.184 | L2-Norm(final)=18.270 | 4438.6 samples/s | 69.4 steps/s
[Step=82650 Epoch=316.7] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.164 | L2-Norm(final)=18.272 | 4563.3 samples/s | 71.3 steps/s
[Step=82700 Epoch=316.9] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.143 | L2-Norm(final)=18.275 | 4556.7 samples/s | 71.2 steps/s
[Step=82750 Epoch=317.1] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.123 | L2-Norm(final)=18.277 | 5709.6 samples/s | 89.2 steps/s
[Step=82800 Epoch=317.3] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.102 | L2-Norm(final)=18.278 | 2021.8 samples/s | 31.6 steps/s
[Step=82850 Epoch=317.5] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.081 | L2-Norm(final)=18.280 | 4292.1 samples/s | 67.1 steps/s
[Step=82900 Epoch=317.6] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.059 | L2-Norm(final)=18.281 | 4404.6 samples/s | 68.8 steps/s
[Step=82950 Epoch=317.8] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.038 | L2-Norm(final)=18.283 | 4551.3 samples/s | 71.1 steps/s
[Step=83000 Epoch=318.0] | Loss=0.00000 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.017 | L2-Norm(final)=18.284 | 4940.6 samples/s | 77.2 steps/s
[Step=83050 Epoch=318.2] | Loss=0.00000 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.995 | L2-Norm(final)=18.285 | 2124.3 samples/s | 33.2 steps/s
[Step=83100 Epoch=318.4] | Loss=0.00000 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.974 | L2-Norm(final)=18.287 | 4519.2 samples/s | 70.6 steps/s
[Step=83150 Epoch=318.6] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.952 | L2-Norm(final)=18.288 | 4408.5 samples/s | 68.9 steps/s
[Step=83200 Epoch=318.8] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.930 | L2-Norm(final)=18.289 | 4562.2 samples/s | 71.3 steps/s
[Step=83250 Epoch=319.0] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.908 | L2-Norm(final)=18.291 | 4523.7 samples/s | 70.7 steps/s
[Step=83300 Epoch=319.2] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.886 | L2-Norm(final)=18.292 | 2188.0 samples/s | 34.2 steps/s
[Step=83350 Epoch=319.4] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.864 | L2-Norm(final)=18.293 | 4583.2 samples/s | 71.6 steps/s
[Step=83400 Epoch=319.6] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.842 | L2-Norm(final)=18.295 | 4579.2 samples/s | 71.6 steps/s
[Step=83450 Epoch=319.8] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.819 | L2-Norm(final)=18.296 | 4525.2 samples/s | 70.7 steps/s
[Step=83500 Epoch=319.9] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.797 | L2-Norm(final)=18.298 | 4466.3 samples/s | 69.8 steps/s
[Step=83550 Epoch=320.1] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.774 | L2-Norm(final)=18.299 | 2211.5 samples/s | 34.6 steps/s
[Step=83600 Epoch=320.3] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.751 | L2-Norm(final)=18.301 | 4523.0 samples/s | 70.7 steps/s
[Step=83650 Epoch=320.5] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.728 | L2-Norm(final)=18.303 | 4538.3 samples/s | 70.9 steps/s
[Step=83700 Epoch=320.7] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.706 | L2-Norm(final)=18.304 | 4490.5 samples/s | 70.2 steps/s
[Step=83750 Epoch=320.9] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.682 | L2-Norm(final)=18.306 | 4557.7 samples/s | 71.2 steps/s
[Step=83800 Epoch=321.1] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.659 | L2-Norm(final)=18.308 | 6149.9 samples/s | 96.1 steps/s
[Step=83850 Epoch=321.3] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.636 | L2-Norm(final)=18.310 | 1948.1 samples/s | 30.4 steps/s
[Step=83900 Epoch=321.5] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.613 | L2-Norm(final)=18.312 | 4526.8 samples/s | 70.7 steps/s
[Step=83950 Epoch=321.7] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.589 | L2-Norm(final)=18.314 | 4514.2 samples/s | 70.5 steps/s
[Step=84000 Epoch=321.9] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.566 | L2-Norm(final)=18.316 | 4479.8 samples/s | 70.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step84000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=82001 Epoch=315.7] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.223 | L2-Norm(final)=18.885 | 4542.3 samples/s | 71.0 steps/s
[Step=82050 Epoch=315.8] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.219 | L2-Norm(final)=18.890 | 4707.7 samples/s | 73.6 steps/s
[Step=82100 Epoch=316.0] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.219 | L2-Norm(final)=18.898 | 5205.5 samples/s | 81.3 steps/s
[Step=82150 Epoch=316.2] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=18.905 | 5155.7 samples/s | 80.6 steps/s
[Step=82200 Epoch=316.4] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=18.912 | 5204.9 samples/s | 81.3 steps/s
[Step=82250 Epoch=316.6] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=18.920 | 6982.1 samples/s | 109.1 steps/s
[Step=82300 Epoch=316.8] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=18.927 | 2126.5 samples/s | 33.2 steps/s
[Step=82350 Epoch=317.0] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=18.933 | 5098.0 samples/s | 79.7 steps/s
[Step=82400 Epoch=317.2] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=18.940 | 5215.1 samples/s | 81.5 steps/s
[Step=82450 Epoch=317.4] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=18.946 | 5240.1 samples/s | 81.9 steps/s
[Step=82500 Epoch=317.6] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=18.953 | 5990.0 samples/s | 93.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=82501 Epoch=317.6] | Loss=0.00004 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=19.017 | 4502.5 samples/s | 70.4 steps/s
[Step=82550 Epoch=317.8] | Loss=0.00007 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.213 | L2-Norm(final)=19.021 | 4258.7 samples/s | 66.5 steps/s
[Step=82600 Epoch=318.0] | Loss=0.00005 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.214 | L2-Norm(final)=19.022 | 4533.6 samples/s | 70.8 steps/s
[Step=82650 Epoch=318.2] | Loss=0.00003 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.212 | L2-Norm(final)=19.022 | 4542.4 samples/s | 71.0 steps/s
[Step=82700 Epoch=318.3] | Loss=0.00003 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.208 | L2-Norm(final)=19.023 | 4586.6 samples/s | 71.7 steps/s
[Step=82750 Epoch=318.5] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.204 | L2-Norm(final)=19.024 | 5660.6 samples/s | 88.4 steps/s
[Step=82800 Epoch=318.7] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.199 | L2-Norm(final)=19.025 | 1980.7 samples/s | 30.9 steps/s
[Step=82850 Epoch=318.9] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.194 | L2-Norm(final)=19.025 | 4497.6 samples/s | 70.3 steps/s
[Step=82900 Epoch=319.1] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.189 | L2-Norm(final)=19.026 | 4529.7 samples/s | 70.8 steps/s
[Step=82950 Epoch=319.3] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.183 | L2-Norm(final)=19.026 | 4553.3 samples/s | 71.1 steps/s
[Step=83000 Epoch=319.5] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.178 | L2-Norm(final)=19.027 | 5179.4 samples/s | 80.9 steps/s
[Step=83050 Epoch=319.7] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.172 | L2-Norm(final)=19.027 | 2099.0 samples/s | 32.8 steps/s
[Step=83100 Epoch=319.9] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.167 | L2-Norm(final)=19.028 | 4525.5 samples/s | 70.7 steps/s
[Step=83150 Epoch=320.1] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.161 | L2-Norm(final)=19.028 | 4550.1 samples/s | 71.1 steps/s
[Step=83200 Epoch=320.3] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.155 | L2-Norm(final)=19.028 | 4474.3 samples/s | 69.9 steps/s
[Step=83250 Epoch=320.5] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.149 | L2-Norm(final)=19.029 | 4636.5 samples/s | 72.4 steps/s
[Step=83300 Epoch=320.7] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.143 | L2-Norm(final)=19.029 | 2160.9 samples/s | 33.8 steps/s
[Step=83350 Epoch=320.8] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.136 | L2-Norm(final)=19.030 | 4578.8 samples/s | 71.5 steps/s
[Step=83400 Epoch=321.0] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.130 | L2-Norm(final)=19.030 | 4534.4 samples/s | 70.9 steps/s
[Step=83450 Epoch=321.2] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.124 | L2-Norm(final)=19.030 | 4539.1 samples/s | 70.9 steps/s
[Step=83500 Epoch=321.4] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.117 | L2-Norm(final)=19.031 | 4546.4 samples/s | 71.0 steps/s
[Step=83550 Epoch=321.6] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.110 | L2-Norm(final)=19.031 | 2207.2 samples/s | 34.5 steps/s
[Step=83600 Epoch=321.8] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.104 | L2-Norm(final)=19.031 | 4493.8 samples/s | 70.2 steps/s
[Step=83650 Epoch=322.0] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.097 | L2-Norm(final)=19.032 | 4551.3 samples/s | 71.1 steps/s
[Step=83700 Epoch=322.2] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.090 | L2-Norm(final)=19.032 | 4469.1 samples/s | 69.8 steps/s
[Step=83750 Epoch=322.4] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.083 | L2-Norm(final)=19.033 | 4553.0 samples/s | 71.1 steps/s
[Step=83800 Epoch=322.6] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.076 | L2-Norm(final)=19.033 | 6633.2 samples/s | 103.6 steps/s
[Step=83850 Epoch=322.8] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.069 | L2-Norm(final)=19.033 | 1917.5 samples/s | 30.0 steps/s
[Step=83900 Epoch=323.0] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.062 | L2-Norm(final)=19.034 | 4561.5 samples/s | 71.3 steps/s
[Step=83950 Epoch=323.2] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.055 | L2-Norm(final)=19.034 | 4519.9 samples/s | 70.6 steps/s
[Step=84000 Epoch=323.3] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.047 | L2-Norm(final)=19.035 | 4519.6 samples/s | 70.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step84000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07060 | acc=0.9691 | tpr=0.9749 | fpr=0.0434 | 4115.2 samples/s | 16.1 steps/s
Avg test loss: 0.07075, Avg test acc: 0.96871, Avg tpr: 0.97546, Avg fpr: 0.04615, total FA: 360

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07202 | acc=0.9690 | tpr=0.9754 | fpr=0.0448 | 4202.8 samples/s | 16.4 steps/s
Avg test loss: 0.07212, Avg test acc: 0.96911, Avg tpr: 0.97645, Avg fpr: 0.04705, total FA: 367

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.04440 | acc=0.3082 | tpr=0.0031 | fpr=0.0292 | 4142.2 samples/s | 16.2 steps/s
Avg test loss: 6.05666, Avg test acc: 0.30531, Avg tpr: 0.00321, Avg fpr: 0.03025, total FA: 236

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.99061 | acc=0.2933 | tpr=0.0082 | fpr=0.0877 | 4173.9 samples/s | 16.3 steps/s
Avg test loss: 6.00415, Avg test acc: 0.29001, Avg tpr: 0.00787, Avg fpr: 0.08948, total FA: 698

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.88448 | acc=0.1347 | tpr=0.3584 | fpr=0.8693 | 4244.9 samples/s | 16.6 steps/s
[Step= 100] | Loss=4.83670 | acc=0.1343 | tpr=0.3475 | fpr=0.8696 | 7694.0 samples/s | 30.1 steps/s
[Step= 150] | Loss=4.84026 | acc=0.1333 | tpr=0.3501 | fpr=0.8707 | 7916.8 samples/s | 30.9 steps/s
[Step= 200] | Loss=4.83714 | acc=0.1342 | tpr=0.3464 | fpr=0.8697 | 7949.6 samples/s | 31.1 steps/s
[Step= 250] | Loss=4.83624 | acc=0.1338 | tpr=0.3406 | fpr=0.8700 | 7954.3 samples/s | 31.1 steps/s
[Step= 300] | Loss=4.84043 | acc=0.1330 | tpr=0.3345 | fpr=0.8707 | 7850.6 samples/s | 30.7 steps/s
[Step= 350] | Loss=4.84920 | acc=0.1324 | tpr=0.3312 | fpr=0.8712 | 7611.8 samples/s | 29.7 steps/s
[Step= 400] | Loss=4.84371 | acc=0.1318 | tpr=0.3249 | fpr=0.8717 | 8023.9 samples/s | 31.3 steps/s
[Step= 450] | Loss=4.84426 | acc=0.1313 | tpr=0.3213 | fpr=0.8722 | 7697.9 samples/s | 30.1 steps/s
[Step= 500] | Loss=4.84568 | acc=0.1311 | tpr=0.3211 | fpr=0.8723 | 7731.1 samples/s | 30.2 steps/s
[Step= 550] | Loss=4.84757 | acc=0.1312 | tpr=0.3215 | fpr=0.8723 | 14850.6 samples/s | 58.0 steps/s
Avg test loss: 4.84777, Avg test acc: 0.13108, Avg tpr: 0.32171, Avg fpr: 0.87239, total FA: 121129

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.26072 | acc=0.1318 | tpr=0.3850 | fpr=0.8728 | 4279.2 samples/s | 16.7 steps/s
[Step= 100] | Loss=5.21348 | acc=0.1330 | tpr=0.3774 | fpr=0.8716 | 7502.0 samples/s | 29.3 steps/s
[Step= 150] | Loss=5.22113 | acc=0.1329 | tpr=0.3847 | fpr=0.8718 | 7859.4 samples/s | 30.7 steps/s
[Step= 200] | Loss=5.21778 | acc=0.1329 | tpr=0.3760 | fpr=0.8715 | 7871.3 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.21792 | acc=0.1327 | tpr=0.3686 | fpr=0.8716 | 7847.9 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.22236 | acc=0.1319 | tpr=0.3665 | fpr=0.8724 | 7790.9 samples/s | 30.4 steps/s
[Step= 350] | Loss=5.23172 | acc=0.1315 | tpr=0.3607 | fpr=0.8727 | 8333.4 samples/s | 32.6 steps/s
[Step= 400] | Loss=5.22524 | acc=0.1308 | tpr=0.3523 | fpr=0.8732 | 7597.7 samples/s | 29.7 steps/s
[Step= 450] | Loss=5.22590 | acc=0.1304 | tpr=0.3491 | fpr=0.8735 | 7655.3 samples/s | 29.9 steps/s
[Step= 500] | Loss=5.22651 | acc=0.1301 | tpr=0.3493 | fpr=0.8739 | 7732.7 samples/s | 30.2 steps/s
[Step= 550] | Loss=5.22945 | acc=0.1301 | tpr=0.3506 | fpr=0.8739 | 14671.0 samples/s | 57.3 steps/s
Avg test loss: 5.22972, Avg test acc: 0.13000, Avg tpr: 0.34984, Avg fpr: 0.87400, total FA: 121353

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10108 | acc=0.9817 | tpr=0.9425 | fpr=0.0176 | 4178.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.10667 | acc=0.9806 | tpr=0.9574 | fpr=0.0189 | 7656.5 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.10869 | acc=0.9804 | tpr=0.9582 | fpr=0.0192 | 8002.9 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.11011 | acc=0.9805 | tpr=0.9596 | fpr=0.0191 | 7774.7 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.11008 | acc=0.9803 | tpr=0.9590 | fpr=0.0193 | 7924.2 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.11199 | acc=0.9802 | tpr=0.9593 | fpr=0.0195 | 7603.9 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.11211 | acc=0.9801 | tpr=0.9599 | fpr=0.0195 | 7335.7 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.11301 | acc=0.9798 | tpr=0.9573 | fpr=0.0198 | 6936.6 samples/s | 27.1 steps/s
[Step= 450] | Loss=0.11464 | acc=0.9795 | tpr=0.9557 | fpr=0.0201 | 7728.7 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.11376 | acc=0.9797 | tpr=0.9573 | fpr=0.0199 | 7730.0 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.11293 | acc=0.9798 | tpr=0.9586 | fpr=0.0198 | 15078.2 samples/s | 58.9 steps/s
Avg test loss: 0.11265, Avg test acc: 0.97988, Avg tpr: 0.95880, Avg fpr: 0.01973, total FA: 2740

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12812 | acc=0.9786 | tpr=0.9381 | fpr=0.0207 | 4201.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.13499 | acc=0.9783 | tpr=0.9595 | fpr=0.0213 | 7701.5 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.13714 | acc=0.9779 | tpr=0.9625 | fpr=0.0218 | 7967.9 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.13880 | acc=0.9780 | tpr=0.9650 | fpr=0.0217 | 7622.8 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.13882 | acc=0.9779 | tpr=0.9642 | fpr=0.0219 | 7928.8 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.14144 | acc=0.9775 | tpr=0.9644 | fpr=0.0223 | 7808.2 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.14143 | acc=0.9774 | tpr=0.9637 | fpr=0.0223 | 7866.7 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.14280 | acc=0.9771 | tpr=0.9612 | fpr=0.0226 | 7854.8 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.14452 | acc=0.9769 | tpr=0.9586 | fpr=0.0228 | 7743.2 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.14356 | acc=0.9770 | tpr=0.9599 | fpr=0.0227 | 7828.8 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.14249 | acc=0.9773 | tpr=0.9606 | fpr=0.0224 | 14015.3 samples/s | 54.7 steps/s
Avg test loss: 0.14213, Avg test acc: 0.97728, Avg tpr: 0.96078, Avg fpr: 0.02242, total FA: 3113

server round 42/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=84001 Epoch=163.8] | Loss=0.02612 | Reg=0.00078 | acc=0.9688 | L2-Norm=8.826 | L2-Norm(final)=20.646 | 4383.6 samples/s | 68.5 steps/s
[Step=84050 Epoch=163.9] | Loss=0.01553 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.827 | L2-Norm(final)=20.650 | 4989.3 samples/s | 78.0 steps/s
[Step=84100 Epoch=164.0] | Loss=0.01413 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.827 | L2-Norm(final)=20.656 | 5582.2 samples/s | 87.2 steps/s
[Step=84150 Epoch=164.1] | Loss=0.01346 | Reg=0.00078 | acc=0.9688 | L2-Norm=8.827 | L2-Norm(final)=20.663 | 5533.7 samples/s | 86.5 steps/s
[Step=84200 Epoch=164.2] | Loss=0.01372 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.827 | L2-Norm(final)=20.669 | 5466.5 samples/s | 85.4 steps/s
[Step=84250 Epoch=164.3] | Loss=0.01346 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.827 | L2-Norm(final)=20.674 | 5548.3 samples/s | 86.7 steps/s
[Step=84300 Epoch=164.4] | Loss=0.01336 | Reg=0.00078 | acc=0.9844 | L2-Norm=8.827 | L2-Norm(final)=20.680 | 5550.2 samples/s | 86.7 steps/s
[Step=84350 Epoch=164.5] | Loss=0.01337 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.827 | L2-Norm(final)=20.685 | 5620.5 samples/s | 87.8 steps/s
[Step=84400 Epoch=164.6] | Loss=0.01332 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.827 | L2-Norm(final)=20.690 | 5487.1 samples/s | 85.7 steps/s
[Step=84450 Epoch=164.7] | Loss=0.01321 | Reg=0.00078 | acc=0.9844 | L2-Norm=8.827 | L2-Norm(final)=20.695 | 5495.3 samples/s | 85.9 steps/s
[Step=84500 Epoch=164.8] | Loss=0.01320 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.827 | L2-Norm(final)=20.701 | 6860.5 samples/s | 107.2 steps/s
All layers training...
LR=0.00006, len=1
[Step=84501 Epoch=164.8] | Loss=0.01303 | Reg=0.00078 | acc=0.9844 | L2-Norm=8.827 | L2-Norm(final)=20.756 | 4111.5 samples/s | 64.2 steps/s
[Step=84550 Epoch=164.9] | Loss=0.01477 | Reg=0.00078 | acc=0.9688 | L2-Norm=8.835 | L2-Norm(final)=20.760 | 4669.3 samples/s | 73.0 steps/s
[Step=84600 Epoch=165.0] | Loss=0.01340 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.843 | L2-Norm(final)=20.764 | 4773.7 samples/s | 74.6 steps/s
[Step=84650 Epoch=165.1] | Loss=0.01264 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.851 | L2-Norm(final)=20.768 | 4781.8 samples/s | 74.7 steps/s
[Step=84700 Epoch=165.2] | Loss=0.01185 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.859 | L2-Norm(final)=20.772 | 4777.4 samples/s | 74.6 steps/s
[Step=84750 Epoch=165.3] | Loss=0.01147 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.865 | L2-Norm(final)=20.776 | 4743.4 samples/s | 74.1 steps/s
[Step=84800 Epoch=165.4] | Loss=0.01119 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.871 | L2-Norm(final)=20.780 | 4789.9 samples/s | 74.8 steps/s
[Step=84850 Epoch=165.5] | Loss=0.01077 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.877 | L2-Norm(final)=20.784 | 4846.6 samples/s | 75.7 steps/s
[Step=84900 Epoch=165.6] | Loss=0.01036 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.882 | L2-Norm(final)=20.788 | 4780.7 samples/s | 74.7 steps/s
[Step=84950 Epoch=165.7] | Loss=0.01020 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.886 | L2-Norm(final)=20.791 | 4779.1 samples/s | 74.7 steps/s
[Step=85000 Epoch=165.8] | Loss=0.01027 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.891 | L2-Norm(final)=20.794 | 5776.3 samples/s | 90.3 steps/s
[Step=85050 Epoch=165.9] | Loss=0.00998 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.895 | L2-Norm(final)=20.798 | 2047.8 samples/s | 32.0 steps/s
[Step=85100 Epoch=166.0] | Loss=0.00957 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.899 | L2-Norm(final)=20.801 | 4771.3 samples/s | 74.6 steps/s
[Step=85150 Epoch=166.1] | Loss=0.00931 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.903 | L2-Norm(final)=20.804 | 4770.1 samples/s | 74.5 steps/s
[Step=85200 Epoch=166.2] | Loss=0.00922 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.906 | L2-Norm(final)=20.807 | 4779.1 samples/s | 74.7 steps/s
[Step=85250 Epoch=166.3] | Loss=0.00900 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.910 | L2-Norm(final)=20.810 | 4849.6 samples/s | 75.8 steps/s
[Step=85300 Epoch=166.4] | Loss=0.00892 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.913 | L2-Norm(final)=20.813 | 4845.6 samples/s | 75.7 steps/s
[Step=85350 Epoch=166.5] | Loss=0.00880 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.916 | L2-Norm(final)=20.815 | 4745.3 samples/s | 74.1 steps/s
[Step=85400 Epoch=166.6] | Loss=0.00874 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.919 | L2-Norm(final)=20.818 | 4774.2 samples/s | 74.6 steps/s
[Step=85450 Epoch=166.7] | Loss=0.00860 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.922 | L2-Norm(final)=20.821 | 4789.0 samples/s | 74.8 steps/s
[Step=85500 Epoch=166.8] | Loss=0.00847 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.925 | L2-Norm(final)=20.823 | 5077.9 samples/s | 79.3 steps/s
[Step=85550 Epoch=166.9] | Loss=0.00833 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.928 | L2-Norm(final)=20.826 | 2181.4 samples/s | 34.1 steps/s
[Step=85600 Epoch=167.0] | Loss=0.00819 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.931 | L2-Norm(final)=20.829 | 4903.7 samples/s | 76.6 steps/s
[Step=85650 Epoch=167.1] | Loss=0.00804 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.934 | L2-Norm(final)=20.831 | 4765.8 samples/s | 74.5 steps/s
[Step=85700 Epoch=167.1] | Loss=0.00792 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.937 | L2-Norm(final)=20.834 | 4776.0 samples/s | 74.6 steps/s
[Step=85750 Epoch=167.2] | Loss=0.00789 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.939 | L2-Norm(final)=20.836 | 4779.3 samples/s | 74.7 steps/s
[Step=85800 Epoch=167.3] | Loss=0.00777 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.942 | L2-Norm(final)=20.839 | 4779.5 samples/s | 74.7 steps/s
[Step=85850 Epoch=167.4] | Loss=0.00774 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.944 | L2-Norm(final)=20.841 | 4804.9 samples/s | 75.1 steps/s
[Step=85900 Epoch=167.5] | Loss=0.00764 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.947 | L2-Norm(final)=20.844 | 4801.5 samples/s | 75.0 steps/s
[Step=85950 Epoch=167.6] | Loss=0.00760 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.949 | L2-Norm(final)=20.846 | 4772.7 samples/s | 74.6 steps/s
[Step=86000 Epoch=167.7] | Loss=0.00756 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.951 | L2-Norm(final)=20.848 | 4743.6 samples/s | 74.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step86000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=84001 Epoch=164.2] | Loss=0.00972 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.826 | L2-Norm(final)=20.775 | 4970.0 samples/s | 77.7 steps/s
[Step=84050 Epoch=164.3] | Loss=0.01351 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.827 | L2-Norm(final)=20.777 | 4855.8 samples/s | 75.9 steps/s
[Step=84100 Epoch=164.4] | Loss=0.01255 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.827 | L2-Norm(final)=20.780 | 5435.8 samples/s | 84.9 steps/s
[Step=84150 Epoch=164.5] | Loss=0.01281 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.827 | L2-Norm(final)=20.783 | 5585.5 samples/s | 87.3 steps/s
[Step=84200 Epoch=164.6] | Loss=0.01277 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.827 | L2-Norm(final)=20.787 | 5463.0 samples/s | 85.4 steps/s
[Step=84250 Epoch=164.7] | Loss=0.01314 | Reg=0.00078 | acc=0.9844 | L2-Norm=8.827 | L2-Norm(final)=20.790 | 5559.3 samples/s | 86.9 steps/s
[Step=84300 Epoch=164.8] | Loss=0.01269 | Reg=0.00078 | acc=0.9844 | L2-Norm=8.827 | L2-Norm(final)=20.793 | 5506.4 samples/s | 86.0 steps/s
[Step=84350 Epoch=164.9] | Loss=0.01234 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.827 | L2-Norm(final)=20.797 | 5651.2 samples/s | 88.3 steps/s
[Step=84400 Epoch=165.0] | Loss=0.01251 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.827 | L2-Norm(final)=20.801 | 5405.2 samples/s | 84.5 steps/s
[Step=84450 Epoch=165.1] | Loss=0.01250 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.827 | L2-Norm(final)=20.806 | 5518.4 samples/s | 86.2 steps/s
[Step=84500 Epoch=165.2] | Loss=0.01225 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.827 | L2-Norm(final)=20.810 | 7005.7 samples/s | 109.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=84501 Epoch=165.2] | Loss=0.01262 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.827 | L2-Norm(final)=20.858 | 4496.9 samples/s | 70.3 steps/s
[Step=84550 Epoch=165.3] | Loss=0.01302 | Reg=0.00078 | acc=0.9531 | L2-Norm=8.834 | L2-Norm(final)=20.862 | 4554.1 samples/s | 71.2 steps/s
[Step=84600 Epoch=165.4] | Loss=0.01223 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.844 | L2-Norm(final)=20.866 | 4712.7 samples/s | 73.6 steps/s
[Step=84650 Epoch=165.5] | Loss=0.01119 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.851 | L2-Norm(final)=20.870 | 4759.1 samples/s | 74.4 steps/s
[Step=84700 Epoch=165.6] | Loss=0.01077 | Reg=0.00078 | acc=0.9844 | L2-Norm=8.857 | L2-Norm(final)=20.874 | 4836.4 samples/s | 75.6 steps/s
[Step=84750 Epoch=165.7] | Loss=0.01047 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.864 | L2-Norm(final)=20.878 | 4673.1 samples/s | 73.0 steps/s
[Step=84800 Epoch=165.8] | Loss=0.01026 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.869 | L2-Norm(final)=20.882 | 4756.3 samples/s | 74.3 steps/s
[Step=84850 Epoch=165.9] | Loss=0.01016 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.875 | L2-Norm(final)=20.885 | 4850.0 samples/s | 75.8 steps/s
[Step=84900 Epoch=166.0] | Loss=0.01000 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.880 | L2-Norm(final)=20.889 | 4739.1 samples/s | 74.0 steps/s
[Step=84950 Epoch=166.1] | Loss=0.00979 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.885 | L2-Norm(final)=20.892 | 4815.1 samples/s | 75.2 steps/s
[Step=85000 Epoch=166.2] | Loss=0.00978 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.889 | L2-Norm(final)=20.895 | 5936.2 samples/s | 92.8 steps/s
[Step=85050 Epoch=166.3] | Loss=0.00952 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.894 | L2-Norm(final)=20.898 | 2077.6 samples/s | 32.5 steps/s
[Step=85100 Epoch=166.4] | Loss=0.00922 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.898 | L2-Norm(final)=20.902 | 4809.8 samples/s | 75.2 steps/s
[Step=85150 Epoch=166.5] | Loss=0.00889 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.902 | L2-Norm(final)=20.905 | 4795.1 samples/s | 74.9 steps/s
[Step=85200 Epoch=166.6] | Loss=0.00857 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.905 | L2-Norm(final)=20.908 | 4786.9 samples/s | 74.8 steps/s
[Step=85250 Epoch=166.7] | Loss=0.00845 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.909 | L2-Norm(final)=20.911 | 4738.6 samples/s | 74.0 steps/s
[Step=85300 Epoch=166.8] | Loss=0.00829 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.912 | L2-Norm(final)=20.914 | 4829.6 samples/s | 75.5 steps/s
[Step=85350 Epoch=166.9] | Loss=0.00823 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.915 | L2-Norm(final)=20.917 | 4746.4 samples/s | 74.2 steps/s
[Step=85400 Epoch=167.0] | Loss=0.00813 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.919 | L2-Norm(final)=20.920 | 4768.5 samples/s | 74.5 steps/s
[Step=85450 Epoch=167.1] | Loss=0.00797 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.922 | L2-Norm(final)=20.923 | 4808.7 samples/s | 75.1 steps/s
[Step=85500 Epoch=167.2] | Loss=0.00791 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.925 | L2-Norm(final)=20.926 | 5174.5 samples/s | 80.9 steps/s
[Step=85550 Epoch=167.2] | Loss=0.00781 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.928 | L2-Norm(final)=20.929 | 2177.9 samples/s | 34.0 steps/s
[Step=85600 Epoch=167.3] | Loss=0.00770 | Reg=0.00080 | acc=0.9688 | L2-Norm=8.930 | L2-Norm(final)=20.932 | 4751.6 samples/s | 74.2 steps/s
[Step=85650 Epoch=167.4] | Loss=0.00754 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.933 | L2-Norm(final)=20.934 | 4769.9 samples/s | 74.5 steps/s
[Step=85700 Epoch=167.5] | Loss=0.00743 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.936 | L2-Norm(final)=20.937 | 4785.2 samples/s | 74.8 steps/s
[Step=85750 Epoch=167.6] | Loss=0.00731 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.939 | L2-Norm(final)=20.940 | 4765.9 samples/s | 74.5 steps/s
[Step=85800 Epoch=167.7] | Loss=0.00724 | Reg=0.00080 | acc=0.9688 | L2-Norm=8.941 | L2-Norm(final)=20.942 | 4780.5 samples/s | 74.7 steps/s
[Step=85850 Epoch=167.8] | Loss=0.00717 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.944 | L2-Norm(final)=20.945 | 4749.0 samples/s | 74.2 steps/s
[Step=85900 Epoch=167.9] | Loss=0.00709 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.946 | L2-Norm(final)=20.948 | 4807.8 samples/s | 75.1 steps/s
[Step=85950 Epoch=168.0] | Loss=0.00708 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.949 | L2-Norm(final)=20.950 | 4758.9 samples/s | 74.4 steps/s
[Step=86000 Epoch=168.1] | Loss=0.00707 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.951 | L2-Norm(final)=20.953 | 4816.8 samples/s | 75.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step86000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=84001 Epoch=321.9] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.826 | L2-Norm(final)=18.378 | 4559.2 samples/s | 71.2 steps/s
[Step=84050 Epoch=322.0] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.819 | L2-Norm(final)=18.386 | 4820.7 samples/s | 75.3 steps/s
[Step=84100 Epoch=322.2] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.818 | L2-Norm(final)=18.396 | 5137.8 samples/s | 80.3 steps/s
[Step=84150 Epoch=322.4] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.818 | L2-Norm(final)=18.405 | 5293.7 samples/s | 82.7 steps/s
[Step=84200 Epoch=322.6] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.818 | L2-Norm(final)=18.414 | 5268.2 samples/s | 82.3 steps/s
[Step=84250 Epoch=322.8] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.818 | L2-Norm(final)=18.423 | 6564.3 samples/s | 102.6 steps/s
[Step=84300 Epoch=323.0] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.818 | L2-Norm(final)=18.432 | 2125.4 samples/s | 33.2 steps/s
[Step=84350 Epoch=323.2] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.818 | L2-Norm(final)=18.440 | 5248.2 samples/s | 82.0 steps/s
[Step=84400 Epoch=323.4] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.818 | L2-Norm(final)=18.449 | 5348.7 samples/s | 83.6 steps/s
[Step=84450 Epoch=323.6] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.818 | L2-Norm(final)=18.457 | 4958.4 samples/s | 77.5 steps/s
[Step=84500 Epoch=323.8] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.818 | L2-Norm(final)=18.466 | 5826.8 samples/s | 91.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=84501 Epoch=323.8] | Loss=0.00003 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.818 | L2-Norm(final)=18.547 | 4716.8 samples/s | 73.7 steps/s
[Step=84550 Epoch=324.0] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.791 | L2-Norm(final)=18.553 | 4128.7 samples/s | 64.5 steps/s
[Step=84600 Epoch=324.2] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.764 | L2-Norm(final)=18.557 | 4588.6 samples/s | 71.7 steps/s
[Step=84650 Epoch=324.3] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.744 | L2-Norm(final)=18.560 | 4516.6 samples/s | 70.6 steps/s
[Step=84700 Epoch=324.5] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.725 | L2-Norm(final)=18.562 | 4537.3 samples/s | 70.9 steps/s
[Step=84750 Epoch=324.7] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.706 | L2-Norm(final)=18.564 | 5735.4 samples/s | 89.6 steps/s
[Step=84800 Epoch=324.9] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.687 | L2-Norm(final)=18.566 | 2007.2 samples/s | 31.4 steps/s
[Step=84850 Epoch=325.1] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.668 | L2-Norm(final)=18.567 | 4553.3 samples/s | 71.1 steps/s
[Step=84900 Epoch=325.3] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.650 | L2-Norm(final)=18.568 | 4623.1 samples/s | 72.2 steps/s
[Step=84950 Epoch=325.5] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.631 | L2-Norm(final)=18.569 | 4544.3 samples/s | 71.0 steps/s
[Step=85000 Epoch=325.7] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.612 | L2-Norm(final)=18.570 | 5037.6 samples/s | 78.7 steps/s
[Step=85050 Epoch=325.9] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.592 | L2-Norm(final)=18.572 | 2102.6 samples/s | 32.9 steps/s
[Step=85100 Epoch=326.1] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.573 | L2-Norm(final)=18.573 | 4619.1 samples/s | 72.2 steps/s
[Step=85150 Epoch=326.3] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.554 | L2-Norm(final)=18.574 | 4506.0 samples/s | 70.4 steps/s
[Step=85200 Epoch=326.5] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.535 | L2-Norm(final)=18.575 | 4533.4 samples/s | 70.8 steps/s
[Step=85250 Epoch=326.6] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.515 | L2-Norm(final)=18.576 | 4548.3 samples/s | 71.1 steps/s
[Step=85300 Epoch=326.8] | Loss=0.00000 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.496 | L2-Norm(final)=18.577 | 2192.0 samples/s | 34.3 steps/s
[Step=85350 Epoch=327.0] | Loss=0.00000 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.476 | L2-Norm(final)=18.578 | 4615.1 samples/s | 72.1 steps/s
[Step=85400 Epoch=327.2] | Loss=0.00000 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.456 | L2-Norm(final)=18.579 | 4480.3 samples/s | 70.0 steps/s
[Step=85450 Epoch=327.4] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.436 | L2-Norm(final)=18.581 | 4576.5 samples/s | 71.5 steps/s
[Step=85500 Epoch=327.6] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.416 | L2-Norm(final)=18.582 | 4521.4 samples/s | 70.6 steps/s
[Step=85550 Epoch=327.8] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.396 | L2-Norm(final)=18.583 | 2180.0 samples/s | 34.1 steps/s
[Step=85600 Epoch=328.0] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.376 | L2-Norm(final)=18.585 | 4544.6 samples/s | 71.0 steps/s
[Step=85650 Epoch=328.2] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.356 | L2-Norm(final)=18.586 | 4502.8 samples/s | 70.4 steps/s
[Step=85700 Epoch=328.4] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.336 | L2-Norm(final)=18.587 | 4632.2 samples/s | 72.4 steps/s
[Step=85750 Epoch=328.6] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.315 | L2-Norm(final)=18.589 | 4488.9 samples/s | 70.1 steps/s
[Step=85800 Epoch=328.8] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.295 | L2-Norm(final)=18.591 | 6227.6 samples/s | 97.3 steps/s
[Step=85850 Epoch=328.9] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.274 | L2-Norm(final)=18.592 | 1966.5 samples/s | 30.7 steps/s
[Step=85900 Epoch=329.1] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.254 | L2-Norm(final)=18.594 | 4540.2 samples/s | 70.9 steps/s
[Step=85950 Epoch=329.3] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.233 | L2-Norm(final)=18.596 | 4539.6 samples/s | 70.9 steps/s
[Step=86000 Epoch=329.5] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.212 | L2-Norm(final)=18.597 | 4567.8 samples/s | 71.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step86000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=84001 Epoch=323.4] | Loss=0.00002 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.826 | L2-Norm(final)=19.047 | 4732.1 samples/s | 73.9 steps/s
[Step=84050 Epoch=323.5] | Loss=0.00004 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.824 | L2-Norm(final)=19.054 | 4687.5 samples/s | 73.2 steps/s
[Step=84100 Epoch=323.7] | Loss=0.00004 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.823 | L2-Norm(final)=19.061 | 5124.4 samples/s | 80.1 steps/s
[Step=84150 Epoch=323.9] | Loss=0.00003 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.823 | L2-Norm(final)=19.067 | 5252.4 samples/s | 82.1 steps/s
[Step=84200 Epoch=324.1] | Loss=0.00003 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.823 | L2-Norm(final)=19.073 | 5236.0 samples/s | 81.8 steps/s
[Step=84250 Epoch=324.3] | Loss=0.00003 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.823 | L2-Norm(final)=19.078 | 6843.1 samples/s | 106.9 steps/s
[Step=84300 Epoch=324.5] | Loss=0.00003 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.823 | L2-Norm(final)=19.083 | 2120.1 samples/s | 33.1 steps/s
[Step=84350 Epoch=324.7] | Loss=0.00003 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.823 | L2-Norm(final)=19.088 | 5077.1 samples/s | 79.3 steps/s
[Step=84400 Epoch=324.9] | Loss=0.00003 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.823 | L2-Norm(final)=19.094 | 5193.0 samples/s | 81.1 steps/s
[Step=84450 Epoch=325.1] | Loss=0.00003 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.823 | L2-Norm(final)=19.099 | 5163.2 samples/s | 80.7 steps/s
[Step=84500 Epoch=325.3] | Loss=0.00003 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.823 | L2-Norm(final)=19.104 | 5978.3 samples/s | 93.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=84501 Epoch=325.3] | Loss=0.00002 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.823 | L2-Norm(final)=19.158 | 4627.2 samples/s | 72.3 steps/s
[Step=84550 Epoch=325.5] | Loss=0.00004 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.821 | L2-Norm(final)=19.162 | 4185.5 samples/s | 65.4 steps/s
[Step=84600 Epoch=325.7] | Loss=0.00002 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.818 | L2-Norm(final)=19.165 | 4540.2 samples/s | 70.9 steps/s
[Step=84650 Epoch=325.9] | Loss=0.00002 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.812 | L2-Norm(final)=19.167 | 4526.5 samples/s | 70.7 steps/s
[Step=84700 Epoch=326.0] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.804 | L2-Norm(final)=19.168 | 4572.8 samples/s | 71.4 steps/s
[Step=84750 Epoch=326.2] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.796 | L2-Norm(final)=19.170 | 5797.0 samples/s | 90.6 steps/s
[Step=84800 Epoch=326.4] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.788 | L2-Norm(final)=19.171 | 1985.9 samples/s | 31.0 steps/s
[Step=84850 Epoch=326.6] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.779 | L2-Norm(final)=19.172 | 4581.6 samples/s | 71.6 steps/s
[Step=84900 Epoch=326.8] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.770 | L2-Norm(final)=19.173 | 4589.7 samples/s | 71.7 steps/s
[Step=84950 Epoch=327.0] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.761 | L2-Norm(final)=19.173 | 4553.1 samples/s | 71.1 steps/s
[Step=85000 Epoch=327.2] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.751 | L2-Norm(final)=19.174 | 5114.9 samples/s | 79.9 steps/s
[Step=85050 Epoch=327.4] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.742 | L2-Norm(final)=19.175 | 2088.8 samples/s | 32.6 steps/s
[Step=85100 Epoch=327.6] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.732 | L2-Norm(final)=19.175 | 4511.1 samples/s | 70.5 steps/s
[Step=85150 Epoch=327.8] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.723 | L2-Norm(final)=19.176 | 4578.5 samples/s | 71.5 steps/s
[Step=85200 Epoch=328.0] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.713 | L2-Norm(final)=19.177 | 4590.1 samples/s | 71.7 steps/s
[Step=85250 Epoch=328.2] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.703 | L2-Norm(final)=19.177 | 4607.7 samples/s | 72.0 steps/s
[Step=85300 Epoch=328.4] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.693 | L2-Norm(final)=19.178 | 2141.2 samples/s | 33.5 steps/s
[Step=85350 Epoch=328.5] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.683 | L2-Norm(final)=19.179 | 4651.9 samples/s | 72.7 steps/s
[Step=85400 Epoch=328.7] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.672 | L2-Norm(final)=19.179 | 4558.3 samples/s | 71.2 steps/s
[Step=85450 Epoch=328.9] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.662 | L2-Norm(final)=19.180 | 4595.5 samples/s | 71.8 steps/s
[Step=85500 Epoch=329.1] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.651 | L2-Norm(final)=19.180 | 4515.3 samples/s | 70.6 steps/s
[Step=85550 Epoch=329.3] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.641 | L2-Norm(final)=19.181 | 2199.1 samples/s | 34.4 steps/s
[Step=85600 Epoch=329.5] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.630 | L2-Norm(final)=19.182 | 4579.0 samples/s | 71.5 steps/s
[Step=85650 Epoch=329.7] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.619 | L2-Norm(final)=19.182 | 4536.9 samples/s | 70.9 steps/s
[Step=85700 Epoch=329.9] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.608 | L2-Norm(final)=19.183 | 4559.5 samples/s | 71.2 steps/s
[Step=85750 Epoch=330.1] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.597 | L2-Norm(final)=19.184 | 4529.0 samples/s | 70.8 steps/s
[Step=85800 Epoch=330.3] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.585 | L2-Norm(final)=19.185 | 6669.0 samples/s | 104.2 steps/s
[Step=85850 Epoch=330.5] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.574 | L2-Norm(final)=19.185 | 1911.4 samples/s | 29.9 steps/s
[Step=85900 Epoch=330.7] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.563 | L2-Norm(final)=19.186 | 4534.0 samples/s | 70.8 steps/s
[Step=85950 Epoch=330.9] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.551 | L2-Norm(final)=19.187 | 4560.6 samples/s | 71.3 steps/s
[Step=86000 Epoch=331.0] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.539 | L2-Norm(final)=19.187 | 4585.4 samples/s | 71.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step86000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07143 | acc=0.9681 | tpr=0.9730 | fpr=0.0424 | 4195.3 samples/s | 16.4 steps/s
Avg test loss: 0.07119, Avg test acc: 0.96755, Avg tpr: 0.97284, Avg fpr: 0.04410, total FA: 344

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06891 | acc=0.9686 | tpr=0.9781 | fpr=0.0520 | 4171.5 samples/s | 16.3 steps/s
Avg test loss: 0.06875, Avg test acc: 0.96875, Avg tpr: 0.97878, Avg fpr: 0.05333, total FA: 416

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.00891 | acc=0.3089 | tpr=0.0039 | fpr=0.0287 | 4142.9 samples/s | 16.2 steps/s
Avg test loss: 6.02072, Avg test acc: 0.30571, Avg tpr: 0.00385, Avg fpr: 0.03038, total FA: 237

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.90579 | acc=0.3013 | tpr=0.0064 | fpr=0.0582 | 4125.5 samples/s | 16.1 steps/s
Avg test loss: 5.91928, Avg test acc: 0.29774, Avg tpr: 0.00595, Avg fpr: 0.06051, total FA: 472

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.81593 | acc=0.1406 | tpr=0.3274 | fpr=0.8627 | 4158.0 samples/s | 16.2 steps/s
[Step= 100] | Loss=4.76879 | acc=0.1397 | tpr=0.3049 | fpr=0.8634 | 8040.5 samples/s | 31.4 steps/s
[Step= 150] | Loss=4.77071 | acc=0.1389 | tpr=0.3098 | fpr=0.8643 | 7673.3 samples/s | 30.0 steps/s
[Step= 200] | Loss=4.76822 | acc=0.1393 | tpr=0.3060 | fpr=0.8637 | 7788.6 samples/s | 30.4 steps/s
[Step= 250] | Loss=4.76631 | acc=0.1389 | tpr=0.2987 | fpr=0.8640 | 8050.8 samples/s | 31.4 steps/s
[Step= 300] | Loss=4.76994 | acc=0.1382 | tpr=0.2916 | fpr=0.8646 | 7944.4 samples/s | 31.0 steps/s
[Step= 350] | Loss=4.77884 | acc=0.1376 | tpr=0.2855 | fpr=0.8650 | 7874.4 samples/s | 30.8 steps/s
[Step= 400] | Loss=4.77358 | acc=0.1371 | tpr=0.2806 | fpr=0.8655 | 7870.7 samples/s | 30.7 steps/s
[Step= 450] | Loss=4.77453 | acc=0.1365 | tpr=0.2775 | fpr=0.8661 | 7847.3 samples/s | 30.7 steps/s
[Step= 500] | Loss=4.77532 | acc=0.1362 | tpr=0.2793 | fpr=0.8664 | 7547.0 samples/s | 29.5 steps/s
[Step= 550] | Loss=4.77726 | acc=0.1363 | tpr=0.2786 | fpr=0.8663 | 14866.1 samples/s | 58.1 steps/s
Avg test loss: 4.77753, Avg test acc: 0.13620, Avg tpr: 0.27853, Avg fpr: 0.86639, total FA: 120296

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.13396 | acc=0.1274 | tpr=0.3628 | fpr=0.8768 | 4132.4 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.08858 | acc=0.1285 | tpr=0.3539 | fpr=0.8757 | 8156.7 samples/s | 31.9 steps/s
[Step= 150] | Loss=5.09406 | acc=0.1279 | tpr=0.3573 | fpr=0.8763 | 7536.1 samples/s | 29.4 steps/s
[Step= 200] | Loss=5.09204 | acc=0.1282 | tpr=0.3497 | fpr=0.8758 | 7856.2 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.09175 | acc=0.1280 | tpr=0.3424 | fpr=0.8759 | 7987.8 samples/s | 31.2 steps/s
[Step= 300] | Loss=5.09535 | acc=0.1275 | tpr=0.3418 | fpr=0.8764 | 7790.6 samples/s | 30.4 steps/s
[Step= 350] | Loss=5.10431 | acc=0.1267 | tpr=0.3338 | fpr=0.8771 | 7931.3 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.09809 | acc=0.1261 | tpr=0.3266 | fpr=0.8776 | 7870.8 samples/s | 30.7 steps/s
[Step= 450] | Loss=5.09827 | acc=0.1257 | tpr=0.3223 | fpr=0.8779 | 7655.3 samples/s | 29.9 steps/s
[Step= 500] | Loss=5.09902 | acc=0.1254 | tpr=0.3238 | fpr=0.8782 | 8293.1 samples/s | 32.4 steps/s
[Step= 550] | Loss=5.10151 | acc=0.1254 | tpr=0.3239 | fpr=0.8782 | 13099.0 samples/s | 51.2 steps/s
Avg test loss: 5.10177, Avg test acc: 0.12531, Avg tpr: 0.32330, Avg fpr: 0.87828, total FA: 121948

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11345 | acc=0.9789 | tpr=0.9336 | fpr=0.0203 | 4213.6 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.11982 | acc=0.9784 | tpr=0.9510 | fpr=0.0211 | 7578.0 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.12234 | acc=0.9779 | tpr=0.9524 | fpr=0.0216 | 7746.9 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.12375 | acc=0.9783 | tpr=0.9563 | fpr=0.0213 | 8103.1 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.12365 | acc=0.9780 | tpr=0.9555 | fpr=0.0215 | 8015.6 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.12567 | acc=0.9778 | tpr=0.9564 | fpr=0.0218 | 7715.5 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.12552 | acc=0.9778 | tpr=0.9574 | fpr=0.0218 | 7815.9 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.12657 | acc=0.9775 | tpr=0.9557 | fpr=0.0221 | 7827.6 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.12836 | acc=0.9772 | tpr=0.9537 | fpr=0.0224 | 7972.5 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.12763 | acc=0.9773 | tpr=0.9546 | fpr=0.0223 | 7728.3 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.12671 | acc=0.9776 | tpr=0.9562 | fpr=0.0220 | 14279.3 samples/s | 55.8 steps/s
Avg test loss: 0.12640, Avg test acc: 0.97760, Avg tpr: 0.95642, Avg fpr: 0.02202, total FA: 3057

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12432 | acc=0.9771 | tpr=0.9336 | fpr=0.0221 | 4197.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.13134 | acc=0.9772 | tpr=0.9616 | fpr=0.0225 | 7716.5 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.13331 | acc=0.9769 | tpr=0.9654 | fpr=0.0229 | 7856.4 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.13480 | acc=0.9774 | tpr=0.9672 | fpr=0.0224 | 7762.1 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.13475 | acc=0.9772 | tpr=0.9651 | fpr=0.0226 | 7870.9 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.13725 | acc=0.9768 | tpr=0.9658 | fpr=0.0230 | 7927.0 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.13722 | acc=0.9768 | tpr=0.9649 | fpr=0.0230 | 7918.1 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.13856 | acc=0.9766 | tpr=0.9633 | fpr=0.0232 | 7766.6 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.14046 | acc=0.9763 | tpr=0.9606 | fpr=0.0234 | 8196.0 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.13950 | acc=0.9764 | tpr=0.9621 | fpr=0.0233 | 7453.8 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.13851 | acc=0.9766 | tpr=0.9630 | fpr=0.0231 | 14899.7 samples/s | 58.2 steps/s
Avg test loss: 0.13819, Avg test acc: 0.97666, Avg tpr: 0.96315, Avg fpr: 0.02309, total FA: 3206

server round 43/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=86001 Epoch=167.7] | Loss=0.02206 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.413 | L2-Norm(final)=20.918 | 4528.4 samples/s | 70.8 steps/s
[Step=86050 Epoch=167.8] | Loss=0.01933 | Reg=0.00071 | acc=0.9688 | L2-Norm=8.412 | L2-Norm(final)=20.921 | 5315.8 samples/s | 83.1 steps/s
[Step=86100 Epoch=167.9] | Loss=0.01742 | Reg=0.00071 | acc=0.9688 | L2-Norm=8.412 | L2-Norm(final)=20.926 | 5510.9 samples/s | 86.1 steps/s
[Step=86150 Epoch=168.0] | Loss=0.01749 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.412 | L2-Norm(final)=20.932 | 5546.8 samples/s | 86.7 steps/s
[Step=86200 Epoch=168.1] | Loss=0.01764 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.412 | L2-Norm(final)=20.938 | 5482.9 samples/s | 85.7 steps/s
[Step=86250 Epoch=168.2] | Loss=0.01774 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.412 | L2-Norm(final)=20.944 | 5546.8 samples/s | 86.7 steps/s
[Step=86300 Epoch=168.3] | Loss=0.01752 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.412 | L2-Norm(final)=20.949 | 5490.7 samples/s | 85.8 steps/s
[Step=86350 Epoch=168.4] | Loss=0.01733 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.412 | L2-Norm(final)=20.955 | 5624.1 samples/s | 87.9 steps/s
[Step=86400 Epoch=168.5] | Loss=0.01722 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.412 | L2-Norm(final)=20.961 | 5548.8 samples/s | 86.7 steps/s
[Step=86450 Epoch=168.6] | Loss=0.01715 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.412 | L2-Norm(final)=20.966 | 5469.5 samples/s | 85.5 steps/s
[Step=86500 Epoch=168.7] | Loss=0.01712 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.412 | L2-Norm(final)=20.972 | 7016.7 samples/s | 109.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=86501 Epoch=168.7] | Loss=0.00597 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.412 | L2-Norm(final)=21.023 | 4455.4 samples/s | 69.6 steps/s
[Step=86550 Epoch=168.8] | Loss=0.01762 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.422 | L2-Norm(final)=21.027 | 4584.0 samples/s | 71.6 steps/s
[Step=86600 Epoch=168.9] | Loss=0.01573 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.433 | L2-Norm(final)=21.032 | 4804.3 samples/s | 75.1 steps/s
[Step=86650 Epoch=169.0] | Loss=0.01494 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.443 | L2-Norm(final)=21.036 | 4759.3 samples/s | 74.4 steps/s
[Step=86700 Epoch=169.1] | Loss=0.01475 | Reg=0.00071 | acc=0.9688 | L2-Norm=8.451 | L2-Norm(final)=21.040 | 4767.5 samples/s | 74.5 steps/s
[Step=86750 Epoch=169.2] | Loss=0.01421 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.458 | L2-Norm(final)=21.045 | 4831.0 samples/s | 75.5 steps/s
[Step=86800 Epoch=169.3] | Loss=0.01365 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.465 | L2-Norm(final)=21.049 | 4742.4 samples/s | 74.1 steps/s
[Step=86850 Epoch=169.4] | Loss=0.01330 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.472 | L2-Norm(final)=21.053 | 4814.6 samples/s | 75.2 steps/s
[Step=86900 Epoch=169.5] | Loss=0.01325 | Reg=0.00072 | acc=0.9844 | L2-Norm=8.479 | L2-Norm(final)=21.057 | 4779.2 samples/s | 74.7 steps/s
[Step=86950 Epoch=169.6] | Loss=0.01304 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.484 | L2-Norm(final)=21.061 | 4818.4 samples/s | 75.3 steps/s
[Step=87000 Epoch=169.7] | Loss=0.01254 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.490 | L2-Norm(final)=21.064 | 5809.2 samples/s | 90.8 steps/s
[Step=87050 Epoch=169.8] | Loss=0.01213 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.495 | L2-Norm(final)=21.068 | 2069.8 samples/s | 32.3 steps/s
[Step=87100 Epoch=169.9] | Loss=0.01170 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.500 | L2-Norm(final)=21.071 | 4769.6 samples/s | 74.5 steps/s
[Step=87150 Epoch=170.0] | Loss=0.01138 | Reg=0.00072 | acc=0.9844 | L2-Norm=8.504 | L2-Norm(final)=21.074 | 4801.4 samples/s | 75.0 steps/s
[Step=87200 Epoch=170.1] | Loss=0.01098 | Reg=0.00072 | acc=0.9844 | L2-Norm=8.509 | L2-Norm(final)=21.078 | 4818.1 samples/s | 75.3 steps/s
[Step=87250 Epoch=170.2] | Loss=0.01079 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.513 | L2-Norm(final)=21.081 | 4878.8 samples/s | 76.2 steps/s
[Step=87300 Epoch=170.3] | Loss=0.01067 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.517 | L2-Norm(final)=21.084 | 4814.2 samples/s | 75.2 steps/s
[Step=87350 Epoch=170.4] | Loss=0.01055 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.521 | L2-Norm(final)=21.087 | 4759.5 samples/s | 74.4 steps/s
[Step=87400 Epoch=170.5] | Loss=0.01036 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.524 | L2-Norm(final)=21.090 | 4831.8 samples/s | 75.5 steps/s
[Step=87450 Epoch=170.6] | Loss=0.01015 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.528 | L2-Norm(final)=21.093 | 4775.0 samples/s | 74.6 steps/s
[Step=87500 Epoch=170.7] | Loss=0.01002 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.531 | L2-Norm(final)=21.096 | 5113.9 samples/s | 79.9 steps/s
[Step=87550 Epoch=170.8] | Loss=0.00982 | Reg=0.00073 | acc=0.9844 | L2-Norm=8.535 | L2-Norm(final)=21.099 | 2137.7 samples/s | 33.4 steps/s
[Step=87600 Epoch=170.9] | Loss=0.00970 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.538 | L2-Norm(final)=21.101 | 4815.7 samples/s | 75.2 steps/s
[Step=87650 Epoch=171.0] | Loss=0.00956 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.541 | L2-Norm(final)=21.104 | 4802.0 samples/s | 75.0 steps/s
[Step=87700 Epoch=171.0] | Loss=0.00946 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.545 | L2-Norm(final)=21.107 | 4772.6 samples/s | 74.6 steps/s
[Step=87750 Epoch=171.1] | Loss=0.00928 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.548 | L2-Norm(final)=21.110 | 4877.0 samples/s | 76.2 steps/s
[Step=87800 Epoch=171.2] | Loss=0.00910 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.551 | L2-Norm(final)=21.112 | 4812.4 samples/s | 75.2 steps/s
[Step=87850 Epoch=171.3] | Loss=0.00900 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.554 | L2-Norm(final)=21.115 | 4807.1 samples/s | 75.1 steps/s
[Step=87900 Epoch=171.4] | Loss=0.00886 | Reg=0.00073 | acc=0.9844 | L2-Norm=8.557 | L2-Norm(final)=21.117 | 4826.9 samples/s | 75.4 steps/s
[Step=87950 Epoch=171.5] | Loss=0.00884 | Reg=0.00073 | acc=0.9844 | L2-Norm=8.559 | L2-Norm(final)=21.120 | 4767.7 samples/s | 74.5 steps/s
[Step=88000 Epoch=171.6] | Loss=0.00874 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.562 | L2-Norm(final)=21.123 | 4798.9 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step88000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=86001 Epoch=168.1] | Loss=0.02856 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.413 | L2-Norm(final)=21.024 | 4475.6 samples/s | 69.9 steps/s
[Step=86050 Epoch=168.2] | Loss=0.01629 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.413 | L2-Norm(final)=21.030 | 5296.1 samples/s | 82.8 steps/s
[Step=86100 Epoch=168.3] | Loss=0.01623 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.413 | L2-Norm(final)=21.039 | 5533.2 samples/s | 86.5 steps/s
[Step=86150 Epoch=168.4] | Loss=0.01680 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.413 | L2-Norm(final)=21.049 | 5479.5 samples/s | 85.6 steps/s
[Step=86200 Epoch=168.5] | Loss=0.01648 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.413 | L2-Norm(final)=21.058 | 5501.0 samples/s | 86.0 steps/s
[Step=86250 Epoch=168.6] | Loss=0.01621 | Reg=0.00071 | acc=0.9688 | L2-Norm=8.413 | L2-Norm(final)=21.067 | 5512.6 samples/s | 86.1 steps/s
[Step=86300 Epoch=168.7] | Loss=0.01670 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.413 | L2-Norm(final)=21.075 | 5550.0 samples/s | 86.7 steps/s
[Step=86350 Epoch=168.8] | Loss=0.01671 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.413 | L2-Norm(final)=21.082 | 5623.4 samples/s | 87.9 steps/s
[Step=86400 Epoch=168.9] | Loss=0.01670 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.413 | L2-Norm(final)=21.090 | 5494.1 samples/s | 85.8 steps/s
[Step=86450 Epoch=169.0] | Loss=0.01650 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.413 | L2-Norm(final)=21.098 | 5560.4 samples/s | 86.9 steps/s
[Step=86500 Epoch=169.1] | Loss=0.01625 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.413 | L2-Norm(final)=21.105 | 6915.7 samples/s | 108.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=86501 Epoch=169.1] | Loss=0.00920 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.413 | L2-Norm(final)=21.183 | 4664.6 samples/s | 72.9 steps/s
[Step=86550 Epoch=169.2] | Loss=0.01379 | Reg=0.00071 | acc=0.9688 | L2-Norm=8.423 | L2-Norm(final)=21.188 | 4529.5 samples/s | 70.8 steps/s
[Step=86600 Epoch=169.3] | Loss=0.01515 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.434 | L2-Norm(final)=21.193 | 4833.4 samples/s | 75.5 steps/s
[Step=86650 Epoch=169.4] | Loss=0.01462 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.443 | L2-Norm(final)=21.198 | 4761.6 samples/s | 74.4 steps/s
[Step=86700 Epoch=169.5] | Loss=0.01412 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.452 | L2-Norm(final)=21.202 | 4799.1 samples/s | 75.0 steps/s
[Step=86750 Epoch=169.6] | Loss=0.01385 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.460 | L2-Norm(final)=21.206 | 4733.0 samples/s | 74.0 steps/s
[Step=86800 Epoch=169.7] | Loss=0.01320 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.467 | L2-Norm(final)=21.210 | 4808.2 samples/s | 75.1 steps/s
[Step=86850 Epoch=169.8] | Loss=0.01290 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.473 | L2-Norm(final)=21.213 | 4736.0 samples/s | 74.0 steps/s
[Step=86900 Epoch=169.9] | Loss=0.01258 | Reg=0.00072 | acc=0.9844 | L2-Norm=8.479 | L2-Norm(final)=21.217 | 4782.5 samples/s | 74.7 steps/s
[Step=86950 Epoch=170.0] | Loss=0.01247 | Reg=0.00072 | acc=0.9844 | L2-Norm=8.485 | L2-Norm(final)=21.221 | 4797.9 samples/s | 75.0 steps/s
[Step=87000 Epoch=170.1] | Loss=0.01211 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.490 | L2-Norm(final)=21.224 | 5862.1 samples/s | 91.6 steps/s
[Step=87050 Epoch=170.2] | Loss=0.01168 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.495 | L2-Norm(final)=21.228 | 2089.7 samples/s | 32.7 steps/s
[Step=87100 Epoch=170.3] | Loss=0.01140 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.500 | L2-Norm(final)=21.231 | 4796.4 samples/s | 74.9 steps/s
[Step=87150 Epoch=170.4] | Loss=0.01104 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.505 | L2-Norm(final)=21.234 | 4754.9 samples/s | 74.3 steps/s
[Step=87200 Epoch=170.5] | Loss=0.01085 | Reg=0.00072 | acc=0.9844 | L2-Norm=8.509 | L2-Norm(final)=21.238 | 4768.4 samples/s | 74.5 steps/s
[Step=87250 Epoch=170.6] | Loss=0.01054 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.513 | L2-Norm(final)=21.241 | 4774.1 samples/s | 74.6 steps/s
[Step=87300 Epoch=170.7] | Loss=0.01036 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.518 | L2-Norm(final)=21.244 | 4796.7 samples/s | 74.9 steps/s
[Step=87350 Epoch=170.8] | Loss=0.01017 | Reg=0.00073 | acc=0.9844 | L2-Norm=8.522 | L2-Norm(final)=21.247 | 4815.6 samples/s | 75.2 steps/s
[Step=87400 Epoch=170.9] | Loss=0.01002 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.525 | L2-Norm(final)=21.250 | 4791.0 samples/s | 74.9 steps/s
[Step=87450 Epoch=171.0] | Loss=0.00980 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.529 | L2-Norm(final)=21.253 | 4848.0 samples/s | 75.7 steps/s
[Step=87500 Epoch=171.1] | Loss=0.00960 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.533 | L2-Norm(final)=21.256 | 5119.2 samples/s | 80.0 steps/s
[Step=87550 Epoch=171.2] | Loss=0.00939 | Reg=0.00073 | acc=0.9844 | L2-Norm=8.536 | L2-Norm(final)=21.259 | 2201.5 samples/s | 34.4 steps/s
[Step=87600 Epoch=171.3] | Loss=0.00925 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.540 | L2-Norm(final)=21.262 | 4738.5 samples/s | 74.0 steps/s
[Step=87650 Epoch=171.4] | Loss=0.00915 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.543 | L2-Norm(final)=21.264 | 4774.0 samples/s | 74.6 steps/s
[Step=87700 Epoch=171.5] | Loss=0.00909 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.546 | L2-Norm(final)=21.267 | 4808.2 samples/s | 75.1 steps/s
[Step=87750 Epoch=171.5] | Loss=0.00898 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.549 | L2-Norm(final)=21.270 | 4752.9 samples/s | 74.3 steps/s
[Step=87800 Epoch=171.6] | Loss=0.00885 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.553 | L2-Norm(final)=21.272 | 4818.5 samples/s | 75.3 steps/s
[Step=87850 Epoch=171.7] | Loss=0.00873 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.556 | L2-Norm(final)=21.275 | 4763.2 samples/s | 74.4 steps/s
[Step=87900 Epoch=171.8] | Loss=0.00864 | Reg=0.00073 | acc=0.9844 | L2-Norm=8.558 | L2-Norm(final)=21.278 | 4781.6 samples/s | 74.7 steps/s
[Step=87950 Epoch=171.9] | Loss=0.00853 | Reg=0.00073 | acc=0.9844 | L2-Norm=8.561 | L2-Norm(final)=21.280 | 4820.8 samples/s | 75.3 steps/s
[Step=88000 Epoch=172.0] | Loss=0.00843 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.564 | L2-Norm(final)=21.283 | 4844.7 samples/s | 75.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step88000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=86001 Epoch=329.5] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.413 | L2-Norm(final)=18.654 | 4352.7 samples/s | 68.0 steps/s
[Step=86050 Epoch=329.7] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.406 | L2-Norm(final)=18.661 | 5174.9 samples/s | 80.9 steps/s
[Step=86100 Epoch=329.9] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.405 | L2-Norm(final)=18.668 | 5232.2 samples/s | 81.8 steps/s
[Step=86150 Epoch=330.1] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.405 | L2-Norm(final)=18.674 | 5186.8 samples/s | 81.0 steps/s
[Step=86200 Epoch=330.3] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.405 | L2-Norm(final)=18.680 | 5301.6 samples/s | 82.8 steps/s
[Step=86250 Epoch=330.5] | Loss=0.00003 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.405 | L2-Norm(final)=18.686 | 6771.1 samples/s | 105.8 steps/s
[Step=86300 Epoch=330.7] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.405 | L2-Norm(final)=18.691 | 2128.3 samples/s | 33.3 steps/s
[Step=86350 Epoch=330.9] | Loss=0.00003 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.405 | L2-Norm(final)=18.696 | 5215.6 samples/s | 81.5 steps/s
[Step=86400 Epoch=331.1] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.405 | L2-Norm(final)=18.701 | 5225.4 samples/s | 81.6 steps/s
[Step=86450 Epoch=331.2] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.405 | L2-Norm(final)=18.705 | 5209.7 samples/s | 81.4 steps/s
[Step=86500 Epoch=331.4] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.405 | L2-Norm(final)=18.709 | 5832.2 samples/s | 91.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=86501 Epoch=331.4] | Loss=0.00009 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.405 | L2-Norm(final)=18.747 | 4505.7 samples/s | 70.4 steps/s
[Step=86550 Epoch=331.6] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.391 | L2-Norm(final)=18.750 | 4260.1 samples/s | 66.6 steps/s
[Step=86600 Epoch=331.8] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.363 | L2-Norm(final)=18.752 | 4552.5 samples/s | 71.1 steps/s
[Step=86650 Epoch=332.0] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.334 | L2-Norm(final)=18.753 | 4553.5 samples/s | 71.1 steps/s
[Step=86700 Epoch=332.2] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.305 | L2-Norm(final)=18.753 | 4538.2 samples/s | 70.9 steps/s
[Step=86750 Epoch=332.4] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.276 | L2-Norm(final)=18.754 | 5779.2 samples/s | 90.3 steps/s
[Step=86800 Epoch=332.6] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.247 | L2-Norm(final)=18.755 | 2001.6 samples/s | 31.3 steps/s
[Step=86850 Epoch=332.8] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.218 | L2-Norm(final)=18.756 | 4564.5 samples/s | 71.3 steps/s
[Step=86900 Epoch=333.0] | Loss=0.00000 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.190 | L2-Norm(final)=18.756 | 4547.9 samples/s | 71.1 steps/s
[Step=86950 Epoch=333.2] | Loss=0.00000 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.161 | L2-Norm(final)=18.757 | 4603.3 samples/s | 71.9 steps/s
[Step=87000 Epoch=333.4] | Loss=0.00000 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.133 | L2-Norm(final)=18.758 | 5005.5 samples/s | 78.2 steps/s
[Step=87050 Epoch=333.5] | Loss=0.00000 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.104 | L2-Norm(final)=18.758 | 2093.7 samples/s | 32.7 steps/s
[Step=87100 Epoch=333.7] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.076 | L2-Norm(final)=18.759 | 4582.6 samples/s | 71.6 steps/s
[Step=87150 Epoch=333.9] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.047 | L2-Norm(final)=18.760 | 4571.1 samples/s | 71.4 steps/s
[Step=87200 Epoch=334.1] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.019 | L2-Norm(final)=18.760 | 4533.3 samples/s | 70.8 steps/s
[Step=87250 Epoch=334.3] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.990 | L2-Norm(final)=18.761 | 4550.1 samples/s | 71.1 steps/s
[Step=87300 Epoch=334.5] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.962 | L2-Norm(final)=18.762 | 2194.8 samples/s | 34.3 steps/s
[Step=87350 Epoch=334.7] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.933 | L2-Norm(final)=18.763 | 4658.5 samples/s | 72.8 steps/s
[Step=87400 Epoch=334.9] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.905 | L2-Norm(final)=18.763 | 4528.4 samples/s | 70.8 steps/s
[Step=87450 Epoch=335.1] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.877 | L2-Norm(final)=18.764 | 4640.9 samples/s | 72.5 steps/s
[Step=87500 Epoch=335.3] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.849 | L2-Norm(final)=18.765 | 4501.9 samples/s | 70.3 steps/s
[Step=87550 Epoch=335.5] | Loss=0.00000 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.820 | L2-Norm(final)=18.766 | 2188.2 samples/s | 34.2 steps/s
[Step=87600 Epoch=335.7] | Loss=0.00000 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.792 | L2-Norm(final)=18.767 | 4569.5 samples/s | 71.4 steps/s
[Step=87650 Epoch=335.8] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.764 | L2-Norm(final)=18.768 | 4554.6 samples/s | 71.2 steps/s
[Step=87700 Epoch=336.0] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.736 | L2-Norm(final)=18.769 | 4574.2 samples/s | 71.5 steps/s
[Step=87750 Epoch=336.2] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.708 | L2-Norm(final)=18.770 | 4582.5 samples/s | 71.6 steps/s
[Step=87800 Epoch=336.4] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.680 | L2-Norm(final)=18.771 | 6204.3 samples/s | 96.9 steps/s
[Step=87850 Epoch=336.6] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.652 | L2-Norm(final)=18.773 | 1949.2 samples/s | 30.5 steps/s
[Step=87900 Epoch=336.8] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.625 | L2-Norm(final)=18.774 | 4527.4 samples/s | 70.7 steps/s
[Step=87950 Epoch=337.0] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.597 | L2-Norm(final)=18.775 | 4527.0 samples/s | 70.7 steps/s
[Step=88000 Epoch=337.2] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.569 | L2-Norm(final)=18.776 | 4531.3 samples/s | 70.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step88000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=86001 Epoch=331.1] | Loss=0.00004 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.413 | L2-Norm(final)=19.211 | 4939.2 samples/s | 77.2 steps/s
[Step=86050 Epoch=331.2] | Loss=0.00006 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.408 | L2-Norm(final)=19.219 | 4514.6 samples/s | 70.5 steps/s
[Step=86100 Epoch=331.4] | Loss=0.00006 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.408 | L2-Norm(final)=19.229 | 5284.0 samples/s | 82.6 steps/s
[Step=86150 Epoch=331.6] | Loss=0.00006 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.408 | L2-Norm(final)=19.235 | 5175.5 samples/s | 80.9 steps/s
[Step=86200 Epoch=331.8] | Loss=0.00006 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.408 | L2-Norm(final)=19.241 | 5384.2 samples/s | 84.1 steps/s
[Step=86250 Epoch=332.0] | Loss=0.00006 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.408 | L2-Norm(final)=19.246 | 6702.2 samples/s | 104.7 steps/s
[Step=86300 Epoch=332.2] | Loss=0.00006 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.408 | L2-Norm(final)=19.251 | 2143.9 samples/s | 33.5 steps/s
[Step=86350 Epoch=332.4] | Loss=0.00005 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.408 | L2-Norm(final)=19.256 | 5174.4 samples/s | 80.8 steps/s
[Step=86400 Epoch=332.6] | Loss=0.00005 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.408 | L2-Norm(final)=19.261 | 5134.2 samples/s | 80.2 steps/s
[Step=86450 Epoch=332.8] | Loss=0.00005 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.408 | L2-Norm(final)=19.266 | 5199.5 samples/s | 81.2 steps/s
[Step=86500 Epoch=333.0] | Loss=0.00005 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.408 | L2-Norm(final)=19.270 | 6061.8 samples/s | 94.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=86501 Epoch=333.0] | Loss=0.00003 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.407 | L2-Norm(final)=19.319 | 4764.9 samples/s | 74.5 steps/s
[Step=86550 Epoch=333.2] | Loss=0.00020 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.413 | L2-Norm(final)=19.322 | 4115.5 samples/s | 64.3 steps/s
[Step=86600 Epoch=333.4] | Loss=0.00014 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.417 | L2-Norm(final)=19.323 | 4528.6 samples/s | 70.8 steps/s
[Step=86650 Epoch=333.5] | Loss=0.00010 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.418 | L2-Norm(final)=19.325 | 4580.3 samples/s | 71.6 steps/s
[Step=86700 Epoch=333.7] | Loss=0.00007 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.417 | L2-Norm(final)=19.325 | 4545.7 samples/s | 71.0 steps/s
[Step=86750 Epoch=333.9] | Loss=0.00006 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.416 | L2-Norm(final)=19.326 | 5836.6 samples/s | 91.2 steps/s
[Step=86800 Epoch=334.1] | Loss=0.00005 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.415 | L2-Norm(final)=19.327 | 2001.5 samples/s | 31.3 steps/s
[Step=86850 Epoch=334.3] | Loss=0.00005 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.413 | L2-Norm(final)=19.328 | 4565.7 samples/s | 71.3 steps/s
[Step=86900 Epoch=334.5] | Loss=0.00004 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.412 | L2-Norm(final)=19.328 | 4583.2 samples/s | 71.6 steps/s
[Step=86950 Epoch=334.7] | Loss=0.00004 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.410 | L2-Norm(final)=19.329 | 4485.8 samples/s | 70.1 steps/s
[Step=87000 Epoch=334.9] | Loss=0.00003 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.408 | L2-Norm(final)=19.329 | 5092.0 samples/s | 79.6 steps/s
[Step=87050 Epoch=335.1] | Loss=0.00003 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.406 | L2-Norm(final)=19.330 | 2082.1 samples/s | 32.5 steps/s
[Step=87100 Epoch=335.3] | Loss=0.00003 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.404 | L2-Norm(final)=19.330 | 4500.8 samples/s | 70.3 steps/s
[Step=87150 Epoch=335.5] | Loss=0.00003 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.402 | L2-Norm(final)=19.331 | 4583.6 samples/s | 71.6 steps/s
[Step=87200 Epoch=335.7] | Loss=0.00003 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.400 | L2-Norm(final)=19.331 | 4518.7 samples/s | 70.6 steps/s
[Step=87250 Epoch=335.9] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.398 | L2-Norm(final)=19.332 | 4632.5 samples/s | 72.4 steps/s
[Step=87300 Epoch=336.1] | Loss=0.00002 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.396 | L2-Norm(final)=19.332 | 2202.4 samples/s | 34.4 steps/s
[Step=87350 Epoch=336.2] | Loss=0.00002 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.394 | L2-Norm(final)=19.333 | 4590.8 samples/s | 71.7 steps/s
[Step=87400 Epoch=336.4] | Loss=0.00002 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.392 | L2-Norm(final)=19.333 | 4468.1 samples/s | 69.8 steps/s
[Step=87450 Epoch=336.6] | Loss=0.00002 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.390 | L2-Norm(final)=19.333 | 4579.2 samples/s | 71.5 steps/s
[Step=87500 Epoch=336.8] | Loss=0.00002 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.388 | L2-Norm(final)=19.334 | 4575.0 samples/s | 71.5 steps/s
[Step=87550 Epoch=337.0] | Loss=0.00002 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.385 | L2-Norm(final)=19.334 | 2177.8 samples/s | 34.0 steps/s
[Step=87600 Epoch=337.2] | Loss=0.00002 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.383 | L2-Norm(final)=19.335 | 4564.0 samples/s | 71.3 steps/s
[Step=87650 Epoch=337.4] | Loss=0.00002 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.381 | L2-Norm(final)=19.335 | 4581.8 samples/s | 71.6 steps/s
[Step=87700 Epoch=337.6] | Loss=0.00002 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.378 | L2-Norm(final)=19.336 | 4530.7 samples/s | 70.8 steps/s
[Step=87750 Epoch=337.8] | Loss=0.00002 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.376 | L2-Norm(final)=19.336 | 4542.1 samples/s | 71.0 steps/s
[Step=87800 Epoch=338.0] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.374 | L2-Norm(final)=19.336 | 6595.1 samples/s | 103.0 steps/s
[Step=87850 Epoch=338.2] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.371 | L2-Norm(final)=19.337 | 1909.9 samples/s | 29.8 steps/s
[Step=87900 Epoch=338.4] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.369 | L2-Norm(final)=19.337 | 4548.9 samples/s | 71.1 steps/s
[Step=87950 Epoch=338.6] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.366 | L2-Norm(final)=19.338 | 4529.6 samples/s | 70.8 steps/s
[Step=88000 Epoch=338.7] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.363 | L2-Norm(final)=19.338 | 4559.1 samples/s | 71.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step88000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06659 | acc=0.9688 | tpr=0.9774 | fpr=0.0498 | 4186.2 samples/s | 16.4 steps/s
Avg test loss: 0.06667, Avg test acc: 0.96831, Avg tpr: 0.97692, Avg fpr: 0.05063, total FA: 395

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06566 | acc=0.9685 | tpr=0.9743 | fpr=0.0441 | 4197.7 samples/s | 16.4 steps/s
Avg test loss: 0.06642, Avg test acc: 0.96839, Avg tpr: 0.97494, Avg fpr: 0.04602, total FA: 359

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.98078 | acc=0.3122 | tpr=0.0031 | fpr=0.0166 | 4206.7 samples/s | 16.4 steps/s
Avg test loss: 5.99345, Avg test acc: 0.30884, Avg tpr: 0.00309, Avg fpr: 0.01872, total FA: 146

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.87794 | acc=0.2995 | tpr=0.0079 | fpr=0.0674 | 4154.7 samples/s | 16.2 steps/s
Avg test loss: 5.89320, Avg test acc: 0.29650, Avg tpr: 0.00793, Avg fpr: 0.06884, total FA: 537

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.81357 | acc=0.1244 | tpr=0.3850 | fpr=0.8803 | 4200.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=4.77216 | acc=0.1248 | tpr=0.3731 | fpr=0.8799 | 7642.1 samples/s | 29.9 steps/s
[Step= 150] | Loss=4.77547 | acc=0.1232 | tpr=0.3718 | fpr=0.8814 | 8263.2 samples/s | 32.3 steps/s
[Step= 200] | Loss=4.77277 | acc=0.1236 | tpr=0.3694 | fpr=0.8809 | 7703.6 samples/s | 30.1 steps/s
[Step= 250] | Loss=4.77210 | acc=0.1235 | tpr=0.3598 | fpr=0.8808 | 7770.0 samples/s | 30.4 steps/s
[Step= 300] | Loss=4.77623 | acc=0.1226 | tpr=0.3556 | fpr=0.8817 | 7970.7 samples/s | 31.1 steps/s
[Step= 350] | Loss=4.78485 | acc=0.1219 | tpr=0.3500 | fpr=0.8822 | 7862.8 samples/s | 30.7 steps/s
[Step= 400] | Loss=4.78003 | acc=0.1214 | tpr=0.3414 | fpr=0.8826 | 7822.0 samples/s | 30.6 steps/s
[Step= 450] | Loss=4.78136 | acc=0.1210 | tpr=0.3403 | fpr=0.8830 | 8027.9 samples/s | 31.4 steps/s
[Step= 500] | Loss=4.78252 | acc=0.1208 | tpr=0.3419 | fpr=0.8832 | 7978.4 samples/s | 31.2 steps/s
[Step= 550] | Loss=4.78399 | acc=0.1208 | tpr=0.3406 | fpr=0.8832 | 13241.6 samples/s | 51.7 steps/s
Avg test loss: 4.78420, Avg test acc: 0.12072, Avg tpr: 0.34073, Avg fpr: 0.88328, total FA: 122642

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.57350 | acc=0.1415 | tpr=0.3496 | fpr=0.8623 | 4069.7 samples/s | 15.9 steps/s
[Step= 100] | Loss=4.53240 | acc=0.1415 | tpr=0.3369 | fpr=0.8621 | 8008.4 samples/s | 31.3 steps/s
[Step= 150] | Loss=4.53500 | acc=0.1412 | tpr=0.3401 | fpr=0.8625 | 7840.8 samples/s | 30.6 steps/s
[Step= 200] | Loss=4.53333 | acc=0.1412 | tpr=0.3344 | fpr=0.8623 | 8033.5 samples/s | 31.4 steps/s
[Step= 250] | Loss=4.53341 | acc=0.1411 | tpr=0.3275 | fpr=0.8623 | 7772.1 samples/s | 30.4 steps/s
[Step= 300] | Loss=4.53677 | acc=0.1404 | tpr=0.3244 | fpr=0.8630 | 7802.7 samples/s | 30.5 steps/s
[Step= 350] | Loss=4.54522 | acc=0.1398 | tpr=0.3143 | fpr=0.8634 | 8006.1 samples/s | 31.3 steps/s
[Step= 400] | Loss=4.53952 | acc=0.1392 | tpr=0.3074 | fpr=0.8639 | 7843.3 samples/s | 30.6 steps/s
[Step= 450] | Loss=4.54010 | acc=0.1386 | tpr=0.3053 | fpr=0.8645 | 7770.0 samples/s | 30.4 steps/s
[Step= 500] | Loss=4.54045 | acc=0.1384 | tpr=0.3075 | fpr=0.8646 | 7712.2 samples/s | 30.1 steps/s
[Step= 550] | Loss=4.54262 | acc=0.1386 | tpr=0.3084 | fpr=0.8645 | 14725.7 samples/s | 57.5 steps/s
Avg test loss: 4.54296, Avg test acc: 0.13850, Avg tpr: 0.30784, Avg fpr: 0.86458, total FA: 120045

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10311 | acc=0.9792 | tpr=0.9381 | fpr=0.0200 | 4178.9 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.10818 | acc=0.9789 | tpr=0.9552 | fpr=0.0207 | 7464.9 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.11058 | acc=0.9783 | tpr=0.9553 | fpr=0.0213 | 7519.3 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.11194 | acc=0.9787 | tpr=0.9585 | fpr=0.0210 | 7868.3 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.11195 | acc=0.9787 | tpr=0.9581 | fpr=0.0210 | 8032.6 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.11357 | acc=0.9784 | tpr=0.9585 | fpr=0.0212 | 7897.4 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.11364 | acc=0.9785 | tpr=0.9599 | fpr=0.0211 | 7842.5 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.11433 | acc=0.9783 | tpr=0.9573 | fpr=0.0213 | 8282.6 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.11613 | acc=0.9779 | tpr=0.9552 | fpr=0.0217 | 7537.4 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.11542 | acc=0.9780 | tpr=0.9564 | fpr=0.0216 | 7628.0 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.11467 | acc=0.9782 | tpr=0.9570 | fpr=0.0214 | 15047.2 samples/s | 58.8 steps/s
Avg test loss: 0.11440, Avg test acc: 0.97828, Avg tpr: 0.95721, Avg fpr: 0.02134, total FA: 2963

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12936 | acc=0.9777 | tpr=0.9381 | fpr=0.0216 | 4163.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.13689 | acc=0.9773 | tpr=0.9616 | fpr=0.0224 | 7872.9 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.13892 | acc=0.9769 | tpr=0.9640 | fpr=0.0228 | 7868.8 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.14017 | acc=0.9771 | tpr=0.9661 | fpr=0.0227 | 7760.9 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.14042 | acc=0.9767 | tpr=0.9642 | fpr=0.0230 | 7970.7 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.14294 | acc=0.9763 | tpr=0.9651 | fpr=0.0235 | 8204.8 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.14278 | acc=0.9763 | tpr=0.9643 | fpr=0.0234 | 7442.4 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.14415 | acc=0.9761 | tpr=0.9628 | fpr=0.0237 | 8008.5 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.14603 | acc=0.9758 | tpr=0.9601 | fpr=0.0239 | 7790.3 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.14503 | acc=0.9760 | tpr=0.9612 | fpr=0.0237 | 7718.6 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.14395 | acc=0.9762 | tpr=0.9622 | fpr=0.0235 | 14455.7 samples/s | 56.5 steps/s
Avg test loss: 0.14359, Avg test acc: 0.97626, Avg tpr: 0.96236, Avg fpr: 0.02349, total FA: 3261

server round 44/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=88001 Epoch=171.6] | Loss=0.01305 | Reg=0.00064 | acc=0.9844 | L2-Norm=8.030 | L2-Norm(final)=21.199 | 4398.0 samples/s | 68.7 steps/s
[Step=88050 Epoch=171.7] | Loss=0.01960 | Reg=0.00064 | acc=0.9844 | L2-Norm=8.031 | L2-Norm(final)=21.203 | 5173.3 samples/s | 80.8 steps/s
[Step=88100 Epoch=171.8] | Loss=0.02154 | Reg=0.00064 | acc=0.9844 | L2-Norm=8.031 | L2-Norm(final)=21.205 | 5543.1 samples/s | 86.6 steps/s
[Step=88150 Epoch=171.9] | Loss=0.02065 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.031 | L2-Norm(final)=21.207 | 5535.5 samples/s | 86.5 steps/s
[Step=88200 Epoch=172.0] | Loss=0.02033 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.031 | L2-Norm(final)=21.208 | 5606.3 samples/s | 87.6 steps/s
[Step=88250 Epoch=172.1] | Loss=0.02007 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.031 | L2-Norm(final)=21.210 | 5399.8 samples/s | 84.4 steps/s
[Step=88300 Epoch=172.2] | Loss=0.02019 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.031 | L2-Norm(final)=21.213 | 5578.9 samples/s | 87.2 steps/s
[Step=88350 Epoch=172.3] | Loss=0.02029 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.031 | L2-Norm(final)=21.215 | 5578.6 samples/s | 87.2 steps/s
[Step=88400 Epoch=172.4] | Loss=0.02019 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.031 | L2-Norm(final)=21.217 | 5607.2 samples/s | 87.6 steps/s
[Step=88450 Epoch=172.5] | Loss=0.02034 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.031 | L2-Norm(final)=21.220 | 5397.6 samples/s | 84.3 steps/s
[Step=88500 Epoch=172.6] | Loss=0.02040 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.031 | L2-Norm(final)=21.222 | 6979.5 samples/s | 109.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=88501 Epoch=172.6] | Loss=0.01530 | Reg=0.00064 | acc=0.9844 | L2-Norm=8.031 | L2-Norm(final)=21.248 | 4711.1 samples/s | 73.6 steps/s
[Step=88550 Epoch=172.7] | Loss=0.01982 | Reg=0.00065 | acc=0.9688 | L2-Norm=8.041 | L2-Norm(final)=21.252 | 4505.8 samples/s | 70.4 steps/s
[Step=88600 Epoch=172.8] | Loss=0.01873 | Reg=0.00065 | acc=0.9844 | L2-Norm=8.053 | L2-Norm(final)=21.256 | 4799.7 samples/s | 75.0 steps/s
[Step=88650 Epoch=172.9] | Loss=0.01756 | Reg=0.00065 | acc=0.9844 | L2-Norm=8.063 | L2-Norm(final)=21.260 | 4835.6 samples/s | 75.6 steps/s
[Step=88700 Epoch=173.0] | Loss=0.01723 | Reg=0.00065 | acc=0.9688 | L2-Norm=8.073 | L2-Norm(final)=21.265 | 4818.5 samples/s | 75.3 steps/s
[Step=88750 Epoch=173.1] | Loss=0.01670 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.082 | L2-Norm(final)=21.269 | 4751.0 samples/s | 74.2 steps/s
[Step=88800 Epoch=173.2] | Loss=0.01589 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.091 | L2-Norm(final)=21.273 | 4771.5 samples/s | 74.6 steps/s
[Step=88850 Epoch=173.3] | Loss=0.01554 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.098 | L2-Norm(final)=21.276 | 4866.4 samples/s | 76.0 steps/s
[Step=88900 Epoch=173.4] | Loss=0.01512 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.106 | L2-Norm(final)=21.280 | 4818.1 samples/s | 75.3 steps/s
[Step=88950 Epoch=173.5] | Loss=0.01483 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.112 | L2-Norm(final)=21.284 | 4748.7 samples/s | 74.2 steps/s
[Step=89000 Epoch=173.6] | Loss=0.01456 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.118 | L2-Norm(final)=21.287 | 5839.1 samples/s | 91.2 steps/s
[Step=89050 Epoch=173.7] | Loss=0.01405 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.124 | L2-Norm(final)=21.290 | 2019.4 samples/s | 31.6 steps/s
[Step=89100 Epoch=173.8] | Loss=0.01354 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.130 | L2-Norm(final)=21.294 | 4805.3 samples/s | 75.1 steps/s
[Step=89150 Epoch=173.9] | Loss=0.01314 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.135 | L2-Norm(final)=21.297 | 4740.0 samples/s | 74.1 steps/s
[Step=89200 Epoch=174.0] | Loss=0.01280 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.140 | L2-Norm(final)=21.300 | 4789.7 samples/s | 74.8 steps/s
[Step=89250 Epoch=174.1] | Loss=0.01263 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.145 | L2-Norm(final)=21.304 | 4813.9 samples/s | 75.2 steps/s
[Step=89300 Epoch=174.2] | Loss=0.01235 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.150 | L2-Norm(final)=21.307 | 4792.5 samples/s | 74.9 steps/s
[Step=89350 Epoch=174.3] | Loss=0.01213 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.155 | L2-Norm(final)=21.310 | 4536.7 samples/s | 70.9 steps/s
[Step=89400 Epoch=174.4] | Loss=0.01194 | Reg=0.00067 | acc=0.9688 | L2-Norm=8.159 | L2-Norm(final)=21.313 | 4644.5 samples/s | 72.6 steps/s
[Step=89450 Epoch=174.5] | Loss=0.01183 | Reg=0.00067 | acc=0.9688 | L2-Norm=8.163 | L2-Norm(final)=21.316 | 4792.8 samples/s | 74.9 steps/s
[Step=89500 Epoch=174.6] | Loss=0.01167 | Reg=0.00067 | acc=0.9688 | L2-Norm=8.167 | L2-Norm(final)=21.319 | 5090.4 samples/s | 79.5 steps/s
[Step=89550 Epoch=174.7] | Loss=0.01147 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.171 | L2-Norm(final)=21.322 | 2131.4 samples/s | 33.3 steps/s
[Step=89600 Epoch=174.8] | Loss=0.01123 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.175 | L2-Norm(final)=21.325 | 4767.2 samples/s | 74.5 steps/s
[Step=89650 Epoch=174.9] | Loss=0.01104 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.179 | L2-Norm(final)=21.328 | 4784.8 samples/s | 74.8 steps/s
[Step=89700 Epoch=174.9] | Loss=0.01085 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.183 | L2-Norm(final)=21.331 | 4782.8 samples/s | 74.7 steps/s
[Step=89750 Epoch=175.0] | Loss=0.01073 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.187 | L2-Norm(final)=21.333 | 4764.8 samples/s | 74.5 steps/s
[Step=89800 Epoch=175.1] | Loss=0.01066 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.190 | L2-Norm(final)=21.336 | 4829.7 samples/s | 75.5 steps/s
[Step=89850 Epoch=175.2] | Loss=0.01050 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.194 | L2-Norm(final)=21.339 | 4810.7 samples/s | 75.2 steps/s
[Step=89900 Epoch=175.3] | Loss=0.01037 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.197 | L2-Norm(final)=21.341 | 4763.5 samples/s | 74.4 steps/s
[Step=89950 Epoch=175.4] | Loss=0.01023 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.201 | L2-Norm(final)=21.344 | 4884.7 samples/s | 76.3 steps/s
[Step=90000 Epoch=175.5] | Loss=0.01009 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.204 | L2-Norm(final)=21.347 | 4805.6 samples/s | 75.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step90000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=88001 Epoch=172.0] | Loss=0.00663 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.030 | L2-Norm(final)=21.357 | 4541.6 samples/s | 71.0 steps/s
[Step=88050 Epoch=172.1] | Loss=0.02124 | Reg=0.00064 | acc=0.9844 | L2-Norm=8.031 | L2-Norm(final)=21.357 | 5268.1 samples/s | 82.3 steps/s
[Step=88100 Epoch=172.2] | Loss=0.02172 | Reg=0.00064 | acc=0.9844 | L2-Norm=8.031 | L2-Norm(final)=21.360 | 5448.5 samples/s | 85.1 steps/s
[Step=88150 Epoch=172.3] | Loss=0.02008 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.031 | L2-Norm(final)=21.363 | 5598.0 samples/s | 87.5 steps/s
[Step=88200 Epoch=172.4] | Loss=0.01957 | Reg=0.00064 | acc=0.9844 | L2-Norm=8.031 | L2-Norm(final)=21.367 | 5445.9 samples/s | 85.1 steps/s
[Step=88250 Epoch=172.5] | Loss=0.01949 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.031 | L2-Norm(final)=21.372 | 5517.9 samples/s | 86.2 steps/s
[Step=88300 Epoch=172.6] | Loss=0.01953 | Reg=0.00064 | acc=0.9688 | L2-Norm=8.031 | L2-Norm(final)=21.377 | 5520.8 samples/s | 86.3 steps/s
[Step=88350 Epoch=172.7] | Loss=0.01951 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.031 | L2-Norm(final)=21.382 | 5631.1 samples/s | 88.0 steps/s
[Step=88400 Epoch=172.8] | Loss=0.01936 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.031 | L2-Norm(final)=21.388 | 5374.2 samples/s | 84.0 steps/s
[Step=88450 Epoch=172.9] | Loss=0.01914 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.031 | L2-Norm(final)=21.393 | 5532.0 samples/s | 86.4 steps/s
[Step=88500 Epoch=173.0] | Loss=0.01922 | Reg=0.00064 | acc=0.9688 | L2-Norm=8.031 | L2-Norm(final)=21.399 | 7078.5 samples/s | 110.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=88501 Epoch=173.0] | Loss=0.02495 | Reg=0.00064 | acc=0.9844 | L2-Norm=8.031 | L2-Norm(final)=21.453 | 4391.2 samples/s | 68.6 steps/s
[Step=88550 Epoch=173.1] | Loss=0.01740 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.042 | L2-Norm(final)=21.458 | 4758.5 samples/s | 74.4 steps/s
[Step=88600 Epoch=173.2] | Loss=0.01701 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.054 | L2-Norm(final)=21.463 | 4777.7 samples/s | 74.7 steps/s
[Step=88650 Epoch=173.3] | Loss=0.01627 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.065 | L2-Norm(final)=21.468 | 4718.7 samples/s | 73.7 steps/s
[Step=88700 Epoch=173.4] | Loss=0.01618 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.074 | L2-Norm(final)=21.472 | 4800.9 samples/s | 75.0 steps/s
[Step=88750 Epoch=173.5] | Loss=0.01596 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.083 | L2-Norm(final)=21.477 | 4808.2 samples/s | 75.1 steps/s
[Step=88800 Epoch=173.6] | Loss=0.01542 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.091 | L2-Norm(final)=21.481 | 4732.6 samples/s | 73.9 steps/s
[Step=88850 Epoch=173.7] | Loss=0.01510 | Reg=0.00066 | acc=0.9688 | L2-Norm=8.099 | L2-Norm(final)=21.485 | 4766.8 samples/s | 74.5 steps/s
[Step=88900 Epoch=173.8] | Loss=0.01470 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.106 | L2-Norm(final)=21.488 | 4757.7 samples/s | 74.3 steps/s
[Step=88950 Epoch=173.9] | Loss=0.01440 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.112 | L2-Norm(final)=21.492 | 4779.3 samples/s | 74.7 steps/s
[Step=89000 Epoch=174.0] | Loss=0.01383 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.118 | L2-Norm(final)=21.496 | 5931.5 samples/s | 92.7 steps/s
[Step=89050 Epoch=174.1] | Loss=0.01329 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.124 | L2-Norm(final)=21.499 | 2031.0 samples/s | 31.7 steps/s
[Step=89100 Epoch=174.2] | Loss=0.01283 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.130 | L2-Norm(final)=21.503 | 4695.1 samples/s | 73.4 steps/s
[Step=89150 Epoch=174.3] | Loss=0.01247 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.135 | L2-Norm(final)=21.506 | 4781.2 samples/s | 74.7 steps/s
[Step=89200 Epoch=174.4] | Loss=0.01211 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.140 | L2-Norm(final)=21.510 | 4844.4 samples/s | 75.7 steps/s
[Step=89250 Epoch=174.5] | Loss=0.01182 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.144 | L2-Norm(final)=21.513 | 4799.2 samples/s | 75.0 steps/s
[Step=89300 Epoch=174.6] | Loss=0.01156 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.149 | L2-Norm(final)=21.516 | 4761.1 samples/s | 74.4 steps/s
[Step=89350 Epoch=174.7] | Loss=0.01139 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.154 | L2-Norm(final)=21.519 | 4719.6 samples/s | 73.7 steps/s
[Step=89400 Epoch=174.8] | Loss=0.01114 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.158 | L2-Norm(final)=21.523 | 4792.1 samples/s | 74.9 steps/s
[Step=89450 Epoch=174.9] | Loss=0.01103 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.162 | L2-Norm(final)=21.526 | 4823.5 samples/s | 75.4 steps/s
[Step=89500 Epoch=175.0] | Loss=0.01098 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.166 | L2-Norm(final)=21.529 | 5097.4 samples/s | 79.6 steps/s
[Step=89550 Epoch=175.1] | Loss=0.01077 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.170 | L2-Norm(final)=21.532 | 2180.3 samples/s | 34.1 steps/s
[Step=89600 Epoch=175.2] | Loss=0.01051 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.174 | L2-Norm(final)=21.535 | 4846.8 samples/s | 75.7 steps/s
[Step=89650 Epoch=175.3] | Loss=0.01029 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.178 | L2-Norm(final)=21.537 | 4700.8 samples/s | 73.4 steps/s
[Step=89700 Epoch=175.4] | Loss=0.01015 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.182 | L2-Norm(final)=21.540 | 4754.6 samples/s | 74.3 steps/s
[Step=89750 Epoch=175.5] | Loss=0.01005 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.186 | L2-Norm(final)=21.543 | 4738.6 samples/s | 74.0 steps/s
[Step=89800 Epoch=175.6] | Loss=0.00990 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.189 | L2-Norm(final)=21.546 | 4816.3 samples/s | 75.3 steps/s
[Step=89850 Epoch=175.7] | Loss=0.00980 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.193 | L2-Norm(final)=21.549 | 4804.1 samples/s | 75.1 steps/s
[Step=89900 Epoch=175.8] | Loss=0.00969 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.196 | L2-Norm(final)=21.552 | 4805.0 samples/s | 75.1 steps/s
[Step=89950 Epoch=175.8] | Loss=0.00958 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.200 | L2-Norm(final)=21.554 | 4833.5 samples/s | 75.5 steps/s
[Step=90000 Epoch=175.9] | Loss=0.00945 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.203 | L2-Norm(final)=21.557 | 4763.3 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step90000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=88001 Epoch=337.2] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.030 | L2-Norm(final)=18.816 | 4495.1 samples/s | 70.2 steps/s
[Step=88050 Epoch=337.4] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.022 | L2-Norm(final)=18.821 | 5052.1 samples/s | 78.9 steps/s
[Step=88100 Epoch=337.6] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.021 | L2-Norm(final)=18.826 | 5180.7 samples/s | 80.9 steps/s
[Step=88150 Epoch=337.8] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.021 | L2-Norm(final)=18.831 | 5153.3 samples/s | 80.5 steps/s
[Step=88200 Epoch=338.0] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.021 | L2-Norm(final)=18.837 | 5230.3 samples/s | 81.7 steps/s
[Step=88250 Epoch=338.1] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.020 | L2-Norm(final)=18.842 | 6787.3 samples/s | 106.1 steps/s
[Step=88300 Epoch=338.3] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.020 | L2-Norm(final)=18.847 | 2128.9 samples/s | 33.3 steps/s
[Step=88350 Epoch=338.5] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.020 | L2-Norm(final)=18.852 | 5189.3 samples/s | 81.1 steps/s
[Step=88400 Epoch=338.7] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.020 | L2-Norm(final)=18.857 | 5188.2 samples/s | 81.1 steps/s
[Step=88450 Epoch=338.9] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.020 | L2-Norm(final)=18.861 | 5228.6 samples/s | 81.7 steps/s
[Step=88500 Epoch=339.1] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.020 | L2-Norm(final)=18.866 | 5893.8 samples/s | 92.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=88501 Epoch=339.1] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.020 | L2-Norm(final)=18.909 | 4395.4 samples/s | 68.7 steps/s
[Step=88550 Epoch=339.3] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.985 | L2-Norm(final)=18.912 | 4386.2 samples/s | 68.5 steps/s
[Step=88600 Epoch=339.5] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.940 | L2-Norm(final)=18.913 | 4515.6 samples/s | 70.6 steps/s
[Step=88650 Epoch=339.7] | Loss=0.00002 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.899 | L2-Norm(final)=18.915 | 4622.4 samples/s | 72.2 steps/s
[Step=88700 Epoch=339.9] | Loss=0.00002 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.877 | L2-Norm(final)=18.916 | 4490.4 samples/s | 70.2 steps/s
[Step=88750 Epoch=340.1] | Loss=0.00002 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.863 | L2-Norm(final)=18.918 | 5725.2 samples/s | 89.5 steps/s
[Step=88800 Epoch=340.3] | Loss=0.00002 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.853 | L2-Norm(final)=18.920 | 2002.2 samples/s | 31.3 steps/s
[Step=88850 Epoch=340.4] | Loss=0.00002 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.844 | L2-Norm(final)=18.922 | 4539.4 samples/s | 70.9 steps/s
[Step=88900 Epoch=340.6] | Loss=0.00002 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.836 | L2-Norm(final)=18.923 | 4580.6 samples/s | 71.6 steps/s
[Step=88950 Epoch=340.8] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.829 | L2-Norm(final)=18.924 | 4463.0 samples/s | 69.7 steps/s
[Step=89000 Epoch=341.0] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.822 | L2-Norm(final)=18.925 | 5024.9 samples/s | 78.5 steps/s
[Step=89050 Epoch=341.2] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.816 | L2-Norm(final)=18.925 | 2114.1 samples/s | 33.0 steps/s
[Step=89100 Epoch=341.4] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.810 | L2-Norm(final)=18.926 | 4481.6 samples/s | 70.0 steps/s
[Step=89150 Epoch=341.6] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.804 | L2-Norm(final)=18.927 | 4548.7 samples/s | 71.1 steps/s
[Step=89200 Epoch=341.8] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.798 | L2-Norm(final)=18.927 | 4527.0 samples/s | 70.7 steps/s
[Step=89250 Epoch=342.0] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.792 | L2-Norm(final)=18.928 | 4523.6 samples/s | 70.7 steps/s
[Step=89300 Epoch=342.2] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.786 | L2-Norm(final)=18.928 | 2166.4 samples/s | 33.8 steps/s
[Step=89350 Epoch=342.4] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.780 | L2-Norm(final)=18.929 | 4618.5 samples/s | 72.2 steps/s
[Step=89400 Epoch=342.5] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.774 | L2-Norm(final)=18.929 | 4547.3 samples/s | 71.1 steps/s
[Step=89450 Epoch=342.7] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.768 | L2-Norm(final)=18.929 | 4537.1 samples/s | 70.9 steps/s
[Step=89500 Epoch=342.9] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.762 | L2-Norm(final)=18.930 | 4546.3 samples/s | 71.0 steps/s
[Step=89550 Epoch=343.1] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.757 | L2-Norm(final)=18.930 | 2227.2 samples/s | 34.8 steps/s
[Step=89600 Epoch=343.3] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.751 | L2-Norm(final)=18.931 | 4397.0 samples/s | 68.7 steps/s
[Step=89650 Epoch=343.5] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.745 | L2-Norm(final)=18.931 | 4520.4 samples/s | 70.6 steps/s
[Step=89700 Epoch=343.7] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.739 | L2-Norm(final)=18.932 | 4595.6 samples/s | 71.8 steps/s
[Step=89750 Epoch=343.9] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.733 | L2-Norm(final)=18.932 | 4462.8 samples/s | 69.7 steps/s
[Step=89800 Epoch=344.1] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.727 | L2-Norm(final)=18.932 | 6172.3 samples/s | 96.4 steps/s
[Step=89850 Epoch=344.3] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.721 | L2-Norm(final)=18.933 | 1955.1 samples/s | 30.5 steps/s
[Step=89900 Epoch=344.5] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.715 | L2-Norm(final)=18.933 | 4551.9 samples/s | 71.1 steps/s
[Step=89950 Epoch=344.7] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.708 | L2-Norm(final)=18.934 | 4525.0 samples/s | 70.7 steps/s
[Step=90000 Epoch=344.8] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.702 | L2-Norm(final)=18.934 | 4571.2 samples/s | 71.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step90000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=88001 Epoch=338.8] | Loss=0.00005 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.030 | L2-Norm(final)=19.351 | 4740.3 samples/s | 74.1 steps/s
[Step=88050 Epoch=338.9] | Loss=0.00008 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.029 | L2-Norm(final)=19.355 | 4766.2 samples/s | 74.5 steps/s
[Step=88100 Epoch=339.1] | Loss=0.00009 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.029 | L2-Norm(final)=19.360 | 5071.4 samples/s | 79.2 steps/s
[Step=88150 Epoch=339.3] | Loss=0.00010 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.029 | L2-Norm(final)=19.365 | 5254.9 samples/s | 82.1 steps/s
[Step=88200 Epoch=339.5] | Loss=0.00009 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.029 | L2-Norm(final)=19.371 | 5289.2 samples/s | 82.6 steps/s
[Step=88250 Epoch=339.7] | Loss=0.00009 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.029 | L2-Norm(final)=19.376 | 6888.5 samples/s | 107.6 steps/s
[Step=88300 Epoch=339.9] | Loss=0.00009 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.029 | L2-Norm(final)=19.381 | 2105.8 samples/s | 32.9 steps/s
[Step=88350 Epoch=340.1] | Loss=0.00008 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.029 | L2-Norm(final)=19.385 | 5286.4 samples/s | 82.6 steps/s
[Step=88400 Epoch=340.3] | Loss=0.00009 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.029 | L2-Norm(final)=19.390 | 5030.1 samples/s | 78.6 steps/s
[Step=88450 Epoch=340.5] | Loss=0.00009 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.029 | L2-Norm(final)=19.395 | 5291.7 samples/s | 82.7 steps/s
[Step=88500 Epoch=340.7] | Loss=0.00009 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.029 | L2-Norm(final)=19.399 | 6024.3 samples/s | 94.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=88501 Epoch=340.7] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.029 | L2-Norm(final)=19.446 | 4372.1 samples/s | 68.3 steps/s
[Step=88550 Epoch=340.9] | Loss=0.00013 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.033 | L2-Norm(final)=19.449 | 4499.2 samples/s | 70.3 steps/s
[Step=88600 Epoch=341.1] | Loss=0.00008 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.036 | L2-Norm(final)=19.451 | 4562.3 samples/s | 71.3 steps/s
[Step=88650 Epoch=341.2] | Loss=0.00007 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.036 | L2-Norm(final)=19.453 | 4551.5 samples/s | 71.1 steps/s
[Step=88700 Epoch=341.4] | Loss=0.00005 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.036 | L2-Norm(final)=19.454 | 4587.9 samples/s | 71.7 steps/s
[Step=88750 Epoch=341.6] | Loss=0.00004 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.034 | L2-Norm(final)=19.455 | 5756.3 samples/s | 89.9 steps/s
[Step=88800 Epoch=341.8] | Loss=0.00004 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.033 | L2-Norm(final)=19.456 | 2004.5 samples/s | 31.3 steps/s
[Step=88850 Epoch=342.0] | Loss=0.00003 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.031 | L2-Norm(final)=19.457 | 4489.0 samples/s | 70.1 steps/s
[Step=88900 Epoch=342.2] | Loss=0.00003 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.029 | L2-Norm(final)=19.458 | 4523.3 samples/s | 70.7 steps/s
[Step=88950 Epoch=342.4] | Loss=0.00003 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.026 | L2-Norm(final)=19.459 | 4599.4 samples/s | 71.9 steps/s
[Step=89000 Epoch=342.6] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.024 | L2-Norm(final)=19.460 | 5121.7 samples/s | 80.0 steps/s
[Step=89050 Epoch=342.8] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.021 | L2-Norm(final)=19.460 | 2088.6 samples/s | 32.6 steps/s
[Step=89100 Epoch=343.0] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.019 | L2-Norm(final)=19.461 | 4507.7 samples/s | 70.4 steps/s
[Step=89150 Epoch=343.2] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.016 | L2-Norm(final)=19.461 | 4561.7 samples/s | 71.3 steps/s
[Step=89200 Epoch=343.4] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.013 | L2-Norm(final)=19.462 | 4544.1 samples/s | 71.0 steps/s
[Step=89250 Epoch=343.6] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.011 | L2-Norm(final)=19.463 | 4647.2 samples/s | 72.6 steps/s
[Step=89300 Epoch=343.8] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.008 | L2-Norm(final)=19.463 | 2178.8 samples/s | 34.0 steps/s
[Step=89350 Epoch=343.9] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.005 | L2-Norm(final)=19.464 | 4615.6 samples/s | 72.1 steps/s
[Step=89400 Epoch=344.1] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.002 | L2-Norm(final)=19.464 | 4504.5 samples/s | 70.4 steps/s
[Step=89450 Epoch=344.3] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.999 | L2-Norm(final)=19.465 | 4542.9 samples/s | 71.0 steps/s
[Step=89500 Epoch=344.5] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.996 | L2-Norm(final)=19.465 | 4469.9 samples/s | 69.8 steps/s
[Step=89550 Epoch=344.7] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.993 | L2-Norm(final)=19.466 | 2214.5 samples/s | 34.6 steps/s
[Step=89600 Epoch=344.9] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.990 | L2-Norm(final)=19.466 | 4665.1 samples/s | 72.9 steps/s
[Step=89650 Epoch=345.1] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.987 | L2-Norm(final)=19.467 | 4441.2 samples/s | 69.4 steps/s
[Step=89700 Epoch=345.3] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.984 | L2-Norm(final)=19.467 | 4593.4 samples/s | 71.8 steps/s
[Step=89750 Epoch=345.5] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.980 | L2-Norm(final)=19.468 | 4546.2 samples/s | 71.0 steps/s
[Step=89800 Epoch=345.7] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.977 | L2-Norm(final)=19.468 | 6546.2 samples/s | 102.3 steps/s
[Step=89850 Epoch=345.9] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.974 | L2-Norm(final)=19.469 | 1907.4 samples/s | 29.8 steps/s
[Step=89900 Epoch=346.1] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.970 | L2-Norm(final)=19.469 | 4528.8 samples/s | 70.8 steps/s
[Step=89950 Epoch=346.3] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.967 | L2-Norm(final)=19.469 | 4559.1 samples/s | 71.2 steps/s
[Step=90000 Epoch=346.4] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.963 | L2-Norm(final)=19.470 | 4579.7 samples/s | 71.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step90000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06490 | acc=0.9677 | tpr=0.9764 | fpr=0.0513 | 4170.8 samples/s | 16.3 steps/s
Avg test loss: 0.06546, Avg test acc: 0.96718, Avg tpr: 0.97616, Avg fpr: 0.05256, total FA: 410

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06594 | acc=0.9668 | tpr=0.9695 | fpr=0.0391 | 4203.1 samples/s | 16.4 steps/s
Avg test loss: 0.06626, Avg test acc: 0.96735, Avg tpr: 0.97074, Avg fpr: 0.04012, total FA: 313

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.29067 | acc=0.3109 | tpr=0.0025 | fpr=0.0196 | 4212.9 samples/s | 16.5 steps/s
Avg test loss: 6.30829, Avg test acc: 0.30744, Avg tpr: 0.00233, Avg fpr: 0.02154, total FA: 168

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.89661 | acc=0.3020 | tpr=0.0059 | fpr=0.0553 | 4164.0 samples/s | 16.3 steps/s
Avg test loss: 5.91165, Avg test acc: 0.29794, Avg tpr: 0.00560, Avg fpr: 0.05909, total FA: 461

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.65041 | acc=0.1266 | tpr=0.3850 | fpr=0.8780 | 4316.4 samples/s | 16.9 steps/s
[Step= 100] | Loss=4.60974 | acc=0.1272 | tpr=0.3774 | fpr=0.8774 | 7350.5 samples/s | 28.7 steps/s
[Step= 150] | Loss=4.61172 | acc=0.1263 | tpr=0.3746 | fpr=0.8782 | 7662.8 samples/s | 29.9 steps/s
[Step= 200] | Loss=4.60921 | acc=0.1267 | tpr=0.3716 | fpr=0.8777 | 8053.6 samples/s | 31.5 steps/s
[Step= 250] | Loss=4.60830 | acc=0.1267 | tpr=0.3607 | fpr=0.8776 | 7781.1 samples/s | 30.4 steps/s
[Step= 300] | Loss=4.61209 | acc=0.1259 | tpr=0.3535 | fpr=0.8782 | 8019.2 samples/s | 31.3 steps/s
[Step= 350] | Loss=4.62015 | acc=0.1254 | tpr=0.3482 | fpr=0.8787 | 7867.6 samples/s | 30.7 steps/s
[Step= 400] | Loss=4.61499 | acc=0.1249 | tpr=0.3425 | fpr=0.8791 | 7861.6 samples/s | 30.7 steps/s
[Step= 450] | Loss=4.61613 | acc=0.1245 | tpr=0.3408 | fpr=0.8795 | 7999.8 samples/s | 31.2 steps/s
[Step= 500] | Loss=4.61668 | acc=0.1243 | tpr=0.3432 | fpr=0.8796 | 7935.3 samples/s | 31.0 steps/s
[Step= 550] | Loss=4.61793 | acc=0.1244 | tpr=0.3410 | fpr=0.8795 | 13714.0 samples/s | 53.6 steps/s
Avg test loss: 4.61829, Avg test acc: 0.12429, Avg tpr: 0.34073, Avg fpr: 0.87965, total FA: 122137

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.34791 | acc=0.1445 | tpr=0.3230 | fpr=0.8587 | 4139.6 samples/s | 16.2 steps/s
[Step= 100] | Loss=4.31216 | acc=0.1448 | tpr=0.2985 | fpr=0.8581 | 7715.3 samples/s | 30.1 steps/s
[Step= 150] | Loss=4.31510 | acc=0.1443 | tpr=0.3040 | fpr=0.8586 | 8036.3 samples/s | 31.4 steps/s
[Step= 200] | Loss=4.31308 | acc=0.1447 | tpr=0.3016 | fpr=0.8581 | 7840.1 samples/s | 30.6 steps/s
[Step= 250] | Loss=4.31346 | acc=0.1446 | tpr=0.2969 | fpr=0.8582 | 7985.8 samples/s | 31.2 steps/s
[Step= 300] | Loss=4.31557 | acc=0.1440 | tpr=0.2938 | fpr=0.8588 | 7694.5 samples/s | 30.1 steps/s
[Step= 350] | Loss=4.32315 | acc=0.1435 | tpr=0.2837 | fpr=0.8590 | 7790.0 samples/s | 30.4 steps/s
[Step= 400] | Loss=4.31727 | acc=0.1431 | tpr=0.2795 | fpr=0.8594 | 7964.7 samples/s | 31.1 steps/s
[Step= 450] | Loss=4.31809 | acc=0.1426 | tpr=0.2780 | fpr=0.8599 | 7919.8 samples/s | 30.9 steps/s
[Step= 500] | Loss=4.31788 | acc=0.1423 | tpr=0.2811 | fpr=0.8602 | 7698.7 samples/s | 30.1 steps/s
[Step= 550] | Loss=4.31961 | acc=0.1425 | tpr=0.2817 | fpr=0.8600 | 14689.5 samples/s | 57.4 steps/s
Avg test loss: 4.31990, Avg test acc: 0.14245, Avg tpr: 0.28130, Avg fpr: 0.86008, total FA: 119420

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10330 | acc=0.9816 | tpr=0.9248 | fpr=0.0174 | 4221.4 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.10917 | acc=0.9807 | tpr=0.9467 | fpr=0.0187 | 7667.5 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.11114 | acc=0.9802 | tpr=0.9510 | fpr=0.0193 | 7781.6 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.11240 | acc=0.9805 | tpr=0.9541 | fpr=0.0190 | 7786.0 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.11231 | acc=0.9804 | tpr=0.9528 | fpr=0.0191 | 7883.5 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.11405 | acc=0.9801 | tpr=0.9549 | fpr=0.0194 | 8034.9 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.11406 | acc=0.9802 | tpr=0.9555 | fpr=0.0193 | 7810.6 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.11498 | acc=0.9799 | tpr=0.9535 | fpr=0.0196 | 7861.0 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.11681 | acc=0.9796 | tpr=0.9523 | fpr=0.0199 | 7763.4 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.11606 | acc=0.9798 | tpr=0.9542 | fpr=0.0197 | 7879.4 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.11539 | acc=0.9800 | tpr=0.9554 | fpr=0.0195 | 14482.2 samples/s | 56.6 steps/s
Avg test loss: 0.11509, Avg test acc: 0.98006, Avg tpr: 0.95563, Avg fpr: 0.01950, total FA: 2707

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12408 | acc=0.9781 | tpr=0.9425 | fpr=0.0212 | 4184.7 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.13156 | acc=0.9776 | tpr=0.9638 | fpr=0.0222 | 7790.7 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.13354 | acc=0.9771 | tpr=0.9654 | fpr=0.0226 | 7853.4 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.13469 | acc=0.9774 | tpr=0.9661 | fpr=0.0224 | 7886.4 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.13490 | acc=0.9772 | tpr=0.9642 | fpr=0.0225 | 7902.7 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.13726 | acc=0.9769 | tpr=0.9651 | fpr=0.0229 | 7860.2 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.13723 | acc=0.9769 | tpr=0.9649 | fpr=0.0229 | 8143.9 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.13852 | acc=0.9766 | tpr=0.9633 | fpr=0.0232 | 7533.2 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.14045 | acc=0.9763 | tpr=0.9606 | fpr=0.0234 | 7747.0 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.13959 | acc=0.9764 | tpr=0.9621 | fpr=0.0234 | 7975.0 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.13864 | acc=0.9766 | tpr=0.9630 | fpr=0.0231 | 14193.1 samples/s | 55.4 steps/s
Avg test loss: 0.13830, Avg test acc: 0.97664, Avg tpr: 0.96315, Avg fpr: 0.02312, total FA: 3210

server round 45/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=90001 Epoch=175.5] | Loss=0.00838 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.955 | L2-Norm(final)=21.427 | 5031.1 samples/s | 78.6 steps/s
[Step=90050 Epoch=175.6] | Loss=0.01590 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.956 | L2-Norm(final)=21.432 | 4680.3 samples/s | 73.1 steps/s
[Step=90100 Epoch=175.7] | Loss=0.01801 | Reg=0.00063 | acc=0.9688 | L2-Norm=7.956 | L2-Norm(final)=21.438 | 5408.1 samples/s | 84.5 steps/s
[Step=90150 Epoch=175.8] | Loss=0.01768 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.956 | L2-Norm(final)=21.445 | 5617.4 samples/s | 87.8 steps/s
[Step=90200 Epoch=175.9] | Loss=0.01725 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.956 | L2-Norm(final)=21.450 | 5505.5 samples/s | 86.0 steps/s
[Step=90250 Epoch=176.0] | Loss=0.01683 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.956 | L2-Norm(final)=21.457 | 5633.1 samples/s | 88.0 steps/s
[Step=90300 Epoch=176.1] | Loss=0.01683 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.956 | L2-Norm(final)=21.463 | 5508.2 samples/s | 86.1 steps/s
[Step=90350 Epoch=176.2] | Loss=0.01713 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.956 | L2-Norm(final)=21.469 | 5498.5 samples/s | 85.9 steps/s
[Step=90400 Epoch=176.3] | Loss=0.01679 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.956 | L2-Norm(final)=21.475 | 5579.9 samples/s | 87.2 steps/s
[Step=90450 Epoch=176.4] | Loss=0.01686 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.956 | L2-Norm(final)=21.481 | 5520.3 samples/s | 86.3 steps/s
[Step=90500 Epoch=176.5] | Loss=0.01694 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.956 | L2-Norm(final)=21.487 | 7057.7 samples/s | 110.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=90501 Epoch=176.5] | Loss=0.01132 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.956 | L2-Norm(final)=21.547 | 4275.3 samples/s | 66.8 steps/s
[Step=90550 Epoch=176.6] | Loss=0.01643 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.965 | L2-Norm(final)=21.552 | 4640.3 samples/s | 72.5 steps/s
[Step=90600 Epoch=176.7] | Loss=0.01612 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.975 | L2-Norm(final)=21.556 | 4836.1 samples/s | 75.6 steps/s
[Step=90650 Epoch=176.8] | Loss=0.01582 | Reg=0.00064 | acc=0.9844 | L2-Norm=7.985 | L2-Norm(final)=21.560 | 4717.8 samples/s | 73.7 steps/s
[Step=90700 Epoch=176.9] | Loss=0.01526 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.993 | L2-Norm(final)=21.564 | 4772.8 samples/s | 74.6 steps/s
[Step=90750 Epoch=177.0] | Loss=0.01484 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.001 | L2-Norm(final)=21.568 | 4777.2 samples/s | 74.6 steps/s
[Step=90800 Epoch=177.1] | Loss=0.01436 | Reg=0.00064 | acc=0.9844 | L2-Norm=8.008 | L2-Norm(final)=21.572 | 4821.9 samples/s | 75.3 steps/s
[Step=90850 Epoch=177.2] | Loss=0.01415 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.015 | L2-Norm(final)=21.575 | 4829.0 samples/s | 75.5 steps/s
[Step=90900 Epoch=177.3] | Loss=0.01354 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.021 | L2-Norm(final)=21.579 | 4806.8 samples/s | 75.1 steps/s
[Step=90950 Epoch=177.4] | Loss=0.01334 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.027 | L2-Norm(final)=21.582 | 4848.0 samples/s | 75.7 steps/s
[Step=91000 Epoch=177.5] | Loss=0.01315 | Reg=0.00065 | acc=0.9844 | L2-Norm=8.033 | L2-Norm(final)=21.586 | 5780.8 samples/s | 90.3 steps/s
[Step=91050 Epoch=177.6] | Loss=0.01258 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.039 | L2-Norm(final)=21.589 | 2027.5 samples/s | 31.7 steps/s
[Step=91100 Epoch=177.7] | Loss=0.01224 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.044 | L2-Norm(final)=21.593 | 4789.5 samples/s | 74.8 steps/s
[Step=91150 Epoch=177.8] | Loss=0.01182 | Reg=0.00065 | acc=0.9844 | L2-Norm=8.049 | L2-Norm(final)=21.596 | 4695.8 samples/s | 73.4 steps/s
[Step=91200 Epoch=177.9] | Loss=0.01147 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.054 | L2-Norm(final)=21.599 | 4794.6 samples/s | 74.9 steps/s
[Step=91250 Epoch=178.0] | Loss=0.01129 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.059 | L2-Norm(final)=21.603 | 4804.4 samples/s | 75.1 steps/s
[Step=91300 Epoch=178.1] | Loss=0.01106 | Reg=0.00065 | acc=0.9844 | L2-Norm=8.064 | L2-Norm(final)=21.606 | 4835.6 samples/s | 75.6 steps/s
[Step=91350 Epoch=178.2] | Loss=0.01102 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.068 | L2-Norm(final)=21.609 | 4792.5 samples/s | 74.9 steps/s
[Step=91400 Epoch=178.3] | Loss=0.01089 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.072 | L2-Norm(final)=21.612 | 4796.1 samples/s | 74.9 steps/s
[Step=91450 Epoch=178.4] | Loss=0.01081 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.077 | L2-Norm(final)=21.615 | 4724.9 samples/s | 73.8 steps/s
[Step=91500 Epoch=178.5] | Loss=0.01070 | Reg=0.00065 | acc=0.9844 | L2-Norm=8.081 | L2-Norm(final)=21.617 | 5092.6 samples/s | 79.6 steps/s
[Step=91550 Epoch=178.6] | Loss=0.01045 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.084 | L2-Norm(final)=21.620 | 2104.7 samples/s | 32.9 steps/s
[Step=91600 Epoch=178.7] | Loss=0.01030 | Reg=0.00065 | acc=0.9844 | L2-Norm=8.088 | L2-Norm(final)=21.623 | 4835.8 samples/s | 75.6 steps/s
[Step=91650 Epoch=178.8] | Loss=0.01017 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.092 | L2-Norm(final)=21.626 | 4782.8 samples/s | 74.7 steps/s
[Step=91700 Epoch=178.9] | Loss=0.01000 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.095 | L2-Norm(final)=21.628 | 4765.8 samples/s | 74.5 steps/s
[Step=91750 Epoch=178.9] | Loss=0.00986 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.099 | L2-Norm(final)=21.631 | 4809.0 samples/s | 75.1 steps/s
[Step=91800 Epoch=179.0] | Loss=0.00977 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.102 | L2-Norm(final)=21.634 | 4799.6 samples/s | 75.0 steps/s
[Step=91850 Epoch=179.1] | Loss=0.00965 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.106 | L2-Norm(final)=21.636 | 4848.1 samples/s | 75.8 steps/s
[Step=91900 Epoch=179.2] | Loss=0.00956 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.109 | L2-Norm(final)=21.639 | 4794.6 samples/s | 74.9 steps/s
[Step=91950 Epoch=179.3] | Loss=0.00946 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.113 | L2-Norm(final)=21.641 | 4806.7 samples/s | 75.1 steps/s
[Step=92000 Epoch=179.4] | Loss=0.00938 | Reg=0.00066 | acc=0.9688 | L2-Norm=8.116 | L2-Norm(final)=21.644 | 4782.4 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step92000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=90001 Epoch=175.9] | Loss=0.01767 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.955 | L2-Norm(final)=21.637 | 5063.2 samples/s | 79.1 steps/s
[Step=90050 Epoch=176.0] | Loss=0.01832 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.956 | L2-Norm(final)=21.638 | 4413.4 samples/s | 69.0 steps/s
[Step=90100 Epoch=176.1] | Loss=0.01681 | Reg=0.00063 | acc=0.9688 | L2-Norm=7.956 | L2-Norm(final)=21.639 | 5462.1 samples/s | 85.3 steps/s
[Step=90150 Epoch=176.2] | Loss=0.01680 | Reg=0.00063 | acc=0.9688 | L2-Norm=7.956 | L2-Norm(final)=21.641 | 5498.9 samples/s | 85.9 steps/s
[Step=90200 Epoch=176.3] | Loss=0.01693 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.956 | L2-Norm(final)=21.643 | 5585.8 samples/s | 87.3 steps/s
[Step=90250 Epoch=176.4] | Loss=0.01713 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.956 | L2-Norm(final)=21.645 | 5702.7 samples/s | 89.1 steps/s
[Step=90300 Epoch=176.5] | Loss=0.01709 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.956 | L2-Norm(final)=21.647 | 5354.6 samples/s | 83.7 steps/s
[Step=90350 Epoch=176.6] | Loss=0.01715 | Reg=0.00063 | acc=0.9688 | L2-Norm=7.956 | L2-Norm(final)=21.650 | 5468.2 samples/s | 85.4 steps/s
[Step=90400 Epoch=176.7] | Loss=0.01690 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.956 | L2-Norm(final)=21.653 | 5556.2 samples/s | 86.8 steps/s
[Step=90450 Epoch=176.8] | Loss=0.01671 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.956 | L2-Norm(final)=21.656 | 5557.6 samples/s | 86.8 steps/s
[Step=90500 Epoch=176.9] | Loss=0.01633 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.957 | L2-Norm(final)=21.660 | 7027.9 samples/s | 109.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=90501 Epoch=176.9] | Loss=0.02338 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.957 | L2-Norm(final)=21.696 | 4745.4 samples/s | 74.1 steps/s
[Step=90550 Epoch=177.0] | Loss=0.01606 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.965 | L2-Norm(final)=21.701 | 4414.2 samples/s | 69.0 steps/s
[Step=90600 Epoch=177.1] | Loss=0.01371 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.976 | L2-Norm(final)=21.706 | 4820.1 samples/s | 75.3 steps/s
[Step=90650 Epoch=177.2] | Loss=0.01404 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.986 | L2-Norm(final)=21.711 | 4813.5 samples/s | 75.2 steps/s
[Step=90700 Epoch=177.3] | Loss=0.01337 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.995 | L2-Norm(final)=21.715 | 4718.2 samples/s | 73.7 steps/s
[Step=90750 Epoch=177.4] | Loss=0.01342 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.002 | L2-Norm(final)=21.719 | 4742.0 samples/s | 74.1 steps/s
[Step=90800 Epoch=177.5] | Loss=0.01318 | Reg=0.00064 | acc=0.9844 | L2-Norm=8.009 | L2-Norm(final)=21.722 | 4847.0 samples/s | 75.7 steps/s
[Step=90850 Epoch=177.6] | Loss=0.01326 | Reg=0.00064 | acc=0.9844 | L2-Norm=8.016 | L2-Norm(final)=21.726 | 4768.9 samples/s | 74.5 steps/s
[Step=90900 Epoch=177.7] | Loss=0.01282 | Reg=0.00064 | acc=0.9844 | L2-Norm=8.022 | L2-Norm(final)=21.729 | 4831.4 samples/s | 75.5 steps/s
[Step=90950 Epoch=177.8] | Loss=0.01263 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.028 | L2-Norm(final)=21.733 | 4736.8 samples/s | 74.0 steps/s
[Step=91000 Epoch=177.9] | Loss=0.01230 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.034 | L2-Norm(final)=21.736 | 5863.1 samples/s | 91.6 steps/s
[Step=91050 Epoch=178.0] | Loss=0.01186 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.040 | L2-Norm(final)=21.740 | 2096.6 samples/s | 32.8 steps/s
[Step=91100 Epoch=178.1] | Loss=0.01150 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.045 | L2-Norm(final)=21.743 | 4746.7 samples/s | 74.2 steps/s
[Step=91150 Epoch=178.2] | Loss=0.01109 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.050 | L2-Norm(final)=21.746 | 4758.8 samples/s | 74.4 steps/s
[Step=91200 Epoch=178.3] | Loss=0.01081 | Reg=0.00065 | acc=0.9688 | L2-Norm=8.055 | L2-Norm(final)=21.750 | 4805.2 samples/s | 75.1 steps/s
[Step=91250 Epoch=178.4] | Loss=0.01058 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.060 | L2-Norm(final)=21.753 | 4749.3 samples/s | 74.2 steps/s
[Step=91300 Epoch=178.5] | Loss=0.01042 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.065 | L2-Norm(final)=21.756 | 4760.9 samples/s | 74.4 steps/s
[Step=91350 Epoch=178.6] | Loss=0.01027 | Reg=0.00065 | acc=0.9688 | L2-Norm=8.069 | L2-Norm(final)=21.759 | 4841.1 samples/s | 75.6 steps/s
[Step=91400 Epoch=178.7] | Loss=0.01013 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.073 | L2-Norm(final)=21.762 | 4730.5 samples/s | 73.9 steps/s
[Step=91450 Epoch=178.8] | Loss=0.01011 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.077 | L2-Norm(final)=21.764 | 4798.0 samples/s | 75.0 steps/s
[Step=91500 Epoch=178.9] | Loss=0.01003 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.081 | L2-Norm(final)=21.767 | 5180.2 samples/s | 80.9 steps/s
[Step=91550 Epoch=179.0] | Loss=0.00995 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.085 | L2-Norm(final)=21.770 | 2185.7 samples/s | 34.2 steps/s
[Step=91600 Epoch=179.1] | Loss=0.00976 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.089 | L2-Norm(final)=21.773 | 4738.8 samples/s | 74.0 steps/s
[Step=91650 Epoch=179.2] | Loss=0.00962 | Reg=0.00065 | acc=0.9844 | L2-Norm=8.092 | L2-Norm(final)=21.775 | 4803.8 samples/s | 75.1 steps/s
[Step=91700 Epoch=179.3] | Loss=0.00951 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.096 | L2-Norm(final)=21.778 | 4782.8 samples/s | 74.7 steps/s
[Step=91750 Epoch=179.4] | Loss=0.00937 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.099 | L2-Norm(final)=21.781 | 4740.5 samples/s | 74.1 steps/s
[Step=91800 Epoch=179.5] | Loss=0.00923 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.103 | L2-Norm(final)=21.783 | 4773.8 samples/s | 74.6 steps/s
[Step=91850 Epoch=179.6] | Loss=0.00911 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.106 | L2-Norm(final)=21.786 | 4786.8 samples/s | 74.8 steps/s
[Step=91900 Epoch=179.7] | Loss=0.00903 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.109 | L2-Norm(final)=21.788 | 4816.5 samples/s | 75.3 steps/s
[Step=91950 Epoch=179.8] | Loss=0.00893 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.112 | L2-Norm(final)=21.791 | 4732.0 samples/s | 73.9 steps/s
[Step=92000 Epoch=179.9] | Loss=0.00888 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.116 | L2-Norm(final)=21.793 | 4761.9 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step92000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=90001 Epoch=344.9] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.955 | L2-Norm(final)=18.946 | 4639.5 samples/s | 72.5 steps/s
[Step=90050 Epoch=345.0] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.953 | L2-Norm(final)=18.949 | 5125.1 samples/s | 80.1 steps/s
[Step=90100 Epoch=345.2] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.953 | L2-Norm(final)=18.953 | 5102.2 samples/s | 79.7 steps/s
[Step=90150 Epoch=345.4] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.953 | L2-Norm(final)=18.956 | 5190.7 samples/s | 81.1 steps/s
[Step=90200 Epoch=345.6] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.953 | L2-Norm(final)=18.959 | 5095.2 samples/s | 79.6 steps/s
[Step=90250 Epoch=345.8] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.953 | L2-Norm(final)=18.962 | 6852.0 samples/s | 107.1 steps/s
[Step=90300 Epoch=346.0] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.953 | L2-Norm(final)=18.965 | 2156.3 samples/s | 33.7 steps/s
[Step=90350 Epoch=346.2] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.953 | L2-Norm(final)=18.968 | 5165.1 samples/s | 80.7 steps/s
[Step=90400 Epoch=346.4] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.953 | L2-Norm(final)=18.971 | 5264.2 samples/s | 82.3 steps/s
[Step=90450 Epoch=346.6] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.953 | L2-Norm(final)=18.974 | 5216.5 samples/s | 81.5 steps/s
[Step=90500 Epoch=346.8] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.953 | L2-Norm(final)=18.977 | 5915.6 samples/s | 92.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=90501 Epoch=346.8] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.953 | L2-Norm(final)=19.009 | 4768.7 samples/s | 74.5 steps/s
[Step=90550 Epoch=347.0] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.941 | L2-Norm(final)=19.013 | 4104.9 samples/s | 64.1 steps/s
[Step=90600 Epoch=347.1] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.928 | L2-Norm(final)=19.015 | 4582.7 samples/s | 71.6 steps/s
[Step=90650 Epoch=347.3] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.916 | L2-Norm(final)=19.017 | 4584.3 samples/s | 71.6 steps/s
[Step=90700 Epoch=347.5] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.904 | L2-Norm(final)=19.019 | 4548.8 samples/s | 71.1 steps/s
[Step=90750 Epoch=347.7] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.892 | L2-Norm(final)=19.020 | 5677.5 samples/s | 88.7 steps/s
[Step=90800 Epoch=347.9] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.879 | L2-Norm(final)=19.022 | 2008.0 samples/s | 31.4 steps/s
[Step=90850 Epoch=348.1] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.867 | L2-Norm(final)=19.023 | 4510.8 samples/s | 70.5 steps/s
[Step=90900 Epoch=348.3] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.855 | L2-Norm(final)=19.024 | 4504.2 samples/s | 70.4 steps/s
[Step=90950 Epoch=348.5] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.843 | L2-Norm(final)=19.025 | 4554.4 samples/s | 71.2 steps/s
[Step=91000 Epoch=348.7] | Loss=0.00000 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.830 | L2-Norm(final)=19.026 | 5013.8 samples/s | 78.3 steps/s
[Step=91050 Epoch=348.9] | Loss=0.00000 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.818 | L2-Norm(final)=19.028 | 2112.6 samples/s | 33.0 steps/s
[Step=91100 Epoch=349.1] | Loss=0.00000 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.806 | L2-Norm(final)=19.029 | 4476.4 samples/s | 69.9 steps/s
[Step=91150 Epoch=349.3] | Loss=0.00000 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.793 | L2-Norm(final)=19.030 | 4564.2 samples/s | 71.3 steps/s
[Step=91200 Epoch=349.4] | Loss=0.00000 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.781 | L2-Norm(final)=19.031 | 4491.2 samples/s | 70.2 steps/s
[Step=91250 Epoch=349.6] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.768 | L2-Norm(final)=19.032 | 4553.2 samples/s | 71.1 steps/s
[Step=91300 Epoch=349.8] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.756 | L2-Norm(final)=19.033 | 2157.5 samples/s | 33.7 steps/s
[Step=91350 Epoch=350.0] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.743 | L2-Norm(final)=19.034 | 4631.4 samples/s | 72.4 steps/s
[Step=91400 Epoch=350.2] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.730 | L2-Norm(final)=19.035 | 4569.5 samples/s | 71.4 steps/s
[Step=91450 Epoch=350.4] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.717 | L2-Norm(final)=19.036 | 4514.4 samples/s | 70.5 steps/s
[Step=91500 Epoch=350.6] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.704 | L2-Norm(final)=19.038 | 4520.5 samples/s | 70.6 steps/s
[Step=91550 Epoch=350.8] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.691 | L2-Norm(final)=19.039 | 2155.6 samples/s | 33.7 steps/s
[Step=91600 Epoch=351.0] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.678 | L2-Norm(final)=19.040 | 4402.6 samples/s | 68.8 steps/s
[Step=91650 Epoch=351.2] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.665 | L2-Norm(final)=19.041 | 4365.0 samples/s | 68.2 steps/s
[Step=91700 Epoch=351.4] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.651 | L2-Norm(final)=19.042 | 4291.9 samples/s | 67.1 steps/s
[Step=91750 Epoch=351.6] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.638 | L2-Norm(final)=19.044 | 4546.2 samples/s | 71.0 steps/s
[Step=91800 Epoch=351.7] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.625 | L2-Norm(final)=19.045 | 6197.5 samples/s | 96.8 steps/s
[Step=91850 Epoch=351.9] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.611 | L2-Norm(final)=19.046 | 1950.0 samples/s | 30.5 steps/s
[Step=91900 Epoch=352.1] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.597 | L2-Norm(final)=19.048 | 4560.2 samples/s | 71.3 steps/s
[Step=91950 Epoch=352.3] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.583 | L2-Norm(final)=19.049 | 4568.4 samples/s | 71.4 steps/s
[Step=92000 Epoch=352.5] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.570 | L2-Norm(final)=19.050 | 4535.8 samples/s | 70.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step92000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=90001 Epoch=346.4] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.955 | L2-Norm(final)=19.484 | 4421.8 samples/s | 69.1 steps/s
[Step=90050 Epoch=346.6] | Loss=0.00006 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.954 | L2-Norm(final)=19.488 | 4603.4 samples/s | 71.9 steps/s
[Step=90100 Epoch=346.8] | Loss=0.00006 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.954 | L2-Norm(final)=19.494 | 5002.8 samples/s | 78.2 steps/s
[Step=90150 Epoch=347.0] | Loss=0.00006 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.954 | L2-Norm(final)=19.499 | 4945.8 samples/s | 77.3 steps/s
[Step=90200 Epoch=347.2] | Loss=0.00006 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.954 | L2-Norm(final)=19.504 | 5256.7 samples/s | 82.1 steps/s
[Step=90250 Epoch=347.4] | Loss=0.00006 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.954 | L2-Norm(final)=19.509 | 6735.5 samples/s | 105.2 steps/s
[Step=90300 Epoch=347.6] | Loss=0.00006 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.954 | L2-Norm(final)=19.514 | 2132.2 samples/s | 33.3 steps/s
[Step=90350 Epoch=347.8] | Loss=0.00006 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.954 | L2-Norm(final)=19.520 | 5217.6 samples/s | 81.5 steps/s
[Step=90400 Epoch=348.0] | Loss=0.00006 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.954 | L2-Norm(final)=19.525 | 5137.5 samples/s | 80.3 steps/s
[Step=90450 Epoch=348.2] | Loss=0.00006 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.954 | L2-Norm(final)=19.530 | 5216.9 samples/s | 81.5 steps/s
[Step=90500 Epoch=348.4] | Loss=0.00006 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.954 | L2-Norm(final)=19.535 | 6105.1 samples/s | 95.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=90501 Epoch=348.4] | Loss=0.00012 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.954 | L2-Norm(final)=19.585 | 4522.1 samples/s | 70.7 steps/s
[Step=90550 Epoch=348.6] | Loss=0.00020 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.959 | L2-Norm(final)=19.589 | 4322.3 samples/s | 67.5 steps/s
[Step=90600 Epoch=348.8] | Loss=0.00011 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.964 | L2-Norm(final)=19.592 | 4588.8 samples/s | 71.7 steps/s
[Step=90650 Epoch=348.9] | Loss=0.00008 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.964 | L2-Norm(final)=19.594 | 4504.4 samples/s | 70.4 steps/s
[Step=90700 Epoch=349.1] | Loss=0.00006 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.964 | L2-Norm(final)=19.595 | 4527.4 samples/s | 70.7 steps/s
[Step=90750 Epoch=349.3] | Loss=0.00005 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.962 | L2-Norm(final)=19.597 | 5831.7 samples/s | 91.1 steps/s
[Step=90800 Epoch=349.5] | Loss=0.00005 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.961 | L2-Norm(final)=19.598 | 1992.2 samples/s | 31.1 steps/s
[Step=90850 Epoch=349.7] | Loss=0.00004 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.959 | L2-Norm(final)=19.598 | 4495.3 samples/s | 70.2 steps/s
[Step=90900 Epoch=349.9] | Loss=0.00004 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.957 | L2-Norm(final)=19.599 | 4554.1 samples/s | 71.2 steps/s
[Step=90950 Epoch=350.1] | Loss=0.00003 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.954 | L2-Norm(final)=19.600 | 4617.3 samples/s | 72.1 steps/s
[Step=91000 Epoch=350.3] | Loss=0.00003 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.952 | L2-Norm(final)=19.600 | 5052.6 samples/s | 78.9 steps/s
[Step=91050 Epoch=350.5] | Loss=0.00003 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.950 | L2-Norm(final)=19.601 | 2105.7 samples/s | 32.9 steps/s
[Step=91100 Epoch=350.7] | Loss=0.00003 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.947 | L2-Norm(final)=19.602 | 4471.4 samples/s | 69.9 steps/s
[Step=91150 Epoch=350.9] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.945 | L2-Norm(final)=19.602 | 4589.8 samples/s | 71.7 steps/s
[Step=91200 Epoch=351.1] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.942 | L2-Norm(final)=19.603 | 4537.5 samples/s | 70.9 steps/s
[Step=91250 Epoch=351.3] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.940 | L2-Norm(final)=19.603 | 4602.0 samples/s | 71.9 steps/s
[Step=91300 Epoch=351.4] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.937 | L2-Norm(final)=19.604 | 2181.4 samples/s | 34.1 steps/s
[Step=91350 Epoch=351.6] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.935 | L2-Norm(final)=19.604 | 4613.5 samples/s | 72.1 steps/s
[Step=91400 Epoch=351.8] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.932 | L2-Norm(final)=19.605 | 4561.7 samples/s | 71.3 steps/s
[Step=91450 Epoch=352.0] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.929 | L2-Norm(final)=19.605 | 4527.6 samples/s | 70.7 steps/s
[Step=91500 Epoch=352.2] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.926 | L2-Norm(final)=19.606 | 4631.2 samples/s | 72.4 steps/s
[Step=91550 Epoch=352.4] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.923 | L2-Norm(final)=19.606 | 2183.6 samples/s | 34.1 steps/s
[Step=91600 Epoch=352.6] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.921 | L2-Norm(final)=19.606 | 4581.1 samples/s | 71.6 steps/s
[Step=91650 Epoch=352.8] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.918 | L2-Norm(final)=19.607 | 4539.6 samples/s | 70.9 steps/s
[Step=91700 Epoch=353.0] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.915 | L2-Norm(final)=19.607 | 4610.4 samples/s | 72.0 steps/s
[Step=91750 Epoch=353.2] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.912 | L2-Norm(final)=19.608 | 4474.6 samples/s | 69.9 steps/s
[Step=91800 Epoch=353.4] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.909 | L2-Norm(final)=19.608 | 6673.0 samples/s | 104.3 steps/s
[Step=91850 Epoch=353.6] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.906 | L2-Norm(final)=19.609 | 1921.4 samples/s | 30.0 steps/s
[Step=91900 Epoch=353.8] | Loss=0.00001 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.903 | L2-Norm(final)=19.609 | 4479.9 samples/s | 70.0 steps/s
[Step=91950 Epoch=354.0] | Loss=0.00001 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.899 | L2-Norm(final)=19.610 | 4521.6 samples/s | 70.7 steps/s
[Step=92000 Epoch=354.1] | Loss=0.00001 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.896 | L2-Norm(final)=19.610 | 4519.1 samples/s | 70.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step92000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06637 | acc=0.9683 | tpr=0.9760 | fpr=0.0486 | 4048.5 samples/s | 15.8 steps/s
Avg test loss: 0.06709, Avg test acc: 0.96747, Avg tpr: 0.97570, Avg fpr: 0.05063, total FA: 395

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06579 | acc=0.9684 | tpr=0.9771 | fpr=0.0503 | 4194.7 samples/s | 16.4 steps/s
Avg test loss: 0.06642, Avg test acc: 0.96847, Avg tpr: 0.97768, Avg fpr: 0.05179, total FA: 404

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.18089 | acc=0.3102 | tpr=0.0035 | fpr=0.0238 | 4172.1 samples/s | 16.3 steps/s
Avg test loss: 6.19344, Avg test acc: 0.30728, Avg tpr: 0.00332, Avg fpr: 0.02423, total FA: 189

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.90511 | acc=0.3031 | tpr=0.0057 | fpr=0.0510 | 4156.4 samples/s | 16.2 steps/s
Avg test loss: 5.92042, Avg test acc: 0.29986, Avg tpr: 0.00565, Avg fpr: 0.05307, total FA: 414

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.81807 | acc=0.1245 | tpr=0.3230 | fpr=0.8790 | 4186.5 samples/s | 16.4 steps/s
[Step= 100] | Loss=4.77609 | acc=0.1247 | tpr=0.3028 | fpr=0.8786 | 7684.5 samples/s | 30.0 steps/s
[Step= 150] | Loss=4.77806 | acc=0.1238 | tpr=0.3098 | fpr=0.8796 | 7930.6 samples/s | 31.0 steps/s
[Step= 200] | Loss=4.77517 | acc=0.1240 | tpr=0.3049 | fpr=0.8793 | 7757.7 samples/s | 30.3 steps/s
[Step= 250] | Loss=4.77489 | acc=0.1239 | tpr=0.2987 | fpr=0.8792 | 7899.0 samples/s | 30.9 steps/s
[Step= 300] | Loss=4.77881 | acc=0.1232 | tpr=0.2931 | fpr=0.8799 | 7977.3 samples/s | 31.2 steps/s
[Step= 350] | Loss=4.78695 | acc=0.1227 | tpr=0.2899 | fpr=0.8804 | 7758.8 samples/s | 30.3 steps/s
[Step= 400] | Loss=4.78190 | acc=0.1222 | tpr=0.2834 | fpr=0.8807 | 7839.2 samples/s | 30.6 steps/s
[Step= 450] | Loss=4.78326 | acc=0.1217 | tpr=0.2833 | fpr=0.8812 | 7952.7 samples/s | 31.1 steps/s
[Step= 500] | Loss=4.78366 | acc=0.1217 | tpr=0.2850 | fpr=0.8812 | 7674.9 samples/s | 30.0 steps/s
[Step= 550] | Loss=4.78528 | acc=0.1217 | tpr=0.2825 | fpr=0.8812 | 14904.2 samples/s | 58.2 steps/s
Avg test loss: 4.78563, Avg test acc: 0.12157, Avg tpr: 0.28209, Avg fpr: 0.88135, total FA: 122374

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.91866 | acc=0.1263 | tpr=0.3584 | fpr=0.8778 | 4135.1 samples/s | 16.2 steps/s
[Step= 100] | Loss=4.87939 | acc=0.1271 | tpr=0.3305 | fpr=0.8767 | 7941.8 samples/s | 31.0 steps/s
[Step= 150] | Loss=4.88189 | acc=0.1266 | tpr=0.3329 | fpr=0.8772 | 7760.4 samples/s | 30.3 steps/s
[Step= 200] | Loss=4.88031 | acc=0.1269 | tpr=0.3290 | fpr=0.8768 | 8157.1 samples/s | 31.9 steps/s
[Step= 250] | Loss=4.88078 | acc=0.1268 | tpr=0.3240 | fpr=0.8768 | 7729.8 samples/s | 30.2 steps/s
[Step= 300] | Loss=4.88360 | acc=0.1259 | tpr=0.3185 | fpr=0.8776 | 7814.0 samples/s | 30.5 steps/s
[Step= 350] | Loss=4.89175 | acc=0.1251 | tpr=0.3106 | fpr=0.8782 | 8043.6 samples/s | 31.4 steps/s
[Step= 400] | Loss=4.88596 | acc=0.1247 | tpr=0.3085 | fpr=0.8787 | 7793.7 samples/s | 30.4 steps/s
[Step= 450] | Loss=4.88707 | acc=0.1242 | tpr=0.3067 | fpr=0.8791 | 7724.4 samples/s | 30.2 steps/s
[Step= 500] | Loss=4.88677 | acc=0.1237 | tpr=0.3084 | fpr=0.8796 | 7751.1 samples/s | 30.3 steps/s
[Step= 550] | Loss=4.88864 | acc=0.1238 | tpr=0.3072 | fpr=0.8795 | 14547.8 samples/s | 56.8 steps/s
Avg test loss: 4.88898, Avg test acc: 0.12371, Avg tpr: 0.30666, Avg fpr: 0.87962, total FA: 122133

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10978 | acc=0.9798 | tpr=0.9381 | fpr=0.0195 | 4151.5 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.11582 | acc=0.9788 | tpr=0.9574 | fpr=0.0209 | 7912.3 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.11809 | acc=0.9782 | tpr=0.9582 | fpr=0.0215 | 7870.8 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.11934 | acc=0.9786 | tpr=0.9607 | fpr=0.0211 | 7923.4 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.11928 | acc=0.9782 | tpr=0.9590 | fpr=0.0214 | 7770.8 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.12102 | acc=0.9779 | tpr=0.9600 | fpr=0.0217 | 8152.3 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.12105 | acc=0.9780 | tpr=0.9599 | fpr=0.0217 | 7966.3 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.12186 | acc=0.9777 | tpr=0.9579 | fpr=0.0220 | 7602.1 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.12365 | acc=0.9774 | tpr=0.9562 | fpr=0.0222 | 8126.0 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.12289 | acc=0.9775 | tpr=0.9577 | fpr=0.0222 | 7433.6 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.12213 | acc=0.9777 | tpr=0.9590 | fpr=0.0220 | 15121.9 samples/s | 59.1 steps/s
Avg test loss: 0.12183, Avg test acc: 0.97774, Avg tpr: 0.95919, Avg fpr: 0.02192, total FA: 3044

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12324 | acc=0.9780 | tpr=0.9381 | fpr=0.0213 | 4252.6 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.13035 | acc=0.9775 | tpr=0.9616 | fpr=0.0222 | 7438.8 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.13242 | acc=0.9771 | tpr=0.9640 | fpr=0.0227 | 7851.2 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.13358 | acc=0.9774 | tpr=0.9661 | fpr=0.0224 | 7950.9 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.13391 | acc=0.9771 | tpr=0.9642 | fpr=0.0227 | 7891.4 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.13635 | acc=0.9767 | tpr=0.9658 | fpr=0.0231 | 8106.6 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.13624 | acc=0.9768 | tpr=0.9656 | fpr=0.0230 | 7920.2 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.13755 | acc=0.9766 | tpr=0.9644 | fpr=0.0232 | 7679.2 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.13953 | acc=0.9763 | tpr=0.9620 | fpr=0.0235 | 7931.3 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.13866 | acc=0.9764 | tpr=0.9634 | fpr=0.0234 | 7921.0 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.13775 | acc=0.9766 | tpr=0.9642 | fpr=0.0232 | 14763.7 samples/s | 57.7 steps/s
Avg test loss: 0.13742, Avg test acc: 0.97662, Avg tpr: 0.96434, Avg fpr: 0.02315, total FA: 3215

server round 46/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=92001 Epoch=179.4] | Loss=0.01257 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.801 | L2-Norm(final)=21.719 | 4346.2 samples/s | 67.9 steps/s
[Step=92050 Epoch=179.5] | Loss=0.01862 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.801 | L2-Norm(final)=21.721 | 5094.7 samples/s | 79.6 steps/s
[Step=92100 Epoch=179.6] | Loss=0.01797 | Reg=0.00061 | acc=0.9531 | L2-Norm=7.801 | L2-Norm(final)=21.723 | 5509.6 samples/s | 86.1 steps/s
[Step=92150 Epoch=179.7] | Loss=0.01768 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.801 | L2-Norm(final)=21.725 | 5520.4 samples/s | 86.3 steps/s
[Step=92200 Epoch=179.8] | Loss=0.01767 | Reg=0.00061 | acc=0.9688 | L2-Norm=7.801 | L2-Norm(final)=21.727 | 5539.3 samples/s | 86.6 steps/s
[Step=92250 Epoch=179.9] | Loss=0.01737 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.801 | L2-Norm(final)=21.729 | 5688.5 samples/s | 88.9 steps/s
[Step=92300 Epoch=180.0] | Loss=0.01746 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.801 | L2-Norm(final)=21.732 | 5404.0 samples/s | 84.4 steps/s
[Step=92350 Epoch=180.1] | Loss=0.01757 | Reg=0.00061 | acc=0.9688 | L2-Norm=7.801 | L2-Norm(final)=21.735 | 5583.0 samples/s | 87.2 steps/s
[Step=92400 Epoch=180.2] | Loss=0.01733 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.801 | L2-Norm(final)=21.737 | 5629.3 samples/s | 88.0 steps/s
[Step=92450 Epoch=180.3] | Loss=0.01728 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.801 | L2-Norm(final)=21.740 | 5410.9 samples/s | 84.5 steps/s
[Step=92500 Epoch=180.4] | Loss=0.01724 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.801 | L2-Norm(final)=21.743 | 6880.8 samples/s | 107.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=92501 Epoch=180.4] | Loss=0.01071 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.801 | L2-Norm(final)=21.775 | 4395.9 samples/s | 68.7 steps/s
[Step=92550 Epoch=180.5] | Loss=0.01784 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.810 | L2-Norm(final)=21.779 | 4337.8 samples/s | 67.8 steps/s
[Step=92600 Epoch=180.6] | Loss=0.01667 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.820 | L2-Norm(final)=21.784 | 4754.9 samples/s | 74.3 steps/s
[Step=92650 Epoch=180.7] | Loss=0.01617 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.829 | L2-Norm(final)=21.788 | 4765.4 samples/s | 74.5 steps/s
[Step=92700 Epoch=180.8] | Loss=0.01542 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.838 | L2-Norm(final)=21.792 | 4781.1 samples/s | 74.7 steps/s
[Step=92750 Epoch=180.9] | Loss=0.01474 | Reg=0.00062 | acc=0.9844 | L2-Norm=7.846 | L2-Norm(final)=21.795 | 4782.8 samples/s | 74.7 steps/s
[Step=92800 Epoch=181.0] | Loss=0.01445 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.854 | L2-Norm(final)=21.799 | 4850.8 samples/s | 75.8 steps/s
[Step=92850 Epoch=181.1] | Loss=0.01437 | Reg=0.00062 | acc=0.9844 | L2-Norm=7.861 | L2-Norm(final)=21.803 | 4797.8 samples/s | 75.0 steps/s
[Step=92900 Epoch=181.2] | Loss=0.01376 | Reg=0.00062 | acc=0.9688 | L2-Norm=7.868 | L2-Norm(final)=21.806 | 4776.8 samples/s | 74.6 steps/s
[Step=92950 Epoch=181.3] | Loss=0.01343 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.875 | L2-Norm(final)=21.810 | 4830.9 samples/s | 75.5 steps/s
[Step=93000 Epoch=181.4] | Loss=0.01330 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.881 | L2-Norm(final)=21.813 | 5803.6 samples/s | 90.7 steps/s
[Step=93050 Epoch=181.5] | Loss=0.01276 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.887 | L2-Norm(final)=21.817 | 2068.8 samples/s | 32.3 steps/s
[Step=93100 Epoch=181.6] | Loss=0.01240 | Reg=0.00062 | acc=0.9844 | L2-Norm=7.892 | L2-Norm(final)=21.820 | 4766.2 samples/s | 74.5 steps/s
[Step=93150 Epoch=181.7] | Loss=0.01206 | Reg=0.00062 | acc=0.9844 | L2-Norm=7.898 | L2-Norm(final)=21.823 | 4783.4 samples/s | 74.7 steps/s
[Step=93200 Epoch=181.8] | Loss=0.01185 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.903 | L2-Norm(final)=21.827 | 4788.2 samples/s | 74.8 steps/s
[Step=93250 Epoch=181.9] | Loss=0.01171 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.908 | L2-Norm(final)=21.830 | 4782.7 samples/s | 74.7 steps/s
[Step=93300 Epoch=182.0] | Loss=0.01149 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.912 | L2-Norm(final)=21.833 | 4804.2 samples/s | 75.1 steps/s
[Step=93350 Epoch=182.1] | Loss=0.01135 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.917 | L2-Norm(final)=21.836 | 4819.4 samples/s | 75.3 steps/s
[Step=93400 Epoch=182.2] | Loss=0.01125 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.921 | L2-Norm(final)=21.839 | 4774.5 samples/s | 74.6 steps/s
[Step=93450 Epoch=182.3] | Loss=0.01109 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.926 | L2-Norm(final)=21.841 | 4812.2 samples/s | 75.2 steps/s
[Step=93500 Epoch=182.4] | Loss=0.01093 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.930 | L2-Norm(final)=21.844 | 5088.2 samples/s | 79.5 steps/s
[Step=93550 Epoch=182.5] | Loss=0.01075 | Reg=0.00063 | acc=0.9688 | L2-Norm=7.934 | L2-Norm(final)=21.847 | 2113.2 samples/s | 33.0 steps/s
[Step=93600 Epoch=182.6] | Loss=0.01059 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.938 | L2-Norm(final)=21.850 | 4803.4 samples/s | 75.1 steps/s
[Step=93650 Epoch=182.7] | Loss=0.01036 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.942 | L2-Norm(final)=21.853 | 4724.2 samples/s | 73.8 steps/s
[Step=93700 Epoch=182.8] | Loss=0.01024 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.946 | L2-Norm(final)=21.856 | 4783.8 samples/s | 74.7 steps/s
[Step=93750 Epoch=182.8] | Loss=0.01012 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.950 | L2-Norm(final)=21.859 | 4784.3 samples/s | 74.8 steps/s
[Step=93800 Epoch=182.9] | Loss=0.01000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.954 | L2-Norm(final)=21.861 | 4853.1 samples/s | 75.8 steps/s
[Step=93850 Epoch=183.0] | Loss=0.00986 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.958 | L2-Norm(final)=21.864 | 4805.6 samples/s | 75.1 steps/s
[Step=93900 Epoch=183.1] | Loss=0.00980 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.962 | L2-Norm(final)=21.867 | 4839.1 samples/s | 75.6 steps/s
[Step=93950 Epoch=183.2] | Loss=0.00973 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.965 | L2-Norm(final)=21.869 | 4730.1 samples/s | 73.9 steps/s
[Step=94000 Epoch=183.3] | Loss=0.00968 | Reg=0.00064 | acc=0.9844 | L2-Norm=7.969 | L2-Norm(final)=21.872 | 4772.8 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step94000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=92001 Epoch=179.9] | Loss=0.00901 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.801 | L2-Norm(final)=21.866 | 4498.5 samples/s | 70.3 steps/s
[Step=92050 Epoch=180.0] | Loss=0.01738 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.801 | L2-Norm(final)=21.867 | 5270.0 samples/s | 82.3 steps/s
[Step=92100 Epoch=180.1] | Loss=0.01691 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.801 | L2-Norm(final)=21.867 | 5435.8 samples/s | 84.9 steps/s
[Step=92150 Epoch=180.2] | Loss=0.01731 | Reg=0.00061 | acc=0.9688 | L2-Norm=7.801 | L2-Norm(final)=21.867 | 5496.1 samples/s | 85.9 steps/s
[Step=92200 Epoch=180.2] | Loss=0.01786 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.801 | L2-Norm(final)=21.867 | 5551.6 samples/s | 86.7 steps/s
[Step=92250 Epoch=180.3] | Loss=0.01756 | Reg=0.00061 | acc=0.9688 | L2-Norm=7.801 | L2-Norm(final)=21.867 | 5500.8 samples/s | 86.0 steps/s
[Step=92300 Epoch=180.4] | Loss=0.01755 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.801 | L2-Norm(final)=21.867 | 5505.6 samples/s | 86.0 steps/s
[Step=92350 Epoch=180.5] | Loss=0.01738 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.801 | L2-Norm(final)=21.868 | 5566.5 samples/s | 87.0 steps/s
[Step=92400 Epoch=180.6] | Loss=0.01732 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.801 | L2-Norm(final)=21.869 | 5466.9 samples/s | 85.4 steps/s
[Step=92450 Epoch=180.7] | Loss=0.01692 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.801 | L2-Norm(final)=21.870 | 5529.7 samples/s | 86.4 steps/s
[Step=92500 Epoch=180.8] | Loss=0.01684 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.801 | L2-Norm(final)=21.871 | 7010.6 samples/s | 109.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=92501 Epoch=180.8] | Loss=0.00782 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.801 | L2-Norm(final)=21.889 | 4490.9 samples/s | 70.2 steps/s
[Step=92550 Epoch=180.9] | Loss=0.01682 | Reg=0.00061 | acc=0.9688 | L2-Norm=7.811 | L2-Norm(final)=21.893 | 4672.8 samples/s | 73.0 steps/s
[Step=92600 Epoch=181.0] | Loss=0.01623 | Reg=0.00061 | acc=0.9531 | L2-Norm=7.822 | L2-Norm(final)=21.897 | 4762.9 samples/s | 74.4 steps/s
[Step=92650 Epoch=181.1] | Loss=0.01492 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.832 | L2-Norm(final)=21.901 | 4839.7 samples/s | 75.6 steps/s
[Step=92700 Epoch=181.2] | Loss=0.01417 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.841 | L2-Norm(final)=21.904 | 4774.0 samples/s | 74.6 steps/s
[Step=92750 Epoch=181.3] | Loss=0.01369 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.848 | L2-Norm(final)=21.908 | 4728.8 samples/s | 73.9 steps/s
[Step=92800 Epoch=181.4] | Loss=0.01345 | Reg=0.00062 | acc=0.9531 | L2-Norm=7.856 | L2-Norm(final)=21.912 | 4817.4 samples/s | 75.3 steps/s
[Step=92850 Epoch=181.5] | Loss=0.01347 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.863 | L2-Norm(final)=21.915 | 4805.3 samples/s | 75.1 steps/s
[Step=92900 Epoch=181.6] | Loss=0.01319 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.870 | L2-Norm(final)=21.919 | 4793.4 samples/s | 74.9 steps/s
[Step=92950 Epoch=181.7] | Loss=0.01286 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.876 | L2-Norm(final)=21.922 | 4789.2 samples/s | 74.8 steps/s
[Step=93000 Epoch=181.8] | Loss=0.01260 | Reg=0.00062 | acc=0.9844 | L2-Norm=7.882 | L2-Norm(final)=21.925 | 5910.5 samples/s | 92.4 steps/s
[Step=93050 Epoch=181.9] | Loss=0.01244 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.888 | L2-Norm(final)=21.929 | 2110.4 samples/s | 33.0 steps/s
[Step=93100 Epoch=182.0] | Loss=0.01198 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.894 | L2-Norm(final)=21.932 | 4727.8 samples/s | 73.9 steps/s
[Step=93150 Epoch=182.1] | Loss=0.01155 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.899 | L2-Norm(final)=21.935 | 4697.8 samples/s | 73.4 steps/s
[Step=93200 Epoch=182.2] | Loss=0.01127 | Reg=0.00062 | acc=0.9844 | L2-Norm=7.905 | L2-Norm(final)=21.938 | 4808.7 samples/s | 75.1 steps/s
[Step=93250 Epoch=182.3] | Loss=0.01090 | Reg=0.00063 | acc=0.9688 | L2-Norm=7.910 | L2-Norm(final)=21.942 | 4754.6 samples/s | 74.3 steps/s
[Step=93300 Epoch=182.4] | Loss=0.01072 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.914 | L2-Norm(final)=21.945 | 4800.6 samples/s | 75.0 steps/s
[Step=93350 Epoch=182.5] | Loss=0.01050 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.919 | L2-Norm(final)=21.948 | 4737.3 samples/s | 74.0 steps/s
[Step=93400 Epoch=182.6] | Loss=0.01035 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.923 | L2-Norm(final)=21.951 | 4773.3 samples/s | 74.6 steps/s
[Step=93450 Epoch=182.7] | Loss=0.01023 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.928 | L2-Norm(final)=21.954 | 4818.4 samples/s | 75.3 steps/s
[Step=93500 Epoch=182.8] | Loss=0.01025 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.932 | L2-Norm(final)=21.956 | 5153.3 samples/s | 80.5 steps/s
[Step=93550 Epoch=182.9] | Loss=0.01018 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.936 | L2-Norm(final)=21.959 | 2196.6 samples/s | 34.3 steps/s
[Step=93600 Epoch=183.0] | Loss=0.00999 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.940 | L2-Norm(final)=21.962 | 4826.5 samples/s | 75.4 steps/s
[Step=93650 Epoch=183.1] | Loss=0.00984 | Reg=0.00063 | acc=0.9688 | L2-Norm=7.944 | L2-Norm(final)=21.965 | 4748.3 samples/s | 74.2 steps/s
[Step=93700 Epoch=183.2] | Loss=0.00971 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.948 | L2-Norm(final)=21.967 | 4711.8 samples/s | 73.6 steps/s
[Step=93750 Epoch=183.3] | Loss=0.00956 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.951 | L2-Norm(final)=21.970 | 4825.3 samples/s | 75.4 steps/s
[Step=93800 Epoch=183.4] | Loss=0.00942 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.955 | L2-Norm(final)=21.972 | 4780.8 samples/s | 74.7 steps/s
[Step=93850 Epoch=183.5] | Loss=0.00936 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.959 | L2-Norm(final)=21.975 | 4826.9 samples/s | 75.4 steps/s
[Step=93900 Epoch=183.6] | Loss=0.00919 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.962 | L2-Norm(final)=21.977 | 4751.2 samples/s | 74.2 steps/s
[Step=93950 Epoch=183.7] | Loss=0.00915 | Reg=0.00063 | acc=0.9688 | L2-Norm=7.966 | L2-Norm(final)=21.980 | 4749.7 samples/s | 74.2 steps/s
[Step=94000 Epoch=183.8] | Loss=0.00908 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.969 | L2-Norm(final)=21.982 | 4778.9 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step94000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=92001 Epoch=352.5] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.801 | L2-Norm(final)=19.094 | 4413.4 samples/s | 69.0 steps/s
[Step=92050 Epoch=352.7] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.796 | L2-Norm(final)=19.099 | 4963.7 samples/s | 77.6 steps/s
[Step=92100 Epoch=352.9] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.795 | L2-Norm(final)=19.107 | 5254.2 samples/s | 82.1 steps/s
[Step=92150 Epoch=353.1] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.795 | L2-Norm(final)=19.114 | 5303.1 samples/s | 82.9 steps/s
[Step=92200 Epoch=353.3] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.795 | L2-Norm(final)=19.122 | 5071.4 samples/s | 79.2 steps/s
[Step=92250 Epoch=353.5] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.795 | L2-Norm(final)=19.129 | 6812.6 samples/s | 106.4 steps/s
[Step=92300 Epoch=353.7] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.795 | L2-Norm(final)=19.135 | 2137.2 samples/s | 33.4 steps/s
[Step=92350 Epoch=353.9] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.795 | L2-Norm(final)=19.141 | 5312.4 samples/s | 83.0 steps/s
[Step=92400 Epoch=354.0] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.795 | L2-Norm(final)=19.148 | 5113.5 samples/s | 79.9 steps/s
[Step=92450 Epoch=354.2] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.795 | L2-Norm(final)=19.154 | 5168.3 samples/s | 80.8 steps/s
[Step=92500 Epoch=354.4] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.795 | L2-Norm(final)=19.160 | 5852.1 samples/s | 91.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=92501 Epoch=354.4] | Loss=0.00000 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.795 | L2-Norm(final)=19.223 | 4488.3 samples/s | 70.1 steps/s
[Step=92550 Epoch=354.6] | Loss=0.00002 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.782 | L2-Norm(final)=19.229 | 4293.9 samples/s | 67.1 steps/s
[Step=92600 Epoch=354.8] | Loss=0.00002 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.773 | L2-Norm(final)=19.233 | 4585.5 samples/s | 71.6 steps/s
[Step=92650 Epoch=355.0] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.765 | L2-Norm(final)=19.237 | 4549.1 samples/s | 71.1 steps/s
[Step=92700 Epoch=355.2] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.754 | L2-Norm(final)=19.240 | 4531.9 samples/s | 70.8 steps/s
[Step=92750 Epoch=355.4] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.743 | L2-Norm(final)=19.241 | 5665.6 samples/s | 88.5 steps/s
[Step=92800 Epoch=355.6] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.732 | L2-Norm(final)=19.243 | 2003.2 samples/s | 31.3 steps/s
[Step=92850 Epoch=355.8] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.721 | L2-Norm(final)=19.245 | 4524.1 samples/s | 70.7 steps/s
[Step=92900 Epoch=356.0] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.709 | L2-Norm(final)=19.246 | 4511.0 samples/s | 70.5 steps/s
[Step=92950 Epoch=356.2] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.698 | L2-Norm(final)=19.247 | 4518.3 samples/s | 70.6 steps/s
[Step=93000 Epoch=356.3] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.686 | L2-Norm(final)=19.248 | 5019.6 samples/s | 78.4 steps/s
[Step=93050 Epoch=356.5] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.674 | L2-Norm(final)=19.249 | 2096.8 samples/s | 32.8 steps/s
[Step=93100 Epoch=356.7] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.663 | L2-Norm(final)=19.250 | 4604.9 samples/s | 72.0 steps/s
[Step=93150 Epoch=356.9] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.651 | L2-Norm(final)=19.251 | 4536.8 samples/s | 70.9 steps/s
[Step=93200 Epoch=357.1] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.639 | L2-Norm(final)=19.252 | 4507.0 samples/s | 70.4 steps/s
[Step=93250 Epoch=357.3] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.627 | L2-Norm(final)=19.253 | 4522.3 samples/s | 70.7 steps/s
[Step=93300 Epoch=357.5] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.615 | L2-Norm(final)=19.254 | 2183.2 samples/s | 34.1 steps/s
[Step=93350 Epoch=357.7] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.602 | L2-Norm(final)=19.255 | 4638.3 samples/s | 72.5 steps/s
[Step=93400 Epoch=357.9] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.590 | L2-Norm(final)=19.256 | 4507.0 samples/s | 70.4 steps/s
[Step=93450 Epoch=358.1] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.578 | L2-Norm(final)=19.257 | 4521.1 samples/s | 70.6 steps/s
[Step=93500 Epoch=358.3] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.565 | L2-Norm(final)=19.258 | 4553.3 samples/s | 71.1 steps/s
[Step=93550 Epoch=358.5] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.553 | L2-Norm(final)=19.259 | 2208.7 samples/s | 34.5 steps/s
[Step=93600 Epoch=358.6] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.540 | L2-Norm(final)=19.260 | 4520.7 samples/s | 70.6 steps/s
[Step=93650 Epoch=358.8] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.528 | L2-Norm(final)=19.261 | 4532.9 samples/s | 70.8 steps/s
[Step=93700 Epoch=359.0] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.515 | L2-Norm(final)=19.263 | 4558.1 samples/s | 71.2 steps/s
[Step=93750 Epoch=359.2] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.502 | L2-Norm(final)=19.264 | 4578.3 samples/s | 71.5 steps/s
[Step=93800 Epoch=359.4] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.489 | L2-Norm(final)=19.265 | 6150.5 samples/s | 96.1 steps/s
[Step=93850 Epoch=359.6] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.476 | L2-Norm(final)=19.266 | 1941.2 samples/s | 30.3 steps/s
[Step=93900 Epoch=359.8] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.463 | L2-Norm(final)=19.268 | 4517.5 samples/s | 70.6 steps/s
[Step=93950 Epoch=360.0] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.450 | L2-Norm(final)=19.269 | 4540.3 samples/s | 70.9 steps/s
[Step=94000 Epoch=360.2] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.437 | L2-Norm(final)=19.270 | 4581.3 samples/s | 71.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step94000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=92001 Epoch=354.1] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.801 | L2-Norm(final)=19.623 | 4514.8 samples/s | 70.5 steps/s
[Step=92050 Epoch=354.3] | Loss=0.00005 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.799 | L2-Norm(final)=19.626 | 4594.2 samples/s | 71.8 steps/s
[Step=92100 Epoch=354.5] | Loss=0.00005 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.799 | L2-Norm(final)=19.631 | 5230.1 samples/s | 81.7 steps/s
[Step=92150 Epoch=354.7] | Loss=0.00005 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.799 | L2-Norm(final)=19.635 | 5181.2 samples/s | 81.0 steps/s
[Step=92200 Epoch=354.9] | Loss=0.00005 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.799 | L2-Norm(final)=19.641 | 5196.6 samples/s | 81.2 steps/s
[Step=92250 Epoch=355.1] | Loss=0.00005 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.799 | L2-Norm(final)=19.646 | 7009.4 samples/s | 109.5 steps/s
[Step=92300 Epoch=355.3] | Loss=0.00006 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.799 | L2-Norm(final)=19.651 | 2129.9 samples/s | 33.3 steps/s
[Step=92350 Epoch=355.5] | Loss=0.00006 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.799 | L2-Norm(final)=19.657 | 5104.4 samples/s | 79.8 steps/s
[Step=92400 Epoch=355.7] | Loss=0.00005 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.799 | L2-Norm(final)=19.662 | 5230.0 samples/s | 81.7 steps/s
[Step=92450 Epoch=355.9] | Loss=0.00005 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.799 | L2-Norm(final)=19.667 | 5196.6 samples/s | 81.2 steps/s
[Step=92500 Epoch=356.1] | Loss=0.00005 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.799 | L2-Norm(final)=19.672 | 6048.3 samples/s | 94.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=92501 Epoch=356.1] | Loss=0.00006 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.799 | L2-Norm(final)=19.720 | 4570.5 samples/s | 71.4 steps/s
[Step=92550 Epoch=356.3] | Loss=0.00015 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.799 | L2-Norm(final)=19.724 | 4358.2 samples/s | 68.1 steps/s
[Step=92600 Epoch=356.5] | Loss=0.00015 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.807 | L2-Norm(final)=19.726 | 4550.0 samples/s | 71.1 steps/s
[Step=92650 Epoch=356.6] | Loss=0.00011 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.811 | L2-Norm(final)=19.728 | 4592.8 samples/s | 71.8 steps/s
[Step=92700 Epoch=356.8] | Loss=0.00009 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.813 | L2-Norm(final)=19.729 | 4508.2 samples/s | 70.4 steps/s
[Step=92750 Epoch=357.0] | Loss=0.00008 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.813 | L2-Norm(final)=19.730 | 5793.2 samples/s | 90.5 steps/s
[Step=92800 Epoch=357.2] | Loss=0.00007 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.813 | L2-Norm(final)=19.731 | 1986.9 samples/s | 31.0 steps/s
[Step=92850 Epoch=357.4] | Loss=0.00006 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.812 | L2-Norm(final)=19.731 | 4623.3 samples/s | 72.2 steps/s
[Step=92900 Epoch=357.6] | Loss=0.00005 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.812 | L2-Norm(final)=19.732 | 4511.4 samples/s | 70.5 steps/s
[Step=92950 Epoch=357.8] | Loss=0.00005 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.811 | L2-Norm(final)=19.733 | 4531.5 samples/s | 70.8 steps/s
[Step=93000 Epoch=358.0] | Loss=0.00004 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.809 | L2-Norm(final)=19.733 | 5140.9 samples/s | 80.3 steps/s
[Step=93050 Epoch=358.2] | Loss=0.00004 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.808 | L2-Norm(final)=19.733 | 2076.9 samples/s | 32.5 steps/s
[Step=93100 Epoch=358.4] | Loss=0.00004 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.807 | L2-Norm(final)=19.734 | 4646.2 samples/s | 72.6 steps/s
[Step=93150 Epoch=358.6] | Loss=0.00003 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.805 | L2-Norm(final)=19.734 | 4458.4 samples/s | 69.7 steps/s
[Step=93200 Epoch=358.8] | Loss=0.00003 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.804 | L2-Norm(final)=19.735 | 4625.5 samples/s | 72.3 steps/s
[Step=93250 Epoch=359.0] | Loss=0.00003 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.802 | L2-Norm(final)=19.735 | 4601.4 samples/s | 71.9 steps/s
[Step=93300 Epoch=359.1] | Loss=0.00003 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.801 | L2-Norm(final)=19.735 | 2188.0 samples/s | 34.2 steps/s
[Step=93350 Epoch=359.3] | Loss=0.00003 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.799 | L2-Norm(final)=19.735 | 4544.3 samples/s | 71.0 steps/s
[Step=93400 Epoch=359.5] | Loss=0.00002 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.798 | L2-Norm(final)=19.736 | 4542.7 samples/s | 71.0 steps/s
[Step=93450 Epoch=359.7] | Loss=0.00002 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.796 | L2-Norm(final)=19.736 | 4525.1 samples/s | 70.7 steps/s
[Step=93500 Epoch=359.9] | Loss=0.00002 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.794 | L2-Norm(final)=19.736 | 4616.0 samples/s | 72.1 steps/s
[Step=93550 Epoch=360.1] | Loss=0.00002 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.792 | L2-Norm(final)=19.737 | 2190.5 samples/s | 34.2 steps/s
[Step=93600 Epoch=360.3] | Loss=0.00002 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.791 | L2-Norm(final)=19.737 | 4639.7 samples/s | 72.5 steps/s
[Step=93650 Epoch=360.5] | Loss=0.00002 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.789 | L2-Norm(final)=19.737 | 4524.5 samples/s | 70.7 steps/s
[Step=93700 Epoch=360.7] | Loss=0.00002 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.787 | L2-Norm(final)=19.738 | 4582.8 samples/s | 71.6 steps/s
[Step=93750 Epoch=360.9] | Loss=0.00002 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.785 | L2-Norm(final)=19.738 | 4567.8 samples/s | 71.4 steps/s
[Step=93800 Epoch=361.1] | Loss=0.00002 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.783 | L2-Norm(final)=19.738 | 6449.0 samples/s | 100.8 steps/s
[Step=93850 Epoch=361.3] | Loss=0.00002 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.781 | L2-Norm(final)=19.738 | 1907.9 samples/s | 29.8 steps/s
[Step=93900 Epoch=361.5] | Loss=0.00002 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.779 | L2-Norm(final)=19.739 | 4574.3 samples/s | 71.5 steps/s
[Step=93950 Epoch=361.7] | Loss=0.00002 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.777 | L2-Norm(final)=19.739 | 4488.4 samples/s | 70.1 steps/s
[Step=94000 Epoch=361.8] | Loss=0.00002 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.775 | L2-Norm(final)=19.739 | 4541.0 samples/s | 71.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step94000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06563 | acc=0.9673 | tpr=0.9772 | fpr=0.0540 | 4077.1 samples/s | 15.9 steps/s
Avg test loss: 0.06590, Avg test acc: 0.96759, Avg tpr: 0.97756, Avg fpr: 0.05435, total FA: 424

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06399 | acc=0.9688 | tpr=0.9782 | fpr=0.0515 | 4184.2 samples/s | 16.3 steps/s
Avg test loss: 0.06515, Avg test acc: 0.96875, Avg tpr: 0.97890, Avg fpr: 0.05358, total FA: 418

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.24281 | acc=0.3109 | tpr=0.0030 | fpr=0.0203 | 4137.4 samples/s | 16.2 steps/s
Avg test loss: 6.25595, Avg test acc: 0.30804, Avg tpr: 0.00274, Avg fpr: 0.02051, total FA: 160

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.98015 | acc=0.3013 | tpr=0.0076 | fpr=0.0612 | 4188.4 samples/s | 16.4 steps/s
Avg test loss: 5.99441, Avg test acc: 0.29730, Avg tpr: 0.00740, Avg fpr: 0.06512, total FA: 508

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.84340 | acc=0.1137 | tpr=0.3761 | fpr=0.8910 | 4099.5 samples/s | 16.0 steps/s
[Step= 100] | Loss=4.80191 | acc=0.1137 | tpr=0.3561 | fpr=0.8908 | 7948.4 samples/s | 31.0 steps/s
[Step= 150] | Loss=4.80371 | acc=0.1126 | tpr=0.3573 | fpr=0.8919 | 7779.1 samples/s | 30.4 steps/s
[Step= 200] | Loss=4.80116 | acc=0.1131 | tpr=0.3552 | fpr=0.8913 | 7620.9 samples/s | 29.8 steps/s
[Step= 250] | Loss=4.80057 | acc=0.1130 | tpr=0.3485 | fpr=0.8913 | 8163.6 samples/s | 31.9 steps/s
[Step= 300] | Loss=4.80527 | acc=0.1124 | tpr=0.3418 | fpr=0.8918 | 7879.6 samples/s | 30.8 steps/s
[Step= 350] | Loss=4.81350 | acc=0.1120 | tpr=0.3338 | fpr=0.8920 | 7762.2 samples/s | 30.3 steps/s
[Step= 400] | Loss=4.80844 | acc=0.1117 | tpr=0.3271 | fpr=0.8922 | 7855.7 samples/s | 30.7 steps/s
[Step= 450] | Loss=4.80942 | acc=0.1111 | tpr=0.3267 | fpr=0.8928 | 7961.2 samples/s | 31.1 steps/s
[Step= 500] | Loss=4.81015 | acc=0.1110 | tpr=0.3291 | fpr=0.8930 | 7586.8 samples/s | 29.6 steps/s
[Step= 550] | Loss=4.81146 | acc=0.1109 | tpr=0.3267 | fpr=0.8930 | 14389.6 samples/s | 56.2 steps/s
Avg test loss: 4.81183, Avg test acc: 0.11079, Avg tpr: 0.32647, Avg fpr: 0.89313, total FA: 124010

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.89133 | acc=0.1218 | tpr=0.3673 | fpr=0.8826 | 4166.2 samples/s | 16.3 steps/s
[Step= 100] | Loss=4.85099 | acc=0.1221 | tpr=0.3475 | fpr=0.8821 | 7944.8 samples/s | 31.0 steps/s
[Step= 150] | Loss=4.85339 | acc=0.1219 | tpr=0.3501 | fpr=0.8823 | 7742.7 samples/s | 30.2 steps/s
[Step= 200] | Loss=4.85155 | acc=0.1220 | tpr=0.3497 | fpr=0.8822 | 8087.7 samples/s | 31.6 steps/s
[Step= 250] | Loss=4.85179 | acc=0.1218 | tpr=0.3424 | fpr=0.8822 | 8070.5 samples/s | 31.5 steps/s
[Step= 300] | Loss=4.85443 | acc=0.1212 | tpr=0.3411 | fpr=0.8828 | 7820.8 samples/s | 30.5 steps/s
[Step= 350] | Loss=4.86249 | acc=0.1206 | tpr=0.3325 | fpr=0.8832 | 7661.1 samples/s | 29.9 steps/s
[Step= 400] | Loss=4.85658 | acc=0.1201 | tpr=0.3293 | fpr=0.8837 | 7835.9 samples/s | 30.6 steps/s
[Step= 450] | Loss=4.85769 | acc=0.1195 | tpr=0.3281 | fpr=0.8843 | 7959.2 samples/s | 31.1 steps/s
[Step= 500] | Loss=4.85738 | acc=0.1192 | tpr=0.3308 | fpr=0.8846 | 7805.3 samples/s | 30.5 steps/s
[Step= 550] | Loss=4.85906 | acc=0.1194 | tpr=0.3303 | fpr=0.8844 | 14987.7 samples/s | 58.5 steps/s
Avg test loss: 4.85941, Avg test acc: 0.11931, Avg tpr: 0.32964, Avg fpr: 0.88451, total FA: 122813

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10277 | acc=0.9809 | tpr=0.9425 | fpr=0.0185 | 4231.6 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.10816 | acc=0.9801 | tpr=0.9552 | fpr=0.0194 | 7360.1 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.11035 | acc=0.9795 | tpr=0.9553 | fpr=0.0201 | 7980.6 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.11178 | acc=0.9797 | tpr=0.9574 | fpr=0.0199 | 7989.6 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.11177 | acc=0.9794 | tpr=0.9563 | fpr=0.0202 | 7901.0 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.11352 | acc=0.9791 | tpr=0.9571 | fpr=0.0205 | 7857.2 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.11351 | acc=0.9790 | tpr=0.9574 | fpr=0.0206 | 7719.9 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.11430 | acc=0.9788 | tpr=0.9540 | fpr=0.0208 | 7976.0 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.11589 | acc=0.9784 | tpr=0.9523 | fpr=0.0211 | 7766.6 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.11514 | acc=0.9786 | tpr=0.9537 | fpr=0.0210 | 7819.1 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.11448 | acc=0.9788 | tpr=0.9550 | fpr=0.0208 | 14262.6 samples/s | 55.7 steps/s
Avg test loss: 0.11420, Avg test acc: 0.97884, Avg tpr: 0.95523, Avg fpr: 0.02073, total FA: 2878

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13177 | acc=0.9778 | tpr=0.9425 | fpr=0.0216 | 4161.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.13977 | acc=0.9772 | tpr=0.9638 | fpr=0.0225 | 7709.6 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.14278 | acc=0.9767 | tpr=0.9654 | fpr=0.0230 | 7972.9 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.14396 | acc=0.9770 | tpr=0.9694 | fpr=0.0229 | 7861.7 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.14404 | acc=0.9766 | tpr=0.9668 | fpr=0.0232 | 7698.9 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.14629 | acc=0.9763 | tpr=0.9665 | fpr=0.0235 | 7940.6 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.14640 | acc=0.9762 | tpr=0.9656 | fpr=0.0236 | 7970.1 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.14757 | acc=0.9759 | tpr=0.9644 | fpr=0.0239 | 7838.0 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.14970 | acc=0.9757 | tpr=0.9611 | fpr=0.0241 | 7741.4 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.14881 | acc=0.9757 | tpr=0.9626 | fpr=0.0240 | 7738.1 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.14792 | acc=0.9760 | tpr=0.9634 | fpr=0.0238 | 14635.9 samples/s | 57.2 steps/s
Avg test loss: 0.14755, Avg test acc: 0.97601, Avg tpr: 0.96355, Avg fpr: 0.02376, total FA: 3299

server round 47/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=94001 Epoch=183.3] | Loss=0.02418 | Reg=0.00059 | acc=0.9844 | L2-Norm=7.680 | L2-Norm(final)=21.948 | 4286.3 samples/s | 67.0 steps/s
[Step=94050 Epoch=183.4] | Loss=0.01539 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.681 | L2-Norm(final)=21.955 | 5255.7 samples/s | 82.1 steps/s
[Step=94100 Epoch=183.5] | Loss=0.01684 | Reg=0.00059 | acc=0.9844 | L2-Norm=7.681 | L2-Norm(final)=21.964 | 5460.2 samples/s | 85.3 steps/s
[Step=94150 Epoch=183.6] | Loss=0.01791 | Reg=0.00059 | acc=0.9844 | L2-Norm=7.681 | L2-Norm(final)=21.973 | 5522.5 samples/s | 86.3 steps/s
[Step=94200 Epoch=183.7] | Loss=0.01850 | Reg=0.00059 | acc=0.9844 | L2-Norm=7.681 | L2-Norm(final)=21.980 | 5533.4 samples/s | 86.5 steps/s
[Step=94250 Epoch=183.8] | Loss=0.01898 | Reg=0.00059 | acc=0.9688 | L2-Norm=7.681 | L2-Norm(final)=21.987 | 5533.1 samples/s | 86.5 steps/s
[Step=94300 Epoch=183.9] | Loss=0.01877 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.681 | L2-Norm(final)=21.994 | 5550.4 samples/s | 86.7 steps/s
[Step=94350 Epoch=184.0] | Loss=0.01845 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.681 | L2-Norm(final)=22.000 | 5563.2 samples/s | 86.9 steps/s
[Step=94400 Epoch=184.1] | Loss=0.01810 | Reg=0.00059 | acc=0.9844 | L2-Norm=7.681 | L2-Norm(final)=22.006 | 5503.0 samples/s | 86.0 steps/s
[Step=94450 Epoch=184.2] | Loss=0.01822 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.681 | L2-Norm(final)=22.012 | 5506.2 samples/s | 86.0 steps/s
[Step=94500 Epoch=184.3] | Loss=0.01816 | Reg=0.00059 | acc=0.9844 | L2-Norm=7.681 | L2-Norm(final)=22.018 | 6963.6 samples/s | 108.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=94501 Epoch=184.3] | Loss=0.01396 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.681 | L2-Norm(final)=22.078 | 4313.9 samples/s | 67.4 steps/s
[Step=94550 Epoch=184.4] | Loss=0.01606 | Reg=0.00059 | acc=0.9844 | L2-Norm=7.690 | L2-Norm(final)=22.083 | 4475.7 samples/s | 69.9 steps/s
[Step=94600 Epoch=184.5] | Loss=0.01599 | Reg=0.00059 | acc=0.9688 | L2-Norm=7.700 | L2-Norm(final)=22.087 | 4814.7 samples/s | 75.2 steps/s
[Step=94650 Epoch=184.6] | Loss=0.01575 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.709 | L2-Norm(final)=22.091 | 4776.2 samples/s | 74.6 steps/s
[Step=94700 Epoch=184.7] | Loss=0.01481 | Reg=0.00060 | acc=0.9688 | L2-Norm=7.718 | L2-Norm(final)=22.095 | 4739.0 samples/s | 74.0 steps/s
[Step=94750 Epoch=184.8] | Loss=0.01462 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.726 | L2-Norm(final)=22.099 | 4795.3 samples/s | 74.9 steps/s
[Step=94800 Epoch=184.9] | Loss=0.01450 | Reg=0.00060 | acc=0.9844 | L2-Norm=7.734 | L2-Norm(final)=22.102 | 4797.1 samples/s | 75.0 steps/s
[Step=94850 Epoch=185.0] | Loss=0.01430 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.741 | L2-Norm(final)=22.106 | 4778.4 samples/s | 74.7 steps/s
[Step=94900 Epoch=185.1] | Loss=0.01379 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.748 | L2-Norm(final)=22.110 | 4790.0 samples/s | 74.8 steps/s
[Step=94950 Epoch=185.2] | Loss=0.01357 | Reg=0.00060 | acc=0.9844 | L2-Norm=7.754 | L2-Norm(final)=22.113 | 4783.3 samples/s | 74.7 steps/s
[Step=95000 Epoch=185.3] | Loss=0.01329 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.761 | L2-Norm(final)=22.117 | 5854.9 samples/s | 91.5 steps/s
[Step=95050 Epoch=185.4] | Loss=0.01278 | Reg=0.00060 | acc=0.9844 | L2-Norm=7.767 | L2-Norm(final)=22.120 | 1997.7 samples/s | 31.2 steps/s
[Step=95100 Epoch=185.5] | Loss=0.01238 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.772 | L2-Norm(final)=22.123 | 4766.9 samples/s | 74.5 steps/s
[Step=95150 Epoch=185.6] | Loss=0.01203 | Reg=0.00060 | acc=0.9844 | L2-Norm=7.778 | L2-Norm(final)=22.126 | 4793.2 samples/s | 74.9 steps/s
[Step=95200 Epoch=185.7] | Loss=0.01176 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.783 | L2-Norm(final)=22.130 | 4812.2 samples/s | 75.2 steps/s
[Step=95250 Epoch=185.8] | Loss=0.01145 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.788 | L2-Norm(final)=22.133 | 4783.4 samples/s | 74.7 steps/s
[Step=95300 Epoch=185.9] | Loss=0.01128 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.793 | L2-Norm(final)=22.136 | 4680.5 samples/s | 73.1 steps/s
[Step=95350 Epoch=186.0] | Loss=0.01118 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.798 | L2-Norm(final)=22.139 | 4808.1 samples/s | 75.1 steps/s
[Step=95400 Epoch=186.1] | Loss=0.01098 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.802 | L2-Norm(final)=22.142 | 4802.2 samples/s | 75.0 steps/s
[Step=95450 Epoch=186.2] | Loss=0.01080 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.807 | L2-Norm(final)=22.145 | 4796.5 samples/s | 74.9 steps/s
[Step=95500 Epoch=186.3] | Loss=0.01078 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.811 | L2-Norm(final)=22.148 | 5088.4 samples/s | 79.5 steps/s
[Step=95550 Epoch=186.4] | Loss=0.01065 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.815 | L2-Norm(final)=22.151 | 2090.8 samples/s | 32.7 steps/s
[Step=95600 Epoch=186.5] | Loss=0.01044 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.819 | L2-Norm(final)=22.154 | 4880.5 samples/s | 76.3 steps/s
[Step=95650 Epoch=186.6] | Loss=0.01023 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.823 | L2-Norm(final)=22.156 | 4734.4 samples/s | 74.0 steps/s
[Step=95700 Epoch=186.7] | Loss=0.01002 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.827 | L2-Norm(final)=22.159 | 4819.5 samples/s | 75.3 steps/s
[Step=95750 Epoch=186.7] | Loss=0.00989 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.831 | L2-Norm(final)=22.162 | 4813.4 samples/s | 75.2 steps/s
[Step=95800 Epoch=186.8] | Loss=0.00981 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.835 | L2-Norm(final)=22.165 | 4825.6 samples/s | 75.4 steps/s
[Step=95850 Epoch=186.9] | Loss=0.00970 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.839 | L2-Norm(final)=22.167 | 4773.7 samples/s | 74.6 steps/s
[Step=95900 Epoch=187.0] | Loss=0.00961 | Reg=0.00062 | acc=0.9844 | L2-Norm=7.843 | L2-Norm(final)=22.170 | 4776.9 samples/s | 74.6 steps/s
[Step=95950 Epoch=187.1] | Loss=0.00958 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.846 | L2-Norm(final)=22.173 | 4767.8 samples/s | 74.5 steps/s
[Step=96000 Epoch=187.2] | Loss=0.00957 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.850 | L2-Norm(final)=22.175 | 4819.0 samples/s | 75.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step96000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=94001 Epoch=183.8] | Loss=0.01310 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.680 | L2-Norm(final)=22.054 | 4567.7 samples/s | 71.4 steps/s
[Step=94050 Epoch=183.9] | Loss=0.01622 | Reg=0.00059 | acc=0.9375 | L2-Norm=7.681 | L2-Norm(final)=22.060 | 5368.7 samples/s | 83.9 steps/s
[Step=94100 Epoch=184.0] | Loss=0.01572 | Reg=0.00059 | acc=0.9844 | L2-Norm=7.681 | L2-Norm(final)=22.068 | 5520.6 samples/s | 86.3 steps/s
[Step=94150 Epoch=184.1] | Loss=0.01595 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.681 | L2-Norm(final)=22.073 | 5542.7 samples/s | 86.6 steps/s
[Step=94200 Epoch=184.2] | Loss=0.01612 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.681 | L2-Norm(final)=22.079 | 5460.3 samples/s | 85.3 steps/s
[Step=94250 Epoch=184.3] | Loss=0.01604 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.681 | L2-Norm(final)=22.084 | 5523.0 samples/s | 86.3 steps/s
[Step=94300 Epoch=184.4] | Loss=0.01614 | Reg=0.00059 | acc=0.9844 | L2-Norm=7.681 | L2-Norm(final)=22.089 | 5584.9 samples/s | 87.3 steps/s
[Step=94350 Epoch=184.5] | Loss=0.01607 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.681 | L2-Norm(final)=22.094 | 5530.4 samples/s | 86.4 steps/s
[Step=94400 Epoch=184.5] | Loss=0.01589 | Reg=0.00059 | acc=0.9688 | L2-Norm=7.681 | L2-Norm(final)=22.099 | 5582.7 samples/s | 87.2 steps/s
[Step=94450 Epoch=184.6] | Loss=0.01603 | Reg=0.00059 | acc=0.9844 | L2-Norm=7.681 | L2-Norm(final)=22.105 | 5465.6 samples/s | 85.4 steps/s
[Step=94500 Epoch=184.7] | Loss=0.01618 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.681 | L2-Norm(final)=22.110 | 7131.7 samples/s | 111.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=94501 Epoch=184.7] | Loss=0.00667 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.681 | L2-Norm(final)=22.162 | 4459.1 samples/s | 69.7 steps/s
[Step=94550 Epoch=184.8] | Loss=0.01542 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.689 | L2-Norm(final)=22.168 | 4742.9 samples/s | 74.1 steps/s
[Step=94600 Epoch=184.9] | Loss=0.01569 | Reg=0.00059 | acc=0.9688 | L2-Norm=7.700 | L2-Norm(final)=22.172 | 4769.1 samples/s | 74.5 steps/s
[Step=94650 Epoch=185.0] | Loss=0.01505 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.711 | L2-Norm(final)=22.176 | 4804.3 samples/s | 75.1 steps/s
[Step=94700 Epoch=185.1] | Loss=0.01510 | Reg=0.00060 | acc=0.9844 | L2-Norm=7.720 | L2-Norm(final)=22.180 | 4763.2 samples/s | 74.4 steps/s
[Step=94750 Epoch=185.2] | Loss=0.01445 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.728 | L2-Norm(final)=22.184 | 4791.3 samples/s | 74.9 steps/s
[Step=94800 Epoch=185.3] | Loss=0.01437 | Reg=0.00060 | acc=0.9844 | L2-Norm=7.735 | L2-Norm(final)=22.187 | 4787.8 samples/s | 74.8 steps/s
[Step=94850 Epoch=185.4] | Loss=0.01390 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.742 | L2-Norm(final)=22.191 | 4825.2 samples/s | 75.4 steps/s
[Step=94900 Epoch=185.5] | Loss=0.01342 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.749 | L2-Norm(final)=22.194 | 4859.3 samples/s | 75.9 steps/s
[Step=94950 Epoch=185.6] | Loss=0.01296 | Reg=0.00060 | acc=0.9844 | L2-Norm=7.755 | L2-Norm(final)=22.198 | 4706.7 samples/s | 73.5 steps/s
[Step=95000 Epoch=185.7] | Loss=0.01267 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.761 | L2-Norm(final)=22.202 | 5917.5 samples/s | 92.5 steps/s
[Step=95050 Epoch=185.8] | Loss=0.01223 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.767 | L2-Norm(final)=22.205 | 2024.9 samples/s | 31.6 steps/s
[Step=95100 Epoch=185.9] | Loss=0.01174 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.773 | L2-Norm(final)=22.209 | 4785.0 samples/s | 74.8 steps/s
[Step=95150 Epoch=186.0] | Loss=0.01141 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.778 | L2-Norm(final)=22.212 | 4799.0 samples/s | 75.0 steps/s
[Step=95200 Epoch=186.1] | Loss=0.01119 | Reg=0.00061 | acc=0.9688 | L2-Norm=7.783 | L2-Norm(final)=22.216 | 4759.3 samples/s | 74.4 steps/s
[Step=95250 Epoch=186.2] | Loss=0.01100 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.788 | L2-Norm(final)=22.219 | 4706.9 samples/s | 73.5 steps/s
[Step=95300 Epoch=186.3] | Loss=0.01094 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.793 | L2-Norm(final)=22.222 | 4714.2 samples/s | 73.7 steps/s
[Step=95350 Epoch=186.4] | Loss=0.01072 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.798 | L2-Norm(final)=22.226 | 4834.7 samples/s | 75.5 steps/s
[Step=95400 Epoch=186.5] | Loss=0.01057 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.802 | L2-Norm(final)=22.229 | 4732.0 samples/s | 73.9 steps/s
[Step=95450 Epoch=186.6] | Loss=0.01042 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.806 | L2-Norm(final)=22.232 | 4781.1 samples/s | 74.7 steps/s
[Step=95500 Epoch=186.7] | Loss=0.01036 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.811 | L2-Norm(final)=22.235 | 5209.5 samples/s | 81.4 steps/s
[Step=95550 Epoch=186.8] | Loss=0.01021 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.815 | L2-Norm(final)=22.237 | 2190.6 samples/s | 34.2 steps/s
[Step=95600 Epoch=186.9] | Loss=0.01004 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.819 | L2-Norm(final)=22.240 | 4725.6 samples/s | 73.8 steps/s
[Step=95650 Epoch=187.0] | Loss=0.00989 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.823 | L2-Norm(final)=22.243 | 4822.8 samples/s | 75.4 steps/s
[Step=95700 Epoch=187.1] | Loss=0.00974 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.827 | L2-Norm(final)=22.246 | 4702.4 samples/s | 73.5 steps/s
[Step=95750 Epoch=187.2] | Loss=0.00964 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.831 | L2-Norm(final)=22.248 | 4756.2 samples/s | 74.3 steps/s
[Step=95800 Epoch=187.3] | Loss=0.00953 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.834 | L2-Norm(final)=22.251 | 4766.5 samples/s | 74.5 steps/s
[Step=95850 Epoch=187.4] | Loss=0.00941 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.838 | L2-Norm(final)=22.254 | 4841.4 samples/s | 75.6 steps/s
[Step=95900 Epoch=187.5] | Loss=0.00933 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.841 | L2-Norm(final)=22.256 | 4736.7 samples/s | 74.0 steps/s
[Step=95950 Epoch=187.6] | Loss=0.00923 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.845 | L2-Norm(final)=22.259 | 4798.4 samples/s | 75.0 steps/s
[Step=96000 Epoch=187.7] | Loss=0.00912 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.848 | L2-Norm(final)=22.262 | 4777.0 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step96000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=94001 Epoch=360.2] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.680 | L2-Norm(final)=19.313 | 4490.9 samples/s | 70.2 steps/s
[Step=94050 Epoch=360.4] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.675 | L2-Norm(final)=19.319 | 4768.8 samples/s | 74.5 steps/s
[Step=94100 Epoch=360.6] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.675 | L2-Norm(final)=19.326 | 5222.9 samples/s | 81.6 steps/s
[Step=94150 Epoch=360.7] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.675 | L2-Norm(final)=19.332 | 5296.6 samples/s | 82.8 steps/s
[Step=94200 Epoch=360.9] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.675 | L2-Norm(final)=19.339 | 5148.0 samples/s | 80.4 steps/s
[Step=94250 Epoch=361.1] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.675 | L2-Norm(final)=19.346 | 6848.0 samples/s | 107.0 steps/s
[Step=94300 Epoch=361.3] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.675 | L2-Norm(final)=19.354 | 2133.7 samples/s | 33.3 steps/s
[Step=94350 Epoch=361.5] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.674 | L2-Norm(final)=19.361 | 5257.9 samples/s | 82.2 steps/s
[Step=94400 Epoch=361.7] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.674 | L2-Norm(final)=19.369 | 5308.6 samples/s | 82.9 steps/s
[Step=94450 Epoch=361.9] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.674 | L2-Norm(final)=19.376 | 5182.2 samples/s | 81.0 steps/s
[Step=94500 Epoch=362.1] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.674 | L2-Norm(final)=19.384 | 5780.0 samples/s | 90.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=94501 Epoch=362.1] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.674 | L2-Norm(final)=19.456 | 4494.2 samples/s | 70.2 steps/s
[Step=94550 Epoch=362.3] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.652 | L2-Norm(final)=19.461 | 4371.0 samples/s | 68.3 steps/s
[Step=94600 Epoch=362.5] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.626 | L2-Norm(final)=19.466 | 4575.3 samples/s | 71.5 steps/s
[Step=94650 Epoch=362.7] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.601 | L2-Norm(final)=19.469 | 4609.6 samples/s | 72.0 steps/s
[Step=94700 Epoch=362.9] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.576 | L2-Norm(final)=19.471 | 4484.6 samples/s | 70.1 steps/s
[Step=94750 Epoch=363.0] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.552 | L2-Norm(final)=19.474 | 5759.6 samples/s | 90.0 steps/s
[Step=94800 Epoch=363.2] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.528 | L2-Norm(final)=19.476 | 2015.1 samples/s | 31.5 steps/s
[Step=94850 Epoch=363.4] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.504 | L2-Norm(final)=19.478 | 4498.1 samples/s | 70.3 steps/s
[Step=94900 Epoch=363.6] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.480 | L2-Norm(final)=19.480 | 4541.4 samples/s | 71.0 steps/s
[Step=94950 Epoch=363.8] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.457 | L2-Norm(final)=19.482 | 4595.4 samples/s | 71.8 steps/s
[Step=95000 Epoch=364.0] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.433 | L2-Norm(final)=19.484 | 4957.5 samples/s | 77.5 steps/s
[Step=95050 Epoch=364.2] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.410 | L2-Norm(final)=19.486 | 2106.3 samples/s | 32.9 steps/s
[Step=95100 Epoch=364.4] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.387 | L2-Norm(final)=19.488 | 4598.0 samples/s | 71.8 steps/s
[Step=95150 Epoch=364.6] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.364 | L2-Norm(final)=19.490 | 4579.5 samples/s | 71.6 steps/s
[Step=95200 Epoch=364.8] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.341 | L2-Norm(final)=19.492 | 4526.1 samples/s | 70.7 steps/s
[Step=95250 Epoch=365.0] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.318 | L2-Norm(final)=19.494 | 4517.4 samples/s | 70.6 steps/s
[Step=95300 Epoch=365.2] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.295 | L2-Norm(final)=19.496 | 2189.3 samples/s | 34.2 steps/s
[Step=95350 Epoch=365.3] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.272 | L2-Norm(final)=19.498 | 4635.0 samples/s | 72.4 steps/s
[Step=95400 Epoch=365.5] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.249 | L2-Norm(final)=19.500 | 4581.7 samples/s | 71.6 steps/s
[Step=95450 Epoch=365.7] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.226 | L2-Norm(final)=19.503 | 4463.8 samples/s | 69.7 steps/s
[Step=95500 Epoch=365.9] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.204 | L2-Norm(final)=19.505 | 4392.0 samples/s | 68.6 steps/s
[Step=95550 Epoch=366.1] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.181 | L2-Norm(final)=19.508 | 2088.4 samples/s | 32.6 steps/s
[Step=95600 Epoch=366.3] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.159 | L2-Norm(final)=19.510 | 4253.9 samples/s | 66.5 steps/s
[Step=95650 Epoch=366.5] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.136 | L2-Norm(final)=19.513 | 4309.6 samples/s | 67.3 steps/s
[Step=95700 Epoch=366.7] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.114 | L2-Norm(final)=19.516 | 4498.4 samples/s | 70.3 steps/s
[Step=95750 Epoch=366.9] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.092 | L2-Norm(final)=19.518 | 4536.7 samples/s | 70.9 steps/s
[Step=95800 Epoch=367.1] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.070 | L2-Norm(final)=19.521 | 6212.5 samples/s | 97.1 steps/s
[Step=95850 Epoch=367.3] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.048 | L2-Norm(final)=19.525 | 1948.3 samples/s | 30.4 steps/s
[Step=95900 Epoch=367.5] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.027 | L2-Norm(final)=19.528 | 4536.4 samples/s | 70.9 steps/s
[Step=95950 Epoch=367.6] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.005 | L2-Norm(final)=19.531 | 4616.2 samples/s | 72.1 steps/s
[Step=96000 Epoch=367.8] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.984 | L2-Norm(final)=19.534 | 4478.1 samples/s | 70.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step96000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=94001 Epoch=361.8] | Loss=0.00002 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.680 | L2-Norm(final)=19.747 | 4083.8 samples/s | 63.8 steps/s
[Step=94050 Epoch=362.0] | Loss=0.00007 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.679 | L2-Norm(final)=19.749 | 4578.7 samples/s | 71.5 steps/s
[Step=94100 Epoch=362.2] | Loss=0.00006 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.679 | L2-Norm(final)=19.752 | 5147.8 samples/s | 80.4 steps/s
[Step=94150 Epoch=362.4] | Loss=0.00006 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.679 | L2-Norm(final)=19.755 | 5112.0 samples/s | 79.9 steps/s
[Step=94200 Epoch=362.6] | Loss=0.00006 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.679 | L2-Norm(final)=19.758 | 5248.5 samples/s | 82.0 steps/s
[Step=94250 Epoch=362.8] | Loss=0.00006 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.679 | L2-Norm(final)=19.762 | 6874.9 samples/s | 107.4 steps/s
[Step=94300 Epoch=363.0] | Loss=0.00006 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.679 | L2-Norm(final)=19.765 | 2132.7 samples/s | 33.3 steps/s
[Step=94350 Epoch=363.2] | Loss=0.00006 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.679 | L2-Norm(final)=19.768 | 5234.1 samples/s | 81.8 steps/s
[Step=94400 Epoch=363.4] | Loss=0.00006 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.679 | L2-Norm(final)=19.772 | 5273.6 samples/s | 82.4 steps/s
[Step=94450 Epoch=363.6] | Loss=0.00006 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.679 | L2-Norm(final)=19.775 | 5277.6 samples/s | 82.5 steps/s
[Step=94500 Epoch=363.8] | Loss=0.00006 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.679 | L2-Norm(final)=19.779 | 5901.4 samples/s | 92.2 steps/s
All layers training...
LR=0.00006, len=1
[Step=94501 Epoch=363.8] | Loss=0.00006 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.679 | L2-Norm(final)=19.814 | 4454.4 samples/s | 69.6 steps/s
[Step=94550 Epoch=364.0] | Loss=0.00010 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.677 | L2-Norm(final)=19.816 | 4427.6 samples/s | 69.2 steps/s
[Step=94600 Epoch=364.2] | Loss=0.00008 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.679 | L2-Norm(final)=19.818 | 4587.4 samples/s | 71.7 steps/s
[Step=94650 Epoch=364.3] | Loss=0.00006 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.680 | L2-Norm(final)=19.821 | 4543.3 samples/s | 71.0 steps/s
[Step=94700 Epoch=364.5] | Loss=0.00005 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.679 | L2-Norm(final)=19.822 | 4631.8 samples/s | 72.4 steps/s
[Step=94750 Epoch=364.7] | Loss=0.00004 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.678 | L2-Norm(final)=19.824 | 5742.7 samples/s | 89.7 steps/s
[Step=94800 Epoch=364.9] | Loss=0.00003 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.676 | L2-Norm(final)=19.825 | 2003.2 samples/s | 31.3 steps/s
[Step=94850 Epoch=365.1] | Loss=0.00003 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.674 | L2-Norm(final)=19.826 | 4625.8 samples/s | 72.3 steps/s
[Step=94900 Epoch=365.3] | Loss=0.00003 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.672 | L2-Norm(final)=19.826 | 4542.5 samples/s | 71.0 steps/s
[Step=94950 Epoch=365.5] | Loss=0.00002 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.670 | L2-Norm(final)=19.827 | 4514.9 samples/s | 70.5 steps/s
[Step=95000 Epoch=365.7] | Loss=0.00002 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.667 | L2-Norm(final)=19.828 | 5189.9 samples/s | 81.1 steps/s
[Step=95050 Epoch=365.9] | Loss=0.00002 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.664 | L2-Norm(final)=19.829 | 2078.2 samples/s | 32.5 steps/s
[Step=95100 Epoch=366.1] | Loss=0.00002 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.662 | L2-Norm(final)=19.829 | 4616.1 samples/s | 72.1 steps/s
[Step=95150 Epoch=366.3] | Loss=0.00002 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.659 | L2-Norm(final)=19.830 | 4499.4 samples/s | 70.3 steps/s
[Step=95200 Epoch=366.5] | Loss=0.00002 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.656 | L2-Norm(final)=19.830 | 4497.5 samples/s | 70.3 steps/s
[Step=95250 Epoch=366.7] | Loss=0.00002 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.653 | L2-Norm(final)=19.831 | 4631.8 samples/s | 72.4 steps/s
[Step=95300 Epoch=366.8] | Loss=0.00002 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.650 | L2-Norm(final)=19.831 | 2172.0 samples/s | 33.9 steps/s
[Step=95350 Epoch=367.0] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.647 | L2-Norm(final)=19.832 | 4533.1 samples/s | 70.8 steps/s
[Step=95400 Epoch=367.2] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.644 | L2-Norm(final)=19.833 | 4534.1 samples/s | 70.8 steps/s
[Step=95450 Epoch=367.4] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.641 | L2-Norm(final)=19.833 | 4550.0 samples/s | 71.1 steps/s
[Step=95500 Epoch=367.6] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.638 | L2-Norm(final)=19.834 | 4389.8 samples/s | 68.6 steps/s
[Step=95550 Epoch=367.8] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.635 | L2-Norm(final)=19.834 | 2195.2 samples/s | 34.3 steps/s
[Step=95600 Epoch=368.0] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.632 | L2-Norm(final)=19.835 | 4515.3 samples/s | 70.6 steps/s
[Step=95650 Epoch=368.2] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.629 | L2-Norm(final)=19.835 | 4618.4 samples/s | 72.2 steps/s
[Step=95700 Epoch=368.4] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.625 | L2-Norm(final)=19.836 | 4439.2 samples/s | 69.4 steps/s
[Step=95750 Epoch=368.6] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.622 | L2-Norm(final)=19.836 | 4553.5 samples/s | 71.1 steps/s
[Step=95800 Epoch=368.8] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.619 | L2-Norm(final)=19.837 | 6640.9 samples/s | 103.8 steps/s
[Step=95850 Epoch=369.0] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.615 | L2-Norm(final)=19.837 | 1917.9 samples/s | 30.0 steps/s
[Step=95900 Epoch=369.2] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.612 | L2-Norm(final)=19.838 | 4608.5 samples/s | 72.0 steps/s
[Step=95950 Epoch=369.3] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.608 | L2-Norm(final)=19.838 | 4515.6 samples/s | 70.6 steps/s
[Step=96000 Epoch=369.5] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.605 | L2-Norm(final)=19.839 | 4518.6 samples/s | 70.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step96000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06395 | acc=0.9684 | tpr=0.9771 | fpr=0.0503 | 4153.8 samples/s | 16.2 steps/s
Avg test loss: 0.06368, Avg test acc: 0.96807, Avg tpr: 0.97680, Avg fpr: 0.05115, total FA: 399

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06458 | acc=0.9684 | tpr=0.9738 | fpr=0.0431 | 4130.4 samples/s | 16.1 steps/s
Avg test loss: 0.06642, Avg test acc: 0.96827, Avg tpr: 0.97418, Avg fpr: 0.04474, total FA: 349

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.23890 | acc=0.3132 | tpr=0.0013 | fpr=0.0094 | 4157.9 samples/s | 16.2 steps/s
Avg test loss: 6.25178, Avg test acc: 0.31000, Avg tpr: 0.00134, Avg fpr: 0.01115, total FA: 87

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.90100 | acc=0.3033 | tpr=0.0059 | fpr=0.0510 | 4169.4 samples/s | 16.3 steps/s
Avg test loss: 5.91610, Avg test acc: 0.29970, Avg tpr: 0.00565, Avg fpr: 0.05358, total FA: 418

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.68509 | acc=0.1176 | tpr=0.3540 | fpr=0.8867 | 4267.8 samples/s | 16.7 steps/s
[Step= 100] | Loss=4.64353 | acc=0.1180 | tpr=0.3348 | fpr=0.8860 | 7473.6 samples/s | 29.2 steps/s
[Step= 150] | Loss=4.64462 | acc=0.1170 | tpr=0.3357 | fpr=0.8870 | 7841.2 samples/s | 30.6 steps/s
[Step= 200] | Loss=4.64220 | acc=0.1173 | tpr=0.3322 | fpr=0.8866 | 7810.6 samples/s | 30.5 steps/s
[Step= 250] | Loss=4.64060 | acc=0.1172 | tpr=0.3231 | fpr=0.8865 | 8035.8 samples/s | 31.4 steps/s
[Step= 300] | Loss=4.64456 | acc=0.1167 | tpr=0.3164 | fpr=0.8869 | 7804.6 samples/s | 30.5 steps/s
[Step= 350] | Loss=4.65259 | acc=0.1161 | tpr=0.3112 | fpr=0.8874 | 7932.3 samples/s | 31.0 steps/s
[Step= 400] | Loss=4.64757 | acc=0.1157 | tpr=0.3069 | fpr=0.8878 | 7676.2 samples/s | 30.0 steps/s
[Step= 450] | Loss=4.64887 | acc=0.1153 | tpr=0.3082 | fpr=0.8882 | 8337.4 samples/s | 32.6 steps/s
[Step= 500] | Loss=4.64934 | acc=0.1151 | tpr=0.3110 | fpr=0.8884 | 7295.6 samples/s | 28.5 steps/s
[Step= 550] | Loss=4.65056 | acc=0.1152 | tpr=0.3084 | fpr=0.8883 | 14560.3 samples/s | 56.9 steps/s
Avg test loss: 4.65092, Avg test acc: 0.11507, Avg tpr: 0.30864, Avg fpr: 0.88845, total FA: 123359

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.64962 | acc=0.1328 | tpr=0.2832 | fpr=0.8699 | 4186.7 samples/s | 16.4 steps/s
[Step= 100] | Loss=4.61263 | acc=0.1330 | tpr=0.2687 | fpr=0.8696 | 7712.8 samples/s | 30.1 steps/s
[Step= 150] | Loss=4.61365 | acc=0.1331 | tpr=0.2752 | fpr=0.8695 | 7872.3 samples/s | 30.8 steps/s
[Step= 200] | Loss=4.61179 | acc=0.1335 | tpr=0.2743 | fpr=0.8690 | 7918.3 samples/s | 30.9 steps/s
[Step= 250] | Loss=4.61227 | acc=0.1338 | tpr=0.2760 | fpr=0.8688 | 7741.6 samples/s | 30.2 steps/s
[Step= 300] | Loss=4.61425 | acc=0.1331 | tpr=0.2720 | fpr=0.8694 | 7729.6 samples/s | 30.2 steps/s
[Step= 350] | Loss=4.62268 | acc=0.1325 | tpr=0.2649 | fpr=0.8699 | 8156.7 samples/s | 31.9 steps/s
[Step= 400] | Loss=4.61704 | acc=0.1318 | tpr=0.2609 | fpr=0.8706 | 7778.6 samples/s | 30.4 steps/s
[Step= 450] | Loss=4.61797 | acc=0.1311 | tpr=0.2585 | fpr=0.8713 | 7926.9 samples/s | 31.0 steps/s
[Step= 500] | Loss=4.61710 | acc=0.1308 | tpr=0.2608 | fpr=0.8716 | 7729.1 samples/s | 30.2 steps/s
[Step= 550] | Loss=4.61873 | acc=0.1311 | tpr=0.2591 | fpr=0.8713 | 13981.5 samples/s | 54.6 steps/s
Avg test loss: 4.61911, Avg test acc: 0.13097, Avg tpr: 0.25872, Avg fpr: 0.87135, total FA: 120985

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09394 | acc=0.9826 | tpr=0.9292 | fpr=0.0165 | 4138.7 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.09853 | acc=0.9821 | tpr=0.9488 | fpr=0.0172 | 8000.0 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.10049 | acc=0.9815 | tpr=0.9510 | fpr=0.0179 | 7856.6 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.10213 | acc=0.9815 | tpr=0.9541 | fpr=0.0180 | 8024.8 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.10201 | acc=0.9813 | tpr=0.9528 | fpr=0.0182 | 7639.3 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.10342 | acc=0.9811 | tpr=0.9549 | fpr=0.0184 | 8053.5 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.10358 | acc=0.9811 | tpr=0.9562 | fpr=0.0184 | 7768.3 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.10407 | acc=0.9808 | tpr=0.9530 | fpr=0.0187 | 7967.9 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.10574 | acc=0.9805 | tpr=0.9513 | fpr=0.0190 | 7867.4 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.10504 | acc=0.9807 | tpr=0.9529 | fpr=0.0188 | 7869.3 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.10446 | acc=0.9809 | tpr=0.9530 | fpr=0.0186 | 14395.6 samples/s | 56.2 steps/s
Avg test loss: 0.10423, Avg test acc: 0.98092, Avg tpr: 0.95325, Avg fpr: 0.01857, total FA: 2579

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12383 | acc=0.9784 | tpr=0.9425 | fpr=0.0210 | 4188.9 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.13137 | acc=0.9772 | tpr=0.9638 | fpr=0.0226 | 7797.4 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.13345 | acc=0.9768 | tpr=0.9654 | fpr=0.0230 | 7998.4 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.13457 | acc=0.9771 | tpr=0.9683 | fpr=0.0227 | 7666.9 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.13488 | acc=0.9769 | tpr=0.9659 | fpr=0.0229 | 8093.3 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.13715 | acc=0.9766 | tpr=0.9673 | fpr=0.0232 | 7770.3 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.13708 | acc=0.9766 | tpr=0.9662 | fpr=0.0232 | 7737.5 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.13837 | acc=0.9764 | tpr=0.9650 | fpr=0.0234 | 7914.7 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.14033 | acc=0.9761 | tpr=0.9625 | fpr=0.0237 | 7967.1 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.13947 | acc=0.9761 | tpr=0.9639 | fpr=0.0236 | 7706.1 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.13863 | acc=0.9763 | tpr=0.9646 | fpr=0.0235 | 14657.4 samples/s | 57.3 steps/s
Avg test loss: 0.13829, Avg test acc: 0.97637, Avg tpr: 0.96474, Avg fpr: 0.02342, total FA: 3252

server round 48/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=96001 Epoch=187.2] | Loss=0.02146 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.380 | L2-Norm(final)=22.251 | 4355.1 samples/s | 68.0 steps/s
[Step=96050 Epoch=187.3] | Loss=0.02281 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.381 | L2-Norm(final)=22.252 | 5032.0 samples/s | 78.6 steps/s
[Step=96100 Epoch=187.4] | Loss=0.02257 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.381 | L2-Norm(final)=22.253 | 5503.8 samples/s | 86.0 steps/s
[Step=96150 Epoch=187.5] | Loss=0.02317 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.381 | L2-Norm(final)=22.254 | 5570.5 samples/s | 87.0 steps/s
[Step=96200 Epoch=187.6] | Loss=0.02332 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.381 | L2-Norm(final)=22.257 | 5624.5 samples/s | 87.9 steps/s
[Step=96250 Epoch=187.7] | Loss=0.02332 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.381 | L2-Norm(final)=22.259 | 5476.1 samples/s | 85.6 steps/s
[Step=96300 Epoch=187.8] | Loss=0.02361 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.381 | L2-Norm(final)=22.261 | 5559.5 samples/s | 86.9 steps/s
[Step=96350 Epoch=187.9] | Loss=0.02337 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.381 | L2-Norm(final)=22.264 | 5545.5 samples/s | 86.6 steps/s
[Step=96400 Epoch=188.0] | Loss=0.02305 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.381 | L2-Norm(final)=22.266 | 5408.7 samples/s | 84.5 steps/s
[Step=96450 Epoch=188.1] | Loss=0.02266 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.381 | L2-Norm(final)=22.268 | 5640.0 samples/s | 88.1 steps/s
[Step=96500 Epoch=188.2] | Loss=0.02256 | Reg=0.00054 | acc=0.9531 | L2-Norm=7.381 | L2-Norm(final)=22.271 | 6865.4 samples/s | 107.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=96501 Epoch=188.2] | Loss=0.03787 | Reg=0.00054 | acc=0.9531 | L2-Norm=7.381 | L2-Norm(final)=22.298 | 4339.9 samples/s | 67.8 steps/s
[Step=96550 Epoch=188.3] | Loss=0.02128 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.393 | L2-Norm(final)=22.303 | 4628.6 samples/s | 72.3 steps/s
[Step=96600 Epoch=188.4] | Loss=0.01962 | Reg=0.00055 | acc=0.9844 | L2-Norm=7.407 | L2-Norm(final)=22.307 | 4821.0 samples/s | 75.3 steps/s
[Step=96650 Epoch=188.5] | Loss=0.01915 | Reg=0.00055 | acc=0.9688 | L2-Norm=7.418 | L2-Norm(final)=22.311 | 4758.4 samples/s | 74.4 steps/s
[Step=96700 Epoch=188.6] | Loss=0.01857 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.428 | L2-Norm(final)=22.314 | 4712.8 samples/s | 73.6 steps/s
[Step=96750 Epoch=188.7] | Loss=0.01811 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.438 | L2-Norm(final)=22.318 | 4788.2 samples/s | 74.8 steps/s
[Step=96800 Epoch=188.8] | Loss=0.01738 | Reg=0.00055 | acc=0.9688 | L2-Norm=7.446 | L2-Norm(final)=22.322 | 4803.0 samples/s | 75.0 steps/s
[Step=96850 Epoch=188.9] | Loss=0.01729 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.454 | L2-Norm(final)=22.326 | 4797.0 samples/s | 75.0 steps/s
[Step=96900 Epoch=189.0] | Loss=0.01681 | Reg=0.00056 | acc=0.9844 | L2-Norm=7.462 | L2-Norm(final)=22.329 | 4772.9 samples/s | 74.6 steps/s
[Step=96950 Epoch=189.1] | Loss=0.01628 | Reg=0.00056 | acc=0.9688 | L2-Norm=7.470 | L2-Norm(final)=22.333 | 4890.5 samples/s | 76.4 steps/s
[Step=97000 Epoch=189.2] | Loss=0.01590 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.477 | L2-Norm(final)=22.336 | 5775.0 samples/s | 90.2 steps/s
[Step=97050 Epoch=189.3] | Loss=0.01522 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.484 | L2-Norm(final)=22.340 | 2021.9 samples/s | 31.6 steps/s
[Step=97100 Epoch=189.4] | Loss=0.01468 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.491 | L2-Norm(final)=22.343 | 4738.9 samples/s | 74.0 steps/s
[Step=97150 Epoch=189.5] | Loss=0.01428 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.497 | L2-Norm(final)=22.347 | 4784.5 samples/s | 74.8 steps/s
[Step=97200 Epoch=189.6] | Loss=0.01392 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.503 | L2-Norm(final)=22.350 | 4787.2 samples/s | 74.8 steps/s
[Step=97250 Epoch=189.7] | Loss=0.01360 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.509 | L2-Norm(final)=22.353 | 4773.0 samples/s | 74.6 steps/s
[Step=97300 Epoch=189.8] | Loss=0.01342 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.515 | L2-Norm(final)=22.356 | 4816.2 samples/s | 75.3 steps/s
[Step=97350 Epoch=189.9] | Loss=0.01318 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.520 | L2-Norm(final)=22.359 | 4836.1 samples/s | 75.6 steps/s
[Step=97400 Epoch=190.0] | Loss=0.01294 | Reg=0.00057 | acc=0.9688 | L2-Norm=7.526 | L2-Norm(final)=22.363 | 4740.5 samples/s | 74.1 steps/s
[Step=97450 Epoch=190.1] | Loss=0.01277 | Reg=0.00057 | acc=0.9844 | L2-Norm=7.531 | L2-Norm(final)=22.366 | 4831.4 samples/s | 75.5 steps/s
[Step=97500 Epoch=190.2] | Loss=0.01258 | Reg=0.00057 | acc=0.9844 | L2-Norm=7.536 | L2-Norm(final)=22.369 | 5059.2 samples/s | 79.1 steps/s
[Step=97550 Epoch=190.3] | Loss=0.01244 | Reg=0.00057 | acc=0.9844 | L2-Norm=7.541 | L2-Norm(final)=22.372 | 2162.5 samples/s | 33.8 steps/s
[Step=97600 Epoch=190.4] | Loss=0.01226 | Reg=0.00057 | acc=0.9688 | L2-Norm=7.546 | L2-Norm(final)=22.374 | 4795.9 samples/s | 74.9 steps/s
[Step=97650 Epoch=190.5] | Loss=0.01203 | Reg=0.00057 | acc=0.9844 | L2-Norm=7.550 | L2-Norm(final)=22.377 | 4864.3 samples/s | 76.0 steps/s
[Step=97700 Epoch=190.6] | Loss=0.01186 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.555 | L2-Norm(final)=22.380 | 4812.8 samples/s | 75.2 steps/s
[Step=97750 Epoch=190.7] | Loss=0.01175 | Reg=0.00057 | acc=0.9844 | L2-Norm=7.559 | L2-Norm(final)=22.383 | 4751.9 samples/s | 74.2 steps/s
[Step=97800 Epoch=190.7] | Loss=0.01157 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.564 | L2-Norm(final)=22.386 | 4755.7 samples/s | 74.3 steps/s
[Step=97850 Epoch=190.8] | Loss=0.01143 | Reg=0.00057 | acc=0.9844 | L2-Norm=7.568 | L2-Norm(final)=22.389 | 4795.1 samples/s | 74.9 steps/s
[Step=97900 Epoch=190.9] | Loss=0.01128 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.573 | L2-Norm(final)=22.391 | 4825.6 samples/s | 75.4 steps/s
[Step=97950 Epoch=191.0] | Loss=0.01118 | Reg=0.00057 | acc=0.9844 | L2-Norm=7.577 | L2-Norm(final)=22.394 | 4766.2 samples/s | 74.5 steps/s
[Step=98000 Epoch=191.1] | Loss=0.01103 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.581 | L2-Norm(final)=22.397 | 4812.2 samples/s | 75.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step98000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=96001 Epoch=187.7] | Loss=0.00525 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.380 | L2-Norm(final)=22.338 | 4495.2 samples/s | 70.2 steps/s
[Step=96050 Epoch=187.8] | Loss=0.04191 | Reg=0.00054 | acc=0.9531 | L2-Norm=7.381 | L2-Norm(final)=22.329 | 5389.9 samples/s | 84.2 steps/s
[Step=96100 Epoch=187.9] | Loss=0.04124 | Reg=0.00054 | acc=0.9688 | L2-Norm=7.381 | L2-Norm(final)=22.315 | 5589.4 samples/s | 87.3 steps/s
[Step=96150 Epoch=188.0] | Loss=0.03997 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.381 | L2-Norm(final)=22.302 | 5443.6 samples/s | 85.1 steps/s
[Step=96200 Epoch=188.1] | Loss=0.03915 | Reg=0.00054 | acc=0.9531 | L2-Norm=7.381 | L2-Norm(final)=22.291 | 5518.2 samples/s | 86.2 steps/s
[Step=96250 Epoch=188.2] | Loss=0.03697 | Reg=0.00054 | acc=0.9688 | L2-Norm=7.381 | L2-Norm(final)=22.283 | 5525.1 samples/s | 86.3 steps/s
[Step=96300 Epoch=188.3] | Loss=0.03556 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.381 | L2-Norm(final)=22.275 | 5449.1 samples/s | 85.1 steps/s
[Step=96350 Epoch=188.4] | Loss=0.03469 | Reg=0.00054 | acc=0.9688 | L2-Norm=7.381 | L2-Norm(final)=22.269 | 5568.6 samples/s | 87.0 steps/s
[Step=96400 Epoch=188.5] | Loss=0.03393 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.381 | L2-Norm(final)=22.263 | 5490.2 samples/s | 85.8 steps/s
[Step=96450 Epoch=188.6] | Loss=0.03338 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.381 | L2-Norm(final)=22.257 | 5560.8 samples/s | 86.9 steps/s
[Step=96500 Epoch=188.7] | Loss=0.03299 | Reg=0.00054 | acc=0.9688 | L2-Norm=7.381 | L2-Norm(final)=22.252 | 7044.6 samples/s | 110.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=96501 Epoch=188.7] | Loss=0.02102 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.381 | L2-Norm(final)=22.202 | 4681.0 samples/s | 73.1 steps/s
[Step=96550 Epoch=188.8] | Loss=0.02155 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.394 | L2-Norm(final)=22.203 | 4572.9 samples/s | 71.5 steps/s
[Step=96600 Epoch=188.9] | Loss=0.02067 | Reg=0.00055 | acc=0.9844 | L2-Norm=7.409 | L2-Norm(final)=22.205 | 4723.3 samples/s | 73.8 steps/s
[Step=96650 Epoch=188.9] | Loss=0.01935 | Reg=0.00055 | acc=0.9844 | L2-Norm=7.421 | L2-Norm(final)=22.207 | 4787.6 samples/s | 74.8 steps/s
[Step=96700 Epoch=189.0] | Loss=0.01794 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.432 | L2-Norm(final)=22.210 | 4832.5 samples/s | 75.5 steps/s
[Step=96750 Epoch=189.1] | Loss=0.01689 | Reg=0.00055 | acc=0.9844 | L2-Norm=7.442 | L2-Norm(final)=22.212 | 4739.9 samples/s | 74.1 steps/s
[Step=96800 Epoch=189.2] | Loss=0.01649 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.451 | L2-Norm(final)=22.214 | 4804.2 samples/s | 75.1 steps/s
[Step=96850 Epoch=189.3] | Loss=0.01644 | Reg=0.00056 | acc=0.9688 | L2-Norm=7.459 | L2-Norm(final)=22.216 | 4764.0 samples/s | 74.4 steps/s
[Step=96900 Epoch=189.4] | Loss=0.01603 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.467 | L2-Norm(final)=22.218 | 4861.4 samples/s | 76.0 steps/s
[Step=96950 Epoch=189.5] | Loss=0.01549 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.474 | L2-Norm(final)=22.220 | 4746.9 samples/s | 74.2 steps/s
[Step=97000 Epoch=189.6] | Loss=0.01495 | Reg=0.00056 | acc=0.9688 | L2-Norm=7.481 | L2-Norm(final)=22.222 | 5905.7 samples/s | 92.3 steps/s
[Step=97050 Epoch=189.7] | Loss=0.01449 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.488 | L2-Norm(final)=22.224 | 2099.3 samples/s | 32.8 steps/s
[Step=97100 Epoch=189.8] | Loss=0.01408 | Reg=0.00056 | acc=0.9844 | L2-Norm=7.494 | L2-Norm(final)=22.226 | 4741.7 samples/s | 74.1 steps/s
[Step=97150 Epoch=189.9] | Loss=0.01378 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.500 | L2-Norm(final)=22.228 | 4759.6 samples/s | 74.4 steps/s
[Step=97200 Epoch=190.0] | Loss=0.01350 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.506 | L2-Norm(final)=22.230 | 4746.6 samples/s | 74.2 steps/s
[Step=97250 Epoch=190.1] | Loss=0.01319 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.512 | L2-Norm(final)=22.232 | 4723.6 samples/s | 73.8 steps/s
[Step=97300 Epoch=190.2] | Loss=0.01282 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.517 | L2-Norm(final)=22.234 | 4891.3 samples/s | 76.4 steps/s
[Step=97350 Epoch=190.3] | Loss=0.01251 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.523 | L2-Norm(final)=22.236 | 4696.1 samples/s | 73.4 steps/s
[Step=97400 Epoch=190.4] | Loss=0.01230 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.528 | L2-Norm(final)=22.238 | 4745.9 samples/s | 74.2 steps/s
[Step=97450 Epoch=190.5] | Loss=0.01218 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.533 | L2-Norm(final)=22.240 | 4747.2 samples/s | 74.2 steps/s
[Step=97500 Epoch=190.6] | Loss=0.01195 | Reg=0.00057 | acc=0.9844 | L2-Norm=7.538 | L2-Norm(final)=22.242 | 5135.4 samples/s | 80.2 steps/s
[Step=97550 Epoch=190.7] | Loss=0.01168 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.543 | L2-Norm(final)=22.244 | 2173.5 samples/s | 34.0 steps/s
[Step=97600 Epoch=190.8] | Loss=0.01146 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.548 | L2-Norm(final)=22.245 | 4795.9 samples/s | 74.9 steps/s
[Step=97650 Epoch=190.9] | Loss=0.01137 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.553 | L2-Norm(final)=22.247 | 4842.7 samples/s | 75.7 steps/s
[Step=97700 Epoch=191.0] | Loss=0.01127 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.557 | L2-Norm(final)=22.249 | 4662.6 samples/s | 72.9 steps/s
[Step=97750 Epoch=191.1] | Loss=0.01113 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.562 | L2-Norm(final)=22.251 | 4794.8 samples/s | 74.9 steps/s
[Step=97800 Epoch=191.2] | Loss=0.01100 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.566 | L2-Norm(final)=22.253 | 4777.9 samples/s | 74.7 steps/s
[Step=97850 Epoch=191.3] | Loss=0.01090 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.570 | L2-Norm(final)=22.254 | 4809.6 samples/s | 75.1 steps/s
[Step=97900 Epoch=191.4] | Loss=0.01079 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.574 | L2-Norm(final)=22.256 | 4741.9 samples/s | 74.1 steps/s
[Step=97950 Epoch=191.5] | Loss=0.01065 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.579 | L2-Norm(final)=22.258 | 4813.6 samples/s | 75.2 steps/s
[Step=98000 Epoch=191.6] | Loss=0.01047 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.583 | L2-Norm(final)=22.260 | 4741.9 samples/s | 74.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step98000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=96001 Epoch=367.8] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.380 | L2-Norm(final)=19.631 | 4693.1 samples/s | 73.3 steps/s
[Step=96050 Epoch=368.0] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.374 | L2-Norm(final)=19.639 | 4395.3 samples/s | 68.7 steps/s
[Step=96100 Epoch=368.2] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.374 | L2-Norm(final)=19.648 | 4975.7 samples/s | 77.7 steps/s
[Step=96150 Epoch=368.4] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.373 | L2-Norm(final)=19.656 | 4990.8 samples/s | 78.0 steps/s
[Step=96200 Epoch=368.6] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.373 | L2-Norm(final)=19.666 | 4986.1 samples/s | 77.9 steps/s
[Step=96250 Epoch=368.8] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.373 | L2-Norm(final)=19.676 | 6836.9 samples/s | 106.8 steps/s
[Step=96300 Epoch=369.0] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.373 | L2-Norm(final)=19.685 | 2139.5 samples/s | 33.4 steps/s
[Step=96350 Epoch=369.2] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.373 | L2-Norm(final)=19.694 | 5270.1 samples/s | 82.3 steps/s
[Step=96400 Epoch=369.4] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.373 | L2-Norm(final)=19.703 | 5293.1 samples/s | 82.7 steps/s
[Step=96450 Epoch=369.6] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.373 | L2-Norm(final)=19.711 | 5065.9 samples/s | 79.2 steps/s
[Step=96500 Epoch=369.8] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.373 | L2-Norm(final)=19.719 | 5759.3 samples/s | 90.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=96501 Epoch=369.8] | Loss=0.00002 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.373 | L2-Norm(final)=19.801 | 4772.7 samples/s | 74.6 steps/s
[Step=96550 Epoch=369.9] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.356 | L2-Norm(final)=19.810 | 4261.6 samples/s | 66.6 steps/s
[Step=96600 Epoch=370.1] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.339 | L2-Norm(final)=19.814 | 4528.4 samples/s | 70.8 steps/s
[Step=96650 Epoch=370.3] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.320 | L2-Norm(final)=19.817 | 4577.7 samples/s | 71.5 steps/s
[Step=96700 Epoch=370.5] | Loss=0.00001 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.302 | L2-Norm(final)=19.819 | 4487.4 samples/s | 70.1 steps/s
[Step=96750 Epoch=370.7] | Loss=0.00001 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.284 | L2-Norm(final)=19.822 | 5692.3 samples/s | 88.9 steps/s
[Step=96800 Epoch=370.9] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.266 | L2-Norm(final)=19.824 | 2010.3 samples/s | 31.4 steps/s
[Step=96850 Epoch=371.1] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.248 | L2-Norm(final)=19.825 | 4567.6 samples/s | 71.4 steps/s
[Step=96900 Epoch=371.3] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.229 | L2-Norm(final)=19.827 | 4552.4 samples/s | 71.1 steps/s
[Step=96950 Epoch=371.5] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.211 | L2-Norm(final)=19.828 | 4543.7 samples/s | 71.0 steps/s
[Step=97000 Epoch=371.7] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=19.830 | 5010.6 samples/s | 78.3 steps/s
[Step=97050 Epoch=371.9] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.175 | L2-Norm(final)=19.831 | 2128.1 samples/s | 33.3 steps/s
[Step=97100 Epoch=372.1] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.157 | L2-Norm(final)=19.832 | 4563.6 samples/s | 71.3 steps/s
[Step=97150 Epoch=372.2] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.139 | L2-Norm(final)=19.834 | 4547.4 samples/s | 71.1 steps/s
[Step=97200 Epoch=372.4] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.121 | L2-Norm(final)=19.835 | 4528.5 samples/s | 70.8 steps/s
[Step=97250 Epoch=372.6] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.103 | L2-Norm(final)=19.837 | 4573.2 samples/s | 71.5 steps/s
[Step=97300 Epoch=372.8] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.085 | L2-Norm(final)=19.838 | 2191.1 samples/s | 34.2 steps/s
[Step=97350 Epoch=373.0] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.068 | L2-Norm(final)=19.840 | 4670.8 samples/s | 73.0 steps/s
[Step=97400 Epoch=373.2] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.050 | L2-Norm(final)=19.841 | 4529.6 samples/s | 70.8 steps/s
[Step=97450 Epoch=373.4] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.032 | L2-Norm(final)=19.843 | 4543.7 samples/s | 71.0 steps/s
[Step=97500 Epoch=373.6] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.014 | L2-Norm(final)=19.845 | 4586.9 samples/s | 71.7 steps/s
[Step=97550 Epoch=373.8] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.996 | L2-Norm(final)=19.847 | 2177.5 samples/s | 34.0 steps/s
[Step=97600 Epoch=374.0] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.978 | L2-Norm(final)=19.849 | 4615.1 samples/s | 72.1 steps/s
[Step=97650 Epoch=374.2] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.960 | L2-Norm(final)=19.851 | 4581.1 samples/s | 71.6 steps/s
[Step=97700 Epoch=374.4] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.942 | L2-Norm(final)=19.853 | 4515.4 samples/s | 70.6 steps/s
[Step=97750 Epoch=374.5] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.924 | L2-Norm(final)=19.855 | 4511.1 samples/s | 70.5 steps/s
[Step=97800 Epoch=374.7] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.906 | L2-Norm(final)=19.857 | 6135.6 samples/s | 95.9 steps/s
[Step=97850 Epoch=374.9] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.889 | L2-Norm(final)=19.859 | 1951.2 samples/s | 30.5 steps/s
[Step=97900 Epoch=375.1] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.871 | L2-Norm(final)=19.862 | 4554.4 samples/s | 71.2 steps/s
[Step=97950 Epoch=375.3] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.853 | L2-Norm(final)=19.864 | 4524.6 samples/s | 70.7 steps/s
[Step=98000 Epoch=375.5] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.834 | L2-Norm(final)=19.867 | 4506.9 samples/s | 70.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step98000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=96001 Epoch=369.5] | Loss=0.00002 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.380 | L2-Norm(final)=19.855 | 4319.0 samples/s | 67.5 steps/s
[Step=96050 Epoch=369.7] | Loss=0.00008 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.379 | L2-Norm(final)=19.860 | 4900.3 samples/s | 76.6 steps/s
[Step=96100 Epoch=369.9] | Loss=0.00009 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.379 | L2-Norm(final)=19.866 | 5196.6 samples/s | 81.2 steps/s
[Step=96150 Epoch=370.1] | Loss=0.00009 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.379 | L2-Norm(final)=19.871 | 5220.5 samples/s | 81.6 steps/s
[Step=96200 Epoch=370.3] | Loss=0.00009 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.379 | L2-Norm(final)=19.877 | 5237.5 samples/s | 81.8 steps/s
[Step=96250 Epoch=370.5] | Loss=0.00009 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.379 | L2-Norm(final)=19.883 | 6984.6 samples/s | 109.1 steps/s
[Step=96300 Epoch=370.7] | Loss=0.00009 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.379 | L2-Norm(final)=19.889 | 2118.8 samples/s | 33.1 steps/s
[Step=96350 Epoch=370.9] | Loss=0.00009 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.379 | L2-Norm(final)=19.894 | 5205.2 samples/s | 81.3 steps/s
[Step=96400 Epoch=371.1] | Loss=0.00009 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.379 | L2-Norm(final)=19.900 | 5208.8 samples/s | 81.4 steps/s
[Step=96450 Epoch=371.3] | Loss=0.00009 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.379 | L2-Norm(final)=19.905 | 5345.2 samples/s | 83.5 steps/s
[Step=96500 Epoch=371.5] | Loss=0.00009 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.379 | L2-Norm(final)=19.910 | 6025.9 samples/s | 94.2 steps/s
All layers training...
LR=0.00006, len=1
[Step=96501 Epoch=371.5] | Loss=0.00002 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.379 | L2-Norm(final)=19.959 | 4434.0 samples/s | 69.3 steps/s
[Step=96550 Epoch=371.7] | Loss=0.00016 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.388 | L2-Norm(final)=19.965 | 4425.5 samples/s | 69.1 steps/s
[Step=96600 Epoch=371.9] | Loss=0.00011 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.393 | L2-Norm(final)=19.968 | 4597.5 samples/s | 71.8 steps/s
[Step=96650 Epoch=372.0] | Loss=0.00008 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.395 | L2-Norm(final)=19.970 | 4621.7 samples/s | 72.2 steps/s
[Step=96700 Epoch=372.2] | Loss=0.00007 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.395 | L2-Norm(final)=19.972 | 4485.8 samples/s | 70.1 steps/s
[Step=96750 Epoch=372.4] | Loss=0.00006 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.394 | L2-Norm(final)=19.973 | 5822.6 samples/s | 91.0 steps/s
[Step=96800 Epoch=372.6] | Loss=0.00005 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.392 | L2-Norm(final)=19.974 | 1991.6 samples/s | 31.1 steps/s
[Step=96850 Epoch=372.8] | Loss=0.00004 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.391 | L2-Norm(final)=19.975 | 4615.8 samples/s | 72.1 steps/s
[Step=96900 Epoch=373.0] | Loss=0.00004 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.389 | L2-Norm(final)=19.976 | 4497.7 samples/s | 70.3 steps/s
[Step=96950 Epoch=373.2] | Loss=0.00003 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.387 | L2-Norm(final)=19.976 | 4539.2 samples/s | 70.9 steps/s
[Step=97000 Epoch=373.4] | Loss=0.00003 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.384 | L2-Norm(final)=19.977 | 5124.7 samples/s | 80.1 steps/s
[Step=97050 Epoch=373.6] | Loss=0.00003 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.382 | L2-Norm(final)=19.978 | 2116.4 samples/s | 33.1 steps/s
[Step=97100 Epoch=373.8] | Loss=0.00003 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.380 | L2-Norm(final)=19.978 | 4481.8 samples/s | 70.0 steps/s
[Step=97150 Epoch=374.0] | Loss=0.00002 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.377 | L2-Norm(final)=19.979 | 4540.9 samples/s | 71.0 steps/s
[Step=97200 Epoch=374.2] | Loss=0.00002 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.375 | L2-Norm(final)=19.979 | 4556.2 samples/s | 71.2 steps/s
[Step=97250 Epoch=374.4] | Loss=0.00002 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.372 | L2-Norm(final)=19.980 | 4628.0 samples/s | 72.3 steps/s
[Step=97300 Epoch=374.5] | Loss=0.00002 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.369 | L2-Norm(final)=19.980 | 2184.7 samples/s | 34.1 steps/s
[Step=97350 Epoch=374.7] | Loss=0.00002 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.367 | L2-Norm(final)=19.980 | 4580.6 samples/s | 71.6 steps/s
[Step=97400 Epoch=374.9] | Loss=0.00002 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.364 | L2-Norm(final)=19.981 | 4561.9 samples/s | 71.3 steps/s
[Step=97450 Epoch=375.1] | Loss=0.00002 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.361 | L2-Norm(final)=19.981 | 4541.0 samples/s | 71.0 steps/s
[Step=97500 Epoch=375.3] | Loss=0.00002 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.359 | L2-Norm(final)=19.982 | 4559.8 samples/s | 71.2 steps/s
[Step=97550 Epoch=375.5] | Loss=0.00002 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.356 | L2-Norm(final)=19.982 | 2185.2 samples/s | 34.1 steps/s
[Step=97600 Epoch=375.7] | Loss=0.00002 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.353 | L2-Norm(final)=19.983 | 4662.3 samples/s | 72.8 steps/s
[Step=97650 Epoch=375.9] | Loss=0.00002 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.350 | L2-Norm(final)=19.983 | 4537.3 samples/s | 70.9 steps/s
[Step=97700 Epoch=376.1] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.347 | L2-Norm(final)=19.983 | 4554.1 samples/s | 71.2 steps/s
[Step=97750 Epoch=376.3] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.344 | L2-Norm(final)=19.984 | 4591.1 samples/s | 71.7 steps/s
[Step=97800 Epoch=376.5] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.341 | L2-Norm(final)=19.984 | 6644.6 samples/s | 103.8 steps/s
[Step=97850 Epoch=376.7] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.338 | L2-Norm(final)=19.984 | 1903.0 samples/s | 29.7 steps/s
[Step=97900 Epoch=376.9] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.335 | L2-Norm(final)=19.985 | 4565.9 samples/s | 71.3 steps/s
[Step=97950 Epoch=377.0] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.331 | L2-Norm(final)=19.985 | 4560.3 samples/s | 71.3 steps/s
[Step=98000 Epoch=377.2] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.328 | L2-Norm(final)=19.986 | 4523.0 samples/s | 70.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step98000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06376 | acc=0.9681 | tpr=0.9791 | fpr=0.0557 | 4085.0 samples/s | 16.0 steps/s
Avg test loss: 0.06402, Avg test acc: 0.96783, Avg tpr: 0.97902, Avg fpr: 0.05679, total FA: 443

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06147 | acc=0.9684 | tpr=0.9746 | fpr=0.0451 | 4123.6 samples/s | 16.1 steps/s
Avg test loss: 0.06294, Avg test acc: 0.96799, Avg tpr: 0.97459, Avg fpr: 0.04653, total FA: 363

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.30135 | acc=0.3132 | tpr=0.0019 | fpr=0.0109 | 4162.7 samples/s | 16.3 steps/s
Avg test loss: 6.31458, Avg test acc: 0.31012, Avg tpr: 0.00192, Avg fpr: 0.01205, total FA: 94

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.94648 | acc=0.3043 | tpr=0.0051 | fpr=0.0461 | 4223.4 samples/s | 16.5 steps/s
Avg test loss: 5.95978, Avg test acc: 0.30071, Avg tpr: 0.00490, Avg fpr: 0.04871, total FA: 380

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.60659 | acc=0.1206 | tpr=0.3451 | fpr=0.8834 | 4149.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=4.56656 | acc=0.1202 | tpr=0.3305 | fpr=0.8838 | 8441.1 samples/s | 33.0 steps/s
[Step= 150] | Loss=4.56472 | acc=0.1198 | tpr=0.3343 | fpr=0.8842 | 7256.2 samples/s | 28.3 steps/s
[Step= 200] | Loss=4.56215 | acc=0.1202 | tpr=0.3268 | fpr=0.8836 | 7947.4 samples/s | 31.0 steps/s
[Step= 250] | Loss=4.56104 | acc=0.1202 | tpr=0.3231 | fpr=0.8835 | 7770.0 samples/s | 30.4 steps/s
[Step= 300] | Loss=4.56498 | acc=0.1194 | tpr=0.3142 | fpr=0.8841 | 7880.2 samples/s | 30.8 steps/s
[Step= 350] | Loss=4.57296 | acc=0.1188 | tpr=0.3062 | fpr=0.8846 | 7791.5 samples/s | 30.4 steps/s
[Step= 400] | Loss=4.56744 | acc=0.1184 | tpr=0.3014 | fpr=0.8850 | 7940.6 samples/s | 31.0 steps/s
[Step= 450] | Loss=4.56862 | acc=0.1180 | tpr=0.3028 | fpr=0.8854 | 7142.2 samples/s | 27.9 steps/s
[Step= 500] | Loss=4.56915 | acc=0.1177 | tpr=0.3053 | fpr=0.8857 | 7797.7 samples/s | 30.5 steps/s
[Step= 550] | Loss=4.57046 | acc=0.1178 | tpr=0.3020 | fpr=0.8855 | 14701.4 samples/s | 57.4 steps/s
Avg test loss: 4.57092, Avg test acc: 0.11768, Avg tpr: 0.30190, Avg fpr: 0.88567, total FA: 122974

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.57592 | acc=0.1254 | tpr=0.3142 | fpr=0.8780 | 4180.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=4.53955 | acc=0.1264 | tpr=0.3092 | fpr=0.8770 | 7690.7 samples/s | 30.0 steps/s
[Step= 150] | Loss=4.54112 | acc=0.1265 | tpr=0.3184 | fpr=0.8770 | 8051.9 samples/s | 31.5 steps/s
[Step= 200] | Loss=4.53907 | acc=0.1270 | tpr=0.3202 | fpr=0.8765 | 7556.0 samples/s | 29.5 steps/s
[Step= 250] | Loss=4.53934 | acc=0.1273 | tpr=0.3162 | fpr=0.8762 | 8031.1 samples/s | 31.4 steps/s
[Step= 300] | Loss=4.54179 | acc=0.1265 | tpr=0.3135 | fpr=0.8769 | 7740.4 samples/s | 30.2 steps/s
[Step= 350] | Loss=4.54959 | acc=0.1258 | tpr=0.3049 | fpr=0.8775 | 7978.4 samples/s | 31.2 steps/s
[Step= 400] | Loss=4.54395 | acc=0.1252 | tpr=0.3003 | fpr=0.8780 | 7777.3 samples/s | 30.4 steps/s
[Step= 450] | Loss=4.54494 | acc=0.1247 | tpr=0.3009 | fpr=0.8785 | 7438.3 samples/s | 29.1 steps/s
[Step= 500] | Loss=4.54452 | acc=0.1243 | tpr=0.3044 | fpr=0.8789 | 8013.2 samples/s | 31.3 steps/s
[Step= 550] | Loss=4.54605 | acc=0.1246 | tpr=0.3024 | fpr=0.8787 | 14298.2 samples/s | 55.9 steps/s
Avg test loss: 4.54651, Avg test acc: 0.12440, Avg tpr: 0.30190, Avg fpr: 0.87882, total FA: 122023

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10080 | acc=0.9806 | tpr=0.9381 | fpr=0.0186 | 4292.2 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.10558 | acc=0.9801 | tpr=0.9531 | fpr=0.0194 | 7347.1 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.10791 | acc=0.9793 | tpr=0.9539 | fpr=0.0202 | 7909.3 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.10916 | acc=0.9796 | tpr=0.9585 | fpr=0.0200 | 7776.4 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.10921 | acc=0.9794 | tpr=0.9572 | fpr=0.0202 | 7975.2 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.11067 | acc=0.9792 | tpr=0.9578 | fpr=0.0204 | 8017.7 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.11074 | acc=0.9792 | tpr=0.9587 | fpr=0.0204 | 7843.1 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.11134 | acc=0.9790 | tpr=0.9562 | fpr=0.0206 | 7696.3 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.11308 | acc=0.9786 | tpr=0.9542 | fpr=0.0210 | 7964.5 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.11239 | acc=0.9787 | tpr=0.9559 | fpr=0.0209 | 7608.2 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.11168 | acc=0.9789 | tpr=0.9558 | fpr=0.0207 | 14835.4 samples/s | 58.0 steps/s
Avg test loss: 0.11141, Avg test acc: 0.97892, Avg tpr: 0.95602, Avg fpr: 0.02066, total FA: 2869

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12558 | acc=0.9786 | tpr=0.9381 | fpr=0.0207 | 4176.7 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.13315 | acc=0.9775 | tpr=0.9595 | fpr=0.0222 | 7901.2 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.13543 | acc=0.9770 | tpr=0.9654 | fpr=0.0228 | 7844.2 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.13676 | acc=0.9772 | tpr=0.9672 | fpr=0.0226 | 7839.2 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.13712 | acc=0.9769 | tpr=0.9651 | fpr=0.0228 | 7793.8 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.13932 | acc=0.9766 | tpr=0.9665 | fpr=0.0232 | 8148.8 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.13915 | acc=0.9766 | tpr=0.9656 | fpr=0.0232 | 7965.5 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.14045 | acc=0.9763 | tpr=0.9644 | fpr=0.0235 | 7605.0 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.14237 | acc=0.9760 | tpr=0.9620 | fpr=0.0237 | 7985.8 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.14155 | acc=0.9762 | tpr=0.9634 | fpr=0.0236 | 7883.1 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.14072 | acc=0.9764 | tpr=0.9642 | fpr=0.0234 | 14151.3 samples/s | 55.3 steps/s
Avg test loss: 0.14037, Avg test acc: 0.97645, Avg tpr: 0.96434, Avg fpr: 0.02333, total FA: 3239

server round 49/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=98001 Epoch=191.1] | Loss=0.04855 | Reg=0.00051 | acc=0.9375 | L2-Norm=7.173 | L2-Norm(final)=22.478 | 4155.2 samples/s | 64.9 steps/s
[Step=98050 Epoch=191.2] | Loss=0.02363 | Reg=0.00051 | acc=0.9531 | L2-Norm=7.173 | L2-Norm(final)=22.483 | 5338.4 samples/s | 83.4 steps/s
[Step=98100 Epoch=191.3] | Loss=0.02327 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.173 | L2-Norm(final)=22.490 | 5599.5 samples/s | 87.5 steps/s
[Step=98150 Epoch=191.4] | Loss=0.02363 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.173 | L2-Norm(final)=22.497 | 5487.0 samples/s | 85.7 steps/s
[Step=98200 Epoch=191.5] | Loss=0.02301 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.174 | L2-Norm(final)=22.503 | 5523.5 samples/s | 86.3 steps/s
[Step=98250 Epoch=191.6] | Loss=0.02279 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.174 | L2-Norm(final)=22.509 | 5603.9 samples/s | 87.6 steps/s
[Step=98300 Epoch=191.7] | Loss=0.02287 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.174 | L2-Norm(final)=22.515 | 5448.3 samples/s | 85.1 steps/s
[Step=98350 Epoch=191.8] | Loss=0.02270 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.174 | L2-Norm(final)=22.521 | 5552.7 samples/s | 86.8 steps/s
[Step=98400 Epoch=191.9] | Loss=0.02273 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.174 | L2-Norm(final)=22.527 | 5483.8 samples/s | 85.7 steps/s
[Step=98450 Epoch=192.0] | Loss=0.02240 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.174 | L2-Norm(final)=22.532 | 5613.9 samples/s | 87.7 steps/s
[Step=98500 Epoch=192.1] | Loss=0.02236 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.174 | L2-Norm(final)=22.538 | 6893.1 samples/s | 107.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_0/client_state-step98500.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=98001 Epoch=191.6] | Loss=0.03920 | Reg=0.00051 | acc=0.9531 | L2-Norm=7.173 | L2-Norm(final)=22.312 | 4527.2 samples/s | 70.7 steps/s
[Step=98050 Epoch=191.7] | Loss=0.02401 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.173 | L2-Norm(final)=22.319 | 5229.1 samples/s | 81.7 steps/s
[Step=98100 Epoch=191.8] | Loss=0.02228 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.173 | L2-Norm(final)=22.327 | 5567.4 samples/s | 87.0 steps/s
[Step=98150 Epoch=191.9] | Loss=0.02219 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.173 | L2-Norm(final)=22.335 | 5626.2 samples/s | 87.9 steps/s
[Step=98200 Epoch=192.0] | Loss=0.02322 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.173 | L2-Norm(final)=22.343 | 5609.0 samples/s | 87.6 steps/s
[Step=98250 Epoch=192.1] | Loss=0.02314 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.173 | L2-Norm(final)=22.350 | 5355.3 samples/s | 83.7 steps/s
[Step=98300 Epoch=192.2] | Loss=0.02297 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.173 | L2-Norm(final)=22.358 | 5548.7 samples/s | 86.7 steps/s
[Step=98350 Epoch=192.3] | Loss=0.02245 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.173 | L2-Norm(final)=22.366 | 5563.4 samples/s | 86.9 steps/s
[Step=98400 Epoch=192.4] | Loss=0.02261 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.173 | L2-Norm(final)=22.373 | 5567.6 samples/s | 87.0 steps/s
[Step=98450 Epoch=192.5] | Loss=0.02269 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.173 | L2-Norm(final)=22.380 | 5399.6 samples/s | 84.4 steps/s
[Step=98500 Epoch=192.6] | Loss=0.02273 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.173 | L2-Norm(final)=22.387 | 7078.0 samples/s | 110.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_asml1_1/client_state-step98500.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=98001 Epoch=375.5] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.173 | L2-Norm(final)=19.943 | 4425.6 samples/s | 69.2 steps/s
[Step=98050 Epoch=375.7] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.167 | L2-Norm(final)=19.951 | 4953.3 samples/s | 77.4 steps/s
[Step=98100 Epoch=375.9] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=19.961 | 5276.8 samples/s | 82.4 steps/s
[Step=98150 Epoch=376.1] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=19.972 | 5208.0 samples/s | 81.4 steps/s
[Step=98200 Epoch=376.3] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=19.983 | 5119.9 samples/s | 80.0 steps/s
[Step=98250 Epoch=376.5] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=19.994 | 6913.0 samples/s | 108.0 steps/s
[Step=98300 Epoch=376.7] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=20.004 | 2151.4 samples/s | 33.6 steps/s
[Step=98350 Epoch=376.8] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=20.014 | 5190.1 samples/s | 81.1 steps/s
[Step=98400 Epoch=377.0] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=20.024 | 5190.5 samples/s | 81.1 steps/s
[Step=98450 Epoch=377.2] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=20.034 | 5229.5 samples/s | 81.7 steps/s
[Step=98500 Epoch=377.4] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=20.044 | 5878.7 samples/s | 91.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_0/client_state-step98500.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=98001 Epoch=377.2] | Loss=0.00006 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.173 | L2-Norm(final)=19.997 | 4336.5 samples/s | 67.8 steps/s
[Step=98050 Epoch=377.4] | Loss=0.00010 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.171 | L2-Norm(final)=20.003 | 4976.0 samples/s | 77.8 steps/s
[Step=98100 Epoch=377.6] | Loss=0.00011 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.171 | L2-Norm(final)=20.010 | 5324.6 samples/s | 83.2 steps/s
[Step=98150 Epoch=377.8] | Loss=0.00010 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.171 | L2-Norm(final)=20.017 | 5040.1 samples/s | 78.8 steps/s
[Step=98200 Epoch=378.0] | Loss=0.00010 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.171 | L2-Norm(final)=20.023 | 5268.0 samples/s | 82.3 steps/s
[Step=98250 Epoch=378.2] | Loss=0.00009 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.171 | L2-Norm(final)=20.029 | 6938.9 samples/s | 108.4 steps/s
[Step=98300 Epoch=378.4] | Loss=0.00010 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.171 | L2-Norm(final)=20.034 | 2105.6 samples/s | 32.9 steps/s
[Step=98350 Epoch=378.6] | Loss=0.00009 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.171 | L2-Norm(final)=20.040 | 5185.4 samples/s | 81.0 steps/s
[Step=98400 Epoch=378.8] | Loss=0.00009 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.171 | L2-Norm(final)=20.045 | 5235.7 samples/s | 81.8 steps/s
[Step=98450 Epoch=379.0] | Loss=0.00009 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.171 | L2-Norm(final)=20.050 | 5278.2 samples/s | 82.5 steps/s
[Step=98500 Epoch=379.2] | Loss=0.00010 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.171 | L2-Norm(final)=20.056 | 6052.8 samples/s | 94.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel1.0-ch26/client_iccad2012_1/client_state-step98500.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05701 | acc=0.9630 | tpr=0.9677 | fpr=0.0473 | 4091.1 samples/s | 16.0 steps/s
Avg test loss: 0.05826, Avg test acc: 0.96218, Avg tpr: 0.96794, Avg fpr: 0.05051, total FA: 394

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05610 | acc=0.9630 | tpr=0.9706 | fpr=0.0535 | 4197.0 samples/s | 16.4 steps/s
Avg test loss: 0.05740, Avg test acc: 0.96226, Avg tpr: 0.97057, Avg fpr: 0.05602, total FA: 437

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.81696 | acc=0.3077 | tpr=0.0027 | fpr=0.0300 | 4173.4 samples/s | 16.3 steps/s
Avg test loss: 5.83116, Avg test acc: 0.30451, Avg tpr: 0.00274, Avg fpr: 0.03179, total FA: 248

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.99993 | acc=0.3028 | tpr=0.0065 | fpr=0.0538 | 4170.9 samples/s | 16.3 steps/s
Avg test loss: 5.01213, Avg test acc: 0.29854, Avg tpr: 0.00595, Avg fpr: 0.05794, total FA: 452

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=2.96987 | acc=0.1224 | tpr=0.1858 | fpr=0.8787 | 4169.1 samples/s | 16.3 steps/s
[Step= 100] | Loss=2.94584 | acc=0.1228 | tpr=0.1770 | fpr=0.8782 | 8050.3 samples/s | 31.4 steps/s
[Step= 150] | Loss=2.94698 | acc=0.1234 | tpr=0.1916 | fpr=0.8779 | 7768.6 samples/s | 30.3 steps/s
[Step= 200] | Loss=2.94461 | acc=0.1234 | tpr=0.1858 | fpr=0.8778 | 7940.5 samples/s | 31.0 steps/s
[Step= 250] | Loss=2.94394 | acc=0.1235 | tpr=0.1825 | fpr=0.8776 | 8102.6 samples/s | 31.7 steps/s
[Step= 300] | Loss=2.94737 | acc=0.1229 | tpr=0.1796 | fpr=0.8781 | 7578.4 samples/s | 29.6 steps/s
[Step= 350] | Loss=2.95296 | acc=0.1223 | tpr=0.1760 | fpr=0.8786 | 7996.1 samples/s | 31.2 steps/s
[Step= 400] | Loss=2.94906 | acc=0.1220 | tpr=0.1723 | fpr=0.8789 | 6645.2 samples/s | 26.0 steps/s
[Step= 450] | Loss=2.94919 | acc=0.1218 | tpr=0.1714 | fpr=0.8791 | 5232.3 samples/s | 20.4 steps/s
[Step= 500] | Loss=2.94973 | acc=0.1215 | tpr=0.1722 | fpr=0.8794 | 7728.5 samples/s | 30.2 steps/s
[Step= 550] | Loss=2.95047 | acc=0.1218 | tpr=0.1723 | fpr=0.8791 | 14220.5 samples/s | 55.5 steps/s
Avg test loss: 2.95041, Avg test acc: 0.12169, Avg tpr: 0.17235, Avg fpr: 0.87923, total FA: 122080

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.02400 | acc=0.1180 | tpr=0.1991 | fpr=0.8834 | 4164.6 samples/s | 16.3 steps/s
[Step= 100] | Loss=2.99969 | acc=0.1184 | tpr=0.1898 | fpr=0.8830 | 7836.1 samples/s | 30.6 steps/s
[Step= 150] | Loss=3.00085 | acc=0.1188 | tpr=0.2017 | fpr=0.8828 | 7886.3 samples/s | 30.8 steps/s
[Step= 200] | Loss=2.99845 | acc=0.1190 | tpr=0.1945 | fpr=0.8823 | 7885.7 samples/s | 30.8 steps/s
[Step= 250] | Loss=2.99776 | acc=0.1192 | tpr=0.1930 | fpr=0.8822 | 7550.1 samples/s | 29.5 steps/s
[Step= 300] | Loss=3.00116 | acc=0.1185 | tpr=0.1891 | fpr=0.8828 | 8209.5 samples/s | 32.1 steps/s
[Step= 350] | Loss=3.00677 | acc=0.1180 | tpr=0.1847 | fpr=0.8832 | 7581.9 samples/s | 29.6 steps/s
[Step= 400] | Loss=3.00282 | acc=0.1177 | tpr=0.1816 | fpr=0.8834 | 4621.0 samples/s | 18.1 steps/s
[Step= 450] | Loss=3.00297 | acc=0.1176 | tpr=0.1796 | fpr=0.8835 | 8012.8 samples/s | 31.3 steps/s
[Step= 500] | Loss=3.00352 | acc=0.1173 | tpr=0.1797 | fpr=0.8838 | 7705.5 samples/s | 30.1 steps/s
[Step= 550] | Loss=3.00422 | acc=0.1176 | tpr=0.1799 | fpr=0.8835 | 14778.9 samples/s | 57.7 steps/s
Avg test loss: 3.00416, Avg test acc: 0.11747, Avg tpr: 0.17987, Avg fpr: 0.88366, total FA: 122695

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09347 | acc=0.9811 | tpr=0.9425 | fpr=0.0182 | 4118.0 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.09841 | acc=0.9802 | tpr=0.9616 | fpr=0.0195 | 7812.4 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.09990 | acc=0.9799 | tpr=0.9625 | fpr=0.0198 | 8051.1 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.10122 | acc=0.9801 | tpr=0.9628 | fpr=0.0196 | 5289.7 samples/s | 20.7 steps/s
[Step= 250] | Loss=0.10148 | acc=0.9798 | tpr=0.9607 | fpr=0.0198 | 8097.7 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.10334 | acc=0.9796 | tpr=0.9615 | fpr=0.0201 | 7677.0 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.10327 | acc=0.9796 | tpr=0.9612 | fpr=0.0200 | 7780.8 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.10418 | acc=0.9794 | tpr=0.9601 | fpr=0.0202 | 6540.4 samples/s | 25.5 steps/s
[Step= 450] | Loss=0.10565 | acc=0.9791 | tpr=0.9581 | fpr=0.0205 | 7760.7 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.10494 | acc=0.9793 | tpr=0.9595 | fpr=0.0204 | 7718.6 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.10443 | acc=0.9795 | tpr=0.9606 | fpr=0.0202 | 14313.8 samples/s | 55.9 steps/s
Avg test loss: 0.10417, Avg test acc: 0.97949, Avg tpr: 0.96078, Avg fpr: 0.02017, total FA: 2801

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10865 | acc=0.9767 | tpr=0.9469 | fpr=0.0227 | 4081.9 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.11454 | acc=0.9760 | tpr=0.9659 | fpr=0.0238 | 7722.7 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.11635 | acc=0.9757 | tpr=0.9683 | fpr=0.0242 | 7797.3 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.11762 | acc=0.9758 | tpr=0.9716 | fpr=0.0241 | 5528.6 samples/s | 21.6 steps/s
[Step= 250] | Loss=0.11806 | acc=0.9755 | tpr=0.9686 | fpr=0.0244 | 7797.7 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.12019 | acc=0.9751 | tpr=0.9702 | fpr=0.0248 | 7728.3 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.12011 | acc=0.9752 | tpr=0.9699 | fpr=0.0247 | 7242.1 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.12120 | acc=0.9749 | tpr=0.9710 | fpr=0.0250 | 7158.1 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.12276 | acc=0.9747 | tpr=0.9684 | fpr=0.0252 | 7441.2 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.12201 | acc=0.9747 | tpr=0.9692 | fpr=0.0252 | 7835.9 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.12134 | acc=0.9750 | tpr=0.9698 | fpr=0.0249 | 14596.2 samples/s | 57.0 steps/s
Avg test loss: 0.12104, Avg test acc: 0.97500, Avg tpr: 0.96989, Avg fpr: 0.02491, total FA: 3459
