#clients of iccad2012: 5
#clients of asml1: 5
select ratio: 0.5
Total num clients: 10
client model path: ['models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0', 'models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1', 'models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2', 'models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3', 'models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4', 'models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0', 'models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1', 'models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2', 'models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3', 'models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (9983, 144, 20)
Resampled dataset to size (13125, 144, 20)
Using transform option: train
#pos = 6841, #neg = 6284
Allocated dataset with size (9983, 144, 20)
Resampled dataset to size (13116, 144, 20)
Using transform option: train
#pos = 6850, #neg = 6266
Allocated dataset with size (9983, 144, 20)
Resampled dataset to size (13135, 144, 20)
Using transform option: train
#pos = 6831, #neg = 6304
Allocated dataset with size (9983, 144, 20)
Resampled dataset to size (13124, 144, 20)
Using transform option: train
#pos = 6842, #neg = 6282
Allocated dataset with size (9984, 144, 20)
Resampled dataset to size (13051, 144, 20)
Using transform option: train
#pos = 6917, #neg = 6134
loading data into the main memory...
Allocated dataset with size (3660, 144, 20)
Resampled dataset to size (6754, 144, 20)
Using transform option: train
#pos = 3332, #neg = 3422
Allocated dataset with size (3660, 144, 20)
Resampled dataset to size (6728, 144, 20)
Using transform option: train
#pos = 3304, #neg = 3424
Allocated dataset with size (3660, 144, 20)
Resampled dataset to size (6702, 144, 20)
Using transform option: train
#pos = 3276, #neg = 3426
Allocated dataset with size (3660, 144, 20)
Resampled dataset to size (6792, 144, 20)
Using transform option: train
#pos = 3393, #neg = 3399
Allocated dataset with size (3660, 144, 20)
Resampled dataset to size (6715, 144, 20)
Using transform option: train
#pos = 3290, #neg = 3425
loading data into the main memory...
Allocated dataset with size (24958, 144, 20)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 20)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [1 2 4 5 6]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35091 | Reg=0.00355 | acc=0.5469 | L2-Norm=18.840 | L2-Norm(final)=2.019 | 4017.5 samples/s | 62.8 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.34240 | Reg=0.00355 | acc=0.6719 | L2-Norm=18.840 | L2-Norm(final)=2.037 | 6500.1 samples/s | 101.6 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.33875 | Reg=0.00355 | acc=0.6562 | L2-Norm=18.840 | L2-Norm(final)=2.062 | 6301.7 samples/s | 98.5 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.33600 | Reg=0.00355 | acc=0.5781 | L2-Norm=18.840 | L2-Norm(final)=2.091 | 6517.9 samples/s | 101.8 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.33320 | Reg=0.00355 | acc=0.6094 | L2-Norm=18.840 | L2-Norm(final)=2.122 | 10197.1 samples/s | 159.3 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.33089 | Reg=0.00355 | acc=0.6719 | L2-Norm=18.840 | L2-Norm(final)=2.158 | 2666.0 samples/s | 41.7 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.32956 | Reg=0.00355 | acc=0.6719 | L2-Norm=18.840 | L2-Norm(final)=2.195 | 6017.2 samples/s | 94.0 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.32858 | Reg=0.00355 | acc=0.5625 | L2-Norm=18.840 | L2-Norm(final)=2.232 | 6493.6 samples/s | 101.5 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.32721 | Reg=0.00355 | acc=0.6875 | L2-Norm=18.840 | L2-Norm(final)=2.269 | 9229.9 samples/s | 144.2 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.32573 | Reg=0.00355 | acc=0.6406 | L2-Norm=18.840 | L2-Norm(final)=2.308 | 2646.3 samples/s | 41.3 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.32486 | Reg=0.00355 | acc=0.6719 | L2-Norm=18.840 | L2-Norm(final)=2.348 | 6311.6 samples/s | 98.6 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.30513 | Reg=0.00355 | acc=0.7344 | L2-Norm=18.840 | L2-Norm(final)=2.749 | 5291.7 samples/s | 82.7 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.28179 | Reg=0.00331 | acc=0.8281 | L2-Norm=18.185 | L2-Norm(final)=2.766 | 4630.0 samples/s | 72.3 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.24254 | Reg=0.00322 | acc=0.8750 | L2-Norm=17.953 | L2-Norm(final)=2.778 | 4904.7 samples/s | 76.6 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.21818 | Reg=0.00318 | acc=0.7969 | L2-Norm=17.839 | L2-Norm(final)=2.786 | 4844.4 samples/s | 75.7 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.19999 | Reg=0.00316 | acc=0.9062 | L2-Norm=17.766 | L2-Norm(final)=2.794 | 7035.4 samples/s | 109.9 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.18407 | Reg=0.00314 | acc=0.9375 | L2-Norm=17.713 | L2-Norm(final)=2.803 | 2237.6 samples/s | 35.0 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.17116 | Reg=0.00313 | acc=0.9062 | L2-Norm=17.678 | L2-Norm(final)=2.815 | 4877.4 samples/s | 76.2 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.16357 | Reg=0.00312 | acc=0.8594 | L2-Norm=17.652 | L2-Norm(final)=2.826 | 4909.3 samples/s | 76.7 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.15588 | Reg=0.00311 | acc=0.9062 | L2-Norm=17.633 | L2-Norm(final)=2.835 | 6374.3 samples/s | 99.6 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.14602 | Reg=0.00310 | acc=0.9375 | L2-Norm=17.619 | L2-Norm(final)=2.844 | 2336.6 samples/s | 36.5 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.13869 | Reg=0.00310 | acc=0.9219 | L2-Norm=17.610 | L2-Norm(final)=2.854 | 4833.3 samples/s | 75.5 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.13236 | Reg=0.00310 | acc=0.9375 | L2-Norm=17.603 | L2-Norm(final)=2.863 | 4842.4 samples/s | 75.7 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.12671 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.598 | L2-Norm(final)=2.873 | 6050.0 samples/s | 94.5 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.12068 | Reg=0.00310 | acc=0.9531 | L2-Norm=17.595 | L2-Norm(final)=2.882 | 2414.0 samples/s | 37.7 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.11552 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.594 | L2-Norm(final)=2.891 | 4815.1 samples/s | 75.2 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.11114 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.596 | L2-Norm(final)=2.899 | 4860.5 samples/s | 75.9 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.10730 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.599 | L2-Norm(final)=2.907 | 5556.4 samples/s | 86.8 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.10373 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.603 | L2-Norm(final)=2.915 | 2503.1 samples/s | 39.1 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.09952 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.608 | L2-Norm(final)=2.923 | 4919.6 samples/s | 76.9 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.09592 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.612 | L2-Norm(final)=2.931 | 4877.2 samples/s | 76.2 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.09299 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.618 | L2-Norm(final)=2.938 | 5117.2 samples/s | 80.0 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.09019 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.623 | L2-Norm(final)=2.945 | 2543.5 samples/s | 39.7 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.08714 | Reg=0.00311 | acc=0.9688 | L2-Norm=17.628 | L2-Norm(final)=2.952 | 4853.1 samples/s | 75.8 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.08461 | Reg=0.00311 | acc=0.9531 | L2-Norm=17.632 | L2-Norm(final)=2.959 | 4816.4 samples/s | 75.3 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.08277 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.636 | L2-Norm(final)=2.964 | 4933.9 samples/s | 77.1 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.08051 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.640 | L2-Norm(final)=2.970 | 2604.9 samples/s | 40.7 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.07841 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.644 | L2-Norm(final)=2.975 | 4866.3 samples/s | 76.0 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.07649 | Reg=0.00311 | acc=0.9688 | L2-Norm=17.647 | L2-Norm(final)=2.980 | 4890.5 samples/s | 76.4 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07457 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.651 | L2-Norm(final)=2.985 | 4897.0 samples/s | 76.5 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07303 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.654 | L2-Norm(final)=2.990 | 2601.4 samples/s | 40.6 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.07132 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.658 | L2-Norm(final)=2.995 | 4963.4 samples/s | 77.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step2000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34826 | Reg=0.00355 | acc=0.5000 | L2-Norm=18.840 | L2-Norm(final)=2.020 | 5350.8 samples/s | 83.6 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.34332 | Reg=0.00355 | acc=0.4531 | L2-Norm=18.840 | L2-Norm(final)=2.035 | 5892.0 samples/s | 92.1 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.34036 | Reg=0.00355 | acc=0.5938 | L2-Norm=18.840 | L2-Norm(final)=2.057 | 6273.7 samples/s | 98.0 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.33702 | Reg=0.00355 | acc=0.5312 | L2-Norm=18.840 | L2-Norm(final)=2.084 | 6374.2 samples/s | 99.6 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.33509 | Reg=0.00355 | acc=0.5156 | L2-Norm=18.840 | L2-Norm(final)=2.116 | 10428.8 samples/s | 163.0 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.33351 | Reg=0.00355 | acc=0.5781 | L2-Norm=18.840 | L2-Norm(final)=2.150 | 2595.4 samples/s | 40.6 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.33181 | Reg=0.00355 | acc=0.7344 | L2-Norm=18.840 | L2-Norm(final)=2.186 | 6237.1 samples/s | 97.5 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.32996 | Reg=0.00355 | acc=0.6875 | L2-Norm=18.840 | L2-Norm(final)=2.224 | 6428.3 samples/s | 100.4 steps/s
[Step= 400 Epoch= 1.9] | Loss=0.32881 | Reg=0.00355 | acc=0.7031 | L2-Norm=18.840 | L2-Norm(final)=2.263 | 8973.4 samples/s | 140.2 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.32780 | Reg=0.00355 | acc=0.6406 | L2-Norm=18.840 | L2-Norm(final)=2.304 | 2700.2 samples/s | 42.2 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.32670 | Reg=0.00355 | acc=0.7188 | L2-Norm=18.840 | L2-Norm(final)=2.346 | 6185.5 samples/s | 96.6 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.30926 | Reg=0.00355 | acc=0.6562 | L2-Norm=18.840 | L2-Norm(final)=2.772 | 6223.0 samples/s | 97.2 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.27610 | Reg=0.00332 | acc=0.8750 | L2-Norm=18.226 | L2-Norm(final)=2.792 | 4250.0 samples/s | 66.4 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.23188 | Reg=0.00324 | acc=0.8750 | L2-Norm=18.003 | L2-Norm(final)=2.808 | 4835.2 samples/s | 75.6 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.21065 | Reg=0.00320 | acc=0.9062 | L2-Norm=17.878 | L2-Norm(final)=2.818 | 4850.1 samples/s | 75.8 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.19551 | Reg=0.00317 | acc=0.8594 | L2-Norm=17.796 | L2-Norm(final)=2.828 | 6988.7 samples/s | 109.2 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.17820 | Reg=0.00315 | acc=0.9531 | L2-Norm=17.740 | L2-Norm(final)=2.839 | 2301.6 samples/s | 36.0 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.16644 | Reg=0.00313 | acc=0.8594 | L2-Norm=17.700 | L2-Norm(final)=2.852 | 4810.1 samples/s | 75.2 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.15823 | Reg=0.00312 | acc=0.8906 | L2-Norm=17.671 | L2-Norm(final)=2.863 | 4874.6 samples/s | 76.2 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.15010 | Reg=0.00312 | acc=0.9219 | L2-Norm=17.649 | L2-Norm(final)=2.873 | 6339.3 samples/s | 99.1 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.14234 | Reg=0.00311 | acc=0.9375 | L2-Norm=17.632 | L2-Norm(final)=2.882 | 2364.9 samples/s | 37.0 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.13429 | Reg=0.00311 | acc=0.9375 | L2-Norm=17.620 | L2-Norm(final)=2.893 | 4861.8 samples/s | 76.0 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.12800 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.610 | L2-Norm(final)=2.904 | 4963.3 samples/s | 77.6 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.12316 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.602 | L2-Norm(final)=2.914 | 5684.0 samples/s | 88.8 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.11805 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.596 | L2-Norm(final)=2.923 | 2437.7 samples/s | 38.1 steps/s
[Step=1200 Epoch= 5.8] | Loss=0.11283 | Reg=0.00310 | acc=0.9219 | L2-Norm=17.593 | L2-Norm(final)=2.933 | 4863.8 samples/s | 76.0 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.10845 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.592 | L2-Norm(final)=2.943 | 4862.4 samples/s | 76.0 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.10448 | Reg=0.00310 | acc=0.9375 | L2-Norm=17.592 | L2-Norm(final)=2.952 | 5349.8 samples/s | 83.6 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.10046 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.592 | L2-Norm(final)=2.961 | 2541.1 samples/s | 39.7 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.09678 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.593 | L2-Norm(final)=2.970 | 4871.8 samples/s | 76.1 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.09359 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.594 | L2-Norm(final)=2.979 | 4879.6 samples/s | 76.2 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.09064 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.594 | L2-Norm(final)=2.987 | 4971.1 samples/s | 77.7 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.08808 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.595 | L2-Norm(final)=2.994 | 2594.2 samples/s | 40.5 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.08567 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.596 | L2-Norm(final)=3.001 | 4848.4 samples/s | 75.8 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.08305 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.598 | L2-Norm(final)=3.009 | 4920.4 samples/s | 76.9 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.08073 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.600 | L2-Norm(final)=3.016 | 4866.0 samples/s | 76.0 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.07895 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.602 | L2-Norm(final)=3.022 | 2657.6 samples/s | 41.5 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.07688 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.604 | L2-Norm(final)=3.029 | 4914.2 samples/s | 76.8 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.07487 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.606 | L2-Norm(final)=3.035 | 4757.3 samples/s | 74.3 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07311 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.608 | L2-Norm(final)=3.041 | 4834.9 samples/s | 75.5 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07185 | Reg=0.00310 | acc=0.8906 | L2-Norm=17.611 | L2-Norm(final)=3.047 | 2616.3 samples/s | 40.9 steps/s
[Step=2000 Epoch= 9.7] | Loss=0.07070 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.614 | L2-Norm(final)=3.052 | 4827.5 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step2000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34127 | Reg=0.00355 | acc=0.5625 | L2-Norm=18.840 | L2-Norm(final)=2.020 | 5696.3 samples/s | 89.0 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.34251 | Reg=0.00355 | acc=0.5781 | L2-Norm=18.840 | L2-Norm(final)=2.031 | 5741.4 samples/s | 89.7 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.33996 | Reg=0.00355 | acc=0.5156 | L2-Norm=18.840 | L2-Norm(final)=2.053 | 6521.4 samples/s | 101.9 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.33684 | Reg=0.00355 | acc=0.6406 | L2-Norm=18.840 | L2-Norm(final)=2.079 | 5937.5 samples/s | 92.8 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.33477 | Reg=0.00355 | acc=0.7031 | L2-Norm=18.840 | L2-Norm(final)=2.107 | 10852.7 samples/s | 169.6 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.33296 | Reg=0.00355 | acc=0.7031 | L2-Norm=18.840 | L2-Norm(final)=2.140 | 2517.7 samples/s | 39.3 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.33114 | Reg=0.00355 | acc=0.7500 | L2-Norm=18.840 | L2-Norm(final)=2.176 | 6261.2 samples/s | 97.8 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.32997 | Reg=0.00355 | acc=0.7344 | L2-Norm=18.840 | L2-Norm(final)=2.214 | 6577.0 samples/s | 102.8 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.32868 | Reg=0.00355 | acc=0.7812 | L2-Norm=18.840 | L2-Norm(final)=2.252 | 9453.6 samples/s | 147.7 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.32756 | Reg=0.00355 | acc=0.6250 | L2-Norm=18.840 | L2-Norm(final)=2.291 | 2561.1 samples/s | 40.0 steps/s
[Step= 500 Epoch= 2.5] | Loss=0.32690 | Reg=0.00355 | acc=0.6562 | L2-Norm=18.840 | L2-Norm(final)=2.332 | 6597.9 samples/s | 103.1 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.5] | Loss=0.28942 | Reg=0.00355 | acc=0.7031 | L2-Norm=18.840 | L2-Norm(final)=2.733 | 5840.6 samples/s | 91.3 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.29393 | Reg=0.00331 | acc=0.7969 | L2-Norm=18.183 | L2-Norm(final)=2.738 | 4412.0 samples/s | 68.9 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.24875 | Reg=0.00322 | acc=0.8438 | L2-Norm=17.935 | L2-Norm(final)=2.758 | 4880.0 samples/s | 76.3 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.21992 | Reg=0.00317 | acc=0.8438 | L2-Norm=17.806 | L2-Norm(final)=2.773 | 4874.5 samples/s | 76.2 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.20048 | Reg=0.00314 | acc=0.8594 | L2-Norm=17.729 | L2-Norm(final)=2.784 | 7021.0 samples/s | 109.7 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.18362 | Reg=0.00313 | acc=0.9531 | L2-Norm=17.684 | L2-Norm(final)=2.797 | 2248.4 samples/s | 35.1 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.16941 | Reg=0.00312 | acc=0.9062 | L2-Norm=17.655 | L2-Norm(final)=2.810 | 4873.6 samples/s | 76.2 steps/s
[Step= 850 Epoch= 4.2] | Loss=0.15931 | Reg=0.00311 | acc=0.9375 | L2-Norm=17.638 | L2-Norm(final)=2.821 | 4956.9 samples/s | 77.5 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.14950 | Reg=0.00311 | acc=0.9375 | L2-Norm=17.628 | L2-Norm(final)=2.832 | 6542.9 samples/s | 102.2 steps/s
[Step= 950 Epoch= 4.7] | Loss=0.13982 | Reg=0.00311 | acc=0.9688 | L2-Norm=17.621 | L2-Norm(final)=2.843 | 2314.6 samples/s | 36.2 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.13202 | Reg=0.00310 | acc=0.9375 | L2-Norm=17.618 | L2-Norm(final)=2.855 | 4843.5 samples/s | 75.7 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.12533 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.619 | L2-Norm(final)=2.868 | 4899.8 samples/s | 76.6 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.11968 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.623 | L2-Norm(final)=2.878 | 6196.3 samples/s | 96.8 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.11391 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.626 | L2-Norm(final)=2.888 | 2349.9 samples/s | 36.7 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.10889 | Reg=0.00311 | acc=0.9219 | L2-Norm=17.631 | L2-Norm(final)=2.898 | 4850.2 samples/s | 75.8 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.10428 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.637 | L2-Norm(final)=2.907 | 4882.8 samples/s | 76.3 steps/s
[Step=1300 Epoch= 6.4] | Loss=0.10050 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.644 | L2-Norm(final)=2.917 | 5892.4 samples/s | 92.1 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.09654 | Reg=0.00312 | acc=0.9688 | L2-Norm=17.651 | L2-Norm(final)=2.925 | 2410.4 samples/s | 37.7 steps/s
[Step=1400 Epoch= 6.9] | Loss=0.09274 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.659 | L2-Norm(final)=2.935 | 4820.0 samples/s | 75.3 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.08954 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.667 | L2-Norm(final)=2.943 | 4877.9 samples/s | 76.2 steps/s
[Step=1500 Epoch= 7.4] | Loss=0.08735 | Reg=0.00312 | acc=0.9062 | L2-Norm=17.676 | L2-Norm(final)=2.951 | 5612.9 samples/s | 87.7 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.08510 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.686 | L2-Norm(final)=2.958 | 2480.2 samples/s | 38.8 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.08257 | Reg=0.00313 | acc=0.9375 | L2-Norm=17.696 | L2-Norm(final)=2.964 | 4852.1 samples/s | 75.8 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.08012 | Reg=0.00314 | acc=0.9531 | L2-Norm=17.706 | L2-Norm(final)=2.971 | 4853.4 samples/s | 75.8 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.07772 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.714 | L2-Norm(final)=2.977 | 5354.7 samples/s | 83.7 steps/s
[Step=1750 Epoch= 8.6] | Loss=0.07579 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.722 | L2-Norm(final)=2.983 | 2509.5 samples/s | 39.2 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.07365 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.730 | L2-Norm(final)=2.988 | 4893.6 samples/s | 76.5 steps/s
[Step=1850 Epoch= 9.1] | Loss=0.07175 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.737 | L2-Norm(final)=2.994 | 4873.4 samples/s | 76.1 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07008 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.744 | L2-Norm(final)=2.999 | 5011.1 samples/s | 78.3 steps/s
[Step=1950 Epoch= 9.6] | Loss=0.06817 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.750 | L2-Norm(final)=3.004 | 2590.6 samples/s | 40.5 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06640 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.756 | L2-Norm(final)=3.010 | 4889.1 samples/s | 76.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step2000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34451 | Reg=0.00355 | acc=0.5312 | L2-Norm=18.840 | L2-Norm(final)=2.020 | 5416.5 samples/s | 84.6 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.31831 | Reg=0.00355 | acc=0.5312 | L2-Norm=18.840 | L2-Norm(final)=2.034 | 5400.0 samples/s | 84.4 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.30569 | Reg=0.00355 | acc=0.7188 | L2-Norm=18.840 | L2-Norm(final)=2.068 | 9099.8 samples/s | 142.2 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.29453 | Reg=0.00355 | acc=0.9062 | L2-Norm=18.840 | L2-Norm(final)=2.126 | 2480.7 samples/s | 38.8 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.28501 | Reg=0.00355 | acc=0.7656 | L2-Norm=18.840 | L2-Norm(final)=2.199 | 8533.5 samples/s | 133.3 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.27722 | Reg=0.00355 | acc=0.7969 | L2-Norm=18.840 | L2-Norm(final)=2.281 | 2570.3 samples/s | 40.2 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.26941 | Reg=0.00355 | acc=0.8750 | L2-Norm=18.840 | L2-Norm(final)=2.369 | 7496.2 samples/s | 117.1 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.26311 | Reg=0.00355 | acc=0.8281 | L2-Norm=18.840 | L2-Norm(final)=2.461 | 2681.2 samples/s | 41.9 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.25686 | Reg=0.00355 | acc=0.9219 | L2-Norm=18.840 | L2-Norm(final)=2.554 | 6636.6 samples/s | 103.7 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.25170 | Reg=0.00355 | acc=0.9062 | L2-Norm=18.840 | L2-Norm(final)=2.649 | 2794.4 samples/s | 43.7 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.24682 | Reg=0.00355 | acc=0.8438 | L2-Norm=18.840 | L2-Norm(final)=2.744 | 6082.0 samples/s | 95.0 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.7] | Loss=0.19802 | Reg=0.00355 | acc=0.8594 | L2-Norm=18.840 | L2-Norm(final)=3.696 | 5536.1 samples/s | 86.5 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.13970 | Reg=0.00336 | acc=0.9531 | L2-Norm=18.342 | L2-Norm(final)=3.719 | 4412.7 samples/s | 68.9 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.08705 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.185 | L2-Norm(final)=3.762 | 6665.9 samples/s | 104.2 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.06125 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.090 | L2-Norm(final)=3.791 | 2225.9 samples/s | 34.8 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.04776 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.018 | L2-Norm(final)=3.812 | 5984.8 samples/s | 93.5 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.03847 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.957 | L2-Norm(final)=3.829 | 2307.2 samples/s | 36.0 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.03219 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.902 | L2-Norm(final)=3.842 | 5484.4 samples/s | 85.7 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.02762 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.848 | L2-Norm(final)=3.853 | 2340.6 samples/s | 36.6 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.02419 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.795 | L2-Norm(final)=3.861 | 5088.3 samples/s | 79.5 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.02151 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.742 | L2-Norm(final)=3.868 | 2455.7 samples/s | 38.4 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01936 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.690 | L2-Norm(final)=3.874 | 4718.6 samples/s | 73.7 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.01761 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.639 | L2-Norm(final)=3.879 | 2539.6 samples/s | 39.7 steps/s
[Step=1100 Epoch=10.4] | Loss=0.01614 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.588 | L2-Norm(final)=3.884 | 4679.3 samples/s | 73.1 steps/s
[Step=1150 Epoch=10.9] | Loss=0.01490 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.537 | L2-Norm(final)=3.888 | 2582.9 samples/s | 40.4 steps/s
[Step=1200 Epoch=11.4] | Loss=0.01384 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.487 | L2-Norm(final)=3.892 | 4634.9 samples/s | 72.4 steps/s
[Step=1250 Epoch=11.8] | Loss=0.01292 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.437 | L2-Norm(final)=3.895 | 2550.1 samples/s | 39.8 steps/s
[Step=1300 Epoch=12.3] | Loss=0.01211 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.388 | L2-Norm(final)=3.899 | 4645.0 samples/s | 72.6 steps/s
[Step=1350 Epoch=12.8] | Loss=0.01140 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.339 | L2-Norm(final)=3.902 | 2644.4 samples/s | 41.3 steps/s
[Step=1400 Epoch=13.3] | Loss=0.01077 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.290 | L2-Norm(final)=3.905 | 4407.2 samples/s | 68.9 steps/s
[Step=1450 Epoch=13.7] | Loss=0.01020 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.242 | L2-Norm(final)=3.908 | 6936.1 samples/s | 108.4 steps/s
[Step=1500 Epoch=14.2] | Loss=0.00969 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.194 | L2-Norm(final)=3.911 | 2173.8 samples/s | 34.0 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00923 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.147 | L2-Norm(final)=3.913 | 6262.2 samples/s | 97.8 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00881 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.100 | L2-Norm(final)=3.916 | 2260.6 samples/s | 35.3 steps/s
[Step=1650 Epoch=15.6] | Loss=0.00843 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.053 | L2-Norm(final)=3.918 | 5693.7 samples/s | 89.0 steps/s
[Step=1700 Epoch=16.1] | Loss=0.00808 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.006 | L2-Norm(final)=3.921 | 2332.4 samples/s | 36.4 steps/s
[Step=1750 Epoch=16.6] | Loss=0.00776 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.960 | L2-Norm(final)=3.923 | 5172.5 samples/s | 80.8 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00746 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.914 | L2-Norm(final)=3.926 | 2420.8 samples/s | 37.8 steps/s
[Step=1850 Epoch=17.5] | Loss=0.00718 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.868 | L2-Norm(final)=3.928 | 4848.9 samples/s | 75.8 steps/s
[Step=1900 Epoch=18.0] | Loss=0.00693 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.822 | L2-Norm(final)=3.930 | 2511.6 samples/s | 39.2 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00669 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.777 | L2-Norm(final)=3.932 | 4610.3 samples/s | 72.0 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00647 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.732 | L2-Norm(final)=3.935 | 2579.8 samples/s | 40.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step2000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34735 | Reg=0.00355 | acc=0.5938 | L2-Norm=18.840 | L2-Norm(final)=2.019 | 6163.6 samples/s | 96.3 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.31960 | Reg=0.00355 | acc=0.4844 | L2-Norm=18.840 | L2-Norm(final)=2.025 | 4751.8 samples/s | 74.2 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.30612 | Reg=0.00355 | acc=0.7812 | L2-Norm=18.840 | L2-Norm(final)=2.059 | 9882.4 samples/s | 154.4 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.29408 | Reg=0.00355 | acc=0.7500 | L2-Norm=18.840 | L2-Norm(final)=2.114 | 2492.8 samples/s | 38.9 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.28443 | Reg=0.00355 | acc=0.8438 | L2-Norm=18.840 | L2-Norm(final)=2.186 | 8384.7 samples/s | 131.0 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.27588 | Reg=0.00355 | acc=0.8438 | L2-Norm=18.840 | L2-Norm(final)=2.268 | 2556.5 samples/s | 39.9 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.26845 | Reg=0.00355 | acc=0.8750 | L2-Norm=18.840 | L2-Norm(final)=2.357 | 7651.7 samples/s | 119.6 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.26212 | Reg=0.00355 | acc=0.9219 | L2-Norm=18.840 | L2-Norm(final)=2.450 | 2708.5 samples/s | 42.3 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.25544 | Reg=0.00355 | acc=0.9219 | L2-Norm=18.840 | L2-Norm(final)=2.545 | 6539.5 samples/s | 102.2 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.24970 | Reg=0.00355 | acc=0.9062 | L2-Norm=18.840 | L2-Norm(final)=2.642 | 2866.3 samples/s | 44.8 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.24447 | Reg=0.00355 | acc=0.8594 | L2-Norm=18.840 | L2-Norm(final)=2.738 | 5909.8 samples/s | 92.3 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.8] | Loss=0.21653 | Reg=0.00355 | acc=0.8125 | L2-Norm=18.840 | L2-Norm(final)=3.706 | 5761.1 samples/s | 90.0 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.15709 | Reg=0.00339 | acc=0.9688 | L2-Norm=18.402 | L2-Norm(final)=3.722 | 4124.3 samples/s | 64.4 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.09327 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.287 | L2-Norm(final)=3.761 | 6710.7 samples/s | 104.9 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.06487 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.219 | L2-Norm(final)=3.795 | 2203.9 samples/s | 34.4 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.05008 | Reg=0.00330 | acc=0.9688 | L2-Norm=18.167 | L2-Norm(final)=3.821 | 6136.2 samples/s | 95.9 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.04159 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.126 | L2-Norm(final)=3.841 | 2276.2 samples/s | 35.6 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.03487 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.091 | L2-Norm(final)=3.857 | 5525.3 samples/s | 86.3 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.02995 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.055 | L2-Norm(final)=3.870 | 2349.7 samples/s | 36.7 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.02622 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.018 | L2-Norm(final)=3.881 | 5140.8 samples/s | 80.3 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.02332 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.979 | L2-Norm(final)=3.890 | 2469.8 samples/s | 38.6 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.02099 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.938 | L2-Norm(final)=3.897 | 4676.6 samples/s | 73.1 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01909 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.898 | L2-Norm(final)=3.904 | 2593.7 samples/s | 40.5 steps/s
[Step=1100 Epoch=10.5] | Loss=0.01750 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.857 | L2-Norm(final)=3.909 | 4520.1 samples/s | 70.6 steps/s
[Step=1150 Epoch=10.9] | Loss=0.01615 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.815 | L2-Norm(final)=3.915 | 2568.5 samples/s | 40.1 steps/s
[Step=1200 Epoch=11.4] | Loss=0.01500 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.774 | L2-Norm(final)=3.919 | 4628.8 samples/s | 72.3 steps/s
[Step=1250 Epoch=11.9] | Loss=0.01400 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.732 | L2-Norm(final)=3.923 | 2573.6 samples/s | 40.2 steps/s
[Step=1300 Epoch=12.4] | Loss=0.01313 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.690 | L2-Norm(final)=3.927 | 4643.9 samples/s | 72.6 steps/s
[Step=1350 Epoch=12.8] | Loss=0.01236 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.648 | L2-Norm(final)=3.931 | 2647.0 samples/s | 41.4 steps/s
[Step=1400 Epoch=13.3] | Loss=0.01167 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.606 | L2-Norm(final)=3.935 | 4481.0 samples/s | 70.0 steps/s
[Step=1450 Epoch=13.8] | Loss=0.01106 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.565 | L2-Norm(final)=3.938 | 6905.2 samples/s | 107.9 steps/s
[Step=1500 Epoch=14.3] | Loss=0.01051 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.523 | L2-Norm(final)=3.941 | 2189.7 samples/s | 34.2 steps/s
[Step=1550 Epoch=14.7] | Loss=0.01001 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.481 | L2-Norm(final)=3.945 | 6295.9 samples/s | 98.4 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00955 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.440 | L2-Norm(final)=3.948 | 2239.2 samples/s | 35.0 steps/s
[Step=1650 Epoch=15.7] | Loss=0.00914 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.398 | L2-Norm(final)=3.950 | 5780.6 samples/s | 90.3 steps/s
[Step=1700 Epoch=16.2] | Loss=0.00876 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.356 | L2-Norm(final)=3.953 | 2356.7 samples/s | 36.8 steps/s
[Step=1750 Epoch=16.6] | Loss=0.00841 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.315 | L2-Norm(final)=3.956 | 5133.5 samples/s | 80.2 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00808 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.274 | L2-Norm(final)=3.959 | 2438.6 samples/s | 38.1 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00778 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.232 | L2-Norm(final)=3.961 | 4866.3 samples/s | 76.0 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00751 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.191 | L2-Norm(final)=3.964 | 2497.2 samples/s | 39.0 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00725 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.150 | L2-Norm(final)=3.966 | 4670.3 samples/s | 73.0 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00701 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.109 | L2-Norm(final)=3.969 | 2587.7 samples/s | 40.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.34545 | acc=0.5387 | tpr=0.6026 | fpr=0.5999 | 5640.5 samples/s | 22.0 steps/s
Avg test loss: 0.34575, Avg test acc: 0.53746, Avg tpr: 0.59876, Avg fpr: 0.59736, total FA: 4660

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.16412 | acc=0.9158 | tpr=0.9193 | fpr=0.0919 | 5727.0 samples/s | 22.4 steps/s
Avg test loss: 0.16774, Avg test acc: 0.91313, Avg tpr: 0.91508, Avg fpr: 0.09114, total FA: 711

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.13114 | acc=0.9242 | tpr=0.9523 | fpr=0.1368 | 5810.9 samples/s | 22.7 steps/s
Avg test loss: 0.12938, Avg test acc: 0.92403, Avg tpr: 0.95092, Avg fpr: 0.13511, total FA: 1054

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.34545 | acc=0.5387 | tpr=0.6026 | fpr=0.5999 | 5796.2 samples/s | 22.6 steps/s
Avg test loss: 0.34575, Avg test acc: 0.53746, Avg tpr: 0.59876, Avg fpr: 0.59736, total FA: 4660

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.16401 | acc=0.9253 | tpr=0.9425 | fpr=0.1120 | 5655.9 samples/s | 22.1 steps/s
Avg test loss: 0.17138, Avg test acc: 0.92407, Avg tpr: 0.94212, Avg fpr: 0.11563, total FA: 902

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.93319 | acc=0.3120 | tpr=0.0274 | fpr=0.0701 | 5693.1 samples/s | 22.2 steps/s
Avg test loss: 4.96738, Avg test acc: 0.31024, Avg tpr: 0.02734, Avg fpr: 0.06756, total FA: 527

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.28296 | acc=0.3163 | tpr=0.0230 | fpr=0.0468 | 5737.1 samples/s | 22.4 steps/s
Avg test loss: 5.30874, Avg test acc: 0.31485, Avg tpr: 0.02390, Avg fpr: 0.04525, total FA: 353

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=0.34545 | acc=0.5387 | tpr=0.6026 | fpr=0.5999 | 5728.5 samples/s | 22.4 steps/s
Avg test loss: 0.34575, Avg test acc: 0.53746, Avg tpr: 0.59876, Avg fpr: 0.59736, total FA: 4660

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=0.34545 | acc=0.5387 | tpr=0.6026 | fpr=0.5999 | 5373.6 samples/s | 21.0 steps/s
Avg test loss: 0.34575, Avg test acc: 0.53746, Avg tpr: 0.59876, Avg fpr: 0.59736, total FA: 4660

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=0.34545 | acc=0.5387 | tpr=0.6026 | fpr=0.5999 | 5648.1 samples/s | 22.1 steps/s
Avg test loss: 0.34575, Avg test acc: 0.53746, Avg tpr: 0.59876, Avg fpr: 0.59736, total FA: 4660

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=0.34849 | acc=0.5070 | tpr=0.4646 | fpr=0.4923 | 5475.2 samples/s | 21.4 steps/s
[Step= 100] | Loss=0.34895 | acc=0.5004 | tpr=0.4478 | fpr=0.4986 | 8158.9 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.34884 | acc=0.4999 | tpr=0.4481 | fpr=0.4991 | 8325.3 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.34876 | acc=0.5004 | tpr=0.4448 | fpr=0.4986 | 8101.4 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.34867 | acc=0.5013 | tpr=0.4498 | fpr=0.4977 | 8059.3 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.34870 | acc=0.5011 | tpr=0.4407 | fpr=0.4978 | 8136.3 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.34866 | acc=0.5011 | tpr=0.4477 | fpr=0.4979 | 8294.0 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.34860 | acc=0.5016 | tpr=0.4437 | fpr=0.4974 | 7278.0 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.34857 | acc=0.5017 | tpr=0.4426 | fpr=0.4973 | 8953.2 samples/s | 35.0 steps/s
[Step= 500] | Loss=0.34852 | acc=0.5023 | tpr=0.4454 | fpr=0.4966 | 7916.8 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.34852 | acc=0.5026 | tpr=0.4441 | fpr=0.4963 | 9956.6 samples/s | 38.9 steps/s
Avg test loss: 0.34853, Avg test acc: 0.50255, Avg tpr: 0.44453, Avg fpr: 0.49640, total FA: 68924

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.42444 | acc=0.1619 | tpr=0.6195 | fpr=0.8463 | 5769.9 samples/s | 22.5 steps/s
[Step= 100] | Loss=3.41380 | acc=0.1654 | tpr=0.6290 | fpr=0.8433 | 8109.5 samples/s | 31.7 steps/s
[Step= 150] | Loss=3.41714 | acc=0.1646 | tpr=0.6066 | fpr=0.8436 | 7601.6 samples/s | 29.7 steps/s
[Step= 200] | Loss=3.42099 | acc=0.1651 | tpr=0.5956 | fpr=0.8427 | 8229.8 samples/s | 32.1 steps/s
[Step= 250] | Loss=3.42071 | acc=0.1663 | tpr=0.5991 | fpr=0.8416 | 8589.9 samples/s | 33.6 steps/s
[Step= 300] | Loss=3.42623 | acc=0.1656 | tpr=0.6007 | fpr=0.8424 | 8127.8 samples/s | 31.7 steps/s
[Step= 350] | Loss=3.42962 | acc=0.1654 | tpr=0.5861 | fpr=0.8422 | 7722.5 samples/s | 30.2 steps/s
[Step= 400] | Loss=3.43621 | acc=0.1656 | tpr=0.5881 | fpr=0.8421 | 7656.5 samples/s | 29.9 steps/s
[Step= 450] | Loss=3.43396 | acc=0.1655 | tpr=0.5915 | fpr=0.8422 | 8393.3 samples/s | 32.8 steps/s
[Step= 500] | Loss=3.43893 | acc=0.1654 | tpr=0.5872 | fpr=0.8422 | 8257.0 samples/s | 32.3 steps/s
[Step= 550] | Loss=3.43518 | acc=0.1657 | tpr=0.5846 | fpr=0.8419 | 9821.8 samples/s | 38.4 steps/s
Avg test loss: 3.43533, Avg test acc: 0.16563, Avg tpr: 0.58479, Avg fpr: 0.84199, total FA: 116909

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=3.72995 | acc=0.0880 | tpr=0.8496 | fpr=0.9256 | 5647.3 samples/s | 22.1 steps/s
[Step= 100] | Loss=3.71671 | acc=0.0899 | tpr=0.8593 | fpr=0.9244 | 8278.6 samples/s | 32.3 steps/s
[Step= 150] | Loss=3.72620 | acc=0.0899 | tpr=0.8415 | fpr=0.9240 | 7598.7 samples/s | 29.7 steps/s
[Step= 200] | Loss=3.72007 | acc=0.0900 | tpr=0.8273 | fpr=0.9234 | 8369.2 samples/s | 32.7 steps/s
[Step= 250] | Loss=3.72939 | acc=0.0906 | tpr=0.8349 | fpr=0.9230 | 8132.2 samples/s | 31.8 steps/s
[Step= 300] | Loss=3.73064 | acc=0.0896 | tpr=0.8327 | fpr=0.9239 | 8320.1 samples/s | 32.5 steps/s
[Step= 350] | Loss=3.73137 | acc=0.0887 | tpr=0.8228 | fpr=0.9247 | 7516.4 samples/s | 29.4 steps/s
[Step= 400] | Loss=3.73383 | acc=0.0887 | tpr=0.8239 | fpr=0.9246 | 8151.2 samples/s | 31.8 steps/s
[Step= 450] | Loss=3.73280 | acc=0.0885 | tpr=0.8189 | fpr=0.9247 | 8126.2 samples/s | 31.7 steps/s
[Step= 500] | Loss=3.73580 | acc=0.0884 | tpr=0.8185 | fpr=0.9248 | 8044.2 samples/s | 31.4 steps/s
[Step= 550] | Loss=3.73270 | acc=0.0886 | tpr=0.8193 | fpr=0.9246 | 10693.7 samples/s | 41.8 steps/s
Avg test loss: 3.73261, Avg test acc: 0.08863, Avg tpr: 0.81973, Avg fpr: 0.92466, total FA: 128387

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=0.34849 | acc=0.5070 | tpr=0.4646 | fpr=0.4923 | 5675.6 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.34895 | acc=0.5004 | tpr=0.4478 | fpr=0.4986 | 7730.0 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.34884 | acc=0.4999 | tpr=0.4481 | fpr=0.4991 | 7895.0 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.34876 | acc=0.5004 | tpr=0.4448 | fpr=0.4986 | 8008.2 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.34867 | acc=0.5013 | tpr=0.4498 | fpr=0.4977 | 8306.6 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.34870 | acc=0.5011 | tpr=0.4407 | fpr=0.4978 | 7682.0 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.34866 | acc=0.5011 | tpr=0.4477 | fpr=0.4979 | 8808.1 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.34860 | acc=0.5016 | tpr=0.4437 | fpr=0.4974 | 7892.9 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.34857 | acc=0.5017 | tpr=0.4426 | fpr=0.4973 | 8041.7 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.34852 | acc=0.5023 | tpr=0.4454 | fpr=0.4966 | 8416.4 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.34852 | acc=0.5026 | tpr=0.4441 | fpr=0.4963 | 10355.0 samples/s | 40.4 steps/s
Avg test loss: 0.34853, Avg test acc: 0.50255, Avg tpr: 0.44453, Avg fpr: 0.49640, total FA: 68924

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.25555 | acc=0.1416 | tpr=0.7257 | fpr=0.8689 | 5789.1 samples/s | 22.6 steps/s
[Step= 100] | Loss=4.24850 | acc=0.1417 | tpr=0.6908 | fpr=0.8685 | 7702.0 samples/s | 30.1 steps/s
[Step= 150] | Loss=4.27121 | acc=0.1410 | tpr=0.6816 | fpr=0.8689 | 7540.4 samples/s | 29.5 steps/s
[Step= 200] | Loss=4.27083 | acc=0.1411 | tpr=0.6842 | fpr=0.8688 | 8393.7 samples/s | 32.8 steps/s
[Step= 250] | Loss=4.27488 | acc=0.1411 | tpr=0.6891 | fpr=0.8689 | 7850.8 samples/s | 30.7 steps/s
[Step= 300] | Loss=4.27250 | acc=0.1408 | tpr=0.6880 | fpr=0.8691 | 8116.4 samples/s | 31.7 steps/s
[Step= 350] | Loss=4.27450 | acc=0.1407 | tpr=0.6807 | fpr=0.8691 | 7881.7 samples/s | 30.8 steps/s
[Step= 400] | Loss=4.27459 | acc=0.1410 | tpr=0.6800 | fpr=0.8688 | 8242.2 samples/s | 32.2 steps/s
[Step= 450] | Loss=4.27465 | acc=0.1411 | tpr=0.6816 | fpr=0.8687 | 7844.7 samples/s | 30.6 steps/s
[Step= 500] | Loss=4.27912 | acc=0.1408 | tpr=0.6828 | fpr=0.8690 | 7718.3 samples/s | 30.1 steps/s
[Step= 550] | Loss=4.27871 | acc=0.1407 | tpr=0.6793 | fpr=0.8691 | 12326.4 samples/s | 48.1 steps/s
Avg test loss: 4.27852, Avg test acc: 0.14064, Avg tpr: 0.67948, Avg fpr: 0.86915, total FA: 120680

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.06032 | acc=0.9810 | tpr=0.8938 | fpr=0.0174 | 5556.2 samples/s | 21.7 steps/s
[Step= 100] | Loss=0.05949 | acc=0.9813 | tpr=0.9211 | fpr=0.0176 | 8382.4 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.06119 | acc=0.9805 | tpr=0.9207 | fpr=0.0184 | 7984.8 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.06072 | acc=0.9804 | tpr=0.9268 | fpr=0.0186 | 7850.3 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.06040 | acc=0.9803 | tpr=0.9223 | fpr=0.0187 | 8010.8 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.06047 | acc=0.9800 | tpr=0.9207 | fpr=0.0189 | 8057.3 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.06070 | acc=0.9799 | tpr=0.9211 | fpr=0.0191 | 7859.1 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.06122 | acc=0.9798 | tpr=0.9207 | fpr=0.0192 | 8400.1 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.06217 | acc=0.9794 | tpr=0.9187 | fpr=0.0195 | 8107.5 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.06167 | acc=0.9795 | tpr=0.9211 | fpr=0.0194 | 7676.1 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.06143 | acc=0.9796 | tpr=0.9232 | fpr=0.0194 | 11084.7 samples/s | 43.3 steps/s
Avg test loss: 0.06139, Avg test acc: 0.97959, Avg tpr: 0.92314, Avg fpr: 0.01939, total FA: 2692

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.05304 | acc=0.9816 | tpr=0.8540 | fpr=0.0161 | 5621.9 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.05436 | acc=0.9812 | tpr=0.8678 | fpr=0.0167 | 7988.5 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.05561 | acc=0.9808 | tpr=0.8674 | fpr=0.0171 | 8183.6 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.05603 | acc=0.9807 | tpr=0.8732 | fpr=0.0173 | 8128.3 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.05609 | acc=0.9807 | tpr=0.8690 | fpr=0.0173 | 8046.2 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.05624 | acc=0.9805 | tpr=0.8655 | fpr=0.0174 | 7685.3 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.05637 | acc=0.9806 | tpr=0.8691 | fpr=0.0174 | 7638.4 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.05695 | acc=0.9803 | tpr=0.8671 | fpr=0.0176 | 8371.2 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.05768 | acc=0.9801 | tpr=0.8651 | fpr=0.0178 | 8059.5 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.05738 | acc=0.9802 | tpr=0.8692 | fpr=0.0178 | 8132.0 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.05685 | acc=0.9803 | tpr=0.8695 | fpr=0.0177 | 10846.2 samples/s | 42.4 steps/s
Avg test loss: 0.05670, Avg test acc: 0.98034, Avg tpr: 0.86965, Avg fpr: 0.01765, total FA: 2450

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.34849 | acc=0.5070 | tpr=0.4646 | fpr=0.4923 | 5687.1 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.34895 | acc=0.5004 | tpr=0.4478 | fpr=0.4986 | 8454.5 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.34884 | acc=0.4999 | tpr=0.4481 | fpr=0.4991 | 7595.6 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.34876 | acc=0.5004 | tpr=0.4448 | fpr=0.4986 | 8232.3 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.34867 | acc=0.5013 | tpr=0.4498 | fpr=0.4977 | 8116.5 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.34870 | acc=0.5011 | tpr=0.4407 | fpr=0.4978 | 7881.1 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.34866 | acc=0.5011 | tpr=0.4477 | fpr=0.4979 | 8216.7 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.34860 | acc=0.5016 | tpr=0.4437 | fpr=0.4974 | 7758.3 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.34857 | acc=0.5017 | tpr=0.4426 | fpr=0.4973 | 8677.1 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.34852 | acc=0.5023 | tpr=0.4454 | fpr=0.4966 | 8310.2 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.34852 | acc=0.5026 | tpr=0.4441 | fpr=0.4963 | 9332.8 samples/s | 36.5 steps/s
Avg test loss: 0.34853, Avg test acc: 0.50255, Avg tpr: 0.44453, Avg fpr: 0.49640, total FA: 68924

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.34849 | acc=0.5070 | tpr=0.4646 | fpr=0.4923 | 5728.5 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.34895 | acc=0.5004 | tpr=0.4478 | fpr=0.4986 | 7975.0 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.34884 | acc=0.4999 | tpr=0.4481 | fpr=0.4991 | 8400.1 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.34876 | acc=0.5004 | tpr=0.4448 | fpr=0.4986 | 7822.9 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.34867 | acc=0.5013 | tpr=0.4498 | fpr=0.4977 | 8369.2 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.34870 | acc=0.5011 | tpr=0.4407 | fpr=0.4978 | 7563.7 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.34866 | acc=0.5011 | tpr=0.4477 | fpr=0.4979 | 8470.9 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.34860 | acc=0.5016 | tpr=0.4437 | fpr=0.4974 | 7980.0 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.34857 | acc=0.5017 | tpr=0.4426 | fpr=0.4973 | 8226.5 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.34852 | acc=0.5023 | tpr=0.4454 | fpr=0.4966 | 7739.1 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.34852 | acc=0.5026 | tpr=0.4441 | fpr=0.4963 | 10166.9 samples/s | 39.7 steps/s
Avg test loss: 0.34853, Avg test acc: 0.50255, Avg tpr: 0.44453, Avg fpr: 0.49640, total FA: 68924

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.34849 | acc=0.5070 | tpr=0.4646 | fpr=0.4923 | 5845.2 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.34895 | acc=0.5004 | tpr=0.4478 | fpr=0.4986 | 7744.5 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.34884 | acc=0.4999 | tpr=0.4481 | fpr=0.4991 | 7290.9 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.34876 | acc=0.5004 | tpr=0.4448 | fpr=0.4986 | 8613.3 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.34867 | acc=0.5013 | tpr=0.4498 | fpr=0.4977 | 8254.8 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.34870 | acc=0.5011 | tpr=0.4407 | fpr=0.4978 | 8444.2 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.34866 | acc=0.5011 | tpr=0.4477 | fpr=0.4979 | 8165.5 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.34860 | acc=0.5016 | tpr=0.4437 | fpr=0.4974 | 8198.6 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.34857 | acc=0.5017 | tpr=0.4426 | fpr=0.4973 | 7738.0 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.34852 | acc=0.5023 | tpr=0.4454 | fpr=0.4966 | 7755.4 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.34852 | acc=0.5026 | tpr=0.4441 | fpr=0.4963 | 10341.8 samples/s | 40.4 steps/s
Avg test loss: 0.34853, Avg test acc: 0.50255, Avg tpr: 0.44453, Avg fpr: 0.49640, total FA: 68924

server round 1/50

clients selected: [1 2 4 5 6]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.20119 | Reg=0.00282 | acc=0.8906 | L2-Norm=16.792 | L2-Norm(final)=3.139 | 6526.8 samples/s | 102.0 steps/s
[Step=2050 Epoch=10.0] | Loss=0.22707 | Reg=0.00282 | acc=0.8125 | L2-Norm=16.787 | L2-Norm(final)=3.189 | 4607.2 samples/s | 72.0 steps/s
[Step=2100 Epoch=10.2] | Loss=0.22122 | Reg=0.00282 | acc=0.9062 | L2-Norm=16.787 | L2-Norm(final)=3.265 | 5638.9 samples/s | 88.1 steps/s
[Step=2150 Epoch=10.5] | Loss=0.22014 | Reg=0.00282 | acc=0.7969 | L2-Norm=16.787 | L2-Norm(final)=3.339 | 5716.6 samples/s | 89.3 steps/s
[Step=2200 Epoch=10.7] | Loss=0.21823 | Reg=0.00282 | acc=0.7656 | L2-Norm=16.787 | L2-Norm(final)=3.410 | 8649.2 samples/s | 135.1 steps/s
[Step=2250 Epoch=11.0] | Loss=0.21551 | Reg=0.00282 | acc=0.8594 | L2-Norm=16.787 | L2-Norm(final)=3.480 | 2386.3 samples/s | 37.3 steps/s
[Step=2300 Epoch=11.2] | Loss=0.21470 | Reg=0.00282 | acc=0.7969 | L2-Norm=16.787 | L2-Norm(final)=3.547 | 5689.2 samples/s | 88.9 steps/s
[Step=2350 Epoch=11.5] | Loss=0.21314 | Reg=0.00282 | acc=0.8906 | L2-Norm=16.787 | L2-Norm(final)=3.612 | 5637.0 samples/s | 88.1 steps/s
[Step=2400 Epoch=11.7] | Loss=0.21192 | Reg=0.00282 | acc=0.9219 | L2-Norm=16.787 | L2-Norm(final)=3.675 | 7879.3 samples/s | 123.1 steps/s
[Step=2450 Epoch=12.0] | Loss=0.21090 | Reg=0.00282 | acc=0.7656 | L2-Norm=16.787 | L2-Norm(final)=3.736 | 2502.0 samples/s | 39.1 steps/s
[Step=2500 Epoch=12.2] | Loss=0.20921 | Reg=0.00282 | acc=0.8594 | L2-Norm=16.787 | L2-Norm(final)=3.797 | 5731.8 samples/s | 89.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.26229 | Reg=0.00282 | acc=0.7031 | L2-Norm=16.787 | L2-Norm(final)=4.397 | 6098.7 samples/s | 95.3 steps/s
[Step=2550 Epoch=12.4] | Loss=0.19358 | Reg=0.00287 | acc=0.8750 | L2-Norm=16.928 | L2-Norm(final)=4.386 | 4256.2 samples/s | 66.5 steps/s
[Step=2600 Epoch=12.7] | Loss=0.16568 | Reg=0.00289 | acc=0.8281 | L2-Norm=17.005 | L2-Norm(final)=4.377 | 4862.6 samples/s | 76.0 steps/s
[Step=2650 Epoch=12.9] | Loss=0.15474 | Reg=0.00290 | acc=0.9219 | L2-Norm=17.033 | L2-Norm(final)=4.371 | 4836.8 samples/s | 75.6 steps/s
[Step=2700 Epoch=13.2] | Loss=0.14363 | Reg=0.00291 | acc=0.9688 | L2-Norm=17.049 | L2-Norm(final)=4.369 | 7043.5 samples/s | 110.1 steps/s
[Step=2750 Epoch=13.4] | Loss=0.12792 | Reg=0.00291 | acc=0.9531 | L2-Norm=17.062 | L2-Norm(final)=4.371 | 2285.6 samples/s | 35.7 steps/s
[Step=2800 Epoch=13.7] | Loss=0.11830 | Reg=0.00292 | acc=0.9531 | L2-Norm=17.074 | L2-Norm(final)=4.375 | 4752.6 samples/s | 74.3 steps/s
[Step=2850 Epoch=13.9] | Loss=0.11041 | Reg=0.00292 | acc=0.9375 | L2-Norm=17.087 | L2-Norm(final)=4.380 | 4863.2 samples/s | 76.0 steps/s
[Step=2900 Epoch=14.2] | Loss=0.10603 | Reg=0.00292 | acc=0.9688 | L2-Norm=17.097 | L2-Norm(final)=4.383 | 6505.1 samples/s | 101.6 steps/s
[Step=2950 Epoch=14.4] | Loss=0.09907 | Reg=0.00293 | acc=0.9375 | L2-Norm=17.108 | L2-Norm(final)=4.386 | 2328.8 samples/s | 36.4 steps/s
[Step=3000 Epoch=14.6] | Loss=0.09385 | Reg=0.00293 | acc=0.9688 | L2-Norm=17.118 | L2-Norm(final)=4.391 | 4810.1 samples/s | 75.2 steps/s
[Step=3050 Epoch=14.9] | Loss=0.08923 | Reg=0.00293 | acc=0.9688 | L2-Norm=17.128 | L2-Norm(final)=4.395 | 4910.5 samples/s | 76.7 steps/s
[Step=3100 Epoch=15.1] | Loss=0.08634 | Reg=0.00294 | acc=0.9844 | L2-Norm=17.137 | L2-Norm(final)=4.399 | 5922.0 samples/s | 92.5 steps/s
[Step=3150 Epoch=15.4] | Loss=0.08232 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.148 | L2-Norm(final)=4.403 | 2389.6 samples/s | 37.3 steps/s
[Step=3200 Epoch=15.6] | Loss=0.07834 | Reg=0.00294 | acc=0.9844 | L2-Norm=17.157 | L2-Norm(final)=4.406 | 4818.6 samples/s | 75.3 steps/s
[Step=3250 Epoch=15.9] | Loss=0.07530 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.166 | L2-Norm(final)=4.410 | 4828.7 samples/s | 75.4 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07290 | Reg=0.00295 | acc=0.8906 | L2-Norm=17.173 | L2-Norm(final)=4.414 | 5620.1 samples/s | 87.8 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07017 | Reg=0.00295 | acc=0.9844 | L2-Norm=17.182 | L2-Norm(final)=4.417 | 2453.4 samples/s | 38.3 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06739 | Reg=0.00295 | acc=0.9844 | L2-Norm=17.189 | L2-Norm(final)=4.421 | 4883.4 samples/s | 76.3 steps/s
[Step=3450 Epoch=16.8] | Loss=0.06529 | Reg=0.00296 | acc=0.9531 | L2-Norm=17.196 | L2-Norm(final)=4.424 | 4811.4 samples/s | 75.2 steps/s
[Step=3500 Epoch=17.1] | Loss=0.06405 | Reg=0.00296 | acc=0.9844 | L2-Norm=17.203 | L2-Norm(final)=4.427 | 5248.5 samples/s | 82.0 steps/s
[Step=3550 Epoch=17.3] | Loss=0.06286 | Reg=0.00296 | acc=0.9844 | L2-Norm=17.210 | L2-Norm(final)=4.428 | 2555.1 samples/s | 39.9 steps/s
[Step=3600 Epoch=17.6] | Loss=0.06103 | Reg=0.00296 | acc=0.9844 | L2-Norm=17.217 | L2-Norm(final)=4.430 | 4894.5 samples/s | 76.5 steps/s
[Step=3650 Epoch=17.8] | Loss=0.05932 | Reg=0.00297 | acc=0.9688 | L2-Norm=17.224 | L2-Norm(final)=4.433 | 4722.3 samples/s | 73.8 steps/s
[Step=3700 Epoch=18.1] | Loss=0.05801 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.230 | L2-Norm(final)=4.435 | 4972.8 samples/s | 77.7 steps/s
[Step=3750 Epoch=18.3] | Loss=0.05676 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.235 | L2-Norm(final)=4.437 | 2615.4 samples/s | 40.9 steps/s
[Step=3800 Epoch=18.5] | Loss=0.05536 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.240 | L2-Norm(final)=4.438 | 4913.8 samples/s | 76.8 steps/s
[Step=3850 Epoch=18.8] | Loss=0.05401 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.244 | L2-Norm(final)=4.440 | 4807.2 samples/s | 75.1 steps/s
[Step=3900 Epoch=19.0] | Loss=0.05294 | Reg=0.00297 | acc=0.9688 | L2-Norm=17.248 | L2-Norm(final)=4.442 | 4860.2 samples/s | 75.9 steps/s
[Step=3950 Epoch=19.3] | Loss=0.05175 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.251 | L2-Norm(final)=4.444 | 2614.4 samples/s | 40.9 steps/s
[Step=4000 Epoch=19.5] | Loss=0.05049 | Reg=0.00298 | acc=0.9844 | L2-Norm=17.253 | L2-Norm(final)=4.445 | 4877.7 samples/s | 76.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step4000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 9.7] | Loss=0.20978 | Reg=0.00282 | acc=0.8281 | L2-Norm=16.792 | L2-Norm(final)=3.194 | 5589.6 samples/s | 87.3 steps/s
[Step=2050 Epoch=10.0] | Loss=0.22892 | Reg=0.00282 | acc=0.8125 | L2-Norm=16.789 | L2-Norm(final)=3.248 | 5165.7 samples/s | 80.7 steps/s
[Step=2100 Epoch=10.2] | Loss=0.22828 | Reg=0.00282 | acc=0.8438 | L2-Norm=16.789 | L2-Norm(final)=3.315 | 5624.6 samples/s | 87.9 steps/s
[Step=2150 Epoch=10.5] | Loss=0.22647 | Reg=0.00282 | acc=0.7500 | L2-Norm=16.789 | L2-Norm(final)=3.384 | 5606.5 samples/s | 87.6 steps/s
[Step=2200 Epoch=10.7] | Loss=0.22377 | Reg=0.00282 | acc=0.8125 | L2-Norm=16.789 | L2-Norm(final)=3.452 | 8533.1 samples/s | 133.3 steps/s
[Step=2250 Epoch=11.0] | Loss=0.22180 | Reg=0.00282 | acc=0.7812 | L2-Norm=16.789 | L2-Norm(final)=3.521 | 2473.0 samples/s | 38.6 steps/s
[Step=2300 Epoch=11.2] | Loss=0.22023 | Reg=0.00282 | acc=0.8281 | L2-Norm=16.789 | L2-Norm(final)=3.589 | 5451.7 samples/s | 85.2 steps/s
[Step=2350 Epoch=11.5] | Loss=0.21935 | Reg=0.00282 | acc=0.8594 | L2-Norm=16.789 | L2-Norm(final)=3.656 | 5729.5 samples/s | 89.5 steps/s
[Step=2400 Epoch=11.7] | Loss=0.21784 | Reg=0.00282 | acc=0.8594 | L2-Norm=16.789 | L2-Norm(final)=3.720 | 7667.5 samples/s | 119.8 steps/s
[Step=2450 Epoch=11.9] | Loss=0.21756 | Reg=0.00282 | acc=0.7500 | L2-Norm=16.789 | L2-Norm(final)=3.783 | 2521.3 samples/s | 39.4 steps/s
[Step=2500 Epoch=12.2] | Loss=0.21653 | Reg=0.00282 | acc=0.8281 | L2-Norm=16.789 | L2-Norm(final)=3.844 | 5629.5 samples/s | 88.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.18870 | Reg=0.00282 | acc=0.8438 | L2-Norm=16.789 | L2-Norm(final)=4.456 | 5551.3 samples/s | 86.7 steps/s
[Step=2550 Epoch=12.4] | Loss=0.19489 | Reg=0.00288 | acc=0.9062 | L2-Norm=16.966 | L2-Norm(final)=4.440 | 4585.7 samples/s | 71.7 steps/s
[Step=2600 Epoch=12.7] | Loss=0.17523 | Reg=0.00292 | acc=0.8906 | L2-Norm=17.077 | L2-Norm(final)=4.429 | 4833.3 samples/s | 75.5 steps/s
[Step=2650 Epoch=12.9] | Loss=0.15614 | Reg=0.00293 | acc=0.9062 | L2-Norm=17.118 | L2-Norm(final)=4.425 | 4852.9 samples/s | 75.8 steps/s
[Step=2700 Epoch=13.2] | Loss=0.14244 | Reg=0.00294 | acc=0.9531 | L2-Norm=17.139 | L2-Norm(final)=4.426 | 7003.5 samples/s | 109.4 steps/s
[Step=2750 Epoch=13.4] | Loss=0.12989 | Reg=0.00294 | acc=0.9219 | L2-Norm=17.160 | L2-Norm(final)=4.427 | 2287.5 samples/s | 35.7 steps/s
[Step=2800 Epoch=13.6] | Loss=0.11941 | Reg=0.00295 | acc=0.9531 | L2-Norm=17.179 | L2-Norm(final)=4.429 | 4773.0 samples/s | 74.6 steps/s
[Step=2850 Epoch=13.9] | Loss=0.11179 | Reg=0.00296 | acc=0.9844 | L2-Norm=17.193 | L2-Norm(final)=4.433 | 4889.0 samples/s | 76.4 steps/s
[Step=2900 Epoch=14.1] | Loss=0.10729 | Reg=0.00296 | acc=0.9688 | L2-Norm=17.206 | L2-Norm(final)=4.435 | 6343.5 samples/s | 99.1 steps/s
[Step=2950 Epoch=14.4] | Loss=0.10037 | Reg=0.00296 | acc=0.9844 | L2-Norm=17.218 | L2-Norm(final)=4.436 | 2364.1 samples/s | 36.9 steps/s
[Step=3000 Epoch=14.6] | Loss=0.09453 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.229 | L2-Norm(final)=4.440 | 4816.6 samples/s | 75.3 steps/s
[Step=3050 Epoch=14.9] | Loss=0.09053 | Reg=0.00297 | acc=0.9219 | L2-Norm=17.238 | L2-Norm(final)=4.443 | 4882.0 samples/s | 76.3 steps/s
[Step=3100 Epoch=15.1] | Loss=0.08691 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.247 | L2-Norm(final)=4.445 | 5769.6 samples/s | 90.2 steps/s
[Step=3150 Epoch=15.3] | Loss=0.08263 | Reg=0.00298 | acc=0.9844 | L2-Norm=17.255 | L2-Norm(final)=4.448 | 2458.3 samples/s | 38.4 steps/s
[Step=3200 Epoch=15.6] | Loss=0.07930 | Reg=0.00298 | acc=0.9531 | L2-Norm=17.262 | L2-Norm(final)=4.451 | 4810.7 samples/s | 75.2 steps/s
[Step=3250 Epoch=15.8] | Loss=0.07629 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.270 | L2-Norm(final)=4.454 | 4878.4 samples/s | 76.2 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07380 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.277 | L2-Norm(final)=4.458 | 5343.6 samples/s | 83.5 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07092 | Reg=0.00299 | acc=0.9688 | L2-Norm=17.285 | L2-Norm(final)=4.461 | 2504.2 samples/s | 39.1 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06872 | Reg=0.00299 | acc=0.9688 | L2-Norm=17.293 | L2-Norm(final)=4.466 | 4850.5 samples/s | 75.8 steps/s
[Step=3450 Epoch=16.8] | Loss=0.06641 | Reg=0.00299 | acc=0.9531 | L2-Norm=17.301 | L2-Norm(final)=4.469 | 4900.3 samples/s | 76.6 steps/s
[Step=3500 Epoch=17.1] | Loss=0.06452 | Reg=0.00300 | acc=0.9531 | L2-Norm=17.309 | L2-Norm(final)=4.473 | 4966.7 samples/s | 77.6 steps/s
[Step=3550 Epoch=17.3] | Loss=0.06258 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.316 | L2-Norm(final)=4.477 | 2616.8 samples/s | 40.9 steps/s
[Step=3600 Epoch=17.5] | Loss=0.06099 | Reg=0.00300 | acc=0.9688 | L2-Norm=17.322 | L2-Norm(final)=4.480 | 4868.4 samples/s | 76.1 steps/s
[Step=3650 Epoch=17.8] | Loss=0.05963 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.328 | L2-Norm(final)=4.483 | 4846.3 samples/s | 75.7 steps/s
[Step=3700 Epoch=18.0] | Loss=0.05851 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.335 | L2-Norm(final)=4.485 | 4954.7 samples/s | 77.4 steps/s
[Step=3750 Epoch=18.3] | Loss=0.05705 | Reg=0.00301 | acc=0.9844 | L2-Norm=17.342 | L2-Norm(final)=4.488 | 2625.1 samples/s | 41.0 steps/s
[Step=3800 Epoch=18.5] | Loss=0.05567 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.348 | L2-Norm(final)=4.490 | 4819.1 samples/s | 75.3 steps/s
[Step=3850 Epoch=18.8] | Loss=0.05439 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.354 | L2-Norm(final)=4.493 | 4912.7 samples/s | 76.8 steps/s
[Step=3900 Epoch=19.0] | Loss=0.05321 | Reg=0.00301 | acc=0.9688 | L2-Norm=17.359 | L2-Norm(final)=4.496 | 4836.8 samples/s | 75.6 steps/s
[Step=3950 Epoch=19.2] | Loss=0.05196 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.364 | L2-Norm(final)=4.498 | 2643.4 samples/s | 41.3 steps/s
[Step=4000 Epoch=19.5] | Loss=0.05087 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.368 | L2-Norm(final)=4.501 | 4818.2 samples/s | 75.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step4000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.22570 | Reg=0.00282 | acc=0.8125 | L2-Norm=16.792 | L2-Norm(final)=3.161 | 5794.1 samples/s | 90.5 steps/s
[Step=2050 Epoch=10.1] | Loss=0.22630 | Reg=0.00282 | acc=0.8281 | L2-Norm=16.786 | L2-Norm(final)=3.236 | 5110.2 samples/s | 79.8 steps/s
[Step=2100 Epoch=10.3] | Loss=0.22081 | Reg=0.00282 | acc=0.8438 | L2-Norm=16.785 | L2-Norm(final)=3.344 | 5570.1 samples/s | 87.0 steps/s
[Step=2150 Epoch=10.5] | Loss=0.21748 | Reg=0.00282 | acc=0.8594 | L2-Norm=16.785 | L2-Norm(final)=3.446 | 5597.3 samples/s | 87.5 steps/s
[Step=2200 Epoch=10.8] | Loss=0.21345 | Reg=0.00282 | acc=0.8594 | L2-Norm=16.785 | L2-Norm(final)=3.545 | 9013.8 samples/s | 140.8 steps/s
[Step=2250 Epoch=11.0] | Loss=0.21127 | Reg=0.00282 | acc=0.8438 | L2-Norm=16.785 | L2-Norm(final)=3.641 | 2423.2 samples/s | 37.9 steps/s
[Step=2300 Epoch=11.3] | Loss=0.21020 | Reg=0.00282 | acc=0.8281 | L2-Norm=16.785 | L2-Norm(final)=3.730 | 5552.1 samples/s | 86.8 steps/s
[Step=2350 Epoch=11.5] | Loss=0.20882 | Reg=0.00282 | acc=0.8906 | L2-Norm=16.785 | L2-Norm(final)=3.816 | 5580.2 samples/s | 87.2 steps/s
[Step=2400 Epoch=11.8] | Loss=0.20735 | Reg=0.00282 | acc=0.9062 | L2-Norm=16.785 | L2-Norm(final)=3.899 | 8332.0 samples/s | 130.2 steps/s
[Step=2450 Epoch=12.0] | Loss=0.20607 | Reg=0.00282 | acc=0.8438 | L2-Norm=16.785 | L2-Norm(final)=3.978 | 2450.1 samples/s | 38.3 steps/s
[Step=2500 Epoch=12.3] | Loss=0.20436 | Reg=0.00282 | acc=0.8438 | L2-Norm=16.785 | L2-Norm(final)=4.055 | 5717.0 samples/s | 89.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.3] | Loss=0.18369 | Reg=0.00282 | acc=0.8125 | L2-Norm=16.785 | L2-Norm(final)=4.811 | 5393.6 samples/s | 84.3 steps/s
[Step=2550 Epoch=12.5] | Loss=0.18245 | Reg=0.00287 | acc=0.8125 | L2-Norm=16.949 | L2-Norm(final)=4.801 | 4707.4 samples/s | 73.6 steps/s
[Step=2600 Epoch=12.7] | Loss=0.17028 | Reg=0.00290 | acc=0.9219 | L2-Norm=17.026 | L2-Norm(final)=4.794 | 4857.0 samples/s | 75.9 steps/s
[Step=2650 Epoch=13.0] | Loss=0.15307 | Reg=0.00291 | acc=0.9219 | L2-Norm=17.063 | L2-Norm(final)=4.790 | 4877.9 samples/s | 76.2 steps/s
[Step=2700 Epoch=13.2] | Loss=0.14029 | Reg=0.00292 | acc=0.9375 | L2-Norm=17.085 | L2-Norm(final)=4.788 | 7076.7 samples/s | 110.6 steps/s
[Step=2750 Epoch=13.5] | Loss=0.12602 | Reg=0.00293 | acc=0.9531 | L2-Norm=17.103 | L2-Norm(final)=4.788 | 2248.6 samples/s | 35.1 steps/s
[Step=2800 Epoch=13.7] | Loss=0.11742 | Reg=0.00293 | acc=0.9688 | L2-Norm=17.118 | L2-Norm(final)=4.788 | 4848.8 samples/s | 75.8 steps/s
[Step=2850 Epoch=14.0] | Loss=0.10927 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.131 | L2-Norm(final)=4.791 | 4829.9 samples/s | 75.5 steps/s
[Step=2900 Epoch=14.2] | Loss=0.10421 | Reg=0.00294 | acc=0.9688 | L2-Norm=17.144 | L2-Norm(final)=4.794 | 6711.0 samples/s | 104.9 steps/s
[Step=2950 Epoch=14.5] | Loss=0.09842 | Reg=0.00294 | acc=0.9375 | L2-Norm=17.156 | L2-Norm(final)=4.797 | 2289.2 samples/s | 35.8 steps/s
[Step=3000 Epoch=14.7] | Loss=0.09340 | Reg=0.00295 | acc=0.9844 | L2-Norm=17.169 | L2-Norm(final)=4.800 | 4886.0 samples/s | 76.3 steps/s
[Step=3050 Epoch=15.0] | Loss=0.08843 | Reg=0.00295 | acc=0.9844 | L2-Norm=17.181 | L2-Norm(final)=4.804 | 4854.7 samples/s | 75.9 steps/s
[Step=3100 Epoch=15.2] | Loss=0.08478 | Reg=0.00296 | acc=0.9531 | L2-Norm=17.192 | L2-Norm(final)=4.808 | 6299.9 samples/s | 98.4 steps/s
[Step=3150 Epoch=15.4] | Loss=0.08129 | Reg=0.00296 | acc=0.9531 | L2-Norm=17.202 | L2-Norm(final)=4.811 | 2347.0 samples/s | 36.7 steps/s
[Step=3200 Epoch=15.7] | Loss=0.07775 | Reg=0.00296 | acc=0.9531 | L2-Norm=17.212 | L2-Norm(final)=4.813 | 4935.5 samples/s | 77.1 steps/s
[Step=3250 Epoch=15.9] | Loss=0.07436 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.221 | L2-Norm(final)=4.817 | 4767.3 samples/s | 74.5 steps/s
[Step=3300 Epoch=16.2] | Loss=0.07186 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.229 | L2-Norm(final)=4.820 | 5964.4 samples/s | 93.2 steps/s
[Step=3350 Epoch=16.4] | Loss=0.06905 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.238 | L2-Norm(final)=4.823 | 2394.0 samples/s | 37.4 steps/s
[Step=3400 Epoch=16.7] | Loss=0.06653 | Reg=0.00297 | acc=0.9531 | L2-Norm=17.245 | L2-Norm(final)=4.826 | 4844.0 samples/s | 75.7 steps/s
[Step=3450 Epoch=16.9] | Loss=0.06449 | Reg=0.00298 | acc=0.9531 | L2-Norm=17.252 | L2-Norm(final)=4.830 | 4861.9 samples/s | 76.0 steps/s
[Step=3500 Epoch=17.2] | Loss=0.06243 | Reg=0.00298 | acc=0.9844 | L2-Norm=17.259 | L2-Norm(final)=4.833 | 5622.6 samples/s | 87.9 steps/s
[Step=3550 Epoch=17.4] | Loss=0.06021 | Reg=0.00298 | acc=0.9844 | L2-Norm=17.266 | L2-Norm(final)=4.836 | 2479.6 samples/s | 38.7 steps/s
[Step=3600 Epoch=17.7] | Loss=0.05865 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.272 | L2-Norm(final)=4.839 | 4823.5 samples/s | 75.4 steps/s
[Step=3650 Epoch=17.9] | Loss=0.05701 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.277 | L2-Norm(final)=4.842 | 4839.9 samples/s | 75.6 steps/s
[Step=3700 Epoch=18.1] | Loss=0.05568 | Reg=0.00299 | acc=0.9531 | L2-Norm=17.283 | L2-Norm(final)=4.845 | 5378.4 samples/s | 84.0 steps/s
[Step=3750 Epoch=18.4] | Loss=0.05460 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.288 | L2-Norm(final)=4.847 | 2521.1 samples/s | 39.4 steps/s
[Step=3800 Epoch=18.6] | Loss=0.05322 | Reg=0.00299 | acc=0.9844 | L2-Norm=17.293 | L2-Norm(final)=4.849 | 4928.5 samples/s | 77.0 steps/s
[Step=3850 Epoch=18.9] | Loss=0.05182 | Reg=0.00299 | acc=0.9688 | L2-Norm=17.298 | L2-Norm(final)=4.852 | 4769.0 samples/s | 74.5 steps/s
[Step=3900 Epoch=19.1] | Loss=0.05089 | Reg=0.00299 | acc=0.9844 | L2-Norm=17.303 | L2-Norm(final)=4.854 | 5062.4 samples/s | 79.1 steps/s
[Step=3950 Epoch=19.4] | Loss=0.04983 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.308 | L2-Norm(final)=4.857 | 2553.0 samples/s | 39.9 steps/s
[Step=4000 Epoch=19.6] | Loss=0.04867 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.312 | L2-Norm(final)=4.859 | 4832.6 samples/s | 75.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step4000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch=19.0] | Loss=0.14692 | Reg=0.00282 | acc=0.9062 | L2-Norm=16.792 | L2-Norm(final)=4.002 | 5808.5 samples/s | 90.8 steps/s
[Step=2050 Epoch=19.4] | Loss=0.13418 | Reg=0.00281 | acc=0.9688 | L2-Norm=16.777 | L2-Norm(final)=4.233 | 4624.3 samples/s | 72.3 steps/s
[Step=2100 Epoch=19.9] | Loss=0.12896 | Reg=0.00281 | acc=0.9688 | L2-Norm=16.775 | L2-Norm(final)=4.497 | 8293.3 samples/s | 129.6 steps/s
[Step=2150 Epoch=20.4] | Loss=0.12502 | Reg=0.00281 | acc=0.9375 | L2-Norm=16.775 | L2-Norm(final)=4.726 | 2362.9 samples/s | 36.9 steps/s
[Step=2200 Epoch=20.8] | Loss=0.12033 | Reg=0.00281 | acc=0.9062 | L2-Norm=16.774 | L2-Norm(final)=4.931 | 7158.5 samples/s | 111.9 steps/s
[Step=2250 Epoch=21.3] | Loss=0.11643 | Reg=0.00281 | acc=0.9844 | L2-Norm=16.774 | L2-Norm(final)=5.115 | 2489.2 samples/s | 38.9 steps/s
[Step=2300 Epoch=21.8] | Loss=0.11445 | Reg=0.00281 | acc=0.9688 | L2-Norm=16.774 | L2-Norm(final)=5.285 | 6222.0 samples/s | 97.2 steps/s
[Step=2350 Epoch=22.3] | Loss=0.11189 | Reg=0.00281 | acc=0.9375 | L2-Norm=16.774 | L2-Norm(final)=5.442 | 2530.7 samples/s | 39.5 steps/s
[Step=2400 Epoch=22.7] | Loss=0.10968 | Reg=0.00281 | acc=0.9375 | L2-Norm=16.774 | L2-Norm(final)=5.589 | 5965.8 samples/s | 93.2 steps/s
[Step=2450 Epoch=23.2] | Loss=0.10746 | Reg=0.00281 | acc=0.9688 | L2-Norm=16.774 | L2-Norm(final)=5.727 | 2649.7 samples/s | 41.4 steps/s
[Step=2500 Epoch=23.7] | Loss=0.10602 | Reg=0.00281 | acc=0.9531 | L2-Norm=16.774 | L2-Norm(final)=5.858 | 5400.8 samples/s | 84.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.7] | Loss=0.09691 | Reg=0.00281 | acc=0.9219 | L2-Norm=16.774 | L2-Norm(final)=7.132 | 5741.0 samples/s | 89.7 steps/s
[Step=2550 Epoch=24.2] | Loss=0.06039 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.133 | L2-Norm(final)=7.090 | 4161.7 samples/s | 65.0 steps/s
[Step=2600 Epoch=24.6] | Loss=0.03635 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.253 | L2-Norm(final)=7.076 | 6680.3 samples/s | 104.4 steps/s
[Step=2650 Epoch=25.1] | Loss=0.02478 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.263 | L2-Norm(final)=7.071 | 2205.5 samples/s | 34.5 steps/s
[Step=2700 Epoch=25.6] | Loss=0.01899 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.239 | L2-Norm(final)=7.071 | 6110.9 samples/s | 95.5 steps/s
[Step=2750 Epoch=26.1] | Loss=0.01533 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.203 | L2-Norm(final)=7.071 | 2308.6 samples/s | 36.1 steps/s
[Step=2800 Epoch=26.5] | Loss=0.01279 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.160 | L2-Norm(final)=7.072 | 5426.9 samples/s | 84.8 steps/s
[Step=2850 Epoch=27.0] | Loss=0.01097 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.112 | L2-Norm(final)=7.072 | 2356.2 samples/s | 36.8 steps/s
[Step=2900 Epoch=27.5] | Loss=0.00960 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.063 | L2-Norm(final)=7.073 | 5119.2 samples/s | 80.0 steps/s
[Step=2950 Epoch=28.0] | Loss=0.00854 | Reg=0.00289 | acc=1.0000 | L2-Norm=17.012 | L2-Norm(final)=7.073 | 2434.6 samples/s | 38.0 steps/s
[Step=3000 Epoch=28.4] | Loss=0.00768 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.962 | L2-Norm(final)=7.074 | 4740.7 samples/s | 74.1 steps/s
[Step=3050 Epoch=28.9] | Loss=0.00699 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.911 | L2-Norm(final)=7.074 | 2536.8 samples/s | 39.6 steps/s
[Step=3100 Epoch=29.4] | Loss=0.00641 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.861 | L2-Norm(final)=7.075 | 4671.7 samples/s | 73.0 steps/s
[Step=3150 Epoch=29.8] | Loss=0.00591 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.811 | L2-Norm(final)=7.075 | 2580.8 samples/s | 40.3 steps/s
[Step=3200 Epoch=30.3] | Loss=0.00549 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.761 | L2-Norm(final)=7.075 | 4598.8 samples/s | 71.9 steps/s
[Step=3250 Epoch=30.8] | Loss=0.00513 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.712 | L2-Norm(final)=7.076 | 2589.5 samples/s | 40.5 steps/s
[Step=3300 Epoch=31.3] | Loss=0.00481 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.664 | L2-Norm(final)=7.076 | 4627.9 samples/s | 72.3 steps/s
[Step=3350 Epoch=31.7] | Loss=0.00452 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.615 | L2-Norm(final)=7.076 | 2679.5 samples/s | 41.9 steps/s
[Step=3400 Epoch=32.2] | Loss=0.00427 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.568 | L2-Norm(final)=7.076 | 4364.5 samples/s | 68.2 steps/s
[Step=3450 Epoch=32.7] | Loss=0.00405 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.521 | L2-Norm(final)=7.077 | 6993.1 samples/s | 109.3 steps/s
[Step=3500 Epoch=33.2] | Loss=0.00385 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.474 | L2-Norm(final)=7.077 | 2162.8 samples/s | 33.8 steps/s
[Step=3550 Epoch=33.6] | Loss=0.00366 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.428 | L2-Norm(final)=7.077 | 6245.8 samples/s | 97.6 steps/s
[Step=3600 Epoch=34.1] | Loss=0.00350 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.382 | L2-Norm(final)=7.077 | 2253.5 samples/s | 35.2 steps/s
[Step=3650 Epoch=34.6] | Loss=0.00335 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.337 | L2-Norm(final)=7.077 | 5735.9 samples/s | 89.6 steps/s
[Step=3700 Epoch=35.1] | Loss=0.00321 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.292 | L2-Norm(final)=7.078 | 2331.3 samples/s | 36.4 steps/s
[Step=3750 Epoch=35.5] | Loss=0.00308 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.247 | L2-Norm(final)=7.078 | 5149.6 samples/s | 80.5 steps/s
[Step=3800 Epoch=36.0] | Loss=0.00296 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.202 | L2-Norm(final)=7.078 | 2392.0 samples/s | 37.4 steps/s
[Step=3850 Epoch=36.5] | Loss=0.00285 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.158 | L2-Norm(final)=7.078 | 4836.7 samples/s | 75.6 steps/s
[Step=3900 Epoch=37.0] | Loss=0.00275 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.114 | L2-Norm(final)=7.078 | 2522.4 samples/s | 39.4 steps/s
[Step=3950 Epoch=37.4] | Loss=0.00265 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.071 | L2-Norm(final)=7.079 | 4591.0 samples/s | 71.7 steps/s
[Step=4000 Epoch=37.9] | Loss=0.00257 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.028 | L2-Norm(final)=7.079 | 2581.3 samples/s | 40.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step4000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch=19.0] | Loss=0.15730 | Reg=0.00282 | acc=0.8750 | L2-Norm=16.792 | L2-Norm(final)=4.044 | 5810.7 samples/s | 90.8 steps/s
[Step=2050 Epoch=19.5] | Loss=0.13811 | Reg=0.00282 | acc=0.9375 | L2-Norm=16.778 | L2-Norm(final)=4.253 | 4588.2 samples/s | 71.7 steps/s
[Step=2100 Epoch=20.0] | Loss=0.12893 | Reg=0.00281 | acc=0.9531 | L2-Norm=16.776 | L2-Norm(final)=4.474 | 8165.8 samples/s | 127.6 steps/s
[Step=2150 Epoch=20.5] | Loss=0.12459 | Reg=0.00281 | acc=0.9531 | L2-Norm=16.776 | L2-Norm(final)=4.671 | 2339.8 samples/s | 36.6 steps/s
[Step=2200 Epoch=20.9] | Loss=0.12027 | Reg=0.00281 | acc=0.9688 | L2-Norm=16.775 | L2-Norm(final)=4.849 | 7398.3 samples/s | 115.6 steps/s
[Step=2250 Epoch=21.4] | Loss=0.11720 | Reg=0.00281 | acc=0.9375 | L2-Norm=16.775 | L2-Norm(final)=5.014 | 2474.2 samples/s | 38.7 steps/s
[Step=2300 Epoch=21.9] | Loss=0.11497 | Reg=0.00281 | acc=0.9375 | L2-Norm=16.775 | L2-Norm(final)=5.166 | 6485.7 samples/s | 101.3 steps/s
[Step=2350 Epoch=22.4] | Loss=0.11240 | Reg=0.00281 | acc=0.9531 | L2-Norm=16.775 | L2-Norm(final)=5.307 | 2525.7 samples/s | 39.5 steps/s
[Step=2400 Epoch=22.8] | Loss=0.11016 | Reg=0.00281 | acc=0.9375 | L2-Norm=16.775 | L2-Norm(final)=5.439 | 6046.0 samples/s | 94.5 steps/s
[Step=2450 Epoch=23.3] | Loss=0.10842 | Reg=0.00281 | acc=0.9531 | L2-Norm=16.775 | L2-Norm(final)=5.564 | 2633.2 samples/s | 41.1 steps/s
[Step=2500 Epoch=23.8] | Loss=0.10672 | Reg=0.00281 | acc=0.9531 | L2-Norm=16.775 | L2-Norm(final)=5.683 | 5434.1 samples/s | 84.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.8] | Loss=0.09101 | Reg=0.00281 | acc=0.9531 | L2-Norm=16.775 | L2-Norm(final)=6.849 | 5710.4 samples/s | 89.2 steps/s
[Step=2550 Epoch=24.3] | Loss=0.07196 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.161 | L2-Norm(final)=6.808 | 4117.7 samples/s | 64.3 steps/s
[Step=2600 Epoch=24.7] | Loss=0.04379 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.301 | L2-Norm(final)=6.800 | 6759.7 samples/s | 105.6 steps/s
[Step=2650 Epoch=25.2] | Loss=0.03002 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.336 | L2-Norm(final)=6.802 | 2223.0 samples/s | 34.7 steps/s
[Step=2700 Epoch=25.7] | Loss=0.02265 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.329 | L2-Norm(final)=6.805 | 5973.6 samples/s | 93.3 steps/s
[Step=2750 Epoch=26.2] | Loss=0.01814 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.305 | L2-Norm(final)=6.808 | 2258.7 samples/s | 35.3 steps/s
[Step=2800 Epoch=26.6] | Loss=0.01513 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.271 | L2-Norm(final)=6.810 | 5598.1 samples/s | 87.5 steps/s
[Step=2850 Epoch=27.1] | Loss=0.01297 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.233 | L2-Norm(final)=6.812 | 2363.9 samples/s | 36.9 steps/s
[Step=2900 Epoch=27.6] | Loss=0.01135 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.191 | L2-Norm(final)=6.813 | 5154.2 samples/s | 80.5 steps/s
[Step=2950 Epoch=28.1] | Loss=0.01009 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.149 | L2-Norm(final)=6.815 | 2452.6 samples/s | 38.3 steps/s
[Step=3000 Epoch=28.5] | Loss=0.00909 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.106 | L2-Norm(final)=6.816 | 4747.3 samples/s | 74.2 steps/s
[Step=3050 Epoch=29.0] | Loss=0.00826 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.063 | L2-Norm(final)=6.817 | 2550.2 samples/s | 39.8 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00758 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.019 | L2-Norm(final)=6.817 | 4596.2 samples/s | 71.8 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00699 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.976 | L2-Norm(final)=6.818 | 2574.0 samples/s | 40.2 steps/s
[Step=3200 Epoch=30.4] | Loss=0.00650 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.933 | L2-Norm(final)=6.819 | 4615.1 samples/s | 72.1 steps/s
[Step=3250 Epoch=30.9] | Loss=0.00606 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.890 | L2-Norm(final)=6.819 | 2626.1 samples/s | 41.0 steps/s
[Step=3300 Epoch=31.4] | Loss=0.00569 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.848 | L2-Norm(final)=6.820 | 4689.1 samples/s | 73.3 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00535 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.805 | L2-Norm(final)=6.821 | 2594.4 samples/s | 40.5 steps/s
[Step=3400 Epoch=32.3] | Loss=0.00505 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.763 | L2-Norm(final)=6.821 | 4535.4 samples/s | 70.9 steps/s
[Step=3450 Epoch=32.8] | Loss=0.00479 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.721 | L2-Norm(final)=6.822 | 6947.8 samples/s | 108.6 steps/s
[Step=3500 Epoch=33.3] | Loss=0.00455 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.680 | L2-Norm(final)=6.822 | 2185.5 samples/s | 34.1 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00433 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.639 | L2-Norm(final)=6.823 | 6194.3 samples/s | 96.8 steps/s
[Step=3600 Epoch=34.2] | Loss=0.00414 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.598 | L2-Norm(final)=6.823 | 2253.1 samples/s | 35.2 steps/s
[Step=3650 Epoch=34.7] | Loss=0.00396 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.557 | L2-Norm(final)=6.823 | 5759.2 samples/s | 90.0 steps/s
[Step=3700 Epoch=35.2] | Loss=0.00379 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.517 | L2-Norm(final)=6.824 | 2372.7 samples/s | 37.1 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00364 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.476 | L2-Norm(final)=6.824 | 5059.2 samples/s | 79.0 steps/s
[Step=3800 Epoch=36.1] | Loss=0.00350 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.436 | L2-Norm(final)=6.825 | 2401.3 samples/s | 37.5 steps/s
[Step=3850 Epoch=36.6] | Loss=0.00337 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.396 | L2-Norm(final)=6.825 | 4905.3 samples/s | 76.6 steps/s
[Step=3900 Epoch=37.1] | Loss=0.00325 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.356 | L2-Norm(final)=6.825 | 2484.6 samples/s | 38.8 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00314 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.317 | L2-Norm(final)=6.826 | 4654.6 samples/s | 72.7 steps/s
[Step=4000 Epoch=38.0] | Loss=0.00304 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.277 | L2-Norm(final)=6.826 | 2602.3 samples/s | 40.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.34545 | acc=0.5387 | tpr=0.6026 | fpr=0.5999 | 5918.8 samples/s | 23.1 steps/s
Avg test loss: 0.34575, Avg test acc: 0.53746, Avg tpr: 0.59876, Avg fpr: 0.59736, total FA: 4660

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.17392 | acc=0.9274 | tpr=0.9740 | fpr=0.1737 | 5765.0 samples/s | 22.5 steps/s
Avg test loss: 0.17947, Avg test acc: 0.92584, Avg tpr: 0.97109, Avg fpr: 0.17370, total FA: 1355

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.14032 | acc=0.9305 | tpr=0.9464 | fpr=0.1038 | 5797.5 samples/s | 22.6 steps/s
Avg test loss: 0.14153, Avg test acc: 0.92872, Avg tpr: 0.94387, Avg fpr: 0.10460, total FA: 816

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.34545 | acc=0.5387 | tpr=0.6026 | fpr=0.5999 | 5574.1 samples/s | 21.8 steps/s
Avg test loss: 0.34575, Avg test acc: 0.53746, Avg tpr: 0.59876, Avg fpr: 0.59736, total FA: 4660

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.15890 | acc=0.9259 | tpr=0.9482 | fpr=0.1226 | 5904.3 samples/s | 23.1 steps/s
Avg test loss: 0.15917, Avg test acc: 0.92568, Avg tpr: 0.94632, Avg fpr: 0.11973, total FA: 934

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.92368 | acc=0.3098 | tpr=0.0159 | fpr=0.0518 | 5683.6 samples/s | 22.2 steps/s
Avg test loss: 5.95648, Avg test acc: 0.30852, Avg tpr: 0.01649, Avg fpr: 0.04922, total FA: 384

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.72231 | acc=0.3120 | tpr=0.0233 | fpr=0.0612 | 5742.3 samples/s | 22.4 steps/s
Avg test loss: 4.73991, Avg test acc: 0.31052, Avg tpr: 0.02308, Avg fpr: 0.05730, total FA: 447

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=0.34545 | acc=0.5387 | tpr=0.6026 | fpr=0.5999 | 5795.7 samples/s | 22.6 steps/s
Avg test loss: 0.34575, Avg test acc: 0.53746, Avg tpr: 0.59876, Avg fpr: 0.59736, total FA: 4660

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=0.34545 | acc=0.5387 | tpr=0.6026 | fpr=0.5999 | 5765.9 samples/s | 22.5 steps/s
Avg test loss: 0.34575, Avg test acc: 0.53746, Avg tpr: 0.59876, Avg fpr: 0.59736, total FA: 4660

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=0.34545 | acc=0.5387 | tpr=0.6026 | fpr=0.5999 | 5621.8 samples/s | 22.0 steps/s
Avg test loss: 0.34575, Avg test acc: 0.53746, Avg tpr: 0.59876, Avg fpr: 0.59736, total FA: 4660

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=0.34849 | acc=0.5070 | tpr=0.4646 | fpr=0.4923 | 5688.6 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.34895 | acc=0.5004 | tpr=0.4478 | fpr=0.4986 | 7634.2 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.34884 | acc=0.4999 | tpr=0.4481 | fpr=0.4991 | 8251.3 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.34876 | acc=0.5004 | tpr=0.4448 | fpr=0.4986 | 7866.3 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.34867 | acc=0.5013 | tpr=0.4498 | fpr=0.4977 | 8373.1 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.34870 | acc=0.5011 | tpr=0.4407 | fpr=0.4978 | 7977.6 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.34866 | acc=0.5011 | tpr=0.4477 | fpr=0.4979 | 7890.0 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.34860 | acc=0.5016 | tpr=0.4437 | fpr=0.4974 | 8274.2 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.34857 | acc=0.5017 | tpr=0.4426 | fpr=0.4973 | 7853.5 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.34852 | acc=0.5023 | tpr=0.4454 | fpr=0.4966 | 7705.8 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.34852 | acc=0.5026 | tpr=0.4441 | fpr=0.4963 | 10677.6 samples/s | 41.7 steps/s
Avg test loss: 0.34853, Avg test acc: 0.50255, Avg tpr: 0.44453, Avg fpr: 0.49640, total FA: 68924

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.42611 | acc=0.0925 | tpr=0.8097 | fpr=0.9204 | 5659.6 samples/s | 22.1 steps/s
[Step= 100] | Loss=4.39700 | acc=0.0939 | tpr=0.8102 | fpr=0.9194 | 7862.5 samples/s | 30.7 steps/s
[Step= 150] | Loss=4.39826 | acc=0.0936 | tpr=0.8084 | fpr=0.9195 | 8279.0 samples/s | 32.3 steps/s
[Step= 200] | Loss=4.39664 | acc=0.0930 | tpr=0.7923 | fpr=0.9197 | 7885.5 samples/s | 30.8 steps/s
[Step= 250] | Loss=4.40239 | acc=0.0927 | tpr=0.8009 | fpr=0.9202 | 8238.6 samples/s | 32.2 steps/s
[Step= 300] | Loss=4.40311 | acc=0.0922 | tpr=0.8015 | fpr=0.9207 | 8175.9 samples/s | 31.9 steps/s
[Step= 350] | Loss=4.40804 | acc=0.0921 | tpr=0.7971 | fpr=0.9207 | 7327.6 samples/s | 28.6 steps/s
[Step= 400] | Loss=4.40935 | acc=0.0920 | tpr=0.7954 | fpr=0.9208 | 8507.6 samples/s | 33.2 steps/s
[Step= 450] | Loss=4.40591 | acc=0.0918 | tpr=0.7921 | fpr=0.9209 | 8499.9 samples/s | 33.2 steps/s
[Step= 500] | Loss=4.41018 | acc=0.0917 | tpr=0.7969 | fpr=0.9210 | 7882.9 samples/s | 30.8 steps/s
[Step= 550] | Loss=4.40721 | acc=0.0921 | tpr=0.7982 | fpr=0.9208 | 10567.7 samples/s | 41.3 steps/s
Avg test loss: 4.40732, Avg test acc: 0.09200, Avg tpr: 0.79794, Avg fpr: 0.92083, total FA: 127856

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.23511 | acc=0.1317 | tpr=0.6726 | fpr=0.8780 | 5766.6 samples/s | 22.5 steps/s
[Step= 100] | Loss=4.22466 | acc=0.1305 | tpr=0.6311 | fpr=0.8788 | 7784.7 samples/s | 30.4 steps/s
[Step= 150] | Loss=4.24525 | acc=0.1302 | tpr=0.6340 | fpr=0.8791 | 7559.0 samples/s | 29.5 steps/s
[Step= 200] | Loss=4.24582 | acc=0.1298 | tpr=0.6273 | fpr=0.8792 | 8035.2 samples/s | 31.4 steps/s
[Step= 250] | Loss=4.25266 | acc=0.1300 | tpr=0.6245 | fpr=0.8790 | 8028.1 samples/s | 31.4 steps/s
[Step= 300] | Loss=4.25601 | acc=0.1299 | tpr=0.6269 | fpr=0.8791 | 8109.5 samples/s | 31.7 steps/s
[Step= 350] | Loss=4.25777 | acc=0.1295 | tpr=0.6149 | fpr=0.8793 | 8164.2 samples/s | 31.9 steps/s
[Step= 400] | Loss=4.25836 | acc=0.1299 | tpr=0.6138 | fpr=0.8789 | 7684.4 samples/s | 30.0 steps/s
[Step= 450] | Loss=4.25635 | acc=0.1301 | tpr=0.6154 | fpr=0.8787 | 8434.0 samples/s | 32.9 steps/s
[Step= 500] | Loss=4.25841 | acc=0.1305 | tpr=0.6167 | fpr=0.8783 | 8181.8 samples/s | 32.0 steps/s
[Step= 550] | Loss=4.25434 | acc=0.1308 | tpr=0.6204 | fpr=0.8781 | 10901.1 samples/s | 42.6 steps/s
Avg test loss: 4.25412, Avg test acc: 0.13074, Avg tpr: 0.62084, Avg fpr: 0.87817, total FA: 121932

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=0.34849 | acc=0.5070 | tpr=0.4646 | fpr=0.4923 | 5606.8 samples/s | 21.9 steps/s
[Step= 100] | Loss=0.34895 | acc=0.5004 | tpr=0.4478 | fpr=0.4986 | 7917.5 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.34884 | acc=0.4999 | tpr=0.4481 | fpr=0.4991 | 8219.4 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.34876 | acc=0.5004 | tpr=0.4448 | fpr=0.4986 | 8173.3 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.34867 | acc=0.5013 | tpr=0.4498 | fpr=0.4977 | 8565.1 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.34870 | acc=0.5011 | tpr=0.4407 | fpr=0.4978 | 8344.6 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.34866 | acc=0.5011 | tpr=0.4477 | fpr=0.4979 | 7213.9 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.34860 | acc=0.5016 | tpr=0.4437 | fpr=0.4974 | 8485.5 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.34857 | acc=0.5017 | tpr=0.4426 | fpr=0.4973 | 8338.1 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.34852 | acc=0.5023 | tpr=0.4454 | fpr=0.4966 | 8055.3 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.34852 | acc=0.5026 | tpr=0.4441 | fpr=0.4963 | 9501.0 samples/s | 37.1 steps/s
Avg test loss: 0.34853, Avg test acc: 0.50255, Avg tpr: 0.44453, Avg fpr: 0.49640, total FA: 68924

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.40776 | acc=0.1310 | tpr=0.6372 | fpr=0.8781 | 5610.8 samples/s | 21.9 steps/s
[Step= 100] | Loss=4.39060 | acc=0.1308 | tpr=0.6247 | fpr=0.8784 | 8226.6 samples/s | 32.1 steps/s
[Step= 150] | Loss=4.39423 | acc=0.1309 | tpr=0.6225 | fpr=0.8781 | 8307.5 samples/s | 32.5 steps/s
[Step= 200] | Loss=4.38902 | acc=0.1307 | tpr=0.6153 | fpr=0.8781 | 7772.0 samples/s | 30.4 steps/s
[Step= 250] | Loss=4.39271 | acc=0.1307 | tpr=0.6218 | fpr=0.8782 | 8215.6 samples/s | 32.1 steps/s
[Step= 300] | Loss=4.39414 | acc=0.1300 | tpr=0.6218 | fpr=0.8790 | 8225.8 samples/s | 32.1 steps/s
[Step= 350] | Loss=4.39469 | acc=0.1297 | tpr=0.6124 | fpr=0.8791 | 8446.7 samples/s | 33.0 steps/s
[Step= 400] | Loss=4.39509 | acc=0.1300 | tpr=0.6067 | fpr=0.8786 | 8338.0 samples/s | 32.6 steps/s
[Step= 450] | Loss=4.39351 | acc=0.1299 | tpr=0.6081 | fpr=0.8788 | 7524.9 samples/s | 29.4 steps/s
[Step= 500] | Loss=4.39637 | acc=0.1295 | tpr=0.6110 | fpr=0.8792 | 8291.7 samples/s | 32.4 steps/s
[Step= 550] | Loss=4.39313 | acc=0.1296 | tpr=0.6140 | fpr=0.8792 | 9762.4 samples/s | 38.1 steps/s
Avg test loss: 4.39342, Avg test acc: 0.12949, Avg tpr: 0.61331, Avg fpr: 0.87931, total FA: 122090

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09128 | acc=0.9750 | tpr=0.8673 | fpr=0.0231 | 5788.7 samples/s | 22.6 steps/s
[Step= 100] | Loss=0.08990 | acc=0.9755 | tpr=0.8998 | fpr=0.0231 | 7805.4 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.09260 | acc=0.9744 | tpr=0.9078 | fpr=0.0244 | 8509.7 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.09181 | acc=0.9747 | tpr=0.9126 | fpr=0.0241 | 8507.3 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.09198 | acc=0.9746 | tpr=0.9100 | fpr=0.0242 | 7122.7 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.09299 | acc=0.9743 | tpr=0.9069 | fpr=0.0244 | 8521.5 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.09315 | acc=0.9743 | tpr=0.9067 | fpr=0.0245 | 7567.5 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.09434 | acc=0.9738 | tpr=0.9015 | fpr=0.0249 | 8399.0 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.09529 | acc=0.9736 | tpr=0.8992 | fpr=0.0250 | 8090.4 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.09457 | acc=0.9737 | tpr=0.9009 | fpr=0.0250 | 8321.5 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.09404 | acc=0.9739 | tpr=0.9009 | fpr=0.0248 | 10233.0 samples/s | 40.0 steps/s
Avg test loss: 0.09387, Avg test acc: 0.97395, Avg tpr: 0.90055, Avg fpr: 0.02472, total FA: 3432

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.06908 | acc=0.9797 | tpr=0.8584 | fpr=0.0181 | 5649.4 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.06819 | acc=0.9800 | tpr=0.8891 | fpr=0.0183 | 8084.8 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.06980 | acc=0.9797 | tpr=0.8934 | fpr=0.0188 | 8168.9 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.07030 | acc=0.9797 | tpr=0.8951 | fpr=0.0188 | 8021.1 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.07026 | acc=0.9795 | tpr=0.8891 | fpr=0.0188 | 8093.0 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.07056 | acc=0.9794 | tpr=0.8865 | fpr=0.0189 | 7269.2 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.07058 | acc=0.9793 | tpr=0.8904 | fpr=0.0191 | 8722.7 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.07108 | acc=0.9792 | tpr=0.8922 | fpr=0.0192 | 8122.0 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.07170 | acc=0.9789 | tpr=0.8914 | fpr=0.0195 | 7725.3 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.07148 | acc=0.9790 | tpr=0.8934 | fpr=0.0194 | 8087.3 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.07107 | acc=0.9792 | tpr=0.8926 | fpr=0.0192 | 10461.6 samples/s | 40.9 steps/s
Avg test loss: 0.07097, Avg test acc: 0.97924, Avg tpr: 0.89184, Avg fpr: 0.01917, total FA: 2662

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.34849 | acc=0.5070 | tpr=0.4646 | fpr=0.4923 | 5722.3 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.34895 | acc=0.5004 | tpr=0.4478 | fpr=0.4986 | 7918.4 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.34884 | acc=0.4999 | tpr=0.4481 | fpr=0.4991 | 7862.6 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.34876 | acc=0.5004 | tpr=0.4448 | fpr=0.4986 | 7757.8 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.34867 | acc=0.5013 | tpr=0.4498 | fpr=0.4977 | 8716.3 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.34870 | acc=0.5011 | tpr=0.4407 | fpr=0.4978 | 8623.6 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.34866 | acc=0.5011 | tpr=0.4477 | fpr=0.4979 | 7426.3 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.34860 | acc=0.5016 | tpr=0.4437 | fpr=0.4974 | 8480.3 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.34857 | acc=0.5017 | tpr=0.4426 | fpr=0.4973 | 8432.8 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.34852 | acc=0.5023 | tpr=0.4454 | fpr=0.4966 | 8197.6 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.34852 | acc=0.5026 | tpr=0.4441 | fpr=0.4963 | 9279.5 samples/s | 36.2 steps/s
Avg test loss: 0.34853, Avg test acc: 0.50255, Avg tpr: 0.44453, Avg fpr: 0.49640, total FA: 68924

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.34849 | acc=0.5070 | tpr=0.4646 | fpr=0.4923 | 5759.1 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.34895 | acc=0.5004 | tpr=0.4478 | fpr=0.4986 | 7498.2 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.34884 | acc=0.4999 | tpr=0.4481 | fpr=0.4991 | 8104.4 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.34876 | acc=0.5004 | tpr=0.4448 | fpr=0.4986 | 8371.3 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.34867 | acc=0.5013 | tpr=0.4498 | fpr=0.4977 | 8267.5 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.34870 | acc=0.5011 | tpr=0.4407 | fpr=0.4978 | 8136.5 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.34866 | acc=0.5011 | tpr=0.4477 | fpr=0.4979 | 8173.6 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.34860 | acc=0.5016 | tpr=0.4437 | fpr=0.4974 | 8221.2 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.34857 | acc=0.5017 | tpr=0.4426 | fpr=0.4973 | 7541.2 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.34852 | acc=0.5023 | tpr=0.4454 | fpr=0.4966 | 8034.3 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.34852 | acc=0.5026 | tpr=0.4441 | fpr=0.4963 | 10306.0 samples/s | 40.3 steps/s
Avg test loss: 0.34853, Avg test acc: 0.50255, Avg tpr: 0.44453, Avg fpr: 0.49640, total FA: 68924

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.34849 | acc=0.5070 | tpr=0.4646 | fpr=0.4923 | 5830.2 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.34895 | acc=0.5004 | tpr=0.4478 | fpr=0.4986 | 7447.9 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.34884 | acc=0.4999 | tpr=0.4481 | fpr=0.4991 | 7863.5 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.34876 | acc=0.5004 | tpr=0.4448 | fpr=0.4986 | 8045.1 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.34867 | acc=0.5013 | tpr=0.4498 | fpr=0.4977 | 8402.8 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.34870 | acc=0.5011 | tpr=0.4407 | fpr=0.4978 | 7906.0 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.34866 | acc=0.5011 | tpr=0.4477 | fpr=0.4979 | 7757.3 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.34860 | acc=0.5016 | tpr=0.4437 | fpr=0.4974 | 8407.8 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.34857 | acc=0.5017 | tpr=0.4426 | fpr=0.4973 | 8456.3 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.34852 | acc=0.5023 | tpr=0.4454 | fpr=0.4966 | 7417.5 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.34852 | acc=0.5026 | tpr=0.4441 | fpr=0.4963 | 11811.5 samples/s | 46.1 steps/s
Avg test loss: 0.34853, Avg test acc: 0.50255, Avg tpr: 0.44453, Avg fpr: 0.49640, total FA: 68924

server round 2/50

clients selected: [1 3 5 6 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.20862 | Reg=0.00272 | acc=0.8750 | L2-Norm=16.491 | L2-Norm(final)=4.496 | 6172.7 samples/s | 96.4 steps/s
[Step=4050 Epoch=19.8] | Loss=0.20438 | Reg=0.00272 | acc=0.8281 | L2-Norm=16.491 | L2-Norm(final)=4.562 | 4989.0 samples/s | 78.0 steps/s
[Step=4100 Epoch=20.0] | Loss=0.20411 | Reg=0.00272 | acc=0.8125 | L2-Norm=16.491 | L2-Norm(final)=4.649 | 5740.5 samples/s | 89.7 steps/s
[Step=4150 Epoch=20.3] | Loss=0.20370 | Reg=0.00272 | acc=0.8750 | L2-Norm=16.491 | L2-Norm(final)=4.732 | 5529.0 samples/s | 86.4 steps/s
[Step=4200 Epoch=20.5] | Loss=0.20131 | Reg=0.00272 | acc=0.7656 | L2-Norm=16.491 | L2-Norm(final)=4.813 | 8732.6 samples/s | 136.4 steps/s
[Step=4250 Epoch=20.7] | Loss=0.19958 | Reg=0.00272 | acc=0.7969 | L2-Norm=16.491 | L2-Norm(final)=4.889 | 2443.4 samples/s | 38.2 steps/s
[Step=4300 Epoch=21.0] | Loss=0.19836 | Reg=0.00272 | acc=0.8281 | L2-Norm=16.491 | L2-Norm(final)=4.963 | 5690.8 samples/s | 88.9 steps/s
[Step=4350 Epoch=21.2] | Loss=0.19768 | Reg=0.00272 | acc=0.8125 | L2-Norm=16.491 | L2-Norm(final)=5.033 | 5600.8 samples/s | 87.5 steps/s
[Step=4400 Epoch=21.5] | Loss=0.19698 | Reg=0.00272 | acc=0.8125 | L2-Norm=16.491 | L2-Norm(final)=5.101 | 7754.7 samples/s | 121.2 steps/s
[Step=4450 Epoch=21.7] | Loss=0.19645 | Reg=0.00272 | acc=0.8438 | L2-Norm=16.491 | L2-Norm(final)=5.164 | 2502.4 samples/s | 39.1 steps/s
[Step=4500 Epoch=22.0] | Loss=0.19528 | Reg=0.00272 | acc=0.7969 | L2-Norm=16.491 | L2-Norm(final)=5.226 | 5620.0 samples/s | 87.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=22.0] | Loss=0.25859 | Reg=0.00272 | acc=0.7500 | L2-Norm=16.491 | L2-Norm(final)=5.829 | 5792.3 samples/s | 90.5 steps/s
[Step=4550 Epoch=22.2] | Loss=0.16755 | Reg=0.00276 | acc=0.9219 | L2-Norm=16.603 | L2-Norm(final)=5.831 | 4495.0 samples/s | 70.2 steps/s
[Step=4600 Epoch=22.4] | Loss=0.14367 | Reg=0.00279 | acc=0.8906 | L2-Norm=16.696 | L2-Norm(final)=5.818 | 4801.7 samples/s | 75.0 steps/s
[Step=4650 Epoch=22.7] | Loss=0.13622 | Reg=0.00280 | acc=0.9219 | L2-Norm=16.739 | L2-Norm(final)=5.811 | 4852.0 samples/s | 75.8 steps/s
[Step=4700 Epoch=22.9] | Loss=0.12408 | Reg=0.00281 | acc=0.9375 | L2-Norm=16.774 | L2-Norm(final)=5.809 | 7021.5 samples/s | 109.7 steps/s
[Step=4750 Epoch=23.2] | Loss=0.11495 | Reg=0.00282 | acc=0.9219 | L2-Norm=16.803 | L2-Norm(final)=5.809 | 2231.7 samples/s | 34.9 steps/s
[Step=4800 Epoch=23.4] | Loss=0.10599 | Reg=0.00283 | acc=0.9219 | L2-Norm=16.834 | L2-Norm(final)=5.810 | 4857.8 samples/s | 75.9 steps/s
[Step=4850 Epoch=23.7] | Loss=0.09891 | Reg=0.00284 | acc=0.9375 | L2-Norm=16.861 | L2-Norm(final)=5.812 | 4885.5 samples/s | 76.3 steps/s
[Step=4900 Epoch=23.9] | Loss=0.09401 | Reg=0.00285 | acc=0.9688 | L2-Norm=16.886 | L2-Norm(final)=5.814 | 6403.6 samples/s | 100.1 steps/s
[Step=4950 Epoch=24.2] | Loss=0.08862 | Reg=0.00286 | acc=0.9688 | L2-Norm=16.909 | L2-Norm(final)=5.816 | 2300.3 samples/s | 35.9 steps/s
[Step=5000 Epoch=24.4] | Loss=0.08325 | Reg=0.00287 | acc=0.9531 | L2-Norm=16.930 | L2-Norm(final)=5.820 | 4866.2 samples/s | 76.0 steps/s
[Step=5050 Epoch=24.6] | Loss=0.07970 | Reg=0.00287 | acc=0.9688 | L2-Norm=16.949 | L2-Norm(final)=5.823 | 4920.7 samples/s | 76.9 steps/s
[Step=5100 Epoch=24.9] | Loss=0.07666 | Reg=0.00288 | acc=0.9844 | L2-Norm=16.969 | L2-Norm(final)=5.825 | 5892.4 samples/s | 92.1 steps/s
[Step=5150 Epoch=25.1] | Loss=0.07329 | Reg=0.00289 | acc=0.9844 | L2-Norm=16.988 | L2-Norm(final)=5.827 | 2388.1 samples/s | 37.3 steps/s
[Step=5200 Epoch=25.4] | Loss=0.07037 | Reg=0.00289 | acc=0.9688 | L2-Norm=17.004 | L2-Norm(final)=5.830 | 4852.7 samples/s | 75.8 steps/s
[Step=5250 Epoch=25.6] | Loss=0.06751 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.020 | L2-Norm(final)=5.832 | 4853.8 samples/s | 75.8 steps/s
[Step=5300 Epoch=25.9] | Loss=0.06550 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.034 | L2-Norm(final)=5.835 | 5625.8 samples/s | 87.9 steps/s
[Step=5350 Epoch=26.1] | Loss=0.06325 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.047 | L2-Norm(final)=5.837 | 2444.0 samples/s | 38.2 steps/s
[Step=5400 Epoch=26.3] | Loss=0.06122 | Reg=0.00291 | acc=0.9844 | L2-Norm=17.059 | L2-Norm(final)=5.839 | 4852.5 samples/s | 75.8 steps/s
[Step=5450 Epoch=26.6] | Loss=0.05925 | Reg=0.00291 | acc=0.9688 | L2-Norm=17.070 | L2-Norm(final)=5.840 | 4904.5 samples/s | 76.6 steps/s
[Step=5500 Epoch=26.8] | Loss=0.05770 | Reg=0.00292 | acc=0.9844 | L2-Norm=17.080 | L2-Norm(final)=5.842 | 5230.4 samples/s | 81.7 steps/s
[Step=5550 Epoch=27.1] | Loss=0.05610 | Reg=0.00292 | acc=0.9688 | L2-Norm=17.089 | L2-Norm(final)=5.843 | 2521.5 samples/s | 39.4 steps/s
[Step=5600 Epoch=27.3] | Loss=0.05449 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.098 | L2-Norm(final)=5.844 | 4844.9 samples/s | 75.7 steps/s
[Step=5650 Epoch=27.6] | Loss=0.05287 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.106 | L2-Norm(final)=5.845 | 4848.2 samples/s | 75.8 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05155 | Reg=0.00293 | acc=0.9375 | L2-Norm=17.114 | L2-Norm(final)=5.847 | 4977.6 samples/s | 77.8 steps/s
[Step=5750 Epoch=28.1] | Loss=0.05049 | Reg=0.00293 | acc=0.9688 | L2-Norm=17.121 | L2-Norm(final)=5.847 | 2586.3 samples/s | 40.4 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04925 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.127 | L2-Norm(final)=5.848 | 4897.8 samples/s | 76.5 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04795 | Reg=0.00294 | acc=0.9844 | L2-Norm=17.132 | L2-Norm(final)=5.849 | 4859.7 samples/s | 75.9 steps/s
[Step=5900 Epoch=28.8] | Loss=0.04728 | Reg=0.00294 | acc=0.9844 | L2-Norm=17.137 | L2-Norm(final)=5.850 | 4791.3 samples/s | 74.9 steps/s
[Step=5950 Epoch=29.0] | Loss=0.04631 | Reg=0.00294 | acc=0.9844 | L2-Norm=17.143 | L2-Norm(final)=5.850 | 2645.4 samples/s | 41.3 steps/s
[Step=6000 Epoch=29.3] | Loss=0.04533 | Reg=0.00294 | acc=0.9688 | L2-Norm=17.149 | L2-Norm(final)=5.851 | 4850.9 samples/s | 75.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step6000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.31999 | Reg=0.00272 | acc=0.7344 | L2-Norm=16.491 | L2-Norm(final)=2.022 | 5992.4 samples/s | 93.6 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.30282 | Reg=0.00272 | acc=0.8281 | L2-Norm=16.491 | L2-Norm(final)=2.109 | 5383.4 samples/s | 84.1 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.28918 | Reg=0.00272 | acc=0.7969 | L2-Norm=16.491 | L2-Norm(final)=2.233 | 6285.5 samples/s | 98.2 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.27871 | Reg=0.00272 | acc=0.7812 | L2-Norm=16.491 | L2-Norm(final)=2.371 | 6406.9 samples/s | 100.1 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.27084 | Reg=0.00272 | acc=0.8438 | L2-Norm=16.491 | L2-Norm(final)=2.511 | 10349.6 samples/s | 161.7 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.26381 | Reg=0.00272 | acc=0.7656 | L2-Norm=16.491 | L2-Norm(final)=2.649 | 2540.9 samples/s | 39.7 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.25811 | Reg=0.00272 | acc=0.8594 | L2-Norm=16.491 | L2-Norm(final)=2.785 | 6488.9 samples/s | 101.4 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.25298 | Reg=0.00272 | acc=0.8281 | L2-Norm=16.491 | L2-Norm(final)=2.917 | 6468.0 samples/s | 101.1 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.24814 | Reg=0.00272 | acc=0.8594 | L2-Norm=16.491 | L2-Norm(final)=3.046 | 8744.8 samples/s | 136.6 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.24466 | Reg=0.00272 | acc=0.8438 | L2-Norm=16.491 | L2-Norm(final)=3.170 | 2675.5 samples/s | 41.8 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.24136 | Reg=0.00272 | acc=0.7969 | L2-Norm=16.491 | L2-Norm(final)=3.290 | 6110.8 samples/s | 95.5 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.18522 | Reg=0.00272 | acc=0.8438 | L2-Norm=16.491 | L2-Norm(final)=4.471 | 5566.2 samples/s | 87.0 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.16525 | Reg=0.00265 | acc=0.9531 | L2-Norm=16.286 | L2-Norm(final)=4.505 | 4665.5 samples/s | 72.9 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.15104 | Reg=0.00264 | acc=0.9219 | L2-Norm=16.253 | L2-Norm(final)=4.504 | 4791.4 samples/s | 74.9 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.13546 | Reg=0.00264 | acc=0.9531 | L2-Norm=16.248 | L2-Norm(final)=4.509 | 4852.4 samples/s | 75.8 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.12853 | Reg=0.00264 | acc=0.8438 | L2-Norm=16.248 | L2-Norm(final)=4.514 | 7020.6 samples/s | 109.7 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.11543 | Reg=0.00264 | acc=0.9219 | L2-Norm=16.254 | L2-Norm(final)=4.523 | 2274.7 samples/s | 35.5 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10663 | Reg=0.00265 | acc=0.9375 | L2-Norm=16.265 | L2-Norm(final)=4.534 | 4889.9 samples/s | 76.4 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.09990 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.280 | L2-Norm(final)=4.545 | 4924.5 samples/s | 76.9 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.09531 | Reg=0.00266 | acc=0.9375 | L2-Norm=16.295 | L2-Norm(final)=4.555 | 6224.3 samples/s | 97.3 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.09064 | Reg=0.00266 | acc=0.9688 | L2-Norm=16.313 | L2-Norm(final)=4.563 | 2353.2 samples/s | 36.8 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.08564 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.332 | L2-Norm(final)=4.572 | 4866.9 samples/s | 76.0 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.08215 | Reg=0.00267 | acc=0.9688 | L2-Norm=16.353 | L2-Norm(final)=4.580 | 4860.5 samples/s | 75.9 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.07871 | Reg=0.00268 | acc=0.9375 | L2-Norm=16.373 | L2-Norm(final)=4.587 | 5864.4 samples/s | 91.6 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.07486 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.391 | L2-Norm(final)=4.594 | 2436.9 samples/s | 38.1 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.07150 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.409 | L2-Norm(final)=4.602 | 4862.7 samples/s | 76.0 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.06822 | Reg=0.00270 | acc=0.9844 | L2-Norm=16.426 | L2-Norm(final)=4.609 | 4906.5 samples/s | 76.7 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.06638 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.442 | L2-Norm(final)=4.616 | 5369.5 samples/s | 83.9 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.06429 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.458 | L2-Norm(final)=4.621 | 2527.8 samples/s | 39.5 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.06198 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.474 | L2-Norm(final)=4.627 | 4888.5 samples/s | 76.4 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.05984 | Reg=0.00272 | acc=0.9531 | L2-Norm=16.490 | L2-Norm(final)=4.634 | 4854.3 samples/s | 75.8 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.05881 | Reg=0.00272 | acc=0.9688 | L2-Norm=16.505 | L2-Norm(final)=4.639 | 4999.0 samples/s | 78.1 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.05814 | Reg=0.00273 | acc=0.9219 | L2-Norm=16.522 | L2-Norm(final)=4.643 | 2611.4 samples/s | 40.8 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.05758 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.542 | L2-Norm(final)=4.646 | 4851.6 samples/s | 75.8 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.05651 | Reg=0.00274 | acc=0.9688 | L2-Norm=16.562 | L2-Norm(final)=4.649 | 4864.7 samples/s | 76.0 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.05525 | Reg=0.00275 | acc=0.9844 | L2-Norm=16.582 | L2-Norm(final)=4.652 | 4928.5 samples/s | 77.0 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.05415 | Reg=0.00276 | acc=0.9844 | L2-Norm=16.601 | L2-Norm(final)=4.655 | 2628.2 samples/s | 41.1 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.05271 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.619 | L2-Norm(final)=4.658 | 4901.2 samples/s | 76.6 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.05132 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.636 | L2-Norm(final)=4.661 | 4816.2 samples/s | 75.3 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.05049 | Reg=0.00277 | acc=0.9844 | L2-Norm=16.652 | L2-Norm(final)=4.664 | 4908.3 samples/s | 76.7 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.04933 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.667 | L2-Norm(final)=4.666 | 2644.6 samples/s | 41.3 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.04838 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.682 | L2-Norm(final)=4.669 | 4895.5 samples/s | 76.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step2000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=37.9] | Loss=0.09316 | Reg=0.00272 | acc=0.9375 | L2-Norm=16.491 | L2-Norm(final)=7.085 | 5236.4 samples/s | 81.8 steps/s
[Step=4050 Epoch=38.4] | Loss=0.08352 | Reg=0.00272 | acc=0.9844 | L2-Norm=16.478 | L2-Norm(final)=7.209 | 4988.0 samples/s | 77.9 steps/s
[Step=4100 Epoch=38.9] | Loss=0.08321 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.476 | L2-Norm(final)=7.357 | 8123.6 samples/s | 126.9 steps/s
[Step=4150 Epoch=39.3] | Loss=0.08196 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.476 | L2-Norm(final)=7.498 | 2346.9 samples/s | 36.7 steps/s
[Step=4200 Epoch=39.8] | Loss=0.08022 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.475 | L2-Norm(final)=7.628 | 7299.9 samples/s | 114.1 steps/s
[Step=4250 Epoch=40.3] | Loss=0.07821 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.475 | L2-Norm(final)=7.748 | 2472.7 samples/s | 38.6 steps/s
[Step=4300 Epoch=40.7] | Loss=0.07674 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.475 | L2-Norm(final)=7.862 | 6349.4 samples/s | 99.2 steps/s
[Step=4350 Epoch=41.2] | Loss=0.07587 | Reg=0.00271 | acc=0.9531 | L2-Norm=16.475 | L2-Norm(final)=7.969 | 2529.6 samples/s | 39.5 steps/s
[Step=4400 Epoch=41.7] | Loss=0.07458 | Reg=0.00271 | acc=0.9375 | L2-Norm=16.475 | L2-Norm(final)=8.071 | 6044.2 samples/s | 94.4 steps/s
[Step=4450 Epoch=42.2] | Loss=0.07332 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.475 | L2-Norm(final)=8.168 | 2616.7 samples/s | 40.9 steps/s
[Step=4500 Epoch=42.6] | Loss=0.07262 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.475 | L2-Norm(final)=8.262 | 5488.1 samples/s | 85.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.7] | Loss=0.05447 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.474 | L2-Norm(final)=9.184 | 6135.6 samples/s | 95.9 steps/s
[Step=4550 Epoch=43.1] | Loss=0.06719 | Reg=0.00284 | acc=0.9844 | L2-Norm=16.846 | L2-Norm(final)=9.147 | 4011.9 samples/s | 62.7 steps/s
[Step=4600 Epoch=43.6] | Loss=0.03951 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.043 | L2-Norm(final)=9.118 | 6631.3 samples/s | 103.6 steps/s
[Step=4650 Epoch=44.1] | Loss=0.02668 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.074 | L2-Norm(final)=9.111 | 2209.2 samples/s | 34.5 steps/s
[Step=4700 Epoch=44.5] | Loss=0.02043 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.055 | L2-Norm(final)=9.110 | 6069.0 samples/s | 94.8 steps/s
[Step=4750 Epoch=45.0] | Loss=0.01640 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.020 | L2-Norm(final)=9.111 | 2283.9 samples/s | 35.7 steps/s
[Step=4800 Epoch=45.5] | Loss=0.01367 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.975 | L2-Norm(final)=9.113 | 5548.4 samples/s | 86.7 steps/s
[Step=4850 Epoch=46.0] | Loss=0.01173 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.925 | L2-Norm(final)=9.114 | 2359.6 samples/s | 36.9 steps/s
[Step=4900 Epoch=46.4] | Loss=0.01027 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.873 | L2-Norm(final)=9.115 | 5087.8 samples/s | 79.5 steps/s
[Step=4950 Epoch=46.9] | Loss=0.00913 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.819 | L2-Norm(final)=9.116 | 2432.5 samples/s | 38.0 steps/s
[Step=5000 Epoch=47.4] | Loss=0.00822 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.764 | L2-Norm(final)=9.117 | 4735.1 samples/s | 74.0 steps/s
[Step=5050 Epoch=47.9] | Loss=0.00747 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.710 | L2-Norm(final)=9.118 | 2548.6 samples/s | 39.8 steps/s
[Step=5100 Epoch=48.3] | Loss=0.00685 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.655 | L2-Norm(final)=9.119 | 4663.7 samples/s | 72.9 steps/s
[Step=5150 Epoch=48.8] | Loss=0.00633 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.601 | L2-Norm(final)=9.119 | 2564.9 samples/s | 40.1 steps/s
[Step=5200 Epoch=49.3] | Loss=0.00587 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.548 | L2-Norm(final)=9.120 | 4581.6 samples/s | 71.6 steps/s
[Step=5250 Epoch=49.7] | Loss=0.00548 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.495 | L2-Norm(final)=9.120 | 2590.7 samples/s | 40.5 steps/s
[Step=5300 Epoch=50.2] | Loss=0.00514 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.443 | L2-Norm(final)=9.121 | 4617.6 samples/s | 72.2 steps/s
[Step=5350 Epoch=50.7] | Loss=0.00484 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.391 | L2-Norm(final)=9.121 | 2662.2 samples/s | 41.6 steps/s
[Step=5400 Epoch=51.2] | Loss=0.00457 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.340 | L2-Norm(final)=9.122 | 4444.1 samples/s | 69.4 steps/s
[Step=5450 Epoch=51.6] | Loss=0.00433 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.290 | L2-Norm(final)=9.122 | 6802.3 samples/s | 106.3 steps/s
[Step=5500 Epoch=52.1] | Loss=0.00411 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.240 | L2-Norm(final)=9.123 | 2166.8 samples/s | 33.9 steps/s
[Step=5550 Epoch=52.6] | Loss=0.00392 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.190 | L2-Norm(final)=9.124 | 6327.5 samples/s | 98.9 steps/s
[Step=5600 Epoch=53.1] | Loss=0.00374 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.141 | L2-Norm(final)=9.125 | 2257.6 samples/s | 35.3 steps/s
[Step=5650 Epoch=53.5] | Loss=0.00358 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.092 | L2-Norm(final)=9.126 | 5627.1 samples/s | 87.9 steps/s
[Step=5700 Epoch=54.0] | Loss=0.00343 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.044 | L2-Norm(final)=9.127 | 2342.4 samples/s | 36.6 steps/s
[Step=5750 Epoch=54.5] | Loss=0.00329 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.997 | L2-Norm(final)=9.128 | 5244.9 samples/s | 82.0 steps/s
[Step=5800 Epoch=55.0] | Loss=0.00317 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.949 | L2-Norm(final)=9.129 | 2423.8 samples/s | 37.9 steps/s
[Step=5850 Epoch=55.4] | Loss=0.00305 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.902 | L2-Norm(final)=9.131 | 4832.4 samples/s | 75.5 steps/s
[Step=5900 Epoch=55.9] | Loss=0.00294 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.856 | L2-Norm(final)=9.132 | 2559.2 samples/s | 40.0 steps/s
[Step=5950 Epoch=56.4] | Loss=0.00284 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.810 | L2-Norm(final)=9.134 | 4520.9 samples/s | 70.6 steps/s
[Step=6000 Epoch=56.9] | Loss=0.00274 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.764 | L2-Norm(final)=9.135 | 2579.3 samples/s | 40.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step6000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.06440 | Reg=0.00272 | acc=0.9688 | L2-Norm=16.491 | L2-Norm(final)=6.838 | 5398.2 samples/s | 84.3 steps/s
[Step=4050 Epoch=38.5] | Loss=0.08554 | Reg=0.00272 | acc=0.9531 | L2-Norm=16.479 | L2-Norm(final)=6.969 | 4692.0 samples/s | 73.3 steps/s
[Step=4100 Epoch=39.0] | Loss=0.08566 | Reg=0.00271 | acc=0.9531 | L2-Norm=16.477 | L2-Norm(final)=7.112 | 8273.2 samples/s | 129.3 steps/s
[Step=4150 Epoch=39.5] | Loss=0.08378 | Reg=0.00271 | acc=0.9375 | L2-Norm=16.477 | L2-Norm(final)=7.238 | 2369.2 samples/s | 37.0 steps/s
[Step=4200 Epoch=40.0] | Loss=0.08288 | Reg=0.00271 | acc=0.9531 | L2-Norm=16.476 | L2-Norm(final)=7.355 | 7301.9 samples/s | 114.1 steps/s
[Step=4250 Epoch=40.4] | Loss=0.08194 | Reg=0.00271 | acc=0.9531 | L2-Norm=16.476 | L2-Norm(final)=7.467 | 2427.4 samples/s | 37.9 steps/s
[Step=4300 Epoch=40.9] | Loss=0.08083 | Reg=0.00271 | acc=0.9375 | L2-Norm=16.476 | L2-Norm(final)=7.570 | 6718.1 samples/s | 105.0 steps/s
[Step=4350 Epoch=41.4] | Loss=0.07947 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.476 | L2-Norm(final)=7.667 | 2139.9 samples/s | 33.4 steps/s
[Step=4400 Epoch=41.9] | Loss=0.07896 | Reg=0.00271 | acc=0.9531 | L2-Norm=16.476 | L2-Norm(final)=7.759 | 6021.1 samples/s | 94.1 steps/s
[Step=4450 Epoch=42.3] | Loss=0.07858 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.476 | L2-Norm(final)=7.847 | 2612.4 samples/s | 40.8 steps/s
[Step=4500 Epoch=42.8] | Loss=0.07765 | Reg=0.00271 | acc=0.9375 | L2-Norm=16.476 | L2-Norm(final)=7.930 | 5485.2 samples/s | 85.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.8] | Loss=0.06522 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.476 | L2-Norm(final)=8.747 | 6075.4 samples/s | 94.9 steps/s
[Step=4550 Epoch=43.3] | Loss=0.10363 | Reg=0.00289 | acc=0.9844 | L2-Norm=17.001 | L2-Norm(final)=8.668 | 4033.9 samples/s | 63.0 steps/s
[Step=4600 Epoch=43.8] | Loss=0.05714 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.200 | L2-Norm(final)=8.667 | 6588.8 samples/s | 103.0 steps/s
[Step=4650 Epoch=44.2] | Loss=0.04084 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.258 | L2-Norm(final)=8.674 | 2199.4 samples/s | 34.4 steps/s
[Step=4700 Epoch=44.7] | Loss=0.03093 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.270 | L2-Norm(final)=8.682 | 6030.5 samples/s | 94.2 steps/s
[Step=4750 Epoch=45.2] | Loss=0.02480 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.255 | L2-Norm(final)=8.689 | 2285.3 samples/s | 35.7 steps/s
[Step=4800 Epoch=45.7] | Loss=0.02069 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.228 | L2-Norm(final)=8.695 | 5565.1 samples/s | 87.0 steps/s
[Step=4850 Epoch=46.1] | Loss=0.01775 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.193 | L2-Norm(final)=8.699 | 2373.3 samples/s | 37.1 steps/s
[Step=4900 Epoch=46.6] | Loss=0.01554 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.155 | L2-Norm(final)=8.703 | 5091.4 samples/s | 79.6 steps/s
[Step=4950 Epoch=47.1] | Loss=0.01382 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.114 | L2-Norm(final)=8.706 | 2437.7 samples/s | 38.1 steps/s
[Step=5000 Epoch=47.6] | Loss=0.01244 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.072 | L2-Norm(final)=8.709 | 4742.8 samples/s | 74.1 steps/s
[Step=5050 Epoch=48.0] | Loss=0.01131 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.029 | L2-Norm(final)=8.712 | 2540.3 samples/s | 39.7 steps/s
[Step=5100 Epoch=48.5] | Loss=0.01037 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.986 | L2-Norm(final)=8.714 | 4612.1 samples/s | 72.1 steps/s
[Step=5150 Epoch=49.0] | Loss=0.00958 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.943 | L2-Norm(final)=8.716 | 2608.8 samples/s | 40.8 steps/s
[Step=5200 Epoch=49.5] | Loss=0.00890 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.900 | L2-Norm(final)=8.718 | 4594.2 samples/s | 71.8 steps/s
[Step=5250 Epoch=49.9] | Loss=0.00830 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.857 | L2-Norm(final)=8.720 | 2590.6 samples/s | 40.5 steps/s
[Step=5300 Epoch=50.4] | Loss=0.00779 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.814 | L2-Norm(final)=8.721 | 4622.0 samples/s | 72.2 steps/s
[Step=5350 Epoch=50.9] | Loss=0.00733 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.772 | L2-Norm(final)=8.723 | 2607.6 samples/s | 40.7 steps/s
[Step=5400 Epoch=51.4] | Loss=0.00692 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.729 | L2-Norm(final)=8.725 | 4585.7 samples/s | 71.7 steps/s
[Step=5450 Epoch=51.8] | Loss=0.00656 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.687 | L2-Norm(final)=8.726 | 6936.3 samples/s | 108.4 steps/s
[Step=5500 Epoch=52.3] | Loss=0.00623 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.646 | L2-Norm(final)=8.727 | 2164.9 samples/s | 33.8 steps/s
[Step=5550 Epoch=52.8] | Loss=0.00594 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.604 | L2-Norm(final)=8.728 | 6315.4 samples/s | 98.7 steps/s
[Step=5600 Epoch=53.3] | Loss=0.00567 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.563 | L2-Norm(final)=8.730 | 2282.0 samples/s | 35.7 steps/s
[Step=5650 Epoch=53.7] | Loss=0.00542 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.522 | L2-Norm(final)=8.731 | 5541.8 samples/s | 86.6 steps/s
[Step=5700 Epoch=54.2] | Loss=0.00520 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.482 | L2-Norm(final)=8.732 | 2359.1 samples/s | 36.9 steps/s
[Step=5750 Epoch=54.7] | Loss=0.00499 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.441 | L2-Norm(final)=8.733 | 5210.6 samples/s | 81.4 steps/s
[Step=5800 Epoch=55.2] | Loss=0.00480 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.401 | L2-Norm(final)=8.734 | 2407.0 samples/s | 37.6 steps/s
[Step=5850 Epoch=55.6] | Loss=0.00462 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.362 | L2-Norm(final)=8.735 | 4877.9 samples/s | 76.2 steps/s
[Step=5900 Epoch=56.1] | Loss=0.00446 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.322 | L2-Norm(final)=8.736 | 2536.2 samples/s | 39.6 steps/s
[Step=5950 Epoch=56.6] | Loss=0.00430 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.283 | L2-Norm(final)=8.737 | 4699.6 samples/s | 73.4 steps/s
[Step=6000 Epoch=57.1] | Loss=0.00416 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.244 | L2-Norm(final)=8.738 | 2534.3 samples/s | 39.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step6000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34323 | Reg=0.00272 | acc=0.5000 | L2-Norm=16.491 | L2-Norm(final)=2.019 | 5929.6 samples/s | 92.6 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.30856 | Reg=0.00272 | acc=0.6875 | L2-Norm=16.491 | L2-Norm(final)=2.039 | 4863.9 samples/s | 76.0 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.28509 | Reg=0.00272 | acc=0.8438 | L2-Norm=16.491 | L2-Norm(final)=2.112 | 9829.3 samples/s | 153.6 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.26437 | Reg=0.00272 | acc=0.8594 | L2-Norm=16.491 | L2-Norm(final)=2.228 | 2507.8 samples/s | 39.2 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.24761 | Reg=0.00272 | acc=0.8750 | L2-Norm=16.491 | L2-Norm(final)=2.366 | 8110.9 samples/s | 126.7 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.23416 | Reg=0.00272 | acc=0.9062 | L2-Norm=16.491 | L2-Norm(final)=2.517 | 2577.0 samples/s | 40.3 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.22312 | Reg=0.00272 | acc=0.9375 | L2-Norm=16.491 | L2-Norm(final)=2.671 | 7437.0 samples/s | 116.2 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.21318 | Reg=0.00272 | acc=0.9531 | L2-Norm=16.491 | L2-Norm(final)=2.827 | 2788.3 samples/s | 43.6 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.20480 | Reg=0.00272 | acc=0.8906 | L2-Norm=16.491 | L2-Norm(final)=2.981 | 5894.1 samples/s | 92.1 steps/s
[Step= 450 Epoch= 4.2] | Loss=0.19722 | Reg=0.00272 | acc=0.9062 | L2-Norm=16.491 | L2-Norm(final)=3.132 | 2863.5 samples/s | 44.7 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.19060 | Reg=0.00272 | acc=0.9375 | L2-Norm=16.491 | L2-Norm(final)=3.281 | 6091.6 samples/s | 95.2 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.7] | Loss=0.11494 | Reg=0.00272 | acc=0.9375 | L2-Norm=16.491 | L2-Norm(final)=4.746 | 5531.2 samples/s | 86.4 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.04943 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.297 | L2-Norm(final)=4.785 | 4260.6 samples/s | 66.6 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.03077 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.257 | L2-Norm(final)=4.802 | 6670.2 samples/s | 104.2 steps/s
[Step= 650 Epoch= 6.1] | Loss=0.02203 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.232 | L2-Norm(final)=4.815 | 2210.7 samples/s | 34.5 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.01681 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.205 | L2-Norm(final)=4.827 | 5930.2 samples/s | 92.7 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01354 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.174 | L2-Norm(final)=4.836 | 2290.5 samples/s | 35.8 steps/s
[Step= 800 Epoch= 7.5] | Loss=0.01130 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.139 | L2-Norm(final)=4.843 | 5361.3 samples/s | 83.8 steps/s
[Step= 850 Epoch= 8.0] | Loss=0.00969 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.100 | L2-Norm(final)=4.849 | 2376.9 samples/s | 37.1 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.00848 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.059 | L2-Norm(final)=4.853 | 4893.9 samples/s | 76.5 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.00755 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.017 | L2-Norm(final)=4.857 | 2514.3 samples/s | 39.3 steps/s
[Step=1000 Epoch= 9.4] | Loss=0.00679 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.974 | L2-Norm(final)=4.861 | 4723.6 samples/s | 73.8 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.00618 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.930 | L2-Norm(final)=4.864 | 2568.0 samples/s | 40.1 steps/s
[Step=1100 Epoch=10.4] | Loss=0.00566 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.886 | L2-Norm(final)=4.867 | 4584.3 samples/s | 71.6 steps/s
[Step=1150 Epoch=10.8] | Loss=0.00523 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.842 | L2-Norm(final)=4.870 | 2606.7 samples/s | 40.7 steps/s
[Step=1200 Epoch=11.3] | Loss=0.00486 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.797 | L2-Norm(final)=4.872 | 4701.7 samples/s | 73.5 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00453 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.752 | L2-Norm(final)=4.875 | 2784.0 samples/s | 43.5 steps/s
[Step=1300 Epoch=12.2] | Loss=0.00425 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.707 | L2-Norm(final)=4.878 | 4043.3 samples/s | 63.2 steps/s
[Step=1350 Epoch=12.7] | Loss=0.00400 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.662 | L2-Norm(final)=4.880 | 6753.5 samples/s | 105.5 steps/s
[Step=1400 Epoch=13.2] | Loss=0.00378 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.617 | L2-Norm(final)=4.883 | 2177.2 samples/s | 34.0 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00358 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.572 | L2-Norm(final)=4.885 | 6037.6 samples/s | 94.3 steps/s
[Step=1500 Epoch=14.1] | Loss=0.00340 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.528 | L2-Norm(final)=4.887 | 2292.4 samples/s | 35.8 steps/s
[Step=1550 Epoch=14.6] | Loss=0.00324 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.483 | L2-Norm(final)=4.890 | 5419.8 samples/s | 84.7 steps/s
[Step=1600 Epoch=15.1] | Loss=0.00309 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.438 | L2-Norm(final)=4.892 | 2390.8 samples/s | 37.4 steps/s
[Step=1650 Epoch=15.5] | Loss=0.00296 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.394 | L2-Norm(final)=4.894 | 4978.2 samples/s | 77.8 steps/s
[Step=1700 Epoch=16.0] | Loss=0.00284 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.349 | L2-Norm(final)=4.896 | 2478.9 samples/s | 38.7 steps/s
[Step=1750 Epoch=16.5] | Loss=0.00272 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.305 | L2-Norm(final)=4.899 | 4646.0 samples/s | 72.6 steps/s
[Step=1800 Epoch=17.0] | Loss=0.00262 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.261 | L2-Norm(final)=4.901 | 2559.8 samples/s | 40.0 steps/s
[Step=1850 Epoch=17.4] | Loss=0.00252 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.216 | L2-Norm(final)=4.903 | 4667.6 samples/s | 72.9 steps/s
[Step=1900 Epoch=17.9] | Loss=0.00243 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.172 | L2-Norm(final)=4.906 | 2604.8 samples/s | 40.7 steps/s
[Step=1950 Epoch=18.4] | Loss=0.00235 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.129 | L2-Norm(final)=4.908 | 4722.2 samples/s | 73.8 steps/s
[Step=2000 Epoch=18.8] | Loss=0.00227 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.085 | L2-Norm(final)=4.911 | 2618.1 samples/s | 40.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.34545 | acc=0.5387 | tpr=0.6026 | fpr=0.5999 | 5610.8 samples/s | 21.9 steps/s
Avg test loss: 0.34575, Avg test acc: 0.53746, Avg tpr: 0.59876, Avg fpr: 0.59736, total FA: 4660

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.15563 | acc=0.9227 | tpr=0.9312 | fpr=0.0959 | 5775.5 samples/s | 22.6 steps/s
Avg test loss: 0.15396, Avg test acc: 0.92283, Avg tpr: 0.93087, Avg fpr: 0.09486, total FA: 740

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.14032 | acc=0.9305 | tpr=0.9464 | fpr=0.1038 | 5602.1 samples/s | 21.9 steps/s
Avg test loss: 0.14153, Avg test acc: 0.92872, Avg tpr: 0.94387, Avg fpr: 0.10460, total FA: 816

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.13895 | acc=0.9334 | tpr=0.9604 | fpr=0.1254 | 5794.2 samples/s | 22.6 steps/s
Avg test loss: 0.14417, Avg test acc: 0.93353, Avg tpr: 0.96112, Avg fpr: 0.12716, total FA: 992

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.15890 | acc=0.9259 | tpr=0.9482 | fpr=0.1226 | 5786.2 samples/s | 22.6 steps/s
Avg test loss: 0.15917, Avg test acc: 0.92568, Avg tpr: 0.94632, Avg fpr: 0.11973, total FA: 934

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.84901 | acc=0.3140 | tpr=0.0088 | fpr=0.0233 | 5695.1 samples/s | 22.2 steps/s
Avg test loss: 4.86241, Avg test acc: 0.31136, Avg tpr: 0.00804, Avg fpr: 0.02154, total FA: 168

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.79483 | acc=0.3137 | tpr=0.0054 | fpr=0.0168 | 5657.9 samples/s | 22.1 steps/s
Avg test loss: 4.80937, Avg test acc: 0.31244, Avg tpr: 0.00676, Avg fpr: 0.01525, total FA: 119

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=0.34545 | acc=0.5387 | tpr=0.6026 | fpr=0.5999 | 5783.7 samples/s | 22.6 steps/s
Avg test loss: 0.34575, Avg test acc: 0.53746, Avg tpr: 0.59876, Avg fpr: 0.59736, total FA: 4660

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=6.38633 | acc=0.3070 | tpr=0.0288 | fpr=0.0889 | 5808.8 samples/s | 22.7 steps/s
Avg test loss: 6.41717, Avg test acc: 0.30603, Avg tpr: 0.02984, Avg fpr: 0.08653, total FA: 675

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=0.34545 | acc=0.5387 | tpr=0.6026 | fpr=0.5999 | 5614.7 samples/s | 21.9 steps/s
Avg test loss: 0.34575, Avg test acc: 0.53746, Avg tpr: 0.59876, Avg fpr: 0.59736, total FA: 4660

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=0.34849 | acc=0.5070 | tpr=0.4646 | fpr=0.4923 | 5709.4 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.34895 | acc=0.5004 | tpr=0.4478 | fpr=0.4986 | 8138.7 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.34884 | acc=0.4999 | tpr=0.4481 | fpr=0.4991 | 7956.0 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.34876 | acc=0.5004 | tpr=0.4448 | fpr=0.4986 | 7743.6 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.34867 | acc=0.5013 | tpr=0.4498 | fpr=0.4977 | 8035.9 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.34870 | acc=0.5011 | tpr=0.4407 | fpr=0.4978 | 7938.5 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.34866 | acc=0.5011 | tpr=0.4477 | fpr=0.4979 | 8390.9 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.34860 | acc=0.5016 | tpr=0.4437 | fpr=0.4974 | 8241.5 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.34857 | acc=0.5017 | tpr=0.4426 | fpr=0.4973 | 7793.5 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.34852 | acc=0.5023 | tpr=0.4454 | fpr=0.4966 | 8189.7 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.34852 | acc=0.5026 | tpr=0.4441 | fpr=0.4963 | 10405.1 samples/s | 40.6 steps/s
Avg test loss: 0.34853, Avg test acc: 0.50255, Avg tpr: 0.44453, Avg fpr: 0.49640, total FA: 68924

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.92166 | acc=0.1721 | tpr=0.6903 | fpr=0.8372 | 5513.9 samples/s | 21.5 steps/s
[Step= 100] | Loss=3.90487 | acc=0.1745 | tpr=0.6205 | fpr=0.8338 | 7988.3 samples/s | 31.2 steps/s
[Step= 150] | Loss=3.90541 | acc=0.1759 | tpr=0.6282 | fpr=0.8324 | 8279.1 samples/s | 32.3 steps/s
[Step= 200] | Loss=3.90709 | acc=0.1762 | tpr=0.6295 | fpr=0.8320 | 8026.1 samples/s | 31.4 steps/s
[Step= 250] | Loss=3.91628 | acc=0.1763 | tpr=0.6393 | fpr=0.8321 | 8270.8 samples/s | 32.3 steps/s
[Step= 300] | Loss=3.91630 | acc=0.1756 | tpr=0.6349 | fpr=0.8328 | 7953.9 samples/s | 31.1 steps/s
[Step= 350] | Loss=3.91966 | acc=0.1756 | tpr=0.6187 | fpr=0.8324 | 8410.6 samples/s | 32.9 steps/s
[Step= 400] | Loss=3.92209 | acc=0.1760 | tpr=0.6242 | fpr=0.8322 | 7400.5 samples/s | 28.9 steps/s
[Step= 450] | Loss=3.92207 | acc=0.1751 | tpr=0.6246 | fpr=0.8330 | 8128.7 samples/s | 31.8 steps/s
[Step= 500] | Loss=3.92258 | acc=0.1755 | tpr=0.6264 | fpr=0.8327 | 8380.2 samples/s | 32.7 steps/s
[Step= 550] | Loss=3.92146 | acc=0.1756 | tpr=0.6279 | fpr=0.8326 | 10293.7 samples/s | 40.2 steps/s
Avg test loss: 3.92230, Avg test acc: 0.17540, Avg tpr: 0.62837, Avg fpr: 0.83283, total FA: 115637

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.23511 | acc=0.1317 | tpr=0.6726 | fpr=0.8780 | 5648.1 samples/s | 22.1 steps/s
[Step= 100] | Loss=4.22466 | acc=0.1305 | tpr=0.6311 | fpr=0.8788 | 8402.9 samples/s | 32.8 steps/s
[Step= 150] | Loss=4.24525 | acc=0.1302 | tpr=0.6340 | fpr=0.8791 | 7842.2 samples/s | 30.6 steps/s
[Step= 200] | Loss=4.24582 | acc=0.1298 | tpr=0.6273 | fpr=0.8792 | 7607.3 samples/s | 29.7 steps/s
[Step= 250] | Loss=4.25266 | acc=0.1300 | tpr=0.6245 | fpr=0.8790 | 8319.4 samples/s | 32.5 steps/s
[Step= 300] | Loss=4.25601 | acc=0.1299 | tpr=0.6269 | fpr=0.8791 | 7964.7 samples/s | 31.1 steps/s
[Step= 350] | Loss=4.25777 | acc=0.1295 | tpr=0.6149 | fpr=0.8793 | 8100.7 samples/s | 31.6 steps/s
[Step= 400] | Loss=4.25836 | acc=0.1299 | tpr=0.6138 | fpr=0.8789 | 7687.3 samples/s | 30.0 steps/s
[Step= 450] | Loss=4.25635 | acc=0.1301 | tpr=0.6154 | fpr=0.8787 | 8534.5 samples/s | 33.3 steps/s
[Step= 500] | Loss=4.25841 | acc=0.1305 | tpr=0.6167 | fpr=0.8783 | 8422.9 samples/s | 32.9 steps/s
[Step= 550] | Loss=4.25434 | acc=0.1308 | tpr=0.6204 | fpr=0.8781 | 9763.0 samples/s | 38.1 steps/s
Avg test loss: 4.25412, Avg test acc: 0.13074, Avg tpr: 0.62084, Avg fpr: 0.87817, total FA: 121932

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.99147 | acc=0.1152 | tpr=0.7080 | fpr=0.8954 | 5565.0 samples/s | 21.7 steps/s
[Step= 100] | Loss=4.95215 | acc=0.1143 | tpr=0.6610 | fpr=0.8959 | 7934.6 samples/s | 31.0 steps/s
[Step= 150] | Loss=4.95165 | acc=0.1124 | tpr=0.6455 | fpr=0.8974 | 8061.1 samples/s | 31.5 steps/s
[Step= 200] | Loss=4.95064 | acc=0.1121 | tpr=0.6448 | fpr=0.8976 | 8426.0 samples/s | 32.9 steps/s
[Step= 250] | Loss=4.95432 | acc=0.1127 | tpr=0.6629 | fpr=0.8974 | 8037.9 samples/s | 31.4 steps/s
[Step= 300] | Loss=4.95535 | acc=0.1123 | tpr=0.6589 | fpr=0.8976 | 8134.4 samples/s | 31.8 steps/s
[Step= 350] | Loss=4.95945 | acc=0.1118 | tpr=0.6475 | fpr=0.8979 | 7960.1 samples/s | 31.1 steps/s
[Step= 400] | Loss=4.95392 | acc=0.1126 | tpr=0.6488 | fpr=0.8972 | 7830.7 samples/s | 30.6 steps/s
[Step= 450] | Loss=4.95034 | acc=0.1125 | tpr=0.6519 | fpr=0.8973 | 8069.8 samples/s | 31.5 steps/s
[Step= 500] | Loss=4.94953 | acc=0.1124 | tpr=0.6449 | fpr=0.8972 | 7888.6 samples/s | 30.8 steps/s
[Step= 550] | Loss=4.94879 | acc=0.1125 | tpr=0.6442 | fpr=0.8971 | 10424.7 samples/s | 40.7 steps/s
Avg test loss: 4.94921, Avg test acc: 0.11248, Avg tpr: 0.64461, Avg fpr: 0.89719, total FA: 124573

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.40776 | acc=0.1310 | tpr=0.6372 | fpr=0.8781 | 5624.7 samples/s | 22.0 steps/s
[Step= 100] | Loss=4.39060 | acc=0.1308 | tpr=0.6247 | fpr=0.8784 | 7762.3 samples/s | 30.3 steps/s
[Step= 150] | Loss=4.39423 | acc=0.1309 | tpr=0.6225 | fpr=0.8781 | 7937.4 samples/s | 31.0 steps/s
[Step= 200] | Loss=4.38902 | acc=0.1307 | tpr=0.6153 | fpr=0.8781 | 8144.7 samples/s | 31.8 steps/s
[Step= 250] | Loss=4.39271 | acc=0.1307 | tpr=0.6218 | fpr=0.8782 | 8612.5 samples/s | 33.6 steps/s
[Step= 300] | Loss=4.39414 | acc=0.1300 | tpr=0.6218 | fpr=0.8790 | 8720.6 samples/s | 34.1 steps/s
[Step= 350] | Loss=4.39469 | acc=0.1297 | tpr=0.6124 | fpr=0.8791 | 7759.2 samples/s | 30.3 steps/s
[Step= 400] | Loss=4.39509 | acc=0.1300 | tpr=0.6067 | fpr=0.8786 | 7863.5 samples/s | 30.7 steps/s
[Step= 450] | Loss=4.39351 | acc=0.1299 | tpr=0.6081 | fpr=0.8788 | 8221.2 samples/s | 32.1 steps/s
[Step= 500] | Loss=4.39637 | acc=0.1295 | tpr=0.6110 | fpr=0.8792 | 8545.5 samples/s | 33.4 steps/s
[Step= 550] | Loss=4.39313 | acc=0.1296 | tpr=0.6140 | fpr=0.8792 | 9299.5 samples/s | 36.3 steps/s
Avg test loss: 4.39342, Avg test acc: 0.12949, Avg tpr: 0.61331, Avg fpr: 0.87931, total FA: 122090

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09872 | acc=0.9777 | tpr=0.8850 | fpr=0.0207 | 5762.3 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.09965 | acc=0.9772 | tpr=0.9126 | fpr=0.0216 | 7415.8 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.10249 | acc=0.9762 | tpr=0.9107 | fpr=0.0226 | 7667.9 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.10275 | acc=0.9765 | tpr=0.9126 | fpr=0.0224 | 8167.9 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.10303 | acc=0.9764 | tpr=0.9039 | fpr=0.0223 | 8151.9 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.10420 | acc=0.9762 | tpr=0.9025 | fpr=0.0225 | 7989.3 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.10506 | acc=0.9760 | tpr=0.9042 | fpr=0.0227 | 8312.1 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.10620 | acc=0.9757 | tpr=0.9021 | fpr=0.0229 | 7849.0 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.10766 | acc=0.9756 | tpr=0.9026 | fpr=0.0231 | 8262.0 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.10724 | acc=0.9756 | tpr=0.9031 | fpr=0.0231 | 7926.9 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.10634 | acc=0.9758 | tpr=0.9037 | fpr=0.0229 | 11375.6 samples/s | 44.4 steps/s
Avg test loss: 0.10617, Avg test acc: 0.97575, Avg tpr: 0.90293, Avg fpr: 0.02292, total FA: 3183

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08114 | acc=0.9798 | tpr=0.8628 | fpr=0.0181 | 5918.1 samples/s | 23.1 steps/s
[Step= 100] | Loss=0.08489 | acc=0.9800 | tpr=0.9041 | fpr=0.0186 | 7971.3 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.08695 | acc=0.9798 | tpr=0.9150 | fpr=0.0190 | 7220.7 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.08821 | acc=0.9799 | tpr=0.9158 | fpr=0.0189 | 8390.6 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.08752 | acc=0.9800 | tpr=0.9127 | fpr=0.0188 | 8400.9 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.08855 | acc=0.9799 | tpr=0.9127 | fpr=0.0189 | 8239.8 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.08852 | acc=0.9797 | tpr=0.9142 | fpr=0.0191 | 7934.6 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.08967 | acc=0.9794 | tpr=0.9130 | fpr=0.0194 | 8267.2 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.09117 | acc=0.9792 | tpr=0.9104 | fpr=0.0196 | 7837.3 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.09059 | acc=0.9792 | tpr=0.9110 | fpr=0.0196 | 8380.8 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.09010 | acc=0.9793 | tpr=0.9117 | fpr=0.0195 | 9353.9 samples/s | 36.5 steps/s
Avg test loss: 0.08992, Avg test acc: 0.97933, Avg tpr: 0.91165, Avg fpr: 0.01944, total FA: 2699

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.34849 | acc=0.5070 | tpr=0.4646 | fpr=0.4923 | 5822.0 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.34895 | acc=0.5004 | tpr=0.4478 | fpr=0.4986 | 8069.8 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.34884 | acc=0.4999 | tpr=0.4481 | fpr=0.4991 | 8058.0 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.34876 | acc=0.5004 | tpr=0.4448 | fpr=0.4986 | 7711.8 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.34867 | acc=0.5013 | tpr=0.4498 | fpr=0.4977 | 8244.7 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.34870 | acc=0.5011 | tpr=0.4407 | fpr=0.4978 | 7420.3 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.34866 | acc=0.5011 | tpr=0.4477 | fpr=0.4979 | 8310.7 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.34860 | acc=0.5016 | tpr=0.4437 | fpr=0.4974 | 8139.1 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.34857 | acc=0.5017 | tpr=0.4426 | fpr=0.4973 | 8689.8 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.34852 | acc=0.5023 | tpr=0.4454 | fpr=0.4966 | 7905.0 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.34852 | acc=0.5026 | tpr=0.4441 | fpr=0.4963 | 10017.7 samples/s | 39.1 steps/s
Avg test loss: 0.34853, Avg test acc: 0.50255, Avg tpr: 0.44453, Avg fpr: 0.49640, total FA: 68924

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.07284 | acc=0.9790 | tpr=0.8805 | fpr=0.0192 | 5678.6 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.07440 | acc=0.9792 | tpr=0.9083 | fpr=0.0195 | 7803.0 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.07660 | acc=0.9788 | tpr=0.9150 | fpr=0.0201 | 8054.1 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.07786 | acc=0.9784 | tpr=0.9169 | fpr=0.0205 | 8133.0 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.07790 | acc=0.9785 | tpr=0.9118 | fpr=0.0203 | 8136.0 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.07803 | acc=0.9783 | tpr=0.9113 | fpr=0.0205 | 7893.8 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.07848 | acc=0.9781 | tpr=0.9148 | fpr=0.0208 | 7850.6 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.07849 | acc=0.9782 | tpr=0.9147 | fpr=0.0207 | 8113.2 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.07958 | acc=0.9779 | tpr=0.9119 | fpr=0.0209 | 8293.7 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.07934 | acc=0.9778 | tpr=0.9145 | fpr=0.0210 | 8144.9 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.07866 | acc=0.9780 | tpr=0.9148 | fpr=0.0209 | 10496.5 samples/s | 41.0 steps/s
Avg test loss: 0.07848, Avg test acc: 0.97802, Avg tpr: 0.91521, Avg fpr: 0.02084, total FA: 2894

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.34849 | acc=0.5070 | tpr=0.4646 | fpr=0.4923 | 5642.7 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.34895 | acc=0.5004 | tpr=0.4478 | fpr=0.4986 | 8035.3 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.34884 | acc=0.4999 | tpr=0.4481 | fpr=0.4991 | 7525.8 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.34876 | acc=0.5004 | tpr=0.4448 | fpr=0.4986 | 8021.1 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.34867 | acc=0.5013 | tpr=0.4498 | fpr=0.4977 | 7900.0 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.34870 | acc=0.5011 | tpr=0.4407 | fpr=0.4978 | 8613.9 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.34866 | acc=0.5011 | tpr=0.4477 | fpr=0.4979 | 8672.4 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.34860 | acc=0.5016 | tpr=0.4437 | fpr=0.4974 | 7795.9 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.34857 | acc=0.5017 | tpr=0.4426 | fpr=0.4973 | 7262.6 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.34852 | acc=0.5023 | tpr=0.4454 | fpr=0.4966 | 8500.2 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.34852 | acc=0.5026 | tpr=0.4441 | fpr=0.4963 | 11075.8 samples/s | 43.3 steps/s
Avg test loss: 0.34853, Avg test acc: 0.50255, Avg tpr: 0.44453, Avg fpr: 0.49640, total FA: 68924

server round 3/50

clients selected: [1 4 5 6 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=29.3] | Loss=0.30581 | Reg=0.00240 | acc=0.7031 | L2-Norm=15.506 | L2-Norm(final)=5.868 | 5834.9 samples/s | 91.2 steps/s
[Step=6050 Epoch=29.5] | Loss=0.17996 | Reg=0.00240 | acc=0.8750 | L2-Norm=15.503 | L2-Norm(final)=5.934 | 5045.0 samples/s | 78.8 steps/s
[Step=6100 Epoch=29.8] | Loss=0.17240 | Reg=0.00240 | acc=0.8125 | L2-Norm=15.503 | L2-Norm(final)=6.048 | 5640.8 samples/s | 88.1 steps/s
[Step=6150 Epoch=30.0] | Loss=0.16913 | Reg=0.00240 | acc=0.9219 | L2-Norm=15.503 | L2-Norm(final)=6.159 | 5612.2 samples/s | 87.7 steps/s
[Step=6200 Epoch=30.3] | Loss=0.16576 | Reg=0.00240 | acc=0.8125 | L2-Norm=15.503 | L2-Norm(final)=6.264 | 8850.1 samples/s | 138.3 steps/s
[Step=6250 Epoch=30.5] | Loss=0.16326 | Reg=0.00240 | acc=0.8594 | L2-Norm=15.503 | L2-Norm(final)=6.368 | 2450.4 samples/s | 38.3 steps/s
[Step=6300 Epoch=30.7] | Loss=0.16120 | Reg=0.00240 | acc=0.9219 | L2-Norm=15.503 | L2-Norm(final)=6.466 | 5484.3 samples/s | 85.7 steps/s
[Step=6350 Epoch=31.0] | Loss=0.16043 | Reg=0.00240 | acc=0.8125 | L2-Norm=15.503 | L2-Norm(final)=6.561 | 5641.7 samples/s | 88.2 steps/s
[Step=6400 Epoch=31.2] | Loss=0.15926 | Reg=0.00240 | acc=0.8594 | L2-Norm=15.503 | L2-Norm(final)=6.651 | 7978.3 samples/s | 124.7 steps/s
[Step=6450 Epoch=31.5] | Loss=0.15830 | Reg=0.00240 | acc=0.9375 | L2-Norm=15.503 | L2-Norm(final)=6.737 | 2522.4 samples/s | 39.4 steps/s
[Step=6500 Epoch=31.7] | Loss=0.15736 | Reg=0.00240 | acc=0.8906 | L2-Norm=15.503 | L2-Norm(final)=6.821 | 5219.9 samples/s | 81.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=31.7] | Loss=0.11873 | Reg=0.00240 | acc=0.8906 | L2-Norm=15.503 | L2-Norm(final)=7.646 | 5947.0 samples/s | 92.9 steps/s
[Step=6550 Epoch=32.0] | Loss=0.13916 | Reg=0.00247 | acc=0.9219 | L2-Norm=15.723 | L2-Norm(final)=7.641 | 4297.5 samples/s | 67.1 steps/s
[Step=6600 Epoch=32.2] | Loss=0.12242 | Reg=0.00251 | acc=0.9062 | L2-Norm=15.838 | L2-Norm(final)=7.635 | 4765.2 samples/s | 74.5 steps/s
[Step=6650 Epoch=32.4] | Loss=0.11112 | Reg=0.00253 | acc=0.9688 | L2-Norm=15.895 | L2-Norm(final)=7.630 | 4869.1 samples/s | 76.1 steps/s
[Step=6700 Epoch=32.7] | Loss=0.10710 | Reg=0.00254 | acc=0.9375 | L2-Norm=15.936 | L2-Norm(final)=7.622 | 7039.8 samples/s | 110.0 steps/s
[Step=6750 Epoch=32.9] | Loss=0.09720 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.976 | L2-Norm(final)=7.617 | 2268.2 samples/s | 35.4 steps/s
[Step=6800 Epoch=33.2] | Loss=0.09103 | Reg=0.00256 | acc=0.9688 | L2-Norm=16.008 | L2-Norm(final)=7.615 | 4810.3 samples/s | 75.2 steps/s
[Step=6850 Epoch=33.4] | Loss=0.08570 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.039 | L2-Norm(final)=7.614 | 4849.5 samples/s | 75.8 steps/s
[Step=6900 Epoch=33.7] | Loss=0.08242 | Reg=0.00258 | acc=0.9844 | L2-Norm=16.068 | L2-Norm(final)=7.613 | 6446.1 samples/s | 100.7 steps/s
[Step=6950 Epoch=33.9] | Loss=0.07704 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.094 | L2-Norm(final)=7.612 | 2334.6 samples/s | 36.5 steps/s
[Step=7000 Epoch=34.2] | Loss=0.07300 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.117 | L2-Norm(final)=7.613 | 4845.3 samples/s | 75.7 steps/s
[Step=7050 Epoch=34.4] | Loss=0.06985 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.139 | L2-Norm(final)=7.613 | 4878.7 samples/s | 76.2 steps/s
[Step=7100 Epoch=34.6] | Loss=0.06782 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.159 | L2-Norm(final)=7.613 | 6043.9 samples/s | 94.4 steps/s
[Step=7150 Epoch=34.9] | Loss=0.06473 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.178 | L2-Norm(final)=7.613 | 2404.2 samples/s | 37.6 steps/s
[Step=7200 Epoch=35.1] | Loss=0.06180 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.196 | L2-Norm(final)=7.614 | 4841.4 samples/s | 75.6 steps/s
[Step=7250 Epoch=35.4] | Loss=0.05945 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.213 | L2-Norm(final)=7.616 | 4882.0 samples/s | 76.3 steps/s
[Step=7300 Epoch=35.6] | Loss=0.05779 | Reg=0.00263 | acc=0.9688 | L2-Norm=16.228 | L2-Norm(final)=7.616 | 5593.6 samples/s | 87.4 steps/s
[Step=7350 Epoch=35.9] | Loss=0.05602 | Reg=0.00264 | acc=0.9688 | L2-Norm=16.243 | L2-Norm(final)=7.617 | 2476.8 samples/s | 38.7 steps/s
[Step=7400 Epoch=36.1] | Loss=0.05401 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.257 | L2-Norm(final)=7.618 | 4876.3 samples/s | 76.2 steps/s
[Step=7450 Epoch=36.4] | Loss=0.05252 | Reg=0.00265 | acc=0.9688 | L2-Norm=16.271 | L2-Norm(final)=7.618 | 4768.8 samples/s | 74.5 steps/s
[Step=7500 Epoch=36.6] | Loss=0.05113 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.284 | L2-Norm(final)=7.619 | 5273.0 samples/s | 82.4 steps/s
[Step=7550 Epoch=36.8] | Loss=0.04989 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.297 | L2-Norm(final)=7.620 | 2572.5 samples/s | 40.2 steps/s
[Step=7600 Epoch=37.1] | Loss=0.04865 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.310 | L2-Norm(final)=7.621 | 4742.0 samples/s | 74.1 steps/s
[Step=7650 Epoch=37.3] | Loss=0.04723 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.321 | L2-Norm(final)=7.622 | 4864.5 samples/s | 76.0 steps/s
[Step=7700 Epoch=37.6] | Loss=0.04597 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.333 | L2-Norm(final)=7.623 | 4944.1 samples/s | 77.3 steps/s
[Step=7750 Epoch=37.8] | Loss=0.04461 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.344 | L2-Norm(final)=7.625 | 2615.7 samples/s | 40.9 steps/s
[Step=7800 Epoch=38.1] | Loss=0.04348 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.354 | L2-Norm(final)=7.627 | 4820.2 samples/s | 75.3 steps/s
[Step=7850 Epoch=38.3] | Loss=0.04243 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.364 | L2-Norm(final)=7.629 | 4863.1 samples/s | 76.0 steps/s
[Step=7900 Epoch=38.5] | Loss=0.04166 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.373 | L2-Norm(final)=7.630 | 4873.1 samples/s | 76.1 steps/s
[Step=7950 Epoch=38.8] | Loss=0.04083 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.382 | L2-Norm(final)=7.631 | 2609.2 samples/s | 40.8 steps/s
[Step=8000 Epoch=39.0] | Loss=0.04010 | Reg=0.00269 | acc=0.9688 | L2-Norm=16.392 | L2-Norm(final)=7.633 | 4830.7 samples/s | 75.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step8000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=19.6] | Loss=0.22416 | Reg=0.00240 | acc=0.8125 | L2-Norm=15.506 | L2-Norm(final)=4.931 | 6282.2 samples/s | 98.2 steps/s
[Step=4050 Epoch=19.9] | Loss=0.20063 | Reg=0.00240 | acc=0.7812 | L2-Norm=15.505 | L2-Norm(final)=5.042 | 4755.3 samples/s | 74.3 steps/s
[Step=4100 Epoch=20.1] | Loss=0.19782 | Reg=0.00240 | acc=0.8906 | L2-Norm=15.505 | L2-Norm(final)=5.180 | 5627.3 samples/s | 87.9 steps/s
[Step=4150 Epoch=20.4] | Loss=0.19450 | Reg=0.00240 | acc=0.8281 | L2-Norm=15.505 | L2-Norm(final)=5.313 | 5683.2 samples/s | 88.8 steps/s
[Step=4200 Epoch=20.6] | Loss=0.19161 | Reg=0.00240 | acc=0.8906 | L2-Norm=15.505 | L2-Norm(final)=5.439 | 8737.4 samples/s | 136.5 steps/s
[Step=4250 Epoch=20.8] | Loss=0.19037 | Reg=0.00240 | acc=0.7969 | L2-Norm=15.505 | L2-Norm(final)=5.558 | 2402.4 samples/s | 37.5 steps/s
[Step=4300 Epoch=21.1] | Loss=0.18734 | Reg=0.00240 | acc=0.8906 | L2-Norm=15.505 | L2-Norm(final)=5.670 | 5627.1 samples/s | 87.9 steps/s
[Step=4350 Epoch=21.3] | Loss=0.18608 | Reg=0.00240 | acc=0.9531 | L2-Norm=15.505 | L2-Norm(final)=5.777 | 5617.0 samples/s | 87.8 steps/s
[Step=4400 Epoch=21.6] | Loss=0.18435 | Reg=0.00240 | acc=0.8906 | L2-Norm=15.505 | L2-Norm(final)=5.879 | 8362.4 samples/s | 130.7 steps/s
[Step=4450 Epoch=21.8] | Loss=0.18253 | Reg=0.00240 | acc=0.8594 | L2-Norm=15.505 | L2-Norm(final)=5.977 | 2453.8 samples/s | 38.3 steps/s
[Step=4500 Epoch=22.1] | Loss=0.18152 | Reg=0.00240 | acc=0.7812 | L2-Norm=15.505 | L2-Norm(final)=6.071 | 5652.1 samples/s | 88.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=22.1] | Loss=0.17541 | Reg=0.00240 | acc=0.8438 | L2-Norm=15.505 | L2-Norm(final)=6.993 | 6176.2 samples/s | 96.5 steps/s
[Step=4550 Epoch=22.3] | Loss=0.13280 | Reg=0.00247 | acc=0.8750 | L2-Norm=15.728 | L2-Norm(final)=7.001 | 4252.6 samples/s | 66.4 steps/s
[Step=4600 Epoch=22.6] | Loss=0.12260 | Reg=0.00253 | acc=0.9062 | L2-Norm=15.893 | L2-Norm(final)=6.983 | 4819.3 samples/s | 75.3 steps/s
[Step=4650 Epoch=22.8] | Loss=0.11094 | Reg=0.00256 | acc=0.9219 | L2-Norm=15.989 | L2-Norm(final)=6.972 | 4846.5 samples/s | 75.7 steps/s
[Step=4700 Epoch=23.0] | Loss=0.10280 | Reg=0.00258 | acc=0.9531 | L2-Norm=16.055 | L2-Norm(final)=6.964 | 7093.6 samples/s | 110.8 steps/s
[Step=4750 Epoch=23.3] | Loss=0.09185 | Reg=0.00260 | acc=0.9688 | L2-Norm=16.109 | L2-Norm(final)=6.958 | 2251.0 samples/s | 35.2 steps/s
[Step=4800 Epoch=23.5] | Loss=0.08521 | Reg=0.00261 | acc=0.9375 | L2-Norm=16.155 | L2-Norm(final)=6.956 | 4894.1 samples/s | 76.5 steps/s
[Step=4850 Epoch=23.8] | Loss=0.08140 | Reg=0.00262 | acc=0.9531 | L2-Norm=16.195 | L2-Norm(final)=6.954 | 4830.4 samples/s | 75.5 steps/s
[Step=4900 Epoch=24.0] | Loss=0.07828 | Reg=0.00264 | acc=0.9531 | L2-Norm=16.234 | L2-Norm(final)=6.951 | 6717.7 samples/s | 105.0 steps/s
[Step=4950 Epoch=24.3] | Loss=0.07361 | Reg=0.00265 | acc=0.9688 | L2-Norm=16.268 | L2-Norm(final)=6.948 | 2305.7 samples/s | 36.0 steps/s
[Step=5000 Epoch=24.5] | Loss=0.06986 | Reg=0.00266 | acc=0.9531 | L2-Norm=16.298 | L2-Norm(final)=6.947 | 4892.7 samples/s | 76.4 steps/s
[Step=5050 Epoch=24.8] | Loss=0.06710 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.326 | L2-Norm(final)=6.945 | 4938.8 samples/s | 77.2 steps/s
[Step=5100 Epoch=25.0] | Loss=0.06423 | Reg=0.00267 | acc=0.9688 | L2-Norm=16.353 | L2-Norm(final)=6.944 | 6133.4 samples/s | 95.8 steps/s
[Step=5150 Epoch=25.3] | Loss=0.06138 | Reg=0.00268 | acc=0.9531 | L2-Norm=16.379 | L2-Norm(final)=6.944 | 2330.7 samples/s | 36.4 steps/s
[Step=5200 Epoch=25.5] | Loss=0.05865 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.402 | L2-Norm(final)=6.944 | 4886.3 samples/s | 76.3 steps/s
[Step=5250 Epoch=25.7] | Loss=0.05671 | Reg=0.00270 | acc=0.9844 | L2-Norm=16.424 | L2-Norm(final)=6.944 | 4855.5 samples/s | 75.9 steps/s
[Step=5300 Epoch=26.0] | Loss=0.05537 | Reg=0.00270 | acc=0.9844 | L2-Norm=16.444 | L2-Norm(final)=6.943 | 5934.4 samples/s | 92.7 steps/s
[Step=5350 Epoch=26.2] | Loss=0.05348 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.463 | L2-Norm(final)=6.942 | 2399.6 samples/s | 37.5 steps/s
[Step=5400 Epoch=26.5] | Loss=0.05163 | Reg=0.00272 | acc=0.9688 | L2-Norm=16.482 | L2-Norm(final)=6.941 | 4836.2 samples/s | 75.6 steps/s
[Step=5450 Epoch=26.7] | Loss=0.05003 | Reg=0.00272 | acc=0.9844 | L2-Norm=16.500 | L2-Norm(final)=6.940 | 4875.1 samples/s | 76.2 steps/s
[Step=5500 Epoch=27.0] | Loss=0.04874 | Reg=0.00273 | acc=0.9688 | L2-Norm=16.517 | L2-Norm(final)=6.939 | 5621.4 samples/s | 87.8 steps/s
[Step=5550 Epoch=27.2] | Loss=0.04737 | Reg=0.00273 | acc=0.9844 | L2-Norm=16.533 | L2-Norm(final)=6.938 | 2494.4 samples/s | 39.0 steps/s
[Step=5600 Epoch=27.5] | Loss=0.04620 | Reg=0.00274 | acc=0.9531 | L2-Norm=16.548 | L2-Norm(final)=6.937 | 4816.4 samples/s | 75.3 steps/s
[Step=5650 Epoch=27.7] | Loss=0.04518 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.562 | L2-Norm(final)=6.936 | 4792.1 samples/s | 74.9 steps/s
[Step=5700 Epoch=28.0] | Loss=0.04400 | Reg=0.00275 | acc=0.9844 | L2-Norm=16.575 | L2-Norm(final)=6.935 | 5348.8 samples/s | 83.6 steps/s
[Step=5750 Epoch=28.2] | Loss=0.04293 | Reg=0.00275 | acc=0.9688 | L2-Norm=16.587 | L2-Norm(final)=6.935 | 2510.1 samples/s | 39.2 steps/s
[Step=5800 Epoch=28.4] | Loss=0.04198 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.598 | L2-Norm(final)=6.934 | 4870.1 samples/s | 76.1 steps/s
[Step=5850 Epoch=28.7] | Loss=0.04101 | Reg=0.00276 | acc=0.9688 | L2-Norm=16.608 | L2-Norm(final)=6.933 | 4915.2 samples/s | 76.8 steps/s
[Step=5900 Epoch=28.9] | Loss=0.04006 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.619 | L2-Norm(final)=6.933 | 5043.0 samples/s | 78.8 steps/s
[Step=5950 Epoch=29.2] | Loss=0.03926 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.629 | L2-Norm(final)=6.934 | 2594.3 samples/s | 40.5 steps/s
[Step=6000 Epoch=29.4] | Loss=0.03858 | Reg=0.00277 | acc=0.9844 | L2-Norm=16.639 | L2-Norm(final)=6.934 | 4868.8 samples/s | 76.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step6000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=56.9] | Loss=0.05528 | Reg=0.00240 | acc=0.9531 | L2-Norm=15.506 | L2-Norm(final)=9.188 | 5488.2 samples/s | 85.8 steps/s
[Step=6050 Epoch=57.3] | Loss=0.05954 | Reg=0.00240 | acc=0.9531 | L2-Norm=15.492 | L2-Norm(final)=9.279 | 4698.3 samples/s | 73.4 steps/s
[Step=6100 Epoch=57.8] | Loss=0.05576 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.491 | L2-Norm(final)=9.397 | 8209.7 samples/s | 128.3 steps/s
[Step=6150 Epoch=58.3] | Loss=0.05558 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.490 | L2-Norm(final)=9.508 | 2345.8 samples/s | 36.7 steps/s
[Step=6200 Epoch=58.8] | Loss=0.05437 | Reg=0.00240 | acc=0.9375 | L2-Norm=15.490 | L2-Norm(final)=9.613 | 7268.1 samples/s | 113.6 steps/s
[Step=6250 Epoch=59.2] | Loss=0.05373 | Reg=0.00240 | acc=0.9375 | L2-Norm=15.490 | L2-Norm(final)=9.712 | 2441.6 samples/s | 38.1 steps/s
[Step=6300 Epoch=59.7] | Loss=0.05310 | Reg=0.00240 | acc=0.9375 | L2-Norm=15.489 | L2-Norm(final)=9.806 | 6653.9 samples/s | 104.0 steps/s
[Step=6350 Epoch=60.2] | Loss=0.05214 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.489 | L2-Norm(final)=9.896 | 2535.0 samples/s | 39.6 steps/s
[Step=6400 Epoch=60.6] | Loss=0.05189 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.489 | L2-Norm(final)=9.981 | 6032.0 samples/s | 94.3 steps/s
[Step=6450 Epoch=61.1] | Loss=0.05113 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.489 | L2-Norm(final)=10.063 | 2629.6 samples/s | 41.1 steps/s
[Step=6500 Epoch=61.6] | Loss=0.05058 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.489 | L2-Norm(final)=10.144 | 5436.8 samples/s | 85.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=61.6] | Loss=0.03557 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.489 | L2-Norm(final)=10.939 | 5804.5 samples/s | 90.7 steps/s
[Step=6550 Epoch=62.1] | Loss=0.03078 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.881 | L2-Norm(final)=10.929 | 4100.9 samples/s | 64.1 steps/s
[Step=6600 Epoch=62.5] | Loss=0.02285 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.072 | L2-Norm(final)=10.907 | 6743.3 samples/s | 105.4 steps/s
[Step=6650 Epoch=63.0] | Loss=0.01753 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.151 | L2-Norm(final)=10.891 | 2219.9 samples/s | 34.7 steps/s
[Step=6700 Epoch=63.5] | Loss=0.01444 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.174 | L2-Norm(final)=10.881 | 5949.8 samples/s | 93.0 steps/s
[Step=6750 Epoch=64.0] | Loss=0.01185 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.162 | L2-Norm(final)=10.876 | 2293.2 samples/s | 35.8 steps/s
[Step=6800 Epoch=64.4] | Loss=0.00989 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.131 | L2-Norm(final)=10.874 | 5414.3 samples/s | 84.6 steps/s
[Step=6850 Epoch=64.9] | Loss=0.00849 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.091 | L2-Norm(final)=10.872 | 2371.8 samples/s | 37.1 steps/s
[Step=6900 Epoch=65.4] | Loss=0.00743 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.045 | L2-Norm(final)=10.871 | 5062.7 samples/s | 79.1 steps/s
[Step=6950 Epoch=65.9] | Loss=0.00661 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.996 | L2-Norm(final)=10.871 | 2474.4 samples/s | 38.7 steps/s
[Step=7000 Epoch=66.3] | Loss=0.00595 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.945 | L2-Norm(final)=10.871 | 4613.1 samples/s | 72.1 steps/s
[Step=7050 Epoch=66.8] | Loss=0.00541 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.894 | L2-Norm(final)=10.871 | 2595.9 samples/s | 40.6 steps/s
[Step=7100 Epoch=67.3] | Loss=0.00496 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.842 | L2-Norm(final)=10.871 | 4527.7 samples/s | 70.7 steps/s
[Step=7150 Epoch=67.8] | Loss=0.00458 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.790 | L2-Norm(final)=10.871 | 2573.4 samples/s | 40.2 steps/s
[Step=7200 Epoch=68.2] | Loss=0.00426 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.738 | L2-Norm(final)=10.871 | 4635.0 samples/s | 72.4 steps/s
[Step=7250 Epoch=68.7] | Loss=0.00397 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.687 | L2-Norm(final)=10.871 | 2571.9 samples/s | 40.2 steps/s
[Step=7300 Epoch=69.2] | Loss=0.00373 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.635 | L2-Norm(final)=10.871 | 4619.1 samples/s | 72.2 steps/s
[Step=7350 Epoch=69.6] | Loss=0.00351 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.585 | L2-Norm(final)=10.871 | 2691.6 samples/s | 42.1 steps/s
[Step=7400 Epoch=70.1] | Loss=0.00331 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.534 | L2-Norm(final)=10.872 | 4372.4 samples/s | 68.3 steps/s
[Step=7450 Epoch=70.6] | Loss=0.00314 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.484 | L2-Norm(final)=10.872 | 6820.0 samples/s | 106.6 steps/s
[Step=7500 Epoch=71.1] | Loss=0.00298 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.435 | L2-Norm(final)=10.872 | 2179.4 samples/s | 34.1 steps/s
[Step=7550 Epoch=71.5] | Loss=0.00284 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.386 | L2-Norm(final)=10.873 | 6224.8 samples/s | 97.3 steps/s
[Step=7600 Epoch=72.0] | Loss=0.00271 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.337 | L2-Norm(final)=10.873 | 2227.5 samples/s | 34.8 steps/s
[Step=7650 Epoch=72.5] | Loss=0.00260 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.289 | L2-Norm(final)=10.873 | 5719.3 samples/s | 89.4 steps/s
[Step=7700 Epoch=73.0] | Loss=0.00249 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.241 | L2-Norm(final)=10.873 | 2328.5 samples/s | 36.4 steps/s
[Step=7750 Epoch=73.4] | Loss=0.00239 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.194 | L2-Norm(final)=10.874 | 5250.3 samples/s | 82.0 steps/s
[Step=7800 Epoch=73.9] | Loss=0.00230 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.147 | L2-Norm(final)=10.874 | 2413.1 samples/s | 37.7 steps/s
[Step=7850 Epoch=74.4] | Loss=0.00221 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.101 | L2-Norm(final)=10.874 | 4873.4 samples/s | 76.1 steps/s
[Step=7900 Epoch=74.9] | Loss=0.00213 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.055 | L2-Norm(final)=10.875 | 2552.7 samples/s | 39.9 steps/s
[Step=7950 Epoch=75.3] | Loss=0.00206 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.009 | L2-Norm(final)=10.875 | 4667.1 samples/s | 72.9 steps/s
[Step=8000 Epoch=75.8] | Loss=0.00199 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.963 | L2-Norm(final)=10.875 | 2511.1 samples/s | 39.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step8000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=57.1] | Loss=0.06027 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.506 | L2-Norm(final)=8.767 | 5033.3 samples/s | 78.6 steps/s
[Step=6050 Epoch=57.6] | Loss=0.07053 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.494 | L2-Norm(final)=8.824 | 4735.9 samples/s | 74.0 steps/s
[Step=6100 Epoch=58.0] | Loss=0.06981 | Reg=0.00240 | acc=0.8906 | L2-Norm=15.493 | L2-Norm(final)=8.902 | 8329.2 samples/s | 130.1 steps/s
[Step=6150 Epoch=58.5] | Loss=0.06826 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.492 | L2-Norm(final)=8.980 | 2329.9 samples/s | 36.4 steps/s
[Step=6200 Epoch=59.0] | Loss=0.06733 | Reg=0.00240 | acc=0.9375 | L2-Norm=15.492 | L2-Norm(final)=9.057 | 7402.4 samples/s | 115.7 steps/s
[Step=6250 Epoch=59.5] | Loss=0.06686 | Reg=0.00240 | acc=0.9531 | L2-Norm=15.492 | L2-Norm(final)=9.129 | 2467.9 samples/s | 38.6 steps/s
[Step=6300 Epoch=59.9] | Loss=0.06610 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.492 | L2-Norm(final)=9.198 | 6495.1 samples/s | 101.5 steps/s
[Step=6350 Epoch=60.4] | Loss=0.06561 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.492 | L2-Norm(final)=9.264 | 2554.4 samples/s | 39.9 steps/s
[Step=6400 Epoch=60.9] | Loss=0.06490 | Reg=0.00240 | acc=0.9531 | L2-Norm=15.492 | L2-Norm(final)=9.329 | 5842.1 samples/s | 91.3 steps/s
[Step=6450 Epoch=61.4] | Loss=0.06494 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.492 | L2-Norm(final)=9.391 | 2667.3 samples/s | 41.7 steps/s
[Step=6500 Epoch=61.8] | Loss=0.06435 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.492 | L2-Norm(final)=9.451 | 5457.0 samples/s | 85.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=61.8] | Loss=0.05342 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.491 | L2-Norm(final)=10.050 | 6088.3 samples/s | 95.1 steps/s
[Step=6550 Epoch=62.3] | Loss=0.04070 | Reg=0.00252 | acc=0.9375 | L2-Norm=15.864 | L2-Norm(final)=10.048 | 4186.7 samples/s | 65.4 steps/s
[Step=6600 Epoch=62.8] | Loss=0.02435 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.093 | L2-Norm(final)=10.026 | 6647.4 samples/s | 103.9 steps/s
[Step=6650 Epoch=63.3] | Loss=0.01662 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.151 | L2-Norm(final)=10.022 | 2198.6 samples/s | 34.4 steps/s
[Step=6700 Epoch=63.7] | Loss=0.01254 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.148 | L2-Norm(final)=10.022 | 6120.6 samples/s | 95.6 steps/s
[Step=6750 Epoch=64.2] | Loss=0.01005 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.119 | L2-Norm(final)=10.023 | 2268.6 samples/s | 35.4 steps/s
[Step=6800 Epoch=64.7] | Loss=0.00838 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.079 | L2-Norm(final)=10.024 | 5592.5 samples/s | 87.4 steps/s
[Step=6850 Epoch=65.2] | Loss=0.00719 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.033 | L2-Norm(final)=10.025 | 2371.4 samples/s | 37.1 steps/s
[Step=6900 Epoch=65.6] | Loss=0.00630 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.985 | L2-Norm(final)=10.025 | 5075.3 samples/s | 79.3 steps/s
[Step=6950 Epoch=66.1] | Loss=0.00560 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.934 | L2-Norm(final)=10.026 | 2452.4 samples/s | 38.3 steps/s
[Step=7000 Epoch=66.6] | Loss=0.00504 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.883 | L2-Norm(final)=10.027 | 4784.9 samples/s | 74.8 steps/s
[Step=7050 Epoch=67.1] | Loss=0.00458 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.832 | L2-Norm(final)=10.028 | 2554.2 samples/s | 39.9 steps/s
[Step=7100 Epoch=67.5] | Loss=0.00420 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.781 | L2-Norm(final)=10.028 | 4668.1 samples/s | 72.9 steps/s
[Step=7150 Epoch=68.0] | Loss=0.00388 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.730 | L2-Norm(final)=10.029 | 2587.5 samples/s | 40.4 steps/s
[Step=7200 Epoch=68.5] | Loss=0.00360 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.680 | L2-Norm(final)=10.030 | 4692.4 samples/s | 73.3 steps/s
[Step=7250 Epoch=69.0] | Loss=0.00336 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.630 | L2-Norm(final)=10.030 | 2550.0 samples/s | 39.8 steps/s
[Step=7300 Epoch=69.4] | Loss=0.00315 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.581 | L2-Norm(final)=10.031 | 4654.9 samples/s | 72.7 steps/s
[Step=7350 Epoch=69.9] | Loss=0.00297 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.532 | L2-Norm(final)=10.032 | 2662.7 samples/s | 41.6 steps/s
[Step=7400 Epoch=70.4] | Loss=0.00281 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.484 | L2-Norm(final)=10.032 | 4407.6 samples/s | 68.9 steps/s
[Step=7450 Epoch=70.9] | Loss=0.00266 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.436 | L2-Norm(final)=10.033 | 6842.1 samples/s | 106.9 steps/s
[Step=7500 Epoch=71.3] | Loss=0.00253 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.389 | L2-Norm(final)=10.033 | 2195.1 samples/s | 34.3 steps/s
[Step=7550 Epoch=71.8] | Loss=0.00241 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.342 | L2-Norm(final)=10.034 | 6227.8 samples/s | 97.3 steps/s
[Step=7600 Epoch=72.3] | Loss=0.00230 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.295 | L2-Norm(final)=10.034 | 2241.4 samples/s | 35.0 steps/s
[Step=7650 Epoch=72.8] | Loss=0.00220 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.249 | L2-Norm(final)=10.035 | 5717.4 samples/s | 89.3 steps/s
[Step=7700 Epoch=73.2] | Loss=0.00211 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.204 | L2-Norm(final)=10.035 | 2347.7 samples/s | 36.7 steps/s
[Step=7750 Epoch=73.7] | Loss=0.00202 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.159 | L2-Norm(final)=10.036 | 5198.7 samples/s | 81.2 steps/s
[Step=7800 Epoch=74.2] | Loss=0.00194 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.114 | L2-Norm(final)=10.036 | 2409.4 samples/s | 37.6 steps/s
[Step=7850 Epoch=74.7] | Loss=0.00187 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.069 | L2-Norm(final)=10.037 | 4869.0 samples/s | 76.1 steps/s
[Step=7900 Epoch=75.1] | Loss=0.00181 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.025 | L2-Norm(final)=10.037 | 2494.7 samples/s | 39.0 steps/s
[Step=7950 Epoch=75.6] | Loss=0.00174 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.982 | L2-Norm(final)=10.037 | 4722.8 samples/s | 73.8 steps/s
[Step=8000 Epoch=76.1] | Loss=0.00169 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.938 | L2-Norm(final)=10.038 | 2545.6 samples/s | 39.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step8000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35526 | Reg=0.00240 | acc=0.4219 | L2-Norm=15.506 | L2-Norm(final)=2.019 | 5747.7 samples/s | 89.8 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.30519 | Reg=0.00240 | acc=0.7500 | L2-Norm=15.506 | L2-Norm(final)=2.064 | 4938.3 samples/s | 77.2 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.27826 | Reg=0.00240 | acc=0.8906 | L2-Norm=15.506 | L2-Norm(final)=2.182 | 9787.4 samples/s | 152.9 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.25623 | Reg=0.00240 | acc=0.8438 | L2-Norm=15.506 | L2-Norm(final)=2.342 | 2479.7 samples/s | 38.7 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.23911 | Reg=0.00240 | acc=0.8594 | L2-Norm=15.506 | L2-Norm(final)=2.524 | 8413.5 samples/s | 131.5 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.22501 | Reg=0.00240 | acc=0.9219 | L2-Norm=15.506 | L2-Norm(final)=2.713 | 2536.9 samples/s | 39.6 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.21327 | Reg=0.00240 | acc=0.8750 | L2-Norm=15.506 | L2-Norm(final)=2.903 | 7840.0 samples/s | 122.5 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.20336 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.506 | L2-Norm(final)=3.090 | 2607.6 samples/s | 40.7 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.19486 | Reg=0.00240 | acc=0.9062 | L2-Norm=15.506 | L2-Norm(final)=3.274 | 7319.0 samples/s | 114.4 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.18758 | Reg=0.00240 | acc=0.8906 | L2-Norm=15.506 | L2-Norm(final)=3.451 | 2721.5 samples/s | 42.5 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.18087 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.506 | L2-Norm(final)=3.622 | 6599.7 samples/s | 103.1 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.8] | Loss=0.14550 | Reg=0.00240 | acc=0.9062 | L2-Norm=15.506 | L2-Norm(final)=5.305 | 5475.6 samples/s | 85.6 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.04435 | Reg=0.00240 | acc=0.9375 | L2-Norm=15.476 | L2-Norm(final)=5.372 | 4396.5 samples/s | 68.7 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.02633 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.487 | L2-Norm(final)=5.393 | 6502.6 samples/s | 101.6 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01798 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.482 | L2-Norm(final)=5.412 | 2190.0 samples/s | 34.2 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01427 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.463 | L2-Norm(final)=5.425 | 6263.7 samples/s | 97.9 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01169 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.445 | L2-Norm(final)=5.434 | 2241.2 samples/s | 35.0 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.00977 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.424 | L2-Norm(final)=5.441 | 5753.0 samples/s | 89.9 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.00838 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.395 | L2-Norm(final)=5.447 | 2312.1 samples/s | 36.1 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.00734 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.361 | L2-Norm(final)=5.452 | 5369.2 samples/s | 83.9 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.00653 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.324 | L2-Norm(final)=5.456 | 2432.1 samples/s | 38.0 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.00588 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.284 | L2-Norm(final)=5.459 | 4926.7 samples/s | 77.0 steps/s
[Step=1050 Epoch=10.0] | Loss=0.00534 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.242 | L2-Norm(final)=5.462 | 2445.6 samples/s | 38.2 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00490 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.199 | L2-Norm(final)=5.464 | 4751.4 samples/s | 74.2 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00452 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.154 | L2-Norm(final)=5.467 | 2558.1 samples/s | 40.0 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00420 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.109 | L2-Norm(final)=5.469 | 4627.0 samples/s | 72.3 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00392 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.063 | L2-Norm(final)=5.471 | 2583.4 samples/s | 40.4 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00368 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.016 | L2-Norm(final)=5.472 | 4665.1 samples/s | 72.9 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00346 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.970 | L2-Norm(final)=5.474 | 2545.8 samples/s | 39.8 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00327 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.922 | L2-Norm(final)=5.475 | 4634.6 samples/s | 72.4 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00310 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.875 | L2-Norm(final)=5.477 | 2565.6 samples/s | 40.1 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00294 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.827 | L2-Norm(final)=5.478 | 4661.3 samples/s | 72.8 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00281 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.780 | L2-Norm(final)=5.479 | 7310.4 samples/s | 114.2 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00268 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.732 | L2-Norm(final)=5.480 | 2126.3 samples/s | 33.2 steps/s
[Step=1650 Epoch=15.7] | Loss=0.00256 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.684 | L2-Norm(final)=5.482 | 6769.0 samples/s | 105.8 steps/s
[Step=1700 Epoch=16.2] | Loss=0.00246 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.636 | L2-Norm(final)=5.483 | 2181.7 samples/s | 34.1 steps/s
[Step=1750 Epoch=16.7] | Loss=0.00236 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.588 | L2-Norm(final)=5.484 | 6153.5 samples/s | 96.1 steps/s
[Step=1800 Epoch=17.2] | Loss=0.00227 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.540 | L2-Norm(final)=5.485 | 2258.0 samples/s | 35.3 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00218 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.493 | L2-Norm(final)=5.486 | 5769.3 samples/s | 90.1 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00211 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.445 | L2-Norm(final)=5.487 | 2324.0 samples/s | 36.3 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00203 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.397 | L2-Norm(final)=5.488 | 5368.6 samples/s | 83.9 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00197 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.350 | L2-Norm(final)=5.489 | 2400.7 samples/s | 37.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.34545 | acc=0.5387 | tpr=0.6026 | fpr=0.5999 | 5732.1 samples/s | 22.4 steps/s
Avg test loss: 0.34575, Avg test acc: 0.53746, Avg tpr: 0.59876, Avg fpr: 0.59736, total FA: 4660

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.17523 | acc=0.9294 | tpr=0.9673 | fpr=0.1529 | 5781.2 samples/s | 22.6 steps/s
Avg test loss: 0.17721, Avg test acc: 0.92776, Avg tpr: 0.96550, Avg fpr: 0.15524, total FA: 1211

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.14032 | acc=0.9305 | tpr=0.9464 | fpr=0.1038 | 5663.8 samples/s | 22.1 steps/s
Avg test loss: 0.14153, Avg test acc: 0.92872, Avg tpr: 0.94387, Avg fpr: 0.10460, total FA: 816

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.13895 | acc=0.9334 | tpr=0.9604 | fpr=0.1254 | 5613.5 samples/s | 21.9 steps/s
Avg test loss: 0.14417, Avg test acc: 0.93353, Avg tpr: 0.96112, Avg fpr: 0.12716, total FA: 992

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.14992 | acc=0.9260 | tpr=0.9335 | fpr=0.0902 | 5608.4 samples/s | 21.9 steps/s
Avg test loss: 0.15234, Avg test acc: 0.92511, Avg tpr: 0.93198, Avg fpr: 0.08999, total FA: 702

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.10510 | acc=0.3183 | tpr=0.0152 | fpr=0.0235 | 5707.1 samples/s | 22.3 steps/s
Avg test loss: 4.12573, Avg test acc: 0.31649, Avg tpr: 0.01562, Avg fpr: 0.02179, total FA: 170

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.65713 | acc=0.3120 | tpr=0.0167 | fpr=0.0468 | 5616.1 samples/s | 21.9 steps/s
Avg test loss: 4.67860, Avg test acc: 0.31064, Avg tpr: 0.01714, Avg fpr: 0.04384, total FA: 342

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=0.34545 | acc=0.5387 | tpr=0.6026 | fpr=0.5999 | 5787.6 samples/s | 22.6 steps/s
Avg test loss: 0.34575, Avg test acc: 0.53746, Avg tpr: 0.59876, Avg fpr: 0.59736, total FA: 4660

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=6.38633 | acc=0.3070 | tpr=0.0288 | fpr=0.0889 | 5683.1 samples/s | 22.2 steps/s
Avg test loss: 6.41717, Avg test acc: 0.30603, Avg tpr: 0.02984, Avg fpr: 0.08653, total FA: 675

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.49817 | acc=0.3037 | tpr=0.0278 | fpr=0.0974 | 5773.4 samples/s | 22.6 steps/s
Avg test loss: 5.52585, Avg test acc: 0.30231, Avg tpr: 0.02821, Avg fpr: 0.09486, total FA: 740

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=0.34849 | acc=0.5070 | tpr=0.4646 | fpr=0.4923 | 5697.2 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.34895 | acc=0.5004 | tpr=0.4478 | fpr=0.4986 | 8124.3 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.34884 | acc=0.4999 | tpr=0.4481 | fpr=0.4991 | 8192.6 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.34876 | acc=0.5004 | tpr=0.4448 | fpr=0.4986 | 7592.3 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.34867 | acc=0.5013 | tpr=0.4498 | fpr=0.4977 | 8162.6 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.34870 | acc=0.5011 | tpr=0.4407 | fpr=0.4978 | 7835.1 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.34866 | acc=0.5011 | tpr=0.4477 | fpr=0.4979 | 8072.4 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.34860 | acc=0.5016 | tpr=0.4437 | fpr=0.4974 | 8015.7 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.34857 | acc=0.5017 | tpr=0.4426 | fpr=0.4973 | 7779.7 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.34852 | acc=0.5023 | tpr=0.4454 | fpr=0.4966 | 8313.1 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.34852 | acc=0.5026 | tpr=0.4441 | fpr=0.4963 | 10938.0 samples/s | 42.7 steps/s
Avg test loss: 0.34853, Avg test acc: 0.50255, Avg tpr: 0.44453, Avg fpr: 0.49640, total FA: 68924

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.38594 | acc=0.1050 | tpr=0.6372 | fpr=0.9046 | 5579.9 samples/s | 21.8 steps/s
[Step= 100] | Loss=4.36312 | acc=0.1053 | tpr=0.6247 | fpr=0.9044 | 8328.4 samples/s | 32.5 steps/s
[Step= 150] | Loss=4.36423 | acc=0.1046 | tpr=0.6354 | fpr=0.9052 | 7828.7 samples/s | 30.6 steps/s
[Step= 200] | Loss=4.36043 | acc=0.1042 | tpr=0.6470 | fpr=0.9056 | 7966.6 samples/s | 31.1 steps/s
[Step= 250] | Loss=4.36457 | acc=0.1045 | tpr=0.6489 | fpr=0.9054 | 7987.9 samples/s | 31.2 steps/s
[Step= 300] | Loss=4.36420 | acc=0.1043 | tpr=0.6400 | fpr=0.9054 | 7696.6 samples/s | 30.1 steps/s
[Step= 350] | Loss=4.36709 | acc=0.1042 | tpr=0.6274 | fpr=0.9053 | 8402.4 samples/s | 32.8 steps/s
[Step= 400] | Loss=4.37022 | acc=0.1039 | tpr=0.6307 | fpr=0.9057 | 7872.2 samples/s | 30.8 steps/s
[Step= 450] | Loss=4.37030 | acc=0.1039 | tpr=0.6266 | fpr=0.9055 | 8790.7 samples/s | 34.3 steps/s
[Step= 500] | Loss=4.37384 | acc=0.1039 | tpr=0.6256 | fpr=0.9055 | 8120.0 samples/s | 31.7 steps/s
[Step= 550] | Loss=4.37254 | acc=0.1041 | tpr=0.6347 | fpr=0.9056 | 10028.4 samples/s | 39.2 steps/s
Avg test loss: 4.37260, Avg test acc: 0.10400, Avg tpr: 0.63431, Avg fpr: 0.90564, total FA: 125746

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.23511 | acc=0.1317 | tpr=0.6726 | fpr=0.8780 | 5575.6 samples/s | 21.8 steps/s
[Step= 100] | Loss=4.22466 | acc=0.1305 | tpr=0.6311 | fpr=0.8788 | 7743.3 samples/s | 30.2 steps/s
[Step= 150] | Loss=4.24525 | acc=0.1302 | tpr=0.6340 | fpr=0.8791 | 8102.9 samples/s | 31.7 steps/s
[Step= 200] | Loss=4.24582 | acc=0.1298 | tpr=0.6273 | fpr=0.8792 | 7709.2 samples/s | 30.1 steps/s
[Step= 250] | Loss=4.25266 | acc=0.1300 | tpr=0.6245 | fpr=0.8790 | 8050.7 samples/s | 31.4 steps/s
[Step= 300] | Loss=4.25601 | acc=0.1299 | tpr=0.6269 | fpr=0.8791 | 8375.1 samples/s | 32.7 steps/s
[Step= 350] | Loss=4.25777 | acc=0.1295 | tpr=0.6149 | fpr=0.8793 | 8000.2 samples/s | 31.3 steps/s
[Step= 400] | Loss=4.25836 | acc=0.1299 | tpr=0.6138 | fpr=0.8789 | 8345.9 samples/s | 32.6 steps/s
[Step= 450] | Loss=4.25635 | acc=0.1301 | tpr=0.6154 | fpr=0.8787 | 8126.4 samples/s | 31.7 steps/s
[Step= 500] | Loss=4.25841 | acc=0.1305 | tpr=0.6167 | fpr=0.8783 | 7674.7 samples/s | 30.0 steps/s
[Step= 550] | Loss=4.25434 | acc=0.1308 | tpr=0.6204 | fpr=0.8781 | 11016.4 samples/s | 43.0 steps/s
Avg test loss: 4.25412, Avg test acc: 0.13074, Avg tpr: 0.62084, Avg fpr: 0.87817, total FA: 121932

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.99147 | acc=0.1152 | tpr=0.7080 | fpr=0.8954 | 5806.2 samples/s | 22.7 steps/s
[Step= 100] | Loss=4.95215 | acc=0.1143 | tpr=0.6610 | fpr=0.8959 | 7746.5 samples/s | 30.3 steps/s
[Step= 150] | Loss=4.95165 | acc=0.1124 | tpr=0.6455 | fpr=0.8974 | 7833.2 samples/s | 30.6 steps/s
[Step= 200] | Loss=4.95064 | acc=0.1121 | tpr=0.6448 | fpr=0.8976 | 8217.6 samples/s | 32.1 steps/s
[Step= 250] | Loss=4.95432 | acc=0.1127 | tpr=0.6629 | fpr=0.8974 | 8088.7 samples/s | 31.6 steps/s
[Step= 300] | Loss=4.95535 | acc=0.1123 | tpr=0.6589 | fpr=0.8976 | 8060.8 samples/s | 31.5 steps/s
[Step= 350] | Loss=4.95945 | acc=0.1118 | tpr=0.6475 | fpr=0.8979 | 8382.6 samples/s | 32.7 steps/s
[Step= 400] | Loss=4.95392 | acc=0.1126 | tpr=0.6488 | fpr=0.8972 | 7929.7 samples/s | 31.0 steps/s
[Step= 450] | Loss=4.95034 | acc=0.1125 | tpr=0.6519 | fpr=0.8973 | 8128.4 samples/s | 31.8 steps/s
[Step= 500] | Loss=4.94953 | acc=0.1124 | tpr=0.6449 | fpr=0.8972 | 7261.7 samples/s | 28.4 steps/s
[Step= 550] | Loss=4.94879 | acc=0.1125 | tpr=0.6442 | fpr=0.8971 | 11222.4 samples/s | 43.8 steps/s
Avg test loss: 4.94921, Avg test acc: 0.11248, Avg tpr: 0.64461, Avg fpr: 0.89719, total FA: 124573

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=3.81128 | acc=0.1607 | tpr=0.4336 | fpr=0.8442 | 5737.8 samples/s | 22.4 steps/s
[Step= 100] | Loss=3.79868 | acc=0.1611 | tpr=0.4606 | fpr=0.8445 | 7122.8 samples/s | 27.8 steps/s
[Step= 150] | Loss=3.81144 | acc=0.1590 | tpr=0.4424 | fpr=0.8462 | 8553.8 samples/s | 33.4 steps/s
[Step= 200] | Loss=3.81438 | acc=0.1581 | tpr=0.4361 | fpr=0.8470 | 7850.3 samples/s | 30.7 steps/s
[Step= 250] | Loss=3.81833 | acc=0.1584 | tpr=0.4454 | fpr=0.8468 | 8587.0 samples/s | 33.5 steps/s
[Step= 300] | Loss=3.81170 | acc=0.1590 | tpr=0.4560 | fpr=0.8465 | 8280.8 samples/s | 32.3 steps/s
[Step= 350] | Loss=3.81622 | acc=0.1584 | tpr=0.4483 | fpr=0.8469 | 8030.8 samples/s | 31.4 steps/s
[Step= 400] | Loss=3.81255 | acc=0.1591 | tpr=0.4497 | fpr=0.8462 | 8395.1 samples/s | 32.8 steps/s
[Step= 450] | Loss=3.81155 | acc=0.1596 | tpr=0.4518 | fpr=0.8457 | 8161.0 samples/s | 31.9 steps/s
[Step= 500] | Loss=3.81405 | acc=0.1592 | tpr=0.4546 | fpr=0.8461 | 7797.0 samples/s | 30.5 steps/s
[Step= 550] | Loss=3.81216 | acc=0.1594 | tpr=0.4548 | fpr=0.8460 | 10018.1 samples/s | 39.1 steps/s
Avg test loss: 3.81256, Avg test acc: 0.15924, Avg tpr: 0.45483, Avg fpr: 0.84613, total FA: 117484

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08059 | acc=0.9775 | tpr=0.8938 | fpr=0.0210 | 5799.7 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.08176 | acc=0.9771 | tpr=0.9104 | fpr=0.0216 | 8105.9 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.08446 | acc=0.9759 | tpr=0.9164 | fpr=0.0230 | 7855.0 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.08459 | acc=0.9762 | tpr=0.9213 | fpr=0.0228 | 7202.6 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.08424 | acc=0.9764 | tpr=0.9162 | fpr=0.0225 | 8533.9 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.08571 | acc=0.9761 | tpr=0.9156 | fpr=0.0228 | 8037.0 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.08637 | acc=0.9758 | tpr=0.9148 | fpr=0.0230 | 8270.8 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.08754 | acc=0.9755 | tpr=0.9125 | fpr=0.0233 | 8109.8 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.08868 | acc=0.9753 | tpr=0.9138 | fpr=0.0235 | 7929.0 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.08811 | acc=0.9753 | tpr=0.9154 | fpr=0.0236 | 8645.0 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.08732 | acc=0.9756 | tpr=0.9168 | fpr=0.0234 | 10285.4 samples/s | 40.2 steps/s
Avg test loss: 0.08719, Avg test acc: 0.97560, Avg tpr: 0.91719, Avg fpr: 0.02333, total FA: 3240

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.06959 | acc=0.9840 | tpr=0.8540 | fpr=0.0137 | 5670.7 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.07392 | acc=0.9832 | tpr=0.8721 | fpr=0.0148 | 7908.3 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.07651 | acc=0.9824 | tpr=0.8804 | fpr=0.0157 | 7985.3 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.07724 | acc=0.9825 | tpr=0.8820 | fpr=0.0157 | 8007.4 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.07682 | acc=0.9825 | tpr=0.8777 | fpr=0.0156 | 7986.1 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.07740 | acc=0.9825 | tpr=0.8807 | fpr=0.0156 | 8463.1 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.07784 | acc=0.9823 | tpr=0.8817 | fpr=0.0159 | 8178.8 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.07831 | acc=0.9821 | tpr=0.8780 | fpr=0.0160 | 7936.2 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.07955 | acc=0.9818 | tpr=0.8768 | fpr=0.0163 | 8195.2 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.07915 | acc=0.9820 | tpr=0.8797 | fpr=0.0162 | 7878.3 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.07873 | acc=0.9820 | tpr=0.8782 | fpr=0.0161 | 10722.6 samples/s | 41.9 steps/s
Avg test loss: 0.07862, Avg test acc: 0.98203, Avg tpr: 0.87758, Avg fpr: 0.01607, total FA: 2231

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.34849 | acc=0.5070 | tpr=0.4646 | fpr=0.4923 | 5579.4 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.34895 | acc=0.5004 | tpr=0.4478 | fpr=0.4986 | 8038.6 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.34884 | acc=0.4999 | tpr=0.4481 | fpr=0.4991 | 7899.8 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.34876 | acc=0.5004 | tpr=0.4448 | fpr=0.4986 | 8654.9 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.34867 | acc=0.5013 | tpr=0.4498 | fpr=0.4977 | 8263.0 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.34870 | acc=0.5011 | tpr=0.4407 | fpr=0.4978 | 7942.6 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.34866 | acc=0.5011 | tpr=0.4477 | fpr=0.4979 | 7998.8 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.34860 | acc=0.5016 | tpr=0.4437 | fpr=0.4974 | 7886.4 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.34857 | acc=0.5017 | tpr=0.4426 | fpr=0.4973 | 8097.1 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.34852 | acc=0.5023 | tpr=0.4454 | fpr=0.4966 | 8017.0 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.34852 | acc=0.5026 | tpr=0.4441 | fpr=0.4963 | 9865.7 samples/s | 38.5 steps/s
Avg test loss: 0.34853, Avg test acc: 0.50255, Avg tpr: 0.44453, Avg fpr: 0.49640, total FA: 68924

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.07284 | acc=0.9790 | tpr=0.8805 | fpr=0.0192 | 5433.7 samples/s | 21.2 steps/s
[Step= 100] | Loss=0.07440 | acc=0.9792 | tpr=0.9083 | fpr=0.0195 | 8148.0 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.07660 | acc=0.9788 | tpr=0.9150 | fpr=0.0201 | 8232.7 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.07786 | acc=0.9784 | tpr=0.9169 | fpr=0.0205 | 8111.4 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.07790 | acc=0.9785 | tpr=0.9118 | fpr=0.0203 | 8145.2 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.07803 | acc=0.9783 | tpr=0.9113 | fpr=0.0205 | 8579.4 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.07848 | acc=0.9781 | tpr=0.9148 | fpr=0.0208 | 7528.7 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.07849 | acc=0.9782 | tpr=0.9147 | fpr=0.0207 | 8122.4 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.07958 | acc=0.9779 | tpr=0.9119 | fpr=0.0209 | 8124.6 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.07934 | acc=0.9778 | tpr=0.9145 | fpr=0.0210 | 8268.2 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.07866 | acc=0.9780 | tpr=0.9148 | fpr=0.0209 | 9773.7 samples/s | 38.2 steps/s
Avg test loss: 0.07848, Avg test acc: 0.97802, Avg tpr: 0.91521, Avg fpr: 0.02084, total FA: 2894

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.08523 | acc=0.9766 | tpr=0.8982 | fpr=0.0220 | 5704.0 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.08353 | acc=0.9780 | tpr=0.9275 | fpr=0.0210 | 8169.6 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.08595 | acc=0.9773 | tpr=0.9337 | fpr=0.0219 | 7511.3 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.08766 | acc=0.9771 | tpr=0.9366 | fpr=0.0221 | 8166.5 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.08773 | acc=0.9772 | tpr=0.9284 | fpr=0.0219 | 8743.3 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.08880 | acc=0.9767 | tpr=0.9251 | fpr=0.0224 | 8320.8 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.08894 | acc=0.9766 | tpr=0.9236 | fpr=0.0224 | 7500.0 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.08947 | acc=0.9764 | tpr=0.9234 | fpr=0.0226 | 7600.4 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.09065 | acc=0.9761 | tpr=0.9197 | fpr=0.0229 | 8352.9 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.09038 | acc=0.9762 | tpr=0.9203 | fpr=0.0228 | 8245.5 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.08986 | acc=0.9762 | tpr=0.9172 | fpr=0.0227 | 10601.5 samples/s | 41.4 steps/s
Avg test loss: 0.08966, Avg test acc: 0.97623, Avg tpr: 0.91759, Avg fpr: 0.02270, total FA: 3152

server round 4/50

clients selected: [5 6 7 8 9]

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=75.8] | Loss=0.07001 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.537 | L2-Norm(final)=10.884 | 5932.4 samples/s | 92.7 steps/s
[Step=8050 Epoch=76.3] | Loss=0.03642 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.524 | L2-Norm(final)=10.812 | 4676.8 samples/s | 73.1 steps/s
[Step=8100 Epoch=76.8] | Loss=0.03094 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.522 | L2-Norm(final)=10.814 | 7978.2 samples/s | 124.7 steps/s
[Step=8150 Epoch=77.2] | Loss=0.02971 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.521 | L2-Norm(final)=10.835 | 2337.7 samples/s | 36.5 steps/s
[Step=8200 Epoch=77.7] | Loss=0.02968 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.521 | L2-Norm(final)=10.862 | 7419.0 samples/s | 115.9 steps/s
[Step=8250 Epoch=78.2] | Loss=0.02932 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.521 | L2-Norm(final)=10.893 | 2440.1 samples/s | 38.1 steps/s
[Step=8300 Epoch=78.6] | Loss=0.02858 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.521 | L2-Norm(final)=10.925 | 6615.9 samples/s | 103.4 steps/s
[Step=8350 Epoch=79.1] | Loss=0.02792 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.521 | L2-Norm(final)=10.962 | 2530.6 samples/s | 39.5 steps/s
[Step=8400 Epoch=79.6] | Loss=0.02794 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.521 | L2-Norm(final)=10.999 | 5919.3 samples/s | 92.5 steps/s
[Step=8450 Epoch=80.1] | Loss=0.02750 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.521 | L2-Norm(final)=11.035 | 2628.9 samples/s | 41.1 steps/s
[Step=8500 Epoch=80.5] | Loss=0.02735 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.521 | L2-Norm(final)=11.074 | 5514.2 samples/s | 86.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=80.6] | Loss=0.00957 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.520 | L2-Norm(final)=11.473 | 5463.0 samples/s | 85.4 steps/s
[Step=8550 Epoch=81.0] | Loss=0.03061 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.055 | L2-Norm(final)=11.430 | 4307.0 samples/s | 67.3 steps/s
[Step=8600 Epoch=81.5] | Loss=0.02226 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.298 | L2-Norm(final)=11.405 | 6633.2 samples/s | 103.6 steps/s
[Step=8650 Epoch=82.0] | Loss=0.01552 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.356 | L2-Norm(final)=11.399 | 2207.8 samples/s | 34.5 steps/s
[Step=8700 Epoch=82.4] | Loss=0.01193 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.351 | L2-Norm(final)=11.397 | 5974.9 samples/s | 93.4 steps/s
[Step=8750 Epoch=82.9] | Loss=0.00970 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.324 | L2-Norm(final)=11.397 | 2274.0 samples/s | 35.5 steps/s
[Step=8800 Epoch=83.4] | Loss=0.00809 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.286 | L2-Norm(final)=11.397 | 5577.2 samples/s | 87.1 steps/s
[Step=8850 Epoch=83.9] | Loss=0.00694 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.242 | L2-Norm(final)=11.398 | 2390.7 samples/s | 37.4 steps/s
[Step=8900 Epoch=84.3] | Loss=0.00608 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.194 | L2-Norm(final)=11.399 | 5028.1 samples/s | 78.6 steps/s
[Step=8950 Epoch=84.8] | Loss=0.00541 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.145 | L2-Norm(final)=11.400 | 2443.0 samples/s | 38.2 steps/s
[Step=9000 Epoch=85.3] | Loss=0.00487 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.095 | L2-Norm(final)=11.400 | 4740.0 samples/s | 74.1 steps/s
[Step=9050 Epoch=85.8] | Loss=0.00443 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.045 | L2-Norm(final)=11.401 | 2533.7 samples/s | 39.6 steps/s
[Step=9100 Epoch=86.2] | Loss=0.00406 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.995 | L2-Norm(final)=11.402 | 4677.1 samples/s | 73.1 steps/s
[Step=9150 Epoch=86.7] | Loss=0.00375 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.945 | L2-Norm(final)=11.403 | 2594.6 samples/s | 40.5 steps/s
[Step=9200 Epoch=87.2] | Loss=0.00348 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.896 | L2-Norm(final)=11.403 | 4649.1 samples/s | 72.6 steps/s
[Step=9250 Epoch=87.7] | Loss=0.00325 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.848 | L2-Norm(final)=11.404 | 2525.3 samples/s | 39.5 steps/s
[Step=9300 Epoch=88.1] | Loss=0.00305 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.800 | L2-Norm(final)=11.405 | 4691.7 samples/s | 73.3 steps/s
[Step=9350 Epoch=88.6] | Loss=0.00287 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.752 | L2-Norm(final)=11.405 | 2739.3 samples/s | 42.8 steps/s
[Step=9400 Epoch=89.1] | Loss=0.00271 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.705 | L2-Norm(final)=11.406 | 4382.2 samples/s | 68.5 steps/s
[Step=9450 Epoch=89.5] | Loss=0.00257 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.659 | L2-Norm(final)=11.406 | 6872.3 samples/s | 107.4 steps/s
[Step=9500 Epoch=90.0] | Loss=0.00244 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.613 | L2-Norm(final)=11.407 | 2175.1 samples/s | 34.0 steps/s
[Step=9550 Epoch=90.5] | Loss=0.00232 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.568 | L2-Norm(final)=11.407 | 6179.7 samples/s | 96.6 steps/s
[Step=9600 Epoch=91.0] | Loss=0.00222 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.523 | L2-Norm(final)=11.408 | 2254.0 samples/s | 35.2 steps/s
[Step=9650 Epoch=91.4] | Loss=0.00212 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.478 | L2-Norm(final)=11.408 | 5748.2 samples/s | 89.8 steps/s
[Step=9700 Epoch=91.9] | Loss=0.00203 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.435 | L2-Norm(final)=11.409 | 2342.3 samples/s | 36.6 steps/s
[Step=9750 Epoch=92.4] | Loss=0.00195 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.391 | L2-Norm(final)=11.409 | 5170.5 samples/s | 80.8 steps/s
[Step=9800 Epoch=92.9] | Loss=0.00188 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.348 | L2-Norm(final)=11.410 | 2393.6 samples/s | 37.4 steps/s
[Step=9850 Epoch=93.3] | Loss=0.00181 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.306 | L2-Norm(final)=11.410 | 4858.0 samples/s | 75.9 steps/s
[Step=9900 Epoch=93.8] | Loss=0.00174 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.263 | L2-Norm(final)=11.411 | 2484.4 samples/s | 38.8 steps/s
[Step=9950 Epoch=94.3] | Loss=0.00168 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.222 | L2-Norm(final)=11.411 | 4591.2 samples/s | 71.7 steps/s
[Step=10000 Epoch=94.8] | Loss=0.00163 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.180 | L2-Norm(final)=11.412 | 2553.4 samples/s | 39.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step10000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=76.1] | Loss=0.05924 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.537 | L2-Norm(final)=10.050 | 5781.4 samples/s | 90.3 steps/s
[Step=8050 Epoch=76.6] | Loss=0.04439 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.524 | L2-Norm(final)=10.001 | 4521.9 samples/s | 70.7 steps/s
[Step=8100 Epoch=77.1] | Loss=0.04103 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.523 | L2-Norm(final)=9.976 | 8465.4 samples/s | 132.3 steps/s
[Step=8150 Epoch=77.5] | Loss=0.03955 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.522 | L2-Norm(final)=9.981 | 2359.4 samples/s | 36.9 steps/s
[Step=8200 Epoch=78.0] | Loss=0.03850 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.522 | L2-Norm(final)=9.992 | 7286.3 samples/s | 113.8 steps/s
[Step=8250 Epoch=78.5] | Loss=0.03785 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.522 | L2-Norm(final)=10.010 | 2440.4 samples/s | 38.1 steps/s
[Step=8300 Epoch=79.0] | Loss=0.03771 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.522 | L2-Norm(final)=10.031 | 6679.9 samples/s | 104.4 steps/s
[Step=8350 Epoch=79.4] | Loss=0.03706 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.522 | L2-Norm(final)=10.055 | 2557.4 samples/s | 40.0 steps/s
[Step=8400 Epoch=79.9] | Loss=0.03689 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.522 | L2-Norm(final)=10.081 | 5959.5 samples/s | 93.1 steps/s
[Step=8450 Epoch=80.4] | Loss=0.03658 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.522 | L2-Norm(final)=10.107 | 2664.9 samples/s | 41.6 steps/s
[Step=8500 Epoch=80.9] | Loss=0.03685 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.522 | L2-Norm(final)=10.134 | 5459.7 samples/s | 85.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=80.9] | Loss=0.01510 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.521 | L2-Norm(final)=10.395 | 5909.9 samples/s | 92.3 steps/s
[Step=8550 Epoch=81.3] | Loss=0.02735 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.968 | L2-Norm(final)=10.373 | 4082.4 samples/s | 63.8 steps/s
[Step=8600 Epoch=81.8] | Loss=0.01653 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.171 | L2-Norm(final)=10.362 | 6720.3 samples/s | 105.0 steps/s
[Step=8650 Epoch=82.3] | Loss=0.01126 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.214 | L2-Norm(final)=10.359 | 2215.2 samples/s | 34.6 steps/s
[Step=8700 Epoch=82.8] | Loss=0.00848 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.202 | L2-Norm(final)=10.359 | 6063.6 samples/s | 94.7 steps/s
[Step=8750 Epoch=83.2] | Loss=0.00679 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.166 | L2-Norm(final)=10.360 | 2285.5 samples/s | 35.7 steps/s
[Step=8800 Epoch=83.7] | Loss=0.00566 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.121 | L2-Norm(final)=10.361 | 5495.5 samples/s | 85.9 steps/s
[Step=8850 Epoch=84.2] | Loss=0.00486 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.071 | L2-Norm(final)=10.361 | 2334.8 samples/s | 36.5 steps/s
[Step=8900 Epoch=84.7] | Loss=0.00425 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.018 | L2-Norm(final)=10.362 | 5141.9 samples/s | 80.3 steps/s
[Step=8950 Epoch=85.1] | Loss=0.00378 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.965 | L2-Norm(final)=10.363 | 2459.5 samples/s | 38.4 steps/s
[Step=9000 Epoch=85.6] | Loss=0.00340 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.912 | L2-Norm(final)=10.364 | 4742.0 samples/s | 74.1 steps/s
[Step=9050 Epoch=86.1] | Loss=0.00310 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.858 | L2-Norm(final)=10.364 | 2530.7 samples/s | 39.5 steps/s
[Step=9100 Epoch=86.6] | Loss=0.00284 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.806 | L2-Norm(final)=10.365 | 4655.1 samples/s | 72.7 steps/s
[Step=9150 Epoch=87.0] | Loss=0.00262 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.754 | L2-Norm(final)=10.366 | 2574.2 samples/s | 40.2 steps/s
[Step=9200 Epoch=87.5] | Loss=0.00244 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.702 | L2-Norm(final)=10.366 | 4594.3 samples/s | 71.8 steps/s
[Step=9250 Epoch=88.0] | Loss=0.00227 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.652 | L2-Norm(final)=10.367 | 2585.6 samples/s | 40.4 steps/s
[Step=9300 Epoch=88.5] | Loss=0.00213 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.602 | L2-Norm(final)=10.367 | 4624.5 samples/s | 72.3 steps/s
[Step=9350 Epoch=88.9] | Loss=0.00201 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.552 | L2-Norm(final)=10.368 | 2749.5 samples/s | 43.0 steps/s
[Step=9400 Epoch=89.4] | Loss=0.00190 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.504 | L2-Norm(final)=10.369 | 4222.2 samples/s | 66.0 steps/s
[Step=9450 Epoch=89.9] | Loss=0.00180 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.455 | L2-Norm(final)=10.369 | 7011.4 samples/s | 109.6 steps/s
[Step=9500 Epoch=90.4] | Loss=0.00171 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.408 | L2-Norm(final)=10.370 | 2172.3 samples/s | 33.9 steps/s
[Step=9550 Epoch=90.8] | Loss=0.00163 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.361 | L2-Norm(final)=10.370 | 6212.4 samples/s | 97.1 steps/s
[Step=9600 Epoch=91.3] | Loss=0.00155 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.315 | L2-Norm(final)=10.371 | 2263.6 samples/s | 35.4 steps/s
[Step=9650 Epoch=91.8] | Loss=0.00149 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.269 | L2-Norm(final)=10.371 | 5770.5 samples/s | 90.2 steps/s
[Step=9700 Epoch=92.3] | Loss=0.00142 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.223 | L2-Norm(final)=10.371 | 2318.4 samples/s | 36.2 steps/s
[Step=9750 Epoch=92.7] | Loss=0.00137 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.179 | L2-Norm(final)=10.372 | 5283.4 samples/s | 82.6 steps/s
[Step=9800 Epoch=93.2] | Loss=0.00131 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.134 | L2-Norm(final)=10.372 | 2418.3 samples/s | 37.8 steps/s
[Step=9850 Epoch=93.7] | Loss=0.00127 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.090 | L2-Norm(final)=10.373 | 4917.1 samples/s | 76.8 steps/s
[Step=9900 Epoch=94.2] | Loss=0.00122 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.047 | L2-Norm(final)=10.373 | 2521.6 samples/s | 39.4 steps/s
[Step=9950 Epoch=94.6] | Loss=0.00118 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.003 | L2-Norm(final)=10.374 | 4605.9 samples/s | 72.0 steps/s
[Step=10000 Epoch=95.1] | Loss=0.00114 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=10.374 | 2568.4 samples/s | 40.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step10000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.39082 | Reg=0.00211 | acc=0.2812 | L2-Norm=14.537 | L2-Norm(final)=2.018 | 6176.4 samples/s | 96.5 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.31237 | Reg=0.00211 | acc=0.8438 | L2-Norm=14.537 | L2-Norm(final)=2.059 | 4646.0 samples/s | 72.6 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.26554 | Reg=0.00211 | acc=0.9219 | L2-Norm=14.537 | L2-Norm(final)=2.190 | 10200.9 samples/s | 159.4 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.23410 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.537 | L2-Norm(final)=2.360 | 2482.8 samples/s | 38.8 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.21008 | Reg=0.00211 | acc=0.9219 | L2-Norm=14.537 | L2-Norm(final)=2.540 | 8604.3 samples/s | 134.4 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.19189 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.537 | L2-Norm(final)=2.721 | 2557.3 samples/s | 40.0 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.17803 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.537 | L2-Norm(final)=2.897 | 7859.5 samples/s | 122.8 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.16639 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.537 | L2-Norm(final)=3.066 | 2649.5 samples/s | 41.4 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.15696 | Reg=0.00211 | acc=0.8906 | L2-Norm=14.537 | L2-Norm(final)=3.228 | 7174.3 samples/s | 112.1 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.14922 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.537 | L2-Norm(final)=3.382 | 2716.7 samples/s | 42.4 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.14260 | Reg=0.00211 | acc=0.8438 | L2-Norm=14.537 | L2-Norm(final)=3.530 | 6531.5 samples/s | 102.1 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.8] | Loss=0.07484 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.537 | L2-Norm(final)=4.975 | 5873.1 samples/s | 91.8 steps/s
[Step= 550 Epoch= 5.3] | Loss=0.03253 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.574 | L2-Norm(final)=5.014 | 4080.5 samples/s | 63.8 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01902 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.609 | L2-Norm(final)=5.025 | 6771.8 samples/s | 105.8 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01287 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.621 | L2-Norm(final)=5.035 | 2160.0 samples/s | 33.7 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.00969 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.615 | L2-Norm(final)=5.042 | 6277.5 samples/s | 98.1 steps/s
[Step= 750 Epoch= 7.2] | Loss=0.00776 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.600 | L2-Norm(final)=5.047 | 2251.8 samples/s | 35.2 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.00647 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.578 | L2-Norm(final)=5.051 | 5815.1 samples/s | 90.9 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.00555 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.552 | L2-Norm(final)=5.054 | 2315.5 samples/s | 36.2 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.00486 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.524 | L2-Norm(final)=5.057 | 5323.7 samples/s | 83.2 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.00432 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.492 | L2-Norm(final)=5.059 | 2397.6 samples/s | 37.5 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.00389 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.459 | L2-Norm(final)=5.061 | 5000.3 samples/s | 78.1 steps/s
[Step=1050 Epoch=10.0] | Loss=0.00354 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.425 | L2-Norm(final)=5.063 | 2447.2 samples/s | 38.2 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00325 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.390 | L2-Norm(final)=5.065 | 4729.7 samples/s | 73.9 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00300 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.354 | L2-Norm(final)=5.066 | 2529.5 samples/s | 39.5 steps/s
[Step=1200 Epoch=11.5] | Loss=0.00278 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.317 | L2-Norm(final)=5.068 | 4670.1 samples/s | 73.0 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00260 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.279 | L2-Norm(final)=5.069 | 2581.9 samples/s | 40.3 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00244 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.241 | L2-Norm(final)=5.071 | 4582.4 samples/s | 71.6 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00229 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.202 | L2-Norm(final)=5.072 | 2586.2 samples/s | 40.4 steps/s
[Step=1400 Epoch=13.4] | Loss=0.00217 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.163 | L2-Norm(final)=5.073 | 4625.0 samples/s | 72.3 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00205 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=5.074 | 2597.4 samples/s | 40.6 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00195 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.083 | L2-Norm(final)=5.075 | 4553.4 samples/s | 71.1 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00186 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.043 | L2-Norm(final)=5.076 | 7491.6 samples/s | 117.1 steps/s
[Step=1600 Epoch=15.3] | Loss=0.00177 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.002 | L2-Norm(final)=5.077 | 2130.2 samples/s | 33.3 steps/s
[Step=1650 Epoch=15.8] | Loss=0.00170 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.962 | L2-Norm(final)=5.078 | 6733.0 samples/s | 105.2 steps/s
[Step=1700 Epoch=16.2] | Loss=0.00163 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.921 | L2-Norm(final)=5.079 | 2195.2 samples/s | 34.3 steps/s
[Step=1750 Epoch=16.7] | Loss=0.00156 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.880 | L2-Norm(final)=5.080 | 6052.2 samples/s | 94.6 steps/s
[Step=1800 Epoch=17.2] | Loss=0.00150 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.838 | L2-Norm(final)=5.081 | 2266.8 samples/s | 35.4 steps/s
[Step=1850 Epoch=17.7] | Loss=0.00145 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.797 | L2-Norm(final)=5.082 | 5623.4 samples/s | 87.9 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00140 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.756 | L2-Norm(final)=5.083 | 2319.6 samples/s | 36.2 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00135 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=5.084 | 5338.1 samples/s | 83.4 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00130 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.672 | L2-Norm(final)=5.085 | 2406.3 samples/s | 37.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step2000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch=18.9] | Loss=0.07324 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.537 | L2-Norm(final)=4.986 | 5893.6 samples/s | 92.1 steps/s
[Step=2050 Epoch=19.3] | Loss=0.07043 | Reg=0.00211 | acc=0.9219 | L2-Norm=14.524 | L2-Norm(final)=5.237 | 4770.4 samples/s | 74.5 steps/s
[Step=2100 Epoch=19.8] | Loss=0.06578 | Reg=0.00211 | acc=0.9219 | L2-Norm=14.522 | L2-Norm(final)=5.525 | 7966.6 samples/s | 124.5 steps/s
[Step=2150 Epoch=20.3] | Loss=0.06249 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.522 | L2-Norm(final)=5.772 | 2355.1 samples/s | 36.8 steps/s
[Step=2200 Epoch=20.7] | Loss=0.06055 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.522 | L2-Norm(final)=5.986 | 6949.4 samples/s | 108.6 steps/s
[Step=2250 Epoch=21.2] | Loss=0.05946 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.522 | L2-Norm(final)=6.180 | 2468.8 samples/s | 38.6 steps/s
[Step=2300 Epoch=21.7] | Loss=0.05838 | Reg=0.00211 | acc=0.9219 | L2-Norm=14.521 | L2-Norm(final)=6.354 | 6219.1 samples/s | 97.2 steps/s
[Step=2350 Epoch=22.1] | Loss=0.05718 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.521 | L2-Norm(final)=6.515 | 2562.9 samples/s | 40.0 steps/s
[Step=2400 Epoch=22.6] | Loss=0.05599 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.521 | L2-Norm(final)=6.664 | 5710.8 samples/s | 89.2 steps/s
[Step=2450 Epoch=23.1] | Loss=0.05530 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.521 | L2-Norm(final)=6.804 | 2698.5 samples/s | 42.2 steps/s
[Step=2500 Epoch=23.6] | Loss=0.05467 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.521 | L2-Norm(final)=6.936 | 5348.1 samples/s | 83.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.6] | Loss=0.06770 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.521 | L2-Norm(final)=8.220 | 5531.4 samples/s | 86.4 steps/s
[Step=2550 Epoch=24.0] | Loss=0.06324 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.086 | L2-Norm(final)=8.171 | 4257.3 samples/s | 66.5 steps/s
[Step=2600 Epoch=24.5] | Loss=0.03517 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.373 | L2-Norm(final)=8.150 | 6656.5 samples/s | 104.0 steps/s
[Step=2650 Epoch=25.0] | Loss=0.02442 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.446 | L2-Norm(final)=8.148 | 2227.9 samples/s | 34.8 steps/s
[Step=2700 Epoch=25.4] | Loss=0.01849 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.457 | L2-Norm(final)=8.150 | 5828.7 samples/s | 91.1 steps/s
[Step=2750 Epoch=25.9] | Loss=0.01481 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.442 | L2-Norm(final)=8.152 | 2279.4 samples/s | 35.6 steps/s
[Step=2800 Epoch=26.4] | Loss=0.01235 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.413 | L2-Norm(final)=8.154 | 5379.8 samples/s | 84.1 steps/s
[Step=2850 Epoch=26.9] | Loss=0.01059 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.377 | L2-Norm(final)=8.156 | 2408.7 samples/s | 37.6 steps/s
[Step=2900 Epoch=27.3] | Loss=0.00927 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.338 | L2-Norm(final)=8.157 | 4858.4 samples/s | 75.9 steps/s
[Step=2950 Epoch=27.8] | Loss=0.00824 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.297 | L2-Norm(final)=8.158 | 2512.4 samples/s | 39.3 steps/s
[Step=3000 Epoch=28.3] | Loss=0.00742 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.255 | L2-Norm(final)=8.159 | 4648.6 samples/s | 72.6 steps/s
[Step=3050 Epoch=28.7] | Loss=0.00674 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.212 | L2-Norm(final)=8.160 | 2612.8 samples/s | 40.8 steps/s
[Step=3100 Epoch=29.2] | Loss=0.00618 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.169 | L2-Norm(final)=8.161 | 4505.1 samples/s | 70.4 steps/s
[Step=3150 Epoch=29.7] | Loss=0.00571 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.127 | L2-Norm(final)=8.162 | 2553.3 samples/s | 39.9 steps/s
[Step=3200 Epoch=30.2] | Loss=0.00530 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.084 | L2-Norm(final)=8.163 | 4682.9 samples/s | 73.2 steps/s
[Step=3250 Epoch=30.6] | Loss=0.00495 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.042 | L2-Norm(final)=8.164 | 2668.6 samples/s | 41.7 steps/s
[Step=3300 Epoch=31.1] | Loss=0.00464 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.000 | L2-Norm(final)=8.164 | 4355.8 samples/s | 68.1 steps/s
[Step=3350 Epoch=31.6] | Loss=0.00437 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.958 | L2-Norm(final)=8.165 | 6679.1 samples/s | 104.4 steps/s
[Step=3400 Epoch=32.0] | Loss=0.00413 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.917 | L2-Norm(final)=8.165 | 2197.3 samples/s | 34.3 steps/s
[Step=3450 Epoch=32.5] | Loss=0.00391 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.876 | L2-Norm(final)=8.166 | 6067.9 samples/s | 94.8 steps/s
[Step=3500 Epoch=33.0] | Loss=0.00371 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.835 | L2-Norm(final)=8.167 | 2292.4 samples/s | 35.8 steps/s
[Step=3550 Epoch=33.5] | Loss=0.00354 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.795 | L2-Norm(final)=8.167 | 5274.5 samples/s | 82.4 steps/s
[Step=3600 Epoch=33.9] | Loss=0.00338 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.755 | L2-Norm(final)=8.168 | 2422.6 samples/s | 37.9 steps/s
[Step=3650 Epoch=34.4] | Loss=0.00323 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.715 | L2-Norm(final)=8.168 | 4818.0 samples/s | 75.3 steps/s
[Step=3700 Epoch=34.9] | Loss=0.00310 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.676 | L2-Norm(final)=8.169 | 2509.0 samples/s | 39.2 steps/s
[Step=3750 Epoch=35.3] | Loss=0.00297 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.637 | L2-Norm(final)=8.169 | 4642.9 samples/s | 72.5 steps/s
[Step=3800 Epoch=35.8] | Loss=0.00286 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.598 | L2-Norm(final)=8.170 | 2564.7 samples/s | 40.1 steps/s
[Step=3850 Epoch=36.3] | Loss=0.00275 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.560 | L2-Norm(final)=8.170 | 4729.1 samples/s | 73.9 steps/s
[Step=3900 Epoch=36.7] | Loss=0.00265 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.522 | L2-Norm(final)=8.170 | 2540.2 samples/s | 39.7 steps/s
[Step=3950 Epoch=37.2] | Loss=0.00256 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.484 | L2-Norm(final)=8.171 | 4728.7 samples/s | 73.9 steps/s
[Step=4000 Epoch=37.7] | Loss=0.00248 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.446 | L2-Norm(final)=8.171 | 2671.2 samples/s | 41.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step4000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch=19.1] | Loss=0.08709 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.537 | L2-Norm(final)=5.517 | 5580.3 samples/s | 87.2 steps/s
[Step=2050 Epoch=19.5] | Loss=0.07171 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.521 | L2-Norm(final)=5.704 | 4696.8 samples/s | 73.4 steps/s
[Step=2100 Epoch=20.0] | Loss=0.06874 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.519 | L2-Norm(final)=5.943 | 8523.6 samples/s | 133.2 steps/s
[Step=2150 Epoch=20.5] | Loss=0.06744 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.518 | L2-Norm(final)=6.164 | 2369.8 samples/s | 37.0 steps/s
[Step=2200 Epoch=21.0] | Loss=0.06506 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.518 | L2-Norm(final)=6.365 | 7418.8 samples/s | 115.9 steps/s
[Step=2250 Epoch=21.4] | Loss=0.06427 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.518 | L2-Norm(final)=6.545 | 2376.2 samples/s | 37.1 steps/s
[Step=2300 Epoch=21.9] | Loss=0.06290 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.518 | L2-Norm(final)=6.713 | 6937.4 samples/s | 108.4 steps/s
[Step=2350 Epoch=22.4] | Loss=0.06174 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.518 | L2-Norm(final)=6.870 | 2468.9 samples/s | 38.6 steps/s
[Step=2400 Epoch=22.9] | Loss=0.06085 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.518 | L2-Norm(final)=7.021 | 6351.9 samples/s | 99.2 steps/s
[Step=2450 Epoch=23.4] | Loss=0.06001 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.518 | L2-Norm(final)=7.161 | 2541.2 samples/s | 39.7 steps/s
[Step=2500 Epoch=23.8] | Loss=0.05978 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.518 | L2-Norm(final)=7.296 | 5932.7 samples/s | 92.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.8] | Loss=0.02585 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.517 | L2-Norm(final)=8.603 | 5704.0 samples/s | 89.1 steps/s
[Step=2550 Epoch=24.3] | Loss=0.04029 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.257 | L2-Norm(final)=8.578 | 4158.6 samples/s | 65.0 steps/s
[Step=2600 Epoch=24.8] | Loss=0.02562 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.510 | L2-Norm(final)=8.561 | 6804.6 samples/s | 106.3 steps/s
[Step=2650 Epoch=25.3] | Loss=0.01736 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.586 | L2-Norm(final)=8.563 | 2185.2 samples/s | 34.1 steps/s
[Step=2700 Epoch=25.7] | Loss=0.01308 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.592 | L2-Norm(final)=8.567 | 6248.3 samples/s | 97.6 steps/s
[Step=2750 Epoch=26.2] | Loss=0.01049 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.571 | L2-Norm(final)=8.570 | 2247.8 samples/s | 35.1 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00875 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.536 | L2-Norm(final)=8.573 | 5809.5 samples/s | 90.8 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00750 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.494 | L2-Norm(final)=8.575 | 2312.0 samples/s | 36.1 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00657 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.448 | L2-Norm(final)=8.577 | 5350.6 samples/s | 83.6 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00584 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.400 | L2-Norm(final)=8.578 | 2393.2 samples/s | 37.4 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00526 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.350 | L2-Norm(final)=8.579 | 5013.0 samples/s | 78.3 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00478 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.300 | L2-Norm(final)=8.581 | 2450.0 samples/s | 38.3 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00438 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.249 | L2-Norm(final)=8.582 | 4708.1 samples/s | 73.6 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00404 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.199 | L2-Norm(final)=8.583 | 2583.5 samples/s | 40.4 steps/s
[Step=3200 Epoch=30.5] | Loss=0.00376 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.149 | L2-Norm(final)=8.583 | 4517.0 samples/s | 70.6 steps/s
[Step=3250 Epoch=31.0] | Loss=0.00351 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.099 | L2-Norm(final)=8.584 | 2604.0 samples/s | 40.7 steps/s
[Step=3300 Epoch=31.5] | Loss=0.00329 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.049 | L2-Norm(final)=8.585 | 4594.1 samples/s | 71.8 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00310 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.000 | L2-Norm(final)=8.586 | 2617.5 samples/s | 40.9 steps/s
[Step=3400 Epoch=32.4] | Loss=0.00292 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.951 | L2-Norm(final)=8.586 | 4491.6 samples/s | 70.2 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00277 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.902 | L2-Norm(final)=8.587 | 2555.0 samples/s | 39.9 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00263 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.854 | L2-Norm(final)=8.588 | 4626.4 samples/s | 72.3 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00251 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.806 | L2-Norm(final)=8.588 | 7431.0 samples/s | 116.1 steps/s
[Step=3600 Epoch=34.3] | Loss=0.00239 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.759 | L2-Norm(final)=8.589 | 2130.0 samples/s | 33.3 steps/s
[Step=3650 Epoch=34.8] | Loss=0.00229 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.712 | L2-Norm(final)=8.589 | 6835.7 samples/s | 106.8 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00219 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.665 | L2-Norm(final)=8.590 | 2212.0 samples/s | 34.6 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00211 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.618 | L2-Norm(final)=8.591 | 6103.9 samples/s | 95.4 steps/s
[Step=3800 Epoch=36.2] | Loss=0.00203 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.572 | L2-Norm(final)=8.591 | 2236.7 samples/s | 34.9 steps/s
[Step=3850 Epoch=36.7] | Loss=0.00195 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.527 | L2-Norm(final)=8.592 | 5646.7 samples/s | 88.2 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00188 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.481 | L2-Norm(final)=8.592 | 2323.5 samples/s | 36.3 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00182 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.436 | L2-Norm(final)=8.593 | 5247.7 samples/s | 82.0 steps/s
[Step=4000 Epoch=38.1] | Loss=0.00176 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.391 | L2-Norm(final)=8.593 | 2406.5 samples/s | 37.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.34545 | acc=0.5387 | tpr=0.6026 | fpr=0.5999 | 5632.0 samples/s | 22.0 steps/s
Avg test loss: 0.34575, Avg test acc: 0.53746, Avg tpr: 0.59876, Avg fpr: 0.59736, total FA: 4660

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.17523 | acc=0.9294 | tpr=0.9673 | fpr=0.1529 | 5599.1 samples/s | 21.9 steps/s
Avg test loss: 0.17721, Avg test acc: 0.92776, Avg tpr: 0.96550, Avg fpr: 0.15524, total FA: 1211

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.14032 | acc=0.9305 | tpr=0.9464 | fpr=0.1038 | 5786.1 samples/s | 22.6 steps/s
Avg test loss: 0.14153, Avg test acc: 0.92872, Avg tpr: 0.94387, Avg fpr: 0.10460, total FA: 816

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.13895 | acc=0.9334 | tpr=0.9604 | fpr=0.1254 | 5636.9 samples/s | 22.0 steps/s
Avg test loss: 0.14417, Avg test acc: 0.93353, Avg tpr: 0.96112, Avg fpr: 0.12716, total FA: 992

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.14992 | acc=0.9260 | tpr=0.9335 | fpr=0.0902 | 5593.1 samples/s | 21.8 steps/s
Avg test loss: 0.15234, Avg test acc: 0.92511, Avg tpr: 0.93198, Avg fpr: 0.08999, total FA: 702

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.01626 | acc=0.3227 | tpr=0.0358 | fpr=0.0543 | 5627.1 samples/s | 22.0 steps/s
Avg test loss: 4.02905, Avg test acc: 0.32050, Avg tpr: 0.03579, Avg fpr: 0.05333, total FA: 416

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.83572 | acc=0.3202 | tpr=0.0290 | fpr=0.0473 | 5543.5 samples/s | 21.7 steps/s
Avg test loss: 4.85878, Avg test acc: 0.31841, Avg tpr: 0.02961, Avg fpr: 0.04640, total FA: 362

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.09246 | acc=0.2902 | tpr=0.0453 | fpr=0.1779 | 5814.8 samples/s | 22.7 steps/s
Avg test loss: 5.12251, Avg test acc: 0.28868, Avg tpr: 0.04610, Avg fpr: 0.17780, total FA: 1387

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.19605 | acc=0.3130 | tpr=0.0274 | fpr=0.0667 | 5935.5 samples/s | 23.2 steps/s
Avg test loss: 5.21725, Avg test acc: 0.31188, Avg tpr: 0.02914, Avg fpr: 0.06627, total FA: 517

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.95201 | acc=0.3113 | tpr=0.0070 | fpr=0.0280 | 5580.3 samples/s | 21.8 steps/s
Avg test loss: 4.96687, Avg test acc: 0.30956, Avg tpr: 0.00746, Avg fpr: 0.02602, total FA: 203

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=0.34849 | acc=0.5070 | tpr=0.4646 | fpr=0.4923 | 5724.1 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.34895 | acc=0.5004 | tpr=0.4478 | fpr=0.4986 | 7543.8 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.34884 | acc=0.4999 | tpr=0.4481 | fpr=0.4991 | 7918.2 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.34876 | acc=0.5004 | tpr=0.4448 | fpr=0.4986 | 8224.6 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.34867 | acc=0.5013 | tpr=0.4498 | fpr=0.4977 | 8116.1 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.34870 | acc=0.5011 | tpr=0.4407 | fpr=0.4978 | 8646.1 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.34866 | acc=0.5011 | tpr=0.4477 | fpr=0.4979 | 8234.4 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.34860 | acc=0.5016 | tpr=0.4437 | fpr=0.4974 | 7421.6 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.34857 | acc=0.5017 | tpr=0.4426 | fpr=0.4973 | 8160.4 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.34852 | acc=0.5023 | tpr=0.4454 | fpr=0.4966 | 7962.9 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.34852 | acc=0.5026 | tpr=0.4441 | fpr=0.4963 | 10354.7 samples/s | 40.4 steps/s
Avg test loss: 0.34853, Avg test acc: 0.50255, Avg tpr: 0.44453, Avg fpr: 0.49640, total FA: 68924

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.38594 | acc=0.1050 | tpr=0.6372 | fpr=0.9046 | 5639.3 samples/s | 22.0 steps/s
[Step= 100] | Loss=4.36312 | acc=0.1053 | tpr=0.6247 | fpr=0.9044 | 7969.7 samples/s | 31.1 steps/s
[Step= 150] | Loss=4.36423 | acc=0.1046 | tpr=0.6354 | fpr=0.9052 | 7724.5 samples/s | 30.2 steps/s
[Step= 200] | Loss=4.36043 | acc=0.1042 | tpr=0.6470 | fpr=0.9056 | 8574.4 samples/s | 33.5 steps/s
[Step= 250] | Loss=4.36457 | acc=0.1045 | tpr=0.6489 | fpr=0.9054 | 7913.0 samples/s | 30.9 steps/s
[Step= 300] | Loss=4.36420 | acc=0.1043 | tpr=0.6400 | fpr=0.9054 | 8070.5 samples/s | 31.5 steps/s
[Step= 350] | Loss=4.36709 | acc=0.1042 | tpr=0.6274 | fpr=0.9053 | 7774.7 samples/s | 30.4 steps/s
[Step= 400] | Loss=4.37022 | acc=0.1039 | tpr=0.6307 | fpr=0.9057 | 8214.3 samples/s | 32.1 steps/s
[Step= 450] | Loss=4.37030 | acc=0.1039 | tpr=0.6266 | fpr=0.9055 | 7965.8 samples/s | 31.1 steps/s
[Step= 500] | Loss=4.37384 | acc=0.1039 | tpr=0.6256 | fpr=0.9055 | 8299.6 samples/s | 32.4 steps/s
[Step= 550] | Loss=4.37254 | acc=0.1041 | tpr=0.6347 | fpr=0.9056 | 10494.3 samples/s | 41.0 steps/s
Avg test loss: 4.37260, Avg test acc: 0.10400, Avg tpr: 0.63431, Avg fpr: 0.90564, total FA: 125746

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.23511 | acc=0.1317 | tpr=0.6726 | fpr=0.8780 | 5560.2 samples/s | 21.7 steps/s
[Step= 100] | Loss=4.22466 | acc=0.1305 | tpr=0.6311 | fpr=0.8788 | 8564.8 samples/s | 33.5 steps/s
[Step= 150] | Loss=4.24525 | acc=0.1302 | tpr=0.6340 | fpr=0.8791 | 7708.8 samples/s | 30.1 steps/s
[Step= 200] | Loss=4.24582 | acc=0.1298 | tpr=0.6273 | fpr=0.8792 | 8135.6 samples/s | 31.8 steps/s
[Step= 250] | Loss=4.25266 | acc=0.1300 | tpr=0.6245 | fpr=0.8790 | 7578.0 samples/s | 29.6 steps/s
[Step= 300] | Loss=4.25601 | acc=0.1299 | tpr=0.6269 | fpr=0.8791 | 8360.0 samples/s | 32.7 steps/s
[Step= 350] | Loss=4.25777 | acc=0.1295 | tpr=0.6149 | fpr=0.8793 | 8027.9 samples/s | 31.4 steps/s
[Step= 400] | Loss=4.25836 | acc=0.1299 | tpr=0.6138 | fpr=0.8789 | 7930.0 samples/s | 31.0 steps/s
[Step= 450] | Loss=4.25635 | acc=0.1301 | tpr=0.6154 | fpr=0.8787 | 8224.9 samples/s | 32.1 steps/s
[Step= 500] | Loss=4.25841 | acc=0.1305 | tpr=0.6167 | fpr=0.8783 | 8036.6 samples/s | 31.4 steps/s
[Step= 550] | Loss=4.25434 | acc=0.1308 | tpr=0.6204 | fpr=0.8781 | 10901.6 samples/s | 42.6 steps/s
Avg test loss: 4.25412, Avg test acc: 0.13074, Avg tpr: 0.62084, Avg fpr: 0.87817, total FA: 121932

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.99147 | acc=0.1152 | tpr=0.7080 | fpr=0.8954 | 5400.8 samples/s | 21.1 steps/s
[Step= 100] | Loss=4.95215 | acc=0.1143 | tpr=0.6610 | fpr=0.8959 | 8501.7 samples/s | 33.2 steps/s
[Step= 150] | Loss=4.95165 | acc=0.1124 | tpr=0.6455 | fpr=0.8974 | 7904.1 samples/s | 30.9 steps/s
[Step= 200] | Loss=4.95064 | acc=0.1121 | tpr=0.6448 | fpr=0.8976 | 8265.8 samples/s | 32.3 steps/s
[Step= 250] | Loss=4.95432 | acc=0.1127 | tpr=0.6629 | fpr=0.8974 | 8263.5 samples/s | 32.3 steps/s
[Step= 300] | Loss=4.95535 | acc=0.1123 | tpr=0.6589 | fpr=0.8976 | 8097.5 samples/s | 31.6 steps/s
[Step= 350] | Loss=4.95945 | acc=0.1118 | tpr=0.6475 | fpr=0.8979 | 7683.0 samples/s | 30.0 steps/s
[Step= 400] | Loss=4.95392 | acc=0.1126 | tpr=0.6488 | fpr=0.8972 | 7717.5 samples/s | 30.1 steps/s
[Step= 450] | Loss=4.95034 | acc=0.1125 | tpr=0.6519 | fpr=0.8973 | 8283.7 samples/s | 32.4 steps/s
[Step= 500] | Loss=4.94953 | acc=0.1124 | tpr=0.6449 | fpr=0.8972 | 8421.1 samples/s | 32.9 steps/s
[Step= 550] | Loss=4.94879 | acc=0.1125 | tpr=0.6442 | fpr=0.8971 | 10301.3 samples/s | 40.2 steps/s
Avg test loss: 4.94921, Avg test acc: 0.11248, Avg tpr: 0.64461, Avg fpr: 0.89719, total FA: 124573

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=3.81128 | acc=0.1607 | tpr=0.4336 | fpr=0.8442 | 5648.3 samples/s | 22.1 steps/s
[Step= 100] | Loss=3.79868 | acc=0.1611 | tpr=0.4606 | fpr=0.8445 | 8128.9 samples/s | 31.8 steps/s
[Step= 150] | Loss=3.81144 | acc=0.1590 | tpr=0.4424 | fpr=0.8462 | 7718.6 samples/s | 30.2 steps/s
[Step= 200] | Loss=3.81438 | acc=0.1581 | tpr=0.4361 | fpr=0.8470 | 8523.9 samples/s | 33.3 steps/s
[Step= 250] | Loss=3.81833 | acc=0.1584 | tpr=0.4454 | fpr=0.8468 | 8307.4 samples/s | 32.5 steps/s
[Step= 300] | Loss=3.81170 | acc=0.1590 | tpr=0.4560 | fpr=0.8465 | 7838.8 samples/s | 30.6 steps/s
[Step= 350] | Loss=3.81622 | acc=0.1584 | tpr=0.4483 | fpr=0.8469 | 8175.6 samples/s | 31.9 steps/s
[Step= 400] | Loss=3.81255 | acc=0.1591 | tpr=0.4497 | fpr=0.8462 | 7924.9 samples/s | 31.0 steps/s
[Step= 450] | Loss=3.81155 | acc=0.1596 | tpr=0.4518 | fpr=0.8457 | 7900.6 samples/s | 30.9 steps/s
[Step= 500] | Loss=3.81405 | acc=0.1592 | tpr=0.4546 | fpr=0.8461 | 8359.5 samples/s | 32.7 steps/s
[Step= 550] | Loss=3.81216 | acc=0.1594 | tpr=0.4548 | fpr=0.8460 | 10109.6 samples/s | 39.5 steps/s
Avg test loss: 3.81256, Avg test acc: 0.15924, Avg tpr: 0.45483, Avg fpr: 0.84613, total FA: 117484

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07411 | acc=0.9802 | tpr=0.8717 | fpr=0.0178 | 5802.0 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.07696 | acc=0.9796 | tpr=0.8870 | fpr=0.0187 | 7591.9 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.08029 | acc=0.9787 | tpr=0.8919 | fpr=0.0197 | 7214.2 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.08069 | acc=0.9786 | tpr=0.8962 | fpr=0.0199 | 8253.4 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.08069 | acc=0.9787 | tpr=0.8891 | fpr=0.0196 | 8264.0 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.08250 | acc=0.9785 | tpr=0.8880 | fpr=0.0198 | 8245.4 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.08349 | acc=0.9784 | tpr=0.8910 | fpr=0.0200 | 8245.9 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.08356 | acc=0.9782 | tpr=0.8873 | fpr=0.0201 | 8032.9 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.08537 | acc=0.9780 | tpr=0.8856 | fpr=0.0204 | 8415.0 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.08413 | acc=0.9782 | tpr=0.8899 | fpr=0.0202 | 7865.7 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.08377 | acc=0.9783 | tpr=0.8898 | fpr=0.0201 | 10789.8 samples/s | 42.1 steps/s
Avg test loss: 0.08364, Avg test acc: 0.97828, Avg tpr: 0.88986, Avg fpr: 0.02011, total FA: 2792

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08633 | acc=0.9814 | tpr=0.8540 | fpr=0.0163 | 5809.0 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.09049 | acc=0.9814 | tpr=0.8678 | fpr=0.0165 | 7576.6 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.09433 | acc=0.9808 | tpr=0.8761 | fpr=0.0173 | 7936.3 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.09493 | acc=0.9810 | tpr=0.8863 | fpr=0.0173 | 8167.6 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.09421 | acc=0.9812 | tpr=0.8856 | fpr=0.0171 | 8242.5 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.09586 | acc=0.9811 | tpr=0.8865 | fpr=0.0172 | 8381.9 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.09608 | acc=0.9808 | tpr=0.8848 | fpr=0.0174 | 7908.6 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.09687 | acc=0.9806 | tpr=0.8813 | fpr=0.0176 | 8335.2 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.09884 | acc=0.9804 | tpr=0.8802 | fpr=0.0178 | 8090.8 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.09839 | acc=0.9805 | tpr=0.8824 | fpr=0.0177 | 8031.9 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.09785 | acc=0.9806 | tpr=0.8826 | fpr=0.0176 | 9583.0 samples/s | 37.4 steps/s
Avg test loss: 0.09762, Avg test acc: 0.98068, Avg tpr: 0.88233, Avg fpr: 0.01754, total FA: 2435

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.08957 | acc=0.9741 | tpr=0.9204 | fpr=0.0250 | 5560.3 samples/s | 21.7 steps/s
[Step= 100] | Loss=0.09244 | acc=0.9732 | tpr=0.9360 | fpr=0.0261 | 8144.8 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.09531 | acc=0.9721 | tpr=0.9438 | fpr=0.0273 | 8235.3 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.09678 | acc=0.9719 | tpr=0.9454 | fpr=0.0276 | 7362.0 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.09812 | acc=0.9717 | tpr=0.9406 | fpr=0.0277 | 8273.0 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.09902 | acc=0.9714 | tpr=0.9389 | fpr=0.0280 | 8331.6 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.09891 | acc=0.9716 | tpr=0.9393 | fpr=0.0278 | 8324.6 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.09948 | acc=0.9715 | tpr=0.9387 | fpr=0.0279 | 7982.9 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.10032 | acc=0.9714 | tpr=0.9348 | fpr=0.0279 | 8061.5 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.10005 | acc=0.9714 | tpr=0.9357 | fpr=0.0279 | 8131.2 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.09922 | acc=0.9716 | tpr=0.9359 | fpr=0.0278 | 10795.9 samples/s | 42.2 steps/s
Avg test loss: 0.09900, Avg test acc: 0.97164, Avg tpr: 0.93621, Avg fpr: 0.02771, total FA: 3848

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.07574 | acc=0.9825 | tpr=0.8850 | fpr=0.0157 | 5587.4 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.08052 | acc=0.9826 | tpr=0.9126 | fpr=0.0161 | 7902.6 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.08389 | acc=0.9818 | tpr=0.9193 | fpr=0.0170 | 8602.0 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.08420 | acc=0.9819 | tpr=0.9224 | fpr=0.0170 | 8125.3 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.08367 | acc=0.9820 | tpr=0.9153 | fpr=0.0168 | 8223.8 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.08468 | acc=0.9819 | tpr=0.9098 | fpr=0.0168 | 7773.1 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.08501 | acc=0.9817 | tpr=0.9086 | fpr=0.0170 | 8054.8 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.08600 | acc=0.9815 | tpr=0.9075 | fpr=0.0172 | 7486.8 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.08703 | acc=0.9813 | tpr=0.9056 | fpr=0.0173 | 8595.4 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.08656 | acc=0.9814 | tpr=0.9070 | fpr=0.0173 | 8044.4 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.08586 | acc=0.9814 | tpr=0.9081 | fpr=0.0172 | 10182.3 samples/s | 39.8 steps/s
Avg test loss: 0.08574, Avg test acc: 0.98146, Avg tpr: 0.90769, Avg fpr: 0.01720, total FA: 2388

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.09051 | acc=0.9780 | tpr=0.8717 | fpr=0.0201 | 5819.9 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.09099 | acc=0.9778 | tpr=0.8977 | fpr=0.0207 | 7328.6 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.09341 | acc=0.9776 | tpr=0.9135 | fpr=0.0212 | 8538.2 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.09424 | acc=0.9779 | tpr=0.9158 | fpr=0.0210 | 8540.9 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.09353 | acc=0.9780 | tpr=0.9109 | fpr=0.0208 | 8051.2 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.09483 | acc=0.9778 | tpr=0.9105 | fpr=0.0210 | 7830.7 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.09506 | acc=0.9777 | tpr=0.9111 | fpr=0.0211 | 7982.5 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.09597 | acc=0.9774 | tpr=0.9059 | fpr=0.0213 | 7532.8 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.09687 | acc=0.9772 | tpr=0.9031 | fpr=0.0214 | 8533.4 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.09609 | acc=0.9773 | tpr=0.9022 | fpr=0.0214 | 8668.2 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.09536 | acc=0.9775 | tpr=0.9009 | fpr=0.0211 | 9698.1 samples/s | 37.9 steps/s
Avg test loss: 0.09517, Avg test acc: 0.97748, Avg tpr: 0.90055, Avg fpr: 0.02112, total FA: 2933

server round 5/50

clients selected: [0 1 2 3 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.29784 | Reg=0.00188 | acc=0.9375 | L2-Norm=13.713 | L2-Norm(final)=2.023 | 5804.4 samples/s | 90.7 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.27840 | Reg=0.00188 | acc=0.8438 | L2-Norm=13.713 | L2-Norm(final)=2.170 | 5598.2 samples/s | 87.5 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.25902 | Reg=0.00188 | acc=0.7500 | L2-Norm=13.713 | L2-Norm(final)=2.373 | 6297.3 samples/s | 98.4 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.24375 | Reg=0.00188 | acc=0.8594 | L2-Norm=13.713 | L2-Norm(final)=2.589 | 6286.1 samples/s | 98.2 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.23270 | Reg=0.00188 | acc=0.8438 | L2-Norm=13.713 | L2-Norm(final)=2.803 | 10558.5 samples/s | 165.0 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.22412 | Reg=0.00188 | acc=0.8906 | L2-Norm=13.713 | L2-Norm(final)=3.008 | 2517.8 samples/s | 39.3 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.21603 | Reg=0.00188 | acc=0.9062 | L2-Norm=13.713 | L2-Norm(final)=3.202 | 6474.9 samples/s | 101.2 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.21043 | Reg=0.00188 | acc=0.8906 | L2-Norm=13.713 | L2-Norm(final)=3.387 | 6257.4 samples/s | 97.8 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.20523 | Reg=0.00188 | acc=0.8750 | L2-Norm=13.713 | L2-Norm(final)=3.562 | 9159.2 samples/s | 143.1 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.20064 | Reg=0.00188 | acc=0.7812 | L2-Norm=13.713 | L2-Norm(final)=3.727 | 2635.1 samples/s | 41.2 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.19682 | Reg=0.00188 | acc=0.8438 | L2-Norm=13.713 | L2-Norm(final)=3.885 | 6330.0 samples/s | 98.9 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.17815 | Reg=0.00188 | acc=0.8594 | L2-Norm=13.713 | L2-Norm(final)=5.425 | 5601.9 samples/s | 87.5 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.11862 | Reg=0.00189 | acc=0.9375 | L2-Norm=13.752 | L2-Norm(final)=5.452 | 4521.9 samples/s | 70.7 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.10482 | Reg=0.00190 | acc=0.8750 | L2-Norm=13.797 | L2-Norm(final)=5.441 | 4879.2 samples/s | 76.2 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.09726 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.845 | L2-Norm(final)=5.438 | 4848.3 samples/s | 75.8 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.09165 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.893 | L2-Norm(final)=5.436 | 7009.4 samples/s | 109.5 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.08544 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.943 | L2-Norm(final)=5.432 | 2280.7 samples/s | 35.6 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.07807 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.992 | L2-Norm(final)=5.435 | 4907.6 samples/s | 76.7 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.07445 | Reg=0.00197 | acc=0.9531 | L2-Norm=14.037 | L2-Norm(final)=5.438 | 4807.7 samples/s | 75.1 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.07027 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.084 | L2-Norm(final)=5.442 | 6356.2 samples/s | 99.3 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.06575 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.128 | L2-Norm(final)=5.448 | 2342.2 samples/s | 36.6 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.06220 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.169 | L2-Norm(final)=5.456 | 4872.2 samples/s | 76.1 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.05987 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.209 | L2-Norm(final)=5.462 | 4842.2 samples/s | 75.7 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.05761 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.249 | L2-Norm(final)=5.468 | 5835.4 samples/s | 91.2 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.05729 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.291 | L2-Norm(final)=5.473 | 2451.4 samples/s | 38.3 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.05659 | Reg=0.00206 | acc=0.9375 | L2-Norm=14.339 | L2-Norm(final)=5.476 | 4810.7 samples/s | 75.2 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.05515 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.387 | L2-Norm(final)=5.478 | 4954.8 samples/s | 77.4 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.05398 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.432 | L2-Norm(final)=5.480 | 5313.8 samples/s | 83.0 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.05209 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.475 | L2-Norm(final)=5.481 | 2521.1 samples/s | 39.4 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.05020 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.515 | L2-Norm(final)=5.484 | 4820.8 samples/s | 75.3 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.04885 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.552 | L2-Norm(final)=5.487 | 4870.3 samples/s | 76.1 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.04739 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.587 | L2-Norm(final)=5.489 | 5012.6 samples/s | 78.3 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.04603 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.619 | L2-Norm(final)=5.492 | 2598.4 samples/s | 40.6 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.04474 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.650 | L2-Norm(final)=5.495 | 4890.0 samples/s | 76.4 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.04365 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.679 | L2-Norm(final)=5.497 | 4860.7 samples/s | 75.9 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.04296 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.707 | L2-Norm(final)=5.500 | 4856.6 samples/s | 75.9 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.04185 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.734 | L2-Norm(final)=5.501 | 2646.8 samples/s | 41.4 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.04065 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.760 | L2-Norm(final)=5.504 | 4853.8 samples/s | 75.8 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.03964 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.784 | L2-Norm(final)=5.507 | 4881.2 samples/s | 76.3 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.03896 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.808 | L2-Norm(final)=5.509 | 4884.2 samples/s | 76.3 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.03805 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.831 | L2-Norm(final)=5.511 | 2663.1 samples/s | 41.6 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.03728 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.853 | L2-Norm(final)=5.514 | 4941.0 samples/s | 77.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step2000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=39.0] | Loss=0.15059 | Reg=0.00188 | acc=0.8594 | L2-Norm=13.713 | L2-Norm(final)=7.669 | 5638.0 samples/s | 88.1 steps/s
[Step=8050 Epoch=39.3] | Loss=0.14800 | Reg=0.00188 | acc=0.8750 | L2-Norm=13.719 | L2-Norm(final)=7.693 | 4967.9 samples/s | 77.6 steps/s
[Step=8100 Epoch=39.5] | Loss=0.14636 | Reg=0.00188 | acc=0.8438 | L2-Norm=13.720 | L2-Norm(final)=7.735 | 5566.7 samples/s | 87.0 steps/s
[Step=8150 Epoch=39.8] | Loss=0.14638 | Reg=0.00188 | acc=0.8750 | L2-Norm=13.720 | L2-Norm(final)=7.784 | 5735.3 samples/s | 89.6 steps/s
[Step=8200 Epoch=40.0] | Loss=0.14688 | Reg=0.00188 | acc=0.8906 | L2-Norm=13.720 | L2-Norm(final)=7.830 | 8616.1 samples/s | 134.6 steps/s
[Step=8250 Epoch=40.3] | Loss=0.14642 | Reg=0.00188 | acc=0.8906 | L2-Norm=13.721 | L2-Norm(final)=7.877 | 2425.7 samples/s | 37.9 steps/s
[Step=8300 Epoch=40.5] | Loss=0.14548 | Reg=0.00188 | acc=0.8125 | L2-Norm=13.721 | L2-Norm(final)=7.926 | 5618.4 samples/s | 87.8 steps/s
[Step=8350 Epoch=40.7] | Loss=0.14538 | Reg=0.00188 | acc=0.8906 | L2-Norm=13.721 | L2-Norm(final)=7.977 | 5625.0 samples/s | 87.9 steps/s
[Step=8400 Epoch=41.0] | Loss=0.14505 | Reg=0.00188 | acc=0.7969 | L2-Norm=13.721 | L2-Norm(final)=8.028 | 8007.9 samples/s | 125.1 steps/s
[Step=8450 Epoch=41.2] | Loss=0.14498 | Reg=0.00188 | acc=0.9062 | L2-Norm=13.721 | L2-Norm(final)=8.080 | 2483.2 samples/s | 38.8 steps/s
[Step=8500 Epoch=41.5] | Loss=0.14458 | Reg=0.00188 | acc=0.9219 | L2-Norm=13.721 | L2-Norm(final)=8.130 | 5579.6 samples/s | 87.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=41.5] | Loss=0.15678 | Reg=0.00188 | acc=0.8906 | L2-Norm=13.721 | L2-Norm(final)=8.634 | 6270.2 samples/s | 98.0 steps/s
[Step=8550 Epoch=41.7] | Loss=0.11394 | Reg=0.00197 | acc=0.9062 | L2-Norm=14.043 | L2-Norm(final)=8.628 | 4164.4 samples/s | 65.1 steps/s
[Step=8600 Epoch=42.0] | Loss=0.10217 | Reg=0.00204 | acc=0.9531 | L2-Norm=14.271 | L2-Norm(final)=8.607 | 4975.2 samples/s | 77.7 steps/s
[Step=8650 Epoch=42.2] | Loss=0.09853 | Reg=0.00208 | acc=0.9531 | L2-Norm=14.403 | L2-Norm(final)=8.590 | 4785.5 samples/s | 74.8 steps/s
[Step=8700 Epoch=42.5] | Loss=0.09524 | Reg=0.00210 | acc=0.9375 | L2-Norm=14.502 | L2-Norm(final)=8.576 | 7004.7 samples/s | 109.4 steps/s
[Step=8750 Epoch=42.7] | Loss=0.08619 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.590 | L2-Norm(final)=8.568 | 2254.4 samples/s | 35.2 steps/s
[Step=8800 Epoch=42.9] | Loss=0.08016 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.662 | L2-Norm(final)=8.563 | 4914.9 samples/s | 76.8 steps/s
[Step=8850 Epoch=43.2] | Loss=0.07624 | Reg=0.00217 | acc=0.9531 | L2-Norm=14.724 | L2-Norm(final)=8.560 | 4815.2 samples/s | 75.2 steps/s
[Step=8900 Epoch=43.4] | Loss=0.07133 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.779 | L2-Norm(final)=8.558 | 6510.7 samples/s | 101.7 steps/s
[Step=8950 Epoch=43.7] | Loss=0.06720 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.830 | L2-Norm(final)=8.558 | 2299.5 samples/s | 35.9 steps/s
[Step=9000 Epoch=43.9] | Loss=0.06368 | Reg=0.00221 | acc=0.9219 | L2-Norm=14.875 | L2-Norm(final)=8.559 | 4893.3 samples/s | 76.5 steps/s
[Step=9050 Epoch=44.2] | Loss=0.06095 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.918 | L2-Norm(final)=8.560 | 4830.1 samples/s | 75.5 steps/s
[Step=9100 Epoch=44.4] | Loss=0.05868 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.956 | L2-Norm(final)=8.560 | 6002.5 samples/s | 93.8 steps/s
[Step=9150 Epoch=44.6] | Loss=0.05628 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.992 | L2-Norm(final)=8.560 | 2368.0 samples/s | 37.0 steps/s
[Step=9200 Epoch=44.9] | Loss=0.05376 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.025 | L2-Norm(final)=8.561 | 4945.1 samples/s | 77.3 steps/s
[Step=9250 Epoch=45.1] | Loss=0.05184 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.056 | L2-Norm(final)=8.562 | 4835.1 samples/s | 75.5 steps/s
[Step=9300 Epoch=45.4] | Loss=0.05040 | Reg=0.00228 | acc=0.9375 | L2-Norm=15.084 | L2-Norm(final)=8.562 | 5518.6 samples/s | 86.2 steps/s
[Step=9350 Epoch=45.6] | Loss=0.04866 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.112 | L2-Norm(final)=8.563 | 2469.0 samples/s | 38.6 steps/s
[Step=9400 Epoch=45.9] | Loss=0.04729 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.140 | L2-Norm(final)=8.563 | 4798.6 samples/s | 75.0 steps/s
[Step=9450 Epoch=46.1] | Loss=0.04574 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.166 | L2-Norm(final)=8.565 | 4801.8 samples/s | 75.0 steps/s
[Step=9500 Epoch=46.4] | Loss=0.04455 | Reg=0.00231 | acc=0.9688 | L2-Norm=15.191 | L2-Norm(final)=8.565 | 5255.7 samples/s | 82.1 steps/s
[Step=9550 Epoch=46.6] | Loss=0.04340 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.216 | L2-Norm(final)=8.566 | 2537.1 samples/s | 39.6 steps/s
[Step=9600 Epoch=46.8] | Loss=0.04237 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.240 | L2-Norm(final)=8.567 | 4865.3 samples/s | 76.0 steps/s
[Step=9650 Epoch=47.1] | Loss=0.04141 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.264 | L2-Norm(final)=8.567 | 4872.4 samples/s | 76.1 steps/s
[Step=9700 Epoch=47.3] | Loss=0.04045 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.288 | L2-Norm(final)=8.567 | 4976.8 samples/s | 77.8 steps/s
[Step=9750 Epoch=47.6] | Loss=0.03949 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.311 | L2-Norm(final)=8.567 | 2647.2 samples/s | 41.4 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03856 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.334 | L2-Norm(final)=8.568 | 4710.1 samples/s | 73.6 steps/s
[Step=9850 Epoch=48.1] | Loss=0.03799 | Reg=0.00236 | acc=0.9531 | L2-Norm=15.356 | L2-Norm(final)=8.568 | 4878.4 samples/s | 76.2 steps/s
[Step=9900 Epoch=48.3] | Loss=0.03728 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.378 | L2-Norm(final)=8.568 | 4885.1 samples/s | 76.3 steps/s
[Step=9950 Epoch=48.6] | Loss=0.03648 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.399 | L2-Norm(final)=8.567 | 2647.5 samples/s | 41.4 steps/s
[Step=10000 Epoch=48.8] | Loss=0.03577 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.420 | L2-Norm(final)=8.567 | 4856.2 samples/s | 75.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step10000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.18489 | Reg=0.00188 | acc=0.8750 | L2-Norm=13.713 | L2-Norm(final)=4.567 | 5338.2 samples/s | 83.4 steps/s
[Step=4050 Epoch=19.7] | Loss=0.16766 | Reg=0.00188 | acc=0.9219 | L2-Norm=13.711 | L2-Norm(final)=4.692 | 5184.2 samples/s | 81.0 steps/s
[Step=4100 Epoch=20.0] | Loss=0.16628 | Reg=0.00188 | acc=0.8125 | L2-Norm=13.711 | L2-Norm(final)=4.835 | 5729.0 samples/s | 89.5 steps/s
[Step=4150 Epoch=20.2] | Loss=0.16676 | Reg=0.00188 | acc=0.8594 | L2-Norm=13.711 | L2-Norm(final)=4.965 | 5656.4 samples/s | 88.4 steps/s
[Step=4200 Epoch=20.5] | Loss=0.16500 | Reg=0.00188 | acc=0.9219 | L2-Norm=13.711 | L2-Norm(final)=5.086 | 8466.2 samples/s | 132.3 steps/s
[Step=4250 Epoch=20.7] | Loss=0.16334 | Reg=0.00188 | acc=0.8750 | L2-Norm=13.711 | L2-Norm(final)=5.201 | 2441.1 samples/s | 38.1 steps/s
[Step=4300 Epoch=21.0] | Loss=0.16190 | Reg=0.00188 | acc=0.9375 | L2-Norm=13.711 | L2-Norm(final)=5.311 | 5651.4 samples/s | 88.3 steps/s
[Step=4350 Epoch=21.2] | Loss=0.16090 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.711 | L2-Norm(final)=5.417 | 5918.2 samples/s | 92.5 steps/s
[Step=4400 Epoch=21.4] | Loss=0.16018 | Reg=0.00188 | acc=0.8594 | L2-Norm=13.711 | L2-Norm(final)=5.518 | 7226.6 samples/s | 112.9 steps/s
[Step=4450 Epoch=21.7] | Loss=0.15920 | Reg=0.00188 | acc=0.9062 | L2-Norm=13.711 | L2-Norm(final)=5.615 | 2567.8 samples/s | 40.1 steps/s
[Step=4500 Epoch=21.9] | Loss=0.15814 | Reg=0.00188 | acc=0.8906 | L2-Norm=13.711 | L2-Norm(final)=5.708 | 5428.7 samples/s | 84.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=21.9] | Loss=0.17303 | Reg=0.00188 | acc=0.8438 | L2-Norm=13.711 | L2-Norm(final)=6.629 | 5996.5 samples/s | 93.7 steps/s
[Step=4550 Epoch=22.2] | Loss=0.12250 | Reg=0.00197 | acc=0.9531 | L2-Norm=14.039 | L2-Norm(final)=6.616 | 4350.6 samples/s | 68.0 steps/s
[Step=4600 Epoch=22.4] | Loss=0.10404 | Reg=0.00202 | acc=0.9375 | L2-Norm=14.224 | L2-Norm(final)=6.595 | 4897.1 samples/s | 76.5 steps/s
[Step=4650 Epoch=22.7] | Loss=0.09741 | Reg=0.00205 | acc=0.9375 | L2-Norm=14.326 | L2-Norm(final)=6.584 | 4824.3 samples/s | 75.4 steps/s
[Step=4700 Epoch=22.9] | Loss=0.09171 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.401 | L2-Norm(final)=6.576 | 6999.6 samples/s | 109.4 steps/s
[Step=4750 Epoch=23.1] | Loss=0.08298 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.466 | L2-Norm(final)=6.571 | 2270.9 samples/s | 35.5 steps/s
[Step=4800 Epoch=23.4] | Loss=0.07649 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.522 | L2-Norm(final)=6.568 | 4799.9 samples/s | 75.0 steps/s
[Step=4850 Epoch=23.6] | Loss=0.07228 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.573 | L2-Norm(final)=6.567 | 4873.3 samples/s | 76.1 steps/s
[Step=4900 Epoch=23.9] | Loss=0.06965 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.622 | L2-Norm(final)=6.565 | 6380.5 samples/s | 99.7 steps/s
[Step=4950 Epoch=24.1] | Loss=0.06598 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.668 | L2-Norm(final)=6.564 | 2332.7 samples/s | 36.4 steps/s
[Step=5000 Epoch=24.4] | Loss=0.06232 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.708 | L2-Norm(final)=6.564 | 4934.8 samples/s | 77.1 steps/s
[Step=5050 Epoch=24.6] | Loss=0.05991 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.746 | L2-Norm(final)=6.565 | 4929.1 samples/s | 77.0 steps/s
[Step=5100 Epoch=24.8] | Loss=0.05780 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.782 | L2-Norm(final)=6.566 | 5679.8 samples/s | 88.7 steps/s
[Step=5150 Epoch=25.1] | Loss=0.05526 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.816 | L2-Norm(final)=6.567 | 2437.5 samples/s | 38.1 steps/s
[Step=5200 Epoch=25.3] | Loss=0.05301 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.847 | L2-Norm(final)=6.568 | 4878.2 samples/s | 76.2 steps/s
[Step=5250 Epoch=25.6] | Loss=0.05122 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.876 | L2-Norm(final)=6.569 | 4889.4 samples/s | 76.4 steps/s
[Step=5300 Epoch=25.8] | Loss=0.04995 | Reg=0.00222 | acc=0.9219 | L2-Norm=14.902 | L2-Norm(final)=6.570 | 5358.5 samples/s | 83.7 steps/s
[Step=5350 Epoch=26.1] | Loss=0.04826 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.927 | L2-Norm(final)=6.570 | 2500.0 samples/s | 39.1 steps/s
[Step=5400 Epoch=26.3] | Loss=0.04675 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.951 | L2-Norm(final)=6.571 | 4889.0 samples/s | 76.4 steps/s
[Step=5450 Epoch=26.6] | Loss=0.04544 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.973 | L2-Norm(final)=6.573 | 4856.5 samples/s | 75.9 steps/s
[Step=5500 Epoch=26.8] | Loss=0.04398 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.994 | L2-Norm(final)=6.574 | 4954.7 samples/s | 77.4 steps/s
[Step=5550 Epoch=27.0] | Loss=0.04257 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.013 | L2-Norm(final)=6.576 | 2616.6 samples/s | 40.9 steps/s
[Step=5600 Epoch=27.3] | Loss=0.04147 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.032 | L2-Norm(final)=6.577 | 4848.8 samples/s | 75.8 steps/s
[Step=5650 Epoch=27.5] | Loss=0.04067 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.050 | L2-Norm(final)=6.579 | 4902.1 samples/s | 76.6 steps/s
[Step=5700 Epoch=27.8] | Loss=0.03979 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.068 | L2-Norm(final)=6.580 | 4837.6 samples/s | 75.6 steps/s
[Step=5750 Epoch=28.0] | Loss=0.03874 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.085 | L2-Norm(final)=6.581 | 2638.1 samples/s | 41.2 steps/s
[Step=5800 Epoch=28.3] | Loss=0.03783 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.102 | L2-Norm(final)=6.583 | 4879.4 samples/s | 76.2 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03703 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.119 | L2-Norm(final)=6.585 | 4931.3 samples/s | 77.1 steps/s
[Step=5900 Epoch=28.7] | Loss=0.03651 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.135 | L2-Norm(final)=6.586 | 4852.0 samples/s | 75.8 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03571 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.151 | L2-Norm(final)=6.587 | 2646.9 samples/s | 41.4 steps/s
[Step=6000 Epoch=29.2] | Loss=0.03511 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.168 | L2-Norm(final)=6.588 | 4863.3 samples/s | 76.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step6000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.13902 | Reg=0.00188 | acc=0.9062 | L2-Norm=13.713 | L2-Norm(final)=4.739 | 5626.4 samples/s | 87.9 steps/s
[Step=2050 Epoch=10.0] | Loss=0.17314 | Reg=0.00188 | acc=0.7812 | L2-Norm=13.727 | L2-Norm(final)=4.837 | 4989.6 samples/s | 78.0 steps/s
[Step=2100 Epoch=10.2] | Loss=0.16708 | Reg=0.00189 | acc=0.9062 | L2-Norm=13.730 | L2-Norm(final)=4.969 | 5854.0 samples/s | 91.5 steps/s
[Step=2150 Epoch=10.5] | Loss=0.16342 | Reg=0.00189 | acc=0.9219 | L2-Norm=13.731 | L2-Norm(final)=5.097 | 5562.6 samples/s | 86.9 steps/s
[Step=2200 Epoch=10.7] | Loss=0.16205 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.731 | L2-Norm(final)=5.219 | 8504.7 samples/s | 132.9 steps/s
[Step=2250 Epoch=11.0] | Loss=0.16024 | Reg=0.00189 | acc=0.9219 | L2-Norm=13.732 | L2-Norm(final)=5.330 | 2456.5 samples/s | 38.4 steps/s
[Step=2300 Epoch=11.2] | Loss=0.15864 | Reg=0.00189 | acc=0.9375 | L2-Norm=13.732 | L2-Norm(final)=5.435 | 5510.5 samples/s | 86.1 steps/s
[Step=2350 Epoch=11.5] | Loss=0.15777 | Reg=0.00189 | acc=0.8750 | L2-Norm=13.732 | L2-Norm(final)=5.537 | 5686.8 samples/s | 88.9 steps/s
[Step=2400 Epoch=11.7] | Loss=0.15621 | Reg=0.00189 | acc=0.9219 | L2-Norm=13.732 | L2-Norm(final)=5.634 | 7668.2 samples/s | 119.8 steps/s
[Step=2450 Epoch=11.9] | Loss=0.15493 | Reg=0.00189 | acc=0.8594 | L2-Norm=13.732 | L2-Norm(final)=5.728 | 2518.2 samples/s | 39.3 steps/s
[Step=2500 Epoch=12.2] | Loss=0.15490 | Reg=0.00189 | acc=0.8594 | L2-Norm=13.732 | L2-Norm(final)=5.817 | 5631.7 samples/s | 88.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.17765 | Reg=0.00189 | acc=0.8438 | L2-Norm=13.733 | L2-Norm(final)=6.689 | 5794.7 samples/s | 90.5 steps/s
[Step=2550 Epoch=12.4] | Loss=0.11057 | Reg=0.00194 | acc=0.9062 | L2-Norm=13.935 | L2-Norm(final)=6.711 | 4466.9 samples/s | 69.8 steps/s
[Step=2600 Epoch=12.7] | Loss=0.09932 | Reg=0.00198 | acc=0.8750 | L2-Norm=14.070 | L2-Norm(final)=6.703 | 4872.0 samples/s | 76.1 steps/s
[Step=2650 Epoch=12.9] | Loss=0.09527 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.156 | L2-Norm(final)=6.692 | 4847.3 samples/s | 75.7 steps/s
[Step=2700 Epoch=13.2] | Loss=0.08718 | Reg=0.00202 | acc=0.9531 | L2-Norm=14.223 | L2-Norm(final)=6.687 | 7027.1 samples/s | 109.8 steps/s
[Step=2750 Epoch=13.4] | Loss=0.07885 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.279 | L2-Norm(final)=6.685 | 2267.5 samples/s | 35.4 steps/s
[Step=2800 Epoch=13.7] | Loss=0.07353 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.328 | L2-Norm(final)=6.684 | 4870.6 samples/s | 76.1 steps/s
[Step=2850 Epoch=13.9] | Loss=0.07089 | Reg=0.00207 | acc=0.9375 | L2-Norm=14.377 | L2-Norm(final)=6.682 | 4885.7 samples/s | 76.3 steps/s
[Step=2900 Epoch=14.1] | Loss=0.06770 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.422 | L2-Norm(final)=6.680 | 6394.5 samples/s | 99.9 steps/s
[Step=2950 Epoch=14.4] | Loss=0.06366 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.463 | L2-Norm(final)=6.679 | 2355.4 samples/s | 36.8 steps/s
[Step=3000 Epoch=14.6] | Loss=0.06002 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.502 | L2-Norm(final)=6.679 | 4855.7 samples/s | 75.9 steps/s
[Step=3050 Epoch=14.9] | Loss=0.05694 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.538 | L2-Norm(final)=6.679 | 4860.6 samples/s | 75.9 steps/s
[Step=3100 Epoch=15.1] | Loss=0.05518 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.572 | L2-Norm(final)=6.679 | 5850.9 samples/s | 91.4 steps/s
[Step=3150 Epoch=15.4] | Loss=0.05288 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.604 | L2-Norm(final)=6.679 | 2442.3 samples/s | 38.2 steps/s
[Step=3200 Epoch=15.6] | Loss=0.05055 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.633 | L2-Norm(final)=6.679 | 4915.8 samples/s | 76.8 steps/s
[Step=3250 Epoch=15.8] | Loss=0.04837 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.659 | L2-Norm(final)=6.679 | 4800.1 samples/s | 75.0 steps/s
[Step=3300 Epoch=16.1] | Loss=0.04684 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.684 | L2-Norm(final)=6.681 | 5376.8 samples/s | 84.0 steps/s
[Step=3350 Epoch=16.3] | Loss=0.04531 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.707 | L2-Norm(final)=6.681 | 2526.1 samples/s | 39.5 steps/s
[Step=3400 Epoch=16.6] | Loss=0.04369 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.730 | L2-Norm(final)=6.682 | 4840.6 samples/s | 75.6 steps/s
[Step=3450 Epoch=16.8] | Loss=0.04255 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.751 | L2-Norm(final)=6.683 | 4889.8 samples/s | 76.4 steps/s
[Step=3500 Epoch=17.1] | Loss=0.04160 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.772 | L2-Norm(final)=6.683 | 4995.7 samples/s | 78.1 steps/s
[Step=3550 Epoch=17.3] | Loss=0.04050 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.792 | L2-Norm(final)=6.683 | 2605.4 samples/s | 40.7 steps/s
[Step=3600 Epoch=17.6] | Loss=0.03945 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.813 | L2-Norm(final)=6.683 | 4915.5 samples/s | 76.8 steps/s
[Step=3650 Epoch=17.8] | Loss=0.03856 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.832 | L2-Norm(final)=6.683 | 4797.6 samples/s | 75.0 steps/s
[Step=3700 Epoch=18.0] | Loss=0.03767 | Reg=0.00221 | acc=0.9531 | L2-Norm=14.851 | L2-Norm(final)=6.683 | 4889.4 samples/s | 76.4 steps/s
[Step=3750 Epoch=18.3] | Loss=0.03676 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.869 | L2-Norm(final)=6.683 | 2615.6 samples/s | 40.9 steps/s
[Step=3800 Epoch=18.5] | Loss=0.03594 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.887 | L2-Norm(final)=6.683 | 4919.4 samples/s | 76.9 steps/s
[Step=3850 Epoch=18.8] | Loss=0.03525 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.904 | L2-Norm(final)=6.683 | 4812.7 samples/s | 75.2 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03440 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.921 | L2-Norm(final)=6.683 | 4844.5 samples/s | 75.7 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03413 | Reg=0.00223 | acc=0.9062 | L2-Norm=14.937 | L2-Norm(final)=6.683 | 2645.4 samples/s | 41.3 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03500 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.959 | L2-Norm(final)=6.681 | 4999.6 samples/s | 78.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step4000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=37.7] | Loss=0.05381 | Reg=0.00188 | acc=0.9375 | L2-Norm=13.713 | L2-Norm(final)=8.185 | 5514.8 samples/s | 86.2 steps/s
[Step=4050 Epoch=38.2] | Loss=0.03777 | Reg=0.00188 | acc=0.9375 | L2-Norm=13.702 | L2-Norm(final)=8.262 | 4553.5 samples/s | 71.1 steps/s
[Step=4100 Epoch=38.6] | Loss=0.03838 | Reg=0.00188 | acc=0.9375 | L2-Norm=13.701 | L2-Norm(final)=8.388 | 8232.2 samples/s | 128.6 steps/s
[Step=4150 Epoch=39.1] | Loss=0.03728 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.700 | L2-Norm(final)=8.516 | 2371.7 samples/s | 37.1 steps/s
[Step=4200 Epoch=39.6] | Loss=0.03680 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.700 | L2-Norm(final)=8.639 | 7090.5 samples/s | 110.8 steps/s
[Step=4250 Epoch=40.0] | Loss=0.03636 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.700 | L2-Norm(final)=8.759 | 2456.5 samples/s | 38.4 steps/s
[Step=4300 Epoch=40.5] | Loss=0.03602 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.700 | L2-Norm(final)=8.873 | 6332.6 samples/s | 98.9 steps/s
[Step=4350 Epoch=41.0] | Loss=0.03522 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.700 | L2-Norm(final)=8.984 | 2570.4 samples/s | 40.2 steps/s
[Step=4400 Epoch=41.5] | Loss=0.03511 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.700 | L2-Norm(final)=9.090 | 5707.2 samples/s | 89.2 steps/s
[Step=4450 Epoch=41.9] | Loss=0.03470 | Reg=0.00188 | acc=0.9375 | L2-Norm=13.700 | L2-Norm(final)=9.191 | 2721.6 samples/s | 42.5 steps/s
[Step=4500 Epoch=42.4] | Loss=0.03433 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.700 | L2-Norm(final)=9.289 | 5287.4 samples/s | 82.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.4] | Loss=0.03119 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.699 | L2-Norm(final)=10.243 | 6034.5 samples/s | 94.3 steps/s
[Step=4550 Epoch=42.9] | Loss=0.03284 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.277 | L2-Norm(final)=10.213 | 4008.5 samples/s | 62.6 steps/s
[Step=4600 Epoch=43.3] | Loss=0.02168 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.533 | L2-Norm(final)=10.198 | 6625.8 samples/s | 103.5 steps/s
[Step=4650 Epoch=43.8] | Loss=0.01696 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.647 | L2-Norm(final)=10.185 | 2218.9 samples/s | 34.7 steps/s
[Step=4700 Epoch=44.3] | Loss=0.01290 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.696 | L2-Norm(final)=10.181 | 5834.7 samples/s | 91.2 steps/s
[Step=4750 Epoch=44.8] | Loss=0.01034 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.703 | L2-Norm(final)=10.180 | 2285.7 samples/s | 35.7 steps/s
[Step=4800 Epoch=45.2] | Loss=0.00863 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.689 | L2-Norm(final)=10.180 | 5358.4 samples/s | 83.7 steps/s
[Step=4850 Epoch=45.7] | Loss=0.00740 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.662 | L2-Norm(final)=10.180 | 2396.4 samples/s | 37.4 steps/s
[Step=4900 Epoch=46.2] | Loss=0.00648 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.630 | L2-Norm(final)=10.180 | 4876.3 samples/s | 76.2 steps/s
[Step=4950 Epoch=46.6] | Loss=0.00576 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.593 | L2-Norm(final)=10.181 | 2493.8 samples/s | 39.0 steps/s
[Step=5000 Epoch=47.1] | Loss=0.00518 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.554 | L2-Norm(final)=10.181 | 4621.6 samples/s | 72.2 steps/s
[Step=5050 Epoch=47.6] | Loss=0.00471 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.514 | L2-Norm(final)=10.182 | 2627.0 samples/s | 41.0 steps/s
[Step=5100 Epoch=48.1] | Loss=0.00432 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.472 | L2-Norm(final)=10.182 | 4512.4 samples/s | 70.5 steps/s
[Step=5150 Epoch=48.5] | Loss=0.00399 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.431 | L2-Norm(final)=10.183 | 2543.7 samples/s | 39.7 steps/s
[Step=5200 Epoch=49.0] | Loss=0.00371 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.389 | L2-Norm(final)=10.183 | 4658.0 samples/s | 72.8 steps/s
[Step=5250 Epoch=49.5] | Loss=0.00346 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.347 | L2-Norm(final)=10.184 | 2861.7 samples/s | 44.7 steps/s
[Step=5300 Epoch=49.9] | Loss=0.00324 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.305 | L2-Norm(final)=10.184 | 3942.2 samples/s | 61.6 steps/s
[Step=5350 Epoch=50.4] | Loss=0.00305 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.263 | L2-Norm(final)=10.185 | 6767.4 samples/s | 105.7 steps/s
[Step=5400 Epoch=50.9] | Loss=0.00288 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.221 | L2-Norm(final)=10.185 | 2177.2 samples/s | 34.0 steps/s
[Step=5450 Epoch=51.4] | Loss=0.00273 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.180 | L2-Norm(final)=10.186 | 5985.3 samples/s | 93.5 steps/s
[Step=5500 Epoch=51.8] | Loss=0.00260 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.139 | L2-Norm(final)=10.186 | 2270.2 samples/s | 35.5 steps/s
[Step=5550 Epoch=52.3] | Loss=0.00247 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.098 | L2-Norm(final)=10.187 | 5433.9 samples/s | 84.9 steps/s
[Step=5600 Epoch=52.8] | Loss=0.00236 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.058 | L2-Norm(final)=10.187 | 2378.4 samples/s | 37.2 steps/s
[Step=5650 Epoch=53.2] | Loss=0.00226 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.017 | L2-Norm(final)=10.188 | 4952.8 samples/s | 77.4 steps/s
[Step=5700 Epoch=53.7] | Loss=0.00217 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=10.188 | 1885.6 samples/s | 29.5 steps/s
[Step=5750 Epoch=54.2] | Loss=0.00208 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.938 | L2-Norm(final)=10.189 | 4655.3 samples/s | 72.7 steps/s
[Step=5800 Epoch=54.7] | Loss=0.00200 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.899 | L2-Norm(final)=10.189 | 2538.8 samples/s | 39.7 steps/s
[Step=5850 Epoch=55.1] | Loss=0.00193 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.859 | L2-Norm(final)=10.190 | 4563.6 samples/s | 71.3 steps/s
[Step=5900 Epoch=55.6] | Loss=0.00186 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.821 | L2-Norm(final)=10.190 | 2593.6 samples/s | 40.5 steps/s
[Step=5950 Epoch=56.1] | Loss=0.00179 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.782 | L2-Norm(final)=10.190 | 4557.3 samples/s | 71.2 steps/s
[Step=6000 Epoch=56.5] | Loss=0.00173 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.744 | L2-Norm(final)=10.191 | 2583.7 samples/s | 40.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.12565 | acc=0.9391 | tpr=0.9509 | fpr=0.0867 | 5650.6 samples/s | 22.1 steps/s
Avg test loss: 0.13131, Avg test acc: 0.93774, Avg tpr: 0.94918, Avg fpr: 0.08742, total FA: 682

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.15064 | acc=0.9287 | tpr=0.9556 | fpr=0.1298 | 5644.6 samples/s | 22.0 steps/s
Avg test loss: 0.14865, Avg test acc: 0.92904, Avg tpr: 0.95430, Avg fpr: 0.12652, total FA: 987

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.12619 | acc=0.9351 | tpr=0.9465 | fpr=0.0897 | 5738.0 samples/s | 22.4 steps/s
Avg test loss: 0.13073, Avg test acc: 0.93237, Avg tpr: 0.94440, Avg fpr: 0.09409, total FA: 734

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10906 | acc=0.9289 | tpr=0.9493 | fpr=0.1155 | 5954.9 samples/s | 23.3 steps/s
Avg test loss: 0.11204, Avg test acc: 0.92736, Avg tpr: 0.94923, Avg fpr: 0.12075, total FA: 942

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.14992 | acc=0.9260 | tpr=0.9335 | fpr=0.0902 | 5566.7 samples/s | 21.7 steps/s
Avg test loss: 0.15234, Avg test acc: 0.92511, Avg tpr: 0.93198, Avg fpr: 0.08999, total FA: 702

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.01626 | acc=0.3227 | tpr=0.0358 | fpr=0.0543 | 5796.4 samples/s | 22.6 steps/s
Avg test loss: 4.02905, Avg test acc: 0.32050, Avg tpr: 0.03579, Avg fpr: 0.05333, total FA: 416

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.83572 | acc=0.3202 | tpr=0.0290 | fpr=0.0473 | 5617.6 samples/s | 21.9 steps/s
Avg test loss: 4.85878, Avg test acc: 0.31841, Avg tpr: 0.02961, Avg fpr: 0.04640, total FA: 362

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.09246 | acc=0.2902 | tpr=0.0453 | fpr=0.1779 | 5814.3 samples/s | 22.7 steps/s
Avg test loss: 5.12251, Avg test acc: 0.28868, Avg tpr: 0.04610, Avg fpr: 0.17780, total FA: 1387

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.10630 | acc=0.3141 | tpr=0.0235 | fpr=0.0548 | 5700.0 samples/s | 22.3 steps/s
Avg test loss: 5.12719, Avg test acc: 0.31313, Avg tpr: 0.02500, Avg fpr: 0.05320, total FA: 415

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.95201 | acc=0.3113 | tpr=0.0070 | fpr=0.0280 | 5704.7 samples/s | 22.3 steps/s
Avg test loss: 4.96687, Avg test acc: 0.30956, Avg tpr: 0.00746, Avg fpr: 0.02602, total FA: 203

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.78452 | acc=0.1427 | tpr=0.6681 | fpr=0.8668 | 5729.0 samples/s | 22.4 steps/s
[Step= 100] | Loss=4.75764 | acc=0.1420 | tpr=0.5991 | fpr=0.8665 | 8136.3 samples/s | 31.8 steps/s
[Step= 150] | Loss=4.76642 | acc=0.1416 | tpr=0.5893 | fpr=0.8666 | 7462.2 samples/s | 29.1 steps/s
[Step= 200] | Loss=4.74930 | acc=0.1424 | tpr=0.5869 | fpr=0.8657 | 8213.3 samples/s | 32.1 steps/s
[Step= 250] | Loss=4.75174 | acc=0.1427 | tpr=0.5974 | fpr=0.8656 | 8289.2 samples/s | 32.4 steps/s
[Step= 300] | Loss=4.74662 | acc=0.1429 | tpr=0.5978 | fpr=0.8654 | 8912.0 samples/s | 34.8 steps/s
[Step= 350] | Loss=4.74251 | acc=0.1425 | tpr=0.5848 | fpr=0.8656 | 7885.2 samples/s | 30.8 steps/s
[Step= 400] | Loss=4.73864 | acc=0.1427 | tpr=0.5821 | fpr=0.8652 | 7666.6 samples/s | 29.9 steps/s
[Step= 450] | Loss=4.73978 | acc=0.1426 | tpr=0.5823 | fpr=0.8654 | 7996.8 samples/s | 31.2 steps/s
[Step= 500] | Loss=4.74096 | acc=0.1428 | tpr=0.5824 | fpr=0.8652 | 8116.9 samples/s | 31.7 steps/s
[Step= 550] | Loss=4.73847 | acc=0.1434 | tpr=0.5818 | fpr=0.8646 | 10254.3 samples/s | 40.1 steps/s
Avg test loss: 4.73910, Avg test acc: 0.14325, Avg tpr: 0.58241, Avg fpr: 0.86474, total FA: 120067

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.19405 | acc=0.1039 | tpr=0.5398 | fpr=0.9039 | 5690.4 samples/s | 22.2 steps/s
[Step= 100] | Loss=4.17430 | acc=0.1046 | tpr=0.5288 | fpr=0.9033 | 7917.0 samples/s | 30.9 steps/s
[Step= 150] | Loss=4.17549 | acc=0.1042 | tpr=0.5403 | fpr=0.9038 | 7654.3 samples/s | 29.9 steps/s
[Step= 200] | Loss=4.17321 | acc=0.1041 | tpr=0.5344 | fpr=0.9037 | 8055.8 samples/s | 31.5 steps/s
[Step= 250] | Loss=4.17218 | acc=0.1049 | tpr=0.5328 | fpr=0.9029 | 8277.6 samples/s | 32.3 steps/s
[Step= 300] | Loss=4.16845 | acc=0.1048 | tpr=0.5404 | fpr=0.9031 | 8619.1 samples/s | 33.7 steps/s
[Step= 350] | Loss=4.17069 | acc=0.1049 | tpr=0.5322 | fpr=0.9029 | 7406.1 samples/s | 28.9 steps/s
[Step= 400] | Loss=4.17489 | acc=0.1050 | tpr=0.5323 | fpr=0.9028 | 8586.1 samples/s | 33.5 steps/s
[Step= 450] | Loss=4.17249 | acc=0.1051 | tpr=0.5370 | fpr=0.9028 | 8600.0 samples/s | 33.6 steps/s
[Step= 500] | Loss=4.17317 | acc=0.1048 | tpr=0.5392 | fpr=0.9030 | 8030.7 samples/s | 31.4 steps/s
[Step= 550] | Loss=4.17294 | acc=0.1049 | tpr=0.5412 | fpr=0.9030 | 9092.0 samples/s | 35.5 steps/s
Avg test loss: 4.17383, Avg test acc: 0.10484, Avg tpr: 0.54081, Avg fpr: 0.90309, total FA: 125392

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.42050 | acc=0.1286 | tpr=0.4867 | fpr=0.8778 | 5748.7 samples/s | 22.5 steps/s
[Step= 100] | Loss=4.37961 | acc=0.1274 | tpr=0.4520 | fpr=0.8787 | 7294.1 samples/s | 28.5 steps/s
[Step= 150] | Loss=4.39782 | acc=0.1263 | tpr=0.4481 | fpr=0.8797 | 8071.9 samples/s | 31.5 steps/s
[Step= 200] | Loss=4.38304 | acc=0.1258 | tpr=0.4481 | fpr=0.8800 | 8311.4 samples/s | 32.5 steps/s
[Step= 250] | Loss=4.39322 | acc=0.1254 | tpr=0.4445 | fpr=0.8805 | 8008.7 samples/s | 31.3 steps/s
[Step= 300] | Loss=4.39738 | acc=0.1250 | tpr=0.4480 | fpr=0.8809 | 8468.9 samples/s | 33.1 steps/s
[Step= 350] | Loss=4.39855 | acc=0.1249 | tpr=0.4427 | fpr=0.8809 | 8234.5 samples/s | 32.2 steps/s
[Step= 400] | Loss=4.39543 | acc=0.1250 | tpr=0.4453 | fpr=0.8808 | 7761.7 samples/s | 30.3 steps/s
[Step= 450] | Loss=4.39461 | acc=0.1250 | tpr=0.4460 | fpr=0.8808 | 8405.2 samples/s | 32.8 steps/s
[Step= 500] | Loss=4.39617 | acc=0.1249 | tpr=0.4471 | fpr=0.8809 | 7701.3 samples/s | 30.1 steps/s
[Step= 550] | Loss=4.39195 | acc=0.1250 | tpr=0.4469 | fpr=0.8809 | 10392.8 samples/s | 40.6 steps/s
Avg test loss: 4.39237, Avg test acc: 0.12485, Avg tpr: 0.44691, Avg fpr: 0.88100, total FA: 122325

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=3.04517 | acc=0.1076 | tpr=0.6239 | fpr=0.9017 | 5770.3 samples/s | 22.5 steps/s
[Step= 100] | Loss=3.04251 | acc=0.1081 | tpr=0.5821 | fpr=0.9007 | 8057.9 samples/s | 31.5 steps/s
[Step= 150] | Loss=3.04755 | acc=0.1075 | tpr=0.5576 | fpr=0.9008 | 7267.4 samples/s | 28.4 steps/s
[Step= 200] | Loss=3.04350 | acc=0.1075 | tpr=0.5399 | fpr=0.9003 | 8299.8 samples/s | 32.4 steps/s
[Step= 250] | Loss=3.04726 | acc=0.1078 | tpr=0.5415 | fpr=0.9001 | 8256.2 samples/s | 32.3 steps/s
[Step= 300] | Loss=3.04943 | acc=0.1082 | tpr=0.5455 | fpr=0.8998 | 8663.9 samples/s | 33.8 steps/s
[Step= 350] | Loss=3.05057 | acc=0.1081 | tpr=0.5391 | fpr=0.8997 | 8289.0 samples/s | 32.4 steps/s
[Step= 400] | Loss=3.04841 | acc=0.1084 | tpr=0.5410 | fpr=0.8995 | 7660.3 samples/s | 29.9 steps/s
[Step= 450] | Loss=3.04670 | acc=0.1086 | tpr=0.5389 | fpr=0.8992 | 8250.5 samples/s | 32.2 steps/s
[Step= 500] | Loss=3.04754 | acc=0.1084 | tpr=0.5330 | fpr=0.8993 | 8614.4 samples/s | 33.7 steps/s
[Step= 550] | Loss=3.04709 | acc=0.1082 | tpr=0.5308 | fpr=0.8994 | 8953.1 samples/s | 35.0 steps/s
Avg test loss: 3.04757, Avg test acc: 0.10816, Avg tpr: 0.53090, Avg fpr: 0.89952, total FA: 124897

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=3.81128 | acc=0.1607 | tpr=0.4336 | fpr=0.8442 | 5666.4 samples/s | 22.1 steps/s
[Step= 100] | Loss=3.79868 | acc=0.1611 | tpr=0.4606 | fpr=0.8445 | 8307.6 samples/s | 32.5 steps/s
[Step= 150] | Loss=3.81144 | acc=0.1590 | tpr=0.4424 | fpr=0.8462 | 7576.6 samples/s | 29.6 steps/s
[Step= 200] | Loss=3.81438 | acc=0.1581 | tpr=0.4361 | fpr=0.8470 | 8499.3 samples/s | 33.2 steps/s
[Step= 250] | Loss=3.81833 | acc=0.1584 | tpr=0.4454 | fpr=0.8468 | 8320.1 samples/s | 32.5 steps/s
[Step= 300] | Loss=3.81170 | acc=0.1590 | tpr=0.4560 | fpr=0.8465 | 7832.5 samples/s | 30.6 steps/s
[Step= 350] | Loss=3.81622 | acc=0.1584 | tpr=0.4483 | fpr=0.8469 | 8310.7 samples/s | 32.5 steps/s
[Step= 400] | Loss=3.81255 | acc=0.1591 | tpr=0.4497 | fpr=0.8462 | 7764.0 samples/s | 30.3 steps/s
[Step= 450] | Loss=3.81155 | acc=0.1596 | tpr=0.4518 | fpr=0.8457 | 8323.8 samples/s | 32.5 steps/s
[Step= 500] | Loss=3.81405 | acc=0.1592 | tpr=0.4546 | fpr=0.8461 | 8173.9 samples/s | 31.9 steps/s
[Step= 550] | Loss=3.81216 | acc=0.1594 | tpr=0.4548 | fpr=0.8460 | 9638.7 samples/s | 37.7 steps/s
Avg test loss: 3.81256, Avg test acc: 0.15924, Avg tpr: 0.45483, Avg fpr: 0.84613, total FA: 117484

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07411 | acc=0.9802 | tpr=0.8717 | fpr=0.0178 | 5799.7 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.07696 | acc=0.9796 | tpr=0.8870 | fpr=0.0187 | 7971.7 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.08029 | acc=0.9787 | tpr=0.8919 | fpr=0.0197 | 7373.6 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.08069 | acc=0.9786 | tpr=0.8962 | fpr=0.0199 | 8098.5 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.08069 | acc=0.9787 | tpr=0.8891 | fpr=0.0196 | 8107.0 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.08250 | acc=0.9785 | tpr=0.8880 | fpr=0.0198 | 8236.5 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.08349 | acc=0.9784 | tpr=0.8910 | fpr=0.0200 | 7746.6 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.08356 | acc=0.9782 | tpr=0.8873 | fpr=0.0201 | 8304.2 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.08537 | acc=0.9780 | tpr=0.8856 | fpr=0.0204 | 8133.5 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.08413 | acc=0.9782 | tpr=0.8899 | fpr=0.0202 | 7865.2 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.08377 | acc=0.9783 | tpr=0.8898 | fpr=0.0201 | 10889.8 samples/s | 42.5 steps/s
Avg test loss: 0.08364, Avg test acc: 0.97828, Avg tpr: 0.88986, Avg fpr: 0.02011, total FA: 2792

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08633 | acc=0.9814 | tpr=0.8540 | fpr=0.0163 | 5699.9 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.09049 | acc=0.9814 | tpr=0.8678 | fpr=0.0165 | 7695.4 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.09433 | acc=0.9808 | tpr=0.8761 | fpr=0.0173 | 8260.7 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.09493 | acc=0.9810 | tpr=0.8863 | fpr=0.0173 | 7350.7 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.09421 | acc=0.9812 | tpr=0.8856 | fpr=0.0171 | 8035.2 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.09586 | acc=0.9811 | tpr=0.8865 | fpr=0.0172 | 8180.2 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.09608 | acc=0.9808 | tpr=0.8848 | fpr=0.0174 | 7947.2 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.09687 | acc=0.9806 | tpr=0.8813 | fpr=0.0176 | 8284.9 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.09884 | acc=0.9804 | tpr=0.8802 | fpr=0.0178 | 8067.7 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.09839 | acc=0.9805 | tpr=0.8824 | fpr=0.0177 | 8166.4 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.09785 | acc=0.9806 | tpr=0.8826 | fpr=0.0176 | 11364.5 samples/s | 44.4 steps/s
Avg test loss: 0.09762, Avg test acc: 0.98068, Avg tpr: 0.88233, Avg fpr: 0.01754, total FA: 2435

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.08957 | acc=0.9741 | tpr=0.9204 | fpr=0.0250 | 5835.6 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.09244 | acc=0.9732 | tpr=0.9360 | fpr=0.0261 | 7611.7 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.09531 | acc=0.9721 | tpr=0.9438 | fpr=0.0273 | 7782.9 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.09678 | acc=0.9719 | tpr=0.9454 | fpr=0.0276 | 8412.1 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.09812 | acc=0.9717 | tpr=0.9406 | fpr=0.0277 | 7867.6 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.09902 | acc=0.9714 | tpr=0.9389 | fpr=0.0280 | 8130.5 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.09891 | acc=0.9716 | tpr=0.9393 | fpr=0.0278 | 8451.3 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.09948 | acc=0.9715 | tpr=0.9387 | fpr=0.0279 | 8045.0 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.10032 | acc=0.9714 | tpr=0.9348 | fpr=0.0279 | 8266.8 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.10005 | acc=0.9714 | tpr=0.9357 | fpr=0.0279 | 7381.5 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.09922 | acc=0.9716 | tpr=0.9359 | fpr=0.0278 | 10795.3 samples/s | 42.2 steps/s
Avg test loss: 0.09900, Avg test acc: 0.97164, Avg tpr: 0.93621, Avg fpr: 0.02771, total FA: 3848

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.07537 | acc=0.9812 | tpr=0.8938 | fpr=0.0173 | 5271.5 samples/s | 20.6 steps/s
[Step= 100] | Loss=0.08315 | acc=0.9813 | tpr=0.9126 | fpr=0.0174 | 8535.2 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.08556 | acc=0.9808 | tpr=0.9179 | fpr=0.0181 | 8099.7 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.08520 | acc=0.9810 | tpr=0.9213 | fpr=0.0180 | 8160.8 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.08574 | acc=0.9809 | tpr=0.9153 | fpr=0.0179 | 8205.8 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.08656 | acc=0.9807 | tpr=0.9156 | fpr=0.0181 | 7786.8 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.08681 | acc=0.9805 | tpr=0.9148 | fpr=0.0183 | 8483.3 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.08752 | acc=0.9804 | tpr=0.9130 | fpr=0.0183 | 7824.4 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.08837 | acc=0.9802 | tpr=0.9119 | fpr=0.0185 | 8361.0 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.08814 | acc=0.9803 | tpr=0.9132 | fpr=0.0185 | 8180.5 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.08763 | acc=0.9804 | tpr=0.9148 | fpr=0.0184 | 10364.9 samples/s | 40.5 steps/s
Avg test loss: 0.08748, Avg test acc: 0.98037, Avg tpr: 0.91442, Avg fpr: 0.01843, total FA: 2559

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.09051 | acc=0.9780 | tpr=0.8717 | fpr=0.0201 | 5683.1 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.09099 | acc=0.9778 | tpr=0.8977 | fpr=0.0207 | 7835.5 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.09341 | acc=0.9776 | tpr=0.9135 | fpr=0.0212 | 7931.4 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.09424 | acc=0.9779 | tpr=0.9158 | fpr=0.0210 | 8355.1 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.09353 | acc=0.9780 | tpr=0.9109 | fpr=0.0208 | 8350.9 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.09483 | acc=0.9778 | tpr=0.9105 | fpr=0.0210 | 8445.9 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.09506 | acc=0.9777 | tpr=0.9111 | fpr=0.0211 | 8070.1 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.09597 | acc=0.9774 | tpr=0.9059 | fpr=0.0213 | 7925.7 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.09687 | acc=0.9772 | tpr=0.9031 | fpr=0.0214 | 7977.5 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.09609 | acc=0.9773 | tpr=0.9022 | fpr=0.0214 | 8305.8 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.09536 | acc=0.9775 | tpr=0.9009 | fpr=0.0211 | 9491.8 samples/s | 37.1 steps/s
Avg test loss: 0.09517, Avg test acc: 0.97748, Avg tpr: 0.90055, Avg fpr: 0.02112, total FA: 2933

server round 6/50

clients selected: [0 1 2 5 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.16076 | Reg=0.00171 | acc=0.8594 | L2-Norm=13.067 | L2-Norm(final)=5.607 | 6046.7 samples/s | 94.5 steps/s
[Step=2050 Epoch=10.0] | Loss=0.13537 | Reg=0.00171 | acc=0.9375 | L2-Norm=13.069 | L2-Norm(final)=5.648 | 4868.3 samples/s | 76.1 steps/s
[Step=2100 Epoch=10.2] | Loss=0.12960 | Reg=0.00171 | acc=0.9375 | L2-Norm=13.070 | L2-Norm(final)=5.729 | 5617.2 samples/s | 87.8 steps/s
[Step=2150 Epoch=10.5] | Loss=0.12685 | Reg=0.00171 | acc=0.8594 | L2-Norm=13.070 | L2-Norm(final)=5.839 | 5644.8 samples/s | 88.2 steps/s
[Step=2200 Epoch=10.7] | Loss=0.12686 | Reg=0.00171 | acc=0.9219 | L2-Norm=13.070 | L2-Norm(final)=5.945 | 8735.3 samples/s | 136.5 steps/s
[Step=2250 Epoch=11.0] | Loss=0.12687 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.070 | L2-Norm(final)=6.042 | 2444.0 samples/s | 38.2 steps/s
[Step=2300 Epoch=11.2] | Loss=0.12583 | Reg=0.00171 | acc=0.9062 | L2-Norm=13.070 | L2-Norm(final)=6.135 | 5703.2 samples/s | 89.1 steps/s
[Step=2350 Epoch=11.5] | Loss=0.12445 | Reg=0.00171 | acc=0.9062 | L2-Norm=13.070 | L2-Norm(final)=6.225 | 5580.3 samples/s | 87.2 steps/s
[Step=2400 Epoch=11.7] | Loss=0.12413 | Reg=0.00171 | acc=0.8594 | L2-Norm=13.070 | L2-Norm(final)=6.313 | 7751.7 samples/s | 121.1 steps/s
[Step=2450 Epoch=11.9] | Loss=0.12371 | Reg=0.00171 | acc=0.8750 | L2-Norm=13.070 | L2-Norm(final)=6.397 | 2517.9 samples/s | 39.3 steps/s
[Step=2500 Epoch=12.2] | Loss=0.12341 | Reg=0.00171 | acc=0.9375 | L2-Norm=13.070 | L2-Norm(final)=6.479 | 5604.8 samples/s | 87.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.10792 | Reg=0.00171 | acc=0.9375 | L2-Norm=13.070 | L2-Norm(final)=7.281 | 5717.3 samples/s | 89.3 steps/s
[Step=2550 Epoch=12.4] | Loss=0.09470 | Reg=0.00178 | acc=0.9375 | L2-Norm=13.347 | L2-Norm(final)=7.285 | 4403.7 samples/s | 68.8 steps/s
[Step=2600 Epoch=12.7] | Loss=0.09142 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.555 | L2-Norm(final)=7.257 | 4850.9 samples/s | 75.8 steps/s
[Step=2650 Epoch=12.9] | Loss=0.09038 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.704 | L2-Norm(final)=7.239 | 4862.4 samples/s | 76.0 steps/s
[Step=2700 Epoch=13.2] | Loss=0.08458 | Reg=0.00191 | acc=0.9531 | L2-Norm=13.818 | L2-Norm(final)=7.225 | 6949.1 samples/s | 108.6 steps/s
[Step=2750 Epoch=13.4] | Loss=0.08311 | Reg=0.00194 | acc=0.9062 | L2-Norm=13.926 | L2-Norm(final)=7.211 | 2261.8 samples/s | 35.3 steps/s
[Step=2800 Epoch=13.7] | Loss=0.07749 | Reg=0.00197 | acc=0.9375 | L2-Norm=14.027 | L2-Norm(final)=7.203 | 4890.6 samples/s | 76.4 steps/s
[Step=2850 Epoch=13.9] | Loss=0.07381 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.111 | L2-Norm(final)=7.196 | 4800.5 samples/s | 75.0 steps/s
[Step=2900 Epoch=14.1] | Loss=0.06970 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.183 | L2-Norm(final)=7.192 | 6338.9 samples/s | 99.0 steps/s
[Step=2950 Epoch=14.4] | Loss=0.06534 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.247 | L2-Norm(final)=7.189 | 2342.7 samples/s | 36.6 steps/s
[Step=3000 Epoch=14.6] | Loss=0.06143 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.304 | L2-Norm(final)=7.188 | 4808.6 samples/s | 75.1 steps/s
[Step=3050 Epoch=14.9] | Loss=0.05834 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.358 | L2-Norm(final)=7.188 | 4879.3 samples/s | 76.2 steps/s
[Step=3100 Epoch=15.1] | Loss=0.05610 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.406 | L2-Norm(final)=7.189 | 5822.3 samples/s | 91.0 steps/s
[Step=3150 Epoch=15.4] | Loss=0.05373 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.451 | L2-Norm(final)=7.189 | 2435.1 samples/s | 38.0 steps/s
[Step=3200 Epoch=15.6] | Loss=0.05146 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.492 | L2-Norm(final)=7.189 | 4833.7 samples/s | 75.5 steps/s
[Step=3250 Epoch=15.8] | Loss=0.04958 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.531 | L2-Norm(final)=7.190 | 4849.9 samples/s | 75.8 steps/s
[Step=3300 Epoch=16.1] | Loss=0.04808 | Reg=0.00212 | acc=0.9375 | L2-Norm=14.568 | L2-Norm(final)=7.191 | 5242.0 samples/s | 81.9 steps/s
[Step=3350 Epoch=16.3] | Loss=0.04879 | Reg=0.00214 | acc=0.8594 | L2-Norm=14.605 | L2-Norm(final)=7.191 | 2499.7 samples/s | 39.1 steps/s
[Step=3400 Epoch=16.6] | Loss=0.04873 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.650 | L2-Norm(final)=7.188 | 4788.4 samples/s | 74.8 steps/s
[Step=3450 Epoch=16.8] | Loss=0.04796 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.694 | L2-Norm(final)=7.184 | 4877.0 samples/s | 76.2 steps/s
[Step=3500 Epoch=17.1] | Loss=0.04682 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.738 | L2-Norm(final)=7.181 | 4980.0 samples/s | 77.8 steps/s
[Step=3550 Epoch=17.3] | Loss=0.04566 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.780 | L2-Norm(final)=7.179 | 2610.6 samples/s | 40.8 steps/s
[Step=3600 Epoch=17.6] | Loss=0.04422 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.820 | L2-Norm(final)=7.177 | 4885.0 samples/s | 76.3 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04314 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.858 | L2-Norm(final)=7.176 | 4822.4 samples/s | 75.3 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04241 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.895 | L2-Norm(final)=7.175 | 4875.3 samples/s | 76.2 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04147 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.929 | L2-Norm(final)=7.174 | 2653.6 samples/s | 41.5 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04037 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.963 | L2-Norm(final)=7.173 | 4862.0 samples/s | 76.0 steps/s
[Step=3850 Epoch=18.8] | Loss=0.03939 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.994 | L2-Norm(final)=7.172 | 4891.0 samples/s | 76.4 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03853 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.024 | L2-Norm(final)=7.172 | 4894.6 samples/s | 76.5 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03762 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.053 | L2-Norm(final)=7.171 | 2662.6 samples/s | 41.6 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03667 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.080 | L2-Norm(final)=7.171 | 4938.9 samples/s | 77.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=48.8] | Loss=0.15317 | Reg=0.00171 | acc=0.8438 | L2-Norm=13.067 | L2-Norm(final)=8.559 | 5408.8 samples/s | 84.5 steps/s
[Step=10050 Epoch=49.0] | Loss=0.11972 | Reg=0.00171 | acc=0.9375 | L2-Norm=13.072 | L2-Norm(final)=8.552 | 5192.2 samples/s | 81.1 steps/s
[Step=10100 Epoch=49.3] | Loss=0.11862 | Reg=0.00171 | acc=0.8750 | L2-Norm=13.073 | L2-Norm(final)=8.589 | 5666.9 samples/s | 88.5 steps/s
[Step=10150 Epoch=49.5] | Loss=0.11901 | Reg=0.00171 | acc=0.8438 | L2-Norm=13.073 | L2-Norm(final)=8.630 | 5481.4 samples/s | 85.6 steps/s
[Step=10200 Epoch=49.8] | Loss=0.11755 | Reg=0.00171 | acc=0.9062 | L2-Norm=13.074 | L2-Norm(final)=8.679 | 8708.5 samples/s | 136.1 steps/s
[Step=10250 Epoch=50.0] | Loss=0.11675 | Reg=0.00171 | acc=0.9219 | L2-Norm=13.074 | L2-Norm(final)=8.735 | 2429.6 samples/s | 38.0 steps/s
[Step=10300 Epoch=50.3] | Loss=0.11712 | Reg=0.00171 | acc=0.8906 | L2-Norm=13.074 | L2-Norm(final)=8.789 | 5625.4 samples/s | 87.9 steps/s
[Step=10350 Epoch=50.5] | Loss=0.11675 | Reg=0.00171 | acc=0.9062 | L2-Norm=13.074 | L2-Norm(final)=8.843 | 5486.2 samples/s | 85.7 steps/s
[Step=10400 Epoch=50.7] | Loss=0.11616 | Reg=0.00171 | acc=0.9062 | L2-Norm=13.074 | L2-Norm(final)=8.898 | 7881.6 samples/s | 123.2 steps/s
[Step=10450 Epoch=51.0] | Loss=0.11650 | Reg=0.00171 | acc=0.8594 | L2-Norm=13.074 | L2-Norm(final)=8.952 | 2520.3 samples/s | 39.4 steps/s
[Step=10500 Epoch=51.2] | Loss=0.11638 | Reg=0.00171 | acc=0.8750 | L2-Norm=13.074 | L2-Norm(final)=9.006 | 5521.2 samples/s | 86.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=51.2] | Loss=0.10800 | Reg=0.00171 | acc=0.9062 | L2-Norm=13.074 | L2-Norm(final)=9.538 | 5747.6 samples/s | 89.8 steps/s
[Step=10550 Epoch=51.5] | Loss=0.09227 | Reg=0.00180 | acc=0.8906 | L2-Norm=13.420 | L2-Norm(final)=9.522 | 4563.8 samples/s | 71.3 steps/s
[Step=10600 Epoch=51.7] | Loss=0.08724 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.676 | L2-Norm(final)=9.493 | 4833.1 samples/s | 75.5 steps/s
[Step=10650 Epoch=52.0] | Loss=0.08401 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.834 | L2-Norm(final)=9.473 | 4854.3 samples/s | 75.8 steps/s
[Step=10700 Epoch=52.2] | Loss=0.08016 | Reg=0.00195 | acc=0.9531 | L2-Norm=13.957 | L2-Norm(final)=9.459 | 6973.7 samples/s | 109.0 steps/s
[Step=10750 Epoch=52.5] | Loss=0.07217 | Reg=0.00198 | acc=0.9531 | L2-Norm=14.056 | L2-Norm(final)=9.451 | 2263.1 samples/s | 35.4 steps/s
[Step=10800 Epoch=52.7] | Loss=0.06671 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.136 | L2-Norm(final)=9.445 | 4834.0 samples/s | 75.5 steps/s
[Step=10850 Epoch=52.9] | Loss=0.06390 | Reg=0.00202 | acc=0.9688 | L2-Norm=14.205 | L2-Norm(final)=9.441 | 4847.3 samples/s | 75.7 steps/s
[Step=10900 Epoch=53.2] | Loss=0.06186 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.266 | L2-Norm(final)=9.434 | 6465.9 samples/s | 101.0 steps/s
[Step=10950 Epoch=53.4] | Loss=0.05802 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.323 | L2-Norm(final)=9.430 | 2330.7 samples/s | 36.4 steps/s
[Step=11000 Epoch=53.7] | Loss=0.05548 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.373 | L2-Norm(final)=9.428 | 4844.8 samples/s | 75.7 steps/s
[Step=11050 Epoch=53.9] | Loss=0.05340 | Reg=0.00208 | acc=0.9531 | L2-Norm=14.420 | L2-Norm(final)=9.426 | 4861.2 samples/s | 76.0 steps/s
[Step=11100 Epoch=54.2] | Loss=0.05186 | Reg=0.00209 | acc=0.9531 | L2-Norm=14.464 | L2-Norm(final)=9.424 | 6013.6 samples/s | 94.0 steps/s
[Step=11150 Epoch=54.4] | Loss=0.04994 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.507 | L2-Norm(final)=9.422 | 2399.4 samples/s | 37.5 steps/s
[Step=11200 Epoch=54.7] | Loss=0.04811 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.547 | L2-Norm(final)=9.420 | 4798.1 samples/s | 75.0 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04679 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.585 | L2-Norm(final)=9.419 | 4837.3 samples/s | 75.6 steps/s
[Step=11300 Epoch=55.1] | Loss=0.04513 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.621 | L2-Norm(final)=9.418 | 5633.2 samples/s | 88.0 steps/s
[Step=11350 Epoch=55.4] | Loss=0.04346 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.654 | L2-Norm(final)=9.418 | 2462.9 samples/s | 38.5 steps/s
[Step=11400 Epoch=55.6] | Loss=0.04192 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.686 | L2-Norm(final)=9.420 | 4741.6 samples/s | 74.1 steps/s
[Step=11450 Epoch=55.9] | Loss=0.04098 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.717 | L2-Norm(final)=9.420 | 4886.7 samples/s | 76.4 steps/s
[Step=11500 Epoch=56.1] | Loss=0.04011 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.747 | L2-Norm(final)=9.420 | 5245.5 samples/s | 82.0 steps/s
[Step=11550 Epoch=56.4] | Loss=0.03897 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.777 | L2-Norm(final)=9.420 | 2538.3 samples/s | 39.7 steps/s
[Step=11600 Epoch=56.6] | Loss=0.03794 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.806 | L2-Norm(final)=9.420 | 4857.7 samples/s | 75.9 steps/s
[Step=11650 Epoch=56.8] | Loss=0.03696 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.832 | L2-Norm(final)=9.420 | 4828.3 samples/s | 75.4 steps/s
[Step=11700 Epoch=57.1] | Loss=0.03607 | Reg=0.00221 | acc=0.9531 | L2-Norm=14.857 | L2-Norm(final)=9.420 | 4939.8 samples/s | 77.2 steps/s
[Step=11750 Epoch=57.3] | Loss=0.03528 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.881 | L2-Norm(final)=9.420 | 2600.3 samples/s | 40.6 steps/s
[Step=11800 Epoch=57.6] | Loss=0.03443 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.905 | L2-Norm(final)=9.420 | 4944.3 samples/s | 77.3 steps/s
[Step=11850 Epoch=57.8] | Loss=0.03348 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.927 | L2-Norm(final)=9.421 | 4770.0 samples/s | 74.5 steps/s
[Step=11900 Epoch=58.1] | Loss=0.03277 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.948 | L2-Norm(final)=9.422 | 4902.4 samples/s | 76.6 steps/s
[Step=11950 Epoch=58.3] | Loss=0.03208 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.968 | L2-Norm(final)=9.422 | 2619.2 samples/s | 40.9 steps/s
[Step=12000 Epoch=58.6] | Loss=0.03136 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.987 | L2-Norm(final)=9.423 | 4905.8 samples/s | 76.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step12000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=29.2] | Loss=0.12113 | Reg=0.00171 | acc=0.9375 | L2-Norm=13.067 | L2-Norm(final)=6.620 | 5636.6 samples/s | 88.1 steps/s
[Step=6050 Epoch=29.5] | Loss=0.11085 | Reg=0.00171 | acc=0.9062 | L2-Norm=13.072 | L2-Norm(final)=6.666 | 5099.3 samples/s | 79.7 steps/s
[Step=6100 Epoch=29.7] | Loss=0.11435 | Reg=0.00171 | acc=0.8750 | L2-Norm=13.073 | L2-Norm(final)=6.727 | 5834.8 samples/s | 91.2 steps/s
[Step=6150 Epoch=30.0] | Loss=0.11182 | Reg=0.00171 | acc=0.9375 | L2-Norm=13.073 | L2-Norm(final)=6.789 | 5440.7 samples/s | 85.0 steps/s
[Step=6200 Epoch=30.2] | Loss=0.10995 | Reg=0.00171 | acc=0.9219 | L2-Norm=13.073 | L2-Norm(final)=6.862 | 8760.2 samples/s | 136.9 steps/s
[Step=6250 Epoch=30.5] | Loss=0.11042 | Reg=0.00171 | acc=0.9219 | L2-Norm=13.073 | L2-Norm(final)=6.936 | 2407.3 samples/s | 37.6 steps/s
[Step=6300 Epoch=30.7] | Loss=0.10886 | Reg=0.00171 | acc=0.9375 | L2-Norm=13.073 | L2-Norm(final)=7.009 | 5674.4 samples/s | 88.7 steps/s
[Step=6350 Epoch=30.9] | Loss=0.10822 | Reg=0.00171 | acc=0.8906 | L2-Norm=13.073 | L2-Norm(final)=7.081 | 5579.5 samples/s | 87.2 steps/s
[Step=6400 Epoch=31.2] | Loss=0.10803 | Reg=0.00171 | acc=0.8438 | L2-Norm=13.073 | L2-Norm(final)=7.151 | 7796.8 samples/s | 121.8 steps/s
[Step=6450 Epoch=31.4] | Loss=0.10737 | Reg=0.00171 | acc=0.9219 | L2-Norm=13.074 | L2-Norm(final)=7.217 | 2518.9 samples/s | 39.4 steps/s
[Step=6500 Epoch=31.7] | Loss=0.10721 | Reg=0.00171 | acc=0.9531 | L2-Norm=13.074 | L2-Norm(final)=7.282 | 5676.8 samples/s | 88.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=31.7] | Loss=0.11633 | Reg=0.00171 | acc=0.9531 | L2-Norm=13.074 | L2-Norm(final)=7.925 | 5590.7 samples/s | 87.4 steps/s
[Step=6550 Epoch=31.9] | Loss=0.09226 | Reg=0.00177 | acc=0.9219 | L2-Norm=13.289 | L2-Norm(final)=7.937 | 4522.9 samples/s | 70.7 steps/s
[Step=6600 Epoch=32.2] | Loss=0.08507 | Reg=0.00182 | acc=0.8750 | L2-Norm=13.477 | L2-Norm(final)=7.920 | 4825.8 samples/s | 75.4 steps/s
[Step=6650 Epoch=32.4] | Loss=0.07903 | Reg=0.00185 | acc=0.9531 | L2-Norm=13.593 | L2-Norm(final)=7.905 | 4940.8 samples/s | 77.2 steps/s
[Step=6700 Epoch=32.6] | Loss=0.07791 | Reg=0.00187 | acc=0.9219 | L2-Norm=13.677 | L2-Norm(final)=7.895 | 6852.0 samples/s | 107.1 steps/s
[Step=6750 Epoch=32.9] | Loss=0.06942 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.754 | L2-Norm(final)=7.890 | 2269.3 samples/s | 35.5 steps/s
[Step=6800 Epoch=33.1] | Loss=0.06517 | Reg=0.00191 | acc=0.9531 | L2-Norm=13.825 | L2-Norm(final)=7.888 | 4840.9 samples/s | 75.6 steps/s
[Step=6850 Epoch=33.4] | Loss=0.06266 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.891 | L2-Norm(final)=7.883 | 4899.4 samples/s | 76.6 steps/s
[Step=6900 Epoch=33.6] | Loss=0.06117 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.952 | L2-Norm(final)=7.878 | 6284.9 samples/s | 98.2 steps/s
[Step=6950 Epoch=33.9] | Loss=0.05802 | Reg=0.00196 | acc=0.9531 | L2-Norm=14.010 | L2-Norm(final)=7.875 | 2367.5 samples/s | 37.0 steps/s
[Step=7000 Epoch=34.1] | Loss=0.05488 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.065 | L2-Norm(final)=7.874 | 4835.6 samples/s | 75.6 steps/s
[Step=7050 Epoch=34.4] | Loss=0.05289 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.116 | L2-Norm(final)=7.873 | 4885.8 samples/s | 76.3 steps/s
[Step=7100 Epoch=34.6] | Loss=0.05100 | Reg=0.00201 | acc=0.9375 | L2-Norm=14.163 | L2-Norm(final)=7.871 | 5771.5 samples/s | 90.2 steps/s
[Step=7150 Epoch=34.8] | Loss=0.04881 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.208 | L2-Norm(final)=7.870 | 2438.9 samples/s | 38.1 steps/s
[Step=7200 Epoch=35.1] | Loss=0.04678 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.248 | L2-Norm(final)=7.870 | 4839.5 samples/s | 75.6 steps/s
[Step=7250 Epoch=35.3] | Loss=0.04489 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.285 | L2-Norm(final)=7.870 | 4845.7 samples/s | 75.7 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04356 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.319 | L2-Norm(final)=7.871 | 5386.9 samples/s | 84.2 steps/s
[Step=7350 Epoch=35.8] | Loss=0.04214 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.351 | L2-Norm(final)=7.871 | 2511.1 samples/s | 39.2 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04057 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.383 | L2-Norm(final)=7.872 | 4861.1 samples/s | 76.0 steps/s
[Step=7450 Epoch=36.3] | Loss=0.03943 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.413 | L2-Norm(final)=7.873 | 4939.4 samples/s | 77.2 steps/s
[Step=7500 Epoch=36.5] | Loss=0.03850 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.443 | L2-Norm(final)=7.874 | 4906.8 samples/s | 76.7 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03748 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.471 | L2-Norm(final)=7.875 | 2603.2 samples/s | 40.7 steps/s
[Step=7600 Epoch=37.0] | Loss=0.03667 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.499 | L2-Norm(final)=7.876 | 4838.7 samples/s | 75.6 steps/s
[Step=7650 Epoch=37.3] | Loss=0.03592 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.525 | L2-Norm(final)=7.877 | 4855.7 samples/s | 75.9 steps/s
[Step=7700 Epoch=37.5] | Loss=0.03512 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.550 | L2-Norm(final)=7.878 | 4950.5 samples/s | 77.4 steps/s
[Step=7750 Epoch=37.8] | Loss=0.03447 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.575 | L2-Norm(final)=7.879 | 2639.1 samples/s | 41.2 steps/s
[Step=7800 Epoch=38.0] | Loss=0.03376 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.601 | L2-Norm(final)=7.880 | 4864.9 samples/s | 76.0 steps/s
[Step=7850 Epoch=38.2] | Loss=0.03327 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.627 | L2-Norm(final)=7.881 | 4872.2 samples/s | 76.1 steps/s
[Step=7900 Epoch=38.5] | Loss=0.03287 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.654 | L2-Norm(final)=7.882 | 4856.2 samples/s | 75.9 steps/s
[Step=7950 Epoch=38.7] | Loss=0.03243 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.681 | L2-Norm(final)=7.882 | 2641.1 samples/s | 41.3 steps/s
[Step=8000 Epoch=39.0] | Loss=0.03185 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.708 | L2-Norm(final)=7.882 | 4840.3 samples/s | 75.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step8000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=94.8] | Loss=0.03566 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.067 | L2-Norm(final)=11.425 | 5521.9 samples/s | 86.3 steps/s
[Step=10050 Epoch=95.2] | Loss=0.04283 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.056 | L2-Norm(final)=11.290 | 5001.2 samples/s | 78.1 steps/s
[Step=10100 Epoch=95.7] | Loss=0.03185 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.055 | L2-Norm(final)=11.248 | 8262.5 samples/s | 129.1 steps/s
[Step=10150 Epoch=96.2] | Loss=0.02726 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.055 | L2-Norm(final)=11.230 | 2365.7 samples/s | 37.0 steps/s
[Step=10200 Epoch=96.7] | Loss=0.02498 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.054 | L2-Norm(final)=11.225 | 7286.6 samples/s | 113.9 steps/s
[Step=10250 Epoch=97.1] | Loss=0.02359 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.054 | L2-Norm(final)=11.230 | 2426.0 samples/s | 37.9 steps/s
[Step=10300 Epoch=97.6] | Loss=0.02260 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.054 | L2-Norm(final)=11.242 | 6663.1 samples/s | 104.1 steps/s
[Step=10350 Epoch=98.1] | Loss=0.02128 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.054 | L2-Norm(final)=11.259 | 2523.6 samples/s | 39.4 steps/s
[Step=10400 Epoch=98.5] | Loss=0.02059 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.054 | L2-Norm(final)=11.280 | 5944.3 samples/s | 92.9 steps/s
[Step=10450 Epoch=99.0] | Loss=0.02041 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.054 | L2-Norm(final)=11.304 | 2646.2 samples/s | 41.3 steps/s
[Step=10500 Epoch=99.5] | Loss=0.02001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.054 | L2-Norm(final)=11.330 | 5428.8 samples/s | 84.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=99.5] | Loss=0.01262 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.054 | L2-Norm(final)=11.609 | 6408.6 samples/s | 100.1 steps/s
[Step=10550 Epoch=100.0] | Loss=0.02365 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.558 | L2-Norm(final)=11.595 | 3843.0 samples/s | 60.0 steps/s
[Step=10600 Epoch=100.4] | Loss=0.01984 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.918 | L2-Norm(final)=11.556 | 6741.8 samples/s | 105.3 steps/s
[Step=10650 Epoch=100.9] | Loss=0.01521 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.090 | L2-Norm(final)=11.530 | 2202.3 samples/s | 34.4 steps/s
[Step=10700 Epoch=101.4] | Loss=0.01249 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.179 | L2-Norm(final)=11.518 | 6035.4 samples/s | 94.3 steps/s
[Step=10750 Epoch=101.9] | Loss=0.01010 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.221 | L2-Norm(final)=11.510 | 2259.6 samples/s | 35.3 steps/s
[Step=10800 Epoch=102.3] | Loss=0.00843 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.233 | L2-Norm(final)=11.506 | 5543.8 samples/s | 86.6 steps/s
[Step=10850 Epoch=102.8] | Loss=0.00723 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.228 | L2-Norm(final)=11.504 | 2353.4 samples/s | 36.8 steps/s
[Step=10900 Epoch=103.3] | Loss=0.00633 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.212 | L2-Norm(final)=11.502 | 5083.8 samples/s | 79.4 steps/s
[Step=10950 Epoch=103.8] | Loss=0.00563 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.190 | L2-Norm(final)=11.501 | 2431.1 samples/s | 38.0 steps/s
[Step=11000 Epoch=104.2] | Loss=0.00507 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.164 | L2-Norm(final)=11.501 | 4754.2 samples/s | 74.3 steps/s
[Step=11050 Epoch=104.7] | Loss=0.00461 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.135 | L2-Norm(final)=11.500 | 2518.3 samples/s | 39.3 steps/s
[Step=11100 Epoch=105.2] | Loss=0.00423 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.104 | L2-Norm(final)=11.500 | 4732.5 samples/s | 73.9 steps/s
[Step=11150 Epoch=105.7] | Loss=0.00390 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.072 | L2-Norm(final)=11.500 | 2550.3 samples/s | 39.8 steps/s
[Step=11200 Epoch=106.1] | Loss=0.00363 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.039 | L2-Norm(final)=11.500 | 4605.9 samples/s | 72.0 steps/s
[Step=11250 Epoch=106.6] | Loss=0.00339 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.005 | L2-Norm(final)=11.500 | 2566.5 samples/s | 40.1 steps/s
[Step=11300 Epoch=107.1] | Loss=0.00317 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.971 | L2-Norm(final)=11.500 | 4644.7 samples/s | 72.6 steps/s
[Step=11350 Epoch=107.6] | Loss=0.00299 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.937 | L2-Norm(final)=11.500 | 2755.9 samples/s | 43.1 steps/s
[Step=11400 Epoch=108.0] | Loss=0.00282 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.903 | L2-Norm(final)=11.501 | 4348.4 samples/s | 67.9 steps/s
[Step=11450 Epoch=108.5] | Loss=0.00267 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.869 | L2-Norm(final)=11.501 | 6897.0 samples/s | 107.8 steps/s
[Step=11500 Epoch=109.0] | Loss=0.00254 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.835 | L2-Norm(final)=11.501 | 2163.2 samples/s | 33.8 steps/s
[Step=11550 Epoch=109.4] | Loss=0.00242 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.801 | L2-Norm(final)=11.502 | 6272.7 samples/s | 98.0 steps/s
[Step=11600 Epoch=109.9] | Loss=0.00231 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.767 | L2-Norm(final)=11.502 | 2231.0 samples/s | 34.9 steps/s
[Step=11650 Epoch=110.4] | Loss=0.00221 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.733 | L2-Norm(final)=11.502 | 5698.3 samples/s | 89.0 steps/s
[Step=11700 Epoch=110.9] | Loss=0.00212 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.699 | L2-Norm(final)=11.503 | 2336.2 samples/s | 36.5 steps/s
[Step=11750 Epoch=111.3] | Loss=0.00203 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.666 | L2-Norm(final)=11.503 | 5181.9 samples/s | 81.0 steps/s
[Step=11800 Epoch=111.8] | Loss=0.00196 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.632 | L2-Norm(final)=11.503 | 2424.0 samples/s | 37.9 steps/s
[Step=11850 Epoch=112.3] | Loss=0.00188 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.599 | L2-Norm(final)=11.504 | 4804.4 samples/s | 75.1 steps/s
[Step=11900 Epoch=112.8] | Loss=0.00182 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=11.504 | 2520.3 samples/s | 39.4 steps/s
[Step=11950 Epoch=113.2] | Loss=0.00175 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.533 | L2-Norm(final)=11.504 | 4572.0 samples/s | 71.4 steps/s
[Step=12000 Epoch=113.7] | Loss=0.00170 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.501 | L2-Norm(final)=11.505 | 2566.7 samples/s | 40.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step12000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=56.5] | Loss=0.03769 | Reg=0.00171 | acc=0.9531 | L2-Norm=13.067 | L2-Norm(final)=10.204 | 5719.7 samples/s | 89.4 steps/s
[Step=6050 Epoch=57.0] | Loss=0.02981 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.057 | L2-Norm(final)=10.189 | 4758.4 samples/s | 74.3 steps/s
[Step=6100 Epoch=57.5] | Loss=0.02648 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.055 | L2-Norm(final)=10.218 | 7846.4 samples/s | 122.6 steps/s
[Step=6150 Epoch=58.0] | Loss=0.02635 | Reg=0.00170 | acc=0.9375 | L2-Norm=13.055 | L2-Norm(final)=10.271 | 2377.1 samples/s | 37.1 steps/s
[Step=6200 Epoch=58.4] | Loss=0.02598 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.055 | L2-Norm(final)=10.326 | 7106.1 samples/s | 111.0 steps/s
[Step=6250 Epoch=58.9] | Loss=0.02491 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.054 | L2-Norm(final)=10.391 | 2468.2 samples/s | 38.6 steps/s
[Step=6300 Epoch=59.4] | Loss=0.02475 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.054 | L2-Norm(final)=10.457 | 6149.6 samples/s | 96.1 steps/s
[Step=6350 Epoch=59.8] | Loss=0.02482 | Reg=0.00170 | acc=0.9531 | L2-Norm=13.054 | L2-Norm(final)=10.524 | 2582.8 samples/s | 40.4 steps/s
[Step=6400 Epoch=60.3] | Loss=0.02437 | Reg=0.00170 | acc=0.9219 | L2-Norm=13.054 | L2-Norm(final)=10.591 | 5609.5 samples/s | 87.6 steps/s
[Step=6450 Epoch=60.8] | Loss=0.02424 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.054 | L2-Norm(final)=10.659 | 2769.8 samples/s | 43.3 steps/s
[Step=6500 Epoch=61.2] | Loss=0.02411 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.054 | L2-Norm(final)=10.726 | 5138.7 samples/s | 80.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=61.3] | Loss=0.01336 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.054 | L2-Norm(final)=11.399 | 5940.2 samples/s | 92.8 steps/s
[Step=6550 Epoch=61.7] | Loss=0.03870 | Reg=0.00186 | acc=0.9375 | L2-Norm=13.647 | L2-Norm(final)=11.365 | 4086.8 samples/s | 63.9 steps/s
[Step=6600 Epoch=62.2] | Loss=0.02562 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=11.303 | 6500.2 samples/s | 101.6 steps/s
[Step=6650 Epoch=62.7] | Loss=0.01759 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.263 | L2-Norm(final)=11.284 | 2204.8 samples/s | 34.5 steps/s
[Step=6700 Epoch=63.1] | Loss=0.01325 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.329 | L2-Norm(final)=11.278 | 5962.5 samples/s | 93.2 steps/s
[Step=6750 Epoch=63.6] | Loss=0.01063 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.348 | L2-Norm(final)=11.276 | 2291.0 samples/s | 35.8 steps/s
[Step=6800 Epoch=64.1] | Loss=0.00887 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.344 | L2-Norm(final)=11.275 | 5268.9 samples/s | 82.3 steps/s
[Step=6850 Epoch=64.5] | Loss=0.00760 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.328 | L2-Norm(final)=11.275 | 2423.2 samples/s | 37.9 steps/s
[Step=6900 Epoch=65.0] | Loss=0.00665 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.304 | L2-Norm(final)=11.276 | 4826.5 samples/s | 75.4 steps/s
[Step=6950 Epoch=65.5] | Loss=0.00592 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.275 | L2-Norm(final)=11.276 | 2496.8 samples/s | 39.0 steps/s
[Step=7000 Epoch=66.0] | Loss=0.00533 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.243 | L2-Norm(final)=11.276 | 4632.2 samples/s | 72.4 steps/s
[Step=7050 Epoch=66.4] | Loss=0.00484 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.209 | L2-Norm(final)=11.277 | 2564.6 samples/s | 40.1 steps/s
[Step=7100 Epoch=66.9] | Loss=0.00444 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.174 | L2-Norm(final)=11.277 | 4614.9 samples/s | 72.1 steps/s
[Step=7150 Epoch=67.4] | Loss=0.00410 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.138 | L2-Norm(final)=11.278 | 2617.7 samples/s | 40.9 steps/s
[Step=7200 Epoch=67.8] | Loss=0.00381 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.102 | L2-Norm(final)=11.278 | 4539.8 samples/s | 70.9 steps/s
[Step=7250 Epoch=68.3] | Loss=0.00355 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.066 | L2-Norm(final)=11.279 | 2654.5 samples/s | 41.5 steps/s
[Step=7300 Epoch=68.8] | Loss=0.00333 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.029 | L2-Norm(final)=11.280 | 4343.3 samples/s | 67.9 steps/s
[Step=7350 Epoch=69.3] | Loss=0.00314 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.992 | L2-Norm(final)=11.280 | 6684.0 samples/s | 104.4 steps/s
[Step=7400 Epoch=69.7] | Loss=0.00296 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.956 | L2-Norm(final)=11.281 | 2223.7 samples/s | 34.7 steps/s
[Step=7450 Epoch=70.2] | Loss=0.00281 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.919 | L2-Norm(final)=11.281 | 5809.5 samples/s | 90.8 steps/s
[Step=7500 Epoch=70.7] | Loss=0.00267 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.883 | L2-Norm(final)=11.282 | 2266.9 samples/s | 35.4 steps/s
[Step=7550 Epoch=71.1] | Loss=0.00254 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.847 | L2-Norm(final)=11.282 | 5388.7 samples/s | 84.2 steps/s
[Step=7600 Epoch=71.6] | Loss=0.00242 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.811 | L2-Norm(final)=11.283 | 2395.4 samples/s | 37.4 steps/s
[Step=7650 Epoch=72.1] | Loss=0.00232 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.775 | L2-Norm(final)=11.283 | 4875.1 samples/s | 76.2 steps/s
[Step=7700 Epoch=72.6] | Loss=0.00222 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.739 | L2-Norm(final)=11.284 | 2481.2 samples/s | 38.8 steps/s
[Step=7750 Epoch=73.0] | Loss=0.00213 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=11.285 | 4602.8 samples/s | 71.9 steps/s
[Step=7800 Epoch=73.5] | Loss=0.00205 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.669 | L2-Norm(final)=11.285 | 2553.9 samples/s | 39.9 steps/s
[Step=7850 Epoch=74.0] | Loss=0.00198 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.634 | L2-Norm(final)=11.286 | 4661.3 samples/s | 72.8 steps/s
[Step=7900 Epoch=74.4] | Loss=0.00191 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.599 | L2-Norm(final)=11.286 | 2562.8 samples/s | 40.0 steps/s
[Step=7950 Epoch=74.9] | Loss=0.00184 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=11.287 | 4643.8 samples/s | 72.6 steps/s
[Step=8000 Epoch=75.4] | Loss=0.00178 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.530 | L2-Norm(final)=11.287 | 2693.4 samples/s | 42.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.12948 | acc=0.9428 | tpr=0.9598 | fpr=0.0942 | 5724.3 samples/s | 22.4 steps/s
Avg test loss: 0.13310, Avg test acc: 0.94186, Avg tpr: 0.95943, Avg fpr: 0.09678, total FA: 755

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14973 | acc=0.9356 | tpr=0.9545 | fpr=0.1053 | 5757.7 samples/s | 22.5 steps/s
Avg test loss: 0.14755, Avg test acc: 0.93601, Avg tpr: 0.95349, Avg fpr: 0.10242, total FA: 799

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.14942 | acc=0.9334 | tpr=0.9472 | fpr=0.0964 | 5939.6 samples/s | 23.2 steps/s
Avg test loss: 0.15153, Avg test acc: 0.93249, Avg tpr: 0.94533, Avg fpr: 0.09576, total FA: 747

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10906 | acc=0.9289 | tpr=0.9493 | fpr=0.1155 | 5527.2 samples/s | 21.6 steps/s
Avg test loss: 0.11204, Avg test acc: 0.92736, Avg tpr: 0.94923, Avg fpr: 0.12075, total FA: 942

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.14992 | acc=0.9260 | tpr=0.9335 | fpr=0.0902 | 5794.3 samples/s | 22.6 steps/s
Avg test loss: 0.15234, Avg test acc: 0.92511, Avg tpr: 0.93198, Avg fpr: 0.08999, total FA: 702

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.10029 | acc=0.3116 | tpr=0.0082 | fpr=0.0295 | 5668.1 samples/s | 22.1 steps/s
Avg test loss: 4.11287, Avg test acc: 0.30924, Avg tpr: 0.00717, Avg fpr: 0.02641, total FA: 206

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.83572 | acc=0.3202 | tpr=0.0290 | fpr=0.0473 | 5496.8 samples/s | 21.5 steps/s
Avg test loss: 4.85878, Avg test acc: 0.31841, Avg tpr: 0.02961, Avg fpr: 0.04640, total FA: 362

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.09246 | acc=0.2902 | tpr=0.0453 | fpr=0.1779 | 5656.0 samples/s | 22.1 steps/s
Avg test loss: 5.12251, Avg test acc: 0.28868, Avg tpr: 0.04610, Avg fpr: 0.17780, total FA: 1387

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.84068 | acc=0.3123 | tpr=0.0245 | fpr=0.0627 | 5531.4 samples/s | 21.6 steps/s
Avg test loss: 4.86274, Avg test acc: 0.31088, Avg tpr: 0.02401, Avg fpr: 0.05820, total FA: 454

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.95201 | acc=0.3113 | tpr=0.0070 | fpr=0.0280 | 5760.2 samples/s | 22.5 steps/s
Avg test loss: 4.96687, Avg test acc: 0.30956, Avg tpr: 0.00746, Avg fpr: 0.02602, total FA: 203

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.97855 | acc=0.1290 | tpr=0.6637 | fpr=0.8806 | 5848.4 samples/s | 22.8 steps/s
[Step= 100] | Loss=5.92882 | acc=0.1293 | tpr=0.6205 | fpr=0.8799 | 7320.9 samples/s | 28.6 steps/s
[Step= 150] | Loss=5.93989 | acc=0.1285 | tpr=0.6282 | fpr=0.8807 | 8541.2 samples/s | 33.4 steps/s
[Step= 200] | Loss=5.92740 | acc=0.1296 | tpr=0.6230 | fpr=0.8794 | 7999.2 samples/s | 31.2 steps/s
[Step= 250] | Loss=5.93300 | acc=0.1295 | tpr=0.6271 | fpr=0.8796 | 8183.4 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.93381 | acc=0.1291 | tpr=0.6320 | fpr=0.8800 | 8285.1 samples/s | 32.4 steps/s
[Step= 350] | Loss=5.92974 | acc=0.1286 | tpr=0.6180 | fpr=0.8803 | 7326.5 samples/s | 28.6 steps/s
[Step= 400] | Loss=5.93070 | acc=0.1292 | tpr=0.6198 | fpr=0.8797 | 8170.4 samples/s | 31.9 steps/s
[Step= 450] | Loss=5.93328 | acc=0.1292 | tpr=0.6183 | fpr=0.8797 | 8372.7 samples/s | 32.7 steps/s
[Step= 500] | Loss=5.93391 | acc=0.1290 | tpr=0.6172 | fpr=0.8798 | 7502.4 samples/s | 29.3 steps/s
[Step= 550] | Loss=5.93298 | acc=0.1292 | tpr=0.6152 | fpr=0.8796 | 10790.7 samples/s | 42.2 steps/s
Avg test loss: 5.93330, Avg test acc: 0.12907, Avg tpr: 0.61529, Avg fpr: 0.87977, total FA: 122154

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.06535 | acc=0.1237 | tpr=0.3717 | fpr=0.8807 | 5687.9 samples/s | 22.2 steps/s
[Step= 100] | Loss=5.04038 | acc=0.1229 | tpr=0.3412 | fpr=0.8811 | 8215.5 samples/s | 32.1 steps/s
[Step= 150] | Loss=5.04837 | acc=0.1225 | tpr=0.3444 | fpr=0.8816 | 8272.6 samples/s | 32.3 steps/s
[Step= 200] | Loss=5.04487 | acc=0.1229 | tpr=0.3519 | fpr=0.8813 | 7291.9 samples/s | 28.5 steps/s
[Step= 250] | Loss=5.04483 | acc=0.1234 | tpr=0.3686 | fpr=0.8810 | 8618.0 samples/s | 33.7 steps/s
[Step= 300] | Loss=5.04309 | acc=0.1232 | tpr=0.3651 | fpr=0.8812 | 8818.6 samples/s | 34.4 steps/s
[Step= 350] | Loss=5.04531 | acc=0.1228 | tpr=0.3544 | fpr=0.8814 | 7391.1 samples/s | 28.9 steps/s
[Step= 400] | Loss=5.04490 | acc=0.1235 | tpr=0.3523 | fpr=0.8806 | 8277.8 samples/s | 32.3 steps/s
[Step= 450] | Loss=5.04428 | acc=0.1232 | tpr=0.3496 | fpr=0.8809 | 7825.8 samples/s | 30.6 steps/s
[Step= 500] | Loss=5.04401 | acc=0.1234 | tpr=0.3546 | fpr=0.8807 | 8001.4 samples/s | 31.3 steps/s
[Step= 550] | Loss=5.04288 | acc=0.1235 | tpr=0.3565 | fpr=0.8807 | 10494.2 samples/s | 41.0 steps/s
Avg test loss: 5.04275, Avg test acc: 0.12347, Avg tpr: 0.35658, Avg fpr: 0.88077, total FA: 122293

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.68934 | acc=0.1227 | tpr=0.6195 | fpr=0.8862 | 5404.4 samples/s | 21.1 steps/s
[Step= 100] | Loss=5.63282 | acc=0.1232 | tpr=0.5608 | fpr=0.8849 | 7711.4 samples/s | 30.1 steps/s
[Step= 150] | Loss=5.63993 | acc=0.1229 | tpr=0.5620 | fpr=0.8852 | 8347.0 samples/s | 32.6 steps/s
[Step= 200] | Loss=5.63473 | acc=0.1234 | tpr=0.5628 | fpr=0.8846 | 8542.7 samples/s | 33.4 steps/s
[Step= 250] | Loss=5.64169 | acc=0.1237 | tpr=0.5642 | fpr=0.8843 | 8181.1 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.63825 | acc=0.1231 | tpr=0.5673 | fpr=0.8850 | 8004.2 samples/s | 31.3 steps/s
[Step= 350] | Loss=5.64013 | acc=0.1231 | tpr=0.5598 | fpr=0.8848 | 8245.5 samples/s | 32.2 steps/s
[Step= 400] | Loss=5.63802 | acc=0.1238 | tpr=0.5569 | fpr=0.8841 | 7966.8 samples/s | 31.1 steps/s
[Step= 450] | Loss=5.63814 | acc=0.1240 | tpr=0.5555 | fpr=0.8839 | 6913.3 samples/s | 27.0 steps/s
[Step= 500] | Loss=5.63749 | acc=0.1239 | tpr=0.5590 | fpr=0.8839 | 8979.6 samples/s | 35.1 steps/s
[Step= 550] | Loss=5.63604 | acc=0.1239 | tpr=0.5603 | fpr=0.8840 | 10528.2 samples/s | 41.1 steps/s
Avg test loss: 5.63604, Avg test acc: 0.12379, Avg tpr: 0.56101, Avg fpr: 0.88415, total FA: 122763

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=3.04517 | acc=0.1076 | tpr=0.6239 | fpr=0.9017 | 5668.2 samples/s | 22.1 steps/s
[Step= 100] | Loss=3.04251 | acc=0.1081 | tpr=0.5821 | fpr=0.9007 | 8253.1 samples/s | 32.2 steps/s
[Step= 150] | Loss=3.04755 | acc=0.1075 | tpr=0.5576 | fpr=0.9008 | 7234.8 samples/s | 28.3 steps/s
[Step= 200] | Loss=3.04350 | acc=0.1075 | tpr=0.5399 | fpr=0.9003 | 8148.3 samples/s | 31.8 steps/s
[Step= 250] | Loss=3.04726 | acc=0.1078 | tpr=0.5415 | fpr=0.9001 | 8504.1 samples/s | 33.2 steps/s
[Step= 300] | Loss=3.04943 | acc=0.1082 | tpr=0.5455 | fpr=0.8998 | 8524.5 samples/s | 33.3 steps/s
[Step= 350] | Loss=3.05057 | acc=0.1081 | tpr=0.5391 | fpr=0.8997 | 8222.8 samples/s | 32.1 steps/s
[Step= 400] | Loss=3.04841 | acc=0.1084 | tpr=0.5410 | fpr=0.8995 | 7197.0 samples/s | 28.1 steps/s
[Step= 450] | Loss=3.04670 | acc=0.1086 | tpr=0.5389 | fpr=0.8992 | 8448.2 samples/s | 33.0 steps/s
[Step= 500] | Loss=3.04754 | acc=0.1084 | tpr=0.5330 | fpr=0.8993 | 8729.0 samples/s | 34.1 steps/s
[Step= 550] | Loss=3.04709 | acc=0.1082 | tpr=0.5308 | fpr=0.8994 | 9442.1 samples/s | 36.9 steps/s
Avg test loss: 3.04757, Avg test acc: 0.10816, Avg tpr: 0.53090, Avg fpr: 0.89952, total FA: 124897

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=3.81128 | acc=0.1607 | tpr=0.4336 | fpr=0.8442 | 5796.0 samples/s | 22.6 steps/s
[Step= 100] | Loss=3.79868 | acc=0.1611 | tpr=0.4606 | fpr=0.8445 | 8146.1 samples/s | 31.8 steps/s
[Step= 150] | Loss=3.81144 | acc=0.1590 | tpr=0.4424 | fpr=0.8462 | 7804.9 samples/s | 30.5 steps/s
[Step= 200] | Loss=3.81438 | acc=0.1581 | tpr=0.4361 | fpr=0.8470 | 7518.2 samples/s | 29.4 steps/s
[Step= 250] | Loss=3.81833 | acc=0.1584 | tpr=0.4454 | fpr=0.8468 | 8535.3 samples/s | 33.3 steps/s
[Step= 300] | Loss=3.81170 | acc=0.1590 | tpr=0.4560 | fpr=0.8465 | 8632.2 samples/s | 33.7 steps/s
[Step= 350] | Loss=3.81622 | acc=0.1584 | tpr=0.4483 | fpr=0.8469 | 7883.2 samples/s | 30.8 steps/s
[Step= 400] | Loss=3.81255 | acc=0.1591 | tpr=0.4497 | fpr=0.8462 | 8161.2 samples/s | 31.9 steps/s
[Step= 450] | Loss=3.81155 | acc=0.1596 | tpr=0.4518 | fpr=0.8457 | 7998.4 samples/s | 31.2 steps/s
[Step= 500] | Loss=3.81405 | acc=0.1592 | tpr=0.4546 | fpr=0.8461 | 8226.2 samples/s | 32.1 steps/s
[Step= 550] | Loss=3.81216 | acc=0.1594 | tpr=0.4548 | fpr=0.8460 | 9327.9 samples/s | 36.4 steps/s
Avg test loss: 3.81256, Avg test acc: 0.15924, Avg tpr: 0.45483, Avg fpr: 0.84613, total FA: 117484

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07801 | acc=0.9807 | tpr=0.8938 | fpr=0.0177 | 5767.4 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.07996 | acc=0.9797 | tpr=0.9190 | fpr=0.0192 | 7528.7 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.08165 | acc=0.9793 | tpr=0.9236 | fpr=0.0197 | 8177.3 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.08365 | acc=0.9793 | tpr=0.9322 | fpr=0.0199 | 8329.7 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.08369 | acc=0.9795 | tpr=0.9223 | fpr=0.0194 | 7900.9 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.08456 | acc=0.9793 | tpr=0.9185 | fpr=0.0196 | 8193.1 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.08523 | acc=0.9793 | tpr=0.9180 | fpr=0.0196 | 7869.7 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.08588 | acc=0.9793 | tpr=0.9179 | fpr=0.0196 | 8148.6 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.08705 | acc=0.9790 | tpr=0.9153 | fpr=0.0198 | 8468.5 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.08675 | acc=0.9791 | tpr=0.9181 | fpr=0.0198 | 7083.5 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.08595 | acc=0.9793 | tpr=0.9176 | fpr=0.0196 | 11765.6 samples/s | 46.0 steps/s
Avg test loss: 0.08581, Avg test acc: 0.97925, Avg tpr: 0.91719, Avg fpr: 0.01962, total FA: 2724

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08633 | acc=0.9814 | tpr=0.8540 | fpr=0.0163 | 5753.7 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.09049 | acc=0.9814 | tpr=0.8678 | fpr=0.0165 | 7767.5 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.09433 | acc=0.9808 | tpr=0.8761 | fpr=0.0173 | 7671.6 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.09493 | acc=0.9810 | tpr=0.8863 | fpr=0.0173 | 8300.1 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.09421 | acc=0.9812 | tpr=0.8856 | fpr=0.0171 | 7839.2 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.09586 | acc=0.9811 | tpr=0.8865 | fpr=0.0172 | 7296.7 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.09608 | acc=0.9808 | tpr=0.8848 | fpr=0.0174 | 8314.2 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.09687 | acc=0.9806 | tpr=0.8813 | fpr=0.0176 | 8405.6 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.09884 | acc=0.9804 | tpr=0.8802 | fpr=0.0178 | 7910.6 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.09839 | acc=0.9805 | tpr=0.8824 | fpr=0.0177 | 8371.5 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.09785 | acc=0.9806 | tpr=0.8826 | fpr=0.0176 | 10981.9 samples/s | 42.9 steps/s
Avg test loss: 0.09762, Avg test acc: 0.98068, Avg tpr: 0.88233, Avg fpr: 0.01754, total FA: 2435

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.08957 | acc=0.9741 | tpr=0.9204 | fpr=0.0250 | 5495.4 samples/s | 21.5 steps/s
[Step= 100] | Loss=0.09244 | acc=0.9732 | tpr=0.9360 | fpr=0.0261 | 8171.6 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.09531 | acc=0.9721 | tpr=0.9438 | fpr=0.0273 | 8650.2 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.09678 | acc=0.9719 | tpr=0.9454 | fpr=0.0276 | 8094.9 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.09812 | acc=0.9717 | tpr=0.9406 | fpr=0.0277 | 7975.7 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.09902 | acc=0.9714 | tpr=0.9389 | fpr=0.0280 | 7562.0 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.09891 | acc=0.9716 | tpr=0.9393 | fpr=0.0278 | 8523.8 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.09948 | acc=0.9715 | tpr=0.9387 | fpr=0.0279 | 7940.9 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.10032 | acc=0.9714 | tpr=0.9348 | fpr=0.0279 | 7561.6 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.10005 | acc=0.9714 | tpr=0.9357 | fpr=0.0279 | 8932.3 samples/s | 34.9 steps/s
[Step= 550] | Loss=0.09922 | acc=0.9716 | tpr=0.9359 | fpr=0.0278 | 9647.2 samples/s | 37.7 steps/s
Avg test loss: 0.09900, Avg test acc: 0.97164, Avg tpr: 0.93621, Avg fpr: 0.02771, total FA: 3848

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.08383 | acc=0.9826 | tpr=0.8850 | fpr=0.0157 | 5658.7 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.08979 | acc=0.9821 | tpr=0.9104 | fpr=0.0165 | 8187.4 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.09346 | acc=0.9816 | tpr=0.9150 | fpr=0.0172 | 7884.9 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.09503 | acc=0.9814 | tpr=0.9169 | fpr=0.0174 | 7727.8 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.09464 | acc=0.9815 | tpr=0.9127 | fpr=0.0173 | 8519.9 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.09656 | acc=0.9812 | tpr=0.9098 | fpr=0.0175 | 8405.5 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.09619 | acc=0.9810 | tpr=0.9136 | fpr=0.0178 | 7696.2 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.09708 | acc=0.9809 | tpr=0.9130 | fpr=0.0179 | 7741.4 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.09876 | acc=0.9806 | tpr=0.9138 | fpr=0.0182 | 8553.2 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.09821 | acc=0.9806 | tpr=0.9163 | fpr=0.0182 | 8156.6 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.09757 | acc=0.9807 | tpr=0.9160 | fpr=0.0182 | 9665.6 samples/s | 37.8 steps/s
Avg test loss: 0.09739, Avg test acc: 0.98067, Avg tpr: 0.91640, Avg fpr: 0.01816, total FA: 2522

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.09051 | acc=0.9780 | tpr=0.8717 | fpr=0.0201 | 5733.7 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.09099 | acc=0.9778 | tpr=0.8977 | fpr=0.0207 | 8107.9 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.09341 | acc=0.9776 | tpr=0.9135 | fpr=0.0212 | 7822.8 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.09424 | acc=0.9779 | tpr=0.9158 | fpr=0.0210 | 8300.3 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.09353 | acc=0.9780 | tpr=0.9109 | fpr=0.0208 | 8044.9 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.09483 | acc=0.9778 | tpr=0.9105 | fpr=0.0210 | 7578.4 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.09506 | acc=0.9777 | tpr=0.9111 | fpr=0.0211 | 8573.8 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.09597 | acc=0.9774 | tpr=0.9059 | fpr=0.0213 | 7443.7 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.09687 | acc=0.9772 | tpr=0.9031 | fpr=0.0214 | 8677.9 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.09609 | acc=0.9773 | tpr=0.9022 | fpr=0.0214 | 8223.0 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.09536 | acc=0.9775 | tpr=0.9009 | fpr=0.0211 | 9905.5 samples/s | 38.7 steps/s
Avg test loss: 0.09517, Avg test acc: 0.97748, Avg tpr: 0.90055, Avg fpr: 0.02112, total FA: 2933

server round 7/50

clients selected: [2 4 6 7 8]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=39.0] | Loss=0.08552 | Reg=0.00165 | acc=0.9219 | L2-Norm=12.845 | L2-Norm(final)=7.898 | 5593.9 samples/s | 87.4 steps/s
[Step=8050 Epoch=39.2] | Loss=0.12153 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.855 | L2-Norm(final)=7.960 | 5153.1 samples/s | 80.5 steps/s
[Step=8100 Epoch=39.5] | Loss=0.11798 | Reg=0.00165 | acc=0.9062 | L2-Norm=12.858 | L2-Norm(final)=8.033 | 5594.4 samples/s | 87.4 steps/s
[Step=8150 Epoch=39.7] | Loss=0.11614 | Reg=0.00165 | acc=0.8281 | L2-Norm=12.858 | L2-Norm(final)=8.109 | 5686.3 samples/s | 88.8 steps/s
[Step=8200 Epoch=40.0] | Loss=0.11369 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.859 | L2-Norm(final)=8.190 | 8680.8 samples/s | 135.6 steps/s
[Step=8250 Epoch=40.2] | Loss=0.11269 | Reg=0.00165 | acc=0.9219 | L2-Norm=12.859 | L2-Norm(final)=8.269 | 2426.6 samples/s | 37.9 steps/s
[Step=8300 Epoch=40.4] | Loss=0.11224 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.859 | L2-Norm(final)=8.347 | 5731.6 samples/s | 89.6 steps/s
[Step=8350 Epoch=40.7] | Loss=0.11091 | Reg=0.00165 | acc=0.9219 | L2-Norm=12.859 | L2-Norm(final)=8.424 | 5551.9 samples/s | 86.7 steps/s
[Step=8400 Epoch=40.9] | Loss=0.11114 | Reg=0.00165 | acc=0.9219 | L2-Norm=12.859 | L2-Norm(final)=8.498 | 7809.0 samples/s | 122.0 steps/s
[Step=8450 Epoch=41.2] | Loss=0.11111 | Reg=0.00165 | acc=0.9062 | L2-Norm=12.859 | L2-Norm(final)=8.568 | 2542.7 samples/s | 39.7 steps/s
[Step=8500 Epoch=41.4] | Loss=0.11074 | Reg=0.00165 | acc=0.8906 | L2-Norm=12.859 | L2-Norm(final)=8.636 | 5559.3 samples/s | 86.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=41.4] | Loss=0.05446 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.860 | L2-Norm(final)=9.315 | 6096.9 samples/s | 95.3 steps/s
[Step=8550 Epoch=41.7] | Loss=0.09327 | Reg=0.00172 | acc=0.9375 | L2-Norm=13.112 | L2-Norm(final)=9.304 | 4258.0 samples/s | 66.5 steps/s
[Step=8600 Epoch=41.9] | Loss=0.08709 | Reg=0.00177 | acc=0.9375 | L2-Norm=13.298 | L2-Norm(final)=9.280 | 4875.1 samples/s | 76.2 steps/s
[Step=8650 Epoch=42.1] | Loss=0.07979 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.433 | L2-Norm(final)=9.266 | 4925.6 samples/s | 77.0 steps/s
[Step=8700 Epoch=42.4] | Loss=0.07521 | Reg=0.00184 | acc=0.9219 | L2-Norm=13.543 | L2-Norm(final)=9.255 | 6812.9 samples/s | 106.5 steps/s
[Step=8750 Epoch=42.6] | Loss=0.06847 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.635 | L2-Norm(final)=9.249 | 2258.5 samples/s | 35.3 steps/s
[Step=8800 Epoch=42.9] | Loss=0.06461 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.712 | L2-Norm(final)=9.243 | 4938.4 samples/s | 77.2 steps/s
[Step=8850 Epoch=43.1] | Loss=0.06114 | Reg=0.00190 | acc=0.9531 | L2-Norm=13.782 | L2-Norm(final)=9.239 | 4754.4 samples/s | 74.3 steps/s
[Step=8900 Epoch=43.4] | Loss=0.05766 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.844 | L2-Norm(final)=9.236 | 6341.7 samples/s | 99.1 steps/s
[Step=8950 Epoch=43.6] | Loss=0.05434 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.900 | L2-Norm(final)=9.235 | 2332.0 samples/s | 36.4 steps/s
[Step=9000 Epoch=43.9] | Loss=0.05175 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.950 | L2-Norm(final)=9.232 | 4863.2 samples/s | 76.0 steps/s
[Step=9050 Epoch=44.1] | Loss=0.04957 | Reg=0.00196 | acc=0.9688 | L2-Norm=13.996 | L2-Norm(final)=9.231 | 4884.5 samples/s | 76.3 steps/s
[Step=9100 Epoch=44.3] | Loss=0.04776 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.039 | L2-Norm(final)=9.230 | 5803.0 samples/s | 90.7 steps/s
[Step=9150 Epoch=44.6] | Loss=0.04591 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.078 | L2-Norm(final)=9.228 | 2405.6 samples/s | 37.6 steps/s
[Step=9200 Epoch=44.8] | Loss=0.04396 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.114 | L2-Norm(final)=9.227 | 4825.5 samples/s | 75.4 steps/s
[Step=9250 Epoch=45.1] | Loss=0.04248 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.148 | L2-Norm(final)=9.227 | 4873.6 samples/s | 76.2 steps/s
[Step=9300 Epoch=45.3] | Loss=0.04108 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.181 | L2-Norm(final)=9.227 | 5393.0 samples/s | 84.3 steps/s
[Step=9350 Epoch=45.6] | Loss=0.04014 | Reg=0.00202 | acc=0.9688 | L2-Norm=14.212 | L2-Norm(final)=9.226 | 2513.0 samples/s | 39.3 steps/s
[Step=9400 Epoch=45.8] | Loss=0.03883 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.242 | L2-Norm(final)=9.224 | 4965.7 samples/s | 77.6 steps/s
[Step=9450 Epoch=46.0] | Loss=0.03754 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.271 | L2-Norm(final)=9.224 | 4780.7 samples/s | 74.7 steps/s
[Step=9500 Epoch=46.3] | Loss=0.03688 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.299 | L2-Norm(final)=9.224 | 4983.5 samples/s | 77.9 steps/s
[Step=9550 Epoch=46.5] | Loss=0.03622 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.327 | L2-Norm(final)=9.223 | 2580.1 samples/s | 40.3 steps/s
[Step=9600 Epoch=46.8] | Loss=0.03533 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.356 | L2-Norm(final)=9.222 | 4887.2 samples/s | 76.4 steps/s
[Step=9650 Epoch=47.0] | Loss=0.03480 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.386 | L2-Norm(final)=9.221 | 4868.4 samples/s | 76.1 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03428 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.415 | L2-Norm(final)=9.220 | 4937.0 samples/s | 77.1 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03385 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.443 | L2-Norm(final)=9.219 | 2620.1 samples/s | 40.9 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03316 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.471 | L2-Norm(final)=9.217 | 4841.4 samples/s | 75.6 steps/s
[Step=9850 Epoch=48.0] | Loss=0.03248 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.499 | L2-Norm(final)=9.216 | 4809.0 samples/s | 75.1 steps/s
[Step=9900 Epoch=48.2] | Loss=0.03192 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.527 | L2-Norm(final)=9.216 | 4888.8 samples/s | 76.4 steps/s
[Step=9950 Epoch=48.5] | Loss=0.03127 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.553 | L2-Norm(final)=9.215 | 2631.6 samples/s | 41.1 steps/s
[Step=10000 Epoch=48.7] | Loss=0.03075 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.579 | L2-Norm(final)=9.215 | 4874.1 samples/s | 76.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step10000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=29.4] | Loss=0.11624 | Reg=0.00165 | acc=0.8594 | L2-Norm=12.845 | L2-Norm(final)=6.921 | 5644.7 samples/s | 88.2 steps/s
[Step=6050 Epoch=29.7] | Loss=0.12644 | Reg=0.00165 | acc=0.8906 | L2-Norm=12.848 | L2-Norm(final)=6.904 | 4932.8 samples/s | 77.1 steps/s
[Step=6100 Epoch=29.9] | Loss=0.12363 | Reg=0.00165 | acc=0.9062 | L2-Norm=12.848 | L2-Norm(final)=6.921 | 5734.7 samples/s | 89.6 steps/s
[Step=6150 Epoch=30.2] | Loss=0.12146 | Reg=0.00165 | acc=0.9062 | L2-Norm=12.848 | L2-Norm(final)=6.963 | 5701.7 samples/s | 89.1 steps/s
[Step=6200 Epoch=30.4] | Loss=0.11931 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.849 | L2-Norm(final)=7.011 | 8614.4 samples/s | 134.6 steps/s
[Step=6250 Epoch=30.6] | Loss=0.11851 | Reg=0.00165 | acc=0.8906 | L2-Norm=12.849 | L2-Norm(final)=7.060 | 2417.0 samples/s | 37.8 steps/s
[Step=6300 Epoch=30.9] | Loss=0.11797 | Reg=0.00165 | acc=0.8750 | L2-Norm=12.849 | L2-Norm(final)=7.113 | 5603.9 samples/s | 87.6 steps/s
[Step=6350 Epoch=31.1] | Loss=0.11726 | Reg=0.00165 | acc=0.8750 | L2-Norm=12.849 | L2-Norm(final)=7.166 | 5651.7 samples/s | 88.3 steps/s
[Step=6400 Epoch=31.4] | Loss=0.11670 | Reg=0.00165 | acc=0.8906 | L2-Norm=12.849 | L2-Norm(final)=7.218 | 8277.7 samples/s | 129.3 steps/s
[Step=6450 Epoch=31.6] | Loss=0.11581 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.849 | L2-Norm(final)=7.270 | 2468.7 samples/s | 38.6 steps/s
[Step=6500 Epoch=31.9] | Loss=0.11554 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.849 | L2-Norm(final)=7.322 | 5633.1 samples/s | 88.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=31.9] | Loss=0.10797 | Reg=0.00165 | acc=0.8750 | L2-Norm=12.849 | L2-Norm(final)=7.848 | 5400.8 samples/s | 84.4 steps/s
[Step=6550 Epoch=32.1] | Loss=0.07497 | Reg=0.00170 | acc=0.9531 | L2-Norm=13.056 | L2-Norm(final)=7.864 | 4609.5 samples/s | 72.0 steps/s
[Step=6600 Epoch=32.4] | Loss=0.06959 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.234 | L2-Norm(final)=7.855 | 4854.3 samples/s | 75.8 steps/s
[Step=6650 Epoch=32.6] | Loss=0.06948 | Reg=0.00179 | acc=0.9531 | L2-Norm=13.362 | L2-Norm(final)=7.848 | 4886.2 samples/s | 76.3 steps/s
[Step=6700 Epoch=32.9] | Loss=0.06676 | Reg=0.00181 | acc=0.9531 | L2-Norm=13.468 | L2-Norm(final)=7.842 | 7011.0 samples/s | 109.5 steps/s
[Step=6750 Epoch=33.1] | Loss=0.06137 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.559 | L2-Norm(final)=7.838 | 2251.7 samples/s | 35.2 steps/s
[Step=6800 Epoch=33.3] | Loss=0.05819 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.637 | L2-Norm(final)=7.834 | 4795.1 samples/s | 74.9 steps/s
[Step=6850 Epoch=33.6] | Loss=0.05551 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.710 | L2-Norm(final)=7.831 | 4877.7 samples/s | 76.2 steps/s
[Step=6900 Epoch=33.8] | Loss=0.05262 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.777 | L2-Norm(final)=7.830 | 6615.3 samples/s | 103.4 steps/s
[Step=6950 Epoch=34.1] | Loss=0.04950 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.837 | L2-Norm(final)=7.830 | 2293.6 samples/s | 35.8 steps/s
[Step=7000 Epoch=34.3] | Loss=0.04719 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.890 | L2-Norm(final)=7.829 | 4868.4 samples/s | 76.1 steps/s
[Step=7050 Epoch=34.6] | Loss=0.04518 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.939 | L2-Norm(final)=7.829 | 4788.0 samples/s | 74.8 steps/s
[Step=7100 Epoch=34.8] | Loss=0.04352 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.986 | L2-Norm(final)=7.829 | 6319.1 samples/s | 98.7 steps/s
[Step=7150 Epoch=35.1] | Loss=0.04166 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.030 | L2-Norm(final)=7.831 | 2351.8 samples/s | 36.7 steps/s
[Step=7200 Epoch=35.3] | Loss=0.03961 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.071 | L2-Norm(final)=7.832 | 4904.2 samples/s | 76.6 steps/s
[Step=7250 Epoch=35.6] | Loss=0.03787 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.108 | L2-Norm(final)=7.834 | 4887.9 samples/s | 76.4 steps/s
[Step=7300 Epoch=35.8] | Loss=0.03713 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.142 | L2-Norm(final)=7.836 | 5903.5 samples/s | 92.2 steps/s
[Step=7350 Epoch=36.0] | Loss=0.03584 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.175 | L2-Norm(final)=7.836 | 2399.1 samples/s | 37.5 steps/s
[Step=7400 Epoch=36.3] | Loss=0.03458 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.205 | L2-Norm(final)=7.838 | 4857.4 samples/s | 75.9 steps/s
[Step=7450 Epoch=36.5] | Loss=0.03384 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.233 | L2-Norm(final)=7.839 | 4819.7 samples/s | 75.3 steps/s
[Step=7500 Epoch=36.8] | Loss=0.03314 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.262 | L2-Norm(final)=7.840 | 5664.8 samples/s | 88.5 steps/s
[Step=7550 Epoch=37.0] | Loss=0.03219 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.289 | L2-Norm(final)=7.841 | 2474.1 samples/s | 38.7 steps/s
[Step=7600 Epoch=37.3] | Loss=0.03143 | Reg=0.00205 | acc=0.9375 | L2-Norm=14.316 | L2-Norm(final)=7.842 | 4841.0 samples/s | 75.6 steps/s
[Step=7650 Epoch=37.5] | Loss=0.03082 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.342 | L2-Norm(final)=7.843 | 4885.2 samples/s | 76.3 steps/s
[Step=7700 Epoch=37.8] | Loss=0.03036 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.368 | L2-Norm(final)=7.844 | 5308.6 samples/s | 82.9 steps/s
[Step=7750 Epoch=38.0] | Loss=0.02982 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.394 | L2-Norm(final)=7.843 | 2520.3 samples/s | 39.4 steps/s
[Step=7800 Epoch=38.2] | Loss=0.02918 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.419 | L2-Norm(final)=7.844 | 4945.3 samples/s | 77.3 steps/s
[Step=7850 Epoch=38.5] | Loss=0.02861 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.445 | L2-Norm(final)=7.845 | 4827.6 samples/s | 75.4 steps/s
[Step=7900 Epoch=38.7] | Loss=0.02830 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.470 | L2-Norm(final)=7.845 | 5066.0 samples/s | 79.2 steps/s
[Step=7950 Epoch=39.0] | Loss=0.02775 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.495 | L2-Norm(final)=7.845 | 2590.8 samples/s | 40.5 steps/s
[Step=8000 Epoch=39.2] | Loss=0.02717 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.519 | L2-Norm(final)=7.846 | 4828.7 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step8000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=95.1] | Loss=0.09933 | Reg=0.00165 | acc=0.9375 | L2-Norm=12.845 | L2-Norm(final)=10.387 | 5529.4 samples/s | 86.4 steps/s
[Step=10050 Epoch=95.6] | Loss=0.05320 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.835 | L2-Norm(final)=10.334 | 5006.4 samples/s | 78.2 steps/s
[Step=10100 Epoch=96.1] | Loss=0.04226 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.833 | L2-Norm(final)=10.313 | 7638.8 samples/s | 119.4 steps/s
[Step=10150 Epoch=96.6] | Loss=0.03727 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.833 | L2-Norm(final)=10.299 | 2333.9 samples/s | 36.5 steps/s
[Step=10200 Epoch=97.0] | Loss=0.03376 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.833 | L2-Norm(final)=10.299 | 7465.1 samples/s | 116.6 steps/s
[Step=10250 Epoch=97.5] | Loss=0.03124 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.833 | L2-Norm(final)=10.314 | 2413.4 samples/s | 37.7 steps/s
[Step=10300 Epoch=98.0] | Loss=0.03021 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.832 | L2-Norm(final)=10.340 | 6598.1 samples/s | 103.1 steps/s
[Step=10350 Epoch=98.5] | Loss=0.02946 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.832 | L2-Norm(final)=10.371 | 2540.9 samples/s | 39.7 steps/s
[Step=10400 Epoch=98.9] | Loss=0.02851 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.832 | L2-Norm(final)=10.407 | 5983.5 samples/s | 93.5 steps/s
[Step=10450 Epoch=99.4] | Loss=0.02767 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.832 | L2-Norm(final)=10.448 | 2617.4 samples/s | 40.9 steps/s
[Step=10500 Epoch=99.9] | Loss=0.02710 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.832 | L2-Norm(final)=10.492 | 5491.5 samples/s | 85.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=99.9] | Loss=0.03215 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.832 | L2-Norm(final)=10.945 | 5505.8 samples/s | 86.0 steps/s
[Step=10550 Epoch=100.4] | Loss=0.02331 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.397 | L2-Norm(final)=10.939 | 4243.0 samples/s | 66.3 steps/s
[Step=10600 Epoch=100.8] | Loss=0.01559 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.760 | L2-Norm(final)=10.913 | 6732.1 samples/s | 105.2 steps/s
[Step=10650 Epoch=101.3] | Loss=0.01110 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.906 | L2-Norm(final)=10.905 | 2182.5 samples/s | 34.1 steps/s
[Step=10700 Epoch=101.8] | Loss=0.01032 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.002 | L2-Norm(final)=10.894 | 6041.7 samples/s | 94.4 steps/s
[Step=10750 Epoch=102.3] | Loss=0.00837 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.066 | L2-Norm(final)=10.886 | 2284.6 samples/s | 35.7 steps/s
[Step=10800 Epoch=102.7] | Loss=0.00703 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=10.882 | 5566.7 samples/s | 87.0 steps/s
[Step=10850 Epoch=103.2] | Loss=0.00605 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.100 | L2-Norm(final)=10.879 | 2403.9 samples/s | 37.6 steps/s
[Step=10900 Epoch=103.7] | Loss=0.00529 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.095 | L2-Norm(final)=10.877 | 4978.8 samples/s | 77.8 steps/s
[Step=10950 Epoch=104.2] | Loss=0.00471 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.081 | L2-Norm(final)=10.875 | 2463.3 samples/s | 38.5 steps/s
[Step=11000 Epoch=104.6] | Loss=0.00424 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.061 | L2-Norm(final)=10.874 | 4749.0 samples/s | 74.2 steps/s
[Step=11050 Epoch=105.1] | Loss=0.00385 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.037 | L2-Norm(final)=10.873 | 2521.4 samples/s | 39.4 steps/s
[Step=11100 Epoch=105.6] | Loss=0.00353 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.010 | L2-Norm(final)=10.873 | 4661.4 samples/s | 72.8 steps/s
[Step=11150 Epoch=106.1] | Loss=0.00326 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.982 | L2-Norm(final)=10.872 | 2550.9 samples/s | 39.9 steps/s
[Step=11200 Epoch=106.5] | Loss=0.00303 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.952 | L2-Norm(final)=10.872 | 4627.8 samples/s | 72.3 steps/s
[Step=11250 Epoch=107.0] | Loss=0.00283 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.921 | L2-Norm(final)=10.872 | 2597.6 samples/s | 40.6 steps/s
[Step=11300 Epoch=107.5] | Loss=0.00265 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.889 | L2-Norm(final)=10.871 | 4668.7 samples/s | 72.9 steps/s
[Step=11350 Epoch=108.0] | Loss=0.00249 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.857 | L2-Norm(final)=10.871 | 2580.9 samples/s | 40.3 steps/s
[Step=11400 Epoch=108.4] | Loss=0.00236 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.825 | L2-Norm(final)=10.871 | 4514.2 samples/s | 70.5 steps/s
[Step=11450 Epoch=108.9] | Loss=0.00223 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.792 | L2-Norm(final)=10.871 | 7027.3 samples/s | 109.8 steps/s
[Step=11500 Epoch=109.4] | Loss=0.00212 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.759 | L2-Norm(final)=10.871 | 2172.5 samples/s | 33.9 steps/s
[Step=11550 Epoch=109.9] | Loss=0.00202 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.726 | L2-Norm(final)=10.871 | 6278.1 samples/s | 98.1 steps/s
[Step=11600 Epoch=110.3] | Loss=0.00193 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.694 | L2-Norm(final)=10.871 | 2282.9 samples/s | 35.7 steps/s
[Step=11650 Epoch=110.8] | Loss=0.00184 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.661 | L2-Norm(final)=10.871 | 5623.4 samples/s | 87.9 steps/s
[Step=11700 Epoch=111.3] | Loss=0.00177 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.628 | L2-Norm(final)=10.871 | 2319.1 samples/s | 36.2 steps/s
[Step=11750 Epoch=111.8] | Loss=0.00170 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.595 | L2-Norm(final)=10.871 | 5282.1 samples/s | 82.5 steps/s
[Step=11800 Epoch=112.2] | Loss=0.00163 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.562 | L2-Norm(final)=10.871 | 2405.6 samples/s | 37.6 steps/s
[Step=11850 Epoch=112.7] | Loss=0.00157 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.530 | L2-Norm(final)=10.871 | 4902.3 samples/s | 76.6 steps/s
[Step=11900 Epoch=113.2] | Loss=0.00152 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.497 | L2-Norm(final)=10.871 | 2510.9 samples/s | 39.2 steps/s
[Step=11950 Epoch=113.7] | Loss=0.00146 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.465 | L2-Norm(final)=10.871 | 4677.1 samples/s | 73.1 steps/s
[Step=12000 Epoch=114.1] | Loss=0.00142 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.432 | L2-Norm(final)=10.872 | 2561.4 samples/s | 40.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step12000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch=19.1] | Loss=0.10232 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.845 | L2-Norm(final)=5.115 | 6056.7 samples/s | 94.6 steps/s
[Step=2050 Epoch=19.6] | Loss=0.06734 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.834 | L2-Norm(final)=5.308 | 4772.4 samples/s | 74.6 steps/s
[Step=2100 Epoch=20.1] | Loss=0.05853 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.832 | L2-Norm(final)=5.540 | 8503.0 samples/s | 132.9 steps/s
[Step=2150 Epoch=20.5] | Loss=0.05425 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.832 | L2-Norm(final)=5.758 | 2365.8 samples/s | 37.0 steps/s
[Step=2200 Epoch=21.0] | Loss=0.05158 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.832 | L2-Norm(final)=5.956 | 7376.1 samples/s | 115.3 steps/s
[Step=2250 Epoch=21.5] | Loss=0.04996 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.831 | L2-Norm(final)=6.141 | 2358.2 samples/s | 36.8 steps/s
[Step=2300 Epoch=22.0] | Loss=0.04825 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.831 | L2-Norm(final)=6.313 | 6949.6 samples/s | 108.6 steps/s
[Step=2350 Epoch=22.4] | Loss=0.04688 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.831 | L2-Norm(final)=6.472 | 2447.5 samples/s | 38.2 steps/s
[Step=2400 Epoch=22.9] | Loss=0.04592 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.831 | L2-Norm(final)=6.620 | 6317.6 samples/s | 98.7 steps/s
[Step=2450 Epoch=23.4] | Loss=0.04515 | Reg=0.00165 | acc=0.9062 | L2-Norm=12.831 | L2-Norm(final)=6.760 | 2554.3 samples/s | 39.9 steps/s
[Step=2500 Epoch=23.9] | Loss=0.04424 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.831 | L2-Norm(final)=6.893 | 5756.8 samples/s | 90.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.9] | Loss=0.04926 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.831 | L2-Norm(final)=8.192 | 5663.1 samples/s | 88.5 steps/s
[Step=2550 Epoch=24.4] | Loss=0.03981 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.500 | L2-Norm(final)=8.167 | 4178.0 samples/s | 65.3 steps/s
[Step=2600 Epoch=24.8] | Loss=0.02561 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.929 | L2-Norm(final)=8.124 | 6743.6 samples/s | 105.4 steps/s
[Step=2650 Epoch=25.3] | Loss=0.01716 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.096 | L2-Norm(final)=8.115 | 2199.9 samples/s | 34.4 steps/s
[Step=2700 Epoch=25.8] | Loss=0.01289 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.157 | L2-Norm(final)=8.112 | 6190.2 samples/s | 96.7 steps/s
[Step=2750 Epoch=26.3] | Loss=0.01031 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.174 | L2-Norm(final)=8.110 | 2237.0 samples/s | 35.0 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00860 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.169 | L2-Norm(final)=8.110 | 5810.7 samples/s | 90.8 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00737 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.152 | L2-Norm(final)=8.109 | 2313.2 samples/s | 36.1 steps/s
[Step=2900 Epoch=27.7] | Loss=0.00645 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.127 | L2-Norm(final)=8.109 | 5409.7 samples/s | 84.5 steps/s
[Step=2950 Epoch=28.2] | Loss=0.00573 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.097 | L2-Norm(final)=8.109 | 2409.6 samples/s | 37.7 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00516 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.065 | L2-Norm(final)=8.109 | 4954.0 samples/s | 77.4 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00469 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.031 | L2-Norm(final)=8.109 | 2490.6 samples/s | 38.9 steps/s
[Step=3100 Epoch=29.6] | Loss=0.00430 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.996 | L2-Norm(final)=8.109 | 4631.2 samples/s | 72.4 steps/s
[Step=3150 Epoch=30.1] | Loss=0.00397 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.960 | L2-Norm(final)=8.109 | 2541.3 samples/s | 39.7 steps/s
[Step=3200 Epoch=30.6] | Loss=0.00369 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.923 | L2-Norm(final)=8.109 | 4615.1 samples/s | 72.1 steps/s
[Step=3250 Epoch=31.0] | Loss=0.00344 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.886 | L2-Norm(final)=8.110 | 2605.7 samples/s | 40.7 steps/s
[Step=3300 Epoch=31.5] | Loss=0.00323 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.848 | L2-Norm(final)=8.110 | 4500.3 samples/s | 70.3 steps/s
[Step=3350 Epoch=32.0] | Loss=0.00304 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.811 | L2-Norm(final)=8.110 | 2548.7 samples/s | 39.8 steps/s
[Step=3400 Epoch=32.5] | Loss=0.00287 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.774 | L2-Norm(final)=8.110 | 4750.0 samples/s | 74.2 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00272 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.736 | L2-Norm(final)=8.110 | 2536.2 samples/s | 39.6 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00258 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.699 | L2-Norm(final)=8.111 | 4527.5 samples/s | 70.7 steps/s
[Step=3550 Epoch=33.9] | Loss=0.00246 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.661 | L2-Norm(final)=8.111 | 7473.3 samples/s | 116.8 steps/s
[Step=3600 Epoch=34.4] | Loss=0.00235 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.624 | L2-Norm(final)=8.111 | 2132.3 samples/s | 33.3 steps/s
[Step=3650 Epoch=34.9] | Loss=0.00225 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.587 | L2-Norm(final)=8.111 | 6785.4 samples/s | 106.0 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00215 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.550 | L2-Norm(final)=8.112 | 2174.4 samples/s | 34.0 steps/s
[Step=3750 Epoch=35.8] | Loss=0.00207 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.514 | L2-Norm(final)=8.112 | 6147.3 samples/s | 96.1 steps/s
[Step=3800 Epoch=36.3] | Loss=0.00199 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.477 | L2-Norm(final)=8.112 | 2264.1 samples/s | 35.4 steps/s
[Step=3850 Epoch=36.8] | Loss=0.00191 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.441 | L2-Norm(final)=8.112 | 5758.8 samples/s | 90.0 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00185 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.405 | L2-Norm(final)=8.113 | 2308.0 samples/s | 36.1 steps/s
[Step=3950 Epoch=37.7] | Loss=0.00178 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=8.113 | 5388.7 samples/s | 84.2 steps/s
[Step=4000 Epoch=38.2] | Loss=0.00172 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.332 | L2-Norm(final)=8.113 | 2377.7 samples/s | 37.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step4000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=75.4] | Loss=0.05141 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.845 | L2-Norm(final)=11.304 | 5927.1 samples/s | 92.6 steps/s
[Step=8050 Epoch=75.9] | Loss=0.02192 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.836 | L2-Norm(final)=11.366 | 4352.4 samples/s | 68.0 steps/s
[Step=8100 Epoch=76.3] | Loss=0.02232 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.834 | L2-Norm(final)=11.453 | 8254.3 samples/s | 129.0 steps/s
[Step=8150 Epoch=76.8] | Loss=0.02187 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.834 | L2-Norm(final)=11.529 | 2386.8 samples/s | 37.3 steps/s
[Step=8200 Epoch=77.3] | Loss=0.02173 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.834 | L2-Norm(final)=11.613 | 6964.6 samples/s | 108.8 steps/s
[Step=8250 Epoch=77.7] | Loss=0.02154 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.834 | L2-Norm(final)=11.699 | 2467.2 samples/s | 38.6 steps/s
[Step=8300 Epoch=78.2] | Loss=0.02138 | Reg=0.00165 | acc=0.9375 | L2-Norm=12.834 | L2-Norm(final)=11.786 | 6289.8 samples/s | 98.3 steps/s
[Step=8350 Epoch=78.7] | Loss=0.02092 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.833 | L2-Norm(final)=11.872 | 2565.5 samples/s | 40.1 steps/s
[Step=8400 Epoch=79.2] | Loss=0.02111 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.833 | L2-Norm(final)=11.959 | 5634.3 samples/s | 88.0 steps/s
[Step=8450 Epoch=79.6] | Loss=0.02092 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.833 | L2-Norm(final)=12.043 | 2696.4 samples/s | 42.1 steps/s
[Step=8500 Epoch=80.1] | Loss=0.02088 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.833 | L2-Norm(final)=12.125 | 5345.2 samples/s | 83.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=80.1] | Loss=0.00983 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.833 | L2-Norm(final)=12.949 | 5791.2 samples/s | 90.5 steps/s
[Step=8550 Epoch=80.6] | Loss=0.03193 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.472 | L2-Norm(final)=12.910 | 4153.1 samples/s | 64.9 steps/s
[Step=8600 Epoch=81.0] | Loss=0.02677 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.887 | L2-Norm(final)=12.851 | 6485.7 samples/s | 101.3 steps/s
[Step=8650 Epoch=81.5] | Loss=0.01835 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.046 | L2-Norm(final)=12.822 | 2217.0 samples/s | 34.6 steps/s
[Step=8700 Epoch=82.0] | Loss=0.01381 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.102 | L2-Norm(final)=12.812 | 5819.9 samples/s | 90.9 steps/s
[Step=8750 Epoch=82.4] | Loss=0.01116 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.117 | L2-Norm(final)=12.807 | 2304.1 samples/s | 36.0 steps/s
[Step=8800 Epoch=82.9] | Loss=0.00931 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.110 | L2-Norm(final)=12.805 | 5282.5 samples/s | 82.5 steps/s
[Step=8850 Epoch=83.4] | Loss=0.00799 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.092 | L2-Norm(final)=12.804 | 2415.2 samples/s | 37.7 steps/s
[Step=8900 Epoch=83.9] | Loss=0.00699 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.067 | L2-Norm(final)=12.804 | 4843.9 samples/s | 75.7 steps/s
[Step=8950 Epoch=84.3] | Loss=0.00622 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.037 | L2-Norm(final)=12.803 | 2520.1 samples/s | 39.4 steps/s
[Step=9000 Epoch=84.8] | Loss=0.00560 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.006 | L2-Norm(final)=12.803 | 4588.0 samples/s | 71.7 steps/s
[Step=9050 Epoch=85.3] | Loss=0.00509 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.972 | L2-Norm(final)=12.804 | 2587.0 samples/s | 40.4 steps/s
[Step=9100 Epoch=85.7] | Loss=0.00467 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.938 | L2-Norm(final)=12.804 | 4587.0 samples/s | 71.7 steps/s
[Step=9150 Epoch=86.2] | Loss=0.00431 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.903 | L2-Norm(final)=12.804 | 2575.2 samples/s | 40.2 steps/s
[Step=9200 Epoch=86.7] | Loss=0.00400 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.867 | L2-Norm(final)=12.805 | 4694.8 samples/s | 73.4 steps/s
[Step=9250 Epoch=87.2] | Loss=0.00374 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.832 | L2-Norm(final)=12.805 | 2720.6 samples/s | 42.5 steps/s
[Step=9300 Epoch=87.6] | Loss=0.00350 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.796 | L2-Norm(final)=12.805 | 4313.0 samples/s | 67.4 steps/s
[Step=9350 Epoch=88.1] | Loss=0.00330 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.761 | L2-Norm(final)=12.806 | 6617.8 samples/s | 103.4 steps/s
[Step=9400 Epoch=88.6] | Loss=0.00311 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.726 | L2-Norm(final)=12.806 | 2181.1 samples/s | 34.1 steps/s
[Step=9450 Epoch=89.0] | Loss=0.00295 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.690 | L2-Norm(final)=12.806 | 6027.2 samples/s | 94.2 steps/s
[Step=9500 Epoch=89.5] | Loss=0.00280 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.655 | L2-Norm(final)=12.807 | 2314.4 samples/s | 36.2 steps/s
[Step=9550 Epoch=90.0] | Loss=0.00267 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.621 | L2-Norm(final)=12.807 | 5376.8 samples/s | 84.0 steps/s
[Step=9600 Epoch=90.5] | Loss=0.00255 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.586 | L2-Norm(final)=12.807 | 2403.2 samples/s | 37.6 steps/s
[Step=9650 Epoch=90.9] | Loss=0.00244 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.552 | L2-Norm(final)=12.808 | 4832.9 samples/s | 75.5 steps/s
[Step=9700 Epoch=91.4] | Loss=0.00234 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.517 | L2-Norm(final)=12.808 | 2509.4 samples/s | 39.2 steps/s
[Step=9750 Epoch=91.9] | Loss=0.00224 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=12.809 | 4625.5 samples/s | 72.3 steps/s
[Step=9800 Epoch=92.3] | Loss=0.00216 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.450 | L2-Norm(final)=12.809 | 2572.1 samples/s | 40.2 steps/s
[Step=9850 Epoch=92.8] | Loss=0.00208 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.416 | L2-Norm(final)=12.809 | 4553.3 samples/s | 71.1 steps/s
[Step=9900 Epoch=93.3] | Loss=0.00200 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.383 | L2-Norm(final)=12.810 | 2564.7 samples/s | 40.1 steps/s
[Step=9950 Epoch=93.8] | Loss=0.00193 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=12.810 | 4634.5 samples/s | 72.4 steps/s
[Step=10000 Epoch=94.2] | Loss=0.00187 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.317 | L2-Norm(final)=12.810 | 2703.1 samples/s | 42.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.12948 | acc=0.9428 | tpr=0.9598 | fpr=0.0942 | 5506.7 samples/s | 21.5 steps/s
Avg test loss: 0.13310, Avg test acc: 0.94186, Avg tpr: 0.95943, Avg fpr: 0.09678, total FA: 755

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14973 | acc=0.9356 | tpr=0.9545 | fpr=0.1053 | 5469.7 samples/s | 21.4 steps/s
Avg test loss: 0.14755, Avg test acc: 0.93601, Avg tpr: 0.95349, Avg fpr: 0.10242, total FA: 799

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.13690 | acc=0.9406 | tpr=0.9633 | fpr=0.1085 | 5741.8 samples/s | 22.4 steps/s
Avg test loss: 0.13971, Avg test acc: 0.93914, Avg tpr: 0.96054, Avg fpr: 0.10793, total FA: 842

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10906 | acc=0.9289 | tpr=0.9493 | fpr=0.1155 | 5638.9 samples/s | 22.0 steps/s
Avg test loss: 0.11204, Avg test acc: 0.92736, Avg tpr: 0.94923, Avg fpr: 0.12075, total FA: 942

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.14271 | acc=0.9367 | tpr=0.9506 | fpr=0.0934 | 5458.7 samples/s | 21.3 steps/s
Avg test loss: 0.14728, Avg test acc: 0.93689, Avg tpr: 0.95197, Avg fpr: 0.09627, total FA: 751

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.10029 | acc=0.3116 | tpr=0.0082 | fpr=0.0295 | 5789.6 samples/s | 22.6 steps/s
Avg test loss: 4.11287, Avg test acc: 0.30924, Avg tpr: 0.00717, Avg fpr: 0.02641, total FA: 206

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.54550 | acc=0.3159 | tpr=0.0259 | fpr=0.0545 | 5750.9 samples/s | 22.5 steps/s
Avg test loss: 4.55892, Avg test acc: 0.31393, Avg tpr: 0.02559, Avg fpr: 0.05192, total FA: 405

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.57760 | acc=0.3153 | tpr=0.0212 | fpr=0.0461 | 5458.3 samples/s | 21.3 steps/s
Avg test loss: 4.59504, Avg test acc: 0.31341, Avg tpr: 0.02127, Avg fpr: 0.04410, total FA: 344

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.98545 | acc=0.3105 | tpr=0.0105 | fpr=0.0382 | 5680.9 samples/s | 22.2 steps/s
Avg test loss: 4.99934, Avg test acc: 0.30916, Avg tpr: 0.01113, Avg fpr: 0.03538, total FA: 276

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.95201 | acc=0.3113 | tpr=0.0070 | fpr=0.0280 | 5743.5 samples/s | 22.4 steps/s
Avg test loss: 4.96687, Avg test acc: 0.30956, Avg tpr: 0.00746, Avg fpr: 0.02602, total FA: 203

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.97855 | acc=0.1290 | tpr=0.6637 | fpr=0.8806 | 5641.2 samples/s | 22.0 steps/s
[Step= 100] | Loss=5.92882 | acc=0.1293 | tpr=0.6205 | fpr=0.8799 | 8150.0 samples/s | 31.8 steps/s
[Step= 150] | Loss=5.93989 | acc=0.1285 | tpr=0.6282 | fpr=0.8807 | 7227.7 samples/s | 28.2 steps/s
[Step= 200] | Loss=5.92740 | acc=0.1296 | tpr=0.6230 | fpr=0.8794 | 7854.9 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.93300 | acc=0.1295 | tpr=0.6271 | fpr=0.8796 | 8235.0 samples/s | 32.2 steps/s
[Step= 300] | Loss=5.93381 | acc=0.1291 | tpr=0.6320 | fpr=0.8800 | 8213.9 samples/s | 32.1 steps/s
[Step= 350] | Loss=5.92974 | acc=0.1286 | tpr=0.6180 | fpr=0.8803 | 8359.3 samples/s | 32.7 steps/s
[Step= 400] | Loss=5.93070 | acc=0.1292 | tpr=0.6198 | fpr=0.8797 | 8082.7 samples/s | 31.6 steps/s
[Step= 450] | Loss=5.93328 | acc=0.1292 | tpr=0.6183 | fpr=0.8797 | 8219.9 samples/s | 32.1 steps/s
[Step= 500] | Loss=5.93391 | acc=0.1290 | tpr=0.6172 | fpr=0.8798 | 8261.3 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.93298 | acc=0.1292 | tpr=0.6152 | fpr=0.8796 | 10071.7 samples/s | 39.3 steps/s
Avg test loss: 5.93330, Avg test acc: 0.12907, Avg tpr: 0.61529, Avg fpr: 0.87977, total FA: 122154

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.06535 | acc=0.1237 | tpr=0.3717 | fpr=0.8807 | 5731.3 samples/s | 22.4 steps/s
[Step= 100] | Loss=5.04038 | acc=0.1229 | tpr=0.3412 | fpr=0.8811 | 8053.8 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.04837 | acc=0.1225 | tpr=0.3444 | fpr=0.8816 | 7973.2 samples/s | 31.1 steps/s
[Step= 200] | Loss=5.04487 | acc=0.1229 | tpr=0.3519 | fpr=0.8813 | 7388.8 samples/s | 28.9 steps/s
[Step= 250] | Loss=5.04483 | acc=0.1234 | tpr=0.3686 | fpr=0.8810 | 8181.2 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.04309 | acc=0.1232 | tpr=0.3651 | fpr=0.8812 | 8206.9 samples/s | 32.1 steps/s
[Step= 350] | Loss=5.04531 | acc=0.1228 | tpr=0.3544 | fpr=0.8814 | 7915.7 samples/s | 30.9 steps/s
[Step= 400] | Loss=5.04490 | acc=0.1235 | tpr=0.3523 | fpr=0.8806 | 8452.2 samples/s | 33.0 steps/s
[Step= 450] | Loss=5.04428 | acc=0.1232 | tpr=0.3496 | fpr=0.8809 | 8450.7 samples/s | 33.0 steps/s
[Step= 500] | Loss=5.04401 | acc=0.1234 | tpr=0.3546 | fpr=0.8807 | 8115.1 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.04288 | acc=0.1235 | tpr=0.3565 | fpr=0.8807 | 10206.6 samples/s | 39.9 steps/s
Avg test loss: 5.04275, Avg test acc: 0.12347, Avg tpr: 0.35658, Avg fpr: 0.88077, total FA: 122293

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.95380 | acc=0.1036 | tpr=0.5265 | fpr=0.9040 | 5697.4 samples/s | 22.3 steps/s
[Step= 100] | Loss=4.93733 | acc=0.1027 | tpr=0.4733 | fpr=0.9042 | 7673.7 samples/s | 30.0 steps/s
[Step= 150] | Loss=4.93448 | acc=0.1023 | tpr=0.4755 | fpr=0.9046 | 8044.8 samples/s | 31.4 steps/s
[Step= 200] | Loss=4.92198 | acc=0.1032 | tpr=0.4798 | fpr=0.9037 | 8581.1 samples/s | 33.5 steps/s
[Step= 250] | Loss=4.92518 | acc=0.1028 | tpr=0.4812 | fpr=0.9041 | 7692.5 samples/s | 30.0 steps/s
[Step= 300] | Loss=4.92497 | acc=0.1033 | tpr=0.4895 | fpr=0.9037 | 8223.3 samples/s | 32.1 steps/s
[Step= 350] | Loss=4.92740 | acc=0.1029 | tpr=0.4759 | fpr=0.9039 | 8005.6 samples/s | 31.3 steps/s
[Step= 400] | Loss=4.92375 | acc=0.1037 | tpr=0.4852 | fpr=0.9033 | 8181.7 samples/s | 32.0 steps/s
[Step= 450] | Loss=4.92680 | acc=0.1037 | tpr=0.4810 | fpr=0.9032 | 8109.9 samples/s | 31.7 steps/s
[Step= 500] | Loss=4.92822 | acc=0.1036 | tpr=0.4824 | fpr=0.9033 | 8111.6 samples/s | 31.7 steps/s
[Step= 550] | Loss=4.92625 | acc=0.1034 | tpr=0.4779 | fpr=0.9034 | 9433.6 samples/s | 36.8 steps/s
Avg test loss: 4.92641, Avg test acc: 0.10336, Avg tpr: 0.47821, Avg fpr: 0.90346, total FA: 125443

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=3.04517 | acc=0.1076 | tpr=0.6239 | fpr=0.9017 | 5705.6 samples/s | 22.3 steps/s
[Step= 100] | Loss=3.04251 | acc=0.1081 | tpr=0.5821 | fpr=0.9007 | 7581.1 samples/s | 29.6 steps/s
[Step= 150] | Loss=3.04755 | acc=0.1075 | tpr=0.5576 | fpr=0.9008 | 8159.9 samples/s | 31.9 steps/s
[Step= 200] | Loss=3.04350 | acc=0.1075 | tpr=0.5399 | fpr=0.9003 | 7909.9 samples/s | 30.9 steps/s
[Step= 250] | Loss=3.04726 | acc=0.1078 | tpr=0.5415 | fpr=0.9001 | 8052.1 samples/s | 31.5 steps/s
[Step= 300] | Loss=3.04943 | acc=0.1082 | tpr=0.5455 | fpr=0.8998 | 8221.6 samples/s | 32.1 steps/s
[Step= 350] | Loss=3.05057 | acc=0.1081 | tpr=0.5391 | fpr=0.8997 | 8209.0 samples/s | 32.1 steps/s
[Step= 400] | Loss=3.04841 | acc=0.1084 | tpr=0.5410 | fpr=0.8995 | 7877.3 samples/s | 30.8 steps/s
[Step= 450] | Loss=3.04670 | acc=0.1086 | tpr=0.5389 | fpr=0.8992 | 8252.1 samples/s | 32.2 steps/s
[Step= 500] | Loss=3.04754 | acc=0.1084 | tpr=0.5330 | fpr=0.8993 | 7530.0 samples/s | 29.4 steps/s
[Step= 550] | Loss=3.04709 | acc=0.1082 | tpr=0.5308 | fpr=0.8994 | 11076.8 samples/s | 43.3 steps/s
Avg test loss: 3.04757, Avg test acc: 0.10816, Avg tpr: 0.53090, Avg fpr: 0.89952, total FA: 124897

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.67350 | acc=0.1494 | tpr=0.5044 | fpr=0.8570 | 5416.5 samples/s | 21.2 steps/s
[Step= 100] | Loss=4.63138 | acc=0.1494 | tpr=0.4968 | fpr=0.8571 | 8296.8 samples/s | 32.4 steps/s
[Step= 150] | Loss=4.64113 | acc=0.1472 | tpr=0.4841 | fpr=0.8590 | 7859.2 samples/s | 30.7 steps/s
[Step= 200] | Loss=4.64480 | acc=0.1468 | tpr=0.4710 | fpr=0.8591 | 8638.5 samples/s | 33.7 steps/s
[Step= 250] | Loss=4.65462 | acc=0.1468 | tpr=0.4795 | fpr=0.8593 | 8114.5 samples/s | 31.7 steps/s
[Step= 300] | Loss=4.64746 | acc=0.1471 | tpr=0.4771 | fpr=0.8589 | 8187.1 samples/s | 32.0 steps/s
[Step= 350] | Loss=4.65468 | acc=0.1465 | tpr=0.4678 | fpr=0.8593 | 8058.8 samples/s | 31.5 steps/s
[Step= 400] | Loss=4.65423 | acc=0.1471 | tpr=0.4705 | fpr=0.8588 | 7921.5 samples/s | 30.9 steps/s
[Step= 450] | Loss=4.65233 | acc=0.1476 | tpr=0.4722 | fpr=0.8583 | 7957.8 samples/s | 31.1 steps/s
[Step= 500] | Loss=4.65153 | acc=0.1477 | tpr=0.4789 | fpr=0.8583 | 8125.9 samples/s | 31.7 steps/s
[Step= 550] | Loss=4.65141 | acc=0.1477 | tpr=0.4739 | fpr=0.8583 | 9937.2 samples/s | 38.8 steps/s
Avg test loss: 4.65146, Avg test acc: 0.14760, Avg tpr: 0.47425, Avg fpr: 0.85833, total FA: 119178

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07801 | acc=0.9807 | tpr=0.8938 | fpr=0.0177 | 5870.8 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.07996 | acc=0.9797 | tpr=0.9190 | fpr=0.0192 | 7614.9 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.08165 | acc=0.9793 | tpr=0.9236 | fpr=0.0197 | 8203.8 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.08365 | acc=0.9793 | tpr=0.9322 | fpr=0.0199 | 7098.1 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.08369 | acc=0.9795 | tpr=0.9223 | fpr=0.0194 | 8252.2 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.08456 | acc=0.9793 | tpr=0.9185 | fpr=0.0196 | 8680.5 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.08523 | acc=0.9793 | tpr=0.9180 | fpr=0.0196 | 8100.8 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.08588 | acc=0.9793 | tpr=0.9179 | fpr=0.0196 | 7862.7 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.08705 | acc=0.9790 | tpr=0.9153 | fpr=0.0198 | 8073.1 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.08675 | acc=0.9791 | tpr=0.9181 | fpr=0.0198 | 7763.5 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.08595 | acc=0.9793 | tpr=0.9176 | fpr=0.0196 | 11458.1 samples/s | 44.8 steps/s
Avg test loss: 0.08581, Avg test acc: 0.97925, Avg tpr: 0.91719, Avg fpr: 0.01962, total FA: 2724

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10759 | acc=0.9797 | tpr=0.8540 | fpr=0.0181 | 5515.8 samples/s | 21.5 steps/s
[Step= 100] | Loss=0.11176 | acc=0.9793 | tpr=0.8806 | fpr=0.0189 | 8158.5 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.11305 | acc=0.9788 | tpr=0.8876 | fpr=0.0195 | 8249.9 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.11434 | acc=0.9788 | tpr=0.8885 | fpr=0.0196 | 8032.9 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.11413 | acc=0.9789 | tpr=0.8847 | fpr=0.0194 | 7946.1 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.11620 | acc=0.9786 | tpr=0.8844 | fpr=0.0197 | 9030.2 samples/s | 35.3 steps/s
[Step= 350] | Loss=0.11741 | acc=0.9783 | tpr=0.8842 | fpr=0.0200 | 8007.4 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.11823 | acc=0.9781 | tpr=0.8802 | fpr=0.0201 | 7396.0 samples/s | 28.9 steps/s
[Step= 450] | Loss=0.12057 | acc=0.9779 | tpr=0.8759 | fpr=0.0203 | 8741.2 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.11943 | acc=0.9780 | tpr=0.8775 | fpr=0.0202 | 8226.9 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.11882 | acc=0.9781 | tpr=0.8762 | fpr=0.0201 | 9590.5 samples/s | 37.5 steps/s
Avg test loss: 0.11861, Avg test acc: 0.97811, Avg tpr: 0.87599, Avg fpr: 0.02003, total FA: 2781

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12125 | acc=0.9727 | tpr=0.9204 | fpr=0.0263 | 5640.2 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.12472 | acc=0.9722 | tpr=0.9211 | fpr=0.0268 | 8115.4 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.12920 | acc=0.9713 | tpr=0.9251 | fpr=0.0278 | 8475.1 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.13049 | acc=0.9713 | tpr=0.9268 | fpr=0.0279 | 7541.1 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.12997 | acc=0.9714 | tpr=0.9205 | fpr=0.0277 | 7452.0 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.13200 | acc=0.9712 | tpr=0.9207 | fpr=0.0279 | 8461.2 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.13200 | acc=0.9712 | tpr=0.9192 | fpr=0.0279 | 8073.7 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.13310 | acc=0.9710 | tpr=0.9212 | fpr=0.0281 | 8644.0 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.13505 | acc=0.9707 | tpr=0.9192 | fpr=0.0283 | 7314.2 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.13545 | acc=0.9706 | tpr=0.9225 | fpr=0.0286 | 8314.1 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.13507 | acc=0.9707 | tpr=0.9236 | fpr=0.0284 | 11026.2 samples/s | 43.1 steps/s
Avg test loss: 0.13488, Avg test acc: 0.97073, Avg tpr: 0.92353, Avg fpr: 0.02841, total FA: 3945

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11454 | acc=0.9789 | tpr=0.9204 | fpr=0.0200 | 5525.9 samples/s | 21.6 steps/s
[Step= 100] | Loss=0.12055 | acc=0.9792 | tpr=0.9296 | fpr=0.0199 | 8180.0 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.12623 | acc=0.9784 | tpr=0.9323 | fpr=0.0208 | 8039.2 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.12767 | acc=0.9787 | tpr=0.9333 | fpr=0.0205 | 7733.0 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.12676 | acc=0.9786 | tpr=0.9231 | fpr=0.0203 | 8249.7 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.12838 | acc=0.9786 | tpr=0.9229 | fpr=0.0204 | 7985.9 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.12825 | acc=0.9785 | tpr=0.9230 | fpr=0.0205 | 8321.7 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.12925 | acc=0.9783 | tpr=0.9207 | fpr=0.0207 | 7686.7 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.13090 | acc=0.9781 | tpr=0.9182 | fpr=0.0208 | 8635.4 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.13023 | acc=0.9781 | tpr=0.9203 | fpr=0.0209 | 8413.4 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.12959 | acc=0.9782 | tpr=0.9200 | fpr=0.0208 | 9890.1 samples/s | 38.6 steps/s
Avg test loss: 0.12942, Avg test acc: 0.97816, Avg tpr: 0.91957, Avg fpr: 0.02077, total FA: 2884

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.09051 | acc=0.9780 | tpr=0.8717 | fpr=0.0201 | 5639.4 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.09099 | acc=0.9778 | tpr=0.8977 | fpr=0.0207 | 7878.4 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.09341 | acc=0.9776 | tpr=0.9135 | fpr=0.0212 | 7994.1 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.09424 | acc=0.9779 | tpr=0.9158 | fpr=0.0210 | 8780.9 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.09353 | acc=0.9780 | tpr=0.9109 | fpr=0.0208 | 8046.4 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.09483 | acc=0.9778 | tpr=0.9105 | fpr=0.0210 | 7715.2 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.09506 | acc=0.9777 | tpr=0.9111 | fpr=0.0211 | 8572.0 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.09597 | acc=0.9774 | tpr=0.9059 | fpr=0.0213 | 8139.0 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.09687 | acc=0.9772 | tpr=0.9031 | fpr=0.0214 | 7218.3 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.09609 | acc=0.9773 | tpr=0.9022 | fpr=0.0214 | 8436.3 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.09536 | acc=0.9775 | tpr=0.9009 | fpr=0.0211 | 10344.8 samples/s | 40.4 steps/s
Avg test loss: 0.09517, Avg test acc: 0.97748, Avg tpr: 0.90055, Avg fpr: 0.02112, total FA: 2933

server round 8/50

clients selected: [1 3 4 7 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=12001 Epoch=58.6] | Loss=0.16986 | Reg=0.00158 | acc=0.8594 | L2-Norm=12.561 | L2-Norm(final)=9.430 | 5561.9 samples/s | 86.9 steps/s
[Step=12050 Epoch=58.8] | Loss=0.15019 | Reg=0.00158 | acc=0.9062 | L2-Norm=12.563 | L2-Norm(final)=9.383 | 5217.7 samples/s | 81.5 steps/s
[Step=12100 Epoch=59.0] | Loss=0.13910 | Reg=0.00158 | acc=0.8906 | L2-Norm=12.563 | L2-Norm(final)=9.418 | 5655.1 samples/s | 88.4 steps/s
[Step=12150 Epoch=59.3] | Loss=0.13430 | Reg=0.00158 | acc=0.9375 | L2-Norm=12.563 | L2-Norm(final)=9.507 | 5780.7 samples/s | 90.3 steps/s
[Step=12200 Epoch=59.5] | Loss=0.12958 | Reg=0.00158 | acc=0.9219 | L2-Norm=12.563 | L2-Norm(final)=9.618 | 8385.4 samples/s | 131.0 steps/s
[Step=12250 Epoch=59.8] | Loss=0.12748 | Reg=0.00158 | acc=0.8125 | L2-Norm=12.563 | L2-Norm(final)=9.735 | 2413.6 samples/s | 37.7 steps/s
[Step=12300 Epoch=60.0] | Loss=0.12615 | Reg=0.00158 | acc=0.8750 | L2-Norm=12.563 | L2-Norm(final)=9.848 | 5721.8 samples/s | 89.4 steps/s
[Step=12350 Epoch=60.3] | Loss=0.12400 | Reg=0.00158 | acc=0.9375 | L2-Norm=12.563 | L2-Norm(final)=9.955 | 5520.3 samples/s | 86.3 steps/s
[Step=12400 Epoch=60.5] | Loss=0.12303 | Reg=0.00158 | acc=0.9062 | L2-Norm=12.563 | L2-Norm(final)=10.060 | 7900.1 samples/s | 123.4 steps/s
[Step=12450 Epoch=60.8] | Loss=0.12226 | Reg=0.00158 | acc=0.9062 | L2-Norm=12.563 | L2-Norm(final)=10.160 | 2485.6 samples/s | 38.8 steps/s
[Step=12500 Epoch=61.0] | Loss=0.12145 | Reg=0.00158 | acc=0.8750 | L2-Norm=12.563 | L2-Norm(final)=10.260 | 5528.9 samples/s | 86.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=61.0] | Loss=0.08975 | Reg=0.00158 | acc=0.9219 | L2-Norm=12.563 | L2-Norm(final)=11.246 | 5297.6 samples/s | 82.8 steps/s
[Step=12550 Epoch=61.2] | Loss=0.09793 | Reg=0.00166 | acc=0.9531 | L2-Norm=12.884 | L2-Norm(final)=11.231 | 4668.5 samples/s | 72.9 steps/s
[Step=12600 Epoch=61.5] | Loss=0.09190 | Reg=0.00172 | acc=0.9375 | L2-Norm=13.099 | L2-Norm(final)=11.201 | 4866.1 samples/s | 76.0 steps/s
[Step=12650 Epoch=61.7] | Loss=0.08258 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.240 | L2-Norm(final)=11.187 | 4832.3 samples/s | 75.5 steps/s
[Step=12700 Epoch=62.0] | Loss=0.07777 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.349 | L2-Norm(final)=11.176 | 6989.6 samples/s | 109.2 steps/s
[Step=12750 Epoch=62.2] | Loss=0.07020 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.442 | L2-Norm(final)=11.169 | 2264.3 samples/s | 35.4 steps/s
[Step=12800 Epoch=62.5] | Loss=0.06448 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.519 | L2-Norm(final)=11.166 | 4847.2 samples/s | 75.7 steps/s
[Step=12850 Epoch=62.7] | Loss=0.06058 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.587 | L2-Norm(final)=11.163 | 4915.9 samples/s | 76.8 steps/s
[Step=12900 Epoch=62.9] | Loss=0.05794 | Reg=0.00187 | acc=0.9531 | L2-Norm=13.652 | L2-Norm(final)=11.161 | 6290.5 samples/s | 98.3 steps/s
[Step=12950 Epoch=63.2] | Loss=0.05489 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.714 | L2-Norm(final)=11.157 | 2319.4 samples/s | 36.2 steps/s
[Step=13000 Epoch=63.4] | Loss=0.05162 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.772 | L2-Norm(final)=11.154 | 4886.8 samples/s | 76.4 steps/s
[Step=13050 Epoch=63.7] | Loss=0.04923 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.826 | L2-Norm(final)=11.152 | 4841.9 samples/s | 75.7 steps/s
[Step=13100 Epoch=63.9] | Loss=0.04691 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.875 | L2-Norm(final)=11.150 | 5992.7 samples/s | 93.6 steps/s
[Step=13150 Epoch=64.2] | Loss=0.04489 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.919 | L2-Norm(final)=11.148 | 2388.5 samples/s | 37.3 steps/s
[Step=13200 Epoch=64.4] | Loss=0.04283 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.960 | L2-Norm(final)=11.147 | 4891.7 samples/s | 76.4 steps/s
[Step=13250 Epoch=64.7] | Loss=0.04171 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.997 | L2-Norm(final)=11.146 | 4804.3 samples/s | 75.1 steps/s
[Step=13300 Epoch=64.9] | Loss=0.04039 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.032 | L2-Norm(final)=11.145 | 5649.1 samples/s | 88.3 steps/s
[Step=13350 Epoch=65.1] | Loss=0.03900 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.067 | L2-Norm(final)=11.143 | 2457.6 samples/s | 38.4 steps/s
[Step=13400 Epoch=65.4] | Loss=0.03785 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.099 | L2-Norm(final)=11.142 | 4878.7 samples/s | 76.2 steps/s
[Step=13450 Epoch=65.6] | Loss=0.03671 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.130 | L2-Norm(final)=11.141 | 4942.7 samples/s | 77.2 steps/s
[Step=13500 Epoch=65.9] | Loss=0.03545 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.159 | L2-Norm(final)=11.140 | 5187.1 samples/s | 81.0 steps/s
[Step=13550 Epoch=66.1] | Loss=0.03471 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.187 | L2-Norm(final)=11.140 | 2532.9 samples/s | 39.6 steps/s
[Step=13600 Epoch=66.4] | Loss=0.03396 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.215 | L2-Norm(final)=11.138 | 4797.6 samples/s | 75.0 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03337 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.243 | L2-Norm(final)=11.138 | 4895.8 samples/s | 76.5 steps/s
[Step=13700 Epoch=66.8] | Loss=0.03270 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.272 | L2-Norm(final)=11.136 | 4939.6 samples/s | 77.2 steps/s
[Step=13750 Epoch=67.1] | Loss=0.03229 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.301 | L2-Norm(final)=11.135 | 2614.9 samples/s | 40.9 steps/s
[Step=13800 Epoch=67.3] | Loss=0.03148 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.330 | L2-Norm(final)=11.134 | 4800.4 samples/s | 75.0 steps/s
[Step=13850 Epoch=67.6] | Loss=0.03078 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.357 | L2-Norm(final)=11.134 | 4916.1 samples/s | 76.8 steps/s
[Step=13900 Epoch=67.8] | Loss=0.03004 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.384 | L2-Norm(final)=11.133 | 4849.1 samples/s | 75.8 steps/s
[Step=13950 Epoch=68.1] | Loss=0.02953 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.410 | L2-Norm(final)=11.133 | 2695.6 samples/s | 42.1 steps/s
[Step=14000 Epoch=68.3] | Loss=0.02903 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.436 | L2-Norm(final)=11.133 | 4745.8 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step14000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.31578 | Reg=0.00158 | acc=0.7031 | L2-Norm=12.561 | L2-Norm(final)=6.590 | 5691.5 samples/s | 88.9 steps/s
[Step=4050 Epoch=19.8] | Loss=0.22820 | Reg=0.00158 | acc=0.7812 | L2-Norm=12.582 | L2-Norm(final)=6.434 | 4971.9 samples/s | 77.7 steps/s
[Step=4100 Epoch=20.0] | Loss=0.19805 | Reg=0.00158 | acc=0.8594 | L2-Norm=12.585 | L2-Norm(final)=6.361 | 5664.8 samples/s | 88.5 steps/s
[Step=4150 Epoch=20.2] | Loss=0.17898 | Reg=0.00158 | acc=0.9531 | L2-Norm=12.586 | L2-Norm(final)=6.399 | 5576.1 samples/s | 87.1 steps/s
[Step=4200 Epoch=20.5] | Loss=0.16885 | Reg=0.00158 | acc=0.9062 | L2-Norm=12.587 | L2-Norm(final)=6.491 | 8816.8 samples/s | 137.8 steps/s
[Step=4250 Epoch=20.7] | Loss=0.16022 | Reg=0.00158 | acc=0.9375 | L2-Norm=12.587 | L2-Norm(final)=6.609 | 2431.8 samples/s | 38.0 steps/s
[Step=4300 Epoch=21.0] | Loss=0.15506 | Reg=0.00158 | acc=0.9531 | L2-Norm=12.587 | L2-Norm(final)=6.735 | 5612.6 samples/s | 87.7 steps/s
[Step=4350 Epoch=21.2] | Loss=0.15162 | Reg=0.00158 | acc=0.8594 | L2-Norm=12.588 | L2-Norm(final)=6.864 | 5633.2 samples/s | 88.0 steps/s
[Step=4400 Epoch=21.5] | Loss=0.14833 | Reg=0.00158 | acc=0.8906 | L2-Norm=12.588 | L2-Norm(final)=6.991 | 7772.1 samples/s | 121.4 steps/s
[Step=4450 Epoch=21.7] | Loss=0.14526 | Reg=0.00158 | acc=0.9375 | L2-Norm=12.588 | L2-Norm(final)=7.115 | 2497.7 samples/s | 39.0 steps/s
[Step=4500 Epoch=21.9] | Loss=0.14273 | Reg=0.00158 | acc=0.8750 | L2-Norm=12.588 | L2-Norm(final)=7.237 | 5691.5 samples/s | 88.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=21.9] | Loss=0.11121 | Reg=0.00158 | acc=0.9219 | L2-Norm=12.589 | L2-Norm(final)=8.448 | 5753.2 samples/s | 89.9 steps/s
[Step=4550 Epoch=22.2] | Loss=0.08414 | Reg=0.00166 | acc=0.8906 | L2-Norm=12.876 | L2-Norm(final)=8.479 | 4433.2 samples/s | 69.3 steps/s
[Step=4600 Epoch=22.4] | Loss=0.07640 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.072 | L2-Norm(final)=8.465 | 4908.6 samples/s | 76.7 steps/s
[Step=4650 Epoch=22.7] | Loss=0.07239 | Reg=0.00174 | acc=0.9531 | L2-Norm=13.200 | L2-Norm(final)=8.455 | 4844.5 samples/s | 75.7 steps/s
[Step=4700 Epoch=22.9] | Loss=0.06740 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.298 | L2-Norm(final)=8.445 | 6906.2 samples/s | 107.9 steps/s
[Step=4750 Epoch=23.2] | Loss=0.06328 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.391 | L2-Norm(final)=8.436 | 2270.9 samples/s | 35.5 steps/s
[Step=4800 Epoch=23.4] | Loss=0.05940 | Reg=0.00182 | acc=0.9375 | L2-Norm=13.474 | L2-Norm(final)=8.431 | 4845.4 samples/s | 75.7 steps/s
[Step=4850 Epoch=23.7] | Loss=0.05674 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.551 | L2-Norm(final)=8.427 | 4916.8 samples/s | 76.8 steps/s
[Step=4900 Epoch=23.9] | Loss=0.05507 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.623 | L2-Norm(final)=8.422 | 6282.5 samples/s | 98.2 steps/s
[Step=4950 Epoch=24.1] | Loss=0.05140 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.688 | L2-Norm(final)=8.420 | 2350.7 samples/s | 36.7 steps/s
[Step=5000 Epoch=24.4] | Loss=0.04863 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.744 | L2-Norm(final)=8.419 | 4865.3 samples/s | 76.0 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04615 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.793 | L2-Norm(final)=8.419 | 4889.0 samples/s | 76.4 steps/s
[Step=5100 Epoch=24.9] | Loss=0.04452 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.838 | L2-Norm(final)=8.418 | 5808.2 samples/s | 90.8 steps/s
[Step=5150 Epoch=25.1] | Loss=0.04293 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.881 | L2-Norm(final)=8.417 | 2415.1 samples/s | 37.7 steps/s
[Step=5200 Epoch=25.4] | Loss=0.04127 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.921 | L2-Norm(final)=8.416 | 4880.2 samples/s | 76.3 steps/s
[Step=5250 Epoch=25.6] | Loss=0.03984 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.959 | L2-Norm(final)=8.416 | 4829.9 samples/s | 75.5 steps/s
[Step=5300 Epoch=25.8] | Loss=0.03855 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.995 | L2-Norm(final)=8.416 | 5409.8 samples/s | 84.5 steps/s
[Step=5350 Epoch=26.1] | Loss=0.03748 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.030 | L2-Norm(final)=8.416 | 2525.1 samples/s | 39.5 steps/s
[Step=5400 Epoch=26.3] | Loss=0.03654 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.064 | L2-Norm(final)=8.415 | 4859.1 samples/s | 75.9 steps/s
[Step=5450 Epoch=26.6] | Loss=0.03551 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.097 | L2-Norm(final)=8.415 | 4836.0 samples/s | 75.6 steps/s
[Step=5500 Epoch=26.8] | Loss=0.03464 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.130 | L2-Norm(final)=8.415 | 5005.6 samples/s | 78.2 steps/s
[Step=5550 Epoch=27.1] | Loss=0.03399 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.162 | L2-Norm(final)=8.415 | 2612.9 samples/s | 40.8 steps/s
[Step=5600 Epoch=27.3] | Loss=0.03303 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.193 | L2-Norm(final)=8.415 | 4831.7 samples/s | 75.5 steps/s
[Step=5650 Epoch=27.6] | Loss=0.03236 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.223 | L2-Norm(final)=8.415 | 4910.9 samples/s | 76.7 steps/s
[Step=5700 Epoch=27.8] | Loss=0.03168 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.254 | L2-Norm(final)=8.415 | 4805.9 samples/s | 75.1 steps/s
[Step=5750 Epoch=28.0] | Loss=0.03108 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.284 | L2-Norm(final)=8.414 | 2685.0 samples/s | 42.0 steps/s
[Step=5800 Epoch=28.3] | Loss=0.03043 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.314 | L2-Norm(final)=8.414 | 4790.2 samples/s | 74.8 steps/s
[Step=5850 Epoch=28.5] | Loss=0.02968 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.342 | L2-Norm(final)=8.414 | 4907.8 samples/s | 76.7 steps/s
[Step=5900 Epoch=28.8] | Loss=0.02935 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.369 | L2-Norm(final)=8.414 | 4806.8 samples/s | 75.1 steps/s
[Step=5950 Epoch=29.0] | Loss=0.02881 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.396 | L2-Norm(final)=8.413 | 2638.2 samples/s | 41.2 steps/s
[Step=6000 Epoch=29.3] | Loss=0.02828 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.422 | L2-Norm(final)=8.413 | 4960.3 samples/s | 77.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step6000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=39.2] | Loss=0.13895 | Reg=0.00158 | acc=0.8438 | L2-Norm=12.561 | L2-Norm(final)=7.867 | 5695.6 samples/s | 89.0 steps/s
[Step=8050 Epoch=39.5] | Loss=0.13941 | Reg=0.00158 | acc=0.9375 | L2-Norm=12.561 | L2-Norm(final)=7.909 | 4984.9 samples/s | 77.9 steps/s
[Step=8100 Epoch=39.7] | Loss=0.13246 | Reg=0.00158 | acc=0.9219 | L2-Norm=12.561 | L2-Norm(final)=8.010 | 5608.0 samples/s | 87.6 steps/s
[Step=8150 Epoch=40.0] | Loss=0.12904 | Reg=0.00158 | acc=0.9531 | L2-Norm=12.561 | L2-Norm(final)=8.138 | 5625.2 samples/s | 87.9 steps/s
[Step=8200 Epoch=40.2] | Loss=0.12530 | Reg=0.00158 | acc=0.8906 | L2-Norm=12.561 | L2-Norm(final)=8.275 | 9034.7 samples/s | 141.2 steps/s
[Step=8250 Epoch=40.5] | Loss=0.12341 | Reg=0.00158 | acc=0.9375 | L2-Norm=12.561 | L2-Norm(final)=8.413 | 2419.3 samples/s | 37.8 steps/s
[Step=8300 Epoch=40.7] | Loss=0.12188 | Reg=0.00158 | acc=0.9375 | L2-Norm=12.561 | L2-Norm(final)=8.548 | 5608.2 samples/s | 87.6 steps/s
[Step=8350 Epoch=40.9] | Loss=0.12053 | Reg=0.00158 | acc=0.9219 | L2-Norm=12.561 | L2-Norm(final)=8.674 | 5653.1 samples/s | 88.3 steps/s
[Step=8400 Epoch=41.2] | Loss=0.12041 | Reg=0.00158 | acc=0.9531 | L2-Norm=12.561 | L2-Norm(final)=8.794 | 8323.2 samples/s | 130.0 steps/s
[Step=8450 Epoch=41.4] | Loss=0.11953 | Reg=0.00158 | acc=0.8906 | L2-Norm=12.561 | L2-Norm(final)=8.908 | 2456.7 samples/s | 38.4 steps/s
[Step=8500 Epoch=41.7] | Loss=0.11923 | Reg=0.00158 | acc=0.9062 | L2-Norm=12.561 | L2-Norm(final)=9.017 | 5627.2 samples/s | 87.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=41.7] | Loss=0.09754 | Reg=0.00158 | acc=0.8906 | L2-Norm=12.561 | L2-Norm(final)=10.074 | 6145.5 samples/s | 96.0 steps/s
[Step=8550 Epoch=41.9] | Loss=0.08718 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.849 | L2-Norm(final)=10.073 | 4382.2 samples/s | 68.5 steps/s
[Step=8600 Epoch=42.2] | Loss=0.08044 | Reg=0.00171 | acc=0.9531 | L2-Norm=13.071 | L2-Norm(final)=10.049 | 4883.0 samples/s | 76.3 steps/s
[Step=8650 Epoch=42.4] | Loss=0.07572 | Reg=0.00175 | acc=0.9375 | L2-Norm=13.222 | L2-Norm(final)=10.030 | 4814.4 samples/s | 75.2 steps/s
[Step=8700 Epoch=42.7] | Loss=0.07106 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.332 | L2-Norm(final)=10.016 | 7160.3 samples/s | 111.9 steps/s
[Step=8750 Epoch=42.9] | Loss=0.06434 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.420 | L2-Norm(final)=10.009 | 2260.1 samples/s | 35.3 steps/s
[Step=8800 Epoch=43.2] | Loss=0.05945 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.496 | L2-Norm(final)=10.003 | 4831.4 samples/s | 75.5 steps/s
[Step=8850 Epoch=43.4] | Loss=0.05620 | Reg=0.00184 | acc=0.9375 | L2-Norm=13.561 | L2-Norm(final)=9.999 | 4845.1 samples/s | 75.7 steps/s
[Step=8900 Epoch=43.6] | Loss=0.05373 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.621 | L2-Norm(final)=9.995 | 6684.7 samples/s | 104.4 steps/s
[Step=8950 Epoch=43.9] | Loss=0.05060 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.677 | L2-Norm(final)=9.991 | 2288.0 samples/s | 35.8 steps/s
[Step=9000 Epoch=44.1] | Loss=0.04829 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.729 | L2-Norm(final)=9.989 | 4843.2 samples/s | 75.7 steps/s
[Step=9050 Epoch=44.4] | Loss=0.04633 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.779 | L2-Norm(final)=9.987 | 4893.4 samples/s | 76.5 steps/s
[Step=9100 Epoch=44.6] | Loss=0.04404 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.828 | L2-Norm(final)=9.986 | 6203.9 samples/s | 96.9 steps/s
[Step=9150 Epoch=44.9] | Loss=0.04245 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.875 | L2-Norm(final)=9.985 | 2343.1 samples/s | 36.6 steps/s
[Step=9200 Epoch=45.1] | Loss=0.04094 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.919 | L2-Norm(final)=9.984 | 4824.0 samples/s | 75.4 steps/s
[Step=9250 Epoch=45.4] | Loss=0.03943 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.960 | L2-Norm(final)=9.982 | 4850.8 samples/s | 75.8 steps/s
[Step=9300 Epoch=45.6] | Loss=0.03811 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.998 | L2-Norm(final)=9.981 | 5946.5 samples/s | 92.9 steps/s
[Step=9350 Epoch=45.9] | Loss=0.03679 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.034 | L2-Norm(final)=9.981 | 2378.2 samples/s | 37.2 steps/s
[Step=9400 Epoch=46.1] | Loss=0.03544 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.068 | L2-Norm(final)=9.980 | 4909.2 samples/s | 76.7 steps/s
[Step=9450 Epoch=46.3] | Loss=0.03449 | Reg=0.00199 | acc=0.9219 | L2-Norm=14.100 | L2-Norm(final)=9.980 | 4876.4 samples/s | 76.2 steps/s
[Step=9500 Epoch=46.6] | Loss=0.03388 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.132 | L2-Norm(final)=9.979 | 5519.2 samples/s | 86.2 steps/s
[Step=9550 Epoch=46.8] | Loss=0.03297 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.163 | L2-Norm(final)=9.979 | 2447.1 samples/s | 38.2 steps/s
[Step=9600 Epoch=47.1] | Loss=0.03200 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.193 | L2-Norm(final)=9.978 | 4779.3 samples/s | 74.7 steps/s
[Step=9650 Epoch=47.3] | Loss=0.03106 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.220 | L2-Norm(final)=9.978 | 4917.0 samples/s | 76.8 steps/s
[Step=9700 Epoch=47.6] | Loss=0.03067 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.248 | L2-Norm(final)=9.978 | 5317.0 samples/s | 83.1 steps/s
[Step=9750 Epoch=47.8] | Loss=0.03012 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.276 | L2-Norm(final)=9.978 | 2554.8 samples/s | 39.9 steps/s
[Step=9800 Epoch=48.1] | Loss=0.02937 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.303 | L2-Norm(final)=9.978 | 4803.8 samples/s | 75.1 steps/s
[Step=9850 Epoch=48.3] | Loss=0.02879 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.331 | L2-Norm(final)=9.978 | 4878.6 samples/s | 76.2 steps/s
[Step=9900 Epoch=48.5] | Loss=0.02843 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.359 | L2-Norm(final)=9.977 | 5055.7 samples/s | 79.0 steps/s
[Step=9950 Epoch=48.8] | Loss=0.02794 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.387 | L2-Norm(final)=9.977 | 2562.4 samples/s | 40.0 steps/s
[Step=10000 Epoch=49.0] | Loss=0.02745 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.414 | L2-Norm(final)=9.977 | 4844.2 samples/s | 75.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step10000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=38.2] | Loss=0.01503 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.561 | L2-Norm(final)=8.122 | 5500.1 samples/s | 85.9 steps/s
[Step=4050 Epoch=38.7] | Loss=0.02962 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=8.247 | 4751.8 samples/s | 74.2 steps/s
[Step=4100 Epoch=39.2] | Loss=0.02798 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.550 | L2-Norm(final)=8.404 | 8024.9 samples/s | 125.4 steps/s
[Step=4150 Epoch=39.6] | Loss=0.02702 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.550 | L2-Norm(final)=8.566 | 2327.1 samples/s | 36.4 steps/s
[Step=4200 Epoch=40.1] | Loss=0.02567 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=8.724 | 7520.8 samples/s | 117.5 steps/s
[Step=4250 Epoch=40.6] | Loss=0.02473 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.549 | L2-Norm(final)=8.874 | 2402.9 samples/s | 37.5 steps/s
[Step=4300 Epoch=41.1] | Loss=0.02404 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.549 | L2-Norm(final)=9.019 | 6951.3 samples/s | 108.6 steps/s
[Step=4350 Epoch=41.5] | Loss=0.02325 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=9.159 | 2491.9 samples/s | 38.9 steps/s
[Step=4400 Epoch=42.0] | Loss=0.02299 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.549 | L2-Norm(final)=9.293 | 6319.1 samples/s | 98.7 steps/s
[Step=4450 Epoch=42.5] | Loss=0.02240 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=9.421 | 2638.6 samples/s | 41.2 steps/s
[Step=4500 Epoch=43.0] | Loss=0.02222 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.549 | L2-Norm(final)=9.544 | 5593.6 samples/s | 87.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=43.0] | Loss=0.01018 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=10.754 | 5395.7 samples/s | 84.3 steps/s
[Step=4550 Epoch=43.4] | Loss=0.02039 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.968 | L2-Norm(final)=10.764 | 4345.6 samples/s | 67.9 steps/s
[Step=4600 Epoch=43.9] | Loss=0.01573 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.361 | L2-Norm(final)=10.729 | 6748.9 samples/s | 105.5 steps/s
[Step=4650 Epoch=44.4] | Loss=0.01100 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.551 | L2-Norm(final)=10.717 | 2210.0 samples/s | 34.5 steps/s
[Step=4700 Epoch=44.9] | Loss=0.00836 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.634 | L2-Norm(final)=10.714 | 6110.0 samples/s | 95.5 steps/s
[Step=4750 Epoch=45.4] | Loss=0.00669 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.664 | L2-Norm(final)=10.714 | 2233.1 samples/s | 34.9 steps/s
[Step=4800 Epoch=45.8] | Loss=0.00558 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.666 | L2-Norm(final)=10.714 | 5777.0 samples/s | 90.3 steps/s
[Step=4850 Epoch=46.3] | Loss=0.00479 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.654 | L2-Norm(final)=10.715 | 2304.7 samples/s | 36.0 steps/s
[Step=4900 Epoch=46.8] | Loss=0.00419 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.633 | L2-Norm(final)=10.715 | 5399.2 samples/s | 84.4 steps/s
[Step=4950 Epoch=47.3] | Loss=0.00373 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.606 | L2-Norm(final)=10.716 | 2381.2 samples/s | 37.2 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00336 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.576 | L2-Norm(final)=10.717 | 5016.9 samples/s | 78.4 steps/s
[Step=5050 Epoch=48.2] | Loss=0.00305 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.543 | L2-Norm(final)=10.717 | 2468.2 samples/s | 38.6 steps/s
[Step=5100 Epoch=48.7] | Loss=0.00280 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.509 | L2-Norm(final)=10.718 | 4689.6 samples/s | 73.3 steps/s
[Step=5150 Epoch=49.2] | Loss=0.00258 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.474 | L2-Norm(final)=10.719 | 2525.3 samples/s | 39.5 steps/s
[Step=5200 Epoch=49.7] | Loss=0.00240 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=10.719 | 4625.7 samples/s | 72.3 steps/s
[Step=5250 Epoch=50.1] | Loss=0.00224 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=10.720 | 2574.3 samples/s | 40.2 steps/s
[Step=5300 Epoch=50.6] | Loss=0.00210 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=10.720 | 4695.7 samples/s | 73.4 steps/s
[Step=5350 Epoch=51.1] | Loss=0.00198 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.328 | L2-Norm(final)=10.721 | 2607.8 samples/s | 40.7 steps/s
[Step=5400 Epoch=51.6] | Loss=0.00187 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.291 | L2-Norm(final)=10.721 | 4467.6 samples/s | 69.8 steps/s
[Step=5450 Epoch=52.0] | Loss=0.00177 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.254 | L2-Norm(final)=10.722 | 2590.2 samples/s | 40.5 steps/s
[Step=5500 Epoch=52.5] | Loss=0.00168 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.218 | L2-Norm(final)=10.722 | 4630.0 samples/s | 72.3 steps/s
[Step=5550 Epoch=53.0] | Loss=0.00160 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.181 | L2-Norm(final)=10.723 | 7434.2 samples/s | 116.2 steps/s
[Step=5600 Epoch=53.5] | Loss=0.00153 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.145 | L2-Norm(final)=10.723 | 2128.8 samples/s | 33.3 steps/s
[Step=5650 Epoch=54.0] | Loss=0.00146 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.108 | L2-Norm(final)=10.724 | 6686.2 samples/s | 104.5 steps/s
[Step=5700 Epoch=54.4] | Loss=0.00140 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.072 | L2-Norm(final)=10.724 | 2174.8 samples/s | 34.0 steps/s
[Step=5750 Epoch=54.9] | Loss=0.00134 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.037 | L2-Norm(final)=10.725 | 6255.2 samples/s | 97.7 steps/s
[Step=5800 Epoch=55.4] | Loss=0.00129 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.001 | L2-Norm(final)=10.725 | 2244.3 samples/s | 35.1 steps/s
[Step=5850 Epoch=55.9] | Loss=0.00125 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.966 | L2-Norm(final)=10.726 | 5787.8 samples/s | 90.4 steps/s
[Step=5900 Epoch=56.3] | Loss=0.00120 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=10.726 | 2300.4 samples/s | 35.9 steps/s
[Step=5950 Epoch=56.8] | Loss=0.00116 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.896 | L2-Norm(final)=10.726 | 5375.9 samples/s | 84.0 steps/s
[Step=6000 Epoch=57.3] | Loss=0.00112 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.861 | L2-Norm(final)=10.727 | 2396.5 samples/s | 37.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step6000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.05479 | Reg=0.00158 | acc=0.9375 | L2-Norm=12.561 | L2-Norm(final)=8.609 | 5321.9 samples/s | 83.2 steps/s
[Step=4050 Epoch=38.6] | Loss=0.06397 | Reg=0.00158 | acc=0.9688 | L2-Norm=12.552 | L2-Norm(final)=8.550 | 4896.1 samples/s | 76.5 steps/s
[Step=4100 Epoch=39.1] | Loss=0.05400 | Reg=0.00158 | acc=0.9531 | L2-Norm=12.550 | L2-Norm(final)=8.542 | 8560.0 samples/s | 133.8 steps/s
[Step=4150 Epoch=39.6] | Loss=0.04801 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=8.575 | 2376.1 samples/s | 37.1 steps/s
[Step=4200 Epoch=40.0] | Loss=0.04664 | Reg=0.00157 | acc=0.9531 | L2-Norm=12.550 | L2-Norm(final)=8.625 | 7148.9 samples/s | 111.7 steps/s
[Step=4250 Epoch=40.5] | Loss=0.04460 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.550 | L2-Norm(final)=8.692 | 2418.4 samples/s | 37.8 steps/s
[Step=4300 Epoch=41.0] | Loss=0.04306 | Reg=0.00157 | acc=0.9531 | L2-Norm=12.550 | L2-Norm(final)=8.769 | 6844.3 samples/s | 106.9 steps/s
[Step=4350 Epoch=41.5] | Loss=0.04193 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.550 | L2-Norm(final)=8.850 | 2487.3 samples/s | 38.9 steps/s
[Step=4400 Epoch=41.9] | Loss=0.04105 | Reg=0.00157 | acc=0.9375 | L2-Norm=12.550 | L2-Norm(final)=8.935 | 6304.8 samples/s | 98.5 steps/s
[Step=4450 Epoch=42.4] | Loss=0.04002 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.549 | L2-Norm(final)=9.022 | 2565.7 samples/s | 40.1 steps/s
[Step=4500 Epoch=42.9] | Loss=0.03971 | Reg=0.00157 | acc=0.9531 | L2-Norm=12.549 | L2-Norm(final)=9.106 | 5850.4 samples/s | 91.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.9] | Loss=0.04853 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.549 | L2-Norm(final)=9.937 | 5867.4 samples/s | 91.7 steps/s
[Step=4550 Epoch=43.4] | Loss=0.02532 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.099 | L2-Norm(final)=9.944 | 4093.6 samples/s | 64.0 steps/s
[Step=4600 Epoch=43.8] | Loss=0.02028 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.513 | L2-Norm(final)=9.908 | 6749.6 samples/s | 105.5 steps/s
[Step=4650 Epoch=44.3] | Loss=0.01426 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=9.896 | 2159.4 samples/s | 33.7 steps/s
[Step=4700 Epoch=44.8] | Loss=0.01121 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.795 | L2-Norm(final)=9.892 | 6210.0 samples/s | 97.0 steps/s
[Step=4750 Epoch=45.3] | Loss=0.00915 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.840 | L2-Norm(final)=9.891 | 2277.4 samples/s | 35.6 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00764 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.859 | L2-Norm(final)=9.890 | 5692.6 samples/s | 88.9 steps/s
[Step=4850 Epoch=46.2] | Loss=0.00655 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.862 | L2-Norm(final)=9.891 | 2324.0 samples/s | 36.3 steps/s
[Step=4900 Epoch=46.7] | Loss=0.00573 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.855 | L2-Norm(final)=9.892 | 5390.4 samples/s | 84.2 steps/s
[Step=4950 Epoch=47.2] | Loss=0.00510 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.841 | L2-Norm(final)=9.892 | 2392.8 samples/s | 37.4 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00459 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.822 | L2-Norm(final)=9.893 | 4979.9 samples/s | 77.8 steps/s
[Step=5050 Epoch=48.1] | Loss=0.00418 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.801 | L2-Norm(final)=9.894 | 2477.2 samples/s | 38.7 steps/s
[Step=5100 Epoch=48.6] | Loss=0.00383 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.777 | L2-Norm(final)=9.895 | 4685.2 samples/s | 73.2 steps/s
[Step=5150 Epoch=49.1] | Loss=0.00354 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.752 | L2-Norm(final)=9.896 | 2537.1 samples/s | 39.6 steps/s
[Step=5200 Epoch=49.6] | Loss=0.00328 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.726 | L2-Norm(final)=9.896 | 4645.6 samples/s | 72.6 steps/s
[Step=5250 Epoch=50.0] | Loss=0.00307 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.699 | L2-Norm(final)=9.897 | 2551.2 samples/s | 39.9 steps/s
[Step=5300 Epoch=50.5] | Loss=0.00288 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.671 | L2-Norm(final)=9.898 | 4680.4 samples/s | 73.1 steps/s
[Step=5350 Epoch=51.0] | Loss=0.00271 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.643 | L2-Norm(final)=9.899 | 2536.9 samples/s | 39.6 steps/s
[Step=5400 Epoch=51.5] | Loss=0.00256 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.614 | L2-Norm(final)=9.900 | 4671.0 samples/s | 73.0 steps/s
[Step=5450 Epoch=51.9] | Loss=0.00242 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.585 | L2-Norm(final)=9.900 | 2589.3 samples/s | 40.5 steps/s
[Step=5500 Epoch=52.4] | Loss=0.00230 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.556 | L2-Norm(final)=9.901 | 4589.7 samples/s | 71.7 steps/s
[Step=5550 Epoch=52.9] | Loss=0.00219 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.527 | L2-Norm(final)=9.902 | 7287.5 samples/s | 113.9 steps/s
[Step=5600 Epoch=53.4] | Loss=0.00209 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.497 | L2-Norm(final)=9.903 | 2140.7 samples/s | 33.4 steps/s
[Step=5650 Epoch=53.8] | Loss=0.00200 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.468 | L2-Norm(final)=9.904 | 6751.4 samples/s | 105.5 steps/s
[Step=5700 Epoch=54.3] | Loss=0.00192 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.439 | L2-Norm(final)=9.904 | 2167.7 samples/s | 33.9 steps/s
[Step=5750 Epoch=54.8] | Loss=0.00184 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.409 | L2-Norm(final)=9.905 | 6235.7 samples/s | 97.4 steps/s
[Step=5800 Epoch=55.3] | Loss=0.00177 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=9.906 | 2271.5 samples/s | 35.5 steps/s
[Step=5850 Epoch=55.8] | Loss=0.00171 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=9.907 | 5716.7 samples/s | 89.3 steps/s
[Step=5900 Epoch=56.2] | Loss=0.00165 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.321 | L2-Norm(final)=9.907 | 2297.7 samples/s | 35.9 steps/s
[Step=5950 Epoch=56.7] | Loss=0.00159 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.291 | L2-Norm(final)=9.908 | 5408.9 samples/s | 84.5 steps/s
[Step=6000 Epoch=57.2] | Loss=0.00154 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.262 | L2-Norm(final)=9.909 | 2398.1 samples/s | 37.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.12948 | acc=0.9428 | tpr=0.9598 | fpr=0.0942 | 5545.7 samples/s | 21.7 steps/s
Avg test loss: 0.13310, Avg test acc: 0.94186, Avg tpr: 0.95943, Avg fpr: 0.09678, total FA: 755

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.12861 | acc=0.9417 | tpr=0.9639 | fpr=0.1065 | 5741.6 samples/s | 22.4 steps/s
Avg test loss: 0.12972, Avg test acc: 0.94062, Avg tpr: 0.96258, Avg fpr: 0.10768, total FA: 840

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.13690 | acc=0.9406 | tpr=0.9633 | fpr=0.1085 | 5822.1 samples/s | 22.7 steps/s
Avg test loss: 0.13971, Avg test acc: 0.93914, Avg tpr: 0.96054, Avg fpr: 0.10793, total FA: 842

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.12162 | acc=0.9409 | tpr=0.9557 | fpr=0.0914 | 5851.6 samples/s | 22.9 steps/s
Avg test loss: 0.12736, Avg test acc: 0.93946, Avg tpr: 0.95448, Avg fpr: 0.09358, total FA: 730

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.14088 | acc=0.9309 | tpr=0.9529 | fpr=0.1167 | 5561.5 samples/s | 21.7 steps/s
Avg test loss: 0.14219, Avg test acc: 0.93193, Avg tpr: 0.95302, Avg fpr: 0.11447, total FA: 893

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.10029 | acc=0.3116 | tpr=0.0082 | fpr=0.0295 | 5713.6 samples/s | 22.3 steps/s
Avg test loss: 4.11287, Avg test acc: 0.30924, Avg tpr: 0.00717, Avg fpr: 0.02641, total FA: 206

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.54550 | acc=0.3159 | tpr=0.0259 | fpr=0.0545 | 5689.9 samples/s | 22.2 steps/s
Avg test loss: 4.55892, Avg test acc: 0.31393, Avg tpr: 0.02559, Avg fpr: 0.05192, total FA: 405

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.43078 | acc=0.3110 | tpr=0.0104 | fpr=0.0362 | 5783.6 samples/s | 22.6 steps/s
Avg test loss: 4.44634, Avg test acc: 0.30908, Avg tpr: 0.00956, Avg fpr: 0.03218, total FA: 251

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.98545 | acc=0.3105 | tpr=0.0105 | fpr=0.0382 | 5726.8 samples/s | 22.4 steps/s
Avg test loss: 4.99934, Avg test acc: 0.30916, Avg tpr: 0.01113, Avg fpr: 0.03538, total FA: 276

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.57047 | acc=0.3111 | tpr=0.0114 | fpr=0.0382 | 5724.8 samples/s | 22.4 steps/s
Avg test loss: 4.58502, Avg test acc: 0.30916, Avg tpr: 0.01125, Avg fpr: 0.03564, total FA: 278

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.97855 | acc=0.1290 | tpr=0.6637 | fpr=0.8806 | 5678.3 samples/s | 22.2 steps/s
[Step= 100] | Loss=5.92882 | acc=0.1293 | tpr=0.6205 | fpr=0.8799 | 7743.3 samples/s | 30.2 steps/s
[Step= 150] | Loss=5.93989 | acc=0.1285 | tpr=0.6282 | fpr=0.8807 | 7466.4 samples/s | 29.2 steps/s
[Step= 200] | Loss=5.92740 | acc=0.1296 | tpr=0.6230 | fpr=0.8794 | 8241.2 samples/s | 32.2 steps/s
[Step= 250] | Loss=5.93300 | acc=0.1295 | tpr=0.6271 | fpr=0.8796 | 8470.9 samples/s | 33.1 steps/s
[Step= 300] | Loss=5.93381 | acc=0.1291 | tpr=0.6320 | fpr=0.8800 | 5838.9 samples/s | 22.8 steps/s
[Step= 350] | Loss=5.92974 | acc=0.1286 | tpr=0.6180 | fpr=0.8803 | 8523.0 samples/s | 33.3 steps/s
[Step= 400] | Loss=5.93070 | acc=0.1292 | tpr=0.6198 | fpr=0.8797 | 7948.1 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.93328 | acc=0.1292 | tpr=0.6183 | fpr=0.8797 | 8284.8 samples/s | 32.4 steps/s
[Step= 500] | Loss=5.93391 | acc=0.1290 | tpr=0.6172 | fpr=0.8798 | 7716.1 samples/s | 30.1 steps/s
[Step= 550] | Loss=5.93298 | acc=0.1292 | tpr=0.6152 | fpr=0.8796 | 10710.4 samples/s | 41.8 steps/s
Avg test loss: 5.93330, Avg test acc: 0.12907, Avg tpr: 0.61529, Avg fpr: 0.87977, total FA: 122154

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.10622 | acc=0.1462 | tpr=0.3894 | fpr=0.8581 | 5754.1 samples/s | 22.5 steps/s
[Step= 100] | Loss=4.09421 | acc=0.1480 | tpr=0.3603 | fpr=0.8560 | 7605.2 samples/s | 29.7 steps/s
[Step= 150] | Loss=4.11352 | acc=0.1470 | tpr=0.3573 | fpr=0.8569 | 8070.8 samples/s | 31.5 steps/s
[Step= 200] | Loss=4.11297 | acc=0.1479 | tpr=0.3672 | fpr=0.8561 | 7895.0 samples/s | 30.8 steps/s
[Step= 250] | Loss=4.11822 | acc=0.1481 | tpr=0.3799 | fpr=0.8561 | 7834.7 samples/s | 30.6 steps/s
[Step= 300] | Loss=4.11379 | acc=0.1476 | tpr=0.3847 | fpr=0.8567 | 6072.6 samples/s | 23.7 steps/s
[Step= 350] | Loss=4.11386 | acc=0.1469 | tpr=0.3757 | fpr=0.8573 | 7265.3 samples/s | 28.4 steps/s
[Step= 400] | Loss=4.11035 | acc=0.1482 | tpr=0.3769 | fpr=0.8560 | 8302.6 samples/s | 32.4 steps/s
[Step= 450] | Loss=4.11233 | acc=0.1479 | tpr=0.3729 | fpr=0.8562 | 7794.8 samples/s | 30.4 steps/s
[Step= 500] | Loss=4.11516 | acc=0.1480 | tpr=0.3753 | fpr=0.8561 | 8743.0 samples/s | 34.2 steps/s
[Step= 550] | Loss=4.11263 | acc=0.1479 | tpr=0.3756 | fpr=0.8562 | 11468.9 samples/s | 44.8 steps/s
Avg test loss: 4.11349, Avg test acc: 0.14779, Avg tpr: 0.37599, Avg fpr: 0.85636, total FA: 118904

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.95380 | acc=0.1036 | tpr=0.5265 | fpr=0.9040 | 5648.4 samples/s | 22.1 steps/s
[Step= 100] | Loss=4.93733 | acc=0.1027 | tpr=0.4733 | fpr=0.9042 | 7678.3 samples/s | 30.0 steps/s
[Step= 150] | Loss=4.93448 | acc=0.1023 | tpr=0.4755 | fpr=0.9046 | 7970.7 samples/s | 31.1 steps/s
[Step= 200] | Loss=4.92198 | acc=0.1032 | tpr=0.4798 | fpr=0.9037 | 7941.3 samples/s | 31.0 steps/s
[Step= 250] | Loss=4.92518 | acc=0.1028 | tpr=0.4812 | fpr=0.9041 | 6052.2 samples/s | 23.6 steps/s
[Step= 300] | Loss=4.92497 | acc=0.1033 | tpr=0.4895 | fpr=0.9037 | 8301.7 samples/s | 32.4 steps/s
[Step= 350] | Loss=4.92740 | acc=0.1029 | tpr=0.4759 | fpr=0.9039 | 8284.3 samples/s | 32.4 steps/s
[Step= 400] | Loss=4.92375 | acc=0.1037 | tpr=0.4852 | fpr=0.9033 | 8274.9 samples/s | 32.3 steps/s
[Step= 450] | Loss=4.92680 | acc=0.1037 | tpr=0.4810 | fpr=0.9032 | 7794.7 samples/s | 30.4 steps/s
[Step= 500] | Loss=4.92822 | acc=0.1036 | tpr=0.4824 | fpr=0.9033 | 8241.9 samples/s | 32.2 steps/s
[Step= 550] | Loss=4.92625 | acc=0.1034 | tpr=0.4779 | fpr=0.9034 | 9686.1 samples/s | 37.8 steps/s
Avg test loss: 4.92641, Avg test acc: 0.10336, Avg tpr: 0.47821, Avg fpr: 0.90346, total FA: 125443

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.84231 | acc=0.1357 | tpr=0.3673 | fpr=0.8685 | 5743.8 samples/s | 22.4 steps/s
[Step= 100] | Loss=4.81835 | acc=0.1353 | tpr=0.3518 | fpr=0.8688 | 7970.0 samples/s | 31.1 steps/s
[Step= 150] | Loss=4.81121 | acc=0.1352 | tpr=0.3473 | fpr=0.8687 | 7780.2 samples/s | 30.4 steps/s
[Step= 200] | Loss=4.79943 | acc=0.1346 | tpr=0.3454 | fpr=0.8692 | 7802.9 samples/s | 30.5 steps/s
[Step= 250] | Loss=4.80314 | acc=0.1345 | tpr=0.3397 | fpr=0.8692 | 6161.7 samples/s | 24.1 steps/s
[Step= 300] | Loss=4.80344 | acc=0.1344 | tpr=0.3469 | fpr=0.8694 | 8139.6 samples/s | 31.8 steps/s
[Step= 350] | Loss=4.80423 | acc=0.1340 | tpr=0.3381 | fpr=0.8697 | 8227.6 samples/s | 32.1 steps/s
[Step= 400] | Loss=4.79984 | acc=0.1342 | tpr=0.3397 | fpr=0.8695 | 8389.5 samples/s | 32.8 steps/s
[Step= 450] | Loss=4.80018 | acc=0.1343 | tpr=0.3393 | fpr=0.8694 | 7496.0 samples/s | 29.3 steps/s
[Step= 500] | Loss=4.80052 | acc=0.1338 | tpr=0.3388 | fpr=0.8699 | 8082.7 samples/s | 31.6 steps/s
[Step= 550] | Loss=4.79756 | acc=0.1336 | tpr=0.3382 | fpr=0.8702 | 9987.4 samples/s | 39.0 steps/s
Avg test loss: 4.79817, Avg test acc: 0.13347, Avg tpr: 0.33875, Avg fpr: 0.87026, total FA: 120834

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.54938 | acc=0.1173 | tpr=0.4912 | fpr=0.8895 | 5821.1 samples/s | 22.7 steps/s
[Step= 100] | Loss=5.51584 | acc=0.1168 | tpr=0.4478 | fpr=0.8894 | 7868.1 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.53853 | acc=0.1164 | tpr=0.4496 | fpr=0.8898 | 8184.0 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.52734 | acc=0.1159 | tpr=0.4361 | fpr=0.8899 | 7267.3 samples/s | 28.4 steps/s
[Step= 250] | Loss=5.52869 | acc=0.1158 | tpr=0.4288 | fpr=0.8900 | 8329.0 samples/s | 32.5 steps/s
[Step= 300] | Loss=5.52418 | acc=0.1158 | tpr=0.4305 | fpr=0.8900 | 8588.1 samples/s | 33.5 steps/s
[Step= 350] | Loss=5.52869 | acc=0.1149 | tpr=0.4126 | fpr=0.8905 | 8062.8 samples/s | 31.5 steps/s
[Step= 400] | Loss=5.52285 | acc=0.1154 | tpr=0.4190 | fpr=0.8901 | 8292.1 samples/s | 32.4 steps/s
[Step= 450] | Loss=5.51860 | acc=0.1154 | tpr=0.4221 | fpr=0.8901 | 5949.0 samples/s | 23.2 steps/s
[Step= 500] | Loss=5.51766 | acc=0.1151 | tpr=0.4203 | fpr=0.8904 | 8082.1 samples/s | 31.6 steps/s
[Step= 550] | Loss=5.51357 | acc=0.1151 | tpr=0.4174 | fpr=0.8904 | 9718.0 samples/s | 38.0 steps/s
Avg test loss: 5.51321, Avg test acc: 0.11504, Avg tpr: 0.41799, Avg fpr: 0.89046, total FA: 123639

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07801 | acc=0.9807 | tpr=0.8938 | fpr=0.0177 | 5770.8 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.07996 | acc=0.9797 | tpr=0.9190 | fpr=0.0192 | 7272.9 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.08165 | acc=0.9793 | tpr=0.9236 | fpr=0.0197 | 7659.3 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.08365 | acc=0.9793 | tpr=0.9322 | fpr=0.0199 | 5997.4 samples/s | 23.4 steps/s
[Step= 250] | Loss=0.08369 | acc=0.9795 | tpr=0.9223 | fpr=0.0194 | 8454.7 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.08456 | acc=0.9793 | tpr=0.9185 | fpr=0.0196 | 7930.1 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.08523 | acc=0.9793 | tpr=0.9180 | fpr=0.0196 | 8487.4 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.08588 | acc=0.9793 | tpr=0.9179 | fpr=0.0196 | 8111.6 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.08705 | acc=0.9790 | tpr=0.9153 | fpr=0.0198 | 8306.8 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.08675 | acc=0.9791 | tpr=0.9181 | fpr=0.0198 | 7520.0 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.08595 | acc=0.9793 | tpr=0.9176 | fpr=0.0196 | 10857.9 samples/s | 42.4 steps/s
Avg test loss: 0.08581, Avg test acc: 0.97925, Avg tpr: 0.91719, Avg fpr: 0.01962, total FA: 2724

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10759 | acc=0.9797 | tpr=0.8540 | fpr=0.0181 | 5708.0 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.11176 | acc=0.9793 | tpr=0.8806 | fpr=0.0189 | 8115.2 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.11305 | acc=0.9788 | tpr=0.8876 | fpr=0.0195 | 7652.9 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.11434 | acc=0.9788 | tpr=0.8885 | fpr=0.0196 | 5539.4 samples/s | 21.6 steps/s
[Step= 250] | Loss=0.11413 | acc=0.9789 | tpr=0.8847 | fpr=0.0194 | 8704.3 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.11620 | acc=0.9786 | tpr=0.8844 | fpr=0.0197 | 8280.1 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.11741 | acc=0.9783 | tpr=0.8842 | fpr=0.0200 | 8283.0 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.11823 | acc=0.9781 | tpr=0.8802 | fpr=0.0201 | 7538.4 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.12057 | acc=0.9779 | tpr=0.8759 | fpr=0.0203 | 7902.5 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.11943 | acc=0.9780 | tpr=0.8775 | fpr=0.0202 | 8364.7 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.11882 | acc=0.9781 | tpr=0.8762 | fpr=0.0201 | 10751.8 samples/s | 42.0 steps/s
Avg test loss: 0.11861, Avg test acc: 0.97811, Avg tpr: 0.87599, Avg fpr: 0.02003, total FA: 2781

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.16145 | acc=0.9664 | tpr=0.9204 | fpr=0.0328 | 5905.7 samples/s | 23.1 steps/s
[Step= 100] | Loss=0.17062 | acc=0.9645 | tpr=0.9318 | fpr=0.0349 | 8041.5 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.17429 | acc=0.9640 | tpr=0.9337 | fpr=0.0355 | 7980.1 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.17425 | acc=0.9641 | tpr=0.9399 | fpr=0.0355 | 5500.9 samples/s | 21.5 steps/s
[Step= 250] | Loss=0.17496 | acc=0.9640 | tpr=0.9362 | fpr=0.0355 | 8332.0 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.17585 | acc=0.9638 | tpr=0.9345 | fpr=0.0357 | 8069.7 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.17458 | acc=0.9640 | tpr=0.9355 | fpr=0.0355 | 8436.9 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.17626 | acc=0.9638 | tpr=0.9333 | fpr=0.0356 | 8020.7 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.17760 | acc=0.9636 | tpr=0.9309 | fpr=0.0358 | 8389.5 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.17740 | acc=0.9635 | tpr=0.9339 | fpr=0.0360 | 7745.6 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.17652 | acc=0.9635 | tpr=0.9308 | fpr=0.0359 | 9741.5 samples/s | 38.1 steps/s
Avg test loss: 0.17645, Avg test acc: 0.96357, Avg tpr: 0.93067, Avg fpr: 0.03583, total FA: 4975

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11454 | acc=0.9789 | tpr=0.9204 | fpr=0.0200 | 5600.5 samples/s | 21.9 steps/s
[Step= 100] | Loss=0.12055 | acc=0.9792 | tpr=0.9296 | fpr=0.0199 | 8338.4 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.12623 | acc=0.9784 | tpr=0.9323 | fpr=0.0208 | 5989.1 samples/s | 23.4 steps/s
[Step= 200] | Loss=0.12767 | acc=0.9787 | tpr=0.9333 | fpr=0.0205 | 7592.7 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.12676 | acc=0.9786 | tpr=0.9231 | fpr=0.0203 | 7632.5 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.12838 | acc=0.9786 | tpr=0.9229 | fpr=0.0204 | 8086.2 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.12825 | acc=0.9785 | tpr=0.9230 | fpr=0.0205 | 8410.4 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.12925 | acc=0.9783 | tpr=0.9207 | fpr=0.0207 | 8163.9 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.13090 | acc=0.9781 | tpr=0.9182 | fpr=0.0208 | 8367.4 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.13023 | acc=0.9781 | tpr=0.9203 | fpr=0.0209 | 8145.2 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.12959 | acc=0.9782 | tpr=0.9200 | fpr=0.0208 | 9497.4 samples/s | 37.1 steps/s
Avg test loss: 0.12942, Avg test acc: 0.97816, Avg tpr: 0.91957, Avg fpr: 0.02077, total FA: 2884

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.09641 | acc=0.9782 | tpr=0.8850 | fpr=0.0201 | 5701.1 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.09849 | acc=0.9784 | tpr=0.9083 | fpr=0.0203 | 8255.4 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.10275 | acc=0.9773 | tpr=0.9135 | fpr=0.0215 | 5830.8 samples/s | 22.8 steps/s
[Step= 200] | Loss=0.10264 | acc=0.9778 | tpr=0.9137 | fpr=0.0210 | 7835.8 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.10226 | acc=0.9775 | tpr=0.9100 | fpr=0.0212 | 7762.3 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.10394 | acc=0.9774 | tpr=0.9076 | fpr=0.0213 | 8510.2 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.10538 | acc=0.9771 | tpr=0.9086 | fpr=0.0216 | 8067.7 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.10575 | acc=0.9771 | tpr=0.9054 | fpr=0.0216 | 7940.0 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.10713 | acc=0.9768 | tpr=0.9017 | fpr=0.0218 | 8273.9 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.10665 | acc=0.9768 | tpr=0.9026 | fpr=0.0219 | 7472.4 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.10595 | acc=0.9768 | tpr=0.9033 | fpr=0.0219 | 10852.7 samples/s | 42.4 steps/s
Avg test loss: 0.10576, Avg test acc: 0.97680, Avg tpr: 0.90254, Avg fpr: 0.02185, total FA: 3034

server round 9/50

clients selected: [0 1 3 4 5]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.16725 | Reg=0.00153 | acc=0.8594 | L2-Norm=12.350 | L2-Norm(final)=7.164 | 6004.7 samples/s | 93.8 steps/s
[Step=4050 Epoch=19.7] | Loss=0.14416 | Reg=0.00153 | acc=0.9062 | L2-Norm=12.351 | L2-Norm(final)=7.185 | 5113.0 samples/s | 79.9 steps/s
[Step=4100 Epoch=20.0] | Loss=0.13652 | Reg=0.00153 | acc=0.8438 | L2-Norm=12.351 | L2-Norm(final)=7.320 | 5772.7 samples/s | 90.2 steps/s
[Step=4150 Epoch=20.2] | Loss=0.13303 | Reg=0.00153 | acc=0.8281 | L2-Norm=12.351 | L2-Norm(final)=7.487 | 5545.0 samples/s | 86.6 steps/s
[Step=4200 Epoch=20.5] | Loss=0.13303 | Reg=0.00153 | acc=0.9219 | L2-Norm=12.351 | L2-Norm(final)=7.655 | 8760.6 samples/s | 136.9 steps/s
[Step=4250 Epoch=20.7] | Loss=0.13056 | Reg=0.00153 | acc=0.9375 | L2-Norm=12.351 | L2-Norm(final)=7.817 | 2430.5 samples/s | 38.0 steps/s
[Step=4300 Epoch=21.0] | Loss=0.12921 | Reg=0.00153 | acc=0.9062 | L2-Norm=12.351 | L2-Norm(final)=7.972 | 5711.4 samples/s | 89.2 steps/s
[Step=4350 Epoch=21.2] | Loss=0.12786 | Reg=0.00153 | acc=0.8438 | L2-Norm=12.351 | L2-Norm(final)=8.117 | 5714.1 samples/s | 89.3 steps/s
[Step=4400 Epoch=21.5] | Loss=0.12697 | Reg=0.00153 | acc=0.9219 | L2-Norm=12.351 | L2-Norm(final)=8.256 | 7527.9 samples/s | 117.6 steps/s
[Step=4450 Epoch=21.7] | Loss=0.12580 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.351 | L2-Norm(final)=8.390 | 2513.3 samples/s | 39.3 steps/s
[Step=4500 Epoch=21.9] | Loss=0.12519 | Reg=0.00153 | acc=0.9531 | L2-Norm=12.351 | L2-Norm(final)=8.520 | 5646.1 samples/s | 88.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=21.9] | Loss=0.11837 | Reg=0.00153 | acc=0.8906 | L2-Norm=12.351 | L2-Norm(final)=9.786 | 6087.4 samples/s | 95.1 steps/s
[Step=4550 Epoch=22.2] | Loss=0.08718 | Reg=0.00159 | acc=0.9531 | L2-Norm=12.590 | L2-Norm(final)=9.807 | 4292.5 samples/s | 67.1 steps/s
[Step=4600 Epoch=22.4] | Loss=0.07779 | Reg=0.00164 | acc=0.9219 | L2-Norm=12.789 | L2-Norm(final)=9.788 | 4901.5 samples/s | 76.6 steps/s
[Step=4650 Epoch=22.7] | Loss=0.07221 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.936 | L2-Norm(final)=9.779 | 4843.9 samples/s | 75.7 steps/s
[Step=4700 Epoch=22.9] | Loss=0.06872 | Reg=0.00171 | acc=0.9375 | L2-Norm=13.057 | L2-Norm(final)=9.769 | 6873.6 samples/s | 107.4 steps/s
[Step=4750 Epoch=23.2] | Loss=0.06047 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.158 | L2-Norm(final)=9.762 | 2250.2 samples/s | 35.2 steps/s
[Step=4800 Epoch=23.4] | Loss=0.05567 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.241 | L2-Norm(final)=9.758 | 4939.0 samples/s | 77.2 steps/s
[Step=4850 Epoch=23.6] | Loss=0.05236 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.317 | L2-Norm(final)=9.754 | 4880.7 samples/s | 76.3 steps/s
[Step=4900 Epoch=23.9] | Loss=0.05039 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=9.752 | 6168.8 samples/s | 96.4 steps/s
[Step=4950 Epoch=24.1] | Loss=0.04855 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.457 | L2-Norm(final)=9.750 | 2341.6 samples/s | 36.6 steps/s
[Step=5000 Epoch=24.4] | Loss=0.04654 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.526 | L2-Norm(final)=9.747 | 4835.9 samples/s | 75.6 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04476 | Reg=0.00185 | acc=0.9531 | L2-Norm=13.591 | L2-Norm(final)=9.745 | 4903.5 samples/s | 76.6 steps/s
[Step=5100 Epoch=24.9] | Loss=0.04349 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.652 | L2-Norm(final)=9.743 | 5775.4 samples/s | 90.2 steps/s
[Step=5150 Epoch=25.1] | Loss=0.04173 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.711 | L2-Norm(final)=9.742 | 2452.0 samples/s | 38.3 steps/s
[Step=5200 Epoch=25.4] | Loss=0.03993 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.767 | L2-Norm(final)=9.742 | 4838.7 samples/s | 75.6 steps/s
[Step=5250 Epoch=25.6] | Loss=0.03831 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.818 | L2-Norm(final)=9.742 | 4832.8 samples/s | 75.5 steps/s
[Step=5300 Epoch=25.8] | Loss=0.03770 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.866 | L2-Norm(final)=9.741 | 5407.0 samples/s | 84.5 steps/s
[Step=5350 Epoch=26.1] | Loss=0.03638 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.912 | L2-Norm(final)=9.739 | 1862.0 samples/s | 29.1 steps/s
[Step=5400 Epoch=26.3] | Loss=0.03516 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.955 | L2-Norm(final)=9.738 | 4863.3 samples/s | 76.0 steps/s
[Step=5450 Epoch=26.6] | Loss=0.03402 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.995 | L2-Norm(final)=9.738 | 4620.5 samples/s | 72.2 steps/s
[Step=5500 Epoch=26.8] | Loss=0.03294 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.033 | L2-Norm(final)=9.738 | 4999.2 samples/s | 78.1 steps/s
[Step=5550 Epoch=27.1] | Loss=0.03203 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.069 | L2-Norm(final)=9.738 | 2562.6 samples/s | 40.0 steps/s
[Step=5600 Epoch=27.3] | Loss=0.03109 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.103 | L2-Norm(final)=9.738 | 4810.4 samples/s | 75.2 steps/s
[Step=5650 Epoch=27.6] | Loss=0.03020 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.135 | L2-Norm(final)=9.738 | 4872.9 samples/s | 76.1 steps/s
[Step=5700 Epoch=27.8] | Loss=0.02953 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.165 | L2-Norm(final)=9.738 | 4861.8 samples/s | 76.0 steps/s
[Step=5750 Epoch=28.0] | Loss=0.02874 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.195 | L2-Norm(final)=9.738 | 2636.4 samples/s | 41.2 steps/s
[Step=5800 Epoch=28.3] | Loss=0.02808 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.223 | L2-Norm(final)=9.738 | 4927.0 samples/s | 77.0 steps/s
[Step=5850 Epoch=28.5] | Loss=0.02747 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.250 | L2-Norm(final)=9.738 | 4850.5 samples/s | 75.8 steps/s
[Step=5900 Epoch=28.8] | Loss=0.02702 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.277 | L2-Norm(final)=9.738 | 4858.5 samples/s | 75.9 steps/s
[Step=5950 Epoch=29.0] | Loss=0.02660 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.305 | L2-Norm(final)=9.738 | 2651.4 samples/s | 41.4 steps/s
[Step=6000 Epoch=29.3] | Loss=0.02619 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.334 | L2-Norm(final)=9.738 | 4946.1 samples/s | 77.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step6000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=14001 Epoch=68.3] | Loss=0.07994 | Reg=0.00153 | acc=0.9375 | L2-Norm=12.350 | L2-Norm(final)=11.129 | 5506.3 samples/s | 86.0 steps/s
[Step=14050 Epoch=68.6] | Loss=0.12071 | Reg=0.00153 | acc=0.9219 | L2-Norm=12.351 | L2-Norm(final)=11.165 | 5092.1 samples/s | 79.6 steps/s
[Step=14100 Epoch=68.8] | Loss=0.11854 | Reg=0.00153 | acc=0.8906 | L2-Norm=12.352 | L2-Norm(final)=11.269 | 5584.2 samples/s | 87.3 steps/s
[Step=14150 Epoch=69.0] | Loss=0.11970 | Reg=0.00153 | acc=0.9219 | L2-Norm=12.352 | L2-Norm(final)=11.376 | 5614.7 samples/s | 87.7 steps/s
[Step=14200 Epoch=69.3] | Loss=0.11944 | Reg=0.00153 | acc=0.9375 | L2-Norm=12.352 | L2-Norm(final)=11.481 | 8780.1 samples/s | 137.2 steps/s
[Step=14250 Epoch=69.5] | Loss=0.11945 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.352 | L2-Norm(final)=11.585 | 2395.4 samples/s | 37.4 steps/s
[Step=14300 Epoch=69.8] | Loss=0.11897 | Reg=0.00153 | acc=0.8750 | L2-Norm=12.352 | L2-Norm(final)=11.688 | 5449.8 samples/s | 85.2 steps/s
[Step=14350 Epoch=70.0] | Loss=0.11839 | Reg=0.00153 | acc=0.8594 | L2-Norm=12.352 | L2-Norm(final)=11.789 | 5494.3 samples/s | 85.8 steps/s
[Step=14400 Epoch=70.3] | Loss=0.11809 | Reg=0.00153 | acc=0.9375 | L2-Norm=12.352 | L2-Norm(final)=11.885 | 7975.4 samples/s | 124.6 steps/s
[Step=14450 Epoch=70.5] | Loss=0.11799 | Reg=0.00153 | acc=0.9062 | L2-Norm=12.352 | L2-Norm(final)=11.977 | 2504.0 samples/s | 39.1 steps/s
[Step=14500 Epoch=70.8] | Loss=0.11755 | Reg=0.00153 | acc=0.9531 | L2-Norm=12.352 | L2-Norm(final)=12.068 | 5429.9 samples/s | 84.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=14501 Epoch=70.8] | Loss=0.10333 | Reg=0.00153 | acc=0.9062 | L2-Norm=12.352 | L2-Norm(final)=12.974 | 5638.0 samples/s | 88.1 steps/s
[Step=14550 Epoch=71.0] | Loss=0.09380 | Reg=0.00162 | acc=0.8906 | L2-Norm=12.709 | L2-Norm(final)=12.972 | 4445.8 samples/s | 69.5 steps/s
[Step=14600 Epoch=71.2] | Loss=0.08620 | Reg=0.00168 | acc=0.9062 | L2-Norm=12.960 | L2-Norm(final)=12.946 | 4986.4 samples/s | 77.9 steps/s
[Step=14650 Epoch=71.5] | Loss=0.07719 | Reg=0.00172 | acc=0.9531 | L2-Norm=13.120 | L2-Norm(final)=12.927 | 4739.9 samples/s | 74.1 steps/s
[Step=14700 Epoch=71.7] | Loss=0.07418 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.248 | L2-Norm(final)=12.908 | 6992.3 samples/s | 109.3 steps/s
[Step=14750 Epoch=72.0] | Loss=0.06726 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.356 | L2-Norm(final)=12.892 | 2253.5 samples/s | 35.2 steps/s
[Step=14800 Epoch=72.2] | Loss=0.06243 | Reg=0.00181 | acc=0.9531 | L2-Norm=13.444 | L2-Norm(final)=12.882 | 4852.0 samples/s | 75.8 steps/s
[Step=14850 Epoch=72.5] | Loss=0.05926 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.526 | L2-Norm(final)=12.874 | 4825.7 samples/s | 75.4 steps/s
[Step=14900 Epoch=72.7] | Loss=0.05666 | Reg=0.00185 | acc=0.9531 | L2-Norm=13.603 | L2-Norm(final)=12.867 | 6456.3 samples/s | 100.9 steps/s
[Step=14950 Epoch=72.9] | Loss=0.05361 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.677 | L2-Norm(final)=12.860 | 2303.6 samples/s | 36.0 steps/s
[Step=15000 Epoch=73.2] | Loss=0.05109 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.742 | L2-Norm(final)=12.854 | 4857.8 samples/s | 75.9 steps/s
[Step=15050 Epoch=73.4] | Loss=0.04921 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.802 | L2-Norm(final)=12.847 | 4865.4 samples/s | 76.0 steps/s
[Step=15100 Epoch=73.7] | Loss=0.04780 | Reg=0.00192 | acc=0.9375 | L2-Norm=13.859 | L2-Norm(final)=12.841 | 5963.9 samples/s | 93.2 steps/s
[Step=15150 Epoch=73.9] | Loss=0.04612 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.912 | L2-Norm(final)=12.835 | 2380.7 samples/s | 37.2 steps/s
[Step=15200 Epoch=74.2] | Loss=0.04411 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.959 | L2-Norm(final)=12.830 | 4975.7 samples/s | 77.7 steps/s
[Step=15250 Epoch=74.4] | Loss=0.04217 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.003 | L2-Norm(final)=12.826 | 4778.3 samples/s | 74.7 steps/s
[Step=15300 Epoch=74.7] | Loss=0.04059 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.043 | L2-Norm(final)=12.823 | 5608.7 samples/s | 87.6 steps/s
[Step=15350 Epoch=74.9] | Loss=0.03888 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.080 | L2-Norm(final)=12.820 | 2481.9 samples/s | 38.8 steps/s
[Step=15400 Epoch=75.1] | Loss=0.03758 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.115 | L2-Norm(final)=12.817 | 4827.2 samples/s | 75.4 steps/s
[Step=15450 Epoch=75.4] | Loss=0.03658 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.149 | L2-Norm(final)=12.815 | 4956.3 samples/s | 77.4 steps/s
[Step=15500 Epoch=75.6] | Loss=0.03534 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.181 | L2-Norm(final)=12.813 | 5163.4 samples/s | 80.7 steps/s
[Step=15550 Epoch=75.9] | Loss=0.03482 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.213 | L2-Norm(final)=12.811 | 2538.4 samples/s | 39.7 steps/s
[Step=15600 Epoch=76.1] | Loss=0.03392 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.244 | L2-Norm(final)=12.809 | 4852.2 samples/s | 75.8 steps/s
[Step=15650 Epoch=76.4] | Loss=0.03323 | Reg=0.00204 | acc=0.9531 | L2-Norm=14.275 | L2-Norm(final)=12.807 | 4827.7 samples/s | 75.4 steps/s
[Step=15700 Epoch=76.6] | Loss=0.03259 | Reg=0.00205 | acc=0.9688 | L2-Norm=14.305 | L2-Norm(final)=12.805 | 4931.8 samples/s | 77.1 steps/s
[Step=15750 Epoch=76.9] | Loss=0.03185 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.336 | L2-Norm(final)=12.804 | 2595.7 samples/s | 40.6 steps/s
[Step=15800 Epoch=77.1] | Loss=0.03114 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.365 | L2-Norm(final)=12.803 | 4973.7 samples/s | 77.7 steps/s
[Step=15850 Epoch=77.3] | Loss=0.03072 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.394 | L2-Norm(final)=12.802 | 4774.8 samples/s | 74.6 steps/s
[Step=15900 Epoch=77.6] | Loss=0.03003 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.422 | L2-Norm(final)=12.800 | 4866.2 samples/s | 76.0 steps/s
[Step=15950 Epoch=77.8] | Loss=0.02937 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.451 | L2-Norm(final)=12.799 | 2654.8 samples/s | 41.5 steps/s
[Step=16000 Epoch=78.1] | Loss=0.02874 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.479 | L2-Norm(final)=12.797 | 4730.4 samples/s | 73.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step16000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=29.3] | Loss=0.09988 | Reg=0.00153 | acc=0.9219 | L2-Norm=12.350 | L2-Norm(final)=8.407 | 6201.6 samples/s | 96.9 steps/s
[Step=6050 Epoch=29.5] | Loss=0.13941 | Reg=0.00153 | acc=0.9062 | L2-Norm=12.360 | L2-Norm(final)=8.461 | 4964.0 samples/s | 77.6 steps/s
[Step=6100 Epoch=29.7] | Loss=0.14173 | Reg=0.00153 | acc=0.8594 | L2-Norm=12.362 | L2-Norm(final)=8.571 | 5686.0 samples/s | 88.8 steps/s
[Step=6150 Epoch=30.0] | Loss=0.14151 | Reg=0.00153 | acc=0.8750 | L2-Norm=12.363 | L2-Norm(final)=8.688 | 5715.3 samples/s | 89.3 steps/s
[Step=6200 Epoch=30.2] | Loss=0.14033 | Reg=0.00153 | acc=0.8750 | L2-Norm=12.363 | L2-Norm(final)=8.816 | 8614.0 samples/s | 134.6 steps/s
[Step=6250 Epoch=30.5] | Loss=0.13847 | Reg=0.00153 | acc=0.8594 | L2-Norm=12.363 | L2-Norm(final)=8.947 | 2496.2 samples/s | 39.0 steps/s
[Step=6300 Epoch=30.7] | Loss=0.13791 | Reg=0.00153 | acc=0.9531 | L2-Norm=12.363 | L2-Norm(final)=9.074 | 5476.0 samples/s | 85.6 steps/s
[Step=6350 Epoch=31.0] | Loss=0.13727 | Reg=0.00153 | acc=0.9531 | L2-Norm=12.364 | L2-Norm(final)=9.193 | 5579.5 samples/s | 87.2 steps/s
[Step=6400 Epoch=31.2] | Loss=0.13600 | Reg=0.00153 | acc=0.9062 | L2-Norm=12.364 | L2-Norm(final)=9.310 | 7639.5 samples/s | 119.4 steps/s
[Step=6450 Epoch=31.5] | Loss=0.13551 | Reg=0.00153 | acc=0.8438 | L2-Norm=12.364 | L2-Norm(final)=9.422 | 2514.8 samples/s | 39.3 steps/s
[Step=6500 Epoch=31.7] | Loss=0.13519 | Reg=0.00153 | acc=0.9375 | L2-Norm=12.364 | L2-Norm(final)=9.530 | 5721.4 samples/s | 89.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=31.7] | Loss=0.08082 | Reg=0.00153 | acc=0.9531 | L2-Norm=12.364 | L2-Norm(final)=10.581 | 6111.1 samples/s | 95.5 steps/s
[Step=6550 Epoch=31.9] | Loss=0.08188 | Reg=0.00159 | acc=0.9219 | L2-Norm=12.624 | L2-Norm(final)=10.608 | 4229.5 samples/s | 66.1 steps/s
[Step=6600 Epoch=32.2] | Loss=0.07496 | Reg=0.00165 | acc=0.9219 | L2-Norm=12.849 | L2-Norm(final)=10.592 | 4842.2 samples/s | 75.7 steps/s
[Step=6650 Epoch=32.4] | Loss=0.07181 | Reg=0.00169 | acc=0.9219 | L2-Norm=13.005 | L2-Norm(final)=10.576 | 4878.6 samples/s | 76.2 steps/s
[Step=6700 Epoch=32.7] | Loss=0.06773 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.128 | L2-Norm(final)=10.563 | 6934.2 samples/s | 108.3 steps/s
[Step=6750 Epoch=32.9] | Loss=0.06048 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.228 | L2-Norm(final)=10.555 | 2271.6 samples/s | 35.5 steps/s
[Step=6800 Epoch=33.2] | Loss=0.05524 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=10.551 | 4853.0 samples/s | 75.8 steps/s
[Step=6850 Epoch=33.4] | Loss=0.05205 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.381 | L2-Norm(final)=10.550 | 4849.3 samples/s | 75.8 steps/s
[Step=6900 Epoch=33.6] | Loss=0.04991 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.446 | L2-Norm(final)=10.546 | 6358.4 samples/s | 99.4 steps/s
[Step=6950 Epoch=33.9] | Loss=0.04757 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.509 | L2-Norm(final)=10.542 | 2345.1 samples/s | 36.6 steps/s
[Step=7000 Epoch=34.1] | Loss=0.04533 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.569 | L2-Norm(final)=10.538 | 4937.4 samples/s | 77.1 steps/s
[Step=7050 Epoch=34.4] | Loss=0.04335 | Reg=0.00186 | acc=0.9531 | L2-Norm=13.624 | L2-Norm(final)=10.534 | 4866.8 samples/s | 76.0 steps/s
[Step=7100 Epoch=34.6] | Loss=0.04230 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.677 | L2-Norm(final)=10.531 | 5767.9 samples/s | 90.1 steps/s
[Step=7150 Epoch=34.9] | Loss=0.04086 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.728 | L2-Norm(final)=10.528 | 2419.8 samples/s | 37.8 steps/s
[Step=7200 Epoch=35.1] | Loss=0.03937 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.777 | L2-Norm(final)=10.525 | 4829.1 samples/s | 75.5 steps/s
[Step=7250 Epoch=35.4] | Loss=0.03809 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.825 | L2-Norm(final)=10.522 | 4876.0 samples/s | 76.2 steps/s
[Step=7300 Epoch=35.6] | Loss=0.03669 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.870 | L2-Norm(final)=10.520 | 5361.9 samples/s | 83.8 steps/s
[Step=7350 Epoch=35.8] | Loss=0.03583 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.913 | L2-Norm(final)=10.518 | 2524.8 samples/s | 39.4 steps/s
[Step=7400 Epoch=36.1] | Loss=0.03480 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.954 | L2-Norm(final)=10.516 | 4951.6 samples/s | 77.4 steps/s
[Step=7450 Epoch=36.3] | Loss=0.03390 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.992 | L2-Norm(final)=10.514 | 4780.9 samples/s | 74.7 steps/s
[Step=7500 Epoch=36.6] | Loss=0.03316 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.029 | L2-Norm(final)=10.512 | 4993.3 samples/s | 78.0 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03274 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.065 | L2-Norm(final)=10.510 | 2630.8 samples/s | 41.1 steps/s
[Step=7600 Epoch=37.1] | Loss=0.03188 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.101 | L2-Norm(final)=10.507 | 4849.4 samples/s | 75.8 steps/s
[Step=7650 Epoch=37.3] | Loss=0.03132 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.135 | L2-Norm(final)=10.505 | 4832.0 samples/s | 75.5 steps/s
[Step=7700 Epoch=37.5] | Loss=0.03094 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.168 | L2-Norm(final)=10.502 | 4893.8 samples/s | 76.5 steps/s
[Step=7750 Epoch=37.8] | Loss=0.03065 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.201 | L2-Norm(final)=10.499 | 2699.9 samples/s | 42.2 steps/s
[Step=7800 Epoch=38.0] | Loss=0.03003 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.234 | L2-Norm(final)=10.496 | 4712.2 samples/s | 73.6 steps/s
[Step=7850 Epoch=38.3] | Loss=0.02953 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.265 | L2-Norm(final)=10.493 | 4945.7 samples/s | 77.3 steps/s
[Step=7900 Epoch=38.5] | Loss=0.02904 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.295 | L2-Norm(final)=10.490 | 4819.9 samples/s | 75.3 steps/s
[Step=7950 Epoch=38.8] | Loss=0.02853 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.324 | L2-Norm(final)=10.487 | 2673.7 samples/s | 41.8 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02787 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.352 | L2-Norm(final)=10.485 | 4772.2 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step8000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=49.0] | Loss=0.09394 | Reg=0.00153 | acc=0.8906 | L2-Norm=12.350 | L2-Norm(final)=9.974 | 5950.8 samples/s | 93.0 steps/s
[Step=10050 Epoch=49.3] | Loss=0.13969 | Reg=0.00153 | acc=0.9219 | L2-Norm=12.360 | L2-Norm(final)=9.963 | 4809.1 samples/s | 75.1 steps/s
[Step=10100 Epoch=49.5] | Loss=0.13533 | Reg=0.00153 | acc=0.8906 | L2-Norm=12.361 | L2-Norm(final)=10.035 | 5835.4 samples/s | 91.2 steps/s
[Step=10150 Epoch=49.8] | Loss=0.13419 | Reg=0.00153 | acc=0.8906 | L2-Norm=12.362 | L2-Norm(final)=10.148 | 5458.2 samples/s | 85.3 steps/s
[Step=10200 Epoch=50.0] | Loss=0.13291 | Reg=0.00153 | acc=0.9219 | L2-Norm=12.362 | L2-Norm(final)=10.268 | 8982.1 samples/s | 140.3 steps/s
[Step=10250 Epoch=50.3] | Loss=0.13019 | Reg=0.00153 | acc=0.8750 | L2-Norm=12.362 | L2-Norm(final)=10.388 | 2384.6 samples/s | 37.3 steps/s
[Step=10300 Epoch=50.5] | Loss=0.12851 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.363 | L2-Norm(final)=10.509 | 5661.7 samples/s | 88.5 steps/s
[Step=10350 Epoch=50.8] | Loss=0.12851 | Reg=0.00153 | acc=0.9062 | L2-Norm=12.363 | L2-Norm(final)=10.626 | 5578.0 samples/s | 87.2 steps/s
[Step=10400 Epoch=51.0] | Loss=0.12744 | Reg=0.00153 | acc=0.8281 | L2-Norm=12.363 | L2-Norm(final)=10.739 | 8314.1 samples/s | 129.9 steps/s
[Step=10450 Epoch=51.2] | Loss=0.12694 | Reg=0.00153 | acc=0.8906 | L2-Norm=12.363 | L2-Norm(final)=10.848 | 2438.3 samples/s | 38.1 steps/s
[Step=10500 Epoch=51.5] | Loss=0.12624 | Reg=0.00153 | acc=0.8750 | L2-Norm=12.363 | L2-Norm(final)=10.952 | 5719.5 samples/s | 89.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=51.5] | Loss=0.07986 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.363 | L2-Norm(final)=11.979 | 6045.5 samples/s | 94.5 steps/s
[Step=10550 Epoch=51.7] | Loss=0.08478 | Reg=0.00160 | acc=0.9219 | L2-Norm=12.661 | L2-Norm(final)=11.992 | 4292.0 samples/s | 67.1 steps/s
[Step=10600 Epoch=52.0] | Loss=0.07618 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.912 | L2-Norm(final)=11.966 | 4799.3 samples/s | 75.0 steps/s
[Step=10650 Epoch=52.2] | Loss=0.07141 | Reg=0.00171 | acc=0.9062 | L2-Norm=13.082 | L2-Norm(final)=11.947 | 4815.3 samples/s | 75.2 steps/s
[Step=10700 Epoch=52.5] | Loss=0.06774 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.221 | L2-Norm(final)=11.933 | 7156.8 samples/s | 111.8 steps/s
[Step=10750 Epoch=52.7] | Loss=0.05994 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.334 | L2-Norm(final)=11.927 | 2244.4 samples/s | 35.1 steps/s
[Step=10800 Epoch=53.0] | Loss=0.05633 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.425 | L2-Norm(final)=11.920 | 4899.6 samples/s | 76.6 steps/s
[Step=10850 Epoch=53.2] | Loss=0.05288 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.503 | L2-Norm(final)=11.915 | 4837.4 samples/s | 75.6 steps/s
[Step=10900 Epoch=53.5] | Loss=0.05065 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.571 | L2-Norm(final)=11.909 | 6720.2 samples/s | 105.0 steps/s
[Step=10950 Epoch=53.7] | Loss=0.04755 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.631 | L2-Norm(final)=11.905 | 2304.8 samples/s | 36.0 steps/s
[Step=11000 Epoch=53.9] | Loss=0.04503 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=11.902 | 4774.0 samples/s | 74.6 steps/s
[Step=11050 Epoch=54.2] | Loss=0.04383 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.734 | L2-Norm(final)=11.900 | 4854.9 samples/s | 75.9 steps/s
[Step=11100 Epoch=54.4] | Loss=0.04219 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.780 | L2-Norm(final)=11.897 | 6263.8 samples/s | 97.9 steps/s
[Step=11150 Epoch=54.7] | Loss=0.04004 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.822 | L2-Norm(final)=11.895 | 2371.1 samples/s | 37.0 steps/s
[Step=11200 Epoch=54.9] | Loss=0.03859 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.861 | L2-Norm(final)=11.893 | 4930.2 samples/s | 77.0 steps/s
[Step=11250 Epoch=55.2] | Loss=0.03748 | Reg=0.00193 | acc=0.9375 | L2-Norm=13.899 | L2-Norm(final)=11.891 | 4732.3 samples/s | 73.9 steps/s
[Step=11300 Epoch=55.4] | Loss=0.03650 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.935 | L2-Norm(final)=11.890 | 5965.5 samples/s | 93.2 steps/s
[Step=11350 Epoch=55.7] | Loss=0.03532 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.973 | L2-Norm(final)=11.889 | 2412.1 samples/s | 37.7 steps/s
[Step=11400 Epoch=55.9] | Loss=0.03423 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.008 | L2-Norm(final)=11.887 | 4767.6 samples/s | 74.5 steps/s
[Step=11450 Epoch=56.1] | Loss=0.03368 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.043 | L2-Norm(final)=11.886 | 4902.8 samples/s | 76.6 steps/s
[Step=11500 Epoch=56.4] | Loss=0.03309 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.076 | L2-Norm(final)=11.884 | 5582.0 samples/s | 87.2 steps/s
[Step=11550 Epoch=56.6] | Loss=0.03207 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.108 | L2-Norm(final)=11.883 | 2462.6 samples/s | 38.5 steps/s
[Step=11600 Epoch=56.9] | Loss=0.03134 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.140 | L2-Norm(final)=11.881 | 4940.6 samples/s | 77.2 steps/s
[Step=11650 Epoch=57.1] | Loss=0.03066 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.170 | L2-Norm(final)=11.880 | 4766.0 samples/s | 74.5 steps/s
[Step=11700 Epoch=57.4] | Loss=0.03015 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.200 | L2-Norm(final)=11.878 | 5337.4 samples/s | 83.4 steps/s
[Step=11750 Epoch=57.6] | Loss=0.02951 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.228 | L2-Norm(final)=11.877 | 2483.5 samples/s | 38.8 steps/s
[Step=11800 Epoch=57.9] | Loss=0.02877 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.255 | L2-Norm(final)=11.876 | 4915.8 samples/s | 76.8 steps/s
[Step=11850 Epoch=58.1] | Loss=0.02854 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.281 | L2-Norm(final)=11.874 | 4828.5 samples/s | 75.4 steps/s
[Step=11900 Epoch=58.4] | Loss=0.02809 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.308 | L2-Norm(final)=11.872 | 5077.5 samples/s | 79.3 steps/s
[Step=11950 Epoch=58.6] | Loss=0.02753 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.334 | L2-Norm(final)=11.870 | 2564.4 samples/s | 40.1 steps/s
[Step=12000 Epoch=58.8] | Loss=0.02732 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.359 | L2-Norm(final)=11.869 | 4881.5 samples/s | 76.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step12000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=12001 Epoch=113.7] | Loss=0.02666 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.350 | L2-Norm(final)=11.516 | 5246.4 samples/s | 82.0 steps/s
[Step=12050 Epoch=114.2] | Loss=0.05345 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.342 | L2-Norm(final)=11.496 | 4935.1 samples/s | 77.1 steps/s
[Step=12100 Epoch=114.7] | Loss=0.04296 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.341 | L2-Norm(final)=11.494 | 8342.5 samples/s | 130.4 steps/s
[Step=12150 Epoch=115.1] | Loss=0.03662 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.341 | L2-Norm(final)=11.517 | 2343.8 samples/s | 36.6 steps/s
[Step=12200 Epoch=115.6] | Loss=0.03231 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.341 | L2-Norm(final)=11.554 | 7388.2 samples/s | 115.4 steps/s
[Step=12250 Epoch=116.1] | Loss=0.02984 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.341 | L2-Norm(final)=11.604 | 2431.2 samples/s | 38.0 steps/s
[Step=12300 Epoch=116.6] | Loss=0.02738 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.341 | L2-Norm(final)=11.665 | 6591.9 samples/s | 103.0 steps/s
[Step=12350 Epoch=117.0] | Loss=0.02545 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.340 | L2-Norm(final)=11.734 | 2558.5 samples/s | 40.0 steps/s
[Step=12400 Epoch=117.5] | Loss=0.02408 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.340 | L2-Norm(final)=11.809 | 5786.7 samples/s | 90.4 steps/s
[Step=12450 Epoch=118.0] | Loss=0.02312 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.340 | L2-Norm(final)=11.888 | 2670.0 samples/s | 41.7 steps/s
[Step=12500 Epoch=118.4] | Loss=0.02210 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.340 | L2-Norm(final)=11.969 | 5256.0 samples/s | 82.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=118.5] | Loss=0.01702 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.340 | L2-Norm(final)=12.795 | 5938.0 samples/s | 92.8 steps/s
[Step=12550 Epoch=118.9] | Loss=0.01714 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.803 | L2-Norm(final)=12.797 | 3968.1 samples/s | 62.0 steps/s
[Step=12600 Epoch=119.4] | Loss=0.01745 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.162 | L2-Norm(final)=12.765 | 6704.6 samples/s | 104.8 steps/s
[Step=12650 Epoch=119.9] | Loss=0.01259 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=12.731 | 2202.7 samples/s | 34.4 steps/s
[Step=12700 Epoch=120.3] | Loss=0.00965 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.470 | L2-Norm(final)=12.715 | 6083.4 samples/s | 95.1 steps/s
[Step=12750 Epoch=120.8] | Loss=0.00773 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.517 | L2-Norm(final)=12.707 | 2250.9 samples/s | 35.2 steps/s
[Step=12800 Epoch=121.3] | Loss=0.00645 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.534 | L2-Norm(final)=12.703 | 5582.5 samples/s | 87.2 steps/s
[Step=12850 Epoch=121.8] | Loss=0.00553 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.535 | L2-Norm(final)=12.699 | 2359.2 samples/s | 36.9 steps/s
[Step=12900 Epoch=122.2] | Loss=0.00484 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.526 | L2-Norm(final)=12.697 | 5112.1 samples/s | 79.9 steps/s
[Step=12950 Epoch=122.7] | Loss=0.00430 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.510 | L2-Norm(final)=12.696 | 2479.1 samples/s | 38.7 steps/s
[Step=13000 Epoch=123.2] | Loss=0.00387 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.491 | L2-Norm(final)=12.694 | 4611.8 samples/s | 72.1 steps/s
[Step=13050 Epoch=123.7] | Loss=0.00352 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.468 | L2-Norm(final)=12.694 | 2527.8 samples/s | 39.5 steps/s
[Step=13100 Epoch=124.1] | Loss=0.00323 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.444 | L2-Norm(final)=12.693 | 4637.7 samples/s | 72.5 steps/s
[Step=13150 Epoch=124.6] | Loss=0.00298 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.419 | L2-Norm(final)=12.692 | 2582.3 samples/s | 40.3 steps/s
[Step=13200 Epoch=125.1] | Loss=0.00277 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.393 | L2-Norm(final)=12.692 | 4692.4 samples/s | 73.3 steps/s
[Step=13250 Epoch=125.6] | Loss=0.00258 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=12.692 | 2583.8 samples/s | 40.4 steps/s
[Step=13300 Epoch=126.0] | Loss=0.00242 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.338 | L2-Norm(final)=12.691 | 4667.9 samples/s | 72.9 steps/s
[Step=13350 Epoch=126.5] | Loss=0.00228 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=12.691 | 2638.0 samples/s | 41.2 steps/s
[Step=13400 Epoch=127.0] | Loss=0.00215 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=12.691 | 4510.3 samples/s | 70.5 steps/s
[Step=13450 Epoch=127.5] | Loss=0.00204 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.255 | L2-Norm(final)=12.691 | 6659.8 samples/s | 104.1 steps/s
[Step=13500 Epoch=127.9] | Loss=0.00194 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.227 | L2-Norm(final)=12.691 | 2155.0 samples/s | 33.7 steps/s
[Step=13550 Epoch=128.4] | Loss=0.00185 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.199 | L2-Norm(final)=12.691 | 6279.7 samples/s | 98.1 steps/s
[Step=13600 Epoch=128.9] | Loss=0.00176 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.171 | L2-Norm(final)=12.691 | 2254.4 samples/s | 35.2 steps/s
[Step=13650 Epoch=129.3] | Loss=0.00169 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.143 | L2-Norm(final)=12.691 | 5730.4 samples/s | 89.5 steps/s
[Step=13700 Epoch=129.8] | Loss=0.00162 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.115 | L2-Norm(final)=12.691 | 2309.8 samples/s | 36.1 steps/s
[Step=13750 Epoch=130.3] | Loss=0.00155 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.087 | L2-Norm(final)=12.691 | 5250.7 samples/s | 82.0 steps/s
[Step=13800 Epoch=130.8] | Loss=0.00149 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.059 | L2-Norm(final)=12.692 | 2405.0 samples/s | 37.6 steps/s
[Step=13850 Epoch=131.2] | Loss=0.00144 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.031 | L2-Norm(final)=12.692 | 4845.2 samples/s | 75.7 steps/s
[Step=13900 Epoch=131.7] | Loss=0.00139 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.003 | L2-Norm(final)=12.692 | 2496.3 samples/s | 39.0 steps/s
[Step=13950 Epoch=132.2] | Loss=0.00134 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.976 | L2-Norm(final)=12.692 | 4610.2 samples/s | 72.0 steps/s
[Step=14000 Epoch=132.7] | Loss=0.00129 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=12.692 | 2595.8 samples/s | 40.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step14000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.14161 | acc=0.9357 | tpr=0.9385 | fpr=0.0704 | 5475.9 samples/s | 21.4 steps/s
Avg test loss: 0.14717, Avg test acc: 0.93613, Avg tpr: 0.93868, Avg fpr: 0.06948, total FA: 542

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.16510 | acc=0.9410 | tpr=0.9707 | fpr=0.1234 | 5835.5 samples/s | 22.8 steps/s
Avg test loss: 0.16612, Avg test acc: 0.93994, Avg tpr: 0.97062, Avg fpr: 0.12755, total FA: 995

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.13690 | acc=0.9406 | tpr=0.9633 | fpr=0.1085 | 5771.5 samples/s | 22.5 steps/s
Avg test loss: 0.13971, Avg test acc: 0.93914, Avg tpr: 0.96054, Avg fpr: 0.10793, total FA: 842

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.11531 | acc=0.9457 | tpr=0.9556 | fpr=0.0758 | 5755.0 samples/s | 22.5 steps/s
Avg test loss: 0.12390, Avg test acc: 0.94415, Avg tpr: 0.95489, Avg fpr: 0.07948, total FA: 620

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.12626 | acc=0.9334 | tpr=0.9366 | fpr=0.0736 | 5784.2 samples/s | 22.6 steps/s
Avg test loss: 0.13054, Avg test acc: 0.93261, Avg tpr: 0.93624, Avg fpr: 0.07537, total FA: 588

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.13353 | acc=0.3170 | tpr=0.0177 | fpr=0.0330 | 5796.8 samples/s | 22.6 steps/s
Avg test loss: 5.15930, Avg test acc: 0.31441, Avg tpr: 0.01749, Avg fpr: 0.03256, total FA: 254

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.54550 | acc=0.3159 | tpr=0.0259 | fpr=0.0545 | 5773.4 samples/s | 22.6 steps/s
Avg test loss: 4.55892, Avg test acc: 0.31393, Avg tpr: 0.02559, Avg fpr: 0.05192, total FA: 405

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.43078 | acc=0.3110 | tpr=0.0104 | fpr=0.0362 | 5624.8 samples/s | 22.0 steps/s
Avg test loss: 4.44634, Avg test acc: 0.30908, Avg tpr: 0.00956, Avg fpr: 0.03218, total FA: 251

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.98545 | acc=0.3105 | tpr=0.0105 | fpr=0.0382 | 5750.1 samples/s | 22.5 steps/s
Avg test loss: 4.99934, Avg test acc: 0.30916, Avg tpr: 0.01113, Avg fpr: 0.03538, total FA: 276

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.57047 | acc=0.3111 | tpr=0.0114 | fpr=0.0382 | 5335.6 samples/s | 20.8 steps/s
Avg test loss: 4.58502, Avg test acc: 0.30916, Avg tpr: 0.01125, Avg fpr: 0.03564, total FA: 278

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.24717 | acc=0.1779 | tpr=0.3628 | fpr=0.8254 | 5824.8 samples/s | 22.8 steps/s
[Step= 100] | Loss=4.21491 | acc=0.1777 | tpr=0.3028 | fpr=0.8247 | 8145.6 samples/s | 31.8 steps/s
[Step= 150] | Loss=4.22621 | acc=0.1774 | tpr=0.3314 | fpr=0.8254 | 7943.3 samples/s | 31.0 steps/s
[Step= 200] | Loss=4.21964 | acc=0.1773 | tpr=0.3202 | fpr=0.8253 | 7536.1 samples/s | 29.4 steps/s
[Step= 250] | Loss=4.22164 | acc=0.1774 | tpr=0.3301 | fpr=0.8254 | 7480.0 samples/s | 29.2 steps/s
[Step= 300] | Loss=4.22144 | acc=0.1774 | tpr=0.3367 | fpr=0.8255 | 8154.2 samples/s | 31.9 steps/s
[Step= 350] | Loss=4.21728 | acc=0.1767 | tpr=0.3231 | fpr=0.8259 | 7969.6 samples/s | 31.1 steps/s
[Step= 400] | Loss=4.21677 | acc=0.1771 | tpr=0.3239 | fpr=0.8255 | 8412.6 samples/s | 32.9 steps/s
[Step= 450] | Loss=4.21920 | acc=0.1771 | tpr=0.3223 | fpr=0.8256 | 8023.5 samples/s | 31.3 steps/s
[Step= 500] | Loss=4.21839 | acc=0.1772 | tpr=0.3256 | fpr=0.8254 | 8195.5 samples/s | 32.0 steps/s
[Step= 550] | Loss=4.21808 | acc=0.1770 | tpr=0.3243 | fpr=0.8257 | 11161.9 samples/s | 43.6 steps/s
Avg test loss: 4.21820, Avg test acc: 0.17692, Avg tpr: 0.32369, Avg fpr: 0.82574, total FA: 114653

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.77168 | acc=0.0966 | tpr=0.5531 | fpr=0.9116 | 5818.3 samples/s | 22.7 steps/s
[Step= 100] | Loss=6.72891 | acc=0.0952 | tpr=0.4883 | fpr=0.9122 | 7399.8 samples/s | 28.9 steps/s
[Step= 150] | Loss=6.74013 | acc=0.0957 | tpr=0.4942 | fpr=0.9117 | 8454.9 samples/s | 33.0 steps/s
[Step= 200] | Loss=6.73804 | acc=0.0948 | tpr=0.4874 | fpr=0.9123 | 8503.1 samples/s | 33.2 steps/s
[Step= 250] | Loss=6.73882 | acc=0.0958 | tpr=0.4969 | fpr=0.9116 | 7939.6 samples/s | 31.0 steps/s
[Step= 300] | Loss=6.73803 | acc=0.0957 | tpr=0.4975 | fpr=0.9116 | 7481.6 samples/s | 29.2 steps/s
[Step= 350] | Loss=6.73940 | acc=0.0954 | tpr=0.4840 | fpr=0.9117 | 8183.3 samples/s | 32.0 steps/s
[Step= 400] | Loss=6.73441 | acc=0.0959 | tpr=0.4874 | fpr=0.9112 | 8530.9 samples/s | 33.3 steps/s
[Step= 450] | Loss=6.73582 | acc=0.0963 | tpr=0.4883 | fpr=0.9108 | 7842.2 samples/s | 30.6 steps/s
[Step= 500] | Loss=6.74138 | acc=0.0959 | tpr=0.4828 | fpr=0.9110 | 8562.1 samples/s | 33.4 steps/s
[Step= 550] | Loss=6.73916 | acc=0.0958 | tpr=0.4799 | fpr=0.9112 | 9607.3 samples/s | 37.5 steps/s
Avg test loss: 6.74011, Avg test acc: 0.09566, Avg tpr: 0.47940, Avg fpr: 0.91131, total FA: 126534

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.95380 | acc=0.1036 | tpr=0.5265 | fpr=0.9040 | 5761.8 samples/s | 22.5 steps/s
[Step= 100] | Loss=4.93733 | acc=0.1027 | tpr=0.4733 | fpr=0.9042 | 8091.0 samples/s | 31.6 steps/s
[Step= 150] | Loss=4.93448 | acc=0.1023 | tpr=0.4755 | fpr=0.9046 | 8363.2 samples/s | 32.7 steps/s
[Step= 200] | Loss=4.92198 | acc=0.1032 | tpr=0.4798 | fpr=0.9037 | 7803.8 samples/s | 30.5 steps/s
[Step= 250] | Loss=4.92518 | acc=0.1028 | tpr=0.4812 | fpr=0.9041 | 7712.6 samples/s | 30.1 steps/s
[Step= 300] | Loss=4.92497 | acc=0.1033 | tpr=0.4895 | fpr=0.9037 | 7540.1 samples/s | 29.5 steps/s
[Step= 350] | Loss=4.92740 | acc=0.1029 | tpr=0.4759 | fpr=0.9039 | 8084.0 samples/s | 31.6 steps/s
[Step= 400] | Loss=4.92375 | acc=0.1037 | tpr=0.4852 | fpr=0.9033 | 7999.2 samples/s | 31.2 steps/s
[Step= 450] | Loss=4.92680 | acc=0.1037 | tpr=0.4810 | fpr=0.9032 | 8243.2 samples/s | 32.2 steps/s
[Step= 500] | Loss=4.92822 | acc=0.1036 | tpr=0.4824 | fpr=0.9033 | 8119.8 samples/s | 31.7 steps/s
[Step= 550] | Loss=4.92625 | acc=0.1034 | tpr=0.4779 | fpr=0.9034 | 11427.4 samples/s | 44.6 steps/s
Avg test loss: 4.92641, Avg test acc: 0.10336, Avg tpr: 0.47821, Avg fpr: 0.90346, total FA: 125443

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.25502 | acc=0.1448 | tpr=0.4646 | fpr=0.8609 | 5632.1 samples/s | 22.0 steps/s
[Step= 100] | Loss=5.22828 | acc=0.1453 | tpr=0.4136 | fpr=0.8597 | 8256.0 samples/s | 32.3 steps/s
[Step= 150] | Loss=5.22425 | acc=0.1446 | tpr=0.3934 | fpr=0.8600 | 7262.2 samples/s | 28.4 steps/s
[Step= 200] | Loss=5.21352 | acc=0.1439 | tpr=0.3760 | fpr=0.8603 | 8351.4 samples/s | 32.6 steps/s
[Step= 250] | Loss=5.22452 | acc=0.1434 | tpr=0.3738 | fpr=0.8608 | 8408.3 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.22326 | acc=0.1429 | tpr=0.3738 | fpr=0.8614 | 8059.9 samples/s | 31.5 steps/s
[Step= 350] | Loss=5.22178 | acc=0.1420 | tpr=0.3632 | fpr=0.8620 | 7882.0 samples/s | 30.8 steps/s
[Step= 400] | Loss=5.21598 | acc=0.1426 | tpr=0.3693 | fpr=0.8615 | 7673.2 samples/s | 30.0 steps/s
[Step= 450] | Loss=5.21416 | acc=0.1425 | tpr=0.3695 | fpr=0.8616 | 8479.8 samples/s | 33.1 steps/s
[Step= 500] | Loss=5.21607 | acc=0.1422 | tpr=0.3696 | fpr=0.8619 | 8435.2 samples/s | 33.0 steps/s
[Step= 550] | Loss=5.21293 | acc=0.1423 | tpr=0.3729 | fpr=0.8619 | 9866.4 samples/s | 38.5 steps/s
Avg test loss: 5.21376, Avg test acc: 0.14213, Avg tpr: 0.37401, Avg fpr: 0.86209, total FA: 119699

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.63927 | acc=0.1603 | tpr=0.4071 | fpr=0.8441 | 5696.9 samples/s | 22.3 steps/s
[Step= 100] | Loss=4.61130 | acc=0.1589 | tpr=0.3753 | fpr=0.8451 | 7671.9 samples/s | 30.0 steps/s
[Step= 150] | Loss=4.62624 | acc=0.1590 | tpr=0.3660 | fpr=0.8448 | 8727.2 samples/s | 34.1 steps/s
[Step= 200] | Loss=4.61598 | acc=0.1590 | tpr=0.3628 | fpr=0.8447 | 7621.7 samples/s | 29.8 steps/s
[Step= 250] | Loss=4.62517 | acc=0.1590 | tpr=0.3633 | fpr=0.8448 | 8325.7 samples/s | 32.5 steps/s
[Step= 300] | Loss=4.62731 | acc=0.1590 | tpr=0.3658 | fpr=0.8448 | 8108.8 samples/s | 31.7 steps/s
[Step= 350] | Loss=4.63214 | acc=0.1586 | tpr=0.3550 | fpr=0.8450 | 7384.0 samples/s | 28.8 steps/s
[Step= 400] | Loss=4.63061 | acc=0.1588 | tpr=0.3518 | fpr=0.8447 | 8243.3 samples/s | 32.2 steps/s
[Step= 450] | Loss=4.62915 | acc=0.1590 | tpr=0.3539 | fpr=0.8445 | 8223.2 samples/s | 32.1 steps/s
[Step= 500] | Loss=4.62958 | acc=0.1588 | tpr=0.3533 | fpr=0.8447 | 8308.5 samples/s | 32.5 steps/s
[Step= 550] | Loss=4.62785 | acc=0.1589 | tpr=0.3506 | fpr=0.8446 | 10188.4 samples/s | 39.8 steps/s
Avg test loss: 4.62786, Avg test acc: 0.15885, Avg tpr: 0.35103, Avg fpr: 0.84464, total FA: 117277

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12876 | acc=0.9804 | tpr=0.8805 | fpr=0.0178 | 5726.1 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.13437 | acc=0.9795 | tpr=0.9041 | fpr=0.0191 | 8181.7 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.13912 | acc=0.9786 | tpr=0.9107 | fpr=0.0202 | 7528.8 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.14151 | acc=0.9785 | tpr=0.9191 | fpr=0.0204 | 7687.4 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.14156 | acc=0.9787 | tpr=0.9118 | fpr=0.0201 | 8104.1 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.14365 | acc=0.9784 | tpr=0.9098 | fpr=0.0204 | 8277.9 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.14478 | acc=0.9782 | tpr=0.9098 | fpr=0.0206 | 8183.4 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.14577 | acc=0.9780 | tpr=0.9065 | fpr=0.0207 | 8368.2 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.14821 | acc=0.9778 | tpr=0.9056 | fpr=0.0209 | 8285.1 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.14713 | acc=0.9778 | tpr=0.9075 | fpr=0.0210 | 7850.6 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.14656 | acc=0.9778 | tpr=0.9053 | fpr=0.0208 | 10303.4 samples/s | 40.2 steps/s
Avg test loss: 0.14622, Avg test acc: 0.97786, Avg tpr: 0.90491, Avg fpr: 0.02081, total FA: 2890

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10759 | acc=0.9797 | tpr=0.8540 | fpr=0.0181 | 5837.5 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.11176 | acc=0.9793 | tpr=0.8806 | fpr=0.0189 | 8091.0 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.11305 | acc=0.9788 | tpr=0.8876 | fpr=0.0195 | 7238.3 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.11434 | acc=0.9788 | tpr=0.8885 | fpr=0.0196 | 8016.1 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.11413 | acc=0.9789 | tpr=0.8847 | fpr=0.0194 | 7933.0 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.11620 | acc=0.9786 | tpr=0.8844 | fpr=0.0197 | 8379.0 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.11741 | acc=0.9783 | tpr=0.8842 | fpr=0.0200 | 7792.6 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.11823 | acc=0.9781 | tpr=0.8802 | fpr=0.0201 | 8277.0 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.12057 | acc=0.9779 | tpr=0.8759 | fpr=0.0203 | 8168.5 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.11943 | acc=0.9780 | tpr=0.8775 | fpr=0.0202 | 8017.1 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.11882 | acc=0.9781 | tpr=0.8762 | fpr=0.0201 | 10704.9 samples/s | 41.8 steps/s
Avg test loss: 0.11861, Avg test acc: 0.97811, Avg tpr: 0.87599, Avg fpr: 0.02003, total FA: 2781

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.16145 | acc=0.9664 | tpr=0.9204 | fpr=0.0328 | 5875.2 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.17062 | acc=0.9645 | tpr=0.9318 | fpr=0.0349 | 7299.1 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.17429 | acc=0.9640 | tpr=0.9337 | fpr=0.0355 | 8258.4 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.17425 | acc=0.9641 | tpr=0.9399 | fpr=0.0355 | 8122.5 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.17496 | acc=0.9640 | tpr=0.9362 | fpr=0.0355 | 8235.6 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.17585 | acc=0.9638 | tpr=0.9345 | fpr=0.0357 | 8072.8 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.17458 | acc=0.9640 | tpr=0.9355 | fpr=0.0355 | 7552.4 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.17626 | acc=0.9638 | tpr=0.9333 | fpr=0.0356 | 8577.4 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.17760 | acc=0.9636 | tpr=0.9309 | fpr=0.0358 | 8520.2 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.17740 | acc=0.9635 | tpr=0.9339 | fpr=0.0360 | 7713.7 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.17652 | acc=0.9635 | tpr=0.9308 | fpr=0.0359 | 10185.5 samples/s | 39.8 steps/s
Avg test loss: 0.17645, Avg test acc: 0.96357, Avg tpr: 0.93067, Avg fpr: 0.03583, total FA: 4975

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11454 | acc=0.9789 | tpr=0.9204 | fpr=0.0200 | 5618.9 samples/s | 21.9 steps/s
[Step= 100] | Loss=0.12055 | acc=0.9792 | tpr=0.9296 | fpr=0.0199 | 7528.6 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.12623 | acc=0.9784 | tpr=0.9323 | fpr=0.0208 | 8442.6 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.12767 | acc=0.9787 | tpr=0.9333 | fpr=0.0205 | 8015.9 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.12676 | acc=0.9786 | tpr=0.9231 | fpr=0.0203 | 8149.6 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.12838 | acc=0.9786 | tpr=0.9229 | fpr=0.0204 | 8364.0 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.12825 | acc=0.9785 | tpr=0.9230 | fpr=0.0205 | 8201.0 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.12925 | acc=0.9783 | tpr=0.9207 | fpr=0.0207 | 8095.9 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.13090 | acc=0.9781 | tpr=0.9182 | fpr=0.0208 | 8079.8 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.13023 | acc=0.9781 | tpr=0.9203 | fpr=0.0209 | 7763.8 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.12959 | acc=0.9782 | tpr=0.9200 | fpr=0.0208 | 10313.5 samples/s | 40.3 steps/s
Avg test loss: 0.12942, Avg test acc: 0.97816, Avg tpr: 0.91957, Avg fpr: 0.02077, total FA: 2884

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.09641 | acc=0.9782 | tpr=0.8850 | fpr=0.0201 | 5561.1 samples/s | 21.7 steps/s
[Step= 100] | Loss=0.09849 | acc=0.9784 | tpr=0.9083 | fpr=0.0203 | 8072.2 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.10275 | acc=0.9773 | tpr=0.9135 | fpr=0.0215 | 7900.8 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.10264 | acc=0.9778 | tpr=0.9137 | fpr=0.0210 | 7495.5 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.10226 | acc=0.9775 | tpr=0.9100 | fpr=0.0212 | 8233.1 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.10394 | acc=0.9774 | tpr=0.9076 | fpr=0.0213 | 8438.9 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.10538 | acc=0.9771 | tpr=0.9086 | fpr=0.0216 | 7803.8 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.10575 | acc=0.9771 | tpr=0.9054 | fpr=0.0216 | 8521.8 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.10713 | acc=0.9768 | tpr=0.9017 | fpr=0.0218 | 7753.4 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.10665 | acc=0.9768 | tpr=0.9026 | fpr=0.0219 | 8503.1 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.10595 | acc=0.9768 | tpr=0.9033 | fpr=0.0219 | 11275.4 samples/s | 44.0 steps/s
Avg test loss: 0.10576, Avg test acc: 0.97680, Avg tpr: 0.90254, Avg fpr: 0.02185, total FA: 3034

server round 10/50

clients selected: [2 3 4 6 7]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=48.7] | Loss=0.18976 | Reg=0.00150 | acc=0.8281 | L2-Norm=12.233 | L2-Norm(final)=9.198 | 5625.5 samples/s | 87.9 steps/s
[Step=10050 Epoch=49.0] | Loss=0.15394 | Reg=0.00150 | acc=0.8594 | L2-Norm=12.237 | L2-Norm(final)=9.166 | 5193.2 samples/s | 81.1 steps/s
[Step=10100 Epoch=49.2] | Loss=0.13636 | Reg=0.00150 | acc=0.9219 | L2-Norm=12.238 | L2-Norm(final)=9.189 | 5645.7 samples/s | 88.2 steps/s
[Step=10150 Epoch=49.5] | Loss=0.13183 | Reg=0.00150 | acc=0.9375 | L2-Norm=12.238 | L2-Norm(final)=9.226 | 5625.7 samples/s | 87.9 steps/s
[Step=10200 Epoch=49.7] | Loss=0.12916 | Reg=0.00150 | acc=0.8750 | L2-Norm=12.238 | L2-Norm(final)=9.269 | 8693.7 samples/s | 135.8 steps/s
[Step=10250 Epoch=49.9] | Loss=0.12599 | Reg=0.00150 | acc=0.8750 | L2-Norm=12.238 | L2-Norm(final)=9.319 | 2408.4 samples/s | 37.6 steps/s
[Step=10300 Epoch=50.2] | Loss=0.12382 | Reg=0.00150 | acc=0.8906 | L2-Norm=12.238 | L2-Norm(final)=9.372 | 5650.1 samples/s | 88.3 steps/s
[Step=10350 Epoch=50.4] | Loss=0.12281 | Reg=0.00150 | acc=0.9062 | L2-Norm=12.239 | L2-Norm(final)=9.427 | 5548.7 samples/s | 86.7 steps/s
[Step=10400 Epoch=50.7] | Loss=0.12150 | Reg=0.00150 | acc=0.9219 | L2-Norm=12.239 | L2-Norm(final)=9.482 | 7783.5 samples/s | 121.6 steps/s
[Step=10450 Epoch=50.9] | Loss=0.12102 | Reg=0.00150 | acc=0.8750 | L2-Norm=12.239 | L2-Norm(final)=9.538 | 2548.1 samples/s | 39.8 steps/s
[Step=10500 Epoch=51.2] | Loss=0.12013 | Reg=0.00150 | acc=0.8906 | L2-Norm=12.239 | L2-Norm(final)=9.594 | 5529.1 samples/s | 86.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=51.2] | Loss=0.11002 | Reg=0.00150 | acc=0.9219 | L2-Norm=12.239 | L2-Norm(final)=10.151 | 5580.9 samples/s | 87.2 steps/s
[Step=10550 Epoch=51.4] | Loss=0.07047 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.331 | L2-Norm(final)=10.184 | 4489.8 samples/s | 70.2 steps/s
[Step=10600 Epoch=51.6] | Loss=0.06258 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.408 | L2-Norm(final)=10.184 | 4843.5 samples/s | 75.7 steps/s
[Step=10650 Epoch=51.9] | Loss=0.05712 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=10.182 | 4904.2 samples/s | 76.6 steps/s
[Step=10700 Epoch=52.1] | Loss=0.05185 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=10.182 | 6881.9 samples/s | 107.5 steps/s
[Step=10750 Epoch=52.4] | Loss=0.04576 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.536 | L2-Norm(final)=10.184 | 2311.9 samples/s | 36.1 steps/s
[Step=10800 Epoch=52.6] | Loss=0.04138 | Reg=0.00158 | acc=0.9531 | L2-Norm=12.567 | L2-Norm(final)=10.188 | 4738.1 samples/s | 74.0 steps/s
[Step=10850 Epoch=52.9] | Loss=0.03766 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.592 | L2-Norm(final)=10.193 | 4924.7 samples/s | 76.9 steps/s
[Step=10900 Epoch=53.1] | Loss=0.03551 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.616 | L2-Norm(final)=10.197 | 6233.5 samples/s | 97.4 steps/s
[Step=10950 Epoch=53.4] | Loss=0.03302 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.637 | L2-Norm(final)=10.202 | 2344.8 samples/s | 36.6 steps/s
[Step=11000 Epoch=53.6] | Loss=0.03087 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.657 | L2-Norm(final)=10.207 | 4879.3 samples/s | 76.2 steps/s
[Step=11050 Epoch=53.8] | Loss=0.02902 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=10.211 | 4891.0 samples/s | 76.4 steps/s
[Step=11100 Epoch=54.1] | Loss=0.02762 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=10.216 | 5770.7 samples/s | 90.2 steps/s
[Step=11150 Epoch=54.3] | Loss=0.02622 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.707 | L2-Norm(final)=10.220 | 2404.9 samples/s | 37.6 steps/s
[Step=11200 Epoch=54.6] | Loss=0.02492 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.721 | L2-Norm(final)=10.225 | 4882.7 samples/s | 76.3 steps/s
[Step=11250 Epoch=54.8] | Loss=0.02375 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.734 | L2-Norm(final)=10.229 | 4867.8 samples/s | 76.1 steps/s
[Step=11300 Epoch=55.1] | Loss=0.02284 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.745 | L2-Norm(final)=10.233 | 5360.5 samples/s | 83.8 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02191 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.756 | L2-Norm(final)=10.237 | 2467.9 samples/s | 38.6 steps/s
[Step=11400 Epoch=55.5] | Loss=0.02100 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.766 | L2-Norm(final)=10.241 | 4863.4 samples/s | 76.0 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02020 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.775 | L2-Norm(final)=10.245 | 4860.5 samples/s | 75.9 steps/s
[Step=11500 Epoch=56.0] | Loss=0.01962 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.784 | L2-Norm(final)=10.248 | 4958.9 samples/s | 77.5 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01911 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.792 | L2-Norm(final)=10.252 | 2617.7 samples/s | 40.9 steps/s
[Step=11600 Epoch=56.5] | Loss=0.01846 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.800 | L2-Norm(final)=10.255 | 4840.5 samples/s | 75.6 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01788 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.807 | L2-Norm(final)=10.258 | 4925.9 samples/s | 77.0 steps/s
[Step=11700 Epoch=57.0] | Loss=0.01733 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.814 | L2-Norm(final)=10.262 | 4806.4 samples/s | 75.1 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01685 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.820 | L2-Norm(final)=10.265 | 2636.8 samples/s | 41.2 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01638 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.827 | L2-Norm(final)=10.268 | 4857.2 samples/s | 75.9 steps/s
[Step=11850 Epoch=57.7] | Loss=0.01599 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.832 | L2-Norm(final)=10.272 | 4848.2 samples/s | 75.8 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01559 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.838 | L2-Norm(final)=10.275 | 4842.0 samples/s | 75.7 steps/s
[Step=11950 Epoch=58.2] | Loss=0.01524 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.843 | L2-Norm(final)=10.278 | 2662.9 samples/s | 41.6 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01490 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.848 | L2-Norm(final)=10.281 | 4880.6 samples/s | 76.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step12000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.10414 | Reg=0.00150 | acc=0.9062 | L2-Norm=12.233 | L2-Norm(final)=10.410 | 6207.5 samples/s | 97.0 steps/s
[Step=8050 Epoch=39.3] | Loss=0.11515 | Reg=0.00150 | acc=0.8906 | L2-Norm=12.234 | L2-Norm(final)=10.453 | 4628.6 samples/s | 72.3 steps/s
[Step=8100 Epoch=39.5] | Loss=0.11572 | Reg=0.00150 | acc=0.9062 | L2-Norm=12.234 | L2-Norm(final)=10.497 | 5656.1 samples/s | 88.4 steps/s
[Step=8150 Epoch=39.7] | Loss=0.11380 | Reg=0.00150 | acc=0.9062 | L2-Norm=12.234 | L2-Norm(final)=10.544 | 5748.1 samples/s | 89.8 steps/s
[Step=8200 Epoch=40.0] | Loss=0.11270 | Reg=0.00150 | acc=0.9219 | L2-Norm=12.234 | L2-Norm(final)=10.598 | 8339.8 samples/s | 130.3 steps/s
[Step=8250 Epoch=40.2] | Loss=0.11118 | Reg=0.00150 | acc=0.8594 | L2-Norm=12.234 | L2-Norm(final)=10.655 | 2494.0 samples/s | 39.0 steps/s
[Step=8300 Epoch=40.5] | Loss=0.11103 | Reg=0.00150 | acc=0.8750 | L2-Norm=12.234 | L2-Norm(final)=10.713 | 5558.8 samples/s | 86.9 steps/s
[Step=8350 Epoch=40.7] | Loss=0.11190 | Reg=0.00150 | acc=0.8750 | L2-Norm=12.234 | L2-Norm(final)=10.767 | 5493.9 samples/s | 85.8 steps/s
[Step=8400 Epoch=41.0] | Loss=0.11195 | Reg=0.00150 | acc=0.8906 | L2-Norm=12.234 | L2-Norm(final)=10.819 | 7805.1 samples/s | 122.0 steps/s
[Step=8450 Epoch=41.2] | Loss=0.11131 | Reg=0.00150 | acc=0.9375 | L2-Norm=12.234 | L2-Norm(final)=10.869 | 2529.1 samples/s | 39.5 steps/s
[Step=8500 Epoch=41.5] | Loss=0.11122 | Reg=0.00150 | acc=0.9375 | L2-Norm=12.234 | L2-Norm(final)=10.918 | 5618.8 samples/s | 87.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=41.5] | Loss=0.13107 | Reg=0.00150 | acc=0.8906 | L2-Norm=12.235 | L2-Norm(final)=11.407 | 5922.6 samples/s | 92.5 steps/s
[Step=8550 Epoch=41.7] | Loss=0.07673 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.307 | L2-Norm(final)=11.429 | 4333.7 samples/s | 67.7 steps/s
[Step=8600 Epoch=41.9] | Loss=0.06104 | Reg=0.00153 | acc=0.9375 | L2-Norm=12.369 | L2-Norm(final)=11.424 | 4866.1 samples/s | 76.0 steps/s
[Step=8650 Epoch=42.2] | Loss=0.05415 | Reg=0.00154 | acc=0.9531 | L2-Norm=12.416 | L2-Norm(final)=11.423 | 4841.3 samples/s | 75.6 steps/s
[Step=8700 Epoch=42.4] | Loss=0.04928 | Reg=0.00155 | acc=0.9531 | L2-Norm=12.453 | L2-Norm(final)=11.422 | 6985.3 samples/s | 109.1 steps/s
[Step=8750 Epoch=42.7] | Loss=0.04349 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.485 | L2-Norm(final)=11.420 | 2260.0 samples/s | 35.3 steps/s
[Step=8800 Epoch=42.9] | Loss=0.03933 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=11.421 | 4908.6 samples/s | 76.7 steps/s
[Step=8850 Epoch=43.2] | Loss=0.03603 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.538 | L2-Norm(final)=11.422 | 4786.4 samples/s | 74.8 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03369 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.561 | L2-Norm(final)=11.424 | 6358.0 samples/s | 99.3 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03117 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.581 | L2-Norm(final)=11.427 | 2336.3 samples/s | 36.5 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02902 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.600 | L2-Norm(final)=11.430 | 4854.3 samples/s | 75.8 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02745 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.617 | L2-Norm(final)=11.433 | 4831.1 samples/s | 75.5 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02610 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.633 | L2-Norm(final)=11.435 | 5824.0 samples/s | 91.0 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02494 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.648 | L2-Norm(final)=11.438 | 2439.7 samples/s | 38.1 steps/s
[Step=9200 Epoch=44.9] | Loss=0.02370 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.661 | L2-Norm(final)=11.440 | 4882.9 samples/s | 76.3 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02270 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.674 | L2-Norm(final)=11.443 | 4874.0 samples/s | 76.2 steps/s
[Step=9300 Epoch=45.4] | Loss=0.02173 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.685 | L2-Norm(final)=11.446 | 5318.4 samples/s | 83.1 steps/s
[Step=9350 Epoch=45.6] | Loss=0.02106 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.696 | L2-Norm(final)=11.449 | 2546.5 samples/s | 39.8 steps/s
[Step=9400 Epoch=45.8] | Loss=0.02048 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.706 | L2-Norm(final)=11.451 | 4827.5 samples/s | 75.4 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01979 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.716 | L2-Norm(final)=11.453 | 4812.8 samples/s | 75.2 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01900 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.724 | L2-Norm(final)=11.455 | 5004.7 samples/s | 78.2 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01832 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.733 | L2-Norm(final)=11.458 | 2594.4 samples/s | 40.5 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01773 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.740 | L2-Norm(final)=11.461 | 4852.9 samples/s | 75.8 steps/s
[Step=9650 Epoch=47.1] | Loss=0.01726 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.747 | L2-Norm(final)=11.463 | 4897.8 samples/s | 76.5 steps/s
[Step=9700 Epoch=47.3] | Loss=0.01691 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.754 | L2-Norm(final)=11.465 | 4878.7 samples/s | 76.2 steps/s
[Step=9750 Epoch=47.5] | Loss=0.01644 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.760 | L2-Norm(final)=11.467 | 2619.5 samples/s | 40.9 steps/s
[Step=9800 Epoch=47.8] | Loss=0.01598 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.766 | L2-Norm(final)=11.469 | 4843.3 samples/s | 75.7 steps/s
[Step=9850 Epoch=48.0] | Loss=0.01561 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.772 | L2-Norm(final)=11.471 | 4884.9 samples/s | 76.3 steps/s
[Step=9900 Epoch=48.3] | Loss=0.01533 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.778 | L2-Norm(final)=11.473 | 4872.7 samples/s | 76.1 steps/s
[Step=9950 Epoch=48.5] | Loss=0.01505 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.784 | L2-Norm(final)=11.475 | 2651.3 samples/s | 41.4 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01473 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.790 | L2-Norm(final)=11.477 | 4851.2 samples/s | 75.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step10000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=58.9] | Loss=0.14132 | Reg=0.00150 | acc=0.8906 | L2-Norm=12.233 | L2-Norm(final)=11.813 | 5715.1 samples/s | 89.3 steps/s
[Step=12050 Epoch=59.1] | Loss=0.11551 | Reg=0.00150 | acc=0.9219 | L2-Norm=12.239 | L2-Norm(final)=11.856 | 4867.4 samples/s | 76.1 steps/s
[Step=12100 Epoch=59.3] | Loss=0.11692 | Reg=0.00150 | acc=0.8594 | L2-Norm=12.240 | L2-Norm(final)=11.899 | 5579.4 samples/s | 87.2 steps/s
[Step=12150 Epoch=59.6] | Loss=0.11322 | Reg=0.00150 | acc=0.9219 | L2-Norm=12.241 | L2-Norm(final)=11.936 | 5882.3 samples/s | 91.9 steps/s
[Step=12200 Epoch=59.8] | Loss=0.11228 | Reg=0.00150 | acc=0.9062 | L2-Norm=12.241 | L2-Norm(final)=11.968 | 8467.4 samples/s | 132.3 steps/s
[Step=12250 Epoch=60.1] | Loss=0.11323 | Reg=0.00150 | acc=0.9062 | L2-Norm=12.241 | L2-Norm(final)=11.997 | 2448.0 samples/s | 38.3 steps/s
[Step=12300 Epoch=60.3] | Loss=0.11320 | Reg=0.00150 | acc=0.9219 | L2-Norm=12.241 | L2-Norm(final)=12.022 | 5510.2 samples/s | 86.1 steps/s
[Step=12350 Epoch=60.6] | Loss=0.11097 | Reg=0.00150 | acc=0.9062 | L2-Norm=12.241 | L2-Norm(final)=12.046 | 5837.2 samples/s | 91.2 steps/s
[Step=12400 Epoch=60.8] | Loss=0.10994 | Reg=0.00150 | acc=0.8281 | L2-Norm=12.241 | L2-Norm(final)=12.073 | 7878.3 samples/s | 123.1 steps/s
[Step=12450 Epoch=61.1] | Loss=0.10906 | Reg=0.00150 | acc=0.8906 | L2-Norm=12.241 | L2-Norm(final)=12.100 | 2443.4 samples/s | 38.2 steps/s
[Step=12500 Epoch=61.3] | Loss=0.10806 | Reg=0.00150 | acc=0.9531 | L2-Norm=12.241 | L2-Norm(final)=12.127 | 5583.3 samples/s | 87.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=61.3] | Loss=0.13877 | Reg=0.00150 | acc=0.8750 | L2-Norm=12.241 | L2-Norm(final)=12.401 | 6016.5 samples/s | 94.0 steps/s
[Step=12550 Epoch=61.5] | Loss=0.07051 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=12.418 | 4343.7 samples/s | 67.9 steps/s
[Step=12600 Epoch=61.8] | Loss=0.05898 | Reg=0.00153 | acc=0.9531 | L2-Norm=12.386 | L2-Norm(final)=12.418 | 4809.6 samples/s | 75.2 steps/s
[Step=12650 Epoch=62.0] | Loss=0.05267 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.430 | L2-Norm(final)=12.417 | 4830.2 samples/s | 75.5 steps/s
[Step=12700 Epoch=62.3] | Loss=0.04866 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.467 | L2-Norm(final)=12.416 | 7157.8 samples/s | 111.8 steps/s
[Step=12750 Epoch=62.5] | Loss=0.04274 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.500 | L2-Norm(final)=12.418 | 2270.9 samples/s | 35.5 steps/s
[Step=12800 Epoch=62.8] | Loss=0.03846 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=12.421 | 4906.9 samples/s | 76.7 steps/s
[Step=12850 Epoch=63.0] | Loss=0.03512 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=12.423 | 4850.5 samples/s | 75.8 steps/s
[Step=12900 Epoch=63.3] | Loss=0.03288 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=12.426 | 6576.2 samples/s | 102.8 steps/s
[Step=12950 Epoch=63.5] | Loss=0.03048 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.596 | L2-Norm(final)=12.428 | 2295.1 samples/s | 35.9 steps/s
[Step=13000 Epoch=63.7] | Loss=0.02836 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.614 | L2-Norm(final)=12.430 | 4855.7 samples/s | 75.9 steps/s
[Step=13050 Epoch=64.0] | Loss=0.02686 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.629 | L2-Norm(final)=12.432 | 4829.5 samples/s | 75.5 steps/s
[Step=13100 Epoch=64.2] | Loss=0.02565 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.642 | L2-Norm(final)=12.434 | 6326.3 samples/s | 98.8 steps/s
[Step=13150 Epoch=64.5] | Loss=0.02437 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.655 | L2-Norm(final)=12.436 | 2340.3 samples/s | 36.6 steps/s
[Step=13200 Epoch=64.7] | Loss=0.02331 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.666 | L2-Norm(final)=12.438 | 4789.8 samples/s | 74.8 steps/s
[Step=13250 Epoch=65.0] | Loss=0.02234 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.676 | L2-Norm(final)=12.439 | 4862.1 samples/s | 76.0 steps/s
[Step=13300 Epoch=65.2] | Loss=0.02138 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.685 | L2-Norm(final)=12.441 | 5939.3 samples/s | 92.8 steps/s
[Step=13350 Epoch=65.5] | Loss=0.02050 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.693 | L2-Norm(final)=12.442 | 2396.9 samples/s | 37.5 steps/s
[Step=13400 Epoch=65.7] | Loss=0.01975 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.701 | L2-Norm(final)=12.444 | 4815.0 samples/s | 75.2 steps/s
[Step=13450 Epoch=66.0] | Loss=0.01904 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.709 | L2-Norm(final)=12.446 | 4871.6 samples/s | 76.1 steps/s
[Step=13500 Epoch=66.2] | Loss=0.01838 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=12.447 | 5626.0 samples/s | 87.9 steps/s
[Step=13550 Epoch=66.4] | Loss=0.01785 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.722 | L2-Norm(final)=12.449 | 2472.0 samples/s | 38.6 steps/s
[Step=13600 Epoch=66.7] | Loss=0.01731 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.728 | L2-Norm(final)=12.450 | 4843.3 samples/s | 75.7 steps/s
[Step=13650 Epoch=66.9] | Loss=0.01669 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.734 | L2-Norm(final)=12.452 | 4879.0 samples/s | 76.2 steps/s
[Step=13700 Epoch=67.2] | Loss=0.01633 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.738 | L2-Norm(final)=12.454 | 5307.8 samples/s | 82.9 steps/s
[Step=13750 Epoch=67.4] | Loss=0.01586 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.743 | L2-Norm(final)=12.455 | 2550.7 samples/s | 39.9 steps/s
[Step=13800 Epoch=67.7] | Loss=0.01542 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.747 | L2-Norm(final)=12.457 | 4768.7 samples/s | 74.5 steps/s
[Step=13850 Epoch=67.9] | Loss=0.01506 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.751 | L2-Norm(final)=12.458 | 4916.5 samples/s | 76.8 steps/s
[Step=13900 Epoch=68.2] | Loss=0.01465 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.754 | L2-Norm(final)=12.460 | 5007.4 samples/s | 78.2 steps/s
[Step=13950 Epoch=68.4] | Loss=0.01428 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=12.461 | 2563.0 samples/s | 40.0 steps/s
[Step=14000 Epoch=68.7] | Loss=0.01397 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.760 | L2-Norm(final)=12.463 | 4809.7 samples/s | 75.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step14000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=114.2] | Loss=0.05163 | Reg=0.00150 | acc=0.9531 | L2-Norm=12.233 | L2-Norm(final)=10.876 | 5195.5 samples/s | 81.2 steps/s
[Step=12050 Epoch=114.6] | Loss=0.03915 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=10.881 | 4936.5 samples/s | 77.1 steps/s
[Step=12100 Epoch=115.1] | Loss=0.03340 | Reg=0.00150 | acc=0.9375 | L2-Norm=12.229 | L2-Norm(final)=10.900 | 8331.8 samples/s | 130.2 steps/s
[Step=12150 Epoch=115.6] | Loss=0.03184 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.229 | L2-Norm(final)=10.926 | 2349.7 samples/s | 36.7 steps/s
[Step=12200 Epoch=116.1] | Loss=0.02915 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.229 | L2-Norm(final)=10.957 | 7210.8 samples/s | 112.7 steps/s
[Step=12250 Epoch=116.5] | Loss=0.02769 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=10.992 | 2402.8 samples/s | 37.5 steps/s
[Step=12300 Epoch=117.0] | Loss=0.02635 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.229 | L2-Norm(final)=11.030 | 6635.3 samples/s | 103.7 steps/s
[Step=12350 Epoch=117.5] | Loss=0.02529 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=11.073 | 2531.0 samples/s | 39.5 steps/s
[Step=12400 Epoch=118.0] | Loss=0.02436 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=11.120 | 5998.2 samples/s | 93.7 steps/s
[Step=12450 Epoch=118.4] | Loss=0.02329 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=11.168 | 2634.6 samples/s | 41.2 steps/s
[Step=12500 Epoch=118.9] | Loss=0.02272 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=11.218 | 5364.0 samples/s | 83.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=118.9] | Loss=0.00921 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=11.728 | 5709.8 samples/s | 89.2 steps/s
[Step=12550 Epoch=119.4] | Loss=0.00448 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.302 | L2-Norm(final)=11.766 | 4154.6 samples/s | 64.9 steps/s
[Step=12600 Epoch=119.9] | Loss=0.00474 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.346 | L2-Norm(final)=11.775 | 6704.9 samples/s | 104.8 steps/s
[Step=12650 Epoch=120.3] | Loss=0.00386 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=11.775 | 2222.0 samples/s | 34.7 steps/s
[Step=12700 Epoch=120.8] | Loss=0.00293 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.415 | L2-Norm(final)=11.776 | 5974.1 samples/s | 93.3 steps/s
[Step=12750 Epoch=121.3] | Loss=0.00235 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=11.778 | 2272.7 samples/s | 35.5 steps/s
[Step=12800 Epoch=121.8] | Loss=0.00196 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.417 | L2-Norm(final)=11.779 | 5598.0 samples/s | 87.5 steps/s
[Step=12850 Epoch=122.2] | Loss=0.00168 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.408 | L2-Norm(final)=11.780 | 2362.8 samples/s | 36.9 steps/s
[Step=12900 Epoch=122.7] | Loss=0.00147 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.396 | L2-Norm(final)=11.781 | 5125.4 samples/s | 80.1 steps/s
[Step=12950 Epoch=123.2] | Loss=0.00131 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.382 | L2-Norm(final)=11.782 | 2445.7 samples/s | 38.2 steps/s
[Step=13000 Epoch=123.7] | Loss=0.00118 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.367 | L2-Norm(final)=11.782 | 4736.1 samples/s | 74.0 steps/s
[Step=13050 Epoch=124.1] | Loss=0.00107 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.351 | L2-Norm(final)=11.783 | 2584.7 samples/s | 40.4 steps/s
[Step=13100 Epoch=124.6] | Loss=0.00098 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.334 | L2-Norm(final)=11.784 | 4543.0 samples/s | 71.0 steps/s
[Step=13150 Epoch=125.1] | Loss=0.00091 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=11.784 | 2586.4 samples/s | 40.4 steps/s
[Step=13200 Epoch=125.6] | Loss=0.00085 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.300 | L2-Norm(final)=11.785 | 4611.9 samples/s | 72.1 steps/s
[Step=13250 Epoch=126.0] | Loss=0.00079 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=11.786 | 2574.9 samples/s | 40.2 steps/s
[Step=13300 Epoch=126.5] | Loss=0.00074 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=11.786 | 4618.4 samples/s | 72.2 steps/s
[Step=13350 Epoch=127.0] | Loss=0.00070 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.247 | L2-Norm(final)=11.787 | 2654.5 samples/s | 41.5 steps/s
[Step=13400 Epoch=127.5] | Loss=0.00066 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=11.787 | 4380.9 samples/s | 68.5 steps/s
[Step=13450 Epoch=127.9] | Loss=0.00062 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=11.788 | 7004.5 samples/s | 109.4 steps/s
[Step=13500 Epoch=128.4] | Loss=0.00059 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.193 | L2-Norm(final)=11.788 | 2172.2 samples/s | 33.9 steps/s
[Step=13550 Epoch=128.9] | Loss=0.00057 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=11.789 | 6205.0 samples/s | 97.0 steps/s
[Step=13600 Epoch=129.4] | Loss=0.00054 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=11.789 | 2253.8 samples/s | 35.2 steps/s
[Step=13650 Epoch=129.8] | Loss=0.00052 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=11.790 | 5760.5 samples/s | 90.0 steps/s
[Step=13700 Epoch=130.3] | Loss=0.00050 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.121 | L2-Norm(final)=11.790 | 2321.6 samples/s | 36.3 steps/s
[Step=13750 Epoch=130.8] | Loss=0.00048 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.103 | L2-Norm(final)=11.791 | 5258.8 samples/s | 82.2 steps/s
[Step=13800 Epoch=131.3] | Loss=0.00046 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.085 | L2-Norm(final)=11.791 | 2450.2 samples/s | 38.3 steps/s
[Step=13850 Epoch=131.7] | Loss=0.00044 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.067 | L2-Norm(final)=11.792 | 4756.3 samples/s | 74.3 steps/s
[Step=13900 Epoch=132.2] | Loss=0.00043 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.048 | L2-Norm(final)=11.792 | 2518.0 samples/s | 39.3 steps/s
[Step=13950 Epoch=132.7] | Loss=0.00041 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.030 | L2-Norm(final)=11.792 | 4645.4 samples/s | 72.6 steps/s
[Step=14000 Epoch=133.2] | Loss=0.00040 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.012 | L2-Norm(final)=11.793 | 2584.8 samples/s | 40.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step14000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=6001 Epoch=57.3] | Loss=0.05245 | Reg=0.00150 | acc=0.9375 | L2-Norm=12.233 | L2-Norm(final)=10.741 | 5681.2 samples/s | 88.8 steps/s
[Step=6050 Epoch=57.8] | Loss=0.02196 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.229 | L2-Norm(final)=10.750 | 4613.3 samples/s | 72.1 steps/s
[Step=6100 Epoch=58.3] | Loss=0.02059 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.228 | L2-Norm(final)=10.774 | 8528.5 samples/s | 133.3 steps/s
[Step=6150 Epoch=58.7] | Loss=0.01988 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=10.806 | 2355.3 samples/s | 36.8 steps/s
[Step=6200 Epoch=59.2] | Loss=0.01945 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=10.844 | 7453.8 samples/s | 116.5 steps/s
[Step=6250 Epoch=59.7] | Loss=0.01900 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=10.885 | 2393.2 samples/s | 37.4 steps/s
[Step=6300 Epoch=60.2] | Loss=0.01838 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=10.931 | 6998.1 samples/s | 109.3 steps/s
[Step=6350 Epoch=60.6] | Loss=0.01847 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=10.979 | 2487.5 samples/s | 38.9 steps/s
[Step=6400 Epoch=61.1] | Loss=0.01802 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=11.026 | 6303.2 samples/s | 98.5 steps/s
[Step=6450 Epoch=61.6] | Loss=0.01787 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.228 | L2-Norm(final)=11.077 | 2555.1 samples/s | 39.9 steps/s
[Step=6500 Epoch=62.1] | Loss=0.01775 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=11.127 | 5864.6 samples/s | 91.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=6501 Epoch=62.1] | Loss=0.01292 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=11.639 | 5867.4 samples/s | 91.7 steps/s
[Step=6550 Epoch=62.5] | Loss=0.00985 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.349 | L2-Norm(final)=11.664 | 4118.2 samples/s | 64.3 steps/s
[Step=6600 Epoch=63.0] | Loss=0.00657 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=11.674 | 6821.6 samples/s | 106.6 steps/s
[Step=6650 Epoch=63.5] | Loss=0.00449 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.465 | L2-Norm(final)=11.676 | 2187.3 samples/s | 34.2 steps/s
[Step=6700 Epoch=64.0] | Loss=0.00338 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=11.678 | 6186.8 samples/s | 96.7 steps/s
[Step=6750 Epoch=64.5] | Loss=0.00271 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.469 | L2-Norm(final)=11.680 | 2221.6 samples/s | 34.7 steps/s
[Step=6800 Epoch=64.9] | Loss=0.00226 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=11.681 | 5770.3 samples/s | 90.2 steps/s
[Step=6850 Epoch=65.4] | Loss=0.00194 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=11.682 | 2298.8 samples/s | 35.9 steps/s
[Step=6900 Epoch=65.9] | Loss=0.00169 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.420 | L2-Norm(final)=11.683 | 5397.2 samples/s | 84.3 steps/s
[Step=6950 Epoch=66.4] | Loss=0.00151 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.400 | L2-Norm(final)=11.684 | 2363.1 samples/s | 36.9 steps/s
[Step=7000 Epoch=66.8] | Loss=0.00136 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.378 | L2-Norm(final)=11.685 | 5021.5 samples/s | 78.5 steps/s
[Step=7050 Epoch=67.3] | Loss=0.00123 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.356 | L2-Norm(final)=11.686 | 2464.3 samples/s | 38.5 steps/s
[Step=7100 Epoch=67.8] | Loss=0.00113 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.333 | L2-Norm(final)=11.686 | 4711.2 samples/s | 73.6 steps/s
[Step=7150 Epoch=68.3] | Loss=0.00104 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=11.687 | 2528.9 samples/s | 39.5 steps/s
[Step=7200 Epoch=68.8] | Loss=0.00097 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=11.687 | 4711.2 samples/s | 73.6 steps/s
[Step=7250 Epoch=69.2] | Loss=0.00091 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=11.688 | 2541.9 samples/s | 39.7 steps/s
[Step=7300 Epoch=69.7] | Loss=0.00085 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=11.688 | 4649.6 samples/s | 72.6 steps/s
[Step=7350 Epoch=70.2] | Loss=0.00080 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=11.689 | 2560.7 samples/s | 40.0 steps/s
[Step=7400 Epoch=70.7] | Loss=0.00076 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=11.689 | 4609.1 samples/s | 72.0 steps/s
[Step=7450 Epoch=71.1] | Loss=0.00072 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=11.690 | 2571.8 samples/s | 40.2 steps/s
[Step=7500 Epoch=71.6] | Loss=0.00068 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=11.690 | 4603.6 samples/s | 71.9 steps/s
[Step=7550 Epoch=72.1] | Loss=0.00065 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.129 | L2-Norm(final)=11.690 | 7474.0 samples/s | 116.8 steps/s
[Step=7600 Epoch=72.6] | Loss=0.00062 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=11.691 | 2143.7 samples/s | 33.5 steps/s
[Step=7650 Epoch=73.1] | Loss=0.00059 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.084 | L2-Norm(final)=11.691 | 6766.7 samples/s | 105.7 steps/s
[Step=7700 Epoch=73.5] | Loss=0.00057 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.061 | L2-Norm(final)=11.692 | 2180.2 samples/s | 34.1 steps/s
[Step=7750 Epoch=74.0] | Loss=0.00054 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.039 | L2-Norm(final)=11.692 | 6307.7 samples/s | 98.6 steps/s
[Step=7800 Epoch=74.5] | Loss=0.00052 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.017 | L2-Norm(final)=11.692 | 2236.5 samples/s | 34.9 steps/s
[Step=7850 Epoch=75.0] | Loss=0.00050 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.994 | L2-Norm(final)=11.693 | 5789.6 samples/s | 90.5 steps/s
[Step=7900 Epoch=75.4] | Loss=0.00049 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=11.693 | 2320.6 samples/s | 36.3 steps/s
[Step=7950 Epoch=75.9] | Loss=0.00047 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.950 | L2-Norm(final)=11.693 | 5348.7 samples/s | 83.6 steps/s
[Step=8000 Epoch=76.4] | Loss=0.00045 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.928 | L2-Norm(final)=11.694 | 2374.2 samples/s | 37.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.14161 | acc=0.9357 | tpr=0.9385 | fpr=0.0704 | 5552.7 samples/s | 21.7 steps/s
Avg test loss: 0.14717, Avg test acc: 0.93613, Avg tpr: 0.93868, Avg fpr: 0.06948, total FA: 542

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.16510 | acc=0.9410 | tpr=0.9707 | fpr=0.1234 | 5542.3 samples/s | 21.6 steps/s
Avg test loss: 0.16612, Avg test acc: 0.93994, Avg tpr: 0.97062, Avg fpr: 0.12755, total FA: 995

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.13561 | acc=0.9513 | tpr=0.9735 | fpr=0.0971 | 5729.5 samples/s | 22.4 steps/s
Avg test loss: 0.13634, Avg test acc: 0.95060, Avg tpr: 0.97266, Avg fpr: 0.09794, total FA: 764

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10274 | acc=0.9544 | tpr=0.9716 | fpr=0.0830 | 5787.0 samples/s | 22.6 steps/s
Avg test loss: 0.11262, Avg test acc: 0.95232, Avg tpr: 0.97103, Avg fpr: 0.08883, total FA: 693

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11375 | acc=0.9536 | tpr=0.9691 | fpr=0.0800 | 5824.0 samples/s | 22.8 steps/s
Avg test loss: 0.11593, Avg test acc: 0.95304, Avg tpr: 0.96794, Avg fpr: 0.07973, total FA: 622

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.13353 | acc=0.3170 | tpr=0.0177 | fpr=0.0330 | 5795.8 samples/s | 22.6 steps/s
Avg test loss: 5.15930, Avg test acc: 0.31441, Avg tpr: 0.01749, Avg fpr: 0.03256, total FA: 254

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.61288 | acc=0.2941 | tpr=0.0064 | fpr=0.0813 | 5793.6 samples/s | 22.6 steps/s
Avg test loss: 4.63156, Avg test acc: 0.29141, Avg tpr: 0.00606, Avg fpr: 0.08102, total FA: 632

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.95794 | acc=0.2808 | tpr=0.0204 | fpr=0.1539 | 5720.4 samples/s | 22.3 steps/s
Avg test loss: 4.97168, Avg test acc: 0.27947, Avg tpr: 0.02057, Avg fpr: 0.15113, total FA: 1179

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.98545 | acc=0.3105 | tpr=0.0105 | fpr=0.0382 | 5583.5 samples/s | 21.8 steps/s
Avg test loss: 4.99934, Avg test acc: 0.30916, Avg tpr: 0.01113, Avg fpr: 0.03538, total FA: 276

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.57047 | acc=0.3111 | tpr=0.0114 | fpr=0.0382 | 5536.1 samples/s | 21.6 steps/s
Avg test loss: 4.58502, Avg test acc: 0.30916, Avg tpr: 0.01125, Avg fpr: 0.03564, total FA: 278

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.24717 | acc=0.1779 | tpr=0.3628 | fpr=0.8254 | 5759.0 samples/s | 22.5 steps/s
[Step= 100] | Loss=4.21491 | acc=0.1777 | tpr=0.3028 | fpr=0.8247 | 8017.5 samples/s | 31.3 steps/s
[Step= 150] | Loss=4.22621 | acc=0.1774 | tpr=0.3314 | fpr=0.8254 | 7794.4 samples/s | 30.4 steps/s
[Step= 200] | Loss=4.21964 | acc=0.1773 | tpr=0.3202 | fpr=0.8253 | 7917.3 samples/s | 30.9 steps/s
[Step= 250] | Loss=4.22164 | acc=0.1774 | tpr=0.3301 | fpr=0.8254 | 7923.1 samples/s | 30.9 steps/s
[Step= 300] | Loss=4.22144 | acc=0.1774 | tpr=0.3367 | fpr=0.8255 | 8488.6 samples/s | 33.2 steps/s
[Step= 350] | Loss=4.21728 | acc=0.1767 | tpr=0.3231 | fpr=0.8259 | 7779.1 samples/s | 30.4 steps/s
[Step= 400] | Loss=4.21677 | acc=0.1771 | tpr=0.3239 | fpr=0.8255 | 8112.5 samples/s | 31.7 steps/s
[Step= 450] | Loss=4.21920 | acc=0.1771 | tpr=0.3223 | fpr=0.8256 | 8225.8 samples/s | 32.1 steps/s
[Step= 500] | Loss=4.21839 | acc=0.1772 | tpr=0.3256 | fpr=0.8254 | 7824.9 samples/s | 30.6 steps/s
[Step= 550] | Loss=4.21808 | acc=0.1770 | tpr=0.3243 | fpr=0.8257 | 10140.4 samples/s | 39.6 steps/s
Avg test loss: 4.21820, Avg test acc: 0.17692, Avg tpr: 0.32369, Avg fpr: 0.82574, total FA: 114653

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.77168 | acc=0.0966 | tpr=0.5531 | fpr=0.9116 | 5678.9 samples/s | 22.2 steps/s
[Step= 100] | Loss=6.72891 | acc=0.0952 | tpr=0.4883 | fpr=0.9122 | 8078.3 samples/s | 31.6 steps/s
[Step= 150] | Loss=6.74013 | acc=0.0957 | tpr=0.4942 | fpr=0.9117 | 8182.5 samples/s | 32.0 steps/s
[Step= 200] | Loss=6.73804 | acc=0.0948 | tpr=0.4874 | fpr=0.9123 | 8124.9 samples/s | 31.7 steps/s
[Step= 250] | Loss=6.73882 | acc=0.0958 | tpr=0.4969 | fpr=0.9116 | 8311.4 samples/s | 32.5 steps/s
[Step= 300] | Loss=6.73803 | acc=0.0957 | tpr=0.4975 | fpr=0.9116 | 7295.8 samples/s | 28.5 steps/s
[Step= 350] | Loss=6.73940 | acc=0.0954 | tpr=0.4840 | fpr=0.9117 | 8037.8 samples/s | 31.4 steps/s
[Step= 400] | Loss=6.73441 | acc=0.0959 | tpr=0.4874 | fpr=0.9112 | 8475.1 samples/s | 33.1 steps/s
[Step= 450] | Loss=6.73582 | acc=0.0963 | tpr=0.4883 | fpr=0.9108 | 8099.2 samples/s | 31.6 steps/s
[Step= 500] | Loss=6.74138 | acc=0.0959 | tpr=0.4828 | fpr=0.9110 | 8482.1 samples/s | 33.1 steps/s
[Step= 550] | Loss=6.73916 | acc=0.0958 | tpr=0.4799 | fpr=0.9112 | 9335.1 samples/s | 36.5 steps/s
Avg test loss: 6.74011, Avg test acc: 0.09566, Avg tpr: 0.47940, Avg fpr: 0.91131, total FA: 126534

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.65457 | acc=0.1152 | tpr=0.3230 | fpr=0.8885 | 5798.2 samples/s | 22.6 steps/s
[Step= 100] | Loss=6.59880 | acc=0.1138 | tpr=0.2942 | fpr=0.8896 | 8005.9 samples/s | 31.3 steps/s
[Step= 150] | Loss=6.60356 | acc=0.1121 | tpr=0.2810 | fpr=0.8911 | 8104.3 samples/s | 31.7 steps/s
[Step= 200] | Loss=6.59455 | acc=0.1124 | tpr=0.2765 | fpr=0.8906 | 7932.4 samples/s | 31.0 steps/s
[Step= 250] | Loss=6.59522 | acc=0.1123 | tpr=0.2830 | fpr=0.8908 | 7995.0 samples/s | 31.2 steps/s
[Step= 300] | Loss=6.59654 | acc=0.1114 | tpr=0.2807 | fpr=0.8917 | 7811.9 samples/s | 30.5 steps/s
[Step= 350] | Loss=6.60566 | acc=0.1108 | tpr=0.2724 | fpr=0.8921 | 8274.7 samples/s | 32.3 steps/s
[Step= 400] | Loss=6.59931 | acc=0.1116 | tpr=0.2746 | fpr=0.8914 | 7632.7 samples/s | 29.8 steps/s
[Step= 450] | Loss=6.60057 | acc=0.1114 | tpr=0.2726 | fpr=0.8916 | 8730.1 samples/s | 34.1 steps/s
[Step= 500] | Loss=6.60169 | acc=0.1113 | tpr=0.2749 | fpr=0.8917 | 8067.4 samples/s | 31.5 steps/s
[Step= 550] | Loss=6.59925 | acc=0.1113 | tpr=0.2734 | fpr=0.8916 | 9441.0 samples/s | 36.9 steps/s
Avg test loss: 6.59862, Avg test acc: 0.11129, Avg tpr: 0.27338, Avg fpr: 0.89166, total FA: 123805

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.30979 | acc=0.1448 | tpr=0.2965 | fpr=0.8580 | 5780.0 samples/s | 22.6 steps/s
[Step= 100] | Loss=5.28070 | acc=0.1433 | tpr=0.2473 | fpr=0.8586 | 7628.3 samples/s | 29.8 steps/s
[Step= 150] | Loss=5.28238 | acc=0.1427 | tpr=0.2392 | fpr=0.8590 | 8104.4 samples/s | 31.7 steps/s
[Step= 200] | Loss=5.27338 | acc=0.1422 | tpr=0.2339 | fpr=0.8594 | 8689.7 samples/s | 33.9 steps/s
[Step= 250] | Loss=5.27734 | acc=0.1425 | tpr=0.2332 | fpr=0.8591 | 8109.4 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.27863 | acc=0.1418 | tpr=0.2385 | fpr=0.8600 | 7822.2 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.27878 | acc=0.1413 | tpr=0.2329 | fpr=0.8604 | 7738.1 samples/s | 30.2 steps/s
[Step= 400] | Loss=5.27077 | acc=0.1420 | tpr=0.2396 | fpr=0.8598 | 7984.5 samples/s | 31.2 steps/s
[Step= 450] | Loss=5.27029 | acc=0.1426 | tpr=0.2425 | fpr=0.8592 | 8551.7 samples/s | 33.4 steps/s
[Step= 500] | Loss=5.27139 | acc=0.1423 | tpr=0.2441 | fpr=0.8595 | 7712.2 samples/s | 30.1 steps/s
[Step= 550] | Loss=5.26896 | acc=0.1422 | tpr=0.2431 | fpr=0.8596 | 9408.4 samples/s | 36.8 steps/s
Avg test loss: 5.26908, Avg test acc: 0.14214, Avg tpr: 0.24406, Avg fpr: 0.85971, total FA: 119369

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.12127 | acc=0.1247 | tpr=0.2257 | fpr=0.8771 | 5450.8 samples/s | 21.3 steps/s
[Step= 100] | Loss=6.08185 | acc=0.1252 | tpr=0.2175 | fpr=0.8765 | 8783.1 samples/s | 34.3 steps/s
[Step= 150] | Loss=6.09436 | acc=0.1250 | tpr=0.1988 | fpr=0.8763 | 7959.8 samples/s | 31.1 steps/s
[Step= 200] | Loss=6.08666 | acc=0.1251 | tpr=0.1869 | fpr=0.8760 | 8039.3 samples/s | 31.4 steps/s
[Step= 250] | Loss=6.09509 | acc=0.1253 | tpr=0.1878 | fpr=0.8758 | 8004.0 samples/s | 31.3 steps/s
[Step= 300] | Loss=6.09600 | acc=0.1249 | tpr=0.1855 | fpr=0.8762 | 8105.4 samples/s | 31.7 steps/s
[Step= 350] | Loss=6.09864 | acc=0.1247 | tpr=0.1766 | fpr=0.8763 | 7327.5 samples/s | 28.6 steps/s
[Step= 400] | Loss=6.09374 | acc=0.1254 | tpr=0.1794 | fpr=0.8756 | 8355.7 samples/s | 32.6 steps/s
[Step= 450] | Loss=6.09380 | acc=0.1256 | tpr=0.1821 | fpr=0.8755 | 8217.4 samples/s | 32.1 steps/s
[Step= 500] | Loss=6.09460 | acc=0.1255 | tpr=0.1819 | fpr=0.8756 | 8275.4 samples/s | 32.3 steps/s
[Step= 550] | Loss=6.09123 | acc=0.1258 | tpr=0.1807 | fpr=0.8752 | 9877.4 samples/s | 38.6 steps/s
Avg test loss: 6.09025, Avg test acc: 0.12578, Avg tpr: 0.18067, Avg fpr: 0.87522, total FA: 121522

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12876 | acc=0.9804 | tpr=0.8805 | fpr=0.0178 | 5496.9 samples/s | 21.5 steps/s
[Step= 100] | Loss=0.13437 | acc=0.9795 | tpr=0.9041 | fpr=0.0191 | 8255.5 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.13912 | acc=0.9786 | tpr=0.9107 | fpr=0.0202 | 7975.2 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.14151 | acc=0.9785 | tpr=0.9191 | fpr=0.0204 | 7841.0 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.14156 | acc=0.9787 | tpr=0.9118 | fpr=0.0201 | 7761.9 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.14365 | acc=0.9784 | tpr=0.9098 | fpr=0.0204 | 8418.4 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.14478 | acc=0.9782 | tpr=0.9098 | fpr=0.0206 | 8210.5 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.14577 | acc=0.9780 | tpr=0.9065 | fpr=0.0207 | 8541.9 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.14821 | acc=0.9778 | tpr=0.9056 | fpr=0.0209 | 7442.2 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.14713 | acc=0.9778 | tpr=0.9075 | fpr=0.0210 | 8123.8 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.14656 | acc=0.9778 | tpr=0.9053 | fpr=0.0208 | 10920.2 samples/s | 42.7 steps/s
Avg test loss: 0.14622, Avg test acc: 0.97786, Avg tpr: 0.90491, Avg fpr: 0.02081, total FA: 2890

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09454 | acc=0.9812 | tpr=0.8717 | fpr=0.0169 | 5652.4 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.09749 | acc=0.9809 | tpr=0.8763 | fpr=0.0172 | 8208.4 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.10090 | acc=0.9804 | tpr=0.8919 | fpr=0.0180 | 8090.7 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.10234 | acc=0.9805 | tpr=0.8929 | fpr=0.0179 | 7858.2 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.10236 | acc=0.9806 | tpr=0.8926 | fpr=0.0178 | 8014.1 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.10340 | acc=0.9805 | tpr=0.8931 | fpr=0.0179 | 7948.1 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.10387 | acc=0.9804 | tpr=0.8961 | fpr=0.0180 | 7699.6 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.10469 | acc=0.9803 | tpr=0.8928 | fpr=0.0182 | 8050.7 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.10591 | acc=0.9801 | tpr=0.8900 | fpr=0.0182 | 8502.2 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.10498 | acc=0.9803 | tpr=0.8930 | fpr=0.0181 | 8549.6 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.10392 | acc=0.9804 | tpr=0.8930 | fpr=0.0180 | 9557.9 samples/s | 37.3 steps/s
Avg test loss: 0.10372, Avg test acc: 0.98038, Avg tpr: 0.89184, Avg fpr: 0.01801, total FA: 2501

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12467 | acc=0.9727 | tpr=0.9204 | fpr=0.0263 | 5729.5 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.12853 | acc=0.9728 | tpr=0.9275 | fpr=0.0263 | 8131.1 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.13275 | acc=0.9724 | tpr=0.9352 | fpr=0.0269 | 7286.7 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.13465 | acc=0.9725 | tpr=0.9388 | fpr=0.0268 | 8616.0 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.13532 | acc=0.9727 | tpr=0.9380 | fpr=0.0267 | 8576.8 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.13652 | acc=0.9727 | tpr=0.9367 | fpr=0.0267 | 7667.8 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.13596 | acc=0.9727 | tpr=0.9368 | fpr=0.0266 | 7938.6 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.13709 | acc=0.9725 | tpr=0.9354 | fpr=0.0269 | 7946.4 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.13822 | acc=0.9723 | tpr=0.9343 | fpr=0.0270 | 8517.9 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.13745 | acc=0.9723 | tpr=0.9366 | fpr=0.0270 | 7682.9 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.13649 | acc=0.9725 | tpr=0.9359 | fpr=0.0268 | 10510.5 samples/s | 41.1 steps/s
Avg test loss: 0.13626, Avg test acc: 0.97251, Avg tpr: 0.93621, Avg fpr: 0.02683, total FA: 3725

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11454 | acc=0.9789 | tpr=0.9204 | fpr=0.0200 | 5631.6 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.12055 | acc=0.9792 | tpr=0.9296 | fpr=0.0199 | 8284.0 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.12623 | acc=0.9784 | tpr=0.9323 | fpr=0.0208 | 7441.2 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.12767 | acc=0.9787 | tpr=0.9333 | fpr=0.0205 | 7826.8 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.12676 | acc=0.9786 | tpr=0.9231 | fpr=0.0203 | 8073.4 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.12838 | acc=0.9786 | tpr=0.9229 | fpr=0.0204 | 8489.8 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.12825 | acc=0.9785 | tpr=0.9230 | fpr=0.0205 | 8370.8 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.12925 | acc=0.9783 | tpr=0.9207 | fpr=0.0207 | 7893.6 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.13090 | acc=0.9781 | tpr=0.9182 | fpr=0.0208 | 8058.9 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.13023 | acc=0.9781 | tpr=0.9203 | fpr=0.0209 | 8143.1 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.12959 | acc=0.9782 | tpr=0.9200 | fpr=0.0208 | 10225.8 samples/s | 39.9 steps/s
Avg test loss: 0.12942, Avg test acc: 0.97816, Avg tpr: 0.91957, Avg fpr: 0.02077, total FA: 2884

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.09641 | acc=0.9782 | tpr=0.8850 | fpr=0.0201 | 5855.9 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.09849 | acc=0.9784 | tpr=0.9083 | fpr=0.0203 | 7408.0 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.10275 | acc=0.9773 | tpr=0.9135 | fpr=0.0215 | 7913.4 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.10264 | acc=0.9778 | tpr=0.9137 | fpr=0.0210 | 7831.3 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.10226 | acc=0.9775 | tpr=0.9100 | fpr=0.0212 | 8456.8 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.10394 | acc=0.9774 | tpr=0.9076 | fpr=0.0213 | 8670.5 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.10538 | acc=0.9771 | tpr=0.9086 | fpr=0.0216 | 8504.0 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.10575 | acc=0.9771 | tpr=0.9054 | fpr=0.0216 | 7545.9 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.10713 | acc=0.9768 | tpr=0.9017 | fpr=0.0218 | 7648.4 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.10665 | acc=0.9768 | tpr=0.9026 | fpr=0.0219 | 8484.6 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.10595 | acc=0.9768 | tpr=0.9033 | fpr=0.0219 | 10021.6 samples/s | 39.1 steps/s
Avg test loss: 0.10576, Avg test acc: 0.97680, Avg tpr: 0.90254, Avg fpr: 0.02185, total FA: 3034

server round 11/50

clients selected: [0 2 3 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=6001 Epoch=29.3] | Loss=0.09438 | Reg=0.00143 | acc=0.9219 | L2-Norm=11.948 | L2-Norm(final)=9.739 | 6119.4 samples/s | 95.6 steps/s
[Step=6050 Epoch=29.5] | Loss=0.09413 | Reg=0.00143 | acc=0.9531 | L2-Norm=11.952 | L2-Norm(final)=9.767 | 4857.3 samples/s | 75.9 steps/s
[Step=6100 Epoch=29.7] | Loss=0.09177 | Reg=0.00143 | acc=0.9219 | L2-Norm=11.952 | L2-Norm(final)=9.806 | 5567.1 samples/s | 87.0 steps/s
[Step=6150 Epoch=30.0] | Loss=0.08926 | Reg=0.00143 | acc=0.9219 | L2-Norm=11.952 | L2-Norm(final)=9.851 | 5696.0 samples/s | 89.0 steps/s
[Step=6200 Epoch=30.2] | Loss=0.08742 | Reg=0.00143 | acc=0.8594 | L2-Norm=11.953 | L2-Norm(final)=9.905 | 8614.6 samples/s | 134.6 steps/s
[Step=6250 Epoch=30.5] | Loss=0.08607 | Reg=0.00143 | acc=0.9375 | L2-Norm=11.953 | L2-Norm(final)=9.959 | 2445.3 samples/s | 38.2 steps/s
[Step=6300 Epoch=30.7] | Loss=0.08595 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.953 | L2-Norm(final)=10.012 | 5734.6 samples/s | 89.6 steps/s
[Step=6350 Epoch=31.0] | Loss=0.08589 | Reg=0.00143 | acc=0.9375 | L2-Norm=11.953 | L2-Norm(final)=10.063 | 5502.0 samples/s | 86.0 steps/s
[Step=6400 Epoch=31.2] | Loss=0.08598 | Reg=0.00143 | acc=0.8906 | L2-Norm=11.953 | L2-Norm(final)=10.114 | 7806.2 samples/s | 122.0 steps/s
[Step=6450 Epoch=31.5] | Loss=0.08503 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.953 | L2-Norm(final)=10.163 | 2496.4 samples/s | 39.0 steps/s
[Step=6500 Epoch=31.7] | Loss=0.08482 | Reg=0.00143 | acc=0.9375 | L2-Norm=11.953 | L2-Norm(final)=10.212 | 5817.2 samples/s | 90.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=6501 Epoch=31.7] | Loss=0.10763 | Reg=0.00143 | acc=0.8750 | L2-Norm=11.953 | L2-Norm(final)=10.701 | 5832.9 samples/s | 91.1 steps/s
[Step=6550 Epoch=31.9] | Loss=0.06177 | Reg=0.00145 | acc=0.9531 | L2-Norm=12.048 | L2-Norm(final)=10.724 | 4391.1 samples/s | 68.6 steps/s
[Step=6600 Epoch=32.2] | Loss=0.05583 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.127 | L2-Norm(final)=10.721 | 4855.7 samples/s | 75.9 steps/s
[Step=6650 Epoch=32.4] | Loss=0.05242 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=10.715 | 4894.0 samples/s | 76.5 steps/s
[Step=6700 Epoch=32.7] | Loss=0.05020 | Reg=0.00150 | acc=0.9531 | L2-Norm=12.233 | L2-Norm(final)=10.711 | 6892.6 samples/s | 107.7 steps/s
[Step=6750 Epoch=32.9] | Loss=0.04493 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.278 | L2-Norm(final)=10.710 | 2268.5 samples/s | 35.4 steps/s
[Step=6800 Epoch=33.2] | Loss=0.04035 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.316 | L2-Norm(final)=10.712 | 4884.8 samples/s | 76.3 steps/s
[Step=6850 Epoch=33.4] | Loss=0.03725 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.350 | L2-Norm(final)=10.715 | 4854.2 samples/s | 75.8 steps/s
[Step=6900 Epoch=33.6] | Loss=0.03476 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.380 | L2-Norm(final)=10.718 | 6294.0 samples/s | 98.3 steps/s
[Step=6950 Epoch=33.9] | Loss=0.03192 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.407 | L2-Norm(final)=10.721 | 2366.9 samples/s | 37.0 steps/s
[Step=7000 Epoch=34.1] | Loss=0.03005 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.432 | L2-Norm(final)=10.725 | 4876.1 samples/s | 76.2 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02834 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.453 | L2-Norm(final)=10.729 | 4934.2 samples/s | 77.1 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02673 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.473 | L2-Norm(final)=10.734 | 5738.3 samples/s | 89.7 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02554 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=10.737 | 2466.8 samples/s | 38.5 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02430 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.507 | L2-Norm(final)=10.741 | 4757.0 samples/s | 74.3 steps/s
[Step=7250 Epoch=35.4] | Loss=0.02325 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=10.744 | 4888.8 samples/s | 76.4 steps/s
[Step=7300 Epoch=35.6] | Loss=0.02219 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=10.748 | 5355.5 samples/s | 83.7 steps/s
[Step=7350 Epoch=35.8] | Loss=0.02140 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=10.751 | 2504.5 samples/s | 39.1 steps/s
[Step=7400 Epoch=36.1] | Loss=0.02049 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.561 | L2-Norm(final)=10.754 | 4896.8 samples/s | 76.5 steps/s
[Step=7450 Epoch=36.3] | Loss=0.01976 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.571 | L2-Norm(final)=10.758 | 4894.0 samples/s | 76.5 steps/s
[Step=7500 Epoch=36.6] | Loss=0.01922 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.582 | L2-Norm(final)=10.761 | 4964.0 samples/s | 77.6 steps/s
[Step=7550 Epoch=36.8] | Loss=0.01861 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.591 | L2-Norm(final)=10.764 | 2601.4 samples/s | 40.6 steps/s
[Step=7600 Epoch=37.1] | Loss=0.01805 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.600 | L2-Norm(final)=10.767 | 4870.6 samples/s | 76.1 steps/s
[Step=7650 Epoch=37.3] | Loss=0.01747 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.609 | L2-Norm(final)=10.770 | 4828.6 samples/s | 75.4 steps/s
[Step=7700 Epoch=37.5] | Loss=0.01703 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=10.772 | 4857.3 samples/s | 75.9 steps/s
[Step=7750 Epoch=37.8] | Loss=0.01659 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.624 | L2-Norm(final)=10.775 | 2693.3 samples/s | 42.1 steps/s
[Step=7800 Epoch=38.0] | Loss=0.01614 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.631 | L2-Norm(final)=10.778 | 4754.2 samples/s | 74.3 steps/s
[Step=7850 Epoch=38.3] | Loss=0.01569 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.638 | L2-Norm(final)=10.781 | 4855.0 samples/s | 75.9 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01538 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.645 | L2-Norm(final)=10.783 | 4948.1 samples/s | 77.3 steps/s
[Step=7950 Epoch=38.8] | Loss=0.01500 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=10.786 | 2614.2 samples/s | 40.8 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01467 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.657 | L2-Norm(final)=10.788 | 4864.8 samples/s | 76.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step8000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.08236 | Reg=0.00143 | acc=0.9219 | L2-Norm=11.948 | L2-Norm(final)=10.375 | 5911.3 samples/s | 92.4 steps/s
[Step=12050 Epoch=58.7] | Loss=0.09456 | Reg=0.00143 | acc=0.9531 | L2-Norm=11.948 | L2-Norm(final)=10.413 | 5392.9 samples/s | 84.3 steps/s
[Step=12100 Epoch=59.0] | Loss=0.08938 | Reg=0.00143 | acc=0.9219 | L2-Norm=11.948 | L2-Norm(final)=10.470 | 5562.6 samples/s | 86.9 steps/s
[Step=12150 Epoch=59.2] | Loss=0.08697 | Reg=0.00143 | acc=0.9531 | L2-Norm=11.948 | L2-Norm(final)=10.535 | 5681.1 samples/s | 88.8 steps/s
[Step=12200 Epoch=59.4] | Loss=0.08527 | Reg=0.00143 | acc=0.9219 | L2-Norm=11.948 | L2-Norm(final)=10.603 | 8635.8 samples/s | 134.9 steps/s
[Step=12250 Epoch=59.7] | Loss=0.08646 | Reg=0.00143 | acc=0.9375 | L2-Norm=11.948 | L2-Norm(final)=10.665 | 2475.8 samples/s | 38.7 steps/s
[Step=12300 Epoch=59.9] | Loss=0.08529 | Reg=0.00143 | acc=0.9531 | L2-Norm=11.948 | L2-Norm(final)=10.726 | 5456.1 samples/s | 85.3 steps/s
[Step=12350 Epoch=60.2] | Loss=0.08568 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.948 | L2-Norm(final)=10.785 | 5740.3 samples/s | 89.7 steps/s
[Step=12400 Epoch=60.4] | Loss=0.08541 | Reg=0.00143 | acc=0.9062 | L2-Norm=11.948 | L2-Norm(final)=10.841 | 7680.6 samples/s | 120.0 steps/s
[Step=12450 Epoch=60.7] | Loss=0.08473 | Reg=0.00143 | acc=0.9375 | L2-Norm=11.948 | L2-Norm(final)=10.896 | 2507.1 samples/s | 39.2 steps/s
[Step=12500 Epoch=60.9] | Loss=0.08474 | Reg=0.00143 | acc=0.9062 | L2-Norm=11.948 | L2-Norm(final)=10.952 | 5610.2 samples/s | 87.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=60.9] | Loss=0.10532 | Reg=0.00143 | acc=0.9219 | L2-Norm=11.948 | L2-Norm(final)=11.497 | 5804.5 samples/s | 90.7 steps/s
[Step=12550 Epoch=61.1] | Loss=0.06686 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.074 | L2-Norm(final)=11.517 | 4372.7 samples/s | 68.3 steps/s
[Step=12600 Epoch=61.4] | Loss=0.06051 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=11.507 | 4946.9 samples/s | 77.3 steps/s
[Step=12650 Epoch=61.6] | Loss=0.05465 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.288 | L2-Norm(final)=11.502 | 4771.5 samples/s | 74.6 steps/s
[Step=12700 Epoch=61.9] | Loss=0.05158 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.358 | L2-Norm(final)=11.497 | 6973.7 samples/s | 109.0 steps/s
[Step=12750 Epoch=62.1] | Loss=0.04519 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.413 | L2-Norm(final)=11.497 | 2281.8 samples/s | 35.7 steps/s
[Step=12800 Epoch=62.4] | Loss=0.04073 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=11.500 | 4777.0 samples/s | 74.6 steps/s
[Step=12850 Epoch=62.6] | Loss=0.03725 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=11.503 | 4881.7 samples/s | 76.3 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03490 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=11.506 | 6341.6 samples/s | 99.1 steps/s
[Step=12950 Epoch=63.1] | Loss=0.03205 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=11.510 | 2356.8 samples/s | 36.8 steps/s
[Step=13000 Epoch=63.3] | Loss=0.03004 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.574 | L2-Norm(final)=11.514 | 4871.1 samples/s | 76.1 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02874 | Reg=0.00159 | acc=0.9688 | L2-Norm=12.595 | L2-Norm(final)=11.517 | 4849.8 samples/s | 75.8 steps/s
[Step=13100 Epoch=63.8] | Loss=0.02767 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.616 | L2-Norm(final)=11.519 | 5848.8 samples/s | 91.4 steps/s
[Step=13150 Epoch=64.1] | Loss=0.02631 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.635 | L2-Norm(final)=11.521 | 2471.5 samples/s | 38.6 steps/s
[Step=13200 Epoch=64.3] | Loss=0.02493 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.652 | L2-Norm(final)=11.524 | 4779.3 samples/s | 74.7 steps/s
[Step=13250 Epoch=64.6] | Loss=0.02399 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.668 | L2-Norm(final)=11.527 | 4882.4 samples/s | 76.3 steps/s
[Step=13300 Epoch=64.8] | Loss=0.02294 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=11.530 | 5385.3 samples/s | 84.1 steps/s
[Step=13350 Epoch=65.0] | Loss=0.02195 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.694 | L2-Norm(final)=11.533 | 2490.3 samples/s | 38.9 steps/s
[Step=13400 Epoch=65.3] | Loss=0.02123 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.706 | L2-Norm(final)=11.536 | 4816.6 samples/s | 75.3 steps/s
[Step=13450 Epoch=65.5] | Loss=0.02039 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.718 | L2-Norm(final)=11.539 | 4932.5 samples/s | 77.1 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01972 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.728 | L2-Norm(final)=11.542 | 4946.4 samples/s | 77.3 steps/s
[Step=13550 Epoch=66.0] | Loss=0.01917 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.737 | L2-Norm(final)=11.544 | 2610.6 samples/s | 40.8 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01854 | Reg=0.00163 | acc=0.9688 | L2-Norm=12.746 | L2-Norm(final)=11.547 | 4803.2 samples/s | 75.1 steps/s
[Step=13650 Epoch=66.5] | Loss=0.01793 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.754 | L2-Norm(final)=11.550 | 4884.3 samples/s | 76.3 steps/s
[Step=13700 Epoch=66.8] | Loss=0.01741 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.761 | L2-Norm(final)=11.553 | 4857.4 samples/s | 75.9 steps/s
[Step=13750 Epoch=67.0] | Loss=0.01691 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.768 | L2-Norm(final)=11.556 | 2664.4 samples/s | 41.6 steps/s
[Step=13800 Epoch=67.2] | Loss=0.01651 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.775 | L2-Norm(final)=11.559 | 4836.7 samples/s | 75.6 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01608 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.782 | L2-Norm(final)=11.562 | 4866.9 samples/s | 76.0 steps/s
[Step=13900 Epoch=67.7] | Loss=0.01570 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.787 | L2-Norm(final)=11.565 | 4840.8 samples/s | 75.6 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01533 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.793 | L2-Norm(final)=11.568 | 2660.8 samples/s | 41.6 steps/s
[Step=14000 Epoch=68.2] | Loss=0.01497 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.798 | L2-Norm(final)=11.570 | 4900.6 samples/s | 76.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step14000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=48.8] | Loss=0.07425 | Reg=0.00143 | acc=0.9375 | L2-Norm=11.948 | L2-Norm(final)=11.539 | 5521.3 samples/s | 86.3 steps/s
[Step=10050 Epoch=49.0] | Loss=0.08687 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.949 | L2-Norm(final)=11.548 | 4957.2 samples/s | 77.5 steps/s
[Step=10100 Epoch=49.3] | Loss=0.08994 | Reg=0.00143 | acc=0.9375 | L2-Norm=11.949 | L2-Norm(final)=11.568 | 5575.7 samples/s | 87.1 steps/s
[Step=10150 Epoch=49.5] | Loss=0.08705 | Reg=0.00143 | acc=0.9375 | L2-Norm=11.949 | L2-Norm(final)=11.595 | 5645.2 samples/s | 88.2 steps/s
[Step=10200 Epoch=49.7] | Loss=0.08678 | Reg=0.00143 | acc=0.9219 | L2-Norm=11.949 | L2-Norm(final)=11.629 | 8816.3 samples/s | 137.8 steps/s
[Step=10250 Epoch=50.0] | Loss=0.08609 | Reg=0.00143 | acc=0.9219 | L2-Norm=11.949 | L2-Norm(final)=11.664 | 2485.0 samples/s | 38.8 steps/s
[Step=10300 Epoch=50.2] | Loss=0.08569 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.949 | L2-Norm(final)=11.699 | 5303.7 samples/s | 82.9 steps/s
[Step=10350 Epoch=50.5] | Loss=0.08555 | Reg=0.00143 | acc=0.8906 | L2-Norm=11.949 | L2-Norm(final)=11.736 | 5711.9 samples/s | 89.2 steps/s
[Step=10400 Epoch=50.7] | Loss=0.08573 | Reg=0.00143 | acc=0.9375 | L2-Norm=11.949 | L2-Norm(final)=11.771 | 7625.7 samples/s | 119.2 steps/s
[Step=10450 Epoch=51.0] | Loss=0.08567 | Reg=0.00143 | acc=0.8594 | L2-Norm=11.949 | L2-Norm(final)=11.805 | 2491.8 samples/s | 38.9 steps/s
[Step=10500 Epoch=51.2] | Loss=0.08580 | Reg=0.00143 | acc=0.8906 | L2-Norm=11.949 | L2-Norm(final)=11.837 | 5746.6 samples/s | 89.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=51.2] | Loss=0.07414 | Reg=0.00143 | acc=0.9531 | L2-Norm=11.949 | L2-Norm(final)=12.168 | 5858.8 samples/s | 91.5 steps/s
[Step=10550 Epoch=51.4] | Loss=0.06787 | Reg=0.00146 | acc=0.9375 | L2-Norm=12.071 | L2-Norm(final)=12.180 | 4330.9 samples/s | 67.7 steps/s
[Step=10600 Epoch=51.7] | Loss=0.06117 | Reg=0.00148 | acc=0.9219 | L2-Norm=12.176 | L2-Norm(final)=12.169 | 4856.2 samples/s | 75.9 steps/s
[Step=10650 Epoch=51.9] | Loss=0.05613 | Reg=0.00150 | acc=0.9531 | L2-Norm=12.251 | L2-Norm(final)=12.157 | 4850.9 samples/s | 75.8 steps/s
[Step=10700 Epoch=52.2] | Loss=0.05166 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.311 | L2-Norm(final)=12.151 | 6961.6 samples/s | 108.8 steps/s
[Step=10750 Epoch=52.4] | Loss=0.04530 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.361 | L2-Norm(final)=12.149 | 2253.5 samples/s | 35.2 steps/s
[Step=10800 Epoch=52.7] | Loss=0.04031 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.403 | L2-Norm(final)=12.149 | 4868.1 samples/s | 76.1 steps/s
[Step=10850 Epoch=52.9] | Loss=0.03784 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.438 | L2-Norm(final)=12.151 | 4861.6 samples/s | 76.0 steps/s
[Step=10900 Epoch=53.2] | Loss=0.03610 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.469 | L2-Norm(final)=12.151 | 6344.1 samples/s | 99.1 steps/s
[Step=10950 Epoch=53.4] | Loss=0.03367 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.496 | L2-Norm(final)=12.151 | 2336.7 samples/s | 36.5 steps/s
[Step=11000 Epoch=53.6] | Loss=0.03150 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=12.152 | 4861.0 samples/s | 76.0 steps/s
[Step=11050 Epoch=53.9] | Loss=0.02953 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.539 | L2-Norm(final)=12.153 | 4870.5 samples/s | 76.1 steps/s
[Step=11100 Epoch=54.1] | Loss=0.02796 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.558 | L2-Norm(final)=12.156 | 5791.5 samples/s | 90.5 steps/s
[Step=11150 Epoch=54.4] | Loss=0.02672 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.575 | L2-Norm(final)=12.157 | 2416.4 samples/s | 37.8 steps/s
[Step=11200 Epoch=54.6] | Loss=0.02551 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.590 | L2-Norm(final)=12.159 | 4850.3 samples/s | 75.8 steps/s
[Step=11250 Epoch=54.9] | Loss=0.02444 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.603 | L2-Norm(final)=12.160 | 4879.3 samples/s | 76.2 steps/s
[Step=11300 Epoch=55.1] | Loss=0.02335 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=12.163 | 5391.3 samples/s | 84.2 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02222 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.627 | L2-Norm(final)=12.165 | 2538.8 samples/s | 39.7 steps/s
[Step=11400 Epoch=55.6] | Loss=0.02152 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.637 | L2-Norm(final)=12.167 | 4786.3 samples/s | 74.8 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02074 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.647 | L2-Norm(final)=12.169 | 4871.6 samples/s | 76.1 steps/s
[Step=11500 Epoch=56.1] | Loss=0.01995 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.655 | L2-Norm(final)=12.171 | 4957.9 samples/s | 77.5 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01935 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.664 | L2-Norm(final)=12.173 | 2609.6 samples/s | 40.8 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01867 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.671 | L2-Norm(final)=12.175 | 4844.1 samples/s | 75.7 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01804 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.679 | L2-Norm(final)=12.177 | 4905.5 samples/s | 76.6 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01772 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.685 | L2-Norm(final)=12.179 | 4837.8 samples/s | 75.6 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01729 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=12.181 | 2621.4 samples/s | 41.0 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01681 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=12.183 | 4920.3 samples/s | 76.9 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01640 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.704 | L2-Norm(final)=12.184 | 4816.9 samples/s | 75.3 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01600 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.709 | L2-Norm(final)=12.186 | 4909.4 samples/s | 76.7 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01566 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.714 | L2-Norm(final)=12.188 | 2606.9 samples/s | 40.7 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01528 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.718 | L2-Norm(final)=12.190 | 4906.7 samples/s | 76.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step12000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=8001 Epoch=76.4] | Loss=0.03472 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.948 | L2-Norm(final)=11.705 | 5867.1 samples/s | 91.7 steps/s
[Step=8050 Epoch=76.9] | Loss=0.01307 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.941 | L2-Norm(final)=11.721 | 4487.0 samples/s | 70.1 steps/s
[Step=8100 Epoch=77.4] | Loss=0.01148 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.940 | L2-Norm(final)=11.750 | 8456.1 samples/s | 132.1 steps/s
[Step=8150 Epoch=77.8] | Loss=0.01175 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.940 | L2-Norm(final)=11.792 | 2369.5 samples/s | 37.0 steps/s
[Step=8200 Epoch=78.3] | Loss=0.01128 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.940 | L2-Norm(final)=11.831 | 7137.0 samples/s | 111.5 steps/s
[Step=8250 Epoch=78.8] | Loss=0.01111 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.940 | L2-Norm(final)=11.873 | 2410.6 samples/s | 37.7 steps/s
[Step=8300 Epoch=79.3] | Loss=0.01102 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.940 | L2-Norm(final)=11.915 | 6903.4 samples/s | 107.9 steps/s
[Step=8350 Epoch=79.7] | Loss=0.01086 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.940 | L2-Norm(final)=11.956 | 2495.1 samples/s | 39.0 steps/s
[Step=8400 Epoch=80.2] | Loss=0.01100 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.940 | L2-Norm(final)=11.996 | 6218.9 samples/s | 97.2 steps/s
[Step=8450 Epoch=80.7] | Loss=0.01088 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.939 | L2-Norm(final)=12.037 | 2560.3 samples/s | 40.0 steps/s
[Step=8500 Epoch=81.2] | Loss=0.01092 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.939 | L2-Norm(final)=12.078 | 5865.3 samples/s | 91.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=81.2] | Loss=0.00851 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.939 | L2-Norm(final)=12.487 | 5766.0 samples/s | 90.1 steps/s
[Step=8550 Epoch=81.6] | Loss=0.00941 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.109 | L2-Norm(final)=12.486 | 4190.9 samples/s | 65.5 steps/s
[Step=8600 Epoch=82.1] | Loss=0.00564 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=12.479 | 6646.9 samples/s | 103.9 steps/s
[Step=8650 Epoch=82.6] | Loss=0.00382 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=12.482 | 2198.7 samples/s | 34.4 steps/s
[Step=8700 Epoch=83.1] | Loss=0.00287 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.344 | L2-Norm(final)=12.485 | 6258.3 samples/s | 97.8 steps/s
[Step=8750 Epoch=83.6] | Loss=0.00230 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.342 | L2-Norm(final)=12.486 | 2261.1 samples/s | 35.3 steps/s
[Step=8800 Epoch=84.0] | Loss=0.00192 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.330 | L2-Norm(final)=12.488 | 5698.9 samples/s | 89.0 steps/s
[Step=8850 Epoch=84.5] | Loss=0.00165 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=12.489 | 2342.2 samples/s | 36.6 steps/s
[Step=8900 Epoch=85.0] | Loss=0.00144 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=12.490 | 5264.8 samples/s | 82.3 steps/s
[Step=8950 Epoch=85.5] | Loss=0.00128 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.272 | L2-Norm(final)=12.491 | 2395.4 samples/s | 37.4 steps/s
[Step=9000 Epoch=85.9] | Loss=0.00115 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.250 | L2-Norm(final)=12.492 | 5036.1 samples/s | 78.7 steps/s
[Step=9050 Epoch=86.4] | Loss=0.00105 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=12.493 | 2477.9 samples/s | 38.7 steps/s
[Step=9100 Epoch=86.9] | Loss=0.00096 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=12.493 | 4726.8 samples/s | 73.9 steps/s
[Step=9150 Epoch=87.4] | Loss=0.00089 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=12.494 | 2528.0 samples/s | 39.5 steps/s
[Step=9200 Epoch=87.9] | Loss=0.00082 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=12.494 | 4649.5 samples/s | 72.6 steps/s
[Step=9250 Epoch=88.3] | Loss=0.00077 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=12.495 | 2577.6 samples/s | 40.3 steps/s
[Step=9300 Epoch=88.8] | Loss=0.00072 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.108 | L2-Norm(final)=12.495 | 4650.2 samples/s | 72.7 steps/s
[Step=9350 Epoch=89.3] | Loss=0.00068 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.084 | L2-Norm(final)=12.496 | 2592.6 samples/s | 40.5 steps/s
[Step=9400 Epoch=89.8] | Loss=0.00064 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.060 | L2-Norm(final)=12.496 | 4537.7 samples/s | 70.9 steps/s
[Step=9450 Epoch=90.2] | Loss=0.00061 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.037 | L2-Norm(final)=12.497 | 2545.0 samples/s | 39.8 steps/s
[Step=9500 Epoch=90.7] | Loss=0.00058 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.013 | L2-Norm(final)=12.497 | 4614.4 samples/s | 72.1 steps/s
[Step=9550 Epoch=91.2] | Loss=0.00055 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.989 | L2-Norm(final)=12.497 | 7447.0 samples/s | 116.4 steps/s
[Step=9600 Epoch=91.7] | Loss=0.00053 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.966 | L2-Norm(final)=12.498 | 2121.9 samples/s | 33.2 steps/s
[Step=9650 Epoch=92.2] | Loss=0.00050 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.943 | L2-Norm(final)=12.498 | 6869.4 samples/s | 107.3 steps/s
[Step=9700 Epoch=92.6] | Loss=0.00048 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.919 | L2-Norm(final)=12.499 | 2188.2 samples/s | 34.2 steps/s
[Step=9750 Epoch=93.1] | Loss=0.00046 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.896 | L2-Norm(final)=12.499 | 6308.9 samples/s | 98.6 steps/s
[Step=9800 Epoch=93.6] | Loss=0.00045 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.873 | L2-Norm(final)=12.499 | 2227.7 samples/s | 34.8 steps/s
[Step=9850 Epoch=94.1] | Loss=0.00043 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.850 | L2-Norm(final)=12.500 | 5810.7 samples/s | 90.8 steps/s
[Step=9900 Epoch=94.5] | Loss=0.00041 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.827 | L2-Norm(final)=12.500 | 2325.9 samples/s | 36.3 steps/s
[Step=9950 Epoch=95.0] | Loss=0.00040 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.805 | L2-Norm(final)=12.501 | 5306.5 samples/s | 82.9 steps/s
[Step=10000 Epoch=95.5] | Loss=0.00039 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.782 | L2-Norm(final)=12.501 | 2386.4 samples/s | 37.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step10000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=6001 Epoch=57.2] | Loss=0.00734 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.948 | L2-Norm(final)=9.931 | 5072.9 samples/s | 79.3 steps/s
[Step=6050 Epoch=57.7] | Loss=0.02239 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.944 | L2-Norm(final)=9.917 | 5044.6 samples/s | 78.8 steps/s
[Step=6100 Epoch=58.1] | Loss=0.02108 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.944 | L2-Norm(final)=9.911 | 8516.6 samples/s | 133.1 steps/s
[Step=6150 Epoch=58.6] | Loss=0.02062 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.944 | L2-Norm(final)=9.919 | 2359.5 samples/s | 36.9 steps/s
[Step=6200 Epoch=59.1] | Loss=0.02056 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.944 | L2-Norm(final)=9.936 | 7466.1 samples/s | 116.7 steps/s
[Step=6250 Epoch=59.6] | Loss=0.01982 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.943 | L2-Norm(final)=9.962 | 2379.4 samples/s | 37.2 steps/s
[Step=6300 Epoch=60.0] | Loss=0.01973 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.943 | L2-Norm(final)=9.994 | 6956.9 samples/s | 108.7 steps/s
[Step=6350 Epoch=60.5] | Loss=0.01928 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.943 | L2-Norm(final)=10.029 | 2458.8 samples/s | 38.4 steps/s
[Step=6400 Epoch=61.0] | Loss=0.01926 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.943 | L2-Norm(final)=10.067 | 6378.9 samples/s | 99.7 steps/s
[Step=6450 Epoch=61.5] | Loss=0.01896 | Reg=0.00143 | acc=0.9531 | L2-Norm=11.943 | L2-Norm(final)=10.107 | 2607.9 samples/s | 40.7 steps/s
[Step=6500 Epoch=62.0] | Loss=0.01883 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.943 | L2-Norm(final)=10.150 | 5649.8 samples/s | 88.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=6501 Epoch=62.0] | Loss=0.00675 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.943 | L2-Norm(final)=10.585 | 5934.7 samples/s | 92.7 steps/s
[Step=6550 Epoch=62.4] | Loss=0.01115 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.067 | L2-Norm(final)=10.617 | 4122.9 samples/s | 64.4 steps/s
[Step=6600 Epoch=62.9] | Loss=0.00737 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=10.621 | 6627.3 samples/s | 103.6 steps/s
[Step=6650 Epoch=63.4] | Loss=0.00506 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=10.624 | 2204.8 samples/s | 34.4 steps/s
[Step=6700 Epoch=63.9] | Loss=0.00385 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.247 | L2-Norm(final)=10.629 | 6226.6 samples/s | 97.3 steps/s
[Step=6750 Epoch=64.3] | Loss=0.00309 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=10.633 | 2262.9 samples/s | 35.4 steps/s
[Step=6800 Epoch=64.8] | Loss=0.00258 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.250 | L2-Norm(final)=10.637 | 5804.4 samples/s | 90.7 steps/s
[Step=6850 Epoch=65.3] | Loss=0.00221 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.243 | L2-Norm(final)=10.640 | 2309.6 samples/s | 36.1 steps/s
[Step=6900 Epoch=65.8] | Loss=0.00194 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=10.642 | 5386.0 samples/s | 84.2 steps/s
[Step=6950 Epoch=66.2] | Loss=0.00172 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.220 | L2-Norm(final)=10.644 | 2401.2 samples/s | 37.5 steps/s
[Step=7000 Epoch=66.7] | Loss=0.00155 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.206 | L2-Norm(final)=10.645 | 5031.2 samples/s | 78.6 steps/s
[Step=7050 Epoch=67.2] | Loss=0.00141 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.192 | L2-Norm(final)=10.647 | 2457.7 samples/s | 38.4 steps/s
[Step=7100 Epoch=67.7] | Loss=0.00130 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=10.648 | 4693.3 samples/s | 73.3 steps/s
[Step=7150 Epoch=68.1] | Loss=0.00120 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=10.650 | 2500.1 samples/s | 39.1 steps/s
[Step=7200 Epoch=68.6] | Loss=0.00111 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=10.651 | 4681.4 samples/s | 73.1 steps/s
[Step=7250 Epoch=69.1] | Loss=0.00104 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=10.652 | 2545.2 samples/s | 39.8 steps/s
[Step=7300 Epoch=69.6] | Loss=0.00097 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.112 | L2-Norm(final)=10.653 | 4671.8 samples/s | 73.0 steps/s
[Step=7350 Epoch=70.1] | Loss=0.00092 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.095 | L2-Norm(final)=10.654 | 2559.8 samples/s | 40.0 steps/s
[Step=7400 Epoch=70.5] | Loss=0.00087 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.078 | L2-Norm(final)=10.655 | 4574.7 samples/s | 71.5 steps/s
[Step=7450 Epoch=71.0] | Loss=0.00082 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.061 | L2-Norm(final)=10.656 | 2601.1 samples/s | 40.6 steps/s
[Step=7500 Epoch=71.5] | Loss=0.00078 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.044 | L2-Norm(final)=10.657 | 4543.6 samples/s | 71.0 steps/s
[Step=7550 Epoch=72.0] | Loss=0.00074 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.027 | L2-Norm(final)=10.658 | 7333.5 samples/s | 114.6 steps/s
[Step=7600 Epoch=72.4] | Loss=0.00071 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.010 | L2-Norm(final)=10.658 | 2127.6 samples/s | 33.2 steps/s
[Step=7650 Epoch=72.9] | Loss=0.00068 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.993 | L2-Norm(final)=10.659 | 6687.0 samples/s | 104.5 steps/s
[Step=7700 Epoch=73.4] | Loss=0.00065 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.976 | L2-Norm(final)=10.660 | 2203.5 samples/s | 34.4 steps/s
[Step=7750 Epoch=73.9] | Loss=0.00063 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.958 | L2-Norm(final)=10.661 | 6088.6 samples/s | 95.1 steps/s
[Step=7800 Epoch=74.3] | Loss=0.00060 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.941 | L2-Norm(final)=10.661 | 2253.2 samples/s | 35.2 steps/s
[Step=7850 Epoch=74.8] | Loss=0.00058 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.924 | L2-Norm(final)=10.662 | 5782.5 samples/s | 90.4 steps/s
[Step=7900 Epoch=75.3] | Loss=0.00056 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.906 | L2-Norm(final)=10.663 | 2314.5 samples/s | 36.2 steps/s
[Step=7950 Epoch=75.8] | Loss=0.00054 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.889 | L2-Norm(final)=10.663 | 5359.3 samples/s | 83.7 steps/s
[Step=8000 Epoch=76.2] | Loss=0.00052 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.871 | L2-Norm(final)=10.664 | 2382.9 samples/s | 37.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11013 | acc=0.9529 | tpr=0.9631 | fpr=0.0694 | 5288.3 samples/s | 20.7 steps/s
Avg test loss: 0.11660, Avg test acc: 0.95132, Avg tpr: 0.96229, Avg fpr: 0.07281, total FA: 568

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.16510 | acc=0.9410 | tpr=0.9707 | fpr=0.1234 | 5779.8 samples/s | 22.6 steps/s
Avg test loss: 0.16612, Avg test acc: 0.93994, Avg tpr: 0.97062, Avg fpr: 0.12755, total FA: 995

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.13130 | acc=0.9532 | tpr=0.9741 | fpr=0.0922 | 5489.8 samples/s | 21.4 steps/s
Avg test loss: 0.13251, Avg test acc: 0.95208, Avg tpr: 0.97179, Avg fpr: 0.09127, total FA: 712

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10065 | acc=0.9532 | tpr=0.9641 | fpr=0.0704 | 5729.8 samples/s | 22.4 steps/s
Avg test loss: 0.11180, Avg test acc: 0.95140, Avg tpr: 0.96439, Avg fpr: 0.07717, total FA: 602

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11375 | acc=0.9536 | tpr=0.9691 | fpr=0.0800 | 5515.0 samples/s | 21.5 steps/s
Avg test loss: 0.11593, Avg test acc: 0.95304, Avg tpr: 0.96794, Avg fpr: 0.07973, total FA: 622

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.13353 | acc=0.3170 | tpr=0.0177 | fpr=0.0330 | 5553.1 samples/s | 21.7 steps/s
Avg test loss: 5.15930, Avg test acc: 0.31441, Avg tpr: 0.01749, Avg fpr: 0.03256, total FA: 254

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.61288 | acc=0.2941 | tpr=0.0064 | fpr=0.0813 | 5681.8 samples/s | 22.2 steps/s
Avg test loss: 4.63156, Avg test acc: 0.29141, Avg tpr: 0.00606, Avg fpr: 0.08102, total FA: 632

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.20146 | acc=0.3065 | tpr=0.0199 | fpr=0.0711 | 5773.6 samples/s | 22.6 steps/s
Avg test loss: 5.21857, Avg test acc: 0.30451, Avg tpr: 0.01888, Avg fpr: 0.06730, total FA: 525

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.98545 | acc=0.3105 | tpr=0.0105 | fpr=0.0382 | 5939.4 samples/s | 23.2 steps/s
Avg test loss: 4.99934, Avg test acc: 0.30916, Avg tpr: 0.01113, Avg fpr: 0.03538, total FA: 276

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.66346 | acc=0.2916 | tpr=0.0112 | fpr=0.0994 | 5723.1 samples/s | 22.4 steps/s
Avg test loss: 4.67909, Avg test acc: 0.29133, Avg tpr: 0.01154, Avg fpr: 0.09332, total FA: 728

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.61533 | acc=0.1503 | tpr=0.2611 | fpr=0.8517 | 5759.4 samples/s | 22.5 steps/s
[Step= 100] | Loss=5.55678 | acc=0.1492 | tpr=0.2559 | fpr=0.8528 | 7964.8 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.56959 | acc=0.1483 | tpr=0.2536 | fpr=0.8537 | 7720.2 samples/s | 30.2 steps/s
[Step= 200] | Loss=5.55594 | acc=0.1486 | tpr=0.2503 | fpr=0.8533 | 8043.4 samples/s | 31.4 steps/s
[Step= 250] | Loss=5.56701 | acc=0.1480 | tpr=0.2550 | fpr=0.8539 | 8156.1 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.56524 | acc=0.1481 | tpr=0.2487 | fpr=0.8537 | 8220.4 samples/s | 32.1 steps/s
[Step= 350] | Loss=5.56622 | acc=0.1479 | tpr=0.2405 | fpr=0.8538 | 8217.6 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.56180 | acc=0.1486 | tpr=0.2429 | fpr=0.8532 | 8481.0 samples/s | 33.1 steps/s
[Step= 450] | Loss=5.56405 | acc=0.1481 | tpr=0.2420 | fpr=0.8536 | 7832.7 samples/s | 30.6 steps/s
[Step= 500] | Loss=5.56576 | acc=0.1480 | tpr=0.2401 | fpr=0.8537 | 8060.6 samples/s | 31.5 steps/s
[Step= 550] | Loss=5.56255 | acc=0.1478 | tpr=0.2372 | fpr=0.8538 | 9725.0 samples/s | 38.0 steps/s
Avg test loss: 5.56199, Avg test acc: 0.14763, Avg tpr: 0.23693, Avg fpr: 0.85399, total FA: 118575

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.77168 | acc=0.0966 | tpr=0.5531 | fpr=0.9116 | 5613.9 samples/s | 21.9 steps/s
[Step= 100] | Loss=6.72891 | acc=0.0952 | tpr=0.4883 | fpr=0.9122 | 8223.0 samples/s | 32.1 steps/s
[Step= 150] | Loss=6.74013 | acc=0.0957 | tpr=0.4942 | fpr=0.9117 | 7706.9 samples/s | 30.1 steps/s
[Step= 200] | Loss=6.73804 | acc=0.0948 | tpr=0.4874 | fpr=0.9123 | 7957.1 samples/s | 31.1 steps/s
[Step= 250] | Loss=6.73882 | acc=0.0958 | tpr=0.4969 | fpr=0.9116 | 7815.3 samples/s | 30.5 steps/s
[Step= 300] | Loss=6.73803 | acc=0.0957 | tpr=0.4975 | fpr=0.9116 | 8287.7 samples/s | 32.4 steps/s
[Step= 350] | Loss=6.73940 | acc=0.0954 | tpr=0.4840 | fpr=0.9117 | 8458.2 samples/s | 33.0 steps/s
[Step= 400] | Loss=6.73441 | acc=0.0959 | tpr=0.4874 | fpr=0.9112 | 8284.8 samples/s | 32.4 steps/s
[Step= 450] | Loss=6.73582 | acc=0.0963 | tpr=0.4883 | fpr=0.9108 | 8071.7 samples/s | 31.5 steps/s
[Step= 500] | Loss=6.74138 | acc=0.0959 | tpr=0.4828 | fpr=0.9110 | 7796.2 samples/s | 30.5 steps/s
[Step= 550] | Loss=6.73916 | acc=0.0958 | tpr=0.4799 | fpr=0.9112 | 10398.0 samples/s | 40.6 steps/s
Avg test loss: 6.74011, Avg test acc: 0.09566, Avg tpr: 0.47940, Avg fpr: 0.91131, total FA: 126534

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=7.30094 | acc=0.1011 | tpr=0.3186 | fpr=0.9028 | 5724.4 samples/s | 22.4 steps/s
[Step= 100] | Loss=7.25252 | acc=0.1013 | tpr=0.3092 | fpr=0.9026 | 7863.9 samples/s | 30.7 steps/s
[Step= 150] | Loss=7.26022 | acc=0.1007 | tpr=0.2896 | fpr=0.9028 | 7485.0 samples/s | 29.2 steps/s
[Step= 200] | Loss=7.24881 | acc=0.1012 | tpr=0.2852 | fpr=0.9021 | 8262.0 samples/s | 32.3 steps/s
[Step= 250] | Loss=7.24673 | acc=0.1018 | tpr=0.2882 | fpr=0.9016 | 7889.0 samples/s | 30.8 steps/s
[Step= 300] | Loss=7.25009 | acc=0.1013 | tpr=0.2793 | fpr=0.9019 | 7976.1 samples/s | 31.2 steps/s
[Step= 350] | Loss=7.25528 | acc=0.1007 | tpr=0.2761 | fpr=0.9025 | 8506.9 samples/s | 33.2 steps/s
[Step= 400] | Loss=7.25306 | acc=0.1011 | tpr=0.2795 | fpr=0.9021 | 8072.7 samples/s | 31.5 steps/s
[Step= 450] | Loss=7.25391 | acc=0.1010 | tpr=0.2780 | fpr=0.9023 | 8146.8 samples/s | 31.8 steps/s
[Step= 500] | Loss=7.25482 | acc=0.1007 | tpr=0.2780 | fpr=0.9025 | 8417.5 samples/s | 32.9 steps/s
[Step= 550] | Loss=7.25012 | acc=0.1008 | tpr=0.2758 | fpr=0.9023 | 9921.5 samples/s | 38.8 steps/s
Avg test loss: 7.24952, Avg test acc: 0.10076, Avg tpr: 0.27615, Avg fpr: 0.90243, total FA: 125300

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.86029 | acc=0.1585 | tpr=0.2212 | fpr=0.8426 | 5685.8 samples/s | 22.2 steps/s
[Step= 100] | Loss=4.83949 | acc=0.1574 | tpr=0.1834 | fpr=0.8431 | 7567.8 samples/s | 29.6 steps/s
[Step= 150] | Loss=4.83644 | acc=0.1565 | tpr=0.1945 | fpr=0.8442 | 8501.5 samples/s | 33.2 steps/s
[Step= 200] | Loss=4.83189 | acc=0.1573 | tpr=0.1945 | fpr=0.8434 | 8265.2 samples/s | 32.3 steps/s
[Step= 250] | Loss=4.83673 | acc=0.1571 | tpr=0.1895 | fpr=0.8435 | 8520.4 samples/s | 33.3 steps/s
[Step= 300] | Loss=4.83915 | acc=0.1566 | tpr=0.1862 | fpr=0.8439 | 7913.0 samples/s | 30.9 steps/s
[Step= 350] | Loss=4.83859 | acc=0.1564 | tpr=0.1785 | fpr=0.8440 | 8130.3 samples/s | 31.8 steps/s
[Step= 400] | Loss=4.83555 | acc=0.1571 | tpr=0.1844 | fpr=0.8434 | 7686.3 samples/s | 30.0 steps/s
[Step= 450] | Loss=4.83645 | acc=0.1575 | tpr=0.1889 | fpr=0.8431 | 8069.4 samples/s | 31.5 steps/s
[Step= 500] | Loss=4.83856 | acc=0.1574 | tpr=0.1921 | fpr=0.8433 | 8190.3 samples/s | 32.0 steps/s
[Step= 550] | Loss=4.83621 | acc=0.1575 | tpr=0.1918 | fpr=0.8432 | 9742.8 samples/s | 38.1 steps/s
Avg test loss: 4.83667, Avg test acc: 0.15739, Avg tpr: 0.19176, Avg fpr: 0.84323, total FA: 117081

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.12127 | acc=0.1247 | tpr=0.2257 | fpr=0.8771 | 5553.6 samples/s | 21.7 steps/s
[Step= 100] | Loss=6.08185 | acc=0.1252 | tpr=0.2175 | fpr=0.8765 | 7739.0 samples/s | 30.2 steps/s
[Step= 150] | Loss=6.09436 | acc=0.1250 | tpr=0.1988 | fpr=0.8763 | 7704.4 samples/s | 30.1 steps/s
[Step= 200] | Loss=6.08666 | acc=0.1251 | tpr=0.1869 | fpr=0.8760 | 8413.3 samples/s | 32.9 steps/s
[Step= 250] | Loss=6.09509 | acc=0.1253 | tpr=0.1878 | fpr=0.8758 | 8640.3 samples/s | 33.8 steps/s
[Step= 300] | Loss=6.09600 | acc=0.1249 | tpr=0.1855 | fpr=0.8762 | 8086.4 samples/s | 31.6 steps/s
[Step= 350] | Loss=6.09864 | acc=0.1247 | tpr=0.1766 | fpr=0.8763 | 8036.9 samples/s | 31.4 steps/s
[Step= 400] | Loss=6.09374 | acc=0.1254 | tpr=0.1794 | fpr=0.8756 | 8235.1 samples/s | 32.2 steps/s
[Step= 450] | Loss=6.09380 | acc=0.1256 | tpr=0.1821 | fpr=0.8755 | 7708.7 samples/s | 30.1 steps/s
[Step= 500] | Loss=6.09460 | acc=0.1255 | tpr=0.1819 | fpr=0.8756 | 8452.7 samples/s | 33.0 steps/s
[Step= 550] | Loss=6.09123 | acc=0.1258 | tpr=0.1807 | fpr=0.8752 | 10207.2 samples/s | 39.9 steps/s
Avg test loss: 6.09025, Avg test acc: 0.12578, Avg tpr: 0.18067, Avg fpr: 0.87522, total FA: 121522

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12876 | acc=0.9804 | tpr=0.8805 | fpr=0.0178 | 5676.1 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.13437 | acc=0.9795 | tpr=0.9041 | fpr=0.0191 | 8143.8 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.13912 | acc=0.9786 | tpr=0.9107 | fpr=0.0202 | 8227.8 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.14151 | acc=0.9785 | tpr=0.9191 | fpr=0.0204 | 8256.7 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.14156 | acc=0.9787 | tpr=0.9118 | fpr=0.0201 | 7675.8 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.14365 | acc=0.9784 | tpr=0.9098 | fpr=0.0204 | 8480.7 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.14478 | acc=0.9782 | tpr=0.9098 | fpr=0.0206 | 8123.4 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.14577 | acc=0.9780 | tpr=0.9065 | fpr=0.0207 | 7916.5 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.14821 | acc=0.9778 | tpr=0.9056 | fpr=0.0209 | 8256.5 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.14713 | acc=0.9778 | tpr=0.9075 | fpr=0.0210 | 8507.5 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.14656 | acc=0.9778 | tpr=0.9053 | fpr=0.0208 | 9313.9 samples/s | 36.4 steps/s
Avg test loss: 0.14622, Avg test acc: 0.97786, Avg tpr: 0.90491, Avg fpr: 0.02081, total FA: 2890

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09454 | acc=0.9812 | tpr=0.8717 | fpr=0.0169 | 5598.0 samples/s | 21.9 steps/s
[Step= 100] | Loss=0.09749 | acc=0.9809 | tpr=0.8763 | fpr=0.0172 | 8701.3 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.10090 | acc=0.9804 | tpr=0.8919 | fpr=0.0180 | 7402.9 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.10234 | acc=0.9805 | tpr=0.8929 | fpr=0.0179 | 8611.3 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.10236 | acc=0.9806 | tpr=0.8926 | fpr=0.0178 | 8245.2 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.10340 | acc=0.9805 | tpr=0.8931 | fpr=0.0179 | 8107.8 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.10387 | acc=0.9804 | tpr=0.8961 | fpr=0.0180 | 7499.6 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.10469 | acc=0.9803 | tpr=0.8928 | fpr=0.0182 | 8331.0 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.10591 | acc=0.9801 | tpr=0.8900 | fpr=0.0182 | 8233.6 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.10498 | acc=0.9803 | tpr=0.8930 | fpr=0.0181 | 7819.8 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.10392 | acc=0.9804 | tpr=0.8930 | fpr=0.0180 | 10478.2 samples/s | 40.9 steps/s
Avg test loss: 0.10372, Avg test acc: 0.98038, Avg tpr: 0.89184, Avg fpr: 0.01801, total FA: 2501

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12146 | acc=0.9777 | tpr=0.8982 | fpr=0.0208 | 5747.5 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.12592 | acc=0.9768 | tpr=0.9126 | fpr=0.0220 | 7366.1 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.13055 | acc=0.9760 | tpr=0.9193 | fpr=0.0230 | 8059.3 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.13307 | acc=0.9761 | tpr=0.9268 | fpr=0.0230 | 7800.9 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.13388 | acc=0.9763 | tpr=0.9275 | fpr=0.0228 | 8475.0 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.13528 | acc=0.9760 | tpr=0.9251 | fpr=0.0230 | 7923.7 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.13485 | acc=0.9762 | tpr=0.9286 | fpr=0.0230 | 8368.9 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.13658 | acc=0.9758 | tpr=0.9261 | fpr=0.0233 | 7767.3 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.13835 | acc=0.9755 | tpr=0.9221 | fpr=0.0235 | 8234.6 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.13785 | acc=0.9756 | tpr=0.9251 | fpr=0.0235 | 7608.7 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.13669 | acc=0.9757 | tpr=0.9244 | fpr=0.0234 | 12154.8 samples/s | 47.5 steps/s
Avg test loss: 0.13646, Avg test acc: 0.97571, Avg tpr: 0.92393, Avg fpr: 0.02335, total FA: 3242

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11454 | acc=0.9789 | tpr=0.9204 | fpr=0.0200 | 5663.5 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.12055 | acc=0.9792 | tpr=0.9296 | fpr=0.0199 | 8290.4 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.12623 | acc=0.9784 | tpr=0.9323 | fpr=0.0208 | 7965.9 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.12767 | acc=0.9787 | tpr=0.9333 | fpr=0.0205 | 7801.1 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.12676 | acc=0.9786 | tpr=0.9231 | fpr=0.0203 | 8424.0 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.12838 | acc=0.9786 | tpr=0.9229 | fpr=0.0204 | 8539.2 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.12825 | acc=0.9785 | tpr=0.9230 | fpr=0.0205 | 7789.3 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.12925 | acc=0.9783 | tpr=0.9207 | fpr=0.0207 | 7458.2 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.13090 | acc=0.9781 | tpr=0.9182 | fpr=0.0208 | 7731.7 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.13023 | acc=0.9781 | tpr=0.9203 | fpr=0.0209 | 8236.0 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.12959 | acc=0.9782 | tpr=0.9200 | fpr=0.0208 | 11022.7 samples/s | 43.1 steps/s
Avg test loss: 0.12942, Avg test acc: 0.97816, Avg tpr: 0.91957, Avg fpr: 0.02077, total FA: 2884

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.09341 | acc=0.9803 | tpr=0.8982 | fpr=0.0182 | 5752.0 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.09714 | acc=0.9799 | tpr=0.9190 | fpr=0.0190 | 7790.6 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.10157 | acc=0.9792 | tpr=0.9308 | fpr=0.0199 | 7617.2 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.10282 | acc=0.9792 | tpr=0.9311 | fpr=0.0199 | 8207.8 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.10240 | acc=0.9793 | tpr=0.9293 | fpr=0.0198 | 8320.4 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.10403 | acc=0.9791 | tpr=0.9265 | fpr=0.0199 | 8121.6 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.10381 | acc=0.9793 | tpr=0.9280 | fpr=0.0198 | 8475.7 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.10519 | acc=0.9791 | tpr=0.9256 | fpr=0.0199 | 8067.2 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.10713 | acc=0.9788 | tpr=0.9226 | fpr=0.0202 | 8403.7 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.10664 | acc=0.9788 | tpr=0.9229 | fpr=0.0202 | 7729.1 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.10618 | acc=0.9789 | tpr=0.9216 | fpr=0.0201 | 9778.1 samples/s | 38.2 steps/s
Avg test loss: 0.10600, Avg test acc: 0.97890, Avg tpr: 0.92155, Avg fpr: 0.02006, total FA: 2785

server round 12/50

clients selected: [1 2 3 4 5]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=78.1] | Loss=0.07669 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.742 | L2-Norm(final)=12.752 | 6014.6 samples/s | 94.0 steps/s
[Step=16050 Epoch=78.3] | Loss=0.07086 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.745 | L2-Norm(final)=12.767 | 4884.3 samples/s | 76.3 steps/s
[Step=16100 Epoch=78.6] | Loss=0.07033 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.745 | L2-Norm(final)=12.782 | 5741.5 samples/s | 89.7 steps/s
[Step=16150 Epoch=78.8] | Loss=0.06953 | Reg=0.00138 | acc=0.9375 | L2-Norm=11.745 | L2-Norm(final)=12.797 | 5659.8 samples/s | 88.4 steps/s
[Step=16200 Epoch=79.0] | Loss=0.07076 | Reg=0.00138 | acc=0.9375 | L2-Norm=11.746 | L2-Norm(final)=12.813 | 8701.7 samples/s | 136.0 steps/s
[Step=16250 Epoch=79.3] | Loss=0.07044 | Reg=0.00138 | acc=0.9531 | L2-Norm=11.746 | L2-Norm(final)=12.827 | 2375.9 samples/s | 37.1 steps/s
[Step=16300 Epoch=79.5] | Loss=0.07109 | Reg=0.00138 | acc=0.9062 | L2-Norm=11.746 | L2-Norm(final)=12.843 | 5682.6 samples/s | 88.8 steps/s
[Step=16350 Epoch=79.8] | Loss=0.07068 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.746 | L2-Norm(final)=12.857 | 5626.8 samples/s | 87.9 steps/s
[Step=16400 Epoch=80.0] | Loss=0.07036 | Reg=0.00138 | acc=0.9531 | L2-Norm=11.746 | L2-Norm(final)=12.873 | 7888.1 samples/s | 123.3 steps/s
[Step=16450 Epoch=80.3] | Loss=0.06991 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.746 | L2-Norm(final)=12.890 | 2499.6 samples/s | 39.1 steps/s
[Step=16500 Epoch=80.5] | Loss=0.07077 | Reg=0.00138 | acc=0.9375 | L2-Norm=11.746 | L2-Norm(final)=12.908 | 5626.6 samples/s | 87.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=80.5] | Loss=0.04060 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.746 | L2-Norm(final)=13.071 | 6050.4 samples/s | 94.5 steps/s
[Step=16550 Epoch=80.8] | Loss=0.05763 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.851 | L2-Norm(final)=13.070 | 4306.3 samples/s | 67.3 steps/s
[Step=16600 Epoch=81.0] | Loss=0.05318 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.928 | L2-Norm(final)=13.061 | 4833.4 samples/s | 75.5 steps/s
[Step=16650 Epoch=81.2] | Loss=0.04794 | Reg=0.00144 | acc=0.9375 | L2-Norm=11.985 | L2-Norm(final)=13.058 | 4837.6 samples/s | 75.6 steps/s
[Step=16700 Epoch=81.5] | Loss=0.04375 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.030 | L2-Norm(final)=13.056 | 6992.5 samples/s | 109.3 steps/s
[Step=16750 Epoch=81.7] | Loss=0.03866 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.068 | L2-Norm(final)=13.057 | 2268.8 samples/s | 35.5 steps/s
[Step=16800 Epoch=82.0] | Loss=0.03527 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=13.059 | 4855.0 samples/s | 75.9 steps/s
[Step=16850 Epoch=82.2] | Loss=0.03269 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.129 | L2-Norm(final)=13.062 | 4931.6 samples/s | 77.1 steps/s
[Step=16900 Epoch=82.5] | Loss=0.03074 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=13.065 | 6379.2 samples/s | 99.7 steps/s
[Step=16950 Epoch=82.7] | Loss=0.02890 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.180 | L2-Norm(final)=13.068 | 2326.5 samples/s | 36.4 steps/s
[Step=17000 Epoch=83.0] | Loss=0.02704 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=13.071 | 4844.0 samples/s | 75.7 steps/s
[Step=17050 Epoch=83.2] | Loss=0.02551 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.222 | L2-Norm(final)=13.075 | 4903.9 samples/s | 76.6 steps/s
[Step=17100 Epoch=83.4] | Loss=0.02419 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.239 | L2-Norm(final)=13.078 | 5986.2 samples/s | 93.5 steps/s
[Step=17150 Epoch=83.7] | Loss=0.02286 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.255 | L2-Norm(final)=13.081 | 2385.4 samples/s | 37.3 steps/s
[Step=17200 Epoch=83.9] | Loss=0.02181 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.269 | L2-Norm(final)=13.085 | 4912.9 samples/s | 76.8 steps/s
[Step=17250 Epoch=84.2] | Loss=0.02091 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=13.088 | 4899.5 samples/s | 76.6 steps/s
[Step=17300 Epoch=84.4] | Loss=0.02023 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.294 | L2-Norm(final)=13.091 | 5498.1 samples/s | 85.9 steps/s
[Step=17350 Epoch=84.7] | Loss=0.01947 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.305 | L2-Norm(final)=13.094 | 2453.1 samples/s | 38.3 steps/s
[Step=17400 Epoch=84.9] | Loss=0.01879 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.316 | L2-Norm(final)=13.096 | 4856.2 samples/s | 75.9 steps/s
[Step=17450 Epoch=85.1] | Loss=0.01817 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=13.099 | 4817.1 samples/s | 75.3 steps/s
[Step=17500 Epoch=85.4] | Loss=0.01754 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.335 | L2-Norm(final)=13.102 | 5248.9 samples/s | 82.0 steps/s
[Step=17550 Epoch=85.6] | Loss=0.01694 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.344 | L2-Norm(final)=13.104 | 2495.1 samples/s | 39.0 steps/s
[Step=17600 Epoch=85.9] | Loss=0.01639 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.352 | L2-Norm(final)=13.107 | 4949.3 samples/s | 77.3 steps/s
[Step=17650 Epoch=86.1] | Loss=0.01586 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.360 | L2-Norm(final)=13.110 | 4882.7 samples/s | 76.3 steps/s
[Step=17700 Epoch=86.4] | Loss=0.01542 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.366 | L2-Norm(final)=13.112 | 4867.3 samples/s | 76.1 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01502 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=13.115 | 2592.1 samples/s | 40.5 steps/s
[Step=17800 Epoch=86.9] | Loss=0.01464 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.379 | L2-Norm(final)=13.117 | 4893.1 samples/s | 76.5 steps/s
[Step=17850 Epoch=87.1] | Loss=0.01425 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.385 | L2-Norm(final)=13.120 | 4917.6 samples/s | 76.8 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01395 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.391 | L2-Norm(final)=13.122 | 4792.2 samples/s | 74.9 steps/s
[Step=17950 Epoch=87.6] | Loss=0.01361 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.396 | L2-Norm(final)=13.124 | 2623.1 samples/s | 41.0 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01331 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.401 | L2-Norm(final)=13.126 | 4874.4 samples/s | 76.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step18000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=68.2] | Loss=0.03820 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.742 | L2-Norm(final)=11.654 | 5464.5 samples/s | 85.4 steps/s
[Step=14050 Epoch=68.5] | Loss=0.07260 | Reg=0.00138 | acc=0.9219 | L2-Norm=11.742 | L2-Norm(final)=11.678 | 5066.2 samples/s | 79.2 steps/s
[Step=14100 Epoch=68.7] | Loss=0.07106 | Reg=0.00138 | acc=0.9219 | L2-Norm=11.742 | L2-Norm(final)=11.715 | 5883.0 samples/s | 91.9 steps/s
[Step=14150 Epoch=68.9] | Loss=0.06883 | Reg=0.00138 | acc=0.9219 | L2-Norm=11.742 | L2-Norm(final)=11.755 | 5448.8 samples/s | 85.1 steps/s
[Step=14200 Epoch=69.2] | Loss=0.06984 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.742 | L2-Norm(final)=11.794 | 8644.3 samples/s | 135.1 steps/s
[Step=14250 Epoch=69.4] | Loss=0.07040 | Reg=0.00138 | acc=0.9531 | L2-Norm=11.742 | L2-Norm(final)=11.826 | 2436.4 samples/s | 38.1 steps/s
[Step=14300 Epoch=69.7] | Loss=0.06998 | Reg=0.00138 | acc=0.9531 | L2-Norm=11.742 | L2-Norm(final)=11.857 | 5540.5 samples/s | 86.6 steps/s
[Step=14350 Epoch=69.9] | Loss=0.06972 | Reg=0.00138 | acc=0.9531 | L2-Norm=11.742 | L2-Norm(final)=11.887 | 5746.5 samples/s | 89.8 steps/s
[Step=14400 Epoch=70.2] | Loss=0.06951 | Reg=0.00138 | acc=0.9531 | L2-Norm=11.742 | L2-Norm(final)=11.919 | 7673.5 samples/s | 119.9 steps/s
[Step=14450 Epoch=70.4] | Loss=0.06961 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.742 | L2-Norm(final)=11.950 | 2513.4 samples/s | 39.3 steps/s
[Step=14500 Epoch=70.7] | Loss=0.06960 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.742 | L2-Norm(final)=11.981 | 5589.4 samples/s | 87.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=70.7] | Loss=0.08414 | Reg=0.00138 | acc=0.9219 | L2-Norm=11.742 | L2-Norm(final)=12.276 | 5922.6 samples/s | 92.5 steps/s
[Step=14550 Epoch=70.9] | Loss=0.06172 | Reg=0.00141 | acc=0.9375 | L2-Norm=11.874 | L2-Norm(final)=12.276 | 4338.6 samples/s | 67.8 steps/s
[Step=14600 Epoch=71.1] | Loss=0.05729 | Reg=0.00144 | acc=0.9375 | L2-Norm=11.998 | L2-Norm(final)=12.256 | 4916.0 samples/s | 76.8 steps/s
[Step=14650 Epoch=71.4] | Loss=0.05397 | Reg=0.00146 | acc=0.9375 | L2-Norm=12.084 | L2-Norm(final)=12.246 | 4820.6 samples/s | 75.3 steps/s
[Step=14700 Epoch=71.6] | Loss=0.05085 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.147 | L2-Norm(final)=12.238 | 6956.0 samples/s | 108.7 steps/s
[Step=14750 Epoch=71.9] | Loss=0.04410 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.201 | L2-Norm(final)=12.235 | 2302.1 samples/s | 36.0 steps/s
[Step=14800 Epoch=72.1] | Loss=0.03957 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.246 | L2-Norm(final)=12.236 | 4831.4 samples/s | 75.5 steps/s
[Step=14850 Epoch=72.4] | Loss=0.03651 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.284 | L2-Norm(final)=12.237 | 4855.4 samples/s | 75.9 steps/s
[Step=14900 Epoch=72.6] | Loss=0.03487 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.317 | L2-Norm(final)=12.239 | 6338.6 samples/s | 99.0 steps/s
[Step=14950 Epoch=72.8] | Loss=0.03337 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.348 | L2-Norm(final)=12.240 | 2345.2 samples/s | 36.6 steps/s
[Step=15000 Epoch=73.1] | Loss=0.03113 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.375 | L2-Norm(final)=12.242 | 4831.4 samples/s | 75.5 steps/s
[Step=15050 Epoch=73.3] | Loss=0.02930 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.399 | L2-Norm(final)=12.245 | 4869.2 samples/s | 76.1 steps/s
[Step=15100 Epoch=73.6] | Loss=0.02802 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.421 | L2-Norm(final)=12.247 | 5784.3 samples/s | 90.4 steps/s
[Step=15150 Epoch=73.8] | Loss=0.02673 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=12.250 | 2413.2 samples/s | 37.7 steps/s
[Step=15200 Epoch=74.1] | Loss=0.02551 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.457 | L2-Norm(final)=12.252 | 4882.9 samples/s | 76.3 steps/s
[Step=15250 Epoch=74.3] | Loss=0.02428 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.473 | L2-Norm(final)=12.254 | 4861.3 samples/s | 76.0 steps/s
[Step=15300 Epoch=74.5] | Loss=0.02343 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.487 | L2-Norm(final)=12.257 | 5363.9 samples/s | 83.8 steps/s
[Step=15350 Epoch=74.8] | Loss=0.02253 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=12.259 | 2519.8 samples/s | 39.4 steps/s
[Step=15400 Epoch=75.0] | Loss=0.02174 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.514 | L2-Norm(final)=12.261 | 4791.0 samples/s | 74.9 steps/s
[Step=15450 Epoch=75.3] | Loss=0.02115 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.525 | L2-Norm(final)=12.263 | 4858.2 samples/s | 75.9 steps/s
[Step=15500 Epoch=75.5] | Loss=0.02045 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=12.265 | 4990.5 samples/s | 78.0 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01978 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.547 | L2-Norm(final)=12.267 | 2604.8 samples/s | 40.7 steps/s
[Step=15600 Epoch=76.0] | Loss=0.01915 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.556 | L2-Norm(final)=12.269 | 4846.4 samples/s | 75.7 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01872 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.565 | L2-Norm(final)=12.272 | 4888.0 samples/s | 76.4 steps/s
[Step=15700 Epoch=76.5] | Loss=0.01821 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.574 | L2-Norm(final)=12.274 | 4852.9 samples/s | 75.8 steps/s
[Step=15750 Epoch=76.7] | Loss=0.01768 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.582 | L2-Norm(final)=12.276 | 2704.1 samples/s | 42.3 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01716 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.590 | L2-Norm(final)=12.278 | 4819.4 samples/s | 75.3 steps/s
[Step=15850 Epoch=77.2] | Loss=0.01675 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.597 | L2-Norm(final)=12.281 | 4765.7 samples/s | 74.5 steps/s
[Step=15900 Epoch=77.5] | Loss=0.01638 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.604 | L2-Norm(final)=12.283 | 5026.2 samples/s | 78.5 steps/s
[Step=15950 Epoch=77.7] | Loss=0.01605 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.610 | L2-Norm(final)=12.285 | 2624.0 samples/s | 41.0 steps/s
[Step=16000 Epoch=78.0] | Loss=0.01569 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=12.287 | 4894.7 samples/s | 76.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step16000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.06762 | Reg=0.00138 | acc=0.9219 | L2-Norm=11.742 | L2-Norm(final)=12.249 | 5720.2 samples/s | 89.4 steps/s
[Step=12050 Epoch=58.8] | Loss=0.08555 | Reg=0.00138 | acc=0.9219 | L2-Norm=11.742 | L2-Norm(final)=12.279 | 5025.7 samples/s | 78.5 steps/s
[Step=12100 Epoch=59.0] | Loss=0.07952 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.742 | L2-Norm(final)=12.300 | 5593.2 samples/s | 87.4 steps/s
[Step=12150 Epoch=59.3] | Loss=0.07703 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.742 | L2-Norm(final)=12.318 | 5710.3 samples/s | 89.2 steps/s
[Step=12200 Epoch=59.5] | Loss=0.07632 | Reg=0.00138 | acc=0.8438 | L2-Norm=11.742 | L2-Norm(final)=12.334 | 8467.9 samples/s | 132.3 steps/s
[Step=12250 Epoch=59.7] | Loss=0.07463 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.742 | L2-Norm(final)=12.351 | 2462.5 samples/s | 38.5 steps/s
[Step=12300 Epoch=60.0] | Loss=0.07513 | Reg=0.00138 | acc=0.9219 | L2-Norm=11.742 | L2-Norm(final)=12.369 | 5549.3 samples/s | 86.7 steps/s
[Step=12350 Epoch=60.2] | Loss=0.07471 | Reg=0.00138 | acc=0.9375 | L2-Norm=11.742 | L2-Norm(final)=12.384 | 5601.2 samples/s | 87.5 steps/s
[Step=12400 Epoch=60.5] | Loss=0.07433 | Reg=0.00138 | acc=0.9531 | L2-Norm=11.742 | L2-Norm(final)=12.401 | 7838.1 samples/s | 122.5 steps/s
[Step=12450 Epoch=60.7] | Loss=0.07373 | Reg=0.00138 | acc=0.9219 | L2-Norm=11.742 | L2-Norm(final)=12.417 | 2507.8 samples/s | 39.2 steps/s
[Step=12500 Epoch=61.0] | Loss=0.07334 | Reg=0.00138 | acc=0.9062 | L2-Norm=11.742 | L2-Norm(final)=12.434 | 5724.3 samples/s | 89.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=61.0] | Loss=0.08130 | Reg=0.00138 | acc=0.8906 | L2-Norm=11.742 | L2-Norm(final)=12.622 | 5551.2 samples/s | 86.7 steps/s
[Step=12550 Epoch=61.2] | Loss=0.06606 | Reg=0.00141 | acc=0.9219 | L2-Norm=11.883 | L2-Norm(final)=12.624 | 4420.6 samples/s | 69.1 steps/s
[Step=12600 Epoch=61.4] | Loss=0.05971 | Reg=0.00144 | acc=0.9375 | L2-Norm=12.003 | L2-Norm(final)=12.610 | 4772.8 samples/s | 74.6 steps/s
[Step=12650 Epoch=61.7] | Loss=0.05313 | Reg=0.00146 | acc=0.9062 | L2-Norm=12.082 | L2-Norm(final)=12.602 | 4838.5 samples/s | 75.6 steps/s
[Step=12700 Epoch=61.9] | Loss=0.04816 | Reg=0.00147 | acc=0.9531 | L2-Norm=12.143 | L2-Norm(final)=12.597 | 7009.5 samples/s | 109.5 steps/s
[Step=12750 Epoch=62.2] | Loss=0.04860 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.204 | L2-Norm(final)=12.592 | 2242.8 samples/s | 35.0 steps/s
[Step=12800 Epoch=62.4] | Loss=0.04517 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=12.588 | 4894.5 samples/s | 76.5 steps/s
[Step=12850 Epoch=62.7] | Loss=0.04177 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.306 | L2-Norm(final)=12.586 | 4894.1 samples/s | 76.5 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03875 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.345 | L2-Norm(final)=12.585 | 6254.6 samples/s | 97.7 steps/s
[Step=12950 Epoch=63.2] | Loss=0.03601 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.378 | L2-Norm(final)=12.585 | 2356.2 samples/s | 36.8 steps/s
[Step=13000 Epoch=63.4] | Loss=0.03345 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.406 | L2-Norm(final)=12.586 | 4837.3 samples/s | 75.6 steps/s
[Step=13050 Epoch=63.6] | Loss=0.03158 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=12.587 | 4875.3 samples/s | 76.2 steps/s
[Step=13100 Epoch=63.9] | Loss=0.02985 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.451 | L2-Norm(final)=12.588 | 5780.4 samples/s | 90.3 steps/s
[Step=13150 Epoch=64.1] | Loss=0.02854 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.471 | L2-Norm(final)=12.590 | 2443.8 samples/s | 38.2 steps/s
[Step=13200 Epoch=64.4] | Loss=0.02733 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=12.591 | 4864.8 samples/s | 76.0 steps/s
[Step=13250 Epoch=64.6] | Loss=0.02627 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.508 | L2-Norm(final)=12.592 | 4871.1 samples/s | 76.1 steps/s
[Step=13300 Epoch=64.9] | Loss=0.02521 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=12.593 | 5384.7 samples/s | 84.1 steps/s
[Step=13350 Epoch=65.1] | Loss=0.02423 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.538 | L2-Norm(final)=12.594 | 2521.8 samples/s | 39.4 steps/s
[Step=13400 Epoch=65.3] | Loss=0.02326 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.551 | L2-Norm(final)=12.596 | 4822.7 samples/s | 75.4 steps/s
[Step=13450 Epoch=65.6] | Loss=0.02235 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=12.598 | 4868.4 samples/s | 76.1 steps/s
[Step=13500 Epoch=65.8] | Loss=0.02161 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.574 | L2-Norm(final)=12.599 | 4999.6 samples/s | 78.1 steps/s
[Step=13550 Epoch=66.1] | Loss=0.02095 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.585 | L2-Norm(final)=12.601 | 2617.2 samples/s | 40.9 steps/s
[Step=13600 Epoch=66.3] | Loss=0.02017 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.595 | L2-Norm(final)=12.604 | 4779.2 samples/s | 74.7 steps/s
[Step=13650 Epoch=66.6] | Loss=0.01966 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.604 | L2-Norm(final)=12.606 | 4870.3 samples/s | 76.1 steps/s
[Step=13700 Epoch=66.8] | Loss=0.01914 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.613 | L2-Norm(final)=12.607 | 4905.3 samples/s | 76.6 steps/s
[Step=13750 Epoch=67.1] | Loss=0.01862 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.622 | L2-Norm(final)=12.609 | 2630.0 samples/s | 41.1 steps/s
[Step=13800 Epoch=67.3] | Loss=0.01814 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.630 | L2-Norm(final)=12.612 | 4850.6 samples/s | 75.8 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01784 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.638 | L2-Norm(final)=12.613 | 4885.3 samples/s | 76.3 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01743 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.645 | L2-Norm(final)=12.615 | 4817.7 samples/s | 75.3 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01707 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.653 | L2-Norm(final)=12.616 | 2679.6 samples/s | 41.9 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01665 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.660 | L2-Norm(final)=12.618 | 4884.6 samples/s | 76.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step14000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=68.7] | Loss=0.06137 | Reg=0.00138 | acc=0.9531 | L2-Norm=11.742 | L2-Norm(final)=12.507 | 5671.4 samples/s | 88.6 steps/s
[Step=14050 Epoch=68.9] | Loss=0.07615 | Reg=0.00138 | acc=0.8906 | L2-Norm=11.743 | L2-Norm(final)=12.499 | 4956.6 samples/s | 77.4 steps/s
[Step=14100 Epoch=69.1] | Loss=0.07749 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.743 | L2-Norm(final)=12.487 | 5560.0 samples/s | 86.9 steps/s
[Step=14150 Epoch=69.4] | Loss=0.07519 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.743 | L2-Norm(final)=12.484 | 5671.3 samples/s | 88.6 steps/s
[Step=14200 Epoch=69.6] | Loss=0.07325 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.743 | L2-Norm(final)=12.489 | 8916.6 samples/s | 139.3 steps/s
[Step=14250 Epoch=69.9] | Loss=0.07307 | Reg=0.00138 | acc=0.9531 | L2-Norm=11.743 | L2-Norm(final)=12.500 | 2400.3 samples/s | 37.5 steps/s
[Step=14300 Epoch=70.1] | Loss=0.07325 | Reg=0.00138 | acc=0.9531 | L2-Norm=11.743 | L2-Norm(final)=12.512 | 5735.4 samples/s | 89.6 steps/s
[Step=14350 Epoch=70.4] | Loss=0.07260 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.743 | L2-Norm(final)=12.522 | 5557.9 samples/s | 86.8 steps/s
[Step=14400 Epoch=70.6] | Loss=0.07244 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.743 | L2-Norm(final)=12.534 | 8344.8 samples/s | 130.4 steps/s
[Step=14450 Epoch=70.9] | Loss=0.07200 | Reg=0.00138 | acc=0.9219 | L2-Norm=11.743 | L2-Norm(final)=12.546 | 2468.3 samples/s | 38.6 steps/s
[Step=14500 Epoch=71.1] | Loss=0.07181 | Reg=0.00138 | acc=0.9531 | L2-Norm=11.743 | L2-Norm(final)=12.560 | 5685.2 samples/s | 88.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=71.1] | Loss=0.04508 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.743 | L2-Norm(final)=12.695 | 5745.2 samples/s | 89.8 steps/s
[Step=14550 Epoch=71.4] | Loss=0.05226 | Reg=0.00141 | acc=0.9531 | L2-Norm=11.867 | L2-Norm(final)=12.693 | 4417.2 samples/s | 69.0 steps/s
[Step=14600 Epoch=71.6] | Loss=0.05234 | Reg=0.00144 | acc=0.9688 | L2-Norm=11.984 | L2-Norm(final)=12.682 | 4932.2 samples/s | 77.1 steps/s
[Step=14650 Epoch=71.8] | Loss=0.04991 | Reg=0.00146 | acc=0.9531 | L2-Norm=12.069 | L2-Norm(final)=12.671 | 4814.6 samples/s | 75.2 steps/s
[Step=14700 Epoch=72.1] | Loss=0.04741 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.134 | L2-Norm(final)=12.663 | 7127.1 samples/s | 111.4 steps/s
[Step=14750 Epoch=72.3] | Loss=0.04256 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.187 | L2-Norm(final)=12.660 | 2242.8 samples/s | 35.0 steps/s
[Step=14800 Epoch=72.6] | Loss=0.03830 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.230 | L2-Norm(final)=12.660 | 4798.3 samples/s | 75.0 steps/s
[Step=14850 Epoch=72.8] | Loss=0.03511 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=12.662 | 4866.0 samples/s | 76.0 steps/s
[Step=14900 Epoch=73.1] | Loss=0.03313 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=12.663 | 6671.3 samples/s | 104.2 steps/s
[Step=14950 Epoch=73.3] | Loss=0.03070 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.323 | L2-Norm(final)=12.665 | 2311.8 samples/s | 36.1 steps/s
[Step=15000 Epoch=73.6] | Loss=0.02867 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.346 | L2-Norm(final)=12.667 | 4766.5 samples/s | 74.5 steps/s
[Step=15050 Epoch=73.8] | Loss=0.02681 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.365 | L2-Norm(final)=12.670 | 4882.1 samples/s | 76.3 steps/s
[Step=15100 Epoch=74.0] | Loss=0.02547 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.383 | L2-Norm(final)=12.673 | 6272.2 samples/s | 98.0 steps/s
[Step=15150 Epoch=74.3] | Loss=0.02441 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.399 | L2-Norm(final)=12.675 | 2323.3 samples/s | 36.3 steps/s
[Step=15200 Epoch=74.5] | Loss=0.02329 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.414 | L2-Norm(final)=12.677 | 4939.8 samples/s | 77.2 steps/s
[Step=15250 Epoch=74.8] | Loss=0.02218 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.427 | L2-Norm(final)=12.680 | 4811.1 samples/s | 75.2 steps/s
[Step=15300 Epoch=75.0] | Loss=0.02126 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=12.682 | 5897.5 samples/s | 92.1 steps/s
[Step=15350 Epoch=75.3] | Loss=0.02047 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.450 | L2-Norm(final)=12.684 | 2404.4 samples/s | 37.6 steps/s
[Step=15400 Epoch=75.5] | Loss=0.01981 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=12.686 | 4902.1 samples/s | 76.6 steps/s
[Step=15450 Epoch=75.8] | Loss=0.01921 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.470 | L2-Norm(final)=12.688 | 4762.2 samples/s | 74.4 steps/s
[Step=15500 Epoch=76.0] | Loss=0.01853 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.478 | L2-Norm(final)=12.690 | 5606.6 samples/s | 87.6 steps/s
[Step=15550 Epoch=76.3] | Loss=0.01784 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=12.692 | 2442.0 samples/s | 38.2 steps/s
[Step=15600 Epoch=76.5] | Loss=0.01728 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=12.694 | 4899.9 samples/s | 76.6 steps/s
[Step=15650 Epoch=76.7] | Loss=0.01678 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.502 | L2-Norm(final)=12.697 | 4848.3 samples/s | 75.8 steps/s
[Step=15700 Epoch=77.0] | Loss=0.01630 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.509 | L2-Norm(final)=12.699 | 5353.3 samples/s | 83.6 steps/s
[Step=15750 Epoch=77.2] | Loss=0.01581 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=12.701 | 2511.7 samples/s | 39.2 steps/s
[Step=15800 Epoch=77.5] | Loss=0.01538 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=12.703 | 4868.0 samples/s | 76.1 steps/s
[Step=15850 Epoch=77.7] | Loss=0.01505 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=12.705 | 4859.5 samples/s | 75.9 steps/s
[Step=15900 Epoch=78.0] | Loss=0.01469 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.531 | L2-Norm(final)=12.706 | 5044.2 samples/s | 78.8 steps/s
[Step=15950 Epoch=78.2] | Loss=0.01433 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.536 | L2-Norm(final)=12.709 | 2588.1 samples/s | 40.4 steps/s
[Step=16000 Epoch=78.5] | Loss=0.01403 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.541 | L2-Norm(final)=12.711 | 4823.6 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=132.7] | Loss=0.01104 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.742 | L2-Norm(final)=12.698 | 5887.5 samples/s | 92.0 steps/s
[Step=14050 Epoch=133.1] | Loss=0.00485 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.739 | L2-Norm(final)=12.716 | 4412.6 samples/s | 68.9 steps/s
[Step=14100 Epoch=133.6] | Loss=0.00456 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=12.739 | 8389.8 samples/s | 131.1 steps/s
[Step=14150 Epoch=134.1] | Loss=0.00489 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=12.762 | 1836.9 samples/s | 28.7 steps/s
[Step=14200 Epoch=134.6] | Loss=0.00465 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=12.785 | 7017.2 samples/s | 109.6 steps/s
[Step=14250 Epoch=135.0] | Loss=0.00480 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.738 | L2-Norm(final)=12.806 | 2420.8 samples/s | 37.8 steps/s
[Step=14300 Epoch=135.5] | Loss=0.00475 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=12.827 | 6549.8 samples/s | 102.3 steps/s
[Step=14350 Epoch=136.0] | Loss=0.00477 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=12.848 | 2554.9 samples/s | 39.9 steps/s
[Step=14400 Epoch=136.5] | Loss=0.00468 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=12.868 | 5991.7 samples/s | 93.6 steps/s
[Step=14450 Epoch=136.9] | Loss=0.00474 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=12.889 | 2647.9 samples/s | 41.4 steps/s
[Step=14500 Epoch=137.4] | Loss=0.00468 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=12.909 | 5505.4 samples/s | 86.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=137.4] | Loss=0.00382 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=13.110 | 5666.0 samples/s | 88.5 steps/s
[Step=14550 Epoch=137.9] | Loss=0.00188 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.765 | L2-Norm(final)=13.122 | 4179.3 samples/s | 65.3 steps/s
[Step=14600 Epoch=138.3] | Loss=0.00188 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.808 | L2-Norm(final)=13.123 | 6649.9 samples/s | 103.9 steps/s
[Step=14650 Epoch=138.8] | Loss=0.00199 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.848 | L2-Norm(final)=13.122 | 2185.0 samples/s | 34.1 steps/s
[Step=14700 Epoch=139.3] | Loss=0.00162 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.871 | L2-Norm(final)=13.121 | 6078.7 samples/s | 95.0 steps/s
[Step=14750 Epoch=139.8] | Loss=0.00136 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.885 | L2-Norm(final)=13.121 | 2285.2 samples/s | 35.7 steps/s
[Step=14800 Epoch=140.2] | Loss=0.00114 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.891 | L2-Norm(final)=13.122 | 5486.4 samples/s | 85.7 steps/s
[Step=14850 Epoch=140.7] | Loss=0.00098 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.890 | L2-Norm(final)=13.123 | 2360.9 samples/s | 36.9 steps/s
[Step=14900 Epoch=141.2] | Loss=0.00086 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.884 | L2-Norm(final)=13.124 | 5099.3 samples/s | 79.7 steps/s
[Step=14950 Epoch=141.7] | Loss=0.00077 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.876 | L2-Norm(final)=13.125 | 2460.5 samples/s | 38.4 steps/s
[Step=15000 Epoch=142.1] | Loss=0.00069 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.866 | L2-Norm(final)=13.125 | 4705.4 samples/s | 73.5 steps/s
[Step=15050 Epoch=142.6] | Loss=0.00063 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.854 | L2-Norm(final)=13.126 | 2519.1 samples/s | 39.4 steps/s
[Step=15100 Epoch=143.1] | Loss=0.00057 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.841 | L2-Norm(final)=13.126 | 4608.0 samples/s | 72.0 steps/s
[Step=15150 Epoch=143.6] | Loss=0.00053 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.827 | L2-Norm(final)=13.127 | 2563.3 samples/s | 40.1 steps/s
[Step=15200 Epoch=144.0] | Loss=0.00049 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.813 | L2-Norm(final)=13.127 | 4717.2 samples/s | 73.7 steps/s
[Step=15250 Epoch=144.5] | Loss=0.00046 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.799 | L2-Norm(final)=13.127 | 2532.0 samples/s | 39.6 steps/s
[Step=15300 Epoch=145.0] | Loss=0.00043 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.784 | L2-Norm(final)=13.128 | 4623.6 samples/s | 72.2 steps/s
[Step=15350 Epoch=145.5] | Loss=0.00041 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.769 | L2-Norm(final)=13.128 | 2705.5 samples/s | 42.3 steps/s
[Step=15400 Epoch=145.9] | Loss=0.00038 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.754 | L2-Norm(final)=13.128 | 4319.2 samples/s | 67.5 steps/s
[Step=15450 Epoch=146.4] | Loss=0.00036 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.739 | L2-Norm(final)=13.129 | 6929.7 samples/s | 108.3 steps/s
[Step=15500 Epoch=146.9] | Loss=0.00035 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.724 | L2-Norm(final)=13.129 | 2172.4 samples/s | 33.9 steps/s
[Step=15550 Epoch=147.3] | Loss=0.00033 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.708 | L2-Norm(final)=13.129 | 6272.3 samples/s | 98.0 steps/s
[Step=15600 Epoch=147.8] | Loss=0.00031 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.693 | L2-Norm(final)=13.129 | 2229.7 samples/s | 34.8 steps/s
[Step=15650 Epoch=148.3] | Loss=0.00030 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.677 | L2-Norm(final)=13.130 | 5735.4 samples/s | 89.6 steps/s
[Step=15700 Epoch=148.8] | Loss=0.00029 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.662 | L2-Norm(final)=13.130 | 2333.6 samples/s | 36.5 steps/s
[Step=15750 Epoch=149.2] | Loss=0.00028 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.646 | L2-Norm(final)=13.130 | 5253.7 samples/s | 82.1 steps/s
[Step=15800 Epoch=149.7] | Loss=0.00027 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.631 | L2-Norm(final)=13.131 | 2411.0 samples/s | 37.7 steps/s
[Step=15850 Epoch=150.2] | Loss=0.00026 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.615 | L2-Norm(final)=13.131 | 4782.6 samples/s | 74.7 steps/s
[Step=15900 Epoch=150.7] | Loss=0.00025 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.599 | L2-Norm(final)=13.131 | 2492.0 samples/s | 38.9 steps/s
[Step=15950 Epoch=151.1] | Loss=0.00024 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.584 | L2-Norm(final)=13.131 | 4591.0 samples/s | 71.7 steps/s
[Step=16000 Epoch=151.6] | Loss=0.00023 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.568 | L2-Norm(final)=13.131 | 2558.2 samples/s | 40.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11013 | acc=0.9529 | tpr=0.9631 | fpr=0.0694 | 5515.0 samples/s | 21.5 steps/s
Avg test loss: 0.11660, Avg test acc: 0.95132, Avg tpr: 0.96229, Avg fpr: 0.07281, total FA: 568

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.11523 | acc=0.9520 | tpr=0.9644 | fpr=0.0748 | 5603.4 samples/s | 21.9 steps/s
Avg test loss: 0.12062, Avg test acc: 0.95040, Avg tpr: 0.96194, Avg fpr: 0.07499, total FA: 585

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.12808 | acc=0.9516 | tpr=0.9734 | fpr=0.0959 | 5840.9 samples/s | 22.8 steps/s
Avg test loss: 0.13175, Avg test acc: 0.95024, Avg tpr: 0.97103, Avg fpr: 0.09550, total FA: 745

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.11446 | acc=0.9525 | tpr=0.9710 | fpr=0.0877 | 5642.7 samples/s | 22.0 steps/s
Avg test loss: 0.12209, Avg test acc: 0.95092, Avg tpr: 0.96981, Avg fpr: 0.09063, total FA: 707

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.12649 | acc=0.9449 | tpr=0.9461 | fpr=0.0577 | 5756.7 samples/s | 22.5 steps/s
Avg test loss: 0.13092, Avg test acc: 0.94439, Avg tpr: 0.94515, Avg fpr: 0.05730, total FA: 447

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.84577 | acc=0.3050 | tpr=0.0041 | fpr=0.0416 | 5723.9 samples/s | 22.4 steps/s
Avg test loss: 4.86368, Avg test acc: 0.30167, Avg tpr: 0.00315, Avg fpr: 0.04179, total FA: 326

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.61288 | acc=0.2941 | tpr=0.0064 | fpr=0.0813 | 5815.3 samples/s | 22.7 steps/s
Avg test loss: 4.63156, Avg test acc: 0.29141, Avg tpr: 0.00606, Avg fpr: 0.08102, total FA: 632

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.20146 | acc=0.3065 | tpr=0.0199 | fpr=0.0711 | 5733.9 samples/s | 22.4 steps/s
Avg test loss: 5.21857, Avg test acc: 0.30451, Avg tpr: 0.01888, Avg fpr: 0.06730, total FA: 525

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.98545 | acc=0.3105 | tpr=0.0105 | fpr=0.0382 | 5677.6 samples/s | 22.2 steps/s
Avg test loss: 4.99934, Avg test acc: 0.30916, Avg tpr: 0.01113, Avg fpr: 0.03538, total FA: 276

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.66346 | acc=0.2916 | tpr=0.0112 | fpr=0.0994 | 5824.8 samples/s | 22.8 steps/s
Avg test loss: 4.67909, Avg test acc: 0.29133, Avg tpr: 0.01154, Avg fpr: 0.09332, total FA: 728

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.61533 | acc=0.1503 | tpr=0.2611 | fpr=0.8517 | 5872.6 samples/s | 22.9 steps/s
[Step= 100] | Loss=5.55678 | acc=0.1492 | tpr=0.2559 | fpr=0.8528 | 7954.9 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.56959 | acc=0.1483 | tpr=0.2536 | fpr=0.8537 | 8156.9 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.55594 | acc=0.1486 | tpr=0.2503 | fpr=0.8533 | 8414.0 samples/s | 32.9 steps/s
[Step= 250] | Loss=5.56701 | acc=0.1480 | tpr=0.2550 | fpr=0.8539 | 7736.1 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.56524 | acc=0.1481 | tpr=0.2487 | fpr=0.8537 | 7907.3 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.56622 | acc=0.1479 | tpr=0.2405 | fpr=0.8538 | 8391.6 samples/s | 32.8 steps/s
[Step= 400] | Loss=5.56180 | acc=0.1486 | tpr=0.2429 | fpr=0.8532 | 8199.5 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.56405 | acc=0.1481 | tpr=0.2420 | fpr=0.8536 | 8264.8 samples/s | 32.3 steps/s
[Step= 500] | Loss=5.56576 | acc=0.1480 | tpr=0.2401 | fpr=0.8537 | 7862.7 samples/s | 30.7 steps/s
[Step= 550] | Loss=5.56255 | acc=0.1478 | tpr=0.2372 | fpr=0.8538 | 9658.0 samples/s | 37.7 steps/s
Avg test loss: 5.56199, Avg test acc: 0.14763, Avg tpr: 0.23693, Avg fpr: 0.85399, total FA: 118575

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.91465 | acc=0.1604 | tpr=0.2080 | fpr=0.8405 | 5899.5 samples/s | 23.0 steps/s
[Step= 100] | Loss=4.88687 | acc=0.1597 | tpr=0.1770 | fpr=0.8406 | 7871.5 samples/s | 30.7 steps/s
[Step= 150] | Loss=4.89601 | acc=0.1572 | tpr=0.1700 | fpr=0.8430 | 7720.0 samples/s | 30.2 steps/s
[Step= 200] | Loss=4.89097 | acc=0.1585 | tpr=0.1716 | fpr=0.8417 | 7987.8 samples/s | 31.2 steps/s
[Step= 250] | Loss=4.89427 | acc=0.1585 | tpr=0.1747 | fpr=0.8418 | 8264.8 samples/s | 32.3 steps/s
[Step= 300] | Loss=4.89723 | acc=0.1575 | tpr=0.1775 | fpr=0.8429 | 7655.3 samples/s | 29.9 steps/s
[Step= 350] | Loss=4.90181 | acc=0.1567 | tpr=0.1697 | fpr=0.8436 | 8544.1 samples/s | 33.4 steps/s
[Step= 400] | Loss=4.90097 | acc=0.1574 | tpr=0.1707 | fpr=0.8428 | 7852.8 samples/s | 30.7 steps/s
[Step= 450] | Loss=4.90089 | acc=0.1574 | tpr=0.1699 | fpr=0.8428 | 8232.6 samples/s | 32.2 steps/s
[Step= 500] | Loss=4.90044 | acc=0.1575 | tpr=0.1678 | fpr=0.8427 | 7782.0 samples/s | 30.4 steps/s
[Step= 550] | Loss=4.89797 | acc=0.1573 | tpr=0.1695 | fpr=0.8429 | 10674.6 samples/s | 41.7 steps/s
Avg test loss: 4.89808, Avg test acc: 0.15720, Avg tpr: 0.16918, Avg fpr: 0.84302, total FA: 117051

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.91428 | acc=0.1209 | tpr=0.3673 | fpr=0.8835 | 5568.8 samples/s | 21.8 steps/s
[Step= 100] | Loss=6.87187 | acc=0.1213 | tpr=0.3390 | fpr=0.8827 | 7753.1 samples/s | 30.3 steps/s
[Step= 150] | Loss=6.87800 | acc=0.1201 | tpr=0.3184 | fpr=0.8836 | 8134.8 samples/s | 31.8 steps/s
[Step= 200] | Loss=6.87088 | acc=0.1211 | tpr=0.3137 | fpr=0.8825 | 8034.2 samples/s | 31.4 steps/s
[Step= 250] | Loss=6.86694 | acc=0.1217 | tpr=0.3258 | fpr=0.8820 | 8010.0 samples/s | 31.3 steps/s
[Step= 300] | Loss=6.86870 | acc=0.1215 | tpr=0.3287 | fpr=0.8823 | 7964.1 samples/s | 31.1 steps/s
[Step= 350] | Loss=6.87762 | acc=0.1206 | tpr=0.3181 | fpr=0.8830 | 8416.7 samples/s | 32.9 steps/s
[Step= 400] | Loss=6.87425 | acc=0.1210 | tpr=0.3206 | fpr=0.8826 | 8344.0 samples/s | 32.6 steps/s
[Step= 450] | Loss=6.87459 | acc=0.1207 | tpr=0.3155 | fpr=0.8829 | 8042.2 samples/s | 31.4 steps/s
[Step= 500] | Loss=6.87712 | acc=0.1205 | tpr=0.3128 | fpr=0.8830 | 7677.2 samples/s | 30.0 steps/s
[Step= 550] | Loss=6.87147 | acc=0.1207 | tpr=0.3112 | fpr=0.8828 | 11005.7 samples/s | 43.0 steps/s
Avg test loss: 6.87160, Avg test acc: 0.12054, Avg tpr: 0.31181, Avg fpr: 0.88294, total FA: 122594

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.04558 | acc=0.1468 | tpr=0.2522 | fpr=0.8551 | 5743.4 samples/s | 22.4 steps/s
[Step= 100] | Loss=6.01298 | acc=0.1459 | tpr=0.2239 | fpr=0.8556 | 8001.4 samples/s | 31.3 steps/s
[Step= 150] | Loss=6.01050 | acc=0.1453 | tpr=0.2219 | fpr=0.8561 | 8194.6 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.99766 | acc=0.1452 | tpr=0.2240 | fpr=0.8563 | 7649.7 samples/s | 29.9 steps/s
[Step= 250] | Loss=5.99943 | acc=0.1462 | tpr=0.2210 | fpr=0.8552 | 8278.7 samples/s | 32.3 steps/s
[Step= 300] | Loss=6.00333 | acc=0.1457 | tpr=0.2233 | fpr=0.8557 | 7812.8 samples/s | 30.5 steps/s
[Step= 350] | Loss=6.00394 | acc=0.1451 | tpr=0.2129 | fpr=0.8562 | 7705.9 samples/s | 30.1 steps/s
[Step= 400] | Loss=5.99836 | acc=0.1457 | tpr=0.2177 | fpr=0.8556 | 8310.7 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.99805 | acc=0.1461 | tpr=0.2162 | fpr=0.8552 | 8354.9 samples/s | 32.6 steps/s
[Step= 500] | Loss=6.00011 | acc=0.1460 | tpr=0.2159 | fpr=0.8553 | 8160.7 samples/s | 31.9 steps/s
[Step= 550] | Loss=5.99835 | acc=0.1460 | tpr=0.2145 | fpr=0.8553 | 10251.7 samples/s | 40.0 steps/s
Avg test loss: 5.99833, Avg test acc: 0.14585, Avg tpr: 0.21474, Avg fpr: 0.85540, total FA: 118771

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.08710 | acc=0.1667 | tpr=0.1416 | fpr=0.8328 | 5742.5 samples/s | 22.4 steps/s
[Step= 100] | Loss=5.05271 | acc=0.1671 | tpr=0.1237 | fpr=0.8320 | 8233.7 samples/s | 32.2 steps/s
[Step= 150] | Loss=5.05475 | acc=0.1668 | tpr=0.1196 | fpr=0.8324 | 7273.5 samples/s | 28.4 steps/s
[Step= 200] | Loss=5.04923 | acc=0.1675 | tpr=0.1202 | fpr=0.8317 | 7878.3 samples/s | 30.8 steps/s
[Step= 250] | Loss=5.05718 | acc=0.1673 | tpr=0.1162 | fpr=0.8318 | 8084.2 samples/s | 31.6 steps/s
[Step= 300] | Loss=5.06040 | acc=0.1672 | tpr=0.1207 | fpr=0.8320 | 8596.6 samples/s | 33.6 steps/s
[Step= 350] | Loss=5.06313 | acc=0.1666 | tpr=0.1183 | fpr=0.8325 | 8283.3 samples/s | 32.4 steps/s
[Step= 400] | Loss=5.05747 | acc=0.1673 | tpr=0.1220 | fpr=0.8319 | 7938.1 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.05828 | acc=0.1671 | tpr=0.1217 | fpr=0.8321 | 7726.9 samples/s | 30.2 steps/s
[Step= 500] | Loss=5.05956 | acc=0.1669 | tpr=0.1238 | fpr=0.8323 | 8681.9 samples/s | 33.9 steps/s
[Step= 550] | Loss=5.05596 | acc=0.1672 | tpr=0.1206 | fpr=0.8320 | 10043.0 samples/s | 39.2 steps/s
Avg test loss: 5.05531, Avg test acc: 0.16706, Avg tpr: 0.12044, Avg fpr: 0.83209, total FA: 115534

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10171 | acc=0.9803 | tpr=0.8805 | fpr=0.0179 | 5659.0 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.10577 | acc=0.9802 | tpr=0.8827 | fpr=0.0180 | 8038.6 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.10941 | acc=0.9795 | tpr=0.8934 | fpr=0.0189 | 8075.9 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.11133 | acc=0.9796 | tpr=0.9005 | fpr=0.0190 | 8607.6 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.11102 | acc=0.9797 | tpr=0.8996 | fpr=0.0189 | 7963.4 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.11255 | acc=0.9794 | tpr=0.8945 | fpr=0.0190 | 7592.9 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.11249 | acc=0.9795 | tpr=0.8986 | fpr=0.0191 | 8457.6 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.11299 | acc=0.9792 | tpr=0.8944 | fpr=0.0192 | 8204.3 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.11468 | acc=0.9791 | tpr=0.8929 | fpr=0.0194 | 7314.8 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.11419 | acc=0.9791 | tpr=0.8943 | fpr=0.0194 | 8458.0 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.11382 | acc=0.9791 | tpr=0.8938 | fpr=0.0193 | 10238.1 samples/s | 40.0 steps/s
Avg test loss: 0.11366, Avg test acc: 0.97912, Avg tpr: 0.89342, Avg fpr: 0.01932, total FA: 2683

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09454 | acc=0.9812 | tpr=0.8717 | fpr=0.0169 | 5725.0 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.09749 | acc=0.9809 | tpr=0.8763 | fpr=0.0172 | 7627.0 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.10090 | acc=0.9804 | tpr=0.8919 | fpr=0.0180 | 7547.8 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.10234 | acc=0.9805 | tpr=0.8929 | fpr=0.0179 | 8552.6 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.10236 | acc=0.9806 | tpr=0.8926 | fpr=0.0178 | 8350.3 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.10340 | acc=0.9805 | tpr=0.8931 | fpr=0.0179 | 7754.2 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.10387 | acc=0.9804 | tpr=0.8961 | fpr=0.0180 | 8274.8 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.10469 | acc=0.9803 | tpr=0.8928 | fpr=0.0182 | 8175.7 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.10591 | acc=0.9801 | tpr=0.8900 | fpr=0.0182 | 8425.2 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.10498 | acc=0.9803 | tpr=0.8930 | fpr=0.0181 | 7701.2 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.10392 | acc=0.9804 | tpr=0.8930 | fpr=0.0180 | 10396.4 samples/s | 40.6 steps/s
Avg test loss: 0.10372, Avg test acc: 0.98038, Avg tpr: 0.89184, Avg fpr: 0.01801, total FA: 2501

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12146 | acc=0.9777 | tpr=0.8982 | fpr=0.0208 | 5586.4 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.12592 | acc=0.9768 | tpr=0.9126 | fpr=0.0220 | 8503.0 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.13055 | acc=0.9760 | tpr=0.9193 | fpr=0.0230 | 8139.9 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.13307 | acc=0.9761 | tpr=0.9268 | fpr=0.0230 | 8072.0 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.13388 | acc=0.9763 | tpr=0.9275 | fpr=0.0228 | 8307.5 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.13528 | acc=0.9760 | tpr=0.9251 | fpr=0.0230 | 8105.9 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.13485 | acc=0.9762 | tpr=0.9286 | fpr=0.0230 | 8234.2 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.13658 | acc=0.9758 | tpr=0.9261 | fpr=0.0233 | 7944.4 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.13835 | acc=0.9755 | tpr=0.9221 | fpr=0.0235 | 7709.6 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.13785 | acc=0.9756 | tpr=0.9251 | fpr=0.0235 | 8711.3 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.13669 | acc=0.9757 | tpr=0.9244 | fpr=0.0234 | 9104.8 samples/s | 35.6 steps/s
Avg test loss: 0.13646, Avg test acc: 0.97571, Avg tpr: 0.92393, Avg fpr: 0.02335, total FA: 3242

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11454 | acc=0.9789 | tpr=0.9204 | fpr=0.0200 | 5753.4 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.12055 | acc=0.9792 | tpr=0.9296 | fpr=0.0199 | 8072.4 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.12623 | acc=0.9784 | tpr=0.9323 | fpr=0.0208 | 7988.2 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.12767 | acc=0.9787 | tpr=0.9333 | fpr=0.0205 | 7877.9 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.12676 | acc=0.9786 | tpr=0.9231 | fpr=0.0203 | 8670.9 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.12838 | acc=0.9786 | tpr=0.9229 | fpr=0.0204 | 7833.4 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.12825 | acc=0.9785 | tpr=0.9230 | fpr=0.0205 | 7559.5 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.12925 | acc=0.9783 | tpr=0.9207 | fpr=0.0207 | 8400.3 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.13090 | acc=0.9781 | tpr=0.9182 | fpr=0.0208 | 8143.5 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.13023 | acc=0.9781 | tpr=0.9203 | fpr=0.0209 | 8724.4 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.12959 | acc=0.9782 | tpr=0.9200 | fpr=0.0208 | 9367.2 samples/s | 36.6 steps/s
Avg test loss: 0.12942, Avg test acc: 0.97816, Avg tpr: 0.91957, Avg fpr: 0.02077, total FA: 2884

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.09341 | acc=0.9803 | tpr=0.8982 | fpr=0.0182 | 5627.9 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.09714 | acc=0.9799 | tpr=0.9190 | fpr=0.0190 | 7593.7 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.10157 | acc=0.9792 | tpr=0.9308 | fpr=0.0199 | 8430.4 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.10282 | acc=0.9792 | tpr=0.9311 | fpr=0.0199 | 8612.1 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.10240 | acc=0.9793 | tpr=0.9293 | fpr=0.0198 | 8376.7 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.10403 | acc=0.9791 | tpr=0.9265 | fpr=0.0199 | 7873.1 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.10381 | acc=0.9793 | tpr=0.9280 | fpr=0.0198 | 8157.0 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.10519 | acc=0.9791 | tpr=0.9256 | fpr=0.0199 | 7708.9 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.10713 | acc=0.9788 | tpr=0.9226 | fpr=0.0202 | 8246.1 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.10664 | acc=0.9788 | tpr=0.9229 | fpr=0.0202 | 8286.1 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.10618 | acc=0.9789 | tpr=0.9216 | fpr=0.0201 | 9879.8 samples/s | 38.6 steps/s
Avg test loss: 0.10600, Avg test acc: 0.97890, Avg tpr: 0.92155, Avg fpr: 0.02006, total FA: 2785

server round 13/50

clients selected: [1 4 7 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=87.8] | Loss=0.01101 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.515 | L2-Norm(final)=13.194 | 5830.8 samples/s | 91.1 steps/s
[Step=18050 Epoch=88.1] | Loss=0.06143 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.515 | L2-Norm(final)=13.204 | 4995.0 samples/s | 78.0 steps/s
[Step=18100 Epoch=88.3] | Loss=0.06330 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.515 | L2-Norm(final)=13.211 | 5586.7 samples/s | 87.3 steps/s
[Step=18150 Epoch=88.6] | Loss=0.06326 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.515 | L2-Norm(final)=13.218 | 5597.0 samples/s | 87.5 steps/s
[Step=18200 Epoch=88.8] | Loss=0.06385 | Reg=0.00133 | acc=0.9219 | L2-Norm=11.515 | L2-Norm(final)=13.225 | 8865.7 samples/s | 138.5 steps/s
[Step=18250 Epoch=89.1] | Loss=0.06320 | Reg=0.00133 | acc=0.9062 | L2-Norm=11.515 | L2-Norm(final)=13.234 | 2414.7 samples/s | 37.7 steps/s
[Step=18300 Epoch=89.3] | Loss=0.06322 | Reg=0.00133 | acc=0.9375 | L2-Norm=11.515 | L2-Norm(final)=13.242 | 5778.0 samples/s | 90.3 steps/s
[Step=18350 Epoch=89.5] | Loss=0.06305 | Reg=0.00133 | acc=0.9219 | L2-Norm=11.515 | L2-Norm(final)=13.252 | 5560.3 samples/s | 86.9 steps/s
[Step=18400 Epoch=89.8] | Loss=0.06300 | Reg=0.00133 | acc=0.8906 | L2-Norm=11.515 | L2-Norm(final)=13.263 | 7823.4 samples/s | 122.2 steps/s
[Step=18450 Epoch=90.0] | Loss=0.06251 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.515 | L2-Norm(final)=13.275 | 2488.9 samples/s | 38.9 steps/s
[Step=18500 Epoch=90.3] | Loss=0.06222 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.515 | L2-Norm(final)=13.288 | 5591.9 samples/s | 87.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=90.3] | Loss=0.05717 | Reg=0.00133 | acc=0.9375 | L2-Norm=11.515 | L2-Norm(final)=13.424 | 5837.5 samples/s | 91.2 steps/s
[Step=18550 Epoch=90.5] | Loss=0.05838 | Reg=0.00136 | acc=0.9531 | L2-Norm=11.661 | L2-Norm(final)=13.420 | 4308.2 samples/s | 67.3 steps/s
[Step=18600 Epoch=90.8] | Loss=0.05259 | Reg=0.00139 | acc=0.9531 | L2-Norm=11.801 | L2-Norm(final)=13.406 | 4902.7 samples/s | 76.6 steps/s
[Step=18650 Epoch=91.0] | Loss=0.05069 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.893 | L2-Norm(final)=13.396 | 4825.0 samples/s | 75.4 steps/s
[Step=18700 Epoch=91.2] | Loss=0.04814 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.961 | L2-Norm(final)=13.389 | 6966.0 samples/s | 108.8 steps/s
[Step=18750 Epoch=91.5] | Loss=0.04285 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.014 | L2-Norm(final)=13.386 | 2242.5 samples/s | 35.0 steps/s
[Step=18800 Epoch=91.7] | Loss=0.03858 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.056 | L2-Norm(final)=13.387 | 4873.9 samples/s | 76.2 steps/s
[Step=18850 Epoch=92.0] | Loss=0.03567 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.092 | L2-Norm(final)=13.388 | 4925.6 samples/s | 77.0 steps/s
[Step=18900 Epoch=92.2] | Loss=0.03350 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.121 | L2-Norm(final)=13.389 | 6410.1 samples/s | 100.2 steps/s
[Step=18950 Epoch=92.5] | Loss=0.03097 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.147 | L2-Norm(final)=13.390 | 2314.0 samples/s | 36.2 steps/s
[Step=19000 Epoch=92.7] | Loss=0.02911 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=13.392 | 4909.2 samples/s | 76.7 steps/s
[Step=19050 Epoch=93.0] | Loss=0.02747 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.188 | L2-Norm(final)=13.394 | 4846.0 samples/s | 75.7 steps/s
[Step=19100 Epoch=93.2] | Loss=0.02610 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.205 | L2-Norm(final)=13.395 | 5956.7 samples/s | 93.1 steps/s
[Step=19150 Epoch=93.4] | Loss=0.02477 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.221 | L2-Norm(final)=13.397 | 2369.6 samples/s | 37.0 steps/s
[Step=19200 Epoch=93.7] | Loss=0.02339 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.235 | L2-Norm(final)=13.399 | 4798.7 samples/s | 75.0 steps/s
[Step=19250 Epoch=93.9] | Loss=0.02245 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.247 | L2-Norm(final)=13.401 | 4843.7 samples/s | 75.7 steps/s
[Step=19300 Epoch=94.2] | Loss=0.02153 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=13.403 | 5654.8 samples/s | 88.4 steps/s
[Step=19350 Epoch=94.4] | Loss=0.02059 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=13.405 | 2465.9 samples/s | 38.5 steps/s
[Step=19400 Epoch=94.7] | Loss=0.01971 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.278 | L2-Norm(final)=13.407 | 4838.6 samples/s | 75.6 steps/s
[Step=19450 Epoch=94.9] | Loss=0.01908 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=13.409 | 4850.1 samples/s | 75.8 steps/s
[Step=19500 Epoch=95.2] | Loss=0.01833 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.295 | L2-Norm(final)=13.411 | 5293.5 samples/s | 82.7 steps/s
[Step=19550 Epoch=95.4] | Loss=0.01769 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=13.413 | 2519.1 samples/s | 39.4 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01734 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.310 | L2-Norm(final)=13.415 | 4857.9 samples/s | 75.9 steps/s
[Step=19650 Epoch=95.9] | Loss=0.01696 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.317 | L2-Norm(final)=13.416 | 4916.1 samples/s | 76.8 steps/s
[Step=19700 Epoch=96.1] | Loss=0.01649 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=13.418 | 4881.8 samples/s | 76.3 steps/s
[Step=19750 Epoch=96.4] | Loss=0.01611 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.330 | L2-Norm(final)=13.420 | 2593.1 samples/s | 40.5 steps/s
[Step=19800 Epoch=96.6] | Loss=0.01563 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.335 | L2-Norm(final)=13.421 | 4875.7 samples/s | 76.2 steps/s
[Step=19850 Epoch=96.9] | Loss=0.01527 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.341 | L2-Norm(final)=13.423 | 4874.7 samples/s | 76.2 steps/s
[Step=19900 Epoch=97.1] | Loss=0.01489 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.346 | L2-Norm(final)=13.425 | 4836.7 samples/s | 75.6 steps/s
[Step=19950 Epoch=97.3] | Loss=0.01455 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.351 | L2-Norm(final)=13.427 | 2603.9 samples/s | 40.7 steps/s
[Step=20000 Epoch=97.6] | Loss=0.01423 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.355 | L2-Norm(final)=13.428 | 4841.3 samples/s | 75.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step20000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=78.5] | Loss=0.02383 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.515 | L2-Norm(final)=12.771 | 5337.5 samples/s | 83.4 steps/s
[Step=16050 Epoch=78.7] | Loss=0.06042 | Reg=0.00133 | acc=0.9531 | L2-Norm=11.515 | L2-Norm(final)=12.782 | 5330.8 samples/s | 83.3 steps/s
[Step=16100 Epoch=79.0] | Loss=0.05997 | Reg=0.00133 | acc=0.9375 | L2-Norm=11.515 | L2-Norm(final)=12.793 | 5566.5 samples/s | 87.0 steps/s
[Step=16150 Epoch=79.2] | Loss=0.05814 | Reg=0.00133 | acc=0.9531 | L2-Norm=11.515 | L2-Norm(final)=12.809 | 5656.8 samples/s | 88.4 steps/s
[Step=16200 Epoch=79.4] | Loss=0.05714 | Reg=0.00133 | acc=0.9219 | L2-Norm=11.515 | L2-Norm(final)=12.831 | 9018.8 samples/s | 140.9 steps/s
[Step=16250 Epoch=79.7] | Loss=0.05809 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.515 | L2-Norm(final)=12.853 | 2396.0 samples/s | 37.4 steps/s
[Step=16300 Epoch=79.9] | Loss=0.05805 | Reg=0.00133 | acc=0.8594 | L2-Norm=11.515 | L2-Norm(final)=12.872 | 5656.0 samples/s | 88.4 steps/s
[Step=16350 Epoch=80.2] | Loss=0.05736 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.515 | L2-Norm(final)=12.892 | 5701.6 samples/s | 89.1 steps/s
[Step=16400 Epoch=80.4] | Loss=0.05705 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.515 | L2-Norm(final)=12.912 | 8154.6 samples/s | 127.4 steps/s
[Step=16450 Epoch=80.7] | Loss=0.05709 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.515 | L2-Norm(final)=12.932 | 2437.6 samples/s | 38.1 steps/s
[Step=16500 Epoch=80.9] | Loss=0.05690 | Reg=0.00133 | acc=0.9531 | L2-Norm=11.515 | L2-Norm(final)=12.952 | 5636.5 samples/s | 88.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=80.9] | Loss=0.04880 | Reg=0.00133 | acc=0.9531 | L2-Norm=11.515 | L2-Norm(final)=13.158 | 5705.5 samples/s | 89.1 steps/s
[Step=16550 Epoch=81.2] | Loss=0.05710 | Reg=0.00136 | acc=0.9375 | L2-Norm=11.674 | L2-Norm(final)=13.153 | 4440.0 samples/s | 69.4 steps/s
[Step=16600 Epoch=81.4] | Loss=0.05352 | Reg=0.00139 | acc=0.9531 | L2-Norm=11.807 | L2-Norm(final)=13.137 | 4887.2 samples/s | 76.4 steps/s
[Step=16650 Epoch=81.6] | Loss=0.04945 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.897 | L2-Norm(final)=13.129 | 4872.5 samples/s | 76.1 steps/s
[Step=16700 Epoch=81.9] | Loss=0.04533 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.964 | L2-Norm(final)=13.125 | 7122.0 samples/s | 111.3 steps/s
[Step=16750 Epoch=82.1] | Loss=0.03934 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.018 | L2-Norm(final)=13.125 | 2245.0 samples/s | 35.1 steps/s
[Step=16800 Epoch=82.4] | Loss=0.03620 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.060 | L2-Norm(final)=13.125 | 4841.4 samples/s | 75.6 steps/s
[Step=16850 Epoch=82.6] | Loss=0.03428 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.097 | L2-Norm(final)=13.125 | 4863.2 samples/s | 76.0 steps/s
[Step=16900 Epoch=82.9] | Loss=0.03221 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.131 | L2-Norm(final)=13.126 | 6710.9 samples/s | 104.9 steps/s
[Step=16950 Epoch=83.1] | Loss=0.03016 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.162 | L2-Norm(final)=13.128 | 2288.5 samples/s | 35.8 steps/s
[Step=17000 Epoch=83.4] | Loss=0.02796 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.189 | L2-Norm(final)=13.130 | 4916.0 samples/s | 76.8 steps/s
[Step=17050 Epoch=83.6] | Loss=0.02628 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=13.132 | 4814.9 samples/s | 75.2 steps/s
[Step=17100 Epoch=83.9] | Loss=0.02544 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.233 | L2-Norm(final)=13.134 | 6324.1 samples/s | 98.8 steps/s
[Step=17150 Epoch=84.1] | Loss=0.02412 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=13.135 | 2348.0 samples/s | 36.7 steps/s
[Step=17200 Epoch=84.3] | Loss=0.02295 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=13.136 | 4799.2 samples/s | 75.0 steps/s
[Step=17250 Epoch=84.6] | Loss=0.02205 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=13.138 | 4892.1 samples/s | 76.4 steps/s
[Step=17300 Epoch=84.8] | Loss=0.02095 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=13.139 | 5898.2 samples/s | 92.2 steps/s
[Step=17350 Epoch=85.1] | Loss=0.02018 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=13.141 | 2402.9 samples/s | 37.5 steps/s
[Step=17400 Epoch=85.3] | Loss=0.01933 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.318 | L2-Norm(final)=13.143 | 4829.6 samples/s | 75.5 steps/s
[Step=17450 Epoch=85.6] | Loss=0.01861 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.328 | L2-Norm(final)=13.145 | 4869.8 samples/s | 76.1 steps/s
[Step=17500 Epoch=85.8] | Loss=0.01794 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.337 | L2-Norm(final)=13.147 | 5612.1 samples/s | 87.7 steps/s
[Step=17550 Epoch=86.1] | Loss=0.01741 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.345 | L2-Norm(final)=13.149 | 2475.7 samples/s | 38.7 steps/s
[Step=17600 Epoch=86.3] | Loss=0.01678 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.352 | L2-Norm(final)=13.151 | 4807.1 samples/s | 75.1 steps/s
[Step=17650 Epoch=86.6] | Loss=0.01630 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.359 | L2-Norm(final)=13.153 | 4909.5 samples/s | 76.7 steps/s
[Step=17700 Epoch=86.8] | Loss=0.01584 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.366 | L2-Norm(final)=13.155 | 5274.9 samples/s | 82.4 steps/s
[Step=17750 Epoch=87.0] | Loss=0.01533 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.372 | L2-Norm(final)=13.157 | 2496.6 samples/s | 39.0 steps/s
[Step=17800 Epoch=87.3] | Loss=0.01494 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.377 | L2-Norm(final)=13.159 | 4903.6 samples/s | 76.6 steps/s
[Step=17850 Epoch=87.5] | Loss=0.01458 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.383 | L2-Norm(final)=13.161 | 4794.1 samples/s | 74.9 steps/s
[Step=17900 Epoch=87.8] | Loss=0.01429 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.387 | L2-Norm(final)=13.162 | 5083.8 samples/s | 79.4 steps/s
[Step=17950 Epoch=88.0] | Loss=0.01390 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=13.164 | 2604.6 samples/s | 40.7 steps/s
[Step=18000 Epoch=88.3] | Loss=0.01354 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.396 | L2-Norm(final)=13.166 | 4872.6 samples/s | 76.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step18000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=95.5] | Loss=0.00121 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.515 | L2-Norm(final)=12.515 | 5302.7 samples/s | 82.9 steps/s
[Step=10050 Epoch=96.0] | Loss=0.00726 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.509 | L2-Norm(final)=12.585 | 4896.0 samples/s | 76.5 steps/s
[Step=10100 Epoch=96.4] | Loss=0.00705 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.508 | L2-Norm(final)=12.661 | 8323.0 samples/s | 130.0 steps/s
[Step=10150 Epoch=96.9] | Loss=0.00674 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.508 | L2-Norm(final)=12.718 | 2344.7 samples/s | 36.6 steps/s
[Step=10200 Epoch=97.4] | Loss=0.00666 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.508 | L2-Norm(final)=12.772 | 7599.4 samples/s | 118.7 steps/s
[Step=10250 Epoch=97.9] | Loss=0.00655 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=12.819 | 2403.2 samples/s | 37.6 steps/s
[Step=10300 Epoch=98.4] | Loss=0.00648 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=12.861 | 6945.1 samples/s | 108.5 steps/s
[Step=10350 Epoch=98.8] | Loss=0.00619 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=12.903 | 2482.5 samples/s | 38.8 steps/s
[Step=10400 Epoch=99.3] | Loss=0.00613 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=12.943 | 6337.6 samples/s | 99.0 steps/s
[Step=10450 Epoch=99.8] | Loss=0.00599 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=12.981 | 2547.1 samples/s | 39.8 steps/s
[Step=10500 Epoch=100.3] | Loss=0.00599 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=13.016 | 5894.0 samples/s | 92.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=100.3] | Loss=0.00092 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=13.367 | 6149.7 samples/s | 96.1 steps/s
[Step=10550 Epoch=100.7] | Loss=0.00592 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.641 | L2-Norm(final)=13.383 | 3944.3 samples/s | 61.6 steps/s
[Step=10600 Epoch=101.2] | Loss=0.00565 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.816 | L2-Norm(final)=13.370 | 6621.4 samples/s | 103.5 steps/s
[Step=10650 Epoch=101.7] | Loss=0.00395 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=13.366 | 2198.4 samples/s | 34.4 steps/s
[Step=10700 Epoch=102.2] | Loss=0.00303 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.948 | L2-Norm(final)=13.366 | 6087.5 samples/s | 95.1 steps/s
[Step=10750 Epoch=102.7] | Loss=0.00246 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=13.367 | 2254.8 samples/s | 35.2 steps/s
[Step=10800 Epoch=103.1] | Loss=0.00205 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.984 | L2-Norm(final)=13.368 | 5793.8 samples/s | 90.5 steps/s
[Step=10850 Epoch=103.6] | Loss=0.00176 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.985 | L2-Norm(final)=13.369 | 2350.4 samples/s | 36.7 steps/s
[Step=10900 Epoch=104.1] | Loss=0.00154 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.980 | L2-Norm(final)=13.370 | 5218.6 samples/s | 81.5 steps/s
[Step=10950 Epoch=104.6] | Loss=0.00137 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.971 | L2-Norm(final)=13.371 | 2383.4 samples/s | 37.2 steps/s
[Step=11000 Epoch=105.0] | Loss=0.00123 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.961 | L2-Norm(final)=13.371 | 4992.2 samples/s | 78.0 steps/s
[Step=11050 Epoch=105.5] | Loss=0.00112 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.948 | L2-Norm(final)=13.372 | 2472.2 samples/s | 38.6 steps/s
[Step=11100 Epoch=106.0] | Loss=0.00103 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.935 | L2-Norm(final)=13.372 | 4646.6 samples/s | 72.6 steps/s
[Step=11150 Epoch=106.5] | Loss=0.00095 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.921 | L2-Norm(final)=13.372 | 2511.3 samples/s | 39.2 steps/s
[Step=11200 Epoch=107.0] | Loss=0.00088 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.906 | L2-Norm(final)=13.373 | 4639.9 samples/s | 72.5 steps/s
[Step=11250 Epoch=107.4] | Loss=0.00082 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.890 | L2-Norm(final)=13.373 | 2601.5 samples/s | 40.6 steps/s
[Step=11300 Epoch=107.9] | Loss=0.00077 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.875 | L2-Norm(final)=13.374 | 4499.2 samples/s | 70.3 steps/s
[Step=11350 Epoch=108.4] | Loss=0.00073 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.859 | L2-Norm(final)=13.374 | 2558.8 samples/s | 40.0 steps/s
[Step=11400 Epoch=108.9] | Loss=0.00069 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.843 | L2-Norm(final)=13.374 | 4649.3 samples/s | 72.6 steps/s
[Step=11450 Epoch=109.3] | Loss=0.00065 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.827 | L2-Norm(final)=13.375 | 2595.1 samples/s | 40.5 steps/s
[Step=11500 Epoch=109.8] | Loss=0.00062 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.811 | L2-Norm(final)=13.375 | 4515.7 samples/s | 70.6 steps/s
[Step=11550 Epoch=110.3] | Loss=0.00059 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.794 | L2-Norm(final)=13.375 | 7441.5 samples/s | 116.3 steps/s
[Step=11600 Epoch=110.8] | Loss=0.00056 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.778 | L2-Norm(final)=13.375 | 2125.9 samples/s | 33.2 steps/s
[Step=11650 Epoch=111.3] | Loss=0.00054 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.761 | L2-Norm(final)=13.376 | 6826.8 samples/s | 106.7 steps/s
[Step=11700 Epoch=111.7] | Loss=0.00051 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.745 | L2-Norm(final)=13.376 | 2177.4 samples/s | 34.0 steps/s
[Step=11750 Epoch=112.2] | Loss=0.00049 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=13.376 | 6285.3 samples/s | 98.2 steps/s
[Step=11800 Epoch=112.7] | Loss=0.00048 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.712 | L2-Norm(final)=13.377 | 2216.2 samples/s | 34.6 steps/s
[Step=11850 Epoch=113.2] | Loss=0.00046 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.696 | L2-Norm(final)=13.377 | 5837.5 samples/s | 91.2 steps/s
[Step=11900 Epoch=113.6] | Loss=0.00044 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.679 | L2-Norm(final)=13.377 | 2321.6 samples/s | 36.3 steps/s
[Step=11950 Epoch=114.1] | Loss=0.00043 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.663 | L2-Norm(final)=13.378 | 5300.4 samples/s | 82.8 steps/s
[Step=12000 Epoch=114.6] | Loss=0.00041 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.646 | L2-Norm(final)=13.378 | 2396.9 samples/s | 37.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step12000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=94.2] | Loss=0.00289 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.515 | L2-Norm(final)=12.820 | 5667.0 samples/s | 88.5 steps/s
[Step=10050 Epoch=94.7] | Loss=0.01973 | Reg=0.00133 | acc=0.9531 | L2-Norm=11.512 | L2-Norm(final)=12.773 | 4614.7 samples/s | 72.1 steps/s
[Step=10100 Epoch=95.2] | Loss=0.01776 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.512 | L2-Norm(final)=12.725 | 8249.1 samples/s | 128.9 steps/s
[Step=10150 Epoch=95.6] | Loss=0.01762 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.512 | L2-Norm(final)=12.691 | 2394.1 samples/s | 37.4 steps/s
[Step=10200 Epoch=96.1] | Loss=0.01600 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.511 | L2-Norm(final)=12.664 | 6764.0 samples/s | 105.7 steps/s
[Step=10250 Epoch=96.6] | Loss=0.01496 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.511 | L2-Norm(final)=12.645 | 2477.4 samples/s | 38.7 steps/s
[Step=10300 Epoch=97.1] | Loss=0.01464 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.511 | L2-Norm(final)=12.630 | 6298.9 samples/s | 98.4 steps/s
[Step=10350 Epoch=97.5] | Loss=0.01395 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=12.618 | 2571.1 samples/s | 40.2 steps/s
[Step=10400 Epoch=98.0] | Loss=0.01350 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=12.610 | 5652.2 samples/s | 88.3 steps/s
[Step=10450 Epoch=98.5] | Loss=0.01400 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=12.602 | 2705.4 samples/s | 42.3 steps/s
[Step=10500 Epoch=98.9] | Loss=0.01367 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=12.595 | 5390.2 samples/s | 84.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=98.9] | Loss=0.03586 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.511 | L2-Norm(final)=12.542 | 5513.0 samples/s | 86.1 steps/s
[Step=10550 Epoch=99.4] | Loss=0.00652 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.630 | L2-Norm(final)=12.544 | 4319.9 samples/s | 67.5 steps/s
[Step=10600 Epoch=99.9] | Loss=0.00557 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.724 | L2-Norm(final)=12.543 | 6538.9 samples/s | 102.2 steps/s
[Step=10650 Epoch=100.4] | Loss=0.00400 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.783 | L2-Norm(final)=12.542 | 2202.6 samples/s | 34.4 steps/s
[Step=10700 Epoch=100.8] | Loss=0.00337 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.813 | L2-Norm(final)=12.541 | 5944.0 samples/s | 92.9 steps/s
[Step=10750 Epoch=101.3] | Loss=0.00281 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.834 | L2-Norm(final)=12.541 | 2298.0 samples/s | 35.9 steps/s
[Step=10800 Epoch=101.8] | Loss=0.00235 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.844 | L2-Norm(final)=12.542 | 5362.2 samples/s | 83.8 steps/s
[Step=10850 Epoch=102.2] | Loss=0.00202 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.848 | L2-Norm(final)=12.542 | 2388.7 samples/s | 37.3 steps/s
[Step=10900 Epoch=102.7] | Loss=0.00177 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.847 | L2-Norm(final)=12.543 | 4853.1 samples/s | 75.8 steps/s
[Step=10950 Epoch=103.2] | Loss=0.00157 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.843 | L2-Norm(final)=12.543 | 2521.1 samples/s | 39.4 steps/s
[Step=11000 Epoch=103.7] | Loss=0.00142 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.838 | L2-Norm(final)=12.543 | 4640.7 samples/s | 72.5 steps/s
[Step=11050 Epoch=104.1] | Loss=0.00129 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.830 | L2-Norm(final)=12.544 | 2579.0 samples/s | 40.3 steps/s
[Step=11100 Epoch=104.6] | Loss=0.00118 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.822 | L2-Norm(final)=12.544 | 4656.0 samples/s | 72.7 steps/s
[Step=11150 Epoch=105.1] | Loss=0.00109 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.813 | L2-Norm(final)=12.545 | 2584.9 samples/s | 40.4 steps/s
[Step=11200 Epoch=105.5] | Loss=0.00101 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.803 | L2-Norm(final)=12.545 | 4730.7 samples/s | 73.9 steps/s
[Step=11250 Epoch=106.0] | Loss=0.00095 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=12.546 | 2872.1 samples/s | 44.9 steps/s
[Step=11300 Epoch=106.5] | Loss=0.00089 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.782 | L2-Norm(final)=12.546 | 4063.6 samples/s | 63.5 steps/s
[Step=11350 Epoch=106.9] | Loss=0.00084 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.771 | L2-Norm(final)=12.547 | 6768.4 samples/s | 105.8 steps/s
[Step=11400 Epoch=107.4] | Loss=0.00079 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.760 | L2-Norm(final)=12.547 | 2182.1 samples/s | 34.1 steps/s
[Step=11450 Epoch=107.9] | Loss=0.00075 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.749 | L2-Norm(final)=12.547 | 6023.2 samples/s | 94.1 steps/s
[Step=11500 Epoch=108.4] | Loss=0.00071 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.737 | L2-Norm(final)=12.548 | 2283.3 samples/s | 35.7 steps/s
[Step=11550 Epoch=108.8] | Loss=0.00068 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.726 | L2-Norm(final)=12.548 | 5405.6 samples/s | 84.5 steps/s
[Step=11600 Epoch=109.3] | Loss=0.00065 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.714 | L2-Norm(final)=12.548 | 2399.9 samples/s | 37.5 steps/s
[Step=11650 Epoch=109.8] | Loss=0.00062 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.702 | L2-Norm(final)=12.549 | 4911.3 samples/s | 76.7 steps/s
[Step=11700 Epoch=110.2] | Loss=0.00059 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.689 | L2-Norm(final)=12.549 | 2477.1 samples/s | 38.7 steps/s
[Step=11750 Epoch=110.7] | Loss=0.00057 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.677 | L2-Norm(final)=12.550 | 4653.3 samples/s | 72.7 steps/s
[Step=11800 Epoch=111.2] | Loss=0.00055 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.665 | L2-Norm(final)=12.550 | 2573.6 samples/s | 40.2 steps/s
[Step=11850 Epoch=111.7] | Loss=0.00053 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.652 | L2-Norm(final)=12.550 | 4578.8 samples/s | 71.5 steps/s
[Step=11900 Epoch=112.1] | Loss=0.00051 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.640 | L2-Norm(final)=12.551 | 2577.6 samples/s | 40.3 steps/s
[Step=11950 Epoch=112.6] | Loss=0.00049 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.627 | L2-Norm(final)=12.551 | 4643.4 samples/s | 72.6 steps/s
[Step=12000 Epoch=113.1] | Loss=0.00047 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.615 | L2-Norm(final)=12.551 | 2709.7 samples/s | 42.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step12000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=8001 Epoch=76.3] | Loss=0.02098 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.515 | L2-Norm(final)=10.684 | 5985.6 samples/s | 93.5 steps/s
[Step=8050 Epoch=76.7] | Loss=0.01352 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.510 | L2-Norm(final)=10.752 | 4532.4 samples/s | 70.8 steps/s
[Step=8100 Epoch=77.2] | Loss=0.01217 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.509 | L2-Norm(final)=10.829 | 8402.5 samples/s | 131.3 steps/s
[Step=8150 Epoch=77.7] | Loss=0.01188 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.509 | L2-Norm(final)=10.893 | 2343.0 samples/s | 36.6 steps/s
[Step=8200 Epoch=78.2] | Loss=0.01187 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.509 | L2-Norm(final)=10.954 | 7680.1 samples/s | 120.0 steps/s
[Step=8250 Epoch=78.6] | Loss=0.01181 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.509 | L2-Norm(final)=11.013 | 2419.4 samples/s | 37.8 steps/s
[Step=8300 Epoch=79.1] | Loss=0.01177 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.509 | L2-Norm(final)=11.069 | 6845.2 samples/s | 107.0 steps/s
[Step=8350 Epoch=79.6] | Loss=0.01184 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.509 | L2-Norm(final)=11.121 | 2486.1 samples/s | 38.8 steps/s
[Step=8400 Epoch=80.1] | Loss=0.01183 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.509 | L2-Norm(final)=11.170 | 6366.9 samples/s | 99.5 steps/s
[Step=8450 Epoch=80.5] | Loss=0.01177 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.509 | L2-Norm(final)=11.219 | 2579.9 samples/s | 40.3 steps/s
[Step=8500 Epoch=81.0] | Loss=0.01161 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.509 | L2-Norm(final)=11.266 | 5788.3 samples/s | 90.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=81.0] | Loss=0.01341 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.509 | L2-Norm(final)=11.738 | 5920.2 samples/s | 92.5 steps/s
[Step=8550 Epoch=81.5] | Loss=0.00977 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.735 | L2-Norm(final)=11.752 | 4048.5 samples/s | 63.3 steps/s
[Step=8600 Epoch=82.0] | Loss=0.00679 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.905 | L2-Norm(final)=11.750 | 6807.2 samples/s | 106.4 steps/s
[Step=8650 Epoch=82.4] | Loss=0.00458 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.984 | L2-Norm(final)=11.751 | 2203.7 samples/s | 34.4 steps/s
[Step=8700 Epoch=82.9] | Loss=0.00345 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.015 | L2-Norm(final)=11.754 | 6123.0 samples/s | 95.7 steps/s
[Step=8750 Epoch=83.4] | Loss=0.00277 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.026 | L2-Norm(final)=11.756 | 2264.1 samples/s | 35.4 steps/s
[Step=8800 Epoch=83.9] | Loss=0.00231 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.026 | L2-Norm(final)=11.758 | 5807.8 samples/s | 90.7 steps/s
[Step=8850 Epoch=84.3] | Loss=0.00198 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.021 | L2-Norm(final)=11.760 | 2307.3 samples/s | 36.1 steps/s
[Step=8900 Epoch=84.8] | Loss=0.00173 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.011 | L2-Norm(final)=11.761 | 5323.9 samples/s | 83.2 steps/s
[Step=8950 Epoch=85.3] | Loss=0.00154 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.000 | L2-Norm(final)=11.762 | 2385.1 samples/s | 37.3 steps/s
[Step=9000 Epoch=85.8] | Loss=0.00139 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.987 | L2-Norm(final)=11.763 | 5040.9 samples/s | 78.8 steps/s
[Step=9050 Epoch=86.3] | Loss=0.00126 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=11.764 | 2471.3 samples/s | 38.6 steps/s
[Step=9100 Epoch=86.7] | Loss=0.00116 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.959 | L2-Norm(final)=11.765 | 4711.1 samples/s | 73.6 steps/s
[Step=9150 Epoch=87.2] | Loss=0.00107 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.943 | L2-Norm(final)=11.766 | 2531.9 samples/s | 39.6 steps/s
[Step=9200 Epoch=87.7] | Loss=0.00099 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.928 | L2-Norm(final)=11.766 | 4619.3 samples/s | 72.2 steps/s
[Step=9250 Epoch=88.2] | Loss=0.00093 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.912 | L2-Norm(final)=11.767 | 2561.4 samples/s | 40.0 steps/s
[Step=9300 Epoch=88.6] | Loss=0.00087 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.896 | L2-Norm(final)=11.768 | 4672.3 samples/s | 73.0 steps/s
[Step=9350 Epoch=89.1] | Loss=0.00082 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.880 | L2-Norm(final)=11.768 | 2547.3 samples/s | 39.8 steps/s
[Step=9400 Epoch=89.6] | Loss=0.00077 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.864 | L2-Norm(final)=11.769 | 4631.9 samples/s | 72.4 steps/s
[Step=9450 Epoch=90.1] | Loss=0.00073 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.847 | L2-Norm(final)=11.770 | 2564.5 samples/s | 40.1 steps/s
[Step=9500 Epoch=90.5] | Loss=0.00070 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.831 | L2-Norm(final)=11.770 | 4702.5 samples/s | 73.5 steps/s
[Step=9550 Epoch=91.0] | Loss=0.00066 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.814 | L2-Norm(final)=11.771 | 7289.6 samples/s | 113.9 steps/s
[Step=9600 Epoch=91.5] | Loss=0.00063 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.798 | L2-Norm(final)=11.771 | 2112.7 samples/s | 33.0 steps/s
[Step=9650 Epoch=92.0] | Loss=0.00061 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.781 | L2-Norm(final)=11.772 | 6777.9 samples/s | 105.9 steps/s
[Step=9700 Epoch=92.4] | Loss=0.00058 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.764 | L2-Norm(final)=11.772 | 2224.7 samples/s | 34.8 steps/s
[Step=9750 Epoch=92.9] | Loss=0.00056 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.748 | L2-Norm(final)=11.773 | 6034.3 samples/s | 94.3 steps/s
[Step=9800 Epoch=93.4] | Loss=0.00054 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.731 | L2-Norm(final)=11.773 | 2247.0 samples/s | 35.1 steps/s
[Step=9850 Epoch=93.9] | Loss=0.00052 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.714 | L2-Norm(final)=11.774 | 5791.0 samples/s | 90.5 steps/s
[Step=9900 Epoch=94.4] | Loss=0.00050 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=11.774 | 2314.5 samples/s | 36.2 steps/s
[Step=9950 Epoch=94.8] | Loss=0.00048 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.681 | L2-Norm(final)=11.775 | 5365.0 samples/s | 83.8 steps/s
[Step=10000 Epoch=95.3] | Loss=0.00047 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.664 | L2-Norm(final)=11.775 | 2394.0 samples/s | 37.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11013 | acc=0.9529 | tpr=0.9631 | fpr=0.0694 | 5470.3 samples/s | 21.4 steps/s
Avg test loss: 0.11660, Avg test acc: 0.95132, Avg tpr: 0.96229, Avg fpr: 0.07281, total FA: 568

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.11966 | acc=0.9516 | tpr=0.9728 | fpr=0.0944 | 5650.2 samples/s | 22.1 steps/s
Avg test loss: 0.12253, Avg test acc: 0.95104, Avg tpr: 0.97156, Avg fpr: 0.09409, total FA: 734

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.12808 | acc=0.9516 | tpr=0.9734 | fpr=0.0959 | 5686.1 samples/s | 22.2 steps/s
Avg test loss: 0.13175, Avg test acc: 0.95024, Avg tpr: 0.97103, Avg fpr: 0.09550, total FA: 745

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.11446 | acc=0.9525 | tpr=0.9710 | fpr=0.0877 | 5633.8 samples/s | 22.0 steps/s
Avg test loss: 0.12209, Avg test acc: 0.95092, Avg tpr: 0.96981, Avg fpr: 0.09063, total FA: 707

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11935 | acc=0.9498 | tpr=0.9623 | fpr=0.0773 | 5833.0 samples/s | 22.8 steps/s
Avg test loss: 0.12607, Avg test acc: 0.94891, Avg tpr: 0.96083, Avg fpr: 0.07730, total FA: 603

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.84577 | acc=0.3050 | tpr=0.0041 | fpr=0.0416 | 5665.0 samples/s | 22.1 steps/s
Avg test loss: 4.86368, Avg test acc: 0.30167, Avg tpr: 0.00315, Avg fpr: 0.04179, total FA: 326

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.61288 | acc=0.2941 | tpr=0.0064 | fpr=0.0813 | 5541.8 samples/s | 21.6 steps/s
Avg test loss: 4.63156, Avg test acc: 0.29141, Avg tpr: 0.00606, Avg fpr: 0.08102, total FA: 632

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.15536 | acc=0.2955 | tpr=0.0156 | fpr=0.0969 | 5632.8 samples/s | 22.0 steps/s
Avg test loss: 5.17509, Avg test acc: 0.29425, Avg tpr: 0.01597, Avg fpr: 0.09371, total FA: 731

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.30607 | acc=0.2824 | tpr=0.0102 | fpr=0.1264 | 5691.0 samples/s | 22.2 steps/s
Avg test loss: 5.31695, Avg test acc: 0.28195, Avg tpr: 0.01125, Avg fpr: 0.12268, total FA: 957

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.11574 | acc=0.3071 | tpr=0.0191 | fpr=0.0674 | 5713.0 samples/s | 22.3 steps/s
Avg test loss: 5.13283, Avg test acc: 0.30479, Avg tpr: 0.01906, Avg fpr: 0.06679, total FA: 521

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.61533 | acc=0.1503 | tpr=0.2611 | fpr=0.8517 | 5726.3 samples/s | 22.4 steps/s
[Step= 100] | Loss=5.55678 | acc=0.1492 | tpr=0.2559 | fpr=0.8528 | 7946.2 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.56959 | acc=0.1483 | tpr=0.2536 | fpr=0.8537 | 7761.3 samples/s | 30.3 steps/s
[Step= 200] | Loss=5.55594 | acc=0.1486 | tpr=0.2503 | fpr=0.8533 | 8559.2 samples/s | 33.4 steps/s
[Step= 250] | Loss=5.56701 | acc=0.1480 | tpr=0.2550 | fpr=0.8539 | 8232.5 samples/s | 32.2 steps/s
[Step= 300] | Loss=5.56524 | acc=0.1481 | tpr=0.2487 | fpr=0.8537 | 7779.5 samples/s | 30.4 steps/s
[Step= 350] | Loss=5.56622 | acc=0.1479 | tpr=0.2405 | fpr=0.8538 | 8466.0 samples/s | 33.1 steps/s
[Step= 400] | Loss=5.56180 | acc=0.1486 | tpr=0.2429 | fpr=0.8532 | 7977.1 samples/s | 31.2 steps/s
[Step= 450] | Loss=5.56405 | acc=0.1481 | tpr=0.2420 | fpr=0.8536 | 7448.1 samples/s | 29.1 steps/s
[Step= 500] | Loss=5.56576 | acc=0.1480 | tpr=0.2401 | fpr=0.8537 | 8531.9 samples/s | 33.3 steps/s
[Step= 550] | Loss=5.56255 | acc=0.1478 | tpr=0.2372 | fpr=0.8538 | 9778.0 samples/s | 38.2 steps/s
Avg test loss: 5.56199, Avg test acc: 0.14763, Avg tpr: 0.23693, Avg fpr: 0.85399, total FA: 118575

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.35865 | acc=0.1163 | tpr=0.3009 | fpr=0.8870 | 5670.7 samples/s | 22.2 steps/s
[Step= 100] | Loss=6.31984 | acc=0.1173 | tpr=0.2559 | fpr=0.8853 | 8236.0 samples/s | 32.2 steps/s
[Step= 150] | Loss=6.32656 | acc=0.1172 | tpr=0.2565 | fpr=0.8854 | 7480.2 samples/s | 29.2 steps/s
[Step= 200] | Loss=6.32009 | acc=0.1177 | tpr=0.2557 | fpr=0.8848 | 7810.9 samples/s | 30.5 steps/s
[Step= 250] | Loss=6.32053 | acc=0.1176 | tpr=0.2672 | fpr=0.8851 | 8143.9 samples/s | 31.8 steps/s
[Step= 300] | Loss=6.32370 | acc=0.1170 | tpr=0.2669 | fpr=0.8858 | 8882.5 samples/s | 34.7 steps/s
[Step= 350] | Loss=6.33090 | acc=0.1162 | tpr=0.2574 | fpr=0.8864 | 8271.2 samples/s | 32.3 steps/s
[Step= 400] | Loss=6.32856 | acc=0.1166 | tpr=0.2555 | fpr=0.8859 | 7786.7 samples/s | 30.4 steps/s
[Step= 450] | Loss=6.33057 | acc=0.1168 | tpr=0.2556 | fpr=0.8857 | 7843.9 samples/s | 30.6 steps/s
[Step= 500] | Loss=6.32941 | acc=0.1166 | tpr=0.2524 | fpr=0.8858 | 8290.5 samples/s | 32.4 steps/s
[Step= 550] | Loss=6.32743 | acc=0.1165 | tpr=0.2519 | fpr=0.8859 | 10038.5 samples/s | 39.2 steps/s
Avg test loss: 6.32765, Avg test acc: 0.11642, Avg tpr: 0.25238, Avg fpr: 0.88606, total FA: 123027

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.91428 | acc=0.1209 | tpr=0.3673 | fpr=0.8835 | 5633.4 samples/s | 22.0 steps/s
[Step= 100] | Loss=6.87187 | acc=0.1213 | tpr=0.3390 | fpr=0.8827 | 7866.7 samples/s | 30.7 steps/s
[Step= 150] | Loss=6.87800 | acc=0.1201 | tpr=0.3184 | fpr=0.8836 | 7491.6 samples/s | 29.3 steps/s
[Step= 200] | Loss=6.87088 | acc=0.1211 | tpr=0.3137 | fpr=0.8825 | 8648.1 samples/s | 33.8 steps/s
[Step= 250] | Loss=6.86694 | acc=0.1217 | tpr=0.3258 | fpr=0.8820 | 8381.7 samples/s | 32.7 steps/s
[Step= 300] | Loss=6.86870 | acc=0.1215 | tpr=0.3287 | fpr=0.8823 | 8520.5 samples/s | 33.3 steps/s
[Step= 350] | Loss=6.87762 | acc=0.1206 | tpr=0.3181 | fpr=0.8830 | 7562.9 samples/s | 29.5 steps/s
[Step= 400] | Loss=6.87425 | acc=0.1210 | tpr=0.3206 | fpr=0.8826 | 8293.4 samples/s | 32.4 steps/s
[Step= 450] | Loss=6.87459 | acc=0.1207 | tpr=0.3155 | fpr=0.8829 | 7952.5 samples/s | 31.1 steps/s
[Step= 500] | Loss=6.87712 | acc=0.1205 | tpr=0.3128 | fpr=0.8830 | 7957.0 samples/s | 31.1 steps/s
[Step= 550] | Loss=6.87147 | acc=0.1207 | tpr=0.3112 | fpr=0.8828 | 10492.0 samples/s | 41.0 steps/s
Avg test loss: 6.87160, Avg test acc: 0.12054, Avg tpr: 0.31181, Avg fpr: 0.88294, total FA: 122594

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.04558 | acc=0.1468 | tpr=0.2522 | fpr=0.8551 | 5873.4 samples/s | 22.9 steps/s
[Step= 100] | Loss=6.01298 | acc=0.1459 | tpr=0.2239 | fpr=0.8556 | 7917.5 samples/s | 30.9 steps/s
[Step= 150] | Loss=6.01050 | acc=0.1453 | tpr=0.2219 | fpr=0.8561 | 7764.0 samples/s | 30.3 steps/s
[Step= 200] | Loss=5.99766 | acc=0.1452 | tpr=0.2240 | fpr=0.8563 | 7700.9 samples/s | 30.1 steps/s
[Step= 250] | Loss=5.99943 | acc=0.1462 | tpr=0.2210 | fpr=0.8552 | 8596.4 samples/s | 33.6 steps/s
[Step= 300] | Loss=6.00333 | acc=0.1457 | tpr=0.2233 | fpr=0.8557 | 7365.8 samples/s | 28.8 steps/s
[Step= 350] | Loss=6.00394 | acc=0.1451 | tpr=0.2129 | fpr=0.8562 | 8173.5 samples/s | 31.9 steps/s
[Step= 400] | Loss=5.99836 | acc=0.1457 | tpr=0.2177 | fpr=0.8556 | 7761.3 samples/s | 30.3 steps/s
[Step= 450] | Loss=5.99805 | acc=0.1461 | tpr=0.2162 | fpr=0.8552 | 8054.3 samples/s | 31.5 steps/s
[Step= 500] | Loss=6.00011 | acc=0.1460 | tpr=0.2159 | fpr=0.8553 | 8430.9 samples/s | 32.9 steps/s
[Step= 550] | Loss=5.99835 | acc=0.1460 | tpr=0.2145 | fpr=0.8553 | 10831.1 samples/s | 42.3 steps/s
Avg test loss: 5.99833, Avg test acc: 0.14585, Avg tpr: 0.21474, Avg fpr: 0.85540, total FA: 118771

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.12804 | acc=0.1402 | tpr=0.2080 | fpr=0.8610 | 5837.7 samples/s | 22.8 steps/s
[Step= 100] | Loss=6.07697 | acc=0.1404 | tpr=0.1983 | fpr=0.8607 | 7473.7 samples/s | 29.2 steps/s
[Step= 150] | Loss=6.09329 | acc=0.1398 | tpr=0.1844 | fpr=0.8611 | 7605.3 samples/s | 29.7 steps/s
[Step= 200] | Loss=6.08740 | acc=0.1396 | tpr=0.1814 | fpr=0.8612 | 8117.5 samples/s | 31.7 steps/s
[Step= 250] | Loss=6.09599 | acc=0.1395 | tpr=0.1799 | fpr=0.8612 | 8639.3 samples/s | 33.7 steps/s
[Step= 300] | Loss=6.09632 | acc=0.1393 | tpr=0.1753 | fpr=0.8613 | 7733.5 samples/s | 30.2 steps/s
[Step= 350] | Loss=6.10007 | acc=0.1392 | tpr=0.1678 | fpr=0.8613 | 8843.6 samples/s | 34.5 steps/s
[Step= 400] | Loss=6.09622 | acc=0.1394 | tpr=0.1679 | fpr=0.8611 | 8157.4 samples/s | 31.9 steps/s
[Step= 450] | Loss=6.09413 | acc=0.1392 | tpr=0.1685 | fpr=0.8613 | 8271.4 samples/s | 32.3 steps/s
[Step= 500] | Loss=6.09688 | acc=0.1389 | tpr=0.1665 | fpr=0.8616 | 8457.4 samples/s | 33.0 steps/s
[Step= 550] | Loss=6.09498 | acc=0.1388 | tpr=0.1639 | fpr=0.8617 | 9260.9 samples/s | 36.2 steps/s
Avg test loss: 6.09394, Avg test acc: 0.13863, Avg tpr: 0.16442, Avg fpr: 0.86183, total FA: 119664

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10171 | acc=0.9803 | tpr=0.8805 | fpr=0.0179 | 5621.3 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.10577 | acc=0.9802 | tpr=0.8827 | fpr=0.0180 | 7748.4 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.10941 | acc=0.9795 | tpr=0.8934 | fpr=0.0189 | 7864.3 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.11133 | acc=0.9796 | tpr=0.9005 | fpr=0.0190 | 8048.7 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.11102 | acc=0.9797 | tpr=0.8996 | fpr=0.0189 | 7654.6 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.11255 | acc=0.9794 | tpr=0.8945 | fpr=0.0190 | 8075.5 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.11249 | acc=0.9795 | tpr=0.8986 | fpr=0.0191 | 8083.3 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.11299 | acc=0.9792 | tpr=0.8944 | fpr=0.0192 | 8286.8 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.11468 | acc=0.9791 | tpr=0.8929 | fpr=0.0194 | 8175.0 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.11419 | acc=0.9791 | tpr=0.8943 | fpr=0.0194 | 8081.6 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.11382 | acc=0.9791 | tpr=0.8938 | fpr=0.0193 | 10484.1 samples/s | 41.0 steps/s
Avg test loss: 0.11366, Avg test acc: 0.97912, Avg tpr: 0.89342, Avg fpr: 0.01932, total FA: 2683

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09454 | acc=0.9812 | tpr=0.8717 | fpr=0.0169 | 5623.1 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.09749 | acc=0.9809 | tpr=0.8763 | fpr=0.0172 | 8278.9 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.10090 | acc=0.9804 | tpr=0.8919 | fpr=0.0180 | 7688.4 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.10234 | acc=0.9805 | tpr=0.8929 | fpr=0.0179 | 8057.8 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.10236 | acc=0.9806 | tpr=0.8926 | fpr=0.0178 | 8623.7 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.10340 | acc=0.9805 | tpr=0.8931 | fpr=0.0179 | 7898.1 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.10387 | acc=0.9804 | tpr=0.8961 | fpr=0.0180 | 8097.8 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.10469 | acc=0.9803 | tpr=0.8928 | fpr=0.0182 | 7861.0 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.10591 | acc=0.9801 | tpr=0.8900 | fpr=0.0182 | 8022.9 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.10498 | acc=0.9803 | tpr=0.8930 | fpr=0.0181 | 7841.3 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.10392 | acc=0.9804 | tpr=0.8930 | fpr=0.0180 | 11052.7 samples/s | 43.2 steps/s
Avg test loss: 0.10372, Avg test acc: 0.98038, Avg tpr: 0.89184, Avg fpr: 0.01801, total FA: 2501

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12413 | acc=0.9773 | tpr=0.9071 | fpr=0.0214 | 5729.1 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.12940 | acc=0.9762 | tpr=0.9254 | fpr=0.0228 | 8319.5 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.13513 | acc=0.9752 | tpr=0.9308 | fpr=0.0240 | 7296.4 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.13660 | acc=0.9752 | tpr=0.9322 | fpr=0.0240 | 8661.9 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.13677 | acc=0.9751 | tpr=0.9284 | fpr=0.0241 | 7989.0 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.13868 | acc=0.9750 | tpr=0.9251 | fpr=0.0241 | 8293.5 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.13861 | acc=0.9751 | tpr=0.9274 | fpr=0.0240 | 8138.0 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.13948 | acc=0.9750 | tpr=0.9261 | fpr=0.0241 | 7879.7 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.14157 | acc=0.9747 | tpr=0.9231 | fpr=0.0244 | 8640.7 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.14103 | acc=0.9747 | tpr=0.9260 | fpr=0.0244 | 7852.8 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.14037 | acc=0.9749 | tpr=0.9260 | fpr=0.0242 | 9520.7 samples/s | 37.2 steps/s
Avg test loss: 0.14025, Avg test acc: 0.97489, Avg tpr: 0.92631, Avg fpr: 0.02423, total FA: 3364

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09065 | acc=0.9832 | tpr=0.9027 | fpr=0.0153 | 5787.2 samples/s | 22.6 steps/s
[Step= 100] | Loss=0.09751 | acc=0.9829 | tpr=0.9190 | fpr=0.0160 | 8000.6 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.09908 | acc=0.9829 | tpr=0.9222 | fpr=0.0159 | 7922.6 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.10055 | acc=0.9829 | tpr=0.9246 | fpr=0.0160 | 8661.7 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.10080 | acc=0.9829 | tpr=0.9162 | fpr=0.0159 | 7516.9 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.10278 | acc=0.9827 | tpr=0.9113 | fpr=0.0160 | 8261.5 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.10236 | acc=0.9827 | tpr=0.9136 | fpr=0.0160 | 8533.3 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.10322 | acc=0.9827 | tpr=0.9130 | fpr=0.0160 | 6939.1 samples/s | 27.1 steps/s
[Step= 450] | Loss=0.10540 | acc=0.9823 | tpr=0.9124 | fpr=0.0164 | 8366.9 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.10459 | acc=0.9825 | tpr=0.9145 | fpr=0.0163 | 8018.5 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.10369 | acc=0.9824 | tpr=0.9140 | fpr=0.0163 | 10813.1 samples/s | 42.2 steps/s
Avg test loss: 0.10351, Avg test acc: 0.98246, Avg tpr: 0.91403, Avg fpr: 0.01629, total FA: 2262

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.13112 | acc=0.9770 | tpr=0.9027 | fpr=0.0216 | 5761.5 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.13659 | acc=0.9771 | tpr=0.9168 | fpr=0.0218 | 7612.8 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.14270 | acc=0.9762 | tpr=0.9265 | fpr=0.0229 | 8682.0 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.14315 | acc=0.9765 | tpr=0.9279 | fpr=0.0227 | 7962.1 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.14267 | acc=0.9766 | tpr=0.9249 | fpr=0.0225 | 8012.3 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.14528 | acc=0.9765 | tpr=0.9251 | fpr=0.0225 | 8309.3 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.14605 | acc=0.9762 | tpr=0.9249 | fpr=0.0228 | 7873.6 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.14699 | acc=0.9761 | tpr=0.9234 | fpr=0.0229 | 7999.6 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.14950 | acc=0.9758 | tpr=0.9221 | fpr=0.0232 | 7389.1 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.14858 | acc=0.9759 | tpr=0.9242 | fpr=0.0231 | 8172.2 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.14749 | acc=0.9761 | tpr=0.9244 | fpr=0.0229 | 10893.3 samples/s | 42.6 steps/s
Avg test loss: 0.14714, Avg test acc: 0.97616, Avg tpr: 0.92393, Avg fpr: 0.02289, total FA: 3178

server round 14/50

clients selected: [0 1 4 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.07395 | Reg=0.00131 | acc=0.9375 | L2-Norm=11.435 | L2-Norm(final)=10.863 | 5892.1 samples/s | 92.1 steps/s
[Step=8050 Epoch=39.3] | Loss=0.05184 | Reg=0.00131 | acc=0.9375 | L2-Norm=11.435 | L2-Norm(final)=10.871 | 5009.9 samples/s | 78.3 steps/s
[Step=8100 Epoch=39.5] | Loss=0.04755 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.435 | L2-Norm(final)=10.888 | 5734.0 samples/s | 89.6 steps/s
[Step=8150 Epoch=39.7] | Loss=0.04920 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.435 | L2-Norm(final)=10.906 | 5792.3 samples/s | 90.5 steps/s
[Step=8200 Epoch=40.0] | Loss=0.04900 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.435 | L2-Norm(final)=10.914 | 8144.3 samples/s | 127.3 steps/s
[Step=8250 Epoch=40.2] | Loss=0.04926 | Reg=0.00131 | acc=0.9375 | L2-Norm=11.435 | L2-Norm(final)=10.923 | 2442.8 samples/s | 38.2 steps/s
[Step=8300 Epoch=40.5] | Loss=0.04914 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.435 | L2-Norm(final)=10.931 | 5573.6 samples/s | 87.1 steps/s
[Step=8350 Epoch=40.7] | Loss=0.04970 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.435 | L2-Norm(final)=10.941 | 5574.6 samples/s | 87.1 steps/s
[Step=8400 Epoch=41.0] | Loss=0.04905 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.435 | L2-Norm(final)=10.952 | 7718.3 samples/s | 120.6 steps/s
[Step=8450 Epoch=41.2] | Loss=0.04959 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.435 | L2-Norm(final)=10.964 | 2524.5 samples/s | 39.4 steps/s
[Step=8500 Epoch=41.4] | Loss=0.04964 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.435 | L2-Norm(final)=10.975 | 5590.6 samples/s | 87.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=41.5] | Loss=0.07138 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.435 | L2-Norm(final)=11.084 | 5691.8 samples/s | 88.9 steps/s
[Step=8550 Epoch=41.7] | Loss=0.05138 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.543 | L2-Norm(final)=11.084 | 4449.2 samples/s | 69.5 steps/s
[Step=8600 Epoch=41.9] | Loss=0.04994 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.660 | L2-Norm(final)=11.071 | 4876.0 samples/s | 76.2 steps/s
[Step=8650 Epoch=42.2] | Loss=0.04569 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.739 | L2-Norm(final)=11.064 | 4857.6 samples/s | 75.9 steps/s
[Step=8700 Epoch=42.4] | Loss=0.04392 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.804 | L2-Norm(final)=11.060 | 7016.8 samples/s | 109.6 steps/s
[Step=8750 Epoch=42.7] | Loss=0.03924 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.861 | L2-Norm(final)=11.059 | 2299.5 samples/s | 35.9 steps/s
[Step=8800 Epoch=42.9] | Loss=0.03577 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.908 | L2-Norm(final)=11.061 | 4832.7 samples/s | 75.5 steps/s
[Step=8850 Epoch=43.2] | Loss=0.03296 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.948 | L2-Norm(final)=11.064 | 4881.5 samples/s | 76.3 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03081 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.981 | L2-Norm(final)=11.067 | 6303.7 samples/s | 98.5 steps/s
[Step=8950 Epoch=43.6] | Loss=0.02875 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.010 | L2-Norm(final)=11.070 | 2353.6 samples/s | 36.8 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02711 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.035 | L2-Norm(final)=11.074 | 4948.6 samples/s | 77.3 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02560 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.058 | L2-Norm(final)=11.078 | 4888.5 samples/s | 76.4 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02442 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.077 | L2-Norm(final)=11.081 | 5691.1 samples/s | 88.9 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02313 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.096 | L2-Norm(final)=11.084 | 2423.2 samples/s | 37.9 steps/s
[Step=9200 Epoch=44.9] | Loss=0.02199 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.114 | L2-Norm(final)=11.088 | 4938.2 samples/s | 77.2 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02117 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=11.092 | 4781.5 samples/s | 74.7 steps/s
[Step=9300 Epoch=45.3] | Loss=0.02068 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.145 | L2-Norm(final)=11.094 | 5388.2 samples/s | 84.2 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01995 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=11.097 | 2524.3 samples/s | 39.4 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01939 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=11.099 | 4791.4 samples/s | 74.9 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01873 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.186 | L2-Norm(final)=11.102 | 4891.7 samples/s | 76.4 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01816 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.199 | L2-Norm(final)=11.105 | 5013.6 samples/s | 78.3 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01757 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=11.108 | 2597.4 samples/s | 40.6 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01711 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.223 | L2-Norm(final)=11.111 | 4864.7 samples/s | 76.0 steps/s
[Step=9650 Epoch=47.1] | Loss=0.01658 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.234 | L2-Norm(final)=11.114 | 4888.1 samples/s | 76.4 steps/s
[Step=9700 Epoch=47.3] | Loss=0.01624 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.245 | L2-Norm(final)=11.117 | 4878.1 samples/s | 76.2 steps/s
[Step=9750 Epoch=47.5] | Loss=0.01593 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.255 | L2-Norm(final)=11.119 | 2621.1 samples/s | 41.0 steps/s
[Step=9800 Epoch=47.8] | Loss=0.01556 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.264 | L2-Norm(final)=11.121 | 4871.3 samples/s | 76.1 steps/s
[Step=9850 Epoch=48.0] | Loss=0.01521 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.273 | L2-Norm(final)=11.124 | 4836.4 samples/s | 75.6 steps/s
[Step=9900 Epoch=48.3] | Loss=0.01479 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=11.126 | 4884.0 samples/s | 76.3 steps/s
[Step=9950 Epoch=48.5] | Loss=0.01451 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=11.129 | 2603.5 samples/s | 40.7 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01416 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=11.131 | 4912.2 samples/s | 76.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step10000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=97.6] | Loss=0.06457 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.435 | L2-Norm(final)=13.481 | 5524.8 samples/s | 86.3 steps/s
[Step=20050 Epoch=97.8] | Loss=0.05547 | Reg=0.00131 | acc=0.9375 | L2-Norm=11.435 | L2-Norm(final)=13.452 | 5079.1 samples/s | 79.4 steps/s
[Step=20100 Epoch=98.1] | Loss=0.04956 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=13.435 | 5628.2 samples/s | 87.9 steps/s
[Step=20150 Epoch=98.3] | Loss=0.04858 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.435 | L2-Norm(final)=13.429 | 5617.6 samples/s | 87.8 steps/s
[Step=20200 Epoch=98.6] | Loss=0.04898 | Reg=0.00131 | acc=0.9375 | L2-Norm=11.435 | L2-Norm(final)=13.426 | 8714.4 samples/s | 136.2 steps/s
[Step=20250 Epoch=98.8] | Loss=0.04859 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.435 | L2-Norm(final)=13.423 | 2414.7 samples/s | 37.7 steps/s
[Step=20300 Epoch=99.1] | Loss=0.04840 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.435 | L2-Norm(final)=13.422 | 5715.4 samples/s | 89.3 steps/s
[Step=20350 Epoch=99.3] | Loss=0.04775 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.435 | L2-Norm(final)=13.420 | 5548.6 samples/s | 86.7 steps/s
[Step=20400 Epoch=99.5] | Loss=0.04803 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.435 | L2-Norm(final)=13.419 | 7966.1 samples/s | 124.5 steps/s
[Step=20450 Epoch=99.8] | Loss=0.04785 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.435 | L2-Norm(final)=13.419 | 2493.8 samples/s | 39.0 steps/s
[Step=20500 Epoch=100.0] | Loss=0.04769 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.435 | L2-Norm(final)=13.421 | 5628.6 samples/s | 87.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=100.0] | Loss=0.02737 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.435 | L2-Norm(final)=13.438 | 5657.9 samples/s | 88.4 steps/s
[Step=20550 Epoch=100.3] | Loss=0.04978 | Reg=0.00134 | acc=0.9531 | L2-Norm=11.565 | L2-Norm(final)=13.430 | 4507.0 samples/s | 70.4 steps/s
[Step=20600 Epoch=100.5] | Loss=0.04880 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.673 | L2-Norm(final)=13.413 | 4884.1 samples/s | 76.3 steps/s
[Step=20650 Epoch=100.8] | Loss=0.04761 | Reg=0.00138 | acc=0.9219 | L2-Norm=11.746 | L2-Norm(final)=13.402 | 4782.9 samples/s | 74.7 steps/s
[Step=20700 Epoch=101.0] | Loss=0.04559 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.806 | L2-Norm(final)=13.394 | 7034.4 samples/s | 109.9 steps/s
[Step=20750 Epoch=101.3] | Loss=0.04039 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.857 | L2-Norm(final)=13.391 | 2277.5 samples/s | 35.6 steps/s
[Step=20800 Epoch=101.5] | Loss=0.03712 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.897 | L2-Norm(final)=13.391 | 4928.9 samples/s | 77.0 steps/s
[Step=20850 Epoch=101.7] | Loss=0.03398 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.932 | L2-Norm(final)=13.391 | 4804.0 samples/s | 75.1 steps/s
[Step=20900 Epoch=102.0] | Loss=0.03182 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.962 | L2-Norm(final)=13.393 | 6495.0 samples/s | 101.5 steps/s
[Step=20950 Epoch=102.2] | Loss=0.02972 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.989 | L2-Norm(final)=13.393 | 2315.3 samples/s | 36.2 steps/s
[Step=21000 Epoch=102.5] | Loss=0.02766 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.012 | L2-Norm(final)=13.394 | 4966.5 samples/s | 77.6 steps/s
[Step=21050 Epoch=102.7] | Loss=0.02614 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.033 | L2-Norm(final)=13.396 | 4741.0 samples/s | 74.1 steps/s
[Step=21100 Epoch=103.0] | Loss=0.02542 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.050 | L2-Norm(final)=13.397 | 6018.2 samples/s | 94.0 steps/s
[Step=21150 Epoch=103.2] | Loss=0.02402 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.066 | L2-Norm(final)=13.398 | 2354.6 samples/s | 36.8 steps/s
[Step=21200 Epoch=103.4] | Loss=0.02278 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.080 | L2-Norm(final)=13.399 | 4879.6 samples/s | 76.2 steps/s
[Step=21250 Epoch=103.7] | Loss=0.02180 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.093 | L2-Norm(final)=13.401 | 4863.2 samples/s | 76.0 steps/s
[Step=21300 Epoch=103.9] | Loss=0.02096 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=13.402 | 5573.6 samples/s | 87.1 steps/s
[Step=21350 Epoch=104.2] | Loss=0.02012 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.114 | L2-Norm(final)=13.404 | 2474.0 samples/s | 38.7 steps/s
[Step=21400 Epoch=104.4] | Loss=0.01950 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.124 | L2-Norm(final)=13.406 | 4827.7 samples/s | 75.4 steps/s
[Step=21450 Epoch=104.7] | Loss=0.01877 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=13.407 | 4832.0 samples/s | 75.5 steps/s
[Step=21500 Epoch=104.9] | Loss=0.01823 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.142 | L2-Norm(final)=13.409 | 5269.9 samples/s | 82.3 steps/s
[Step=21550 Epoch=105.2] | Loss=0.01771 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=13.410 | 2526.1 samples/s | 39.5 steps/s
[Step=21600 Epoch=105.4] | Loss=0.01712 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=13.411 | 4878.8 samples/s | 76.2 steps/s
[Step=21650 Epoch=105.6] | Loss=0.01664 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=13.413 | 4862.0 samples/s | 76.0 steps/s
[Step=21700 Epoch=105.9] | Loss=0.01618 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=13.415 | 4936.0 samples/s | 77.1 steps/s
[Step=21750 Epoch=106.1] | Loss=0.01569 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=13.416 | 2629.0 samples/s | 41.1 steps/s
[Step=21800 Epoch=106.4] | Loss=0.01534 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=13.418 | 4823.9 samples/s | 75.4 steps/s
[Step=21850 Epoch=106.6] | Loss=0.01491 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.188 | L2-Norm(final)=13.419 | 4821.1 samples/s | 75.3 steps/s
[Step=21900 Epoch=106.9] | Loss=0.01456 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.194 | L2-Norm(final)=13.421 | 4867.8 samples/s | 76.1 steps/s
[Step=21950 Epoch=107.1] | Loss=0.01417 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.199 | L2-Norm(final)=13.423 | 2629.6 samples/s | 41.1 steps/s
[Step=22000 Epoch=107.3] | Loss=0.01396 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.204 | L2-Norm(final)=13.425 | 4840.4 samples/s | 75.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step22000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=88.3] | Loss=0.06775 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.435 | L2-Norm(final)=13.222 | 6174.0 samples/s | 96.5 steps/s
[Step=18050 Epoch=88.5] | Loss=0.04089 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.435 | L2-Norm(final)=13.223 | 4568.1 samples/s | 71.4 steps/s
[Step=18100 Epoch=88.8] | Loss=0.03875 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=13.229 | 5615.4 samples/s | 87.7 steps/s
[Step=18150 Epoch=89.0] | Loss=0.03996 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.435 | L2-Norm(final)=13.242 | 5689.5 samples/s | 88.9 steps/s
[Step=18200 Epoch=89.2] | Loss=0.04278 | Reg=0.00131 | acc=0.9375 | L2-Norm=11.435 | L2-Norm(final)=13.249 | 8758.2 samples/s | 136.8 steps/s
[Step=18250 Epoch=89.5] | Loss=0.04333 | Reg=0.00131 | acc=0.9375 | L2-Norm=11.435 | L2-Norm(final)=13.249 | 2393.6 samples/s | 37.4 steps/s
[Step=18300 Epoch=89.7] | Loss=0.04289 | Reg=0.00131 | acc=0.9375 | L2-Norm=11.435 | L2-Norm(final)=13.250 | 5579.6 samples/s | 87.2 steps/s
[Step=18350 Epoch=90.0] | Loss=0.04268 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.435 | L2-Norm(final)=13.254 | 5852.6 samples/s | 91.4 steps/s
[Step=18400 Epoch=90.2] | Loss=0.04291 | Reg=0.00131 | acc=0.9375 | L2-Norm=11.435 | L2-Norm(final)=13.260 | 7954.7 samples/s | 124.3 steps/s
[Step=18450 Epoch=90.5] | Loss=0.04275 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.435 | L2-Norm(final)=13.267 | 2460.5 samples/s | 38.4 steps/s
[Step=18500 Epoch=90.7] | Loss=0.04253 | Reg=0.00131 | acc=0.9375 | L2-Norm=11.435 | L2-Norm(final)=13.274 | 5596.5 samples/s | 87.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=90.7] | Loss=0.05530 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.435 | L2-Norm(final)=13.348 | 6144.4 samples/s | 96.0 steps/s
[Step=18550 Epoch=91.0] | Loss=0.04582 | Reg=0.00133 | acc=0.9531 | L2-Norm=11.545 | L2-Norm(final)=13.341 | 4239.9 samples/s | 66.2 steps/s
[Step=18600 Epoch=91.2] | Loss=0.04898 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.658 | L2-Norm(final)=13.326 | 4879.3 samples/s | 76.2 steps/s
[Step=18650 Epoch=91.5] | Loss=0.04791 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.740 | L2-Norm(final)=13.313 | 4871.2 samples/s | 76.1 steps/s
[Step=18700 Epoch=91.7] | Loss=0.04579 | Reg=0.00139 | acc=0.9219 | L2-Norm=11.801 | L2-Norm(final)=13.306 | 7098.2 samples/s | 110.9 steps/s
[Step=18750 Epoch=91.9] | Loss=0.03983 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.852 | L2-Norm(final)=13.303 | 2263.8 samples/s | 35.4 steps/s
[Step=18800 Epoch=92.2] | Loss=0.03623 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.892 | L2-Norm(final)=13.303 | 4748.6 samples/s | 74.2 steps/s
[Step=18850 Epoch=92.4] | Loss=0.03295 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.925 | L2-Norm(final)=13.304 | 4873.3 samples/s | 76.1 steps/s
[Step=18900 Epoch=92.7] | Loss=0.03147 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.954 | L2-Norm(final)=13.305 | 6678.9 samples/s | 104.4 steps/s
[Step=18950 Epoch=92.9] | Loss=0.02956 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.980 | L2-Norm(final)=13.305 | 2287.4 samples/s | 35.7 steps/s
[Step=19000 Epoch=93.2] | Loss=0.02762 | Reg=0.00144 | acc=0.9688 | L2-Norm=12.004 | L2-Norm(final)=13.307 | 4910.4 samples/s | 76.7 steps/s
[Step=19050 Epoch=93.4] | Loss=0.02647 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.026 | L2-Norm(final)=13.308 | 4806.9 samples/s | 75.1 steps/s
[Step=19100 Epoch=93.7] | Loss=0.02507 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.046 | L2-Norm(final)=13.309 | 6281.1 samples/s | 98.1 steps/s
[Step=19150 Epoch=93.9] | Loss=0.02373 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.064 | L2-Norm(final)=13.311 | 2332.9 samples/s | 36.5 steps/s
[Step=19200 Epoch=94.2] | Loss=0.02264 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.079 | L2-Norm(final)=13.312 | 4858.7 samples/s | 75.9 steps/s
[Step=19250 Epoch=94.4] | Loss=0.02174 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.093 | L2-Norm(final)=13.314 | 4854.1 samples/s | 75.8 steps/s
[Step=19300 Epoch=94.6] | Loss=0.02094 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=13.315 | 5943.3 samples/s | 92.9 steps/s
[Step=19350 Epoch=94.9] | Loss=0.01996 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=13.316 | 2396.9 samples/s | 37.5 steps/s
[Step=19400 Epoch=95.1] | Loss=0.01916 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.129 | L2-Norm(final)=13.318 | 4846.6 samples/s | 75.7 steps/s
[Step=19450 Epoch=95.4] | Loss=0.01849 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=13.320 | 4853.7 samples/s | 75.8 steps/s
[Step=19500 Epoch=95.6] | Loss=0.01799 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=13.322 | 5649.4 samples/s | 88.3 steps/s
[Step=19550 Epoch=95.9] | Loss=0.01742 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=13.324 | 2453.3 samples/s | 38.3 steps/s
[Step=19600 Epoch=96.1] | Loss=0.01682 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=13.326 | 4806.0 samples/s | 75.1 steps/s
[Step=19650 Epoch=96.4] | Loss=0.01635 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=13.328 | 4881.6 samples/s | 76.3 steps/s
[Step=19700 Epoch=96.6] | Loss=0.01590 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.182 | L2-Norm(final)=13.330 | 5338.5 samples/s | 83.4 steps/s
[Step=19750 Epoch=96.9] | Loss=0.01553 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.189 | L2-Norm(final)=13.331 | 2524.3 samples/s | 39.4 steps/s
[Step=19800 Epoch=97.1] | Loss=0.01515 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.196 | L2-Norm(final)=13.333 | 4908.5 samples/s | 76.7 steps/s
[Step=19850 Epoch=97.3] | Loss=0.01473 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.202 | L2-Norm(final)=13.335 | 4893.4 samples/s | 76.5 steps/s
[Step=19900 Epoch=97.6] | Loss=0.01439 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=13.337 | 4972.1 samples/s | 77.7 steps/s
[Step=19950 Epoch=97.8] | Loss=0.01404 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=13.338 | 2580.8 samples/s | 40.3 steps/s
[Step=20000 Epoch=98.1] | Loss=0.01374 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.218 | L2-Norm(final)=13.340 | 4867.2 samples/s | 76.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step20000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=114.6] | Loss=0.00120 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=13.387 | 5663.0 samples/s | 88.5 steps/s
[Step=12050 Epoch=115.1] | Loss=0.00686 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=13.381 | 4510.7 samples/s | 70.5 steps/s
[Step=12100 Epoch=115.5] | Loss=0.00624 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=13.372 | 8494.1 samples/s | 132.7 steps/s
[Step=12150 Epoch=116.0] | Loss=0.00619 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=13.382 | 2317.4 samples/s | 36.2 steps/s
[Step=12200 Epoch=116.5] | Loss=0.00608 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=13.398 | 7667.0 samples/s | 119.8 steps/s
[Step=12250 Epoch=117.0] | Loss=0.00603 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=13.417 | 2402.9 samples/s | 37.5 steps/s
[Step=12300 Epoch=117.5] | Loss=0.00604 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=13.436 | 6913.0 samples/s | 108.0 steps/s
[Step=12350 Epoch=117.9] | Loss=0.00608 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.429 | L2-Norm(final)=13.459 | 2479.6 samples/s | 38.7 steps/s
[Step=12400 Epoch=118.4] | Loss=0.00585 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.429 | L2-Norm(final)=13.482 | 6374.2 samples/s | 99.6 steps/s
[Step=12450 Epoch=118.9] | Loss=0.00572 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=13.508 | 2642.0 samples/s | 41.3 steps/s
[Step=12500 Epoch=119.4] | Loss=0.00574 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.429 | L2-Norm(final)=13.533 | 5589.2 samples/s | 87.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=119.4] | Loss=0.00119 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=13.800 | 5683.0 samples/s | 88.8 steps/s
[Step=12550 Epoch=119.8] | Loss=0.00642 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.660 | L2-Norm(final)=13.817 | 4150.0 samples/s | 64.8 steps/s
[Step=12600 Epoch=120.3] | Loss=0.00471 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=13.821 | 6859.3 samples/s | 107.2 steps/s
[Step=12650 Epoch=120.8] | Loss=0.00412 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.860 | L2-Norm(final)=13.814 | 2168.7 samples/s | 33.9 steps/s
[Step=12700 Epoch=121.3] | Loss=0.00328 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.892 | L2-Norm(final)=13.813 | 6214.7 samples/s | 97.1 steps/s
[Step=12750 Epoch=121.8] | Loss=0.00290 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.911 | L2-Norm(final)=13.812 | 2237.4 samples/s | 35.0 steps/s
[Step=12800 Epoch=122.2] | Loss=0.00243 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.921 | L2-Norm(final)=13.812 | 5802.9 samples/s | 90.7 steps/s
[Step=12850 Epoch=122.7] | Loss=0.00209 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.923 | L2-Norm(final)=13.813 | 2300.2 samples/s | 35.9 steps/s
[Step=12900 Epoch=123.2] | Loss=0.00183 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.920 | L2-Norm(final)=13.814 | 5407.5 samples/s | 84.5 steps/s
[Step=12950 Epoch=123.7] | Loss=0.00163 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.914 | L2-Norm(final)=13.814 | 2364.1 samples/s | 36.9 steps/s
[Step=13000 Epoch=124.1] | Loss=0.00146 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.905 | L2-Norm(final)=13.815 | 4948.7 samples/s | 77.3 steps/s
[Step=13050 Epoch=124.6] | Loss=0.00133 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.895 | L2-Norm(final)=13.816 | 2474.2 samples/s | 38.7 steps/s
[Step=13100 Epoch=125.1] | Loss=0.00122 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.884 | L2-Norm(final)=13.816 | 4636.3 samples/s | 72.4 steps/s
[Step=13150 Epoch=125.6] | Loss=0.00113 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=13.817 | 2516.4 samples/s | 39.3 steps/s
[Step=13200 Epoch=126.1] | Loss=0.00105 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.860 | L2-Norm(final)=13.817 | 4643.4 samples/s | 72.6 steps/s
[Step=13250 Epoch=126.5] | Loss=0.00098 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.847 | L2-Norm(final)=13.818 | 2563.4 samples/s | 40.1 steps/s
[Step=13300 Epoch=127.0] | Loss=0.00092 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.834 | L2-Norm(final)=13.818 | 4585.5 samples/s | 71.6 steps/s
[Step=13350 Epoch=127.5] | Loss=0.00086 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.820 | L2-Norm(final)=13.819 | 2569.5 samples/s | 40.1 steps/s
[Step=13400 Epoch=128.0] | Loss=0.00082 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.807 | L2-Norm(final)=13.819 | 4600.3 samples/s | 71.9 steps/s
[Step=13450 Epoch=128.4] | Loss=0.00077 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=13.820 | 2568.1 samples/s | 40.1 steps/s
[Step=13500 Epoch=128.9] | Loss=0.00073 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.779 | L2-Norm(final)=13.821 | 4594.2 samples/s | 71.8 steps/s
[Step=13550 Epoch=129.4] | Loss=0.00070 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.765 | L2-Norm(final)=13.821 | 7398.8 samples/s | 115.6 steps/s
[Step=13600 Epoch=129.9] | Loss=0.00067 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.751 | L2-Norm(final)=13.822 | 2124.5 samples/s | 33.2 steps/s
[Step=13650 Epoch=130.3] | Loss=0.00064 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.737 | L2-Norm(final)=13.822 | 6822.1 samples/s | 106.6 steps/s
[Step=13700 Epoch=130.8] | Loss=0.00061 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.723 | L2-Norm(final)=13.823 | 2178.6 samples/s | 34.0 steps/s
[Step=13750 Epoch=131.3] | Loss=0.00059 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.709 | L2-Norm(final)=13.823 | 6165.1 samples/s | 96.3 steps/s
[Step=13800 Epoch=131.8] | Loss=0.00057 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.695 | L2-Norm(final)=13.824 | 2250.8 samples/s | 35.2 steps/s
[Step=13850 Epoch=132.3] | Loss=0.00055 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.681 | L2-Norm(final)=13.824 | 5783.8 samples/s | 90.4 steps/s
[Step=13900 Epoch=132.7] | Loss=0.00053 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.666 | L2-Norm(final)=13.825 | 2312.1 samples/s | 36.1 steps/s
[Step=13950 Epoch=133.2] | Loss=0.00051 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.652 | L2-Norm(final)=13.826 | 5396.4 samples/s | 84.3 steps/s
[Step=14000 Epoch=133.7] | Loss=0.00049 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.638 | L2-Norm(final)=13.826 | 2351.5 samples/s | 36.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step14000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=113.1] | Loss=0.00129 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=12.561 | 5344.0 samples/s | 83.5 steps/s
[Step=12050 Epoch=113.5] | Loss=0.00960 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.431 | L2-Norm(final)=12.553 | 4627.9 samples/s | 72.3 steps/s
[Step=12100 Epoch=114.0] | Loss=0.00963 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.431 | L2-Norm(final)=12.546 | 8216.6 samples/s | 128.4 steps/s
[Step=12150 Epoch=114.5] | Loss=0.00941 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.431 | L2-Norm(final)=12.548 | 2378.6 samples/s | 37.2 steps/s
[Step=12200 Epoch=115.0] | Loss=0.00917 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=12.555 | 6869.0 samples/s | 107.3 steps/s
[Step=12250 Epoch=115.4] | Loss=0.00931 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.430 | L2-Norm(final)=12.563 | 2490.1 samples/s | 38.9 steps/s
[Step=12300 Epoch=115.9] | Loss=0.00881 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.430 | L2-Norm(final)=12.574 | 6123.5 samples/s | 95.7 steps/s
[Step=12350 Epoch=116.4] | Loss=0.00864 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=12.589 | 2579.1 samples/s | 40.3 steps/s
[Step=12400 Epoch=116.8] | Loss=0.00872 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.430 | L2-Norm(final)=12.605 | 5697.5 samples/s | 89.0 steps/s
[Step=12450 Epoch=117.3] | Loss=0.00849 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=12.622 | 2697.2 samples/s | 42.1 steps/s
[Step=12500 Epoch=117.8] | Loss=0.00855 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=12.641 | 5419.8 samples/s | 84.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=117.8] | Loss=0.00202 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=12.828 | 5922.3 samples/s | 92.5 steps/s
[Step=12550 Epoch=118.3] | Loss=0.00955 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.577 | L2-Norm(final)=12.830 | 4092.2 samples/s | 63.9 steps/s
[Step=12600 Epoch=118.7] | Loss=0.00732 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.727 | L2-Norm(final)=12.818 | 6509.4 samples/s | 101.7 steps/s
[Step=12650 Epoch=119.2] | Loss=0.00666 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.812 | L2-Norm(final)=12.810 | 2199.2 samples/s | 34.4 steps/s
[Step=12700 Epoch=119.7] | Loss=0.00523 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.863 | L2-Norm(final)=12.804 | 5899.2 samples/s | 92.2 steps/s
[Step=12750 Epoch=120.1] | Loss=0.00444 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.893 | L2-Norm(final)=12.801 | 2329.0 samples/s | 36.4 steps/s
[Step=12800 Epoch=120.6] | Loss=0.00377 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.912 | L2-Norm(final)=12.799 | 5229.2 samples/s | 81.7 steps/s
[Step=12850 Epoch=121.1] | Loss=0.00335 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.923 | L2-Norm(final)=12.797 | 2410.2 samples/s | 37.7 steps/s
[Step=12900 Epoch=121.6] | Loss=0.00294 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.928 | L2-Norm(final)=12.796 | 4782.7 samples/s | 74.7 steps/s
[Step=12950 Epoch=122.0] | Loss=0.00261 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.929 | L2-Norm(final)=12.796 | 2519.6 samples/s | 39.4 steps/s
[Step=13000 Epoch=122.5] | Loss=0.00235 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.927 | L2-Norm(final)=12.796 | 4597.2 samples/s | 71.8 steps/s
[Step=13050 Epoch=123.0] | Loss=0.00214 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.923 | L2-Norm(final)=12.796 | 2584.1 samples/s | 40.4 steps/s
[Step=13100 Epoch=123.4] | Loss=0.00196 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.916 | L2-Norm(final)=12.796 | 4639.6 samples/s | 72.5 steps/s
[Step=13150 Epoch=123.9] | Loss=0.00181 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.909 | L2-Norm(final)=12.796 | 2564.0 samples/s | 40.1 steps/s
[Step=13200 Epoch=124.4] | Loss=0.00168 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.901 | L2-Norm(final)=12.796 | 4669.3 samples/s | 73.0 steps/s
[Step=13250 Epoch=124.9] | Loss=0.00157 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.891 | L2-Norm(final)=12.797 | 2682.9 samples/s | 41.9 steps/s
[Step=13300 Epoch=125.3] | Loss=0.00147 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.882 | L2-Norm(final)=12.797 | 4244.4 samples/s | 66.3 steps/s
[Step=13350 Epoch=125.8] | Loss=0.00139 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=12.797 | 6752.2 samples/s | 105.5 steps/s
[Step=13400 Epoch=126.3] | Loss=0.00131 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.861 | L2-Norm(final)=12.798 | 2191.6 samples/s | 34.2 steps/s
[Step=13450 Epoch=126.7] | Loss=0.00124 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.850 | L2-Norm(final)=12.798 | 6034.8 samples/s | 94.3 steps/s
[Step=13500 Epoch=127.2] | Loss=0.00118 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.839 | L2-Norm(final)=12.799 | 2300.1 samples/s | 35.9 steps/s
[Step=13550 Epoch=127.7] | Loss=0.00113 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.828 | L2-Norm(final)=12.799 | 5417.5 samples/s | 84.6 steps/s
[Step=13600 Epoch=128.2] | Loss=0.00107 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.816 | L2-Norm(final)=12.800 | 2387.7 samples/s | 37.3 steps/s
[Step=13650 Epoch=128.6] | Loss=0.00103 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.804 | L2-Norm(final)=12.800 | 4859.4 samples/s | 75.9 steps/s
[Step=13700 Epoch=129.1] | Loss=0.00099 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.792 | L2-Norm(final)=12.801 | 2533.8 samples/s | 39.6 steps/s
[Step=13750 Epoch=129.6] | Loss=0.00095 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.780 | L2-Norm(final)=12.801 | 4540.9 samples/s | 71.0 steps/s
[Step=13800 Epoch=130.0] | Loss=0.00091 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.768 | L2-Norm(final)=12.802 | 2572.4 samples/s | 40.2 steps/s
[Step=13850 Epoch=130.5] | Loss=0.00088 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.756 | L2-Norm(final)=12.802 | 4638.2 samples/s | 72.5 steps/s
[Step=13900 Epoch=131.0] | Loss=0.00085 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.743 | L2-Norm(final)=12.803 | 2582.4 samples/s | 40.4 steps/s
[Step=13950 Epoch=131.4] | Loss=0.00082 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.731 | L2-Norm(final)=12.803 | 4640.7 samples/s | 72.5 steps/s
[Step=14000 Epoch=131.9] | Loss=0.00079 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.718 | L2-Norm(final)=12.804 | 2566.4 samples/s | 40.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step14000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11401 | acc=0.9547 | tpr=0.9732 | fpr=0.0855 | 5633.0 samples/s | 22.0 steps/s
Avg test loss: 0.12138, Avg test acc: 0.95168, Avg tpr: 0.97086, Avg fpr: 0.09050, total FA: 706

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10847 | acc=0.9521 | tpr=0.9716 | fpr=0.0902 | 5661.1 samples/s | 22.1 steps/s
Avg test loss: 0.11403, Avg test acc: 0.95128, Avg tpr: 0.97057, Avg fpr: 0.09114, total FA: 711

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.12808 | acc=0.9516 | tpr=0.9734 | fpr=0.0959 | 5704.9 samples/s | 22.3 steps/s
Avg test loss: 0.13175, Avg test acc: 0.95024, Avg tpr: 0.97103, Avg fpr: 0.09550, total FA: 745

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.11446 | acc=0.9525 | tpr=0.9710 | fpr=0.0877 | 5518.8 samples/s | 21.6 steps/s
Avg test loss: 0.12209, Avg test acc: 0.95092, Avg tpr: 0.96981, Avg fpr: 0.09063, total FA: 707

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11650 | acc=0.9523 | tpr=0.9712 | fpr=0.0887 | 5792.3 samples/s | 22.6 steps/s
Avg test loss: 0.12134, Avg test acc: 0.95192, Avg tpr: 0.97045, Avg fpr: 0.08883, total FA: 693

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.84577 | acc=0.3050 | tpr=0.0041 | fpr=0.0416 | 5518.2 samples/s | 21.6 steps/s
Avg test loss: 4.86368, Avg test acc: 0.30167, Avg tpr: 0.00315, Avg fpr: 0.04179, total FA: 326

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.61288 | acc=0.2941 | tpr=0.0064 | fpr=0.0813 | 5467.7 samples/s | 21.4 steps/s
Avg test loss: 4.63156, Avg test acc: 0.29141, Avg tpr: 0.00606, Avg fpr: 0.08102, total FA: 632

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.73081 | acc=0.2988 | tpr=0.0259 | fpr=0.1088 | 5702.2 samples/s | 22.3 steps/s
Avg test loss: 4.73827, Avg test acc: 0.29646, Avg tpr: 0.02629, Avg fpr: 0.10934, total FA: 853

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.61026 | acc=0.2941 | tpr=0.0177 | fpr=0.1056 | 5751.3 samples/s | 22.5 steps/s
Avg test loss: 4.62471, Avg test acc: 0.29261, Avg tpr: 0.01824, Avg fpr: 0.10396, total FA: 811

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.11574 | acc=0.3071 | tpr=0.0191 | fpr=0.0674 | 5626.4 samples/s | 22.0 steps/s
Avg test loss: 5.13283, Avg test acc: 0.30479, Avg tpr: 0.01906, Avg fpr: 0.06679, total FA: 521

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.22802 | acc=0.1227 | tpr=0.4027 | fpr=0.8823 | 5784.7 samples/s | 22.6 steps/s
[Step= 100] | Loss=6.17488 | acc=0.1216 | tpr=0.3667 | fpr=0.8830 | 8094.3 samples/s | 31.6 steps/s
[Step= 150] | Loss=6.19440 | acc=0.1211 | tpr=0.3631 | fpr=0.8834 | 7878.2 samples/s | 30.8 steps/s
[Step= 200] | Loss=6.18695 | acc=0.1218 | tpr=0.3585 | fpr=0.8825 | 8153.7 samples/s | 31.9 steps/s
[Step= 250] | Loss=6.19329 | acc=0.1223 | tpr=0.3616 | fpr=0.8821 | 7705.6 samples/s | 30.1 steps/s
[Step= 300] | Loss=6.19770 | acc=0.1226 | tpr=0.3636 | fpr=0.8818 | 7867.4 samples/s | 30.7 steps/s
[Step= 350] | Loss=6.20260 | acc=0.1222 | tpr=0.3475 | fpr=0.8819 | 8390.1 samples/s | 32.8 steps/s
[Step= 400] | Loss=6.19874 | acc=0.1231 | tpr=0.3479 | fpr=0.8809 | 8458.6 samples/s | 33.0 steps/s
[Step= 450] | Loss=6.20004 | acc=0.1232 | tpr=0.3466 | fpr=0.8809 | 8008.1 samples/s | 31.3 steps/s
[Step= 500] | Loss=6.20152 | acc=0.1229 | tpr=0.3436 | fpr=0.8811 | 8273.5 samples/s | 32.3 steps/s
[Step= 550] | Loss=6.19783 | acc=0.1229 | tpr=0.3434 | fpr=0.8811 | 9398.5 samples/s | 36.7 steps/s
Avg test loss: 6.19762, Avg test acc: 0.12290, Avg tpr: 0.34390, Avg fpr: 0.88111, total FA: 122341

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.98008 | acc=0.1315 | tpr=0.2743 | fpr=0.8711 | 5548.6 samples/s | 21.7 steps/s
[Step= 100] | Loss=4.95102 | acc=0.1306 | tpr=0.2324 | fpr=0.8713 | 8057.3 samples/s | 31.5 steps/s
[Step= 150] | Loss=4.96365 | acc=0.1291 | tpr=0.2248 | fpr=0.8727 | 8555.0 samples/s | 33.4 steps/s
[Step= 200] | Loss=4.96122 | acc=0.1297 | tpr=0.2230 | fpr=0.8719 | 8248.0 samples/s | 32.2 steps/s
[Step= 250] | Loss=4.96525 | acc=0.1303 | tpr=0.2210 | fpr=0.8713 | 8053.8 samples/s | 31.5 steps/s
[Step= 300] | Loss=4.96746 | acc=0.1296 | tpr=0.2269 | fpr=0.8721 | 7336.3 samples/s | 28.7 steps/s
[Step= 350] | Loss=4.97049 | acc=0.1295 | tpr=0.2160 | fpr=0.8720 | 8337.5 samples/s | 32.6 steps/s
[Step= 400] | Loss=4.96821 | acc=0.1300 | tpr=0.2155 | fpr=0.8715 | 8006.1 samples/s | 31.3 steps/s
[Step= 450] | Loss=4.97026 | acc=0.1300 | tpr=0.2167 | fpr=0.8716 | 8030.5 samples/s | 31.4 steps/s
[Step= 500] | Loss=4.97180 | acc=0.1296 | tpr=0.2189 | fpr=0.8720 | 8123.6 samples/s | 31.7 steps/s
[Step= 550] | Loss=4.97052 | acc=0.1294 | tpr=0.2181 | fpr=0.8722 | 10412.1 samples/s | 40.7 steps/s
Avg test loss: 4.97048, Avg test acc: 0.12933, Avg tpr: 0.21870, Avg fpr: 0.87230, total FA: 121117

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.91428 | acc=0.1209 | tpr=0.3673 | fpr=0.8835 | 5482.9 samples/s | 21.4 steps/s
[Step= 100] | Loss=6.87187 | acc=0.1213 | tpr=0.3390 | fpr=0.8827 | 8323.0 samples/s | 32.5 steps/s
[Step= 150] | Loss=6.87800 | acc=0.1201 | tpr=0.3184 | fpr=0.8836 | 8028.4 samples/s | 31.4 steps/s
[Step= 200] | Loss=6.87088 | acc=0.1211 | tpr=0.3137 | fpr=0.8825 | 8002.6 samples/s | 31.3 steps/s
[Step= 250] | Loss=6.86694 | acc=0.1217 | tpr=0.3258 | fpr=0.8820 | 7622.1 samples/s | 29.8 steps/s
[Step= 300] | Loss=6.86870 | acc=0.1215 | tpr=0.3287 | fpr=0.8823 | 8367.1 samples/s | 32.7 steps/s
[Step= 350] | Loss=6.87762 | acc=0.1206 | tpr=0.3181 | fpr=0.8830 | 7778.9 samples/s | 30.4 steps/s
[Step= 400] | Loss=6.87425 | acc=0.1210 | tpr=0.3206 | fpr=0.8826 | 8239.2 samples/s | 32.2 steps/s
[Step= 450] | Loss=6.87459 | acc=0.1207 | tpr=0.3155 | fpr=0.8829 | 8482.2 samples/s | 33.1 steps/s
[Step= 500] | Loss=6.87712 | acc=0.1205 | tpr=0.3128 | fpr=0.8830 | 8109.7 samples/s | 31.7 steps/s
[Step= 550] | Loss=6.87147 | acc=0.1207 | tpr=0.3112 | fpr=0.8828 | 10216.9 samples/s | 39.9 steps/s
Avg test loss: 6.87160, Avg test acc: 0.12054, Avg tpr: 0.31181, Avg fpr: 0.88294, total FA: 122594

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.04558 | acc=0.1468 | tpr=0.2522 | fpr=0.8551 | 5646.3 samples/s | 22.1 steps/s
[Step= 100] | Loss=6.01298 | acc=0.1459 | tpr=0.2239 | fpr=0.8556 | 7800.2 samples/s | 30.5 steps/s
[Step= 150] | Loss=6.01050 | acc=0.1453 | tpr=0.2219 | fpr=0.8561 | 7814.1 samples/s | 30.5 steps/s
[Step= 200] | Loss=5.99766 | acc=0.1452 | tpr=0.2240 | fpr=0.8563 | 8322.3 samples/s | 32.5 steps/s
[Step= 250] | Loss=5.99943 | acc=0.1462 | tpr=0.2210 | fpr=0.8552 | 8037.2 samples/s | 31.4 steps/s
[Step= 300] | Loss=6.00333 | acc=0.1457 | tpr=0.2233 | fpr=0.8557 | 7864.6 samples/s | 30.7 steps/s
[Step= 350] | Loss=6.00394 | acc=0.1451 | tpr=0.2129 | fpr=0.8562 | 8046.2 samples/s | 31.4 steps/s
[Step= 400] | Loss=5.99836 | acc=0.1457 | tpr=0.2177 | fpr=0.8556 | 8019.2 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.99805 | acc=0.1461 | tpr=0.2162 | fpr=0.8552 | 8578.4 samples/s | 33.5 steps/s
[Step= 500] | Loss=6.00011 | acc=0.1460 | tpr=0.2159 | fpr=0.8553 | 7984.8 samples/s | 31.2 steps/s
[Step= 550] | Loss=5.99835 | acc=0.1460 | tpr=0.2145 | fpr=0.8553 | 10390.2 samples/s | 40.6 steps/s
Avg test loss: 5.99833, Avg test acc: 0.14585, Avg tpr: 0.21474, Avg fpr: 0.85540, total FA: 118771

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.59420 | acc=0.1263 | tpr=0.2389 | fpr=0.8757 | 5357.7 samples/s | 20.9 steps/s
[Step= 100] | Loss=5.56090 | acc=0.1285 | tpr=0.2281 | fpr=0.8733 | 8263.6 samples/s | 32.3 steps/s
[Step= 150] | Loss=5.57331 | acc=0.1288 | tpr=0.2190 | fpr=0.8729 | 8666.4 samples/s | 33.9 steps/s
[Step= 200] | Loss=5.56945 | acc=0.1298 | tpr=0.2164 | fpr=0.8718 | 8214.8 samples/s | 32.1 steps/s
[Step= 250] | Loss=5.57647 | acc=0.1292 | tpr=0.2140 | fpr=0.8723 | 8298.5 samples/s | 32.4 steps/s
[Step= 300] | Loss=5.58024 | acc=0.1289 | tpr=0.2167 | fpr=0.8727 | 7806.5 samples/s | 30.5 steps/s
[Step= 350] | Loss=5.58343 | acc=0.1284 | tpr=0.2073 | fpr=0.8730 | 8067.3 samples/s | 31.5 steps/s
[Step= 400] | Loss=5.57874 | acc=0.1287 | tpr=0.2057 | fpr=0.8727 | 8301.7 samples/s | 32.4 steps/s
[Step= 450] | Loss=5.58000 | acc=0.1288 | tpr=0.2084 | fpr=0.8726 | 7309.7 samples/s | 28.6 steps/s
[Step= 500] | Loss=5.58175 | acc=0.1285 | tpr=0.2088 | fpr=0.8730 | 8133.2 samples/s | 31.8 steps/s
[Step= 550] | Loss=5.57779 | acc=0.1283 | tpr=0.2081 | fpr=0.8731 | 10732.2 samples/s | 41.9 steps/s
Avg test loss: 5.57739, Avg test acc: 0.12819, Avg tpr: 0.20880, Avg fpr: 0.87327, total FA: 121252

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10171 | acc=0.9803 | tpr=0.8805 | fpr=0.0179 | 5469.7 samples/s | 21.4 steps/s
[Step= 100] | Loss=0.10577 | acc=0.9802 | tpr=0.8827 | fpr=0.0180 | 8429.0 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.10941 | acc=0.9795 | tpr=0.8934 | fpr=0.0189 | 8393.6 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.11133 | acc=0.9796 | tpr=0.9005 | fpr=0.0190 | 8295.1 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.11102 | acc=0.9797 | tpr=0.8996 | fpr=0.0189 | 8343.6 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.11255 | acc=0.9794 | tpr=0.8945 | fpr=0.0190 | 8077.2 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.11249 | acc=0.9795 | tpr=0.8986 | fpr=0.0191 | 7817.6 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.11299 | acc=0.9792 | tpr=0.8944 | fpr=0.0192 | 8221.6 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.11468 | acc=0.9791 | tpr=0.8929 | fpr=0.0194 | 8193.4 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.11419 | acc=0.9791 | tpr=0.8943 | fpr=0.0194 | 7851.3 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.11382 | acc=0.9791 | tpr=0.8938 | fpr=0.0193 | 10017.5 samples/s | 39.1 steps/s
Avg test loss: 0.11366, Avg test acc: 0.97912, Avg tpr: 0.89342, Avg fpr: 0.01932, total FA: 2683

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09454 | acc=0.9812 | tpr=0.8717 | fpr=0.0169 | 5826.0 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.09749 | acc=0.9809 | tpr=0.8763 | fpr=0.0172 | 7801.9 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.10090 | acc=0.9804 | tpr=0.8919 | fpr=0.0180 | 7340.0 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.10234 | acc=0.9805 | tpr=0.8929 | fpr=0.0179 | 8787.2 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.10236 | acc=0.9806 | tpr=0.8926 | fpr=0.0178 | 8062.3 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.10340 | acc=0.9805 | tpr=0.8931 | fpr=0.0179 | 7587.5 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.10387 | acc=0.9804 | tpr=0.8961 | fpr=0.0180 | 8140.3 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.10469 | acc=0.9803 | tpr=0.8928 | fpr=0.0182 | 8357.0 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.10591 | acc=0.9801 | tpr=0.8900 | fpr=0.0182 | 7913.0 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.10498 | acc=0.9803 | tpr=0.8930 | fpr=0.0181 | 8094.1 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.10392 | acc=0.9804 | tpr=0.8930 | fpr=0.0180 | 10604.2 samples/s | 41.4 steps/s
Avg test loss: 0.10372, Avg test acc: 0.98038, Avg tpr: 0.89184, Avg fpr: 0.01801, total FA: 2501

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.13914 | acc=0.9683 | tpr=0.9292 | fpr=0.0310 | 5705.9 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.14535 | acc=0.9672 | tpr=0.9360 | fpr=0.0322 | 8018.6 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.15011 | acc=0.9666 | tpr=0.9424 | fpr=0.0330 | 7675.7 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.15207 | acc=0.9665 | tpr=0.9464 | fpr=0.0331 | 8489.2 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.15353 | acc=0.9665 | tpr=0.9441 | fpr=0.0330 | 8390.4 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.15564 | acc=0.9659 | tpr=0.9375 | fpr=0.0336 | 7891.6 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.15551 | acc=0.9659 | tpr=0.9368 | fpr=0.0336 | 7909.1 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.15729 | acc=0.9655 | tpr=0.9360 | fpr=0.0340 | 8060.0 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.15759 | acc=0.9652 | tpr=0.9343 | fpr=0.0343 | 7468.4 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.15794 | acc=0.9650 | tpr=0.9361 | fpr=0.0344 | 8207.5 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.15684 | acc=0.9652 | tpr=0.9355 | fpr=0.0342 | 11071.5 samples/s | 43.2 steps/s
Avg test loss: 0.15669, Avg test acc: 0.96525, Avg tpr: 0.93542, Avg fpr: 0.03421, total FA: 4750

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.08205 | acc=0.9834 | tpr=0.9071 | fpr=0.0153 | 5871.3 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.08899 | acc=0.9830 | tpr=0.9254 | fpr=0.0159 | 7932.4 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.09201 | acc=0.9826 | tpr=0.9280 | fpr=0.0164 | 7468.5 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.09287 | acc=0.9827 | tpr=0.9279 | fpr=0.0163 | 8094.4 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.09258 | acc=0.9827 | tpr=0.9205 | fpr=0.0162 | 7873.8 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.09388 | acc=0.9825 | tpr=0.9185 | fpr=0.0163 | 8811.6 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.09389 | acc=0.9824 | tpr=0.9198 | fpr=0.0165 | 8677.4 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.09423 | acc=0.9824 | tpr=0.9190 | fpr=0.0165 | 8236.8 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.09590 | acc=0.9822 | tpr=0.9172 | fpr=0.0167 | 8031.8 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.09520 | acc=0.9822 | tpr=0.9189 | fpr=0.0166 | 7366.6 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.09464 | acc=0.9823 | tpr=0.9188 | fpr=0.0165 | 10172.2 samples/s | 39.7 steps/s
Avg test loss: 0.09450, Avg test acc: 0.98232, Avg tpr: 0.91838, Avg fpr: 0.01651, total FA: 2293

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.13112 | acc=0.9770 | tpr=0.9027 | fpr=0.0216 | 5802.0 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.13659 | acc=0.9771 | tpr=0.9168 | fpr=0.0218 | 7873.1 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.14270 | acc=0.9762 | tpr=0.9265 | fpr=0.0229 | 8074.2 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.14315 | acc=0.9765 | tpr=0.9279 | fpr=0.0227 | 8538.6 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.14267 | acc=0.9766 | tpr=0.9249 | fpr=0.0225 | 7862.7 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.14528 | acc=0.9765 | tpr=0.9251 | fpr=0.0225 | 7677.7 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.14605 | acc=0.9762 | tpr=0.9249 | fpr=0.0228 | 7770.8 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.14699 | acc=0.9761 | tpr=0.9234 | fpr=0.0229 | 8537.3 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.14950 | acc=0.9758 | tpr=0.9221 | fpr=0.0232 | 8453.9 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.14858 | acc=0.9759 | tpr=0.9242 | fpr=0.0231 | 8194.1 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.14749 | acc=0.9761 | tpr=0.9244 | fpr=0.0229 | 10001.8 samples/s | 39.1 steps/s
Avg test loss: 0.14714, Avg test acc: 0.97616, Avg tpr: 0.92393, Avg fpr: 0.02289, total FA: 3178

server round 15/50

clients selected: [0 1 3 5 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=48.8] | Loss=0.01785 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.391 | L2-Norm(final)=11.200 | 5774.8 samples/s | 90.2 steps/s
[Step=10050 Epoch=49.0] | Loss=0.04765 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.391 | L2-Norm(final)=11.230 | 5184.7 samples/s | 81.0 steps/s
[Step=10100 Epoch=49.2] | Loss=0.04733 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.391 | L2-Norm(final)=11.274 | 5453.1 samples/s | 85.2 steps/s
[Step=10150 Epoch=49.5] | Loss=0.04760 | Reg=0.00130 | acc=0.9375 | L2-Norm=11.391 | L2-Norm(final)=11.314 | 5592.0 samples/s | 87.4 steps/s
[Step=10200 Epoch=49.7] | Loss=0.04711 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.391 | L2-Norm(final)=11.356 | 8782.0 samples/s | 137.2 steps/s
[Step=10250 Epoch=50.0] | Loss=0.04834 | Reg=0.00130 | acc=0.9375 | L2-Norm=11.391 | L2-Norm(final)=11.394 | 2449.5 samples/s | 38.3 steps/s
[Step=10300 Epoch=50.2] | Loss=0.04773 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.391 | L2-Norm(final)=11.429 | 5457.1 samples/s | 85.3 steps/s
[Step=10350 Epoch=50.5] | Loss=0.04727 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.391 | L2-Norm(final)=11.465 | 5620.3 samples/s | 87.8 steps/s
[Step=10400 Epoch=50.7] | Loss=0.04714 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.391 | L2-Norm(final)=11.502 | 7829.1 samples/s | 122.3 steps/s
[Step=10450 Epoch=51.0] | Loss=0.04712 | Reg=0.00130 | acc=0.9375 | L2-Norm=11.391 | L2-Norm(final)=11.537 | 2545.3 samples/s | 39.8 steps/s
[Step=10500 Epoch=51.2] | Loss=0.04688 | Reg=0.00130 | acc=0.9531 | L2-Norm=11.391 | L2-Norm(final)=11.572 | 5615.8 samples/s | 87.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=51.2] | Loss=0.03119 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.391 | L2-Norm(final)=11.922 | 5951.2 samples/s | 93.0 steps/s
[Step=10550 Epoch=51.4] | Loss=0.04974 | Reg=0.00133 | acc=0.9375 | L2-Norm=11.511 | L2-Norm(final)=11.922 | 4634.5 samples/s | 72.4 steps/s
[Step=10600 Epoch=51.7] | Loss=0.04809 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.630 | L2-Norm(final)=11.909 | 4907.3 samples/s | 76.7 steps/s
[Step=10650 Epoch=51.9] | Loss=0.04641 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.707 | L2-Norm(final)=11.898 | 4779.3 samples/s | 74.7 steps/s
[Step=10700 Epoch=52.2] | Loss=0.04311 | Reg=0.00138 | acc=0.9531 | L2-Norm=11.767 | L2-Norm(final)=11.892 | 6922.6 samples/s | 108.2 steps/s
[Step=10750 Epoch=52.4] | Loss=0.03842 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.818 | L2-Norm(final)=11.890 | 2263.9 samples/s | 35.4 steps/s
[Step=10800 Epoch=52.7] | Loss=0.03460 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.861 | L2-Norm(final)=11.892 | 4890.6 samples/s | 76.4 steps/s
[Step=10850 Epoch=52.9] | Loss=0.03215 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.896 | L2-Norm(final)=11.893 | 4846.1 samples/s | 75.7 steps/s
[Step=10900 Epoch=53.2] | Loss=0.03028 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.927 | L2-Norm(final)=11.895 | 6333.4 samples/s | 99.0 steps/s
[Step=10950 Epoch=53.4] | Loss=0.02867 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.957 | L2-Norm(final)=11.897 | 2344.1 samples/s | 36.6 steps/s
[Step=11000 Epoch=53.6] | Loss=0.02708 | Reg=0.00144 | acc=0.9688 | L2-Norm=11.984 | L2-Norm(final)=11.899 | 4884.4 samples/s | 76.3 steps/s
[Step=11050 Epoch=53.9] | Loss=0.02596 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.009 | L2-Norm(final)=11.901 | 4924.4 samples/s | 76.9 steps/s
[Step=11100 Epoch=54.1] | Loss=0.02500 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.032 | L2-Norm(final)=11.902 | 5716.4 samples/s | 89.3 steps/s
[Step=11150 Epoch=54.4] | Loss=0.02401 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.054 | L2-Norm(final)=11.903 | 2401.8 samples/s | 37.5 steps/s
[Step=11200 Epoch=54.6] | Loss=0.02279 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.075 | L2-Norm(final)=11.905 | 4920.8 samples/s | 76.9 steps/s
[Step=11250 Epoch=54.9] | Loss=0.02200 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.093 | L2-Norm(final)=11.907 | 4858.4 samples/s | 75.9 steps/s
[Step=11300 Epoch=55.1] | Loss=0.02125 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.110 | L2-Norm(final)=11.909 | 5355.8 samples/s | 83.7 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02050 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.126 | L2-Norm(final)=11.910 | 2511.0 samples/s | 39.2 steps/s
[Step=11400 Epoch=55.6] | Loss=0.01982 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=11.912 | 4868.1 samples/s | 76.1 steps/s
[Step=11450 Epoch=55.8] | Loss=0.01919 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.154 | L2-Norm(final)=11.914 | 4922.0 samples/s | 76.9 steps/s
[Step=11500 Epoch=56.1] | Loss=0.01858 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=11.916 | 4938.9 samples/s | 77.2 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01802 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.178 | L2-Norm(final)=11.918 | 2590.7 samples/s | 40.5 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01742 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.189 | L2-Norm(final)=11.920 | 4889.9 samples/s | 76.4 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01686 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.199 | L2-Norm(final)=11.922 | 4924.3 samples/s | 76.9 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01643 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.208 | L2-Norm(final)=11.924 | 4880.5 samples/s | 76.3 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01601 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.216 | L2-Norm(final)=11.926 | 2621.1 samples/s | 41.0 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01556 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.224 | L2-Norm(final)=11.928 | 4850.8 samples/s | 75.8 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01526 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.231 | L2-Norm(final)=11.930 | 4939.0 samples/s | 77.2 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01486 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=11.932 | 4811.5 samples/s | 75.2 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01446 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.244 | L2-Norm(final)=11.934 | 2651.2 samples/s | 41.4 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01406 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.250 | L2-Norm(final)=11.936 | 4784.8 samples/s | 74.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step12000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=107.4] | Loss=0.02146 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.391 | L2-Norm(final)=13.479 | 5868.4 samples/s | 91.7 steps/s
[Step=22050 Epoch=107.6] | Loss=0.04731 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.394 | L2-Norm(final)=13.495 | 4785.5 samples/s | 74.8 steps/s
[Step=22100 Epoch=107.8] | Loss=0.04764 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.394 | L2-Norm(final)=13.505 | 5619.6 samples/s | 87.8 steps/s
[Step=22150 Epoch=108.1] | Loss=0.04679 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.394 | L2-Norm(final)=13.517 | 5642.1 samples/s | 88.2 steps/s
[Step=22200 Epoch=108.3] | Loss=0.04623 | Reg=0.00130 | acc=0.9219 | L2-Norm=11.394 | L2-Norm(final)=13.534 | 8750.7 samples/s | 136.7 steps/s
[Step=22250 Epoch=108.6] | Loss=0.04667 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.394 | L2-Norm(final)=13.547 | 2422.5 samples/s | 37.9 steps/s
[Step=22300 Epoch=108.8] | Loss=0.04589 | Reg=0.00130 | acc=0.9531 | L2-Norm=11.394 | L2-Norm(final)=13.559 | 5650.5 samples/s | 88.3 steps/s
[Step=22350 Epoch=109.1] | Loss=0.04579 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.394 | L2-Norm(final)=13.573 | 5619.9 samples/s | 87.8 steps/s
[Step=22400 Epoch=109.3] | Loss=0.04576 | Reg=0.00130 | acc=0.9219 | L2-Norm=11.394 | L2-Norm(final)=13.587 | 7916.8 samples/s | 123.7 steps/s
[Step=22450 Epoch=109.5] | Loss=0.04574 | Reg=0.00130 | acc=0.9062 | L2-Norm=11.394 | L2-Norm(final)=13.602 | 2489.8 samples/s | 38.9 steps/s
[Step=22500 Epoch=109.8] | Loss=0.04539 | Reg=0.00130 | acc=0.9531 | L2-Norm=11.394 | L2-Norm(final)=13.617 | 5605.0 samples/s | 87.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=109.8] | Loss=0.04253 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.395 | L2-Norm(final)=13.774 | 5506.4 samples/s | 86.0 steps/s
[Step=22550 Epoch=110.0] | Loss=0.05395 | Reg=0.00133 | acc=0.9219 | L2-Norm=11.536 | L2-Norm(final)=13.769 | 4509.4 samples/s | 70.5 steps/s
[Step=22600 Epoch=110.3] | Loss=0.05072 | Reg=0.00136 | acc=0.9062 | L2-Norm=11.650 | L2-Norm(final)=13.754 | 4928.6 samples/s | 77.0 steps/s
[Step=22650 Epoch=110.5] | Loss=0.04746 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.731 | L2-Norm(final)=13.746 | 4784.4 samples/s | 74.8 steps/s
[Step=22700 Epoch=110.8] | Loss=0.04406 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.792 | L2-Norm(final)=13.741 | 7016.9 samples/s | 109.6 steps/s
[Step=22750 Epoch=111.0] | Loss=0.03891 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.841 | L2-Norm(final)=13.740 | 2259.8 samples/s | 35.3 steps/s
[Step=22800 Epoch=111.3] | Loss=0.03587 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.879 | L2-Norm(final)=13.741 | 4843.0 samples/s | 75.7 steps/s
[Step=22850 Epoch=111.5] | Loss=0.03273 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.911 | L2-Norm(final)=13.742 | 4880.3 samples/s | 76.3 steps/s
[Step=22900 Epoch=111.7] | Loss=0.03107 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.938 | L2-Norm(final)=13.744 | 6427.7 samples/s | 100.4 steps/s
[Step=22950 Epoch=112.0] | Loss=0.02893 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.962 | L2-Norm(final)=13.745 | 2303.9 samples/s | 36.0 steps/s
[Step=23000 Epoch=112.2] | Loss=0.02692 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.984 | L2-Norm(final)=13.748 | 4890.0 samples/s | 76.4 steps/s
[Step=23050 Epoch=112.5] | Loss=0.02539 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.002 | L2-Norm(final)=13.750 | 4804.0 samples/s | 75.1 steps/s
[Step=23100 Epoch=112.7] | Loss=0.02422 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.019 | L2-Norm(final)=13.752 | 6037.5 samples/s | 94.3 steps/s
[Step=23150 Epoch=113.0] | Loss=0.02309 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.034 | L2-Norm(final)=13.754 | 2407.8 samples/s | 37.6 steps/s
[Step=23200 Epoch=113.2] | Loss=0.02173 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.048 | L2-Norm(final)=13.757 | 4853.1 samples/s | 75.8 steps/s
[Step=23250 Epoch=113.4] | Loss=0.02071 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.060 | L2-Norm(final)=13.759 | 4811.1 samples/s | 75.2 steps/s
[Step=23300 Epoch=113.7] | Loss=0.02006 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.071 | L2-Norm(final)=13.761 | 5647.7 samples/s | 88.2 steps/s
[Step=23350 Epoch=113.9] | Loss=0.01923 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.081 | L2-Norm(final)=13.763 | 2464.0 samples/s | 38.5 steps/s
[Step=23400 Epoch=114.2] | Loss=0.01843 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.091 | L2-Norm(final)=13.765 | 4861.5 samples/s | 76.0 steps/s
[Step=23450 Epoch=114.4] | Loss=0.01781 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.099 | L2-Norm(final)=13.767 | 4920.3 samples/s | 76.9 steps/s
[Step=23500 Epoch=114.7] | Loss=0.01716 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.107 | L2-Norm(final)=13.770 | 5227.2 samples/s | 81.7 steps/s
[Step=23550 Epoch=114.9] | Loss=0.01661 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.114 | L2-Norm(final)=13.772 | 2527.9 samples/s | 39.5 steps/s
[Step=23600 Epoch=115.2] | Loss=0.01607 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=13.774 | 4867.7 samples/s | 76.1 steps/s
[Step=23650 Epoch=115.4] | Loss=0.01565 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=13.777 | 4884.8 samples/s | 76.3 steps/s
[Step=23700 Epoch=115.6] | Loss=0.01524 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.135 | L2-Norm(final)=13.779 | 4914.4 samples/s | 76.8 steps/s
[Step=23750 Epoch=115.9] | Loss=0.01481 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=13.781 | 2576.5 samples/s | 40.3 steps/s
[Step=23800 Epoch=116.1] | Loss=0.01438 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=13.783 | 4809.2 samples/s | 75.1 steps/s
[Step=23850 Epoch=116.4] | Loss=0.01399 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=13.786 | 4926.3 samples/s | 77.0 steps/s
[Step=23900 Epoch=116.6] | Loss=0.01363 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=13.788 | 4767.1 samples/s | 74.5 steps/s
[Step=23950 Epoch=116.9] | Loss=0.01331 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=13.791 | 2637.1 samples/s | 41.2 steps/s
[Step=24000 Epoch=117.1] | Loss=0.01303 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=13.793 | 4943.0 samples/s | 77.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step24000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=68.3] | Loss=0.04144 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.391 | L2-Norm(final)=12.667 | 6182.6 samples/s | 96.6 steps/s
[Step=14050 Epoch=68.5] | Loss=0.04675 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.392 | L2-Norm(final)=12.673 | 4983.0 samples/s | 77.9 steps/s
[Step=14100 Epoch=68.8] | Loss=0.04573 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.392 | L2-Norm(final)=12.681 | 5578.9 samples/s | 87.2 steps/s
[Step=14150 Epoch=69.0] | Loss=0.04608 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.392 | L2-Norm(final)=12.689 | 5863.3 samples/s | 91.6 steps/s
[Step=14200 Epoch=69.2] | Loss=0.04575 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.392 | L2-Norm(final)=12.700 | 8322.6 samples/s | 130.0 steps/s
[Step=14250 Epoch=69.5] | Loss=0.04586 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.392 | L2-Norm(final)=12.715 | 2429.4 samples/s | 38.0 steps/s
[Step=14300 Epoch=69.7] | Loss=0.04516 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.392 | L2-Norm(final)=12.730 | 5596.1 samples/s | 87.4 steps/s
[Step=14350 Epoch=70.0] | Loss=0.04531 | Reg=0.00130 | acc=0.9531 | L2-Norm=11.392 | L2-Norm(final)=12.747 | 5728.8 samples/s | 89.5 steps/s
[Step=14400 Epoch=70.2] | Loss=0.04506 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.392 | L2-Norm(final)=12.764 | 7659.7 samples/s | 119.7 steps/s
[Step=14450 Epoch=70.5] | Loss=0.04492 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.392 | L2-Norm(final)=12.782 | 2501.5 samples/s | 39.1 steps/s
[Step=14500 Epoch=70.7] | Loss=0.04482 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.392 | L2-Norm(final)=12.801 | 5645.6 samples/s | 88.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=70.7] | Loss=0.04202 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.392 | L2-Norm(final)=12.993 | 5952.5 samples/s | 93.0 steps/s
[Step=14550 Epoch=71.0] | Loss=0.04523 | Reg=0.00132 | acc=0.9375 | L2-Norm=11.504 | L2-Norm(final)=12.989 | 4309.0 samples/s | 67.3 steps/s
[Step=14600 Epoch=71.2] | Loss=0.04498 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.607 | L2-Norm(final)=12.970 | 4843.9 samples/s | 75.7 steps/s
[Step=14650 Epoch=71.4] | Loss=0.04399 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.677 | L2-Norm(final)=12.957 | 4842.2 samples/s | 75.7 steps/s
[Step=14700 Epoch=71.7] | Loss=0.04034 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=12.947 | 7031.0 samples/s | 109.9 steps/s
[Step=14750 Epoch=71.9] | Loss=0.03610 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.773 | L2-Norm(final)=12.944 | 2264.4 samples/s | 35.4 steps/s
[Step=14800 Epoch=72.2] | Loss=0.03297 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.808 | L2-Norm(final)=12.943 | 4879.1 samples/s | 76.2 steps/s
[Step=14850 Epoch=72.4] | Loss=0.03068 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=12.942 | 4944.1 samples/s | 77.3 steps/s
[Step=14900 Epoch=72.7] | Loss=0.02849 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.863 | L2-Norm(final)=12.943 | 6141.4 samples/s | 96.0 steps/s
[Step=14950 Epoch=72.9] | Loss=0.02841 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.888 | L2-Norm(final)=12.943 | 2347.9 samples/s | 36.7 steps/s
[Step=15000 Epoch=73.1] | Loss=0.02699 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.916 | L2-Norm(final)=12.943 | 4881.2 samples/s | 76.3 steps/s
[Step=15050 Epoch=73.4] | Loss=0.02599 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.943 | L2-Norm(final)=12.944 | 4850.3 samples/s | 75.8 steps/s
[Step=15100 Epoch=73.6] | Loss=0.02540 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.968 | L2-Norm(final)=12.945 | 5876.5 samples/s | 91.8 steps/s
[Step=15150 Epoch=73.9] | Loss=0.02428 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.990 | L2-Norm(final)=12.945 | 2407.5 samples/s | 37.6 steps/s
[Step=15200 Epoch=74.1] | Loss=0.02304 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.011 | L2-Norm(final)=12.946 | 4862.1 samples/s | 76.0 steps/s
[Step=15250 Epoch=74.4] | Loss=0.02211 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.029 | L2-Norm(final)=12.948 | 4875.1 samples/s | 76.2 steps/s
[Step=15300 Epoch=74.6] | Loss=0.02126 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.045 | L2-Norm(final)=12.949 | 5390.1 samples/s | 84.2 steps/s
[Step=15350 Epoch=74.9] | Loss=0.02034 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.060 | L2-Norm(final)=12.951 | 2494.6 samples/s | 39.0 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01943 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.073 | L2-Norm(final)=12.953 | 4865.0 samples/s | 76.0 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01880 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.085 | L2-Norm(final)=12.955 | 4969.5 samples/s | 77.6 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01823 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.096 | L2-Norm(final)=12.957 | 4891.5 samples/s | 76.4 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01754 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.106 | L2-Norm(final)=12.959 | 2621.8 samples/s | 41.0 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01697 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.116 | L2-Norm(final)=12.961 | 4821.2 samples/s | 75.3 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01646 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.124 | L2-Norm(final)=12.963 | 4834.6 samples/s | 75.5 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01603 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.132 | L2-Norm(final)=12.965 | 4901.7 samples/s | 76.6 steps/s
[Step=15750 Epoch=76.8] | Loss=0.01561 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.139 | L2-Norm(final)=12.967 | 2642.6 samples/s | 41.3 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01520 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=12.968 | 4797.3 samples/s | 75.0 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01493 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.152 | L2-Norm(final)=12.970 | 4867.4 samples/s | 76.1 steps/s
[Step=15900 Epoch=77.5] | Loss=0.01460 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=12.971 | 4894.4 samples/s | 76.5 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01424 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.164 | L2-Norm(final)=12.972 | 2647.8 samples/s | 41.4 steps/s
[Step=16000 Epoch=78.0] | Loss=0.01386 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=12.974 | 4952.0 samples/s | 77.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=151.6] | Loss=0.00114 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.391 | L2-Norm(final)=13.139 | 5562.0 samples/s | 86.9 steps/s
[Step=16050 Epoch=152.1] | Loss=0.00485 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.386 | L2-Norm(final)=13.143 | 4627.3 samples/s | 72.3 steps/s
[Step=16100 Epoch=152.6] | Loss=0.00512 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.385 | L2-Norm(final)=13.150 | 8393.2 samples/s | 131.1 steps/s
[Step=16150 Epoch=153.0] | Loss=0.00466 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.385 | L2-Norm(final)=13.163 | 2310.3 samples/s | 36.1 steps/s
[Step=16200 Epoch=153.5] | Loss=0.00471 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.385 | L2-Norm(final)=13.178 | 7413.6 samples/s | 115.8 steps/s
[Step=16250 Epoch=154.0] | Loss=0.00493 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.385 | L2-Norm(final)=13.193 | 2416.5 samples/s | 37.8 steps/s
[Step=16300 Epoch=154.5] | Loss=0.00491 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.385 | L2-Norm(final)=13.208 | 6626.1 samples/s | 103.5 steps/s
[Step=16350 Epoch=154.9] | Loss=0.00479 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.385 | L2-Norm(final)=13.223 | 2471.0 samples/s | 38.6 steps/s
[Step=16400 Epoch=155.4] | Loss=0.00486 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.385 | L2-Norm(final)=13.238 | 6013.7 samples/s | 94.0 steps/s
[Step=16450 Epoch=155.9] | Loss=0.00477 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.385 | L2-Norm(final)=13.253 | 2644.6 samples/s | 41.3 steps/s
[Step=16500 Epoch=156.4] | Loss=0.00475 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.385 | L2-Norm(final)=13.269 | 5431.1 samples/s | 84.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=156.4] | Loss=0.00017 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.385 | L2-Norm(final)=13.430 | 6109.6 samples/s | 95.5 steps/s
[Step=16550 Epoch=156.8] | Loss=0.00685 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.607 | L2-Norm(final)=13.419 | 4007.7 samples/s | 62.6 steps/s
[Step=16600 Epoch=157.3] | Loss=0.00780 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.772 | L2-Norm(final)=13.392 | 6590.8 samples/s | 103.0 steps/s
[Step=16650 Epoch=157.8] | Loss=0.00525 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.842 | L2-Norm(final)=13.379 | 2168.2 samples/s | 33.9 steps/s
[Step=16700 Epoch=158.2] | Loss=0.00394 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.869 | L2-Norm(final)=13.373 | 6101.4 samples/s | 95.3 steps/s
[Step=16750 Epoch=158.7] | Loss=0.00316 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.879 | L2-Norm(final)=13.370 | 2283.6 samples/s | 35.7 steps/s
[Step=16800 Epoch=159.2] | Loss=0.00264 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.880 | L2-Norm(final)=13.367 | 5468.3 samples/s | 85.4 steps/s
[Step=16850 Epoch=159.7] | Loss=0.00226 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.876 | L2-Norm(final)=13.366 | 2353.4 samples/s | 36.8 steps/s
[Step=16900 Epoch=160.1] | Loss=0.00198 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.870 | L2-Norm(final)=13.365 | 5109.1 samples/s | 79.8 steps/s
[Step=16950 Epoch=160.6] | Loss=0.00176 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.862 | L2-Norm(final)=13.365 | 2447.1 samples/s | 38.2 steps/s
[Step=17000 Epoch=161.1] | Loss=0.00159 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.852 | L2-Norm(final)=13.364 | 4760.6 samples/s | 74.4 steps/s
[Step=17050 Epoch=161.6] | Loss=0.00144 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.842 | L2-Norm(final)=13.364 | 2488.5 samples/s | 38.9 steps/s
[Step=17100 Epoch=162.0] | Loss=0.00132 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.832 | L2-Norm(final)=13.364 | 4676.7 samples/s | 73.1 steps/s
[Step=17150 Epoch=162.5] | Loss=0.00122 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.821 | L2-Norm(final)=13.364 | 2602.2 samples/s | 40.7 steps/s
[Step=17200 Epoch=163.0] | Loss=0.00113 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=13.364 | 4495.4 samples/s | 70.2 steps/s
[Step=17250 Epoch=163.5] | Loss=0.00106 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.798 | L2-Norm(final)=13.364 | 2635.3 samples/s | 41.2 steps/s
[Step=17300 Epoch=163.9] | Loss=0.00099 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.787 | L2-Norm(final)=13.364 | 4436.0 samples/s | 69.3 steps/s
[Step=17350 Epoch=164.4] | Loss=0.00093 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.775 | L2-Norm(final)=13.364 | 2657.3 samples/s | 41.5 steps/s
[Step=17400 Epoch=164.9] | Loss=0.00088 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.764 | L2-Norm(final)=13.364 | 4505.7 samples/s | 70.4 steps/s
[Step=17450 Epoch=165.4] | Loss=0.00084 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.752 | L2-Norm(final)=13.364 | 6846.0 samples/s | 107.0 steps/s
[Step=17500 Epoch=165.8] | Loss=0.00080 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.740 | L2-Norm(final)=13.364 | 2162.5 samples/s | 33.8 steps/s
[Step=17550 Epoch=166.3] | Loss=0.00076 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.728 | L2-Norm(final)=13.364 | 6284.7 samples/s | 98.2 steps/s
[Step=17600 Epoch=166.8] | Loss=0.00072 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.716 | L2-Norm(final)=13.365 | 2259.6 samples/s | 35.3 steps/s
[Step=17650 Epoch=167.2] | Loss=0.00069 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=13.365 | 5624.5 samples/s | 87.9 steps/s
[Step=17700 Epoch=167.7] | Loss=0.00066 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.693 | L2-Norm(final)=13.365 | 2326.1 samples/s | 36.3 steps/s
[Step=17750 Epoch=168.2] | Loss=0.00064 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.681 | L2-Norm(final)=13.365 | 5236.6 samples/s | 81.8 steps/s
[Step=17800 Epoch=168.7] | Loss=0.00061 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.669 | L2-Norm(final)=13.365 | 2407.9 samples/s | 37.6 steps/s
[Step=17850 Epoch=169.1] | Loss=0.00059 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.657 | L2-Norm(final)=13.365 | 4861.3 samples/s | 76.0 steps/s
[Step=17900 Epoch=169.6] | Loss=0.00057 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.645 | L2-Norm(final)=13.366 | 2504.0 samples/s | 39.1 steps/s
[Step=17950 Epoch=170.1] | Loss=0.00055 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.633 | L2-Norm(final)=13.366 | 4651.2 samples/s | 72.7 steps/s
[Step=18000 Epoch=170.6] | Loss=0.00053 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=13.366 | 2545.9 samples/s | 39.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step18000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=131.9] | Loss=0.00398 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.391 | L2-Norm(final)=12.819 | 5502.3 samples/s | 86.0 steps/s
[Step=14050 Epoch=132.4] | Loss=0.00920 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.387 | L2-Norm(final)=12.832 | 4830.9 samples/s | 75.5 steps/s
[Step=14100 Epoch=132.9] | Loss=0.00744 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.386 | L2-Norm(final)=12.853 | 7862.7 samples/s | 122.9 steps/s
[Step=14150 Epoch=133.3] | Loss=0.00692 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.386 | L2-Norm(final)=12.879 | 2354.9 samples/s | 36.8 steps/s
[Step=14200 Epoch=133.8] | Loss=0.00675 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.386 | L2-Norm(final)=12.902 | 7125.2 samples/s | 111.3 steps/s
[Step=14250 Epoch=134.3] | Loss=0.00674 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.386 | L2-Norm(final)=12.927 | 2465.5 samples/s | 38.5 steps/s
[Step=14300 Epoch=134.7] | Loss=0.00678 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.386 | L2-Norm(final)=12.952 | 6296.9 samples/s | 98.4 steps/s
[Step=14350 Epoch=135.2] | Loss=0.00696 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.386 | L2-Norm(final)=12.977 | 2564.5 samples/s | 40.1 steps/s
[Step=14400 Epoch=135.7] | Loss=0.00690 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.386 | L2-Norm(final)=13.001 | 5688.3 samples/s | 88.9 steps/s
[Step=14450 Epoch=136.2] | Loss=0.00690 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.386 | L2-Norm(final)=13.025 | 2755.6 samples/s | 43.1 steps/s
[Step=14500 Epoch=136.6] | Loss=0.00688 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.386 | L2-Norm(final)=13.050 | 5289.2 samples/s | 82.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=136.6] | Loss=0.00504 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.386 | L2-Norm(final)=13.296 | 5318.7 samples/s | 83.1 steps/s
[Step=14550 Epoch=137.1] | Loss=0.00468 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.513 | L2-Norm(final)=13.305 | 4421.1 samples/s | 69.1 steps/s
[Step=14600 Epoch=137.6] | Loss=0.00411 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.608 | L2-Norm(final)=13.311 | 6531.3 samples/s | 102.1 steps/s
[Step=14650 Epoch=138.0] | Loss=0.00289 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.663 | L2-Norm(final)=13.313 | 2203.7 samples/s | 34.4 steps/s
[Step=14700 Epoch=138.5] | Loss=0.00269 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=13.314 | 5856.8 samples/s | 91.5 steps/s
[Step=14750 Epoch=139.0] | Loss=0.00216 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.730 | L2-Norm(final)=13.313 | 2309.6 samples/s | 36.1 steps/s
[Step=14800 Epoch=139.5] | Loss=0.00182 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.747 | L2-Norm(final)=13.313 | 5247.3 samples/s | 82.0 steps/s
[Step=14850 Epoch=139.9] | Loss=0.00157 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.754 | L2-Norm(final)=13.313 | 2388.9 samples/s | 37.3 steps/s
[Step=14900 Epoch=140.4] | Loss=0.00137 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.755 | L2-Norm(final)=13.314 | 4781.8 samples/s | 74.7 steps/s
[Step=14950 Epoch=140.9] | Loss=0.00122 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.752 | L2-Norm(final)=13.314 | 2487.6 samples/s | 38.9 steps/s
[Step=15000 Epoch=141.3] | Loss=0.00110 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.746 | L2-Norm(final)=13.315 | 4628.5 samples/s | 72.3 steps/s
[Step=15050 Epoch=141.8] | Loss=0.00100 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=13.315 | 2573.6 samples/s | 40.2 steps/s
[Step=15100 Epoch=142.3] | Loss=0.00092 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=13.316 | 4620.4 samples/s | 72.2 steps/s
[Step=15150 Epoch=142.8] | Loss=0.00085 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.718 | L2-Norm(final)=13.316 | 2590.6 samples/s | 40.5 steps/s
[Step=15200 Epoch=143.2] | Loss=0.00079 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.707 | L2-Norm(final)=13.317 | 4584.2 samples/s | 71.6 steps/s
[Step=15250 Epoch=143.7] | Loss=0.00073 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.696 | L2-Norm(final)=13.317 | 2809.4 samples/s | 43.9 steps/s
[Step=15300 Epoch=144.2] | Loss=0.00069 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=13.317 | 4034.6 samples/s | 63.0 steps/s
[Step=15350 Epoch=144.6] | Loss=0.00065 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=13.318 | 6721.9 samples/s | 105.0 steps/s
[Step=15400 Epoch=145.1] | Loss=0.00061 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.658 | L2-Norm(final)=13.318 | 2189.5 samples/s | 34.2 steps/s
[Step=15450 Epoch=145.6] | Loss=0.00058 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.645 | L2-Norm(final)=13.319 | 5909.8 samples/s | 92.3 steps/s
[Step=15500 Epoch=146.1] | Loss=0.00055 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.631 | L2-Norm(final)=13.319 | 2288.7 samples/s | 35.8 steps/s
[Step=15550 Epoch=146.5] | Loss=0.00052 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.618 | L2-Norm(final)=13.319 | 5426.3 samples/s | 84.8 steps/s
[Step=15600 Epoch=147.0] | Loss=0.00050 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.604 | L2-Norm(final)=13.320 | 2388.4 samples/s | 37.3 steps/s
[Step=15650 Epoch=147.5] | Loss=0.00048 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.591 | L2-Norm(final)=13.320 | 4885.3 samples/s | 76.3 steps/s
[Step=15700 Epoch=147.9] | Loss=0.00046 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.577 | L2-Norm(final)=13.321 | 2511.6 samples/s | 39.2 steps/s
[Step=15750 Epoch=148.4] | Loss=0.00044 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.563 | L2-Norm(final)=13.321 | 4571.5 samples/s | 71.4 steps/s
[Step=15800 Epoch=148.9] | Loss=0.00042 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.549 | L2-Norm(final)=13.321 | 2612.6 samples/s | 40.8 steps/s
[Step=15850 Epoch=149.4] | Loss=0.00041 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.535 | L2-Norm(final)=13.322 | 4548.0 samples/s | 71.1 steps/s
[Step=15900 Epoch=149.8] | Loss=0.00039 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.521 | L2-Norm(final)=13.322 | 2577.0 samples/s | 40.3 steps/s
[Step=15950 Epoch=150.3] | Loss=0.00038 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=13.323 | 4577.8 samples/s | 71.5 steps/s
[Step=16000 Epoch=150.8] | Loss=0.00037 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.493 | L2-Norm(final)=13.323 | 2704.5 samples/s | 42.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.12193 | acc=0.9541 | tpr=0.9668 | fpr=0.0733 | 5559.9 samples/s | 21.7 steps/s
Avg test loss: 0.12695, Avg test acc: 0.95256, Avg tpr: 0.96544, Avg fpr: 0.07576, total FA: 591

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.11945 | acc=0.9530 | tpr=0.9731 | fpr=0.0904 | 5661.2 samples/s | 22.1 steps/s
Avg test loss: 0.12130, Avg test acc: 0.95276, Avg tpr: 0.97196, Avg fpr: 0.08948, total FA: 698

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.12808 | acc=0.9516 | tpr=0.9734 | fpr=0.0959 | 5825.0 samples/s | 22.8 steps/s
Avg test loss: 0.13175, Avg test acc: 0.95024, Avg tpr: 0.97103, Avg fpr: 0.09550, total FA: 745

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10871 | acc=0.9560 | tpr=0.9744 | fpr=0.0840 | 5645.6 samples/s | 22.1 steps/s
Avg test loss: 0.11893, Avg test acc: 0.95456, Avg tpr: 0.97395, Avg fpr: 0.08807, total FA: 687

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11650 | acc=0.9523 | tpr=0.9712 | fpr=0.0887 | 5800.7 samples/s | 22.7 steps/s
Avg test loss: 0.12134, Avg test acc: 0.95192, Avg tpr: 0.97045, Avg fpr: 0.08883, total FA: 693

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.85816 | acc=0.3085 | tpr=0.0146 | fpr=0.0533 | 5783.5 samples/s | 22.6 steps/s
Avg test loss: 4.86362, Avg test acc: 0.30772, Avg tpr: 0.01475, Avg fpr: 0.04794, total FA: 374

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.61288 | acc=0.2941 | tpr=0.0064 | fpr=0.0813 | 5771.4 samples/s | 22.5 steps/s
Avg test loss: 4.63156, Avg test acc: 0.29141, Avg tpr: 0.00606, Avg fpr: 0.08102, total FA: 632

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.73081 | acc=0.2988 | tpr=0.0259 | fpr=0.1088 | 5623.1 samples/s | 22.0 steps/s
Avg test loss: 4.73827, Avg test acc: 0.29646, Avg tpr: 0.02629, Avg fpr: 0.10934, total FA: 853

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.71897 | acc=0.2923 | tpr=0.0169 | fpr=0.1095 | 5792.3 samples/s | 22.6 steps/s
Avg test loss: 4.72579, Avg test acc: 0.29161, Avg tpr: 0.01708, Avg fpr: 0.10460, total FA: 816

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.11574 | acc=0.3071 | tpr=0.0191 | fpr=0.0674 | 5820.1 samples/s | 22.7 steps/s
Avg test loss: 5.13283, Avg test acc: 0.30479, Avg tpr: 0.01906, Avg fpr: 0.06679, total FA: 521

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.83451 | acc=0.1451 | tpr=0.3982 | fpr=0.8595 | 5671.8 samples/s | 22.2 steps/s
[Step= 100] | Loss=6.76889 | acc=0.1431 | tpr=0.3625 | fpr=0.8610 | 8287.1 samples/s | 32.4 steps/s
[Step= 150] | Loss=6.77737 | acc=0.1417 | tpr=0.3689 | fpr=0.8625 | 5397.4 samples/s | 21.1 steps/s
[Step= 200] | Loss=6.77291 | acc=0.1421 | tpr=0.3617 | fpr=0.8619 | 7977.4 samples/s | 31.2 steps/s
[Step= 250] | Loss=6.77989 | acc=0.1422 | tpr=0.3537 | fpr=0.8617 | 8250.0 samples/s | 32.2 steps/s
[Step= 300] | Loss=6.77807 | acc=0.1420 | tpr=0.3535 | fpr=0.8618 | 8103.9 samples/s | 31.7 steps/s
[Step= 350] | Loss=6.77994 | acc=0.1420 | tpr=0.3388 | fpr=0.8616 | 8362.6 samples/s | 32.7 steps/s
[Step= 400] | Loss=6.77524 | acc=0.1425 | tpr=0.3375 | fpr=0.8610 | 8007.0 samples/s | 31.3 steps/s
[Step= 450] | Loss=6.77857 | acc=0.1424 | tpr=0.3354 | fpr=0.8611 | 7645.8 samples/s | 29.9 steps/s
[Step= 500] | Loss=6.78000 | acc=0.1422 | tpr=0.3348 | fpr=0.8613 | 7977.7 samples/s | 31.2 steps/s
[Step= 550] | Loss=6.77697 | acc=0.1420 | tpr=0.3311 | fpr=0.8614 | 11553.4 samples/s | 45.1 steps/s
Avg test loss: 6.77740, Avg test acc: 0.14192, Avg tpr: 0.33082, Avg fpr: 0.86151, total FA: 119619

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.82946 | acc=0.1329 | tpr=0.2876 | fpr=0.8699 | 5678.2 samples/s | 22.2 steps/s
[Step= 100] | Loss=5.79658 | acc=0.1345 | tpr=0.2431 | fpr=0.8676 | 5933.2 samples/s | 23.2 steps/s
[Step= 150] | Loss=5.80012 | acc=0.1332 | tpr=0.2320 | fpr=0.8686 | 7417.3 samples/s | 29.0 steps/s
[Step= 200] | Loss=5.79714 | acc=0.1334 | tpr=0.2306 | fpr=0.8684 | 8635.6 samples/s | 33.7 steps/s
[Step= 250] | Loss=5.79513 | acc=0.1335 | tpr=0.2341 | fpr=0.8683 | 7953.3 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.79543 | acc=0.1335 | tpr=0.2320 | fpr=0.8683 | 8476.1 samples/s | 33.1 steps/s
[Step= 350] | Loss=5.79624 | acc=0.1330 | tpr=0.2198 | fpr=0.8685 | 7787.8 samples/s | 30.4 steps/s
[Step= 400] | Loss=5.79339 | acc=0.1335 | tpr=0.2210 | fpr=0.8681 | 7953.5 samples/s | 31.1 steps/s
[Step= 450] | Loss=5.79592 | acc=0.1332 | tpr=0.2181 | fpr=0.8684 | 7737.2 samples/s | 30.2 steps/s
[Step= 500] | Loss=5.79776 | acc=0.1331 | tpr=0.2194 | fpr=0.8685 | 8288.4 samples/s | 32.4 steps/s
[Step= 550] | Loss=5.79859 | acc=0.1330 | tpr=0.2161 | fpr=0.8685 | 10159.0 samples/s | 39.7 steps/s
Avg test loss: 5.79896, Avg test acc: 0.13281, Avg tpr: 0.21712, Avg fpr: 0.86872, total FA: 120620

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.91428 | acc=0.1209 | tpr=0.3673 | fpr=0.8835 | 5677.4 samples/s | 22.2 steps/s
[Step= 100] | Loss=6.87187 | acc=0.1213 | tpr=0.3390 | fpr=0.8827 | 5974.5 samples/s | 23.3 steps/s
[Step= 150] | Loss=6.87800 | acc=0.1201 | tpr=0.3184 | fpr=0.8836 | 7566.9 samples/s | 29.6 steps/s
[Step= 200] | Loss=6.87088 | acc=0.1211 | tpr=0.3137 | fpr=0.8825 | 8391.8 samples/s | 32.8 steps/s
[Step= 250] | Loss=6.86694 | acc=0.1217 | tpr=0.3258 | fpr=0.8820 | 8172.1 samples/s | 31.9 steps/s
[Step= 300] | Loss=6.86870 | acc=0.1215 | tpr=0.3287 | fpr=0.8823 | 8083.2 samples/s | 31.6 steps/s
[Step= 350] | Loss=6.87762 | acc=0.1206 | tpr=0.3181 | fpr=0.8830 | 8119.3 samples/s | 31.7 steps/s
[Step= 400] | Loss=6.87425 | acc=0.1210 | tpr=0.3206 | fpr=0.8826 | 7545.5 samples/s | 29.5 steps/s
[Step= 450] | Loss=6.87459 | acc=0.1207 | tpr=0.3155 | fpr=0.8829 | 7614.5 samples/s | 29.7 steps/s
[Step= 500] | Loss=6.87712 | acc=0.1205 | tpr=0.3128 | fpr=0.8830 | 8541.5 samples/s | 33.4 steps/s
[Step= 550] | Loss=6.87147 | acc=0.1207 | tpr=0.3112 | fpr=0.8828 | 10403.2 samples/s | 40.6 steps/s
Avg test loss: 6.87160, Avg test acc: 0.12054, Avg tpr: 0.31181, Avg fpr: 0.88294, total FA: 122594

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.01452 | acc=0.1350 | tpr=0.2876 | fpr=0.8677 | 5397.0 samples/s | 21.1 steps/s
[Step= 100] | Loss=5.98651 | acc=0.1320 | tpr=0.2623 | fpr=0.8704 | 6348.2 samples/s | 24.8 steps/s
[Step= 150] | Loss=5.98832 | acc=0.1309 | tpr=0.2435 | fpr=0.8711 | 7393.3 samples/s | 28.9 steps/s
[Step= 200] | Loss=5.98071 | acc=0.1304 | tpr=0.2448 | fpr=0.8716 | 8252.8 samples/s | 32.2 steps/s
[Step= 250] | Loss=5.98383 | acc=0.1307 | tpr=0.2410 | fpr=0.8713 | 8547.6 samples/s | 33.4 steps/s
[Step= 300] | Loss=5.98539 | acc=0.1303 | tpr=0.2444 | fpr=0.8718 | 7987.3 samples/s | 31.2 steps/s
[Step= 350] | Loss=5.98433 | acc=0.1297 | tpr=0.2348 | fpr=0.8722 | 8373.6 samples/s | 32.7 steps/s
[Step= 400] | Loss=5.97925 | acc=0.1300 | tpr=0.2423 | fpr=0.8721 | 7988.9 samples/s | 31.2 steps/s
[Step= 450] | Loss=5.97942 | acc=0.1303 | tpr=0.2410 | fpr=0.8717 | 7424.4 samples/s | 29.0 steps/s
[Step= 500] | Loss=5.98253 | acc=0.1300 | tpr=0.2401 | fpr=0.8719 | 8020.5 samples/s | 31.3 steps/s
[Step= 550] | Loss=5.98068 | acc=0.1301 | tpr=0.2404 | fpr=0.8719 | 10600.4 samples/s | 41.4 steps/s
Avg test loss: 5.98117, Avg test acc: 0.13008, Avg tpr: 0.24128, Avg fpr: 0.87194, total FA: 121067

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.59420 | acc=0.1263 | tpr=0.2389 | fpr=0.8757 | 5636.0 samples/s | 22.0 steps/s
[Step= 100] | Loss=5.56090 | acc=0.1285 | tpr=0.2281 | fpr=0.8733 | 5974.2 samples/s | 23.3 steps/s
[Step= 150] | Loss=5.57331 | acc=0.1288 | tpr=0.2190 | fpr=0.8729 | 8164.4 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.56945 | acc=0.1298 | tpr=0.2164 | fpr=0.8718 | 8086.3 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.57647 | acc=0.1292 | tpr=0.2140 | fpr=0.8723 | 7579.4 samples/s | 29.6 steps/s
[Step= 300] | Loss=5.58024 | acc=0.1289 | tpr=0.2167 | fpr=0.8727 | 8399.8 samples/s | 32.8 steps/s
[Step= 350] | Loss=5.58343 | acc=0.1284 | tpr=0.2073 | fpr=0.8730 | 8351.0 samples/s | 32.6 steps/s
[Step= 400] | Loss=5.57874 | acc=0.1287 | tpr=0.2057 | fpr=0.8727 | 7754.7 samples/s | 30.3 steps/s
[Step= 450] | Loss=5.58000 | acc=0.1288 | tpr=0.2084 | fpr=0.8726 | 7441.1 samples/s | 29.1 steps/s
[Step= 500] | Loss=5.58175 | acc=0.1285 | tpr=0.2088 | fpr=0.8730 | 8241.8 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.57779 | acc=0.1283 | tpr=0.2081 | fpr=0.8731 | 10723.8 samples/s | 41.9 steps/s
Avg test loss: 5.57739, Avg test acc: 0.12819, Avg tpr: 0.20880, Avg fpr: 0.87327, total FA: 121252

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13750 | acc=0.9763 | tpr=0.8938 | fpr=0.0222 | 4585.4 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.14098 | acc=0.9763 | tpr=0.9232 | fpr=0.0227 | 7952.2 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.14670 | acc=0.9756 | tpr=0.9236 | fpr=0.0234 | 8311.8 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.14742 | acc=0.9760 | tpr=0.9279 | fpr=0.0231 | 7835.2 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.14595 | acc=0.9761 | tpr=0.9214 | fpr=0.0229 | 7444.1 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.14783 | acc=0.9759 | tpr=0.9200 | fpr=0.0231 | 8178.5 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.14912 | acc=0.9759 | tpr=0.9192 | fpr=0.0231 | 8240.3 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.15057 | acc=0.9757 | tpr=0.9163 | fpr=0.0233 | 7968.2 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.15291 | acc=0.9754 | tpr=0.9148 | fpr=0.0235 | 7964.1 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.15229 | acc=0.9755 | tpr=0.9185 | fpr=0.0234 | 8345.3 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.15136 | acc=0.9757 | tpr=0.9168 | fpr=0.0232 | 9970.3 samples/s | 38.9 steps/s
Avg test loss: 0.15109, Avg test acc: 0.97572, Avg tpr: 0.91680, Avg fpr: 0.02321, total FA: 3223

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09454 | acc=0.9812 | tpr=0.8717 | fpr=0.0169 | 5583.3 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.09749 | acc=0.9809 | tpr=0.8763 | fpr=0.0172 | 8183.1 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.10090 | acc=0.9804 | tpr=0.8919 | fpr=0.0180 | 8248.2 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.10234 | acc=0.9805 | tpr=0.8929 | fpr=0.0179 | 8096.9 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.10236 | acc=0.9806 | tpr=0.8926 | fpr=0.0178 | 6051.1 samples/s | 23.6 steps/s
[Step= 300] | Loss=0.10340 | acc=0.9805 | tpr=0.8931 | fpr=0.0179 | 7571.4 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.10387 | acc=0.9804 | tpr=0.8961 | fpr=0.0180 | 7852.9 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.10469 | acc=0.9803 | tpr=0.8928 | fpr=0.0182 | 7973.1 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.10591 | acc=0.9801 | tpr=0.8900 | fpr=0.0182 | 7915.9 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.10498 | acc=0.9803 | tpr=0.8930 | fpr=0.0181 | 8398.5 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.10392 | acc=0.9804 | tpr=0.8930 | fpr=0.0180 | 10229.2 samples/s | 40.0 steps/s
Avg test loss: 0.10372, Avg test acc: 0.98038, Avg tpr: 0.89184, Avg fpr: 0.01801, total FA: 2501

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.13914 | acc=0.9683 | tpr=0.9292 | fpr=0.0310 | 5684.4 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.14535 | acc=0.9672 | tpr=0.9360 | fpr=0.0322 | 8268.0 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.15011 | acc=0.9666 | tpr=0.9424 | fpr=0.0330 | 8136.0 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.15207 | acc=0.9665 | tpr=0.9464 | fpr=0.0331 | 5598.1 samples/s | 21.9 steps/s
[Step= 250] | Loss=0.15353 | acc=0.9665 | tpr=0.9441 | fpr=0.0330 | 8513.3 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.15564 | acc=0.9659 | tpr=0.9375 | fpr=0.0336 | 7828.1 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.15551 | acc=0.9659 | tpr=0.9368 | fpr=0.0336 | 8058.9 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.15729 | acc=0.9655 | tpr=0.9360 | fpr=0.0340 | 8242.3 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.15759 | acc=0.9652 | tpr=0.9343 | fpr=0.0343 | 8116.3 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.15794 | acc=0.9650 | tpr=0.9361 | fpr=0.0344 | 7370.3 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.15684 | acc=0.9652 | tpr=0.9355 | fpr=0.0342 | 10916.9 samples/s | 42.6 steps/s
Avg test loss: 0.15669, Avg test acc: 0.96525, Avg tpr: 0.93542, Avg fpr: 0.03421, total FA: 4750

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09092 | acc=0.9827 | tpr=0.9071 | fpr=0.0159 | 5684.0 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.09442 | acc=0.9822 | tpr=0.9147 | fpr=0.0165 | 7829.8 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.09885 | acc=0.9814 | tpr=0.9207 | fpr=0.0175 | 7989.7 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.10085 | acc=0.9811 | tpr=0.9180 | fpr=0.0177 | 6167.7 samples/s | 24.1 steps/s
[Step= 250] | Loss=0.10080 | acc=0.9812 | tpr=0.9127 | fpr=0.0176 | 8050.1 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.10235 | acc=0.9810 | tpr=0.9135 | fpr=0.0177 | 7870.4 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.10260 | acc=0.9810 | tpr=0.9142 | fpr=0.0178 | 7515.5 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.10309 | acc=0.9809 | tpr=0.9130 | fpr=0.0179 | 8309.9 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.10476 | acc=0.9807 | tpr=0.9119 | fpr=0.0181 | 8287.1 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.10452 | acc=0.9807 | tpr=0.9145 | fpr=0.0181 | 7984.1 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.10397 | acc=0.9807 | tpr=0.9144 | fpr=0.0181 | 9978.5 samples/s | 39.0 steps/s
Avg test loss: 0.10375, Avg test acc: 0.98071, Avg tpr: 0.91403, Avg fpr: 0.01808, total FA: 2510

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.13112 | acc=0.9770 | tpr=0.9027 | fpr=0.0216 | 5857.7 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.13659 | acc=0.9771 | tpr=0.9168 | fpr=0.0218 | 7837.4 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.14270 | acc=0.9762 | tpr=0.9265 | fpr=0.0229 | 7854.7 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.14315 | acc=0.9765 | tpr=0.9279 | fpr=0.0227 | 5774.2 samples/s | 22.6 steps/s
[Step= 250] | Loss=0.14267 | acc=0.9766 | tpr=0.9249 | fpr=0.0225 | 7880.4 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.14528 | acc=0.9765 | tpr=0.9251 | fpr=0.0225 | 8505.3 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.14605 | acc=0.9762 | tpr=0.9249 | fpr=0.0228 | 8083.7 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.14699 | acc=0.9761 | tpr=0.9234 | fpr=0.0229 | 8073.8 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.14950 | acc=0.9758 | tpr=0.9221 | fpr=0.0232 | 7986.2 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.14858 | acc=0.9759 | tpr=0.9242 | fpr=0.0231 | 8387.2 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.14749 | acc=0.9761 | tpr=0.9244 | fpr=0.0229 | 9999.9 samples/s | 39.1 steps/s
Avg test loss: 0.14714, Avg test acc: 0.97616, Avg tpr: 0.92393, Avg fpr: 0.02289, total FA: 3178

server round 16/50

clients selected: [2 3 4 7 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=78.0] | Loss=0.09815 | Reg=0.00128 | acc=0.9531 | L2-Norm=11.320 | L2-Norm(final)=12.353 | 6017.8 samples/s | 94.0 steps/s
[Step=16050 Epoch=78.2] | Loss=0.04767 | Reg=0.00128 | acc=0.9531 | L2-Norm=11.321 | L2-Norm(final)=12.357 | 4930.5 samples/s | 77.0 steps/s
[Step=16100 Epoch=78.4] | Loss=0.04935 | Reg=0.00128 | acc=0.9531 | L2-Norm=11.321 | L2-Norm(final)=12.375 | 5506.7 samples/s | 86.0 steps/s
[Step=16150 Epoch=78.7] | Loss=0.04891 | Reg=0.00128 | acc=0.9531 | L2-Norm=11.321 | L2-Norm(final)=12.392 | 5604.8 samples/s | 87.6 steps/s
[Step=16200 Epoch=78.9] | Loss=0.04765 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.321 | L2-Norm(final)=12.412 | 8732.2 samples/s | 136.4 steps/s
[Step=16250 Epoch=79.2] | Loss=0.04680 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.321 | L2-Norm(final)=12.433 | 2398.1 samples/s | 37.5 steps/s
[Step=16300 Epoch=79.4] | Loss=0.04603 | Reg=0.00128 | acc=0.9375 | L2-Norm=11.321 | L2-Norm(final)=12.457 | 5666.1 samples/s | 88.5 steps/s
[Step=16350 Epoch=79.7] | Loss=0.04657 | Reg=0.00128 | acc=0.9375 | L2-Norm=11.321 | L2-Norm(final)=12.480 | 5777.7 samples/s | 90.3 steps/s
[Step=16400 Epoch=79.9] | Loss=0.04693 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.321 | L2-Norm(final)=12.502 | 7480.9 samples/s | 116.9 steps/s
[Step=16450 Epoch=80.2] | Loss=0.04709 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.321 | L2-Norm(final)=12.523 | 2546.7 samples/s | 39.8 steps/s
[Step=16500 Epoch=80.4] | Loss=0.04701 | Reg=0.00128 | acc=0.9062 | L2-Norm=11.321 | L2-Norm(final)=12.541 | 5539.8 samples/s | 86.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=80.4] | Loss=0.03869 | Reg=0.00128 | acc=0.9531 | L2-Norm=11.321 | L2-Norm(final)=12.728 | 5666.7 samples/s | 88.5 steps/s
[Step=16550 Epoch=80.6] | Loss=0.04854 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=12.723 | 4426.8 samples/s | 69.2 steps/s
[Step=16600 Epoch=80.9] | Loss=0.04786 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.544 | L2-Norm(final)=12.710 | 5002.8 samples/s | 78.2 steps/s
[Step=16650 Epoch=81.1] | Loss=0.04306 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.623 | L2-Norm(final)=12.706 | 4709.7 samples/s | 73.6 steps/s
[Step=16700 Epoch=81.4] | Loss=0.04082 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.686 | L2-Norm(final)=12.702 | 6941.4 samples/s | 108.5 steps/s
[Step=16750 Epoch=81.6] | Loss=0.03747 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.739 | L2-Norm(final)=12.702 | 2274.8 samples/s | 35.5 steps/s
[Step=16800 Epoch=81.9] | Loss=0.03389 | Reg=0.00139 | acc=0.9688 | L2-Norm=11.782 | L2-Norm(final)=12.703 | 4814.5 samples/s | 75.2 steps/s
[Step=16850 Epoch=82.1] | Loss=0.03131 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.816 | L2-Norm(final)=12.704 | 4917.2 samples/s | 76.8 steps/s
[Step=16900 Epoch=82.3] | Loss=0.02952 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.846 | L2-Norm(final)=12.706 | 6219.0 samples/s | 97.2 steps/s
[Step=16950 Epoch=82.6] | Loss=0.02772 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.874 | L2-Norm(final)=12.709 | 2330.5 samples/s | 36.4 steps/s
[Step=17000 Epoch=82.8] | Loss=0.02619 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.900 | L2-Norm(final)=12.711 | 4892.4 samples/s | 76.4 steps/s
[Step=17050 Epoch=83.1] | Loss=0.02517 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.923 | L2-Norm(final)=12.714 | 4816.8 samples/s | 75.3 steps/s
[Step=17100 Epoch=83.3] | Loss=0.02403 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.946 | L2-Norm(final)=12.716 | 5841.8 samples/s | 91.3 steps/s
[Step=17150 Epoch=83.6] | Loss=0.02300 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.967 | L2-Norm(final)=12.718 | 2434.4 samples/s | 38.0 steps/s
[Step=17200 Epoch=83.8] | Loss=0.02209 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.985 | L2-Norm(final)=12.721 | 4776.3 samples/s | 74.6 steps/s
[Step=17250 Epoch=84.1] | Loss=0.02115 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.002 | L2-Norm(final)=12.723 | 4908.8 samples/s | 76.7 steps/s
[Step=17300 Epoch=84.3] | Loss=0.02038 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.018 | L2-Norm(final)=12.726 | 5343.0 samples/s | 83.5 steps/s
[Step=17350 Epoch=84.5] | Loss=0.01949 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.032 | L2-Norm(final)=12.729 | 1878.2 samples/s | 29.3 steps/s
[Step=17400 Epoch=84.8] | Loss=0.01878 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.046 | L2-Norm(final)=12.731 | 4725.9 samples/s | 73.8 steps/s
[Step=17450 Epoch=85.0] | Loss=0.01815 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.058 | L2-Norm(final)=12.734 | 4645.7 samples/s | 72.6 steps/s
[Step=17500 Epoch=85.3] | Loss=0.01764 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.069 | L2-Norm(final)=12.736 | 4973.4 samples/s | 77.7 steps/s
[Step=17550 Epoch=85.5] | Loss=0.01707 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.080 | L2-Norm(final)=12.738 | 2595.7 samples/s | 40.6 steps/s
[Step=17600 Epoch=85.8] | Loss=0.01646 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.090 | L2-Norm(final)=12.741 | 4900.8 samples/s | 76.6 steps/s
[Step=17650 Epoch=86.0] | Loss=0.01598 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.099 | L2-Norm(final)=12.743 | 4901.6 samples/s | 76.6 steps/s
[Step=17700 Epoch=86.2] | Loss=0.01555 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.107 | L2-Norm(final)=12.746 | 4827.3 samples/s | 75.4 steps/s
[Step=17750 Epoch=86.5] | Loss=0.01520 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.115 | L2-Norm(final)=12.748 | 2597.9 samples/s | 40.6 steps/s
[Step=17800 Epoch=86.7] | Loss=0.01480 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.122 | L2-Norm(final)=12.750 | 4846.9 samples/s | 75.7 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01451 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.129 | L2-Norm(final)=12.752 | 4884.4 samples/s | 76.3 steps/s
[Step=17900 Epoch=87.2] | Loss=0.01422 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.136 | L2-Norm(final)=12.754 | 4827.5 samples/s | 75.4 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01394 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=12.756 | 2654.7 samples/s | 41.5 steps/s
[Step=18000 Epoch=87.7] | Loss=0.01354 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=12.758 | 4788.8 samples/s | 74.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step18000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=78.0] | Loss=0.04424 | Reg=0.00128 | acc=0.9531 | L2-Norm=11.320 | L2-Norm(final)=13.024 | 5621.8 samples/s | 87.8 steps/s
[Step=16050 Epoch=78.3] | Loss=0.05056 | Reg=0.00128 | acc=0.9531 | L2-Norm=11.321 | L2-Norm(final)=13.036 | 5107.1 samples/s | 79.8 steps/s
[Step=16100 Epoch=78.5] | Loss=0.04622 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.321 | L2-Norm(final)=13.054 | 5735.8 samples/s | 89.6 steps/s
[Step=16150 Epoch=78.8] | Loss=0.04485 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.321 | L2-Norm(final)=13.079 | 5454.3 samples/s | 85.2 steps/s
[Step=16200 Epoch=79.0] | Loss=0.04477 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.321 | L2-Norm(final)=13.101 | 8612.8 samples/s | 134.6 steps/s
[Step=16250 Epoch=79.2] | Loss=0.04552 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.321 | L2-Norm(final)=13.121 | 2447.5 samples/s | 38.2 steps/s
[Step=16300 Epoch=79.5] | Loss=0.04501 | Reg=0.00128 | acc=0.9375 | L2-Norm=11.321 | L2-Norm(final)=13.142 | 5625.8 samples/s | 87.9 steps/s
[Step=16350 Epoch=79.7] | Loss=0.04531 | Reg=0.00128 | acc=0.9219 | L2-Norm=11.321 | L2-Norm(final)=13.162 | 5609.6 samples/s | 87.6 steps/s
[Step=16400 Epoch=80.0] | Loss=0.04465 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.321 | L2-Norm(final)=13.182 | 7821.6 samples/s | 122.2 steps/s
[Step=16450 Epoch=80.2] | Loss=0.04419 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.321 | L2-Norm(final)=13.204 | 2522.0 samples/s | 39.4 steps/s
[Step=16500 Epoch=80.5] | Loss=0.04395 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.321 | L2-Norm(final)=13.226 | 5612.8 samples/s | 87.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=80.5] | Loss=0.04229 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.321 | L2-Norm(final)=13.450 | 5949.8 samples/s | 93.0 steps/s
[Step=16550 Epoch=80.7] | Loss=0.04171 | Reg=0.00130 | acc=0.9531 | L2-Norm=11.415 | L2-Norm(final)=13.454 | 4307.9 samples/s | 67.3 steps/s
[Step=16600 Epoch=81.0] | Loss=0.03996 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.508 | L2-Norm(final)=13.446 | 4867.0 samples/s | 76.0 steps/s
[Step=16650 Epoch=81.2] | Loss=0.04072 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.574 | L2-Norm(final)=13.438 | 4825.1 samples/s | 75.4 steps/s
[Step=16700 Epoch=81.4] | Loss=0.03872 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.633 | L2-Norm(final)=13.432 | 7011.2 samples/s | 109.5 steps/s
[Step=16750 Epoch=81.7] | Loss=0.03710 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.686 | L2-Norm(final)=13.431 | 2262.3 samples/s | 35.3 steps/s
[Step=16800 Epoch=81.9] | Loss=0.03400 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.732 | L2-Norm(final)=13.431 | 4868.2 samples/s | 76.1 steps/s
[Step=16850 Epoch=82.2] | Loss=0.03163 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.772 | L2-Norm(final)=13.433 | 4891.4 samples/s | 76.4 steps/s
[Step=16900 Epoch=82.4] | Loss=0.03004 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.805 | L2-Norm(final)=13.434 | 6227.4 samples/s | 97.3 steps/s
[Step=16950 Epoch=82.7] | Loss=0.02803 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.836 | L2-Norm(final)=13.435 | 2366.6 samples/s | 37.0 steps/s
[Step=17000 Epoch=82.9] | Loss=0.02605 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.862 | L2-Norm(final)=13.437 | 4844.1 samples/s | 75.7 steps/s
[Step=17050 Epoch=83.1] | Loss=0.02468 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.884 | L2-Norm(final)=13.439 | 4840.1 samples/s | 75.6 steps/s
[Step=17100 Epoch=83.4] | Loss=0.02370 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.904 | L2-Norm(final)=13.440 | 5842.2 samples/s | 91.3 steps/s
[Step=17150 Epoch=83.6] | Loss=0.02233 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.921 | L2-Norm(final)=13.441 | 2412.6 samples/s | 37.7 steps/s
[Step=17200 Epoch=83.9] | Loss=0.02150 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.935 | L2-Norm(final)=13.443 | 4915.9 samples/s | 76.8 steps/s
[Step=17250 Epoch=84.1] | Loss=0.02072 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.949 | L2-Norm(final)=13.444 | 4810.4 samples/s | 75.2 steps/s
[Step=17300 Epoch=84.4] | Loss=0.01983 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.961 | L2-Norm(final)=13.445 | 5397.1 samples/s | 84.3 steps/s
[Step=17350 Epoch=84.6] | Loss=0.01895 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=13.446 | 2544.9 samples/s | 39.8 steps/s
[Step=17400 Epoch=84.9] | Loss=0.01819 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.982 | L2-Norm(final)=13.448 | 4813.0 samples/s | 75.2 steps/s
[Step=17450 Epoch=85.1] | Loss=0.01770 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.992 | L2-Norm(final)=13.450 | 4864.3 samples/s | 76.0 steps/s
[Step=17500 Epoch=85.3] | Loss=0.01718 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.001 | L2-Norm(final)=13.451 | 5016.2 samples/s | 78.4 steps/s
[Step=17550 Epoch=85.6] | Loss=0.01661 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.009 | L2-Norm(final)=13.453 | 2608.5 samples/s | 40.8 steps/s
[Step=17600 Epoch=85.8] | Loss=0.01605 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.017 | L2-Norm(final)=13.454 | 4842.1 samples/s | 75.7 steps/s
[Step=17650 Epoch=86.1] | Loss=0.01552 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.024 | L2-Norm(final)=13.456 | 4887.6 samples/s | 76.4 steps/s
[Step=17700 Epoch=86.3] | Loss=0.01511 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.030 | L2-Norm(final)=13.458 | 4819.7 samples/s | 75.3 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01471 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.036 | L2-Norm(final)=13.459 | 2669.1 samples/s | 41.7 steps/s
[Step=17800 Epoch=86.8] | Loss=0.01430 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.041 | L2-Norm(final)=13.461 | 4823.5 samples/s | 75.4 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01394 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.046 | L2-Norm(final)=13.463 | 4927.5 samples/s | 77.0 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01360 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.051 | L2-Norm(final)=13.464 | 4779.6 samples/s | 74.7 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01328 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.055 | L2-Norm(final)=13.466 | 2675.4 samples/s | 41.8 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01309 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.059 | L2-Norm(final)=13.467 | 4857.1 samples/s | 75.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step18000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=98.1] | Loss=0.01584 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.320 | L2-Norm(final)=13.387 | 5687.8 samples/s | 88.9 steps/s
[Step=20050 Epoch=98.3] | Loss=0.04168 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.321 | L2-Norm(final)=13.420 | 5017.1 samples/s | 78.4 steps/s
[Step=20100 Epoch=98.6] | Loss=0.04367 | Reg=0.00128 | acc=0.9375 | L2-Norm=11.321 | L2-Norm(final)=13.443 | 5557.0 samples/s | 86.8 steps/s
[Step=20150 Epoch=98.8] | Loss=0.04442 | Reg=0.00128 | acc=0.9375 | L2-Norm=11.321 | L2-Norm(final)=13.467 | 5731.7 samples/s | 89.6 steps/s
[Step=20200 Epoch=99.1] | Loss=0.04387 | Reg=0.00128 | acc=0.9219 | L2-Norm=11.321 | L2-Norm(final)=13.484 | 8826.4 samples/s | 137.9 steps/s
[Step=20250 Epoch=99.3] | Loss=0.04469 | Reg=0.00128 | acc=0.9531 | L2-Norm=11.321 | L2-Norm(final)=13.501 | 2402.9 samples/s | 37.5 steps/s
[Step=20300 Epoch=99.5] | Loss=0.04488 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.321 | L2-Norm(final)=13.519 | 5626.4 samples/s | 87.9 steps/s
[Step=20350 Epoch=99.8] | Loss=0.04441 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.321 | L2-Norm(final)=13.538 | 5681.2 samples/s | 88.8 steps/s
[Step=20400 Epoch=100.0] | Loss=0.04378 | Reg=0.00128 | acc=0.9531 | L2-Norm=11.321 | L2-Norm(final)=13.558 | 8157.8 samples/s | 127.5 steps/s
[Step=20450 Epoch=100.3] | Loss=0.04383 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.321 | L2-Norm(final)=13.578 | 2462.5 samples/s | 38.5 steps/s
[Step=20500 Epoch=100.5] | Loss=0.04412 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.321 | L2-Norm(final)=13.596 | 5688.3 samples/s | 88.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=100.5] | Loss=0.01295 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.321 | L2-Norm(final)=13.767 | 5973.7 samples/s | 93.3 steps/s
[Step=20550 Epoch=100.8] | Loss=0.04500 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.442 | L2-Norm(final)=13.763 | 4359.8 samples/s | 68.1 steps/s
[Step=20600 Epoch=101.0] | Loss=0.04681 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.553 | L2-Norm(final)=13.742 | 4914.8 samples/s | 76.8 steps/s
[Step=20650 Epoch=101.3] | Loss=0.04494 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.630 | L2-Norm(final)=13.728 | 4825.7 samples/s | 75.4 steps/s
[Step=20700 Epoch=101.5] | Loss=0.04149 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.685 | L2-Norm(final)=13.721 | 7135.2 samples/s | 111.5 steps/s
[Step=20750 Epoch=101.8] | Loss=0.03739 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.730 | L2-Norm(final)=13.718 | 2248.5 samples/s | 35.1 steps/s
[Step=20800 Epoch=102.0] | Loss=0.03444 | Reg=0.00139 | acc=0.9688 | L2-Norm=11.769 | L2-Norm(final)=13.717 | 4855.9 samples/s | 75.9 steps/s
[Step=20850 Epoch=102.2] | Loss=0.03260 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.803 | L2-Norm(final)=13.716 | 4808.7 samples/s | 75.1 steps/s
[Step=20900 Epoch=102.5] | Loss=0.03034 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.833 | L2-Norm(final)=13.716 | 6723.2 samples/s | 105.1 steps/s
[Step=20950 Epoch=102.7] | Loss=0.02800 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.859 | L2-Norm(final)=13.717 | 2321.0 samples/s | 36.3 steps/s
[Step=21000 Epoch=103.0] | Loss=0.02619 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.881 | L2-Norm(final)=13.719 | 4757.2 samples/s | 74.3 steps/s
[Step=21050 Epoch=103.2] | Loss=0.02480 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.901 | L2-Norm(final)=13.720 | 4899.1 samples/s | 76.5 steps/s
[Step=21100 Epoch=103.5] | Loss=0.02321 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.918 | L2-Norm(final)=13.722 | 6280.0 samples/s | 98.1 steps/s
[Step=21150 Epoch=103.7] | Loss=0.02181 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.933 | L2-Norm(final)=13.724 | 2342.1 samples/s | 36.6 steps/s
[Step=21200 Epoch=104.0] | Loss=0.02084 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.947 | L2-Norm(final)=13.726 | 4749.8 samples/s | 74.2 steps/s
[Step=21250 Epoch=104.2] | Loss=0.02013 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.960 | L2-Norm(final)=13.729 | 4937.7 samples/s | 77.2 steps/s
[Step=21300 Epoch=104.5] | Loss=0.01942 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=13.730 | 5856.6 samples/s | 91.5 steps/s
[Step=21350 Epoch=104.7] | Loss=0.01859 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.983 | L2-Norm(final)=13.732 | 2398.7 samples/s | 37.5 steps/s
[Step=21400 Epoch=104.9] | Loss=0.01771 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.993 | L2-Norm(final)=13.734 | 4892.3 samples/s | 76.4 steps/s
[Step=21450 Epoch=105.2] | Loss=0.01720 | Reg=0.00144 | acc=0.9688 | L2-Norm=12.002 | L2-Norm(final)=13.736 | 4834.5 samples/s | 75.5 steps/s
[Step=21500 Epoch=105.4] | Loss=0.01667 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.011 | L2-Norm(final)=13.737 | 5588.9 samples/s | 87.3 steps/s
[Step=21550 Epoch=105.7] | Loss=0.01613 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.018 | L2-Norm(final)=13.739 | 2435.6 samples/s | 38.1 steps/s
[Step=21600 Epoch=105.9] | Loss=0.01559 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.025 | L2-Norm(final)=13.741 | 4887.0 samples/s | 76.4 steps/s
[Step=21650 Epoch=106.2] | Loss=0.01501 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.032 | L2-Norm(final)=13.742 | 4824.3 samples/s | 75.4 steps/s
[Step=21700 Epoch=106.4] | Loss=0.01460 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.038 | L2-Norm(final)=13.744 | 5340.3 samples/s | 83.4 steps/s
[Step=21750 Epoch=106.7] | Loss=0.01420 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.043 | L2-Norm(final)=13.746 | 2502.4 samples/s | 39.1 steps/s
[Step=21800 Epoch=106.9] | Loss=0.01381 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.048 | L2-Norm(final)=13.747 | 4855.0 samples/s | 75.9 steps/s
[Step=21850 Epoch=107.1] | Loss=0.01351 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.053 | L2-Norm(final)=13.749 | 4908.1 samples/s | 76.7 steps/s
[Step=21900 Epoch=107.4] | Loss=0.01321 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.058 | L2-Norm(final)=13.750 | 5069.0 samples/s | 79.2 steps/s
[Step=21950 Epoch=107.6] | Loss=0.01290 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.062 | L2-Norm(final)=13.751 | 2619.1 samples/s | 40.9 steps/s
[Step=22000 Epoch=107.9] | Loss=0.01256 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.066 | L2-Norm(final)=13.753 | 4844.3 samples/s | 75.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step22000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=133.7] | Loss=0.00149 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.320 | L2-Norm(final)=13.843 | 5508.6 samples/s | 86.1 steps/s
[Step=14050 Epoch=134.2] | Loss=0.00270 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.316 | L2-Norm(final)=13.871 | 4704.2 samples/s | 73.5 steps/s
[Step=14100 Epoch=134.6] | Loss=0.00281 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=13.908 | 8297.4 samples/s | 129.6 steps/s
[Step=14150 Epoch=135.1] | Loss=0.00319 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=13.939 | 2341.3 samples/s | 36.6 steps/s
[Step=14200 Epoch=135.6] | Loss=0.00302 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=13.971 | 7357.6 samples/s | 115.0 steps/s
[Step=14250 Epoch=136.1] | Loss=0.00292 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=14.003 | 2401.6 samples/s | 37.5 steps/s
[Step=14300 Epoch=136.6] | Loss=0.00305 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=14.033 | 6957.7 samples/s | 108.7 steps/s
[Step=14350 Epoch=137.0] | Loss=0.00302 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=14.062 | 2477.2 samples/s | 38.7 steps/s
[Step=14400 Epoch=137.5] | Loss=0.00295 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=14.090 | 6338.6 samples/s | 99.0 steps/s
[Step=14450 Epoch=138.0] | Loss=0.00293 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=14.118 | 2581.2 samples/s | 40.3 steps/s
[Step=14500 Epoch=138.5] | Loss=0.00295 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=14.146 | 5837.3 samples/s | 91.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=138.5] | Loss=0.00298 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=14.427 | 5803.9 samples/s | 90.7 steps/s
[Step=14550 Epoch=138.9] | Loss=0.00338 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.396 | L2-Norm(final)=14.429 | 4036.6 samples/s | 63.1 steps/s
[Step=14600 Epoch=139.4] | Loss=0.00276 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.457 | L2-Norm(final)=14.433 | 6790.1 samples/s | 106.1 steps/s
[Step=14650 Epoch=139.9] | Loss=0.00213 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.502 | L2-Norm(final)=14.437 | 2175.7 samples/s | 34.0 steps/s
[Step=14700 Epoch=140.4] | Loss=0.00225 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.547 | L2-Norm(final)=14.436 | 6279.3 samples/s | 98.1 steps/s
[Step=14750 Epoch=140.9] | Loss=0.00244 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.604 | L2-Norm(final)=14.428 | 2228.8 samples/s | 34.8 steps/s
[Step=14800 Epoch=141.3] | Loss=0.00209 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.659 | L2-Norm(final)=14.419 | 5779.8 samples/s | 90.3 steps/s
[Step=14850 Epoch=141.8] | Loss=0.00181 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=14.413 | 2319.5 samples/s | 36.2 steps/s
[Step=14900 Epoch=142.3] | Loss=0.00160 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.724 | L2-Norm(final)=14.409 | 5267.5 samples/s | 82.3 steps/s
[Step=14950 Epoch=142.8] | Loss=0.00142 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.742 | L2-Norm(final)=14.406 | 2396.1 samples/s | 37.4 steps/s
[Step=15000 Epoch=143.2] | Loss=0.00128 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.753 | L2-Norm(final)=14.404 | 4939.6 samples/s | 77.2 steps/s
[Step=15050 Epoch=143.7] | Loss=0.00116 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.760 | L2-Norm(final)=14.403 | 2455.5 samples/s | 38.4 steps/s
[Step=15100 Epoch=144.2] | Loss=0.00107 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.764 | L2-Norm(final)=14.401 | 4729.6 samples/s | 73.9 steps/s
[Step=15150 Epoch=144.7] | Loss=0.00098 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.764 | L2-Norm(final)=14.400 | 2531.7 samples/s | 39.6 steps/s
[Step=15200 Epoch=145.2] | Loss=0.00091 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.763 | L2-Norm(final)=14.399 | 4720.5 samples/s | 73.8 steps/s
[Step=15250 Epoch=145.6] | Loss=0.00085 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.760 | L2-Norm(final)=14.398 | 2493.7 samples/s | 39.0 steps/s
[Step=15300 Epoch=146.1] | Loss=0.00080 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.755 | L2-Norm(final)=14.398 | 4635.4 samples/s | 72.4 steps/s
[Step=15350 Epoch=146.6] | Loss=0.00075 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.750 | L2-Norm(final)=14.397 | 2562.4 samples/s | 40.0 steps/s
[Step=15400 Epoch=147.1] | Loss=0.00071 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.744 | L2-Norm(final)=14.396 | 4660.4 samples/s | 72.8 steps/s
[Step=15450 Epoch=147.5] | Loss=0.00067 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.737 | L2-Norm(final)=14.396 | 2597.6 samples/s | 40.6 steps/s
[Step=15500 Epoch=148.0] | Loss=0.00064 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.730 | L2-Norm(final)=14.396 | 4619.5 samples/s | 72.2 steps/s
[Step=15550 Epoch=148.5] | Loss=0.00061 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.722 | L2-Norm(final)=14.395 | 7317.1 samples/s | 114.3 steps/s
[Step=15600 Epoch=149.0] | Loss=0.00058 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.713 | L2-Norm(final)=14.395 | 2123.0 samples/s | 33.2 steps/s
[Step=15650 Epoch=149.4] | Loss=0.00056 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=14.395 | 6692.3 samples/s | 104.6 steps/s
[Step=15700 Epoch=149.9] | Loss=0.00053 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.695 | L2-Norm(final)=14.395 | 2166.5 samples/s | 33.9 steps/s
[Step=15750 Epoch=150.4] | Loss=0.00051 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.686 | L2-Norm(final)=14.394 | 6256.6 samples/s | 97.8 steps/s
[Step=15800 Epoch=150.9] | Loss=0.00049 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.676 | L2-Norm(final)=14.394 | 2262.4 samples/s | 35.3 steps/s
[Step=15850 Epoch=151.4] | Loss=0.00047 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.667 | L2-Norm(final)=14.394 | 5641.4 samples/s | 88.1 steps/s
[Step=15900 Epoch=151.8] | Loss=0.00046 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.657 | L2-Norm(final)=14.394 | 2303.1 samples/s | 36.0 steps/s
[Step=15950 Epoch=152.3] | Loss=0.00044 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.646 | L2-Norm(final)=14.394 | 5394.6 samples/s | 84.3 steps/s
[Step=16000 Epoch=152.8] | Loss=0.00043 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.636 | L2-Norm(final)=14.394 | 2402.9 samples/s | 37.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step16000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=95.3] | Loss=0.02759 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.320 | L2-Norm(final)=11.789 | 5650.2 samples/s | 88.3 steps/s
[Step=10050 Epoch=95.8] | Loss=0.00823 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=11.794 | 4801.8 samples/s | 75.0 steps/s
[Step=10100 Epoch=96.3] | Loss=0.00924 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.315 | L2-Norm(final)=11.812 | 8160.5 samples/s | 127.5 steps/s
[Step=10150 Epoch=96.7] | Loss=0.00967 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=11.834 | 2320.7 samples/s | 36.3 steps/s
[Step=10200 Epoch=97.2] | Loss=0.00948 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.314 | L2-Norm(final)=11.861 | 7560.1 samples/s | 118.1 steps/s
[Step=10250 Epoch=97.7] | Loss=0.00902 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.314 | L2-Norm(final)=11.890 | 2416.1 samples/s | 37.8 steps/s
[Step=10300 Epoch=98.2] | Loss=0.00914 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.314 | L2-Norm(final)=11.924 | 6807.6 samples/s | 106.4 steps/s
[Step=10350 Epoch=98.6] | Loss=0.00922 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.314 | L2-Norm(final)=11.959 | 2513.7 samples/s | 39.3 steps/s
[Step=10400 Epoch=99.1] | Loss=0.00903 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.314 | L2-Norm(final)=11.994 | 5978.0 samples/s | 93.4 steps/s
[Step=10450 Epoch=99.6] | Loss=0.00898 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.314 | L2-Norm(final)=12.032 | 2567.5 samples/s | 40.1 steps/s
[Step=10500 Epoch=100.1] | Loss=0.00885 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.314 | L2-Norm(final)=12.068 | 5685.9 samples/s | 88.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=100.1] | Loss=0.01358 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.314 | L2-Norm(final)=12.438 | 5812.1 samples/s | 90.8 steps/s
[Step=10550 Epoch=100.6] | Loss=0.00896 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.595 | L2-Norm(final)=12.431 | 4034.9 samples/s | 63.0 steps/s
[Step=10600 Epoch=101.0] | Loss=0.00627 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.784 | L2-Norm(final)=12.425 | 6792.2 samples/s | 106.1 steps/s
[Step=10650 Epoch=101.5] | Loss=0.00437 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.861 | L2-Norm(final)=12.425 | 2170.0 samples/s | 33.9 steps/s
[Step=10700 Epoch=102.0] | Loss=0.00331 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.895 | L2-Norm(final)=12.425 | 6231.2 samples/s | 97.4 steps/s
[Step=10750 Epoch=102.5] | Loss=0.00265 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.908 | L2-Norm(final)=12.425 | 2211.2 samples/s | 34.6 steps/s
[Step=10800 Epoch=102.9] | Loss=0.00222 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.912 | L2-Norm(final)=12.426 | 5790.4 samples/s | 90.5 steps/s
[Step=10850 Epoch=103.4] | Loss=0.00190 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.910 | L2-Norm(final)=12.427 | 2294.5 samples/s | 35.9 steps/s
[Step=10900 Epoch=103.9] | Loss=0.00167 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.904 | L2-Norm(final)=12.427 | 5386.3 samples/s | 84.2 steps/s
[Step=10950 Epoch=104.4] | Loss=0.00148 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.897 | L2-Norm(final)=12.428 | 2358.9 samples/s | 36.9 steps/s
[Step=11000 Epoch=104.8] | Loss=0.00133 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.887 | L2-Norm(final)=12.429 | 4972.5 samples/s | 77.7 steps/s
[Step=11050 Epoch=105.3] | Loss=0.00121 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.877 | L2-Norm(final)=12.429 | 2485.5 samples/s | 38.8 steps/s
[Step=11100 Epoch=105.8] | Loss=0.00111 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.866 | L2-Norm(final)=12.430 | 4702.6 samples/s | 73.5 steps/s
[Step=11150 Epoch=106.3] | Loss=0.00103 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.855 | L2-Norm(final)=12.430 | 2552.7 samples/s | 39.9 steps/s
[Step=11200 Epoch=106.7] | Loss=0.00095 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.843 | L2-Norm(final)=12.431 | 4613.5 samples/s | 72.1 steps/s
[Step=11250 Epoch=107.2] | Loss=0.00089 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.831 | L2-Norm(final)=12.432 | 2549.2 samples/s | 39.8 steps/s
[Step=11300 Epoch=107.7] | Loss=0.00084 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.818 | L2-Norm(final)=12.432 | 4645.6 samples/s | 72.6 steps/s
[Step=11350 Epoch=108.2] | Loss=0.00079 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.806 | L2-Norm(final)=12.433 | 2578.7 samples/s | 40.3 steps/s
[Step=11400 Epoch=108.7] | Loss=0.00074 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=12.433 | 4728.7 samples/s | 73.9 steps/s
[Step=11450 Epoch=109.1] | Loss=0.00070 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.780 | L2-Norm(final)=12.434 | 2527.6 samples/s | 39.5 steps/s
[Step=11500 Epoch=109.6] | Loss=0.00067 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.767 | L2-Norm(final)=12.434 | 4565.0 samples/s | 71.3 steps/s
[Step=11550 Epoch=110.1] | Loss=0.00064 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.754 | L2-Norm(final)=12.435 | 7462.7 samples/s | 116.6 steps/s
[Step=11600 Epoch=110.6] | Loss=0.00061 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.740 | L2-Norm(final)=12.435 | 2129.2 samples/s | 33.3 steps/s
[Step=11650 Epoch=111.0] | Loss=0.00058 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.727 | L2-Norm(final)=12.435 | 6815.8 samples/s | 106.5 steps/s
[Step=11700 Epoch=111.5] | Loss=0.00056 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.714 | L2-Norm(final)=12.436 | 2182.8 samples/s | 34.1 steps/s
[Step=11750 Epoch=112.0] | Loss=0.00054 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.700 | L2-Norm(final)=12.436 | 6246.1 samples/s | 97.6 steps/s
[Step=11800 Epoch=112.5] | Loss=0.00052 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.687 | L2-Norm(final)=12.437 | 2238.7 samples/s | 35.0 steps/s
[Step=11850 Epoch=112.9] | Loss=0.00050 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.673 | L2-Norm(final)=12.437 | 5759.0 samples/s | 90.0 steps/s
[Step=11900 Epoch=113.4] | Loss=0.00048 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.660 | L2-Norm(final)=12.438 | 2317.0 samples/s | 36.2 steps/s
[Step=11950 Epoch=113.9] | Loss=0.00046 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.646 | L2-Norm(final)=12.438 | 5362.1 samples/s | 83.8 steps/s
[Step=12000 Epoch=114.4] | Loss=0.00045 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.633 | L2-Norm(final)=12.439 | 2400.8 samples/s | 37.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.12193 | acc=0.9541 | tpr=0.9668 | fpr=0.0733 | 5560.8 samples/s | 21.7 steps/s
Avg test loss: 0.12695, Avg test acc: 0.95256, Avg tpr: 0.96544, Avg fpr: 0.07576, total FA: 591

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.11945 | acc=0.9530 | tpr=0.9731 | fpr=0.0904 | 5584.2 samples/s | 21.8 steps/s
Avg test loss: 0.12130, Avg test acc: 0.95276, Avg tpr: 0.97196, Avg fpr: 0.08948, total FA: 698

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.12360 | acc=0.9519 | tpr=0.9647 | fpr=0.0761 | 5477.2 samples/s | 21.4 steps/s
Avg test loss: 0.12892, Avg test acc: 0.95068, Avg tpr: 0.96276, Avg fpr: 0.07589, total FA: 592

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09064 | acc=0.9577 | tpr=0.9709 | fpr=0.0709 | 5669.8 samples/s | 22.1 steps/s
Avg test loss: 0.10031, Avg test acc: 0.95541, Avg tpr: 0.96963, Avg fpr: 0.07589, total FA: 592

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.12208 | acc=0.9542 | tpr=0.9709 | fpr=0.0820 | 5700.6 samples/s | 22.3 steps/s
Avg test loss: 0.12699, Avg test acc: 0.95308, Avg tpr: 0.96888, Avg fpr: 0.08166, total FA: 637

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.85816 | acc=0.3085 | tpr=0.0146 | fpr=0.0533 | 5834.8 samples/s | 22.8 steps/s
Avg test loss: 4.86362, Avg test acc: 0.30772, Avg tpr: 0.01475, Avg fpr: 0.04794, total FA: 374

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.61288 | acc=0.2941 | tpr=0.0064 | fpr=0.0813 | 5823.7 samples/s | 22.7 steps/s
Avg test loss: 4.63156, Avg test acc: 0.29141, Avg tpr: 0.00606, Avg fpr: 0.08102, total FA: 632

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.52977 | acc=0.2860 | tpr=0.0176 | fpr=0.1311 | 5725.6 samples/s | 22.4 steps/s
Avg test loss: 5.52678, Avg test acc: 0.28568, Avg tpr: 0.01789, Avg fpr: 0.12537, total FA: 978

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.71897 | acc=0.2923 | tpr=0.0169 | fpr=0.1095 | 5840.5 samples/s | 22.8 steps/s
Avg test loss: 4.72579, Avg test acc: 0.29161, Avg tpr: 0.01708, Avg fpr: 0.10460, total FA: 816

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.09458 | acc=0.2980 | tpr=0.0144 | fpr=0.0862 | 5817.6 samples/s | 22.7 steps/s
Avg test loss: 5.11129, Avg test acc: 0.29578, Avg tpr: 0.01515, Avg fpr: 0.08704, total FA: 679

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.83451 | acc=0.1451 | tpr=0.3982 | fpr=0.8595 | 5616.9 samples/s | 21.9 steps/s
[Step= 100] | Loss=6.76889 | acc=0.1431 | tpr=0.3625 | fpr=0.8610 | 7621.5 samples/s | 29.8 steps/s
[Step= 150] | Loss=6.77737 | acc=0.1417 | tpr=0.3689 | fpr=0.8625 | 8070.2 samples/s | 31.5 steps/s
[Step= 200] | Loss=6.77291 | acc=0.1421 | tpr=0.3617 | fpr=0.8619 | 8116.1 samples/s | 31.7 steps/s
[Step= 250] | Loss=6.77989 | acc=0.1422 | tpr=0.3537 | fpr=0.8617 | 8296.1 samples/s | 32.4 steps/s
[Step= 300] | Loss=6.77807 | acc=0.1420 | tpr=0.3535 | fpr=0.8618 | 7903.7 samples/s | 30.9 steps/s
[Step= 350] | Loss=6.77994 | acc=0.1420 | tpr=0.3388 | fpr=0.8616 | 7345.9 samples/s | 28.7 steps/s
[Step= 400] | Loss=6.77524 | acc=0.1425 | tpr=0.3375 | fpr=0.8610 | 8189.6 samples/s | 32.0 steps/s
[Step= 450] | Loss=6.77857 | acc=0.1424 | tpr=0.3354 | fpr=0.8611 | 8245.6 samples/s | 32.2 steps/s
[Step= 500] | Loss=6.78000 | acc=0.1422 | tpr=0.3348 | fpr=0.8613 | 8525.5 samples/s | 33.3 steps/s
[Step= 550] | Loss=6.77697 | acc=0.1420 | tpr=0.3311 | fpr=0.8614 | 10368.5 samples/s | 40.5 steps/s
Avg test loss: 6.77740, Avg test acc: 0.14192, Avg tpr: 0.33082, Avg fpr: 0.86151, total FA: 119619

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.82946 | acc=0.1329 | tpr=0.2876 | fpr=0.8699 | 5653.9 samples/s | 22.1 steps/s
[Step= 100] | Loss=5.79658 | acc=0.1345 | tpr=0.2431 | fpr=0.8676 | 7549.2 samples/s | 29.5 steps/s
[Step= 150] | Loss=5.80012 | acc=0.1332 | tpr=0.2320 | fpr=0.8686 | 8581.9 samples/s | 33.5 steps/s
[Step= 200] | Loss=5.79714 | acc=0.1334 | tpr=0.2306 | fpr=0.8684 | 8478.6 samples/s | 33.1 steps/s
[Step= 250] | Loss=5.79513 | acc=0.1335 | tpr=0.2341 | fpr=0.8683 | 8277.5 samples/s | 32.3 steps/s
[Step= 300] | Loss=5.79543 | acc=0.1335 | tpr=0.2320 | fpr=0.8683 | 7319.7 samples/s | 28.6 steps/s
[Step= 350] | Loss=5.79624 | acc=0.1330 | tpr=0.2198 | fpr=0.8685 | 8560.2 samples/s | 33.4 steps/s
[Step= 400] | Loss=5.79339 | acc=0.1335 | tpr=0.2210 | fpr=0.8681 | 7954.4 samples/s | 31.1 steps/s
[Step= 450] | Loss=5.79592 | acc=0.1332 | tpr=0.2181 | fpr=0.8684 | 7922.7 samples/s | 30.9 steps/s
[Step= 500] | Loss=5.79776 | acc=0.1331 | tpr=0.2194 | fpr=0.8685 | 8090.5 samples/s | 31.6 steps/s
[Step= 550] | Loss=5.79859 | acc=0.1330 | tpr=0.2161 | fpr=0.8685 | 10245.8 samples/s | 40.0 steps/s
Avg test loss: 5.79896, Avg test acc: 0.13281, Avg tpr: 0.21712, Avg fpr: 0.86872, total FA: 120620

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.46532 | acc=0.1402 | tpr=0.2434 | fpr=0.8616 | 5832.9 samples/s | 22.8 steps/s
[Step= 100] | Loss=6.41055 | acc=0.1407 | tpr=0.1962 | fpr=0.8603 | 7602.6 samples/s | 29.7 steps/s
[Step= 150] | Loss=6.41624 | acc=0.1401 | tpr=0.1873 | fpr=0.8608 | 8421.8 samples/s | 32.9 steps/s
[Step= 200] | Loss=6.40873 | acc=0.1400 | tpr=0.1770 | fpr=0.8607 | 7909.6 samples/s | 30.9 steps/s
[Step= 250] | Loss=6.40425 | acc=0.1402 | tpr=0.1755 | fpr=0.8605 | 8085.5 samples/s | 31.6 steps/s
[Step= 300] | Loss=6.40856 | acc=0.1392 | tpr=0.1782 | fpr=0.8616 | 7422.9 samples/s | 29.0 steps/s
[Step= 350] | Loss=6.41425 | acc=0.1384 | tpr=0.1722 | fpr=0.8622 | 8861.8 samples/s | 34.6 steps/s
[Step= 400] | Loss=6.41406 | acc=0.1387 | tpr=0.1772 | fpr=0.8620 | 8393.3 samples/s | 32.8 steps/s
[Step= 450] | Loss=6.41527 | acc=0.1385 | tpr=0.1719 | fpr=0.8621 | 7579.5 samples/s | 29.6 steps/s
[Step= 500] | Loss=6.41435 | acc=0.1382 | tpr=0.1709 | fpr=0.8624 | 8675.5 samples/s | 33.9 steps/s
[Step= 550] | Loss=6.41266 | acc=0.1384 | tpr=0.1695 | fpr=0.8621 | 9022.8 samples/s | 35.2 steps/s
Avg test loss: 6.41264, Avg test acc: 0.13829, Avg tpr: 0.16957, Avg fpr: 0.86228, total FA: 119726

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.93569 | acc=0.1527 | tpr=0.2743 | fpr=0.8495 | 5781.6 samples/s | 22.6 steps/s
[Step= 100] | Loss=4.91365 | acc=0.1523 | tpr=0.2324 | fpr=0.8492 | 8203.8 samples/s | 32.0 steps/s
[Step= 150] | Loss=4.91912 | acc=0.1509 | tpr=0.2291 | fpr=0.8505 | 7779.1 samples/s | 30.4 steps/s
[Step= 200] | Loss=4.91153 | acc=0.1509 | tpr=0.2273 | fpr=0.8505 | 7694.2 samples/s | 30.1 steps/s
[Step= 250] | Loss=4.91189 | acc=0.1514 | tpr=0.2271 | fpr=0.8500 | 8733.2 samples/s | 34.1 steps/s
[Step= 300] | Loss=4.91750 | acc=0.1505 | tpr=0.2262 | fpr=0.8509 | 8070.9 samples/s | 31.5 steps/s
[Step= 350] | Loss=4.91761 | acc=0.1498 | tpr=0.2148 | fpr=0.8514 | 7737.4 samples/s | 30.2 steps/s
[Step= 400] | Loss=4.91399 | acc=0.1502 | tpr=0.2161 | fpr=0.8510 | 7994.4 samples/s | 31.2 steps/s
[Step= 450] | Loss=4.91342 | acc=0.1502 | tpr=0.2157 | fpr=0.8510 | 8562.3 samples/s | 33.4 steps/s
[Step= 500] | Loss=4.91547 | acc=0.1500 | tpr=0.2154 | fpr=0.8512 | 8372.0 samples/s | 32.7 steps/s
[Step= 550] | Loss=4.91495 | acc=0.1501 | tpr=0.2153 | fpr=0.8510 | 9026.6 samples/s | 35.3 steps/s
Avg test loss: 4.91569, Avg test acc: 0.15005, Avg tpr: 0.21553, Avg fpr: 0.85114, total FA: 118179

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=7.47700 | acc=0.1254 | tpr=0.2743 | fpr=0.8773 | 5611.3 samples/s | 21.9 steps/s
[Step= 100] | Loss=7.42434 | acc=0.1253 | tpr=0.2623 | fpr=0.8773 | 8302.8 samples/s | 32.4 steps/s
[Step= 150] | Loss=7.43250 | acc=0.1252 | tpr=0.2550 | fpr=0.8772 | 7579.3 samples/s | 29.6 steps/s
[Step= 200] | Loss=7.41984 | acc=0.1250 | tpr=0.2459 | fpr=0.8772 | 8173.3 samples/s | 31.9 steps/s
[Step= 250] | Loss=7.42792 | acc=0.1254 | tpr=0.2428 | fpr=0.8767 | 7826.7 samples/s | 30.6 steps/s
[Step= 300] | Loss=7.43069 | acc=0.1252 | tpr=0.2436 | fpr=0.8769 | 8865.3 samples/s | 34.6 steps/s
[Step= 350] | Loss=7.43635 | acc=0.1247 | tpr=0.2354 | fpr=0.8773 | 7963.4 samples/s | 31.1 steps/s
[Step= 400] | Loss=7.43390 | acc=0.1248 | tpr=0.2352 | fpr=0.8773 | 8131.8 samples/s | 31.8 steps/s
[Step= 450] | Loss=7.43280 | acc=0.1250 | tpr=0.2342 | fpr=0.8770 | 8091.7 samples/s | 31.6 steps/s
[Step= 500] | Loss=7.43597 | acc=0.1246 | tpr=0.2322 | fpr=0.8774 | 7108.8 samples/s | 27.8 steps/s
[Step= 550] | Loss=7.43276 | acc=0.1245 | tpr=0.2312 | fpr=0.8774 | 11134.6 samples/s | 43.5 steps/s
Avg test loss: 7.43193, Avg test acc: 0.12440, Avg tpr: 0.23177, Avg fpr: 0.87755, total FA: 121846

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13750 | acc=0.9763 | tpr=0.8938 | fpr=0.0222 | 5699.9 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.14098 | acc=0.9763 | tpr=0.9232 | fpr=0.0227 | 8160.3 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.14670 | acc=0.9756 | tpr=0.9236 | fpr=0.0234 | 7694.9 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.14742 | acc=0.9760 | tpr=0.9279 | fpr=0.0231 | 8457.2 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.14595 | acc=0.9761 | tpr=0.9214 | fpr=0.0229 | 7027.3 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.14783 | acc=0.9759 | tpr=0.9200 | fpr=0.0231 | 8399.2 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.14912 | acc=0.9759 | tpr=0.9192 | fpr=0.0231 | 7813.5 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.15057 | acc=0.9757 | tpr=0.9163 | fpr=0.0233 | 8232.4 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.15291 | acc=0.9754 | tpr=0.9148 | fpr=0.0235 | 8070.7 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.15229 | acc=0.9755 | tpr=0.9185 | fpr=0.0234 | 8363.4 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.15136 | acc=0.9757 | tpr=0.9168 | fpr=0.0232 | 9568.9 samples/s | 37.4 steps/s
Avg test loss: 0.15109, Avg test acc: 0.97572, Avg tpr: 0.91680, Avg fpr: 0.02321, total FA: 3223

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09454 | acc=0.9812 | tpr=0.8717 | fpr=0.0169 | 5603.9 samples/s | 21.9 steps/s
[Step= 100] | Loss=0.09749 | acc=0.9809 | tpr=0.8763 | fpr=0.0172 | 8407.4 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.10090 | acc=0.9804 | tpr=0.8919 | fpr=0.0180 | 7775.2 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.10234 | acc=0.9805 | tpr=0.8929 | fpr=0.0179 | 8003.0 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.10236 | acc=0.9806 | tpr=0.8926 | fpr=0.0178 | 8470.1 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.10340 | acc=0.9805 | tpr=0.8931 | fpr=0.0179 | 8298.6 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.10387 | acc=0.9804 | tpr=0.8961 | fpr=0.0180 | 8257.8 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.10469 | acc=0.9803 | tpr=0.8928 | fpr=0.0182 | 7761.5 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.10591 | acc=0.9801 | tpr=0.8900 | fpr=0.0182 | 7601.8 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.10498 | acc=0.9803 | tpr=0.8930 | fpr=0.0181 | 8486.3 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.10392 | acc=0.9804 | tpr=0.8930 | fpr=0.0180 | 9597.9 samples/s | 37.5 steps/s
Avg test loss: 0.10372, Avg test acc: 0.98038, Avg tpr: 0.89184, Avg fpr: 0.01801, total FA: 2501

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10566 | acc=0.9791 | tpr=0.9381 | fpr=0.0201 | 5817.9 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.11036 | acc=0.9784 | tpr=0.9467 | fpr=0.0210 | 7523.5 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.11586 | acc=0.9774 | tpr=0.9467 | fpr=0.0221 | 7975.0 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.11770 | acc=0.9775 | tpr=0.9475 | fpr=0.0219 | 8331.5 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.11845 | acc=0.9774 | tpr=0.9467 | fpr=0.0221 | 8568.0 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.12037 | acc=0.9773 | tpr=0.9389 | fpr=0.0220 | 7337.4 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.12024 | acc=0.9773 | tpr=0.9393 | fpr=0.0220 | 7683.7 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.12101 | acc=0.9770 | tpr=0.9354 | fpr=0.0222 | 8809.3 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.12252 | acc=0.9768 | tpr=0.9314 | fpr=0.0223 | 8235.9 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.12207 | acc=0.9769 | tpr=0.9330 | fpr=0.0223 | 8134.7 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.12122 | acc=0.9770 | tpr=0.9339 | fpr=0.0222 | 9783.4 samples/s | 38.2 steps/s
Avg test loss: 0.12106, Avg test acc: 0.97703, Avg tpr: 0.93344, Avg fpr: 0.02218, total FA: 3080

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09092 | acc=0.9827 | tpr=0.9071 | fpr=0.0159 | 5843.9 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.09442 | acc=0.9822 | tpr=0.9147 | fpr=0.0165 | 7247.2 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.09885 | acc=0.9814 | tpr=0.9207 | fpr=0.0175 | 7953.3 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.10085 | acc=0.9811 | tpr=0.9180 | fpr=0.0177 | 8062.3 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.10080 | acc=0.9812 | tpr=0.9127 | fpr=0.0176 | 8478.1 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.10235 | acc=0.9810 | tpr=0.9135 | fpr=0.0177 | 7828.4 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.10260 | acc=0.9810 | tpr=0.9142 | fpr=0.0178 | 8022.2 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.10309 | acc=0.9809 | tpr=0.9130 | fpr=0.0179 | 8383.7 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.10476 | acc=0.9807 | tpr=0.9119 | fpr=0.0181 | 8220.9 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.10452 | acc=0.9807 | tpr=0.9145 | fpr=0.0181 | 7473.4 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.10397 | acc=0.9807 | tpr=0.9144 | fpr=0.0181 | 11024.0 samples/s | 43.1 steps/s
Avg test loss: 0.10375, Avg test acc: 0.98071, Avg tpr: 0.91403, Avg fpr: 0.01808, total FA: 2510

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12392 | acc=0.9780 | tpr=0.8717 | fpr=0.0200 | 5757.9 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.12622 | acc=0.9789 | tpr=0.9104 | fpr=0.0199 | 8111.7 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.13326 | acc=0.9778 | tpr=0.9179 | fpr=0.0211 | 8007.1 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.13523 | acc=0.9777 | tpr=0.9191 | fpr=0.0212 | 8031.3 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.13382 | acc=0.9777 | tpr=0.9188 | fpr=0.0212 | 7910.8 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.13565 | acc=0.9776 | tpr=0.9215 | fpr=0.0214 | 7633.1 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.13601 | acc=0.9776 | tpr=0.9249 | fpr=0.0215 | 7878.5 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.13708 | acc=0.9773 | tpr=0.9212 | fpr=0.0217 | 7925.5 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.13975 | acc=0.9769 | tpr=0.9192 | fpr=0.0220 | 8037.9 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.13885 | acc=0.9770 | tpr=0.9211 | fpr=0.0220 | 8213.7 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.13774 | acc=0.9772 | tpr=0.9220 | fpr=0.0218 | 10860.2 samples/s | 42.4 steps/s
Avg test loss: 0.13748, Avg test acc: 0.97717, Avg tpr: 0.92155, Avg fpr: 0.02182, total FA: 3029

server round 17/50

clients selected: [1 3 4 5 6]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=24001 Epoch=117.1] | Loss=0.01943 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.265 | L2-Norm(final)=13.856 | 6037.0 samples/s | 94.3 steps/s
[Step=24050 Epoch=117.4] | Loss=0.05518 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.268 | L2-Norm(final)=13.866 | 4838.8 samples/s | 75.6 steps/s
[Step=24100 Epoch=117.6] | Loss=0.05823 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.269 | L2-Norm(final)=13.851 | 5659.9 samples/s | 88.4 steps/s
[Step=24150 Epoch=117.8] | Loss=0.05730 | Reg=0.00127 | acc=0.9531 | L2-Norm=11.269 | L2-Norm(final)=13.841 | 5582.4 samples/s | 87.2 steps/s
[Step=24200 Epoch=118.1] | Loss=0.05724 | Reg=0.00127 | acc=0.9531 | L2-Norm=11.269 | L2-Norm(final)=13.836 | 8754.1 samples/s | 136.8 steps/s
[Step=24250 Epoch=118.3] | Loss=0.05681 | Reg=0.00127 | acc=0.9531 | L2-Norm=11.269 | L2-Norm(final)=13.834 | 2402.6 samples/s | 37.5 steps/s
[Step=24300 Epoch=118.6] | Loss=0.05546 | Reg=0.00127 | acc=0.9375 | L2-Norm=11.269 | L2-Norm(final)=13.832 | 5621.3 samples/s | 87.8 steps/s
[Step=24350 Epoch=118.8] | Loss=0.05464 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.270 | L2-Norm(final)=13.834 | 5607.2 samples/s | 87.6 steps/s
[Step=24400 Epoch=119.1] | Loss=0.05410 | Reg=0.00127 | acc=0.9062 | L2-Norm=11.270 | L2-Norm(final)=13.838 | 7922.2 samples/s | 123.8 steps/s
[Step=24450 Epoch=119.3] | Loss=0.05350 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.270 | L2-Norm(final)=13.844 | 2471.2 samples/s | 38.6 steps/s
[Step=24500 Epoch=119.5] | Loss=0.05321 | Reg=0.00127 | acc=0.9219 | L2-Norm=11.270 | L2-Norm(final)=13.851 | 5618.4 samples/s | 87.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=119.6] | Loss=0.05527 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.270 | L2-Norm(final)=13.921 | 5792.0 samples/s | 90.5 steps/s
[Step=24550 Epoch=119.8] | Loss=0.05079 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.388 | L2-Norm(final)=13.911 | 4404.5 samples/s | 68.8 steps/s
[Step=24600 Epoch=120.0] | Loss=0.04693 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.496 | L2-Norm(final)=13.898 | 4837.4 samples/s | 75.6 steps/s
[Step=24650 Epoch=120.3] | Loss=0.04971 | Reg=0.00134 | acc=0.9375 | L2-Norm=11.576 | L2-Norm(final)=13.891 | 4837.9 samples/s | 75.6 steps/s
[Step=24700 Epoch=120.5] | Loss=0.04431 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.646 | L2-Norm(final)=13.883 | 7013.4 samples/s | 109.6 steps/s
[Step=24750 Epoch=120.8] | Loss=0.03914 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.700 | L2-Norm(final)=13.882 | 2262.4 samples/s | 35.4 steps/s
[Step=24800 Epoch=121.0] | Loss=0.03518 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.742 | L2-Norm(final)=13.881 | 4786.1 samples/s | 74.8 steps/s
[Step=24850 Epoch=121.3] | Loss=0.03212 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.776 | L2-Norm(final)=13.883 | 4969.0 samples/s | 77.6 steps/s
[Step=24900 Epoch=121.5] | Loss=0.03015 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.806 | L2-Norm(final)=13.884 | 6288.4 samples/s | 98.3 steps/s
[Step=24950 Epoch=121.7] | Loss=0.02814 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.833 | L2-Norm(final)=13.886 | 2322.9 samples/s | 36.3 steps/s
[Step=25000 Epoch=122.0] | Loss=0.02657 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.858 | L2-Norm(final)=13.888 | 4871.9 samples/s | 76.1 steps/s
[Step=25050 Epoch=122.2] | Loss=0.02519 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.880 | L2-Norm(final)=13.890 | 4834.9 samples/s | 75.5 steps/s
[Step=25100 Epoch=122.5] | Loss=0.02421 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.901 | L2-Norm(final)=13.893 | 6021.8 samples/s | 94.1 steps/s
[Step=25150 Epoch=122.7] | Loss=0.02311 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.920 | L2-Norm(final)=13.894 | 2394.8 samples/s | 37.4 steps/s
[Step=25200 Epoch=123.0] | Loss=0.02201 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.937 | L2-Norm(final)=13.897 | 4899.5 samples/s | 76.6 steps/s
[Step=25250 Epoch=123.2] | Loss=0.02123 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.952 | L2-Norm(final)=13.899 | 4902.4 samples/s | 76.6 steps/s
[Step=25300 Epoch=123.5] | Loss=0.02032 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.967 | L2-Norm(final)=13.901 | 5568.1 samples/s | 87.0 steps/s
[Step=25350 Epoch=123.7] | Loss=0.01956 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.981 | L2-Norm(final)=13.904 | 2461.5 samples/s | 38.5 steps/s
[Step=25400 Epoch=123.9] | Loss=0.01873 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.994 | L2-Norm(final)=13.906 | 4838.4 samples/s | 75.6 steps/s
[Step=25450 Epoch=124.2] | Loss=0.01820 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.005 | L2-Norm(final)=13.908 | 4870.5 samples/s | 76.1 steps/s
[Step=25500 Epoch=124.4] | Loss=0.01759 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.016 | L2-Norm(final)=13.910 | 5230.6 samples/s | 81.7 steps/s
[Step=25550 Epoch=124.7] | Loss=0.01708 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.025 | L2-Norm(final)=13.912 | 2561.6 samples/s | 40.0 steps/s
[Step=25600 Epoch=124.9] | Loss=0.01648 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.035 | L2-Norm(final)=13.914 | 4829.3 samples/s | 75.5 steps/s
[Step=25650 Epoch=125.2] | Loss=0.01602 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.043 | L2-Norm(final)=13.917 | 4939.4 samples/s | 77.2 steps/s
[Step=25700 Epoch=125.4] | Loss=0.01557 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.051 | L2-Norm(final)=13.919 | 4843.4 samples/s | 75.7 steps/s
[Step=25750 Epoch=125.6] | Loss=0.01517 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.058 | L2-Norm(final)=13.921 | 2605.9 samples/s | 40.7 steps/s
[Step=25800 Epoch=125.9] | Loss=0.01474 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.064 | L2-Norm(final)=13.923 | 4896.5 samples/s | 76.5 steps/s
[Step=25850 Epoch=126.1] | Loss=0.01432 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=13.925 | 4875.6 samples/s | 76.2 steps/s
[Step=25900 Epoch=126.4] | Loss=0.01399 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.076 | L2-Norm(final)=13.927 | 4825.5 samples/s | 75.4 steps/s
[Step=25950 Epoch=126.6] | Loss=0.01369 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.081 | L2-Norm(final)=13.929 | 2604.2 samples/s | 40.7 steps/s
[Step=26000 Epoch=126.9] | Loss=0.01335 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.086 | L2-Norm(final)=13.931 | 4862.1 samples/s | 76.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step26000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=87.8] | Loss=0.04262 | Reg=0.00127 | acc=0.9531 | L2-Norm=11.265 | L2-Norm(final)=13.510 | 5853.4 samples/s | 91.5 steps/s
[Step=18050 Epoch=88.0] | Loss=0.05224 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.267 | L2-Norm(final)=13.537 | 4811.9 samples/s | 75.2 steps/s
[Step=18100 Epoch=88.3] | Loss=0.04839 | Reg=0.00127 | acc=0.9531 | L2-Norm=11.267 | L2-Norm(final)=13.567 | 5703.1 samples/s | 89.1 steps/s
[Step=18150 Epoch=88.5] | Loss=0.04808 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.267 | L2-Norm(final)=13.596 | 5636.9 samples/s | 88.1 steps/s
[Step=18200 Epoch=88.8] | Loss=0.04721 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.267 | L2-Norm(final)=13.622 | 8538.9 samples/s | 133.4 steps/s
[Step=18250 Epoch=89.0] | Loss=0.04727 | Reg=0.00127 | acc=0.9062 | L2-Norm=11.267 | L2-Norm(final)=13.647 | 2453.4 samples/s | 38.3 steps/s
[Step=18300 Epoch=89.2] | Loss=0.04645 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.267 | L2-Norm(final)=13.667 | 5623.4 samples/s | 87.9 steps/s
[Step=18350 Epoch=89.5] | Loss=0.04601 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.267 | L2-Norm(final)=13.687 | 5669.1 samples/s | 88.6 steps/s
[Step=18400 Epoch=89.7] | Loss=0.04603 | Reg=0.00127 | acc=0.9062 | L2-Norm=11.267 | L2-Norm(final)=13.707 | 7734.0 samples/s | 120.8 steps/s
[Step=18450 Epoch=90.0] | Loss=0.04538 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.267 | L2-Norm(final)=13.726 | 2518.2 samples/s | 39.3 steps/s
[Step=18500 Epoch=90.2] | Loss=0.04505 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.267 | L2-Norm(final)=13.746 | 5633.0 samples/s | 88.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=90.2] | Loss=0.01879 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.267 | L2-Norm(final)=13.945 | 6309.1 samples/s | 98.6 steps/s
[Step=18550 Epoch=90.5] | Loss=0.04378 | Reg=0.00129 | acc=0.9375 | L2-Norm=11.373 | L2-Norm(final)=13.948 | 4136.8 samples/s | 64.6 steps/s
[Step=18600 Epoch=90.7] | Loss=0.04908 | Reg=0.00132 | acc=0.9062 | L2-Norm=11.483 | L2-Norm(final)=13.918 | 4877.3 samples/s | 76.2 steps/s
[Step=18650 Epoch=90.9] | Loss=0.04792 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.567 | L2-Norm(final)=13.900 | 4909.4 samples/s | 76.7 steps/s
[Step=18700 Epoch=91.2] | Loss=0.04338 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.625 | L2-Norm(final)=13.890 | 6904.3 samples/s | 107.9 steps/s
[Step=18750 Epoch=91.4] | Loss=0.03831 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.669 | L2-Norm(final)=13.886 | 2267.0 samples/s | 35.4 steps/s
[Step=18800 Epoch=91.7] | Loss=0.03479 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.704 | L2-Norm(final)=13.884 | 4897.4 samples/s | 76.5 steps/s
[Step=18850 Epoch=91.9] | Loss=0.03203 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.732 | L2-Norm(final)=13.883 | 4795.2 samples/s | 74.9 steps/s
[Step=18900 Epoch=92.2] | Loss=0.03023 | Reg=0.00138 | acc=0.9375 | L2-Norm=11.758 | L2-Norm(final)=13.884 | 6344.3 samples/s | 99.1 steps/s
[Step=18950 Epoch=92.4] | Loss=0.02812 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.782 | L2-Norm(final)=13.884 | 2331.7 samples/s | 36.4 steps/s
[Step=19000 Epoch=92.7] | Loss=0.02650 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.803 | L2-Norm(final)=13.885 | 4872.0 samples/s | 76.1 steps/s
[Step=19050 Epoch=92.9] | Loss=0.02505 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.822 | L2-Norm(final)=13.886 | 4837.2 samples/s | 75.6 steps/s
[Step=19100 Epoch=93.1] | Loss=0.02399 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.838 | L2-Norm(final)=13.887 | 5844.5 samples/s | 91.3 steps/s
[Step=19150 Epoch=93.4] | Loss=0.02280 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.852 | L2-Norm(final)=13.887 | 2421.9 samples/s | 37.8 steps/s
[Step=19200 Epoch=93.6] | Loss=0.02162 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.866 | L2-Norm(final)=13.888 | 4876.2 samples/s | 76.2 steps/s
[Step=19250 Epoch=93.9] | Loss=0.02068 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.877 | L2-Norm(final)=13.890 | 4839.0 samples/s | 75.6 steps/s
[Step=19300 Epoch=94.1] | Loss=0.01991 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.888 | L2-Norm(final)=13.891 | 5380.8 samples/s | 84.1 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01919 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=13.893 | 2519.0 samples/s | 39.4 steps/s
[Step=19400 Epoch=94.6] | Loss=0.01847 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.907 | L2-Norm(final)=13.894 | 4741.7 samples/s | 74.1 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01772 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.915 | L2-Norm(final)=13.896 | 4872.3 samples/s | 76.1 steps/s
[Step=19500 Epoch=95.1] | Loss=0.01713 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.923 | L2-Norm(final)=13.897 | 5013.9 samples/s | 78.3 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01649 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.930 | L2-Norm(final)=13.899 | 2584.4 samples/s | 40.4 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01600 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.936 | L2-Norm(final)=13.900 | 4862.1 samples/s | 76.0 steps/s
[Step=19650 Epoch=95.8] | Loss=0.01562 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.942 | L2-Norm(final)=13.902 | 4844.8 samples/s | 75.7 steps/s
[Step=19700 Epoch=96.1] | Loss=0.01516 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.948 | L2-Norm(final)=13.903 | 4926.3 samples/s | 77.0 steps/s
[Step=19750 Epoch=96.3] | Loss=0.01530 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.953 | L2-Norm(final)=13.904 | 2637.5 samples/s | 41.2 steps/s
[Step=19800 Epoch=96.6] | Loss=0.01555 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.964 | L2-Norm(final)=13.904 | 4814.9 samples/s | 75.2 steps/s
[Step=19850 Epoch=96.8] | Loss=0.01577 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.977 | L2-Norm(final)=13.904 | 4872.1 samples/s | 76.1 steps/s
[Step=19900 Epoch=97.0] | Loss=0.01568 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.990 | L2-Norm(final)=13.905 | 4874.6 samples/s | 76.2 steps/s
[Step=19950 Epoch=97.3] | Loss=0.01550 | Reg=0.00144 | acc=0.9688 | L2-Norm=12.003 | L2-Norm(final)=13.905 | 2626.7 samples/s | 41.0 steps/s
[Step=20000 Epoch=97.5] | Loss=0.01522 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.016 | L2-Norm(final)=13.905 | 4849.9 samples/s | 75.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step20000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=107.9] | Loss=0.01939 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.265 | L2-Norm(final)=13.795 | 5823.1 samples/s | 91.0 steps/s
[Step=22050 Epoch=108.1] | Loss=0.03659 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.265 | L2-Norm(final)=13.818 | 4867.1 samples/s | 76.0 steps/s
[Step=22100 Epoch=108.4] | Loss=0.03798 | Reg=0.00127 | acc=0.9531 | L2-Norm=11.265 | L2-Norm(final)=13.843 | 5606.3 samples/s | 87.6 steps/s
[Step=22150 Epoch=108.6] | Loss=0.03845 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.265 | L2-Norm(final)=13.863 | 5633.4 samples/s | 88.0 steps/s
[Step=22200 Epoch=108.9] | Loss=0.04030 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.265 | L2-Norm(final)=13.883 | 8920.5 samples/s | 139.4 steps/s
[Step=22250 Epoch=109.1] | Loss=0.04037 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.265 | L2-Norm(final)=13.898 | 2408.9 samples/s | 37.6 steps/s
[Step=22300 Epoch=109.4] | Loss=0.04097 | Reg=0.00127 | acc=0.9531 | L2-Norm=11.265 | L2-Norm(final)=13.913 | 5621.5 samples/s | 87.8 steps/s
[Step=22350 Epoch=109.6] | Loss=0.04057 | Reg=0.00127 | acc=0.9375 | L2-Norm=11.265 | L2-Norm(final)=13.927 | 5601.0 samples/s | 87.5 steps/s
[Step=22400 Epoch=109.8] | Loss=0.04025 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.265 | L2-Norm(final)=13.944 | 8381.1 samples/s | 131.0 steps/s
[Step=22450 Epoch=110.1] | Loss=0.04091 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.265 | L2-Norm(final)=13.961 | 2475.9 samples/s | 38.7 steps/s
[Step=22500 Epoch=110.3] | Loss=0.04049 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.265 | L2-Norm(final)=13.978 | 5675.4 samples/s | 88.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=110.3] | Loss=0.04412 | Reg=0.00127 | acc=0.9531 | L2-Norm=11.265 | L2-Norm(final)=14.159 | 6089.4 samples/s | 95.1 steps/s
[Step=22550 Epoch=110.6] | Loss=0.04742 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.389 | L2-Norm(final)=14.157 | 4255.7 samples/s | 66.5 steps/s
[Step=22600 Epoch=110.8] | Loss=0.04899 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.502 | L2-Norm(final)=14.135 | 4912.4 samples/s | 76.8 steps/s
[Step=22650 Epoch=111.1] | Loss=0.04553 | Reg=0.00134 | acc=0.9531 | L2-Norm=11.581 | L2-Norm(final)=14.123 | 4811.3 samples/s | 75.2 steps/s
[Step=22700 Epoch=111.3] | Loss=0.04273 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.640 | L2-Norm(final)=14.116 | 7075.9 samples/s | 110.6 steps/s
[Step=22750 Epoch=111.6] | Loss=0.03819 | Reg=0.00137 | acc=0.9531 | L2-Norm=11.689 | L2-Norm(final)=14.112 | 2235.7 samples/s | 34.9 steps/s
[Step=22800 Epoch=111.8] | Loss=0.03543 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.729 | L2-Norm(final)=14.111 | 4850.8 samples/s | 75.8 steps/s
[Step=22850 Epoch=112.1] | Loss=0.03282 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.762 | L2-Norm(final)=14.109 | 4895.3 samples/s | 76.5 steps/s
[Step=22900 Epoch=112.3] | Loss=0.03053 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.792 | L2-Norm(final)=14.109 | 6630.3 samples/s | 103.6 steps/s
[Step=22950 Epoch=112.5] | Loss=0.02873 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.820 | L2-Norm(final)=14.109 | 2286.3 samples/s | 35.7 steps/s
[Step=23000 Epoch=112.8] | Loss=0.02678 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.844 | L2-Norm(final)=14.110 | 4891.0 samples/s | 76.4 steps/s
[Step=23050 Epoch=113.0] | Loss=0.02538 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.866 | L2-Norm(final)=14.111 | 4810.2 samples/s | 75.2 steps/s
[Step=23100 Epoch=113.3] | Loss=0.02434 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.885 | L2-Norm(final)=14.112 | 6293.3 samples/s | 98.3 steps/s
[Step=23150 Epoch=113.5] | Loss=0.02313 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=14.113 | 2354.9 samples/s | 36.8 steps/s
[Step=23200 Epoch=113.8] | Loss=0.02234 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.918 | L2-Norm(final)=14.115 | 4770.4 samples/s | 74.5 steps/s
[Step=23250 Epoch=114.0] | Loss=0.02134 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.932 | L2-Norm(final)=14.116 | 4919.6 samples/s | 76.9 steps/s
[Step=23300 Epoch=114.3] | Loss=0.02035 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.945 | L2-Norm(final)=14.117 | 5816.1 samples/s | 90.9 steps/s
[Step=23350 Epoch=114.5] | Loss=0.01967 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.957 | L2-Norm(final)=14.118 | 2414.2 samples/s | 37.7 steps/s
[Step=23400 Epoch=114.7] | Loss=0.01893 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.969 | L2-Norm(final)=14.119 | 4806.3 samples/s | 75.1 steps/s
[Step=23450 Epoch=115.0] | Loss=0.01818 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.979 | L2-Norm(final)=14.121 | 4884.6 samples/s | 76.3 steps/s
[Step=23500 Epoch=115.2] | Loss=0.01754 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.989 | L2-Norm(final)=14.122 | 5608.6 samples/s | 87.6 steps/s
[Step=23550 Epoch=115.5] | Loss=0.01697 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.998 | L2-Norm(final)=14.123 | 2472.1 samples/s | 38.6 steps/s
[Step=23600 Epoch=115.7] | Loss=0.01643 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.006 | L2-Norm(final)=14.125 | 4877.1 samples/s | 76.2 steps/s
[Step=23650 Epoch=116.0] | Loss=0.01595 | Reg=0.00144 | acc=0.9688 | L2-Norm=12.013 | L2-Norm(final)=14.126 | 4827.0 samples/s | 75.4 steps/s
[Step=23700 Epoch=116.2] | Loss=0.01565 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.020 | L2-Norm(final)=14.127 | 5301.5 samples/s | 82.8 steps/s
[Step=23750 Epoch=116.5] | Loss=0.01521 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.027 | L2-Norm(final)=14.128 | 2520.5 samples/s | 39.4 steps/s
[Step=23800 Epoch=116.7] | Loss=0.01477 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.033 | L2-Norm(final)=14.129 | 4849.1 samples/s | 75.8 steps/s
[Step=23850 Epoch=117.0] | Loss=0.01444 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.038 | L2-Norm(final)=14.130 | 4854.9 samples/s | 75.9 steps/s
[Step=23900 Epoch=117.2] | Loss=0.01417 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.044 | L2-Norm(final)=14.131 | 5064.0 samples/s | 79.1 steps/s
[Step=23950 Epoch=117.4] | Loss=0.01383 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.050 | L2-Norm(final)=14.132 | 2570.9 samples/s | 40.2 steps/s
[Step=24000 Epoch=117.7] | Loss=0.01347 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.055 | L2-Norm(final)=14.134 | 4842.3 samples/s | 75.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step24000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=170.6] | Loss=0.00012 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.265 | L2-Norm(final)=13.372 | 5515.5 samples/s | 86.2 steps/s
[Step=18050 Epoch=171.0] | Loss=0.00387 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.262 | L2-Norm(final)=13.377 | 4640.9 samples/s | 72.5 steps/s
[Step=18100 Epoch=171.5] | Loss=0.00438 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.261 | L2-Norm(final)=13.398 | 8383.4 samples/s | 131.0 steps/s
[Step=18150 Epoch=172.0] | Loss=0.00441 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.261 | L2-Norm(final)=13.417 | 2391.8 samples/s | 37.4 steps/s
[Step=18200 Epoch=172.5] | Loss=0.00416 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.261 | L2-Norm(final)=13.435 | 7152.3 samples/s | 111.8 steps/s
[Step=18250 Epoch=172.9] | Loss=0.00430 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.261 | L2-Norm(final)=13.454 | 2446.3 samples/s | 38.2 steps/s
[Step=18300 Epoch=173.4] | Loss=0.00429 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.261 | L2-Norm(final)=13.473 | 6517.9 samples/s | 101.8 steps/s
[Step=18350 Epoch=173.9] | Loss=0.00410 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.261 | L2-Norm(final)=13.492 | 2556.9 samples/s | 40.0 steps/s
[Step=18400 Epoch=174.4] | Loss=0.00421 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.261 | L2-Norm(final)=13.512 | 5874.7 samples/s | 91.8 steps/s
[Step=18450 Epoch=174.8] | Loss=0.00416 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.261 | L2-Norm(final)=13.530 | 2618.2 samples/s | 40.9 steps/s
[Step=18500 Epoch=175.3] | Loss=0.00415 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.261 | L2-Norm(final)=13.549 | 5557.0 samples/s | 86.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=175.3] | Loss=0.00092 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.261 | L2-Norm(final)=13.734 | 5608.8 samples/s | 87.6 steps/s
[Step=18550 Epoch=175.8] | Loss=0.00692 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.409 | L2-Norm(final)=13.738 | 4241.0 samples/s | 66.3 steps/s
[Step=18600 Epoch=176.3] | Loss=0.00612 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.561 | L2-Norm(final)=13.715 | 6614.4 samples/s | 103.4 steps/s
[Step=18650 Epoch=176.7] | Loss=0.00428 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.646 | L2-Norm(final)=13.705 | 2199.4 samples/s | 34.4 steps/s
[Step=18700 Epoch=177.2] | Loss=0.00322 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.687 | L2-Norm(final)=13.703 | 5947.4 samples/s | 92.9 steps/s
[Step=18750 Epoch=177.7] | Loss=0.00258 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=13.701 | 2252.3 samples/s | 35.2 steps/s
[Step=18800 Epoch=178.1] | Loss=0.00215 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.711 | L2-Norm(final)=13.701 | 5575.7 samples/s | 87.1 steps/s
[Step=18850 Epoch=178.6] | Loss=0.00184 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.712 | L2-Norm(final)=13.700 | 2355.9 samples/s | 36.8 steps/s
[Step=18900 Epoch=179.1] | Loss=0.00161 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.709 | L2-Norm(final)=13.700 | 5104.6 samples/s | 79.8 steps/s
[Step=18950 Epoch=179.6] | Loss=0.00143 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.703 | L2-Norm(final)=13.700 | 2470.1 samples/s | 38.6 steps/s
[Step=19000 Epoch=180.0] | Loss=0.00129 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=13.700 | 4665.1 samples/s | 72.9 steps/s
[Step=19050 Epoch=180.5] | Loss=0.00117 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.689 | L2-Norm(final)=13.700 | 2570.7 samples/s | 40.2 steps/s
[Step=19100 Epoch=181.0] | Loss=0.00108 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.680 | L2-Norm(final)=13.700 | 4621.3 samples/s | 72.2 steps/s
[Step=19150 Epoch=181.5] | Loss=0.00099 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=13.701 | 2545.2 samples/s | 39.8 steps/s
[Step=19200 Epoch=181.9] | Loss=0.00092 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.661 | L2-Norm(final)=13.701 | 4628.4 samples/s | 72.3 steps/s
[Step=19250 Epoch=182.4] | Loss=0.00086 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.651 | L2-Norm(final)=13.701 | 2570.6 samples/s | 40.2 steps/s
[Step=19300 Epoch=182.9] | Loss=0.00081 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.641 | L2-Norm(final)=13.701 | 4639.0 samples/s | 72.5 steps/s
[Step=19350 Epoch=183.4] | Loss=0.00076 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.630 | L2-Norm(final)=13.702 | 2648.7 samples/s | 41.4 steps/s
[Step=19400 Epoch=183.8] | Loss=0.00072 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=13.702 | 4544.7 samples/s | 71.0 steps/s
[Step=19450 Epoch=184.3] | Loss=0.00068 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.609 | L2-Norm(final)=13.702 | 6727.6 samples/s | 105.1 steps/s
[Step=19500 Epoch=184.8] | Loss=0.00065 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.599 | L2-Norm(final)=13.702 | 2167.4 samples/s | 33.9 steps/s
[Step=19550 Epoch=185.3] | Loss=0.00062 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.588 | L2-Norm(final)=13.703 | 6274.6 samples/s | 98.0 steps/s
[Step=19600 Epoch=185.7] | Loss=0.00059 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.577 | L2-Norm(final)=13.703 | 2276.2 samples/s | 35.6 steps/s
[Step=19650 Epoch=186.2] | Loss=0.00056 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.566 | L2-Norm(final)=13.703 | 5559.9 samples/s | 86.9 steps/s
[Step=19700 Epoch=186.7] | Loss=0.00054 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.555 | L2-Norm(final)=13.704 | 2323.9 samples/s | 36.3 steps/s
[Step=19750 Epoch=187.1] | Loss=0.00052 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.544 | L2-Norm(final)=13.704 | 5252.1 samples/s | 82.1 steps/s
[Step=19800 Epoch=187.6] | Loss=0.00050 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.533 | L2-Norm(final)=13.705 | 2457.8 samples/s | 38.4 steps/s
[Step=19850 Epoch=188.1] | Loss=0.00048 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.522 | L2-Norm(final)=13.705 | 4679.1 samples/s | 73.1 steps/s
[Step=19900 Epoch=188.6] | Loss=0.00046 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=13.705 | 2523.5 samples/s | 39.4 steps/s
[Step=19950 Epoch=189.0] | Loss=0.00045 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.499 | L2-Norm(final)=13.706 | 4631.8 samples/s | 72.4 steps/s
[Step=20000 Epoch=189.5] | Loss=0.00043 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.488 | L2-Norm(final)=13.706 | 2562.4 samples/s | 40.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step20000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=133.2] | Loss=0.02445 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.265 | L2-Norm(final)=11.805 | 5690.2 samples/s | 88.9 steps/s
[Step=14050 Epoch=133.7] | Loss=0.00630 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=11.805 | 4536.7 samples/s | 70.9 steps/s
[Step=14100 Epoch=134.1] | Loss=0.00595 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=11.829 | 8472.8 samples/s | 132.4 steps/s
[Step=14150 Epoch=134.6] | Loss=0.00565 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=11.859 | 2326.7 samples/s | 36.4 steps/s
[Step=14200 Epoch=135.1] | Loss=0.00575 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.259 | L2-Norm(final)=11.884 | 7369.0 samples/s | 115.1 steps/s
[Step=14250 Epoch=135.6] | Loss=0.00552 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.259 | L2-Norm(final)=11.909 | 2445.7 samples/s | 38.2 steps/s
[Step=14300 Epoch=136.0] | Loss=0.00559 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.259 | L2-Norm(final)=11.933 | 6620.8 samples/s | 103.5 steps/s
[Step=14350 Epoch=136.5] | Loss=0.00564 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.259 | L2-Norm(final)=11.955 | 2569.0 samples/s | 40.1 steps/s
[Step=14400 Epoch=137.0] | Loss=0.00554 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.259 | L2-Norm(final)=11.977 | 5744.7 samples/s | 89.8 steps/s
[Step=14450 Epoch=137.5] | Loss=0.00550 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.259 | L2-Norm(final)=11.999 | 2615.5 samples/s | 40.9 steps/s
[Step=14500 Epoch=137.9] | Loss=0.00543 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.259 | L2-Norm(final)=12.022 | 5443.1 samples/s | 85.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=137.9] | Loss=0.00745 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.259 | L2-Norm(final)=12.246 | 5704.5 samples/s | 89.1 steps/s
[Step=14550 Epoch=138.4] | Loss=0.00434 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.445 | L2-Norm(final)=12.257 | 4239.3 samples/s | 66.2 steps/s
[Step=14600 Epoch=138.9] | Loss=0.00419 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.566 | L2-Norm(final)=12.254 | 6559.3 samples/s | 102.5 steps/s
[Step=14650 Epoch=139.4] | Loss=0.00427 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.669 | L2-Norm(final)=12.243 | 2207.8 samples/s | 34.5 steps/s
[Step=14700 Epoch=139.8] | Loss=0.00341 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.736 | L2-Norm(final)=12.234 | 6106.6 samples/s | 95.4 steps/s
[Step=14750 Epoch=140.3] | Loss=0.00274 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.773 | L2-Norm(final)=12.229 | 2276.2 samples/s | 35.6 steps/s
[Step=14800 Epoch=140.8] | Loss=0.00228 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.792 | L2-Norm(final)=12.226 | 5582.9 samples/s | 87.2 steps/s
[Step=14850 Epoch=141.3] | Loss=0.00196 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.801 | L2-Norm(final)=12.224 | 2340.2 samples/s | 36.6 steps/s
[Step=14900 Epoch=141.7] | Loss=0.00172 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.803 | L2-Norm(final)=12.222 | 5133.9 samples/s | 80.2 steps/s
[Step=14950 Epoch=142.2] | Loss=0.00153 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.802 | L2-Norm(final)=12.221 | 2437.4 samples/s | 38.1 steps/s
[Step=15000 Epoch=142.7] | Loss=0.00137 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.799 | L2-Norm(final)=12.221 | 4735.5 samples/s | 74.0 steps/s
[Step=15050 Epoch=143.2] | Loss=0.00125 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=12.220 | 2526.9 samples/s | 39.5 steps/s
[Step=15100 Epoch=143.6] | Loss=0.00115 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.786 | L2-Norm(final)=12.220 | 4671.9 samples/s | 73.0 steps/s
[Step=15150 Epoch=144.1] | Loss=0.00106 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.778 | L2-Norm(final)=12.220 | 2536.3 samples/s | 39.6 steps/s
[Step=15200 Epoch=144.6] | Loss=0.00098 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.770 | L2-Norm(final)=12.219 | 4653.9 samples/s | 72.7 steps/s
[Step=15250 Epoch=145.1] | Loss=0.00092 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.761 | L2-Norm(final)=12.219 | 2543.1 samples/s | 39.7 steps/s
[Step=15300 Epoch=145.5] | Loss=0.00086 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.751 | L2-Norm(final)=12.219 | 4658.2 samples/s | 72.8 steps/s
[Step=15350 Epoch=146.0] | Loss=0.00081 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.741 | L2-Norm(final)=12.219 | 2774.4 samples/s | 43.4 steps/s
[Step=15400 Epoch=146.5] | Loss=0.00077 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.730 | L2-Norm(final)=12.219 | 4214.1 samples/s | 65.8 steps/s
[Step=15450 Epoch=147.0] | Loss=0.00073 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.720 | L2-Norm(final)=12.219 | 6960.7 samples/s | 108.8 steps/s
[Step=15500 Epoch=147.4] | Loss=0.00069 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.709 | L2-Norm(final)=12.219 | 2153.0 samples/s | 33.6 steps/s
[Step=15550 Epoch=147.9] | Loss=0.00066 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=12.220 | 6306.2 samples/s | 98.5 steps/s
[Step=15600 Epoch=148.4] | Loss=0.00063 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.687 | L2-Norm(final)=12.220 | 2231.7 samples/s | 34.9 steps/s
[Step=15650 Epoch=148.9] | Loss=0.00060 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.676 | L2-Norm(final)=12.220 | 5744.5 samples/s | 89.8 steps/s
[Step=15700 Epoch=149.3] | Loss=0.00058 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.665 | L2-Norm(final)=12.220 | 2326.1 samples/s | 36.3 steps/s
[Step=15750 Epoch=149.8] | Loss=0.00055 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.653 | L2-Norm(final)=12.220 | 5291.8 samples/s | 82.7 steps/s
[Step=15800 Epoch=150.3] | Loss=0.00053 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.642 | L2-Norm(final)=12.220 | 2419.9 samples/s | 37.8 steps/s
[Step=15850 Epoch=150.8] | Loss=0.00051 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.630 | L2-Norm(final)=12.221 | 4760.4 samples/s | 74.4 steps/s
[Step=15900 Epoch=151.2] | Loss=0.00049 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.619 | L2-Norm(final)=12.221 | 2513.2 samples/s | 39.3 steps/s
[Step=15950 Epoch=151.7] | Loss=0.00048 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.607 | L2-Norm(final)=12.221 | 4644.4 samples/s | 72.6 steps/s
[Step=16000 Epoch=152.2] | Loss=0.00046 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.596 | L2-Norm(final)=12.221 | 2571.8 samples/s | 40.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.12193 | acc=0.9541 | tpr=0.9668 | fpr=0.0733 | 5523.6 samples/s | 21.6 steps/s
Avg test loss: 0.12695, Avg test acc: 0.95256, Avg tpr: 0.96544, Avg fpr: 0.07576, total FA: 591

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.12008 | acc=0.9524 | tpr=0.9692 | fpr=0.0840 | 5629.6 samples/s | 22.0 steps/s
Avg test loss: 0.12073, Avg test acc: 0.95216, Avg tpr: 0.96823, Avg fpr: 0.08319, total FA: 649

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.12360 | acc=0.9519 | tpr=0.9647 | fpr=0.0761 | 5823.8 samples/s | 22.7 steps/s
Avg test loss: 0.12892, Avg test acc: 0.95068, Avg tpr: 0.96276, Avg fpr: 0.07589, total FA: 592

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10976 | acc=0.9530 | tpr=0.9708 | fpr=0.0855 | 5720.8 samples/s | 22.3 steps/s
Avg test loss: 0.11888, Avg test acc: 0.95076, Avg tpr: 0.96864, Avg fpr: 0.08858, total FA: 691

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11601 | acc=0.9528 | tpr=0.9700 | fpr=0.0845 | 5636.9 samples/s | 22.0 steps/s
Avg test loss: 0.12269, Avg test acc: 0.95204, Avg tpr: 0.96853, Avg fpr: 0.08422, total FA: 657

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.16546 | acc=0.2997 | tpr=0.0050 | fpr=0.0605 | 5698.0 samples/s | 22.3 steps/s
Avg test loss: 5.17263, Avg test acc: 0.29714, Avg tpr: 0.00460, Avg fpr: 0.05948, total FA: 464

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.59374 | acc=0.3041 | tpr=0.0139 | fpr=0.0657 | 5781.1 samples/s | 22.6 steps/s
Avg test loss: 4.61353, Avg test acc: 0.30211, Avg tpr: 0.01376, Avg fpr: 0.06371, total FA: 497

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.52977 | acc=0.2860 | tpr=0.0176 | fpr=0.1311 | 5768.4 samples/s | 22.5 steps/s
Avg test loss: 5.52678, Avg test acc: 0.28568, Avg tpr: 0.01789, Avg fpr: 0.12537, total FA: 978

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.71897 | acc=0.2923 | tpr=0.0169 | fpr=0.1095 | 5491.3 samples/s | 21.5 steps/s
Avg test loss: 4.72579, Avg test acc: 0.29161, Avg tpr: 0.01708, Avg fpr: 0.10460, total FA: 816

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.09458 | acc=0.2980 | tpr=0.0144 | fpr=0.0862 | 5546.4 samples/s | 21.7 steps/s
Avg test loss: 5.11129, Avg test acc: 0.29578, Avg tpr: 0.01515, Avg fpr: 0.08704, total FA: 679

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.83451 | acc=0.1451 | tpr=0.3982 | fpr=0.8595 | 5659.0 samples/s | 22.1 steps/s
[Step= 100] | Loss=6.76889 | acc=0.1431 | tpr=0.3625 | fpr=0.8610 | 7748.3 samples/s | 30.3 steps/s
[Step= 150] | Loss=6.77737 | acc=0.1417 | tpr=0.3689 | fpr=0.8625 | 8118.8 samples/s | 31.7 steps/s
[Step= 200] | Loss=6.77291 | acc=0.1421 | tpr=0.3617 | fpr=0.8619 | 8303.0 samples/s | 32.4 steps/s
[Step= 250] | Loss=6.77989 | acc=0.1422 | tpr=0.3537 | fpr=0.8617 | 7926.6 samples/s | 31.0 steps/s
[Step= 300] | Loss=6.77807 | acc=0.1420 | tpr=0.3535 | fpr=0.8618 | 8406.8 samples/s | 32.8 steps/s
[Step= 350] | Loss=6.77994 | acc=0.1420 | tpr=0.3388 | fpr=0.8616 | 7742.4 samples/s | 30.2 steps/s
[Step= 400] | Loss=6.77524 | acc=0.1425 | tpr=0.3375 | fpr=0.8610 | 8120.9 samples/s | 31.7 steps/s
[Step= 450] | Loss=6.77857 | acc=0.1424 | tpr=0.3354 | fpr=0.8611 | 8351.7 samples/s | 32.6 steps/s
[Step= 500] | Loss=6.78000 | acc=0.1422 | tpr=0.3348 | fpr=0.8613 | 8409.8 samples/s | 32.9 steps/s
[Step= 550] | Loss=6.77697 | acc=0.1420 | tpr=0.3311 | fpr=0.8614 | 9410.1 samples/s | 36.8 steps/s
Avg test loss: 6.77740, Avg test acc: 0.14192, Avg tpr: 0.33082, Avg fpr: 0.86151, total FA: 119619

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.96936 | acc=0.1338 | tpr=0.3363 | fpr=0.8698 | 5584.0 samples/s | 21.8 steps/s
[Step= 100] | Loss=5.91360 | acc=0.1328 | tpr=0.2857 | fpr=0.8700 | 8050.0 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.92825 | acc=0.1306 | tpr=0.2622 | fpr=0.8719 | 8323.0 samples/s | 32.5 steps/s
[Step= 200] | Loss=5.92544 | acc=0.1310 | tpr=0.2579 | fpr=0.8713 | 7861.7 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.93062 | acc=0.1306 | tpr=0.2515 | fpr=0.8716 | 8245.9 samples/s | 32.2 steps/s
[Step= 300] | Loss=5.93147 | acc=0.1300 | tpr=0.2575 | fpr=0.8723 | 7933.7 samples/s | 31.0 steps/s
[Step= 350] | Loss=5.93561 | acc=0.1293 | tpr=0.2467 | fpr=0.8729 | 7661.1 samples/s | 29.9 steps/s
[Step= 400] | Loss=5.93397 | acc=0.1297 | tpr=0.2412 | fpr=0.8724 | 8370.1 samples/s | 32.7 steps/s
[Step= 450] | Loss=5.93415 | acc=0.1297 | tpr=0.2410 | fpr=0.8723 | 8606.4 samples/s | 33.6 steps/s
[Step= 500] | Loss=5.93397 | acc=0.1297 | tpr=0.2423 | fpr=0.8724 | 7748.3 samples/s | 30.3 steps/s
[Step= 550] | Loss=5.93292 | acc=0.1298 | tpr=0.2435 | fpr=0.8723 | 10056.4 samples/s | 39.3 steps/s
Avg test loss: 5.93298, Avg test acc: 0.12964, Avg tpr: 0.24366, Avg fpr: 0.87244, total FA: 121136

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.46532 | acc=0.1402 | tpr=0.2434 | fpr=0.8616 | 5361.8 samples/s | 20.9 steps/s
[Step= 100] | Loss=6.41055 | acc=0.1407 | tpr=0.1962 | fpr=0.8603 | 8211.7 samples/s | 32.1 steps/s
[Step= 150] | Loss=6.41624 | acc=0.1401 | tpr=0.1873 | fpr=0.8608 | 8062.5 samples/s | 31.5 steps/s
[Step= 200] | Loss=6.40873 | acc=0.1400 | tpr=0.1770 | fpr=0.8607 | 8385.3 samples/s | 32.8 steps/s
[Step= 250] | Loss=6.40425 | acc=0.1402 | tpr=0.1755 | fpr=0.8605 | 8420.9 samples/s | 32.9 steps/s
[Step= 300] | Loss=6.40856 | acc=0.1392 | tpr=0.1782 | fpr=0.8616 | 7999.6 samples/s | 31.2 steps/s
[Step= 350] | Loss=6.41425 | acc=0.1384 | tpr=0.1722 | fpr=0.8622 | 7814.3 samples/s | 30.5 steps/s
[Step= 400] | Loss=6.41406 | acc=0.1387 | tpr=0.1772 | fpr=0.8620 | 7376.4 samples/s | 28.8 steps/s
[Step= 450] | Loss=6.41527 | acc=0.1385 | tpr=0.1719 | fpr=0.8621 | 8722.8 samples/s | 34.1 steps/s
[Step= 500] | Loss=6.41435 | acc=0.1382 | tpr=0.1709 | fpr=0.8624 | 8126.4 samples/s | 31.7 steps/s
[Step= 550] | Loss=6.41266 | acc=0.1384 | tpr=0.1695 | fpr=0.8621 | 10260.4 samples/s | 40.1 steps/s
Avg test loss: 6.41264, Avg test acc: 0.13829, Avg tpr: 0.16957, Avg fpr: 0.86228, total FA: 119726

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.36418 | acc=0.1408 | tpr=0.2212 | fpr=0.8607 | 5685.3 samples/s | 22.2 steps/s
[Step= 100] | Loss=6.33414 | acc=0.1400 | tpr=0.2111 | fpr=0.8613 | 8065.6 samples/s | 31.5 steps/s
[Step= 150] | Loss=6.33109 | acc=0.1392 | tpr=0.2003 | fpr=0.8620 | 8278.7 samples/s | 32.3 steps/s
[Step= 200] | Loss=6.32443 | acc=0.1395 | tpr=0.2022 | fpr=0.8616 | 8278.2 samples/s | 32.3 steps/s
[Step= 250] | Loss=6.33303 | acc=0.1396 | tpr=0.2044 | fpr=0.8616 | 7707.1 samples/s | 30.1 steps/s
[Step= 300] | Loss=6.33834 | acc=0.1390 | tpr=0.2095 | fpr=0.8623 | 7986.0 samples/s | 31.2 steps/s
[Step= 350] | Loss=6.34050 | acc=0.1384 | tpr=0.1966 | fpr=0.8626 | 8201.2 samples/s | 32.0 steps/s
[Step= 400] | Loss=6.33669 | acc=0.1391 | tpr=0.1975 | fpr=0.8620 | 8253.2 samples/s | 32.2 steps/s
[Step= 450] | Loss=6.33432 | acc=0.1391 | tpr=0.1991 | fpr=0.8620 | 7805.3 samples/s | 30.5 steps/s
[Step= 500] | Loss=6.33453 | acc=0.1389 | tpr=0.1982 | fpr=0.8622 | 8218.9 samples/s | 32.1 steps/s
[Step= 550] | Loss=6.33302 | acc=0.1391 | tpr=0.1970 | fpr=0.8620 | 9562.8 samples/s | 37.4 steps/s
Avg test loss: 6.33317, Avg test acc: 0.13904, Avg tpr: 0.19731, Avg fpr: 0.86202, total FA: 119690

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.67956 | acc=0.1012 | tpr=0.2566 | fpr=0.9016 | 5772.7 samples/s | 22.5 steps/s
[Step= 100] | Loss=6.62549 | acc=0.1007 | tpr=0.2388 | fpr=0.9019 | 7476.6 samples/s | 29.2 steps/s
[Step= 150] | Loss=6.64136 | acc=0.0999 | tpr=0.2320 | fpr=0.9025 | 8118.3 samples/s | 31.7 steps/s
[Step= 200] | Loss=6.62797 | acc=0.1003 | tpr=0.2197 | fpr=0.9018 | 7562.5 samples/s | 29.5 steps/s
[Step= 250] | Loss=6.63778 | acc=0.1006 | tpr=0.2166 | fpr=0.9015 | 8085.6 samples/s | 31.6 steps/s
[Step= 300] | Loss=6.63875 | acc=0.1005 | tpr=0.2196 | fpr=0.9017 | 8041.0 samples/s | 31.4 steps/s
[Step= 350] | Loss=6.64453 | acc=0.1002 | tpr=0.2091 | fpr=0.9018 | 8478.8 samples/s | 33.1 steps/s
[Step= 400] | Loss=6.64399 | acc=0.1005 | tpr=0.2128 | fpr=0.9015 | 7754.3 samples/s | 30.3 steps/s
[Step= 450] | Loss=6.64723 | acc=0.1007 | tpr=0.2093 | fpr=0.9013 | 8034.5 samples/s | 31.4 steps/s
[Step= 500] | Loss=6.65072 | acc=0.1003 | tpr=0.2088 | fpr=0.9017 | 7418.0 samples/s | 29.0 steps/s
[Step= 550] | Loss=6.64810 | acc=0.1003 | tpr=0.2065 | fpr=0.9017 | 13463.6 samples/s | 52.6 steps/s
Avg test loss: 6.64734, Avg test acc: 0.10019, Avg tpr: 0.20761, Avg fpr: 0.90176, total FA: 125208

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08780 | acc=0.9840 | tpr=0.8982 | fpr=0.0145 | 5530.5 samples/s | 21.6 steps/s
[Step= 100] | Loss=0.09346 | acc=0.9839 | tpr=0.9190 | fpr=0.0149 | 8784.9 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.09664 | acc=0.9834 | tpr=0.9265 | fpr=0.0155 | 7777.4 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.09781 | acc=0.9834 | tpr=0.9279 | fpr=0.0156 | 7889.4 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.09827 | acc=0.9833 | tpr=0.9170 | fpr=0.0155 | 8312.4 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.09928 | acc=0.9830 | tpr=0.9156 | fpr=0.0158 | 7372.6 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.09953 | acc=0.9829 | tpr=0.9173 | fpr=0.0159 | 8294.0 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.10044 | acc=0.9828 | tpr=0.9125 | fpr=0.0159 | 8423.8 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.10243 | acc=0.9826 | tpr=0.9124 | fpr=0.0162 | 8202.0 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.10153 | acc=0.9828 | tpr=0.9167 | fpr=0.0161 | 7987.6 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.10069 | acc=0.9829 | tpr=0.9172 | fpr=0.0160 | 10036.0 samples/s | 39.2 steps/s
Avg test loss: 0.10053, Avg test acc: 0.98287, Avg tpr: 0.91680, Avg fpr: 0.01593, total FA: 2212

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11870 | acc=0.9769 | tpr=0.8673 | fpr=0.0212 | 5805.6 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.12484 | acc=0.9762 | tpr=0.8721 | fpr=0.0218 | 8237.2 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.12852 | acc=0.9749 | tpr=0.8862 | fpr=0.0234 | 7800.4 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.12975 | acc=0.9748 | tpr=0.8831 | fpr=0.0235 | 7372.8 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.12947 | acc=0.9749 | tpr=0.8847 | fpr=0.0235 | 8190.2 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.13023 | acc=0.9747 | tpr=0.8844 | fpr=0.0237 | 7924.6 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.13136 | acc=0.9745 | tpr=0.8842 | fpr=0.0238 | 8224.1 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.13226 | acc=0.9744 | tpr=0.8835 | fpr=0.0240 | 7957.3 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.13381 | acc=0.9741 | tpr=0.8807 | fpr=0.0242 | 8418.3 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.13300 | acc=0.9743 | tpr=0.8833 | fpr=0.0241 | 8368.6 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.13205 | acc=0.9744 | tpr=0.8826 | fpr=0.0239 | 9860.9 samples/s | 38.5 steps/s
Avg test loss: 0.13185, Avg test acc: 0.97442, Avg tpr: 0.88233, Avg fpr: 0.02390, total FA: 3319

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10566 | acc=0.9791 | tpr=0.9381 | fpr=0.0201 | 5756.6 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.11036 | acc=0.9784 | tpr=0.9467 | fpr=0.0210 | 7944.7 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.11586 | acc=0.9774 | tpr=0.9467 | fpr=0.0221 | 8241.5 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.11770 | acc=0.9775 | tpr=0.9475 | fpr=0.0219 | 7530.9 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.11845 | acc=0.9774 | tpr=0.9467 | fpr=0.0221 | 8437.0 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.12037 | acc=0.9773 | tpr=0.9389 | fpr=0.0220 | 8612.8 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.12024 | acc=0.9773 | tpr=0.9393 | fpr=0.0220 | 7947.2 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.12101 | acc=0.9770 | tpr=0.9354 | fpr=0.0222 | 7556.5 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.12252 | acc=0.9768 | tpr=0.9314 | fpr=0.0223 | 8770.5 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.12207 | acc=0.9769 | tpr=0.9330 | fpr=0.0223 | 7715.9 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.12122 | acc=0.9770 | tpr=0.9339 | fpr=0.0222 | 9976.2 samples/s | 39.0 steps/s
Avg test loss: 0.12106, Avg test acc: 0.97703, Avg tpr: 0.93344, Avg fpr: 0.02218, total FA: 3080

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09092 | acc=0.9827 | tpr=0.9071 | fpr=0.0159 | 5771.0 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.09442 | acc=0.9822 | tpr=0.9147 | fpr=0.0165 | 7762.5 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.09885 | acc=0.9814 | tpr=0.9207 | fpr=0.0175 | 8256.4 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.10085 | acc=0.9811 | tpr=0.9180 | fpr=0.0177 | 7937.6 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.10080 | acc=0.9812 | tpr=0.9127 | fpr=0.0176 | 7858.4 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.10235 | acc=0.9810 | tpr=0.9135 | fpr=0.0177 | 7840.4 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.10260 | acc=0.9810 | tpr=0.9142 | fpr=0.0178 | 7969.3 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.10309 | acc=0.9809 | tpr=0.9130 | fpr=0.0179 | 8166.9 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.10476 | acc=0.9807 | tpr=0.9119 | fpr=0.0181 | 7901.4 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.10452 | acc=0.9807 | tpr=0.9145 | fpr=0.0181 | 8159.1 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.10397 | acc=0.9807 | tpr=0.9144 | fpr=0.0181 | 11051.3 samples/s | 43.2 steps/s
Avg test loss: 0.10375, Avg test acc: 0.98071, Avg tpr: 0.91403, Avg fpr: 0.01808, total FA: 2510

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12392 | acc=0.9780 | tpr=0.8717 | fpr=0.0200 | 5575.1 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.12622 | acc=0.9789 | tpr=0.9104 | fpr=0.0199 | 7989.4 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.13326 | acc=0.9778 | tpr=0.9179 | fpr=0.0211 | 8565.2 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.13523 | acc=0.9777 | tpr=0.9191 | fpr=0.0212 | 7977.6 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.13382 | acc=0.9777 | tpr=0.9188 | fpr=0.0212 | 7976.8 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.13565 | acc=0.9776 | tpr=0.9215 | fpr=0.0214 | 8353.4 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.13601 | acc=0.9776 | tpr=0.9249 | fpr=0.0215 | 8599.7 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.13708 | acc=0.9773 | tpr=0.9212 | fpr=0.0217 | 7208.2 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.13975 | acc=0.9769 | tpr=0.9192 | fpr=0.0220 | 9165.8 samples/s | 35.8 steps/s
[Step= 500] | Loss=0.13885 | acc=0.9770 | tpr=0.9211 | fpr=0.0220 | 7618.6 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.13774 | acc=0.9772 | tpr=0.9220 | fpr=0.0218 | 9894.2 samples/s | 38.6 steps/s
Avg test loss: 0.13748, Avg test acc: 0.97717, Avg tpr: 0.92155, Avg fpr: 0.02182, total FA: 3029

server round 18/50

clients selected: [0 1 2 4 6]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.06484 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.228 | L2-Norm(final)=12.001 | 5927.0 samples/s | 92.6 steps/s
[Step=12050 Epoch=58.8] | Loss=0.04149 | Reg=0.00126 | acc=0.9219 | L2-Norm=11.228 | L2-Norm(final)=12.038 | 5001.8 samples/s | 78.2 steps/s
[Step=12100 Epoch=59.0] | Loss=0.04072 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.229 | L2-Norm(final)=12.077 | 5607.8 samples/s | 87.6 steps/s
[Step=12150 Epoch=59.2] | Loss=0.04032 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.229 | L2-Norm(final)=12.113 | 5701.9 samples/s | 89.1 steps/s
[Step=12200 Epoch=59.5] | Loss=0.04085 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.229 | L2-Norm(final)=12.147 | 8595.5 samples/s | 134.3 steps/s
[Step=12250 Epoch=59.7] | Loss=0.03995 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.229 | L2-Norm(final)=12.177 | 2454.2 samples/s | 38.3 steps/s
[Step=12300 Epoch=60.0] | Loss=0.04080 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.229 | L2-Norm(final)=12.207 | 5550.7 samples/s | 86.7 steps/s
[Step=12350 Epoch=60.2] | Loss=0.04098 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.229 | L2-Norm(final)=12.234 | 5648.2 samples/s | 88.3 steps/s
[Step=12400 Epoch=60.5] | Loss=0.04056 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.229 | L2-Norm(final)=12.262 | 7745.7 samples/s | 121.0 steps/s
[Step=12450 Epoch=60.7] | Loss=0.04061 | Reg=0.00126 | acc=0.9375 | L2-Norm=11.229 | L2-Norm(final)=12.291 | 2545.4 samples/s | 39.8 steps/s
[Step=12500 Epoch=61.0] | Loss=0.04043 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.229 | L2-Norm(final)=12.319 | 5541.0 samples/s | 86.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=61.0] | Loss=0.03409 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.229 | L2-Norm(final)=12.600 | 5680.2 samples/s | 88.8 steps/s
[Step=12550 Epoch=61.2] | Loss=0.04595 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.349 | L2-Norm(final)=12.599 | 4484.7 samples/s | 70.1 steps/s
[Step=12600 Epoch=61.4] | Loss=0.04701 | Reg=0.00132 | acc=0.9531 | L2-Norm=11.474 | L2-Norm(final)=12.577 | 4829.5 samples/s | 75.5 steps/s
[Step=12650 Epoch=61.7] | Loss=0.04418 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.561 | L2-Norm(final)=12.562 | 4888.6 samples/s | 76.4 steps/s
[Step=12700 Epoch=61.9] | Loss=0.04305 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.626 | L2-Norm(final)=12.554 | 6905.7 samples/s | 107.9 steps/s
[Step=12750 Epoch=62.2] | Loss=0.03813 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.680 | L2-Norm(final)=12.550 | 2250.9 samples/s | 35.2 steps/s
[Step=12800 Epoch=62.4] | Loss=0.03403 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.724 | L2-Norm(final)=12.551 | 4849.7 samples/s | 75.8 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03122 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.760 | L2-Norm(final)=12.553 | 4864.9 samples/s | 76.0 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02941 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=12.555 | 6305.8 samples/s | 98.5 steps/s
[Step=12950 Epoch=63.1] | Loss=0.02790 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.819 | L2-Norm(final)=12.556 | 2343.1 samples/s | 36.6 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02624 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.846 | L2-Norm(final)=12.558 | 4813.8 samples/s | 75.2 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02501 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.868 | L2-Norm(final)=12.560 | 4875.9 samples/s | 76.2 steps/s
[Step=13100 Epoch=63.9] | Loss=0.02394 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.889 | L2-Norm(final)=12.560 | 5798.6 samples/s | 90.6 steps/s
[Step=13150 Epoch=64.1] | Loss=0.02273 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.907 | L2-Norm(final)=12.561 | 2405.4 samples/s | 37.6 steps/s
[Step=13200 Epoch=64.4] | Loss=0.02160 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.925 | L2-Norm(final)=12.563 | 4863.9 samples/s | 76.0 steps/s
[Step=13250 Epoch=64.6] | Loss=0.02100 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.940 | L2-Norm(final)=12.564 | 4904.5 samples/s | 76.6 steps/s
[Step=13300 Epoch=64.9] | Loss=0.02033 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.955 | L2-Norm(final)=12.565 | 5362.9 samples/s | 83.8 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01948 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.969 | L2-Norm(final)=12.567 | 2486.7 samples/s | 38.9 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01866 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.982 | L2-Norm(final)=12.569 | 4824.2 samples/s | 75.4 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01808 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.994 | L2-Norm(final)=12.571 | 4965.5 samples/s | 77.6 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01749 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.005 | L2-Norm(final)=12.572 | 4912.5 samples/s | 76.8 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01694 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.016 | L2-Norm(final)=12.574 | 2614.0 samples/s | 40.8 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01650 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.025 | L2-Norm(final)=12.576 | 4828.6 samples/s | 75.4 steps/s
[Step=13650 Epoch=66.6] | Loss=0.01596 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.034 | L2-Norm(final)=12.578 | 4901.3 samples/s | 76.6 steps/s
[Step=13700 Epoch=66.8] | Loss=0.01554 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.043 | L2-Norm(final)=12.580 | 4822.3 samples/s | 75.3 steps/s
[Step=13750 Epoch=67.0] | Loss=0.01507 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.051 | L2-Norm(final)=12.582 | 2683.7 samples/s | 41.9 steps/s
[Step=13800 Epoch=67.3] | Loss=0.01460 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.058 | L2-Norm(final)=12.584 | 4886.9 samples/s | 76.4 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01421 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.065 | L2-Norm(final)=12.586 | 4754.6 samples/s | 74.3 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01383 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.071 | L2-Norm(final)=12.589 | 4847.8 samples/s | 75.7 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01354 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.077 | L2-Norm(final)=12.591 | 2628.3 samples/s | 41.1 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01323 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.082 | L2-Norm(final)=12.592 | 4930.1 samples/s | 77.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step14000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=26001 Epoch=126.9] | Loss=0.07588 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.228 | L2-Norm(final)=13.986 | 5539.7 samples/s | 86.6 steps/s
[Step=26050 Epoch=127.1] | Loss=0.04306 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.228 | L2-Norm(final)=13.993 | 4979.9 samples/s | 77.8 steps/s
[Step=26100 Epoch=127.4] | Loss=0.04248 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.228 | L2-Norm(final)=14.012 | 5611.8 samples/s | 87.7 steps/s
[Step=26150 Epoch=127.6] | Loss=0.04173 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.228 | L2-Norm(final)=14.036 | 5710.4 samples/s | 89.2 steps/s
[Step=26200 Epoch=127.8] | Loss=0.04232 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.228 | L2-Norm(final)=14.061 | 8672.0 samples/s | 135.5 steps/s
[Step=26250 Epoch=128.1] | Loss=0.04137 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.228 | L2-Norm(final)=14.086 | 2402.8 samples/s | 37.5 steps/s
[Step=26300 Epoch=128.3] | Loss=0.04047 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.228 | L2-Norm(final)=14.113 | 5854.4 samples/s | 91.5 steps/s
[Step=26350 Epoch=128.6] | Loss=0.04099 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.228 | L2-Norm(final)=14.139 | 5444.1 samples/s | 85.1 steps/s
[Step=26400 Epoch=128.8] | Loss=0.04125 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.228 | L2-Norm(final)=14.162 | 7822.0 samples/s | 122.2 steps/s
[Step=26450 Epoch=129.1] | Loss=0.04077 | Reg=0.00126 | acc=0.9375 | L2-Norm=11.228 | L2-Norm(final)=14.186 | 2490.7 samples/s | 38.9 steps/s
[Step=26500 Epoch=129.3] | Loss=0.04068 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.228 | L2-Norm(final)=14.210 | 5650.5 samples/s | 88.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=26501 Epoch=129.3] | Loss=0.03687 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.228 | L2-Norm(final)=14.454 | 5811.4 samples/s | 90.8 steps/s
[Step=26550 Epoch=129.6] | Loss=0.05055 | Reg=0.00129 | acc=0.9219 | L2-Norm=11.370 | L2-Norm(final)=14.452 | 4364.6 samples/s | 68.2 steps/s
[Step=26600 Epoch=129.8] | Loss=0.05101 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.505 | L2-Norm(final)=14.433 | 4908.6 samples/s | 76.7 steps/s
[Step=26650 Epoch=130.0] | Loss=0.04661 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.594 | L2-Norm(final)=14.425 | 4871.5 samples/s | 76.1 steps/s
[Step=26700 Epoch=130.3] | Loss=0.04445 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.661 | L2-Norm(final)=14.420 | 6863.0 samples/s | 107.2 steps/s
[Step=26750 Epoch=130.5] | Loss=0.03911 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.713 | L2-Norm(final)=14.417 | 2256.5 samples/s | 35.3 steps/s
[Step=26800 Epoch=130.8] | Loss=0.03523 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.754 | L2-Norm(final)=14.416 | 4899.1 samples/s | 76.5 steps/s
[Step=26850 Epoch=131.0] | Loss=0.03243 | Reg=0.00139 | acc=0.9375 | L2-Norm=11.787 | L2-Norm(final)=14.417 | 4826.2 samples/s | 75.4 steps/s
[Step=26900 Epoch=131.3] | Loss=0.03048 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.816 | L2-Norm(final)=14.418 | 6495.1 samples/s | 101.5 steps/s
[Step=26950 Epoch=131.5] | Loss=0.02812 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.842 | L2-Norm(final)=14.420 | 2305.9 samples/s | 36.0 steps/s
[Step=27000 Epoch=131.7] | Loss=0.02640 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.866 | L2-Norm(final)=14.422 | 4844.6 samples/s | 75.7 steps/s
[Step=27050 Epoch=132.0] | Loss=0.02476 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.886 | L2-Norm(final)=14.424 | 4875.4 samples/s | 76.2 steps/s
[Step=27100 Epoch=132.2] | Loss=0.02367 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.905 | L2-Norm(final)=14.426 | 5991.5 samples/s | 93.6 steps/s
[Step=27150 Epoch=132.5] | Loss=0.02227 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.921 | L2-Norm(final)=14.428 | 2388.9 samples/s | 37.3 steps/s
[Step=27200 Epoch=132.7] | Loss=0.02114 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.935 | L2-Norm(final)=14.430 | 4887.5 samples/s | 76.4 steps/s
[Step=27250 Epoch=133.0] | Loss=0.02028 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.948 | L2-Norm(final)=14.432 | 4861.3 samples/s | 76.0 steps/s
[Step=27300 Epoch=133.2] | Loss=0.01930 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.960 | L2-Norm(final)=14.435 | 5587.0 samples/s | 87.3 steps/s
[Step=27350 Epoch=133.5] | Loss=0.01860 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.971 | L2-Norm(final)=14.437 | 2460.5 samples/s | 38.4 steps/s
[Step=27400 Epoch=133.7] | Loss=0.01792 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.981 | L2-Norm(final)=14.439 | 4892.1 samples/s | 76.4 steps/s
[Step=27450 Epoch=133.9] | Loss=0.01729 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.990 | L2-Norm(final)=14.441 | 4870.7 samples/s | 76.1 steps/s
[Step=27500 Epoch=134.2] | Loss=0.01671 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.999 | L2-Norm(final)=14.443 | 5246.1 samples/s | 82.0 steps/s
[Step=27550 Epoch=134.4] | Loss=0.01625 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.008 | L2-Norm(final)=14.445 | 2523.2 samples/s | 39.4 steps/s
[Step=27600 Epoch=134.7] | Loss=0.01570 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.016 | L2-Norm(final)=14.447 | 4892.3 samples/s | 76.4 steps/s
[Step=27650 Epoch=134.9] | Loss=0.01523 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.024 | L2-Norm(final)=14.449 | 4962.9 samples/s | 77.5 steps/s
[Step=27700 Epoch=135.2] | Loss=0.01487 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.031 | L2-Norm(final)=14.451 | 4863.1 samples/s | 76.0 steps/s
[Step=27750 Epoch=135.4] | Loss=0.01440 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.039 | L2-Norm(final)=14.454 | 2594.7 samples/s | 40.5 steps/s
[Step=27800 Epoch=135.7] | Loss=0.01401 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.046 | L2-Norm(final)=14.456 | 4826.4 samples/s | 75.4 steps/s
[Step=27850 Epoch=135.9] | Loss=0.01372 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.053 | L2-Norm(final)=14.458 | 4865.2 samples/s | 76.0 steps/s
[Step=27900 Epoch=136.1] | Loss=0.01336 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.060 | L2-Norm(final)=14.460 | 4921.4 samples/s | 76.9 steps/s
[Step=27950 Epoch=136.4] | Loss=0.01310 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.066 | L2-Norm(final)=14.462 | 2632.8 samples/s | 41.1 steps/s
[Step=28000 Epoch=136.6] | Loss=0.01294 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.072 | L2-Norm(final)=14.464 | 4904.4 samples/s | 76.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step28000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=87.7] | Loss=0.05175 | Reg=0.00126 | acc=0.9375 | L2-Norm=11.228 | L2-Norm(final)=12.825 | 6079.2 samples/s | 95.0 steps/s
[Step=18050 Epoch=87.9] | Loss=0.04601 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.228 | L2-Norm(final)=12.834 | 4750.8 samples/s | 74.2 steps/s
[Step=18100 Epoch=88.2] | Loss=0.04133 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.228 | L2-Norm(final)=12.856 | 5752.3 samples/s | 89.9 steps/s
[Step=18150 Epoch=88.4] | Loss=0.04140 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.228 | L2-Norm(final)=12.882 | 5425.5 samples/s | 84.8 steps/s
[Step=18200 Epoch=88.7] | Loss=0.04107 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.228 | L2-Norm(final)=12.908 | 8740.5 samples/s | 136.6 steps/s
[Step=18250 Epoch=88.9] | Loss=0.04118 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.228 | L2-Norm(final)=12.931 | 2436.3 samples/s | 38.1 steps/s
[Step=18300 Epoch=89.2] | Loss=0.04115 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.228 | L2-Norm(final)=12.952 | 5572.5 samples/s | 87.1 steps/s
[Step=18350 Epoch=89.4] | Loss=0.04141 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.228 | L2-Norm(final)=12.972 | 5578.6 samples/s | 87.2 steps/s
[Step=18400 Epoch=89.7] | Loss=0.04038 | Reg=0.00126 | acc=0.9375 | L2-Norm=11.228 | L2-Norm(final)=12.993 | 7771.3 samples/s | 121.4 steps/s
[Step=18450 Epoch=89.9] | Loss=0.04079 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.228 | L2-Norm(final)=13.015 | 2497.2 samples/s | 39.0 steps/s
[Step=18500 Epoch=90.1] | Loss=0.04103 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.228 | L2-Norm(final)=13.035 | 5729.5 samples/s | 89.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=90.1] | Loss=0.04874 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.228 | L2-Norm(final)=13.227 | 6001.9 samples/s | 93.8 steps/s
[Step=18550 Epoch=90.4] | Loss=0.04543 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.375 | L2-Norm(final)=13.224 | 4456.8 samples/s | 69.6 steps/s
[Step=18600 Epoch=90.6] | Loss=0.04633 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.483 | L2-Norm(final)=13.210 | 4876.7 samples/s | 76.2 steps/s
[Step=18650 Epoch=90.9] | Loss=0.04460 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.556 | L2-Norm(final)=13.203 | 4835.1 samples/s | 75.5 steps/s
[Step=18700 Epoch=91.1] | Loss=0.04054 | Reg=0.00135 | acc=0.9531 | L2-Norm=11.611 | L2-Norm(final)=13.200 | 6897.2 samples/s | 107.8 steps/s
[Step=18750 Epoch=91.4] | Loss=0.03598 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.655 | L2-Norm(final)=13.200 | 2293.1 samples/s | 35.8 steps/s
[Step=18800 Epoch=91.6] | Loss=0.03245 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.692 | L2-Norm(final)=13.202 | 4863.3 samples/s | 76.0 steps/s
[Step=18850 Epoch=91.8] | Loss=0.03022 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.724 | L2-Norm(final)=13.204 | 4837.0 samples/s | 75.6 steps/s
[Step=18900 Epoch=92.1] | Loss=0.02840 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.751 | L2-Norm(final)=13.206 | 6286.3 samples/s | 98.2 steps/s
[Step=18950 Epoch=92.3] | Loss=0.02676 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.777 | L2-Norm(final)=13.208 | 2353.8 samples/s | 36.8 steps/s
[Step=19000 Epoch=92.6] | Loss=0.02498 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.801 | L2-Norm(final)=13.210 | 4882.7 samples/s | 76.3 steps/s
[Step=19050 Epoch=92.8] | Loss=0.02358 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.823 | L2-Norm(final)=13.213 | 4819.7 samples/s | 75.3 steps/s
[Step=19100 Epoch=93.1] | Loss=0.02309 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.842 | L2-Norm(final)=13.215 | 5832.1 samples/s | 91.1 steps/s
[Step=19150 Epoch=93.3] | Loss=0.02196 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.860 | L2-Norm(final)=13.216 | 2420.6 samples/s | 37.8 steps/s
[Step=19200 Epoch=93.6] | Loss=0.02080 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.877 | L2-Norm(final)=13.219 | 4860.3 samples/s | 75.9 steps/s
[Step=19250 Epoch=93.8] | Loss=0.01988 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.892 | L2-Norm(final)=13.221 | 4875.9 samples/s | 76.2 steps/s
[Step=19300 Epoch=94.0] | Loss=0.01917 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.907 | L2-Norm(final)=13.224 | 5330.0 samples/s | 83.3 steps/s
[Step=19350 Epoch=94.3] | Loss=0.01859 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.922 | L2-Norm(final)=13.227 | 2514.1 samples/s | 39.3 steps/s
[Step=19400 Epoch=94.5] | Loss=0.01805 | Reg=0.00143 | acc=0.9531 | L2-Norm=11.936 | L2-Norm(final)=13.229 | 4887.4 samples/s | 76.4 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01747 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.949 | L2-Norm(final)=13.232 | 4925.5 samples/s | 77.0 steps/s
[Step=19500 Epoch=95.0] | Loss=0.01695 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.961 | L2-Norm(final)=13.234 | 4908.1 samples/s | 76.7 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01646 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=13.237 | 2591.5 samples/s | 40.5 steps/s
[Step=19600 Epoch=95.5] | Loss=0.01601 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.983 | L2-Norm(final)=13.240 | 4839.4 samples/s | 75.6 steps/s
[Step=19650 Epoch=95.7] | Loss=0.01547 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.993 | L2-Norm(final)=13.242 | 4854.7 samples/s | 75.9 steps/s
[Step=19700 Epoch=96.0] | Loss=0.01501 | Reg=0.00144 | acc=0.9688 | L2-Norm=12.002 | L2-Norm(final)=13.245 | 4900.1 samples/s | 76.6 steps/s
[Step=19750 Epoch=96.2] | Loss=0.01462 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.011 | L2-Norm(final)=13.248 | 2646.5 samples/s | 41.4 steps/s
[Step=19800 Epoch=96.5] | Loss=0.01425 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.018 | L2-Norm(final)=13.251 | 4890.5 samples/s | 76.4 steps/s
[Step=19850 Epoch=96.7] | Loss=0.01392 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.026 | L2-Norm(final)=13.253 | 4848.9 samples/s | 75.8 steps/s
[Step=19900 Epoch=97.0] | Loss=0.01362 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.033 | L2-Norm(final)=13.255 | 4911.5 samples/s | 76.7 steps/s
[Step=19950 Epoch=97.2] | Loss=0.01336 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.040 | L2-Norm(final)=13.257 | 2610.7 samples/s | 40.8 steps/s
[Step=20000 Epoch=97.4] | Loss=0.01302 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.046 | L2-Norm(final)=13.259 | 4865.8 samples/s | 76.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step20000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=24001 Epoch=117.7] | Loss=0.02467 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.228 | L2-Norm(final)=14.178 | 5652.6 samples/s | 88.3 steps/s
[Step=24050 Epoch=117.9] | Loss=0.03918 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.229 | L2-Norm(final)=14.196 | 4809.7 samples/s | 75.2 steps/s
[Step=24100 Epoch=118.2] | Loss=0.03915 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.229 | L2-Norm(final)=14.224 | 5679.3 samples/s | 88.7 steps/s
[Step=24150 Epoch=118.4] | Loss=0.03931 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.229 | L2-Norm(final)=14.246 | 5498.8 samples/s | 85.9 steps/s
[Step=24200 Epoch=118.7] | Loss=0.03826 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.229 | L2-Norm(final)=14.267 | 9047.0 samples/s | 141.4 steps/s
[Step=24250 Epoch=118.9] | Loss=0.03893 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.229 | L2-Norm(final)=14.285 | 2369.0 samples/s | 37.0 steps/s
[Step=24300 Epoch=119.2] | Loss=0.03834 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.229 | L2-Norm(final)=14.304 | 5617.2 samples/s | 87.8 steps/s
[Step=24350 Epoch=119.4] | Loss=0.03784 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.229 | L2-Norm(final)=14.324 | 5580.2 samples/s | 87.2 steps/s
[Step=24400 Epoch=119.7] | Loss=0.03849 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.229 | L2-Norm(final)=14.343 | 8314.9 samples/s | 129.9 steps/s
[Step=24450 Epoch=119.9] | Loss=0.03788 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.229 | L2-Norm(final)=14.361 | 2443.6 samples/s | 38.2 steps/s
[Step=24500 Epoch=120.1] | Loss=0.03803 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.229 | L2-Norm(final)=14.379 | 5634.0 samples/s | 88.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=120.1] | Loss=0.03318 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.229 | L2-Norm(final)=14.570 | 5750.4 samples/s | 89.9 steps/s
[Step=24550 Epoch=120.4] | Loss=0.04840 | Reg=0.00129 | acc=0.9531 | L2-Norm=11.357 | L2-Norm(final)=14.556 | 4518.9 samples/s | 70.6 steps/s
[Step=24600 Epoch=120.6] | Loss=0.04804 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.469 | L2-Norm(final)=14.538 | 4867.7 samples/s | 76.1 steps/s
[Step=24650 Epoch=120.9] | Loss=0.04285 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.547 | L2-Norm(final)=14.527 | 4794.3 samples/s | 74.9 steps/s
[Step=24700 Epoch=121.1] | Loss=0.04007 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.603 | L2-Norm(final)=14.521 | 7167.6 samples/s | 112.0 steps/s
[Step=24750 Epoch=121.4] | Loss=0.03561 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.648 | L2-Norm(final)=14.517 | 2259.1 samples/s | 35.3 steps/s
[Step=24800 Epoch=121.6] | Loss=0.03287 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.685 | L2-Norm(final)=14.516 | 4871.5 samples/s | 76.1 steps/s
[Step=24850 Epoch=121.9] | Loss=0.03054 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.717 | L2-Norm(final)=14.514 | 4846.4 samples/s | 75.7 steps/s
[Step=24900 Epoch=122.1] | Loss=0.02843 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.746 | L2-Norm(final)=14.514 | 6706.7 samples/s | 104.8 steps/s
[Step=24950 Epoch=122.4] | Loss=0.02669 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.771 | L2-Norm(final)=14.514 | 2302.0 samples/s | 36.0 steps/s
[Step=25000 Epoch=122.6] | Loss=0.02517 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.794 | L2-Norm(final)=14.515 | 4871.9 samples/s | 76.1 steps/s
[Step=25050 Epoch=122.8] | Loss=0.02352 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.813 | L2-Norm(final)=14.516 | 4865.9 samples/s | 76.0 steps/s
[Step=25100 Epoch=123.1] | Loss=0.02228 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.831 | L2-Norm(final)=14.518 | 6242.4 samples/s | 97.5 steps/s
[Step=25150 Epoch=123.3] | Loss=0.02135 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.847 | L2-Norm(final)=14.519 | 2352.7 samples/s | 36.8 steps/s
[Step=25200 Epoch=123.6] | Loss=0.02023 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.863 | L2-Norm(final)=14.520 | 4848.5 samples/s | 75.8 steps/s
[Step=25250 Epoch=123.8] | Loss=0.01929 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.876 | L2-Norm(final)=14.522 | 4845.3 samples/s | 75.7 steps/s
[Step=25300 Epoch=124.1] | Loss=0.01863 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.888 | L2-Norm(final)=14.524 | 5921.4 samples/s | 92.5 steps/s
[Step=25350 Epoch=124.3] | Loss=0.01807 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.900 | L2-Norm(final)=14.525 | 2387.5 samples/s | 37.3 steps/s
[Step=25400 Epoch=124.6] | Loss=0.01737 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.910 | L2-Norm(final)=14.527 | 4950.7 samples/s | 77.4 steps/s
[Step=25450 Epoch=124.8] | Loss=0.01677 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.920 | L2-Norm(final)=14.528 | 4854.8 samples/s | 75.9 steps/s
[Step=25500 Epoch=125.0] | Loss=0.01631 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.929 | L2-Norm(final)=14.530 | 5544.4 samples/s | 86.6 steps/s
[Step=25550 Epoch=125.3] | Loss=0.01590 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.937 | L2-Norm(final)=14.531 | 2450.2 samples/s | 38.3 steps/s
[Step=25600 Epoch=125.5] | Loss=0.01537 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.946 | L2-Norm(final)=14.532 | 4928.7 samples/s | 77.0 steps/s
[Step=25650 Epoch=125.8] | Loss=0.01504 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.953 | L2-Norm(final)=14.534 | 4786.9 samples/s | 74.8 steps/s
[Step=25700 Epoch=126.0] | Loss=0.01464 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.961 | L2-Norm(final)=14.535 | 5331.9 samples/s | 83.3 steps/s
[Step=25750 Epoch=126.3] | Loss=0.01426 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.968 | L2-Norm(final)=14.536 | 2432.1 samples/s | 38.0 steps/s
[Step=25800 Epoch=126.5] | Loss=0.01385 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.974 | L2-Norm(final)=14.538 | 4861.1 samples/s | 76.0 steps/s
[Step=25850 Epoch=126.8] | Loss=0.01354 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.981 | L2-Norm(final)=14.540 | 4843.8 samples/s | 75.7 steps/s
[Step=25900 Epoch=127.0] | Loss=0.01318 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.988 | L2-Norm(final)=14.541 | 5096.8 samples/s | 79.6 steps/s
[Step=25950 Epoch=127.3] | Loss=0.01287 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.994 | L2-Norm(final)=14.543 | 2586.9 samples/s | 40.4 steps/s
[Step=26000 Epoch=127.5] | Loss=0.01270 | Reg=0.00144 | acc=0.9688 | L2-Norm=11.999 | L2-Norm(final)=14.545 | 4926.2 samples/s | 77.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step26000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=152.2] | Loss=0.00138 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.228 | L2-Norm(final)=12.229 | 6439.8 samples/s | 100.6 steps/s
[Step=16050 Epoch=152.7] | Loss=0.00377 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=12.260 | 4560.5 samples/s | 71.3 steps/s
[Step=16100 Epoch=153.2] | Loss=0.00458 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=12.299 | 7875.0 samples/s | 123.0 steps/s
[Step=16150 Epoch=153.6] | Loss=0.00418 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=12.339 | 2356.8 samples/s | 36.8 steps/s
[Step=16200 Epoch=154.1] | Loss=0.00460 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=12.379 | 7125.9 samples/s | 111.3 steps/s
[Step=16250 Epoch=154.6] | Loss=0.00460 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=12.417 | 2443.9 samples/s | 38.2 steps/s
[Step=16300 Epoch=155.1] | Loss=0.00438 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=12.456 | 6552.7 samples/s | 102.4 steps/s
[Step=16350 Epoch=155.5] | Loss=0.00443 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=12.494 | 2542.3 samples/s | 39.7 steps/s
[Step=16400 Epoch=156.0] | Loss=0.00437 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=12.531 | 6014.1 samples/s | 94.0 steps/s
[Step=16450 Epoch=156.5] | Loss=0.00439 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=12.568 | 2630.1 samples/s | 41.1 steps/s
[Step=16500 Epoch=157.0] | Loss=0.00432 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=12.604 | 5479.7 samples/s | 85.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=157.0] | Loss=0.00244 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.223 | L2-Norm(final)=12.964 | 5771.3 samples/s | 90.2 steps/s
[Step=16550 Epoch=157.4] | Loss=0.00197 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.337 | L2-Norm(final)=12.985 | 4131.6 samples/s | 64.6 steps/s
[Step=16600 Epoch=157.9] | Loss=0.00179 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.414 | L2-Norm(final)=12.991 | 6716.0 samples/s | 104.9 steps/s
[Step=16650 Epoch=158.4] | Loss=0.00220 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.484 | L2-Norm(final)=12.986 | 2217.8 samples/s | 34.7 steps/s
[Step=16700 Epoch=158.9] | Loss=0.00192 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.530 | L2-Norm(final)=12.984 | 5979.4 samples/s | 93.4 steps/s
[Step=16750 Epoch=159.3] | Loss=0.00240 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.572 | L2-Norm(final)=12.980 | 2289.3 samples/s | 35.8 steps/s
[Step=16800 Epoch=159.8] | Loss=0.00216 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.615 | L2-Norm(final)=12.974 | 5495.0 samples/s | 85.9 steps/s
[Step=16850 Epoch=160.3] | Loss=0.00199 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.645 | L2-Norm(final)=12.970 | 2340.3 samples/s | 36.6 steps/s
[Step=16900 Epoch=160.8] | Loss=0.00175 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.666 | L2-Norm(final)=12.966 | 5132.9 samples/s | 80.2 steps/s
[Step=16950 Epoch=161.2] | Loss=0.00155 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.679 | L2-Norm(final)=12.964 | 2439.6 samples/s | 38.1 steps/s
[Step=17000 Epoch=161.7] | Loss=0.00140 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.686 | L2-Norm(final)=12.962 | 4754.0 samples/s | 74.3 steps/s
[Step=17050 Epoch=162.2] | Loss=0.00127 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.690 | L2-Norm(final)=12.961 | 2525.3 samples/s | 39.5 steps/s
[Step=17100 Epoch=162.7] | Loss=0.00117 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.691 | L2-Norm(final)=12.960 | 4586.4 samples/s | 71.7 steps/s
[Step=17150 Epoch=163.1] | Loss=0.00108 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.690 | L2-Norm(final)=12.959 | 2636.0 samples/s | 41.2 steps/s
[Step=17200 Epoch=163.6] | Loss=0.00100 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.687 | L2-Norm(final)=12.959 | 4674.0 samples/s | 73.0 steps/s
[Step=17250 Epoch=164.1] | Loss=0.00094 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=12.958 | 2563.6 samples/s | 40.1 steps/s
[Step=17300 Epoch=164.6] | Loss=0.00088 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.678 | L2-Norm(final)=12.958 | 4645.4 samples/s | 72.6 steps/s
[Step=17350 Epoch=165.0] | Loss=0.00083 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.672 | L2-Norm(final)=12.958 | 2795.7 samples/s | 43.7 steps/s
[Step=17400 Epoch=165.5] | Loss=0.00078 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.666 | L2-Norm(final)=12.957 | 4174.6 samples/s | 65.2 steps/s
[Step=17450 Epoch=166.0] | Loss=0.00074 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.659 | L2-Norm(final)=12.957 | 6866.8 samples/s | 107.3 steps/s
[Step=17500 Epoch=166.5] | Loss=0.00070 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.651 | L2-Norm(final)=12.957 | 2175.5 samples/s | 34.0 steps/s
[Step=17550 Epoch=166.9] | Loss=0.00067 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.643 | L2-Norm(final)=12.957 | 6244.0 samples/s | 97.6 steps/s
[Step=17600 Epoch=167.4] | Loss=0.00064 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.635 | L2-Norm(final)=12.957 | 2254.9 samples/s | 35.2 steps/s
[Step=17650 Epoch=167.9] | Loss=0.00061 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.627 | L2-Norm(final)=12.957 | 5739.2 samples/s | 89.7 steps/s
[Step=17700 Epoch=168.4] | Loss=0.00059 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.618 | L2-Norm(final)=12.957 | 2324.3 samples/s | 36.3 steps/s
[Step=17750 Epoch=168.8] | Loss=0.00056 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.609 | L2-Norm(final)=12.957 | 5288.5 samples/s | 82.6 steps/s
[Step=17800 Epoch=169.3] | Loss=0.00054 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.600 | L2-Norm(final)=12.958 | 2421.2 samples/s | 37.8 steps/s
[Step=17850 Epoch=169.8] | Loss=0.00052 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.591 | L2-Norm(final)=12.958 | 4869.2 samples/s | 76.1 steps/s
[Step=17900 Epoch=170.3] | Loss=0.00050 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=12.958 | 2490.4 samples/s | 38.9 steps/s
[Step=17950 Epoch=170.7] | Loss=0.00049 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.572 | L2-Norm(final)=12.958 | 4646.1 samples/s | 72.6 steps/s
[Step=18000 Epoch=171.2] | Loss=0.00047 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.562 | L2-Norm(final)=12.958 | 2597.8 samples/s | 40.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step18000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11061 | acc=0.9563 | tpr=0.9744 | fpr=0.0833 | 5607.1 samples/s | 21.9 steps/s
Avg test loss: 0.11709, Avg test acc: 0.95376, Avg tpr: 0.97266, Avg fpr: 0.08781, total FA: 685

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.12460 | acc=0.9466 | tpr=0.9548 | fpr=0.0714 | 5662.0 samples/s | 22.1 steps/s
Avg test loss: 0.13045, Avg test acc: 0.94695, Avg tpr: 0.95436, Avg fpr: 0.06935, total FA: 541

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.12957 | acc=0.9555 | tpr=0.9676 | fpr=0.0709 | 5761.3 samples/s | 22.5 steps/s
Avg test loss: 0.13292, Avg test acc: 0.95388, Avg tpr: 0.96596, Avg fpr: 0.07268, total FA: 567

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10976 | acc=0.9530 | tpr=0.9708 | fpr=0.0855 | 5715.4 samples/s | 22.3 steps/s
Avg test loss: 0.11888, Avg test acc: 0.95076, Avg tpr: 0.96864, Avg fpr: 0.08858, total FA: 691

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10714 | acc=0.9508 | tpr=0.9613 | fpr=0.0721 | 5536.4 samples/s | 21.6 steps/s
Avg test loss: 0.11366, Avg test acc: 0.95204, Avg tpr: 0.96124, Avg fpr: 0.06820, total FA: 532

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.16546 | acc=0.2997 | tpr=0.0050 | fpr=0.0605 | 5672.2 samples/s | 22.2 steps/s
Avg test loss: 5.17263, Avg test acc: 0.29714, Avg tpr: 0.00460, Avg fpr: 0.05948, total FA: 464

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.74378 | acc=0.3037 | tpr=0.0056 | fpr=0.0491 | 5859.8 samples/s | 22.9 steps/s
Avg test loss: 4.77364, Avg test acc: 0.30111, Avg tpr: 0.00513, Avg fpr: 0.04794, total FA: 374

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.52977 | acc=0.2860 | tpr=0.0176 | fpr=0.1311 | 5970.1 samples/s | 23.3 steps/s
Avg test loss: 5.52678, Avg test acc: 0.28568, Avg tpr: 0.01789, Avg fpr: 0.12537, total FA: 978

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.71897 | acc=0.2923 | tpr=0.0169 | fpr=0.1095 | 5672.0 samples/s | 22.2 steps/s
Avg test loss: 4.72579, Avg test acc: 0.29161, Avg tpr: 0.01708, Avg fpr: 0.10460, total FA: 816

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.09458 | acc=0.2980 | tpr=0.0144 | fpr=0.0862 | 5506.6 samples/s | 21.5 steps/s
Avg test loss: 5.11129, Avg test acc: 0.29578, Avg tpr: 0.01515, Avg fpr: 0.08704, total FA: 679

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.14756 | acc=0.1296 | tpr=0.3628 | fpr=0.8746 | 5771.6 samples/s | 22.5 steps/s
[Step= 100] | Loss=6.10270 | acc=0.1296 | tpr=0.3241 | fpr=0.8740 | 7745.3 samples/s | 30.3 steps/s
[Step= 150] | Loss=6.11391 | acc=0.1289 | tpr=0.3228 | fpr=0.8746 | 7853.6 samples/s | 30.7 steps/s
[Step= 200] | Loss=6.10875 | acc=0.1290 | tpr=0.3191 | fpr=0.8744 | 8189.7 samples/s | 32.0 steps/s
[Step= 250] | Loss=6.11095 | acc=0.1292 | tpr=0.3301 | fpr=0.8745 | 7849.9 samples/s | 30.7 steps/s
[Step= 300] | Loss=6.10822 | acc=0.1286 | tpr=0.3258 | fpr=0.8750 | 8352.8 samples/s | 32.6 steps/s
[Step= 350] | Loss=6.10818 | acc=0.1281 | tpr=0.3131 | fpr=0.8753 | 7781.6 samples/s | 30.4 steps/s
[Step= 400] | Loss=6.10527 | acc=0.1285 | tpr=0.3129 | fpr=0.8748 | 8432.6 samples/s | 32.9 steps/s
[Step= 450] | Loss=6.10610 | acc=0.1288 | tpr=0.3165 | fpr=0.8746 | 7892.2 samples/s | 30.8 steps/s
[Step= 500] | Loss=6.10876 | acc=0.1291 | tpr=0.3154 | fpr=0.8743 | 7840.7 samples/s | 30.6 steps/s
[Step= 550] | Loss=6.10600 | acc=0.1289 | tpr=0.3084 | fpr=0.8744 | 10988.8 samples/s | 42.9 steps/s
Avg test loss: 6.10619, Avg test acc: 0.12877, Avg tpr: 0.30824, Avg fpr: 0.87449, total FA: 121421

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.15720 | acc=0.1521 | tpr=0.1637 | fpr=0.8481 | 5552.8 samples/s | 21.7 steps/s
[Step= 100] | Loss=5.12380 | acc=0.1537 | tpr=0.1301 | fpr=0.8458 | 8316.3 samples/s | 32.5 steps/s
[Step= 150] | Loss=5.12497 | acc=0.1529 | tpr=0.1268 | fpr=0.8466 | 8009.3 samples/s | 31.3 steps/s
[Step= 200] | Loss=5.12657 | acc=0.1529 | tpr=0.1279 | fpr=0.8467 | 8281.6 samples/s | 32.4 steps/s
[Step= 250] | Loss=5.13037 | acc=0.1522 | tpr=0.1275 | fpr=0.8473 | 7691.7 samples/s | 30.0 steps/s
[Step= 300] | Loss=5.13246 | acc=0.1513 | tpr=0.1367 | fpr=0.8485 | 7839.5 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.13141 | acc=0.1504 | tpr=0.1309 | fpr=0.8492 | 8373.4 samples/s | 32.7 steps/s
[Step= 400] | Loss=5.13012 | acc=0.1514 | tpr=0.1313 | fpr=0.8482 | 8045.5 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.13306 | acc=0.1513 | tpr=0.1285 | fpr=0.8482 | 7941.6 samples/s | 31.0 steps/s
[Step= 500] | Loss=5.13249 | acc=0.1514 | tpr=0.1256 | fpr=0.8482 | 7727.8 samples/s | 30.2 steps/s
[Step= 550] | Loss=5.13323 | acc=0.1515 | tpr=0.1257 | fpr=0.8480 | 10851.1 samples/s | 42.4 steps/s
Avg test loss: 5.13326, Avg test acc: 0.15138, Avg tpr: 0.12559, Avg fpr: 0.84815, total FA: 117764

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=7.11695 | acc=0.1148 | tpr=0.2345 | fpr=0.8874 | 5774.5 samples/s | 22.6 steps/s
[Step= 100] | Loss=7.04247 | acc=0.1160 | tpr=0.1983 | fpr=0.8856 | 7819.5 samples/s | 30.5 steps/s
[Step= 150] | Loss=7.05138 | acc=0.1167 | tpr=0.2003 | fpr=0.8848 | 7919.9 samples/s | 30.9 steps/s
[Step= 200] | Loss=7.03733 | acc=0.1167 | tpr=0.1825 | fpr=0.8845 | 8550.8 samples/s | 33.4 steps/s
[Step= 250] | Loss=7.03739 | acc=0.1174 | tpr=0.1869 | fpr=0.8839 | 7816.1 samples/s | 30.5 steps/s
[Step= 300] | Loss=7.04466 | acc=0.1170 | tpr=0.1913 | fpr=0.8843 | 7664.3 samples/s | 29.9 steps/s
[Step= 350] | Loss=7.04976 | acc=0.1161 | tpr=0.1841 | fpr=0.8852 | 8707.3 samples/s | 34.0 steps/s
[Step= 400] | Loss=7.04517 | acc=0.1166 | tpr=0.1887 | fpr=0.8847 | 7643.5 samples/s | 29.9 steps/s
[Step= 450] | Loss=7.04514 | acc=0.1164 | tpr=0.1840 | fpr=0.8848 | 8741.1 samples/s | 34.1 steps/s
[Step= 500] | Loss=7.04763 | acc=0.1162 | tpr=0.1850 | fpr=0.8850 | 7989.7 samples/s | 31.2 steps/s
[Step= 550] | Loss=7.04461 | acc=0.1164 | tpr=0.1854 | fpr=0.8848 | 9926.6 samples/s | 38.8 steps/s
Avg test loss: 7.04365, Avg test acc: 0.11630, Avg tpr: 0.18542, Avg fpr: 0.88495, total FA: 122874

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.36418 | acc=0.1408 | tpr=0.2212 | fpr=0.8607 | 5689.2 samples/s | 22.2 steps/s
[Step= 100] | Loss=6.33414 | acc=0.1400 | tpr=0.2111 | fpr=0.8613 | 8122.9 samples/s | 31.7 steps/s
[Step= 150] | Loss=6.33109 | acc=0.1392 | tpr=0.2003 | fpr=0.8620 | 7997.4 samples/s | 31.2 steps/s
[Step= 200] | Loss=6.32443 | acc=0.1395 | tpr=0.2022 | fpr=0.8616 | 7962.8 samples/s | 31.1 steps/s
[Step= 250] | Loss=6.33303 | acc=0.1396 | tpr=0.2044 | fpr=0.8616 | 7202.9 samples/s | 28.1 steps/s
[Step= 300] | Loss=6.33834 | acc=0.1390 | tpr=0.2095 | fpr=0.8623 | 8210.8 samples/s | 32.1 steps/s
[Step= 350] | Loss=6.34050 | acc=0.1384 | tpr=0.1966 | fpr=0.8626 | 8616.8 samples/s | 33.7 steps/s
[Step= 400] | Loss=6.33669 | acc=0.1391 | tpr=0.1975 | fpr=0.8620 | 7869.5 samples/s | 30.7 steps/s
[Step= 450] | Loss=6.33432 | acc=0.1391 | tpr=0.1991 | fpr=0.8620 | 8317.1 samples/s | 32.5 steps/s
[Step= 500] | Loss=6.33453 | acc=0.1389 | tpr=0.1982 | fpr=0.8622 | 8144.9 samples/s | 31.8 steps/s
[Step= 550] | Loss=6.33302 | acc=0.1391 | tpr=0.1970 | fpr=0.8620 | 10318.4 samples/s | 40.3 steps/s
Avg test loss: 6.33317, Avg test acc: 0.13904, Avg tpr: 0.19731, Avg fpr: 0.86202, total FA: 119690

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.92210 | acc=0.1354 | tpr=0.1991 | fpr=0.8658 | 5730.4 samples/s | 22.4 steps/s
[Step= 100] | Loss=5.86067 | acc=0.1369 | tpr=0.1706 | fpr=0.8637 | 7715.6 samples/s | 30.1 steps/s
[Step= 150] | Loss=5.87004 | acc=0.1348 | tpr=0.1643 | fpr=0.8657 | 8278.9 samples/s | 32.3 steps/s
[Step= 200] | Loss=5.86573 | acc=0.1359 | tpr=0.1574 | fpr=0.8645 | 8118.5 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.87599 | acc=0.1356 | tpr=0.1555 | fpr=0.8648 | 7729.9 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.87663 | acc=0.1351 | tpr=0.1549 | fpr=0.8652 | 8104.8 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.88345 | acc=0.1347 | tpr=0.1497 | fpr=0.8656 | 8038.9 samples/s | 31.4 steps/s
[Step= 400] | Loss=5.87723 | acc=0.1356 | tpr=0.1472 | fpr=0.8646 | 8408.0 samples/s | 32.8 steps/s
[Step= 450] | Loss=5.87599 | acc=0.1356 | tpr=0.1470 | fpr=0.8646 | 8248.0 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.87792 | acc=0.1352 | tpr=0.1485 | fpr=0.8650 | 7625.3 samples/s | 29.8 steps/s
[Step= 550] | Loss=5.87398 | acc=0.1352 | tpr=0.1468 | fpr=0.8650 | 10738.1 samples/s | 41.9 steps/s
Avg test loss: 5.87390, Avg test acc: 0.13509, Avg tpr: 0.14739, Avg fpr: 0.86513, total FA: 120122

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08780 | acc=0.9840 | tpr=0.8982 | fpr=0.0145 | 5633.5 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.09346 | acc=0.9839 | tpr=0.9190 | fpr=0.0149 | 8219.2 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.09664 | acc=0.9834 | tpr=0.9265 | fpr=0.0155 | 7365.9 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.09781 | acc=0.9834 | tpr=0.9279 | fpr=0.0156 | 8515.1 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.09827 | acc=0.9833 | tpr=0.9170 | fpr=0.0155 | 7830.0 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.09928 | acc=0.9830 | tpr=0.9156 | fpr=0.0158 | 7827.6 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.09953 | acc=0.9829 | tpr=0.9173 | fpr=0.0159 | 8445.3 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.10044 | acc=0.9828 | tpr=0.9125 | fpr=0.0159 | 8205.0 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.10243 | acc=0.9826 | tpr=0.9124 | fpr=0.0162 | 8377.9 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.10153 | acc=0.9828 | tpr=0.9167 | fpr=0.0161 | 7802.0 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.10069 | acc=0.9829 | tpr=0.9172 | fpr=0.0160 | 10472.6 samples/s | 40.9 steps/s
Avg test loss: 0.10053, Avg test acc: 0.98287, Avg tpr: 0.91680, Avg fpr: 0.01593, total FA: 2212

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08020 | acc=0.9834 | tpr=0.8850 | fpr=0.0149 | 5850.6 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.08469 | acc=0.9830 | tpr=0.8934 | fpr=0.0153 | 7568.6 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.08771 | acc=0.9822 | tpr=0.8991 | fpr=0.0163 | 8027.1 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.08839 | acc=0.9824 | tpr=0.9060 | fpr=0.0162 | 8284.4 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.08807 | acc=0.9825 | tpr=0.9013 | fpr=0.0160 | 8463.7 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.08900 | acc=0.9823 | tpr=0.9047 | fpr=0.0163 | 7887.4 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.08974 | acc=0.9823 | tpr=0.9054 | fpr=0.0163 | 8658.9 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.09013 | acc=0.9823 | tpr=0.9059 | fpr=0.0163 | 7224.5 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.09201 | acc=0.9821 | tpr=0.9056 | fpr=0.0165 | 8671.5 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.09115 | acc=0.9822 | tpr=0.9084 | fpr=0.0164 | 7881.7 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.09065 | acc=0.9823 | tpr=0.9081 | fpr=0.0163 | 9576.5 samples/s | 37.4 steps/s
Avg test loss: 0.09044, Avg test acc: 0.98233, Avg tpr: 0.90808, Avg fpr: 0.01632, total FA: 2266

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10566 | acc=0.9791 | tpr=0.9381 | fpr=0.0201 | 5719.4 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.11036 | acc=0.9784 | tpr=0.9467 | fpr=0.0210 | 7579.8 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.11586 | acc=0.9774 | tpr=0.9467 | fpr=0.0221 | 7412.0 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.11770 | acc=0.9775 | tpr=0.9475 | fpr=0.0219 | 8682.3 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.11845 | acc=0.9774 | tpr=0.9467 | fpr=0.0221 | 8284.3 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.12037 | acc=0.9773 | tpr=0.9389 | fpr=0.0220 | 8810.2 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.12024 | acc=0.9773 | tpr=0.9393 | fpr=0.0220 | 7927.6 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.12101 | acc=0.9770 | tpr=0.9354 | fpr=0.0222 | 7846.2 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.12252 | acc=0.9768 | tpr=0.9314 | fpr=0.0223 | 8025.3 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.12207 | acc=0.9769 | tpr=0.9330 | fpr=0.0223 | 8324.6 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.12122 | acc=0.9770 | tpr=0.9339 | fpr=0.0222 | 9764.7 samples/s | 38.1 steps/s
Avg test loss: 0.12106, Avg test acc: 0.97703, Avg tpr: 0.93344, Avg fpr: 0.02218, total FA: 3080

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09092 | acc=0.9827 | tpr=0.9071 | fpr=0.0159 | 5254.6 samples/s | 20.5 steps/s
[Step= 100] | Loss=0.09442 | acc=0.9822 | tpr=0.9147 | fpr=0.0165 | 8415.2 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.09885 | acc=0.9814 | tpr=0.9207 | fpr=0.0175 | 8552.8 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.10085 | acc=0.9811 | tpr=0.9180 | fpr=0.0177 | 8098.4 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.10080 | acc=0.9812 | tpr=0.9127 | fpr=0.0176 | 7870.5 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.10235 | acc=0.9810 | tpr=0.9135 | fpr=0.0177 | 7984.3 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.10260 | acc=0.9810 | tpr=0.9142 | fpr=0.0178 | 8330.3 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.10309 | acc=0.9809 | tpr=0.9130 | fpr=0.0179 | 7758.0 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.10476 | acc=0.9807 | tpr=0.9119 | fpr=0.0181 | 8283.3 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.10452 | acc=0.9807 | tpr=0.9145 | fpr=0.0181 | 8437.0 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.10397 | acc=0.9807 | tpr=0.9144 | fpr=0.0181 | 9837.9 samples/s | 38.4 steps/s
Avg test loss: 0.10375, Avg test acc: 0.98071, Avg tpr: 0.91403, Avg fpr: 0.01808, total FA: 2510

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12392 | acc=0.9780 | tpr=0.8717 | fpr=0.0200 | 5613.1 samples/s | 21.9 steps/s
[Step= 100] | Loss=0.12622 | acc=0.9789 | tpr=0.9104 | fpr=0.0199 | 8397.3 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.13326 | acc=0.9778 | tpr=0.9179 | fpr=0.0211 | 7427.0 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.13523 | acc=0.9777 | tpr=0.9191 | fpr=0.0212 | 8117.1 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.13382 | acc=0.9777 | tpr=0.9188 | fpr=0.0212 | 8118.2 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.13565 | acc=0.9776 | tpr=0.9215 | fpr=0.0214 | 8453.8 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.13601 | acc=0.9776 | tpr=0.9249 | fpr=0.0215 | 8363.0 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.13708 | acc=0.9773 | tpr=0.9212 | fpr=0.0217 | 7672.9 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.13975 | acc=0.9769 | tpr=0.9192 | fpr=0.0220 | 8342.1 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.13885 | acc=0.9770 | tpr=0.9211 | fpr=0.0220 | 8401.5 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.13774 | acc=0.9772 | tpr=0.9220 | fpr=0.0218 | 9288.4 samples/s | 36.3 steps/s
Avg test loss: 0.13748, Avg test acc: 0.97717, Avg tpr: 0.92155, Avg fpr: 0.02182, total FA: 3029

server round 19/50

clients selected: [1 3 6 7 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=28001 Epoch=136.6] | Loss=0.08853 | Reg=0.00126 | acc=0.8906 | L2-Norm=11.210 | L2-Norm(final)=14.510 | 6281.2 samples/s | 98.1 steps/s
[Step=28050 Epoch=136.9] | Loss=0.03734 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.212 | L2-Norm(final)=14.523 | 4777.8 samples/s | 74.7 steps/s
[Step=28100 Epoch=137.1] | Loss=0.03683 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.213 | L2-Norm(final)=14.555 | 5554.2 samples/s | 86.8 steps/s
[Step=28150 Epoch=137.4] | Loss=0.03710 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.213 | L2-Norm(final)=14.586 | 5650.6 samples/s | 88.3 steps/s
[Step=28200 Epoch=137.6] | Loss=0.03863 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.213 | L2-Norm(final)=14.609 | 8649.1 samples/s | 135.1 steps/s
[Step=28250 Epoch=137.8] | Loss=0.03832 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.213 | L2-Norm(final)=14.631 | 2434.1 samples/s | 38.0 steps/s
[Step=28300 Epoch=138.1] | Loss=0.03906 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.213 | L2-Norm(final)=14.653 | 5585.7 samples/s | 87.3 steps/s
[Step=28350 Epoch=138.3] | Loss=0.03886 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.213 | L2-Norm(final)=14.674 | 5746.8 samples/s | 89.8 steps/s
[Step=28400 Epoch=138.6] | Loss=0.03860 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.213 | L2-Norm(final)=14.696 | 7849.2 samples/s | 122.6 steps/s
[Step=28450 Epoch=138.8] | Loss=0.03854 | Reg=0.00126 | acc=0.9219 | L2-Norm=11.213 | L2-Norm(final)=14.716 | 2486.6 samples/s | 38.9 steps/s
[Step=28500 Epoch=139.1] | Loss=0.03827 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.213 | L2-Norm(final)=14.736 | 5566.2 samples/s | 87.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=28501 Epoch=139.1] | Loss=0.01810 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.213 | L2-Norm(final)=14.943 | 6165.7 samples/s | 96.3 steps/s
[Step=28550 Epoch=139.3] | Loss=0.03541 | Reg=0.00128 | acc=0.9531 | L2-Norm=11.327 | L2-Norm(final)=14.950 | 4214.0 samples/s | 65.8 steps/s
[Step=28600 Epoch=139.6] | Loss=0.04718 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.446 | L2-Norm(final)=14.929 | 4868.5 samples/s | 76.1 steps/s
[Step=28650 Epoch=139.8] | Loss=0.04585 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.528 | L2-Norm(final)=14.913 | 4860.6 samples/s | 75.9 steps/s
[Step=28700 Epoch=140.0] | Loss=0.04131 | Reg=0.00134 | acc=0.9531 | L2-Norm=11.588 | L2-Norm(final)=14.905 | 6877.3 samples/s | 107.5 steps/s
[Step=28750 Epoch=140.3] | Loss=0.03604 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.633 | L2-Norm(final)=14.904 | 2272.1 samples/s | 35.5 steps/s
[Step=28800 Epoch=140.5] | Loss=0.03243 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.666 | L2-Norm(final)=14.904 | 4798.7 samples/s | 75.0 steps/s
[Step=28850 Epoch=140.8] | Loss=0.02995 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.694 | L2-Norm(final)=14.904 | 4844.5 samples/s | 75.7 steps/s
[Step=28900 Epoch=141.0] | Loss=0.02796 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.717 | L2-Norm(final)=14.905 | 6427.3 samples/s | 100.4 steps/s
[Step=28950 Epoch=141.3] | Loss=0.02582 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.737 | L2-Norm(final)=14.907 | 2321.5 samples/s | 36.3 steps/s
[Step=29000 Epoch=141.5] | Loss=0.02412 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.754 | L2-Norm(final)=14.908 | 4839.1 samples/s | 75.6 steps/s
[Step=29050 Epoch=141.8] | Loss=0.02295 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.770 | L2-Norm(final)=14.910 | 4856.9 samples/s | 75.9 steps/s
[Step=29100 Epoch=142.0] | Loss=0.02185 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.783 | L2-Norm(final)=14.912 | 6000.1 samples/s | 93.8 steps/s
[Step=29150 Epoch=142.2] | Loss=0.02080 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.796 | L2-Norm(final)=14.914 | 2408.1 samples/s | 37.6 steps/s
[Step=29200 Epoch=142.5] | Loss=0.01969 | Reg=0.00139 | acc=0.9688 | L2-Norm=11.808 | L2-Norm(final)=14.917 | 4813.3 samples/s | 75.2 steps/s
[Step=29250 Epoch=142.7] | Loss=0.01887 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.819 | L2-Norm(final)=14.919 | 4913.8 samples/s | 76.8 steps/s
[Step=29300 Epoch=143.0] | Loss=0.01827 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.829 | L2-Norm(final)=14.922 | 5543.4 samples/s | 86.6 steps/s
[Step=29350 Epoch=143.2] | Loss=0.01747 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.840 | L2-Norm(final)=14.924 | 2444.9 samples/s | 38.2 steps/s
[Step=29400 Epoch=143.5] | Loss=0.01679 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.849 | L2-Norm(final)=14.926 | 4862.5 samples/s | 76.0 steps/s
[Step=29450 Epoch=143.7] | Loss=0.01620 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.858 | L2-Norm(final)=14.929 | 4878.8 samples/s | 76.2 steps/s
[Step=29500 Epoch=143.9] | Loss=0.01580 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.867 | L2-Norm(final)=14.931 | 5242.0 samples/s | 81.9 steps/s
[Step=29550 Epoch=144.2] | Loss=0.01557 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.875 | L2-Norm(final)=14.933 | 2502.1 samples/s | 39.1 steps/s
[Step=29600 Epoch=144.4] | Loss=0.01514 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.883 | L2-Norm(final)=14.935 | 4886.3 samples/s | 76.3 steps/s
[Step=29650 Epoch=144.7] | Loss=0.01472 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.891 | L2-Norm(final)=14.937 | 4842.4 samples/s | 75.7 steps/s
[Step=29700 Epoch=144.9] | Loss=0.01432 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.899 | L2-Norm(final)=14.939 | 4984.3 samples/s | 77.9 steps/s
[Step=29750 Epoch=145.2] | Loss=0.01395 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.906 | L2-Norm(final)=14.941 | 2616.0 samples/s | 40.9 steps/s
[Step=29800 Epoch=145.4] | Loss=0.01355 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.913 | L2-Norm(final)=14.943 | 4904.4 samples/s | 76.6 steps/s
[Step=29850 Epoch=145.7] | Loss=0.01317 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.920 | L2-Norm(final)=14.946 | 4787.0 samples/s | 74.8 steps/s
[Step=29900 Epoch=145.9] | Loss=0.01285 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.926 | L2-Norm(final)=14.948 | 4860.8 samples/s | 76.0 steps/s
[Step=29950 Epoch=146.1] | Loss=0.01251 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.931 | L2-Norm(final)=14.951 | 2638.4 samples/s | 41.2 steps/s
[Step=30000 Epoch=146.4] | Loss=0.01223 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.936 | L2-Norm(final)=14.953 | 4902.2 samples/s | 76.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step30000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=97.5] | Loss=0.03389 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.210 | L2-Norm(final)=13.924 | 5244.0 samples/s | 81.9 steps/s
[Step=20050 Epoch=97.8] | Loss=0.04076 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.212 | L2-Norm(final)=13.920 | 5319.6 samples/s | 83.1 steps/s
[Step=20100 Epoch=98.0] | Loss=0.04090 | Reg=0.00126 | acc=0.9375 | L2-Norm=11.212 | L2-Norm(final)=13.914 | 5494.2 samples/s | 85.8 steps/s
[Step=20150 Epoch=98.3] | Loss=0.04124 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.212 | L2-Norm(final)=13.915 | 5669.7 samples/s | 88.6 steps/s
[Step=20200 Epoch=98.5] | Loss=0.04105 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.212 | L2-Norm(final)=13.918 | 8661.0 samples/s | 135.3 steps/s
[Step=20250 Epoch=98.8] | Loss=0.04019 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.212 | L2-Norm(final)=13.926 | 2404.6 samples/s | 37.6 steps/s
[Step=20300 Epoch=99.0] | Loss=0.03945 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.212 | L2-Norm(final)=13.938 | 5631.1 samples/s | 88.0 steps/s
[Step=20350 Epoch=99.2] | Loss=0.03971 | Reg=0.00126 | acc=0.9375 | L2-Norm=11.212 | L2-Norm(final)=13.953 | 5705.2 samples/s | 89.1 steps/s
[Step=20400 Epoch=99.5] | Loss=0.03972 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.212 | L2-Norm(final)=13.969 | 7566.9 samples/s | 118.2 steps/s
[Step=20450 Epoch=99.7] | Loss=0.03978 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.212 | L2-Norm(final)=13.983 | 2519.1 samples/s | 39.4 steps/s
[Step=20500 Epoch=100.0] | Loss=0.03974 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.212 | L2-Norm(final)=13.999 | 5621.3 samples/s | 87.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=100.0] | Loss=0.02362 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.212 | L2-Norm(final)=14.159 | 6121.9 samples/s | 95.7 steps/s
[Step=20550 Epoch=100.2] | Loss=0.04016 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.310 | L2-Norm(final)=14.160 | 4265.7 samples/s | 66.7 steps/s
[Step=20600 Epoch=100.5] | Loss=0.03805 | Reg=0.00130 | acc=0.9531 | L2-Norm=11.400 | L2-Norm(final)=14.150 | 4911.7 samples/s | 76.7 steps/s
[Step=20650 Epoch=100.7] | Loss=0.03434 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.459 | L2-Norm(final)=14.143 | 4767.1 samples/s | 74.5 steps/s
[Step=20700 Epoch=100.9] | Loss=0.03295 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.499 | L2-Norm(final)=14.138 | 6963.1 samples/s | 108.8 steps/s
[Step=20750 Epoch=101.2] | Loss=0.02884 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.534 | L2-Norm(final)=14.137 | 2270.6 samples/s | 35.5 steps/s
[Step=20800 Epoch=101.4] | Loss=0.02669 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.560 | L2-Norm(final)=14.136 | 4901.1 samples/s | 76.6 steps/s
[Step=20850 Epoch=101.7] | Loss=0.02475 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=14.136 | 4812.8 samples/s | 75.2 steps/s
[Step=20900 Epoch=101.9] | Loss=0.02307 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.599 | L2-Norm(final)=14.136 | 6342.5 samples/s | 99.1 steps/s
[Step=20950 Epoch=102.2] | Loss=0.02122 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.614 | L2-Norm(final)=14.137 | 2333.6 samples/s | 36.5 steps/s
[Step=21000 Epoch=102.4] | Loss=0.01975 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.628 | L2-Norm(final)=14.138 | 4807.2 samples/s | 75.1 steps/s
[Step=21050 Epoch=102.7] | Loss=0.01904 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.639 | L2-Norm(final)=14.139 | 4926.6 samples/s | 77.0 steps/s
[Step=21100 Epoch=102.9] | Loss=0.01834 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.649 | L2-Norm(final)=14.140 | 5720.6 samples/s | 89.4 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01726 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.658 | L2-Norm(final)=14.141 | 2443.0 samples/s | 38.2 steps/s
[Step=21200 Epoch=103.4] | Loss=0.01635 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.667 | L2-Norm(final)=14.142 | 4889.6 samples/s | 76.4 steps/s
[Step=21250 Epoch=103.6] | Loss=0.01569 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.674 | L2-Norm(final)=14.144 | 4815.3 samples/s | 75.2 steps/s
[Step=21300 Epoch=103.9] | Loss=0.01510 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.681 | L2-Norm(final)=14.145 | 5399.0 samples/s | 84.4 steps/s
[Step=21350 Epoch=104.1] | Loss=0.01463 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.687 | L2-Norm(final)=14.147 | 2528.7 samples/s | 39.5 steps/s
[Step=21400 Epoch=104.4] | Loss=0.01414 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.693 | L2-Norm(final)=14.148 | 4826.0 samples/s | 75.4 steps/s
[Step=21450 Epoch=104.6] | Loss=0.01376 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.699 | L2-Norm(final)=14.149 | 4955.9 samples/s | 77.4 steps/s
[Step=21500 Epoch=104.8] | Loss=0.01350 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=14.151 | 4938.1 samples/s | 77.2 steps/s
[Step=21550 Epoch=105.1] | Loss=0.01307 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.711 | L2-Norm(final)=14.152 | 2601.3 samples/s | 40.6 steps/s
[Step=21600 Epoch=105.3] | Loss=0.01274 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.717 | L2-Norm(final)=14.154 | 4865.7 samples/s | 76.0 steps/s
[Step=21650 Epoch=105.6] | Loss=0.01246 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.723 | L2-Norm(final)=14.156 | 4911.5 samples/s | 76.7 steps/s
[Step=21700 Epoch=105.8] | Loss=0.01213 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=14.157 | 4835.1 samples/s | 75.5 steps/s
[Step=21750 Epoch=106.1] | Loss=0.01200 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.735 | L2-Norm(final)=14.159 | 2627.4 samples/s | 41.1 steps/s
[Step=21800 Epoch=106.3] | Loss=0.01182 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.741 | L2-Norm(final)=14.161 | 4835.0 samples/s | 75.5 steps/s
[Step=21850 Epoch=106.6] | Loss=0.01160 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.747 | L2-Norm(final)=14.162 | 4894.7 samples/s | 76.5 steps/s
[Step=21900 Epoch=106.8] | Loss=0.01139 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.753 | L2-Norm(final)=14.163 | 4814.0 samples/s | 75.2 steps/s
[Step=21950 Epoch=107.0] | Loss=0.01118 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.758 | L2-Norm(final)=14.164 | 2670.8 samples/s | 41.7 steps/s
[Step=22000 Epoch=107.3] | Loss=0.01114 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.764 | L2-Norm(final)=14.166 | 4730.7 samples/s | 73.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step22000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=171.2] | Loss=0.00064 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.210 | L2-Norm(final)=12.964 | 5948.6 samples/s | 92.9 steps/s
[Step=18050 Epoch=171.7] | Loss=0.00431 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.207 | L2-Norm(final)=13.001 | 4577.4 samples/s | 71.5 steps/s
[Step=18100 Epoch=172.2] | Loss=0.00404 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.206 | L2-Norm(final)=13.045 | 8457.6 samples/s | 132.2 steps/s
[Step=18150 Epoch=172.7] | Loss=0.00382 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=13.087 | 2381.5 samples/s | 37.2 steps/s
[Step=18200 Epoch=173.1] | Loss=0.00393 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=13.127 | 7201.3 samples/s | 112.5 steps/s
[Step=18250 Epoch=173.6] | Loss=0.00373 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=13.166 | 2471.4 samples/s | 38.6 steps/s
[Step=18300 Epoch=174.1] | Loss=0.00396 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=13.204 | 6420.5 samples/s | 100.3 steps/s
[Step=18350 Epoch=174.6] | Loss=0.00379 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=13.242 | 2536.7 samples/s | 39.6 steps/s
[Step=18400 Epoch=175.0] | Loss=0.00376 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=13.280 | 5953.0 samples/s | 93.0 steps/s
[Step=18450 Epoch=175.5] | Loss=0.00366 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=13.318 | 2621.8 samples/s | 41.0 steps/s
[Step=18500 Epoch=176.0] | Loss=0.00373 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=13.355 | 5565.1 samples/s | 87.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=176.0] | Loss=0.01386 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.206 | L2-Norm(final)=13.728 | 6028.1 samples/s | 94.2 steps/s
[Step=18550 Epoch=176.5] | Loss=0.00100 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.318 | L2-Norm(final)=13.749 | 4054.1 samples/s | 63.3 steps/s
[Step=18600 Epoch=176.9] | Loss=0.00054 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.331 | L2-Norm(final)=13.758 | 6598.9 samples/s | 103.1 steps/s
[Step=18650 Epoch=177.4] | Loss=0.00037 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.323 | L2-Norm(final)=13.762 | 2196.0 samples/s | 34.3 steps/s
[Step=18700 Epoch=177.9] | Loss=0.00028 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.306 | L2-Norm(final)=13.765 | 5919.6 samples/s | 92.5 steps/s
[Step=18750 Epoch=178.4] | Loss=0.00022 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=13.767 | 2294.0 samples/s | 35.8 steps/s
[Step=18800 Epoch=178.8] | Loss=0.00019 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.265 | L2-Norm(final)=13.768 | 5490.9 samples/s | 85.8 steps/s
[Step=18850 Epoch=179.3] | Loss=0.00016 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=13.769 | 2338.0 samples/s | 36.5 steps/s
[Step=18900 Epoch=179.8] | Loss=0.00014 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=13.771 | 5158.5 samples/s | 80.6 steps/s
[Step=18950 Epoch=180.3] | Loss=0.00013 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.204 | L2-Norm(final)=13.772 | 2421.9 samples/s | 37.8 steps/s
[Step=19000 Epoch=180.7] | Loss=0.00011 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.184 | L2-Norm(final)=13.773 | 4762.4 samples/s | 74.4 steps/s
[Step=19050 Epoch=181.2] | Loss=0.00010 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.165 | L2-Norm(final)=13.774 | 2547.6 samples/s | 39.8 steps/s
[Step=19100 Epoch=181.7] | Loss=0.00010 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.146 | L2-Norm(final)=13.775 | 4533.8 samples/s | 70.8 steps/s
[Step=19150 Epoch=182.2] | Loss=0.00009 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.128 | L2-Norm(final)=13.776 | 2612.8 samples/s | 40.8 steps/s
[Step=19200 Epoch=182.6] | Loss=0.00008 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.110 | L2-Norm(final)=13.777 | 4654.9 samples/s | 72.7 steps/s
[Step=19250 Epoch=183.1] | Loss=0.00008 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.092 | L2-Norm(final)=13.777 | 2589.6 samples/s | 40.5 steps/s
[Step=19300 Epoch=183.6] | Loss=0.00007 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.074 | L2-Norm(final)=13.778 | 4602.7 samples/s | 71.9 steps/s
[Step=19350 Epoch=184.1] | Loss=0.00007 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.056 | L2-Norm(final)=13.779 | 2665.1 samples/s | 41.6 steps/s
[Step=19400 Epoch=184.5] | Loss=0.00006 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.039 | L2-Norm(final)=13.780 | 4313.7 samples/s | 67.4 steps/s
[Step=19450 Epoch=185.0] | Loss=0.00006 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=13.781 | 6942.8 samples/s | 108.5 steps/s
[Step=19500 Epoch=185.5] | Loss=0.00006 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.004 | L2-Norm(final)=13.781 | 2170.9 samples/s | 33.9 steps/s
[Step=19550 Epoch=186.0] | Loss=0.00006 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.987 | L2-Norm(final)=13.782 | 6127.7 samples/s | 95.7 steps/s
[Step=19600 Epoch=186.4] | Loss=0.00005 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.970 | L2-Norm(final)=13.783 | 2245.4 samples/s | 35.1 steps/s
[Step=19650 Epoch=186.9] | Loss=0.00005 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=13.783 | 5784.4 samples/s | 90.4 steps/s
[Step=19700 Epoch=187.4] | Loss=0.00005 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.937 | L2-Norm(final)=13.784 | 2307.6 samples/s | 36.1 steps/s
[Step=19750 Epoch=187.9] | Loss=0.00005 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.920 | L2-Norm(final)=13.785 | 5302.9 samples/s | 82.9 steps/s
[Step=19800 Epoch=188.3] | Loss=0.00005 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.904 | L2-Norm(final)=13.786 | 2406.1 samples/s | 37.6 steps/s
[Step=19850 Epoch=188.8] | Loss=0.00004 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.887 | L2-Norm(final)=13.786 | 4888.9 samples/s | 76.4 steps/s
[Step=19900 Epoch=189.3] | Loss=0.00004 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.870 | L2-Norm(final)=13.787 | 2494.5 samples/s | 39.0 steps/s
[Step=19950 Epoch=189.8] | Loss=0.00004 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.854 | L2-Norm(final)=13.788 | 4617.2 samples/s | 72.1 steps/s
[Step=20000 Epoch=190.2] | Loss=0.00004 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.838 | L2-Norm(final)=13.788 | 2561.4 samples/s | 40.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step20000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=152.8] | Loss=0.00071 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.210 | L2-Norm(final)=14.393 | 5778.4 samples/s | 90.3 steps/s
[Step=16050 Epoch=153.3] | Loss=0.00282 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.207 | L2-Norm(final)=14.416 | 5058.8 samples/s | 79.0 steps/s
[Step=16100 Epoch=153.7] | Loss=0.00226 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=14.453 | 8329.2 samples/s | 130.1 steps/s
[Step=16150 Epoch=154.2] | Loss=0.00217 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=14.488 | 2351.3 samples/s | 36.7 steps/s
[Step=16200 Epoch=154.7] | Loss=0.00215 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=14.524 | 7400.3 samples/s | 115.6 steps/s
[Step=16250 Epoch=155.2] | Loss=0.00209 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=14.556 | 2407.9 samples/s | 37.6 steps/s
[Step=16300 Epoch=155.7] | Loss=0.00219 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=14.588 | 6972.5 samples/s | 108.9 steps/s
[Step=16350 Epoch=156.1] | Loss=0.00218 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=14.618 | 2475.3 samples/s | 38.7 steps/s
[Step=16400 Epoch=156.6] | Loss=0.00210 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=14.648 | 6323.3 samples/s | 98.8 steps/s
[Step=16450 Epoch=157.1] | Loss=0.00208 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=14.678 | 2579.4 samples/s | 40.3 steps/s
[Step=16500 Epoch=157.6] | Loss=0.00209 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=14.707 | 5862.2 samples/s | 91.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=157.6] | Loss=0.00038 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=14.998 | 6057.2 samples/s | 94.6 steps/s
[Step=16550 Epoch=158.0] | Loss=0.00327 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.264 | L2-Norm(final)=15.016 | 4095.9 samples/s | 64.0 steps/s
[Step=16600 Epoch=158.5] | Loss=0.00372 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=14.997 | 6715.5 samples/s | 104.9 steps/s
[Step=16650 Epoch=159.0] | Loss=0.00270 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.989 | 2178.0 samples/s | 34.0 steps/s
[Step=16700 Epoch=159.5] | Loss=0.00204 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.453 | L2-Norm(final)=14.987 | 6090.5 samples/s | 95.2 steps/s
[Step=16750 Epoch=160.0] | Loss=0.00164 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.464 | L2-Norm(final)=14.986 | 2270.9 samples/s | 35.5 steps/s
[Step=16800 Epoch=160.4] | Loss=0.00136 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.466 | L2-Norm(final)=14.986 | 5665.4 samples/s | 88.5 steps/s
[Step=16850 Epoch=160.9] | Loss=0.00117 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.463 | L2-Norm(final)=14.986 | 2332.2 samples/s | 36.4 steps/s
[Step=16900 Epoch=161.4] | Loss=0.00103 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.458 | L2-Norm(final)=14.986 | 5370.6 samples/s | 83.9 steps/s
[Step=16950 Epoch=161.9] | Loss=0.00091 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.451 | L2-Norm(final)=14.986 | 2429.9 samples/s | 38.0 steps/s
[Step=17000 Epoch=162.3] | Loss=0.00082 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.442 | L2-Norm(final)=14.986 | 4866.7 samples/s | 76.0 steps/s
[Step=17050 Epoch=162.8] | Loss=0.00075 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=14.986 | 2438.9 samples/s | 38.1 steps/s
[Step=17100 Epoch=163.3] | Loss=0.00069 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.987 | 4740.2 samples/s | 74.1 steps/s
[Step=17150 Epoch=163.8] | Loss=0.00063 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=14.987 | 2541.7 samples/s | 39.7 steps/s
[Step=17200 Epoch=164.2] | Loss=0.00059 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.403 | L2-Norm(final)=14.987 | 4651.2 samples/s | 72.7 steps/s
[Step=17250 Epoch=164.7] | Loss=0.00055 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.392 | L2-Norm(final)=14.987 | 2550.5 samples/s | 39.9 steps/s
[Step=17300 Epoch=165.2] | Loss=0.00051 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=14.988 | 4633.3 samples/s | 72.4 steps/s
[Step=17350 Epoch=165.7] | Loss=0.00048 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=14.988 | 2568.0 samples/s | 40.1 steps/s
[Step=17400 Epoch=166.2] | Loss=0.00046 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.359 | L2-Norm(final)=14.988 | 4663.6 samples/s | 72.9 steps/s
[Step=17450 Epoch=166.6] | Loss=0.00043 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.348 | L2-Norm(final)=14.989 | 2550.0 samples/s | 39.8 steps/s
[Step=17500 Epoch=167.1] | Loss=0.00041 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.336 | L2-Norm(final)=14.989 | 4693.9 samples/s | 73.3 steps/s
[Step=17550 Epoch=167.6] | Loss=0.00039 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.325 | L2-Norm(final)=14.990 | 7296.8 samples/s | 114.0 steps/s
[Step=17600 Epoch=168.1] | Loss=0.00038 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.313 | L2-Norm(final)=14.990 | 2128.3 samples/s | 33.3 steps/s
[Step=17650 Epoch=168.5] | Loss=0.00036 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.302 | L2-Norm(final)=14.991 | 6701.8 samples/s | 104.7 steps/s
[Step=17700 Epoch=169.0] | Loss=0.00034 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.290 | L2-Norm(final)=14.991 | 2157.3 samples/s | 33.7 steps/s
[Step=17750 Epoch=169.5] | Loss=0.00033 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.278 | L2-Norm(final)=14.992 | 6287.9 samples/s | 98.2 steps/s
[Step=17800 Epoch=170.0] | Loss=0.00032 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.267 | L2-Norm(final)=14.992 | 2245.6 samples/s | 35.1 steps/s
[Step=17850 Epoch=170.5] | Loss=0.00031 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.255 | L2-Norm(final)=14.993 | 5768.3 samples/s | 90.1 steps/s
[Step=17900 Epoch=170.9] | Loss=0.00030 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.243 | L2-Norm(final)=14.993 | 2287.4 samples/s | 35.7 steps/s
[Step=17950 Epoch=171.4] | Loss=0.00029 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=14.994 | 5400.4 samples/s | 84.4 steps/s
[Step=18000 Epoch=171.9] | Loss=0.00028 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.219 | L2-Norm(final)=14.995 | 2377.6 samples/s | 37.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step18000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=114.4] | Loss=0.00531 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.210 | L2-Norm(final)=12.452 | 5150.8 samples/s | 80.5 steps/s
[Step=12050 Epoch=114.8] | Loss=0.00629 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=12.528 | 4895.2 samples/s | 76.5 steps/s
[Step=12100 Epoch=115.3] | Loss=0.00632 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=12.609 | 8511.2 samples/s | 133.0 steps/s
[Step=12150 Epoch=115.8] | Loss=0.00614 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=12.683 | 2311.4 samples/s | 36.1 steps/s
[Step=12200 Epoch=116.3] | Loss=0.00603 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=12.749 | 7591.9 samples/s | 118.6 steps/s
[Step=12250 Epoch=116.8] | Loss=0.00588 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=12.807 | 2401.4 samples/s | 37.5 steps/s
[Step=12300 Epoch=117.2] | Loss=0.00585 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=12.863 | 6824.2 samples/s | 106.6 steps/s
[Step=12350 Epoch=117.7] | Loss=0.00570 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=12.915 | 2536.5 samples/s | 39.6 steps/s
[Step=12400 Epoch=118.2] | Loss=0.00563 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=12.964 | 6183.3 samples/s | 96.6 steps/s
[Step=12450 Epoch=118.7] | Loss=0.00569 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=13.012 | 2570.0 samples/s | 40.2 steps/s
[Step=12500 Epoch=119.1] | Loss=0.00560 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=13.059 | 5789.9 samples/s | 90.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=119.1] | Loss=0.00713 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=13.514 | 5830.8 samples/s | 91.1 steps/s
[Step=12550 Epoch=119.6] | Loss=0.00886 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.407 | L2-Norm(final)=13.515 | 4158.5 samples/s | 65.0 steps/s
[Step=12600 Epoch=120.1] | Loss=0.00825 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.584 | L2-Norm(final)=13.475 | 6534.5 samples/s | 102.1 steps/s
[Step=12650 Epoch=120.6] | Loss=0.00573 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.665 | L2-Norm(final)=13.460 | 2188.5 samples/s | 34.2 steps/s
[Step=12700 Epoch=121.0] | Loss=0.00431 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.702 | L2-Norm(final)=13.454 | 6175.2 samples/s | 96.5 steps/s
[Step=12750 Epoch=121.5] | Loss=0.00345 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.720 | L2-Norm(final)=13.451 | 1703.0 samples/s | 26.6 steps/s
[Step=12800 Epoch=122.0] | Loss=0.00288 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.728 | L2-Norm(final)=13.449 | 5799.6 samples/s | 90.6 steps/s
[Step=12850 Epoch=122.5] | Loss=0.00247 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.730 | L2-Norm(final)=13.448 | 2275.0 samples/s | 35.5 steps/s
[Step=12900 Epoch=122.9] | Loss=0.00217 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=13.448 | 5294.6 samples/s | 82.7 steps/s
[Step=12950 Epoch=123.4] | Loss=0.00193 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.725 | L2-Norm(final)=13.448 | 2412.1 samples/s | 37.7 steps/s
[Step=13000 Epoch=123.9] | Loss=0.00173 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.720 | L2-Norm(final)=13.448 | 4914.8 samples/s | 76.8 steps/s
[Step=13050 Epoch=124.4] | Loss=0.00158 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.714 | L2-Norm(final)=13.448 | 2470.4 samples/s | 38.6 steps/s
[Step=13100 Epoch=124.9] | Loss=0.00145 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.708 | L2-Norm(final)=13.449 | 4648.6 samples/s | 72.6 steps/s
[Step=13150 Epoch=125.3] | Loss=0.00134 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.700 | L2-Norm(final)=13.449 | 2520.7 samples/s | 39.4 steps/s
[Step=13200 Epoch=125.8] | Loss=0.00124 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.692 | L2-Norm(final)=13.450 | 4603.7 samples/s | 71.9 steps/s
[Step=13250 Epoch=126.3] | Loss=0.00116 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.684 | L2-Norm(final)=13.450 | 2598.2 samples/s | 40.6 steps/s
[Step=13300 Epoch=126.8] | Loss=0.00109 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=13.451 | 4681.9 samples/s | 73.2 steps/s
[Step=13350 Epoch=127.2] | Loss=0.00102 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.666 | L2-Norm(final)=13.451 | 2556.1 samples/s | 39.9 steps/s
[Step=13400 Epoch=127.7] | Loss=0.00097 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.657 | L2-Norm(final)=13.452 | 4522.6 samples/s | 70.7 steps/s
[Step=13450 Epoch=128.2] | Loss=0.00092 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.648 | L2-Norm(final)=13.452 | 2585.4 samples/s | 40.4 steps/s
[Step=13500 Epoch=128.7] | Loss=0.00087 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.639 | L2-Norm(final)=13.453 | 4555.3 samples/s | 71.2 steps/s
[Step=13550 Epoch=129.1] | Loss=0.00083 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.629 | L2-Norm(final)=13.453 | 7417.2 samples/s | 115.9 steps/s
[Step=13600 Epoch=129.6] | Loss=0.00079 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=13.454 | 2114.1 samples/s | 33.0 steps/s
[Step=13650 Epoch=130.1] | Loss=0.00076 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.610 | L2-Norm(final)=13.454 | 6780.4 samples/s | 105.9 steps/s
[Step=13700 Epoch=130.6] | Loss=0.00073 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.600 | L2-Norm(final)=13.455 | 2181.0 samples/s | 34.1 steps/s
[Step=13750 Epoch=131.0] | Loss=0.00070 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.590 | L2-Norm(final)=13.456 | 6232.6 samples/s | 97.4 steps/s
[Step=13800 Epoch=131.5] | Loss=0.00067 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.580 | L2-Norm(final)=13.456 | 2248.4 samples/s | 35.1 steps/s
[Step=13850 Epoch=132.0] | Loss=0.00065 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.570 | L2-Norm(final)=13.457 | 5687.5 samples/s | 88.9 steps/s
[Step=13900 Epoch=132.5] | Loss=0.00062 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.560 | L2-Norm(final)=13.457 | 2303.7 samples/s | 36.0 steps/s
[Step=13950 Epoch=133.0] | Loss=0.00060 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.550 | L2-Norm(final)=13.458 | 5366.7 samples/s | 83.9 steps/s
[Step=14000 Epoch=133.4] | Loss=0.00058 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.540 | L2-Norm(final)=13.458 | 2398.1 samples/s | 37.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4/client_state-step14000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11061 | acc=0.9563 | tpr=0.9744 | fpr=0.0833 | 5667.6 samples/s | 22.1 steps/s
Avg test loss: 0.11709, Avg test acc: 0.95376, Avg tpr: 0.97266, Avg fpr: 0.08781, total FA: 685

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.11502 | acc=0.9518 | tpr=0.9581 | fpr=0.0619 | 5392.0 samples/s | 21.1 steps/s
Avg test loss: 0.11948, Avg test acc: 0.95016, Avg tpr: 0.95646, Avg fpr: 0.06371, total FA: 497

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.12957 | acc=0.9555 | tpr=0.9676 | fpr=0.0709 | 5526.8 samples/s | 21.6 steps/s
Avg test loss: 0.13292, Avg test acc: 0.95388, Avg tpr: 0.96596, Avg fpr: 0.07268, total FA: 567

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09274 | acc=0.9584 | tpr=0.9684 | fpr=0.0632 | 5780.3 samples/s | 22.6 steps/s
Avg test loss: 0.10652, Avg test acc: 0.95424, Avg tpr: 0.96515, Avg fpr: 0.06973, total FA: 544

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10714 | acc=0.9508 | tpr=0.9613 | fpr=0.0721 | 5836.3 samples/s | 22.8 steps/s
Avg test loss: 0.11366, Avg test acc: 0.95204, Avg tpr: 0.96124, Avg fpr: 0.06820, total FA: 532

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.16546 | acc=0.2997 | tpr=0.0050 | fpr=0.0605 | 5683.0 samples/s | 22.2 steps/s
Avg test loss: 5.17263, Avg test acc: 0.29714, Avg tpr: 0.00460, Avg fpr: 0.05948, total FA: 464

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.90851 | acc=0.2852 | tpr=0.0099 | fpr=0.1172 | 5787.3 samples/s | 22.6 steps/s
Avg test loss: 4.92305, Avg test acc: 0.28376, Avg tpr: 0.00985, Avg fpr: 0.11383, total FA: 888

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.49264 | acc=0.2779 | tpr=0.0208 | fpr=0.1638 | 5645.6 samples/s | 22.1 steps/s
Avg test loss: 5.50792, Avg test acc: 0.27699, Avg tpr: 0.02145, Avg fpr: 0.16100, total FA: 1256

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.71897 | acc=0.2923 | tpr=0.0169 | fpr=0.1095 | 5717.1 samples/s | 22.3 steps/s
Avg test loss: 4.72579, Avg test acc: 0.29161, Avg tpr: 0.01708, Avg fpr: 0.10460, total FA: 816

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.94260 | acc=0.3017 | tpr=0.0114 | fpr=0.0679 | 5813.7 samples/s | 22.7 steps/s
Avg test loss: 4.95377, Avg test acc: 0.29902, Avg tpr: 0.01142, Avg fpr: 0.06845, total FA: 534

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.14756 | acc=0.1296 | tpr=0.3628 | fpr=0.8746 | 5612.0 samples/s | 21.9 steps/s
[Step= 100] | Loss=6.10270 | acc=0.1296 | tpr=0.3241 | fpr=0.8740 | 7918.7 samples/s | 30.9 steps/s
[Step= 150] | Loss=6.11391 | acc=0.1289 | tpr=0.3228 | fpr=0.8746 | 8234.4 samples/s | 32.2 steps/s
[Step= 200] | Loss=6.10875 | acc=0.1290 | tpr=0.3191 | fpr=0.8744 | 7161.2 samples/s | 28.0 steps/s
[Step= 250] | Loss=6.11095 | acc=0.1292 | tpr=0.3301 | fpr=0.8745 | 8568.0 samples/s | 33.5 steps/s
[Step= 300] | Loss=6.10822 | acc=0.1286 | tpr=0.3258 | fpr=0.8750 | 8532.9 samples/s | 33.3 steps/s
[Step= 350] | Loss=6.10818 | acc=0.1281 | tpr=0.3131 | fpr=0.8753 | 8261.8 samples/s | 32.3 steps/s
[Step= 400] | Loss=6.10527 | acc=0.1285 | tpr=0.3129 | fpr=0.8748 | 8163.0 samples/s | 31.9 steps/s
[Step= 450] | Loss=6.10610 | acc=0.1288 | tpr=0.3165 | fpr=0.8746 | 7580.9 samples/s | 29.6 steps/s
[Step= 500] | Loss=6.10876 | acc=0.1291 | tpr=0.3154 | fpr=0.8743 | 8613.9 samples/s | 33.6 steps/s
[Step= 550] | Loss=6.10600 | acc=0.1289 | tpr=0.3084 | fpr=0.8744 | 10397.0 samples/s | 40.6 steps/s
Avg test loss: 6.10619, Avg test acc: 0.12877, Avg tpr: 0.30824, Avg fpr: 0.87449, total FA: 121421

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.11393 | acc=0.1366 | tpr=0.2257 | fpr=0.8650 | 5864.3 samples/s | 22.9 steps/s
[Step= 100] | Loss=5.06824 | acc=0.1379 | tpr=0.1898 | fpr=0.8631 | 7447.8 samples/s | 29.1 steps/s
[Step= 150] | Loss=5.07390 | acc=0.1367 | tpr=0.1758 | fpr=0.8640 | 8121.4 samples/s | 31.7 steps/s
[Step= 200] | Loss=5.07245 | acc=0.1375 | tpr=0.1749 | fpr=0.8632 | 7918.8 samples/s | 30.9 steps/s
[Step= 250] | Loss=5.07412 | acc=0.1373 | tpr=0.1755 | fpr=0.8634 | 7933.0 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.07613 | acc=0.1373 | tpr=0.1796 | fpr=0.8634 | 7646.8 samples/s | 29.9 steps/s
[Step= 350] | Loss=5.07927 | acc=0.1370 | tpr=0.1747 | fpr=0.8637 | 8639.2 samples/s | 33.7 steps/s
[Step= 400] | Loss=5.07594 | acc=0.1381 | tpr=0.1740 | fpr=0.8625 | 7863.2 samples/s | 30.7 steps/s
[Step= 450] | Loss=5.07769 | acc=0.1382 | tpr=0.1738 | fpr=0.8625 | 7848.8 samples/s | 30.7 steps/s
[Step= 500] | Loss=5.07651 | acc=0.1383 | tpr=0.1758 | fpr=0.8623 | 8464.7 samples/s | 33.1 steps/s
[Step= 550] | Loss=5.07742 | acc=0.1385 | tpr=0.1767 | fpr=0.8622 | 10563.8 samples/s | 41.3 steps/s
Avg test loss: 5.07766, Avg test acc: 0.13841, Avg tpr: 0.17710, Avg fpr: 0.86230, total FA: 119728

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=7.11695 | acc=0.1148 | tpr=0.2345 | fpr=0.8874 | 5630.1 samples/s | 22.0 steps/s
[Step= 100] | Loss=7.04247 | acc=0.1160 | tpr=0.1983 | fpr=0.8856 | 7920.8 samples/s | 30.9 steps/s
[Step= 150] | Loss=7.05138 | acc=0.1167 | tpr=0.2003 | fpr=0.8848 | 7330.1 samples/s | 28.6 steps/s
[Step= 200] | Loss=7.03733 | acc=0.1167 | tpr=0.1825 | fpr=0.8845 | 8377.9 samples/s | 32.7 steps/s
[Step= 250] | Loss=7.03739 | acc=0.1174 | tpr=0.1869 | fpr=0.8839 | 7748.7 samples/s | 30.3 steps/s
[Step= 300] | Loss=7.04466 | acc=0.1170 | tpr=0.1913 | fpr=0.8843 | 8208.3 samples/s | 32.1 steps/s
[Step= 350] | Loss=7.04976 | acc=0.1161 | tpr=0.1841 | fpr=0.8852 | 8069.3 samples/s | 31.5 steps/s
[Step= 400] | Loss=7.04517 | acc=0.1166 | tpr=0.1887 | fpr=0.8847 | 7949.6 samples/s | 31.1 steps/s
[Step= 450] | Loss=7.04514 | acc=0.1164 | tpr=0.1840 | fpr=0.8848 | 7348.6 samples/s | 28.7 steps/s
[Step= 500] | Loss=7.04763 | acc=0.1162 | tpr=0.1850 | fpr=0.8850 | 8352.8 samples/s | 32.6 steps/s
[Step= 550] | Loss=7.04461 | acc=0.1164 | tpr=0.1854 | fpr=0.8848 | 13497.3 samples/s | 52.7 steps/s
Avg test loss: 7.04365, Avg test acc: 0.11630, Avg tpr: 0.18542, Avg fpr: 0.88495, total FA: 122874

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.91997 | acc=0.1525 | tpr=0.2566 | fpr=0.8494 | 5714.4 samples/s | 22.3 steps/s
[Step= 100] | Loss=5.87604 | acc=0.1515 | tpr=0.2367 | fpr=0.8501 | 8056.2 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.88329 | acc=0.1501 | tpr=0.2320 | fpr=0.8514 | 8293.8 samples/s | 32.4 steps/s
[Step= 200] | Loss=5.87069 | acc=0.1508 | tpr=0.2240 | fpr=0.8506 | 7217.7 samples/s | 28.2 steps/s
[Step= 250] | Loss=5.87610 | acc=0.1510 | tpr=0.2262 | fpr=0.8504 | 8403.0 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.87900 | acc=0.1501 | tpr=0.2276 | fpr=0.8513 | 7839.4 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.87943 | acc=0.1493 | tpr=0.2173 | fpr=0.8520 | 8231.3 samples/s | 32.2 steps/s
[Step= 400] | Loss=5.87457 | acc=0.1497 | tpr=0.2183 | fpr=0.8516 | 7843.6 samples/s | 30.6 steps/s
[Step= 450] | Loss=5.87553 | acc=0.1496 | tpr=0.2132 | fpr=0.8515 | 7972.7 samples/s | 31.1 steps/s
[Step= 500] | Loss=5.87891 | acc=0.1494 | tpr=0.2132 | fpr=0.8518 | 8261.2 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.87731 | acc=0.1495 | tpr=0.2121 | fpr=0.8517 | 10740.8 samples/s | 42.0 steps/s
Avg test loss: 5.87790, Avg test acc: 0.14939, Avg tpr: 0.21197, Avg fpr: 0.85174, total FA: 118263

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.92210 | acc=0.1354 | tpr=0.1991 | fpr=0.8658 | 5717.2 samples/s | 22.3 steps/s
[Step= 100] | Loss=5.86067 | acc=0.1369 | tpr=0.1706 | fpr=0.8637 | 8273.4 samples/s | 32.3 steps/s
[Step= 150] | Loss=5.87004 | acc=0.1348 | tpr=0.1643 | fpr=0.8657 | 7522.2 samples/s | 29.4 steps/s
[Step= 200] | Loss=5.86573 | acc=0.1359 | tpr=0.1574 | fpr=0.8645 | 8430.6 samples/s | 32.9 steps/s
[Step= 250] | Loss=5.87599 | acc=0.1356 | tpr=0.1555 | fpr=0.8648 | 8264.4 samples/s | 32.3 steps/s
[Step= 300] | Loss=5.87663 | acc=0.1351 | tpr=0.1549 | fpr=0.8652 | 7722.0 samples/s | 30.2 steps/s
[Step= 350] | Loss=5.88345 | acc=0.1347 | tpr=0.1497 | fpr=0.8656 | 7872.1 samples/s | 30.8 steps/s
[Step= 400] | Loss=5.87723 | acc=0.1356 | tpr=0.1472 | fpr=0.8646 | 7628.1 samples/s | 29.8 steps/s
[Step= 450] | Loss=5.87599 | acc=0.1356 | tpr=0.1470 | fpr=0.8646 | 8338.0 samples/s | 32.6 steps/s
[Step= 500] | Loss=5.87792 | acc=0.1352 | tpr=0.1485 | fpr=0.8650 | 8471.3 samples/s | 33.1 steps/s
[Step= 550] | Loss=5.87398 | acc=0.1352 | tpr=0.1468 | fpr=0.8650 | 10207.9 samples/s | 39.9 steps/s
Avg test loss: 5.87390, Avg test acc: 0.13509, Avg tpr: 0.14739, Avg fpr: 0.86513, total FA: 120122

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08780 | acc=0.9840 | tpr=0.8982 | fpr=0.0145 | 5764.7 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.09346 | acc=0.9839 | tpr=0.9190 | fpr=0.0149 | 8013.3 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.09664 | acc=0.9834 | tpr=0.9265 | fpr=0.0155 | 7348.3 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.09781 | acc=0.9834 | tpr=0.9279 | fpr=0.0156 | 7810.7 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.09827 | acc=0.9833 | tpr=0.9170 | fpr=0.0155 | 8764.8 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.09928 | acc=0.9830 | tpr=0.9156 | fpr=0.0158 | 8366.1 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.09953 | acc=0.9829 | tpr=0.9173 | fpr=0.0159 | 8123.0 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.10044 | acc=0.9828 | tpr=0.9125 | fpr=0.0159 | 8203.9 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.10243 | acc=0.9826 | tpr=0.9124 | fpr=0.0162 | 8049.2 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.10153 | acc=0.9828 | tpr=0.9167 | fpr=0.0161 | 8055.1 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.10069 | acc=0.9829 | tpr=0.9172 | fpr=0.0160 | 9542.0 samples/s | 37.3 steps/s
Avg test loss: 0.10053, Avg test acc: 0.98287, Avg tpr: 0.91680, Avg fpr: 0.01593, total FA: 2212

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10592 | acc=0.9809 | tpr=0.8894 | fpr=0.0174 | 5681.1 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.10939 | acc=0.9808 | tpr=0.9083 | fpr=0.0179 | 8034.8 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.11339 | acc=0.9804 | tpr=0.9150 | fpr=0.0184 | 7931.6 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.11490 | acc=0.9804 | tpr=0.9191 | fpr=0.0185 | 8078.8 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.11485 | acc=0.9804 | tpr=0.9170 | fpr=0.0184 | 7953.4 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.11640 | acc=0.9803 | tpr=0.9193 | fpr=0.0186 | 7956.8 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.11653 | acc=0.9802 | tpr=0.9217 | fpr=0.0187 | 8358.3 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.11760 | acc=0.9800 | tpr=0.9174 | fpr=0.0188 | 7730.1 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.11961 | acc=0.9798 | tpr=0.9163 | fpr=0.0190 | 8135.5 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.11872 | acc=0.9800 | tpr=0.9189 | fpr=0.0188 | 8133.1 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.11786 | acc=0.9801 | tpr=0.9184 | fpr=0.0187 | 10152.0 samples/s | 39.7 steps/s
Avg test loss: 0.11761, Avg test acc: 0.98014, Avg tpr: 0.91799, Avg fpr: 0.01873, total FA: 2600

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11003 | acc=0.9804 | tpr=0.9381 | fpr=0.0188 | 5571.7 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.11681 | acc=0.9796 | tpr=0.9552 | fpr=0.0199 | 8438.2 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.12181 | acc=0.9785 | tpr=0.9524 | fpr=0.0210 | 8052.0 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.12393 | acc=0.9785 | tpr=0.9508 | fpr=0.0210 | 7952.2 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.12429 | acc=0.9782 | tpr=0.9467 | fpr=0.0212 | 7941.9 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.12570 | acc=0.9779 | tpr=0.9418 | fpr=0.0214 | 7720.0 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.12571 | acc=0.9780 | tpr=0.9405 | fpr=0.0213 | 8839.5 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.12685 | acc=0.9779 | tpr=0.9376 | fpr=0.0214 | 7481.0 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.12852 | acc=0.9776 | tpr=0.9343 | fpr=0.0216 | 9214.5 samples/s | 36.0 steps/s
[Step= 500] | Loss=0.12775 | acc=0.9777 | tpr=0.9366 | fpr=0.0216 | 7864.9 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.12697 | acc=0.9779 | tpr=0.9383 | fpr=0.0214 | 9361.6 samples/s | 36.6 steps/s
Avg test loss: 0.12673, Avg test acc: 0.97792, Avg tpr: 0.93780, Avg fpr: 0.02135, total FA: 2965

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09092 | acc=0.9827 | tpr=0.9071 | fpr=0.0159 | 5692.7 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.09442 | acc=0.9822 | tpr=0.9147 | fpr=0.0165 | 7928.9 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.09885 | acc=0.9814 | tpr=0.9207 | fpr=0.0175 | 8103.2 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.10085 | acc=0.9811 | tpr=0.9180 | fpr=0.0177 | 7063.8 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.10080 | acc=0.9812 | tpr=0.9127 | fpr=0.0176 | 8220.5 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.10235 | acc=0.9810 | tpr=0.9135 | fpr=0.0177 | 8635.2 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.10260 | acc=0.9810 | tpr=0.9142 | fpr=0.0178 | 8242.9 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.10309 | acc=0.9809 | tpr=0.9130 | fpr=0.0179 | 8298.1 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.10476 | acc=0.9807 | tpr=0.9119 | fpr=0.0181 | 7539.5 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.10452 | acc=0.9807 | tpr=0.9145 | fpr=0.0181 | 8229.1 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.10397 | acc=0.9807 | tpr=0.9144 | fpr=0.0181 | 9954.8 samples/s | 38.9 steps/s
Avg test loss: 0.10375, Avg test acc: 0.98071, Avg tpr: 0.91403, Avg fpr: 0.01808, total FA: 2510

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10876 | acc=0.9798 | tpr=0.9071 | fpr=0.0188 | 5632.2 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.11432 | acc=0.9800 | tpr=0.9232 | fpr=0.0189 | 7789.2 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.12040 | acc=0.9790 | tpr=0.9222 | fpr=0.0199 | 8170.3 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.12166 | acc=0.9790 | tpr=0.9191 | fpr=0.0199 | 8143.5 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.12115 | acc=0.9793 | tpr=0.9179 | fpr=0.0196 | 7752.7 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.12340 | acc=0.9793 | tpr=0.9171 | fpr=0.0196 | 8514.3 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.12385 | acc=0.9791 | tpr=0.9161 | fpr=0.0197 | 7924.4 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.12444 | acc=0.9791 | tpr=0.9152 | fpr=0.0197 | 8334.7 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.12662 | acc=0.9788 | tpr=0.9133 | fpr=0.0200 | 8165.1 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.12603 | acc=0.9790 | tpr=0.9141 | fpr=0.0199 | 7882.3 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.12536 | acc=0.9790 | tpr=0.9156 | fpr=0.0198 | 10183.5 samples/s | 39.8 steps/s
Avg test loss: 0.12523, Avg test acc: 0.97902, Avg tpr: 0.91482, Avg fpr: 0.01981, total FA: 2751

server round 20/50

clients selected: [1 2 4 5 7]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=30001 Epoch=146.4] | Loss=0.01434 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.096 | L2-Norm(final)=15.019 | 6050.3 samples/s | 94.5 steps/s
[Step=30050 Epoch=146.6] | Loss=0.03623 | Reg=0.00123 | acc=0.9531 | L2-Norm=11.097 | L2-Norm(final)=15.017 | 4856.8 samples/s | 75.9 steps/s
[Step=30100 Epoch=146.9] | Loss=0.03594 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.097 | L2-Norm(final)=15.014 | 5689.3 samples/s | 88.9 steps/s
[Step=30150 Epoch=147.1] | Loss=0.03524 | Reg=0.00123 | acc=0.9531 | L2-Norm=11.097 | L2-Norm(final)=15.012 | 5553.8 samples/s | 86.8 steps/s
[Step=30200 Epoch=147.4] | Loss=0.03504 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.097 | L2-Norm(final)=15.012 | 8794.8 samples/s | 137.4 steps/s
[Step=30250 Epoch=147.6] | Loss=0.03557 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.097 | L2-Norm(final)=15.012 | 2424.6 samples/s | 37.9 steps/s
[Step=30300 Epoch=147.8] | Loss=0.03501 | Reg=0.00123 | acc=0.9531 | L2-Norm=11.097 | L2-Norm(final)=15.012 | 5593.1 samples/s | 87.4 steps/s
[Step=30350 Epoch=148.1] | Loss=0.03459 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.097 | L2-Norm(final)=15.013 | 5702.9 samples/s | 89.1 steps/s
[Step=30400 Epoch=148.3] | Loss=0.03410 | Reg=0.00123 | acc=0.9531 | L2-Norm=11.097 | L2-Norm(final)=15.015 | 7840.5 samples/s | 122.5 steps/s
[Step=30450 Epoch=148.6] | Loss=0.03413 | Reg=0.00123 | acc=0.9375 | L2-Norm=11.097 | L2-Norm(final)=15.017 | 2451.5 samples/s | 38.3 steps/s
[Step=30500 Epoch=148.8] | Loss=0.03390 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.097 | L2-Norm(final)=15.019 | 5723.8 samples/s | 89.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=30501 Epoch=148.8] | Loss=0.03842 | Reg=0.00123 | acc=0.9531 | L2-Norm=11.097 | L2-Norm(final)=15.040 | 6005.1 samples/s | 93.8 steps/s
[Step=30550 Epoch=149.1] | Loss=0.03339 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.138 | L2-Norm(final)=15.041 | 4355.7 samples/s | 68.1 steps/s
[Step=30600 Epoch=149.3] | Loss=0.03276 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.170 | L2-Norm(final)=15.037 | 4877.3 samples/s | 76.2 steps/s
[Step=30650 Epoch=149.6] | Loss=0.03006 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.194 | L2-Norm(final)=15.035 | 4836.3 samples/s | 75.6 steps/s
[Step=30700 Epoch=149.8] | Loss=0.02661 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.212 | L2-Norm(final)=15.035 | 6917.4 samples/s | 108.1 steps/s
[Step=30750 Epoch=150.0] | Loss=0.02334 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.227 | L2-Norm(final)=15.037 | 2251.1 samples/s | 35.2 steps/s
[Step=30800 Epoch=150.3] | Loss=0.02104 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.239 | L2-Norm(final)=15.040 | 4868.6 samples/s | 76.1 steps/s
[Step=30850 Epoch=150.5] | Loss=0.01904 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.249 | L2-Norm(final)=15.043 | 4929.6 samples/s | 77.0 steps/s
[Step=30900 Epoch=150.8] | Loss=0.01759 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.259 | L2-Norm(final)=15.046 | 6289.6 samples/s | 98.3 steps/s
[Step=30950 Epoch=151.0] | Loss=0.01630 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.267 | L2-Norm(final)=15.050 | 2291.4 samples/s | 35.8 steps/s
[Step=31000 Epoch=151.3] | Loss=0.01525 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.274 | L2-Norm(final)=15.053 | 4863.4 samples/s | 76.0 steps/s
[Step=31050 Epoch=151.5] | Loss=0.01435 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.281 | L2-Norm(final)=15.057 | 4908.0 samples/s | 76.7 steps/s
[Step=31100 Epoch=151.8] | Loss=0.01368 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.286 | L2-Norm(final)=15.060 | 5945.0 samples/s | 92.9 steps/s
[Step=31150 Epoch=152.0] | Loss=0.01299 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.292 | L2-Norm(final)=15.063 | 2388.0 samples/s | 37.3 steps/s
[Step=31200 Epoch=152.2] | Loss=0.01232 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.297 | L2-Norm(final)=15.065 | 4885.2 samples/s | 76.3 steps/s
[Step=31250 Epoch=152.5] | Loss=0.01178 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.302 | L2-Norm(final)=15.068 | 4806.3 samples/s | 75.1 steps/s
[Step=31300 Epoch=152.7] | Loss=0.01131 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.306 | L2-Norm(final)=15.071 | 5606.8 samples/s | 87.6 steps/s
[Step=31350 Epoch=153.0] | Loss=0.01100 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.310 | L2-Norm(final)=15.074 | 2455.0 samples/s | 38.4 steps/s
[Step=31400 Epoch=153.2] | Loss=0.01053 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.313 | L2-Norm(final)=15.076 | 4900.9 samples/s | 76.6 steps/s
[Step=31450 Epoch=153.5] | Loss=0.01020 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.317 | L2-Norm(final)=15.079 | 4873.1 samples/s | 76.1 steps/s
[Step=31500 Epoch=153.7] | Loss=0.00991 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.320 | L2-Norm(final)=15.081 | 5158.1 samples/s | 80.6 steps/s
[Step=31550 Epoch=153.9] | Loss=0.00964 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.323 | L2-Norm(final)=15.083 | 2544.7 samples/s | 39.8 steps/s
[Step=31600 Epoch=154.2] | Loss=0.00932 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.326 | L2-Norm(final)=15.085 | 4907.0 samples/s | 76.7 steps/s
[Step=31650 Epoch=154.4] | Loss=0.00912 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.329 | L2-Norm(final)=15.087 | 4851.0 samples/s | 75.8 steps/s
[Step=31700 Epoch=154.7] | Loss=0.00885 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.331 | L2-Norm(final)=15.089 | 4933.0 samples/s | 77.1 steps/s
[Step=31750 Epoch=154.9] | Loss=0.00861 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.333 | L2-Norm(final)=15.091 | 2610.1 samples/s | 40.8 steps/s
[Step=31800 Epoch=155.2] | Loss=0.00835 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.335 | L2-Norm(final)=15.094 | 4812.9 samples/s | 75.2 steps/s
[Step=31850 Epoch=155.4] | Loss=0.00816 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.338 | L2-Norm(final)=15.096 | 4845.6 samples/s | 75.7 steps/s
[Step=31900 Epoch=155.7] | Loss=0.00804 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=15.098 | 4955.8 samples/s | 77.4 steps/s
[Step=31950 Epoch=155.9] | Loss=0.00786 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=15.099 | 2625.9 samples/s | 41.0 steps/s
[Step=32000 Epoch=156.1] | Loss=0.00771 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.343 | L2-Norm(final)=15.101 | 4791.7 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step32000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.01474 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.096 | L2-Norm(final)=13.330 | 6075.5 samples/s | 94.9 steps/s
[Step=20050 Epoch=97.7] | Loss=0.03399 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.096 | L2-Norm(final)=13.336 | 4781.8 samples/s | 74.7 steps/s
[Step=20100 Epoch=97.9] | Loss=0.03578 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.096 | L2-Norm(final)=13.342 | 5766.7 samples/s | 90.1 steps/s
[Step=20150 Epoch=98.2] | Loss=0.03349 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.096 | L2-Norm(final)=13.348 | 5537.4 samples/s | 86.5 steps/s
[Step=20200 Epoch=98.4] | Loss=0.03396 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.096 | L2-Norm(final)=13.355 | 8649.2 samples/s | 135.1 steps/s
[Step=20250 Epoch=98.7] | Loss=0.03308 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.096 | L2-Norm(final)=13.362 | 2445.0 samples/s | 38.2 steps/s
[Step=20300 Epoch=98.9] | Loss=0.03352 | Reg=0.00123 | acc=0.9531 | L2-Norm=11.096 | L2-Norm(final)=13.369 | 5668.2 samples/s | 88.6 steps/s
[Step=20350 Epoch=99.2] | Loss=0.03359 | Reg=0.00123 | acc=0.9531 | L2-Norm=11.096 | L2-Norm(final)=13.376 | 5605.7 samples/s | 87.6 steps/s
[Step=20400 Epoch=99.4] | Loss=0.03400 | Reg=0.00123 | acc=0.9375 | L2-Norm=11.096 | L2-Norm(final)=13.384 | 7662.9 samples/s | 119.7 steps/s
[Step=20450 Epoch=99.6] | Loss=0.03362 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.096 | L2-Norm(final)=13.391 | 2487.9 samples/s | 38.9 steps/s
[Step=20500 Epoch=99.9] | Loss=0.03331 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.096 | L2-Norm(final)=13.398 | 5616.1 samples/s | 87.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=99.9] | Loss=0.02256 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.096 | L2-Norm(final)=13.474 | 5800.9 samples/s | 90.6 steps/s
[Step=20550 Epoch=100.1] | Loss=0.03271 | Reg=0.00124 | acc=0.9688 | L2-Norm=11.130 | L2-Norm(final)=13.477 | 4428.2 samples/s | 69.2 steps/s
[Step=20600 Epoch=100.4] | Loss=0.03043 | Reg=0.00125 | acc=0.9688 | L2-Norm=11.161 | L2-Norm(final)=13.476 | 4880.8 samples/s | 76.3 steps/s
[Step=20650 Epoch=100.6] | Loss=0.03007 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.186 | L2-Norm(final)=13.476 | 4866.7 samples/s | 76.0 steps/s
[Step=20700 Epoch=100.9] | Loss=0.02724 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.209 | L2-Norm(final)=13.476 | 6804.3 samples/s | 106.3 steps/s
[Step=20750 Epoch=101.1] | Loss=0.02375 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.228 | L2-Norm(final)=13.479 | 2274.2 samples/s | 35.5 steps/s
[Step=20800 Epoch=101.3] | Loss=0.02133 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.244 | L2-Norm(final)=13.483 | 4878.1 samples/s | 76.2 steps/s
[Step=20850 Epoch=101.6] | Loss=0.01949 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.257 | L2-Norm(final)=13.487 | 4890.3 samples/s | 76.4 steps/s
[Step=20900 Epoch=101.8] | Loss=0.01822 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.269 | L2-Norm(final)=13.490 | 6306.2 samples/s | 98.5 steps/s
[Step=20950 Epoch=102.1] | Loss=0.01681 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.280 | L2-Norm(final)=13.494 | 2320.9 samples/s | 36.3 steps/s
[Step=21000 Epoch=102.3] | Loss=0.01570 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.289 | L2-Norm(final)=13.497 | 4882.0 samples/s | 76.3 steps/s
[Step=21050 Epoch=102.6] | Loss=0.01485 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.297 | L2-Norm(final)=13.501 | 4835.1 samples/s | 75.5 steps/s
[Step=21100 Epoch=102.8] | Loss=0.01425 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.304 | L2-Norm(final)=13.504 | 5813.3 samples/s | 90.8 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01363 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.311 | L2-Norm(final)=13.507 | 2412.8 samples/s | 37.7 steps/s
[Step=21200 Epoch=103.3] | Loss=0.01320 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.318 | L2-Norm(final)=13.511 | 4868.5 samples/s | 76.1 steps/s
[Step=21250 Epoch=103.5] | Loss=0.01259 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.324 | L2-Norm(final)=13.514 | 4907.1 samples/s | 76.7 steps/s
[Step=21300 Epoch=103.8] | Loss=0.01219 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.329 | L2-Norm(final)=13.517 | 5342.3 samples/s | 83.5 steps/s
[Step=21350 Epoch=104.0] | Loss=0.01168 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.334 | L2-Norm(final)=13.519 | 2553.7 samples/s | 39.9 steps/s
[Step=21400 Epoch=104.3] | Loss=0.01130 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.339 | L2-Norm(final)=13.522 | 4767.7 samples/s | 74.5 steps/s
[Step=21450 Epoch=104.5] | Loss=0.01091 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.343 | L2-Norm(final)=13.525 | 4835.9 samples/s | 75.6 steps/s
[Step=21500 Epoch=104.8] | Loss=0.01053 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.347 | L2-Norm(final)=13.527 | 5006.1 samples/s | 78.2 steps/s
[Step=21550 Epoch=105.0] | Loss=0.01018 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.351 | L2-Norm(final)=13.530 | 2595.5 samples/s | 40.6 steps/s
[Step=21600 Epoch=105.2] | Loss=0.00985 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=13.533 | 4843.5 samples/s | 75.7 steps/s
[Step=21650 Epoch=105.5] | Loss=0.00951 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=13.536 | 4845.9 samples/s | 75.7 steps/s
[Step=21700 Epoch=105.7] | Loss=0.00935 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.361 | L2-Norm(final)=13.538 | 4939.5 samples/s | 77.2 steps/s
[Step=21750 Epoch=106.0] | Loss=0.00915 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.365 | L2-Norm(final)=13.541 | 2631.6 samples/s | 41.1 steps/s
[Step=21800 Epoch=106.2] | Loss=0.00896 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.368 | L2-Norm(final)=13.543 | 4874.1 samples/s | 76.2 steps/s
[Step=21850 Epoch=106.5] | Loss=0.00884 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.371 | L2-Norm(final)=13.545 | 4854.9 samples/s | 75.9 steps/s
[Step=21900 Epoch=106.7] | Loss=0.00866 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=13.548 | 4856.6 samples/s | 75.9 steps/s
[Step=21950 Epoch=107.0] | Loss=0.00854 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.377 | L2-Norm(final)=13.550 | 2637.4 samples/s | 41.2 steps/s
[Step=22000 Epoch=107.2] | Loss=0.00834 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=13.552 | 4875.2 samples/s | 76.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step22000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=127.5] | Loss=0.03895 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.096 | L2-Norm(final)=14.585 | 5847.8 samples/s | 91.4 steps/s
[Step=26050 Epoch=127.7] | Loss=0.03255 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.095 | L2-Norm(final)=14.584 | 4765.0 samples/s | 74.5 steps/s
[Step=26100 Epoch=128.0] | Loss=0.03388 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.095 | L2-Norm(final)=14.585 | 5699.2 samples/s | 89.1 steps/s
[Step=26150 Epoch=128.2] | Loss=0.03465 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=14.589 | 5559.1 samples/s | 86.9 steps/s
[Step=26200 Epoch=128.5] | Loss=0.03540 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=14.592 | 9065.2 samples/s | 141.6 steps/s
[Step=26250 Epoch=128.7] | Loss=0.03501 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.095 | L2-Norm(final)=14.597 | 2416.1 samples/s | 37.8 steps/s
[Step=26300 Epoch=129.0] | Loss=0.03532 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=14.603 | 5750.6 samples/s | 89.9 steps/s
[Step=26350 Epoch=129.2] | Loss=0.03539 | Reg=0.00123 | acc=0.9375 | L2-Norm=11.095 | L2-Norm(final)=14.610 | 5642.6 samples/s | 88.2 steps/s
[Step=26400 Epoch=129.5] | Loss=0.03487 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.095 | L2-Norm(final)=14.617 | 8066.3 samples/s | 126.0 steps/s
[Step=26450 Epoch=129.7] | Loss=0.03475 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.095 | L2-Norm(final)=14.624 | 2476.7 samples/s | 38.7 steps/s
[Step=26500 Epoch=130.0] | Loss=0.03478 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.095 | L2-Norm(final)=14.631 | 5645.8 samples/s | 88.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=130.0] | Loss=0.04493 | Reg=0.00123 | acc=0.9531 | L2-Norm=11.095 | L2-Norm(final)=14.701 | 5832.1 samples/s | 91.1 steps/s
[Step=26550 Epoch=130.2] | Loss=0.02814 | Reg=0.00124 | acc=0.9531 | L2-Norm=11.126 | L2-Norm(final)=14.706 | 4386.3 samples/s | 68.5 steps/s
[Step=26600 Epoch=130.4] | Loss=0.02647 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.158 | L2-Norm(final)=14.705 | 4864.0 samples/s | 76.0 steps/s
[Step=26650 Epoch=130.7] | Loss=0.02545 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.182 | L2-Norm(final)=14.704 | 4863.0 samples/s | 76.0 steps/s
[Step=26700 Epoch=130.9] | Loss=0.02401 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.201 | L2-Norm(final)=14.703 | 7114.5 samples/s | 111.2 steps/s
[Step=26750 Epoch=131.2] | Loss=0.02136 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=14.704 | 2249.0 samples/s | 35.1 steps/s
[Step=26800 Epoch=131.4] | Loss=0.01925 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.232 | L2-Norm(final)=14.707 | 4903.2 samples/s | 76.6 steps/s
[Step=26850 Epoch=131.7] | Loss=0.01749 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.244 | L2-Norm(final)=14.710 | 4833.8 samples/s | 75.5 steps/s
[Step=26900 Epoch=131.9] | Loss=0.01624 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.254 | L2-Norm(final)=14.713 | 6657.6 samples/s | 104.0 steps/s
[Step=26950 Epoch=132.2] | Loss=0.01491 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.264 | L2-Norm(final)=14.716 | 2293.8 samples/s | 35.8 steps/s
[Step=27000 Epoch=132.4] | Loss=0.01409 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.271 | L2-Norm(final)=14.719 | 4852.5 samples/s | 75.8 steps/s
[Step=27050 Epoch=132.6] | Loss=0.01349 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.277 | L2-Norm(final)=14.721 | 4962.9 samples/s | 77.5 steps/s
[Step=27100 Epoch=132.9] | Loss=0.01281 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=14.723 | 6068.2 samples/s | 94.8 steps/s
[Step=27150 Epoch=133.1] | Loss=0.01207 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.289 | L2-Norm(final)=14.726 | 2341.8 samples/s | 36.6 steps/s
[Step=27200 Epoch=133.4] | Loss=0.01150 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=14.729 | 4865.1 samples/s | 76.0 steps/s
[Step=27250 Epoch=133.6] | Loss=0.01106 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.298 | L2-Norm(final)=14.731 | 4882.5 samples/s | 76.3 steps/s
[Step=27300 Epoch=133.9] | Loss=0.01071 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.302 | L2-Norm(final)=14.733 | 5944.7 samples/s | 92.9 steps/s
[Step=27350 Epoch=134.1] | Loss=0.01033 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.306 | L2-Norm(final)=14.736 | 2396.4 samples/s | 37.4 steps/s
[Step=27400 Epoch=134.4] | Loss=0.00992 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.310 | L2-Norm(final)=14.738 | 4815.6 samples/s | 75.2 steps/s
[Step=27450 Epoch=134.6] | Loss=0.00956 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.314 | L2-Norm(final)=14.740 | 4875.4 samples/s | 76.2 steps/s
[Step=27500 Epoch=134.9] | Loss=0.00926 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.317 | L2-Norm(final)=14.743 | 5625.3 samples/s | 87.9 steps/s
[Step=27550 Epoch=135.1] | Loss=0.00896 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.320 | L2-Norm(final)=14.745 | 2462.1 samples/s | 38.5 steps/s
[Step=27600 Epoch=135.3] | Loss=0.00867 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.323 | L2-Norm(final)=14.747 | 4890.0 samples/s | 76.4 steps/s
[Step=27650 Epoch=135.6] | Loss=0.00850 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.326 | L2-Norm(final)=14.749 | 4920.6 samples/s | 76.9 steps/s
[Step=27700 Epoch=135.8] | Loss=0.00834 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.328 | L2-Norm(final)=14.751 | 5247.3 samples/s | 82.0 steps/s
[Step=27750 Epoch=136.1] | Loss=0.00818 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.331 | L2-Norm(final)=14.753 | 2495.6 samples/s | 39.0 steps/s
[Step=27800 Epoch=136.3] | Loss=0.00797 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.333 | L2-Norm(final)=14.754 | 4843.3 samples/s | 75.7 steps/s
[Step=27850 Epoch=136.6] | Loss=0.00781 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.335 | L2-Norm(final)=14.756 | 4885.7 samples/s | 76.3 steps/s
[Step=27900 Epoch=136.8] | Loss=0.00770 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.338 | L2-Norm(final)=14.758 | 5076.1 samples/s | 79.3 steps/s
[Step=27950 Epoch=137.1] | Loss=0.00756 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=14.759 | 2584.7 samples/s | 40.4 steps/s
[Step=28000 Epoch=137.3] | Loss=0.00736 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=14.761 | 4821.4 samples/s | 75.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step28000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=189.5] | Loss=0.00632 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.096 | L2-Norm(final)=13.718 | 5661.5 samples/s | 88.5 steps/s
[Step=20050 Epoch=190.0] | Loss=0.00224 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=13.731 | 4668.9 samples/s | 73.0 steps/s
[Step=20100 Epoch=190.5] | Loss=0.00297 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=13.747 | 8275.7 samples/s | 129.3 steps/s
[Step=20150 Epoch=190.9] | Loss=0.00292 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=13.759 | 2359.6 samples/s | 36.9 steps/s
[Step=20200 Epoch=191.4] | Loss=0.00283 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=13.772 | 7299.0 samples/s | 114.0 steps/s
[Step=20250 Epoch=191.9] | Loss=0.00274 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=13.784 | 2451.2 samples/s | 38.3 steps/s
[Step=20300 Epoch=192.4] | Loss=0.00282 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=13.796 | 6440.4 samples/s | 100.6 steps/s
[Step=20350 Epoch=192.8] | Loss=0.00275 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=13.808 | 2541.1 samples/s | 39.7 steps/s
[Step=20400 Epoch=193.3] | Loss=0.00287 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=13.820 | 5853.6 samples/s | 91.5 steps/s
[Step=20450 Epoch=193.8] | Loss=0.00288 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=13.832 | 2633.4 samples/s | 41.1 steps/s
[Step=20500 Epoch=194.3] | Loss=0.00286 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=13.843 | 5494.1 samples/s | 85.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=194.3] | Loss=0.00160 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=13.954 | 5744.7 samples/s | 89.8 steps/s
[Step=20550 Epoch=194.7] | Loss=0.00294 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.118 | L2-Norm(final)=13.957 | 4103.9 samples/s | 64.1 steps/s
[Step=20600 Epoch=195.2] | Loss=0.00201 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.139 | L2-Norm(final)=13.959 | 6715.4 samples/s | 104.9 steps/s
[Step=20650 Epoch=195.7] | Loss=0.00135 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.143 | L2-Norm(final)=13.962 | 2186.1 samples/s | 34.2 steps/s
[Step=20700 Epoch=196.2] | Loss=0.00102 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.141 | L2-Norm(final)=13.963 | 6071.4 samples/s | 94.9 steps/s
[Step=20750 Epoch=196.6] | Loss=0.00082 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.137 | L2-Norm(final)=13.965 | 2304.5 samples/s | 36.0 steps/s
[Step=20800 Epoch=197.1] | Loss=0.00068 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.132 | L2-Norm(final)=13.966 | 5478.5 samples/s | 85.6 steps/s
[Step=20850 Epoch=197.6] | Loss=0.00059 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.126 | L2-Norm(final)=13.967 | 2341.5 samples/s | 36.6 steps/s
[Step=20900 Epoch=198.0] | Loss=0.00052 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.119 | L2-Norm(final)=13.968 | 5144.0 samples/s | 80.4 steps/s
[Step=20950 Epoch=198.5] | Loss=0.00046 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.113 | L2-Norm(final)=13.969 | 2428.2 samples/s | 37.9 steps/s
[Step=21000 Epoch=199.0] | Loss=0.00041 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.106 | L2-Norm(final)=13.970 | 4739.6 samples/s | 74.1 steps/s
[Step=21050 Epoch=199.5] | Loss=0.00038 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.099 | L2-Norm(final)=13.971 | 2564.7 samples/s | 40.1 steps/s
[Step=21100 Epoch=199.9] | Loss=0.00035 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.092 | L2-Norm(final)=13.971 | 4664.2 samples/s | 72.9 steps/s
[Step=21150 Epoch=200.4] | Loss=0.00032 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.085 | L2-Norm(final)=13.972 | 2552.1 samples/s | 39.9 steps/s
[Step=21200 Epoch=200.9] | Loss=0.00030 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.078 | L2-Norm(final)=13.973 | 4677.8 samples/s | 73.1 steps/s
[Step=21250 Epoch=201.4] | Loss=0.00028 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.071 | L2-Norm(final)=13.974 | 2564.5 samples/s | 40.1 steps/s
[Step=21300 Epoch=201.8] | Loss=0.00026 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.064 | L2-Norm(final)=13.974 | 4618.7 samples/s | 72.2 steps/s
[Step=21350 Epoch=202.3] | Loss=0.00025 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.057 | L2-Norm(final)=13.975 | 2878.3 samples/s | 45.0 steps/s
[Step=21400 Epoch=202.8] | Loss=0.00023 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.050 | L2-Norm(final)=13.975 | 3936.7 samples/s | 61.5 steps/s
[Step=21450 Epoch=203.3] | Loss=0.00022 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.043 | L2-Norm(final)=13.976 | 6762.1 samples/s | 105.7 steps/s
[Step=21500 Epoch=203.7] | Loss=0.00021 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.035 | L2-Norm(final)=13.977 | 2161.2 samples/s | 33.8 steps/s
[Step=21550 Epoch=204.2] | Loss=0.00020 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.028 | L2-Norm(final)=13.977 | 6295.7 samples/s | 98.4 steps/s
[Step=21600 Epoch=204.7] | Loss=0.00019 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.021 | L2-Norm(final)=13.978 | 2243.9 samples/s | 35.1 steps/s
[Step=21650 Epoch=205.2] | Loss=0.00018 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.013 | L2-Norm(final)=13.978 | 5656.4 samples/s | 88.4 steps/s
[Step=21700 Epoch=205.6] | Loss=0.00018 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.006 | L2-Norm(final)=13.979 | 2318.2 samples/s | 36.2 steps/s
[Step=21750 Epoch=206.1] | Loss=0.00017 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.999 | L2-Norm(final)=13.979 | 5216.8 samples/s | 81.5 steps/s
[Step=21800 Epoch=206.6] | Loss=0.00016 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.991 | L2-Norm(final)=13.980 | 2413.3 samples/s | 37.7 steps/s
[Step=21850 Epoch=207.0] | Loss=0.00016 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.984 | L2-Norm(final)=13.980 | 4852.0 samples/s | 75.8 steps/s
[Step=21900 Epoch=207.5] | Loss=0.00015 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.976 | L2-Norm(final)=13.980 | 2553.0 samples/s | 39.9 steps/s
[Step=21950 Epoch=208.0] | Loss=0.00015 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.969 | L2-Norm(final)=13.981 | 4534.6 samples/s | 70.9 steps/s
[Step=22000 Epoch=208.5] | Loss=0.00014 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.961 | L2-Norm(final)=13.981 | 2599.4 samples/s | 40.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step22000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=18001 Epoch=171.9] | Loss=0.00014 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.096 | L2-Norm(final)=15.013 | 5727.2 samples/s | 89.5 steps/s
[Step=18050 Epoch=172.4] | Loss=0.00167 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=15.027 | 4459.8 samples/s | 69.7 steps/s
[Step=18100 Epoch=172.8] | Loss=0.00180 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=15.040 | 8490.6 samples/s | 132.7 steps/s
[Step=18150 Epoch=173.3] | Loss=0.00171 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=15.052 | 2327.1 samples/s | 36.4 steps/s
[Step=18200 Epoch=173.8] | Loss=0.00166 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=15.065 | 7695.1 samples/s | 120.2 steps/s
[Step=18250 Epoch=174.3] | Loss=0.00163 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=15.078 | 2414.8 samples/s | 37.7 steps/s
[Step=18300 Epoch=174.8] | Loss=0.00167 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=15.092 | 7021.8 samples/s | 109.7 steps/s
[Step=18350 Epoch=175.2] | Loss=0.00174 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=15.106 | 2496.5 samples/s | 39.0 steps/s
[Step=18400 Epoch=175.7] | Loss=0.00170 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=15.120 | 6397.2 samples/s | 100.0 steps/s
[Step=18450 Epoch=176.2] | Loss=0.00168 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=15.133 | 2580.9 samples/s | 40.3 steps/s
[Step=18500 Epoch=176.7] | Loss=0.00168 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=15.147 | 5641.2 samples/s | 88.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=176.7] | Loss=0.00023 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=15.283 | 5619.9 samples/s | 87.8 steps/s
[Step=18550 Epoch=177.1] | Loss=0.00076 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.108 | L2-Norm(final)=15.293 | 4167.4 samples/s | 65.1 steps/s
[Step=18600 Epoch=177.6] | Loss=0.00068 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.129 | L2-Norm(final)=15.300 | 6818.2 samples/s | 106.5 steps/s
[Step=18650 Epoch=178.1] | Loss=0.00046 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.137 | L2-Norm(final)=15.304 | 2169.8 samples/s | 33.9 steps/s
[Step=18700 Epoch=178.6] | Loss=0.00035 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.135 | L2-Norm(final)=15.306 | 6158.7 samples/s | 96.2 steps/s
[Step=18750 Epoch=179.1] | Loss=0.00028 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.130 | L2-Norm(final)=15.308 | 2246.0 samples/s | 35.1 steps/s
[Step=18800 Epoch=179.5] | Loss=0.00023 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.123 | L2-Norm(final)=15.309 | 5744.4 samples/s | 89.8 steps/s
[Step=18850 Epoch=180.0] | Loss=0.00020 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.115 | L2-Norm(final)=15.310 | 2325.2 samples/s | 36.3 steps/s
[Step=18900 Epoch=180.5] | Loss=0.00018 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.107 | L2-Norm(final)=15.310 | 5384.8 samples/s | 84.1 steps/s
[Step=18950 Epoch=181.0] | Loss=0.00016 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.098 | L2-Norm(final)=15.311 | 2392.5 samples/s | 37.4 steps/s
[Step=19000 Epoch=181.4] | Loss=0.00014 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.090 | L2-Norm(final)=15.312 | 5076.7 samples/s | 79.3 steps/s
[Step=19050 Epoch=181.9] | Loss=0.00013 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.081 | L2-Norm(final)=15.312 | 2456.5 samples/s | 38.4 steps/s
[Step=19100 Epoch=182.4] | Loss=0.00012 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.072 | L2-Norm(final)=15.313 | 4716.5 samples/s | 73.7 steps/s
[Step=19150 Epoch=182.9] | Loss=0.00011 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.062 | L2-Norm(final)=15.313 | 2566.0 samples/s | 40.1 steps/s
[Step=19200 Epoch=183.3] | Loss=0.00010 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.053 | L2-Norm(final)=15.314 | 4651.6 samples/s | 72.7 steps/s
[Step=19250 Epoch=183.8] | Loss=0.00009 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.044 | L2-Norm(final)=15.314 | 2559.9 samples/s | 40.0 steps/s
[Step=19300 Epoch=184.3] | Loss=0.00009 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.035 | L2-Norm(final)=15.314 | 4577.7 samples/s | 71.5 steps/s
[Step=19350 Epoch=184.8] | Loss=0.00008 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.026 | L2-Norm(final)=15.315 | 2604.1 samples/s | 40.7 steps/s
[Step=19400 Epoch=185.3] | Loss=0.00008 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=15.315 | 4633.0 samples/s | 72.4 steps/s
[Step=19450 Epoch=185.7] | Loss=0.00008 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.007 | L2-Norm(final)=15.316 | 2577.1 samples/s | 40.3 steps/s
[Step=19500 Epoch=186.2] | Loss=0.00007 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.998 | L2-Norm(final)=15.316 | 4607.6 samples/s | 72.0 steps/s
[Step=19550 Epoch=186.7] | Loss=0.00007 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.988 | L2-Norm(final)=15.316 | 7479.4 samples/s | 116.9 steps/s
[Step=19600 Epoch=187.2] | Loss=0.00007 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.979 | L2-Norm(final)=15.317 | 2123.5 samples/s | 33.2 steps/s
[Step=19650 Epoch=187.6] | Loss=0.00006 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.969 | L2-Norm(final)=15.317 | 6740.0 samples/s | 105.3 steps/s
[Step=19700 Epoch=188.1] | Loss=0.00006 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.960 | L2-Norm(final)=15.317 | 2189.8 samples/s | 34.2 steps/s
[Step=19750 Epoch=188.6] | Loss=0.00006 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.950 | L2-Norm(final)=15.318 | 6131.0 samples/s | 95.8 steps/s
[Step=19800 Epoch=189.1] | Loss=0.00006 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.941 | L2-Norm(final)=15.318 | 2242.4 samples/s | 35.0 steps/s
[Step=19850 Epoch=189.6] | Loss=0.00005 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.931 | L2-Norm(final)=15.318 | 5725.5 samples/s | 89.5 steps/s
[Step=19900 Epoch=190.0] | Loss=0.00005 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.922 | L2-Norm(final)=15.319 | 2299.2 samples/s | 35.9 steps/s
[Step=19950 Epoch=190.5] | Loss=0.00005 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.912 | L2-Norm(final)=15.319 | 5377.8 samples/s | 84.0 steps/s
[Step=20000 Epoch=191.0] | Loss=0.00005 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.902 | L2-Norm(final)=15.319 | 2406.2 samples/s | 37.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11061 | acc=0.9563 | tpr=0.9744 | fpr=0.0833 | 5415.8 samples/s | 21.2 steps/s
Avg test loss: 0.11709, Avg test acc: 0.95376, Avg tpr: 0.97266, Avg fpr: 0.08781, total FA: 685

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09383 | acc=0.9623 | tpr=0.9756 | fpr=0.0664 | 5491.1 samples/s | 21.4 steps/s
Avg test loss: 0.10114, Avg test acc: 0.96049, Avg tpr: 0.97348, Avg fpr: 0.06807, total FA: 531

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.10693 | acc=0.9596 | tpr=0.9748 | fpr=0.0733 | 5685.0 samples/s | 22.2 steps/s
Avg test loss: 0.11021, Avg test acc: 0.95797, Avg tpr: 0.97237, Avg fpr: 0.07371, total FA: 575

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09274 | acc=0.9584 | tpr=0.9684 | fpr=0.0632 | 5560.3 samples/s | 21.7 steps/s
Avg test loss: 0.10652, Avg test acc: 0.95424, Avg tpr: 0.96515, Avg fpr: 0.06973, total FA: 544

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09164 | acc=0.9594 | tpr=0.9704 | fpr=0.0647 | 5769.3 samples/s | 22.5 steps/s
Avg test loss: 0.09950, Avg test acc: 0.95857, Avg tpr: 0.96858, Avg fpr: 0.06345, total FA: 495

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.87447 | acc=0.2647 | tpr=0.0095 | fpr=0.1811 | 5701.4 samples/s | 22.3 steps/s
Avg test loss: 4.88080, Avg test acc: 0.26368, Avg tpr: 0.00973, Avg fpr: 0.17780, total FA: 1387

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.90851 | acc=0.2852 | tpr=0.0099 | fpr=0.1172 | 5479.0 samples/s | 21.4 steps/s
Avg test loss: 4.92305, Avg test acc: 0.28376, Avg tpr: 0.00985, Avg fpr: 0.11383, total FA: 888

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.89304 | acc=0.2515 | tpr=0.0123 | fpr=0.2292 | 5631.1 samples/s | 22.0 steps/s
Avg test loss: 5.89691, Avg test acc: 0.25074, Avg tpr: 0.01317, Avg fpr: 0.22677, total FA: 1769

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.71897 | acc=0.2923 | tpr=0.0169 | fpr=0.1095 | 5548.2 samples/s | 21.7 steps/s
Avg test loss: 4.72579, Avg test acc: 0.29161, Avg tpr: 0.01708, Avg fpr: 0.10460, total FA: 816

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.94260 | acc=0.3017 | tpr=0.0114 | fpr=0.0679 | 5801.3 samples/s | 22.7 steps/s
Avg test loss: 4.95377, Avg test acc: 0.29902, Avg tpr: 0.01142, Avg fpr: 0.06845, total FA: 534

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.14756 | acc=0.1296 | tpr=0.3628 | fpr=0.8746 | 5731.4 samples/s | 22.4 steps/s
[Step= 100] | Loss=6.10270 | acc=0.1296 | tpr=0.3241 | fpr=0.8740 | 8178.2 samples/s | 31.9 steps/s
[Step= 150] | Loss=6.11391 | acc=0.1289 | tpr=0.3228 | fpr=0.8746 | 7608.7 samples/s | 29.7 steps/s
[Step= 200] | Loss=6.10875 | acc=0.1290 | tpr=0.3191 | fpr=0.8744 | 8008.9 samples/s | 31.3 steps/s
[Step= 250] | Loss=6.11095 | acc=0.1292 | tpr=0.3301 | fpr=0.8745 | 8123.1 samples/s | 31.7 steps/s
[Step= 300] | Loss=6.10822 | acc=0.1286 | tpr=0.3258 | fpr=0.8750 | 7752.6 samples/s | 30.3 steps/s
[Step= 350] | Loss=6.10818 | acc=0.1281 | tpr=0.3131 | fpr=0.8753 | 8217.8 samples/s | 32.1 steps/s
[Step= 400] | Loss=6.10527 | acc=0.1285 | tpr=0.3129 | fpr=0.8748 | 8112.5 samples/s | 31.7 steps/s
[Step= 450] | Loss=6.10610 | acc=0.1288 | tpr=0.3165 | fpr=0.8746 | 8077.0 samples/s | 31.6 steps/s
[Step= 500] | Loss=6.10876 | acc=0.1291 | tpr=0.3154 | fpr=0.8743 | 8563.3 samples/s | 33.5 steps/s
[Step= 550] | Loss=6.10600 | acc=0.1289 | tpr=0.3084 | fpr=0.8744 | 10574.8 samples/s | 41.3 steps/s
Avg test loss: 6.10619, Avg test acc: 0.12877, Avg tpr: 0.30824, Avg fpr: 0.87449, total FA: 121421

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.65779 | acc=0.1282 | tpr=0.2478 | fpr=0.8739 | 5482.9 samples/s | 21.4 steps/s
[Step= 100] | Loss=5.58978 | acc=0.1301 | tpr=0.2111 | fpr=0.8714 | 8037.3 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.59824 | acc=0.1285 | tpr=0.2017 | fpr=0.8729 | 8165.3 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.59539 | acc=0.1289 | tpr=0.2022 | fpr=0.8724 | 8803.2 samples/s | 34.4 steps/s
[Step= 250] | Loss=5.60154 | acc=0.1293 | tpr=0.2017 | fpr=0.8720 | 7728.0 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.60611 | acc=0.1287 | tpr=0.2029 | fpr=0.8726 | 8246.0 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.60817 | acc=0.1284 | tpr=0.1954 | fpr=0.8729 | 7775.3 samples/s | 30.4 steps/s
[Step= 400] | Loss=5.60584 | acc=0.1290 | tpr=0.1986 | fpr=0.8723 | 8406.3 samples/s | 32.8 steps/s
[Step= 450] | Loss=5.60685 | acc=0.1290 | tpr=0.1947 | fpr=0.8722 | 7399.0 samples/s | 28.9 steps/s
[Step= 500] | Loss=5.60769 | acc=0.1290 | tpr=0.1974 | fpr=0.8722 | 8360.0 samples/s | 32.7 steps/s
[Step= 550] | Loss=5.60527 | acc=0.1292 | tpr=0.1970 | fpr=0.8721 | 10140.8 samples/s | 39.6 steps/s
Avg test loss: 5.60525, Avg test acc: 0.12910, Avg tpr: 0.19731, Avg fpr: 0.87214, total FA: 121095

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.23136 | acc=0.1223 | tpr=0.1637 | fpr=0.8785 | 5670.5 samples/s | 22.2 steps/s
[Step= 100] | Loss=6.17671 | acc=0.1232 | tpr=0.1429 | fpr=0.8772 | 7654.1 samples/s | 29.9 steps/s
[Step= 150] | Loss=6.18268 | acc=0.1235 | tpr=0.1383 | fpr=0.8768 | 7545.6 samples/s | 29.5 steps/s
[Step= 200] | Loss=6.17227 | acc=0.1238 | tpr=0.1344 | fpr=0.8764 | 8214.0 samples/s | 32.1 steps/s
[Step= 250] | Loss=6.16943 | acc=0.1243 | tpr=0.1336 | fpr=0.8758 | 7990.5 samples/s | 31.2 steps/s
[Step= 300] | Loss=6.17488 | acc=0.1240 | tpr=0.1338 | fpr=0.8761 | 8351.0 samples/s | 32.6 steps/s
[Step= 350] | Loss=6.17837 | acc=0.1233 | tpr=0.1315 | fpr=0.8769 | 7936.1 samples/s | 31.0 steps/s
[Step= 400] | Loss=6.17556 | acc=0.1237 | tpr=0.1379 | fpr=0.8766 | 8354.1 samples/s | 32.6 steps/s
[Step= 450] | Loss=6.17517 | acc=0.1237 | tpr=0.1358 | fpr=0.8765 | 7465.0 samples/s | 29.2 steps/s
[Step= 500] | Loss=6.17676 | acc=0.1236 | tpr=0.1344 | fpr=0.8766 | 8536.9 samples/s | 33.3 steps/s
[Step= 550] | Loss=6.17371 | acc=0.1235 | tpr=0.1337 | fpr=0.8767 | 11137.1 samples/s | 43.5 steps/s
Avg test loss: 6.17369, Avg test acc: 0.12339, Avg tpr: 0.13391, Avg fpr: 0.87680, total FA: 121742

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.91997 | acc=0.1525 | tpr=0.2566 | fpr=0.8494 | 5889.0 samples/s | 23.0 steps/s
[Step= 100] | Loss=5.87604 | acc=0.1515 | tpr=0.2367 | fpr=0.8501 | 8029.3 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.88329 | acc=0.1501 | tpr=0.2320 | fpr=0.8514 | 7810.7 samples/s | 30.5 steps/s
[Step= 200] | Loss=5.87069 | acc=0.1508 | tpr=0.2240 | fpr=0.8506 | 7757.0 samples/s | 30.3 steps/s
[Step= 250] | Loss=5.87610 | acc=0.1510 | tpr=0.2262 | fpr=0.8504 | 7608.2 samples/s | 29.7 steps/s
[Step= 300] | Loss=5.87900 | acc=0.1501 | tpr=0.2276 | fpr=0.8513 | 8330.4 samples/s | 32.5 steps/s
[Step= 350] | Loss=5.87943 | acc=0.1493 | tpr=0.2173 | fpr=0.8520 | 8091.2 samples/s | 31.6 steps/s
[Step= 400] | Loss=5.87457 | acc=0.1497 | tpr=0.2183 | fpr=0.8516 | 7870.6 samples/s | 30.7 steps/s
[Step= 450] | Loss=5.87553 | acc=0.1496 | tpr=0.2132 | fpr=0.8515 | 8438.0 samples/s | 33.0 steps/s
[Step= 500] | Loss=5.87891 | acc=0.1494 | tpr=0.2132 | fpr=0.8518 | 8229.8 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.87731 | acc=0.1495 | tpr=0.2121 | fpr=0.8517 | 10314.3 samples/s | 40.3 steps/s
Avg test loss: 5.87790, Avg test acc: 0.14939, Avg tpr: 0.21197, Avg fpr: 0.85174, total FA: 118263

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.83147 | acc=0.1291 | tpr=0.1726 | fpr=0.8717 | 5562.2 samples/s | 21.7 steps/s
[Step= 100] | Loss=6.76763 | acc=0.1297 | tpr=0.1599 | fpr=0.8708 | 7589.2 samples/s | 29.6 steps/s
[Step= 150] | Loss=6.78677 | acc=0.1290 | tpr=0.1470 | fpr=0.8714 | 8391.4 samples/s | 32.8 steps/s
[Step= 200] | Loss=6.78123 | acc=0.1290 | tpr=0.1421 | fpr=0.8712 | 8548.9 samples/s | 33.4 steps/s
[Step= 250] | Loss=6.78896 | acc=0.1289 | tpr=0.1397 | fpr=0.8713 | 8022.0 samples/s | 31.3 steps/s
[Step= 300] | Loss=6.79505 | acc=0.1283 | tpr=0.1389 | fpr=0.8719 | 7979.4 samples/s | 31.2 steps/s
[Step= 350] | Loss=6.80061 | acc=0.1277 | tpr=0.1340 | fpr=0.8724 | 7969.7 samples/s | 31.1 steps/s
[Step= 400] | Loss=6.79786 | acc=0.1281 | tpr=0.1379 | fpr=0.8721 | 7991.5 samples/s | 31.2 steps/s
[Step= 450] | Loss=6.79735 | acc=0.1283 | tpr=0.1373 | fpr=0.8719 | 8542.6 samples/s | 33.4 steps/s
[Step= 500] | Loss=6.80058 | acc=0.1281 | tpr=0.1405 | fpr=0.8721 | 7355.5 samples/s | 28.7 steps/s
[Step= 550] | Loss=6.79885 | acc=0.1279 | tpr=0.1389 | fpr=0.8723 | 10640.6 samples/s | 41.6 steps/s
Avg test loss: 6.79872, Avg test acc: 0.12776, Avg tpr: 0.13906, Avg fpr: 0.87245, total FA: 121138

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10215 | acc=0.9824 | tpr=0.9071 | fpr=0.0162 | 5755.0 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.10469 | acc=0.9822 | tpr=0.9190 | fpr=0.0166 | 8051.9 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.10862 | acc=0.9817 | tpr=0.9222 | fpr=0.0172 | 7475.3 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.11055 | acc=0.9818 | tpr=0.9322 | fpr=0.0173 | 8515.4 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.11088 | acc=0.9818 | tpr=0.9284 | fpr=0.0173 | 8862.4 samples/s | 34.6 steps/s
[Step= 300] | Loss=0.11238 | acc=0.9817 | tpr=0.9273 | fpr=0.0173 | 7347.2 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.11273 | acc=0.9816 | tpr=0.9292 | fpr=0.0174 | 8452.6 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.11351 | acc=0.9815 | tpr=0.9261 | fpr=0.0175 | 7815.5 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.11593 | acc=0.9811 | tpr=0.9250 | fpr=0.0179 | 8628.4 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.11502 | acc=0.9813 | tpr=0.9278 | fpr=0.0177 | 7719.7 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.11435 | acc=0.9813 | tpr=0.9280 | fpr=0.0177 | 9993.9 samples/s | 39.0 steps/s
Avg test loss: 0.11414, Avg test acc: 0.98131, Avg tpr: 0.92750, Avg fpr: 0.01771, total FA: 2459

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10592 | acc=0.9809 | tpr=0.8894 | fpr=0.0174 | 5592.7 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.10939 | acc=0.9808 | tpr=0.9083 | fpr=0.0179 | 8317.2 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.11339 | acc=0.9804 | tpr=0.9150 | fpr=0.0184 | 8095.1 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.11490 | acc=0.9804 | tpr=0.9191 | fpr=0.0185 | 7466.8 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.11485 | acc=0.9804 | tpr=0.9170 | fpr=0.0184 | 8168.7 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.11640 | acc=0.9803 | tpr=0.9193 | fpr=0.0186 | 8277.5 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.11653 | acc=0.9802 | tpr=0.9217 | fpr=0.0187 | 7920.0 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.11760 | acc=0.9800 | tpr=0.9174 | fpr=0.0188 | 8074.4 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.11961 | acc=0.9798 | tpr=0.9163 | fpr=0.0190 | 8418.6 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.11872 | acc=0.9800 | tpr=0.9189 | fpr=0.0188 | 8208.7 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.11786 | acc=0.9801 | tpr=0.9184 | fpr=0.0187 | 9951.8 samples/s | 38.9 steps/s
Avg test loss: 0.11761, Avg test acc: 0.98014, Avg tpr: 0.91799, Avg fpr: 0.01873, total FA: 2600

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12187 | acc=0.9782 | tpr=0.9381 | fpr=0.0211 | 5389.6 samples/s | 21.1 steps/s
[Step= 100] | Loss=0.12551 | acc=0.9775 | tpr=0.9531 | fpr=0.0220 | 8159.9 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.12990 | acc=0.9767 | tpr=0.9539 | fpr=0.0229 | 8111.3 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.13249 | acc=0.9768 | tpr=0.9563 | fpr=0.0228 | 8331.2 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.13359 | acc=0.9767 | tpr=0.9555 | fpr=0.0229 | 8162.8 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.13503 | acc=0.9765 | tpr=0.9520 | fpr=0.0231 | 8065.7 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.13518 | acc=0.9764 | tpr=0.9543 | fpr=0.0232 | 8223.0 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.13616 | acc=0.9762 | tpr=0.9502 | fpr=0.0233 | 8264.9 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.13828 | acc=0.9759 | tpr=0.9469 | fpr=0.0236 | 7521.8 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.13729 | acc=0.9761 | tpr=0.9485 | fpr=0.0234 | 8090.4 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.13637 | acc=0.9763 | tpr=0.9487 | fpr=0.0232 | 10573.2 samples/s | 41.3 steps/s
Avg test loss: 0.13605, Avg test acc: 0.97631, Avg tpr: 0.94849, Avg fpr: 0.02318, total FA: 3219

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09092 | acc=0.9827 | tpr=0.9071 | fpr=0.0159 | 5718.5 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.09442 | acc=0.9822 | tpr=0.9147 | fpr=0.0165 | 7625.9 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.09885 | acc=0.9814 | tpr=0.9207 | fpr=0.0175 | 7909.2 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.10085 | acc=0.9811 | tpr=0.9180 | fpr=0.0177 | 7823.6 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.10080 | acc=0.9812 | tpr=0.9127 | fpr=0.0176 | 8491.9 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.10235 | acc=0.9810 | tpr=0.9135 | fpr=0.0177 | 7797.6 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.10260 | acc=0.9810 | tpr=0.9142 | fpr=0.0178 | 8420.3 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.10309 | acc=0.9809 | tpr=0.9130 | fpr=0.0179 | 7774.2 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.10476 | acc=0.9807 | tpr=0.9119 | fpr=0.0181 | 8496.7 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.10452 | acc=0.9807 | tpr=0.9145 | fpr=0.0181 | 8397.1 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.10397 | acc=0.9807 | tpr=0.9144 | fpr=0.0181 | 10484.5 samples/s | 41.0 steps/s
Avg test loss: 0.10375, Avg test acc: 0.98071, Avg tpr: 0.91403, Avg fpr: 0.01808, total FA: 2510

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10876 | acc=0.9798 | tpr=0.9071 | fpr=0.0188 | 5658.6 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.11432 | acc=0.9800 | tpr=0.9232 | fpr=0.0189 | 7590.8 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.12040 | acc=0.9790 | tpr=0.9222 | fpr=0.0199 | 8005.0 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.12166 | acc=0.9790 | tpr=0.9191 | fpr=0.0199 | 8884.9 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.12115 | acc=0.9793 | tpr=0.9179 | fpr=0.0196 | 8214.3 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.12340 | acc=0.9793 | tpr=0.9171 | fpr=0.0196 | 7716.9 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.12385 | acc=0.9791 | tpr=0.9161 | fpr=0.0197 | 7798.5 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.12444 | acc=0.9791 | tpr=0.9152 | fpr=0.0197 | 8421.4 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.12662 | acc=0.9788 | tpr=0.9133 | fpr=0.0200 | 8028.3 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.12603 | acc=0.9790 | tpr=0.9141 | fpr=0.0199 | 8057.6 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.12536 | acc=0.9790 | tpr=0.9156 | fpr=0.0198 | 10257.5 samples/s | 40.1 steps/s
Avg test loss: 0.12523, Avg test acc: 0.97902, Avg tpr: 0.91482, Avg fpr: 0.01981, total FA: 2751

server round 21/50

clients selected: [1 3 6 7 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=32001 Epoch=156.2] | Loss=0.01198 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.965 | L2-Norm(final)=15.157 | 5619.4 samples/s | 87.8 steps/s
[Step=32050 Epoch=156.4] | Loss=0.02893 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.966 | L2-Norm(final)=15.156 | 5301.2 samples/s | 82.8 steps/s
[Step=32100 Epoch=156.6] | Loss=0.03042 | Reg=0.00120 | acc=0.9531 | L2-Norm=10.966 | L2-Norm(final)=15.150 | 5534.3 samples/s | 86.5 steps/s
[Step=32150 Epoch=156.9] | Loss=0.03036 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.966 | L2-Norm(final)=15.147 | 5595.7 samples/s | 87.4 steps/s
[Step=32200 Epoch=157.1] | Loss=0.02997 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.966 | L2-Norm(final)=15.145 | 8768.3 samples/s | 137.0 steps/s
[Step=32250 Epoch=157.4] | Loss=0.02999 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.966 | L2-Norm(final)=15.142 | 2416.5 samples/s | 37.8 steps/s
[Step=32300 Epoch=157.6] | Loss=0.03118 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.966 | L2-Norm(final)=15.138 | 5709.6 samples/s | 89.2 steps/s
[Step=32350 Epoch=157.9] | Loss=0.03081 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.966 | L2-Norm(final)=15.134 | 5540.2 samples/s | 86.6 steps/s
[Step=32400 Epoch=158.1] | Loss=0.03039 | Reg=0.00120 | acc=0.9531 | L2-Norm=10.966 | L2-Norm(final)=15.132 | 7999.4 samples/s | 125.0 steps/s
[Step=32450 Epoch=158.3] | Loss=0.03036 | Reg=0.00120 | acc=0.9531 | L2-Norm=10.966 | L2-Norm(final)=15.131 | 2506.5 samples/s | 39.2 steps/s
[Step=32500 Epoch=158.6] | Loss=0.03010 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.966 | L2-Norm(final)=15.130 | 5615.2 samples/s | 87.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=32501 Epoch=158.6] | Loss=0.01944 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.966 | L2-Norm(final)=15.122 | 6082.1 samples/s | 95.0 steps/s
[Step=32550 Epoch=158.8] | Loss=0.03677 | Reg=0.00121 | acc=0.9531 | L2-Norm=11.004 | L2-Norm(final)=15.115 | 4233.7 samples/s | 66.2 steps/s
[Step=32600 Epoch=159.1] | Loss=0.03621 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.046 | L2-Norm(final)=15.110 | 4867.1 samples/s | 76.0 steps/s
[Step=32650 Epoch=159.3] | Loss=0.03139 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.074 | L2-Norm(final)=15.107 | 4857.2 samples/s | 75.9 steps/s
[Step=32700 Epoch=159.6] | Loss=0.02954 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.096 | L2-Norm(final)=15.105 | 6993.0 samples/s | 109.3 steps/s
[Step=32750 Epoch=159.8] | Loss=0.02565 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.115 | L2-Norm(final)=15.106 | 2238.2 samples/s | 35.0 steps/s
[Step=32800 Epoch=160.0] | Loss=0.02282 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.130 | L2-Norm(final)=15.108 | 4880.6 samples/s | 76.3 steps/s
[Step=32850 Epoch=160.3] | Loss=0.02059 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.143 | L2-Norm(final)=15.111 | 4857.6 samples/s | 75.9 steps/s
[Step=32900 Epoch=160.5] | Loss=0.01911 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.154 | L2-Norm(final)=15.113 | 6501.1 samples/s | 101.6 steps/s
[Step=32950 Epoch=160.8] | Loss=0.01754 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.164 | L2-Norm(final)=15.116 | 2320.4 samples/s | 36.3 steps/s
[Step=33000 Epoch=161.0] | Loss=0.01640 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.172 | L2-Norm(final)=15.118 | 4802.7 samples/s | 75.0 steps/s
[Step=33050 Epoch=161.3] | Loss=0.01556 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.179 | L2-Norm(final)=15.121 | 4894.8 samples/s | 76.5 steps/s
[Step=33100 Epoch=161.5] | Loss=0.01486 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.185 | L2-Norm(final)=15.123 | 5962.2 samples/s | 93.2 steps/s
[Step=33150 Epoch=161.8] | Loss=0.01393 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.190 | L2-Norm(final)=15.125 | 2404.9 samples/s | 37.6 steps/s
[Step=33200 Epoch=162.0] | Loss=0.01321 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.195 | L2-Norm(final)=15.127 | 4858.2 samples/s | 75.9 steps/s
[Step=33250 Epoch=162.2] | Loss=0.01268 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.200 | L2-Norm(final)=15.129 | 4778.5 samples/s | 74.7 steps/s
[Step=33300 Epoch=162.5] | Loss=0.01225 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.204 | L2-Norm(final)=15.132 | 5644.4 samples/s | 88.2 steps/s
[Step=33350 Epoch=162.7] | Loss=0.01175 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.208 | L2-Norm(final)=15.134 | 2452.7 samples/s | 38.3 steps/s
[Step=33400 Epoch=163.0] | Loss=0.01122 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.212 | L2-Norm(final)=15.136 | 4890.3 samples/s | 76.4 steps/s
[Step=33450 Epoch=163.2] | Loss=0.01088 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.216 | L2-Norm(final)=15.138 | 4869.7 samples/s | 76.1 steps/s
[Step=33500 Epoch=163.5] | Loss=0.01063 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.219 | L2-Norm(final)=15.140 | 5280.2 samples/s | 82.5 steps/s
[Step=33550 Epoch=163.7] | Loss=0.01026 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.222 | L2-Norm(final)=15.142 | 2534.7 samples/s | 39.6 steps/s
[Step=33600 Epoch=164.0] | Loss=0.00992 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.225 | L2-Norm(final)=15.144 | 4908.7 samples/s | 76.7 steps/s
[Step=33650 Epoch=164.2] | Loss=0.00966 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.228 | L2-Norm(final)=15.146 | 4838.3 samples/s | 75.6 steps/s
[Step=33700 Epoch=164.4] | Loss=0.00946 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=15.148 | 4932.8 samples/s | 77.1 steps/s
[Step=33750 Epoch=164.7] | Loss=0.00927 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.233 | L2-Norm(final)=15.149 | 2615.9 samples/s | 40.9 steps/s
[Step=33800 Epoch=164.9] | Loss=0.00899 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.236 | L2-Norm(final)=15.151 | 4968.1 samples/s | 77.6 steps/s
[Step=33850 Epoch=165.2] | Loss=0.00875 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.238 | L2-Norm(final)=15.153 | 4761.3 samples/s | 74.4 steps/s
[Step=33900 Epoch=165.4] | Loss=0.00854 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.240 | L2-Norm(final)=15.155 | 4890.9 samples/s | 76.4 steps/s
[Step=33950 Epoch=165.7] | Loss=0.00835 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.242 | L2-Norm(final)=15.157 | 2627.5 samples/s | 41.1 steps/s
[Step=34000 Epoch=165.9] | Loss=0.00815 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.244 | L2-Norm(final)=15.158 | 4935.1 samples/s | 77.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step34000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=107.3] | Loss=0.05124 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.965 | L2-Norm(final)=14.194 | 5995.7 samples/s | 93.7 steps/s
[Step=22050 Epoch=107.5] | Loss=0.03118 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.964 | L2-Norm(final)=14.182 | 4727.7 samples/s | 73.9 steps/s
[Step=22100 Epoch=107.8] | Loss=0.03024 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.964 | L2-Norm(final)=14.180 | 5586.6 samples/s | 87.3 steps/s
[Step=22150 Epoch=108.0] | Loss=0.02879 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.964 | L2-Norm(final)=14.179 | 5662.9 samples/s | 88.5 steps/s
[Step=22200 Epoch=108.3] | Loss=0.02874 | Reg=0.00120 | acc=0.9531 | L2-Norm=10.964 | L2-Norm(final)=14.181 | 8746.6 samples/s | 136.7 steps/s
[Step=22250 Epoch=108.5] | Loss=0.02850 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.964 | L2-Norm(final)=14.183 | 2448.1 samples/s | 38.3 steps/s
[Step=22300 Epoch=108.7] | Loss=0.02829 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.964 | L2-Norm(final)=14.185 | 5690.0 samples/s | 88.9 steps/s
[Step=22350 Epoch=109.0] | Loss=0.02854 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.964 | L2-Norm(final)=14.188 | 5502.7 samples/s | 86.0 steps/s
[Step=22400 Epoch=109.2] | Loss=0.02839 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.964 | L2-Norm(final)=14.191 | 7702.8 samples/s | 120.4 steps/s
[Step=22450 Epoch=109.5] | Loss=0.02839 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.964 | L2-Norm(final)=14.195 | 2551.4 samples/s | 39.9 steps/s
[Step=22500 Epoch=109.7] | Loss=0.02811 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.964 | L2-Norm(final)=14.198 | 5575.4 samples/s | 87.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=109.7] | Loss=0.02311 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.964 | L2-Norm(final)=14.237 | 6047.5 samples/s | 94.5 steps/s
[Step=22550 Epoch=110.0] | Loss=0.02879 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.996 | L2-Norm(final)=14.236 | 4276.2 samples/s | 66.8 steps/s
[Step=22600 Epoch=110.2] | Loss=0.02893 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.023 | L2-Norm(final)=14.231 | 4918.1 samples/s | 76.8 steps/s
[Step=22650 Epoch=110.5] | Loss=0.02642 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.047 | L2-Norm(final)=14.228 | 4811.2 samples/s | 75.2 steps/s
[Step=22700 Epoch=110.7] | Loss=0.02303 | Reg=0.00122 | acc=0.9688 | L2-Norm=11.066 | L2-Norm(final)=14.228 | 6914.7 samples/s | 108.0 steps/s
[Step=22750 Epoch=110.9] | Loss=0.02041 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.081 | L2-Norm(final)=14.229 | 2252.1 samples/s | 35.2 steps/s
[Step=22800 Epoch=111.2] | Loss=0.01829 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.092 | L2-Norm(final)=14.231 | 4862.0 samples/s | 76.0 steps/s
[Step=22850 Epoch=111.4] | Loss=0.01733 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=14.233 | 4834.2 samples/s | 75.5 steps/s
[Step=22900 Epoch=111.7] | Loss=0.01595 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.111 | L2-Norm(final)=14.235 | 6359.0 samples/s | 99.4 steps/s
[Step=22950 Epoch=111.9] | Loss=0.01464 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.118 | L2-Norm(final)=14.237 | 2346.7 samples/s | 36.7 steps/s
[Step=23000 Epoch=112.2] | Loss=0.01380 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.124 | L2-Norm(final)=14.240 | 4800.2 samples/s | 75.0 steps/s
[Step=23050 Epoch=112.4] | Loss=0.01315 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.130 | L2-Norm(final)=14.242 | 4888.7 samples/s | 76.4 steps/s
[Step=23100 Epoch=112.6] | Loss=0.01249 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.135 | L2-Norm(final)=14.244 | 5827.6 samples/s | 91.1 steps/s
[Step=23150 Epoch=112.9] | Loss=0.01203 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.139 | L2-Norm(final)=14.247 | 2406.2 samples/s | 37.6 steps/s
[Step=23200 Epoch=113.1] | Loss=0.01155 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.144 | L2-Norm(final)=14.249 | 4853.9 samples/s | 75.8 steps/s
[Step=23250 Epoch=113.4] | Loss=0.01121 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.148 | L2-Norm(final)=14.250 | 4901.1 samples/s | 76.6 steps/s
[Step=23300 Epoch=113.6] | Loss=0.01073 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=14.252 | 5317.8 samples/s | 83.1 steps/s
[Step=23350 Epoch=113.9] | Loss=0.01037 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=14.254 | 2511.8 samples/s | 39.2 steps/s
[Step=23400 Epoch=114.1] | Loss=0.00998 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.158 | L2-Norm(final)=14.256 | 4917.4 samples/s | 76.8 steps/s
[Step=23450 Epoch=114.4] | Loss=0.00961 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.161 | L2-Norm(final)=14.258 | 4831.1 samples/s | 75.5 steps/s
[Step=23500 Epoch=114.6] | Loss=0.00933 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.163 | L2-Norm(final)=14.260 | 4974.9 samples/s | 77.7 steps/s
[Step=23550 Epoch=114.8] | Loss=0.00911 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.166 | L2-Norm(final)=14.262 | 2594.3 samples/s | 40.5 steps/s
[Step=23600 Epoch=115.1] | Loss=0.00880 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.168 | L2-Norm(final)=14.263 | 4822.8 samples/s | 75.4 steps/s
[Step=23650 Epoch=115.3] | Loss=0.00860 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.170 | L2-Norm(final)=14.265 | 4867.1 samples/s | 76.0 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00840 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.172 | L2-Norm(final)=14.267 | 4879.4 samples/s | 76.2 steps/s
[Step=23750 Epoch=115.8] | Loss=0.00818 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=14.268 | 2653.1 samples/s | 41.5 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00800 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=14.270 | 4768.4 samples/s | 74.5 steps/s
[Step=23850 Epoch=116.3] | Loss=0.00783 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=14.272 | 4845.5 samples/s | 75.7 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00768 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.180 | L2-Norm(final)=14.273 | 4859.6 samples/s | 75.9 steps/s
[Step=23950 Epoch=116.8] | Loss=0.00749 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.181 | L2-Norm(final)=14.275 | 2725.6 samples/s | 42.6 steps/s
[Step=24000 Epoch=117.0] | Loss=0.00735 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.183 | L2-Norm(final)=14.277 | 4717.5 samples/s | 73.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step24000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=190.3] | Loss=0.00054 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.965 | L2-Norm(final)=13.809 | 5784.8 samples/s | 90.4 steps/s
[Step=20050 Epoch=190.7] | Loss=0.00352 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=13.820 | 4534.2 samples/s | 70.8 steps/s
[Step=20100 Epoch=191.2] | Loss=0.00325 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=13.841 | 8428.7 samples/s | 131.7 steps/s
[Step=20150 Epoch=191.7] | Loss=0.00308 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=13.863 | 2335.8 samples/s | 36.5 steps/s
[Step=20200 Epoch=192.2] | Loss=0.00299 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=13.884 | 7480.8 samples/s | 116.9 steps/s
[Step=20250 Epoch=192.6] | Loss=0.00320 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=13.903 | 2410.9 samples/s | 37.7 steps/s
[Step=20300 Epoch=193.1] | Loss=0.00308 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=13.921 | 6680.8 samples/s | 104.4 steps/s
[Step=20350 Epoch=193.6] | Loss=0.00316 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=13.939 | 2551.2 samples/s | 39.9 steps/s
[Step=20400 Epoch=194.1] | Loss=0.00315 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=13.956 | 5889.1 samples/s | 92.0 steps/s
[Step=20450 Epoch=194.5] | Loss=0.00320 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.962 | L2-Norm(final)=13.973 | 2647.2 samples/s | 41.4 steps/s
[Step=20500 Epoch=195.0] | Loss=0.00312 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=13.990 | 5463.1 samples/s | 85.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=195.0] | Loss=0.00098 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=14.155 | 5830.2 samples/s | 91.1 steps/s
[Step=20550 Epoch=195.5] | Loss=0.00135 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=14.164 | 4087.8 samples/s | 63.9 steps/s
[Step=20600 Epoch=196.0] | Loss=0.00312 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.059 | L2-Norm(final)=14.159 | 6782.0 samples/s | 106.0 steps/s
[Step=20650 Epoch=196.4] | Loss=0.00214 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.090 | L2-Norm(final)=14.155 | 2213.7 samples/s | 34.6 steps/s
[Step=20700 Epoch=196.9] | Loss=0.00181 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.104 | L2-Norm(final)=14.154 | 5956.8 samples/s | 93.1 steps/s
[Step=20750 Epoch=197.4] | Loss=0.00162 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.114 | L2-Norm(final)=14.154 | 2283.5 samples/s | 35.7 steps/s
[Step=20800 Epoch=197.9] | Loss=0.00136 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.118 | L2-Norm(final)=14.155 | 5593.3 samples/s | 87.4 steps/s
[Step=20850 Epoch=198.3] | Loss=0.00117 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.120 | L2-Norm(final)=14.155 | 2384.9 samples/s | 37.3 steps/s
[Step=20900 Epoch=198.8] | Loss=0.00102 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.119 | L2-Norm(final)=14.156 | 5082.4 samples/s | 79.4 steps/s
[Step=20950 Epoch=199.3] | Loss=0.00091 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.117 | L2-Norm(final)=14.156 | 2443.1 samples/s | 38.2 steps/s
[Step=21000 Epoch=199.8] | Loss=0.00082 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.114 | L2-Norm(final)=14.157 | 4762.0 samples/s | 74.4 steps/s
[Step=21050 Epoch=200.2] | Loss=0.00075 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.110 | L2-Norm(final)=14.157 | 2546.6 samples/s | 39.8 steps/s
[Step=21100 Epoch=200.7] | Loss=0.00069 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.106 | L2-Norm(final)=14.158 | 4543.0 samples/s | 71.0 steps/s
[Step=21150 Epoch=201.2] | Loss=0.00063 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=14.158 | 2583.3 samples/s | 40.4 steps/s
[Step=21200 Epoch=201.7] | Loss=0.00059 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.097 | L2-Norm(final)=14.159 | 4625.1 samples/s | 72.3 steps/s
[Step=21250 Epoch=202.1] | Loss=0.00055 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.092 | L2-Norm(final)=14.159 | 2567.0 samples/s | 40.1 steps/s
[Step=21300 Epoch=202.6] | Loss=0.00052 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.086 | L2-Norm(final)=14.160 | 4629.7 samples/s | 72.3 steps/s
[Step=21350 Epoch=203.1] | Loss=0.00049 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.081 | L2-Norm(final)=14.160 | 2688.0 samples/s | 42.0 steps/s
[Step=21400 Epoch=203.6] | Loss=0.00046 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.075 | L2-Norm(final)=14.160 | 4398.5 samples/s | 68.7 steps/s
[Step=21450 Epoch=204.0] | Loss=0.00044 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.069 | L2-Norm(final)=14.161 | 7013.2 samples/s | 109.6 steps/s
[Step=21500 Epoch=204.5] | Loss=0.00041 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.064 | L2-Norm(final)=14.161 | 2174.7 samples/s | 34.0 steps/s
[Step=21550 Epoch=205.0] | Loss=0.00039 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.058 | L2-Norm(final)=14.162 | 6347.2 samples/s | 99.2 steps/s
[Step=21600 Epoch=205.5] | Loss=0.00038 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.052 | L2-Norm(final)=14.162 | 2249.5 samples/s | 35.1 steps/s
[Step=21650 Epoch=205.9] | Loss=0.00036 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.046 | L2-Norm(final)=14.162 | 5703.1 samples/s | 89.1 steps/s
[Step=21700 Epoch=206.4] | Loss=0.00035 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.040 | L2-Norm(final)=14.163 | 2336.9 samples/s | 36.5 steps/s
[Step=21750 Epoch=206.9] | Loss=0.00033 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.034 | L2-Norm(final)=14.163 | 5230.2 samples/s | 81.7 steps/s
[Step=21800 Epoch=207.4] | Loss=0.00032 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.027 | L2-Norm(final)=14.164 | 2431.9 samples/s | 38.0 steps/s
[Step=21850 Epoch=207.8] | Loss=0.00031 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.021 | L2-Norm(final)=14.164 | 4878.5 samples/s | 76.2 steps/s
[Step=21900 Epoch=208.3] | Loss=0.00030 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.015 | L2-Norm(final)=14.164 | 2503.2 samples/s | 39.1 steps/s
[Step=21950 Epoch=208.8] | Loss=0.00029 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.009 | L2-Norm(final)=14.165 | 4628.9 samples/s | 72.3 steps/s
[Step=22000 Epoch=209.3] | Loss=0.00028 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.002 | L2-Norm(final)=14.165 | 2564.2 samples/s | 40.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step22000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=191.0] | Loss=0.00024 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.965 | L2-Norm(final)=15.329 | 5585.4 samples/s | 87.3 steps/s
[Step=20050 Epoch=191.5] | Loss=0.00149 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=15.327 | 4651.4 samples/s | 72.7 steps/s
[Step=20100 Epoch=191.9] | Loss=0.00167 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=15.333 | 8321.8 samples/s | 130.0 steps/s
[Step=20150 Epoch=192.4] | Loss=0.00181 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.961 | L2-Norm(final)=15.339 | 2324.7 samples/s | 36.3 steps/s
[Step=20200 Epoch=192.9] | Loss=0.00179 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.961 | L2-Norm(final)=15.346 | 7693.2 samples/s | 120.2 steps/s
[Step=20250 Epoch=193.4] | Loss=0.00181 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.961 | L2-Norm(final)=15.355 | 2436.7 samples/s | 38.1 steps/s
[Step=20300 Epoch=193.9] | Loss=0.00170 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.961 | L2-Norm(final)=15.365 | 6676.5 samples/s | 104.3 steps/s
[Step=20350 Epoch=194.3] | Loss=0.00173 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.961 | L2-Norm(final)=15.375 | 2505.9 samples/s | 39.2 steps/s
[Step=20400 Epoch=194.8] | Loss=0.00169 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.961 | L2-Norm(final)=15.384 | 6304.2 samples/s | 98.5 steps/s
[Step=20450 Epoch=195.3] | Loss=0.00168 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.961 | L2-Norm(final)=15.394 | 2574.9 samples/s | 40.2 steps/s
[Step=20500 Epoch=195.8] | Loss=0.00170 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.961 | L2-Norm(final)=15.404 | 5953.2 samples/s | 93.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=195.8] | Loss=0.00404 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.961 | L2-Norm(final)=15.511 | 5739.8 samples/s | 89.7 steps/s
[Step=20550 Epoch=196.2] | Loss=0.00111 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.003 | L2-Norm(final)=15.525 | 4129.9 samples/s | 64.5 steps/s
[Step=20600 Epoch=196.7] | Loss=0.00124 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.030 | L2-Norm(final)=15.531 | 6830.1 samples/s | 106.7 steps/s
[Step=20650 Epoch=197.2] | Loss=0.00085 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.050 | L2-Norm(final)=15.532 | 2205.1 samples/s | 34.5 steps/s
[Step=20700 Epoch=197.7] | Loss=0.00065 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.056 | L2-Norm(final)=15.534 | 6194.0 samples/s | 96.8 steps/s
[Step=20750 Epoch=198.1] | Loss=0.00052 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.055 | L2-Norm(final)=15.536 | 2259.4 samples/s | 35.3 steps/s
[Step=20800 Epoch=198.6] | Loss=0.00044 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.051 | L2-Norm(final)=15.538 | 5819.5 samples/s | 90.9 steps/s
[Step=20850 Epoch=199.1] | Loss=0.00037 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.045 | L2-Norm(final)=15.539 | 2303.8 samples/s | 36.0 steps/s
[Step=20900 Epoch=199.6] | Loss=0.00033 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.038 | L2-Norm(final)=15.539 | 5378.3 samples/s | 84.0 steps/s
[Step=20950 Epoch=200.1] | Loss=0.00029 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.031 | L2-Norm(final)=15.540 | 2353.2 samples/s | 36.8 steps/s
[Step=21000 Epoch=200.5] | Loss=0.00026 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.023 | L2-Norm(final)=15.541 | 5061.0 samples/s | 79.1 steps/s
[Step=21050 Epoch=201.0] | Loss=0.00024 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.014 | L2-Norm(final)=15.542 | 2471.1 samples/s | 38.6 steps/s
[Step=21100 Epoch=201.5] | Loss=0.00022 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.006 | L2-Norm(final)=15.542 | 4702.9 samples/s | 73.5 steps/s
[Step=21150 Epoch=202.0] | Loss=0.00020 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.997 | L2-Norm(final)=15.543 | 2514.8 samples/s | 39.3 steps/s
[Step=21200 Epoch=202.4] | Loss=0.00019 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.988 | L2-Norm(final)=15.543 | 4646.1 samples/s | 72.6 steps/s
[Step=21250 Epoch=202.9] | Loss=0.00018 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.979 | L2-Norm(final)=15.544 | 2582.3 samples/s | 40.3 steps/s
[Step=21300 Epoch=203.4] | Loss=0.00017 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.970 | L2-Norm(final)=15.545 | 4560.2 samples/s | 71.3 steps/s
[Step=21350 Epoch=203.9] | Loss=0.00016 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.961 | L2-Norm(final)=15.545 | 2585.6 samples/s | 40.4 steps/s
[Step=21400 Epoch=204.4] | Loss=0.00015 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=15.546 | 4541.0 samples/s | 71.0 steps/s
[Step=21450 Epoch=204.8] | Loss=0.00014 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.942 | L2-Norm(final)=15.546 | 2560.7 samples/s | 40.0 steps/s
[Step=21500 Epoch=205.3] | Loss=0.00013 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=15.547 | 4644.0 samples/s | 72.6 steps/s
[Step=21550 Epoch=205.8] | Loss=0.00013 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.924 | L2-Norm(final)=15.547 | 7367.5 samples/s | 115.1 steps/s
[Step=21600 Epoch=206.3] | Loss=0.00012 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.914 | L2-Norm(final)=15.548 | 2128.7 samples/s | 33.3 steps/s
[Step=21650 Epoch=206.7] | Loss=0.00012 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.905 | L2-Norm(final)=15.548 | 6737.0 samples/s | 105.3 steps/s
[Step=21700 Epoch=207.2] | Loss=0.00011 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=15.549 | 2167.5 samples/s | 33.9 steps/s
[Step=21750 Epoch=207.7] | Loss=0.00011 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.886 | L2-Norm(final)=15.550 | 6310.4 samples/s | 98.6 steps/s
[Step=21800 Epoch=208.2] | Loss=0.00010 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.876 | L2-Norm(final)=15.550 | 2253.9 samples/s | 35.2 steps/s
[Step=21850 Epoch=208.7] | Loss=0.00010 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.867 | L2-Norm(final)=15.551 | 5680.5 samples/s | 88.8 steps/s
[Step=21900 Epoch=209.1] | Loss=0.00010 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=15.551 | 2327.9 samples/s | 36.4 steps/s
[Step=21950 Epoch=209.6] | Loss=0.00009 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.848 | L2-Norm(final)=15.552 | 5357.9 samples/s | 83.7 steps/s
[Step=22000 Epoch=210.1] | Loss=0.00009 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.838 | L2-Norm(final)=15.552 | 2367.3 samples/s | 37.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step22000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=16001 Epoch=150.8] | Loss=0.00117 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.965 | L2-Norm(final)=13.335 | 5423.9 samples/s | 84.7 steps/s
[Step=16050 Epoch=151.2] | Loss=0.00157 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=13.348 | 4687.9 samples/s | 73.2 steps/s
[Step=16100 Epoch=151.7] | Loss=0.00239 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=13.368 | 8165.7 samples/s | 127.6 steps/s
[Step=16150 Epoch=152.2] | Loss=0.00215 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=13.386 | 2357.1 samples/s | 36.8 steps/s
[Step=16200 Epoch=152.7] | Loss=0.00227 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=13.404 | 7165.5 samples/s | 112.0 steps/s
[Step=16250 Epoch=153.1] | Loss=0.00214 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=13.421 | 2480.3 samples/s | 38.8 steps/s
[Step=16300 Epoch=153.6] | Loss=0.00212 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=13.438 | 6181.0 samples/s | 96.6 steps/s
[Step=16350 Epoch=154.1] | Loss=0.00219 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=13.454 | 2585.7 samples/s | 40.4 steps/s
[Step=16400 Epoch=154.5] | Loss=0.00218 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=13.469 | 5646.4 samples/s | 88.2 steps/s
[Step=16450 Epoch=155.0] | Loss=0.00220 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=13.484 | 2769.0 samples/s | 43.3 steps/s
[Step=16500 Epoch=155.5] | Loss=0.00227 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=13.499 | 5106.1 samples/s | 79.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=16501 Epoch=155.5] | Loss=0.00157 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=13.643 | 5941.1 samples/s | 92.8 steps/s
[Step=16550 Epoch=155.9] | Loss=0.00391 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.001 | L2-Norm(final)=13.651 | 3984.2 samples/s | 62.3 steps/s
[Step=16600 Epoch=156.4] | Loss=0.00212 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.037 | L2-Norm(final)=13.653 | 6572.6 samples/s | 102.7 steps/s
[Step=16650 Epoch=156.9] | Loss=0.00145 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.047 | L2-Norm(final)=13.655 | 2160.1 samples/s | 33.8 steps/s
[Step=16700 Epoch=157.4] | Loss=0.00109 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.049 | L2-Norm(final)=13.658 | 5867.7 samples/s | 91.7 steps/s
[Step=16750 Epoch=157.8] | Loss=0.00088 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.047 | L2-Norm(final)=13.659 | 2303.4 samples/s | 36.0 steps/s
[Step=16800 Epoch=158.3] | Loss=0.00073 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.044 | L2-Norm(final)=13.661 | 5366.1 samples/s | 83.8 steps/s
[Step=16850 Epoch=158.8] | Loss=0.00063 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.039 | L2-Norm(final)=13.662 | 2432.3 samples/s | 38.0 steps/s
[Step=16900 Epoch=159.2] | Loss=0.00055 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.033 | L2-Norm(final)=13.663 | 4823.0 samples/s | 75.4 steps/s
[Step=16950 Epoch=159.7] | Loss=0.00049 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.027 | L2-Norm(final)=13.664 | 2521.1 samples/s | 39.4 steps/s
[Step=17000 Epoch=160.2] | Loss=0.00044 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.021 | L2-Norm(final)=13.665 | 4710.8 samples/s | 73.6 steps/s
[Step=17050 Epoch=160.7] | Loss=0.00040 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.015 | L2-Norm(final)=13.666 | 2552.4 samples/s | 39.9 steps/s
[Step=17100 Epoch=161.1] | Loss=0.00037 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.008 | L2-Norm(final)=13.667 | 4564.1 samples/s | 71.3 steps/s
[Step=17150 Epoch=161.6] | Loss=0.00034 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.001 | L2-Norm(final)=13.668 | 2587.2 samples/s | 40.4 steps/s
[Step=17200 Epoch=162.1] | Loss=0.00032 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.994 | L2-Norm(final)=13.668 | 4641.7 samples/s | 72.5 steps/s
[Step=17250 Epoch=162.5] | Loss=0.00030 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.988 | L2-Norm(final)=13.669 | 2831.7 samples/s | 44.2 steps/s
[Step=17300 Epoch=163.0] | Loss=0.00028 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.981 | L2-Norm(final)=13.670 | 3935.0 samples/s | 61.5 steps/s
[Step=17350 Epoch=163.5] | Loss=0.00026 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.974 | L2-Norm(final)=13.671 | 6729.8 samples/s | 105.2 steps/s
[Step=17400 Epoch=164.0] | Loss=0.00025 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.966 | L2-Norm(final)=13.671 | 2191.9 samples/s | 34.2 steps/s
[Step=17450 Epoch=164.4] | Loss=0.00024 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.959 | L2-Norm(final)=13.672 | 6026.0 samples/s | 94.2 steps/s
[Step=17500 Epoch=164.9] | Loss=0.00023 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=13.673 | 2280.2 samples/s | 35.6 steps/s
[Step=17550 Epoch=165.4] | Loss=0.00021 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=13.673 | 5485.5 samples/s | 85.7 steps/s
[Step=17600 Epoch=165.8] | Loss=0.00021 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.938 | L2-Norm(final)=13.674 | 2377.1 samples/s | 37.1 steps/s
[Step=17650 Epoch=166.3] | Loss=0.00020 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.930 | L2-Norm(final)=13.674 | 4970.9 samples/s | 77.7 steps/s
[Step=17700 Epoch=166.8] | Loss=0.00019 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=13.675 | 2508.1 samples/s | 39.2 steps/s
[Step=17750 Epoch=167.3] | Loss=0.00018 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.916 | L2-Norm(final)=13.676 | 4646.8 samples/s | 72.6 steps/s
[Step=17800 Epoch=167.7] | Loss=0.00017 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.908 | L2-Norm(final)=13.676 | 2569.5 samples/s | 40.1 steps/s
[Step=17850 Epoch=168.2] | Loss=0.00017 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.901 | L2-Norm(final)=13.677 | 4635.9 samples/s | 72.4 steps/s
[Step=17900 Epoch=168.7] | Loss=0.00016 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=13.677 | 2560.9 samples/s | 40.0 steps/s
[Step=17950 Epoch=169.1] | Loss=0.00016 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.886 | L2-Norm(final)=13.678 | 4591.7 samples/s | 71.7 steps/s
[Step=18000 Epoch=169.6] | Loss=0.00015 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.878 | L2-Norm(final)=13.679 | 2606.0 samples/s | 40.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step18000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11061 | acc=0.9563 | tpr=0.9744 | fpr=0.0833 | 5749.4 samples/s | 22.5 steps/s
Avg test loss: 0.11709, Avg test acc: 0.95376, Avg tpr: 0.97266, Avg fpr: 0.08781, total FA: 685

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09877 | acc=0.9609 | tpr=0.9716 | fpr=0.0622 | 5661.2 samples/s | 22.1 steps/s
Avg test loss: 0.10283, Avg test acc: 0.96001, Avg tpr: 0.97068, Avg fpr: 0.06345, total FA: 495

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.10693 | acc=0.9596 | tpr=0.9748 | fpr=0.0733 | 5631.4 samples/s | 22.0 steps/s
Avg test loss: 0.11021, Avg test acc: 0.95797, Avg tpr: 0.97237, Avg fpr: 0.07371, total FA: 575

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09586 | acc=0.9626 | tpr=0.9796 | fpr=0.0743 | 5724.1 samples/s | 22.4 steps/s
Avg test loss: 0.10484, Avg test acc: 0.96117, Avg tpr: 0.97861, Avg fpr: 0.07717, total FA: 602

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09164 | acc=0.9594 | tpr=0.9704 | fpr=0.0647 | 5662.9 samples/s | 22.1 steps/s
Avg test loss: 0.09950, Avg test acc: 0.95857, Avg tpr: 0.96858, Avg fpr: 0.06345, total FA: 495

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.87447 | acc=0.2647 | tpr=0.0095 | fpr=0.1811 | 5627.0 samples/s | 22.0 steps/s
Avg test loss: 4.88080, Avg test acc: 0.26368, Avg tpr: 0.00973, Avg fpr: 0.17780, total FA: 1387

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.34510 | acc=0.3023 | tpr=0.0144 | fpr=0.0723 | 5745.8 samples/s | 22.4 steps/s
Avg test loss: 4.36088, Avg test acc: 0.29990, Avg tpr: 0.01317, Avg fpr: 0.06948, total FA: 542

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.14172 | acc=0.2616 | tpr=0.0201 | fpr=0.2141 | 5710.8 samples/s | 22.3 steps/s
Avg test loss: 5.15043, Avg test acc: 0.26236, Avg tpr: 0.02197, Avg fpr: 0.20895, total FA: 1630

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.10133 | acc=0.2562 | tpr=0.0081 | fpr=0.2049 | 5416.8 samples/s | 21.2 steps/s
Avg test loss: 5.10693, Avg test acc: 0.25487, Avg tpr: 0.00816, Avg fpr: 0.20254, total FA: 1580

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.94260 | acc=0.3017 | tpr=0.0114 | fpr=0.0679 | 5697.1 samples/s | 22.3 steps/s
Avg test loss: 4.95377, Avg test acc: 0.29902, Avg tpr: 0.01142, Avg fpr: 0.06845, total FA: 534

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.14756 | acc=0.1296 | tpr=0.3628 | fpr=0.8746 | 5850.9 samples/s | 22.9 steps/s
[Step= 100] | Loss=6.10270 | acc=0.1296 | tpr=0.3241 | fpr=0.8740 | 7596.5 samples/s | 29.7 steps/s
[Step= 150] | Loss=6.11391 | acc=0.1289 | tpr=0.3228 | fpr=0.8746 | 8103.9 samples/s | 31.7 steps/s
[Step= 200] | Loss=6.10875 | acc=0.1290 | tpr=0.3191 | fpr=0.8744 | 7320.4 samples/s | 28.6 steps/s
[Step= 250] | Loss=6.11095 | acc=0.1292 | tpr=0.3301 | fpr=0.8745 | 8409.6 samples/s | 32.9 steps/s
[Step= 300] | Loss=6.10822 | acc=0.1286 | tpr=0.3258 | fpr=0.8750 | 8018.7 samples/s | 31.3 steps/s
[Step= 350] | Loss=6.10818 | acc=0.1281 | tpr=0.3131 | fpr=0.8753 | 8339.0 samples/s | 32.6 steps/s
[Step= 400] | Loss=6.10527 | acc=0.1285 | tpr=0.3129 | fpr=0.8748 | 8339.0 samples/s | 32.6 steps/s
[Step= 450] | Loss=6.10610 | acc=0.1288 | tpr=0.3165 | fpr=0.8746 | 8298.4 samples/s | 32.4 steps/s
[Step= 500] | Loss=6.10876 | acc=0.1291 | tpr=0.3154 | fpr=0.8743 | 7834.6 samples/s | 30.6 steps/s
[Step= 550] | Loss=6.10600 | acc=0.1289 | tpr=0.3084 | fpr=0.8744 | 10420.7 samples/s | 40.7 steps/s
Avg test loss: 6.10619, Avg test acc: 0.12877, Avg tpr: 0.30824, Avg fpr: 0.87449, total FA: 121421

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.06318 | acc=0.1423 | tpr=0.2389 | fpr=0.8595 | 5784.5 samples/s | 22.6 steps/s
[Step= 100] | Loss=5.01972 | acc=0.1464 | tpr=0.2068 | fpr=0.8547 | 7917.9 samples/s | 30.9 steps/s
[Step= 150] | Loss=5.02786 | acc=0.1443 | tpr=0.1988 | fpr=0.8567 | 7993.5 samples/s | 31.2 steps/s
[Step= 200] | Loss=5.02360 | acc=0.1440 | tpr=0.1956 | fpr=0.8570 | 7515.0 samples/s | 29.4 steps/s
[Step= 250] | Loss=5.02726 | acc=0.1442 | tpr=0.1921 | fpr=0.8567 | 8139.0 samples/s | 31.8 steps/s
[Step= 300] | Loss=5.03157 | acc=0.1434 | tpr=0.1920 | fpr=0.8575 | 7781.3 samples/s | 30.4 steps/s
[Step= 350] | Loss=5.03307 | acc=0.1429 | tpr=0.1816 | fpr=0.8578 | 7912.3 samples/s | 30.9 steps/s
[Step= 400] | Loss=5.03057 | acc=0.1436 | tpr=0.1844 | fpr=0.8572 | 8416.3 samples/s | 32.9 steps/s
[Step= 450] | Loss=5.03181 | acc=0.1437 | tpr=0.1821 | fpr=0.8570 | 8193.4 samples/s | 32.0 steps/s
[Step= 500] | Loss=5.03268 | acc=0.1435 | tpr=0.1833 | fpr=0.8572 | 8135.5 samples/s | 31.8 steps/s
[Step= 550] | Loss=5.03104 | acc=0.1436 | tpr=0.1819 | fpr=0.8571 | 10796.0 samples/s | 42.2 steps/s
Avg test loss: 5.03127, Avg test acc: 0.14344, Avg tpr: 0.18185, Avg fpr: 0.85726, total FA: 119029

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.23136 | acc=0.1223 | tpr=0.1637 | fpr=0.8785 | 5727.9 samples/s | 22.4 steps/s
[Step= 100] | Loss=6.17671 | acc=0.1232 | tpr=0.1429 | fpr=0.8772 | 8373.1 samples/s | 32.7 steps/s
[Step= 150] | Loss=6.18268 | acc=0.1235 | tpr=0.1383 | fpr=0.8768 | 8122.9 samples/s | 31.7 steps/s
[Step= 200] | Loss=6.17227 | acc=0.1238 | tpr=0.1344 | fpr=0.8764 | 7734.2 samples/s | 30.2 steps/s
[Step= 250] | Loss=6.16943 | acc=0.1243 | tpr=0.1336 | fpr=0.8758 | 8078.1 samples/s | 31.6 steps/s
[Step= 300] | Loss=6.17488 | acc=0.1240 | tpr=0.1338 | fpr=0.8761 | 8330.4 samples/s | 32.5 steps/s
[Step= 350] | Loss=6.17837 | acc=0.1233 | tpr=0.1315 | fpr=0.8769 | 8390.9 samples/s | 32.8 steps/s
[Step= 400] | Loss=6.17556 | acc=0.1237 | tpr=0.1379 | fpr=0.8766 | 7256.5 samples/s | 28.3 steps/s
[Step= 450] | Loss=6.17517 | acc=0.1237 | tpr=0.1358 | fpr=0.8765 | 8242.7 samples/s | 32.2 steps/s
[Step= 500] | Loss=6.17676 | acc=0.1236 | tpr=0.1344 | fpr=0.8766 | 8334.5 samples/s | 32.6 steps/s
[Step= 550] | Loss=6.17371 | acc=0.1235 | tpr=0.1337 | fpr=0.8767 | 10321.7 samples/s | 40.3 steps/s
Avg test loss: 6.17369, Avg test acc: 0.12339, Avg tpr: 0.13391, Avg fpr: 0.87680, total FA: 121742

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.20997 | acc=0.1298 | tpr=0.2743 | fpr=0.8728 | 5803.3 samples/s | 22.7 steps/s
[Step= 100] | Loss=6.16229 | acc=0.1289 | tpr=0.2324 | fpr=0.8730 | 7446.8 samples/s | 29.1 steps/s
[Step= 150] | Loss=6.16948 | acc=0.1277 | tpr=0.2147 | fpr=0.8739 | 8725.3 samples/s | 34.1 steps/s
[Step= 200] | Loss=6.16077 | acc=0.1279 | tpr=0.2164 | fpr=0.8737 | 7810.9 samples/s | 30.5 steps/s
[Step= 250] | Loss=6.16637 | acc=0.1283 | tpr=0.2166 | fpr=0.8733 | 7785.6 samples/s | 30.4 steps/s
[Step= 300] | Loss=6.17117 | acc=0.1276 | tpr=0.2175 | fpr=0.8741 | 7810.0 samples/s | 30.5 steps/s
[Step= 350] | Loss=6.16981 | acc=0.1269 | tpr=0.2060 | fpr=0.8746 | 8517.7 samples/s | 33.3 steps/s
[Step= 400] | Loss=6.16704 | acc=0.1270 | tpr=0.2101 | fpr=0.8745 | 8422.6 samples/s | 32.9 steps/s
[Step= 450] | Loss=6.16718 | acc=0.1274 | tpr=0.2089 | fpr=0.8741 | 8515.2 samples/s | 33.3 steps/s
[Step= 500] | Loss=6.17066 | acc=0.1273 | tpr=0.2093 | fpr=0.8742 | 7883.2 samples/s | 30.8 steps/s
[Step= 550] | Loss=6.16918 | acc=0.1273 | tpr=0.2085 | fpr=0.8741 | 9981.8 samples/s | 39.0 steps/s
Avg test loss: 6.16869, Avg test acc: 0.12727, Avg tpr: 0.20840, Avg fpr: 0.87420, total FA: 121381

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.83147 | acc=0.1291 | tpr=0.1726 | fpr=0.8717 | 5776.5 samples/s | 22.6 steps/s
[Step= 100] | Loss=6.76763 | acc=0.1297 | tpr=0.1599 | fpr=0.8708 | 7314.7 samples/s | 28.6 steps/s
[Step= 150] | Loss=6.78677 | acc=0.1290 | tpr=0.1470 | fpr=0.8714 | 7848.2 samples/s | 30.7 steps/s
[Step= 200] | Loss=6.78123 | acc=0.1290 | tpr=0.1421 | fpr=0.8712 | 8139.6 samples/s | 31.8 steps/s
[Step= 250] | Loss=6.78896 | acc=0.1289 | tpr=0.1397 | fpr=0.8713 | 8405.7 samples/s | 32.8 steps/s
[Step= 300] | Loss=6.79505 | acc=0.1283 | tpr=0.1389 | fpr=0.8719 | 7911.5 samples/s | 30.9 steps/s
[Step= 350] | Loss=6.80061 | acc=0.1277 | tpr=0.1340 | fpr=0.8724 | 8119.8 samples/s | 31.7 steps/s
[Step= 400] | Loss=6.79786 | acc=0.1281 | tpr=0.1379 | fpr=0.8721 | 7960.8 samples/s | 31.1 steps/s
[Step= 450] | Loss=6.79735 | acc=0.1283 | tpr=0.1373 | fpr=0.8719 | 8023.6 samples/s | 31.3 steps/s
[Step= 500] | Loss=6.80058 | acc=0.1281 | tpr=0.1405 | fpr=0.8721 | 7748.1 samples/s | 30.3 steps/s
[Step= 550] | Loss=6.79885 | acc=0.1279 | tpr=0.1389 | fpr=0.8723 | 11642.1 samples/s | 45.5 steps/s
Avg test loss: 6.79872, Avg test acc: 0.12776, Avg tpr: 0.13906, Avg fpr: 0.87245, total FA: 121138

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10215 | acc=0.9824 | tpr=0.9071 | fpr=0.0162 | 5921.1 samples/s | 23.1 steps/s
[Step= 100] | Loss=0.10469 | acc=0.9822 | tpr=0.9190 | fpr=0.0166 | 7854.8 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.10862 | acc=0.9817 | tpr=0.9222 | fpr=0.0172 | 7409.0 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.11055 | acc=0.9818 | tpr=0.9322 | fpr=0.0173 | 7888.0 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.11088 | acc=0.9818 | tpr=0.9284 | fpr=0.0173 | 8159.6 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.11238 | acc=0.9817 | tpr=0.9273 | fpr=0.0173 | 7769.9 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.11273 | acc=0.9816 | tpr=0.9292 | fpr=0.0174 | 8226.7 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.11351 | acc=0.9815 | tpr=0.9261 | fpr=0.0175 | 8192.6 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.11593 | acc=0.9811 | tpr=0.9250 | fpr=0.0179 | 7780.6 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.11502 | acc=0.9813 | tpr=0.9278 | fpr=0.0177 | 8378.8 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.11435 | acc=0.9813 | tpr=0.9280 | fpr=0.0177 | 11106.2 samples/s | 43.4 steps/s
Avg test loss: 0.11414, Avg test acc: 0.98131, Avg tpr: 0.92750, Avg fpr: 0.01771, total FA: 2459

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09134 | acc=0.9827 | tpr=0.8982 | fpr=0.0157 | 5545.5 samples/s | 21.7 steps/s
[Step= 100] | Loss=0.09366 | acc=0.9821 | tpr=0.9083 | fpr=0.0165 | 7912.5 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.09655 | acc=0.9816 | tpr=0.9193 | fpr=0.0173 | 8069.4 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.09795 | acc=0.9817 | tpr=0.9213 | fpr=0.0172 | 7971.9 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.09798 | acc=0.9818 | tpr=0.9214 | fpr=0.0171 | 7870.3 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.09966 | acc=0.9816 | tpr=0.9207 | fpr=0.0173 | 8164.3 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.10043 | acc=0.9814 | tpr=0.9230 | fpr=0.0175 | 7856.9 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.10140 | acc=0.9813 | tpr=0.9196 | fpr=0.0176 | 8454.1 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.10340 | acc=0.9809 | tpr=0.9158 | fpr=0.0179 | 8158.9 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.10318 | acc=0.9809 | tpr=0.9176 | fpr=0.0179 | 7986.1 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.10259 | acc=0.9810 | tpr=0.9168 | fpr=0.0178 | 11759.1 samples/s | 45.9 steps/s
Avg test loss: 0.10242, Avg test acc: 0.98101, Avg tpr: 0.91640, Avg fpr: 0.01782, total FA: 2474

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.13373 | acc=0.9725 | tpr=0.9292 | fpr=0.0267 | 5692.7 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.13616 | acc=0.9734 | tpr=0.9467 | fpr=0.0261 | 8163.3 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.14299 | acc=0.9720 | tpr=0.9524 | fpr=0.0277 | 7999.8 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.14530 | acc=0.9719 | tpr=0.9508 | fpr=0.0278 | 7884.0 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.14714 | acc=0.9715 | tpr=0.9493 | fpr=0.0281 | 8177.5 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.14882 | acc=0.9713 | tpr=0.9433 | fpr=0.0282 | 7446.7 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.14872 | acc=0.9714 | tpr=0.9455 | fpr=0.0282 | 8057.2 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.15036 | acc=0.9711 | tpr=0.9409 | fpr=0.0284 | 8447.8 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.15279 | acc=0.9704 | tpr=0.9387 | fpr=0.0290 | 8114.5 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.15150 | acc=0.9704 | tpr=0.9410 | fpr=0.0290 | 8247.7 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.15035 | acc=0.9707 | tpr=0.9411 | fpr=0.0288 | 9977.9 samples/s | 39.0 steps/s
Avg test loss: 0.15005, Avg test acc: 0.97067, Avg tpr: 0.94097, Avg fpr: 0.02879, total FA: 3997

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10284 | acc=0.9811 | tpr=0.9248 | fpr=0.0179 | 5721.7 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.10562 | acc=0.9805 | tpr=0.9254 | fpr=0.0184 | 7444.7 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.10967 | acc=0.9804 | tpr=0.9308 | fpr=0.0186 | 8224.0 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.11144 | acc=0.9804 | tpr=0.9311 | fpr=0.0187 | 8881.8 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.11127 | acc=0.9804 | tpr=0.9258 | fpr=0.0186 | 7738.3 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.11288 | acc=0.9802 | tpr=0.9215 | fpr=0.0187 | 8520.2 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.11267 | acc=0.9802 | tpr=0.9236 | fpr=0.0187 | 8248.7 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.11345 | acc=0.9802 | tpr=0.9207 | fpr=0.0187 | 8199.5 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.11556 | acc=0.9799 | tpr=0.9187 | fpr=0.0190 | 7437.2 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.11487 | acc=0.9800 | tpr=0.9211 | fpr=0.0189 | 8420.6 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.11427 | acc=0.9801 | tpr=0.9212 | fpr=0.0189 | 9641.2 samples/s | 37.7 steps/s
Avg test loss: 0.11403, Avg test acc: 0.98009, Avg tpr: 0.92116, Avg fpr: 0.01884, total FA: 2616

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10876 | acc=0.9798 | tpr=0.9071 | fpr=0.0188 | 5697.3 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.11432 | acc=0.9800 | tpr=0.9232 | fpr=0.0189 | 7726.5 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.12040 | acc=0.9790 | tpr=0.9222 | fpr=0.0199 | 7993.8 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.12166 | acc=0.9790 | tpr=0.9191 | fpr=0.0199 | 8376.4 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.12115 | acc=0.9793 | tpr=0.9179 | fpr=0.0196 | 8287.3 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.12340 | acc=0.9793 | tpr=0.9171 | fpr=0.0196 | 7807.1 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.12385 | acc=0.9791 | tpr=0.9161 | fpr=0.0197 | 7789.6 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.12444 | acc=0.9791 | tpr=0.9152 | fpr=0.0197 | 7874.2 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.12662 | acc=0.9788 | tpr=0.9133 | fpr=0.0200 | 8932.7 samples/s | 34.9 steps/s
[Step= 500] | Loss=0.12603 | acc=0.9790 | tpr=0.9141 | fpr=0.0199 | 8333.2 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.12536 | acc=0.9790 | tpr=0.9156 | fpr=0.0198 | 8999.4 samples/s | 35.2 steps/s
Avg test loss: 0.12523, Avg test acc: 0.97902, Avg tpr: 0.91482, Avg fpr: 0.01981, total FA: 2751

server round 22/50

clients selected: [1 2 4 5 6]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=34001 Epoch=165.9] | Loss=0.02999 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.936 | L2-Norm(final)=15.211 | 6290.5 samples/s | 98.3 steps/s
[Step=34050 Epoch=166.1] | Loss=0.03242 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.935 | L2-Norm(final)=15.205 | 4707.6 samples/s | 73.6 steps/s
[Step=34100 Epoch=166.4] | Loss=0.03113 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.935 | L2-Norm(final)=15.206 | 5743.1 samples/s | 89.7 steps/s
[Step=34150 Epoch=166.6] | Loss=0.02998 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.935 | L2-Norm(final)=15.207 | 5487.8 samples/s | 85.7 steps/s
[Step=34200 Epoch=166.9] | Loss=0.03011 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.935 | L2-Norm(final)=15.211 | 8885.6 samples/s | 138.8 steps/s
[Step=34250 Epoch=167.1] | Loss=0.03108 | Reg=0.00120 | acc=0.9375 | L2-Norm=10.935 | L2-Norm(final)=15.214 | 2409.3 samples/s | 37.6 steps/s
[Step=34300 Epoch=167.4] | Loss=0.03059 | Reg=0.00120 | acc=0.9375 | L2-Norm=10.935 | L2-Norm(final)=15.216 | 5791.6 samples/s | 90.5 steps/s
[Step=34350 Epoch=167.6] | Loss=0.03012 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.935 | L2-Norm(final)=15.217 | 5582.2 samples/s | 87.2 steps/s
[Step=34400 Epoch=167.9] | Loss=0.03006 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.935 | L2-Norm(final)=15.220 | 7824.1 samples/s | 122.3 steps/s
[Step=34450 Epoch=168.1] | Loss=0.03082 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.935 | L2-Norm(final)=15.221 | 2519.1 samples/s | 39.4 steps/s
[Step=34500 Epoch=168.3] | Loss=0.03053 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.935 | L2-Norm(final)=15.222 | 5562.6 samples/s | 86.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=34501 Epoch=168.3] | Loss=0.06304 | Reg=0.00120 | acc=0.9531 | L2-Norm=10.935 | L2-Norm(final)=15.232 | 5890.2 samples/s | 92.0 steps/s
[Step=34550 Epoch=168.6] | Loss=0.03010 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.977 | L2-Norm(final)=15.231 | 4384.4 samples/s | 68.5 steps/s
[Step=34600 Epoch=168.8] | Loss=0.03262 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.016 | L2-Norm(final)=15.222 | 4829.1 samples/s | 75.5 steps/s
[Step=34650 Epoch=169.1] | Loss=0.03213 | Reg=0.00122 | acc=0.9531 | L2-Norm=11.045 | L2-Norm(final)=15.216 | 4803.1 samples/s | 75.0 steps/s
[Step=34700 Epoch=169.3] | Loss=0.02927 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.068 | L2-Norm(final)=15.214 | 7025.5 samples/s | 109.8 steps/s
[Step=34750 Epoch=169.6] | Loss=0.02533 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=15.214 | 2248.7 samples/s | 35.1 steps/s
[Step=34800 Epoch=169.8] | Loss=0.02235 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.104 | L2-Norm(final)=15.216 | 4830.7 samples/s | 75.5 steps/s
[Step=34850 Epoch=170.1] | Loss=0.02034 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.117 | L2-Norm(final)=15.219 | 4897.9 samples/s | 76.5 steps/s
[Step=34900 Epoch=170.3] | Loss=0.01862 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.128 | L2-Norm(final)=15.221 | 6447.6 samples/s | 100.7 steps/s
[Step=34950 Epoch=170.5] | Loss=0.01726 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.138 | L2-Norm(final)=15.224 | 2315.3 samples/s | 36.2 steps/s
[Step=35000 Epoch=170.8] | Loss=0.01597 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.145 | L2-Norm(final)=15.226 | 4905.4 samples/s | 76.6 steps/s
[Step=35050 Epoch=171.0] | Loss=0.01506 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.152 | L2-Norm(final)=15.229 | 4804.6 samples/s | 75.1 steps/s
[Step=35100 Epoch=171.3] | Loss=0.01425 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.158 | L2-Norm(final)=15.231 | 6002.1 samples/s | 93.8 steps/s
[Step=35150 Epoch=171.5] | Loss=0.01355 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.164 | L2-Norm(final)=15.234 | 2376.6 samples/s | 37.1 steps/s
[Step=35200 Epoch=171.8] | Loss=0.01292 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.169 | L2-Norm(final)=15.236 | 4826.1 samples/s | 75.4 steps/s
[Step=35250 Epoch=172.0] | Loss=0.01234 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=15.238 | 4954.4 samples/s | 77.4 steps/s
[Step=35300 Epoch=172.2] | Loss=0.01173 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.178 | L2-Norm(final)=15.241 | 5519.9 samples/s | 86.2 steps/s
[Step=35350 Epoch=172.5] | Loss=0.01132 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=15.243 | 2475.9 samples/s | 38.7 steps/s
[Step=35400 Epoch=172.7] | Loss=0.01093 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.185 | L2-Norm(final)=15.245 | 4853.1 samples/s | 75.8 steps/s
[Step=35450 Epoch=173.0] | Loss=0.01051 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.189 | L2-Norm(final)=15.247 | 4878.0 samples/s | 76.2 steps/s
[Step=35500 Epoch=173.2] | Loss=0.01018 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.192 | L2-Norm(final)=15.249 | 5287.7 samples/s | 82.6 steps/s
[Step=35550 Epoch=173.5] | Loss=0.00986 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.195 | L2-Norm(final)=15.251 | 2520.2 samples/s | 39.4 steps/s
[Step=35600 Epoch=173.7] | Loss=0.00957 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.197 | L2-Norm(final)=15.253 | 4850.8 samples/s | 75.8 steps/s
[Step=35650 Epoch=174.0] | Loss=0.00929 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.200 | L2-Norm(final)=15.255 | 4852.9 samples/s | 75.8 steps/s
[Step=35700 Epoch=174.2] | Loss=0.00902 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.202 | L2-Norm(final)=15.257 | 4968.2 samples/s | 77.6 steps/s
[Step=35750 Epoch=174.4] | Loss=0.00878 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.205 | L2-Norm(final)=15.259 | 2580.6 samples/s | 40.3 steps/s
[Step=35800 Epoch=174.7] | Loss=0.00857 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.207 | L2-Norm(final)=15.261 | 4860.7 samples/s | 75.9 steps/s
[Step=35850 Epoch=174.9] | Loss=0.00841 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.209 | L2-Norm(final)=15.263 | 4846.1 samples/s | 75.7 steps/s
[Step=35900 Epoch=175.2] | Loss=0.00819 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.211 | L2-Norm(final)=15.265 | 4903.7 samples/s | 76.6 steps/s
[Step=35950 Epoch=175.4] | Loss=0.00797 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.213 | L2-Norm(final)=15.267 | 2610.3 samples/s | 40.8 steps/s
[Step=36000 Epoch=175.7] | Loss=0.00778 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.214 | L2-Norm(final)=15.269 | 4814.7 samples/s | 75.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step36000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=107.2] | Loss=0.02802 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.936 | L2-Norm(final)=13.622 | 5868.2 samples/s | 91.7 steps/s
[Step=22050 Epoch=107.4] | Loss=0.02384 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.937 | L2-Norm(final)=13.628 | 4927.7 samples/s | 77.0 steps/s
[Step=22100 Epoch=107.7] | Loss=0.02514 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.937 | L2-Norm(final)=13.630 | 5426.9 samples/s | 84.8 steps/s
[Step=22150 Epoch=107.9] | Loss=0.02737 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.937 | L2-Norm(final)=13.634 | 5660.0 samples/s | 88.4 steps/s
[Step=22200 Epoch=108.2] | Loss=0.02842 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.937 | L2-Norm(final)=13.634 | 8622.1 samples/s | 134.7 steps/s
[Step=22250 Epoch=108.4] | Loss=0.02869 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.937 | L2-Norm(final)=13.635 | 2453.4 samples/s | 38.3 steps/s
[Step=22300 Epoch=108.7] | Loss=0.02922 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.937 | L2-Norm(final)=13.635 | 5585.7 samples/s | 87.3 steps/s
[Step=22350 Epoch=108.9] | Loss=0.02887 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.937 | L2-Norm(final)=13.636 | 5537.1 samples/s | 86.5 steps/s
[Step=22400 Epoch=109.1] | Loss=0.02821 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.937 | L2-Norm(final)=13.637 | 7773.2 samples/s | 121.5 steps/s
[Step=22450 Epoch=109.4] | Loss=0.02848 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.937 | L2-Norm(final)=13.639 | 2564.2 samples/s | 40.1 steps/s
[Step=22500 Epoch=109.6] | Loss=0.02851 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.937 | L2-Norm(final)=13.640 | 5426.0 samples/s | 84.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=109.6] | Loss=0.06406 | Reg=0.00120 | acc=0.9531 | L2-Norm=10.937 | L2-Norm(final)=13.653 | 6316.4 samples/s | 98.7 steps/s
[Step=22550 Epoch=109.9] | Loss=0.03067 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.984 | L2-Norm(final)=13.652 | 4382.7 samples/s | 68.5 steps/s
[Step=22600 Epoch=110.1] | Loss=0.02997 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.028 | L2-Norm(final)=13.646 | 4838.5 samples/s | 75.6 steps/s
[Step=22650 Epoch=110.4] | Loss=0.02767 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.056 | L2-Norm(final)=13.645 | 4916.5 samples/s | 76.8 steps/s
[Step=22700 Epoch=110.6] | Loss=0.02726 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.078 | L2-Norm(final)=13.644 | 6885.0 samples/s | 107.6 steps/s
[Step=22750 Epoch=110.8] | Loss=0.02390 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.097 | L2-Norm(final)=13.645 | 2275.9 samples/s | 35.6 steps/s
[Step=22800 Epoch=111.1] | Loss=0.02145 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.113 | L2-Norm(final)=13.648 | 4819.7 samples/s | 75.3 steps/s
[Step=22850 Epoch=111.3] | Loss=0.01959 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.126 | L2-Norm(final)=13.651 | 4891.8 samples/s | 76.4 steps/s
[Step=22900 Epoch=111.6] | Loss=0.01829 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.137 | L2-Norm(final)=13.654 | 6337.3 samples/s | 99.0 steps/s
[Step=22950 Epoch=111.8] | Loss=0.01699 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.147 | L2-Norm(final)=13.657 | 2357.7 samples/s | 36.8 steps/s
[Step=23000 Epoch=112.1] | Loss=0.01591 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=13.660 | 4899.7 samples/s | 76.6 steps/s
[Step=23050 Epoch=112.3] | Loss=0.01511 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.163 | L2-Norm(final)=13.663 | 4797.9 samples/s | 75.0 steps/s
[Step=23100 Epoch=112.6] | Loss=0.01438 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.170 | L2-Norm(final)=13.667 | 5808.5 samples/s | 90.8 steps/s
[Step=23150 Epoch=112.8] | Loss=0.01363 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.177 | L2-Norm(final)=13.669 | 2430.0 samples/s | 38.0 steps/s
[Step=23200 Epoch=113.0] | Loss=0.01303 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.183 | L2-Norm(final)=13.672 | 4885.7 samples/s | 76.3 steps/s
[Step=23250 Epoch=113.3] | Loss=0.01259 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.188 | L2-Norm(final)=13.675 | 4817.5 samples/s | 75.3 steps/s
[Step=23300 Epoch=113.5] | Loss=0.01202 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=13.677 | 5350.8 samples/s | 83.6 steps/s
[Step=23350 Epoch=113.8] | Loss=0.01155 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.198 | L2-Norm(final)=13.680 | 2514.2 samples/s | 39.3 steps/s
[Step=23400 Epoch=114.0] | Loss=0.01124 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.203 | L2-Norm(final)=13.683 | 4815.6 samples/s | 75.2 steps/s
[Step=23450 Epoch=114.3] | Loss=0.01088 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.207 | L2-Norm(final)=13.685 | 4903.1 samples/s | 76.6 steps/s
[Step=23500 Epoch=114.5] | Loss=0.01060 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.211 | L2-Norm(final)=13.688 | 4973.1 samples/s | 77.7 steps/s
[Step=23550 Epoch=114.7] | Loss=0.01030 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=13.690 | 2588.7 samples/s | 40.4 steps/s
[Step=23600 Epoch=115.0] | Loss=0.00996 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.219 | L2-Norm(final)=13.693 | 4864.8 samples/s | 76.0 steps/s
[Step=23650 Epoch=115.2] | Loss=0.00979 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.223 | L2-Norm(final)=13.695 | 4866.3 samples/s | 76.0 steps/s
[Step=23700 Epoch=115.5] | Loss=0.00952 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.226 | L2-Norm(final)=13.698 | 4909.2 samples/s | 76.7 steps/s
[Step=23750 Epoch=115.7] | Loss=0.00925 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.229 | L2-Norm(final)=13.700 | 2632.9 samples/s | 41.1 steps/s
[Step=23800 Epoch=116.0] | Loss=0.00904 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.233 | L2-Norm(final)=13.703 | 4829.3 samples/s | 75.5 steps/s
[Step=23850 Epoch=116.2] | Loss=0.00879 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.236 | L2-Norm(final)=13.705 | 4886.6 samples/s | 76.4 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00860 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.239 | L2-Norm(final)=13.707 | 4871.2 samples/s | 76.1 steps/s
[Step=23950 Epoch=116.7] | Loss=0.00847 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.242 | L2-Norm(final)=13.710 | 2631.8 samples/s | 41.1 steps/s
[Step=24000 Epoch=116.9] | Loss=0.00828 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.244 | L2-Norm(final)=13.712 | 4745.6 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step24000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=137.3] | Loss=0.04244 | Reg=0.00120 | acc=0.9531 | L2-Norm=10.936 | L2-Norm(final)=14.814 | 5040.9 samples/s | 78.8 steps/s
[Step=28050 Epoch=137.6] | Loss=0.02539 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.936 | L2-Norm(final)=14.816 | 5480.7 samples/s | 85.6 steps/s
[Step=28100 Epoch=137.8] | Loss=0.02569 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.936 | L2-Norm(final)=14.822 | 5627.8 samples/s | 87.9 steps/s
[Step=28150 Epoch=138.0] | Loss=0.02692 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.936 | L2-Norm(final)=14.827 | 5653.2 samples/s | 88.3 steps/s
[Step=28200 Epoch=138.3] | Loss=0.02785 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.936 | L2-Norm(final)=14.829 | 8951.6 samples/s | 139.9 steps/s
[Step=28250 Epoch=138.5] | Loss=0.02813 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.936 | L2-Norm(final)=14.830 | 2416.2 samples/s | 37.8 steps/s
[Step=28300 Epoch=138.8] | Loss=0.02832 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.936 | L2-Norm(final)=14.829 | 5506.1 samples/s | 86.0 steps/s
[Step=28350 Epoch=139.0] | Loss=0.02806 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.936 | L2-Norm(final)=14.830 | 5682.1 samples/s | 88.8 steps/s
[Step=28400 Epoch=139.3] | Loss=0.02790 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.936 | L2-Norm(final)=14.830 | 8270.5 samples/s | 129.2 steps/s
[Step=28450 Epoch=139.5] | Loss=0.02794 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.936 | L2-Norm(final)=14.831 | 2459.9 samples/s | 38.4 steps/s
[Step=28500 Epoch=139.8] | Loss=0.02820 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.936 | L2-Norm(final)=14.832 | 5617.0 samples/s | 87.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=139.8] | Loss=0.01135 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.936 | L2-Norm(final)=14.836 | 6046.1 samples/s | 94.5 steps/s
[Step=28550 Epoch=140.0] | Loss=0.02935 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.971 | L2-Norm(final)=14.833 | 4307.7 samples/s | 67.3 steps/s
[Step=28600 Epoch=140.2] | Loss=0.02873 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.005 | L2-Norm(final)=14.826 | 4776.3 samples/s | 74.6 steps/s
[Step=28650 Epoch=140.5] | Loss=0.02685 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.032 | L2-Norm(final)=14.823 | 4858.3 samples/s | 75.9 steps/s
[Step=28700 Epoch=140.7] | Loss=0.02508 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.054 | L2-Norm(final)=14.822 | 7131.9 samples/s | 111.4 steps/s
[Step=28750 Epoch=141.0] | Loss=0.02224 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.073 | L2-Norm(final)=14.823 | 2233.9 samples/s | 34.9 steps/s
[Step=28800 Epoch=141.2] | Loss=0.02005 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=14.825 | 4876.5 samples/s | 76.2 steps/s
[Step=28850 Epoch=141.5] | Loss=0.01817 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.101 | L2-Norm(final)=14.828 | 4840.5 samples/s | 75.6 steps/s
[Step=28900 Epoch=141.7] | Loss=0.01669 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.111 | L2-Norm(final)=14.830 | 6697.9 samples/s | 104.7 steps/s
[Step=28950 Epoch=142.0] | Loss=0.01538 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.121 | L2-Norm(final)=14.833 | 2303.0 samples/s | 36.0 steps/s
[Step=29000 Epoch=142.2] | Loss=0.01442 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.129 | L2-Norm(final)=14.836 | 4797.5 samples/s | 75.0 steps/s
[Step=29050 Epoch=142.5] | Loss=0.01351 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.137 | L2-Norm(final)=14.839 | 4892.7 samples/s | 76.4 steps/s
[Step=29100 Epoch=142.7] | Loss=0.01287 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.144 | L2-Norm(final)=14.842 | 6218.2 samples/s | 97.2 steps/s
[Step=29150 Epoch=142.9] | Loss=0.01218 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.150 | L2-Norm(final)=14.845 | 2342.4 samples/s | 36.6 steps/s
[Step=29200 Epoch=143.2] | Loss=0.01157 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.156 | L2-Norm(final)=14.847 | 4846.0 samples/s | 75.7 steps/s
[Step=29250 Epoch=143.4] | Loss=0.01111 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.161 | L2-Norm(final)=14.850 | 4867.5 samples/s | 76.1 steps/s
[Step=29300 Epoch=143.7] | Loss=0.01083 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.166 | L2-Norm(final)=14.852 | 5923.5 samples/s | 92.6 steps/s
[Step=29350 Epoch=143.9] | Loss=0.01047 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.170 | L2-Norm(final)=14.855 | 2398.4 samples/s | 37.5 steps/s
[Step=29400 Epoch=144.2] | Loss=0.01001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=14.857 | 4851.0 samples/s | 75.8 steps/s
[Step=29450 Epoch=144.4] | Loss=0.00976 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=14.859 | 4838.3 samples/s | 75.6 steps/s
[Step=29500 Epoch=144.7] | Loss=0.00950 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.182 | L2-Norm(final)=14.861 | 5612.1 samples/s | 87.7 steps/s
[Step=29550 Epoch=144.9] | Loss=0.00929 | Reg=0.00125 | acc=0.9688 | L2-Norm=11.186 | L2-Norm(final)=14.863 | 2456.9 samples/s | 38.4 steps/s
[Step=29600 Epoch=145.2] | Loss=0.00899 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.189 | L2-Norm(final)=14.865 | 4894.1 samples/s | 76.5 steps/s
[Step=29650 Epoch=145.4] | Loss=0.00874 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=14.867 | 4973.7 samples/s | 77.7 steps/s
[Step=29700 Epoch=145.6] | Loss=0.00847 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.196 | L2-Norm(final)=14.868 | 5200.6 samples/s | 81.3 steps/s
[Step=29750 Epoch=145.9] | Loss=0.00824 | Reg=0.00125 | acc=0.9688 | L2-Norm=11.199 | L2-Norm(final)=14.870 | 2500.9 samples/s | 39.1 steps/s
[Step=29800 Epoch=146.1] | Loss=0.00800 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.201 | L2-Norm(final)=14.872 | 4827.5 samples/s | 75.4 steps/s
[Step=29850 Epoch=146.4] | Loss=0.00780 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.204 | L2-Norm(final)=14.874 | 4850.0 samples/s | 75.8 steps/s
[Step=29900 Epoch=146.6] | Loss=0.00761 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.206 | L2-Norm(final)=14.876 | 5082.8 samples/s | 79.4 steps/s
[Step=29950 Epoch=146.9] | Loss=0.00749 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.208 | L2-Norm(final)=14.878 | 2586.5 samples/s | 40.4 steps/s
[Step=30000 Epoch=147.1] | Loss=0.00733 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.211 | L2-Norm(final)=14.879 | 4860.3 samples/s | 75.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step30000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=208.5] | Loss=0.00005 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.936 | L2-Norm(final)=13.995 | 5577.8 samples/s | 87.2 steps/s
[Step=22050 Epoch=208.9] | Loss=0.00191 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.934 | L2-Norm(final)=14.010 | 4704.7 samples/s | 73.5 steps/s
[Step=22100 Epoch=209.4] | Loss=0.00220 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=14.030 | 8272.5 samples/s | 129.3 steps/s
[Step=22150 Epoch=209.9] | Loss=0.00198 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=14.048 | 2366.4 samples/s | 37.0 steps/s
[Step=22200 Epoch=210.4] | Loss=0.00208 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=14.064 | 7009.9 samples/s | 109.5 steps/s
[Step=22250 Epoch=210.8] | Loss=0.00193 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=14.079 | 2463.2 samples/s | 38.5 steps/s
[Step=22300 Epoch=211.3] | Loss=0.00202 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=14.093 | 6409.6 samples/s | 100.1 steps/s
[Step=22350 Epoch=211.8] | Loss=0.00201 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=14.107 | 2535.7 samples/s | 39.6 steps/s
[Step=22400 Epoch=212.3] | Loss=0.00202 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=14.121 | 5972.4 samples/s | 93.3 steps/s
[Step=22450 Epoch=212.7] | Loss=0.00194 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=14.134 | 2624.2 samples/s | 41.0 steps/s
[Step=22500 Epoch=213.2] | Loss=0.00196 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=14.147 | 5516.5 samples/s | 86.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=213.2] | Loss=0.00007 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=14.274 | 6198.8 samples/s | 96.9 steps/s
[Step=22550 Epoch=213.7] | Loss=0.00417 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.975 | L2-Norm(final)=14.270 | 3874.6 samples/s | 60.5 steps/s
[Step=22600 Epoch=214.2] | Loss=0.00227 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=14.266 | 6729.7 samples/s | 105.2 steps/s
[Step=22650 Epoch=214.6] | Loss=0.00153 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.031 | L2-Norm(final)=14.267 | 2194.0 samples/s | 34.3 steps/s
[Step=22700 Epoch=215.1] | Loss=0.00115 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.035 | L2-Norm(final)=14.268 | 5993.6 samples/s | 93.7 steps/s
[Step=22750 Epoch=215.6] | Loss=0.00093 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.034 | L2-Norm(final)=14.269 | 2271.7 samples/s | 35.5 steps/s
[Step=22800 Epoch=216.0] | Loss=0.00077 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.030 | L2-Norm(final)=14.270 | 5567.4 samples/s | 87.0 steps/s
[Step=22850 Epoch=216.5] | Loss=0.00066 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.026 | L2-Norm(final)=14.271 | 2357.0 samples/s | 36.8 steps/s
[Step=22900 Epoch=217.0] | Loss=0.00058 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.021 | L2-Norm(final)=14.272 | 5083.3 samples/s | 79.4 steps/s
[Step=22950 Epoch=217.5] | Loss=0.00052 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=14.272 | 2448.4 samples/s | 38.3 steps/s
[Step=23000 Epoch=217.9] | Loss=0.00047 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.010 | L2-Norm(final)=14.273 | 4645.0 samples/s | 72.6 steps/s
[Step=23050 Epoch=218.4] | Loss=0.00043 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.004 | L2-Norm(final)=14.274 | 2512.3 samples/s | 39.3 steps/s
[Step=23100 Epoch=218.9] | Loss=0.00039 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.998 | L2-Norm(final)=14.274 | 4629.9 samples/s | 72.3 steps/s
[Step=23150 Epoch=219.4] | Loss=0.00036 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.992 | L2-Norm(final)=14.275 | 2578.6 samples/s | 40.3 steps/s
[Step=23200 Epoch=219.8] | Loss=0.00034 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.985 | L2-Norm(final)=14.276 | 4600.3 samples/s | 71.9 steps/s
[Step=23250 Epoch=220.3] | Loss=0.00031 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.979 | L2-Norm(final)=14.276 | 2597.0 samples/s | 40.6 steps/s
[Step=23300 Epoch=220.8] | Loss=0.00029 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.973 | L2-Norm(final)=14.277 | 4541.1 samples/s | 71.0 steps/s
[Step=23350 Epoch=221.3] | Loss=0.00028 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.966 | L2-Norm(final)=14.278 | 2698.3 samples/s | 42.2 steps/s
[Step=23400 Epoch=221.7] | Loss=0.00026 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.959 | L2-Norm(final)=14.278 | 4478.4 samples/s | 70.0 steps/s
[Step=23450 Epoch=222.2] | Loss=0.00025 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.953 | L2-Norm(final)=14.279 | 6828.0 samples/s | 106.7 steps/s
[Step=23500 Epoch=222.7] | Loss=0.00024 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.946 | L2-Norm(final)=14.280 | 2178.5 samples/s | 34.0 steps/s
[Step=23550 Epoch=223.2] | Loss=0.00022 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.940 | L2-Norm(final)=14.280 | 6163.2 samples/s | 96.3 steps/s
[Step=23600 Epoch=223.6] | Loss=0.00021 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=14.281 | 2265.1 samples/s | 35.4 steps/s
[Step=23650 Epoch=224.1] | Loss=0.00021 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.926 | L2-Norm(final)=14.282 | 5631.1 samples/s | 88.0 steps/s
[Step=23700 Epoch=224.6] | Loss=0.00020 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.919 | L2-Norm(final)=14.282 | 2353.8 samples/s | 36.8 steps/s
[Step=23750 Epoch=225.1] | Loss=0.00019 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.912 | L2-Norm(final)=14.283 | 5230.6 samples/s | 81.7 steps/s
[Step=23800 Epoch=225.5] | Loss=0.00018 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.905 | L2-Norm(final)=14.283 | 2409.9 samples/s | 37.7 steps/s
[Step=23850 Epoch=226.0] | Loss=0.00018 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.898 | L2-Norm(final)=14.284 | 4858.3 samples/s | 75.9 steps/s
[Step=23900 Epoch=226.5] | Loss=0.00017 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.891 | L2-Norm(final)=14.285 | 2484.9 samples/s | 38.8 steps/s
[Step=23950 Epoch=226.9] | Loss=0.00016 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.884 | L2-Norm(final)=14.285 | 4636.0 samples/s | 72.4 steps/s
[Step=24000 Epoch=227.4] | Loss=0.00016 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.877 | L2-Norm(final)=14.286 | 2562.0 samples/s | 40.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step24000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=209.3] | Loss=0.00037 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.936 | L2-Norm(final)=14.176 | 5380.9 samples/s | 84.1 steps/s
[Step=22050 Epoch=209.8] | Loss=0.00196 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.934 | L2-Norm(final)=14.191 | 4805.8 samples/s | 75.1 steps/s
[Step=22100 Epoch=210.2] | Loss=0.00225 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.934 | L2-Norm(final)=14.212 | 8457.8 samples/s | 132.2 steps/s
[Step=22150 Epoch=210.7] | Loss=0.00211 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.934 | L2-Norm(final)=14.235 | 2339.4 samples/s | 36.6 steps/s
[Step=22200 Epoch=211.2] | Loss=0.00213 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.934 | L2-Norm(final)=14.256 | 7439.5 samples/s | 116.2 steps/s
[Step=22250 Epoch=211.7] | Loss=0.00210 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.934 | L2-Norm(final)=14.275 | 2434.7 samples/s | 38.0 steps/s
[Step=22300 Epoch=212.1] | Loss=0.00211 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.934 | L2-Norm(final)=14.295 | 6666.5 samples/s | 104.2 steps/s
[Step=22350 Epoch=212.6] | Loss=0.00229 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.934 | L2-Norm(final)=14.314 | 2570.3 samples/s | 40.2 steps/s
[Step=22400 Epoch=213.1] | Loss=0.00222 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.934 | L2-Norm(final)=14.332 | 5890.8 samples/s | 92.0 steps/s
[Step=22450 Epoch=213.6] | Loss=0.00231 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.934 | L2-Norm(final)=14.350 | 2630.7 samples/s | 41.1 steps/s
[Step=22500 Epoch=214.0] | Loss=0.00228 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=14.366 | 5361.8 samples/s | 83.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=214.0] | Loss=0.00235 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=14.529 | 5596.4 samples/s | 87.4 steps/s
[Step=22550 Epoch=214.5] | Loss=0.00058 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.968 | L2-Norm(final)=14.535 | 4254.2 samples/s | 66.5 steps/s
[Step=22600 Epoch=215.0] | Loss=0.00033 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.973 | L2-Norm(final)=14.539 | 6575.8 samples/s | 102.7 steps/s
[Step=22650 Epoch=215.5] | Loss=0.00023 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.966 | L2-Norm(final)=14.542 | 2196.1 samples/s | 34.3 steps/s
[Step=22700 Epoch=215.9] | Loss=0.00017 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=14.543 | 6044.3 samples/s | 94.4 steps/s
[Step=22750 Epoch=216.4] | Loss=0.00014 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.944 | L2-Norm(final)=14.545 | 2269.2 samples/s | 35.5 steps/s
[Step=22800 Epoch=216.9] | Loss=0.00012 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.932 | L2-Norm(final)=14.546 | 5546.8 samples/s | 86.7 steps/s
[Step=22850 Epoch=217.4] | Loss=0.00010 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.920 | L2-Norm(final)=14.547 | 2351.1 samples/s | 36.7 steps/s
[Step=22900 Epoch=217.8] | Loss=0.00009 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.908 | L2-Norm(final)=14.548 | 5154.6 samples/s | 80.5 steps/s
[Step=22950 Epoch=218.3] | Loss=0.00008 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.896 | L2-Norm(final)=14.548 | 2448.8 samples/s | 38.3 steps/s
[Step=23000 Epoch=218.8] | Loss=0.00007 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.884 | L2-Norm(final)=14.549 | 4796.6 samples/s | 74.9 steps/s
[Step=23050 Epoch=219.3] | Loss=0.00007 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.872 | L2-Norm(final)=14.550 | 2535.1 samples/s | 39.6 steps/s
[Step=23100 Epoch=219.7] | Loss=0.00006 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.861 | L2-Norm(final)=14.550 | 4597.8 samples/s | 71.8 steps/s
[Step=23150 Epoch=220.2] | Loss=0.00006 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.849 | L2-Norm(final)=14.551 | 2564.6 samples/s | 40.1 steps/s
[Step=23200 Epoch=220.7] | Loss=0.00005 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.837 | L2-Norm(final)=14.551 | 4624.4 samples/s | 72.3 steps/s
[Step=23250 Epoch=221.2] | Loss=0.00005 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.826 | L2-Norm(final)=14.552 | 2556.2 samples/s | 39.9 steps/s
[Step=23300 Epoch=221.6] | Loss=0.00005 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.815 | L2-Norm(final)=14.552 | 4632.1 samples/s | 72.4 steps/s
[Step=23350 Epoch=222.1] | Loss=0.00004 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.803 | L2-Norm(final)=14.553 | 2737.5 samples/s | 42.8 steps/s
[Step=23400 Epoch=222.6] | Loss=0.00004 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.792 | L2-Norm(final)=14.553 | 4227.5 samples/s | 66.1 steps/s
[Step=23450 Epoch=223.1] | Loss=0.00004 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.780 | L2-Norm(final)=14.554 | 7019.6 samples/s | 109.7 steps/s
[Step=23500 Epoch=223.5] | Loss=0.00004 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=14.554 | 2165.8 samples/s | 33.8 steps/s
[Step=23550 Epoch=224.0] | Loss=0.00004 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.758 | L2-Norm(final)=14.555 | 6314.3 samples/s | 98.7 steps/s
[Step=23600 Epoch=224.5] | Loss=0.00003 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.746 | L2-Norm(final)=14.555 | 2232.9 samples/s | 34.9 steps/s
[Step=23650 Epoch=225.0] | Loss=0.00003 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.735 | L2-Norm(final)=14.556 | 5770.2 samples/s | 90.2 steps/s
[Step=23700 Epoch=225.4] | Loss=0.00003 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.723 | L2-Norm(final)=14.556 | 2305.9 samples/s | 36.0 steps/s
[Step=23750 Epoch=225.9] | Loss=0.00003 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.712 | L2-Norm(final)=14.557 | 5234.6 samples/s | 81.8 steps/s
[Step=23800 Epoch=226.4] | Loss=0.00003 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.701 | L2-Norm(final)=14.557 | 2378.1 samples/s | 37.2 steps/s
[Step=23850 Epoch=226.9] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.689 | L2-Norm(final)=14.558 | 4896.1 samples/s | 76.5 steps/s
[Step=23900 Epoch=227.3] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.678 | L2-Norm(final)=14.558 | 2544.1 samples/s | 39.8 steps/s
[Step=23950 Epoch=227.8] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.666 | L2-Norm(final)=14.559 | 4541.1 samples/s | 71.0 steps/s
[Step=24000 Epoch=228.3] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.655 | L2-Norm(final)=14.559 | 2648.2 samples/s | 41.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11061 | acc=0.9563 | tpr=0.9744 | fpr=0.0833 | 5596.8 samples/s | 21.9 steps/s
Avg test loss: 0.11709, Avg test acc: 0.95376, Avg tpr: 0.97266, Avg fpr: 0.08781, total FA: 685

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10306 | acc=0.9609 | tpr=0.9776 | fpr=0.0753 | 5801.3 samples/s | 22.7 steps/s
Avg test loss: 0.10702, Avg test acc: 0.96029, Avg tpr: 0.97546, Avg fpr: 0.07307, total FA: 570

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.10462 | acc=0.9590 | tpr=0.9694 | fpr=0.0637 | 5746.9 samples/s | 22.4 steps/s
Avg test loss: 0.10788, Avg test acc: 0.95765, Avg tpr: 0.96748, Avg fpr: 0.06397, total FA: 499

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09586 | acc=0.9626 | tpr=0.9796 | fpr=0.0743 | 4522.8 samples/s | 17.7 steps/s
Avg test loss: 0.10484, Avg test acc: 0.96117, Avg tpr: 0.97861, Avg fpr: 0.07717, total FA: 602

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10234 | acc=0.9595 | tpr=0.9774 | fpr=0.0795 | 4346.3 samples/s | 17.0 steps/s
Avg test loss: 0.11038, Avg test acc: 0.95909, Avg tpr: 0.97570, Avg fpr: 0.07743, total FA: 604

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.03369 | acc=0.2875 | tpr=0.0139 | fpr=0.1184 | 4473.4 samples/s | 17.5 steps/s
Avg test loss: 5.04172, Avg test acc: 0.28624, Avg tpr: 0.01411, Avg fpr: 0.11524, total FA: 899

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.66786 | acc=0.2839 | tpr=0.0154 | fpr=0.1331 | 4414.6 samples/s | 17.2 steps/s
Avg test loss: 4.67592, Avg test acc: 0.28255, Avg tpr: 0.01562, Avg fpr: 0.13037, total FA: 1017

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.14172 | acc=0.2616 | tpr=0.0201 | fpr=0.2141 | 5642.6 samples/s | 22.0 steps/s
Avg test loss: 5.15043, Avg test acc: 0.26236, Avg tpr: 0.02197, Avg fpr: 0.20895, total FA: 1630

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.10133 | acc=0.2562 | tpr=0.0081 | fpr=0.2049 | 5605.8 samples/s | 21.9 steps/s
Avg test loss: 5.10693, Avg test acc: 0.25487, Avg tpr: 0.00816, Avg fpr: 0.20254, total FA: 1580

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.94260 | acc=0.3017 | tpr=0.0114 | fpr=0.0679 | 5654.9 samples/s | 22.1 steps/s
Avg test loss: 4.95377, Avg test acc: 0.29902, Avg tpr: 0.01142, Avg fpr: 0.06845, total FA: 534

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.14756 | acc=0.1296 | tpr=0.3628 | fpr=0.8746 | 5658.3 samples/s | 22.1 steps/s
[Step= 100] | Loss=6.10270 | acc=0.1296 | tpr=0.3241 | fpr=0.8740 | 8017.9 samples/s | 31.3 steps/s
[Step= 150] | Loss=6.11391 | acc=0.1289 | tpr=0.3228 | fpr=0.8746 | 7837.2 samples/s | 30.6 steps/s
[Step= 200] | Loss=6.10875 | acc=0.1290 | tpr=0.3191 | fpr=0.8744 | 7409.4 samples/s | 28.9 steps/s
[Step= 250] | Loss=6.11095 | acc=0.1292 | tpr=0.3301 | fpr=0.8745 | 8430.3 samples/s | 32.9 steps/s
[Step= 300] | Loss=6.10822 | acc=0.1286 | tpr=0.3258 | fpr=0.8750 | 8109.9 samples/s | 31.7 steps/s
[Step= 350] | Loss=6.10818 | acc=0.1281 | tpr=0.3131 | fpr=0.8753 | 8183.5 samples/s | 32.0 steps/s
[Step= 400] | Loss=6.10527 | acc=0.1285 | tpr=0.3129 | fpr=0.8748 | 7709.5 samples/s | 30.1 steps/s
[Step= 450] | Loss=6.10610 | acc=0.1288 | tpr=0.3165 | fpr=0.8746 | 8011.2 samples/s | 31.3 steps/s
[Step= 500] | Loss=6.10876 | acc=0.1291 | tpr=0.3154 | fpr=0.8743 | 8599.2 samples/s | 33.6 steps/s
[Step= 550] | Loss=6.10600 | acc=0.1289 | tpr=0.3084 | fpr=0.8744 | 10676.5 samples/s | 41.7 steps/s
Avg test loss: 6.10619, Avg test acc: 0.12877, Avg tpr: 0.30824, Avg fpr: 0.87449, total FA: 121421

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.16969 | acc=0.1306 | tpr=0.2655 | fpr=0.8718 | 5839.7 samples/s | 22.8 steps/s
[Step= 100] | Loss=6.11946 | acc=0.1324 | tpr=0.2260 | fpr=0.8693 | 7485.2 samples/s | 29.2 steps/s
[Step= 150] | Loss=6.13457 | acc=0.1300 | tpr=0.2147 | fpr=0.8715 | 7525.6 samples/s | 29.4 steps/s
[Step= 200] | Loss=6.13375 | acc=0.1296 | tpr=0.2077 | fpr=0.8718 | 8272.6 samples/s | 32.3 steps/s
[Step= 250] | Loss=6.14068 | acc=0.1299 | tpr=0.2122 | fpr=0.8716 | 8197.1 samples/s | 32.0 steps/s
[Step= 300] | Loss=6.14433 | acc=0.1294 | tpr=0.2124 | fpr=0.8721 | 8090.2 samples/s | 31.6 steps/s
[Step= 350] | Loss=6.14693 | acc=0.1290 | tpr=0.1997 | fpr=0.8723 | 8271.2 samples/s | 32.3 steps/s
[Step= 400] | Loss=6.14558 | acc=0.1295 | tpr=0.2008 | fpr=0.8718 | 7826.3 samples/s | 30.6 steps/s
[Step= 450] | Loss=6.14674 | acc=0.1296 | tpr=0.1986 | fpr=0.8717 | 8160.1 samples/s | 31.9 steps/s
[Step= 500] | Loss=6.14705 | acc=0.1297 | tpr=0.2000 | fpr=0.8716 | 8574.6 samples/s | 33.5 steps/s
[Step= 550] | Loss=6.14479 | acc=0.1297 | tpr=0.1994 | fpr=0.8716 | 10351.8 samples/s | 40.4 steps/s
Avg test loss: 6.14515, Avg test acc: 0.12962, Avg tpr: 0.20008, Avg fpr: 0.87167, total FA: 121029

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.24211 | acc=0.1352 | tpr=0.1195 | fpr=0.8645 | 5867.7 samples/s | 22.9 steps/s
[Step= 100] | Loss=6.18489 | acc=0.1359 | tpr=0.1045 | fpr=0.8635 | 7511.0 samples/s | 29.3 steps/s
[Step= 150] | Loss=6.18882 | acc=0.1359 | tpr=0.1081 | fpr=0.8636 | 8348.6 samples/s | 32.6 steps/s
[Step= 200] | Loss=6.17759 | acc=0.1365 | tpr=0.1082 | fpr=0.8630 | 7970.1 samples/s | 31.1 steps/s
[Step= 250] | Loss=6.17737 | acc=0.1368 | tpr=0.1083 | fpr=0.8627 | 8078.5 samples/s | 31.6 steps/s
[Step= 300] | Loss=6.18465 | acc=0.1364 | tpr=0.1084 | fpr=0.8631 | 8235.8 samples/s | 32.2 steps/s
[Step= 350] | Loss=6.18810 | acc=0.1356 | tpr=0.1046 | fpr=0.8639 | 8551.0 samples/s | 33.4 steps/s
[Step= 400] | Loss=6.18626 | acc=0.1360 | tpr=0.1100 | fpr=0.8635 | 7531.0 samples/s | 29.4 steps/s
[Step= 450] | Loss=6.18545 | acc=0.1362 | tpr=0.1095 | fpr=0.8634 | 8481.6 samples/s | 33.1 steps/s
[Step= 500] | Loss=6.18736 | acc=0.1359 | tpr=0.1101 | fpr=0.8636 | 7429.9 samples/s | 29.0 steps/s
[Step= 550] | Loss=6.18250 | acc=0.1363 | tpr=0.1090 | fpr=0.8632 | 10775.7 samples/s | 42.1 steps/s
Avg test loss: 6.18253, Avg test acc: 0.13614, Avg tpr: 0.10935, Avg fpr: 0.86337, total FA: 119877

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.20997 | acc=0.1298 | tpr=0.2743 | fpr=0.8728 | 5733.8 samples/s | 22.4 steps/s
[Step= 100] | Loss=6.16229 | acc=0.1289 | tpr=0.2324 | fpr=0.8730 | 8472.8 samples/s | 33.1 steps/s
[Step= 150] | Loss=6.16948 | acc=0.1277 | tpr=0.2147 | fpr=0.8739 | 7471.9 samples/s | 29.2 steps/s
[Step= 200] | Loss=6.16077 | acc=0.1279 | tpr=0.2164 | fpr=0.8737 | 7832.0 samples/s | 30.6 steps/s
[Step= 250] | Loss=6.16637 | acc=0.1283 | tpr=0.2166 | fpr=0.8733 | 8612.5 samples/s | 33.6 steps/s
[Step= 300] | Loss=6.17117 | acc=0.1276 | tpr=0.2175 | fpr=0.8741 | 8032.2 samples/s | 31.4 steps/s
[Step= 350] | Loss=6.16981 | acc=0.1269 | tpr=0.2060 | fpr=0.8746 | 8054.4 samples/s | 31.5 steps/s
[Step= 400] | Loss=6.16704 | acc=0.1270 | tpr=0.2101 | fpr=0.8745 | 7985.0 samples/s | 31.2 steps/s
[Step= 450] | Loss=6.16718 | acc=0.1274 | tpr=0.2089 | fpr=0.8741 | 7808.7 samples/s | 30.5 steps/s
[Step= 500] | Loss=6.17066 | acc=0.1273 | tpr=0.2093 | fpr=0.8742 | 8267.4 samples/s | 32.3 steps/s
[Step= 550] | Loss=6.16918 | acc=0.1273 | tpr=0.2085 | fpr=0.8741 | 10250.6 samples/s | 40.0 steps/s
Avg test loss: 6.16869, Avg test acc: 0.12727, Avg tpr: 0.20840, Avg fpr: 0.87420, total FA: 121381

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=7.31114 | acc=0.1196 | tpr=0.2301 | fpr=0.8824 | 5601.3 samples/s | 21.9 steps/s
[Step= 100] | Loss=7.23932 | acc=0.1195 | tpr=0.2090 | fpr=0.8821 | 8079.7 samples/s | 31.6 steps/s
[Step= 150] | Loss=7.25589 | acc=0.1194 | tpr=0.1988 | fpr=0.8821 | 8001.5 samples/s | 31.3 steps/s
[Step= 200] | Loss=7.24837 | acc=0.1195 | tpr=0.1945 | fpr=0.8819 | 8202.6 samples/s | 32.0 steps/s
[Step= 250] | Loss=7.25752 | acc=0.1194 | tpr=0.1913 | fpr=0.8819 | 8520.5 samples/s | 33.3 steps/s
[Step= 300] | Loss=7.26090 | acc=0.1193 | tpr=0.1905 | fpr=0.8820 | 7972.0 samples/s | 31.1 steps/s
[Step= 350] | Loss=7.26544 | acc=0.1187 | tpr=0.1822 | fpr=0.8824 | 8038.3 samples/s | 31.4 steps/s
[Step= 400] | Loss=7.26275 | acc=0.1190 | tpr=0.1838 | fpr=0.8822 | 7462.1 samples/s | 29.1 steps/s
[Step= 450] | Loss=7.26129 | acc=0.1192 | tpr=0.1845 | fpr=0.8820 | 8094.2 samples/s | 31.6 steps/s
[Step= 500] | Loss=7.26653 | acc=0.1190 | tpr=0.1850 | fpr=0.8822 | 8420.2 samples/s | 32.9 steps/s
[Step= 550] | Loss=7.26329 | acc=0.1192 | tpr=0.1830 | fpr=0.8820 | 10236.5 samples/s | 40.0 steps/s
Avg test loss: 7.26282, Avg test acc: 0.11905, Avg tpr: 0.18423, Avg fpr: 0.88213, total FA: 122482

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10562 | acc=0.9791 | tpr=0.8894 | fpr=0.0192 | 5852.4 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.10802 | acc=0.9796 | tpr=0.9168 | fpr=0.0192 | 7810.8 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.11267 | acc=0.9790 | tpr=0.9222 | fpr=0.0200 | 7535.1 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.11505 | acc=0.9789 | tpr=0.9279 | fpr=0.0202 | 8138.1 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.11558 | acc=0.9786 | tpr=0.9249 | fpr=0.0205 | 8299.0 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.11712 | acc=0.9782 | tpr=0.9251 | fpr=0.0208 | 7391.2 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.11762 | acc=0.9782 | tpr=0.9274 | fpr=0.0209 | 8464.0 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.11853 | acc=0.9780 | tpr=0.9261 | fpr=0.0211 | 8217.8 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.12046 | acc=0.9778 | tpr=0.9250 | fpr=0.0212 | 8534.6 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.11959 | acc=0.9779 | tpr=0.9273 | fpr=0.0212 | 8095.5 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.11882 | acc=0.9780 | tpr=0.9276 | fpr=0.0211 | 10063.5 samples/s | 39.3 steps/s
Avg test loss: 0.11860, Avg test acc: 0.97804, Avg tpr: 0.92750, Avg fpr: 0.02104, total FA: 2921

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10860 | acc=0.9806 | tpr=0.8982 | fpr=0.0179 | 5694.0 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.11089 | acc=0.9807 | tpr=0.9254 | fpr=0.0183 | 7556.1 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.11510 | acc=0.9801 | tpr=0.9308 | fpr=0.0190 | 8510.7 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.11719 | acc=0.9800 | tpr=0.9344 | fpr=0.0191 | 8008.8 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.11769 | acc=0.9799 | tpr=0.9310 | fpr=0.0192 | 8465.9 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.11940 | acc=0.9797 | tpr=0.9309 | fpr=0.0194 | 8264.5 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.11970 | acc=0.9795 | tpr=0.9311 | fpr=0.0196 | 7355.7 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.12077 | acc=0.9794 | tpr=0.9267 | fpr=0.0197 | 8189.5 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.12283 | acc=0.9791 | tpr=0.9250 | fpr=0.0199 | 8717.4 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.12201 | acc=0.9792 | tpr=0.9273 | fpr=0.0199 | 8100.0 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.12109 | acc=0.9793 | tpr=0.9260 | fpr=0.0198 | 9360.0 samples/s | 36.6 steps/s
Avg test loss: 0.12086, Avg test acc: 0.97927, Avg tpr: 0.92591, Avg fpr: 0.01976, total FA: 2743

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.13373 | acc=0.9725 | tpr=0.9292 | fpr=0.0267 | 5550.7 samples/s | 21.7 steps/s
[Step= 100] | Loss=0.13616 | acc=0.9734 | tpr=0.9467 | fpr=0.0261 | 8665.0 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.14299 | acc=0.9720 | tpr=0.9524 | fpr=0.0277 | 7470.0 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.14530 | acc=0.9719 | tpr=0.9508 | fpr=0.0278 | 8462.5 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.14714 | acc=0.9715 | tpr=0.9493 | fpr=0.0281 | 8206.2 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.14882 | acc=0.9713 | tpr=0.9433 | fpr=0.0282 | 7726.4 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.14872 | acc=0.9714 | tpr=0.9455 | fpr=0.0282 | 8134.7 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.15036 | acc=0.9711 | tpr=0.9409 | fpr=0.0284 | 8690.3 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.15279 | acc=0.9704 | tpr=0.9387 | fpr=0.0290 | 7928.6 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.15150 | acc=0.9704 | tpr=0.9410 | fpr=0.0290 | 7536.9 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.15035 | acc=0.9707 | tpr=0.9411 | fpr=0.0288 | 10213.4 samples/s | 39.9 steps/s
Avg test loss: 0.15005, Avg test acc: 0.97067, Avg tpr: 0.94097, Avg fpr: 0.02879, total FA: 3997

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10284 | acc=0.9811 | tpr=0.9248 | fpr=0.0179 | 5809.8 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.10562 | acc=0.9805 | tpr=0.9254 | fpr=0.0184 | 7436.0 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.10967 | acc=0.9804 | tpr=0.9308 | fpr=0.0186 | 7964.3 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.11144 | acc=0.9804 | tpr=0.9311 | fpr=0.0187 | 7819.0 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.11127 | acc=0.9804 | tpr=0.9258 | fpr=0.0186 | 8167.5 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.11288 | acc=0.9802 | tpr=0.9215 | fpr=0.0187 | 8594.3 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.11267 | acc=0.9802 | tpr=0.9236 | fpr=0.0187 | 7849.8 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.11345 | acc=0.9802 | tpr=0.9207 | fpr=0.0187 | 8243.2 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.11556 | acc=0.9799 | tpr=0.9187 | fpr=0.0190 | 8251.6 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.11487 | acc=0.9800 | tpr=0.9211 | fpr=0.0189 | 7624.6 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.11427 | acc=0.9801 | tpr=0.9212 | fpr=0.0189 | 10967.7 samples/s | 42.8 steps/s
Avg test loss: 0.11403, Avg test acc: 0.98009, Avg tpr: 0.92116, Avg fpr: 0.01884, total FA: 2616

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10876 | acc=0.9798 | tpr=0.9071 | fpr=0.0188 | 5655.3 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.11432 | acc=0.9800 | tpr=0.9232 | fpr=0.0189 | 7965.9 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.12040 | acc=0.9790 | tpr=0.9222 | fpr=0.0199 | 8466.5 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.12166 | acc=0.9790 | tpr=0.9191 | fpr=0.0199 | 7935.4 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.12115 | acc=0.9793 | tpr=0.9179 | fpr=0.0196 | 7289.0 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.12340 | acc=0.9793 | tpr=0.9171 | fpr=0.0196 | 8356.2 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.12385 | acc=0.9791 | tpr=0.9161 | fpr=0.0197 | 8390.3 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.12444 | acc=0.9791 | tpr=0.9152 | fpr=0.0197 | 8006.2 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.12662 | acc=0.9788 | tpr=0.9133 | fpr=0.0200 | 8112.9 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.12603 | acc=0.9790 | tpr=0.9141 | fpr=0.0199 | 8234.0 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.12536 | acc=0.9790 | tpr=0.9156 | fpr=0.0198 | 9346.5 samples/s | 36.5 steps/s
Avg test loss: 0.12523, Avg test acc: 0.97902, Avg tpr: 0.91482, Avg fpr: 0.01981, total FA: 2751

server round 23/50

clients selected: [3 4 5 7 9]

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=117.0] | Loss=0.05477 | Reg=0.00118 | acc=0.9531 | L2-Norm=10.860 | L2-Norm(final)=14.326 | 5691.8 samples/s | 88.9 steps/s
[Step=24050 Epoch=117.3] | Loss=0.03047 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.860 | L2-Norm(final)=14.323 | 5073.1 samples/s | 79.3 steps/s
[Step=24100 Epoch=117.5] | Loss=0.02963 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.860 | L2-Norm(final)=14.323 | 5605.3 samples/s | 87.6 steps/s
[Step=24150 Epoch=117.8] | Loss=0.02916 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.860 | L2-Norm(final)=14.324 | 5634.7 samples/s | 88.0 steps/s
[Step=24200 Epoch=118.0] | Loss=0.02753 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.860 | L2-Norm(final)=14.326 | 8808.8 samples/s | 137.6 steps/s
[Step=24250 Epoch=118.3] | Loss=0.02758 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.860 | L2-Norm(final)=14.327 | 2463.1 samples/s | 38.5 steps/s
[Step=24300 Epoch=118.5] | Loss=0.02760 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.860 | L2-Norm(final)=14.329 | 5480.1 samples/s | 85.6 steps/s
[Step=24350 Epoch=118.7] | Loss=0.02740 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.860 | L2-Norm(final)=14.331 | 5710.7 samples/s | 89.2 steps/s
[Step=24400 Epoch=119.0] | Loss=0.02711 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.860 | L2-Norm(final)=14.334 | 7646.7 samples/s | 119.5 steps/s
[Step=24450 Epoch=119.2] | Loss=0.02684 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.860 | L2-Norm(final)=14.338 | 2508.4 samples/s | 39.2 steps/s
[Step=24500 Epoch=119.5] | Loss=0.02681 | Reg=0.00118 | acc=0.9531 | L2-Norm=10.860 | L2-Norm(final)=14.342 | 5666.4 samples/s | 88.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=119.5] | Loss=0.05583 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.860 | L2-Norm(final)=14.381 | 5831.6 samples/s | 91.1 steps/s
[Step=24550 Epoch=119.7] | Loss=0.02700 | Reg=0.00119 | acc=0.9531 | L2-Norm=10.906 | L2-Norm(final)=14.376 | 4438.9 samples/s | 69.4 steps/s
[Step=24600 Epoch=120.0] | Loss=0.02828 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.939 | L2-Norm(final)=14.368 | 4761.7 samples/s | 74.4 steps/s
[Step=24650 Epoch=120.2] | Loss=0.02651 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=14.366 | 4853.4 samples/s | 75.8 steps/s
[Step=24700 Epoch=120.5] | Loss=0.02461 | Reg=0.00121 | acc=0.9688 | L2-Norm=10.982 | L2-Norm(final)=14.366 | 6971.9 samples/s | 108.9 steps/s
[Step=24750 Epoch=120.7] | Loss=0.02150 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.000 | L2-Norm(final)=14.368 | 2273.2 samples/s | 35.5 steps/s
[Step=24800 Epoch=120.9] | Loss=0.01962 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.014 | L2-Norm(final)=14.370 | 4816.6 samples/s | 75.3 steps/s
[Step=24850 Epoch=121.2] | Loss=0.01794 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.026 | L2-Norm(final)=14.372 | 4916.4 samples/s | 76.8 steps/s
[Step=24900 Epoch=121.4] | Loss=0.01686 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.036 | L2-Norm(final)=14.375 | 6297.3 samples/s | 98.4 steps/s
[Step=24950 Epoch=121.7] | Loss=0.01551 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.045 | L2-Norm(final)=14.377 | 2338.8 samples/s | 36.5 steps/s
[Step=25000 Epoch=121.9] | Loss=0.01483 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.053 | L2-Norm(final)=14.379 | 4944.0 samples/s | 77.3 steps/s
[Step=25050 Epoch=122.2] | Loss=0.01405 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.060 | L2-Norm(final)=14.381 | 4746.1 samples/s | 74.2 steps/s
[Step=25100 Epoch=122.4] | Loss=0.01339 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.067 | L2-Norm(final)=14.383 | 5811.7 samples/s | 90.8 steps/s
[Step=25150 Epoch=122.6] | Loss=0.01282 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.073 | L2-Norm(final)=14.384 | 2418.6 samples/s | 37.8 steps/s
[Step=25200 Epoch=122.9] | Loss=0.01220 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.078 | L2-Norm(final)=14.386 | 4851.3 samples/s | 75.8 steps/s
[Step=25250 Epoch=123.1] | Loss=0.01165 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.083 | L2-Norm(final)=14.388 | 4846.9 samples/s | 75.7 steps/s
[Step=25300 Epoch=123.4] | Loss=0.01129 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.087 | L2-Norm(final)=14.390 | 5342.5 samples/s | 83.5 steps/s
[Step=25350 Epoch=123.6] | Loss=0.01091 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.091 | L2-Norm(final)=14.392 | 2518.4 samples/s | 39.4 steps/s
[Step=25400 Epoch=123.9] | Loss=0.01049 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=14.393 | 4858.7 samples/s | 75.9 steps/s
[Step=25450 Epoch=124.1] | Loss=0.01010 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.098 | L2-Norm(final)=14.395 | 4884.7 samples/s | 76.3 steps/s
[Step=25500 Epoch=124.4] | Loss=0.00979 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.101 | L2-Norm(final)=14.397 | 5000.2 samples/s | 78.1 steps/s
[Step=25550 Epoch=124.6] | Loss=0.00955 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.104 | L2-Norm(final)=14.398 | 2619.6 samples/s | 40.9 steps/s
[Step=25600 Epoch=124.8] | Loss=0.00927 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.107 | L2-Norm(final)=14.400 | 4844.8 samples/s | 75.7 steps/s
[Step=25650 Epoch=125.1] | Loss=0.00901 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.109 | L2-Norm(final)=14.402 | 4838.8 samples/s | 75.6 steps/s
[Step=25700 Epoch=125.3] | Loss=0.00883 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.111 | L2-Norm(final)=14.403 | 4894.5 samples/s | 76.5 steps/s
[Step=25750 Epoch=125.6] | Loss=0.00860 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.114 | L2-Norm(final)=14.405 | 2623.9 samples/s | 41.0 steps/s
[Step=25800 Epoch=125.8] | Loss=0.00835 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.116 | L2-Norm(final)=14.406 | 4871.7 samples/s | 76.1 steps/s
[Step=25850 Epoch=126.1] | Loss=0.00814 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.118 | L2-Norm(final)=14.408 | 4850.2 samples/s | 75.8 steps/s
[Step=25900 Epoch=126.3] | Loss=0.00793 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.120 | L2-Norm(final)=14.409 | 4962.3 samples/s | 77.5 steps/s
[Step=25950 Epoch=126.5] | Loss=0.00780 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.122 | L2-Norm(final)=14.411 | 2625.2 samples/s | 41.0 steps/s
[Step=26000 Epoch=126.8] | Loss=0.00762 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.123 | L2-Norm(final)=14.412 | 4895.8 samples/s | 76.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step26000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=30001 Epoch=147.1] | Loss=0.07465 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.860 | L2-Norm(final)=14.932 | 5544.2 samples/s | 86.6 steps/s
[Step=30050 Epoch=147.4] | Loss=0.03047 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.860 | L2-Norm(final)=14.931 | 5288.5 samples/s | 82.6 steps/s
[Step=30100 Epoch=147.6] | Loss=0.03064 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.860 | L2-Norm(final)=14.925 | 5353.3 samples/s | 83.6 steps/s
[Step=30150 Epoch=147.9] | Loss=0.02908 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.860 | L2-Norm(final)=14.920 | 5653.8 samples/s | 88.3 steps/s
[Step=30200 Epoch=148.1] | Loss=0.02785 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.860 | L2-Norm(final)=14.919 | 9034.3 samples/s | 141.2 steps/s
[Step=30250 Epoch=148.3] | Loss=0.02790 | Reg=0.00118 | acc=0.9531 | L2-Norm=10.860 | L2-Norm(final)=14.919 | 2415.1 samples/s | 37.7 steps/s
[Step=30300 Epoch=148.6] | Loss=0.02813 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.860 | L2-Norm(final)=14.919 | 5512.1 samples/s | 86.1 steps/s
[Step=30350 Epoch=148.8] | Loss=0.02760 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.860 | L2-Norm(final)=14.920 | 5615.5 samples/s | 87.7 steps/s
[Step=30400 Epoch=149.1] | Loss=0.02761 | Reg=0.00118 | acc=0.9531 | L2-Norm=10.860 | L2-Norm(final)=14.921 | 8327.5 samples/s | 130.1 steps/s
[Step=30450 Epoch=149.3] | Loss=0.02763 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.860 | L2-Norm(final)=14.922 | 2480.7 samples/s | 38.8 steps/s
[Step=30500 Epoch=149.6] | Loss=0.02746 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.860 | L2-Norm(final)=14.923 | 5517.3 samples/s | 86.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=30501 Epoch=149.6] | Loss=0.01727 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.860 | L2-Norm(final)=14.934 | 6339.7 samples/s | 99.1 steps/s
[Step=30550 Epoch=149.8] | Loss=0.03219 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.907 | L2-Norm(final)=14.931 | 4125.5 samples/s | 64.5 steps/s
[Step=30600 Epoch=150.1] | Loss=0.03120 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.949 | L2-Norm(final)=14.926 | 4872.7 samples/s | 76.1 steps/s
[Step=30650 Epoch=150.3] | Loss=0.02694 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.977 | L2-Norm(final)=14.923 | 4849.9 samples/s | 75.8 steps/s
[Step=30700 Epoch=150.5] | Loss=0.02438 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.999 | L2-Norm(final)=14.923 | 7120.1 samples/s | 111.3 steps/s
[Step=30750 Epoch=150.8] | Loss=0.02162 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.017 | L2-Norm(final)=14.925 | 2229.4 samples/s | 34.8 steps/s
[Step=30800 Epoch=151.0] | Loss=0.01955 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.031 | L2-Norm(final)=14.927 | 4887.6 samples/s | 76.4 steps/s
[Step=30850 Epoch=151.3] | Loss=0.01774 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.043 | L2-Norm(final)=14.930 | 4903.1 samples/s | 76.6 steps/s
[Step=30900 Epoch=151.5] | Loss=0.01640 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.053 | L2-Norm(final)=14.932 | 6510.9 samples/s | 101.7 steps/s
[Step=30950 Epoch=151.8] | Loss=0.01506 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.062 | L2-Norm(final)=14.935 | 2277.2 samples/s | 35.6 steps/s
[Step=31000 Epoch=152.0] | Loss=0.01427 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.070 | L2-Norm(final)=14.938 | 4885.7 samples/s | 76.3 steps/s
[Step=31050 Epoch=152.3] | Loss=0.01354 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.078 | L2-Norm(final)=14.941 | 4862.4 samples/s | 76.0 steps/s
[Step=31100 Epoch=152.5] | Loss=0.01297 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.085 | L2-Norm(final)=14.943 | 6296.4 samples/s | 98.4 steps/s
[Step=31150 Epoch=152.8] | Loss=0.01220 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.091 | L2-Norm(final)=14.946 | 2320.5 samples/s | 36.3 steps/s
[Step=31200 Epoch=153.0] | Loss=0.01176 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.097 | L2-Norm(final)=14.948 | 4944.2 samples/s | 77.3 steps/s
[Step=31250 Epoch=153.2] | Loss=0.01120 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=14.950 | 4827.4 samples/s | 75.4 steps/s
[Step=31300 Epoch=153.5] | Loss=0.01085 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.107 | L2-Norm(final)=14.952 | 5902.0 samples/s | 92.2 steps/s
[Step=31350 Epoch=153.7] | Loss=0.01046 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.111 | L2-Norm(final)=14.954 | 2401.4 samples/s | 37.5 steps/s
[Step=31400 Epoch=154.0] | Loss=0.01004 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.115 | L2-Norm(final)=14.956 | 4901.4 samples/s | 76.6 steps/s
[Step=31450 Epoch=154.2] | Loss=0.00963 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.118 | L2-Norm(final)=14.958 | 4836.7 samples/s | 75.6 steps/s
[Step=31500 Epoch=154.5] | Loss=0.00936 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.121 | L2-Norm(final)=14.960 | 5628.1 samples/s | 87.9 steps/s
[Step=31550 Epoch=154.7] | Loss=0.00911 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.124 | L2-Norm(final)=14.962 | 2465.2 samples/s | 38.5 steps/s
[Step=31600 Epoch=155.0] | Loss=0.00887 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.127 | L2-Norm(final)=14.964 | 4929.5 samples/s | 77.0 steps/s
[Step=31650 Epoch=155.2] | Loss=0.00866 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.130 | L2-Norm(final)=14.966 | 4806.2 samples/s | 75.1 steps/s
[Step=31700 Epoch=155.5] | Loss=0.00840 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.133 | L2-Norm(final)=14.968 | 5337.7 samples/s | 83.4 steps/s
[Step=31750 Epoch=155.7] | Loss=0.00817 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.135 | L2-Norm(final)=14.970 | 2492.5 samples/s | 38.9 steps/s
[Step=31800 Epoch=155.9] | Loss=0.00797 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.137 | L2-Norm(final)=14.971 | 4796.2 samples/s | 74.9 steps/s
[Step=31850 Epoch=156.2] | Loss=0.00780 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.140 | L2-Norm(final)=14.973 | 4814.6 samples/s | 75.2 steps/s
[Step=31900 Epoch=156.4] | Loss=0.00764 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.142 | L2-Norm(final)=14.975 | 5089.6 samples/s | 79.5 steps/s
[Step=31950 Epoch=156.7] | Loss=0.00752 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.144 | L2-Norm(final)=14.977 | 2574.0 samples/s | 40.2 steps/s
[Step=32000 Epoch=156.9] | Loss=0.00739 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.146 | L2-Norm(final)=14.978 | 4839.4 samples/s | 75.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step32000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=227.4] | Loss=0.00230 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.860 | L2-Norm(final)=14.301 | 5721.3 samples/s | 89.4 steps/s
[Step=24050 Epoch=227.9] | Loss=0.00214 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.858 | L2-Norm(final)=14.311 | 4532.5 samples/s | 70.8 steps/s
[Step=24100 Epoch=228.4] | Loss=0.00166 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=14.323 | 8294.8 samples/s | 129.6 steps/s
[Step=24150 Epoch=228.8] | Loss=0.00170 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=14.338 | 2360.2 samples/s | 36.9 steps/s
[Step=24200 Epoch=229.3] | Loss=0.00166 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=14.352 | 7452.8 samples/s | 116.5 steps/s
[Step=24250 Epoch=229.8] | Loss=0.00162 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=14.365 | 2430.2 samples/s | 38.0 steps/s
[Step=24300 Epoch=230.3] | Loss=0.00163 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=14.378 | 6657.6 samples/s | 104.0 steps/s
[Step=24350 Epoch=230.7] | Loss=0.00157 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=14.390 | 2571.9 samples/s | 40.2 steps/s
[Step=24400 Epoch=231.2] | Loss=0.00157 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=14.402 | 5848.4 samples/s | 91.4 steps/s
[Step=24450 Epoch=231.7] | Loss=0.00154 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=14.414 | 2628.3 samples/s | 41.1 steps/s
[Step=24500 Epoch=232.2] | Loss=0.00157 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.857 | L2-Norm(final)=14.425 | 5452.3 samples/s | 85.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=232.2] | Loss=0.00066 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=14.540 | 6642.3 samples/s | 103.8 steps/s
[Step=24550 Epoch=232.6] | Loss=0.00250 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.892 | L2-Norm(final)=14.546 | 3898.8 samples/s | 60.9 steps/s
[Step=24600 Epoch=233.1] | Loss=0.00140 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.931 | L2-Norm(final)=14.550 | 6698.4 samples/s | 104.7 steps/s
[Step=24650 Epoch=233.6] | Loss=0.00094 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=14.553 | 2179.3 samples/s | 34.1 steps/s
[Step=24700 Epoch=234.1] | Loss=0.00071 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.947 | L2-Norm(final)=14.555 | 6087.5 samples/s | 95.1 steps/s
[Step=24750 Epoch=234.5] | Loss=0.00057 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=14.556 | 2263.8 samples/s | 35.4 steps/s
[Step=24800 Epoch=235.0] | Loss=0.00048 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.941 | L2-Norm(final)=14.557 | 5565.2 samples/s | 87.0 steps/s
[Step=24850 Epoch=235.5] | Loss=0.00041 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.936 | L2-Norm(final)=14.558 | 2349.4 samples/s | 36.7 steps/s
[Step=24900 Epoch=235.9] | Loss=0.00036 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.930 | L2-Norm(final)=14.559 | 5108.9 samples/s | 79.8 steps/s
[Step=24950 Epoch=236.4] | Loss=0.00032 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=14.560 | 2424.8 samples/s | 37.9 steps/s
[Step=25000 Epoch=236.9] | Loss=0.00029 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.916 | L2-Norm(final)=14.560 | 4753.8 samples/s | 74.3 steps/s
[Step=25050 Epoch=237.4] | Loss=0.00026 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.909 | L2-Norm(final)=14.561 | 2538.3 samples/s | 39.7 steps/s
[Step=25100 Epoch=237.8] | Loss=0.00024 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.902 | L2-Norm(final)=14.562 | 4539.9 samples/s | 70.9 steps/s
[Step=25150 Epoch=238.3] | Loss=0.00022 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=14.562 | 2557.4 samples/s | 40.0 steps/s
[Step=25200 Epoch=238.8] | Loss=0.00021 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.887 | L2-Norm(final)=14.563 | 4643.3 samples/s | 72.6 steps/s
[Step=25250 Epoch=239.3] | Loss=0.00019 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=14.563 | 2575.8 samples/s | 40.2 steps/s
[Step=25300 Epoch=239.7] | Loss=0.00018 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.872 | L2-Norm(final)=14.564 | 4608.0 samples/s | 72.0 steps/s
[Step=25350 Epoch=240.2] | Loss=0.00017 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.864 | L2-Norm(final)=14.565 | 2630.8 samples/s | 41.1 steps/s
[Step=25400 Epoch=240.7] | Loss=0.00016 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=14.565 | 4521.1 samples/s | 70.6 steps/s
[Step=25450 Epoch=241.2] | Loss=0.00015 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.849 | L2-Norm(final)=14.566 | 6774.1 samples/s | 105.8 steps/s
[Step=25500 Epoch=241.6] | Loss=0.00014 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=14.566 | 2188.0 samples/s | 34.2 steps/s
[Step=25550 Epoch=242.1] | Loss=0.00014 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.833 | L2-Norm(final)=14.567 | 6070.3 samples/s | 94.8 steps/s
[Step=25600 Epoch=242.6] | Loss=0.00013 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.825 | L2-Norm(final)=14.567 | 2243.1 samples/s | 35.0 steps/s
[Step=25650 Epoch=243.1] | Loss=0.00013 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.817 | L2-Norm(final)=14.567 | 5644.6 samples/s | 88.2 steps/s
[Step=25700 Epoch=243.5] | Loss=0.00012 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.809 | L2-Norm(final)=14.568 | 2308.6 samples/s | 36.1 steps/s
[Step=25750 Epoch=244.0] | Loss=0.00012 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.801 | L2-Norm(final)=14.568 | 5279.0 samples/s | 82.5 steps/s
[Step=25800 Epoch=244.5] | Loss=0.00011 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.793 | L2-Norm(final)=14.569 | 2389.5 samples/s | 37.3 steps/s
[Step=25850 Epoch=245.0] | Loss=0.00011 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.785 | L2-Norm(final)=14.569 | 4863.2 samples/s | 76.0 steps/s
[Step=25900 Epoch=245.4] | Loss=0.00010 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.777 | L2-Norm(final)=14.570 | 2515.0 samples/s | 39.3 steps/s
[Step=25950 Epoch=245.9] | Loss=0.00010 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=14.570 | 4611.8 samples/s | 72.1 steps/s
[Step=26000 Epoch=246.4] | Loss=0.00010 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.760 | L2-Norm(final)=14.571 | 2538.0 samples/s | 39.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step26000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=210.1] | Loss=0.00079 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.860 | L2-Norm(final)=15.569 | 5451.2 samples/s | 85.2 steps/s
[Step=22050 Epoch=210.6] | Loss=0.00041 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=15.585 | 4754.7 samples/s | 74.3 steps/s
[Step=22100 Epoch=211.0] | Loss=0.00088 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.856 | L2-Norm(final)=15.606 | 8406.6 samples/s | 131.4 steps/s
[Step=22150 Epoch=211.5] | Loss=0.00082 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=15.624 | 2333.8 samples/s | 36.5 steps/s
[Step=22200 Epoch=212.0] | Loss=0.00086 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=15.642 | 7651.1 samples/s | 119.5 steps/s
[Step=22250 Epoch=212.5] | Loss=0.00085 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=15.658 | 2425.7 samples/s | 37.9 steps/s
[Step=22300 Epoch=213.0] | Loss=0.00084 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=15.674 | 6860.1 samples/s | 107.2 steps/s
[Step=22350 Epoch=213.4] | Loss=0.00085 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=15.688 | 2472.0 samples/s | 38.6 steps/s
[Step=22400 Epoch=213.9] | Loss=0.00081 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=15.701 | 6360.5 samples/s | 99.4 steps/s
[Step=22450 Epoch=214.4] | Loss=0.00086 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=15.715 | 2533.9 samples/s | 39.6 steps/s
[Step=22500 Epoch=214.9] | Loss=0.00081 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=15.728 | 5915.8 samples/s | 92.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=214.9] | Loss=0.00046 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=15.855 | 5638.9 samples/s | 88.1 steps/s
[Step=22550 Epoch=215.3] | Loss=0.00288 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.876 | L2-Norm(final)=15.861 | 4254.9 samples/s | 66.5 steps/s
[Step=22600 Epoch=215.8] | Loss=0.00359 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=15.848 | 6798.0 samples/s | 106.2 steps/s
[Step=22650 Epoch=216.3] | Loss=0.00241 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.991 | L2-Norm(final)=15.841 | 2217.9 samples/s | 34.7 steps/s
[Step=22700 Epoch=216.8] | Loss=0.00182 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.008 | L2-Norm(final)=15.838 | 6027.3 samples/s | 94.2 steps/s
[Step=22750 Epoch=217.2] | Loss=0.00146 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=15.838 | 2251.9 samples/s | 35.2 steps/s
[Step=22800 Epoch=217.7] | Loss=0.00122 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=15.837 | 5770.4 samples/s | 90.2 steps/s
[Step=22850 Epoch=218.2] | Loss=0.00104 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.021 | L2-Norm(final)=15.837 | 2315.1 samples/s | 36.2 steps/s
[Step=22900 Epoch=218.7] | Loss=0.00091 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=15.837 | 5366.1 samples/s | 83.8 steps/s
[Step=22950 Epoch=219.2] | Loss=0.00081 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.018 | L2-Norm(final)=15.837 | 2391.5 samples/s | 37.4 steps/s
[Step=23000 Epoch=219.6] | Loss=0.00073 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.015 | L2-Norm(final)=15.837 | 4980.2 samples/s | 77.8 steps/s
[Step=23050 Epoch=220.1] | Loss=0.00067 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.012 | L2-Norm(final)=15.837 | 2473.6 samples/s | 38.7 steps/s
[Step=23100 Epoch=220.6] | Loss=0.00061 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.009 | L2-Norm(final)=15.838 | 4698.9 samples/s | 73.4 steps/s
[Step=23150 Epoch=221.1] | Loss=0.00056 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.005 | L2-Norm(final)=15.838 | 2520.6 samples/s | 39.4 steps/s
[Step=23200 Epoch=221.5] | Loss=0.00052 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.001 | L2-Norm(final)=15.839 | 4596.8 samples/s | 71.8 steps/s
[Step=23250 Epoch=222.0] | Loss=0.00049 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.996 | L2-Norm(final)=15.839 | 2566.3 samples/s | 40.1 steps/s
[Step=23300 Epoch=222.5] | Loss=0.00046 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.992 | L2-Norm(final)=15.840 | 4664.5 samples/s | 72.9 steps/s
[Step=23350 Epoch=223.0] | Loss=0.00043 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.987 | L2-Norm(final)=15.840 | 2563.7 samples/s | 40.1 steps/s
[Step=23400 Epoch=223.5] | Loss=0.00041 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.982 | L2-Norm(final)=15.841 | 4603.8 samples/s | 71.9 steps/s
[Step=23450 Epoch=223.9] | Loss=0.00039 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.977 | L2-Norm(final)=15.841 | 2640.1 samples/s | 41.3 steps/s
[Step=23500 Epoch=224.4] | Loss=0.00037 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.972 | L2-Norm(final)=15.842 | 4409.8 samples/s | 68.9 steps/s
[Step=23550 Epoch=224.9] | Loss=0.00035 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.967 | L2-Norm(final)=15.842 | 7284.5 samples/s | 113.8 steps/s
[Step=23600 Epoch=225.4] | Loss=0.00033 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=15.843 | 2133.4 samples/s | 33.3 steps/s
[Step=23650 Epoch=225.8] | Loss=0.00032 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=15.843 | 6664.3 samples/s | 104.1 steps/s
[Step=23700 Epoch=226.3] | Loss=0.00031 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=15.844 | 2173.4 samples/s | 34.0 steps/s
[Step=23750 Epoch=226.8] | Loss=0.00029 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.946 | L2-Norm(final)=15.844 | 6287.9 samples/s | 98.2 steps/s
[Step=23800 Epoch=227.3] | Loss=0.00028 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.941 | L2-Norm(final)=15.845 | 2248.3 samples/s | 35.1 steps/s
[Step=23850 Epoch=227.8] | Loss=0.00027 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.935 | L2-Norm(final)=15.846 | 5804.4 samples/s | 90.7 steps/s
[Step=23900 Epoch=228.2] | Loss=0.00026 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.930 | L2-Norm(final)=15.846 | 2313.0 samples/s | 36.1 steps/s
[Step=23950 Epoch=228.7] | Loss=0.00025 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.924 | L2-Norm(final)=15.847 | 5399.8 samples/s | 84.4 steps/s
[Step=24000 Epoch=229.2] | Loss=0.00025 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.919 | L2-Norm(final)=15.847 | 2415.2 samples/s | 37.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step24000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=14001 Epoch=133.4] | Loss=0.00183 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.860 | L2-Norm(final)=13.474 | 5865.5 samples/s | 91.6 steps/s
[Step=14050 Epoch=133.9] | Loss=0.00540 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.859 | L2-Norm(final)=13.469 | 4614.6 samples/s | 72.1 steps/s
[Step=14100 Epoch=134.4] | Loss=0.00403 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.858 | L2-Norm(final)=13.473 | 8095.5 samples/s | 126.5 steps/s
[Step=14150 Epoch=134.9] | Loss=0.00406 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.858 | L2-Norm(final)=13.480 | 2338.7 samples/s | 36.5 steps/s
[Step=14200 Epoch=135.3] | Loss=0.00404 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.858 | L2-Norm(final)=13.486 | 7657.1 samples/s | 119.6 steps/s
[Step=14250 Epoch=135.8] | Loss=0.00393 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.858 | L2-Norm(final)=13.493 | 2422.2 samples/s | 37.8 steps/s
[Step=14300 Epoch=136.3] | Loss=0.00378 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.858 | L2-Norm(final)=13.500 | 6796.3 samples/s | 106.2 steps/s
[Step=14350 Epoch=136.8] | Loss=0.00387 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.858 | L2-Norm(final)=13.507 | 2445.4 samples/s | 38.2 steps/s
[Step=14400 Epoch=137.2] | Loss=0.00380 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.858 | L2-Norm(final)=13.516 | 6423.9 samples/s | 100.4 steps/s
[Step=14450 Epoch=137.7] | Loss=0.00394 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.858 | L2-Norm(final)=13.523 | 2564.2 samples/s | 40.1 steps/s
[Step=14500 Epoch=138.2] | Loss=0.00387 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.858 | L2-Norm(final)=13.530 | 5893.7 samples/s | 92.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=14501 Epoch=138.2] | Loss=0.00042 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.858 | L2-Norm(final)=13.605 | 6275.4 samples/s | 98.1 steps/s
[Step=14550 Epoch=138.7] | Loss=0.00154 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.882 | L2-Norm(final)=13.611 | 3874.7 samples/s | 60.5 steps/s
[Step=14600 Epoch=139.2] | Loss=0.00120 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.909 | L2-Norm(final)=13.616 | 6777.9 samples/s | 105.9 steps/s
[Step=14650 Epoch=139.6] | Loss=0.00081 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.925 | L2-Norm(final)=13.620 | 2182.7 samples/s | 34.1 steps/s
[Step=14700 Epoch=140.1] | Loss=0.00061 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.930 | L2-Norm(final)=13.622 | 6141.4 samples/s | 96.0 steps/s
[Step=14750 Epoch=140.6] | Loss=0.00049 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.930 | L2-Norm(final)=13.623 | 2243.1 samples/s | 35.0 steps/s
[Step=14800 Epoch=141.1] | Loss=0.00041 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.927 | L2-Norm(final)=13.624 | 5774.5 samples/s | 90.2 steps/s
[Step=14850 Epoch=141.5] | Loss=0.00035 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.924 | L2-Norm(final)=13.625 | 2298.7 samples/s | 35.9 steps/s
[Step=14900 Epoch=142.0] | Loss=0.00031 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.919 | L2-Norm(final)=13.626 | 5324.0 samples/s | 83.2 steps/s
[Step=14950 Epoch=142.5] | Loss=0.00027 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.914 | L2-Norm(final)=13.627 | 2402.2 samples/s | 37.5 steps/s
[Step=15000 Epoch=143.0] | Loss=0.00025 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.908 | L2-Norm(final)=13.627 | 4899.5 samples/s | 76.6 steps/s
[Step=15050 Epoch=143.4] | Loss=0.00022 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.903 | L2-Norm(final)=13.628 | 2448.4 samples/s | 38.3 steps/s
[Step=15100 Epoch=143.9] | Loss=0.00021 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.897 | L2-Norm(final)=13.628 | 4703.1 samples/s | 73.5 steps/s
[Step=15150 Epoch=144.4] | Loss=0.00019 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.891 | L2-Norm(final)=13.629 | 2515.8 samples/s | 39.3 steps/s
[Step=15200 Epoch=144.9] | Loss=0.00018 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.884 | L2-Norm(final)=13.629 | 4595.4 samples/s | 71.8 steps/s
[Step=15250 Epoch=145.3] | Loss=0.00017 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.878 | L2-Norm(final)=13.630 | 2575.9 samples/s | 40.2 steps/s
[Step=15300 Epoch=145.8] | Loss=0.00016 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.872 | L2-Norm(final)=13.630 | 4633.7 samples/s | 72.4 steps/s
[Step=15350 Epoch=146.3] | Loss=0.00015 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.865 | L2-Norm(final)=13.630 | 2587.2 samples/s | 40.4 steps/s
[Step=15400 Epoch=146.8] | Loss=0.00014 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.858 | L2-Norm(final)=13.631 | 4646.1 samples/s | 72.6 steps/s
[Step=15450 Epoch=147.3] | Loss=0.00013 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.852 | L2-Norm(final)=13.631 | 2543.6 samples/s | 39.7 steps/s
[Step=15500 Epoch=147.7] | Loss=0.00012 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.845 | L2-Norm(final)=13.631 | 4606.1 samples/s | 72.0 steps/s
[Step=15550 Epoch=148.2] | Loss=0.00012 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.838 | L2-Norm(final)=13.632 | 7446.2 samples/s | 116.3 steps/s
[Step=15600 Epoch=148.7] | Loss=0.00011 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.831 | L2-Norm(final)=13.632 | 2119.6 samples/s | 33.1 steps/s
[Step=15650 Epoch=149.2] | Loss=0.00011 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.824 | L2-Norm(final)=13.633 | 6673.6 samples/s | 104.3 steps/s
[Step=15700 Epoch=149.6] | Loss=0.00010 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.818 | L2-Norm(final)=13.633 | 2167.2 samples/s | 33.9 steps/s
[Step=15750 Epoch=150.1] | Loss=0.00010 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=13.633 | 6187.7 samples/s | 96.7 steps/s
[Step=15800 Epoch=150.6] | Loss=0.00010 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.803 | L2-Norm(final)=13.634 | 2237.2 samples/s | 35.0 steps/s
[Step=15850 Epoch=151.1] | Loss=0.00009 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.796 | L2-Norm(final)=13.634 | 5779.7 samples/s | 90.3 steps/s
[Step=15900 Epoch=151.5] | Loss=0.00009 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.789 | L2-Norm(final)=13.634 | 2306.4 samples/s | 36.0 steps/s
[Step=15950 Epoch=152.0] | Loss=0.00009 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.782 | L2-Norm(final)=13.635 | 5402.0 samples/s | 84.4 steps/s
[Step=16000 Epoch=152.5] | Loss=0.00008 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.775 | L2-Norm(final)=13.635 | 2379.0 samples/s | 37.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11061 | acc=0.9563 | tpr=0.9744 | fpr=0.0833 | 5390.1 samples/s | 21.1 steps/s
Avg test loss: 0.11709, Avg test acc: 0.95376, Avg tpr: 0.97266, Avg fpr: 0.08781, total FA: 685

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10306 | acc=0.9609 | tpr=0.9776 | fpr=0.0753 | 5538.3 samples/s | 21.6 steps/s
Avg test loss: 0.10702, Avg test acc: 0.96029, Avg tpr: 0.97546, Avg fpr: 0.07307, total FA: 570

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.10462 | acc=0.9590 | tpr=0.9694 | fpr=0.0637 | 5838.6 samples/s | 22.8 steps/s
Avg test loss: 0.10788, Avg test acc: 0.95765, Avg tpr: 0.96748, Avg fpr: 0.06397, total FA: 499

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09209 | acc=0.9623 | tpr=0.9764 | fpr=0.0681 | 5588.8 samples/s | 21.8 steps/s
Avg test loss: 0.10061, Avg test acc: 0.96125, Avg tpr: 0.97581, Avg fpr: 0.07076, total FA: 552

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10138 | acc=0.9566 | tpr=0.9630 | fpr=0.0572 | 5656.6 samples/s | 22.1 steps/s
Avg test loss: 0.10954, Avg test acc: 0.95585, Avg tpr: 0.96171, Avg fpr: 0.05704, total FA: 445

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.39959 | acc=0.2907 | tpr=0.0110 | fpr=0.1018 | 5740.8 samples/s | 22.4 steps/s
Avg test loss: 5.41654, Avg test acc: 0.28852, Avg tpr: 0.01119, Avg fpr: 0.10153, total FA: 792

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.66786 | acc=0.2839 | tpr=0.0154 | fpr=0.1331 | 5860.5 samples/s | 22.9 steps/s
Avg test loss: 4.67592, Avg test acc: 0.28255, Avg tpr: 0.01562, Avg fpr: 0.13037, total FA: 1017

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.59552 | acc=0.2706 | tpr=0.0217 | fpr=0.1888 | 5684.9 samples/s | 22.2 steps/s
Avg test loss: 5.60244, Avg test acc: 0.26861, Avg tpr: 0.02250, Avg fpr: 0.19010, total FA: 1483

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.10133 | acc=0.2562 | tpr=0.0081 | fpr=0.2049 | 5683.1 samples/s | 22.2 steps/s
Avg test loss: 5.10693, Avg test acc: 0.25487, Avg tpr: 0.00816, Avg fpr: 0.20254, total FA: 1580

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.48973 | acc=0.2537 | tpr=0.0059 | fpr=0.2084 | 5681.8 samples/s | 22.2 steps/s
Avg test loss: 5.50115, Avg test acc: 0.25186, Avg tpr: 0.00589, Avg fpr: 0.20715, total FA: 1616

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.14756 | acc=0.1296 | tpr=0.3628 | fpr=0.8746 | 5598.2 samples/s | 21.9 steps/s
[Step= 100] | Loss=6.10270 | acc=0.1296 | tpr=0.3241 | fpr=0.8740 | 8227.4 samples/s | 32.1 steps/s
[Step= 150] | Loss=6.11391 | acc=0.1289 | tpr=0.3228 | fpr=0.8746 | 8157.9 samples/s | 31.9 steps/s
[Step= 200] | Loss=6.10875 | acc=0.1290 | tpr=0.3191 | fpr=0.8744 | 8200.9 samples/s | 32.0 steps/s
[Step= 250] | Loss=6.11095 | acc=0.1292 | tpr=0.3301 | fpr=0.8745 | 8002.0 samples/s | 31.3 steps/s
[Step= 300] | Loss=6.10822 | acc=0.1286 | tpr=0.3258 | fpr=0.8750 | 8240.5 samples/s | 32.2 steps/s
[Step= 350] | Loss=6.10818 | acc=0.1281 | tpr=0.3131 | fpr=0.8753 | 7922.5 samples/s | 30.9 steps/s
[Step= 400] | Loss=6.10527 | acc=0.1285 | tpr=0.3129 | fpr=0.8748 | 7844.0 samples/s | 30.6 steps/s
[Step= 450] | Loss=6.10610 | acc=0.1288 | tpr=0.3165 | fpr=0.8746 | 8268.6 samples/s | 32.3 steps/s
[Step= 500] | Loss=6.10876 | acc=0.1291 | tpr=0.3154 | fpr=0.8743 | 7976.8 samples/s | 31.2 steps/s
[Step= 550] | Loss=6.10600 | acc=0.1289 | tpr=0.3084 | fpr=0.8744 | 9795.2 samples/s | 38.3 steps/s
Avg test loss: 6.10619, Avg test acc: 0.12877, Avg tpr: 0.30824, Avg fpr: 0.87449, total FA: 121421

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.16969 | acc=0.1306 | tpr=0.2655 | fpr=0.8718 | 5825.8 samples/s | 22.8 steps/s
[Step= 100] | Loss=6.11946 | acc=0.1324 | tpr=0.2260 | fpr=0.8693 | 7916.2 samples/s | 30.9 steps/s
[Step= 150] | Loss=6.13457 | acc=0.1300 | tpr=0.2147 | fpr=0.8715 | 7988.4 samples/s | 31.2 steps/s
[Step= 200] | Loss=6.13375 | acc=0.1296 | tpr=0.2077 | fpr=0.8718 | 7898.3 samples/s | 30.9 steps/s
[Step= 250] | Loss=6.14068 | acc=0.1299 | tpr=0.2122 | fpr=0.8716 | 8562.4 samples/s | 33.4 steps/s
[Step= 300] | Loss=6.14433 | acc=0.1294 | tpr=0.2124 | fpr=0.8721 | 7837.3 samples/s | 30.6 steps/s
[Step= 350] | Loss=6.14693 | acc=0.1290 | tpr=0.1997 | fpr=0.8723 | 8560.5 samples/s | 33.4 steps/s
[Step= 400] | Loss=6.14558 | acc=0.1295 | tpr=0.2008 | fpr=0.8718 | 8020.4 samples/s | 31.3 steps/s
[Step= 450] | Loss=6.14674 | acc=0.1296 | tpr=0.1986 | fpr=0.8717 | 7998.8 samples/s | 31.2 steps/s
[Step= 500] | Loss=6.14705 | acc=0.1297 | tpr=0.2000 | fpr=0.8716 | 7634.5 samples/s | 29.8 steps/s
[Step= 550] | Loss=6.14479 | acc=0.1297 | tpr=0.1994 | fpr=0.8716 | 10082.1 samples/s | 39.4 steps/s
Avg test loss: 6.14515, Avg test acc: 0.12962, Avg tpr: 0.20008, Avg fpr: 0.87167, total FA: 121029

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.24211 | acc=0.1352 | tpr=0.1195 | fpr=0.8645 | 5776.0 samples/s | 22.6 steps/s
[Step= 100] | Loss=6.18489 | acc=0.1359 | tpr=0.1045 | fpr=0.8635 | 8273.5 samples/s | 32.3 steps/s
[Step= 150] | Loss=6.18882 | acc=0.1359 | tpr=0.1081 | fpr=0.8636 | 7452.4 samples/s | 29.1 steps/s
[Step= 200] | Loss=6.17759 | acc=0.1365 | tpr=0.1082 | fpr=0.8630 | 8152.8 samples/s | 31.8 steps/s
[Step= 250] | Loss=6.17737 | acc=0.1368 | tpr=0.1083 | fpr=0.8627 | 8748.6 samples/s | 34.2 steps/s
[Step= 300] | Loss=6.18465 | acc=0.1364 | tpr=0.1084 | fpr=0.8631 | 7898.9 samples/s | 30.9 steps/s
[Step= 350] | Loss=6.18810 | acc=0.1356 | tpr=0.1046 | fpr=0.8639 | 8188.6 samples/s | 32.0 steps/s
[Step= 400] | Loss=6.18626 | acc=0.1360 | tpr=0.1100 | fpr=0.8635 | 7501.4 samples/s | 29.3 steps/s
[Step= 450] | Loss=6.18545 | acc=0.1362 | tpr=0.1095 | fpr=0.8634 | 8251.7 samples/s | 32.2 steps/s
[Step= 500] | Loss=6.18736 | acc=0.1359 | tpr=0.1101 | fpr=0.8636 | 7899.3 samples/s | 30.9 steps/s
[Step= 550] | Loss=6.18250 | acc=0.1363 | tpr=0.1090 | fpr=0.8632 | 10206.5 samples/s | 39.9 steps/s
Avg test loss: 6.18253, Avg test acc: 0.13614, Avg tpr: 0.10935, Avg fpr: 0.86337, total FA: 119877

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.76636 | acc=0.1482 | tpr=0.2168 | fpr=0.8530 | 5883.8 samples/s | 23.0 steps/s
[Step= 100] | Loss=5.71827 | acc=0.1487 | tpr=0.1962 | fpr=0.8522 | 7405.7 samples/s | 28.9 steps/s
[Step= 150] | Loss=5.72723 | acc=0.1477 | tpr=0.1916 | fpr=0.8531 | 7728.1 samples/s | 30.2 steps/s
[Step= 200] | Loss=5.71887 | acc=0.1478 | tpr=0.1880 | fpr=0.8529 | 8410.0 samples/s | 32.9 steps/s
[Step= 250] | Loss=5.72468 | acc=0.1482 | tpr=0.1878 | fpr=0.8525 | 8117.0 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.72888 | acc=0.1476 | tpr=0.1935 | fpr=0.8532 | 8117.4 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.72889 | acc=0.1471 | tpr=0.1822 | fpr=0.8535 | 7295.5 samples/s | 28.5 steps/s
[Step= 400] | Loss=5.72599 | acc=0.1475 | tpr=0.1876 | fpr=0.8532 | 9015.8 samples/s | 35.2 steps/s
[Step= 450] | Loss=5.72684 | acc=0.1477 | tpr=0.1860 | fpr=0.8530 | 8172.7 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.73060 | acc=0.1477 | tpr=0.1855 | fpr=0.8530 | 7379.8 samples/s | 28.8 steps/s
[Step= 550] | Loss=5.72749 | acc=0.1479 | tpr=0.1854 | fpr=0.8528 | 11381.8 samples/s | 44.5 steps/s
Avg test loss: 5.72647, Avg test acc: 0.14786, Avg tpr: 0.18621, Avg fpr: 0.85284, total FA: 118415

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.47960 | acc=0.1537 | tpr=0.1681 | fpr=0.8465 | 5763.1 samples/s | 22.5 steps/s
[Step= 100] | Loss=6.40948 | acc=0.1541 | tpr=0.1471 | fpr=0.8458 | 8008.8 samples/s | 31.3 steps/s
[Step= 150] | Loss=6.42465 | acc=0.1539 | tpr=0.1412 | fpr=0.8458 | 7673.4 samples/s | 30.0 steps/s
[Step= 200] | Loss=6.41741 | acc=0.1547 | tpr=0.1333 | fpr=0.8449 | 8282.4 samples/s | 32.4 steps/s
[Step= 250] | Loss=6.42812 | acc=0.1545 | tpr=0.1328 | fpr=0.8451 | 8070.6 samples/s | 31.5 steps/s
[Step= 300] | Loss=6.42826 | acc=0.1544 | tpr=0.1295 | fpr=0.8452 | 8045.6 samples/s | 31.4 steps/s
[Step= 350] | Loss=6.43143 | acc=0.1544 | tpr=0.1234 | fpr=0.8451 | 7714.5 samples/s | 30.1 steps/s
[Step= 400] | Loss=6.43097 | acc=0.1549 | tpr=0.1236 | fpr=0.8446 | 8448.3 samples/s | 33.0 steps/s
[Step= 450] | Loss=6.42944 | acc=0.1548 | tpr=0.1227 | fpr=0.8446 | 7812.7 samples/s | 30.5 steps/s
[Step= 500] | Loss=6.43228 | acc=0.1547 | tpr=0.1229 | fpr=0.8447 | 8190.9 samples/s | 32.0 steps/s
[Step= 550] | Loss=6.42814 | acc=0.1547 | tpr=0.1234 | fpr=0.8447 | 10211.2 samples/s | 39.9 steps/s
Avg test loss: 6.42738, Avg test acc: 0.15462, Avg tpr: 0.12401, Avg fpr: 0.84482, total FA: 117302

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10221 | acc=0.9810 | tpr=0.8894 | fpr=0.0173 | 5798.9 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.10480 | acc=0.9816 | tpr=0.9168 | fpr=0.0172 | 7868.9 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.10855 | acc=0.9806 | tpr=0.9179 | fpr=0.0182 | 7782.1 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.10978 | acc=0.9806 | tpr=0.9246 | fpr=0.0184 | 7484.3 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.11022 | acc=0.9805 | tpr=0.9170 | fpr=0.0184 | 8109.5 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.11192 | acc=0.9803 | tpr=0.9164 | fpr=0.0185 | 8110.6 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.11216 | acc=0.9804 | tpr=0.9192 | fpr=0.0185 | 8151.1 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.11289 | acc=0.9802 | tpr=0.9174 | fpr=0.0186 | 8383.3 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.11518 | acc=0.9799 | tpr=0.9158 | fpr=0.0189 | 7849.6 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.11418 | acc=0.9800 | tpr=0.9176 | fpr=0.0188 | 8150.3 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.11339 | acc=0.9801 | tpr=0.9192 | fpr=0.0188 | 11080.8 samples/s | 43.3 steps/s
Avg test loss: 0.11320, Avg test acc: 0.98014, Avg tpr: 0.91878, Avg fpr: 0.01874, total FA: 2602

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10860 | acc=0.9806 | tpr=0.8982 | fpr=0.0179 | 5715.5 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.11089 | acc=0.9807 | tpr=0.9254 | fpr=0.0183 | 7884.3 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.11510 | acc=0.9801 | tpr=0.9308 | fpr=0.0190 | 8126.7 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.11719 | acc=0.9800 | tpr=0.9344 | fpr=0.0191 | 8407.8 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.11769 | acc=0.9799 | tpr=0.9310 | fpr=0.0192 | 8105.1 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.11940 | acc=0.9797 | tpr=0.9309 | fpr=0.0194 | 7633.4 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.11970 | acc=0.9795 | tpr=0.9311 | fpr=0.0196 | 8008.3 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.12077 | acc=0.9794 | tpr=0.9267 | fpr=0.0197 | 8135.3 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.12283 | acc=0.9791 | tpr=0.9250 | fpr=0.0199 | 7754.9 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.12201 | acc=0.9792 | tpr=0.9273 | fpr=0.0199 | 7964.4 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.12109 | acc=0.9793 | tpr=0.9260 | fpr=0.0198 | 11254.8 samples/s | 44.0 steps/s
Avg test loss: 0.12086, Avg test acc: 0.97927, Avg tpr: 0.92591, Avg fpr: 0.01976, total FA: 2743

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11473 | acc=0.9771 | tpr=0.9513 | fpr=0.0224 | 5541.6 samples/s | 21.6 steps/s
[Step= 100] | Loss=0.11976 | acc=0.9767 | tpr=0.9616 | fpr=0.0230 | 8463.0 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.12481 | acc=0.9755 | tpr=0.9625 | fpr=0.0242 | 7910.8 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.12683 | acc=0.9755 | tpr=0.9596 | fpr=0.0242 | 8060.2 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.12771 | acc=0.9752 | tpr=0.9520 | fpr=0.0243 | 7599.7 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.12935 | acc=0.9750 | tpr=0.9484 | fpr=0.0245 | 8731.7 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.12963 | acc=0.9749 | tpr=0.9493 | fpr=0.0247 | 8315.6 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.13128 | acc=0.9746 | tpr=0.9475 | fpr=0.0249 | 8427.4 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.13291 | acc=0.9744 | tpr=0.9474 | fpr=0.0251 | 7727.1 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.13221 | acc=0.9744 | tpr=0.9489 | fpr=0.0251 | 8308.7 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.13117 | acc=0.9746 | tpr=0.9479 | fpr=0.0249 | 9540.2 samples/s | 37.3 steps/s
Avg test loss: 0.13083, Avg test acc: 0.97467, Avg tpr: 0.94770, Avg fpr: 0.02484, total FA: 3449

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10284 | acc=0.9811 | tpr=0.9248 | fpr=0.0179 | 5519.0 samples/s | 21.6 steps/s
[Step= 100] | Loss=0.10562 | acc=0.9805 | tpr=0.9254 | fpr=0.0184 | 7821.5 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.10967 | acc=0.9804 | tpr=0.9308 | fpr=0.0186 | 8811.0 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.11144 | acc=0.9804 | tpr=0.9311 | fpr=0.0187 | 7882.0 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.11127 | acc=0.9804 | tpr=0.9258 | fpr=0.0186 | 8231.6 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.11288 | acc=0.9802 | tpr=0.9215 | fpr=0.0187 | 7455.3 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.11267 | acc=0.9802 | tpr=0.9236 | fpr=0.0187 | 8253.2 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.11345 | acc=0.9802 | tpr=0.9207 | fpr=0.0187 | 8302.4 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.11556 | acc=0.9799 | tpr=0.9187 | fpr=0.0190 | 7968.8 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.11487 | acc=0.9800 | tpr=0.9211 | fpr=0.0189 | 7327.0 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.11427 | acc=0.9801 | tpr=0.9212 | fpr=0.0189 | 11639.7 samples/s | 45.5 steps/s
Avg test loss: 0.11403, Avg test acc: 0.98009, Avg tpr: 0.92116, Avg fpr: 0.01884, total FA: 2616

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10148 | acc=0.9818 | tpr=0.9204 | fpr=0.0171 | 5834.9 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.10351 | acc=0.9819 | tpr=0.9339 | fpr=0.0172 | 7228.5 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.10769 | acc=0.9811 | tpr=0.9366 | fpr=0.0181 | 8307.9 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.10935 | acc=0.9810 | tpr=0.9399 | fpr=0.0183 | 8499.3 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.10967 | acc=0.9809 | tpr=0.9371 | fpr=0.0183 | 8044.4 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.11118 | acc=0.9807 | tpr=0.9338 | fpr=0.0185 | 7601.4 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.11132 | acc=0.9807 | tpr=0.9374 | fpr=0.0185 | 8298.5 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.11245 | acc=0.9805 | tpr=0.9338 | fpr=0.0186 | 8504.0 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.11469 | acc=0.9802 | tpr=0.9318 | fpr=0.0189 | 8296.1 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.11368 | acc=0.9804 | tpr=0.9330 | fpr=0.0187 | 7292.7 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.11316 | acc=0.9805 | tpr=0.9316 | fpr=0.0186 | 11139.7 samples/s | 43.5 steps/s
Avg test loss: 0.11298, Avg test acc: 0.98051, Avg tpr: 0.93106, Avg fpr: 0.01859, total FA: 2581

server round 24/50

clients selected: [0 4 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=14001 Epoch=68.3] | Loss=0.00254 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.813 | L2-Norm(final)=12.645 | 5619.8 samples/s | 87.8 steps/s
[Step=14050 Epoch=68.5] | Loss=0.02025 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.813 | L2-Norm(final)=12.646 | 5135.7 samples/s | 80.2 steps/s
[Step=14100 Epoch=68.8] | Loss=0.02264 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.814 | L2-Norm(final)=12.645 | 5638.6 samples/s | 88.1 steps/s
[Step=14150 Epoch=69.0] | Loss=0.02294 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.814 | L2-Norm(final)=12.641 | 5747.5 samples/s | 89.8 steps/s
[Step=14200 Epoch=69.2] | Loss=0.02221 | Reg=0.00117 | acc=0.9688 | L2-Norm=10.814 | L2-Norm(final)=12.639 | 8645.5 samples/s | 135.1 steps/s
[Step=14250 Epoch=69.5] | Loss=0.02216 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.814 | L2-Norm(final)=12.638 | 2477.4 samples/s | 38.7 steps/s
[Step=14300 Epoch=69.7] | Loss=0.02197 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.814 | L2-Norm(final)=12.639 | 5755.2 samples/s | 89.9 steps/s
[Step=14350 Epoch=70.0] | Loss=0.02178 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.814 | L2-Norm(final)=12.640 | 5360.0 samples/s | 83.8 steps/s
[Step=14400 Epoch=70.2] | Loss=0.02152 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.814 | L2-Norm(final)=12.641 | 7816.8 samples/s | 122.1 steps/s
[Step=14450 Epoch=70.5] | Loss=0.02214 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.814 | L2-Norm(final)=12.642 | 2519.2 samples/s | 39.4 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02201 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.814 | L2-Norm(final)=12.643 | 5637.1 samples/s | 88.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=14501 Epoch=70.7] | Loss=0.01046 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.814 | L2-Norm(final)=12.653 | 6541.4 samples/s | 102.2 steps/s
[Step=14550 Epoch=70.9] | Loss=0.02433 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.844 | L2-Norm(final)=12.648 | 4028.3 samples/s | 62.9 steps/s
[Step=14600 Epoch=71.2] | Loss=0.02375 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=12.647 | 4867.9 samples/s | 76.1 steps/s
[Step=14650 Epoch=71.4] | Loss=0.02233 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.908 | L2-Norm(final)=12.649 | 4892.3 samples/s | 76.4 steps/s
[Step=14700 Epoch=71.7] | Loss=0.02179 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.929 | L2-Norm(final)=12.651 | 6893.1 samples/s | 107.7 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01964 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.947 | L2-Norm(final)=12.653 | 2264.6 samples/s | 35.4 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01779 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.963 | L2-Norm(final)=12.657 | 4830.4 samples/s | 75.5 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01638 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.976 | L2-Norm(final)=12.660 | 4903.7 samples/s | 76.6 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01503 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.987 | L2-Norm(final)=12.663 | 6267.3 samples/s | 97.9 steps/s
[Step=14950 Epoch=72.9] | Loss=0.01399 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.997 | L2-Norm(final)=12.667 | 2343.5 samples/s | 36.6 steps/s
[Step=15000 Epoch=73.1] | Loss=0.01314 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.007 | L2-Norm(final)=12.670 | 4838.1 samples/s | 75.6 steps/s
[Step=15050 Epoch=73.4] | Loss=0.01247 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.015 | L2-Norm(final)=12.673 | 4937.4 samples/s | 77.1 steps/s
[Step=15100 Epoch=73.6] | Loss=0.01183 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.022 | L2-Norm(final)=12.676 | 5728.4 samples/s | 89.5 steps/s
[Step=15150 Epoch=73.9] | Loss=0.01140 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.030 | L2-Norm(final)=12.680 | 2437.8 samples/s | 38.1 steps/s
[Step=15200 Epoch=74.1] | Loss=0.01098 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.037 | L2-Norm(final)=12.682 | 4855.2 samples/s | 75.9 steps/s
[Step=15250 Epoch=74.4] | Loss=0.01049 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.043 | L2-Norm(final)=12.685 | 4921.6 samples/s | 76.9 steps/s
[Step=15300 Epoch=74.6] | Loss=0.01027 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.049 | L2-Norm(final)=12.688 | 5326.7 samples/s | 83.2 steps/s
[Step=15350 Epoch=74.8] | Loss=0.00990 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.054 | L2-Norm(final)=12.691 | 2498.2 samples/s | 39.0 steps/s
[Step=15400 Epoch=75.1] | Loss=0.00965 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.060 | L2-Norm(final)=12.693 | 4841.2 samples/s | 75.6 steps/s
[Step=15450 Epoch=75.3] | Loss=0.00941 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.064 | L2-Norm(final)=12.695 | 4849.4 samples/s | 75.8 steps/s
[Step=15500 Epoch=75.6] | Loss=0.00918 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.069 | L2-Norm(final)=12.698 | 4986.9 samples/s | 77.9 steps/s
[Step=15550 Epoch=75.8] | Loss=0.00891 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.073 | L2-Norm(final)=12.700 | 2595.5 samples/s | 40.6 steps/s
[Step=15600 Epoch=76.1] | Loss=0.00858 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.077 | L2-Norm(final)=12.702 | 4848.3 samples/s | 75.8 steps/s
[Step=15650 Epoch=76.3] | Loss=0.00832 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.081 | L2-Norm(final)=12.704 | 4900.0 samples/s | 76.6 steps/s
[Step=15700 Epoch=76.6] | Loss=0.00825 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.085 | L2-Norm(final)=12.707 | 4829.9 samples/s | 75.5 steps/s
[Step=15750 Epoch=76.8] | Loss=0.00809 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.089 | L2-Norm(final)=12.709 | 2643.9 samples/s | 41.3 steps/s
[Step=15800 Epoch=77.0] | Loss=0.00794 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.092 | L2-Norm(final)=12.711 | 4982.5 samples/s | 77.9 steps/s
[Step=15850 Epoch=77.3] | Loss=0.00779 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.096 | L2-Norm(final)=12.713 | 4726.3 samples/s | 73.8 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00765 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.099 | L2-Norm(final)=12.715 | 4874.8 samples/s | 76.2 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00749 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=12.717 | 2676.9 samples/s | 41.8 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00736 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=12.719 | 4771.6 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step16000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=32001 Epoch=156.9] | Loss=0.06627 | Reg=0.00117 | acc=0.9531 | L2-Norm=10.813 | L2-Norm(final)=15.025 | 5393.5 samples/s | 84.3 steps/s
[Step=32050 Epoch=157.2] | Loss=0.02326 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.814 | L2-Norm(final)=15.013 | 5283.2 samples/s | 82.6 steps/s
[Step=32100 Epoch=157.4] | Loss=0.02367 | Reg=0.00117 | acc=0.9688 | L2-Norm=10.814 | L2-Norm(final)=15.008 | 5761.2 samples/s | 90.0 steps/s
[Step=32150 Epoch=157.7] | Loss=0.02458 | Reg=0.00117 | acc=0.9375 | L2-Norm=10.814 | L2-Norm(final)=15.003 | 5340.0 samples/s | 83.4 steps/s
[Step=32200 Epoch=157.9] | Loss=0.02553 | Reg=0.00117 | acc=0.9688 | L2-Norm=10.814 | L2-Norm(final)=14.998 | 9062.7 samples/s | 141.6 steps/s
[Step=32250 Epoch=158.1] | Loss=0.02639 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.814 | L2-Norm(final)=14.991 | 2401.5 samples/s | 37.5 steps/s
[Step=32300 Epoch=158.4] | Loss=0.02637 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.814 | L2-Norm(final)=14.984 | 5643.2 samples/s | 88.2 steps/s
[Step=32350 Epoch=158.6] | Loss=0.02593 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.814 | L2-Norm(final)=14.978 | 5634.7 samples/s | 88.0 steps/s
[Step=32400 Epoch=158.9] | Loss=0.02512 | Reg=0.00117 | acc=0.9688 | L2-Norm=10.814 | L2-Norm(final)=14.973 | 8223.2 samples/s | 128.5 steps/s
[Step=32450 Epoch=159.1] | Loss=0.02520 | Reg=0.00117 | acc=0.9531 | L2-Norm=10.814 | L2-Norm(final)=14.969 | 2448.2 samples/s | 38.3 steps/s
[Step=32500 Epoch=159.4] | Loss=0.02565 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.814 | L2-Norm(final)=14.965 | 5763.4 samples/s | 90.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=32501 Epoch=159.4] | Loss=0.01378 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.814 | L2-Norm(final)=14.923 | 5557.3 samples/s | 86.8 steps/s
[Step=32550 Epoch=159.6] | Loss=0.03463 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.852 | L2-Norm(final)=14.916 | 4529.8 samples/s | 70.8 steps/s
[Step=32600 Epoch=159.9] | Loss=0.03159 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.894 | L2-Norm(final)=14.904 | 4820.7 samples/s | 75.3 steps/s
[Step=32650 Epoch=160.1] | Loss=0.02774 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.923 | L2-Norm(final)=14.901 | 4857.6 samples/s | 75.9 steps/s
[Step=32700 Epoch=160.4] | Loss=0.02459 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.947 | L2-Norm(final)=14.902 | 7104.6 samples/s | 111.0 steps/s
[Step=32750 Epoch=160.6] | Loss=0.02182 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.964 | L2-Norm(final)=14.903 | 2255.8 samples/s | 35.2 steps/s
[Step=32800 Epoch=160.8] | Loss=0.01960 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.980 | L2-Norm(final)=14.906 | 4905.1 samples/s | 76.6 steps/s
[Step=32850 Epoch=161.1] | Loss=0.01825 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.993 | L2-Norm(final)=14.908 | 4855.0 samples/s | 75.9 steps/s
[Step=32900 Epoch=161.3] | Loss=0.01687 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.004 | L2-Norm(final)=14.910 | 6630.3 samples/s | 103.6 steps/s
[Step=32950 Epoch=161.6] | Loss=0.01556 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.013 | L2-Norm(final)=14.913 | 2284.5 samples/s | 35.7 steps/s
[Step=33000 Epoch=161.8] | Loss=0.01432 | Reg=0.00121 | acc=0.9688 | L2-Norm=11.022 | L2-Norm(final)=14.916 | 4822.9 samples/s | 75.4 steps/s
[Step=33050 Epoch=162.1] | Loss=0.01372 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.029 | L2-Norm(final)=14.919 | 4845.7 samples/s | 75.7 steps/s
[Step=33100 Epoch=162.3] | Loss=0.01286 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.036 | L2-Norm(final)=14.921 | 6310.0 samples/s | 98.6 steps/s
[Step=33150 Epoch=162.6] | Loss=0.01221 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.042 | L2-Norm(final)=14.924 | 2332.6 samples/s | 36.4 steps/s
[Step=33200 Epoch=162.8] | Loss=0.01148 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.047 | L2-Norm(final)=14.926 | 4865.7 samples/s | 76.0 steps/s
[Step=33250 Epoch=163.1] | Loss=0.01094 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.052 | L2-Norm(final)=14.928 | 4877.6 samples/s | 76.2 steps/s
[Step=33300 Epoch=163.3] | Loss=0.01062 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.056 | L2-Norm(final)=14.930 | 5887.9 samples/s | 92.0 steps/s
[Step=33350 Epoch=163.5] | Loss=0.01027 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.060 | L2-Norm(final)=14.932 | 2389.7 samples/s | 37.3 steps/s
[Step=33400 Epoch=163.8] | Loss=0.00984 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.064 | L2-Norm(final)=14.934 | 4870.5 samples/s | 76.1 steps/s
[Step=33450 Epoch=164.0] | Loss=0.00953 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.067 | L2-Norm(final)=14.936 | 4914.6 samples/s | 76.8 steps/s
[Step=33500 Epoch=164.3] | Loss=0.00920 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.070 | L2-Norm(final)=14.938 | 5543.2 samples/s | 86.6 steps/s
[Step=33550 Epoch=164.5] | Loss=0.00891 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.073 | L2-Norm(final)=14.939 | 2440.5 samples/s | 38.1 steps/s
[Step=33600 Epoch=164.8] | Loss=0.00867 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.076 | L2-Norm(final)=14.941 | 4886.5 samples/s | 76.4 steps/s
[Step=33650 Epoch=165.0] | Loss=0.00846 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.079 | L2-Norm(final)=14.943 | 4829.9 samples/s | 75.5 steps/s
[Step=33700 Epoch=165.3] | Loss=0.00825 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.081 | L2-Norm(final)=14.945 | 5350.3 samples/s | 83.6 steps/s
[Step=33750 Epoch=165.5] | Loss=0.00804 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.084 | L2-Norm(final)=14.946 | 2480.0 samples/s | 38.7 steps/s
[Step=33800 Epoch=165.7] | Loss=0.00780 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.086 | L2-Norm(final)=14.948 | 4834.1 samples/s | 75.5 steps/s
[Step=33850 Epoch=166.0] | Loss=0.00762 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=14.950 | 4906.6 samples/s | 76.7 steps/s
[Step=33900 Epoch=166.2] | Loss=0.00750 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.090 | L2-Norm(final)=14.951 | 5040.7 samples/s | 78.8 steps/s
[Step=33950 Epoch=166.5] | Loss=0.00734 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.092 | L2-Norm(final)=14.953 | 2572.2 samples/s | 40.2 steps/s
[Step=34000 Epoch=166.7] | Loss=0.00718 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.094 | L2-Norm(final)=14.954 | 4830.1 samples/s | 75.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step34000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=229.2] | Loss=0.00009 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.813 | L2-Norm(final)=15.863 | 5920.3 samples/s | 92.5 steps/s
[Step=24050 Epoch=229.7] | Loss=0.00044 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=15.872 | 4475.7 samples/s | 69.9 steps/s
[Step=24100 Epoch=230.1] | Loss=0.00072 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=15.886 | 8516.6 samples/s | 133.1 steps/s
[Step=24150 Epoch=230.6] | Loss=0.00062 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=15.898 | 2343.3 samples/s | 36.6 steps/s
[Step=24200 Epoch=231.1] | Loss=0.00066 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=15.909 | 7602.0 samples/s | 118.8 steps/s
[Step=24250 Epoch=231.6] | Loss=0.00063 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=15.921 | 2383.2 samples/s | 37.2 steps/s
[Step=24300 Epoch=232.1] | Loss=0.00067 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=15.931 | 6986.8 samples/s | 109.2 steps/s
[Step=24350 Epoch=232.5] | Loss=0.00066 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=15.942 | 2465.5 samples/s | 38.5 steps/s
[Step=24400 Epoch=233.0] | Loss=0.00068 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.811 | L2-Norm(final)=15.953 | 6411.2 samples/s | 100.2 steps/s
[Step=24450 Epoch=233.5] | Loss=0.00064 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=15.964 | 2612.5 samples/s | 40.8 steps/s
[Step=24500 Epoch=234.0] | Loss=0.00067 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=15.974 | 5711.1 samples/s | 89.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=234.0] | Loss=0.00018 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=16.076 | 5912.7 samples/s | 92.4 steps/s
[Step=24550 Epoch=234.4] | Loss=0.00041 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.814 | L2-Norm(final)=16.083 | 4050.6 samples/s | 63.3 steps/s
[Step=24600 Epoch=234.9] | Loss=0.00028 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.835 | L2-Norm(final)=16.087 | 6793.2 samples/s | 106.1 steps/s
[Step=24650 Epoch=235.4] | Loss=0.00019 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.840 | L2-Norm(final)=16.090 | 2182.8 samples/s | 34.1 steps/s
[Step=24700 Epoch=235.9] | Loss=0.00014 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.837 | L2-Norm(final)=16.091 | 6246.7 samples/s | 97.6 steps/s
[Step=24750 Epoch=236.3] | Loss=0.00012 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.832 | L2-Norm(final)=16.093 | 2266.4 samples/s | 35.4 steps/s
[Step=24800 Epoch=236.8] | Loss=0.00010 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.825 | L2-Norm(final)=16.094 | 5822.1 samples/s | 91.0 steps/s
[Step=24850 Epoch=237.3] | Loss=0.00008 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.817 | L2-Norm(final)=16.095 | 2310.0 samples/s | 36.1 steps/s
[Step=24900 Epoch=237.8] | Loss=0.00007 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.809 | L2-Norm(final)=16.096 | 5413.5 samples/s | 84.6 steps/s
[Step=24950 Epoch=238.3] | Loss=0.00006 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.800 | L2-Norm(final)=16.097 | 2378.5 samples/s | 37.2 steps/s
[Step=25000 Epoch=238.7] | Loss=0.00006 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.791 | L2-Norm(final)=16.097 | 4993.5 samples/s | 78.0 steps/s
[Step=25050 Epoch=239.2] | Loss=0.00005 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.783 | L2-Norm(final)=16.098 | 2439.3 samples/s | 38.1 steps/s
[Step=25100 Epoch=239.7] | Loss=0.00005 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.774 | L2-Norm(final)=16.099 | 4731.7 samples/s | 73.9 steps/s
[Step=25150 Epoch=240.2] | Loss=0.00005 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.765 | L2-Norm(final)=16.099 | 2540.9 samples/s | 39.7 steps/s
[Step=25200 Epoch=240.6] | Loss=0.00004 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.756 | L2-Norm(final)=16.100 | 4637.6 samples/s | 72.5 steps/s
[Step=25250 Epoch=241.1] | Loss=0.00004 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.747 | L2-Norm(final)=16.101 | 2557.4 samples/s | 40.0 steps/s
[Step=25300 Epoch=241.6] | Loss=0.00004 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.738 | L2-Norm(final)=16.101 | 4588.6 samples/s | 71.7 steps/s
[Step=25350 Epoch=242.1] | Loss=0.00003 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=16.102 | 2587.8 samples/s | 40.4 steps/s
[Step=25400 Epoch=242.6] | Loss=0.00003 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.721 | L2-Norm(final)=16.102 | 4643.8 samples/s | 72.6 steps/s
[Step=25450 Epoch=243.0] | Loss=0.00003 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.712 | L2-Norm(final)=16.103 | 2549.3 samples/s | 39.8 steps/s
[Step=25500 Epoch=243.5] | Loss=0.00003 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.703 | L2-Norm(final)=16.103 | 4680.7 samples/s | 73.1 steps/s
[Step=25550 Epoch=244.0] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.693 | L2-Norm(final)=16.104 | 7386.2 samples/s | 115.4 steps/s
[Step=25600 Epoch=244.5] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.684 | L2-Norm(final)=16.105 | 2108.8 samples/s | 33.0 steps/s
[Step=25650 Epoch=244.9] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.675 | L2-Norm(final)=16.105 | 6771.6 samples/s | 105.8 steps/s
[Step=25700 Epoch=245.4] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.666 | L2-Norm(final)=16.106 | 2193.9 samples/s | 34.3 steps/s
[Step=25750 Epoch=245.9] | Loss=0.00002 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.657 | L2-Norm(final)=16.106 | 6251.6 samples/s | 97.7 steps/s
[Step=25800 Epoch=246.4] | Loss=0.00002 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.648 | L2-Norm(final)=16.106 | 2250.7 samples/s | 35.2 steps/s
[Step=25850 Epoch=246.9] | Loss=0.00002 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.638 | L2-Norm(final)=16.107 | 5788.7 samples/s | 90.4 steps/s
[Step=25900 Epoch=247.3] | Loss=0.00002 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=16.107 | 2313.7 samples/s | 36.2 steps/s
[Step=25950 Epoch=247.8] | Loss=0.00002 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.620 | L2-Norm(final)=16.108 | 5235.8 samples/s | 81.8 steps/s
[Step=26000 Epoch=248.3] | Loss=0.00002 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.610 | L2-Norm(final)=16.108 | 2392.2 samples/s | 37.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step26000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=18001 Epoch=169.6] | Loss=0.00092 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.813 | L2-Norm(final)=13.696 | 5471.1 samples/s | 85.5 steps/s
[Step=18050 Epoch=170.1] | Loss=0.00118 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=13.710 | 4702.6 samples/s | 73.5 steps/s
[Step=18100 Epoch=170.6] | Loss=0.00201 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=13.734 | 8252.6 samples/s | 128.9 steps/s
[Step=18150 Epoch=171.0] | Loss=0.00192 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=13.759 | 2345.0 samples/s | 36.6 steps/s
[Step=18200 Epoch=171.5] | Loss=0.00201 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=13.782 | 7151.4 samples/s | 111.7 steps/s
[Step=18250 Epoch=172.0] | Loss=0.00195 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=13.803 | 2475.3 samples/s | 38.7 steps/s
[Step=18300 Epoch=172.4] | Loss=0.00189 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=13.823 | 6220.3 samples/s | 97.2 steps/s
[Step=18350 Epoch=172.9] | Loss=0.00191 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=13.842 | 2582.1 samples/s | 40.3 steps/s
[Step=18400 Epoch=173.4] | Loss=0.00192 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=13.860 | 5606.0 samples/s | 87.6 steps/s
[Step=18450 Epoch=173.9] | Loss=0.00191 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=13.877 | 2678.1 samples/s | 41.8 steps/s
[Step=18500 Epoch=174.3] | Loss=0.00192 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=13.895 | 5341.2 samples/s | 83.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=174.3] | Loss=0.00190 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=14.066 | 5793.3 samples/s | 90.5 steps/s
[Step=18550 Epoch=174.8] | Loss=0.00136 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.863 | L2-Norm(final)=14.072 | 4059.4 samples/s | 63.4 steps/s
[Step=18600 Epoch=175.3] | Loss=0.00142 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.903 | L2-Norm(final)=14.077 | 6592.2 samples/s | 103.0 steps/s
[Step=18650 Epoch=175.7] | Loss=0.00131 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.929 | L2-Norm(final)=14.078 | 2214.4 samples/s | 34.6 steps/s
[Step=18700 Epoch=176.2] | Loss=0.00104 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.943 | L2-Norm(final)=14.079 | 5893.8 samples/s | 92.1 steps/s
[Step=18750 Epoch=176.7] | Loss=0.00083 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.951 | L2-Norm(final)=14.081 | 2329.0 samples/s | 36.4 steps/s
[Step=18800 Epoch=177.1] | Loss=0.00070 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=14.082 | 5204.1 samples/s | 81.3 steps/s
[Step=18850 Epoch=177.6] | Loss=0.00060 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=14.083 | 2412.5 samples/s | 37.7 steps/s
[Step=18900 Epoch=178.1] | Loss=0.00052 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=14.083 | 4761.9 samples/s | 74.4 steps/s
[Step=18950 Epoch=178.6] | Loss=0.00047 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.949 | L2-Norm(final)=14.084 | 2488.3 samples/s | 38.9 steps/s
[Step=19000 Epoch=179.0] | Loss=0.00042 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=14.084 | 4657.1 samples/s | 72.8 steps/s
[Step=19050 Epoch=179.5] | Loss=0.00038 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.941 | L2-Norm(final)=14.085 | 2556.3 samples/s | 39.9 steps/s
[Step=19100 Epoch=180.0] | Loss=0.00035 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.936 | L2-Norm(final)=14.085 | 4749.3 samples/s | 74.2 steps/s
[Step=19150 Epoch=180.4] | Loss=0.00032 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.931 | L2-Norm(final)=14.086 | 2539.8 samples/s | 39.7 steps/s
[Step=19200 Epoch=180.9] | Loss=0.00030 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.926 | L2-Norm(final)=14.086 | 4594.6 samples/s | 71.8 steps/s
[Step=19250 Epoch=181.4] | Loss=0.00028 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.920 | L2-Norm(final)=14.086 | 2798.7 samples/s | 43.7 steps/s
[Step=19300 Epoch=181.9] | Loss=0.00026 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.915 | L2-Norm(final)=14.087 | 4133.3 samples/s | 64.6 steps/s
[Step=19350 Epoch=182.3] | Loss=0.00025 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.909 | L2-Norm(final)=14.087 | 6573.2 samples/s | 102.7 steps/s
[Step=19400 Epoch=182.8] | Loss=0.00023 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.903 | L2-Norm(final)=14.087 | 2180.3 samples/s | 34.1 steps/s
[Step=19450 Epoch=183.3] | Loss=0.00022 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.897 | L2-Norm(final)=14.087 | 5991.7 samples/s | 93.6 steps/s
[Step=19500 Epoch=183.7] | Loss=0.00021 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.891 | L2-Norm(final)=14.088 | 2295.4 samples/s | 35.9 steps/s
[Step=19550 Epoch=184.2] | Loss=0.00020 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.885 | L2-Norm(final)=14.088 | 5369.6 samples/s | 83.9 steps/s
[Step=19600 Epoch=184.7] | Loss=0.00019 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.879 | L2-Norm(final)=14.088 | 2409.6 samples/s | 37.6 steps/s
[Step=19650 Epoch=185.2] | Loss=0.00018 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.873 | L2-Norm(final)=14.089 | 4875.7 samples/s | 76.2 steps/s
[Step=19700 Epoch=185.6] | Loss=0.00018 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.866 | L2-Norm(final)=14.089 | 2480.0 samples/s | 38.8 steps/s
[Step=19750 Epoch=186.1] | Loss=0.00017 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.860 | L2-Norm(final)=14.089 | 4547.5 samples/s | 71.1 steps/s
[Step=19800 Epoch=186.6] | Loss=0.00016 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.854 | L2-Norm(final)=14.089 | 2567.1 samples/s | 40.1 steps/s
[Step=19850 Epoch=187.0] | Loss=0.00016 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.847 | L2-Norm(final)=14.089 | 4622.1 samples/s | 72.2 steps/s
[Step=19900 Epoch=187.5] | Loss=0.00015 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=14.090 | 2579.1 samples/s | 40.3 steps/s
[Step=19950 Epoch=188.0] | Loss=0.00015 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=14.090 | 4620.8 samples/s | 72.2 steps/s
[Step=20000 Epoch=188.5] | Loss=0.00014 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.828 | L2-Norm(final)=14.090 | 2692.5 samples/s | 42.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step20000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=16001 Epoch=152.5] | Loss=0.00255 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.813 | L2-Norm(final)=13.645 | 5767.6 samples/s | 90.1 steps/s
[Step=16050 Epoch=153.0] | Loss=0.00378 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=13.652 | 4379.9 samples/s | 68.4 steps/s
[Step=16100 Epoch=153.4] | Loss=0.00368 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=13.656 | 8432.6 samples/s | 131.8 steps/s
[Step=16150 Epoch=153.9] | Loss=0.00329 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.810 | L2-Norm(final)=13.663 | 2314.6 samples/s | 36.2 steps/s
[Step=16200 Epoch=154.4] | Loss=0.00366 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=13.672 | 7670.9 samples/s | 119.9 steps/s
[Step=16250 Epoch=154.9] | Loss=0.00383 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=13.680 | 2423.2 samples/s | 37.9 steps/s
[Step=16300 Epoch=155.4] | Loss=0.00366 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=13.688 | 6923.8 samples/s | 108.2 steps/s
[Step=16350 Epoch=155.8] | Loss=0.00346 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.810 | L2-Norm(final)=13.697 | 2470.1 samples/s | 38.6 steps/s
[Step=16400 Epoch=156.3] | Loss=0.00362 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=13.707 | 6316.5 samples/s | 98.7 steps/s
[Step=16450 Epoch=156.8] | Loss=0.00348 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=13.717 | 2563.4 samples/s | 40.1 steps/s
[Step=16500 Epoch=157.3] | Loss=0.00352 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=13.726 | 5880.9 samples/s | 91.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=16501 Epoch=157.3] | Loss=0.00152 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=13.829 | 5623.2 samples/s | 87.9 steps/s
[Step=16550 Epoch=157.7] | Loss=0.00405 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.869 | L2-Norm(final)=13.838 | 4184.7 samples/s | 65.4 steps/s
[Step=16600 Epoch=158.2] | Loss=0.00281 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=13.832 | 6661.0 samples/s | 104.1 steps/s
[Step=16650 Epoch=158.7] | Loss=0.00194 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.964 | L2-Norm(final)=13.831 | 2200.2 samples/s | 34.4 steps/s
[Step=16700 Epoch=159.2] | Loss=0.00147 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.979 | L2-Norm(final)=13.831 | 6130.0 samples/s | 95.8 steps/s
[Step=16750 Epoch=159.6] | Loss=0.00118 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.985 | L2-Norm(final)=13.832 | 2252.6 samples/s | 35.2 steps/s
[Step=16800 Epoch=160.1] | Loss=0.00099 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.988 | L2-Norm(final)=13.833 | 5784.9 samples/s | 90.4 steps/s
[Step=16850 Epoch=160.6] | Loss=0.00085 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.988 | L2-Norm(final)=13.834 | 2320.9 samples/s | 36.3 steps/s
[Step=16900 Epoch=161.1] | Loss=0.00075 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.987 | L2-Norm(final)=13.835 | 5376.8 samples/s | 84.0 steps/s
[Step=16950 Epoch=161.5] | Loss=0.00066 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.985 | L2-Norm(final)=13.836 | 2391.2 samples/s | 37.4 steps/s
[Step=17000 Epoch=162.0] | Loss=0.00060 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.982 | L2-Norm(final)=13.836 | 5043.6 samples/s | 78.8 steps/s
[Step=17050 Epoch=162.5] | Loss=0.00054 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.978 | L2-Norm(final)=13.837 | 2492.0 samples/s | 38.9 steps/s
[Step=17100 Epoch=163.0] | Loss=0.00050 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.974 | L2-Norm(final)=13.838 | 4758.7 samples/s | 74.4 steps/s
[Step=17150 Epoch=163.5] | Loss=0.00046 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.970 | L2-Norm(final)=13.839 | 2495.7 samples/s | 39.0 steps/s
[Step=17200 Epoch=163.9] | Loss=0.00043 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.966 | L2-Norm(final)=13.840 | 4636.4 samples/s | 72.4 steps/s
[Step=17250 Epoch=164.4] | Loss=0.00040 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.961 | L2-Norm(final)=13.840 | 2552.7 samples/s | 39.9 steps/s
[Step=17300 Epoch=164.9] | Loss=0.00038 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=13.841 | 4608.0 samples/s | 72.0 steps/s
[Step=17350 Epoch=165.4] | Loss=0.00035 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=13.842 | 2492.3 samples/s | 38.9 steps/s
[Step=17400 Epoch=165.8] | Loss=0.00034 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.947 | L2-Norm(final)=13.843 | 4534.8 samples/s | 70.9 steps/s
[Step=17450 Epoch=166.3] | Loss=0.00032 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.941 | L2-Norm(final)=13.844 | 2569.7 samples/s | 40.2 steps/s
[Step=17500 Epoch=166.8] | Loss=0.00030 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.936 | L2-Norm(final)=13.845 | 4585.1 samples/s | 71.6 steps/s
[Step=17550 Epoch=167.3] | Loss=0.00029 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.931 | L2-Norm(final)=13.846 | 7469.7 samples/s | 116.7 steps/s
[Step=17600 Epoch=167.7] | Loss=0.00028 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.925 | L2-Norm(final)=13.847 | 2119.1 samples/s | 33.1 steps/s
[Step=17650 Epoch=168.2] | Loss=0.00026 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.920 | L2-Norm(final)=13.848 | 6737.4 samples/s | 105.3 steps/s
[Step=17700 Epoch=168.7] | Loss=0.00025 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.914 | L2-Norm(final)=13.848 | 2193.1 samples/s | 34.3 steps/s
[Step=17750 Epoch=169.2] | Loss=0.00024 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.909 | L2-Norm(final)=13.849 | 6098.0 samples/s | 95.3 steps/s
[Step=17800 Epoch=169.7] | Loss=0.00023 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.903 | L2-Norm(final)=13.850 | 2260.2 samples/s | 35.3 steps/s
[Step=17850 Epoch=170.1] | Loss=0.00022 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.897 | L2-Norm(final)=13.851 | 5759.2 samples/s | 90.0 steps/s
[Step=17900 Epoch=170.6] | Loss=0.00022 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.891 | L2-Norm(final)=13.852 | 2326.7 samples/s | 36.4 steps/s
[Step=17950 Epoch=171.1] | Loss=0.00021 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.886 | L2-Norm(final)=13.852 | 5329.9 samples/s | 83.3 steps/s
[Step=18000 Epoch=171.6] | Loss=0.00020 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=13.853 | 2390.4 samples/s | 37.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4/client_state-step18000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09247 | acc=0.9592 | tpr=0.9628 | fpr=0.0486 | 5591.6 samples/s | 21.8 steps/s
Avg test loss: 0.10101, Avg test acc: 0.95741, Avg tpr: 0.96200, Avg fpr: 0.05269, total FA: 411

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10306 | acc=0.9609 | tpr=0.9776 | fpr=0.0753 | 5732.7 samples/s | 22.4 steps/s
Avg test loss: 0.10702, Avg test acc: 0.96029, Avg tpr: 0.97546, Avg fpr: 0.07307, total FA: 570

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.10462 | acc=0.9590 | tpr=0.9694 | fpr=0.0637 | 5608.0 samples/s | 21.9 steps/s
Avg test loss: 0.10788, Avg test acc: 0.95765, Avg tpr: 0.96748, Avg fpr: 0.06397, total FA: 499

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09209 | acc=0.9623 | tpr=0.9764 | fpr=0.0681 | 5644.7 samples/s | 22.0 steps/s
Avg test loss: 0.10061, Avg test acc: 0.96125, Avg tpr: 0.97581, Avg fpr: 0.07076, total FA: 552

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09488 | acc=0.9594 | tpr=0.9692 | fpr=0.0619 | 5674.1 samples/s | 22.2 steps/s
Avg test loss: 0.10563, Avg test acc: 0.95837, Avg tpr: 0.96754, Avg fpr: 0.06179, total FA: 482

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.39959 | acc=0.2907 | tpr=0.0110 | fpr=0.1018 | 5670.9 samples/s | 22.2 steps/s
Avg test loss: 5.41654, Avg test acc: 0.28852, Avg tpr: 0.01119, Avg fpr: 0.10153, total FA: 792

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.66786 | acc=0.2839 | tpr=0.0154 | fpr=0.1331 | 5714.6 samples/s | 22.3 steps/s
Avg test loss: 4.67592, Avg test acc: 0.28255, Avg tpr: 0.01562, Avg fpr: 0.13037, total FA: 1017

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.84767 | acc=0.2411 | tpr=0.0134 | fpr=0.2644 | 5655.5 samples/s | 22.1 steps/s
Avg test loss: 5.84888, Avg test acc: 0.24141, Avg tpr: 0.01399, Avg fpr: 0.25843, total FA: 2016

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.63669 | acc=0.2692 | tpr=0.0246 | fpr=0.1997 | 5766.8 samples/s | 22.5 steps/s
Avg test loss: 5.64204, Avg test acc: 0.26805, Avg tpr: 0.02489, Avg fpr: 0.19715, total FA: 1538

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.25925 | acc=0.2635 | tpr=0.0051 | fpr=0.1754 | 5636.6 samples/s | 22.0 steps/s
Avg test loss: 5.27444, Avg test acc: 0.26132, Avg tpr: 0.00507, Avg fpr: 0.17511, total FA: 1366

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.94551 | acc=0.1638 | tpr=0.1858 | fpr=0.8366 | 5783.9 samples/s | 22.6 steps/s
[Step= 100] | Loss=4.89992 | acc=0.1630 | tpr=0.1727 | fpr=0.8371 | 7801.3 samples/s | 30.5 steps/s
[Step= 150] | Loss=4.91116 | acc=0.1625 | tpr=0.1657 | fpr=0.8376 | 7322.5 samples/s | 28.6 steps/s
[Step= 200] | Loss=4.90462 | acc=0.1624 | tpr=0.1672 | fpr=0.8377 | 8310.1 samples/s | 32.5 steps/s
[Step= 250] | Loss=4.90743 | acc=0.1625 | tpr=0.1738 | fpr=0.8377 | 8746.3 samples/s | 34.2 steps/s
[Step= 300] | Loss=4.91092 | acc=0.1621 | tpr=0.1760 | fpr=0.8381 | 8206.5 samples/s | 32.1 steps/s
[Step= 350] | Loss=4.91167 | acc=0.1618 | tpr=0.1684 | fpr=0.8383 | 7920.3 samples/s | 30.9 steps/s
[Step= 400] | Loss=4.90927 | acc=0.1625 | tpr=0.1701 | fpr=0.8377 | 7707.2 samples/s | 30.1 steps/s
[Step= 450] | Loss=4.90842 | acc=0.1623 | tpr=0.1689 | fpr=0.8378 | 8193.8 samples/s | 32.0 steps/s
[Step= 500] | Loss=4.91057 | acc=0.1624 | tpr=0.1705 | fpr=0.8377 | 8241.9 samples/s | 32.2 steps/s
[Step= 550] | Loss=4.90951 | acc=0.1623 | tpr=0.1671 | fpr=0.8378 | 10052.3 samples/s | 39.3 steps/s
Avg test loss: 4.90963, Avg test acc: 0.16216, Avg tpr: 0.16680, Avg fpr: 0.83792, total FA: 116344

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.16969 | acc=0.1306 | tpr=0.2655 | fpr=0.8718 | 5716.7 samples/s | 22.3 steps/s
[Step= 100] | Loss=6.11946 | acc=0.1324 | tpr=0.2260 | fpr=0.8693 | 7781.6 samples/s | 30.4 steps/s
[Step= 150] | Loss=6.13457 | acc=0.1300 | tpr=0.2147 | fpr=0.8715 | 8320.9 samples/s | 32.5 steps/s
[Step= 200] | Loss=6.13375 | acc=0.1296 | tpr=0.2077 | fpr=0.8718 | 8266.4 samples/s | 32.3 steps/s
[Step= 250] | Loss=6.14068 | acc=0.1299 | tpr=0.2122 | fpr=0.8716 | 7725.9 samples/s | 30.2 steps/s
[Step= 300] | Loss=6.14433 | acc=0.1294 | tpr=0.2124 | fpr=0.8721 | 7519.3 samples/s | 29.4 steps/s
[Step= 350] | Loss=6.14693 | acc=0.1290 | tpr=0.1997 | fpr=0.8723 | 8317.2 samples/s | 32.5 steps/s
[Step= 400] | Loss=6.14558 | acc=0.1295 | tpr=0.2008 | fpr=0.8718 | 8730.5 samples/s | 34.1 steps/s
[Step= 450] | Loss=6.14674 | acc=0.1296 | tpr=0.1986 | fpr=0.8717 | 7954.6 samples/s | 31.1 steps/s
[Step= 500] | Loss=6.14705 | acc=0.1297 | tpr=0.2000 | fpr=0.8716 | 8175.1 samples/s | 31.9 steps/s
[Step= 550] | Loss=6.14479 | acc=0.1297 | tpr=0.1994 | fpr=0.8716 | 9767.9 samples/s | 38.2 steps/s
Avg test loss: 6.14515, Avg test acc: 0.12962, Avg tpr: 0.20008, Avg fpr: 0.87167, total FA: 121029

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.24211 | acc=0.1352 | tpr=0.1195 | fpr=0.8645 | 5766.9 samples/s | 22.5 steps/s
[Step= 100] | Loss=6.18489 | acc=0.1359 | tpr=0.1045 | fpr=0.8635 | 8267.9 samples/s | 32.3 steps/s
[Step= 150] | Loss=6.18882 | acc=0.1359 | tpr=0.1081 | fpr=0.8636 | 7221.8 samples/s | 28.2 steps/s
[Step= 200] | Loss=6.17759 | acc=0.1365 | tpr=0.1082 | fpr=0.8630 | 8145.6 samples/s | 31.8 steps/s
[Step= 250] | Loss=6.17737 | acc=0.1368 | tpr=0.1083 | fpr=0.8627 | 8447.9 samples/s | 33.0 steps/s
[Step= 300] | Loss=6.18465 | acc=0.1364 | tpr=0.1084 | fpr=0.8631 | 8067.0 samples/s | 31.5 steps/s
[Step= 350] | Loss=6.18810 | acc=0.1356 | tpr=0.1046 | fpr=0.8639 | 8053.4 samples/s | 31.5 steps/s
[Step= 400] | Loss=6.18626 | acc=0.1360 | tpr=0.1100 | fpr=0.8635 | 7514.8 samples/s | 29.4 steps/s
[Step= 450] | Loss=6.18545 | acc=0.1362 | tpr=0.1095 | fpr=0.8634 | 8470.8 samples/s | 33.1 steps/s
[Step= 500] | Loss=6.18736 | acc=0.1359 | tpr=0.1101 | fpr=0.8636 | 7930.6 samples/s | 31.0 steps/s
[Step= 550] | Loss=6.18250 | acc=0.1363 | tpr=0.1090 | fpr=0.8632 | 10980.5 samples/s | 42.9 steps/s
Avg test loss: 6.18253, Avg test acc: 0.13614, Avg tpr: 0.10935, Avg fpr: 0.86337, total FA: 119877

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.76636 | acc=0.1482 | tpr=0.2168 | fpr=0.8530 | 5677.5 samples/s | 22.2 steps/s
[Step= 100] | Loss=5.71827 | acc=0.1487 | tpr=0.1962 | fpr=0.8522 | 7797.5 samples/s | 30.5 steps/s
[Step= 150] | Loss=5.72723 | acc=0.1477 | tpr=0.1916 | fpr=0.8531 | 7718.4 samples/s | 30.2 steps/s
[Step= 200] | Loss=5.71887 | acc=0.1478 | tpr=0.1880 | fpr=0.8529 | 8222.9 samples/s | 32.1 steps/s
[Step= 250] | Loss=5.72468 | acc=0.1482 | tpr=0.1878 | fpr=0.8525 | 7950.8 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.72888 | acc=0.1476 | tpr=0.1935 | fpr=0.8532 | 7730.4 samples/s | 30.2 steps/s
[Step= 350] | Loss=5.72889 | acc=0.1471 | tpr=0.1822 | fpr=0.8535 | 8407.9 samples/s | 32.8 steps/s
[Step= 400] | Loss=5.72599 | acc=0.1475 | tpr=0.1876 | fpr=0.8532 | 7688.4 samples/s | 30.0 steps/s
[Step= 450] | Loss=5.72684 | acc=0.1477 | tpr=0.1860 | fpr=0.8530 | 8778.0 samples/s | 34.3 steps/s
[Step= 500] | Loss=5.73060 | acc=0.1477 | tpr=0.1855 | fpr=0.8530 | 8158.6 samples/s | 31.9 steps/s
[Step= 550] | Loss=5.72749 | acc=0.1479 | tpr=0.1854 | fpr=0.8528 | 10608.8 samples/s | 41.4 steps/s
Avg test loss: 5.72647, Avg test acc: 0.14786, Avg tpr: 0.18621, Avg fpr: 0.85284, total FA: 118415

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.40308 | acc=0.1317 | tpr=0.1770 | fpr=0.8691 | 5570.7 samples/s | 21.8 steps/s
[Step= 100] | Loss=6.35190 | acc=0.1328 | tpr=0.1684 | fpr=0.8679 | 8115.1 samples/s | 31.7 steps/s
[Step= 150] | Loss=6.37099 | acc=0.1328 | tpr=0.1513 | fpr=0.8675 | 7563.1 samples/s | 29.5 steps/s
[Step= 200] | Loss=6.36385 | acc=0.1331 | tpr=0.1399 | fpr=0.8670 | 8731.9 samples/s | 34.1 steps/s
[Step= 250] | Loss=6.37251 | acc=0.1331 | tpr=0.1397 | fpr=0.8670 | 8091.3 samples/s | 31.6 steps/s
[Step= 300] | Loss=6.37401 | acc=0.1325 | tpr=0.1375 | fpr=0.8676 | 8057.1 samples/s | 31.5 steps/s
[Step= 350] | Loss=6.37759 | acc=0.1318 | tpr=0.1315 | fpr=0.8682 | 7879.4 samples/s | 30.8 steps/s
[Step= 400] | Loss=6.37645 | acc=0.1323 | tpr=0.1318 | fpr=0.8677 | 8695.0 samples/s | 34.0 steps/s
[Step= 450] | Loss=6.37624 | acc=0.1325 | tpr=0.1329 | fpr=0.8675 | 7254.5 samples/s | 28.3 steps/s
[Step= 500] | Loss=6.37961 | acc=0.1322 | tpr=0.1335 | fpr=0.8678 | 8639.5 samples/s | 33.7 steps/s
[Step= 550] | Loss=6.37622 | acc=0.1322 | tpr=0.1321 | fpr=0.8678 | 10092.7 samples/s | 39.4 steps/s
Avg test loss: 6.37535, Avg test acc: 0.13204, Avg tpr: 0.13273, Avg fpr: 0.86797, total FA: 120516

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10221 | acc=0.9810 | tpr=0.8894 | fpr=0.0173 | 5522.0 samples/s | 21.6 steps/s
[Step= 100] | Loss=0.10480 | acc=0.9816 | tpr=0.9168 | fpr=0.0172 | 7746.7 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.10855 | acc=0.9806 | tpr=0.9179 | fpr=0.0182 | 8806.4 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.10978 | acc=0.9806 | tpr=0.9246 | fpr=0.0184 | 8021.4 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.11022 | acc=0.9805 | tpr=0.9170 | fpr=0.0184 | 8031.4 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.11192 | acc=0.9803 | tpr=0.9164 | fpr=0.0185 | 8443.5 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.11216 | acc=0.9804 | tpr=0.9192 | fpr=0.0185 | 7628.0 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.11289 | acc=0.9802 | tpr=0.9174 | fpr=0.0186 | 8080.5 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.11518 | acc=0.9799 | tpr=0.9158 | fpr=0.0189 | 8033.8 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.11418 | acc=0.9800 | tpr=0.9176 | fpr=0.0188 | 7935.5 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.11339 | acc=0.9801 | tpr=0.9192 | fpr=0.0188 | 10739.4 samples/s | 42.0 steps/s
Avg test loss: 0.11320, Avg test acc: 0.98014, Avg tpr: 0.91878, Avg fpr: 0.01874, total FA: 2602

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10860 | acc=0.9806 | tpr=0.8982 | fpr=0.0179 | 5839.8 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.11089 | acc=0.9807 | tpr=0.9254 | fpr=0.0183 | 8013.0 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.11510 | acc=0.9801 | tpr=0.9308 | fpr=0.0190 | 7972.6 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.11719 | acc=0.9800 | tpr=0.9344 | fpr=0.0191 | 7760.8 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.11769 | acc=0.9799 | tpr=0.9310 | fpr=0.0192 | 7656.6 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.11940 | acc=0.9797 | tpr=0.9309 | fpr=0.0194 | 8707.2 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.11970 | acc=0.9795 | tpr=0.9311 | fpr=0.0196 | 8140.3 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.12077 | acc=0.9794 | tpr=0.9267 | fpr=0.0197 | 8129.0 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.12283 | acc=0.9791 | tpr=0.9250 | fpr=0.0199 | 7683.3 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.12201 | acc=0.9792 | tpr=0.9273 | fpr=0.0199 | 8288.8 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.12109 | acc=0.9793 | tpr=0.9260 | fpr=0.0198 | 10167.5 samples/s | 39.7 steps/s
Avg test loss: 0.12086, Avg test acc: 0.97927, Avg tpr: 0.92591, Avg fpr: 0.01976, total FA: 2743

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10680 | acc=0.9789 | tpr=0.9336 | fpr=0.0203 | 5671.9 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.10858 | acc=0.9790 | tpr=0.9531 | fpr=0.0205 | 7826.5 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.11297 | acc=0.9788 | tpr=0.9582 | fpr=0.0208 | 8257.5 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.11499 | acc=0.9787 | tpr=0.9574 | fpr=0.0209 | 8178.7 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.11580 | acc=0.9786 | tpr=0.9511 | fpr=0.0209 | 8554.1 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.11718 | acc=0.9785 | tpr=0.9505 | fpr=0.0210 | 7667.8 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.11790 | acc=0.9783 | tpr=0.9518 | fpr=0.0212 | 8036.8 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.11891 | acc=0.9780 | tpr=0.9480 | fpr=0.0214 | 8252.6 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.12128 | acc=0.9777 | tpr=0.9469 | fpr=0.0217 | 8133.9 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.12045 | acc=0.9779 | tpr=0.9493 | fpr=0.0216 | 8051.4 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.11956 | acc=0.9781 | tpr=0.9491 | fpr=0.0214 | 9788.1 samples/s | 38.2 steps/s
Avg test loss: 0.11930, Avg test acc: 0.97810, Avg tpr: 0.94889, Avg fpr: 0.02137, total FA: 2967

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09598 | acc=0.9828 | tpr=0.9248 | fpr=0.0161 | 5451.9 samples/s | 21.3 steps/s
[Step= 100] | Loss=0.09746 | acc=0.9826 | tpr=0.9339 | fpr=0.0165 | 8346.3 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.10165 | acc=0.9820 | tpr=0.9380 | fpr=0.0172 | 8260.1 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.10287 | acc=0.9819 | tpr=0.9377 | fpr=0.0173 | 8407.1 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.10295 | acc=0.9820 | tpr=0.9319 | fpr=0.0171 | 8268.9 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.10436 | acc=0.9819 | tpr=0.9295 | fpr=0.0171 | 7592.0 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.10455 | acc=0.9819 | tpr=0.9324 | fpr=0.0172 | 8203.4 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.10535 | acc=0.9818 | tpr=0.9300 | fpr=0.0172 | 8172.2 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.10773 | acc=0.9815 | tpr=0.9279 | fpr=0.0175 | 8409.6 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.10709 | acc=0.9816 | tpr=0.9300 | fpr=0.0175 | 7886.6 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.10632 | acc=0.9817 | tpr=0.9296 | fpr=0.0174 | 9941.1 samples/s | 38.8 steps/s
Avg test loss: 0.10611, Avg test acc: 0.98170, Avg tpr: 0.92948, Avg fpr: 0.01735, total FA: 2409

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.11265 | acc=0.9809 | tpr=0.9071 | fpr=0.0178 | 5708.2 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.11582 | acc=0.9807 | tpr=0.9232 | fpr=0.0182 | 8199.5 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.11941 | acc=0.9803 | tpr=0.9323 | fpr=0.0189 | 7786.1 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.12164 | acc=0.9802 | tpr=0.9366 | fpr=0.0191 | 8710.1 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.12104 | acc=0.9800 | tpr=0.9301 | fpr=0.0191 | 8248.5 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.12215 | acc=0.9799 | tpr=0.9273 | fpr=0.0191 | 7648.8 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.12229 | acc=0.9798 | tpr=0.9261 | fpr=0.0193 | 7895.0 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.12315 | acc=0.9797 | tpr=0.9223 | fpr=0.0193 | 8526.6 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.12506 | acc=0.9793 | tpr=0.9216 | fpr=0.0197 | 8071.1 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.12419 | acc=0.9795 | tpr=0.9238 | fpr=0.0195 | 8160.8 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.12361 | acc=0.9795 | tpr=0.9224 | fpr=0.0195 | 9599.7 samples/s | 37.5 steps/s
Avg test loss: 0.12334, Avg test acc: 0.97949, Avg tpr: 0.92235, Avg fpr: 0.01947, total FA: 2703

server round 25/50

clients selected: [0 3 5 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=16001 Epoch=78.0] | Loss=0.00099 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.708 | L2-Norm(final)=12.778 | 5945.4 samples/s | 92.9 steps/s
[Step=16050 Epoch=78.3] | Loss=0.02162 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.708 | L2-Norm(final)=12.784 | 4945.8 samples/s | 77.3 steps/s
[Step=16100 Epoch=78.5] | Loss=0.02342 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.708 | L2-Norm(final)=12.785 | 5730.0 samples/s | 89.5 steps/s
[Step=16150 Epoch=78.8] | Loss=0.02239 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.708 | L2-Norm(final)=12.786 | 5530.7 samples/s | 86.4 steps/s
[Step=16200 Epoch=79.0] | Loss=0.02115 | Reg=0.00115 | acc=0.9375 | L2-Norm=10.708 | L2-Norm(final)=12.792 | 8655.2 samples/s | 135.2 steps/s
[Step=16250 Epoch=79.2] | Loss=0.02109 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.708 | L2-Norm(final)=12.799 | 2412.0 samples/s | 37.7 steps/s
[Step=16300 Epoch=79.5] | Loss=0.02089 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.708 | L2-Norm(final)=12.806 | 5599.4 samples/s | 87.5 steps/s
[Step=16350 Epoch=79.7] | Loss=0.02077 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.708 | L2-Norm(final)=12.814 | 5627.7 samples/s | 87.9 steps/s
[Step=16400 Epoch=80.0] | Loss=0.02047 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.708 | L2-Norm(final)=12.821 | 7783.6 samples/s | 121.6 steps/s
[Step=16450 Epoch=80.2] | Loss=0.02070 | Reg=0.00115 | acc=0.9531 | L2-Norm=10.708 | L2-Norm(final)=12.827 | 2534.5 samples/s | 39.6 steps/s
[Step=16500 Epoch=80.5] | Loss=0.02098 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.708 | L2-Norm(final)=12.832 | 5627.4 samples/s | 87.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=16501 Epoch=80.5] | Loss=0.01583 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.708 | L2-Norm(final)=12.877 | 6089.1 samples/s | 95.1 steps/s
[Step=16550 Epoch=80.7] | Loss=0.02649 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.752 | L2-Norm(final)=12.870 | 4274.4 samples/s | 66.8 steps/s
[Step=16600 Epoch=80.9] | Loss=0.02941 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.794 | L2-Norm(final)=12.863 | 4875.5 samples/s | 76.2 steps/s
[Step=16650 Epoch=81.2] | Loss=0.02582 | Reg=0.00117 | acc=0.9688 | L2-Norm=10.825 | L2-Norm(final)=12.861 | 4848.0 samples/s | 75.7 steps/s
[Step=16700 Epoch=81.4] | Loss=0.02309 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.847 | L2-Norm(final)=12.862 | 6914.0 samples/s | 108.0 steps/s
[Step=16750 Epoch=81.7] | Loss=0.02045 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.866 | L2-Norm(final)=12.863 | 2275.7 samples/s | 35.6 steps/s
[Step=16800 Epoch=81.9] | Loss=0.01868 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.881 | L2-Norm(final)=12.865 | 4834.6 samples/s | 75.5 steps/s
[Step=16850 Epoch=82.2] | Loss=0.01721 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.894 | L2-Norm(final)=12.868 | 4866.4 samples/s | 76.0 steps/s
[Step=16900 Epoch=82.4] | Loss=0.01657 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.904 | L2-Norm(final)=12.870 | 6307.8 samples/s | 98.6 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01533 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.915 | L2-Norm(final)=12.872 | 2330.0 samples/s | 36.4 steps/s
[Step=17000 Epoch=82.9] | Loss=0.01433 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.924 | L2-Norm(final)=12.875 | 4932.3 samples/s | 77.1 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01347 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.932 | L2-Norm(final)=12.878 | 4826.5 samples/s | 75.4 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01280 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.939 | L2-Norm(final)=12.880 | 5739.3 samples/s | 89.7 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01208 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.946 | L2-Norm(final)=12.883 | 2426.2 samples/s | 37.9 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01164 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.953 | L2-Norm(final)=12.886 | 4848.4 samples/s | 75.8 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01124 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.959 | L2-Norm(final)=12.889 | 4842.1 samples/s | 75.7 steps/s
[Step=17300 Epoch=84.4] | Loss=0.01091 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.965 | L2-Norm(final)=12.892 | 5393.8 samples/s | 84.3 steps/s
[Step=17350 Epoch=84.6] | Loss=0.01058 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.971 | L2-Norm(final)=12.894 | 2518.5 samples/s | 39.4 steps/s
[Step=17400 Epoch=84.8] | Loss=0.01021 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.976 | L2-Norm(final)=12.897 | 4858.1 samples/s | 75.9 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00988 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.981 | L2-Norm(final)=12.899 | 4973.8 samples/s | 77.7 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00958 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.986 | L2-Norm(final)=12.902 | 4883.5 samples/s | 76.3 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00924 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.991 | L2-Norm(final)=12.905 | 2592.0 samples/s | 40.5 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00905 | Reg=0.00121 | acc=0.9688 | L2-Norm=10.995 | L2-Norm(final)=12.907 | 4918.6 samples/s | 76.9 steps/s
[Step=17650 Epoch=86.1] | Loss=0.00888 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.999 | L2-Norm(final)=12.909 | 4822.4 samples/s | 75.3 steps/s
[Step=17700 Epoch=86.3] | Loss=0.00866 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.002 | L2-Norm(final)=12.912 | 4873.3 samples/s | 76.1 steps/s
[Step=17750 Epoch=86.6] | Loss=0.00843 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.006 | L2-Norm(final)=12.914 | 2625.2 samples/s | 41.0 steps/s
[Step=17800 Epoch=86.8] | Loss=0.00824 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.010 | L2-Norm(final)=12.916 | 4887.4 samples/s | 76.4 steps/s
[Step=17850 Epoch=87.0] | Loss=0.00808 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.013 | L2-Norm(final)=12.918 | 4924.3 samples/s | 76.9 steps/s
[Step=17900 Epoch=87.3] | Loss=0.00791 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=12.921 | 4770.4 samples/s | 74.5 steps/s
[Step=17950 Epoch=87.5] | Loss=0.00771 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=12.923 | 2631.4 samples/s | 41.1 steps/s
[Step=18000 Epoch=87.8] | Loss=0.00757 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=12.925 | 4843.6 samples/s | 75.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step18000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=126.8] | Loss=0.03345 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.708 | L2-Norm(final)=14.457 | 6351.5 samples/s | 99.2 steps/s
[Step=26050 Epoch=127.0] | Loss=0.02288 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.707 | L2-Norm(final)=14.450 | 4788.1 samples/s | 74.8 steps/s
[Step=26100 Epoch=127.3] | Loss=0.02378 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.707 | L2-Norm(final)=14.444 | 5723.8 samples/s | 89.4 steps/s
[Step=26150 Epoch=127.5] | Loss=0.02265 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.707 | L2-Norm(final)=14.442 | 5670.8 samples/s | 88.6 steps/s
[Step=26200 Epoch=127.8] | Loss=0.02326 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.707 | L2-Norm(final)=14.441 | 8395.6 samples/s | 131.2 steps/s
[Step=26250 Epoch=128.0] | Loss=0.02356 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.707 | L2-Norm(final)=14.438 | 2474.2 samples/s | 38.7 steps/s
[Step=26300 Epoch=128.3] | Loss=0.02279 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.707 | L2-Norm(final)=14.436 | 5558.3 samples/s | 86.8 steps/s
[Step=26350 Epoch=128.5] | Loss=0.02303 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.707 | L2-Norm(final)=14.434 | 5560.2 samples/s | 86.9 steps/s
[Step=26400 Epoch=128.7] | Loss=0.02339 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.707 | L2-Norm(final)=14.432 | 7731.9 samples/s | 120.8 steps/s
[Step=26450 Epoch=129.0] | Loss=0.02328 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.707 | L2-Norm(final)=14.429 | 2565.9 samples/s | 40.1 steps/s
[Step=26500 Epoch=129.2] | Loss=0.02283 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.707 | L2-Norm(final)=14.428 | 5502.8 samples/s | 86.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=129.2] | Loss=0.04072 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.707 | L2-Norm(final)=14.418 | 5493.2 samples/s | 85.8 steps/s
[Step=26550 Epoch=129.5] | Loss=0.02495 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.747 | L2-Norm(final)=14.413 | 4532.8 samples/s | 70.8 steps/s
[Step=26600 Epoch=129.7] | Loss=0.02574 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.784 | L2-Norm(final)=14.405 | 4835.2 samples/s | 75.6 steps/s
[Step=26650 Epoch=130.0] | Loss=0.02395 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.812 | L2-Norm(final)=14.402 | 4867.8 samples/s | 76.1 steps/s
[Step=26700 Epoch=130.2] | Loss=0.02233 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.833 | L2-Norm(final)=14.401 | 6967.7 samples/s | 108.9 steps/s
[Step=26750 Epoch=130.4] | Loss=0.01974 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.849 | L2-Norm(final)=14.402 | 2293.8 samples/s | 35.8 steps/s
[Step=26800 Epoch=130.7] | Loss=0.01768 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.863 | L2-Norm(final)=14.405 | 4926.2 samples/s | 77.0 steps/s
[Step=26850 Epoch=130.9] | Loss=0.01618 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.874 | L2-Norm(final)=14.407 | 4765.6 samples/s | 74.5 steps/s
[Step=26900 Epoch=131.2] | Loss=0.01514 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.883 | L2-Norm(final)=14.409 | 6387.3 samples/s | 99.8 steps/s
[Step=26950 Epoch=131.4] | Loss=0.01437 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.891 | L2-Norm(final)=14.411 | 2326.8 samples/s | 36.4 steps/s
[Step=27000 Epoch=131.7] | Loss=0.01355 | Reg=0.00119 | acc=0.9688 | L2-Norm=10.898 | L2-Norm(final)=14.414 | 4831.1 samples/s | 75.5 steps/s
[Step=27050 Epoch=131.9] | Loss=0.01274 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.905 | L2-Norm(final)=14.416 | 4935.4 samples/s | 77.1 steps/s
[Step=27100 Epoch=132.2] | Loss=0.01223 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.911 | L2-Norm(final)=14.418 | 5727.5 samples/s | 89.5 steps/s
[Step=27150 Epoch=132.4] | Loss=0.01180 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.916 | L2-Norm(final)=14.419 | 2444.5 samples/s | 38.2 steps/s
[Step=27200 Epoch=132.6] | Loss=0.01133 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.921 | L2-Norm(final)=14.421 | 4915.8 samples/s | 76.8 steps/s
[Step=27250 Epoch=132.9] | Loss=0.01099 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.926 | L2-Norm(final)=14.422 | 4801.7 samples/s | 75.0 steps/s
[Step=27300 Epoch=133.1] | Loss=0.01060 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.930 | L2-Norm(final)=14.424 | 5355.5 samples/s | 83.7 steps/s
[Step=27350 Epoch=133.4] | Loss=0.01021 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.934 | L2-Norm(final)=14.426 | 2521.0 samples/s | 39.4 steps/s
[Step=27400 Epoch=133.6] | Loss=0.00993 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.938 | L2-Norm(final)=14.427 | 4842.5 samples/s | 75.7 steps/s
[Step=27450 Epoch=133.9] | Loss=0.00962 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.942 | L2-Norm(final)=14.429 | 4953.6 samples/s | 77.4 steps/s
[Step=27500 Epoch=134.1] | Loss=0.00934 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=14.431 | 4919.6 samples/s | 76.9 steps/s
[Step=27550 Epoch=134.3] | Loss=0.00909 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.949 | L2-Norm(final)=14.432 | 2609.3 samples/s | 40.8 steps/s
[Step=27600 Epoch=134.6] | Loss=0.00886 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=14.434 | 4880.1 samples/s | 76.3 steps/s
[Step=27650 Epoch=134.8] | Loss=0.00859 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=14.435 | 4819.3 samples/s | 75.3 steps/s
[Step=27700 Epoch=135.1] | Loss=0.00841 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=14.437 | 4884.0 samples/s | 76.3 steps/s
[Step=27750 Epoch=135.3] | Loss=0.00820 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.960 | L2-Norm(final)=14.438 | 2668.7 samples/s | 41.7 steps/s
[Step=27800 Epoch=135.6] | Loss=0.00799 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=14.440 | 4780.0 samples/s | 74.7 steps/s
[Step=27850 Epoch=135.8] | Loss=0.00777 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.965 | L2-Norm(final)=14.441 | 4909.3 samples/s | 76.7 steps/s
[Step=27900 Epoch=136.1] | Loss=0.00763 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.967 | L2-Norm(final)=14.443 | 4805.8 samples/s | 75.1 steps/s
[Step=27950 Epoch=136.3] | Loss=0.00749 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.969 | L2-Norm(final)=14.444 | 2664.9 samples/s | 41.6 steps/s
[Step=28000 Epoch=136.5] | Loss=0.00733 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.971 | L2-Norm(final)=14.446 | 4837.5 samples/s | 75.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step28000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=246.4] | Loss=0.00018 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.708 | L2-Norm(final)=14.586 | 5718.9 samples/s | 89.4 steps/s
[Step=26050 Epoch=246.8] | Loss=0.00056 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=14.598 | 4665.9 samples/s | 72.9 steps/s
[Step=26100 Epoch=247.3] | Loss=0.00087 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.704 | L2-Norm(final)=14.616 | 8057.6 samples/s | 125.9 steps/s
[Step=26150 Epoch=247.8] | Loss=0.00106 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.704 | L2-Norm(final)=14.634 | 2381.2 samples/s | 37.2 steps/s
[Step=26200 Epoch=248.3] | Loss=0.00102 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.704 | L2-Norm(final)=14.651 | 6989.1 samples/s | 109.2 steps/s
[Step=26250 Epoch=248.7] | Loss=0.00103 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.704 | L2-Norm(final)=14.666 | 2451.5 samples/s | 38.3 steps/s
[Step=26300 Epoch=249.2] | Loss=0.00099 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.704 | L2-Norm(final)=14.680 | 6564.2 samples/s | 102.6 steps/s
[Step=26350 Epoch=249.7] | Loss=0.00094 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.704 | L2-Norm(final)=14.694 | 2569.3 samples/s | 40.1 steps/s
[Step=26400 Epoch=250.2] | Loss=0.00096 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.704 | L2-Norm(final)=14.706 | 5877.8 samples/s | 91.8 steps/s
[Step=26450 Epoch=250.6] | Loss=0.00096 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.704 | L2-Norm(final)=14.720 | 2669.4 samples/s | 41.7 steps/s
[Step=26500 Epoch=251.1] | Loss=0.00100 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.704 | L2-Norm(final)=14.732 | 5653.1 samples/s | 88.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=251.1] | Loss=0.00005 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.704 | L2-Norm(final)=14.863 | 5836.4 samples/s | 91.2 steps/s
[Step=26550 Epoch=251.6] | Loss=0.00300 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.738 | L2-Norm(final)=14.866 | 4114.6 samples/s | 64.3 steps/s
[Step=26600 Epoch=252.1] | Loss=0.00248 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.803 | L2-Norm(final)=14.852 | 6622.6 samples/s | 103.5 steps/s
[Step=26650 Epoch=252.5] | Loss=0.00200 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.838 | L2-Norm(final)=14.845 | 2181.6 samples/s | 34.1 steps/s
[Step=26700 Epoch=253.0] | Loss=0.00155 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=14.842 | 5985.3 samples/s | 93.5 steps/s
[Step=26750 Epoch=253.5] | Loss=0.00140 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.870 | L2-Norm(final)=14.840 | 2280.3 samples/s | 35.6 steps/s
[Step=26800 Epoch=254.0] | Loss=0.00124 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.879 | L2-Norm(final)=14.839 | 5560.5 samples/s | 86.9 steps/s
[Step=26850 Epoch=254.4] | Loss=0.00106 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.885 | L2-Norm(final)=14.838 | 2363.5 samples/s | 36.9 steps/s
[Step=26900 Epoch=254.9] | Loss=0.00093 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.888 | L2-Norm(final)=14.837 | 5067.6 samples/s | 79.2 steps/s
[Step=26950 Epoch=255.4] | Loss=0.00083 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.889 | L2-Norm(final)=14.837 | 2463.3 samples/s | 38.5 steps/s
[Step=27000 Epoch=255.8] | Loss=0.00075 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.889 | L2-Norm(final)=14.837 | 4653.7 samples/s | 72.7 steps/s
[Step=27050 Epoch=256.3] | Loss=0.00068 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.889 | L2-Norm(final)=14.836 | 2532.9 samples/s | 39.6 steps/s
[Step=27100 Epoch=256.8] | Loss=0.00062 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.888 | L2-Norm(final)=14.836 | 4740.5 samples/s | 74.1 steps/s
[Step=27150 Epoch=257.3] | Loss=0.00058 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.886 | L2-Norm(final)=14.836 | 2541.4 samples/s | 39.7 steps/s
[Step=27200 Epoch=257.7] | Loss=0.00054 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.884 | L2-Norm(final)=14.836 | 4613.2 samples/s | 72.1 steps/s
[Step=27250 Epoch=258.2] | Loss=0.00050 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.882 | L2-Norm(final)=14.836 | 2569.9 samples/s | 40.2 steps/s
[Step=27300 Epoch=258.7] | Loss=0.00047 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.879 | L2-Norm(final)=14.836 | 4618.6 samples/s | 72.2 steps/s
[Step=27350 Epoch=259.2] | Loss=0.00044 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.876 | L2-Norm(final)=14.837 | 2627.7 samples/s | 41.1 steps/s
[Step=27400 Epoch=259.6] | Loss=0.00042 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.873 | L2-Norm(final)=14.837 | 4396.2 samples/s | 68.7 steps/s
[Step=27450 Epoch=260.1] | Loss=0.00040 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.870 | L2-Norm(final)=14.837 | 6867.5 samples/s | 107.3 steps/s
[Step=27500 Epoch=260.6] | Loss=0.00038 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.867 | L2-Norm(final)=14.837 | 2162.3 samples/s | 33.8 steps/s
[Step=27550 Epoch=261.1] | Loss=0.00036 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.864 | L2-Norm(final)=14.838 | 6294.8 samples/s | 98.4 steps/s
[Step=27600 Epoch=261.5] | Loss=0.00034 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.860 | L2-Norm(final)=14.838 | 2261.9 samples/s | 35.3 steps/s
[Step=27650 Epoch=262.0] | Loss=0.00033 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=14.838 | 5737.9 samples/s | 89.7 steps/s
[Step=27700 Epoch=262.5] | Loss=0.00031 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.853 | L2-Norm(final)=14.838 | 2319.4 samples/s | 36.2 steps/s
[Step=27750 Epoch=263.0] | Loss=0.00030 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.849 | L2-Norm(final)=14.839 | 5201.5 samples/s | 81.3 steps/s
[Step=27800 Epoch=263.4] | Loss=0.00029 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.845 | L2-Norm(final)=14.839 | 2445.3 samples/s | 38.2 steps/s
[Step=27850 Epoch=263.9] | Loss=0.00028 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.842 | L2-Norm(final)=14.839 | 4728.7 samples/s | 73.9 steps/s
[Step=27900 Epoch=264.4] | Loss=0.00027 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.838 | L2-Norm(final)=14.840 | 2524.2 samples/s | 39.4 steps/s
[Step=27950 Epoch=264.9] | Loss=0.00026 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=14.840 | 4567.3 samples/s | 71.4 steps/s
[Step=28000 Epoch=265.3] | Loss=0.00025 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.830 | L2-Norm(final)=14.841 | 2568.3 samples/s | 40.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step28000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=188.5] | Loss=0.00003 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.708 | L2-Norm(final)=14.097 | 5560.5 samples/s | 86.9 steps/s
[Step=20050 Epoch=188.9] | Loss=0.00133 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=14.108 | 4831.1 samples/s | 75.5 steps/s
[Step=20100 Epoch=189.4] | Loss=0.00135 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=14.128 | 7942.5 samples/s | 124.1 steps/s
[Step=20150 Epoch=189.9] | Loss=0.00123 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=14.145 | 2364.6 samples/s | 36.9 steps/s
[Step=20200 Epoch=190.3] | Loss=0.00135 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=14.163 | 7025.8 samples/s | 109.8 steps/s
[Step=20250 Epoch=190.8] | Loss=0.00133 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.705 | L2-Norm(final)=14.179 | 2480.4 samples/s | 38.8 steps/s
[Step=20300 Epoch=191.3] | Loss=0.00132 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=14.195 | 6325.9 samples/s | 98.8 steps/s
[Step=20350 Epoch=191.8] | Loss=0.00126 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=14.210 | 2586.7 samples/s | 40.4 steps/s
[Step=20400 Epoch=192.2] | Loss=0.00127 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=14.225 | 5615.6 samples/s | 87.7 steps/s
[Step=20450 Epoch=192.7] | Loss=0.00129 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=14.240 | 2687.9 samples/s | 42.0 steps/s
[Step=20500 Epoch=193.2] | Loss=0.00129 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=14.255 | 5386.7 samples/s | 84.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=193.2] | Loss=0.00134 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=14.402 | 5956.5 samples/s | 93.1 steps/s
[Step=20550 Epoch=193.6] | Loss=0.00042 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.720 | L2-Norm(final)=14.411 | 4009.0 samples/s | 62.6 steps/s
[Step=20600 Epoch=194.1] | Loss=0.00073 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.737 | L2-Norm(final)=14.417 | 6636.4 samples/s | 103.7 steps/s
[Step=20650 Epoch=194.6] | Loss=0.00054 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.759 | L2-Norm(final)=14.420 | 2197.0 samples/s | 34.3 steps/s
[Step=20700 Epoch=195.1] | Loss=0.00041 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.768 | L2-Norm(final)=14.422 | 5870.2 samples/s | 91.7 steps/s
[Step=20750 Epoch=195.5] | Loss=0.00033 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=14.424 | 2330.4 samples/s | 36.4 steps/s
[Step=20800 Epoch=196.0] | Loss=0.00027 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.767 | L2-Norm(final)=14.425 | 5281.9 samples/s | 82.5 steps/s
[Step=20850 Epoch=196.5] | Loss=0.00024 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.763 | L2-Norm(final)=14.426 | 2395.1 samples/s | 37.4 steps/s
[Step=20900 Epoch=196.9] | Loss=0.00021 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.758 | L2-Norm(final)=14.427 | 4900.4 samples/s | 76.6 steps/s
[Step=20950 Epoch=197.4] | Loss=0.00018 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.751 | L2-Norm(final)=14.427 | 2489.6 samples/s | 38.9 steps/s
[Step=21000 Epoch=197.9] | Loss=0.00017 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.745 | L2-Norm(final)=14.428 | 4746.1 samples/s | 74.2 steps/s
[Step=21050 Epoch=198.4] | Loss=0.00015 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.738 | L2-Norm(final)=14.429 | 2559.9 samples/s | 40.0 steps/s
[Step=21100 Epoch=198.8] | Loss=0.00014 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=14.429 | 4631.7 samples/s | 72.4 steps/s
[Step=21150 Epoch=199.3] | Loss=0.00013 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.723 | L2-Norm(final)=14.430 | 2561.5 samples/s | 40.0 steps/s
[Step=21200 Epoch=199.8] | Loss=0.00012 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.715 | L2-Norm(final)=14.430 | 4682.2 samples/s | 73.2 steps/s
[Step=21250 Epoch=200.2] | Loss=0.00011 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.707 | L2-Norm(final)=14.431 | 2760.3 samples/s | 43.1 steps/s
[Step=21300 Epoch=200.7] | Loss=0.00011 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.700 | L2-Norm(final)=14.431 | 4054.1 samples/s | 63.3 steps/s
[Step=21350 Epoch=201.2] | Loss=0.00010 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.692 | L2-Norm(final)=14.432 | 6736.5 samples/s | 105.3 steps/s
[Step=21400 Epoch=201.6] | Loss=0.00009 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.683 | L2-Norm(final)=14.432 | 2230.1 samples/s | 34.8 steps/s
[Step=21450 Epoch=202.1] | Loss=0.00009 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.675 | L2-Norm(final)=14.433 | 5861.1 samples/s | 91.6 steps/s
[Step=21500 Epoch=202.6] | Loss=0.00008 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.667 | L2-Norm(final)=14.433 | 2321.0 samples/s | 36.3 steps/s
[Step=21550 Epoch=203.1] | Loss=0.00008 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.659 | L2-Norm(final)=14.433 | 5268.4 samples/s | 82.3 steps/s
[Step=21600 Epoch=203.5] | Loss=0.00008 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.650 | L2-Norm(final)=14.434 | 2391.3 samples/s | 37.4 steps/s
[Step=21650 Epoch=204.0] | Loss=0.00007 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.642 | L2-Norm(final)=14.434 | 4876.2 samples/s | 76.2 steps/s
[Step=21700 Epoch=204.5] | Loss=0.00007 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.633 | L2-Norm(final)=14.435 | 2485.7 samples/s | 38.8 steps/s
[Step=21750 Epoch=204.9] | Loss=0.00007 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.625 | L2-Norm(final)=14.435 | 4729.9 samples/s | 73.9 steps/s
[Step=21800 Epoch=205.4] | Loss=0.00007 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.616 | L2-Norm(final)=14.435 | 2559.6 samples/s | 40.0 steps/s
[Step=21850 Epoch=205.9] | Loss=0.00006 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.607 | L2-Norm(final)=14.436 | 4659.3 samples/s | 72.8 steps/s
[Step=21900 Epoch=206.4] | Loss=0.00006 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.599 | L2-Norm(final)=14.436 | 2614.5 samples/s | 40.9 steps/s
[Step=21950 Epoch=206.8] | Loss=0.00006 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.590 | L2-Norm(final)=14.436 | 4500.6 samples/s | 70.3 steps/s
[Step=22000 Epoch=207.3] | Loss=0.00006 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.581 | L2-Norm(final)=14.437 | 2618.5 samples/s | 40.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step22000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=18001 Epoch=171.6] | Loss=0.00269 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.708 | L2-Norm(final)=13.877 | 5473.1 samples/s | 85.5 steps/s
[Step=18050 Epoch=172.0] | Loss=0.00219 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.706 | L2-Norm(final)=13.890 | 4696.6 samples/s | 73.4 steps/s
[Step=18100 Epoch=172.5] | Loss=0.00208 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=13.909 | 8492.5 samples/s | 132.7 steps/s
[Step=18150 Epoch=173.0] | Loss=0.00213 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=13.928 | 2363.8 samples/s | 36.9 steps/s
[Step=18200 Epoch=173.5] | Loss=0.00201 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=13.944 | 7463.0 samples/s | 116.6 steps/s
[Step=18250 Epoch=173.9] | Loss=0.00201 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=13.961 | 2389.1 samples/s | 37.3 steps/s
[Step=18300 Epoch=174.4] | Loss=0.00206 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=13.978 | 6969.1 samples/s | 108.9 steps/s
[Step=18350 Epoch=174.9] | Loss=0.00201 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=13.993 | 2468.5 samples/s | 38.6 steps/s
[Step=18400 Epoch=175.4] | Loss=0.00202 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=14.009 | 6385.3 samples/s | 99.8 steps/s
[Step=18450 Epoch=175.8] | Loss=0.00200 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=14.023 | 2601.0 samples/s | 40.6 steps/s
[Step=18500 Epoch=176.3] | Loss=0.00202 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=14.037 | 5665.5 samples/s | 88.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=176.3] | Loss=0.00018 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=14.183 | 5445.8 samples/s | 85.1 steps/s
[Step=18550 Epoch=176.8] | Loss=0.00062 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.731 | L2-Norm(final)=14.193 | 4305.1 samples/s | 67.3 steps/s
[Step=18600 Epoch=177.3] | Loss=0.00034 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.751 | L2-Norm(final)=14.200 | 6771.2 samples/s | 105.8 steps/s
[Step=18650 Epoch=177.8] | Loss=0.00023 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.752 | L2-Norm(final)=14.204 | 2212.8 samples/s | 34.6 steps/s
[Step=18700 Epoch=178.2] | Loss=0.00018 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.748 | L2-Norm(final)=14.206 | 6056.8 samples/s | 94.6 steps/s
[Step=18750 Epoch=178.7] | Loss=0.00014 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.741 | L2-Norm(final)=14.208 | 2225.6 samples/s | 34.8 steps/s
[Step=18800 Epoch=179.2] | Loss=0.00012 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.734 | L2-Norm(final)=14.209 | 5781.7 samples/s | 90.3 steps/s
[Step=18850 Epoch=179.7] | Loss=0.00010 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.726 | L2-Norm(final)=14.211 | 2312.2 samples/s | 36.1 steps/s
[Step=18900 Epoch=180.1] | Loss=0.00009 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.718 | L2-Norm(final)=14.212 | 5344.1 samples/s | 83.5 steps/s
[Step=18950 Epoch=180.6] | Loss=0.00008 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.709 | L2-Norm(final)=14.213 | 2359.0 samples/s | 36.9 steps/s
[Step=19000 Epoch=181.1] | Loss=0.00007 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.701 | L2-Norm(final)=14.214 | 5046.4 samples/s | 78.8 steps/s
[Step=19050 Epoch=181.6] | Loss=0.00007 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.692 | L2-Norm(final)=14.215 | 2461.2 samples/s | 38.5 steps/s
[Step=19100 Epoch=182.0] | Loss=0.00006 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.683 | L2-Norm(final)=14.216 | 4749.4 samples/s | 74.2 steps/s
[Step=19150 Epoch=182.5] | Loss=0.00006 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.674 | L2-Norm(final)=14.216 | 2528.2 samples/s | 39.5 steps/s
[Step=19200 Epoch=183.0] | Loss=0.00005 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.666 | L2-Norm(final)=14.217 | 4643.7 samples/s | 72.6 steps/s
[Step=19250 Epoch=183.5] | Loss=0.00005 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.657 | L2-Norm(final)=14.218 | 2571.2 samples/s | 40.2 steps/s
[Step=19300 Epoch=183.9] | Loss=0.00005 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.648 | L2-Norm(final)=14.219 | 4576.9 samples/s | 71.5 steps/s
[Step=19350 Epoch=184.4] | Loss=0.00004 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.639 | L2-Norm(final)=14.219 | 2538.2 samples/s | 39.7 steps/s
[Step=19400 Epoch=184.9] | Loss=0.00004 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.630 | L2-Norm(final)=14.220 | 4610.4 samples/s | 72.0 steps/s
[Step=19450 Epoch=185.4] | Loss=0.00004 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.621 | L2-Norm(final)=14.221 | 2631.4 samples/s | 41.1 steps/s
[Step=19500 Epoch=185.9] | Loss=0.00004 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.611 | L2-Norm(final)=14.222 | 4410.5 samples/s | 68.9 steps/s
[Step=19550 Epoch=186.3] | Loss=0.00004 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.602 | L2-Norm(final)=14.222 | 7453.9 samples/s | 116.5 steps/s
[Step=19600 Epoch=186.8] | Loss=0.00003 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.593 | L2-Norm(final)=14.223 | 2126.6 samples/s | 33.2 steps/s
[Step=19650 Epoch=187.3] | Loss=0.00003 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.584 | L2-Norm(final)=14.224 | 6779.3 samples/s | 105.9 steps/s
[Step=19700 Epoch=187.8] | Loss=0.00003 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.574 | L2-Norm(final)=14.224 | 2187.7 samples/s | 34.2 steps/s
[Step=19750 Epoch=188.2] | Loss=0.00003 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.565 | L2-Norm(final)=14.225 | 6228.5 samples/s | 97.3 steps/s
[Step=19800 Epoch=188.7] | Loss=0.00003 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.556 | L2-Norm(final)=14.226 | 2248.1 samples/s | 35.1 steps/s
[Step=19850 Epoch=189.2] | Loss=0.00003 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.546 | L2-Norm(final)=14.227 | 5771.9 samples/s | 90.2 steps/s
[Step=19900 Epoch=189.7] | Loss=0.00003 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.537 | L2-Norm(final)=14.227 | 2316.7 samples/s | 36.2 steps/s
[Step=19950 Epoch=190.1] | Loss=0.00003 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.527 | L2-Norm(final)=14.228 | 5343.3 samples/s | 83.5 steps/s
[Step=20000 Epoch=190.6] | Loss=0.00003 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.517 | L2-Norm(final)=14.229 | 2361.4 samples/s | 36.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09373 | acc=0.9603 | tpr=0.9669 | fpr=0.0540 | 5523.7 samples/s | 21.6 steps/s
Avg test loss: 0.10044, Avg test acc: 0.95905, Avg tpr: 0.96637, Avg fpr: 0.05704, total FA: 445

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10306 | acc=0.9609 | tpr=0.9776 | fpr=0.0753 | 5709.3 samples/s | 22.3 steps/s
Avg test loss: 0.10702, Avg test acc: 0.96029, Avg tpr: 0.97546, Avg fpr: 0.07307, total FA: 570

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.10462 | acc=0.9590 | tpr=0.9694 | fpr=0.0637 | 5734.1 samples/s | 22.4 steps/s
Avg test loss: 0.10788, Avg test acc: 0.95765, Avg tpr: 0.96748, Avg fpr: 0.06397, total FA: 499

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09846 | acc=0.9609 | tpr=0.9792 | fpr=0.0788 | 5717.6 samples/s | 22.3 steps/s
Avg test loss: 0.10688, Avg test acc: 0.95913, Avg tpr: 0.97838, Avg fpr: 0.08319, total FA: 649

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09488 | acc=0.9594 | tpr=0.9692 | fpr=0.0619 | 5664.6 samples/s | 22.1 steps/s
Avg test loss: 0.10563, Avg test acc: 0.95837, Avg tpr: 0.96754, Avg fpr: 0.06179, total FA: 482

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.56851 | acc=0.3013 | tpr=0.0045 | fpr=0.0543 | 5545.8 samples/s | 21.7 steps/s
Avg test loss: 5.58497, Avg test acc: 0.29862, Avg tpr: 0.00396, Avg fpr: 0.05333, total FA: 416

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.66786 | acc=0.2839 | tpr=0.0154 | fpr=0.1331 | 5744.8 samples/s | 22.4 steps/s
Avg test loss: 4.67592, Avg test acc: 0.28255, Avg tpr: 0.01562, Avg fpr: 0.13037, total FA: 1017

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.84767 | acc=0.2411 | tpr=0.0134 | fpr=0.2644 | 5492.8 samples/s | 21.5 steps/s
Avg test loss: 5.84888, Avg test acc: 0.24141, Avg tpr: 0.01399, Avg fpr: 0.25843, total FA: 2016

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.42613 | acc=0.2609 | tpr=0.0084 | fpr=0.1908 | 5793.4 samples/s | 22.6 steps/s
Avg test loss: 5.43837, Avg test acc: 0.25944, Avg tpr: 0.00839, Avg fpr: 0.18844, total FA: 1470

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.57109 | acc=0.2593 | tpr=0.0110 | fpr=0.2014 | 5712.6 samples/s | 22.3 steps/s
Avg test loss: 5.58360, Avg test acc: 0.25900, Avg tpr: 0.01148, Avg fpr: 0.19664, total FA: 1534

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.40394 | acc=0.1600 | tpr=0.2301 | fpr=0.8413 | 5545.2 samples/s | 21.7 steps/s
[Step= 100] | Loss=5.34955 | acc=0.1598 | tpr=0.2324 | fpr=0.8416 | 8306.8 samples/s | 32.4 steps/s
[Step= 150] | Loss=5.36669 | acc=0.1586 | tpr=0.2233 | fpr=0.8425 | 8128.3 samples/s | 31.8 steps/s
[Step= 200] | Loss=5.36012 | acc=0.1584 | tpr=0.2197 | fpr=0.8428 | 7435.6 samples/s | 29.0 steps/s
[Step= 250] | Loss=5.36265 | acc=0.1587 | tpr=0.2262 | fpr=0.8425 | 8542.6 samples/s | 33.4 steps/s
[Step= 300] | Loss=5.36349 | acc=0.1582 | tpr=0.2284 | fpr=0.8431 | 6204.1 samples/s | 24.2 steps/s
[Step= 350] | Loss=5.36466 | acc=0.1580 | tpr=0.2192 | fpr=0.8431 | 8227.5 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.36116 | acc=0.1587 | tpr=0.2216 | fpr=0.8425 | 8718.8 samples/s | 34.1 steps/s
[Step= 450] | Loss=5.36221 | acc=0.1584 | tpr=0.2186 | fpr=0.8427 | 8153.6 samples/s | 31.8 steps/s
[Step= 500] | Loss=5.36375 | acc=0.1585 | tpr=0.2198 | fpr=0.8426 | 7331.9 samples/s | 28.6 steps/s
[Step= 550] | Loss=5.36077 | acc=0.1582 | tpr=0.2137 | fpr=0.8428 | 9637.9 samples/s | 37.6 steps/s
Avg test loss: 5.36064, Avg test acc: 0.15809, Avg tpr: 0.21395, Avg fpr: 0.84292, total FA: 117038

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.16969 | acc=0.1306 | tpr=0.2655 | fpr=0.8718 | 5674.6 samples/s | 22.2 steps/s
[Step= 100] | Loss=6.11946 | acc=0.1324 | tpr=0.2260 | fpr=0.8693 | 7781.9 samples/s | 30.4 steps/s
[Step= 150] | Loss=6.13457 | acc=0.1300 | tpr=0.2147 | fpr=0.8715 | 7675.0 samples/s | 30.0 steps/s
[Step= 200] | Loss=6.13375 | acc=0.1296 | tpr=0.2077 | fpr=0.8718 | 7840.8 samples/s | 30.6 steps/s
[Step= 250] | Loss=6.14068 | acc=0.1299 | tpr=0.2122 | fpr=0.8716 | 8268.4 samples/s | 32.3 steps/s
[Step= 300] | Loss=6.14433 | acc=0.1294 | tpr=0.2124 | fpr=0.8721 | 5968.4 samples/s | 23.3 steps/s
[Step= 350] | Loss=6.14693 | acc=0.1290 | tpr=0.1997 | fpr=0.8723 | 8202.9 samples/s | 32.0 steps/s
[Step= 400] | Loss=6.14558 | acc=0.1295 | tpr=0.2008 | fpr=0.8718 | 8577.6 samples/s | 33.5 steps/s
[Step= 450] | Loss=6.14674 | acc=0.1296 | tpr=0.1986 | fpr=0.8717 | 8062.7 samples/s | 31.5 steps/s
[Step= 500] | Loss=6.14705 | acc=0.1297 | tpr=0.2000 | fpr=0.8716 | 7537.1 samples/s | 29.4 steps/s
[Step= 550] | Loss=6.14479 | acc=0.1297 | tpr=0.1994 | fpr=0.8716 | 11085.1 samples/s | 43.3 steps/s
Avg test loss: 6.14515, Avg test acc: 0.12962, Avg tpr: 0.20008, Avg fpr: 0.87167, total FA: 121029

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.24211 | acc=0.1352 | tpr=0.1195 | fpr=0.8645 | 5529.0 samples/s | 21.6 steps/s
[Step= 100] | Loss=6.18489 | acc=0.1359 | tpr=0.1045 | fpr=0.8635 | 8357.0 samples/s | 32.6 steps/s
[Step= 150] | Loss=6.18882 | acc=0.1359 | tpr=0.1081 | fpr=0.8636 | 7960.1 samples/s | 31.1 steps/s
[Step= 200] | Loss=6.17759 | acc=0.1365 | tpr=0.1082 | fpr=0.8630 | 8434.3 samples/s | 32.9 steps/s
[Step= 250] | Loss=6.17737 | acc=0.1368 | tpr=0.1083 | fpr=0.8627 | 7552.0 samples/s | 29.5 steps/s
[Step= 300] | Loss=6.18465 | acc=0.1364 | tpr=0.1084 | fpr=0.8631 | 6297.1 samples/s | 24.6 steps/s
[Step= 350] | Loss=6.18810 | acc=0.1356 | tpr=0.1046 | fpr=0.8639 | 8373.4 samples/s | 32.7 steps/s
[Step= 400] | Loss=6.18626 | acc=0.1360 | tpr=0.1100 | fpr=0.8635 | 7717.0 samples/s | 30.1 steps/s
[Step= 450] | Loss=6.18545 | acc=0.1362 | tpr=0.1095 | fpr=0.8634 | 7561.2 samples/s | 29.5 steps/s
[Step= 500] | Loss=6.18736 | acc=0.1359 | tpr=0.1101 | fpr=0.8636 | 8089.0 samples/s | 31.6 steps/s
[Step= 550] | Loss=6.18250 | acc=0.1363 | tpr=0.1090 | fpr=0.8632 | 10137.7 samples/s | 39.6 steps/s
Avg test loss: 6.18253, Avg test acc: 0.13614, Avg tpr: 0.10935, Avg fpr: 0.86337, total FA: 119877

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.84301 | acc=0.1339 | tpr=0.2566 | fpr=0.8683 | 5829.7 samples/s | 22.8 steps/s
[Step= 100] | Loss=5.79950 | acc=0.1329 | tpr=0.2239 | fpr=0.8688 | 7403.9 samples/s | 28.9 steps/s
[Step= 150] | Loss=5.81142 | acc=0.1323 | tpr=0.2104 | fpr=0.8691 | 8056.5 samples/s | 31.5 steps/s
[Step= 200] | Loss=5.80225 | acc=0.1322 | tpr=0.2098 | fpr=0.8692 | 8248.8 samples/s | 32.2 steps/s
[Step= 250] | Loss=5.80531 | acc=0.1322 | tpr=0.2131 | fpr=0.8693 | 8112.4 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.80914 | acc=0.1317 | tpr=0.2138 | fpr=0.8698 | 6423.1 samples/s | 25.1 steps/s
[Step= 350] | Loss=5.80903 | acc=0.1313 | tpr=0.2023 | fpr=0.8700 | 7636.5 samples/s | 29.8 steps/s
[Step= 400] | Loss=5.80804 | acc=0.1317 | tpr=0.2079 | fpr=0.8697 | 7854.2 samples/s | 30.7 steps/s
[Step= 450] | Loss=5.80652 | acc=0.1319 | tpr=0.2055 | fpr=0.8695 | 7864.0 samples/s | 30.7 steps/s
[Step= 500] | Loss=5.81104 | acc=0.1318 | tpr=0.2057 | fpr=0.8696 | 8564.1 samples/s | 33.5 steps/s
[Step= 550] | Loss=5.80809 | acc=0.1318 | tpr=0.2057 | fpr=0.8695 | 9652.2 samples/s | 37.7 steps/s
Avg test loss: 5.80779, Avg test acc: 0.13179, Avg tpr: 0.20681, Avg fpr: 0.86958, total FA: 120739

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.40308 | acc=0.1317 | tpr=0.1770 | fpr=0.8691 | 5817.8 samples/s | 22.7 steps/s
[Step= 100] | Loss=6.35190 | acc=0.1328 | tpr=0.1684 | fpr=0.8679 | 8110.2 samples/s | 31.7 steps/s
[Step= 150] | Loss=6.37099 | acc=0.1328 | tpr=0.1513 | fpr=0.8675 | 7681.3 samples/s | 30.0 steps/s
[Step= 200] | Loss=6.36385 | acc=0.1331 | tpr=0.1399 | fpr=0.8670 | 7767.8 samples/s | 30.3 steps/s
[Step= 250] | Loss=6.37251 | acc=0.1331 | tpr=0.1397 | fpr=0.8670 | 6498.6 samples/s | 25.4 steps/s
[Step= 300] | Loss=6.37401 | acc=0.1325 | tpr=0.1375 | fpr=0.8676 | 8529.1 samples/s | 33.3 steps/s
[Step= 350] | Loss=6.37759 | acc=0.1318 | tpr=0.1315 | fpr=0.8682 | 7809.0 samples/s | 30.5 steps/s
[Step= 400] | Loss=6.37645 | acc=0.1323 | tpr=0.1318 | fpr=0.8677 | 7871.1 samples/s | 30.7 steps/s
[Step= 450] | Loss=6.37624 | acc=0.1325 | tpr=0.1329 | fpr=0.8675 | 8148.9 samples/s | 31.8 steps/s
[Step= 500] | Loss=6.37961 | acc=0.1322 | tpr=0.1335 | fpr=0.8678 | 7370.7 samples/s | 28.8 steps/s
[Step= 550] | Loss=6.37622 | acc=0.1322 | tpr=0.1321 | fpr=0.8678 | 9969.3 samples/s | 38.9 steps/s
Avg test loss: 6.37535, Avg test acc: 0.13204, Avg tpr: 0.13273, Avg fpr: 0.86797, total FA: 120516

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11329 | acc=0.9810 | tpr=0.9204 | fpr=0.0179 | 5780.9 samples/s | 22.6 steps/s
[Step= 100] | Loss=0.11524 | acc=0.9814 | tpr=0.9360 | fpr=0.0178 | 7240.5 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.11895 | acc=0.9806 | tpr=0.9380 | fpr=0.0186 | 7879.8 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.12091 | acc=0.9805 | tpr=0.9410 | fpr=0.0188 | 8037.3 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.12021 | acc=0.9805 | tpr=0.9380 | fpr=0.0188 | 7863.7 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.12213 | acc=0.9802 | tpr=0.9389 | fpr=0.0191 | 8747.7 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.12306 | acc=0.9801 | tpr=0.9405 | fpr=0.0192 | 8356.5 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.12436 | acc=0.9800 | tpr=0.9371 | fpr=0.0193 | 8047.2 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.12722 | acc=0.9796 | tpr=0.9367 | fpr=0.0196 | 5929.0 samples/s | 23.2 steps/s
[Step= 500] | Loss=0.12588 | acc=0.9798 | tpr=0.9392 | fpr=0.0195 | 7646.4 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.12498 | acc=0.9799 | tpr=0.9387 | fpr=0.0193 | 11341.9 samples/s | 44.3 steps/s
Avg test loss: 0.12473, Avg test acc: 0.97995, Avg tpr: 0.93859, Avg fpr: 0.01929, total FA: 2679

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10860 | acc=0.9806 | tpr=0.8982 | fpr=0.0179 | 5832.8 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.11089 | acc=0.9807 | tpr=0.9254 | fpr=0.0183 | 8093.2 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.11510 | acc=0.9801 | tpr=0.9308 | fpr=0.0190 | 7777.0 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.11719 | acc=0.9800 | tpr=0.9344 | fpr=0.0191 | 5863.5 samples/s | 22.9 steps/s
[Step= 250] | Loss=0.11769 | acc=0.9799 | tpr=0.9310 | fpr=0.0192 | 8400.9 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.11940 | acc=0.9797 | tpr=0.9309 | fpr=0.0194 | 8039.6 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.11970 | acc=0.9795 | tpr=0.9311 | fpr=0.0196 | 8146.3 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.12077 | acc=0.9794 | tpr=0.9267 | fpr=0.0197 | 8076.7 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.12283 | acc=0.9791 | tpr=0.9250 | fpr=0.0199 | 7394.9 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.12201 | acc=0.9792 | tpr=0.9273 | fpr=0.0199 | 8256.3 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.12109 | acc=0.9793 | tpr=0.9260 | fpr=0.0198 | 10474.9 samples/s | 40.9 steps/s
Avg test loss: 0.12086, Avg test acc: 0.97927, Avg tpr: 0.92591, Avg fpr: 0.01976, total FA: 2743

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10680 | acc=0.9789 | tpr=0.9336 | fpr=0.0203 | 5860.8 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.10858 | acc=0.9790 | tpr=0.9531 | fpr=0.0205 | 7531.5 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.11297 | acc=0.9788 | tpr=0.9582 | fpr=0.0208 | 7553.9 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.11499 | acc=0.9787 | tpr=0.9574 | fpr=0.0209 | 5985.7 samples/s | 23.4 steps/s
[Step= 250] | Loss=0.11580 | acc=0.9786 | tpr=0.9511 | fpr=0.0209 | 8525.7 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.11718 | acc=0.9785 | tpr=0.9505 | fpr=0.0210 | 8403.1 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.11790 | acc=0.9783 | tpr=0.9518 | fpr=0.0212 | 8057.3 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.11891 | acc=0.9780 | tpr=0.9480 | fpr=0.0214 | 7759.0 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.12128 | acc=0.9777 | tpr=0.9469 | fpr=0.0217 | 7787.3 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.12045 | acc=0.9779 | tpr=0.9493 | fpr=0.0216 | 7633.0 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.11956 | acc=0.9781 | tpr=0.9491 | fpr=0.0214 | 11418.6 samples/s | 44.6 steps/s
Avg test loss: 0.11930, Avg test acc: 0.97810, Avg tpr: 0.94889, Avg fpr: 0.02137, total FA: 2967

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09589 | acc=0.9821 | tpr=0.9204 | fpr=0.0168 | 5786.6 samples/s | 22.6 steps/s
[Step= 100] | Loss=0.09824 | acc=0.9821 | tpr=0.9254 | fpr=0.0168 | 7958.1 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.10065 | acc=0.9819 | tpr=0.9352 | fpr=0.0173 | 7923.6 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.10245 | acc=0.9817 | tpr=0.9344 | fpr=0.0174 | 5460.1 samples/s | 21.3 steps/s
[Step= 250] | Loss=0.10256 | acc=0.9817 | tpr=0.9293 | fpr=0.0173 | 8222.4 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.10371 | acc=0.9816 | tpr=0.9244 | fpr=0.0173 | 7965.6 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.10354 | acc=0.9816 | tpr=0.9261 | fpr=0.0174 | 8457.1 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.10444 | acc=0.9815 | tpr=0.9234 | fpr=0.0175 | 8176.0 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.10646 | acc=0.9812 | tpr=0.9231 | fpr=0.0178 | 7293.5 samples/s | 28.5 steps/s
[Step= 500] | Loss=0.10572 | acc=0.9813 | tpr=0.9264 | fpr=0.0177 | 8573.1 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.10494 | acc=0.9815 | tpr=0.9260 | fpr=0.0175 | 10956.8 samples/s | 42.8 steps/s
Avg test loss: 0.10471, Avg test acc: 0.98149, Avg tpr: 0.92591, Avg fpr: 0.01750, total FA: 2430

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.09853 | acc=0.9816 | tpr=0.9159 | fpr=0.0173 | 5806.4 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.10177 | acc=0.9814 | tpr=0.9339 | fpr=0.0177 | 7838.1 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.10529 | acc=0.9810 | tpr=0.9395 | fpr=0.0183 | 7444.0 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.10680 | acc=0.9809 | tpr=0.9443 | fpr=0.0184 | 6511.7 samples/s | 25.4 steps/s
[Step= 250] | Loss=0.10750 | acc=0.9808 | tpr=0.9406 | fpr=0.0185 | 8178.9 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.10867 | acc=0.9807 | tpr=0.9396 | fpr=0.0185 | 7998.3 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.10891 | acc=0.9807 | tpr=0.9418 | fpr=0.0186 | 7735.6 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.10962 | acc=0.9806 | tpr=0.9387 | fpr=0.0186 | 7941.6 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.11152 | acc=0.9803 | tpr=0.9362 | fpr=0.0189 | 7552.8 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.11071 | acc=0.9805 | tpr=0.9379 | fpr=0.0188 | 8019.6 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.11005 | acc=0.9805 | tpr=0.9363 | fpr=0.0187 | 10497.1 samples/s | 41.0 steps/s
Avg test loss: 0.10987, Avg test acc: 0.98049, Avg tpr: 0.93582, Avg fpr: 0.01870, total FA: 2596

server round 26/50

clients selected: [0 3 5 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=18001 Epoch=87.8] | Loss=0.00983 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=12.995 | 5801.1 samples/s | 90.6 steps/s
[Step=18050 Epoch=88.0] | Loss=0.02293 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.631 | L2-Norm(final)=12.990 | 5045.7 samples/s | 78.8 steps/s
[Step=18100 Epoch=88.3] | Loss=0.02033 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.631 | L2-Norm(final)=12.995 | 5712.8 samples/s | 89.3 steps/s
[Step=18150 Epoch=88.5] | Loss=0.02121 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.631 | L2-Norm(final)=12.999 | 5735.1 samples/s | 89.6 steps/s
[Step=18200 Epoch=88.7] | Loss=0.02020 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=13.002 | 8382.9 samples/s | 131.0 steps/s
[Step=18250 Epoch=89.0] | Loss=0.02011 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.631 | L2-Norm(final)=13.005 | 2462.9 samples/s | 38.5 steps/s
[Step=18300 Epoch=89.2] | Loss=0.01991 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=13.008 | 5824.4 samples/s | 91.0 steps/s
[Step=18350 Epoch=89.5] | Loss=0.02038 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.631 | L2-Norm(final)=13.010 | 5563.5 samples/s | 86.9 steps/s
[Step=18400 Epoch=89.7] | Loss=0.01995 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=13.012 | 7635.5 samples/s | 119.3 steps/s
[Step=18450 Epoch=90.0] | Loss=0.02015 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=13.015 | 2536.2 samples/s | 39.6 steps/s
[Step=18500 Epoch=90.2] | Loss=0.02053 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=13.017 | 5673.2 samples/s | 88.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=90.2] | Loss=0.08389 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.632 | L2-Norm(final)=13.027 | 5789.7 samples/s | 90.5 steps/s
[Step=18550 Epoch=90.5] | Loss=0.02571 | Reg=0.00114 | acc=0.9844 | L2-Norm=10.682 | L2-Norm(final)=13.022 | 4436.6 samples/s | 69.3 steps/s
[Step=18600 Epoch=90.7] | Loss=0.02535 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.726 | L2-Norm(final)=13.018 | 4812.8 samples/s | 75.2 steps/s
[Step=18650 Epoch=90.9] | Loss=0.02492 | Reg=0.00116 | acc=0.9531 | L2-Norm=10.758 | L2-Norm(final)=13.017 | 4907.7 samples/s | 76.7 steps/s
[Step=18700 Epoch=91.2] | Loss=0.02234 | Reg=0.00116 | acc=0.9531 | L2-Norm=10.783 | L2-Norm(final)=13.017 | 6931.6 samples/s | 108.3 steps/s
[Step=18750 Epoch=91.4] | Loss=0.02293 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.804 | L2-Norm(final)=13.017 | 2289.8 samples/s | 35.8 steps/s
[Step=18800 Epoch=91.7] | Loss=0.02060 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.825 | L2-Norm(final)=13.018 | 4842.9 samples/s | 75.7 steps/s
[Step=18850 Epoch=91.9] | Loss=0.01900 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.842 | L2-Norm(final)=13.021 | 4854.3 samples/s | 75.8 steps/s
[Step=18900 Epoch=92.2] | Loss=0.01783 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.857 | L2-Norm(final)=13.023 | 6378.9 samples/s | 99.7 steps/s
[Step=18950 Epoch=92.4] | Loss=0.01715 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.871 | L2-Norm(final)=13.026 | 2364.0 samples/s | 36.9 steps/s
[Step=19000 Epoch=92.6] | Loss=0.01584 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.885 | L2-Norm(final)=13.028 | 4846.5 samples/s | 75.7 steps/s
[Step=19050 Epoch=92.9] | Loss=0.01520 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.897 | L2-Norm(final)=13.031 | 4790.6 samples/s | 74.9 steps/s
[Step=19100 Epoch=93.1] | Loss=0.01471 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.907 | L2-Norm(final)=13.034 | 5856.7 samples/s | 91.5 steps/s
[Step=19150 Epoch=93.4] | Loss=0.01396 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.917 | L2-Norm(final)=13.036 | 2403.8 samples/s | 37.6 steps/s
[Step=19200 Epoch=93.6] | Loss=0.01325 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.925 | L2-Norm(final)=13.038 | 4920.0 samples/s | 76.9 steps/s
[Step=19250 Epoch=93.9] | Loss=0.01266 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.932 | L2-Norm(final)=13.041 | 4784.1 samples/s | 74.8 steps/s
[Step=19300 Epoch=94.1] | Loss=0.01214 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.939 | L2-Norm(final)=13.043 | 5357.2 samples/s | 83.7 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01183 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.945 | L2-Norm(final)=13.045 | 2488.0 samples/s | 38.9 steps/s
[Step=19400 Epoch=94.6] | Loss=0.01137 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.950 | L2-Norm(final)=13.047 | 5001.8 samples/s | 78.2 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01099 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.955 | L2-Norm(final)=13.049 | 4740.7 samples/s | 74.1 steps/s
[Step=19500 Epoch=95.1] | Loss=0.01066 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.960 | L2-Norm(final)=13.052 | 5003.1 samples/s | 78.2 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01032 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.964 | L2-Norm(final)=13.054 | 2630.8 samples/s | 41.1 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01004 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.969 | L2-Norm(final)=13.056 | 4768.0 samples/s | 74.5 steps/s
[Step=19650 Epoch=95.8] | Loss=0.00971 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.973 | L2-Norm(final)=13.058 | 4886.8 samples/s | 76.4 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00947 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.976 | L2-Norm(final)=13.060 | 4939.7 samples/s | 77.2 steps/s
[Step=19750 Epoch=96.3] | Loss=0.00926 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.980 | L2-Norm(final)=13.062 | 2613.5 samples/s | 40.8 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00903 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.983 | L2-Norm(final)=13.064 | 4900.3 samples/s | 76.6 steps/s
[Step=19850 Epoch=96.8] | Loss=0.00881 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.986 | L2-Norm(final)=13.066 | 4908.9 samples/s | 76.7 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00863 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.989 | L2-Norm(final)=13.068 | 4865.5 samples/s | 76.0 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00878 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.992 | L2-Norm(final)=13.070 | 2629.3 samples/s | 41.1 steps/s
[Step=20000 Epoch=97.5] | Loss=0.00876 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.995 | L2-Norm(final)=13.071 | 4906.6 samples/s | 76.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step20000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=136.5] | Loss=0.02498 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.631 | L2-Norm(final)=14.492 | 5766.6 samples/s | 90.1 steps/s
[Step=28050 Epoch=136.8] | Loss=0.02085 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=14.496 | 4804.3 samples/s | 75.1 steps/s
[Step=28100 Epoch=137.0] | Loss=0.02137 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=14.499 | 5628.4 samples/s | 87.9 steps/s
[Step=28150 Epoch=137.3] | Loss=0.02097 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.631 | L2-Norm(final)=14.502 | 5649.1 samples/s | 88.3 steps/s
[Step=28200 Epoch=137.5] | Loss=0.02319 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.631 | L2-Norm(final)=14.501 | 8684.0 samples/s | 135.7 steps/s
[Step=28250 Epoch=137.8] | Loss=0.02334 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.631 | L2-Norm(final)=14.498 | 2430.2 samples/s | 38.0 steps/s
[Step=28300 Epoch=138.0] | Loss=0.02330 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=14.495 | 5530.8 samples/s | 86.4 steps/s
[Step=28350 Epoch=138.3] | Loss=0.02342 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=14.492 | 5699.8 samples/s | 89.1 steps/s
[Step=28400 Epoch=138.5] | Loss=0.02285 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.631 | L2-Norm(final)=14.490 | 7593.4 samples/s | 118.6 steps/s
[Step=28450 Epoch=138.7] | Loss=0.02283 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=14.489 | 2543.6 samples/s | 39.7 steps/s
[Step=28500 Epoch=139.0] | Loss=0.02285 | Reg=0.00113 | acc=0.9375 | L2-Norm=10.631 | L2-Norm(final)=14.488 | 5569.8 samples/s | 87.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=139.0] | Loss=0.00305 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=14.477 | 5780.2 samples/s | 90.3 steps/s
[Step=28550 Epoch=139.2] | Loss=0.02493 | Reg=0.00114 | acc=0.9531 | L2-Norm=10.668 | L2-Norm(final)=14.472 | 4452.9 samples/s | 69.6 steps/s
[Step=28600 Epoch=139.5] | Loss=0.02666 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.708 | L2-Norm(final)=14.461 | 4795.0 samples/s | 74.9 steps/s
[Step=28650 Epoch=139.7] | Loss=0.02592 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.736 | L2-Norm(final)=14.457 | 4878.3 samples/s | 76.2 steps/s
[Step=28700 Epoch=140.0] | Loss=0.02371 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.758 | L2-Norm(final)=14.455 | 6946.3 samples/s | 108.5 steps/s
[Step=28750 Epoch=140.2] | Loss=0.02036 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.775 | L2-Norm(final)=14.456 | 2284.3 samples/s | 35.7 steps/s
[Step=28800 Epoch=140.4] | Loss=0.01841 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.789 | L2-Norm(final)=14.458 | 4835.3 samples/s | 75.6 steps/s
[Step=28850 Epoch=140.7] | Loss=0.01685 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.801 | L2-Norm(final)=14.460 | 4865.3 samples/s | 76.0 steps/s
[Step=28900 Epoch=140.9] | Loss=0.01621 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=14.461 | 6383.5 samples/s | 99.7 steps/s
[Step=28950 Epoch=141.2] | Loss=0.01500 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.819 | L2-Norm(final)=14.462 | 2330.9 samples/s | 36.4 steps/s
[Step=29000 Epoch=141.4] | Loss=0.01399 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.827 | L2-Norm(final)=14.464 | 4867.1 samples/s | 76.0 steps/s
[Step=29050 Epoch=141.7] | Loss=0.01325 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.833 | L2-Norm(final)=14.465 | 4824.4 samples/s | 75.4 steps/s
[Step=29100 Epoch=141.9] | Loss=0.01268 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.839 | L2-Norm(final)=14.466 | 5849.6 samples/s | 91.4 steps/s
[Step=29150 Epoch=142.2] | Loss=0.01203 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.845 | L2-Norm(final)=14.468 | 2420.2 samples/s | 37.8 steps/s
[Step=29200 Epoch=142.4] | Loss=0.01160 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.850 | L2-Norm(final)=14.470 | 4845.7 samples/s | 75.7 steps/s
[Step=29250 Epoch=142.6] | Loss=0.01107 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.855 | L2-Norm(final)=14.471 | 4896.0 samples/s | 76.5 steps/s
[Step=29300 Epoch=142.9] | Loss=0.01066 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.859 | L2-Norm(final)=14.473 | 5329.8 samples/s | 83.3 steps/s
[Step=29350 Epoch=143.1] | Loss=0.01023 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.863 | L2-Norm(final)=14.475 | 2509.6 samples/s | 39.2 steps/s
[Step=29400 Epoch=143.4] | Loss=0.00985 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.867 | L2-Norm(final)=14.477 | 4508.4 samples/s | 70.4 steps/s
[Step=29450 Epoch=143.6] | Loss=0.00959 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.871 | L2-Norm(final)=14.479 | 4825.7 samples/s | 75.4 steps/s
[Step=29500 Epoch=143.9] | Loss=0.00935 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.874 | L2-Norm(final)=14.480 | 4999.0 samples/s | 78.1 steps/s
[Step=29550 Epoch=144.1] | Loss=0.00902 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.877 | L2-Norm(final)=14.482 | 2633.4 samples/s | 41.1 steps/s
[Step=29600 Epoch=144.3] | Loss=0.00875 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=14.483 | 4800.3 samples/s | 75.0 steps/s
[Step=29650 Epoch=144.6] | Loss=0.00857 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.883 | L2-Norm(final)=14.485 | 4906.4 samples/s | 76.7 steps/s
[Step=29700 Epoch=144.8] | Loss=0.00833 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.886 | L2-Norm(final)=14.487 | 4835.5 samples/s | 75.6 steps/s
[Step=29750 Epoch=145.1] | Loss=0.00812 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.888 | L2-Norm(final)=14.488 | 2639.2 samples/s | 41.2 steps/s
[Step=29800 Epoch=145.3] | Loss=0.00788 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.890 | L2-Norm(final)=14.490 | 4862.6 samples/s | 76.0 steps/s
[Step=29850 Epoch=145.6] | Loss=0.00764 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=14.491 | 4833.1 samples/s | 75.5 steps/s
[Step=29900 Epoch=145.8] | Loss=0.00751 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=14.493 | 4940.5 samples/s | 77.2 steps/s
[Step=29950 Epoch=146.1] | Loss=0.00742 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.897 | L2-Norm(final)=14.495 | 2601.8 samples/s | 40.7 steps/s
[Step=30000 Epoch=146.3] | Loss=0.00729 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.899 | L2-Norm(final)=14.496 | 4881.2 samples/s | 76.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step30000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=265.3] | Loss=0.00003 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=14.851 | 5320.1 samples/s | 83.1 steps/s
[Step=28050 Epoch=265.8] | Loss=0.00064 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=14.862 | 4934.9 samples/s | 77.1 steps/s
[Step=28100 Epoch=266.3] | Loss=0.00073 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=14.873 | 8021.4 samples/s | 125.3 steps/s
[Step=28150 Epoch=266.7] | Loss=0.00063 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=14.885 | 2346.0 samples/s | 36.7 steps/s
[Step=28200 Epoch=267.2] | Loss=0.00069 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=14.895 | 7382.4 samples/s | 115.4 steps/s
[Step=28250 Epoch=267.7] | Loss=0.00062 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=14.906 | 2479.0 samples/s | 38.7 steps/s
[Step=28300 Epoch=268.2] | Loss=0.00064 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=14.916 | 6316.6 samples/s | 98.7 steps/s
[Step=28350 Epoch=268.6] | Loss=0.00065 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=14.927 | 2527.1 samples/s | 39.5 steps/s
[Step=28400 Epoch=269.1] | Loss=0.00067 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=14.937 | 5975.5 samples/s | 93.4 steps/s
[Step=28450 Epoch=269.6] | Loss=0.00065 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=14.948 | 2631.9 samples/s | 41.1 steps/s
[Step=28500 Epoch=270.1] | Loss=0.00066 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=14.959 | 5423.6 samples/s | 84.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=270.1] | Loss=0.00027 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=15.064 | 6042.8 samples/s | 94.4 steps/s
[Step=28550 Epoch=270.5] | Loss=0.00035 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.638 | L2-Norm(final)=15.071 | 4048.0 samples/s | 63.3 steps/s
[Step=28600 Epoch=271.0] | Loss=0.00021 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.646 | L2-Norm(final)=15.076 | 6577.5 samples/s | 102.8 steps/s
[Step=28650 Epoch=271.5] | Loss=0.00014 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.645 | L2-Norm(final)=15.078 | 2203.8 samples/s | 34.4 steps/s
[Step=28700 Epoch=272.0] | Loss=0.00011 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.641 | L2-Norm(final)=15.080 | 6064.0 samples/s | 94.8 steps/s
[Step=28750 Epoch=272.4] | Loss=0.00009 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.635 | L2-Norm(final)=15.082 | 2278.3 samples/s | 35.6 steps/s
[Step=28800 Epoch=272.9] | Loss=0.00007 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=15.083 | 5559.2 samples/s | 86.9 steps/s
[Step=28850 Epoch=273.4] | Loss=0.00006 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.623 | L2-Norm(final)=15.085 | 2336.5 samples/s | 36.5 steps/s
[Step=28900 Epoch=273.9] | Loss=0.00006 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.616 | L2-Norm(final)=15.086 | 5084.4 samples/s | 79.4 steps/s
[Step=28950 Epoch=274.3] | Loss=0.00005 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.609 | L2-Norm(final)=15.088 | 2462.9 samples/s | 38.5 steps/s
[Step=29000 Epoch=274.8] | Loss=0.00005 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.602 | L2-Norm(final)=15.089 | 4710.2 samples/s | 73.6 steps/s
[Step=29050 Epoch=275.3] | Loss=0.00004 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.596 | L2-Norm(final)=15.090 | 2564.8 samples/s | 40.1 steps/s
[Step=29100 Epoch=275.7] | Loss=0.00004 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.589 | L2-Norm(final)=15.091 | 4655.3 samples/s | 72.7 steps/s
[Step=29150 Epoch=276.2] | Loss=0.00004 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.582 | L2-Norm(final)=15.092 | 2579.5 samples/s | 40.3 steps/s
[Step=29200 Epoch=276.7] | Loss=0.00003 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.575 | L2-Norm(final)=15.094 | 4543.4 samples/s | 71.0 steps/s
[Step=29250 Epoch=277.2] | Loss=0.00003 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.568 | L2-Norm(final)=15.095 | 2592.6 samples/s | 40.5 steps/s
[Step=29300 Epoch=277.6] | Loss=0.00003 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.560 | L2-Norm(final)=15.096 | 4664.4 samples/s | 72.9 steps/s
[Step=29350 Epoch=278.1] | Loss=0.00003 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.553 | L2-Norm(final)=15.097 | 2654.2 samples/s | 41.5 steps/s
[Step=29400 Epoch=278.6] | Loss=0.00003 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.546 | L2-Norm(final)=15.098 | 4377.0 samples/s | 68.4 steps/s
[Step=29450 Epoch=279.1] | Loss=0.00003 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.539 | L2-Norm(final)=15.099 | 6901.1 samples/s | 107.8 steps/s
[Step=29500 Epoch=279.5] | Loss=0.00002 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.532 | L2-Norm(final)=15.100 | 2165.5 samples/s | 33.8 steps/s
[Step=29550 Epoch=280.0] | Loss=0.00002 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.525 | L2-Norm(final)=15.101 | 6263.0 samples/s | 97.9 steps/s
[Step=29600 Epoch=280.5] | Loss=0.00002 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.517 | L2-Norm(final)=15.101 | 2280.8 samples/s | 35.6 steps/s
[Step=29650 Epoch=281.0] | Loss=0.00002 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.510 | L2-Norm(final)=15.102 | 5552.4 samples/s | 86.8 steps/s
[Step=29700 Epoch=281.4] | Loss=0.00002 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.503 | L2-Norm(final)=15.103 | 2336.0 samples/s | 36.5 steps/s
[Step=29750 Epoch=281.9] | Loss=0.00002 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=15.104 | 5260.8 samples/s | 82.2 steps/s
[Step=29800 Epoch=282.4] | Loss=0.00002 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.488 | L2-Norm(final)=15.105 | 2431.3 samples/s | 38.0 steps/s
[Step=29850 Epoch=282.9] | Loss=0.00002 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.480 | L2-Norm(final)=15.106 | 4773.4 samples/s | 74.6 steps/s
[Step=29900 Epoch=283.3] | Loss=0.00002 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.473 | L2-Norm(final)=15.107 | 2510.2 samples/s | 39.2 steps/s
[Step=29950 Epoch=283.8] | Loss=0.00002 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.465 | L2-Norm(final)=15.108 | 4640.4 samples/s | 72.5 steps/s
[Step=30000 Epoch=284.3] | Loss=0.00002 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.457 | L2-Norm(final)=15.109 | 2552.4 samples/s | 39.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step30000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=248.3] | Loss=0.00131 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=16.123 | 5385.5 samples/s | 84.1 steps/s
[Step=26050 Epoch=248.8] | Loss=0.00038 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.628 | L2-Norm(final)=16.121 | 4710.9 samples/s | 73.6 steps/s
[Step=26100 Epoch=249.2] | Loss=0.00041 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=16.130 | 8203.3 samples/s | 128.2 steps/s
[Step=26150 Epoch=249.7] | Loss=0.00040 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=16.137 | 2330.2 samples/s | 36.4 steps/s
[Step=26200 Epoch=250.2] | Loss=0.00039 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=16.143 | 7600.9 samples/s | 118.8 steps/s
[Step=26250 Epoch=250.7] | Loss=0.00038 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=16.151 | 2425.4 samples/s | 37.9 steps/s
[Step=26300 Epoch=251.1] | Loss=0.00038 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=16.160 | 6805.3 samples/s | 106.3 steps/s
[Step=26350 Epoch=251.6] | Loss=0.00037 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=16.170 | 2485.3 samples/s | 38.8 steps/s
[Step=26400 Epoch=252.1] | Loss=0.00036 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=16.179 | 6283.6 samples/s | 98.2 steps/s
[Step=26450 Epoch=252.6] | Loss=0.00035 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=16.189 | 2581.1 samples/s | 40.3 steps/s
[Step=26500 Epoch=253.1] | Loss=0.00036 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=16.200 | 5880.7 samples/s | 91.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=253.1] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=16.313 | 5923.8 samples/s | 92.6 steps/s
[Step=26550 Epoch=253.5] | Loss=0.00018 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=16.319 | 4037.3 samples/s | 63.1 steps/s
[Step=26600 Epoch=254.0] | Loss=0.00059 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.645 | L2-Norm(final)=16.324 | 6754.5 samples/s | 105.5 steps/s
[Step=26650 Epoch=254.5] | Loss=0.00088 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.685 | L2-Norm(final)=16.322 | 2196.3 samples/s | 34.3 steps/s
[Step=26700 Epoch=255.0] | Loss=0.00105 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.721 | L2-Norm(final)=16.318 | 5998.6 samples/s | 93.7 steps/s
[Step=26750 Epoch=255.4] | Loss=0.00087 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.748 | L2-Norm(final)=16.315 | 2242.2 samples/s | 35.0 steps/s
[Step=26800 Epoch=255.9] | Loss=0.00075 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.765 | L2-Norm(final)=16.314 | 5779.0 samples/s | 90.3 steps/s
[Step=26850 Epoch=256.4] | Loss=0.00065 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.777 | L2-Norm(final)=16.313 | 2318.8 samples/s | 36.2 steps/s
[Step=26900 Epoch=256.9] | Loss=0.00057 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.784 | L2-Norm(final)=16.313 | 5314.9 samples/s | 83.0 steps/s
[Step=26950 Epoch=257.4] | Loss=0.00051 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.788 | L2-Norm(final)=16.313 | 2422.7 samples/s | 37.9 steps/s
[Step=27000 Epoch=257.8] | Loss=0.00046 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.790 | L2-Norm(final)=16.313 | 4908.7 samples/s | 76.7 steps/s
[Step=27050 Epoch=258.3] | Loss=0.00041 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.791 | L2-Norm(final)=16.313 | 2445.7 samples/s | 38.2 steps/s
[Step=27100 Epoch=258.8] | Loss=0.00038 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.791 | L2-Norm(final)=16.314 | 4731.9 samples/s | 73.9 steps/s
[Step=27150 Epoch=259.3] | Loss=0.00035 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.791 | L2-Norm(final)=16.314 | 2551.1 samples/s | 39.9 steps/s
[Step=27200 Epoch=259.7] | Loss=0.00033 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.789 | L2-Norm(final)=16.314 | 4688.3 samples/s | 73.3 steps/s
[Step=27250 Epoch=260.2] | Loss=0.00030 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.787 | L2-Norm(final)=16.314 | 2561.3 samples/s | 40.0 steps/s
[Step=27300 Epoch=260.7] | Loss=0.00029 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.785 | L2-Norm(final)=16.314 | 4539.1 samples/s | 70.9 steps/s
[Step=27350 Epoch=261.2] | Loss=0.00027 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.782 | L2-Norm(final)=16.315 | 2590.0 samples/s | 40.5 steps/s
[Step=27400 Epoch=261.7] | Loss=0.00025 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.779 | L2-Norm(final)=16.315 | 4625.1 samples/s | 72.3 steps/s
[Step=27450 Epoch=262.1] | Loss=0.00024 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.776 | L2-Norm(final)=16.315 | 2553.2 samples/s | 39.9 steps/s
[Step=27500 Epoch=262.6] | Loss=0.00023 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=16.315 | 4690.5 samples/s | 73.3 steps/s
[Step=27550 Epoch=263.1] | Loss=0.00022 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=16.315 | 7251.1 samples/s | 113.3 steps/s
[Step=27600 Epoch=263.6] | Loss=0.00021 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.765 | L2-Norm(final)=16.316 | 2106.6 samples/s | 32.9 steps/s
[Step=27650 Epoch=264.0] | Loss=0.00020 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.761 | L2-Norm(final)=16.316 | 6843.6 samples/s | 106.9 steps/s
[Step=27700 Epoch=264.5] | Loss=0.00019 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.757 | L2-Norm(final)=16.316 | 2205.0 samples/s | 34.5 steps/s
[Step=27750 Epoch=265.0] | Loss=0.00018 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.753 | L2-Norm(final)=16.316 | 6160.5 samples/s | 96.3 steps/s
[Step=27800 Epoch=265.5] | Loss=0.00018 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.749 | L2-Norm(final)=16.317 | 2236.4 samples/s | 34.9 steps/s
[Step=27850 Epoch=266.0] | Loss=0.00017 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.744 | L2-Norm(final)=16.317 | 5791.5 samples/s | 90.5 steps/s
[Step=27900 Epoch=266.4] | Loss=0.00016 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.740 | L2-Norm(final)=16.317 | 2332.0 samples/s | 36.4 steps/s
[Step=27950 Epoch=266.9] | Loss=0.00016 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.735 | L2-Norm(final)=16.317 | 5299.7 samples/s | 82.8 steps/s
[Step=28000 Epoch=267.4] | Loss=0.00015 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.731 | L2-Norm(final)=16.317 | 2359.5 samples/s | 36.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step28000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=207.3] | Loss=0.00113 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=14.448 | 5935.4 samples/s | 92.7 steps/s
[Step=22050 Epoch=207.8] | Loss=0.00134 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.628 | L2-Norm(final)=14.465 | 4490.9 samples/s | 70.2 steps/s
[Step=22100 Epoch=208.2] | Loss=0.00108 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=14.485 | 8128.3 samples/s | 127.0 steps/s
[Step=22150 Epoch=208.7] | Loss=0.00115 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=14.503 | 2359.5 samples/s | 36.9 steps/s
[Step=22200 Epoch=209.2] | Loss=0.00115 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=14.521 | 7123.3 samples/s | 111.3 steps/s
[Step=22250 Epoch=209.7] | Loss=0.00110 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=14.537 | 2436.2 samples/s | 38.1 steps/s
[Step=22300 Epoch=210.1] | Loss=0.00109 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=14.553 | 6359.1 samples/s | 99.4 steps/s
[Step=22350 Epoch=210.6] | Loss=0.00108 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=14.569 | 2560.9 samples/s | 40.0 steps/s
[Step=22400 Epoch=211.1] | Loss=0.00103 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=14.585 | 5687.8 samples/s | 88.9 steps/s
[Step=22450 Epoch=211.5] | Loss=0.00109 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=14.601 | 2710.0 samples/s | 42.3 steps/s
[Step=22500 Epoch=212.0] | Loss=0.00109 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=14.618 | 5315.6 samples/s | 83.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=212.0] | Loss=0.00064 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=14.784 | 5548.4 samples/s | 86.7 steps/s
[Step=22550 Epoch=212.5] | Loss=0.00195 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.680 | L2-Norm(final)=14.793 | 4193.8 samples/s | 65.5 steps/s
[Step=22600 Epoch=213.0] | Loss=0.00327 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.747 | L2-Norm(final)=14.788 | 6669.7 samples/s | 104.2 steps/s
[Step=22650 Epoch=213.4] | Loss=0.00269 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.795 | L2-Norm(final)=14.783 | 2229.4 samples/s | 34.8 steps/s
[Step=22700 Epoch=213.9] | Loss=0.00210 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.825 | L2-Norm(final)=14.780 | 5882.7 samples/s | 91.9 steps/s
[Step=22750 Epoch=214.4] | Loss=0.00168 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.842 | L2-Norm(final)=14.779 | 2289.0 samples/s | 35.8 steps/s
[Step=22800 Epoch=214.8] | Loss=0.00141 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.852 | L2-Norm(final)=14.778 | 5369.8 samples/s | 83.9 steps/s
[Step=22850 Epoch=215.3] | Loss=0.00121 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.858 | L2-Norm(final)=14.777 | 2424.2 samples/s | 37.9 steps/s
[Step=22900 Epoch=215.8] | Loss=0.00106 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.861 | L2-Norm(final)=14.777 | 4844.8 samples/s | 75.7 steps/s
[Step=22950 Epoch=216.3] | Loss=0.00094 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.862 | L2-Norm(final)=14.777 | 2499.0 samples/s | 39.0 steps/s
[Step=23000 Epoch=216.7] | Loss=0.00085 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.863 | L2-Norm(final)=14.777 | 4696.0 samples/s | 73.4 steps/s
[Step=23050 Epoch=217.2] | Loss=0.00077 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.862 | L2-Norm(final)=14.777 | 2546.6 samples/s | 39.8 steps/s
[Step=23100 Epoch=217.7] | Loss=0.00071 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.861 | L2-Norm(final)=14.777 | 4698.4 samples/s | 73.4 steps/s
[Step=23150 Epoch=218.1] | Loss=0.00065 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.859 | L2-Norm(final)=14.778 | 2546.2 samples/s | 39.8 steps/s
[Step=23200 Epoch=218.6] | Loss=0.00061 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=14.778 | 4598.4 samples/s | 71.8 steps/s
[Step=23250 Epoch=219.1] | Loss=0.00057 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.854 | L2-Norm(final)=14.778 | 2768.3 samples/s | 43.3 steps/s
[Step=23300 Epoch=219.6] | Loss=0.00053 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.851 | L2-Norm(final)=14.778 | 4089.3 samples/s | 63.9 steps/s
[Step=23350 Epoch=220.0] | Loss=0.00050 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.849 | L2-Norm(final)=14.778 | 6715.6 samples/s | 104.9 steps/s
[Step=23400 Epoch=220.5] | Loss=0.00047 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.845 | L2-Norm(final)=14.779 | 2193.0 samples/s | 34.3 steps/s
[Step=23450 Epoch=221.0] | Loss=0.00045 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.842 | L2-Norm(final)=14.779 | 5968.4 samples/s | 93.3 steps/s
[Step=23500 Epoch=221.4] | Loss=0.00043 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.839 | L2-Norm(final)=14.779 | 2292.9 samples/s | 35.8 steps/s
[Step=23550 Epoch=221.9] | Loss=0.00041 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.835 | L2-Norm(final)=14.779 | 5416.7 samples/s | 84.6 steps/s
[Step=23600 Epoch=222.4] | Loss=0.00039 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.832 | L2-Norm(final)=14.780 | 2378.3 samples/s | 37.2 steps/s
[Step=23650 Epoch=222.9] | Loss=0.00037 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.828 | L2-Norm(final)=14.780 | 4963.3 samples/s | 77.6 steps/s
[Step=23700 Epoch=223.3] | Loss=0.00036 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.824 | L2-Norm(final)=14.780 | 2477.2 samples/s | 38.7 steps/s
[Step=23750 Epoch=223.8] | Loss=0.00034 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.820 | L2-Norm(final)=14.781 | 4647.4 samples/s | 72.6 steps/s
[Step=23800 Epoch=224.3] | Loss=0.00033 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.816 | L2-Norm(final)=14.781 | 2588.7 samples/s | 40.4 steps/s
[Step=23850 Epoch=224.7] | Loss=0.00032 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.812 | L2-Norm(final)=14.781 | 4630.4 samples/s | 72.3 steps/s
[Step=23900 Epoch=225.2] | Loss=0.00031 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.808 | L2-Norm(final)=14.782 | 2571.0 samples/s | 40.2 steps/s
[Step=23950 Epoch=225.7] | Loss=0.00030 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.804 | L2-Norm(final)=14.782 | 4618.8 samples/s | 72.2 steps/s
[Step=24000 Epoch=226.1] | Loss=0.00029 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.800 | L2-Norm(final)=14.782 | 2719.0 samples/s | 42.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08390 | acc=0.9587 | tpr=0.9676 | fpr=0.0605 | 5708.1 samples/s | 22.3 steps/s
Avg test loss: 0.08958, Avg test acc: 0.95653, Avg tpr: 0.96584, Avg fpr: 0.06397, total FA: 499

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10306 | acc=0.9609 | tpr=0.9776 | fpr=0.0753 | 5650.3 samples/s | 22.1 steps/s
Avg test loss: 0.10702, Avg test acc: 0.96029, Avg tpr: 0.97546, Avg fpr: 0.07307, total FA: 570

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.10462 | acc=0.9590 | tpr=0.9694 | fpr=0.0637 | 5592.2 samples/s | 21.8 steps/s
Avg test loss: 0.10788, Avg test acc: 0.95765, Avg tpr: 0.96748, Avg fpr: 0.06397, total FA: 499

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10479 | acc=0.9605 | tpr=0.9827 | fpr=0.0877 | 5787.3 samples/s | 22.6 steps/s
Avg test loss: 0.11278, Avg test acc: 0.95857, Avg tpr: 0.98164, Avg fpr: 0.09217, total FA: 719

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09488 | acc=0.9594 | tpr=0.9692 | fpr=0.0619 | 5691.0 samples/s | 22.2 steps/s
Avg test loss: 0.10563, Avg test acc: 0.95837, Avg tpr: 0.96754, Avg fpr: 0.06179, total FA: 482

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.58037 | acc=0.2452 | tpr=0.0062 | fpr=0.2356 | 5571.2 samples/s | 21.8 steps/s
Avg test loss: 5.58477, Avg test acc: 0.24301, Avg tpr: 0.00688, Avg fpr: 0.23766, total FA: 1854

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.66786 | acc=0.2839 | tpr=0.0154 | fpr=0.1331 | 5580.6 samples/s | 21.8 steps/s
Avg test loss: 4.67592, Avg test acc: 0.28255, Avg tpr: 0.01562, Avg fpr: 0.13037, total FA: 1017

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=6.41802 | acc=0.2527 | tpr=0.0151 | fpr=0.2312 | 5685.8 samples/s | 22.2 steps/s
Avg test loss: 6.43190, Avg test acc: 0.25118, Avg tpr: 0.01550, Avg fpr: 0.23048, total FA: 1798

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.69425 | acc=0.2691 | tpr=0.0102 | fpr=0.1687 | 5294.2 samples/s | 20.7 steps/s
Avg test loss: 5.69188, Avg test acc: 0.26809, Avg tpr: 0.01049, Avg fpr: 0.16536, total FA: 1290

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.57109 | acc=0.2593 | tpr=0.0110 | fpr=0.2014 | 5601.3 samples/s | 21.9 steps/s
Avg test loss: 5.58360, Avg test acc: 0.25900, Avg tpr: 0.01148, Avg fpr: 0.19664, total FA: 1534

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.86333 | acc=0.1617 | tpr=0.2124 | fpr=0.8392 | 5843.6 samples/s | 22.8 steps/s
[Step= 100] | Loss=4.81094 | acc=0.1636 | tpr=0.1876 | fpr=0.8369 | 7931.7 samples/s | 31.0 steps/s
[Step= 150] | Loss=4.82047 | acc=0.1627 | tpr=0.1816 | fpr=0.8377 | 8069.0 samples/s | 31.5 steps/s
[Step= 200] | Loss=4.81448 | acc=0.1628 | tpr=0.1803 | fpr=0.8376 | 8165.6 samples/s | 31.9 steps/s
[Step= 250] | Loss=4.81907 | acc=0.1631 | tpr=0.1817 | fpr=0.8373 | 7417.2 samples/s | 29.0 steps/s
[Step= 300] | Loss=4.82232 | acc=0.1623 | tpr=0.1818 | fpr=0.8381 | 8379.3 samples/s | 32.7 steps/s
[Step= 350] | Loss=4.82270 | acc=0.1620 | tpr=0.1741 | fpr=0.8382 | 8063.3 samples/s | 31.5 steps/s
[Step= 400] | Loss=4.82170 | acc=0.1624 | tpr=0.1751 | fpr=0.8379 | 7675.8 samples/s | 30.0 steps/s
[Step= 450] | Loss=4.81990 | acc=0.1622 | tpr=0.1719 | fpr=0.8379 | 8437.7 samples/s | 33.0 steps/s
[Step= 500] | Loss=4.82154 | acc=0.1623 | tpr=0.1731 | fpr=0.8379 | 8312.8 samples/s | 32.5 steps/s
[Step= 550] | Loss=4.81946 | acc=0.1626 | tpr=0.1719 | fpr=0.8376 | 9745.0 samples/s | 38.1 steps/s
Avg test loss: 4.81938, Avg test acc: 0.16249, Avg tpr: 0.17155, Avg fpr: 0.83767, total FA: 116309

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.16969 | acc=0.1306 | tpr=0.2655 | fpr=0.8718 | 5670.1 samples/s | 22.1 steps/s
[Step= 100] | Loss=6.11946 | acc=0.1324 | tpr=0.2260 | fpr=0.8693 | 7896.0 samples/s | 30.8 steps/s
[Step= 150] | Loss=6.13457 | acc=0.1300 | tpr=0.2147 | fpr=0.8715 | 7860.4 samples/s | 30.7 steps/s
[Step= 200] | Loss=6.13375 | acc=0.1296 | tpr=0.2077 | fpr=0.8718 | 8343.4 samples/s | 32.6 steps/s
[Step= 250] | Loss=6.14068 | acc=0.1299 | tpr=0.2122 | fpr=0.8716 | 8130.8 samples/s | 31.8 steps/s
[Step= 300] | Loss=6.14433 | acc=0.1294 | tpr=0.2124 | fpr=0.8721 | 8196.8 samples/s | 32.0 steps/s
[Step= 350] | Loss=6.14693 | acc=0.1290 | tpr=0.1997 | fpr=0.8723 | 7829.9 samples/s | 30.6 steps/s
[Step= 400] | Loss=6.14558 | acc=0.1295 | tpr=0.2008 | fpr=0.8718 | 8019.6 samples/s | 31.3 steps/s
[Step= 450] | Loss=6.14674 | acc=0.1296 | tpr=0.1986 | fpr=0.8717 | 7712.2 samples/s | 30.1 steps/s
[Step= 500] | Loss=6.14705 | acc=0.1297 | tpr=0.2000 | fpr=0.8716 | 8309.8 samples/s | 32.5 steps/s
[Step= 550] | Loss=6.14479 | acc=0.1297 | tpr=0.1994 | fpr=0.8716 | 11240.2 samples/s | 43.9 steps/s
Avg test loss: 6.14515, Avg test acc: 0.12962, Avg tpr: 0.20008, Avg fpr: 0.87167, total FA: 121029

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.24211 | acc=0.1352 | tpr=0.1195 | fpr=0.8645 | 5600.7 samples/s | 21.9 steps/s
[Step= 100] | Loss=6.18489 | acc=0.1359 | tpr=0.1045 | fpr=0.8635 | 8017.0 samples/s | 31.3 steps/s
[Step= 150] | Loss=6.18882 | acc=0.1359 | tpr=0.1081 | fpr=0.8636 | 7826.7 samples/s | 30.6 steps/s
[Step= 200] | Loss=6.17759 | acc=0.1365 | tpr=0.1082 | fpr=0.8630 | 8387.9 samples/s | 32.8 steps/s
[Step= 250] | Loss=6.17737 | acc=0.1368 | tpr=0.1083 | fpr=0.8627 | 8409.7 samples/s | 32.9 steps/s
[Step= 300] | Loss=6.18465 | acc=0.1364 | tpr=0.1084 | fpr=0.8631 | 7548.6 samples/s | 29.5 steps/s
[Step= 350] | Loss=6.18810 | acc=0.1356 | tpr=0.1046 | fpr=0.8639 | 7883.5 samples/s | 30.8 steps/s
[Step= 400] | Loss=6.18626 | acc=0.1360 | tpr=0.1100 | fpr=0.8635 | 8696.5 samples/s | 34.0 steps/s
[Step= 450] | Loss=6.18545 | acc=0.1362 | tpr=0.1095 | fpr=0.8634 | 8284.3 samples/s | 32.4 steps/s
[Step= 500] | Loss=6.18736 | acc=0.1359 | tpr=0.1101 | fpr=0.8636 | 7812.0 samples/s | 30.5 steps/s
[Step= 550] | Loss=6.18250 | acc=0.1363 | tpr=0.1090 | fpr=0.8632 | 10300.8 samples/s | 40.2 steps/s
Avg test loss: 6.18253, Avg test acc: 0.13614, Avg tpr: 0.10935, Avg fpr: 0.86337, total FA: 119877

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.19273 | acc=0.1215 | tpr=0.3319 | fpr=0.8823 | 5679.9 samples/s | 22.2 steps/s
[Step= 100] | Loss=6.14853 | acc=0.1219 | tpr=0.2964 | fpr=0.8813 | 7645.1 samples/s | 29.9 steps/s
[Step= 150] | Loss=6.16660 | acc=0.1211 | tpr=0.2911 | fpr=0.8820 | 8063.6 samples/s | 31.5 steps/s
[Step= 200] | Loss=6.15687 | acc=0.1211 | tpr=0.2973 | fpr=0.8821 | 8300.2 samples/s | 32.4 steps/s
[Step= 250] | Loss=6.16103 | acc=0.1214 | tpr=0.3013 | fpr=0.8819 | 7809.9 samples/s | 30.5 steps/s
[Step= 300] | Loss=6.16518 | acc=0.1204 | tpr=0.2989 | fpr=0.8829 | 7850.4 samples/s | 30.7 steps/s
[Step= 350] | Loss=6.16603 | acc=0.1197 | tpr=0.2824 | fpr=0.8833 | 8258.8 samples/s | 32.3 steps/s
[Step= 400] | Loss=6.16443 | acc=0.1197 | tpr=0.2872 | fpr=0.8833 | 7647.8 samples/s | 29.9 steps/s
[Step= 450] | Loss=6.16456 | acc=0.1200 | tpr=0.2882 | fpr=0.8831 | 8737.3 samples/s | 34.1 steps/s
[Step= 500] | Loss=6.16961 | acc=0.1200 | tpr=0.2899 | fpr=0.8831 | 7636.1 samples/s | 29.8 steps/s
[Step= 550] | Loss=6.16576 | acc=0.1200 | tpr=0.2869 | fpr=0.8830 | 11168.0 samples/s | 43.6 steps/s
Avg test loss: 6.16501, Avg test acc: 0.11992, Avg tpr: 0.28764, Avg fpr: 0.88313, total FA: 122621

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.40308 | acc=0.1317 | tpr=0.1770 | fpr=0.8691 | 5790.3 samples/s | 22.6 steps/s
[Step= 100] | Loss=6.35190 | acc=0.1328 | tpr=0.1684 | fpr=0.8679 | 8019.6 samples/s | 31.3 steps/s
[Step= 150] | Loss=6.37099 | acc=0.1328 | tpr=0.1513 | fpr=0.8675 | 8014.0 samples/s | 31.3 steps/s
[Step= 200] | Loss=6.36385 | acc=0.1331 | tpr=0.1399 | fpr=0.8670 | 7664.0 samples/s | 29.9 steps/s
[Step= 250] | Loss=6.37251 | acc=0.1331 | tpr=0.1397 | fpr=0.8670 | 8297.0 samples/s | 32.4 steps/s
[Step= 300] | Loss=6.37401 | acc=0.1325 | tpr=0.1375 | fpr=0.8676 | 8238.8 samples/s | 32.2 steps/s
[Step= 350] | Loss=6.37759 | acc=0.1318 | tpr=0.1315 | fpr=0.8682 | 8183.2 samples/s | 32.0 steps/s
[Step= 400] | Loss=6.37645 | acc=0.1323 | tpr=0.1318 | fpr=0.8677 | 7905.9 samples/s | 30.9 steps/s
[Step= 450] | Loss=6.37624 | acc=0.1325 | tpr=0.1329 | fpr=0.8675 | 8220.9 samples/s | 32.1 steps/s
[Step= 500] | Loss=6.37961 | acc=0.1322 | tpr=0.1335 | fpr=0.8678 | 8273.4 samples/s | 32.3 steps/s
[Step= 550] | Loss=6.37622 | acc=0.1322 | tpr=0.1321 | fpr=0.8678 | 9544.6 samples/s | 37.3 steps/s
Avg test loss: 6.37535, Avg test acc: 0.13204, Avg tpr: 0.13273, Avg fpr: 0.86797, total FA: 120516

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10197 | acc=0.9820 | tpr=0.9248 | fpr=0.0169 | 5767.2 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.10327 | acc=0.9821 | tpr=0.9318 | fpr=0.0170 | 8018.6 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.10646 | acc=0.9814 | tpr=0.9366 | fpr=0.0178 | 7542.6 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.10821 | acc=0.9811 | tpr=0.9432 | fpr=0.0182 | 7896.0 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.10878 | acc=0.9809 | tpr=0.9389 | fpr=0.0183 | 8219.8 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.10990 | acc=0.9808 | tpr=0.9375 | fpr=0.0184 | 7919.0 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.11015 | acc=0.9809 | tpr=0.9399 | fpr=0.0184 | 8224.6 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.11097 | acc=0.9806 | tpr=0.9365 | fpr=0.0186 | 8094.9 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.11323 | acc=0.9802 | tpr=0.9352 | fpr=0.0190 | 8113.7 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.11220 | acc=0.9804 | tpr=0.9383 | fpr=0.0188 | 8357.4 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.11141 | acc=0.9805 | tpr=0.9379 | fpr=0.0187 | 9941.5 samples/s | 38.8 steps/s
Avg test loss: 0.11119, Avg test acc: 0.98055, Avg tpr: 0.93780, Avg fpr: 0.01867, total FA: 2592

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10860 | acc=0.9806 | tpr=0.8982 | fpr=0.0179 | 5857.4 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.11089 | acc=0.9807 | tpr=0.9254 | fpr=0.0183 | 7729.7 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.11510 | acc=0.9801 | tpr=0.9308 | fpr=0.0190 | 7649.9 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.11719 | acc=0.9800 | tpr=0.9344 | fpr=0.0191 | 8219.4 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.11769 | acc=0.9799 | tpr=0.9310 | fpr=0.0192 | 8347.0 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.11940 | acc=0.9797 | tpr=0.9309 | fpr=0.0194 | 7853.3 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.11970 | acc=0.9795 | tpr=0.9311 | fpr=0.0196 | 8701.9 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.12077 | acc=0.9794 | tpr=0.9267 | fpr=0.0197 | 7999.7 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.12283 | acc=0.9791 | tpr=0.9250 | fpr=0.0199 | 8302.2 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.12201 | acc=0.9792 | tpr=0.9273 | fpr=0.0199 | 7808.6 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.12109 | acc=0.9793 | tpr=0.9260 | fpr=0.0198 | 9522.7 samples/s | 37.2 steps/s
Avg test loss: 0.12086, Avg test acc: 0.97927, Avg tpr: 0.92591, Avg fpr: 0.01976, total FA: 2743

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12979 | acc=0.9766 | tpr=0.9425 | fpr=0.0228 | 5731.7 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.12947 | acc=0.9767 | tpr=0.9552 | fpr=0.0229 | 8084.6 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.13476 | acc=0.9761 | tpr=0.9597 | fpr=0.0236 | 7508.2 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.13641 | acc=0.9764 | tpr=0.9617 | fpr=0.0233 | 8353.6 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.13682 | acc=0.9765 | tpr=0.9590 | fpr=0.0232 | 7984.5 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.13929 | acc=0.9762 | tpr=0.9520 | fpr=0.0233 | 8080.3 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.13936 | acc=0.9762 | tpr=0.9512 | fpr=0.0233 | 7310.0 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.14042 | acc=0.9760 | tpr=0.9486 | fpr=0.0235 | 8611.7 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.14182 | acc=0.9757 | tpr=0.9484 | fpr=0.0238 | 8628.6 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.14085 | acc=0.9757 | tpr=0.9498 | fpr=0.0238 | 7731.3 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.13990 | acc=0.9758 | tpr=0.9491 | fpr=0.0238 | 10404.9 samples/s | 40.6 steps/s
Avg test loss: 0.13982, Avg test acc: 0.97578, Avg tpr: 0.94889, Avg fpr: 0.02373, total FA: 3295

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10613 | acc=0.9799 | tpr=0.9159 | fpr=0.0189 | 5785.4 samples/s | 22.6 steps/s
[Step= 100] | Loss=0.10777 | acc=0.9796 | tpr=0.9254 | fpr=0.0194 | 8038.8 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.11085 | acc=0.9795 | tpr=0.9352 | fpr=0.0197 | 7903.4 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.11281 | acc=0.9794 | tpr=0.9366 | fpr=0.0198 | 7513.0 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.11233 | acc=0.9796 | tpr=0.9284 | fpr=0.0195 | 8183.5 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.11436 | acc=0.9797 | tpr=0.9287 | fpr=0.0194 | 8646.1 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.11458 | acc=0.9797 | tpr=0.9317 | fpr=0.0194 | 8043.4 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.11551 | acc=0.9798 | tpr=0.9316 | fpr=0.0194 | 7907.9 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.11795 | acc=0.9793 | tpr=0.9294 | fpr=0.0198 | 8511.4 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.11695 | acc=0.9795 | tpr=0.9322 | fpr=0.0197 | 8260.3 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.11608 | acc=0.9796 | tpr=0.9316 | fpr=0.0195 | 9402.7 samples/s | 36.7 steps/s
Avg test loss: 0.11591, Avg test acc: 0.97961, Avg tpr: 0.93106, Avg fpr: 0.01951, total FA: 2709

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.09853 | acc=0.9816 | tpr=0.9159 | fpr=0.0173 | 5788.2 samples/s | 22.6 steps/s
[Step= 100] | Loss=0.10177 | acc=0.9814 | tpr=0.9339 | fpr=0.0177 | 7391.7 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.10529 | acc=0.9810 | tpr=0.9395 | fpr=0.0183 | 7658.3 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.10680 | acc=0.9809 | tpr=0.9443 | fpr=0.0184 | 8135.9 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.10750 | acc=0.9808 | tpr=0.9406 | fpr=0.0185 | 7825.3 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.10867 | acc=0.9807 | tpr=0.9396 | fpr=0.0185 | 8346.9 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.10891 | acc=0.9807 | tpr=0.9418 | fpr=0.0186 | 7973.0 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.10962 | acc=0.9806 | tpr=0.9387 | fpr=0.0186 | 7913.5 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.11152 | acc=0.9803 | tpr=0.9362 | fpr=0.0189 | 8051.8 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.11071 | acc=0.9805 | tpr=0.9379 | fpr=0.0188 | 8221.8 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.11005 | acc=0.9805 | tpr=0.9363 | fpr=0.0187 | 11584.5 samples/s | 45.3 steps/s
Avg test loss: 0.10987, Avg test acc: 0.98049, Avg tpr: 0.93582, Avg fpr: 0.01870, total FA: 2596

server round 27/50

clients selected: [0 1 2 3 4]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.01746 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.621 | L2-Norm(final)=13.110 | 5829.2 samples/s | 91.1 steps/s
[Step=20050 Epoch=97.8] | Loss=0.01739 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.624 | L2-Norm(final)=13.119 | 5177.8 samples/s | 80.9 steps/s
[Step=20100 Epoch=98.0] | Loss=0.01803 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.624 | L2-Norm(final)=13.124 | 5513.7 samples/s | 86.2 steps/s
[Step=20150 Epoch=98.3] | Loss=0.02063 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.624 | L2-Norm(final)=13.129 | 5596.7 samples/s | 87.4 steps/s
[Step=20200 Epoch=98.5] | Loss=0.02154 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.624 | L2-Norm(final)=13.132 | 8786.4 samples/s | 137.3 steps/s
[Step=20250 Epoch=98.7] | Loss=0.02124 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.624 | L2-Norm(final)=13.134 | 2436.0 samples/s | 38.1 steps/s
[Step=20300 Epoch=99.0] | Loss=0.02108 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=13.137 | 5696.5 samples/s | 89.0 steps/s
[Step=20350 Epoch=99.2] | Loss=0.02105 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.624 | L2-Norm(final)=13.140 | 5655.3 samples/s | 88.4 steps/s
[Step=20400 Epoch=99.5] | Loss=0.02126 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=13.143 | 7655.1 samples/s | 119.6 steps/s
[Step=20450 Epoch=99.7] | Loss=0.02117 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.624 | L2-Norm(final)=13.145 | 2598.8 samples/s | 40.6 steps/s
[Step=20500 Epoch=100.0] | Loss=0.02105 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=13.148 | 5387.4 samples/s | 84.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=100.0] | Loss=0.00242 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=13.177 | 6317.0 samples/s | 98.7 steps/s
[Step=20550 Epoch=100.2] | Loss=0.02211 | Reg=0.00114 | acc=0.9688 | L2-Norm=10.655 | L2-Norm(final)=13.175 | 4151.1 samples/s | 64.9 steps/s
[Step=20600 Epoch=100.4] | Loss=0.02147 | Reg=0.00114 | acc=0.9844 | L2-Norm=10.685 | L2-Norm(final)=13.172 | 4885.1 samples/s | 76.3 steps/s
[Step=20650 Epoch=100.7] | Loss=0.02379 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.709 | L2-Norm(final)=13.169 | 4881.3 samples/s | 76.3 steps/s
[Step=20700 Epoch=100.9] | Loss=0.02282 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.731 | L2-Norm(final)=13.167 | 6955.0 samples/s | 108.7 steps/s
[Step=20750 Epoch=101.2] | Loss=0.01984 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.749 | L2-Norm(final)=13.168 | 2281.3 samples/s | 35.6 steps/s
[Step=20800 Epoch=101.4] | Loss=0.01757 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.763 | L2-Norm(final)=13.170 | 4800.4 samples/s | 75.0 steps/s
[Step=20850 Epoch=101.7] | Loss=0.01627 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.774 | L2-Norm(final)=13.173 | 4822.2 samples/s | 75.3 steps/s
[Step=20900 Epoch=101.9] | Loss=0.01535 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.784 | L2-Norm(final)=13.175 | 6363.9 samples/s | 99.4 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01469 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.794 | L2-Norm(final)=13.178 | 2352.0 samples/s | 36.8 steps/s
[Step=21000 Epoch=102.4] | Loss=0.01391 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.805 | L2-Norm(final)=13.181 | 4874.4 samples/s | 76.2 steps/s
[Step=21050 Epoch=102.6] | Loss=0.01334 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.815 | L2-Norm(final)=13.185 | 4801.5 samples/s | 75.0 steps/s
[Step=21100 Epoch=102.9] | Loss=0.01277 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.824 | L2-Norm(final)=13.188 | 5809.7 samples/s | 90.8 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01206 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.832 | L2-Norm(final)=13.191 | 2419.7 samples/s | 37.8 steps/s
[Step=21200 Epoch=103.4] | Loss=0.01164 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.839 | L2-Norm(final)=13.194 | 4938.4 samples/s | 77.2 steps/s
[Step=21250 Epoch=103.6] | Loss=0.01121 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.846 | L2-Norm(final)=13.197 | 4782.1 samples/s | 74.7 steps/s
[Step=21300 Epoch=103.9] | Loss=0.01087 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.852 | L2-Norm(final)=13.200 | 5386.1 samples/s | 84.2 steps/s
[Step=21350 Epoch=104.1] | Loss=0.01053 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.858 | L2-Norm(final)=13.202 | 2510.6 samples/s | 39.2 steps/s
[Step=21400 Epoch=104.4] | Loss=0.01024 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.863 | L2-Norm(final)=13.205 | 4903.7 samples/s | 76.6 steps/s
[Step=21450 Epoch=104.6] | Loss=0.00994 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.868 | L2-Norm(final)=13.207 | 4834.6 samples/s | 75.5 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00957 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.873 | L2-Norm(final)=13.210 | 5017.6 samples/s | 78.4 steps/s
[Step=21550 Epoch=105.1] | Loss=0.00950 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.878 | L2-Norm(final)=13.212 | 2638.2 samples/s | 41.2 steps/s
[Step=21600 Epoch=105.3] | Loss=0.00926 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.882 | L2-Norm(final)=13.214 | 4898.8 samples/s | 76.5 steps/s
[Step=21650 Epoch=105.6] | Loss=0.00905 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.887 | L2-Norm(final)=13.217 | 4812.0 samples/s | 75.2 steps/s
[Step=21700 Epoch=105.8] | Loss=0.00881 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.891 | L2-Norm(final)=13.219 | 4898.6 samples/s | 76.5 steps/s
[Step=21750 Epoch=106.1] | Loss=0.00859 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=13.221 | 2666.1 samples/s | 41.7 steps/s
[Step=21800 Epoch=106.3] | Loss=0.00837 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.899 | L2-Norm(final)=13.223 | 4835.2 samples/s | 75.6 steps/s
[Step=21850 Epoch=106.5] | Loss=0.00822 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.903 | L2-Norm(final)=13.226 | 4854.4 samples/s | 75.9 steps/s
[Step=21900 Epoch=106.8] | Loss=0.00800 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.906 | L2-Norm(final)=13.228 | 4840.6 samples/s | 75.6 steps/s
[Step=21950 Epoch=107.0] | Loss=0.00787 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.909 | L2-Norm(final)=13.230 | 2643.6 samples/s | 41.3 steps/s
[Step=22000 Epoch=107.3] | Loss=0.00772 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.912 | L2-Norm(final)=13.232 | 4897.2 samples/s | 76.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step22000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=36001 Epoch=175.7] | Loss=0.02225 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.621 | L2-Norm(final)=15.324 | 5814.1 samples/s | 90.8 steps/s
[Step=36050 Epoch=175.9] | Loss=0.02125 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.621 | L2-Norm(final)=15.316 | 4836.0 samples/s | 75.6 steps/s
[Step=36100 Epoch=176.2] | Loss=0.02182 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.621 | L2-Norm(final)=15.309 | 5649.9 samples/s | 88.3 steps/s
[Step=36150 Epoch=176.4] | Loss=0.02220 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.621 | L2-Norm(final)=15.302 | 5736.3 samples/s | 89.6 steps/s
[Step=36200 Epoch=176.6] | Loss=0.02316 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.621 | L2-Norm(final)=15.294 | 8537.1 samples/s | 133.4 steps/s
[Step=36250 Epoch=176.9] | Loss=0.02268 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.621 | L2-Norm(final)=15.287 | 2406.2 samples/s | 37.6 steps/s
[Step=36300 Epoch=177.1] | Loss=0.02310 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.621 | L2-Norm(final)=15.280 | 5624.4 samples/s | 87.9 steps/s
[Step=36350 Epoch=177.4] | Loss=0.02299 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.621 | L2-Norm(final)=15.274 | 5595.4 samples/s | 87.4 steps/s
[Step=36400 Epoch=177.6] | Loss=0.02299 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.621 | L2-Norm(final)=15.268 | 8011.4 samples/s | 125.2 steps/s
[Step=36450 Epoch=177.9] | Loss=0.02297 | Reg=0.00113 | acc=0.9219 | L2-Norm=10.621 | L2-Norm(final)=15.262 | 2512.0 samples/s | 39.2 steps/s
[Step=36500 Epoch=178.1] | Loss=0.02297 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.621 | L2-Norm(final)=15.257 | 5621.4 samples/s | 87.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=36501 Epoch=178.1] | Loss=0.00590 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.621 | L2-Norm(final)=15.203 | 6177.0 samples/s | 96.5 steps/s
[Step=36550 Epoch=178.3] | Loss=0.02778 | Reg=0.00114 | acc=0.9375 | L2-Norm=10.663 | L2-Norm(final)=15.194 | 4206.9 samples/s | 65.7 steps/s
[Step=36600 Epoch=178.6] | Loss=0.02718 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.707 | L2-Norm(final)=15.189 | 4849.3 samples/s | 75.8 steps/s
[Step=36650 Epoch=178.8] | Loss=0.02543 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.740 | L2-Norm(final)=15.189 | 4873.6 samples/s | 76.1 steps/s
[Step=36700 Epoch=179.1] | Loss=0.02451 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.766 | L2-Norm(final)=15.189 | 6914.9 samples/s | 108.0 steps/s
[Step=36750 Epoch=179.3] | Loss=0.02155 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.788 | L2-Norm(final)=15.189 | 2275.6 samples/s | 35.6 steps/s
[Step=36800 Epoch=179.6] | Loss=0.01895 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.804 | L2-Norm(final)=15.191 | 4790.5 samples/s | 74.9 steps/s
[Step=36850 Epoch=179.8] | Loss=0.01715 | Reg=0.00117 | acc=0.9688 | L2-Norm=10.818 | L2-Norm(final)=15.193 | 4869.4 samples/s | 76.1 steps/s
[Step=36900 Epoch=180.1] | Loss=0.01601 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.828 | L2-Norm(final)=15.196 | 6449.0 samples/s | 100.8 steps/s
[Step=36950 Epoch=180.3] | Loss=0.01488 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.837 | L2-Norm(final)=15.198 | 2327.9 samples/s | 36.4 steps/s
[Step=37000 Epoch=180.5] | Loss=0.01376 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.845 | L2-Norm(final)=15.200 | 4878.7 samples/s | 76.2 steps/s
[Step=37050 Epoch=180.8] | Loss=0.01295 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.851 | L2-Norm(final)=15.203 | 4920.1 samples/s | 76.9 steps/s
[Step=37100 Epoch=181.0] | Loss=0.01239 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=15.205 | 5913.9 samples/s | 92.4 steps/s
[Step=37150 Epoch=181.3] | Loss=0.01170 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.862 | L2-Norm(final)=15.207 | 2382.5 samples/s | 37.2 steps/s
[Step=37200 Epoch=181.5] | Loss=0.01111 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.867 | L2-Norm(final)=15.210 | 4846.3 samples/s | 75.7 steps/s
[Step=37250 Epoch=181.8] | Loss=0.01060 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.871 | L2-Norm(final)=15.212 | 4866.7 samples/s | 76.0 steps/s
[Step=37300 Epoch=182.0] | Loss=0.01023 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.875 | L2-Norm(final)=15.214 | 5633.1 samples/s | 88.0 steps/s
[Step=37350 Epoch=182.3] | Loss=0.00985 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.879 | L2-Norm(final)=15.216 | 2427.6 samples/s | 37.9 steps/s
[Step=37400 Epoch=182.5] | Loss=0.00948 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.882 | L2-Norm(final)=15.218 | 4943.1 samples/s | 77.2 steps/s
[Step=37450 Epoch=182.7] | Loss=0.00909 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.885 | L2-Norm(final)=15.220 | 4786.7 samples/s | 74.8 steps/s
[Step=37500 Epoch=183.0] | Loss=0.00884 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.888 | L2-Norm(final)=15.222 | 5239.4 samples/s | 81.9 steps/s
[Step=37550 Epoch=183.2] | Loss=0.00853 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.891 | L2-Norm(final)=15.224 | 2543.8 samples/s | 39.7 steps/s
[Step=37600 Epoch=183.5] | Loss=0.00824 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=15.226 | 4904.8 samples/s | 76.6 steps/s
[Step=37650 Epoch=183.7] | Loss=0.00802 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.896 | L2-Norm(final)=15.228 | 4796.7 samples/s | 74.9 steps/s
[Step=37700 Epoch=184.0] | Loss=0.00781 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.898 | L2-Norm(final)=15.230 | 4948.5 samples/s | 77.3 steps/s
[Step=37750 Epoch=184.2] | Loss=0.00761 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.900 | L2-Norm(final)=15.232 | 2590.9 samples/s | 40.5 steps/s
[Step=37800 Epoch=184.4] | Loss=0.00741 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.902 | L2-Norm(final)=15.233 | 4869.6 samples/s | 76.1 steps/s
[Step=37850 Epoch=184.7] | Loss=0.00727 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.904 | L2-Norm(final)=15.235 | 4844.5 samples/s | 75.7 steps/s
[Step=37900 Epoch=184.9] | Loss=0.00711 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.906 | L2-Norm(final)=15.237 | 4916.0 samples/s | 76.8 steps/s
[Step=37950 Epoch=185.2] | Loss=0.00696 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.907 | L2-Norm(final)=15.239 | 2658.3 samples/s | 41.5 steps/s
[Step=38000 Epoch=185.4] | Loss=0.00678 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.909 | L2-Norm(final)=15.240 | 4763.1 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step38000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=116.9] | Loss=0.00899 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.621 | L2-Norm(final)=13.784 | 5776.7 samples/s | 90.3 steps/s
[Step=24050 Epoch=117.2] | Loss=0.02153 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.622 | L2-Norm(final)=13.785 | 4929.1 samples/s | 77.0 steps/s
[Step=24100 Epoch=117.4] | Loss=0.02490 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.622 | L2-Norm(final)=13.777 | 5660.7 samples/s | 88.4 steps/s
[Step=24150 Epoch=117.7] | Loss=0.02331 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.622 | L2-Norm(final)=13.769 | 5717.0 samples/s | 89.3 steps/s
[Step=24200 Epoch=117.9] | Loss=0.02214 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.622 | L2-Norm(final)=13.765 | 8461.7 samples/s | 132.2 steps/s
[Step=24250 Epoch=118.2] | Loss=0.02151 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.622 | L2-Norm(final)=13.765 | 2442.8 samples/s | 38.2 steps/s
[Step=24300 Epoch=118.4] | Loss=0.02187 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.622 | L2-Norm(final)=13.764 | 5728.6 samples/s | 89.5 steps/s
[Step=24350 Epoch=118.6] | Loss=0.02234 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.622 | L2-Norm(final)=13.763 | 5680.7 samples/s | 88.8 steps/s
[Step=24400 Epoch=118.9] | Loss=0.02184 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.622 | L2-Norm(final)=13.761 | 7516.3 samples/s | 117.4 steps/s
[Step=24450 Epoch=119.1] | Loss=0.02170 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.622 | L2-Norm(final)=13.760 | 2537.3 samples/s | 39.6 steps/s
[Step=24500 Epoch=119.4] | Loss=0.02190 | Reg=0.00113 | acc=0.9062 | L2-Norm=10.622 | L2-Norm(final)=13.759 | 5624.5 samples/s | 87.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=119.4] | Loss=0.00823 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.622 | L2-Norm(final)=13.751 | 6012.2 samples/s | 93.9 steps/s
[Step=24550 Epoch=119.6] | Loss=0.02843 | Reg=0.00114 | acc=0.9844 | L2-Norm=10.664 | L2-Norm(final)=13.741 | 4321.1 samples/s | 67.5 steps/s
[Step=24600 Epoch=119.9] | Loss=0.02854 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.704 | L2-Norm(final)=13.733 | 4948.4 samples/s | 77.3 steps/s
[Step=24650 Epoch=120.1] | Loss=0.02505 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.734 | L2-Norm(final)=13.730 | 4720.9 samples/s | 73.8 steps/s
[Step=24700 Epoch=120.4] | Loss=0.02224 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.759 | L2-Norm(final)=13.732 | 6973.4 samples/s | 109.0 steps/s
[Step=24750 Epoch=120.6] | Loss=0.01963 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.779 | L2-Norm(final)=13.734 | 2282.6 samples/s | 35.7 steps/s
[Step=24800 Epoch=120.8] | Loss=0.01774 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.796 | L2-Norm(final)=13.738 | 4942.1 samples/s | 77.2 steps/s
[Step=24850 Epoch=121.1] | Loss=0.01617 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.809 | L2-Norm(final)=13.742 | 4817.3 samples/s | 75.3 steps/s
[Step=24900 Epoch=121.3] | Loss=0.01506 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.821 | L2-Norm(final)=13.745 | 6275.1 samples/s | 98.0 steps/s
[Step=24950 Epoch=121.6] | Loss=0.01419 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.831 | L2-Norm(final)=13.748 | 2345.0 samples/s | 36.6 steps/s
[Step=25000 Epoch=121.8] | Loss=0.01336 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.839 | L2-Norm(final)=13.751 | 4827.5 samples/s | 75.4 steps/s
[Step=25050 Epoch=122.1] | Loss=0.01275 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.847 | L2-Norm(final)=13.754 | 4902.5 samples/s | 76.6 steps/s
[Step=25100 Epoch=122.3] | Loss=0.01209 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.854 | L2-Norm(final)=13.756 | 5772.1 samples/s | 90.2 steps/s
[Step=25150 Epoch=122.5] | Loss=0.01164 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.861 | L2-Norm(final)=13.759 | 2416.3 samples/s | 37.8 steps/s
[Step=25200 Epoch=122.8] | Loss=0.01112 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.867 | L2-Norm(final)=13.762 | 4850.3 samples/s | 75.8 steps/s
[Step=25250 Epoch=123.0] | Loss=0.01075 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.873 | L2-Norm(final)=13.764 | 4858.9 samples/s | 75.9 steps/s
[Step=25300 Epoch=123.3] | Loss=0.01042 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.878 | L2-Norm(final)=13.767 | 5391.4 samples/s | 84.2 steps/s
[Step=25350 Epoch=123.5] | Loss=0.01018 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.883 | L2-Norm(final)=13.769 | 2513.9 samples/s | 39.3 steps/s
[Step=25400 Epoch=123.8] | Loss=0.00989 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.888 | L2-Norm(final)=13.771 | 4839.2 samples/s | 75.6 steps/s
[Step=25450 Epoch=124.0] | Loss=0.00969 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.892 | L2-Norm(final)=13.772 | 4840.9 samples/s | 75.6 steps/s
[Step=25500 Epoch=124.2] | Loss=0.00942 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.896 | L2-Norm(final)=13.774 | 5018.6 samples/s | 78.4 steps/s
[Step=25550 Epoch=124.5] | Loss=0.00912 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.899 | L2-Norm(final)=13.776 | 2614.9 samples/s | 40.9 steps/s
[Step=25600 Epoch=124.7] | Loss=0.00883 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.903 | L2-Norm(final)=13.778 | 4852.9 samples/s | 75.8 steps/s
[Step=25650 Epoch=125.0] | Loss=0.00860 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.907 | L2-Norm(final)=13.780 | 4924.9 samples/s | 77.0 steps/s
[Step=25700 Epoch=125.2] | Loss=0.00848 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.910 | L2-Norm(final)=13.783 | 4785.6 samples/s | 74.8 steps/s
[Step=25750 Epoch=125.5] | Loss=0.00831 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.913 | L2-Norm(final)=13.784 | 2636.7 samples/s | 41.2 steps/s
[Step=25800 Epoch=125.7] | Loss=0.00812 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.916 | L2-Norm(final)=13.786 | 4870.4 samples/s | 76.1 steps/s
[Step=25850 Epoch=126.0] | Loss=0.00797 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.919 | L2-Norm(final)=13.788 | 4920.6 samples/s | 76.9 steps/s
[Step=25900 Epoch=126.2] | Loss=0.00783 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.922 | L2-Norm(final)=13.790 | 4818.2 samples/s | 75.3 steps/s
[Step=25950 Epoch=126.4] | Loss=0.00766 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.925 | L2-Norm(final)=13.792 | 2673.2 samples/s | 41.8 steps/s
[Step=26000 Epoch=126.7] | Loss=0.00747 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.928 | L2-Norm(final)=13.794 | 4885.9 samples/s | 76.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step26000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=30001 Epoch=146.3] | Loss=0.07099 | Reg=0.00113 | acc=0.9531 | L2-Norm=10.621 | L2-Norm(final)=14.538 | 5558.8 samples/s | 86.9 steps/s
[Step=30050 Epoch=146.5] | Loss=0.02182 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.621 | L2-Norm(final)=14.532 | 4998.7 samples/s | 78.1 steps/s
[Step=30100 Epoch=146.8] | Loss=0.02319 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.621 | L2-Norm(final)=14.525 | 5549.3 samples/s | 86.7 steps/s
[Step=30150 Epoch=147.0] | Loss=0.02337 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.621 | L2-Norm(final)=14.518 | 5723.3 samples/s | 89.4 steps/s
[Step=30200 Epoch=147.3] | Loss=0.02327 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.621 | L2-Norm(final)=14.509 | 8619.8 samples/s | 134.7 steps/s
[Step=30250 Epoch=147.5] | Loss=0.02281 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.621 | L2-Norm(final)=14.505 | 2424.7 samples/s | 37.9 steps/s
[Step=30300 Epoch=147.8] | Loss=0.02223 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.621 | L2-Norm(final)=14.501 | 5843.5 samples/s | 91.3 steps/s
[Step=30350 Epoch=148.0] | Loss=0.02192 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.621 | L2-Norm(final)=14.499 | 5503.6 samples/s | 86.0 steps/s
[Step=30400 Epoch=148.2] | Loss=0.02243 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.621 | L2-Norm(final)=14.497 | 7715.9 samples/s | 120.6 steps/s
[Step=30450 Epoch=148.5] | Loss=0.02241 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.621 | L2-Norm(final)=14.494 | 2536.1 samples/s | 39.6 steps/s
[Step=30500 Epoch=148.7] | Loss=0.02210 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.621 | L2-Norm(final)=14.491 | 5611.5 samples/s | 87.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=30501 Epoch=148.7] | Loss=0.02450 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.621 | L2-Norm(final)=14.469 | 6013.6 samples/s | 94.0 steps/s
[Step=30550 Epoch=149.0] | Loss=0.02389 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.667 | L2-Norm(final)=14.465 | 4253.1 samples/s | 66.5 steps/s
[Step=30600 Epoch=149.2] | Loss=0.02449 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.703 | L2-Norm(final)=14.458 | 4877.5 samples/s | 76.2 steps/s
[Step=30650 Epoch=149.5] | Loss=0.02368 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.731 | L2-Norm(final)=14.456 | 4859.0 samples/s | 75.9 steps/s
[Step=30700 Epoch=149.7] | Loss=0.02246 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.754 | L2-Norm(final)=14.455 | 7006.0 samples/s | 109.5 steps/s
[Step=30750 Epoch=150.0] | Loss=0.02012 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.773 | L2-Norm(final)=14.455 | 2261.0 samples/s | 35.3 steps/s
[Step=30800 Epoch=150.2] | Loss=0.01800 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.788 | L2-Norm(final)=14.456 | 4888.0 samples/s | 76.4 steps/s
[Step=30850 Epoch=150.4] | Loss=0.01637 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.801 | L2-Norm(final)=14.459 | 4861.1 samples/s | 76.0 steps/s
[Step=30900 Epoch=150.7] | Loss=0.01536 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=14.461 | 6335.9 samples/s | 99.0 steps/s
[Step=30950 Epoch=150.9] | Loss=0.01439 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.821 | L2-Norm(final)=14.463 | 2331.5 samples/s | 36.4 steps/s
[Step=31000 Epoch=151.2] | Loss=0.01346 | Reg=0.00117 | acc=0.9688 | L2-Norm=10.829 | L2-Norm(final)=14.465 | 4934.0 samples/s | 77.1 steps/s
[Step=31050 Epoch=151.4] | Loss=0.01273 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.836 | L2-Norm(final)=14.467 | 4892.3 samples/s | 76.4 steps/s
[Step=31100 Epoch=151.7] | Loss=0.01230 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.843 | L2-Norm(final)=14.469 | 5698.7 samples/s | 89.0 steps/s
[Step=31150 Epoch=151.9] | Loss=0.01174 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.849 | L2-Norm(final)=14.471 | 2400.0 samples/s | 37.5 steps/s
[Step=31200 Epoch=152.1] | Loss=0.01112 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.855 | L2-Norm(final)=14.473 | 4870.9 samples/s | 76.1 steps/s
[Step=31250 Epoch=152.4] | Loss=0.01074 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.860 | L2-Norm(final)=14.475 | 4936.6 samples/s | 77.1 steps/s
[Step=31300 Epoch=152.6] | Loss=0.01033 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.865 | L2-Norm(final)=14.476 | 5283.6 samples/s | 82.6 steps/s
[Step=31350 Epoch=152.9] | Loss=0.00993 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.869 | L2-Norm(final)=14.478 | 2499.9 samples/s | 39.1 steps/s
[Step=31400 Epoch=153.1] | Loss=0.00960 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.874 | L2-Norm(final)=14.480 | 4940.9 samples/s | 77.2 steps/s
[Step=31450 Epoch=153.4] | Loss=0.00921 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.877 | L2-Norm(final)=14.482 | 4779.9 samples/s | 74.7 steps/s
[Step=31500 Epoch=153.6] | Loss=0.00901 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=14.484 | 5011.5 samples/s | 78.3 steps/s
[Step=31550 Epoch=153.9] | Loss=0.00878 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.885 | L2-Norm(final)=14.486 | 2595.9 samples/s | 40.6 steps/s
[Step=31600 Epoch=154.1] | Loss=0.00851 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.888 | L2-Norm(final)=14.488 | 4833.5 samples/s | 75.5 steps/s
[Step=31650 Epoch=154.3] | Loss=0.00836 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.891 | L2-Norm(final)=14.489 | 4886.4 samples/s | 76.3 steps/s
[Step=31700 Epoch=154.6] | Loss=0.00812 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.894 | L2-Norm(final)=14.491 | 4854.2 samples/s | 75.8 steps/s
[Step=31750 Epoch=154.8] | Loss=0.00792 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.896 | L2-Norm(final)=14.493 | 2675.3 samples/s | 41.8 steps/s
[Step=31800 Epoch=155.1] | Loss=0.00774 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.899 | L2-Norm(final)=14.495 | 4920.9 samples/s | 76.9 steps/s
[Step=31850 Epoch=155.3] | Loss=0.00754 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.902 | L2-Norm(final)=14.496 | 4861.7 samples/s | 76.0 steps/s
[Step=31900 Epoch=155.6] | Loss=0.00744 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.904 | L2-Norm(final)=14.498 | 4782.7 samples/s | 74.7 steps/s
[Step=31950 Epoch=155.8] | Loss=0.00731 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.906 | L2-Norm(final)=14.499 | 2629.8 samples/s | 41.1 steps/s
[Step=32000 Epoch=156.0] | Loss=0.00713 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.909 | L2-Norm(final)=14.501 | 4929.6 samples/s | 77.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step32000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=34001 Epoch=166.7] | Loss=0.00130 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.621 | L2-Norm(final)=14.999 | 5992.4 samples/s | 93.6 steps/s
[Step=34050 Epoch=167.0] | Loss=0.02238 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.622 | L2-Norm(final)=14.999 | 5126.6 samples/s | 80.1 steps/s
[Step=34100 Epoch=167.2] | Loss=0.02512 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.622 | L2-Norm(final)=14.993 | 5722.5 samples/s | 89.4 steps/s
[Step=34150 Epoch=167.5] | Loss=0.02544 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.622 | L2-Norm(final)=14.984 | 5530.0 samples/s | 86.4 steps/s
[Step=34200 Epoch=167.7] | Loss=0.02486 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.622 | L2-Norm(final)=14.978 | 9095.4 samples/s | 142.1 steps/s
[Step=34250 Epoch=168.0] | Loss=0.02448 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.622 | L2-Norm(final)=14.974 | 2434.3 samples/s | 38.0 steps/s
[Step=34300 Epoch=168.2] | Loss=0.02470 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.622 | L2-Norm(final)=14.971 | 5564.3 samples/s | 86.9 steps/s
[Step=34350 Epoch=168.4] | Loss=0.02425 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.622 | L2-Norm(final)=14.968 | 5657.9 samples/s | 88.4 steps/s
[Step=34400 Epoch=168.7] | Loss=0.02376 | Reg=0.00113 | acc=0.9375 | L2-Norm=10.622 | L2-Norm(final)=14.965 | 8113.6 samples/s | 126.8 steps/s
[Step=34450 Epoch=168.9] | Loss=0.02344 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.622 | L2-Norm(final)=14.963 | 2486.5 samples/s | 38.9 steps/s
[Step=34500 Epoch=169.2] | Loss=0.02349 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.622 | L2-Norm(final)=14.962 | 5721.4 samples/s | 89.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=34501 Epoch=169.2] | Loss=0.00929 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.622 | L2-Norm(final)=14.947 | 6101.3 samples/s | 95.3 steps/s
[Step=34550 Epoch=169.4] | Loss=0.02503 | Reg=0.00114 | acc=0.9688 | L2-Norm=10.662 | L2-Norm(final)=14.938 | 4254.2 samples/s | 66.5 steps/s
[Step=34600 Epoch=169.7] | Loss=0.02477 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.703 | L2-Norm(final)=14.934 | 4871.9 samples/s | 76.1 steps/s
[Step=34650 Epoch=169.9] | Loss=0.02409 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.732 | L2-Norm(final)=14.933 | 4881.1 samples/s | 76.3 steps/s
[Step=34700 Epoch=170.2] | Loss=0.02303 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.758 | L2-Norm(final)=14.931 | 7075.4 samples/s | 110.6 steps/s
[Step=34750 Epoch=170.4] | Loss=0.02042 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.779 | L2-Norm(final)=14.931 | 2227.3 samples/s | 34.8 steps/s
[Step=34800 Epoch=170.7] | Loss=0.01834 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.795 | L2-Norm(final)=14.932 | 4866.4 samples/s | 76.0 steps/s
[Step=34850 Epoch=170.9] | Loss=0.01668 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.809 | L2-Norm(final)=14.934 | 4798.8 samples/s | 75.0 steps/s
[Step=34900 Epoch=171.1] | Loss=0.01561 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.820 | L2-Norm(final)=14.936 | 6720.4 samples/s | 105.0 steps/s
[Step=34950 Epoch=171.4] | Loss=0.01447 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.830 | L2-Norm(final)=14.939 | 2296.0 samples/s | 35.9 steps/s
[Step=35000 Epoch=171.6] | Loss=0.01342 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.839 | L2-Norm(final)=14.941 | 4969.5 samples/s | 77.6 steps/s
[Step=35050 Epoch=171.9] | Loss=0.01282 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.846 | L2-Norm(final)=14.943 | 4870.6 samples/s | 76.1 steps/s
[Step=35100 Epoch=172.1] | Loss=0.01221 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.853 | L2-Norm(final)=14.946 | 6154.6 samples/s | 96.2 steps/s
[Step=35150 Epoch=172.4] | Loss=0.01168 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.858 | L2-Norm(final)=14.947 | 2327.9 samples/s | 36.4 steps/s
[Step=35200 Epoch=172.6] | Loss=0.01106 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.863 | L2-Norm(final)=14.949 | 4783.4 samples/s | 74.7 steps/s
[Step=35250 Epoch=172.9] | Loss=0.01057 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.868 | L2-Norm(final)=14.952 | 4948.0 samples/s | 77.3 steps/s
[Step=35300 Epoch=173.1] | Loss=0.01017 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.872 | L2-Norm(final)=14.954 | 5866.7 samples/s | 91.7 steps/s
[Step=35350 Epoch=173.4] | Loss=0.00982 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.876 | L2-Norm(final)=14.956 | 2420.7 samples/s | 37.8 steps/s
[Step=35400 Epoch=173.6] | Loss=0.00956 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=14.958 | 4819.6 samples/s | 75.3 steps/s
[Step=35450 Epoch=173.8] | Loss=0.00926 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.884 | L2-Norm(final)=14.959 | 4882.1 samples/s | 76.3 steps/s
[Step=35500 Epoch=174.1] | Loss=0.00902 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.887 | L2-Norm(final)=14.961 | 5615.8 samples/s | 87.7 steps/s
[Step=35550 Epoch=174.3] | Loss=0.00878 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.890 | L2-Norm(final)=14.963 | 2464.3 samples/s | 38.5 steps/s
[Step=35600 Epoch=174.6] | Loss=0.00854 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.894 | L2-Norm(final)=14.964 | 4921.6 samples/s | 76.9 steps/s
[Step=35650 Epoch=174.8] | Loss=0.00831 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.897 | L2-Norm(final)=14.966 | 4821.9 samples/s | 75.3 steps/s
[Step=35700 Epoch=175.1] | Loss=0.00814 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.899 | L2-Norm(final)=14.967 | 5351.3 samples/s | 83.6 steps/s
[Step=35750 Epoch=175.3] | Loss=0.00792 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.902 | L2-Norm(final)=14.969 | 2534.8 samples/s | 39.6 steps/s
[Step=35800 Epoch=175.6] | Loss=0.00771 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.905 | L2-Norm(final)=14.970 | 4782.5 samples/s | 74.7 steps/s
[Step=35850 Epoch=175.8] | Loss=0.00752 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.907 | L2-Norm(final)=14.972 | 4912.7 samples/s | 76.8 steps/s
[Step=35900 Epoch=176.0] | Loss=0.00737 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.909 | L2-Norm(final)=14.974 | 5054.7 samples/s | 79.0 steps/s
[Step=35950 Epoch=176.3] | Loss=0.00725 | Reg=0.00119 | acc=0.9688 | L2-Norm=10.912 | L2-Norm(final)=14.975 | 2581.0 samples/s | 40.3 steps/s
[Step=36000 Epoch=176.5] | Loss=0.00717 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.914 | L2-Norm(final)=14.976 | 4870.4 samples/s | 76.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09373 | acc=0.9584 | tpr=0.9638 | fpr=0.0535 | 5454.9 samples/s | 21.3 steps/s
Avg test loss: 0.10039, Avg test acc: 0.95781, Avg tpr: 0.96334, Avg fpr: 0.05435, total FA: 424

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09593 | acc=0.9626 | tpr=0.9780 | fpr=0.0709 | 5827.5 samples/s | 22.8 steps/s
Avg test loss: 0.10149, Avg test acc: 0.96174, Avg tpr: 0.97616, Avg fpr: 0.06999, total FA: 546

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.10234 | acc=0.9595 | tpr=0.9735 | fpr=0.0709 | 5637.2 samples/s | 22.0 steps/s
Avg test loss: 0.10627, Avg test acc: 0.95809, Avg tpr: 0.97109, Avg fpr: 0.07050, total FA: 550

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09456 | acc=0.9613 | tpr=0.9741 | fpr=0.0667 | 5658.7 samples/s | 22.1 steps/s
Avg test loss: 0.10150, Avg test acc: 0.96065, Avg tpr: 0.97400, Avg fpr: 0.06871, total FA: 536

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08987 | acc=0.9619 | tpr=0.9730 | fpr=0.0622 | 5626.0 samples/s | 22.0 steps/s
Avg test loss: 0.09938, Avg test acc: 0.95993, Avg tpr: 0.97027, Avg fpr: 0.06281, total FA: 490

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.58037 | acc=0.2452 | tpr=0.0062 | fpr=0.2356 | 5917.1 samples/s | 23.1 steps/s
Avg test loss: 5.58477, Avg test acc: 0.24301, Avg tpr: 0.00688, Avg fpr: 0.23766, total FA: 1854

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.66786 | acc=0.2839 | tpr=0.0154 | fpr=0.1331 | 5756.2 samples/s | 22.5 steps/s
Avg test loss: 4.67592, Avg test acc: 0.28255, Avg tpr: 0.01562, Avg fpr: 0.13037, total FA: 1017

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=6.41802 | acc=0.2527 | tpr=0.0151 | fpr=0.2312 | 5793.0 samples/s | 22.6 steps/s
Avg test loss: 6.43190, Avg test acc: 0.25118, Avg tpr: 0.01550, Avg fpr: 0.23048, total FA: 1798

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.69425 | acc=0.2691 | tpr=0.0102 | fpr=0.1687 | 5771.5 samples/s | 22.5 steps/s
Avg test loss: 5.69188, Avg test acc: 0.26809, Avg tpr: 0.01049, Avg fpr: 0.16536, total FA: 1290

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.57109 | acc=0.2593 | tpr=0.0110 | fpr=0.2014 | 5582.9 samples/s | 21.8 steps/s
Avg test loss: 5.58360, Avg test acc: 0.25900, Avg tpr: 0.01148, Avg fpr: 0.19664, total FA: 1534

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.30941 | acc=0.1659 | tpr=0.2212 | fpr=0.8351 | 5723.7 samples/s | 22.4 steps/s
[Step= 100] | Loss=5.25531 | acc=0.1660 | tpr=0.1940 | fpr=0.8345 | 8004.6 samples/s | 31.3 steps/s
[Step= 150] | Loss=5.26535 | acc=0.1648 | tpr=0.1888 | fpr=0.8356 | 7647.1 samples/s | 29.9 steps/s
[Step= 200] | Loss=5.26213 | acc=0.1646 | tpr=0.1880 | fpr=0.8359 | 8378.6 samples/s | 32.7 steps/s
[Step= 250] | Loss=5.26748 | acc=0.1643 | tpr=0.1939 | fpr=0.8362 | 7972.5 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.26942 | acc=0.1636 | tpr=0.1942 | fpr=0.8369 | 8127.3 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.27159 | acc=0.1635 | tpr=0.1841 | fpr=0.8369 | 8329.0 samples/s | 32.5 steps/s
[Step= 400] | Loss=5.26896 | acc=0.1639 | tpr=0.1849 | fpr=0.8365 | 7885.3 samples/s | 30.8 steps/s
[Step= 450] | Loss=5.26892 | acc=0.1639 | tpr=0.1821 | fpr=0.8364 | 8375.4 samples/s | 32.7 steps/s
[Step= 500] | Loss=5.27251 | acc=0.1638 | tpr=0.1868 | fpr=0.8366 | 7994.8 samples/s | 31.2 steps/s
[Step= 550] | Loss=5.27062 | acc=0.1639 | tpr=0.1830 | fpr=0.8365 | 9908.9 samples/s | 38.7 steps/s
Avg test loss: 5.27020, Avg test acc: 0.16382, Avg tpr: 0.18304, Avg fpr: 0.83653, total FA: 116151

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.70307 | acc=0.1296 | tpr=0.2743 | fpr=0.8730 | 5686.0 samples/s | 22.2 steps/s
[Step= 100] | Loss=5.64980 | acc=0.1320 | tpr=0.2473 | fpr=0.8702 | 7932.3 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.67253 | acc=0.1295 | tpr=0.2378 | fpr=0.8725 | 7661.2 samples/s | 29.9 steps/s
[Step= 200] | Loss=5.67177 | acc=0.1289 | tpr=0.2306 | fpr=0.8729 | 8160.8 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.67657 | acc=0.1286 | tpr=0.2297 | fpr=0.8732 | 8545.4 samples/s | 33.4 steps/s
[Step= 300] | Loss=5.68100 | acc=0.1280 | tpr=0.2320 | fpr=0.8739 | 7726.0 samples/s | 30.2 steps/s
[Step= 350] | Loss=5.68209 | acc=0.1274 | tpr=0.2198 | fpr=0.8743 | 8040.7 samples/s | 31.4 steps/s
[Step= 400] | Loss=5.67931 | acc=0.1278 | tpr=0.2248 | fpr=0.8740 | 8442.0 samples/s | 33.0 steps/s
[Step= 450] | Loss=5.67870 | acc=0.1281 | tpr=0.2225 | fpr=0.8736 | 8067.5 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.68069 | acc=0.1281 | tpr=0.2247 | fpr=0.8737 | 8139.8 samples/s | 31.8 steps/s
[Step= 550] | Loss=5.67959 | acc=0.1282 | tpr=0.2252 | fpr=0.8736 | 9913.5 samples/s | 38.7 steps/s
Avg test loss: 5.67987, Avg test acc: 0.12809, Avg tpr: 0.22583, Avg fpr: 0.87368, total FA: 121309

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.38628 | acc=0.1292 | tpr=0.1770 | fpr=0.8716 | 5612.9 samples/s | 21.9 steps/s
[Step= 100] | Loss=6.33447 | acc=0.1298 | tpr=0.1620 | fpr=0.8708 | 8000.1 samples/s | 31.3 steps/s
[Step= 150] | Loss=6.34499 | acc=0.1294 | tpr=0.1527 | fpr=0.8710 | 7753.1 samples/s | 30.3 steps/s
[Step= 200] | Loss=6.33311 | acc=0.1295 | tpr=0.1497 | fpr=0.8709 | 8443.8 samples/s | 33.0 steps/s
[Step= 250] | Loss=6.33320 | acc=0.1296 | tpr=0.1467 | fpr=0.8708 | 8234.1 samples/s | 32.2 steps/s
[Step= 300] | Loss=6.34087 | acc=0.1291 | tpr=0.1491 | fpr=0.8713 | 7759.6 samples/s | 30.3 steps/s
[Step= 350] | Loss=6.34623 | acc=0.1281 | tpr=0.1415 | fpr=0.8721 | 8095.9 samples/s | 31.6 steps/s
[Step= 400] | Loss=6.34453 | acc=0.1281 | tpr=0.1472 | fpr=0.8723 | 8009.0 samples/s | 31.3 steps/s
[Step= 450] | Loss=6.34328 | acc=0.1282 | tpr=0.1461 | fpr=0.8721 | 8096.4 samples/s | 31.6 steps/s
[Step= 500] | Loss=6.34384 | acc=0.1282 | tpr=0.1454 | fpr=0.8721 | 8152.9 samples/s | 31.8 steps/s
[Step= 550] | Loss=6.34012 | acc=0.1285 | tpr=0.1444 | fpr=0.8718 | 10337.9 samples/s | 40.4 steps/s
Avg test loss: 6.34023, Avg test acc: 0.12843, Avg tpr: 0.14501, Avg fpr: 0.87187, total FA: 121057

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.19413 | acc=0.1586 | tpr=0.2478 | fpr=0.8430 | 5589.3 samples/s | 21.8 steps/s
[Step= 100] | Loss=5.14955 | acc=0.1591 | tpr=0.2260 | fpr=0.8422 | 8230.2 samples/s | 32.1 steps/s
[Step= 150] | Loss=5.15817 | acc=0.1577 | tpr=0.2190 | fpr=0.8434 | 8336.3 samples/s | 32.6 steps/s
[Step= 200] | Loss=5.15189 | acc=0.1580 | tpr=0.2142 | fpr=0.8430 | 7846.8 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.15640 | acc=0.1581 | tpr=0.2166 | fpr=0.8430 | 7756.2 samples/s | 30.3 steps/s
[Step= 300] | Loss=5.16007 | acc=0.1574 | tpr=0.2182 | fpr=0.8437 | 8157.8 samples/s | 31.9 steps/s
[Step= 350] | Loss=5.16243 | acc=0.1571 | tpr=0.2098 | fpr=0.8438 | 8168.7 samples/s | 31.9 steps/s
[Step= 400] | Loss=5.15950 | acc=0.1577 | tpr=0.2144 | fpr=0.8433 | 7566.9 samples/s | 29.6 steps/s
[Step= 450] | Loss=5.15941 | acc=0.1577 | tpr=0.2152 | fpr=0.8434 | 8378.7 samples/s | 32.7 steps/s
[Step= 500] | Loss=5.16276 | acc=0.1576 | tpr=0.2194 | fpr=0.8435 | 8236.6 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.16076 | acc=0.1578 | tpr=0.2189 | fpr=0.8433 | 10218.5 samples/s | 39.9 steps/s
Avg test loss: 5.16031, Avg test acc: 0.15771, Avg tpr: 0.21949, Avg fpr: 0.84341, total FA: 117106

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.46027 | acc=0.1195 | tpr=0.1549 | fpr=0.8811 | 5710.0 samples/s | 22.3 steps/s
[Step= 100] | Loss=6.40097 | acc=0.1197 | tpr=0.1471 | fpr=0.8808 | 8051.8 samples/s | 31.5 steps/s
[Step= 150] | Loss=6.42359 | acc=0.1190 | tpr=0.1412 | fpr=0.8814 | 7952.1 samples/s | 31.1 steps/s
[Step= 200] | Loss=6.41818 | acc=0.1197 | tpr=0.1388 | fpr=0.8806 | 7570.5 samples/s | 29.6 steps/s
[Step= 250] | Loss=6.42471 | acc=0.1201 | tpr=0.1424 | fpr=0.8803 | 8024.7 samples/s | 31.3 steps/s
[Step= 300] | Loss=6.42796 | acc=0.1202 | tpr=0.1418 | fpr=0.8802 | 8058.0 samples/s | 31.5 steps/s
[Step= 350] | Loss=6.43263 | acc=0.1197 | tpr=0.1359 | fpr=0.8806 | 7984.8 samples/s | 31.2 steps/s
[Step= 400] | Loss=6.43154 | acc=0.1203 | tpr=0.1406 | fpr=0.8800 | 8353.2 samples/s | 32.6 steps/s
[Step= 450] | Loss=6.43043 | acc=0.1206 | tpr=0.1407 | fpr=0.8797 | 8258.4 samples/s | 32.3 steps/s
[Step= 500] | Loss=6.43239 | acc=0.1204 | tpr=0.1419 | fpr=0.8800 | 7862.5 samples/s | 30.7 steps/s
[Step= 550] | Loss=6.42933 | acc=0.1207 | tpr=0.1413 | fpr=0.8797 | 10576.5 samples/s | 41.3 steps/s
Avg test loss: 6.42857, Avg test acc: 0.12056, Avg tpr: 0.14184, Avg fpr: 0.87983, total FA: 122162

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10197 | acc=0.9820 | tpr=0.9248 | fpr=0.0169 | 5598.2 samples/s | 21.9 steps/s
[Step= 100] | Loss=0.10327 | acc=0.9821 | tpr=0.9318 | fpr=0.0170 | 8006.6 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.10646 | acc=0.9814 | tpr=0.9366 | fpr=0.0178 | 8164.3 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.10821 | acc=0.9811 | tpr=0.9432 | fpr=0.0182 | 8386.2 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.10878 | acc=0.9809 | tpr=0.9389 | fpr=0.0183 | 8070.5 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.10990 | acc=0.9808 | tpr=0.9375 | fpr=0.0184 | 7876.1 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.11015 | acc=0.9809 | tpr=0.9399 | fpr=0.0184 | 8344.0 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.11097 | acc=0.9806 | tpr=0.9365 | fpr=0.0186 | 7937.6 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.11323 | acc=0.9802 | tpr=0.9352 | fpr=0.0190 | 7543.7 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.11220 | acc=0.9804 | tpr=0.9383 | fpr=0.0188 | 8570.2 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.11141 | acc=0.9805 | tpr=0.9379 | fpr=0.0187 | 9992.0 samples/s | 39.0 steps/s
Avg test loss: 0.11119, Avg test acc: 0.98055, Avg tpr: 0.93780, Avg fpr: 0.01867, total FA: 2592

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10860 | acc=0.9806 | tpr=0.8982 | fpr=0.0179 | 5589.7 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.11089 | acc=0.9807 | tpr=0.9254 | fpr=0.0183 | 8219.1 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.11510 | acc=0.9801 | tpr=0.9308 | fpr=0.0190 | 7790.5 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.11719 | acc=0.9800 | tpr=0.9344 | fpr=0.0191 | 7838.3 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.11769 | acc=0.9799 | tpr=0.9310 | fpr=0.0192 | 8393.9 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.11940 | acc=0.9797 | tpr=0.9309 | fpr=0.0194 | 8426.3 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.11970 | acc=0.9795 | tpr=0.9311 | fpr=0.0196 | 8263.0 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.12077 | acc=0.9794 | tpr=0.9267 | fpr=0.0197 | 7683.1 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.12283 | acc=0.9791 | tpr=0.9250 | fpr=0.0199 | 8438.8 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.12201 | acc=0.9792 | tpr=0.9273 | fpr=0.0199 | 8134.7 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.12109 | acc=0.9793 | tpr=0.9260 | fpr=0.0198 | 9627.4 samples/s | 37.6 steps/s
Avg test loss: 0.12086, Avg test acc: 0.97927, Avg tpr: 0.92591, Avg fpr: 0.01976, total FA: 2743

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12979 | acc=0.9766 | tpr=0.9425 | fpr=0.0228 | 5748.9 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.12947 | acc=0.9767 | tpr=0.9552 | fpr=0.0229 | 7796.6 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.13476 | acc=0.9761 | tpr=0.9597 | fpr=0.0236 | 7972.5 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.13641 | acc=0.9764 | tpr=0.9617 | fpr=0.0233 | 7339.9 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.13682 | acc=0.9765 | tpr=0.9590 | fpr=0.0232 | 8298.6 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.13929 | acc=0.9762 | tpr=0.9520 | fpr=0.0233 | 8392.1 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.13936 | acc=0.9762 | tpr=0.9512 | fpr=0.0233 | 7973.0 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.14042 | acc=0.9760 | tpr=0.9486 | fpr=0.0235 | 8196.5 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.14182 | acc=0.9757 | tpr=0.9484 | fpr=0.0238 | 7689.8 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.14085 | acc=0.9757 | tpr=0.9498 | fpr=0.0238 | 8558.0 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.13990 | acc=0.9758 | tpr=0.9491 | fpr=0.0238 | 10569.0 samples/s | 41.3 steps/s
Avg test loss: 0.13982, Avg test acc: 0.97578, Avg tpr: 0.94889, Avg fpr: 0.02373, total FA: 3295

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10613 | acc=0.9799 | tpr=0.9159 | fpr=0.0189 | 5712.2 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.10777 | acc=0.9796 | tpr=0.9254 | fpr=0.0194 | 7995.1 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.11085 | acc=0.9795 | tpr=0.9352 | fpr=0.0197 | 7504.7 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.11281 | acc=0.9794 | tpr=0.9366 | fpr=0.0198 | 8477.7 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.11233 | acc=0.9796 | tpr=0.9284 | fpr=0.0195 | 8177.9 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.11436 | acc=0.9797 | tpr=0.9287 | fpr=0.0194 | 7555.8 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.11458 | acc=0.9797 | tpr=0.9317 | fpr=0.0194 | 8294.1 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.11551 | acc=0.9798 | tpr=0.9316 | fpr=0.0194 | 8417.9 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.11795 | acc=0.9793 | tpr=0.9294 | fpr=0.0198 | 8167.4 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.11695 | acc=0.9795 | tpr=0.9322 | fpr=0.0197 | 8281.5 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.11608 | acc=0.9796 | tpr=0.9316 | fpr=0.0195 | 9894.1 samples/s | 38.6 steps/s
Avg test loss: 0.11591, Avg test acc: 0.97961, Avg tpr: 0.93106, Avg fpr: 0.01951, total FA: 2709

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.09853 | acc=0.9816 | tpr=0.9159 | fpr=0.0173 | 5670.6 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.10177 | acc=0.9814 | tpr=0.9339 | fpr=0.0177 | 7359.0 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.10529 | acc=0.9810 | tpr=0.9395 | fpr=0.0183 | 8517.3 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.10680 | acc=0.9809 | tpr=0.9443 | fpr=0.0184 | 7241.4 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.10750 | acc=0.9808 | tpr=0.9406 | fpr=0.0185 | 8208.8 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.10867 | acc=0.9807 | tpr=0.9396 | fpr=0.0185 | 8578.2 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.10891 | acc=0.9807 | tpr=0.9418 | fpr=0.0186 | 8165.7 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.10962 | acc=0.9806 | tpr=0.9387 | fpr=0.0186 | 8377.2 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.11152 | acc=0.9803 | tpr=0.9362 | fpr=0.0189 | 7881.5 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.11071 | acc=0.9805 | tpr=0.9379 | fpr=0.0188 | 8123.9 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.11005 | acc=0.9805 | tpr=0.9363 | fpr=0.0187 | 11078.2 samples/s | 43.3 steps/s
Avg test loss: 0.10987, Avg test acc: 0.98049, Avg tpr: 0.93582, Avg fpr: 0.01870, total FA: 2596

server round 28/50

clients selected: [1 2 3 6 7]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=38001 Epoch=185.4] | Loss=0.00795 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.545 | L2-Norm(final)=15.292 | 5641.6 samples/s | 88.2 steps/s
[Step=38050 Epoch=185.7] | Loss=0.02057 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.546 | L2-Norm(final)=15.284 | 5188.1 samples/s | 81.1 steps/s
[Step=38100 Epoch=185.9] | Loss=0.01973 | Reg=0.00111 | acc=0.9688 | L2-Norm=10.546 | L2-Norm(final)=15.281 | 5569.6 samples/s | 87.0 steps/s
[Step=38150 Epoch=186.2] | Loss=0.02146 | Reg=0.00111 | acc=0.9688 | L2-Norm=10.546 | L2-Norm(final)=15.278 | 5819.2 samples/s | 90.9 steps/s
[Step=38200 Epoch=186.4] | Loss=0.02082 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.546 | L2-Norm(final)=15.272 | 8347.3 samples/s | 130.4 steps/s
[Step=38250 Epoch=186.6] | Loss=0.02000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.546 | L2-Norm(final)=15.267 | 2457.4 samples/s | 38.4 steps/s
[Step=38300 Epoch=186.9] | Loss=0.02011 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.546 | L2-Norm(final)=15.264 | 5350.9 samples/s | 83.6 steps/s
[Step=38350 Epoch=187.1] | Loss=0.02084 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.546 | L2-Norm(final)=15.260 | 5723.1 samples/s | 89.4 steps/s
[Step=38400 Epoch=187.4] | Loss=0.02074 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.546 | L2-Norm(final)=15.256 | 7886.8 samples/s | 123.2 steps/s
[Step=38450 Epoch=187.6] | Loss=0.02061 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.546 | L2-Norm(final)=15.252 | 2484.3 samples/s | 38.8 steps/s
[Step=38500 Epoch=187.9] | Loss=0.02040 | Reg=0.00111 | acc=0.9688 | L2-Norm=10.546 | L2-Norm(final)=15.248 | 5726.6 samples/s | 89.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=38501 Epoch=187.9] | Loss=0.00267 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.546 | L2-Norm(final)=15.215 | 5808.8 samples/s | 90.8 steps/s
[Step=38550 Epoch=188.1] | Loss=0.03048 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.585 | L2-Norm(final)=15.204 | 4504.9 samples/s | 70.4 steps/s
[Step=38600 Epoch=188.4] | Loss=0.02939 | Reg=0.00113 | acc=0.9531 | L2-Norm=10.626 | L2-Norm(final)=15.195 | 4744.7 samples/s | 74.1 steps/s
[Step=38650 Epoch=188.6] | Loss=0.02731 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.657 | L2-Norm(final)=15.192 | 4863.6 samples/s | 76.0 steps/s
[Step=38700 Epoch=188.8] | Loss=0.02516 | Reg=0.00114 | acc=0.9844 | L2-Norm=10.681 | L2-Norm(final)=15.193 | 6993.9 samples/s | 109.3 steps/s
[Step=38750 Epoch=189.1] | Loss=0.02174 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.700 | L2-Norm(final)=15.194 | 2264.3 samples/s | 35.4 steps/s
[Step=38800 Epoch=189.3] | Loss=0.01953 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.715 | L2-Norm(final)=15.197 | 4943.6 samples/s | 77.2 steps/s
[Step=38850 Epoch=189.6] | Loss=0.01745 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.728 | L2-Norm(final)=15.201 | 4746.9 samples/s | 74.2 steps/s
[Step=38900 Epoch=189.8] | Loss=0.01633 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.739 | L2-Norm(final)=15.204 | 6497.3 samples/s | 101.5 steps/s
[Step=38950 Epoch=190.1] | Loss=0.01518 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.748 | L2-Norm(final)=15.207 | 2310.7 samples/s | 36.1 steps/s
[Step=39000 Epoch=190.3] | Loss=0.01427 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=15.209 | 4826.7 samples/s | 75.4 steps/s
[Step=39050 Epoch=190.5] | Loss=0.01336 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.762 | L2-Norm(final)=15.212 | 4858.7 samples/s | 75.9 steps/s
[Step=39100 Epoch=190.8] | Loss=0.01281 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.768 | L2-Norm(final)=15.214 | 6013.6 samples/s | 94.0 steps/s
[Step=39150 Epoch=191.0] | Loss=0.01208 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.774 | L2-Norm(final)=15.217 | 2415.1 samples/s | 37.7 steps/s
[Step=39200 Epoch=191.3] | Loss=0.01154 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.780 | L2-Norm(final)=15.219 | 4724.7 samples/s | 73.8 steps/s
[Step=39250 Epoch=191.5] | Loss=0.01103 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.784 | L2-Norm(final)=15.221 | 4851.1 samples/s | 75.8 steps/s
[Step=39300 Epoch=191.8] | Loss=0.01067 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.789 | L2-Norm(final)=15.223 | 5618.1 samples/s | 87.8 steps/s
[Step=39350 Epoch=192.0] | Loss=0.01024 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.793 | L2-Norm(final)=15.226 | 2460.0 samples/s | 38.4 steps/s
[Step=39400 Epoch=192.3] | Loss=0.00987 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.797 | L2-Norm(final)=15.228 | 4874.3 samples/s | 76.2 steps/s
[Step=39450 Epoch=192.5] | Loss=0.00958 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.801 | L2-Norm(final)=15.230 | 4839.9 samples/s | 75.6 steps/s
[Step=39500 Epoch=192.7] | Loss=0.00921 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.805 | L2-Norm(final)=15.232 | 5260.4 samples/s | 82.2 steps/s
[Step=39550 Epoch=193.0] | Loss=0.00888 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.808 | L2-Norm(final)=15.235 | 2523.2 samples/s | 39.4 steps/s
[Step=39600 Epoch=193.2] | Loss=0.00858 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=15.237 | 4852.9 samples/s | 75.8 steps/s
[Step=39650 Epoch=193.5] | Loss=0.00833 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.814 | L2-Norm(final)=15.239 | 4944.2 samples/s | 77.3 steps/s
[Step=39700 Epoch=193.7] | Loss=0.00809 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.817 | L2-Norm(final)=15.241 | 4881.1 samples/s | 76.3 steps/s
[Step=39750 Epoch=194.0] | Loss=0.00793 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.820 | L2-Norm(final)=15.243 | 2608.7 samples/s | 40.8 steps/s
[Step=39800 Epoch=194.2] | Loss=0.00773 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.823 | L2-Norm(final)=15.245 | 4804.7 samples/s | 75.1 steps/s
[Step=39850 Epoch=194.4] | Loss=0.00758 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.825 | L2-Norm(final)=15.247 | 4862.4 samples/s | 76.0 steps/s
[Step=39900 Epoch=194.7] | Loss=0.00742 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.828 | L2-Norm(final)=15.249 | 4849.8 samples/s | 75.8 steps/s
[Step=39950 Epoch=194.9] | Loss=0.00725 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.830 | L2-Norm(final)=15.251 | 2603.9 samples/s | 40.7 steps/s
[Step=40000 Epoch=195.2] | Loss=0.00711 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.832 | L2-Norm(final)=15.253 | 4868.1 samples/s | 76.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step40000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=126.7] | Loss=0.06075 | Reg=0.00111 | acc=0.9688 | L2-Norm=10.545 | L2-Norm(final)=13.851 | 6078.5 samples/s | 95.0 steps/s
[Step=26050 Epoch=126.9] | Loss=0.02348 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.545 | L2-Norm(final)=13.840 | 5150.8 samples/s | 80.5 steps/s
[Step=26100 Epoch=127.2] | Loss=0.01998 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.546 | L2-Norm(final)=13.843 | 5646.4 samples/s | 88.2 steps/s
[Step=26150 Epoch=127.4] | Loss=0.01990 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.546 | L2-Norm(final)=13.846 | 5636.4 samples/s | 88.1 steps/s
[Step=26200 Epoch=127.7] | Loss=0.02093 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.546 | L2-Norm(final)=13.846 | 8763.7 samples/s | 136.9 steps/s
[Step=26250 Epoch=127.9] | Loss=0.02038 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.546 | L2-Norm(final)=13.845 | 2416.5 samples/s | 37.8 steps/s
[Step=26300 Epoch=128.1] | Loss=0.02072 | Reg=0.00111 | acc=0.9688 | L2-Norm=10.546 | L2-Norm(final)=13.845 | 5622.7 samples/s | 87.9 steps/s
[Step=26350 Epoch=128.4] | Loss=0.02110 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.546 | L2-Norm(final)=13.843 | 5696.6 samples/s | 89.0 steps/s
[Step=26400 Epoch=128.6] | Loss=0.02076 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.546 | L2-Norm(final)=13.841 | 7668.4 samples/s | 119.8 steps/s
[Step=26450 Epoch=128.9] | Loss=0.02056 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.546 | L2-Norm(final)=13.840 | 2506.1 samples/s | 39.2 steps/s
[Step=26500 Epoch=129.1] | Loss=0.02088 | Reg=0.00111 | acc=0.9688 | L2-Norm=10.546 | L2-Norm(final)=13.839 | 5637.9 samples/s | 88.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=129.1] | Loss=0.03580 | Reg=0.00111 | acc=0.9688 | L2-Norm=10.546 | L2-Norm(final)=13.825 | 6247.7 samples/s | 97.6 steps/s
[Step=26550 Epoch=129.4] | Loss=0.02471 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.591 | L2-Norm(final)=13.821 | 4159.7 samples/s | 65.0 steps/s
[Step=26600 Epoch=129.6] | Loss=0.02347 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.632 | L2-Norm(final)=13.821 | 4871.1 samples/s | 76.1 steps/s
[Step=26650 Epoch=129.9] | Loss=0.02308 | Reg=0.00114 | acc=0.9844 | L2-Norm=10.661 | L2-Norm(final)=13.820 | 4854.9 samples/s | 75.9 steps/s
[Step=26700 Epoch=130.1] | Loss=0.02245 | Reg=0.00114 | acc=0.9531 | L2-Norm=10.686 | L2-Norm(final)=13.820 | 6968.9 samples/s | 108.9 steps/s
[Step=26750 Epoch=130.3] | Loss=0.01976 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.709 | L2-Norm(final)=13.823 | 2284.8 samples/s | 35.7 steps/s
[Step=26800 Epoch=130.6] | Loss=0.01781 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.728 | L2-Norm(final)=13.827 | 4854.6 samples/s | 75.9 steps/s
[Step=26850 Epoch=130.8] | Loss=0.01639 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.743 | L2-Norm(final)=13.830 | 4861.0 samples/s | 76.0 steps/s
[Step=26900 Epoch=131.1] | Loss=0.01561 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.756 | L2-Norm(final)=13.834 | 6357.2 samples/s | 99.3 steps/s
[Step=26950 Epoch=131.3] | Loss=0.01453 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.768 | L2-Norm(final)=13.837 | 2355.8 samples/s | 36.8 steps/s
[Step=27000 Epoch=131.6] | Loss=0.01389 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.778 | L2-Norm(final)=13.840 | 4872.4 samples/s | 76.1 steps/s
[Step=27050 Epoch=131.8] | Loss=0.01329 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.787 | L2-Norm(final)=13.843 | 4847.7 samples/s | 75.7 steps/s
[Step=27100 Epoch=132.0] | Loss=0.01265 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.796 | L2-Norm(final)=13.845 | 5840.9 samples/s | 91.3 steps/s
[Step=27150 Epoch=132.3] | Loss=0.01190 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.803 | L2-Norm(final)=13.848 | 2411.7 samples/s | 37.7 steps/s
[Step=27200 Epoch=132.5] | Loss=0.01138 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.810 | L2-Norm(final)=13.851 | 4895.0 samples/s | 76.5 steps/s
[Step=27250 Epoch=132.8] | Loss=0.01086 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.816 | L2-Norm(final)=13.854 | 4879.9 samples/s | 76.2 steps/s
[Step=27300 Epoch=133.0] | Loss=0.01043 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.822 | L2-Norm(final)=13.856 | 5371.8 samples/s | 83.9 steps/s
[Step=27350 Epoch=133.3] | Loss=0.01008 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.827 | L2-Norm(final)=13.859 | 2529.3 samples/s | 39.5 steps/s
[Step=27400 Epoch=133.5] | Loss=0.00975 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.832 | L2-Norm(final)=13.861 | 4927.2 samples/s | 77.0 steps/s
[Step=27450 Epoch=133.7] | Loss=0.00955 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.836 | L2-Norm(final)=13.863 | 4788.4 samples/s | 74.8 steps/s
[Step=27500 Epoch=134.0] | Loss=0.00922 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=13.865 | 4976.4 samples/s | 77.8 steps/s
[Step=27550 Epoch=134.2] | Loss=0.00900 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.845 | L2-Norm(final)=13.868 | 2604.8 samples/s | 40.7 steps/s
[Step=27600 Epoch=134.5] | Loss=0.00883 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.849 | L2-Norm(final)=13.870 | 4802.1 samples/s | 75.0 steps/s
[Step=27650 Epoch=134.7] | Loss=0.00856 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.852 | L2-Norm(final)=13.872 | 4898.2 samples/s | 76.5 steps/s
[Step=27700 Epoch=135.0] | Loss=0.00837 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=13.874 | 4886.6 samples/s | 76.4 steps/s
[Step=27750 Epoch=135.2] | Loss=0.00818 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.859 | L2-Norm(final)=13.876 | 2634.2 samples/s | 41.2 steps/s
[Step=27800 Epoch=135.5] | Loss=0.00800 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.863 | L2-Norm(final)=13.878 | 4820.8 samples/s | 75.3 steps/s
[Step=27850 Epoch=135.7] | Loss=0.00782 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.866 | L2-Norm(final)=13.880 | 4864.0 samples/s | 76.0 steps/s
[Step=27900 Epoch=135.9] | Loss=0.00768 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.869 | L2-Norm(final)=13.882 | 4882.7 samples/s | 76.3 steps/s
[Step=27950 Epoch=136.2] | Loss=0.00753 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.872 | L2-Norm(final)=13.884 | 2628.2 samples/s | 41.1 steps/s
[Step=28000 Epoch=136.4] | Loss=0.00741 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.875 | L2-Norm(final)=13.886 | 4841.2 samples/s | 75.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step28000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=32001 Epoch=156.1] | Loss=0.02483 | Reg=0.00111 | acc=0.9688 | L2-Norm=10.545 | L2-Norm(final)=14.548 | 5759.9 samples/s | 90.0 steps/s
[Step=32050 Epoch=156.3] | Loss=0.01611 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.545 | L2-Norm(final)=14.552 | 5169.3 samples/s | 80.8 steps/s
[Step=32100 Epoch=156.5] | Loss=0.01787 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.545 | L2-Norm(final)=14.559 | 5620.3 samples/s | 87.8 steps/s
[Step=32150 Epoch=156.8] | Loss=0.01972 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.545 | L2-Norm(final)=14.561 | 5589.9 samples/s | 87.3 steps/s
[Step=32200 Epoch=157.0] | Loss=0.01956 | Reg=0.00111 | acc=0.9531 | L2-Norm=10.545 | L2-Norm(final)=14.565 | 8684.8 samples/s | 135.7 steps/s
[Step=32250 Epoch=157.3] | Loss=0.01925 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.545 | L2-Norm(final)=14.568 | 2438.6 samples/s | 38.1 steps/s
[Step=32300 Epoch=157.5] | Loss=0.01965 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.545 | L2-Norm(final)=14.570 | 5714.2 samples/s | 89.3 steps/s
[Step=32350 Epoch=157.8] | Loss=0.01976 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.545 | L2-Norm(final)=14.572 | 5729.4 samples/s | 89.5 steps/s
[Step=32400 Epoch=158.0] | Loss=0.01955 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.545 | L2-Norm(final)=14.575 | 7376.3 samples/s | 115.3 steps/s
[Step=32450 Epoch=158.2] | Loss=0.01926 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.545 | L2-Norm(final)=14.577 | 2517.4 samples/s | 39.3 steps/s
[Step=32500 Epoch=158.5] | Loss=0.01912 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.545 | L2-Norm(final)=14.580 | 5593.0 samples/s | 87.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=32501 Epoch=158.5] | Loss=0.03173 | Reg=0.00111 | acc=0.9688 | L2-Norm=10.545 | L2-Norm(final)=14.607 | 6053.0 samples/s | 94.6 steps/s
[Step=32550 Epoch=158.7] | Loss=0.02410 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.589 | L2-Norm(final)=14.604 | 4269.2 samples/s | 66.7 steps/s
[Step=32600 Epoch=159.0] | Loss=0.02411 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.632 | L2-Norm(final)=14.600 | 4879.5 samples/s | 76.2 steps/s
[Step=32650 Epoch=159.2] | Loss=0.02386 | Reg=0.00114 | acc=0.9688 | L2-Norm=10.661 | L2-Norm(final)=14.598 | 4858.0 samples/s | 75.9 steps/s
[Step=32700 Epoch=159.5] | Loss=0.02245 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.683 | L2-Norm(final)=14.598 | 6913.0 samples/s | 108.0 steps/s
[Step=32750 Epoch=159.7] | Loss=0.01976 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.701 | L2-Norm(final)=14.599 | 2270.9 samples/s | 35.5 steps/s
[Step=32800 Epoch=160.0] | Loss=0.01789 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.715 | L2-Norm(final)=14.601 | 4917.9 samples/s | 76.8 steps/s
[Step=32850 Epoch=160.2] | Loss=0.01634 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.727 | L2-Norm(final)=14.603 | 4797.1 samples/s | 75.0 steps/s
[Step=32900 Epoch=160.4] | Loss=0.01508 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.738 | L2-Norm(final)=14.605 | 6347.7 samples/s | 99.2 steps/s
[Step=32950 Epoch=160.7] | Loss=0.01439 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.747 | L2-Norm(final)=14.608 | 2331.8 samples/s | 36.4 steps/s
[Step=33000 Epoch=160.9] | Loss=0.01349 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=14.609 | 4889.1 samples/s | 76.4 steps/s
[Step=33050 Epoch=161.2] | Loss=0.01278 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.762 | L2-Norm(final)=14.611 | 4814.6 samples/s | 75.2 steps/s
[Step=33100 Epoch=161.4] | Loss=0.01223 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.768 | L2-Norm(final)=14.613 | 5860.5 samples/s | 91.6 steps/s
[Step=33150 Epoch=161.7] | Loss=0.01170 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.774 | L2-Norm(final)=14.614 | 2418.9 samples/s | 37.8 steps/s
[Step=33200 Epoch=161.9] | Loss=0.01117 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.780 | L2-Norm(final)=14.616 | 4907.1 samples/s | 76.7 steps/s
[Step=33250 Epoch=162.1] | Loss=0.01071 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.785 | L2-Norm(final)=14.617 | 4829.0 samples/s | 75.5 steps/s
[Step=33300 Epoch=162.4] | Loss=0.01032 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.791 | L2-Norm(final)=14.619 | 5390.0 samples/s | 84.2 steps/s
[Step=33350 Epoch=162.6] | Loss=0.00988 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.795 | L2-Norm(final)=14.621 | 2480.0 samples/s | 38.8 steps/s
[Step=33400 Epoch=162.9] | Loss=0.00953 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.799 | L2-Norm(final)=14.622 | 4857.9 samples/s | 75.9 steps/s
[Step=33450 Epoch=163.1] | Loss=0.00921 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.804 | L2-Norm(final)=14.624 | 4892.0 samples/s | 76.4 steps/s
[Step=33500 Epoch=163.4] | Loss=0.00892 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.807 | L2-Norm(final)=14.626 | 4984.6 samples/s | 77.9 steps/s
[Step=33550 Epoch=163.6] | Loss=0.00868 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=14.628 | 2593.0 samples/s | 40.5 steps/s
[Step=33600 Epoch=163.9] | Loss=0.00847 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.815 | L2-Norm(final)=14.629 | 4851.5 samples/s | 75.8 steps/s
[Step=33650 Epoch=164.1] | Loss=0.00820 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.818 | L2-Norm(final)=14.631 | 4972.6 samples/s | 77.7 steps/s
[Step=33700 Epoch=164.3] | Loss=0.00805 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.821 | L2-Norm(final)=14.633 | 4819.7 samples/s | 75.3 steps/s
[Step=33750 Epoch=164.6] | Loss=0.00792 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.824 | L2-Norm(final)=14.634 | 2641.1 samples/s | 41.3 steps/s
[Step=33800 Epoch=164.8] | Loss=0.00773 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.827 | L2-Norm(final)=14.636 | 4916.7 samples/s | 76.8 steps/s
[Step=33850 Epoch=165.1] | Loss=0.00757 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.830 | L2-Norm(final)=14.637 | 4849.3 samples/s | 75.8 steps/s
[Step=33900 Epoch=165.3] | Loss=0.00746 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.833 | L2-Norm(final)=14.639 | 4863.3 samples/s | 76.0 steps/s
[Step=33950 Epoch=165.6] | Loss=0.00732 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.835 | L2-Norm(final)=14.640 | 2617.2 samples/s | 40.9 steps/s
[Step=34000 Epoch=165.8] | Loss=0.00715 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.838 | L2-Norm(final)=14.642 | 4880.0 samples/s | 76.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step34000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=228.3] | Loss=0.00059 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.545 | L2-Norm(final)=14.573 | 5876.1 samples/s | 91.8 steps/s
[Step=24050 Epoch=228.8] | Loss=0.00239 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.541 | L2-Norm(final)=14.602 | 4374.3 samples/s | 68.3 steps/s
[Step=24100 Epoch=229.3] | Loss=0.00202 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.541 | L2-Norm(final)=14.636 | 8256.2 samples/s | 129.0 steps/s
[Step=24150 Epoch=229.7] | Loss=0.00197 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.541 | L2-Norm(final)=14.667 | 2354.2 samples/s | 36.8 steps/s
[Step=24200 Epoch=230.2] | Loss=0.00209 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.541 | L2-Norm(final)=14.694 | 7352.3 samples/s | 114.9 steps/s
[Step=24250 Epoch=230.7] | Loss=0.00208 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.541 | L2-Norm(final)=14.718 | 2461.5 samples/s | 38.5 steps/s
[Step=24300 Epoch=231.2] | Loss=0.00199 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.541 | L2-Norm(final)=14.741 | 6357.5 samples/s | 99.3 steps/s
[Step=24350 Epoch=231.6] | Loss=0.00199 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.541 | L2-Norm(final)=14.762 | 2510.0 samples/s | 39.2 steps/s
[Step=24400 Epoch=232.1] | Loss=0.00195 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.541 | L2-Norm(final)=14.783 | 6026.3 samples/s | 94.2 steps/s
[Step=24450 Epoch=232.6] | Loss=0.00194 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.541 | L2-Norm(final)=14.804 | 2651.9 samples/s | 41.4 steps/s
[Step=24500 Epoch=233.1] | Loss=0.00192 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.541 | L2-Norm(final)=14.823 | 5390.7 samples/s | 84.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=233.1] | Loss=0.00386 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.540 | L2-Norm(final)=15.019 | 5734.5 samples/s | 89.6 steps/s
[Step=24550 Epoch=233.5] | Loss=0.00522 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=15.019 | 4109.7 samples/s | 64.2 steps/s
[Step=24600 Epoch=234.0] | Loss=0.00390 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.695 | L2-Norm(final)=15.008 | 6700.0 samples/s | 104.7 steps/s
[Step=24650 Epoch=234.5] | Loss=0.00265 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.729 | L2-Norm(final)=15.004 | 2215.9 samples/s | 34.6 steps/s
[Step=24700 Epoch=235.0] | Loss=0.00199 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.744 | L2-Norm(final)=15.004 | 5958.4 samples/s | 93.1 steps/s
[Step=24750 Epoch=235.4] | Loss=0.00160 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.751 | L2-Norm(final)=15.003 | 2274.5 samples/s | 35.5 steps/s
[Step=24800 Epoch=235.9] | Loss=0.00133 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.753 | L2-Norm(final)=15.003 | 5580.8 samples/s | 87.2 steps/s
[Step=24850 Epoch=236.4] | Loss=0.00115 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.753 | L2-Norm(final)=15.003 | 2360.2 samples/s | 36.9 steps/s
[Step=24900 Epoch=236.9] | Loss=0.00100 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.752 | L2-Norm(final)=15.004 | 5082.1 samples/s | 79.4 steps/s
[Step=24950 Epoch=237.3] | Loss=0.00089 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.749 | L2-Norm(final)=15.004 | 2457.9 samples/s | 38.4 steps/s
[Step=25000 Epoch=237.8] | Loss=0.00080 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.746 | L2-Norm(final)=15.004 | 4763.5 samples/s | 74.4 steps/s
[Step=25050 Epoch=238.3] | Loss=0.00073 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.743 | L2-Norm(final)=15.004 | 2513.6 samples/s | 39.3 steps/s
[Step=25100 Epoch=238.8] | Loss=0.00067 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.739 | L2-Norm(final)=15.005 | 4644.3 samples/s | 72.6 steps/s
[Step=25150 Epoch=239.2] | Loss=0.00062 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.735 | L2-Norm(final)=15.005 | 2602.2 samples/s | 40.7 steps/s
[Step=25200 Epoch=239.7] | Loss=0.00058 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.731 | L2-Norm(final)=15.005 | 4632.2 samples/s | 72.4 steps/s
[Step=25250 Epoch=240.2] | Loss=0.00054 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.727 | L2-Norm(final)=15.006 | 2560.6 samples/s | 40.0 steps/s
[Step=25300 Epoch=240.7] | Loss=0.00050 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.722 | L2-Norm(final)=15.006 | 4671.2 samples/s | 73.0 steps/s
[Step=25350 Epoch=241.1] | Loss=0.00047 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.718 | L2-Norm(final)=15.006 | 2787.3 samples/s | 43.6 steps/s
[Step=25400 Epoch=241.6] | Loss=0.00045 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.713 | L2-Norm(final)=15.006 | 4040.9 samples/s | 63.1 steps/s
[Step=25450 Epoch=242.1] | Loss=0.00043 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.708 | L2-Norm(final)=15.007 | 6983.3 samples/s | 109.1 steps/s
[Step=25500 Epoch=242.6] | Loss=0.00040 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.703 | L2-Norm(final)=15.007 | 2153.7 samples/s | 33.7 steps/s
[Step=25550 Epoch=243.0] | Loss=0.00039 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.698 | L2-Norm(final)=15.007 | 6292.3 samples/s | 98.3 steps/s
[Step=25600 Epoch=243.5] | Loss=0.00037 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.693 | L2-Norm(final)=15.008 | 2252.8 samples/s | 35.2 steps/s
[Step=25650 Epoch=244.0] | Loss=0.00035 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.688 | L2-Norm(final)=15.008 | 5656.1 samples/s | 88.4 steps/s
[Step=25700 Epoch=244.5] | Loss=0.00034 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.683 | L2-Norm(final)=15.008 | 2333.8 samples/s | 36.5 steps/s
[Step=25750 Epoch=244.9] | Loss=0.00032 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.677 | L2-Norm(final)=15.008 | 5237.0 samples/s | 81.8 steps/s
[Step=25800 Epoch=245.4] | Loss=0.00031 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.672 | L2-Norm(final)=15.009 | 2455.3 samples/s | 38.4 steps/s
[Step=25850 Epoch=245.9] | Loss=0.00030 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.667 | L2-Norm(final)=15.009 | 4772.1 samples/s | 74.6 steps/s
[Step=25900 Epoch=246.4] | Loss=0.00029 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.662 | L2-Norm(final)=15.009 | 2518.3 samples/s | 39.3 steps/s
[Step=25950 Epoch=246.8] | Loss=0.00028 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.656 | L2-Norm(final)=15.009 | 4578.9 samples/s | 71.5 steps/s
[Step=26000 Epoch=247.3] | Loss=0.00027 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.651 | L2-Norm(final)=15.010 | 2562.6 samples/s | 40.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step26000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=267.4] | Loss=0.00002 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.545 | L2-Norm(final)=16.323 | 5345.5 samples/s | 83.5 steps/s
[Step=28050 Epoch=267.9] | Loss=0.00042 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.543 | L2-Norm(final)=16.322 | 4682.3 samples/s | 73.2 steps/s
[Step=28100 Epoch=268.3] | Loss=0.00058 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.543 | L2-Norm(final)=16.316 | 8501.7 samples/s | 132.8 steps/s
[Step=28150 Epoch=268.8] | Loss=0.00053 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.543 | L2-Norm(final)=16.313 | 2335.8 samples/s | 36.5 steps/s
[Step=28200 Epoch=269.3] | Loss=0.00048 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.543 | L2-Norm(final)=16.310 | 7506.7 samples/s | 117.3 steps/s
[Step=28250 Epoch=269.8] | Loss=0.00056 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.543 | L2-Norm(final)=16.308 | 2391.4 samples/s | 37.4 steps/s
[Step=28300 Epoch=270.2] | Loss=0.00053 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.543 | L2-Norm(final)=16.308 | 6886.3 samples/s | 107.6 steps/s
[Step=28350 Epoch=270.7] | Loss=0.00051 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.543 | L2-Norm(final)=16.308 | 2471.6 samples/s | 38.6 steps/s
[Step=28400 Epoch=271.2] | Loss=0.00051 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.543 | L2-Norm(final)=16.308 | 6314.4 samples/s | 98.7 steps/s
[Step=28450 Epoch=271.7] | Loss=0.00052 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.543 | L2-Norm(final)=16.309 | 2552.4 samples/s | 39.9 steps/s
[Step=28500 Epoch=272.2] | Loss=0.00050 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.543 | L2-Norm(final)=16.310 | 5846.4 samples/s | 91.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=272.2] | Loss=0.00008 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.543 | L2-Norm(final)=16.320 | 5113.9 samples/s | 79.9 steps/s
[Step=28550 Epoch=272.6] | Loss=0.00021 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.561 | L2-Norm(final)=16.325 | 4640.4 samples/s | 72.5 steps/s
[Step=28600 Epoch=273.1] | Loss=0.00011 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.561 | L2-Norm(final)=16.328 | 6501.3 samples/s | 101.6 steps/s
[Step=28650 Epoch=273.6] | Loss=0.00008 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.555 | L2-Norm(final)=16.330 | 2189.3 samples/s | 34.2 steps/s
[Step=28700 Epoch=274.1] | Loss=0.00006 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.548 | L2-Norm(final)=16.331 | 6163.1 samples/s | 96.3 steps/s
[Step=28750 Epoch=274.5] | Loss=0.00005 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.539 | L2-Norm(final)=16.332 | 2249.1 samples/s | 35.1 steps/s
[Step=28800 Epoch=275.0] | Loss=0.00004 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.531 | L2-Norm(final)=16.333 | 5799.0 samples/s | 90.6 steps/s
[Step=28850 Epoch=275.5] | Loss=0.00004 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.523 | L2-Norm(final)=16.334 | 2327.7 samples/s | 36.4 steps/s
[Step=28900 Epoch=276.0] | Loss=0.00003 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.514 | L2-Norm(final)=16.335 | 5306.7 samples/s | 82.9 steps/s
[Step=28950 Epoch=276.5] | Loss=0.00003 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.506 | L2-Norm(final)=16.335 | 2406.1 samples/s | 37.6 steps/s
[Step=29000 Epoch=276.9] | Loss=0.00003 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.498 | L2-Norm(final)=16.336 | 5061.8 samples/s | 79.1 steps/s
[Step=29050 Epoch=277.4] | Loss=0.00002 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.489 | L2-Norm(final)=16.337 | 2476.4 samples/s | 38.7 steps/s
[Step=29100 Epoch=277.9] | Loss=0.00002 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.481 | L2-Norm(final)=16.337 | 4708.1 samples/s | 73.6 steps/s
[Step=29150 Epoch=278.4] | Loss=0.00002 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.473 | L2-Norm(final)=16.338 | 2547.3 samples/s | 39.8 steps/s
[Step=29200 Epoch=278.8] | Loss=0.00002 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.464 | L2-Norm(final)=16.339 | 4610.2 samples/s | 72.0 steps/s
[Step=29250 Epoch=279.3] | Loss=0.00002 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.456 | L2-Norm(final)=16.339 | 2583.5 samples/s | 40.4 steps/s
[Step=29300 Epoch=279.8] | Loss=0.00002 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.448 | L2-Norm(final)=16.340 | 4612.1 samples/s | 72.1 steps/s
[Step=29350 Epoch=280.3] | Loss=0.00002 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.439 | L2-Norm(final)=16.340 | 2549.7 samples/s | 39.8 steps/s
[Step=29400 Epoch=280.8] | Loss=0.00002 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.431 | L2-Norm(final)=16.341 | 4652.3 samples/s | 72.7 steps/s
[Step=29450 Epoch=281.2] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.423 | L2-Norm(final)=16.342 | 2539.5 samples/s | 39.7 steps/s
[Step=29500 Epoch=281.7] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.414 | L2-Norm(final)=16.342 | 4651.3 samples/s | 72.7 steps/s
[Step=29550 Epoch=282.2] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=16.343 | 7356.3 samples/s | 114.9 steps/s
[Step=29600 Epoch=282.7] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=16.343 | 2115.4 samples/s | 33.1 steps/s
[Step=29650 Epoch=283.1] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=16.344 | 6746.8 samples/s | 105.4 steps/s
[Step=29700 Epoch=283.6] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.381 | L2-Norm(final)=16.344 | 2165.4 samples/s | 33.8 steps/s
[Step=29750 Epoch=284.1] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.372 | L2-Norm(final)=16.345 | 6194.3 samples/s | 96.8 steps/s
[Step=29800 Epoch=284.6] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.364 | L2-Norm(final)=16.346 | 2258.7 samples/s | 35.3 steps/s
[Step=29850 Epoch=285.0] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.355 | L2-Norm(final)=16.346 | 5718.6 samples/s | 89.4 steps/s
[Step=29900 Epoch=285.5] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.346 | L2-Norm(final)=16.347 | 2327.3 samples/s | 36.4 steps/s
[Step=29950 Epoch=286.0] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.338 | L2-Norm(final)=16.347 | 5337.8 samples/s | 83.4 steps/s
[Step=30000 Epoch=286.5] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.329 | L2-Norm(final)=16.348 | 2352.4 samples/s | 36.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step30000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09373 | acc=0.9584 | tpr=0.9638 | fpr=0.0535 | 5371.1 samples/s | 21.0 steps/s
Avg test loss: 0.10039, Avg test acc: 0.95781, Avg tpr: 0.96334, Avg fpr: 0.05435, total FA: 424

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09551 | acc=0.9617 | tpr=0.9763 | fpr=0.0699 | 5729.6 samples/s | 22.4 steps/s
Avg test loss: 0.10198, Avg test acc: 0.96117, Avg tpr: 0.97470, Avg fpr: 0.06858, total FA: 535

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09812 | acc=0.9605 | tpr=0.9698 | fpr=0.0597 | 5707.3 samples/s | 22.3 steps/s
Avg test loss: 0.10379, Avg test acc: 0.95941, Avg tpr: 0.96783, Avg fpr: 0.05909, total FA: 461

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09441 | acc=0.9615 | tpr=0.9712 | fpr=0.0597 | 5588.2 samples/s | 21.8 steps/s
Avg test loss: 0.10159, Avg test acc: 0.95977, Avg tpr: 0.97080, Avg fpr: 0.06448, total FA: 503

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08987 | acc=0.9619 | tpr=0.9730 | fpr=0.0622 | 5410.2 samples/s | 21.1 steps/s
Avg test loss: 0.09938, Avg test acc: 0.95993, Avg tpr: 0.97027, Avg fpr: 0.06281, total FA: 490

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.58037 | acc=0.2452 | tpr=0.0062 | fpr=0.2356 | 5635.3 samples/s | 22.0 steps/s
Avg test loss: 5.58477, Avg test acc: 0.24301, Avg tpr: 0.00688, Avg fpr: 0.23766, total FA: 1854

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.60507 | acc=0.2891 | tpr=0.0080 | fpr=0.1003 | 5862.8 samples/s | 22.9 steps/s
Avg test loss: 4.61595, Avg test acc: 0.28596, Avg tpr: 0.00699, Avg fpr: 0.10050, total FA: 784

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.32370 | acc=0.2321 | tpr=0.0113 | fpr=0.2884 | 5669.8 samples/s | 22.1 steps/s
Avg test loss: 5.32582, Avg test acc: 0.23199, Avg tpr: 0.01265, Avg fpr: 0.28560, total FA: 2228

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.69425 | acc=0.2691 | tpr=0.0102 | fpr=0.1687 | 5704.1 samples/s | 22.3 steps/s
Avg test loss: 5.69188, Avg test acc: 0.26809, Avg tpr: 0.01049, Avg fpr: 0.16536, total FA: 1290

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.57109 | acc=0.2593 | tpr=0.0110 | fpr=0.2014 | 5489.4 samples/s | 21.4 steps/s
Avg test loss: 5.58360, Avg test acc: 0.25900, Avg tpr: 0.01148, Avg fpr: 0.19664, total FA: 1534

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.30941 | acc=0.1659 | tpr=0.2212 | fpr=0.8351 | 5604.8 samples/s | 21.9 steps/s
[Step= 100] | Loss=5.25531 | acc=0.1660 | tpr=0.1940 | fpr=0.8345 | 8018.6 samples/s | 31.3 steps/s
[Step= 150] | Loss=5.26535 | acc=0.1648 | tpr=0.1888 | fpr=0.8356 | 7430.3 samples/s | 29.0 steps/s
[Step= 200] | Loss=5.26213 | acc=0.1646 | tpr=0.1880 | fpr=0.8359 | 8382.8 samples/s | 32.7 steps/s
[Step= 250] | Loss=5.26748 | acc=0.1643 | tpr=0.1939 | fpr=0.8362 | 8149.5 samples/s | 31.8 steps/s
[Step= 300] | Loss=5.26942 | acc=0.1636 | tpr=0.1942 | fpr=0.8369 | 8473.4 samples/s | 33.1 steps/s
[Step= 350] | Loss=5.27159 | acc=0.1635 | tpr=0.1841 | fpr=0.8369 | 8214.8 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.26896 | acc=0.1639 | tpr=0.1849 | fpr=0.8365 | 7422.0 samples/s | 29.0 steps/s
[Step= 450] | Loss=5.26892 | acc=0.1639 | tpr=0.1821 | fpr=0.8364 | 7880.4 samples/s | 30.8 steps/s
[Step= 500] | Loss=5.27251 | acc=0.1638 | tpr=0.1868 | fpr=0.8366 | 8962.0 samples/s | 35.0 steps/s
[Step= 550] | Loss=5.27062 | acc=0.1639 | tpr=0.1830 | fpr=0.8365 | 9880.2 samples/s | 38.6 steps/s
Avg test loss: 5.27020, Avg test acc: 0.16382, Avg tpr: 0.18304, Avg fpr: 0.83653, total FA: 116151

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.20437 | acc=0.1359 | tpr=0.3186 | fpr=0.8674 | 5659.4 samples/s | 22.1 steps/s
[Step= 100] | Loss=5.15061 | acc=0.1375 | tpr=0.2772 | fpr=0.8651 | 7995.0 samples/s | 31.2 steps/s
[Step= 150] | Loss=5.16643 | acc=0.1357 | tpr=0.2622 | fpr=0.8666 | 8208.9 samples/s | 32.1 steps/s
[Step= 200] | Loss=5.16170 | acc=0.1356 | tpr=0.2546 | fpr=0.8665 | 8096.3 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.16336 | acc=0.1357 | tpr=0.2524 | fpr=0.8665 | 7887.3 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.16834 | acc=0.1348 | tpr=0.2509 | fpr=0.8673 | 7729.1 samples/s | 30.2 steps/s
[Step= 350] | Loss=5.17067 | acc=0.1343 | tpr=0.2373 | fpr=0.8676 | 8269.9 samples/s | 32.3 steps/s
[Step= 400] | Loss=5.16850 | acc=0.1352 | tpr=0.2380 | fpr=0.8667 | 7659.5 samples/s | 29.9 steps/s
[Step= 450] | Loss=5.16855 | acc=0.1353 | tpr=0.2347 | fpr=0.8665 | 8357.2 samples/s | 32.6 steps/s
[Step= 500] | Loss=5.17027 | acc=0.1356 | tpr=0.2370 | fpr=0.8662 | 8843.4 samples/s | 34.5 steps/s
[Step= 550] | Loss=5.16871 | acc=0.1356 | tpr=0.2360 | fpr=0.8662 | 9399.5 samples/s | 36.7 steps/s
Avg test loss: 5.16910, Avg test acc: 0.13559, Avg tpr: 0.23653, Avg fpr: 0.86624, total FA: 120276

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.77237 | acc=0.1390 | tpr=0.1327 | fpr=0.8609 | 5688.1 samples/s | 22.2 steps/s
[Step= 100] | Loss=5.72532 | acc=0.1381 | tpr=0.1279 | fpr=0.8617 | 8070.2 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.73584 | acc=0.1377 | tpr=0.1254 | fpr=0.8621 | 7919.6 samples/s | 30.9 steps/s
[Step= 200] | Loss=5.72858 | acc=0.1379 | tpr=0.1246 | fpr=0.8618 | 8195.6 samples/s | 32.0 steps/s
[Step= 250] | Loss=5.72972 | acc=0.1381 | tpr=0.1223 | fpr=0.8616 | 8175.7 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.73550 | acc=0.1377 | tpr=0.1258 | fpr=0.8621 | 7482.7 samples/s | 29.2 steps/s
[Step= 350] | Loss=5.73722 | acc=0.1373 | tpr=0.1202 | fpr=0.8624 | 8618.2 samples/s | 33.7 steps/s
[Step= 400] | Loss=5.73483 | acc=0.1375 | tpr=0.1242 | fpr=0.8623 | 7733.0 samples/s | 30.2 steps/s
[Step= 450] | Loss=5.73391 | acc=0.1374 | tpr=0.1227 | fpr=0.8623 | 8610.8 samples/s | 33.6 steps/s
[Step= 500] | Loss=5.73327 | acc=0.1375 | tpr=0.1225 | fpr=0.8623 | 8365.1 samples/s | 32.7 steps/s
[Step= 550] | Loss=5.73025 | acc=0.1378 | tpr=0.1230 | fpr=0.8619 | 9258.5 samples/s | 36.2 steps/s
Avg test loss: 5.73009, Avg test acc: 0.13774, Avg tpr: 0.12322, Avg fpr: 0.86200, total FA: 119687

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.17894 | acc=0.1599 | tpr=0.1549 | fpr=0.8400 | 5619.9 samples/s | 22.0 steps/s
[Step= 100] | Loss=5.13004 | acc=0.1600 | tpr=0.1514 | fpr=0.8398 | 7962.0 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.13581 | acc=0.1589 | tpr=0.1441 | fpr=0.8408 | 8393.3 samples/s | 32.8 steps/s
[Step= 200] | Loss=5.12562 | acc=0.1588 | tpr=0.1388 | fpr=0.8408 | 8149.2 samples/s | 31.8 steps/s
[Step= 250] | Loss=5.12937 | acc=0.1583 | tpr=0.1397 | fpr=0.8414 | 7886.3 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.13131 | acc=0.1580 | tpr=0.1425 | fpr=0.8417 | 8297.8 samples/s | 32.4 steps/s
[Step= 350] | Loss=5.13370 | acc=0.1575 | tpr=0.1365 | fpr=0.8421 | 7527.0 samples/s | 29.4 steps/s
[Step= 400] | Loss=5.12937 | acc=0.1581 | tpr=0.1417 | fpr=0.8416 | 7999.1 samples/s | 31.2 steps/s
[Step= 450] | Loss=5.12810 | acc=0.1582 | tpr=0.1426 | fpr=0.8415 | 8349.9 samples/s | 32.6 steps/s
[Step= 500] | Loss=5.13085 | acc=0.1581 | tpr=0.1436 | fpr=0.8417 | 8487.6 samples/s | 33.2 steps/s
[Step= 550] | Loss=5.12832 | acc=0.1579 | tpr=0.1425 | fpr=0.8418 | 9594.3 samples/s | 37.5 steps/s
Avg test loss: 5.12795, Avg test acc: 0.15782, Avg tpr: 0.14263, Avg fpr: 0.84191, total FA: 116897

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.46027 | acc=0.1195 | tpr=0.1549 | fpr=0.8811 | 5661.1 samples/s | 22.1 steps/s
[Step= 100] | Loss=6.40097 | acc=0.1197 | tpr=0.1471 | fpr=0.8808 | 8051.4 samples/s | 31.5 steps/s
[Step= 150] | Loss=6.42359 | acc=0.1190 | tpr=0.1412 | fpr=0.8814 | 7985.5 samples/s | 31.2 steps/s
[Step= 200] | Loss=6.41818 | acc=0.1197 | tpr=0.1388 | fpr=0.8806 | 8181.5 samples/s | 32.0 steps/s
[Step= 250] | Loss=6.42471 | acc=0.1201 | tpr=0.1424 | fpr=0.8803 | 7888.5 samples/s | 30.8 steps/s
[Step= 300] | Loss=6.42796 | acc=0.1202 | tpr=0.1418 | fpr=0.8802 | 8113.2 samples/s | 31.7 steps/s
[Step= 350] | Loss=6.43263 | acc=0.1197 | tpr=0.1359 | fpr=0.8806 | 7961.0 samples/s | 31.1 steps/s
[Step= 400] | Loss=6.43154 | acc=0.1203 | tpr=0.1406 | fpr=0.8800 | 8365.8 samples/s | 32.7 steps/s
[Step= 450] | Loss=6.43043 | acc=0.1206 | tpr=0.1407 | fpr=0.8797 | 8379.2 samples/s | 32.7 steps/s
[Step= 500] | Loss=6.43239 | acc=0.1204 | tpr=0.1419 | fpr=0.8800 | 7449.2 samples/s | 29.1 steps/s
[Step= 550] | Loss=6.42933 | acc=0.1207 | tpr=0.1413 | fpr=0.8797 | 10494.0 samples/s | 41.0 steps/s
Avg test loss: 6.42857, Avg test acc: 0.12056, Avg tpr: 0.14184, Avg fpr: 0.87983, total FA: 122162

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10197 | acc=0.9820 | tpr=0.9248 | fpr=0.0169 | 5768.8 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.10327 | acc=0.9821 | tpr=0.9318 | fpr=0.0170 | 8028.6 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.10646 | acc=0.9814 | tpr=0.9366 | fpr=0.0178 | 7802.0 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.10821 | acc=0.9811 | tpr=0.9432 | fpr=0.0182 | 8258.0 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.10878 | acc=0.9809 | tpr=0.9389 | fpr=0.0183 | 7882.6 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.10990 | acc=0.9808 | tpr=0.9375 | fpr=0.0184 | 8160.0 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.11015 | acc=0.9809 | tpr=0.9399 | fpr=0.0184 | 8027.0 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.11097 | acc=0.9806 | tpr=0.9365 | fpr=0.0186 | 7803.1 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.11323 | acc=0.9802 | tpr=0.9352 | fpr=0.0190 | 8266.9 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.11220 | acc=0.9804 | tpr=0.9383 | fpr=0.0188 | 8173.3 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.11141 | acc=0.9805 | tpr=0.9379 | fpr=0.0187 | 9781.9 samples/s | 38.2 steps/s
Avg test loss: 0.11119, Avg test acc: 0.98055, Avg tpr: 0.93780, Avg fpr: 0.01867, total FA: 2592

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09553 | acc=0.9824 | tpr=0.8938 | fpr=0.0160 | 5638.4 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.09776 | acc=0.9826 | tpr=0.9041 | fpr=0.0160 | 8105.5 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.10018 | acc=0.9824 | tpr=0.9135 | fpr=0.0163 | 8106.9 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.10122 | acc=0.9824 | tpr=0.9202 | fpr=0.0165 | 8016.7 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.10118 | acc=0.9824 | tpr=0.9188 | fpr=0.0164 | 8077.7 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.10260 | acc=0.9823 | tpr=0.9193 | fpr=0.0166 | 8365.9 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.10271 | acc=0.9822 | tpr=0.9198 | fpr=0.0167 | 7459.9 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.10351 | acc=0.9821 | tpr=0.9158 | fpr=0.0167 | 8265.0 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.10548 | acc=0.9818 | tpr=0.9133 | fpr=0.0169 | 8292.8 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.10461 | acc=0.9819 | tpr=0.9154 | fpr=0.0169 | 8384.9 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.10392 | acc=0.9819 | tpr=0.9148 | fpr=0.0169 | 9711.2 samples/s | 37.9 steps/s
Avg test loss: 0.10374, Avg test acc: 0.98194, Avg tpr: 0.91442, Avg fpr: 0.01683, total FA: 2337

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10887 | acc=0.9788 | tpr=0.9336 | fpr=0.0204 | 5633.4 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.11092 | acc=0.9788 | tpr=0.9510 | fpr=0.0207 | 8305.3 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.11578 | acc=0.9782 | tpr=0.9553 | fpr=0.0214 | 7938.6 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.11757 | acc=0.9782 | tpr=0.9585 | fpr=0.0215 | 8143.8 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.11804 | acc=0.9781 | tpr=0.9537 | fpr=0.0215 | 8239.3 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.11903 | acc=0.9780 | tpr=0.9527 | fpr=0.0215 | 7711.3 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.11943 | acc=0.9780 | tpr=0.9549 | fpr=0.0216 | 8264.1 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.12041 | acc=0.9779 | tpr=0.9508 | fpr=0.0217 | 8168.8 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.12252 | acc=0.9775 | tpr=0.9494 | fpr=0.0220 | 8447.3 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.12160 | acc=0.9776 | tpr=0.9511 | fpr=0.0219 | 8179.3 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.12058 | acc=0.9778 | tpr=0.9507 | fpr=0.0217 | 9120.5 samples/s | 35.6 steps/s
Avg test loss: 0.12036, Avg test acc: 0.97785, Avg tpr: 0.95048, Avg fpr: 0.02166, total FA: 3007

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10613 | acc=0.9799 | tpr=0.9159 | fpr=0.0189 | 5815.0 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.10777 | acc=0.9796 | tpr=0.9254 | fpr=0.0194 | 7749.3 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.11085 | acc=0.9795 | tpr=0.9352 | fpr=0.0197 | 7228.4 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.11281 | acc=0.9794 | tpr=0.9366 | fpr=0.0198 | 8081.7 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.11233 | acc=0.9796 | tpr=0.9284 | fpr=0.0195 | 8197.7 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.11436 | acc=0.9797 | tpr=0.9287 | fpr=0.0194 | 8292.6 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.11458 | acc=0.9797 | tpr=0.9317 | fpr=0.0194 | 7932.3 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.11551 | acc=0.9798 | tpr=0.9316 | fpr=0.0194 | 8126.5 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.11795 | acc=0.9793 | tpr=0.9294 | fpr=0.0198 | 7825.2 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.11695 | acc=0.9795 | tpr=0.9322 | fpr=0.0197 | 8078.9 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.11608 | acc=0.9796 | tpr=0.9316 | fpr=0.0195 | 11676.6 samples/s | 45.6 steps/s
Avg test loss: 0.11591, Avg test acc: 0.97961, Avg tpr: 0.93106, Avg fpr: 0.01951, total FA: 2709

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.09853 | acc=0.9816 | tpr=0.9159 | fpr=0.0173 | 5539.4 samples/s | 21.6 steps/s
[Step= 100] | Loss=0.10177 | acc=0.9814 | tpr=0.9339 | fpr=0.0177 | 8235.6 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.10529 | acc=0.9810 | tpr=0.9395 | fpr=0.0183 | 7954.0 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.10680 | acc=0.9809 | tpr=0.9443 | fpr=0.0184 | 7799.6 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.10750 | acc=0.9808 | tpr=0.9406 | fpr=0.0185 | 8218.6 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.10867 | acc=0.9807 | tpr=0.9396 | fpr=0.0185 | 8703.3 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.10891 | acc=0.9807 | tpr=0.9418 | fpr=0.0186 | 8149.4 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.10962 | acc=0.9806 | tpr=0.9387 | fpr=0.0186 | 7976.1 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.11152 | acc=0.9803 | tpr=0.9362 | fpr=0.0189 | 7616.2 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.11071 | acc=0.9805 | tpr=0.9379 | fpr=0.0188 | 8765.5 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.11005 | acc=0.9805 | tpr=0.9363 | fpr=0.0187 | 9529.0 samples/s | 37.2 steps/s
Avg test loss: 0.10987, Avg test acc: 0.98049, Avg tpr: 0.93582, Avg fpr: 0.01870, total FA: 2596

server round 29/50

clients selected: [1 2 4 7 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=40001 Epoch=195.2] | Loss=0.00120 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.498 | L2-Norm(final)=15.313 | 6168.9 samples/s | 96.4 steps/s
[Step=40050 Epoch=195.4] | Loss=0.02057 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.499 | L2-Norm(final)=15.307 | 4720.1 samples/s | 73.8 steps/s
[Step=40100 Epoch=195.7] | Loss=0.01981 | Reg=0.00110 | acc=0.9375 | L2-Norm=10.499 | L2-Norm(final)=15.307 | 5560.6 samples/s | 86.9 steps/s
[Step=40150 Epoch=195.9] | Loss=0.02074 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.499 | L2-Norm(final)=15.305 | 5463.3 samples/s | 85.4 steps/s
[Step=40200 Epoch=196.2] | Loss=0.02035 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.499 | L2-Norm(final)=15.304 | 8805.1 samples/s | 137.6 steps/s
[Step=40250 Epoch=196.4] | Loss=0.01967 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.499 | L2-Norm(final)=15.303 | 2411.7 samples/s | 37.7 steps/s
[Step=40300 Epoch=196.6] | Loss=0.01952 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.499 | L2-Norm(final)=15.303 | 5749.4 samples/s | 89.8 steps/s
[Step=40350 Epoch=196.9] | Loss=0.01959 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.499 | L2-Norm(final)=15.303 | 5550.5 samples/s | 86.7 steps/s
[Step=40400 Epoch=197.1] | Loss=0.01983 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.499 | L2-Norm(final)=15.304 | 8043.7 samples/s | 125.7 steps/s
[Step=40450 Epoch=197.4] | Loss=0.02000 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.499 | L2-Norm(final)=15.303 | 2528.8 samples/s | 39.5 steps/s
[Step=40500 Epoch=197.6] | Loss=0.01987 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.499 | L2-Norm(final)=15.303 | 5444.0 samples/s | 85.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=40501 Epoch=197.6] | Loss=0.03308 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.499 | L2-Norm(final)=15.304 | 5440.6 samples/s | 85.0 steps/s
[Step=40550 Epoch=197.9] | Loss=0.02554 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.540 | L2-Norm(final)=15.299 | 4612.3 samples/s | 72.1 steps/s
[Step=40600 Epoch=198.1] | Loss=0.02815 | Reg=0.00112 | acc=0.9531 | L2-Norm=10.582 | L2-Norm(final)=15.291 | 4855.5 samples/s | 75.9 steps/s
[Step=40650 Epoch=198.4] | Loss=0.02634 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.615 | L2-Norm(final)=15.287 | 4895.8 samples/s | 76.5 steps/s
[Step=40700 Epoch=198.6] | Loss=0.02408 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.639 | L2-Norm(final)=15.285 | 6967.0 samples/s | 108.9 steps/s
[Step=40750 Epoch=198.8] | Loss=0.02078 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.659 | L2-Norm(final)=15.286 | 2240.7 samples/s | 35.0 steps/s
[Step=40800 Epoch=199.1] | Loss=0.01862 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.674 | L2-Norm(final)=15.288 | 4873.8 samples/s | 76.2 steps/s
[Step=40850 Epoch=199.3] | Loss=0.01710 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.687 | L2-Norm(final)=15.291 | 4843.8 samples/s | 75.7 steps/s
[Step=40900 Epoch=199.6] | Loss=0.01622 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.699 | L2-Norm(final)=15.293 | 6502.9 samples/s | 101.6 steps/s
[Step=40950 Epoch=199.8] | Loss=0.01485 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.708 | L2-Norm(final)=15.295 | 2309.2 samples/s | 36.1 steps/s
[Step=41000 Epoch=200.1] | Loss=0.01391 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.717 | L2-Norm(final)=15.298 | 4926.1 samples/s | 77.0 steps/s
[Step=41050 Epoch=200.3] | Loss=0.01340 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.724 | L2-Norm(final)=15.300 | 4845.5 samples/s | 75.7 steps/s
[Step=41100 Epoch=200.5] | Loss=0.01288 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.730 | L2-Norm(final)=15.302 | 5965.6 samples/s | 93.2 steps/s
[Step=41150 Epoch=200.8] | Loss=0.01216 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.736 | L2-Norm(final)=15.304 | 2394.3 samples/s | 37.4 steps/s
[Step=41200 Epoch=201.0] | Loss=0.01155 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.742 | L2-Norm(final)=15.307 | 4950.3 samples/s | 77.3 steps/s
[Step=41250 Epoch=201.3] | Loss=0.01113 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.747 | L2-Norm(final)=15.309 | 4739.7 samples/s | 74.1 steps/s
[Step=41300 Epoch=201.5] | Loss=0.01063 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.751 | L2-Norm(final)=15.310 | 5612.3 samples/s | 87.7 steps/s
[Step=41350 Epoch=201.8] | Loss=0.01025 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.756 | L2-Norm(final)=15.312 | 2470.1 samples/s | 38.6 steps/s
[Step=41400 Epoch=202.0] | Loss=0.00986 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.760 | L2-Norm(final)=15.314 | 4823.0 samples/s | 75.4 steps/s
[Step=41450 Epoch=202.3] | Loss=0.00954 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.763 | L2-Norm(final)=15.316 | 4835.4 samples/s | 75.6 steps/s
[Step=41500 Epoch=202.5] | Loss=0.00927 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.766 | L2-Norm(final)=15.318 | 5296.5 samples/s | 82.8 steps/s
[Step=41550 Epoch=202.7] | Loss=0.00895 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=15.320 | 2509.1 samples/s | 39.2 steps/s
[Step=41600 Epoch=203.0] | Loss=0.00867 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.773 | L2-Norm(final)=15.322 | 4854.9 samples/s | 75.9 steps/s
[Step=41650 Epoch=203.2] | Loss=0.00842 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.775 | L2-Norm(final)=15.324 | 4954.5 samples/s | 77.4 steps/s
[Step=41700 Epoch=203.5] | Loss=0.00821 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.778 | L2-Norm(final)=15.325 | 4865.8 samples/s | 76.0 steps/s
[Step=41750 Epoch=203.7] | Loss=0.00804 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.780 | L2-Norm(final)=15.327 | 2544.6 samples/s | 39.8 steps/s
[Step=41800 Epoch=204.0] | Loss=0.00785 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.783 | L2-Norm(final)=15.329 | 4739.0 samples/s | 74.0 steps/s
[Step=41850 Epoch=204.2] | Loss=0.00765 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.785 | L2-Norm(final)=15.331 | 4756.6 samples/s | 74.3 steps/s
[Step=41900 Epoch=204.5] | Loss=0.00746 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.788 | L2-Norm(final)=15.333 | 4819.1 samples/s | 75.3 steps/s
[Step=41950 Epoch=204.7] | Loss=0.00737 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.790 | L2-Norm(final)=15.335 | 2615.8 samples/s | 40.9 steps/s
[Step=42000 Epoch=204.9] | Loss=0.00725 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.792 | L2-Norm(final)=15.336 | 4885.4 samples/s | 76.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step42000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=136.4] | Loss=0.01949 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.498 | L2-Norm(final)=13.945 | 5520.7 samples/s | 86.3 steps/s
[Step=28050 Epoch=136.7] | Loss=0.02266 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.499 | L2-Norm(final)=13.941 | 5050.2 samples/s | 78.9 steps/s
[Step=28100 Epoch=136.9] | Loss=0.01937 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.499 | L2-Norm(final)=13.945 | 5516.1 samples/s | 86.2 steps/s
[Step=28150 Epoch=137.2] | Loss=0.02060 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.499 | L2-Norm(final)=13.948 | 5609.3 samples/s | 87.6 steps/s
[Step=28200 Epoch=137.4] | Loss=0.02121 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.499 | L2-Norm(final)=13.949 | 8693.5 samples/s | 135.8 steps/s
[Step=28250 Epoch=137.6] | Loss=0.02091 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.499 | L2-Norm(final)=13.950 | 2445.4 samples/s | 38.2 steps/s
[Step=28300 Epoch=137.9] | Loss=0.02103 | Reg=0.00110 | acc=0.9531 | L2-Norm=10.499 | L2-Norm(final)=13.950 | 5625.7 samples/s | 87.9 steps/s
[Step=28350 Epoch=138.1] | Loss=0.02109 | Reg=0.00110 | acc=0.9531 | L2-Norm=10.499 | L2-Norm(final)=13.950 | 5577.0 samples/s | 87.1 steps/s
[Step=28400 Epoch=138.4] | Loss=0.02082 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.499 | L2-Norm(final)=13.950 | 7748.1 samples/s | 121.1 steps/s
[Step=28450 Epoch=138.6] | Loss=0.02083 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.499 | L2-Norm(final)=13.951 | 2499.8 samples/s | 39.1 steps/s
[Step=28500 Epoch=138.9] | Loss=0.02043 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.499 | L2-Norm(final)=13.952 | 5632.5 samples/s | 88.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=138.9] | Loss=0.01304 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.499 | L2-Norm(final)=13.968 | 5679.3 samples/s | 88.7 steps/s
[Step=28550 Epoch=139.1] | Loss=0.02604 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.546 | L2-Norm(final)=13.963 | 4454.7 samples/s | 69.6 steps/s
[Step=28600 Epoch=139.4] | Loss=0.02475 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.587 | L2-Norm(final)=13.959 | 4827.0 samples/s | 75.4 steps/s
[Step=28650 Epoch=139.6] | Loss=0.02189 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.618 | L2-Norm(final)=13.960 | 4842.7 samples/s | 75.7 steps/s
[Step=28700 Epoch=139.8] | Loss=0.02243 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.643 | L2-Norm(final)=13.960 | 6923.8 samples/s | 108.2 steps/s
[Step=28750 Epoch=140.1] | Loss=0.01977 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.665 | L2-Norm(final)=13.961 | 2258.9 samples/s | 35.3 steps/s
[Step=28800 Epoch=140.3] | Loss=0.01814 | Reg=0.00114 | acc=0.9531 | L2-Norm=10.682 | L2-Norm(final)=13.964 | 4859.0 samples/s | 75.9 steps/s
[Step=28850 Epoch=140.6] | Loss=0.01664 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.696 | L2-Norm(final)=13.966 | 4849.3 samples/s | 75.8 steps/s
[Step=28900 Epoch=140.8] | Loss=0.01553 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.708 | L2-Norm(final)=13.969 | 6363.4 samples/s | 99.4 steps/s
[Step=28950 Epoch=141.1] | Loss=0.01442 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.719 | L2-Norm(final)=13.972 | 2356.2 samples/s | 36.8 steps/s
[Step=29000 Epoch=141.3] | Loss=0.01358 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.728 | L2-Norm(final)=13.975 | 4845.5 samples/s | 75.7 steps/s
[Step=29050 Epoch=141.5] | Loss=0.01284 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.736 | L2-Norm(final)=13.977 | 4897.7 samples/s | 76.5 steps/s
[Step=29100 Epoch=141.8] | Loss=0.01229 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.744 | L2-Norm(final)=13.980 | 5789.4 samples/s | 90.5 steps/s
[Step=29150 Epoch=142.0] | Loss=0.01182 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.750 | L2-Norm(final)=13.982 | 2430.1 samples/s | 38.0 steps/s
[Step=29200 Epoch=142.3] | Loss=0.01126 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.756 | L2-Norm(final)=13.985 | 4902.2 samples/s | 76.6 steps/s
[Step=29250 Epoch=142.5] | Loss=0.01088 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.762 | L2-Norm(final)=13.987 | 4813.2 samples/s | 75.2 steps/s
[Step=29300 Epoch=142.8] | Loss=0.01051 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.767 | L2-Norm(final)=13.990 | 5392.9 samples/s | 84.3 steps/s
[Step=29350 Epoch=143.0] | Loss=0.01013 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.773 | L2-Norm(final)=13.992 | 2511.7 samples/s | 39.2 steps/s
[Step=29400 Epoch=143.3] | Loss=0.00983 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.777 | L2-Norm(final)=13.995 | 4823.6 samples/s | 75.4 steps/s
[Step=29450 Epoch=143.5] | Loss=0.00962 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.782 | L2-Norm(final)=13.997 | 4927.5 samples/s | 77.0 steps/s
[Step=29500 Epoch=143.7] | Loss=0.00929 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.786 | L2-Norm(final)=13.999 | 4945.6 samples/s | 77.3 steps/s
[Step=29550 Epoch=144.0] | Loss=0.00901 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.790 | L2-Norm(final)=14.001 | 2596.6 samples/s | 40.6 steps/s
[Step=29600 Epoch=144.2] | Loss=0.00878 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.794 | L2-Norm(final)=14.003 | 4837.3 samples/s | 75.6 steps/s
[Step=29650 Epoch=144.5] | Loss=0.00854 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.798 | L2-Norm(final)=14.006 | 4893.9 samples/s | 76.5 steps/s
[Step=29700 Epoch=144.7] | Loss=0.00825 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.801 | L2-Norm(final)=14.008 | 4801.5 samples/s | 75.0 steps/s
[Step=29750 Epoch=145.0] | Loss=0.00812 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.805 | L2-Norm(final)=14.010 | 2681.3 samples/s | 41.9 steps/s
[Step=29800 Epoch=145.2] | Loss=0.00802 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.808 | L2-Norm(final)=14.012 | 4855.6 samples/s | 75.9 steps/s
[Step=29850 Epoch=145.4] | Loss=0.00783 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=14.014 | 4955.0 samples/s | 77.4 steps/s
[Step=29900 Epoch=145.7] | Loss=0.00766 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.814 | L2-Norm(final)=14.016 | 4765.3 samples/s | 74.5 steps/s
[Step=29950 Epoch=145.9] | Loss=0.00753 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.817 | L2-Norm(final)=14.017 | 2616.3 samples/s | 40.9 steps/s
[Step=30000 Epoch=146.2] | Loss=0.00739 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.819 | L2-Norm(final)=14.019 | 5010.3 samples/s | 78.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step30000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=36001 Epoch=176.5] | Loss=0.01593 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.498 | L2-Norm(final)=15.015 | 5798.6 samples/s | 90.6 steps/s
[Step=36050 Epoch=176.8] | Loss=0.01728 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.500 | L2-Norm(final)=15.021 | 4829.2 samples/s | 75.5 steps/s
[Step=36100 Epoch=177.0] | Loss=0.01791 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.500 | L2-Norm(final)=15.022 | 5721.2 samples/s | 89.4 steps/s
[Step=36150 Epoch=177.3] | Loss=0.01894 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.500 | L2-Norm(final)=15.021 | 5489.5 samples/s | 85.8 steps/s
[Step=36200 Epoch=177.5] | Loss=0.01900 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.500 | L2-Norm(final)=15.020 | 9031.7 samples/s | 141.1 steps/s
[Step=36250 Epoch=177.8] | Loss=0.01870 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.500 | L2-Norm(final)=15.020 | 2396.0 samples/s | 37.4 steps/s
[Step=36300 Epoch=178.0] | Loss=0.01881 | Reg=0.00110 | acc=0.9531 | L2-Norm=10.500 | L2-Norm(final)=15.020 | 5673.0 samples/s | 88.6 steps/s
[Step=36350 Epoch=178.3] | Loss=0.01908 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.500 | L2-Norm(final)=15.021 | 5731.0 samples/s | 89.5 steps/s
[Step=36400 Epoch=178.5] | Loss=0.01887 | Reg=0.00110 | acc=0.9531 | L2-Norm=10.500 | L2-Norm(final)=15.021 | 8083.2 samples/s | 126.3 steps/s
[Step=36450 Epoch=178.7] | Loss=0.01905 | Reg=0.00110 | acc=0.9531 | L2-Norm=10.500 | L2-Norm(final)=15.023 | 2463.7 samples/s | 38.5 steps/s
[Step=36500 Epoch=179.0] | Loss=0.01911 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.500 | L2-Norm(final)=15.024 | 5778.8 samples/s | 90.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=36501 Epoch=179.0] | Loss=0.00319 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.500 | L2-Norm(final)=15.040 | 5530.6 samples/s | 86.4 steps/s
[Step=36550 Epoch=179.2] | Loss=0.02622 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.541 | L2-Norm(final)=15.035 | 4679.6 samples/s | 73.1 steps/s
[Step=36600 Epoch=179.5] | Loss=0.02383 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.577 | L2-Norm(final)=15.033 | 4840.4 samples/s | 75.6 steps/s
[Step=36650 Epoch=179.7] | Loss=0.02186 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.606 | L2-Norm(final)=15.033 | 4872.8 samples/s | 76.1 steps/s
[Step=36700 Epoch=180.0] | Loss=0.02121 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.627 | L2-Norm(final)=15.033 | 7109.0 samples/s | 111.1 steps/s
[Step=36750 Epoch=180.2] | Loss=0.01927 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.644 | L2-Norm(final)=15.033 | 2256.2 samples/s | 35.3 steps/s
[Step=36800 Epoch=180.5] | Loss=0.01707 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.658 | L2-Norm(final)=15.034 | 4808.2 samples/s | 75.1 steps/s
[Step=36850 Epoch=180.7] | Loss=0.01584 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.670 | L2-Norm(final)=15.037 | 4890.0 samples/s | 76.4 steps/s
[Step=36900 Epoch=181.0] | Loss=0.01452 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.681 | L2-Norm(final)=15.039 | 6657.6 samples/s | 104.0 steps/s
[Step=36950 Epoch=181.2] | Loss=0.01343 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.690 | L2-Norm(final)=15.042 | 2311.7 samples/s | 36.1 steps/s
[Step=37000 Epoch=181.4] | Loss=0.01266 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.698 | L2-Norm(final)=15.044 | 4836.1 samples/s | 75.6 steps/s
[Step=37050 Epoch=181.7] | Loss=0.01206 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.705 | L2-Norm(final)=15.047 | 4846.9 samples/s | 75.7 steps/s
[Step=37100 Epoch=181.9] | Loss=0.01142 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.712 | L2-Norm(final)=15.049 | 6304.9 samples/s | 98.5 steps/s
[Step=37150 Epoch=182.2] | Loss=0.01100 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.718 | L2-Norm(final)=15.051 | 2380.1 samples/s | 37.2 steps/s
[Step=37200 Epoch=182.4] | Loss=0.01052 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.724 | L2-Norm(final)=15.054 | 4830.4 samples/s | 75.5 steps/s
[Step=37250 Epoch=182.7] | Loss=0.01025 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.729 | L2-Norm(final)=15.056 | 4800.2 samples/s | 75.0 steps/s
[Step=37300 Epoch=182.9] | Loss=0.01004 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.734 | L2-Norm(final)=15.057 | 5914.7 samples/s | 92.4 steps/s
[Step=37350 Epoch=183.2] | Loss=0.00957 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.738 | L2-Norm(final)=15.059 | 2401.6 samples/s | 37.5 steps/s
[Step=37400 Epoch=183.4] | Loss=0.00922 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.742 | L2-Norm(final)=15.061 | 4805.4 samples/s | 75.1 steps/s
[Step=37450 Epoch=183.6] | Loss=0.00902 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.746 | L2-Norm(final)=15.063 | 4854.9 samples/s | 75.9 steps/s
[Step=37500 Epoch=183.9] | Loss=0.00878 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.750 | L2-Norm(final)=15.065 | 5617.8 samples/s | 87.8 steps/s
[Step=37550 Epoch=184.1] | Loss=0.00848 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.753 | L2-Norm(final)=15.066 | 2449.3 samples/s | 38.3 steps/s
[Step=37600 Epoch=184.4] | Loss=0.00828 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.757 | L2-Norm(final)=15.068 | 4888.0 samples/s | 76.4 steps/s
[Step=37650 Epoch=184.6] | Loss=0.00805 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.760 | L2-Norm(final)=15.070 | 4850.3 samples/s | 75.8 steps/s
[Step=37700 Epoch=184.9] | Loss=0.00793 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.763 | L2-Norm(final)=15.072 | 5348.0 samples/s | 83.6 steps/s
[Step=37750 Epoch=185.1] | Loss=0.00767 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.766 | L2-Norm(final)=15.073 | 2528.9 samples/s | 39.5 steps/s
[Step=37800 Epoch=185.4] | Loss=0.00744 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.768 | L2-Norm(final)=15.075 | 4863.3 samples/s | 76.0 steps/s
[Step=37850 Epoch=185.6] | Loss=0.00727 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.771 | L2-Norm(final)=15.077 | 4887.3 samples/s | 76.4 steps/s
[Step=37900 Epoch=185.9] | Loss=0.00721 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.774 | L2-Norm(final)=15.079 | 5088.8 samples/s | 79.5 steps/s
[Step=37950 Epoch=186.1] | Loss=0.00704 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.776 | L2-Norm(final)=15.080 | 2601.5 samples/s | 40.6 steps/s
[Step=38000 Epoch=186.3] | Loss=0.00688 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.779 | L2-Norm(final)=15.082 | 4735.1 samples/s | 74.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step38000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=30001 Epoch=286.5] | Loss=0.00005 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.498 | L2-Norm(final)=16.364 | 5423.3 samples/s | 84.7 steps/s
[Step=30050 Epoch=287.0] | Loss=0.00033 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=16.367 | 4693.0 samples/s | 73.3 steps/s
[Step=30100 Epoch=287.4] | Loss=0.00038 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=16.370 | 8398.9 samples/s | 131.2 steps/s
[Step=30150 Epoch=287.9] | Loss=0.00033 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=16.376 | 2319.0 samples/s | 36.2 steps/s
[Step=30200 Epoch=288.4] | Loss=0.00036 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=16.384 | 7590.9 samples/s | 118.6 steps/s
[Step=30250 Epoch=288.9] | Loss=0.00034 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=16.392 | 2409.5 samples/s | 37.6 steps/s
[Step=30300 Epoch=289.3] | Loss=0.00035 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=16.401 | 6979.1 samples/s | 109.0 steps/s
[Step=30350 Epoch=289.8] | Loss=0.00034 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=16.410 | 2462.1 samples/s | 38.5 steps/s
[Step=30400 Epoch=290.3] | Loss=0.00035 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=16.421 | 6257.3 samples/s | 97.8 steps/s
[Step=30450 Epoch=290.8] | Loss=0.00034 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=16.431 | 2557.7 samples/s | 40.0 steps/s
[Step=30500 Epoch=291.3] | Loss=0.00034 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=16.441 | 5806.5 samples/s | 90.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=30501 Epoch=291.3] | Loss=0.00047 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.494 | L2-Norm(final)=16.545 | 5694.2 samples/s | 89.0 steps/s
[Step=30550 Epoch=291.7] | Loss=0.00021 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.525 | L2-Norm(final)=16.557 | 4209.4 samples/s | 65.8 steps/s
[Step=30600 Epoch=292.2] | Loss=0.00053 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.536 | L2-Norm(final)=16.561 | 6679.7 samples/s | 104.4 steps/s
[Step=30650 Epoch=292.7] | Loss=0.00057 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.568 | L2-Norm(final)=16.560 | 2194.3 samples/s | 34.3 steps/s
[Step=30700 Epoch=293.2] | Loss=0.00046 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.594 | L2-Norm(final)=16.562 | 6172.7 samples/s | 96.4 steps/s
[Step=30750 Epoch=293.6] | Loss=0.00037 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.609 | L2-Norm(final)=16.563 | 2227.3 samples/s | 34.8 steps/s
[Step=30800 Epoch=294.1] | Loss=0.00031 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.617 | L2-Norm(final)=16.564 | 5785.9 samples/s | 90.4 steps/s
[Step=30850 Epoch=294.6] | Loss=0.00026 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.620 | L2-Norm(final)=16.565 | 2322.8 samples/s | 36.3 steps/s
[Step=30900 Epoch=295.1] | Loss=0.00023 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.621 | L2-Norm(final)=16.566 | 5367.1 samples/s | 83.9 steps/s
[Step=30950 Epoch=295.6] | Loss=0.00020 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.620 | L2-Norm(final)=16.566 | 2346.3 samples/s | 36.7 steps/s
[Step=31000 Epoch=296.0] | Loss=0.00018 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.618 | L2-Norm(final)=16.567 | 5048.9 samples/s | 78.9 steps/s
[Step=31050 Epoch=296.5] | Loss=0.00017 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.615 | L2-Norm(final)=16.567 | 2506.0 samples/s | 39.2 steps/s
[Step=31100 Epoch=297.0] | Loss=0.00015 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.612 | L2-Norm(final)=16.567 | 4608.3 samples/s | 72.0 steps/s
[Step=31150 Epoch=297.5] | Loss=0.00014 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.608 | L2-Norm(final)=16.568 | 2524.6 samples/s | 39.4 steps/s
[Step=31200 Epoch=297.9] | Loss=0.00013 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.604 | L2-Norm(final)=16.568 | 4624.7 samples/s | 72.3 steps/s
[Step=31250 Epoch=298.4] | Loss=0.00012 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.600 | L2-Norm(final)=16.568 | 2547.4 samples/s | 39.8 steps/s
[Step=31300 Epoch=298.9] | Loss=0.00012 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.595 | L2-Norm(final)=16.568 | 4672.9 samples/s | 73.0 steps/s
[Step=31350 Epoch=299.4] | Loss=0.00011 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.590 | L2-Norm(final)=16.569 | 2550.0 samples/s | 39.8 steps/s
[Step=31400 Epoch=299.9] | Loss=0.00010 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.585 | L2-Norm(final)=16.569 | 4614.1 samples/s | 72.1 steps/s
[Step=31450 Epoch=300.3] | Loss=0.00010 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.580 | L2-Norm(final)=16.569 | 2565.6 samples/s | 40.1 steps/s
[Step=31500 Epoch=300.8] | Loss=0.00009 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.574 | L2-Norm(final)=16.569 | 4600.2 samples/s | 71.9 steps/s
[Step=31550 Epoch=301.3] | Loss=0.00009 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.569 | L2-Norm(final)=16.569 | 7481.7 samples/s | 116.9 steps/s
[Step=31600 Epoch=301.8] | Loss=0.00008 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.563 | L2-Norm(final)=16.570 | 2122.2 samples/s | 33.2 steps/s
[Step=31650 Epoch=302.2] | Loss=0.00008 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.558 | L2-Norm(final)=16.570 | 6755.0 samples/s | 105.5 steps/s
[Step=31700 Epoch=302.7] | Loss=0.00008 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.552 | L2-Norm(final)=16.570 | 2177.0 samples/s | 34.0 steps/s
[Step=31750 Epoch=303.2] | Loss=0.00007 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.546 | L2-Norm(final)=16.570 | 6260.0 samples/s | 97.8 steps/s
[Step=31800 Epoch=303.7] | Loss=0.00007 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.540 | L2-Norm(final)=16.570 | 2218.7 samples/s | 34.7 steps/s
[Step=31850 Epoch=304.1] | Loss=0.00007 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.534 | L2-Norm(final)=16.570 | 5795.2 samples/s | 90.6 steps/s
[Step=31900 Epoch=304.6] | Loss=0.00007 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.528 | L2-Norm(final)=16.571 | 2355.0 samples/s | 36.8 steps/s
[Step=31950 Epoch=305.1] | Loss=0.00006 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.522 | L2-Norm(final)=16.571 | 5220.5 samples/s | 81.6 steps/s
[Step=32000 Epoch=305.6] | Loss=0.00006 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.516 | L2-Norm(final)=16.571 | 2374.1 samples/s | 37.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step32000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=226.2] | Loss=0.00002 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.498 | L2-Norm(final)=14.794 | 5713.6 samples/s | 89.3 steps/s
[Step=24050 Epoch=226.6] | Loss=0.00083 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=14.804 | 4596.7 samples/s | 71.8 steps/s
[Step=24100 Epoch=227.1] | Loss=0.00079 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=14.814 | 8105.3 samples/s | 126.6 steps/s
[Step=24150 Epoch=227.6] | Loss=0.00080 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=14.826 | 2375.2 samples/s | 37.1 steps/s
[Step=24200 Epoch=228.0] | Loss=0.00076 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=14.839 | 6997.8 samples/s | 109.3 steps/s
[Step=24250 Epoch=228.5] | Loss=0.00078 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=14.850 | 2473.3 samples/s | 38.6 steps/s
[Step=24300 Epoch=229.0] | Loss=0.00076 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=14.862 | 6216.0 samples/s | 97.1 steps/s
[Step=24350 Epoch=229.4] | Loss=0.00074 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=14.873 | 2604.8 samples/s | 40.7 steps/s
[Step=24400 Epoch=229.9] | Loss=0.00072 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=14.883 | 5530.9 samples/s | 86.4 steps/s
[Step=24450 Epoch=230.4] | Loss=0.00074 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=14.894 | 2738.1 samples/s | 42.8 steps/s
[Step=24500 Epoch=230.9] | Loss=0.00072 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=14.905 | 5140.8 samples/s | 80.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=230.9] | Loss=0.00005 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=15.020 | 5597.2 samples/s | 87.5 steps/s
[Step=24550 Epoch=231.3] | Loss=0.00369 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.519 | L2-Norm(final)=15.018 | 4252.6 samples/s | 66.4 steps/s
[Step=24600 Epoch=231.8] | Loss=0.00227 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.563 | L2-Norm(final)=15.009 | 6585.0 samples/s | 102.9 steps/s
[Step=24650 Epoch=232.3] | Loss=0.00159 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.583 | L2-Norm(final)=15.009 | 2216.4 samples/s | 34.6 steps/s
[Step=24700 Epoch=232.7] | Loss=0.00120 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.592 | L2-Norm(final)=15.010 | 5771.0 samples/s | 90.2 steps/s
[Step=24750 Epoch=233.2] | Loss=0.00096 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.596 | L2-Norm(final)=15.011 | 2337.2 samples/s | 36.5 steps/s
[Step=24800 Epoch=233.7] | Loss=0.00080 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.596 | L2-Norm(final)=15.012 | 5170.4 samples/s | 80.8 steps/s
[Step=24850 Epoch=234.2] | Loss=0.00069 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.595 | L2-Norm(final)=15.012 | 2409.3 samples/s | 37.6 steps/s
[Step=24900 Epoch=234.6] | Loss=0.00060 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.593 | L2-Norm(final)=15.013 | 4881.5 samples/s | 76.3 steps/s
[Step=24950 Epoch=235.1] | Loss=0.00054 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.591 | L2-Norm(final)=15.014 | 2493.3 samples/s | 39.0 steps/s
[Step=25000 Epoch=235.6] | Loss=0.00048 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.588 | L2-Norm(final)=15.015 | 4650.6 samples/s | 72.7 steps/s
[Step=25050 Epoch=236.0] | Loss=0.00044 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.584 | L2-Norm(final)=15.015 | 2578.3 samples/s | 40.3 steps/s
[Step=25100 Epoch=236.5] | Loss=0.00041 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.581 | L2-Norm(final)=15.016 | 4660.4 samples/s | 72.8 steps/s
[Step=25150 Epoch=237.0] | Loss=0.00037 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.577 | L2-Norm(final)=15.017 | 2541.0 samples/s | 39.7 steps/s
[Step=25200 Epoch=237.5] | Loss=0.00035 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.573 | L2-Norm(final)=15.018 | 4636.0 samples/s | 72.4 steps/s
[Step=25250 Epoch=237.9] | Loss=0.00033 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.569 | L2-Norm(final)=15.018 | 2870.4 samples/s | 44.8 steps/s
[Step=25300 Epoch=238.4] | Loss=0.00031 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.565 | L2-Norm(final)=15.019 | 4146.6 samples/s | 64.8 steps/s
[Step=25350 Epoch=238.9] | Loss=0.00029 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.561 | L2-Norm(final)=15.020 | 6658.5 samples/s | 104.0 steps/s
[Step=25400 Epoch=239.3] | Loss=0.00027 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.556 | L2-Norm(final)=15.021 | 2191.3 samples/s | 34.2 steps/s
[Step=25450 Epoch=239.8] | Loss=0.00026 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.552 | L2-Norm(final)=15.021 | 6002.2 samples/s | 93.8 steps/s
[Step=25500 Epoch=240.3] | Loss=0.00025 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.548 | L2-Norm(final)=15.022 | 2279.7 samples/s | 35.6 steps/s
[Step=25550 Epoch=240.8] | Loss=0.00023 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.543 | L2-Norm(final)=15.023 | 5425.6 samples/s | 84.8 steps/s
[Step=25600 Epoch=241.2] | Loss=0.00022 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.539 | L2-Norm(final)=15.024 | 2377.5 samples/s | 37.1 steps/s
[Step=25650 Epoch=241.7] | Loss=0.00021 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.534 | L2-Norm(final)=15.024 | 4914.1 samples/s | 76.8 steps/s
[Step=25700 Epoch=242.2] | Loss=0.00020 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.529 | L2-Norm(final)=15.025 | 2506.4 samples/s | 39.2 steps/s
[Step=25750 Epoch=242.6] | Loss=0.00020 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.525 | L2-Norm(final)=15.026 | 4661.2 samples/s | 72.8 steps/s
[Step=25800 Epoch=243.1] | Loss=0.00019 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.520 | L2-Norm(final)=15.027 | 2564.4 samples/s | 40.1 steps/s
[Step=25850 Epoch=243.6] | Loss=0.00018 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.515 | L2-Norm(final)=15.027 | 4666.9 samples/s | 72.9 steps/s
[Step=25900 Epoch=244.1] | Loss=0.00018 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.510 | L2-Norm(final)=15.028 | 2584.6 samples/s | 40.4 steps/s
[Step=25950 Epoch=244.5] | Loss=0.00017 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.505 | L2-Norm(final)=15.029 | 4630.2 samples/s | 72.3 steps/s
[Step=26000 Epoch=245.0] | Loss=0.00016 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.500 | L2-Norm(final)=15.030 | 2638.5 samples/s | 41.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step26000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09373 | acc=0.9584 | tpr=0.9638 | fpr=0.0535 | 4516.5 samples/s | 17.6 steps/s
Avg test loss: 0.10039, Avg test acc: 0.95781, Avg tpr: 0.96334, Avg fpr: 0.05435, total FA: 424

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09430 | acc=0.9625 | tpr=0.9782 | fpr=0.0716 | 4529.9 samples/s | 17.7 steps/s
Avg test loss: 0.09732, Avg test acc: 0.96093, Avg tpr: 0.97622, Avg fpr: 0.07268, total FA: 567

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09773 | acc=0.9598 | tpr=0.9739 | fpr=0.0709 | 4485.6 samples/s | 17.5 steps/s
Avg test loss: 0.10231, Avg test acc: 0.95865, Avg tpr: 0.97202, Avg fpr: 0.07076, total FA: 552

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09441 | acc=0.9615 | tpr=0.9712 | fpr=0.0597 | 4348.2 samples/s | 17.0 steps/s
Avg test loss: 0.10159, Avg test acc: 0.95977, Avg tpr: 0.97080, Avg fpr: 0.06448, total FA: 503

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09567 | acc=0.9613 | tpr=0.9746 | fpr=0.0674 | 5614.0 samples/s | 21.9 steps/s
Avg test loss: 0.10279, Avg test acc: 0.96101, Avg tpr: 0.97360, Avg fpr: 0.06666, total FA: 520

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.58037 | acc=0.2452 | tpr=0.0062 | fpr=0.2356 | 5720.2 samples/s | 22.3 steps/s
Avg test loss: 5.58477, Avg test acc: 0.24301, Avg tpr: 0.00688, Avg fpr: 0.23766, total FA: 1854

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.60507 | acc=0.2891 | tpr=0.0080 | fpr=0.1003 | 5881.8 samples/s | 23.0 steps/s
Avg test loss: 4.61595, Avg test acc: 0.28596, Avg tpr: 0.00699, Avg fpr: 0.10050, total FA: 784

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=6.47852 | acc=0.2575 | tpr=0.0156 | fpr=0.2173 | 5498.7 samples/s | 21.5 steps/s
Avg test loss: 6.49127, Avg test acc: 0.25711, Avg tpr: 0.01626, Avg fpr: 0.21318, total FA: 1663

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.96622 | acc=0.2605 | tpr=0.0120 | fpr=0.1997 | 5865.0 samples/s | 22.9 steps/s
Avg test loss: 4.97243, Avg test acc: 0.25908, Avg tpr: 0.01236, Avg fpr: 0.19831, total FA: 1547

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.57109 | acc=0.2593 | tpr=0.0110 | fpr=0.2014 | 5810.9 samples/s | 22.7 steps/s
Avg test loss: 5.58360, Avg test acc: 0.25900, Avg tpr: 0.01148, Avg fpr: 0.19664, total FA: 1534

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.30941 | acc=0.1659 | tpr=0.2212 | fpr=0.8351 | 5516.6 samples/s | 21.5 steps/s
[Step= 100] | Loss=5.25531 | acc=0.1660 | tpr=0.1940 | fpr=0.8345 | 8031.1 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.26535 | acc=0.1648 | tpr=0.1888 | fpr=0.8356 | 8456.6 samples/s | 33.0 steps/s
[Step= 200] | Loss=5.26213 | acc=0.1646 | tpr=0.1880 | fpr=0.8359 | 8127.9 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.26748 | acc=0.1643 | tpr=0.1939 | fpr=0.8362 | 7814.8 samples/s | 30.5 steps/s
[Step= 300] | Loss=5.26942 | acc=0.1636 | tpr=0.1942 | fpr=0.8369 | 8424.3 samples/s | 32.9 steps/s
[Step= 350] | Loss=5.27159 | acc=0.1635 | tpr=0.1841 | fpr=0.8369 | 8049.3 samples/s | 31.4 steps/s
[Step= 400] | Loss=5.26896 | acc=0.1639 | tpr=0.1849 | fpr=0.8365 | 8071.2 samples/s | 31.5 steps/s
[Step= 450] | Loss=5.26892 | acc=0.1639 | tpr=0.1821 | fpr=0.8364 | 8201.3 samples/s | 32.0 steps/s
[Step= 500] | Loss=5.27251 | acc=0.1638 | tpr=0.1868 | fpr=0.8366 | 8298.9 samples/s | 32.4 steps/s
[Step= 550] | Loss=5.27062 | acc=0.1639 | tpr=0.1830 | fpr=0.8365 | 9992.6 samples/s | 39.0 steps/s
Avg test loss: 5.27020, Avg test acc: 0.16382, Avg tpr: 0.18304, Avg fpr: 0.83653, total FA: 116151

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.97060 | acc=0.1320 | tpr=0.2345 | fpr=0.8699 | 5661.3 samples/s | 22.1 steps/s
[Step= 100] | Loss=4.93039 | acc=0.1343 | tpr=0.2388 | fpr=0.8676 | 8012.8 samples/s | 31.3 steps/s
[Step= 150] | Loss=4.94376 | acc=0.1322 | tpr=0.2334 | fpr=0.8697 | 8286.2 samples/s | 32.4 steps/s
[Step= 200] | Loss=4.94256 | acc=0.1320 | tpr=0.2262 | fpr=0.8697 | 7781.5 samples/s | 30.4 steps/s
[Step= 250] | Loss=4.94572 | acc=0.1320 | tpr=0.2262 | fpr=0.8697 | 7884.5 samples/s | 30.8 steps/s
[Step= 300] | Loss=4.95005 | acc=0.1319 | tpr=0.2298 | fpr=0.8699 | 8224.9 samples/s | 32.1 steps/s
[Step= 350] | Loss=4.95193 | acc=0.1314 | tpr=0.2179 | fpr=0.8702 | 7556.4 samples/s | 29.5 steps/s
[Step= 400] | Loss=4.95103 | acc=0.1318 | tpr=0.2226 | fpr=0.8698 | 8098.1 samples/s | 31.6 steps/s
[Step= 450] | Loss=4.95144 | acc=0.1320 | tpr=0.2210 | fpr=0.8696 | 7967.2 samples/s | 31.1 steps/s
[Step= 500] | Loss=4.95281 | acc=0.1319 | tpr=0.2247 | fpr=0.8698 | 8057.0 samples/s | 31.5 steps/s
[Step= 550] | Loss=4.95105 | acc=0.1321 | tpr=0.2228 | fpr=0.8695 | 11979.8 samples/s | 46.8 steps/s
Avg test loss: 4.95172, Avg test acc: 0.13208, Avg tpr: 0.22306, Avg fpr: 0.86958, total FA: 120739

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.14789 | acc=0.1244 | tpr=0.1726 | fpr=0.8765 | 5685.4 samples/s | 22.2 steps/s
[Step= 100] | Loss=6.09704 | acc=0.1259 | tpr=0.1620 | fpr=0.8748 | 8225.2 samples/s | 32.1 steps/s
[Step= 150] | Loss=6.10502 | acc=0.1258 | tpr=0.1513 | fpr=0.8747 | 7757.6 samples/s | 30.3 steps/s
[Step= 200] | Loss=6.09466 | acc=0.1262 | tpr=0.1486 | fpr=0.8743 | 7443.5 samples/s | 29.1 steps/s
[Step= 250] | Loss=6.09547 | acc=0.1261 | tpr=0.1485 | fpr=0.8743 | 8366.0 samples/s | 32.7 steps/s
[Step= 300] | Loss=6.10057 | acc=0.1261 | tpr=0.1505 | fpr=0.8744 | 7432.7 samples/s | 29.0 steps/s
[Step= 350] | Loss=6.10521 | acc=0.1255 | tpr=0.1428 | fpr=0.8748 | 8195.4 samples/s | 32.0 steps/s
[Step= 400] | Loss=6.10348 | acc=0.1258 | tpr=0.1482 | fpr=0.8746 | 8375.6 samples/s | 32.7 steps/s
[Step= 450] | Loss=6.10163 | acc=0.1258 | tpr=0.1470 | fpr=0.8746 | 8024.4 samples/s | 31.3 steps/s
[Step= 500] | Loss=6.10276 | acc=0.1258 | tpr=0.1463 | fpr=0.8746 | 8283.8 samples/s | 32.4 steps/s
[Step= 550] | Loss=6.09989 | acc=0.1259 | tpr=0.1444 | fpr=0.8744 | 11328.3 samples/s | 44.3 steps/s
Avg test loss: 6.09972, Avg test acc: 0.12586, Avg tpr: 0.14461, Avg fpr: 0.87448, total FA: 121420

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.17894 | acc=0.1599 | tpr=0.1549 | fpr=0.8400 | 5852.4 samples/s | 22.9 steps/s
[Step= 100] | Loss=5.13004 | acc=0.1600 | tpr=0.1514 | fpr=0.8398 | 8065.9 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.13581 | acc=0.1589 | tpr=0.1441 | fpr=0.8408 | 7814.0 samples/s | 30.5 steps/s
[Step= 200] | Loss=5.12562 | acc=0.1588 | tpr=0.1388 | fpr=0.8408 | 7816.9 samples/s | 30.5 steps/s
[Step= 250] | Loss=5.12937 | acc=0.1583 | tpr=0.1397 | fpr=0.8414 | 8108.3 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.13131 | acc=0.1580 | tpr=0.1425 | fpr=0.8417 | 7486.0 samples/s | 29.2 steps/s
[Step= 350] | Loss=5.13370 | acc=0.1575 | tpr=0.1365 | fpr=0.8421 | 8659.2 samples/s | 33.8 steps/s
[Step= 400] | Loss=5.12937 | acc=0.1581 | tpr=0.1417 | fpr=0.8416 | 7254.7 samples/s | 28.3 steps/s
[Step= 450] | Loss=5.12810 | acc=0.1582 | tpr=0.1426 | fpr=0.8415 | 8106.9 samples/s | 31.7 steps/s
[Step= 500] | Loss=5.13085 | acc=0.1581 | tpr=0.1436 | fpr=0.8417 | 8201.1 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.12832 | acc=0.1579 | tpr=0.1425 | fpr=0.8418 | 11356.5 samples/s | 44.4 steps/s
Avg test loss: 5.12795, Avg test acc: 0.15782, Avg tpr: 0.14263, Avg fpr: 0.84191, total FA: 116897

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.46699 | acc=0.1327 | tpr=0.1593 | fpr=0.8678 | 5721.8 samples/s | 22.4 steps/s
[Step= 100] | Loss=6.40314 | acc=0.1334 | tpr=0.1642 | fpr=0.8671 | 7258.1 samples/s | 28.4 steps/s
[Step= 150] | Loss=6.41862 | acc=0.1325 | tpr=0.1527 | fpr=0.8679 | 8743.4 samples/s | 34.2 steps/s
[Step= 200] | Loss=6.41082 | acc=0.1329 | tpr=0.1486 | fpr=0.8674 | 8014.7 samples/s | 31.3 steps/s
[Step= 250] | Loss=6.41777 | acc=0.1328 | tpr=0.1459 | fpr=0.8674 | 7865.6 samples/s | 30.7 steps/s
[Step= 300] | Loss=6.42319 | acc=0.1324 | tpr=0.1462 | fpr=0.8678 | 8063.2 samples/s | 31.5 steps/s
[Step= 350] | Loss=6.42646 | acc=0.1321 | tpr=0.1396 | fpr=0.8680 | 8039.2 samples/s | 31.4 steps/s
[Step= 400] | Loss=6.42409 | acc=0.1327 | tpr=0.1417 | fpr=0.8675 | 8206.7 samples/s | 32.1 steps/s
[Step= 450] | Loss=6.42430 | acc=0.1330 | tpr=0.1431 | fpr=0.8672 | 8257.2 samples/s | 32.3 steps/s
[Step= 500] | Loss=6.42776 | acc=0.1328 | tpr=0.1441 | fpr=0.8674 | 7172.3 samples/s | 28.0 steps/s
[Step= 550] | Loss=6.42471 | acc=0.1328 | tpr=0.1433 | fpr=0.8674 | 11573.8 samples/s | 45.2 steps/s
Avg test loss: 6.42404, Avg test acc: 0.13271, Avg tpr: 0.14382, Avg fpr: 0.86749, total FA: 120449

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10197 | acc=0.9820 | tpr=0.9248 | fpr=0.0169 | 5584.3 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.10327 | acc=0.9821 | tpr=0.9318 | fpr=0.0170 | 7684.1 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.10646 | acc=0.9814 | tpr=0.9366 | fpr=0.0178 | 8131.1 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.10821 | acc=0.9811 | tpr=0.9432 | fpr=0.0182 | 7930.2 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.10878 | acc=0.9809 | tpr=0.9389 | fpr=0.0183 | 8426.0 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.10990 | acc=0.9808 | tpr=0.9375 | fpr=0.0184 | 8109.6 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.11015 | acc=0.9809 | tpr=0.9399 | fpr=0.0184 | 8246.9 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.11097 | acc=0.9806 | tpr=0.9365 | fpr=0.0186 | 8128.1 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.11323 | acc=0.9802 | tpr=0.9352 | fpr=0.0190 | 7528.4 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.11220 | acc=0.9804 | tpr=0.9383 | fpr=0.0188 | 7742.1 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.11141 | acc=0.9805 | tpr=0.9379 | fpr=0.0187 | 11714.5 samples/s | 45.8 steps/s
Avg test loss: 0.11119, Avg test acc: 0.98055, Avg tpr: 0.93780, Avg fpr: 0.01867, total FA: 2592

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09553 | acc=0.9824 | tpr=0.8938 | fpr=0.0160 | 5447.5 samples/s | 21.3 steps/s
[Step= 100] | Loss=0.09776 | acc=0.9826 | tpr=0.9041 | fpr=0.0160 | 8213.5 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.10018 | acc=0.9824 | tpr=0.9135 | fpr=0.0163 | 7719.2 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.10122 | acc=0.9824 | tpr=0.9202 | fpr=0.0165 | 8369.0 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.10118 | acc=0.9824 | tpr=0.9188 | fpr=0.0164 | 7912.8 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.10260 | acc=0.9823 | tpr=0.9193 | fpr=0.0166 | 8520.8 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.10271 | acc=0.9822 | tpr=0.9198 | fpr=0.0167 | 8058.1 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.10351 | acc=0.9821 | tpr=0.9158 | fpr=0.0167 | 8245.2 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.10548 | acc=0.9818 | tpr=0.9133 | fpr=0.0169 | 7629.9 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.10461 | acc=0.9819 | tpr=0.9154 | fpr=0.0169 | 8610.4 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.10392 | acc=0.9819 | tpr=0.9148 | fpr=0.0169 | 10217.8 samples/s | 39.9 steps/s
Avg test loss: 0.10374, Avg test acc: 0.98194, Avg tpr: 0.91442, Avg fpr: 0.01683, total FA: 2337

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.15162 | acc=0.9776 | tpr=0.9204 | fpr=0.0214 | 5659.7 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.15297 | acc=0.9771 | tpr=0.9360 | fpr=0.0221 | 8259.4 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.15857 | acc=0.9765 | tpr=0.9409 | fpr=0.0228 | 7672.3 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.16241 | acc=0.9767 | tpr=0.9443 | fpr=0.0228 | 7807.9 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.16290 | acc=0.9767 | tpr=0.9459 | fpr=0.0228 | 8043.6 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.16505 | acc=0.9765 | tpr=0.9418 | fpr=0.0228 | 8200.7 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.16541 | acc=0.9765 | tpr=0.9430 | fpr=0.0229 | 8191.6 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.16740 | acc=0.9762 | tpr=0.9387 | fpr=0.0231 | 7236.7 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.17026 | acc=0.9758 | tpr=0.9372 | fpr=0.0235 | 8351.3 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.16852 | acc=0.9759 | tpr=0.9383 | fpr=0.0235 | 8292.3 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.16733 | acc=0.9761 | tpr=0.9399 | fpr=0.0233 | 11578.5 samples/s | 45.2 steps/s
Avg test loss: 0.16700, Avg test acc: 0.97606, Avg tpr: 0.93938, Avg fpr: 0.02327, total FA: 3231

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09963 | acc=0.9811 | tpr=0.9292 | fpr=0.0180 | 5743.9 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.10168 | acc=0.9809 | tpr=0.9339 | fpr=0.0183 | 7450.4 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.10429 | acc=0.9808 | tpr=0.9395 | fpr=0.0184 | 7929.7 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.10489 | acc=0.9810 | tpr=0.9454 | fpr=0.0184 | 8435.3 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.10497 | acc=0.9810 | tpr=0.9380 | fpr=0.0182 | 8386.8 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.10654 | acc=0.9809 | tpr=0.9353 | fpr=0.0183 | 7440.4 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.10614 | acc=0.9809 | tpr=0.9368 | fpr=0.0182 | 8381.2 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.10704 | acc=0.9809 | tpr=0.9354 | fpr=0.0183 | 8614.7 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.10920 | acc=0.9805 | tpr=0.9328 | fpr=0.0187 | 8411.3 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.10855 | acc=0.9805 | tpr=0.9335 | fpr=0.0186 | 7396.9 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.10779 | acc=0.9807 | tpr=0.9331 | fpr=0.0185 | 10486.1 samples/s | 41.0 steps/s
Avg test loss: 0.10764, Avg test acc: 0.98070, Avg tpr: 0.93304, Avg fpr: 0.01844, total FA: 2560

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.09853 | acc=0.9816 | tpr=0.9159 | fpr=0.0173 | 5392.8 samples/s | 21.1 steps/s
[Step= 100] | Loss=0.10177 | acc=0.9814 | tpr=0.9339 | fpr=0.0177 | 8406.5 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.10529 | acc=0.9810 | tpr=0.9395 | fpr=0.0183 | 8412.2 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.10680 | acc=0.9809 | tpr=0.9443 | fpr=0.0184 | 7566.5 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.10750 | acc=0.9808 | tpr=0.9406 | fpr=0.0185 | 8375.5 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.10867 | acc=0.9807 | tpr=0.9396 | fpr=0.0185 | 8290.6 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.10891 | acc=0.9807 | tpr=0.9418 | fpr=0.0186 | 7350.2 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.10962 | acc=0.9806 | tpr=0.9387 | fpr=0.0186 | 8426.1 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.11152 | acc=0.9803 | tpr=0.9362 | fpr=0.0189 | 8422.7 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.11071 | acc=0.9805 | tpr=0.9379 | fpr=0.0188 | 8034.2 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.11005 | acc=0.9805 | tpr=0.9363 | fpr=0.0187 | 10210.0 samples/s | 39.9 steps/s
Avg test loss: 0.10987, Avg test acc: 0.98049, Avg tpr: 0.93582, Avg fpr: 0.01870, total FA: 2596

server round 30/50

clients selected: [2 3 4 7 8]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=30001 Epoch=146.2] | Loss=0.03440 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.471 | L2-Norm(final)=14.073 | 6007.4 samples/s | 93.9 steps/s
[Step=30050 Epoch=146.4] | Loss=0.02027 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.471 | L2-Norm(final)=14.073 | 4915.0 samples/s | 76.8 steps/s
[Step=30100 Epoch=146.7] | Loss=0.01947 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=14.073 | 5715.4 samples/s | 89.3 steps/s
[Step=30150 Epoch=146.9] | Loss=0.01866 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.472 | L2-Norm(final)=14.075 | 5451.8 samples/s | 85.2 steps/s
[Step=30200 Epoch=147.1] | Loss=0.01959 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=14.075 | 8668.2 samples/s | 135.4 steps/s
[Step=30250 Epoch=147.4] | Loss=0.02022 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.472 | L2-Norm(final)=14.073 | 2445.4 samples/s | 38.2 steps/s
[Step=30300 Epoch=147.6] | Loss=0.01965 | Reg=0.00110 | acc=0.9375 | L2-Norm=10.472 | L2-Norm(final)=14.072 | 5460.9 samples/s | 85.3 steps/s
[Step=30350 Epoch=147.9] | Loss=0.01976 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=14.072 | 5730.6 samples/s | 89.5 steps/s
[Step=30400 Epoch=148.1] | Loss=0.01956 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.472 | L2-Norm(final)=14.072 | 7612.3 samples/s | 118.9 steps/s
[Step=30450 Epoch=148.4] | Loss=0.01926 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=14.073 | 2540.2 samples/s | 39.7 steps/s
[Step=30500 Epoch=148.6] | Loss=0.01929 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=14.074 | 5635.1 samples/s | 88.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=148.6] | Loss=0.01599 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.472 | L2-Norm(final)=14.082 | 5701.6 samples/s | 89.1 steps/s
[Step=30550 Epoch=148.9] | Loss=0.02087 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=14.082 | 4450.9 samples/s | 69.5 steps/s
[Step=30600 Epoch=149.1] | Loss=0.01771 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.494 | L2-Norm(final)=14.082 | 4857.0 samples/s | 75.9 steps/s
[Step=30650 Epoch=149.3] | Loss=0.01747 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.503 | L2-Norm(final)=14.083 | 4849.3 samples/s | 75.8 steps/s
[Step=30700 Epoch=149.6] | Loss=0.01577 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.512 | L2-Norm(final)=14.085 | 6984.6 samples/s | 109.1 steps/s
[Step=30750 Epoch=149.8] | Loss=0.01419 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.519 | L2-Norm(final)=14.087 | 2271.6 samples/s | 35.5 steps/s
[Step=30800 Epoch=150.1] | Loss=0.01280 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.526 | L2-Norm(final)=14.090 | 4856.2 samples/s | 75.9 steps/s
[Step=30850 Epoch=150.3] | Loss=0.01168 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.532 | L2-Norm(final)=14.093 | 4860.8 samples/s | 76.0 steps/s
[Step=30900 Epoch=150.6] | Loss=0.01086 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.537 | L2-Norm(final)=14.096 | 6359.1 samples/s | 99.4 steps/s
[Step=30950 Epoch=150.8] | Loss=0.01020 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.542 | L2-Norm(final)=14.099 | 2327.6 samples/s | 36.4 steps/s
[Step=31000 Epoch=151.0] | Loss=0.00956 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.547 | L2-Norm(final)=14.102 | 4842.9 samples/s | 75.7 steps/s
[Step=31050 Epoch=151.3] | Loss=0.00918 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.551 | L2-Norm(final)=14.105 | 4839.2 samples/s | 75.6 steps/s
[Step=31100 Epoch=151.5] | Loss=0.00880 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.555 | L2-Norm(final)=14.108 | 5829.0 samples/s | 91.1 steps/s
[Step=31150 Epoch=151.8] | Loss=0.00843 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.558 | L2-Norm(final)=14.110 | 2416.6 samples/s | 37.8 steps/s
[Step=31200 Epoch=152.0] | Loss=0.00807 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.562 | L2-Norm(final)=14.113 | 4926.8 samples/s | 77.0 steps/s
[Step=31250 Epoch=152.3] | Loss=0.00783 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.565 | L2-Norm(final)=14.115 | 4782.1 samples/s | 74.7 steps/s
[Step=31300 Epoch=152.5] | Loss=0.00752 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.568 | L2-Norm(final)=14.118 | 5312.8 samples/s | 83.0 steps/s
[Step=31350 Epoch=152.8] | Loss=0.00729 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.571 | L2-Norm(final)=14.120 | 2547.1 samples/s | 39.8 steps/s
[Step=31400 Epoch=153.0] | Loss=0.00714 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.574 | L2-Norm(final)=14.122 | 4702.2 samples/s | 73.5 steps/s
[Step=31450 Epoch=153.2] | Loss=0.00692 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.576 | L2-Norm(final)=14.124 | 4846.7 samples/s | 75.7 steps/s
[Step=31500 Epoch=153.5] | Loss=0.00674 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.579 | L2-Norm(final)=14.126 | 5004.9 samples/s | 78.2 steps/s
[Step=31550 Epoch=153.7] | Loss=0.00651 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.581 | L2-Norm(final)=14.128 | 2617.5 samples/s | 40.9 steps/s
[Step=31600 Epoch=154.0] | Loss=0.00633 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.584 | L2-Norm(final)=14.131 | 4873.6 samples/s | 76.2 steps/s
[Step=31650 Epoch=154.2] | Loss=0.00617 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.586 | L2-Norm(final)=14.133 | 4831.9 samples/s | 75.5 steps/s
[Step=31700 Epoch=154.5] | Loss=0.00602 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.588 | L2-Norm(final)=14.135 | 4903.5 samples/s | 76.6 steps/s
[Step=31750 Epoch=154.7] | Loss=0.00592 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.591 | L2-Norm(final)=14.137 | 2658.4 samples/s | 41.5 steps/s
[Step=31800 Epoch=154.9] | Loss=0.00577 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.593 | L2-Norm(final)=14.139 | 4838.3 samples/s | 75.6 steps/s
[Step=31850 Epoch=155.2] | Loss=0.00569 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.595 | L2-Norm(final)=14.141 | 4920.9 samples/s | 76.9 steps/s
[Step=31900 Epoch=155.4] | Loss=0.00557 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.597 | L2-Norm(final)=14.143 | 4860.3 samples/s | 75.9 steps/s
[Step=31950 Epoch=155.7] | Loss=0.00550 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.599 | L2-Norm(final)=14.145 | 2630.9 samples/s | 41.1 steps/s
[Step=32000 Epoch=155.9] | Loss=0.00538 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.601 | L2-Norm(final)=14.147 | 4845.2 samples/s | 75.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step32000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=165.8] | Loss=0.01364 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.471 | L2-Norm(final)=14.686 | 5312.9 samples/s | 83.0 steps/s
[Step=34050 Epoch=166.0] | Loss=0.01591 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.472 | L2-Norm(final)=14.689 | 5397.5 samples/s | 84.3 steps/s
[Step=34100 Epoch=166.3] | Loss=0.01649 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=14.692 | 5701.8 samples/s | 89.1 steps/s
[Step=34150 Epoch=166.5] | Loss=0.01665 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=14.695 | 5462.2 samples/s | 85.3 steps/s
[Step=34200 Epoch=166.8] | Loss=0.01756 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.472 | L2-Norm(final)=14.699 | 8809.3 samples/s | 137.6 steps/s
[Step=34250 Epoch=167.0] | Loss=0.01819 | Reg=0.00110 | acc=0.9531 | L2-Norm=10.472 | L2-Norm(final)=14.702 | 2413.8 samples/s | 37.7 steps/s
[Step=34300 Epoch=167.3] | Loss=0.01818 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.472 | L2-Norm(final)=14.705 | 5589.2 samples/s | 87.3 steps/s
[Step=34350 Epoch=167.5] | Loss=0.01798 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.472 | L2-Norm(final)=14.708 | 5629.8 samples/s | 88.0 steps/s
[Step=34400 Epoch=167.8] | Loss=0.01743 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.472 | L2-Norm(final)=14.711 | 7846.4 samples/s | 122.6 steps/s
[Step=34450 Epoch=168.0] | Loss=0.01735 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=14.715 | 2536.5 samples/s | 39.6 steps/s
[Step=34500 Epoch=168.2] | Loss=0.01727 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=14.718 | 5667.5 samples/s | 88.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=168.2] | Loss=0.01823 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.472 | L2-Norm(final)=14.758 | 5887.3 samples/s | 92.0 steps/s
[Step=34550 Epoch=168.5] | Loss=0.01888 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.482 | L2-Norm(final)=14.760 | 4359.7 samples/s | 68.1 steps/s
[Step=34600 Epoch=168.7] | Loss=0.01678 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.494 | L2-Norm(final)=14.760 | 4837.0 samples/s | 75.6 steps/s
[Step=34650 Epoch=169.0] | Loss=0.01627 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.504 | L2-Norm(final)=14.761 | 4960.0 samples/s | 77.5 steps/s
[Step=34700 Epoch=169.2] | Loss=0.01464 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.512 | L2-Norm(final)=14.761 | 6820.3 samples/s | 106.6 steps/s
[Step=34750 Epoch=169.5] | Loss=0.01259 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.519 | L2-Norm(final)=14.763 | 2263.3 samples/s | 35.4 steps/s
[Step=34800 Epoch=169.7] | Loss=0.01151 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.525 | L2-Norm(final)=14.766 | 4873.8 samples/s | 76.2 steps/s
[Step=34850 Epoch=169.9] | Loss=0.01028 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.530 | L2-Norm(final)=14.768 | 4838.0 samples/s | 75.6 steps/s
[Step=34900 Epoch=170.2] | Loss=0.00977 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.534 | L2-Norm(final)=14.771 | 6366.4 samples/s | 99.5 steps/s
[Step=34950 Epoch=170.4] | Loss=0.00952 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.539 | L2-Norm(final)=14.773 | 2359.1 samples/s | 36.9 steps/s
[Step=35000 Epoch=170.7] | Loss=0.00930 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.543 | L2-Norm(final)=14.775 | 4842.8 samples/s | 75.7 steps/s
[Step=35050 Epoch=170.9] | Loss=0.00896 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.547 | L2-Norm(final)=14.777 | 4843.4 samples/s | 75.7 steps/s
[Step=35100 Epoch=171.2] | Loss=0.00863 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.551 | L2-Norm(final)=14.779 | 5787.8 samples/s | 90.4 steps/s
[Step=35150 Epoch=171.4] | Loss=0.00815 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.554 | L2-Norm(final)=14.780 | 2407.3 samples/s | 37.6 steps/s
[Step=35200 Epoch=171.7] | Loss=0.00784 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.557 | L2-Norm(final)=14.782 | 4904.6 samples/s | 76.6 steps/s
[Step=35250 Epoch=171.9] | Loss=0.00761 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.560 | L2-Norm(final)=14.784 | 4839.7 samples/s | 75.6 steps/s
[Step=35300 Epoch=172.1] | Loss=0.00739 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.563 | L2-Norm(final)=14.786 | 5376.6 samples/s | 84.0 steps/s
[Step=35350 Epoch=172.4] | Loss=0.00712 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.565 | L2-Norm(final)=14.787 | 2523.9 samples/s | 39.4 steps/s
[Step=35400 Epoch=172.6] | Loss=0.00685 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.568 | L2-Norm(final)=14.789 | 4805.4 samples/s | 75.1 steps/s
[Step=35450 Epoch=172.9] | Loss=0.00668 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.570 | L2-Norm(final)=14.791 | 4859.7 samples/s | 75.9 steps/s
[Step=35500 Epoch=173.1] | Loss=0.00649 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.572 | L2-Norm(final)=14.793 | 5013.9 samples/s | 78.3 steps/s
[Step=35550 Epoch=173.4] | Loss=0.00628 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.574 | L2-Norm(final)=14.794 | 2636.9 samples/s | 41.2 steps/s
[Step=35600 Epoch=173.6] | Loss=0.00609 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.577 | L2-Norm(final)=14.796 | 4826.4 samples/s | 75.4 steps/s
[Step=35650 Epoch=173.8] | Loss=0.00595 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.578 | L2-Norm(final)=14.798 | 4879.7 samples/s | 76.2 steps/s
[Step=35700 Epoch=174.1] | Loss=0.00588 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.580 | L2-Norm(final)=14.799 | 4879.4 samples/s | 76.2 steps/s
[Step=35750 Epoch=174.3] | Loss=0.00571 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.582 | L2-Norm(final)=14.801 | 2636.2 samples/s | 41.2 steps/s
[Step=35800 Epoch=174.6] | Loss=0.00561 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.584 | L2-Norm(final)=14.802 | 4864.9 samples/s | 76.0 steps/s
[Step=35850 Epoch=174.8] | Loss=0.00549 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.585 | L2-Norm(final)=14.804 | 4881.7 samples/s | 76.3 steps/s
[Step=35900 Epoch=175.1] | Loss=0.00543 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.587 | L2-Norm(final)=14.805 | 4841.5 samples/s | 75.6 steps/s
[Step=35950 Epoch=175.3] | Loss=0.00529 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.589 | L2-Norm(final)=14.807 | 2653.4 samples/s | 41.5 steps/s
[Step=36000 Epoch=175.6] | Loss=0.00518 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.590 | L2-Norm(final)=14.808 | 4836.1 samples/s | 75.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step36000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=38001 Epoch=186.4] | Loss=0.00245 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.471 | L2-Norm(final)=15.132 | 5627.0 samples/s | 87.9 steps/s
[Step=38050 Epoch=186.6] | Loss=0.01930 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.471 | L2-Norm(final)=15.134 | 5242.5 samples/s | 81.9 steps/s
[Step=38100 Epoch=186.8] | Loss=0.01849 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.471 | L2-Norm(final)=15.137 | 5635.9 samples/s | 88.1 steps/s
[Step=38150 Epoch=187.1] | Loss=0.01940 | Reg=0.00110 | acc=0.9531 | L2-Norm=10.471 | L2-Norm(final)=15.140 | 5554.6 samples/s | 86.8 steps/s
[Step=38200 Epoch=187.3] | Loss=0.01849 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.471 | L2-Norm(final)=15.141 | 8931.6 samples/s | 139.6 steps/s
[Step=38250 Epoch=187.6] | Loss=0.01886 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.471 | L2-Norm(final)=15.143 | 2397.8 samples/s | 37.5 steps/s
[Step=38300 Epoch=187.8] | Loss=0.01855 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.471 | L2-Norm(final)=15.145 | 5771.1 samples/s | 90.2 steps/s
[Step=38350 Epoch=188.1] | Loss=0.01832 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.471 | L2-Norm(final)=15.147 | 5633.5 samples/s | 88.0 steps/s
[Step=38400 Epoch=188.3] | Loss=0.01844 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.471 | L2-Norm(final)=15.150 | 8054.5 samples/s | 125.9 steps/s
[Step=38450 Epoch=188.6] | Loss=0.01834 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.471 | L2-Norm(final)=15.152 | 2451.4 samples/s | 38.3 steps/s
[Step=38500 Epoch=188.8] | Loss=0.01818 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.471 | L2-Norm(final)=15.155 | 5710.8 samples/s | 89.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=188.8] | Loss=0.00739 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.471 | L2-Norm(final)=15.180 | 5641.0 samples/s | 88.1 steps/s
[Step=38550 Epoch=189.0] | Loss=0.01832 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=15.181 | 4663.6 samples/s | 72.9 steps/s
[Step=38600 Epoch=189.3] | Loss=0.01816 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.493 | L2-Norm(final)=15.181 | 4923.7 samples/s | 76.9 steps/s
[Step=38650 Epoch=189.5] | Loss=0.01610 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.503 | L2-Norm(final)=15.183 | 4784.6 samples/s | 74.8 steps/s
[Step=38700 Epoch=189.8] | Loss=0.01509 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.512 | L2-Norm(final)=15.184 | 7076.0 samples/s | 110.6 steps/s
[Step=38750 Epoch=190.0] | Loss=0.01308 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.519 | L2-Norm(final)=15.186 | 2238.3 samples/s | 35.0 steps/s
[Step=38800 Epoch=190.3] | Loss=0.01171 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.525 | L2-Norm(final)=15.189 | 4876.4 samples/s | 76.2 steps/s
[Step=38850 Epoch=190.5] | Loss=0.01069 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.531 | L2-Norm(final)=15.192 | 4853.2 samples/s | 75.8 steps/s
[Step=38900 Epoch=190.8] | Loss=0.01000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.536 | L2-Norm(final)=15.195 | 6606.1 samples/s | 103.2 steps/s
[Step=38950 Epoch=191.0] | Loss=0.00946 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.541 | L2-Norm(final)=15.198 | 2315.0 samples/s | 36.2 steps/s
[Step=39000 Epoch=191.2] | Loss=0.00876 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.545 | L2-Norm(final)=15.201 | 4870.5 samples/s | 76.1 steps/s
[Step=39050 Epoch=191.5] | Loss=0.00833 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.549 | L2-Norm(final)=15.204 | 4875.0 samples/s | 76.2 steps/s
[Step=39100 Epoch=191.7] | Loss=0.00797 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.553 | L2-Norm(final)=15.207 | 6244.9 samples/s | 97.6 steps/s
[Step=39150 Epoch=192.0] | Loss=0.00764 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.556 | L2-Norm(final)=15.209 | 2348.0 samples/s | 36.7 steps/s
[Step=39200 Epoch=192.2] | Loss=0.00732 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.559 | L2-Norm(final)=15.212 | 4854.2 samples/s | 75.8 steps/s
[Step=39250 Epoch=192.5] | Loss=0.00697 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.562 | L2-Norm(final)=15.214 | 4989.5 samples/s | 78.0 steps/s
[Step=39300 Epoch=192.7] | Loss=0.00674 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.565 | L2-Norm(final)=15.216 | 5796.0 samples/s | 90.6 steps/s
[Step=39350 Epoch=193.0] | Loss=0.00655 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.567 | L2-Norm(final)=15.218 | 2405.9 samples/s | 37.6 steps/s
[Step=39400 Epoch=193.2] | Loss=0.00631 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.570 | L2-Norm(final)=15.220 | 4788.8 samples/s | 74.8 steps/s
[Step=39450 Epoch=193.5] | Loss=0.00615 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.572 | L2-Norm(final)=15.223 | 4893.4 samples/s | 76.5 steps/s
[Step=39500 Epoch=193.7] | Loss=0.00601 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.574 | L2-Norm(final)=15.225 | 5578.5 samples/s | 87.2 steps/s
[Step=39550 Epoch=193.9] | Loss=0.00584 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.577 | L2-Norm(final)=15.227 | 2425.1 samples/s | 37.9 steps/s
[Step=39600 Epoch=194.2] | Loss=0.00567 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.579 | L2-Norm(final)=15.229 | 4861.0 samples/s | 76.0 steps/s
[Step=39650 Epoch=194.4] | Loss=0.00552 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.581 | L2-Norm(final)=15.231 | 4876.2 samples/s | 76.2 steps/s
[Step=39700 Epoch=194.7] | Loss=0.00539 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.583 | L2-Norm(final)=15.233 | 5351.8 samples/s | 83.6 steps/s
[Step=39750 Epoch=194.9] | Loss=0.00531 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.584 | L2-Norm(final)=15.234 | 2495.6 samples/s | 39.0 steps/s
[Step=39800 Epoch=195.2] | Loss=0.00517 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.586 | L2-Norm(final)=15.236 | 4868.0 samples/s | 76.1 steps/s
[Step=39850 Epoch=195.4] | Loss=0.00507 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.588 | L2-Norm(final)=15.238 | 4863.7 samples/s | 76.0 steps/s
[Step=39900 Epoch=195.7] | Loss=0.00498 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.590 | L2-Norm(final)=15.240 | 5076.4 samples/s | 79.3 steps/s
[Step=39950 Epoch=195.9] | Loss=0.00488 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.591 | L2-Norm(final)=15.242 | 2575.0 samples/s | 40.2 steps/s
[Step=40000 Epoch=196.2] | Loss=0.00478 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.593 | L2-Norm(final)=15.244 | 4964.3 samples/s | 77.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step40000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=305.6] | Loss=0.00010 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.471 | L2-Norm(final)=16.576 | 5693.1 samples/s | 89.0 steps/s
[Step=32050 Epoch=306.1] | Loss=0.00014 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=16.580 | 4497.9 samples/s | 70.3 steps/s
[Step=32100 Epoch=306.5] | Loss=0.00014 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=16.586 | 8423.4 samples/s | 131.6 steps/s
[Step=32150 Epoch=307.0] | Loss=0.00014 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=16.591 | 2339.1 samples/s | 36.5 steps/s
[Step=32200 Epoch=307.5] | Loss=0.00014 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=16.597 | 7593.0 samples/s | 118.6 steps/s
[Step=32250 Epoch=308.0] | Loss=0.00014 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=16.602 | 2422.7 samples/s | 37.9 steps/s
[Step=32300 Epoch=308.4] | Loss=0.00013 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=16.608 | 6835.0 samples/s | 106.8 steps/s
[Step=32350 Epoch=308.9] | Loss=0.00013 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=16.613 | 2489.4 samples/s | 38.9 steps/s
[Step=32400 Epoch=309.4] | Loss=0.00013 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=16.619 | 6233.5 samples/s | 97.4 steps/s
[Step=32450 Epoch=309.9] | Loss=0.00013 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=16.624 | 2549.7 samples/s | 39.8 steps/s
[Step=32500 Epoch=310.4] | Loss=0.00013 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=16.629 | 5864.7 samples/s | 91.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=310.4] | Loss=0.00008 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=16.680 | 5424.5 samples/s | 84.8 steps/s
[Step=32550 Epoch=310.8] | Loss=0.00009 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.469 | L2-Norm(final)=16.685 | 4293.6 samples/s | 67.1 steps/s
[Step=32600 Epoch=311.3] | Loss=0.00005 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.465 | L2-Norm(final)=16.688 | 6828.3 samples/s | 106.7 steps/s
[Step=32650 Epoch=311.8] | Loss=0.00004 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.460 | L2-Norm(final)=16.690 | 2187.0 samples/s | 34.2 steps/s
[Step=32700 Epoch=312.3] | Loss=0.00003 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.454 | L2-Norm(final)=16.691 | 6178.2 samples/s | 96.5 steps/s
[Step=32750 Epoch=312.7] | Loss=0.00003 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.448 | L2-Norm(final)=16.693 | 2237.1 samples/s | 35.0 steps/s
[Step=32800 Epoch=313.2] | Loss=0.00002 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.442 | L2-Norm(final)=16.694 | 5798.1 samples/s | 90.6 steps/s
[Step=32850 Epoch=313.7] | Loss=0.00002 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.436 | L2-Norm(final)=16.695 | 2325.5 samples/s | 36.3 steps/s
[Step=32900 Epoch=314.2] | Loss=0.00002 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.430 | L2-Norm(final)=16.696 | 5257.0 samples/s | 82.1 steps/s
[Step=32950 Epoch=314.7] | Loss=0.00002 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.424 | L2-Norm(final)=16.697 | 2366.7 samples/s | 37.0 steps/s
[Step=33000 Epoch=315.1] | Loss=0.00002 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.418 | L2-Norm(final)=16.698 | 5037.2 samples/s | 78.7 steps/s
[Step=33050 Epoch=315.6] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.412 | L2-Norm(final)=16.699 | 2437.7 samples/s | 38.1 steps/s
[Step=33100 Epoch=316.1] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=16.699 | 4721.3 samples/s | 73.8 steps/s
[Step=33150 Epoch=316.6] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.400 | L2-Norm(final)=16.700 | 2520.3 samples/s | 39.4 steps/s
[Step=33200 Epoch=317.0] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.394 | L2-Norm(final)=16.701 | 4667.6 samples/s | 72.9 steps/s
[Step=33250 Epoch=317.5] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.388 | L2-Norm(final)=16.702 | 2590.3 samples/s | 40.5 steps/s
[Step=33300 Epoch=318.0] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.381 | L2-Norm(final)=16.702 | 4654.1 samples/s | 72.7 steps/s
[Step=33350 Epoch=318.5] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.375 | L2-Norm(final)=16.703 | 2550.8 samples/s | 39.9 steps/s
[Step=33400 Epoch=318.9] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.369 | L2-Norm(final)=16.704 | 4634.8 samples/s | 72.4 steps/s
[Step=33450 Epoch=319.4] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.362 | L2-Norm(final)=16.705 | 2573.2 samples/s | 40.2 steps/s
[Step=33500 Epoch=319.9] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.356 | L2-Norm(final)=16.705 | 4648.9 samples/s | 72.6 steps/s
[Step=33550 Epoch=320.4] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.350 | L2-Norm(final)=16.706 | 7327.5 samples/s | 114.5 steps/s
[Step=33600 Epoch=320.9] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.343 | L2-Norm(final)=16.707 | 2131.8 samples/s | 33.3 steps/s
[Step=33650 Epoch=321.3] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.337 | L2-Norm(final)=16.707 | 6684.1 samples/s | 104.4 steps/s
[Step=33700 Epoch=321.8] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.330 | L2-Norm(final)=16.708 | 2185.9 samples/s | 34.2 steps/s
[Step=33750 Epoch=322.3] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.324 | L2-Norm(final)=16.709 | 6243.1 samples/s | 97.5 steps/s
[Step=33800 Epoch=322.8] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.317 | L2-Norm(final)=16.709 | 2235.8 samples/s | 34.9 steps/s
[Step=33850 Epoch=323.2] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.310 | L2-Norm(final)=16.710 | 5797.9 samples/s | 90.6 steps/s
[Step=33900 Epoch=323.7] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.304 | L2-Norm(final)=16.711 | 2344.5 samples/s | 36.6 steps/s
[Step=33950 Epoch=324.2] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.297 | L2-Norm(final)=16.711 | 5292.4 samples/s | 82.7 steps/s
[Step=34000 Epoch=324.7] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=16.712 | 2366.2 samples/s | 37.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step34000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=26001 Epoch=245.0] | Loss=0.00038 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.471 | L2-Norm(final)=15.058 | 5791.3 samples/s | 90.5 steps/s
[Step=26050 Epoch=245.5] | Loss=0.00057 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=15.064 | 4611.8 samples/s | 72.1 steps/s
[Step=26100 Epoch=245.9] | Loss=0.00058 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=15.073 | 8135.0 samples/s | 127.1 steps/s
[Step=26150 Epoch=246.4] | Loss=0.00068 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=15.081 | 2358.1 samples/s | 36.8 steps/s
[Step=26200 Epoch=246.9] | Loss=0.00064 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=15.089 | 7165.8 samples/s | 112.0 steps/s
[Step=26250 Epoch=247.3] | Loss=0.00060 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=15.097 | 2453.1 samples/s | 38.3 steps/s
[Step=26300 Epoch=247.8] | Loss=0.00062 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=15.105 | 6193.2 samples/s | 96.8 steps/s
[Step=26350 Epoch=248.3] | Loss=0.00061 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=15.112 | 2568.8 samples/s | 40.1 steps/s
[Step=26400 Epoch=248.8] | Loss=0.00061 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=15.120 | 5627.7 samples/s | 87.9 steps/s
[Step=26450 Epoch=249.2] | Loss=0.00060 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=15.128 | 2689.7 samples/s | 42.0 steps/s
[Step=26500 Epoch=249.7] | Loss=0.00059 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=15.136 | 5314.1 samples/s | 83.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=26501 Epoch=249.7] | Loss=0.00108 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=15.211 | 5252.6 samples/s | 82.1 steps/s
[Step=26550 Epoch=250.2] | Loss=0.00037 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.475 | L2-Norm(final)=15.218 | 4444.9 samples/s | 69.5 steps/s
[Step=26600 Epoch=250.6] | Loss=0.00022 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.476 | L2-Norm(final)=15.222 | 6598.7 samples/s | 103.1 steps/s
[Step=26650 Epoch=251.1] | Loss=0.00015 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.474 | L2-Norm(final)=15.224 | 2213.6 samples/s | 34.6 steps/s
[Step=26700 Epoch=251.6] | Loss=0.00012 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.471 | L2-Norm(final)=15.226 | 5954.5 samples/s | 93.0 steps/s
[Step=26750 Epoch=252.1] | Loss=0.00010 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.467 | L2-Norm(final)=15.227 | 2287.7 samples/s | 35.7 steps/s
[Step=26800 Epoch=252.5] | Loss=0.00008 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.463 | L2-Norm(final)=15.228 | 5361.4 samples/s | 83.8 steps/s
[Step=26850 Epoch=253.0] | Loss=0.00007 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.459 | L2-Norm(final)=15.229 | 2386.1 samples/s | 37.3 steps/s
[Step=26900 Epoch=253.5] | Loss=0.00006 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.455 | L2-Norm(final)=15.230 | 4849.6 samples/s | 75.8 steps/s
[Step=26950 Epoch=253.9] | Loss=0.00006 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.450 | L2-Norm(final)=15.231 | 2510.0 samples/s | 39.2 steps/s
[Step=27000 Epoch=254.4] | Loss=0.00005 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.446 | L2-Norm(final)=15.232 | 4592.4 samples/s | 71.8 steps/s
[Step=27050 Epoch=254.9] | Loss=0.00005 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.441 | L2-Norm(final)=15.233 | 2621.7 samples/s | 41.0 steps/s
[Step=27100 Epoch=255.4] | Loss=0.00004 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.437 | L2-Norm(final)=15.234 | 4521.4 samples/s | 70.6 steps/s
[Step=27150 Epoch=255.8] | Loss=0.00004 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.432 | L2-Norm(final)=15.234 | 2577.8 samples/s | 40.3 steps/s
[Step=27200 Epoch=256.3] | Loss=0.00004 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.428 | L2-Norm(final)=15.235 | 4654.2 samples/s | 72.7 steps/s
[Step=27250 Epoch=256.8] | Loss=0.00004 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.423 | L2-Norm(final)=15.236 | 2846.2 samples/s | 44.5 steps/s
[Step=27300 Epoch=257.2] | Loss=0.00003 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.418 | L2-Norm(final)=15.236 | 3996.9 samples/s | 62.5 steps/s
[Step=27350 Epoch=257.7] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.413 | L2-Norm(final)=15.237 | 6668.3 samples/s | 104.2 steps/s
[Step=27400 Epoch=258.2] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.409 | L2-Norm(final)=15.237 | 2200.4 samples/s | 34.4 steps/s
[Step=27450 Epoch=258.7] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=15.238 | 6066.8 samples/s | 94.8 steps/s
[Step=27500 Epoch=259.1] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=15.238 | 2266.9 samples/s | 35.4 steps/s
[Step=27550 Epoch=259.6] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.394 | L2-Norm(final)=15.239 | 5437.1 samples/s | 85.0 steps/s
[Step=27600 Epoch=260.1] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=15.239 | 2414.6 samples/s | 37.7 steps/s
[Step=27650 Epoch=260.5] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.384 | L2-Norm(final)=15.240 | 4850.4 samples/s | 75.8 steps/s
[Step=27700 Epoch=261.0] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=15.240 | 2477.5 samples/s | 38.7 steps/s
[Step=27750 Epoch=261.5] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.374 | L2-Norm(final)=15.241 | 4639.7 samples/s | 72.5 steps/s
[Step=27800 Epoch=262.0] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.369 | L2-Norm(final)=15.241 | 2554.5 samples/s | 39.9 steps/s
[Step=27850 Epoch=262.4] | Loss=0.00002 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.363 | L2-Norm(final)=15.242 | 4631.5 samples/s | 72.4 steps/s
[Step=27900 Epoch=262.9] | Loss=0.00002 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.358 | L2-Norm(final)=15.242 | 2584.1 samples/s | 40.4 steps/s
[Step=27950 Epoch=263.4] | Loss=0.00002 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.353 | L2-Norm(final)=15.243 | 4610.6 samples/s | 72.0 steps/s
[Step=28000 Epoch=263.8] | Loss=0.00002 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.347 | L2-Norm(final)=15.243 | 2632.0 samples/s | 41.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09373 | acc=0.9584 | tpr=0.9638 | fpr=0.0535 | 5699.2 samples/s | 22.3 steps/s
Avg test loss: 0.10039, Avg test acc: 0.95781, Avg tpr: 0.96334, Avg fpr: 0.05435, total FA: 424

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09430 | acc=0.9625 | tpr=0.9782 | fpr=0.0716 | 5702.1 samples/s | 22.3 steps/s
Avg test loss: 0.09732, Avg test acc: 0.96093, Avg tpr: 0.97622, Avg fpr: 0.07268, total FA: 567

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08947 | acc=0.9627 | tpr=0.9762 | fpr=0.0667 | 5856.8 samples/s | 22.9 steps/s
Avg test loss: 0.09507, Avg test acc: 0.96174, Avg tpr: 0.97389, Avg fpr: 0.06499, total FA: 507

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08590 | acc=0.9645 | tpr=0.9743 | fpr=0.0567 | 5711.7 samples/s | 22.3 steps/s
Avg test loss: 0.09245, Avg test acc: 0.96354, Avg tpr: 0.97336, Avg fpr: 0.05807, total FA: 453

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08636 | acc=0.9649 | tpr=0.9765 | fpr=0.0602 | 5712.9 samples/s | 22.3 steps/s
Avg test loss: 0.09541, Avg test acc: 0.96450, Avg tpr: 0.97575, Avg fpr: 0.06025, total FA: 470

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.58037 | acc=0.2452 | tpr=0.0062 | fpr=0.2356 | 5475.4 samples/s | 21.4 steps/s
Avg test loss: 5.58477, Avg test acc: 0.24301, Avg tpr: 0.00688, Avg fpr: 0.23766, total FA: 1854

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.60507 | acc=0.2891 | tpr=0.0080 | fpr=0.1003 | 5488.9 samples/s | 21.4 steps/s
Avg test loss: 4.61595, Avg test acc: 0.28596, Avg tpr: 0.00699, Avg fpr: 0.10050, total FA: 784

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.42073 | acc=0.2127 | tpr=0.0121 | fpr=0.3516 | 5407.1 samples/s | 21.1 steps/s
Avg test loss: 5.42363, Avg test acc: 0.21404, Avg tpr: 0.01311, Avg fpr: 0.34406, total FA: 2684

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.84596 | acc=0.2245 | tpr=0.0092 | fpr=0.3080 | 5784.5 samples/s | 22.6 steps/s
Avg test loss: 5.85177, Avg test acc: 0.22281, Avg tpr: 0.00898, Avg fpr: 0.30688, total FA: 2394

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.57109 | acc=0.2593 | tpr=0.0110 | fpr=0.2014 | 5739.1 samples/s | 22.4 steps/s
Avg test loss: 5.58360, Avg test acc: 0.25900, Avg tpr: 0.01148, Avg fpr: 0.19664, total FA: 1534

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.30941 | acc=0.1659 | tpr=0.2212 | fpr=0.8351 | 5742.8 samples/s | 22.4 steps/s
[Step= 100] | Loss=5.25531 | acc=0.1660 | tpr=0.1940 | fpr=0.8345 | 7707.2 samples/s | 30.1 steps/s
[Step= 150] | Loss=5.26535 | acc=0.1648 | tpr=0.1888 | fpr=0.8356 | 8128.2 samples/s | 31.8 steps/s
[Step= 200] | Loss=5.26213 | acc=0.1646 | tpr=0.1880 | fpr=0.8359 | 7783.7 samples/s | 30.4 steps/s
[Step= 250] | Loss=5.26748 | acc=0.1643 | tpr=0.1939 | fpr=0.8362 | 7613.0 samples/s | 29.7 steps/s
[Step= 300] | Loss=5.26942 | acc=0.1636 | tpr=0.1942 | fpr=0.8369 | 8426.4 samples/s | 32.9 steps/s
[Step= 350] | Loss=5.27159 | acc=0.1635 | tpr=0.1841 | fpr=0.8369 | 8223.4 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.26896 | acc=0.1639 | tpr=0.1849 | fpr=0.8365 | 7977.4 samples/s | 31.2 steps/s
[Step= 450] | Loss=5.26892 | acc=0.1639 | tpr=0.1821 | fpr=0.8364 | 8695.0 samples/s | 34.0 steps/s
[Step= 500] | Loss=5.27251 | acc=0.1638 | tpr=0.1868 | fpr=0.8366 | 7843.2 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.27062 | acc=0.1639 | tpr=0.1830 | fpr=0.8365 | 10196.5 samples/s | 39.8 steps/s
Avg test loss: 5.27020, Avg test acc: 0.16382, Avg tpr: 0.18304, Avg fpr: 0.83653, total FA: 116151

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.97060 | acc=0.1320 | tpr=0.2345 | fpr=0.8699 | 5827.4 samples/s | 22.8 steps/s
[Step= 100] | Loss=4.93039 | acc=0.1343 | tpr=0.2388 | fpr=0.8676 | 7681.1 samples/s | 30.0 steps/s
[Step= 150] | Loss=4.94376 | acc=0.1322 | tpr=0.2334 | fpr=0.8697 | 7699.1 samples/s | 30.1 steps/s
[Step= 200] | Loss=4.94256 | acc=0.1320 | tpr=0.2262 | fpr=0.8697 | 8280.7 samples/s | 32.3 steps/s
[Step= 250] | Loss=4.94572 | acc=0.1320 | tpr=0.2262 | fpr=0.8697 | 8619.7 samples/s | 33.7 steps/s
[Step= 300] | Loss=4.95005 | acc=0.1319 | tpr=0.2298 | fpr=0.8699 | 8293.2 samples/s | 32.4 steps/s
[Step= 350] | Loss=4.95193 | acc=0.1314 | tpr=0.2179 | fpr=0.8702 | 7948.6 samples/s | 31.0 steps/s
[Step= 400] | Loss=4.95103 | acc=0.1318 | tpr=0.2226 | fpr=0.8698 | 8282.4 samples/s | 32.4 steps/s
[Step= 450] | Loss=4.95144 | acc=0.1320 | tpr=0.2210 | fpr=0.8696 | 7952.1 samples/s | 31.1 steps/s
[Step= 500] | Loss=4.95281 | acc=0.1319 | tpr=0.2247 | fpr=0.8698 | 7326.8 samples/s | 28.6 steps/s
[Step= 550] | Loss=4.95105 | acc=0.1321 | tpr=0.2228 | fpr=0.8695 | 10375.3 samples/s | 40.5 steps/s
Avg test loss: 4.95172, Avg test acc: 0.13208, Avg tpr: 0.22306, Avg fpr: 0.86958, total FA: 120739

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.20620 | acc=0.1331 | tpr=0.1150 | fpr=0.8666 | 5488.0 samples/s | 21.4 steps/s
[Step= 100] | Loss=6.15168 | acc=0.1329 | tpr=0.1151 | fpr=0.8667 | 8442.7 samples/s | 33.0 steps/s
[Step= 150] | Loss=6.15899 | acc=0.1317 | tpr=0.1124 | fpr=0.8679 | 8057.6 samples/s | 31.5 steps/s
[Step= 200] | Loss=6.15093 | acc=0.1323 | tpr=0.1126 | fpr=0.8673 | 8232.9 samples/s | 32.2 steps/s
[Step= 250] | Loss=6.15251 | acc=0.1325 | tpr=0.1118 | fpr=0.8671 | 7428.6 samples/s | 29.0 steps/s
[Step= 300] | Loss=6.15822 | acc=0.1324 | tpr=0.1156 | fpr=0.8673 | 8057.5 samples/s | 31.5 steps/s
[Step= 350] | Loss=6.16200 | acc=0.1319 | tpr=0.1096 | fpr=0.8677 | 8183.4 samples/s | 32.0 steps/s
[Step= 400] | Loss=6.15907 | acc=0.1323 | tpr=0.1171 | fpr=0.8674 | 8373.6 samples/s | 32.7 steps/s
[Step= 450] | Loss=6.15783 | acc=0.1324 | tpr=0.1159 | fpr=0.8673 | 7409.3 samples/s | 28.9 steps/s
[Step= 500] | Loss=6.15937 | acc=0.1323 | tpr=0.1167 | fpr=0.8674 | 8444.4 samples/s | 33.0 steps/s
[Step= 550] | Loss=6.15548 | acc=0.1324 | tpr=0.1150 | fpr=0.8673 | 10819.8 samples/s | 42.3 steps/s
Avg test loss: 6.15548, Avg test acc: 0.13231, Avg tpr: 0.11529, Avg fpr: 0.86738, total FA: 120434

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.35518 | acc=0.1580 | tpr=0.1681 | fpr=0.8421 | 5708.4 samples/s | 22.3 steps/s
[Step= 100] | Loss=5.30457 | acc=0.1588 | tpr=0.1620 | fpr=0.8412 | 8354.9 samples/s | 32.6 steps/s
[Step= 150] | Loss=5.31417 | acc=0.1587 | tpr=0.1527 | fpr=0.8412 | 7505.4 samples/s | 29.3 steps/s
[Step= 200] | Loss=5.30460 | acc=0.1582 | tpr=0.1530 | fpr=0.8417 | 7643.4 samples/s | 29.9 steps/s
[Step= 250] | Loss=5.30945 | acc=0.1581 | tpr=0.1476 | fpr=0.8417 | 8458.2 samples/s | 33.0 steps/s
[Step= 300] | Loss=5.31444 | acc=0.1575 | tpr=0.1535 | fpr=0.8425 | 7912.6 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.31445 | acc=0.1576 | tpr=0.1446 | fpr=0.8421 | 8268.7 samples/s | 32.3 steps/s
[Step= 400] | Loss=5.31261 | acc=0.1583 | tpr=0.1488 | fpr=0.8416 | 8245.3 samples/s | 32.2 steps/s
[Step= 450] | Loss=5.31203 | acc=0.1588 | tpr=0.1490 | fpr=0.8411 | 8232.6 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.31514 | acc=0.1586 | tpr=0.1498 | fpr=0.8413 | 7618.0 samples/s | 29.8 steps/s
[Step= 550] | Loss=5.31315 | acc=0.1587 | tpr=0.1496 | fpr=0.8412 | 10636.7 samples/s | 41.5 steps/s
Avg test loss: 5.31281, Avg test acc: 0.15857, Avg tpr: 0.14976, Avg fpr: 0.84127, total FA: 116808

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.44121 | acc=0.1330 | tpr=0.1327 | fpr=0.8670 | 5652.9 samples/s | 22.1 steps/s
[Step= 100] | Loss=6.37924 | acc=0.1343 | tpr=0.1343 | fpr=0.8657 | 7786.5 samples/s | 30.4 steps/s
[Step= 150] | Loss=6.39466 | acc=0.1333 | tpr=0.1268 | fpr=0.8665 | 7442.1 samples/s | 29.1 steps/s
[Step= 200] | Loss=6.39057 | acc=0.1340 | tpr=0.1257 | fpr=0.8658 | 8141.6 samples/s | 31.8 steps/s
[Step= 250] | Loss=6.39862 | acc=0.1337 | tpr=0.1284 | fpr=0.8662 | 8481.3 samples/s | 33.1 steps/s
[Step= 300] | Loss=6.40352 | acc=0.1334 | tpr=0.1287 | fpr=0.8665 | 7468.4 samples/s | 29.2 steps/s
[Step= 350] | Loss=6.40550 | acc=0.1329 | tpr=0.1227 | fpr=0.8669 | 9008.9 samples/s | 35.2 steps/s
[Step= 400] | Loss=6.40370 | acc=0.1332 | tpr=0.1275 | fpr=0.8667 | 8188.6 samples/s | 32.0 steps/s
[Step= 450] | Loss=6.40368 | acc=0.1336 | tpr=0.1276 | fpr=0.8663 | 7411.9 samples/s | 29.0 steps/s
[Step= 500] | Loss=6.40725 | acc=0.1333 | tpr=0.1291 | fpr=0.8666 | 8381.3 samples/s | 32.7 steps/s
[Step= 550] | Loss=6.40398 | acc=0.1333 | tpr=0.1277 | fpr=0.8666 | 11136.1 samples/s | 43.5 steps/s
Avg test loss: 6.40346, Avg test acc: 0.13322, Avg tpr: 0.12797, Avg fpr: 0.86669, total FA: 120338

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10197 | acc=0.9820 | tpr=0.9248 | fpr=0.0169 | 5679.1 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.10327 | acc=0.9821 | tpr=0.9318 | fpr=0.0170 | 8065.3 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.10646 | acc=0.9814 | tpr=0.9366 | fpr=0.0178 | 7325.5 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.10821 | acc=0.9811 | tpr=0.9432 | fpr=0.0182 | 8165.3 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.10878 | acc=0.9809 | tpr=0.9389 | fpr=0.0183 | 8313.4 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.10990 | acc=0.9808 | tpr=0.9375 | fpr=0.0184 | 8215.8 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.11015 | acc=0.9809 | tpr=0.9399 | fpr=0.0184 | 8130.6 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.11097 | acc=0.9806 | tpr=0.9365 | fpr=0.0186 | 8499.1 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.11323 | acc=0.9802 | tpr=0.9352 | fpr=0.0190 | 8039.2 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.11220 | acc=0.9804 | tpr=0.9383 | fpr=0.0188 | 8061.3 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.11141 | acc=0.9805 | tpr=0.9379 | fpr=0.0187 | 9945.1 samples/s | 38.8 steps/s
Avg test loss: 0.11119, Avg test acc: 0.98055, Avg tpr: 0.93780, Avg fpr: 0.01867, total FA: 2592

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09553 | acc=0.9824 | tpr=0.8938 | fpr=0.0160 | 5629.1 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.09776 | acc=0.9826 | tpr=0.9041 | fpr=0.0160 | 8329.3 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.10018 | acc=0.9824 | tpr=0.9135 | fpr=0.0163 | 7714.6 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.10122 | acc=0.9824 | tpr=0.9202 | fpr=0.0165 | 8254.9 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.10118 | acc=0.9824 | tpr=0.9188 | fpr=0.0164 | 8295.4 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.10260 | acc=0.9823 | tpr=0.9193 | fpr=0.0166 | 7356.3 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.10271 | acc=0.9822 | tpr=0.9198 | fpr=0.0167 | 8472.2 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.10351 | acc=0.9821 | tpr=0.9158 | fpr=0.0167 | 8105.5 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.10548 | acc=0.9818 | tpr=0.9133 | fpr=0.0169 | 7870.2 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.10461 | acc=0.9819 | tpr=0.9154 | fpr=0.0169 | 8291.5 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.10392 | acc=0.9819 | tpr=0.9148 | fpr=0.0169 | 10149.8 samples/s | 39.6 steps/s
Avg test loss: 0.10374, Avg test acc: 0.98194, Avg tpr: 0.91442, Avg fpr: 0.01683, total FA: 2337

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11522 | acc=0.9781 | tpr=0.9381 | fpr=0.0212 | 5689.6 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.11659 | acc=0.9779 | tpr=0.9552 | fpr=0.0216 | 8320.1 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.12056 | acc=0.9776 | tpr=0.9568 | fpr=0.0221 | 7402.5 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.12222 | acc=0.9775 | tpr=0.9607 | fpr=0.0222 | 8575.6 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.12314 | acc=0.9774 | tpr=0.9581 | fpr=0.0222 | 7701.0 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.12411 | acc=0.9774 | tpr=0.9564 | fpr=0.0222 | 8385.1 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.12419 | acc=0.9774 | tpr=0.9587 | fpr=0.0222 | 7904.3 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.12509 | acc=0.9772 | tpr=0.9568 | fpr=0.0224 | 8459.4 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.12739 | acc=0.9768 | tpr=0.9547 | fpr=0.0228 | 8281.0 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.12641 | acc=0.9769 | tpr=0.9559 | fpr=0.0227 | 8032.8 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.12546 | acc=0.9772 | tpr=0.9550 | fpr=0.0224 | 9489.9 samples/s | 37.1 steps/s
Avg test loss: 0.12521, Avg test acc: 0.97717, Avg tpr: 0.95483, Avg fpr: 0.02242, total FA: 3113

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10310 | acc=0.9808 | tpr=0.9292 | fpr=0.0183 | 5709.0 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.10542 | acc=0.9807 | tpr=0.9403 | fpr=0.0185 | 7896.8 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.10813 | acc=0.9802 | tpr=0.9452 | fpr=0.0192 | 8051.2 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.10953 | acc=0.9802 | tpr=0.9497 | fpr=0.0193 | 7411.9 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.11027 | acc=0.9801 | tpr=0.9450 | fpr=0.0193 | 8098.4 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.11120 | acc=0.9800 | tpr=0.9433 | fpr=0.0193 | 7939.7 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.11121 | acc=0.9799 | tpr=0.9461 | fpr=0.0195 | 7961.2 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.11225 | acc=0.9797 | tpr=0.9420 | fpr=0.0197 | 7961.2 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.11429 | acc=0.9794 | tpr=0.9411 | fpr=0.0199 | 8357.2 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.11331 | acc=0.9795 | tpr=0.9436 | fpr=0.0198 | 8049.3 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.11251 | acc=0.9796 | tpr=0.9423 | fpr=0.0197 | 12048.3 samples/s | 47.1 steps/s
Avg test loss: 0.11230, Avg test acc: 0.97965, Avg tpr: 0.94216, Avg fpr: 0.01967, total FA: 2731

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.09853 | acc=0.9816 | tpr=0.9159 | fpr=0.0173 | 5578.8 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.10177 | acc=0.9814 | tpr=0.9339 | fpr=0.0177 | 7892.4 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.10529 | acc=0.9810 | tpr=0.9395 | fpr=0.0183 | 8002.1 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.10680 | acc=0.9809 | tpr=0.9443 | fpr=0.0184 | 8865.7 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.10750 | acc=0.9808 | tpr=0.9406 | fpr=0.0185 | 8305.9 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.10867 | acc=0.9807 | tpr=0.9396 | fpr=0.0185 | 7442.2 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.10891 | acc=0.9807 | tpr=0.9418 | fpr=0.0186 | 7921.4 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.10962 | acc=0.9806 | tpr=0.9387 | fpr=0.0186 | 8590.7 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.11152 | acc=0.9803 | tpr=0.9362 | fpr=0.0189 | 8013.1 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.11071 | acc=0.9805 | tpr=0.9379 | fpr=0.0188 | 8164.1 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.11005 | acc=0.9805 | tpr=0.9363 | fpr=0.0187 | 9715.6 samples/s | 38.0 steps/s
Avg test loss: 0.10987, Avg test acc: 0.98049, Avg tpr: 0.93582, Avg fpr: 0.01870, total FA: 2596

server round 31/50

clients selected: [1 4 5 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=42001 Epoch=204.9] | Loss=0.01552 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.406 | L2-Norm(final)=15.381 | 6117.9 samples/s | 95.6 steps/s
[Step=42050 Epoch=205.2] | Loss=0.01893 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.407 | L2-Norm(final)=15.377 | 4870.4 samples/s | 76.1 steps/s
[Step=42100 Epoch=205.4] | Loss=0.01981 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.407 | L2-Norm(final)=15.373 | 5517.1 samples/s | 86.2 steps/s
[Step=42150 Epoch=205.7] | Loss=0.01910 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.407 | L2-Norm(final)=15.370 | 5600.2 samples/s | 87.5 steps/s
[Step=42200 Epoch=205.9] | Loss=0.01873 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.407 | L2-Norm(final)=15.368 | 8903.1 samples/s | 139.1 steps/s
[Step=42250 Epoch=206.2] | Loss=0.01829 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.407 | L2-Norm(final)=15.366 | 2387.1 samples/s | 37.3 steps/s
[Step=42300 Epoch=206.4] | Loss=0.01817 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.407 | L2-Norm(final)=15.365 | 5636.0 samples/s | 88.1 steps/s
[Step=42350 Epoch=206.6] | Loss=0.01855 | Reg=0.00108 | acc=0.9375 | L2-Norm=10.407 | L2-Norm(final)=15.363 | 5559.8 samples/s | 86.9 steps/s
[Step=42400 Epoch=206.9] | Loss=0.01830 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.407 | L2-Norm(final)=15.361 | 7980.1 samples/s | 124.7 steps/s
[Step=42450 Epoch=207.1] | Loss=0.01832 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.407 | L2-Norm(final)=15.359 | 2458.3 samples/s | 38.4 steps/s
[Step=42500 Epoch=207.4] | Loss=0.01827 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.407 | L2-Norm(final)=15.358 | 5697.0 samples/s | 89.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=42501 Epoch=207.4] | Loss=0.00288 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.407 | L2-Norm(final)=15.346 | 5829.7 samples/s | 91.1 steps/s
[Step=42550 Epoch=207.6] | Loss=0.01914 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.420 | L2-Norm(final)=15.346 | 4358.0 samples/s | 68.1 steps/s
[Step=42600 Epoch=207.9] | Loss=0.01933 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.431 | L2-Norm(final)=15.344 | 4853.9 samples/s | 75.8 steps/s
[Step=42650 Epoch=208.1] | Loss=0.01782 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.440 | L2-Norm(final)=15.344 | 4862.2 samples/s | 76.0 steps/s
[Step=42700 Epoch=208.4] | Loss=0.01607 | Reg=0.00109 | acc=0.9688 | L2-Norm=10.448 | L2-Norm(final)=15.345 | 7012.4 samples/s | 109.6 steps/s
[Step=42750 Epoch=208.6] | Loss=0.01386 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.455 | L2-Norm(final)=15.347 | 2243.0 samples/s | 35.0 steps/s
[Step=42800 Epoch=208.8] | Loss=0.01249 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.461 | L2-Norm(final)=15.349 | 4818.6 samples/s | 75.3 steps/s
[Step=42850 Epoch=209.1] | Loss=0.01144 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.467 | L2-Norm(final)=15.352 | 4861.4 samples/s | 76.0 steps/s
[Step=42900 Epoch=209.3] | Loss=0.01067 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.471 | L2-Norm(final)=15.354 | 6485.7 samples/s | 101.3 steps/s
[Step=42950 Epoch=209.6] | Loss=0.00981 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.476 | L2-Norm(final)=15.357 | 2339.2 samples/s | 36.5 steps/s
[Step=43000 Epoch=209.8] | Loss=0.00925 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=15.359 | 4806.7 samples/s | 75.1 steps/s
[Step=43050 Epoch=210.1] | Loss=0.00871 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.483 | L2-Norm(final)=15.361 | 4849.4 samples/s | 75.8 steps/s
[Step=43100 Epoch=210.3] | Loss=0.00833 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.486 | L2-Norm(final)=15.363 | 6015.6 samples/s | 94.0 steps/s
[Step=43150 Epoch=210.6] | Loss=0.00798 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.489 | L2-Norm(final)=15.366 | 2379.7 samples/s | 37.2 steps/s
[Step=43200 Epoch=210.8] | Loss=0.00766 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.491 | L2-Norm(final)=15.368 | 4834.1 samples/s | 75.5 steps/s
[Step=43250 Epoch=211.0] | Loss=0.00732 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.494 | L2-Norm(final)=15.370 | 4905.4 samples/s | 76.6 steps/s
[Step=43300 Epoch=211.3] | Loss=0.00704 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.496 | L2-Norm(final)=15.371 | 5565.4 samples/s | 87.0 steps/s
[Step=43350 Epoch=211.5] | Loss=0.00676 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.498 | L2-Norm(final)=15.373 | 2458.4 samples/s | 38.4 steps/s
[Step=43400 Epoch=211.8] | Loss=0.00650 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.501 | L2-Norm(final)=15.375 | 4950.5 samples/s | 77.4 steps/s
[Step=43450 Epoch=212.0] | Loss=0.00634 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.503 | L2-Norm(final)=15.377 | 4863.3 samples/s | 76.0 steps/s
[Step=43500 Epoch=212.3] | Loss=0.00614 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.505 | L2-Norm(final)=15.379 | 5215.3 samples/s | 81.5 steps/s
[Step=43550 Epoch=212.5] | Loss=0.00604 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.507 | L2-Norm(final)=15.381 | 2532.8 samples/s | 39.6 steps/s
[Step=43600 Epoch=212.7] | Loss=0.00589 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.508 | L2-Norm(final)=15.382 | 4888.5 samples/s | 76.4 steps/s
[Step=43650 Epoch=213.0] | Loss=0.00570 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.510 | L2-Norm(final)=15.384 | 4896.4 samples/s | 76.5 steps/s
[Step=43700 Epoch=213.2] | Loss=0.00563 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.512 | L2-Norm(final)=15.385 | 4914.5 samples/s | 76.8 steps/s
[Step=43750 Epoch=213.5] | Loss=0.00549 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.513 | L2-Norm(final)=15.387 | 2605.2 samples/s | 40.7 steps/s
[Step=43800 Epoch=213.7] | Loss=0.00540 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.515 | L2-Norm(final)=15.389 | 4952.2 samples/s | 77.4 steps/s
[Step=43850 Epoch=214.0] | Loss=0.00530 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.517 | L2-Norm(final)=15.390 | 4796.8 samples/s | 74.9 steps/s
[Step=43900 Epoch=214.2] | Loss=0.00521 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.518 | L2-Norm(final)=15.391 | 4838.5 samples/s | 75.6 steps/s
[Step=43950 Epoch=214.5] | Loss=0.00511 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.519 | L2-Norm(final)=15.393 | 2646.9 samples/s | 41.4 steps/s
[Step=44000 Epoch=214.7] | Loss=0.00502 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.521 | L2-Norm(final)=15.394 | 4705.8 samples/s | 73.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step44000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=40001 Epoch=196.2] | Loss=0.01404 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.406 | L2-Norm(final)=15.298 | 5685.3 samples/s | 88.8 steps/s
[Step=40050 Epoch=196.4] | Loss=0.02100 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.406 | L2-Norm(final)=15.295 | 4994.5 samples/s | 78.0 steps/s
[Step=40100 Epoch=196.6] | Loss=0.01914 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=15.292 | 5690.2 samples/s | 88.9 steps/s
[Step=40150 Epoch=196.9] | Loss=0.01903 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=15.293 | 5588.3 samples/s | 87.3 steps/s
[Step=40200 Epoch=197.1] | Loss=0.01861 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.406 | L2-Norm(final)=15.292 | 8912.9 samples/s | 139.3 steps/s
[Step=40250 Epoch=197.4] | Loss=0.01838 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=15.291 | 2420.7 samples/s | 37.8 steps/s
[Step=40300 Epoch=197.6] | Loss=0.01820 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=15.291 | 5573.4 samples/s | 87.1 steps/s
[Step=40350 Epoch=197.9] | Loss=0.01824 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=15.291 | 5625.0 samples/s | 87.9 steps/s
[Step=40400 Epoch=198.1] | Loss=0.01838 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.406 | L2-Norm(final)=15.291 | 8306.7 samples/s | 129.8 steps/s
[Step=40450 Epoch=198.4] | Loss=0.01849 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.406 | L2-Norm(final)=15.291 | 2424.9 samples/s | 37.9 steps/s
[Step=40500 Epoch=198.6] | Loss=0.01873 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=15.290 | 5721.6 samples/s | 89.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=40501 Epoch=198.6] | Loss=0.00997 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=15.285 | 5616.5 samples/s | 87.8 steps/s
[Step=40550 Epoch=198.9] | Loss=0.01904 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.417 | L2-Norm(final)=15.282 | 4454.0 samples/s | 69.6 steps/s
[Step=40600 Epoch=199.1] | Loss=0.01826 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.430 | L2-Norm(final)=15.283 | 4942.7 samples/s | 77.2 steps/s
[Step=40650 Epoch=199.3] | Loss=0.01714 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.441 | L2-Norm(final)=15.283 | 4806.5 samples/s | 75.1 steps/s
[Step=40700 Epoch=199.6] | Loss=0.01580 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.450 | L2-Norm(final)=15.284 | 7124.7 samples/s | 111.3 steps/s
[Step=40750 Epoch=199.8] | Loss=0.01375 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.458 | L2-Norm(final)=15.287 | 2258.0 samples/s | 35.3 steps/s
[Step=40800 Epoch=200.1] | Loss=0.01234 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.464 | L2-Norm(final)=15.289 | 4863.3 samples/s | 76.0 steps/s
[Step=40850 Epoch=200.3] | Loss=0.01115 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=15.292 | 4835.1 samples/s | 75.5 steps/s
[Step=40900 Epoch=200.6] | Loss=0.01031 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.475 | L2-Norm(final)=15.295 | 6692.7 samples/s | 104.6 steps/s
[Step=40950 Epoch=200.8] | Loss=0.00952 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.480 | L2-Norm(final)=15.298 | 2295.4 samples/s | 35.9 steps/s
[Step=41000 Epoch=201.1] | Loss=0.00899 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.484 | L2-Norm(final)=15.300 | 4863.8 samples/s | 76.0 steps/s
[Step=41050 Epoch=201.3] | Loss=0.00845 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.488 | L2-Norm(final)=15.303 | 4871.0 samples/s | 76.1 steps/s
[Step=41100 Epoch=201.5] | Loss=0.00814 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.491 | L2-Norm(final)=15.306 | 6165.6 samples/s | 96.3 steps/s
[Step=41150 Epoch=201.8] | Loss=0.00768 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.494 | L2-Norm(final)=15.308 | 2347.6 samples/s | 36.7 steps/s
[Step=41200 Epoch=202.0] | Loss=0.00752 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=15.310 | 4834.8 samples/s | 75.5 steps/s
[Step=41250 Epoch=202.3] | Loss=0.00720 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.500 | L2-Norm(final)=15.312 | 4894.8 samples/s | 76.5 steps/s
[Step=41300 Epoch=202.5] | Loss=0.00692 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.503 | L2-Norm(final)=15.314 | 5840.3 samples/s | 91.3 steps/s
[Step=41350 Epoch=202.8] | Loss=0.00667 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.505 | L2-Norm(final)=15.316 | 2386.6 samples/s | 37.3 steps/s
[Step=41400 Epoch=203.0] | Loss=0.00655 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.508 | L2-Norm(final)=15.318 | 4904.9 samples/s | 76.6 steps/s
[Step=41450 Epoch=203.3] | Loss=0.00640 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.510 | L2-Norm(final)=15.320 | 4843.2 samples/s | 75.7 steps/s
[Step=41500 Epoch=203.5] | Loss=0.00622 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.512 | L2-Norm(final)=15.322 | 5589.9 samples/s | 87.3 steps/s
[Step=41550 Epoch=203.8] | Loss=0.00601 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.515 | L2-Norm(final)=15.324 | 2451.0 samples/s | 38.3 steps/s
[Step=41600 Epoch=204.0] | Loss=0.00579 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.517 | L2-Norm(final)=15.326 | 4881.1 samples/s | 76.3 steps/s
[Step=41650 Epoch=204.2] | Loss=0.00562 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.519 | L2-Norm(final)=15.327 | 4926.6 samples/s | 77.0 steps/s
[Step=41700 Epoch=204.5] | Loss=0.00551 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.521 | L2-Norm(final)=15.329 | 5262.8 samples/s | 82.2 steps/s
[Step=41750 Epoch=204.7] | Loss=0.00540 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.523 | L2-Norm(final)=15.331 | 2490.1 samples/s | 38.9 steps/s
[Step=41800 Epoch=205.0] | Loss=0.00529 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.524 | L2-Norm(final)=15.333 | 4872.5 samples/s | 76.1 steps/s
[Step=41850 Epoch=205.2] | Loss=0.00516 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.526 | L2-Norm(final)=15.334 | 4936.0 samples/s | 77.1 steps/s
[Step=41900 Epoch=205.5] | Loss=0.00507 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.528 | L2-Norm(final)=15.336 | 4990.2 samples/s | 78.0 steps/s
[Step=41950 Epoch=205.7] | Loss=0.00497 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.529 | L2-Norm(final)=15.338 | 2533.3 samples/s | 39.6 steps/s
[Step=42000 Epoch=206.0] | Loss=0.00484 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.531 | L2-Norm(final)=15.339 | 4886.9 samples/s | 76.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step42000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=30001 Epoch=284.3] | Loss=0.00103 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=15.137 | 5577.3 samples/s | 87.1 steps/s
[Step=30050 Epoch=284.7] | Loss=0.00078 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=15.138 | 4726.2 samples/s | 73.8 steps/s
[Step=30100 Epoch=285.2] | Loss=0.00078 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=15.142 | 7892.5 samples/s | 123.3 steps/s
[Step=30150 Epoch=285.7] | Loss=0.00077 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=15.146 | 2333.2 samples/s | 36.5 steps/s
[Step=30200 Epoch=286.2] | Loss=0.00074 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=15.151 | 7222.5 samples/s | 112.9 steps/s
[Step=30250 Epoch=286.6] | Loss=0.00075 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=15.157 | 2440.8 samples/s | 38.1 steps/s
[Step=30300 Epoch=287.1] | Loss=0.00073 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=15.163 | 6654.6 samples/s | 104.0 steps/s
[Step=30350 Epoch=287.6] | Loss=0.00074 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=15.169 | 2543.2 samples/s | 39.7 steps/s
[Step=30400 Epoch=288.1] | Loss=0.00073 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=15.176 | 5843.5 samples/s | 91.3 steps/s
[Step=30450 Epoch=288.5] | Loss=0.00073 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=15.182 | 2606.1 samples/s | 40.7 steps/s
[Step=30500 Epoch=289.0] | Loss=0.00073 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=15.189 | 5452.7 samples/s | 85.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=289.0] | Loss=0.00115 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=15.259 | 5722.9 samples/s | 89.4 steps/s
[Step=30550 Epoch=289.5] | Loss=0.00066 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.417 | L2-Norm(final)=15.263 | 4126.7 samples/s | 64.5 steps/s
[Step=30600 Epoch=290.0] | Loss=0.00036 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.420 | L2-Norm(final)=15.265 | 6697.2 samples/s | 104.6 steps/s
[Step=30650 Epoch=290.4] | Loss=0.00025 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.420 | L2-Norm(final)=15.268 | 2210.1 samples/s | 34.5 steps/s
[Step=30700 Epoch=290.9] | Loss=0.00019 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.418 | L2-Norm(final)=15.269 | 5945.3 samples/s | 92.9 steps/s
[Step=30750 Epoch=291.4] | Loss=0.00015 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.414 | L2-Norm(final)=15.270 | 2276.7 samples/s | 35.6 steps/s
[Step=30800 Epoch=291.9] | Loss=0.00013 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.410 | L2-Norm(final)=15.271 | 5552.0 samples/s | 86.7 steps/s
[Step=30850 Epoch=292.3] | Loss=0.00011 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=15.272 | 2382.6 samples/s | 37.2 steps/s
[Step=30900 Epoch=292.8] | Loss=0.00010 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.401 | L2-Norm(final)=15.272 | 5068.1 samples/s | 79.2 steps/s
[Step=30950 Epoch=293.3] | Loss=0.00009 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=15.273 | 2449.5 samples/s | 38.3 steps/s
[Step=31000 Epoch=293.8] | Loss=0.00008 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=15.274 | 4752.9 samples/s | 74.3 steps/s
[Step=31050 Epoch=294.2] | Loss=0.00007 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.386 | L2-Norm(final)=15.274 | 2548.2 samples/s | 39.8 steps/s
[Step=31100 Epoch=294.7] | Loss=0.00007 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.381 | L2-Norm(final)=15.275 | 4565.2 samples/s | 71.3 steps/s
[Step=31150 Epoch=295.2] | Loss=0.00006 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.375 | L2-Norm(final)=15.276 | 2577.1 samples/s | 40.3 steps/s
[Step=31200 Epoch=295.6] | Loss=0.00006 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.370 | L2-Norm(final)=15.276 | 4612.1 samples/s | 72.1 steps/s
[Step=31250 Epoch=296.1] | Loss=0.00005 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.365 | L2-Norm(final)=15.277 | 2573.1 samples/s | 40.2 steps/s
[Step=31300 Epoch=296.6] | Loss=0.00005 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=15.277 | 4652.9 samples/s | 72.7 steps/s
[Step=31350 Epoch=297.1] | Loss=0.00005 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.354 | L2-Norm(final)=15.278 | 2722.8 samples/s | 42.5 steps/s
[Step=31400 Epoch=297.5] | Loss=0.00005 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.348 | L2-Norm(final)=15.278 | 4246.2 samples/s | 66.3 steps/s
[Step=31450 Epoch=298.0] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.343 | L2-Norm(final)=15.279 | 6925.0 samples/s | 108.2 steps/s
[Step=31500 Epoch=298.5] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.337 | L2-Norm(final)=15.279 | 2189.6 samples/s | 34.2 steps/s
[Step=31550 Epoch=299.0] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.332 | L2-Norm(final)=15.280 | 6091.1 samples/s | 95.2 steps/s
[Step=31600 Epoch=299.4] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.326 | L2-Norm(final)=15.281 | 2242.9 samples/s | 35.0 steps/s
[Step=31650 Epoch=299.9] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.320 | L2-Norm(final)=15.281 | 5733.5 samples/s | 89.6 steps/s
[Step=31700 Epoch=300.4] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.314 | L2-Norm(final)=15.282 | 2342.2 samples/s | 36.6 steps/s
[Step=31750 Epoch=300.9] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.309 | L2-Norm(final)=15.282 | 5209.1 samples/s | 81.4 steps/s
[Step=31800 Epoch=301.3] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.303 | L2-Norm(final)=15.283 | 2427.0 samples/s | 37.9 steps/s
[Step=31850 Epoch=301.8] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.297 | L2-Norm(final)=15.283 | 4834.4 samples/s | 75.5 steps/s
[Step=31900 Epoch=302.3] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.291 | L2-Norm(final)=15.284 | 2521.6 samples/s | 39.4 steps/s
[Step=31950 Epoch=302.8] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.285 | L2-Norm(final)=15.284 | 4662.1 samples/s | 72.8 steps/s
[Step=32000 Epoch=303.2] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.278 | L2-Norm(final)=15.285 | 2574.8 samples/s | 40.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step32000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=28001 Epoch=263.8] | Loss=0.00038 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=15.258 | 5477.1 samples/s | 85.6 steps/s
[Step=28050 Epoch=264.3] | Loss=0.00047 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=15.266 | 4763.2 samples/s | 74.4 steps/s
[Step=28100 Epoch=264.8] | Loss=0.00062 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=15.281 | 8094.2 samples/s | 126.5 steps/s
[Step=28150 Epoch=265.3] | Loss=0.00064 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=15.296 | 2367.3 samples/s | 37.0 steps/s
[Step=28200 Epoch=265.7] | Loss=0.00066 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=15.310 | 6977.7 samples/s | 109.0 steps/s
[Step=28250 Epoch=266.2] | Loss=0.00067 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=15.323 | 2451.8 samples/s | 38.3 steps/s
[Step=28300 Epoch=266.7] | Loss=0.00065 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=15.335 | 6272.4 samples/s | 98.0 steps/s
[Step=28350 Epoch=267.1] | Loss=0.00067 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=15.346 | 2581.3 samples/s | 40.3 steps/s
[Step=28400 Epoch=267.6] | Loss=0.00064 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=15.357 | 5709.4 samples/s | 89.2 steps/s
[Step=28450 Epoch=268.1] | Loss=0.00063 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=15.368 | 2677.5 samples/s | 41.8 steps/s
[Step=28500 Epoch=268.6] | Loss=0.00064 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=15.378 | 5334.5 samples/s | 83.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=28501 Epoch=268.6] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=15.481 | 5711.3 samples/s | 89.2 steps/s
[Step=28550 Epoch=269.0] | Loss=0.00180 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.413 | L2-Norm(final)=15.487 | 4134.0 samples/s | 64.6 steps/s
[Step=28600 Epoch=269.5] | Loss=0.00101 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.428 | L2-Norm(final)=15.486 | 6606.2 samples/s | 103.2 steps/s
[Step=28650 Epoch=270.0] | Loss=0.00069 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.433 | L2-Norm(final)=15.487 | 2200.7 samples/s | 34.4 steps/s
[Step=28700 Epoch=270.4] | Loss=0.00052 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.433 | L2-Norm(final)=15.488 | 5918.4 samples/s | 92.5 steps/s
[Step=28750 Epoch=270.9] | Loss=0.00042 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.432 | L2-Norm(final)=15.489 | 2277.6 samples/s | 35.6 steps/s
[Step=28800 Epoch=271.4] | Loss=0.00035 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.429 | L2-Norm(final)=15.489 | 5390.8 samples/s | 84.2 steps/s
[Step=28850 Epoch=271.8] | Loss=0.00030 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.426 | L2-Norm(final)=15.490 | 2403.1 samples/s | 37.5 steps/s
[Step=28900 Epoch=272.3] | Loss=0.00026 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.423 | L2-Norm(final)=15.491 | 4915.9 samples/s | 76.8 steps/s
[Step=28950 Epoch=272.8] | Loss=0.00024 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.419 | L2-Norm(final)=15.491 | 2517.0 samples/s | 39.3 steps/s
[Step=29000 Epoch=273.3] | Loss=0.00021 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.416 | L2-Norm(final)=15.492 | 4680.4 samples/s | 73.1 steps/s
[Step=29050 Epoch=273.7] | Loss=0.00019 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.412 | L2-Norm(final)=15.492 | 2563.1 samples/s | 40.0 steps/s
[Step=29100 Epoch=274.2] | Loss=0.00018 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.408 | L2-Norm(final)=15.493 | 4665.9 samples/s | 72.9 steps/s
[Step=29150 Epoch=274.7] | Loss=0.00016 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.403 | L2-Norm(final)=15.493 | 2581.8 samples/s | 40.3 steps/s
[Step=29200 Epoch=275.1] | Loss=0.00015 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=15.494 | 4580.4 samples/s | 71.6 steps/s
[Step=29250 Epoch=275.6] | Loss=0.00014 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.395 | L2-Norm(final)=15.494 | 2901.2 samples/s | 45.3 steps/s
[Step=29300 Epoch=276.1] | Loss=0.00013 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=15.495 | 3895.1 samples/s | 60.9 steps/s
[Step=29350 Epoch=276.6] | Loss=0.00013 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.386 | L2-Norm(final)=15.495 | 6681.5 samples/s | 104.4 steps/s
[Step=29400 Epoch=277.0] | Loss=0.00012 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.382 | L2-Norm(final)=15.496 | 2189.2 samples/s | 34.2 steps/s
[Step=29450 Epoch=277.5] | Loss=0.00011 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.378 | L2-Norm(final)=15.496 | 6033.8 samples/s | 94.3 steps/s
[Step=29500 Epoch=278.0] | Loss=0.00011 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.373 | L2-Norm(final)=15.496 | 2291.3 samples/s | 35.8 steps/s
[Step=29550 Epoch=278.4] | Loss=0.00010 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.369 | L2-Norm(final)=15.497 | 5403.2 samples/s | 84.4 steps/s
[Step=29600 Epoch=278.9] | Loss=0.00010 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.364 | L2-Norm(final)=15.497 | 2385.6 samples/s | 37.3 steps/s
[Step=29650 Epoch=279.4] | Loss=0.00009 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=15.498 | 4960.1 samples/s | 77.5 steps/s
[Step=29700 Epoch=279.9] | Loss=0.00009 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.355 | L2-Norm(final)=15.498 | 2496.6 samples/s | 39.0 steps/s
[Step=29750 Epoch=280.3] | Loss=0.00009 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.350 | L2-Norm(final)=15.498 | 4604.4 samples/s | 71.9 steps/s
[Step=29800 Epoch=280.8] | Loss=0.00008 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.345 | L2-Norm(final)=15.499 | 2577.2 samples/s | 40.3 steps/s
[Step=29850 Epoch=281.3] | Loss=0.00008 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.340 | L2-Norm(final)=15.499 | 4629.3 samples/s | 72.3 steps/s
[Step=29900 Epoch=281.7] | Loss=0.00008 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.336 | L2-Norm(final)=15.500 | 2600.6 samples/s | 40.6 steps/s
[Step=29950 Epoch=282.2] | Loss=0.00008 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.331 | L2-Norm(final)=15.500 | 4644.7 samples/s | 72.6 steps/s
[Step=30000 Epoch=282.7] | Loss=0.00007 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.326 | L2-Norm(final)=15.500 | 2650.8 samples/s | 41.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step30000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=20001 Epoch=190.6] | Loss=0.00019 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=14.250 | 5972.8 samples/s | 93.3 steps/s
[Step=20050 Epoch=191.1] | Loss=0.00192 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=14.255 | 4494.5 samples/s | 70.2 steps/s
[Step=20100 Epoch=191.6] | Loss=0.00170 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=14.261 | 8509.0 samples/s | 133.0 steps/s
[Step=20150 Epoch=192.0] | Loss=0.00164 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=14.267 | 2388.0 samples/s | 37.3 steps/s
[Step=20200 Epoch=192.5] | Loss=0.00184 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=14.273 | 7110.2 samples/s | 111.1 steps/s
[Step=20250 Epoch=193.0] | Loss=0.00195 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=14.279 | 2389.5 samples/s | 37.3 steps/s
[Step=20300 Epoch=193.5] | Loss=0.00184 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=14.284 | 6950.5 samples/s | 108.6 steps/s
[Step=20350 Epoch=194.0] | Loss=0.00178 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=14.289 | 2479.5 samples/s | 38.7 steps/s
[Step=20400 Epoch=194.4] | Loss=0.00170 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=14.295 | 6304.4 samples/s | 98.5 steps/s
[Step=20450 Epoch=194.9] | Loss=0.00178 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=14.301 | 2533.2 samples/s | 39.6 steps/s
[Step=20500 Epoch=195.4] | Loss=0.00183 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=14.307 | 5848.1 samples/s | 91.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=20501 Epoch=195.4] | Loss=0.00012 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=14.364 | 5941.4 samples/s | 92.8 steps/s
[Step=20550 Epoch=195.9] | Loss=0.00205 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.431 | L2-Norm(final)=14.365 | 4175.7 samples/s | 65.2 steps/s
[Step=20600 Epoch=196.3] | Loss=0.00116 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.452 | L2-Norm(final)=14.365 | 6639.4 samples/s | 103.7 steps/s
[Step=20650 Epoch=196.8] | Loss=0.00078 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.460 | L2-Norm(final)=14.367 | 2180.5 samples/s | 34.1 steps/s
[Step=20700 Epoch=197.3] | Loss=0.00059 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.462 | L2-Norm(final)=14.368 | 6193.3 samples/s | 96.8 steps/s
[Step=20750 Epoch=197.8] | Loss=0.00048 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.463 | L2-Norm(final)=14.369 | 2257.3 samples/s | 35.3 steps/s
[Step=20800 Epoch=198.2] | Loss=0.00040 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.463 | L2-Norm(final)=14.370 | 5803.1 samples/s | 90.7 steps/s
[Step=20850 Epoch=198.7] | Loss=0.00035 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.462 | L2-Norm(final)=14.371 | 2340.2 samples/s | 36.6 steps/s
[Step=20900 Epoch=199.2] | Loss=0.00031 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.461 | L2-Norm(final)=14.372 | 5275.9 samples/s | 82.4 steps/s
[Step=20950 Epoch=199.7] | Loss=0.00027 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.459 | L2-Norm(final)=14.373 | 2355.9 samples/s | 36.8 steps/s
[Step=21000 Epoch=200.1] | Loss=0.00025 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.457 | L2-Norm(final)=14.373 | 5048.5 samples/s | 78.9 steps/s
[Step=21050 Epoch=200.6] | Loss=0.00022 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.455 | L2-Norm(final)=14.374 | 2456.5 samples/s | 38.4 steps/s
[Step=21100 Epoch=201.1] | Loss=0.00021 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.453 | L2-Norm(final)=14.375 | 4705.9 samples/s | 73.5 steps/s
[Step=21150 Epoch=201.6] | Loss=0.00019 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.450 | L2-Norm(final)=14.375 | 2537.6 samples/s | 39.6 steps/s
[Step=21200 Epoch=202.1] | Loss=0.00018 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.448 | L2-Norm(final)=14.376 | 4586.4 samples/s | 71.7 steps/s
[Step=21250 Epoch=202.5] | Loss=0.00017 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.446 | L2-Norm(final)=14.376 | 2527.2 samples/s | 39.5 steps/s
[Step=21300 Epoch=203.0] | Loss=0.00016 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.443 | L2-Norm(final)=14.377 | 4632.5 samples/s | 72.4 steps/s
[Step=21350 Epoch=203.5] | Loss=0.00015 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.440 | L2-Norm(final)=14.378 | 2591.9 samples/s | 40.5 steps/s
[Step=21400 Epoch=204.0] | Loss=0.00014 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.438 | L2-Norm(final)=14.378 | 4573.3 samples/s | 71.5 steps/s
[Step=21450 Epoch=204.4] | Loss=0.00013 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.435 | L2-Norm(final)=14.379 | 2605.7 samples/s | 40.7 steps/s
[Step=21500 Epoch=204.9] | Loss=0.00013 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.432 | L2-Norm(final)=14.379 | 4600.2 samples/s | 71.9 steps/s
[Step=21550 Epoch=205.4] | Loss=0.00012 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.429 | L2-Norm(final)=14.380 | 7407.5 samples/s | 115.7 steps/s
[Step=21600 Epoch=205.9] | Loss=0.00012 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.427 | L2-Norm(final)=14.380 | 2132.8 samples/s | 33.3 steps/s
[Step=21650 Epoch=206.3] | Loss=0.00011 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.424 | L2-Norm(final)=14.381 | 6656.1 samples/s | 104.0 steps/s
[Step=21700 Epoch=206.8] | Loss=0.00011 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.421 | L2-Norm(final)=14.381 | 2170.5 samples/s | 33.9 steps/s
[Step=21750 Epoch=207.3] | Loss=0.00010 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.418 | L2-Norm(final)=14.382 | 6230.8 samples/s | 97.4 steps/s
[Step=21800 Epoch=207.8] | Loss=0.00010 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.415 | L2-Norm(final)=14.383 | 2272.5 samples/s | 35.5 steps/s
[Step=21850 Epoch=208.3] | Loss=0.00010 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.411 | L2-Norm(final)=14.383 | 5614.0 samples/s | 87.7 steps/s
[Step=21900 Epoch=208.7] | Loss=0.00009 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.408 | L2-Norm(final)=14.384 | 2309.2 samples/s | 36.1 steps/s
[Step=21950 Epoch=209.2] | Loss=0.00009 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=14.384 | 5361.2 samples/s | 83.8 steps/s
[Step=22000 Epoch=209.7] | Loss=0.00009 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.402 | L2-Norm(final)=14.384 | 2385.1 samples/s | 37.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4/client_state-step22000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09373 | acc=0.9584 | tpr=0.9638 | fpr=0.0535 | 5621.2 samples/s | 22.0 steps/s
Avg test loss: 0.10039, Avg test acc: 0.95781, Avg tpr: 0.96334, Avg fpr: 0.05435, total FA: 424

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08502 | acc=0.9651 | tpr=0.9758 | fpr=0.0582 | 5666.7 samples/s | 22.1 steps/s
Avg test loss: 0.09237, Avg test acc: 0.96394, Avg tpr: 0.97453, Avg fpr: 0.05935, total FA: 463

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08947 | acc=0.9627 | tpr=0.9762 | fpr=0.0667 | 5741.2 samples/s | 22.4 steps/s
Avg test loss: 0.09507, Avg test acc: 0.96174, Avg tpr: 0.97389, Avg fpr: 0.06499, total FA: 507

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08590 | acc=0.9645 | tpr=0.9743 | fpr=0.0567 | 5878.8 samples/s | 23.0 steps/s
Avg test loss: 0.09245, Avg test acc: 0.96354, Avg tpr: 0.97336, Avg fpr: 0.05807, total FA: 453

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08666 | acc=0.9642 | tpr=0.9725 | fpr=0.0538 | 5648.1 samples/s | 22.1 steps/s
Avg test loss: 0.09594, Avg test acc: 0.96294, Avg tpr: 0.97092, Avg fpr: 0.05461, total FA: 426

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.38077 | acc=0.2558 | tpr=0.0060 | fpr=0.2019 | 5748.1 samples/s | 22.5 steps/s
Avg test loss: 5.38527, Avg test acc: 0.25479, Avg tpr: 0.00629, Avg fpr: 0.19869, total FA: 1550

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.60507 | acc=0.2891 | tpr=0.0080 | fpr=0.1003 | 5715.3 samples/s | 22.3 steps/s
Avg test loss: 4.61595, Avg test acc: 0.28596, Avg tpr: 0.00699, Avg fpr: 0.10050, total FA: 784

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.42073 | acc=0.2127 | tpr=0.0121 | fpr=0.3516 | 5756.7 samples/s | 22.5 steps/s
Avg test loss: 5.42363, Avg test acc: 0.21404, Avg tpr: 0.01311, Avg fpr: 0.34406, total FA: 2684

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.64410 | acc=0.2287 | tpr=0.0095 | fpr=0.2953 | 5816.3 samples/s | 22.7 steps/s
Avg test loss: 5.64635, Avg test acc: 0.22738, Avg tpr: 0.00968, Avg fpr: 0.29381, total FA: 2292

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.59919 | acc=0.2459 | tpr=0.0084 | fpr=0.2384 | 5762.8 samples/s | 22.5 steps/s
Avg test loss: 5.60686, Avg test acc: 0.24361, Avg tpr: 0.00839, Avg fpr: 0.23907, total FA: 1865

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.30941 | acc=0.1659 | tpr=0.2212 | fpr=0.8351 | 5795.3 samples/s | 22.6 steps/s
[Step= 100] | Loss=5.25531 | acc=0.1660 | tpr=0.1940 | fpr=0.8345 | 8196.3 samples/s | 32.0 steps/s
[Step= 150] | Loss=5.26535 | acc=0.1648 | tpr=0.1888 | fpr=0.8356 | 7910.4 samples/s | 30.9 steps/s
[Step= 200] | Loss=5.26213 | acc=0.1646 | tpr=0.1880 | fpr=0.8359 | 8252.7 samples/s | 32.2 steps/s
[Step= 250] | Loss=5.26748 | acc=0.1643 | tpr=0.1939 | fpr=0.8362 | 7572.1 samples/s | 29.6 steps/s
[Step= 300] | Loss=5.26942 | acc=0.1636 | tpr=0.1942 | fpr=0.8369 | 8272.4 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.27159 | acc=0.1635 | tpr=0.1841 | fpr=0.8369 | 8226.9 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.26896 | acc=0.1639 | tpr=0.1849 | fpr=0.8365 | 8436.2 samples/s | 33.0 steps/s
[Step= 450] | Loss=5.26892 | acc=0.1639 | tpr=0.1821 | fpr=0.8364 | 8153.4 samples/s | 31.8 steps/s
[Step= 500] | Loss=5.27251 | acc=0.1638 | tpr=0.1868 | fpr=0.8366 | 7512.3 samples/s | 29.3 steps/s
[Step= 550] | Loss=5.27062 | acc=0.1639 | tpr=0.1830 | fpr=0.8365 | 10360.6 samples/s | 40.5 steps/s
Avg test loss: 5.27020, Avg test acc: 0.16382, Avg tpr: 0.18304, Avg fpr: 0.83653, total FA: 116151

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.29340 | acc=0.1389 | tpr=0.1903 | fpr=0.8620 | 5365.6 samples/s | 21.0 steps/s
[Step= 100] | Loss=5.24072 | acc=0.1427 | tpr=0.1791 | fpr=0.8580 | 8373.7 samples/s | 32.7 steps/s
[Step= 150] | Loss=5.25484 | acc=0.1405 | tpr=0.1744 | fpr=0.8601 | 8134.8 samples/s | 31.8 steps/s
[Step= 200] | Loss=5.24976 | acc=0.1403 | tpr=0.1694 | fpr=0.8602 | 8346.5 samples/s | 32.6 steps/s
[Step= 250] | Loss=5.25471 | acc=0.1405 | tpr=0.1694 | fpr=0.8601 | 7950.6 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.25814 | acc=0.1402 | tpr=0.1724 | fpr=0.8603 | 8258.1 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.25934 | acc=0.1399 | tpr=0.1609 | fpr=0.8605 | 7646.9 samples/s | 29.9 steps/s
[Step= 400] | Loss=5.25773 | acc=0.1405 | tpr=0.1668 | fpr=0.8600 | 8237.2 samples/s | 32.2 steps/s
[Step= 450] | Loss=5.25767 | acc=0.1406 | tpr=0.1655 | fpr=0.8599 | 8407.9 samples/s | 32.8 steps/s
[Step= 500] | Loss=5.25987 | acc=0.1405 | tpr=0.1661 | fpr=0.8600 | 8470.3 samples/s | 33.1 steps/s
[Step= 550] | Loss=5.25770 | acc=0.1407 | tpr=0.1651 | fpr=0.8597 | 9384.6 samples/s | 36.7 steps/s
Avg test loss: 5.25822, Avg test acc: 0.14063, Avg tpr: 0.16561, Avg fpr: 0.85983, total FA: 119385

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.20620 | acc=0.1331 | tpr=0.1150 | fpr=0.8666 | 5722.0 samples/s | 22.4 steps/s
[Step= 100] | Loss=6.15168 | acc=0.1329 | tpr=0.1151 | fpr=0.8667 | 7392.9 samples/s | 28.9 steps/s
[Step= 150] | Loss=6.15899 | acc=0.1317 | tpr=0.1124 | fpr=0.8679 | 7634.8 samples/s | 29.8 steps/s
[Step= 200] | Loss=6.15093 | acc=0.1323 | tpr=0.1126 | fpr=0.8673 | 8800.7 samples/s | 34.4 steps/s
[Step= 250] | Loss=6.15251 | acc=0.1325 | tpr=0.1118 | fpr=0.8671 | 8170.8 samples/s | 31.9 steps/s
[Step= 300] | Loss=6.15822 | acc=0.1324 | tpr=0.1156 | fpr=0.8673 | 7645.1 samples/s | 29.9 steps/s
[Step= 350] | Loss=6.16200 | acc=0.1319 | tpr=0.1096 | fpr=0.8677 | 8319.2 samples/s | 32.5 steps/s
[Step= 400] | Loss=6.15907 | acc=0.1323 | tpr=0.1171 | fpr=0.8674 | 8301.5 samples/s | 32.4 steps/s
[Step= 450] | Loss=6.15783 | acc=0.1324 | tpr=0.1159 | fpr=0.8673 | 8307.3 samples/s | 32.5 steps/s
[Step= 500] | Loss=6.15937 | acc=0.1323 | tpr=0.1167 | fpr=0.8674 | 7765.3 samples/s | 30.3 steps/s
[Step= 550] | Loss=6.15548 | acc=0.1324 | tpr=0.1150 | fpr=0.8673 | 10595.0 samples/s | 41.4 steps/s
Avg test loss: 6.15548, Avg test acc: 0.13231, Avg tpr: 0.11529, Avg fpr: 0.86738, total FA: 120434

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.35518 | acc=0.1580 | tpr=0.1681 | fpr=0.8421 | 5649.0 samples/s | 22.1 steps/s
[Step= 100] | Loss=5.30457 | acc=0.1588 | tpr=0.1620 | fpr=0.8412 | 7912.0 samples/s | 30.9 steps/s
[Step= 150] | Loss=5.31417 | acc=0.1587 | tpr=0.1527 | fpr=0.8412 | 8503.4 samples/s | 33.2 steps/s
[Step= 200] | Loss=5.30460 | acc=0.1582 | tpr=0.1530 | fpr=0.8417 | 7276.5 samples/s | 28.4 steps/s
[Step= 250] | Loss=5.30945 | acc=0.1581 | tpr=0.1476 | fpr=0.8417 | 8622.4 samples/s | 33.7 steps/s
[Step= 300] | Loss=5.31444 | acc=0.1575 | tpr=0.1535 | fpr=0.8425 | 8580.6 samples/s | 33.5 steps/s
[Step= 350] | Loss=5.31445 | acc=0.1576 | tpr=0.1446 | fpr=0.8421 | 7983.2 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.31261 | acc=0.1583 | tpr=0.1488 | fpr=0.8416 | 8262.7 samples/s | 32.3 steps/s
[Step= 450] | Loss=5.31203 | acc=0.1588 | tpr=0.1490 | fpr=0.8411 | 7842.8 samples/s | 30.6 steps/s
[Step= 500] | Loss=5.31514 | acc=0.1586 | tpr=0.1498 | fpr=0.8413 | 7991.0 samples/s | 31.2 steps/s
[Step= 550] | Loss=5.31315 | acc=0.1587 | tpr=0.1496 | fpr=0.8412 | 9925.8 samples/s | 38.8 steps/s
Avg test loss: 5.31281, Avg test acc: 0.15857, Avg tpr: 0.14976, Avg fpr: 0.84127, total FA: 116808

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.14500 | acc=0.1406 | tpr=0.1372 | fpr=0.8593 | 5747.6 samples/s | 22.5 steps/s
[Step= 100] | Loss=6.08452 | acc=0.1425 | tpr=0.1194 | fpr=0.8570 | 7488.0 samples/s | 29.2 steps/s
[Step= 150] | Loss=6.09995 | acc=0.1425 | tpr=0.1124 | fpr=0.8569 | 8597.3 samples/s | 33.6 steps/s
[Step= 200] | Loss=6.09662 | acc=0.1430 | tpr=0.1104 | fpr=0.8564 | 8535.3 samples/s | 33.3 steps/s
[Step= 250] | Loss=6.10307 | acc=0.1430 | tpr=0.1127 | fpr=0.8564 | 7712.7 samples/s | 30.1 steps/s
[Step= 300] | Loss=6.10825 | acc=0.1427 | tpr=0.1127 | fpr=0.8567 | 8189.2 samples/s | 32.0 steps/s
[Step= 350] | Loss=6.10938 | acc=0.1424 | tpr=0.1090 | fpr=0.8570 | 7693.8 samples/s | 30.1 steps/s
[Step= 400] | Loss=6.10723 | acc=0.1428 | tpr=0.1143 | fpr=0.8566 | 8119.9 samples/s | 31.7 steps/s
[Step= 450] | Loss=6.10691 | acc=0.1433 | tpr=0.1154 | fpr=0.8562 | 8312.1 samples/s | 32.5 steps/s
[Step= 500] | Loss=6.10976 | acc=0.1431 | tpr=0.1159 | fpr=0.8564 | 8390.0 samples/s | 32.8 steps/s
[Step= 550] | Loss=6.10677 | acc=0.1432 | tpr=0.1146 | fpr=0.8562 | 9392.2 samples/s | 36.7 steps/s
Avg test loss: 6.10647, Avg test acc: 0.14313, Avg tpr: 0.11490, Avg fpr: 0.85636, total FA: 118904

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10129 | acc=0.9813 | tpr=0.9292 | fpr=0.0177 | 5434.0 samples/s | 21.2 steps/s
[Step= 100] | Loss=0.10203 | acc=0.9815 | tpr=0.9446 | fpr=0.0178 | 8314.8 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.10499 | acc=0.9810 | tpr=0.9496 | fpr=0.0185 | 8460.0 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.10737 | acc=0.9808 | tpr=0.9519 | fpr=0.0187 | 7550.5 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.10803 | acc=0.9806 | tpr=0.9467 | fpr=0.0188 | 8158.3 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.10916 | acc=0.9805 | tpr=0.9447 | fpr=0.0189 | 7720.4 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.10935 | acc=0.9805 | tpr=0.9468 | fpr=0.0189 | 8444.7 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.11058 | acc=0.9802 | tpr=0.9420 | fpr=0.0191 | 7766.5 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.11280 | acc=0.9799 | tpr=0.9396 | fpr=0.0194 | 8381.1 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.11189 | acc=0.9800 | tpr=0.9427 | fpr=0.0193 | 8439.7 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.11101 | acc=0.9801 | tpr=0.9427 | fpr=0.0192 | 10423.5 samples/s | 40.7 steps/s
Avg test loss: 0.11078, Avg test acc: 0.98016, Avg tpr: 0.94255, Avg fpr: 0.01916, total FA: 2660

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09553 | acc=0.9824 | tpr=0.8938 | fpr=0.0160 | 5861.7 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.09776 | acc=0.9826 | tpr=0.9041 | fpr=0.0160 | 7917.8 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.10018 | acc=0.9824 | tpr=0.9135 | fpr=0.0163 | 7491.9 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.10122 | acc=0.9824 | tpr=0.9202 | fpr=0.0165 | 7903.7 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.10118 | acc=0.9824 | tpr=0.9188 | fpr=0.0164 | 8007.4 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.10260 | acc=0.9823 | tpr=0.9193 | fpr=0.0166 | 8056.5 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.10271 | acc=0.9822 | tpr=0.9198 | fpr=0.0167 | 8363.1 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.10351 | acc=0.9821 | tpr=0.9158 | fpr=0.0167 | 8060.4 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.10548 | acc=0.9818 | tpr=0.9133 | fpr=0.0169 | 7914.0 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.10461 | acc=0.9819 | tpr=0.9154 | fpr=0.0169 | 8260.8 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.10392 | acc=0.9819 | tpr=0.9148 | fpr=0.0169 | 10349.3 samples/s | 40.4 steps/s
Avg test loss: 0.10374, Avg test acc: 0.98194, Avg tpr: 0.91442, Avg fpr: 0.01683, total FA: 2337

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11522 | acc=0.9781 | tpr=0.9381 | fpr=0.0212 | 5991.3 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.11659 | acc=0.9779 | tpr=0.9552 | fpr=0.0216 | 7573.5 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.12056 | acc=0.9776 | tpr=0.9568 | fpr=0.0221 | 7892.6 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.12222 | acc=0.9775 | tpr=0.9607 | fpr=0.0222 | 7808.1 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.12314 | acc=0.9774 | tpr=0.9581 | fpr=0.0222 | 7907.1 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.12411 | acc=0.9774 | tpr=0.9564 | fpr=0.0222 | 8352.6 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.12419 | acc=0.9774 | tpr=0.9587 | fpr=0.0222 | 7653.9 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.12509 | acc=0.9772 | tpr=0.9568 | fpr=0.0224 | 8212.3 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.12739 | acc=0.9768 | tpr=0.9547 | fpr=0.0228 | 7984.1 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.12641 | acc=0.9769 | tpr=0.9559 | fpr=0.0227 | 8487.4 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.12546 | acc=0.9772 | tpr=0.9550 | fpr=0.0224 | 10400.6 samples/s | 40.6 steps/s
Avg test loss: 0.12521, Avg test acc: 0.97717, Avg tpr: 0.95483, Avg fpr: 0.02242, total FA: 3113

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09860 | acc=0.9818 | tpr=0.9292 | fpr=0.0173 | 5693.0 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.10136 | acc=0.9809 | tpr=0.9275 | fpr=0.0181 | 7606.2 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.10340 | acc=0.9809 | tpr=0.9337 | fpr=0.0182 | 8343.1 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.10477 | acc=0.9809 | tpr=0.9388 | fpr=0.0183 | 8630.1 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.10533 | acc=0.9809 | tpr=0.9328 | fpr=0.0182 | 7597.3 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.10655 | acc=0.9809 | tpr=0.9309 | fpr=0.0182 | 7963.0 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.10640 | acc=0.9809 | tpr=0.9343 | fpr=0.0182 | 8034.6 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.10736 | acc=0.9808 | tpr=0.9300 | fpr=0.0183 | 8364.6 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.10937 | acc=0.9806 | tpr=0.9299 | fpr=0.0185 | 7992.5 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.10831 | acc=0.9807 | tpr=0.9335 | fpr=0.0184 | 8320.1 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.10772 | acc=0.9808 | tpr=0.9327 | fpr=0.0183 | 9774.0 samples/s | 38.2 steps/s
Avg test loss: 0.10753, Avg test acc: 0.98083, Avg tpr: 0.93265, Avg fpr: 0.01829, total FA: 2540

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10288 | acc=0.9808 | tpr=0.9159 | fpr=0.0181 | 5428.9 samples/s | 21.2 steps/s
[Step= 100] | Loss=0.10558 | acc=0.9807 | tpr=0.9360 | fpr=0.0184 | 8422.0 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.10843 | acc=0.9804 | tpr=0.9424 | fpr=0.0189 | 8043.0 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.10978 | acc=0.9804 | tpr=0.9475 | fpr=0.0190 | 8273.4 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.11085 | acc=0.9803 | tpr=0.9450 | fpr=0.0191 | 8016.9 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.11204 | acc=0.9803 | tpr=0.9425 | fpr=0.0190 | 8475.0 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.11176 | acc=0.9803 | tpr=0.9455 | fpr=0.0191 | 7647.3 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.11267 | acc=0.9802 | tpr=0.9409 | fpr=0.0191 | 8152.3 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.11460 | acc=0.9799 | tpr=0.9396 | fpr=0.0193 | 7664.3 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.11376 | acc=0.9800 | tpr=0.9410 | fpr=0.0193 | 8382.0 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.11292 | acc=0.9802 | tpr=0.9395 | fpr=0.0191 | 9980.2 samples/s | 39.0 steps/s
Avg test loss: 0.11275, Avg test acc: 0.98017, Avg tpr: 0.93938, Avg fpr: 0.01909, total FA: 2651

server round 32/50

clients selected: [1 2 3 4 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=44001 Epoch=214.7] | Loss=0.00616 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.378 | L2-Norm(final)=15.438 | 5752.7 samples/s | 89.9 steps/s
[Step=44050 Epoch=214.9] | Loss=0.01394 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=15.439 | 5010.0 samples/s | 78.3 steps/s
[Step=44100 Epoch=215.2] | Loss=0.01665 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.379 | L2-Norm(final)=15.440 | 5675.3 samples/s | 88.7 steps/s
[Step=44150 Epoch=215.4] | Loss=0.01674 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.379 | L2-Norm(final)=15.440 | 5564.5 samples/s | 86.9 steps/s
[Step=44200 Epoch=215.7] | Loss=0.01731 | Reg=0.00108 | acc=0.9531 | L2-Norm=10.379 | L2-Norm(final)=15.439 | 8875.3 samples/s | 138.7 steps/s
[Step=44250 Epoch=215.9] | Loss=0.01750 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.379 | L2-Norm(final)=15.438 | 2408.3 samples/s | 37.6 steps/s
[Step=44300 Epoch=216.2] | Loss=0.01686 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=15.437 | 5668.5 samples/s | 88.6 steps/s
[Step=44350 Epoch=216.4] | Loss=0.01719 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.379 | L2-Norm(final)=15.437 | 5706.6 samples/s | 89.2 steps/s
[Step=44400 Epoch=216.7] | Loss=0.01743 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=15.436 | 7700.6 samples/s | 120.3 steps/s
[Step=44450 Epoch=216.9] | Loss=0.01729 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=15.435 | 2491.0 samples/s | 38.9 steps/s
[Step=44500 Epoch=217.1] | Loss=0.01747 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.379 | L2-Norm(final)=15.435 | 5627.8 samples/s | 87.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=44501 Epoch=217.1] | Loss=0.00431 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=15.429 | 6096.2 samples/s | 95.3 steps/s
[Step=44550 Epoch=217.4] | Loss=0.02060 | Reg=0.00108 | acc=0.9531 | L2-Norm=10.389 | L2-Norm(final)=15.427 | 4247.1 samples/s | 66.4 steps/s
[Step=44600 Epoch=217.6] | Loss=0.01752 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.400 | L2-Norm(final)=15.426 | 4841.1 samples/s | 75.6 steps/s
[Step=44650 Epoch=217.9] | Loss=0.01725 | Reg=0.00108 | acc=0.9531 | L2-Norm=10.410 | L2-Norm(final)=15.426 | 4899.1 samples/s | 76.5 steps/s
[Step=44700 Epoch=218.1] | Loss=0.01611 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.418 | L2-Norm(final)=15.427 | 6905.9 samples/s | 107.9 steps/s
[Step=44750 Epoch=218.4] | Loss=0.01420 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.426 | L2-Norm(final)=15.428 | 2261.5 samples/s | 35.3 steps/s
[Step=44800 Epoch=218.6] | Loss=0.01265 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.433 | L2-Norm(final)=15.430 | 4901.6 samples/s | 76.6 steps/s
[Step=44850 Epoch=218.8] | Loss=0.01161 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.438 | L2-Norm(final)=15.433 | 4793.2 samples/s | 74.9 steps/s
[Step=44900 Epoch=219.1] | Loss=0.01064 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.443 | L2-Norm(final)=15.435 | 6496.7 samples/s | 101.5 steps/s
[Step=44950 Epoch=219.3] | Loss=0.00993 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.447 | L2-Norm(final)=15.437 | 2332.0 samples/s | 36.4 steps/s
[Step=45000 Epoch=219.6] | Loss=0.00934 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.450 | L2-Norm(final)=15.439 | 4895.1 samples/s | 76.5 steps/s
[Step=45050 Epoch=219.8] | Loss=0.00875 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.454 | L2-Norm(final)=15.441 | 4850.6 samples/s | 75.8 steps/s
[Step=45100 Epoch=220.1] | Loss=0.00841 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.457 | L2-Norm(final)=15.443 | 6000.5 samples/s | 93.8 steps/s
[Step=45150 Epoch=220.3] | Loss=0.00803 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.459 | L2-Norm(final)=15.445 | 2366.8 samples/s | 37.0 steps/s
[Step=45200 Epoch=220.6] | Loss=0.00770 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.462 | L2-Norm(final)=15.447 | 4854.6 samples/s | 75.9 steps/s
[Step=45250 Epoch=220.8] | Loss=0.00739 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.464 | L2-Norm(final)=15.449 | 4801.5 samples/s | 75.0 steps/s
[Step=45300 Epoch=221.0] | Loss=0.00719 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.466 | L2-Norm(final)=15.451 | 5608.5 samples/s | 87.6 steps/s
[Step=45350 Epoch=221.3] | Loss=0.00694 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.469 | L2-Norm(final)=15.452 | 2449.3 samples/s | 38.3 steps/s
[Step=45400 Epoch=221.5] | Loss=0.00675 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.470 | L2-Norm(final)=15.454 | 4813.6 samples/s | 75.2 steps/s
[Step=45450 Epoch=221.8] | Loss=0.00657 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=15.456 | 4884.7 samples/s | 76.3 steps/s
[Step=45500 Epoch=222.0] | Loss=0.00634 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.474 | L2-Norm(final)=15.457 | 5082.9 samples/s | 79.4 steps/s
[Step=45550 Epoch=222.3] | Loss=0.00620 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.476 | L2-Norm(final)=15.459 | 2502.4 samples/s | 39.1 steps/s
[Step=45600 Epoch=222.5] | Loss=0.00603 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.478 | L2-Norm(final)=15.460 | 4742.0 samples/s | 74.1 steps/s
[Step=45650 Epoch=222.8] | Loss=0.00591 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=15.462 | 4838.1 samples/s | 75.6 steps/s
[Step=45700 Epoch=223.0] | Loss=0.00577 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.481 | L2-Norm(final)=15.463 | 4967.2 samples/s | 77.6 steps/s
[Step=45750 Epoch=223.2] | Loss=0.00563 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=15.465 | 2624.1 samples/s | 41.0 steps/s
[Step=45800 Epoch=223.5] | Loss=0.00552 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.484 | L2-Norm(final)=15.466 | 4766.4 samples/s | 74.5 steps/s
[Step=45850 Epoch=223.7] | Loss=0.00544 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.485 | L2-Norm(final)=15.468 | 4880.6 samples/s | 76.3 steps/s
[Step=45900 Epoch=224.0] | Loss=0.00535 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.486 | L2-Norm(final)=15.469 | 4830.0 samples/s | 75.5 steps/s
[Step=45950 Epoch=224.2] | Loss=0.00521 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.488 | L2-Norm(final)=15.471 | 2632.0 samples/s | 41.1 steps/s
[Step=46000 Epoch=224.5] | Loss=0.00512 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.489 | L2-Norm(final)=15.472 | 4944.9 samples/s | 77.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step46000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=155.9] | Loss=0.00157 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.378 | L2-Norm(final)=14.204 | 5596.2 samples/s | 87.4 steps/s
[Step=32050 Epoch=156.2] | Loss=0.01745 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=14.204 | 5121.2 samples/s | 80.0 steps/s
[Step=32100 Epoch=156.4] | Loss=0.01782 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.379 | L2-Norm(final)=14.202 | 5682.3 samples/s | 88.8 steps/s
[Step=32150 Epoch=156.7] | Loss=0.01933 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.379 | L2-Norm(final)=14.201 | 5481.2 samples/s | 85.6 steps/s
[Step=32200 Epoch=156.9] | Loss=0.01844 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.379 | L2-Norm(final)=14.199 | 8647.9 samples/s | 135.1 steps/s
[Step=32250 Epoch=157.1] | Loss=0.01851 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.379 | L2-Norm(final)=14.199 | 2432.5 samples/s | 38.0 steps/s
[Step=32300 Epoch=157.4] | Loss=0.01815 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.379 | L2-Norm(final)=14.198 | 5647.8 samples/s | 88.2 steps/s
[Step=32350 Epoch=157.6] | Loss=0.01809 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.379 | L2-Norm(final)=14.197 | 5638.8 samples/s | 88.1 steps/s
[Step=32400 Epoch=157.9] | Loss=0.01813 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.379 | L2-Norm(final)=14.197 | 7625.0 samples/s | 119.1 steps/s
[Step=32450 Epoch=158.1] | Loss=0.01853 | Reg=0.00108 | acc=0.9531 | L2-Norm=10.379 | L2-Norm(final)=14.197 | 2488.7 samples/s | 38.9 steps/s
[Step=32500 Epoch=158.4] | Loss=0.01851 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=14.196 | 5688.6 samples/s | 88.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=158.4] | Loss=0.01201 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.379 | L2-Norm(final)=14.189 | 5698.2 samples/s | 89.0 steps/s
[Step=32550 Epoch=158.6] | Loss=0.02107 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.394 | L2-Norm(final)=14.189 | 4446.3 samples/s | 69.5 steps/s
[Step=32600 Epoch=158.8] | Loss=0.01879 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.407 | L2-Norm(final)=14.188 | 4820.9 samples/s | 75.3 steps/s
[Step=32650 Epoch=159.1] | Loss=0.01819 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.418 | L2-Norm(final)=14.189 | 4892.8 samples/s | 76.5 steps/s
[Step=32700 Epoch=159.3] | Loss=0.01601 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.427 | L2-Norm(final)=14.190 | 6820.3 samples/s | 106.6 steps/s
[Step=32750 Epoch=159.6] | Loss=0.01435 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.436 | L2-Norm(final)=14.192 | 2267.6 samples/s | 35.4 steps/s
[Step=32800 Epoch=159.8] | Loss=0.01271 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.443 | L2-Norm(final)=14.194 | 4901.5 samples/s | 76.6 steps/s
[Step=32850 Epoch=160.1] | Loss=0.01162 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.449 | L2-Norm(final)=14.197 | 4939.0 samples/s | 77.2 steps/s
[Step=32900 Epoch=160.3] | Loss=0.01112 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.455 | L2-Norm(final)=14.199 | 6180.1 samples/s | 96.6 steps/s
[Step=32950 Epoch=160.5] | Loss=0.01033 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.460 | L2-Norm(final)=14.202 | 2356.2 samples/s | 36.8 steps/s
[Step=33000 Epoch=160.8] | Loss=0.00961 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.464 | L2-Norm(final)=14.205 | 4890.6 samples/s | 76.4 steps/s
[Step=33050 Epoch=161.0] | Loss=0.00933 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.468 | L2-Norm(final)=14.207 | 4753.5 samples/s | 74.3 steps/s
[Step=33100 Epoch=161.3] | Loss=0.00883 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=14.209 | 5676.4 samples/s | 88.7 steps/s
[Step=33150 Epoch=161.5] | Loss=0.00835 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.476 | L2-Norm(final)=14.212 | 2363.3 samples/s | 36.9 steps/s
[Step=33200 Epoch=161.8] | Loss=0.00790 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=14.214 | 4787.4 samples/s | 74.8 steps/s
[Step=33250 Epoch=162.0] | Loss=0.00775 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.483 | L2-Norm(final)=14.217 | 4917.4 samples/s | 76.8 steps/s
[Step=33300 Epoch=162.3] | Loss=0.00750 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.486 | L2-Norm(final)=14.219 | 5296.5 samples/s | 82.8 steps/s
[Step=33350 Epoch=162.5] | Loss=0.00725 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.489 | L2-Norm(final)=14.221 | 2510.4 samples/s | 39.2 steps/s
[Step=33400 Epoch=162.7] | Loss=0.00700 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.492 | L2-Norm(final)=14.223 | 4852.4 samples/s | 75.8 steps/s
[Step=33450 Epoch=163.0] | Loss=0.00680 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=14.225 | 4930.9 samples/s | 77.0 steps/s
[Step=33500 Epoch=163.2] | Loss=0.00665 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.498 | L2-Norm(final)=14.227 | 4953.7 samples/s | 77.4 steps/s
[Step=33550 Epoch=163.5] | Loss=0.00650 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.500 | L2-Norm(final)=14.229 | 2592.0 samples/s | 40.5 steps/s
[Step=33600 Epoch=163.7] | Loss=0.00631 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.503 | L2-Norm(final)=14.231 | 4912.9 samples/s | 76.8 steps/s
[Step=33650 Epoch=164.0] | Loss=0.00621 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.505 | L2-Norm(final)=14.233 | 4806.6 samples/s | 75.1 steps/s
[Step=33700 Epoch=164.2] | Loss=0.00607 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.508 | L2-Norm(final)=14.235 | 4930.9 samples/s | 77.0 steps/s
[Step=33750 Epoch=164.4] | Loss=0.00591 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.510 | L2-Norm(final)=14.237 | 2640.9 samples/s | 41.3 steps/s
[Step=33800 Epoch=164.7] | Loss=0.00574 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.512 | L2-Norm(final)=14.239 | 4906.3 samples/s | 76.7 steps/s
[Step=33850 Epoch=164.9] | Loss=0.00566 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.514 | L2-Norm(final)=14.241 | 4820.5 samples/s | 75.3 steps/s
[Step=33900 Epoch=165.2] | Loss=0.00556 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.516 | L2-Norm(final)=14.243 | 4914.5 samples/s | 76.8 steps/s
[Step=33950 Epoch=165.4] | Loss=0.00547 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.519 | L2-Norm(final)=14.244 | 2650.8 samples/s | 41.4 steps/s
[Step=34000 Epoch=165.7] | Loss=0.00540 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.521 | L2-Norm(final)=14.246 | 4843.4 samples/s | 75.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step34000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=36001 Epoch=175.6] | Loss=0.00572 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.378 | L2-Norm(final)=14.850 | 5953.8 samples/s | 93.0 steps/s
[Step=36050 Epoch=175.8] | Loss=0.01942 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.379 | L2-Norm(final)=14.850 | 4792.8 samples/s | 74.9 steps/s
[Step=36100 Epoch=176.0] | Loss=0.01908 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.379 | L2-Norm(final)=14.849 | 5626.9 samples/s | 87.9 steps/s
[Step=36150 Epoch=176.3] | Loss=0.01853 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=14.849 | 5622.9 samples/s | 87.9 steps/s
[Step=36200 Epoch=176.5] | Loss=0.01770 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.379 | L2-Norm(final)=14.848 | 8833.6 samples/s | 138.0 steps/s
[Step=36250 Epoch=176.8] | Loss=0.01768 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=14.849 | 2439.0 samples/s | 38.1 steps/s
[Step=36300 Epoch=177.0] | Loss=0.01814 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=14.849 | 5651.8 samples/s | 88.3 steps/s
[Step=36350 Epoch=177.3] | Loss=0.01750 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=14.849 | 5655.1 samples/s | 88.4 steps/s
[Step=36400 Epoch=177.5] | Loss=0.01728 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=14.849 | 7747.2 samples/s | 121.1 steps/s
[Step=36450 Epoch=177.8] | Loss=0.01756 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.379 | L2-Norm(final)=14.850 | 2510.5 samples/s | 39.2 steps/s
[Step=36500 Epoch=178.0] | Loss=0.01720 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.379 | L2-Norm(final)=14.850 | 5610.3 samples/s | 87.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=178.0] | Loss=0.00613 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=14.857 | 5834.7 samples/s | 91.2 steps/s
[Step=36550 Epoch=178.2] | Loss=0.01532 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.392 | L2-Norm(final)=14.858 | 4396.4 samples/s | 68.7 steps/s
[Step=36600 Epoch=178.5] | Loss=0.01793 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=14.855 | 4832.0 samples/s | 75.5 steps/s
[Step=36650 Epoch=178.7] | Loss=0.01623 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.417 | L2-Norm(final)=14.855 | 4889.2 samples/s | 76.4 steps/s
[Step=36700 Epoch=179.0] | Loss=0.01472 | Reg=0.00109 | acc=0.9688 | L2-Norm=10.426 | L2-Norm(final)=14.856 | 6929.1 samples/s | 108.3 steps/s
[Step=36750 Epoch=179.2] | Loss=0.01346 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.434 | L2-Norm(final)=14.857 | 2251.8 samples/s | 35.2 steps/s
[Step=36800 Epoch=179.5] | Loss=0.01216 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.441 | L2-Norm(final)=14.859 | 4905.7 samples/s | 76.7 steps/s
[Step=36850 Epoch=179.7] | Loss=0.01147 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.447 | L2-Norm(final)=14.861 | 4789.9 samples/s | 74.8 steps/s
[Step=36900 Epoch=179.9] | Loss=0.01058 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.452 | L2-Norm(final)=14.863 | 6360.2 samples/s | 99.4 steps/s
[Step=36950 Epoch=180.2] | Loss=0.00987 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.457 | L2-Norm(final)=14.865 | 2338.2 samples/s | 36.5 steps/s
[Step=37000 Epoch=180.4] | Loss=0.00922 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.461 | L2-Norm(final)=14.867 | 4833.7 samples/s | 75.5 steps/s
[Step=37050 Epoch=180.7] | Loss=0.00873 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.465 | L2-Norm(final)=14.869 | 4837.8 samples/s | 75.6 steps/s
[Step=37100 Epoch=180.9] | Loss=0.00836 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.468 | L2-Norm(final)=14.871 | 5840.6 samples/s | 91.3 steps/s
[Step=37150 Epoch=181.2] | Loss=0.00800 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.471 | L2-Norm(final)=14.873 | 2436.6 samples/s | 38.1 steps/s
[Step=37200 Epoch=181.4] | Loss=0.00753 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.474 | L2-Norm(final)=14.875 | 4848.6 samples/s | 75.8 steps/s
[Step=37250 Epoch=181.7] | Loss=0.00732 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.477 | L2-Norm(final)=14.877 | 4834.4 samples/s | 75.5 steps/s
[Step=37300 Epoch=181.9] | Loss=0.00703 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.480 | L2-Norm(final)=14.879 | 5401.8 samples/s | 84.4 steps/s
[Step=37350 Epoch=182.1] | Loss=0.00680 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=14.881 | 2493.2 samples/s | 39.0 steps/s
[Step=37400 Epoch=182.4] | Loss=0.00658 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.485 | L2-Norm(final)=14.883 | 4882.4 samples/s | 76.3 steps/s
[Step=37450 Epoch=182.6] | Loss=0.00641 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=14.884 | 4829.2 samples/s | 75.5 steps/s
[Step=37500 Epoch=182.9] | Loss=0.00624 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.489 | L2-Norm(final)=14.886 | 5013.8 samples/s | 78.3 steps/s
[Step=37550 Epoch=183.1] | Loss=0.00611 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.491 | L2-Norm(final)=14.888 | 2624.7 samples/s | 41.0 steps/s
[Step=37600 Epoch=183.4] | Loss=0.00593 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.493 | L2-Norm(final)=14.889 | 4865.1 samples/s | 76.0 steps/s
[Step=37650 Epoch=183.6] | Loss=0.00584 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=14.891 | 4850.0 samples/s | 75.8 steps/s
[Step=37700 Epoch=183.8] | Loss=0.00569 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=14.893 | 4858.4 samples/s | 75.9 steps/s
[Step=37750 Epoch=184.1] | Loss=0.00554 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.499 | L2-Norm(final)=14.894 | 2638.7 samples/s | 41.2 steps/s
[Step=37800 Epoch=184.3] | Loss=0.00542 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.501 | L2-Norm(final)=14.896 | 4841.1 samples/s | 75.6 steps/s
[Step=37850 Epoch=184.6] | Loss=0.00531 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.503 | L2-Norm(final)=14.897 | 4885.1 samples/s | 76.3 steps/s
[Step=37900 Epoch=184.8] | Loss=0.00520 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.504 | L2-Norm(final)=14.899 | 4826.9 samples/s | 75.4 steps/s
[Step=37950 Epoch=185.1] | Loss=0.00513 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.506 | L2-Norm(final)=14.900 | 2645.7 samples/s | 41.3 steps/s
[Step=38000 Epoch=185.3] | Loss=0.00503 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.508 | L2-Norm(final)=14.902 | 4842.0 samples/s | 75.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step38000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=42001 Epoch=206.0] | Loss=0.00261 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.378 | L2-Norm(final)=15.388 | 5644.5 samples/s | 88.2 steps/s
[Step=42050 Epoch=206.2] | Loss=0.01642 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=15.386 | 5112.3 samples/s | 79.9 steps/s
[Step=42100 Epoch=206.5] | Loss=0.01773 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.379 | L2-Norm(final)=15.387 | 5774.3 samples/s | 90.2 steps/s
[Step=42150 Epoch=206.7] | Loss=0.01702 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.379 | L2-Norm(final)=15.387 | 5506.8 samples/s | 86.0 steps/s
[Step=42200 Epoch=206.9] | Loss=0.01686 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.379 | L2-Norm(final)=15.389 | 9030.0 samples/s | 141.1 steps/s
[Step=42250 Epoch=207.2] | Loss=0.01709 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.379 | L2-Norm(final)=15.390 | 2415.9 samples/s | 37.7 steps/s
[Step=42300 Epoch=207.4] | Loss=0.01670 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.379 | L2-Norm(final)=15.392 | 5637.2 samples/s | 88.1 steps/s
[Step=42350 Epoch=207.7] | Loss=0.01668 | Reg=0.00108 | acc=0.9375 | L2-Norm=10.379 | L2-Norm(final)=15.394 | 5576.9 samples/s | 87.1 steps/s
[Step=42400 Epoch=207.9] | Loss=0.01703 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=15.395 | 8181.8 samples/s | 127.8 steps/s
[Step=42450 Epoch=208.2] | Loss=0.01661 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=15.397 | 2460.2 samples/s | 38.4 steps/s
[Step=42500 Epoch=208.4] | Loss=0.01674 | Reg=0.00108 | acc=0.9531 | L2-Norm=10.379 | L2-Norm(final)=15.398 | 5580.2 samples/s | 87.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=42501 Epoch=208.4] | Loss=0.00552 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=15.412 | 6313.3 samples/s | 98.6 steps/s
[Step=42550 Epoch=208.7] | Loss=0.01797 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.393 | L2-Norm(final)=15.413 | 4125.5 samples/s | 64.5 steps/s
[Step=42600 Epoch=208.9] | Loss=0.01849 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.409 | L2-Norm(final)=15.410 | 4887.6 samples/s | 76.4 steps/s
[Step=42650 Epoch=209.1] | Loss=0.01537 | Reg=0.00109 | acc=0.9688 | L2-Norm=10.422 | L2-Norm(final)=15.411 | 4841.3 samples/s | 75.6 steps/s
[Step=42700 Epoch=209.4] | Loss=0.01453 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.431 | L2-Norm(final)=15.413 | 7108.2 samples/s | 111.1 steps/s
[Step=42750 Epoch=209.6] | Loss=0.01305 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.439 | L2-Norm(final)=15.415 | 2290.9 samples/s | 35.8 steps/s
[Step=42800 Epoch=209.9] | Loss=0.01171 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.445 | L2-Norm(final)=15.418 | 4816.2 samples/s | 75.3 steps/s
[Step=42850 Epoch=210.1] | Loss=0.01065 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.450 | L2-Norm(final)=15.420 | 4763.2 samples/s | 74.4 steps/s
[Step=42900 Epoch=210.4] | Loss=0.00983 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.455 | L2-Norm(final)=15.423 | 6621.4 samples/s | 103.5 steps/s
[Step=42950 Epoch=210.6] | Loss=0.00908 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.459 | L2-Norm(final)=15.425 | 2320.0 samples/s | 36.2 steps/s
[Step=43000 Epoch=210.9] | Loss=0.00854 | Reg=0.00109 | acc=0.9688 | L2-Norm=10.464 | L2-Norm(final)=15.428 | 4820.0 samples/s | 75.3 steps/s
[Step=43050 Epoch=211.1] | Loss=0.00806 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.468 | L2-Norm(final)=15.430 | 4846.9 samples/s | 75.7 steps/s
[Step=43100 Epoch=211.4] | Loss=0.00789 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.471 | L2-Norm(final)=15.433 | 6277.1 samples/s | 98.1 steps/s
[Step=43150 Epoch=211.6] | Loss=0.00750 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.474 | L2-Norm(final)=15.435 | 2391.9 samples/s | 37.4 steps/s
[Step=43200 Epoch=211.8] | Loss=0.00717 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.478 | L2-Norm(final)=15.437 | 4781.7 samples/s | 74.7 steps/s
[Step=43250 Epoch=212.1] | Loss=0.00700 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.480 | L2-Norm(final)=15.439 | 4848.2 samples/s | 75.8 steps/s
[Step=43300 Epoch=212.3] | Loss=0.00676 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.483 | L2-Norm(final)=15.441 | 5915.4 samples/s | 92.4 steps/s
[Step=43350 Epoch=212.6] | Loss=0.00649 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.486 | L2-Norm(final)=15.443 | 2376.0 samples/s | 37.1 steps/s
[Step=43400 Epoch=212.8] | Loss=0.00629 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.488 | L2-Norm(final)=15.445 | 4816.7 samples/s | 75.3 steps/s
[Step=43450 Epoch=213.1] | Loss=0.00616 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.491 | L2-Norm(final)=15.447 | 4875.7 samples/s | 76.2 steps/s
[Step=43500 Epoch=213.3] | Loss=0.00596 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.493 | L2-Norm(final)=15.448 | 5602.7 samples/s | 87.5 steps/s
[Step=43550 Epoch=213.6] | Loss=0.00579 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.495 | L2-Norm(final)=15.450 | 2447.2 samples/s | 38.2 steps/s
[Step=43600 Epoch=213.8] | Loss=0.00563 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=15.452 | 4887.2 samples/s | 76.4 steps/s
[Step=43650 Epoch=214.1] | Loss=0.00551 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.499 | L2-Norm(final)=15.454 | 4826.9 samples/s | 75.4 steps/s
[Step=43700 Epoch=214.3] | Loss=0.00543 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.501 | L2-Norm(final)=15.455 | 5331.1 samples/s | 83.3 steps/s
[Step=43750 Epoch=214.5] | Loss=0.00532 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.503 | L2-Norm(final)=15.457 | 2529.0 samples/s | 39.5 steps/s
[Step=43800 Epoch=214.8] | Loss=0.00524 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.505 | L2-Norm(final)=15.458 | 4833.6 samples/s | 75.5 steps/s
[Step=43850 Epoch=215.0] | Loss=0.00515 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.507 | L2-Norm(final)=15.460 | 4832.9 samples/s | 75.5 steps/s
[Step=43900 Epoch=215.3] | Loss=0.00504 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.508 | L2-Norm(final)=15.462 | 5090.8 samples/s | 79.5 steps/s
[Step=43950 Epoch=215.5] | Loss=0.00495 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.510 | L2-Norm(final)=15.463 | 2589.6 samples/s | 40.5 steps/s
[Step=44000 Epoch=215.8] | Loss=0.00486 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.512 | L2-Norm(final)=15.465 | 4856.7 samples/s | 75.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step44000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=30001 Epoch=282.7] | Loss=0.00006 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.378 | L2-Norm(final)=15.512 | 5738.7 samples/s | 89.7 steps/s
[Step=30050 Epoch=283.2] | Loss=0.00055 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.377 | L2-Norm(final)=15.518 | 4607.7 samples/s | 72.0 steps/s
[Step=30100 Epoch=283.6] | Loss=0.00060 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.376 | L2-Norm(final)=15.527 | 8152.9 samples/s | 127.4 steps/s
[Step=30150 Epoch=284.1] | Loss=0.00061 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.376 | L2-Norm(final)=15.537 | 2330.1 samples/s | 36.4 steps/s
[Step=30200 Epoch=284.6] | Loss=0.00060 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.376 | L2-Norm(final)=15.545 | 7199.8 samples/s | 112.5 steps/s
[Step=30250 Epoch=285.0] | Loss=0.00060 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.376 | L2-Norm(final)=15.552 | 2437.8 samples/s | 38.1 steps/s
[Step=30300 Epoch=285.5] | Loss=0.00058 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.376 | L2-Norm(final)=15.561 | 6366.3 samples/s | 99.5 steps/s
[Step=30350 Epoch=286.0] | Loss=0.00058 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.376 | L2-Norm(final)=15.568 | 2590.8 samples/s | 40.5 steps/s
[Step=30400 Epoch=286.5] | Loss=0.00060 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.376 | L2-Norm(final)=15.575 | 5618.8 samples/s | 87.8 steps/s
[Step=30450 Epoch=286.9] | Loss=0.00058 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.376 | L2-Norm(final)=15.582 | 2719.8 samples/s | 42.5 steps/s
[Step=30500 Epoch=287.4] | Loss=0.00058 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.376 | L2-Norm(final)=15.589 | 5473.3 samples/s | 85.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=287.4] | Loss=0.00029 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.376 | L2-Norm(final)=15.660 | 5754.0 samples/s | 89.9 steps/s
[Step=30550 Epoch=287.9] | Loss=0.00064 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.395 | L2-Norm(final)=15.663 | 4269.3 samples/s | 66.7 steps/s
[Step=30600 Epoch=288.3] | Loss=0.00052 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=15.665 | 6545.0 samples/s | 102.3 steps/s
[Step=30650 Epoch=288.8] | Loss=0.00037 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.413 | L2-Norm(final)=15.667 | 2189.9 samples/s | 34.2 steps/s
[Step=30700 Epoch=289.3] | Loss=0.00028 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.415 | L2-Norm(final)=15.668 | 5944.4 samples/s | 92.9 steps/s
[Step=30750 Epoch=289.8] | Loss=0.00023 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.415 | L2-Norm(final)=15.669 | 2327.5 samples/s | 36.4 steps/s
[Step=30800 Epoch=290.2] | Loss=0.00019 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.414 | L2-Norm(final)=15.670 | 5193.5 samples/s | 81.1 steps/s
[Step=30850 Epoch=290.7] | Loss=0.00016 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.412 | L2-Norm(final)=15.671 | 2407.8 samples/s | 37.6 steps/s
[Step=30900 Epoch=291.2] | Loss=0.00014 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.409 | L2-Norm(final)=15.671 | 4904.1 samples/s | 76.6 steps/s
[Step=30950 Epoch=291.6] | Loss=0.00013 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=15.672 | 2515.3 samples/s | 39.3 steps/s
[Step=31000 Epoch=292.1] | Loss=0.00012 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.403 | L2-Norm(final)=15.672 | 4666.4 samples/s | 72.9 steps/s
[Step=31050 Epoch=292.6] | Loss=0.00011 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.400 | L2-Norm(final)=15.673 | 2545.2 samples/s | 39.8 steps/s
[Step=31100 Epoch=293.1] | Loss=0.00010 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=15.673 | 4622.4 samples/s | 72.2 steps/s
[Step=31150 Epoch=293.5] | Loss=0.00009 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.393 | L2-Norm(final)=15.674 | 2543.6 samples/s | 39.7 steps/s
[Step=31200 Epoch=294.0] | Loss=0.00008 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=15.674 | 4621.4 samples/s | 72.2 steps/s
[Step=31250 Epoch=294.5] | Loss=0.00008 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=15.674 | 2794.3 samples/s | 43.7 steps/s
[Step=31300 Epoch=294.9] | Loss=0.00007 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.381 | L2-Norm(final)=15.675 | 4118.4 samples/s | 64.3 steps/s
[Step=31350 Epoch=295.4] | Loss=0.00007 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.377 | L2-Norm(final)=15.675 | 6757.8 samples/s | 105.6 steps/s
[Step=31400 Epoch=295.9] | Loss=0.00007 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.373 | L2-Norm(final)=15.675 | 2211.1 samples/s | 34.5 steps/s
[Step=31450 Epoch=296.3] | Loss=0.00006 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.369 | L2-Norm(final)=15.676 | 5810.0 samples/s | 90.8 steps/s
[Step=31500 Epoch=296.8] | Loss=0.00006 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.365 | L2-Norm(final)=15.676 | 2284.1 samples/s | 35.7 steps/s
[Step=31550 Epoch=297.3] | Loss=0.00006 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.361 | L2-Norm(final)=15.676 | 5408.9 samples/s | 84.5 steps/s
[Step=31600 Epoch=297.8] | Loss=0.00005 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.357 | L2-Norm(final)=15.677 | 2375.1 samples/s | 37.1 steps/s
[Step=31650 Epoch=298.2] | Loss=0.00005 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.353 | L2-Norm(final)=15.677 | 4923.2 samples/s | 76.9 steps/s
[Step=31700 Epoch=298.7] | Loss=0.00005 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.348 | L2-Norm(final)=15.678 | 2477.2 samples/s | 38.7 steps/s
[Step=31750 Epoch=299.2] | Loss=0.00005 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.344 | L2-Norm(final)=15.678 | 4631.6 samples/s | 72.4 steps/s
[Step=31800 Epoch=299.6] | Loss=0.00005 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.340 | L2-Norm(final)=15.678 | 2566.8 samples/s | 40.1 steps/s
[Step=31850 Epoch=300.1] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.335 | L2-Norm(final)=15.679 | 4661.1 samples/s | 72.8 steps/s
[Step=31900 Epoch=300.6] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.331 | L2-Norm(final)=15.679 | 2587.6 samples/s | 40.4 steps/s
[Step=31950 Epoch=301.1] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.326 | L2-Norm(final)=15.680 | 4621.3 samples/s | 72.2 steps/s
[Step=32000 Epoch=301.5] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.322 | L2-Norm(final)=15.680 | 2721.7 samples/s | 42.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09373 | acc=0.9584 | tpr=0.9638 | fpr=0.0535 | 5597.4 samples/s | 21.9 steps/s
Avg test loss: 0.10039, Avg test acc: 0.95781, Avg tpr: 0.96334, Avg fpr: 0.05435, total FA: 424

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08757 | acc=0.9652 | tpr=0.9758 | fpr=0.0577 | 5698.2 samples/s | 22.3 steps/s
Avg test loss: 0.09537, Avg test acc: 0.96378, Avg tpr: 0.97389, Avg fpr: 0.05845, total FA: 456

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09395 | acc=0.9635 | tpr=0.9808 | fpr=0.0741 | 5496.8 samples/s | 21.5 steps/s
Avg test loss: 0.09939, Avg test acc: 0.96242, Avg tpr: 0.97843, Avg fpr: 0.07281, total FA: 568

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08728 | acc=0.9644 | tpr=0.9732 | fpr=0.0548 | 5477.7 samples/s | 21.4 steps/s
Avg test loss: 0.09642, Avg test acc: 0.96286, Avg tpr: 0.97266, Avg fpr: 0.05871, total FA: 458

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08493 | acc=0.9648 | tpr=0.9776 | fpr=0.0632 | 5531.6 samples/s | 21.6 steps/s
Avg test loss: 0.09413, Avg test acc: 0.96386, Avg tpr: 0.97651, Avg fpr: 0.06397, total FA: 499

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.38077 | acc=0.2558 | tpr=0.0060 | fpr=0.2019 | 5681.8 samples/s | 22.2 steps/s
Avg test loss: 5.38527, Avg test acc: 0.25479, Avg tpr: 0.00629, Avg fpr: 0.19869, total FA: 1550

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.60507 | acc=0.2891 | tpr=0.0080 | fpr=0.1003 | 5781.0 samples/s | 22.6 steps/s
Avg test loss: 4.61595, Avg test acc: 0.28596, Avg tpr: 0.00699, Avg fpr: 0.10050, total FA: 784

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.42073 | acc=0.2127 | tpr=0.0121 | fpr=0.3516 | 5745.0 samples/s | 22.4 steps/s
Avg test loss: 5.42363, Avg test acc: 0.21404, Avg tpr: 0.01311, Avg fpr: 0.34406, total FA: 2684

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.87869 | acc=0.2602 | tpr=0.0135 | fpr=0.2042 | 5644.0 samples/s | 22.0 steps/s
Avg test loss: 5.88269, Avg test acc: 0.25932, Avg tpr: 0.01352, Avg fpr: 0.20010, total FA: 1561

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.59919 | acc=0.2459 | tpr=0.0084 | fpr=0.2384 | 5656.6 samples/s | 22.1 steps/s
Avg test loss: 5.60686, Avg test acc: 0.24361, Avg tpr: 0.00839, Avg fpr: 0.23907, total FA: 1865

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.30941 | acc=0.1659 | tpr=0.2212 | fpr=0.8351 | 5741.4 samples/s | 22.4 steps/s
[Step= 100] | Loss=5.25531 | acc=0.1660 | tpr=0.1940 | fpr=0.8345 | 7790.3 samples/s | 30.4 steps/s
[Step= 150] | Loss=5.26535 | acc=0.1648 | tpr=0.1888 | fpr=0.8356 | 7705.2 samples/s | 30.1 steps/s
[Step= 200] | Loss=5.26213 | acc=0.1646 | tpr=0.1880 | fpr=0.8359 | 7928.5 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.26748 | acc=0.1643 | tpr=0.1939 | fpr=0.8362 | 8822.3 samples/s | 34.5 steps/s
[Step= 300] | Loss=5.26942 | acc=0.1636 | tpr=0.1942 | fpr=0.8369 | 8219.4 samples/s | 32.1 steps/s
[Step= 350] | Loss=5.27159 | acc=0.1635 | tpr=0.1841 | fpr=0.8369 | 7770.2 samples/s | 30.4 steps/s
[Step= 400] | Loss=5.26896 | acc=0.1639 | tpr=0.1849 | fpr=0.8365 | 7728.9 samples/s | 30.2 steps/s
[Step= 450] | Loss=5.26892 | acc=0.1639 | tpr=0.1821 | fpr=0.8364 | 8375.0 samples/s | 32.7 steps/s
[Step= 500] | Loss=5.27251 | acc=0.1638 | tpr=0.1868 | fpr=0.8366 | 8172.7 samples/s | 31.9 steps/s
[Step= 550] | Loss=5.27062 | acc=0.1639 | tpr=0.1830 | fpr=0.8365 | 10210.4 samples/s | 39.9 steps/s
Avg test loss: 5.27020, Avg test acc: 0.16382, Avg tpr: 0.18304, Avg fpr: 0.83653, total FA: 116151

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.06967 | acc=0.1476 | tpr=0.2168 | fpr=0.8537 | 5755.5 samples/s | 22.5 steps/s
[Step= 100] | Loss=5.02220 | acc=0.1504 | tpr=0.1898 | fpr=0.8504 | 7774.2 samples/s | 30.4 steps/s
[Step= 150] | Loss=5.03774 | acc=0.1479 | tpr=0.1873 | fpr=0.8528 | 8087.9 samples/s | 31.6 steps/s
[Step= 200] | Loss=5.03338 | acc=0.1479 | tpr=0.1814 | fpr=0.8528 | 7900.6 samples/s | 30.9 steps/s
[Step= 250] | Loss=5.03765 | acc=0.1476 | tpr=0.1755 | fpr=0.8529 | 7721.5 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.04043 | acc=0.1471 | tpr=0.1789 | fpr=0.8535 | 8271.4 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.04136 | acc=0.1469 | tpr=0.1666 | fpr=0.8534 | 8584.9 samples/s | 33.5 steps/s
[Step= 400] | Loss=5.03981 | acc=0.1477 | tpr=0.1718 | fpr=0.8527 | 8086.3 samples/s | 31.6 steps/s
[Step= 450] | Loss=5.03933 | acc=0.1479 | tpr=0.1714 | fpr=0.8526 | 7720.6 samples/s | 30.2 steps/s
[Step= 500] | Loss=5.04230 | acc=0.1475 | tpr=0.1718 | fpr=0.8530 | 8232.3 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.04088 | acc=0.1477 | tpr=0.1711 | fpr=0.8528 | 10727.2 samples/s | 41.9 steps/s
Avg test loss: 5.04107, Avg test acc: 0.14760, Avg tpr: 0.17155, Avg fpr: 0.85283, total FA: 118414

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.81668 | acc=0.1214 | tpr=0.1726 | fpr=0.8795 | 5684.5 samples/s | 22.2 steps/s
[Step= 100] | Loss=6.76197 | acc=0.1222 | tpr=0.1599 | fpr=0.8785 | 7830.9 samples/s | 30.6 steps/s
[Step= 150] | Loss=6.77235 | acc=0.1208 | tpr=0.1571 | fpr=0.8799 | 7770.3 samples/s | 30.4 steps/s
[Step= 200] | Loss=6.76413 | acc=0.1209 | tpr=0.1497 | fpr=0.8796 | 8216.6 samples/s | 32.1 steps/s
[Step= 250] | Loss=6.76758 | acc=0.1210 | tpr=0.1459 | fpr=0.8795 | 8039.3 samples/s | 31.4 steps/s
[Step= 300] | Loss=6.77470 | acc=0.1209 | tpr=0.1527 | fpr=0.8797 | 8140.1 samples/s | 31.8 steps/s
[Step= 350] | Loss=6.77941 | acc=0.1203 | tpr=0.1440 | fpr=0.8802 | 8097.8 samples/s | 31.6 steps/s
[Step= 400] | Loss=6.77740 | acc=0.1206 | tpr=0.1515 | fpr=0.8799 | 8133.8 samples/s | 31.8 steps/s
[Step= 450] | Loss=6.77601 | acc=0.1207 | tpr=0.1500 | fpr=0.8798 | 8642.3 samples/s | 33.8 steps/s
[Step= 500] | Loss=6.77809 | acc=0.1206 | tpr=0.1515 | fpr=0.8799 | 8399.6 samples/s | 32.8 steps/s
[Step= 550] | Loss=6.77366 | acc=0.1209 | tpr=0.1496 | fpr=0.8797 | 9078.2 samples/s | 35.5 steps/s
Avg test loss: 6.77345, Avg test acc: 0.12079, Avg tpr: 0.15016, Avg fpr: 0.87974, total FA: 122150

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.30009 | acc=0.1575 | tpr=0.1903 | fpr=0.8431 | 5549.8 samples/s | 21.7 steps/s
[Step= 100] | Loss=5.24971 | acc=0.1579 | tpr=0.1684 | fpr=0.8423 | 8411.2 samples/s | 32.9 steps/s
[Step= 150] | Loss=5.26142 | acc=0.1565 | tpr=0.1671 | fpr=0.8437 | 8100.2 samples/s | 31.6 steps/s
[Step= 200] | Loss=5.25242 | acc=0.1565 | tpr=0.1639 | fpr=0.8436 | 8383.8 samples/s | 32.7 steps/s
[Step= 250] | Loss=5.25660 | acc=0.1568 | tpr=0.1659 | fpr=0.8433 | 7861.6 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.26090 | acc=0.1561 | tpr=0.1687 | fpr=0.8441 | 7662.5 samples/s | 29.9 steps/s
[Step= 350] | Loss=5.26228 | acc=0.1560 | tpr=0.1609 | fpr=0.8441 | 8205.2 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.26093 | acc=0.1566 | tpr=0.1652 | fpr=0.8435 | 7527.4 samples/s | 29.4 steps/s
[Step= 450] | Loss=5.26090 | acc=0.1569 | tpr=0.1655 | fpr=0.8432 | 8507.9 samples/s | 33.2 steps/s
[Step= 500] | Loss=5.26454 | acc=0.1569 | tpr=0.1674 | fpr=0.8433 | 8509.6 samples/s | 33.2 steps/s
[Step= 550] | Loss=5.26195 | acc=0.1570 | tpr=0.1687 | fpr=0.8432 | 9588.1 samples/s | 37.5 steps/s
Avg test loss: 5.26155, Avg test acc: 0.15692, Avg tpr: 0.16878, Avg fpr: 0.84330, total FA: 117090

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.49391 | acc=0.1323 | tpr=0.1637 | fpr=0.8683 | 5633.1 samples/s | 22.0 steps/s
[Step= 100] | Loss=6.43214 | acc=0.1333 | tpr=0.1471 | fpr=0.8669 | 8092.9 samples/s | 31.6 steps/s
[Step= 150] | Loss=6.44703 | acc=0.1319 | tpr=0.1412 | fpr=0.8682 | 8193.8 samples/s | 32.0 steps/s
[Step= 200] | Loss=6.44203 | acc=0.1319 | tpr=0.1366 | fpr=0.8682 | 7973.6 samples/s | 31.1 steps/s
[Step= 250] | Loss=6.45066 | acc=0.1320 | tpr=0.1389 | fpr=0.8681 | 7761.3 samples/s | 30.3 steps/s
[Step= 300] | Loss=6.45599 | acc=0.1317 | tpr=0.1396 | fpr=0.8684 | 8416.4 samples/s | 32.9 steps/s
[Step= 350] | Loss=6.45887 | acc=0.1312 | tpr=0.1321 | fpr=0.8688 | 8172.0 samples/s | 31.9 steps/s
[Step= 400] | Loss=6.45658 | acc=0.1315 | tpr=0.1362 | fpr=0.8686 | 7599.0 samples/s | 29.7 steps/s
[Step= 450] | Loss=6.45546 | acc=0.1321 | tpr=0.1378 | fpr=0.8680 | 8556.3 samples/s | 33.4 steps/s
[Step= 500] | Loss=6.45859 | acc=0.1318 | tpr=0.1396 | fpr=0.8683 | 8503.1 samples/s | 33.2 steps/s
[Step= 550] | Loss=6.45490 | acc=0.1318 | tpr=0.1385 | fpr=0.8683 | 9446.2 samples/s | 36.9 steps/s
Avg test loss: 6.45455, Avg test acc: 0.13172, Avg tpr: 0.13867, Avg fpr: 0.86841, total FA: 120577

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10129 | acc=0.9813 | tpr=0.9292 | fpr=0.0177 | 5848.2 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.10203 | acc=0.9815 | tpr=0.9446 | fpr=0.0178 | 7612.5 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.10499 | acc=0.9810 | tpr=0.9496 | fpr=0.0185 | 8070.1 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.10737 | acc=0.9808 | tpr=0.9519 | fpr=0.0187 | 7849.0 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.10803 | acc=0.9806 | tpr=0.9467 | fpr=0.0188 | 7969.3 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.10916 | acc=0.9805 | tpr=0.9447 | fpr=0.0189 | 8202.5 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.10935 | acc=0.9805 | tpr=0.9468 | fpr=0.0189 | 7391.1 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.11058 | acc=0.9802 | tpr=0.9420 | fpr=0.0191 | 8356.2 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.11280 | acc=0.9799 | tpr=0.9396 | fpr=0.0194 | 7849.2 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.11189 | acc=0.9800 | tpr=0.9427 | fpr=0.0193 | 8135.8 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.11101 | acc=0.9801 | tpr=0.9427 | fpr=0.0192 | 11494.1 samples/s | 44.9 steps/s
Avg test loss: 0.11078, Avg test acc: 0.98016, Avg tpr: 0.94255, Avg fpr: 0.01916, total FA: 2660

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09553 | acc=0.9824 | tpr=0.8938 | fpr=0.0160 | 5675.8 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.09776 | acc=0.9826 | tpr=0.9041 | fpr=0.0160 | 7877.8 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.10018 | acc=0.9824 | tpr=0.9135 | fpr=0.0163 | 8459.3 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.10122 | acc=0.9824 | tpr=0.9202 | fpr=0.0165 | 7917.5 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.10118 | acc=0.9824 | tpr=0.9188 | fpr=0.0164 | 7918.0 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.10260 | acc=0.9823 | tpr=0.9193 | fpr=0.0166 | 7725.3 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.10271 | acc=0.9822 | tpr=0.9198 | fpr=0.0167 | 8184.2 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.10351 | acc=0.9821 | tpr=0.9158 | fpr=0.0167 | 8662.4 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.10548 | acc=0.9818 | tpr=0.9133 | fpr=0.0169 | 8169.2 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.10461 | acc=0.9819 | tpr=0.9154 | fpr=0.0169 | 8025.7 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.10392 | acc=0.9819 | tpr=0.9148 | fpr=0.0169 | 9567.0 samples/s | 37.4 steps/s
Avg test loss: 0.10374, Avg test acc: 0.98194, Avg tpr: 0.91442, Avg fpr: 0.01683, total FA: 2337

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11522 | acc=0.9781 | tpr=0.9381 | fpr=0.0212 | 5733.8 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.11659 | acc=0.9779 | tpr=0.9552 | fpr=0.0216 | 7932.6 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.12056 | acc=0.9776 | tpr=0.9568 | fpr=0.0221 | 7201.1 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.12222 | acc=0.9775 | tpr=0.9607 | fpr=0.0222 | 8283.8 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.12314 | acc=0.9774 | tpr=0.9581 | fpr=0.0222 | 8116.9 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.12411 | acc=0.9774 | tpr=0.9564 | fpr=0.0222 | 8237.2 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.12419 | acc=0.9774 | tpr=0.9587 | fpr=0.0222 | 7626.9 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.12509 | acc=0.9772 | tpr=0.9568 | fpr=0.0224 | 8740.0 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.12739 | acc=0.9768 | tpr=0.9547 | fpr=0.0228 | 7657.4 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.12641 | acc=0.9769 | tpr=0.9559 | fpr=0.0227 | 8100.9 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.12546 | acc=0.9772 | tpr=0.9550 | fpr=0.0224 | 11138.6 samples/s | 43.5 steps/s
Avg test loss: 0.12521, Avg test acc: 0.97717, Avg tpr: 0.95483, Avg fpr: 0.02242, total FA: 3113

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11789 | acc=0.9784 | tpr=0.9381 | fpr=0.0208 | 5660.4 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.11956 | acc=0.9787 | tpr=0.9446 | fpr=0.0207 | 8036.4 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.12232 | acc=0.9784 | tpr=0.9452 | fpr=0.0210 | 7848.3 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.12336 | acc=0.9786 | tpr=0.9464 | fpr=0.0208 | 8227.2 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.12383 | acc=0.9786 | tpr=0.9415 | fpr=0.0207 | 8680.8 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.12528 | acc=0.9785 | tpr=0.9396 | fpr=0.0208 | 8069.3 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.12550 | acc=0.9786 | tpr=0.9424 | fpr=0.0208 | 7768.9 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.12664 | acc=0.9784 | tpr=0.9387 | fpr=0.0209 | 8318.3 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.12886 | acc=0.9781 | tpr=0.9387 | fpr=0.0212 | 8476.6 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.12814 | acc=0.9782 | tpr=0.9414 | fpr=0.0212 | 8003.6 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.12731 | acc=0.9783 | tpr=0.9399 | fpr=0.0210 | 9499.6 samples/s | 37.1 steps/s
Avg test loss: 0.12703, Avg test acc: 0.97829, Avg tpr: 0.93978, Avg fpr: 0.02101, total FA: 2917

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10288 | acc=0.9808 | tpr=0.9159 | fpr=0.0181 | 5592.5 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.10558 | acc=0.9807 | tpr=0.9360 | fpr=0.0184 | 8059.3 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.10843 | acc=0.9804 | tpr=0.9424 | fpr=0.0189 | 7688.2 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.10978 | acc=0.9804 | tpr=0.9475 | fpr=0.0190 | 8218.1 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.11085 | acc=0.9803 | tpr=0.9450 | fpr=0.0191 | 7928.6 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.11204 | acc=0.9803 | tpr=0.9425 | fpr=0.0190 | 8206.5 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.11176 | acc=0.9803 | tpr=0.9455 | fpr=0.0191 | 7908.2 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.11267 | acc=0.9802 | tpr=0.9409 | fpr=0.0191 | 8016.3 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.11460 | acc=0.9799 | tpr=0.9396 | fpr=0.0193 | 7984.7 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.11376 | acc=0.9800 | tpr=0.9410 | fpr=0.0193 | 8150.3 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.11292 | acc=0.9802 | tpr=0.9395 | fpr=0.0191 | 10859.2 samples/s | 42.4 steps/s
Avg test loss: 0.11275, Avg test acc: 0.98017, Avg tpr: 0.93938, Avg fpr: 0.01909, total FA: 2651

server round 33/50

clients selected: [0 2 3 4 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=22001 Epoch=107.3] | Loss=0.01958 | Reg=0.00107 | acc=0.9688 | L2-Norm=10.359 | L2-Norm(final)=13.294 | 5709.0 samples/s | 89.2 steps/s
[Step=22050 Epoch=107.5] | Loss=0.02043 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=13.291 | 5094.5 samples/s | 79.6 steps/s
[Step=22100 Epoch=107.8] | Loss=0.01814 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=13.290 | 5612.2 samples/s | 87.7 steps/s
[Step=22150 Epoch=108.0] | Loss=0.01729 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=13.290 | 5611.9 samples/s | 87.7 steps/s
[Step=22200 Epoch=108.3] | Loss=0.01643 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=13.290 | 8704.1 samples/s | 136.0 steps/s
[Step=22250 Epoch=108.5] | Loss=0.01628 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=13.292 | 2455.2 samples/s | 38.4 steps/s
[Step=22300 Epoch=108.7] | Loss=0.01595 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=13.293 | 5601.4 samples/s | 87.5 steps/s
[Step=22350 Epoch=109.0] | Loss=0.01601 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=13.295 | 5570.7 samples/s | 87.0 steps/s
[Step=22400 Epoch=109.2] | Loss=0.01592 | Reg=0.00107 | acc=0.9688 | L2-Norm=10.359 | L2-Norm(final)=13.297 | 7773.5 samples/s | 121.5 steps/s
[Step=22450 Epoch=109.5] | Loss=0.01559 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=13.298 | 2516.0 samples/s | 39.3 steps/s
[Step=22500 Epoch=109.7] | Loss=0.01554 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=13.299 | 5574.1 samples/s | 87.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=22501 Epoch=109.7] | Loss=0.05494 | Reg=0.00107 | acc=0.9531 | L2-Norm=10.359 | L2-Norm(final)=13.315 | 5556.5 samples/s | 86.8 steps/s
[Step=22550 Epoch=110.0] | Loss=0.01463 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.374 | L2-Norm(final)=13.316 | 4543.1 samples/s | 71.0 steps/s
[Step=22600 Epoch=110.2] | Loss=0.01367 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.387 | L2-Norm(final)=13.318 | 4849.7 samples/s | 75.8 steps/s
[Step=22650 Epoch=110.4] | Loss=0.01375 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.396 | L2-Norm(final)=13.319 | 4887.2 samples/s | 76.4 steps/s
[Step=22700 Epoch=110.7] | Loss=0.01291 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=13.321 | 6918.3 samples/s | 108.1 steps/s
[Step=22750 Epoch=110.9] | Loss=0.01160 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.411 | L2-Norm(final)=13.323 | 2281.0 samples/s | 35.6 steps/s
[Step=22800 Epoch=111.2] | Loss=0.01067 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.417 | L2-Norm(final)=13.326 | 4791.1 samples/s | 74.9 steps/s
[Step=22850 Epoch=111.4] | Loss=0.01017 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.423 | L2-Norm(final)=13.329 | 4867.5 samples/s | 76.1 steps/s
[Step=22900 Epoch=111.7] | Loss=0.00946 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.428 | L2-Norm(final)=13.332 | 6326.5 samples/s | 98.9 steps/s
[Step=22950 Epoch=111.9] | Loss=0.00879 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.433 | L2-Norm(final)=13.335 | 2334.3 samples/s | 36.5 steps/s
[Step=23000 Epoch=112.2] | Loss=0.00830 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.437 | L2-Norm(final)=13.338 | 4923.8 samples/s | 76.9 steps/s
[Step=23050 Epoch=112.4] | Loss=0.00796 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.441 | L2-Norm(final)=13.340 | 4890.0 samples/s | 76.4 steps/s
[Step=23100 Epoch=112.6] | Loss=0.00765 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.445 | L2-Norm(final)=13.343 | 5769.4 samples/s | 90.1 steps/s
[Step=23150 Epoch=112.9] | Loss=0.00742 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.449 | L2-Norm(final)=13.346 | 2427.7 samples/s | 37.9 steps/s
[Step=23200 Epoch=113.1] | Loss=0.00721 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.452 | L2-Norm(final)=13.348 | 4850.0 samples/s | 75.8 steps/s
[Step=23250 Epoch=113.4] | Loss=0.00693 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.455 | L2-Norm(final)=13.350 | 4843.8 samples/s | 75.7 steps/s
[Step=23300 Epoch=113.6] | Loss=0.00670 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.459 | L2-Norm(final)=13.353 | 5405.4 samples/s | 84.5 steps/s
[Step=23350 Epoch=113.9] | Loss=0.00656 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.462 | L2-Norm(final)=13.355 | 2481.1 samples/s | 38.8 steps/s
[Step=23400 Epoch=114.1] | Loss=0.00643 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.464 | L2-Norm(final)=13.357 | 4886.6 samples/s | 76.4 steps/s
[Step=23450 Epoch=114.3] | Loss=0.00627 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.467 | L2-Norm(final)=13.359 | 4848.8 samples/s | 75.8 steps/s
[Step=23500 Epoch=114.6] | Loss=0.00612 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=13.361 | 4940.9 samples/s | 77.2 steps/s
[Step=23550 Epoch=114.8] | Loss=0.00599 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=13.364 | 2577.2 samples/s | 40.3 steps/s
[Step=23600 Epoch=115.1] | Loss=0.00589 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.475 | L2-Norm(final)=13.366 | 4868.5 samples/s | 76.1 steps/s
[Step=23650 Epoch=115.3] | Loss=0.00577 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.477 | L2-Norm(final)=13.368 | 4871.8 samples/s | 76.1 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00566 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.480 | L2-Norm(final)=13.370 | 4915.8 samples/s | 76.8 steps/s
[Step=23750 Epoch=115.8] | Loss=0.00557 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.482 | L2-Norm(final)=13.372 | 2616.8 samples/s | 40.9 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00544 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.484 | L2-Norm(final)=13.374 | 4841.7 samples/s | 75.7 steps/s
[Step=23850 Epoch=116.3] | Loss=0.00537 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.486 | L2-Norm(final)=13.375 | 4857.5 samples/s | 75.9 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00525 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.489 | L2-Norm(final)=13.377 | 4876.3 samples/s | 76.2 steps/s
[Step=23950 Epoch=116.8] | Loss=0.00516 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.491 | L2-Norm(final)=13.379 | 2651.2 samples/s | 41.4 steps/s
[Step=24000 Epoch=117.0] | Loss=0.00508 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.493 | L2-Norm(final)=13.381 | 4792.8 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step24000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=165.7] | Loss=0.00493 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=14.299 | 6191.5 samples/s | 96.7 steps/s
[Step=34050 Epoch=165.9] | Loss=0.01787 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=14.300 | 4775.2 samples/s | 74.6 steps/s
[Step=34100 Epoch=166.2] | Loss=0.01852 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=14.299 | 5623.8 samples/s | 87.9 steps/s
[Step=34150 Epoch=166.4] | Loss=0.01813 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=14.297 | 5665.3 samples/s | 88.5 steps/s
[Step=34200 Epoch=166.6] | Loss=0.01777 | Reg=0.00107 | acc=0.9688 | L2-Norm=10.359 | L2-Norm(final)=14.295 | 8588.1 samples/s | 134.2 steps/s
[Step=34250 Epoch=166.9] | Loss=0.01878 | Reg=0.00107 | acc=0.9688 | L2-Norm=10.359 | L2-Norm(final)=14.294 | 2413.7 samples/s | 37.7 steps/s
[Step=34300 Epoch=167.1] | Loss=0.01907 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=14.293 | 5628.9 samples/s | 88.0 steps/s
[Step=34350 Epoch=167.4] | Loss=0.01854 | Reg=0.00107 | acc=0.9531 | L2-Norm=10.359 | L2-Norm(final)=14.291 | 5662.2 samples/s | 88.5 steps/s
[Step=34400 Epoch=167.6] | Loss=0.01812 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=14.290 | 7695.7 samples/s | 120.2 steps/s
[Step=34450 Epoch=167.9] | Loss=0.01804 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=14.290 | 2516.1 samples/s | 39.3 steps/s
[Step=34500 Epoch=168.1] | Loss=0.01802 | Reg=0.00107 | acc=0.9688 | L2-Norm=10.359 | L2-Norm(final)=14.289 | 5636.2 samples/s | 88.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=168.1] | Loss=0.04580 | Reg=0.00107 | acc=0.9688 | L2-Norm=10.359 | L2-Norm(final)=14.284 | 5883.1 samples/s | 91.9 steps/s
[Step=34550 Epoch=168.3] | Loss=0.01944 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.371 | L2-Norm(final)=14.282 | 4354.5 samples/s | 68.0 steps/s
[Step=34600 Epoch=168.6] | Loss=0.01910 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.384 | L2-Norm(final)=14.281 | 4964.0 samples/s | 77.6 steps/s
[Step=34650 Epoch=168.8] | Loss=0.01784 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.395 | L2-Norm(final)=14.281 | 4841.3 samples/s | 75.6 steps/s
[Step=34700 Epoch=169.1] | Loss=0.01670 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.405 | L2-Norm(final)=14.282 | 6790.5 samples/s | 106.1 steps/s
[Step=34750 Epoch=169.3] | Loss=0.01482 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.413 | L2-Norm(final)=14.284 | 2275.6 samples/s | 35.6 steps/s
[Step=34800 Epoch=169.6] | Loss=0.01304 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.421 | L2-Norm(final)=14.287 | 4884.7 samples/s | 76.3 steps/s
[Step=34850 Epoch=169.8] | Loss=0.01190 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.427 | L2-Norm(final)=14.290 | 4888.6 samples/s | 76.4 steps/s
[Step=34900 Epoch=170.0] | Loss=0.01120 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.433 | L2-Norm(final)=14.293 | 6296.8 samples/s | 98.4 steps/s
[Step=34950 Epoch=170.3] | Loss=0.01054 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.438 | L2-Norm(final)=14.296 | 2337.8 samples/s | 36.5 steps/s
[Step=35000 Epoch=170.5] | Loss=0.00990 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.442 | L2-Norm(final)=14.298 | 4866.5 samples/s | 76.0 steps/s
[Step=35050 Epoch=170.8] | Loss=0.00942 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.446 | L2-Norm(final)=14.301 | 4857.9 samples/s | 75.9 steps/s
[Step=35100 Epoch=171.0] | Loss=0.00908 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.450 | L2-Norm(final)=14.303 | 5808.4 samples/s | 90.8 steps/s
[Step=35150 Epoch=171.3] | Loss=0.00858 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.453 | L2-Norm(final)=14.305 | 2447.5 samples/s | 38.2 steps/s
[Step=35200 Epoch=171.5] | Loss=0.00822 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.456 | L2-Norm(final)=14.307 | 4823.8 samples/s | 75.4 steps/s
[Step=35250 Epoch=171.8] | Loss=0.00791 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.459 | L2-Norm(final)=14.310 | 4834.4 samples/s | 75.5 steps/s
[Step=35300 Epoch=172.0] | Loss=0.00773 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.462 | L2-Norm(final)=14.312 | 5391.2 samples/s | 84.2 steps/s
[Step=35350 Epoch=172.2] | Loss=0.00744 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.465 | L2-Norm(final)=14.314 | 2523.7 samples/s | 39.4 steps/s
[Step=35400 Epoch=172.5] | Loss=0.00724 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.468 | L2-Norm(final)=14.316 | 4801.5 samples/s | 75.0 steps/s
[Step=35450 Epoch=172.7] | Loss=0.00707 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.471 | L2-Norm(final)=14.318 | 4857.5 samples/s | 75.9 steps/s
[Step=35500 Epoch=173.0] | Loss=0.00686 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.473 | L2-Norm(final)=14.320 | 4979.1 samples/s | 77.8 steps/s
[Step=35550 Epoch=173.2] | Loss=0.00669 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.476 | L2-Norm(final)=14.322 | 2613.2 samples/s | 40.8 steps/s
[Step=35600 Epoch=173.5] | Loss=0.00652 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.478 | L2-Norm(final)=14.324 | 4951.0 samples/s | 77.4 steps/s
[Step=35650 Epoch=173.7] | Loss=0.00634 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.480 | L2-Norm(final)=14.325 | 4799.1 samples/s | 75.0 steps/s
[Step=35700 Epoch=173.9] | Loss=0.00619 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=14.327 | 4884.9 samples/s | 76.3 steps/s
[Step=35750 Epoch=174.2] | Loss=0.00605 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.485 | L2-Norm(final)=14.329 | 2656.8 samples/s | 41.5 steps/s
[Step=35800 Epoch=174.4] | Loss=0.00589 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=14.331 | 4883.7 samples/s | 76.3 steps/s
[Step=35850 Epoch=174.7] | Loss=0.00578 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.489 | L2-Norm(final)=14.333 | 4833.3 samples/s | 75.5 steps/s
[Step=35900 Epoch=174.9] | Loss=0.00564 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.491 | L2-Norm(final)=14.335 | 4873.6 samples/s | 76.2 steps/s
[Step=35950 Epoch=175.2] | Loss=0.00560 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.493 | L2-Norm(final)=14.337 | 2640.2 samples/s | 41.3 steps/s
[Step=36000 Epoch=175.4] | Loss=0.00550 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=14.338 | 4882.4 samples/s | 76.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step36000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=38001 Epoch=185.3] | Loss=0.01405 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=14.947 | 5286.7 samples/s | 82.6 steps/s
[Step=38050 Epoch=185.6] | Loss=0.01490 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=14.948 | 5274.0 samples/s | 82.4 steps/s
[Step=38100 Epoch=185.8] | Loss=0.01651 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=14.949 | 5597.6 samples/s | 87.5 steps/s
[Step=38150 Epoch=186.0] | Loss=0.01727 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=14.949 | 5542.0 samples/s | 86.6 steps/s
[Step=38200 Epoch=186.3] | Loss=0.01739 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=14.949 | 8789.3 samples/s | 137.3 steps/s
[Step=38250 Epoch=186.5] | Loss=0.01719 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=14.948 | 2408.3 samples/s | 37.6 steps/s
[Step=38300 Epoch=186.8] | Loss=0.01766 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=14.948 | 5690.9 samples/s | 88.9 steps/s
[Step=38350 Epoch=187.0] | Loss=0.01756 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=14.947 | 5639.4 samples/s | 88.1 steps/s
[Step=38400 Epoch=187.3] | Loss=0.01738 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=14.947 | 7700.5 samples/s | 120.3 steps/s
[Step=38450 Epoch=187.5] | Loss=0.01750 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=14.947 | 2516.5 samples/s | 39.3 steps/s
[Step=38500 Epoch=187.7] | Loss=0.01739 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=14.947 | 5656.6 samples/s | 88.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=187.8] | Loss=0.00365 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=14.947 | 5831.3 samples/s | 91.1 steps/s
[Step=38550 Epoch=188.0] | Loss=0.01877 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.370 | L2-Norm(final)=14.947 | 4394.7 samples/s | 68.7 steps/s
[Step=38600 Epoch=188.2] | Loss=0.01746 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.381 | L2-Norm(final)=14.946 | 4869.9 samples/s | 76.1 steps/s
[Step=38650 Epoch=188.5] | Loss=0.01650 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.389 | L2-Norm(final)=14.945 | 4884.9 samples/s | 76.3 steps/s
[Step=38700 Epoch=188.7] | Loss=0.01511 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.397 | L2-Norm(final)=14.946 | 6985.9 samples/s | 109.2 steps/s
[Step=38750 Epoch=189.0] | Loss=0.01305 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=14.947 | 2286.7 samples/s | 35.7 steps/s
[Step=38800 Epoch=189.2] | Loss=0.01157 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.409 | L2-Norm(final)=14.949 | 4947.4 samples/s | 77.3 steps/s
[Step=38850 Epoch=189.5] | Loss=0.01084 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.414 | L2-Norm(final)=14.951 | 4844.3 samples/s | 75.7 steps/s
[Step=38900 Epoch=189.7] | Loss=0.01000 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.418 | L2-Norm(final)=14.953 | 6186.6 samples/s | 96.7 steps/s
[Step=38950 Epoch=189.9] | Loss=0.00928 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.422 | L2-Norm(final)=14.955 | 2327.7 samples/s | 36.4 steps/s
[Step=39000 Epoch=190.2] | Loss=0.00873 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.425 | L2-Norm(final)=14.957 | 4842.8 samples/s | 75.7 steps/s
[Step=39050 Epoch=190.4] | Loss=0.00821 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.428 | L2-Norm(final)=14.959 | 4874.1 samples/s | 76.2 steps/s
[Step=39100 Epoch=190.7] | Loss=0.00799 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.431 | L2-Norm(final)=14.961 | 5782.6 samples/s | 90.4 steps/s
[Step=39150 Epoch=190.9] | Loss=0.00763 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.434 | L2-Norm(final)=14.963 | 2417.1 samples/s | 37.8 steps/s
[Step=39200 Epoch=191.2] | Loss=0.00740 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.437 | L2-Norm(final)=14.965 | 4796.5 samples/s | 74.9 steps/s
[Step=39250 Epoch=191.4] | Loss=0.00708 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.439 | L2-Norm(final)=14.967 | 4886.0 samples/s | 76.3 steps/s
[Step=39300 Epoch=191.6] | Loss=0.00674 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.442 | L2-Norm(final)=14.968 | 5355.3 samples/s | 83.7 steps/s
[Step=39350 Epoch=191.9] | Loss=0.00653 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.444 | L2-Norm(final)=14.970 | 2503.7 samples/s | 39.1 steps/s
[Step=39400 Epoch=192.1] | Loss=0.00630 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.446 | L2-Norm(final)=14.972 | 4925.4 samples/s | 77.0 steps/s
[Step=39450 Epoch=192.4] | Loss=0.00613 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.448 | L2-Norm(final)=14.974 | 4764.7 samples/s | 74.4 steps/s
[Step=39500 Epoch=192.6] | Loss=0.00597 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.450 | L2-Norm(final)=14.975 | 5017.1 samples/s | 78.4 steps/s
[Step=39550 Epoch=192.9] | Loss=0.00580 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.452 | L2-Norm(final)=14.977 | 2603.1 samples/s | 40.7 steps/s
[Step=39600 Epoch=193.1] | Loss=0.00567 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.454 | L2-Norm(final)=14.979 | 4768.5 samples/s | 74.5 steps/s
[Step=39650 Epoch=193.4] | Loss=0.00557 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.456 | L2-Norm(final)=14.980 | 4916.4 samples/s | 76.8 steps/s
[Step=39700 Epoch=193.6] | Loss=0.00545 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.458 | L2-Norm(final)=14.982 | 4837.2 samples/s | 75.6 steps/s
[Step=39750 Epoch=193.8] | Loss=0.00532 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.460 | L2-Norm(final)=14.983 | 2651.7 samples/s | 41.4 steps/s
[Step=39800 Epoch=194.1] | Loss=0.00523 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.461 | L2-Norm(final)=14.985 | 4769.1 samples/s | 74.5 steps/s
[Step=39850 Epoch=194.3] | Loss=0.00514 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.463 | L2-Norm(final)=14.986 | 4963.0 samples/s | 77.5 steps/s
[Step=39900 Epoch=194.6] | Loss=0.00506 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.464 | L2-Norm(final)=14.987 | 4756.4 samples/s | 74.3 steps/s
[Step=39950 Epoch=194.8] | Loss=0.00498 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.466 | L2-Norm(final)=14.989 | 2653.4 samples/s | 41.5 steps/s
[Step=40000 Epoch=195.1] | Loss=0.00489 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.467 | L2-Norm(final)=14.990 | 4897.5 samples/s | 76.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step40000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=44001 Epoch=215.8] | Loss=0.00139 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=15.512 | 6072.2 samples/s | 94.9 steps/s
[Step=44050 Epoch=216.0] | Loss=0.01330 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=15.515 | 4697.5 samples/s | 73.4 steps/s
[Step=44100 Epoch=216.3] | Loss=0.01417 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=15.518 | 5593.4 samples/s | 87.4 steps/s
[Step=44150 Epoch=216.5] | Loss=0.01627 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=15.519 | 5726.4 samples/s | 89.5 steps/s
[Step=44200 Epoch=216.7] | Loss=0.01685 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=15.519 | 8880.9 samples/s | 138.8 steps/s
[Step=44250 Epoch=217.0] | Loss=0.01700 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=15.519 | 2399.0 samples/s | 37.5 steps/s
[Step=44300 Epoch=217.2] | Loss=0.01664 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=15.519 | 5616.6 samples/s | 87.8 steps/s
[Step=44350 Epoch=217.5] | Loss=0.01662 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=15.519 | 5587.0 samples/s | 87.3 steps/s
[Step=44400 Epoch=217.7] | Loss=0.01688 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=15.519 | 8343.6 samples/s | 130.4 steps/s
[Step=44450 Epoch=218.0] | Loss=0.01709 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=15.519 | 2464.2 samples/s | 38.5 steps/s
[Step=44500 Epoch=218.2] | Loss=0.01714 | Reg=0.00107 | acc=0.9688 | L2-Norm=10.359 | L2-Norm(final)=15.519 | 5521.8 samples/s | 86.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=44501 Epoch=218.2] | Loss=0.00825 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=15.522 | 5734.4 samples/s | 89.6 steps/s
[Step=44550 Epoch=218.5] | Loss=0.01818 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.373 | L2-Norm(final)=15.522 | 4427.3 samples/s | 69.2 steps/s
[Step=44600 Epoch=218.7] | Loss=0.01751 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.387 | L2-Norm(final)=15.522 | 4901.6 samples/s | 76.6 steps/s
[Step=44650 Epoch=219.0] | Loss=0.01575 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.397 | L2-Norm(final)=15.523 | 4902.8 samples/s | 76.6 steps/s
[Step=44700 Epoch=219.2] | Loss=0.01445 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=15.525 | 7010.7 samples/s | 109.5 steps/s
[Step=44750 Epoch=219.4] | Loss=0.01235 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.413 | L2-Norm(final)=15.528 | 1722.9 samples/s | 26.9 steps/s
[Step=44800 Epoch=219.7] | Loss=0.01100 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.419 | L2-Norm(final)=15.530 | 4865.1 samples/s | 76.0 steps/s
[Step=44850 Epoch=219.9] | Loss=0.01012 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.424 | L2-Norm(final)=15.533 | 4621.8 samples/s | 72.2 steps/s
[Step=44900 Epoch=220.2] | Loss=0.00941 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.428 | L2-Norm(final)=15.536 | 6680.4 samples/s | 104.4 steps/s
[Step=44950 Epoch=220.4] | Loss=0.00880 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.432 | L2-Norm(final)=15.538 | 2280.7 samples/s | 35.6 steps/s
[Step=45000 Epoch=220.7] | Loss=0.00834 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.436 | L2-Norm(final)=15.540 | 4918.4 samples/s | 76.8 steps/s
[Step=45050 Epoch=220.9] | Loss=0.00787 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.439 | L2-Norm(final)=15.543 | 4857.3 samples/s | 75.9 steps/s
[Step=45100 Epoch=221.2] | Loss=0.00758 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.442 | L2-Norm(final)=15.545 | 6207.0 samples/s | 97.0 steps/s
[Step=45150 Epoch=221.4] | Loss=0.00717 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.445 | L2-Norm(final)=15.547 | 2366.3 samples/s | 37.0 steps/s
[Step=45200 Epoch=221.7] | Loss=0.00676 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.448 | L2-Norm(final)=15.549 | 4806.7 samples/s | 75.1 steps/s
[Step=45250 Epoch=221.9] | Loss=0.00654 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.451 | L2-Norm(final)=15.551 | 4853.1 samples/s | 75.8 steps/s
[Step=45300 Epoch=222.1] | Loss=0.00634 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.453 | L2-Norm(final)=15.553 | 5920.0 samples/s | 92.5 steps/s
[Step=45350 Epoch=222.4] | Loss=0.00613 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.456 | L2-Norm(final)=15.555 | 2398.9 samples/s | 37.5 steps/s
[Step=45400 Epoch=222.6] | Loss=0.00600 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.458 | L2-Norm(final)=15.557 | 4888.3 samples/s | 76.4 steps/s
[Step=45450 Epoch=222.9] | Loss=0.00591 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.460 | L2-Norm(final)=15.559 | 4856.7 samples/s | 75.9 steps/s
[Step=45500 Epoch=223.1] | Loss=0.00570 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.463 | L2-Norm(final)=15.561 | 5621.0 samples/s | 87.8 steps/s
[Step=45550 Epoch=223.4] | Loss=0.00558 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.465 | L2-Norm(final)=15.562 | 2462.5 samples/s | 38.5 steps/s
[Step=45600 Epoch=223.6] | Loss=0.00550 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.467 | L2-Norm(final)=15.564 | 4820.9 samples/s | 75.3 steps/s
[Step=45650 Epoch=223.9] | Loss=0.00532 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.469 | L2-Norm(final)=15.566 | 4865.3 samples/s | 76.0 steps/s
[Step=45700 Epoch=224.1] | Loss=0.00518 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.471 | L2-Norm(final)=15.567 | 5301.0 samples/s | 82.8 steps/s
[Step=45750 Epoch=224.4] | Loss=0.00504 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=15.569 | 2532.8 samples/s | 39.6 steps/s
[Step=45800 Epoch=224.6] | Loss=0.00491 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.474 | L2-Norm(final)=15.571 | 4809.1 samples/s | 75.1 steps/s
[Step=45850 Epoch=224.8] | Loss=0.00481 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.476 | L2-Norm(final)=15.572 | 4852.2 samples/s | 75.8 steps/s
[Step=45900 Epoch=225.1] | Loss=0.00476 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.477 | L2-Norm(final)=15.574 | 5073.7 samples/s | 79.3 steps/s
[Step=45950 Epoch=225.3] | Loss=0.00469 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=15.576 | 2579.9 samples/s | 40.3 steps/s
[Step=46000 Epoch=225.6] | Loss=0.00463 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.481 | L2-Norm(final)=15.577 | 4918.1 samples/s | 76.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step46000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=301.5] | Loss=0.00034 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=15.693 | 5264.1 samples/s | 82.3 steps/s
[Step=32050 Epoch=302.0] | Loss=0.00046 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.357 | L2-Norm(final)=15.702 | 4770.4 samples/s | 74.5 steps/s
[Step=32100 Epoch=302.5] | Loss=0.00046 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.357 | L2-Norm(final)=15.712 | 8208.4 samples/s | 128.3 steps/s
[Step=32150 Epoch=302.9] | Loss=0.00046 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.357 | L2-Norm(final)=15.722 | 2350.8 samples/s | 36.7 steps/s
[Step=32200 Epoch=303.4] | Loss=0.00045 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.357 | L2-Norm(final)=15.732 | 7198.0 samples/s | 112.5 steps/s
[Step=32250 Epoch=303.9] | Loss=0.00048 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.357 | L2-Norm(final)=15.741 | 2472.6 samples/s | 38.6 steps/s
[Step=32300 Epoch=304.4] | Loss=0.00047 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.357 | L2-Norm(final)=15.750 | 6275.3 samples/s | 98.1 steps/s
[Step=32350 Epoch=304.8] | Loss=0.00047 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.357 | L2-Norm(final)=15.758 | 2598.4 samples/s | 40.6 steps/s
[Step=32400 Epoch=305.3] | Loss=0.00046 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.357 | L2-Norm(final)=15.766 | 5577.6 samples/s | 87.1 steps/s
[Step=32450 Epoch=305.8] | Loss=0.00045 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.357 | L2-Norm(final)=15.774 | 2774.5 samples/s | 43.4 steps/s
[Step=32500 Epoch=306.2] | Loss=0.00045 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.357 | L2-Norm(final)=15.782 | 5180.2 samples/s | 80.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=306.3] | Loss=0.00122 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.357 | L2-Norm(final)=15.861 | 5895.7 samples/s | 92.1 steps/s
[Step=32550 Epoch=306.7] | Loss=0.00018 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.360 | L2-Norm(final)=15.866 | 4128.2 samples/s | 64.5 steps/s
[Step=32600 Epoch=307.2] | Loss=0.00015 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.357 | L2-Norm(final)=15.869 | 6398.7 samples/s | 100.0 steps/s
[Step=32650 Epoch=307.7] | Loss=0.00011 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.355 | L2-Norm(final)=15.871 | 2208.7 samples/s | 34.5 steps/s
[Step=32700 Epoch=308.1] | Loss=0.00008 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.351 | L2-Norm(final)=15.872 | 5844.4 samples/s | 91.3 steps/s
[Step=32750 Epoch=308.6] | Loss=0.00007 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.346 | L2-Norm(final)=15.873 | 2283.3 samples/s | 35.7 steps/s
[Step=32800 Epoch=309.1] | Loss=0.00006 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.340 | L2-Norm(final)=15.874 | 5341.3 samples/s | 83.5 steps/s
[Step=32850 Epoch=309.5] | Loss=0.00005 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.334 | L2-Norm(final)=15.875 | 2390.7 samples/s | 37.4 steps/s
[Step=32900 Epoch=310.0] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.327 | L2-Norm(final)=15.875 | 4900.7 samples/s | 76.6 steps/s
[Step=32950 Epoch=310.5] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.320 | L2-Norm(final)=15.876 | 2494.5 samples/s | 39.0 steps/s
[Step=33000 Epoch=311.0] | Loss=0.00004 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.313 | L2-Norm(final)=15.877 | 4619.7 samples/s | 72.2 steps/s
[Step=33050 Epoch=311.4] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.306 | L2-Norm(final)=15.877 | 2573.6 samples/s | 40.2 steps/s
[Step=33100 Epoch=311.9] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.299 | L2-Norm(final)=15.877 | 4629.8 samples/s | 72.3 steps/s
[Step=33150 Epoch=312.4] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.292 | L2-Norm(final)=15.878 | 2593.8 samples/s | 40.5 steps/s
[Step=33200 Epoch=312.8] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.285 | L2-Norm(final)=15.878 | 4639.3 samples/s | 72.5 steps/s
[Step=33250 Epoch=313.3] | Loss=0.00002 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.278 | L2-Norm(final)=15.879 | 2705.4 samples/s | 42.3 steps/s
[Step=33300 Epoch=313.8] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.271 | L2-Norm(final)=15.879 | 4237.8 samples/s | 66.2 steps/s
[Step=33350 Epoch=314.3] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.263 | L2-Norm(final)=15.880 | 6675.9 samples/s | 104.3 steps/s
[Step=33400 Epoch=314.7] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.256 | L2-Norm(final)=15.880 | 2215.4 samples/s | 34.6 steps/s
[Step=33450 Epoch=315.2] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.249 | L2-Norm(final)=15.880 | 5905.9 samples/s | 92.3 steps/s
[Step=33500 Epoch=315.7] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.241 | L2-Norm(final)=15.881 | 2290.7 samples/s | 35.8 steps/s
[Step=33550 Epoch=316.1] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.234 | L2-Norm(final)=15.881 | 5456.6 samples/s | 85.3 steps/s
[Step=33600 Epoch=316.6] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.226 | L2-Norm(final)=15.882 | 2389.4 samples/s | 37.3 steps/s
[Step=33650 Epoch=317.1] | Loss=0.00002 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.218 | L2-Norm(final)=15.882 | 4869.5 samples/s | 76.1 steps/s
[Step=33700 Epoch=317.6] | Loss=0.00002 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.211 | L2-Norm(final)=15.882 | 2483.2 samples/s | 38.8 steps/s
[Step=33750 Epoch=318.0] | Loss=0.00002 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.203 | L2-Norm(final)=15.883 | 4580.5 samples/s | 71.6 steps/s
[Step=33800 Epoch=318.5] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.195 | L2-Norm(final)=15.883 | 2561.2 samples/s | 40.0 steps/s
[Step=33850 Epoch=319.0] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.187 | L2-Norm(final)=15.884 | 4627.6 samples/s | 72.3 steps/s
[Step=33900 Epoch=319.4] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.179 | L2-Norm(final)=15.884 | 2583.8 samples/s | 40.4 steps/s
[Step=33950 Epoch=319.9] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.171 | L2-Norm(final)=15.884 | 4671.9 samples/s | 73.0 steps/s
[Step=34000 Epoch=320.4] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.163 | L2-Norm(final)=15.885 | 2724.5 samples/s | 42.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step34000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08628 | acc=0.9607 | tpr=0.9658 | fpr=0.0503 | 5546.5 samples/s | 21.7 steps/s
Avg test loss: 0.09360, Avg test acc: 0.95937, Avg tpr: 0.96474, Avg fpr: 0.05243, total FA: 409

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08757 | acc=0.9652 | tpr=0.9758 | fpr=0.0577 | 5549.6 samples/s | 21.7 steps/s
Avg test loss: 0.09537, Avg test acc: 0.96378, Avg tpr: 0.97389, Avg fpr: 0.05845, total FA: 456

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09011 | acc=0.9634 | tpr=0.9766 | fpr=0.0654 | 5484.6 samples/s | 21.4 steps/s
Avg test loss: 0.09583, Avg test acc: 0.96226, Avg tpr: 0.97453, Avg fpr: 0.06474, total FA: 505

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08597 | acc=0.9654 | tpr=0.9783 | fpr=0.0627 | 5688.2 samples/s | 22.2 steps/s
Avg test loss: 0.09467, Avg test acc: 0.96394, Avg tpr: 0.97791, Avg fpr: 0.06679, total FA: 521

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08463 | acc=0.9627 | tpr=0.9683 | fpr=0.0493 | 5711.7 samples/s | 22.3 steps/s
Avg test loss: 0.09422, Avg test acc: 0.96190, Avg tpr: 0.96701, Avg fpr: 0.04935, total FA: 385

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.38077 | acc=0.2558 | tpr=0.0060 | fpr=0.2019 | 5573.4 samples/s | 21.8 steps/s
Avg test loss: 5.38527, Avg test acc: 0.25479, Avg tpr: 0.00629, Avg fpr: 0.19869, total FA: 1550

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.60507 | acc=0.2891 | tpr=0.0080 | fpr=0.1003 | 5727.1 samples/s | 22.4 steps/s
Avg test loss: 4.61595, Avg test acc: 0.28596, Avg tpr: 0.00699, Avg fpr: 0.10050, total FA: 784

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.42073 | acc=0.2127 | tpr=0.0121 | fpr=0.3516 | 5652.0 samples/s | 22.1 steps/s
Avg test loss: 5.42363, Avg test acc: 0.21404, Avg tpr: 0.01311, Avg fpr: 0.34406, total FA: 2684

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=6.18415 | acc=0.2230 | tpr=0.0099 | fpr=0.3142 | 5488.8 samples/s | 21.4 steps/s
Avg test loss: 6.18846, Avg test acc: 0.22217, Avg tpr: 0.00979, Avg fpr: 0.31073, total FA: 2424

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.59919 | acc=0.2459 | tpr=0.0084 | fpr=0.2384 | 5636.4 samples/s | 22.0 steps/s
Avg test loss: 5.60686, Avg test acc: 0.24361, Avg tpr: 0.00839, Avg fpr: 0.23907, total FA: 1865

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.18032 | acc=0.1695 | tpr=0.1681 | fpr=0.8305 | 5920.1 samples/s | 23.1 steps/s
[Step= 100] | Loss=5.12399 | acc=0.1704 | tpr=0.1535 | fpr=0.8293 | 7405.3 samples/s | 28.9 steps/s
[Step= 150] | Loss=5.13789 | acc=0.1694 | tpr=0.1513 | fpr=0.8303 | 8143.0 samples/s | 31.8 steps/s
[Step= 200] | Loss=5.13338 | acc=0.1687 | tpr=0.1508 | fpr=0.8309 | 7994.6 samples/s | 31.2 steps/s
[Step= 250] | Loss=5.13841 | acc=0.1688 | tpr=0.1511 | fpr=0.8309 | 7673.6 samples/s | 30.0 steps/s
[Step= 300] | Loss=5.14227 | acc=0.1683 | tpr=0.1585 | fpr=0.8315 | 8162.7 samples/s | 31.9 steps/s
[Step= 350] | Loss=5.14434 | acc=0.1684 | tpr=0.1503 | fpr=0.8313 | 7949.5 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.14279 | acc=0.1690 | tpr=0.1548 | fpr=0.8308 | 8339.8 samples/s | 32.6 steps/s
[Step= 450] | Loss=5.14223 | acc=0.1691 | tpr=0.1548 | fpr=0.8306 | 7841.7 samples/s | 30.6 steps/s
[Step= 500] | Loss=5.14452 | acc=0.1690 | tpr=0.1573 | fpr=0.8308 | 8156.5 samples/s | 31.9 steps/s
[Step= 550] | Loss=5.14329 | acc=0.1692 | tpr=0.1548 | fpr=0.8306 | 10866.5 samples/s | 42.4 steps/s
Avg test loss: 5.14313, Avg test acc: 0.16906, Avg tpr: 0.15452, Avg fpr: 0.83068, total FA: 115338

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.06967 | acc=0.1476 | tpr=0.2168 | fpr=0.8537 | 5800.6 samples/s | 22.7 steps/s
[Step= 100] | Loss=5.02220 | acc=0.1504 | tpr=0.1898 | fpr=0.8504 | 7459.4 samples/s | 29.1 steps/s
[Step= 150] | Loss=5.03774 | acc=0.1479 | tpr=0.1873 | fpr=0.8528 | 7264.0 samples/s | 28.4 steps/s
[Step= 200] | Loss=5.03338 | acc=0.1479 | tpr=0.1814 | fpr=0.8528 | 8533.2 samples/s | 33.3 steps/s
[Step= 250] | Loss=5.03765 | acc=0.1476 | tpr=0.1755 | fpr=0.8529 | 8275.3 samples/s | 32.3 steps/s
[Step= 300] | Loss=5.04043 | acc=0.1471 | tpr=0.1789 | fpr=0.8535 | 8243.3 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.04136 | acc=0.1469 | tpr=0.1666 | fpr=0.8534 | 7916.1 samples/s | 30.9 steps/s
[Step= 400] | Loss=5.03981 | acc=0.1477 | tpr=0.1718 | fpr=0.8527 | 7879.2 samples/s | 30.8 steps/s
[Step= 450] | Loss=5.03933 | acc=0.1479 | tpr=0.1714 | fpr=0.8526 | 8368.9 samples/s | 32.7 steps/s
[Step= 500] | Loss=5.04230 | acc=0.1475 | tpr=0.1718 | fpr=0.8530 | 7740.7 samples/s | 30.2 steps/s
[Step= 550] | Loss=5.04088 | acc=0.1477 | tpr=0.1711 | fpr=0.8528 | 11370.9 samples/s | 44.4 steps/s
Avg test loss: 5.04107, Avg test acc: 0.14760, Avg tpr: 0.17155, Avg fpr: 0.85283, total FA: 118414

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.11567 | acc=0.1353 | tpr=0.1327 | fpr=0.8646 | 5652.8 samples/s | 22.1 steps/s
[Step= 100] | Loss=6.06640 | acc=0.1365 | tpr=0.1279 | fpr=0.8633 | 8021.8 samples/s | 31.3 steps/s
[Step= 150] | Loss=6.07385 | acc=0.1349 | tpr=0.1239 | fpr=0.8649 | 7996.5 samples/s | 31.2 steps/s
[Step= 200] | Loss=6.06575 | acc=0.1347 | tpr=0.1224 | fpr=0.8650 | 8115.1 samples/s | 31.7 steps/s
[Step= 250] | Loss=6.06870 | acc=0.1346 | tpr=0.1205 | fpr=0.8651 | 7901.7 samples/s | 30.9 steps/s
[Step= 300] | Loss=6.07568 | acc=0.1344 | tpr=0.1244 | fpr=0.8655 | 8269.1 samples/s | 32.3 steps/s
[Step= 350] | Loss=6.07998 | acc=0.1337 | tpr=0.1202 | fpr=0.8660 | 8069.3 samples/s | 31.5 steps/s
[Step= 400] | Loss=6.07816 | acc=0.1338 | tpr=0.1253 | fpr=0.8660 | 7385.8 samples/s | 28.9 steps/s
[Step= 450] | Loss=6.07632 | acc=0.1340 | tpr=0.1256 | fpr=0.8659 | 8465.8 samples/s | 33.1 steps/s
[Step= 500] | Loss=6.07847 | acc=0.1339 | tpr=0.1264 | fpr=0.8660 | 8761.3 samples/s | 34.2 steps/s
[Step= 550] | Loss=6.07422 | acc=0.1341 | tpr=0.1257 | fpr=0.8658 | 9889.3 samples/s | 38.6 steps/s
Avg test loss: 6.07398, Avg test acc: 0.13395, Avg tpr: 0.12599, Avg fpr: 0.86590, total FA: 120229

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.52272 | acc=0.1418 | tpr=0.2257 | fpr=0.8597 | 5691.4 samples/s | 22.2 steps/s
[Step= 100] | Loss=5.47114 | acc=0.1426 | tpr=0.2154 | fpr=0.8588 | 7894.0 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.48658 | acc=0.1411 | tpr=0.2075 | fpr=0.8601 | 8324.8 samples/s | 32.5 steps/s
[Step= 200] | Loss=5.47798 | acc=0.1408 | tpr=0.2022 | fpr=0.8604 | 7895.9 samples/s | 30.8 steps/s
[Step= 250] | Loss=5.48345 | acc=0.1413 | tpr=0.2114 | fpr=0.8600 | 7878.7 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.48971 | acc=0.1405 | tpr=0.2124 | fpr=0.8609 | 7631.6 samples/s | 29.8 steps/s
[Step= 350] | Loss=5.49077 | acc=0.1401 | tpr=0.2016 | fpr=0.8610 | 8225.4 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.48885 | acc=0.1407 | tpr=0.2090 | fpr=0.8606 | 8749.4 samples/s | 34.2 steps/s
[Step= 450] | Loss=5.48769 | acc=0.1409 | tpr=0.2064 | fpr=0.8603 | 8334.8 samples/s | 32.6 steps/s
[Step= 500] | Loss=5.49091 | acc=0.1406 | tpr=0.2093 | fpr=0.8606 | 8069.0 samples/s | 31.5 steps/s
[Step= 550] | Loss=5.48797 | acc=0.1407 | tpr=0.2073 | fpr=0.8605 | 9370.9 samples/s | 36.6 steps/s
Avg test loss: 5.48756, Avg test acc: 0.14064, Avg tpr: 0.20761, Avg fpr: 0.86058, total FA: 119490

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.75880 | acc=0.1527 | tpr=0.1195 | fpr=0.8467 | 5356.9 samples/s | 20.9 steps/s
[Step= 100] | Loss=5.70503 | acc=0.1533 | tpr=0.1066 | fpr=0.8458 | 8112.2 samples/s | 31.7 steps/s
[Step= 150] | Loss=5.71920 | acc=0.1526 | tpr=0.1009 | fpr=0.8465 | 7800.0 samples/s | 30.5 steps/s
[Step= 200] | Loss=5.71685 | acc=0.1530 | tpr=0.0940 | fpr=0.8460 | 8560.8 samples/s | 33.4 steps/s
[Step= 250] | Loss=5.72397 | acc=0.1530 | tpr=0.0926 | fpr=0.8459 | 8144.3 samples/s | 31.8 steps/s
[Step= 300] | Loss=5.72774 | acc=0.1524 | tpr=0.0931 | fpr=0.8465 | 8140.6 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.73002 | acc=0.1522 | tpr=0.0908 | fpr=0.8467 | 7993.8 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.72868 | acc=0.1525 | tpr=0.0935 | fpr=0.8464 | 8164.2 samples/s | 31.9 steps/s
[Step= 450] | Loss=5.72783 | acc=0.1529 | tpr=0.0964 | fpr=0.8461 | 7527.3 samples/s | 29.4 steps/s
[Step= 500] | Loss=5.73059 | acc=0.1525 | tpr=0.0965 | fpr=0.8465 | 8670.6 samples/s | 33.9 steps/s
[Step= 550] | Loss=5.72676 | acc=0.1526 | tpr=0.0955 | fpr=0.8463 | 10684.1 samples/s | 41.7 steps/s
Avg test loss: 5.72644, Avg test acc: 0.15252, Avg tpr: 0.09588, Avg fpr: 0.84645, total FA: 117528

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10129 | acc=0.9813 | tpr=0.9292 | fpr=0.0177 | 5659.5 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.10203 | acc=0.9815 | tpr=0.9446 | fpr=0.0178 | 7372.3 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.10499 | acc=0.9810 | tpr=0.9496 | fpr=0.0185 | 8419.7 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.10737 | acc=0.9808 | tpr=0.9519 | fpr=0.0187 | 8091.6 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.10803 | acc=0.9806 | tpr=0.9467 | fpr=0.0188 | 8129.9 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.10916 | acc=0.9805 | tpr=0.9447 | fpr=0.0189 | 8167.6 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.10935 | acc=0.9805 | tpr=0.9468 | fpr=0.0189 | 8207.9 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.11058 | acc=0.9802 | tpr=0.9420 | fpr=0.0191 | 7958.4 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.11280 | acc=0.9799 | tpr=0.9396 | fpr=0.0194 | 7790.9 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.11189 | acc=0.9800 | tpr=0.9427 | fpr=0.0193 | 7715.2 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.11101 | acc=0.9801 | tpr=0.9427 | fpr=0.0192 | 11783.3 samples/s | 46.0 steps/s
Avg test loss: 0.11078, Avg test acc: 0.98016, Avg tpr: 0.94255, Avg fpr: 0.01916, total FA: 2660

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09553 | acc=0.9824 | tpr=0.8938 | fpr=0.0160 | 5704.6 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.09776 | acc=0.9826 | tpr=0.9041 | fpr=0.0160 | 7616.4 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.10018 | acc=0.9824 | tpr=0.9135 | fpr=0.0163 | 8465.3 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.10122 | acc=0.9824 | tpr=0.9202 | fpr=0.0165 | 8072.9 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.10118 | acc=0.9824 | tpr=0.9188 | fpr=0.0164 | 8090.3 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.10260 | acc=0.9823 | tpr=0.9193 | fpr=0.0166 | 8039.3 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.10271 | acc=0.9822 | tpr=0.9198 | fpr=0.0167 | 8069.3 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.10351 | acc=0.9821 | tpr=0.9158 | fpr=0.0167 | 7730.5 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.10548 | acc=0.9818 | tpr=0.9133 | fpr=0.0169 | 8288.7 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.10461 | acc=0.9819 | tpr=0.9154 | fpr=0.0169 | 8235.3 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.10392 | acc=0.9819 | tpr=0.9148 | fpr=0.0169 | 9950.5 samples/s | 38.9 steps/s
Avg test loss: 0.10374, Avg test acc: 0.98194, Avg tpr: 0.91442, Avg fpr: 0.01683, total FA: 2337

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11522 | acc=0.9781 | tpr=0.9381 | fpr=0.0212 | 5568.2 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.11659 | acc=0.9779 | tpr=0.9552 | fpr=0.0216 | 8008.9 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.12056 | acc=0.9776 | tpr=0.9568 | fpr=0.0221 | 8273.9 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.12222 | acc=0.9775 | tpr=0.9607 | fpr=0.0222 | 8141.1 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.12314 | acc=0.9774 | tpr=0.9581 | fpr=0.0222 | 8100.7 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.12411 | acc=0.9774 | tpr=0.9564 | fpr=0.0222 | 7639.5 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.12419 | acc=0.9774 | tpr=0.9587 | fpr=0.0222 | 8519.6 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.12509 | acc=0.9772 | tpr=0.9568 | fpr=0.0224 | 7832.5 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.12739 | acc=0.9768 | tpr=0.9547 | fpr=0.0228 | 8512.4 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.12641 | acc=0.9769 | tpr=0.9559 | fpr=0.0227 | 8363.4 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.12546 | acc=0.9772 | tpr=0.9550 | fpr=0.0224 | 9947.3 samples/s | 38.9 steps/s
Avg test loss: 0.12521, Avg test acc: 0.97717, Avg tpr: 0.95483, Avg fpr: 0.02242, total FA: 3113

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10944 | acc=0.9805 | tpr=0.9336 | fpr=0.0186 | 5740.4 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.11215 | acc=0.9802 | tpr=0.9424 | fpr=0.0191 | 7732.6 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.11445 | acc=0.9799 | tpr=0.9438 | fpr=0.0194 | 7953.8 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.11573 | acc=0.9799 | tpr=0.9475 | fpr=0.0195 | 8579.5 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.11647 | acc=0.9797 | tpr=0.9415 | fpr=0.0196 | 8362.0 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.11740 | acc=0.9796 | tpr=0.9389 | fpr=0.0196 | 7762.8 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.11724 | acc=0.9797 | tpr=0.9424 | fpr=0.0196 | 8446.2 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.11816 | acc=0.9796 | tpr=0.9371 | fpr=0.0197 | 7613.9 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.12031 | acc=0.9793 | tpr=0.9367 | fpr=0.0199 | 8201.2 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.11928 | acc=0.9795 | tpr=0.9392 | fpr=0.0198 | 8352.1 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.11842 | acc=0.9796 | tpr=0.9375 | fpr=0.0197 | 9558.0 samples/s | 37.3 steps/s
Avg test loss: 0.11820, Avg test acc: 0.97960, Avg tpr: 0.93740, Avg fpr: 0.01963, total FA: 2726

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10288 | acc=0.9808 | tpr=0.9159 | fpr=0.0181 | 5721.5 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.10558 | acc=0.9807 | tpr=0.9360 | fpr=0.0184 | 8113.7 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.10843 | acc=0.9804 | tpr=0.9424 | fpr=0.0189 | 7705.0 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.10978 | acc=0.9804 | tpr=0.9475 | fpr=0.0190 | 8142.2 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.11085 | acc=0.9803 | tpr=0.9450 | fpr=0.0191 | 8036.5 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.11204 | acc=0.9803 | tpr=0.9425 | fpr=0.0190 | 8145.9 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.11176 | acc=0.9803 | tpr=0.9455 | fpr=0.0191 | 8369.1 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.11267 | acc=0.9802 | tpr=0.9409 | fpr=0.0191 | 7769.8 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.11460 | acc=0.9799 | tpr=0.9396 | fpr=0.0193 | 8590.3 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.11376 | acc=0.9800 | tpr=0.9410 | fpr=0.0193 | 8045.7 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.11292 | acc=0.9802 | tpr=0.9395 | fpr=0.0191 | 9659.9 samples/s | 37.7 steps/s
Avg test loss: 0.11275, Avg test acc: 0.98017, Avg tpr: 0.93938, Avg fpr: 0.01909, total FA: 2651

server round 34/50

clients selected: [0 2 4 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=24001 Epoch=117.0] | Loss=0.04365 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.290 | L2-Norm(final)=13.437 | 5726.3 samples/s | 89.5 steps/s
[Step=24050 Epoch=117.3] | Loss=0.01653 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.290 | L2-Norm(final)=13.437 | 5075.2 samples/s | 79.3 steps/s
[Step=24100 Epoch=117.5] | Loss=0.01766 | Reg=0.00106 | acc=0.9688 | L2-Norm=10.290 | L2-Norm(final)=13.438 | 5628.5 samples/s | 87.9 steps/s
[Step=24150 Epoch=117.8] | Loss=0.01543 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.290 | L2-Norm(final)=13.440 | 5646.4 samples/s | 88.2 steps/s
[Step=24200 Epoch=118.0] | Loss=0.01577 | Reg=0.00106 | acc=0.9531 | L2-Norm=10.290 | L2-Norm(final)=13.443 | 8796.2 samples/s | 137.4 steps/s
[Step=24250 Epoch=118.2] | Loss=0.01546 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=13.446 | 2448.7 samples/s | 38.3 steps/s
[Step=24300 Epoch=118.5] | Loss=0.01565 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.290 | L2-Norm(final)=13.449 | 5752.3 samples/s | 89.9 steps/s
[Step=24350 Epoch=118.7] | Loss=0.01552 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.290 | L2-Norm(final)=13.452 | 5429.9 samples/s | 84.8 steps/s
[Step=24400 Epoch=119.0] | Loss=0.01588 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.290 | L2-Norm(final)=13.455 | 7813.7 samples/s | 122.1 steps/s
[Step=24450 Epoch=119.2] | Loss=0.01580 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=13.457 | 2574.8 samples/s | 40.2 steps/s
[Step=24500 Epoch=119.5] | Loss=0.01568 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=13.460 | 5475.8 samples/s | 85.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=24501 Epoch=119.5] | Loss=0.00353 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=13.485 | 6271.1 samples/s | 98.0 steps/s
[Step=24550 Epoch=119.7] | Loss=0.01551 | Reg=0.00106 | acc=0.9688 | L2-Norm=10.308 | L2-Norm(final)=13.487 | 4204.4 samples/s | 65.7 steps/s
[Step=24600 Epoch=120.0] | Loss=0.01572 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.324 | L2-Norm(final)=13.489 | 4837.1 samples/s | 75.6 steps/s
[Step=24650 Epoch=120.2] | Loss=0.01614 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.337 | L2-Norm(final)=13.490 | 4858.4 samples/s | 75.9 steps/s
[Step=24700 Epoch=120.4] | Loss=0.01464 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.349 | L2-Norm(final)=13.492 | 7003.8 samples/s | 109.4 steps/s
[Step=24750 Epoch=120.7] | Loss=0.01311 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=13.495 | 2276.5 samples/s | 35.6 steps/s
[Step=24800 Epoch=120.9] | Loss=0.01179 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.367 | L2-Norm(final)=13.498 | 4951.8 samples/s | 77.4 steps/s
[Step=24850 Epoch=121.2] | Loss=0.01083 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.374 | L2-Norm(final)=13.500 | 4770.6 samples/s | 74.5 steps/s
[Step=24900 Epoch=121.4] | Loss=0.01016 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.380 | L2-Norm(final)=13.504 | 6391.2 samples/s | 99.9 steps/s
[Step=24950 Epoch=121.7] | Loss=0.00950 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.386 | L2-Norm(final)=13.506 | 2355.9 samples/s | 36.8 steps/s
[Step=25000 Epoch=121.9] | Loss=0.00886 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.390 | L2-Norm(final)=13.509 | 4898.6 samples/s | 76.5 steps/s
[Step=25050 Epoch=122.1] | Loss=0.00861 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.395 | L2-Norm(final)=13.512 | 4811.9 samples/s | 75.2 steps/s
[Step=25100 Epoch=122.4] | Loss=0.00835 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.399 | L2-Norm(final)=13.514 | 5840.8 samples/s | 91.3 steps/s
[Step=25150 Epoch=122.6] | Loss=0.00803 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.402 | L2-Norm(final)=13.517 | 2400.5 samples/s | 37.5 steps/s
[Step=25200 Epoch=122.9] | Loss=0.00772 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=13.519 | 4906.8 samples/s | 76.7 steps/s
[Step=25250 Epoch=123.1] | Loss=0.00748 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.409 | L2-Norm(final)=13.521 | 4872.3 samples/s | 76.1 steps/s
[Step=25300 Epoch=123.4] | Loss=0.00726 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.412 | L2-Norm(final)=13.524 | 5367.6 samples/s | 83.9 steps/s
[Step=25350 Epoch=123.6] | Loss=0.00698 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.415 | L2-Norm(final)=13.526 | 2482.1 samples/s | 38.8 steps/s
[Step=25400 Epoch=123.9] | Loss=0.00690 | Reg=0.00109 | acc=0.9688 | L2-Norm=10.417 | L2-Norm(final)=13.528 | 4937.2 samples/s | 77.1 steps/s
[Step=25450 Epoch=124.1] | Loss=0.00676 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.420 | L2-Norm(final)=13.530 | 4786.4 samples/s | 74.8 steps/s
[Step=25500 Epoch=124.3] | Loss=0.00655 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.423 | L2-Norm(final)=13.532 | 5029.6 samples/s | 78.6 steps/s
[Step=25550 Epoch=124.6] | Loss=0.00646 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.425 | L2-Norm(final)=13.534 | 2638.2 samples/s | 41.2 steps/s
[Step=25600 Epoch=124.8] | Loss=0.00633 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.428 | L2-Norm(final)=13.536 | 4876.5 samples/s | 76.2 steps/s
[Step=25650 Epoch=125.1] | Loss=0.00615 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.430 | L2-Norm(final)=13.538 | 4893.6 samples/s | 76.5 steps/s
[Step=25700 Epoch=125.3] | Loss=0.00602 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.432 | L2-Norm(final)=13.540 | 4770.0 samples/s | 74.5 steps/s
[Step=25750 Epoch=125.6] | Loss=0.00589 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.434 | L2-Norm(final)=13.542 | 2612.7 samples/s | 40.8 steps/s
[Step=25800 Epoch=125.8] | Loss=0.00579 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.436 | L2-Norm(final)=13.543 | 4893.7 samples/s | 76.5 steps/s
[Step=25850 Epoch=126.0] | Loss=0.00568 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.438 | L2-Norm(final)=13.545 | 4799.7 samples/s | 75.0 steps/s
[Step=25900 Epoch=126.3] | Loss=0.00557 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.440 | L2-Norm(final)=13.547 | 4924.4 samples/s | 76.9 steps/s
[Step=25950 Epoch=126.5] | Loss=0.00549 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.442 | L2-Norm(final)=13.549 | 2611.9 samples/s | 40.8 steps/s
[Step=26000 Epoch=126.8] | Loss=0.00539 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.444 | L2-Norm(final)=13.551 | 4904.3 samples/s | 76.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step26000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=36001 Epoch=175.4] | Loss=0.01523 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.290 | L2-Norm(final)=14.392 | 5924.7 samples/s | 92.6 steps/s
[Step=36050 Epoch=175.7] | Loss=0.02245 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=14.390 | 4861.9 samples/s | 76.0 steps/s
[Step=36100 Epoch=175.9] | Loss=0.02042 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=14.386 | 5595.4 samples/s | 87.4 steps/s
[Step=36150 Epoch=176.1] | Loss=0.01895 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.291 | L2-Norm(final)=14.385 | 5637.9 samples/s | 88.1 steps/s
[Step=36200 Epoch=176.4] | Loss=0.01772 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.291 | L2-Norm(final)=14.386 | 8792.3 samples/s | 137.4 steps/s
[Step=36250 Epoch=176.6] | Loss=0.01773 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.291 | L2-Norm(final)=14.386 | 2434.7 samples/s | 38.0 steps/s
[Step=36300 Epoch=176.9] | Loss=0.01781 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.291 | L2-Norm(final)=14.386 | 5615.9 samples/s | 87.7 steps/s
[Step=36350 Epoch=177.1] | Loss=0.01779 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.291 | L2-Norm(final)=14.386 | 5646.2 samples/s | 88.2 steps/s
[Step=36400 Epoch=177.4] | Loss=0.01752 | Reg=0.00106 | acc=0.9688 | L2-Norm=10.291 | L2-Norm(final)=14.386 | 7723.5 samples/s | 120.7 steps/s
[Step=36450 Epoch=177.6] | Loss=0.01748 | Reg=0.00106 | acc=0.9688 | L2-Norm=10.291 | L2-Norm(final)=14.386 | 2566.1 samples/s | 40.1 steps/s
[Step=36500 Epoch=177.8] | Loss=0.01770 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.291 | L2-Norm(final)=14.387 | 5452.5 samples/s | 85.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=177.9] | Loss=0.00400 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.291 | L2-Norm(final)=14.391 | 5833.5 samples/s | 91.1 steps/s
[Step=36550 Epoch=178.1] | Loss=0.01965 | Reg=0.00106 | acc=0.9688 | L2-Norm=10.303 | L2-Norm(final)=14.389 | 4376.0 samples/s | 68.4 steps/s
[Step=36600 Epoch=178.3] | Loss=0.01735 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.317 | L2-Norm(final)=14.389 | 4960.2 samples/s | 77.5 steps/s
[Step=36650 Epoch=178.6] | Loss=0.01679 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.327 | L2-Norm(final)=14.390 | 4837.9 samples/s | 75.6 steps/s
[Step=36700 Epoch=178.8] | Loss=0.01509 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.335 | L2-Norm(final)=14.392 | 6840.2 samples/s | 106.9 steps/s
[Step=36750 Epoch=179.1] | Loss=0.01332 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.343 | L2-Norm(final)=14.394 | 2267.0 samples/s | 35.4 steps/s
[Step=36800 Epoch=179.3] | Loss=0.01206 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.350 | L2-Norm(final)=14.397 | 4848.3 samples/s | 75.8 steps/s
[Step=36850 Epoch=179.6] | Loss=0.01106 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.356 | L2-Norm(final)=14.400 | 4904.5 samples/s | 76.6 steps/s
[Step=36900 Epoch=179.8] | Loss=0.01055 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.362 | L2-Norm(final)=14.403 | 6250.9 samples/s | 97.7 steps/s
[Step=36950 Epoch=180.0] | Loss=0.00985 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.366 | L2-Norm(final)=14.405 | 2343.0 samples/s | 36.6 steps/s
[Step=37000 Epoch=180.3] | Loss=0.00917 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.371 | L2-Norm(final)=14.408 | 4878.7 samples/s | 76.2 steps/s
[Step=37050 Epoch=180.5] | Loss=0.00890 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.375 | L2-Norm(final)=14.410 | 4903.5 samples/s | 76.6 steps/s
[Step=37100 Epoch=180.8] | Loss=0.00854 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.379 | L2-Norm(final)=14.413 | 5788.6 samples/s | 90.4 steps/s
[Step=37150 Epoch=181.0] | Loss=0.00819 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.383 | L2-Norm(final)=14.415 | 2424.7 samples/s | 37.9 steps/s
[Step=37200 Epoch=181.3] | Loss=0.00781 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.386 | L2-Norm(final)=14.417 | 4851.7 samples/s | 75.8 steps/s
[Step=37250 Epoch=181.5] | Loss=0.00752 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.390 | L2-Norm(final)=14.419 | 4883.2 samples/s | 76.3 steps/s
[Step=37300 Epoch=181.7] | Loss=0.00733 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.393 | L2-Norm(final)=14.422 | 5408.7 samples/s | 84.5 steps/s
[Step=37350 Epoch=182.0] | Loss=0.00705 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=14.424 | 2519.3 samples/s | 39.4 steps/s
[Step=37400 Epoch=182.2] | Loss=0.00679 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=14.426 | 4901.5 samples/s | 76.6 steps/s
[Step=37450 Epoch=182.5] | Loss=0.00664 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.401 | L2-Norm(final)=14.428 | 4794.1 samples/s | 74.9 steps/s
[Step=37500 Epoch=182.7] | Loss=0.00645 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.404 | L2-Norm(final)=14.430 | 5008.9 samples/s | 78.3 steps/s
[Step=37550 Epoch=183.0] | Loss=0.00624 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.407 | L2-Norm(final)=14.432 | 2597.0 samples/s | 40.6 steps/s
[Step=37600 Epoch=183.2] | Loss=0.00608 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.409 | L2-Norm(final)=14.435 | 4827.5 samples/s | 75.4 steps/s
[Step=37650 Epoch=183.4] | Loss=0.00594 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.412 | L2-Norm(final)=14.437 | 4864.9 samples/s | 76.0 steps/s
[Step=37700 Epoch=183.7] | Loss=0.00582 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.414 | L2-Norm(final)=14.439 | 4840.1 samples/s | 75.6 steps/s
[Step=37750 Epoch=183.9] | Loss=0.00573 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.416 | L2-Norm(final)=14.441 | 2668.5 samples/s | 41.7 steps/s
[Step=37800 Epoch=184.2] | Loss=0.00557 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.418 | L2-Norm(final)=14.443 | 4837.0 samples/s | 75.6 steps/s
[Step=37850 Epoch=184.4] | Loss=0.00549 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.421 | L2-Norm(final)=14.444 | 5043.6 samples/s | 78.8 steps/s
[Step=37900 Epoch=184.7] | Loss=0.00537 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.423 | L2-Norm(final)=14.446 | 4675.6 samples/s | 73.1 steps/s
[Step=37950 Epoch=184.9] | Loss=0.00530 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.425 | L2-Norm(final)=14.448 | 2632.3 samples/s | 41.1 steps/s
[Step=38000 Epoch=185.2] | Loss=0.00520 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.426 | L2-Norm(final)=14.450 | 4862.8 samples/s | 76.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step38000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=46001 Epoch=225.6] | Loss=0.00462 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=15.623 | 5859.0 samples/s | 91.5 steps/s
[Step=46050 Epoch=225.8] | Loss=0.01360 | Reg=0.00106 | acc=0.9688 | L2-Norm=10.290 | L2-Norm(final)=15.623 | 4749.0 samples/s | 74.2 steps/s
[Step=46100 Epoch=226.1] | Loss=0.01637 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.290 | L2-Norm(final)=15.625 | 5636.4 samples/s | 88.1 steps/s
[Step=46150 Epoch=226.3] | Loss=0.01620 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=15.628 | 5855.2 samples/s | 91.5 steps/s
[Step=46200 Epoch=226.6] | Loss=0.01672 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=15.629 | 8494.7 samples/s | 132.7 steps/s
[Step=46250 Epoch=226.8] | Loss=0.01701 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.290 | L2-Norm(final)=15.631 | 2417.7 samples/s | 37.8 steps/s
[Step=46300 Epoch=227.0] | Loss=0.01670 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.290 | L2-Norm(final)=15.633 | 5675.6 samples/s | 88.7 steps/s
[Step=46350 Epoch=227.3] | Loss=0.01665 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=15.634 | 5540.8 samples/s | 86.6 steps/s
[Step=46400 Epoch=227.5] | Loss=0.01669 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=15.636 | 8305.5 samples/s | 129.8 steps/s
[Step=46450 Epoch=227.8] | Loss=0.01686 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=15.637 | 2443.4 samples/s | 38.2 steps/s
[Step=46500 Epoch=228.0] | Loss=0.01672 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=15.638 | 5542.3 samples/s | 86.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=46501 Epoch=228.0] | Loss=0.00167 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=15.652 | 6161.5 samples/s | 96.3 steps/s
[Step=46550 Epoch=228.3] | Loss=0.02006 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.301 | L2-Norm(final)=15.650 | 4274.1 samples/s | 66.8 steps/s
[Step=46600 Epoch=228.5] | Loss=0.01903 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.315 | L2-Norm(final)=15.648 | 4786.5 samples/s | 74.8 steps/s
[Step=46650 Epoch=228.8] | Loss=0.01810 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.325 | L2-Norm(final)=15.647 | 4905.6 samples/s | 76.7 steps/s
[Step=46700 Epoch=229.0] | Loss=0.01585 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.334 | L2-Norm(final)=15.648 | 7004.4 samples/s | 109.4 steps/s
[Step=46750 Epoch=229.3] | Loss=0.01375 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.342 | L2-Norm(final)=15.650 | 2240.5 samples/s | 35.0 steps/s
[Step=46800 Epoch=229.5] | Loss=0.01250 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.348 | L2-Norm(final)=15.653 | 4872.8 samples/s | 76.1 steps/s
[Step=46850 Epoch=229.7] | Loss=0.01138 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.354 | L2-Norm(final)=15.655 | 4840.4 samples/s | 75.6 steps/s
[Step=46900 Epoch=230.0] | Loss=0.01061 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=15.658 | 6708.4 samples/s | 104.8 steps/s
[Step=46950 Epoch=230.2] | Loss=0.00986 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.364 | L2-Norm(final)=15.660 | 2277.9 samples/s | 35.6 steps/s
[Step=47000 Epoch=230.5] | Loss=0.00936 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.367 | L2-Norm(final)=15.662 | 4845.6 samples/s | 75.7 steps/s
[Step=47050 Epoch=230.7] | Loss=0.00871 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.371 | L2-Norm(final)=15.664 | 4876.0 samples/s | 76.2 steps/s
[Step=47100 Epoch=231.0] | Loss=0.00833 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.374 | L2-Norm(final)=15.667 | 6286.2 samples/s | 98.2 steps/s
[Step=47150 Epoch=231.2] | Loss=0.00787 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.377 | L2-Norm(final)=15.669 | 2348.9 samples/s | 36.7 steps/s
[Step=47200 Epoch=231.5] | Loss=0.00745 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.380 | L2-Norm(final)=15.671 | 4920.1 samples/s | 76.9 steps/s
[Step=47250 Epoch=231.7] | Loss=0.00720 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.383 | L2-Norm(final)=15.673 | 4723.8 samples/s | 73.8 steps/s
[Step=47300 Epoch=232.0] | Loss=0.00692 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=15.675 | 5961.0 samples/s | 93.1 steps/s
[Step=47350 Epoch=232.2] | Loss=0.00674 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.388 | L2-Norm(final)=15.677 | 2414.3 samples/s | 37.7 steps/s
[Step=47400 Epoch=232.4] | Loss=0.00652 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.390 | L2-Norm(final)=15.679 | 4879.1 samples/s | 76.2 steps/s
[Step=47450 Epoch=232.7] | Loss=0.00626 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.392 | L2-Norm(final)=15.681 | 4838.3 samples/s | 75.6 steps/s
[Step=47500 Epoch=232.9] | Loss=0.00609 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.394 | L2-Norm(final)=15.683 | 5630.7 samples/s | 88.0 steps/s
[Step=47550 Epoch=233.2] | Loss=0.00588 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=15.684 | 2476.7 samples/s | 38.7 steps/s
[Step=47600 Epoch=233.4] | Loss=0.00574 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=15.686 | 4763.3 samples/s | 74.4 steps/s
[Step=47650 Epoch=233.7] | Loss=0.00564 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.400 | L2-Norm(final)=15.688 | 4811.1 samples/s | 75.2 steps/s
[Step=47700 Epoch=233.9] | Loss=0.00551 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.402 | L2-Norm(final)=15.690 | 5346.1 samples/s | 83.5 steps/s
[Step=47750 Epoch=234.2] | Loss=0.00537 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=15.692 | 2492.8 samples/s | 39.0 steps/s
[Step=47800 Epoch=234.4] | Loss=0.00524 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=15.693 | 4872.8 samples/s | 76.1 steps/s
[Step=47850 Epoch=234.6] | Loss=0.00510 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.407 | L2-Norm(final)=15.695 | 4923.6 samples/s | 76.9 steps/s
[Step=47900 Epoch=234.9] | Loss=0.00498 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.409 | L2-Norm(final)=15.697 | 5040.5 samples/s | 78.8 steps/s
[Step=47950 Epoch=235.1] | Loss=0.00489 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.410 | L2-Norm(final)=15.699 | 2588.9 samples/s | 40.5 steps/s
[Step=48000 Epoch=235.4] | Loss=0.00481 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.412 | L2-Norm(final)=15.701 | 4752.5 samples/s | 74.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step48000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=324.7] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=16.732 | 5525.7 samples/s | 86.3 steps/s
[Step=34050 Epoch=325.2] | Loss=0.00048 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.288 | L2-Norm(final)=16.724 | 4689.9 samples/s | 73.3 steps/s
[Step=34100 Epoch=325.6] | Loss=0.00041 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=16.713 | 8274.1 samples/s | 129.3 steps/s
[Step=34150 Epoch=326.1] | Loss=0.00038 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=16.707 | 2348.4 samples/s | 36.7 steps/s
[Step=34200 Epoch=326.6] | Loss=0.00036 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=16.706 | 7431.6 samples/s | 116.1 steps/s
[Step=34250 Epoch=327.1] | Loss=0.00039 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=16.702 | 2399.9 samples/s | 37.5 steps/s
[Step=34300 Epoch=327.5] | Loss=0.00037 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=16.699 | 7000.1 samples/s | 109.4 steps/s
[Step=34350 Epoch=328.0] | Loss=0.00037 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=16.697 | 2475.2 samples/s | 38.7 steps/s
[Step=34400 Epoch=328.5] | Loss=0.00035 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=16.697 | 6270.1 samples/s | 98.0 steps/s
[Step=34450 Epoch=329.0] | Loss=0.00034 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=16.697 | 2537.6 samples/s | 39.7 steps/s
[Step=34500 Epoch=329.5] | Loss=0.00034 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=16.698 | 5894.0 samples/s | 92.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=329.5] | Loss=0.00002 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=16.707 | 5709.1 samples/s | 89.2 steps/s
[Step=34550 Epoch=329.9] | Loss=0.00006 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=16.714 | 4150.3 samples/s | 64.8 steps/s
[Step=34600 Epoch=330.4] | Loss=0.00004 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.282 | L2-Norm(final)=16.718 | 6785.5 samples/s | 106.0 steps/s
[Step=34650 Epoch=330.9] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.272 | L2-Norm(final)=16.720 | 2176.7 samples/s | 34.0 steps/s
[Step=34700 Epoch=331.4] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.261 | L2-Norm(final)=16.721 | 6212.0 samples/s | 97.1 steps/s
[Step=34750 Epoch=331.8] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.249 | L2-Norm(final)=16.721 | 2211.4 samples/s | 34.6 steps/s
[Step=34800 Epoch=332.3] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.236 | L2-Norm(final)=16.722 | 5808.8 samples/s | 90.8 steps/s
[Step=34850 Epoch=332.8] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.224 | L2-Norm(final)=16.723 | 2341.0 samples/s | 36.6 steps/s
[Step=34900 Epoch=333.3] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.212 | L2-Norm(final)=16.723 | 5275.2 samples/s | 82.4 steps/s
[Step=34950 Epoch=333.8] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.200 | L2-Norm(final)=16.724 | 2365.6 samples/s | 37.0 steps/s
[Step=35000 Epoch=334.2] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.187 | L2-Norm(final)=16.724 | 5058.6 samples/s | 79.0 steps/s
[Step=35050 Epoch=334.7] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.175 | L2-Norm(final)=16.724 | 2428.7 samples/s | 37.9 steps/s
[Step=35100 Epoch=335.2] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.163 | L2-Norm(final)=16.725 | 4707.5 samples/s | 73.6 steps/s
[Step=35150 Epoch=335.7] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.151 | L2-Norm(final)=16.725 | 2538.4 samples/s | 39.7 steps/s
[Step=35200 Epoch=336.1] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.139 | L2-Norm(final)=16.726 | 4670.5 samples/s | 73.0 steps/s
[Step=35250 Epoch=336.6] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.126 | L2-Norm(final)=16.726 | 2572.4 samples/s | 40.2 steps/s
[Step=35300 Epoch=337.1] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.114 | L2-Norm(final)=16.726 | 4550.2 samples/s | 71.1 steps/s
[Step=35350 Epoch=337.6] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.102 | L2-Norm(final)=16.727 | 2560.3 samples/s | 40.0 steps/s
[Step=35400 Epoch=338.0] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.090 | L2-Norm(final)=16.727 | 4590.4 samples/s | 71.7 steps/s
[Step=35450 Epoch=338.5] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.077 | L2-Norm(final)=16.727 | 2542.9 samples/s | 39.7 steps/s
[Step=35500 Epoch=339.0] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.065 | L2-Norm(final)=16.728 | 4622.8 samples/s | 72.2 steps/s
[Step=35550 Epoch=339.5] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.053 | L2-Norm(final)=16.728 | 7473.7 samples/s | 116.8 steps/s
[Step=35600 Epoch=340.0] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.040 | L2-Norm(final)=16.729 | 2142.4 samples/s | 33.5 steps/s
[Step=35650 Epoch=340.4] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.028 | L2-Norm(final)=16.729 | 6567.3 samples/s | 102.6 steps/s
[Step=35700 Epoch=340.9] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=16.729 | 2164.1 samples/s | 33.8 steps/s
[Step=35750 Epoch=341.4] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.002 | L2-Norm(final)=16.730 | 6301.7 samples/s | 98.5 steps/s
[Step=35800 Epoch=341.9] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.990 | L2-Norm(final)=16.730 | 2243.9 samples/s | 35.1 steps/s
[Step=35850 Epoch=342.3] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.977 | L2-Norm(final)=16.730 | 5756.7 samples/s | 89.9 steps/s
[Step=35900 Epoch=342.8] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.964 | L2-Norm(final)=16.731 | 2320.8 samples/s | 36.3 steps/s
[Step=35950 Epoch=343.3] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.952 | L2-Norm(final)=16.731 | 5388.8 samples/s | 84.2 steps/s
[Step=36000 Epoch=343.8] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.939 | L2-Norm(final)=16.732 | 2410.1 samples/s | 37.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step36000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=320.4] | Loss=0.00018 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=15.898 | 6220.1 samples/s | 97.2 steps/s
[Step=34050 Epoch=320.8] | Loss=0.00061 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=15.901 | 4367.1 samples/s | 68.2 steps/s
[Step=34100 Epoch=321.3] | Loss=0.00056 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=15.912 | 7952.4 samples/s | 124.3 steps/s
[Step=34150 Epoch=321.8] | Loss=0.00055 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=15.921 | 2345.6 samples/s | 36.7 steps/s
[Step=34200 Epoch=322.3] | Loss=0.00052 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=15.931 | 7086.6 samples/s | 110.7 steps/s
[Step=34250 Epoch=322.7] | Loss=0.00053 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=15.939 | 2469.2 samples/s | 38.6 steps/s
[Step=34300 Epoch=323.2] | Loss=0.00054 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.286 | L2-Norm(final)=15.946 | 6346.4 samples/s | 99.2 steps/s
[Step=34350 Epoch=323.7] | Loss=0.00054 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.286 | L2-Norm(final)=15.953 | 2551.8 samples/s | 39.9 steps/s
[Step=34400 Epoch=324.1] | Loss=0.00053 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.286 | L2-Norm(final)=15.961 | 5680.2 samples/s | 88.8 steps/s
[Step=34450 Epoch=324.6] | Loss=0.00052 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.286 | L2-Norm(final)=15.969 | 2723.4 samples/s | 42.6 steps/s
[Step=34500 Epoch=325.1] | Loss=0.00054 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.286 | L2-Norm(final)=15.976 | 5625.6 samples/s | 87.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=325.1] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.286 | L2-Norm(final)=16.054 | 5645.9 samples/s | 88.2 steps/s
[Step=34550 Epoch=325.6] | Loss=0.00126 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.304 | L2-Norm(final)=16.055 | 4114.3 samples/s | 64.3 steps/s
[Step=34600 Epoch=326.0] | Loss=0.00080 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.321 | L2-Norm(final)=16.056 | 6655.9 samples/s | 104.0 steps/s
[Step=34650 Epoch=326.5] | Loss=0.00054 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.327 | L2-Norm(final)=16.058 | 2213.4 samples/s | 34.6 steps/s
[Step=34700 Epoch=327.0] | Loss=0.00041 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.328 | L2-Norm(final)=16.059 | 5883.1 samples/s | 91.9 steps/s
[Step=34750 Epoch=327.4] | Loss=0.00033 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.327 | L2-Norm(final)=16.060 | 2286.0 samples/s | 35.7 steps/s
[Step=34800 Epoch=327.9] | Loss=0.00027 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.325 | L2-Norm(final)=16.061 | 5372.2 samples/s | 83.9 steps/s
[Step=34850 Epoch=328.4] | Loss=0.00024 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.322 | L2-Norm(final)=16.062 | 2397.1 samples/s | 37.5 steps/s
[Step=34900 Epoch=328.9] | Loss=0.00021 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.319 | L2-Norm(final)=16.062 | 4893.1 samples/s | 76.5 steps/s
[Step=34950 Epoch=329.3] | Loss=0.00018 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.315 | L2-Norm(final)=16.063 | 2517.9 samples/s | 39.3 steps/s
[Step=35000 Epoch=329.8] | Loss=0.00017 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.311 | L2-Norm(final)=16.063 | 4550.8 samples/s | 71.1 steps/s
[Step=35050 Epoch=330.3] | Loss=0.00015 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.308 | L2-Norm(final)=16.064 | 2580.5 samples/s | 40.3 steps/s
[Step=35100 Epoch=330.7] | Loss=0.00014 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.304 | L2-Norm(final)=16.064 | 4656.1 samples/s | 72.8 steps/s
[Step=35150 Epoch=331.2] | Loss=0.00013 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.300 | L2-Norm(final)=16.065 | 2587.2 samples/s | 40.4 steps/s
[Step=35200 Epoch=331.7] | Loss=0.00012 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=16.065 | 4546.7 samples/s | 71.0 steps/s
[Step=35250 Epoch=332.2] | Loss=0.00011 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.291 | L2-Norm(final)=16.065 | 2778.0 samples/s | 43.4 steps/s
[Step=35300 Epoch=332.6] | Loss=0.00011 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=16.066 | 4042.1 samples/s | 63.2 steps/s
[Step=35350 Epoch=333.1] | Loss=0.00010 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.283 | L2-Norm(final)=16.066 | 6768.4 samples/s | 105.8 steps/s
[Step=35400 Epoch=333.6] | Loss=0.00009 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.279 | L2-Norm(final)=16.067 | 2209.8 samples/s | 34.5 steps/s
[Step=35450 Epoch=334.0] | Loss=0.00009 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.274 | L2-Norm(final)=16.067 | 5964.6 samples/s | 93.2 steps/s
[Step=35500 Epoch=334.5] | Loss=0.00008 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.270 | L2-Norm(final)=16.067 | 2286.5 samples/s | 35.7 steps/s
[Step=35550 Epoch=335.0] | Loss=0.00008 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.265 | L2-Norm(final)=16.068 | 5362.9 samples/s | 83.8 steps/s
[Step=35600 Epoch=335.5] | Loss=0.00008 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.261 | L2-Norm(final)=16.068 | 2397.4 samples/s | 37.5 steps/s
[Step=35650 Epoch=335.9] | Loss=0.00007 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.256 | L2-Norm(final)=16.068 | 4907.7 samples/s | 76.7 steps/s
[Step=35700 Epoch=336.4] | Loss=0.00007 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.252 | L2-Norm(final)=16.069 | 2506.5 samples/s | 39.2 steps/s
[Step=35750 Epoch=336.9] | Loss=0.00007 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=16.069 | 4525.0 samples/s | 70.7 steps/s
[Step=35800 Epoch=337.3] | Loss=0.00007 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.242 | L2-Norm(final)=16.069 | 2611.7 samples/s | 40.8 steps/s
[Step=35850 Epoch=337.8] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.238 | L2-Norm(final)=16.070 | 4614.3 samples/s | 72.1 steps/s
[Step=35900 Epoch=338.3] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.233 | L2-Norm(final)=16.070 | 2580.1 samples/s | 40.3 steps/s
[Step=35950 Epoch=338.8] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=16.070 | 4704.0 samples/s | 73.5 steps/s
[Step=36000 Epoch=339.2] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.223 | L2-Norm(final)=16.071 | 2661.4 samples/s | 41.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08215 | acc=0.9627 | tpr=0.9710 | fpr=0.0553 | 5506.6 samples/s | 21.5 steps/s
Avg test loss: 0.08948, Avg test acc: 0.96113, Avg tpr: 0.97016, Avg fpr: 0.05871, total FA: 458

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08757 | acc=0.9652 | tpr=0.9758 | fpr=0.0577 | 5656.5 samples/s | 22.1 steps/s
Avg test loss: 0.09537, Avg test acc: 0.96378, Avg tpr: 0.97389, Avg fpr: 0.05845, total FA: 456

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08864 | acc=0.9616 | tpr=0.9717 | fpr=0.0602 | 5657.9 samples/s | 22.1 steps/s
Avg test loss: 0.09522, Avg test acc: 0.96101, Avg tpr: 0.96923, Avg fpr: 0.05704, total FA: 445

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08597 | acc=0.9654 | tpr=0.9783 | fpr=0.0627 | 5694.2 samples/s | 22.2 steps/s
Avg test loss: 0.09467, Avg test acc: 0.96394, Avg tpr: 0.97791, Avg fpr: 0.06679, total FA: 521

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08586 | acc=0.9645 | tpr=0.9764 | fpr=0.0612 | 5587.0 samples/s | 21.8 steps/s
Avg test loss: 0.09588, Avg test acc: 0.96346, Avg tpr: 0.97511, Avg fpr: 0.06217, total FA: 485

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.38077 | acc=0.2558 | tpr=0.0060 | fpr=0.2019 | 5812.5 samples/s | 22.7 steps/s
Avg test loss: 5.38527, Avg test acc: 0.25479, Avg tpr: 0.00629, Avg fpr: 0.19869, total FA: 1550

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.60507 | acc=0.2891 | tpr=0.0080 | fpr=0.1003 | 5580.0 samples/s | 21.8 steps/s
Avg test loss: 4.61595, Avg test acc: 0.28596, Avg tpr: 0.00699, Avg fpr: 0.10050, total FA: 784

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.29338 | acc=0.2238 | tpr=0.0134 | fpr=0.3191 | 5638.3 samples/s | 22.0 steps/s
Avg test loss: 5.29723, Avg test acc: 0.22374, Avg tpr: 0.01445, Avg fpr: 0.31599, total FA: 2465

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.86333 | acc=0.2410 | tpr=0.0102 | fpr=0.2577 | 5531.4 samples/s | 21.6 steps/s
Avg test loss: 5.86895, Avg test acc: 0.23968, Avg tpr: 0.01032, Avg fpr: 0.25586, total FA: 1996

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.59919 | acc=0.2459 | tpr=0.0084 | fpr=0.2384 | 5683.4 samples/s | 22.2 steps/s
Avg test loss: 5.60686, Avg test acc: 0.24361, Avg tpr: 0.00839, Avg fpr: 0.23907, total FA: 1865

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.16798 | acc=0.1600 | tpr=0.1947 | fpr=0.8406 | 5349.4 samples/s | 20.9 steps/s
[Step= 100] | Loss=5.12085 | acc=0.1605 | tpr=0.1791 | fpr=0.8398 | 8440.2 samples/s | 33.0 steps/s
[Step= 150] | Loss=5.13534 | acc=0.1597 | tpr=0.1772 | fpr=0.8407 | 8343.4 samples/s | 32.6 steps/s
[Step= 200] | Loss=5.12958 | acc=0.1594 | tpr=0.1770 | fpr=0.8409 | 8229.2 samples/s | 32.1 steps/s
[Step= 250] | Loss=5.13447 | acc=0.1598 | tpr=0.1773 | fpr=0.8406 | 8038.6 samples/s | 31.4 steps/s
[Step= 300] | Loss=5.13864 | acc=0.1591 | tpr=0.1840 | fpr=0.8414 | 8089.0 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.14160 | acc=0.1589 | tpr=0.1753 | fpr=0.8414 | 7516.0 samples/s | 29.4 steps/s
[Step= 400] | Loss=5.14065 | acc=0.1594 | tpr=0.1778 | fpr=0.8410 | 8538.2 samples/s | 33.4 steps/s
[Step= 450] | Loss=5.14025 | acc=0.1596 | tpr=0.1767 | fpr=0.8407 | 7877.1 samples/s | 30.8 steps/s
[Step= 500] | Loss=5.14302 | acc=0.1596 | tpr=0.1819 | fpr=0.8408 | 8648.3 samples/s | 33.8 steps/s
[Step= 550] | Loss=5.14097 | acc=0.1598 | tpr=0.1803 | fpr=0.8406 | 9374.8 samples/s | 36.6 steps/s
Avg test loss: 5.14074, Avg test acc: 0.15968, Avg tpr: 0.18067, Avg fpr: 0.84070, total FA: 116730

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.06967 | acc=0.1476 | tpr=0.2168 | fpr=0.8537 | 5688.9 samples/s | 22.2 steps/s
[Step= 100] | Loss=5.02220 | acc=0.1504 | tpr=0.1898 | fpr=0.8504 | 7880.6 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.03774 | acc=0.1479 | tpr=0.1873 | fpr=0.8528 | 7944.0 samples/s | 31.0 steps/s
[Step= 200] | Loss=5.03338 | acc=0.1479 | tpr=0.1814 | fpr=0.8528 | 8316.5 samples/s | 32.5 steps/s
[Step= 250] | Loss=5.03765 | acc=0.1476 | tpr=0.1755 | fpr=0.8529 | 8089.5 samples/s | 31.6 steps/s
[Step= 300] | Loss=5.04043 | acc=0.1471 | tpr=0.1789 | fpr=0.8535 | 8196.9 samples/s | 32.0 steps/s
[Step= 350] | Loss=5.04136 | acc=0.1469 | tpr=0.1666 | fpr=0.8534 | 7548.7 samples/s | 29.5 steps/s
[Step= 400] | Loss=5.03981 | acc=0.1477 | tpr=0.1718 | fpr=0.8527 | 7700.8 samples/s | 30.1 steps/s
[Step= 450] | Loss=5.03933 | acc=0.1479 | tpr=0.1714 | fpr=0.8526 | 8642.9 samples/s | 33.8 steps/s
[Step= 500] | Loss=5.04230 | acc=0.1475 | tpr=0.1718 | fpr=0.8530 | 8246.5 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.04088 | acc=0.1477 | tpr=0.1711 | fpr=0.8528 | 10197.7 samples/s | 39.8 steps/s
Avg test loss: 5.04107, Avg test acc: 0.14760, Avg tpr: 0.17155, Avg fpr: 0.85283, total FA: 118414

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.96303 | acc=0.1412 | tpr=0.1106 | fpr=0.8582 | 5554.9 samples/s | 21.7 steps/s
[Step= 100] | Loss=5.90819 | acc=0.1428 | tpr=0.1045 | fpr=0.8565 | 8545.7 samples/s | 33.4 steps/s
[Step= 150] | Loss=5.91675 | acc=0.1410 | tpr=0.1052 | fpr=0.8583 | 7362.2 samples/s | 28.8 steps/s
[Step= 200] | Loss=5.90866 | acc=0.1412 | tpr=0.1060 | fpr=0.8581 | 8390.2 samples/s | 32.8 steps/s
[Step= 250] | Loss=5.91082 | acc=0.1417 | tpr=0.1074 | fpr=0.8577 | 8309.7 samples/s | 32.5 steps/s
[Step= 300] | Loss=5.91670 | acc=0.1414 | tpr=0.1076 | fpr=0.8579 | 7686.2 samples/s | 30.0 steps/s
[Step= 350] | Loss=5.92005 | acc=0.1408 | tpr=0.1021 | fpr=0.8585 | 7769.4 samples/s | 30.3 steps/s
[Step= 400] | Loss=5.91756 | acc=0.1412 | tpr=0.1078 | fpr=0.8582 | 8183.1 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.91575 | acc=0.1413 | tpr=0.1071 | fpr=0.8581 | 8309.6 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.91724 | acc=0.1413 | tpr=0.1075 | fpr=0.8580 | 7788.2 samples/s | 30.4 steps/s
[Step= 550] | Loss=5.91370 | acc=0.1415 | tpr=0.1070 | fpr=0.8579 | 11189.2 samples/s | 43.7 steps/s
Avg test loss: 5.91355, Avg test acc: 0.14140, Avg tpr: 0.10737, Avg fpr: 0.85798, total FA: 119129

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.52272 | acc=0.1418 | tpr=0.2257 | fpr=0.8597 | 5568.8 samples/s | 21.8 steps/s
[Step= 100] | Loss=5.47114 | acc=0.1426 | tpr=0.2154 | fpr=0.8588 | 7666.3 samples/s | 29.9 steps/s
[Step= 150] | Loss=5.48658 | acc=0.1411 | tpr=0.2075 | fpr=0.8601 | 8030.3 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.47798 | acc=0.1408 | tpr=0.2022 | fpr=0.8604 | 7999.3 samples/s | 31.2 steps/s
[Step= 250] | Loss=5.48345 | acc=0.1413 | tpr=0.2114 | fpr=0.8600 | 7939.0 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.48971 | acc=0.1405 | tpr=0.2124 | fpr=0.8609 | 8083.0 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.49077 | acc=0.1401 | tpr=0.2016 | fpr=0.8610 | 8052.9 samples/s | 31.5 steps/s
[Step= 400] | Loss=5.48885 | acc=0.1407 | tpr=0.2090 | fpr=0.8606 | 8189.1 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.48769 | acc=0.1409 | tpr=0.2064 | fpr=0.8603 | 8061.7 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.49091 | acc=0.1406 | tpr=0.2093 | fpr=0.8606 | 8120.8 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.48797 | acc=0.1407 | tpr=0.2073 | fpr=0.8605 | 11172.8 samples/s | 43.6 steps/s
Avg test loss: 5.48756, Avg test acc: 0.14064, Avg tpr: 0.20761, Avg fpr: 0.86058, total FA: 119490

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.37849 | acc=0.1341 | tpr=0.1416 | fpr=0.8660 | 5577.3 samples/s | 21.8 steps/s
[Step= 100] | Loss=6.32037 | acc=0.1354 | tpr=0.1279 | fpr=0.8644 | 8047.0 samples/s | 31.4 steps/s
[Step= 150] | Loss=6.33844 | acc=0.1347 | tpr=0.1254 | fpr=0.8651 | 7525.3 samples/s | 29.4 steps/s
[Step= 200] | Loss=6.33550 | acc=0.1353 | tpr=0.1191 | fpr=0.8644 | 8250.0 samples/s | 32.2 steps/s
[Step= 250] | Loss=6.34216 | acc=0.1356 | tpr=0.1205 | fpr=0.8642 | 8132.1 samples/s | 31.8 steps/s
[Step= 300] | Loss=6.34655 | acc=0.1354 | tpr=0.1215 | fpr=0.8643 | 8069.5 samples/s | 31.5 steps/s
[Step= 350] | Loss=6.34956 | acc=0.1349 | tpr=0.1165 | fpr=0.8647 | 8136.7 samples/s | 31.8 steps/s
[Step= 400] | Loss=6.34737 | acc=0.1355 | tpr=0.1220 | fpr=0.8643 | 8151.7 samples/s | 31.8 steps/s
[Step= 450] | Loss=6.34674 | acc=0.1359 | tpr=0.1241 | fpr=0.8639 | 8121.0 samples/s | 31.7 steps/s
[Step= 500] | Loss=6.35044 | acc=0.1357 | tpr=0.1256 | fpr=0.8641 | 8300.6 samples/s | 32.4 steps/s
[Step= 550] | Loss=6.34653 | acc=0.1356 | tpr=0.1246 | fpr=0.8642 | 9921.3 samples/s | 38.8 steps/s
Avg test loss: 6.34598, Avg test acc: 0.13547, Avg tpr: 0.12480, Avg fpr: 0.86434, total FA: 120012

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10129 | acc=0.9813 | tpr=0.9292 | fpr=0.0177 | 5732.0 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.10203 | acc=0.9815 | tpr=0.9446 | fpr=0.0178 | 7761.9 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.10499 | acc=0.9810 | tpr=0.9496 | fpr=0.0185 | 8281.6 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.10737 | acc=0.9808 | tpr=0.9519 | fpr=0.0187 | 7443.0 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.10803 | acc=0.9806 | tpr=0.9467 | fpr=0.0188 | 9304.8 samples/s | 36.3 steps/s
[Step= 300] | Loss=0.10916 | acc=0.9805 | tpr=0.9447 | fpr=0.0189 | 8048.0 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.10935 | acc=0.9805 | tpr=0.9468 | fpr=0.0189 | 7342.4 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.11058 | acc=0.9802 | tpr=0.9420 | fpr=0.0191 | 8294.6 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.11280 | acc=0.9799 | tpr=0.9396 | fpr=0.0194 | 8339.4 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.11189 | acc=0.9800 | tpr=0.9427 | fpr=0.0193 | 8253.9 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.11101 | acc=0.9801 | tpr=0.9427 | fpr=0.0192 | 9765.4 samples/s | 38.1 steps/s
Avg test loss: 0.11078, Avg test acc: 0.98016, Avg tpr: 0.94255, Avg fpr: 0.01916, total FA: 2660

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09553 | acc=0.9824 | tpr=0.8938 | fpr=0.0160 | 5809.6 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.09776 | acc=0.9826 | tpr=0.9041 | fpr=0.0160 | 7722.2 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.10018 | acc=0.9824 | tpr=0.9135 | fpr=0.0163 | 7838.7 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.10122 | acc=0.9824 | tpr=0.9202 | fpr=0.0165 | 8507.8 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.10118 | acc=0.9824 | tpr=0.9188 | fpr=0.0164 | 8324.3 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.10260 | acc=0.9823 | tpr=0.9193 | fpr=0.0166 | 7420.4 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.10271 | acc=0.9822 | tpr=0.9198 | fpr=0.0167 | 8158.5 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.10351 | acc=0.9821 | tpr=0.9158 | fpr=0.0167 | 8024.7 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.10548 | acc=0.9818 | tpr=0.9133 | fpr=0.0169 | 7691.9 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.10461 | acc=0.9819 | tpr=0.9154 | fpr=0.0169 | 8363.6 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.10392 | acc=0.9819 | tpr=0.9148 | fpr=0.0169 | 10794.4 samples/s | 42.2 steps/s
Avg test loss: 0.10374, Avg test acc: 0.98194, Avg tpr: 0.91442, Avg fpr: 0.01683, total FA: 2337

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12285 | acc=0.9775 | tpr=0.9381 | fpr=0.0218 | 5749.6 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.12432 | acc=0.9777 | tpr=0.9574 | fpr=0.0220 | 7647.9 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.12825 | acc=0.9773 | tpr=0.9597 | fpr=0.0224 | 8390.0 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.13018 | acc=0.9773 | tpr=0.9628 | fpr=0.0225 | 8132.0 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.13121 | acc=0.9772 | tpr=0.9590 | fpr=0.0225 | 7649.4 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.13241 | acc=0.9771 | tpr=0.9585 | fpr=0.0225 | 8231.8 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.13248 | acc=0.9770 | tpr=0.9612 | fpr=0.0227 | 7896.8 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.13333 | acc=0.9767 | tpr=0.9584 | fpr=0.0229 | 7315.3 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.13571 | acc=0.9763 | tpr=0.9562 | fpr=0.0233 | 8241.0 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.13481 | acc=0.9764 | tpr=0.9573 | fpr=0.0233 | 8566.7 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.13364 | acc=0.9765 | tpr=0.9570 | fpr=0.0231 | 10962.8 samples/s | 42.8 steps/s
Avg test loss: 0.13337, Avg test acc: 0.97655, Avg tpr: 0.95681, Avg fpr: 0.02309, total FA: 3206

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10153 | acc=0.9819 | tpr=0.9204 | fpr=0.0170 | 5691.8 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.10469 | acc=0.9812 | tpr=0.9190 | fpr=0.0177 | 8017.9 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.10767 | acc=0.9808 | tpr=0.9222 | fpr=0.0181 | 8258.9 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.10850 | acc=0.9809 | tpr=0.9268 | fpr=0.0182 | 7800.2 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.10840 | acc=0.9810 | tpr=0.9231 | fpr=0.0179 | 7758.0 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.10966 | acc=0.9810 | tpr=0.9229 | fpr=0.0179 | 8359.7 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.10973 | acc=0.9809 | tpr=0.9261 | fpr=0.0181 | 8779.1 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.11105 | acc=0.9807 | tpr=0.9212 | fpr=0.0182 | 7776.9 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.11295 | acc=0.9803 | tpr=0.9211 | fpr=0.0186 | 8211.1 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.11204 | acc=0.9805 | tpr=0.9220 | fpr=0.0185 | 8015.9 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.11159 | acc=0.9805 | tpr=0.9192 | fpr=0.0184 | 9535.4 samples/s | 37.2 steps/s
Avg test loss: 0.11134, Avg test acc: 0.98051, Avg tpr: 0.91918, Avg fpr: 0.01838, total FA: 2552

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10288 | acc=0.9808 | tpr=0.9159 | fpr=0.0181 | 5684.1 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.10558 | acc=0.9807 | tpr=0.9360 | fpr=0.0184 | 7808.1 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.10843 | acc=0.9804 | tpr=0.9424 | fpr=0.0189 | 8213.9 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.10978 | acc=0.9804 | tpr=0.9475 | fpr=0.0190 | 8247.2 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.11085 | acc=0.9803 | tpr=0.9450 | fpr=0.0191 | 8102.5 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.11204 | acc=0.9803 | tpr=0.9425 | fpr=0.0190 | 7915.8 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.11176 | acc=0.9803 | tpr=0.9455 | fpr=0.0191 | 7333.0 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.11267 | acc=0.9802 | tpr=0.9409 | fpr=0.0191 | 8201.9 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.11460 | acc=0.9799 | tpr=0.9396 | fpr=0.0193 | 7917.7 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.11376 | acc=0.9800 | tpr=0.9410 | fpr=0.0193 | 7953.4 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.11292 | acc=0.9802 | tpr=0.9395 | fpr=0.0191 | 11851.9 samples/s | 46.3 steps/s
Avg test loss: 0.11275, Avg test acc: 0.98017, Avg tpr: 0.93938, Avg fpr: 0.01909, total FA: 2651

server round 35/50

clients selected: [1 5 6 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=46001 Epoch=224.5] | Loss=0.00318 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.229 | L2-Norm(final)=15.514 | 6008.2 samples/s | 93.9 steps/s
[Step=46050 Epoch=224.7] | Loss=0.01661 | Reg=0.00105 | acc=0.9375 | L2-Norm=10.228 | L2-Norm(final)=15.515 | 4885.2 samples/s | 76.3 steps/s
[Step=46100 Epoch=224.9] | Loss=0.01645 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.516 | 5623.2 samples/s | 87.9 steps/s
[Step=46150 Epoch=225.2] | Loss=0.01816 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.516 | 5563.8 samples/s | 86.9 steps/s
[Step=46200 Epoch=225.4] | Loss=0.01804 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.228 | L2-Norm(final)=15.516 | 8867.6 samples/s | 138.6 steps/s
[Step=46250 Epoch=225.7] | Loss=0.01772 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.516 | 2435.9 samples/s | 38.1 steps/s
[Step=46300 Epoch=225.9] | Loss=0.01815 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.517 | 5540.3 samples/s | 86.6 steps/s
[Step=46350 Epoch=226.2] | Loss=0.01789 | Reg=0.00105 | acc=0.9688 | L2-Norm=10.228 | L2-Norm(final)=15.518 | 5590.2 samples/s | 87.3 steps/s
[Step=46400 Epoch=226.4] | Loss=0.01786 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.518 | 7970.8 samples/s | 124.5 steps/s
[Step=46450 Epoch=226.7] | Loss=0.01766 | Reg=0.00105 | acc=0.9688 | L2-Norm=10.228 | L2-Norm(final)=15.519 | 2528.5 samples/s | 39.5 steps/s
[Step=46500 Epoch=226.9] | Loss=0.01764 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.228 | L2-Norm(final)=15.519 | 5561.2 samples/s | 86.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=46501 Epoch=226.9] | Loss=0.00445 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.524 | 5852.0 samples/s | 91.4 steps/s
[Step=46550 Epoch=227.1] | Loss=0.01902 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.240 | L2-Norm(final)=15.523 | 4302.4 samples/s | 67.2 steps/s
[Step=46600 Epoch=227.4] | Loss=0.01799 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.252 | L2-Norm(final)=15.522 | 4844.8 samples/s | 75.7 steps/s
[Step=46650 Epoch=227.6] | Loss=0.01602 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.263 | L2-Norm(final)=15.522 | 4841.2 samples/s | 75.6 steps/s
[Step=46700 Epoch=227.9] | Loss=0.01527 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.272 | L2-Norm(final)=15.524 | 7031.0 samples/s | 109.9 steps/s
[Step=46750 Epoch=228.1] | Loss=0.01334 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.280 | L2-Norm(final)=15.525 | 2255.6 samples/s | 35.2 steps/s
[Step=46800 Epoch=228.4] | Loss=0.01177 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=15.528 | 4821.1 samples/s | 75.3 steps/s
[Step=46850 Epoch=228.6] | Loss=0.01076 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.293 | L2-Norm(final)=15.530 | 4841.1 samples/s | 75.6 steps/s
[Step=46900 Epoch=228.9] | Loss=0.01022 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.298 | L2-Norm(final)=15.533 | 6482.7 samples/s | 101.3 steps/s
[Step=46950 Epoch=229.1] | Loss=0.00952 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.302 | L2-Norm(final)=15.535 | 2322.4 samples/s | 36.3 steps/s
[Step=47000 Epoch=229.3] | Loss=0.00902 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.306 | L2-Norm(final)=15.537 | 4878.5 samples/s | 76.2 steps/s
[Step=47050 Epoch=229.6] | Loss=0.00856 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.309 | L2-Norm(final)=15.539 | 4867.0 samples/s | 76.0 steps/s
[Step=47100 Epoch=229.8] | Loss=0.00832 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.313 | L2-Norm(final)=15.541 | 5923.5 samples/s | 92.6 steps/s
[Step=47150 Epoch=230.1] | Loss=0.00801 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.316 | L2-Norm(final)=15.543 | 2378.1 samples/s | 37.2 steps/s
[Step=47200 Epoch=230.3] | Loss=0.00764 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.318 | L2-Norm(final)=15.544 | 4833.4 samples/s | 75.5 steps/s
[Step=47250 Epoch=230.6] | Loss=0.00731 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.321 | L2-Norm(final)=15.546 | 4874.9 samples/s | 76.2 steps/s
[Step=47300 Epoch=230.8] | Loss=0.00702 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.323 | L2-Norm(final)=15.548 | 5606.6 samples/s | 87.6 steps/s
[Step=47350 Epoch=231.0] | Loss=0.00682 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.326 | L2-Norm(final)=15.550 | 2425.1 samples/s | 37.9 steps/s
[Step=47400 Epoch=231.3] | Loss=0.00665 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.328 | L2-Norm(final)=15.551 | 4869.4 samples/s | 76.1 steps/s
[Step=47450 Epoch=231.5] | Loss=0.00650 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.330 | L2-Norm(final)=15.553 | 4844.5 samples/s | 75.7 steps/s
[Step=47500 Epoch=231.8] | Loss=0.00629 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.332 | L2-Norm(final)=15.555 | 5275.0 samples/s | 82.4 steps/s
[Step=47550 Epoch=232.0] | Loss=0.00612 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.334 | L2-Norm(final)=15.556 | 2571.3 samples/s | 40.2 steps/s
[Step=47600 Epoch=232.3] | Loss=0.00595 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.336 | L2-Norm(final)=15.558 | 4743.0 samples/s | 74.1 steps/s
[Step=47650 Epoch=232.5] | Loss=0.00581 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.338 | L2-Norm(final)=15.559 | 4884.0 samples/s | 76.3 steps/s
[Step=47700 Epoch=232.8] | Loss=0.00570 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.339 | L2-Norm(final)=15.561 | 4973.9 samples/s | 77.7 steps/s
[Step=47750 Epoch=233.0] | Loss=0.00556 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.341 | L2-Norm(final)=15.562 | 2611.9 samples/s | 40.8 steps/s
[Step=47800 Epoch=233.2] | Loss=0.00548 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.343 | L2-Norm(final)=15.564 | 4810.4 samples/s | 75.2 steps/s
[Step=47850 Epoch=233.5] | Loss=0.00539 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.344 | L2-Norm(final)=15.565 | 4907.4 samples/s | 76.7 steps/s
[Step=47900 Epoch=233.7] | Loss=0.00533 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.346 | L2-Norm(final)=15.567 | 4781.0 samples/s | 74.7 steps/s
[Step=47950 Epoch=234.0] | Loss=0.00523 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.348 | L2-Norm(final)=15.568 | 2626.7 samples/s | 41.0 steps/s
[Step=48000 Epoch=234.2] | Loss=0.00515 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.349 | L2-Norm(final)=15.570 | 4815.9 samples/s | 75.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step48000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=303.2] | Loss=0.00087 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.229 | L2-Norm(final)=15.300 | 5456.9 samples/s | 85.3 steps/s
[Step=32050 Epoch=303.7] | Loss=0.00062 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=15.304 | 4651.9 samples/s | 72.7 steps/s
[Step=32100 Epoch=304.2] | Loss=0.00052 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.226 | L2-Norm(final)=15.317 | 8176.3 samples/s | 127.8 steps/s
[Step=32150 Epoch=304.6] | Loss=0.00051 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.226 | L2-Norm(final)=15.327 | 2356.7 samples/s | 36.8 steps/s
[Step=32200 Epoch=305.1] | Loss=0.00051 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.226 | L2-Norm(final)=15.337 | 7254.3 samples/s | 113.3 steps/s
[Step=32250 Epoch=305.6] | Loss=0.00050 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.226 | L2-Norm(final)=15.346 | 2430.9 samples/s | 38.0 steps/s
[Step=32300 Epoch=306.1] | Loss=0.00050 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.226 | L2-Norm(final)=15.355 | 6644.2 samples/s | 103.8 steps/s
[Step=32350 Epoch=306.5] | Loss=0.00048 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.226 | L2-Norm(final)=15.363 | 2512.1 samples/s | 39.3 steps/s
[Step=32400 Epoch=307.0] | Loss=0.00049 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.226 | L2-Norm(final)=15.371 | 5964.7 samples/s | 93.2 steps/s
[Step=32450 Epoch=307.5] | Loss=0.00048 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.226 | L2-Norm(final)=15.379 | 2677.3 samples/s | 41.8 steps/s
[Step=32500 Epoch=308.0] | Loss=0.00048 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.226 | L2-Norm(final)=15.387 | 5244.0 samples/s | 81.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=308.0] | Loss=0.00016 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.226 | L2-Norm(final)=15.471 | 5511.3 samples/s | 86.1 steps/s
[Step=32550 Epoch=308.4] | Loss=0.00227 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=15.470 | 4269.2 samples/s | 66.7 steps/s
[Step=32600 Epoch=308.9] | Loss=0.00126 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.261 | L2-Norm(final)=15.468 | 6700.2 samples/s | 104.7 steps/s
[Step=32650 Epoch=309.4] | Loss=0.00085 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.267 | L2-Norm(final)=15.468 | 2179.4 samples/s | 34.1 steps/s
[Step=32700 Epoch=309.9] | Loss=0.00064 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.269 | L2-Norm(final)=15.468 | 6093.4 samples/s | 95.2 steps/s
[Step=32750 Epoch=310.3] | Loss=0.00052 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.270 | L2-Norm(final)=15.469 | 2293.1 samples/s | 35.8 steps/s
[Step=32800 Epoch=310.8] | Loss=0.00043 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.269 | L2-Norm(final)=15.469 | 5477.6 samples/s | 85.6 steps/s
[Step=32850 Epoch=311.3] | Loss=0.00037 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.268 | L2-Norm(final)=15.469 | 2366.1 samples/s | 37.0 steps/s
[Step=32900 Epoch=311.8] | Loss=0.00033 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.267 | L2-Norm(final)=15.469 | 5144.8 samples/s | 80.4 steps/s
[Step=32950 Epoch=312.2] | Loss=0.00029 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.265 | L2-Norm(final)=15.470 | 2444.0 samples/s | 38.2 steps/s
[Step=33000 Epoch=312.7] | Loss=0.00026 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.263 | L2-Norm(final)=15.470 | 4674.3 samples/s | 73.0 steps/s
[Step=33050 Epoch=313.2] | Loss=0.00024 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.261 | L2-Norm(final)=15.470 | 2527.0 samples/s | 39.5 steps/s
[Step=33100 Epoch=313.7] | Loss=0.00022 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.260 | L2-Norm(final)=15.470 | 4619.7 samples/s | 72.2 steps/s
[Step=33150 Epoch=314.1] | Loss=0.00020 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.258 | L2-Norm(final)=15.471 | 2597.8 samples/s | 40.6 steps/s
[Step=33200 Epoch=314.6] | Loss=0.00019 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.256 | L2-Norm(final)=15.471 | 4652.8 samples/s | 72.7 steps/s
[Step=33250 Epoch=315.1] | Loss=0.00018 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.253 | L2-Norm(final)=15.471 | 2543.4 samples/s | 39.7 steps/s
[Step=33300 Epoch=315.5] | Loss=0.00017 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.251 | L2-Norm(final)=15.471 | 4608.0 samples/s | 72.0 steps/s
[Step=33350 Epoch=316.0] | Loss=0.00016 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.249 | L2-Norm(final)=15.472 | 2635.1 samples/s | 41.2 steps/s
[Step=33400 Epoch=316.5] | Loss=0.00015 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=15.472 | 4330.1 samples/s | 67.7 steps/s
[Step=33450 Epoch=317.0] | Loss=0.00014 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.245 | L2-Norm(final)=15.472 | 6985.7 samples/s | 109.2 steps/s
[Step=33500 Epoch=317.4] | Loss=0.00013 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.242 | L2-Norm(final)=15.472 | 2179.5 samples/s | 34.1 steps/s
[Step=33550 Epoch=317.9] | Loss=0.00013 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.240 | L2-Norm(final)=15.473 | 6251.1 samples/s | 97.7 steps/s
[Step=33600 Epoch=318.4] | Loss=0.00012 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.238 | L2-Norm(final)=15.473 | 2260.0 samples/s | 35.3 steps/s
[Step=33650 Epoch=318.9] | Loss=0.00012 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.235 | L2-Norm(final)=15.473 | 5679.1 samples/s | 88.7 steps/s
[Step=33700 Epoch=319.3] | Loss=0.00011 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.233 | L2-Norm(final)=15.473 | 2310.3 samples/s | 36.1 steps/s
[Step=33750 Epoch=319.8] | Loss=0.00011 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.230 | L2-Norm(final)=15.474 | 5052.2 samples/s | 78.9 steps/s
[Step=33800 Epoch=320.3] | Loss=0.00010 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.474 | 2421.4 samples/s | 37.8 steps/s
[Step=33850 Epoch=320.8] | Loss=0.00010 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.225 | L2-Norm(final)=15.474 | 4754.0 samples/s | 74.3 steps/s
[Step=33900 Epoch=321.2] | Loss=0.00010 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.223 | L2-Norm(final)=15.474 | 2486.1 samples/s | 38.8 steps/s
[Step=33950 Epoch=321.7] | Loss=0.00009 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.220 | L2-Norm(final)=15.474 | 4671.5 samples/s | 73.0 steps/s
[Step=34000 Epoch=322.2] | Loss=0.00009 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.218 | L2-Norm(final)=15.475 | 2602.3 samples/s | 40.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step34000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=26001 Epoch=247.3] | Loss=0.00021 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.229 | L2-Norm(final)=15.018 | 5141.0 samples/s | 80.3 steps/s
[Step=26050 Epoch=247.8] | Loss=0.00079 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.024 | 4933.2 samples/s | 77.1 steps/s
[Step=26100 Epoch=248.3] | Loss=0.00073 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.034 | 8010.6 samples/s | 125.2 steps/s
[Step=26150 Epoch=248.8] | Loss=0.00075 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.043 | 2365.6 samples/s | 37.0 steps/s
[Step=26200 Epoch=249.2] | Loss=0.00071 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.052 | 7245.4 samples/s | 113.2 steps/s
[Step=26250 Epoch=249.7] | Loss=0.00067 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.060 | 2422.2 samples/s | 37.8 steps/s
[Step=26300 Epoch=250.2] | Loss=0.00068 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.067 | 6664.1 samples/s | 104.1 steps/s
[Step=26350 Epoch=250.7] | Loss=0.00064 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.074 | 2547.2 samples/s | 39.8 steps/s
[Step=26400 Epoch=251.1] | Loss=0.00065 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.082 | 6003.4 samples/s | 93.8 steps/s
[Step=26450 Epoch=251.6] | Loss=0.00064 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.089 | 2629.0 samples/s | 41.1 steps/s
[Step=26500 Epoch=252.1] | Loss=0.00065 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.096 | 5421.8 samples/s | 84.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=26501 Epoch=252.1] | Loss=0.00010 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=15.165 | 5679.3 samples/s | 88.7 steps/s
[Step=26550 Epoch=252.6] | Loss=0.00015 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.239 | L2-Norm(final)=15.170 | 4110.1 samples/s | 64.2 steps/s
[Step=26600 Epoch=253.0] | Loss=0.00022 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=15.172 | 6804.5 samples/s | 106.3 steps/s
[Step=26650 Epoch=253.5] | Loss=0.00015 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.251 | L2-Norm(final)=15.174 | 2180.6 samples/s | 34.1 steps/s
[Step=26700 Epoch=254.0] | Loss=0.00012 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.251 | L2-Norm(final)=15.175 | 6127.1 samples/s | 95.7 steps/s
[Step=26750 Epoch=254.5] | Loss=0.00010 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.249 | L2-Norm(final)=15.176 | 2286.1 samples/s | 35.7 steps/s
[Step=26800 Epoch=254.9] | Loss=0.00008 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=15.177 | 5597.9 samples/s | 87.5 steps/s
[Step=26850 Epoch=255.4] | Loss=0.00007 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=15.178 | 2393.8 samples/s | 37.4 steps/s
[Step=26900 Epoch=255.9] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.240 | L2-Norm(final)=15.179 | 4975.1 samples/s | 77.7 steps/s
[Step=26950 Epoch=256.4] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.236 | L2-Norm(final)=15.179 | 2445.2 samples/s | 38.2 steps/s
[Step=27000 Epoch=256.8] | Loss=0.00005 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.233 | L2-Norm(final)=15.180 | 4724.7 samples/s | 73.8 steps/s
[Step=27050 Epoch=257.3] | Loss=0.00005 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.229 | L2-Norm(final)=15.181 | 2529.3 samples/s | 39.5 steps/s
[Step=27100 Epoch=257.8] | Loss=0.00004 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.225 | L2-Norm(final)=15.181 | 4656.8 samples/s | 72.8 steps/s
[Step=27150 Epoch=258.3] | Loss=0.00004 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.221 | L2-Norm(final)=15.182 | 2557.0 samples/s | 40.0 steps/s
[Step=27200 Epoch=258.7] | Loss=0.00004 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.217 | L2-Norm(final)=15.182 | 4622.7 samples/s | 72.2 steps/s
[Step=27250 Epoch=259.2] | Loss=0.00004 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.213 | L2-Norm(final)=15.183 | 2574.6 samples/s | 40.2 steps/s
[Step=27300 Epoch=259.7] | Loss=0.00003 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.209 | L2-Norm(final)=15.183 | 4627.9 samples/s | 72.3 steps/s
[Step=27350 Epoch=260.2] | Loss=0.00003 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.205 | L2-Norm(final)=15.184 | 2682.9 samples/s | 41.9 steps/s
[Step=27400 Epoch=260.6] | Loss=0.00003 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.201 | L2-Norm(final)=15.184 | 4424.7 samples/s | 69.1 steps/s
[Step=27450 Epoch=261.1] | Loss=0.00003 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.196 | L2-Norm(final)=15.185 | 6923.0 samples/s | 108.2 steps/s
[Step=27500 Epoch=261.6] | Loss=0.00003 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.192 | L2-Norm(final)=15.185 | 2112.5 samples/s | 33.0 steps/s
[Step=27550 Epoch=262.1] | Loss=0.00003 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.188 | L2-Norm(final)=15.186 | 6154.6 samples/s | 96.2 steps/s
[Step=27600 Epoch=262.5] | Loss=0.00003 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.183 | L2-Norm(final)=15.186 | 2226.3 samples/s | 34.8 steps/s
[Step=27650 Epoch=263.0] | Loss=0.00002 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.179 | L2-Norm(final)=15.187 | 5667.1 samples/s | 88.5 steps/s
[Step=27700 Epoch=263.5] | Loss=0.00002 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.175 | L2-Norm(final)=15.187 | 2326.8 samples/s | 36.4 steps/s
[Step=27750 Epoch=264.0] | Loss=0.00002 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.170 | L2-Norm(final)=15.188 | 5164.5 samples/s | 80.7 steps/s
[Step=27800 Epoch=264.4] | Loss=0.00002 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.166 | L2-Norm(final)=15.188 | 2431.1 samples/s | 38.0 steps/s
[Step=27850 Epoch=264.9] | Loss=0.00002 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=15.189 | 4910.7 samples/s | 76.7 steps/s
[Step=27900 Epoch=265.4] | Loss=0.00002 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.156 | L2-Norm(final)=15.189 | 2502.4 samples/s | 39.1 steps/s
[Step=27950 Epoch=265.9] | Loss=0.00002 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.152 | L2-Norm(final)=15.189 | 4593.5 samples/s | 71.8 steps/s
[Step=28000 Epoch=266.3] | Loss=0.00002 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.147 | L2-Norm(final)=15.190 | 2556.0 samples/s | 39.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step28000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=36001 Epoch=339.2] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.229 | L2-Norm(final)=16.081 | 5563.5 samples/s | 86.9 steps/s
[Step=36050 Epoch=339.7] | Loss=0.00049 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=16.090 | 4701.1 samples/s | 73.5 steps/s
[Step=36100 Epoch=340.2] | Loss=0.00044 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=16.096 | 8208.5 samples/s | 128.3 steps/s
[Step=36150 Epoch=340.6] | Loss=0.00039 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=16.102 | 2373.5 samples/s | 37.1 steps/s
[Step=36200 Epoch=341.1] | Loss=0.00043 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=16.107 | 7019.1 samples/s | 109.7 steps/s
[Step=36250 Epoch=341.6] | Loss=0.00043 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=16.114 | 2477.4 samples/s | 38.7 steps/s
[Step=36300 Epoch=342.0] | Loss=0.00042 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=16.121 | 6291.6 samples/s | 98.3 steps/s
[Step=36350 Epoch=342.5] | Loss=0.00043 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=16.128 | 2560.7 samples/s | 40.0 steps/s
[Step=36400 Epoch=343.0] | Loss=0.00043 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=16.135 | 5717.0 samples/s | 89.3 steps/s
[Step=36450 Epoch=343.5] | Loss=0.00042 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=16.142 | 2692.4 samples/s | 42.1 steps/s
[Step=36500 Epoch=343.9] | Loss=0.00042 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=16.149 | 5592.5 samples/s | 87.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=343.9] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=16.215 | 6025.0 samples/s | 94.1 steps/s
[Step=36550 Epoch=344.4] | Loss=0.00023 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.232 | L2-Norm(final)=16.221 | 4001.4 samples/s | 62.5 steps/s
[Step=36600 Epoch=344.9] | Loss=0.00017 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.238 | L2-Norm(final)=16.224 | 6643.4 samples/s | 103.8 steps/s
[Step=36650 Epoch=345.3] | Loss=0.00012 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.240 | L2-Norm(final)=16.227 | 2204.5 samples/s | 34.4 steps/s
[Step=36700 Epoch=345.8] | Loss=0.00009 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.238 | L2-Norm(final)=16.229 | 5886.4 samples/s | 92.0 steps/s
[Step=36750 Epoch=346.3] | Loss=0.00007 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.234 | L2-Norm(final)=16.230 | 2285.3 samples/s | 35.7 steps/s
[Step=36800 Epoch=346.8] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.230 | L2-Norm(final)=16.231 | 5381.3 samples/s | 84.1 steps/s
[Step=36850 Epoch=347.2] | Loss=0.00005 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.224 | L2-Norm(final)=16.232 | 2399.3 samples/s | 37.5 steps/s
[Step=36900 Epoch=347.7] | Loss=0.00005 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.219 | L2-Norm(final)=16.233 | 4869.5 samples/s | 76.1 steps/s
[Step=36950 Epoch=348.2] | Loss=0.00004 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.213 | L2-Norm(final)=16.233 | 2489.4 samples/s | 38.9 steps/s
[Step=37000 Epoch=348.6] | Loss=0.00004 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.207 | L2-Norm(final)=16.234 | 4638.8 samples/s | 72.5 steps/s
[Step=37050 Epoch=349.1] | Loss=0.00004 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.201 | L2-Norm(final)=16.234 | 2549.1 samples/s | 39.8 steps/s
[Step=37100 Epoch=349.6] | Loss=0.00003 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.195 | L2-Norm(final)=16.235 | 4669.1 samples/s | 73.0 steps/s
[Step=37150 Epoch=350.1] | Loss=0.00003 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.189 | L2-Norm(final)=16.235 | 2570.9 samples/s | 40.2 steps/s
[Step=37200 Epoch=350.5] | Loss=0.00003 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.183 | L2-Norm(final)=16.236 | 4538.9 samples/s | 70.9 steps/s
[Step=37250 Epoch=351.0] | Loss=0.00003 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.176 | L2-Norm(final)=16.236 | 2904.2 samples/s | 45.4 steps/s
[Step=37300 Epoch=351.5] | Loss=0.00003 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.170 | L2-Norm(final)=16.237 | 3860.7 samples/s | 60.3 steps/s
[Step=37350 Epoch=351.9] | Loss=0.00002 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=16.237 | 6717.9 samples/s | 105.0 steps/s
[Step=37400 Epoch=352.4] | Loss=0.00002 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.157 | L2-Norm(final)=16.237 | 2180.2 samples/s | 34.1 steps/s
[Step=37450 Epoch=352.9] | Loss=0.00002 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.151 | L2-Norm(final)=16.238 | 6042.9 samples/s | 94.4 steps/s
[Step=37500 Epoch=353.4] | Loss=0.00002 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.144 | L2-Norm(final)=16.238 | 2268.0 samples/s | 35.4 steps/s
[Step=37550 Epoch=353.8] | Loss=0.00002 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.138 | L2-Norm(final)=16.239 | 5445.2 samples/s | 85.1 steps/s
[Step=37600 Epoch=354.3] | Loss=0.00002 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.131 | L2-Norm(final)=16.239 | 2367.2 samples/s | 37.0 steps/s
[Step=37650 Epoch=354.8] | Loss=0.00002 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.124 | L2-Norm(final)=16.240 | 4902.5 samples/s | 76.6 steps/s
[Step=37700 Epoch=355.2] | Loss=0.00002 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.117 | L2-Norm(final)=16.240 | 2522.9 samples/s | 39.4 steps/s
[Step=37750 Epoch=355.7] | Loss=0.00002 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.111 | L2-Norm(final)=16.240 | 4504.6 samples/s | 70.4 steps/s
[Step=37800 Epoch=356.2] | Loss=0.00002 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.104 | L2-Norm(final)=16.241 | 2583.2 samples/s | 40.4 steps/s
[Step=37850 Epoch=356.7] | Loss=0.00002 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.097 | L2-Norm(final)=16.241 | 4635.9 samples/s | 72.4 steps/s
[Step=37900 Epoch=357.1] | Loss=0.00002 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.090 | L2-Norm(final)=16.242 | 2628.7 samples/s | 41.1 steps/s
[Step=37950 Epoch=357.6] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.083 | L2-Norm(final)=16.242 | 4568.2 samples/s | 71.4 steps/s
[Step=38000 Epoch=358.1] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.076 | L2-Norm(final)=16.243 | 2787.8 samples/s | 43.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step38000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=22001 Epoch=209.7] | Loss=0.00075 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.229 | L2-Norm(final)=14.399 | 6024.8 samples/s | 94.1 steps/s
[Step=22050 Epoch=210.2] | Loss=0.00124 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=14.396 | 4384.9 samples/s | 68.5 steps/s
[Step=22100 Epoch=210.6] | Loss=0.00142 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=14.391 | 8529.3 samples/s | 133.3 steps/s
[Step=22150 Epoch=211.1] | Loss=0.00141 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=14.389 | 2346.1 samples/s | 36.7 steps/s
[Step=22200 Epoch=211.6] | Loss=0.00138 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=14.390 | 7584.8 samples/s | 118.5 steps/s
[Step=22250 Epoch=212.1] | Loss=0.00134 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=14.388 | 2410.0 samples/s | 37.7 steps/s
[Step=22300 Epoch=212.5] | Loss=0.00137 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=14.388 | 6925.9 samples/s | 108.2 steps/s
[Step=22350 Epoch=213.0] | Loss=0.00133 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=14.389 | 2506.0 samples/s | 39.2 steps/s
[Step=22400 Epoch=213.5] | Loss=0.00132 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=14.389 | 6199.7 samples/s | 96.9 steps/s
[Step=22450 Epoch=214.0] | Loss=0.00131 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=14.391 | 2542.6 samples/s | 39.7 steps/s
[Step=22500 Epoch=214.4] | Loss=0.00128 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=14.393 | 5814.6 samples/s | 90.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=22501 Epoch=214.5] | Loss=0.00003 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=14.415 | 5695.5 samples/s | 89.0 steps/s
[Step=22550 Epoch=214.9] | Loss=0.00053 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.244 | L2-Norm(final)=14.424 | 4127.1 samples/s | 64.5 steps/s
[Step=22600 Epoch=215.4] | Loss=0.00040 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.253 | L2-Norm(final)=14.428 | 6858.4 samples/s | 107.2 steps/s
[Step=22650 Epoch=215.9] | Loss=0.00027 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.257 | L2-Norm(final)=14.431 | 2182.8 samples/s | 34.1 steps/s
[Step=22700 Epoch=216.4] | Loss=0.00021 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.257 | L2-Norm(final)=14.433 | 6270.0 samples/s | 98.0 steps/s
[Step=22750 Epoch=216.8] | Loss=0.00017 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.256 | L2-Norm(final)=14.434 | 2249.4 samples/s | 35.1 steps/s
[Step=22800 Epoch=217.3] | Loss=0.00014 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.254 | L2-Norm(final)=14.435 | 5749.9 samples/s | 89.8 steps/s
[Step=22850 Epoch=217.8] | Loss=0.00012 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.252 | L2-Norm(final)=14.436 | 2331.1 samples/s | 36.4 steps/s
[Step=22900 Epoch=218.3] | Loss=0.00011 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.249 | L2-Norm(final)=14.437 | 5335.6 samples/s | 83.4 steps/s
[Step=22950 Epoch=218.7] | Loss=0.00010 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=14.438 | 2384.6 samples/s | 37.3 steps/s
[Step=23000 Epoch=219.2] | Loss=0.00009 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.242 | L2-Norm(final)=14.438 | 5043.6 samples/s | 78.8 steps/s
[Step=23050 Epoch=219.7] | Loss=0.00008 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.239 | L2-Norm(final)=14.439 | 2475.1 samples/s | 38.7 steps/s
[Step=23100 Epoch=220.2] | Loss=0.00007 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.236 | L2-Norm(final)=14.440 | 4730.1 samples/s | 73.9 steps/s
[Step=23150 Epoch=220.6] | Loss=0.00007 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.232 | L2-Norm(final)=14.440 | 2536.6 samples/s | 39.6 steps/s
[Step=23200 Epoch=221.1] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=14.441 | 4639.0 samples/s | 72.5 steps/s
[Step=23250 Epoch=221.6] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.225 | L2-Norm(final)=14.441 | 2560.8 samples/s | 40.0 steps/s
[Step=23300 Epoch=222.1] | Loss=0.00006 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.221 | L2-Norm(final)=14.442 | 4608.2 samples/s | 72.0 steps/s
[Step=23350 Epoch=222.5] | Loss=0.00005 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.217 | L2-Norm(final)=14.442 | 2579.2 samples/s | 40.3 steps/s
[Step=23400 Epoch=223.0] | Loss=0.00005 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.213 | L2-Norm(final)=14.443 | 4715.6 samples/s | 73.7 steps/s
[Step=23450 Epoch=223.5] | Loss=0.00005 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.209 | L2-Norm(final)=14.443 | 2517.6 samples/s | 39.3 steps/s
[Step=23500 Epoch=224.0] | Loss=0.00005 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.205 | L2-Norm(final)=14.444 | 4619.0 samples/s | 72.2 steps/s
[Step=23550 Epoch=224.5] | Loss=0.00004 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.201 | L2-Norm(final)=14.444 | 7471.0 samples/s | 116.7 steps/s
[Step=23600 Epoch=224.9] | Loss=0.00004 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.197 | L2-Norm(final)=14.445 | 2109.8 samples/s | 33.0 steps/s
[Step=23650 Epoch=225.4] | Loss=0.00004 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.193 | L2-Norm(final)=14.445 | 6787.0 samples/s | 106.0 steps/s
[Step=23700 Epoch=225.9] | Loss=0.00004 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.189 | L2-Norm(final)=14.445 | 2213.7 samples/s | 34.6 steps/s
[Step=23750 Epoch=226.4] | Loss=0.00004 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.184 | L2-Norm(final)=14.446 | 6024.9 samples/s | 94.1 steps/s
[Step=23800 Epoch=226.8] | Loss=0.00004 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.180 | L2-Norm(final)=14.446 | 2260.6 samples/s | 35.3 steps/s
[Step=23850 Epoch=227.3] | Loss=0.00003 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.176 | L2-Norm(final)=14.447 | 5689.0 samples/s | 88.9 steps/s
[Step=23900 Epoch=227.8] | Loss=0.00003 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.171 | L2-Norm(final)=14.447 | 2351.3 samples/s | 36.7 steps/s
[Step=23950 Epoch=228.3] | Loss=0.00003 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.167 | L2-Norm(final)=14.448 | 5216.9 samples/s | 81.5 steps/s
[Step=24000 Epoch=228.7] | Loss=0.00003 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=14.448 | 2383.0 samples/s | 37.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08215 | acc=0.9627 | tpr=0.9710 | fpr=0.0553 | 5526.2 samples/s | 21.6 steps/s
Avg test loss: 0.08948, Avg test acc: 0.96113, Avg tpr: 0.97016, Avg fpr: 0.05871, total FA: 458

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08344 | acc=0.9660 | tpr=0.9784 | fpr=0.0610 | 5722.9 samples/s | 22.4 steps/s
Avg test loss: 0.09086, Avg test acc: 0.96414, Avg tpr: 0.97651, Avg fpr: 0.06307, total FA: 492

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08864 | acc=0.9616 | tpr=0.9717 | fpr=0.0602 | 5850.8 samples/s | 22.9 steps/s
Avg test loss: 0.09522, Avg test acc: 0.96101, Avg tpr: 0.96923, Avg fpr: 0.05704, total FA: 445

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08597 | acc=0.9654 | tpr=0.9783 | fpr=0.0627 | 5764.5 samples/s | 22.5 steps/s
Avg test loss: 0.09467, Avg test acc: 0.96394, Avg tpr: 0.97791, Avg fpr: 0.06679, total FA: 521

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08586 | acc=0.9645 | tpr=0.9764 | fpr=0.0612 | 5635.5 samples/s | 22.0 steps/s
Avg test loss: 0.09588, Avg test acc: 0.96346, Avg tpr: 0.97511, Avg fpr: 0.06217, total FA: 485

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.19267 | acc=0.2810 | tpr=0.0059 | fpr=0.1217 | 5808.9 samples/s | 22.7 steps/s
Avg test loss: 5.20537, Avg test acc: 0.27879, Avg tpr: 0.00583, Avg fpr: 0.12088, total FA: 943

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.59019 | acc=0.2841 | tpr=0.0108 | fpr=0.1224 | 5670.5 samples/s | 22.2 steps/s
Avg test loss: 4.59704, Avg test acc: 0.28235, Avg tpr: 0.01131, Avg fpr: 0.12152, total FA: 948

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.29338 | acc=0.2238 | tpr=0.0134 | fpr=0.3191 | 5800.5 samples/s | 22.7 steps/s
Avg test loss: 5.29723, Avg test acc: 0.22374, Avg tpr: 0.01445, Avg fpr: 0.31599, total FA: 2465

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=6.06594 | acc=0.2446 | tpr=0.0097 | fpr=0.2453 | 5702.7 samples/s | 22.3 steps/s
Avg test loss: 6.07455, Avg test acc: 0.24313, Avg tpr: 0.01037, Avg fpr: 0.24497, total FA: 1911

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.58103 | acc=0.2480 | tpr=0.0047 | fpr=0.2237 | 5409.2 samples/s | 21.1 steps/s
Avg test loss: 5.59264, Avg test acc: 0.24689, Avg tpr: 0.00513, Avg fpr: 0.22138, total FA: 1727

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.16798 | acc=0.1600 | tpr=0.1947 | fpr=0.8406 | 5891.0 samples/s | 23.0 steps/s
[Step= 100] | Loss=5.12085 | acc=0.1605 | tpr=0.1791 | fpr=0.8398 | 7943.1 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.13534 | acc=0.1597 | tpr=0.1772 | fpr=0.8407 | 7300.0 samples/s | 28.5 steps/s
[Step= 200] | Loss=5.12958 | acc=0.1594 | tpr=0.1770 | fpr=0.8409 | 7914.3 samples/s | 30.9 steps/s
[Step= 250] | Loss=5.13447 | acc=0.1598 | tpr=0.1773 | fpr=0.8406 | 8740.6 samples/s | 34.1 steps/s
[Step= 300] | Loss=5.13864 | acc=0.1591 | tpr=0.1840 | fpr=0.8414 | 8333.4 samples/s | 32.6 steps/s
[Step= 350] | Loss=5.14160 | acc=0.1589 | tpr=0.1753 | fpr=0.8414 | 7749.2 samples/s | 30.3 steps/s
[Step= 400] | Loss=5.14065 | acc=0.1594 | tpr=0.1778 | fpr=0.8410 | 8178.6 samples/s | 31.9 steps/s
[Step= 450] | Loss=5.14025 | acc=0.1596 | tpr=0.1767 | fpr=0.8407 | 7956.5 samples/s | 31.1 steps/s
[Step= 500] | Loss=5.14302 | acc=0.1596 | tpr=0.1819 | fpr=0.8408 | 7156.6 samples/s | 28.0 steps/s
[Step= 550] | Loss=5.14097 | acc=0.1598 | tpr=0.1803 | fpr=0.8406 | 11278.0 samples/s | 44.1 steps/s
Avg test loss: 5.14074, Avg test acc: 0.15968, Avg tpr: 0.18067, Avg fpr: 0.84070, total FA: 116730

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.04812 | acc=0.1406 | tpr=0.2345 | fpr=0.8611 | 5830.0 samples/s | 22.8 steps/s
[Step= 100] | Loss=5.00116 | acc=0.1441 | tpr=0.2132 | fpr=0.8571 | 8078.3 samples/s | 31.6 steps/s
[Step= 150] | Loss=5.01713 | acc=0.1418 | tpr=0.1988 | fpr=0.8592 | 7829.5 samples/s | 30.6 steps/s
[Step= 200] | Loss=5.01444 | acc=0.1420 | tpr=0.1913 | fpr=0.8589 | 7724.6 samples/s | 30.2 steps/s
[Step= 250] | Loss=5.01914 | acc=0.1419 | tpr=0.1878 | fpr=0.8589 | 7805.8 samples/s | 30.5 steps/s
[Step= 300] | Loss=5.02209 | acc=0.1411 | tpr=0.1884 | fpr=0.8598 | 8455.4 samples/s | 33.0 steps/s
[Step= 350] | Loss=5.02380 | acc=0.1408 | tpr=0.1760 | fpr=0.8598 | 8825.9 samples/s | 34.5 steps/s
[Step= 400] | Loss=5.02213 | acc=0.1413 | tpr=0.1833 | fpr=0.8595 | 8018.0 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.02121 | acc=0.1416 | tpr=0.1840 | fpr=0.8592 | 8182.1 samples/s | 32.0 steps/s
[Step= 500] | Loss=5.02382 | acc=0.1414 | tpr=0.1855 | fpr=0.8594 | 7847.3 samples/s | 30.7 steps/s
[Step= 550] | Loss=5.02176 | acc=0.1415 | tpr=0.1842 | fpr=0.8592 | 10059.8 samples/s | 39.3 steps/s
Avg test loss: 5.02184, Avg test acc: 0.14148, Avg tpr: 0.18423, Avg fpr: 0.85930, total FA: 119312

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.96303 | acc=0.1412 | tpr=0.1106 | fpr=0.8582 | 5711.0 samples/s | 22.3 steps/s
[Step= 100] | Loss=5.90819 | acc=0.1428 | tpr=0.1045 | fpr=0.8565 | 7952.1 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.91675 | acc=0.1410 | tpr=0.1052 | fpr=0.8583 | 8305.3 samples/s | 32.4 steps/s
[Step= 200] | Loss=5.90866 | acc=0.1412 | tpr=0.1060 | fpr=0.8581 | 7861.5 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.91082 | acc=0.1417 | tpr=0.1074 | fpr=0.8577 | 8382.0 samples/s | 32.7 steps/s
[Step= 300] | Loss=5.91670 | acc=0.1414 | tpr=0.1076 | fpr=0.8579 | 8077.6 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.92005 | acc=0.1408 | tpr=0.1021 | fpr=0.8585 | 8586.8 samples/s | 33.5 steps/s
[Step= 400] | Loss=5.91756 | acc=0.1412 | tpr=0.1078 | fpr=0.8582 | 6968.4 samples/s | 27.2 steps/s
[Step= 450] | Loss=5.91575 | acc=0.1413 | tpr=0.1071 | fpr=0.8581 | 8261.0 samples/s | 32.3 steps/s
[Step= 500] | Loss=5.91724 | acc=0.1413 | tpr=0.1075 | fpr=0.8580 | 8419.4 samples/s | 32.9 steps/s
[Step= 550] | Loss=5.91370 | acc=0.1415 | tpr=0.1070 | fpr=0.8579 | 10112.6 samples/s | 39.5 steps/s
Avg test loss: 5.91355, Avg test acc: 0.14140, Avg tpr: 0.10737, Avg fpr: 0.85798, total FA: 119129

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.52272 | acc=0.1418 | tpr=0.2257 | fpr=0.8597 | 5633.2 samples/s | 22.0 steps/s
[Step= 100] | Loss=5.47114 | acc=0.1426 | tpr=0.2154 | fpr=0.8588 | 8206.0 samples/s | 32.1 steps/s
[Step= 150] | Loss=5.48658 | acc=0.1411 | tpr=0.2075 | fpr=0.8601 | 7985.1 samples/s | 31.2 steps/s
[Step= 200] | Loss=5.47798 | acc=0.1408 | tpr=0.2022 | fpr=0.8604 | 8224.4 samples/s | 32.1 steps/s
[Step= 250] | Loss=5.48345 | acc=0.1413 | tpr=0.2114 | fpr=0.8600 | 8241.3 samples/s | 32.2 steps/s
[Step= 300] | Loss=5.48971 | acc=0.1405 | tpr=0.2124 | fpr=0.8609 | 7695.8 samples/s | 30.1 steps/s
[Step= 350] | Loss=5.49077 | acc=0.1401 | tpr=0.2016 | fpr=0.8610 | 7695.3 samples/s | 30.1 steps/s
[Step= 400] | Loss=5.48885 | acc=0.1407 | tpr=0.2090 | fpr=0.8606 | 8270.5 samples/s | 32.3 steps/s
[Step= 450] | Loss=5.48769 | acc=0.1409 | tpr=0.2064 | fpr=0.8603 | 8182.3 samples/s | 32.0 steps/s
[Step= 500] | Loss=5.49091 | acc=0.1406 | tpr=0.2093 | fpr=0.8606 | 8277.3 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.48797 | acc=0.1407 | tpr=0.2073 | fpr=0.8605 | 9797.6 samples/s | 38.3 steps/s
Avg test loss: 5.48756, Avg test acc: 0.14064, Avg tpr: 0.20761, Avg fpr: 0.86058, total FA: 119490

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.37849 | acc=0.1341 | tpr=0.1416 | fpr=0.8660 | 5831.3 samples/s | 22.8 steps/s
[Step= 100] | Loss=6.32037 | acc=0.1354 | tpr=0.1279 | fpr=0.8644 | 7941.1 samples/s | 31.0 steps/s
[Step= 150] | Loss=6.33844 | acc=0.1347 | tpr=0.1254 | fpr=0.8651 | 7521.6 samples/s | 29.4 steps/s
[Step= 200] | Loss=6.33550 | acc=0.1353 | tpr=0.1191 | fpr=0.8644 | 8051.1 samples/s | 31.4 steps/s
[Step= 250] | Loss=6.34216 | acc=0.1356 | tpr=0.1205 | fpr=0.8642 | 8190.6 samples/s | 32.0 steps/s
[Step= 300] | Loss=6.34655 | acc=0.1354 | tpr=0.1215 | fpr=0.8643 | 8418.4 samples/s | 32.9 steps/s
[Step= 350] | Loss=6.34956 | acc=0.1349 | tpr=0.1165 | fpr=0.8647 | 7945.9 samples/s | 31.0 steps/s
[Step= 400] | Loss=6.34737 | acc=0.1355 | tpr=0.1220 | fpr=0.8643 | 8307.3 samples/s | 32.5 steps/s
[Step= 450] | Loss=6.34674 | acc=0.1359 | tpr=0.1241 | fpr=0.8639 | 7676.0 samples/s | 30.0 steps/s
[Step= 500] | Loss=6.35044 | acc=0.1357 | tpr=0.1256 | fpr=0.8641 | 8756.8 samples/s | 34.2 steps/s
[Step= 550] | Loss=6.34653 | acc=0.1356 | tpr=0.1246 | fpr=0.8642 | 9613.6 samples/s | 37.6 steps/s
Avg test loss: 6.34598, Avg test acc: 0.13547, Avg tpr: 0.12480, Avg fpr: 0.86434, total FA: 120012

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11226 | acc=0.9802 | tpr=0.9159 | fpr=0.0187 | 5667.4 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.11288 | acc=0.9802 | tpr=0.9339 | fpr=0.0190 | 8603.8 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.11698 | acc=0.9796 | tpr=0.9409 | fpr=0.0197 | 7985.9 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.11912 | acc=0.9796 | tpr=0.9464 | fpr=0.0198 | 8021.8 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.11915 | acc=0.9795 | tpr=0.9441 | fpr=0.0199 | 7297.5 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.12066 | acc=0.9794 | tpr=0.9440 | fpr=0.0199 | 8437.2 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.12088 | acc=0.9793 | tpr=0.9449 | fpr=0.0200 | 8628.8 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.12219 | acc=0.9792 | tpr=0.9415 | fpr=0.0201 | 7573.6 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.12459 | acc=0.9787 | tpr=0.9396 | fpr=0.0206 | 8493.1 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.12361 | acc=0.9789 | tpr=0.9414 | fpr=0.0204 | 8592.0 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.12257 | acc=0.9791 | tpr=0.9411 | fpr=0.0202 | 9230.1 samples/s | 36.1 steps/s
Avg test loss: 0.12234, Avg test acc: 0.97915, Avg tpr: 0.94097, Avg fpr: 0.02015, total FA: 2798

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09736 | acc=0.9829 | tpr=0.9204 | fpr=0.0160 | 5760.8 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.09905 | acc=0.9822 | tpr=0.9275 | fpr=0.0168 | 7676.5 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.10228 | acc=0.9818 | tpr=0.9308 | fpr=0.0173 | 8166.0 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.10376 | acc=0.9816 | tpr=0.9333 | fpr=0.0175 | 7927.5 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.10454 | acc=0.9814 | tpr=0.9293 | fpr=0.0177 | 8110.9 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.10609 | acc=0.9813 | tpr=0.9280 | fpr=0.0178 | 8314.5 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.10618 | acc=0.9812 | tpr=0.9299 | fpr=0.0179 | 8176.7 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.10715 | acc=0.9812 | tpr=0.9256 | fpr=0.0178 | 7159.9 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.10903 | acc=0.9809 | tpr=0.9250 | fpr=0.0181 | 8489.2 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.10818 | acc=0.9810 | tpr=0.9269 | fpr=0.0181 | 8026.2 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.10731 | acc=0.9811 | tpr=0.9260 | fpr=0.0179 | 10834.8 samples/s | 42.3 steps/s
Avg test loss: 0.10711, Avg test acc: 0.98111, Avg tpr: 0.92552, Avg fpr: 0.01788, total FA: 2482

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12285 | acc=0.9775 | tpr=0.9381 | fpr=0.0218 | 5667.0 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.12432 | acc=0.9777 | tpr=0.9574 | fpr=0.0220 | 7906.8 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.12825 | acc=0.9773 | tpr=0.9597 | fpr=0.0224 | 7505.9 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.13018 | acc=0.9773 | tpr=0.9628 | fpr=0.0225 | 7857.3 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.13121 | acc=0.9772 | tpr=0.9590 | fpr=0.0225 | 8102.4 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.13241 | acc=0.9771 | tpr=0.9585 | fpr=0.0225 | 8349.2 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.13248 | acc=0.9770 | tpr=0.9612 | fpr=0.0227 | 8027.1 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.13333 | acc=0.9767 | tpr=0.9584 | fpr=0.0229 | 7766.6 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.13571 | acc=0.9763 | tpr=0.9562 | fpr=0.0233 | 8218.7 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.13481 | acc=0.9764 | tpr=0.9573 | fpr=0.0233 | 8359.0 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.13364 | acc=0.9765 | tpr=0.9570 | fpr=0.0231 | 11493.0 samples/s | 44.9 steps/s
Avg test loss: 0.13337, Avg test acc: 0.97655, Avg tpr: 0.95681, Avg fpr: 0.02309, total FA: 3206

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.12220 | acc=0.9797 | tpr=0.9292 | fpr=0.0194 | 5516.9 samples/s | 21.6 steps/s
[Step= 100] | Loss=0.12464 | acc=0.9790 | tpr=0.9360 | fpr=0.0202 | 8005.9 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.12779 | acc=0.9789 | tpr=0.9424 | fpr=0.0204 | 8198.1 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.12930 | acc=0.9788 | tpr=0.9464 | fpr=0.0206 | 8398.8 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.12972 | acc=0.9789 | tpr=0.9415 | fpr=0.0205 | 8099.8 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.13114 | acc=0.9789 | tpr=0.9396 | fpr=0.0204 | 8221.6 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.13117 | acc=0.9789 | tpr=0.9436 | fpr=0.0205 | 7447.5 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.13231 | acc=0.9787 | tpr=0.9415 | fpr=0.0206 | 8144.6 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.13455 | acc=0.9784 | tpr=0.9406 | fpr=0.0209 | 8699.8 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.13341 | acc=0.9786 | tpr=0.9432 | fpr=0.0208 | 8041.4 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.13249 | acc=0.9787 | tpr=0.9415 | fpr=0.0206 | 9744.8 samples/s | 38.1 steps/s
Avg test loss: 0.13221, Avg test acc: 0.97870, Avg tpr: 0.94136, Avg fpr: 0.02062, total FA: 2863

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10206 | acc=0.9821 | tpr=0.9204 | fpr=0.0168 | 5643.4 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.10436 | acc=0.9821 | tpr=0.9360 | fpr=0.0171 | 8219.1 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.10726 | acc=0.9814 | tpr=0.9395 | fpr=0.0178 | 7994.8 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.10808 | acc=0.9815 | tpr=0.9454 | fpr=0.0179 | 8017.5 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.10870 | acc=0.9813 | tpr=0.9406 | fpr=0.0180 | 8272.7 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.10998 | acc=0.9813 | tpr=0.9396 | fpr=0.0179 | 7674.6 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.10991 | acc=0.9814 | tpr=0.9424 | fpr=0.0179 | 8054.2 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.11095 | acc=0.9813 | tpr=0.9382 | fpr=0.0180 | 8326.3 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.11304 | acc=0.9809 | tpr=0.9372 | fpr=0.0183 | 8153.9 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.11223 | acc=0.9811 | tpr=0.9396 | fpr=0.0182 | 8479.1 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.11140 | acc=0.9812 | tpr=0.9383 | fpr=0.0180 | 9259.3 samples/s | 36.2 steps/s
Avg test loss: 0.11120, Avg test acc: 0.98120, Avg tpr: 0.93819, Avg fpr: 0.01802, total FA: 2502

server round 36/50

clients selected: [1 2 5 6 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=48001 Epoch=234.2] | Loss=0.01261 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.136 | L2-Norm(final)=15.614 | 5955.4 samples/s | 93.1 steps/s
[Step=48050 Epoch=234.5] | Loss=0.01849 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.137 | L2-Norm(final)=15.614 | 4902.7 samples/s | 76.6 steps/s
[Step=48100 Epoch=234.7] | Loss=0.01557 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.137 | L2-Norm(final)=15.613 | 5650.7 samples/s | 88.3 steps/s
[Step=48150 Epoch=234.9] | Loss=0.01535 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.137 | L2-Norm(final)=15.614 | 5718.7 samples/s | 89.4 steps/s
[Step=48200 Epoch=235.2] | Loss=0.01538 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.137 | L2-Norm(final)=15.614 | 8583.5 samples/s | 134.1 steps/s
[Step=48250 Epoch=235.4] | Loss=0.01574 | Reg=0.00103 | acc=0.9688 | L2-Norm=10.137 | L2-Norm(final)=15.614 | 2438.5 samples/s | 38.1 steps/s
[Step=48300 Epoch=235.7] | Loss=0.01544 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.137 | L2-Norm(final)=15.614 | 5573.4 samples/s | 87.1 steps/s
[Step=48350 Epoch=235.9] | Loss=0.01539 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.137 | L2-Norm(final)=15.614 | 5689.6 samples/s | 88.9 steps/s
[Step=48400 Epoch=236.2] | Loss=0.01532 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.137 | L2-Norm(final)=15.615 | 7880.0 samples/s | 123.1 steps/s
[Step=48450 Epoch=236.4] | Loss=0.01551 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.137 | L2-Norm(final)=15.615 | 2515.0 samples/s | 39.3 steps/s
[Step=48500 Epoch=236.7] | Loss=0.01540 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.137 | L2-Norm(final)=15.615 | 5563.9 samples/s | 86.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=48501 Epoch=236.7] | Loss=0.03083 | Reg=0.00103 | acc=0.9688 | L2-Norm=10.137 | L2-Norm(final)=15.619 | 6203.4 samples/s | 96.9 steps/s
[Step=48550 Epoch=236.9] | Loss=0.01689 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.154 | L2-Norm(final)=15.619 | 4202.0 samples/s | 65.7 steps/s
[Step=48600 Epoch=237.1] | Loss=0.01714 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.170 | L2-Norm(final)=15.617 | 4846.2 samples/s | 75.7 steps/s
[Step=48650 Epoch=237.4] | Loss=0.01613 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.181 | L2-Norm(final)=15.616 | 4857.5 samples/s | 75.9 steps/s
[Step=48700 Epoch=237.6] | Loss=0.01516 | Reg=0.00104 | acc=0.9688 | L2-Norm=10.190 | L2-Norm(final)=15.617 | 6990.4 samples/s | 109.2 steps/s
[Step=48750 Epoch=237.9] | Loss=0.01322 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.197 | L2-Norm(final)=15.619 | 2243.0 samples/s | 35.0 steps/s
[Step=48800 Epoch=238.1] | Loss=0.01189 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.203 | L2-Norm(final)=15.621 | 4871.3 samples/s | 76.1 steps/s
[Step=48850 Epoch=238.4] | Loss=0.01145 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.208 | L2-Norm(final)=15.623 | 4895.5 samples/s | 76.5 steps/s
[Step=48900 Epoch=238.6] | Loss=0.01044 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.212 | L2-Norm(final)=15.625 | 6443.0 samples/s | 100.7 steps/s
[Step=48950 Epoch=238.9] | Loss=0.00968 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.216 | L2-Norm(final)=15.627 | 2320.6 samples/s | 36.3 steps/s
[Step=49000 Epoch=239.1] | Loss=0.00910 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.220 | L2-Norm(final)=15.629 | 4880.8 samples/s | 76.3 steps/s
[Step=49050 Epoch=239.3] | Loss=0.00850 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.223 | L2-Norm(final)=15.631 | 4865.1 samples/s | 76.0 steps/s
[Step=49100 Epoch=239.6] | Loss=0.00819 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.226 | L2-Norm(final)=15.633 | 5852.9 samples/s | 91.5 steps/s
[Step=49150 Epoch=239.8] | Loss=0.00778 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.229 | L2-Norm(final)=15.635 | 2384.3 samples/s | 37.3 steps/s
[Step=49200 Epoch=240.1] | Loss=0.00767 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.232 | L2-Norm(final)=15.636 | 4747.8 samples/s | 74.2 steps/s
[Step=49250 Epoch=240.3] | Loss=0.00738 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.234 | L2-Norm(final)=15.638 | 4866.3 samples/s | 76.0 steps/s
[Step=49300 Epoch=240.6] | Loss=0.00708 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.236 | L2-Norm(final)=15.640 | 5642.3 samples/s | 88.2 steps/s
[Step=49350 Epoch=240.8] | Loss=0.00681 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.239 | L2-Norm(final)=15.641 | 2480.5 samples/s | 38.8 steps/s
[Step=49400 Epoch=241.0] | Loss=0.00657 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.241 | L2-Norm(final)=15.643 | 4802.0 samples/s | 75.0 steps/s
[Step=49450 Epoch=241.3] | Loss=0.00647 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=15.644 | 4864.9 samples/s | 76.0 steps/s
[Step=49500 Epoch=241.5] | Loss=0.00633 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.245 | L2-Norm(final)=15.646 | 5253.0 samples/s | 82.1 steps/s
[Step=49550 Epoch=241.8] | Loss=0.00614 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.246 | L2-Norm(final)=15.647 | 2522.2 samples/s | 39.4 steps/s
[Step=49600 Epoch=242.0] | Loss=0.00599 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.248 | L2-Norm(final)=15.648 | 4886.6 samples/s | 76.4 steps/s
[Step=49650 Epoch=242.3] | Loss=0.00590 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.250 | L2-Norm(final)=15.650 | 4864.3 samples/s | 76.0 steps/s
[Step=49700 Epoch=242.5] | Loss=0.00580 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.251 | L2-Norm(final)=15.651 | 4969.5 samples/s | 77.6 steps/s
[Step=49750 Epoch=242.8] | Loss=0.00567 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.253 | L2-Norm(final)=15.652 | 2620.0 samples/s | 40.9 steps/s
[Step=49800 Epoch=243.0] | Loss=0.00557 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.254 | L2-Norm(final)=15.654 | 4812.4 samples/s | 75.2 steps/s
[Step=49850 Epoch=243.2] | Loss=0.00547 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.256 | L2-Norm(final)=15.655 | 4899.7 samples/s | 76.6 steps/s
[Step=49900 Epoch=243.5] | Loss=0.00539 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.257 | L2-Norm(final)=15.656 | 4791.1 samples/s | 74.9 steps/s
[Step=49950 Epoch=243.7] | Loss=0.00532 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.259 | L2-Norm(final)=15.657 | 2619.1 samples/s | 40.9 steps/s
[Step=50000 Epoch=244.0] | Loss=0.00522 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.260 | L2-Norm(final)=15.659 | 4939.1 samples/s | 77.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step50000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=38001 Epoch=185.2] | Loss=0.00324 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.136 | L2-Norm(final)=14.503 | 5818.0 samples/s | 90.9 steps/s
[Step=38050 Epoch=185.4] | Loss=0.01645 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.136 | L2-Norm(final)=14.502 | 4993.2 samples/s | 78.0 steps/s
[Step=38100 Epoch=185.6] | Loss=0.01592 | Reg=0.00103 | acc=0.9688 | L2-Norm=10.136 | L2-Norm(final)=14.502 | 5602.4 samples/s | 87.5 steps/s
[Step=38150 Epoch=185.9] | Loss=0.01650 | Reg=0.00103 | acc=0.9688 | L2-Norm=10.136 | L2-Norm(final)=14.503 | 5657.7 samples/s | 88.4 steps/s
[Step=38200 Epoch=186.1] | Loss=0.01604 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.136 | L2-Norm(final)=14.503 | 8659.4 samples/s | 135.3 steps/s
[Step=38250 Epoch=186.4] | Loss=0.01602 | Reg=0.00103 | acc=0.9531 | L2-Norm=10.136 | L2-Norm(final)=14.504 | 2432.0 samples/s | 38.0 steps/s
[Step=38300 Epoch=186.6] | Loss=0.01545 | Reg=0.00103 | acc=0.9688 | L2-Norm=10.136 | L2-Norm(final)=14.505 | 5602.3 samples/s | 87.5 steps/s
[Step=38350 Epoch=186.9] | Loss=0.01586 | Reg=0.00103 | acc=0.9688 | L2-Norm=10.136 | L2-Norm(final)=14.506 | 5828.6 samples/s | 91.1 steps/s
[Step=38400 Epoch=187.1] | Loss=0.01575 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.136 | L2-Norm(final)=14.507 | 7334.6 samples/s | 114.6 steps/s
[Step=38450 Epoch=187.3] | Loss=0.01625 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.136 | L2-Norm(final)=14.508 | 2530.1 samples/s | 39.5 steps/s
[Step=38500 Epoch=187.6] | Loss=0.01587 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.136 | L2-Norm(final)=14.508 | 5636.5 samples/s | 88.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=187.6] | Loss=0.02160 | Reg=0.00103 | acc=0.9688 | L2-Norm=10.136 | L2-Norm(final)=14.513 | 6295.5 samples/s | 98.4 steps/s
[Step=38550 Epoch=187.8] | Loss=0.01688 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.148 | L2-Norm(final)=14.513 | 4103.6 samples/s | 64.1 steps/s
[Step=38600 Epoch=188.1] | Loss=0.01772 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.163 | L2-Norm(final)=14.512 | 4908.4 samples/s | 76.7 steps/s
[Step=38650 Epoch=188.3] | Loss=0.01682 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.174 | L2-Norm(final)=14.512 | 4800.4 samples/s | 75.0 steps/s
[Step=38700 Epoch=188.6] | Loss=0.01633 | Reg=0.00104 | acc=0.9531 | L2-Norm=10.183 | L2-Norm(final)=14.514 | 6940.9 samples/s | 108.5 steps/s
[Step=38750 Epoch=188.8] | Loss=0.01432 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.192 | L2-Norm(final)=14.515 | 2281.2 samples/s | 35.6 steps/s
[Step=38800 Epoch=189.1] | Loss=0.01292 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.199 | L2-Norm(final)=14.518 | 4851.4 samples/s | 75.8 steps/s
[Step=38850 Epoch=189.3] | Loss=0.01156 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.205 | L2-Norm(final)=14.520 | 4869.1 samples/s | 76.1 steps/s
[Step=38900 Epoch=189.5] | Loss=0.01100 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.211 | L2-Norm(final)=14.523 | 6357.0 samples/s | 99.3 steps/s
[Step=38950 Epoch=189.8] | Loss=0.01033 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.216 | L2-Norm(final)=14.525 | 2374.1 samples/s | 37.1 steps/s
[Step=39000 Epoch=190.0] | Loss=0.00972 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.220 | L2-Norm(final)=14.528 | 4800.2 samples/s | 75.0 steps/s
[Step=39050 Epoch=190.3] | Loss=0.00937 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.224 | L2-Norm(final)=14.530 | 4902.3 samples/s | 76.6 steps/s
[Step=39100 Epoch=190.5] | Loss=0.00890 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=14.533 | 5810.3 samples/s | 90.8 steps/s
[Step=39150 Epoch=190.8] | Loss=0.00845 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.232 | L2-Norm(final)=14.535 | 2428.0 samples/s | 37.9 steps/s
[Step=39200 Epoch=191.0] | Loss=0.00809 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.235 | L2-Norm(final)=14.537 | 4889.9 samples/s | 76.4 steps/s
[Step=39250 Epoch=191.2] | Loss=0.00781 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.238 | L2-Norm(final)=14.539 | 4831.1 samples/s | 75.5 steps/s
[Step=39300 Epoch=191.5] | Loss=0.00748 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.241 | L2-Norm(final)=14.541 | 5397.5 samples/s | 84.3 steps/s
[Step=39350 Epoch=191.7] | Loss=0.00717 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.244 | L2-Norm(final)=14.544 | 2548.4 samples/s | 39.8 steps/s
[Step=39400 Epoch=192.0] | Loss=0.00691 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=14.546 | 4811.1 samples/s | 75.2 steps/s
[Step=39450 Epoch=192.2] | Loss=0.00677 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.250 | L2-Norm(final)=14.548 | 4860.1 samples/s | 75.9 steps/s
[Step=39500 Epoch=192.5] | Loss=0.00668 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.252 | L2-Norm(final)=14.550 | 4946.8 samples/s | 77.3 steps/s
[Step=39550 Epoch=192.7] | Loss=0.00649 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.255 | L2-Norm(final)=14.552 | 2585.9 samples/s | 40.4 steps/s
[Step=39600 Epoch=193.0] | Loss=0.00632 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.257 | L2-Norm(final)=14.554 | 4896.5 samples/s | 76.5 steps/s
[Step=39650 Epoch=193.2] | Loss=0.00614 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.259 | L2-Norm(final)=14.556 | 4882.5 samples/s | 76.3 steps/s
[Step=39700 Epoch=193.4] | Loss=0.00603 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.262 | L2-Norm(final)=14.558 | 4820.5 samples/s | 75.3 steps/s
[Step=39750 Epoch=193.7] | Loss=0.00591 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.264 | L2-Norm(final)=14.560 | 2677.1 samples/s | 41.8 steps/s
[Step=39800 Epoch=193.9] | Loss=0.00580 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.266 | L2-Norm(final)=14.562 | 4841.1 samples/s | 75.6 steps/s
[Step=39850 Epoch=194.2] | Loss=0.00566 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.268 | L2-Norm(final)=14.564 | 4772.5 samples/s | 74.6 steps/s
[Step=39900 Epoch=194.4] | Loss=0.00562 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.270 | L2-Norm(final)=14.565 | 4838.2 samples/s | 75.6 steps/s
[Step=39950 Epoch=194.7] | Loss=0.00548 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.272 | L2-Norm(final)=14.567 | 2634.1 samples/s | 41.2 steps/s
[Step=40000 Epoch=194.9] | Loss=0.00534 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.274 | L2-Norm(final)=14.569 | 4832.1 samples/s | 75.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step40000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=322.2] | Loss=0.00006 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.136 | L2-Norm(final)=15.481 | 5801.7 samples/s | 90.7 steps/s
[Step=34050 Epoch=322.7] | Loss=0.00026 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=15.485 | 4499.4 samples/s | 70.3 steps/s
[Step=34100 Epoch=323.1] | Loss=0.00030 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=15.491 | 8329.1 samples/s | 130.1 steps/s
[Step=34150 Epoch=323.6] | Loss=0.00032 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=15.498 | 2372.7 samples/s | 37.1 steps/s
[Step=34200 Epoch=324.1] | Loss=0.00030 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=15.504 | 7166.7 samples/s | 112.0 steps/s
[Step=34250 Epoch=324.5] | Loss=0.00031 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=15.511 | 2429.9 samples/s | 38.0 steps/s
[Step=34300 Epoch=325.0] | Loss=0.00030 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=15.517 | 6584.3 samples/s | 102.9 steps/s
[Step=34350 Epoch=325.5] | Loss=0.00030 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=15.523 | 2571.2 samples/s | 40.2 steps/s
[Step=34400 Epoch=326.0] | Loss=0.00029 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=15.528 | 5776.3 samples/s | 90.3 steps/s
[Step=34450 Epoch=326.4] | Loss=0.00029 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=15.534 | 2654.6 samples/s | 41.5 steps/s
[Step=34500 Epoch=326.9] | Loss=0.00029 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=15.539 | 5383.4 samples/s | 84.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=326.9] | Loss=0.00158 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=15.596 | 5601.8 samples/s | 87.5 steps/s
[Step=34550 Epoch=327.4] | Loss=0.00026 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.142 | L2-Norm(final)=15.600 | 4199.1 samples/s | 65.6 steps/s
[Step=34600 Epoch=327.9] | Loss=0.00019 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.145 | L2-Norm(final)=15.603 | 6627.1 samples/s | 103.5 steps/s
[Step=34650 Epoch=328.3] | Loss=0.00013 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.145 | L2-Norm(final)=15.605 | 2201.5 samples/s | 34.4 steps/s
[Step=34700 Epoch=328.8] | Loss=0.00010 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.143 | L2-Norm(final)=15.607 | 6005.7 samples/s | 93.8 steps/s
[Step=34750 Epoch=329.3] | Loss=0.00008 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.141 | L2-Norm(final)=15.608 | 2298.5 samples/s | 35.9 steps/s
[Step=34800 Epoch=329.8] | Loss=0.00007 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.138 | L2-Norm(final)=15.609 | 5413.1 samples/s | 84.6 steps/s
[Step=34850 Epoch=330.2] | Loss=0.00006 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=15.609 | 2346.7 samples/s | 36.7 steps/s
[Step=34900 Epoch=330.7] | Loss=0.00005 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.131 | L2-Norm(final)=15.610 | 5111.9 samples/s | 79.9 steps/s
[Step=34950 Epoch=331.2] | Loss=0.00005 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.128 | L2-Norm(final)=15.611 | 2478.1 samples/s | 38.7 steps/s
[Step=35000 Epoch=331.7] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.124 | L2-Norm(final)=15.611 | 4670.5 samples/s | 73.0 steps/s
[Step=35050 Epoch=332.1] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.120 | L2-Norm(final)=15.612 | 2518.7 samples/s | 39.4 steps/s
[Step=35100 Epoch=332.6] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.116 | L2-Norm(final)=15.612 | 4652.9 samples/s | 72.7 steps/s
[Step=35150 Epoch=333.1] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.113 | L2-Norm(final)=15.613 | 2553.7 samples/s | 39.9 steps/s
[Step=35200 Epoch=333.6] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.109 | L2-Norm(final)=15.613 | 4640.3 samples/s | 72.5 steps/s
[Step=35250 Epoch=334.0] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.105 | L2-Norm(final)=15.614 | 2584.1 samples/s | 40.4 steps/s
[Step=35300 Epoch=334.5] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.101 | L2-Norm(final)=15.614 | 4676.4 samples/s | 73.1 steps/s
[Step=35350 Epoch=335.0] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.097 | L2-Norm(final)=15.615 | 2616.5 samples/s | 40.9 steps/s
[Step=35400 Epoch=335.4] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.092 | L2-Norm(final)=15.615 | 4476.8 samples/s | 69.9 steps/s
[Step=35450 Epoch=335.9] | Loss=0.00002 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.088 | L2-Norm(final)=15.616 | 6645.3 samples/s | 103.8 steps/s
[Step=35500 Epoch=336.4] | Loss=0.00002 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.084 | L2-Norm(final)=15.616 | 2190.2 samples/s | 34.2 steps/s
[Step=35550 Epoch=336.9] | Loss=0.00002 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=15.616 | 6041.8 samples/s | 94.4 steps/s
[Step=35600 Epoch=337.3] | Loss=0.00002 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.076 | L2-Norm(final)=15.617 | 2230.4 samples/s | 34.9 steps/s
[Step=35650 Epoch=337.8] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.071 | L2-Norm(final)=15.617 | 5759.5 samples/s | 90.0 steps/s
[Step=35700 Epoch=338.3] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=15.618 | 2355.3 samples/s | 36.8 steps/s
[Step=35750 Epoch=338.8] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.062 | L2-Norm(final)=15.618 | 5117.2 samples/s | 80.0 steps/s
[Step=35800 Epoch=339.2] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.058 | L2-Norm(final)=15.619 | 2401.1 samples/s | 37.5 steps/s
[Step=35850 Epoch=339.7] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.053 | L2-Norm(final)=15.619 | 4885.0 samples/s | 76.3 steps/s
[Step=35900 Epoch=340.2] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.048 | L2-Norm(final)=15.619 | 2518.9 samples/s | 39.4 steps/s
[Step=35950 Epoch=340.7] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.044 | L2-Norm(final)=15.620 | 4598.0 samples/s | 71.8 steps/s
[Step=36000 Epoch=341.1] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.039 | L2-Norm(final)=15.620 | 2591.1 samples/s | 40.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step36000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=28001 Epoch=266.4] | Loss=0.00061 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.136 | L2-Norm(final)=15.203 | 5740.1 samples/s | 89.7 steps/s
[Step=28050 Epoch=266.8] | Loss=0.00084 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=15.214 | 4585.6 samples/s | 71.6 steps/s
[Step=28100 Epoch=267.3] | Loss=0.00068 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.134 | L2-Norm(final)=15.227 | 8145.3 samples/s | 127.3 steps/s
[Step=28150 Epoch=267.8] | Loss=0.00071 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.134 | L2-Norm(final)=15.239 | 2393.7 samples/s | 37.4 steps/s
[Step=28200 Epoch=268.3] | Loss=0.00070 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.134 | L2-Norm(final)=15.250 | 6957.9 samples/s | 108.7 steps/s
[Step=28250 Epoch=268.7] | Loss=0.00071 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.134 | L2-Norm(final)=15.262 | 2432.0 samples/s | 38.0 steps/s
[Step=28300 Epoch=269.2] | Loss=0.00066 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.134 | L2-Norm(final)=15.272 | 6705.0 samples/s | 104.8 steps/s
[Step=28350 Epoch=269.7] | Loss=0.00065 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.134 | L2-Norm(final)=15.282 | 2529.1 samples/s | 39.5 steps/s
[Step=28400 Epoch=270.2] | Loss=0.00065 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.134 | L2-Norm(final)=15.292 | 6080.7 samples/s | 95.0 steps/s
[Step=28450 Epoch=270.6] | Loss=0.00067 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.134 | L2-Norm(final)=15.301 | 2618.5 samples/s | 40.9 steps/s
[Step=28500 Epoch=271.1] | Loss=0.00065 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.134 | L2-Norm(final)=15.311 | 5530.2 samples/s | 86.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=28501 Epoch=271.1] | Loss=0.00012 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.134 | L2-Norm(final)=15.407 | 5772.0 samples/s | 90.2 steps/s
[Step=28550 Epoch=271.6] | Loss=0.00035 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.153 | L2-Norm(final)=15.413 | 4135.7 samples/s | 64.6 steps/s
[Step=28600 Epoch=272.1] | Loss=0.00020 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.165 | L2-Norm(final)=15.416 | 6729.0 samples/s | 105.1 steps/s
[Step=28650 Epoch=272.5] | Loss=0.00014 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.166 | L2-Norm(final)=15.418 | 2193.7 samples/s | 34.3 steps/s
[Step=28700 Epoch=273.0] | Loss=0.00011 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.163 | L2-Norm(final)=15.419 | 6093.3 samples/s | 95.2 steps/s
[Step=28750 Epoch=273.5] | Loss=0.00009 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.159 | L2-Norm(final)=15.419 | 2271.2 samples/s | 35.5 steps/s
[Step=28800 Epoch=274.0] | Loss=0.00007 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.154 | L2-Norm(final)=15.420 | 5542.3 samples/s | 86.6 steps/s
[Step=28850 Epoch=274.4] | Loss=0.00006 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.149 | L2-Norm(final)=15.421 | 2373.6 samples/s | 37.1 steps/s
[Step=28900 Epoch=274.9] | Loss=0.00005 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.143 | L2-Norm(final)=15.421 | 5118.2 samples/s | 80.0 steps/s
[Step=28950 Epoch=275.4] | Loss=0.00005 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.137 | L2-Norm(final)=15.422 | 2420.5 samples/s | 37.8 steps/s
[Step=29000 Epoch=275.9] | Loss=0.00004 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.131 | L2-Norm(final)=15.422 | 4744.9 samples/s | 74.1 steps/s
[Step=29050 Epoch=276.3] | Loss=0.00004 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.125 | L2-Norm(final)=15.423 | 2567.7 samples/s | 40.1 steps/s
[Step=29100 Epoch=276.8] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.119 | L2-Norm(final)=15.423 | 4595.2 samples/s | 71.8 steps/s
[Step=29150 Epoch=277.3] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.112 | L2-Norm(final)=15.423 | 2605.2 samples/s | 40.7 steps/s
[Step=29200 Epoch=277.8] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.106 | L2-Norm(final)=15.424 | 4641.2 samples/s | 72.5 steps/s
[Step=29250 Epoch=278.2] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.100 | L2-Norm(final)=15.424 | 2534.6 samples/s | 39.6 steps/s
[Step=29300 Epoch=278.7] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.093 | L2-Norm(final)=15.425 | 4735.6 samples/s | 74.0 steps/s
[Step=29350 Epoch=279.2] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.086 | L2-Norm(final)=15.425 | 2666.3 samples/s | 41.7 steps/s
[Step=29400 Epoch=279.7] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=15.425 | 4369.5 samples/s | 68.3 steps/s
[Step=29450 Epoch=280.1] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.073 | L2-Norm(final)=15.426 | 6912.9 samples/s | 108.0 steps/s
[Step=29500 Epoch=280.6] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.066 | L2-Norm(final)=15.426 | 2146.8 samples/s | 33.5 steps/s
[Step=29550 Epoch=281.1] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.059 | L2-Norm(final)=15.426 | 6308.5 samples/s | 98.6 steps/s
[Step=29600 Epoch=281.6] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.053 | L2-Norm(final)=15.427 | 2261.2 samples/s | 35.3 steps/s
[Step=29650 Epoch=282.0] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.046 | L2-Norm(final)=15.427 | 5702.5 samples/s | 89.1 steps/s
[Step=29700 Epoch=282.5] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.039 | L2-Norm(final)=15.427 | 2330.9 samples/s | 36.4 steps/s
[Step=29750 Epoch=283.0] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.031 | L2-Norm(final)=15.428 | 5295.5 samples/s | 82.7 steps/s
[Step=29800 Epoch=283.5] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.024 | L2-Norm(final)=15.428 | 2393.8 samples/s | 37.4 steps/s
[Step=29850 Epoch=283.9] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=15.428 | 4915.0 samples/s | 76.8 steps/s
[Step=29900 Epoch=284.4] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=15.429 | 2521.7 samples/s | 39.4 steps/s
[Step=29950 Epoch=284.9] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.002 | L2-Norm(final)=15.429 | 4663.9 samples/s | 72.9 steps/s
[Step=30000 Epoch=285.4] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.995 | L2-Norm(final)=15.429 | 2540.8 samples/s | 39.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step30000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=38001 Epoch=358.1] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.136 | L2-Norm(final)=16.257 | 5756.5 samples/s | 89.9 steps/s
[Step=38050 Epoch=358.5] | Loss=0.00038 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.134 | L2-Norm(final)=16.266 | 4469.6 samples/s | 69.8 steps/s
[Step=38100 Epoch=359.0] | Loss=0.00034 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=16.276 | 8165.8 samples/s | 127.6 steps/s
[Step=38150 Epoch=359.5] | Loss=0.00032 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=16.286 | 2343.3 samples/s | 36.6 steps/s
[Step=38200 Epoch=360.0] | Loss=0.00033 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=16.296 | 7173.1 samples/s | 112.1 steps/s
[Step=38250 Epoch=360.4] | Loss=0.00034 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=16.306 | 2460.0 samples/s | 38.4 steps/s
[Step=38300 Epoch=360.9] | Loss=0.00033 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=16.316 | 6296.5 samples/s | 98.4 steps/s
[Step=38350 Epoch=361.4] | Loss=0.00033 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=16.325 | 2569.4 samples/s | 40.1 steps/s
[Step=38400 Epoch=361.8] | Loss=0.00032 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=16.335 | 5667.5 samples/s | 88.6 steps/s
[Step=38450 Epoch=362.3] | Loss=0.00032 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=16.344 | 2736.6 samples/s | 42.8 steps/s
[Step=38500 Epoch=362.8] | Loss=0.00033 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=16.352 | 5304.0 samples/s | 82.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=362.8] | Loss=0.00027 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=16.439 | 5947.2 samples/s | 92.9 steps/s
[Step=38550 Epoch=363.3] | Loss=0.00083 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.152 | L2-Norm(final)=16.443 | 4062.5 samples/s | 63.5 steps/s
[Step=38600 Epoch=363.7] | Loss=0.00044 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.173 | L2-Norm(final)=16.446 | 6559.3 samples/s | 102.5 steps/s
[Step=38650 Epoch=364.2] | Loss=0.00029 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.178 | L2-Norm(final)=16.448 | 2200.8 samples/s | 34.4 steps/s
[Step=38700 Epoch=364.7] | Loss=0.00022 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.178 | L2-Norm(final)=16.449 | 5909.1 samples/s | 92.3 steps/s
[Step=38750 Epoch=365.1] | Loss=0.00018 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.176 | L2-Norm(final)=16.450 | 2264.8 samples/s | 35.4 steps/s
[Step=38800 Epoch=365.6] | Loss=0.00015 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.173 | L2-Norm(final)=16.450 | 5336.5 samples/s | 83.4 steps/s
[Step=38850 Epoch=366.1] | Loss=0.00013 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.170 | L2-Norm(final)=16.451 | 2406.3 samples/s | 37.6 steps/s
[Step=38900 Epoch=366.5] | Loss=0.00011 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.166 | L2-Norm(final)=16.451 | 4797.4 samples/s | 75.0 steps/s
[Step=38950 Epoch=367.0] | Loss=0.00010 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=16.452 | 2502.9 samples/s | 39.1 steps/s
[Step=39000 Epoch=367.5] | Loss=0.00009 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.158 | L2-Norm(final)=16.452 | 4572.4 samples/s | 71.4 steps/s
[Step=39050 Epoch=368.0] | Loss=0.00008 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.154 | L2-Norm(final)=16.453 | 2589.0 samples/s | 40.5 steps/s
[Step=39100 Epoch=368.4] | Loss=0.00008 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.149 | L2-Norm(final)=16.453 | 4544.3 samples/s | 71.0 steps/s
[Step=39150 Epoch=368.9] | Loss=0.00007 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.145 | L2-Norm(final)=16.453 | 2585.3 samples/s | 40.4 steps/s
[Step=39200 Epoch=369.4] | Loss=0.00007 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.140 | L2-Norm(final)=16.454 | 4646.8 samples/s | 72.6 steps/s
[Step=39250 Epoch=369.8] | Loss=0.00006 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.136 | L2-Norm(final)=16.454 | 2857.2 samples/s | 44.6 steps/s
[Step=39300 Epoch=370.3] | Loss=0.00006 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.131 | L2-Norm(final)=16.454 | 4094.5 samples/s | 64.0 steps/s
[Step=39350 Epoch=370.8] | Loss=0.00005 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.126 | L2-Norm(final)=16.455 | 6662.8 samples/s | 104.1 steps/s
[Step=39400 Epoch=371.3] | Loss=0.00005 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.122 | L2-Norm(final)=16.455 | 2211.7 samples/s | 34.6 steps/s
[Step=39450 Epoch=371.7] | Loss=0.00005 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.117 | L2-Norm(final)=16.455 | 5838.2 samples/s | 91.2 steps/s
[Step=39500 Epoch=372.2] | Loss=0.00005 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.112 | L2-Norm(final)=16.456 | 2291.9 samples/s | 35.8 steps/s
[Step=39550 Epoch=372.7] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.107 | L2-Norm(final)=16.456 | 5430.9 samples/s | 84.9 steps/s
[Step=39600 Epoch=373.1] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.102 | L2-Norm(final)=16.456 | 2398.2 samples/s | 37.5 steps/s
[Step=39650 Epoch=373.6] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.097 | L2-Norm(final)=16.456 | 4982.6 samples/s | 77.9 steps/s
[Step=39700 Epoch=374.1] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.092 | L2-Norm(final)=16.457 | 2498.5 samples/s | 39.0 steps/s
[Step=39750 Epoch=374.6] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.087 | L2-Norm(final)=16.457 | 4619.9 samples/s | 72.2 steps/s
[Step=39800 Epoch=375.0] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.082 | L2-Norm(final)=16.457 | 2597.5 samples/s | 40.6 steps/s
[Step=39850 Epoch=375.5] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.076 | L2-Norm(final)=16.458 | 4606.3 samples/s | 72.0 steps/s
[Step=39900 Epoch=376.0] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.071 | L2-Norm(final)=16.458 | 2569.2 samples/s | 40.1 steps/s
[Step=39950 Epoch=376.4] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.066 | L2-Norm(final)=16.458 | 4615.0 samples/s | 72.1 steps/s
[Step=40000 Epoch=376.9] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.060 | L2-Norm(final)=16.458 | 2624.7 samples/s | 41.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08215 | acc=0.9627 | tpr=0.9710 | fpr=0.0553 | 4542.9 samples/s | 17.7 steps/s
Avg test loss: 0.08948, Avg test acc: 0.96113, Avg tpr: 0.97016, Avg fpr: 0.05871, total FA: 458

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08300 | acc=0.9659 | tpr=0.9796 | fpr=0.0637 | 4513.8 samples/s | 17.6 steps/s
Avg test loss: 0.09022, Avg test acc: 0.96434, Avg tpr: 0.97715, Avg fpr: 0.06384, total FA: 498

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08590 | acc=0.9643 | tpr=0.9791 | fpr=0.0679 | 4431.9 samples/s | 17.3 steps/s
Avg test loss: 0.09239, Avg test acc: 0.96270, Avg tpr: 0.97587, Avg fpr: 0.06627, total FA: 517

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08597 | acc=0.9654 | tpr=0.9783 | fpr=0.0627 | 5627.6 samples/s | 22.0 steps/s
Avg test loss: 0.09467, Avg test acc: 0.96394, Avg tpr: 0.97791, Avg fpr: 0.06679, total FA: 521

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08586 | acc=0.9645 | tpr=0.9764 | fpr=0.0612 | 5935.7 samples/s | 23.2 steps/s
Avg test loss: 0.09588, Avg test acc: 0.96346, Avg tpr: 0.97511, Avg fpr: 0.06217, total FA: 485

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.41569 | acc=0.2606 | tpr=0.0073 | fpr=0.1893 | 5730.9 samples/s | 22.4 steps/s
Avg test loss: 5.42207, Avg test acc: 0.25855, Avg tpr: 0.00729, Avg fpr: 0.18882, total FA: 1473

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.85680 | acc=0.2952 | tpr=0.0113 | fpr=0.0885 | 5597.4 samples/s | 21.9 steps/s
Avg test loss: 4.86905, Avg test acc: 0.29217, Avg tpr: 0.01078, Avg fpr: 0.08896, total FA: 694

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.29338 | acc=0.2238 | tpr=0.0134 | fpr=0.3191 | 5726.8 samples/s | 22.4 steps/s
Avg test loss: 5.29723, Avg test acc: 0.22374, Avg tpr: 0.01445, Avg fpr: 0.31599, total FA: 2465

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=6.27982 | acc=0.2412 | tpr=0.0103 | fpr=0.2572 | 5794.6 samples/s | 22.6 steps/s
Avg test loss: 6.29203, Avg test acc: 0.23948, Avg tpr: 0.01067, Avg fpr: 0.25727, total FA: 2007

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.58103 | acc=0.2480 | tpr=0.0047 | fpr=0.2237 | 5687.9 samples/s | 22.2 steps/s
Avg test loss: 5.59264, Avg test acc: 0.24689, Avg tpr: 0.00513, Avg fpr: 0.22138, total FA: 1727

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.16798 | acc=0.1600 | tpr=0.1947 | fpr=0.8406 | 5803.0 samples/s | 22.7 steps/s
[Step= 100] | Loss=5.12085 | acc=0.1605 | tpr=0.1791 | fpr=0.8398 | 8175.2 samples/s | 31.9 steps/s
[Step= 150] | Loss=5.13534 | acc=0.1597 | tpr=0.1772 | fpr=0.8407 | 7626.2 samples/s | 29.8 steps/s
[Step= 200] | Loss=5.12958 | acc=0.1594 | tpr=0.1770 | fpr=0.8409 | 8140.2 samples/s | 31.8 steps/s
[Step= 250] | Loss=5.13447 | acc=0.1598 | tpr=0.1773 | fpr=0.8406 | 8103.6 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.13864 | acc=0.1591 | tpr=0.1840 | fpr=0.8414 | 8393.3 samples/s | 32.8 steps/s
[Step= 350] | Loss=5.14160 | acc=0.1589 | tpr=0.1753 | fpr=0.8414 | 8227.3 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.14065 | acc=0.1594 | tpr=0.1778 | fpr=0.8410 | 7549.6 samples/s | 29.5 steps/s
[Step= 450] | Loss=5.14025 | acc=0.1596 | tpr=0.1767 | fpr=0.8407 | 8373.2 samples/s | 32.7 steps/s
[Step= 500] | Loss=5.14302 | acc=0.1596 | tpr=0.1819 | fpr=0.8408 | 8323.3 samples/s | 32.5 steps/s
[Step= 550] | Loss=5.14097 | acc=0.1598 | tpr=0.1803 | fpr=0.8406 | 9828.4 samples/s | 38.4 steps/s
Avg test loss: 5.14074, Avg test acc: 0.15968, Avg tpr: 0.18067, Avg fpr: 0.84070, total FA: 116730

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.88782 | acc=0.1364 | tpr=0.2257 | fpr=0.8652 | 5525.3 samples/s | 21.6 steps/s
[Step= 100] | Loss=4.84443 | acc=0.1395 | tpr=0.2132 | fpr=0.8619 | 8159.4 samples/s | 31.9 steps/s
[Step= 150] | Loss=4.85958 | acc=0.1376 | tpr=0.2104 | fpr=0.8638 | 8384.8 samples/s | 32.8 steps/s
[Step= 200] | Loss=4.85526 | acc=0.1381 | tpr=0.1989 | fpr=0.8630 | 8146.6 samples/s | 31.8 steps/s
[Step= 250] | Loss=4.85913 | acc=0.1384 | tpr=0.1983 | fpr=0.8627 | 8099.3 samples/s | 31.6 steps/s
[Step= 300] | Loss=4.86287 | acc=0.1379 | tpr=0.1985 | fpr=0.8632 | 8006.3 samples/s | 31.3 steps/s
[Step= 350] | Loss=4.86511 | acc=0.1376 | tpr=0.1847 | fpr=0.8633 | 7565.0 samples/s | 29.6 steps/s
[Step= 400] | Loss=4.86376 | acc=0.1381 | tpr=0.1904 | fpr=0.8628 | 8488.6 samples/s | 33.2 steps/s
[Step= 450] | Loss=4.86273 | acc=0.1384 | tpr=0.1923 | fpr=0.8626 | 8255.9 samples/s | 32.2 steps/s
[Step= 500] | Loss=4.86571 | acc=0.1381 | tpr=0.1938 | fpr=0.8629 | 7595.2 samples/s | 29.7 steps/s
[Step= 550] | Loss=4.86364 | acc=0.1385 | tpr=0.1922 | fpr=0.8625 | 10590.1 samples/s | 41.4 steps/s
Avg test loss: 4.86384, Avg test acc: 0.13839, Avg tpr: 0.19255, Avg fpr: 0.86260, total FA: 119770

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.99781 | acc=0.1295 | tpr=0.1372 | fpr=0.8706 | 5607.5 samples/s | 21.9 steps/s
[Step= 100] | Loss=5.94482 | acc=0.1309 | tpr=0.1365 | fpr=0.8692 | 7990.0 samples/s | 31.2 steps/s
[Step= 150] | Loss=5.95153 | acc=0.1292 | tpr=0.1354 | fpr=0.8709 | 8468.9 samples/s | 33.1 steps/s
[Step= 200] | Loss=5.94325 | acc=0.1298 | tpr=0.1333 | fpr=0.8703 | 7892.3 samples/s | 30.8 steps/s
[Step= 250] | Loss=5.94606 | acc=0.1295 | tpr=0.1301 | fpr=0.8705 | 7895.2 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.95190 | acc=0.1291 | tpr=0.1345 | fpr=0.8710 | 8240.9 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.95624 | acc=0.1285 | tpr=0.1265 | fpr=0.8714 | 7522.0 samples/s | 29.4 steps/s
[Step= 400] | Loss=5.95483 | acc=0.1289 | tpr=0.1340 | fpr=0.8712 | 8549.8 samples/s | 33.4 steps/s
[Step= 450] | Loss=5.95289 | acc=0.1290 | tpr=0.1329 | fpr=0.8711 | 8192.4 samples/s | 32.0 steps/s
[Step= 500] | Loss=5.95443 | acc=0.1288 | tpr=0.1339 | fpr=0.8713 | 7998.0 samples/s | 31.2 steps/s
[Step= 550] | Loss=5.95081 | acc=0.1290 | tpr=0.1333 | fpr=0.8710 | 9940.0 samples/s | 38.8 steps/s
Avg test loss: 5.95100, Avg test acc: 0.12894, Avg tpr: 0.13312, Avg fpr: 0.87113, total FA: 120955

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.52272 | acc=0.1418 | tpr=0.2257 | fpr=0.8597 | 5813.8 samples/s | 22.7 steps/s
[Step= 100] | Loss=5.47114 | acc=0.1426 | tpr=0.2154 | fpr=0.8588 | 7847.2 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.48658 | acc=0.1411 | tpr=0.2075 | fpr=0.8601 | 7304.0 samples/s | 28.5 steps/s
[Step= 200] | Loss=5.47798 | acc=0.1408 | tpr=0.2022 | fpr=0.8604 | 8178.9 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.48345 | acc=0.1413 | tpr=0.2114 | fpr=0.8600 | 8097.6 samples/s | 31.6 steps/s
[Step= 300] | Loss=5.48971 | acc=0.1405 | tpr=0.2124 | fpr=0.8609 | 8381.1 samples/s | 32.7 steps/s
[Step= 350] | Loss=5.49077 | acc=0.1401 | tpr=0.2016 | fpr=0.8610 | 8618.3 samples/s | 33.7 steps/s
[Step= 400] | Loss=5.48885 | acc=0.1407 | tpr=0.2090 | fpr=0.8606 | 7812.9 samples/s | 30.5 steps/s
[Step= 450] | Loss=5.48769 | acc=0.1409 | tpr=0.2064 | fpr=0.8603 | 8356.0 samples/s | 32.6 steps/s
[Step= 500] | Loss=5.49091 | acc=0.1406 | tpr=0.2093 | fpr=0.8606 | 7718.6 samples/s | 30.2 steps/s
[Step= 550] | Loss=5.48797 | acc=0.1407 | tpr=0.2073 | fpr=0.8605 | 10511.9 samples/s | 41.1 steps/s
Avg test loss: 5.48756, Avg test acc: 0.14064, Avg tpr: 0.20761, Avg fpr: 0.86058, total FA: 119490

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.37849 | acc=0.1341 | tpr=0.1416 | fpr=0.8660 | 5671.2 samples/s | 22.2 steps/s
[Step= 100] | Loss=6.32037 | acc=0.1354 | tpr=0.1279 | fpr=0.8644 | 7711.3 samples/s | 30.1 steps/s
[Step= 150] | Loss=6.33844 | acc=0.1347 | tpr=0.1254 | fpr=0.8651 | 8681.3 samples/s | 33.9 steps/s
[Step= 200] | Loss=6.33550 | acc=0.1353 | tpr=0.1191 | fpr=0.8644 | 8159.0 samples/s | 31.9 steps/s
[Step= 250] | Loss=6.34216 | acc=0.1356 | tpr=0.1205 | fpr=0.8642 | 7940.1 samples/s | 31.0 steps/s
[Step= 300] | Loss=6.34655 | acc=0.1354 | tpr=0.1215 | fpr=0.8643 | 7956.1 samples/s | 31.1 steps/s
[Step= 350] | Loss=6.34956 | acc=0.1349 | tpr=0.1165 | fpr=0.8647 | 8346.7 samples/s | 32.6 steps/s
[Step= 400] | Loss=6.34737 | acc=0.1355 | tpr=0.1220 | fpr=0.8643 | 7804.4 samples/s | 30.5 steps/s
[Step= 450] | Loss=6.34674 | acc=0.1359 | tpr=0.1241 | fpr=0.8639 | 8390.1 samples/s | 32.8 steps/s
[Step= 500] | Loss=6.35044 | acc=0.1357 | tpr=0.1256 | fpr=0.8641 | 8014.3 samples/s | 31.3 steps/s
[Step= 550] | Loss=6.34653 | acc=0.1356 | tpr=0.1246 | fpr=0.8642 | 9580.5 samples/s | 37.4 steps/s
Avg test loss: 6.34598, Avg test acc: 0.13547, Avg tpr: 0.12480, Avg fpr: 0.86434, total FA: 120012

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10464 | acc=0.9813 | tpr=0.9336 | fpr=0.0178 | 5687.6 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.10606 | acc=0.9812 | tpr=0.9488 | fpr=0.0181 | 8498.4 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.10908 | acc=0.9807 | tpr=0.9510 | fpr=0.0188 | 7783.2 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.11109 | acc=0.9807 | tpr=0.9541 | fpr=0.0188 | 7124.1 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.11173 | acc=0.9805 | tpr=0.9476 | fpr=0.0189 | 8639.2 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.11315 | acc=0.9803 | tpr=0.9469 | fpr=0.0191 | 8562.0 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.11342 | acc=0.9803 | tpr=0.9499 | fpr=0.0191 | 8400.5 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.11433 | acc=0.9802 | tpr=0.9458 | fpr=0.0191 | 8236.4 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.11675 | acc=0.9798 | tpr=0.9440 | fpr=0.0195 | 8186.4 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.11582 | acc=0.9800 | tpr=0.9458 | fpr=0.0194 | 7938.5 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.11495 | acc=0.9801 | tpr=0.9455 | fpr=0.0193 | 9577.8 samples/s | 37.4 steps/s
Avg test loss: 0.11472, Avg test acc: 0.98011, Avg tpr: 0.94532, Avg fpr: 0.01926, total FA: 2674

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09914 | acc=0.9812 | tpr=0.9115 | fpr=0.0175 | 5492.5 samples/s | 21.5 steps/s
[Step= 100] | Loss=0.10044 | acc=0.9809 | tpr=0.9275 | fpr=0.0181 | 8178.0 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.10317 | acc=0.9804 | tpr=0.9294 | fpr=0.0187 | 7639.3 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.10437 | acc=0.9803 | tpr=0.9301 | fpr=0.0188 | 8417.5 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.10514 | acc=0.9803 | tpr=0.9275 | fpr=0.0187 | 7954.4 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.10632 | acc=0.9802 | tpr=0.9287 | fpr=0.0189 | 8501.0 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.10638 | acc=0.9802 | tpr=0.9286 | fpr=0.0189 | 8161.9 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.10757 | acc=0.9800 | tpr=0.9240 | fpr=0.0190 | 8422.1 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.10939 | acc=0.9797 | tpr=0.9231 | fpr=0.0192 | 8027.1 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.10857 | acc=0.9798 | tpr=0.9251 | fpr=0.0192 | 7479.7 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.10758 | acc=0.9799 | tpr=0.9240 | fpr=0.0191 | 10600.4 samples/s | 41.4 steps/s
Avg test loss: 0.10738, Avg test acc: 0.97994, Avg tpr: 0.92353, Avg fpr: 0.01904, total FA: 2643

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12285 | acc=0.9775 | tpr=0.9381 | fpr=0.0218 | 5698.5 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.12432 | acc=0.9777 | tpr=0.9574 | fpr=0.0220 | 7650.5 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.12825 | acc=0.9773 | tpr=0.9597 | fpr=0.0224 | 8410.6 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.13018 | acc=0.9773 | tpr=0.9628 | fpr=0.0225 | 8149.1 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.13121 | acc=0.9772 | tpr=0.9590 | fpr=0.0225 | 7081.2 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.13241 | acc=0.9771 | tpr=0.9585 | fpr=0.0225 | 8315.3 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.13248 | acc=0.9770 | tpr=0.9612 | fpr=0.0227 | 8198.8 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.13333 | acc=0.9767 | tpr=0.9584 | fpr=0.0229 | 8669.7 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.13571 | acc=0.9763 | tpr=0.9562 | fpr=0.0233 | 8335.4 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.13481 | acc=0.9764 | tpr=0.9573 | fpr=0.0233 | 7944.3 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.13364 | acc=0.9765 | tpr=0.9570 | fpr=0.0231 | 9812.1 samples/s | 38.3 steps/s
Avg test loss: 0.13337, Avg test acc: 0.97655, Avg tpr: 0.95681, Avg fpr: 0.02309, total FA: 3206

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09576 | acc=0.9827 | tpr=0.9292 | fpr=0.0164 | 5771.9 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.09817 | acc=0.9822 | tpr=0.9360 | fpr=0.0170 | 8245.7 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.10118 | acc=0.9817 | tpr=0.9366 | fpr=0.0175 | 8044.6 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.10220 | acc=0.9815 | tpr=0.9388 | fpr=0.0177 | 7427.7 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.10326 | acc=0.9814 | tpr=0.9328 | fpr=0.0177 | 8333.8 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.10390 | acc=0.9815 | tpr=0.9302 | fpr=0.0176 | 8263.2 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.10387 | acc=0.9815 | tpr=0.9349 | fpr=0.0177 | 8043.5 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.10498 | acc=0.9813 | tpr=0.9305 | fpr=0.0177 | 8091.3 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.10689 | acc=0.9810 | tpr=0.9299 | fpr=0.0181 | 8046.2 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.10604 | acc=0.9811 | tpr=0.9313 | fpr=0.0180 | 8189.1 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.10548 | acc=0.9812 | tpr=0.9292 | fpr=0.0179 | 10379.8 samples/s | 40.5 steps/s
Avg test loss: 0.10530, Avg test acc: 0.98118, Avg tpr: 0.92908, Avg fpr: 0.01788, total FA: 2482

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10206 | acc=0.9821 | tpr=0.9204 | fpr=0.0168 | 5563.9 samples/s | 21.7 steps/s
[Step= 100] | Loss=0.10436 | acc=0.9821 | tpr=0.9360 | fpr=0.0171 | 8305.1 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.10726 | acc=0.9814 | tpr=0.9395 | fpr=0.0178 | 8034.7 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.10808 | acc=0.9815 | tpr=0.9454 | fpr=0.0179 | 7427.7 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.10870 | acc=0.9813 | tpr=0.9406 | fpr=0.0180 | 8190.0 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.10998 | acc=0.9813 | tpr=0.9396 | fpr=0.0179 | 8440.1 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.10991 | acc=0.9814 | tpr=0.9424 | fpr=0.0179 | 7686.1 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.11095 | acc=0.9813 | tpr=0.9382 | fpr=0.0180 | 7688.3 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.11304 | acc=0.9809 | tpr=0.9372 | fpr=0.0183 | 8150.1 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.11223 | acc=0.9811 | tpr=0.9396 | fpr=0.0182 | 8381.2 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.11140 | acc=0.9812 | tpr=0.9383 | fpr=0.0180 | 11551.7 samples/s | 45.1 steps/s
Avg test loss: 0.11120, Avg test acc: 0.98120, Avg tpr: 0.93819, Avg fpr: 0.01802, total FA: 2502

server round 37/50

clients selected: [3 4 5 7 9]

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=40001 Epoch=195.1] | Loss=0.01714 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.069 | L2-Norm(final)=15.029 | 5996.9 samples/s | 93.7 steps/s
[Step=40050 Epoch=195.3] | Loss=0.01582 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.069 | L2-Norm(final)=15.029 | 4853.9 samples/s | 75.8 steps/s
[Step=40100 Epoch=195.6] | Loss=0.01536 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.069 | L2-Norm(final)=15.030 | 5616.4 samples/s | 87.8 steps/s
[Step=40150 Epoch=195.8] | Loss=0.01491 | Reg=0.00101 | acc=0.9531 | L2-Norm=10.069 | L2-Norm(final)=15.031 | 5697.8 samples/s | 89.0 steps/s
[Step=40200 Epoch=196.0] | Loss=0.01543 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.069 | L2-Norm(final)=15.033 | 8644.4 samples/s | 135.1 steps/s
[Step=40250 Epoch=196.3] | Loss=0.01563 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.069 | L2-Norm(final)=15.034 | 2442.7 samples/s | 38.2 steps/s
[Step=40300 Epoch=196.5] | Loss=0.01547 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.069 | L2-Norm(final)=15.035 | 5570.3 samples/s | 87.0 steps/s
[Step=40350 Epoch=196.8] | Loss=0.01554 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.069 | L2-Norm(final)=15.036 | 5624.6 samples/s | 87.9 steps/s
[Step=40400 Epoch=197.0] | Loss=0.01516 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.069 | L2-Norm(final)=15.037 | 7730.0 samples/s | 120.8 steps/s
[Step=40450 Epoch=197.3] | Loss=0.01506 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.069 | L2-Norm(final)=15.038 | 2552.4 samples/s | 39.9 steps/s
[Step=40500 Epoch=197.5] | Loss=0.01500 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.069 | L2-Norm(final)=15.040 | 5539.9 samples/s | 86.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=40501 Epoch=197.5] | Loss=0.00762 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.069 | L2-Norm(final)=15.053 | 6120.6 samples/s | 95.6 steps/s
[Step=40550 Epoch=197.7] | Loss=0.01673 | Reg=0.00102 | acc=0.9688 | L2-Norm=10.085 | L2-Norm(final)=15.051 | 4257.7 samples/s | 66.5 steps/s
[Step=40600 Epoch=198.0] | Loss=0.01643 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.099 | L2-Norm(final)=15.050 | 4762.1 samples/s | 74.4 steps/s
[Step=40650 Epoch=198.2] | Loss=0.01492 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.111 | L2-Norm(final)=15.050 | 4912.2 samples/s | 76.8 steps/s
[Step=40700 Epoch=198.5] | Loss=0.01365 | Reg=0.00102 | acc=0.9688 | L2-Norm=10.121 | L2-Norm(final)=15.052 | 6929.2 samples/s | 108.3 steps/s
[Step=40750 Epoch=198.7] | Loss=0.01195 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.129 | L2-Norm(final)=15.053 | 2278.3 samples/s | 35.6 steps/s
[Step=40800 Epoch=199.0] | Loss=0.01085 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=15.056 | 4878.1 samples/s | 76.2 steps/s
[Step=40850 Epoch=199.2] | Loss=0.00988 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.141 | L2-Norm(final)=15.058 | 4833.7 samples/s | 75.5 steps/s
[Step=40900 Epoch=199.5] | Loss=0.00922 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.146 | L2-Norm(final)=15.060 | 6380.9 samples/s | 99.7 steps/s
[Step=40950 Epoch=199.7] | Loss=0.00864 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.150 | L2-Norm(final)=15.062 | 2353.7 samples/s | 36.8 steps/s
[Step=41000 Epoch=199.9] | Loss=0.00818 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.155 | L2-Norm(final)=15.064 | 4895.3 samples/s | 76.5 steps/s
[Step=41050 Epoch=200.2] | Loss=0.00783 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.158 | L2-Norm(final)=15.066 | 4861.5 samples/s | 76.0 steps/s
[Step=41100 Epoch=200.4] | Loss=0.00752 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.161 | L2-Norm(final)=15.068 | 5715.0 samples/s | 89.3 steps/s
[Step=41150 Epoch=200.7] | Loss=0.00715 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=15.070 | 2437.2 samples/s | 38.1 steps/s
[Step=41200 Epoch=200.9] | Loss=0.00683 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.167 | L2-Norm(final)=15.072 | 4835.3 samples/s | 75.6 steps/s
[Step=41250 Epoch=201.2] | Loss=0.00655 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.170 | L2-Norm(final)=15.074 | 4916.4 samples/s | 76.8 steps/s
[Step=41300 Epoch=201.4] | Loss=0.00638 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.173 | L2-Norm(final)=15.075 | 5278.7 samples/s | 82.5 steps/s
[Step=41350 Epoch=201.6] | Loss=0.00638 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.175 | L2-Norm(final)=15.077 | 2489.9 samples/s | 38.9 steps/s
[Step=41400 Epoch=201.9] | Loss=0.00620 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.178 | L2-Norm(final)=15.079 | 4874.2 samples/s | 76.2 steps/s
[Step=41450 Epoch=202.1] | Loss=0.00614 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.181 | L2-Norm(final)=15.080 | 4893.6 samples/s | 76.5 steps/s
[Step=41500 Epoch=202.4] | Loss=0.00609 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.183 | L2-Norm(final)=15.082 | 4967.9 samples/s | 77.6 steps/s
[Step=41550 Epoch=202.6] | Loss=0.00591 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.185 | L2-Norm(final)=15.083 | 2601.9 samples/s | 40.7 steps/s
[Step=41600 Epoch=202.9] | Loss=0.00571 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.188 | L2-Norm(final)=15.084 | 4952.0 samples/s | 77.4 steps/s
[Step=41650 Epoch=203.1] | Loss=0.00561 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.190 | L2-Norm(final)=15.086 | 4804.5 samples/s | 75.1 steps/s
[Step=41700 Epoch=203.4] | Loss=0.00556 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.192 | L2-Norm(final)=15.087 | 4850.2 samples/s | 75.8 steps/s
[Step=41750 Epoch=203.6] | Loss=0.00547 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.194 | L2-Norm(final)=15.088 | 2660.0 samples/s | 41.6 steps/s
[Step=41800 Epoch=203.8] | Loss=0.00535 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.196 | L2-Norm(final)=15.090 | 5037.9 samples/s | 78.7 steps/s
[Step=41850 Epoch=204.1] | Loss=0.00522 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.198 | L2-Norm(final)=15.091 | 4744.7 samples/s | 74.1 steps/s
[Step=41900 Epoch=204.3] | Loss=0.00512 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.200 | L2-Norm(final)=15.092 | 4839.9 samples/s | 75.6 steps/s
[Step=41950 Epoch=204.6] | Loss=0.00509 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.202 | L2-Norm(final)=15.094 | 2626.9 samples/s | 41.0 steps/s
[Step=42000 Epoch=204.8] | Loss=0.00499 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.203 | L2-Norm(final)=15.095 | 4880.6 samples/s | 76.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step42000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=48001 Epoch=235.4] | Loss=0.05138 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.069 | L2-Norm(final)=15.751 | 6401.0 samples/s | 100.0 steps/s
[Step=48050 Epoch=235.6] | Loss=0.01362 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.069 | L2-Norm(final)=15.750 | 4602.8 samples/s | 71.9 steps/s
[Step=48100 Epoch=235.9] | Loss=0.01411 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.069 | L2-Norm(final)=15.752 | 5831.7 samples/s | 91.1 steps/s
[Step=48150 Epoch=236.1] | Loss=0.01517 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.069 | L2-Norm(final)=15.752 | 5484.7 samples/s | 85.7 steps/s
[Step=48200 Epoch=236.4] | Loss=0.01612 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.069 | L2-Norm(final)=15.751 | 9028.9 samples/s | 141.1 steps/s
[Step=48250 Epoch=236.6] | Loss=0.01612 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.069 | L2-Norm(final)=15.750 | 2474.5 samples/s | 38.7 steps/s
[Step=48300 Epoch=236.9] | Loss=0.01626 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.069 | L2-Norm(final)=15.750 | 5230.7 samples/s | 81.7 steps/s
[Step=48350 Epoch=237.1] | Loss=0.01673 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.069 | L2-Norm(final)=15.748 | 5657.2 samples/s | 88.4 steps/s
[Step=48400 Epoch=237.3] | Loss=0.01658 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.069 | L2-Norm(final)=15.747 | 8263.5 samples/s | 129.1 steps/s
[Step=48450 Epoch=237.6] | Loss=0.01628 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.069 | L2-Norm(final)=15.746 | 2467.9 samples/s | 38.6 steps/s
[Step=48500 Epoch=237.8] | Loss=0.01623 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.069 | L2-Norm(final)=15.745 | 5746.6 samples/s | 89.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=48501 Epoch=237.8] | Loss=0.00148 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.069 | L2-Norm(final)=15.739 | 5615.9 samples/s | 87.7 steps/s
[Step=48550 Epoch=238.1] | Loss=0.01771 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.082 | L2-Norm(final)=15.738 | 4477.7 samples/s | 70.0 steps/s
[Step=48600 Epoch=238.3] | Loss=0.01671 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.097 | L2-Norm(final)=15.738 | 4898.2 samples/s | 76.5 steps/s
[Step=48650 Epoch=238.6] | Loss=0.01657 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.108 | L2-Norm(final)=15.739 | 4912.5 samples/s | 76.8 steps/s
[Step=48700 Epoch=238.8] | Loss=0.01517 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.117 | L2-Norm(final)=15.739 | 6970.7 samples/s | 108.9 steps/s
[Step=48750 Epoch=239.1] | Loss=0.01309 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.125 | L2-Norm(final)=15.741 | 2276.1 samples/s | 35.6 steps/s
[Step=48800 Epoch=239.3] | Loss=0.01189 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.132 | L2-Norm(final)=15.744 | 4863.4 samples/s | 76.0 steps/s
[Step=48850 Epoch=239.6] | Loss=0.01074 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.138 | L2-Norm(final)=15.746 | 4897.3 samples/s | 76.5 steps/s
[Step=48900 Epoch=239.8] | Loss=0.01001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.143 | L2-Norm(final)=15.749 | 6547.9 samples/s | 102.3 steps/s
[Step=48950 Epoch=240.0] | Loss=0.00936 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.148 | L2-Norm(final)=15.751 | 2273.9 samples/s | 35.5 steps/s
[Step=49000 Epoch=240.3] | Loss=0.00889 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.152 | L2-Norm(final)=15.753 | 4869.8 samples/s | 76.1 steps/s
[Step=49050 Epoch=240.5] | Loss=0.00844 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.156 | L2-Norm(final)=15.756 | 4862.0 samples/s | 76.0 steps/s
[Step=49100 Epoch=240.8] | Loss=0.00802 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.160 | L2-Norm(final)=15.758 | 6288.4 samples/s | 98.3 steps/s
[Step=49150 Epoch=241.0] | Loss=0.00758 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.163 | L2-Norm(final)=15.760 | 2332.4 samples/s | 36.4 steps/s
[Step=49200 Epoch=241.3] | Loss=0.00728 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.166 | L2-Norm(final)=15.762 | 4847.4 samples/s | 75.7 steps/s
[Step=49250 Epoch=241.5] | Loss=0.00707 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.169 | L2-Norm(final)=15.764 | 4903.2 samples/s | 76.6 steps/s
[Step=49300 Epoch=241.8] | Loss=0.00681 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.172 | L2-Norm(final)=15.766 | 5889.7 samples/s | 92.0 steps/s
[Step=49350 Epoch=242.0] | Loss=0.00653 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.175 | L2-Norm(final)=15.768 | 2380.6 samples/s | 37.2 steps/s
[Step=49400 Epoch=242.2] | Loss=0.00624 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.177 | L2-Norm(final)=15.770 | 4880.6 samples/s | 76.3 steps/s
[Step=49450 Epoch=242.5] | Loss=0.00605 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.180 | L2-Norm(final)=15.771 | 4857.8 samples/s | 75.9 steps/s
[Step=49500 Epoch=242.7] | Loss=0.00590 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.182 | L2-Norm(final)=15.773 | 5582.8 samples/s | 87.2 steps/s
[Step=49550 Epoch=243.0] | Loss=0.00576 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.184 | L2-Norm(final)=15.775 | 2485.1 samples/s | 38.8 steps/s
[Step=49600 Epoch=243.2] | Loss=0.00556 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.186 | L2-Norm(final)=15.777 | 4732.9 samples/s | 74.0 steps/s
[Step=49650 Epoch=243.5] | Loss=0.00546 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.189 | L2-Norm(final)=15.779 | 4942.8 samples/s | 77.2 steps/s
[Step=49700 Epoch=243.7] | Loss=0.00536 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.191 | L2-Norm(final)=15.780 | 5246.8 samples/s | 82.0 steps/s
[Step=49750 Epoch=244.0] | Loss=0.00524 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.193 | L2-Norm(final)=15.782 | 2525.6 samples/s | 39.5 steps/s
[Step=49800 Epoch=244.2] | Loss=0.00512 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.195 | L2-Norm(final)=15.784 | 4801.1 samples/s | 75.0 steps/s
[Step=49850 Epoch=244.5] | Loss=0.00497 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.197 | L2-Norm(final)=15.785 | 4883.9 samples/s | 76.3 steps/s
[Step=49900 Epoch=244.7] | Loss=0.00492 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.199 | L2-Norm(final)=15.787 | 5070.5 samples/s | 79.2 steps/s
[Step=49950 Epoch=244.9] | Loss=0.00484 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.200 | L2-Norm(final)=15.789 | 2600.1 samples/s | 40.6 steps/s
[Step=50000 Epoch=245.2] | Loss=0.00475 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.202 | L2-Norm(final)=15.790 | 4793.1 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step50000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=36001 Epoch=341.1] | Loss=0.00014 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.069 | L2-Norm(final)=15.635 | 5650.9 samples/s | 88.3 steps/s
[Step=36050 Epoch=341.6] | Loss=0.00030 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=15.643 | 4529.8 samples/s | 70.8 steps/s
[Step=36100 Epoch=342.1] | Loss=0.00029 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=15.652 | 8256.2 samples/s | 129.0 steps/s
[Step=36150 Epoch=342.6] | Loss=0.00028 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=15.661 | 2342.4 samples/s | 36.6 steps/s
[Step=36200 Epoch=343.0] | Loss=0.00027 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.066 | L2-Norm(final)=15.669 | 7316.1 samples/s | 114.3 steps/s
[Step=36250 Epoch=343.5] | Loss=0.00026 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.066 | L2-Norm(final)=15.678 | 2426.3 samples/s | 37.9 steps/s
[Step=36300 Epoch=344.0] | Loss=0.00027 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.066 | L2-Norm(final)=15.687 | 6508.3 samples/s | 101.7 steps/s
[Step=36350 Epoch=344.4] | Loss=0.00027 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.066 | L2-Norm(final)=15.695 | 2531.4 samples/s | 39.6 steps/s
[Step=36400 Epoch=344.9] | Loss=0.00027 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.066 | L2-Norm(final)=15.704 | 5907.9 samples/s | 92.3 steps/s
[Step=36450 Epoch=345.4] | Loss=0.00027 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.066 | L2-Norm(final)=15.712 | 2664.8 samples/s | 41.6 steps/s
[Step=36500 Epoch=345.9] | Loss=0.00027 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.066 | L2-Norm(final)=15.721 | 5406.2 samples/s | 84.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=345.9] | Loss=0.00004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.066 | L2-Norm(final)=15.807 | 5971.2 samples/s | 93.3 steps/s
[Step=36550 Epoch=346.3] | Loss=0.00023 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.071 | L2-Norm(final)=15.814 | 4022.3 samples/s | 62.8 steps/s
[Step=36600 Epoch=346.8] | Loss=0.00014 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.077 | L2-Norm(final)=15.816 | 6687.1 samples/s | 104.5 steps/s
[Step=36650 Epoch=347.3] | Loss=0.00010 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.076 | L2-Norm(final)=15.818 | 2183.0 samples/s | 34.1 steps/s
[Step=36700 Epoch=347.8] | Loss=0.00007 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.072 | L2-Norm(final)=15.820 | 6101.7 samples/s | 95.3 steps/s
[Step=36750 Epoch=348.2] | Loss=0.00006 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.068 | L2-Norm(final)=15.820 | 2280.8 samples/s | 35.6 steps/s
[Step=36800 Epoch=348.7] | Loss=0.00005 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=15.821 | 5529.1 samples/s | 86.4 steps/s
[Step=36850 Epoch=349.2] | Loss=0.00004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.057 | L2-Norm(final)=15.822 | 2355.5 samples/s | 36.8 steps/s
[Step=36900 Epoch=349.7] | Loss=0.00004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.052 | L2-Norm(final)=15.822 | 5122.6 samples/s | 80.0 steps/s
[Step=36950 Epoch=350.1] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.046 | L2-Norm(final)=15.823 | 2425.1 samples/s | 37.9 steps/s
[Step=37000 Epoch=350.6] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.040 | L2-Norm(final)=15.823 | 4757.5 samples/s | 74.3 steps/s
[Step=37050 Epoch=351.1] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.035 | L2-Norm(final)=15.824 | 2594.9 samples/s | 40.5 steps/s
[Step=37100 Epoch=351.6] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.029 | L2-Norm(final)=15.824 | 4476.7 samples/s | 69.9 steps/s
[Step=37150 Epoch=352.0] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=15.824 | 2539.5 samples/s | 39.7 steps/s
[Step=37200 Epoch=352.5] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.016 | L2-Norm(final)=15.825 | 4610.4 samples/s | 72.0 steps/s
[Step=37250 Epoch=353.0] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=15.825 | 2589.2 samples/s | 40.5 steps/s
[Step=37300 Epoch=353.4] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.004 | L2-Norm(final)=15.826 | 4659.5 samples/s | 72.8 steps/s
[Step=37350 Epoch=353.9] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.998 | L2-Norm(final)=15.826 | 2661.3 samples/s | 41.6 steps/s
[Step=37400 Epoch=354.4] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.991 | L2-Norm(final)=15.826 | 4343.4 samples/s | 67.9 steps/s
[Step=37450 Epoch=354.9] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.985 | L2-Norm(final)=15.827 | 6921.2 samples/s | 108.1 steps/s
[Step=37500 Epoch=355.3] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.978 | L2-Norm(final)=15.827 | 2161.5 samples/s | 33.8 steps/s
[Step=37550 Epoch=355.8] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.972 | L2-Norm(final)=15.827 | 6194.0 samples/s | 96.8 steps/s
[Step=37600 Epoch=356.3] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.965 | L2-Norm(final)=15.828 | 2240.9 samples/s | 35.0 steps/s
[Step=37650 Epoch=356.8] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.958 | L2-Norm(final)=15.828 | 5712.7 samples/s | 89.3 steps/s
[Step=37700 Epoch=357.2] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.951 | L2-Norm(final)=15.829 | 2331.1 samples/s | 36.4 steps/s
[Step=37750 Epoch=357.7] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.944 | L2-Norm(final)=15.829 | 5156.1 samples/s | 80.6 steps/s
[Step=37800 Epoch=358.2] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.937 | L2-Norm(final)=15.829 | 2420.9 samples/s | 37.8 steps/s
[Step=37850 Epoch=358.7] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.930 | L2-Norm(final)=15.830 | 4802.7 samples/s | 75.0 steps/s
[Step=37900 Epoch=359.1] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.923 | L2-Norm(final)=15.830 | 2508.9 samples/s | 39.2 steps/s
[Step=37950 Epoch=359.6] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.916 | L2-Norm(final)=15.831 | 4708.7 samples/s | 73.6 steps/s
[Step=38000 Epoch=360.1] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.909 | L2-Norm(final)=15.831 | 2520.7 samples/s | 39.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step38000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=36001 Epoch=343.8] | Loss=0.00023 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.069 | L2-Norm(final)=16.744 | 5399.1 samples/s | 84.4 steps/s
[Step=36050 Epoch=344.3] | Loss=0.00039 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.064 | L2-Norm(final)=16.733 | 4752.6 samples/s | 74.3 steps/s
[Step=36100 Epoch=344.7] | Loss=0.00049 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=16.726 | 8461.3 samples/s | 132.2 steps/s
[Step=36150 Epoch=345.2] | Loss=0.00045 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=16.722 | 2359.9 samples/s | 36.9 steps/s
[Step=36200 Epoch=345.7] | Loss=0.00045 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=16.719 | 7508.4 samples/s | 117.3 steps/s
[Step=36250 Epoch=346.2] | Loss=0.00041 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=16.716 | 2405.1 samples/s | 37.6 steps/s
[Step=36300 Epoch=346.6] | Loss=0.00042 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=16.715 | 6771.7 samples/s | 105.8 steps/s
[Step=36350 Epoch=347.1] | Loss=0.00040 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=16.713 | 2485.5 samples/s | 38.8 steps/s
[Step=36400 Epoch=347.6] | Loss=0.00039 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=16.712 | 6341.6 samples/s | 99.1 steps/s
[Step=36450 Epoch=348.1] | Loss=0.00039 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=16.712 | 2567.8 samples/s | 40.1 steps/s
[Step=36500 Epoch=348.6] | Loss=0.00039 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=16.711 | 5908.9 samples/s | 92.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=348.6] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=16.711 | 5814.4 samples/s | 90.8 steps/s
[Step=36550 Epoch=349.0] | Loss=0.00055 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.092 | L2-Norm(final)=16.714 | 4048.1 samples/s | 63.3 steps/s
[Step=36600 Epoch=349.5] | Loss=0.00037 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.113 | L2-Norm(final)=16.715 | 6787.5 samples/s | 106.1 steps/s
[Step=36650 Epoch=350.0] | Loss=0.00028 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.120 | L2-Norm(final)=16.716 | 2171.9 samples/s | 33.9 steps/s
[Step=36700 Epoch=350.5] | Loss=0.00021 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.123 | L2-Norm(final)=16.717 | 6132.9 samples/s | 95.8 steps/s
[Step=36750 Epoch=350.9] | Loss=0.00017 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.124 | L2-Norm(final)=16.718 | 2241.2 samples/s | 35.0 steps/s
[Step=36800 Epoch=351.4] | Loss=0.00014 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.123 | L2-Norm(final)=16.719 | 5748.8 samples/s | 89.8 steps/s
[Step=36850 Epoch=351.9] | Loss=0.00012 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.121 | L2-Norm(final)=16.719 | 2302.0 samples/s | 36.0 steps/s
[Step=36900 Epoch=352.4] | Loss=0.00011 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.118 | L2-Norm(final)=16.719 | 5389.4 samples/s | 84.2 steps/s
[Step=36950 Epoch=352.8] | Loss=0.00010 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.115 | L2-Norm(final)=16.719 | 2364.1 samples/s | 36.9 steps/s
[Step=37000 Epoch=353.3] | Loss=0.00009 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.112 | L2-Norm(final)=16.720 | 5055.7 samples/s | 79.0 steps/s
[Step=37050 Epoch=353.8] | Loss=0.00008 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.109 | L2-Norm(final)=16.720 | 2453.6 samples/s | 38.3 steps/s
[Step=37100 Epoch=354.3] | Loss=0.00007 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.106 | L2-Norm(final)=16.720 | 4728.8 samples/s | 73.9 steps/s
[Step=37150 Epoch=354.8] | Loss=0.00007 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.102 | L2-Norm(final)=16.720 | 2535.1 samples/s | 39.6 steps/s
[Step=37200 Epoch=355.2] | Loss=0.00006 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.099 | L2-Norm(final)=16.720 | 4757.5 samples/s | 74.3 steps/s
[Step=37250 Epoch=355.7] | Loss=0.00006 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.095 | L2-Norm(final)=16.720 | 2544.4 samples/s | 39.8 steps/s
[Step=37300 Epoch=356.2] | Loss=0.00005 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.091 | L2-Norm(final)=16.720 | 4615.7 samples/s | 72.1 steps/s
[Step=37350 Epoch=356.7] | Loss=0.00005 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.087 | L2-Norm(final)=16.721 | 2588.7 samples/s | 40.4 steps/s
[Step=37400 Epoch=357.1] | Loss=0.00005 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.084 | L2-Norm(final)=16.721 | 4593.2 samples/s | 71.8 steps/s
[Step=37450 Epoch=357.6] | Loss=0.00005 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=16.721 | 2624.0 samples/s | 41.0 steps/s
[Step=37500 Epoch=358.1] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.076 | L2-Norm(final)=16.721 | 4401.0 samples/s | 68.8 steps/s
[Step=37550 Epoch=358.6] | Loss=0.00004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.072 | L2-Norm(final)=16.721 | 7464.5 samples/s | 116.6 steps/s
[Step=37600 Epoch=359.1] | Loss=0.00004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=16.721 | 2133.0 samples/s | 33.3 steps/s
[Step=37650 Epoch=359.5] | Loss=0.00004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=16.721 | 6839.4 samples/s | 106.9 steps/s
[Step=37700 Epoch=360.0] | Loss=0.00004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.059 | L2-Norm(final)=16.721 | 2178.3 samples/s | 34.0 steps/s
[Step=37750 Epoch=360.5] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.055 | L2-Norm(final)=16.721 | 6270.7 samples/s | 98.0 steps/s
[Step=37800 Epoch=361.0] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.050 | L2-Norm(final)=16.721 | 2252.3 samples/s | 35.2 steps/s
[Step=37850 Epoch=361.4] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.046 | L2-Norm(final)=16.721 | 5693.5 samples/s | 89.0 steps/s
[Step=37900 Epoch=361.9] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.042 | L2-Norm(final)=16.722 | 2321.9 samples/s | 36.3 steps/s
[Step=37950 Epoch=362.4] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.037 | L2-Norm(final)=16.722 | 5295.8 samples/s | 82.7 steps/s
[Step=38000 Epoch=362.9] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.033 | L2-Norm(final)=16.722 | 2352.2 samples/s | 36.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step38000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=24001 Epoch=228.8] | Loss=0.00122 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.069 | L2-Norm(final)=14.460 | 5507.8 samples/s | 86.1 steps/s
[Step=24050 Epoch=229.2] | Loss=0.00100 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=14.461 | 5034.7 samples/s | 78.7 steps/s
[Step=24100 Epoch=229.7] | Loss=0.00078 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=14.469 | 7906.7 samples/s | 123.5 steps/s
[Step=24150 Epoch=230.2] | Loss=0.00076 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=14.475 | 2335.5 samples/s | 36.5 steps/s
[Step=24200 Epoch=230.6] | Loss=0.00077 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=14.482 | 7628.6 samples/s | 119.2 steps/s
[Step=24250 Epoch=231.1] | Loss=0.00077 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=14.488 | 2475.4 samples/s | 38.7 steps/s
[Step=24300 Epoch=231.6] | Loss=0.00076 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=14.494 | 6431.9 samples/s | 100.5 steps/s
[Step=24350 Epoch=232.1] | Loss=0.00076 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=14.501 | 2481.0 samples/s | 38.8 steps/s
[Step=24400 Epoch=232.6] | Loss=0.00075 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=14.508 | 6264.0 samples/s | 97.9 steps/s
[Step=24450 Epoch=233.0] | Loss=0.00074 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=14.515 | 2581.1 samples/s | 40.3 steps/s
[Step=24500 Epoch=233.5] | Loss=0.00075 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=14.521 | 5692.8 samples/s | 88.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=24501 Epoch=233.5] | Loss=0.00004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.066 | L2-Norm(final)=14.588 | 6022.3 samples/s | 94.1 steps/s
[Step=24550 Epoch=234.0] | Loss=0.00064 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.088 | L2-Norm(final)=14.594 | 4117.4 samples/s | 64.3 steps/s
[Step=24600 Epoch=234.5] | Loss=0.00035 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.103 | L2-Norm(final)=14.598 | 6633.7 samples/s | 103.7 steps/s
[Step=24650 Epoch=234.9] | Loss=0.00024 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.107 | L2-Norm(final)=14.601 | 2201.5 samples/s | 34.4 steps/s
[Step=24700 Epoch=235.4] | Loss=0.00018 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.107 | L2-Norm(final)=14.603 | 6208.7 samples/s | 97.0 steps/s
[Step=24750 Epoch=235.9] | Loss=0.00015 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.105 | L2-Norm(final)=14.604 | 2241.9 samples/s | 35.0 steps/s
[Step=24800 Epoch=236.4] | Loss=0.00012 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.102 | L2-Norm(final)=14.605 | 5782.2 samples/s | 90.3 steps/s
[Step=24850 Epoch=236.8] | Loss=0.00011 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.099 | L2-Norm(final)=14.606 | 2296.1 samples/s | 35.9 steps/s
[Step=24900 Epoch=237.3] | Loss=0.00010 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.096 | L2-Norm(final)=14.607 | 5356.4 samples/s | 83.7 steps/s
[Step=24950 Epoch=237.8] | Loss=0.00009 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.092 | L2-Norm(final)=14.607 | 2371.8 samples/s | 37.1 steps/s
[Step=25000 Epoch=238.3] | Loss=0.00008 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.089 | L2-Norm(final)=14.608 | 5049.0 samples/s | 78.9 steps/s
[Step=25050 Epoch=238.7] | Loss=0.00007 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.085 | L2-Norm(final)=14.609 | 2455.6 samples/s | 38.4 steps/s
[Step=25100 Epoch=239.2] | Loss=0.00007 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.081 | L2-Norm(final)=14.609 | 4736.1 samples/s | 74.0 steps/s
[Step=25150 Epoch=239.7] | Loss=0.00006 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.077 | L2-Norm(final)=14.610 | 2533.2 samples/s | 39.6 steps/s
[Step=25200 Epoch=240.2] | Loss=0.00006 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.072 | L2-Norm(final)=14.611 | 4572.1 samples/s | 71.4 steps/s
[Step=25250 Epoch=240.7] | Loss=0.00005 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.068 | L2-Norm(final)=14.611 | 2576.8 samples/s | 40.3 steps/s
[Step=25300 Epoch=241.1] | Loss=0.00005 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.064 | L2-Norm(final)=14.612 | 4715.7 samples/s | 73.7 steps/s
[Step=25350 Epoch=241.6] | Loss=0.00005 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.059 | L2-Norm(final)=14.612 | 2548.0 samples/s | 39.8 steps/s
[Step=25400 Epoch=242.1] | Loss=0.00004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.055 | L2-Norm(final)=14.613 | 4605.5 samples/s | 72.0 steps/s
[Step=25450 Epoch=242.6] | Loss=0.00004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.050 | L2-Norm(final)=14.614 | 2546.3 samples/s | 39.8 steps/s
[Step=25500 Epoch=243.0] | Loss=0.00004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.046 | L2-Norm(final)=14.614 | 4597.8 samples/s | 71.8 steps/s
[Step=25550 Epoch=243.5] | Loss=0.00004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.041 | L2-Norm(final)=14.615 | 7388.7 samples/s | 115.4 steps/s
[Step=25600 Epoch=244.0] | Loss=0.00004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.036 | L2-Norm(final)=14.615 | 2125.8 samples/s | 33.2 steps/s
[Step=25650 Epoch=244.5] | Loss=0.00004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.032 | L2-Norm(final)=14.616 | 6805.5 samples/s | 106.3 steps/s
[Step=25700 Epoch=244.9] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.027 | L2-Norm(final)=14.616 | 2200.5 samples/s | 34.4 steps/s
[Step=25750 Epoch=245.4] | Loss=0.00003 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.022 | L2-Norm(final)=14.617 | 6171.7 samples/s | 96.4 steps/s
[Step=25800 Epoch=245.9] | Loss=0.00003 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=14.617 | 2269.0 samples/s | 35.5 steps/s
[Step=25850 Epoch=246.4] | Loss=0.00003 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=14.618 | 5685.5 samples/s | 88.8 steps/s
[Step=25900 Epoch=246.9] | Loss=0.00003 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.007 | L2-Norm(final)=14.618 | 2323.6 samples/s | 36.3 steps/s
[Step=25950 Epoch=247.3] | Loss=0.00003 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.002 | L2-Norm(final)=14.619 | 5419.7 samples/s | 84.7 steps/s
[Step=26000 Epoch=247.8] | Loss=0.00003 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.997 | L2-Norm(final)=14.619 | 2360.1 samples/s | 36.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4/client_state-step26000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08215 | acc=0.9627 | tpr=0.9710 | fpr=0.0553 | 5579.0 samples/s | 21.8 steps/s
Avg test loss: 0.08948, Avg test acc: 0.96113, Avg tpr: 0.97016, Avg fpr: 0.05871, total FA: 458

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08300 | acc=0.9659 | tpr=0.9796 | fpr=0.0637 | 5708.4 samples/s | 22.3 steps/s
Avg test loss: 0.09022, Avg test acc: 0.96434, Avg tpr: 0.97715, Avg fpr: 0.06384, total FA: 498

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08590 | acc=0.9643 | tpr=0.9791 | fpr=0.0679 | 5773.7 samples/s | 22.6 steps/s
Avg test loss: 0.09239, Avg test acc: 0.96270, Avg tpr: 0.97587, Avg fpr: 0.06627, total FA: 517

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08413 | acc=0.9641 | tpr=0.9739 | fpr=0.0572 | 5778.8 samples/s | 22.6 steps/s
Avg test loss: 0.09125, Avg test acc: 0.96342, Avg tpr: 0.97342, Avg fpr: 0.05858, total FA: 457

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08267 | acc=0.9636 | tpr=0.9718 | fpr=0.0543 | 5782.3 samples/s | 22.6 steps/s
Avg test loss: 0.09400, Avg test acc: 0.96302, Avg tpr: 0.97121, Avg fpr: 0.05499, total FA: 429

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.48582 | acc=0.2774 | tpr=0.0056 | fpr=0.1323 | 5804.7 samples/s | 22.7 steps/s
Avg test loss: 5.49666, Avg test acc: 0.27594, Avg tpr: 0.00624, Avg fpr: 0.13088, total FA: 1021

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.85680 | acc=0.2952 | tpr=0.0113 | fpr=0.0885 | 5706.7 samples/s | 22.3 steps/s
Avg test loss: 4.86905, Avg test acc: 0.29217, Avg tpr: 0.01078, Avg fpr: 0.08896, total FA: 694

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=6.07094 | acc=0.2473 | tpr=0.0201 | fpr=0.2592 | 5795.0 samples/s | 22.6 steps/s
Avg test loss: 6.07840, Avg test acc: 0.24794, Avg tpr: 0.02133, Avg fpr: 0.25369, total FA: 1979

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=6.27982 | acc=0.2412 | tpr=0.0103 | fpr=0.2572 | 5630.8 samples/s | 22.0 steps/s
Avg test loss: 6.29203, Avg test acc: 0.23948, Avg tpr: 0.01067, Avg fpr: 0.25727, total FA: 2007

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.62378 | acc=0.2502 | tpr=0.0051 | fpr=0.2178 | 5682.4 samples/s | 22.2 steps/s
Avg test loss: 5.63406, Avg test acc: 0.25002, Avg tpr: 0.00589, Avg fpr: 0.21305, total FA: 1662

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.16798 | acc=0.1600 | tpr=0.1947 | fpr=0.8406 | 5666.0 samples/s | 22.1 steps/s
[Step= 100] | Loss=5.12085 | acc=0.1605 | tpr=0.1791 | fpr=0.8398 | 8085.4 samples/s | 31.6 steps/s
[Step= 150] | Loss=5.13534 | acc=0.1597 | tpr=0.1772 | fpr=0.8407 | 7837.8 samples/s | 30.6 steps/s
[Step= 200] | Loss=5.12958 | acc=0.1594 | tpr=0.1770 | fpr=0.8409 | 8340.2 samples/s | 32.6 steps/s
[Step= 250] | Loss=5.13447 | acc=0.1598 | tpr=0.1773 | fpr=0.8406 | 7480.5 samples/s | 29.2 steps/s
[Step= 300] | Loss=5.13864 | acc=0.1591 | tpr=0.1840 | fpr=0.8414 | 8399.6 samples/s | 32.8 steps/s
[Step= 350] | Loss=5.14160 | acc=0.1589 | tpr=0.1753 | fpr=0.8414 | 7949.0 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.14065 | acc=0.1594 | tpr=0.1778 | fpr=0.8410 | 7828.5 samples/s | 30.6 steps/s
[Step= 450] | Loss=5.14025 | acc=0.1596 | tpr=0.1767 | fpr=0.8407 | 8388.5 samples/s | 32.8 steps/s
[Step= 500] | Loss=5.14302 | acc=0.1596 | tpr=0.1819 | fpr=0.8408 | 8504.5 samples/s | 33.2 steps/s
[Step= 550] | Loss=5.14097 | acc=0.1598 | tpr=0.1803 | fpr=0.8406 | 9841.0 samples/s | 38.4 steps/s
Avg test loss: 5.14074, Avg test acc: 0.15968, Avg tpr: 0.18067, Avg fpr: 0.84070, total FA: 116730

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.88782 | acc=0.1364 | tpr=0.2257 | fpr=0.8652 | 5656.0 samples/s | 22.1 steps/s
[Step= 100] | Loss=4.84443 | acc=0.1395 | tpr=0.2132 | fpr=0.8619 | 8054.2 samples/s | 31.5 steps/s
[Step= 150] | Loss=4.85958 | acc=0.1376 | tpr=0.2104 | fpr=0.8638 | 8293.4 samples/s | 32.4 steps/s
[Step= 200] | Loss=4.85526 | acc=0.1381 | tpr=0.1989 | fpr=0.8630 | 8032.5 samples/s | 31.4 steps/s
[Step= 250] | Loss=4.85913 | acc=0.1384 | tpr=0.1983 | fpr=0.8627 | 8274.9 samples/s | 32.3 steps/s
[Step= 300] | Loss=4.86287 | acc=0.1379 | tpr=0.1985 | fpr=0.8632 | 8055.1 samples/s | 31.5 steps/s
[Step= 350] | Loss=4.86511 | acc=0.1376 | tpr=0.1847 | fpr=0.8633 | 7677.4 samples/s | 30.0 steps/s
[Step= 400] | Loss=4.86376 | acc=0.1381 | tpr=0.1904 | fpr=0.8628 | 8155.4 samples/s | 31.9 steps/s
[Step= 450] | Loss=4.86273 | acc=0.1384 | tpr=0.1923 | fpr=0.8626 | 8219.4 samples/s | 32.1 steps/s
[Step= 500] | Loss=4.86571 | acc=0.1381 | tpr=0.1938 | fpr=0.8629 | 8284.0 samples/s | 32.4 steps/s
[Step= 550] | Loss=4.86364 | acc=0.1385 | tpr=0.1922 | fpr=0.8625 | 9556.2 samples/s | 37.3 steps/s
Avg test loss: 4.86384, Avg test acc: 0.13839, Avg tpr: 0.19255, Avg fpr: 0.86260, total FA: 119770

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.99781 | acc=0.1295 | tpr=0.1372 | fpr=0.8706 | 5674.6 samples/s | 22.2 steps/s
[Step= 100] | Loss=5.94482 | acc=0.1309 | tpr=0.1365 | fpr=0.8692 | 8036.8 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.95153 | acc=0.1292 | tpr=0.1354 | fpr=0.8709 | 7907.6 samples/s | 30.9 steps/s
[Step= 200] | Loss=5.94325 | acc=0.1298 | tpr=0.1333 | fpr=0.8703 | 7767.5 samples/s | 30.3 steps/s
[Step= 250] | Loss=5.94606 | acc=0.1295 | tpr=0.1301 | fpr=0.8705 | 7472.3 samples/s | 29.2 steps/s
[Step= 300] | Loss=5.95190 | acc=0.1291 | tpr=0.1345 | fpr=0.8710 | 8581.0 samples/s | 33.5 steps/s
[Step= 350] | Loss=5.95624 | acc=0.1285 | tpr=0.1265 | fpr=0.8714 | 8287.7 samples/s | 32.4 steps/s
[Step= 400] | Loss=5.95483 | acc=0.1289 | tpr=0.1340 | fpr=0.8712 | 7571.2 samples/s | 29.6 steps/s
[Step= 450] | Loss=5.95289 | acc=0.1290 | tpr=0.1329 | fpr=0.8711 | 8366.5 samples/s | 32.7 steps/s
[Step= 500] | Loss=5.95443 | acc=0.1288 | tpr=0.1339 | fpr=0.8713 | 8185.1 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.95081 | acc=0.1290 | tpr=0.1333 | fpr=0.8710 | 11097.2 samples/s | 43.3 steps/s
Avg test loss: 5.95100, Avg test acc: 0.12894, Avg tpr: 0.13312, Avg fpr: 0.87113, total FA: 120955

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.96986 | acc=0.1605 | tpr=0.1726 | fpr=0.8397 | 5677.8 samples/s | 22.2 steps/s
[Step= 100] | Loss=4.92430 | acc=0.1608 | tpr=0.1578 | fpr=0.8391 | 7795.6 samples/s | 30.5 steps/s
[Step= 150] | Loss=4.93292 | acc=0.1593 | tpr=0.1556 | fpr=0.8407 | 8534.6 samples/s | 33.3 steps/s
[Step= 200] | Loss=4.92526 | acc=0.1590 | tpr=0.1541 | fpr=0.8409 | 8300.1 samples/s | 32.4 steps/s
[Step= 250] | Loss=4.93083 | acc=0.1591 | tpr=0.1572 | fpr=0.8408 | 7440.3 samples/s | 29.1 steps/s
[Step= 300] | Loss=4.93675 | acc=0.1583 | tpr=0.1600 | fpr=0.8417 | 8275.1 samples/s | 32.3 steps/s
[Step= 350] | Loss=4.93746 | acc=0.1584 | tpr=0.1515 | fpr=0.8415 | 8649.6 samples/s | 33.8 steps/s
[Step= 400] | Loss=4.93522 | acc=0.1589 | tpr=0.1581 | fpr=0.8410 | 8571.8 samples/s | 33.5 steps/s
[Step= 450] | Loss=4.93433 | acc=0.1590 | tpr=0.1582 | fpr=0.8410 | 7389.3 samples/s | 28.9 steps/s
[Step= 500] | Loss=4.93750 | acc=0.1589 | tpr=0.1595 | fpr=0.8411 | 7836.5 samples/s | 30.6 steps/s
[Step= 550] | Loss=4.93536 | acc=0.1590 | tpr=0.1616 | fpr=0.8410 | 10676.6 samples/s | 41.7 steps/s
Avg test loss: 4.93503, Avg test acc: 0.15893, Avg tpr: 0.16165, Avg fpr: 0.84112, total FA: 116788

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.70067 | acc=0.1468 | tpr=0.1283 | fpr=0.8529 | 5707.1 samples/s | 22.3 steps/s
[Step= 100] | Loss=5.64830 | acc=0.1482 | tpr=0.1194 | fpr=0.8512 | 7574.6 samples/s | 29.6 steps/s
[Step= 150] | Loss=5.66426 | acc=0.1478 | tpr=0.1081 | fpr=0.8515 | 7753.7 samples/s | 30.3 steps/s
[Step= 200] | Loss=5.66213 | acc=0.1482 | tpr=0.1060 | fpr=0.8510 | 8237.0 samples/s | 32.2 steps/s
[Step= 250] | Loss=5.67033 | acc=0.1484 | tpr=0.1092 | fpr=0.8509 | 8345.7 samples/s | 32.6 steps/s
[Step= 300] | Loss=5.67439 | acc=0.1481 | tpr=0.1091 | fpr=0.8512 | 7865.0 samples/s | 30.7 steps/s
[Step= 350] | Loss=5.67727 | acc=0.1476 | tpr=0.1027 | fpr=0.8516 | 8109.0 samples/s | 31.7 steps/s
[Step= 400] | Loss=5.67603 | acc=0.1482 | tpr=0.1083 | fpr=0.8511 | 7680.2 samples/s | 30.0 steps/s
[Step= 450] | Loss=5.67528 | acc=0.1487 | tpr=0.1081 | fpr=0.8506 | 8436.5 samples/s | 33.0 steps/s
[Step= 500] | Loss=5.67900 | acc=0.1483 | tpr=0.1088 | fpr=0.8510 | 8288.1 samples/s | 32.4 steps/s
[Step= 550] | Loss=5.67521 | acc=0.1484 | tpr=0.1074 | fpr=0.8509 | 10596.4 samples/s | 41.4 steps/s
Avg test loss: 5.67481, Avg test acc: 0.14823, Avg tpr: 0.10737, Avg fpr: 0.85102, total FA: 118163

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11048 | acc=0.9810 | tpr=0.9336 | fpr=0.0181 | 5775.6 samples/s | 22.6 steps/s
[Step= 100] | Loss=0.11174 | acc=0.9811 | tpr=0.9403 | fpr=0.0182 | 8016.9 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.11536 | acc=0.9806 | tpr=0.9438 | fpr=0.0187 | 7952.7 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.11709 | acc=0.9807 | tpr=0.9486 | fpr=0.0187 | 7099.1 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.11750 | acc=0.9805 | tpr=0.9441 | fpr=0.0188 | 8109.6 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.11901 | acc=0.9804 | tpr=0.9447 | fpr=0.0189 | 8302.8 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.11933 | acc=0.9805 | tpr=0.9480 | fpr=0.0190 | 8274.1 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.12028 | acc=0.9802 | tpr=0.9437 | fpr=0.0191 | 8179.0 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.12265 | acc=0.9799 | tpr=0.9416 | fpr=0.0195 | 8033.3 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.12179 | acc=0.9800 | tpr=0.9432 | fpr=0.0194 | 7644.7 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.12077 | acc=0.9801 | tpr=0.9427 | fpr=0.0192 | 12543.7 samples/s | 49.0 steps/s
Avg test loss: 0.12055, Avg test acc: 0.98010, Avg tpr: 0.94255, Avg fpr: 0.01922, total FA: 2668

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09914 | acc=0.9812 | tpr=0.9115 | fpr=0.0175 | 5911.4 samples/s | 23.1 steps/s
[Step= 100] | Loss=0.10044 | acc=0.9809 | tpr=0.9275 | fpr=0.0181 | 7661.1 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.10317 | acc=0.9804 | tpr=0.9294 | fpr=0.0187 | 8398.4 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.10437 | acc=0.9803 | tpr=0.9301 | fpr=0.0188 | 7946.1 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.10514 | acc=0.9803 | tpr=0.9275 | fpr=0.0187 | 7937.9 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.10632 | acc=0.9802 | tpr=0.9287 | fpr=0.0189 | 7851.2 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.10638 | acc=0.9802 | tpr=0.9286 | fpr=0.0189 | 8103.7 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.10757 | acc=0.9800 | tpr=0.9240 | fpr=0.0190 | 8403.8 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.10939 | acc=0.9797 | tpr=0.9231 | fpr=0.0192 | 8036.1 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.10857 | acc=0.9798 | tpr=0.9251 | fpr=0.0192 | 7965.6 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.10758 | acc=0.9799 | tpr=0.9240 | fpr=0.0191 | 9925.5 samples/s | 38.8 steps/s
Avg test loss: 0.10738, Avg test acc: 0.97994, Avg tpr: 0.92353, Avg fpr: 0.01904, total FA: 2643

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.14784 | acc=0.9773 | tpr=0.9336 | fpr=0.0220 | 5578.1 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.14978 | acc=0.9772 | tpr=0.9467 | fpr=0.0222 | 7724.3 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.15557 | acc=0.9763 | tpr=0.9496 | fpr=0.0232 | 8147.0 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.15826 | acc=0.9763 | tpr=0.9508 | fpr=0.0233 | 7995.4 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.15927 | acc=0.9762 | tpr=0.9485 | fpr=0.0233 | 8160.3 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.16086 | acc=0.9760 | tpr=0.9476 | fpr=0.0235 | 8045.2 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.16105 | acc=0.9759 | tpr=0.9499 | fpr=0.0236 | 7895.1 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.16246 | acc=0.9756 | tpr=0.9469 | fpr=0.0239 | 7817.2 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.16528 | acc=0.9751 | tpr=0.9455 | fpr=0.0243 | 8355.7 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.16401 | acc=0.9752 | tpr=0.9467 | fpr=0.0243 | 8372.2 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.16274 | acc=0.9753 | tpr=0.9459 | fpr=0.0242 | 10590.2 samples/s | 41.4 steps/s
Avg test loss: 0.16241, Avg test acc: 0.97534, Avg tpr: 0.94572, Avg fpr: 0.02412, total FA: 3349

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09576 | acc=0.9827 | tpr=0.9292 | fpr=0.0164 | 5729.8 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.09817 | acc=0.9822 | tpr=0.9360 | fpr=0.0170 | 7993.8 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.10118 | acc=0.9817 | tpr=0.9366 | fpr=0.0175 | 7462.7 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.10220 | acc=0.9815 | tpr=0.9388 | fpr=0.0177 | 8213.3 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.10326 | acc=0.9814 | tpr=0.9328 | fpr=0.0177 | 8096.3 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.10390 | acc=0.9815 | tpr=0.9302 | fpr=0.0176 | 7856.0 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.10387 | acc=0.9815 | tpr=0.9349 | fpr=0.0177 | 8300.0 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.10498 | acc=0.9813 | tpr=0.9305 | fpr=0.0177 | 8115.2 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.10689 | acc=0.9810 | tpr=0.9299 | fpr=0.0181 | 8423.6 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.10604 | acc=0.9811 | tpr=0.9313 | fpr=0.0180 | 8182.3 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.10548 | acc=0.9812 | tpr=0.9292 | fpr=0.0179 | 10045.7 samples/s | 39.2 steps/s
Avg test loss: 0.10530, Avg test acc: 0.98118, Avg tpr: 0.92908, Avg fpr: 0.01788, total FA: 2482

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10100 | acc=0.9813 | tpr=0.9159 | fpr=0.0175 | 5672.1 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.10459 | acc=0.9810 | tpr=0.9254 | fpr=0.0179 | 7690.8 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.10716 | acc=0.9807 | tpr=0.9337 | fpr=0.0185 | 8008.4 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.10865 | acc=0.9807 | tpr=0.9388 | fpr=0.0186 | 9063.3 samples/s | 35.4 steps/s
[Step= 250] | Loss=0.10901 | acc=0.9806 | tpr=0.9389 | fpr=0.0187 | 8412.6 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.11053 | acc=0.9805 | tpr=0.9360 | fpr=0.0186 | 7746.8 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.11031 | acc=0.9806 | tpr=0.9380 | fpr=0.0186 | 7586.9 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.11124 | acc=0.9805 | tpr=0.9344 | fpr=0.0186 | 8179.5 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.11330 | acc=0.9803 | tpr=0.9343 | fpr=0.0189 | 8140.9 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.11245 | acc=0.9804 | tpr=0.9357 | fpr=0.0188 | 8401.6 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.11171 | acc=0.9805 | tpr=0.9339 | fpr=0.0187 | 9967.7 samples/s | 38.9 steps/s
Avg test loss: 0.11151, Avg test acc: 0.98048, Avg tpr: 0.93384, Avg fpr: 0.01867, total FA: 2592

server round 38/50

clients selected: [0 1 2 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=26001 Epoch=126.8] | Loss=0.01418 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.017 | L2-Norm(final)=13.604 | 6078.1 samples/s | 95.0 steps/s
[Step=26050 Epoch=127.0] | Loss=0.01341 | Reg=0.00100 | acc=0.9531 | L2-Norm=10.017 | L2-Norm(final)=13.608 | 4839.3 samples/s | 75.6 steps/s
[Step=26100 Epoch=127.3] | Loss=0.01482 | Reg=0.00100 | acc=0.9688 | L2-Norm=10.017 | L2-Norm(final)=13.609 | 5653.1 samples/s | 88.3 steps/s
[Step=26150 Epoch=127.5] | Loss=0.01430 | Reg=0.00100 | acc=0.9688 | L2-Norm=10.017 | L2-Norm(final)=13.612 | 5635.4 samples/s | 88.1 steps/s
[Step=26200 Epoch=127.8] | Loss=0.01444 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.017 | L2-Norm(final)=13.615 | 8695.9 samples/s | 135.9 steps/s
[Step=26250 Epoch=128.0] | Loss=0.01459 | Reg=0.00100 | acc=0.9531 | L2-Norm=10.017 | L2-Norm(final)=13.619 | 2432.3 samples/s | 38.0 steps/s
[Step=26300 Epoch=128.2] | Loss=0.01468 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=13.622 | 5825.6 samples/s | 91.0 steps/s
[Step=26350 Epoch=128.5] | Loss=0.01478 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.017 | L2-Norm(final)=13.625 | 5428.1 samples/s | 84.8 steps/s
[Step=26400 Epoch=128.7] | Loss=0.01468 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=13.627 | 7692.1 samples/s | 120.2 steps/s
[Step=26450 Epoch=129.0] | Loss=0.01425 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=13.630 | 2508.2 samples/s | 39.2 steps/s
[Step=26500 Epoch=129.2] | Loss=0.01438 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.017 | L2-Norm(final)=13.634 | 5741.5 samples/s | 89.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=26501 Epoch=129.2] | Loss=0.00883 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=13.663 | 6355.5 samples/s | 99.3 steps/s
[Step=26550 Epoch=129.5] | Loss=0.01417 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.036 | L2-Norm(final)=13.666 | 4128.2 samples/s | 64.5 steps/s
[Step=26600 Epoch=129.7] | Loss=0.01353 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.052 | L2-Norm(final)=13.668 | 4878.3 samples/s | 76.2 steps/s
[Step=26650 Epoch=130.0] | Loss=0.01384 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=13.670 | 4875.5 samples/s | 76.2 steps/s
[Step=26700 Epoch=130.2] | Loss=0.01395 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.072 | L2-Norm(final)=13.673 | 6919.6 samples/s | 108.1 steps/s
[Step=26750 Epoch=130.4] | Loss=0.01240 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.081 | L2-Norm(final)=13.675 | 2257.7 samples/s | 35.3 steps/s
[Step=26800 Epoch=130.7] | Loss=0.01112 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.089 | L2-Norm(final)=13.678 | 4932.1 samples/s | 77.1 steps/s
[Step=26850 Epoch=130.9] | Loss=0.01035 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.095 | L2-Norm(final)=13.681 | 4811.7 samples/s | 75.2 steps/s
[Step=26900 Epoch=131.2] | Loss=0.00968 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.101 | L2-Norm(final)=13.685 | 6369.9 samples/s | 99.5 steps/s
[Step=26950 Epoch=131.4] | Loss=0.00884 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.106 | L2-Norm(final)=13.688 | 2331.7 samples/s | 36.4 steps/s
[Step=27000 Epoch=131.7] | Loss=0.00836 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.111 | L2-Norm(final)=13.691 | 4834.7 samples/s | 75.5 steps/s
[Step=27050 Epoch=131.9] | Loss=0.00798 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.116 | L2-Norm(final)=13.694 | 4869.5 samples/s | 76.1 steps/s
[Step=27100 Epoch=132.1] | Loss=0.00777 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.120 | L2-Norm(final)=13.697 | 5849.3 samples/s | 91.4 steps/s
[Step=27150 Epoch=132.4] | Loss=0.00747 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.124 | L2-Norm(final)=13.700 | 2420.6 samples/s | 37.8 steps/s
[Step=27200 Epoch=132.6] | Loss=0.00717 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.128 | L2-Norm(final)=13.703 | 4782.9 samples/s | 74.7 steps/s
[Step=27250 Epoch=132.9] | Loss=0.00693 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.131 | L2-Norm(final)=13.705 | 4885.3 samples/s | 76.3 steps/s
[Step=27300 Epoch=133.1] | Loss=0.00676 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.135 | L2-Norm(final)=13.708 | 5403.7 samples/s | 84.4 steps/s
[Step=27350 Epoch=133.4] | Loss=0.00660 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.138 | L2-Norm(final)=13.710 | 2511.3 samples/s | 39.2 steps/s
[Step=27400 Epoch=133.6] | Loss=0.00638 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.141 | L2-Norm(final)=13.713 | 4837.8 samples/s | 75.6 steps/s
[Step=27450 Epoch=133.9] | Loss=0.00621 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.144 | L2-Norm(final)=13.715 | 4879.1 samples/s | 76.2 steps/s
[Step=27500 Epoch=134.1] | Loss=0.00609 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.147 | L2-Norm(final)=13.718 | 5010.5 samples/s | 78.3 steps/s
[Step=27550 Epoch=134.3] | Loss=0.00593 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.149 | L2-Norm(final)=13.720 | 2609.8 samples/s | 40.8 steps/s
[Step=27600 Epoch=134.6] | Loss=0.00574 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.152 | L2-Norm(final)=13.722 | 4823.5 samples/s | 75.4 steps/s
[Step=27650 Epoch=134.8] | Loss=0.00561 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.155 | L2-Norm(final)=13.725 | 4863.5 samples/s | 76.0 steps/s
[Step=27700 Epoch=135.1] | Loss=0.00550 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.157 | L2-Norm(final)=13.727 | 4932.0 samples/s | 77.1 steps/s
[Step=27750 Epoch=135.3] | Loss=0.00552 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.160 | L2-Norm(final)=13.729 | 2673.6 samples/s | 41.8 steps/s
[Step=27800 Epoch=135.6] | Loss=0.00538 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=13.731 | 4785.2 samples/s | 74.8 steps/s
[Step=27850 Epoch=135.8] | Loss=0.00530 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=13.733 | 4917.4 samples/s | 76.8 steps/s
[Step=27900 Epoch=136.0] | Loss=0.00528 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.167 | L2-Norm(final)=13.735 | 4857.0 samples/s | 75.9 steps/s
[Step=27950 Epoch=136.3] | Loss=0.00524 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.169 | L2-Norm(final)=13.737 | 2626.2 samples/s | 41.0 steps/s
[Step=28000 Epoch=136.5] | Loss=0.00515 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.171 | L2-Norm(final)=13.739 | 4850.8 samples/s | 75.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step28000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=50001 Epoch=244.0] | Loss=0.03527 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.017 | L2-Norm(final)=15.696 | 5453.3 samples/s | 85.2 steps/s
[Step=50050 Epoch=244.2] | Loss=0.01627 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.017 | L2-Norm(final)=15.697 | 4911.9 samples/s | 76.7 steps/s
[Step=50100 Epoch=244.5] | Loss=0.01569 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=15.699 | 5628.7 samples/s | 87.9 steps/s
[Step=50150 Epoch=244.7] | Loss=0.01474 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=15.702 | 5604.8 samples/s | 87.6 steps/s
[Step=50200 Epoch=245.0] | Loss=0.01517 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.017 | L2-Norm(final)=15.704 | 8771.7 samples/s | 137.1 steps/s
[Step=50250 Epoch=245.2] | Loss=0.01478 | Reg=0.00100 | acc=0.9531 | L2-Norm=10.017 | L2-Norm(final)=15.706 | 2410.0 samples/s | 37.7 steps/s
[Step=50300 Epoch=245.4] | Loss=0.01476 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=15.708 | 5613.7 samples/s | 87.7 steps/s
[Step=50350 Epoch=245.7] | Loss=0.01478 | Reg=0.00100 | acc=0.9688 | L2-Norm=10.017 | L2-Norm(final)=15.711 | 5624.8 samples/s | 87.9 steps/s
[Step=50400 Epoch=245.9] | Loss=0.01489 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.017 | L2-Norm(final)=15.713 | 8009.5 samples/s | 125.1 steps/s
[Step=50450 Epoch=246.2] | Loss=0.01513 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=15.714 | 2501.4 samples/s | 39.1 steps/s
[Step=50500 Epoch=246.4] | Loss=0.01504 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.017 | L2-Norm(final)=15.715 | 5627.0 samples/s | 87.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=50501 Epoch=246.4] | Loss=0.00355 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=15.728 | 5744.1 samples/s | 89.8 steps/s
[Step=50550 Epoch=246.7] | Loss=0.01763 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.032 | L2-Norm(final)=15.726 | 4351.8 samples/s | 68.0 steps/s
[Step=50600 Epoch=246.9] | Loss=0.01478 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.046 | L2-Norm(final)=15.726 | 4872.0 samples/s | 76.1 steps/s
[Step=50650 Epoch=247.1] | Loss=0.01495 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.057 | L2-Norm(final)=15.727 | 4857.3 samples/s | 75.9 steps/s
[Step=50700 Epoch=247.4] | Loss=0.01379 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.067 | L2-Norm(final)=15.729 | 6994.3 samples/s | 109.3 steps/s
[Step=50750 Epoch=247.6] | Loss=0.01246 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.075 | L2-Norm(final)=15.731 | 2228.1 samples/s | 34.8 steps/s
[Step=50800 Epoch=247.9] | Loss=0.01136 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.082 | L2-Norm(final)=15.733 | 4821.4 samples/s | 75.3 steps/s
[Step=50850 Epoch=248.1] | Loss=0.01049 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.088 | L2-Norm(final)=15.736 | 4864.5 samples/s | 76.0 steps/s
[Step=50900 Epoch=248.4] | Loss=0.00987 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.092 | L2-Norm(final)=15.738 | 6439.0 samples/s | 100.6 steps/s
[Step=50950 Epoch=248.6] | Loss=0.00912 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.096 | L2-Norm(final)=15.740 | 2367.0 samples/s | 37.0 steps/s
[Step=51000 Epoch=248.9] | Loss=0.00856 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.100 | L2-Norm(final)=15.742 | 4704.3 samples/s | 73.5 steps/s
[Step=51050 Epoch=249.1] | Loss=0.00818 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.104 | L2-Norm(final)=15.744 | 4882.6 samples/s | 76.3 steps/s
[Step=51100 Epoch=249.3] | Loss=0.00783 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.107 | L2-Norm(final)=15.746 | 6006.8 samples/s | 93.9 steps/s
[Step=51150 Epoch=249.6] | Loss=0.00743 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.110 | L2-Norm(final)=15.748 | 2395.3 samples/s | 37.4 steps/s
[Step=51200 Epoch=249.8] | Loss=0.00713 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.113 | L2-Norm(final)=15.750 | 4803.1 samples/s | 75.0 steps/s
[Step=51250 Epoch=250.1] | Loss=0.00688 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.116 | L2-Norm(final)=15.752 | 4896.2 samples/s | 76.5 steps/s
[Step=51300 Epoch=250.3] | Loss=0.00675 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.118 | L2-Norm(final)=15.753 | 5592.6 samples/s | 87.4 steps/s
[Step=51350 Epoch=250.6] | Loss=0.00653 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.120 | L2-Norm(final)=15.755 | 2455.5 samples/s | 38.4 steps/s
[Step=51400 Epoch=250.8] | Loss=0.00634 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.122 | L2-Norm(final)=15.757 | 4802.6 samples/s | 75.0 steps/s
[Step=51450 Epoch=251.1] | Loss=0.00617 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.125 | L2-Norm(final)=15.758 | 4895.8 samples/s | 76.5 steps/s
[Step=51500 Epoch=251.3] | Loss=0.00599 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.127 | L2-Norm(final)=15.760 | 5225.6 samples/s | 81.6 steps/s
[Step=51550 Epoch=251.5] | Loss=0.00581 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.129 | L2-Norm(final)=15.762 | 2573.0 samples/s | 40.2 steps/s
[Step=51600 Epoch=251.8] | Loss=0.00570 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.131 | L2-Norm(final)=15.763 | 4875.9 samples/s | 76.2 steps/s
[Step=51650 Epoch=252.0] | Loss=0.00560 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.132 | L2-Norm(final)=15.765 | 4820.0 samples/s | 75.3 steps/s
[Step=51700 Epoch=252.3] | Loss=0.00552 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.134 | L2-Norm(final)=15.766 | 4908.3 samples/s | 76.7 steps/s
[Step=51750 Epoch=252.5] | Loss=0.00537 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.136 | L2-Norm(final)=15.768 | 2606.2 samples/s | 40.7 steps/s
[Step=51800 Epoch=252.8] | Loss=0.00524 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.138 | L2-Norm(final)=15.769 | 4806.3 samples/s | 75.1 steps/s
[Step=51850 Epoch=253.0] | Loss=0.00516 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.139 | L2-Norm(final)=15.771 | 4895.1 samples/s | 76.5 steps/s
[Step=51900 Epoch=253.2] | Loss=0.00510 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.141 | L2-Norm(final)=15.772 | 4820.2 samples/s | 75.3 steps/s
[Step=51950 Epoch=253.5] | Loss=0.00504 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.142 | L2-Norm(final)=15.774 | 2646.5 samples/s | 41.4 steps/s
[Step=52000 Epoch=253.7] | Loss=0.00495 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.144 | L2-Norm(final)=15.775 | 4718.9 samples/s | 73.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step52000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=40001 Epoch=194.9] | Loss=0.00263 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=14.621 | 5751.0 samples/s | 89.9 steps/s
[Step=40050 Epoch=195.1] | Loss=0.01664 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=14.621 | 4991.1 samples/s | 78.0 steps/s
[Step=40100 Epoch=195.4] | Loss=0.01495 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.017 | L2-Norm(final)=14.621 | 5744.4 samples/s | 89.8 steps/s
[Step=40150 Epoch=195.6] | Loss=0.01520 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=14.622 | 5450.7 samples/s | 85.2 steps/s
[Step=40200 Epoch=195.9] | Loss=0.01534 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.017 | L2-Norm(final)=14.624 | 8765.1 samples/s | 137.0 steps/s
[Step=40250 Epoch=196.1] | Loss=0.01599 | Reg=0.00100 | acc=0.9688 | L2-Norm=10.017 | L2-Norm(final)=14.626 | 2301.5 samples/s | 36.0 steps/s
[Step=40300 Epoch=196.4] | Loss=0.01609 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.017 | L2-Norm(final)=14.627 | 5625.4 samples/s | 87.9 steps/s
[Step=40350 Epoch=196.6] | Loss=0.01590 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=14.628 | 5633.0 samples/s | 88.0 steps/s
[Step=40400 Epoch=196.8] | Loss=0.01578 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.017 | L2-Norm(final)=14.629 | 7639.6 samples/s | 119.4 steps/s
[Step=40450 Epoch=197.1] | Loss=0.01581 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.017 | L2-Norm(final)=14.631 | 2510.8 samples/s | 39.2 steps/s
[Step=40500 Epoch=197.3] | Loss=0.01539 | Reg=0.00100 | acc=0.9688 | L2-Norm=10.017 | L2-Norm(final)=14.632 | 5625.1 samples/s | 87.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=40501 Epoch=197.3] | Loss=0.00700 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=14.647 | 5688.3 samples/s | 88.9 steps/s
[Step=40550 Epoch=197.6] | Loss=0.01683 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.028 | L2-Norm(final)=14.646 | 4417.0 samples/s | 69.0 steps/s
[Step=40600 Epoch=197.8] | Loss=0.01809 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.043 | L2-Norm(final)=14.646 | 4872.1 samples/s | 76.1 steps/s
[Step=40650 Epoch=198.1] | Loss=0.01585 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.054 | L2-Norm(final)=14.646 | 4854.8 samples/s | 75.9 steps/s
[Step=40700 Epoch=198.3] | Loss=0.01445 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.064 | L2-Norm(final)=14.648 | 6947.3 samples/s | 108.6 steps/s
[Step=40750 Epoch=198.6] | Loss=0.01265 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.072 | L2-Norm(final)=14.650 | 2254.4 samples/s | 35.2 steps/s
[Step=40800 Epoch=198.8] | Loss=0.01146 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.078 | L2-Norm(final)=14.653 | 4862.5 samples/s | 76.0 steps/s
[Step=40850 Epoch=199.0] | Loss=0.01071 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.084 | L2-Norm(final)=14.655 | 4892.0 samples/s | 76.4 steps/s
[Step=40900 Epoch=199.3] | Loss=0.01007 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.090 | L2-Norm(final)=14.658 | 6316.9 samples/s | 98.7 steps/s
[Step=40950 Epoch=199.5] | Loss=0.00943 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.095 | L2-Norm(final)=14.660 | 2347.7 samples/s | 36.7 steps/s
[Step=41000 Epoch=199.8] | Loss=0.00891 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.099 | L2-Norm(final)=14.663 | 4879.2 samples/s | 76.2 steps/s
[Step=41050 Epoch=200.0] | Loss=0.00845 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.104 | L2-Norm(final)=14.665 | 4896.3 samples/s | 76.5 steps/s
[Step=41100 Epoch=200.3] | Loss=0.00803 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.108 | L2-Norm(final)=14.668 | 5758.2 samples/s | 90.0 steps/s
[Step=41150 Epoch=200.5] | Loss=0.00766 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.111 | L2-Norm(final)=14.670 | 2443.1 samples/s | 38.2 steps/s
[Step=41200 Epoch=200.7] | Loss=0.00737 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.115 | L2-Norm(final)=14.673 | 4956.9 samples/s | 77.5 steps/s
[Step=41250 Epoch=201.0] | Loss=0.00709 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.118 | L2-Norm(final)=14.675 | 4879.3 samples/s | 76.2 steps/s
[Step=41300 Epoch=201.2] | Loss=0.00691 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.122 | L2-Norm(final)=14.677 | 5298.4 samples/s | 82.8 steps/s
[Step=41350 Epoch=201.5] | Loss=0.00676 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.124 | L2-Norm(final)=14.679 | 2532.3 samples/s | 39.6 steps/s
[Step=41400 Epoch=201.7] | Loss=0.00663 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.127 | L2-Norm(final)=14.681 | 4935.8 samples/s | 77.1 steps/s
[Step=41450 Epoch=202.0] | Loss=0.00643 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.130 | L2-Norm(final)=14.683 | 4912.1 samples/s | 76.8 steps/s
[Step=41500 Epoch=202.2] | Loss=0.00621 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=14.685 | 4881.0 samples/s | 76.3 steps/s
[Step=41550 Epoch=202.5] | Loss=0.00604 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.136 | L2-Norm(final)=14.687 | 2670.5 samples/s | 41.7 steps/s
[Step=41600 Epoch=202.7] | Loss=0.00586 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.138 | L2-Norm(final)=14.689 | 4755.3 samples/s | 74.3 steps/s
[Step=41650 Epoch=202.9] | Loss=0.00580 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.141 | L2-Norm(final)=14.691 | 4894.9 samples/s | 76.5 steps/s
[Step=41700 Epoch=203.2] | Loss=0.00569 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.143 | L2-Norm(final)=14.693 | 4911.3 samples/s | 76.7 steps/s
[Step=41750 Epoch=203.4] | Loss=0.00557 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.145 | L2-Norm(final)=14.695 | 2600.2 samples/s | 40.6 steps/s
[Step=41800 Epoch=203.7] | Loss=0.00540 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.148 | L2-Norm(final)=14.697 | 4900.7 samples/s | 76.6 steps/s
[Step=41850 Epoch=203.9] | Loss=0.00534 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.150 | L2-Norm(final)=14.698 | 4793.9 samples/s | 74.9 steps/s
[Step=41900 Epoch=204.2] | Loss=0.00523 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.152 | L2-Norm(final)=14.700 | 4916.0 samples/s | 76.8 steps/s
[Step=41950 Epoch=204.4] | Loss=0.00513 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.154 | L2-Norm(final)=14.702 | 2612.1 samples/s | 40.8 steps/s
[Step=42000 Epoch=204.6] | Loss=0.00505 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.156 | L2-Norm(final)=14.704 | 4920.9 samples/s | 76.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step42000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=38001 Epoch=362.9] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=16.724 | 5722.0 samples/s | 89.4 steps/s
[Step=38050 Epoch=363.4] | Loss=0.00009 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=16.730 | 4465.0 samples/s | 69.8 steps/s
[Step=38100 Epoch=363.8] | Loss=0.00010 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=16.736 | 8530.9 samples/s | 133.3 steps/s
[Step=38150 Epoch=364.3] | Loss=0.00008 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=16.741 | 2321.4 samples/s | 36.3 steps/s
[Step=38200 Epoch=364.8] | Loss=0.00008 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=16.746 | 7584.6 samples/s | 118.5 steps/s
[Step=38250 Epoch=365.3] | Loss=0.00009 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=16.752 | 2399.3 samples/s | 37.5 steps/s
[Step=38300 Epoch=365.7] | Loss=0.00009 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=16.758 | 6904.4 samples/s | 107.9 steps/s
[Step=38350 Epoch=366.2] | Loss=0.00009 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=16.764 | 2440.2 samples/s | 38.1 steps/s
[Step=38400 Epoch=366.7] | Loss=0.00009 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=16.770 | 6410.4 samples/s | 100.2 steps/s
[Step=38450 Epoch=367.2] | Loss=0.00009 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=16.776 | 2585.4 samples/s | 40.4 steps/s
[Step=38500 Epoch=367.7] | Loss=0.00009 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=16.782 | 5755.7 samples/s | 89.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=367.7] | Loss=0.00003 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=16.839 | 6202.9 samples/s | 96.9 steps/s
[Step=38550 Epoch=368.1] | Loss=0.00008 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=16.842 | 3892.6 samples/s | 60.8 steps/s
[Step=38600 Epoch=368.6] | Loss=0.00005 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.013 | L2-Norm(final)=16.844 | 6811.0 samples/s | 106.4 steps/s
[Step=38650 Epoch=369.1] | Loss=0.00004 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.008 | L2-Norm(final)=16.845 | 2187.3 samples/s | 34.2 steps/s
[Step=38700 Epoch=369.6] | Loss=0.00003 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.002 | L2-Norm(final)=16.846 | 6132.3 samples/s | 95.8 steps/s
[Step=38750 Epoch=370.0] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.995 | L2-Norm(final)=16.847 | 2242.1 samples/s | 35.0 steps/s
[Step=38800 Epoch=370.5] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.988 | L2-Norm(final)=16.848 | 5820.1 samples/s | 90.9 steps/s
[Step=38850 Epoch=371.0] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.981 | L2-Norm(final)=16.849 | 2329.5 samples/s | 36.4 steps/s
[Step=38900 Epoch=371.5] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.974 | L2-Norm(final)=16.849 | 5403.5 samples/s | 84.4 steps/s
[Step=38950 Epoch=371.9] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.967 | L2-Norm(final)=16.850 | 2372.0 samples/s | 37.1 steps/s
[Step=39000 Epoch=372.4] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.959 | L2-Norm(final)=16.851 | 5055.9 samples/s | 79.0 steps/s
[Step=39050 Epoch=372.9] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.952 | L2-Norm(final)=16.851 | 2528.8 samples/s | 39.5 steps/s
[Step=39100 Epoch=373.4] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.944 | L2-Norm(final)=16.852 | 4556.9 samples/s | 71.2 steps/s
[Step=39150 Epoch=373.9] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.937 | L2-Norm(final)=16.852 | 2497.3 samples/s | 39.0 steps/s
[Step=39200 Epoch=374.3] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.929 | L2-Norm(final)=16.853 | 4523.4 samples/s | 70.7 steps/s
[Step=39250 Epoch=374.8] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.921 | L2-Norm(final)=16.853 | 2505.8 samples/s | 39.2 steps/s
[Step=39300 Epoch=375.3] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.913 | L2-Norm(final)=16.854 | 4632.5 samples/s | 72.4 steps/s
[Step=39350 Epoch=375.8] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=16.854 | 2556.3 samples/s | 39.9 steps/s
[Step=39400 Epoch=376.2] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.897 | L2-Norm(final)=16.855 | 4606.9 samples/s | 72.0 steps/s
[Step=39450 Epoch=376.7] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=16.855 | 2549.3 samples/s | 39.8 steps/s
[Step=39500 Epoch=377.2] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.881 | L2-Norm(final)=16.856 | 4680.4 samples/s | 73.1 steps/s
[Step=39550 Epoch=377.7] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=16.856 | 7317.2 samples/s | 114.3 steps/s
[Step=39600 Epoch=378.2] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.865 | L2-Norm(final)=16.857 | 2127.0 samples/s | 33.2 steps/s
[Step=39650 Epoch=378.6] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.857 | L2-Norm(final)=16.857 | 6757.5 samples/s | 105.6 steps/s
[Step=39700 Epoch=379.1] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.848 | L2-Norm(final)=16.858 | 2203.8 samples/s | 34.4 steps/s
[Step=39750 Epoch=379.6] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=16.858 | 6026.6 samples/s | 94.2 steps/s
[Step=39800 Epoch=380.1] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.831 | L2-Norm(final)=16.859 | 2244.4 samples/s | 35.1 steps/s
[Step=39850 Epoch=380.5] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.823 | L2-Norm(final)=16.859 | 5736.9 samples/s | 89.6 steps/s
[Step=39900 Epoch=381.0] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.814 | L2-Norm(final)=16.860 | 2320.6 samples/s | 36.3 steps/s
[Step=39950 Epoch=381.5] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=16.861 | 5373.6 samples/s | 84.0 steps/s
[Step=40000 Epoch=382.0] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.797 | L2-Norm(final)=16.861 | 2389.3 samples/s | 37.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step40000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=26001 Epoch=247.8] | Loss=0.00091 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=14.634 | 5321.2 samples/s | 83.1 steps/s
[Step=26050 Epoch=248.3] | Loss=0.00079 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=14.636 | 4750.4 samples/s | 74.2 steps/s
[Step=26100 Epoch=248.8] | Loss=0.00067 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=14.644 | 8370.4 samples/s | 130.8 steps/s
[Step=26150 Epoch=249.2] | Loss=0.00072 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=14.652 | 2330.6 samples/s | 36.4 steps/s
[Step=26200 Epoch=249.7] | Loss=0.00066 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=14.659 | 7365.6 samples/s | 115.1 steps/s
[Step=26250 Epoch=250.2] | Loss=0.00067 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=14.665 | 2397.4 samples/s | 37.5 steps/s
[Step=26300 Epoch=250.7] | Loss=0.00065 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=14.673 | 6710.8 samples/s | 104.9 steps/s
[Step=26350 Epoch=251.1] | Loss=0.00064 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=14.679 | 2476.9 samples/s | 38.7 steps/s
[Step=26400 Epoch=251.6] | Loss=0.00063 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=14.685 | 6384.1 samples/s | 99.8 steps/s
[Step=26450 Epoch=252.1] | Loss=0.00063 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=14.692 | 2575.3 samples/s | 40.2 steps/s
[Step=26500 Epoch=252.6] | Loss=0.00063 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=14.699 | 5744.1 samples/s | 89.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=26501 Epoch=252.6] | Loss=0.00076 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=14.771 | 5525.9 samples/s | 86.3 steps/s
[Step=26550 Epoch=253.0] | Loss=0.00022 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.029 | L2-Norm(final)=14.776 | 4250.1 samples/s | 66.4 steps/s
[Step=26600 Epoch=253.5] | Loss=0.00013 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.034 | L2-Norm(final)=14.779 | 6676.1 samples/s | 104.3 steps/s
[Step=26650 Epoch=254.0] | Loss=0.00009 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.032 | L2-Norm(final)=14.782 | 2184.0 samples/s | 34.1 steps/s
[Step=26700 Epoch=254.5] | Loss=0.00007 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.027 | L2-Norm(final)=14.783 | 6254.4 samples/s | 97.7 steps/s
[Step=26750 Epoch=255.0] | Loss=0.00006 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.021 | L2-Norm(final)=14.784 | 2280.6 samples/s | 35.6 steps/s
[Step=26800 Epoch=255.4] | Loss=0.00005 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=14.785 | 5668.2 samples/s | 88.6 steps/s
[Step=26850 Epoch=255.9] | Loss=0.00004 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.007 | L2-Norm(final)=14.786 | 2301.7 samples/s | 36.0 steps/s
[Step=26900 Epoch=256.4] | Loss=0.00004 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.000 | L2-Norm(final)=14.787 | 5314.9 samples/s | 83.0 steps/s
[Step=26950 Epoch=256.9] | Loss=0.00003 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.993 | L2-Norm(final)=14.787 | 2380.0 samples/s | 37.2 steps/s
[Step=27000 Epoch=257.3] | Loss=0.00003 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.985 | L2-Norm(final)=14.788 | 4946.8 samples/s | 77.3 steps/s
[Step=27050 Epoch=257.8] | Loss=0.00003 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.977 | L2-Norm(final)=14.789 | 2481.6 samples/s | 38.8 steps/s
[Step=27100 Epoch=258.3] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.969 | L2-Norm(final)=14.789 | 4641.0 samples/s | 72.5 steps/s
[Step=27150 Epoch=258.8] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.962 | L2-Norm(final)=14.790 | 2542.4 samples/s | 39.7 steps/s
[Step=27200 Epoch=259.2] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.954 | L2-Norm(final)=14.790 | 4619.1 samples/s | 72.2 steps/s
[Step=27250 Epoch=259.7] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.946 | L2-Norm(final)=14.790 | 2605.4 samples/s | 40.7 steps/s
[Step=27300 Epoch=260.2] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.938 | L2-Norm(final)=14.791 | 4547.4 samples/s | 71.1 steps/s
[Step=27350 Epoch=260.7] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.929 | L2-Norm(final)=14.791 | 2540.5 samples/s | 39.7 steps/s
[Step=27400 Epoch=261.1] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.921 | L2-Norm(final)=14.792 | 4645.8 samples/s | 72.6 steps/s
[Step=27450 Epoch=261.6] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.913 | L2-Norm(final)=14.792 | 2650.2 samples/s | 41.4 steps/s
[Step=27500 Epoch=262.1] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=14.793 | 4491.2 samples/s | 70.2 steps/s
[Step=27550 Epoch=262.6] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.896 | L2-Norm(final)=14.793 | 7445.7 samples/s | 116.3 steps/s
[Step=27600 Epoch=263.1] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.887 | L2-Norm(final)=14.793 | 2126.9 samples/s | 33.2 steps/s
[Step=27650 Epoch=263.5] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.879 | L2-Norm(final)=14.794 | 6810.2 samples/s | 106.4 steps/s
[Step=27700 Epoch=264.0] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.870 | L2-Norm(final)=14.794 | 2185.5 samples/s | 34.1 steps/s
[Step=27750 Epoch=264.5] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.861 | L2-Norm(final)=14.795 | 6256.8 samples/s | 97.8 steps/s
[Step=27800 Epoch=265.0] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.853 | L2-Norm(final)=14.795 | 2242.2 samples/s | 35.0 steps/s
[Step=27850 Epoch=265.4] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.844 | L2-Norm(final)=14.795 | 5760.5 samples/s | 90.0 steps/s
[Step=27900 Epoch=265.9] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.835 | L2-Norm(final)=14.796 | 2306.5 samples/s | 36.0 steps/s
[Step=27950 Epoch=266.4] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=14.796 | 5346.2 samples/s | 83.5 steps/s
[Step=28000 Epoch=266.9] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.817 | L2-Norm(final)=14.797 | 2388.3 samples/s | 37.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08410 | acc=0.9632 | tpr=0.9708 | fpr=0.0533 | 5423.4 samples/s | 21.2 steps/s
Avg test loss: 0.09159, Avg test acc: 0.96089, Avg tpr: 0.96882, Avg fpr: 0.05653, total FA: 441

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08156 | acc=0.9662 | tpr=0.9770 | fpr=0.0572 | 5523.5 samples/s | 21.6 steps/s
Avg test loss: 0.08948, Avg test acc: 0.96482, Avg tpr: 0.97546, Avg fpr: 0.05858, total FA: 457

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09139 | acc=0.9634 | tpr=0.9791 | fpr=0.0706 | 5684.8 samples/s | 22.2 steps/s
Avg test loss: 0.09811, Avg test acc: 0.96254, Avg tpr: 0.97680, Avg fpr: 0.06884, total FA: 537

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08413 | acc=0.9641 | tpr=0.9739 | fpr=0.0572 | 5754.4 samples/s | 22.5 steps/s
Avg test loss: 0.09125, Avg test acc: 0.96342, Avg tpr: 0.97342, Avg fpr: 0.05858, total FA: 457

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08267 | acc=0.9636 | tpr=0.9718 | fpr=0.0543 | 5803.1 samples/s | 22.7 steps/s
Avg test loss: 0.09400, Avg test acc: 0.96302, Avg tpr: 0.97121, Avg fpr: 0.05499, total FA: 429

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.48582 | acc=0.2774 | tpr=0.0056 | fpr=0.1323 | 5644.4 samples/s | 22.0 steps/s
Avg test loss: 5.49666, Avg test acc: 0.27594, Avg tpr: 0.00624, Avg fpr: 0.13088, total FA: 1021

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.85680 | acc=0.2952 | tpr=0.0113 | fpr=0.0885 | 5681.8 samples/s | 22.2 steps/s
Avg test loss: 4.86905, Avg test acc: 0.29217, Avg tpr: 0.01078, Avg fpr: 0.08896, total FA: 694

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.29059 | acc=0.2333 | tpr=0.0128 | fpr=0.2879 | 5603.1 samples/s | 21.9 steps/s
Avg test loss: 5.29693, Avg test acc: 0.23347, Avg tpr: 0.01364, Avg fpr: 0.28304, total FA: 2208

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=6.27982 | acc=0.2412 | tpr=0.0103 | fpr=0.2572 | 5542.8 samples/s | 21.7 steps/s
Avg test loss: 6.29203, Avg test acc: 0.23948, Avg tpr: 0.01067, Avg fpr: 0.25727, total FA: 2007

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.53576 | acc=0.2505 | tpr=0.0054 | fpr=0.2173 | 5772.2 samples/s | 22.5 steps/s
Avg test loss: 5.54515, Avg test acc: 0.25106, Avg tpr: 0.00641, Avg fpr: 0.21087, total FA: 1645

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.05535 | acc=0.1616 | tpr=0.2566 | fpr=0.8401 | 5695.4 samples/s | 22.2 steps/s
[Step= 100] | Loss=5.00942 | acc=0.1623 | tpr=0.2239 | fpr=0.8388 | 7655.8 samples/s | 29.9 steps/s
[Step= 150] | Loss=5.02531 | acc=0.1608 | tpr=0.2118 | fpr=0.8401 | 8230.9 samples/s | 32.2 steps/s
[Step= 200] | Loss=5.01968 | acc=0.1608 | tpr=0.2077 | fpr=0.8401 | 8074.5 samples/s | 31.5 steps/s
[Step= 250] | Loss=5.02506 | acc=0.1610 | tpr=0.2087 | fpr=0.8398 | 7847.7 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.02885 | acc=0.1601 | tpr=0.2116 | fpr=0.8408 | 8623.5 samples/s | 33.7 steps/s
[Step= 350] | Loss=5.03218 | acc=0.1597 | tpr=0.1997 | fpr=0.8410 | 7752.9 samples/s | 30.3 steps/s
[Step= 400] | Loss=5.03151 | acc=0.1603 | tpr=0.2040 | fpr=0.8405 | 8253.6 samples/s | 32.2 steps/s
[Step= 450] | Loss=5.03028 | acc=0.1607 | tpr=0.2011 | fpr=0.8401 | 8421.0 samples/s | 32.9 steps/s
[Step= 500] | Loss=5.03335 | acc=0.1604 | tpr=0.2062 | fpr=0.8405 | 7522.4 samples/s | 29.4 steps/s
[Step= 550] | Loss=5.03103 | acc=0.1605 | tpr=0.2014 | fpr=0.8402 | 10638.6 samples/s | 41.6 steps/s
Avg test loss: 5.03059, Avg test acc: 0.16040, Avg tpr: 0.20166, Avg fpr: 0.84035, total FA: 116681

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.79251 | acc=0.1519 | tpr=0.2080 | fpr=0.8491 | 5735.9 samples/s | 22.4 steps/s
[Step= 100] | Loss=4.74872 | acc=0.1540 | tpr=0.1919 | fpr=0.8467 | 8151.2 samples/s | 31.8 steps/s
[Step= 150] | Loss=4.76280 | acc=0.1510 | tpr=0.1873 | fpr=0.8497 | 8030.0 samples/s | 31.4 steps/s
[Step= 200] | Loss=4.75937 | acc=0.1512 | tpr=0.1836 | fpr=0.8494 | 7852.5 samples/s | 30.7 steps/s
[Step= 250] | Loss=4.76322 | acc=0.1513 | tpr=0.1782 | fpr=0.8492 | 8002.6 samples/s | 31.3 steps/s
[Step= 300] | Loss=4.76570 | acc=0.1503 | tpr=0.1818 | fpr=0.8503 | 8518.4 samples/s | 33.3 steps/s
[Step= 350] | Loss=4.76773 | acc=0.1503 | tpr=0.1691 | fpr=0.8500 | 7996.9 samples/s | 31.2 steps/s
[Step= 400] | Loss=4.76730 | acc=0.1509 | tpr=0.1761 | fpr=0.8496 | 8074.9 samples/s | 31.5 steps/s
[Step= 450] | Loss=4.76571 | acc=0.1513 | tpr=0.1772 | fpr=0.8492 | 8279.6 samples/s | 32.3 steps/s
[Step= 500] | Loss=4.76861 | acc=0.1509 | tpr=0.1780 | fpr=0.8496 | 7348.6 samples/s | 28.7 steps/s
[Step= 550] | Loss=4.76648 | acc=0.1511 | tpr=0.1771 | fpr=0.8494 | 10746.4 samples/s | 42.0 steps/s
Avg test loss: 4.76683, Avg test acc: 0.15100, Avg tpr: 0.17750, Avg fpr: 0.84948, total FA: 117949

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.27533 | acc=0.1257 | tpr=0.1549 | fpr=0.8748 | 5721.1 samples/s | 22.3 steps/s
[Step= 100] | Loss=6.22472 | acc=0.1281 | tpr=0.1535 | fpr=0.8723 | 8284.3 samples/s | 32.4 steps/s
[Step= 150] | Loss=6.23720 | acc=0.1270 | tpr=0.1556 | fpr=0.8735 | 8149.7 samples/s | 31.8 steps/s
[Step= 200] | Loss=6.23125 | acc=0.1274 | tpr=0.1530 | fpr=0.8730 | 7968.2 samples/s | 31.1 steps/s
[Step= 250] | Loss=6.23588 | acc=0.1274 | tpr=0.1511 | fpr=0.8730 | 8082.7 samples/s | 31.6 steps/s
[Step= 300] | Loss=6.24325 | acc=0.1271 | tpr=0.1549 | fpr=0.8734 | 8365.3 samples/s | 32.7 steps/s
[Step= 350] | Loss=6.24806 | acc=0.1264 | tpr=0.1484 | fpr=0.8740 | 7850.9 samples/s | 30.7 steps/s
[Step= 400] | Loss=6.24621 | acc=0.1267 | tpr=0.1554 | fpr=0.8738 | 7346.9 samples/s | 28.7 steps/s
[Step= 450] | Loss=6.24381 | acc=0.1268 | tpr=0.1543 | fpr=0.8737 | 7763.6 samples/s | 30.3 steps/s
[Step= 500] | Loss=6.24580 | acc=0.1266 | tpr=0.1555 | fpr=0.8739 | 8450.3 samples/s | 33.0 steps/s
[Step= 550] | Loss=6.24177 | acc=0.1270 | tpr=0.1556 | fpr=0.8735 | 10718.0 samples/s | 41.9 steps/s
Avg test loss: 6.24155, Avg test acc: 0.12686, Avg tpr: 0.15610, Avg fpr: 0.87367, total FA: 121307

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.96986 | acc=0.1605 | tpr=0.1726 | fpr=0.8397 | 5814.0 samples/s | 22.7 steps/s
[Step= 100] | Loss=4.92430 | acc=0.1608 | tpr=0.1578 | fpr=0.8391 | 7929.7 samples/s | 31.0 steps/s
[Step= 150] | Loss=4.93292 | acc=0.1593 | tpr=0.1556 | fpr=0.8407 | 7567.3 samples/s | 29.6 steps/s
[Step= 200] | Loss=4.92526 | acc=0.1590 | tpr=0.1541 | fpr=0.8409 | 7550.3 samples/s | 29.5 steps/s
[Step= 250] | Loss=4.93083 | acc=0.1591 | tpr=0.1572 | fpr=0.8408 | 8292.6 samples/s | 32.4 steps/s
[Step= 300] | Loss=4.93675 | acc=0.1583 | tpr=0.1600 | fpr=0.8417 | 8659.5 samples/s | 33.8 steps/s
[Step= 350] | Loss=4.93746 | acc=0.1584 | tpr=0.1515 | fpr=0.8415 | 8552.0 samples/s | 33.4 steps/s
[Step= 400] | Loss=4.93522 | acc=0.1589 | tpr=0.1581 | fpr=0.8410 | 7709.5 samples/s | 30.1 steps/s
[Step= 450] | Loss=4.93433 | acc=0.1590 | tpr=0.1582 | fpr=0.8410 | 7818.5 samples/s | 30.5 steps/s
[Step= 500] | Loss=4.93750 | acc=0.1589 | tpr=0.1595 | fpr=0.8411 | 7858.4 samples/s | 30.7 steps/s
[Step= 550] | Loss=4.93536 | acc=0.1590 | tpr=0.1616 | fpr=0.8410 | 10823.8 samples/s | 42.3 steps/s
Avg test loss: 4.93503, Avg test acc: 0.15893, Avg tpr: 0.16165, Avg fpr: 0.84112, total FA: 116788

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.70067 | acc=0.1468 | tpr=0.1283 | fpr=0.8529 | 5588.2 samples/s | 21.8 steps/s
[Step= 100] | Loss=5.64830 | acc=0.1482 | tpr=0.1194 | fpr=0.8512 | 7710.1 samples/s | 30.1 steps/s
[Step= 150] | Loss=5.66426 | acc=0.1478 | tpr=0.1081 | fpr=0.8515 | 8475.7 samples/s | 33.1 steps/s
[Step= 200] | Loss=5.66213 | acc=0.1482 | tpr=0.1060 | fpr=0.8510 | 7811.2 samples/s | 30.5 steps/s
[Step= 250] | Loss=5.67033 | acc=0.1484 | tpr=0.1092 | fpr=0.8509 | 8224.5 samples/s | 32.1 steps/s
[Step= 300] | Loss=5.67439 | acc=0.1481 | tpr=0.1091 | fpr=0.8512 | 7957.5 samples/s | 31.1 steps/s
[Step= 350] | Loss=5.67727 | acc=0.1476 | tpr=0.1027 | fpr=0.8516 | 7708.3 samples/s | 30.1 steps/s
[Step= 400] | Loss=5.67603 | acc=0.1482 | tpr=0.1083 | fpr=0.8511 | 8514.0 samples/s | 33.3 steps/s
[Step= 450] | Loss=5.67528 | acc=0.1487 | tpr=0.1081 | fpr=0.8506 | 8148.0 samples/s | 31.8 steps/s
[Step= 500] | Loss=5.67900 | acc=0.1483 | tpr=0.1088 | fpr=0.8510 | 7484.1 samples/s | 29.2 steps/s
[Step= 550] | Loss=5.67521 | acc=0.1484 | tpr=0.1074 | fpr=0.8509 | 11633.0 samples/s | 45.4 steps/s
Avg test loss: 5.67481, Avg test acc: 0.14823, Avg tpr: 0.10737, Avg fpr: 0.85102, total FA: 118163

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11048 | acc=0.9810 | tpr=0.9336 | fpr=0.0181 | 5462.4 samples/s | 21.3 steps/s
[Step= 100] | Loss=0.11174 | acc=0.9811 | tpr=0.9403 | fpr=0.0182 | 8259.2 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.11536 | acc=0.9806 | tpr=0.9438 | fpr=0.0187 | 7936.1 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.11709 | acc=0.9807 | tpr=0.9486 | fpr=0.0187 | 8684.6 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.11750 | acc=0.9805 | tpr=0.9441 | fpr=0.0188 | 7678.1 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.11901 | acc=0.9804 | tpr=0.9447 | fpr=0.0189 | 7603.2 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.11933 | acc=0.9805 | tpr=0.9480 | fpr=0.0190 | 8361.5 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.12028 | acc=0.9802 | tpr=0.9437 | fpr=0.0191 | 8377.1 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.12265 | acc=0.9799 | tpr=0.9416 | fpr=0.0195 | 7701.9 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.12179 | acc=0.9800 | tpr=0.9432 | fpr=0.0194 | 8061.5 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.12077 | acc=0.9801 | tpr=0.9427 | fpr=0.0192 | 10761.7 samples/s | 42.0 steps/s
Avg test loss: 0.12055, Avg test acc: 0.98010, Avg tpr: 0.94255, Avg fpr: 0.01922, total FA: 2668

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09914 | acc=0.9812 | tpr=0.9115 | fpr=0.0175 | 5641.7 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.10044 | acc=0.9809 | tpr=0.9275 | fpr=0.0181 | 8375.1 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.10317 | acc=0.9804 | tpr=0.9294 | fpr=0.0187 | 7720.9 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.10437 | acc=0.9803 | tpr=0.9301 | fpr=0.0188 | 8062.0 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.10514 | acc=0.9803 | tpr=0.9275 | fpr=0.0187 | 7519.3 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.10632 | acc=0.9802 | tpr=0.9287 | fpr=0.0189 | 8308.5 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.10638 | acc=0.9802 | tpr=0.9286 | fpr=0.0189 | 8222.3 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.10757 | acc=0.9800 | tpr=0.9240 | fpr=0.0190 | 8154.7 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.10939 | acc=0.9797 | tpr=0.9231 | fpr=0.0192 | 8184.4 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.10857 | acc=0.9798 | tpr=0.9251 | fpr=0.0192 | 8294.0 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.10758 | acc=0.9799 | tpr=0.9240 | fpr=0.0191 | 9715.9 samples/s | 38.0 steps/s
Avg test loss: 0.10738, Avg test acc: 0.97994, Avg tpr: 0.92353, Avg fpr: 0.01904, total FA: 2643

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11612 | acc=0.9788 | tpr=0.9336 | fpr=0.0204 | 5773.6 samples/s | 22.6 steps/s
[Step= 100] | Loss=0.11732 | acc=0.9790 | tpr=0.9531 | fpr=0.0205 | 8305.1 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.12139 | acc=0.9783 | tpr=0.9524 | fpr=0.0212 | 8026.3 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.12303 | acc=0.9784 | tpr=0.9574 | fpr=0.0213 | 8098.1 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.12402 | acc=0.9783 | tpr=0.9555 | fpr=0.0213 | 7794.0 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.12520 | acc=0.9783 | tpr=0.9564 | fpr=0.0213 | 8151.0 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.12522 | acc=0.9782 | tpr=0.9593 | fpr=0.0214 | 7995.0 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.12604 | acc=0.9779 | tpr=0.9551 | fpr=0.0217 | 8302.0 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.12826 | acc=0.9775 | tpr=0.9533 | fpr=0.0220 | 7848.1 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.12742 | acc=0.9776 | tpr=0.9546 | fpr=0.0220 | 8555.8 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.12629 | acc=0.9778 | tpr=0.9542 | fpr=0.0218 | 9184.6 samples/s | 35.9 steps/s
Avg test loss: 0.12606, Avg test acc: 0.97777, Avg tpr: 0.95404, Avg fpr: 0.02179, total FA: 3026

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09576 | acc=0.9827 | tpr=0.9292 | fpr=0.0164 | 5837.6 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.09817 | acc=0.9822 | tpr=0.9360 | fpr=0.0170 | 7562.0 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.10118 | acc=0.9817 | tpr=0.9366 | fpr=0.0175 | 8154.6 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.10220 | acc=0.9815 | tpr=0.9388 | fpr=0.0177 | 7579.7 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.10326 | acc=0.9814 | tpr=0.9328 | fpr=0.0177 | 7785.6 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.10390 | acc=0.9815 | tpr=0.9302 | fpr=0.0176 | 8199.6 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.10387 | acc=0.9815 | tpr=0.9349 | fpr=0.0177 | 8183.4 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.10498 | acc=0.9813 | tpr=0.9305 | fpr=0.0177 | 8251.8 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.10689 | acc=0.9810 | tpr=0.9299 | fpr=0.0181 | 7886.1 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.10604 | acc=0.9811 | tpr=0.9313 | fpr=0.0180 | 8507.6 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.10548 | acc=0.9812 | tpr=0.9292 | fpr=0.0179 | 10396.9 samples/s | 40.6 steps/s
Avg test loss: 0.10530, Avg test acc: 0.98118, Avg tpr: 0.92908, Avg fpr: 0.01788, total FA: 2482

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10076 | acc=0.9816 | tpr=0.9248 | fpr=0.0173 | 5628.3 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.10349 | acc=0.9814 | tpr=0.9382 | fpr=0.0178 | 8197.2 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.10642 | acc=0.9808 | tpr=0.9452 | fpr=0.0186 | 7529.0 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.10816 | acc=0.9806 | tpr=0.9486 | fpr=0.0188 | 8828.1 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.10916 | acc=0.9803 | tpr=0.9459 | fpr=0.0190 | 8115.1 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.11043 | acc=0.9803 | tpr=0.9440 | fpr=0.0191 | 8286.0 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.11025 | acc=0.9802 | tpr=0.9455 | fpr=0.0191 | 7815.6 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.11128 | acc=0.9802 | tpr=0.9409 | fpr=0.0191 | 8321.9 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.11333 | acc=0.9799 | tpr=0.9401 | fpr=0.0194 | 8027.3 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.11242 | acc=0.9800 | tpr=0.9410 | fpr=0.0193 | 7847.5 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.11162 | acc=0.9800 | tpr=0.9399 | fpr=0.0192 | 9839.7 samples/s | 38.4 steps/s
Avg test loss: 0.11143, Avg test acc: 0.98006, Avg tpr: 0.93978, Avg fpr: 0.01921, total FA: 2667

server round 39/50

clients selected: [1 2 3 4 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=52001 Epoch=253.7] | Loss=0.00987 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.905 | L2-Norm(final)=15.817 | 5731.5 samples/s | 89.6 steps/s
[Step=52050 Epoch=254.0] | Loss=0.01572 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.905 | L2-Norm(final)=15.819 | 5121.2 samples/s | 80.0 steps/s
[Step=52100 Epoch=254.2] | Loss=0.01528 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.905 | L2-Norm(final)=15.820 | 5669.4 samples/s | 88.6 steps/s
[Step=52150 Epoch=254.5] | Loss=0.01521 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.822 | 5553.7 samples/s | 86.8 steps/s
[Step=52200 Epoch=254.7] | Loss=0.01542 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.823 | 8894.3 samples/s | 139.0 steps/s
[Step=52250 Epoch=255.0] | Loss=0.01510 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.905 | L2-Norm(final)=15.824 | 2421.4 samples/s | 37.8 steps/s
[Step=52300 Epoch=255.2] | Loss=0.01493 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.905 | L2-Norm(final)=15.826 | 5612.4 samples/s | 87.7 steps/s
[Step=52350 Epoch=255.4] | Loss=0.01487 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.827 | 5811.4 samples/s | 90.8 steps/s
[Step=52400 Epoch=255.7] | Loss=0.01493 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.829 | 7564.6 samples/s | 118.2 steps/s
[Step=52450 Epoch=255.9] | Loss=0.01527 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.905 | L2-Norm(final)=15.830 | 2482.5 samples/s | 38.8 steps/s
[Step=52500 Epoch=256.2] | Loss=0.01533 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.905 | L2-Norm(final)=15.831 | 5647.7 samples/s | 88.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=52501 Epoch=256.2] | Loss=0.01178 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.905 | L2-Norm(final)=15.840 | 5700.2 samples/s | 89.1 steps/s
[Step=52550 Epoch=256.4] | Loss=0.01707 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.922 | L2-Norm(final)=15.836 | 4461.3 samples/s | 69.7 steps/s
[Step=52600 Epoch=256.7] | Loss=0.01685 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.936 | L2-Norm(final)=15.835 | 4826.1 samples/s | 75.4 steps/s
[Step=52650 Epoch=256.9] | Loss=0.01534 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.946 | L2-Norm(final)=15.834 | 4871.0 samples/s | 76.1 steps/s
[Step=52700 Epoch=257.2] | Loss=0.01473 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.956 | L2-Norm(final)=15.836 | 7008.7 samples/s | 109.5 steps/s
[Step=52750 Epoch=257.4] | Loss=0.01306 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.964 | L2-Norm(final)=15.837 | 2244.8 samples/s | 35.1 steps/s
[Step=52800 Epoch=257.6] | Loss=0.01175 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.971 | L2-Norm(final)=15.840 | 4903.6 samples/s | 76.6 steps/s
[Step=52850 Epoch=257.9] | Loss=0.01073 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.977 | L2-Norm(final)=15.842 | 4886.1 samples/s | 76.3 steps/s
[Step=52900 Epoch=258.1] | Loss=0.01002 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.981 | L2-Norm(final)=15.844 | 6368.5 samples/s | 99.5 steps/s
[Step=52950 Epoch=258.4] | Loss=0.00946 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.986 | L2-Norm(final)=15.846 | 2312.3 samples/s | 36.1 steps/s
[Step=53000 Epoch=258.6] | Loss=0.00887 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.990 | L2-Norm(final)=15.848 | 4894.4 samples/s | 76.5 steps/s
[Step=53050 Epoch=258.9] | Loss=0.00831 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.993 | L2-Norm(final)=15.850 | 4780.0 samples/s | 74.7 steps/s
[Step=53100 Epoch=259.1] | Loss=0.00806 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.997 | L2-Norm(final)=15.852 | 5992.8 samples/s | 93.6 steps/s
[Step=53150 Epoch=259.3] | Loss=0.00777 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.000 | L2-Norm(final)=15.854 | 2390.0 samples/s | 37.3 steps/s
[Step=53200 Epoch=259.6] | Loss=0.00749 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.003 | L2-Norm(final)=15.856 | 4795.8 samples/s | 74.9 steps/s
[Step=53250 Epoch=259.8] | Loss=0.00722 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.005 | L2-Norm(final)=15.858 | 4865.4 samples/s | 76.0 steps/s
[Step=53300 Epoch=260.1] | Loss=0.00695 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.008 | L2-Norm(final)=15.860 | 5587.5 samples/s | 87.3 steps/s
[Step=53350 Epoch=260.3] | Loss=0.00681 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=15.861 | 2489.3 samples/s | 38.9 steps/s
[Step=53400 Epoch=260.6] | Loss=0.00654 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.013 | L2-Norm(final)=15.863 | 4752.8 samples/s | 74.3 steps/s
[Step=53450 Epoch=260.8] | Loss=0.00633 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=15.865 | 4839.9 samples/s | 75.6 steps/s
[Step=53500 Epoch=261.1] | Loss=0.00622 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=15.867 | 5271.4 samples/s | 82.4 steps/s
[Step=53550 Epoch=261.3] | Loss=0.00612 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.019 | L2-Norm(final)=15.868 | 2564.6 samples/s | 40.1 steps/s
[Step=53600 Epoch=261.5] | Loss=0.00596 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.021 | L2-Norm(final)=15.870 | 4781.7 samples/s | 74.7 steps/s
[Step=53650 Epoch=261.8] | Loss=0.00584 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=15.871 | 4895.8 samples/s | 76.5 steps/s
[Step=53700 Epoch=262.0] | Loss=0.00572 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.024 | L2-Norm(final)=15.873 | 4931.1 samples/s | 77.0 steps/s
[Step=53750 Epoch=262.3] | Loss=0.00560 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.026 | L2-Norm(final)=15.874 | 2627.4 samples/s | 41.1 steps/s
[Step=53800 Epoch=262.5] | Loss=0.00548 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.028 | L2-Norm(final)=15.875 | 4879.4 samples/s | 76.2 steps/s
[Step=53850 Epoch=262.8] | Loss=0.00534 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.030 | L2-Norm(final)=15.877 | 4889.9 samples/s | 76.4 steps/s
[Step=53900 Epoch=263.0] | Loss=0.00523 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.031 | L2-Norm(final)=15.878 | 4772.4 samples/s | 74.6 steps/s
[Step=53950 Epoch=263.3] | Loss=0.00525 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.033 | L2-Norm(final)=15.880 | 2654.3 samples/s | 41.5 steps/s
[Step=54000 Epoch=263.5] | Loss=0.00518 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.034 | L2-Norm(final)=15.881 | 4799.2 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step54000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=42001 Epoch=204.6] | Loss=0.00359 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=14.757 | 6087.4 samples/s | 95.1 steps/s
[Step=42050 Epoch=204.9] | Loss=0.01467 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.905 | L2-Norm(final)=14.761 | 4592.6 samples/s | 71.8 steps/s
[Step=42100 Epoch=205.1] | Loss=0.01551 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.905 | L2-Norm(final)=14.764 | 5766.3 samples/s | 90.1 steps/s
[Step=42150 Epoch=205.4] | Loss=0.01509 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.905 | L2-Norm(final)=14.767 | 5486.7 samples/s | 85.7 steps/s
[Step=42200 Epoch=205.6] | Loss=0.01625 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.905 | L2-Norm(final)=14.769 | 8763.9 samples/s | 136.9 steps/s
[Step=42250 Epoch=205.9] | Loss=0.01572 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=14.770 | 2423.2 samples/s | 37.9 steps/s
[Step=42300 Epoch=206.1] | Loss=0.01587 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=14.772 | 5713.2 samples/s | 89.3 steps/s
[Step=42350 Epoch=206.3] | Loss=0.01601 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.905 | L2-Norm(final)=14.773 | 5478.1 samples/s | 85.6 steps/s
[Step=42400 Epoch=206.6] | Loss=0.01597 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.905 | L2-Norm(final)=14.774 | 7842.9 samples/s | 122.5 steps/s
[Step=42450 Epoch=206.8] | Loss=0.01601 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=14.775 | 2564.8 samples/s | 40.1 steps/s
[Step=42500 Epoch=207.1] | Loss=0.01637 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=14.776 | 5379.9 samples/s | 84.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=42501 Epoch=207.1] | Loss=0.01613 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.905 | L2-Norm(final)=14.784 | 5792.2 samples/s | 90.5 steps/s
[Step=42550 Epoch=207.3] | Loss=0.02245 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.918 | L2-Norm(final)=14.778 | 4386.1 samples/s | 68.5 steps/s
[Step=42600 Epoch=207.6] | Loss=0.01681 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.933 | L2-Norm(final)=14.779 | 4855.6 samples/s | 75.9 steps/s
[Step=42650 Epoch=207.8] | Loss=0.01513 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.944 | L2-Norm(final)=14.781 | 4878.5 samples/s | 76.2 steps/s
[Step=42700 Epoch=208.1] | Loss=0.01412 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.954 | L2-Norm(final)=14.783 | 6977.4 samples/s | 109.0 steps/s
[Step=42750 Epoch=208.3] | Loss=0.01303 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.962 | L2-Norm(final)=14.785 | 2250.0 samples/s | 35.2 steps/s
[Step=42800 Epoch=208.5] | Loss=0.01176 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.970 | L2-Norm(final)=14.788 | 4887.7 samples/s | 76.4 steps/s
[Step=42850 Epoch=208.8] | Loss=0.01085 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=14.790 | 4813.1 samples/s | 75.2 steps/s
[Step=42900 Epoch=209.0] | Loss=0.01035 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.982 | L2-Norm(final)=14.793 | 6364.5 samples/s | 99.4 steps/s
[Step=42950 Epoch=209.3] | Loss=0.00958 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.987 | L2-Norm(final)=14.796 | 2347.7 samples/s | 36.7 steps/s
[Step=43000 Epoch=209.5] | Loss=0.00897 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.992 | L2-Norm(final)=14.798 | 4862.9 samples/s | 76.0 steps/s
[Step=43050 Epoch=209.8] | Loss=0.00837 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.996 | L2-Norm(final)=14.801 | 4943.8 samples/s | 77.2 steps/s
[Step=43100 Epoch=210.0] | Loss=0.00811 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.000 | L2-Norm(final)=14.804 | 5712.0 samples/s | 89.3 steps/s
[Step=43150 Epoch=210.2] | Loss=0.00782 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.004 | L2-Norm(final)=14.806 | 2423.7 samples/s | 37.9 steps/s
[Step=43200 Epoch=210.5] | Loss=0.00751 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.008 | L2-Norm(final)=14.809 | 4841.6 samples/s | 75.6 steps/s
[Step=43250 Epoch=210.7] | Loss=0.00731 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=14.811 | 4968.1 samples/s | 77.6 steps/s
[Step=43300 Epoch=211.0] | Loss=0.00713 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.014 | L2-Norm(final)=14.814 | 5272.9 samples/s | 82.4 steps/s
[Step=43350 Epoch=211.2] | Loss=0.00688 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.018 | L2-Norm(final)=14.816 | 2521.5 samples/s | 39.4 steps/s
[Step=43400 Epoch=211.5] | Loss=0.00670 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.021 | L2-Norm(final)=14.818 | 4853.2 samples/s | 75.8 steps/s
[Step=43450 Epoch=211.7] | Loss=0.00652 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=14.820 | 4871.0 samples/s | 76.1 steps/s
[Step=43500 Epoch=212.0] | Loss=0.00635 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.026 | L2-Norm(final)=14.822 | 4997.6 samples/s | 78.1 steps/s
[Step=43550 Epoch=212.2] | Loss=0.00620 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.029 | L2-Norm(final)=14.824 | 2589.3 samples/s | 40.5 steps/s
[Step=43600 Epoch=212.4] | Loss=0.00607 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.032 | L2-Norm(final)=14.826 | 4865.4 samples/s | 76.0 steps/s
[Step=43650 Epoch=212.7] | Loss=0.00589 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.034 | L2-Norm(final)=14.828 | 4901.0 samples/s | 76.6 steps/s
[Step=43700 Epoch=212.9] | Loss=0.00575 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.037 | L2-Norm(final)=14.830 | 4942.5 samples/s | 77.2 steps/s
[Step=43750 Epoch=213.2] | Loss=0.00566 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.039 | L2-Norm(final)=14.832 | 2637.6 samples/s | 41.2 steps/s
[Step=43800 Epoch=213.4] | Loss=0.00555 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.041 | L2-Norm(final)=14.834 | 4839.8 samples/s | 75.6 steps/s
[Step=43850 Epoch=213.7] | Loss=0.00543 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.044 | L2-Norm(final)=14.836 | 4882.0 samples/s | 76.3 steps/s
[Step=43900 Epoch=213.9] | Loss=0.00532 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.046 | L2-Norm(final)=14.838 | 4863.3 samples/s | 76.0 steps/s
[Step=43950 Epoch=214.1] | Loss=0.00523 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.048 | L2-Norm(final)=14.840 | 2631.8 samples/s | 41.1 steps/s
[Step=44000 Epoch=214.4] | Loss=0.00515 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.050 | L2-Norm(final)=14.842 | 4892.0 samples/s | 76.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step44000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=42001 Epoch=204.8] | Loss=0.00421 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.130 | 5569.5 samples/s | 87.0 steps/s
[Step=42050 Epoch=205.1] | Loss=0.01380 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.905 | L2-Norm(final)=15.135 | 4999.0 samples/s | 78.1 steps/s
[Step=42100 Epoch=205.3] | Loss=0.01399 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.137 | 5555.2 samples/s | 86.8 steps/s
[Step=42150 Epoch=205.5] | Loss=0.01405 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.139 | 5635.5 samples/s | 88.1 steps/s
[Step=42200 Epoch=205.8] | Loss=0.01414 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.140 | 8809.3 samples/s | 137.6 steps/s
[Step=42250 Epoch=206.0] | Loss=0.01398 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.142 | 2465.5 samples/s | 38.5 steps/s
[Step=42300 Epoch=206.3] | Loss=0.01348 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.144 | 5563.2 samples/s | 86.9 steps/s
[Step=42350 Epoch=206.5] | Loss=0.01386 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.146 | 5585.9 samples/s | 87.3 steps/s
[Step=42400 Epoch=206.8] | Loss=0.01407 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.905 | L2-Norm(final)=15.148 | 7696.4 samples/s | 120.3 steps/s
[Step=42450 Epoch=207.0] | Loss=0.01395 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.150 | 2523.7 samples/s | 39.4 steps/s
[Step=42500 Epoch=207.3] | Loss=0.01427 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.151 | 5784.2 samples/s | 90.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=42501 Epoch=207.3] | Loss=0.02244 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.905 | L2-Norm(final)=15.169 | 5579.3 samples/s | 87.2 steps/s
[Step=42550 Epoch=207.5] | Loss=0.01577 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.918 | L2-Norm(final)=15.169 | 4533.8 samples/s | 70.8 steps/s
[Step=42600 Epoch=207.7] | Loss=0.01628 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.930 | L2-Norm(final)=15.168 | 4823.2 samples/s | 75.4 steps/s
[Step=42650 Epoch=208.0] | Loss=0.01539 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.942 | L2-Norm(final)=15.169 | 4895.7 samples/s | 76.5 steps/s
[Step=42700 Epoch=208.2] | Loss=0.01393 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.951 | L2-Norm(final)=15.170 | 6866.5 samples/s | 107.3 steps/s
[Step=42750 Epoch=208.5] | Loss=0.01222 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.959 | L2-Norm(final)=15.172 | 2270.7 samples/s | 35.5 steps/s
[Step=42800 Epoch=208.7] | Loss=0.01084 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.965 | L2-Norm(final)=15.174 | 4828.9 samples/s | 75.5 steps/s
[Step=42850 Epoch=209.0] | Loss=0.01020 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.971 | L2-Norm(final)=15.176 | 4857.8 samples/s | 75.9 steps/s
[Step=42900 Epoch=209.2] | Loss=0.00957 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.975 | L2-Norm(final)=15.178 | 6375.5 samples/s | 99.6 steps/s
[Step=42950 Epoch=209.4] | Loss=0.00912 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=15.180 | 2341.4 samples/s | 36.6 steps/s
[Step=43000 Epoch=209.7] | Loss=0.00859 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.983 | L2-Norm(final)=15.182 | 4911.9 samples/s | 76.7 steps/s
[Step=43050 Epoch=209.9] | Loss=0.00803 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.986 | L2-Norm(final)=15.184 | 4804.0 samples/s | 75.1 steps/s
[Step=43100 Epoch=210.2] | Loss=0.00768 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.990 | L2-Norm(final)=15.186 | 5837.5 samples/s | 91.2 steps/s
[Step=43150 Epoch=210.4] | Loss=0.00734 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.993 | L2-Norm(final)=15.188 | 2436.2 samples/s | 38.1 steps/s
[Step=43200 Epoch=210.7] | Loss=0.00690 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.996 | L2-Norm(final)=15.190 | 4899.5 samples/s | 76.6 steps/s
[Step=43250 Epoch=210.9] | Loss=0.00667 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.999 | L2-Norm(final)=15.192 | 4968.5 samples/s | 77.6 steps/s
[Step=43300 Epoch=211.2] | Loss=0.00656 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.002 | L2-Norm(final)=15.194 | 5249.7 samples/s | 82.0 steps/s
[Step=43350 Epoch=211.4] | Loss=0.00640 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.004 | L2-Norm(final)=15.195 | 2509.0 samples/s | 39.2 steps/s
[Step=43400 Epoch=211.6] | Loss=0.00621 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.007 | L2-Norm(final)=15.197 | 4902.8 samples/s | 76.6 steps/s
[Step=43450 Epoch=211.9] | Loss=0.00613 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.009 | L2-Norm(final)=15.199 | 4814.0 samples/s | 75.2 steps/s
[Step=43500 Epoch=212.1] | Loss=0.00595 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=15.200 | 4979.2 samples/s | 77.8 steps/s
[Step=43550 Epoch=212.4] | Loss=0.00575 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=15.202 | 2606.5 samples/s | 40.7 steps/s
[Step=43600 Epoch=212.6] | Loss=0.00559 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.016 | L2-Norm(final)=15.203 | 4799.7 samples/s | 75.0 steps/s
[Step=43650 Epoch=212.9] | Loss=0.00547 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.018 | L2-Norm(final)=15.205 | 4841.1 samples/s | 75.6 steps/s
[Step=43700 Epoch=213.1] | Loss=0.00539 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.020 | L2-Norm(final)=15.207 | 4875.0 samples/s | 76.2 steps/s
[Step=43750 Epoch=213.3] | Loss=0.00533 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.022 | L2-Norm(final)=15.208 | 2663.0 samples/s | 41.6 steps/s
[Step=43800 Epoch=213.6] | Loss=0.00521 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.024 | L2-Norm(final)=15.210 | 4887.3 samples/s | 76.4 steps/s
[Step=43850 Epoch=213.8] | Loss=0.00510 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.026 | L2-Norm(final)=15.211 | 4827.9 samples/s | 75.4 steps/s
[Step=43900 Epoch=214.1] | Loss=0.00498 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.028 | L2-Norm(final)=15.213 | 4879.5 samples/s | 76.2 steps/s
[Step=43950 Epoch=214.3] | Loss=0.00494 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.030 | L2-Norm(final)=15.214 | 2664.0 samples/s | 41.6 steps/s
[Step=44000 Epoch=214.6] | Loss=0.00483 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.031 | L2-Norm(final)=15.216 | 4903.8 samples/s | 76.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step44000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=50001 Epoch=245.2] | Loss=0.02317 | Reg=0.00098 | acc=0.9531 | L2-Norm=9.905 | L2-Norm(final)=15.836 | 6024.0 samples/s | 94.1 steps/s
[Step=50050 Epoch=245.4] | Loss=0.01580 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.836 | 4784.4 samples/s | 74.8 steps/s
[Step=50100 Epoch=245.7] | Loss=0.01674 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.833 | 5610.6 samples/s | 87.7 steps/s
[Step=50150 Epoch=245.9] | Loss=0.01723 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.830 | 5609.7 samples/s | 87.7 steps/s
[Step=50200 Epoch=246.2] | Loss=0.01736 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.828 | 9069.6 samples/s | 141.7 steps/s
[Step=50250 Epoch=246.4] | Loss=0.01645 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.827 | 2397.0 samples/s | 37.5 steps/s
[Step=50300 Epoch=246.7] | Loss=0.01697 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.905 | L2-Norm(final)=15.826 | 5746.1 samples/s | 89.8 steps/s
[Step=50350 Epoch=246.9] | Loss=0.01698 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.826 | 5520.2 samples/s | 86.3 steps/s
[Step=50400 Epoch=247.2] | Loss=0.01697 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.825 | 8325.0 samples/s | 130.1 steps/s
[Step=50450 Epoch=247.4] | Loss=0.01659 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.824 | 2457.2 samples/s | 38.4 steps/s
[Step=50500 Epoch=247.6] | Loss=0.01696 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.905 | L2-Norm(final)=15.824 | 5621.3 samples/s | 87.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=50501 Epoch=247.6] | Loss=0.00214 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.816 | 5496.1 samples/s | 85.9 steps/s
[Step=50550 Epoch=247.9] | Loss=0.01955 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.919 | L2-Norm(final)=15.811 | 4671.4 samples/s | 73.0 steps/s
[Step=50600 Epoch=248.1] | Loss=0.01689 | Reg=0.00099 | acc=0.9688 | L2-Norm=9.932 | L2-Norm(final)=15.811 | 4889.8 samples/s | 76.4 steps/s
[Step=50650 Epoch=248.4] | Loss=0.01549 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.943 | L2-Norm(final)=15.812 | 4848.3 samples/s | 75.8 steps/s
[Step=50700 Epoch=248.6] | Loss=0.01393 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.952 | L2-Norm(final)=15.814 | 7156.0 samples/s | 111.8 steps/s
[Step=50750 Epoch=248.9] | Loss=0.01237 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.959 | L2-Norm(final)=15.817 | 2249.7 samples/s | 35.2 steps/s
[Step=50800 Epoch=249.1] | Loss=0.01107 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.966 | L2-Norm(final)=15.819 | 4871.6 samples/s | 76.1 steps/s
[Step=50850 Epoch=249.4] | Loss=0.01034 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.972 | L2-Norm(final)=15.822 | 4931.0 samples/s | 77.0 steps/s
[Step=50900 Epoch=249.6] | Loss=0.00973 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.977 | L2-Norm(final)=15.824 | 6570.5 samples/s | 102.7 steps/s
[Step=50950 Epoch=249.9] | Loss=0.00926 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.982 | L2-Norm(final)=15.826 | 2285.0 samples/s | 35.7 steps/s
[Step=51000 Epoch=250.1] | Loss=0.00857 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.986 | L2-Norm(final)=15.828 | 4854.6 samples/s | 75.9 steps/s
[Step=51050 Epoch=250.3] | Loss=0.00811 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.989 | L2-Norm(final)=15.830 | 4893.6 samples/s | 76.5 steps/s
[Step=51100 Epoch=250.6] | Loss=0.00773 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.993 | L2-Norm(final)=15.832 | 6289.4 samples/s | 98.3 steps/s
[Step=51150 Epoch=250.8] | Loss=0.00730 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.996 | L2-Norm(final)=15.835 | 2347.5 samples/s | 36.7 steps/s
[Step=51200 Epoch=251.1] | Loss=0.00705 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.999 | L2-Norm(final)=15.837 | 4858.8 samples/s | 75.9 steps/s
[Step=51250 Epoch=251.3] | Loss=0.00679 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.002 | L2-Norm(final)=15.839 | 4909.5 samples/s | 76.7 steps/s
[Step=51300 Epoch=251.6] | Loss=0.00657 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.005 | L2-Norm(final)=15.840 | 5901.8 samples/s | 92.2 steps/s
[Step=51350 Epoch=251.8] | Loss=0.00637 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.008 | L2-Norm(final)=15.842 | 2405.4 samples/s | 37.6 steps/s
[Step=51400 Epoch=252.1] | Loss=0.00614 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=15.844 | 4863.2 samples/s | 76.0 steps/s
[Step=51450 Epoch=252.3] | Loss=0.00594 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.013 | L2-Norm(final)=15.846 | 4890.1 samples/s | 76.4 steps/s
[Step=51500 Epoch=252.5] | Loss=0.00586 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.015 | L2-Norm(final)=15.848 | 5557.3 samples/s | 86.8 steps/s
[Step=51550 Epoch=252.8] | Loss=0.00569 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.018 | L2-Norm(final)=15.849 | 2443.7 samples/s | 38.2 steps/s
[Step=51600 Epoch=253.0] | Loss=0.00553 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.020 | L2-Norm(final)=15.851 | 4838.6 samples/s | 75.6 steps/s
[Step=51650 Epoch=253.3] | Loss=0.00538 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.022 | L2-Norm(final)=15.853 | 4928.8 samples/s | 77.0 steps/s
[Step=51700 Epoch=253.5] | Loss=0.00532 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.024 | L2-Norm(final)=15.854 | 5261.9 samples/s | 82.2 steps/s
[Step=51750 Epoch=253.8] | Loss=0.00519 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.026 | L2-Norm(final)=15.856 | 2525.1 samples/s | 39.5 steps/s
[Step=51800 Epoch=254.0] | Loss=0.00511 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.028 | L2-Norm(final)=15.858 | 4785.1 samples/s | 74.8 steps/s
[Step=51850 Epoch=254.3] | Loss=0.00502 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.030 | L2-Norm(final)=15.859 | 4858.8 samples/s | 75.9 steps/s
[Step=51900 Epoch=254.5] | Loss=0.00494 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.032 | L2-Norm(final)=15.861 | 5103.4 samples/s | 79.7 steps/s
[Step=51950 Epoch=254.8] | Loss=0.00487 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.034 | L2-Norm(final)=15.862 | 2580.6 samples/s | 40.3 steps/s
[Step=52000 Epoch=255.0] | Loss=0.00476 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.036 | L2-Norm(final)=15.864 | 4865.2 samples/s | 76.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step52000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=28001 Epoch=266.9] | Loss=0.00014 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=14.809 | 5903.6 samples/s | 92.2 steps/s
[Step=28050 Epoch=267.3] | Loss=0.00060 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.824 | 4584.7 samples/s | 71.6 steps/s
[Step=28100 Epoch=267.8] | Loss=0.00054 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.835 | 8405.9 samples/s | 131.3 steps/s
[Step=28150 Epoch=268.3] | Loss=0.00056 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.845 | 2356.2 samples/s | 36.8 steps/s
[Step=28200 Epoch=268.8] | Loss=0.00057 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.856 | 7428.4 samples/s | 116.1 steps/s
[Step=28250 Epoch=269.2] | Loss=0.00058 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.868 | 2419.0 samples/s | 37.8 steps/s
[Step=28300 Epoch=269.7] | Loss=0.00055 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.880 | 6886.8 samples/s | 107.6 steps/s
[Step=28350 Epoch=270.2] | Loss=0.00058 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.891 | 2453.1 samples/s | 38.3 steps/s
[Step=28400 Epoch=270.7] | Loss=0.00056 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.902 | 6370.1 samples/s | 99.5 steps/s
[Step=28450 Epoch=271.2] | Loss=0.00054 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.912 | 2539.2 samples/s | 39.7 steps/s
[Step=28500 Epoch=271.6] | Loss=0.00054 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.922 | 5890.4 samples/s | 92.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=28501 Epoch=271.6] | Loss=0.00045 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=15.022 | 5923.2 samples/s | 92.5 steps/s
[Step=28550 Epoch=272.1] | Loss=0.00112 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.927 | L2-Norm(final)=15.029 | 4032.6 samples/s | 63.0 steps/s
[Step=28600 Epoch=272.6] | Loss=0.00086 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.947 | L2-Norm(final)=15.030 | 6805.6 samples/s | 106.3 steps/s
[Step=28650 Epoch=273.1] | Loss=0.00059 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.957 | L2-Norm(final)=15.031 | 2180.4 samples/s | 34.1 steps/s
[Step=28700 Epoch=273.5] | Loss=0.00045 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.961 | L2-Norm(final)=15.032 | 6081.9 samples/s | 95.0 steps/s
[Step=28750 Epoch=274.0] | Loss=0.00036 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.962 | L2-Norm(final)=15.033 | 2270.1 samples/s | 35.5 steps/s
[Step=28800 Epoch=274.5] | Loss=0.00030 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.962 | L2-Norm(final)=15.034 | 5691.5 samples/s | 88.9 steps/s
[Step=28850 Epoch=275.0] | Loss=0.00026 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.961 | L2-Norm(final)=15.034 | 2318.0 samples/s | 36.2 steps/s
[Step=28900 Epoch=275.4] | Loss=0.00023 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.960 | L2-Norm(final)=15.035 | 5238.9 samples/s | 81.9 steps/s
[Step=28950 Epoch=275.9] | Loss=0.00020 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.958 | L2-Norm(final)=15.035 | 2379.9 samples/s | 37.2 steps/s
[Step=29000 Epoch=276.4] | Loss=0.00018 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.956 | L2-Norm(final)=15.035 | 5019.4 samples/s | 78.4 steps/s
[Step=29050 Epoch=276.9] | Loss=0.00017 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.953 | L2-Norm(final)=15.036 | 2445.7 samples/s | 38.2 steps/s
[Step=29100 Epoch=277.3] | Loss=0.00015 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.951 | L2-Norm(final)=15.036 | 4710.7 samples/s | 73.6 steps/s
[Step=29150 Epoch=277.8] | Loss=0.00014 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.948 | L2-Norm(final)=15.037 | 2542.8 samples/s | 39.7 steps/s
[Step=29200 Epoch=278.3] | Loss=0.00013 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.945 | L2-Norm(final)=15.037 | 4528.3 samples/s | 70.8 steps/s
[Step=29250 Epoch=278.8] | Loss=0.00012 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.943 | L2-Norm(final)=15.037 | 2597.6 samples/s | 40.6 steps/s
[Step=29300 Epoch=279.3] | Loss=0.00012 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.940 | L2-Norm(final)=15.038 | 4554.9 samples/s | 71.2 steps/s
[Step=29350 Epoch=279.7] | Loss=0.00011 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.937 | L2-Norm(final)=15.038 | 2560.9 samples/s | 40.0 steps/s
[Step=29400 Epoch=280.2] | Loss=0.00010 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.934 | L2-Norm(final)=15.038 | 4576.7 samples/s | 71.5 steps/s
[Step=29450 Epoch=280.7] | Loss=0.00010 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.931 | L2-Norm(final)=15.039 | 2610.4 samples/s | 40.8 steps/s
[Step=29500 Epoch=281.2] | Loss=0.00009 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.928 | L2-Norm(final)=15.039 | 4492.4 samples/s | 70.2 steps/s
[Step=29550 Epoch=281.6] | Loss=0.00009 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.924 | L2-Norm(final)=15.039 | 7458.8 samples/s | 116.5 steps/s
[Step=29600 Epoch=282.1] | Loss=0.00009 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.921 | L2-Norm(final)=15.040 | 2111.7 samples/s | 33.0 steps/s
[Step=29650 Epoch=282.6] | Loss=0.00008 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.918 | L2-Norm(final)=15.040 | 6812.2 samples/s | 106.4 steps/s
[Step=29700 Epoch=283.1] | Loss=0.00008 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.915 | L2-Norm(final)=15.040 | 2206.6 samples/s | 34.5 steps/s
[Step=29750 Epoch=283.5] | Loss=0.00008 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.911 | L2-Norm(final)=15.041 | 6027.4 samples/s | 94.2 steps/s
[Step=29800 Epoch=284.0] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.908 | L2-Norm(final)=15.041 | 2218.3 samples/s | 34.7 steps/s
[Step=29850 Epoch=284.5] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=15.041 | 5763.0 samples/s | 90.0 steps/s
[Step=29900 Epoch=285.0] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=15.042 | 2316.5 samples/s | 36.2 steps/s
[Step=29950 Epoch=285.5] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=15.042 | 5289.7 samples/s | 82.7 steps/s
[Step=30000 Epoch=285.9] | Loss=0.00006 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.894 | L2-Norm(final)=15.042 | 2381.0 samples/s | 37.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4/client_state-step30000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08410 | acc=0.9632 | tpr=0.9708 | fpr=0.0533 | 5494.8 samples/s | 21.5 steps/s
Avg test loss: 0.09159, Avg test acc: 0.96089, Avg tpr: 0.96882, Avg fpr: 0.05653, total FA: 441

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08525 | acc=0.9644 | tpr=0.9832 | fpr=0.0766 | 5397.6 samples/s | 21.1 steps/s
Avg test loss: 0.09150, Avg test acc: 0.96330, Avg tpr: 0.98205, Avg fpr: 0.07794, total FA: 608

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08797 | acc=0.9634 | tpr=0.9789 | fpr=0.0701 | 5640.0 samples/s | 22.0 steps/s
Avg test loss: 0.09422, Avg test acc: 0.96222, Avg tpr: 0.97645, Avg fpr: 0.06909, total FA: 539

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08621 | acc=0.9631 | tpr=0.9767 | fpr=0.0664 | 5621.8 samples/s | 22.0 steps/s
Avg test loss: 0.09317, Avg test acc: 0.96334, Avg tpr: 0.97698, Avg fpr: 0.06666, total FA: 520

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08101 | acc=0.9650 | tpr=0.9743 | fpr=0.0553 | 5841.0 samples/s | 22.8 steps/s
Avg test loss: 0.09372, Avg test acc: 0.96330, Avg tpr: 0.97243, Avg fpr: 0.05679, total FA: 443

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.48582 | acc=0.2774 | tpr=0.0056 | fpr=0.1323 | 5689.5 samples/s | 22.2 steps/s
Avg test loss: 5.49666, Avg test acc: 0.27594, Avg tpr: 0.00624, Avg fpr: 0.13088, total FA: 1021

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.85680 | acc=0.2952 | tpr=0.0113 | fpr=0.0885 | 5609.1 samples/s | 21.9 steps/s
Avg test loss: 4.86905, Avg test acc: 0.29217, Avg tpr: 0.01078, Avg fpr: 0.08896, total FA: 694

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.29059 | acc=0.2333 | tpr=0.0128 | fpr=0.2879 | 5566.2 samples/s | 21.7 steps/s
Avg test loss: 5.29693, Avg test acc: 0.23347, Avg tpr: 0.01364, Avg fpr: 0.28304, total FA: 2208

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=6.27982 | acc=0.2412 | tpr=0.0103 | fpr=0.2572 | 5735.1 samples/s | 22.4 steps/s
Avg test loss: 6.29203, Avg test acc: 0.23948, Avg tpr: 0.01067, Avg fpr: 0.25727, total FA: 2007

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.38545 | acc=0.2746 | tpr=0.0087 | fpr=0.1479 | 5711.1 samples/s | 22.3 steps/s
Avg test loss: 5.39428, Avg test acc: 0.27322, Avg tpr: 0.00933, Avg fpr: 0.14639, total FA: 1142

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.05535 | acc=0.1616 | tpr=0.2566 | fpr=0.8401 | 5640.6 samples/s | 22.0 steps/s
[Step= 100] | Loss=5.00942 | acc=0.1623 | tpr=0.2239 | fpr=0.8388 | 8253.0 samples/s | 32.2 steps/s
[Step= 150] | Loss=5.02531 | acc=0.1608 | tpr=0.2118 | fpr=0.8401 | 8120.0 samples/s | 31.7 steps/s
[Step= 200] | Loss=5.01968 | acc=0.1608 | tpr=0.2077 | fpr=0.8401 | 8093.5 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.02506 | acc=0.1610 | tpr=0.2087 | fpr=0.8398 | 8107.7 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.02885 | acc=0.1601 | tpr=0.2116 | fpr=0.8408 | 7454.2 samples/s | 29.1 steps/s
[Step= 350] | Loss=5.03218 | acc=0.1597 | tpr=0.1997 | fpr=0.8410 | 7902.0 samples/s | 30.9 steps/s
[Step= 400] | Loss=5.03151 | acc=0.1603 | tpr=0.2040 | fpr=0.8405 | 7765.5 samples/s | 30.3 steps/s
[Step= 450] | Loss=5.03028 | acc=0.1607 | tpr=0.2011 | fpr=0.8401 | 8440.3 samples/s | 33.0 steps/s
[Step= 500] | Loss=5.03335 | acc=0.1604 | tpr=0.2062 | fpr=0.8405 | 8224.6 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.03103 | acc=0.1605 | tpr=0.2014 | fpr=0.8402 | 10868.8 samples/s | 42.5 steps/s
Avg test loss: 5.03059, Avg test acc: 0.16040, Avg tpr: 0.20166, Avg fpr: 0.84035, total FA: 116681

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.14771 | acc=0.1267 | tpr=0.2788 | fpr=0.8760 | 5548.1 samples/s | 21.7 steps/s
[Step= 100] | Loss=5.10349 | acc=0.1291 | tpr=0.2495 | fpr=0.8731 | 8245.0 samples/s | 32.2 steps/s
[Step= 150] | Loss=5.12017 | acc=0.1266 | tpr=0.2406 | fpr=0.8755 | 7283.0 samples/s | 28.4 steps/s
[Step= 200] | Loss=5.11658 | acc=0.1267 | tpr=0.2350 | fpr=0.8753 | 8915.1 samples/s | 34.8 steps/s
[Step= 250] | Loss=5.12026 | acc=0.1265 | tpr=0.2306 | fpr=0.8754 | 8015.0 samples/s | 31.3 steps/s
[Step= 300] | Loss=5.12399 | acc=0.1257 | tpr=0.2320 | fpr=0.8762 | 8164.0 samples/s | 31.9 steps/s
[Step= 350] | Loss=5.12656 | acc=0.1252 | tpr=0.2173 | fpr=0.8765 | 8057.4 samples/s | 31.5 steps/s
[Step= 400] | Loss=5.12531 | acc=0.1258 | tpr=0.2237 | fpr=0.8759 | 8454.4 samples/s | 33.0 steps/s
[Step= 450] | Loss=5.12383 | acc=0.1261 | tpr=0.2210 | fpr=0.8756 | 7420.8 samples/s | 29.0 steps/s
[Step= 500] | Loss=5.12673 | acc=0.1262 | tpr=0.2251 | fpr=0.8756 | 8156.1 samples/s | 31.9 steps/s
[Step= 550] | Loss=5.12446 | acc=0.1265 | tpr=0.2240 | fpr=0.8753 | 10954.7 samples/s | 42.8 steps/s
Avg test loss: 5.12463, Avg test acc: 0.12644, Avg tpr: 0.22385, Avg fpr: 0.87533, total FA: 121538

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.81398 | acc=0.1326 | tpr=0.1504 | fpr=0.8677 | 5786.8 samples/s | 22.6 steps/s
[Step= 100] | Loss=5.76672 | acc=0.1345 | tpr=0.1493 | fpr=0.8658 | 7949.8 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.77713 | acc=0.1334 | tpr=0.1542 | fpr=0.8669 | 7575.2 samples/s | 29.6 steps/s
[Step= 200] | Loss=5.77062 | acc=0.1338 | tpr=0.1497 | fpr=0.8665 | 7389.0 samples/s | 28.9 steps/s
[Step= 250] | Loss=5.77493 | acc=0.1336 | tpr=0.1493 | fpr=0.8667 | 8744.2 samples/s | 34.2 steps/s
[Step= 300] | Loss=5.78127 | acc=0.1333 | tpr=0.1527 | fpr=0.8670 | 8275.2 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.78515 | acc=0.1329 | tpr=0.1453 | fpr=0.8673 | 8157.2 samples/s | 31.9 steps/s
[Step= 400] | Loss=5.78329 | acc=0.1333 | tpr=0.1521 | fpr=0.8670 | 7840.0 samples/s | 30.6 steps/s
[Step= 450] | Loss=5.78126 | acc=0.1335 | tpr=0.1504 | fpr=0.8668 | 8043.8 samples/s | 31.4 steps/s
[Step= 500] | Loss=5.78306 | acc=0.1334 | tpr=0.1520 | fpr=0.8670 | 8072.1 samples/s | 31.5 steps/s
[Step= 550] | Loss=5.77917 | acc=0.1336 | tpr=0.1520 | fpr=0.8667 | 11127.9 samples/s | 43.5 steps/s
Avg test loss: 5.77899, Avg test acc: 0.13357, Avg tpr: 0.15254, Avg fpr: 0.86678, total FA: 120350

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.43792 | acc=0.1407 | tpr=0.2035 | fpr=0.8604 | 5686.7 samples/s | 22.2 steps/s
[Step= 100] | Loss=5.39513 | acc=0.1412 | tpr=0.2047 | fpr=0.8600 | 8041.4 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.41106 | acc=0.1406 | tpr=0.2017 | fpr=0.8606 | 7765.0 samples/s | 30.3 steps/s
[Step= 200] | Loss=5.40167 | acc=0.1409 | tpr=0.1989 | fpr=0.8602 | 8122.6 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.40750 | acc=0.1410 | tpr=0.2017 | fpr=0.8601 | 7854.4 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.41343 | acc=0.1402 | tpr=0.2022 | fpr=0.8609 | 8281.7 samples/s | 32.4 steps/s
[Step= 350] | Loss=5.41420 | acc=0.1398 | tpr=0.1910 | fpr=0.8611 | 7980.7 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.41263 | acc=0.1403 | tpr=0.1997 | fpr=0.8608 | 7961.5 samples/s | 31.1 steps/s
[Step= 450] | Loss=5.41134 | acc=0.1405 | tpr=0.1967 | fpr=0.8605 | 7484.5 samples/s | 29.2 steps/s
[Step= 500] | Loss=5.41572 | acc=0.1402 | tpr=0.1978 | fpr=0.8608 | 8363.7 samples/s | 32.7 steps/s
[Step= 550] | Loss=5.41342 | acc=0.1403 | tpr=0.1990 | fpr=0.8607 | 11431.2 samples/s | 44.7 steps/s
Avg test loss: 5.41297, Avg test acc: 0.14023, Avg tpr: 0.19889, Avg fpr: 0.86083, total FA: 119525

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.89748 | acc=0.1415 | tpr=0.1239 | fpr=0.8582 | 5720.9 samples/s | 22.3 steps/s
[Step= 100] | Loss=5.84193 | acc=0.1431 | tpr=0.1173 | fpr=0.8564 | 7824.4 samples/s | 30.6 steps/s
[Step= 150] | Loss=5.85797 | acc=0.1425 | tpr=0.1153 | fpr=0.8570 | 8199.7 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.85402 | acc=0.1426 | tpr=0.1115 | fpr=0.8568 | 8221.1 samples/s | 32.1 steps/s
[Step= 250] | Loss=5.86230 | acc=0.1427 | tpr=0.1127 | fpr=0.8568 | 7752.1 samples/s | 30.3 steps/s
[Step= 300] | Loss=5.86522 | acc=0.1423 | tpr=0.1135 | fpr=0.8572 | 7689.4 samples/s | 30.0 steps/s
[Step= 350] | Loss=5.86859 | acc=0.1418 | tpr=0.1096 | fpr=0.8576 | 8202.0 samples/s | 32.0 steps/s
[Step= 400] | Loss=5.86717 | acc=0.1422 | tpr=0.1138 | fpr=0.8573 | 8235.9 samples/s | 32.2 steps/s
[Step= 450] | Loss=5.86630 | acc=0.1425 | tpr=0.1154 | fpr=0.8570 | 8113.4 samples/s | 31.7 steps/s
[Step= 500] | Loss=5.86978 | acc=0.1422 | tpr=0.1154 | fpr=0.8573 | 7568.9 samples/s | 29.6 steps/s
[Step= 550] | Loss=5.86616 | acc=0.1423 | tpr=0.1146 | fpr=0.8572 | 10045.8 samples/s | 39.2 steps/s
Avg test loss: 5.86593, Avg test acc: 0.14216, Avg tpr: 0.11529, Avg fpr: 0.85735, total FA: 119041

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11048 | acc=0.9810 | tpr=0.9336 | fpr=0.0181 | 5793.8 samples/s | 22.6 steps/s
[Step= 100] | Loss=0.11174 | acc=0.9811 | tpr=0.9403 | fpr=0.0182 | 7806.2 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.11536 | acc=0.9806 | tpr=0.9438 | fpr=0.0187 | 7712.4 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.11709 | acc=0.9807 | tpr=0.9486 | fpr=0.0187 | 7944.5 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.11750 | acc=0.9805 | tpr=0.9441 | fpr=0.0188 | 8516.6 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.11901 | acc=0.9804 | tpr=0.9447 | fpr=0.0189 | 7898.3 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.11933 | acc=0.9805 | tpr=0.9480 | fpr=0.0190 | 8129.1 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.12028 | acc=0.9802 | tpr=0.9437 | fpr=0.0191 | 8041.6 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.12265 | acc=0.9799 | tpr=0.9416 | fpr=0.0195 | 8317.4 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.12179 | acc=0.9800 | tpr=0.9432 | fpr=0.0194 | 8076.5 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.12077 | acc=0.9801 | tpr=0.9427 | fpr=0.0192 | 8549.7 samples/s | 33.4 steps/s
Avg test loss: 0.12055, Avg test acc: 0.98010, Avg tpr: 0.94255, Avg fpr: 0.01922, total FA: 2668

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09914 | acc=0.9812 | tpr=0.9115 | fpr=0.0175 | 5617.0 samples/s | 21.9 steps/s
[Step= 100] | Loss=0.10044 | acc=0.9809 | tpr=0.9275 | fpr=0.0181 | 7412.8 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.10317 | acc=0.9804 | tpr=0.9294 | fpr=0.0187 | 8327.4 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.10437 | acc=0.9803 | tpr=0.9301 | fpr=0.0188 | 7697.9 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.10514 | acc=0.9803 | tpr=0.9275 | fpr=0.0187 | 8384.5 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.10632 | acc=0.9802 | tpr=0.9287 | fpr=0.0189 | 8052.2 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.10638 | acc=0.9802 | tpr=0.9286 | fpr=0.0189 | 8324.8 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.10757 | acc=0.9800 | tpr=0.9240 | fpr=0.0190 | 8091.6 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.10939 | acc=0.9797 | tpr=0.9231 | fpr=0.0192 | 7896.6 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.10857 | acc=0.9798 | tpr=0.9251 | fpr=0.0192 | 8010.0 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.10758 | acc=0.9799 | tpr=0.9240 | fpr=0.0191 | 9461.5 samples/s | 37.0 steps/s
Avg test loss: 0.10738, Avg test acc: 0.97994, Avg tpr: 0.92353, Avg fpr: 0.01904, total FA: 2643

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11612 | acc=0.9788 | tpr=0.9336 | fpr=0.0204 | 5578.6 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.11732 | acc=0.9790 | tpr=0.9531 | fpr=0.0205 | 7596.1 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.12139 | acc=0.9783 | tpr=0.9524 | fpr=0.0212 | 7911.2 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.12303 | acc=0.9784 | tpr=0.9574 | fpr=0.0213 | 8770.3 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.12402 | acc=0.9783 | tpr=0.9555 | fpr=0.0213 | 7754.4 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.12520 | acc=0.9783 | tpr=0.9564 | fpr=0.0213 | 7998.4 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.12522 | acc=0.9782 | tpr=0.9593 | fpr=0.0214 | 8259.4 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.12604 | acc=0.9779 | tpr=0.9551 | fpr=0.0217 | 7936.5 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.12826 | acc=0.9775 | tpr=0.9533 | fpr=0.0220 | 8106.5 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.12742 | acc=0.9776 | tpr=0.9546 | fpr=0.0220 | 6349.8 samples/s | 24.8 steps/s
[Step= 550] | Loss=0.12629 | acc=0.9778 | tpr=0.9542 | fpr=0.0218 | 12152.2 samples/s | 47.5 steps/s
Avg test loss: 0.12606, Avg test acc: 0.97777, Avg tpr: 0.95404, Avg fpr: 0.02179, total FA: 3026

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09576 | acc=0.9827 | tpr=0.9292 | fpr=0.0164 | 5817.6 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.09817 | acc=0.9822 | tpr=0.9360 | fpr=0.0170 | 7988.5 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.10118 | acc=0.9817 | tpr=0.9366 | fpr=0.0175 | 7486.8 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.10220 | acc=0.9815 | tpr=0.9388 | fpr=0.0177 | 7789.2 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.10326 | acc=0.9814 | tpr=0.9328 | fpr=0.0177 | 8452.8 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.10390 | acc=0.9815 | tpr=0.9302 | fpr=0.0176 | 8672.0 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.10387 | acc=0.9815 | tpr=0.9349 | fpr=0.0177 | 8057.3 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.10498 | acc=0.9813 | tpr=0.9305 | fpr=0.0177 | 7540.6 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.10689 | acc=0.9810 | tpr=0.9299 | fpr=0.0181 | 8028.8 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.10604 | acc=0.9811 | tpr=0.9313 | fpr=0.0180 | 6455.0 samples/s | 25.2 steps/s
[Step= 550] | Loss=0.10548 | acc=0.9812 | tpr=0.9292 | fpr=0.0179 | 13093.9 samples/s | 51.1 steps/s
Avg test loss: 0.10530, Avg test acc: 0.98118, Avg tpr: 0.92908, Avg fpr: 0.01788, total FA: 2482

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.11718 | acc=0.9798 | tpr=0.9248 | fpr=0.0192 | 5834.3 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.12040 | acc=0.9796 | tpr=0.9339 | fpr=0.0195 | 7396.0 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.12486 | acc=0.9791 | tpr=0.9395 | fpr=0.0202 | 7970.9 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.12649 | acc=0.9791 | tpr=0.9432 | fpr=0.0203 | 8008.0 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.12715 | acc=0.9790 | tpr=0.9406 | fpr=0.0203 | 8034.7 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.12896 | acc=0.9789 | tpr=0.9375 | fpr=0.0204 | 8107.4 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.12924 | acc=0.9788 | tpr=0.9411 | fpr=0.0205 | 7815.0 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.13041 | acc=0.9787 | tpr=0.9382 | fpr=0.0206 | 8382.9 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.13246 | acc=0.9784 | tpr=0.9382 | fpr=0.0209 | 8464.8 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.13156 | acc=0.9785 | tpr=0.9392 | fpr=0.0208 | 6350.1 samples/s | 24.8 steps/s
[Step= 550] | Loss=0.13067 | acc=0.9785 | tpr=0.9375 | fpr=0.0207 | 13907.4 samples/s | 54.3 steps/s
Avg test loss: 0.13041, Avg test acc: 0.97853, Avg tpr: 0.93740, Avg fpr: 0.02072, total FA: 2877

server round 40/50

clients selected: [0 2 5 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=28001 Epoch=136.5] | Loss=0.01736 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.875 | L2-Norm(final)=13.798 | 5895.4 samples/s | 92.1 steps/s
[Step=28050 Epoch=136.8] | Loss=0.01569 | Reg=0.00098 | acc=0.9531 | L2-Norm=9.876 | L2-Norm(final)=13.800 | 5085.3 samples/s | 79.5 steps/s
[Step=28100 Epoch=137.0] | Loss=0.01396 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.876 | L2-Norm(final)=13.803 | 5575.8 samples/s | 87.1 steps/s
[Step=28150 Epoch=137.3] | Loss=0.01452 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.876 | L2-Norm(final)=13.805 | 5625.3 samples/s | 87.9 steps/s
[Step=28200 Epoch=137.5] | Loss=0.01450 | Reg=0.00098 | acc=0.9531 | L2-Norm=9.876 | L2-Norm(final)=13.807 | 8765.1 samples/s | 137.0 steps/s
[Step=28250 Epoch=137.8] | Loss=0.01423 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.876 | L2-Norm(final)=13.809 | 2434.9 samples/s | 38.0 steps/s
[Step=28300 Epoch=138.0] | Loss=0.01407 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.876 | L2-Norm(final)=13.811 | 5727.0 samples/s | 89.5 steps/s
[Step=28350 Epoch=138.2] | Loss=0.01469 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.876 | L2-Norm(final)=13.813 | 5835.7 samples/s | 91.2 steps/s
[Step=28400 Epoch=138.5] | Loss=0.01451 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.876 | L2-Norm(final)=13.815 | 7317.1 samples/s | 114.3 steps/s
[Step=28450 Epoch=138.7] | Loss=0.01413 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.876 | L2-Norm(final)=13.817 | 2520.8 samples/s | 39.4 steps/s
[Step=28500 Epoch=139.0] | Loss=0.01415 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.876 | L2-Norm(final)=13.819 | 5537.2 samples/s | 86.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=28501 Epoch=139.0] | Loss=0.01281 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.876 | L2-Norm(final)=13.838 | 5759.2 samples/s | 90.0 steps/s
[Step=28550 Epoch=139.2] | Loss=0.01364 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.881 | L2-Norm(final)=13.840 | 4394.4 samples/s | 68.7 steps/s
[Step=28600 Epoch=139.5] | Loss=0.01190 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.888 | L2-Norm(final)=13.842 | 4879.5 samples/s | 76.2 steps/s
[Step=28650 Epoch=139.7] | Loss=0.01144 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.894 | L2-Norm(final)=13.844 | 4860.1 samples/s | 75.9 steps/s
[Step=28700 Epoch=139.9] | Loss=0.01136 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.899 | L2-Norm(final)=13.846 | 7008.2 samples/s | 109.5 steps/s
[Step=28750 Epoch=140.2] | Loss=0.01040 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.903 | L2-Norm(final)=13.848 | 2288.2 samples/s | 35.8 steps/s
[Step=28800 Epoch=140.4] | Loss=0.00946 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.907 | L2-Norm(final)=13.851 | 4806.1 samples/s | 75.1 steps/s
[Step=28850 Epoch=140.7] | Loss=0.00888 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.911 | L2-Norm(final)=13.854 | 4853.4 samples/s | 75.8 steps/s
[Step=28900 Epoch=140.9] | Loss=0.00828 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.915 | L2-Norm(final)=13.856 | 6332.0 samples/s | 98.9 steps/s
[Step=28950 Epoch=141.2] | Loss=0.00777 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.918 | L2-Norm(final)=13.859 | 2353.2 samples/s | 36.8 steps/s
[Step=29000 Epoch=141.4] | Loss=0.00726 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.922 | L2-Norm(final)=13.861 | 4822.7 samples/s | 75.4 steps/s
[Step=29050 Epoch=141.7] | Loss=0.00701 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.925 | L2-Norm(final)=13.864 | 4890.4 samples/s | 76.4 steps/s
[Step=29100 Epoch=141.9] | Loss=0.00680 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.928 | L2-Norm(final)=13.866 | 5830.1 samples/s | 91.1 steps/s
[Step=29150 Epoch=142.1] | Loss=0.00656 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.930 | L2-Norm(final)=13.868 | 2411.5 samples/s | 37.7 steps/s
[Step=29200 Epoch=142.4] | Loss=0.00638 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.933 | L2-Norm(final)=13.871 | 4863.1 samples/s | 76.0 steps/s
[Step=29250 Epoch=142.6] | Loss=0.00617 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.936 | L2-Norm(final)=13.873 | 4886.1 samples/s | 76.3 steps/s
[Step=29300 Epoch=142.9] | Loss=0.00597 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.938 | L2-Norm(final)=13.875 | 5379.4 samples/s | 84.1 steps/s
[Step=29350 Epoch=143.1] | Loss=0.00579 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.941 | L2-Norm(final)=13.877 | 2510.8 samples/s | 39.2 steps/s
[Step=29400 Epoch=143.4] | Loss=0.00564 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.943 | L2-Norm(final)=13.880 | 4886.0 samples/s | 76.3 steps/s
[Step=29450 Epoch=143.6] | Loss=0.00553 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.945 | L2-Norm(final)=13.882 | 4984.3 samples/s | 77.9 steps/s
[Step=29500 Epoch=143.8] | Loss=0.00542 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.947 | L2-Norm(final)=13.884 | 4924.6 samples/s | 76.9 steps/s
[Step=29550 Epoch=144.1] | Loss=0.00529 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.950 | L2-Norm(final)=13.886 | 2591.7 samples/s | 40.5 steps/s
[Step=29600 Epoch=144.3] | Loss=0.00513 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.952 | L2-Norm(final)=13.888 | 4851.0 samples/s | 75.8 steps/s
[Step=29650 Epoch=144.6] | Loss=0.00509 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.954 | L2-Norm(final)=13.890 | 4900.0 samples/s | 76.6 steps/s
[Step=29700 Epoch=144.8] | Loss=0.00496 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.956 | L2-Norm(final)=13.892 | 4835.0 samples/s | 75.5 steps/s
[Step=29750 Epoch=145.1] | Loss=0.00491 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.958 | L2-Norm(final)=13.894 | 2656.2 samples/s | 41.5 steps/s
[Step=29800 Epoch=145.3] | Loss=0.00482 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.960 | L2-Norm(final)=13.896 | 4874.7 samples/s | 76.2 steps/s
[Step=29850 Epoch=145.6] | Loss=0.00471 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.962 | L2-Norm(final)=13.898 | 4904.4 samples/s | 76.6 steps/s
[Step=29900 Epoch=145.8] | Loss=0.00468 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.964 | L2-Norm(final)=13.900 | 4871.5 samples/s | 76.1 steps/s
[Step=29950 Epoch=146.0] | Loss=0.00464 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.965 | L2-Norm(final)=13.902 | 2647.6 samples/s | 41.4 steps/s
[Step=30000 Epoch=146.3] | Loss=0.00456 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.967 | L2-Norm(final)=13.904 | 4833.0 samples/s | 75.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step30000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=44001 Epoch=214.4] | Loss=0.00243 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=14.899 | 5754.9 samples/s | 89.9 steps/s
[Step=44050 Epoch=214.6] | Loss=0.01427 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.875 | L2-Norm(final)=14.900 | 4943.9 samples/s | 77.2 steps/s
[Step=44100 Epoch=214.9] | Loss=0.01391 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.875 | L2-Norm(final)=14.901 | 5600.0 samples/s | 87.5 steps/s
[Step=44150 Epoch=215.1] | Loss=0.01510 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.875 | L2-Norm(final)=14.902 | 5700.7 samples/s | 89.1 steps/s
[Step=44200 Epoch=215.4] | Loss=0.01511 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=14.903 | 8451.5 samples/s | 132.1 steps/s
[Step=44250 Epoch=215.6] | Loss=0.01496 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=14.904 | 2411.4 samples/s | 37.7 steps/s
[Step=44300 Epoch=215.9] | Loss=0.01516 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=14.905 | 5766.6 samples/s | 90.1 steps/s
[Step=44350 Epoch=216.1] | Loss=0.01506 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=14.906 | 5513.8 samples/s | 86.2 steps/s
[Step=44400 Epoch=216.3] | Loss=0.01509 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.875 | L2-Norm(final)=14.907 | 7795.4 samples/s | 121.8 steps/s
[Step=44450 Epoch=216.6] | Loss=0.01539 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=14.907 | 2522.5 samples/s | 39.4 steps/s
[Step=44500 Epoch=216.8] | Loss=0.01556 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.875 | L2-Norm(final)=14.908 | 5496.2 samples/s | 85.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=216.8] | Loss=0.01664 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.875 | L2-Norm(final)=14.915 | 5981.2 samples/s | 93.5 steps/s
[Step=44550 Epoch=217.1] | Loss=0.01781 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.881 | L2-Norm(final)=14.915 | 4354.6 samples/s | 68.0 steps/s
[Step=44600 Epoch=217.3] | Loss=0.01414 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.886 | L2-Norm(final)=14.915 | 4745.3 samples/s | 74.1 steps/s
[Step=44650 Epoch=217.6] | Loss=0.01283 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.891 | L2-Norm(final)=14.917 | 4931.9 samples/s | 77.1 steps/s
[Step=44700 Epoch=217.8] | Loss=0.01197 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.896 | L2-Norm(final)=14.918 | 6875.1 samples/s | 107.4 steps/s
[Step=44750 Epoch=218.0] | Loss=0.01060 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=14.920 | 2257.5 samples/s | 35.3 steps/s
[Step=44800 Epoch=218.3] | Loss=0.00954 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=14.923 | 4868.4 samples/s | 76.1 steps/s
[Step=44850 Epoch=218.5] | Loss=0.00881 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.908 | L2-Norm(final)=14.925 | 4833.4 samples/s | 75.5 steps/s
[Step=44900 Epoch=218.8] | Loss=0.00832 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.911 | L2-Norm(final)=14.927 | 6339.5 samples/s | 99.1 steps/s
[Step=44950 Epoch=219.0] | Loss=0.00780 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.914 | L2-Norm(final)=14.929 | 2342.3 samples/s | 36.6 steps/s
[Step=45000 Epoch=219.3] | Loss=0.00737 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.917 | L2-Norm(final)=14.931 | 4828.5 samples/s | 75.4 steps/s
[Step=45050 Epoch=219.5] | Loss=0.00702 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.919 | L2-Norm(final)=14.934 | 4922.9 samples/s | 76.9 steps/s
[Step=45100 Epoch=219.7] | Loss=0.00674 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.922 | L2-Norm(final)=14.936 | 5713.4 samples/s | 89.3 steps/s
[Step=45150 Epoch=220.0] | Loss=0.00649 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.924 | L2-Norm(final)=14.938 | 2420.3 samples/s | 37.8 steps/s
[Step=45200 Epoch=220.2] | Loss=0.00626 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.927 | L2-Norm(final)=14.940 | 4843.0 samples/s | 75.7 steps/s
[Step=45250 Epoch=220.5] | Loss=0.00604 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.929 | L2-Norm(final)=14.942 | 4840.4 samples/s | 75.6 steps/s
[Step=45300 Epoch=220.7] | Loss=0.00588 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.931 | L2-Norm(final)=14.944 | 5403.5 samples/s | 84.4 steps/s
[Step=45350 Epoch=221.0] | Loss=0.00576 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.934 | L2-Norm(final)=14.946 | 2515.0 samples/s | 39.3 steps/s
[Step=45400 Epoch=221.2] | Loss=0.00557 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.936 | L2-Norm(final)=14.948 | 4857.8 samples/s | 75.9 steps/s
[Step=45450 Epoch=221.5] | Loss=0.00543 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.938 | L2-Norm(final)=14.950 | 4879.9 samples/s | 76.2 steps/s
[Step=45500 Epoch=221.7] | Loss=0.00533 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.940 | L2-Norm(final)=14.952 | 4984.3 samples/s | 77.9 steps/s
[Step=45550 Epoch=221.9] | Loss=0.00526 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.942 | L2-Norm(final)=14.954 | 2601.8 samples/s | 40.7 steps/s
[Step=45600 Epoch=222.2] | Loss=0.00519 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.944 | L2-Norm(final)=14.955 | 4902.0 samples/s | 76.6 steps/s
[Step=45650 Epoch=222.4] | Loss=0.00505 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.946 | L2-Norm(final)=14.957 | 4899.9 samples/s | 76.6 steps/s
[Step=45700 Epoch=222.7] | Loss=0.00493 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.948 | L2-Norm(final)=14.959 | 4838.3 samples/s | 75.6 steps/s
[Step=45750 Epoch=222.9] | Loss=0.00485 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.949 | L2-Norm(final)=14.961 | 2639.9 samples/s | 41.2 steps/s
[Step=45800 Epoch=223.2] | Loss=0.00475 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.951 | L2-Norm(final)=14.962 | 4807.7 samples/s | 75.1 steps/s
[Step=45850 Epoch=223.4] | Loss=0.00467 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.953 | L2-Norm(final)=14.964 | 4842.5 samples/s | 75.7 steps/s
[Step=45900 Epoch=223.6] | Loss=0.00460 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.955 | L2-Norm(final)=14.966 | 4897.5 samples/s | 76.5 steps/s
[Step=45950 Epoch=223.9] | Loss=0.00448 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.956 | L2-Norm(final)=14.968 | 2626.5 samples/s | 41.0 steps/s
[Step=46000 Epoch=224.1] | Loss=0.00441 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.958 | L2-Norm(final)=14.969 | 4857.4 samples/s | 75.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step46000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=38001 Epoch=360.1] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=15.843 | 5807.8 samples/s | 90.7 steps/s
[Step=38050 Epoch=360.6] | Loss=0.00031 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.847 | 4749.7 samples/s | 74.2 steps/s
[Step=38100 Epoch=361.0] | Loss=0.00033 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.851 | 8296.0 samples/s | 129.6 steps/s
[Step=38150 Epoch=361.5] | Loss=0.00031 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.854 | 2328.0 samples/s | 36.4 steps/s
[Step=38200 Epoch=362.0] | Loss=0.00031 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.857 | 7227.3 samples/s | 112.9 steps/s
[Step=38250 Epoch=362.5] | Loss=0.00030 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.861 | 1842.0 samples/s | 28.8 steps/s
[Step=38300 Epoch=362.9] | Loss=0.00030 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.864 | 6348.2 samples/s | 99.2 steps/s
[Step=38350 Epoch=363.4] | Loss=0.00031 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.867 | 2528.3 samples/s | 39.5 steps/s
[Step=38400 Epoch=363.9] | Loss=0.00030 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.871 | 5775.2 samples/s | 90.2 steps/s
[Step=38450 Epoch=364.3] | Loss=0.00029 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.874 | 2639.0 samples/s | 41.2 steps/s
[Step=38500 Epoch=364.8] | Loss=0.00029 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.878 | 5417.3 samples/s | 84.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=38501 Epoch=364.8] | Loss=0.00039 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.913 | 5923.2 samples/s | 92.6 steps/s
[Step=38550 Epoch=365.3] | Loss=0.00027 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=15.917 | 4101.1 samples/s | 64.1 steps/s
[Step=38600 Epoch=365.8] | Loss=0.00016 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.878 | L2-Norm(final)=15.920 | 6640.7 samples/s | 103.8 steps/s
[Step=38650 Epoch=366.2] | Loss=0.00011 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=15.921 | 2188.3 samples/s | 34.2 steps/s
[Step=38700 Epoch=366.7] | Loss=0.00008 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=15.922 | 6083.7 samples/s | 95.1 steps/s
[Step=38750 Epoch=367.2] | Loss=0.00007 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.872 | L2-Norm(final)=15.923 | 2262.3 samples/s | 35.3 steps/s
[Step=38800 Epoch=367.7] | Loss=0.00006 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.868 | L2-Norm(final)=15.924 | 5554.7 samples/s | 86.8 steps/s
[Step=38850 Epoch=368.1] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.865 | L2-Norm(final)=15.925 | 2360.4 samples/s | 36.9 steps/s
[Step=38900 Epoch=368.6] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.862 | L2-Norm(final)=15.926 | 5113.3 samples/s | 79.9 steps/s
[Step=38950 Epoch=369.1] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.858 | L2-Norm(final)=15.926 | 2463.8 samples/s | 38.5 steps/s
[Step=39000 Epoch=369.6] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.855 | L2-Norm(final)=15.927 | 4726.4 samples/s | 73.9 steps/s
[Step=39050 Epoch=370.0] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.851 | L2-Norm(final)=15.928 | 2528.2 samples/s | 39.5 steps/s
[Step=39100 Epoch=370.5] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=15.928 | 4652.7 samples/s | 72.7 steps/s
[Step=39150 Epoch=371.0] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.843 | L2-Norm(final)=15.929 | 2565.2 samples/s | 40.1 steps/s
[Step=39200 Epoch=371.5] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=15.930 | 4513.3 samples/s | 70.5 steps/s
[Step=39250 Epoch=371.9] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.836 | L2-Norm(final)=15.930 | 2578.4 samples/s | 40.3 steps/s
[Step=39300 Epoch=372.4] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.832 | L2-Norm(final)=15.931 | 4638.2 samples/s | 72.5 steps/s
[Step=39350 Epoch=372.9] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.828 | L2-Norm(final)=15.931 | 2648.1 samples/s | 41.4 steps/s
[Step=39400 Epoch=373.3] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=15.932 | 4395.8 samples/s | 68.7 steps/s
[Step=39450 Epoch=373.8] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.820 | L2-Norm(final)=15.932 | 6984.6 samples/s | 109.1 steps/s
[Step=39500 Epoch=374.3] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=15.933 | 2172.3 samples/s | 33.9 steps/s
[Step=39550 Epoch=374.8] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.811 | L2-Norm(final)=15.933 | 6216.0 samples/s | 97.1 steps/s
[Step=39600 Epoch=375.2] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.807 | L2-Norm(final)=15.934 | 2229.7 samples/s | 34.8 steps/s
[Step=39650 Epoch=375.7] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=15.934 | 5698.3 samples/s | 89.0 steps/s
[Step=39700 Epoch=376.2] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.798 | L2-Norm(final)=15.935 | 2337.4 samples/s | 36.5 steps/s
[Step=39750 Epoch=376.7] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.794 | L2-Norm(final)=15.935 | 5178.8 samples/s | 80.9 steps/s
[Step=39800 Epoch=377.1] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.789 | L2-Norm(final)=15.936 | 2451.1 samples/s | 38.3 steps/s
[Step=39850 Epoch=377.6] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.785 | L2-Norm(final)=15.936 | 4718.7 samples/s | 73.7 steps/s
[Step=39900 Epoch=378.1] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.780 | L2-Norm(final)=15.937 | 2485.8 samples/s | 38.8 steps/s
[Step=39950 Epoch=378.6] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.775 | L2-Norm(final)=15.937 | 4654.3 samples/s | 72.7 steps/s
[Step=40000 Epoch=379.0] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.771 | L2-Norm(final)=15.938 | 2560.8 samples/s | 40.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step40000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=40001 Epoch=382.0] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=16.878 | 5824.4 samples/s | 91.0 steps/s
[Step=40050 Epoch=382.5] | Loss=0.00030 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=16.875 | 4424.4 samples/s | 69.1 steps/s
[Step=40100 Epoch=382.9] | Loss=0.00022 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=16.872 | 8571.5 samples/s | 133.9 steps/s
[Step=40150 Epoch=383.4] | Loss=0.00022 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=16.871 | 2316.8 samples/s | 36.2 steps/s
[Step=40200 Epoch=383.9] | Loss=0.00021 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=16.870 | 7592.9 samples/s | 118.6 steps/s
[Step=40250 Epoch=384.4] | Loss=0.00021 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=16.869 | 2405.9 samples/s | 37.6 steps/s
[Step=40300 Epoch=384.8] | Loss=0.00021 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=16.869 | 6871.0 samples/s | 107.4 steps/s
[Step=40350 Epoch=385.3] | Loss=0.00020 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=16.869 | 2457.1 samples/s | 38.4 steps/s
[Step=40400 Epoch=385.8] | Loss=0.00020 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=16.869 | 6335.9 samples/s | 99.0 steps/s
[Step=40450 Epoch=386.3] | Loss=0.00019 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=16.869 | 2611.5 samples/s | 40.8 steps/s
[Step=40500 Epoch=386.8] | Loss=0.00020 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=16.869 | 5613.0 samples/s | 87.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=386.8] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=16.870 | 6004.3 samples/s | 93.8 steps/s
[Step=40550 Epoch=387.2] | Loss=0.00017 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=16.873 | 3979.2 samples/s | 62.2 steps/s
[Step=40600 Epoch=387.7] | Loss=0.00009 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.872 | L2-Norm(final)=16.874 | 6805.2 samples/s | 106.3 steps/s
[Step=40650 Epoch=388.2] | Loss=0.00006 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.868 | L2-Norm(final)=16.875 | 2187.7 samples/s | 34.2 steps/s
[Step=40700 Epoch=388.7] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.864 | L2-Norm(final)=16.876 | 6236.2 samples/s | 97.4 steps/s
[Step=40750 Epoch=389.1] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.860 | L2-Norm(final)=16.877 | 2254.3 samples/s | 35.2 steps/s
[Step=40800 Epoch=389.6] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.855 | L2-Norm(final)=16.877 | 5690.6 samples/s | 88.9 steps/s
[Step=40850 Epoch=390.1] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.850 | L2-Norm(final)=16.878 | 2301.4 samples/s | 36.0 steps/s
[Step=40900 Epoch=390.6] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=16.879 | 5378.7 samples/s | 84.0 steps/s
[Step=40950 Epoch=391.0] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=16.879 | 2379.0 samples/s | 37.2 steps/s
[Step=41000 Epoch=391.5] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.835 | L2-Norm(final)=16.880 | 5032.3 samples/s | 78.6 steps/s
[Step=41050 Epoch=392.0] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.830 | L2-Norm(final)=16.880 | 2452.9 samples/s | 38.3 steps/s
[Step=41100 Epoch=392.5] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.825 | L2-Norm(final)=16.881 | 4729.2 samples/s | 73.9 steps/s
[Step=41150 Epoch=393.0] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.820 | L2-Norm(final)=16.881 | 2542.9 samples/s | 39.7 steps/s
[Step=41200 Epoch=393.4] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=16.881 | 4588.0 samples/s | 71.7 steps/s
[Step=41250 Epoch=393.9] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.810 | L2-Norm(final)=16.882 | 2551.1 samples/s | 39.9 steps/s
[Step=41300 Epoch=394.4] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.805 | L2-Norm(final)=16.882 | 4639.5 samples/s | 72.5 steps/s
[Step=41350 Epoch=394.9] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.799 | L2-Norm(final)=16.883 | 2574.5 samples/s | 40.2 steps/s
[Step=41400 Epoch=395.3] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.794 | L2-Norm(final)=16.883 | 4676.1 samples/s | 73.1 steps/s
[Step=41450 Epoch=395.8] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.789 | L2-Norm(final)=16.884 | 2552.4 samples/s | 39.9 steps/s
[Step=41500 Epoch=396.3] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.783 | L2-Norm(final)=16.884 | 4598.5 samples/s | 71.9 steps/s
[Step=41550 Epoch=396.8] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.778 | L2-Norm(final)=16.884 | 7463.9 samples/s | 116.6 steps/s
[Step=41600 Epoch=397.3] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.772 | L2-Norm(final)=16.885 | 2130.2 samples/s | 33.3 steps/s
[Step=41650 Epoch=397.7] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=16.885 | 6666.4 samples/s | 104.2 steps/s
[Step=41700 Epoch=398.2] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.761 | L2-Norm(final)=16.885 | 2191.4 samples/s | 34.2 steps/s
[Step=41750 Epoch=398.7] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.755 | L2-Norm(final)=16.886 | 6043.0 samples/s | 94.4 steps/s
[Step=41800 Epoch=399.2] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.749 | L2-Norm(final)=16.886 | 2221.1 samples/s | 34.7 steps/s
[Step=41850 Epoch=399.6] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.744 | L2-Norm(final)=16.887 | 5803.8 samples/s | 90.7 steps/s
[Step=41900 Epoch=400.1] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=16.887 | 2304.2 samples/s | 36.0 steps/s
[Step=41950 Epoch=400.6] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.732 | L2-Norm(final)=16.887 | 5385.9 samples/s | 84.2 steps/s
[Step=42000 Epoch=401.1] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.726 | L2-Norm(final)=16.888 | 2404.3 samples/s | 37.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step42000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=30001 Epoch=285.9] | Loss=0.00031 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=15.051 | 5241.5 samples/s | 81.9 steps/s
[Step=30050 Epoch=286.4] | Loss=0.00053 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=15.051 | 4974.5 samples/s | 77.7 steps/s
[Step=30100 Epoch=286.9] | Loss=0.00054 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=15.054 | 7866.8 samples/s | 122.9 steps/s
[Step=30150 Epoch=287.4] | Loss=0.00053 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=15.055 | 2321.5 samples/s | 36.3 steps/s
[Step=30200 Epoch=287.8] | Loss=0.00051 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=15.058 | 7651.4 samples/s | 119.6 steps/s
[Step=30250 Epoch=288.3] | Loss=0.00049 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.060 | 2404.2 samples/s | 37.6 steps/s
[Step=30300 Epoch=288.8] | Loss=0.00052 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.062 | 6796.8 samples/s | 106.2 steps/s
[Step=30350 Epoch=289.3] | Loss=0.00050 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.064 | 2481.7 samples/s | 38.8 steps/s
[Step=30400 Epoch=289.7] | Loss=0.00051 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.067 | 6279.0 samples/s | 98.1 steps/s
[Step=30450 Epoch=290.2] | Loss=0.00051 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.070 | 2619.2 samples/s | 40.9 steps/s
[Step=30500 Epoch=290.7] | Loss=0.00049 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.072 | 5560.6 samples/s | 86.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=30501 Epoch=290.7] | Loss=0.00017 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.095 | 6160.4 samples/s | 96.3 steps/s
[Step=30550 Epoch=291.2] | Loss=0.00047 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.880 | L2-Norm(final)=15.098 | 3952.4 samples/s | 61.8 steps/s
[Step=30600 Epoch=291.6] | Loss=0.00027 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=15.100 | 6688.0 samples/s | 104.5 steps/s
[Step=30650 Epoch=292.1] | Loss=0.00019 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.883 | L2-Norm(final)=15.102 | 2191.7 samples/s | 34.2 steps/s
[Step=30700 Epoch=292.6] | Loss=0.00015 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=15.103 | 6084.5 samples/s | 95.1 steps/s
[Step=30750 Epoch=293.1] | Loss=0.00012 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.881 | L2-Norm(final)=15.104 | 2235.3 samples/s | 34.9 steps/s
[Step=30800 Epoch=293.6] | Loss=0.00010 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.880 | L2-Norm(final)=15.105 | 5725.1 samples/s | 89.5 steps/s
[Step=30850 Epoch=294.0] | Loss=0.00009 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.878 | L2-Norm(final)=15.106 | 2318.8 samples/s | 36.2 steps/s
[Step=30900 Epoch=294.5] | Loss=0.00008 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=15.107 | 5349.1 samples/s | 83.6 steps/s
[Step=30950 Epoch=295.0] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=15.108 | 2377.8 samples/s | 37.2 steps/s
[Step=31000 Epoch=295.5] | Loss=0.00006 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=15.108 | 5038.0 samples/s | 78.7 steps/s
[Step=31050 Epoch=295.9] | Loss=0.00006 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.872 | L2-Norm(final)=15.109 | 2466.9 samples/s | 38.5 steps/s
[Step=31100 Epoch=296.4] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.870 | L2-Norm(final)=15.110 | 4743.0 samples/s | 74.1 steps/s
[Step=31150 Epoch=296.9] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.868 | L2-Norm(final)=15.110 | 2545.6 samples/s | 39.8 steps/s
[Step=31200 Epoch=297.4] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.866 | L2-Norm(final)=15.111 | 4574.3 samples/s | 71.5 steps/s
[Step=31250 Epoch=297.8] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.864 | L2-Norm(final)=15.112 | 2557.7 samples/s | 40.0 steps/s
[Step=31300 Epoch=298.3] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.862 | L2-Norm(final)=15.112 | 4576.8 samples/s | 71.5 steps/s
[Step=31350 Epoch=298.8] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.860 | L2-Norm(final)=15.113 | 2563.5 samples/s | 40.1 steps/s
[Step=31400 Epoch=299.3] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.858 | L2-Norm(final)=15.114 | 4609.7 samples/s | 72.0 steps/s
[Step=31450 Epoch=299.7] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.856 | L2-Norm(final)=15.114 | 2634.5 samples/s | 41.2 steps/s
[Step=31500 Epoch=300.2] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.853 | L2-Norm(final)=15.115 | 4439.6 samples/s | 69.4 steps/s
[Step=31550 Epoch=300.7] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.851 | L2-Norm(final)=15.115 | 7388.8 samples/s | 115.4 steps/s
[Step=31600 Epoch=301.2] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.849 | L2-Norm(final)=15.116 | 2116.8 samples/s | 33.1 steps/s
[Step=31650 Epoch=301.7] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=15.117 | 6747.0 samples/s | 105.4 steps/s
[Step=31700 Epoch=302.1] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.844 | L2-Norm(final)=15.117 | 2203.8 samples/s | 34.4 steps/s
[Step=31750 Epoch=302.6] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=15.118 | 6039.2 samples/s | 94.4 steps/s
[Step=31800 Epoch=303.1] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.839 | L2-Norm(final)=15.118 | 2272.3 samples/s | 35.5 steps/s
[Step=31850 Epoch=303.6] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.837 | L2-Norm(final)=15.119 | 5595.1 samples/s | 87.4 steps/s
[Step=31900 Epoch=304.0] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.835 | L2-Norm(final)=15.119 | 2294.9 samples/s | 35.9 steps/s
[Step=31950 Epoch=304.5] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.832 | L2-Norm(final)=15.120 | 5397.2 samples/s | 84.3 steps/s
[Step=32000 Epoch=305.0] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.829 | L2-Norm(final)=15.120 | 2393.0 samples/s | 37.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07641 | acc=0.9626 | tpr=0.9686 | fpr=0.0505 | 5655.8 samples/s | 22.1 steps/s
Avg test loss: 0.08479, Avg test acc: 0.96109, Avg tpr: 0.96823, Avg fpr: 0.05461, total FA: 426

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08525 | acc=0.9644 | tpr=0.9832 | fpr=0.0766 | 5648.4 samples/s | 22.1 steps/s
Avg test loss: 0.09150, Avg test acc: 0.96330, Avg tpr: 0.98205, Avg fpr: 0.07794, total FA: 608

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08336 | acc=0.9638 | tpr=0.9799 | fpr=0.0711 | 5741.9 samples/s | 22.4 steps/s
Avg test loss: 0.08975, Avg test acc: 0.96342, Avg tpr: 0.97867, Avg fpr: 0.07012, total FA: 547

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08621 | acc=0.9631 | tpr=0.9767 | fpr=0.0664 | 5664.9 samples/s | 22.1 steps/s
Avg test loss: 0.09317, Avg test acc: 0.96334, Avg tpr: 0.97698, Avg fpr: 0.06666, total FA: 520

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08101 | acc=0.9650 | tpr=0.9743 | fpr=0.0553 | 5715.0 samples/s | 22.3 steps/s
Avg test loss: 0.09372, Avg test acc: 0.96330, Avg tpr: 0.97243, Avg fpr: 0.05679, total FA: 443

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.41764 | acc=0.2697 | tpr=0.0094 | fpr=0.1650 | 5700.9 samples/s | 22.3 steps/s
Avg test loss: 5.42768, Avg test acc: 0.26837, Avg tpr: 0.00944, Avg fpr: 0.16216, total FA: 1265

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.85680 | acc=0.2952 | tpr=0.0113 | fpr=0.0885 | 5699.3 samples/s | 22.3 steps/s
Avg test loss: 4.86905, Avg test acc: 0.29217, Avg tpr: 0.01078, Avg fpr: 0.08896, total FA: 694

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.27501 | acc=0.2394 | tpr=0.0148 | fpr=0.2730 | 5545.9 samples/s | 21.7 steps/s
Avg test loss: 5.28175, Avg test acc: 0.23924, Avg tpr: 0.01550, Avg fpr: 0.26868, total FA: 2096

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=6.27982 | acc=0.2412 | tpr=0.0103 | fpr=0.2572 | 5626.0 samples/s | 22.0 steps/s
Avg test loss: 6.29203, Avg test acc: 0.23948, Avg tpr: 0.01067, Avg fpr: 0.25727, total FA: 2007

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.54468 | acc=0.2359 | tpr=0.0073 | fpr=0.2678 | 5663.4 samples/s | 22.1 steps/s
Avg test loss: 5.55068, Avg test acc: 0.23548, Avg tpr: 0.00752, Avg fpr: 0.26317, total FA: 2053

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.94818 | acc=0.1614 | tpr=0.1947 | fpr=0.8392 | 5643.2 samples/s | 22.0 steps/s
[Step= 100] | Loss=4.90367 | acc=0.1627 | tpr=0.1812 | fpr=0.8376 | 7976.7 samples/s | 31.2 steps/s
[Step= 150] | Loss=4.91948 | acc=0.1617 | tpr=0.1700 | fpr=0.8384 | 7667.2 samples/s | 29.9 steps/s
[Step= 200] | Loss=4.91314 | acc=0.1614 | tpr=0.1683 | fpr=0.8388 | 8043.2 samples/s | 31.4 steps/s
[Step= 250] | Loss=4.91941 | acc=0.1617 | tpr=0.1668 | fpr=0.8384 | 8064.3 samples/s | 31.5 steps/s
[Step= 300] | Loss=4.92409 | acc=0.1613 | tpr=0.1709 | fpr=0.8389 | 8079.1 samples/s | 31.6 steps/s
[Step= 350] | Loss=4.92626 | acc=0.1613 | tpr=0.1628 | fpr=0.8387 | 7978.8 samples/s | 31.2 steps/s
[Step= 400] | Loss=4.92552 | acc=0.1618 | tpr=0.1674 | fpr=0.8383 | 8570.7 samples/s | 33.5 steps/s
[Step= 450] | Loss=4.92468 | acc=0.1622 | tpr=0.1655 | fpr=0.8379 | 7519.5 samples/s | 29.4 steps/s
[Step= 500] | Loss=4.92727 | acc=0.1619 | tpr=0.1696 | fpr=0.8383 | 8394.9 samples/s | 32.8 steps/s
[Step= 550] | Loss=4.92540 | acc=0.1620 | tpr=0.1663 | fpr=0.8381 | 10475.5 samples/s | 40.9 steps/s
Avg test loss: 4.92507, Avg test acc: 0.16184, Avg tpr: 0.16640, Avg fpr: 0.83824, total FA: 116388

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.14771 | acc=0.1267 | tpr=0.2788 | fpr=0.8760 | 5691.8 samples/s | 22.2 steps/s
[Step= 100] | Loss=5.10349 | acc=0.1291 | tpr=0.2495 | fpr=0.8731 | 7731.8 samples/s | 30.2 steps/s
[Step= 150] | Loss=5.12017 | acc=0.1266 | tpr=0.2406 | fpr=0.8755 | 7721.5 samples/s | 30.2 steps/s
[Step= 200] | Loss=5.11658 | acc=0.1267 | tpr=0.2350 | fpr=0.8753 | 8395.0 samples/s | 32.8 steps/s
[Step= 250] | Loss=5.12026 | acc=0.1265 | tpr=0.2306 | fpr=0.8754 | 8675.8 samples/s | 33.9 steps/s
[Step= 300] | Loss=5.12399 | acc=0.1257 | tpr=0.2320 | fpr=0.8762 | 8150.4 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.12656 | acc=0.1252 | tpr=0.2173 | fpr=0.8765 | 7610.5 samples/s | 29.7 steps/s
[Step= 400] | Loss=5.12531 | acc=0.1258 | tpr=0.2237 | fpr=0.8759 | 7925.6 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.12383 | acc=0.1261 | tpr=0.2210 | fpr=0.8756 | 8477.7 samples/s | 33.1 steps/s
[Step= 500] | Loss=5.12673 | acc=0.1262 | tpr=0.2251 | fpr=0.8756 | 8282.6 samples/s | 32.4 steps/s
[Step= 550] | Loss=5.12446 | acc=0.1265 | tpr=0.2240 | fpr=0.8753 | 9579.2 samples/s | 37.4 steps/s
Avg test loss: 5.12463, Avg test acc: 0.12644, Avg tpr: 0.22385, Avg fpr: 0.87533, total FA: 121538

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.91547 | acc=0.1271 | tpr=0.1372 | fpr=0.8731 | 5692.5 samples/s | 22.2 steps/s
[Step= 100] | Loss=5.86809 | acc=0.1286 | tpr=0.1322 | fpr=0.8715 | 7594.3 samples/s | 29.7 steps/s
[Step= 150] | Loss=5.87857 | acc=0.1275 | tpr=0.1369 | fpr=0.8727 | 8461.4 samples/s | 33.1 steps/s
[Step= 200] | Loss=5.87266 | acc=0.1278 | tpr=0.1322 | fpr=0.8723 | 7370.7 samples/s | 28.8 steps/s
[Step= 250] | Loss=5.87696 | acc=0.1279 | tpr=0.1310 | fpr=0.8722 | 8550.6 samples/s | 33.4 steps/s
[Step= 300] | Loss=5.88307 | acc=0.1274 | tpr=0.1331 | fpr=0.8727 | 8226.8 samples/s | 32.1 steps/s
[Step= 350] | Loss=5.88774 | acc=0.1268 | tpr=0.1271 | fpr=0.8732 | 8079.3 samples/s | 31.6 steps/s
[Step= 400] | Loss=5.88612 | acc=0.1271 | tpr=0.1335 | fpr=0.8730 | 8304.7 samples/s | 32.4 steps/s
[Step= 450] | Loss=5.88444 | acc=0.1273 | tpr=0.1334 | fpr=0.8728 | 7716.2 samples/s | 30.1 steps/s
[Step= 500] | Loss=5.88654 | acc=0.1272 | tpr=0.1357 | fpr=0.8730 | 7731.1 samples/s | 30.2 steps/s
[Step= 550] | Loss=5.88312 | acc=0.1276 | tpr=0.1361 | fpr=0.8726 | 11248.9 samples/s | 43.9 steps/s
Avg test loss: 5.88291, Avg test acc: 0.12750, Avg tpr: 0.13629, Avg fpr: 0.87266, total FA: 121167

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.43792 | acc=0.1407 | tpr=0.2035 | fpr=0.8604 | 5455.0 samples/s | 21.3 steps/s
[Step= 100] | Loss=5.39513 | acc=0.1412 | tpr=0.2047 | fpr=0.8600 | 7984.0 samples/s | 31.2 steps/s
[Step= 150] | Loss=5.41106 | acc=0.1406 | tpr=0.2017 | fpr=0.8606 | 8215.8 samples/s | 32.1 steps/s
[Step= 200] | Loss=5.40167 | acc=0.1409 | tpr=0.1989 | fpr=0.8602 | 8155.3 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.40750 | acc=0.1410 | tpr=0.2017 | fpr=0.8601 | 8084.0 samples/s | 31.6 steps/s
[Step= 300] | Loss=5.41343 | acc=0.1402 | tpr=0.2022 | fpr=0.8609 | 8259.8 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.41420 | acc=0.1398 | tpr=0.1910 | fpr=0.8611 | 7900.6 samples/s | 30.9 steps/s
[Step= 400] | Loss=5.41263 | acc=0.1403 | tpr=0.1997 | fpr=0.8608 | 8306.1 samples/s | 32.4 steps/s
[Step= 450] | Loss=5.41134 | acc=0.1405 | tpr=0.1967 | fpr=0.8605 | 7969.5 samples/s | 31.1 steps/s
[Step= 500] | Loss=5.41572 | acc=0.1402 | tpr=0.1978 | fpr=0.8608 | 7653.4 samples/s | 29.9 steps/s
[Step= 550] | Loss=5.41342 | acc=0.1403 | tpr=0.1990 | fpr=0.8607 | 10654.4 samples/s | 41.6 steps/s
Avg test loss: 5.41297, Avg test acc: 0.14023, Avg tpr: 0.19889, Avg fpr: 0.86083, total FA: 119525

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.89748 | acc=0.1415 | tpr=0.1239 | fpr=0.8582 | 5714.4 samples/s | 22.3 steps/s
[Step= 100] | Loss=5.84193 | acc=0.1431 | tpr=0.1173 | fpr=0.8564 | 8030.5 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.85797 | acc=0.1425 | tpr=0.1153 | fpr=0.8570 | 8153.4 samples/s | 31.8 steps/s
[Step= 200] | Loss=5.85402 | acc=0.1426 | tpr=0.1115 | fpr=0.8568 | 7993.4 samples/s | 31.2 steps/s
[Step= 250] | Loss=5.86230 | acc=0.1427 | tpr=0.1127 | fpr=0.8568 | 7929.9 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.86522 | acc=0.1423 | tpr=0.1135 | fpr=0.8572 | 7630.4 samples/s | 29.8 steps/s
[Step= 350] | Loss=5.86859 | acc=0.1418 | tpr=0.1096 | fpr=0.8576 | 7438.1 samples/s | 29.1 steps/s
[Step= 400] | Loss=5.86717 | acc=0.1422 | tpr=0.1138 | fpr=0.8573 | 8192.6 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.86630 | acc=0.1425 | tpr=0.1154 | fpr=0.8570 | 8156.2 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.86978 | acc=0.1422 | tpr=0.1154 | fpr=0.8573 | 8444.5 samples/s | 33.0 steps/s
[Step= 550] | Loss=5.86616 | acc=0.1423 | tpr=0.1146 | fpr=0.8572 | 11471.0 samples/s | 44.8 steps/s
Avg test loss: 5.86593, Avg test acc: 0.14216, Avg tpr: 0.11529, Avg fpr: 0.85735, total FA: 119041

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11148 | acc=0.9806 | tpr=0.9292 | fpr=0.0185 | 5801.1 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.11220 | acc=0.9809 | tpr=0.9467 | fpr=0.0184 | 7384.1 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.11621 | acc=0.9802 | tpr=0.9524 | fpr=0.0193 | 8772.7 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.11847 | acc=0.9802 | tpr=0.9563 | fpr=0.0193 | 8299.9 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.11913 | acc=0.9801 | tpr=0.9528 | fpr=0.0194 | 7710.0 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.12079 | acc=0.9800 | tpr=0.9520 | fpr=0.0195 | 8142.3 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.12118 | acc=0.9799 | tpr=0.9530 | fpr=0.0196 | 7894.6 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.12235 | acc=0.9797 | tpr=0.9486 | fpr=0.0198 | 8545.2 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.12477 | acc=0.9793 | tpr=0.9464 | fpr=0.0201 | 8277.2 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.12383 | acc=0.9794 | tpr=0.9480 | fpr=0.0200 | 7626.2 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.12288 | acc=0.9795 | tpr=0.9479 | fpr=0.0199 | 9999.3 samples/s | 39.1 steps/s
Avg test loss: 0.12265, Avg test acc: 0.97956, Avg tpr: 0.94770, Avg fpr: 0.01986, total FA: 2757

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09914 | acc=0.9812 | tpr=0.9115 | fpr=0.0175 | 5864.4 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.10044 | acc=0.9809 | tpr=0.9275 | fpr=0.0181 | 7599.8 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.10317 | acc=0.9804 | tpr=0.9294 | fpr=0.0187 | 8229.1 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.10437 | acc=0.9803 | tpr=0.9301 | fpr=0.0188 | 7468.8 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.10514 | acc=0.9803 | tpr=0.9275 | fpr=0.0187 | 9043.1 samples/s | 35.3 steps/s
[Step= 300] | Loss=0.10632 | acc=0.9802 | tpr=0.9287 | fpr=0.0189 | 7813.8 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.10638 | acc=0.9802 | tpr=0.9286 | fpr=0.0189 | 8631.4 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.10757 | acc=0.9800 | tpr=0.9240 | fpr=0.0190 | 7190.6 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.10939 | acc=0.9797 | tpr=0.9231 | fpr=0.0192 | 7993.3 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.10857 | acc=0.9798 | tpr=0.9251 | fpr=0.0192 | 8350.8 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.10758 | acc=0.9799 | tpr=0.9240 | fpr=0.0191 | 10366.8 samples/s | 40.5 steps/s
Avg test loss: 0.10738, Avg test acc: 0.97994, Avg tpr: 0.92353, Avg fpr: 0.01904, total FA: 2643

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12239 | acc=0.9784 | tpr=0.9425 | fpr=0.0210 | 5684.7 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.12389 | acc=0.9783 | tpr=0.9595 | fpr=0.0214 | 7361.3 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.12873 | acc=0.9774 | tpr=0.9597 | fpr=0.0223 | 8394.0 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.13037 | acc=0.9774 | tpr=0.9617 | fpr=0.0223 | 8191.1 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.13122 | acc=0.9773 | tpr=0.9590 | fpr=0.0224 | 8231.1 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.13225 | acc=0.9774 | tpr=0.9600 | fpr=0.0223 | 8052.0 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.13224 | acc=0.9773 | tpr=0.9612 | fpr=0.0224 | 8450.9 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.13325 | acc=0.9771 | tpr=0.9579 | fpr=0.0225 | 7691.1 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.13556 | acc=0.9768 | tpr=0.9557 | fpr=0.0228 | 8122.0 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.13468 | acc=0.9769 | tpr=0.9573 | fpr=0.0227 | 7326.1 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.13355 | acc=0.9771 | tpr=0.9570 | fpr=0.0225 | 12008.8 samples/s | 46.9 steps/s
Avg test loss: 0.13327, Avg test acc: 0.97712, Avg tpr: 0.95681, Avg fpr: 0.02251, total FA: 3126

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09576 | acc=0.9827 | tpr=0.9292 | fpr=0.0164 | 5796.0 samples/s | 22.6 steps/s
[Step= 100] | Loss=0.09817 | acc=0.9822 | tpr=0.9360 | fpr=0.0170 | 7520.4 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.10118 | acc=0.9817 | tpr=0.9366 | fpr=0.0175 | 8602.2 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.10220 | acc=0.9815 | tpr=0.9388 | fpr=0.0177 | 7836.3 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.10326 | acc=0.9814 | tpr=0.9328 | fpr=0.0177 | 7745.0 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.10390 | acc=0.9815 | tpr=0.9302 | fpr=0.0176 | 8895.9 samples/s | 34.7 steps/s
[Step= 350] | Loss=0.10387 | acc=0.9815 | tpr=0.9349 | fpr=0.0177 | 7880.3 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.10498 | acc=0.9813 | tpr=0.9305 | fpr=0.0177 | 8448.8 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.10689 | acc=0.9810 | tpr=0.9299 | fpr=0.0181 | 7830.7 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.10604 | acc=0.9811 | tpr=0.9313 | fpr=0.0180 | 8061.6 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.10548 | acc=0.9812 | tpr=0.9292 | fpr=0.0179 | 9964.4 samples/s | 38.9 steps/s
Avg test loss: 0.10530, Avg test acc: 0.98118, Avg tpr: 0.92908, Avg fpr: 0.01788, total FA: 2482

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10404 | acc=0.9810 | tpr=0.9336 | fpr=0.0181 | 5539.0 samples/s | 21.6 steps/s
[Step= 100] | Loss=0.10596 | acc=0.9809 | tpr=0.9424 | fpr=0.0184 | 7754.0 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.10930 | acc=0.9804 | tpr=0.9452 | fpr=0.0190 | 8124.1 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.11049 | acc=0.9804 | tpr=0.9497 | fpr=0.0191 | 8052.7 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.11163 | acc=0.9803 | tpr=0.9467 | fpr=0.0191 | 7942.1 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.11264 | acc=0.9803 | tpr=0.9476 | fpr=0.0191 | 8057.8 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.11258 | acc=0.9803 | tpr=0.9505 | fpr=0.0191 | 8282.7 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.11335 | acc=0.9803 | tpr=0.9464 | fpr=0.0191 | 8126.0 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.11541 | acc=0.9799 | tpr=0.9455 | fpr=0.0195 | 8026.0 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.11454 | acc=0.9801 | tpr=0.9476 | fpr=0.0194 | 8245.5 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.11368 | acc=0.9802 | tpr=0.9459 | fpr=0.0192 | 11572.7 samples/s | 45.2 steps/s
Avg test loss: 0.11349, Avg test acc: 0.98020, Avg tpr: 0.94572, Avg fpr: 0.01917, total FA: 2662

server round 41/50

clients selected: [0 2 3 5 6]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=30001 Epoch=146.3] | Loss=0.00766 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.847 | L2-Norm(final)=13.960 | 5400.2 samples/s | 84.4 steps/s
[Step=30050 Epoch=146.5] | Loss=0.01347 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.848 | L2-Norm(final)=13.961 | 5386.5 samples/s | 84.2 steps/s
[Step=30100 Epoch=146.8] | Loss=0.01422 | Reg=0.00097 | acc=0.9531 | L2-Norm=9.848 | L2-Norm(final)=13.964 | 5675.4 samples/s | 88.7 steps/s
[Step=30150 Epoch=147.0] | Loss=0.01488 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.848 | L2-Norm(final)=13.966 | 5593.5 samples/s | 87.4 steps/s
[Step=30200 Epoch=147.3] | Loss=0.01467 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.848 | L2-Norm(final)=13.967 | 8686.7 samples/s | 135.7 steps/s
[Step=30250 Epoch=147.5] | Loss=0.01471 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.848 | L2-Norm(final)=13.968 | 2456.8 samples/s | 38.4 steps/s
[Step=30300 Epoch=147.7] | Loss=0.01421 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.848 | L2-Norm(final)=13.970 | 5596.5 samples/s | 87.4 steps/s
[Step=30350 Epoch=148.0] | Loss=0.01478 | Reg=0.00097 | acc=0.9531 | L2-Norm=9.848 | L2-Norm(final)=13.971 | 5880.3 samples/s | 91.9 steps/s
[Step=30400 Epoch=148.2] | Loss=0.01465 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.848 | L2-Norm(final)=13.972 | 7426.7 samples/s | 116.0 steps/s
[Step=30450 Epoch=148.5] | Loss=0.01457 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.848 | L2-Norm(final)=13.974 | 2526.6 samples/s | 39.5 steps/s
[Step=30500 Epoch=148.7] | Loss=0.01470 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.848 | L2-Norm(final)=13.975 | 5815.8 samples/s | 90.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=30501 Epoch=148.7] | Loss=0.01066 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.848 | L2-Norm(final)=13.989 | 5787.5 samples/s | 90.4 steps/s
[Step=30550 Epoch=149.0] | Loss=0.01526 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.855 | L2-Norm(final)=13.990 | 4428.0 samples/s | 69.2 steps/s
[Step=30600 Epoch=149.2] | Loss=0.01394 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.862 | L2-Norm(final)=13.991 | 4904.6 samples/s | 76.6 steps/s
[Step=30650 Epoch=149.5] | Loss=0.01308 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.867 | L2-Norm(final)=13.992 | 4853.4 samples/s | 75.8 steps/s
[Step=30700 Epoch=149.7] | Loss=0.01215 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.871 | L2-Norm(final)=13.994 | 6878.5 samples/s | 107.5 steps/s
[Step=30750 Epoch=149.9] | Loss=0.01096 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.875 | L2-Norm(final)=13.996 | 2282.0 samples/s | 35.7 steps/s
[Step=30800 Epoch=150.2] | Loss=0.00999 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.879 | L2-Norm(final)=13.998 | 4840.5 samples/s | 75.6 steps/s
[Step=30850 Epoch=150.4] | Loss=0.00928 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.883 | L2-Norm(final)=14.001 | 4857.2 samples/s | 75.9 steps/s
[Step=30900 Epoch=150.7] | Loss=0.00881 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=14.003 | 6364.6 samples/s | 99.4 steps/s
[Step=30950 Epoch=150.9] | Loss=0.00828 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=14.005 | 2347.8 samples/s | 36.7 steps/s
[Step=31000 Epoch=151.2] | Loss=0.00790 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.893 | L2-Norm(final)=14.008 | 4814.2 samples/s | 75.2 steps/s
[Step=31050 Epoch=151.4] | Loss=0.00756 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.895 | L2-Norm(final)=14.010 | 4831.5 samples/s | 75.5 steps/s
[Step=31100 Epoch=151.6] | Loss=0.00726 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=14.012 | 5836.5 samples/s | 91.2 steps/s
[Step=31150 Epoch=151.9] | Loss=0.00700 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.014 | 2420.4 samples/s | 37.8 steps/s
[Step=31200 Epoch=152.1] | Loss=0.00672 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.903 | L2-Norm(final)=14.016 | 4886.0 samples/s | 76.3 steps/s
[Step=31250 Epoch=152.4] | Loss=0.00655 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=14.018 | 4901.7 samples/s | 76.6 steps/s
[Step=31300 Epoch=152.6] | Loss=0.00637 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.908 | L2-Norm(final)=14.020 | 5285.2 samples/s | 82.6 steps/s
[Step=31350 Epoch=152.9] | Loss=0.00612 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.911 | L2-Norm(final)=14.023 | 2539.1 samples/s | 39.7 steps/s
[Step=31400 Epoch=153.1] | Loss=0.00597 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.913 | L2-Norm(final)=14.025 | 4850.6 samples/s | 75.8 steps/s
[Step=31450 Epoch=153.4] | Loss=0.00587 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.915 | L2-Norm(final)=14.027 | 4805.4 samples/s | 75.1 steps/s
[Step=31500 Epoch=153.6] | Loss=0.00571 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.917 | L2-Norm(final)=14.029 | 4985.0 samples/s | 77.9 steps/s
[Step=31550 Epoch=153.8] | Loss=0.00555 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.919 | L2-Norm(final)=14.031 | 2624.0 samples/s | 41.0 steps/s
[Step=31600 Epoch=154.1] | Loss=0.00541 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.921 | L2-Norm(final)=14.032 | 4870.9 samples/s | 76.1 steps/s
[Step=31650 Epoch=154.3] | Loss=0.00532 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.923 | L2-Norm(final)=14.034 | 4902.0 samples/s | 76.6 steps/s
[Step=31700 Epoch=154.6] | Loss=0.00528 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.925 | L2-Norm(final)=14.036 | 4749.4 samples/s | 74.2 steps/s
[Step=31750 Epoch=154.8] | Loss=0.00516 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.927 | L2-Norm(final)=14.038 | 2624.2 samples/s | 41.0 steps/s
[Step=31800 Epoch=155.1] | Loss=0.00502 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.929 | L2-Norm(final)=14.040 | 4825.9 samples/s | 75.4 steps/s
[Step=31850 Epoch=155.3] | Loss=0.00494 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.931 | L2-Norm(final)=14.042 | 4885.8 samples/s | 76.3 steps/s
[Step=31900 Epoch=155.6] | Loss=0.00489 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.932 | L2-Norm(final)=14.044 | 4847.2 samples/s | 75.7 steps/s
[Step=31950 Epoch=155.8] | Loss=0.00484 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.934 | L2-Norm(final)=14.045 | 2645.3 samples/s | 41.3 steps/s
[Step=32000 Epoch=156.0] | Loss=0.00478 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.936 | L2-Norm(final)=14.047 | 4865.6 samples/s | 76.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step32000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=46001 Epoch=224.1] | Loss=0.00470 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=15.021 | 5638.1 samples/s | 88.1 steps/s
[Step=46050 Epoch=224.4] | Loss=0.01958 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.847 | L2-Norm(final)=15.021 | 4984.8 samples/s | 77.9 steps/s
[Step=46100 Epoch=224.6] | Loss=0.01676 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=15.020 | 5713.3 samples/s | 89.3 steps/s
[Step=46150 Epoch=224.9] | Loss=0.01539 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=15.020 | 5591.1 samples/s | 87.4 steps/s
[Step=46200 Epoch=225.1] | Loss=0.01524 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=15.021 | 8708.0 samples/s | 136.1 steps/s
[Step=46250 Epoch=225.4] | Loss=0.01536 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=15.022 | 2442.7 samples/s | 38.2 steps/s
[Step=46300 Epoch=225.6] | Loss=0.01547 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.847 | L2-Norm(final)=15.022 | 5725.5 samples/s | 89.5 steps/s
[Step=46350 Epoch=225.8] | Loss=0.01522 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.847 | L2-Norm(final)=15.023 | 5457.1 samples/s | 85.3 steps/s
[Step=46400 Epoch=226.1] | Loss=0.01554 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=15.023 | 7769.8 samples/s | 121.4 steps/s
[Step=46450 Epoch=226.3] | Loss=0.01546 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.847 | L2-Norm(final)=15.024 | 2561.9 samples/s | 40.0 steps/s
[Step=46500 Epoch=226.6] | Loss=0.01527 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=15.024 | 5604.3 samples/s | 87.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=226.6] | Loss=0.04597 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.847 | L2-Norm(final)=15.029 | 6064.7 samples/s | 94.8 steps/s
[Step=46550 Epoch=226.8] | Loss=0.01461 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.852 | L2-Norm(final)=15.030 | 4258.7 samples/s | 66.5 steps/s
[Step=46600 Epoch=227.1] | Loss=0.01402 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.858 | L2-Norm(final)=15.030 | 4987.4 samples/s | 77.9 steps/s
[Step=46650 Epoch=227.3] | Loss=0.01348 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.863 | L2-Norm(final)=15.031 | 4779.4 samples/s | 74.7 steps/s
[Step=46700 Epoch=227.5] | Loss=0.01212 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.867 | L2-Norm(final)=15.033 | 6898.1 samples/s | 107.8 steps/s
[Step=46750 Epoch=227.8] | Loss=0.01082 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.871 | L2-Norm(final)=15.035 | 2247.1 samples/s | 35.1 steps/s
[Step=46800 Epoch=228.0] | Loss=0.01000 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.875 | L2-Norm(final)=15.037 | 4840.8 samples/s | 75.6 steps/s
[Step=46850 Epoch=228.3] | Loss=0.00925 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.878 | L2-Norm(final)=15.039 | 4894.0 samples/s | 76.5 steps/s
[Step=46900 Epoch=228.5] | Loss=0.00859 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=15.041 | 6273.4 samples/s | 98.0 steps/s
[Step=46950 Epoch=228.8] | Loss=0.00799 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=15.043 | 2336.8 samples/s | 36.5 steps/s
[Step=47000 Epoch=229.0] | Loss=0.00750 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.887 | L2-Norm(final)=15.045 | 4902.7 samples/s | 76.6 steps/s
[Step=47050 Epoch=229.3] | Loss=0.00717 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=15.047 | 4834.0 samples/s | 75.5 steps/s
[Step=47100 Epoch=229.5] | Loss=0.00697 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.893 | L2-Norm(final)=15.049 | 5810.4 samples/s | 90.8 steps/s
[Step=47150 Epoch=229.7] | Loss=0.00660 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.895 | L2-Norm(final)=15.051 | 2414.2 samples/s | 37.7 steps/s
[Step=47200 Epoch=230.0] | Loss=0.00632 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=15.053 | 4879.4 samples/s | 76.2 steps/s
[Step=47250 Epoch=230.2] | Loss=0.00613 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=15.055 | 4885.8 samples/s | 76.3 steps/s
[Step=47300 Epoch=230.5] | Loss=0.00597 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.902 | L2-Norm(final)=15.057 | 5309.5 samples/s | 83.0 steps/s
[Step=47350 Epoch=230.7] | Loss=0.00579 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=15.059 | 2488.9 samples/s | 38.9 steps/s
[Step=47400 Epoch=231.0] | Loss=0.00560 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=15.061 | 4876.5 samples/s | 76.2 steps/s
[Step=47450 Epoch=231.2] | Loss=0.00542 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.908 | L2-Norm(final)=15.063 | 4844.4 samples/s | 75.7 steps/s
[Step=47500 Epoch=231.4] | Loss=0.00528 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.910 | L2-Norm(final)=15.065 | 4990.5 samples/s | 78.0 steps/s
[Step=47550 Epoch=231.7] | Loss=0.00519 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.912 | L2-Norm(final)=15.067 | 2616.7 samples/s | 40.9 steps/s
[Step=47600 Epoch=231.9] | Loss=0.00505 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.914 | L2-Norm(final)=15.069 | 4842.3 samples/s | 75.7 steps/s
[Step=47650 Epoch=232.2] | Loss=0.00496 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.916 | L2-Norm(final)=15.070 | 4897.9 samples/s | 76.5 steps/s
[Step=47700 Epoch=232.4] | Loss=0.00486 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.918 | L2-Norm(final)=15.072 | 4837.4 samples/s | 75.6 steps/s
[Step=47750 Epoch=232.7] | Loss=0.00481 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.920 | L2-Norm(final)=15.074 | 2672.5 samples/s | 41.8 steps/s
[Step=47800 Epoch=232.9] | Loss=0.00471 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.921 | L2-Norm(final)=15.076 | 4759.4 samples/s | 74.4 steps/s
[Step=47850 Epoch=233.1] | Loss=0.00460 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.923 | L2-Norm(final)=15.077 | 4867.7 samples/s | 76.1 steps/s
[Step=47900 Epoch=233.4] | Loss=0.00457 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.925 | L2-Norm(final)=15.079 | 4863.6 samples/s | 76.0 steps/s
[Step=47950 Epoch=233.6] | Loss=0.00450 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.926 | L2-Norm(final)=15.081 | 2638.7 samples/s | 41.2 steps/s
[Step=48000 Epoch=233.9] | Loss=0.00444 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.928 | L2-Norm(final)=15.082 | 4843.0 samples/s | 75.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step48000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=44001 Epoch=214.6] | Loss=0.01417 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.847 | L2-Norm(final)=15.261 | 5765.9 samples/s | 90.1 steps/s
[Step=44050 Epoch=214.8] | Loss=0.01481 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.847 | L2-Norm(final)=15.261 | 4918.3 samples/s | 76.8 steps/s
[Step=44100 Epoch=215.1] | Loss=0.01506 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=15.261 | 5511.3 samples/s | 86.1 steps/s
[Step=44150 Epoch=215.3] | Loss=0.01468 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.847 | L2-Norm(final)=15.262 | 5637.6 samples/s | 88.1 steps/s
[Step=44200 Epoch=215.5] | Loss=0.01441 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=15.263 | 8799.9 samples/s | 137.5 steps/s
[Step=44250 Epoch=215.8] | Loss=0.01404 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=15.264 | 2452.1 samples/s | 38.3 steps/s
[Step=44300 Epoch=216.0] | Loss=0.01390 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.847 | L2-Norm(final)=15.265 | 5782.7 samples/s | 90.4 steps/s
[Step=44350 Epoch=216.3] | Loss=0.01395 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.847 | L2-Norm(final)=15.266 | 5427.1 samples/s | 84.8 steps/s
[Step=44400 Epoch=216.5] | Loss=0.01420 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.847 | L2-Norm(final)=15.267 | 7818.8 samples/s | 122.2 steps/s
[Step=44450 Epoch=216.8] | Loss=0.01430 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.847 | L2-Norm(final)=15.267 | 2504.7 samples/s | 39.1 steps/s
[Step=44500 Epoch=217.0] | Loss=0.01425 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=15.268 | 5722.2 samples/s | 89.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=217.0] | Loss=0.03391 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.847 | L2-Norm(final)=15.277 | 6219.7 samples/s | 97.2 steps/s
[Step=44550 Epoch=217.3] | Loss=0.01451 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.853 | L2-Norm(final)=15.277 | 4198.8 samples/s | 65.6 steps/s
[Step=44600 Epoch=217.5] | Loss=0.01272 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.858 | L2-Norm(final)=15.277 | 4861.7 samples/s | 76.0 steps/s
[Step=44650 Epoch=217.7] | Loss=0.01209 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.862 | L2-Norm(final)=15.278 | 4874.1 samples/s | 76.2 steps/s
[Step=44700 Epoch=218.0] | Loss=0.01082 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.867 | L2-Norm(final)=15.279 | 6954.4 samples/s | 108.7 steps/s
[Step=44750 Epoch=218.2] | Loss=0.00968 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.870 | L2-Norm(final)=15.280 | 2268.4 samples/s | 35.4 steps/s
[Step=44800 Epoch=218.5] | Loss=0.00879 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.282 | 5011.6 samples/s | 78.3 steps/s
[Step=44850 Epoch=218.7] | Loss=0.00804 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.876 | L2-Norm(final)=15.283 | 4814.0 samples/s | 75.2 steps/s
[Step=44900 Epoch=219.0] | Loss=0.00754 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.879 | L2-Norm(final)=15.285 | 6374.9 samples/s | 99.6 steps/s
[Step=44950 Epoch=219.2] | Loss=0.00703 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.882 | L2-Norm(final)=15.287 | 2340.8 samples/s | 36.6 steps/s
[Step=45000 Epoch=219.4] | Loss=0.00670 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.884 | L2-Norm(final)=15.288 | 4870.3 samples/s | 76.1 steps/s
[Step=45050 Epoch=219.7] | Loss=0.00639 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=15.290 | 4912.9 samples/s | 76.8 steps/s
[Step=45100 Epoch=219.9] | Loss=0.00609 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=15.292 | 5745.6 samples/s | 89.8 steps/s
[Step=45150 Epoch=220.2] | Loss=0.00580 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.891 | L2-Norm(final)=15.293 | 2415.5 samples/s | 37.7 steps/s
[Step=45200 Epoch=220.4] | Loss=0.00556 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.893 | L2-Norm(final)=15.295 | 4897.2 samples/s | 76.5 steps/s
[Step=45250 Epoch=220.7] | Loss=0.00541 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.895 | L2-Norm(final)=15.296 | 4906.4 samples/s | 76.7 steps/s
[Step=45300 Epoch=220.9] | Loss=0.00527 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.897 | L2-Norm(final)=15.298 | 5309.6 samples/s | 83.0 steps/s
[Step=45350 Epoch=221.2] | Loss=0.00514 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=15.299 | 2517.3 samples/s | 39.3 steps/s
[Step=45400 Epoch=221.4] | Loss=0.00500 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=15.301 | 4804.9 samples/s | 75.1 steps/s
[Step=45450 Epoch=221.6] | Loss=0.00488 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.902 | L2-Norm(final)=15.302 | 4865.6 samples/s | 76.0 steps/s
[Step=45500 Epoch=221.9] | Loss=0.00477 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.904 | L2-Norm(final)=15.304 | 4993.6 samples/s | 78.0 steps/s
[Step=45550 Epoch=222.1] | Loss=0.00469 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=15.305 | 2640.1 samples/s | 41.3 steps/s
[Step=45600 Epoch=222.4] | Loss=0.00455 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.907 | L2-Norm(final)=15.306 | 4744.1 samples/s | 74.1 steps/s
[Step=45650 Epoch=222.6] | Loss=0.00443 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.909 | L2-Norm(final)=15.308 | 4908.6 samples/s | 76.7 steps/s
[Step=45700 Epoch=222.9] | Loss=0.00436 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.910 | L2-Norm(final)=15.309 | 4804.7 samples/s | 75.1 steps/s
[Step=45750 Epoch=223.1] | Loss=0.00430 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.912 | L2-Norm(final)=15.311 | 2649.7 samples/s | 41.4 steps/s
[Step=45800 Epoch=223.3] | Loss=0.00421 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.914 | L2-Norm(final)=15.312 | 4878.9 samples/s | 76.2 steps/s
[Step=45850 Epoch=223.6] | Loss=0.00417 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.915 | L2-Norm(final)=15.313 | 4797.8 samples/s | 75.0 steps/s
[Step=45900 Epoch=223.8] | Loss=0.00409 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.917 | L2-Norm(final)=15.315 | 4882.4 samples/s | 76.3 steps/s
[Step=45950 Epoch=224.1] | Loss=0.00403 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.918 | L2-Norm(final)=15.316 | 2628.6 samples/s | 41.1 steps/s
[Step=46000 Epoch=224.3] | Loss=0.00394 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.920 | L2-Norm(final)=15.317 | 4732.7 samples/s | 73.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step46000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=40001 Epoch=379.0] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=15.952 | 5418.5 samples/s | 84.7 steps/s
[Step=40050 Epoch=379.5] | Loss=0.00028 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=15.957 | 4579.2 samples/s | 71.6 steps/s
[Step=40100 Epoch=380.0] | Loss=0.00026 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=15.964 | 8300.5 samples/s | 129.7 steps/s
[Step=40150 Epoch=380.5] | Loss=0.00025 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=15.972 | 2322.4 samples/s | 36.3 steps/s
[Step=40200 Epoch=380.9] | Loss=0.00026 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=15.979 | 7311.9 samples/s | 114.2 steps/s
[Step=40250 Epoch=381.4] | Loss=0.00026 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=15.986 | 2407.6 samples/s | 37.6 steps/s
[Step=40300 Epoch=381.9] | Loss=0.00026 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=15.993 | 6662.0 samples/s | 104.1 steps/s
[Step=40350 Epoch=382.4] | Loss=0.00026 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=16.000 | 2531.2 samples/s | 39.6 steps/s
[Step=40400 Epoch=382.8] | Loss=0.00026 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=16.006 | 5885.0 samples/s | 92.0 steps/s
[Step=40450 Epoch=383.3] | Loss=0.00026 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=16.012 | 2691.6 samples/s | 42.1 steps/s
[Step=40500 Epoch=383.8] | Loss=0.00025 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=16.018 | 5436.0 samples/s | 84.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=383.8] | Loss=0.00019 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=16.077 | 5749.5 samples/s | 89.8 steps/s
[Step=40550 Epoch=384.2] | Loss=0.00023 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.850 | L2-Norm(final)=16.080 | 4104.4 samples/s | 64.1 steps/s
[Step=40600 Epoch=384.7] | Loss=0.00021 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.853 | L2-Norm(final)=16.082 | 6682.9 samples/s | 104.4 steps/s
[Step=40650 Epoch=385.2] | Loss=0.00015 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.854 | L2-Norm(final)=16.084 | 2182.8 samples/s | 34.1 steps/s
[Step=40700 Epoch=385.7] | Loss=0.00011 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.853 | L2-Norm(final)=16.085 | 6088.5 samples/s | 95.1 steps/s
[Step=40750 Epoch=386.1] | Loss=0.00009 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.851 | L2-Norm(final)=16.086 | 2248.7 samples/s | 35.1 steps/s
[Step=40800 Epoch=386.6] | Loss=0.00008 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.849 | L2-Norm(final)=16.086 | 5544.9 samples/s | 86.6 steps/s
[Step=40850 Epoch=387.1] | Loss=0.00007 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=16.087 | 2372.2 samples/s | 37.1 steps/s
[Step=40900 Epoch=387.6] | Loss=0.00006 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=16.087 | 5044.9 samples/s | 78.8 steps/s
[Step=40950 Epoch=388.0] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=16.087 | 2429.5 samples/s | 38.0 steps/s
[Step=41000 Epoch=388.5] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=16.088 | 4745.9 samples/s | 74.2 steps/s
[Step=41050 Epoch=389.0] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.837 | L2-Norm(final)=16.088 | 2563.5 samples/s | 40.1 steps/s
[Step=41100 Epoch=389.5] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.834 | L2-Norm(final)=16.089 | 4608.3 samples/s | 72.0 steps/s
[Step=41150 Epoch=389.9] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.831 | L2-Norm(final)=16.089 | 2577.3 samples/s | 40.3 steps/s
[Step=41200 Epoch=390.4] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.828 | L2-Norm(final)=16.089 | 4633.4 samples/s | 72.4 steps/s
[Step=41250 Epoch=390.9] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.825 | L2-Norm(final)=16.090 | 2564.5 samples/s | 40.1 steps/s
[Step=41300 Epoch=391.4] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.822 | L2-Norm(final)=16.090 | 4535.9 samples/s | 70.9 steps/s
[Step=41350 Epoch=391.8] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.819 | L2-Norm(final)=16.090 | 2756.5 samples/s | 43.1 steps/s
[Step=41400 Epoch=392.3] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=16.090 | 4127.6 samples/s | 64.5 steps/s
[Step=41450 Epoch=392.8] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=16.091 | 6856.1 samples/s | 107.1 steps/s
[Step=41500 Epoch=393.2] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.810 | L2-Norm(final)=16.091 | 2166.9 samples/s | 33.9 steps/s
[Step=41550 Epoch=393.7] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.807 | L2-Norm(final)=16.091 | 6184.2 samples/s | 96.6 steps/s
[Step=41600 Epoch=394.2] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=16.092 | 2238.8 samples/s | 35.0 steps/s
[Step=41650 Epoch=394.7] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.800 | L2-Norm(final)=16.092 | 5734.3 samples/s | 89.6 steps/s
[Step=41700 Epoch=395.1] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.797 | L2-Norm(final)=16.092 | 2306.8 samples/s | 36.0 steps/s
[Step=41750 Epoch=395.6] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.793 | L2-Norm(final)=16.093 | 5276.7 samples/s | 82.4 steps/s
[Step=41800 Epoch=396.1] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.790 | L2-Norm(final)=16.093 | 2408.1 samples/s | 37.6 steps/s
[Step=41850 Epoch=396.6] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.786 | L2-Norm(final)=16.093 | 4877.6 samples/s | 76.2 steps/s
[Step=41900 Epoch=397.0] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.783 | L2-Norm(final)=16.093 | 2494.2 samples/s | 39.0 steps/s
[Step=41950 Epoch=397.5] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.779 | L2-Norm(final)=16.094 | 4702.4 samples/s | 73.5 steps/s
[Step=42000 Epoch=398.0] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.776 | L2-Norm(final)=16.094 | 2557.7 samples/s | 40.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step42000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=30001 Epoch=285.4] | Loss=0.00030 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=15.439 | 5367.5 samples/s | 83.9 steps/s
[Step=30050 Epoch=285.9] | Loss=0.00045 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.846 | L2-Norm(final)=15.445 | 4817.6 samples/s | 75.3 steps/s
[Step=30100 Epoch=286.3] | Loss=0.00049 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.846 | L2-Norm(final)=15.452 | 8466.9 samples/s | 132.3 steps/s
[Step=30150 Epoch=286.8] | Loss=0.00053 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.846 | L2-Norm(final)=15.458 | 2336.4 samples/s | 36.5 steps/s
[Step=30200 Epoch=287.3] | Loss=0.00053 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.846 | L2-Norm(final)=15.465 | 7282.4 samples/s | 113.8 steps/s
[Step=30250 Epoch=287.8] | Loss=0.00052 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.846 | L2-Norm(final)=15.471 | 2458.2 samples/s | 38.4 steps/s
[Step=30300 Epoch=288.2] | Loss=0.00052 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=15.477 | 6442.5 samples/s | 100.7 steps/s
[Step=30350 Epoch=288.7] | Loss=0.00051 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=15.483 | 2507.0 samples/s | 39.2 steps/s
[Step=30400 Epoch=289.2] | Loss=0.00051 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=15.488 | 6025.7 samples/s | 94.2 steps/s
[Step=30450 Epoch=289.7] | Loss=0.00051 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=15.494 | 2637.5 samples/s | 41.2 steps/s
[Step=30500 Epoch=290.1] | Loss=0.00049 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=15.500 | 5399.1 samples/s | 84.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=30501 Epoch=290.1] | Loss=0.00074 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=15.554 | 5718.0 samples/s | 89.3 steps/s
[Step=30550 Epoch=290.6] | Loss=0.00023 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.851 | L2-Norm(final)=15.557 | 4154.1 samples/s | 64.9 steps/s
[Step=30600 Epoch=291.1] | Loss=0.00017 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.853 | L2-Norm(final)=15.559 | 6737.6 samples/s | 105.3 steps/s
[Step=30650 Epoch=291.6] | Loss=0.00011 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.852 | L2-Norm(final)=15.560 | 2130.2 samples/s | 33.3 steps/s
[Step=30700 Epoch=292.0] | Loss=0.00009 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.849 | L2-Norm(final)=15.561 | 5813.2 samples/s | 90.8 steps/s
[Step=30750 Epoch=292.5] | Loss=0.00007 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.846 | L2-Norm(final)=15.562 | 2233.3 samples/s | 34.9 steps/s
[Step=30800 Epoch=293.0] | Loss=0.00006 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.843 | L2-Norm(final)=15.562 | 5597.1 samples/s | 87.5 steps/s
[Step=30850 Epoch=293.5] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.839 | L2-Norm(final)=15.563 | 2368.3 samples/s | 37.0 steps/s
[Step=30900 Epoch=293.9] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.835 | L2-Norm(final)=15.563 | 5084.0 samples/s | 79.4 steps/s
[Step=30950 Epoch=294.4] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.831 | L2-Norm(final)=15.564 | 2431.5 samples/s | 38.0 steps/s
[Step=31000 Epoch=294.9] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=15.564 | 4761.4 samples/s | 74.4 steps/s
[Step=31050 Epoch=295.4] | Loss=0.00004 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.822 | L2-Norm(final)=15.565 | 2544.0 samples/s | 39.8 steps/s
[Step=31100 Epoch=295.8] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.818 | L2-Norm(final)=15.565 | 4618.7 samples/s | 72.2 steps/s
[Step=31150 Epoch=296.3] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=15.565 | 2573.8 samples/s | 40.2 steps/s
[Step=31200 Epoch=296.8] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.809 | L2-Norm(final)=15.566 | 4594.7 samples/s | 71.8 steps/s
[Step=31250 Epoch=297.3] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.804 | L2-Norm(final)=15.566 | 2601.6 samples/s | 40.6 steps/s
[Step=31300 Epoch=297.7] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.799 | L2-Norm(final)=15.566 | 4554.5 samples/s | 71.2 steps/s
[Step=31350 Epoch=298.2] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.794 | L2-Norm(final)=15.567 | 2747.2 samples/s | 42.9 steps/s
[Step=31400 Epoch=298.7] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.789 | L2-Norm(final)=15.567 | 4097.9 samples/s | 64.0 steps/s
[Step=31450 Epoch=299.2] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.784 | L2-Norm(final)=15.567 | 6975.7 samples/s | 109.0 steps/s
[Step=31500 Epoch=299.6] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.779 | L2-Norm(final)=15.568 | 2188.6 samples/s | 34.2 steps/s
[Step=31550 Epoch=300.1] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.774 | L2-Norm(final)=15.568 | 6161.4 samples/s | 96.3 steps/s
[Step=31600 Epoch=300.6] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.769 | L2-Norm(final)=15.568 | 2257.7 samples/s | 35.3 steps/s
[Step=31650 Epoch=301.1] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.764 | L2-Norm(final)=15.568 | 5716.0 samples/s | 89.3 steps/s
[Step=31700 Epoch=301.5] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.759 | L2-Norm(final)=15.569 | 2360.8 samples/s | 36.9 steps/s
[Step=31750 Epoch=302.0] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.753 | L2-Norm(final)=15.569 | 5100.2 samples/s | 79.7 steps/s
[Step=31800 Epoch=302.5] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=15.569 | 2398.4 samples/s | 37.5 steps/s
[Step=31850 Epoch=303.0] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.742 | L2-Norm(final)=15.570 | 4843.6 samples/s | 75.7 steps/s
[Step=31900 Epoch=303.4] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.737 | L2-Norm(final)=15.570 | 2513.6 samples/s | 39.3 steps/s
[Step=31950 Epoch=303.9] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.731 | L2-Norm(final)=15.570 | 4600.5 samples/s | 71.9 steps/s
[Step=32000 Epoch=304.4] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.725 | L2-Norm(final)=15.570 | 2613.5 samples/s | 40.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07566 | acc=0.9637 | tpr=0.9727 | fpr=0.0557 | 5617.4 samples/s | 21.9 steps/s
Avg test loss: 0.08408, Avg test acc: 0.96210, Avg tpr: 0.97179, Avg fpr: 0.05922, total FA: 462

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08525 | acc=0.9644 | tpr=0.9832 | fpr=0.0766 | 5672.3 samples/s | 22.2 steps/s
Avg test loss: 0.09150, Avg test acc: 0.96330, Avg tpr: 0.98205, Avg fpr: 0.07794, total FA: 608

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08366 | acc=0.9648 | tpr=0.9822 | fpr=0.0728 | 5531.5 samples/s | 21.6 steps/s
Avg test loss: 0.08995, Avg test acc: 0.96426, Avg tpr: 0.98065, Avg fpr: 0.07179, total FA: 560

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08026 | acc=0.9647 | tpr=0.9755 | fpr=0.0587 | 5721.7 samples/s | 22.4 steps/s
Avg test loss: 0.08761, Avg test acc: 0.96474, Avg tpr: 0.97604, Avg fpr: 0.06012, total FA: 469

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08101 | acc=0.9650 | tpr=0.9743 | fpr=0.0553 | 5627.2 samples/s | 22.0 steps/s
Avg test loss: 0.09372, Avg test acc: 0.96330, Avg tpr: 0.97243, Avg fpr: 0.05679, total FA: 443

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.54022 | acc=0.2646 | tpr=0.0056 | fpr=0.1729 | 5804.6 samples/s | 22.7 steps/s
Avg test loss: 5.54969, Avg test acc: 0.26248, Avg tpr: 0.00571, Avg fpr: 0.17280, total FA: 1348

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.65259 | acc=0.2936 | tpr=0.0135 | fpr=0.0981 | 5786.0 samples/s | 22.6 steps/s
Avg test loss: 4.66229, Avg test acc: 0.29181, Avg tpr: 0.01405, Avg fpr: 0.09730, total FA: 759

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.27501 | acc=0.2394 | tpr=0.0148 | fpr=0.2730 | 5555.0 samples/s | 21.7 steps/s
Avg test loss: 5.28175, Avg test acc: 0.23924, Avg tpr: 0.01550, Avg fpr: 0.26868, total FA: 2096

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=6.27982 | acc=0.2412 | tpr=0.0103 | fpr=0.2572 | 5808.0 samples/s | 22.7 steps/s
Avg test loss: 6.29203, Avg test acc: 0.23948, Avg tpr: 0.01067, Avg fpr: 0.25727, total FA: 2007

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.54468 | acc=0.2359 | tpr=0.0073 | fpr=0.2678 | 5689.7 samples/s | 22.2 steps/s
Avg test loss: 5.55068, Avg test acc: 0.23548, Avg tpr: 0.00752, Avg fpr: 0.26317, total FA: 2053

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.04802 | acc=0.1544 | tpr=0.1858 | fpr=0.8462 | 5553.0 samples/s | 21.7 steps/s
[Step= 100] | Loss=5.00195 | acc=0.1563 | tpr=0.1770 | fpr=0.8441 | 7620.5 samples/s | 29.8 steps/s
[Step= 150] | Loss=5.01771 | acc=0.1558 | tpr=0.1700 | fpr=0.8444 | 8109.7 samples/s | 31.7 steps/s
[Step= 200] | Loss=5.01249 | acc=0.1556 | tpr=0.1683 | fpr=0.8446 | 8589.9 samples/s | 33.6 steps/s
[Step= 250] | Loss=5.01892 | acc=0.1560 | tpr=0.1686 | fpr=0.8442 | 7832.5 samples/s | 30.6 steps/s
[Step= 300] | Loss=5.02345 | acc=0.1555 | tpr=0.1731 | fpr=0.8449 | 8012.1 samples/s | 31.3 steps/s
[Step= 350] | Loss=5.02537 | acc=0.1551 | tpr=0.1659 | fpr=0.8451 | 7987.5 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.02482 | acc=0.1555 | tpr=0.1690 | fpr=0.8447 | 7654.2 samples/s | 29.9 steps/s
[Step= 450] | Loss=5.02379 | acc=0.1560 | tpr=0.1680 | fpr=0.8442 | 8283.2 samples/s | 32.4 steps/s
[Step= 500] | Loss=5.02667 | acc=0.1557 | tpr=0.1714 | fpr=0.8446 | 7535.9 samples/s | 29.4 steps/s
[Step= 550] | Loss=5.02481 | acc=0.1557 | tpr=0.1695 | fpr=0.8446 | 12388.8 samples/s | 48.4 steps/s
Avg test loss: 5.02447, Avg test acc: 0.15562, Avg tpr: 0.16997, Avg fpr: 0.84464, total FA: 117277

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.14771 | acc=0.1267 | tpr=0.2788 | fpr=0.8760 | 5547.6 samples/s | 21.7 steps/s
[Step= 100] | Loss=5.10349 | acc=0.1291 | tpr=0.2495 | fpr=0.8731 | 7705.8 samples/s | 30.1 steps/s
[Step= 150] | Loss=5.12017 | acc=0.1266 | tpr=0.2406 | fpr=0.8755 | 8525.6 samples/s | 33.3 steps/s
[Step= 200] | Loss=5.11658 | acc=0.1267 | tpr=0.2350 | fpr=0.8753 | 8308.7 samples/s | 32.5 steps/s
[Step= 250] | Loss=5.12026 | acc=0.1265 | tpr=0.2306 | fpr=0.8754 | 7461.2 samples/s | 29.1 steps/s
[Step= 300] | Loss=5.12399 | acc=0.1257 | tpr=0.2320 | fpr=0.8762 | 8239.8 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.12656 | acc=0.1252 | tpr=0.2173 | fpr=0.8765 | 8514.2 samples/s | 33.3 steps/s
[Step= 400] | Loss=5.12531 | acc=0.1258 | tpr=0.2237 | fpr=0.8759 | 8258.2 samples/s | 32.3 steps/s
[Step= 450] | Loss=5.12383 | acc=0.1261 | tpr=0.2210 | fpr=0.8756 | 7529.9 samples/s | 29.4 steps/s
[Step= 500] | Loss=5.12673 | acc=0.1262 | tpr=0.2251 | fpr=0.8756 | 7780.5 samples/s | 30.4 steps/s
[Step= 550] | Loss=5.12446 | acc=0.1265 | tpr=0.2240 | fpr=0.8753 | 11309.6 samples/s | 44.2 steps/s
Avg test loss: 5.12463, Avg test acc: 0.12644, Avg tpr: 0.22385, Avg fpr: 0.87533, total FA: 121538

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.05612 | acc=0.1222 | tpr=0.1593 | fpr=0.8785 | 5665.3 samples/s | 22.1 steps/s
[Step= 100] | Loss=6.00852 | acc=0.1238 | tpr=0.1471 | fpr=0.8766 | 7988.3 samples/s | 31.2 steps/s
[Step= 150] | Loss=6.02054 | acc=0.1230 | tpr=0.1484 | fpr=0.8775 | 7598.1 samples/s | 29.7 steps/s
[Step= 200] | Loss=6.01449 | acc=0.1232 | tpr=0.1432 | fpr=0.8772 | 8178.7 samples/s | 31.9 steps/s
[Step= 250] | Loss=6.01896 | acc=0.1232 | tpr=0.1424 | fpr=0.8772 | 8107.3 samples/s | 31.7 steps/s
[Step= 300] | Loss=6.02517 | acc=0.1226 | tpr=0.1455 | fpr=0.8778 | 8001.7 samples/s | 31.3 steps/s
[Step= 350] | Loss=6.02987 | acc=0.1219 | tpr=0.1384 | fpr=0.8784 | 8251.4 samples/s | 32.2 steps/s
[Step= 400] | Loss=6.02803 | acc=0.1223 | tpr=0.1450 | fpr=0.8781 | 7727.7 samples/s | 30.2 steps/s
[Step= 450] | Loss=6.02634 | acc=0.1226 | tpr=0.1446 | fpr=0.8778 | 8213.5 samples/s | 32.1 steps/s
[Step= 500] | Loss=6.02846 | acc=0.1224 | tpr=0.1467 | fpr=0.8781 | 8240.0 samples/s | 32.2 steps/s
[Step= 550] | Loss=6.02485 | acc=0.1226 | tpr=0.1468 | fpr=0.8778 | 10668.5 samples/s | 41.7 steps/s
Avg test loss: 6.02466, Avg test acc: 0.12254, Avg tpr: 0.14739, Avg fpr: 0.87791, total FA: 121896

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.31412 | acc=0.1497 | tpr=0.1947 | fpr=0.8511 | 5812.5 samples/s | 22.7 steps/s
[Step= 100] | Loss=5.26562 | acc=0.1508 | tpr=0.1834 | fpr=0.8498 | 7968.4 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.28063 | acc=0.1500 | tpr=0.1844 | fpr=0.8506 | 8350.3 samples/s | 32.6 steps/s
[Step= 200] | Loss=5.27273 | acc=0.1500 | tpr=0.1803 | fpr=0.8505 | 7899.3 samples/s | 30.9 steps/s
[Step= 250] | Loss=5.27841 | acc=0.1501 | tpr=0.1817 | fpr=0.8504 | 7226.3 samples/s | 28.2 steps/s
[Step= 300] | Loss=5.28478 | acc=0.1494 | tpr=0.1818 | fpr=0.8512 | 8559.3 samples/s | 33.4 steps/s
[Step= 350] | Loss=5.28688 | acc=0.1490 | tpr=0.1753 | fpr=0.8515 | 8116.4 samples/s | 31.7 steps/s
[Step= 400] | Loss=5.28633 | acc=0.1495 | tpr=0.1833 | fpr=0.8512 | 8155.3 samples/s | 31.9 steps/s
[Step= 450] | Loss=5.28515 | acc=0.1497 | tpr=0.1821 | fpr=0.8509 | 8043.1 samples/s | 31.4 steps/s
[Step= 500] | Loss=5.28865 | acc=0.1494 | tpr=0.1837 | fpr=0.8512 | 7131.9 samples/s | 27.9 steps/s
[Step= 550] | Loss=5.28561 | acc=0.1496 | tpr=0.1862 | fpr=0.8511 | 12227.4 samples/s | 47.8 steps/s
Avg test loss: 5.28521, Avg test acc: 0.14951, Avg tpr: 0.18621, Avg fpr: 0.85115, total FA: 118181

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.89748 | acc=0.1415 | tpr=0.1239 | fpr=0.8582 | 5830.2 samples/s | 22.8 steps/s
[Step= 100] | Loss=5.84193 | acc=0.1431 | tpr=0.1173 | fpr=0.8564 | 7388.1 samples/s | 28.9 steps/s
[Step= 150] | Loss=5.85797 | acc=0.1425 | tpr=0.1153 | fpr=0.8570 | 7941.3 samples/s | 31.0 steps/s
[Step= 200] | Loss=5.85402 | acc=0.1426 | tpr=0.1115 | fpr=0.8568 | 8810.9 samples/s | 34.4 steps/s
[Step= 250] | Loss=5.86230 | acc=0.1427 | tpr=0.1127 | fpr=0.8568 | 8412.6 samples/s | 32.9 steps/s
[Step= 300] | Loss=5.86522 | acc=0.1423 | tpr=0.1135 | fpr=0.8572 | 7877.8 samples/s | 30.8 steps/s
[Step= 350] | Loss=5.86859 | acc=0.1418 | tpr=0.1096 | fpr=0.8576 | 7629.5 samples/s | 29.8 steps/s
[Step= 400] | Loss=5.86717 | acc=0.1422 | tpr=0.1138 | fpr=0.8573 | 8202.8 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.86630 | acc=0.1425 | tpr=0.1154 | fpr=0.8570 | 8037.8 samples/s | 31.4 steps/s
[Step= 500] | Loss=5.86978 | acc=0.1422 | tpr=0.1154 | fpr=0.8573 | 8242.3 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.86616 | acc=0.1423 | tpr=0.1146 | fpr=0.8572 | 9947.5 samples/s | 38.9 steps/s
Avg test loss: 5.86593, Avg test acc: 0.14216, Avg tpr: 0.11529, Avg fpr: 0.85735, total FA: 119041

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10983 | acc=0.9807 | tpr=0.9248 | fpr=0.0183 | 5525.8 samples/s | 21.6 steps/s
[Step= 100] | Loss=0.11107 | acc=0.9807 | tpr=0.9403 | fpr=0.0185 | 7985.9 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.11484 | acc=0.9804 | tpr=0.9467 | fpr=0.0190 | 8267.6 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.11684 | acc=0.9805 | tpr=0.9519 | fpr=0.0190 | 8428.2 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.11756 | acc=0.9803 | tpr=0.9476 | fpr=0.0191 | 7512.1 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.11904 | acc=0.9802 | tpr=0.9469 | fpr=0.0192 | 8278.0 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.11919 | acc=0.9802 | tpr=0.9505 | fpr=0.0193 | 8423.6 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.12019 | acc=0.9801 | tpr=0.9464 | fpr=0.0193 | 8222.8 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.12253 | acc=0.9797 | tpr=0.9445 | fpr=0.0197 | 7858.9 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.12156 | acc=0.9798 | tpr=0.9463 | fpr=0.0196 | 7996.0 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.12062 | acc=0.9799 | tpr=0.9463 | fpr=0.0195 | 10496.7 samples/s | 41.0 steps/s
Avg test loss: 0.12039, Avg test acc: 0.97994, Avg tpr: 0.94612, Avg fpr: 0.01945, total FA: 2700

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10062 | acc=0.9812 | tpr=0.9159 | fpr=0.0177 | 5734.2 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.10236 | acc=0.9810 | tpr=0.9296 | fpr=0.0181 | 7900.2 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.10569 | acc=0.9803 | tpr=0.9308 | fpr=0.0188 | 8097.5 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.10700 | acc=0.9803 | tpr=0.9322 | fpr=0.0189 | 8771.0 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.10780 | acc=0.9803 | tpr=0.9284 | fpr=0.0187 | 7467.2 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.10932 | acc=0.9801 | tpr=0.9265 | fpr=0.0189 | 8328.2 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.10930 | acc=0.9801 | tpr=0.9292 | fpr=0.0189 | 8074.5 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.11017 | acc=0.9800 | tpr=0.9245 | fpr=0.0190 | 7544.5 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.11205 | acc=0.9798 | tpr=0.9236 | fpr=0.0192 | 8539.5 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.11116 | acc=0.9799 | tpr=0.9260 | fpr=0.0191 | 8609.8 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.11023 | acc=0.9801 | tpr=0.9248 | fpr=0.0189 | 9195.2 samples/s | 35.9 steps/s
Avg test loss: 0.11003, Avg test acc: 0.98007, Avg tpr: 0.92433, Avg fpr: 0.01892, total FA: 2627

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12239 | acc=0.9784 | tpr=0.9425 | fpr=0.0210 | 5811.7 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.12389 | acc=0.9783 | tpr=0.9595 | fpr=0.0214 | 7242.6 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.12873 | acc=0.9774 | tpr=0.9597 | fpr=0.0223 | 7840.8 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.13037 | acc=0.9774 | tpr=0.9617 | fpr=0.0223 | 8509.7 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.13122 | acc=0.9773 | tpr=0.9590 | fpr=0.0224 | 7752.4 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.13225 | acc=0.9774 | tpr=0.9600 | fpr=0.0223 | 8456.0 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.13224 | acc=0.9773 | tpr=0.9612 | fpr=0.0224 | 7940.7 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.13325 | acc=0.9771 | tpr=0.9579 | fpr=0.0225 | 8269.5 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.13556 | acc=0.9768 | tpr=0.9557 | fpr=0.0228 | 8150.0 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.13468 | acc=0.9769 | tpr=0.9573 | fpr=0.0227 | 7366.4 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.13355 | acc=0.9771 | tpr=0.9570 | fpr=0.0225 | 11593.9 samples/s | 45.3 steps/s
Avg test loss: 0.13327, Avg test acc: 0.97712, Avg tpr: 0.95681, Avg fpr: 0.02251, total FA: 3126

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09576 | acc=0.9827 | tpr=0.9292 | fpr=0.0164 | 5858.1 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.09817 | acc=0.9822 | tpr=0.9360 | fpr=0.0170 | 7611.2 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.10118 | acc=0.9817 | tpr=0.9366 | fpr=0.0175 | 7720.2 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.10220 | acc=0.9815 | tpr=0.9388 | fpr=0.0177 | 7758.2 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.10326 | acc=0.9814 | tpr=0.9328 | fpr=0.0177 | 8197.1 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.10390 | acc=0.9815 | tpr=0.9302 | fpr=0.0176 | 8438.5 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.10387 | acc=0.9815 | tpr=0.9349 | fpr=0.0177 | 7966.5 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.10498 | acc=0.9813 | tpr=0.9305 | fpr=0.0177 | 8236.0 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.10689 | acc=0.9810 | tpr=0.9299 | fpr=0.0181 | 8247.1 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.10604 | acc=0.9811 | tpr=0.9313 | fpr=0.0180 | 8361.2 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.10548 | acc=0.9812 | tpr=0.9292 | fpr=0.0179 | 9890.1 samples/s | 38.6 steps/s
Avg test loss: 0.10530, Avg test acc: 0.98118, Avg tpr: 0.92908, Avg fpr: 0.01788, total FA: 2482

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10404 | acc=0.9810 | tpr=0.9336 | fpr=0.0181 | 5665.6 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.10596 | acc=0.9809 | tpr=0.9424 | fpr=0.0184 | 7654.4 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.10930 | acc=0.9804 | tpr=0.9452 | fpr=0.0190 | 8152.4 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.11049 | acc=0.9804 | tpr=0.9497 | fpr=0.0191 | 8075.5 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.11163 | acc=0.9803 | tpr=0.9467 | fpr=0.0191 | 8028.8 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.11264 | acc=0.9803 | tpr=0.9476 | fpr=0.0191 | 8149.2 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.11258 | acc=0.9803 | tpr=0.9505 | fpr=0.0191 | 7872.1 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.11335 | acc=0.9803 | tpr=0.9464 | fpr=0.0191 | 8514.5 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.11541 | acc=0.9799 | tpr=0.9455 | fpr=0.0195 | 7610.2 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.11454 | acc=0.9801 | tpr=0.9476 | fpr=0.0194 | 8408.6 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.11368 | acc=0.9802 | tpr=0.9459 | fpr=0.0192 | 10445.3 samples/s | 40.8 steps/s
Avg test loss: 0.11349, Avg test acc: 0.98020, Avg tpr: 0.94572, Avg fpr: 0.01917, total FA: 2662

server round 42/50

clients selected: [0 3 6 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=32001 Epoch=156.0] | Loss=0.01656 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.816 | L2-Norm(final)=14.100 | 6285.4 samples/s | 98.2 steps/s
[Step=32050 Epoch=156.3] | Loss=0.01231 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=14.103 | 5219.1 samples/s | 81.5 steps/s
[Step=32100 Epoch=156.5] | Loss=0.01388 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=14.105 | 5648.8 samples/s | 88.3 steps/s
[Step=32150 Epoch=156.8] | Loss=0.01396 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=14.107 | 5793.6 samples/s | 90.5 steps/s
[Step=32200 Epoch=157.0] | Loss=0.01416 | Reg=0.00096 | acc=0.9531 | L2-Norm=9.816 | L2-Norm(final)=14.109 | 8365.8 samples/s | 130.7 steps/s
[Step=32250 Epoch=157.3] | Loss=0.01432 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=14.110 | 2448.0 samples/s | 38.3 steps/s
[Step=32300 Epoch=157.5] | Loss=0.01442 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.816 | L2-Norm(final)=14.111 | 5563.4 samples/s | 86.9 steps/s
[Step=32350 Epoch=157.7] | Loss=0.01442 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=14.112 | 5637.5 samples/s | 88.1 steps/s
[Step=32400 Epoch=158.0] | Loss=0.01414 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.816 | L2-Norm(final)=14.114 | 7814.2 samples/s | 122.1 steps/s
[Step=32450 Epoch=158.2] | Loss=0.01436 | Reg=0.00096 | acc=0.9688 | L2-Norm=9.816 | L2-Norm(final)=14.115 | 2520.1 samples/s | 39.4 steps/s
[Step=32500 Epoch=158.5] | Loss=0.01435 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=14.116 | 5630.7 samples/s | 88.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=32501 Epoch=158.5] | Loss=0.01047 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=14.131 | 6314.6 samples/s | 98.7 steps/s
[Step=32550 Epoch=158.7] | Loss=0.01422 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.820 | L2-Norm(final)=14.131 | 4162.8 samples/s | 65.0 steps/s
[Step=32600 Epoch=159.0] | Loss=0.01269 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.828 | L2-Norm(final)=14.132 | 4899.0 samples/s | 76.5 steps/s
[Step=32650 Epoch=159.2] | Loss=0.01249 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.833 | L2-Norm(final)=14.134 | 4816.8 samples/s | 75.3 steps/s
[Step=32700 Epoch=159.5] | Loss=0.01208 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.838 | L2-Norm(final)=14.136 | 6974.7 samples/s | 109.0 steps/s
[Step=32750 Epoch=159.7] | Loss=0.01080 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.842 | L2-Norm(final)=14.137 | 2248.1 samples/s | 35.1 steps/s
[Step=32800 Epoch=159.9] | Loss=0.00964 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.846 | L2-Norm(final)=14.139 | 4874.1 samples/s | 76.2 steps/s
[Step=32850 Epoch=160.2] | Loss=0.00903 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.849 | L2-Norm(final)=14.142 | 4822.0 samples/s | 75.3 steps/s
[Step=32900 Epoch=160.4] | Loss=0.00847 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.852 | L2-Norm(final)=14.144 | 6368.6 samples/s | 99.5 steps/s
[Step=32950 Epoch=160.7] | Loss=0.00798 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.855 | L2-Norm(final)=14.146 | 2367.7 samples/s | 37.0 steps/s
[Step=33000 Epoch=160.9] | Loss=0.00759 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.858 | L2-Norm(final)=14.148 | 4813.2 samples/s | 75.2 steps/s
[Step=33050 Epoch=161.2] | Loss=0.00732 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.861 | L2-Norm(final)=14.150 | 4858.7 samples/s | 75.9 steps/s
[Step=33100 Epoch=161.4] | Loss=0.00695 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.864 | L2-Norm(final)=14.152 | 5822.1 samples/s | 91.0 steps/s
[Step=33150 Epoch=161.6] | Loss=0.00663 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.866 | L2-Norm(final)=14.154 | 2421.4 samples/s | 37.8 steps/s
[Step=33200 Epoch=161.9] | Loss=0.00647 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.868 | L2-Norm(final)=14.156 | 4851.9 samples/s | 75.8 steps/s
[Step=33250 Epoch=162.1] | Loss=0.00628 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.871 | L2-Norm(final)=14.158 | 4778.7 samples/s | 74.7 steps/s
[Step=33300 Epoch=162.4] | Loss=0.00609 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=14.160 | 5391.6 samples/s | 84.2 steps/s
[Step=33350 Epoch=162.6] | Loss=0.00592 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=14.162 | 2532.6 samples/s | 39.6 steps/s
[Step=33400 Epoch=162.9] | Loss=0.00575 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.877 | L2-Norm(final)=14.163 | 4864.7 samples/s | 76.0 steps/s
[Step=33450 Epoch=163.1] | Loss=0.00565 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.880 | L2-Norm(final)=14.165 | 4836.9 samples/s | 75.6 steps/s
[Step=33500 Epoch=163.4] | Loss=0.00552 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=14.167 | 4988.2 samples/s | 77.9 steps/s
[Step=33550 Epoch=163.6] | Loss=0.00539 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.883 | L2-Norm(final)=14.169 | 2569.3 samples/s | 40.1 steps/s
[Step=33600 Epoch=163.8] | Loss=0.00528 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.885 | L2-Norm(final)=14.170 | 4864.5 samples/s | 76.0 steps/s
[Step=33650 Epoch=164.1] | Loss=0.00513 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.887 | L2-Norm(final)=14.172 | 4866.6 samples/s | 76.0 steps/s
[Step=33700 Epoch=164.3] | Loss=0.00507 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=14.174 | 4857.4 samples/s | 75.9 steps/s
[Step=33750 Epoch=164.6] | Loss=0.00501 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.891 | L2-Norm(final)=14.175 | 2599.9 samples/s | 40.6 steps/s
[Step=33800 Epoch=164.8] | Loss=0.00492 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.893 | L2-Norm(final)=14.177 | 4817.1 samples/s | 75.3 steps/s
[Step=33850 Epoch=165.1] | Loss=0.00483 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.894 | L2-Norm(final)=14.179 | 4972.4 samples/s | 77.7 steps/s
[Step=33900 Epoch=165.3] | Loss=0.00474 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.896 | L2-Norm(final)=14.180 | 4764.8 samples/s | 74.4 steps/s
[Step=33950 Epoch=165.5] | Loss=0.00470 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=14.182 | 2653.6 samples/s | 41.5 steps/s
[Step=34000 Epoch=165.8] | Loss=0.00461 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=14.183 | 4876.4 samples/s | 76.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step34000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=46001 Epoch=224.3] | Loss=0.00298 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=15.358 | 5566.7 samples/s | 87.0 steps/s
[Step=46050 Epoch=224.6] | Loss=0.01484 | Reg=0.00096 | acc=0.9688 | L2-Norm=9.816 | L2-Norm(final)=15.359 | 4868.6 samples/s | 76.1 steps/s
[Step=46100 Epoch=224.8] | Loss=0.01598 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.816 | L2-Norm(final)=15.360 | 5773.5 samples/s | 90.2 steps/s
[Step=46150 Epoch=225.1] | Loss=0.01654 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.816 | L2-Norm(final)=15.361 | 5563.8 samples/s | 86.9 steps/s
[Step=46200 Epoch=225.3] | Loss=0.01645 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.816 | L2-Norm(final)=15.361 | 8567.2 samples/s | 133.9 steps/s
[Step=46250 Epoch=225.5] | Loss=0.01632 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=15.361 | 2437.5 samples/s | 38.1 steps/s
[Step=46300 Epoch=225.8] | Loss=0.01569 | Reg=0.00096 | acc=0.9688 | L2-Norm=9.816 | L2-Norm(final)=15.362 | 5664.6 samples/s | 88.5 steps/s
[Step=46350 Epoch=226.0] | Loss=0.01599 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=15.363 | 5540.7 samples/s | 86.6 steps/s
[Step=46400 Epoch=226.3] | Loss=0.01592 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.816 | L2-Norm(final)=15.363 | 7801.7 samples/s | 121.9 steps/s
[Step=46450 Epoch=226.5] | Loss=0.01561 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.816 | L2-Norm(final)=15.364 | 2516.7 samples/s | 39.3 steps/s
[Step=46500 Epoch=226.8] | Loss=0.01559 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.816 | L2-Norm(final)=15.365 | 5825.7 samples/s | 91.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=226.8] | Loss=0.01269 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.816 | L2-Norm(final)=15.372 | 6104.5 samples/s | 95.4 steps/s
[Step=46550 Epoch=227.0] | Loss=0.01521 | Reg=0.00096 | acc=0.9688 | L2-Norm=9.823 | L2-Norm(final)=15.372 | 4258.1 samples/s | 66.5 steps/s
[Step=46600 Epoch=227.2] | Loss=0.01433 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.828 | L2-Norm(final)=15.372 | 4910.6 samples/s | 76.7 steps/s
[Step=46650 Epoch=227.5] | Loss=0.01250 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.833 | L2-Norm(final)=15.373 | 4807.9 samples/s | 75.1 steps/s
[Step=46700 Epoch=227.7] | Loss=0.01152 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.837 | L2-Norm(final)=15.374 | 6929.5 samples/s | 108.3 steps/s
[Step=46750 Epoch=228.0] | Loss=0.00994 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=15.375 | 2282.0 samples/s | 35.7 steps/s
[Step=46800 Epoch=228.2] | Loss=0.00905 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.843 | L2-Norm(final)=15.376 | 4916.4 samples/s | 76.8 steps/s
[Step=46850 Epoch=228.5] | Loss=0.00840 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.846 | L2-Norm(final)=15.377 | 4790.8 samples/s | 74.9 steps/s
[Step=46900 Epoch=228.7] | Loss=0.00781 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.848 | L2-Norm(final)=15.379 | 6378.2 samples/s | 99.7 steps/s
[Step=46950 Epoch=229.0] | Loss=0.00734 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.851 | L2-Norm(final)=15.380 | 2347.8 samples/s | 36.7 steps/s
[Step=47000 Epoch=229.2] | Loss=0.00699 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.854 | L2-Norm(final)=15.382 | 4818.8 samples/s | 75.3 steps/s
[Step=47050 Epoch=229.4] | Loss=0.00659 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.856 | L2-Norm(final)=15.383 | 4880.3 samples/s | 76.3 steps/s
[Step=47100 Epoch=229.7] | Loss=0.00635 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.858 | L2-Norm(final)=15.385 | 5807.9 samples/s | 90.7 steps/s
[Step=47150 Epoch=229.9] | Loss=0.00613 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.860 | L2-Norm(final)=15.386 | 2446.2 samples/s | 38.2 steps/s
[Step=47200 Epoch=230.2] | Loss=0.00581 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.863 | L2-Norm(final)=15.388 | 4957.9 samples/s | 77.5 steps/s
[Step=47250 Epoch=230.4] | Loss=0.00564 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.865 | L2-Norm(final)=15.389 | 4764.2 samples/s | 74.4 steps/s
[Step=47300 Epoch=230.7] | Loss=0.00547 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.867 | L2-Norm(final)=15.391 | 5372.7 samples/s | 83.9 steps/s
[Step=47350 Epoch=230.9] | Loss=0.00551 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.869 | L2-Norm(final)=15.392 | 2503.6 samples/s | 39.1 steps/s
[Step=47400 Epoch=231.1] | Loss=0.00536 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.870 | L2-Norm(final)=15.393 | 4900.2 samples/s | 76.6 steps/s
[Step=47450 Epoch=231.4] | Loss=0.00523 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.872 | L2-Norm(final)=15.395 | 4931.1 samples/s | 77.0 steps/s
[Step=47500 Epoch=231.6] | Loss=0.00518 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=15.396 | 4903.9 samples/s | 76.6 steps/s
[Step=47550 Epoch=231.9] | Loss=0.00506 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.876 | L2-Norm(final)=15.397 | 2599.2 samples/s | 40.6 steps/s
[Step=47600 Epoch=232.1] | Loss=0.00488 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.878 | L2-Norm(final)=15.398 | 4871.7 samples/s | 76.1 steps/s
[Step=47650 Epoch=232.4] | Loss=0.00477 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.879 | L2-Norm(final)=15.400 | 4843.6 samples/s | 75.7 steps/s
[Step=47700 Epoch=232.6] | Loss=0.00479 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.881 | L2-Norm(final)=15.401 | 4826.4 samples/s | 75.4 steps/s
[Step=47750 Epoch=232.9] | Loss=0.00468 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.883 | L2-Norm(final)=15.402 | 2673.8 samples/s | 41.8 steps/s
[Step=47800 Epoch=233.1] | Loss=0.00455 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.884 | L2-Norm(final)=15.403 | 4820.2 samples/s | 75.3 steps/s
[Step=47850 Epoch=233.3] | Loss=0.00446 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=15.405 | 4871.2 samples/s | 76.1 steps/s
[Step=47900 Epoch=233.6] | Loss=0.00444 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.887 | L2-Norm(final)=15.406 | 4850.1 samples/s | 75.8 steps/s
[Step=47950 Epoch=233.8] | Loss=0.00436 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.888 | L2-Norm(final)=15.407 | 2647.8 samples/s | 41.4 steps/s
[Step=48000 Epoch=234.1] | Loss=0.00429 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=15.408 | 4857.6 samples/s | 75.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step48000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=32001 Epoch=304.4] | Loss=0.00019 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=15.579 | 5942.6 samples/s | 92.9 steps/s
[Step=32050 Epoch=304.9] | Loss=0.00049 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.814 | L2-Norm(final)=15.587 | 4407.8 samples/s | 68.9 steps/s
[Step=32100 Epoch=305.4] | Loss=0.00046 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=15.597 | 8222.6 samples/s | 128.5 steps/s
[Step=32150 Epoch=305.8] | Loss=0.00049 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=15.605 | 2350.9 samples/s | 36.7 steps/s
[Step=32200 Epoch=306.3] | Loss=0.00046 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=15.614 | 7204.9 samples/s | 112.6 steps/s
[Step=32250 Epoch=306.8] | Loss=0.00047 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=15.622 | 2425.6 samples/s | 37.9 steps/s
[Step=32300 Epoch=307.3] | Loss=0.00047 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=15.629 | 6501.5 samples/s | 101.6 steps/s
[Step=32350 Epoch=307.7] | Loss=0.00047 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=15.637 | 2536.7 samples/s | 39.6 steps/s
[Step=32400 Epoch=308.2] | Loss=0.00046 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=15.644 | 5943.4 samples/s | 92.9 steps/s
[Step=32450 Epoch=308.7] | Loss=0.00046 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=15.652 | 2613.6 samples/s | 40.8 steps/s
[Step=32500 Epoch=309.2] | Loss=0.00045 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=15.659 | 5491.8 samples/s | 85.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=32501 Epoch=309.2] | Loss=0.00011 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=15.727 | 5904.4 samples/s | 92.3 steps/s
[Step=32550 Epoch=309.6] | Loss=0.00036 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.820 | L2-Norm(final)=15.731 | 4049.8 samples/s | 63.3 steps/s
[Step=32600 Epoch=310.1] | Loss=0.00020 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.825 | L2-Norm(final)=15.732 | 6713.8 samples/s | 104.9 steps/s
[Step=32650 Epoch=310.6] | Loss=0.00013 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.825 | L2-Norm(final)=15.733 | 2204.4 samples/s | 34.4 steps/s
[Step=32700 Epoch=311.1] | Loss=0.00010 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.823 | L2-Norm(final)=15.734 | 6042.2 samples/s | 94.4 steps/s
[Step=32750 Epoch=311.5] | Loss=0.00008 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.820 | L2-Norm(final)=15.735 | 2265.6 samples/s | 35.4 steps/s
[Step=32800 Epoch=312.0] | Loss=0.00007 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.817 | L2-Norm(final)=15.735 | 5590.7 samples/s | 87.4 steps/s
[Step=32850 Epoch=312.5] | Loss=0.00006 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=15.736 | 2380.3 samples/s | 37.2 steps/s
[Step=32900 Epoch=313.0] | Loss=0.00005 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.810 | L2-Norm(final)=15.736 | 5144.0 samples/s | 80.4 steps/s
[Step=32950 Epoch=313.4] | Loss=0.00005 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=15.736 | 2472.7 samples/s | 38.6 steps/s
[Step=33000 Epoch=313.9] | Loss=0.00004 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.802 | L2-Norm(final)=15.737 | 4682.1 samples/s | 73.2 steps/s
[Step=33050 Epoch=314.4] | Loss=0.00004 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.798 | L2-Norm(final)=15.737 | 2509.7 samples/s | 39.2 steps/s
[Step=33100 Epoch=314.9] | Loss=0.00004 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.794 | L2-Norm(final)=15.737 | 4639.0 samples/s | 72.5 steps/s
[Step=33150 Epoch=315.3] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.789 | L2-Norm(final)=15.738 | 2565.5 samples/s | 40.1 steps/s
[Step=33200 Epoch=315.8] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.785 | L2-Norm(final)=15.738 | 4679.1 samples/s | 73.1 steps/s
[Step=33250 Epoch=316.3] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.781 | L2-Norm(final)=15.738 | 2617.4 samples/s | 40.9 steps/s
[Step=33300 Epoch=316.8] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.776 | L2-Norm(final)=15.739 | 4443.5 samples/s | 69.4 steps/s
[Step=33350 Epoch=317.2] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.772 | L2-Norm(final)=15.739 | 2611.5 samples/s | 40.8 steps/s
[Step=33400 Epoch=317.7] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=15.739 | 4523.9 samples/s | 70.7 steps/s
[Step=33450 Epoch=318.2] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.763 | L2-Norm(final)=15.740 | 6993.7 samples/s | 109.3 steps/s
[Step=33500 Epoch=318.7] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.758 | L2-Norm(final)=15.740 | 2173.2 samples/s | 34.0 steps/s
[Step=33550 Epoch=319.1] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.753 | L2-Norm(final)=15.740 | 6319.7 samples/s | 98.7 steps/s
[Step=33600 Epoch=319.6] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=15.740 | 2230.9 samples/s | 34.9 steps/s
[Step=33650 Epoch=320.1] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.744 | L2-Norm(final)=15.741 | 5759.7 samples/s | 90.0 steps/s
[Step=33700 Epoch=320.6] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.739 | L2-Norm(final)=15.741 | 2352.2 samples/s | 36.8 steps/s
[Step=33750 Epoch=321.0] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.734 | L2-Norm(final)=15.741 | 5242.5 samples/s | 81.9 steps/s
[Step=33800 Epoch=321.5] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.729 | L2-Norm(final)=15.741 | 2414.5 samples/s | 37.7 steps/s
[Step=33850 Epoch=322.0] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=15.742 | 4850.9 samples/s | 75.8 steps/s
[Step=33900 Epoch=322.5] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.718 | L2-Norm(final)=15.742 | 2536.2 samples/s | 39.6 steps/s
[Step=33950 Epoch=322.9] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.713 | L2-Norm(final)=15.742 | 4658.2 samples/s | 72.8 steps/s
[Step=34000 Epoch=323.4] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.708 | L2-Norm(final)=15.742 | 2534.5 samples/s | 39.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step34000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=42001 Epoch=401.1] | Loss=0.00006 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=16.899 | 5669.3 samples/s | 88.6 steps/s
[Step=42050 Epoch=401.6] | Loss=0.00016 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=16.899 | 4772.7 samples/s | 74.6 steps/s
[Step=42100 Epoch=402.0] | Loss=0.00019 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=16.900 | 8184.7 samples/s | 127.9 steps/s
[Step=42150 Epoch=402.5] | Loss=0.00017 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=16.898 | 2400.0 samples/s | 37.5 steps/s
[Step=42200 Epoch=403.0] | Loss=0.00019 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=16.898 | 7047.0 samples/s | 110.1 steps/s
[Step=42250 Epoch=403.5] | Loss=0.00019 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=16.897 | 2399.1 samples/s | 37.5 steps/s
[Step=42300 Epoch=403.9] | Loss=0.00018 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=16.897 | 6883.7 samples/s | 107.6 steps/s
[Step=42350 Epoch=404.4] | Loss=0.00019 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=16.897 | 2493.4 samples/s | 39.0 steps/s
[Step=42400 Epoch=404.9] | Loss=0.00019 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=16.897 | 6255.8 samples/s | 97.7 steps/s
[Step=42450 Epoch=405.4] | Loss=0.00019 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=16.897 | 2566.8 samples/s | 40.1 steps/s
[Step=42500 Epoch=405.8] | Loss=0.00018 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=16.898 | 5724.2 samples/s | 89.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=405.9] | Loss=0.00007 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=16.904 | 5716.0 samples/s | 89.3 steps/s
[Step=42550 Epoch=406.3] | Loss=0.00006 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=16.906 | 4143.8 samples/s | 64.7 steps/s
[Step=42600 Epoch=406.8] | Loss=0.00004 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.810 | L2-Norm(final)=16.908 | 6730.3 samples/s | 105.2 steps/s
[Step=42650 Epoch=407.3] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=16.909 | 2167.6 samples/s | 33.9 steps/s
[Step=42700 Epoch=407.8] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.796 | L2-Norm(final)=16.909 | 6196.4 samples/s | 96.8 steps/s
[Step=42750 Epoch=408.2] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.788 | L2-Norm(final)=16.910 | 2238.5 samples/s | 35.0 steps/s
[Step=42800 Epoch=408.7] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.780 | L2-Norm(final)=16.910 | 5754.0 samples/s | 89.9 steps/s
[Step=42850 Epoch=409.2] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.771 | L2-Norm(final)=16.911 | 2330.9 samples/s | 36.4 steps/s
[Step=42900 Epoch=409.7] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.763 | L2-Norm(final)=16.911 | 5345.9 samples/s | 83.5 steps/s
[Step=42950 Epoch=410.1] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.755 | L2-Norm(final)=16.912 | 2390.1 samples/s | 37.3 steps/s
[Step=43000 Epoch=410.6] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.746 | L2-Norm(final)=16.912 | 5052.2 samples/s | 78.9 steps/s
[Step=43050 Epoch=411.1] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=16.912 | 2436.9 samples/s | 38.1 steps/s
[Step=43100 Epoch=411.6] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.729 | L2-Norm(final)=16.913 | 4745.7 samples/s | 74.2 steps/s
[Step=43150 Epoch=412.1] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=16.913 | 2517.9 samples/s | 39.3 steps/s
[Step=43200 Epoch=412.5] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.712 | L2-Norm(final)=16.913 | 4608.0 samples/s | 72.0 steps/s
[Step=43250 Epoch=413.0] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.703 | L2-Norm(final)=16.914 | 2554.2 samples/s | 39.9 steps/s
[Step=43300 Epoch=413.5] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.695 | L2-Norm(final)=16.914 | 4639.8 samples/s | 72.5 steps/s
[Step=43350 Epoch=414.0] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.686 | L2-Norm(final)=16.914 | 2561.1 samples/s | 40.0 steps/s
[Step=43400 Epoch=414.4] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.677 | L2-Norm(final)=16.914 | 4657.3 samples/s | 72.8 steps/s
[Step=43450 Epoch=414.9] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=16.915 | 2555.0 samples/s | 39.9 steps/s
[Step=43500 Epoch=415.4] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.659 | L2-Norm(final)=16.915 | 4678.3 samples/s | 73.1 steps/s
[Step=43550 Epoch=415.9] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=16.915 | 7307.4 samples/s | 114.2 steps/s
[Step=43600 Epoch=416.4] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.641 | L2-Norm(final)=16.916 | 2137.8 samples/s | 33.4 steps/s
[Step=43650 Epoch=416.8] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.632 | L2-Norm(final)=16.916 | 6824.2 samples/s | 106.6 steps/s
[Step=43700 Epoch=417.3] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.623 | L2-Norm(final)=16.916 | 2198.3 samples/s | 34.3 steps/s
[Step=43750 Epoch=417.8] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.613 | L2-Norm(final)=16.917 | 6080.8 samples/s | 95.0 steps/s
[Step=43800 Epoch=418.3] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=16.917 | 2228.0 samples/s | 34.8 steps/s
[Step=43850 Epoch=418.7] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.595 | L2-Norm(final)=16.917 | 5773.6 samples/s | 90.2 steps/s
[Step=43900 Epoch=419.2] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.585 | L2-Norm(final)=16.917 | 2316.1 samples/s | 36.2 steps/s
[Step=43950 Epoch=419.7] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=16.918 | 5324.4 samples/s | 83.2 steps/s
[Step=44000 Epoch=420.2] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.566 | L2-Norm(final)=16.918 | 2381.5 samples/s | 37.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step44000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=40001 Epoch=376.9] | Loss=0.00145 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=16.468 | 5765.1 samples/s | 90.1 steps/s
[Step=40050 Epoch=377.4] | Loss=0.00024 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=16.470 | 4485.4 samples/s | 70.1 steps/s
[Step=40100 Epoch=377.9] | Loss=0.00023 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=16.472 | 8270.6 samples/s | 129.2 steps/s
[Step=40150 Epoch=378.3] | Loss=0.00024 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=16.474 | 2349.3 samples/s | 36.7 steps/s
[Step=40200 Epoch=378.8] | Loss=0.00024 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=16.477 | 7131.9 samples/s | 111.4 steps/s
[Step=40250 Epoch=379.3] | Loss=0.00023 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=16.478 | 2450.0 samples/s | 38.3 steps/s
[Step=40300 Epoch=379.7] | Loss=0.00022 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=16.480 | 6353.5 samples/s | 99.3 steps/s
[Step=40350 Epoch=380.2] | Loss=0.00024 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=16.482 | 2603.8 samples/s | 40.7 steps/s
[Step=40400 Epoch=380.7] | Loss=0.00023 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=16.484 | 5596.6 samples/s | 87.4 steps/s
[Step=40450 Epoch=381.2] | Loss=0.00023 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=16.486 | 2723.5 samples/s | 42.6 steps/s
[Step=40500 Epoch=381.6] | Loss=0.00023 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=16.488 | 5239.3 samples/s | 81.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=381.6] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.814 | L2-Norm(final)=16.505 | 5482.0 samples/s | 85.7 steps/s
[Step=40550 Epoch=382.1] | Loss=0.00010 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=16.507 | 4259.8 samples/s | 66.6 steps/s
[Step=40600 Epoch=382.6] | Loss=0.00008 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.817 | L2-Norm(final)=16.509 | 6636.8 samples/s | 103.7 steps/s
[Step=40650 Epoch=383.0] | Loss=0.00006 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=16.510 | 2219.2 samples/s | 34.7 steps/s
[Step=40700 Epoch=383.5] | Loss=0.00005 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=16.511 | 5842.5 samples/s | 91.3 steps/s
[Step=40750 Epoch=384.0] | Loss=0.00004 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.811 | L2-Norm(final)=16.512 | 2315.2 samples/s | 36.2 steps/s
[Step=40800 Epoch=384.5] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.808 | L2-Norm(final)=16.512 | 5244.3 samples/s | 81.9 steps/s
[Step=40850 Epoch=384.9] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.805 | L2-Norm(final)=16.513 | 2397.5 samples/s | 37.5 steps/s
[Step=40900 Epoch=385.4] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.801 | L2-Norm(final)=16.513 | 4900.5 samples/s | 76.6 steps/s
[Step=40950 Epoch=385.9] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.798 | L2-Norm(final)=16.514 | 2527.3 samples/s | 39.5 steps/s
[Step=41000 Epoch=386.3] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.794 | L2-Norm(final)=16.514 | 4604.2 samples/s | 71.9 steps/s
[Step=41050 Epoch=386.8] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.791 | L2-Norm(final)=16.515 | 2568.7 samples/s | 40.1 steps/s
[Step=41100 Epoch=387.3] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.787 | L2-Norm(final)=16.515 | 4631.6 samples/s | 72.4 steps/s
[Step=41150 Epoch=387.8] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.783 | L2-Norm(final)=16.515 | 2579.2 samples/s | 40.3 steps/s
[Step=41200 Epoch=388.2] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.779 | L2-Norm(final)=16.516 | 4740.7 samples/s | 74.1 steps/s
[Step=41250 Epoch=388.7] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.776 | L2-Norm(final)=16.516 | 2898.5 samples/s | 45.3 steps/s
[Step=41300 Epoch=389.2] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.772 | L2-Norm(final)=16.516 | 3805.4 samples/s | 59.5 steps/s
[Step=41350 Epoch=389.6] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=16.517 | 6790.4 samples/s | 106.1 steps/s
[Step=41400 Epoch=390.1] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.764 | L2-Norm(final)=16.517 | 2188.8 samples/s | 34.2 steps/s
[Step=41450 Epoch=390.6] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.760 | L2-Norm(final)=16.517 | 5984.2 samples/s | 93.5 steps/s
[Step=41500 Epoch=391.0] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.755 | L2-Norm(final)=16.518 | 2292.1 samples/s | 35.8 steps/s
[Step=41550 Epoch=391.5] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.751 | L2-Norm(final)=16.518 | 5358.4 samples/s | 83.7 steps/s
[Step=41600 Epoch=392.0] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=16.518 | 2377.7 samples/s | 37.2 steps/s
[Step=41650 Epoch=392.5] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.743 | L2-Norm(final)=16.518 | 4975.5 samples/s | 77.7 steps/s
[Step=41700 Epoch=392.9] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=16.519 | 2497.2 samples/s | 39.0 steps/s
[Step=41750 Epoch=393.4] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.734 | L2-Norm(final)=16.519 | 4636.6 samples/s | 72.4 steps/s
[Step=41800 Epoch=393.9] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.730 | L2-Norm(final)=16.519 | 2581.6 samples/s | 40.3 steps/s
[Step=41850 Epoch=394.3] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.725 | L2-Norm(final)=16.520 | 4626.7 samples/s | 72.3 steps/s
[Step=41900 Epoch=394.8] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.720 | L2-Norm(final)=16.520 | 2551.3 samples/s | 39.9 steps/s
[Step=41950 Epoch=395.3] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.716 | L2-Norm(final)=16.520 | 4607.9 samples/s | 72.0 steps/s
[Step=42000 Epoch=395.8] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.711 | L2-Norm(final)=16.521 | 2642.4 samples/s | 41.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step42000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07591 | acc=0.9634 | tpr=0.9715 | fpr=0.0540 | 5402.5 samples/s | 21.1 steps/s
Avg test loss: 0.08438, Avg test acc: 0.96166, Avg tpr: 0.97080, Avg fpr: 0.05845, total FA: 456

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08525 | acc=0.9644 | tpr=0.9832 | fpr=0.0766 | 5747.5 samples/s | 22.5 steps/s
Avg test loss: 0.09150, Avg test acc: 0.96330, Avg tpr: 0.98205, Avg fpr: 0.07794, total FA: 608

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08366 | acc=0.9648 | tpr=0.9822 | fpr=0.0728 | 5814.4 samples/s | 22.7 steps/s
Avg test loss: 0.08995, Avg test acc: 0.96426, Avg tpr: 0.98065, Avg fpr: 0.07179, total FA: 560

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.07870 | acc=0.9641 | tpr=0.9756 | fpr=0.0607 | 5919.5 samples/s | 23.1 steps/s
Avg test loss: 0.08645, Avg test acc: 0.96394, Avg tpr: 0.97500, Avg fpr: 0.06038, total FA: 471

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08101 | acc=0.9650 | tpr=0.9743 | fpr=0.0553 | 5752.9 samples/s | 22.5 steps/s
Avg test loss: 0.09372, Avg test acc: 0.96330, Avg tpr: 0.97243, Avg fpr: 0.05679, total FA: 443

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.54022 | acc=0.2646 | tpr=0.0056 | fpr=0.1729 | 5401.3 samples/s | 21.1 steps/s
Avg test loss: 5.54969, Avg test acc: 0.26248, Avg tpr: 0.00571, Avg fpr: 0.17280, total FA: 1348

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.67896 | acc=0.2922 | tpr=0.0140 | fpr=0.1038 | 5542.4 samples/s | 21.6 steps/s
Avg test loss: 4.68757, Avg test acc: 0.29013, Avg tpr: 0.01451, Avg fpr: 0.10370, total FA: 809

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.28696 | acc=0.2377 | tpr=0.0138 | fpr=0.2760 | 5835.6 samples/s | 22.8 steps/s
Avg test loss: 5.29169, Avg test acc: 0.23768, Avg tpr: 0.01469, Avg fpr: 0.27189, total FA: 2121

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=6.25837 | acc=0.2311 | tpr=0.0089 | fpr=0.2864 | 5696.0 samples/s | 22.3 steps/s
Avg test loss: 6.26594, Avg test acc: 0.22955, Avg tpr: 0.00898, Avg fpr: 0.28535, total FA: 2226

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.54468 | acc=0.2359 | tpr=0.0073 | fpr=0.2678 | 5673.3 samples/s | 22.2 steps/s
Avg test loss: 5.55068, Avg test acc: 0.23548, Avg tpr: 0.00752, Avg fpr: 0.26317, total FA: 2053

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.02763 | acc=0.1592 | tpr=0.1903 | fpr=0.8413 | 5641.6 samples/s | 22.0 steps/s
[Step= 100] | Loss=4.98215 | acc=0.1609 | tpr=0.1770 | fpr=0.8394 | 7563.6 samples/s | 29.5 steps/s
[Step= 150] | Loss=4.99886 | acc=0.1599 | tpr=0.1772 | fpr=0.8404 | 7945.6 samples/s | 31.0 steps/s
[Step= 200] | Loss=4.99322 | acc=0.1600 | tpr=0.1770 | fpr=0.8403 | 7747.8 samples/s | 30.3 steps/s
[Step= 250] | Loss=4.99975 | acc=0.1604 | tpr=0.1782 | fpr=0.8399 | 8434.0 samples/s | 32.9 steps/s
[Step= 300] | Loss=5.00426 | acc=0.1598 | tpr=0.1825 | fpr=0.8406 | 9029.4 samples/s | 35.3 steps/s
[Step= 350] | Loss=5.00620 | acc=0.1597 | tpr=0.1741 | fpr=0.8405 | 8377.6 samples/s | 32.7 steps/s
[Step= 400] | Loss=5.00486 | acc=0.1603 | tpr=0.1789 | fpr=0.8400 | 7429.0 samples/s | 29.0 steps/s
[Step= 450] | Loss=5.00386 | acc=0.1607 | tpr=0.1772 | fpr=0.8396 | 7821.0 samples/s | 30.6 steps/s
[Step= 500] | Loss=5.00664 | acc=0.1605 | tpr=0.1802 | fpr=0.8399 | 8381.8 samples/s | 32.7 steps/s
[Step= 550] | Loss=5.00445 | acc=0.1605 | tpr=0.1767 | fpr=0.8398 | 10382.5 samples/s | 40.6 steps/s
Avg test loss: 5.00408, Avg test acc: 0.16040, Avg tpr: 0.17710, Avg fpr: 0.83990, total FA: 116619

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.14771 | acc=0.1267 | tpr=0.2788 | fpr=0.8760 | 5239.6 samples/s | 20.5 steps/s
[Step= 100] | Loss=5.10349 | acc=0.1291 | tpr=0.2495 | fpr=0.8731 | 8131.6 samples/s | 31.8 steps/s
[Step= 150] | Loss=5.12017 | acc=0.1266 | tpr=0.2406 | fpr=0.8755 | 8777.3 samples/s | 34.3 steps/s
[Step= 200] | Loss=5.11658 | acc=0.1267 | tpr=0.2350 | fpr=0.8753 | 7860.2 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.12026 | acc=0.1265 | tpr=0.2306 | fpr=0.8754 | 8221.0 samples/s | 32.1 steps/s
[Step= 300] | Loss=5.12399 | acc=0.1257 | tpr=0.2320 | fpr=0.8762 | 7727.9 samples/s | 30.2 steps/s
[Step= 350] | Loss=5.12656 | acc=0.1252 | tpr=0.2173 | fpr=0.8765 | 7823.7 samples/s | 30.6 steps/s
[Step= 400] | Loss=5.12531 | acc=0.1258 | tpr=0.2237 | fpr=0.8759 | 8191.1 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.12383 | acc=0.1261 | tpr=0.2210 | fpr=0.8756 | 8724.2 samples/s | 34.1 steps/s
[Step= 500] | Loss=5.12673 | acc=0.1262 | tpr=0.2251 | fpr=0.8756 | 7937.5 samples/s | 31.0 steps/s
[Step= 550] | Loss=5.12446 | acc=0.1265 | tpr=0.2240 | fpr=0.8753 | 11073.6 samples/s | 43.3 steps/s
Avg test loss: 5.12463, Avg test acc: 0.12644, Avg tpr: 0.22385, Avg fpr: 0.87533, total FA: 121538

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.05612 | acc=0.1222 | tpr=0.1593 | fpr=0.8785 | 5711.8 samples/s | 22.3 steps/s
[Step= 100] | Loss=6.00852 | acc=0.1238 | tpr=0.1471 | fpr=0.8766 | 7960.9 samples/s | 31.1 steps/s
[Step= 150] | Loss=6.02054 | acc=0.1230 | tpr=0.1484 | fpr=0.8775 | 7444.8 samples/s | 29.1 steps/s
[Step= 200] | Loss=6.01449 | acc=0.1232 | tpr=0.1432 | fpr=0.8772 | 7943.3 samples/s | 31.0 steps/s
[Step= 250] | Loss=6.01896 | acc=0.1232 | tpr=0.1424 | fpr=0.8772 | 7986.3 samples/s | 31.2 steps/s
[Step= 300] | Loss=6.02517 | acc=0.1226 | tpr=0.1455 | fpr=0.8778 | 8020.0 samples/s | 31.3 steps/s
[Step= 350] | Loss=6.02987 | acc=0.1219 | tpr=0.1384 | fpr=0.8784 | 8405.8 samples/s | 32.8 steps/s
[Step= 400] | Loss=6.02803 | acc=0.1223 | tpr=0.1450 | fpr=0.8781 | 8328.5 samples/s | 32.5 steps/s
[Step= 450] | Loss=6.02634 | acc=0.1226 | tpr=0.1446 | fpr=0.8778 | 7511.2 samples/s | 29.3 steps/s
[Step= 500] | Loss=6.02846 | acc=0.1224 | tpr=0.1467 | fpr=0.8781 | 8406.5 samples/s | 32.8 steps/s
[Step= 550] | Loss=6.02485 | acc=0.1226 | tpr=0.1468 | fpr=0.8778 | 11199.4 samples/s | 43.7 steps/s
Avg test loss: 6.02466, Avg test acc: 0.12254, Avg tpr: 0.14739, Avg fpr: 0.87791, total FA: 121896

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.13214 | acc=0.1510 | tpr=0.1947 | fpr=0.8498 | 5456.2 samples/s | 21.3 steps/s
[Step= 100] | Loss=5.08712 | acc=0.1520 | tpr=0.1770 | fpr=0.8485 | 7828.2 samples/s | 30.6 steps/s
[Step= 150] | Loss=5.10203 | acc=0.1508 | tpr=0.1758 | fpr=0.8497 | 8821.3 samples/s | 34.5 steps/s
[Step= 200] | Loss=5.09478 | acc=0.1508 | tpr=0.1705 | fpr=0.8496 | 7941.5 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.10046 | acc=0.1511 | tpr=0.1721 | fpr=0.8493 | 8574.2 samples/s | 33.5 steps/s
[Step= 300] | Loss=5.10687 | acc=0.1503 | tpr=0.1745 | fpr=0.8502 | 7874.1 samples/s | 30.8 steps/s
[Step= 350] | Loss=5.10815 | acc=0.1499 | tpr=0.1691 | fpr=0.8504 | 7799.5 samples/s | 30.5 steps/s
[Step= 400] | Loss=5.10738 | acc=0.1503 | tpr=0.1761 | fpr=0.8502 | 7709.0 samples/s | 30.1 steps/s
[Step= 450] | Loss=5.10640 | acc=0.1506 | tpr=0.1738 | fpr=0.8499 | 8377.3 samples/s | 32.7 steps/s
[Step= 500] | Loss=5.10999 | acc=0.1504 | tpr=0.1749 | fpr=0.8500 | 7917.0 samples/s | 30.9 steps/s
[Step= 550] | Loss=5.10743 | acc=0.1507 | tpr=0.1767 | fpr=0.8498 | 10283.8 samples/s | 40.2 steps/s
Avg test loss: 5.10703, Avg test acc: 0.15057, Avg tpr: 0.17670, Avg fpr: 0.84990, total FA: 118007

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.89748 | acc=0.1415 | tpr=0.1239 | fpr=0.8582 | 5706.6 samples/s | 22.3 steps/s
[Step= 100] | Loss=5.84193 | acc=0.1431 | tpr=0.1173 | fpr=0.8564 | 8017.8 samples/s | 31.3 steps/s
[Step= 150] | Loss=5.85797 | acc=0.1425 | tpr=0.1153 | fpr=0.8570 | 7351.6 samples/s | 28.7 steps/s
[Step= 200] | Loss=5.85402 | acc=0.1426 | tpr=0.1115 | fpr=0.8568 | 8322.5 samples/s | 32.5 steps/s
[Step= 250] | Loss=5.86230 | acc=0.1427 | tpr=0.1127 | fpr=0.8568 | 7554.8 samples/s | 29.5 steps/s
[Step= 300] | Loss=5.86522 | acc=0.1423 | tpr=0.1135 | fpr=0.8572 | 8813.4 samples/s | 34.4 steps/s
[Step= 350] | Loss=5.86859 | acc=0.1418 | tpr=0.1096 | fpr=0.8576 | 7997.7 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.86717 | acc=0.1422 | tpr=0.1138 | fpr=0.8573 | 8275.0 samples/s | 32.3 steps/s
[Step= 450] | Loss=5.86630 | acc=0.1425 | tpr=0.1154 | fpr=0.8570 | 8087.9 samples/s | 31.6 steps/s
[Step= 500] | Loss=5.86978 | acc=0.1422 | tpr=0.1154 | fpr=0.8573 | 8036.1 samples/s | 31.4 steps/s
[Step= 550] | Loss=5.86616 | acc=0.1423 | tpr=0.1146 | fpr=0.8572 | 10519.6 samples/s | 41.1 steps/s
Avg test loss: 5.86593, Avg test acc: 0.14216, Avg tpr: 0.11529, Avg fpr: 0.85735, total FA: 119041

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10983 | acc=0.9807 | tpr=0.9248 | fpr=0.0183 | 5684.3 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.11107 | acc=0.9807 | tpr=0.9403 | fpr=0.0185 | 8480.0 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.11484 | acc=0.9804 | tpr=0.9467 | fpr=0.0190 | 8074.2 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.11684 | acc=0.9805 | tpr=0.9519 | fpr=0.0190 | 7925.4 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.11756 | acc=0.9803 | tpr=0.9476 | fpr=0.0191 | 7354.2 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.11904 | acc=0.9802 | tpr=0.9469 | fpr=0.0192 | 8095.8 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.11919 | acc=0.9802 | tpr=0.9505 | fpr=0.0193 | 8673.1 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.12019 | acc=0.9801 | tpr=0.9464 | fpr=0.0193 | 8436.1 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.12253 | acc=0.9797 | tpr=0.9445 | fpr=0.0197 | 7963.0 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.12156 | acc=0.9798 | tpr=0.9463 | fpr=0.0196 | 7964.6 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.12062 | acc=0.9799 | tpr=0.9463 | fpr=0.0195 | 9764.8 samples/s | 38.1 steps/s
Avg test loss: 0.12039, Avg test acc: 0.97994, Avg tpr: 0.94612, Avg fpr: 0.01945, total FA: 2700

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10387 | acc=0.9805 | tpr=0.9115 | fpr=0.0182 | 5679.4 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.10528 | acc=0.9802 | tpr=0.9254 | fpr=0.0188 | 8080.6 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.10871 | acc=0.9796 | tpr=0.9294 | fpr=0.0195 | 7328.3 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.11001 | acc=0.9796 | tpr=0.9322 | fpr=0.0195 | 8535.9 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.11062 | acc=0.9795 | tpr=0.9301 | fpr=0.0196 | 7655.4 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.11229 | acc=0.9793 | tpr=0.9302 | fpr=0.0198 | 8014.6 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.11237 | acc=0.9793 | tpr=0.9330 | fpr=0.0198 | 8470.4 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.11332 | acc=0.9792 | tpr=0.9289 | fpr=0.0199 | 8247.7 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.11518 | acc=0.9790 | tpr=0.9270 | fpr=0.0201 | 8103.9 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.11440 | acc=0.9791 | tpr=0.9291 | fpr=0.0200 | 8366.6 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.11336 | acc=0.9793 | tpr=0.9284 | fpr=0.0198 | 9702.8 samples/s | 37.9 steps/s
Avg test loss: 0.11314, Avg test acc: 0.97927, Avg tpr: 0.92789, Avg fpr: 0.01980, total FA: 2749

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11814 | acc=0.9782 | tpr=0.9381 | fpr=0.0211 | 5505.6 samples/s | 21.5 steps/s
[Step= 100] | Loss=0.11968 | acc=0.9787 | tpr=0.9574 | fpr=0.0209 | 8466.2 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.12431 | acc=0.9779 | tpr=0.9568 | fpr=0.0217 | 8090.5 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.12593 | acc=0.9780 | tpr=0.9607 | fpr=0.0216 | 7659.5 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.12695 | acc=0.9780 | tpr=0.9598 | fpr=0.0217 | 7625.7 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.12800 | acc=0.9779 | tpr=0.9593 | fpr=0.0218 | 9116.5 samples/s | 35.6 steps/s
[Step= 350] | Loss=0.12803 | acc=0.9778 | tpr=0.9618 | fpr=0.0219 | 7832.9 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.12886 | acc=0.9775 | tpr=0.9590 | fpr=0.0221 | 8632.0 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.13107 | acc=0.9772 | tpr=0.9567 | fpr=0.0224 | 8051.3 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.13030 | acc=0.9773 | tpr=0.9581 | fpr=0.0223 | 8044.6 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.12922 | acc=0.9775 | tpr=0.9570 | fpr=0.0222 | 9799.6 samples/s | 38.3 steps/s
Avg test loss: 0.12895, Avg test acc: 0.97748, Avg tpr: 0.95681, Avg fpr: 0.02215, total FA: 3075

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11212 | acc=0.9801 | tpr=0.9381 | fpr=0.0192 | 5702.8 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.11418 | acc=0.9799 | tpr=0.9446 | fpr=0.0194 | 7300.0 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.11701 | acc=0.9797 | tpr=0.9496 | fpr=0.0197 | 7989.1 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.11848 | acc=0.9798 | tpr=0.9530 | fpr=0.0197 | 8172.6 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.11948 | acc=0.9798 | tpr=0.9485 | fpr=0.0197 | 8588.9 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.12041 | acc=0.9796 | tpr=0.9476 | fpr=0.0198 | 7424.7 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.12029 | acc=0.9796 | tpr=0.9512 | fpr=0.0199 | 8631.7 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.12129 | acc=0.9795 | tpr=0.9475 | fpr=0.0199 | 8347.0 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.12349 | acc=0.9792 | tpr=0.9460 | fpr=0.0202 | 8149.9 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.12243 | acc=0.9793 | tpr=0.9476 | fpr=0.0201 | 7986.1 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.12165 | acc=0.9794 | tpr=0.9459 | fpr=0.0200 | 10839.7 samples/s | 42.3 steps/s
Avg test loss: 0.12141, Avg test acc: 0.97942, Avg tpr: 0.94572, Avg fpr: 0.01997, total FA: 2773

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10404 | acc=0.9810 | tpr=0.9336 | fpr=0.0181 | 5607.9 samples/s | 21.9 steps/s
[Step= 100] | Loss=0.10596 | acc=0.9809 | tpr=0.9424 | fpr=0.0184 | 8339.6 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.10930 | acc=0.9804 | tpr=0.9452 | fpr=0.0190 | 8472.5 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.11049 | acc=0.9804 | tpr=0.9497 | fpr=0.0191 | 7521.7 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.11163 | acc=0.9803 | tpr=0.9467 | fpr=0.0191 | 8104.5 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.11264 | acc=0.9803 | tpr=0.9476 | fpr=0.0191 | 7804.9 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.11258 | acc=0.9803 | tpr=0.9505 | fpr=0.0191 | 7805.9 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.11335 | acc=0.9803 | tpr=0.9464 | fpr=0.0191 | 8386.7 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.11541 | acc=0.9799 | tpr=0.9455 | fpr=0.0195 | 8133.0 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.11454 | acc=0.9801 | tpr=0.9476 | fpr=0.0194 | 8013.5 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.11368 | acc=0.9802 | tpr=0.9459 | fpr=0.0192 | 11027.7 samples/s | 43.1 steps/s
Avg test loss: 0.11349, Avg test acc: 0.98020, Avg tpr: 0.94572, Avg fpr: 0.01917, total FA: 2662

server round 43/50

clients selected: [0 1 3 6 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=34001 Epoch=165.8] | Loss=0.02205 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.749 | L2-Norm(final)=14.232 | 6297.4 samples/s | 98.4 steps/s
[Step=34050 Epoch=166.0] | Loss=0.01444 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.750 | L2-Norm(final)=14.234 | 4767.0 samples/s | 74.5 steps/s
[Step=34100 Epoch=166.3] | Loss=0.01443 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.750 | L2-Norm(final)=14.235 | 5627.7 samples/s | 87.9 steps/s
[Step=34150 Epoch=166.5] | Loss=0.01529 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=14.236 | 5661.2 samples/s | 88.5 steps/s
[Step=34200 Epoch=166.8] | Loss=0.01427 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.750 | L2-Norm(final)=14.237 | 8802.6 samples/s | 137.5 steps/s
[Step=34250 Epoch=167.0] | Loss=0.01403 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=14.238 | 2418.1 samples/s | 37.8 steps/s
[Step=34300 Epoch=167.3] | Loss=0.01355 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.750 | L2-Norm(final)=14.239 | 5627.5 samples/s | 87.9 steps/s
[Step=34350 Epoch=167.5] | Loss=0.01383 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.750 | L2-Norm(final)=14.240 | 5710.9 samples/s | 89.2 steps/s
[Step=34400 Epoch=167.7] | Loss=0.01404 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=14.241 | 7669.8 samples/s | 119.8 steps/s
[Step=34450 Epoch=168.0] | Loss=0.01423 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=14.242 | 2546.7 samples/s | 39.8 steps/s
[Step=34500 Epoch=168.2] | Loss=0.01422 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=14.243 | 5762.3 samples/s | 90.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=34501 Epoch=168.2] | Loss=0.02297 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.750 | L2-Norm(final)=14.250 | 5975.1 samples/s | 93.4 steps/s
[Step=34550 Epoch=168.5] | Loss=0.01320 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.755 | L2-Norm(final)=14.251 | 4392.5 samples/s | 68.6 steps/s
[Step=34600 Epoch=168.7] | Loss=0.01223 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.763 | L2-Norm(final)=14.252 | 4763.5 samples/s | 74.4 steps/s
[Step=34650 Epoch=169.0] | Loss=0.01273 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=14.254 | 4860.3 samples/s | 75.9 steps/s
[Step=34700 Epoch=169.2] | Loss=0.01180 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.773 | L2-Norm(final)=14.255 | 7041.2 samples/s | 110.0 steps/s
[Step=34750 Epoch=169.4] | Loss=0.01035 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.778 | L2-Norm(final)=14.257 | 2253.9 samples/s | 35.2 steps/s
[Step=34800 Epoch=169.7] | Loss=0.00951 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.781 | L2-Norm(final)=14.259 | 4867.4 samples/s | 76.1 steps/s
[Step=34850 Epoch=169.9] | Loss=0.00875 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.785 | L2-Norm(final)=14.261 | 4904.6 samples/s | 76.6 steps/s
[Step=34900 Epoch=170.2] | Loss=0.00825 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.788 | L2-Norm(final)=14.264 | 6280.8 samples/s | 98.1 steps/s
[Step=34950 Epoch=170.4] | Loss=0.00774 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.791 | L2-Norm(final)=14.266 | 2342.2 samples/s | 36.6 steps/s
[Step=35000 Epoch=170.7] | Loss=0.00742 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.794 | L2-Norm(final)=14.268 | 4865.1 samples/s | 76.0 steps/s
[Step=35050 Epoch=170.9] | Loss=0.00715 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.797 | L2-Norm(final)=14.270 | 4842.9 samples/s | 75.7 steps/s
[Step=35100 Epoch=171.2] | Loss=0.00683 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.800 | L2-Norm(final)=14.272 | 5798.7 samples/s | 90.6 steps/s
[Step=35150 Epoch=171.4] | Loss=0.00662 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.802 | L2-Norm(final)=14.274 | 2441.0 samples/s | 38.1 steps/s
[Step=35200 Epoch=171.6] | Loss=0.00637 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.805 | L2-Norm(final)=14.277 | 4866.7 samples/s | 76.0 steps/s
[Step=35250 Epoch=171.9] | Loss=0.00614 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.807 | L2-Norm(final)=14.279 | 4903.7 samples/s | 76.6 steps/s
[Step=35300 Epoch=172.1] | Loss=0.00604 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.810 | L2-Norm(final)=14.281 | 5314.0 samples/s | 83.0 steps/s
[Step=35350 Epoch=172.4] | Loss=0.00588 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.812 | L2-Norm(final)=14.283 | 2522.1 samples/s | 39.4 steps/s
[Step=35400 Epoch=172.6] | Loss=0.00573 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.814 | L2-Norm(final)=14.284 | 4893.2 samples/s | 76.5 steps/s
[Step=35450 Epoch=172.9] | Loss=0.00557 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=14.286 | 4748.6 samples/s | 74.2 steps/s
[Step=35500 Epoch=173.1] | Loss=0.00550 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.818 | L2-Norm(final)=14.288 | 5005.7 samples/s | 78.2 steps/s
[Step=35550 Epoch=173.3] | Loss=0.00559 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.820 | L2-Norm(final)=14.290 | 2628.8 samples/s | 41.1 steps/s
[Step=35600 Epoch=173.6] | Loss=0.00559 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.822 | L2-Norm(final)=14.292 | 4828.1 samples/s | 75.4 steps/s
[Step=35650 Epoch=173.8] | Loss=0.00557 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=14.293 | 4952.2 samples/s | 77.4 steps/s
[Step=35700 Epoch=174.1] | Loss=0.00550 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=14.295 | 4915.8 samples/s | 76.8 steps/s
[Step=35750 Epoch=174.3] | Loss=0.00540 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.828 | L2-Norm(final)=14.296 | 2635.9 samples/s | 41.2 steps/s
[Step=35800 Epoch=174.6] | Loss=0.00532 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.830 | L2-Norm(final)=14.298 | 4777.2 samples/s | 74.6 steps/s
[Step=35850 Epoch=174.8] | Loss=0.00524 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.831 | L2-Norm(final)=14.299 | 4880.9 samples/s | 76.3 steps/s
[Step=35900 Epoch=175.1] | Loss=0.00512 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.833 | L2-Norm(final)=14.300 | 4837.4 samples/s | 75.6 steps/s
[Step=35950 Epoch=175.3] | Loss=0.00508 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.835 | L2-Norm(final)=14.302 | 2646.0 samples/s | 41.3 steps/s
[Step=36000 Epoch=175.5] | Loss=0.00500 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.836 | L2-Norm(final)=14.303 | 4880.4 samples/s | 76.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step36000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=54001 Epoch=263.5] | Loss=0.01476 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.749 | L2-Norm(final)=15.923 | 6107.8 samples/s | 95.4 steps/s
[Step=54050 Epoch=263.7] | Loss=0.01277 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=15.925 | 4853.7 samples/s | 75.8 steps/s
[Step=54100 Epoch=264.0] | Loss=0.01216 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.750 | L2-Norm(final)=15.926 | 5530.1 samples/s | 86.4 steps/s
[Step=54150 Epoch=264.2] | Loss=0.01172 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.750 | L2-Norm(final)=15.926 | 5623.4 samples/s | 87.9 steps/s
[Step=54200 Epoch=264.5] | Loss=0.01295 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.750 | L2-Norm(final)=15.927 | 8753.2 samples/s | 136.8 steps/s
[Step=54250 Epoch=264.7] | Loss=0.01320 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=15.928 | 2429.7 samples/s | 38.0 steps/s
[Step=54300 Epoch=265.0] | Loss=0.01332 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=15.928 | 5521.4 samples/s | 86.3 steps/s
[Step=54350 Epoch=265.2] | Loss=0.01296 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.750 | L2-Norm(final)=15.929 | 5680.3 samples/s | 88.8 steps/s
[Step=54400 Epoch=265.4] | Loss=0.01291 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=15.930 | 7865.3 samples/s | 122.9 steps/s
[Step=54450 Epoch=265.7] | Loss=0.01302 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=15.930 | 2484.6 samples/s | 38.8 steps/s
[Step=54500 Epoch=265.9] | Loss=0.01309 | Reg=0.00095 | acc=0.9531 | L2-Norm=9.750 | L2-Norm(final)=15.931 | 5639.6 samples/s | 88.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=54501 Epoch=265.9] | Loss=0.01028 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.750 | L2-Norm(final)=15.937 | 5794.1 samples/s | 90.5 steps/s
[Step=54550 Epoch=266.2] | Loss=0.01519 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.754 | L2-Norm(final)=15.936 | 4368.9 samples/s | 68.3 steps/s
[Step=54600 Epoch=266.4] | Loss=0.01336 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.760 | L2-Norm(final)=15.937 | 4843.4 samples/s | 75.7 steps/s
[Step=54650 Epoch=266.7] | Loss=0.01202 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.764 | L2-Norm(final)=15.937 | 4862.0 samples/s | 76.0 steps/s
[Step=54700 Epoch=266.9] | Loss=0.01079 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=15.939 | 7010.4 samples/s | 109.5 steps/s
[Step=54750 Epoch=267.2] | Loss=0.00956 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.772 | L2-Norm(final)=15.940 | 2260.4 samples/s | 35.3 steps/s
[Step=54800 Epoch=267.4] | Loss=0.00875 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.775 | L2-Norm(final)=15.942 | 4833.4 samples/s | 75.5 steps/s
[Step=54850 Epoch=267.6] | Loss=0.00797 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.778 | L2-Norm(final)=15.944 | 4918.9 samples/s | 76.9 steps/s
[Step=54900 Epoch=267.9] | Loss=0.00753 | Reg=0.00096 | acc=0.9688 | L2-Norm=9.781 | L2-Norm(final)=15.946 | 6386.6 samples/s | 99.8 steps/s
[Step=54950 Epoch=268.1] | Loss=0.00715 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.783 | L2-Norm(final)=15.947 | 2326.4 samples/s | 36.4 steps/s
[Step=55000 Epoch=268.4] | Loss=0.00675 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.786 | L2-Norm(final)=15.949 | 4801.4 samples/s | 75.0 steps/s
[Step=55050 Epoch=268.6] | Loss=0.00645 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.788 | L2-Norm(final)=15.951 | 4865.9 samples/s | 76.0 steps/s
[Step=55100 Epoch=268.9] | Loss=0.00620 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.790 | L2-Norm(final)=15.953 | 6033.8 samples/s | 94.3 steps/s
[Step=55150 Epoch=269.1] | Loss=0.00603 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.793 | L2-Norm(final)=15.954 | 2381.7 samples/s | 37.2 steps/s
[Step=55200 Epoch=269.4] | Loss=0.00578 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.795 | L2-Norm(final)=15.956 | 4852.7 samples/s | 75.8 steps/s
[Step=55250 Epoch=269.6] | Loss=0.00561 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.797 | L2-Norm(final)=15.957 | 4845.5 samples/s | 75.7 steps/s
[Step=55300 Epoch=269.8] | Loss=0.00542 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.798 | L2-Norm(final)=15.959 | 5598.2 samples/s | 87.5 steps/s
[Step=55350 Epoch=270.1] | Loss=0.00525 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.800 | L2-Norm(final)=15.961 | 2468.0 samples/s | 38.6 steps/s
[Step=55400 Epoch=270.3] | Loss=0.00510 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.802 | L2-Norm(final)=15.962 | 4806.5 samples/s | 75.1 steps/s
[Step=55450 Epoch=270.6] | Loss=0.00498 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.804 | L2-Norm(final)=15.963 | 4907.0 samples/s | 76.7 steps/s
[Step=55500 Epoch=270.8] | Loss=0.00489 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.805 | L2-Norm(final)=15.965 | 5205.3 samples/s | 81.3 steps/s
[Step=55550 Epoch=271.1] | Loss=0.00479 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.807 | L2-Norm(final)=15.966 | 2547.7 samples/s | 39.8 steps/s
[Step=55600 Epoch=271.3] | Loss=0.00466 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.808 | L2-Norm(final)=15.968 | 4955.1 samples/s | 77.4 steps/s
[Step=55650 Epoch=271.5] | Loss=0.00455 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.810 | L2-Norm(final)=15.969 | 4737.9 samples/s | 74.0 steps/s
[Step=55700 Epoch=271.8] | Loss=0.00452 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.811 | L2-Norm(final)=15.971 | 4957.9 samples/s | 77.5 steps/s
[Step=55750 Epoch=272.0] | Loss=0.00443 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=15.972 | 2611.5 samples/s | 40.8 steps/s
[Step=55800 Epoch=272.3] | Loss=0.00434 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.814 | L2-Norm(final)=15.973 | 4881.9 samples/s | 76.3 steps/s
[Step=55850 Epoch=272.5] | Loss=0.00427 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=15.975 | 4852.3 samples/s | 75.8 steps/s
[Step=55900 Epoch=272.8] | Loss=0.00422 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.817 | L2-Norm(final)=15.976 | 4836.8 samples/s | 75.6 steps/s
[Step=55950 Epoch=273.0] | Loss=0.00416 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.819 | L2-Norm(final)=15.977 | 2658.3 samples/s | 41.5 steps/s
[Step=56000 Epoch=273.3] | Loss=0.00409 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.820 | L2-Norm(final)=15.979 | 4806.1 samples/s | 75.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step56000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=48001 Epoch=234.1] | Loss=0.01042 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.749 | L2-Norm(final)=15.444 | 5655.3 samples/s | 88.4 steps/s
[Step=48050 Epoch=234.3] | Loss=0.01623 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.750 | L2-Norm(final)=15.445 | 4723.0 samples/s | 73.8 steps/s
[Step=48100 Epoch=234.6] | Loss=0.01460 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.750 | L2-Norm(final)=15.445 | 5703.4 samples/s | 89.1 steps/s
[Step=48150 Epoch=234.8] | Loss=0.01398 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=15.446 | 5541.1 samples/s | 86.6 steps/s
[Step=48200 Epoch=235.1] | Loss=0.01427 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=15.447 | 8777.5 samples/s | 137.1 steps/s
[Step=48250 Epoch=235.3] | Loss=0.01485 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.750 | L2-Norm(final)=15.448 | 2440.2 samples/s | 38.1 steps/s
[Step=48300 Epoch=235.5] | Loss=0.01450 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=15.449 | 5657.3 samples/s | 88.4 steps/s
[Step=48350 Epoch=235.8] | Loss=0.01401 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.750 | L2-Norm(final)=15.449 | 5747.2 samples/s | 89.8 steps/s
[Step=48400 Epoch=236.0] | Loss=0.01409 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.750 | L2-Norm(final)=15.450 | 7554.7 samples/s | 118.0 steps/s
[Step=48450 Epoch=236.3] | Loss=0.01424 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.750 | L2-Norm(final)=15.451 | 2522.0 samples/s | 39.4 steps/s
[Step=48500 Epoch=236.5] | Loss=0.01441 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.750 | L2-Norm(final)=15.452 | 5613.4 samples/s | 87.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=48501 Epoch=236.5] | Loss=0.00678 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=15.460 | 6015.8 samples/s | 94.0 steps/s
[Step=48550 Epoch=236.8] | Loss=0.01287 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.754 | L2-Norm(final)=15.461 | 4277.2 samples/s | 66.8 steps/s
[Step=48600 Epoch=237.0] | Loss=0.01274 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.759 | L2-Norm(final)=15.461 | 4873.1 samples/s | 76.1 steps/s
[Step=48650 Epoch=237.2] | Loss=0.01196 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.763 | L2-Norm(final)=15.461 | 4868.4 samples/s | 76.1 steps/s
[Step=48700 Epoch=237.5] | Loss=0.01094 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=15.463 | 6965.0 samples/s | 108.8 steps/s
[Step=48750 Epoch=237.7] | Loss=0.00973 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.771 | L2-Norm(final)=15.464 | 2276.4 samples/s | 35.6 steps/s
[Step=48800 Epoch=238.0] | Loss=0.00883 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.775 | L2-Norm(final)=15.465 | 4872.3 samples/s | 76.1 steps/s
[Step=48850 Epoch=238.2] | Loss=0.00824 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.778 | L2-Norm(final)=15.467 | 4813.5 samples/s | 75.2 steps/s
[Step=48900 Epoch=238.5] | Loss=0.00774 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.781 | L2-Norm(final)=15.469 | 6382.6 samples/s | 99.7 steps/s
[Step=48950 Epoch=238.7] | Loss=0.00726 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.783 | L2-Norm(final)=15.470 | 2350.5 samples/s | 36.7 steps/s
[Step=49000 Epoch=239.0] | Loss=0.00692 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.786 | L2-Norm(final)=15.472 | 4840.6 samples/s | 75.6 steps/s
[Step=49050 Epoch=239.2] | Loss=0.00658 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.788 | L2-Norm(final)=15.473 | 4843.8 samples/s | 75.7 steps/s
[Step=49100 Epoch=239.4] | Loss=0.00629 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.790 | L2-Norm(final)=15.475 | 5829.5 samples/s | 91.1 steps/s
[Step=49150 Epoch=239.7] | Loss=0.00608 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.793 | L2-Norm(final)=15.477 | 2389.2 samples/s | 37.3 steps/s
[Step=49200 Epoch=239.9] | Loss=0.00578 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.795 | L2-Norm(final)=15.478 | 4847.5 samples/s | 75.7 steps/s
[Step=49250 Epoch=240.2] | Loss=0.00559 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.797 | L2-Norm(final)=15.480 | 4968.8 samples/s | 77.6 steps/s
[Step=49300 Epoch=240.4] | Loss=0.00540 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.799 | L2-Norm(final)=15.481 | 5278.9 samples/s | 82.5 steps/s
[Step=49350 Epoch=240.7] | Loss=0.00526 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.801 | L2-Norm(final)=15.483 | 2523.7 samples/s | 39.4 steps/s
[Step=49400 Epoch=240.9] | Loss=0.00511 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=15.484 | 4909.9 samples/s | 76.7 steps/s
[Step=49450 Epoch=241.1] | Loss=0.00499 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.804 | L2-Norm(final)=15.486 | 4833.4 samples/s | 75.5 steps/s
[Step=49500 Epoch=241.4] | Loss=0.00485 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=15.487 | 4995.2 samples/s | 78.0 steps/s
[Step=49550 Epoch=241.6] | Loss=0.00477 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.808 | L2-Norm(final)=15.489 | 2598.8 samples/s | 40.6 steps/s
[Step=49600 Epoch=241.9] | Loss=0.00464 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.810 | L2-Norm(final)=15.490 | 4906.2 samples/s | 76.7 steps/s
[Step=49650 Epoch=242.1] | Loss=0.00459 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.811 | L2-Norm(final)=15.492 | 4841.4 samples/s | 75.6 steps/s
[Step=49700 Epoch=242.4] | Loss=0.00448 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=15.493 | 4902.1 samples/s | 76.6 steps/s
[Step=49750 Epoch=242.6] | Loss=0.00437 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=15.494 | 2654.3 samples/s | 41.5 steps/s
[Step=49800 Epoch=242.9] | Loss=0.00432 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.816 | L2-Norm(final)=15.496 | 4837.7 samples/s | 75.6 steps/s
[Step=49850 Epoch=243.1] | Loss=0.00425 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.818 | L2-Norm(final)=15.497 | 4898.5 samples/s | 76.5 steps/s
[Step=49900 Epoch=243.3] | Loss=0.00419 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.819 | L2-Norm(final)=15.499 | 4849.6 samples/s | 75.8 steps/s
[Step=49950 Epoch=243.6] | Loss=0.00411 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.821 | L2-Norm(final)=15.500 | 2633.4 samples/s | 41.1 steps/s
[Step=50000 Epoch=243.8] | Loss=0.00401 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.822 | L2-Norm(final)=15.501 | 4964.3 samples/s | 77.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step50000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=34001 Epoch=323.4] | Loss=0.00013 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.749 | L2-Norm(final)=15.750 | 5089.3 samples/s | 79.5 steps/s
[Step=34050 Epoch=323.9] | Loss=0.00041 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=15.757 | 4919.5 samples/s | 76.9 steps/s
[Step=34100 Epoch=324.4] | Loss=0.00049 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=15.768 | 8356.9 samples/s | 130.6 steps/s
[Step=34150 Epoch=324.9] | Loss=0.00047 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=15.778 | 2385.8 samples/s | 37.3 steps/s
[Step=34200 Epoch=325.3] | Loss=0.00047 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=15.787 | 7108.3 samples/s | 111.1 steps/s
[Step=34250 Epoch=325.8] | Loss=0.00045 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=15.796 | 2444.5 samples/s | 38.2 steps/s
[Step=34300 Epoch=326.3] | Loss=0.00045 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=15.804 | 6597.9 samples/s | 103.1 steps/s
[Step=34350 Epoch=326.8] | Loss=0.00047 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=15.812 | 2539.0 samples/s | 39.7 steps/s
[Step=34400 Epoch=327.2] | Loss=0.00046 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=15.820 | 5981.9 samples/s | 93.5 steps/s
[Step=34450 Epoch=327.7] | Loss=0.00046 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=15.827 | 2680.6 samples/s | 41.9 steps/s
[Step=34500 Epoch=328.2] | Loss=0.00046 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=15.835 | 5510.3 samples/s | 86.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=34501 Epoch=328.2] | Loss=0.00042 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=15.908 | 5708.9 samples/s | 89.2 steps/s
[Step=34550 Epoch=328.7] | Loss=0.00011 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.752 | L2-Norm(final)=15.912 | 4081.0 samples/s | 63.8 steps/s
[Step=34600 Epoch=329.1] | Loss=0.00010 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.752 | L2-Norm(final)=15.914 | 6715.9 samples/s | 104.9 steps/s
[Step=34650 Epoch=329.6] | Loss=0.00007 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.749 | L2-Norm(final)=15.916 | 2196.0 samples/s | 34.3 steps/s
[Step=34700 Epoch=330.1] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.744 | L2-Norm(final)=15.917 | 5957.0 samples/s | 93.1 steps/s
[Step=34750 Epoch=330.6] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=15.917 | 2264.3 samples/s | 35.4 steps/s
[Step=34800 Epoch=331.0] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.731 | L2-Norm(final)=15.918 | 5593.3 samples/s | 87.4 steps/s
[Step=34850 Epoch=331.5] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.725 | L2-Norm(final)=15.918 | 2346.5 samples/s | 36.7 steps/s
[Step=34900 Epoch=332.0] | Loss=0.00003 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.718 | L2-Norm(final)=15.919 | 5043.0 samples/s | 78.8 steps/s
[Step=34950 Epoch=332.5] | Loss=0.00003 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.711 | L2-Norm(final)=15.919 | 2451.9 samples/s | 38.3 steps/s
[Step=35000 Epoch=332.9] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.703 | L2-Norm(final)=15.920 | 4787.8 samples/s | 74.8 steps/s
[Step=35050 Epoch=333.4] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.696 | L2-Norm(final)=15.920 | 2531.0 samples/s | 39.5 steps/s
[Step=35100 Epoch=333.9] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.688 | L2-Norm(final)=15.920 | 4642.8 samples/s | 72.5 steps/s
[Step=35150 Epoch=334.4] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.681 | L2-Norm(final)=15.920 | 2576.7 samples/s | 40.3 steps/s
[Step=35200 Epoch=334.8] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.673 | L2-Norm(final)=15.921 | 4597.3 samples/s | 71.8 steps/s
[Step=35250 Epoch=335.3] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.665 | L2-Norm(final)=15.921 | 2562.8 samples/s | 40.0 steps/s
[Step=35300 Epoch=335.8] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.658 | L2-Norm(final)=15.921 | 4649.0 samples/s | 72.6 steps/s
[Step=35350 Epoch=336.3] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=15.922 | 2669.6 samples/s | 41.7 steps/s
[Step=35400 Epoch=336.7] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.642 | L2-Norm(final)=15.922 | 4294.2 samples/s | 67.1 steps/s
[Step=35450 Epoch=337.2] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.633 | L2-Norm(final)=15.922 | 6921.6 samples/s | 108.1 steps/s
[Step=35500 Epoch=337.7] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.625 | L2-Norm(final)=15.922 | 2158.6 samples/s | 33.7 steps/s
[Step=35550 Epoch=338.2] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.617 | L2-Norm(final)=15.923 | 6329.1 samples/s | 98.9 steps/s
[Step=35600 Epoch=338.6] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.608 | L2-Norm(final)=15.923 | 1721.8 samples/s | 26.9 steps/s
[Step=35650 Epoch=339.1] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.600 | L2-Norm(final)=15.923 | 5643.8 samples/s | 88.2 steps/s
[Step=35700 Epoch=339.6] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=15.923 | 2289.8 samples/s | 35.8 steps/s
[Step=35750 Epoch=340.1] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.583 | L2-Norm(final)=15.924 | 5276.2 samples/s | 82.4 steps/s
[Step=35800 Epoch=340.5] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.574 | L2-Norm(final)=15.924 | 2425.8 samples/s | 37.9 steps/s
[Step=35850 Epoch=341.0] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.565 | L2-Norm(final)=15.924 | 4912.2 samples/s | 76.8 steps/s
[Step=35900 Epoch=341.5] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.556 | L2-Norm(final)=15.925 | 2518.7 samples/s | 39.4 steps/s
[Step=35950 Epoch=342.0] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.547 | L2-Norm(final)=15.925 | 4655.4 samples/s | 72.7 steps/s
[Step=36000 Epoch=342.4] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.538 | L2-Norm(final)=15.925 | 2553.6 samples/s | 39.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step36000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=42001 Epoch=395.8] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.749 | L2-Norm(final)=16.530 | 5548.0 samples/s | 86.7 steps/s
[Step=42050 Epoch=396.2] | Loss=0.00029 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=16.533 | 4811.9 samples/s | 75.2 steps/s
[Step=42100 Epoch=396.7] | Loss=0.00025 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=16.537 | 8147.3 samples/s | 127.3 steps/s
[Step=42150 Epoch=397.2] | Loss=0.00027 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=16.541 | 2363.6 samples/s | 36.9 steps/s
[Step=42200 Epoch=397.6] | Loss=0.00026 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=16.546 | 7009.7 samples/s | 109.5 steps/s
[Step=42250 Epoch=398.1] | Loss=0.00025 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=16.550 | 2458.5 samples/s | 38.4 steps/s
[Step=42300 Epoch=398.6] | Loss=0.00025 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=16.554 | 6316.2 samples/s | 98.7 steps/s
[Step=42350 Epoch=399.1] | Loss=0.00024 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=16.557 | 2607.8 samples/s | 40.7 steps/s
[Step=42400 Epoch=399.5] | Loss=0.00025 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=16.561 | 5533.3 samples/s | 86.5 steps/s
[Step=42450 Epoch=400.0] | Loss=0.00024 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=16.565 | 2690.0 samples/s | 42.0 steps/s
[Step=42500 Epoch=400.5] | Loss=0.00025 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=16.568 | 5366.6 samples/s | 83.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=400.5] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=16.607 | 5884.8 samples/s | 92.0 steps/s
[Step=42550 Epoch=400.9] | Loss=0.00016 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.752 | L2-Norm(final)=16.611 | 4037.6 samples/s | 63.1 steps/s
[Step=42600 Epoch=401.4] | Loss=0.00010 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.753 | L2-Norm(final)=16.614 | 6650.6 samples/s | 103.9 steps/s
[Step=42650 Epoch=401.9] | Loss=0.00007 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=16.615 | 2225.6 samples/s | 34.8 steps/s
[Step=42700 Epoch=402.4] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=16.616 | 5925.9 samples/s | 92.6 steps/s
[Step=42750 Epoch=402.8] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.742 | L2-Norm(final)=16.616 | 2291.0 samples/s | 35.8 steps/s
[Step=42800 Epoch=403.3] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.737 | L2-Norm(final)=16.617 | 5283.4 samples/s | 82.6 steps/s
[Step=42850 Epoch=403.8] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.732 | L2-Norm(final)=16.617 | 2404.3 samples/s | 37.6 steps/s
[Step=42900 Epoch=404.2] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.727 | L2-Norm(final)=16.618 | 4852.1 samples/s | 75.8 steps/s
[Step=42950 Epoch=404.7] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=16.618 | 2509.4 samples/s | 39.2 steps/s
[Step=43000 Epoch=405.2] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.716 | L2-Norm(final)=16.618 | 4807.4 samples/s | 75.1 steps/s
[Step=43050 Epoch=405.7] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.710 | L2-Norm(final)=16.619 | 2541.6 samples/s | 39.7 steps/s
[Step=43100 Epoch=406.1] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.705 | L2-Norm(final)=16.619 | 4593.9 samples/s | 71.8 steps/s
[Step=43150 Epoch=406.6] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.699 | L2-Norm(final)=16.619 | 2561.3 samples/s | 40.0 steps/s
[Step=43200 Epoch=407.1] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.693 | L2-Norm(final)=16.619 | 4743.6 samples/s | 74.1 steps/s
[Step=43250 Epoch=407.5] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.688 | L2-Norm(final)=16.620 | 2832.4 samples/s | 44.3 steps/s
[Step=43300 Epoch=408.0] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=16.620 | 3948.5 samples/s | 61.7 steps/s
[Step=43350 Epoch=408.5] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.676 | L2-Norm(final)=16.620 | 6774.8 samples/s | 105.9 steps/s
[Step=43400 Epoch=409.0] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.670 | L2-Norm(final)=16.620 | 2208.7 samples/s | 34.5 steps/s
[Step=43450 Epoch=409.4] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=16.621 | 5917.9 samples/s | 92.5 steps/s
[Step=43500 Epoch=409.9] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.657 | L2-Norm(final)=16.621 | 2257.4 samples/s | 35.3 steps/s
[Step=43550 Epoch=410.4] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.651 | L2-Norm(final)=16.621 | 5435.6 samples/s | 84.9 steps/s
[Step=43600 Epoch=410.8] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.645 | L2-Norm(final)=16.622 | 2430.1 samples/s | 38.0 steps/s
[Step=43650 Epoch=411.3] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.638 | L2-Norm(final)=16.622 | 4814.8 samples/s | 75.2 steps/s
[Step=43700 Epoch=411.8] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.632 | L2-Norm(final)=16.622 | 2490.8 samples/s | 38.9 steps/s
[Step=43750 Epoch=412.2] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.625 | L2-Norm(final)=16.622 | 4589.1 samples/s | 71.7 steps/s
[Step=43800 Epoch=412.7] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.619 | L2-Norm(final)=16.623 | 2563.8 samples/s | 40.1 steps/s
[Step=43850 Epoch=413.2] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.612 | L2-Norm(final)=16.623 | 4698.4 samples/s | 73.4 steps/s
[Step=43900 Epoch=413.7] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.605 | L2-Norm(final)=16.623 | 2550.8 samples/s | 39.9 steps/s
[Step=43950 Epoch=414.1] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.599 | L2-Norm(final)=16.623 | 4675.6 samples/s | 73.1 steps/s
[Step=44000 Epoch=414.6] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.592 | L2-Norm(final)=16.624 | 2699.9 samples/s | 42.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step44000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07594 | acc=0.9642 | tpr=0.9715 | fpr=0.0515 | 5627.6 samples/s | 22.0 steps/s
Avg test loss: 0.08377, Avg test acc: 0.96218, Avg tpr: 0.97074, Avg fpr: 0.05666, total FA: 442

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07837 | acc=0.9662 | tpr=0.9767 | fpr=0.0567 | 5699.0 samples/s | 22.3 steps/s
Avg test loss: 0.08686, Avg test acc: 0.96466, Avg tpr: 0.97505, Avg fpr: 0.05820, total FA: 454

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08366 | acc=0.9648 | tpr=0.9822 | fpr=0.0728 | 5389.7 samples/s | 21.1 steps/s
Avg test loss: 0.08995, Avg test acc: 0.96426, Avg tpr: 0.98065, Avg fpr: 0.07179, total FA: 560

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.07843 | acc=0.9645 | tpr=0.9758 | fpr=0.0600 | 5594.9 samples/s | 21.9 steps/s
Avg test loss: 0.08625, Avg test acc: 0.96438, Avg tpr: 0.97575, Avg fpr: 0.06063, total FA: 473

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08101 | acc=0.9650 | tpr=0.9743 | fpr=0.0553 | 5780.9 samples/s | 22.6 steps/s
Avg test loss: 0.09372, Avg test acc: 0.96330, Avg tpr: 0.97243, Avg fpr: 0.05679, total FA: 443

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.54022 | acc=0.2646 | tpr=0.0056 | fpr=0.1729 | 5627.7 samples/s | 22.0 steps/s
Avg test loss: 5.54969, Avg test acc: 0.26248, Avg tpr: 0.00571, Avg fpr: 0.17280, total FA: 1348

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.68002 | acc=0.2977 | tpr=0.0160 | fpr=0.0907 | 5662.7 samples/s | 22.1 steps/s
Avg test loss: 4.68841, Avg test acc: 0.29526, Avg tpr: 0.01655, Avg fpr: 0.09178, total FA: 716

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.28696 | acc=0.2377 | tpr=0.0138 | fpr=0.2760 | 5645.2 samples/s | 22.1 steps/s
Avg test loss: 5.29169, Avg test acc: 0.23768, Avg tpr: 0.01469, Avg fpr: 0.27189, total FA: 2121

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=6.10100 | acc=0.2477 | tpr=0.0087 | fpr=0.2332 | 5617.6 samples/s | 21.9 steps/s
Avg test loss: 6.11341, Avg test acc: 0.24641, Avg tpr: 0.00868, Avg fpr: 0.23074, total FA: 1800

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.54468 | acc=0.2359 | tpr=0.0073 | fpr=0.2678 | 5611.6 samples/s | 21.9 steps/s
Avg test loss: 5.55068, Avg test acc: 0.23548, Avg tpr: 0.00752, Avg fpr: 0.26317, total FA: 2053

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.96433 | acc=0.1566 | tpr=0.2035 | fpr=0.8442 | 5720.8 samples/s | 22.3 steps/s
[Step= 100] | Loss=4.92097 | acc=0.1578 | tpr=0.1834 | fpr=0.8427 | 7890.9 samples/s | 30.8 steps/s
[Step= 150] | Loss=4.93939 | acc=0.1573 | tpr=0.1816 | fpr=0.8432 | 8060.0 samples/s | 31.5 steps/s
[Step= 200] | Loss=4.93339 | acc=0.1573 | tpr=0.1792 | fpr=0.8431 | 8190.7 samples/s | 32.0 steps/s
[Step= 250] | Loss=4.94030 | acc=0.1576 | tpr=0.1799 | fpr=0.8428 | 7223.8 samples/s | 28.2 steps/s
[Step= 300] | Loss=4.94460 | acc=0.1571 | tpr=0.1833 | fpr=0.8434 | 8547.7 samples/s | 33.4 steps/s
[Step= 350] | Loss=4.94686 | acc=0.1570 | tpr=0.1753 | fpr=0.8433 | 8387.2 samples/s | 32.8 steps/s
[Step= 400] | Loss=4.94572 | acc=0.1574 | tpr=0.1789 | fpr=0.8429 | 7981.5 samples/s | 31.2 steps/s
[Step= 450] | Loss=4.94490 | acc=0.1578 | tpr=0.1767 | fpr=0.8426 | 7963.4 samples/s | 31.1 steps/s
[Step= 500] | Loss=4.94814 | acc=0.1576 | tpr=0.1806 | fpr=0.8428 | 8606.2 samples/s | 33.6 steps/s
[Step= 550] | Loss=4.94627 | acc=0.1576 | tpr=0.1779 | fpr=0.8427 | 9660.4 samples/s | 37.7 steps/s
Avg test loss: 4.94588, Avg test acc: 0.15753, Avg tpr: 0.17789, Avg fpr: 0.84284, total FA: 117026

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.93948 | acc=0.1491 | tpr=0.2301 | fpr=0.8524 | 5611.7 samples/s | 21.9 steps/s
[Step= 100] | Loss=4.89333 | acc=0.1511 | tpr=0.2154 | fpr=0.8501 | 8018.0 samples/s | 31.3 steps/s
[Step= 150] | Loss=4.90913 | acc=0.1488 | tpr=0.2046 | fpr=0.8522 | 7790.1 samples/s | 30.4 steps/s
[Step= 200] | Loss=4.90536 | acc=0.1484 | tpr=0.1923 | fpr=0.8524 | 8413.7 samples/s | 32.9 steps/s
[Step= 250] | Loss=4.91073 | acc=0.1483 | tpr=0.1878 | fpr=0.8524 | 7852.6 samples/s | 30.7 steps/s
[Step= 300] | Loss=4.91252 | acc=0.1476 | tpr=0.1898 | fpr=0.8532 | 8191.2 samples/s | 32.0 steps/s
[Step= 350] | Loss=4.91506 | acc=0.1471 | tpr=0.1785 | fpr=0.8535 | 7679.5 samples/s | 30.0 steps/s
[Step= 400] | Loss=4.91455 | acc=0.1478 | tpr=0.1844 | fpr=0.8529 | 8206.1 samples/s | 32.1 steps/s
[Step= 450] | Loss=4.91306 | acc=0.1481 | tpr=0.1831 | fpr=0.8525 | 7619.6 samples/s | 29.8 steps/s
[Step= 500] | Loss=4.91644 | acc=0.1478 | tpr=0.1850 | fpr=0.8529 | 8547.7 samples/s | 33.4 steps/s
[Step= 550] | Loss=4.91438 | acc=0.1481 | tpr=0.1842 | fpr=0.8526 | 10894.8 samples/s | 42.6 steps/s
Avg test loss: 4.91454, Avg test acc: 0.14801, Avg tpr: 0.18423, Avg fpr: 0.85265, total FA: 118389

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.05612 | acc=0.1222 | tpr=0.1593 | fpr=0.8785 | 5707.3 samples/s | 22.3 steps/s
[Step= 100] | Loss=6.00852 | acc=0.1238 | tpr=0.1471 | fpr=0.8766 | 7331.6 samples/s | 28.6 steps/s
[Step= 150] | Loss=6.02054 | acc=0.1230 | tpr=0.1484 | fpr=0.8775 | 8287.3 samples/s | 32.4 steps/s
[Step= 200] | Loss=6.01449 | acc=0.1232 | tpr=0.1432 | fpr=0.8772 | 8429.7 samples/s | 32.9 steps/s
[Step= 250] | Loss=6.01896 | acc=0.1232 | tpr=0.1424 | fpr=0.8772 | 7753.6 samples/s | 30.3 steps/s
[Step= 300] | Loss=6.02517 | acc=0.1226 | tpr=0.1455 | fpr=0.8778 | 8415.4 samples/s | 32.9 steps/s
[Step= 350] | Loss=6.02987 | acc=0.1219 | tpr=0.1384 | fpr=0.8784 | 7693.3 samples/s | 30.1 steps/s
[Step= 400] | Loss=6.02803 | acc=0.1223 | tpr=0.1450 | fpr=0.8781 | 7741.1 samples/s | 30.2 steps/s
[Step= 450] | Loss=6.02634 | acc=0.1226 | tpr=0.1446 | fpr=0.8778 | 8338.8 samples/s | 32.6 steps/s
[Step= 500] | Loss=6.02846 | acc=0.1224 | tpr=0.1467 | fpr=0.8781 | 7867.9 samples/s | 30.7 steps/s
[Step= 550] | Loss=6.02485 | acc=0.1226 | tpr=0.1468 | fpr=0.8778 | 11518.2 samples/s | 45.0 steps/s
Avg test loss: 6.02466, Avg test acc: 0.12254, Avg tpr: 0.14739, Avg fpr: 0.87791, total FA: 121896

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.18815 | acc=0.1497 | tpr=0.1991 | fpr=0.8512 | 5732.1 samples/s | 22.4 steps/s
[Step= 100] | Loss=5.14377 | acc=0.1514 | tpr=0.1898 | fpr=0.8493 | 7973.8 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.15993 | acc=0.1503 | tpr=0.1844 | fpr=0.8503 | 7424.6 samples/s | 29.0 steps/s
[Step= 200] | Loss=5.15207 | acc=0.1506 | tpr=0.1814 | fpr=0.8499 | 8113.2 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.15766 | acc=0.1509 | tpr=0.1825 | fpr=0.8497 | 8532.0 samples/s | 33.3 steps/s
[Step= 300] | Loss=5.16404 | acc=0.1501 | tpr=0.1855 | fpr=0.8505 | 8176.3 samples/s | 31.9 steps/s
[Step= 350] | Loss=5.16577 | acc=0.1497 | tpr=0.1778 | fpr=0.8508 | 7866.4 samples/s | 30.7 steps/s
[Step= 400] | Loss=5.16492 | acc=0.1500 | tpr=0.1849 | fpr=0.8506 | 8176.3 samples/s | 31.9 steps/s
[Step= 450] | Loss=5.16376 | acc=0.1503 | tpr=0.1821 | fpr=0.8503 | 8496.3 samples/s | 33.2 steps/s
[Step= 500] | Loss=5.16718 | acc=0.1502 | tpr=0.1841 | fpr=0.8504 | 8290.8 samples/s | 32.4 steps/s
[Step= 550] | Loss=5.16430 | acc=0.1504 | tpr=0.1850 | fpr=0.8503 | 9576.5 samples/s | 37.4 steps/s
Avg test loss: 5.16397, Avg test acc: 0.15027, Avg tpr: 0.18502, Avg fpr: 0.85036, total FA: 118071

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.89748 | acc=0.1415 | tpr=0.1239 | fpr=0.8582 | 5724.9 samples/s | 22.4 steps/s
[Step= 100] | Loss=5.84193 | acc=0.1431 | tpr=0.1173 | fpr=0.8564 | 7400.3 samples/s | 28.9 steps/s
[Step= 150] | Loss=5.85797 | acc=0.1425 | tpr=0.1153 | fpr=0.8570 | 8091.1 samples/s | 31.6 steps/s
[Step= 200] | Loss=5.85402 | acc=0.1426 | tpr=0.1115 | fpr=0.8568 | 7720.8 samples/s | 30.2 steps/s
[Step= 250] | Loss=5.86230 | acc=0.1427 | tpr=0.1127 | fpr=0.8568 | 8410.9 samples/s | 32.9 steps/s
[Step= 300] | Loss=5.86522 | acc=0.1423 | tpr=0.1135 | fpr=0.8572 | 7577.6 samples/s | 29.6 steps/s
[Step= 350] | Loss=5.86859 | acc=0.1418 | tpr=0.1096 | fpr=0.8576 | 8225.5 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.86717 | acc=0.1422 | tpr=0.1138 | fpr=0.8573 | 8489.6 samples/s | 33.2 steps/s
[Step= 450] | Loss=5.86630 | acc=0.1425 | tpr=0.1154 | fpr=0.8570 | 7896.8 samples/s | 30.8 steps/s
[Step= 500] | Loss=5.86978 | acc=0.1422 | tpr=0.1154 | fpr=0.8573 | 8098.8 samples/s | 31.6 steps/s
[Step= 550] | Loss=5.86616 | acc=0.1423 | tpr=0.1146 | fpr=0.8572 | 11210.0 samples/s | 43.8 steps/s
Avg test loss: 5.86593, Avg test acc: 0.14216, Avg tpr: 0.11529, Avg fpr: 0.85735, total FA: 119041

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10983 | acc=0.9807 | tpr=0.9248 | fpr=0.0183 | 5636.0 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.11107 | acc=0.9807 | tpr=0.9403 | fpr=0.0185 | 8163.8 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.11484 | acc=0.9804 | tpr=0.9467 | fpr=0.0190 | 8255.1 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.11684 | acc=0.9805 | tpr=0.9519 | fpr=0.0190 | 7837.8 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.11756 | acc=0.9803 | tpr=0.9476 | fpr=0.0191 | 8283.9 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.11904 | acc=0.9802 | tpr=0.9469 | fpr=0.0192 | 7997.8 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.11919 | acc=0.9802 | tpr=0.9505 | fpr=0.0193 | 7524.1 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.12019 | acc=0.9801 | tpr=0.9464 | fpr=0.0193 | 7656.2 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.12253 | acc=0.9797 | tpr=0.9445 | fpr=0.0197 | 8281.1 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.12156 | acc=0.9798 | tpr=0.9463 | fpr=0.0196 | 8276.6 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.12062 | acc=0.9799 | tpr=0.9463 | fpr=0.0195 | 10813.9 samples/s | 42.2 steps/s
Avg test loss: 0.12039, Avg test acc: 0.97994, Avg tpr: 0.94612, Avg fpr: 0.01945, total FA: 2700

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10311 | acc=0.9800 | tpr=0.9071 | fpr=0.0187 | 5756.3 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.10474 | acc=0.9796 | tpr=0.9232 | fpr=0.0193 | 7902.8 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.10816 | acc=0.9791 | tpr=0.9308 | fpr=0.0200 | 7390.0 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.10936 | acc=0.9793 | tpr=0.9322 | fpr=0.0199 | 7602.2 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.11025 | acc=0.9792 | tpr=0.9301 | fpr=0.0199 | 8587.7 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.11192 | acc=0.9789 | tpr=0.9295 | fpr=0.0202 | 8830.4 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.11189 | acc=0.9789 | tpr=0.9317 | fpr=0.0203 | 7772.1 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.11282 | acc=0.9787 | tpr=0.9278 | fpr=0.0204 | 8242.3 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.11469 | acc=0.9786 | tpr=0.9260 | fpr=0.0205 | 8004.1 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.11385 | acc=0.9787 | tpr=0.9291 | fpr=0.0204 | 8420.6 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.11279 | acc=0.9789 | tpr=0.9288 | fpr=0.0202 | 10365.9 samples/s | 40.5 steps/s
Avg test loss: 0.11258, Avg test acc: 0.97889, Avg tpr: 0.92829, Avg fpr: 0.02019, total FA: 2804

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11814 | acc=0.9782 | tpr=0.9381 | fpr=0.0211 | 5609.2 samples/s | 21.9 steps/s
[Step= 100] | Loss=0.11968 | acc=0.9787 | tpr=0.9574 | fpr=0.0209 | 8126.5 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.12431 | acc=0.9779 | tpr=0.9568 | fpr=0.0217 | 7654.9 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.12593 | acc=0.9780 | tpr=0.9607 | fpr=0.0216 | 8457.2 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.12695 | acc=0.9780 | tpr=0.9598 | fpr=0.0217 | 8184.0 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.12800 | acc=0.9779 | tpr=0.9593 | fpr=0.0218 | 7845.4 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.12803 | acc=0.9778 | tpr=0.9618 | fpr=0.0219 | 7969.3 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.12886 | acc=0.9775 | tpr=0.9590 | fpr=0.0221 | 8199.0 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.13107 | acc=0.9772 | tpr=0.9567 | fpr=0.0224 | 8030.2 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.13030 | acc=0.9773 | tpr=0.9581 | fpr=0.0223 | 8412.9 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.12922 | acc=0.9775 | tpr=0.9570 | fpr=0.0222 | 9853.3 samples/s | 38.5 steps/s
Avg test loss: 0.12895, Avg test acc: 0.97748, Avg tpr: 0.95681, Avg fpr: 0.02215, total FA: 3075

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10198 | acc=0.9809 | tpr=0.9381 | fpr=0.0184 | 5574.7 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.10343 | acc=0.9809 | tpr=0.9446 | fpr=0.0184 | 8081.8 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.10574 | acc=0.9807 | tpr=0.9510 | fpr=0.0188 | 7653.3 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.10710 | acc=0.9807 | tpr=0.9541 | fpr=0.0188 | 8826.4 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.10806 | acc=0.9807 | tpr=0.9502 | fpr=0.0187 | 8446.0 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.10884 | acc=0.9806 | tpr=0.9505 | fpr=0.0189 | 7933.5 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.10878 | acc=0.9807 | tpr=0.9524 | fpr=0.0188 | 7874.9 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.10970 | acc=0.9805 | tpr=0.9486 | fpr=0.0189 | 8291.0 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.11167 | acc=0.9802 | tpr=0.9474 | fpr=0.0192 | 7970.6 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.11083 | acc=0.9804 | tpr=0.9489 | fpr=0.0191 | 7749.9 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.11004 | acc=0.9804 | tpr=0.9467 | fpr=0.0189 | 10633.8 samples/s | 41.5 steps/s
Avg test loss: 0.10983, Avg test acc: 0.98046, Avg tpr: 0.94651, Avg fpr: 0.01892, total FA: 2627

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10404 | acc=0.9810 | tpr=0.9336 | fpr=0.0181 | 5613.7 samples/s | 21.9 steps/s
[Step= 100] | Loss=0.10596 | acc=0.9809 | tpr=0.9424 | fpr=0.0184 | 8273.4 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.10930 | acc=0.9804 | tpr=0.9452 | fpr=0.0190 | 7641.5 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.11049 | acc=0.9804 | tpr=0.9497 | fpr=0.0191 | 7778.9 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.11163 | acc=0.9803 | tpr=0.9467 | fpr=0.0191 | 7815.9 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.11264 | acc=0.9803 | tpr=0.9476 | fpr=0.0191 | 8066.7 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.11258 | acc=0.9803 | tpr=0.9505 | fpr=0.0191 | 8446.0 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.11335 | acc=0.9803 | tpr=0.9464 | fpr=0.0191 | 8594.4 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.11541 | acc=0.9799 | tpr=0.9455 | fpr=0.0195 | 7864.4 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.11454 | acc=0.9801 | tpr=0.9476 | fpr=0.0194 | 7945.7 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.11368 | acc=0.9802 | tpr=0.9459 | fpr=0.0192 | 10789.2 samples/s | 42.1 steps/s
Avg test loss: 0.11349, Avg test acc: 0.98020, Avg tpr: 0.94572, Avg fpr: 0.01917, total FA: 2662

server round 44/50

clients selected: [2 3 4 6 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=48001 Epoch=233.9] | Loss=0.01522 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.668 | L2-Norm(final)=15.130 | 5913.9 samples/s | 92.4 steps/s
[Step=48050 Epoch=234.1] | Loss=0.01751 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.668 | L2-Norm(final)=15.131 | 4921.1 samples/s | 76.9 steps/s
[Step=48100 Epoch=234.4] | Loss=0.01594 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.668 | L2-Norm(final)=15.131 | 5838.5 samples/s | 91.2 steps/s
[Step=48150 Epoch=234.6] | Loss=0.01562 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.668 | L2-Norm(final)=15.131 | 5469.9 samples/s | 85.5 steps/s
[Step=48200 Epoch=234.9] | Loss=0.01529 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.131 | 8788.7 samples/s | 137.3 steps/s
[Step=48250 Epoch=235.1] | Loss=0.01469 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.668 | L2-Norm(final)=15.132 | 2426.5 samples/s | 37.9 steps/s
[Step=48300 Epoch=235.3] | Loss=0.01542 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.668 | L2-Norm(final)=15.133 | 5654.4 samples/s | 88.4 steps/s
[Step=48350 Epoch=235.6] | Loss=0.01559 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.133 | 5597.3 samples/s | 87.5 steps/s
[Step=48400 Epoch=235.8] | Loss=0.01534 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.668 | L2-Norm(final)=15.134 | 7820.6 samples/s | 122.2 steps/s
[Step=48450 Epoch=236.1] | Loss=0.01542 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.134 | 2518.7 samples/s | 39.4 steps/s
[Step=48500 Epoch=236.3] | Loss=0.01526 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.668 | L2-Norm(final)=15.134 | 5605.3 samples/s | 87.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=48501 Epoch=236.3] | Loss=0.00917 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.139 | 5928.4 samples/s | 92.6 steps/s
[Step=48550 Epoch=236.6] | Loss=0.01669 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.673 | L2-Norm(final)=15.137 | 4315.7 samples/s | 67.4 steps/s
[Step=48600 Epoch=236.8] | Loss=0.01557 | Reg=0.00094 | acc=0.9688 | L2-Norm=9.678 | L2-Norm(final)=15.138 | 4882.0 samples/s | 76.3 steps/s
[Step=48650 Epoch=237.0] | Loss=0.01336 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.683 | L2-Norm(final)=15.139 | 4875.1 samples/s | 76.2 steps/s
[Step=48700 Epoch=237.3] | Loss=0.01247 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.688 | L2-Norm(final)=15.140 | 6947.2 samples/s | 108.5 steps/s
[Step=48750 Epoch=237.5] | Loss=0.01098 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.692 | L2-Norm(final)=15.142 | 2267.7 samples/s | 35.4 steps/s
[Step=48800 Epoch=237.8] | Loss=0.00988 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.696 | L2-Norm(final)=15.144 | 4910.4 samples/s | 76.7 steps/s
[Step=48850 Epoch=238.0] | Loss=0.00922 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.699 | L2-Norm(final)=15.146 | 4895.4 samples/s | 76.5 steps/s
[Step=48900 Epoch=238.3] | Loss=0.00866 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.703 | L2-Norm(final)=15.148 | 6225.5 samples/s | 97.3 steps/s
[Step=48950 Epoch=238.5] | Loss=0.00813 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.706 | L2-Norm(final)=15.150 | 2352.0 samples/s | 36.7 steps/s
[Step=49000 Epoch=238.8] | Loss=0.00770 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.709 | L2-Norm(final)=15.153 | 4878.3 samples/s | 76.2 steps/s
[Step=49050 Epoch=239.0] | Loss=0.00737 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.711 | L2-Norm(final)=15.155 | 4829.1 samples/s | 75.5 steps/s
[Step=49100 Epoch=239.2] | Loss=0.00706 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.714 | L2-Norm(final)=15.157 | 5831.5 samples/s | 91.1 steps/s
[Step=49150 Epoch=239.5] | Loss=0.00675 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.717 | L2-Norm(final)=15.159 | 2407.6 samples/s | 37.6 steps/s
[Step=49200 Epoch=239.7] | Loss=0.00648 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.719 | L2-Norm(final)=15.161 | 4831.8 samples/s | 75.5 steps/s
[Step=49250 Epoch=240.0] | Loss=0.00629 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.722 | L2-Norm(final)=15.163 | 4865.8 samples/s | 76.0 steps/s
[Step=49300 Epoch=240.2] | Loss=0.00608 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.724 | L2-Norm(final)=15.165 | 5410.5 samples/s | 84.5 steps/s
[Step=49350 Epoch=240.5] | Loss=0.00594 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.727 | L2-Norm(final)=15.167 | 2514.1 samples/s | 39.3 steps/s
[Step=49400 Epoch=240.7] | Loss=0.00580 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.729 | L2-Norm(final)=15.169 | 4898.9 samples/s | 76.5 steps/s
[Step=49450 Epoch=240.9] | Loss=0.00566 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.731 | L2-Norm(final)=15.171 | 4865.0 samples/s | 76.0 steps/s
[Step=49500 Epoch=241.2] | Loss=0.00551 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.733 | L2-Norm(final)=15.173 | 4979.0 samples/s | 77.8 steps/s
[Step=49550 Epoch=241.4] | Loss=0.00538 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.735 | L2-Norm(final)=15.175 | 2610.2 samples/s | 40.8 steps/s
[Step=49600 Epoch=241.7] | Loss=0.00523 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.737 | L2-Norm(final)=15.176 | 4889.4 samples/s | 76.4 steps/s
[Step=49650 Epoch=241.9] | Loss=0.00514 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.739 | L2-Norm(final)=15.178 | 4777.9 samples/s | 74.7 steps/s
[Step=49700 Epoch=242.2] | Loss=0.00503 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.741 | L2-Norm(final)=15.180 | 4865.5 samples/s | 76.0 steps/s
[Step=49750 Epoch=242.4] | Loss=0.00492 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.743 | L2-Norm(final)=15.182 | 2676.1 samples/s | 41.8 steps/s
[Step=49800 Epoch=242.6] | Loss=0.00482 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.745 | L2-Norm(final)=15.184 | 4901.2 samples/s | 76.6 steps/s
[Step=49850 Epoch=242.9] | Loss=0.00475 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=15.185 | 4931.5 samples/s | 77.1 steps/s
[Step=49900 Epoch=243.1] | Loss=0.00467 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.749 | L2-Norm(final)=15.187 | 4714.7 samples/s | 73.7 steps/s
[Step=49950 Epoch=243.4] | Loss=0.00459 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.751 | L2-Norm(final)=15.189 | 2638.3 samples/s | 41.2 steps/s
[Step=50000 Epoch=243.6] | Loss=0.00450 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.752 | L2-Norm(final)=15.191 | 4873.5 samples/s | 76.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step50000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=50001 Epoch=243.8] | Loss=0.02193 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.668 | L2-Norm(final)=15.541 | 5281.3 samples/s | 82.5 steps/s
[Step=50050 Epoch=244.1] | Loss=0.01470 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.542 | 5119.9 samples/s | 80.0 steps/s
[Step=50100 Epoch=244.3] | Loss=0.01381 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.668 | L2-Norm(final)=15.543 | 5673.5 samples/s | 88.6 steps/s
[Step=50150 Epoch=244.6] | Loss=0.01351 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.545 | 5633.1 samples/s | 88.0 steps/s
[Step=50200 Epoch=244.8] | Loss=0.01388 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.668 | L2-Norm(final)=15.546 | 8684.9 samples/s | 135.7 steps/s
[Step=50250 Epoch=245.0] | Loss=0.01360 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.668 | L2-Norm(final)=15.547 | 2444.1 samples/s | 38.2 steps/s
[Step=50300 Epoch=245.3] | Loss=0.01330 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.549 | 5644.9 samples/s | 88.2 steps/s
[Step=50350 Epoch=245.5] | Loss=0.01377 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.550 | 5576.4 samples/s | 87.1 steps/s
[Step=50400 Epoch=245.8] | Loss=0.01366 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.551 | 7831.1 samples/s | 122.4 steps/s
[Step=50450 Epoch=246.0] | Loss=0.01383 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.552 | 2521.5 samples/s | 39.4 steps/s
[Step=50500 Epoch=246.3] | Loss=0.01379 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.553 | 5546.3 samples/s | 86.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=50501 Epoch=246.3] | Loss=0.00392 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.563 | 5621.4 samples/s | 87.8 steps/s
[Step=50550 Epoch=246.5] | Loss=0.01513 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.675 | L2-Norm(final)=15.563 | 4509.8 samples/s | 70.5 steps/s
[Step=50600 Epoch=246.8] | Loss=0.01291 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.681 | L2-Norm(final)=15.563 | 4904.8 samples/s | 76.6 steps/s
[Step=50650 Epoch=247.0] | Loss=0.01158 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.686 | L2-Norm(final)=15.564 | 4860.5 samples/s | 75.9 steps/s
[Step=50700 Epoch=247.2] | Loss=0.01087 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.691 | L2-Norm(final)=15.566 | 6913.5 samples/s | 108.0 steps/s
[Step=50750 Epoch=247.5] | Loss=0.00946 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.695 | L2-Norm(final)=15.567 | 2263.3 samples/s | 35.4 steps/s
[Step=50800 Epoch=247.7] | Loss=0.00861 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.698 | L2-Norm(final)=15.569 | 4880.1 samples/s | 76.3 steps/s
[Step=50850 Epoch=248.0] | Loss=0.00799 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.701 | L2-Norm(final)=15.571 | 4847.3 samples/s | 75.7 steps/s
[Step=50900 Epoch=248.2] | Loss=0.00759 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.704 | L2-Norm(final)=15.573 | 6341.4 samples/s | 99.1 steps/s
[Step=50950 Epoch=248.5] | Loss=0.00724 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.707 | L2-Norm(final)=15.574 | 2352.5 samples/s | 36.8 steps/s
[Step=51000 Epoch=248.7] | Loss=0.00679 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.709 | L2-Norm(final)=15.576 | 4795.4 samples/s | 74.9 steps/s
[Step=51050 Epoch=248.9] | Loss=0.00643 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.712 | L2-Norm(final)=15.577 | 4890.7 samples/s | 76.4 steps/s
[Step=51100 Epoch=249.2] | Loss=0.00626 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.714 | L2-Norm(final)=15.579 | 5796.4 samples/s | 90.6 steps/s
[Step=51150 Epoch=249.4] | Loss=0.00603 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.716 | L2-Norm(final)=15.581 | 2414.6 samples/s | 37.7 steps/s
[Step=51200 Epoch=249.7] | Loss=0.00581 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.718 | L2-Norm(final)=15.582 | 4913.9 samples/s | 76.8 steps/s
[Step=51250 Epoch=249.9] | Loss=0.00563 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.720 | L2-Norm(final)=15.584 | 4800.4 samples/s | 75.0 steps/s
[Step=51300 Epoch=250.2] | Loss=0.00548 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.722 | L2-Norm(final)=15.585 | 5390.2 samples/s | 84.2 steps/s
[Step=51350 Epoch=250.4] | Loss=0.00533 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.724 | L2-Norm(final)=15.587 | 2519.7 samples/s | 39.4 steps/s
[Step=51400 Epoch=250.7] | Loss=0.00515 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.726 | L2-Norm(final)=15.589 | 4914.2 samples/s | 76.8 steps/s
[Step=51450 Epoch=250.9] | Loss=0.00501 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.728 | L2-Norm(final)=15.590 | 4908.6 samples/s | 76.7 steps/s
[Step=51500 Epoch=251.1] | Loss=0.00492 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.730 | L2-Norm(final)=15.592 | 4881.9 samples/s | 76.3 steps/s
[Step=51550 Epoch=251.4] | Loss=0.00478 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.732 | L2-Norm(final)=15.593 | 2606.2 samples/s | 40.7 steps/s
[Step=51600 Epoch=251.6] | Loss=0.00468 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.734 | L2-Norm(final)=15.595 | 4820.1 samples/s | 75.3 steps/s
[Step=51650 Epoch=251.9] | Loss=0.00460 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.735 | L2-Norm(final)=15.596 | 4828.6 samples/s | 75.4 steps/s
[Step=51700 Epoch=252.1] | Loss=0.00453 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.737 | L2-Norm(final)=15.598 | 4868.2 samples/s | 76.1 steps/s
[Step=51750 Epoch=252.4] | Loss=0.00444 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.739 | L2-Norm(final)=15.599 | 2649.9 samples/s | 41.4 steps/s
[Step=51800 Epoch=252.6] | Loss=0.00436 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.740 | L2-Norm(final)=15.600 | 4828.1 samples/s | 75.4 steps/s
[Step=51850 Epoch=252.8] | Loss=0.00427 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.742 | L2-Norm(final)=15.602 | 4871.1 samples/s | 76.1 steps/s
[Step=51900 Epoch=253.1] | Loss=0.00419 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.743 | L2-Norm(final)=15.603 | 4837.9 samples/s | 75.6 steps/s
[Step=51950 Epoch=253.3] | Loss=0.00413 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.745 | L2-Norm(final)=15.605 | 2664.9 samples/s | 41.6 steps/s
[Step=52000 Epoch=253.6] | Loss=0.00409 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.746 | L2-Norm(final)=15.606 | 4836.5 samples/s | 75.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step52000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=52001 Epoch=255.0] | Loss=0.00190 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.909 | 5547.1 samples/s | 86.7 steps/s
[Step=52050 Epoch=255.2] | Loss=0.01822 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.908 | 5049.7 samples/s | 78.9 steps/s
[Step=52100 Epoch=255.5] | Loss=0.01634 | Reg=0.00093 | acc=0.9531 | L2-Norm=9.668 | L2-Norm(final)=15.907 | 5645.3 samples/s | 88.2 steps/s
[Step=52150 Epoch=255.7] | Loss=0.01585 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.907 | 5650.4 samples/s | 88.3 steps/s
[Step=52200 Epoch=256.0] | Loss=0.01483 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.908 | 8839.9 samples/s | 138.1 steps/s
[Step=52250 Epoch=256.2] | Loss=0.01556 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.908 | 2398.4 samples/s | 37.5 steps/s
[Step=52300 Epoch=256.5] | Loss=0.01550 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.908 | 5723.4 samples/s | 89.4 steps/s
[Step=52350 Epoch=256.7] | Loss=0.01526 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.668 | L2-Norm(final)=15.908 | 5535.2 samples/s | 86.5 steps/s
[Step=52400 Epoch=257.0] | Loss=0.01459 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.909 | 8342.3 samples/s | 130.3 steps/s
[Step=52450 Epoch=257.2] | Loss=0.01464 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.909 | 2454.1 samples/s | 38.3 steps/s
[Step=52500 Epoch=257.5] | Loss=0.01435 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.910 | 5737.4 samples/s | 89.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=52501 Epoch=257.5] | Loss=0.02604 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.668 | L2-Norm(final)=15.916 | 5822.0 samples/s | 91.0 steps/s
[Step=52550 Epoch=257.7] | Loss=0.01125 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.673 | L2-Norm(final)=15.917 | 4397.7 samples/s | 68.7 steps/s
[Step=52600 Epoch=257.9] | Loss=0.01100 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.678 | L2-Norm(final)=15.917 | 4862.9 samples/s | 76.0 steps/s
[Step=52650 Epoch=258.2] | Loss=0.01141 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=15.918 | 4873.6 samples/s | 76.2 steps/s
[Step=52700 Epoch=258.4] | Loss=0.01057 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.687 | L2-Norm(final)=15.920 | 7128.3 samples/s | 111.4 steps/s
[Step=52750 Epoch=258.7] | Loss=0.00934 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.691 | L2-Norm(final)=15.921 | 2252.4 samples/s | 35.2 steps/s
[Step=52800 Epoch=258.9] | Loss=0.00840 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.694 | L2-Norm(final)=15.923 | 4886.0 samples/s | 76.3 steps/s
[Step=52850 Epoch=259.2] | Loss=0.00776 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.698 | L2-Norm(final)=15.925 | 4846.9 samples/s | 75.7 steps/s
[Step=52900 Epoch=259.4] | Loss=0.00729 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.701 | L2-Norm(final)=15.927 | 6608.6 samples/s | 103.3 steps/s
[Step=52950 Epoch=259.7] | Loss=0.00687 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.704 | L2-Norm(final)=15.929 | 2293.7 samples/s | 35.8 steps/s
[Step=53000 Epoch=259.9] | Loss=0.00651 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.707 | L2-Norm(final)=15.931 | 4836.0 samples/s | 75.6 steps/s
[Step=53050 Epoch=260.1] | Loss=0.00623 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.709 | L2-Norm(final)=15.933 | 4901.7 samples/s | 76.6 steps/s
[Step=53100 Epoch=260.4] | Loss=0.00600 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.712 | L2-Norm(final)=15.935 | 6232.5 samples/s | 97.4 steps/s
[Step=53150 Epoch=260.6] | Loss=0.00572 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.714 | L2-Norm(final)=15.936 | 2307.8 samples/s | 36.1 steps/s
[Step=53200 Epoch=260.9] | Loss=0.00548 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.717 | L2-Norm(final)=15.938 | 4939.8 samples/s | 77.2 steps/s
[Step=53250 Epoch=261.1] | Loss=0.00529 | Reg=0.00094 | acc=0.9688 | L2-Norm=9.719 | L2-Norm(final)=15.940 | 4818.8 samples/s | 75.3 steps/s
[Step=53300 Epoch=261.4] | Loss=0.00513 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=15.942 | 5923.1 samples/s | 92.5 steps/s
[Step=53350 Epoch=261.6] | Loss=0.00507 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=15.943 | 2409.4 samples/s | 37.6 steps/s
[Step=53400 Epoch=261.9] | Loss=0.00492 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.725 | L2-Norm(final)=15.945 | 4853.8 samples/s | 75.8 steps/s
[Step=53450 Epoch=262.1] | Loss=0.00480 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.727 | L2-Norm(final)=15.947 | 4902.1 samples/s | 76.6 steps/s
[Step=53500 Epoch=262.4] | Loss=0.00470 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.729 | L2-Norm(final)=15.948 | 5578.8 samples/s | 87.2 steps/s
[Step=53550 Epoch=262.6] | Loss=0.00457 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.731 | L2-Norm(final)=15.950 | 2456.5 samples/s | 38.4 steps/s
[Step=53600 Epoch=262.8] | Loss=0.00448 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.733 | L2-Norm(final)=15.952 | 4801.2 samples/s | 75.0 steps/s
[Step=53650 Epoch=263.1] | Loss=0.00440 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.735 | L2-Norm(final)=15.953 | 4901.4 samples/s | 76.6 steps/s
[Step=53700 Epoch=263.3] | Loss=0.00432 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.737 | L2-Norm(final)=15.955 | 5301.1 samples/s | 82.8 steps/s
[Step=53750 Epoch=263.6] | Loss=0.00424 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=15.956 | 2546.5 samples/s | 39.8 steps/s
[Step=53800 Epoch=263.8] | Loss=0.00415 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.740 | L2-Norm(final)=15.958 | 4794.6 samples/s | 74.9 steps/s
[Step=53850 Epoch=264.1] | Loss=0.00409 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.742 | L2-Norm(final)=15.959 | 4814.7 samples/s | 75.2 steps/s
[Step=53900 Epoch=264.3] | Loss=0.00404 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.743 | L2-Norm(final)=15.961 | 5099.1 samples/s | 79.7 steps/s
[Step=53950 Epoch=264.6] | Loss=0.00395 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.745 | L2-Norm(final)=15.962 | 2557.0 samples/s | 40.0 steps/s
[Step=54000 Epoch=264.8] | Loss=0.00387 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=15.964 | 4855.6 samples/s | 75.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step54000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=36001 Epoch=342.5] | Loss=0.00013 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.934 | 4964.0 samples/s | 77.6 steps/s
[Step=36050 Epoch=342.9] | Loss=0.00040 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.665 | L2-Norm(final)=15.942 | 5094.0 samples/s | 79.6 steps/s
[Step=36100 Epoch=343.4] | Loss=0.00041 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=15.953 | 8215.8 samples/s | 128.4 steps/s
[Step=36150 Epoch=343.9] | Loss=0.00042 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=15.964 | 2312.3 samples/s | 36.1 steps/s
[Step=36200 Epoch=344.4] | Loss=0.00043 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=15.974 | 7458.1 samples/s | 116.5 steps/s
[Step=36250 Epoch=344.8] | Loss=0.00042 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=15.983 | 2452.0 samples/s | 38.3 steps/s
[Step=36300 Epoch=345.3] | Loss=0.00043 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=15.992 | 6549.2 samples/s | 102.3 steps/s
[Step=36350 Epoch=345.8] | Loss=0.00041 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=16.000 | 2537.6 samples/s | 39.6 steps/s
[Step=36400 Epoch=346.3] | Loss=0.00042 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=16.009 | 6019.4 samples/s | 94.1 steps/s
[Step=36450 Epoch=346.7] | Loss=0.00042 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=16.016 | 2646.3 samples/s | 41.3 steps/s
[Step=36500 Epoch=347.2] | Loss=0.00042 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=16.024 | 5410.9 samples/s | 84.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=36501 Epoch=347.2] | Loss=0.00019 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=16.101 | 6247.0 samples/s | 97.6 steps/s
[Step=36550 Epoch=347.7] | Loss=0.00031 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.672 | L2-Norm(final)=16.104 | 3910.0 samples/s | 61.1 steps/s
[Step=36600 Epoch=348.2] | Loss=0.00017 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.674 | L2-Norm(final)=16.106 | 6730.5 samples/s | 105.2 steps/s
[Step=36650 Epoch=348.6] | Loss=0.00012 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.673 | L2-Norm(final)=16.107 | 2195.8 samples/s | 34.3 steps/s
[Step=36700 Epoch=349.1] | Loss=0.00009 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.671 | L2-Norm(final)=16.108 | 6064.9 samples/s | 94.8 steps/s
[Step=36750 Epoch=349.6] | Loss=0.00007 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=16.109 | 2289.7 samples/s | 35.8 steps/s
[Step=36800 Epoch=350.1] | Loss=0.00006 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=16.109 | 5562.8 samples/s | 86.9 steps/s
[Step=36850 Epoch=350.5] | Loss=0.00005 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.660 | L2-Norm(final)=16.110 | 2364.2 samples/s | 36.9 steps/s
[Step=36900 Epoch=351.0] | Loss=0.00005 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.656 | L2-Norm(final)=16.110 | 5144.5 samples/s | 80.4 steps/s
[Step=36950 Epoch=351.5] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.651 | L2-Norm(final)=16.110 | 2468.5 samples/s | 38.6 steps/s
[Step=37000 Epoch=352.0] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.647 | L2-Norm(final)=16.111 | 4752.4 samples/s | 74.3 steps/s
[Step=37050 Epoch=352.4] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.643 | L2-Norm(final)=16.111 | 2498.8 samples/s | 39.0 steps/s
[Step=37100 Epoch=352.9] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.638 | L2-Norm(final)=16.112 | 4648.5 samples/s | 72.6 steps/s
[Step=37150 Epoch=353.4] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.633 | L2-Norm(final)=16.112 | 2563.6 samples/s | 40.1 steps/s
[Step=37200 Epoch=353.9] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.629 | L2-Norm(final)=16.112 | 4448.0 samples/s | 69.5 steps/s
[Step=37250 Epoch=354.3] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.624 | L2-Norm(final)=16.113 | 2580.0 samples/s | 40.3 steps/s
[Step=37300 Epoch=354.8] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.619 | L2-Norm(final)=16.113 | 4647.1 samples/s | 72.6 steps/s
[Step=37350 Epoch=355.3] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.614 | L2-Norm(final)=16.113 | 2695.1 samples/s | 42.1 steps/s
[Step=37400 Epoch=355.8] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.609 | L2-Norm(final)=16.114 | 4298.1 samples/s | 67.2 steps/s
[Step=37450 Epoch=356.2] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=16.114 | 7011.1 samples/s | 109.5 steps/s
[Step=37500 Epoch=356.7] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.599 | L2-Norm(final)=16.114 | 2189.8 samples/s | 34.2 steps/s
[Step=37550 Epoch=357.2] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=16.115 | 6156.4 samples/s | 96.2 steps/s
[Step=37600 Epoch=357.7] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.588 | L2-Norm(final)=16.115 | 2236.5 samples/s | 34.9 steps/s
[Step=37650 Epoch=358.1] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.583 | L2-Norm(final)=16.115 | 5741.2 samples/s | 89.7 steps/s
[Step=37700 Epoch=358.6] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=16.116 | 2323.7 samples/s | 36.3 steps/s
[Step=37750 Epoch=359.1] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.572 | L2-Norm(final)=16.116 | 5209.5 samples/s | 81.4 steps/s
[Step=37800 Epoch=359.6] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.567 | L2-Norm(final)=16.116 | 2407.4 samples/s | 37.6 steps/s
[Step=37850 Epoch=360.0] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.561 | L2-Norm(final)=16.116 | 4840.9 samples/s | 75.6 steps/s
[Step=37900 Epoch=360.5] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.555 | L2-Norm(final)=16.117 | 2514.0 samples/s | 39.3 steps/s
[Step=37950 Epoch=361.0] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.550 | L2-Norm(final)=16.117 | 4613.3 samples/s | 72.1 steps/s
[Step=38000 Epoch=361.5] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.544 | L2-Norm(final)=16.117 | 2604.4 samples/s | 40.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step38000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=32001 Epoch=305.0] | Loss=0.00057 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.137 | 5678.8 samples/s | 88.7 steps/s
[Step=32050 Epoch=305.5] | Loss=0.00081 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=15.140 | 4635.2 samples/s | 72.4 steps/s
[Step=32100 Epoch=305.9] | Loss=0.00084 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=15.141 | 8475.5 samples/s | 132.4 steps/s
[Step=32150 Epoch=306.4] | Loss=0.00082 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=15.141 | 2371.0 samples/s | 37.0 steps/s
[Step=32200 Epoch=306.9] | Loss=0.00081 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=15.142 | 7205.5 samples/s | 112.6 steps/s
[Step=32250 Epoch=307.4] | Loss=0.00078 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=15.143 | 2444.7 samples/s | 38.2 steps/s
[Step=32300 Epoch=307.8] | Loss=0.00079 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=15.144 | 6669.7 samples/s | 104.2 steps/s
[Step=32350 Epoch=308.3] | Loss=0.00079 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=15.145 | 2469.1 samples/s | 38.6 steps/s
[Step=32400 Epoch=308.8] | Loss=0.00077 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=15.147 | 6337.1 samples/s | 99.0 steps/s
[Step=32450 Epoch=309.3] | Loss=0.00078 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=15.149 | 2575.1 samples/s | 40.2 steps/s
[Step=32500 Epoch=309.8] | Loss=0.00077 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=15.151 | 5842.2 samples/s | 91.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=32501 Epoch=309.8] | Loss=0.00027 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=15.174 | 5668.5 samples/s | 88.6 steps/s
[Step=32550 Epoch=310.2] | Loss=0.00035 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.677 | L2-Norm(final)=15.176 | 4217.0 samples/s | 65.9 steps/s
[Step=32600 Epoch=310.7] | Loss=0.00022 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.681 | L2-Norm(final)=15.178 | 6660.3 samples/s | 104.1 steps/s
[Step=32650 Epoch=311.2] | Loss=0.00015 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.681 | L2-Norm(final)=15.180 | 2190.2 samples/s | 34.2 steps/s
[Step=32700 Epoch=311.7] | Loss=0.00012 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=15.181 | 6172.1 samples/s | 96.4 steps/s
[Step=32750 Epoch=312.1] | Loss=0.00010 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=15.181 | 2231.1 samples/s | 34.9 steps/s
[Step=32800 Epoch=312.6] | Loss=0.00008 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.678 | L2-Norm(final)=15.182 | 5757.1 samples/s | 90.0 steps/s
[Step=32850 Epoch=313.1] | Loss=0.00007 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.676 | L2-Norm(final)=15.183 | 2307.6 samples/s | 36.1 steps/s
[Step=32900 Epoch=313.6] | Loss=0.00006 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.674 | L2-Norm(final)=15.183 | 5418.4 samples/s | 84.7 steps/s
[Step=32950 Epoch=314.0] | Loss=0.00006 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.672 | L2-Norm(final)=15.184 | 2375.3 samples/s | 37.1 steps/s
[Step=33000 Epoch=314.5] | Loss=0.00005 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.670 | L2-Norm(final)=15.184 | 5026.0 samples/s | 78.5 steps/s
[Step=33050 Epoch=315.0] | Loss=0.00005 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=15.185 | 2449.7 samples/s | 38.3 steps/s
[Step=33100 Epoch=315.5] | Loss=0.00005 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.665 | L2-Norm(final)=15.185 | 4738.9 samples/s | 74.0 steps/s
[Step=33150 Epoch=315.9] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.663 | L2-Norm(final)=15.186 | 2539.8 samples/s | 39.7 steps/s
[Step=33200 Epoch=316.4] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.660 | L2-Norm(final)=15.186 | 4632.3 samples/s | 72.4 steps/s
[Step=33250 Epoch=316.9] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.658 | L2-Norm(final)=15.186 | 2542.0 samples/s | 39.7 steps/s
[Step=33300 Epoch=317.4] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.655 | L2-Norm(final)=15.187 | 4626.4 samples/s | 72.3 steps/s
[Step=33350 Epoch=317.9] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.653 | L2-Norm(final)=15.187 | 2571.4 samples/s | 40.2 steps/s
[Step=33400 Epoch=318.3] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=15.188 | 4686.7 samples/s | 73.2 steps/s
[Step=33450 Epoch=318.8] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.647 | L2-Norm(final)=15.188 | 2544.4 samples/s | 39.8 steps/s
[Step=33500 Epoch=319.3] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.644 | L2-Norm(final)=15.188 | 4713.7 samples/s | 73.7 steps/s
[Step=33550 Epoch=319.8] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.642 | L2-Norm(final)=15.189 | 7206.5 samples/s | 112.6 steps/s
[Step=33600 Epoch=320.2] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.639 | L2-Norm(final)=15.189 | 2129.4 samples/s | 33.3 steps/s
[Step=33650 Epoch=320.7] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.636 | L2-Norm(final)=15.189 | 6702.0 samples/s | 104.7 steps/s
[Step=33700 Epoch=321.2] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.633 | L2-Norm(final)=15.190 | 2173.6 samples/s | 34.0 steps/s
[Step=33750 Epoch=321.7] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.630 | L2-Norm(final)=15.190 | 6183.4 samples/s | 96.6 steps/s
[Step=33800 Epoch=322.1] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.627 | L2-Norm(final)=15.190 | 2268.1 samples/s | 35.4 steps/s
[Step=33850 Epoch=322.6] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.624 | L2-Norm(final)=15.191 | 5600.0 samples/s | 87.5 steps/s
[Step=33900 Epoch=323.1] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.621 | L2-Norm(final)=15.191 | 2262.3 samples/s | 35.3 steps/s
[Step=33950 Epoch=323.6] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.618 | L2-Norm(final)=15.191 | 5282.8 samples/s | 82.5 steps/s
[Step=34000 Epoch=324.1] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.614 | L2-Norm(final)=15.192 | 2331.0 samples/s | 36.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_4/client_state-step34000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07594 | acc=0.9642 | tpr=0.9715 | fpr=0.0515 | 5626.2 samples/s | 22.0 steps/s
Avg test loss: 0.08377, Avg test acc: 0.96218, Avg tpr: 0.97074, Avg fpr: 0.05666, total FA: 442

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07837 | acc=0.9662 | tpr=0.9767 | fpr=0.0567 | 5584.6 samples/s | 21.8 steps/s
Avg test loss: 0.08686, Avg test acc: 0.96466, Avg tpr: 0.97505, Avg fpr: 0.05820, total FA: 454

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.07935 | acc=0.9649 | tpr=0.9781 | fpr=0.0637 | 5798.6 samples/s | 22.7 steps/s
Avg test loss: 0.08702, Avg test acc: 0.96326, Avg tpr: 0.97552, Avg fpr: 0.06371, total FA: 497

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.07675 | acc=0.9636 | tpr=0.9712 | fpr=0.0530 | 5724.0 samples/s | 22.4 steps/s
Avg test loss: 0.08525, Avg test acc: 0.96342, Avg tpr: 0.97115, Avg fpr: 0.05358, total FA: 418

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.07731 | acc=0.9663 | tpr=0.9773 | fpr=0.0577 | 5805.7 samples/s | 22.7 steps/s
Avg test loss: 0.08839, Avg test acc: 0.96458, Avg tpr: 0.97570, Avg fpr: 0.05986, total FA: 467

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.54022 | acc=0.2646 | tpr=0.0056 | fpr=0.1729 | 5712.3 samples/s | 22.3 steps/s
Avg test loss: 5.54969, Avg test acc: 0.26248, Avg tpr: 0.00571, Avg fpr: 0.17280, total FA: 1348

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.67407 | acc=0.2940 | tpr=0.0156 | fpr=0.1016 | 5690.7 samples/s | 22.2 steps/s
Avg test loss: 4.68099, Avg test acc: 0.29213, Avg tpr: 0.01644, Avg fpr: 0.10153, total FA: 792

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.28696 | acc=0.2377 | tpr=0.0138 | fpr=0.2760 | 5680.3 samples/s | 22.2 steps/s
Avg test loss: 5.29169, Avg test acc: 0.23768, Avg tpr: 0.01469, Avg fpr: 0.27189, total FA: 2121

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=6.10100 | acc=0.2477 | tpr=0.0087 | fpr=0.2332 | 5793.2 samples/s | 22.6 steps/s
Avg test loss: 6.11341, Avg test acc: 0.24641, Avg tpr: 0.00868, Avg fpr: 0.23074, total FA: 1800

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.54321 | acc=0.2373 | tpr=0.0067 | fpr=0.2621 | 5649.8 samples/s | 22.1 steps/s
Avg test loss: 5.54691, Avg test acc: 0.23724, Avg tpr: 0.00758, Avg fpr: 0.25766, total FA: 2010

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.96433 | acc=0.1566 | tpr=0.2035 | fpr=0.8442 | 5687.8 samples/s | 22.2 steps/s
[Step= 100] | Loss=4.92097 | acc=0.1578 | tpr=0.1834 | fpr=0.8427 | 8045.9 samples/s | 31.4 steps/s
[Step= 150] | Loss=4.93939 | acc=0.1573 | tpr=0.1816 | fpr=0.8432 | 8318.1 samples/s | 32.5 steps/s
[Step= 200] | Loss=4.93339 | acc=0.1573 | tpr=0.1792 | fpr=0.8431 | 7645.1 samples/s | 29.9 steps/s
[Step= 250] | Loss=4.94030 | acc=0.1576 | tpr=0.1799 | fpr=0.8428 | 7704.5 samples/s | 30.1 steps/s
[Step= 300] | Loss=4.94460 | acc=0.1571 | tpr=0.1833 | fpr=0.8434 | 8076.9 samples/s | 31.6 steps/s
[Step= 350] | Loss=4.94686 | acc=0.1570 | tpr=0.1753 | fpr=0.8433 | 7992.3 samples/s | 31.2 steps/s
[Step= 400] | Loss=4.94572 | acc=0.1574 | tpr=0.1789 | fpr=0.8429 | 8388.3 samples/s | 32.8 steps/s
[Step= 450] | Loss=4.94490 | acc=0.1578 | tpr=0.1767 | fpr=0.8426 | 8057.5 samples/s | 31.5 steps/s
[Step= 500] | Loss=4.94814 | acc=0.1576 | tpr=0.1806 | fpr=0.8428 | 8099.6 samples/s | 31.6 steps/s
[Step= 550] | Loss=4.94627 | acc=0.1576 | tpr=0.1779 | fpr=0.8427 | 10382.6 samples/s | 40.6 steps/s
Avg test loss: 4.94588, Avg test acc: 0.15753, Avg tpr: 0.17789, Avg fpr: 0.84284, total FA: 117026

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.93948 | acc=0.1491 | tpr=0.2301 | fpr=0.8524 | 5650.3 samples/s | 22.1 steps/s
[Step= 100] | Loss=4.89333 | acc=0.1511 | tpr=0.2154 | fpr=0.8501 | 8355.7 samples/s | 32.6 steps/s
[Step= 150] | Loss=4.90913 | acc=0.1488 | tpr=0.2046 | fpr=0.8522 | 7119.9 samples/s | 27.8 steps/s
[Step= 200] | Loss=4.90536 | acc=0.1484 | tpr=0.1923 | fpr=0.8524 | 8501.6 samples/s | 33.2 steps/s
[Step= 250] | Loss=4.91073 | acc=0.1483 | tpr=0.1878 | fpr=0.8524 | 8142.1 samples/s | 31.8 steps/s
[Step= 300] | Loss=4.91252 | acc=0.1476 | tpr=0.1898 | fpr=0.8532 | 8516.7 samples/s | 33.3 steps/s
[Step= 350] | Loss=4.91506 | acc=0.1471 | tpr=0.1785 | fpr=0.8535 | 8370.7 samples/s | 32.7 steps/s
[Step= 400] | Loss=4.91455 | acc=0.1478 | tpr=0.1844 | fpr=0.8529 | 7600.6 samples/s | 29.7 steps/s
[Step= 450] | Loss=4.91306 | acc=0.1481 | tpr=0.1831 | fpr=0.8525 | 8504.3 samples/s | 33.2 steps/s
[Step= 500] | Loss=4.91644 | acc=0.1478 | tpr=0.1850 | fpr=0.8529 | 8574.4 samples/s | 33.5 steps/s
[Step= 550] | Loss=4.91438 | acc=0.1481 | tpr=0.1842 | fpr=0.8526 | 8917.5 samples/s | 34.8 steps/s
Avg test loss: 4.91454, Avg test acc: 0.14801, Avg tpr: 0.18423, Avg fpr: 0.85265, total FA: 118389

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.53125 | acc=0.1338 | tpr=0.1327 | fpr=0.8662 | 5643.5 samples/s | 22.0 steps/s
[Step= 100] | Loss=5.48760 | acc=0.1359 | tpr=0.1279 | fpr=0.8640 | 7316.0 samples/s | 28.6 steps/s
[Step= 150] | Loss=5.49823 | acc=0.1348 | tpr=0.1254 | fpr=0.8650 | 8517.4 samples/s | 33.3 steps/s
[Step= 200] | Loss=5.49200 | acc=0.1352 | tpr=0.1246 | fpr=0.8646 | 7926.2 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.49624 | acc=0.1351 | tpr=0.1214 | fpr=0.8646 | 8198.9 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.50235 | acc=0.1347 | tpr=0.1229 | fpr=0.8650 | 8127.4 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.50651 | acc=0.1341 | tpr=0.1183 | fpr=0.8656 | 8170.1 samples/s | 31.9 steps/s
[Step= 400] | Loss=5.50506 | acc=0.1345 | tpr=0.1253 | fpr=0.8653 | 8313.2 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.50379 | acc=0.1348 | tpr=0.1246 | fpr=0.8651 | 8326.7 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.50575 | acc=0.1346 | tpr=0.1264 | fpr=0.8653 | 7419.0 samples/s | 29.0 steps/s
[Step= 550] | Loss=5.50252 | acc=0.1350 | tpr=0.1261 | fpr=0.8648 | 10776.0 samples/s | 42.1 steps/s
Avg test loss: 5.50241, Avg test acc: 0.13497, Avg tpr: 0.12639, Avg fpr: 0.86487, total FA: 120086

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.81244 | acc=0.1630 | tpr=0.1549 | fpr=0.8369 | 5861.2 samples/s | 22.9 steps/s
[Step= 100] | Loss=4.77074 | acc=0.1643 | tpr=0.1535 | fpr=0.8355 | 7763.7 samples/s | 30.3 steps/s
[Step= 150] | Loss=4.78511 | acc=0.1628 | tpr=0.1556 | fpr=0.8371 | 7872.1 samples/s | 30.8 steps/s
[Step= 200] | Loss=4.77720 | acc=0.1627 | tpr=0.1519 | fpr=0.8371 | 7779.1 samples/s | 30.4 steps/s
[Step= 250] | Loss=4.78212 | acc=0.1629 | tpr=0.1528 | fpr=0.8369 | 7875.5 samples/s | 30.8 steps/s
[Step= 300] | Loss=4.78767 | acc=0.1621 | tpr=0.1556 | fpr=0.8377 | 8064.8 samples/s | 31.5 steps/s
[Step= 350] | Loss=4.78931 | acc=0.1621 | tpr=0.1503 | fpr=0.8377 | 8125.9 samples/s | 31.7 steps/s
[Step= 400] | Loss=4.78873 | acc=0.1624 | tpr=0.1559 | fpr=0.8375 | 7948.5 samples/s | 31.0 steps/s
[Step= 450] | Loss=4.78799 | acc=0.1627 | tpr=0.1553 | fpr=0.8371 | 8263.3 samples/s | 32.3 steps/s
[Step= 500] | Loss=4.79090 | acc=0.1626 | tpr=0.1568 | fpr=0.8373 | 8483.9 samples/s | 33.1 steps/s
[Step= 550] | Loss=4.78851 | acc=0.1629 | tpr=0.1588 | fpr=0.8371 | 10224.0 samples/s | 39.9 steps/s
Avg test loss: 4.78823, Avg test acc: 0.16278, Avg tpr: 0.15887, Avg fpr: 0.83715, total FA: 116236

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.67219 | acc=0.1385 | tpr=0.1460 | fpr=0.8616 | 5712.2 samples/s | 22.3 steps/s
[Step= 100] | Loss=5.62127 | acc=0.1415 | tpr=0.1343 | fpr=0.8584 | 8047.3 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.63900 | acc=0.1401 | tpr=0.1297 | fpr=0.8597 | 7363.6 samples/s | 28.8 steps/s
[Step= 200] | Loss=5.63583 | acc=0.1400 | tpr=0.1235 | fpr=0.8597 | 8521.0 samples/s | 33.3 steps/s
[Step= 250] | Loss=5.64413 | acc=0.1401 | tpr=0.1240 | fpr=0.8596 | 8393.1 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.64760 | acc=0.1395 | tpr=0.1258 | fpr=0.8603 | 7700.2 samples/s | 30.1 steps/s
[Step= 350] | Loss=5.65053 | acc=0.1390 | tpr=0.1209 | fpr=0.8607 | 8177.0 samples/s | 31.9 steps/s
[Step= 400] | Loss=5.64917 | acc=0.1394 | tpr=0.1231 | fpr=0.8603 | 8692.3 samples/s | 34.0 steps/s
[Step= 450] | Loss=5.64803 | acc=0.1398 | tpr=0.1241 | fpr=0.8599 | 7967.4 samples/s | 31.1 steps/s
[Step= 500] | Loss=5.65187 | acc=0.1395 | tpr=0.1264 | fpr=0.8602 | 7751.4 samples/s | 30.3 steps/s
[Step= 550] | Loss=5.64851 | acc=0.1396 | tpr=0.1257 | fpr=0.8602 | 10254.9 samples/s | 40.1 steps/s
Avg test loss: 5.64832, Avg test acc: 0.13948, Avg tpr: 0.12599, Avg fpr: 0.86028, total FA: 119448

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10983 | acc=0.9807 | tpr=0.9248 | fpr=0.0183 | 5799.7 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.11107 | acc=0.9807 | tpr=0.9403 | fpr=0.0185 | 7801.6 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.11484 | acc=0.9804 | tpr=0.9467 | fpr=0.0190 | 7966.9 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.11684 | acc=0.9805 | tpr=0.9519 | fpr=0.0190 | 8199.7 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.11756 | acc=0.9803 | tpr=0.9476 | fpr=0.0191 | 7429.0 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.11904 | acc=0.9802 | tpr=0.9469 | fpr=0.0192 | 8207.8 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.11919 | acc=0.9802 | tpr=0.9505 | fpr=0.0193 | 8466.0 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.12019 | acc=0.9801 | tpr=0.9464 | fpr=0.0193 | 8155.5 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.12253 | acc=0.9797 | tpr=0.9445 | fpr=0.0197 | 8249.8 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.12156 | acc=0.9798 | tpr=0.9463 | fpr=0.0196 | 7907.0 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.12062 | acc=0.9799 | tpr=0.9463 | fpr=0.0195 | 9954.8 samples/s | 38.9 steps/s
Avg test loss: 0.12039, Avg test acc: 0.97994, Avg tpr: 0.94612, Avg fpr: 0.01945, total FA: 2700

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10641 | acc=0.9813 | tpr=0.9159 | fpr=0.0175 | 5711.8 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.10817 | acc=0.9808 | tpr=0.9254 | fpr=0.0181 | 8241.8 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.11147 | acc=0.9802 | tpr=0.9308 | fpr=0.0189 | 7626.3 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.11313 | acc=0.9801 | tpr=0.9322 | fpr=0.0190 | 8529.0 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.11397 | acc=0.9801 | tpr=0.9284 | fpr=0.0189 | 8138.7 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.11569 | acc=0.9799 | tpr=0.9287 | fpr=0.0192 | 7826.3 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.11558 | acc=0.9799 | tpr=0.9311 | fpr=0.0193 | 8230.5 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.11654 | acc=0.9798 | tpr=0.9278 | fpr=0.0193 | 8549.2 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.11849 | acc=0.9795 | tpr=0.9265 | fpr=0.0196 | 8173.6 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.11753 | acc=0.9796 | tpr=0.9295 | fpr=0.0195 | 8036.7 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.11652 | acc=0.9797 | tpr=0.9288 | fpr=0.0193 | 9318.6 samples/s | 36.4 steps/s
Avg test loss: 0.11631, Avg test acc: 0.97974, Avg tpr: 0.92829, Avg fpr: 0.01932, total FA: 2683

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11814 | acc=0.9782 | tpr=0.9381 | fpr=0.0211 | 5596.3 samples/s | 21.9 steps/s
[Step= 100] | Loss=0.11968 | acc=0.9787 | tpr=0.9574 | fpr=0.0209 | 8169.2 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.12431 | acc=0.9779 | tpr=0.9568 | fpr=0.0217 | 7870.5 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.12593 | acc=0.9780 | tpr=0.9607 | fpr=0.0216 | 8358.2 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.12695 | acc=0.9780 | tpr=0.9598 | fpr=0.0217 | 7737.1 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.12800 | acc=0.9779 | tpr=0.9593 | fpr=0.0218 | 8250.6 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.12803 | acc=0.9778 | tpr=0.9618 | fpr=0.0219 | 8104.7 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.12886 | acc=0.9775 | tpr=0.9590 | fpr=0.0221 | 7985.0 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.13107 | acc=0.9772 | tpr=0.9567 | fpr=0.0224 | 8209.0 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.13030 | acc=0.9773 | tpr=0.9581 | fpr=0.0223 | 8403.2 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.12922 | acc=0.9775 | tpr=0.9570 | fpr=0.0222 | 9696.8 samples/s | 37.9 steps/s
Avg test loss: 0.12895, Avg test acc: 0.97748, Avg tpr: 0.95681, Avg fpr: 0.02215, total FA: 3075

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10198 | acc=0.9809 | tpr=0.9381 | fpr=0.0184 | 5736.8 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.10343 | acc=0.9809 | tpr=0.9446 | fpr=0.0184 | 7475.6 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.10574 | acc=0.9807 | tpr=0.9510 | fpr=0.0188 | 8537.3 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.10710 | acc=0.9807 | tpr=0.9541 | fpr=0.0188 | 8151.6 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.10806 | acc=0.9807 | tpr=0.9502 | fpr=0.0187 | 7679.9 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.10884 | acc=0.9806 | tpr=0.9505 | fpr=0.0189 | 8206.9 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.10878 | acc=0.9807 | tpr=0.9524 | fpr=0.0188 | 7840.7 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.10970 | acc=0.9805 | tpr=0.9486 | fpr=0.0189 | 8654.3 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.11167 | acc=0.9802 | tpr=0.9474 | fpr=0.0192 | 8224.8 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.11083 | acc=0.9804 | tpr=0.9489 | fpr=0.0191 | 8330.1 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.11004 | acc=0.9804 | tpr=0.9467 | fpr=0.0189 | 9479.3 samples/s | 37.0 steps/s
Avg test loss: 0.10983, Avg test acc: 0.98046, Avg tpr: 0.94651, Avg fpr: 0.01892, total FA: 2627

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.11064 | acc=0.9807 | tpr=0.9248 | fpr=0.0183 | 5611.2 samples/s | 21.9 steps/s
[Step= 100] | Loss=0.11310 | acc=0.9802 | tpr=0.9360 | fpr=0.0189 | 7494.1 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.11691 | acc=0.9797 | tpr=0.9424 | fpr=0.0196 | 8816.0 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.11845 | acc=0.9797 | tpr=0.9464 | fpr=0.0196 | 8475.3 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.11960 | acc=0.9797 | tpr=0.9432 | fpr=0.0196 | 7729.8 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.12083 | acc=0.9798 | tpr=0.9425 | fpr=0.0195 | 8243.5 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.12063 | acc=0.9799 | tpr=0.9449 | fpr=0.0195 | 7833.0 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.12150 | acc=0.9797 | tpr=0.9420 | fpr=0.0196 | 8316.2 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.12375 | acc=0.9794 | tpr=0.9416 | fpr=0.0199 | 7852.3 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.12277 | acc=0.9795 | tpr=0.9441 | fpr=0.0198 | 7468.0 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.12185 | acc=0.9796 | tpr=0.9419 | fpr=0.0197 | 10872.3 samples/s | 42.5 steps/s
Avg test loss: 0.12162, Avg test acc: 0.97961, Avg tpr: 0.94176, Avg fpr: 0.01971, total FA: 2736

server round 45/50

clients selected: [1 3 4 6 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=56001 Epoch=273.3] | Loss=0.00067 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.017 | 6235.3 samples/s | 97.4 steps/s
[Step=56050 Epoch=273.5] | Loss=0.01269 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.019 | 5029.1 samples/s | 78.6 steps/s
[Step=56100 Epoch=273.7] | Loss=0.01419 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.021 | 5648.8 samples/s | 88.3 steps/s
[Step=56150 Epoch=274.0] | Loss=0.01314 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.022 | 5572.8 samples/s | 87.1 steps/s
[Step=56200 Epoch=274.2] | Loss=0.01366 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.606 | L2-Norm(final)=16.024 | 8767.9 samples/s | 137.0 steps/s
[Step=56250 Epoch=274.5] | Loss=0.01413 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.026 | 2443.6 samples/s | 38.2 steps/s
[Step=56300 Epoch=274.7] | Loss=0.01404 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.027 | 5468.5 samples/s | 85.4 steps/s
[Step=56350 Epoch=275.0] | Loss=0.01359 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.029 | 5776.1 samples/s | 90.3 steps/s
[Step=56400 Epoch=275.2] | Loss=0.01343 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.031 | 7774.7 samples/s | 121.5 steps/s
[Step=56450 Epoch=275.4] | Loss=0.01336 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.032 | 2465.3 samples/s | 38.5 steps/s
[Step=56500 Epoch=275.7] | Loss=0.01333 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.606 | L2-Norm(final)=16.033 | 5623.0 samples/s | 87.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=56501 Epoch=275.7] | Loss=0.00449 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.046 | 5461.4 samples/s | 85.3 steps/s
[Step=56550 Epoch=275.9] | Loss=0.01189 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.612 | L2-Norm(final)=16.047 | 4629.2 samples/s | 72.3 steps/s
[Step=56600 Epoch=276.2] | Loss=0.01173 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.619 | L2-Norm(final)=16.048 | 4843.3 samples/s | 75.7 steps/s
[Step=56650 Epoch=276.4] | Loss=0.01146 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.625 | L2-Norm(final)=16.049 | 4776.5 samples/s | 74.6 steps/s
[Step=56700 Epoch=276.7] | Loss=0.01065 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.629 | L2-Norm(final)=16.051 | 7040.1 samples/s | 110.0 steps/s
[Step=56750 Epoch=276.9] | Loss=0.00951 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.633 | L2-Norm(final)=16.052 | 2243.4 samples/s | 35.1 steps/s
[Step=56800 Epoch=277.2] | Loss=0.00853 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.637 | L2-Norm(final)=16.054 | 4862.2 samples/s | 76.0 steps/s
[Step=56850 Epoch=277.4] | Loss=0.00806 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.640 | L2-Norm(final)=16.056 | 4865.0 samples/s | 76.0 steps/s
[Step=56900 Epoch=277.6] | Loss=0.00764 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.643 | L2-Norm(final)=16.057 | 6446.7 samples/s | 100.7 steps/s
[Step=56950 Epoch=277.9] | Loss=0.00718 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.645 | L2-Norm(final)=16.059 | 2308.0 samples/s | 36.1 steps/s
[Step=57000 Epoch=278.1] | Loss=0.00687 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.648 | L2-Norm(final)=16.061 | 4921.5 samples/s | 76.9 steps/s
[Step=57050 Epoch=278.4] | Loss=0.00652 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.650 | L2-Norm(final)=16.062 | 4838.2 samples/s | 75.6 steps/s
[Step=57100 Epoch=278.6] | Loss=0.00626 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.653 | L2-Norm(final)=16.064 | 5898.8 samples/s | 92.2 steps/s
[Step=57150 Epoch=278.9] | Loss=0.00601 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.655 | L2-Norm(final)=16.066 | 2387.6 samples/s | 37.3 steps/s
[Step=57200 Epoch=279.1] | Loss=0.00589 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.657 | L2-Norm(final)=16.067 | 4808.7 samples/s | 75.1 steps/s
[Step=57250 Epoch=279.4] | Loss=0.00568 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.659 | L2-Norm(final)=16.069 | 4857.2 samples/s | 75.9 steps/s
[Step=57300 Epoch=279.6] | Loss=0.00552 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.661 | L2-Norm(final)=16.070 | 5625.8 samples/s | 87.9 steps/s
[Step=57350 Epoch=279.8] | Loss=0.00544 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.663 | L2-Norm(final)=16.072 | 2436.0 samples/s | 38.1 steps/s
[Step=57400 Epoch=280.1] | Loss=0.00528 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=16.073 | 4860.5 samples/s | 75.9 steps/s
[Step=57450 Epoch=280.3] | Loss=0.00512 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.666 | L2-Norm(final)=16.074 | 4843.0 samples/s | 75.7 steps/s
[Step=57500 Epoch=280.6] | Loss=0.00503 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=16.076 | 5291.2 samples/s | 82.7 steps/s
[Step=57550 Epoch=280.8] | Loss=0.00494 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.669 | L2-Norm(final)=16.077 | 2498.3 samples/s | 39.0 steps/s
[Step=57600 Epoch=281.1] | Loss=0.00486 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.671 | L2-Norm(final)=16.079 | 4949.7 samples/s | 77.3 steps/s
[Step=57650 Epoch=281.3] | Loss=0.00473 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.672 | L2-Norm(final)=16.080 | 4788.6 samples/s | 74.8 steps/s
[Step=57700 Epoch=281.5] | Loss=0.00462 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.674 | L2-Norm(final)=16.081 | 4948.2 samples/s | 77.3 steps/s
[Step=57750 Epoch=281.8] | Loss=0.00454 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.675 | L2-Norm(final)=16.083 | 2618.4 samples/s | 40.9 steps/s
[Step=57800 Epoch=282.0] | Loss=0.00442 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.677 | L2-Norm(final)=16.084 | 4907.6 samples/s | 76.7 steps/s
[Step=57850 Epoch=282.3] | Loss=0.00439 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.678 | L2-Norm(final)=16.085 | 4815.3 samples/s | 75.2 steps/s
[Step=57900 Epoch=282.5] | Loss=0.00433 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=16.087 | 4869.7 samples/s | 76.1 steps/s
[Step=57950 Epoch=282.8] | Loss=0.00425 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.681 | L2-Norm(final)=16.088 | 2619.1 samples/s | 40.9 steps/s
[Step=58000 Epoch=283.0] | Loss=0.00417 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.683 | L2-Norm(final)=16.089 | 4856.6 samples/s | 75.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step58000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=52001 Epoch=253.6] | Loss=0.02275 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.606 | L2-Norm(final)=15.647 | 5688.2 samples/s | 88.9 steps/s
[Step=52050 Epoch=253.8] | Loss=0.01335 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.606 | L2-Norm(final)=15.649 | 5098.7 samples/s | 79.7 steps/s
[Step=52100 Epoch=254.1] | Loss=0.01424 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.606 | L2-Norm(final)=15.651 | 5632.7 samples/s | 88.0 steps/s
[Step=52150 Epoch=254.3] | Loss=0.01410 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.607 | L2-Norm(final)=15.651 | 5529.3 samples/s | 86.4 steps/s
[Step=52200 Epoch=254.6] | Loss=0.01363 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.607 | L2-Norm(final)=15.653 | 8705.9 samples/s | 136.0 steps/s
[Step=52250 Epoch=254.8] | Loss=0.01314 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.607 | L2-Norm(final)=15.654 | 2438.0 samples/s | 38.1 steps/s
[Step=52300 Epoch=255.0] | Loss=0.01306 | Reg=0.00092 | acc=0.9531 | L2-Norm=9.607 | L2-Norm(final)=15.656 | 5626.1 samples/s | 87.9 steps/s
[Step=52350 Epoch=255.3] | Loss=0.01311 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.607 | L2-Norm(final)=15.657 | 5630.7 samples/s | 88.0 steps/s
[Step=52400 Epoch=255.5] | Loss=0.01360 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.607 | L2-Norm(final)=15.659 | 7819.3 samples/s | 122.2 steps/s
[Step=52450 Epoch=255.8] | Loss=0.01327 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.607 | L2-Norm(final)=15.660 | 2494.2 samples/s | 39.0 steps/s
[Step=52500 Epoch=256.0] | Loss=0.01342 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.607 | L2-Norm(final)=15.661 | 5624.7 samples/s | 87.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=52501 Epoch=256.0] | Loss=0.01374 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.607 | L2-Norm(final)=15.674 | 5761.4 samples/s | 90.0 steps/s
[Step=52550 Epoch=256.3] | Loss=0.01592 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.612 | L2-Norm(final)=15.674 | 4423.0 samples/s | 69.1 steps/s
[Step=52600 Epoch=256.5] | Loss=0.01377 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.618 | L2-Norm(final)=15.674 | 4907.4 samples/s | 76.7 steps/s
[Step=52650 Epoch=256.8] | Loss=0.01187 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.623 | L2-Norm(final)=15.675 | 4808.4 samples/s | 75.1 steps/s
[Step=52700 Epoch=257.0] | Loss=0.01134 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.627 | L2-Norm(final)=15.676 | 6965.6 samples/s | 108.8 steps/s
[Step=52750 Epoch=257.2] | Loss=0.00984 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.630 | L2-Norm(final)=15.677 | 2260.8 samples/s | 35.3 steps/s
[Step=52800 Epoch=257.5] | Loss=0.00898 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.633 | L2-Norm(final)=15.679 | 4952.6 samples/s | 77.4 steps/s
[Step=52850 Epoch=257.7] | Loss=0.00825 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.636 | L2-Norm(final)=15.680 | 4750.8 samples/s | 74.2 steps/s
[Step=52900 Epoch=258.0] | Loss=0.00769 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.639 | L2-Norm(final)=15.682 | 6348.4 samples/s | 99.2 steps/s
[Step=52950 Epoch=258.2] | Loss=0.00724 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.642 | L2-Norm(final)=15.684 | 2355.2 samples/s | 36.8 steps/s
[Step=53000 Epoch=258.5] | Loss=0.00684 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.644 | L2-Norm(final)=15.685 | 4880.9 samples/s | 76.3 steps/s
[Step=53050 Epoch=258.7] | Loss=0.00649 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.646 | L2-Norm(final)=15.687 | 4856.7 samples/s | 75.9 steps/s
[Step=53100 Epoch=258.9] | Loss=0.00631 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.649 | L2-Norm(final)=15.689 | 5827.7 samples/s | 91.1 steps/s
[Step=53150 Epoch=259.2] | Loss=0.00602 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.651 | L2-Norm(final)=15.690 | 2426.4 samples/s | 37.9 steps/s
[Step=53200 Epoch=259.4] | Loss=0.00578 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.653 | L2-Norm(final)=15.692 | 4835.2 samples/s | 75.5 steps/s
[Step=53250 Epoch=259.7] | Loss=0.00561 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.655 | L2-Norm(final)=15.694 | 4875.2 samples/s | 76.2 steps/s
[Step=53300 Epoch=259.9] | Loss=0.00549 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.657 | L2-Norm(final)=15.695 | 5390.1 samples/s | 84.2 steps/s
[Step=53350 Epoch=260.2] | Loss=0.00532 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.659 | L2-Norm(final)=15.697 | 2539.2 samples/s | 39.7 steps/s
[Step=53400 Epoch=260.4] | Loss=0.00516 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.661 | L2-Norm(final)=15.698 | 4802.6 samples/s | 75.0 steps/s
[Step=53450 Epoch=260.7] | Loss=0.00504 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.663 | L2-Norm(final)=15.700 | 4902.7 samples/s | 76.6 steps/s
[Step=53500 Epoch=260.9] | Loss=0.00495 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=15.701 | 4975.3 samples/s | 77.7 steps/s
[Step=53550 Epoch=261.1] | Loss=0.00481 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.666 | L2-Norm(final)=15.703 | 2598.7 samples/s | 40.6 steps/s
[Step=53600 Epoch=261.4] | Loss=0.00471 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=15.704 | 4946.2 samples/s | 77.3 steps/s
[Step=53650 Epoch=261.6] | Loss=0.00464 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.670 | L2-Norm(final)=15.706 | 4767.5 samples/s | 74.5 steps/s
[Step=53700 Epoch=261.9] | Loss=0.00457 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.671 | L2-Norm(final)=15.707 | 4851.4 samples/s | 75.8 steps/s
[Step=53750 Epoch=262.1] | Loss=0.00448 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.673 | L2-Norm(final)=15.709 | 2634.3 samples/s | 41.2 steps/s
[Step=53800 Epoch=262.4] | Loss=0.00438 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.674 | L2-Norm(final)=15.710 | 4835.1 samples/s | 75.5 steps/s
[Step=53850 Epoch=262.6] | Loss=0.00431 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.676 | L2-Norm(final)=15.712 | 4875.7 samples/s | 76.2 steps/s
[Step=53900 Epoch=262.8] | Loss=0.00426 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.678 | L2-Norm(final)=15.713 | 4820.2 samples/s | 75.3 steps/s
[Step=53950 Epoch=263.1] | Loss=0.00417 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=15.714 | 2682.1 samples/s | 41.9 steps/s
[Step=54000 Epoch=263.3] | Loss=0.00407 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.681 | L2-Norm(final)=15.716 | 4793.1 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step54000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=54001 Epoch=264.8] | Loss=0.01595 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.606 | L2-Norm(final)=16.008 | 5309.6 samples/s | 83.0 steps/s
[Step=54050 Epoch=265.1] | Loss=0.01717 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.008 | 5150.9 samples/s | 80.5 steps/s
[Step=54100 Epoch=265.3] | Loss=0.01670 | Reg=0.00092 | acc=0.9531 | L2-Norm=9.606 | L2-Norm(final)=16.008 | 5767.6 samples/s | 90.1 steps/s
[Step=54150 Epoch=265.5] | Loss=0.01534 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.008 | 5586.6 samples/s | 87.3 steps/s
[Step=54200 Epoch=265.8] | Loss=0.01506 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.009 | 8796.8 samples/s | 137.5 steps/s
[Step=54250 Epoch=266.0] | Loss=0.01477 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.606 | L2-Norm(final)=16.010 | 2423.0 samples/s | 37.9 steps/s
[Step=54300 Epoch=266.3] | Loss=0.01473 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.011 | 5467.6 samples/s | 85.4 steps/s
[Step=54350 Epoch=266.5] | Loss=0.01471 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.606 | L2-Norm(final)=16.012 | 5606.5 samples/s | 87.6 steps/s
[Step=54400 Epoch=266.8] | Loss=0.01454 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.606 | L2-Norm(final)=16.013 | 8315.1 samples/s | 129.9 steps/s
[Step=54450 Epoch=267.0] | Loss=0.01475 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.606 | L2-Norm(final)=16.014 | 2444.1 samples/s | 38.2 steps/s
[Step=54500 Epoch=267.3] | Loss=0.01464 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.014 | 5797.0 samples/s | 90.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=54501 Epoch=267.3] | Loss=0.00700 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.022 | 5961.7 samples/s | 93.2 steps/s
[Step=54550 Epoch=267.5] | Loss=0.01231 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.612 | L2-Norm(final)=16.023 | 4304.8 samples/s | 67.3 steps/s
[Step=54600 Epoch=267.7] | Loss=0.01294 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.618 | L2-Norm(final)=16.023 | 4870.0 samples/s | 76.1 steps/s
[Step=54650 Epoch=268.0] | Loss=0.01225 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.624 | L2-Norm(final)=16.024 | 4872.0 samples/s | 76.1 steps/s
[Step=54700 Epoch=268.2] | Loss=0.01159 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.628 | L2-Norm(final)=16.025 | 7130.5 samples/s | 111.4 steps/s
[Step=54750 Epoch=268.5] | Loss=0.01022 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.631 | L2-Norm(final)=16.026 | 2256.8 samples/s | 35.3 steps/s
[Step=54800 Epoch=268.7] | Loss=0.00927 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.635 | L2-Norm(final)=16.028 | 4847.1 samples/s | 75.7 steps/s
[Step=54850 Epoch=269.0] | Loss=0.00860 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.638 | L2-Norm(final)=16.030 | 4910.5 samples/s | 76.7 steps/s
[Step=54900 Epoch=269.2] | Loss=0.00794 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.641 | L2-Norm(final)=16.032 | 6598.4 samples/s | 103.1 steps/s
[Step=54950 Epoch=269.5] | Loss=0.00740 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.644 | L2-Norm(final)=16.034 | 2314.6 samples/s | 36.2 steps/s
[Step=55000 Epoch=269.7] | Loss=0.00695 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.647 | L2-Norm(final)=16.036 | 4757.3 samples/s | 74.3 steps/s
[Step=55050 Epoch=270.0] | Loss=0.00657 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.649 | L2-Norm(final)=16.037 | 4947.5 samples/s | 77.3 steps/s
[Step=55100 Epoch=270.2] | Loss=0.00634 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.652 | L2-Norm(final)=16.039 | 6161.1 samples/s | 96.3 steps/s
[Step=55150 Epoch=270.4] | Loss=0.00615 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=16.041 | 2378.1 samples/s | 37.2 steps/s
[Step=55200 Epoch=270.7] | Loss=0.00595 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.656 | L2-Norm(final)=16.043 | 4806.2 samples/s | 75.1 steps/s
[Step=55250 Epoch=270.9] | Loss=0.00571 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.658 | L2-Norm(final)=16.044 | 4894.1 samples/s | 76.5 steps/s
[Step=55300 Epoch=271.2] | Loss=0.00553 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.661 | L2-Norm(final)=16.046 | 5906.6 samples/s | 92.3 steps/s
[Step=55350 Epoch=271.4] | Loss=0.00538 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.663 | L2-Norm(final)=16.048 | 2379.4 samples/s | 37.2 steps/s
[Step=55400 Epoch=271.7] | Loss=0.00520 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.665 | L2-Norm(final)=16.050 | 4858.0 samples/s | 75.9 steps/s
[Step=55450 Epoch=271.9] | Loss=0.00507 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.667 | L2-Norm(final)=16.051 | 4853.2 samples/s | 75.8 steps/s
[Step=55500 Epoch=272.2] | Loss=0.00495 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.669 | L2-Norm(final)=16.053 | 5624.4 samples/s | 87.9 steps/s
[Step=55550 Epoch=272.4] | Loss=0.00485 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.671 | L2-Norm(final)=16.055 | 2460.3 samples/s | 38.4 steps/s
[Step=55600 Epoch=272.7] | Loss=0.00471 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.673 | L2-Norm(final)=16.056 | 4882.7 samples/s | 76.3 steps/s
[Step=55650 Epoch=272.9] | Loss=0.00458 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.674 | L2-Norm(final)=16.058 | 4814.3 samples/s | 75.2 steps/s
[Step=55700 Epoch=273.1] | Loss=0.00452 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.676 | L2-Norm(final)=16.060 | 5274.2 samples/s | 82.4 steps/s
[Step=55750 Epoch=273.4] | Loss=0.00440 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.678 | L2-Norm(final)=16.061 | 2533.7 samples/s | 39.6 steps/s
[Step=55800 Epoch=273.6] | Loss=0.00433 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=16.063 | 4908.4 samples/s | 76.7 steps/s
[Step=55850 Epoch=273.9] | Loss=0.00422 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=16.064 | 4758.1 samples/s | 74.3 steps/s
[Step=55900 Epoch=274.1] | Loss=0.00420 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.683 | L2-Norm(final)=16.066 | 5074.3 samples/s | 79.3 steps/s
[Step=55950 Epoch=274.4] | Loss=0.00413 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.685 | L2-Norm(final)=16.068 | 2596.8 samples/s | 40.6 steps/s
[Step=56000 Epoch=274.6] | Loss=0.00406 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.686 | L2-Norm(final)=16.069 | 4761.9 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_4/client_state-step56000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=38001 Epoch=361.5] | Loss=0.00026 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.127 | 5271.4 samples/s | 82.4 steps/s
[Step=38050 Epoch=362.0] | Loss=0.00028 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=16.134 | 4705.3 samples/s | 73.5 steps/s
[Step=38100 Epoch=362.4] | Loss=0.00035 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=16.144 | 8180.1 samples/s | 127.8 steps/s
[Step=38150 Epoch=362.9] | Loss=0.00033 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=16.153 | 2323.6 samples/s | 36.3 steps/s
[Step=38200 Epoch=363.4] | Loss=0.00034 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=16.162 | 7455.7 samples/s | 116.5 steps/s
[Step=38250 Epoch=363.9] | Loss=0.00033 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=16.170 | 2425.9 samples/s | 37.9 steps/s
[Step=38300 Epoch=364.3] | Loss=0.00034 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=16.179 | 6696.9 samples/s | 104.6 steps/s
[Step=38350 Epoch=364.8] | Loss=0.00032 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=16.187 | 2546.4 samples/s | 39.8 steps/s
[Step=38400 Epoch=365.3] | Loss=0.00033 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=16.195 | 5964.5 samples/s | 93.2 steps/s
[Step=38450 Epoch=365.8] | Loss=0.00034 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=16.202 | 2621.0 samples/s | 41.0 steps/s
[Step=38500 Epoch=366.2] | Loss=0.00034 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=16.210 | 5531.6 samples/s | 86.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=38501 Epoch=366.2] | Loss=0.00080 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=16.288 | 5682.0 samples/s | 88.8 steps/s
[Step=38550 Epoch=366.7] | Loss=0.00015 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.614 | L2-Norm(final)=16.292 | 4182.5 samples/s | 65.4 steps/s
[Step=38600 Epoch=367.2] | Loss=0.00010 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.614 | L2-Norm(final)=16.294 | 6676.1 samples/s | 104.3 steps/s
[Step=38650 Epoch=367.7] | Loss=0.00007 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.610 | L2-Norm(final)=16.295 | 2201.7 samples/s | 34.4 steps/s
[Step=38700 Epoch=368.1] | Loss=0.00005 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.296 | 6029.4 samples/s | 94.2 steps/s
[Step=38750 Epoch=368.6] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.600 | L2-Norm(final)=16.297 | 2297.1 samples/s | 35.9 steps/s
[Step=38800 Epoch=369.1] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=16.298 | 5435.5 samples/s | 84.9 steps/s
[Step=38850 Epoch=369.6] | Loss=0.00003 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.588 | L2-Norm(final)=16.298 | 2356.3 samples/s | 36.8 steps/s
[Step=38900 Epoch=370.0] | Loss=0.00003 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.582 | L2-Norm(final)=16.299 | 5130.0 samples/s | 80.2 steps/s
[Step=38950 Epoch=370.5] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=16.299 | 2435.3 samples/s | 38.1 steps/s
[Step=39000 Epoch=371.0] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.569 | L2-Norm(final)=16.299 | 4787.7 samples/s | 74.8 steps/s
[Step=39050 Epoch=371.5] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.562 | L2-Norm(final)=16.300 | 2532.3 samples/s | 39.6 steps/s
[Step=39100 Epoch=371.9] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.556 | L2-Norm(final)=16.300 | 4642.3 samples/s | 72.5 steps/s
[Step=39150 Epoch=372.4] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.549 | L2-Norm(final)=16.300 | 2539.6 samples/s | 39.7 steps/s
[Step=39200 Epoch=372.9] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.542 | L2-Norm(final)=16.301 | 4593.6 samples/s | 71.8 steps/s
[Step=39250 Epoch=373.4] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.535 | L2-Norm(final)=16.301 | 2612.2 samples/s | 40.8 steps/s
[Step=39300 Epoch=373.8] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.528 | L2-Norm(final)=16.301 | 4640.5 samples/s | 72.5 steps/s
[Step=39350 Epoch=374.3] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.521 | L2-Norm(final)=16.302 | 2814.0 samples/s | 44.0 steps/s
[Step=39400 Epoch=374.8] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=16.302 | 3982.1 samples/s | 62.2 steps/s
[Step=39450 Epoch=375.3] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.506 | L2-Norm(final)=16.302 | 6967.9 samples/s | 108.9 steps/s
[Step=39500 Epoch=375.7] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.499 | L2-Norm(final)=16.303 | 2189.6 samples/s | 34.2 steps/s
[Step=39550 Epoch=376.2] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.491 | L2-Norm(final)=16.303 | 6234.2 samples/s | 97.4 steps/s
[Step=39600 Epoch=376.7] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.484 | L2-Norm(final)=16.303 | 2275.2 samples/s | 35.6 steps/s
[Step=39650 Epoch=377.2] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.476 | L2-Norm(final)=16.304 | 5683.5 samples/s | 88.8 steps/s
[Step=39700 Epoch=377.6] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.468 | L2-Norm(final)=16.304 | 2325.0 samples/s | 36.3 steps/s
[Step=39750 Epoch=378.1] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.460 | L2-Norm(final)=16.304 | 5302.9 samples/s | 82.9 steps/s
[Step=39800 Epoch=378.6] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.452 | L2-Norm(final)=16.304 | 2404.5 samples/s | 37.6 steps/s
[Step=39850 Epoch=379.1] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.444 | L2-Norm(final)=16.305 | 4815.0 samples/s | 75.2 steps/s
[Step=39900 Epoch=379.5] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.436 | L2-Norm(final)=16.305 | 2463.9 samples/s | 38.5 steps/s
[Step=39950 Epoch=380.0] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.428 | L2-Norm(final)=16.305 | 4653.6 samples/s | 72.7 steps/s
[Step=40000 Epoch=380.5] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.420 | L2-Norm(final)=16.306 | 2550.7 samples/s | 39.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step40000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=44001 Epoch=414.6] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=16.631 | 5550.5 samples/s | 86.7 steps/s
[Step=44050 Epoch=415.1] | Loss=0.00020 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=16.633 | 4677.6 samples/s | 73.1 steps/s
[Step=44100 Epoch=415.5] | Loss=0.00023 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=16.637 | 8099.9 samples/s | 126.6 steps/s
[Step=44150 Epoch=416.0] | Loss=0.00026 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=16.639 | 2363.9 samples/s | 36.9 steps/s
[Step=44200 Epoch=416.5] | Loss=0.00024 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=16.642 | 7217.3 samples/s | 112.8 steps/s
[Step=44250 Epoch=417.0] | Loss=0.00024 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=16.644 | 2476.4 samples/s | 38.7 steps/s
[Step=44300 Epoch=417.4] | Loss=0.00024 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=16.647 | 6250.6 samples/s | 97.7 steps/s
[Step=44350 Epoch=417.9] | Loss=0.00024 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=16.649 | 2616.2 samples/s | 40.9 steps/s
[Step=44400 Epoch=418.4] | Loss=0.00025 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=16.651 | 5444.9 samples/s | 85.1 steps/s
[Step=44450 Epoch=418.8] | Loss=0.00024 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=16.654 | 2715.2 samples/s | 42.4 steps/s
[Step=44500 Epoch=419.3] | Loss=0.00024 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=16.657 | 5295.9 samples/s | 82.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=419.3] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=16.683 | 5242.1 samples/s | 81.9 steps/s
[Step=44550 Epoch=419.8] | Loss=0.00014 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.611 | L2-Norm(final)=16.684 | 4455.4 samples/s | 69.6 steps/s
[Step=44600 Epoch=420.3] | Loss=0.00008 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.611 | L2-Norm(final)=16.685 | 6620.3 samples/s | 103.4 steps/s
[Step=44650 Epoch=420.7] | Loss=0.00006 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.607 | L2-Norm(final)=16.686 | 2211.8 samples/s | 34.6 steps/s
[Step=44700 Epoch=421.2] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.602 | L2-Norm(final)=16.687 | 5828.2 samples/s | 91.1 steps/s
[Step=44750 Epoch=421.7] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.597 | L2-Norm(final)=16.687 | 2318.2 samples/s | 36.2 steps/s
[Step=44800 Epoch=422.1] | Loss=0.00003 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=16.688 | 5275.0 samples/s | 82.4 steps/s
[Step=44850 Epoch=422.6] | Loss=0.00003 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.585 | L2-Norm(final)=16.688 | 2420.9 samples/s | 37.8 steps/s
[Step=44900 Epoch=423.1] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.579 | L2-Norm(final)=16.688 | 4881.7 samples/s | 76.3 steps/s
[Step=44950 Epoch=423.6] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.573 | L2-Norm(final)=16.689 | 2502.3 samples/s | 39.1 steps/s
[Step=45000 Epoch=424.0] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.567 | L2-Norm(final)=16.689 | 4639.1 samples/s | 72.5 steps/s
[Step=45050 Epoch=424.5] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.560 | L2-Norm(final)=16.689 | 2581.0 samples/s | 40.3 steps/s
[Step=45100 Epoch=425.0] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.554 | L2-Norm(final)=16.690 | 4645.8 samples/s | 72.6 steps/s
[Step=45150 Epoch=425.4] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.547 | L2-Norm(final)=16.690 | 2554.3 samples/s | 39.9 steps/s
[Step=45200 Epoch=425.9] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.541 | L2-Norm(final)=16.690 | 4576.9 samples/s | 71.5 steps/s
[Step=45250 Epoch=426.4] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.534 | L2-Norm(final)=16.690 | 2802.5 samples/s | 43.8 steps/s
[Step=45300 Epoch=426.9] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.527 | L2-Norm(final)=16.690 | 3996.6 samples/s | 62.4 steps/s
[Step=45350 Epoch=427.3] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.521 | L2-Norm(final)=16.691 | 6703.3 samples/s | 104.7 steps/s
[Step=45400 Epoch=427.8] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=16.691 | 2176.3 samples/s | 34.0 steps/s
[Step=45450 Epoch=428.3] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.507 | L2-Norm(final)=16.691 | 6035.5 samples/s | 94.3 steps/s
[Step=45500 Epoch=428.7] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.500 | L2-Norm(final)=16.691 | 2284.9 samples/s | 35.7 steps/s
[Step=45550 Epoch=429.2] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.493 | L2-Norm(final)=16.692 | 5414.6 samples/s | 84.6 steps/s
[Step=45600 Epoch=429.7] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.485 | L2-Norm(final)=16.692 | 2362.9 samples/s | 36.9 steps/s
[Step=45650 Epoch=430.2] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.478 | L2-Norm(final)=16.692 | 4965.5 samples/s | 77.6 steps/s
[Step=45700 Epoch=430.6] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.471 | L2-Norm(final)=16.692 | 2531.7 samples/s | 39.6 steps/s
[Step=45750 Epoch=431.1] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.463 | L2-Norm(final)=16.693 | 4579.7 samples/s | 71.6 steps/s
[Step=45800 Epoch=431.6] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.456 | L2-Norm(final)=16.693 | 2558.2 samples/s | 40.0 steps/s
[Step=45850 Epoch=432.0] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.448 | L2-Norm(final)=16.693 | 4592.3 samples/s | 71.8 steps/s
[Step=45900 Epoch=432.5] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.440 | L2-Norm(final)=16.693 | 2568.0 samples/s | 40.1 steps/s
[Step=45950 Epoch=433.0] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.433 | L2-Norm(final)=16.694 | 4623.1 samples/s | 72.2 steps/s
[Step=46000 Epoch=433.5] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.425 | L2-Norm(final)=16.694 | 2580.4 samples/s | 40.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step46000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07594 | acc=0.9642 | tpr=0.9715 | fpr=0.0515 | 5522.3 samples/s | 21.6 steps/s
Avg test loss: 0.08377, Avg test acc: 0.96218, Avg tpr: 0.97074, Avg fpr: 0.05666, total FA: 442

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08024 | acc=0.9662 | tpr=0.9777 | fpr=0.0590 | 5565.5 samples/s | 21.7 steps/s
Avg test loss: 0.08869, Avg test acc: 0.96446, Avg tpr: 0.97610, Avg fpr: 0.06115, total FA: 477

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.07935 | acc=0.9649 | tpr=0.9781 | fpr=0.0637 | 5833.1 samples/s | 22.8 steps/s
Avg test loss: 0.08702, Avg test acc: 0.96326, Avg tpr: 0.97552, Avg fpr: 0.06371, total FA: 497

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.07785 | acc=0.9643 | tpr=0.9768 | fpr=0.0629 | 5710.4 samples/s | 22.3 steps/s
Avg test loss: 0.08631, Avg test acc: 0.96422, Avg tpr: 0.97680, Avg fpr: 0.06345, total FA: 495

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.07501 | acc=0.9660 | tpr=0.9743 | fpr=0.0520 | 5771.2 samples/s | 22.5 steps/s
Avg test loss: 0.08638, Avg test acc: 0.96434, Avg tpr: 0.97290, Avg fpr: 0.05448, total FA: 425

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.54022 | acc=0.2646 | tpr=0.0056 | fpr=0.1729 | 5716.5 samples/s | 22.3 steps/s
Avg test loss: 5.54969, Avg test acc: 0.26248, Avg tpr: 0.00571, Avg fpr: 0.17280, total FA: 1348

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.68202 | acc=0.2967 | tpr=0.0172 | fpr=0.0964 | 5626.9 samples/s | 22.0 steps/s
Avg test loss: 4.69034, Avg test acc: 0.29449, Avg tpr: 0.01813, Avg fpr: 0.09768, total FA: 762

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.28696 | acc=0.2377 | tpr=0.0138 | fpr=0.2760 | 5680.0 samples/s | 22.2 steps/s
Avg test loss: 5.29169, Avg test acc: 0.23768, Avg tpr: 0.01469, Avg fpr: 0.27189, total FA: 2121

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=6.10744 | acc=0.2398 | tpr=0.0097 | fpr=0.2604 | 5601.1 samples/s | 21.9 steps/s
Avg test loss: 6.11514, Avg test acc: 0.23924, Avg tpr: 0.00968, Avg fpr: 0.25586, total FA: 1996

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.54321 | acc=0.2373 | tpr=0.0067 | fpr=0.2621 | 5439.8 samples/s | 21.2 steps/s
Avg test loss: 5.54691, Avg test acc: 0.23724, Avg tpr: 0.00758, Avg fpr: 0.25766, total FA: 2010

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.96433 | acc=0.1566 | tpr=0.2035 | fpr=0.8442 | 5864.1 samples/s | 22.9 steps/s
[Step= 100] | Loss=4.92097 | acc=0.1578 | tpr=0.1834 | fpr=0.8427 | 7962.0 samples/s | 31.1 steps/s
[Step= 150] | Loss=4.93939 | acc=0.1573 | tpr=0.1816 | fpr=0.8432 | 8105.5 samples/s | 31.7 steps/s
[Step= 200] | Loss=4.93339 | acc=0.1573 | tpr=0.1792 | fpr=0.8431 | 7276.9 samples/s | 28.4 steps/s
[Step= 250] | Loss=4.94030 | acc=0.1576 | tpr=0.1799 | fpr=0.8428 | 7964.4 samples/s | 31.1 steps/s
[Step= 300] | Loss=4.94460 | acc=0.1571 | tpr=0.1833 | fpr=0.8434 | 8509.3 samples/s | 33.2 steps/s
[Step= 350] | Loss=4.94686 | acc=0.1570 | tpr=0.1753 | fpr=0.8433 | 7973.5 samples/s | 31.1 steps/s
[Step= 400] | Loss=4.94572 | acc=0.1574 | tpr=0.1789 | fpr=0.8429 | 8407.5 samples/s | 32.8 steps/s
[Step= 450] | Loss=4.94490 | acc=0.1578 | tpr=0.1767 | fpr=0.8426 | 7872.8 samples/s | 30.8 steps/s
[Step= 500] | Loss=4.94814 | acc=0.1576 | tpr=0.1806 | fpr=0.8428 | 7925.7 samples/s | 31.0 steps/s
[Step= 550] | Loss=4.94627 | acc=0.1576 | tpr=0.1779 | fpr=0.8427 | 10208.7 samples/s | 39.9 steps/s
Avg test loss: 4.94588, Avg test acc: 0.15753, Avg tpr: 0.17789, Avg fpr: 0.84284, total FA: 117026

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.14920 | acc=0.1421 | tpr=0.2124 | fpr=0.8592 | 5717.2 samples/s | 22.3 steps/s
[Step= 100] | Loss=5.10375 | acc=0.1454 | tpr=0.1983 | fpr=0.8556 | 7649.7 samples/s | 29.9 steps/s
[Step= 150] | Loss=5.11942 | acc=0.1432 | tpr=0.1960 | fpr=0.8577 | 7415.4 samples/s | 29.0 steps/s
[Step= 200] | Loss=5.11620 | acc=0.1432 | tpr=0.1825 | fpr=0.8575 | 7989.4 samples/s | 31.2 steps/s
[Step= 250] | Loss=5.12284 | acc=0.1431 | tpr=0.1799 | fpr=0.8576 | 8149.2 samples/s | 31.8 steps/s
[Step= 300] | Loss=5.12505 | acc=0.1423 | tpr=0.1811 | fpr=0.8584 | 8103.9 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.12697 | acc=0.1419 | tpr=0.1697 | fpr=0.8586 | 8189.7 samples/s | 32.0 steps/s
[Step= 400] | Loss=5.12636 | acc=0.1424 | tpr=0.1772 | fpr=0.8582 | 8174.5 samples/s | 31.9 steps/s
[Step= 450] | Loss=5.12492 | acc=0.1428 | tpr=0.1767 | fpr=0.8579 | 8305.9 samples/s | 32.4 steps/s
[Step= 500] | Loss=5.12849 | acc=0.1426 | tpr=0.1802 | fpr=0.8581 | 8474.4 samples/s | 33.1 steps/s
[Step= 550] | Loss=5.12659 | acc=0.1429 | tpr=0.1795 | fpr=0.8578 | 9965.1 samples/s | 38.9 steps/s
Avg test loss: 5.12675, Avg test acc: 0.14274, Avg tpr: 0.17948, Avg fpr: 0.85792, total FA: 119121

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.53125 | acc=0.1338 | tpr=0.1327 | fpr=0.8662 | 5767.8 samples/s | 22.5 steps/s
[Step= 100] | Loss=5.48760 | acc=0.1359 | tpr=0.1279 | fpr=0.8640 | 7944.8 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.49823 | acc=0.1348 | tpr=0.1254 | fpr=0.8650 | 7827.9 samples/s | 30.6 steps/s
[Step= 200] | Loss=5.49200 | acc=0.1352 | tpr=0.1246 | fpr=0.8646 | 8272.7 samples/s | 32.3 steps/s
[Step= 250] | Loss=5.49624 | acc=0.1351 | tpr=0.1214 | fpr=0.8646 | 7953.2 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.50235 | acc=0.1347 | tpr=0.1229 | fpr=0.8650 | 8415.4 samples/s | 32.9 steps/s
[Step= 350] | Loss=5.50651 | acc=0.1341 | tpr=0.1183 | fpr=0.8656 | 8070.7 samples/s | 31.5 steps/s
[Step= 400] | Loss=5.50506 | acc=0.1345 | tpr=0.1253 | fpr=0.8653 | 7867.7 samples/s | 30.7 steps/s
[Step= 450] | Loss=5.50379 | acc=0.1348 | tpr=0.1246 | fpr=0.8651 | 8080.3 samples/s | 31.6 steps/s
[Step= 500] | Loss=5.50575 | acc=0.1346 | tpr=0.1264 | fpr=0.8653 | 8199.3 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.50252 | acc=0.1350 | tpr=0.1261 | fpr=0.8648 | 9525.3 samples/s | 37.2 steps/s
Avg test loss: 5.50241, Avg test acc: 0.13497, Avg tpr: 0.12639, Avg fpr: 0.86487, total FA: 120086

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.11572 | acc=0.1470 | tpr=0.1947 | fpr=0.8538 | 5666.0 samples/s | 22.1 steps/s
[Step= 100] | Loss=5.07320 | acc=0.1490 | tpr=0.1940 | fpr=0.8518 | 7643.1 samples/s | 29.9 steps/s
[Step= 150] | Loss=5.08962 | acc=0.1477 | tpr=0.1888 | fpr=0.8531 | 8630.6 samples/s | 33.7 steps/s
[Step= 200] | Loss=5.08220 | acc=0.1479 | tpr=0.1792 | fpr=0.8527 | 8136.9 samples/s | 31.8 steps/s
[Step= 250] | Loss=5.08789 | acc=0.1483 | tpr=0.1782 | fpr=0.8523 | 8126.4 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.09374 | acc=0.1473 | tpr=0.1811 | fpr=0.8533 | 8267.6 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.09523 | acc=0.1468 | tpr=0.1735 | fpr=0.8537 | 8017.4 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.09463 | acc=0.1470 | tpr=0.1789 | fpr=0.8535 | 7342.1 samples/s | 28.7 steps/s
[Step= 450] | Loss=5.09355 | acc=0.1473 | tpr=0.1772 | fpr=0.8533 | 8684.8 samples/s | 33.9 steps/s
[Step= 500] | Loss=5.09684 | acc=0.1471 | tpr=0.1793 | fpr=0.8535 | 7969.8 samples/s | 31.1 steps/s
[Step= 550] | Loss=5.09402 | acc=0.1473 | tpr=0.1819 | fpr=0.8533 | 9802.1 samples/s | 38.3 steps/s
Avg test loss: 5.09372, Avg test acc: 0.14725, Avg tpr: 0.18185, Avg fpr: 0.85338, total FA: 118490

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.33050 | acc=0.1490 | tpr=0.1416 | fpr=0.8509 | 5772.5 samples/s | 22.5 steps/s
[Step= 100] | Loss=5.28129 | acc=0.1512 | tpr=0.1343 | fpr=0.8484 | 8128.3 samples/s | 31.8 steps/s
[Step= 150] | Loss=5.29942 | acc=0.1501 | tpr=0.1254 | fpr=0.8494 | 7829.1 samples/s | 30.6 steps/s
[Step= 200] | Loss=5.29644 | acc=0.1500 | tpr=0.1224 | fpr=0.8495 | 7492.3 samples/s | 29.3 steps/s
[Step= 250] | Loss=5.30344 | acc=0.1499 | tpr=0.1231 | fpr=0.8496 | 8249.0 samples/s | 32.2 steps/s
[Step= 300] | Loss=5.30622 | acc=0.1495 | tpr=0.1244 | fpr=0.8500 | 7880.5 samples/s | 30.8 steps/s
[Step= 350] | Loss=5.30966 | acc=0.1491 | tpr=0.1209 | fpr=0.8504 | 8433.6 samples/s | 32.9 steps/s
[Step= 400] | Loss=5.30859 | acc=0.1492 | tpr=0.1220 | fpr=0.8503 | 7712.3 samples/s | 30.1 steps/s
[Step= 450] | Loss=5.30759 | acc=0.1495 | tpr=0.1232 | fpr=0.8500 | 9053.0 samples/s | 35.4 steps/s
[Step= 500] | Loss=5.31113 | acc=0.1492 | tpr=0.1247 | fpr=0.8503 | 7640.6 samples/s | 29.8 steps/s
[Step= 550] | Loss=5.30775 | acc=0.1493 | tpr=0.1242 | fpr=0.8502 | 10811.3 samples/s | 42.2 steps/s
Avg test loss: 5.30749, Avg test acc: 0.14920, Avg tpr: 0.12401, Avg fpr: 0.85035, total FA: 118069

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10983 | acc=0.9807 | tpr=0.9248 | fpr=0.0183 | 5703.3 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.11107 | acc=0.9807 | tpr=0.9403 | fpr=0.0185 | 7761.8 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.11484 | acc=0.9804 | tpr=0.9467 | fpr=0.0190 | 8336.8 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.11684 | acc=0.9805 | tpr=0.9519 | fpr=0.0190 | 8137.9 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.11756 | acc=0.9803 | tpr=0.9476 | fpr=0.0191 | 7987.5 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.11904 | acc=0.9802 | tpr=0.9469 | fpr=0.0192 | 7976.7 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.11919 | acc=0.9802 | tpr=0.9505 | fpr=0.0193 | 7472.0 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.12019 | acc=0.9801 | tpr=0.9464 | fpr=0.0193 | 8086.6 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.12253 | acc=0.9797 | tpr=0.9445 | fpr=0.0197 | 8217.3 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.12156 | acc=0.9798 | tpr=0.9463 | fpr=0.0196 | 8729.5 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.12062 | acc=0.9799 | tpr=0.9463 | fpr=0.0195 | 9904.8 samples/s | 38.7 steps/s
Avg test loss: 0.12039, Avg test acc: 0.97994, Avg tpr: 0.94612, Avg fpr: 0.01945, total FA: 2700

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10676 | acc=0.9807 | tpr=0.9204 | fpr=0.0182 | 5770.6 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.10820 | acc=0.9803 | tpr=0.9382 | fpr=0.0189 | 7894.7 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.11173 | acc=0.9795 | tpr=0.9409 | fpr=0.0198 | 7794.2 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.11307 | acc=0.9794 | tpr=0.9388 | fpr=0.0198 | 8197.7 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.11381 | acc=0.9795 | tpr=0.9354 | fpr=0.0197 | 8308.6 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.11558 | acc=0.9791 | tpr=0.9345 | fpr=0.0200 | 7395.3 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.11552 | acc=0.9791 | tpr=0.9361 | fpr=0.0201 | 8075.4 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.11650 | acc=0.9789 | tpr=0.9316 | fpr=0.0202 | 7744.3 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.11842 | acc=0.9787 | tpr=0.9299 | fpr=0.0204 | 8370.0 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.11750 | acc=0.9788 | tpr=0.9326 | fpr=0.0203 | 8128.7 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.11639 | acc=0.9790 | tpr=0.9316 | fpr=0.0202 | 10706.5 samples/s | 41.8 steps/s
Avg test loss: 0.11617, Avg test acc: 0.97901, Avg tpr: 0.93106, Avg fpr: 0.02012, total FA: 2794

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11814 | acc=0.9782 | tpr=0.9381 | fpr=0.0211 | 5721.7 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.11968 | acc=0.9787 | tpr=0.9574 | fpr=0.0209 | 7843.9 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.12431 | acc=0.9779 | tpr=0.9568 | fpr=0.0217 | 8061.1 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.12593 | acc=0.9780 | tpr=0.9607 | fpr=0.0216 | 8255.2 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.12695 | acc=0.9780 | tpr=0.9598 | fpr=0.0217 | 7679.3 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.12800 | acc=0.9779 | tpr=0.9593 | fpr=0.0218 | 8108.3 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.12803 | acc=0.9778 | tpr=0.9618 | fpr=0.0219 | 8103.9 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.12886 | acc=0.9775 | tpr=0.9590 | fpr=0.0221 | 8127.7 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.13107 | acc=0.9772 | tpr=0.9567 | fpr=0.0224 | 8283.6 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.13030 | acc=0.9773 | tpr=0.9581 | fpr=0.0223 | 8309.0 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.12922 | acc=0.9775 | tpr=0.9570 | fpr=0.0222 | 9532.6 samples/s | 37.2 steps/s
Avg test loss: 0.12895, Avg test acc: 0.97748, Avg tpr: 0.95681, Avg fpr: 0.02215, total FA: 3075

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10670 | acc=0.9802 | tpr=0.9336 | fpr=0.0190 | 5756.2 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.10873 | acc=0.9803 | tpr=0.9446 | fpr=0.0191 | 8238.1 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.11163 | acc=0.9800 | tpr=0.9481 | fpr=0.0194 | 7557.3 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.11314 | acc=0.9801 | tpr=0.9519 | fpr=0.0194 | 7609.8 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.11391 | acc=0.9800 | tpr=0.9476 | fpr=0.0194 | 8260.0 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.11488 | acc=0.9799 | tpr=0.9469 | fpr=0.0195 | 8376.4 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.11481 | acc=0.9800 | tpr=0.9499 | fpr=0.0195 | 7917.5 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.11577 | acc=0.9799 | tpr=0.9469 | fpr=0.0195 | 8315.0 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.11789 | acc=0.9796 | tpr=0.9450 | fpr=0.0198 | 8400.9 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.11691 | acc=0.9798 | tpr=0.9467 | fpr=0.0196 | 7726.3 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.11606 | acc=0.9798 | tpr=0.9451 | fpr=0.0195 | 10268.8 samples/s | 40.1 steps/s
Avg test loss: 0.11583, Avg test acc: 0.97986, Avg tpr: 0.94493, Avg fpr: 0.01950, total FA: 2708

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.11064 | acc=0.9807 | tpr=0.9248 | fpr=0.0183 | 5708.2 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.11310 | acc=0.9802 | tpr=0.9360 | fpr=0.0189 | 8041.6 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.11691 | acc=0.9797 | tpr=0.9424 | fpr=0.0196 | 7174.3 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.11845 | acc=0.9797 | tpr=0.9464 | fpr=0.0196 | 8482.8 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.11960 | acc=0.9797 | tpr=0.9432 | fpr=0.0196 | 8125.3 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.12083 | acc=0.9798 | tpr=0.9425 | fpr=0.0195 | 7897.4 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.12063 | acc=0.9799 | tpr=0.9449 | fpr=0.0195 | 8391.9 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.12150 | acc=0.9797 | tpr=0.9420 | fpr=0.0196 | 7951.7 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.12375 | acc=0.9794 | tpr=0.9416 | fpr=0.0199 | 8176.2 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.12277 | acc=0.9795 | tpr=0.9441 | fpr=0.0198 | 8373.4 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.12185 | acc=0.9796 | tpr=0.9419 | fpr=0.0197 | 10306.0 samples/s | 40.3 steps/s
Avg test loss: 0.12162, Avg test acc: 0.97961, Avg tpr: 0.94176, Avg fpr: 0.01971, total FA: 2736

server round 46/50

clients selected: [2 3 5 7 8]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=50001 Epoch=243.6] | Loss=0.00915 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.540 | L2-Norm(final)=15.241 | 6366.8 samples/s | 99.5 steps/s
[Step=50050 Epoch=243.9] | Loss=0.01441 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.540 | L2-Norm(final)=15.243 | 4722.4 samples/s | 73.8 steps/s
[Step=50100 Epoch=244.1] | Loss=0.01463 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.540 | L2-Norm(final)=15.244 | 5636.1 samples/s | 88.1 steps/s
[Step=50150 Epoch=244.4] | Loss=0.01381 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.540 | L2-Norm(final)=15.246 | 5766.9 samples/s | 90.1 steps/s
[Step=50200 Epoch=244.6] | Loss=0.01512 | Reg=0.00091 | acc=0.9688 | L2-Norm=9.540 | L2-Norm(final)=15.247 | 8435.4 samples/s | 131.8 steps/s
[Step=50250 Epoch=244.8] | Loss=0.01469 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.540 | L2-Norm(final)=15.248 | 2433.1 samples/s | 38.0 steps/s
[Step=50300 Epoch=245.1] | Loss=0.01426 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.540 | L2-Norm(final)=15.249 | 5825.5 samples/s | 91.0 steps/s
[Step=50350 Epoch=245.3] | Loss=0.01484 | Reg=0.00091 | acc=0.9688 | L2-Norm=9.540 | L2-Norm(final)=15.251 | 5617.5 samples/s | 87.8 steps/s
[Step=50400 Epoch=245.6] | Loss=0.01507 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.540 | L2-Norm(final)=15.252 | 7598.5 samples/s | 118.7 steps/s
[Step=50450 Epoch=245.8] | Loss=0.01473 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.540 | L2-Norm(final)=15.253 | 2571.9 samples/s | 40.2 steps/s
[Step=50500 Epoch=246.1] | Loss=0.01485 | Reg=0.00091 | acc=0.9688 | L2-Norm=9.540 | L2-Norm(final)=15.254 | 5313.6 samples/s | 83.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=50501 Epoch=246.1] | Loss=0.02766 | Reg=0.00091 | acc=0.9688 | L2-Norm=9.540 | L2-Norm(final)=15.264 | 5871.7 samples/s | 91.7 steps/s
[Step=50550 Epoch=246.3] | Loss=0.01562 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.547 | L2-Norm(final)=15.264 | 4376.3 samples/s | 68.4 steps/s
[Step=50600 Epoch=246.5] | Loss=0.01318 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.554 | L2-Norm(final)=15.265 | 4841.0 samples/s | 75.6 steps/s
[Step=50650 Epoch=246.8] | Loss=0.01296 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.559 | L2-Norm(final)=15.266 | 4850.7 samples/s | 75.8 steps/s
[Step=50700 Epoch=247.0] | Loss=0.01251 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.564 | L2-Norm(final)=15.267 | 6963.9 samples/s | 108.8 steps/s
[Step=50750 Epoch=247.3] | Loss=0.01095 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.568 | L2-Norm(final)=15.269 | 2259.8 samples/s | 35.3 steps/s
[Step=50800 Epoch=247.5] | Loss=0.01001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.572 | L2-Norm(final)=15.271 | 4828.3 samples/s | 75.4 steps/s
[Step=50850 Epoch=247.8] | Loss=0.00926 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.576 | L2-Norm(final)=15.273 | 4872.8 samples/s | 76.1 steps/s
[Step=50900 Epoch=248.0] | Loss=0.00864 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.579 | L2-Norm(final)=15.275 | 6342.0 samples/s | 99.1 steps/s
[Step=50950 Epoch=248.3] | Loss=0.00813 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.582 | L2-Norm(final)=15.277 | 2400.5 samples/s | 37.5 steps/s
[Step=51000 Epoch=248.5] | Loss=0.00775 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.586 | L2-Norm(final)=15.279 | 4725.0 samples/s | 73.8 steps/s
[Step=51050 Epoch=248.7] | Loss=0.00740 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.589 | L2-Norm(final)=15.281 | 4888.2 samples/s | 76.4 steps/s
[Step=51100 Epoch=249.0] | Loss=0.00709 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=15.283 | 5810.8 samples/s | 90.8 steps/s
[Step=51150 Epoch=249.2] | Loss=0.00682 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=15.285 | 2424.2 samples/s | 37.9 steps/s
[Step=51200 Epoch=249.5] | Loss=0.00654 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.597 | L2-Norm(final)=15.287 | 4884.0 samples/s | 76.3 steps/s
[Step=51250 Epoch=249.7] | Loss=0.00633 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.599 | L2-Norm(final)=15.289 | 4894.2 samples/s | 76.5 steps/s
[Step=51300 Epoch=250.0] | Loss=0.00615 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.602 | L2-Norm(final)=15.291 | 5327.5 samples/s | 83.2 steps/s
[Step=51350 Epoch=250.2] | Loss=0.00596 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=15.293 | 2504.3 samples/s | 39.1 steps/s
[Step=51400 Epoch=250.4] | Loss=0.00582 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=15.295 | 4857.3 samples/s | 75.9 steps/s
[Step=51450 Epoch=250.7] | Loss=0.00570 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.608 | L2-Norm(final)=15.297 | 4887.2 samples/s | 76.4 steps/s
[Step=51500 Epoch=250.9] | Loss=0.00556 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.611 | L2-Norm(final)=15.299 | 4914.1 samples/s | 76.8 steps/s
[Step=51550 Epoch=251.2] | Loss=0.00546 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.613 | L2-Norm(final)=15.301 | 2622.3 samples/s | 41.0 steps/s
[Step=51600 Epoch=251.4] | Loss=0.00532 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.615 | L2-Norm(final)=15.302 | 4842.5 samples/s | 75.7 steps/s
[Step=51650 Epoch=251.7] | Loss=0.00518 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.617 | L2-Norm(final)=15.304 | 4859.6 samples/s | 75.9 steps/s
[Step=51700 Epoch=251.9] | Loss=0.00505 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.619 | L2-Norm(final)=15.306 | 4859.8 samples/s | 75.9 steps/s
[Step=51750 Epoch=252.2] | Loss=0.00502 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.621 | L2-Norm(final)=15.308 | 2660.3 samples/s | 41.6 steps/s
[Step=51800 Epoch=252.4] | Loss=0.00490 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.623 | L2-Norm(final)=15.309 | 4886.8 samples/s | 76.4 steps/s
[Step=51850 Epoch=252.6] | Loss=0.00480 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.624 | L2-Norm(final)=15.311 | 4825.5 samples/s | 75.4 steps/s
[Step=51900 Epoch=252.9] | Loss=0.00471 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.626 | L2-Norm(final)=15.313 | 4896.5 samples/s | 76.5 steps/s
[Step=51950 Epoch=253.1] | Loss=0.00467 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.628 | L2-Norm(final)=15.314 | 2644.8 samples/s | 41.3 steps/s
[Step=52000 Epoch=253.4] | Loss=0.00455 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.630 | L2-Norm(final)=15.316 | 4911.1 samples/s | 76.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step52000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=54001 Epoch=263.3] | Loss=0.00388 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.540 | L2-Norm(final)=15.757 | 5959.4 samples/s | 93.1 steps/s
[Step=54050 Epoch=263.6] | Loss=0.01092 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.540 | L2-Norm(final)=15.759 | 5014.3 samples/s | 78.3 steps/s
[Step=54100 Epoch=263.8] | Loss=0.01182 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.540 | L2-Norm(final)=15.760 | 5579.4 samples/s | 87.2 steps/s
[Step=54150 Epoch=264.1] | Loss=0.01321 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.540 | L2-Norm(final)=15.761 | 5640.0 samples/s | 88.1 steps/s
[Step=54200 Epoch=264.3] | Loss=0.01372 | Reg=0.00091 | acc=0.9688 | L2-Norm=9.540 | L2-Norm(final)=15.762 | 8761.7 samples/s | 136.9 steps/s
[Step=54250 Epoch=264.6] | Loss=0.01397 | Reg=0.00091 | acc=0.9688 | L2-Norm=9.540 | L2-Norm(final)=15.763 | 2413.8 samples/s | 37.7 steps/s
[Step=54300 Epoch=264.8] | Loss=0.01399 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.540 | L2-Norm(final)=15.764 | 5673.9 samples/s | 88.7 steps/s
[Step=54350 Epoch=265.0] | Loss=0.01363 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.540 | L2-Norm(final)=15.765 | 5582.4 samples/s | 87.2 steps/s
[Step=54400 Epoch=265.3] | Loss=0.01357 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.540 | L2-Norm(final)=15.766 | 7785.2 samples/s | 121.6 steps/s
[Step=54450 Epoch=265.5] | Loss=0.01359 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.540 | L2-Norm(final)=15.767 | 2511.7 samples/s | 39.2 steps/s
[Step=54500 Epoch=265.8] | Loss=0.01385 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.540 | L2-Norm(final)=15.768 | 5700.9 samples/s | 89.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=54501 Epoch=265.8] | Loss=0.07849 | Reg=0.00091 | acc=0.9688 | L2-Norm=9.540 | L2-Norm(final)=15.776 | 5733.0 samples/s | 89.6 steps/s
[Step=54550 Epoch=266.0] | Loss=0.01270 | Reg=0.00091 | acc=0.9688 | L2-Norm=9.546 | L2-Norm(final)=15.776 | 4400.2 samples/s | 68.8 steps/s
[Step=54600 Epoch=266.3] | Loss=0.01267 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.553 | L2-Norm(final)=15.777 | 4907.1 samples/s | 76.7 steps/s
[Step=54650 Epoch=266.5] | Loss=0.01228 | Reg=0.00091 | acc=0.9688 | L2-Norm=9.558 | L2-Norm(final)=15.778 | 4789.4 samples/s | 74.8 steps/s
[Step=54700 Epoch=266.7] | Loss=0.01140 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.563 | L2-Norm(final)=15.779 | 7002.5 samples/s | 109.4 steps/s
[Step=54750 Epoch=267.0] | Loss=0.01023 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.567 | L2-Norm(final)=15.780 | 2265.1 samples/s | 35.4 steps/s
[Step=54800 Epoch=267.2] | Loss=0.00928 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.570 | L2-Norm(final)=15.782 | 4883.1 samples/s | 76.3 steps/s
[Step=54850 Epoch=267.5] | Loss=0.00860 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.573 | L2-Norm(final)=15.784 | 4818.4 samples/s | 75.3 steps/s
[Step=54900 Epoch=267.7] | Loss=0.00792 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=15.785 | 6287.5 samples/s | 98.2 steps/s
[Step=54950 Epoch=268.0] | Loss=0.00734 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.579 | L2-Norm(final)=15.787 | 2357.8 samples/s | 36.8 steps/s
[Step=55000 Epoch=268.2] | Loss=0.00697 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.582 | L2-Norm(final)=15.789 | 4797.2 samples/s | 75.0 steps/s
[Step=55050 Epoch=268.5] | Loss=0.00669 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.584 | L2-Norm(final)=15.791 | 4844.3 samples/s | 75.7 steps/s
[Step=55100 Epoch=268.7] | Loss=0.00645 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.586 | L2-Norm(final)=15.792 | 5845.0 samples/s | 91.3 steps/s
[Step=55150 Epoch=268.9] | Loss=0.00615 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.589 | L2-Norm(final)=15.794 | 2406.7 samples/s | 37.6 steps/s
[Step=55200 Epoch=269.2] | Loss=0.00597 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=15.796 | 4881.2 samples/s | 76.3 steps/s
[Step=55250 Epoch=269.4] | Loss=0.00576 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=15.797 | 4846.9 samples/s | 75.7 steps/s
[Step=55300 Epoch=269.7] | Loss=0.00560 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.595 | L2-Norm(final)=15.799 | 5360.0 samples/s | 83.7 steps/s
[Step=55350 Epoch=269.9] | Loss=0.00548 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.597 | L2-Norm(final)=15.800 | 2490.9 samples/s | 38.9 steps/s
[Step=55400 Epoch=270.2] | Loss=0.00532 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.599 | L2-Norm(final)=15.802 | 4876.6 samples/s | 76.2 steps/s
[Step=55450 Epoch=270.4] | Loss=0.00512 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.601 | L2-Norm(final)=15.804 | 4844.9 samples/s | 75.7 steps/s
[Step=55500 Epoch=270.6] | Loss=0.00503 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=15.805 | 5009.0 samples/s | 78.3 steps/s
[Step=55550 Epoch=270.9] | Loss=0.00497 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=15.807 | 2620.2 samples/s | 40.9 steps/s
[Step=55600 Epoch=271.1] | Loss=0.00486 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.606 | L2-Norm(final)=15.808 | 4849.2 samples/s | 75.8 steps/s
[Step=55650 Epoch=271.4] | Loss=0.00473 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.608 | L2-Norm(final)=15.810 | 4826.3 samples/s | 75.4 steps/s
[Step=55700 Epoch=271.6] | Loss=0.00462 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.610 | L2-Norm(final)=15.811 | 4856.5 samples/s | 75.9 steps/s
[Step=55750 Epoch=271.9] | Loss=0.00452 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.612 | L2-Norm(final)=15.813 | 2672.0 samples/s | 41.7 steps/s
[Step=55800 Epoch=272.1] | Loss=0.00445 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.613 | L2-Norm(final)=15.814 | 4770.2 samples/s | 74.5 steps/s
[Step=55850 Epoch=272.4] | Loss=0.00438 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.615 | L2-Norm(final)=15.816 | 4819.9 samples/s | 75.3 steps/s
[Step=55900 Epoch=272.6] | Loss=0.00428 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.617 | L2-Norm(final)=15.817 | 4901.7 samples/s | 76.6 steps/s
[Step=55950 Epoch=272.8] | Loss=0.00423 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.618 | L2-Norm(final)=15.819 | 2631.3 samples/s | 41.1 steps/s
[Step=56000 Epoch=273.1] | Loss=0.00416 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.620 | L2-Norm(final)=15.820 | 4854.5 samples/s | 75.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step56000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=42001 Epoch=398.0] | Loss=0.00131 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.540 | L2-Norm(final)=16.104 | 5489.2 samples/s | 85.8 steps/s
[Step=42050 Epoch=398.5] | Loss=0.00021 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.538 | L2-Norm(final)=16.111 | 4597.1 samples/s | 71.8 steps/s
[Step=42100 Epoch=398.9] | Loss=0.00021 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.538 | L2-Norm(final)=16.118 | 8417.0 samples/s | 131.5 steps/s
[Step=42150 Epoch=399.4] | Loss=0.00022 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.538 | L2-Norm(final)=16.126 | 2361.0 samples/s | 36.9 steps/s
[Step=42200 Epoch=399.9] | Loss=0.00021 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.538 | L2-Norm(final)=16.133 | 7277.0 samples/s | 113.7 steps/s
[Step=42250 Epoch=400.4] | Loss=0.00020 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.538 | L2-Norm(final)=16.138 | 2452.5 samples/s | 38.3 steps/s
[Step=42300 Epoch=400.8] | Loss=0.00021 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.538 | L2-Norm(final)=16.144 | 6599.0 samples/s | 103.1 steps/s
[Step=42350 Epoch=401.3] | Loss=0.00021 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.538 | L2-Norm(final)=16.150 | 2509.3 samples/s | 39.2 steps/s
[Step=42400 Epoch=401.8] | Loss=0.00022 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.538 | L2-Norm(final)=16.155 | 5916.7 samples/s | 92.4 steps/s
[Step=42450 Epoch=402.3] | Loss=0.00021 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.538 | L2-Norm(final)=16.161 | 2616.4 samples/s | 40.9 steps/s
[Step=42500 Epoch=402.7] | Loss=0.00021 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.538 | L2-Norm(final)=16.166 | 5491.4 samples/s | 85.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=402.7] | Loss=0.00009 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.538 | L2-Norm(final)=16.218 | 5575.8 samples/s | 87.1 steps/s
[Step=42550 Epoch=403.2] | Loss=0.00005 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=16.220 | 4285.0 samples/s | 67.0 steps/s
[Step=42600 Epoch=403.7] | Loss=0.00006 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.538 | L2-Norm(final)=16.222 | 6716.6 samples/s | 104.9 steps/s
[Step=42650 Epoch=404.1] | Loss=0.00005 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.223 | 2207.7 samples/s | 34.5 steps/s
[Step=42700 Epoch=404.6] | Loss=0.00004 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.533 | L2-Norm(final)=16.224 | 6112.7 samples/s | 95.5 steps/s
[Step=42750 Epoch=405.1] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.529 | L2-Norm(final)=16.225 | 2246.1 samples/s | 35.1 steps/s
[Step=42800 Epoch=405.6] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.525 | L2-Norm(final)=16.225 | 5590.2 samples/s | 87.3 steps/s
[Step=42850 Epoch=406.0] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.520 | L2-Norm(final)=16.226 | 2365.8 samples/s | 37.0 steps/s
[Step=42900 Epoch=406.5] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.516 | L2-Norm(final)=16.226 | 4995.5 samples/s | 78.1 steps/s
[Step=42950 Epoch=407.0] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.511 | L2-Norm(final)=16.227 | 2441.9 samples/s | 38.2 steps/s
[Step=43000 Epoch=407.5] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.507 | L2-Norm(final)=16.227 | 4759.2 samples/s | 74.4 steps/s
[Step=43050 Epoch=407.9] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.502 | L2-Norm(final)=16.228 | 2499.4 samples/s | 39.1 steps/s
[Step=43100 Epoch=408.4] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.497 | L2-Norm(final)=16.228 | 4644.3 samples/s | 72.6 steps/s
[Step=43150 Epoch=408.9] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.492 | L2-Norm(final)=16.229 | 2559.8 samples/s | 40.0 steps/s
[Step=43200 Epoch=409.4] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.487 | L2-Norm(final)=16.229 | 4626.1 samples/s | 72.3 steps/s
[Step=43250 Epoch=409.8] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.482 | L2-Norm(final)=16.229 | 2556.3 samples/s | 39.9 steps/s
[Step=43300 Epoch=410.3] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.477 | L2-Norm(final)=16.230 | 4641.4 samples/s | 72.5 steps/s
[Step=43350 Epoch=410.8] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.472 | L2-Norm(final)=16.230 | 2794.7 samples/s | 43.7 steps/s
[Step=43400 Epoch=411.3] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.467 | L2-Norm(final)=16.231 | 4138.9 samples/s | 64.7 steps/s
[Step=43450 Epoch=411.7] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.461 | L2-Norm(final)=16.231 | 6817.1 samples/s | 106.5 steps/s
[Step=43500 Epoch=412.2] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.456 | L2-Norm(final)=16.231 | 2199.2 samples/s | 34.4 steps/s
[Step=43550 Epoch=412.7] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.451 | L2-Norm(final)=16.232 | 6102.3 samples/s | 95.3 steps/s
[Step=43600 Epoch=413.1] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.445 | L2-Norm(final)=16.232 | 2251.2 samples/s | 35.2 steps/s
[Step=43650 Epoch=413.6] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.439 | L2-Norm(final)=16.233 | 5714.6 samples/s | 89.3 steps/s
[Step=43700 Epoch=414.1] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.434 | L2-Norm(final)=16.233 | 2302.3 samples/s | 36.0 steps/s
[Step=43750 Epoch=414.6] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.428 | L2-Norm(final)=16.233 | 5273.2 samples/s | 82.4 steps/s
[Step=43800 Epoch=415.0] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.422 | L2-Norm(final)=16.234 | 2422.8 samples/s | 37.9 steps/s
[Step=43850 Epoch=415.5] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.416 | L2-Norm(final)=16.234 | 4888.8 samples/s | 76.4 steps/s
[Step=43900 Epoch=416.0] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=16.234 | 2506.8 samples/s | 39.2 steps/s
[Step=43950 Epoch=416.5] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.404 | L2-Norm(final)=16.235 | 4668.5 samples/s | 72.9 steps/s
[Step=44000 Epoch=416.9] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.398 | L2-Norm(final)=16.235 | 2554.8 samples/s | 39.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_0/client_state-step44000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=44001 Epoch=420.2] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.540 | L2-Norm(final)=16.928 | 5647.1 samples/s | 88.2 steps/s
[Step=44050 Epoch=420.7] | Loss=0.00007 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.933 | 4908.7 samples/s | 76.7 steps/s
[Step=44100 Epoch=421.1] | Loss=0.00008 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.941 | 8544.9 samples/s | 133.5 steps/s
[Step=44150 Epoch=421.6] | Loss=0.00008 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.948 | 2355.5 samples/s | 36.8 steps/s
[Step=44200 Epoch=422.1] | Loss=0.00008 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.954 | 7313.6 samples/s | 114.3 steps/s
[Step=44250 Epoch=422.6] | Loss=0.00007 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.960 | 2394.4 samples/s | 37.4 steps/s
[Step=44300 Epoch=423.0] | Loss=0.00008 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.966 | 6941.8 samples/s | 108.5 steps/s
[Step=44350 Epoch=423.5] | Loss=0.00007 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.972 | 2457.2 samples/s | 38.4 steps/s
[Step=44400 Epoch=424.0] | Loss=0.00007 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.978 | 6429.1 samples/s | 100.5 steps/s
[Step=44450 Epoch=424.5] | Loss=0.00007 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.984 | 2549.1 samples/s | 39.8 steps/s
[Step=44500 Epoch=424.9] | Loss=0.00007 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.990 | 5850.9 samples/s | 91.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=425.0] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.535 | L2-Norm(final)=17.045 | 6030.2 samples/s | 94.2 steps/s
[Step=44550 Epoch=425.4] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.531 | L2-Norm(final)=17.047 | 4172.1 samples/s | 65.2 steps/s
[Step=44600 Epoch=425.9] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.522 | L2-Norm(final)=17.049 | 6653.7 samples/s | 104.0 steps/s
[Step=44650 Epoch=426.4] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.511 | L2-Norm(final)=17.050 | 2186.0 samples/s | 34.2 steps/s
[Step=44700 Epoch=426.9] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.498 | L2-Norm(final)=17.051 | 6210.2 samples/s | 97.0 steps/s
[Step=44750 Epoch=427.3] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.485 | L2-Norm(final)=17.052 | 2290.8 samples/s | 35.8 steps/s
[Step=44800 Epoch=427.8] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.471 | L2-Norm(final)=17.052 | 5614.6 samples/s | 87.7 steps/s
[Step=44850 Epoch=428.3] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.457 | L2-Norm(final)=17.052 | 2289.0 samples/s | 35.8 steps/s
[Step=44900 Epoch=428.8] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.444 | L2-Norm(final)=17.053 | 5411.7 samples/s | 84.6 steps/s
[Step=44950 Epoch=429.2] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.430 | L2-Norm(final)=17.053 | 2388.7 samples/s | 37.3 steps/s
[Step=45000 Epoch=429.7] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.416 | L2-Norm(final)=17.053 | 5047.5 samples/s | 78.9 steps/s
[Step=45050 Epoch=430.2] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.402 | L2-Norm(final)=17.054 | 2481.8 samples/s | 38.8 steps/s
[Step=45100 Epoch=430.7] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.388 | L2-Norm(final)=17.054 | 4689.3 samples/s | 73.3 steps/s
[Step=45150 Epoch=431.2] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.374 | L2-Norm(final)=17.054 | 2555.2 samples/s | 39.9 steps/s
[Step=45200 Epoch=431.6] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=17.055 | 4652.2 samples/s | 72.7 steps/s
[Step=45250 Epoch=432.1] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.345 | L2-Norm(final)=17.055 | 2562.9 samples/s | 40.0 steps/s
[Step=45300 Epoch=432.6] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=17.055 | 4590.8 samples/s | 71.7 steps/s
[Step=45350 Epoch=433.1] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.317 | L2-Norm(final)=17.056 | 2568.8 samples/s | 40.1 steps/s
[Step=45400 Epoch=433.5] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.302 | L2-Norm(final)=17.056 | 4634.2 samples/s | 72.4 steps/s
[Step=45450 Epoch=434.0] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.288 | L2-Norm(final)=17.056 | 2606.0 samples/s | 40.7 steps/s
[Step=45500 Epoch=434.5] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.273 | L2-Norm(final)=17.057 | 4574.5 samples/s | 71.5 steps/s
[Step=45550 Epoch=435.0] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.259 | L2-Norm(final)=17.057 | 7399.0 samples/s | 115.6 steps/s
[Step=45600 Epoch=435.5] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.244 | L2-Norm(final)=17.058 | 2117.5 samples/s | 33.1 steps/s
[Step=45650 Epoch=435.9] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.230 | L2-Norm(final)=17.058 | 6762.9 samples/s | 105.7 steps/s
[Step=45700 Epoch=436.4] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.215 | L2-Norm(final)=17.058 | 2193.5 samples/s | 34.3 steps/s
[Step=45750 Epoch=436.9] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.200 | L2-Norm(final)=17.059 | 6159.1 samples/s | 96.2 steps/s
[Step=45800 Epoch=437.4] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.185 | L2-Norm(final)=17.059 | 2238.8 samples/s | 35.0 steps/s
[Step=45850 Epoch=437.8] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.170 | L2-Norm(final)=17.059 | 5820.2 samples/s | 90.9 steps/s
[Step=45900 Epoch=438.3] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.155 | L2-Norm(final)=17.060 | 2309.9 samples/s | 36.1 steps/s
[Step=45950 Epoch=438.8] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.140 | L2-Norm(final)=17.060 | 5379.1 samples/s | 84.0 steps/s
[Step=46000 Epoch=439.3] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.124 | L2-Norm(final)=17.061 | 2395.8 samples/s | 37.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step46000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=46001 Epoch=433.5] | Loss=0.00025 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.540 | L2-Norm(final)=16.701 | 6048.2 samples/s | 94.5 steps/s
[Step=46050 Epoch=433.9] | Loss=0.00021 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.537 | L2-Norm(final)=16.704 | 4445.9 samples/s | 69.5 steps/s
[Step=46100 Epoch=434.4] | Loss=0.00019 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.710 | 7895.7 samples/s | 123.4 steps/s
[Step=46150 Epoch=434.9] | Loss=0.00017 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.715 | 2363.4 samples/s | 36.9 steps/s
[Step=46200 Epoch=435.3] | Loss=0.00017 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.719 | 7016.4 samples/s | 109.6 steps/s
[Step=46250 Epoch=435.8] | Loss=0.00018 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.723 | 2486.9 samples/s | 38.9 steps/s
[Step=46300 Epoch=436.3] | Loss=0.00018 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.728 | 6109.4 samples/s | 95.5 steps/s
[Step=46350 Epoch=436.7] | Loss=0.00017 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.732 | 2635.5 samples/s | 41.2 steps/s
[Step=46400 Epoch=437.2] | Loss=0.00018 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.736 | 5414.2 samples/s | 84.6 steps/s
[Step=46450 Epoch=437.7] | Loss=0.00017 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.740 | 2745.7 samples/s | 42.9 steps/s
[Step=46500 Epoch=438.2] | Loss=0.00017 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.744 | 5285.2 samples/s | 82.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=438.2] | Loss=0.00022 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=16.781 | 5677.6 samples/s | 88.7 steps/s
[Step=46550 Epoch=438.6] | Loss=0.00010 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.541 | L2-Norm(final)=16.785 | 4185.8 samples/s | 65.4 steps/s
[Step=46600 Epoch=439.1] | Loss=0.00007 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.541 | L2-Norm(final)=16.786 | 6604.8 samples/s | 103.2 steps/s
[Step=46650 Epoch=439.6] | Loss=0.00004 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.537 | L2-Norm(final)=16.787 | 2203.2 samples/s | 34.4 steps/s
[Step=46700 Epoch=440.0] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.531 | L2-Norm(final)=16.788 | 5918.4 samples/s | 92.5 steps/s
[Step=46750 Epoch=440.5] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.525 | L2-Norm(final)=16.788 | 2311.7 samples/s | 36.1 steps/s
[Step=46800 Epoch=441.0] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.518 | L2-Norm(final)=16.789 | 5303.6 samples/s | 82.9 steps/s
[Step=46850 Epoch=441.5] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.511 | L2-Norm(final)=16.789 | 2405.3 samples/s | 37.6 steps/s
[Step=46900 Epoch=441.9] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.504 | L2-Norm(final)=16.789 | 4902.1 samples/s | 76.6 steps/s
[Step=46950 Epoch=442.4] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.496 | L2-Norm(final)=16.789 | 2522.2 samples/s | 39.4 steps/s
[Step=47000 Epoch=442.9] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.489 | L2-Norm(final)=16.790 | 4588.3 samples/s | 71.7 steps/s
[Step=47050 Epoch=443.3] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.481 | L2-Norm(final)=16.790 | 2587.4 samples/s | 40.4 steps/s
[Step=47100 Epoch=443.8] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.473 | L2-Norm(final)=16.790 | 4594.8 samples/s | 71.8 steps/s
[Step=47150 Epoch=444.3] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.466 | L2-Norm(final)=16.790 | 2617.7 samples/s | 40.9 steps/s
[Step=47200 Epoch=444.8] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.458 | L2-Norm(final)=16.791 | 4535.6 samples/s | 70.9 steps/s
[Step=47250 Epoch=445.2] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.450 | L2-Norm(final)=16.791 | 2805.3 samples/s | 43.8 steps/s
[Step=47300 Epoch=445.7] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.442 | L2-Norm(final)=16.791 | 4020.3 samples/s | 62.8 steps/s
[Step=47350 Epoch=446.2] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.433 | L2-Norm(final)=16.791 | 6772.4 samples/s | 105.8 steps/s
[Step=47400 Epoch=446.6] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.425 | L2-Norm(final)=16.791 | 2218.7 samples/s | 34.7 steps/s
[Step=47450 Epoch=447.1] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.417 | L2-Norm(final)=16.791 | 5869.5 samples/s | 91.7 steps/s
[Step=47500 Epoch=447.6] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.409 | L2-Norm(final)=16.792 | 1730.0 samples/s | 27.0 steps/s
[Step=47550 Epoch=448.1] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.400 | L2-Norm(final)=16.792 | 5422.9 samples/s | 84.7 steps/s
[Step=47600 Epoch=448.5] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=16.792 | 2348.6 samples/s | 36.7 steps/s
[Step=47650 Epoch=449.0] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.383 | L2-Norm(final)=16.792 | 4887.4 samples/s | 76.4 steps/s
[Step=47700 Epoch=449.5] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.374 | L2-Norm(final)=16.792 | 2464.7 samples/s | 38.5 steps/s
[Step=47750 Epoch=449.9] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.365 | L2-Norm(final)=16.793 | 4645.7 samples/s | 72.6 steps/s
[Step=47800 Epoch=450.4] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.356 | L2-Norm(final)=16.793 | 2591.3 samples/s | 40.5 steps/s
[Step=47850 Epoch=450.9] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.348 | L2-Norm(final)=16.793 | 4672.4 samples/s | 73.0 steps/s
[Step=47900 Epoch=451.4] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.338 | L2-Norm(final)=16.793 | 2536.8 samples/s | 39.6 steps/s
[Step=47950 Epoch=451.8] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.329 | L2-Norm(final)=16.794 | 4612.5 samples/s | 72.1 steps/s
[Step=48000 Epoch=452.3] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.320 | L2-Norm(final)=16.794 | 2677.5 samples/s | 41.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step48000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07594 | acc=0.9642 | tpr=0.9715 | fpr=0.0515 | 5571.2 samples/s | 21.8 steps/s
Avg test loss: 0.08377, Avg test acc: 0.96218, Avg tpr: 0.97074, Avg fpr: 0.05666, total FA: 442

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08024 | acc=0.9662 | tpr=0.9777 | fpr=0.0590 | 5661.1 samples/s | 22.1 steps/s
Avg test loss: 0.08869, Avg test acc: 0.96446, Avg tpr: 0.97610, Avg fpr: 0.06115, total FA: 477

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.07917 | acc=0.9652 | tpr=0.9770 | fpr=0.0605 | 5709.6 samples/s | 22.3 steps/s
Avg test loss: 0.08692, Avg test acc: 0.96310, Avg tpr: 0.97400, Avg fpr: 0.06089, total FA: 475

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.07680 | acc=0.9644 | tpr=0.9733 | fpr=0.0550 | 5782.5 samples/s | 22.6 steps/s
Avg test loss: 0.08509, Avg test acc: 0.96402, Avg tpr: 0.97290, Avg fpr: 0.05551, total FA: 433

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.07501 | acc=0.9660 | tpr=0.9743 | fpr=0.0520 | 5793.3 samples/s | 22.6 steps/s
Avg test loss: 0.08638, Avg test acc: 0.96434, Avg tpr: 0.97290, Avg fpr: 0.05448, total FA: 425

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.39701 | acc=0.2666 | tpr=0.0092 | fpr=0.1744 | 5743.4 samples/s | 22.4 steps/s
Avg test loss: 5.40298, Avg test acc: 0.26533, Avg tpr: 0.00956, Avg fpr: 0.17216, total FA: 1343

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.68202 | acc=0.2967 | tpr=0.0172 | fpr=0.0964 | 5701.5 samples/s | 22.3 steps/s
Avg test loss: 4.69034, Avg test acc: 0.29449, Avg tpr: 0.01813, Avg fpr: 0.09768, total FA: 762

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.13657 | acc=0.2509 | tpr=0.0131 | fpr=0.2327 | 5448.1 samples/s | 21.3 steps/s
Avg test loss: 5.14466, Avg test acc: 0.25114, Avg tpr: 0.01381, Avg fpr: 0.22689, total FA: 1770

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=6.14506 | acc=0.2409 | tpr=0.0082 | fpr=0.2537 | 5625.5 samples/s | 22.0 steps/s
Avg test loss: 6.15244, Avg test acc: 0.23944, Avg tpr: 0.00799, Avg fpr: 0.25151, total FA: 1962

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.54321 | acc=0.2373 | tpr=0.0067 | fpr=0.2621 | 5665.2 samples/s | 22.1 steps/s
Avg test loss: 5.54691, Avg test acc: 0.23724, Avg tpr: 0.00758, Avg fpr: 0.25766, total FA: 2010

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.96433 | acc=0.1566 | tpr=0.2035 | fpr=0.8442 | 5759.7 samples/s | 22.5 steps/s
[Step= 100] | Loss=4.92097 | acc=0.1578 | tpr=0.1834 | fpr=0.8427 | 8046.4 samples/s | 31.4 steps/s
[Step= 150] | Loss=4.93939 | acc=0.1573 | tpr=0.1816 | fpr=0.8432 | 8000.8 samples/s | 31.3 steps/s
[Step= 200] | Loss=4.93339 | acc=0.1573 | tpr=0.1792 | fpr=0.8431 | 8251.1 samples/s | 32.2 steps/s
[Step= 250] | Loss=4.94030 | acc=0.1576 | tpr=0.1799 | fpr=0.8428 | 7593.3 samples/s | 29.7 steps/s
[Step= 300] | Loss=4.94460 | acc=0.1571 | tpr=0.1833 | fpr=0.8434 | 7927.6 samples/s | 31.0 steps/s
[Step= 350] | Loss=4.94686 | acc=0.1570 | tpr=0.1753 | fpr=0.8433 | 8827.3 samples/s | 34.5 steps/s
[Step= 400] | Loss=4.94572 | acc=0.1574 | tpr=0.1789 | fpr=0.8429 | 7970.7 samples/s | 31.1 steps/s
[Step= 450] | Loss=4.94490 | acc=0.1578 | tpr=0.1767 | fpr=0.8426 | 8057.8 samples/s | 31.5 steps/s
[Step= 500] | Loss=4.94814 | acc=0.1576 | tpr=0.1806 | fpr=0.8428 | 7657.1 samples/s | 29.9 steps/s
[Step= 550] | Loss=4.94627 | acc=0.1576 | tpr=0.1779 | fpr=0.8427 | 10425.6 samples/s | 40.7 steps/s
Avg test loss: 4.94588, Avg test acc: 0.15753, Avg tpr: 0.17789, Avg fpr: 0.84284, total FA: 117026

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.14920 | acc=0.1421 | tpr=0.2124 | fpr=0.8592 | 5810.9 samples/s | 22.7 steps/s
[Step= 100] | Loss=5.10375 | acc=0.1454 | tpr=0.1983 | fpr=0.8556 | 7854.7 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.11942 | acc=0.1432 | tpr=0.1960 | fpr=0.8577 | 7654.0 samples/s | 29.9 steps/s
[Step= 200] | Loss=5.11620 | acc=0.1432 | tpr=0.1825 | fpr=0.8575 | 7841.7 samples/s | 30.6 steps/s
[Step= 250] | Loss=5.12284 | acc=0.1431 | tpr=0.1799 | fpr=0.8576 | 8201.4 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.12505 | acc=0.1423 | tpr=0.1811 | fpr=0.8584 | 7405.8 samples/s | 28.9 steps/s
[Step= 350] | Loss=5.12697 | acc=0.1419 | tpr=0.1697 | fpr=0.8586 | 8426.9 samples/s | 32.9 steps/s
[Step= 400] | Loss=5.12636 | acc=0.1424 | tpr=0.1772 | fpr=0.8582 | 8553.3 samples/s | 33.4 steps/s
[Step= 450] | Loss=5.12492 | acc=0.1428 | tpr=0.1767 | fpr=0.8579 | 7890.2 samples/s | 30.8 steps/s
[Step= 500] | Loss=5.12849 | acc=0.1426 | tpr=0.1802 | fpr=0.8581 | 8261.1 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.12659 | acc=0.1429 | tpr=0.1795 | fpr=0.8578 | 10805.4 samples/s | 42.2 steps/s
Avg test loss: 5.12675, Avg test acc: 0.14274, Avg tpr: 0.17948, Avg fpr: 0.85792, total FA: 119121

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.56280 | acc=0.1376 | tpr=0.1460 | fpr=0.8626 | 5574.5 samples/s | 21.8 steps/s
[Step= 100] | Loss=5.51853 | acc=0.1396 | tpr=0.1386 | fpr=0.8603 | 8470.9 samples/s | 33.1 steps/s
[Step= 150] | Loss=5.52958 | acc=0.1388 | tpr=0.1383 | fpr=0.8612 | 8228.6 samples/s | 32.1 steps/s
[Step= 200] | Loss=5.52242 | acc=0.1392 | tpr=0.1333 | fpr=0.8607 | 8118.4 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.52727 | acc=0.1392 | tpr=0.1301 | fpr=0.8606 | 7920.5 samples/s | 30.9 steps/s
[Step= 300] | Loss=5.53297 | acc=0.1388 | tpr=0.1295 | fpr=0.8610 | 7595.2 samples/s | 29.7 steps/s
[Step= 350] | Loss=5.53700 | acc=0.1384 | tpr=0.1240 | fpr=0.8614 | 8124.8 samples/s | 31.7 steps/s
[Step= 400] | Loss=5.53561 | acc=0.1389 | tpr=0.1307 | fpr=0.8609 | 7956.4 samples/s | 31.1 steps/s
[Step= 450] | Loss=5.53409 | acc=0.1391 | tpr=0.1300 | fpr=0.8607 | 8007.0 samples/s | 31.3 steps/s
[Step= 500] | Loss=5.53646 | acc=0.1390 | tpr=0.1313 | fpr=0.8609 | 8035.3 samples/s | 31.4 steps/s
[Step= 550] | Loss=5.53329 | acc=0.1394 | tpr=0.1309 | fpr=0.8604 | 10616.0 samples/s | 41.5 steps/s
Avg test loss: 5.53304, Avg test acc: 0.13932, Avg tpr: 0.13114, Avg fpr: 0.86053, total FA: 119483

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.99673 | acc=0.1559 | tpr=0.1814 | fpr=0.8445 | 5647.6 samples/s | 22.1 steps/s
[Step= 100] | Loss=4.95168 | acc=0.1575 | tpr=0.1748 | fpr=0.8428 | 8206.8 samples/s | 32.1 steps/s
[Step= 150] | Loss=4.96742 | acc=0.1559 | tpr=0.1729 | fpr=0.8444 | 7943.0 samples/s | 31.0 steps/s
[Step= 200] | Loss=4.96016 | acc=0.1560 | tpr=0.1639 | fpr=0.8441 | 8463.6 samples/s | 33.1 steps/s
[Step= 250] | Loss=4.96552 | acc=0.1563 | tpr=0.1659 | fpr=0.8439 | 8043.7 samples/s | 31.4 steps/s
[Step= 300] | Loss=4.97071 | acc=0.1554 | tpr=0.1687 | fpr=0.8449 | 8130.6 samples/s | 31.8 steps/s
[Step= 350] | Loss=4.97217 | acc=0.1549 | tpr=0.1622 | fpr=0.8453 | 8056.0 samples/s | 31.5 steps/s
[Step= 400] | Loss=4.97158 | acc=0.1552 | tpr=0.1679 | fpr=0.8450 | 7944.2 samples/s | 31.0 steps/s
[Step= 450] | Loss=4.97090 | acc=0.1555 | tpr=0.1680 | fpr=0.8447 | 7962.4 samples/s | 31.1 steps/s
[Step= 500] | Loss=4.97379 | acc=0.1555 | tpr=0.1705 | fpr=0.8448 | 8393.7 samples/s | 32.8 steps/s
[Step= 550] | Loss=4.97124 | acc=0.1557 | tpr=0.1727 | fpr=0.8446 | 9451.2 samples/s | 36.9 steps/s
Avg test loss: 4.97095, Avg test acc: 0.15560, Avg tpr: 0.17274, Avg fpr: 0.84471, total FA: 117286

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.33050 | acc=0.1490 | tpr=0.1416 | fpr=0.8509 | 5720.1 samples/s | 22.3 steps/s
[Step= 100] | Loss=5.28129 | acc=0.1512 | tpr=0.1343 | fpr=0.8484 | 7874.3 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.29942 | acc=0.1501 | tpr=0.1254 | fpr=0.8494 | 7468.9 samples/s | 29.2 steps/s
[Step= 200] | Loss=5.29644 | acc=0.1500 | tpr=0.1224 | fpr=0.8495 | 8114.4 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.30344 | acc=0.1499 | tpr=0.1231 | fpr=0.8496 | 7690.7 samples/s | 30.0 steps/s
[Step= 300] | Loss=5.30622 | acc=0.1495 | tpr=0.1244 | fpr=0.8500 | 8288.3 samples/s | 32.4 steps/s
[Step= 350] | Loss=5.30966 | acc=0.1491 | tpr=0.1209 | fpr=0.8504 | 8339.4 samples/s | 32.6 steps/s
[Step= 400] | Loss=5.30859 | acc=0.1492 | tpr=0.1220 | fpr=0.8503 | 7686.8 samples/s | 30.0 steps/s
[Step= 450] | Loss=5.30759 | acc=0.1495 | tpr=0.1232 | fpr=0.8500 | 8300.5 samples/s | 32.4 steps/s
[Step= 500] | Loss=5.31113 | acc=0.1492 | tpr=0.1247 | fpr=0.8503 | 8251.1 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.30775 | acc=0.1493 | tpr=0.1242 | fpr=0.8502 | 11650.1 samples/s | 45.5 steps/s
Avg test loss: 5.30749, Avg test acc: 0.14920, Avg tpr: 0.12401, Avg fpr: 0.85035, total FA: 118069

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11219 | acc=0.9801 | tpr=0.9292 | fpr=0.0190 | 5725.7 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.11333 | acc=0.9804 | tpr=0.9488 | fpr=0.0190 | 7689.0 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.11721 | acc=0.9796 | tpr=0.9524 | fpr=0.0199 | 8194.8 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.11923 | acc=0.9796 | tpr=0.9563 | fpr=0.0199 | 8240.1 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.11999 | acc=0.9795 | tpr=0.9528 | fpr=0.0200 | 8187.7 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.12149 | acc=0.9795 | tpr=0.9535 | fpr=0.0200 | 7690.5 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.12158 | acc=0.9795 | tpr=0.9555 | fpr=0.0201 | 8504.3 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.12264 | acc=0.9792 | tpr=0.9513 | fpr=0.0203 | 8344.8 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.12500 | acc=0.9789 | tpr=0.9489 | fpr=0.0206 | 8172.0 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.12400 | acc=0.9790 | tpr=0.9511 | fpr=0.0205 | 8138.6 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.12307 | acc=0.9790 | tpr=0.9511 | fpr=0.0204 | 9611.7 samples/s | 37.5 steps/s
Avg test loss: 0.12282, Avg test acc: 0.97908, Avg tpr: 0.95087, Avg fpr: 0.02041, total FA: 2834

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10676 | acc=0.9807 | tpr=0.9204 | fpr=0.0182 | 5645.4 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.10820 | acc=0.9803 | tpr=0.9382 | fpr=0.0189 | 7944.9 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.11173 | acc=0.9795 | tpr=0.9409 | fpr=0.0198 | 7578.6 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.11307 | acc=0.9794 | tpr=0.9388 | fpr=0.0198 | 8771.0 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.11381 | acc=0.9795 | tpr=0.9354 | fpr=0.0197 | 7854.3 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.11558 | acc=0.9791 | tpr=0.9345 | fpr=0.0200 | 8005.4 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.11552 | acc=0.9791 | tpr=0.9361 | fpr=0.0201 | 8161.7 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.11650 | acc=0.9789 | tpr=0.9316 | fpr=0.0202 | 8001.1 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.11842 | acc=0.9787 | tpr=0.9299 | fpr=0.0204 | 7572.6 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.11750 | acc=0.9788 | tpr=0.9326 | fpr=0.0203 | 8315.2 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.11639 | acc=0.9790 | tpr=0.9316 | fpr=0.0202 | 11140.7 samples/s | 43.5 steps/s
Avg test loss: 0.11617, Avg test acc: 0.97901, Avg tpr: 0.93106, Avg fpr: 0.02012, total FA: 2794

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11154 | acc=0.9783 | tpr=0.9381 | fpr=0.0210 | 5611.5 samples/s | 21.9 steps/s
[Step= 100] | Loss=0.11373 | acc=0.9784 | tpr=0.9595 | fpr=0.0212 | 8255.9 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.11801 | acc=0.9776 | tpr=0.9597 | fpr=0.0221 | 8017.8 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.11959 | acc=0.9775 | tpr=0.9607 | fpr=0.0222 | 8143.8 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.12064 | acc=0.9775 | tpr=0.9598 | fpr=0.0222 | 8088.7 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.12193 | acc=0.9775 | tpr=0.9593 | fpr=0.0222 | 7590.8 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.12180 | acc=0.9775 | tpr=0.9612 | fpr=0.0222 | 8414.4 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.12259 | acc=0.9773 | tpr=0.9579 | fpr=0.0223 | 8207.2 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.12465 | acc=0.9770 | tpr=0.9557 | fpr=0.0226 | 8256.6 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.12383 | acc=0.9771 | tpr=0.9573 | fpr=0.0225 | 8164.9 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.12278 | acc=0.9773 | tpr=0.9570 | fpr=0.0223 | 9898.0 samples/s | 38.7 steps/s
Avg test loss: 0.12252, Avg test acc: 0.97729, Avg tpr: 0.95681, Avg fpr: 0.02233, total FA: 3101

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10420 | acc=0.9816 | tpr=0.9336 | fpr=0.0175 | 5739.9 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.10602 | acc=0.9810 | tpr=0.9424 | fpr=0.0183 | 7624.6 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.10885 | acc=0.9806 | tpr=0.9467 | fpr=0.0188 | 8245.5 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.11058 | acc=0.9806 | tpr=0.9497 | fpr=0.0188 | 8323.1 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.11144 | acc=0.9805 | tpr=0.9459 | fpr=0.0188 | 7837.8 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.11243 | acc=0.9804 | tpr=0.9447 | fpr=0.0189 | 8228.8 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.11225 | acc=0.9805 | tpr=0.9474 | fpr=0.0189 | 8221.3 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.11307 | acc=0.9804 | tpr=0.9447 | fpr=0.0189 | 8178.1 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.11512 | acc=0.9801 | tpr=0.9430 | fpr=0.0192 | 8184.4 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.11411 | acc=0.9803 | tpr=0.9449 | fpr=0.0191 | 7520.4 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.11337 | acc=0.9803 | tpr=0.9431 | fpr=0.0190 | 10666.2 samples/s | 41.7 steps/s
Avg test loss: 0.11314, Avg test acc: 0.98033, Avg tpr: 0.94295, Avg fpr: 0.01899, total FA: 2637

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.11064 | acc=0.9807 | tpr=0.9248 | fpr=0.0183 | 5669.8 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.11310 | acc=0.9802 | tpr=0.9360 | fpr=0.0189 | 8190.0 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.11691 | acc=0.9797 | tpr=0.9424 | fpr=0.0196 | 7615.7 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.11845 | acc=0.9797 | tpr=0.9464 | fpr=0.0196 | 8048.3 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.11960 | acc=0.9797 | tpr=0.9432 | fpr=0.0196 | 8425.2 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.12083 | acc=0.9798 | tpr=0.9425 | fpr=0.0195 | 8597.4 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.12063 | acc=0.9799 | tpr=0.9449 | fpr=0.0195 | 8123.7 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.12150 | acc=0.9797 | tpr=0.9420 | fpr=0.0196 | 7630.6 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.12375 | acc=0.9794 | tpr=0.9416 | fpr=0.0199 | 8155.4 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.12277 | acc=0.9795 | tpr=0.9441 | fpr=0.0198 | 7864.5 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.12185 | acc=0.9796 | tpr=0.9419 | fpr=0.0197 | 10157.3 samples/s | 39.7 steps/s
Avg test loss: 0.12162, Avg test acc: 0.97961, Avg tpr: 0.94176, Avg fpr: 0.01971, total FA: 2736

server round 47/50

clients selected: [1 3 6 7 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=58001 Epoch=283.0] | Loss=0.01298 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.396 | L2-Norm(final)=16.129 | 5918.1 samples/s | 92.5 steps/s
[Step=58050 Epoch=283.3] | Loss=0.01395 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.396 | L2-Norm(final)=16.130 | 5093.5 samples/s | 79.6 steps/s
[Step=58100 Epoch=283.5] | Loss=0.01521 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.396 | L2-Norm(final)=16.131 | 5607.0 samples/s | 87.6 steps/s
[Step=58150 Epoch=283.7] | Loss=0.01412 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.396 | L2-Norm(final)=16.132 | 5666.0 samples/s | 88.5 steps/s
[Step=58200 Epoch=284.0] | Loss=0.01423 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.396 | L2-Norm(final)=16.133 | 8639.6 samples/s | 135.0 steps/s
[Step=58250 Epoch=284.2] | Loss=0.01422 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.396 | L2-Norm(final)=16.134 | 2434.1 samples/s | 38.0 steps/s
[Step=58300 Epoch=284.5] | Loss=0.01395 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.396 | L2-Norm(final)=16.135 | 5745.0 samples/s | 89.8 steps/s
[Step=58350 Epoch=284.7] | Loss=0.01380 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.396 | L2-Norm(final)=16.136 | 5501.8 samples/s | 86.0 steps/s
[Step=58400 Epoch=285.0] | Loss=0.01407 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.396 | L2-Norm(final)=16.137 | 7999.4 samples/s | 125.0 steps/s
[Step=58450 Epoch=285.2] | Loss=0.01410 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.396 | L2-Norm(final)=16.138 | 2499.3 samples/s | 39.1 steps/s
[Step=58500 Epoch=285.5] | Loss=0.01417 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.396 | L2-Norm(final)=16.140 | 5916.9 samples/s | 92.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=58501 Epoch=285.5] | Loss=0.02342 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.396 | L2-Norm(final)=16.151 | 5805.0 samples/s | 90.7 steps/s
[Step=58550 Epoch=285.7] | Loss=0.01759 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.402 | L2-Norm(final)=16.150 | 4386.1 samples/s | 68.5 steps/s
[Step=58600 Epoch=285.9] | Loss=0.01313 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.409 | L2-Norm(final)=16.151 | 4835.3 samples/s | 75.6 steps/s
[Step=58650 Epoch=286.2] | Loss=0.01282 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.414 | L2-Norm(final)=16.153 | 4827.4 samples/s | 75.4 steps/s
[Step=58700 Epoch=286.4] | Loss=0.01207 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.419 | L2-Norm(final)=16.154 | 7034.0 samples/s | 109.9 steps/s
[Step=58750 Epoch=286.7] | Loss=0.01058 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.423 | L2-Norm(final)=16.156 | 2269.4 samples/s | 35.5 steps/s
[Step=58800 Epoch=286.9] | Loss=0.00967 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.427 | L2-Norm(final)=16.158 | 4859.6 samples/s | 75.9 steps/s
[Step=58850 Epoch=287.2] | Loss=0.00899 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.431 | L2-Norm(final)=16.160 | 4850.3 samples/s | 75.8 steps/s
[Step=58900 Epoch=287.4] | Loss=0.00843 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.434 | L2-Norm(final)=16.162 | 6455.9 samples/s | 100.9 steps/s
[Step=58950 Epoch=287.6] | Loss=0.00802 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.437 | L2-Norm(final)=16.164 | 2330.8 samples/s | 36.4 steps/s
[Step=59000 Epoch=287.9] | Loss=0.00755 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.440 | L2-Norm(final)=16.166 | 4767.7 samples/s | 74.5 steps/s
[Step=59050 Epoch=288.1] | Loss=0.00725 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.443 | L2-Norm(final)=16.168 | 4942.2 samples/s | 77.2 steps/s
[Step=59100 Epoch=288.4] | Loss=0.00691 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.446 | L2-Norm(final)=16.170 | 5918.2 samples/s | 92.5 steps/s
[Step=59150 Epoch=288.6] | Loss=0.00659 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.448 | L2-Norm(final)=16.172 | 2374.1 samples/s | 37.1 steps/s
[Step=59200 Epoch=288.9] | Loss=0.00636 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.451 | L2-Norm(final)=16.174 | 4870.1 samples/s | 76.1 steps/s
[Step=59250 Epoch=289.1] | Loss=0.00615 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.453 | L2-Norm(final)=16.176 | 4853.0 samples/s | 75.8 steps/s
[Step=59300 Epoch=289.4] | Loss=0.00600 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.455 | L2-Norm(final)=16.177 | 5575.7 samples/s | 87.1 steps/s
[Step=59350 Epoch=289.6] | Loss=0.00584 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.458 | L2-Norm(final)=16.179 | 2469.3 samples/s | 38.6 steps/s
[Step=59400 Epoch=289.8] | Loss=0.00571 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.460 | L2-Norm(final)=16.181 | 4806.5 samples/s | 75.1 steps/s
[Step=59450 Epoch=290.1] | Loss=0.00552 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.462 | L2-Norm(final)=16.183 | 4798.8 samples/s | 75.0 steps/s
[Step=59500 Epoch=290.3] | Loss=0.00540 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.464 | L2-Norm(final)=16.184 | 5283.2 samples/s | 82.6 steps/s
[Step=59550 Epoch=290.6] | Loss=0.00531 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.466 | L2-Norm(final)=16.186 | 2544.6 samples/s | 39.8 steps/s
[Step=59600 Epoch=290.8] | Loss=0.00520 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.468 | L2-Norm(final)=16.188 | 4875.1 samples/s | 76.2 steps/s
[Step=59650 Epoch=291.1] | Loss=0.00506 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.470 | L2-Norm(final)=16.189 | 4814.2 samples/s | 75.2 steps/s
[Step=59700 Epoch=291.3] | Loss=0.00498 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.472 | L2-Norm(final)=16.191 | 4964.1 samples/s | 77.6 steps/s
[Step=59750 Epoch=291.6] | Loss=0.00489 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.473 | L2-Norm(final)=16.192 | 2591.2 samples/s | 40.5 steps/s
[Step=59800 Epoch=291.8] | Loss=0.00480 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.475 | L2-Norm(final)=16.194 | 4880.2 samples/s | 76.3 steps/s
[Step=59850 Epoch=292.0] | Loss=0.00472 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.477 | L2-Norm(final)=16.195 | 4888.1 samples/s | 76.4 steps/s
[Step=59900 Epoch=292.3] | Loss=0.00464 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.479 | L2-Norm(final)=16.197 | 4843.1 samples/s | 75.7 steps/s
[Step=59950 Epoch=292.5] | Loss=0.00455 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.480 | L2-Norm(final)=16.198 | 2601.9 samples/s | 40.7 steps/s
[Step=60000 Epoch=292.8] | Loss=0.00444 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.482 | L2-Norm(final)=16.200 | 4851.3 samples/s | 75.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step60000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=56001 Epoch=273.1] | Loss=0.07229 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.396 | L2-Norm(final)=15.863 | 5831.5 samples/s | 91.1 steps/s
[Step=56050 Epoch=273.3] | Loss=0.01578 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.396 | L2-Norm(final)=15.864 | 5234.1 samples/s | 81.8 steps/s
[Step=56100 Epoch=273.6] | Loss=0.01481 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.396 | L2-Norm(final)=15.866 | 5685.9 samples/s | 88.8 steps/s
[Step=56150 Epoch=273.8] | Loss=0.01364 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.396 | L2-Norm(final)=15.868 | 5672.0 samples/s | 88.6 steps/s
[Step=56200 Epoch=274.1] | Loss=0.01382 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.396 | L2-Norm(final)=15.871 | 8603.3 samples/s | 134.4 steps/s
[Step=56250 Epoch=274.3] | Loss=0.01402 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.396 | L2-Norm(final)=15.872 | 2418.6 samples/s | 37.8 steps/s
[Step=56300 Epoch=274.6] | Loss=0.01404 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.396 | L2-Norm(final)=15.874 | 5796.3 samples/s | 90.6 steps/s
[Step=56350 Epoch=274.8] | Loss=0.01411 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.396 | L2-Norm(final)=15.876 | 5561.1 samples/s | 86.9 steps/s
[Step=56400 Epoch=275.0] | Loss=0.01401 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.396 | L2-Norm(final)=15.878 | 7569.8 samples/s | 118.3 steps/s
[Step=56450 Epoch=275.3] | Loss=0.01361 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.396 | L2-Norm(final)=15.879 | 2563.7 samples/s | 40.1 steps/s
[Step=56500 Epoch=275.5] | Loss=0.01347 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.396 | L2-Norm(final)=15.881 | 5538.1 samples/s | 86.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=56501 Epoch=275.5] | Loss=0.00263 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.396 | L2-Norm(final)=15.899 | 5823.6 samples/s | 91.0 steps/s
[Step=56550 Epoch=275.8] | Loss=0.01452 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.402 | L2-Norm(final)=15.900 | 4404.2 samples/s | 68.8 steps/s
[Step=56600 Epoch=276.0] | Loss=0.01376 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.408 | L2-Norm(final)=15.901 | 4843.1 samples/s | 75.7 steps/s
[Step=56650 Epoch=276.3] | Loss=0.01240 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.414 | L2-Norm(final)=15.902 | 4879.8 samples/s | 76.2 steps/s
[Step=56700 Epoch=276.5] | Loss=0.01188 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.418 | L2-Norm(final)=15.903 | 6932.7 samples/s | 108.3 steps/s
[Step=56750 Epoch=276.7] | Loss=0.01062 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.423 | L2-Norm(final)=15.905 | 2251.8 samples/s | 35.2 steps/s
[Step=56800 Epoch=277.0] | Loss=0.00966 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.427 | L2-Norm(final)=15.907 | 4912.9 samples/s | 76.8 steps/s
[Step=56850 Epoch=277.2] | Loss=0.00875 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.430 | L2-Norm(final)=15.909 | 4806.4 samples/s | 75.1 steps/s
[Step=56900 Epoch=277.5] | Loss=0.00834 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.434 | L2-Norm(final)=15.911 | 6359.1 samples/s | 99.4 steps/s
[Step=56950 Epoch=277.7] | Loss=0.00772 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.437 | L2-Norm(final)=15.913 | 2373.2 samples/s | 37.1 steps/s
[Step=57000 Epoch=278.0] | Loss=0.00726 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.440 | L2-Norm(final)=15.915 | 4946.9 samples/s | 77.3 steps/s
[Step=57050 Epoch=278.2] | Loss=0.00697 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.443 | L2-Norm(final)=15.916 | 4777.9 samples/s | 74.7 steps/s
[Step=57100 Epoch=278.5] | Loss=0.00667 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.445 | L2-Norm(final)=15.918 | 5813.4 samples/s | 90.8 steps/s
[Step=57150 Epoch=278.7] | Loss=0.00647 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.448 | L2-Norm(final)=15.920 | 2425.3 samples/s | 37.9 steps/s
[Step=57200 Epoch=278.9] | Loss=0.00619 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.450 | L2-Norm(final)=15.922 | 4833.0 samples/s | 75.5 steps/s
[Step=57250 Epoch=279.2] | Loss=0.00600 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.452 | L2-Norm(final)=15.924 | 4872.3 samples/s | 76.1 steps/s
[Step=57300 Epoch=279.4] | Loss=0.00588 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.455 | L2-Norm(final)=15.926 | 5390.8 samples/s | 84.2 steps/s
[Step=57350 Epoch=279.7] | Loss=0.00573 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.457 | L2-Norm(final)=15.928 | 2545.0 samples/s | 39.8 steps/s
[Step=57400 Epoch=279.9] | Loss=0.00558 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.459 | L2-Norm(final)=15.929 | 4816.6 samples/s | 75.3 steps/s
[Step=57450 Epoch=280.2] | Loss=0.00540 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.461 | L2-Norm(final)=15.931 | 4830.3 samples/s | 75.5 steps/s
[Step=57500 Epoch=280.4] | Loss=0.00527 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.463 | L2-Norm(final)=15.933 | 5027.7 samples/s | 78.6 steps/s
[Step=57550 Epoch=280.6] | Loss=0.00514 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.465 | L2-Norm(final)=15.934 | 2621.1 samples/s | 41.0 steps/s
[Step=57600 Epoch=280.9] | Loss=0.00502 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.467 | L2-Norm(final)=15.936 | 4877.5 samples/s | 76.2 steps/s
[Step=57650 Epoch=281.1] | Loss=0.00491 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.469 | L2-Norm(final)=15.938 | 4793.3 samples/s | 74.9 steps/s
[Step=57700 Epoch=281.4] | Loss=0.00482 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.471 | L2-Norm(final)=15.939 | 4861.1 samples/s | 76.0 steps/s
[Step=57750 Epoch=281.6] | Loss=0.00476 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.473 | L2-Norm(final)=15.941 | 2621.4 samples/s | 41.0 steps/s
[Step=57800 Epoch=281.9] | Loss=0.00465 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.475 | L2-Norm(final)=15.943 | 4868.3 samples/s | 76.1 steps/s
[Step=57850 Epoch=282.1] | Loss=0.00454 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.477 | L2-Norm(final)=15.944 | 4848.2 samples/s | 75.8 steps/s
[Step=57900 Epoch=282.4] | Loss=0.00448 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.479 | L2-Norm(final)=15.946 | 4881.4 samples/s | 76.3 steps/s
[Step=57950 Epoch=282.6] | Loss=0.00441 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.480 | L2-Norm(final)=15.948 | 2660.5 samples/s | 41.6 steps/s
[Step=58000 Epoch=282.8] | Loss=0.00433 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.482 | L2-Norm(final)=15.949 | 4946.4 samples/s | 77.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step58000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=40001 Epoch=380.5] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.396 | L2-Norm(final)=16.315 | 5343.7 samples/s | 83.5 steps/s
[Step=40050 Epoch=381.0] | Loss=0.00035 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.393 | L2-Norm(final)=16.322 | 5159.8 samples/s | 80.6 steps/s
[Step=40100 Epoch=381.5] | Loss=0.00038 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=16.334 | 8331.9 samples/s | 130.2 steps/s
[Step=40150 Epoch=381.9] | Loss=0.00036 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=16.345 | 2351.9 samples/s | 36.7 steps/s
[Step=40200 Epoch=382.4] | Loss=0.00037 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=16.355 | 7179.2 samples/s | 112.2 steps/s
[Step=40250 Epoch=382.9] | Loss=0.00037 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=16.366 | 2423.3 samples/s | 37.9 steps/s
[Step=40300 Epoch=383.4] | Loss=0.00036 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=16.376 | 6624.9 samples/s | 103.5 steps/s
[Step=40350 Epoch=383.8] | Loss=0.00035 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=16.385 | 2518.5 samples/s | 39.4 steps/s
[Step=40400 Epoch=384.3] | Loss=0.00036 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=16.395 | 6075.9 samples/s | 94.9 steps/s
[Step=40450 Epoch=384.8] | Loss=0.00036 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=16.403 | 2652.9 samples/s | 41.5 steps/s
[Step=40500 Epoch=385.3] | Loss=0.00036 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=16.412 | 5562.5 samples/s | 86.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=385.3] | Loss=0.00014 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=16.499 | 5958.1 samples/s | 93.1 steps/s
[Step=40550 Epoch=385.7] | Loss=0.00017 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.402 | L2-Norm(final)=16.503 | 4020.5 samples/s | 62.8 steps/s
[Step=40600 Epoch=386.2] | Loss=0.00012 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.404 | L2-Norm(final)=16.505 | 6729.6 samples/s | 105.1 steps/s
[Step=40650 Epoch=386.7] | Loss=0.00008 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.403 | L2-Norm(final)=16.506 | 2208.3 samples/s | 34.5 steps/s
[Step=40700 Epoch=387.2] | Loss=0.00006 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.399 | L2-Norm(final)=16.507 | 5886.1 samples/s | 92.0 steps/s
[Step=40750 Epoch=387.6] | Loss=0.00005 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.394 | L2-Norm(final)=16.508 | 2272.3 samples/s | 35.5 steps/s
[Step=40800 Epoch=388.1] | Loss=0.00004 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.389 | L2-Norm(final)=16.508 | 5554.9 samples/s | 86.8 steps/s
[Step=40850 Epoch=388.6] | Loss=0.00004 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.383 | L2-Norm(final)=16.509 | 2371.8 samples/s | 37.1 steps/s
[Step=40900 Epoch=389.1] | Loss=0.00003 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.378 | L2-Norm(final)=16.509 | 5139.1 samples/s | 80.3 steps/s
[Step=40950 Epoch=389.5] | Loss=0.00003 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.372 | L2-Norm(final)=16.509 | 2461.1 samples/s | 38.5 steps/s
[Step=41000 Epoch=390.0] | Loss=0.00003 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.366 | L2-Norm(final)=16.510 | 4755.2 samples/s | 74.3 steps/s
[Step=41050 Epoch=390.5] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=16.510 | 2521.5 samples/s | 39.4 steps/s
[Step=41100 Epoch=391.0] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.353 | L2-Norm(final)=16.510 | 4615.3 samples/s | 72.1 steps/s
[Step=41150 Epoch=391.4] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.346 | L2-Norm(final)=16.510 | 2573.9 samples/s | 40.2 steps/s
[Step=41200 Epoch=391.9] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.340 | L2-Norm(final)=16.511 | 4573.3 samples/s | 71.5 steps/s
[Step=41250 Epoch=392.4] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.333 | L2-Norm(final)=16.511 | 2584.7 samples/s | 40.4 steps/s
[Step=41300 Epoch=392.9] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.326 | L2-Norm(final)=16.511 | 4695.8 samples/s | 73.4 steps/s
[Step=41350 Epoch=393.3] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.320 | L2-Norm(final)=16.511 | 2659.7 samples/s | 41.6 steps/s
[Step=41400 Epoch=393.8] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.313 | L2-Norm(final)=16.512 | 4286.8 samples/s | 67.0 steps/s
[Step=41450 Epoch=394.3] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.306 | L2-Norm(final)=16.512 | 6958.7 samples/s | 108.7 steps/s
[Step=41500 Epoch=394.8] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.298 | L2-Norm(final)=16.512 | 2157.8 samples/s | 33.7 steps/s
[Step=41550 Epoch=395.2] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.291 | L2-Norm(final)=16.512 | 6340.3 samples/s | 99.1 steps/s
[Step=41600 Epoch=395.7] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=16.513 | 2238.5 samples/s | 35.0 steps/s
[Step=41650 Epoch=396.2] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.276 | L2-Norm(final)=16.513 | 5680.1 samples/s | 88.8 steps/s
[Step=41700 Epoch=396.7] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.269 | L2-Norm(final)=16.513 | 2348.1 samples/s | 36.7 steps/s
[Step=41750 Epoch=397.1] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.261 | L2-Norm(final)=16.513 | 5230.0 samples/s | 81.7 steps/s
[Step=41800 Epoch=397.6] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.254 | L2-Norm(final)=16.513 | 2422.6 samples/s | 37.9 steps/s
[Step=41850 Epoch=398.1] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.246 | L2-Norm(final)=16.514 | 4900.2 samples/s | 76.6 steps/s
[Step=41900 Epoch=398.6] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.238 | L2-Norm(final)=16.514 | 2490.3 samples/s | 38.9 steps/s
[Step=41950 Epoch=399.0] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.230 | L2-Norm(final)=16.514 | 4687.3 samples/s | 73.2 steps/s
[Step=42000 Epoch=399.5] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.222 | L2-Norm(final)=16.514 | 2601.9 samples/s | 40.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step42000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=46001 Epoch=439.3] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.396 | L2-Norm(final)=17.074 | 5442.4 samples/s | 85.0 steps/s
[Step=46050 Epoch=439.7] | Loss=0.00006 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.390 | L2-Norm(final)=17.080 | 4708.8 samples/s | 73.6 steps/s
[Step=46100 Epoch=440.2] | Loss=0.00010 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.389 | L2-Norm(final)=17.087 | 8517.6 samples/s | 133.1 steps/s
[Step=46150 Epoch=440.7] | Loss=0.00011 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.389 | L2-Norm(final)=17.096 | 2312.5 samples/s | 36.1 steps/s
[Step=46200 Epoch=441.2] | Loss=0.00011 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.389 | L2-Norm(final)=17.104 | 7645.9 samples/s | 119.5 steps/s
[Step=46250 Epoch=441.7] | Loss=0.00011 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.389 | L2-Norm(final)=17.111 | 2395.3 samples/s | 37.4 steps/s
[Step=46300 Epoch=442.1] | Loss=0.00011 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.389 | L2-Norm(final)=17.118 | 6928.9 samples/s | 108.3 steps/s
[Step=46350 Epoch=442.6] | Loss=0.00011 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.389 | L2-Norm(final)=17.124 | 2494.1 samples/s | 39.0 steps/s
[Step=46400 Epoch=443.1] | Loss=0.00011 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.389 | L2-Norm(final)=17.131 | 6267.1 samples/s | 97.9 steps/s
[Step=46450 Epoch=443.6] | Loss=0.00010 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.389 | L2-Norm(final)=17.136 | 2558.8 samples/s | 40.0 steps/s
[Step=46500 Epoch=444.0] | Loss=0.00010 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.389 | L2-Norm(final)=17.142 | 5924.8 samples/s | 92.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=444.1] | Loss=0.00004 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.389 | L2-Norm(final)=17.195 | 5930.0 samples/s | 92.7 steps/s
[Step=46550 Epoch=444.5] | Loss=0.00006 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.391 | L2-Norm(final)=17.198 | 4052.0 samples/s | 63.3 steps/s
[Step=46600 Epoch=445.0] | Loss=0.00004 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.387 | L2-Norm(final)=17.200 | 6766.7 samples/s | 105.7 steps/s
[Step=46650 Epoch=445.5] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.379 | L2-Norm(final)=17.201 | 2190.2 samples/s | 34.2 steps/s
[Step=46700 Epoch=446.0] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.369 | L2-Norm(final)=17.202 | 6122.3 samples/s | 95.7 steps/s
[Step=46750 Epoch=446.4] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=17.203 | 2261.7 samples/s | 35.3 steps/s
[Step=46800 Epoch=446.9] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.348 | L2-Norm(final)=17.203 | 5623.0 samples/s | 87.9 steps/s
[Step=46850 Epoch=447.4] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.337 | L2-Norm(final)=17.204 | 2281.1 samples/s | 35.6 steps/s
[Step=46900 Epoch=447.9] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.326 | L2-Norm(final)=17.204 | 5345.9 samples/s | 83.5 steps/s
[Step=46950 Epoch=448.3] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.314 | L2-Norm(final)=17.204 | 2370.1 samples/s | 37.0 steps/s
[Step=47000 Epoch=448.8] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.303 | L2-Norm(final)=17.205 | 5068.1 samples/s | 79.2 steps/s
[Step=47050 Epoch=449.3] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.291 | L2-Norm(final)=17.205 | 2501.3 samples/s | 39.1 steps/s
[Step=47100 Epoch=449.8] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.280 | L2-Norm(final)=17.205 | 4565.8 samples/s | 71.3 steps/s
[Step=47150 Epoch=450.3] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.268 | L2-Norm(final)=17.206 | 2559.7 samples/s | 40.0 steps/s
[Step=47200 Epoch=450.7] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.256 | L2-Norm(final)=17.206 | 4580.1 samples/s | 71.6 steps/s
[Step=47250 Epoch=451.2] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.245 | L2-Norm(final)=17.206 | 2567.0 samples/s | 40.1 steps/s
[Step=47300 Epoch=451.7] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.233 | L2-Norm(final)=17.206 | 4635.0 samples/s | 72.4 steps/s
[Step=47350 Epoch=452.2] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.221 | L2-Norm(final)=17.207 | 2579.6 samples/s | 40.3 steps/s
[Step=47400 Epoch=452.6] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.209 | L2-Norm(final)=17.207 | 4639.0 samples/s | 72.5 steps/s
[Step=47450 Epoch=453.1] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.196 | L2-Norm(final)=17.207 | 2574.1 samples/s | 40.2 steps/s
[Step=47500 Epoch=453.6] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.184 | L2-Norm(final)=17.207 | 4569.0 samples/s | 71.4 steps/s
[Step=47550 Epoch=454.1] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.172 | L2-Norm(final)=17.208 | 7492.4 samples/s | 117.1 steps/s
[Step=47600 Epoch=454.6] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.159 | L2-Norm(final)=17.208 | 2120.2 samples/s | 33.1 steps/s
[Step=47650 Epoch=455.0] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.147 | L2-Norm(final)=17.208 | 6821.7 samples/s | 106.6 steps/s
[Step=47700 Epoch=455.5] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.134 | L2-Norm(final)=17.209 | 2168.0 samples/s | 33.9 steps/s
[Step=47750 Epoch=456.0] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.122 | L2-Norm(final)=17.209 | 6170.0 samples/s | 96.4 steps/s
[Step=47800 Epoch=456.5] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.109 | L2-Norm(final)=17.209 | 2238.9 samples/s | 35.0 steps/s
[Step=47850 Epoch=456.9] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.096 | L2-Norm(final)=17.210 | 5798.7 samples/s | 90.6 steps/s
[Step=47900 Epoch=457.4] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.083 | L2-Norm(final)=17.210 | 2328.0 samples/s | 36.4 steps/s
[Step=47950 Epoch=457.9] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.070 | L2-Norm(final)=17.210 | 5245.8 samples/s | 82.0 steps/s
[Step=48000 Epoch=458.4] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.057 | L2-Norm(final)=17.211 | 2372.8 samples/s | 37.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step48000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=48001 Epoch=452.3] | Loss=0.00039 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.396 | L2-Norm(final)=16.801 | 5708.4 samples/s | 89.2 steps/s
[Step=48050 Epoch=452.8] | Loss=0.00028 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=16.804 | 4370.0 samples/s | 68.3 steps/s
[Step=48100 Epoch=453.2] | Loss=0.00023 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=16.809 | 8097.5 samples/s | 126.5 steps/s
[Step=48150 Epoch=453.7] | Loss=0.00022 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=16.815 | 2332.7 samples/s | 36.4 steps/s
[Step=48200 Epoch=454.2] | Loss=0.00022 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=16.819 | 7165.2 samples/s | 112.0 steps/s
[Step=48250 Epoch=454.7] | Loss=0.00021 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=16.824 | 2514.0 samples/s | 39.3 steps/s
[Step=48300 Epoch=455.1] | Loss=0.00022 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=16.829 | 6080.7 samples/s | 95.0 steps/s
[Step=48350 Epoch=455.6] | Loss=0.00022 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.391 | L2-Norm(final)=16.834 | 2578.6 samples/s | 40.3 steps/s
[Step=48400 Epoch=456.1] | Loss=0.00022 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.391 | L2-Norm(final)=16.840 | 5697.6 samples/s | 89.0 steps/s
[Step=48450 Epoch=456.5] | Loss=0.00022 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.391 | L2-Norm(final)=16.845 | 2717.3 samples/s | 42.5 steps/s
[Step=48500 Epoch=457.0] | Loss=0.00022 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.391 | L2-Norm(final)=16.849 | 5351.3 samples/s | 83.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=48501 Epoch=457.0] | Loss=0.00050 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.391 | L2-Norm(final)=16.898 | 5741.7 samples/s | 89.7 steps/s
[Step=48550 Epoch=457.5] | Loss=0.00011 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.395 | L2-Norm(final)=16.900 | 4122.3 samples/s | 64.4 steps/s
[Step=48600 Epoch=458.0] | Loss=0.00008 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.393 | L2-Norm(final)=16.902 | 6653.2 samples/s | 104.0 steps/s
[Step=48650 Epoch=458.4] | Loss=0.00006 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.389 | L2-Norm(final)=16.903 | 2193.2 samples/s | 34.3 steps/s
[Step=48700 Epoch=458.9] | Loss=0.00004 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.384 | L2-Norm(final)=16.904 | 5947.5 samples/s | 92.9 steps/s
[Step=48750 Epoch=459.4] | Loss=0.00003 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.378 | L2-Norm(final)=16.905 | 2278.8 samples/s | 35.6 steps/s
[Step=48800 Epoch=459.8] | Loss=0.00003 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.371 | L2-Norm(final)=16.905 | 5333.7 samples/s | 83.3 steps/s
[Step=48850 Epoch=460.3] | Loss=0.00003 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.364 | L2-Norm(final)=16.906 | 2409.8 samples/s | 37.7 steps/s
[Step=48900 Epoch=460.8] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.357 | L2-Norm(final)=16.906 | 4876.8 samples/s | 76.2 steps/s
[Step=48950 Epoch=461.2] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.350 | L2-Norm(final)=16.906 | 2533.5 samples/s | 39.6 steps/s
[Step=49000 Epoch=461.7] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.343 | L2-Norm(final)=16.907 | 4535.2 samples/s | 70.9 steps/s
[Step=49050 Epoch=462.2] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.336 | L2-Norm(final)=16.907 | 2569.0 samples/s | 40.1 steps/s
[Step=49100 Epoch=462.7] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.328 | L2-Norm(final)=16.907 | 4710.5 samples/s | 73.6 steps/s
[Step=49150 Epoch=463.1] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.321 | L2-Norm(final)=16.908 | 2551.4 samples/s | 39.9 steps/s
[Step=49200 Epoch=463.6] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.313 | L2-Norm(final)=16.908 | 4635.0 samples/s | 72.4 steps/s
[Step=49250 Epoch=464.1] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.306 | L2-Norm(final)=16.908 | 2793.5 samples/s | 43.6 steps/s
[Step=49300 Epoch=464.5] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.298 | L2-Norm(final)=16.909 | 4065.7 samples/s | 63.5 steps/s
[Step=49350 Epoch=465.0] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.290 | L2-Norm(final)=16.909 | 6730.9 samples/s | 105.2 steps/s
[Step=49400 Epoch=465.5] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.282 | L2-Norm(final)=16.909 | 2191.4 samples/s | 34.2 steps/s
[Step=49450 Epoch=466.0] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.274 | L2-Norm(final)=16.909 | 6014.0 samples/s | 94.0 steps/s
[Step=49500 Epoch=466.4] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.266 | L2-Norm(final)=16.910 | 2309.4 samples/s | 36.1 steps/s
[Step=49550 Epoch=466.9] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.258 | L2-Norm(final)=16.910 | 5356.1 samples/s | 83.7 steps/s
[Step=49600 Epoch=467.4] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.250 | L2-Norm(final)=16.910 | 2394.7 samples/s | 37.4 steps/s
[Step=49650 Epoch=467.8] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.242 | L2-Norm(final)=16.910 | 4857.5 samples/s | 75.9 steps/s
[Step=49700 Epoch=468.3] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.233 | L2-Norm(final)=16.911 | 2466.8 samples/s | 38.5 steps/s
[Step=49750 Epoch=468.8] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.225 | L2-Norm(final)=16.911 | 4645.7 samples/s | 72.6 steps/s
[Step=49800 Epoch=469.3] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.216 | L2-Norm(final)=16.911 | 2566.3 samples/s | 40.1 steps/s
[Step=49850 Epoch=469.7] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.208 | L2-Norm(final)=16.911 | 4603.5 samples/s | 71.9 steps/s
[Step=49900 Epoch=470.2] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.199 | L2-Norm(final)=16.912 | 2618.6 samples/s | 40.9 steps/s
[Step=49950 Epoch=470.7] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.190 | L2-Norm(final)=16.912 | 4520.8 samples/s | 70.6 steps/s
[Step=50000 Epoch=471.1] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.181 | L2-Norm(final)=16.912 | 2769.3 samples/s | 43.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step50000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07594 | acc=0.9642 | tpr=0.9715 | fpr=0.0515 | 5432.3 samples/s | 21.2 steps/s
Avg test loss: 0.08377, Avg test acc: 0.96218, Avg tpr: 0.97074, Avg fpr: 0.05666, total FA: 442

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07800 | acc=0.9651 | tpr=0.9741 | fpr=0.0545 | 5628.1 samples/s | 22.0 steps/s
Avg test loss: 0.08673, Avg test acc: 0.96334, Avg tpr: 0.97220, Avg fpr: 0.05615, total FA: 438

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.07917 | acc=0.9652 | tpr=0.9770 | fpr=0.0605 | 5519.3 samples/s | 21.6 steps/s
Avg test loss: 0.08692, Avg test acc: 0.96310, Avg tpr: 0.97400, Avg fpr: 0.06089, total FA: 475

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.07649 | acc=0.9645 | tpr=0.9760 | fpr=0.0607 | 5431.8 samples/s | 21.2 steps/s
Avg test loss: 0.08540, Avg test acc: 0.96358, Avg tpr: 0.97570, Avg fpr: 0.06307, total FA: 492

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.07501 | acc=0.9660 | tpr=0.9743 | fpr=0.0520 | 5597.1 samples/s | 21.9 steps/s
Avg test loss: 0.08638, Avg test acc: 0.96434, Avg tpr: 0.97290, Avg fpr: 0.05448, total FA: 425

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.39701 | acc=0.2666 | tpr=0.0092 | fpr=0.1744 | 5583.6 samples/s | 21.8 steps/s
Avg test loss: 5.40298, Avg test acc: 0.26533, Avg tpr: 0.00956, Avg fpr: 0.17216, total FA: 1343

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.67408 | acc=0.2973 | tpr=0.0160 | fpr=0.0917 | 5687.4 samples/s | 22.2 steps/s
Avg test loss: 4.68322, Avg test acc: 0.29522, Avg tpr: 0.01638, Avg fpr: 0.09153, total FA: 714

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.11756 | acc=0.2493 | tpr=0.0128 | fpr=0.2371 | 5758.8 samples/s | 22.5 steps/s
Avg test loss: 5.12324, Avg test acc: 0.25034, Avg tpr: 0.01358, Avg fpr: 0.22895, total FA: 1786

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.88203 | acc=0.2520 | tpr=0.0094 | fpr=0.2213 | 5697.4 samples/s | 22.3 steps/s
Avg test loss: 5.88998, Avg test acc: 0.25194, Avg tpr: 0.00973, Avg fpr: 0.21536, total FA: 1680

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.54321 | acc=0.2373 | tpr=0.0067 | fpr=0.2621 | 5734.7 samples/s | 22.4 steps/s
Avg test loss: 5.54691, Avg test acc: 0.23724, Avg tpr: 0.00758, Avg fpr: 0.25766, total FA: 2010

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.96433 | acc=0.1566 | tpr=0.2035 | fpr=0.8442 | 5720.9 samples/s | 22.3 steps/s
[Step= 100] | Loss=4.92097 | acc=0.1578 | tpr=0.1834 | fpr=0.8427 | 8047.5 samples/s | 31.4 steps/s
[Step= 150] | Loss=4.93939 | acc=0.1573 | tpr=0.1816 | fpr=0.8432 | 8034.2 samples/s | 31.4 steps/s
[Step= 200] | Loss=4.93339 | acc=0.1573 | tpr=0.1792 | fpr=0.8431 | 8161.2 samples/s | 31.9 steps/s
[Step= 250] | Loss=4.94030 | acc=0.1576 | tpr=0.1799 | fpr=0.8428 | 8170.9 samples/s | 31.9 steps/s
[Step= 300] | Loss=4.94460 | acc=0.1571 | tpr=0.1833 | fpr=0.8434 | 7440.8 samples/s | 29.1 steps/s
[Step= 350] | Loss=4.94686 | acc=0.1570 | tpr=0.1753 | fpr=0.8433 | 8172.2 samples/s | 31.9 steps/s
[Step= 400] | Loss=4.94572 | acc=0.1574 | tpr=0.1789 | fpr=0.8429 | 8221.9 samples/s | 32.1 steps/s
[Step= 450] | Loss=4.94490 | acc=0.1578 | tpr=0.1767 | fpr=0.8426 | 8359.2 samples/s | 32.7 steps/s
[Step= 500] | Loss=4.94814 | acc=0.1576 | tpr=0.1806 | fpr=0.8428 | 8300.7 samples/s | 32.4 steps/s
[Step= 550] | Loss=4.94627 | acc=0.1576 | tpr=0.1779 | fpr=0.8427 | 9597.6 samples/s | 37.5 steps/s
Avg test loss: 4.94588, Avg test acc: 0.15753, Avg tpr: 0.17789, Avg fpr: 0.84284, total FA: 117026

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.96567 | acc=0.1505 | tpr=0.2168 | fpr=0.8507 | 5625.0 samples/s | 22.0 steps/s
[Step= 100] | Loss=4.91911 | acc=0.1524 | tpr=0.2026 | fpr=0.8485 | 8231.6 samples/s | 32.2 steps/s
[Step= 150] | Loss=4.93523 | acc=0.1498 | tpr=0.1974 | fpr=0.8511 | 7163.8 samples/s | 28.0 steps/s
[Step= 200] | Loss=4.93069 | acc=0.1498 | tpr=0.1880 | fpr=0.8509 | 8347.2 samples/s | 32.6 steps/s
[Step= 250] | Loss=4.93828 | acc=0.1499 | tpr=0.1834 | fpr=0.8508 | 8261.0 samples/s | 32.3 steps/s
[Step= 300] | Loss=4.94018 | acc=0.1490 | tpr=0.1862 | fpr=0.8517 | 8326.3 samples/s | 32.5 steps/s
[Step= 350] | Loss=4.94254 | acc=0.1487 | tpr=0.1772 | fpr=0.8518 | 8858.6 samples/s | 34.6 steps/s
[Step= 400] | Loss=4.94200 | acc=0.1492 | tpr=0.1822 | fpr=0.8514 | 8117.0 samples/s | 31.7 steps/s
[Step= 450] | Loss=4.94078 | acc=0.1496 | tpr=0.1821 | fpr=0.8510 | 8079.4 samples/s | 31.6 steps/s
[Step= 500] | Loss=4.94437 | acc=0.1494 | tpr=0.1837 | fpr=0.8512 | 7247.3 samples/s | 28.3 steps/s
[Step= 550] | Loss=4.94215 | acc=0.1497 | tpr=0.1823 | fpr=0.8509 | 10714.7 samples/s | 41.9 steps/s
Avg test loss: 4.94225, Avg test acc: 0.14962, Avg tpr: 0.18225, Avg fpr: 0.85097, total FA: 118156

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.56280 | acc=0.1376 | tpr=0.1460 | fpr=0.8626 | 5693.6 samples/s | 22.2 steps/s
[Step= 100] | Loss=5.51853 | acc=0.1396 | tpr=0.1386 | fpr=0.8603 | 7440.0 samples/s | 29.1 steps/s
[Step= 150] | Loss=5.52958 | acc=0.1388 | tpr=0.1383 | fpr=0.8612 | 8288.0 samples/s | 32.4 steps/s
[Step= 200] | Loss=5.52242 | acc=0.1392 | tpr=0.1333 | fpr=0.8607 | 8198.7 samples/s | 32.0 steps/s
[Step= 250] | Loss=5.52727 | acc=0.1392 | tpr=0.1301 | fpr=0.8606 | 7947.8 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.53297 | acc=0.1388 | tpr=0.1295 | fpr=0.8610 | 8277.8 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.53700 | acc=0.1384 | tpr=0.1240 | fpr=0.8614 | 8064.5 samples/s | 31.5 steps/s
[Step= 400] | Loss=5.53561 | acc=0.1389 | tpr=0.1307 | fpr=0.8609 | 8195.9 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.53409 | acc=0.1391 | tpr=0.1300 | fpr=0.8607 | 7668.4 samples/s | 30.0 steps/s
[Step= 500] | Loss=5.53646 | acc=0.1390 | tpr=0.1313 | fpr=0.8609 | 7546.3 samples/s | 29.5 steps/s
[Step= 550] | Loss=5.53329 | acc=0.1394 | tpr=0.1309 | fpr=0.8604 | 11779.9 samples/s | 46.0 steps/s
Avg test loss: 5.53304, Avg test acc: 0.13932, Avg tpr: 0.13114, Avg fpr: 0.86053, total FA: 119483

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.03478 | acc=0.1460 | tpr=0.1858 | fpr=0.8547 | 5798.4 samples/s | 22.6 steps/s
[Step= 100] | Loss=4.99203 | acc=0.1472 | tpr=0.1834 | fpr=0.8534 | 7697.1 samples/s | 30.1 steps/s
[Step= 150] | Loss=5.00920 | acc=0.1458 | tpr=0.1816 | fpr=0.8548 | 7671.1 samples/s | 30.0 steps/s
[Step= 200] | Loss=5.00201 | acc=0.1457 | tpr=0.1738 | fpr=0.8548 | 7910.2 samples/s | 30.9 steps/s
[Step= 250] | Loss=5.00794 | acc=0.1461 | tpr=0.1747 | fpr=0.8545 | 7982.5 samples/s | 31.2 steps/s
[Step= 300] | Loss=5.01286 | acc=0.1452 | tpr=0.1753 | fpr=0.8554 | 8195.9 samples/s | 32.0 steps/s
[Step= 350] | Loss=5.01490 | acc=0.1447 | tpr=0.1684 | fpr=0.8557 | 8089.1 samples/s | 31.6 steps/s
[Step= 400] | Loss=5.01445 | acc=0.1452 | tpr=0.1734 | fpr=0.8554 | 8135.1 samples/s | 31.8 steps/s
[Step= 450] | Loss=5.01369 | acc=0.1454 | tpr=0.1733 | fpr=0.8551 | 8075.5 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.01689 | acc=0.1452 | tpr=0.1767 | fpr=0.8554 | 7708.5 samples/s | 30.1 steps/s
[Step= 550] | Loss=5.01438 | acc=0.1455 | tpr=0.1791 | fpr=0.8551 | 11905.1 samples/s | 46.5 steps/s
Avg test loss: 5.01408, Avg test acc: 0.14543, Avg tpr: 0.17908, Avg fpr: 0.85518, total FA: 118740

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.33050 | acc=0.1490 | tpr=0.1416 | fpr=0.8509 | 5646.9 samples/s | 22.1 steps/s
[Step= 100] | Loss=5.28129 | acc=0.1512 | tpr=0.1343 | fpr=0.8484 | 7860.1 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.29942 | acc=0.1501 | tpr=0.1254 | fpr=0.8494 | 7492.0 samples/s | 29.3 steps/s
[Step= 200] | Loss=5.29644 | acc=0.1500 | tpr=0.1224 | fpr=0.8495 | 8420.1 samples/s | 32.9 steps/s
[Step= 250] | Loss=5.30344 | acc=0.1499 | tpr=0.1231 | fpr=0.8496 | 8160.3 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.30622 | acc=0.1495 | tpr=0.1244 | fpr=0.8500 | 8965.1 samples/s | 35.0 steps/s
[Step= 350] | Loss=5.30966 | acc=0.1491 | tpr=0.1209 | fpr=0.8504 | 8071.1 samples/s | 31.5 steps/s
[Step= 400] | Loss=5.30859 | acc=0.1492 | tpr=0.1220 | fpr=0.8503 | 7873.9 samples/s | 30.8 steps/s
[Step= 450] | Loss=5.30759 | acc=0.1495 | tpr=0.1232 | fpr=0.8500 | 7290.7 samples/s | 28.5 steps/s
[Step= 500] | Loss=5.31113 | acc=0.1492 | tpr=0.1247 | fpr=0.8503 | 7880.6 samples/s | 30.8 steps/s
[Step= 550] | Loss=5.30775 | acc=0.1493 | tpr=0.1242 | fpr=0.8502 | 11294.5 samples/s | 44.1 steps/s
Avg test loss: 5.30749, Avg test acc: 0.14920, Avg tpr: 0.12401, Avg fpr: 0.85035, total FA: 118069

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11219 | acc=0.9801 | tpr=0.9292 | fpr=0.0190 | 5504.6 samples/s | 21.5 steps/s
[Step= 100] | Loss=0.11333 | acc=0.9804 | tpr=0.9488 | fpr=0.0190 | 8407.5 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.11721 | acc=0.9796 | tpr=0.9524 | fpr=0.0199 | 8585.1 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.11923 | acc=0.9796 | tpr=0.9563 | fpr=0.0199 | 7811.2 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.11999 | acc=0.9795 | tpr=0.9528 | fpr=0.0200 | 7936.2 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.12149 | acc=0.9795 | tpr=0.9535 | fpr=0.0200 | 7791.6 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.12158 | acc=0.9795 | tpr=0.9555 | fpr=0.0201 | 8765.9 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.12264 | acc=0.9792 | tpr=0.9513 | fpr=0.0203 | 8099.6 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.12500 | acc=0.9789 | tpr=0.9489 | fpr=0.0206 | 8074.8 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.12400 | acc=0.9790 | tpr=0.9511 | fpr=0.0205 | 7839.8 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.12307 | acc=0.9790 | tpr=0.9511 | fpr=0.0204 | 9706.9 samples/s | 37.9 steps/s
Avg test loss: 0.12282, Avg test acc: 0.97908, Avg tpr: 0.95087, Avg fpr: 0.02041, total FA: 2834

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10460 | acc=0.9804 | tpr=0.9071 | fpr=0.0183 | 5758.7 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.10599 | acc=0.9802 | tpr=0.9254 | fpr=0.0188 | 7847.9 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.10924 | acc=0.9795 | tpr=0.9337 | fpr=0.0197 | 8221.5 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.11051 | acc=0.9795 | tpr=0.9366 | fpr=0.0198 | 7149.2 samples/s | 27.9 steps/s
[Step= 250] | Loss=0.11147 | acc=0.9794 | tpr=0.9345 | fpr=0.0198 | 8682.4 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.11309 | acc=0.9792 | tpr=0.9353 | fpr=0.0200 | 8113.8 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.11298 | acc=0.9791 | tpr=0.9368 | fpr=0.0201 | 8236.7 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.11391 | acc=0.9789 | tpr=0.9322 | fpr=0.0202 | 8210.5 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.11573 | acc=0.9787 | tpr=0.9309 | fpr=0.0204 | 8164.3 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.11493 | acc=0.9788 | tpr=0.9330 | fpr=0.0204 | 8167.2 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.11385 | acc=0.9790 | tpr=0.9320 | fpr=0.0201 | 9968.4 samples/s | 38.9 steps/s
Avg test loss: 0.11364, Avg test acc: 0.97903, Avg tpr: 0.93146, Avg fpr: 0.02010, total FA: 2791

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11205 | acc=0.9783 | tpr=0.9381 | fpr=0.0210 | 5572.5 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.11389 | acc=0.9784 | tpr=0.9595 | fpr=0.0212 | 8429.6 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.11839 | acc=0.9774 | tpr=0.9597 | fpr=0.0223 | 8181.9 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.11993 | acc=0.9775 | tpr=0.9607 | fpr=0.0222 | 8076.4 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.12104 | acc=0.9774 | tpr=0.9590 | fpr=0.0222 | 8119.0 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.12232 | acc=0.9774 | tpr=0.9585 | fpr=0.0222 | 7251.2 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.12207 | acc=0.9776 | tpr=0.9599 | fpr=0.0221 | 8183.6 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.12285 | acc=0.9774 | tpr=0.9568 | fpr=0.0223 | 8737.0 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.12486 | acc=0.9771 | tpr=0.9547 | fpr=0.0225 | 8111.7 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.12404 | acc=0.9772 | tpr=0.9564 | fpr=0.0225 | 8298.0 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.12291 | acc=0.9774 | tpr=0.9562 | fpr=0.0223 | 9390.7 samples/s | 36.7 steps/s
Avg test loss: 0.12266, Avg test acc: 0.97737, Avg tpr: 0.95602, Avg fpr: 0.02224, total FA: 3088

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10038 | acc=0.9815 | tpr=0.9336 | fpr=0.0177 | 5710.0 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.10190 | acc=0.9813 | tpr=0.9403 | fpr=0.0179 | 7699.0 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.10439 | acc=0.9808 | tpr=0.9452 | fpr=0.0186 | 8239.4 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.10584 | acc=0.9808 | tpr=0.9486 | fpr=0.0186 | 8051.7 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.10673 | acc=0.9806 | tpr=0.9459 | fpr=0.0187 | 8314.3 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.10763 | acc=0.9805 | tpr=0.9455 | fpr=0.0188 | 7903.1 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.10748 | acc=0.9806 | tpr=0.9493 | fpr=0.0188 | 8152.5 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.10829 | acc=0.9805 | tpr=0.9458 | fpr=0.0189 | 7686.5 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.11016 | acc=0.9802 | tpr=0.9440 | fpr=0.0191 | 8635.5 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.10929 | acc=0.9804 | tpr=0.9463 | fpr=0.0190 | 8252.6 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.10849 | acc=0.9805 | tpr=0.9439 | fpr=0.0189 | 9808.9 samples/s | 38.3 steps/s
Avg test loss: 0.10828, Avg test acc: 0.98050, Avg tpr: 0.94374, Avg fpr: 0.01883, total FA: 2615

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.11064 | acc=0.9807 | tpr=0.9248 | fpr=0.0183 | 5743.5 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.11310 | acc=0.9802 | tpr=0.9360 | fpr=0.0189 | 7551.5 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.11691 | acc=0.9797 | tpr=0.9424 | fpr=0.0196 | 7562.8 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.11845 | acc=0.9797 | tpr=0.9464 | fpr=0.0196 | 8542.0 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.11960 | acc=0.9797 | tpr=0.9432 | fpr=0.0196 | 8622.3 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.12083 | acc=0.9798 | tpr=0.9425 | fpr=0.0195 | 8232.0 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.12063 | acc=0.9799 | tpr=0.9449 | fpr=0.0195 | 7848.0 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.12150 | acc=0.9797 | tpr=0.9420 | fpr=0.0196 | 7727.9 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.12375 | acc=0.9794 | tpr=0.9416 | fpr=0.0199 | 8886.6 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.12277 | acc=0.9795 | tpr=0.9441 | fpr=0.0198 | 7941.1 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.12185 | acc=0.9796 | tpr=0.9419 | fpr=0.0197 | 9417.7 samples/s | 36.8 steps/s
Avg test loss: 0.12162, Avg test acc: 0.97961, Avg tpr: 0.94176, Avg fpr: 0.01971, total FA: 2736

server round 48/50

clients selected: [0 2 3 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=36001 Epoch=175.5] | Loss=0.00394 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=14.346 | 5948.2 samples/s | 92.9 steps/s
[Step=36050 Epoch=175.8] | Loss=0.01621 | Reg=0.00087 | acc=0.9531 | L2-Norm=9.331 | L2-Norm(final)=14.348 | 4958.0 samples/s | 77.5 steps/s
[Step=36100 Epoch=176.0] | Loss=0.01501 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.331 | L2-Norm(final)=14.350 | 5658.6 samples/s | 88.4 steps/s
[Step=36150 Epoch=176.3] | Loss=0.01544 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=14.351 | 5528.8 samples/s | 86.4 steps/s
[Step=36200 Epoch=176.5] | Loss=0.01541 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=14.353 | 8707.8 samples/s | 136.1 steps/s
[Step=36250 Epoch=176.8] | Loss=0.01547 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.331 | L2-Norm(final)=14.355 | 2443.1 samples/s | 38.2 steps/s
[Step=36300 Epoch=177.0] | Loss=0.01586 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=14.357 | 5676.9 samples/s | 88.7 steps/s
[Step=36350 Epoch=177.2] | Loss=0.01598 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.331 | L2-Norm(final)=14.358 | 5615.6 samples/s | 87.7 steps/s
[Step=36400 Epoch=177.5] | Loss=0.01551 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=14.360 | 7740.0 samples/s | 120.9 steps/s
[Step=36450 Epoch=177.7] | Loss=0.01565 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.331 | L2-Norm(final)=14.361 | 2541.8 samples/s | 39.7 steps/s
[Step=36500 Epoch=178.0] | Loss=0.01593 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=14.363 | 5661.2 samples/s | 88.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=36501 Epoch=178.0] | Loss=0.01551 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.331 | L2-Norm(final)=14.377 | 5869.6 samples/s | 91.7 steps/s
[Step=36550 Epoch=178.2] | Loss=0.01365 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.337 | L2-Norm(final)=14.379 | 4577.5 samples/s | 71.5 steps/s
[Step=36600 Epoch=178.5] | Loss=0.01368 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.345 | L2-Norm(final)=14.381 | 4855.5 samples/s | 75.9 steps/s
[Step=36650 Epoch=178.7] | Loss=0.01271 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.352 | L2-Norm(final)=14.383 | 4767.8 samples/s | 74.5 steps/s
[Step=36700 Epoch=179.0] | Loss=0.01266 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.358 | L2-Norm(final)=14.385 | 6974.5 samples/s | 109.0 steps/s
[Step=36750 Epoch=179.2] | Loss=0.01127 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.364 | L2-Norm(final)=14.387 | 2291.5 samples/s | 35.8 steps/s
[Step=36800 Epoch=179.4] | Loss=0.01054 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.368 | L2-Norm(final)=14.390 | 4898.3 samples/s | 76.5 steps/s
[Step=36850 Epoch=179.7] | Loss=0.00969 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.373 | L2-Norm(final)=14.392 | 4820.6 samples/s | 75.3 steps/s
[Step=36900 Epoch=179.9] | Loss=0.00911 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.377 | L2-Norm(final)=14.395 | 6337.7 samples/s | 99.0 steps/s
[Step=36950 Epoch=180.2] | Loss=0.00859 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.381 | L2-Norm(final)=14.397 | 2359.9 samples/s | 36.9 steps/s
[Step=37000 Epoch=180.4] | Loss=0.00821 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.384 | L2-Norm(final)=14.400 | 4838.4 samples/s | 75.6 steps/s
[Step=37050 Epoch=180.7] | Loss=0.00795 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.388 | L2-Norm(final)=14.402 | 4846.4 samples/s | 75.7 steps/s
[Step=37100 Epoch=180.9] | Loss=0.00765 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.391 | L2-Norm(final)=14.405 | 5823.3 samples/s | 91.0 steps/s
[Step=37150 Epoch=181.2] | Loss=0.00739 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.394 | L2-Norm(final)=14.407 | 2404.3 samples/s | 37.6 steps/s
[Step=37200 Epoch=181.4] | Loss=0.00712 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.398 | L2-Norm(final)=14.410 | 4858.5 samples/s | 75.9 steps/s
[Step=37250 Epoch=181.6] | Loss=0.00692 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.401 | L2-Norm(final)=14.412 | 4850.1 samples/s | 75.8 steps/s
[Step=37300 Epoch=181.9] | Loss=0.00680 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.404 | L2-Norm(final)=14.414 | 5363.7 samples/s | 83.8 steps/s
[Step=37350 Epoch=182.1] | Loss=0.00664 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.406 | L2-Norm(final)=14.416 | 2495.1 samples/s | 39.0 steps/s
[Step=37400 Epoch=182.4] | Loss=0.00652 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.409 | L2-Norm(final)=14.419 | 4859.6 samples/s | 75.9 steps/s
[Step=37450 Epoch=182.6] | Loss=0.00635 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.412 | L2-Norm(final)=14.421 | 4879.2 samples/s | 76.2 steps/s
[Step=37500 Epoch=182.9] | Loss=0.00621 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.415 | L2-Norm(final)=14.423 | 4990.4 samples/s | 78.0 steps/s
[Step=37550 Epoch=183.1] | Loss=0.00606 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.417 | L2-Norm(final)=14.425 | 2581.1 samples/s | 40.3 steps/s
[Step=37600 Epoch=183.3] | Loss=0.00592 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.419 | L2-Norm(final)=14.427 | 4846.9 samples/s | 75.7 steps/s
[Step=37650 Epoch=183.6] | Loss=0.00581 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.422 | L2-Norm(final)=14.429 | 4893.3 samples/s | 76.5 steps/s
[Step=37700 Epoch=183.8] | Loss=0.00572 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.424 | L2-Norm(final)=14.431 | 4850.3 samples/s | 75.8 steps/s
[Step=37750 Epoch=184.1] | Loss=0.00566 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.427 | L2-Norm(final)=14.433 | 2650.1 samples/s | 41.4 steps/s
[Step=37800 Epoch=184.3] | Loss=0.00559 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.429 | L2-Norm(final)=14.435 | 4836.1 samples/s | 75.6 steps/s
[Step=37850 Epoch=184.6] | Loss=0.00551 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.431 | L2-Norm(final)=14.437 | 4888.7 samples/s | 76.4 steps/s
[Step=37900 Epoch=184.8] | Loss=0.00539 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.433 | L2-Norm(final)=14.439 | 4862.8 samples/s | 76.0 steps/s
[Step=37950 Epoch=185.1] | Loss=0.00529 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.435 | L2-Norm(final)=14.441 | 2668.8 samples/s | 41.7 steps/s
[Step=38000 Epoch=185.3] | Loss=0.00521 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.437 | L2-Norm(final)=14.442 | 4899.1 samples/s | 76.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_0/client_state-step38000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=52001 Epoch=253.4] | Loss=0.01060 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=15.367 | 5616.8 samples/s | 87.8 steps/s
[Step=52050 Epoch=253.6] | Loss=0.01877 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.331 | L2-Norm(final)=15.367 | 5044.1 samples/s | 78.8 steps/s
[Step=52100 Epoch=253.9] | Loss=0.01743 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=15.367 | 5672.4 samples/s | 88.6 steps/s
[Step=52150 Epoch=254.1] | Loss=0.01582 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.331 | L2-Norm(final)=15.368 | 5547.1 samples/s | 86.7 steps/s
[Step=52200 Epoch=254.3] | Loss=0.01544 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=15.369 | 8690.0 samples/s | 135.8 steps/s
[Step=52250 Epoch=254.6] | Loss=0.01623 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.331 | L2-Norm(final)=15.370 | 2423.5 samples/s | 37.9 steps/s
[Step=52300 Epoch=254.8] | Loss=0.01597 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=15.371 | 5690.2 samples/s | 88.9 steps/s
[Step=52350 Epoch=255.1] | Loss=0.01589 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=15.372 | 5400.1 samples/s | 84.4 steps/s
[Step=52400 Epoch=255.3] | Loss=0.01540 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.331 | L2-Norm(final)=15.373 | 7717.5 samples/s | 120.6 steps/s
[Step=52450 Epoch=255.6] | Loss=0.01568 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.331 | L2-Norm(final)=15.374 | 2512.7 samples/s | 39.3 steps/s
[Step=52500 Epoch=255.8] | Loss=0.01566 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=15.375 | 5703.3 samples/s | 89.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=52501 Epoch=255.8] | Loss=0.00453 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=15.384 | 5862.6 samples/s | 91.6 steps/s
[Step=52550 Epoch=256.0] | Loss=0.01341 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.337 | L2-Norm(final)=15.385 | 4368.7 samples/s | 68.3 steps/s
[Step=52600 Epoch=256.3] | Loss=0.01460 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.343 | L2-Norm(final)=15.386 | 4926.0 samples/s | 77.0 steps/s
[Step=52650 Epoch=256.5] | Loss=0.01354 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.349 | L2-Norm(final)=15.387 | 4885.4 samples/s | 76.3 steps/s
[Step=52700 Epoch=256.8] | Loss=0.01296 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.355 | L2-Norm(final)=15.389 | 6806.9 samples/s | 106.4 steps/s
[Step=52750 Epoch=257.0] | Loss=0.01147 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.360 | L2-Norm(final)=15.391 | 2274.2 samples/s | 35.5 steps/s
[Step=52800 Epoch=257.3] | Loss=0.01047 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.365 | L2-Norm(final)=15.394 | 4903.7 samples/s | 76.6 steps/s
[Step=52850 Epoch=257.5] | Loss=0.00966 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.369 | L2-Norm(final)=15.396 | 4817.5 samples/s | 75.3 steps/s
[Step=52900 Epoch=257.8] | Loss=0.00910 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.373 | L2-Norm(final)=15.399 | 6264.3 samples/s | 97.9 steps/s
[Step=52950 Epoch=258.0] | Loss=0.00854 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.377 | L2-Norm(final)=15.401 | 2329.4 samples/s | 36.4 steps/s
[Step=53000 Epoch=258.2] | Loss=0.00799 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.380 | L2-Norm(final)=15.404 | 4856.1 samples/s | 75.9 steps/s
[Step=53050 Epoch=258.5] | Loss=0.00765 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.384 | L2-Norm(final)=15.406 | 4844.7 samples/s | 75.7 steps/s
[Step=53100 Epoch=258.7] | Loss=0.00745 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.387 | L2-Norm(final)=15.409 | 5849.8 samples/s | 91.4 steps/s
[Step=53150 Epoch=259.0] | Loss=0.00713 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.390 | L2-Norm(final)=15.411 | 2437.7 samples/s | 38.1 steps/s
[Step=53200 Epoch=259.2] | Loss=0.00686 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.393 | L2-Norm(final)=15.414 | 4900.4 samples/s | 76.6 steps/s
[Step=53250 Epoch=259.5] | Loss=0.00669 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.396 | L2-Norm(final)=15.416 | 4779.5 samples/s | 74.7 steps/s
[Step=53300 Epoch=259.7] | Loss=0.00645 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.399 | L2-Norm(final)=15.418 | 5376.9 samples/s | 84.0 steps/s
[Step=53350 Epoch=259.9] | Loss=0.00631 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.402 | L2-Norm(final)=15.420 | 2493.9 samples/s | 39.0 steps/s
[Step=53400 Epoch=260.2] | Loss=0.00612 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.404 | L2-Norm(final)=15.422 | 4851.7 samples/s | 75.8 steps/s
[Step=53450 Epoch=260.4] | Loss=0.00594 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.407 | L2-Norm(final)=15.425 | 4826.2 samples/s | 75.4 steps/s
[Step=53500 Epoch=260.7] | Loss=0.00577 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.409 | L2-Norm(final)=15.427 | 5003.7 samples/s | 78.2 steps/s
[Step=53550 Epoch=260.9] | Loss=0.00564 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.412 | L2-Norm(final)=15.429 | 2591.9 samples/s | 40.5 steps/s
[Step=53600 Epoch=261.2] | Loss=0.00549 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.414 | L2-Norm(final)=15.431 | 4859.0 samples/s | 75.9 steps/s
[Step=53650 Epoch=261.4] | Loss=0.00536 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.417 | L2-Norm(final)=15.433 | 4856.0 samples/s | 75.9 steps/s
[Step=53700 Epoch=261.7] | Loss=0.00529 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.419 | L2-Norm(final)=15.435 | 4921.8 samples/s | 76.9 steps/s
[Step=53750 Epoch=261.9] | Loss=0.00514 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.421 | L2-Norm(final)=15.437 | 2654.1 samples/s | 41.5 steps/s
[Step=53800 Epoch=262.1] | Loss=0.00506 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.423 | L2-Norm(final)=15.439 | 4759.9 samples/s | 74.4 steps/s
[Step=53850 Epoch=262.4] | Loss=0.00499 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.426 | L2-Norm(final)=15.441 | 4872.3 samples/s | 76.1 steps/s
[Step=53900 Epoch=262.6] | Loss=0.00491 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.428 | L2-Norm(final)=15.443 | 4902.0 samples/s | 76.6 steps/s
[Step=53950 Epoch=262.9] | Loss=0.00485 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.430 | L2-Norm(final)=15.445 | 2652.4 samples/s | 41.4 steps/s
[Step=54000 Epoch=263.1] | Loss=0.00475 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.432 | L2-Norm(final)=15.447 | 4830.1 samples/s | 75.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step54000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=58001 Epoch=282.8] | Loss=0.01720 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.331 | L2-Norm(final)=15.996 | 5327.4 samples/s | 83.2 steps/s
[Step=58050 Epoch=283.1] | Loss=0.01326 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=15.999 | 5171.8 samples/s | 80.8 steps/s
[Step=58100 Epoch=283.3] | Loss=0.01386 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=16.002 | 5618.5 samples/s | 87.8 steps/s
[Step=58150 Epoch=283.6] | Loss=0.01385 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=16.004 | 5552.0 samples/s | 86.7 steps/s
[Step=58200 Epoch=283.8] | Loss=0.01368 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.331 | L2-Norm(final)=16.005 | 8806.5 samples/s | 137.6 steps/s
[Step=58250 Epoch=284.1] | Loss=0.01339 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=16.007 | 2439.2 samples/s | 38.1 steps/s
[Step=58300 Epoch=284.3] | Loss=0.01333 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=16.009 | 5615.0 samples/s | 87.7 steps/s
[Step=58350 Epoch=284.5] | Loss=0.01347 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.331 | L2-Norm(final)=16.011 | 5705.0 samples/s | 89.1 steps/s
[Step=58400 Epoch=284.8] | Loss=0.01371 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=16.012 | 7749.8 samples/s | 121.1 steps/s
[Step=58450 Epoch=285.0] | Loss=0.01361 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=16.014 | 2516.7 samples/s | 39.3 steps/s
[Step=58500 Epoch=285.3] | Loss=0.01365 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=16.016 | 5656.2 samples/s | 88.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=58501 Epoch=285.3] | Loss=0.00550 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=16.031 | 5702.2 samples/s | 89.1 steps/s
[Step=58550 Epoch=285.5] | Loss=0.01471 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.336 | L2-Norm(final)=16.032 | 4452.3 samples/s | 69.6 steps/s
[Step=58600 Epoch=285.8] | Loss=0.01359 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.343 | L2-Norm(final)=16.032 | 4859.9 samples/s | 75.9 steps/s
[Step=58650 Epoch=286.0] | Loss=0.01237 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.349 | L2-Norm(final)=16.034 | 4857.2 samples/s | 75.9 steps/s
[Step=58700 Epoch=286.3] | Loss=0.01170 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.353 | L2-Norm(final)=16.035 | 6935.6 samples/s | 108.4 steps/s
[Step=58750 Epoch=286.5] | Loss=0.01012 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.358 | L2-Norm(final)=16.037 | 2254.2 samples/s | 35.2 steps/s
[Step=58800 Epoch=286.7] | Loss=0.00928 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.362 | L2-Norm(final)=16.038 | 4891.0 samples/s | 76.4 steps/s
[Step=58850 Epoch=287.0] | Loss=0.00888 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.365 | L2-Norm(final)=16.040 | 4825.2 samples/s | 75.4 steps/s
[Step=58900 Epoch=287.2] | Loss=0.00831 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.369 | L2-Norm(final)=16.042 | 6378.1 samples/s | 99.7 steps/s
[Step=58950 Epoch=287.5] | Loss=0.00773 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.372 | L2-Norm(final)=16.044 | 2360.1 samples/s | 36.9 steps/s
[Step=59000 Epoch=287.7] | Loss=0.00727 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.375 | L2-Norm(final)=16.046 | 4844.2 samples/s | 75.7 steps/s
[Step=59050 Epoch=288.0] | Loss=0.00699 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.377 | L2-Norm(final)=16.048 | 4865.8 samples/s | 76.0 steps/s
[Step=59100 Epoch=288.2] | Loss=0.00687 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.380 | L2-Norm(final)=16.050 | 5798.4 samples/s | 90.6 steps/s
[Step=59150 Epoch=288.4] | Loss=0.00656 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.383 | L2-Norm(final)=16.051 | 2411.4 samples/s | 37.7 steps/s
[Step=59200 Epoch=288.7] | Loss=0.00630 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.385 | L2-Norm(final)=16.053 | 4856.6 samples/s | 75.9 steps/s
[Step=59250 Epoch=288.9] | Loss=0.00616 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.388 | L2-Norm(final)=16.055 | 4889.0 samples/s | 76.4 steps/s
[Step=59300 Epoch=289.2] | Loss=0.00595 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.390 | L2-Norm(final)=16.057 | 5357.9 samples/s | 83.7 steps/s
[Step=59350 Epoch=289.4] | Loss=0.00581 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.393 | L2-Norm(final)=16.059 | 2530.6 samples/s | 39.5 steps/s
[Step=59400 Epoch=289.7] | Loss=0.00564 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.395 | L2-Norm(final)=16.060 | 4773.8 samples/s | 74.6 steps/s
[Step=59450 Epoch=289.9] | Loss=0.00550 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.397 | L2-Norm(final)=16.062 | 4905.9 samples/s | 76.7 steps/s
[Step=59500 Epoch=290.2] | Loss=0.00533 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.399 | L2-Norm(final)=16.064 | 4941.9 samples/s | 77.2 steps/s
[Step=59550 Epoch=290.4] | Loss=0.00516 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.401 | L2-Norm(final)=16.066 | 2607.4 samples/s | 40.7 steps/s
[Step=59600 Epoch=290.6] | Loss=0.00509 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.404 | L2-Norm(final)=16.067 | 4891.5 samples/s | 76.4 steps/s
[Step=59650 Epoch=290.9] | Loss=0.00494 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.406 | L2-Norm(final)=16.069 | 4872.3 samples/s | 76.1 steps/s
[Step=59700 Epoch=291.1] | Loss=0.00483 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.408 | L2-Norm(final)=16.071 | 4893.9 samples/s | 76.5 steps/s
[Step=59750 Epoch=291.4] | Loss=0.00475 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=16.073 | 2661.3 samples/s | 41.6 steps/s
[Step=59800 Epoch=291.6] | Loss=0.00465 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.412 | L2-Norm(final)=16.074 | 4826.6 samples/s | 75.4 steps/s
[Step=59850 Epoch=291.9] | Loss=0.00455 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.413 | L2-Norm(final)=16.076 | 4802.4 samples/s | 75.0 steps/s
[Step=59900 Epoch=292.1] | Loss=0.00450 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.415 | L2-Norm(final)=16.077 | 4890.8 samples/s | 76.4 steps/s
[Step=59950 Epoch=292.3] | Loss=0.00444 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.417 | L2-Norm(final)=16.079 | 2607.8 samples/s | 40.7 steps/s
[Step=60000 Epoch=292.6] | Loss=0.00434 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.419 | L2-Norm(final)=16.080 | 4859.1 samples/s | 75.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step60000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=48001 Epoch=458.4] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=17.220 | 6189.0 samples/s | 96.7 steps/s
[Step=48050 Epoch=458.8] | Loss=0.00007 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.326 | L2-Norm(final)=17.228 | 4309.8 samples/s | 67.3 steps/s
[Step=48100 Epoch=459.3] | Loss=0.00007 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=17.235 | 8430.7 samples/s | 131.7 steps/s
[Step=48150 Epoch=459.8] | Loss=0.00007 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=17.243 | 2307.8 samples/s | 36.1 steps/s
[Step=48200 Epoch=460.3] | Loss=0.00007 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=17.251 | 7706.0 samples/s | 120.4 steps/s
[Step=48250 Epoch=460.8] | Loss=0.00007 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=17.258 | 2400.3 samples/s | 37.5 steps/s
[Step=48300 Epoch=461.2] | Loss=0.00007 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=17.265 | 6927.2 samples/s | 108.2 steps/s
[Step=48350 Epoch=461.7] | Loss=0.00007 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=17.272 | 2472.3 samples/s | 38.6 steps/s
[Step=48400 Epoch=462.2] | Loss=0.00007 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=17.279 | 6326.3 samples/s | 98.8 steps/s
[Step=48450 Epoch=462.7] | Loss=0.00007 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=17.285 | 2565.3 samples/s | 40.1 steps/s
[Step=48500 Epoch=463.1] | Loss=0.00007 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=17.291 | 5750.7 samples/s | 89.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=48501 Epoch=463.2] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=17.349 | 5954.1 samples/s | 93.0 steps/s
[Step=48550 Epoch=463.6] | Loss=0.00007 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.329 | L2-Norm(final)=17.354 | 4039.3 samples/s | 63.1 steps/s
[Step=48600 Epoch=464.1] | Loss=0.00004 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.324 | L2-Norm(final)=17.356 | 6802.2 samples/s | 106.3 steps/s
[Step=48650 Epoch=464.6] | Loss=0.00003 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.317 | L2-Norm(final)=17.357 | 2182.1 samples/s | 34.1 steps/s
[Step=48700 Epoch=465.1] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.309 | L2-Norm(final)=17.358 | 6259.4 samples/s | 97.8 steps/s
[Step=48750 Epoch=465.5] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.300 | L2-Norm(final)=17.359 | 2274.8 samples/s | 35.5 steps/s
[Step=48800 Epoch=466.0] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.292 | L2-Norm(final)=17.359 | 5686.0 samples/s | 88.8 steps/s
[Step=48850 Epoch=466.5] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.283 | L2-Norm(final)=17.360 | 2299.3 samples/s | 35.9 steps/s
[Step=48900 Epoch=467.0] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.274 | L2-Norm(final)=17.360 | 5417.1 samples/s | 84.6 steps/s
[Step=48950 Epoch=467.4] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.264 | L2-Norm(final)=17.361 | 2414.7 samples/s | 37.7 steps/s
[Step=49000 Epoch=467.9] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.255 | L2-Norm(final)=17.361 | 4950.9 samples/s | 77.4 steps/s
[Step=49050 Epoch=468.4] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.246 | L2-Norm(final)=17.362 | 2462.2 samples/s | 38.5 steps/s
[Step=49100 Epoch=468.9] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.237 | L2-Norm(final)=17.362 | 4734.7 samples/s | 74.0 steps/s
[Step=49150 Epoch=469.4] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.227 | L2-Norm(final)=17.362 | 2524.6 samples/s | 39.4 steps/s
[Step=49200 Epoch=469.8] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.217 | L2-Norm(final)=17.363 | 4651.9 samples/s | 72.7 steps/s
[Step=49250 Epoch=470.3] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.208 | L2-Norm(final)=17.363 | 2618.1 samples/s | 40.9 steps/s
[Step=49300 Epoch=470.8] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.198 | L2-Norm(final)=17.363 | 4636.2 samples/s | 72.4 steps/s
[Step=49350 Epoch=471.3] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.188 | L2-Norm(final)=17.364 | 2567.4 samples/s | 40.1 steps/s
[Step=49400 Epoch=471.7] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.178 | L2-Norm(final)=17.364 | 4653.8 samples/s | 72.7 steps/s
[Step=49450 Epoch=472.2] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.168 | L2-Norm(final)=17.365 | 2544.1 samples/s | 39.8 steps/s
[Step=49500 Epoch=472.7] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.158 | L2-Norm(final)=17.365 | 4566.0 samples/s | 71.3 steps/s
[Step=49550 Epoch=473.2] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.148 | L2-Norm(final)=17.365 | 7463.5 samples/s | 116.6 steps/s
[Step=49600 Epoch=473.6] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.138 | L2-Norm(final)=17.366 | 2113.1 samples/s | 33.0 steps/s
[Step=49650 Epoch=474.1] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.128 | L2-Norm(final)=17.366 | 6784.1 samples/s | 106.0 steps/s
[Step=49700 Epoch=474.6] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.117 | L2-Norm(final)=17.366 | 2202.7 samples/s | 34.4 steps/s
[Step=49750 Epoch=475.1] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.107 | L2-Norm(final)=17.367 | 6155.1 samples/s | 96.2 steps/s
[Step=49800 Epoch=475.6] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.096 | L2-Norm(final)=17.367 | 2276.1 samples/s | 35.6 steps/s
[Step=49850 Epoch=476.0] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.085 | L2-Norm(final)=17.368 | 5639.1 samples/s | 88.1 steps/s
[Step=49900 Epoch=476.5] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.075 | L2-Norm(final)=17.368 | 2277.5 samples/s | 35.6 steps/s
[Step=49950 Epoch=477.0] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.064 | L2-Norm(final)=17.368 | 5427.2 samples/s | 84.8 steps/s
[Step=50000 Epoch=477.5] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.053 | L2-Norm(final)=17.369 | 2362.1 samples/s | 36.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_2/client_state-step50000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=50001 Epoch=471.2] | Loss=0.00020 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=16.920 | 5574.4 samples/s | 87.1 steps/s
[Step=50050 Epoch=471.6] | Loss=0.00016 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.327 | L2-Norm(final)=16.926 | 4844.6 samples/s | 75.7 steps/s
[Step=50100 Epoch=472.1] | Loss=0.00021 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.327 | L2-Norm(final)=16.933 | 7637.6 samples/s | 119.3 steps/s
[Step=50150 Epoch=472.6] | Loss=0.00022 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.327 | L2-Norm(final)=16.939 | 2346.3 samples/s | 36.7 steps/s
[Step=50200 Epoch=473.0] | Loss=0.00022 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.327 | L2-Norm(final)=16.945 | 7102.1 samples/s | 111.0 steps/s
[Step=50250 Epoch=473.5] | Loss=0.00023 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.327 | L2-Norm(final)=16.951 | 2487.6 samples/s | 38.9 steps/s
[Step=50300 Epoch=474.0] | Loss=0.00022 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.327 | L2-Norm(final)=16.956 | 6153.9 samples/s | 96.2 steps/s
[Step=50350 Epoch=474.4] | Loss=0.00022 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.327 | L2-Norm(final)=16.961 | 2623.8 samples/s | 41.0 steps/s
[Step=50400 Epoch=474.9] | Loss=0.00021 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.327 | L2-Norm(final)=16.966 | 5563.5 samples/s | 86.9 steps/s
[Step=50450 Epoch=475.4] | Loss=0.00022 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.327 | L2-Norm(final)=16.971 | 2702.9 samples/s | 42.2 steps/s
[Step=50500 Epoch=475.9] | Loss=0.00022 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.327 | L2-Norm(final)=16.976 | 5358.1 samples/s | 83.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=50501 Epoch=475.9] | Loss=0.00225 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.327 | L2-Norm(final)=17.022 | 5576.7 samples/s | 87.1 steps/s
[Step=50550 Epoch=476.3] | Loss=0.00034 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.337 | L2-Norm(final)=17.025 | 4208.5 samples/s | 65.8 steps/s
[Step=50600 Epoch=476.8] | Loss=0.00018 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.339 | L2-Norm(final)=17.026 | 6534.8 samples/s | 102.1 steps/s
[Step=50650 Epoch=477.3] | Loss=0.00013 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.338 | L2-Norm(final)=17.027 | 2204.5 samples/s | 34.4 steps/s
[Step=50700 Epoch=477.7] | Loss=0.00010 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.336 | L2-Norm(final)=17.028 | 5914.3 samples/s | 92.4 steps/s
[Step=50750 Epoch=478.2] | Loss=0.00008 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.334 | L2-Norm(final)=17.029 | 2330.5 samples/s | 36.4 steps/s
[Step=50800 Epoch=478.7] | Loss=0.00007 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=17.029 | 5270.9 samples/s | 82.4 steps/s
[Step=50850 Epoch=479.2] | Loss=0.00006 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.329 | L2-Norm(final)=17.030 | 2419.0 samples/s | 37.8 steps/s
[Step=50900 Epoch=479.6] | Loss=0.00005 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.326 | L2-Norm(final)=17.030 | 4907.3 samples/s | 76.7 steps/s
[Step=50950 Epoch=480.1] | Loss=0.00005 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.323 | L2-Norm(final)=17.031 | 2504.5 samples/s | 39.1 steps/s
[Step=51000 Epoch=480.6] | Loss=0.00004 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.320 | L2-Norm(final)=17.031 | 4667.5 samples/s | 72.9 steps/s
[Step=51050 Epoch=481.0] | Loss=0.00004 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.317 | L2-Norm(final)=17.032 | 2581.4 samples/s | 40.3 steps/s
[Step=51100 Epoch=481.5] | Loss=0.00004 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.313 | L2-Norm(final)=17.032 | 4626.7 samples/s | 72.3 steps/s
[Step=51150 Epoch=482.0] | Loss=0.00003 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.310 | L2-Norm(final)=17.033 | 2592.6 samples/s | 40.5 steps/s
[Step=51200 Epoch=482.4] | Loss=0.00003 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.307 | L2-Norm(final)=17.033 | 4636.6 samples/s | 72.4 steps/s
[Step=51250 Epoch=482.9] | Loss=0.00003 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.304 | L2-Norm(final)=17.033 | 2781.6 samples/s | 43.5 steps/s
[Step=51300 Epoch=483.4] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.300 | L2-Norm(final)=17.034 | 4135.9 samples/s | 64.6 steps/s
[Step=51350 Epoch=483.9] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.297 | L2-Norm(final)=17.034 | 6694.3 samples/s | 104.6 steps/s
[Step=51400 Epoch=484.3] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.294 | L2-Norm(final)=17.034 | 2161.1 samples/s | 33.8 steps/s
[Step=51450 Epoch=484.8] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.290 | L2-Norm(final)=17.035 | 6023.7 samples/s | 94.1 steps/s
[Step=51500 Epoch=485.3] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.286 | L2-Norm(final)=17.035 | 2288.7 samples/s | 35.8 steps/s
[Step=51550 Epoch=485.7] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.283 | L2-Norm(final)=17.035 | 5391.6 samples/s | 84.2 steps/s
[Step=51600 Epoch=486.2] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.279 | L2-Norm(final)=17.036 | 2392.2 samples/s | 37.4 steps/s
[Step=51650 Epoch=486.7] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.276 | L2-Norm(final)=17.036 | 4938.9 samples/s | 77.2 steps/s
[Step=51700 Epoch=487.2] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.272 | L2-Norm(final)=17.036 | 2490.4 samples/s | 38.9 steps/s
[Step=51750 Epoch=487.6] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.268 | L2-Norm(final)=17.037 | 4586.7 samples/s | 71.7 steps/s
[Step=51800 Epoch=488.1] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.264 | L2-Norm(final)=17.037 | 2577.0 samples/s | 40.3 steps/s
[Step=51850 Epoch=488.6] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.260 | L2-Norm(final)=17.037 | 4679.3 samples/s | 73.1 steps/s
[Step=51900 Epoch=489.0] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.256 | L2-Norm(final)=17.038 | 2552.9 samples/s | 39.9 steps/s
[Step=51950 Epoch=489.5] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.252 | L2-Norm(final)=17.038 | 4621.7 samples/s | 72.2 steps/s
[Step=52000 Epoch=490.0] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.248 | L2-Norm(final)=17.038 | 2641.6 samples/s | 41.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step52000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07272 | acc=0.9641 | tpr=0.9724 | fpr=0.0538 | 5582.1 samples/s | 21.8 steps/s
Avg test loss: 0.08117, Avg test acc: 0.96226, Avg tpr: 0.97132, Avg fpr: 0.05768, total FA: 450

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07800 | acc=0.9651 | tpr=0.9741 | fpr=0.0545 | 5351.0 samples/s | 20.9 steps/s
Avg test loss: 0.08673, Avg test acc: 0.96334, Avg tpr: 0.97220, Avg fpr: 0.05615, total FA: 438

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.07799 | acc=0.9645 | tpr=0.9758 | fpr=0.0602 | 5526.9 samples/s | 21.6 steps/s
Avg test loss: 0.08618, Avg test acc: 0.96210, Avg tpr: 0.97296, Avg fpr: 0.06179, total FA: 482

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.07709 | acc=0.9631 | tpr=0.9738 | fpr=0.0600 | 5866.1 samples/s | 22.9 steps/s
Avg test loss: 0.08570, Avg test acc: 0.96274, Avg tpr: 0.97360, Avg fpr: 0.06115, total FA: 477

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.07501 | acc=0.9660 | tpr=0.9743 | fpr=0.0520 | 5680.1 samples/s | 22.2 steps/s
Avg test loss: 0.08638, Avg test acc: 0.96434, Avg tpr: 0.97290, Avg fpr: 0.05448, total FA: 425

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.39701 | acc=0.2666 | tpr=0.0092 | fpr=0.1744 | 5716.0 samples/s | 22.3 steps/s
Avg test loss: 5.40298, Avg test acc: 0.26533, Avg tpr: 0.00956, Avg fpr: 0.17216, total FA: 1343

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.67408 | acc=0.2973 | tpr=0.0160 | fpr=0.0917 | 5647.6 samples/s | 22.1 steps/s
Avg test loss: 4.68322, Avg test acc: 0.29522, Avg tpr: 0.01638, Avg fpr: 0.09153, total FA: 714

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.17447 | acc=0.2499 | tpr=0.0100 | fpr=0.2292 | 5699.2 samples/s | 22.3 steps/s
Avg test loss: 5.17947, Avg test acc: 0.25002, Avg tpr: 0.01072, Avg fpr: 0.22369, total FA: 1745

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.99642 | acc=0.2412 | tpr=0.0079 | fpr=0.2520 | 5466.2 samples/s | 21.4 steps/s
Avg test loss: 6.00469, Avg test acc: 0.23976, Avg tpr: 0.00769, Avg fpr: 0.24984, total FA: 1949

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.54321 | acc=0.2373 | tpr=0.0067 | fpr=0.2621 | 5739.0 samples/s | 22.4 steps/s
Avg test loss: 5.54691, Avg test acc: 0.23724, Avg tpr: 0.00758, Avg fpr: 0.25766, total FA: 2010

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.86909 | acc=0.1552 | tpr=0.2035 | fpr=0.8456 | 5682.3 samples/s | 22.2 steps/s
[Step= 100] | Loss=4.82700 | acc=0.1557 | tpr=0.1898 | fpr=0.8450 | 8149.7 samples/s | 31.8 steps/s
[Step= 150] | Loss=4.84573 | acc=0.1551 | tpr=0.1844 | fpr=0.8454 | 7877.1 samples/s | 30.8 steps/s
[Step= 200] | Loss=4.84044 | acc=0.1552 | tpr=0.1814 | fpr=0.8453 | 8396.0 samples/s | 32.8 steps/s
[Step= 250] | Loss=4.84875 | acc=0.1553 | tpr=0.1808 | fpr=0.8452 | 8158.7 samples/s | 31.9 steps/s
[Step= 300] | Loss=4.85225 | acc=0.1544 | tpr=0.1840 | fpr=0.8461 | 8082.8 samples/s | 31.6 steps/s
[Step= 350] | Loss=4.85472 | acc=0.1543 | tpr=0.1760 | fpr=0.8461 | 8362.7 samples/s | 32.7 steps/s
[Step= 400] | Loss=4.85361 | acc=0.1547 | tpr=0.1778 | fpr=0.8458 | 7748.2 samples/s | 30.3 steps/s
[Step= 450] | Loss=4.85292 | acc=0.1550 | tpr=0.1767 | fpr=0.8454 | 8396.8 samples/s | 32.8 steps/s
[Step= 500] | Loss=4.85567 | acc=0.1548 | tpr=0.1797 | fpr=0.8456 | 8229.5 samples/s | 32.1 steps/s
[Step= 550] | Loss=4.85388 | acc=0.1550 | tpr=0.1783 | fpr=0.8455 | 9348.3 samples/s | 36.5 steps/s
Avg test loss: 4.85355, Avg test acc: 0.15490, Avg tpr: 0.17829, Avg fpr: 0.84552, total FA: 117399

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.96567 | acc=0.1505 | tpr=0.2168 | fpr=0.8507 | 5694.8 samples/s | 22.2 steps/s
[Step= 100] | Loss=4.91911 | acc=0.1524 | tpr=0.2026 | fpr=0.8485 | 7710.2 samples/s | 30.1 steps/s
[Step= 150] | Loss=4.93523 | acc=0.1498 | tpr=0.1974 | fpr=0.8511 | 8307.2 samples/s | 32.5 steps/s
[Step= 200] | Loss=4.93069 | acc=0.1498 | tpr=0.1880 | fpr=0.8509 | 7374.8 samples/s | 28.8 steps/s
[Step= 250] | Loss=4.93828 | acc=0.1499 | tpr=0.1834 | fpr=0.8508 | 8497.1 samples/s | 33.2 steps/s
[Step= 300] | Loss=4.94018 | acc=0.1490 | tpr=0.1862 | fpr=0.8517 | 8581.1 samples/s | 33.5 steps/s
[Step= 350] | Loss=4.94254 | acc=0.1487 | tpr=0.1772 | fpr=0.8518 | 8340.9 samples/s | 32.6 steps/s
[Step= 400] | Loss=4.94200 | acc=0.1492 | tpr=0.1822 | fpr=0.8514 | 7350.8 samples/s | 28.7 steps/s
[Step= 450] | Loss=4.94078 | acc=0.1496 | tpr=0.1821 | fpr=0.8510 | 8676.2 samples/s | 33.9 steps/s
[Step= 500] | Loss=4.94437 | acc=0.1494 | tpr=0.1837 | fpr=0.8512 | 7846.3 samples/s | 30.6 steps/s
[Step= 550] | Loss=4.94215 | acc=0.1497 | tpr=0.1823 | fpr=0.8509 | 10242.1 samples/s | 40.0 steps/s
Avg test loss: 4.94225, Avg test acc: 0.14962, Avg tpr: 0.18225, Avg fpr: 0.85097, total FA: 118156

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.33780 | acc=0.1386 | tpr=0.1416 | fpr=0.8615 | 5884.2 samples/s | 23.0 steps/s
[Step= 100] | Loss=5.29421 | acc=0.1409 | tpr=0.1301 | fpr=0.8589 | 7523.6 samples/s | 29.4 steps/s
[Step= 150] | Loss=5.30466 | acc=0.1400 | tpr=0.1311 | fpr=0.8598 | 7954.2 samples/s | 31.1 steps/s
[Step= 200] | Loss=5.29768 | acc=0.1404 | tpr=0.1279 | fpr=0.8593 | 7439.5 samples/s | 29.1 steps/s
[Step= 250] | Loss=5.30251 | acc=0.1403 | tpr=0.1266 | fpr=0.8595 | 8063.2 samples/s | 31.5 steps/s
[Step= 300] | Loss=5.30771 | acc=0.1398 | tpr=0.1258 | fpr=0.8599 | 8307.2 samples/s | 32.4 steps/s
[Step= 350] | Loss=5.31167 | acc=0.1391 | tpr=0.1215 | fpr=0.8606 | 7963.3 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.31050 | acc=0.1396 | tpr=0.1286 | fpr=0.8602 | 8151.9 samples/s | 31.8 steps/s
[Step= 450] | Loss=5.30915 | acc=0.1398 | tpr=0.1280 | fpr=0.8600 | 8457.0 samples/s | 33.0 steps/s
[Step= 500] | Loss=5.31120 | acc=0.1398 | tpr=0.1308 | fpr=0.8601 | 8160.9 samples/s | 31.9 steps/s
[Step= 550] | Loss=5.30797 | acc=0.1402 | tpr=0.1321 | fpr=0.8597 | 10752.2 samples/s | 42.0 steps/s
Avg test loss: 5.30782, Avg test acc: 0.14008, Avg tpr: 0.13233, Avg fpr: 0.85978, total FA: 119379

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.98288 | acc=0.1497 | tpr=0.1903 | fpr=0.8510 | 5732.6 samples/s | 22.4 steps/s
[Step= 100] | Loss=4.94041 | acc=0.1513 | tpr=0.1919 | fpr=0.8495 | 8065.3 samples/s | 31.5 steps/s
[Step= 150] | Loss=4.95769 | acc=0.1498 | tpr=0.1888 | fpr=0.8509 | 7647.6 samples/s | 29.9 steps/s
[Step= 200] | Loss=4.95000 | acc=0.1501 | tpr=0.1825 | fpr=0.8505 | 8260.8 samples/s | 32.3 steps/s
[Step= 250] | Loss=4.95641 | acc=0.1504 | tpr=0.1825 | fpr=0.8502 | 8190.9 samples/s | 32.0 steps/s
[Step= 300] | Loss=4.96139 | acc=0.1494 | tpr=0.1855 | fpr=0.8512 | 7964.9 samples/s | 31.1 steps/s
[Step= 350] | Loss=4.96316 | acc=0.1487 | tpr=0.1772 | fpr=0.8518 | 7687.1 samples/s | 30.0 steps/s
[Step= 400] | Loss=4.96220 | acc=0.1490 | tpr=0.1844 | fpr=0.8516 | 8715.0 samples/s | 34.0 steps/s
[Step= 450] | Loss=4.96105 | acc=0.1493 | tpr=0.1826 | fpr=0.8513 | 8149.4 samples/s | 31.8 steps/s
[Step= 500] | Loss=4.96427 | acc=0.1491 | tpr=0.1837 | fpr=0.8515 | 8027.4 samples/s | 31.4 steps/s
[Step= 550] | Loss=4.96154 | acc=0.1493 | tpr=0.1838 | fpr=0.8513 | 10356.8 samples/s | 40.5 steps/s
Avg test loss: 4.96128, Avg test acc: 0.14922, Avg tpr: 0.18384, Avg fpr: 0.85141, total FA: 118217

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.33050 | acc=0.1490 | tpr=0.1416 | fpr=0.8509 | 5663.3 samples/s | 22.1 steps/s
[Step= 100] | Loss=5.28129 | acc=0.1512 | tpr=0.1343 | fpr=0.8484 | 7792.0 samples/s | 30.4 steps/s
[Step= 150] | Loss=5.29942 | acc=0.1501 | tpr=0.1254 | fpr=0.8494 | 8263.1 samples/s | 32.3 steps/s
[Step= 200] | Loss=5.29644 | acc=0.1500 | tpr=0.1224 | fpr=0.8495 | 8002.4 samples/s | 31.3 steps/s
[Step= 250] | Loss=5.30344 | acc=0.1499 | tpr=0.1231 | fpr=0.8496 | 7946.0 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.30622 | acc=0.1495 | tpr=0.1244 | fpr=0.8500 | 8123.3 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.30966 | acc=0.1491 | tpr=0.1209 | fpr=0.8504 | 7847.9 samples/s | 30.7 steps/s
[Step= 400] | Loss=5.30859 | acc=0.1492 | tpr=0.1220 | fpr=0.8503 | 8582.9 samples/s | 33.5 steps/s
[Step= 450] | Loss=5.30759 | acc=0.1495 | tpr=0.1232 | fpr=0.8500 | 8012.1 samples/s | 31.3 steps/s
[Step= 500] | Loss=5.31113 | acc=0.1492 | tpr=0.1247 | fpr=0.8503 | 8118.5 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.30775 | acc=0.1493 | tpr=0.1242 | fpr=0.8502 | 10335.4 samples/s | 40.4 steps/s
Avg test loss: 5.30749, Avg test acc: 0.14920, Avg tpr: 0.12401, Avg fpr: 0.85035, total FA: 118069

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11219 | acc=0.9801 | tpr=0.9292 | fpr=0.0190 | 5582.6 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.11333 | acc=0.9804 | tpr=0.9488 | fpr=0.0190 | 8393.4 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.11721 | acc=0.9796 | tpr=0.9524 | fpr=0.0199 | 7763.3 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.11923 | acc=0.9796 | tpr=0.9563 | fpr=0.0199 | 8595.8 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.11999 | acc=0.9795 | tpr=0.9528 | fpr=0.0200 | 7451.4 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.12149 | acc=0.9795 | tpr=0.9535 | fpr=0.0200 | 8083.4 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.12158 | acc=0.9795 | tpr=0.9555 | fpr=0.0201 | 8326.1 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.12264 | acc=0.9792 | tpr=0.9513 | fpr=0.0203 | 8087.7 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.12500 | acc=0.9789 | tpr=0.9489 | fpr=0.0206 | 8541.1 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.12400 | acc=0.9790 | tpr=0.9511 | fpr=0.0205 | 7947.2 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.12307 | acc=0.9790 | tpr=0.9511 | fpr=0.0204 | 9844.3 samples/s | 38.5 steps/s
Avg test loss: 0.12282, Avg test acc: 0.97908, Avg tpr: 0.95087, Avg fpr: 0.02041, total FA: 2834

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10460 | acc=0.9804 | tpr=0.9071 | fpr=0.0183 | 5832.1 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.10599 | acc=0.9802 | tpr=0.9254 | fpr=0.0188 | 7422.3 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.10924 | acc=0.9795 | tpr=0.9337 | fpr=0.0197 | 8044.8 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.11051 | acc=0.9795 | tpr=0.9366 | fpr=0.0198 | 7572.6 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.11147 | acc=0.9794 | tpr=0.9345 | fpr=0.0198 | 8084.0 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.11309 | acc=0.9792 | tpr=0.9353 | fpr=0.0200 | 8297.3 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.11298 | acc=0.9791 | tpr=0.9368 | fpr=0.0201 | 7847.0 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.11391 | acc=0.9789 | tpr=0.9322 | fpr=0.0202 | 7994.3 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.11573 | acc=0.9787 | tpr=0.9309 | fpr=0.0204 | 8358.7 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.11493 | acc=0.9788 | tpr=0.9330 | fpr=0.0204 | 8090.3 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.11385 | acc=0.9790 | tpr=0.9320 | fpr=0.0201 | 11090.6 samples/s | 43.3 steps/s
Avg test loss: 0.11364, Avg test acc: 0.97903, Avg tpr: 0.93146, Avg fpr: 0.02010, total FA: 2791

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10457 | acc=0.9791 | tpr=0.9381 | fpr=0.0201 | 5574.4 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.10600 | acc=0.9792 | tpr=0.9552 | fpr=0.0203 | 7809.1 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.10953 | acc=0.9787 | tpr=0.9582 | fpr=0.0209 | 8597.5 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.11148 | acc=0.9788 | tpr=0.9607 | fpr=0.0209 | 8245.1 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.11285 | acc=0.9788 | tpr=0.9590 | fpr=0.0209 | 7500.4 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.11391 | acc=0.9788 | tpr=0.9593 | fpr=0.0208 | 7760.4 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.11393 | acc=0.9788 | tpr=0.9593 | fpr=0.0208 | 8536.4 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.11475 | acc=0.9786 | tpr=0.9568 | fpr=0.0210 | 8286.1 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.11668 | acc=0.9783 | tpr=0.9542 | fpr=0.0213 | 8127.6 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.11586 | acc=0.9785 | tpr=0.9555 | fpr=0.0211 | 7470.8 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.11478 | acc=0.9786 | tpr=0.9550 | fpr=0.0210 | 10718.4 samples/s | 41.9 steps/s
Avg test loss: 0.11455, Avg test acc: 0.97862, Avg tpr: 0.95483, Avg fpr: 0.02094, total FA: 2908

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09700 | acc=0.9819 | tpr=0.9248 | fpr=0.0171 | 5535.1 samples/s | 21.6 steps/s
[Step= 100] | Loss=0.09900 | acc=0.9816 | tpr=0.9360 | fpr=0.0175 | 8175.7 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.10153 | acc=0.9812 | tpr=0.9452 | fpr=0.0181 | 8202.8 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.10269 | acc=0.9813 | tpr=0.9497 | fpr=0.0181 | 8573.6 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.10369 | acc=0.9812 | tpr=0.9459 | fpr=0.0181 | 7912.9 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.10451 | acc=0.9812 | tpr=0.9455 | fpr=0.0182 | 8078.9 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.10433 | acc=0.9813 | tpr=0.9499 | fpr=0.0182 | 7977.2 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.10508 | acc=0.9812 | tpr=0.9458 | fpr=0.0181 | 7828.1 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.10706 | acc=0.9809 | tpr=0.9445 | fpr=0.0185 | 7761.4 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.10613 | acc=0.9810 | tpr=0.9463 | fpr=0.0184 | 8691.0 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.10546 | acc=0.9810 | tpr=0.9435 | fpr=0.0183 | 9786.7 samples/s | 38.2 steps/s
Avg test loss: 0.10526, Avg test acc: 0.98106, Avg tpr: 0.94334, Avg fpr: 0.01825, total FA: 2534

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.11064 | acc=0.9807 | tpr=0.9248 | fpr=0.0183 | 5661.5 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.11310 | acc=0.9802 | tpr=0.9360 | fpr=0.0189 | 7867.5 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.11691 | acc=0.9797 | tpr=0.9424 | fpr=0.0196 | 8352.7 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.11845 | acc=0.9797 | tpr=0.9464 | fpr=0.0196 | 8052.0 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.11960 | acc=0.9797 | tpr=0.9432 | fpr=0.0196 | 7516.6 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.12083 | acc=0.9798 | tpr=0.9425 | fpr=0.0195 | 7720.6 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.12063 | acc=0.9799 | tpr=0.9449 | fpr=0.0195 | 8361.5 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.12150 | acc=0.9797 | tpr=0.9420 | fpr=0.0196 | 8143.1 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.12375 | acc=0.9794 | tpr=0.9416 | fpr=0.0199 | 7958.2 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.12277 | acc=0.9795 | tpr=0.9441 | fpr=0.0198 | 8446.4 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.12185 | acc=0.9796 | tpr=0.9419 | fpr=0.0197 | 10602.0 samples/s | 41.4 steps/s
Avg test loss: 0.12162, Avg test acc: 0.97961, Avg tpr: 0.94176, Avg fpr: 0.01971, total FA: 2736

server round 49/50

clients selected: [1 2 3 6 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=60001 Epoch=292.8] | Loss=0.02910 | Reg=0.00086 | acc=0.9531 | L2-Norm=9.299 | L2-Norm(final)=16.246 | 6309.9 samples/s | 98.6 steps/s
[Step=60050 Epoch=293.0] | Loss=0.01361 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.299 | L2-Norm(final)=16.249 | 4844.6 samples/s | 75.7 steps/s
[Step=60100 Epoch=293.3] | Loss=0.01481 | Reg=0.00086 | acc=0.9531 | L2-Norm=9.299 | L2-Norm(final)=16.251 | 5712.4 samples/s | 89.3 steps/s
[Step=60150 Epoch=293.5] | Loss=0.01472 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=16.252 | 5529.7 samples/s | 86.4 steps/s
[Step=60200 Epoch=293.7] | Loss=0.01415 | Reg=0.00086 | acc=0.9688 | L2-Norm=9.299 | L2-Norm(final)=16.253 | 8831.0 samples/s | 138.0 steps/s
[Step=60250 Epoch=294.0] | Loss=0.01381 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=16.255 | 2444.6 samples/s | 38.2 steps/s
[Step=60300 Epoch=294.2] | Loss=0.01422 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.299 | L2-Norm(final)=16.257 | 5636.0 samples/s | 88.1 steps/s
[Step=60350 Epoch=294.5] | Loss=0.01436 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=16.258 | 5739.9 samples/s | 89.7 steps/s
[Step=60400 Epoch=294.7] | Loss=0.01410 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=16.260 | 7594.0 samples/s | 118.7 steps/s
[Step=60450 Epoch=295.0] | Loss=0.01426 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.299 | L2-Norm(final)=16.261 | 2485.6 samples/s | 38.8 steps/s
[Step=60500 Epoch=295.2] | Loss=0.01405 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=16.262 | 5649.1 samples/s | 88.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_1/client_state-step60500.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=54001 Epoch=263.1] | Loss=0.03079 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.299 | L2-Norm(final)=15.504 | 5205.8 samples/s | 81.3 steps/s
[Step=54050 Epoch=263.4] | Loss=0.01537 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.299 | L2-Norm(final)=15.506 | 5450.3 samples/s | 85.2 steps/s
[Step=54100 Epoch=263.6] | Loss=0.01658 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=15.508 | 5724.9 samples/s | 89.5 steps/s
[Step=54150 Epoch=263.8] | Loss=0.01676 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=15.511 | 5597.2 samples/s | 87.5 steps/s
[Step=54200 Epoch=264.1] | Loss=0.01649 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.299 | L2-Norm(final)=15.513 | 8570.3 samples/s | 133.9 steps/s
[Step=54250 Epoch=264.3] | Loss=0.01675 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=15.515 | 2438.5 samples/s | 38.1 steps/s
[Step=54300 Epoch=264.6] | Loss=0.01635 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=15.517 | 5762.7 samples/s | 90.0 steps/s
[Step=54350 Epoch=264.8] | Loss=0.01653 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=15.519 | 5621.3 samples/s | 87.8 steps/s
[Step=54400 Epoch=265.1] | Loss=0.01614 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.299 | L2-Norm(final)=15.521 | 7559.3 samples/s | 118.1 steps/s
[Step=54450 Epoch=265.3] | Loss=0.01607 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=15.523 | 2529.9 samples/s | 39.5 steps/s
[Step=54500 Epoch=265.6] | Loss=0.01619 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=15.525 | 5982.8 samples/s | 93.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_2/client_state-step54500.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=60001 Epoch=292.6] | Loss=0.03859 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.299 | L2-Norm(final)=16.127 | 6242.0 samples/s | 97.5 steps/s
[Step=60050 Epoch=292.8] | Loss=0.01762 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=16.127 | 4758.3 samples/s | 74.3 steps/s
[Step=60100 Epoch=293.1] | Loss=0.01529 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.299 | L2-Norm(final)=16.129 | 5460.1 samples/s | 85.3 steps/s
[Step=60150 Epoch=293.3] | Loss=0.01460 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.299 | L2-Norm(final)=16.132 | 5622.2 samples/s | 87.8 steps/s
[Step=60200 Epoch=293.6] | Loss=0.01404 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=16.134 | 8811.8 samples/s | 137.7 steps/s
[Step=60250 Epoch=293.8] | Loss=0.01417 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=16.136 | 2434.3 samples/s | 38.0 steps/s
[Step=60300 Epoch=294.1] | Loss=0.01398 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=16.138 | 5726.0 samples/s | 89.5 steps/s
[Step=60350 Epoch=294.3] | Loss=0.01410 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=16.139 | 5553.3 samples/s | 86.8 steps/s
[Step=60400 Epoch=294.5] | Loss=0.01397 | Reg=0.00086 | acc=0.9688 | L2-Norm=9.299 | L2-Norm(final)=16.141 | 7644.1 samples/s | 119.4 steps/s
[Step=60450 Epoch=294.8] | Loss=0.01383 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=16.143 | 2517.8 samples/s | 39.3 steps/s
[Step=60500 Epoch=295.0] | Loss=0.01395 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=16.144 | 5477.7 samples/s | 85.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_asml1_3/client_state-step60500.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=42001 Epoch=399.5] | Loss=0.00004 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=16.521 | 5545.8 samples/s | 86.7 steps/s
[Step=42050 Epoch=400.0] | Loss=0.00033 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.296 | L2-Norm(final)=16.530 | 4690.9 samples/s | 73.3 steps/s
[Step=42100 Epoch=400.5] | Loss=0.00030 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=16.542 | 8043.4 samples/s | 125.7 steps/s
[Step=42150 Epoch=401.0] | Loss=0.00030 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=16.553 | 2349.9 samples/s | 36.7 steps/s
[Step=42200 Epoch=401.4] | Loss=0.00031 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=16.563 | 7266.1 samples/s | 113.5 steps/s
[Step=42250 Epoch=401.9] | Loss=0.00030 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=16.573 | 2439.6 samples/s | 38.1 steps/s
[Step=42300 Epoch=402.4] | Loss=0.00030 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=16.583 | 6643.7 samples/s | 103.8 steps/s
[Step=42350 Epoch=402.9] | Loss=0.00030 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=16.593 | 2502.4 samples/s | 39.1 steps/s
[Step=42400 Epoch=403.3] | Loss=0.00030 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=16.602 | 6076.3 samples/s | 94.9 steps/s
[Step=42450 Epoch=403.8] | Loss=0.00030 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=16.611 | 2636.7 samples/s | 41.2 steps/s
[Step=42500 Epoch=404.3] | Loss=0.00030 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=16.620 | 5617.0 samples/s | 87.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_1/client_state-step42500.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=52001 Epoch=490.0] | Loss=0.00035 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=17.048 | 6316.1 samples/s | 98.7 steps/s
[Step=52050 Epoch=490.5] | Loss=0.00022 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.297 | L2-Norm(final)=17.053 | 4301.9 samples/s | 67.2 steps/s
[Step=52100 Epoch=490.9] | Loss=0.00020 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.297 | L2-Norm(final)=17.058 | 8233.7 samples/s | 128.7 steps/s
[Step=52150 Epoch=491.4] | Loss=0.00019 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.297 | L2-Norm(final)=17.062 | 2342.1 samples/s | 36.6 steps/s
[Step=52200 Epoch=491.9] | Loss=0.00020 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.297 | L2-Norm(final)=17.068 | 7191.8 samples/s | 112.4 steps/s
[Step=52250 Epoch=492.3] | Loss=0.00020 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.297 | L2-Norm(final)=17.073 | 2478.2 samples/s | 38.7 steps/s
[Step=52300 Epoch=492.8] | Loss=0.00020 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.297 | L2-Norm(final)=17.078 | 6106.4 samples/s | 95.4 steps/s
[Step=52350 Epoch=493.3] | Loss=0.00020 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.297 | L2-Norm(final)=17.083 | 2594.4 samples/s | 40.5 steps/s
[Step=52400 Epoch=493.8] | Loss=0.00019 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.297 | L2-Norm(final)=17.087 | 5715.3 samples/s | 89.3 steps/s
[Step=52450 Epoch=494.2] | Loss=0.00019 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.297 | L2-Norm(final)=17.092 | 2741.3 samples/s | 42.8 steps/s
[Step=52500 Epoch=494.7] | Loss=0.00019 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.297 | L2-Norm(final)=17.097 | 5162.6 samples/s | 80.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch20/client_iccad2012_3/client_state-step52500.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07272 | acc=0.9641 | tpr=0.9724 | fpr=0.0538 | 5656.8 samples/s | 22.1 steps/s
Avg test loss: 0.08117, Avg test acc: 0.96226, Avg tpr: 0.97132, Avg fpr: 0.05768, total FA: 450

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06241 | acc=0.9645 | tpr=0.9739 | fpr=0.0560 | 5634.4 samples/s | 22.0 steps/s
Avg test loss: 0.07014, Avg test acc: 0.96326, Avg tpr: 0.97220, Avg fpr: 0.05640, total FA: 440

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.06194 | acc=0.9653 | tpr=0.9755 | fpr=0.0567 | 5919.6 samples/s | 23.1 steps/s
Avg test loss: 0.06979, Avg test acc: 0.96394, Avg tpr: 0.97412, Avg fpr: 0.05845, total FA: 456

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.06189 | acc=0.9647 | tpr=0.9736 | fpr=0.0548 | 5557.9 samples/s | 21.7 steps/s
Avg test loss: 0.06963, Avg test acc: 0.96322, Avg tpr: 0.97191, Avg fpr: 0.05589, total FA: 436

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.07501 | acc=0.9660 | tpr=0.9743 | fpr=0.0520 | 5483.8 samples/s | 21.4 steps/s
Avg test loss: 0.08638, Avg test acc: 0.96434, Avg tpr: 0.97290, Avg fpr: 0.05448, total FA: 425

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.39701 | acc=0.2666 | tpr=0.0092 | fpr=0.1744 | 5623.0 samples/s | 22.0 steps/s
Avg test loss: 5.40298, Avg test acc: 0.26533, Avg tpr: 0.00956, Avg fpr: 0.17216, total FA: 1343

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=2.80908 | acc=0.3091 | tpr=0.0288 | fpr=0.0820 | 5774.5 samples/s | 22.6 steps/s
Avg test loss: 2.81652, Avg test acc: 0.30716, Avg tpr: 0.02978, Avg fpr: 0.08281, total FA: 646

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.17447 | acc=0.2499 | tpr=0.0100 | fpr=0.2292 | 5680.8 samples/s | 22.2 steps/s
Avg test loss: 5.17947, Avg test acc: 0.25002, Avg tpr: 0.01072, Avg fpr: 0.22369, total FA: 1745

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.38004 | acc=0.1904 | tpr=0.0126 | fpr=0.4234 | 5564.9 samples/s | 21.7 steps/s
Avg test loss: 5.38066, Avg test acc: 0.19168, Avg tpr: 0.01376, Avg fpr: 0.41700, total FA: 3253

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.54321 | acc=0.2373 | tpr=0.0067 | fpr=0.2621 | 5727.4 samples/s | 22.4 steps/s
Avg test loss: 5.54691, Avg test acc: 0.23724, Avg tpr: 0.00758, Avg fpr: 0.25766, total FA: 2010

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.86909 | acc=0.1552 | tpr=0.2035 | fpr=0.8456 | 5670.7 samples/s | 22.2 steps/s
[Step= 100] | Loss=4.82700 | acc=0.1557 | tpr=0.1898 | fpr=0.8450 | 8070.4 samples/s | 31.5 steps/s
[Step= 150] | Loss=4.84573 | acc=0.1551 | tpr=0.1844 | fpr=0.8454 | 7403.6 samples/s | 28.9 steps/s
[Step= 200] | Loss=4.84044 | acc=0.1552 | tpr=0.1814 | fpr=0.8453 | 8497.4 samples/s | 33.2 steps/s
[Step= 250] | Loss=4.84875 | acc=0.1553 | tpr=0.1808 | fpr=0.8452 | 7876.5 samples/s | 30.8 steps/s
[Step= 300] | Loss=4.85225 | acc=0.1544 | tpr=0.1840 | fpr=0.8461 | 8328.6 samples/s | 32.5 steps/s
[Step= 350] | Loss=4.85472 | acc=0.1543 | tpr=0.1760 | fpr=0.8461 | 8648.4 samples/s | 33.8 steps/s
[Step= 400] | Loss=4.85361 | acc=0.1547 | tpr=0.1778 | fpr=0.8458 | 8277.5 samples/s | 32.3 steps/s
[Step= 450] | Loss=4.85292 | acc=0.1550 | tpr=0.1767 | fpr=0.8454 | 7337.9 samples/s | 28.7 steps/s
[Step= 500] | Loss=4.85567 | acc=0.1548 | tpr=0.1797 | fpr=0.8456 | 8547.4 samples/s | 33.4 steps/s
[Step= 550] | Loss=4.85388 | acc=0.1550 | tpr=0.1783 | fpr=0.8455 | 9882.7 samples/s | 38.6 steps/s
Avg test loss: 4.85355, Avg test acc: 0.15490, Avg tpr: 0.17829, Avg fpr: 0.84552, total FA: 117399

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.97694 | acc=0.1649 | tpr=0.2345 | fpr=0.8363 | 5339.1 samples/s | 20.9 steps/s
[Step= 100] | Loss=3.94047 | acc=0.1673 | tpr=0.2196 | fpr=0.8337 | 8848.4 samples/s | 34.6 steps/s
[Step= 150] | Loss=3.95611 | acc=0.1655 | tpr=0.2118 | fpr=0.8353 | 7801.3 samples/s | 30.5 steps/s
[Step= 200] | Loss=3.95210 | acc=0.1657 | tpr=0.2066 | fpr=0.8350 | 8226.8 samples/s | 32.1 steps/s
[Step= 250] | Loss=3.95862 | acc=0.1660 | tpr=0.2070 | fpr=0.8348 | 8088.6 samples/s | 31.6 steps/s
[Step= 300] | Loss=3.96100 | acc=0.1651 | tpr=0.2051 | fpr=0.8357 | 8161.9 samples/s | 31.9 steps/s
[Step= 350] | Loss=3.96320 | acc=0.1650 | tpr=0.1960 | fpr=0.8356 | 7828.0 samples/s | 30.6 steps/s
[Step= 400] | Loss=3.96288 | acc=0.1653 | tpr=0.2013 | fpr=0.8353 | 7739.0 samples/s | 30.2 steps/s
[Step= 450] | Loss=3.96259 | acc=0.1656 | tpr=0.1986 | fpr=0.8350 | 8424.5 samples/s | 32.9 steps/s
[Step= 500] | Loss=3.96588 | acc=0.1653 | tpr=0.2018 | fpr=0.8354 | 8242.6 samples/s | 32.2 steps/s
[Step= 550] | Loss=3.96362 | acc=0.1657 | tpr=0.2014 | fpr=0.8350 | 10049.9 samples/s | 39.3 steps/s
Avg test loss: 3.96339, Avg test acc: 0.16556, Avg tpr: 0.20166, Avg fpr: 0.83509, total FA: 115951

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.07741 | acc=0.1502 | tpr=0.1106 | fpr=0.8491 | 5702.4 samples/s | 22.3 steps/s
[Step= 100] | Loss=4.04298 | acc=0.1527 | tpr=0.1002 | fpr=0.8463 | 8202.5 samples/s | 32.0 steps/s
[Step= 150] | Loss=4.05586 | acc=0.1515 | tpr=0.0965 | fpr=0.8475 | 8145.0 samples/s | 31.8 steps/s
[Step= 200] | Loss=4.05222 | acc=0.1516 | tpr=0.0918 | fpr=0.8473 | 8031.8 samples/s | 31.4 steps/s
[Step= 250] | Loss=4.05833 | acc=0.1517 | tpr=0.0926 | fpr=0.8472 | 7942.8 samples/s | 31.0 steps/s
[Step= 300] | Loss=4.06067 | acc=0.1508 | tpr=0.0945 | fpr=0.8481 | 8132.6 samples/s | 31.8 steps/s
[Step= 350] | Loss=4.06308 | acc=0.1508 | tpr=0.0908 | fpr=0.8481 | 8071.7 samples/s | 31.5 steps/s
[Step= 400] | Loss=4.06235 | acc=0.1512 | tpr=0.0941 | fpr=0.8477 | 8063.9 samples/s | 31.5 steps/s
[Step= 450] | Loss=4.06179 | acc=0.1517 | tpr=0.0949 | fpr=0.8473 | 7992.4 samples/s | 31.2 steps/s
[Step= 500] | Loss=4.06455 | acc=0.1514 | tpr=0.0956 | fpr=0.8476 | 7766.3 samples/s | 30.3 steps/s
[Step= 550] | Loss=4.06268 | acc=0.1519 | tpr=0.0971 | fpr=0.8471 | 10454.2 samples/s | 40.8 steps/s
Avg test loss: 4.06238, Avg test acc: 0.15185, Avg tpr: 0.09746, Avg fpr: 0.84716, total FA: 117627

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.13801 | acc=0.1587 | tpr=0.1903 | fpr=0.8419 | 5776.0 samples/s | 22.6 steps/s
[Step= 100] | Loss=4.10069 | acc=0.1613 | tpr=0.1791 | fpr=0.8390 | 8211.0 samples/s | 32.1 steps/s
[Step= 150] | Loss=4.11631 | acc=0.1604 | tpr=0.1729 | fpr=0.8399 | 7401.2 samples/s | 28.9 steps/s
[Step= 200] | Loss=4.11212 | acc=0.1607 | tpr=0.1705 | fpr=0.8394 | 8063.1 samples/s | 31.5 steps/s
[Step= 250] | Loss=4.11894 | acc=0.1609 | tpr=0.1703 | fpr=0.8393 | 8128.7 samples/s | 31.8 steps/s
[Step= 300] | Loss=4.12158 | acc=0.1602 | tpr=0.1724 | fpr=0.8401 | 7445.3 samples/s | 29.1 steps/s
[Step= 350] | Loss=4.12385 | acc=0.1602 | tpr=0.1653 | fpr=0.8399 | 8670.1 samples/s | 33.9 steps/s
[Step= 400] | Loss=4.12330 | acc=0.1604 | tpr=0.1690 | fpr=0.8397 | 8235.1 samples/s | 32.2 steps/s
[Step= 450] | Loss=4.12297 | acc=0.1607 | tpr=0.1685 | fpr=0.8394 | 8130.4 samples/s | 31.8 steps/s
[Step= 500] | Loss=4.12623 | acc=0.1605 | tpr=0.1714 | fpr=0.8396 | 8124.1 samples/s | 31.7 steps/s
[Step= 550] | Loss=4.12393 | acc=0.1610 | tpr=0.1711 | fpr=0.8392 | 10040.7 samples/s | 39.2 steps/s
Avg test loss: 4.12367, Avg test acc: 0.16089, Avg tpr: 0.17116, Avg fpr: 0.83929, total FA: 116534

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.33050 | acc=0.1490 | tpr=0.1416 | fpr=0.8509 | 5758.0 samples/s | 22.5 steps/s
[Step= 100] | Loss=5.28129 | acc=0.1512 | tpr=0.1343 | fpr=0.8484 | 8235.1 samples/s | 32.2 steps/s
[Step= 150] | Loss=5.29942 | acc=0.1501 | tpr=0.1254 | fpr=0.8494 | 7907.3 samples/s | 30.9 steps/s
[Step= 200] | Loss=5.29644 | acc=0.1500 | tpr=0.1224 | fpr=0.8495 | 7682.9 samples/s | 30.0 steps/s
[Step= 250] | Loss=5.30344 | acc=0.1499 | tpr=0.1231 | fpr=0.8496 | 8006.2 samples/s | 31.3 steps/s
[Step= 300] | Loss=5.30622 | acc=0.1495 | tpr=0.1244 | fpr=0.8500 | 8179.6 samples/s | 32.0 steps/s
[Step= 350] | Loss=5.30966 | acc=0.1491 | tpr=0.1209 | fpr=0.8504 | 7145.8 samples/s | 27.9 steps/s
[Step= 400] | Loss=5.30859 | acc=0.1492 | tpr=0.1220 | fpr=0.8503 | 8619.5 samples/s | 33.7 steps/s
[Step= 450] | Loss=5.30759 | acc=0.1495 | tpr=0.1232 | fpr=0.8500 | 8544.9 samples/s | 33.4 steps/s
[Step= 500] | Loss=5.31113 | acc=0.1492 | tpr=0.1247 | fpr=0.8503 | 8215.2 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.30775 | acc=0.1493 | tpr=0.1242 | fpr=0.8502 | 10394.1 samples/s | 40.6 steps/s
Avg test loss: 5.30749, Avg test acc: 0.14920, Avg tpr: 0.12401, Avg fpr: 0.85035, total FA: 118069

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11219 | acc=0.9801 | tpr=0.9292 | fpr=0.0190 | 5625.1 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.11333 | acc=0.9804 | tpr=0.9488 | fpr=0.0190 | 7889.0 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.11721 | acc=0.9796 | tpr=0.9524 | fpr=0.0199 | 8335.8 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.11923 | acc=0.9796 | tpr=0.9563 | fpr=0.0199 | 7721.6 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.11999 | acc=0.9795 | tpr=0.9528 | fpr=0.0200 | 7906.8 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.12149 | acc=0.9795 | tpr=0.9535 | fpr=0.0200 | 8168.6 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.12158 | acc=0.9795 | tpr=0.9555 | fpr=0.0201 | 7957.2 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.12264 | acc=0.9792 | tpr=0.9513 | fpr=0.0203 | 8569.7 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.12500 | acc=0.9789 | tpr=0.9489 | fpr=0.0206 | 7760.9 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.12400 | acc=0.9790 | tpr=0.9511 | fpr=0.0205 | 8288.0 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.12307 | acc=0.9790 | tpr=0.9511 | fpr=0.0204 | 10750.2 samples/s | 42.0 steps/s
Avg test loss: 0.12282, Avg test acc: 0.97908, Avg tpr: 0.95087, Avg fpr: 0.02041, total FA: 2834

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08929 | acc=0.9766 | tpr=0.9336 | fpr=0.0226 | 5853.4 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.08936 | acc=0.9766 | tpr=0.9446 | fpr=0.0228 | 7946.6 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.09281 | acc=0.9758 | tpr=0.9452 | fpr=0.0237 | 8083.6 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.09364 | acc=0.9757 | tpr=0.9497 | fpr=0.0238 | 7188.6 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.09411 | acc=0.9757 | tpr=0.9467 | fpr=0.0238 | 8266.6 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.09539 | acc=0.9754 | tpr=0.9476 | fpr=0.0241 | 8094.4 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.09536 | acc=0.9755 | tpr=0.9493 | fpr=0.0240 | 8107.4 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.09609 | acc=0.9754 | tpr=0.9453 | fpr=0.0241 | 7907.9 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.09755 | acc=0.9751 | tpr=0.9445 | fpr=0.0243 | 8196.6 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.09698 | acc=0.9752 | tpr=0.9458 | fpr=0.0242 | 7982.9 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.09601 | acc=0.9755 | tpr=0.9447 | fpr=0.0239 | 11299.9 samples/s | 44.1 steps/s
Avg test loss: 0.09587, Avg test acc: 0.97550, Avg tpr: 0.94414, Avg fpr: 0.02393, total FA: 3323

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10457 | acc=0.9791 | tpr=0.9381 | fpr=0.0201 | 5811.4 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.10600 | acc=0.9792 | tpr=0.9552 | fpr=0.0203 | 7766.0 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.10953 | acc=0.9787 | tpr=0.9582 | fpr=0.0209 | 8245.8 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.11148 | acc=0.9788 | tpr=0.9607 | fpr=0.0209 | 7973.2 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.11285 | acc=0.9788 | tpr=0.9590 | fpr=0.0209 | 7288.7 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.11391 | acc=0.9788 | tpr=0.9593 | fpr=0.0208 | 8463.4 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.11393 | acc=0.9788 | tpr=0.9593 | fpr=0.0208 | 8381.7 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.11475 | acc=0.9786 | tpr=0.9568 | fpr=0.0210 | 8070.9 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.11668 | acc=0.9783 | tpr=0.9542 | fpr=0.0213 | 7859.6 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.11586 | acc=0.9785 | tpr=0.9555 | fpr=0.0211 | 7317.9 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.11478 | acc=0.9786 | tpr=0.9550 | fpr=0.0210 | 12500.0 samples/s | 48.8 steps/s
Avg test loss: 0.11455, Avg test acc: 0.97862, Avg tpr: 0.95483, Avg fpr: 0.02094, total FA: 2908

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.12291 | acc=0.9741 | tpr=0.9425 | fpr=0.0254 | 5421.7 samples/s | 21.2 steps/s
[Step= 100] | Loss=0.12401 | acc=0.9746 | tpr=0.9616 | fpr=0.0251 | 9054.4 samples/s | 35.4 steps/s
[Step= 150] | Loss=0.12696 | acc=0.9743 | tpr=0.9654 | fpr=0.0255 | 7798.2 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.12864 | acc=0.9745 | tpr=0.9672 | fpr=0.0254 | 7646.4 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.12997 | acc=0.9743 | tpr=0.9651 | fpr=0.0256 | 8147.4 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.13103 | acc=0.9742 | tpr=0.9644 | fpr=0.0256 | 8652.7 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.13094 | acc=0.9743 | tpr=0.9662 | fpr=0.0256 | 8045.7 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.13192 | acc=0.9741 | tpr=0.9617 | fpr=0.0257 | 7858.1 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.13410 | acc=0.9740 | tpr=0.9606 | fpr=0.0258 | 8165.0 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.13302 | acc=0.9741 | tpr=0.9612 | fpr=0.0256 | 8449.4 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.13200 | acc=0.9743 | tpr=0.9602 | fpr=0.0254 | 9737.4 samples/s | 38.0 steps/s
Avg test loss: 0.13173, Avg test acc: 0.97437, Avg tpr: 0.95998, Avg fpr: 0.02537, total FA: 3522

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.11064 | acc=0.9807 | tpr=0.9248 | fpr=0.0183 | 5687.8 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.11310 | acc=0.9802 | tpr=0.9360 | fpr=0.0189 | 7449.9 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.11691 | acc=0.9797 | tpr=0.9424 | fpr=0.0196 | 8179.9 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.11845 | acc=0.9797 | tpr=0.9464 | fpr=0.0196 | 8268.2 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.11960 | acc=0.9797 | tpr=0.9432 | fpr=0.0196 | 8362.2 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.12083 | acc=0.9798 | tpr=0.9425 | fpr=0.0195 | 7441.0 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.12063 | acc=0.9799 | tpr=0.9449 | fpr=0.0195 | 8523.1 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.12150 | acc=0.9797 | tpr=0.9420 | fpr=0.0196 | 7865.7 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.12375 | acc=0.9794 | tpr=0.9416 | fpr=0.0199 | 8843.5 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.12277 | acc=0.9795 | tpr=0.9441 | fpr=0.0198 | 8090.3 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.12185 | acc=0.9796 | tpr=0.9419 | fpr=0.0197 | 9574.5 samples/s | 37.4 steps/s
Avg test loss: 0.12162, Avg test acc: 0.97961, Avg tpr: 0.94176, Avg fpr: 0.01971, total FA: 2736
