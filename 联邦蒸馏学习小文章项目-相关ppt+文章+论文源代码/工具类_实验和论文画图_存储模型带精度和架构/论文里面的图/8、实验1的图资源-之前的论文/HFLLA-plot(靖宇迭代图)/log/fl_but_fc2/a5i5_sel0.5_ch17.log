#clients of iccad2012: 5
#clients of asml1: 5
select ratio: 0.5
Total num clients: 10
client model path: ['models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0', 'models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1', 'models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2', 'models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3', 'models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4', 'models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0', 'models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1', 'models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2', 'models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3', 'models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (9983, 144, 17)
Resampled dataset to size (13125, 144, 17)
Using transform option: train
#pos = 6841, #neg = 6284
Allocated dataset with size (9983, 144, 17)
Resampled dataset to size (13116, 144, 17)
Using transform option: train
#pos = 6850, #neg = 6266
Allocated dataset with size (9983, 144, 17)
Resampled dataset to size (13135, 144, 17)
Using transform option: train
#pos = 6831, #neg = 6304
Allocated dataset with size (9983, 144, 17)
Resampled dataset to size (13124, 144, 17)
Using transform option: train
#pos = 6842, #neg = 6282
Allocated dataset with size (9984, 144, 17)
Resampled dataset to size (13051, 144, 17)
Using transform option: train
#pos = 6917, #neg = 6134
loading data into the main memory...
Allocated dataset with size (3660, 144, 17)
Resampled dataset to size (6754, 144, 17)
Using transform option: train
#pos = 3332, #neg = 3422
Allocated dataset with size (3660, 144, 17)
Resampled dataset to size (6728, 144, 17)
Using transform option: train
#pos = 3304, #neg = 3424
Allocated dataset with size (3660, 144, 17)
Resampled dataset to size (6702, 144, 17)
Using transform option: train
#pos = 3276, #neg = 3426
Allocated dataset with size (3660, 144, 17)
Resampled dataset to size (6792, 144, 17)
Using transform option: train
#pos = 3393, #neg = 3399
Allocated dataset with size (3660, 144, 17)
Resampled dataset to size (6715, 144, 17)
Using transform option: train
#pos = 3290, #neg = 3425
loading data into the main memory...
Allocated dataset with size (24958, 144, 17)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 17)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1 2 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.39486 | Reg=0.00353 | acc=0.5156 | L2-Norm=18.784 | L2-Norm(final)=1.980 | 1068.1 samples/s | 16.7 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.34860 | Reg=0.00353 | acc=0.5469 | L2-Norm=18.784 | L2-Norm(final)=1.983 | 6304.6 samples/s | 98.5 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.34198 | Reg=0.00353 | acc=0.5156 | L2-Norm=18.784 | L2-Norm(final)=1.997 | 6276.8 samples/s | 98.1 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.33643 | Reg=0.00353 | acc=0.6562 | L2-Norm=18.784 | L2-Norm(final)=2.018 | 6302.3 samples/s | 98.5 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.33434 | Reg=0.00353 | acc=0.6094 | L2-Norm=18.784 | L2-Norm(final)=2.043 | 10259.0 samples/s | 160.3 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.33259 | Reg=0.00353 | acc=0.6875 | L2-Norm=18.784 | L2-Norm(final)=2.069 | 2919.5 samples/s | 45.6 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.33004 | Reg=0.00353 | acc=0.5938 | L2-Norm=18.784 | L2-Norm(final)=2.097 | 6243.2 samples/s | 97.6 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.32763 | Reg=0.00353 | acc=0.7188 | L2-Norm=18.784 | L2-Norm(final)=2.127 | 6234.8 samples/s | 97.4 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.32549 | Reg=0.00353 | acc=0.7500 | L2-Norm=18.784 | L2-Norm(final)=2.159 | 8997.2 samples/s | 140.6 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.32398 | Reg=0.00353 | acc=0.7500 | L2-Norm=18.784 | L2-Norm(final)=2.193 | 3019.7 samples/s | 47.2 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.32282 | Reg=0.00353 | acc=0.6562 | L2-Norm=18.784 | L2-Norm(final)=2.228 | 6230.4 samples/s | 97.3 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.32437 | Reg=0.00353 | acc=0.6094 | L2-Norm=18.784 | L2-Norm(final)=2.585 | 6538.8 samples/s | 102.2 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.28352 | Reg=0.00338 | acc=0.8125 | L2-Norm=18.371 | L2-Norm(final)=2.593 | 4524.4 samples/s | 70.7 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.24773 | Reg=0.00332 | acc=0.8750 | L2-Norm=18.221 | L2-Norm(final)=2.604 | 4800.8 samples/s | 75.0 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.22325 | Reg=0.00329 | acc=0.8750 | L2-Norm=18.143 | L2-Norm(final)=2.616 | 4806.9 samples/s | 75.1 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.20563 | Reg=0.00327 | acc=0.7812 | L2-Norm=18.094 | L2-Norm(final)=2.627 | 6772.2 samples/s | 105.8 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.18728 | Reg=0.00326 | acc=0.7969 | L2-Norm=18.063 | L2-Norm(final)=2.639 | 2500.6 samples/s | 39.1 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.17476 | Reg=0.00326 | acc=0.8906 | L2-Norm=18.044 | L2-Norm(final)=2.650 | 4739.6 samples/s | 74.1 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.16588 | Reg=0.00325 | acc=0.8750 | L2-Norm=18.034 | L2-Norm(final)=2.663 | 4898.0 samples/s | 76.5 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.15722 | Reg=0.00325 | acc=0.8750 | L2-Norm=18.031 | L2-Norm(final)=2.675 | 6101.5 samples/s | 95.3 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.14715 | Reg=0.00325 | acc=0.9375 | L2-Norm=18.031 | L2-Norm(final)=2.688 | 2606.7 samples/s | 40.7 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.13888 | Reg=0.00325 | acc=0.9531 | L2-Norm=18.034 | L2-Norm(final)=2.701 | 4720.8 samples/s | 73.8 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.13257 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.038 | L2-Norm(final)=2.713 | 4787.9 samples/s | 74.8 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.12707 | Reg=0.00326 | acc=0.9688 | L2-Norm=18.043 | L2-Norm(final)=2.725 | 5723.4 samples/s | 89.4 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.12156 | Reg=0.00326 | acc=0.9688 | L2-Norm=18.050 | L2-Norm(final)=2.736 | 2687.5 samples/s | 42.0 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.11646 | Reg=0.00326 | acc=0.8906 | L2-Norm=18.059 | L2-Norm(final)=2.747 | 4713.7 samples/s | 73.7 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.11210 | Reg=0.00327 | acc=0.9844 | L2-Norm=18.069 | L2-Norm(final)=2.757 | 4811.5 samples/s | 75.2 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.10751 | Reg=0.00327 | acc=0.9219 | L2-Norm=18.081 | L2-Norm(final)=2.767 | 5239.6 samples/s | 81.9 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.10430 | Reg=0.00327 | acc=0.9844 | L2-Norm=18.093 | L2-Norm(final)=2.776 | 2808.6 samples/s | 43.9 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.10032 | Reg=0.00328 | acc=0.9844 | L2-Norm=18.106 | L2-Norm(final)=2.785 | 4675.0 samples/s | 73.0 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.09666 | Reg=0.00328 | acc=0.9531 | L2-Norm=18.118 | L2-Norm(final)=2.795 | 4744.7 samples/s | 74.1 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.09368 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.129 | L2-Norm(final)=2.803 | 4888.1 samples/s | 76.4 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.09066 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.139 | L2-Norm(final)=2.811 | 2903.4 samples/s | 45.4 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.08787 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.149 | L2-Norm(final)=2.820 | 4760.3 samples/s | 74.4 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.08560 | Reg=0.00330 | acc=0.9688 | L2-Norm=18.160 | L2-Norm(final)=2.828 | 4693.8 samples/s | 73.3 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.08329 | Reg=0.00330 | acc=0.9688 | L2-Norm=18.171 | L2-Norm(final)=2.836 | 4784.8 samples/s | 74.8 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.08142 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.182 | L2-Norm(final)=2.843 | 2792.6 samples/s | 43.6 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.07921 | Reg=0.00331 | acc=0.9062 | L2-Norm=18.193 | L2-Norm(final)=2.850 | 4474.9 samples/s | 69.9 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.07730 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.204 | L2-Norm(final)=2.856 | 4663.3 samples/s | 72.9 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07578 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.215 | L2-Norm(final)=2.862 | 4671.2 samples/s | 73.0 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07395 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.226 | L2-Norm(final)=2.868 | 2945.3 samples/s | 46.0 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.07241 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.237 | L2-Norm(final)=2.874 | 4664.8 samples/s | 72.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step2000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37227 | Reg=0.00353 | acc=0.5000 | L2-Norm=18.784 | L2-Norm(final)=1.979 | 7077.3 samples/s | 110.6 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.34775 | Reg=0.00353 | acc=0.5781 | L2-Norm=18.784 | L2-Norm(final)=1.985 | 5291.2 samples/s | 82.7 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.34215 | Reg=0.00353 | acc=0.6562 | L2-Norm=18.784 | L2-Norm(final)=2.002 | 6192.1 samples/s | 96.8 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.33785 | Reg=0.00353 | acc=0.7031 | L2-Norm=18.784 | L2-Norm(final)=2.024 | 6228.4 samples/s | 97.3 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.33459 | Reg=0.00353 | acc=0.5938 | L2-Norm=18.784 | L2-Norm(final)=2.051 | 10443.2 samples/s | 163.2 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.33175 | Reg=0.00353 | acc=0.7031 | L2-Norm=18.784 | L2-Norm(final)=2.081 | 2858.6 samples/s | 44.7 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.32934 | Reg=0.00353 | acc=0.7656 | L2-Norm=18.784 | L2-Norm(final)=2.114 | 6298.9 samples/s | 98.4 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.32729 | Reg=0.00353 | acc=0.7031 | L2-Norm=18.784 | L2-Norm(final)=2.149 | 6155.5 samples/s | 96.2 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.32510 | Reg=0.00353 | acc=0.5781 | L2-Norm=18.784 | L2-Norm(final)=2.185 | 9130.5 samples/s | 142.7 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.32375 | Reg=0.00353 | acc=0.7031 | L2-Norm=18.784 | L2-Norm(final)=2.223 | 2936.9 samples/s | 45.9 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.32196 | Reg=0.00353 | acc=0.5938 | L2-Norm=18.784 | L2-Norm(final)=2.263 | 6359.0 samples/s | 99.4 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.32256 | Reg=0.00353 | acc=0.6406 | L2-Norm=18.784 | L2-Norm(final)=2.664 | 6863.8 samples/s | 107.2 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.31505 | Reg=0.00339 | acc=0.7500 | L2-Norm=18.424 | L2-Norm(final)=2.644 | 4452.5 samples/s | 69.6 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.26901 | Reg=0.00335 | acc=0.8281 | L2-Norm=18.299 | L2-Norm(final)=2.669 | 4807.1 samples/s | 75.1 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.24182 | Reg=0.00332 | acc=0.8750 | L2-Norm=18.229 | L2-Norm(final)=2.685 | 4755.1 samples/s | 74.3 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.22161 | Reg=0.00331 | acc=0.8438 | L2-Norm=18.184 | L2-Norm(final)=2.699 | 6842.4 samples/s | 106.9 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.20307 | Reg=0.00330 | acc=0.9531 | L2-Norm=18.156 | L2-Norm(final)=2.713 | 2483.4 samples/s | 38.8 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.19159 | Reg=0.00329 | acc=0.9062 | L2-Norm=18.138 | L2-Norm(final)=2.725 | 4880.5 samples/s | 76.3 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.17933 | Reg=0.00329 | acc=0.9375 | L2-Norm=18.129 | L2-Norm(final)=2.736 | 4676.4 samples/s | 73.1 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.16993 | Reg=0.00329 | acc=0.8438 | L2-Norm=18.125 | L2-Norm(final)=2.747 | 6366.8 samples/s | 99.5 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.15993 | Reg=0.00329 | acc=0.9531 | L2-Norm=18.127 | L2-Norm(final)=2.757 | 2566.0 samples/s | 40.1 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.15071 | Reg=0.00329 | acc=0.9062 | L2-Norm=18.131 | L2-Norm(final)=2.769 | 4701.0 samples/s | 73.5 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.14431 | Reg=0.00329 | acc=0.9219 | L2-Norm=18.137 | L2-Norm(final)=2.780 | 4804.7 samples/s | 75.1 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.13863 | Reg=0.00329 | acc=0.9531 | L2-Norm=18.144 | L2-Norm(final)=2.790 | 5823.9 samples/s | 91.0 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.13174 | Reg=0.00330 | acc=0.9688 | L2-Norm=18.152 | L2-Norm(final)=2.801 | 2671.2 samples/s | 41.7 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.12585 | Reg=0.00330 | acc=0.8750 | L2-Norm=18.163 | L2-Norm(final)=2.812 | 4679.3 samples/s | 73.1 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.12110 | Reg=0.00330 | acc=0.9375 | L2-Norm=18.174 | L2-Norm(final)=2.822 | 4770.1 samples/s | 74.5 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.11664 | Reg=0.00331 | acc=0.9531 | L2-Norm=18.185 | L2-Norm(final)=2.831 | 5504.9 samples/s | 86.0 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.11178 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.196 | L2-Norm(final)=2.841 | 2737.3 samples/s | 42.8 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.10736 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.207 | L2-Norm(final)=2.850 | 4758.3 samples/s | 74.3 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.10370 | Reg=0.00332 | acc=0.9844 | L2-Norm=18.218 | L2-Norm(final)=2.859 | 4795.8 samples/s | 74.9 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.10068 | Reg=0.00332 | acc=0.9375 | L2-Norm=18.229 | L2-Norm(final)=2.868 | 5154.4 samples/s | 80.5 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.09744 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.239 | L2-Norm(final)=2.876 | 2842.2 samples/s | 44.4 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.09425 | Reg=0.00333 | acc=0.9844 | L2-Norm=18.249 | L2-Norm(final)=2.884 | 4717.1 samples/s | 73.7 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.09184 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.258 | L2-Norm(final)=2.891 | 4689.6 samples/s | 73.3 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.08954 | Reg=0.00334 | acc=0.9531 | L2-Norm=18.268 | L2-Norm(final)=2.897 | 4875.0 samples/s | 76.2 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.08697 | Reg=0.00334 | acc=0.9844 | L2-Norm=18.277 | L2-Norm(final)=2.904 | 2916.2 samples/s | 45.6 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.08432 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.286 | L2-Norm(final)=2.910 | 4730.3 samples/s | 73.9 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.08215 | Reg=0.00335 | acc=0.9531 | L2-Norm=18.295 | L2-Norm(final)=2.917 | 4758.1 samples/s | 74.3 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.08047 | Reg=0.00335 | acc=0.9688 | L2-Norm=18.303 | L2-Norm(final)=2.923 | 4854.1 samples/s | 75.8 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07845 | Reg=0.00335 | acc=0.9844 | L2-Norm=18.312 | L2-Norm(final)=2.929 | 2898.2 samples/s | 45.3 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.07673 | Reg=0.00336 | acc=0.9219 | L2-Norm=18.320 | L2-Norm(final)=2.934 | 4754.9 samples/s | 74.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step2000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35668 | Reg=0.00353 | acc=0.5469 | L2-Norm=18.784 | L2-Norm(final)=1.979 | 6840.3 samples/s | 106.9 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.34935 | Reg=0.00353 | acc=0.5781 | L2-Norm=18.784 | L2-Norm(final)=1.981 | 5729.4 samples/s | 89.5 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.34234 | Reg=0.00353 | acc=0.6250 | L2-Norm=18.784 | L2-Norm(final)=1.993 | 5966.4 samples/s | 93.2 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.33836 | Reg=0.00353 | acc=0.5938 | L2-Norm=18.784 | L2-Norm(final)=2.011 | 6558.0 samples/s | 102.5 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.33540 | Reg=0.00353 | acc=0.7031 | L2-Norm=18.784 | L2-Norm(final)=2.034 | 9685.5 samples/s | 151.3 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.33211 | Reg=0.00353 | acc=0.6562 | L2-Norm=18.784 | L2-Norm(final)=2.061 | 2859.9 samples/s | 44.7 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.32963 | Reg=0.00353 | acc=0.6094 | L2-Norm=18.784 | L2-Norm(final)=2.093 | 6106.4 samples/s | 95.4 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.32827 | Reg=0.00353 | acc=0.6250 | L2-Norm=18.784 | L2-Norm(final)=2.124 | 6363.8 samples/s | 99.4 steps/s
[Step= 400 Epoch= 1.9] | Loss=0.32632 | Reg=0.00353 | acc=0.7344 | L2-Norm=18.784 | L2-Norm(final)=2.156 | 8755.0 samples/s | 136.8 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.32477 | Reg=0.00353 | acc=0.6719 | L2-Norm=18.784 | L2-Norm(final)=2.190 | 3012.5 samples/s | 47.1 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.32330 | Reg=0.00353 | acc=0.7188 | L2-Norm=18.784 | L2-Norm(final)=2.224 | 6480.3 samples/s | 101.3 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.29834 | Reg=0.00353 | acc=0.6875 | L2-Norm=18.784 | L2-Norm(final)=2.579 | 6958.4 samples/s | 108.7 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.30883 | Reg=0.00338 | acc=0.8125 | L2-Norm=18.379 | L2-Norm(final)=2.563 | 4388.5 samples/s | 68.6 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.26687 | Reg=0.00333 | acc=0.8750 | L2-Norm=18.243 | L2-Norm(final)=2.580 | 4751.9 samples/s | 74.2 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.23757 | Reg=0.00330 | acc=0.8438 | L2-Norm=18.178 | L2-Norm(final)=2.596 | 4883.2 samples/s | 76.3 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.21658 | Reg=0.00329 | acc=0.8750 | L2-Norm=18.141 | L2-Norm(final)=2.613 | 6687.9 samples/s | 104.5 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.19834 | Reg=0.00328 | acc=0.8750 | L2-Norm=18.118 | L2-Norm(final)=2.632 | 2484.3 samples/s | 38.8 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.18583 | Reg=0.00328 | acc=0.9219 | L2-Norm=18.107 | L2-Norm(final)=2.649 | 4761.6 samples/s | 74.4 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.17638 | Reg=0.00328 | acc=0.9062 | L2-Norm=18.103 | L2-Norm(final)=2.664 | 4788.2 samples/s | 74.8 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.16625 | Reg=0.00328 | acc=0.9688 | L2-Norm=18.101 | L2-Norm(final)=2.676 | 6213.5 samples/s | 97.1 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.15737 | Reg=0.00328 | acc=0.9375 | L2-Norm=18.101 | L2-Norm(final)=2.688 | 2581.1 samples/s | 40.3 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.14922 | Reg=0.00328 | acc=0.9531 | L2-Norm=18.103 | L2-Norm(final)=2.699 | 4780.2 samples/s | 74.7 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.14206 | Reg=0.00328 | acc=0.9688 | L2-Norm=18.109 | L2-Norm(final)=2.711 | 4825.6 samples/s | 75.4 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.13558 | Reg=0.00328 | acc=0.9219 | L2-Norm=18.116 | L2-Norm(final)=2.721 | 5701.5 samples/s | 89.1 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.12890 | Reg=0.00328 | acc=0.9844 | L2-Norm=18.124 | L2-Norm(final)=2.732 | 2687.0 samples/s | 42.0 steps/s
[Step=1200 Epoch= 5.8] | Loss=0.12317 | Reg=0.00329 | acc=0.9219 | L2-Norm=18.133 | L2-Norm(final)=2.743 | 4738.7 samples/s | 74.0 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.11840 | Reg=0.00329 | acc=0.9531 | L2-Norm=18.143 | L2-Norm(final)=2.754 | 4778.3 samples/s | 74.7 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.11395 | Reg=0.00330 | acc=0.9844 | L2-Norm=18.152 | L2-Norm(final)=2.765 | 5272.3 samples/s | 82.4 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.10931 | Reg=0.00330 | acc=0.9531 | L2-Norm=18.162 | L2-Norm(final)=2.774 | 2799.0 samples/s | 43.7 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.10515 | Reg=0.00330 | acc=0.9844 | L2-Norm=18.170 | L2-Norm(final)=2.784 | 4789.1 samples/s | 74.8 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.10141 | Reg=0.00330 | acc=0.9844 | L2-Norm=18.179 | L2-Norm(final)=2.793 | 4755.8 samples/s | 74.3 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.09862 | Reg=0.00331 | acc=0.9375 | L2-Norm=18.187 | L2-Norm(final)=2.801 | 4887.7 samples/s | 76.4 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.09534 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.196 | L2-Norm(final)=2.809 | 2914.7 samples/s | 45.5 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.09214 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.204 | L2-Norm(final)=2.817 | 4776.5 samples/s | 74.6 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.08956 | Reg=0.00332 | acc=0.9531 | L2-Norm=18.213 | L2-Norm(final)=2.825 | 4818.3 samples/s | 75.3 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.08726 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.221 | L2-Norm(final)=2.833 | 4722.4 samples/s | 73.8 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.08504 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.230 | L2-Norm(final)=2.840 | 2960.5 samples/s | 46.3 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.08255 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.238 | L2-Norm(final)=2.847 | 4728.6 samples/s | 73.9 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.08039 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.246 | L2-Norm(final)=2.854 | 4734.8 samples/s | 74.0 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07845 | Reg=0.00333 | acc=0.9688 | L2-Norm=18.253 | L2-Norm(final)=2.861 | 4826.9 samples/s | 75.4 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07674 | Reg=0.00333 | acc=0.9531 | L2-Norm=18.260 | L2-Norm(final)=2.867 | 2959.0 samples/s | 46.2 steps/s
[Step=2000 Epoch= 9.7] | Loss=0.07491 | Reg=0.00334 | acc=0.9844 | L2-Norm=18.266 | L2-Norm(final)=2.872 | 4780.4 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step2000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34404 | Reg=0.00353 | acc=0.4375 | L2-Norm=18.784 | L2-Norm(final)=1.980 | 7662.0 samples/s | 119.7 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.30970 | Reg=0.00353 | acc=0.6406 | L2-Norm=18.784 | L2-Norm(final)=1.988 | 4857.8 samples/s | 75.9 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.29219 | Reg=0.00353 | acc=0.8281 | L2-Norm=18.784 | L2-Norm(final)=2.025 | 9811.6 samples/s | 153.3 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.27906 | Reg=0.00353 | acc=0.7344 | L2-Norm=18.784 | L2-Norm(final)=2.087 | 2750.9 samples/s | 43.0 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.26878 | Reg=0.00353 | acc=0.8438 | L2-Norm=18.784 | L2-Norm(final)=2.165 | 8394.7 samples/s | 131.2 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.25896 | Reg=0.00353 | acc=0.8750 | L2-Norm=18.784 | L2-Norm(final)=2.255 | 2824.6 samples/s | 44.1 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.25042 | Reg=0.00353 | acc=0.8125 | L2-Norm=18.784 | L2-Norm(final)=2.351 | 7983.9 samples/s | 124.7 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.24311 | Reg=0.00353 | acc=0.8906 | L2-Norm=18.784 | L2-Norm(final)=2.451 | 2898.4 samples/s | 45.3 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.23623 | Reg=0.00353 | acc=0.9062 | L2-Norm=18.784 | L2-Norm(final)=2.554 | 7254.8 samples/s | 113.4 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.23031 | Reg=0.00353 | acc=0.9219 | L2-Norm=18.784 | L2-Norm(final)=2.658 | 3125.5 samples/s | 48.8 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.22450 | Reg=0.00353 | acc=0.9062 | L2-Norm=18.784 | L2-Norm(final)=2.762 | 6152.5 samples/s | 96.1 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.8] | Loss=0.21549 | Reg=0.00353 | acc=0.8594 | L2-Norm=18.784 | L2-Norm(final)=3.805 | 6481.6 samples/s | 101.3 steps/s
[Step= 550 Epoch= 5.3] | Loss=0.11617 | Reg=0.00342 | acc=0.9688 | L2-Norm=18.500 | L2-Norm(final)=3.846 | 4277.1 samples/s | 66.8 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.06526 | Reg=0.00339 | acc=0.9844 | L2-Norm=18.419 | L2-Norm(final)=3.885 | 6595.4 samples/s | 103.1 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.04563 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.369 | L2-Norm(final)=3.909 | 2423.7 samples/s | 37.9 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.03534 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.329 | L2-Norm(final)=3.925 | 5955.2 samples/s | 93.0 steps/s
[Step= 750 Epoch= 7.2] | Loss=0.02837 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.293 | L2-Norm(final)=3.938 | 2445.7 samples/s | 38.2 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.02371 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.258 | L2-Norm(final)=3.947 | 5703.3 samples/s | 89.1 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.02034 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.222 | L2-Norm(final)=3.955 | 2525.1 samples/s | 39.5 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.01780 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.186 | L2-Norm(final)=3.961 | 5285.1 samples/s | 82.6 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.01583 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.148 | L2-Norm(final)=3.966 | 2633.2 samples/s | 41.1 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01425 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.111 | L2-Norm(final)=3.970 | 4927.1 samples/s | 77.0 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01296 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.073 | L2-Norm(final)=3.973 | 2678.7 samples/s | 41.9 steps/s
[Step=1100 Epoch=10.5] | Loss=0.01188 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.035 | L2-Norm(final)=3.977 | 4691.3 samples/s | 73.3 steps/s
[Step=1150 Epoch=11.0] | Loss=0.01097 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.997 | L2-Norm(final)=3.979 | 2812.4 samples/s | 43.9 steps/s
[Step=1200 Epoch=11.5] | Loss=0.01019 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=3.982 | 4539.0 samples/s | 70.9 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00951 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.921 | L2-Norm(final)=3.984 | 2868.6 samples/s | 44.8 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00892 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.883 | L2-Norm(final)=3.986 | 4585.8 samples/s | 71.7 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00840 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.845 | L2-Norm(final)=3.988 | 2827.9 samples/s | 44.2 steps/s
[Step=1400 Epoch=13.4] | Loss=0.00793 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.807 | L2-Norm(final)=3.990 | 4552.6 samples/s | 71.1 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00751 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.769 | L2-Norm(final)=3.992 | 2862.4 samples/s | 44.7 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00714 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.731 | L2-Norm(final)=3.994 | 4501.5 samples/s | 70.3 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00680 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.693 | L2-Norm(final)=3.995 | 7356.6 samples/s | 114.9 steps/s
[Step=1600 Epoch=15.3] | Loss=0.00649 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.655 | L2-Norm(final)=3.997 | 2310.9 samples/s | 36.1 steps/s
[Step=1650 Epoch=15.8] | Loss=0.00621 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.617 | L2-Norm(final)=3.999 | 6749.7 samples/s | 105.5 steps/s
[Step=1700 Epoch=16.2] | Loss=0.00595 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.579 | L2-Norm(final)=4.000 | 2393.6 samples/s | 37.4 steps/s
[Step=1750 Epoch=16.7] | Loss=0.00571 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.541 | L2-Norm(final)=4.002 | 5991.4 samples/s | 93.6 steps/s
[Step=1800 Epoch=17.2] | Loss=0.00549 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.504 | L2-Norm(final)=4.004 | 2443.2 samples/s | 38.2 steps/s
[Step=1850 Epoch=17.7] | Loss=0.00529 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.466 | L2-Norm(final)=4.005 | 5692.3 samples/s | 88.9 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00510 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.428 | L2-Norm(final)=4.007 | 2536.5 samples/s | 39.6 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00493 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.390 | L2-Norm(final)=4.008 | 5276.2 samples/s | 82.4 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00476 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.353 | L2-Norm(final)=4.010 | 2628.7 samples/s | 41.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step2000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34533 | Reg=0.00353 | acc=0.4844 | L2-Norm=18.784 | L2-Norm(final)=1.980 | 7271.5 samples/s | 113.6 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.30964 | Reg=0.00353 | acc=0.5781 | L2-Norm=18.784 | L2-Norm(final)=1.986 | 5197.0 samples/s | 81.2 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.29477 | Reg=0.00353 | acc=0.7344 | L2-Norm=18.784 | L2-Norm(final)=2.021 | 9487.4 samples/s | 148.2 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.28273 | Reg=0.00353 | acc=0.8438 | L2-Norm=18.784 | L2-Norm(final)=2.076 | 2734.1 samples/s | 42.7 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.27146 | Reg=0.00353 | acc=0.9062 | L2-Norm=18.784 | L2-Norm(final)=2.146 | 8579.0 samples/s | 134.0 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.26160 | Reg=0.00353 | acc=0.8594 | L2-Norm=18.784 | L2-Norm(final)=2.227 | 2818.4 samples/s | 44.0 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.25374 | Reg=0.00353 | acc=0.9062 | L2-Norm=18.784 | L2-Norm(final)=2.314 | 8013.2 samples/s | 125.2 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.24680 | Reg=0.00353 | acc=0.8438 | L2-Norm=18.784 | L2-Norm(final)=2.403 | 2982.9 samples/s | 46.6 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.24089 | Reg=0.00353 | acc=0.9062 | L2-Norm=18.784 | L2-Norm(final)=2.493 | 6787.1 samples/s | 106.0 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.23460 | Reg=0.00353 | acc=0.8438 | L2-Norm=18.784 | L2-Norm(final)=2.585 | 3068.7 samples/s | 47.9 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.22940 | Reg=0.00353 | acc=0.9531 | L2-Norm=18.784 | L2-Norm(final)=2.677 | 6491.5 samples/s | 101.4 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.8] | Loss=0.18624 | Reg=0.00353 | acc=0.8906 | L2-Norm=18.784 | L2-Norm(final)=3.595 | 6757.9 samples/s | 105.6 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.11902 | Reg=0.00342 | acc=0.9844 | L2-Norm=18.494 | L2-Norm(final)=3.621 | 4117.1 samples/s | 64.3 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.07105 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.405 | L2-Norm(final)=3.658 | 6712.7 samples/s | 104.9 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.05023 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.341 | L2-Norm(final)=3.677 | 2388.9 samples/s | 37.3 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.03832 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.289 | L2-Norm(final)=3.693 | 6106.4 samples/s | 95.4 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.03087 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.241 | L2-Norm(final)=3.706 | 2471.7 samples/s | 38.6 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.02579 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.194 | L2-Norm(final)=3.715 | 5628.0 samples/s | 87.9 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.02214 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.148 | L2-Norm(final)=3.723 | 2546.2 samples/s | 39.8 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.01939 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.104 | L2-Norm(final)=3.730 | 5281.6 samples/s | 82.5 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.01724 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.059 | L2-Norm(final)=3.735 | 2664.8 samples/s | 41.6 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01553 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.016 | L2-Norm(final)=3.740 | 4831.5 samples/s | 75.5 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01412 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.972 | L2-Norm(final)=3.744 | 2739.0 samples/s | 42.8 steps/s
[Step=1100 Epoch=10.5] | Loss=0.01295 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.929 | L2-Norm(final)=3.747 | 4607.8 samples/s | 72.0 steps/s
[Step=1150 Epoch=11.0] | Loss=0.01196 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.887 | L2-Norm(final)=3.750 | 2829.9 samples/s | 44.2 steps/s
[Step=1200 Epoch=11.4] | Loss=0.01110 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.845 | L2-Norm(final)=3.753 | 4579.4 samples/s | 71.6 steps/s
[Step=1250 Epoch=11.9] | Loss=0.01037 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.803 | L2-Norm(final)=3.756 | 2875.7 samples/s | 44.9 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00972 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.762 | L2-Norm(final)=3.759 | 4585.2 samples/s | 71.6 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00915 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.721 | L2-Norm(final)=3.761 | 2851.7 samples/s | 44.6 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00864 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.680 | L2-Norm(final)=3.764 | 4575.0 samples/s | 71.5 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00819 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.640 | L2-Norm(final)=3.766 | 2921.0 samples/s | 45.6 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00778 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.600 | L2-Norm(final)=3.769 | 4519.9 samples/s | 70.6 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00741 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.560 | L2-Norm(final)=3.771 | 7403.6 samples/s | 115.7 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00708 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.520 | L2-Norm(final)=3.773 | 2305.2 samples/s | 36.0 steps/s
[Step=1650 Epoch=15.7] | Loss=0.00677 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.481 | L2-Norm(final)=3.775 | 6727.4 samples/s | 105.1 steps/s
[Step=1700 Epoch=16.2] | Loss=0.00649 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.441 | L2-Norm(final)=3.778 | 2402.8 samples/s | 37.5 steps/s
[Step=1750 Epoch=16.7] | Loss=0.00623 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.402 | L2-Norm(final)=3.780 | 6060.6 samples/s | 94.7 steps/s
[Step=1800 Epoch=17.2] | Loss=0.00599 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.363 | L2-Norm(final)=3.782 | 2470.0 samples/s | 38.6 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00577 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.325 | L2-Norm(final)=3.784 | 5704.4 samples/s | 89.1 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00556 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.286 | L2-Norm(final)=3.787 | 2525.0 samples/s | 39.5 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00537 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.247 | L2-Norm(final)=3.789 | 5292.9 samples/s | 82.7 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00519 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.209 | L2-Norm(final)=3.791 | 2667.6 samples/s | 41.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.15849 | acc=0.9238 | tpr=0.9590 | fpr=0.1526 | 5853.1 samples/s | 22.9 steps/s
Avg test loss: 0.16360, Avg test acc: 0.92039, Avg tpr: 0.95535, Avg fpr: 0.15652, total FA: 1221

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.16992 | acc=0.9172 | tpr=0.9563 | fpr=0.1677 | 6017.2 samples/s | 23.5 steps/s
Avg test loss: 0.17464, Avg test acc: 0.91522, Avg tpr: 0.95366, Avg fpr: 0.16934, total FA: 1321

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.16262 | acc=0.9261 | tpr=0.9613 | fpr=0.1504 | 5924.4 samples/s | 23.1 steps/s
Avg test loss: 0.16937, Avg test acc: 0.92347, Avg tpr: 0.95844, Avg fpr: 0.15344, total FA: 1197

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.32852 | acc=0.6785 | tpr=0.9889 | fpr=0.9955 | 6129.0 samples/s | 23.9 steps/s
Avg test loss: 0.32729, Avg test acc: 0.68146, Avg tpr: 0.98939, Avg fpr: 0.99577, total FA: 7768

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.32852 | acc=0.6785 | tpr=0.9889 | fpr=0.9955 | 6061.8 samples/s | 23.7 steps/s
Avg test loss: 0.32729, Avg test acc: 0.68146, Avg tpr: 0.98939, Avg fpr: 0.99577, total FA: 7768

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=0.32852 | acc=0.6785 | tpr=0.9889 | fpr=0.9955 | 5973.0 samples/s | 23.3 steps/s
Avg test loss: 0.32729, Avg test acc: 0.68146, Avg tpr: 0.98939, Avg fpr: 0.99577, total FA: 7768

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=0.32852 | acc=0.6785 | tpr=0.9889 | fpr=0.9955 | 5624.0 samples/s | 22.0 steps/s
Avg test loss: 0.32729, Avg test acc: 0.68146, Avg tpr: 0.98939, Avg fpr: 0.99577, total FA: 7768

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.52681 | acc=0.3234 | tpr=0.0266 | fpr=0.0322 | 6137.5 samples/s | 24.0 steps/s
Avg test loss: 5.54097, Avg test acc: 0.32042, Avg tpr: 0.02565, Avg fpr: 0.03128, total FA: 244

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=0.32852 | acc=0.6785 | tpr=0.9889 | fpr=0.9955 | 5768.0 samples/s | 22.5 steps/s
Avg test loss: 0.32729, Avg test acc: 0.68146, Avg tpr: 0.98939, Avg fpr: 0.99577, total FA: 7768

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.19164 | acc=0.3229 | tpr=0.0334 | fpr=0.0486 | 5985.3 samples/s | 23.4 steps/s
Avg test loss: 5.20155, Avg test acc: 0.32062, Avg tpr: 0.03258, Avg fpr: 0.04589, total FA: 358

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.04021 | acc=0.1316 | tpr=0.8894 | fpr=0.8821 | 6061.2 samples/s | 23.7 steps/s
[Step= 100] | Loss=4.02588 | acc=0.1336 | tpr=0.8849 | fpr=0.8805 | 7189.3 samples/s | 28.1 steps/s
[Step= 150] | Loss=4.02139 | acc=0.1322 | tpr=0.8847 | fpr=0.8816 | 8334.2 samples/s | 32.6 steps/s
[Step= 200] | Loss=4.01516 | acc=0.1328 | tpr=0.8907 | fpr=0.8810 | 8292.8 samples/s | 32.4 steps/s
[Step= 250] | Loss=4.02190 | acc=0.1329 | tpr=0.8969 | fpr=0.8810 | 7983.4 samples/s | 31.2 steps/s
[Step= 300] | Loss=4.01984 | acc=0.1330 | tpr=0.8982 | fpr=0.8809 | 8190.8 samples/s | 32.0 steps/s
[Step= 350] | Loss=4.02326 | acc=0.1329 | tpr=0.8973 | fpr=0.8810 | 8296.7 samples/s | 32.4 steps/s
[Step= 400] | Loss=4.02432 | acc=0.1332 | tpr=0.8955 | fpr=0.8807 | 7749.1 samples/s | 30.3 steps/s
[Step= 450] | Loss=4.02438 | acc=0.1329 | tpr=0.8978 | fpr=0.8810 | 8240.3 samples/s | 32.2 steps/s
[Step= 500] | Loss=4.02156 | acc=0.1329 | tpr=0.8974 | fpr=0.8809 | 7590.9 samples/s | 29.7 steps/s
[Step= 550] | Loss=4.01879 | acc=0.1332 | tpr=0.8965 | fpr=0.8807 | 11169.9 samples/s | 43.6 steps/s
Avg test loss: 4.01922, Avg test acc: 0.13310, Avg tpr: 0.89699, Avg fpr: 0.88078, total FA: 122295

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.28899 | acc=0.1445 | tpr=0.8496 | fpr=0.8681 | 5880.9 samples/s | 23.0 steps/s
[Step= 100] | Loss=4.25587 | acc=0.1474 | tpr=0.8337 | fpr=0.8654 | 8277.2 samples/s | 32.3 steps/s
[Step= 150] | Loss=4.25273 | acc=0.1469 | tpr=0.8271 | fpr=0.8656 | 7941.5 samples/s | 31.0 steps/s
[Step= 200] | Loss=4.24328 | acc=0.1468 | tpr=0.8219 | fpr=0.8655 | 8483.9 samples/s | 33.1 steps/s
[Step= 250] | Loss=4.24690 | acc=0.1469 | tpr=0.8262 | fpr=0.8655 | 7303.7 samples/s | 28.5 steps/s
[Step= 300] | Loss=4.24179 | acc=0.1463 | tpr=0.8233 | fpr=0.8660 | 9006.2 samples/s | 35.2 steps/s
[Step= 350] | Loss=4.24518 | acc=0.1460 | tpr=0.8203 | fpr=0.8663 | 8127.3 samples/s | 31.7 steps/s
[Step= 400] | Loss=4.24816 | acc=0.1461 | tpr=0.8184 | fpr=0.8661 | 8087.0 samples/s | 31.6 steps/s
[Step= 450] | Loss=4.25003 | acc=0.1457 | tpr=0.8204 | fpr=0.8665 | 7762.5 samples/s | 30.3 steps/s
[Step= 500] | Loss=4.24875 | acc=0.1459 | tpr=0.8233 | fpr=0.8663 | 8821.7 samples/s | 34.5 steps/s
[Step= 550] | Loss=4.24613 | acc=0.1462 | tpr=0.8237 | fpr=0.8661 | 9232.3 samples/s | 36.1 steps/s
Avg test loss: 4.24653, Avg test acc: 0.14610, Avg tpr: 0.82409, Avg fpr: 0.86622, total FA: 120273

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.39035 | acc=0.1309 | tpr=0.9558 | fpr=0.8839 | 5857.2 samples/s | 22.9 steps/s
[Step= 100] | Loss=4.37189 | acc=0.1318 | tpr=0.9488 | fpr=0.8835 | 7670.0 samples/s | 30.0 steps/s
[Step= 150] | Loss=4.38289 | acc=0.1309 | tpr=0.9366 | fpr=0.8840 | 7775.0 samples/s | 30.4 steps/s
[Step= 200] | Loss=4.38458 | acc=0.1305 | tpr=0.9311 | fpr=0.8841 | 8260.3 samples/s | 32.3 steps/s
[Step= 250] | Loss=4.39273 | acc=0.1305 | tpr=0.9284 | fpr=0.8841 | 8304.2 samples/s | 32.4 steps/s
[Step= 300] | Loss=4.39490 | acc=0.1300 | tpr=0.9244 | fpr=0.8845 | 8279.3 samples/s | 32.3 steps/s
[Step= 350] | Loss=4.39630 | acc=0.1297 | tpr=0.9230 | fpr=0.8847 | 8318.0 samples/s | 32.5 steps/s
[Step= 400] | Loss=4.40210 | acc=0.1295 | tpr=0.9212 | fpr=0.8849 | 8077.0 samples/s | 31.6 steps/s
[Step= 450] | Loss=4.40333 | acc=0.1291 | tpr=0.9226 | fpr=0.8853 | 8035.1 samples/s | 31.4 steps/s
[Step= 500] | Loss=4.40243 | acc=0.1294 | tpr=0.9247 | fpr=0.8850 | 8219.1 samples/s | 32.1 steps/s
[Step= 550] | Loss=4.40143 | acc=0.1294 | tpr=0.9248 | fpr=0.8850 | 10148.0 samples/s | 39.6 steps/s
Avg test loss: 4.40174, Avg test acc: 0.12937, Avg tpr: 0.92512, Avg fpr: 0.88510, total FA: 122894

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=0.44061 | acc=0.0570 | tpr=0.9823 | fpr=0.9597 | 5833.2 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.44248 | acc=0.0546 | tpr=0.9851 | fpr=0.9628 | 8363.7 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.44266 | acc=0.0542 | tpr=0.9827 | fpr=0.9629 | 8173.2 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.44246 | acc=0.0540 | tpr=0.9825 | fpr=0.9629 | 7951.9 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.44276 | acc=0.0545 | tpr=0.9817 | fpr=0.9624 | 7509.7 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.44278 | acc=0.0547 | tpr=0.9840 | fpr=0.9622 | 8085.4 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.44285 | acc=0.0548 | tpr=0.9850 | fpr=0.9621 | 8180.0 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.44300 | acc=0.0549 | tpr=0.9825 | fpr=0.9620 | 7618.4 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.44297 | acc=0.0549 | tpr=0.9815 | fpr=0.9620 | 8273.6 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.44305 | acc=0.0545 | tpr=0.9819 | fpr=0.9622 | 8553.2 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.44295 | acc=0.0549 | tpr=0.9813 | fpr=0.9620 | 10222.3 samples/s | 39.9 steps/s
Avg test loss: 0.44293, Avg test acc: 0.05482, Avg tpr: 0.98138, Avg fpr: 0.96202, total FA: 133575

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=0.44061 | acc=0.0570 | tpr=0.9823 | fpr=0.9597 | 6106.3 samples/s | 23.9 steps/s
[Step= 100] | Loss=0.44248 | acc=0.0546 | tpr=0.9851 | fpr=0.9628 | 7939.0 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.44266 | acc=0.0542 | tpr=0.9827 | fpr=0.9629 | 7922.0 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.44246 | acc=0.0540 | tpr=0.9825 | fpr=0.9629 | 7699.6 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.44276 | acc=0.0545 | tpr=0.9817 | fpr=0.9624 | 8675.3 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.44278 | acc=0.0547 | tpr=0.9840 | fpr=0.9622 | 7988.2 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.44285 | acc=0.0548 | tpr=0.9850 | fpr=0.9621 | 7700.4 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.44300 | acc=0.0549 | tpr=0.9825 | fpr=0.9620 | 8262.9 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.44297 | acc=0.0549 | tpr=0.9815 | fpr=0.9620 | 8659.5 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.44305 | acc=0.0545 | tpr=0.9819 | fpr=0.9622 | 7889.3 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.44295 | acc=0.0549 | tpr=0.9813 | fpr=0.9620 | 9559.4 samples/s | 37.3 steps/s
Avg test loss: 0.44293, Avg test acc: 0.05482, Avg tpr: 0.98138, Avg fpr: 0.96202, total FA: 133575

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.44061 | acc=0.0570 | tpr=0.9823 | fpr=0.9597 | 6033.9 samples/s | 23.6 steps/s
[Step= 100] | Loss=0.44248 | acc=0.0546 | tpr=0.9851 | fpr=0.9628 | 7553.3 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.44266 | acc=0.0542 | tpr=0.9827 | fpr=0.9629 | 7720.0 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.44246 | acc=0.0540 | tpr=0.9825 | fpr=0.9629 | 8274.1 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.44276 | acc=0.0545 | tpr=0.9817 | fpr=0.9624 | 8376.4 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.44278 | acc=0.0547 | tpr=0.9840 | fpr=0.9622 | 8070.7 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.44285 | acc=0.0548 | tpr=0.9850 | fpr=0.9621 | 7830.5 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.44300 | acc=0.0549 | tpr=0.9825 | fpr=0.9620 | 8255.8 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.44297 | acc=0.0549 | tpr=0.9815 | fpr=0.9620 | 7999.7 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.44305 | acc=0.0545 | tpr=0.9819 | fpr=0.9622 | 7789.3 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.44295 | acc=0.0549 | tpr=0.9813 | fpr=0.9620 | 10918.8 samples/s | 42.7 steps/s
Avg test loss: 0.44293, Avg test acc: 0.05482, Avg tpr: 0.98138, Avg fpr: 0.96202, total FA: 133575

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.44061 | acc=0.0570 | tpr=0.9823 | fpr=0.9597 | 6261.2 samples/s | 24.5 steps/s
[Step= 100] | Loss=0.44248 | acc=0.0546 | tpr=0.9851 | fpr=0.9628 | 7232.0 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.44266 | acc=0.0542 | tpr=0.9827 | fpr=0.9629 | 8500.8 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.44246 | acc=0.0540 | tpr=0.9825 | fpr=0.9629 | 8599.7 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.44276 | acc=0.0545 | tpr=0.9817 | fpr=0.9624 | 7293.0 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.44278 | acc=0.0547 | tpr=0.9840 | fpr=0.9622 | 7928.6 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.44285 | acc=0.0548 | tpr=0.9850 | fpr=0.9621 | 7974.4 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.44300 | acc=0.0549 | tpr=0.9825 | fpr=0.9620 | 7793.1 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.44297 | acc=0.0549 | tpr=0.9815 | fpr=0.9620 | 8098.7 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.44305 | acc=0.0545 | tpr=0.9819 | fpr=0.9622 | 8502.1 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.44295 | acc=0.0549 | tpr=0.9813 | fpr=0.9620 | 10199.0 samples/s | 39.8 steps/s
Avg test loss: 0.44293, Avg test acc: 0.05482, Avg tpr: 0.98138, Avg fpr: 0.96202, total FA: 133575

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.18085 | acc=0.9525 | tpr=0.8938 | fpr=0.0464 | 6048.3 samples/s | 23.6 steps/s
[Step= 100] | Loss=0.18500 | acc=0.9527 | tpr=0.9190 | fpr=0.0466 | 7938.9 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.18543 | acc=0.9518 | tpr=0.9121 | fpr=0.0475 | 7652.8 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.18649 | acc=0.9514 | tpr=0.9246 | fpr=0.0481 | 8104.7 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.18697 | acc=0.9510 | tpr=0.9170 | fpr=0.0484 | 8060.2 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.18949 | acc=0.9500 | tpr=0.9127 | fpr=0.0493 | 7803.9 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.18853 | acc=0.9501 | tpr=0.9155 | fpr=0.0493 | 7960.5 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.18876 | acc=0.9499 | tpr=0.9130 | fpr=0.0495 | 7965.7 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.18908 | acc=0.9495 | tpr=0.9129 | fpr=0.0498 | 8244.6 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.19015 | acc=0.9495 | tpr=0.9150 | fpr=0.0499 | 8409.8 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.18917 | acc=0.9498 | tpr=0.9172 | fpr=0.0496 | 10129.0 samples/s | 39.6 steps/s
Avg test loss: 0.18898, Avg test acc: 0.94983, Avg tpr: 0.91719, Avg fpr: 0.04958, total FA: 6884

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.44061 | acc=0.0570 | tpr=0.9823 | fpr=0.9597 | 6243.2 samples/s | 24.4 steps/s
[Step= 100] | Loss=0.44248 | acc=0.0546 | tpr=0.9851 | fpr=0.9628 | 7186.0 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.44266 | acc=0.0542 | tpr=0.9827 | fpr=0.9629 | 7965.5 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.44246 | acc=0.0540 | tpr=0.9825 | fpr=0.9629 | 8211.8 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.44276 | acc=0.0545 | tpr=0.9817 | fpr=0.9624 | 8253.0 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.44278 | acc=0.0547 | tpr=0.9840 | fpr=0.9622 | 7822.8 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.44285 | acc=0.0548 | tpr=0.9850 | fpr=0.9621 | 8260.9 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.44300 | acc=0.0549 | tpr=0.9825 | fpr=0.9620 | 8305.4 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.44297 | acc=0.0549 | tpr=0.9815 | fpr=0.9620 | 8585.7 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.44305 | acc=0.0545 | tpr=0.9819 | fpr=0.9622 | 7016.0 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.44295 | acc=0.0549 | tpr=0.9813 | fpr=0.9620 | 11321.8 samples/s | 44.2 steps/s
Avg test loss: 0.44293, Avg test acc: 0.05482, Avg tpr: 0.98138, Avg fpr: 0.96202, total FA: 133575

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.20556 | acc=0.9501 | tpr=0.8628 | fpr=0.0484 | 6086.3 samples/s | 23.8 steps/s
[Step= 100] | Loss=0.21058 | acc=0.9498 | tpr=0.8913 | fpr=0.0491 | 7519.5 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.21090 | acc=0.9486 | tpr=0.8862 | fpr=0.0502 | 8456.8 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.21062 | acc=0.9487 | tpr=0.8940 | fpr=0.0503 | 8351.1 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.21336 | acc=0.9482 | tpr=0.8908 | fpr=0.0508 | 7968.8 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.21630 | acc=0.9476 | tpr=0.8844 | fpr=0.0513 | 8331.1 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.21484 | acc=0.9478 | tpr=0.8860 | fpr=0.0511 | 7561.3 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.21475 | acc=0.9475 | tpr=0.8818 | fpr=0.0513 | 7725.8 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.21590 | acc=0.9469 | tpr=0.8773 | fpr=0.0518 | 8265.3 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.21705 | acc=0.9468 | tpr=0.8784 | fpr=0.0520 | 8236.8 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.21549 | acc=0.9472 | tpr=0.8810 | fpr=0.0516 | 10084.9 samples/s | 39.4 steps/s
Avg test loss: 0.21518, Avg test acc: 0.94721, Avg tpr: 0.88154, Avg fpr: 0.05160, total FA: 7164

server round 1/50

clients selected: [0 3 5 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.19913 | Reg=0.00297 | acc=0.8281 | L2-Norm=17.234 | L2-Norm(final)=3.035 | 7126.9 samples/s | 111.4 steps/s
[Step=2050 Epoch=10.0] | Loss=0.26088 | Reg=0.00297 | acc=0.7812 | L2-Norm=17.232 | L2-Norm(final)=3.020 | 4986.8 samples/s | 77.9 steps/s
[Step=2100 Epoch=10.2] | Loss=0.25340 | Reg=0.00297 | acc=0.7812 | L2-Norm=17.232 | L2-Norm(final)=3.047 | 5584.7 samples/s | 87.3 steps/s
[Step=2150 Epoch=10.5] | Loss=0.24794 | Reg=0.00297 | acc=0.8750 | L2-Norm=17.232 | L2-Norm(final)=3.079 | 5605.0 samples/s | 87.6 steps/s
[Step=2200 Epoch=10.7] | Loss=0.24335 | Reg=0.00297 | acc=0.8281 | L2-Norm=17.232 | L2-Norm(final)=3.121 | 8590.8 samples/s | 134.2 steps/s
[Step=2250 Epoch=11.0] | Loss=0.24030 | Reg=0.00297 | acc=0.7969 | L2-Norm=17.232 | L2-Norm(final)=3.169 | 2749.5 samples/s | 43.0 steps/s
[Step=2300 Epoch=11.2] | Loss=0.23971 | Reg=0.00297 | acc=0.7344 | L2-Norm=17.232 | L2-Norm(final)=3.217 | 5525.5 samples/s | 86.3 steps/s
[Step=2350 Epoch=11.5] | Loss=0.23747 | Reg=0.00297 | acc=0.8281 | L2-Norm=17.232 | L2-Norm(final)=3.265 | 5459.0 samples/s | 85.3 steps/s
[Step=2400 Epoch=11.7] | Loss=0.23634 | Reg=0.00297 | acc=0.7500 | L2-Norm=17.232 | L2-Norm(final)=3.314 | 7693.2 samples/s | 120.2 steps/s
[Step=2450 Epoch=11.9] | Loss=0.23449 | Reg=0.00297 | acc=0.7812 | L2-Norm=17.232 | L2-Norm(final)=3.363 | 2842.5 samples/s | 44.4 steps/s
[Step=2500 Epoch=12.2] | Loss=0.23387 | Reg=0.00297 | acc=0.7500 | L2-Norm=17.232 | L2-Norm(final)=3.412 | 5457.8 samples/s | 85.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.21776 | Reg=0.00297 | acc=0.8125 | L2-Norm=17.232 | L2-Norm(final)=3.893 | 6694.1 samples/s | 104.6 steps/s
[Step=2550 Epoch=12.4] | Loss=0.21013 | Reg=0.00303 | acc=0.8750 | L2-Norm=17.401 | L2-Norm(final)=3.861 | 4489.2 samples/s | 70.1 steps/s
[Step=2600 Epoch=12.7] | Loss=0.18328 | Reg=0.00305 | acc=0.8594 | L2-Norm=17.475 | L2-Norm(final)=3.858 | 4756.1 samples/s | 74.3 steps/s
[Step=2650 Epoch=12.9] | Loss=0.16260 | Reg=0.00307 | acc=0.9219 | L2-Norm=17.514 | L2-Norm(final)=3.859 | 4819.1 samples/s | 75.3 steps/s
[Step=2700 Epoch=13.2] | Loss=0.15059 | Reg=0.00308 | acc=0.9375 | L2-Norm=17.539 | L2-Norm(final)=3.861 | 6833.6 samples/s | 106.8 steps/s
[Step=2750 Epoch=13.4] | Loss=0.14597 | Reg=0.00309 | acc=0.8906 | L2-Norm=17.569 | L2-Norm(final)=3.861 | 2497.2 samples/s | 39.0 steps/s
[Step=2800 Epoch=13.7] | Loss=0.13580 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.601 | L2-Norm(final)=3.863 | 4802.5 samples/s | 75.0 steps/s
[Step=2850 Epoch=13.9] | Loss=0.12816 | Reg=0.00311 | acc=0.8906 | L2-Norm=17.628 | L2-Norm(final)=3.867 | 4739.8 samples/s | 74.1 steps/s
[Step=2900 Epoch=14.1] | Loss=0.12259 | Reg=0.00312 | acc=0.9062 | L2-Norm=17.651 | L2-Norm(final)=3.871 | 6304.5 samples/s | 98.5 steps/s
[Step=2950 Epoch=14.4] | Loss=0.11418 | Reg=0.00312 | acc=0.9688 | L2-Norm=17.672 | L2-Norm(final)=3.876 | 2582.0 samples/s | 40.3 steps/s
[Step=3000 Epoch=14.6] | Loss=0.10871 | Reg=0.00313 | acc=0.9688 | L2-Norm=17.691 | L2-Norm(final)=3.880 | 4811.1 samples/s | 75.2 steps/s
[Step=3050 Epoch=14.9] | Loss=0.10392 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.708 | L2-Norm(final)=3.886 | 4827.0 samples/s | 75.4 steps/s
[Step=3100 Epoch=15.1] | Loss=0.09976 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.725 | L2-Norm(final)=3.891 | 5655.5 samples/s | 88.4 steps/s
[Step=3150 Epoch=15.4] | Loss=0.09458 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.741 | L2-Norm(final)=3.896 | 2702.4 samples/s | 42.2 steps/s
[Step=3200 Epoch=15.6] | Loss=0.08992 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.755 | L2-Norm(final)=3.903 | 4815.6 samples/s | 75.2 steps/s
[Step=3250 Epoch=15.8] | Loss=0.08609 | Reg=0.00316 | acc=0.9375 | L2-Norm=17.768 | L2-Norm(final)=3.909 | 4776.6 samples/s | 74.6 steps/s
[Step=3300 Epoch=16.1] | Loss=0.08291 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.781 | L2-Norm(final)=3.915 | 5238.4 samples/s | 81.9 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07967 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.792 | L2-Norm(final)=3.921 | 2800.2 samples/s | 43.8 steps/s
[Step=3400 Epoch=16.6] | Loss=0.07681 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.803 | L2-Norm(final)=3.927 | 4839.1 samples/s | 75.6 steps/s
[Step=3450 Epoch=16.8] | Loss=0.07405 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.812 | L2-Norm(final)=3.933 | 4713.9 samples/s | 73.7 steps/s
[Step=3500 Epoch=17.1] | Loss=0.07181 | Reg=0.00318 | acc=0.9688 | L2-Norm=17.821 | L2-Norm(final)=3.939 | 4901.1 samples/s | 76.6 steps/s
[Step=3550 Epoch=17.3] | Loss=0.06952 | Reg=0.00318 | acc=0.9688 | L2-Norm=17.830 | L2-Norm(final)=3.944 | 2907.0 samples/s | 45.4 steps/s
[Step=3600 Epoch=17.6] | Loss=0.06740 | Reg=0.00318 | acc=0.9531 | L2-Norm=17.839 | L2-Norm(final)=3.950 | 4796.9 samples/s | 75.0 steps/s
[Step=3650 Epoch=17.8] | Loss=0.06589 | Reg=0.00319 | acc=0.9531 | L2-Norm=17.847 | L2-Norm(final)=3.955 | 4831.3 samples/s | 75.5 steps/s
[Step=3700 Epoch=18.0] | Loss=0.06402 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.855 | L2-Norm(final)=3.961 | 4681.8 samples/s | 73.2 steps/s
[Step=3750 Epoch=18.3] | Loss=0.06280 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.863 | L2-Norm(final)=3.965 | 2966.9 samples/s | 46.4 steps/s
[Step=3800 Epoch=18.5] | Loss=0.06117 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.871 | L2-Norm(final)=3.970 | 4796.6 samples/s | 74.9 steps/s
[Step=3850 Epoch=18.8] | Loss=0.05975 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.878 | L2-Norm(final)=3.974 | 4841.8 samples/s | 75.7 steps/s
[Step=3900 Epoch=19.0] | Loss=0.05866 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.885 | L2-Norm(final)=3.978 | 4684.7 samples/s | 73.2 steps/s
[Step=3950 Epoch=19.3] | Loss=0.05731 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.892 | L2-Norm(final)=3.982 | 2944.6 samples/s | 46.0 steps/s
[Step=4000 Epoch=19.5] | Loss=0.05601 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.899 | L2-Norm(final)=3.986 | 4760.8 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step4000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33189 | Reg=0.00297 | acc=0.5938 | L2-Norm=17.234 | L2-Norm(final)=1.981 | 7284.8 samples/s | 113.8 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.30295 | Reg=0.00297 | acc=0.7656 | L2-Norm=17.234 | L2-Norm(final)=2.025 | 5513.8 samples/s | 86.2 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.28485 | Reg=0.00297 | acc=0.8125 | L2-Norm=17.234 | L2-Norm(final)=2.103 | 6196.7 samples/s | 96.8 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.27516 | Reg=0.00297 | acc=0.7188 | L2-Norm=17.234 | L2-Norm(final)=2.188 | 6263.2 samples/s | 97.9 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.26816 | Reg=0.00297 | acc=0.6719 | L2-Norm=17.234 | L2-Norm(final)=2.266 | 10315.2 samples/s | 161.2 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.26021 | Reg=0.00297 | acc=0.7969 | L2-Norm=17.234 | L2-Norm(final)=2.342 | 2862.6 samples/s | 44.7 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.25726 | Reg=0.00297 | acc=0.8281 | L2-Norm=17.234 | L2-Norm(final)=2.416 | 6209.7 samples/s | 97.0 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.25349 | Reg=0.00297 | acc=0.8281 | L2-Norm=17.234 | L2-Norm(final)=2.484 | 6405.0 samples/s | 100.1 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.25072 | Reg=0.00297 | acc=0.8281 | L2-Norm=17.234 | L2-Norm(final)=2.547 | 8680.0 samples/s | 135.6 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.24875 | Reg=0.00297 | acc=0.8281 | L2-Norm=17.234 | L2-Norm(final)=2.607 | 3037.7 samples/s | 47.5 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.24593 | Reg=0.00297 | acc=0.7812 | L2-Norm=17.234 | L2-Norm(final)=2.664 | 6081.0 samples/s | 95.0 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.24430 | Reg=0.00297 | acc=0.7969 | L2-Norm=17.234 | L2-Norm(final)=3.224 | 7282.7 samples/s | 113.8 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.21242 | Reg=0.00294 | acc=0.8750 | L2-Norm=17.136 | L2-Norm(final)=3.237 | 4333.3 samples/s | 67.7 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.18303 | Reg=0.00294 | acc=0.9219 | L2-Norm=17.140 | L2-Norm(final)=3.252 | 4671.4 samples/s | 73.0 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.16756 | Reg=0.00294 | acc=0.9062 | L2-Norm=17.151 | L2-Norm(final)=3.265 | 4818.1 samples/s | 75.3 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.15543 | Reg=0.00295 | acc=0.9375 | L2-Norm=17.165 | L2-Norm(final)=3.276 | 6818.9 samples/s | 106.5 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.14637 | Reg=0.00295 | acc=0.9531 | L2-Norm=17.188 | L2-Norm(final)=3.287 | 2491.9 samples/s | 38.9 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.13570 | Reg=0.00296 | acc=0.9688 | L2-Norm=17.215 | L2-Norm(final)=3.299 | 4743.8 samples/s | 74.1 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.12650 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.241 | L2-Norm(final)=3.312 | 4836.8 samples/s | 75.6 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.12094 | Reg=0.00298 | acc=0.9062 | L2-Norm=17.267 | L2-Norm(final)=3.324 | 6210.6 samples/s | 97.0 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.11363 | Reg=0.00299 | acc=0.9844 | L2-Norm=17.293 | L2-Norm(final)=3.336 | 2608.5 samples/s | 40.8 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.10712 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.321 | L2-Norm(final)=3.349 | 4695.6 samples/s | 73.4 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.10188 | Reg=0.00301 | acc=0.9531 | L2-Norm=17.347 | L2-Norm(final)=3.361 | 4771.4 samples/s | 74.6 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.09822 | Reg=0.00302 | acc=0.9375 | L2-Norm=17.373 | L2-Norm(final)=3.372 | 5707.9 samples/s | 89.2 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.09394 | Reg=0.00303 | acc=0.9688 | L2-Norm=17.399 | L2-Norm(final)=3.383 | 2684.6 samples/s | 41.9 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.09011 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.423 | L2-Norm(final)=3.393 | 4900.6 samples/s | 76.6 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.08662 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.446 | L2-Norm(final)=3.403 | 4661.8 samples/s | 72.8 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.08345 | Reg=0.00305 | acc=0.9375 | L2-Norm=17.468 | L2-Norm(final)=3.412 | 5315.0 samples/s | 83.0 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.08371 | Reg=0.00306 | acc=0.9375 | L2-Norm=17.492 | L2-Norm(final)=3.419 | 2820.9 samples/s | 44.1 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.08233 | Reg=0.00307 | acc=0.9844 | L2-Norm=17.520 | L2-Norm(final)=3.424 | 4766.6 samples/s | 74.5 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.08050 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.547 | L2-Norm(final)=3.428 | 4757.8 samples/s | 74.3 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.07818 | Reg=0.00309 | acc=0.9375 | L2-Norm=17.574 | L2-Norm(final)=3.433 | 4888.1 samples/s | 76.4 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.07576 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.598 | L2-Norm(final)=3.439 | 2900.9 samples/s | 45.3 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.07326 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.621 | L2-Norm(final)=3.444 | 4778.4 samples/s | 74.7 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.07119 | Reg=0.00311 | acc=0.9688 | L2-Norm=17.642 | L2-Norm(final)=3.450 | 4776.1 samples/s | 74.6 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.06916 | Reg=0.00312 | acc=0.9688 | L2-Norm=17.663 | L2-Norm(final)=3.455 | 4816.1 samples/s | 75.3 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.06940 | Reg=0.00313 | acc=0.8594 | L2-Norm=17.682 | L2-Norm(final)=3.460 | 2969.7 samples/s | 46.4 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.06992 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.707 | L2-Norm(final)=3.462 | 4831.7 samples/s | 75.5 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.06882 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.733 | L2-Norm(final)=3.464 | 4763.5 samples/s | 74.4 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.06751 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.757 | L2-Norm(final)=3.467 | 4769.2 samples/s | 74.5 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.06591 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.780 | L2-Norm(final)=3.470 | 3002.0 samples/s | 46.9 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06431 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.802 | L2-Norm(final)=3.473 | 4699.7 samples/s | 73.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step2000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.30715 | Reg=0.00297 | acc=0.6250 | L2-Norm=17.234 | L2-Norm(final)=1.980 | 7311.6 samples/s | 114.2 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.29659 | Reg=0.00297 | acc=0.7969 | L2-Norm=17.234 | L2-Norm(final)=1.984 | 5125.0 samples/s | 80.1 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.26825 | Reg=0.00297 | acc=0.8438 | L2-Norm=17.234 | L2-Norm(final)=2.041 | 9270.8 samples/s | 144.9 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.24765 | Reg=0.00297 | acc=0.9062 | L2-Norm=17.234 | L2-Norm(final)=2.131 | 2784.8 samples/s | 43.5 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.23150 | Reg=0.00297 | acc=0.8906 | L2-Norm=17.234 | L2-Norm(final)=2.237 | 7957.3 samples/s | 124.3 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.21799 | Reg=0.00297 | acc=0.9375 | L2-Norm=17.234 | L2-Norm(final)=2.349 | 2892.4 samples/s | 45.2 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.20688 | Reg=0.00297 | acc=0.8750 | L2-Norm=17.234 | L2-Norm(final)=2.464 | 7303.0 samples/s | 114.1 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.19792 | Reg=0.00297 | acc=0.9219 | L2-Norm=17.234 | L2-Norm(final)=2.580 | 3011.7 samples/s | 47.1 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.19005 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.234 | L2-Norm(final)=2.694 | 6537.3 samples/s | 102.1 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.18296 | Reg=0.00297 | acc=0.8750 | L2-Norm=17.234 | L2-Norm(final)=2.806 | 3143.9 samples/s | 49.1 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.17672 | Reg=0.00297 | acc=0.9375 | L2-Norm=17.234 | L2-Norm(final)=2.916 | 6139.4 samples/s | 95.9 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.7] | Loss=0.16801 | Reg=0.00297 | acc=0.8750 | L2-Norm=17.234 | L2-Norm(final)=3.999 | 7045.8 samples/s | 110.1 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.06014 | Reg=0.00295 | acc=0.9688 | L2-Norm=17.163 | L2-Norm(final)=4.051 | 4091.3 samples/s | 63.9 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.03591 | Reg=0.00294 | acc=0.9844 | L2-Norm=17.149 | L2-Norm(final)=4.071 | 6633.8 samples/s | 103.7 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.02600 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.137 | L2-Norm(final)=4.084 | 2400.7 samples/s | 37.5 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.01998 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.125 | L2-Norm(final)=4.095 | 6033.0 samples/s | 94.3 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01652 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.110 | L2-Norm(final)=4.103 | 2493.8 samples/s | 39.0 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01382 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.092 | L2-Norm(final)=4.110 | 5482.2 samples/s | 85.7 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.01186 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.071 | L2-Norm(final)=4.116 | 2619.8 samples/s | 40.9 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.01038 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.047 | L2-Norm(final)=4.120 | 4905.8 samples/s | 76.7 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.00924 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.021 | L2-Norm(final)=4.124 | 2708.1 samples/s | 42.3 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.00832 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.993 | L2-Norm(final)=4.127 | 4635.9 samples/s | 72.4 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.00756 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.964 | L2-Norm(final)=4.130 | 2816.8 samples/s | 44.0 steps/s
[Step=1100 Epoch=10.4] | Loss=0.00693 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.935 | L2-Norm(final)=4.132 | 4485.8 samples/s | 70.1 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00640 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.905 | L2-Norm(final)=4.134 | 2901.9 samples/s | 45.3 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00595 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.874 | L2-Norm(final)=4.136 | 4551.3 samples/s | 71.1 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00555 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.843 | L2-Norm(final)=4.137 | 2871.0 samples/s | 44.9 steps/s
[Step=1300 Epoch=12.3] | Loss=0.00521 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.812 | L2-Norm(final)=4.139 | 4606.5 samples/s | 72.0 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00490 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.780 | L2-Norm(final)=4.140 | 2934.8 samples/s | 45.9 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00463 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.748 | L2-Norm(final)=4.141 | 4449.1 samples/s | 69.5 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00439 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.715 | L2-Norm(final)=4.143 | 6792.6 samples/s | 106.1 steps/s
[Step=1500 Epoch=14.2] | Loss=0.00417 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.683 | L2-Norm(final)=4.144 | 2367.0 samples/s | 37.0 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00397 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.650 | L2-Norm(final)=4.145 | 6204.3 samples/s | 96.9 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00379 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.617 | L2-Norm(final)=4.146 | 2457.5 samples/s | 38.4 steps/s
[Step=1650 Epoch=15.6] | Loss=0.00362 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.583 | L2-Norm(final)=4.147 | 5670.2 samples/s | 88.6 steps/s
[Step=1700 Epoch=16.1] | Loss=0.00347 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.550 | L2-Norm(final)=4.147 | 2566.5 samples/s | 40.1 steps/s
[Step=1750 Epoch=16.6] | Loss=0.00334 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.516 | L2-Norm(final)=4.148 | 5121.5 samples/s | 80.0 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00321 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.483 | L2-Norm(final)=4.149 | 2669.7 samples/s | 41.7 steps/s
[Step=1850 Epoch=17.5] | Loss=0.00309 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.449 | L2-Norm(final)=4.150 | 4818.2 samples/s | 75.3 steps/s
[Step=1900 Epoch=18.0] | Loss=0.00298 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.415 | L2-Norm(final)=4.151 | 2838.4 samples/s | 44.4 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00288 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.380 | L2-Norm(final)=4.151 | 4474.8 samples/s | 69.9 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00278 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.346 | L2-Norm(final)=4.152 | 2911.3 samples/s | 45.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step2000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch=19.1] | Loss=0.10177 | Reg=0.00297 | acc=0.9531 | L2-Norm=17.234 | L2-Norm(final)=4.058 | 7171.5 samples/s | 112.1 steps/s
[Step=2050 Epoch=19.6] | Loss=0.11590 | Reg=0.00297 | acc=0.9375 | L2-Norm=17.221 | L2-Norm(final)=4.232 | 4618.2 samples/s | 72.2 steps/s
[Step=2100 Epoch=20.1] | Loss=0.11072 | Reg=0.00297 | acc=0.9219 | L2-Norm=17.220 | L2-Norm(final)=4.442 | 8436.1 samples/s | 131.8 steps/s
[Step=2150 Epoch=20.5] | Loss=0.10559 | Reg=0.00296 | acc=0.9375 | L2-Norm=17.219 | L2-Norm(final)=4.630 | 2588.4 samples/s | 40.4 steps/s
[Step=2200 Epoch=21.0] | Loss=0.10324 | Reg=0.00296 | acc=0.9062 | L2-Norm=17.219 | L2-Norm(final)=4.802 | 7553.5 samples/s | 118.0 steps/s
[Step=2250 Epoch=21.5] | Loss=0.10116 | Reg=0.00296 | acc=0.9688 | L2-Norm=17.219 | L2-Norm(final)=4.955 | 2658.3 samples/s | 41.5 steps/s
[Step=2300 Epoch=22.0] | Loss=0.09874 | Reg=0.00296 | acc=0.9688 | L2-Norm=17.218 | L2-Norm(final)=5.097 | 6925.3 samples/s | 108.2 steps/s
[Step=2350 Epoch=22.4] | Loss=0.09613 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.218 | L2-Norm(final)=5.228 | 2771.0 samples/s | 43.3 steps/s
[Step=2400 Epoch=22.9] | Loss=0.09450 | Reg=0.00296 | acc=0.9062 | L2-Norm=17.218 | L2-Norm(final)=5.352 | 6255.7 samples/s | 97.7 steps/s
[Step=2450 Epoch=23.4] | Loss=0.09337 | Reg=0.00296 | acc=0.9688 | L2-Norm=17.218 | L2-Norm(final)=5.468 | 2881.5 samples/s | 45.0 steps/s
[Step=2500 Epoch=23.9] | Loss=0.09188 | Reg=0.00296 | acc=0.9219 | L2-Norm=17.218 | L2-Norm(final)=5.578 | 5732.1 samples/s | 89.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.9] | Loss=0.09096 | Reg=0.00296 | acc=0.9531 | L2-Norm=17.218 | L2-Norm(final)=6.649 | 7122.8 samples/s | 111.3 steps/s
[Step=2550 Epoch=24.4] | Loss=0.14104 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.719 | L2-Norm(final)=6.542 | 4058.5 samples/s | 63.4 steps/s
[Step=2600 Epoch=24.8] | Loss=0.07675 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.841 | L2-Norm(final)=6.539 | 6655.8 samples/s | 104.0 steps/s
[Step=2650 Epoch=25.3] | Loss=0.05241 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.861 | L2-Norm(final)=6.544 | 2391.6 samples/s | 37.4 steps/s
[Step=2700 Epoch=25.8] | Loss=0.03965 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.854 | L2-Norm(final)=6.550 | 6224.8 samples/s | 97.3 steps/s
[Step=2750 Epoch=26.3] | Loss=0.03187 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.837 | L2-Norm(final)=6.554 | 2457.9 samples/s | 38.4 steps/s
[Step=2800 Epoch=26.7] | Loss=0.02659 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.815 | L2-Norm(final)=6.558 | 5721.3 samples/s | 89.4 steps/s
[Step=2850 Epoch=27.2] | Loss=0.02282 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.789 | L2-Norm(final)=6.562 | 2565.6 samples/s | 40.1 steps/s
[Step=2900 Epoch=27.7] | Loss=0.01997 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.762 | L2-Norm(final)=6.565 | 5309.4 samples/s | 83.0 steps/s
[Step=2950 Epoch=28.2] | Loss=0.01776 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.734 | L2-Norm(final)=6.567 | 2655.4 samples/s | 41.5 steps/s
[Step=3000 Epoch=28.6] | Loss=0.01599 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.706 | L2-Norm(final)=6.569 | 4985.0 samples/s | 77.9 steps/s
[Step=3050 Epoch=29.1] | Loss=0.01454 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.677 | L2-Norm(final)=6.571 | 2739.3 samples/s | 42.8 steps/s
[Step=3100 Epoch=29.6] | Loss=0.01333 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.648 | L2-Norm(final)=6.573 | 4683.9 samples/s | 73.2 steps/s
[Step=3150 Epoch=30.1] | Loss=0.01231 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.619 | L2-Norm(final)=6.574 | 2899.0 samples/s | 45.3 steps/s
[Step=3200 Epoch=30.6] | Loss=0.01143 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.590 | L2-Norm(final)=6.576 | 4372.7 samples/s | 68.3 steps/s
[Step=3250 Epoch=31.0] | Loss=0.01067 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.562 | L2-Norm(final)=6.577 | 2933.4 samples/s | 45.8 steps/s
[Step=3300 Epoch=31.5] | Loss=0.01001 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.533 | L2-Norm(final)=6.578 | 4438.3 samples/s | 69.3 steps/s
[Step=3350 Epoch=32.0] | Loss=0.00942 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.504 | L2-Norm(final)=6.579 | 2883.7 samples/s | 45.1 steps/s
[Step=3400 Epoch=32.5] | Loss=0.00890 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.476 | L2-Norm(final)=6.580 | 4626.5 samples/s | 72.3 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00843 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.447 | L2-Norm(final)=6.581 | 2853.5 samples/s | 44.6 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00801 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.419 | L2-Norm(final)=6.582 | 4640.0 samples/s | 72.5 steps/s
[Step=3550 Epoch=33.9] | Loss=0.00763 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.391 | L2-Norm(final)=6.583 | 7167.0 samples/s | 112.0 steps/s
[Step=3600 Epoch=34.4] | Loss=0.00728 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.363 | L2-Norm(final)=6.584 | 2317.8 samples/s | 36.2 steps/s
[Step=3650 Epoch=34.9] | Loss=0.00697 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.335 | L2-Norm(final)=6.585 | 6701.3 samples/s | 104.7 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00668 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.307 | L2-Norm(final)=6.585 | 2409.2 samples/s | 37.6 steps/s
[Step=3750 Epoch=35.8] | Loss=0.00641 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.279 | L2-Norm(final)=6.586 | 6014.8 samples/s | 94.0 steps/s
[Step=3800 Epoch=36.3] | Loss=0.00616 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.251 | L2-Norm(final)=6.587 | 2468.3 samples/s | 38.6 steps/s
[Step=3850 Epoch=36.8] | Loss=0.00594 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.223 | L2-Norm(final)=6.587 | 5696.8 samples/s | 89.0 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00573 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.195 | L2-Norm(final)=6.588 | 2551.5 samples/s | 39.9 steps/s
[Step=3950 Epoch=37.7] | Loss=0.00553 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.168 | L2-Norm(final)=6.589 | 5341.6 samples/s | 83.5 steps/s
[Step=4000 Epoch=38.2] | Loss=0.00534 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.140 | L2-Norm(final)=6.589 | 2627.9 samples/s | 41.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step4000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33897 | Reg=0.00297 | acc=0.5312 | L2-Norm=17.234 | L2-Norm(final)=1.980 | 7872.9 samples/s | 123.0 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.29437 | Reg=0.00297 | acc=0.7031 | L2-Norm=17.234 | L2-Norm(final)=1.988 | 5209.3 samples/s | 81.4 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.26754 | Reg=0.00297 | acc=0.7812 | L2-Norm=17.234 | L2-Norm(final)=2.043 | 8956.5 samples/s | 139.9 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.24729 | Reg=0.00297 | acc=0.8594 | L2-Norm=17.234 | L2-Norm(final)=2.130 | 2805.9 samples/s | 43.8 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.23188 | Reg=0.00297 | acc=0.9375 | L2-Norm=17.234 | L2-Norm(final)=2.234 | 7711.2 samples/s | 120.5 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.21951 | Reg=0.00297 | acc=0.9375 | L2-Norm=17.234 | L2-Norm(final)=2.345 | 2917.9 samples/s | 45.6 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.20858 | Reg=0.00297 | acc=0.9375 | L2-Norm=17.234 | L2-Norm(final)=2.460 | 7060.3 samples/s | 110.3 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.19932 | Reg=0.00297 | acc=0.9375 | L2-Norm=17.234 | L2-Norm(final)=2.573 | 3077.2 samples/s | 48.1 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.19183 | Reg=0.00297 | acc=0.9062 | L2-Norm=17.234 | L2-Norm(final)=2.685 | 6180.2 samples/s | 96.6 steps/s
[Step= 450 Epoch= 4.2] | Loss=0.18469 | Reg=0.00297 | acc=0.9531 | L2-Norm=17.234 | L2-Norm(final)=2.794 | 3252.3 samples/s | 50.8 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.17900 | Reg=0.00297 | acc=0.9688 | L2-Norm=17.234 | L2-Norm(final)=2.901 | 5867.0 samples/s | 91.7 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.7] | Loss=0.11651 | Reg=0.00297 | acc=0.9375 | L2-Norm=17.234 | L2-Norm(final)=3.957 | 6401.0 samples/s | 100.0 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.08940 | Reg=0.00295 | acc=0.9531 | L2-Norm=17.162 | L2-Norm(final)=3.981 | 4280.7 samples/s | 66.9 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.05481 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.153 | L2-Norm(final)=4.003 | 6436.0 samples/s | 100.6 steps/s
[Step= 650 Epoch= 6.1] | Loss=0.03857 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.142 | L2-Norm(final)=4.020 | 2459.8 samples/s | 38.4 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.03015 | Reg=0.00293 | acc=0.9844 | L2-Norm=17.127 | L2-Norm(final)=4.033 | 5634.3 samples/s | 88.0 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.03019 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.121 | L2-Norm(final)=4.039 | 2531.2 samples/s | 39.6 steps/s
[Step= 800 Epoch= 7.5] | Loss=0.02581 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.123 | L2-Norm(final)=4.041 | 5263.9 samples/s | 82.2 steps/s
[Step= 850 Epoch= 8.0] | Loss=0.02235 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.120 | L2-Norm(final)=4.045 | 2659.3 samples/s | 41.6 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.01962 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.113 | L2-Norm(final)=4.048 | 4839.0 samples/s | 75.6 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01748 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.103 | L2-Norm(final)=4.051 | 2782.4 samples/s | 43.5 steps/s
[Step=1000 Epoch= 9.4] | Loss=0.01575 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.090 | L2-Norm(final)=4.054 | 4599.4 samples/s | 71.9 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.01433 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.075 | L2-Norm(final)=4.057 | 2926.0 samples/s | 45.7 steps/s
[Step=1100 Epoch=10.4] | Loss=0.01314 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.058 | L2-Norm(final)=4.059 | 4576.8 samples/s | 71.5 steps/s
[Step=1150 Epoch=10.8] | Loss=0.01213 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.040 | L2-Norm(final)=4.062 | 2867.8 samples/s | 44.8 steps/s
[Step=1200 Epoch=11.3] | Loss=0.01127 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.020 | L2-Norm(final)=4.064 | 4518.1 samples/s | 70.6 steps/s
[Step=1250 Epoch=11.8] | Loss=0.01052 | Reg=0.00289 | acc=1.0000 | L2-Norm=17.000 | L2-Norm(final)=4.066 | 3213.4 samples/s | 50.2 steps/s
[Step=1300 Epoch=12.2] | Loss=0.00987 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.979 | L2-Norm(final)=4.067 | 3892.3 samples/s | 60.8 steps/s
[Step=1350 Epoch=12.7] | Loss=0.00929 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.958 | L2-Norm(final)=4.069 | 6689.3 samples/s | 104.5 steps/s
[Step=1400 Epoch=13.2] | Loss=0.00878 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.936 | L2-Norm(final)=4.070 | 2422.0 samples/s | 37.8 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00832 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.913 | L2-Norm(final)=4.072 | 5890.5 samples/s | 92.0 steps/s
[Step=1500 Epoch=14.1] | Loss=0.00790 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.890 | L2-Norm(final)=4.073 | 2504.3 samples/s | 39.1 steps/s
[Step=1550 Epoch=14.6] | Loss=0.00753 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.867 | L2-Norm(final)=4.074 | 5310.9 samples/s | 83.0 steps/s
[Step=1600 Epoch=15.1] | Loss=0.00719 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.843 | L2-Norm(final)=4.076 | 2616.4 samples/s | 40.9 steps/s
[Step=1650 Epoch=15.5] | Loss=0.00687 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.819 | L2-Norm(final)=4.077 | 4907.0 samples/s | 76.7 steps/s
[Step=1700 Epoch=16.0] | Loss=0.00659 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.794 | L2-Norm(final)=4.078 | 2763.1 samples/s | 43.2 steps/s
[Step=1750 Epoch=16.5] | Loss=0.00633 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.770 | L2-Norm(final)=4.079 | 4570.4 samples/s | 71.4 steps/s
[Step=1800 Epoch=17.0] | Loss=0.00608 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.745 | L2-Norm(final)=4.080 | 2877.1 samples/s | 45.0 steps/s
[Step=1850 Epoch=17.4] | Loss=0.00586 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.720 | L2-Norm(final)=4.081 | 4602.0 samples/s | 71.9 steps/s
[Step=1900 Epoch=17.9] | Loss=0.00565 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.695 | L2-Norm(final)=4.082 | 2897.0 samples/s | 45.3 steps/s
[Step=1950 Epoch=18.4] | Loss=0.00546 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.669 | L2-Norm(final)=4.083 | 4541.5 samples/s | 71.0 steps/s
[Step=2000 Epoch=18.8] | Loss=0.00527 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.644 | L2-Norm(final)=4.084 | 3028.8 samples/s | 47.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.16745 | acc=0.9273 | tpr=0.9618 | fpr=0.1477 | 5958.7 samples/s | 23.3 steps/s
Avg test loss: 0.17164, Avg test acc: 0.92596, Avg tpr: 0.96077, Avg fpr: 0.15062, total FA: 1175

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.16992 | acc=0.9172 | tpr=0.9563 | fpr=0.1677 | 5981.8 samples/s | 23.4 steps/s
Avg test loss: 0.17464, Avg test acc: 0.91522, Avg tpr: 0.95366, Avg fpr: 0.16934, total FA: 1321

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.16262 | acc=0.9261 | tpr=0.9613 | fpr=0.1504 | 6147.9 samples/s | 24.0 steps/s
Avg test loss: 0.16937, Avg test acc: 0.92347, Avg tpr: 0.95844, Avg fpr: 0.15344, total FA: 1197

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.15331 | acc=0.9194 | tpr=0.9236 | fpr=0.0897 | 6120.0 samples/s | 23.9 steps/s
Avg test loss: 0.15767, Avg test acc: 0.91830, Avg tpr: 0.92295, Avg fpr: 0.09191, total FA: 717

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.32852 | acc=0.6785 | tpr=0.9889 | fpr=0.9955 | 6019.7 samples/s | 23.5 steps/s
Avg test loss: 0.32729, Avg test acc: 0.68146, Avg tpr: 0.98939, Avg fpr: 0.99577, total FA: 7768

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.30884 | acc=0.3247 | tpr=0.0424 | fpr=0.0624 | 6008.7 samples/s | 23.5 steps/s
Avg test loss: 5.31101, Avg test acc: 0.32242, Avg tpr: 0.04237, Avg fpr: 0.06166, total FA: 481

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=0.32852 | acc=0.6785 | tpr=0.9889 | fpr=0.9955 | 6032.9 samples/s | 23.6 steps/s
Avg test loss: 0.32729, Avg test acc: 0.68146, Avg tpr: 0.98939, Avg fpr: 0.99577, total FA: 7768

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.20931 | acc=0.3243 | tpr=0.0423 | fpr=0.0634 | 6101.4 samples/s | 23.8 steps/s
Avg test loss: 4.22080, Avg test acc: 0.32250, Avg tpr: 0.04127, Avg fpr: 0.05897, total FA: 460

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.20984 | acc=0.3254 | tpr=0.0608 | fpr=0.1001 | 5923.4 samples/s | 23.1 steps/s
Avg test loss: 5.21820, Avg test acc: 0.32278, Avg tpr: 0.05974, Avg fpr: 0.09871, total FA: 770

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.19164 | acc=0.3229 | tpr=0.0334 | fpr=0.0486 | 6052.0 samples/s | 23.6 steps/s
Avg test loss: 5.20155, Avg test acc: 0.32062, Avg tpr: 0.03258, Avg fpr: 0.04589, total FA: 358

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.01396 | acc=0.1384 | tpr=0.9159 | fpr=0.8755 | 5976.0 samples/s | 23.3 steps/s
[Step= 100] | Loss=5.00411 | acc=0.1399 | tpr=0.8849 | fpr=0.8740 | 8472.9 samples/s | 33.1 steps/s
[Step= 150] | Loss=4.99772 | acc=0.1393 | tpr=0.8847 | fpr=0.8744 | 7533.7 samples/s | 29.4 steps/s
[Step= 200] | Loss=4.99612 | acc=0.1399 | tpr=0.8842 | fpr=0.8737 | 8177.8 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.00807 | acc=0.1395 | tpr=0.8777 | fpr=0.8740 | 7726.3 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.00074 | acc=0.1389 | tpr=0.8785 | fpr=0.8745 | 7753.0 samples/s | 30.3 steps/s
[Step= 350] | Loss=5.00027 | acc=0.1397 | tpr=0.8779 | fpr=0.8737 | 8457.1 samples/s | 33.0 steps/s
[Step= 400] | Loss=5.00138 | acc=0.1396 | tpr=0.8747 | fpr=0.8738 | 8942.2 samples/s | 34.9 steps/s
[Step= 450] | Loss=5.00410 | acc=0.1388 | tpr=0.8754 | fpr=0.8746 | 7943.3 samples/s | 31.0 steps/s
[Step= 500] | Loss=5.00237 | acc=0.1389 | tpr=0.8762 | fpr=0.8744 | 8127.0 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.00106 | acc=0.1390 | tpr=0.8770 | fpr=0.8744 | 9248.5 samples/s | 36.1 steps/s
Avg test loss: 5.00154, Avg test acc: 0.13892, Avg tpr: 0.87758, Avg fpr: 0.87450, total FA: 121423

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.28899 | acc=0.1445 | tpr=0.8496 | fpr=0.8681 | 5913.0 samples/s | 23.1 steps/s
[Step= 100] | Loss=4.25587 | acc=0.1474 | tpr=0.8337 | fpr=0.8654 | 8003.9 samples/s | 31.3 steps/s
[Step= 150] | Loss=4.25273 | acc=0.1469 | tpr=0.8271 | fpr=0.8656 | 7971.1 samples/s | 31.1 steps/s
[Step= 200] | Loss=4.24328 | acc=0.1468 | tpr=0.8219 | fpr=0.8655 | 8322.3 samples/s | 32.5 steps/s
[Step= 250] | Loss=4.24690 | acc=0.1469 | tpr=0.8262 | fpr=0.8655 | 7995.3 samples/s | 31.2 steps/s
[Step= 300] | Loss=4.24179 | acc=0.1463 | tpr=0.8233 | fpr=0.8660 | 8054.1 samples/s | 31.5 steps/s
[Step= 350] | Loss=4.24518 | acc=0.1460 | tpr=0.8203 | fpr=0.8663 | 7558.5 samples/s | 29.5 steps/s
[Step= 400] | Loss=4.24816 | acc=0.1461 | tpr=0.8184 | fpr=0.8661 | 8166.9 samples/s | 31.9 steps/s
[Step= 450] | Loss=4.25003 | acc=0.1457 | tpr=0.8204 | fpr=0.8665 | 7749.4 samples/s | 30.3 steps/s
[Step= 500] | Loss=4.24875 | acc=0.1459 | tpr=0.8233 | fpr=0.8663 | 8060.0 samples/s | 31.5 steps/s
[Step= 550] | Loss=4.24613 | acc=0.1462 | tpr=0.8237 | fpr=0.8661 | 10687.3 samples/s | 41.7 steps/s
Avg test loss: 4.24653, Avg test acc: 0.14610, Avg tpr: 0.82409, Avg fpr: 0.86622, total FA: 120273

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.39035 | acc=0.1309 | tpr=0.9558 | fpr=0.8839 | 6131.4 samples/s | 24.0 steps/s
[Step= 100] | Loss=4.37189 | acc=0.1318 | tpr=0.9488 | fpr=0.8835 | 8182.9 samples/s | 32.0 steps/s
[Step= 150] | Loss=4.38289 | acc=0.1309 | tpr=0.9366 | fpr=0.8840 | 7041.1 samples/s | 27.5 steps/s
[Step= 200] | Loss=4.38458 | acc=0.1305 | tpr=0.9311 | fpr=0.8841 | 8080.2 samples/s | 31.6 steps/s
[Step= 250] | Loss=4.39273 | acc=0.1305 | tpr=0.9284 | fpr=0.8841 | 7953.6 samples/s | 31.1 steps/s
[Step= 300] | Loss=4.39490 | acc=0.1300 | tpr=0.9244 | fpr=0.8845 | 7900.0 samples/s | 30.9 steps/s
[Step= 350] | Loss=4.39630 | acc=0.1297 | tpr=0.9230 | fpr=0.8847 | 8295.6 samples/s | 32.4 steps/s
[Step= 400] | Loss=4.40210 | acc=0.1295 | tpr=0.9212 | fpr=0.8849 | 7994.0 samples/s | 31.2 steps/s
[Step= 450] | Loss=4.40333 | acc=0.1291 | tpr=0.9226 | fpr=0.8853 | 8155.7 samples/s | 31.9 steps/s
[Step= 500] | Loss=4.40243 | acc=0.1294 | tpr=0.9247 | fpr=0.8850 | 8114.0 samples/s | 31.7 steps/s
[Step= 550] | Loss=4.40143 | acc=0.1294 | tpr=0.9248 | fpr=0.8850 | 11021.5 samples/s | 43.1 steps/s
Avg test loss: 4.40174, Avg test acc: 0.12937, Avg tpr: 0.92512, Avg fpr: 0.88510, total FA: 122894

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.15455 | acc=0.1573 | tpr=0.8230 | fpr=0.8546 | 6107.9 samples/s | 23.9 steps/s
[Step= 100] | Loss=4.13321 | acc=0.1570 | tpr=0.7996 | fpr=0.8550 | 8143.8 samples/s | 31.8 steps/s
[Step= 150] | Loss=4.12695 | acc=0.1568 | tpr=0.7911 | fpr=0.8549 | 7912.2 samples/s | 30.9 steps/s
[Step= 200] | Loss=4.11664 | acc=0.1570 | tpr=0.7880 | fpr=0.8545 | 7839.8 samples/s | 30.6 steps/s
[Step= 250] | Loss=4.12393 | acc=0.1572 | tpr=0.7886 | fpr=0.8543 | 7471.7 samples/s | 29.2 steps/s
[Step= 300] | Loss=4.12137 | acc=0.1568 | tpr=0.7898 | fpr=0.8547 | 8270.8 samples/s | 32.3 steps/s
[Step= 350] | Loss=4.12617 | acc=0.1566 | tpr=0.7915 | fpr=0.8549 | 8551.1 samples/s | 33.4 steps/s
[Step= 400] | Loss=4.12647 | acc=0.1569 | tpr=0.7932 | fpr=0.8546 | 7926.7 samples/s | 31.0 steps/s
[Step= 450] | Loss=4.12591 | acc=0.1569 | tpr=0.7911 | fpr=0.8546 | 8335.2 samples/s | 32.6 steps/s
[Step= 500] | Loss=4.12530 | acc=0.1571 | tpr=0.7899 | fpr=0.8543 | 8406.0 samples/s | 32.8 steps/s
[Step= 550] | Loss=4.12487 | acc=0.1570 | tpr=0.7899 | fpr=0.8545 | 9385.1 samples/s | 36.7 steps/s
Avg test loss: 4.12530, Avg test acc: 0.15688, Avg tpr: 0.79081, Avg fpr: 0.85464, total FA: 118665

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=0.44061 | acc=0.0570 | tpr=0.9823 | fpr=0.9597 | 6155.8 samples/s | 24.0 steps/s
[Step= 100] | Loss=0.44248 | acc=0.0546 | tpr=0.9851 | fpr=0.9628 | 7766.3 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.44266 | acc=0.0542 | tpr=0.9827 | fpr=0.9629 | 7622.3 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.44246 | acc=0.0540 | tpr=0.9825 | fpr=0.9629 | 8040.3 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.44276 | acc=0.0545 | tpr=0.9817 | fpr=0.9624 | 7884.9 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.44278 | acc=0.0547 | tpr=0.9840 | fpr=0.9622 | 8744.0 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.44285 | acc=0.0548 | tpr=0.9850 | fpr=0.9621 | 7912.7 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.44300 | acc=0.0549 | tpr=0.9825 | fpr=0.9620 | 8388.9 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.44297 | acc=0.0549 | tpr=0.9815 | fpr=0.9620 | 8175.2 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.44305 | acc=0.0545 | tpr=0.9819 | fpr=0.9622 | 8457.2 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.44295 | acc=0.0549 | tpr=0.9813 | fpr=0.9620 | 8809.5 samples/s | 34.4 steps/s
Avg test loss: 0.44293, Avg test acc: 0.05482, Avg tpr: 0.98138, Avg fpr: 0.96202, total FA: 133575

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14700 | acc=0.9590 | tpr=0.8805 | fpr=0.0396 | 5961.0 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.15233 | acc=0.9584 | tpr=0.8955 | fpr=0.0404 | 7576.5 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.15180 | acc=0.9582 | tpr=0.8991 | fpr=0.0407 | 7840.6 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.15117 | acc=0.9578 | tpr=0.9016 | fpr=0.0412 | 8424.4 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.15188 | acc=0.9576 | tpr=0.8961 | fpr=0.0413 | 7992.8 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.15326 | acc=0.9573 | tpr=0.8887 | fpr=0.0414 | 7808.3 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.15311 | acc=0.9573 | tpr=0.8910 | fpr=0.0415 | 8370.9 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.15331 | acc=0.9571 | tpr=0.8889 | fpr=0.0416 | 7180.4 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.15454 | acc=0.9567 | tpr=0.8895 | fpr=0.0421 | 8725.8 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.15484 | acc=0.9565 | tpr=0.8912 | fpr=0.0424 | 7189.0 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.15441 | acc=0.9567 | tpr=0.8918 | fpr=0.0422 | 10378.8 samples/s | 40.5 steps/s
Avg test loss: 0.15424, Avg test acc: 0.95669, Avg tpr: 0.89184, Avg fpr: 0.04213, total FA: 5850

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.44061 | acc=0.0570 | tpr=0.9823 | fpr=0.9597 | 6015.0 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.44248 | acc=0.0546 | tpr=0.9851 | fpr=0.9628 | 7918.0 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.44266 | acc=0.0542 | tpr=0.9827 | fpr=0.9629 | 7436.8 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.44246 | acc=0.0540 | tpr=0.9825 | fpr=0.9629 | 8264.6 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.44276 | acc=0.0545 | tpr=0.9817 | fpr=0.9624 | 8203.7 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.44278 | acc=0.0547 | tpr=0.9840 | fpr=0.9622 | 8579.8 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.44285 | acc=0.0548 | tpr=0.9850 | fpr=0.9621 | 7743.9 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.44300 | acc=0.0549 | tpr=0.9825 | fpr=0.9620 | 8124.7 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.44297 | acc=0.0549 | tpr=0.9815 | fpr=0.9620 | 7946.1 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.44305 | acc=0.0545 | tpr=0.9819 | fpr=0.9622 | 7955.3 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.44295 | acc=0.0549 | tpr=0.9813 | fpr=0.9620 | 7668.8 samples/s | 30.0 steps/s
Avg test loss: 0.44293, Avg test acc: 0.05482, Avg tpr: 0.98138, Avg fpr: 0.96202, total FA: 133575

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.22424 | acc=0.9466 | tpr=0.9381 | fpr=0.0532 | 5718.4 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.23074 | acc=0.9462 | tpr=0.9318 | fpr=0.0536 | 8457.0 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.23536 | acc=0.9452 | tpr=0.9323 | fpr=0.0546 | 8593.8 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.23671 | acc=0.9455 | tpr=0.9366 | fpr=0.0543 | 7795.1 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.23777 | acc=0.9454 | tpr=0.9293 | fpr=0.0543 | 8117.6 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.24002 | acc=0.9446 | tpr=0.9244 | fpr=0.0550 | 8020.6 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.23866 | acc=0.9449 | tpr=0.9261 | fpr=0.0547 | 7258.8 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.23984 | acc=0.9445 | tpr=0.9240 | fpr=0.0551 | 8346.3 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.24044 | acc=0.9442 | tpr=0.9231 | fpr=0.0554 | 8270.7 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.24167 | acc=0.9439 | tpr=0.9238 | fpr=0.0557 | 8468.3 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.24048 | acc=0.9442 | tpr=0.9252 | fpr=0.0554 | 7482.2 samples/s | 29.2 steps/s
Avg test loss: 0.24028, Avg test acc: 0.94428, Avg tpr: 0.92512, Avg fpr: 0.05537, total FA: 7688

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11850 | acc=0.9617 | tpr=0.8805 | fpr=0.0368 | 5911.8 samples/s | 23.1 steps/s
[Step= 100] | Loss=0.12071 | acc=0.9612 | tpr=0.9062 | fpr=0.0378 | 7332.4 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.12158 | acc=0.9606 | tpr=0.8977 | fpr=0.0382 | 7918.5 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.12176 | acc=0.9606 | tpr=0.9038 | fpr=0.0384 | 8632.7 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.12218 | acc=0.9606 | tpr=0.9039 | fpr=0.0384 | 7997.1 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.12455 | acc=0.9598 | tpr=0.8982 | fpr=0.0391 | 8507.4 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.12414 | acc=0.9600 | tpr=0.8979 | fpr=0.0389 | 8012.9 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.12501 | acc=0.9596 | tpr=0.8950 | fpr=0.0392 | 8212.2 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.12626 | acc=0.9591 | tpr=0.8924 | fpr=0.0396 | 8089.8 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.12638 | acc=0.9591 | tpr=0.8952 | fpr=0.0398 | 5799.7 samples/s | 22.7 steps/s
[Step= 550] | Loss=0.12610 | acc=0.9593 | tpr=0.8969 | fpr=0.0395 | 11884.6 samples/s | 46.4 steps/s
Avg test loss: 0.12594, Avg test acc: 0.95932, Avg tpr: 0.89699, Avg fpr: 0.03955, total FA: 5491

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.20556 | acc=0.9501 | tpr=0.8628 | fpr=0.0484 | 5890.3 samples/s | 23.0 steps/s
[Step= 100] | Loss=0.21058 | acc=0.9498 | tpr=0.8913 | fpr=0.0491 | 8368.0 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.21090 | acc=0.9486 | tpr=0.8862 | fpr=0.0502 | 8036.3 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.21062 | acc=0.9487 | tpr=0.8940 | fpr=0.0503 | 7462.7 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.21336 | acc=0.9482 | tpr=0.8908 | fpr=0.0508 | 8597.5 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.21630 | acc=0.9476 | tpr=0.8844 | fpr=0.0513 | 8229.1 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.21484 | acc=0.9478 | tpr=0.8860 | fpr=0.0511 | 8150.2 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.21475 | acc=0.9475 | tpr=0.8818 | fpr=0.0513 | 7761.4 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.21590 | acc=0.9469 | tpr=0.8773 | fpr=0.0518 | 8775.5 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.21705 | acc=0.9468 | tpr=0.8784 | fpr=0.0520 | 6021.9 samples/s | 23.5 steps/s
[Step= 550] | Loss=0.21549 | acc=0.9472 | tpr=0.8810 | fpr=0.0516 | 9893.0 samples/s | 38.6 steps/s
Avg test loss: 0.21518, Avg test acc: 0.94721, Avg tpr: 0.88154, Avg fpr: 0.05160, total FA: 7164

server round 2/50

clients selected: [2 3 4 8 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 9.7] | Loss=0.20331 | Reg=0.00266 | acc=0.8281 | L2-Norm=16.322 | L2-Norm(final)=3.049 | 6636.8 samples/s | 103.7 steps/s
[Step=2050 Epoch=10.0] | Loss=0.19989 | Reg=0.00266 | acc=0.8750 | L2-Norm=16.321 | L2-Norm(final)=3.165 | 5198.9 samples/s | 81.2 steps/s
[Step=2100 Epoch=10.2] | Loss=0.20049 | Reg=0.00266 | acc=0.8281 | L2-Norm=16.321 | L2-Norm(final)=3.292 | 5549.0 samples/s | 86.7 steps/s
[Step=2150 Epoch=10.5] | Loss=0.19734 | Reg=0.00266 | acc=0.8438 | L2-Norm=16.321 | L2-Norm(final)=3.406 | 5499.5 samples/s | 85.9 steps/s
[Step=2200 Epoch=10.7] | Loss=0.19695 | Reg=0.00266 | acc=0.7812 | L2-Norm=16.321 | L2-Norm(final)=3.507 | 8679.6 samples/s | 135.6 steps/s
[Step=2250 Epoch=11.0] | Loss=0.19633 | Reg=0.00266 | acc=0.8750 | L2-Norm=16.321 | L2-Norm(final)=3.595 | 2718.1 samples/s | 42.5 steps/s
[Step=2300 Epoch=11.2] | Loss=0.19426 | Reg=0.00266 | acc=0.7656 | L2-Norm=16.321 | L2-Norm(final)=3.679 | 5484.2 samples/s | 85.7 steps/s
[Step=2350 Epoch=11.5] | Loss=0.19272 | Reg=0.00266 | acc=0.7812 | L2-Norm=16.321 | L2-Norm(final)=3.758 | 5480.7 samples/s | 85.6 steps/s
[Step=2400 Epoch=11.7] | Loss=0.19149 | Reg=0.00266 | acc=0.8438 | L2-Norm=16.321 | L2-Norm(final)=3.832 | 7693.1 samples/s | 120.2 steps/s
[Step=2450 Epoch=11.9] | Loss=0.18986 | Reg=0.00266 | acc=0.8750 | L2-Norm=16.321 | L2-Norm(final)=3.904 | 2840.0 samples/s | 44.4 steps/s
[Step=2500 Epoch=12.2] | Loss=0.18999 | Reg=0.00266 | acc=0.8125 | L2-Norm=16.321 | L2-Norm(final)=3.973 | 5482.3 samples/s | 85.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.11946 | Reg=0.00266 | acc=0.9375 | L2-Norm=16.321 | L2-Norm(final)=4.625 | 7386.2 samples/s | 115.4 steps/s
[Step=2550 Epoch=12.4] | Loss=0.17522 | Reg=0.00273 | acc=0.8438 | L2-Norm=16.537 | L2-Norm(final)=4.594 | 4248.7 samples/s | 66.4 steps/s
[Step=2600 Epoch=12.7] | Loss=0.15299 | Reg=0.00278 | acc=0.8750 | L2-Norm=16.673 | L2-Norm(final)=4.586 | 4824.2 samples/s | 75.4 steps/s
[Step=2650 Epoch=12.9] | Loss=0.13895 | Reg=0.00281 | acc=0.9375 | L2-Norm=16.751 | L2-Norm(final)=4.582 | 4777.1 samples/s | 74.6 steps/s
[Step=2700 Epoch=13.2] | Loss=0.12991 | Reg=0.00283 | acc=0.9219 | L2-Norm=16.811 | L2-Norm(final)=4.580 | 6874.7 samples/s | 107.4 steps/s
[Step=2750 Epoch=13.4] | Loss=0.11907 | Reg=0.00284 | acc=0.9844 | L2-Norm=16.860 | L2-Norm(final)=4.579 | 2493.1 samples/s | 39.0 steps/s
[Step=2800 Epoch=13.6] | Loss=0.11117 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.906 | L2-Norm(final)=4.580 | 4777.1 samples/s | 74.6 steps/s
[Step=2850 Epoch=13.9] | Loss=0.10554 | Reg=0.00287 | acc=0.9844 | L2-Norm=16.950 | L2-Norm(final)=4.581 | 4770.2 samples/s | 74.5 steps/s
[Step=2900 Epoch=14.1] | Loss=0.10083 | Reg=0.00289 | acc=0.9844 | L2-Norm=16.990 | L2-Norm(final)=4.582 | 6240.5 samples/s | 97.5 steps/s
[Step=2950 Epoch=14.4] | Loss=0.09464 | Reg=0.00290 | acc=0.9531 | L2-Norm=17.029 | L2-Norm(final)=4.584 | 2614.7 samples/s | 40.9 steps/s
[Step=3000 Epoch=14.6] | Loss=0.08920 | Reg=0.00291 | acc=0.9688 | L2-Norm=17.065 | L2-Norm(final)=4.588 | 4743.4 samples/s | 74.1 steps/s
[Step=3050 Epoch=14.9] | Loss=0.08545 | Reg=0.00292 | acc=0.9531 | L2-Norm=17.097 | L2-Norm(final)=4.591 | 4824.9 samples/s | 75.4 steps/s
[Step=3100 Epoch=15.1] | Loss=0.08218 | Reg=0.00293 | acc=0.9688 | L2-Norm=17.128 | L2-Norm(final)=4.594 | 5667.4 samples/s | 88.6 steps/s
[Step=3150 Epoch=15.3] | Loss=0.07867 | Reg=0.00294 | acc=0.9844 | L2-Norm=17.157 | L2-Norm(final)=4.597 | 2695.5 samples/s | 42.1 steps/s
[Step=3200 Epoch=15.6] | Loss=0.07519 | Reg=0.00295 | acc=0.9844 | L2-Norm=17.185 | L2-Norm(final)=4.601 | 4827.4 samples/s | 75.4 steps/s
[Step=3250 Epoch=15.8] | Loss=0.07280 | Reg=0.00296 | acc=0.9844 | L2-Norm=17.212 | L2-Norm(final)=4.603 | 4774.2 samples/s | 74.6 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07079 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.237 | L2-Norm(final)=4.606 | 5261.0 samples/s | 82.2 steps/s
[Step=3350 Epoch=16.3] | Loss=0.06875 | Reg=0.00298 | acc=0.9844 | L2-Norm=17.261 | L2-Norm(final)=4.608 | 2793.4 samples/s | 43.6 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06671 | Reg=0.00299 | acc=0.9688 | L2-Norm=17.285 | L2-Norm(final)=4.610 | 4865.5 samples/s | 76.0 steps/s
[Step=3450 Epoch=16.8] | Loss=0.06487 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.308 | L2-Norm(final)=4.612 | 4695.0 samples/s | 73.4 steps/s
[Step=3500 Epoch=17.1] | Loss=0.06298 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.330 | L2-Norm(final)=4.614 | 4883.8 samples/s | 76.3 steps/s
[Step=3550 Epoch=17.3] | Loss=0.06128 | Reg=0.00301 | acc=0.9844 | L2-Norm=17.350 | L2-Norm(final)=4.616 | 2939.1 samples/s | 45.9 steps/s
[Step=3600 Epoch=17.5] | Loss=0.05963 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.368 | L2-Norm(final)=4.618 | 4892.2 samples/s | 76.4 steps/s
[Step=3650 Epoch=17.8] | Loss=0.05796 | Reg=0.00302 | acc=0.9844 | L2-Norm=17.386 | L2-Norm(final)=4.620 | 4681.6 samples/s | 73.2 steps/s
[Step=3700 Epoch=18.0] | Loss=0.05635 | Reg=0.00303 | acc=0.9531 | L2-Norm=17.402 | L2-Norm(final)=4.622 | 4798.9 samples/s | 75.0 steps/s
[Step=3750 Epoch=18.3] | Loss=0.05496 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.418 | L2-Norm(final)=4.624 | 2946.8 samples/s | 46.0 steps/s
[Step=3800 Epoch=18.5] | Loss=0.05367 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.433 | L2-Norm(final)=4.627 | 4787.9 samples/s | 74.8 steps/s
[Step=3850 Epoch=18.8] | Loss=0.05266 | Reg=0.00305 | acc=0.9688 | L2-Norm=17.448 | L2-Norm(final)=4.629 | 4802.8 samples/s | 75.0 steps/s
[Step=3900 Epoch=19.0] | Loss=0.05141 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.462 | L2-Norm(final)=4.631 | 4784.9 samples/s | 74.8 steps/s
[Step=3950 Epoch=19.2] | Loss=0.05034 | Reg=0.00306 | acc=0.9844 | L2-Norm=17.476 | L2-Norm(final)=4.633 | 2963.3 samples/s | 46.3 steps/s
[Step=4000 Epoch=19.5] | Loss=0.04910 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.488 | L2-Norm(final)=4.635 | 4807.9 samples/s | 75.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step4000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.15516 | Reg=0.00266 | acc=0.8594 | L2-Norm=16.322 | L2-Norm(final)=3.579 | 7383.6 samples/s | 115.4 steps/s
[Step=2050 Epoch=10.0] | Loss=0.19030 | Reg=0.00266 | acc=0.8281 | L2-Norm=16.320 | L2-Norm(final)=3.651 | 4896.1 samples/s | 76.5 steps/s
[Step=2100 Epoch=10.2] | Loss=0.18482 | Reg=0.00266 | acc=0.8750 | L2-Norm=16.320 | L2-Norm(final)=3.743 | 5691.0 samples/s | 88.9 steps/s
[Step=2150 Epoch=10.5] | Loss=0.18348 | Reg=0.00266 | acc=0.8594 | L2-Norm=16.320 | L2-Norm(final)=3.826 | 5569.5 samples/s | 87.0 steps/s
[Step=2200 Epoch=10.7] | Loss=0.18147 | Reg=0.00266 | acc=0.8594 | L2-Norm=16.320 | L2-Norm(final)=3.903 | 8479.2 samples/s | 132.5 steps/s
[Step=2250 Epoch=11.0] | Loss=0.17920 | Reg=0.00266 | acc=0.8594 | L2-Norm=16.320 | L2-Norm(final)=3.975 | 2744.3 samples/s | 42.9 steps/s
[Step=2300 Epoch=11.2] | Loss=0.17777 | Reg=0.00266 | acc=0.8438 | L2-Norm=16.320 | L2-Norm(final)=4.043 | 5421.5 samples/s | 84.7 steps/s
[Step=2350 Epoch=11.5] | Loss=0.17695 | Reg=0.00266 | acc=0.7969 | L2-Norm=16.320 | L2-Norm(final)=4.108 | 5534.7 samples/s | 86.5 steps/s
[Step=2400 Epoch=11.7] | Loss=0.17660 | Reg=0.00266 | acc=0.8906 | L2-Norm=16.320 | L2-Norm(final)=4.169 | 7780.0 samples/s | 121.6 steps/s
[Step=2450 Epoch=11.9] | Loss=0.17559 | Reg=0.00266 | acc=0.8594 | L2-Norm=16.320 | L2-Norm(final)=4.226 | 2801.5 samples/s | 43.8 steps/s
[Step=2500 Epoch=12.2] | Loss=0.17491 | Reg=0.00266 | acc=0.7344 | L2-Norm=16.320 | L2-Norm(final)=4.282 | 5630.6 samples/s | 88.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.14505 | Reg=0.00266 | acc=0.8438 | L2-Norm=16.320 | L2-Norm(final)=4.833 | 7244.8 samples/s | 113.2 steps/s
[Step=2550 Epoch=12.4] | Loss=0.15599 | Reg=0.00271 | acc=0.8906 | L2-Norm=16.468 | L2-Norm(final)=4.830 | 4351.7 samples/s | 68.0 steps/s
[Step=2600 Epoch=12.7] | Loss=0.14079 | Reg=0.00274 | acc=0.8594 | L2-Norm=16.558 | L2-Norm(final)=4.829 | 4739.3 samples/s | 74.1 steps/s
[Step=2650 Epoch=12.9] | Loss=0.12734 | Reg=0.00276 | acc=0.9375 | L2-Norm=16.614 | L2-Norm(final)=4.830 | 4847.0 samples/s | 75.7 steps/s
[Step=2700 Epoch=13.2] | Loss=0.12089 | Reg=0.00277 | acc=0.9062 | L2-Norm=16.657 | L2-Norm(final)=4.828 | 6721.8 samples/s | 105.0 steps/s
[Step=2750 Epoch=13.4] | Loss=0.11451 | Reg=0.00279 | acc=0.9531 | L2-Norm=16.701 | L2-Norm(final)=4.827 | 2530.3 samples/s | 39.5 steps/s
[Step=2800 Epoch=13.7] | Loss=0.10622 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.743 | L2-Norm(final)=4.828 | 4799.7 samples/s | 75.0 steps/s
[Step=2850 Epoch=13.9] | Loss=0.09906 | Reg=0.00282 | acc=0.9375 | L2-Norm=16.780 | L2-Norm(final)=4.831 | 4724.5 samples/s | 73.8 steps/s
[Step=2900 Epoch=14.1] | Loss=0.09410 | Reg=0.00283 | acc=0.9688 | L2-Norm=16.812 | L2-Norm(final)=4.833 | 6278.5 samples/s | 98.1 steps/s
[Step=2950 Epoch=14.4] | Loss=0.08923 | Reg=0.00284 | acc=0.9531 | L2-Norm=16.842 | L2-Norm(final)=4.835 | 2588.2 samples/s | 40.4 steps/s
[Step=3000 Epoch=14.6] | Loss=0.08410 | Reg=0.00285 | acc=0.9531 | L2-Norm=16.870 | L2-Norm(final)=4.839 | 4763.1 samples/s | 74.4 steps/s
[Step=3050 Epoch=14.9] | Loss=0.08030 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.896 | L2-Norm(final)=4.842 | 4853.0 samples/s | 75.8 steps/s
[Step=3100 Epoch=15.1] | Loss=0.07689 | Reg=0.00286 | acc=0.9844 | L2-Norm=16.919 | L2-Norm(final)=4.846 | 5694.7 samples/s | 89.0 steps/s
[Step=3150 Epoch=15.4] | Loss=0.07362 | Reg=0.00287 | acc=0.9844 | L2-Norm=16.942 | L2-Norm(final)=4.849 | 2697.4 samples/s | 42.1 steps/s
[Step=3200 Epoch=15.6] | Loss=0.07056 | Reg=0.00288 | acc=0.9375 | L2-Norm=16.964 | L2-Norm(final)=4.853 | 4800.9 samples/s | 75.0 steps/s
[Step=3250 Epoch=15.8] | Loss=0.06813 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.985 | L2-Norm(final)=4.856 | 4811.9 samples/s | 75.2 steps/s
[Step=3300 Epoch=16.1] | Loss=0.06580 | Reg=0.00289 | acc=0.9688 | L2-Norm=17.006 | L2-Norm(final)=4.860 | 5280.4 samples/s | 82.5 steps/s
[Step=3350 Epoch=16.3] | Loss=0.06325 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.026 | L2-Norm(final)=4.863 | 2817.8 samples/s | 44.0 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06124 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.045 | L2-Norm(final)=4.867 | 4729.6 samples/s | 73.9 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05919 | Reg=0.00291 | acc=0.9688 | L2-Norm=17.064 | L2-Norm(final)=4.871 | 4780.2 samples/s | 74.7 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05777 | Reg=0.00292 | acc=0.9688 | L2-Norm=17.081 | L2-Norm(final)=4.874 | 4932.5 samples/s | 77.1 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05658 | Reg=0.00292 | acc=0.9688 | L2-Norm=17.098 | L2-Norm(final)=4.877 | 2903.5 samples/s | 45.4 steps/s
[Step=3600 Epoch=17.6] | Loss=0.05478 | Reg=0.00293 | acc=0.9688 | L2-Norm=17.115 | L2-Norm(final)=4.880 | 4752.9 samples/s | 74.3 steps/s
[Step=3650 Epoch=17.8] | Loss=0.05371 | Reg=0.00294 | acc=0.9844 | L2-Norm=17.132 | L2-Norm(final)=4.883 | 4812.3 samples/s | 75.2 steps/s
[Step=3700 Epoch=18.0] | Loss=0.05260 | Reg=0.00294 | acc=0.9688 | L2-Norm=17.148 | L2-Norm(final)=4.885 | 4817.5 samples/s | 75.3 steps/s
[Step=3750 Epoch=18.3] | Loss=0.05137 | Reg=0.00295 | acc=0.9844 | L2-Norm=17.164 | L2-Norm(final)=4.887 | 2964.9 samples/s | 46.3 steps/s
[Step=3800 Epoch=18.5] | Loss=0.05005 | Reg=0.00295 | acc=0.9688 | L2-Norm=17.179 | L2-Norm(final)=4.889 | 4838.2 samples/s | 75.6 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04893 | Reg=0.00296 | acc=0.9844 | L2-Norm=17.193 | L2-Norm(final)=4.891 | 4703.8 samples/s | 73.5 steps/s
[Step=3900 Epoch=19.0] | Loss=0.04806 | Reg=0.00296 | acc=0.9688 | L2-Norm=17.207 | L2-Norm(final)=4.893 | 4896.4 samples/s | 76.5 steps/s
[Step=3950 Epoch=19.3] | Loss=0.04729 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.221 | L2-Norm(final)=4.894 | 2941.5 samples/s | 46.0 steps/s
[Step=4000 Epoch=19.5] | Loss=0.04611 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.235 | L2-Norm(final)=4.896 | 4748.0 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step4000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.32562 | Reg=0.00266 | acc=0.5625 | L2-Norm=16.322 | L2-Norm(final)=1.981 | 7657.0 samples/s | 119.6 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.27828 | Reg=0.00266 | acc=0.8281 | L2-Norm=16.322 | L2-Norm(final)=2.063 | 5250.9 samples/s | 82.0 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.25945 | Reg=0.00266 | acc=0.7812 | L2-Norm=16.322 | L2-Norm(final)=2.192 | 6442.4 samples/s | 100.7 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.24676 | Reg=0.00266 | acc=0.8750 | L2-Norm=16.322 | L2-Norm(final)=2.330 | 6344.7 samples/s | 99.1 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.23656 | Reg=0.00266 | acc=0.8125 | L2-Norm=16.322 | L2-Norm(final)=2.467 | 10003.3 samples/s | 156.3 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.23002 | Reg=0.00266 | acc=0.8281 | L2-Norm=16.322 | L2-Norm(final)=2.596 | 2825.1 samples/s | 44.1 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.22478 | Reg=0.00266 | acc=0.8594 | L2-Norm=16.322 | L2-Norm(final)=2.718 | 6408.5 samples/s | 100.1 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.21960 | Reg=0.00266 | acc=0.7812 | L2-Norm=16.322 | L2-Norm(final)=2.833 | 6096.8 samples/s | 95.3 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.21583 | Reg=0.00266 | acc=0.7812 | L2-Norm=16.322 | L2-Norm(final)=2.943 | 9693.5 samples/s | 151.5 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.21193 | Reg=0.00266 | acc=0.8281 | L2-Norm=16.322 | L2-Norm(final)=3.048 | 2876.6 samples/s | 44.9 steps/s
[Step= 500 Epoch= 2.5] | Loss=0.20868 | Reg=0.00266 | acc=0.7969 | L2-Norm=16.322 | L2-Norm(final)=3.148 | 6369.6 samples/s | 99.5 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.5] | Loss=0.16689 | Reg=0.00266 | acc=0.8594 | L2-Norm=16.322 | L2-Norm(final)=4.139 | 7099.9 samples/s | 110.9 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.17227 | Reg=0.00266 | acc=0.8594 | L2-Norm=16.309 | L2-Norm(final)=4.142 | 4392.2 samples/s | 68.6 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.15028 | Reg=0.00267 | acc=0.9219 | L2-Norm=16.330 | L2-Norm(final)=4.143 | 4787.2 samples/s | 74.8 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.13896 | Reg=0.00267 | acc=0.8906 | L2-Norm=16.350 | L2-Norm(final)=4.142 | 4739.1 samples/s | 74.0 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.12759 | Reg=0.00268 | acc=0.9062 | L2-Norm=16.374 | L2-Norm(final)=4.147 | 7014.3 samples/s | 109.6 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.11688 | Reg=0.00269 | acc=0.8906 | L2-Norm=16.402 | L2-Norm(final)=4.153 | 1837.5 samples/s | 28.7 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10893 | Reg=0.00270 | acc=0.9062 | L2-Norm=16.434 | L2-Norm(final)=4.161 | 4804.2 samples/s | 75.1 steps/s
[Step= 850 Epoch= 4.2] | Loss=0.10354 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.468 | L2-Norm(final)=4.169 | 4529.5 samples/s | 70.8 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.09965 | Reg=0.00272 | acc=0.9844 | L2-Norm=16.501 | L2-Norm(final)=4.178 | 6583.4 samples/s | 102.9 steps/s
[Step= 950 Epoch= 4.7] | Loss=0.09299 | Reg=0.00273 | acc=0.9844 | L2-Norm=16.536 | L2-Norm(final)=4.186 | 2472.0 samples/s | 38.6 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.08844 | Reg=0.00275 | acc=0.9844 | L2-Norm=16.570 | L2-Norm(final)=4.195 | 4714.7 samples/s | 73.7 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.08382 | Reg=0.00276 | acc=0.9844 | L2-Norm=16.602 | L2-Norm(final)=4.204 | 4815.4 samples/s | 75.2 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.08053 | Reg=0.00277 | acc=0.9375 | L2-Norm=16.632 | L2-Norm(final)=4.213 | 6158.7 samples/s | 96.2 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.07699 | Reg=0.00278 | acc=0.9688 | L2-Norm=16.662 | L2-Norm(final)=4.222 | 2568.8 samples/s | 40.1 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.07367 | Reg=0.00279 | acc=0.9688 | L2-Norm=16.692 | L2-Norm(final)=4.231 | 4775.6 samples/s | 74.6 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.07078 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.721 | L2-Norm(final)=4.240 | 4763.0 samples/s | 74.4 steps/s
[Step=1300 Epoch= 6.4] | Loss=0.06833 | Reg=0.00281 | acc=0.9375 | L2-Norm=16.749 | L2-Norm(final)=4.249 | 5897.9 samples/s | 92.2 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.06621 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.777 | L2-Norm(final)=4.257 | 2625.0 samples/s | 41.0 steps/s
[Step=1400 Epoch= 6.9] | Loss=0.06379 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.804 | L2-Norm(final)=4.266 | 4776.6 samples/s | 74.6 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.06202 | Reg=0.00283 | acc=0.9688 | L2-Norm=16.830 | L2-Norm(final)=4.273 | 4787.3 samples/s | 74.8 steps/s
[Step=1500 Epoch= 7.4] | Loss=0.06077 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.857 | L2-Norm(final)=4.281 | 5533.4 samples/s | 86.5 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.05907 | Reg=0.00285 | acc=0.9844 | L2-Norm=16.884 | L2-Norm(final)=4.287 | 2716.3 samples/s | 42.4 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.05756 | Reg=0.00286 | acc=0.9844 | L2-Norm=16.910 | L2-Norm(final)=4.293 | 4739.1 samples/s | 74.0 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.05618 | Reg=0.00287 | acc=0.9375 | L2-Norm=16.936 | L2-Norm(final)=4.299 | 4719.4 samples/s | 73.7 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.05526 | Reg=0.00288 | acc=0.9688 | L2-Norm=16.961 | L2-Norm(final)=4.304 | 5275.8 samples/s | 82.4 steps/s
[Step=1750 Epoch= 8.6] | Loss=0.05408 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.986 | L2-Norm(final)=4.308 | 2821.9 samples/s | 44.1 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.05262 | Reg=0.00289 | acc=0.9688 | L2-Norm=17.009 | L2-Norm(final)=4.312 | 4673.7 samples/s | 73.0 steps/s
[Step=1850 Epoch= 9.1] | Loss=0.05166 | Reg=0.00290 | acc=0.9844 | L2-Norm=17.032 | L2-Norm(final)=4.317 | 4739.6 samples/s | 74.1 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.05039 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.054 | L2-Norm(final)=4.321 | 4947.1 samples/s | 77.3 steps/s
[Step=1950 Epoch= 9.6] | Loss=0.04962 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.076 | L2-Norm(final)=4.325 | 2838.7 samples/s | 44.4 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.04854 | Reg=0.00293 | acc=0.9844 | L2-Norm=17.097 | L2-Norm(final)=4.329 | 4825.4 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step2000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch=18.9] | Loss=0.11672 | Reg=0.00266 | acc=0.8750 | L2-Norm=16.322 | L2-Norm(final)=4.110 | 6650.6 samples/s | 103.9 steps/s
[Step=2050 Epoch=19.3] | Loss=0.11030 | Reg=0.00266 | acc=0.9219 | L2-Norm=16.313 | L2-Norm(final)=4.296 | 4810.5 samples/s | 75.2 steps/s
[Step=2100 Epoch=19.8] | Loss=0.10125 | Reg=0.00266 | acc=0.9062 | L2-Norm=16.311 | L2-Norm(final)=4.491 | 8040.4 samples/s | 125.6 steps/s
[Step=2150 Epoch=20.3] | Loss=0.09595 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.311 | L2-Norm(final)=4.662 | 2584.9 samples/s | 40.4 steps/s
[Step=2200 Epoch=20.7] | Loss=0.09157 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.311 | L2-Norm(final)=4.818 | 7015.8 samples/s | 109.6 steps/s
[Step=2250 Epoch=21.2] | Loss=0.08999 | Reg=0.00266 | acc=0.9688 | L2-Norm=16.311 | L2-Norm(final)=4.962 | 2705.3 samples/s | 42.3 steps/s
[Step=2300 Epoch=21.7] | Loss=0.08668 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.311 | L2-Norm(final)=5.096 | 6283.3 samples/s | 98.2 steps/s
[Step=2350 Epoch=22.1] | Loss=0.08406 | Reg=0.00266 | acc=0.9688 | L2-Norm=16.311 | L2-Norm(final)=5.221 | 2891.3 samples/s | 45.2 steps/s
[Step=2400 Epoch=22.6] | Loss=0.08226 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.311 | L2-Norm(final)=5.339 | 5473.2 samples/s | 85.5 steps/s
[Step=2450 Epoch=23.1] | Loss=0.08063 | Reg=0.00266 | acc=0.9531 | L2-Norm=16.311 | L2-Norm(final)=5.450 | 3018.8 samples/s | 47.2 steps/s
[Step=2500 Epoch=23.6] | Loss=0.07917 | Reg=0.00266 | acc=0.9375 | L2-Norm=16.310 | L2-Norm(final)=5.556 | 5292.2 samples/s | 82.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.6] | Loss=0.08891 | Reg=0.00266 | acc=0.9375 | L2-Norm=16.310 | L2-Norm(final)=6.597 | 6815.9 samples/s | 106.5 steps/s
[Step=2550 Epoch=24.0] | Loss=0.04072 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.583 | L2-Norm(final)=6.598 | 4134.1 samples/s | 64.6 steps/s
[Step=2600 Epoch=24.5] | Loss=0.02471 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.709 | L2-Norm(final)=6.586 | 6430.6 samples/s | 100.5 steps/s
[Step=2650 Epoch=25.0] | Loss=0.01755 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.745 | L2-Norm(final)=6.583 | 2405.5 samples/s | 37.6 steps/s
[Step=2700 Epoch=25.4] | Loss=0.01474 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.749 | L2-Norm(final)=6.582 | 5827.7 samples/s | 91.1 steps/s
[Step=2750 Epoch=25.9] | Loss=0.01237 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.747 | L2-Norm(final)=6.580 | 2510.9 samples/s | 39.2 steps/s
[Step=2800 Epoch=26.4] | Loss=0.01036 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.738 | L2-Norm(final)=6.580 | 5287.9 samples/s | 82.6 steps/s
[Step=2850 Epoch=26.9] | Loss=0.00897 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.721 | L2-Norm(final)=6.580 | 2635.3 samples/s | 41.2 steps/s
[Step=2900 Epoch=27.3] | Loss=0.00786 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.699 | L2-Norm(final)=6.581 | 4796.4 samples/s | 74.9 steps/s
[Step=2950 Epoch=27.8] | Loss=0.00699 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.673 | L2-Norm(final)=6.582 | 2819.0 samples/s | 44.0 steps/s
[Step=3000 Epoch=28.3] | Loss=0.00629 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.646 | L2-Norm(final)=6.583 | 4471.3 samples/s | 69.9 steps/s
[Step=3050 Epoch=28.7] | Loss=0.00572 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.616 | L2-Norm(final)=6.583 | 2873.3 samples/s | 44.9 steps/s
[Step=3100 Epoch=29.2] | Loss=0.00525 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.585 | L2-Norm(final)=6.584 | 4514.2 samples/s | 70.5 steps/s
[Step=3150 Epoch=29.7] | Loss=0.00484 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.554 | L2-Norm(final)=6.584 | 2853.5 samples/s | 44.6 steps/s
[Step=3200 Epoch=30.2] | Loss=0.00450 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.521 | L2-Norm(final)=6.585 | 4599.2 samples/s | 71.9 steps/s
[Step=3250 Epoch=30.6] | Loss=0.00420 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.489 | L2-Norm(final)=6.585 | 3205.3 samples/s | 50.1 steps/s
[Step=3300 Epoch=31.1] | Loss=0.00394 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.455 | L2-Norm(final)=6.586 | 3992.9 samples/s | 62.4 steps/s
[Step=3350 Epoch=31.6] | Loss=0.00371 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.422 | L2-Norm(final)=6.586 | 6546.5 samples/s | 102.3 steps/s
[Step=3400 Epoch=32.0] | Loss=0.00350 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.389 | L2-Norm(final)=6.587 | 2387.5 samples/s | 37.3 steps/s
[Step=3450 Epoch=32.5] | Loss=0.00332 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.355 | L2-Norm(final)=6.587 | 5915.6 samples/s | 92.4 steps/s
[Step=3500 Epoch=33.0] | Loss=0.00315 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.321 | L2-Norm(final)=6.587 | 2492.2 samples/s | 38.9 steps/s
[Step=3550 Epoch=33.5] | Loss=0.00300 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.287 | L2-Norm(final)=6.588 | 5378.1 samples/s | 84.0 steps/s
[Step=3600 Epoch=33.9] | Loss=0.00287 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.253 | L2-Norm(final)=6.588 | 2622.9 samples/s | 41.0 steps/s
[Step=3650 Epoch=34.4] | Loss=0.00274 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.219 | L2-Norm(final)=6.588 | 4855.7 samples/s | 75.9 steps/s
[Step=3700 Epoch=34.9] | Loss=0.00263 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.185 | L2-Norm(final)=6.589 | 2756.2 samples/s | 43.1 steps/s
[Step=3750 Epoch=35.3] | Loss=0.00252 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.151 | L2-Norm(final)=6.589 | 4534.3 samples/s | 70.8 steps/s
[Step=3800 Epoch=35.8] | Loss=0.00243 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.117 | L2-Norm(final)=6.589 | 2901.6 samples/s | 45.3 steps/s
[Step=3850 Epoch=36.3] | Loss=0.00234 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.082 | L2-Norm(final)=6.589 | 4453.1 samples/s | 69.6 steps/s
[Step=3900 Epoch=36.7] | Loss=0.00225 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.048 | L2-Norm(final)=6.590 | 2898.2 samples/s | 45.3 steps/s
[Step=3950 Epoch=37.2] | Loss=0.00218 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.014 | L2-Norm(final)=6.590 | 4516.1 samples/s | 70.6 steps/s
[Step=4000 Epoch=37.7] | Loss=0.00210 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.980 | L2-Norm(final)=6.590 | 2997.7 samples/s | 46.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step4000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch=19.1] | Loss=0.13445 | Reg=0.00266 | acc=0.9062 | L2-Norm=16.322 | L2-Norm(final)=3.857 | 5911.5 samples/s | 92.4 steps/s
[Step=2050 Epoch=19.5] | Loss=0.12072 | Reg=0.00266 | acc=0.9531 | L2-Norm=16.310 | L2-Norm(final)=4.135 | 5273.1 samples/s | 82.4 steps/s
[Step=2100 Epoch=20.0] | Loss=0.11298 | Reg=0.00266 | acc=0.9531 | L2-Norm=16.309 | L2-Norm(final)=4.429 | 7917.1 samples/s | 123.7 steps/s
[Step=2150 Epoch=20.5] | Loss=0.10643 | Reg=0.00266 | acc=0.9688 | L2-Norm=16.308 | L2-Norm(final)=4.681 | 2545.5 samples/s | 39.8 steps/s
[Step=2200 Epoch=21.0] | Loss=0.10373 | Reg=0.00266 | acc=0.9375 | L2-Norm=16.308 | L2-Norm(final)=4.896 | 7574.6 samples/s | 118.4 steps/s
[Step=2250 Epoch=21.4] | Loss=0.10047 | Reg=0.00266 | acc=0.9375 | L2-Norm=16.308 | L2-Norm(final)=5.088 | 2644.0 samples/s | 41.3 steps/s
[Step=2300 Epoch=21.9] | Loss=0.09764 | Reg=0.00266 | acc=0.9688 | L2-Norm=16.308 | L2-Norm(final)=5.259 | 6890.5 samples/s | 107.7 steps/s
[Step=2350 Epoch=22.4] | Loss=0.09525 | Reg=0.00266 | acc=0.9375 | L2-Norm=16.308 | L2-Norm(final)=5.417 | 2741.3 samples/s | 42.8 steps/s
[Step=2400 Epoch=22.9] | Loss=0.09328 | Reg=0.00266 | acc=0.9375 | L2-Norm=16.308 | L2-Norm(final)=5.562 | 6332.3 samples/s | 98.9 steps/s
[Step=2450 Epoch=23.4] | Loss=0.09158 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.308 | L2-Norm(final)=5.699 | 2847.8 samples/s | 44.5 steps/s
[Step=2500 Epoch=23.8] | Loss=0.09012 | Reg=0.00266 | acc=0.9688 | L2-Norm=16.308 | L2-Norm(final)=5.826 | 5862.4 samples/s | 91.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.8] | Loss=0.09696 | Reg=0.00266 | acc=0.9219 | L2-Norm=16.307 | L2-Norm(final)=7.070 | 6573.9 samples/s | 102.7 steps/s
[Step=2550 Epoch=24.3] | Loss=0.06459 | Reg=0.00281 | acc=0.9688 | L2-Norm=16.748 | L2-Norm(final)=7.043 | 4203.1 samples/s | 65.7 steps/s
[Step=2600 Epoch=24.8] | Loss=0.03647 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.930 | L2-Norm(final)=7.027 | 6635.7 samples/s | 103.7 steps/s
[Step=2650 Epoch=25.3] | Loss=0.02505 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.982 | L2-Norm(final)=7.023 | 2379.5 samples/s | 37.2 steps/s
[Step=2700 Epoch=25.7] | Loss=0.01908 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.988 | L2-Norm(final)=7.023 | 6151.1 samples/s | 96.1 steps/s
[Step=2750 Epoch=26.2] | Loss=0.01530 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.973 | L2-Norm(final)=7.023 | 2440.6 samples/s | 38.1 steps/s
[Step=2800 Epoch=26.7] | Loss=0.01276 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.948 | L2-Norm(final)=7.024 | 5670.6 samples/s | 88.6 steps/s
[Step=2850 Epoch=27.2] | Loss=0.01095 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.918 | L2-Norm(final)=7.024 | 2522.0 samples/s | 39.4 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00958 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.884 | L2-Norm(final)=7.025 | 5296.9 samples/s | 82.8 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00852 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.849 | L2-Norm(final)=7.025 | 2634.5 samples/s | 41.2 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00767 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.813 | L2-Norm(final)=7.026 | 4904.3 samples/s | 76.6 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00698 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.776 | L2-Norm(final)=7.026 | 2715.2 samples/s | 42.4 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00640 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.739 | L2-Norm(final)=7.027 | 4611.1 samples/s | 72.0 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00590 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.701 | L2-Norm(final)=7.027 | 2803.7 samples/s | 43.8 steps/s
[Step=3200 Epoch=30.5] | Loss=0.00548 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.664 | L2-Norm(final)=7.027 | 4613.4 samples/s | 72.1 steps/s
[Step=3250 Epoch=31.0] | Loss=0.00512 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.626 | L2-Norm(final)=7.028 | 2835.5 samples/s | 44.3 steps/s
[Step=3300 Epoch=31.5] | Loss=0.00480 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.589 | L2-Norm(final)=7.028 | 4577.0 samples/s | 71.5 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00452 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.551 | L2-Norm(final)=7.028 | 2835.8 samples/s | 44.3 steps/s
[Step=3400 Epoch=32.4] | Loss=0.00427 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.514 | L2-Norm(final)=7.029 | 4564.9 samples/s | 71.3 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00404 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.477 | L2-Norm(final)=7.029 | 2846.9 samples/s | 44.5 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00384 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.440 | L2-Norm(final)=7.029 | 4527.5 samples/s | 70.7 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00366 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.403 | L2-Norm(final)=7.030 | 7357.6 samples/s | 115.0 steps/s
[Step=3600 Epoch=34.3] | Loss=0.00349 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.366 | L2-Norm(final)=7.030 | 2317.6 samples/s | 36.2 steps/s
[Step=3650 Epoch=34.8] | Loss=0.00334 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.329 | L2-Norm(final)=7.030 | 6730.9 samples/s | 105.2 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00320 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.292 | L2-Norm(final)=7.031 | 2328.0 samples/s | 36.4 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00308 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.256 | L2-Norm(final)=7.031 | 6065.3 samples/s | 94.8 steps/s
[Step=3800 Epoch=36.2] | Loss=0.00296 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.219 | L2-Norm(final)=7.031 | 2450.9 samples/s | 38.3 steps/s
[Step=3850 Epoch=36.7] | Loss=0.00285 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.183 | L2-Norm(final)=7.031 | 5656.3 samples/s | 88.4 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00275 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.146 | L2-Norm(final)=7.032 | 2534.3 samples/s | 39.6 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00265 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.110 | L2-Norm(final)=7.032 | 5238.3 samples/s | 81.8 steps/s
[Step=4000 Epoch=38.1] | Loss=0.00256 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.074 | L2-Norm(final)=7.032 | 2617.9 samples/s | 40.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.16745 | acc=0.9273 | tpr=0.9618 | fpr=0.1477 | 6066.3 samples/s | 23.7 steps/s
Avg test loss: 0.17164, Avg test acc: 0.92596, Avg tpr: 0.96077, Avg fpr: 0.15062, total FA: 1175

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.16992 | acc=0.9172 | tpr=0.9563 | fpr=0.1677 | 5859.2 samples/s | 22.9 steps/s
Avg test loss: 0.17464, Avg test acc: 0.91522, Avg tpr: 0.95366, Avg fpr: 0.16934, total FA: 1321

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.14169 | acc=0.9286 | tpr=0.9505 | fpr=0.1189 | 5995.3 samples/s | 23.4 steps/s
Avg test loss: 0.14188, Avg test acc: 0.92924, Avg tpr: 0.95133, Avg fpr: 0.11934, total FA: 931

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.16686 | acc=0.9278 | tpr=0.9537 | fpr=0.1283 | 5464.8 samples/s | 21.3 steps/s
Avg test loss: 0.17592, Avg test acc: 0.92592, Avg tpr: 0.95331, Avg fpr: 0.13434, total FA: 1048

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.15852 | acc=0.9283 | tpr=0.9615 | fpr=0.1440 | 5921.9 samples/s | 23.1 steps/s
Avg test loss: 0.16170, Avg test acc: 0.92660, Avg tpr: 0.95914, Avg fpr: 0.14498, total FA: 1131

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.30884 | acc=0.3247 | tpr=0.0424 | fpr=0.0624 | 6049.1 samples/s | 23.6 steps/s
Avg test loss: 5.31101, Avg test acc: 0.32242, Avg tpr: 0.04237, Avg fpr: 0.06166, total FA: 481

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=0.32852 | acc=0.6785 | tpr=0.9889 | fpr=0.9955 | 6069.0 samples/s | 23.7 steps/s
Avg test loss: 0.32729, Avg test acc: 0.68146, Avg tpr: 0.98939, Avg fpr: 0.99577, total FA: 7768

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.20931 | acc=0.3243 | tpr=0.0423 | fpr=0.0634 | 6110.9 samples/s | 23.9 steps/s
Avg test loss: 4.22080, Avg test acc: 0.32250, Avg tpr: 0.04127, Avg fpr: 0.05897, total FA: 460

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.91826 | acc=0.3235 | tpr=0.0421 | fpr=0.0654 | 6031.3 samples/s | 23.6 steps/s
Avg test loss: 5.93324, Avg test acc: 0.32226, Avg tpr: 0.04173, Avg fpr: 0.06076, total FA: 474

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=6.52425 | acc=0.3209 | tpr=0.0233 | fpr=0.0330 | 5978.6 samples/s | 23.4 steps/s
Avg test loss: 6.53098, Avg test acc: 0.31934, Avg tpr: 0.02407, Avg fpr: 0.03128, total FA: 244

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.01396 | acc=0.1384 | tpr=0.9159 | fpr=0.8755 | 6015.5 samples/s | 23.5 steps/s
[Step= 100] | Loss=5.00411 | acc=0.1399 | tpr=0.8849 | fpr=0.8740 | 7788.4 samples/s | 30.4 steps/s
[Step= 150] | Loss=4.99772 | acc=0.1393 | tpr=0.8847 | fpr=0.8744 | 8470.6 samples/s | 33.1 steps/s
[Step= 200] | Loss=4.99612 | acc=0.1399 | tpr=0.8842 | fpr=0.8737 | 7808.2 samples/s | 30.5 steps/s
[Step= 250] | Loss=5.00807 | acc=0.1395 | tpr=0.8777 | fpr=0.8740 | 8055.5 samples/s | 31.5 steps/s
[Step= 300] | Loss=5.00074 | acc=0.1389 | tpr=0.8785 | fpr=0.8745 | 7823.3 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.00027 | acc=0.1397 | tpr=0.8779 | fpr=0.8737 | 7945.6 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.00138 | acc=0.1396 | tpr=0.8747 | fpr=0.8738 | 8044.9 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.00410 | acc=0.1388 | tpr=0.8754 | fpr=0.8746 | 8512.7 samples/s | 33.3 steps/s
[Step= 500] | Loss=5.00237 | acc=0.1389 | tpr=0.8762 | fpr=0.8744 | 7960.6 samples/s | 31.1 steps/s
[Step= 550] | Loss=5.00106 | acc=0.1390 | tpr=0.8770 | fpr=0.8744 | 9595.6 samples/s | 37.5 steps/s
Avg test loss: 5.00154, Avg test acc: 0.13892, Avg tpr: 0.87758, Avg fpr: 0.87450, total FA: 121423

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.28899 | acc=0.1445 | tpr=0.8496 | fpr=0.8681 | 6109.6 samples/s | 23.9 steps/s
[Step= 100] | Loss=4.25587 | acc=0.1474 | tpr=0.8337 | fpr=0.8654 | 7682.8 samples/s | 30.0 steps/s
[Step= 150] | Loss=4.25273 | acc=0.1469 | tpr=0.8271 | fpr=0.8656 | 8449.6 samples/s | 33.0 steps/s
[Step= 200] | Loss=4.24328 | acc=0.1468 | tpr=0.8219 | fpr=0.8655 | 7260.7 samples/s | 28.4 steps/s
[Step= 250] | Loss=4.24690 | acc=0.1469 | tpr=0.8262 | fpr=0.8655 | 7963.7 samples/s | 31.1 steps/s
[Step= 300] | Loss=4.24179 | acc=0.1463 | tpr=0.8233 | fpr=0.8660 | 8256.5 samples/s | 32.3 steps/s
[Step= 350] | Loss=4.24518 | acc=0.1460 | tpr=0.8203 | fpr=0.8663 | 7930.9 samples/s | 31.0 steps/s
[Step= 400] | Loss=4.24816 | acc=0.1461 | tpr=0.8184 | fpr=0.8661 | 8045.8 samples/s | 31.4 steps/s
[Step= 450] | Loss=4.25003 | acc=0.1457 | tpr=0.8204 | fpr=0.8665 | 8226.4 samples/s | 32.1 steps/s
[Step= 500] | Loss=4.24875 | acc=0.1459 | tpr=0.8233 | fpr=0.8663 | 8572.2 samples/s | 33.5 steps/s
[Step= 550] | Loss=4.24613 | acc=0.1462 | tpr=0.8237 | fpr=0.8661 | 9938.4 samples/s | 38.8 steps/s
Avg test loss: 4.24653, Avg test acc: 0.14610, Avg tpr: 0.82409, Avg fpr: 0.86622, total FA: 120273

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.12275 | acc=0.1138 | tpr=0.9115 | fpr=0.9006 | 6066.0 samples/s | 23.7 steps/s
[Step= 100] | Loss=5.10626 | acc=0.1124 | tpr=0.9083 | fpr=0.9024 | 7752.2 samples/s | 30.3 steps/s
[Step= 150] | Loss=5.10806 | acc=0.1122 | tpr=0.8991 | fpr=0.9023 | 7186.9 samples/s | 28.1 steps/s
[Step= 200] | Loss=5.10402 | acc=0.1121 | tpr=0.8940 | fpr=0.9021 | 8383.0 samples/s | 32.7 steps/s
[Step= 250] | Loss=5.10999 | acc=0.1120 | tpr=0.9004 | fpr=0.9024 | 8017.1 samples/s | 31.3 steps/s
[Step= 300] | Loss=5.10682 | acc=0.1120 | tpr=0.8982 | fpr=0.9024 | 7529.5 samples/s | 29.4 steps/s
[Step= 350] | Loss=5.10628 | acc=0.1119 | tpr=0.9011 | fpr=0.9024 | 8374.9 samples/s | 32.7 steps/s
[Step= 400] | Loss=5.10842 | acc=0.1119 | tpr=0.8993 | fpr=0.9024 | 8332.8 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.10928 | acc=0.1117 | tpr=0.8982 | fpr=0.9026 | 8244.1 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.10834 | acc=0.1115 | tpr=0.9004 | fpr=0.9027 | 7841.5 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.10866 | acc=0.1117 | tpr=0.9017 | fpr=0.9027 | 11098.6 samples/s | 43.4 steps/s
Avg test loss: 5.10866, Avg test acc: 0.11163, Avg tpr: 0.90214, Avg fpr: 0.90274, total FA: 125344

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.53522 | acc=0.1540 | tpr=0.8673 | fpr=0.8588 | 6001.3 samples/s | 23.4 steps/s
[Step= 100] | Loss=5.50511 | acc=0.1539 | tpr=0.8571 | fpr=0.8593 | 8118.5 samples/s | 31.7 steps/s
[Step= 150] | Loss=5.49459 | acc=0.1522 | tpr=0.8473 | fpr=0.8606 | 7927.5 samples/s | 31.0 steps/s
[Step= 200] | Loss=5.48363 | acc=0.1523 | tpr=0.8339 | fpr=0.8601 | 8045.3 samples/s | 31.4 steps/s
[Step= 250] | Loss=5.49561 | acc=0.1521 | tpr=0.8314 | fpr=0.8602 | 8044.8 samples/s | 31.4 steps/s
[Step= 300] | Loss=5.48589 | acc=0.1518 | tpr=0.8305 | fpr=0.8606 | 7764.7 samples/s | 30.3 steps/s
[Step= 350] | Loss=5.48900 | acc=0.1516 | tpr=0.8284 | fpr=0.8606 | 8336.2 samples/s | 32.6 steps/s
[Step= 400] | Loss=5.49051 | acc=0.1514 | tpr=0.8277 | fpr=0.8609 | 7974.2 samples/s | 31.1 steps/s
[Step= 450] | Loss=5.49167 | acc=0.1509 | tpr=0.8286 | fpr=0.8614 | 8448.3 samples/s | 33.0 steps/s
[Step= 500] | Loss=5.49130 | acc=0.1509 | tpr=0.8291 | fpr=0.8613 | 8144.3 samples/s | 31.8 steps/s
[Step= 550] | Loss=5.49275 | acc=0.1509 | tpr=0.8321 | fpr=0.8615 | 9250.9 samples/s | 36.1 steps/s
Avg test loss: 5.49343, Avg test acc: 0.15080, Avg tpr: 0.83162, Avg fpr: 0.86158, total FA: 119628

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.08212 | acc=0.1416 | tpr=0.8230 | fpr=0.8707 | 6112.0 samples/s | 23.9 steps/s
[Step= 100] | Loss=5.06630 | acc=0.1419 | tpr=0.8230 | fpr=0.8708 | 7147.0 samples/s | 27.9 steps/s
[Step= 150] | Loss=5.06635 | acc=0.1420 | tpr=0.8300 | fpr=0.8707 | 8007.5 samples/s | 31.3 steps/s
[Step= 200] | Loss=5.07021 | acc=0.1420 | tpr=0.8328 | fpr=0.8706 | 8735.4 samples/s | 34.1 steps/s
[Step= 250] | Loss=5.08106 | acc=0.1416 | tpr=0.8332 | fpr=0.8710 | 8357.2 samples/s | 32.6 steps/s
[Step= 300] | Loss=5.07894 | acc=0.1418 | tpr=0.8364 | fpr=0.8709 | 7959.8 samples/s | 31.1 steps/s
[Step= 350] | Loss=5.08432 | acc=0.1416 | tpr=0.8384 | fpr=0.8711 | 7253.6 samples/s | 28.3 steps/s
[Step= 400] | Loss=5.08845 | acc=0.1416 | tpr=0.8359 | fpr=0.8710 | 8186.1 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.09040 | acc=0.1411 | tpr=0.8374 | fpr=0.8716 | 8040.8 samples/s | 31.4 steps/s
[Step= 500] | Loss=5.08544 | acc=0.1415 | tpr=0.8374 | fpr=0.8711 | 7704.6 samples/s | 30.1 steps/s
[Step= 550] | Loss=5.08962 | acc=0.1415 | tpr=0.8376 | fpr=0.8712 | 11399.5 samples/s | 44.5 steps/s
Avg test loss: 5.09074, Avg test acc: 0.14141, Avg tpr: 0.83835, Avg fpr: 0.87125, total FA: 120972

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14700 | acc=0.9590 | tpr=0.8805 | fpr=0.0396 | 6124.7 samples/s | 23.9 steps/s
[Step= 100] | Loss=0.15233 | acc=0.9584 | tpr=0.8955 | fpr=0.0404 | 7639.5 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.15180 | acc=0.9582 | tpr=0.8991 | fpr=0.0407 | 7981.9 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.15117 | acc=0.9578 | tpr=0.9016 | fpr=0.0412 | 7650.1 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.15188 | acc=0.9576 | tpr=0.8961 | fpr=0.0413 | 8389.6 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.15326 | acc=0.9573 | tpr=0.8887 | fpr=0.0414 | 8415.8 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.15311 | acc=0.9573 | tpr=0.8910 | fpr=0.0415 | 7358.1 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.15331 | acc=0.9571 | tpr=0.8889 | fpr=0.0416 | 8247.1 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.15454 | acc=0.9567 | tpr=0.8895 | fpr=0.0421 | 7924.4 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.15484 | acc=0.9565 | tpr=0.8912 | fpr=0.0424 | 8247.7 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.15441 | acc=0.9567 | tpr=0.8918 | fpr=0.0422 | 10371.7 samples/s | 40.5 steps/s
Avg test loss: 0.15424, Avg test acc: 0.95669, Avg tpr: 0.89184, Avg fpr: 0.04213, total FA: 5850

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.44061 | acc=0.0570 | tpr=0.9823 | fpr=0.9597 | 6224.0 samples/s | 24.3 steps/s
[Step= 100] | Loss=0.44248 | acc=0.0546 | tpr=0.9851 | fpr=0.9628 | 7394.0 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.44266 | acc=0.0542 | tpr=0.9827 | fpr=0.9629 | 7584.9 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.44246 | acc=0.0540 | tpr=0.9825 | fpr=0.9629 | 8673.1 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.44276 | acc=0.0545 | tpr=0.9817 | fpr=0.9624 | 8406.4 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.44278 | acc=0.0547 | tpr=0.9840 | fpr=0.9622 | 7848.1 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.44285 | acc=0.0548 | tpr=0.9850 | fpr=0.9621 | 7751.0 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.44300 | acc=0.0549 | tpr=0.9825 | fpr=0.9620 | 8136.7 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.44297 | acc=0.0549 | tpr=0.9815 | fpr=0.9620 | 8310.6 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.44305 | acc=0.0545 | tpr=0.9819 | fpr=0.9622 | 8070.7 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.44295 | acc=0.0549 | tpr=0.9813 | fpr=0.9620 | 9628.5 samples/s | 37.6 steps/s
Avg test loss: 0.44293, Avg test acc: 0.05482, Avg tpr: 0.98138, Avg fpr: 0.96202, total FA: 133575

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.22424 | acc=0.9466 | tpr=0.9381 | fpr=0.0532 | 6090.2 samples/s | 23.8 steps/s
[Step= 100] | Loss=0.23074 | acc=0.9462 | tpr=0.9318 | fpr=0.0536 | 7132.1 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.23536 | acc=0.9452 | tpr=0.9323 | fpr=0.0546 | 8462.4 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.23671 | acc=0.9455 | tpr=0.9366 | fpr=0.0543 | 8115.6 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.23777 | acc=0.9454 | tpr=0.9293 | fpr=0.0543 | 8291.6 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.24002 | acc=0.9446 | tpr=0.9244 | fpr=0.0550 | 8058.3 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.23866 | acc=0.9449 | tpr=0.9261 | fpr=0.0547 | 7822.5 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.23984 | acc=0.9445 | tpr=0.9240 | fpr=0.0551 | 8524.9 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.24044 | acc=0.9442 | tpr=0.9231 | fpr=0.0554 | 8126.0 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.24167 | acc=0.9439 | tpr=0.9238 | fpr=0.0557 | 7237.1 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.24048 | acc=0.9442 | tpr=0.9252 | fpr=0.0554 | 10654.9 samples/s | 41.6 steps/s
Avg test loss: 0.24028, Avg test acc: 0.94428, Avg tpr: 0.92512, Avg fpr: 0.05537, total FA: 7688

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.12703 | acc=0.9593 | tpr=0.8673 | fpr=0.0390 | 6006.3 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.13273 | acc=0.9587 | tpr=0.8785 | fpr=0.0398 | 7693.2 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.13526 | acc=0.9581 | tpr=0.8847 | fpr=0.0405 | 7624.2 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.13433 | acc=0.9587 | tpr=0.8929 | fpr=0.0401 | 7906.8 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.13603 | acc=0.9585 | tpr=0.8821 | fpr=0.0402 | 7976.4 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.13852 | acc=0.9579 | tpr=0.8785 | fpr=0.0407 | 8589.0 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.13751 | acc=0.9580 | tpr=0.8823 | fpr=0.0406 | 8279.8 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.13792 | acc=0.9579 | tpr=0.8818 | fpr=0.0407 | 8058.4 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.13965 | acc=0.9573 | tpr=0.8807 | fpr=0.0413 | 8046.1 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.13993 | acc=0.9573 | tpr=0.8850 | fpr=0.0414 | 8459.8 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.13889 | acc=0.9575 | tpr=0.8854 | fpr=0.0412 | 9488.6 samples/s | 37.1 steps/s
Avg test loss: 0.13878, Avg test acc: 0.95755, Avg tpr: 0.88550, Avg fpr: 0.04114, total FA: 5712

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.22702 | acc=0.9487 | tpr=0.8938 | fpr=0.0503 | 6006.2 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.23162 | acc=0.9486 | tpr=0.9211 | fpr=0.0509 | 7926.8 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.23198 | acc=0.9476 | tpr=0.9294 | fpr=0.0520 | 7970.4 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.23214 | acc=0.9478 | tpr=0.9268 | fpr=0.0518 | 8367.5 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.23484 | acc=0.9474 | tpr=0.9223 | fpr=0.0522 | 6780.3 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.23785 | acc=0.9466 | tpr=0.9222 | fpr=0.0529 | 8193.4 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.23615 | acc=0.9467 | tpr=0.9205 | fpr=0.0528 | 8717.3 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.23682 | acc=0.9464 | tpr=0.9168 | fpr=0.0530 | 7334.8 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.23841 | acc=0.9461 | tpr=0.9143 | fpr=0.0533 | 8679.5 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.23950 | acc=0.9458 | tpr=0.9150 | fpr=0.0537 | 8272.8 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.23841 | acc=0.9462 | tpr=0.9140 | fpr=0.0532 | 10553.4 samples/s | 41.2 steps/s
Avg test loss: 0.23804, Avg test acc: 0.94623, Avg tpr: 0.91442, Avg fpr: 0.05319, total FA: 7386

server round 3/50

clients selected: [0 1 2 6 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.21071 | Reg=0.00248 | acc=0.7188 | L2-Norm=15.747 | L2-Norm(final)=4.098 | 7079.3 samples/s | 110.6 steps/s
[Step=4050 Epoch=19.7] | Loss=0.17072 | Reg=0.00248 | acc=0.8906 | L2-Norm=15.744 | L2-Norm(final)=4.169 | 5089.5 samples/s | 79.5 steps/s
[Step=4100 Epoch=20.0] | Loss=0.16092 | Reg=0.00248 | acc=0.9531 | L2-Norm=15.744 | L2-Norm(final)=4.279 | 5626.5 samples/s | 87.9 steps/s
[Step=4150 Epoch=20.2] | Loss=0.15948 | Reg=0.00248 | acc=0.8750 | L2-Norm=15.744 | L2-Norm(final)=4.383 | 5468.4 samples/s | 85.4 steps/s
[Step=4200 Epoch=20.5] | Loss=0.15718 | Reg=0.00248 | acc=0.8125 | L2-Norm=15.744 | L2-Norm(final)=4.481 | 8630.0 samples/s | 134.8 steps/s
[Step=4250 Epoch=20.7] | Loss=0.15566 | Reg=0.00248 | acc=0.8750 | L2-Norm=15.743 | L2-Norm(final)=4.571 | 2654.8 samples/s | 41.5 steps/s
[Step=4300 Epoch=21.0] | Loss=0.15372 | Reg=0.00248 | acc=0.9219 | L2-Norm=15.743 | L2-Norm(final)=4.655 | 5590.7 samples/s | 87.4 steps/s
[Step=4350 Epoch=21.2] | Loss=0.15321 | Reg=0.00248 | acc=0.9062 | L2-Norm=15.743 | L2-Norm(final)=4.734 | 5546.3 samples/s | 86.7 steps/s
[Step=4400 Epoch=21.5] | Loss=0.15222 | Reg=0.00248 | acc=0.8906 | L2-Norm=15.743 | L2-Norm(final)=4.807 | 7568.7 samples/s | 118.3 steps/s
[Step=4450 Epoch=21.7] | Loss=0.15154 | Reg=0.00248 | acc=0.8594 | L2-Norm=15.743 | L2-Norm(final)=4.877 | 2785.6 samples/s | 43.5 steps/s
[Step=4500 Epoch=21.9] | Loss=0.15052 | Reg=0.00248 | acc=0.8906 | L2-Norm=15.743 | L2-Norm(final)=4.943 | 5641.5 samples/s | 88.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=21.9] | Loss=0.15859 | Reg=0.00248 | acc=0.8438 | L2-Norm=15.743 | L2-Norm(final)=5.594 | 7717.7 samples/s | 120.6 steps/s
[Step=4550 Epoch=22.2] | Loss=0.13632 | Reg=0.00255 | acc=0.8594 | L2-Norm=15.963 | L2-Norm(final)=5.584 | 4100.5 samples/s | 64.1 steps/s
[Step=4600 Epoch=22.4] | Loss=0.12468 | Reg=0.00259 | acc=0.9219 | L2-Norm=16.107 | L2-Norm(final)=5.573 | 4770.7 samples/s | 74.5 steps/s
[Step=4650 Epoch=22.7] | Loss=0.11559 | Reg=0.00262 | acc=0.9062 | L2-Norm=16.198 | L2-Norm(final)=5.567 | 4775.7 samples/s | 74.6 steps/s
[Step=4700 Epoch=22.9] | Loss=0.10948 | Reg=0.00265 | acc=0.9375 | L2-Norm=16.264 | L2-Norm(final)=5.561 | 6839.8 samples/s | 106.9 steps/s
[Step=4750 Epoch=23.2] | Loss=0.09960 | Reg=0.00267 | acc=0.9688 | L2-Norm=16.325 | L2-Norm(final)=5.559 | 2505.2 samples/s | 39.1 steps/s
[Step=4800 Epoch=23.4] | Loss=0.09455 | Reg=0.00268 | acc=0.9531 | L2-Norm=16.381 | L2-Norm(final)=5.557 | 4655.8 samples/s | 72.7 steps/s
[Step=4850 Epoch=23.6] | Loss=0.08876 | Reg=0.00270 | acc=0.9688 | L2-Norm=16.430 | L2-Norm(final)=5.554 | 4793.1 samples/s | 74.9 steps/s
[Step=4900 Epoch=23.9] | Loss=0.08431 | Reg=0.00271 | acc=0.9375 | L2-Norm=16.473 | L2-Norm(final)=5.554 | 6211.7 samples/s | 97.1 steps/s
[Step=4950 Epoch=24.1] | Loss=0.07905 | Reg=0.00273 | acc=0.9844 | L2-Norm=16.512 | L2-Norm(final)=5.555 | 2589.8 samples/s | 40.5 steps/s
[Step=5000 Epoch=24.4] | Loss=0.07426 | Reg=0.00274 | acc=0.9688 | L2-Norm=16.547 | L2-Norm(final)=5.557 | 4749.0 samples/s | 74.2 steps/s
[Step=5050 Epoch=24.6] | Loss=0.07127 | Reg=0.00275 | acc=0.9531 | L2-Norm=16.580 | L2-Norm(final)=5.559 | 4821.3 samples/s | 75.3 steps/s
[Step=5100 Epoch=24.9] | Loss=0.06871 | Reg=0.00276 | acc=0.9688 | L2-Norm=16.611 | L2-Norm(final)=5.561 | 5652.4 samples/s | 88.3 steps/s
[Step=5150 Epoch=25.1] | Loss=0.06533 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.641 | L2-Norm(final)=5.563 | 2673.2 samples/s | 41.8 steps/s
[Step=5200 Epoch=25.4] | Loss=0.06252 | Reg=0.00278 | acc=0.9844 | L2-Norm=16.669 | L2-Norm(final)=5.566 | 4780.1 samples/s | 74.7 steps/s
[Step=5250 Epoch=25.6] | Loss=0.06037 | Reg=0.00279 | acc=0.9688 | L2-Norm=16.697 | L2-Norm(final)=5.569 | 4843.1 samples/s | 75.7 steps/s
[Step=5300 Epoch=25.8] | Loss=0.05840 | Reg=0.00280 | acc=0.9844 | L2-Norm=16.723 | L2-Norm(final)=5.572 | 5197.5 samples/s | 81.2 steps/s
[Step=5350 Epoch=26.1] | Loss=0.05682 | Reg=0.00281 | acc=0.9844 | L2-Norm=16.749 | L2-Norm(final)=5.575 | 2790.2 samples/s | 43.6 steps/s
[Step=5400 Epoch=26.3] | Loss=0.05511 | Reg=0.00282 | acc=0.9844 | L2-Norm=16.775 | L2-Norm(final)=5.578 | 4650.0 samples/s | 72.7 steps/s
[Step=5450 Epoch=26.6] | Loss=0.05399 | Reg=0.00282 | acc=0.9844 | L2-Norm=16.800 | L2-Norm(final)=5.580 | 4764.5 samples/s | 74.4 steps/s
[Step=5500 Epoch=26.8] | Loss=0.05264 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.825 | L2-Norm(final)=5.582 | 4895.4 samples/s | 76.5 steps/s
[Step=5550 Epoch=27.1] | Loss=0.05193 | Reg=0.00284 | acc=0.9688 | L2-Norm=16.848 | L2-Norm(final)=5.584 | 2888.8 samples/s | 45.1 steps/s
[Step=5600 Epoch=27.3] | Loss=0.05156 | Reg=0.00285 | acc=0.9688 | L2-Norm=16.874 | L2-Norm(final)=5.585 | 4794.9 samples/s | 74.9 steps/s
[Step=5650 Epoch=27.6] | Loss=0.05070 | Reg=0.00286 | acc=0.9844 | L2-Norm=16.901 | L2-Norm(final)=5.585 | 4738.1 samples/s | 74.0 steps/s
[Step=5700 Epoch=27.8] | Loss=0.04962 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.928 | L2-Norm(final)=5.585 | 4932.0 samples/s | 77.1 steps/s
[Step=5750 Epoch=28.0] | Loss=0.04828 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.953 | L2-Norm(final)=5.585 | 2911.9 samples/s | 45.5 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04696 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.975 | L2-Norm(final)=5.586 | 4722.0 samples/s | 73.8 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04582 | Reg=0.00289 | acc=0.9844 | L2-Norm=16.996 | L2-Norm(final)=5.587 | 4832.0 samples/s | 75.5 steps/s
[Step=5900 Epoch=28.8] | Loss=0.04494 | Reg=0.00290 | acc=0.9688 | L2-Norm=17.015 | L2-Norm(final)=5.588 | 4677.0 samples/s | 73.1 steps/s
[Step=5950 Epoch=29.0] | Loss=0.04398 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.033 | L2-Norm(final)=5.588 | 2951.6 samples/s | 46.1 steps/s
[Step=6000 Epoch=29.3] | Loss=0.04299 | Reg=0.00291 | acc=0.9688 | L2-Norm=17.051 | L2-Norm(final)=5.589 | 4815.3 samples/s | 75.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step6000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.21739 | Reg=0.00248 | acc=0.7969 | L2-Norm=15.747 | L2-Norm(final)=3.091 | 7365.7 samples/s | 115.1 steps/s
[Step=2050 Epoch=10.0] | Loss=0.18222 | Reg=0.00248 | acc=0.8750 | L2-Norm=15.748 | L2-Norm(final)=3.208 | 4803.9 samples/s | 75.1 steps/s
[Step=2100 Epoch=10.2] | Loss=0.17765 | Reg=0.00248 | acc=0.8906 | L2-Norm=15.749 | L2-Norm(final)=3.373 | 5523.6 samples/s | 86.3 steps/s
[Step=2150 Epoch=10.5] | Loss=0.17277 | Reg=0.00248 | acc=0.9219 | L2-Norm=15.749 | L2-Norm(final)=3.527 | 5581.3 samples/s | 87.2 steps/s
[Step=2200 Epoch=10.7] | Loss=0.16968 | Reg=0.00248 | acc=0.8594 | L2-Norm=15.749 | L2-Norm(final)=3.666 | 8726.2 samples/s | 136.3 steps/s
[Step=2250 Epoch=11.0] | Loss=0.16738 | Reg=0.00248 | acc=0.8281 | L2-Norm=15.749 | L2-Norm(final)=3.794 | 2653.0 samples/s | 41.5 steps/s
[Step=2300 Epoch=11.2] | Loss=0.16464 | Reg=0.00248 | acc=0.9062 | L2-Norm=15.749 | L2-Norm(final)=3.913 | 5624.1 samples/s | 87.9 steps/s
[Step=2350 Epoch=11.5] | Loss=0.16336 | Reg=0.00248 | acc=0.8750 | L2-Norm=15.749 | L2-Norm(final)=4.025 | 5433.8 samples/s | 84.9 steps/s
[Step=2400 Epoch=11.7] | Loss=0.16194 | Reg=0.00248 | acc=0.9219 | L2-Norm=15.749 | L2-Norm(final)=4.129 | 7909.2 samples/s | 123.6 steps/s
[Step=2450 Epoch=12.0] | Loss=0.16006 | Reg=0.00248 | acc=0.8438 | L2-Norm=15.749 | L2-Norm(final)=4.226 | 2728.6 samples/s | 42.6 steps/s
[Step=2500 Epoch=12.2] | Loss=0.15836 | Reg=0.00248 | acc=0.8906 | L2-Norm=15.749 | L2-Norm(final)=4.318 | 5742.0 samples/s | 89.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.16367 | Reg=0.00248 | acc=0.8438 | L2-Norm=15.749 | L2-Norm(final)=5.224 | 6858.2 samples/s | 107.2 steps/s
[Step=2550 Epoch=12.4] | Loss=0.14108 | Reg=0.00254 | acc=0.8750 | L2-Norm=15.952 | L2-Norm(final)=5.220 | 4367.2 samples/s | 68.2 steps/s
[Step=2600 Epoch=12.7] | Loss=0.13077 | Reg=0.00259 | acc=0.8594 | L2-Norm=16.088 | L2-Norm(final)=5.202 | 4752.1 samples/s | 74.3 steps/s
[Step=2650 Epoch=12.9] | Loss=0.12238 | Reg=0.00262 | acc=0.8906 | L2-Norm=16.173 | L2-Norm(final)=5.188 | 4786.7 samples/s | 74.8 steps/s
[Step=2700 Epoch=13.2] | Loss=0.11045 | Reg=0.00264 | acc=0.9375 | L2-Norm=16.240 | L2-Norm(final)=5.183 | 6877.4 samples/s | 107.5 steps/s
[Step=2750 Epoch=13.4] | Loss=0.10153 | Reg=0.00266 | acc=0.9062 | L2-Norm=16.295 | L2-Norm(final)=5.180 | 2453.4 samples/s | 38.3 steps/s
[Step=2800 Epoch=13.7] | Loss=0.09353 | Reg=0.00267 | acc=0.9375 | L2-Norm=16.342 | L2-Norm(final)=5.180 | 4768.7 samples/s | 74.5 steps/s
[Step=2850 Epoch=13.9] | Loss=0.08826 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.386 | L2-Norm(final)=5.179 | 4817.6 samples/s | 75.3 steps/s
[Step=2900 Epoch=14.2] | Loss=0.08517 | Reg=0.00270 | acc=0.8750 | L2-Norm=16.425 | L2-Norm(final)=5.178 | 6315.0 samples/s | 98.7 steps/s
[Step=2950 Epoch=14.4] | Loss=0.08040 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.462 | L2-Norm(final)=5.178 | 2579.6 samples/s | 40.3 steps/s
[Step=3000 Epoch=14.6] | Loss=0.07632 | Reg=0.00272 | acc=0.9688 | L2-Norm=16.495 | L2-Norm(final)=5.178 | 4650.0 samples/s | 72.7 steps/s
[Step=3050 Epoch=14.9] | Loss=0.07367 | Reg=0.00273 | acc=0.9688 | L2-Norm=16.526 | L2-Norm(final)=5.178 | 4774.0 samples/s | 74.6 steps/s
[Step=3100 Epoch=15.1] | Loss=0.07078 | Reg=0.00274 | acc=0.9844 | L2-Norm=16.556 | L2-Norm(final)=5.178 | 5886.3 samples/s | 92.0 steps/s
[Step=3150 Epoch=15.4] | Loss=0.06765 | Reg=0.00275 | acc=0.9688 | L2-Norm=16.585 | L2-Norm(final)=5.179 | 2616.5 samples/s | 40.9 steps/s
[Step=3200 Epoch=15.6] | Loss=0.06480 | Reg=0.00276 | acc=0.9688 | L2-Norm=16.613 | L2-Norm(final)=5.180 | 4800.8 samples/s | 75.0 steps/s
[Step=3250 Epoch=15.9] | Loss=0.06276 | Reg=0.00277 | acc=0.9688 | L2-Norm=16.640 | L2-Norm(final)=5.181 | 4716.4 samples/s | 73.7 steps/s
[Step=3300 Epoch=16.1] | Loss=0.06055 | Reg=0.00278 | acc=0.9688 | L2-Norm=16.666 | L2-Norm(final)=5.182 | 5556.8 samples/s | 86.8 steps/s
[Step=3350 Epoch=16.3] | Loss=0.05841 | Reg=0.00279 | acc=0.9844 | L2-Norm=16.690 | L2-Norm(final)=5.183 | 2704.5 samples/s | 42.3 steps/s
[Step=3400 Epoch=16.6] | Loss=0.05636 | Reg=0.00279 | acc=0.9531 | L2-Norm=16.712 | L2-Norm(final)=5.184 | 4820.2 samples/s | 75.3 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05456 | Reg=0.00280 | acc=0.9844 | L2-Norm=16.733 | L2-Norm(final)=5.185 | 4777.8 samples/s | 74.7 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05292 | Reg=0.00281 | acc=0.9531 | L2-Norm=16.753 | L2-Norm(final)=5.186 | 5045.3 samples/s | 78.8 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05158 | Reg=0.00281 | acc=0.9844 | L2-Norm=16.772 | L2-Norm(final)=5.187 | 2804.7 samples/s | 43.8 steps/s
[Step=3600 Epoch=17.6] | Loss=0.05003 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.790 | L2-Norm(final)=5.188 | 4785.4 samples/s | 74.8 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04862 | Reg=0.00283 | acc=0.9844 | L2-Norm=16.808 | L2-Norm(final)=5.189 | 4730.5 samples/s | 73.9 steps/s
[Step=3700 Epoch=18.1] | Loss=0.04748 | Reg=0.00283 | acc=0.9688 | L2-Norm=16.825 | L2-Norm(final)=5.190 | 4886.8 samples/s | 76.4 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04643 | Reg=0.00284 | acc=0.9688 | L2-Norm=16.842 | L2-Norm(final)=5.191 | 2894.5 samples/s | 45.2 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04520 | Reg=0.00284 | acc=0.9688 | L2-Norm=16.858 | L2-Norm(final)=5.192 | 4825.4 samples/s | 75.4 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04424 | Reg=0.00285 | acc=0.9844 | L2-Norm=16.873 | L2-Norm(final)=5.193 | 4692.7 samples/s | 73.3 steps/s
[Step=3900 Epoch=19.0] | Loss=0.04330 | Reg=0.00285 | acc=0.9844 | L2-Norm=16.888 | L2-Norm(final)=5.194 | 4789.3 samples/s | 74.8 steps/s
[Step=3950 Epoch=19.3] | Loss=0.04250 | Reg=0.00286 | acc=0.9844 | L2-Norm=16.901 | L2-Norm(final)=5.195 | 2931.5 samples/s | 45.8 steps/s
[Step=4000 Epoch=19.5] | Loss=0.04155 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.914 | L2-Norm(final)=5.195 | 4752.8 samples/s | 74.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step4000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.14409 | Reg=0.00248 | acc=0.9219 | L2-Norm=15.747 | L2-Norm(final)=4.699 | 6675.3 samples/s | 104.3 steps/s
[Step=4050 Epoch=19.7] | Loss=0.15248 | Reg=0.00248 | acc=0.8594 | L2-Norm=15.744 | L2-Norm(final)=4.761 | 5350.0 samples/s | 83.6 steps/s
[Step=4100 Epoch=20.0] | Loss=0.14926 | Reg=0.00248 | acc=0.7969 | L2-Norm=15.744 | L2-Norm(final)=4.848 | 5448.0 samples/s | 85.1 steps/s
[Step=4150 Epoch=20.2] | Loss=0.14888 | Reg=0.00248 | acc=0.9062 | L2-Norm=15.744 | L2-Norm(final)=4.934 | 5604.5 samples/s | 87.6 steps/s
[Step=4200 Epoch=20.5] | Loss=0.14702 | Reg=0.00248 | acc=0.8906 | L2-Norm=15.744 | L2-Norm(final)=5.013 | 8333.4 samples/s | 130.2 steps/s
[Step=4250 Epoch=20.7] | Loss=0.14678 | Reg=0.00248 | acc=0.9219 | L2-Norm=15.744 | L2-Norm(final)=5.086 | 2717.9 samples/s | 42.5 steps/s
[Step=4300 Epoch=21.0] | Loss=0.14593 | Reg=0.00248 | acc=0.9062 | L2-Norm=15.744 | L2-Norm(final)=5.154 | 5420.3 samples/s | 84.7 steps/s
[Step=4350 Epoch=21.2] | Loss=0.14482 | Reg=0.00248 | acc=0.8594 | L2-Norm=15.744 | L2-Norm(final)=5.219 | 5573.4 samples/s | 87.1 steps/s
[Step=4400 Epoch=21.4] | Loss=0.14403 | Reg=0.00248 | acc=0.8594 | L2-Norm=15.744 | L2-Norm(final)=5.282 | 7652.1 samples/s | 119.6 steps/s
[Step=4450 Epoch=21.7] | Loss=0.14373 | Reg=0.00248 | acc=0.8594 | L2-Norm=15.744 | L2-Norm(final)=5.340 | 2805.1 samples/s | 43.8 steps/s
[Step=4500 Epoch=21.9] | Loss=0.14280 | Reg=0.00248 | acc=0.8750 | L2-Norm=15.744 | L2-Norm(final)=5.396 | 5637.5 samples/s | 88.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=21.9] | Loss=0.10778 | Reg=0.00248 | acc=0.8750 | L2-Norm=15.744 | L2-Norm(final)=5.956 | 6972.2 samples/s | 108.9 steps/s
[Step=4550 Epoch=22.2] | Loss=0.13300 | Reg=0.00253 | acc=0.8281 | L2-Norm=15.911 | L2-Norm(final)=5.956 | 4377.1 samples/s | 68.4 steps/s
[Step=4600 Epoch=22.4] | Loss=0.12371 | Reg=0.00258 | acc=0.9375 | L2-Norm=16.065 | L2-Norm(final)=5.935 | 4759.9 samples/s | 74.4 steps/s
[Step=4650 Epoch=22.7] | Loss=0.11686 | Reg=0.00261 | acc=0.9062 | L2-Norm=16.163 | L2-Norm(final)=5.922 | 4781.9 samples/s | 74.7 steps/s
[Step=4700 Epoch=22.9] | Loss=0.10916 | Reg=0.00264 | acc=0.9688 | L2-Norm=16.241 | L2-Norm(final)=5.914 | 6872.6 samples/s | 107.4 steps/s
[Step=4750 Epoch=23.1] | Loss=0.09778 | Reg=0.00266 | acc=0.9531 | L2-Norm=16.306 | L2-Norm(final)=5.912 | 2495.3 samples/s | 39.0 steps/s
[Step=4800 Epoch=23.4] | Loss=0.09126 | Reg=0.00268 | acc=0.9375 | L2-Norm=16.361 | L2-Norm(final)=5.910 | 4776.6 samples/s | 74.6 steps/s
[Step=4850 Epoch=23.6] | Loss=0.08638 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.410 | L2-Norm(final)=5.909 | 4748.0 samples/s | 74.2 steps/s
[Step=4900 Epoch=23.9] | Loss=0.08196 | Reg=0.00271 | acc=0.9531 | L2-Norm=16.454 | L2-Norm(final)=5.910 | 6251.3 samples/s | 97.7 steps/s
[Step=4950 Epoch=24.1] | Loss=0.07986 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.498 | L2-Norm(final)=5.910 | 2611.8 samples/s | 40.8 steps/s
[Step=5000 Epoch=24.4] | Loss=0.07531 | Reg=0.00274 | acc=0.9844 | L2-Norm=16.542 | L2-Norm(final)=5.911 | 4669.8 samples/s | 73.0 steps/s
[Step=5050 Epoch=24.6] | Loss=0.07172 | Reg=0.00275 | acc=0.9844 | L2-Norm=16.582 | L2-Norm(final)=5.913 | 4822.4 samples/s | 75.3 steps/s
[Step=5100 Epoch=24.8] | Loss=0.06891 | Reg=0.00276 | acc=0.9844 | L2-Norm=16.618 | L2-Norm(final)=5.915 | 5670.3 samples/s | 88.6 steps/s
[Step=5150 Epoch=25.1] | Loss=0.06586 | Reg=0.00277 | acc=0.9688 | L2-Norm=16.651 | L2-Norm(final)=5.917 | 2671.7 samples/s | 41.7 steps/s
[Step=5200 Epoch=25.3] | Loss=0.06302 | Reg=0.00278 | acc=0.9844 | L2-Norm=16.679 | L2-Norm(final)=5.919 | 4817.3 samples/s | 75.3 steps/s
[Step=5250 Epoch=25.6] | Loss=0.06067 | Reg=0.00279 | acc=0.9688 | L2-Norm=16.705 | L2-Norm(final)=5.921 | 4743.6 samples/s | 74.1 steps/s
[Step=5300 Epoch=25.8] | Loss=0.05877 | Reg=0.00280 | acc=0.9688 | L2-Norm=16.729 | L2-Norm(final)=5.923 | 5258.1 samples/s | 82.2 steps/s
[Step=5350 Epoch=26.1] | Loss=0.05676 | Reg=0.00281 | acc=0.9844 | L2-Norm=16.752 | L2-Norm(final)=5.924 | 2832.7 samples/s | 44.3 steps/s
[Step=5400 Epoch=26.3] | Loss=0.05493 | Reg=0.00281 | acc=0.9688 | L2-Norm=16.774 | L2-Norm(final)=5.926 | 4661.3 samples/s | 72.8 steps/s
[Step=5450 Epoch=26.6] | Loss=0.05306 | Reg=0.00282 | acc=0.9844 | L2-Norm=16.794 | L2-Norm(final)=5.928 | 4789.7 samples/s | 74.8 steps/s
[Step=5500 Epoch=26.8] | Loss=0.05165 | Reg=0.00283 | acc=0.9688 | L2-Norm=16.814 | L2-Norm(final)=5.931 | 4908.1 samples/s | 76.7 steps/s
[Step=5550 Epoch=27.0] | Loss=0.05030 | Reg=0.00283 | acc=0.9844 | L2-Norm=16.833 | L2-Norm(final)=5.933 | 2894.2 samples/s | 45.2 steps/s
[Step=5600 Epoch=27.3] | Loss=0.04899 | Reg=0.00284 | acc=0.9844 | L2-Norm=16.851 | L2-Norm(final)=5.934 | 4798.4 samples/s | 75.0 steps/s
[Step=5650 Epoch=27.5] | Loss=0.04766 | Reg=0.00285 | acc=0.9531 | L2-Norm=16.868 | L2-Norm(final)=5.936 | 4726.5 samples/s | 73.9 steps/s
[Step=5700 Epoch=27.8] | Loss=0.04666 | Reg=0.00285 | acc=0.9844 | L2-Norm=16.885 | L2-Norm(final)=5.938 | 4737.8 samples/s | 74.0 steps/s
[Step=5750 Epoch=28.0] | Loss=0.04574 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.901 | L2-Norm(final)=5.939 | 2977.0 samples/s | 46.5 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04485 | Reg=0.00286 | acc=0.9844 | L2-Norm=16.918 | L2-Norm(final)=5.940 | 4691.8 samples/s | 73.3 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04391 | Reg=0.00287 | acc=0.9688 | L2-Norm=16.934 | L2-Norm(final)=5.942 | 4739.5 samples/s | 74.1 steps/s
[Step=5900 Epoch=28.7] | Loss=0.04294 | Reg=0.00287 | acc=0.9688 | L2-Norm=16.950 | L2-Norm(final)=5.943 | 4814.4 samples/s | 75.2 steps/s
[Step=5950 Epoch=29.0] | Loss=0.04243 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.964 | L2-Norm(final)=5.944 | 2913.5 samples/s | 45.5 steps/s
[Step=6000 Epoch=29.2] | Loss=0.04167 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.980 | L2-Norm(final)=5.944 | 4776.6 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step6000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36071 | Reg=0.00248 | acc=0.4844 | L2-Norm=15.747 | L2-Norm(final)=1.980 | 7297.8 samples/s | 114.0 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.29896 | Reg=0.00248 | acc=0.8125 | L2-Norm=15.747 | L2-Norm(final)=2.019 | 4919.4 samples/s | 76.9 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.25989 | Reg=0.00248 | acc=0.9219 | L2-Norm=15.747 | L2-Norm(final)=2.139 | 9575.0 samples/s | 149.6 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.23296 | Reg=0.00248 | acc=0.9531 | L2-Norm=15.747 | L2-Norm(final)=2.295 | 2688.6 samples/s | 42.0 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.21232 | Reg=0.00248 | acc=0.9375 | L2-Norm=15.747 | L2-Norm(final)=2.464 | 8609.0 samples/s | 134.5 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.19669 | Reg=0.00248 | acc=0.9219 | L2-Norm=15.747 | L2-Norm(final)=2.634 | 2829.0 samples/s | 44.2 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.18363 | Reg=0.00248 | acc=0.9688 | L2-Norm=15.747 | L2-Norm(final)=2.802 | 7564.9 samples/s | 118.2 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.17260 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.747 | L2-Norm(final)=2.963 | 2974.2 samples/s | 46.5 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.16378 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.747 | L2-Norm(final)=3.119 | 6607.7 samples/s | 103.2 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.15643 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.747 | L2-Norm(final)=3.267 | 3153.2 samples/s | 49.3 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.14977 | Reg=0.00248 | acc=0.9688 | L2-Norm=15.747 | L2-Norm(final)=3.409 | 6069.6 samples/s | 94.8 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.8] | Loss=0.06402 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.747 | L2-Norm(final)=4.802 | 6960.5 samples/s | 108.8 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.02849 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.767 | L2-Norm(final)=4.857 | 2563.2 samples/s | 40.1 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01721 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.787 | L2-Norm(final)=4.875 | 6466.7 samples/s | 101.0 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01293 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.793 | L2-Norm(final)=4.883 | 2407.9 samples/s | 37.6 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.00985 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.791 | L2-Norm(final)=4.890 | 5875.5 samples/s | 91.8 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.00790 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.777 | L2-Norm(final)=4.895 | 2461.3 samples/s | 38.5 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.00659 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.753 | L2-Norm(final)=4.899 | 5486.2 samples/s | 85.7 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.00565 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.722 | L2-Norm(final)=4.902 | 2564.3 samples/s | 40.1 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.00495 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.688 | L2-Norm(final)=4.904 | 5034.0 samples/s | 78.7 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.00440 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.650 | L2-Norm(final)=4.906 | 2734.9 samples/s | 42.7 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.00396 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.611 | L2-Norm(final)=4.908 | 4562.6 samples/s | 71.3 steps/s
[Step=1050 Epoch=10.0] | Loss=0.00360 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.569 | L2-Norm(final)=4.910 | 2815.1 samples/s | 44.0 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00330 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.526 | L2-Norm(final)=4.911 | 4532.4 samples/s | 70.8 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00305 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.483 | L2-Norm(final)=4.912 | 2845.5 samples/s | 44.5 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00283 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.438 | L2-Norm(final)=4.914 | 4571.7 samples/s | 71.4 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00265 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.392 | L2-Norm(final)=4.915 | 2887.3 samples/s | 45.1 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00248 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.346 | L2-Norm(final)=4.916 | 4583.4 samples/s | 71.6 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00234 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.300 | L2-Norm(final)=4.917 | 2862.1 samples/s | 44.7 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00221 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.253 | L2-Norm(final)=4.918 | 4472.5 samples/s | 69.9 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00209 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.205 | L2-Norm(final)=4.919 | 6906.3 samples/s | 107.9 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00199 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.158 | L2-Norm(final)=4.920 | 2366.4 samples/s | 37.0 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00189 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.110 | L2-Norm(final)=4.920 | 6216.7 samples/s | 97.1 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00181 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.061 | L2-Norm(final)=4.921 | 2468.8 samples/s | 38.6 steps/s
[Step=1650 Epoch=15.7] | Loss=0.00173 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.013 | L2-Norm(final)=4.922 | 5575.2 samples/s | 87.1 steps/s
[Step=1700 Epoch=16.2] | Loss=0.00166 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.964 | L2-Norm(final)=4.923 | 2589.7 samples/s | 40.5 steps/s
[Step=1750 Epoch=16.6] | Loss=0.00159 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.915 | L2-Norm(final)=4.923 | 5037.4 samples/s | 78.7 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00153 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.866 | L2-Norm(final)=4.924 | 2685.3 samples/s | 42.0 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00147 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.817 | L2-Norm(final)=4.925 | 4721.6 samples/s | 73.8 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00142 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.768 | L2-Norm(final)=4.926 | 2778.6 samples/s | 43.4 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00137 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.719 | L2-Norm(final)=4.926 | 4489.1 samples/s | 70.1 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00133 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.670 | L2-Norm(final)=4.927 | 2863.3 samples/s | 44.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step2000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=37.7] | Loss=0.06461 | Reg=0.00248 | acc=0.9688 | L2-Norm=15.747 | L2-Norm(final)=6.598 | 7328.7 samples/s | 114.5 steps/s
[Step=4050 Epoch=38.2] | Loss=0.05381 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.735 | L2-Norm(final)=6.700 | 4480.5 samples/s | 70.0 steps/s
[Step=4100 Epoch=38.6] | Loss=0.05386 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.734 | L2-Norm(final)=6.835 | 8140.3 samples/s | 127.2 steps/s
[Step=4150 Epoch=39.1] | Loss=0.05231 | Reg=0.00248 | acc=0.9531 | L2-Norm=15.734 | L2-Norm(final)=6.960 | 2620.4 samples/s | 40.9 steps/s
[Step=4200 Epoch=39.6] | Loss=0.05136 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.733 | L2-Norm(final)=7.081 | 6949.6 samples/s | 108.6 steps/s
[Step=4250 Epoch=40.0] | Loss=0.05039 | Reg=0.00248 | acc=0.9531 | L2-Norm=15.733 | L2-Norm(final)=7.195 | 2693.2 samples/s | 42.1 steps/s
[Step=4300 Epoch=40.5] | Loss=0.04939 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.733 | L2-Norm(final)=7.302 | 6285.4 samples/s | 98.2 steps/s
[Step=4350 Epoch=41.0] | Loss=0.04928 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.733 | L2-Norm(final)=7.405 | 2870.8 samples/s | 44.9 steps/s
[Step=4400 Epoch=41.5] | Loss=0.04843 | Reg=0.00248 | acc=0.9688 | L2-Norm=15.733 | L2-Norm(final)=7.504 | 5627.4 samples/s | 87.9 steps/s
[Step=4450 Epoch=41.9] | Loss=0.04799 | Reg=0.00248 | acc=0.9688 | L2-Norm=15.733 | L2-Norm(final)=7.598 | 3049.3 samples/s | 47.6 steps/s
[Step=4500 Epoch=42.4] | Loss=0.04717 | Reg=0.00248 | acc=0.9688 | L2-Norm=15.733 | L2-Norm(final)=7.690 | 5176.4 samples/s | 80.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.4] | Loss=0.03599 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.733 | L2-Norm(final)=8.589 | 6967.0 samples/s | 108.9 steps/s
[Step=4550 Epoch=42.9] | Loss=0.03505 | Reg=0.00258 | acc=0.9844 | L2-Norm=16.047 | L2-Norm(final)=8.582 | 4107.9 samples/s | 64.2 steps/s
[Step=4600 Epoch=43.3] | Loss=0.02177 | Reg=0.00263 | acc=0.9844 | L2-Norm=16.211 | L2-Norm(final)=8.567 | 6348.7 samples/s | 99.2 steps/s
[Step=4650 Epoch=43.8] | Loss=0.02057 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.293 | L2-Norm(final)=8.551 | 2422.9 samples/s | 37.9 steps/s
[Step=4700 Epoch=44.3] | Loss=0.01655 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.353 | L2-Norm(final)=8.535 | 5667.3 samples/s | 88.6 steps/s
[Step=4750 Epoch=44.8] | Loss=0.01346 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.381 | L2-Norm(final)=8.525 | 2513.3 samples/s | 39.3 steps/s
[Step=4800 Epoch=45.2] | Loss=0.01258 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.391 | L2-Norm(final)=8.516 | 5250.6 samples/s | 82.0 steps/s
[Step=4850 Epoch=45.7] | Loss=0.01109 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.391 | L2-Norm(final)=8.509 | 2637.2 samples/s | 41.2 steps/s
[Step=4900 Epoch=46.2] | Loss=0.00982 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.384 | L2-Norm(final)=8.504 | 4825.3 samples/s | 75.4 steps/s
[Step=4950 Epoch=46.6] | Loss=0.00893 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.371 | L2-Norm(final)=8.501 | 2781.9 samples/s | 43.5 steps/s
[Step=5000 Epoch=47.1] | Loss=0.00810 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.353 | L2-Norm(final)=8.499 | 4578.9 samples/s | 71.5 steps/s
[Step=5050 Epoch=47.6] | Loss=0.00737 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.332 | L2-Norm(final)=8.497 | 2874.1 samples/s | 44.9 steps/s
[Step=5100 Epoch=48.1] | Loss=0.00676 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.307 | L2-Norm(final)=8.496 | 4518.6 samples/s | 70.6 steps/s
[Step=5150 Epoch=48.5] | Loss=0.00624 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.280 | L2-Norm(final)=8.495 | 2849.6 samples/s | 44.5 steps/s
[Step=5200 Epoch=49.0] | Loss=0.00580 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.250 | L2-Norm(final)=8.494 | 4636.4 samples/s | 72.4 steps/s
[Step=5250 Epoch=49.5] | Loss=0.00541 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.220 | L2-Norm(final)=8.494 | 2975.6 samples/s | 46.5 steps/s
[Step=5300 Epoch=49.9] | Loss=0.00508 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.188 | L2-Norm(final)=8.493 | 4189.3 samples/s | 65.5 steps/s
[Step=5350 Epoch=50.4] | Loss=0.00478 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.155 | L2-Norm(final)=8.493 | 6571.4 samples/s | 102.7 steps/s
[Step=5400 Epoch=50.9] | Loss=0.00451 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.121 | L2-Norm(final)=8.493 | 2418.7 samples/s | 37.8 steps/s
[Step=5450 Epoch=51.4] | Loss=0.00428 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.087 | L2-Norm(final)=8.492 | 5780.7 samples/s | 90.3 steps/s
[Step=5500 Epoch=51.8] | Loss=0.00406 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.052 | L2-Norm(final)=8.492 | 2502.2 samples/s | 39.1 steps/s
[Step=5550 Epoch=52.3] | Loss=0.00387 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.017 | L2-Norm(final)=8.492 | 5347.6 samples/s | 83.6 steps/s
[Step=5600 Epoch=52.8] | Loss=0.00369 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.982 | L2-Norm(final)=8.492 | 2622.5 samples/s | 41.0 steps/s
[Step=5650 Epoch=53.2] | Loss=0.00353 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.946 | L2-Norm(final)=8.492 | 4844.6 samples/s | 75.7 steps/s
[Step=5700 Epoch=53.7] | Loss=0.00339 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.910 | L2-Norm(final)=8.492 | 2801.2 samples/s | 43.8 steps/s
[Step=5750 Epoch=54.2] | Loss=0.00325 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.874 | L2-Norm(final)=8.492 | 4433.8 samples/s | 69.3 steps/s
[Step=5800 Epoch=54.7] | Loss=0.00313 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.838 | L2-Norm(final)=8.492 | 2864.1 samples/s | 44.8 steps/s
[Step=5850 Epoch=55.1] | Loss=0.00301 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.801 | L2-Norm(final)=8.492 | 4566.8 samples/s | 71.4 steps/s
[Step=5900 Epoch=55.6] | Loss=0.00290 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.765 | L2-Norm(final)=8.492 | 2861.9 samples/s | 44.7 steps/s
[Step=5950 Epoch=56.1] | Loss=0.00280 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.728 | L2-Norm(final)=8.492 | 4658.1 samples/s | 72.8 steps/s
[Step=6000 Epoch=56.5] | Loss=0.00271 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.692 | L2-Norm(final)=8.492 | 3133.5 samples/s | 49.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.14686 | acc=0.9323 | tpr=0.9509 | fpr=0.1083 | 6001.4 samples/s | 23.4 steps/s
Avg test loss: 0.15329, Avg test acc: 0.92788, Avg tpr: 0.94830, Avg fpr: 0.11704, total FA: 913

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.13437 | acc=0.9323 | tpr=0.9536 | fpr=0.1137 | 5922.0 samples/s | 23.1 steps/s
Avg test loss: 0.13877, Avg test acc: 0.92972, Avg tpr: 0.95116, Avg fpr: 0.11742, total FA: 916

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.14981 | acc=0.9270 | tpr=0.9514 | fpr=0.1259 | 6178.8 samples/s | 24.1 steps/s
Avg test loss: 0.15204, Avg test acc: 0.92716, Avg tpr: 0.95092, Avg fpr: 0.12511, total FA: 976

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.16686 | acc=0.9278 | tpr=0.9537 | fpr=0.1283 | 6134.4 samples/s | 24.0 steps/s
Avg test loss: 0.17592, Avg test acc: 0.92592, Avg tpr: 0.95331, Avg fpr: 0.13434, total FA: 1048

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.15852 | acc=0.9283 | tpr=0.9615 | fpr=0.1440 | 6057.0 samples/s | 23.7 steps/s
Avg test loss: 0.16170, Avg test acc: 0.92660, Avg tpr: 0.95914, Avg fpr: 0.14498, total FA: 1131

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.30884 | acc=0.3247 | tpr=0.0424 | fpr=0.0624 | 5993.9 samples/s | 23.4 steps/s
Avg test loss: 5.31101, Avg test acc: 0.32242, Avg tpr: 0.04237, Avg fpr: 0.06166, total FA: 481

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.24113 | acc=0.3235 | tpr=0.0385 | fpr=0.0575 | 5909.7 samples/s | 23.1 steps/s
Avg test loss: 5.23211, Avg test acc: 0.31886, Avg tpr: 0.03561, Avg fpr: 0.05820, total FA: 454

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.20931 | acc=0.3243 | tpr=0.0423 | fpr=0.0634 | 5825.9 samples/s | 22.8 steps/s
Avg test loss: 4.22080, Avg test acc: 0.32250, Avg tpr: 0.04127, Avg fpr: 0.05897, total FA: 460

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.65318 | acc=0.3114 | tpr=0.0240 | fpr=0.0644 | 6160.4 samples/s | 24.1 steps/s
Avg test loss: 4.64910, Avg test acc: 0.31032, Avg tpr: 0.02454, Avg fpr: 0.06115, total FA: 477

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=6.52425 | acc=0.3209 | tpr=0.0233 | fpr=0.0330 | 6165.6 samples/s | 24.1 steps/s
Avg test loss: 6.53098, Avg test acc: 0.31934, Avg tpr: 0.02407, Avg fpr: 0.03128, total FA: 244

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.87278 | acc=0.1291 | tpr=0.8230 | fpr=0.8833 | 5946.7 samples/s | 23.2 steps/s
[Step= 100] | Loss=4.86516 | acc=0.1263 | tpr=0.7932 | fpr=0.8862 | 7583.2 samples/s | 29.6 steps/s
[Step= 150] | Loss=4.85252 | acc=0.1273 | tpr=0.7954 | fpr=0.8850 | 8220.1 samples/s | 32.1 steps/s
[Step= 200] | Loss=4.86125 | acc=0.1268 | tpr=0.7869 | fpr=0.8852 | 7772.0 samples/s | 30.4 steps/s
[Step= 250] | Loss=4.87290 | acc=0.1270 | tpr=0.7886 | fpr=0.8850 | 7966.6 samples/s | 31.1 steps/s
[Step= 300] | Loss=4.86946 | acc=0.1274 | tpr=0.7956 | fpr=0.8848 | 8114.9 samples/s | 31.7 steps/s
[Step= 350] | Loss=4.87167 | acc=0.1274 | tpr=0.7921 | fpr=0.8847 | 8130.0 samples/s | 31.8 steps/s
[Step= 400] | Loss=4.86841 | acc=0.1278 | tpr=0.7888 | fpr=0.8842 | 8368.0 samples/s | 32.7 steps/s
[Step= 450] | Loss=4.87358 | acc=0.1274 | tpr=0.7882 | fpr=0.8846 | 7873.6 samples/s | 30.8 steps/s
[Step= 500] | Loss=4.87414 | acc=0.1273 | tpr=0.7912 | fpr=0.8847 | 7924.1 samples/s | 31.0 steps/s
[Step= 550] | Loss=4.87599 | acc=0.1272 | tpr=0.7931 | fpr=0.8849 | 10831.4 samples/s | 42.3 steps/s
Avg test loss: 4.87693, Avg test acc: 0.12720, Avg tpr: 0.79358, Avg fpr: 0.88492, total FA: 122869

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.12967 | acc=0.1580 | tpr=0.8363 | fpr=0.8541 | 6047.1 samples/s | 23.6 steps/s
[Step= 100] | Loss=4.10996 | acc=0.1581 | tpr=0.8060 | fpr=0.8540 | 7599.1 samples/s | 29.7 steps/s
[Step= 150] | Loss=4.10382 | acc=0.1590 | tpr=0.8026 | fpr=0.8529 | 7689.4 samples/s | 30.0 steps/s
[Step= 200] | Loss=4.08617 | acc=0.1604 | tpr=0.7989 | fpr=0.8512 | 8150.9 samples/s | 31.8 steps/s
[Step= 250] | Loss=4.08795 | acc=0.1603 | tpr=0.7956 | fpr=0.8513 | 8325.6 samples/s | 32.5 steps/s
[Step= 300] | Loss=4.08159 | acc=0.1602 | tpr=0.7935 | fpr=0.8514 | 8085.7 samples/s | 31.6 steps/s
[Step= 350] | Loss=4.08155 | acc=0.1602 | tpr=0.7927 | fpr=0.8513 | 7960.1 samples/s | 31.1 steps/s
[Step= 400] | Loss=4.08412 | acc=0.1603 | tpr=0.7872 | fpr=0.8511 | 7885.0 samples/s | 30.8 steps/s
[Step= 450] | Loss=4.08822 | acc=0.1596 | tpr=0.7848 | fpr=0.8517 | 8133.4 samples/s | 31.8 steps/s
[Step= 500] | Loss=4.08651 | acc=0.1597 | tpr=0.7850 | fpr=0.8516 | 7364.0 samples/s | 28.8 steps/s
[Step= 550] | Loss=4.08435 | acc=0.1599 | tpr=0.7851 | fpr=0.8515 | 12020.5 samples/s | 47.0 steps/s
Avg test loss: 4.08492, Avg test acc: 0.15969, Avg tpr: 0.78487, Avg fpr: 0.85167, total FA: 118253

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.93782 | acc=0.1143 | tpr=0.9248 | fpr=0.9003 | 5960.9 samples/s | 23.3 steps/s
[Step= 100] | Loss=5.94078 | acc=0.1144 | tpr=0.9126 | fpr=0.9005 | 8021.2 samples/s | 31.3 steps/s
[Step= 150] | Loss=5.94017 | acc=0.1141 | tpr=0.9049 | fpr=0.9004 | 7150.1 samples/s | 27.9 steps/s
[Step= 200] | Loss=5.93827 | acc=0.1140 | tpr=0.9071 | fpr=0.9004 | 8496.2 samples/s | 33.2 steps/s
[Step= 250] | Loss=5.94475 | acc=0.1145 | tpr=0.9074 | fpr=0.8999 | 8690.6 samples/s | 33.9 steps/s
[Step= 300] | Loss=5.94118 | acc=0.1142 | tpr=0.9069 | fpr=0.9003 | 7663.9 samples/s | 29.9 steps/s
[Step= 350] | Loss=5.93808 | acc=0.1141 | tpr=0.9105 | fpr=0.9004 | 7503.3 samples/s | 29.3 steps/s
[Step= 400] | Loss=5.94227 | acc=0.1143 | tpr=0.9108 | fpr=0.9002 | 8319.6 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.94462 | acc=0.1139 | tpr=0.9133 | fpr=0.9006 | 8491.4 samples/s | 33.2 steps/s
[Step= 500] | Loss=5.94519 | acc=0.1139 | tpr=0.9154 | fpr=0.9006 | 8527.3 samples/s | 33.3 steps/s
[Step= 550] | Loss=5.94476 | acc=0.1142 | tpr=0.9152 | fpr=0.9003 | 9798.5 samples/s | 38.3 steps/s
Avg test loss: 5.94495, Avg test acc: 0.11417, Avg tpr: 0.91561, Avg fpr: 0.90040, total FA: 125019

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.53522 | acc=0.1540 | tpr=0.8673 | fpr=0.8588 | 5874.5 samples/s | 22.9 steps/s
[Step= 100] | Loss=5.50511 | acc=0.1539 | tpr=0.8571 | fpr=0.8593 | 7771.5 samples/s | 30.4 steps/s
[Step= 150] | Loss=5.49459 | acc=0.1522 | tpr=0.8473 | fpr=0.8606 | 7847.4 samples/s | 30.7 steps/s
[Step= 200] | Loss=5.48363 | acc=0.1523 | tpr=0.8339 | fpr=0.8601 | 8850.0 samples/s | 34.6 steps/s
[Step= 250] | Loss=5.49561 | acc=0.1521 | tpr=0.8314 | fpr=0.8602 | 7714.5 samples/s | 30.1 steps/s
[Step= 300] | Loss=5.48589 | acc=0.1518 | tpr=0.8305 | fpr=0.8606 | 7751.4 samples/s | 30.3 steps/s
[Step= 350] | Loss=5.48900 | acc=0.1516 | tpr=0.8284 | fpr=0.8606 | 7938.8 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.49051 | acc=0.1514 | tpr=0.8277 | fpr=0.8609 | 8537.8 samples/s | 33.4 steps/s
[Step= 450] | Loss=5.49167 | acc=0.1509 | tpr=0.8286 | fpr=0.8614 | 8207.5 samples/s | 32.1 steps/s
[Step= 500] | Loss=5.49130 | acc=0.1509 | tpr=0.8291 | fpr=0.8613 | 7849.9 samples/s | 30.7 steps/s
[Step= 550] | Loss=5.49275 | acc=0.1509 | tpr=0.8321 | fpr=0.8615 | 10025.9 samples/s | 39.2 steps/s
Avg test loss: 5.49343, Avg test acc: 0.15080, Avg tpr: 0.83162, Avg fpr: 0.86158, total FA: 119628

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.08212 | acc=0.1416 | tpr=0.8230 | fpr=0.8707 | 5864.3 samples/s | 22.9 steps/s
[Step= 100] | Loss=5.06630 | acc=0.1419 | tpr=0.8230 | fpr=0.8708 | 8293.3 samples/s | 32.4 steps/s
[Step= 150] | Loss=5.06635 | acc=0.1420 | tpr=0.8300 | fpr=0.8707 | 7749.1 samples/s | 30.3 steps/s
[Step= 200] | Loss=5.07021 | acc=0.1420 | tpr=0.8328 | fpr=0.8706 | 7930.5 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.08106 | acc=0.1416 | tpr=0.8332 | fpr=0.8710 | 7175.3 samples/s | 28.0 steps/s
[Step= 300] | Loss=5.07894 | acc=0.1418 | tpr=0.8364 | fpr=0.8709 | 8698.5 samples/s | 34.0 steps/s
[Step= 350] | Loss=5.08432 | acc=0.1416 | tpr=0.8384 | fpr=0.8711 | 8141.0 samples/s | 31.8 steps/s
[Step= 400] | Loss=5.08845 | acc=0.1416 | tpr=0.8359 | fpr=0.8710 | 7186.4 samples/s | 28.1 steps/s
[Step= 450] | Loss=5.09040 | acc=0.1411 | tpr=0.8374 | fpr=0.8716 | 8430.2 samples/s | 32.9 steps/s
[Step= 500] | Loss=5.08544 | acc=0.1415 | tpr=0.8374 | fpr=0.8711 | 7301.7 samples/s | 28.5 steps/s
[Step= 550] | Loss=5.08962 | acc=0.1415 | tpr=0.8376 | fpr=0.8712 | 12503.8 samples/s | 48.8 steps/s
Avg test loss: 5.09074, Avg test acc: 0.14141, Avg tpr: 0.83835, Avg fpr: 0.87125, total FA: 120972

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14700 | acc=0.9590 | tpr=0.8805 | fpr=0.0396 | 5979.5 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.15233 | acc=0.9584 | tpr=0.8955 | fpr=0.0404 | 7661.0 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.15180 | acc=0.9582 | tpr=0.8991 | fpr=0.0407 | 8589.3 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.15117 | acc=0.9578 | tpr=0.9016 | fpr=0.0412 | 7814.3 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.15188 | acc=0.9576 | tpr=0.8961 | fpr=0.0413 | 7832.6 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.15326 | acc=0.9573 | tpr=0.8887 | fpr=0.0414 | 8043.3 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.15311 | acc=0.9573 | tpr=0.8910 | fpr=0.0415 | 7650.3 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.15331 | acc=0.9571 | tpr=0.8889 | fpr=0.0416 | 8597.8 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.15454 | acc=0.9567 | tpr=0.8895 | fpr=0.0421 | 8151.1 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.15484 | acc=0.9565 | tpr=0.8912 | fpr=0.0424 | 7882.2 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.15441 | acc=0.9567 | tpr=0.8918 | fpr=0.0422 | 10132.3 samples/s | 39.6 steps/s
Avg test loss: 0.15424, Avg test acc: 0.95669, Avg tpr: 0.89184, Avg fpr: 0.04213, total FA: 5850

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15672 | acc=0.9577 | tpr=0.8805 | fpr=0.0409 | 6237.1 samples/s | 24.4 steps/s
[Step= 100] | Loss=0.16137 | acc=0.9566 | tpr=0.9083 | fpr=0.0425 | 6941.1 samples/s | 27.1 steps/s
[Step= 150] | Loss=0.16212 | acc=0.9559 | tpr=0.9078 | fpr=0.0432 | 7980.8 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.16284 | acc=0.9558 | tpr=0.9060 | fpr=0.0433 | 8255.2 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.16253 | acc=0.9558 | tpr=0.9004 | fpr=0.0431 | 8404.3 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.16465 | acc=0.9553 | tpr=0.8982 | fpr=0.0437 | 8011.3 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.16352 | acc=0.9556 | tpr=0.8992 | fpr=0.0434 | 8499.6 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.16411 | acc=0.9552 | tpr=0.8955 | fpr=0.0437 | 7949.7 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.16581 | acc=0.9547 | tpr=0.8909 | fpr=0.0441 | 7999.4 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.16592 | acc=0.9547 | tpr=0.8938 | fpr=0.0442 | 7131.0 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.16499 | acc=0.9551 | tpr=0.8942 | fpr=0.0438 | 11889.7 samples/s | 46.4 steps/s
Avg test loss: 0.16472, Avg test acc: 0.95509, Avg tpr: 0.89461, Avg fpr: 0.04381, total FA: 6083

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.22424 | acc=0.9466 | tpr=0.9381 | fpr=0.0532 | 6020.3 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.23074 | acc=0.9462 | tpr=0.9318 | fpr=0.0536 | 8020.3 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.23536 | acc=0.9452 | tpr=0.9323 | fpr=0.0546 | 8053.3 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.23671 | acc=0.9455 | tpr=0.9366 | fpr=0.0543 | 7804.4 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.23777 | acc=0.9454 | tpr=0.9293 | fpr=0.0543 | 7835.9 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.24002 | acc=0.9446 | tpr=0.9244 | fpr=0.0550 | 8061.4 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.23866 | acc=0.9449 | tpr=0.9261 | fpr=0.0547 | 8191.8 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.23984 | acc=0.9445 | tpr=0.9240 | fpr=0.0551 | 7735.4 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.24044 | acc=0.9442 | tpr=0.9231 | fpr=0.0554 | 7838.3 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.24167 | acc=0.9439 | tpr=0.9238 | fpr=0.0557 | 8683.3 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.24048 | acc=0.9442 | tpr=0.9252 | fpr=0.0554 | 9887.1 samples/s | 38.6 steps/s
Avg test loss: 0.24028, Avg test acc: 0.94428, Avg tpr: 0.92512, Avg fpr: 0.05537, total FA: 7688

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.12181 | acc=0.9643 | tpr=0.8717 | fpr=0.0340 | 6076.5 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.13094 | acc=0.9614 | tpr=0.8827 | fpr=0.0371 | 7842.6 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.13365 | acc=0.9603 | tpr=0.8847 | fpr=0.0383 | 7308.6 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.13392 | acc=0.9604 | tpr=0.8874 | fpr=0.0382 | 7905.7 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.13496 | acc=0.9605 | tpr=0.8856 | fpr=0.0381 | 8486.6 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.13725 | acc=0.9600 | tpr=0.8815 | fpr=0.0386 | 7688.1 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.13680 | acc=0.9602 | tpr=0.8860 | fpr=0.0385 | 8298.8 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.13807 | acc=0.9599 | tpr=0.8824 | fpr=0.0387 | 8341.5 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.13948 | acc=0.9595 | tpr=0.8822 | fpr=0.0391 | 8637.4 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.13983 | acc=0.9595 | tpr=0.8819 | fpr=0.0391 | 7863.6 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.13938 | acc=0.9597 | tpr=0.8834 | fpr=0.0389 | 9651.8 samples/s | 37.7 steps/s
Avg test loss: 0.13905, Avg test acc: 0.95972, Avg tpr: 0.88312, Avg fpr: 0.03889, total FA: 5400

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.22702 | acc=0.9487 | tpr=0.8938 | fpr=0.0503 | 5695.2 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.23162 | acc=0.9486 | tpr=0.9211 | fpr=0.0509 | 7889.9 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.23198 | acc=0.9476 | tpr=0.9294 | fpr=0.0520 | 8123.5 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.23214 | acc=0.9478 | tpr=0.9268 | fpr=0.0518 | 7900.9 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.23484 | acc=0.9474 | tpr=0.9223 | fpr=0.0522 | 8091.8 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.23785 | acc=0.9466 | tpr=0.9222 | fpr=0.0529 | 8300.9 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.23615 | acc=0.9467 | tpr=0.9205 | fpr=0.0528 | 7983.5 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.23682 | acc=0.9464 | tpr=0.9168 | fpr=0.0530 | 7949.9 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.23841 | acc=0.9461 | tpr=0.9143 | fpr=0.0533 | 8024.9 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.23950 | acc=0.9458 | tpr=0.9150 | fpr=0.0537 | 8479.5 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.23841 | acc=0.9462 | tpr=0.9140 | fpr=0.0532 | 10338.7 samples/s | 40.4 steps/s
Avg test loss: 0.23804, Avg test acc: 0.94623, Avg tpr: 0.91442, Avg fpr: 0.05319, total FA: 7386

server round 4/50

clients selected: [1 2 5 6 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.14883 | Reg=0.00224 | acc=0.8750 | L2-Norm=14.959 | L2-Norm(final)=5.221 | 7536.1 samples/s | 117.8 steps/s
[Step=4050 Epoch=19.8] | Loss=0.12726 | Reg=0.00224 | acc=0.9219 | L2-Norm=14.959 | L2-Norm(final)=5.230 | 4714.7 samples/s | 73.7 steps/s
[Step=4100 Epoch=20.0] | Loss=0.13249 | Reg=0.00224 | acc=0.8125 | L2-Norm=14.960 | L2-Norm(final)=5.254 | 5496.7 samples/s | 85.9 steps/s
[Step=4150 Epoch=20.3] | Loss=0.12857 | Reg=0.00224 | acc=0.9219 | L2-Norm=14.960 | L2-Norm(final)=5.291 | 5562.3 samples/s | 86.9 steps/s
[Step=4200 Epoch=20.5] | Loss=0.12696 | Reg=0.00224 | acc=0.9219 | L2-Norm=14.960 | L2-Norm(final)=5.339 | 8742.5 samples/s | 136.6 steps/s
[Step=4250 Epoch=20.7] | Loss=0.12612 | Reg=0.00224 | acc=0.8438 | L2-Norm=14.960 | L2-Norm(final)=5.387 | 2660.6 samples/s | 41.6 steps/s
[Step=4300 Epoch=21.0] | Loss=0.12584 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.960 | L2-Norm(final)=5.435 | 5647.6 samples/s | 88.2 steps/s
[Step=4350 Epoch=21.2] | Loss=0.12572 | Reg=0.00224 | acc=0.9062 | L2-Norm=14.960 | L2-Norm(final)=5.480 | 5612.8 samples/s | 87.7 steps/s
[Step=4400 Epoch=21.5] | Loss=0.12407 | Reg=0.00224 | acc=0.8594 | L2-Norm=14.960 | L2-Norm(final)=5.527 | 7581.3 samples/s | 118.5 steps/s
[Step=4450 Epoch=21.7] | Loss=0.12357 | Reg=0.00224 | acc=0.9375 | L2-Norm=14.960 | L2-Norm(final)=5.574 | 2713.3 samples/s | 42.4 steps/s
[Step=4500 Epoch=22.0] | Loss=0.12330 | Reg=0.00224 | acc=0.8906 | L2-Norm=14.960 | L2-Norm(final)=5.620 | 5436.6 samples/s | 84.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=22.0] | Loss=0.14708 | Reg=0.00224 | acc=0.8750 | L2-Norm=14.960 | L2-Norm(final)=6.068 | 7246.7 samples/s | 113.2 steps/s
[Step=4550 Epoch=22.2] | Loss=0.10786 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.152 | L2-Norm(final)=6.071 | 4291.3 samples/s | 67.1 steps/s
[Step=4600 Epoch=22.4] | Loss=0.10350 | Reg=0.00235 | acc=0.9688 | L2-Norm=15.326 | L2-Norm(final)=6.055 | 4833.7 samples/s | 75.5 steps/s
[Step=4650 Epoch=22.7] | Loss=0.10177 | Reg=0.00239 | acc=0.9531 | L2-Norm=15.460 | L2-Norm(final)=6.040 | 4635.4 samples/s | 72.4 steps/s
[Step=4700 Epoch=22.9] | Loss=0.09568 | Reg=0.00242 | acc=0.9531 | L2-Norm=15.563 | L2-Norm(final)=6.026 | 6876.6 samples/s | 107.4 steps/s
[Step=4750 Epoch=23.2] | Loss=0.08658 | Reg=0.00245 | acc=0.9062 | L2-Norm=15.647 | L2-Norm(final)=6.018 | 2482.9 samples/s | 38.8 steps/s
[Step=4800 Epoch=23.4] | Loss=0.08027 | Reg=0.00247 | acc=0.9688 | L2-Norm=15.717 | L2-Norm(final)=6.014 | 4710.8 samples/s | 73.6 steps/s
[Step=4850 Epoch=23.7] | Loss=0.07624 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.782 | L2-Norm(final)=6.012 | 4778.4 samples/s | 74.7 steps/s
[Step=4900 Epoch=23.9] | Loss=0.07410 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.841 | L2-Norm(final)=6.009 | 6375.4 samples/s | 99.6 steps/s
[Step=4950 Epoch=24.2] | Loss=0.07024 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.897 | L2-Norm(final)=6.005 | 2429.1 samples/s | 38.0 steps/s
[Step=5000 Epoch=24.4] | Loss=0.06721 | Reg=0.00255 | acc=0.9688 | L2-Norm=15.951 | L2-Norm(final)=6.004 | 4717.5 samples/s | 73.7 steps/s
[Step=5050 Epoch=24.6] | Loss=0.06460 | Reg=0.00256 | acc=0.9531 | L2-Norm=16.002 | L2-Norm(final)=6.002 | 4817.3 samples/s | 75.3 steps/s
[Step=5100 Epoch=24.9] | Loss=0.06253 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.049 | L2-Norm(final)=6.000 | 5853.4 samples/s | 91.5 steps/s
[Step=5150 Epoch=25.1] | Loss=0.05995 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.094 | L2-Norm(final)=5.999 | 2630.0 samples/s | 41.1 steps/s
[Step=5200 Epoch=25.4] | Loss=0.05727 | Reg=0.00261 | acc=0.9688 | L2-Norm=16.135 | L2-Norm(final)=5.997 | 4724.6 samples/s | 73.8 steps/s
[Step=5250 Epoch=25.6] | Loss=0.05501 | Reg=0.00262 | acc=0.9688 | L2-Norm=16.172 | L2-Norm(final)=5.996 | 4793.7 samples/s | 74.9 steps/s
[Step=5300 Epoch=25.9] | Loss=0.05348 | Reg=0.00263 | acc=0.9844 | L2-Norm=16.205 | L2-Norm(final)=5.994 | 5493.0 samples/s | 85.8 steps/s
[Step=5350 Epoch=26.1] | Loss=0.05145 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.236 | L2-Norm(final)=5.993 | 2731.5 samples/s | 42.7 steps/s
[Step=5400 Epoch=26.3] | Loss=0.04958 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.265 | L2-Norm(final)=5.993 | 4663.4 samples/s | 72.9 steps/s
[Step=5450 Epoch=26.6] | Loss=0.04790 | Reg=0.00266 | acc=0.9688 | L2-Norm=16.293 | L2-Norm(final)=5.994 | 4792.2 samples/s | 74.9 steps/s
[Step=5500 Epoch=26.8] | Loss=0.04668 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.320 | L2-Norm(final)=5.994 | 5165.7 samples/s | 80.7 steps/s
[Step=5550 Epoch=27.1] | Loss=0.04547 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.345 | L2-Norm(final)=5.994 | 2801.4 samples/s | 43.8 steps/s
[Step=5600 Epoch=27.3] | Loss=0.04440 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.370 | L2-Norm(final)=5.994 | 4739.9 samples/s | 74.1 steps/s
[Step=5650 Epoch=27.6] | Loss=0.04312 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.394 | L2-Norm(final)=5.994 | 4817.5 samples/s | 75.3 steps/s
[Step=5700 Epoch=27.8] | Loss=0.04200 | Reg=0.00270 | acc=0.9844 | L2-Norm=16.417 | L2-Norm(final)=5.994 | 4853.7 samples/s | 75.8 steps/s
[Step=5750 Epoch=28.1] | Loss=0.04130 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.439 | L2-Norm(final)=5.994 | 2887.9 samples/s | 45.1 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04033 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.461 | L2-Norm(final)=5.994 | 4771.4 samples/s | 74.6 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03947 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.482 | L2-Norm(final)=5.994 | 4785.2 samples/s | 74.8 steps/s
[Step=5900 Epoch=28.8] | Loss=0.03866 | Reg=0.00273 | acc=0.9844 | L2-Norm=16.502 | L2-Norm(final)=5.995 | 4732.6 samples/s | 73.9 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03781 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.521 | L2-Norm(final)=5.995 | 2973.0 samples/s | 46.5 steps/s
[Step=6000 Epoch=29.3] | Loss=0.03699 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.540 | L2-Norm(final)=5.996 | 4768.6 samples/s | 74.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step6000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=29.2] | Loss=0.11494 | Reg=0.00224 | acc=0.8906 | L2-Norm=14.959 | L2-Norm(final)=5.962 | 8009.8 samples/s | 125.2 steps/s
[Step=6050 Epoch=29.5] | Loss=0.12304 | Reg=0.00224 | acc=0.8438 | L2-Norm=14.959 | L2-Norm(final)=5.981 | 4576.2 samples/s | 71.5 steps/s
[Step=6100 Epoch=29.7] | Loss=0.12365 | Reg=0.00224 | acc=0.8438 | L2-Norm=14.959 | L2-Norm(final)=6.005 | 5544.2 samples/s | 86.6 steps/s
[Step=6150 Epoch=30.0] | Loss=0.12072 | Reg=0.00224 | acc=0.8594 | L2-Norm=14.959 | L2-Norm(final)=6.036 | 5596.2 samples/s | 87.4 steps/s
[Step=6200 Epoch=30.2] | Loss=0.12220 | Reg=0.00224 | acc=0.9219 | L2-Norm=14.959 | L2-Norm(final)=6.072 | 8671.5 samples/s | 135.5 steps/s
[Step=6250 Epoch=30.5] | Loss=0.12173 | Reg=0.00224 | acc=0.8750 | L2-Norm=14.959 | L2-Norm(final)=6.107 | 2711.1 samples/s | 42.4 steps/s
[Step=6300 Epoch=30.7] | Loss=0.12153 | Reg=0.00224 | acc=0.8906 | L2-Norm=14.959 | L2-Norm(final)=6.140 | 5450.4 samples/s | 85.2 steps/s
[Step=6350 Epoch=30.9] | Loss=0.12070 | Reg=0.00224 | acc=0.8594 | L2-Norm=14.959 | L2-Norm(final)=6.173 | 5529.2 samples/s | 86.4 steps/s
[Step=6400 Epoch=31.2] | Loss=0.12065 | Reg=0.00224 | acc=0.9375 | L2-Norm=14.959 | L2-Norm(final)=6.207 | 7736.1 samples/s | 120.9 steps/s
[Step=6450 Epoch=31.4] | Loss=0.11985 | Reg=0.00224 | acc=0.8906 | L2-Norm=14.959 | L2-Norm(final)=6.241 | 2815.1 samples/s | 44.0 steps/s
[Step=6500 Epoch=31.7] | Loss=0.11999 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.959 | L2-Norm(final)=6.276 | 5438.6 samples/s | 85.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=31.7] | Loss=0.10192 | Reg=0.00224 | acc=0.9219 | L2-Norm=14.959 | L2-Norm(final)=6.617 | 7096.0 samples/s | 110.9 steps/s
[Step=6550 Epoch=31.9] | Loss=0.09733 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.165 | L2-Norm(final)=6.612 | 4365.8 samples/s | 68.2 steps/s
[Step=6600 Epoch=32.2] | Loss=0.10327 | Reg=0.00235 | acc=0.9219 | L2-Norm=15.337 | L2-Norm(final)=6.580 | 4840.8 samples/s | 75.6 steps/s
[Step=6650 Epoch=32.4] | Loss=0.10038 | Reg=0.00239 | acc=0.9531 | L2-Norm=15.449 | L2-Norm(final)=6.557 | 4684.8 samples/s | 73.2 steps/s
[Step=6700 Epoch=32.6] | Loss=0.09503 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.535 | L2-Norm(final)=6.541 | 6840.0 samples/s | 106.9 steps/s
[Step=6750 Epoch=32.9] | Loss=0.08580 | Reg=0.00244 | acc=0.9375 | L2-Norm=15.613 | L2-Norm(final)=6.530 | 2483.7 samples/s | 38.8 steps/s
[Step=6800 Epoch=33.1] | Loss=0.07971 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.679 | L2-Norm(final)=6.526 | 4746.9 samples/s | 74.2 steps/s
[Step=6850 Epoch=33.4] | Loss=0.07654 | Reg=0.00248 | acc=0.9531 | L2-Norm=15.735 | L2-Norm(final)=6.522 | 4760.1 samples/s | 74.4 steps/s
[Step=6900 Epoch=33.6] | Loss=0.07289 | Reg=0.00249 | acc=0.9688 | L2-Norm=15.785 | L2-Norm(final)=6.518 | 6220.8 samples/s | 97.2 steps/s
[Step=6950 Epoch=33.9] | Loss=0.06907 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.831 | L2-Norm(final)=6.516 | 2369.0 samples/s | 37.0 steps/s
[Step=7000 Epoch=34.1] | Loss=0.06522 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.872 | L2-Norm(final)=6.515 | 4742.7 samples/s | 74.1 steps/s
[Step=7050 Epoch=34.4] | Loss=0.06253 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.911 | L2-Norm(final)=6.515 | 4852.9 samples/s | 75.8 steps/s
[Step=7100 Epoch=34.6] | Loss=0.05982 | Reg=0.00254 | acc=0.9688 | L2-Norm=15.946 | L2-Norm(final)=6.514 | 5607.6 samples/s | 87.6 steps/s
[Step=7150 Epoch=34.8] | Loss=0.05761 | Reg=0.00255 | acc=0.9844 | L2-Norm=15.980 | L2-Norm(final)=6.514 | 2493.2 samples/s | 39.0 steps/s
[Step=7200 Epoch=35.1] | Loss=0.05621 | Reg=0.00257 | acc=0.9688 | L2-Norm=16.015 | L2-Norm(final)=6.513 | 4789.4 samples/s | 74.8 steps/s
[Step=7250 Epoch=35.3] | Loss=0.05472 | Reg=0.00258 | acc=0.9531 | L2-Norm=16.051 | L2-Norm(final)=6.512 | 4729.7 samples/s | 73.9 steps/s
[Step=7300 Epoch=35.6] | Loss=0.05335 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.084 | L2-Norm(final)=6.512 | 5301.0 samples/s | 82.8 steps/s
[Step=7350 Epoch=35.8] | Loss=0.05120 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.115 | L2-Norm(final)=6.512 | 2775.2 samples/s | 43.4 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04917 | Reg=0.00261 | acc=0.9688 | L2-Norm=16.143 | L2-Norm(final)=6.513 | 4756.2 samples/s | 74.3 steps/s
[Step=7450 Epoch=36.3] | Loss=0.04753 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.169 | L2-Norm(final)=6.514 | 4809.3 samples/s | 75.1 steps/s
[Step=7500 Epoch=36.5] | Loss=0.04626 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.193 | L2-Norm(final)=6.515 | 4871.6 samples/s | 76.1 steps/s
[Step=7550 Epoch=36.8] | Loss=0.04519 | Reg=0.00263 | acc=0.9688 | L2-Norm=16.216 | L2-Norm(final)=6.516 | 2937.8 samples/s | 45.9 steps/s
[Step=7600 Epoch=37.0] | Loss=0.04399 | Reg=0.00264 | acc=0.9844 | L2-Norm=16.239 | L2-Norm(final)=6.517 | 4688.6 samples/s | 73.3 steps/s
[Step=7650 Epoch=37.3] | Loss=0.04267 | Reg=0.00265 | acc=0.9688 | L2-Norm=16.260 | L2-Norm(final)=6.519 | 4753.3 samples/s | 74.3 steps/s
[Step=7700 Epoch=37.5] | Loss=0.04174 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.280 | L2-Norm(final)=6.520 | 4776.3 samples/s | 74.6 steps/s
[Step=7750 Epoch=37.8] | Loss=0.04068 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.298 | L2-Norm(final)=6.521 | 2936.0 samples/s | 45.9 steps/s
[Step=7800 Epoch=38.0] | Loss=0.03953 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.314 | L2-Norm(final)=6.523 | 4849.4 samples/s | 75.8 steps/s
[Step=7850 Epoch=38.2] | Loss=0.03850 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.329 | L2-Norm(final)=6.525 | 4704.8 samples/s | 73.5 steps/s
[Step=7900 Epoch=38.5] | Loss=0.03764 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.343 | L2-Norm(final)=6.527 | 4726.5 samples/s | 73.9 steps/s
[Step=7950 Epoch=38.7] | Loss=0.03682 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.357 | L2-Norm(final)=6.529 | 2973.4 samples/s | 46.5 steps/s
[Step=8000 Epoch=39.0] | Loss=0.03592 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.370 | L2-Norm(final)=6.531 | 4753.4 samples/s | 74.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step8000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch=19.0] | Loss=0.08984 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.959 | L2-Norm(final)=4.175 | 6926.1 samples/s | 108.2 steps/s
[Step=2050 Epoch=19.4] | Loss=0.06456 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.949 | L2-Norm(final)=4.452 | 4824.1 samples/s | 75.4 steps/s
[Step=2100 Epoch=19.9] | Loss=0.06053 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.948 | L2-Norm(final)=4.776 | 7683.3 samples/s | 120.1 steps/s
[Step=2150 Epoch=20.4] | Loss=0.05610 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.947 | L2-Norm(final)=5.051 | 2608.3 samples/s | 40.8 steps/s
[Step=2200 Epoch=20.8] | Loss=0.05313 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.947 | L2-Norm(final)=5.290 | 7097.9 samples/s | 110.9 steps/s
[Step=2250 Epoch=21.3] | Loss=0.05059 | Reg=0.00223 | acc=0.9531 | L2-Norm=14.947 | L2-Norm(final)=5.499 | 2686.3 samples/s | 42.0 steps/s
[Step=2300 Epoch=21.8] | Loss=0.04926 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.947 | L2-Norm(final)=5.689 | 6520.9 samples/s | 101.9 steps/s
[Step=2350 Epoch=22.3] | Loss=0.04749 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.947 | L2-Norm(final)=5.861 | 2811.9 samples/s | 43.9 steps/s
[Step=2400 Epoch=22.7] | Loss=0.04616 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.947 | L2-Norm(final)=6.020 | 5849.2 samples/s | 91.4 steps/s
[Step=2450 Epoch=23.2] | Loss=0.04487 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.947 | L2-Norm(final)=6.168 | 2955.6 samples/s | 46.2 steps/s
[Step=2500 Epoch=23.7] | Loss=0.04362 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.947 | L2-Norm(final)=6.307 | 5393.4 samples/s | 84.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.7] | Loss=0.04141 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.947 | L2-Norm(final)=7.658 | 7011.1 samples/s | 109.5 steps/s
[Step=2550 Epoch=24.2] | Loss=0.03448 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.245 | L2-Norm(final)=7.656 | 4069.5 samples/s | 63.6 steps/s
[Step=2600 Epoch=24.6] | Loss=0.02362 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.411 | L2-Norm(final)=7.631 | 6594.9 samples/s | 103.0 steps/s
[Step=2650 Epoch=25.1] | Loss=0.01619 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.471 | L2-Norm(final)=7.625 | 2417.7 samples/s | 37.8 steps/s
[Step=2700 Epoch=25.6] | Loss=0.01244 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.483 | L2-Norm(final)=7.623 | 5832.8 samples/s | 91.1 steps/s
[Step=2750 Epoch=26.1] | Loss=0.01056 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.477 | L2-Norm(final)=7.621 | 2485.4 samples/s | 38.8 steps/s
[Step=2800 Epoch=26.5] | Loss=0.00884 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.462 | L2-Norm(final)=7.621 | 5447.5 samples/s | 85.1 steps/s
[Step=2850 Epoch=27.0] | Loss=0.00758 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.442 | L2-Norm(final)=7.621 | 2591.6 samples/s | 40.5 steps/s
[Step=2900 Epoch=27.5] | Loss=0.00664 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.417 | L2-Norm(final)=7.621 | 5021.0 samples/s | 78.5 steps/s
[Step=2950 Epoch=28.0] | Loss=0.00590 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.389 | L2-Norm(final)=7.622 | 2696.2 samples/s | 42.1 steps/s
[Step=3000 Epoch=28.4] | Loss=0.00531 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.359 | L2-Norm(final)=7.622 | 4663.9 samples/s | 72.9 steps/s
[Step=3050 Epoch=28.9] | Loss=0.00483 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.328 | L2-Norm(final)=7.622 | 2814.0 samples/s | 44.0 steps/s
[Step=3100 Epoch=29.4] | Loss=0.00443 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.297 | L2-Norm(final)=7.623 | 4520.0 samples/s | 70.6 steps/s
[Step=3150 Epoch=29.8] | Loss=0.00409 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.264 | L2-Norm(final)=7.623 | 2854.1 samples/s | 44.6 steps/s
[Step=3200 Epoch=30.3] | Loss=0.00380 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.231 | L2-Norm(final)=7.624 | 4584.2 samples/s | 71.6 steps/s
[Step=3250 Epoch=30.8] | Loss=0.00355 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.198 | L2-Norm(final)=7.624 | 2885.2 samples/s | 45.1 steps/s
[Step=3300 Epoch=31.3] | Loss=0.00333 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.165 | L2-Norm(final)=7.624 | 4425.2 samples/s | 69.1 steps/s
[Step=3350 Epoch=31.7] | Loss=0.00313 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.131 | L2-Norm(final)=7.625 | 3137.8 samples/s | 49.0 steps/s
[Step=3400 Epoch=32.2] | Loss=0.00296 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.097 | L2-Norm(final)=7.625 | 4123.6 samples/s | 64.4 steps/s
[Step=3450 Epoch=32.7] | Loss=0.00280 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.063 | L2-Norm(final)=7.625 | 6811.5 samples/s | 106.4 steps/s
[Step=3500 Epoch=33.2] | Loss=0.00266 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.029 | L2-Norm(final)=7.626 | 2403.0 samples/s | 37.5 steps/s
[Step=3550 Epoch=33.6] | Loss=0.00254 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.995 | L2-Norm(final)=7.626 | 5933.6 samples/s | 92.7 steps/s
[Step=3600 Epoch=34.1] | Loss=0.00242 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.961 | L2-Norm(final)=7.627 | 2460.2 samples/s | 38.4 steps/s
[Step=3650 Epoch=34.6] | Loss=0.00232 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.927 | L2-Norm(final)=7.627 | 5552.1 samples/s | 86.8 steps/s
[Step=3700 Epoch=35.1] | Loss=0.00222 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.893 | L2-Norm(final)=7.627 | 2525.2 samples/s | 39.5 steps/s
[Step=3750 Epoch=35.5] | Loss=0.00213 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.859 | L2-Norm(final)=7.628 | 5151.8 samples/s | 80.5 steps/s
[Step=3800 Epoch=36.0] | Loss=0.00205 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.824 | L2-Norm(final)=7.628 | 2674.0 samples/s | 41.8 steps/s
[Step=3850 Epoch=36.5] | Loss=0.00197 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.790 | L2-Norm(final)=7.628 | 4740.2 samples/s | 74.1 steps/s
[Step=3900 Epoch=37.0] | Loss=0.00190 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.756 | L2-Norm(final)=7.629 | 2761.4 samples/s | 43.1 steps/s
[Step=3950 Epoch=37.4] | Loss=0.00184 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.722 | L2-Norm(final)=7.629 | 4561.0 samples/s | 71.3 steps/s
[Step=4000 Epoch=37.9] | Loss=0.00178 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.687 | L2-Norm(final)=7.629 | 2844.7 samples/s | 44.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step4000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch=19.0] | Loss=0.06592 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.959 | L2-Norm(final)=4.949 | 7476.0 samples/s | 116.8 steps/s
[Step=2050 Epoch=19.5] | Loss=0.06154 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.942 | L2-Norm(final)=5.133 | 4416.0 samples/s | 69.0 steps/s
[Step=2100 Epoch=20.0] | Loss=0.05736 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.940 | L2-Norm(final)=5.357 | 8377.4 samples/s | 130.9 steps/s
[Step=2150 Epoch=20.5] | Loss=0.05705 | Reg=0.00223 | acc=0.9531 | L2-Norm=14.940 | L2-Norm(final)=5.556 | 2568.0 samples/s | 40.1 steps/s
[Step=2200 Epoch=20.9] | Loss=0.05541 | Reg=0.00223 | acc=0.9531 | L2-Norm=14.939 | L2-Norm(final)=5.731 | 7396.3 samples/s | 115.6 steps/s
[Step=2250 Epoch=21.4] | Loss=0.05423 | Reg=0.00223 | acc=0.9219 | L2-Norm=14.939 | L2-Norm(final)=5.891 | 2690.2 samples/s | 42.0 steps/s
[Step=2300 Epoch=21.9] | Loss=0.05224 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.939 | L2-Norm(final)=6.039 | 6550.8 samples/s | 102.4 steps/s
[Step=2350 Epoch=22.4] | Loss=0.05213 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.939 | L2-Norm(final)=6.172 | 2865.9 samples/s | 44.8 steps/s
[Step=2400 Epoch=22.8] | Loss=0.05119 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.939 | L2-Norm(final)=6.296 | 5652.5 samples/s | 88.3 steps/s
[Step=2450 Epoch=23.3] | Loss=0.05068 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.939 | L2-Norm(final)=6.413 | 2954.1 samples/s | 46.2 steps/s
[Step=2500 Epoch=23.8] | Loss=0.05040 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.939 | L2-Norm(final)=6.523 | 5408.2 samples/s | 84.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.8] | Loss=0.03454 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.938 | L2-Norm(final)=7.587 | 6784.1 samples/s | 106.0 steps/s
[Step=2550 Epoch=24.3] | Loss=0.05297 | Reg=0.00242 | acc=0.9531 | L2-Norm=15.544 | L2-Norm(final)=7.546 | 4096.7 samples/s | 64.0 steps/s
[Step=2600 Epoch=24.7] | Loss=0.03304 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.933 | L2-Norm(final)=7.503 | 6650.5 samples/s | 103.9 steps/s
[Step=2650 Epoch=25.2] | Loss=0.02237 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.067 | L2-Norm(final)=7.492 | 2393.6 samples/s | 37.4 steps/s
[Step=2700 Epoch=25.7] | Loss=0.01683 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.102 | L2-Norm(final)=7.489 | 5982.8 samples/s | 93.5 steps/s
[Step=2750 Epoch=26.2] | Loss=0.01348 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.093 | L2-Norm(final)=7.488 | 2484.5 samples/s | 38.8 steps/s
[Step=2800 Epoch=26.6] | Loss=0.01124 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.063 | L2-Norm(final)=7.487 | 5384.1 samples/s | 84.1 steps/s
[Step=2850 Epoch=27.1] | Loss=0.00964 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.022 | L2-Norm(final)=7.488 | 2604.5 samples/s | 40.7 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00843 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.975 | L2-Norm(final)=7.488 | 4981.6 samples/s | 77.8 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00750 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.924 | L2-Norm(final)=7.488 | 2717.9 samples/s | 42.5 steps/s
[Step=3000 Epoch=28.5] | Loss=0.00675 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.871 | L2-Norm(final)=7.488 | 4586.0 samples/s | 71.7 steps/s
[Step=3050 Epoch=29.0] | Loss=0.00614 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.818 | L2-Norm(final)=7.489 | 2828.5 samples/s | 44.2 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00563 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.763 | L2-Norm(final)=7.489 | 4484.9 samples/s | 70.1 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00520 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.709 | L2-Norm(final)=7.490 | 2912.2 samples/s | 45.5 steps/s
[Step=3200 Epoch=30.4] | Loss=0.00483 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.654 | L2-Norm(final)=7.490 | 4452.4 samples/s | 69.6 steps/s
[Step=3250 Epoch=30.9] | Loss=0.00450 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.600 | L2-Norm(final)=7.491 | 2860.3 samples/s | 44.7 steps/s
[Step=3300 Epoch=31.4] | Loss=0.00422 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.546 | L2-Norm(final)=7.491 | 4629.5 samples/s | 72.3 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00398 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.492 | L2-Norm(final)=7.492 | 2961.1 samples/s | 46.3 steps/s
[Step=3400 Epoch=32.3] | Loss=0.00376 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.439 | L2-Norm(final)=7.492 | 4218.5 samples/s | 65.9 steps/s
[Step=3450 Epoch=32.8] | Loss=0.00356 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.386 | L2-Norm(final)=7.493 | 6789.7 samples/s | 106.1 steps/s
[Step=3500 Epoch=33.3] | Loss=0.00338 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.334 | L2-Norm(final)=7.493 | 2371.0 samples/s | 37.0 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00322 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.282 | L2-Norm(final)=7.494 | 6142.9 samples/s | 96.0 steps/s
[Step=3600 Epoch=34.2] | Loss=0.00307 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.231 | L2-Norm(final)=7.494 | 2442.1 samples/s | 38.2 steps/s
[Step=3650 Epoch=34.7] | Loss=0.00294 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.180 | L2-Norm(final)=7.495 | 5575.1 samples/s | 87.1 steps/s
[Step=3700 Epoch=35.2] | Loss=0.00282 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.129 | L2-Norm(final)=7.495 | 2482.9 samples/s | 38.8 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00271 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.079 | L2-Norm(final)=7.496 | 5222.9 samples/s | 81.6 steps/s
[Step=3800 Epoch=36.1] | Loss=0.00260 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.030 | L2-Norm(final)=7.496 | 2672.4 samples/s | 41.8 steps/s
[Step=3850 Epoch=36.6] | Loss=0.00251 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.981 | L2-Norm(final)=7.496 | 4736.9 samples/s | 74.0 steps/s
[Step=3900 Epoch=37.1] | Loss=0.00242 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.932 | L2-Norm(final)=7.497 | 2785.9 samples/s | 43.5 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00233 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.884 | L2-Norm(final)=7.497 | 4521.8 samples/s | 70.7 steps/s
[Step=4000 Epoch=38.0] | Loss=0.00226 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.836 | L2-Norm(final)=7.498 | 2828.6 samples/s | 44.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step4000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.03944 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.959 | L2-Norm(final)=7.040 | 6738.9 samples/s | 105.3 steps/s
[Step=4050 Epoch=38.6] | Loss=0.05156 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.948 | L2-Norm(final)=7.055 | 4797.1 samples/s | 75.0 steps/s
[Step=4100 Epoch=39.1] | Loss=0.04940 | Reg=0.00223 | acc=0.9375 | L2-Norm=14.947 | L2-Norm(final)=7.125 | 8179.1 samples/s | 127.8 steps/s
[Step=4150 Epoch=39.6] | Loss=0.04676 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.947 | L2-Norm(final)=7.210 | 2549.9 samples/s | 39.8 steps/s
[Step=4200 Epoch=40.0] | Loss=0.04617 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.946 | L2-Norm(final)=7.294 | 7584.1 samples/s | 118.5 steps/s
[Step=4250 Epoch=40.5] | Loss=0.04609 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.946 | L2-Norm(final)=7.376 | 2640.2 samples/s | 41.3 steps/s
[Step=4300 Epoch=41.0] | Loss=0.04449 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.946 | L2-Norm(final)=7.453 | 6897.1 samples/s | 107.8 steps/s
[Step=4350 Epoch=41.5] | Loss=0.04412 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.946 | L2-Norm(final)=7.529 | 2716.6 samples/s | 42.4 steps/s
[Step=4400 Epoch=41.9] | Loss=0.04343 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.946 | L2-Norm(final)=7.604 | 6336.4 samples/s | 99.0 steps/s
[Step=4450 Epoch=42.4] | Loss=0.04331 | Reg=0.00223 | acc=0.9531 | L2-Norm=14.946 | L2-Norm(final)=7.675 | 2851.9 samples/s | 44.6 steps/s
[Step=4500 Epoch=42.9] | Loss=0.04265 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.946 | L2-Norm(final)=7.743 | 5747.1 samples/s | 89.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.9] | Loss=0.02848 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.946 | L2-Norm(final)=8.409 | 7285.6 samples/s | 113.8 steps/s
[Step=4550 Epoch=43.4] | Loss=0.02609 | Reg=0.00234 | acc=0.9531 | L2-Norm=15.307 | L2-Norm(final)=8.415 | 3954.0 samples/s | 61.8 steps/s
[Step=4600 Epoch=43.8] | Loss=0.01964 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.561 | L2-Norm(final)=8.390 | 6685.0 samples/s | 104.5 steps/s
[Step=4650 Epoch=44.3] | Loss=0.01367 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.652 | L2-Norm(final)=8.380 | 2376.8 samples/s | 37.1 steps/s
[Step=4700 Epoch=44.8] | Loss=0.01039 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.679 | L2-Norm(final)=8.378 | 6024.1 samples/s | 94.1 steps/s
[Step=4750 Epoch=45.3] | Loss=0.00832 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.678 | L2-Norm(final)=8.377 | 2447.1 samples/s | 38.2 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00694 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.661 | L2-Norm(final)=8.376 | 5676.2 samples/s | 88.7 steps/s
[Step=4850 Epoch=46.2] | Loss=0.00595 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.637 | L2-Norm(final)=8.376 | 2552.6 samples/s | 39.9 steps/s
[Step=4900 Epoch=46.7] | Loss=0.00521 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.607 | L2-Norm(final)=8.376 | 5191.9 samples/s | 81.1 steps/s
[Step=4950 Epoch=47.2] | Loss=0.00463 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.575 | L2-Norm(final)=8.376 | 2615.9 samples/s | 40.9 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00417 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.540 | L2-Norm(final)=8.376 | 4925.8 samples/s | 77.0 steps/s
[Step=5050 Epoch=48.1] | Loss=0.00379 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.504 | L2-Norm(final)=8.376 | 2698.4 samples/s | 42.2 steps/s
[Step=5100 Epoch=48.6] | Loss=0.00348 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.468 | L2-Norm(final)=8.376 | 4674.2 samples/s | 73.0 steps/s
[Step=5150 Epoch=49.1] | Loss=0.00321 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.431 | L2-Norm(final)=8.377 | 2823.1 samples/s | 44.1 steps/s
[Step=5200 Epoch=49.6] | Loss=0.00298 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.393 | L2-Norm(final)=8.377 | 4580.4 samples/s | 71.6 steps/s
[Step=5250 Epoch=50.0] | Loss=0.00278 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.355 | L2-Norm(final)=8.377 | 2860.7 samples/s | 44.7 steps/s
[Step=5300 Epoch=50.5] | Loss=0.00261 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.317 | L2-Norm(final)=8.377 | 4457.7 samples/s | 69.7 steps/s
[Step=5350 Epoch=51.0] | Loss=0.00246 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.279 | L2-Norm(final)=8.377 | 2869.6 samples/s | 44.8 steps/s
[Step=5400 Epoch=51.5] | Loss=0.00232 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.241 | L2-Norm(final)=8.378 | 4471.3 samples/s | 69.9 steps/s
[Step=5450 Epoch=51.9] | Loss=0.00220 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.203 | L2-Norm(final)=8.378 | 2863.6 samples/s | 44.7 steps/s
[Step=5500 Epoch=52.4] | Loss=0.00209 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.165 | L2-Norm(final)=8.378 | 4483.7 samples/s | 70.1 steps/s
[Step=5550 Epoch=52.9] | Loss=0.00199 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.127 | L2-Norm(final)=8.378 | 7419.3 samples/s | 115.9 steps/s
[Step=5600 Epoch=53.4] | Loss=0.00190 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.089 | L2-Norm(final)=8.378 | 2312.1 samples/s | 36.1 steps/s
[Step=5650 Epoch=53.8] | Loss=0.00182 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.051 | L2-Norm(final)=8.379 | 6548.8 samples/s | 102.3 steps/s
[Step=5700 Epoch=54.3] | Loss=0.00174 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.014 | L2-Norm(final)=8.379 | 2374.6 samples/s | 37.1 steps/s
[Step=5750 Epoch=54.8] | Loss=0.00167 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.976 | L2-Norm(final)=8.379 | 6147.2 samples/s | 96.1 steps/s
[Step=5800 Epoch=55.3] | Loss=0.00161 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.938 | L2-Norm(final)=8.379 | 2441.4 samples/s | 38.1 steps/s
[Step=5850 Epoch=55.8] | Loss=0.00155 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.901 | L2-Norm(final)=8.380 | 5668.0 samples/s | 88.6 steps/s
[Step=5900 Epoch=56.2] | Loss=0.00149 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.863 | L2-Norm(final)=8.380 | 2538.4 samples/s | 39.7 steps/s
[Step=5950 Epoch=56.7] | Loss=0.00144 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.826 | L2-Norm(final)=8.380 | 5266.7 samples/s | 82.3 steps/s
[Step=6000 Epoch=57.2] | Loss=0.00139 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.789 | L2-Norm(final)=8.380 | 2634.8 samples/s | 41.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.14686 | acc=0.9323 | tpr=0.9509 | fpr=0.1083 | 5789.6 samples/s | 22.6 steps/s
Avg test loss: 0.15329, Avg test acc: 0.92788, Avg tpr: 0.94830, Avg fpr: 0.11704, total FA: 913

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14050 | acc=0.9325 | tpr=0.9531 | fpr=0.1122 | 6031.6 samples/s | 23.6 steps/s
Avg test loss: 0.14300, Avg test acc: 0.93144, Avg tpr: 0.95087, Avg fpr: 0.11127, total FA: 868

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.15329 | acc=0.9373 | tpr=0.9524 | fpr=0.0956 | 6007.8 samples/s | 23.5 steps/s
Avg test loss: 0.15689, Avg test acc: 0.93529, Avg tpr: 0.95005, Avg fpr: 0.09717, total FA: 758

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.16686 | acc=0.9278 | tpr=0.9537 | fpr=0.1283 | 6093.8 samples/s | 23.8 steps/s
Avg test loss: 0.17592, Avg test acc: 0.92592, Avg tpr: 0.95331, Avg fpr: 0.13434, total FA: 1048

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.15852 | acc=0.9283 | tpr=0.9615 | fpr=0.1440 | 6166.6 samples/s | 24.1 steps/s
Avg test loss: 0.16170, Avg test acc: 0.92660, Avg tpr: 0.95914, Avg fpr: 0.14498, total FA: 1131

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.64241 | acc=0.3188 | tpr=0.0159 | fpr=0.0233 | 5883.8 samples/s | 23.0 steps/s
Avg test loss: 5.65212, Avg test acc: 0.31513, Avg tpr: 0.01510, Avg fpr: 0.02500, total FA: 195

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.48856 | acc=0.3223 | tpr=0.0256 | fpr=0.0332 | 6031.4 samples/s | 23.6 steps/s
Avg test loss: 5.51312, Avg test acc: 0.32126, Avg tpr: 0.02646, Avg fpr: 0.03038, total FA: 237

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.20931 | acc=0.3243 | tpr=0.0423 | fpr=0.0634 | 5908.3 samples/s | 23.1 steps/s
Avg test loss: 4.22080, Avg test acc: 0.32250, Avg tpr: 0.04127, Avg fpr: 0.05897, total FA: 460

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.65318 | acc=0.3114 | tpr=0.0240 | fpr=0.0644 | 5807.0 samples/s | 22.7 steps/s
Avg test loss: 4.64910, Avg test acc: 0.31032, Avg tpr: 0.02454, Avg fpr: 0.06115, total FA: 477

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=6.20943 | acc=0.3223 | tpr=0.0273 | fpr=0.0369 | 6110.7 samples/s | 23.9 steps/s
Avg test loss: 6.22338, Avg test acc: 0.32002, Avg tpr: 0.02769, Avg fpr: 0.03705, total FA: 289

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.87278 | acc=0.1291 | tpr=0.8230 | fpr=0.8833 | 6149.6 samples/s | 24.0 steps/s
[Step= 100] | Loss=4.86516 | acc=0.1263 | tpr=0.7932 | fpr=0.8862 | 7748.5 samples/s | 30.3 steps/s
[Step= 150] | Loss=4.85252 | acc=0.1273 | tpr=0.7954 | fpr=0.8850 | 7606.0 samples/s | 29.7 steps/s
[Step= 200] | Loss=4.86125 | acc=0.1268 | tpr=0.7869 | fpr=0.8852 | 8209.2 samples/s | 32.1 steps/s
[Step= 250] | Loss=4.87290 | acc=0.1270 | tpr=0.7886 | fpr=0.8850 | 8177.1 samples/s | 31.9 steps/s
[Step= 300] | Loss=4.86946 | acc=0.1274 | tpr=0.7956 | fpr=0.8848 | 7899.1 samples/s | 30.9 steps/s
[Step= 350] | Loss=4.87167 | acc=0.1274 | tpr=0.7921 | fpr=0.8847 | 7890.9 samples/s | 30.8 steps/s
[Step= 400] | Loss=4.86841 | acc=0.1278 | tpr=0.7888 | fpr=0.8842 | 8582.7 samples/s | 33.5 steps/s
[Step= 450] | Loss=4.87358 | acc=0.1274 | tpr=0.7882 | fpr=0.8846 | 7909.6 samples/s | 30.9 steps/s
[Step= 500] | Loss=4.87414 | acc=0.1273 | tpr=0.7912 | fpr=0.8847 | 7667.7 samples/s | 30.0 steps/s
[Step= 550] | Loss=4.87599 | acc=0.1272 | tpr=0.7931 | fpr=0.8849 | 11272.9 samples/s | 44.0 steps/s
Avg test loss: 4.87693, Avg test acc: 0.12720, Avg tpr: 0.79358, Avg fpr: 0.88492, total FA: 122869

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.00661 | acc=0.1416 | tpr=0.7876 | fpr=0.8700 | 5843.5 samples/s | 22.8 steps/s
[Step= 100] | Loss=4.96321 | acc=0.1446 | tpr=0.7761 | fpr=0.8672 | 7902.9 samples/s | 30.9 steps/s
[Step= 150] | Loss=4.95420 | acc=0.1443 | tpr=0.7666 | fpr=0.8671 | 8370.3 samples/s | 32.7 steps/s
[Step= 200] | Loss=4.93908 | acc=0.1447 | tpr=0.7617 | fpr=0.8666 | 8253.7 samples/s | 32.2 steps/s
[Step= 250] | Loss=4.94477 | acc=0.1452 | tpr=0.7651 | fpr=0.8661 | 7999.6 samples/s | 31.2 steps/s
[Step= 300] | Loss=4.93857 | acc=0.1451 | tpr=0.7709 | fpr=0.8663 | 8188.8 samples/s | 32.0 steps/s
[Step= 350] | Loss=4.94056 | acc=0.1448 | tpr=0.7765 | fpr=0.8667 | 7954.4 samples/s | 31.1 steps/s
[Step= 400] | Loss=4.94073 | acc=0.1454 | tpr=0.7768 | fpr=0.8661 | 7752.1 samples/s | 30.3 steps/s
[Step= 450] | Loss=4.94225 | acc=0.1449 | tpr=0.7775 | fpr=0.8666 | 8235.0 samples/s | 32.2 steps/s
[Step= 500] | Loss=4.94156 | acc=0.1452 | tpr=0.7784 | fpr=0.8663 | 8064.1 samples/s | 31.5 steps/s
[Step= 550] | Loss=4.93940 | acc=0.1454 | tpr=0.7784 | fpr=0.8661 | 9740.5 samples/s | 38.0 steps/s
Avg test loss: 4.93935, Avg test acc: 0.14530, Avg tpr: 0.77853, Avg fpr: 0.86621, total FA: 120271

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.79943 | acc=0.1257 | tpr=0.8584 | fpr=0.8875 | 5889.1 samples/s | 23.0 steps/s
[Step= 100] | Loss=5.78174 | acc=0.1249 | tpr=0.8337 | fpr=0.8883 | 7525.8 samples/s | 29.4 steps/s
[Step= 150] | Loss=5.79062 | acc=0.1260 | tpr=0.8314 | fpr=0.8870 | 7972.2 samples/s | 31.1 steps/s
[Step= 200] | Loss=5.78785 | acc=0.1259 | tpr=0.8240 | fpr=0.8868 | 8304.9 samples/s | 32.4 steps/s
[Step= 250] | Loss=5.79872 | acc=0.1258 | tpr=0.8236 | fpr=0.8869 | 8217.8 samples/s | 32.1 steps/s
[Step= 300] | Loss=5.79958 | acc=0.1261 | tpr=0.8291 | fpr=0.8868 | 8205.4 samples/s | 32.1 steps/s
[Step= 350] | Loss=5.79932 | acc=0.1265 | tpr=0.8353 | fpr=0.8864 | 7855.4 samples/s | 30.7 steps/s
[Step= 400] | Loss=5.79914 | acc=0.1266 | tpr=0.8337 | fpr=0.8863 | 8172.0 samples/s | 31.9 steps/s
[Step= 450] | Loss=5.80064 | acc=0.1263 | tpr=0.8320 | fpr=0.8865 | 8305.7 samples/s | 32.4 steps/s
[Step= 500] | Loss=5.80127 | acc=0.1265 | tpr=0.8352 | fpr=0.8863 | 7188.9 samples/s | 28.1 steps/s
[Step= 550] | Loss=5.80463 | acc=0.1268 | tpr=0.8353 | fpr=0.8860 | 11719.9 samples/s | 45.8 steps/s
Avg test loss: 5.80440, Avg test acc: 0.12679, Avg tpr: 0.83518, Avg fpr: 0.88609, total FA: 123032

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.53522 | acc=0.1540 | tpr=0.8673 | fpr=0.8588 | 6060.0 samples/s | 23.7 steps/s
[Step= 100] | Loss=5.50511 | acc=0.1539 | tpr=0.8571 | fpr=0.8593 | 8098.4 samples/s | 31.6 steps/s
[Step= 150] | Loss=5.49459 | acc=0.1522 | tpr=0.8473 | fpr=0.8606 | 7534.4 samples/s | 29.4 steps/s
[Step= 200] | Loss=5.48363 | acc=0.1523 | tpr=0.8339 | fpr=0.8601 | 8153.8 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.49561 | acc=0.1521 | tpr=0.8314 | fpr=0.8602 | 8490.2 samples/s | 33.2 steps/s
[Step= 300] | Loss=5.48589 | acc=0.1518 | tpr=0.8305 | fpr=0.8606 | 8092.1 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.48900 | acc=0.1516 | tpr=0.8284 | fpr=0.8606 | 7786.7 samples/s | 30.4 steps/s
[Step= 400] | Loss=5.49051 | acc=0.1514 | tpr=0.8277 | fpr=0.8609 | 8061.9 samples/s | 31.5 steps/s
[Step= 450] | Loss=5.49167 | acc=0.1509 | tpr=0.8286 | fpr=0.8614 | 7845.5 samples/s | 30.6 steps/s
[Step= 500] | Loss=5.49130 | acc=0.1509 | tpr=0.8291 | fpr=0.8613 | 8197.2 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.49275 | acc=0.1509 | tpr=0.8321 | fpr=0.8615 | 9806.7 samples/s | 38.3 steps/s
Avg test loss: 5.49343, Avg test acc: 0.15080, Avg tpr: 0.83162, Avg fpr: 0.86158, total FA: 119628

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.08212 | acc=0.1416 | tpr=0.8230 | fpr=0.8707 | 6130.0 samples/s | 23.9 steps/s
[Step= 100] | Loss=5.06630 | acc=0.1419 | tpr=0.8230 | fpr=0.8708 | 7877.3 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.06635 | acc=0.1420 | tpr=0.8300 | fpr=0.8707 | 8154.2 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.07021 | acc=0.1420 | tpr=0.8328 | fpr=0.8706 | 7891.3 samples/s | 30.8 steps/s
[Step= 250] | Loss=5.08106 | acc=0.1416 | tpr=0.8332 | fpr=0.8710 | 7940.7 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.07894 | acc=0.1418 | tpr=0.8364 | fpr=0.8709 | 8231.2 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.08432 | acc=0.1416 | tpr=0.8384 | fpr=0.8711 | 7441.3 samples/s | 29.1 steps/s
[Step= 400] | Loss=5.08845 | acc=0.1416 | tpr=0.8359 | fpr=0.8710 | 8645.8 samples/s | 33.8 steps/s
[Step= 450] | Loss=5.09040 | acc=0.1411 | tpr=0.8374 | fpr=0.8716 | 8055.7 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.08544 | acc=0.1415 | tpr=0.8374 | fpr=0.8711 | 8051.4 samples/s | 31.5 steps/s
[Step= 550] | Loss=5.08962 | acc=0.1415 | tpr=0.8376 | fpr=0.8712 | 9744.7 samples/s | 38.1 steps/s
Avg test loss: 5.09074, Avg test acc: 0.14141, Avg tpr: 0.83835, Avg fpr: 0.87125, total FA: 120972

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.16308 | acc=0.9558 | tpr=0.9071 | fpr=0.0433 | 5953.7 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.16864 | acc=0.9545 | tpr=0.9147 | fpr=0.0448 | 8126.2 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.17087 | acc=0.9537 | tpr=0.9179 | fpr=0.0457 | 7779.8 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.17228 | acc=0.9541 | tpr=0.9224 | fpr=0.0453 | 8585.5 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.17404 | acc=0.9539 | tpr=0.9179 | fpr=0.0454 | 7464.3 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.17608 | acc=0.9535 | tpr=0.9113 | fpr=0.0458 | 7863.8 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.17560 | acc=0.9536 | tpr=0.9117 | fpr=0.0457 | 8221.1 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.17615 | acc=0.9535 | tpr=0.9081 | fpr=0.0457 | 8754.0 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.17787 | acc=0.9531 | tpr=0.9051 | fpr=0.0461 | 8126.6 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.17866 | acc=0.9528 | tpr=0.9062 | fpr=0.0463 | 8022.0 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.17711 | acc=0.9531 | tpr=0.9061 | fpr=0.0461 | 9352.5 samples/s | 36.5 steps/s
Avg test loss: 0.17687, Avg test acc: 0.95308, Avg tpr: 0.90610, Avg fpr: 0.04606, total FA: 6396

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13299 | acc=0.9613 | tpr=0.8717 | fpr=0.0371 | 5771.6 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.13336 | acc=0.9613 | tpr=0.8934 | fpr=0.0374 | 8043.7 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.13599 | acc=0.9601 | tpr=0.9020 | fpr=0.0388 | 8163.5 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.13630 | acc=0.9606 | tpr=0.9005 | fpr=0.0383 | 7847.9 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.13805 | acc=0.9602 | tpr=0.8969 | fpr=0.0386 | 7781.4 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.13920 | acc=0.9598 | tpr=0.8975 | fpr=0.0391 | 8166.2 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.13996 | acc=0.9596 | tpr=0.8967 | fpr=0.0393 | 8282.7 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.13964 | acc=0.9594 | tpr=0.8900 | fpr=0.0394 | 7957.7 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.14101 | acc=0.9591 | tpr=0.8885 | fpr=0.0396 | 8149.8 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.14078 | acc=0.9592 | tpr=0.8912 | fpr=0.0396 | 7894.4 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.14016 | acc=0.9593 | tpr=0.8882 | fpr=0.0394 | 10797.4 samples/s | 42.2 steps/s
Avg test loss: 0.13986, Avg test acc: 0.95934, Avg tpr: 0.88827, Avg fpr: 0.03937, total FA: 5466

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.22424 | acc=0.9466 | tpr=0.9381 | fpr=0.0532 | 6121.9 samples/s | 23.9 steps/s
[Step= 100] | Loss=0.23074 | acc=0.9462 | tpr=0.9318 | fpr=0.0536 | 7511.3 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.23536 | acc=0.9452 | tpr=0.9323 | fpr=0.0546 | 7907.3 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.23671 | acc=0.9455 | tpr=0.9366 | fpr=0.0543 | 8700.8 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.23777 | acc=0.9454 | tpr=0.9293 | fpr=0.0543 | 8311.5 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.24002 | acc=0.9446 | tpr=0.9244 | fpr=0.0550 | 7819.1 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.23866 | acc=0.9449 | tpr=0.9261 | fpr=0.0547 | 7292.0 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.23984 | acc=0.9445 | tpr=0.9240 | fpr=0.0551 | 8181.1 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.24044 | acc=0.9442 | tpr=0.9231 | fpr=0.0554 | 8253.3 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.24167 | acc=0.9439 | tpr=0.9238 | fpr=0.0557 | 8556.1 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.24048 | acc=0.9442 | tpr=0.9252 | fpr=0.0554 | 9401.7 samples/s | 36.7 steps/s
Avg test loss: 0.24028, Avg test acc: 0.94428, Avg tpr: 0.92512, Avg fpr: 0.05537, total FA: 7688

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.12181 | acc=0.9643 | tpr=0.8717 | fpr=0.0340 | 6103.7 samples/s | 23.8 steps/s
[Step= 100] | Loss=0.13094 | acc=0.9614 | tpr=0.8827 | fpr=0.0371 | 8197.3 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.13365 | acc=0.9603 | tpr=0.8847 | fpr=0.0383 | 7708.4 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.13392 | acc=0.9604 | tpr=0.8874 | fpr=0.0382 | 8050.0 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.13496 | acc=0.9605 | tpr=0.8856 | fpr=0.0381 | 8364.1 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.13725 | acc=0.9600 | tpr=0.8815 | fpr=0.0386 | 7341.7 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.13680 | acc=0.9602 | tpr=0.8860 | fpr=0.0385 | 8396.5 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.13807 | acc=0.9599 | tpr=0.8824 | fpr=0.0387 | 8336.5 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.13948 | acc=0.9595 | tpr=0.8822 | fpr=0.0391 | 7906.6 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.13983 | acc=0.9595 | tpr=0.8819 | fpr=0.0391 | 8202.7 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.13938 | acc=0.9597 | tpr=0.8834 | fpr=0.0389 | 9916.0 samples/s | 38.7 steps/s
Avg test loss: 0.13905, Avg test acc: 0.95972, Avg tpr: 0.88312, Avg fpr: 0.03889, total FA: 5400

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21407 | acc=0.9514 | tpr=0.8673 | fpr=0.0471 | 6016.2 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.22241 | acc=0.9507 | tpr=0.9019 | fpr=0.0484 | 7670.0 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.22646 | acc=0.9493 | tpr=0.9049 | fpr=0.0499 | 7399.1 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.22793 | acc=0.9495 | tpr=0.9093 | fpr=0.0498 | 7691.6 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.23030 | acc=0.9493 | tpr=0.9039 | fpr=0.0499 | 8310.4 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.23399 | acc=0.9486 | tpr=0.9033 | fpr=0.0506 | 8184.7 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.23464 | acc=0.9487 | tpr=0.9023 | fpr=0.0504 | 8107.2 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.23518 | acc=0.9482 | tpr=0.8988 | fpr=0.0509 | 8107.8 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.23698 | acc=0.9477 | tpr=0.8973 | fpr=0.0513 | 8014.8 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.23734 | acc=0.9475 | tpr=0.8982 | fpr=0.0516 | 8176.0 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.23642 | acc=0.9476 | tpr=0.8957 | fpr=0.0515 | 10640.7 samples/s | 41.6 steps/s
Avg test loss: 0.23620, Avg test acc: 0.94765, Avg tpr: 0.89580, Avg fpr: 0.05141, total FA: 7138

server round 5/50

clients selected: [1 3 4 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=29.3] | Loss=0.12827 | Reg=0.00209 | acc=0.8750 | L2-Norm=14.468 | L2-Norm(final)=6.012 | 7854.6 samples/s | 122.7 steps/s
[Step=6050 Epoch=29.5] | Loss=0.13717 | Reg=0.00209 | acc=0.8750 | L2-Norm=14.469 | L2-Norm(final)=6.070 | 4706.7 samples/s | 73.5 steps/s
[Step=6100 Epoch=29.8] | Loss=0.13404 | Reg=0.00209 | acc=0.9062 | L2-Norm=14.469 | L2-Norm(final)=6.173 | 5644.7 samples/s | 88.2 steps/s
[Step=6150 Epoch=30.0] | Loss=0.13587 | Reg=0.00209 | acc=0.8594 | L2-Norm=14.469 | L2-Norm(final)=6.278 | 5550.0 samples/s | 86.7 steps/s
[Step=6200 Epoch=30.3] | Loss=0.13308 | Reg=0.00209 | acc=0.9531 | L2-Norm=14.469 | L2-Norm(final)=6.376 | 8681.1 samples/s | 135.6 steps/s
[Step=6250 Epoch=30.5] | Loss=0.13369 | Reg=0.00209 | acc=0.8750 | L2-Norm=14.469 | L2-Norm(final)=6.465 | 2650.7 samples/s | 41.4 steps/s
[Step=6300 Epoch=30.7] | Loss=0.13170 | Reg=0.00209 | acc=0.8281 | L2-Norm=14.469 | L2-Norm(final)=6.549 | 5597.3 samples/s | 87.5 steps/s
[Step=6350 Epoch=31.0] | Loss=0.13044 | Reg=0.00209 | acc=0.8750 | L2-Norm=14.469 | L2-Norm(final)=6.633 | 5441.8 samples/s | 85.0 steps/s
[Step=6400 Epoch=31.2] | Loss=0.13035 | Reg=0.00209 | acc=0.8438 | L2-Norm=14.469 | L2-Norm(final)=6.712 | 7959.9 samples/s | 124.4 steps/s
[Step=6450 Epoch=31.5] | Loss=0.12924 | Reg=0.00209 | acc=0.9375 | L2-Norm=14.469 | L2-Norm(final)=6.786 | 2755.8 samples/s | 43.1 steps/s
[Step=6500 Epoch=31.7] | Loss=0.12958 | Reg=0.00209 | acc=0.9062 | L2-Norm=14.469 | L2-Norm(final)=6.856 | 5529.0 samples/s | 86.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=31.7] | Loss=0.12205 | Reg=0.00209 | acc=0.9062 | L2-Norm=14.470 | L2-Norm(final)=7.529 | 7331.1 samples/s | 114.5 steps/s
[Step=6550 Epoch=32.0] | Loss=0.11122 | Reg=0.00215 | acc=0.9375 | L2-Norm=14.668 | L2-Norm(final)=7.519 | 4209.1 samples/s | 65.8 steps/s
[Step=6600 Epoch=32.2] | Loss=0.10349 | Reg=0.00220 | acc=0.9375 | L2-Norm=14.826 | L2-Norm(final)=7.493 | 4797.5 samples/s | 75.0 steps/s
[Step=6650 Epoch=32.4] | Loss=0.09993 | Reg=0.00223 | acc=0.9062 | L2-Norm=14.946 | L2-Norm(final)=7.472 | 4784.5 samples/s | 74.8 steps/s
[Step=6700 Epoch=32.7] | Loss=0.09450 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.038 | L2-Norm(final)=7.456 | 6860.5 samples/s | 107.2 steps/s
[Step=6750 Epoch=32.9] | Loss=0.08467 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.118 | L2-Norm(final)=7.446 | 2466.7 samples/s | 38.5 steps/s
[Step=6800 Epoch=33.2] | Loss=0.07931 | Reg=0.00231 | acc=0.9531 | L2-Norm=15.188 | L2-Norm(final)=7.442 | 4744.7 samples/s | 74.1 steps/s
[Step=6850 Epoch=33.4] | Loss=0.07630 | Reg=0.00233 | acc=0.9531 | L2-Norm=15.258 | L2-Norm(final)=7.436 | 4794.1 samples/s | 74.9 steps/s
[Step=6900 Epoch=33.7] | Loss=0.07229 | Reg=0.00235 | acc=0.9375 | L2-Norm=15.325 | L2-Norm(final)=7.432 | 6340.3 samples/s | 99.1 steps/s
[Step=6950 Epoch=33.9] | Loss=0.06780 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.385 | L2-Norm(final)=7.429 | 2563.0 samples/s | 40.0 steps/s
[Step=7000 Epoch=34.2] | Loss=0.06323 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.440 | L2-Norm(final)=7.428 | 4689.1 samples/s | 73.3 steps/s
[Step=7050 Epoch=34.4] | Loss=0.06014 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.488 | L2-Norm(final)=7.428 | 4797.5 samples/s | 75.0 steps/s
[Step=7100 Epoch=34.6] | Loss=0.05789 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.532 | L2-Norm(final)=7.428 | 5862.7 samples/s | 91.6 steps/s
[Step=7150 Epoch=34.9] | Loss=0.05532 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.575 | L2-Norm(final)=7.428 | 2633.0 samples/s | 41.1 steps/s
[Step=7200 Epoch=35.1] | Loss=0.05316 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.616 | L2-Norm(final)=7.428 | 4754.3 samples/s | 74.3 steps/s
[Step=7250 Epoch=35.4] | Loss=0.05111 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.654 | L2-Norm(final)=7.429 | 4786.9 samples/s | 74.8 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04943 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.688 | L2-Norm(final)=7.430 | 5488.9 samples/s | 85.8 steps/s
[Step=7350 Epoch=35.9] | Loss=0.04748 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.722 | L2-Norm(final)=7.431 | 2765.4 samples/s | 43.2 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04578 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.753 | L2-Norm(final)=7.433 | 4682.1 samples/s | 73.2 steps/s
[Step=7450 Epoch=36.4] | Loss=0.04486 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.782 | L2-Norm(final)=7.434 | 4800.7 samples/s | 75.0 steps/s
[Step=7500 Epoch=36.6] | Loss=0.04368 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.810 | L2-Norm(final)=7.434 | 5078.0 samples/s | 79.3 steps/s
[Step=7550 Epoch=36.8] | Loss=0.04250 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.837 | L2-Norm(final)=7.435 | 2794.1 samples/s | 43.7 steps/s
[Step=7600 Epoch=37.1] | Loss=0.04154 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.864 | L2-Norm(final)=7.436 | 4779.4 samples/s | 74.7 steps/s
[Step=7650 Epoch=37.3] | Loss=0.04050 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.891 | L2-Norm(final)=7.437 | 4759.1 samples/s | 74.4 steps/s
[Step=7700 Epoch=37.6] | Loss=0.03966 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.918 | L2-Norm(final)=7.438 | 4838.6 samples/s | 75.6 steps/s
[Step=7750 Epoch=37.8] | Loss=0.03882 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.945 | L2-Norm(final)=7.439 | 2918.5 samples/s | 45.6 steps/s
[Step=7800 Epoch=38.1] | Loss=0.03792 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.970 | L2-Norm(final)=7.441 | 4727.1 samples/s | 73.9 steps/s
[Step=7850 Epoch=38.3] | Loss=0.03718 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.994 | L2-Norm(final)=7.442 | 4783.7 samples/s | 74.7 steps/s
[Step=7900 Epoch=38.5] | Loss=0.03641 | Reg=0.00257 | acc=0.9688 | L2-Norm=16.018 | L2-Norm(final)=7.442 | 4869.3 samples/s | 76.1 steps/s
[Step=7950 Epoch=38.8] | Loss=0.03572 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.041 | L2-Norm(final)=7.443 | 2916.6 samples/s | 45.6 steps/s
[Step=8000 Epoch=39.0] | Loss=0.03487 | Reg=0.00258 | acc=0.9844 | L2-Norm=16.064 | L2-Norm(final)=7.444 | 4763.0 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step8000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.11722 | Reg=0.00209 | acc=0.9219 | L2-Norm=14.468 | L2-Norm(final)=4.960 | 7182.3 samples/s | 112.2 steps/s
[Step=4050 Epoch=19.8] | Loss=0.15264 | Reg=0.00209 | acc=0.8906 | L2-Norm=14.467 | L2-Norm(final)=5.016 | 5014.8 samples/s | 78.4 steps/s
[Step=4100 Epoch=20.0] | Loss=0.14560 | Reg=0.00209 | acc=0.9062 | L2-Norm=14.467 | L2-Norm(final)=5.115 | 5585.1 samples/s | 87.3 steps/s
[Step=4150 Epoch=20.2] | Loss=0.14233 | Reg=0.00209 | acc=0.9062 | L2-Norm=14.467 | L2-Norm(final)=5.214 | 5388.4 samples/s | 84.2 steps/s
[Step=4200 Epoch=20.5] | Loss=0.14007 | Reg=0.00209 | acc=0.9062 | L2-Norm=14.467 | L2-Norm(final)=5.314 | 8689.6 samples/s | 135.8 steps/s
[Step=4250 Epoch=20.7] | Loss=0.13756 | Reg=0.00209 | acc=0.9219 | L2-Norm=14.467 | L2-Norm(final)=5.409 | 2722.5 samples/s | 42.5 steps/s
[Step=4300 Epoch=21.0] | Loss=0.13538 | Reg=0.00209 | acc=0.9531 | L2-Norm=14.467 | L2-Norm(final)=5.500 | 5574.8 samples/s | 87.1 steps/s
[Step=4350 Epoch=21.2] | Loss=0.13435 | Reg=0.00209 | acc=0.8594 | L2-Norm=14.467 | L2-Norm(final)=5.587 | 5370.4 samples/s | 83.9 steps/s
[Step=4400 Epoch=21.5] | Loss=0.13426 | Reg=0.00209 | acc=0.8750 | L2-Norm=14.467 | L2-Norm(final)=5.668 | 7571.0 samples/s | 118.3 steps/s
[Step=4450 Epoch=21.7] | Loss=0.13330 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.467 | L2-Norm(final)=5.744 | 2814.4 samples/s | 44.0 steps/s
[Step=4500 Epoch=21.9] | Loss=0.13279 | Reg=0.00209 | acc=0.8906 | L2-Norm=14.467 | L2-Norm(final)=5.815 | 5550.8 samples/s | 86.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=21.9] | Loss=0.20761 | Reg=0.00209 | acc=0.7656 | L2-Norm=14.467 | L2-Norm(final)=6.507 | 6493.8 samples/s | 101.5 steps/s
[Step=4550 Epoch=22.2] | Loss=0.10096 | Reg=0.00215 | acc=0.8750 | L2-Norm=14.660 | L2-Norm(final)=6.525 | 4570.9 samples/s | 71.4 steps/s
[Step=4600 Epoch=22.4] | Loss=0.09784 | Reg=0.00219 | acc=0.9375 | L2-Norm=14.791 | L2-Norm(final)=6.515 | 4732.8 samples/s | 73.9 steps/s
[Step=4650 Epoch=22.7] | Loss=0.09429 | Reg=0.00222 | acc=0.9219 | L2-Norm=14.894 | L2-Norm(final)=6.503 | 4781.0 samples/s | 74.7 steps/s
[Step=4700 Epoch=22.9] | Loss=0.08748 | Reg=0.00224 | acc=0.9375 | L2-Norm=14.978 | L2-Norm(final)=6.493 | 6852.9 samples/s | 107.1 steps/s
[Step=4750 Epoch=23.2] | Loss=0.07899 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.053 | L2-Norm(final)=6.487 | 2469.9 samples/s | 38.6 steps/s
[Step=4800 Epoch=23.4] | Loss=0.07282 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.120 | L2-Norm(final)=6.486 | 4808.5 samples/s | 75.1 steps/s
[Step=4850 Epoch=23.7] | Loss=0.06875 | Reg=0.00230 | acc=0.9375 | L2-Norm=15.179 | L2-Norm(final)=6.483 | 4743.0 samples/s | 74.1 steps/s
[Step=4900 Epoch=23.9] | Loss=0.06616 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.233 | L2-Norm(final)=6.482 | 6220.7 samples/s | 97.2 steps/s
[Step=4950 Epoch=24.1] | Loss=0.06161 | Reg=0.00234 | acc=0.9531 | L2-Norm=15.283 | L2-Norm(final)=6.482 | 2587.3 samples/s | 40.4 steps/s
[Step=5000 Epoch=24.4] | Loss=0.05733 | Reg=0.00235 | acc=0.9688 | L2-Norm=15.329 | L2-Norm(final)=6.483 | 4745.1 samples/s | 74.1 steps/s
[Step=5050 Epoch=24.6] | Loss=0.05535 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.368 | L2-Norm(final)=6.483 | 4789.4 samples/s | 74.8 steps/s
[Step=5100 Epoch=24.9] | Loss=0.05339 | Reg=0.00238 | acc=0.9375 | L2-Norm=15.407 | L2-Norm(final)=6.482 | 5699.4 samples/s | 89.1 steps/s
[Step=5150 Epoch=25.1] | Loss=0.05222 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.446 | L2-Norm(final)=6.482 | 2672.9 samples/s | 41.8 steps/s
[Step=5200 Epoch=25.4] | Loss=0.05067 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.486 | L2-Norm(final)=6.482 | 4745.9 samples/s | 74.2 steps/s
[Step=5250 Epoch=25.6] | Loss=0.04909 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.525 | L2-Norm(final)=6.482 | 4782.7 samples/s | 74.7 steps/s
[Step=5300 Epoch=25.8] | Loss=0.04739 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.562 | L2-Norm(final)=6.483 | 5254.2 samples/s | 82.1 steps/s
[Step=5350 Epoch=26.1] | Loss=0.04602 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.597 | L2-Norm(final)=6.483 | 2807.0 samples/s | 43.9 steps/s
[Step=5400 Epoch=26.3] | Loss=0.04452 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.631 | L2-Norm(final)=6.484 | 4798.5 samples/s | 75.0 steps/s
[Step=5450 Epoch=26.6] | Loss=0.04331 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.664 | L2-Norm(final)=6.485 | 4675.1 samples/s | 73.0 steps/s
[Step=5500 Epoch=26.8] | Loss=0.04232 | Reg=0.00247 | acc=0.9688 | L2-Norm=15.696 | L2-Norm(final)=6.485 | 4910.6 samples/s | 76.7 steps/s
[Step=5550 Epoch=27.1] | Loss=0.04114 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.727 | L2-Norm(final)=6.486 | 2874.2 samples/s | 44.9 steps/s
[Step=5600 Epoch=27.3] | Loss=0.04011 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.757 | L2-Norm(final)=6.487 | 4784.9 samples/s | 74.8 steps/s
[Step=5650 Epoch=27.6] | Loss=0.03936 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.785 | L2-Norm(final)=6.488 | 4777.3 samples/s | 74.6 steps/s
[Step=5700 Epoch=27.8] | Loss=0.03853 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.812 | L2-Norm(final)=6.488 | 4777.9 samples/s | 74.7 steps/s
[Step=5750 Epoch=28.0] | Loss=0.03753 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.839 | L2-Norm(final)=6.489 | 2965.9 samples/s | 46.3 steps/s
[Step=5800 Epoch=28.3] | Loss=0.03656 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.864 | L2-Norm(final)=6.490 | 4854.8 samples/s | 75.9 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03588 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.888 | L2-Norm(final)=6.491 | 4686.3 samples/s | 73.2 steps/s
[Step=5900 Epoch=28.8] | Loss=0.03499 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.911 | L2-Norm(final)=6.492 | 4742.7 samples/s | 74.1 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03444 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.933 | L2-Norm(final)=6.493 | 2937.0 samples/s | 45.9 steps/s
[Step=6000 Epoch=29.3] | Loss=0.03364 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.955 | L2-Norm(final)=6.494 | 4827.1 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step6000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.15156 | Reg=0.00209 | acc=0.9062 | L2-Norm=14.468 | L2-Norm(final)=4.451 | 6837.1 samples/s | 106.8 steps/s
[Step=2050 Epoch=10.1] | Loss=0.16466 | Reg=0.00209 | acc=0.7812 | L2-Norm=14.471 | L2-Norm(final)=4.494 | 4951.3 samples/s | 77.4 steps/s
[Step=2100 Epoch=10.3] | Loss=0.15576 | Reg=0.00209 | acc=0.8594 | L2-Norm=14.471 | L2-Norm(final)=4.594 | 5564.9 samples/s | 87.0 steps/s
[Step=2150 Epoch=10.5] | Loss=0.15037 | Reg=0.00209 | acc=0.8594 | L2-Norm=14.471 | L2-Norm(final)=4.713 | 5617.4 samples/s | 87.8 steps/s
[Step=2200 Epoch=10.8] | Loss=0.14758 | Reg=0.00209 | acc=0.8750 | L2-Norm=14.472 | L2-Norm(final)=4.833 | 8899.2 samples/s | 139.0 steps/s
[Step=2250 Epoch=11.0] | Loss=0.14543 | Reg=0.00209 | acc=0.8281 | L2-Norm=14.472 | L2-Norm(final)=4.947 | 2644.7 samples/s | 41.3 steps/s
[Step=2300 Epoch=11.3] | Loss=0.14369 | Reg=0.00209 | acc=0.8906 | L2-Norm=14.472 | L2-Norm(final)=5.052 | 5586.2 samples/s | 87.3 steps/s
[Step=2350 Epoch=11.5] | Loss=0.14256 | Reg=0.00209 | acc=0.8750 | L2-Norm=14.472 | L2-Norm(final)=5.152 | 5492.9 samples/s | 85.8 steps/s
[Step=2400 Epoch=11.8] | Loss=0.14116 | Reg=0.00209 | acc=0.9062 | L2-Norm=14.472 | L2-Norm(final)=5.245 | 8311.5 samples/s | 129.9 steps/s
[Step=2450 Epoch=12.0] | Loss=0.14004 | Reg=0.00209 | acc=0.8750 | L2-Norm=14.472 | L2-Norm(final)=5.334 | 2741.0 samples/s | 42.8 steps/s
[Step=2500 Epoch=12.3] | Loss=0.13928 | Reg=0.00209 | acc=0.8906 | L2-Norm=14.472 | L2-Norm(final)=5.420 | 5426.0 samples/s | 84.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.3] | Loss=0.12725 | Reg=0.00209 | acc=0.8438 | L2-Norm=14.472 | L2-Norm(final)=6.246 | 6943.1 samples/s | 108.5 steps/s
[Step=2550 Epoch=12.5] | Loss=0.10789 | Reg=0.00214 | acc=0.9531 | L2-Norm=14.637 | L2-Norm(final)=6.263 | 4441.7 samples/s | 69.4 steps/s
[Step=2600 Epoch=12.7] | Loss=0.09537 | Reg=0.00218 | acc=0.9375 | L2-Norm=14.769 | L2-Norm(final)=6.256 | 4671.2 samples/s | 73.0 steps/s
[Step=2650 Epoch=13.0] | Loss=0.08834 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.863 | L2-Norm(final)=6.249 | 4755.7 samples/s | 74.3 steps/s
[Step=2700 Epoch=13.2] | Loss=0.08379 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.939 | L2-Norm(final)=6.242 | 7041.5 samples/s | 110.0 steps/s
[Step=2750 Epoch=13.5] | Loss=0.07587 | Reg=0.00225 | acc=0.9844 | L2-Norm=15.013 | L2-Norm(final)=6.239 | 2459.2 samples/s | 38.4 steps/s
[Step=2800 Epoch=13.7] | Loss=0.07045 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.078 | L2-Norm(final)=6.237 | 4850.3 samples/s | 75.8 steps/s
[Step=2850 Epoch=14.0] | Loss=0.06587 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.137 | L2-Norm(final)=6.237 | 4663.9 samples/s | 72.9 steps/s
[Step=2900 Epoch=14.2] | Loss=0.06349 | Reg=0.00231 | acc=0.9688 | L2-Norm=15.192 | L2-Norm(final)=6.237 | 6622.3 samples/s | 103.5 steps/s
[Step=2950 Epoch=14.5] | Loss=0.05997 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.244 | L2-Norm(final)=6.236 | 2498.0 samples/s | 39.0 steps/s
[Step=3000 Epoch=14.7] | Loss=0.05637 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.294 | L2-Norm(final)=6.238 | 4801.6 samples/s | 75.0 steps/s
[Step=3050 Epoch=15.0] | Loss=0.05416 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.341 | L2-Norm(final)=6.239 | 4778.1 samples/s | 74.7 steps/s
[Step=3100 Epoch=15.2] | Loss=0.05212 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.385 | L2-Norm(final)=6.240 | 6170.9 samples/s | 96.4 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04975 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.427 | L2-Norm(final)=6.241 | 2562.3 samples/s | 40.0 steps/s
[Step=3200 Epoch=15.7] | Loss=0.04759 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.466 | L2-Norm(final)=6.243 | 4807.3 samples/s | 75.1 steps/s
[Step=3250 Epoch=15.9] | Loss=0.04628 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.503 | L2-Norm(final)=6.244 | 4713.1 samples/s | 73.6 steps/s
[Step=3300 Epoch=16.2] | Loss=0.04474 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.539 | L2-Norm(final)=6.245 | 5792.7 samples/s | 90.5 steps/s
[Step=3350 Epoch=16.4] | Loss=0.04327 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.573 | L2-Norm(final)=6.246 | 2651.6 samples/s | 41.4 steps/s
[Step=3400 Epoch=16.7] | Loss=0.04190 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.607 | L2-Norm(final)=6.247 | 4784.5 samples/s | 74.8 steps/s
[Step=3450 Epoch=16.9] | Loss=0.04101 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.639 | L2-Norm(final)=6.248 | 4703.1 samples/s | 73.5 steps/s
[Step=3500 Epoch=17.2] | Loss=0.04018 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.672 | L2-Norm(final)=6.248 | 5486.3 samples/s | 85.7 steps/s
[Step=3550 Epoch=17.4] | Loss=0.03894 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.704 | L2-Norm(final)=6.249 | 2683.9 samples/s | 41.9 steps/s
[Step=3600 Epoch=17.7] | Loss=0.03790 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.734 | L2-Norm(final)=6.250 | 4825.8 samples/s | 75.4 steps/s
[Step=3650 Epoch=17.9] | Loss=0.03729 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.764 | L2-Norm(final)=6.252 | 4718.2 samples/s | 73.7 steps/s
[Step=3700 Epoch=18.1] | Loss=0.03653 | Reg=0.00250 | acc=0.9688 | L2-Norm=15.795 | L2-Norm(final)=6.253 | 5258.4 samples/s | 82.2 steps/s
[Step=3750 Epoch=18.4] | Loss=0.03592 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.825 | L2-Norm(final)=6.254 | 2792.7 samples/s | 43.6 steps/s
[Step=3800 Epoch=18.6] | Loss=0.03535 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.855 | L2-Norm(final)=6.255 | 4752.9 samples/s | 74.3 steps/s
[Step=3850 Epoch=18.9] | Loss=0.03469 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.884 | L2-Norm(final)=6.255 | 4833.9 samples/s | 75.5 steps/s
[Step=3900 Epoch=19.1] | Loss=0.03399 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.912 | L2-Norm(final)=6.256 | 4888.8 samples/s | 76.4 steps/s
[Step=3950 Epoch=19.4] | Loss=0.03363 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.940 | L2-Norm(final)=6.256 | 2863.8 samples/s | 44.7 steps/s
[Step=4000 Epoch=19.6] | Loss=0.03311 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.968 | L2-Norm(final)=6.257 | 4781.1 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step4000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=56.5] | Loss=0.10584 | Reg=0.00209 | acc=0.9062 | L2-Norm=14.468 | L2-Norm(final)=8.494 | 6527.5 samples/s | 102.0 steps/s
[Step=6050 Epoch=57.0] | Loss=0.05268 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.457 | L2-Norm(final)=8.429 | 4901.1 samples/s | 76.6 steps/s
[Step=6100 Epoch=57.5] | Loss=0.04194 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.455 | L2-Norm(final)=8.420 | 8103.2 samples/s | 126.6 steps/s
[Step=6150 Epoch=58.0] | Loss=0.03623 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.455 | L2-Norm(final)=8.449 | 2595.6 samples/s | 40.6 steps/s
[Step=6200 Epoch=58.4] | Loss=0.03294 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.454 | L2-Norm(final)=8.498 | 7117.1 samples/s | 111.2 steps/s
[Step=6250 Epoch=58.9] | Loss=0.03118 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.454 | L2-Norm(final)=8.554 | 2721.6 samples/s | 42.5 steps/s
[Step=6300 Epoch=59.4] | Loss=0.03008 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.454 | L2-Norm(final)=8.617 | 6215.6 samples/s | 97.1 steps/s
[Step=6350 Epoch=59.8] | Loss=0.02929 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.454 | L2-Norm(final)=8.683 | 2939.6 samples/s | 45.9 steps/s
[Step=6400 Epoch=60.3] | Loss=0.02837 | Reg=0.00209 | acc=0.9531 | L2-Norm=14.454 | L2-Norm(final)=8.749 | 5392.7 samples/s | 84.3 steps/s
[Step=6450 Epoch=60.8] | Loss=0.02786 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.454 | L2-Norm(final)=8.817 | 3034.0 samples/s | 47.4 steps/s
[Step=6500 Epoch=61.2] | Loss=0.02728 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.454 | L2-Norm(final)=8.884 | 5272.5 samples/s | 82.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=61.3] | Loss=0.04937 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.454 | L2-Norm(final)=9.558 | 6715.0 samples/s | 104.9 steps/s
[Step=6550 Epoch=61.7] | Loss=0.02874 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.782 | L2-Norm(final)=9.558 | 4125.7 samples/s | 64.5 steps/s
[Step=6600 Epoch=62.2] | Loss=0.02409 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.065 | L2-Norm(final)=9.533 | 6563.9 samples/s | 102.6 steps/s
[Step=6650 Epoch=62.7] | Loss=0.01688 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.196 | L2-Norm(final)=9.518 | 2414.3 samples/s | 37.7 steps/s
[Step=6700 Epoch=63.1] | Loss=0.01284 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.243 | L2-Norm(final)=9.516 | 5749.0 samples/s | 89.8 steps/s
[Step=6750 Epoch=63.6] | Loss=0.01068 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.252 | L2-Norm(final)=9.514 | 2529.9 samples/s | 39.5 steps/s
[Step=6800 Epoch=64.1] | Loss=0.00891 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.241 | L2-Norm(final)=9.514 | 5210.0 samples/s | 81.4 steps/s
[Step=6850 Epoch=64.5] | Loss=0.00765 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.219 | L2-Norm(final)=9.514 | 2631.4 samples/s | 41.1 steps/s
[Step=6900 Epoch=65.0] | Loss=0.00670 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.190 | L2-Norm(final)=9.515 | 4797.5 samples/s | 75.0 steps/s
[Step=6950 Epoch=65.5] | Loss=0.00596 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.156 | L2-Norm(final)=9.516 | 2777.1 samples/s | 43.4 steps/s
[Step=7000 Epoch=66.0] | Loss=0.00536 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.120 | L2-Norm(final)=9.517 | 4479.0 samples/s | 70.0 steps/s
[Step=7050 Epoch=66.4] | Loss=0.00488 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.082 | L2-Norm(final)=9.518 | 2915.3 samples/s | 45.6 steps/s
[Step=7100 Epoch=66.9] | Loss=0.00447 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.042 | L2-Norm(final)=9.519 | 4419.0 samples/s | 69.0 steps/s
[Step=7150 Epoch=67.4] | Loss=0.00413 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.002 | L2-Norm(final)=9.520 | 2871.2 samples/s | 44.9 steps/s
[Step=7200 Epoch=67.8] | Loss=0.00383 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.962 | L2-Norm(final)=9.521 | 4592.7 samples/s | 71.8 steps/s
[Step=7250 Epoch=68.3] | Loss=0.00358 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.921 | L2-Norm(final)=9.521 | 3048.1 samples/s | 47.6 steps/s
[Step=7300 Epoch=68.8] | Loss=0.00336 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.880 | L2-Norm(final)=9.522 | 4106.7 samples/s | 64.2 steps/s
[Step=7350 Epoch=69.3] | Loss=0.00316 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.839 | L2-Norm(final)=9.523 | 6552.0 samples/s | 102.4 steps/s
[Step=7400 Epoch=69.7] | Loss=0.00298 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.798 | L2-Norm(final)=9.524 | 2419.4 samples/s | 37.8 steps/s
[Step=7450 Epoch=70.2] | Loss=0.00283 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.757 | L2-Norm(final)=9.525 | 5807.0 samples/s | 90.7 steps/s
[Step=7500 Epoch=70.7] | Loss=0.00269 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.716 | L2-Norm(final)=9.526 | 2507.7 samples/s | 39.2 steps/s
[Step=7550 Epoch=71.1] | Loss=0.00256 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.675 | L2-Norm(final)=9.526 | 5310.4 samples/s | 83.0 steps/s
[Step=7600 Epoch=71.6] | Loss=0.00244 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.634 | L2-Norm(final)=9.527 | 2640.8 samples/s | 41.3 steps/s
[Step=7650 Epoch=72.1] | Loss=0.00234 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.594 | L2-Norm(final)=9.528 | 4719.9 samples/s | 73.7 steps/s
[Step=7700 Epoch=72.6] | Loss=0.00224 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.554 | L2-Norm(final)=9.529 | 2734.1 samples/s | 42.7 steps/s
[Step=7750 Epoch=73.0] | Loss=0.00215 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.514 | L2-Norm(final)=9.529 | 4589.2 samples/s | 71.7 steps/s
[Step=7800 Epoch=73.5] | Loss=0.00207 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.474 | L2-Norm(final)=9.530 | 2857.3 samples/s | 44.6 steps/s
[Step=7850 Epoch=74.0] | Loss=0.00199 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.434 | L2-Norm(final)=9.531 | 4553.1 samples/s | 71.1 steps/s
[Step=7900 Epoch=74.4] | Loss=0.00192 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.394 | L2-Norm(final)=9.531 | 2889.5 samples/s | 45.1 steps/s
[Step=7950 Epoch=74.9] | Loss=0.00186 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=9.532 | 4519.5 samples/s | 70.6 steps/s
[Step=8000 Epoch=75.4] | Loss=0.00179 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.315 | L2-Norm(final)=9.533 | 2906.6 samples/s | 45.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step8000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=57.2] | Loss=0.05214 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.468 | L2-Norm(final)=8.387 | 7743.6 samples/s | 121.0 steps/s
[Step=6050 Epoch=57.7] | Loss=0.04540 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.456 | L2-Norm(final)=8.347 | 4416.3 samples/s | 69.0 steps/s
[Step=6100 Epoch=58.1] | Loss=0.03789 | Reg=0.00209 | acc=0.9531 | L2-Norm=14.455 | L2-Norm(final)=8.386 | 8350.0 samples/s | 130.5 steps/s
[Step=6150 Epoch=58.6] | Loss=0.03551 | Reg=0.00209 | acc=0.9531 | L2-Norm=14.454 | L2-Norm(final)=8.470 | 2563.8 samples/s | 40.1 steps/s
[Step=6200 Epoch=59.1] | Loss=0.03422 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.454 | L2-Norm(final)=8.560 | 7580.5 samples/s | 118.4 steps/s
[Step=6250 Epoch=59.6] | Loss=0.03350 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.454 | L2-Norm(final)=8.651 | 2678.0 samples/s | 41.8 steps/s
[Step=6300 Epoch=60.0] | Loss=0.03258 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.454 | L2-Norm(final)=8.741 | 6736.7 samples/s | 105.3 steps/s
[Step=6350 Epoch=60.5] | Loss=0.03186 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.454 | L2-Norm(final)=8.829 | 2736.9 samples/s | 42.8 steps/s
[Step=6400 Epoch=61.0] | Loss=0.03153 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.454 | L2-Norm(final)=8.915 | 6267.4 samples/s | 97.9 steps/s
[Step=6450 Epoch=61.5] | Loss=0.03123 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.454 | L2-Norm(final)=8.997 | 2840.4 samples/s | 44.4 steps/s
[Step=6500 Epoch=62.0] | Loss=0.03088 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.454 | L2-Norm(final)=9.076 | 5886.0 samples/s | 92.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=62.0] | Loss=0.02126 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.453 | L2-Norm(final)=9.870 | 6568.1 samples/s | 102.6 steps/s
[Step=6550 Epoch=62.4] | Loss=0.02945 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.796 | L2-Norm(final)=9.872 | 4196.4 samples/s | 65.6 steps/s
[Step=6600 Epoch=62.9] | Loss=0.02054 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.124 | L2-Norm(final)=9.828 | 6631.0 samples/s | 103.6 steps/s
[Step=6650 Epoch=63.4] | Loss=0.01441 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.252 | L2-Norm(final)=9.810 | 2355.1 samples/s | 36.8 steps/s
[Step=6700 Epoch=63.9] | Loss=0.01088 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.297 | L2-Norm(final)=9.802 | 6165.5 samples/s | 96.3 steps/s
[Step=6750 Epoch=64.3] | Loss=0.00873 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.302 | L2-Norm(final)=9.798 | 2464.1 samples/s | 38.5 steps/s
[Step=6800 Epoch=64.8] | Loss=0.00728 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.287 | L2-Norm(final)=9.796 | 5636.6 samples/s | 88.1 steps/s
[Step=6850 Epoch=65.3] | Loss=0.00624 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.259 | L2-Norm(final)=9.794 | 2577.7 samples/s | 40.3 steps/s
[Step=6900 Epoch=65.8] | Loss=0.00546 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.226 | L2-Norm(final)=9.793 | 5126.3 samples/s | 80.1 steps/s
[Step=6950 Epoch=66.2] | Loss=0.00486 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.188 | L2-Norm(final)=9.793 | 2623.2 samples/s | 41.0 steps/s
[Step=7000 Epoch=66.7] | Loss=0.00437 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.148 | L2-Norm(final)=9.792 | 4923.3 samples/s | 76.9 steps/s
[Step=7050 Epoch=67.2] | Loss=0.00397 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.107 | L2-Norm(final)=9.792 | 2726.6 samples/s | 42.6 steps/s
[Step=7100 Epoch=67.7] | Loss=0.00364 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.064 | L2-Norm(final)=9.792 | 4636.4 samples/s | 72.4 steps/s
[Step=7150 Epoch=68.1] | Loss=0.00336 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.022 | L2-Norm(final)=9.791 | 2832.1 samples/s | 44.3 steps/s
[Step=7200 Epoch=68.6] | Loss=0.00312 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.979 | L2-Norm(final)=9.791 | 4505.5 samples/s | 70.4 steps/s
[Step=7250 Epoch=69.1] | Loss=0.00292 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.935 | L2-Norm(final)=9.791 | 2819.0 samples/s | 44.0 steps/s
[Step=7300 Epoch=69.6] | Loss=0.00273 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.892 | L2-Norm(final)=9.791 | 4540.6 samples/s | 70.9 steps/s
[Step=7350 Epoch=70.1] | Loss=0.00257 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.849 | L2-Norm(final)=9.791 | 2855.6 samples/s | 44.6 steps/s
[Step=7400 Epoch=70.5] | Loss=0.00243 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.806 | L2-Norm(final)=9.792 | 4581.4 samples/s | 71.6 steps/s
[Step=7450 Epoch=71.0] | Loss=0.00230 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.764 | L2-Norm(final)=9.792 | 2879.5 samples/s | 45.0 steps/s
[Step=7500 Epoch=71.5] | Loss=0.00219 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.721 | L2-Norm(final)=9.792 | 4428.9 samples/s | 69.2 steps/s
[Step=7550 Epoch=72.0] | Loss=0.00209 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.679 | L2-Norm(final)=9.792 | 7300.9 samples/s | 114.1 steps/s
[Step=7600 Epoch=72.4] | Loss=0.00199 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.637 | L2-Norm(final)=9.792 | 2302.3 samples/s | 36.0 steps/s
[Step=7650 Epoch=72.9] | Loss=0.00190 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.596 | L2-Norm(final)=9.793 | 6711.5 samples/s | 104.9 steps/s
[Step=7700 Epoch=73.4] | Loss=0.00183 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.555 | L2-Norm(final)=9.793 | 2356.4 samples/s | 36.8 steps/s
[Step=7750 Epoch=73.9] | Loss=0.00175 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.514 | L2-Norm(final)=9.793 | 6165.3 samples/s | 96.3 steps/s
[Step=7800 Epoch=74.3] | Loss=0.00168 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.473 | L2-Norm(final)=9.793 | 2445.4 samples/s | 38.2 steps/s
[Step=7850 Epoch=74.8] | Loss=0.00162 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.432 | L2-Norm(final)=9.794 | 5700.7 samples/s | 89.1 steps/s
[Step=7900 Epoch=75.3] | Loss=0.00156 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.392 | L2-Norm(final)=9.794 | 1866.0 samples/s | 29.2 steps/s
[Step=7950 Epoch=75.8] | Loss=0.00151 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.352 | L2-Norm(final)=9.794 | 5284.4 samples/s | 82.6 steps/s
[Step=8000 Epoch=76.2] | Loss=0.00146 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.313 | L2-Norm(final)=9.795 | 2592.0 samples/s | 40.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.14686 | acc=0.9323 | tpr=0.9509 | fpr=0.1083 | 5637.7 samples/s | 22.0 steps/s
Avg test loss: 0.15329, Avg test acc: 0.92788, Avg tpr: 0.94830, Avg fpr: 0.11704, total FA: 913

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14698 | acc=0.9328 | tpr=0.9461 | fpr=0.0961 | 6088.0 samples/s | 23.8 steps/s
Avg test loss: 0.14956, Avg test acc: 0.93084, Avg tpr: 0.94399, Avg fpr: 0.09806, total FA: 765

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.15329 | acc=0.9373 | tpr=0.9524 | fpr=0.0956 | 5793.9 samples/s | 22.6 steps/s
Avg test loss: 0.15689, Avg test acc: 0.93529, Avg tpr: 0.95005, Avg fpr: 0.09717, total FA: 758

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.13793 | acc=0.9387 | tpr=0.9542 | fpr=0.0949 | 6114.8 samples/s | 23.9 steps/s
Avg test loss: 0.14917, Avg test acc: 0.93537, Avg tpr: 0.95256, Avg fpr: 0.10242, total FA: 799

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.13225 | acc=0.9321 | tpr=0.9492 | fpr=0.1051 | 6124.9 samples/s | 23.9 steps/s
Avg test loss: 0.13894, Avg test acc: 0.92940, Avg tpr: 0.94679, Avg fpr: 0.10883, total FA: 849

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.64241 | acc=0.3188 | tpr=0.0159 | fpr=0.0233 | 5998.3 samples/s | 23.4 steps/s
Avg test loss: 5.65212, Avg test acc: 0.31513, Avg tpr: 0.01510, Avg fpr: 0.02500, total FA: 195

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.48856 | acc=0.3223 | tpr=0.0256 | fpr=0.0332 | 6013.1 samples/s | 23.5 steps/s
Avg test loss: 5.51312, Avg test acc: 0.32126, Avg tpr: 0.02646, Avg fpr: 0.03038, total FA: 237

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.20931 | acc=0.3243 | tpr=0.0423 | fpr=0.0634 | 6041.4 samples/s | 23.6 steps/s
Avg test loss: 4.22080, Avg test acc: 0.32250, Avg tpr: 0.04127, Avg fpr: 0.05897, total FA: 460

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.39632 | acc=0.3205 | tpr=0.0366 | fpr=0.0629 | 6065.7 samples/s | 23.7 steps/s
Avg test loss: 4.40138, Avg test acc: 0.31825, Avg tpr: 0.03550, Avg fpr: 0.05986, total FA: 467

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=6.04448 | acc=0.3141 | tpr=0.0086 | fpr=0.0225 | 6055.6 samples/s | 23.7 steps/s
Avg test loss: 6.06691, Avg test acc: 0.31261, Avg tpr: 0.00898, Avg fpr: 0.01961, total FA: 153

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.87278 | acc=0.1291 | tpr=0.8230 | fpr=0.8833 | 5988.0 samples/s | 23.4 steps/s
[Step= 100] | Loss=4.86516 | acc=0.1263 | tpr=0.7932 | fpr=0.8862 | 8251.8 samples/s | 32.2 steps/s
[Step= 150] | Loss=4.85252 | acc=0.1273 | tpr=0.7954 | fpr=0.8850 | 8173.2 samples/s | 31.9 steps/s
[Step= 200] | Loss=4.86125 | acc=0.1268 | tpr=0.7869 | fpr=0.8852 | 7915.5 samples/s | 30.9 steps/s
[Step= 250] | Loss=4.87290 | acc=0.1270 | tpr=0.7886 | fpr=0.8850 | 7255.9 samples/s | 28.3 steps/s
[Step= 300] | Loss=4.86946 | acc=0.1274 | tpr=0.7956 | fpr=0.8848 | 8078.9 samples/s | 31.6 steps/s
[Step= 350] | Loss=4.87167 | acc=0.1274 | tpr=0.7921 | fpr=0.8847 | 8333.1 samples/s | 32.6 steps/s
[Step= 400] | Loss=4.86841 | acc=0.1278 | tpr=0.7888 | fpr=0.8842 | 8855.1 samples/s | 34.6 steps/s
[Step= 450] | Loss=4.87358 | acc=0.1274 | tpr=0.7882 | fpr=0.8846 | 8202.0 samples/s | 32.0 steps/s
[Step= 500] | Loss=4.87414 | acc=0.1273 | tpr=0.7912 | fpr=0.8847 | 7931.4 samples/s | 31.0 steps/s
[Step= 550] | Loss=4.87599 | acc=0.1272 | tpr=0.7931 | fpr=0.8849 | 9452.3 samples/s | 36.9 steps/s
Avg test loss: 4.87693, Avg test acc: 0.12720, Avg tpr: 0.79358, Avg fpr: 0.88492, total FA: 122869

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.74138 | acc=0.1402 | tpr=0.8186 | fpr=0.8720 | 5887.2 samples/s | 23.0 steps/s
[Step= 100] | Loss=5.72638 | acc=0.1423 | tpr=0.7974 | fpr=0.8699 | 8159.4 samples/s | 31.9 steps/s
[Step= 150] | Loss=5.72218 | acc=0.1431 | tpr=0.7968 | fpr=0.8689 | 8060.9 samples/s | 31.5 steps/s
[Step= 200] | Loss=5.71850 | acc=0.1436 | tpr=0.7934 | fpr=0.8682 | 8158.7 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.71786 | acc=0.1442 | tpr=0.8000 | fpr=0.8678 | 8322.9 samples/s | 32.5 steps/s
[Step= 300] | Loss=5.71651 | acc=0.1444 | tpr=0.8036 | fpr=0.8676 | 7216.7 samples/s | 28.2 steps/s
[Step= 350] | Loss=5.72279 | acc=0.1441 | tpr=0.8053 | fpr=0.8679 | 8156.7 samples/s | 31.9 steps/s
[Step= 400] | Loss=5.72251 | acc=0.1441 | tpr=0.8009 | fpr=0.8678 | 8489.6 samples/s | 33.2 steps/s
[Step= 450] | Loss=5.72806 | acc=0.1433 | tpr=0.7999 | fpr=0.8686 | 8222.4 samples/s | 32.1 steps/s
[Step= 500] | Loss=5.72886 | acc=0.1435 | tpr=0.8048 | fpr=0.8684 | 8109.8 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.73095 | acc=0.1440 | tpr=0.8054 | fpr=0.8680 | 9753.0 samples/s | 38.1 steps/s
Avg test loss: 5.73187, Avg test acc: 0.14388, Avg tpr: 0.80626, Avg fpr: 0.86816, total FA: 120542

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.79943 | acc=0.1257 | tpr=0.8584 | fpr=0.8875 | 5923.8 samples/s | 23.1 steps/s
[Step= 100] | Loss=5.78174 | acc=0.1249 | tpr=0.8337 | fpr=0.8883 | 8444.6 samples/s | 33.0 steps/s
[Step= 150] | Loss=5.79062 | acc=0.1260 | tpr=0.8314 | fpr=0.8870 | 7333.7 samples/s | 28.6 steps/s
[Step= 200] | Loss=5.78785 | acc=0.1259 | tpr=0.8240 | fpr=0.8868 | 8475.0 samples/s | 33.1 steps/s
[Step= 250] | Loss=5.79872 | acc=0.1258 | tpr=0.8236 | fpr=0.8869 | 7771.3 samples/s | 30.4 steps/s
[Step= 300] | Loss=5.79958 | acc=0.1261 | tpr=0.8291 | fpr=0.8868 | 8309.5 samples/s | 32.5 steps/s
[Step= 350] | Loss=5.79932 | acc=0.1265 | tpr=0.8353 | fpr=0.8864 | 8108.3 samples/s | 31.7 steps/s
[Step= 400] | Loss=5.79914 | acc=0.1266 | tpr=0.8337 | fpr=0.8863 | 7220.4 samples/s | 28.2 steps/s
[Step= 450] | Loss=5.80064 | acc=0.1263 | tpr=0.8320 | fpr=0.8865 | 8206.8 samples/s | 32.1 steps/s
[Step= 500] | Loss=5.80127 | acc=0.1265 | tpr=0.8352 | fpr=0.8863 | 8562.1 samples/s | 33.4 steps/s
[Step= 550] | Loss=5.80463 | acc=0.1268 | tpr=0.8353 | fpr=0.8860 | 10204.3 samples/s | 39.9 steps/s
Avg test loss: 5.80440, Avg test acc: 0.12679, Avg tpr: 0.83518, Avg fpr: 0.88609, total FA: 123032

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.94673 | acc=0.1376 | tpr=0.8584 | fpr=0.8754 | 6177.1 samples/s | 24.1 steps/s
[Step= 100] | Loss=5.92134 | acc=0.1386 | tpr=0.8486 | fpr=0.8747 | 8072.2 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.91508 | acc=0.1395 | tpr=0.8458 | fpr=0.8735 | 7010.5 samples/s | 27.4 steps/s
[Step= 200] | Loss=5.90788 | acc=0.1389 | tpr=0.8383 | fpr=0.8739 | 8169.9 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.91580 | acc=0.1383 | tpr=0.8288 | fpr=0.8743 | 7867.3 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.90826 | acc=0.1385 | tpr=0.8262 | fpr=0.8741 | 8222.3 samples/s | 32.1 steps/s
[Step= 350] | Loss=5.91269 | acc=0.1382 | tpr=0.8278 | fpr=0.8743 | 8227.0 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.91182 | acc=0.1382 | tpr=0.8233 | fpr=0.8742 | 8375.1 samples/s | 32.7 steps/s
[Step= 450] | Loss=5.91455 | acc=0.1380 | tpr=0.8257 | fpr=0.8744 | 8287.1 samples/s | 32.4 steps/s
[Step= 500] | Loss=5.91153 | acc=0.1382 | tpr=0.8273 | fpr=0.8743 | 8470.2 samples/s | 33.1 steps/s
[Step= 550] | Loss=5.91570 | acc=0.1383 | tpr=0.8285 | fpr=0.8743 | 9309.5 samples/s | 36.4 steps/s
Avg test loss: 5.91736, Avg test acc: 0.13815, Avg tpr: 0.82845, Avg fpr: 0.87440, total FA: 121409

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=3.76748 | acc=0.1673 | tpr=0.7743 | fpr=0.8436 | 6108.3 samples/s | 23.9 steps/s
[Step= 100] | Loss=3.77406 | acc=0.1659 | tpr=0.7633 | fpr=0.8452 | 7021.6 samples/s | 27.4 steps/s
[Step= 150] | Loss=3.76644 | acc=0.1666 | tpr=0.7651 | fpr=0.8444 | 8094.1 samples/s | 31.6 steps/s
[Step= 200] | Loss=3.76595 | acc=0.1659 | tpr=0.7639 | fpr=0.8449 | 8390.9 samples/s | 32.8 steps/s
[Step= 250] | Loss=3.76527 | acc=0.1659 | tpr=0.7607 | fpr=0.8450 | 8122.7 samples/s | 31.7 steps/s
[Step= 300] | Loss=3.76599 | acc=0.1657 | tpr=0.7644 | fpr=0.8452 | 8602.9 samples/s | 33.6 steps/s
[Step= 350] | Loss=3.76656 | acc=0.1653 | tpr=0.7664 | fpr=0.8456 | 7946.2 samples/s | 31.0 steps/s
[Step= 400] | Loss=3.76641 | acc=0.1655 | tpr=0.7664 | fpr=0.8455 | 8365.4 samples/s | 32.7 steps/s
[Step= 450] | Loss=3.76923 | acc=0.1647 | tpr=0.7663 | fpr=0.8462 | 8326.9 samples/s | 32.5 steps/s
[Step= 500] | Loss=3.76773 | acc=0.1648 | tpr=0.7705 | fpr=0.8461 | 7647.6 samples/s | 29.9 steps/s
[Step= 550] | Loss=3.76957 | acc=0.1649 | tpr=0.7688 | fpr=0.8461 | 9877.9 samples/s | 38.6 steps/s
Avg test loss: 3.77030, Avg test acc: 0.16484, Avg tpr: 0.76941, Avg fpr: 0.84615, total FA: 117486

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.16308 | acc=0.9558 | tpr=0.9071 | fpr=0.0433 | 5788.7 samples/s | 22.6 steps/s
[Step= 100] | Loss=0.16864 | acc=0.9545 | tpr=0.9147 | fpr=0.0448 | 7921.4 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.17087 | acc=0.9537 | tpr=0.9179 | fpr=0.0457 | 7606.5 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.17228 | acc=0.9541 | tpr=0.9224 | fpr=0.0453 | 8554.1 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.17404 | acc=0.9539 | tpr=0.9179 | fpr=0.0454 | 8343.1 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.17608 | acc=0.9535 | tpr=0.9113 | fpr=0.0458 | 8075.9 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.17560 | acc=0.9536 | tpr=0.9117 | fpr=0.0457 | 7930.5 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.17615 | acc=0.9535 | tpr=0.9081 | fpr=0.0457 | 8443.3 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.17787 | acc=0.9531 | tpr=0.9051 | fpr=0.0461 | 7376.6 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.17866 | acc=0.9528 | tpr=0.9062 | fpr=0.0463 | 8022.6 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.17711 | acc=0.9531 | tpr=0.9061 | fpr=0.0461 | 10766.1 samples/s | 42.1 steps/s
Avg test loss: 0.17687, Avg test acc: 0.95308, Avg tpr: 0.90610, Avg fpr: 0.04606, total FA: 6396

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13299 | acc=0.9613 | tpr=0.8717 | fpr=0.0371 | 6047.8 samples/s | 23.6 steps/s
[Step= 100] | Loss=0.13336 | acc=0.9613 | tpr=0.8934 | fpr=0.0374 | 7781.1 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.13599 | acc=0.9601 | tpr=0.9020 | fpr=0.0388 | 7913.3 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.13630 | acc=0.9606 | tpr=0.9005 | fpr=0.0383 | 7241.6 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.13805 | acc=0.9602 | tpr=0.8969 | fpr=0.0386 | 8055.8 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.13920 | acc=0.9598 | tpr=0.8975 | fpr=0.0391 | 8380.2 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.13996 | acc=0.9596 | tpr=0.8967 | fpr=0.0393 | 7942.2 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.13964 | acc=0.9594 | tpr=0.8900 | fpr=0.0394 | 8156.1 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.14101 | acc=0.9591 | tpr=0.8885 | fpr=0.0396 | 8323.0 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.14078 | acc=0.9592 | tpr=0.8912 | fpr=0.0396 | 8169.8 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.14016 | acc=0.9593 | tpr=0.8882 | fpr=0.0394 | 10485.6 samples/s | 41.0 steps/s
Avg test loss: 0.13986, Avg test acc: 0.95934, Avg tpr: 0.88827, Avg fpr: 0.03937, total FA: 5466

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.22424 | acc=0.9466 | tpr=0.9381 | fpr=0.0532 | 5801.6 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.23074 | acc=0.9462 | tpr=0.9318 | fpr=0.0536 | 7822.7 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.23536 | acc=0.9452 | tpr=0.9323 | fpr=0.0546 | 8829.1 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.23671 | acc=0.9455 | tpr=0.9366 | fpr=0.0543 | 7935.5 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.23777 | acc=0.9454 | tpr=0.9293 | fpr=0.0543 | 7657.0 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.24002 | acc=0.9446 | tpr=0.9244 | fpr=0.0550 | 8015.3 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.23866 | acc=0.9449 | tpr=0.9261 | fpr=0.0547 | 8120.6 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.23984 | acc=0.9445 | tpr=0.9240 | fpr=0.0551 | 7860.6 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.24044 | acc=0.9442 | tpr=0.9231 | fpr=0.0554 | 8298.3 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.24167 | acc=0.9439 | tpr=0.9238 | fpr=0.0557 | 7550.4 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.24048 | acc=0.9442 | tpr=0.9252 | fpr=0.0554 | 11084.6 samples/s | 43.3 steps/s
Avg test loss: 0.24028, Avg test acc: 0.94428, Avg tpr: 0.92512, Avg fpr: 0.05537, total FA: 7688

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14291 | acc=0.9597 | tpr=0.8540 | fpr=0.0384 | 5903.5 samples/s | 23.1 steps/s
[Step= 100] | Loss=0.14990 | acc=0.9585 | tpr=0.8742 | fpr=0.0400 | 8170.6 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.15490 | acc=0.9576 | tpr=0.8862 | fpr=0.0411 | 7744.8 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.15433 | acc=0.9580 | tpr=0.8852 | fpr=0.0407 | 8110.8 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.15588 | acc=0.9580 | tpr=0.8838 | fpr=0.0406 | 8482.2 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.15715 | acc=0.9575 | tpr=0.8807 | fpr=0.0411 | 7617.3 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.15660 | acc=0.9576 | tpr=0.8848 | fpr=0.0410 | 8371.6 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.15664 | acc=0.9576 | tpr=0.8840 | fpr=0.0411 | 7280.0 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.15837 | acc=0.9571 | tpr=0.8812 | fpr=0.0415 | 8190.9 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.15857 | acc=0.9571 | tpr=0.8846 | fpr=0.0416 | 8249.4 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.15800 | acc=0.9572 | tpr=0.8858 | fpr=0.0415 | 10459.5 samples/s | 40.9 steps/s
Avg test loss: 0.15790, Avg test acc: 0.95723, Avg tpr: 0.88590, Avg fpr: 0.04147, total FA: 5758

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21249 | acc=0.9555 | tpr=0.8938 | fpr=0.0434 | 5825.9 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.22081 | acc=0.9547 | tpr=0.9104 | fpr=0.0445 | 8132.6 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.22236 | acc=0.9538 | tpr=0.9222 | fpr=0.0456 | 7411.7 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.22323 | acc=0.9540 | tpr=0.9257 | fpr=0.0455 | 7941.1 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.22440 | acc=0.9536 | tpr=0.9205 | fpr=0.0458 | 8243.5 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.22727 | acc=0.9528 | tpr=0.9207 | fpr=0.0466 | 8081.5 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.22575 | acc=0.9531 | tpr=0.9205 | fpr=0.0463 | 8310.7 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.22546 | acc=0.9529 | tpr=0.9136 | fpr=0.0464 | 8468.5 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.22772 | acc=0.9525 | tpr=0.9114 | fpr=0.0468 | 7209.1 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.22895 | acc=0.9523 | tpr=0.9128 | fpr=0.0470 | 8409.1 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.22767 | acc=0.9525 | tpr=0.9121 | fpr=0.0467 | 10789.3 samples/s | 42.1 steps/s
Avg test loss: 0.22751, Avg test acc: 0.95256, Avg tpr: 0.91204, Avg fpr: 0.04670, total FA: 6484

server round 6/50

clients selected: [1 3 4 5 6]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=39.0] | Loss=0.17272 | Reg=0.00194 | acc=0.8906 | L2-Norm=13.939 | L2-Norm(final)=7.480 | 6392.5 samples/s | 99.9 steps/s
[Step=8050 Epoch=39.3] | Loss=0.12603 | Reg=0.00194 | acc=0.9375 | L2-Norm=13.945 | L2-Norm(final)=7.538 | 5370.2 samples/s | 83.9 steps/s
[Step=8100 Epoch=39.5] | Loss=0.12756 | Reg=0.00194 | acc=0.8438 | L2-Norm=13.946 | L2-Norm(final)=7.649 | 5584.3 samples/s | 87.3 steps/s
[Step=8150 Epoch=39.8] | Loss=0.12805 | Reg=0.00194 | acc=0.9531 | L2-Norm=13.946 | L2-Norm(final)=7.748 | 5472.4 samples/s | 85.5 steps/s
[Step=8200 Epoch=40.0] | Loss=0.12699 | Reg=0.00195 | acc=0.8438 | L2-Norm=13.946 | L2-Norm(final)=7.840 | 8775.5 samples/s | 137.1 steps/s
[Step=8250 Epoch=40.3] | Loss=0.12726 | Reg=0.00195 | acc=0.9062 | L2-Norm=13.947 | L2-Norm(final)=7.923 | 2662.6 samples/s | 41.6 steps/s
[Step=8300 Epoch=40.5] | Loss=0.12640 | Reg=0.00195 | acc=0.9375 | L2-Norm=13.947 | L2-Norm(final)=8.001 | 5640.2 samples/s | 88.1 steps/s
[Step=8350 Epoch=40.7] | Loss=0.12650 | Reg=0.00195 | acc=0.8594 | L2-Norm=13.947 | L2-Norm(final)=8.073 | 5495.1 samples/s | 85.9 steps/s
[Step=8400 Epoch=41.0] | Loss=0.12551 | Reg=0.00195 | acc=0.8750 | L2-Norm=13.947 | L2-Norm(final)=8.140 | 7778.8 samples/s | 121.5 steps/s
[Step=8450 Epoch=41.2] | Loss=0.12530 | Reg=0.00195 | acc=0.8594 | L2-Norm=13.947 | L2-Norm(final)=8.208 | 2766.5 samples/s | 43.2 steps/s
[Step=8500 Epoch=41.5] | Loss=0.12478 | Reg=0.00195 | acc=0.9219 | L2-Norm=13.947 | L2-Norm(final)=8.274 | 5551.6 samples/s | 86.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=41.5] | Loss=0.09613 | Reg=0.00195 | acc=0.9219 | L2-Norm=13.947 | L2-Norm(final)=8.917 | 6374.2 samples/s | 99.6 steps/s
[Step=8550 Epoch=41.7] | Loss=0.10487 | Reg=0.00201 | acc=0.8594 | L2-Norm=14.190 | L2-Norm(final)=8.912 | 4725.8 samples/s | 73.8 steps/s
[Step=8600 Epoch=42.0] | Loss=0.09373 | Reg=0.00207 | acc=0.9531 | L2-Norm=14.390 | L2-Norm(final)=8.892 | 4774.7 samples/s | 74.6 steps/s
[Step=8650 Epoch=42.2] | Loss=0.08838 | Reg=0.00211 | acc=0.9219 | L2-Norm=14.536 | L2-Norm(final)=8.876 | 4835.8 samples/s | 75.6 steps/s
[Step=8700 Epoch=42.5] | Loss=0.08493 | Reg=0.00215 | acc=0.9531 | L2-Norm=14.654 | L2-Norm(final)=8.861 | 6731.2 samples/s | 105.2 steps/s
[Step=8750 Epoch=42.7] | Loss=0.07573 | Reg=0.00218 | acc=0.9375 | L2-Norm=14.751 | L2-Norm(final)=8.853 | 2459.0 samples/s | 38.4 steps/s
[Step=8800 Epoch=42.9] | Loss=0.07157 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.840 | L2-Norm(final)=8.849 | 4717.7 samples/s | 73.7 steps/s
[Step=8850 Epoch=43.2] | Loss=0.06763 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.921 | L2-Norm(final)=8.847 | 4756.1 samples/s | 74.3 steps/s
[Step=8900 Epoch=43.4] | Loss=0.06504 | Reg=0.00225 | acc=0.9375 | L2-Norm=14.995 | L2-Norm(final)=8.843 | 6358.6 samples/s | 99.4 steps/s
[Step=8950 Epoch=43.7] | Loss=0.06184 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.062 | L2-Norm(final)=8.841 | 2534.3 samples/s | 39.6 steps/s
[Step=9000 Epoch=43.9] | Loss=0.05850 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.123 | L2-Norm(final)=8.840 | 4777.7 samples/s | 74.7 steps/s
[Step=9050 Epoch=44.2] | Loss=0.05618 | Reg=0.00231 | acc=0.9375 | L2-Norm=15.181 | L2-Norm(final)=8.840 | 4777.7 samples/s | 74.7 steps/s
[Step=9100 Epoch=44.4] | Loss=0.05385 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.235 | L2-Norm(final)=8.841 | 5889.2 samples/s | 92.0 steps/s
[Step=9150 Epoch=44.6] | Loss=0.05128 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.284 | L2-Norm(final)=8.841 | 2646.2 samples/s | 41.3 steps/s
[Step=9200 Epoch=44.9] | Loss=0.04918 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.329 | L2-Norm(final)=8.842 | 4735.3 samples/s | 74.0 steps/s
[Step=9250 Epoch=45.1] | Loss=0.04723 | Reg=0.00237 | acc=0.9531 | L2-Norm=15.370 | L2-Norm(final)=8.843 | 4810.3 samples/s | 75.2 steps/s
[Step=9300 Epoch=45.4] | Loss=0.04583 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.410 | L2-Norm(final)=8.844 | 5453.3 samples/s | 85.2 steps/s
[Step=9350 Epoch=45.6] | Loss=0.04456 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.450 | L2-Norm(final)=8.844 | 2716.5 samples/s | 42.4 steps/s
[Step=9400 Epoch=45.9] | Loss=0.04282 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.487 | L2-Norm(final)=8.846 | 4707.6 samples/s | 73.6 steps/s
[Step=9450 Epoch=46.1] | Loss=0.04163 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.522 | L2-Norm(final)=8.847 | 4808.0 samples/s | 75.1 steps/s
[Step=9500 Epoch=46.4] | Loss=0.04052 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.555 | L2-Norm(final)=8.848 | 5107.9 samples/s | 79.8 steps/s
[Step=9550 Epoch=46.6] | Loss=0.03937 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.587 | L2-Norm(final)=8.850 | 2809.0 samples/s | 43.9 steps/s
[Step=9600 Epoch=46.8] | Loss=0.03815 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.619 | L2-Norm(final)=8.853 | 4748.4 samples/s | 74.2 steps/s
[Step=9650 Epoch=47.1] | Loss=0.03723 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.649 | L2-Norm(final)=8.855 | 4778.8 samples/s | 74.7 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03650 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.678 | L2-Norm(final)=8.857 | 4835.1 samples/s | 75.5 steps/s
[Step=9750 Epoch=47.6] | Loss=0.03566 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.706 | L2-Norm(final)=8.858 | 2878.7 samples/s | 45.0 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03482 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.734 | L2-Norm(final)=8.860 | 4737.4 samples/s | 74.0 steps/s
[Step=9850 Epoch=48.1] | Loss=0.03409 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.760 | L2-Norm(final)=8.862 | 4723.1 samples/s | 73.8 steps/s
[Step=9900 Epoch=48.3] | Loss=0.03346 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.786 | L2-Norm(final)=8.863 | 4768.4 samples/s | 74.5 steps/s
[Step=9950 Epoch=48.6] | Loss=0.03295 | Reg=0.00250 | acc=0.9688 | L2-Norm=15.812 | L2-Norm(final)=8.865 | 2940.5 samples/s | 45.9 steps/s
[Step=10000 Epoch=48.8] | Loss=0.03239 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.839 | L2-Norm(final)=8.867 | 4747.1 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step10000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=29.3] | Loss=0.13336 | Reg=0.00194 | acc=0.9062 | L2-Norm=13.939 | L2-Norm(final)=6.522 | 7159.3 samples/s | 111.9 steps/s
[Step=6050 Epoch=29.5] | Loss=0.13031 | Reg=0.00194 | acc=0.9219 | L2-Norm=13.938 | L2-Norm(final)=6.561 | 4904.7 samples/s | 76.6 steps/s
[Step=6100 Epoch=29.7] | Loss=0.12658 | Reg=0.00194 | acc=0.8906 | L2-Norm=13.938 | L2-Norm(final)=6.641 | 5545.8 samples/s | 86.7 steps/s
[Step=6150 Epoch=30.0] | Loss=0.12741 | Reg=0.00194 | acc=0.9531 | L2-Norm=13.939 | L2-Norm(final)=6.735 | 5683.6 samples/s | 88.8 steps/s
[Step=6200 Epoch=30.2] | Loss=0.12739 | Reg=0.00194 | acc=0.8438 | L2-Norm=13.939 | L2-Norm(final)=6.832 | 8395.5 samples/s | 131.2 steps/s
[Step=6250 Epoch=30.5] | Loss=0.12584 | Reg=0.00194 | acc=0.9531 | L2-Norm=13.939 | L2-Norm(final)=6.926 | 2672.4 samples/s | 41.8 steps/s
[Step=6300 Epoch=30.7] | Loss=0.12529 | Reg=0.00194 | acc=0.9219 | L2-Norm=13.939 | L2-Norm(final)=7.014 | 5525.7 samples/s | 86.3 steps/s
[Step=6350 Epoch=31.0] | Loss=0.12516 | Reg=0.00194 | acc=0.8594 | L2-Norm=13.939 | L2-Norm(final)=7.099 | 5606.6 samples/s | 87.6 steps/s
[Step=6400 Epoch=31.2] | Loss=0.12427 | Reg=0.00194 | acc=0.9531 | L2-Norm=13.939 | L2-Norm(final)=7.178 | 7605.9 samples/s | 118.8 steps/s
[Step=6450 Epoch=31.5] | Loss=0.12314 | Reg=0.00194 | acc=0.8906 | L2-Norm=13.939 | L2-Norm(final)=7.255 | 2788.8 samples/s | 43.6 steps/s
[Step=6500 Epoch=31.7] | Loss=0.12244 | Reg=0.00194 | acc=0.9375 | L2-Norm=13.939 | L2-Norm(final)=7.330 | 5621.3 samples/s | 87.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=31.7] | Loss=0.09598 | Reg=0.00194 | acc=0.9375 | L2-Norm=13.939 | L2-Norm(final)=8.078 | 7302.1 samples/s | 114.1 steps/s
[Step=6550 Epoch=31.9] | Loss=0.09506 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.139 | L2-Norm(final)=8.101 | 4215.0 samples/s | 65.9 steps/s
[Step=6600 Epoch=32.2] | Loss=0.09297 | Reg=0.00205 | acc=0.9531 | L2-Norm=14.331 | L2-Norm(final)=8.079 | 4844.8 samples/s | 75.7 steps/s
[Step=6650 Epoch=32.4] | Loss=0.08580 | Reg=0.00210 | acc=0.9375 | L2-Norm=14.474 | L2-Norm(final)=8.062 | 4662.2 samples/s | 72.8 steps/s
[Step=6700 Epoch=32.7] | Loss=0.08138 | Reg=0.00213 | acc=0.9531 | L2-Norm=14.578 | L2-Norm(final)=8.045 | 6876.6 samples/s | 107.4 steps/s
[Step=6750 Epoch=32.9] | Loss=0.07663 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.675 | L2-Norm(final)=8.032 | 2499.0 samples/s | 39.0 steps/s
[Step=6800 Epoch=33.2] | Loss=0.07118 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.763 | L2-Norm(final)=8.023 | 4673.7 samples/s | 73.0 steps/s
[Step=6850 Epoch=33.4] | Loss=0.06717 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.839 | L2-Norm(final)=8.017 | 4888.7 samples/s | 76.4 steps/s
[Step=6900 Epoch=33.6] | Loss=0.06389 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.904 | L2-Norm(final)=8.011 | 6055.7 samples/s | 94.6 steps/s
[Step=6950 Epoch=33.9] | Loss=0.05929 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.962 | L2-Norm(final)=8.008 | 2585.3 samples/s | 40.4 steps/s
[Step=7000 Epoch=34.1] | Loss=0.05595 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.014 | L2-Norm(final)=8.007 | 4791.6 samples/s | 74.9 steps/s
[Step=7050 Epoch=34.4] | Loss=0.05338 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.063 | L2-Norm(final)=8.005 | 4692.4 samples/s | 73.3 steps/s
[Step=7100 Epoch=34.6] | Loss=0.05180 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.109 | L2-Norm(final)=8.003 | 5731.2 samples/s | 89.6 steps/s
[Step=7150 Epoch=34.9] | Loss=0.04966 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.153 | L2-Norm(final)=8.001 | 2677.6 samples/s | 41.8 steps/s
[Step=7200 Epoch=35.1] | Loss=0.04730 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.193 | L2-Norm(final)=7.999 | 4751.9 samples/s | 74.2 steps/s
[Step=7250 Epoch=35.4] | Loss=0.04619 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.230 | L2-Norm(final)=7.997 | 4789.1 samples/s | 74.8 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04455 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.266 | L2-Norm(final)=7.996 | 5281.6 samples/s | 82.5 steps/s
[Step=7350 Epoch=35.8] | Loss=0.04301 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.302 | L2-Norm(final)=7.996 | 2791.3 samples/s | 43.6 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04177 | Reg=0.00235 | acc=0.9531 | L2-Norm=15.336 | L2-Norm(final)=7.996 | 4694.4 samples/s | 73.3 steps/s
[Step=7450 Epoch=36.3] | Loss=0.04076 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.369 | L2-Norm(final)=7.995 | 4773.4 samples/s | 74.6 steps/s
[Step=7500 Epoch=36.6] | Loss=0.03981 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.402 | L2-Norm(final)=7.994 | 4902.1 samples/s | 76.6 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03860 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.435 | L2-Norm(final)=7.993 | 2893.5 samples/s | 45.2 steps/s
[Step=7600 Epoch=37.1] | Loss=0.03762 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.466 | L2-Norm(final)=7.993 | 4790.8 samples/s | 74.9 steps/s
[Step=7650 Epoch=37.3] | Loss=0.03661 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.496 | L2-Norm(final)=7.992 | 4837.3 samples/s | 75.6 steps/s
[Step=7700 Epoch=37.5] | Loss=0.03562 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.524 | L2-Norm(final)=7.992 | 4634.4 samples/s | 72.4 steps/s
[Step=7750 Epoch=37.8] | Loss=0.03491 | Reg=0.00242 | acc=0.9531 | L2-Norm=15.550 | L2-Norm(final)=7.992 | 2884.0 samples/s | 45.1 steps/s
[Step=7800 Epoch=38.0] | Loss=0.03424 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.576 | L2-Norm(final)=7.991 | 4732.0 samples/s | 73.9 steps/s
[Step=7850 Epoch=38.3] | Loss=0.03396 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.603 | L2-Norm(final)=7.991 | 4788.4 samples/s | 74.8 steps/s
[Step=7900 Epoch=38.5] | Loss=0.03348 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.630 | L2-Norm(final)=7.989 | 4751.5 samples/s | 74.2 steps/s
[Step=7950 Epoch=38.8] | Loss=0.03289 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.656 | L2-Norm(final)=7.988 | 2950.5 samples/s | 46.1 steps/s
[Step=8000 Epoch=39.0] | Loss=0.03224 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.682 | L2-Norm(final)=7.987 | 4737.9 samples/s | 74.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step8000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=19.6] | Loss=0.11041 | Reg=0.00194 | acc=0.9219 | L2-Norm=13.939 | L2-Norm(final)=6.273 | 6719.9 samples/s | 105.0 steps/s
[Step=4050 Epoch=19.9] | Loss=0.16987 | Reg=0.00195 | acc=0.9375 | L2-Norm=13.951 | L2-Norm(final)=6.180 | 5237.8 samples/s | 81.8 steps/s
[Step=4100 Epoch=20.1] | Loss=0.16129 | Reg=0.00195 | acc=0.9062 | L2-Norm=13.953 | L2-Norm(final)=6.180 | 5518.0 samples/s | 86.2 steps/s
[Step=4150 Epoch=20.4] | Loss=0.15761 | Reg=0.00195 | acc=0.7812 | L2-Norm=13.954 | L2-Norm(final)=6.259 | 5643.9 samples/s | 88.2 steps/s
[Step=4200 Epoch=20.6] | Loss=0.15376 | Reg=0.00195 | acc=0.8750 | L2-Norm=13.954 | L2-Norm(final)=6.357 | 8582.9 samples/s | 134.1 steps/s
[Step=4250 Epoch=20.8] | Loss=0.15238 | Reg=0.00195 | acc=0.9219 | L2-Norm=13.954 | L2-Norm(final)=6.455 | 2663.2 samples/s | 41.6 steps/s
[Step=4300 Epoch=21.1] | Loss=0.15051 | Reg=0.00195 | acc=0.8125 | L2-Norm=13.955 | L2-Norm(final)=6.559 | 5448.7 samples/s | 85.1 steps/s
[Step=4350 Epoch=21.3] | Loss=0.14965 | Reg=0.00195 | acc=0.8438 | L2-Norm=13.955 | L2-Norm(final)=6.659 | 5639.3 samples/s | 88.1 steps/s
[Step=4400 Epoch=21.6] | Loss=0.14828 | Reg=0.00195 | acc=0.9062 | L2-Norm=13.955 | L2-Norm(final)=6.757 | 8091.3 samples/s | 126.4 steps/s
[Step=4450 Epoch=21.8] | Loss=0.14719 | Reg=0.00195 | acc=0.8750 | L2-Norm=13.955 | L2-Norm(final)=6.855 | 2707.5 samples/s | 42.3 steps/s
[Step=4500 Epoch=22.1] | Loss=0.14613 | Reg=0.00195 | acc=0.8750 | L2-Norm=13.955 | L2-Norm(final)=6.949 | 5533.5 samples/s | 86.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=22.1] | Loss=0.19739 | Reg=0.00195 | acc=0.8281 | L2-Norm=13.955 | L2-Norm(final)=7.862 | 6966.4 samples/s | 108.8 steps/s
[Step=4550 Epoch=22.3] | Loss=0.09952 | Reg=0.00202 | acc=0.9531 | L2-Norm=14.222 | L2-Norm(final)=7.878 | 4428.0 samples/s | 69.2 steps/s
[Step=4600 Epoch=22.6] | Loss=0.09679 | Reg=0.00208 | acc=0.9219 | L2-Norm=14.413 | L2-Norm(final)=7.853 | 4706.4 samples/s | 73.5 steps/s
[Step=4650 Epoch=22.8] | Loss=0.08892 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.561 | L2-Norm(final)=7.841 | 4807.0 samples/s | 75.1 steps/s
[Step=4700 Epoch=23.0] | Loss=0.08200 | Reg=0.00215 | acc=0.9219 | L2-Norm=14.676 | L2-Norm(final)=7.832 | 7012.4 samples/s | 109.6 steps/s
[Step=4750 Epoch=23.3] | Loss=0.07510 | Reg=0.00218 | acc=0.9531 | L2-Norm=14.769 | L2-Norm(final)=7.827 | 2472.1 samples/s | 38.6 steps/s
[Step=4800 Epoch=23.5] | Loss=0.07127 | Reg=0.00221 | acc=0.9219 | L2-Norm=14.851 | L2-Norm(final)=7.822 | 4670.4 samples/s | 73.0 steps/s
[Step=4850 Epoch=23.8] | Loss=0.06695 | Reg=0.00223 | acc=0.9219 | L2-Norm=14.924 | L2-Norm(final)=7.818 | 4735.3 samples/s | 74.0 steps/s
[Step=4900 Epoch=24.0] | Loss=0.06378 | Reg=0.00225 | acc=0.9688 | L2-Norm=14.989 | L2-Norm(final)=7.815 | 6601.8 samples/s | 103.2 steps/s
[Step=4950 Epoch=24.3] | Loss=0.06007 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.050 | L2-Norm(final)=7.812 | 2506.8 samples/s | 39.2 steps/s
[Step=5000 Epoch=24.5] | Loss=0.05667 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.104 | L2-Norm(final)=7.811 | 4766.0 samples/s | 74.5 steps/s
[Step=5050 Epoch=24.8] | Loss=0.05388 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.153 | L2-Norm(final)=7.810 | 4730.7 samples/s | 73.9 steps/s
[Step=5100 Epoch=25.0] | Loss=0.05112 | Reg=0.00231 | acc=0.9688 | L2-Norm=15.198 | L2-Norm(final)=7.810 | 6216.0 samples/s | 97.1 steps/s
[Step=5150 Epoch=25.3] | Loss=0.04894 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.242 | L2-Norm(final)=7.811 | 2551.6 samples/s | 39.9 steps/s
[Step=5200 Epoch=25.5] | Loss=0.04729 | Reg=0.00234 | acc=0.9531 | L2-Norm=15.286 | L2-Norm(final)=7.811 | 4804.0 samples/s | 75.1 steps/s
[Step=5250 Epoch=25.7] | Loss=0.04613 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.329 | L2-Norm(final)=7.810 | 4766.1 samples/s | 74.5 steps/s
[Step=5300 Epoch=26.0] | Loss=0.04470 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.370 | L2-Norm(final)=7.809 | 5826.6 samples/s | 91.0 steps/s
[Step=5350 Epoch=26.2] | Loss=0.04317 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.409 | L2-Norm(final)=7.808 | 2621.2 samples/s | 41.0 steps/s
[Step=5400 Epoch=26.5] | Loss=0.04201 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.447 | L2-Norm(final)=7.808 | 4773.1 samples/s | 74.6 steps/s
[Step=5450 Epoch=26.7] | Loss=0.04093 | Reg=0.00240 | acc=0.9531 | L2-Norm=15.484 | L2-Norm(final)=7.808 | 4749.7 samples/s | 74.2 steps/s
[Step=5500 Epoch=27.0] | Loss=0.03981 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.518 | L2-Norm(final)=7.808 | 5491.5 samples/s | 85.8 steps/s
[Step=5550 Epoch=27.2] | Loss=0.03874 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.551 | L2-Norm(final)=7.807 | 2762.0 samples/s | 43.2 steps/s
[Step=5600 Epoch=27.5] | Loss=0.03748 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.581 | L2-Norm(final)=7.807 | 4651.8 samples/s | 72.7 steps/s
[Step=5650 Epoch=27.7] | Loss=0.03647 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.610 | L2-Norm(final)=7.808 | 4774.3 samples/s | 74.6 steps/s
[Step=5700 Epoch=28.0] | Loss=0.03598 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.638 | L2-Norm(final)=7.807 | 5229.9 samples/s | 81.7 steps/s
[Step=5750 Epoch=28.2] | Loss=0.03523 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.666 | L2-Norm(final)=7.807 | 2827.0 samples/s | 44.2 steps/s
[Step=5800 Epoch=28.4] | Loss=0.03435 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.693 | L2-Norm(final)=7.807 | 4666.2 samples/s | 72.9 steps/s
[Step=5850 Epoch=28.7] | Loss=0.03352 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.720 | L2-Norm(final)=7.807 | 4830.7 samples/s | 75.5 steps/s
[Step=5900 Epoch=28.9] | Loss=0.03299 | Reg=0.00248 | acc=0.9688 | L2-Norm=15.746 | L2-Norm(final)=7.807 | 4916.9 samples/s | 76.8 steps/s
[Step=5950 Epoch=29.2] | Loss=0.03250 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.772 | L2-Norm(final)=7.806 | 2895.3 samples/s | 45.2 steps/s
[Step=6000 Epoch=29.4] | Loss=0.03187 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.798 | L2-Norm(final)=7.806 | 4629.8 samples/s | 72.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step6000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=37.9] | Loss=0.03534 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.939 | L2-Norm(final)=7.639 | 7324.3 samples/s | 114.4 steps/s
[Step=4050 Epoch=38.4] | Loss=0.04384 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.929 | L2-Norm(final)=7.677 | 4314.6 samples/s | 67.4 steps/s
[Step=4100 Epoch=38.9] | Loss=0.03466 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.928 | L2-Norm(final)=7.764 | 8227.7 samples/s | 128.6 steps/s
[Step=4150 Epoch=39.3] | Loss=0.03014 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.927 | L2-Norm(final)=7.882 | 2584.9 samples/s | 40.4 steps/s
[Step=4200 Epoch=39.8] | Loss=0.02827 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.927 | L2-Norm(final)=8.008 | 7298.6 samples/s | 114.0 steps/s
[Step=4250 Epoch=40.3] | Loss=0.02656 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.927 | L2-Norm(final)=8.139 | 2677.5 samples/s | 41.8 steps/s
[Step=4300 Epoch=40.7] | Loss=0.02547 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.927 | L2-Norm(final)=8.266 | 6523.0 samples/s | 101.9 steps/s
[Step=4350 Epoch=41.2] | Loss=0.02436 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.927 | L2-Norm(final)=8.389 | 2799.7 samples/s | 43.7 steps/s
[Step=4400 Epoch=41.7] | Loss=0.02352 | Reg=0.00194 | acc=0.9531 | L2-Norm=13.927 | L2-Norm(final)=8.507 | 5913.4 samples/s | 92.4 steps/s
[Step=4450 Epoch=42.2] | Loss=0.02289 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.927 | L2-Norm(final)=8.622 | 2931.4 samples/s | 45.8 steps/s
[Step=4500 Epoch=42.6] | Loss=0.02228 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.927 | L2-Norm(final)=8.733 | 5424.6 samples/s | 84.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.7] | Loss=0.00685 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.926 | L2-Norm(final)=9.817 | 7154.2 samples/s | 111.8 steps/s
[Step=4550 Epoch=43.1] | Loss=0.03072 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.243 | L2-Norm(final)=9.818 | 3976.5 samples/s | 62.1 steps/s
[Step=4600 Epoch=43.6] | Loss=0.02068 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.504 | L2-Norm(final)=9.775 | 6661.3 samples/s | 104.1 steps/s
[Step=4650 Epoch=44.1] | Loss=0.01523 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.592 | L2-Norm(final)=9.761 | 2382.8 samples/s | 37.2 steps/s
[Step=4700 Epoch=44.5] | Loss=0.01150 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.622 | L2-Norm(final)=9.756 | 5981.3 samples/s | 93.5 steps/s
[Step=4750 Epoch=45.0] | Loss=0.00971 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.627 | L2-Norm(final)=9.754 | 2496.0 samples/s | 39.0 steps/s
[Step=4800 Epoch=45.5] | Loss=0.00816 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.621 | L2-Norm(final)=9.752 | 5419.6 samples/s | 84.7 steps/s
[Step=4850 Epoch=46.0] | Loss=0.00700 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.604 | L2-Norm(final)=9.752 | 2588.2 samples/s | 40.4 steps/s
[Step=4900 Epoch=46.4] | Loss=0.00612 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.581 | L2-Norm(final)=9.751 | 4990.4 samples/s | 78.0 steps/s
[Step=4950 Epoch=46.9] | Loss=0.00545 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.553 | L2-Norm(final)=9.751 | 2697.9 samples/s | 42.2 steps/s
[Step=5000 Epoch=47.4] | Loss=0.00490 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.522 | L2-Norm(final)=9.752 | 4644.7 samples/s | 72.6 steps/s
[Step=5050 Epoch=47.9] | Loss=0.00446 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.489 | L2-Norm(final)=9.752 | 2810.5 samples/s | 43.9 steps/s
[Step=5100 Epoch=48.3] | Loss=0.00409 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.455 | L2-Norm(final)=9.752 | 4576.3 samples/s | 71.5 steps/s
[Step=5150 Epoch=48.8] | Loss=0.00377 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.420 | L2-Norm(final)=9.752 | 2902.1 samples/s | 45.3 steps/s
[Step=5200 Epoch=49.3] | Loss=0.00350 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.384 | L2-Norm(final)=9.753 | 4432.6 samples/s | 69.3 steps/s
[Step=5250 Epoch=49.7] | Loss=0.00327 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.348 | L2-Norm(final)=9.753 | 2883.0 samples/s | 45.0 steps/s
[Step=5300 Epoch=50.2] | Loss=0.00307 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.311 | L2-Norm(final)=9.753 | 4526.7 samples/s | 70.7 steps/s
[Step=5350 Epoch=50.7] | Loss=0.00289 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.275 | L2-Norm(final)=9.753 | 2958.0 samples/s | 46.2 steps/s
[Step=5400 Epoch=51.2] | Loss=0.00273 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.238 | L2-Norm(final)=9.754 | 4359.7 samples/s | 68.1 steps/s
[Step=5450 Epoch=51.6] | Loss=0.00258 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.201 | L2-Norm(final)=9.754 | 6679.8 samples/s | 104.4 steps/s
[Step=5500 Epoch=52.1] | Loss=0.00246 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.165 | L2-Norm(final)=9.754 | 2365.9 samples/s | 37.0 steps/s
[Step=5550 Epoch=52.6] | Loss=0.00234 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.128 | L2-Norm(final)=9.755 | 6126.0 samples/s | 95.7 steps/s
[Step=5600 Epoch=53.1] | Loss=0.00223 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.091 | L2-Norm(final)=9.755 | 2454.9 samples/s | 38.4 steps/s
[Step=5650 Epoch=53.5] | Loss=0.00214 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.055 | L2-Norm(final)=9.755 | 5525.2 samples/s | 86.3 steps/s
[Step=5700 Epoch=54.0] | Loss=0.00205 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.018 | L2-Norm(final)=9.756 | 2553.8 samples/s | 39.9 steps/s
[Step=5750 Epoch=54.5] | Loss=0.00197 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.982 | L2-Norm(final)=9.756 | 5175.7 samples/s | 80.9 steps/s
[Step=5800 Epoch=55.0] | Loss=0.00189 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.945 | L2-Norm(final)=9.756 | 2658.1 samples/s | 41.5 steps/s
[Step=5850 Epoch=55.4] | Loss=0.00182 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.909 | L2-Norm(final)=9.757 | 4760.6 samples/s | 74.4 steps/s
[Step=5900 Epoch=55.9] | Loss=0.00175 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.873 | L2-Norm(final)=9.757 | 2816.5 samples/s | 44.0 steps/s
[Step=5950 Epoch=56.4] | Loss=0.00169 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.837 | L2-Norm(final)=9.757 | 4541.1 samples/s | 71.0 steps/s
[Step=6000 Epoch=56.9] | Loss=0.00164 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.801 | L2-Norm(final)=9.758 | 2844.9 samples/s | 44.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step6000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.06437 | Reg=0.00194 | acc=0.9531 | L2-Norm=13.939 | L2-Norm(final)=7.512 | 7500.4 samples/s | 117.2 steps/s
[Step=4050 Epoch=38.5] | Loss=0.04378 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.926 | L2-Norm(final)=7.574 | 4335.3 samples/s | 67.7 steps/s
[Step=4100 Epoch=39.0] | Loss=0.03889 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.924 | L2-Norm(final)=7.680 | 8389.0 samples/s | 131.1 steps/s
[Step=4150 Epoch=39.5] | Loss=0.03464 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.924 | L2-Norm(final)=7.811 | 2559.0 samples/s | 40.0 steps/s
[Step=4200 Epoch=40.0] | Loss=0.03430 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.924 | L2-Norm(final)=7.939 | 7399.6 samples/s | 115.6 steps/s
[Step=4250 Epoch=40.4] | Loss=0.03252 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.923 | L2-Norm(final)=8.057 | 2690.5 samples/s | 42.0 steps/s
[Step=4300 Epoch=40.9] | Loss=0.03182 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.923 | L2-Norm(final)=8.175 | 6542.5 samples/s | 102.2 steps/s
[Step=4350 Epoch=41.4] | Loss=0.03152 | Reg=0.00194 | acc=0.9531 | L2-Norm=13.923 | L2-Norm(final)=8.284 | 2800.6 samples/s | 43.8 steps/s
[Step=4400 Epoch=41.9] | Loss=0.03076 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.923 | L2-Norm(final)=8.388 | 5893.5 samples/s | 92.1 steps/s
[Step=4450 Epoch=42.3] | Loss=0.03016 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.923 | L2-Norm(final)=8.486 | 2914.0 samples/s | 45.5 steps/s
[Step=4500 Epoch=42.8] | Loss=0.02963 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.923 | L2-Norm(final)=8.581 | 5390.7 samples/s | 84.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.8] | Loss=0.05391 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.923 | L2-Norm(final)=9.514 | 7095.6 samples/s | 110.9 steps/s
[Step=4550 Epoch=43.3] | Loss=0.04493 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.535 | L2-Norm(final)=9.495 | 4146.7 samples/s | 64.8 steps/s
[Step=4600 Epoch=43.8] | Loss=0.03069 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.081 | L2-Norm(final)=9.426 | 6637.1 samples/s | 103.7 steps/s
[Step=4650 Epoch=44.2] | Loss=0.02067 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.272 | L2-Norm(final)=9.414 | 2395.3 samples/s | 37.4 steps/s
[Step=4700 Epoch=44.7] | Loss=0.01558 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.336 | L2-Norm(final)=9.413 | 5956.7 samples/s | 93.1 steps/s
[Step=4750 Epoch=45.2] | Loss=0.01248 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.349 | L2-Norm(final)=9.415 | 2496.6 samples/s | 39.0 steps/s
[Step=4800 Epoch=45.7] | Loss=0.01040 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.338 | L2-Norm(final)=9.417 | 5361.6 samples/s | 83.8 steps/s
[Step=4850 Epoch=46.1] | Loss=0.00892 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.314 | L2-Norm(final)=9.418 | 2580.9 samples/s | 40.3 steps/s
[Step=4900 Epoch=46.6] | Loss=0.00781 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.281 | L2-Norm(final)=9.420 | 5058.5 samples/s | 79.0 steps/s
[Step=4950 Epoch=47.1] | Loss=0.00694 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.244 | L2-Norm(final)=9.421 | 2717.0 samples/s | 42.5 steps/s
[Step=5000 Epoch=47.6] | Loss=0.00625 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.204 | L2-Norm(final)=9.423 | 4601.2 samples/s | 71.9 steps/s
[Step=5050 Epoch=48.0] | Loss=0.00568 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.162 | L2-Norm(final)=9.424 | 2829.1 samples/s | 44.2 steps/s
[Step=5100 Epoch=48.5] | Loss=0.00521 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.119 | L2-Norm(final)=9.425 | 4533.9 samples/s | 70.8 steps/s
[Step=5150 Epoch=49.0] | Loss=0.00481 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.076 | L2-Norm(final)=9.426 | 2849.8 samples/s | 44.5 steps/s
[Step=5200 Epoch=49.5] | Loss=0.00447 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.032 | L2-Norm(final)=9.427 | 4547.1 samples/s | 71.0 steps/s
[Step=5250 Epoch=49.9] | Loss=0.00417 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.988 | L2-Norm(final)=9.428 | 2889.5 samples/s | 45.1 steps/s
[Step=5300 Epoch=50.4] | Loss=0.00391 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.943 | L2-Norm(final)=9.429 | 4459.8 samples/s | 69.7 steps/s
[Step=5350 Epoch=50.9] | Loss=0.00368 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.899 | L2-Norm(final)=9.430 | 2921.7 samples/s | 45.7 steps/s
[Step=5400 Epoch=51.4] | Loss=0.00347 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.856 | L2-Norm(final)=9.430 | 4321.0 samples/s | 67.5 steps/s
[Step=5450 Epoch=51.8] | Loss=0.00329 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.812 | L2-Norm(final)=9.431 | 6843.9 samples/s | 106.9 steps/s
[Step=5500 Epoch=52.3] | Loss=0.00313 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.769 | L2-Norm(final)=9.432 | 2356.4 samples/s | 36.8 steps/s
[Step=5550 Epoch=52.8] | Loss=0.00298 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.726 | L2-Norm(final)=9.433 | 6198.2 samples/s | 96.8 steps/s
[Step=5600 Epoch=53.3] | Loss=0.00284 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.683 | L2-Norm(final)=9.433 | 2476.8 samples/s | 38.7 steps/s
[Step=5650 Epoch=53.7] | Loss=0.00272 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.640 | L2-Norm(final)=9.434 | 5561.0 samples/s | 86.9 steps/s
[Step=5700 Epoch=54.2] | Loss=0.00261 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.598 | L2-Norm(final)=9.435 | 2399.3 samples/s | 37.5 steps/s
[Step=5750 Epoch=54.7] | Loss=0.00250 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.557 | L2-Norm(final)=9.435 | 5173.2 samples/s | 80.8 steps/s
[Step=5800 Epoch=55.2] | Loss=0.00241 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.515 | L2-Norm(final)=9.436 | 2649.0 samples/s | 41.4 steps/s
[Step=5850 Epoch=55.6] | Loss=0.00232 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.474 | L2-Norm(final)=9.437 | 4763.8 samples/s | 74.4 steps/s
[Step=5900 Epoch=56.1] | Loss=0.00223 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.433 | L2-Norm(final)=9.437 | 2765.9 samples/s | 43.2 steps/s
[Step=5950 Epoch=56.6] | Loss=0.00216 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.392 | L2-Norm(final)=9.438 | 4621.2 samples/s | 72.2 steps/s
[Step=6000 Epoch=57.1] | Loss=0.00209 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.352 | L2-Norm(final)=9.438 | 2838.7 samples/s | 44.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.14686 | acc=0.9323 | tpr=0.9509 | fpr=0.1083 | 6236.8 samples/s | 24.4 steps/s
Avg test loss: 0.15329, Avg test acc: 0.92788, Avg tpr: 0.94830, Avg fpr: 0.11704, total FA: 913

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.13090 | acc=0.9357 | tpr=0.9605 | fpr=0.1182 | 5740.4 samples/s | 22.4 steps/s
Avg test loss: 0.13077, Avg test acc: 0.93569, Avg tpr: 0.96042, Avg fpr: 0.11870, total FA: 926

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.15329 | acc=0.9373 | tpr=0.9524 | fpr=0.0956 | 6040.7 samples/s | 23.6 steps/s
Avg test loss: 0.15689, Avg test acc: 0.93529, Avg tpr: 0.95005, Avg fpr: 0.09717, total FA: 758

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.13526 | acc=0.9387 | tpr=0.9553 | fpr=0.0974 | 5921.4 samples/s | 23.1 steps/s
Avg test loss: 0.14670, Avg test acc: 0.93549, Avg tpr: 0.95337, Avg fpr: 0.10383, total FA: 810

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.16533 | acc=0.9337 | tpr=0.9694 | fpr=0.1437 | 6004.5 samples/s | 23.5 steps/s
Avg test loss: 0.16588, Avg test acc: 0.93369, Avg tpr: 0.96841, Avg fpr: 0.14267, total FA: 1113

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.23808 | acc=0.3217 | tpr=0.0172 | fpr=0.0171 | 6135.3 samples/s | 24.0 steps/s
Avg test loss: 5.25069, Avg test acc: 0.31954, Avg tpr: 0.01737, Avg fpr: 0.01590, total FA: 124

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.21096 | acc=0.3184 | tpr=0.0104 | fpr=0.0129 | 5898.5 samples/s | 23.0 steps/s
Avg test loss: 5.22606, Avg test acc: 0.31541, Avg tpr: 0.00985, Avg fpr: 0.01256, total FA: 98

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.20931 | acc=0.3243 | tpr=0.0423 | fpr=0.0634 | 5988.0 samples/s | 23.4 steps/s
Avg test loss: 4.22080, Avg test acc: 0.32250, Avg tpr: 0.04127, Avg fpr: 0.05897, total FA: 460

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.39632 | acc=0.3205 | tpr=0.0366 | fpr=0.0629 | 6078.1 samples/s | 23.7 steps/s
Avg test loss: 4.40138, Avg test acc: 0.31825, Avg tpr: 0.03550, Avg fpr: 0.05986, total FA: 467

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=6.04448 | acc=0.3141 | tpr=0.0086 | fpr=0.0225 | 5952.7 samples/s | 23.3 steps/s
Avg test loss: 6.06691, Avg test acc: 0.31261, Avg tpr: 0.00898, Avg fpr: 0.01961, total FA: 153

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.87278 | acc=0.1291 | tpr=0.8230 | fpr=0.8833 | 5939.7 samples/s | 23.2 steps/s
[Step= 100] | Loss=4.86516 | acc=0.1263 | tpr=0.7932 | fpr=0.8862 | 8351.1 samples/s | 32.6 steps/s
[Step= 150] | Loss=4.85252 | acc=0.1273 | tpr=0.7954 | fpr=0.8850 | 6932.4 samples/s | 27.1 steps/s
[Step= 200] | Loss=4.86125 | acc=0.1268 | tpr=0.7869 | fpr=0.8852 | 8239.4 samples/s | 32.2 steps/s
[Step= 250] | Loss=4.87290 | acc=0.1270 | tpr=0.7886 | fpr=0.8850 | 8765.6 samples/s | 34.2 steps/s
[Step= 300] | Loss=4.86946 | acc=0.1274 | tpr=0.7956 | fpr=0.8848 | 8114.2 samples/s | 31.7 steps/s
[Step= 350] | Loss=4.87167 | acc=0.1274 | tpr=0.7921 | fpr=0.8847 | 8112.4 samples/s | 31.7 steps/s
[Step= 400] | Loss=4.86841 | acc=0.1278 | tpr=0.7888 | fpr=0.8842 | 7682.9 samples/s | 30.0 steps/s
[Step= 450] | Loss=4.87358 | acc=0.1274 | tpr=0.7882 | fpr=0.8846 | 8511.6 samples/s | 33.2 steps/s
[Step= 500] | Loss=4.87414 | acc=0.1273 | tpr=0.7912 | fpr=0.8847 | 8257.5 samples/s | 32.3 steps/s
[Step= 550] | Loss=4.87599 | acc=0.1272 | tpr=0.7931 | fpr=0.8849 | 9688.0 samples/s | 37.8 steps/s
Avg test loss: 4.87693, Avg test acc: 0.12720, Avg tpr: 0.79358, Avg fpr: 0.88492, total FA: 122869

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.05186 | acc=0.1220 | tpr=0.7920 | fpr=0.8901 | 5883.0 samples/s | 23.0 steps/s
[Step= 100] | Loss=6.02769 | acc=0.1211 | tpr=0.7846 | fpr=0.8913 | 7431.0 samples/s | 29.0 steps/s
[Step= 150] | Loss=6.03050 | acc=0.1213 | tpr=0.7896 | fpr=0.8910 | 8001.0 samples/s | 31.3 steps/s
[Step= 200] | Loss=6.02958 | acc=0.1210 | tpr=0.7858 | fpr=0.8911 | 8209.2 samples/s | 32.1 steps/s
[Step= 250] | Loss=6.02991 | acc=0.1213 | tpr=0.7895 | fpr=0.8909 | 8218.9 samples/s | 32.1 steps/s
[Step= 300] | Loss=6.02814 | acc=0.1214 | tpr=0.7898 | fpr=0.8908 | 7566.9 samples/s | 29.6 steps/s
[Step= 350] | Loss=6.03199 | acc=0.1209 | tpr=0.7940 | fpr=0.8913 | 8487.2 samples/s | 33.2 steps/s
[Step= 400] | Loss=6.03452 | acc=0.1216 | tpr=0.7954 | fpr=0.8907 | 7072.4 samples/s | 27.6 steps/s
[Step= 450] | Loss=6.04000 | acc=0.1210 | tpr=0.7936 | fpr=0.8912 | 7987.4 samples/s | 31.2 steps/s
[Step= 500] | Loss=6.03925 | acc=0.1210 | tpr=0.7956 | fpr=0.8912 | 8573.8 samples/s | 33.5 steps/s
[Step= 550] | Loss=6.04222 | acc=0.1211 | tpr=0.7959 | fpr=0.8912 | 12481.7 samples/s | 48.8 steps/s
Avg test loss: 6.04366, Avg test acc: 0.12104, Avg tpr: 0.79556, Avg fpr: 0.89123, total FA: 123745

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.79943 | acc=0.1257 | tpr=0.8584 | fpr=0.8875 | 5886.5 samples/s | 23.0 steps/s
[Step= 100] | Loss=5.78174 | acc=0.1249 | tpr=0.8337 | fpr=0.8883 | 8332.1 samples/s | 32.5 steps/s
[Step= 150] | Loss=5.79062 | acc=0.1260 | tpr=0.8314 | fpr=0.8870 | 8096.9 samples/s | 31.6 steps/s
[Step= 200] | Loss=5.78785 | acc=0.1259 | tpr=0.8240 | fpr=0.8868 | 8098.5 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.79872 | acc=0.1258 | tpr=0.8236 | fpr=0.8869 | 8059.8 samples/s | 31.5 steps/s
[Step= 300] | Loss=5.79958 | acc=0.1261 | tpr=0.8291 | fpr=0.8868 | 7586.6 samples/s | 29.6 steps/s
[Step= 350] | Loss=5.79932 | acc=0.1265 | tpr=0.8353 | fpr=0.8864 | 8226.2 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.79914 | acc=0.1266 | tpr=0.8337 | fpr=0.8863 | 8187.5 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.80064 | acc=0.1263 | tpr=0.8320 | fpr=0.8865 | 8044.8 samples/s | 31.4 steps/s
[Step= 500] | Loss=5.80127 | acc=0.1265 | tpr=0.8352 | fpr=0.8863 | 8088.8 samples/s | 31.6 steps/s
[Step= 550] | Loss=5.80463 | acc=0.1268 | tpr=0.8353 | fpr=0.8860 | 9508.7 samples/s | 37.1 steps/s
Avg test loss: 5.80440, Avg test acc: 0.12679, Avg tpr: 0.83518, Avg fpr: 0.88609, total FA: 123032

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.38066 | acc=0.1390 | tpr=0.8009 | fpr=0.8729 | 5731.2 samples/s | 22.4 steps/s
[Step= 100] | Loss=5.34188 | acc=0.1410 | tpr=0.7740 | fpr=0.8708 | 8720.9 samples/s | 34.1 steps/s
[Step= 150] | Loss=5.33590 | acc=0.1418 | tpr=0.7781 | fpr=0.8699 | 7879.1 samples/s | 30.8 steps/s
[Step= 200] | Loss=5.33532 | acc=0.1419 | tpr=0.7738 | fpr=0.8696 | 7620.0 samples/s | 29.8 steps/s
[Step= 250] | Loss=5.34303 | acc=0.1410 | tpr=0.7782 | fpr=0.8706 | 7958.3 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.33645 | acc=0.1415 | tpr=0.7840 | fpr=0.8702 | 8094.6 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.34096 | acc=0.1407 | tpr=0.7858 | fpr=0.8710 | 7758.7 samples/s | 30.3 steps/s
[Step= 400] | Loss=5.33958 | acc=0.1409 | tpr=0.7856 | fpr=0.8709 | 8416.3 samples/s | 32.9 steps/s
[Step= 450] | Loss=5.33964 | acc=0.1405 | tpr=0.7872 | fpr=0.8713 | 7790.6 samples/s | 30.4 steps/s
[Step= 500] | Loss=5.33653 | acc=0.1405 | tpr=0.7912 | fpr=0.8712 | 8200.8 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.34064 | acc=0.1405 | tpr=0.7919 | fpr=0.8713 | 10553.4 samples/s | 41.2 steps/s
Avg test loss: 5.34119, Avg test acc: 0.14046, Avg tpr: 0.79200, Avg fpr: 0.87138, total FA: 120990

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.62728 | acc=0.1205 | tpr=0.8142 | fpr=0.8920 | 6187.1 samples/s | 24.2 steps/s
[Step= 100] | Loss=6.60719 | acc=0.1225 | tpr=0.8273 | fpr=0.8906 | 7844.5 samples/s | 30.6 steps/s
[Step= 150] | Loss=6.62366 | acc=0.1226 | tpr=0.8444 | fpr=0.8907 | 7756.4 samples/s | 30.3 steps/s
[Step= 200] | Loss=6.62398 | acc=0.1229 | tpr=0.8426 | fpr=0.8901 | 8038.1 samples/s | 31.4 steps/s
[Step= 250] | Loss=6.63576 | acc=0.1230 | tpr=0.8463 | fpr=0.8902 | 7928.0 samples/s | 31.0 steps/s
[Step= 300] | Loss=6.63251 | acc=0.1227 | tpr=0.8473 | fpr=0.8905 | 7715.9 samples/s | 30.1 steps/s
[Step= 350] | Loss=6.63786 | acc=0.1224 | tpr=0.8522 | fpr=0.8908 | 8031.3 samples/s | 31.4 steps/s
[Step= 400] | Loss=6.63630 | acc=0.1221 | tpr=0.8485 | fpr=0.8911 | 8092.5 samples/s | 31.6 steps/s
[Step= 450] | Loss=6.64305 | acc=0.1215 | tpr=0.8496 | fpr=0.8917 | 8008.0 samples/s | 31.3 steps/s
[Step= 500] | Loss=6.64366 | acc=0.1211 | tpr=0.8485 | fpr=0.8921 | 7465.3 samples/s | 29.2 steps/s
[Step= 550] | Loss=6.64252 | acc=0.1215 | tpr=0.8488 | fpr=0.8917 | 12200.0 samples/s | 47.7 steps/s
Avg test loss: 6.64385, Avg test acc: 0.12144, Avg tpr: 0.84905, Avg fpr: 0.89179, total FA: 123823

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.15507 | acc=0.9580 | tpr=0.8938 | fpr=0.0408 | 6159.5 samples/s | 24.1 steps/s
[Step= 100] | Loss=0.15983 | acc=0.9569 | tpr=0.8998 | fpr=0.0421 | 7874.0 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.15998 | acc=0.9560 | tpr=0.9020 | fpr=0.0430 | 7793.2 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.15988 | acc=0.9555 | tpr=0.9060 | fpr=0.0436 | 7519.7 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.15978 | acc=0.9558 | tpr=0.9048 | fpr=0.0433 | 8019.6 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.16242 | acc=0.9554 | tpr=0.9055 | fpr=0.0437 | 7925.8 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.16202 | acc=0.9557 | tpr=0.9036 | fpr=0.0434 | 8176.3 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.16252 | acc=0.9554 | tpr=0.9015 | fpr=0.0436 | 7340.5 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.16382 | acc=0.9551 | tpr=0.8978 | fpr=0.0438 | 8477.3 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.16420 | acc=0.9549 | tpr=0.8987 | fpr=0.0441 | 8205.0 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.16325 | acc=0.9552 | tpr=0.8993 | fpr=0.0438 | 11175.6 samples/s | 43.7 steps/s
Avg test loss: 0.16304, Avg test acc: 0.95522, Avg tpr: 0.89937, Avg fpr: 0.04377, total FA: 6077

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11033 | acc=0.9687 | tpr=0.8319 | fpr=0.0289 | 6084.6 samples/s | 23.8 steps/s
[Step= 100] | Loss=0.11265 | acc=0.9680 | tpr=0.8571 | fpr=0.0299 | 7968.7 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.11360 | acc=0.9683 | tpr=0.8646 | fpr=0.0298 | 8034.2 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.11358 | acc=0.9686 | tpr=0.8743 | fpr=0.0297 | 8421.9 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.11486 | acc=0.9685 | tpr=0.8716 | fpr=0.0297 | 7893.0 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.11606 | acc=0.9683 | tpr=0.8727 | fpr=0.0299 | 7791.7 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.11540 | acc=0.9686 | tpr=0.8723 | fpr=0.0296 | 8157.5 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.11630 | acc=0.9683 | tpr=0.8693 | fpr=0.0299 | 7384.4 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.11812 | acc=0.9679 | tpr=0.8685 | fpr=0.0303 | 8167.0 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.11748 | acc=0.9679 | tpr=0.8722 | fpr=0.0304 | 8136.6 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.11709 | acc=0.9680 | tpr=0.8679 | fpr=0.0302 | 10733.4 samples/s | 41.9 steps/s
Avg test loss: 0.11695, Avg test acc: 0.96800, Avg tpr: 0.86767, Avg fpr: 0.03018, total FA: 4190

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.22424 | acc=0.9466 | tpr=0.9381 | fpr=0.0532 | 5921.4 samples/s | 23.1 steps/s
[Step= 100] | Loss=0.23074 | acc=0.9462 | tpr=0.9318 | fpr=0.0536 | 8212.9 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.23536 | acc=0.9452 | tpr=0.9323 | fpr=0.0546 | 7577.5 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.23671 | acc=0.9455 | tpr=0.9366 | fpr=0.0543 | 8002.2 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.23777 | acc=0.9454 | tpr=0.9293 | fpr=0.0543 | 8011.0 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.24002 | acc=0.9446 | tpr=0.9244 | fpr=0.0550 | 7930.5 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.23866 | acc=0.9449 | tpr=0.9261 | fpr=0.0547 | 8215.0 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.23984 | acc=0.9445 | tpr=0.9240 | fpr=0.0551 | 8121.5 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.24044 | acc=0.9442 | tpr=0.9231 | fpr=0.0554 | 8252.2 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.24167 | acc=0.9439 | tpr=0.9238 | fpr=0.0557 | 7904.7 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.24048 | acc=0.9442 | tpr=0.9252 | fpr=0.0554 | 9864.3 samples/s | 38.5 steps/s
Avg test loss: 0.24028, Avg test acc: 0.94428, Avg tpr: 0.92512, Avg fpr: 0.05537, total FA: 7688

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14291 | acc=0.9597 | tpr=0.8540 | fpr=0.0384 | 6005.2 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.14990 | acc=0.9585 | tpr=0.8742 | fpr=0.0400 | 8114.2 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.15490 | acc=0.9576 | tpr=0.8862 | fpr=0.0411 | 8198.4 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.15433 | acc=0.9580 | tpr=0.8852 | fpr=0.0407 | 7702.2 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.15588 | acc=0.9580 | tpr=0.8838 | fpr=0.0406 | 8113.1 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.15715 | acc=0.9575 | tpr=0.8807 | fpr=0.0411 | 7576.1 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.15660 | acc=0.9576 | tpr=0.8848 | fpr=0.0410 | 8275.1 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.15664 | acc=0.9576 | tpr=0.8840 | fpr=0.0411 | 7549.5 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.15837 | acc=0.9571 | tpr=0.8812 | fpr=0.0415 | 8654.4 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.15857 | acc=0.9571 | tpr=0.8846 | fpr=0.0416 | 8694.1 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.15800 | acc=0.9572 | tpr=0.8858 | fpr=0.0415 | 9306.4 samples/s | 36.4 steps/s
Avg test loss: 0.15790, Avg test acc: 0.95723, Avg tpr: 0.88590, Avg fpr: 0.04147, total FA: 5758

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21249 | acc=0.9555 | tpr=0.8938 | fpr=0.0434 | 6115.7 samples/s | 23.9 steps/s
[Step= 100] | Loss=0.22081 | acc=0.9547 | tpr=0.9104 | fpr=0.0445 | 7934.7 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.22236 | acc=0.9538 | tpr=0.9222 | fpr=0.0456 | 7893.2 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.22323 | acc=0.9540 | tpr=0.9257 | fpr=0.0455 | 8137.3 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.22440 | acc=0.9536 | tpr=0.9205 | fpr=0.0458 | 7700.6 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.22727 | acc=0.9528 | tpr=0.9207 | fpr=0.0466 | 8721.9 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.22575 | acc=0.9531 | tpr=0.9205 | fpr=0.0463 | 7913.8 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.22546 | acc=0.9529 | tpr=0.9136 | fpr=0.0464 | 7695.2 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.22772 | acc=0.9525 | tpr=0.9114 | fpr=0.0468 | 7981.7 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.22895 | acc=0.9523 | tpr=0.9128 | fpr=0.0470 | 8435.5 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.22767 | acc=0.9525 | tpr=0.9121 | fpr=0.0467 | 9431.8 samples/s | 36.8 steps/s
Avg test loss: 0.22751, Avg test acc: 0.95256, Avg tpr: 0.91204, Avg fpr: 0.04670, total FA: 6484

server round 7/50

clients selected: [0 4 5 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=29.3] | Loss=0.19792 | Reg=0.00186 | acc=0.7969 | L2-Norm=13.632 | L2-Norm(final)=5.615 | 7069.3 samples/s | 110.5 steps/s
[Step=6050 Epoch=29.5] | Loss=0.18328 | Reg=0.00186 | acc=0.8906 | L2-Norm=13.634 | L2-Norm(final)=5.591 | 4888.8 samples/s | 76.4 steps/s
[Step=6100 Epoch=29.7] | Loss=0.17073 | Reg=0.00186 | acc=0.9375 | L2-Norm=13.635 | L2-Norm(final)=5.664 | 5610.1 samples/s | 87.7 steps/s
[Step=6150 Epoch=30.0] | Loss=0.16485 | Reg=0.00186 | acc=0.8594 | L2-Norm=13.635 | L2-Norm(final)=5.778 | 5558.9 samples/s | 86.9 steps/s
[Step=6200 Epoch=30.2] | Loss=0.15997 | Reg=0.00186 | acc=0.8750 | L2-Norm=13.635 | L2-Norm(final)=5.896 | 8681.0 samples/s | 135.6 steps/s
[Step=6250 Epoch=30.5] | Loss=0.15704 | Reg=0.00186 | acc=0.8750 | L2-Norm=13.635 | L2-Norm(final)=6.019 | 2693.9 samples/s | 42.1 steps/s
[Step=6300 Epoch=30.7] | Loss=0.15429 | Reg=0.00186 | acc=0.8438 | L2-Norm=13.635 | L2-Norm(final)=6.136 | 5487.1 samples/s | 85.7 steps/s
[Step=6350 Epoch=31.0] | Loss=0.15241 | Reg=0.00186 | acc=0.8594 | L2-Norm=13.635 | L2-Norm(final)=6.249 | 5489.2 samples/s | 85.8 steps/s
[Step=6400 Epoch=31.2] | Loss=0.14985 | Reg=0.00186 | acc=0.8750 | L2-Norm=13.635 | L2-Norm(final)=6.360 | 7680.7 samples/s | 120.0 steps/s
[Step=6450 Epoch=31.5] | Loss=0.14734 | Reg=0.00186 | acc=0.9531 | L2-Norm=13.635 | L2-Norm(final)=6.468 | 2783.8 samples/s | 43.5 steps/s
[Step=6500 Epoch=31.7] | Loss=0.14595 | Reg=0.00186 | acc=0.8906 | L2-Norm=13.635 | L2-Norm(final)=6.571 | 5634.2 samples/s | 88.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=31.7] | Loss=0.14062 | Reg=0.00186 | acc=0.9062 | L2-Norm=13.635 | L2-Norm(final)=7.593 | 7507.9 samples/s | 117.3 steps/s
[Step=6550 Epoch=31.9] | Loss=0.09990 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.860 | L2-Norm(final)=7.621 | 4163.1 samples/s | 65.0 steps/s
[Step=6600 Epoch=32.2] | Loss=0.09039 | Reg=0.00198 | acc=0.9531 | L2-Norm=14.064 | L2-Norm(final)=7.608 | 4769.7 samples/s | 74.5 steps/s
[Step=6650 Epoch=32.4] | Loss=0.08232 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.194 | L2-Norm(final)=7.601 | 4730.2 samples/s | 73.9 steps/s
[Step=6700 Epoch=32.7] | Loss=0.07719 | Reg=0.00204 | acc=0.9375 | L2-Norm=14.296 | L2-Norm(final)=7.598 | 6870.1 samples/s | 107.3 steps/s
[Step=6750 Epoch=32.9] | Loss=0.06983 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.384 | L2-Norm(final)=7.595 | 2512.2 samples/s | 39.3 steps/s
[Step=6800 Epoch=33.2] | Loss=0.06512 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.464 | L2-Norm(final)=7.594 | 4712.5 samples/s | 73.6 steps/s
[Step=6850 Epoch=33.4] | Loss=0.06168 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.536 | L2-Norm(final)=7.594 | 4805.5 samples/s | 75.1 steps/s
[Step=6900 Epoch=33.6] | Loss=0.05840 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.602 | L2-Norm(final)=7.593 | 6104.0 samples/s | 95.4 steps/s
[Step=6950 Epoch=33.9] | Loss=0.05484 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.663 | L2-Norm(final)=7.594 | 2569.7 samples/s | 40.2 steps/s
[Step=7000 Epoch=34.1] | Loss=0.05154 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.717 | L2-Norm(final)=7.595 | 4766.7 samples/s | 74.5 steps/s
[Step=7050 Epoch=34.4] | Loss=0.04906 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.765 | L2-Norm(final)=7.597 | 4770.9 samples/s | 74.5 steps/s
[Step=7100 Epoch=34.6] | Loss=0.04733 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.808 | L2-Norm(final)=7.598 | 5696.1 samples/s | 89.0 steps/s
[Step=7150 Epoch=34.9] | Loss=0.04546 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.851 | L2-Norm(final)=7.600 | 2536.1 samples/s | 39.6 steps/s
[Step=7200 Epoch=35.1] | Loss=0.04407 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.894 | L2-Norm(final)=7.601 | 4776.5 samples/s | 74.6 steps/s
[Step=7250 Epoch=35.4] | Loss=0.04305 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.934 | L2-Norm(final)=7.602 | 4763.5 samples/s | 74.4 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04212 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.973 | L2-Norm(final)=7.602 | 5270.1 samples/s | 82.3 steps/s
[Step=7350 Epoch=35.8] | Loss=0.04076 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.012 | L2-Norm(final)=7.603 | 2782.3 samples/s | 43.5 steps/s
[Step=7400 Epoch=36.1] | Loss=0.03931 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.048 | L2-Norm(final)=7.603 | 4828.4 samples/s | 75.4 steps/s
[Step=7450 Epoch=36.3] | Loss=0.03809 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.082 | L2-Norm(final)=7.604 | 4675.5 samples/s | 73.1 steps/s
[Step=7500 Epoch=36.6] | Loss=0.03759 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.113 | L2-Norm(final)=7.604 | 4884.3 samples/s | 76.3 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03645 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.145 | L2-Norm(final)=7.604 | 2894.8 samples/s | 45.2 steps/s
[Step=7600 Epoch=37.1] | Loss=0.03529 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.175 | L2-Norm(final)=7.605 | 4858.2 samples/s | 75.9 steps/s
[Step=7650 Epoch=37.3] | Loss=0.03431 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.202 | L2-Norm(final)=7.606 | 4665.6 samples/s | 72.9 steps/s
[Step=7700 Epoch=37.5] | Loss=0.03361 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.229 | L2-Norm(final)=7.607 | 4778.8 samples/s | 74.7 steps/s
[Step=7750 Epoch=37.8] | Loss=0.03313 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.254 | L2-Norm(final)=7.608 | 2970.4 samples/s | 46.4 steps/s
[Step=7800 Epoch=38.0] | Loss=0.03254 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.279 | L2-Norm(final)=7.609 | 4791.2 samples/s | 74.9 steps/s
[Step=7850 Epoch=38.3] | Loss=0.03210 | Reg=0.00235 | acc=0.9688 | L2-Norm=15.304 | L2-Norm(final)=7.609 | 4689.0 samples/s | 73.3 steps/s
[Step=7900 Epoch=38.5] | Loss=0.03159 | Reg=0.00235 | acc=0.9688 | L2-Norm=15.329 | L2-Norm(final)=7.609 | 4798.3 samples/s | 75.0 steps/s
[Step=7950 Epoch=38.8] | Loss=0.03097 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.354 | L2-Norm(final)=7.610 | 2922.2 samples/s | 45.7 steps/s
[Step=8000 Epoch=39.0] | Loss=0.03063 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.380 | L2-Norm(final)=7.610 | 4836.5 samples/s | 75.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step8000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=29.4] | Loss=0.11008 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.632 | L2-Norm(final)=7.797 | 6510.3 samples/s | 101.7 steps/s
[Step=6050 Epoch=29.7] | Loss=0.14036 | Reg=0.00186 | acc=0.8281 | L2-Norm=13.638 | L2-Norm(final)=7.959 | 5230.1 samples/s | 81.7 steps/s
[Step=6100 Epoch=29.9] | Loss=0.13524 | Reg=0.00186 | acc=0.9531 | L2-Norm=13.640 | L2-Norm(final)=8.138 | 5644.0 samples/s | 88.2 steps/s
[Step=6150 Epoch=30.2] | Loss=0.13258 | Reg=0.00186 | acc=0.9219 | L2-Norm=13.640 | L2-Norm(final)=8.290 | 5503.3 samples/s | 86.0 steps/s
[Step=6200 Epoch=30.4] | Loss=0.13240 | Reg=0.00186 | acc=0.9219 | L2-Norm=13.640 | L2-Norm(final)=8.428 | 8800.4 samples/s | 137.5 steps/s
[Step=6250 Epoch=30.6] | Loss=0.13156 | Reg=0.00186 | acc=0.8906 | L2-Norm=13.640 | L2-Norm(final)=8.555 | 2683.6 samples/s | 41.9 steps/s
[Step=6300 Epoch=30.9] | Loss=0.13001 | Reg=0.00186 | acc=0.9375 | L2-Norm=13.641 | L2-Norm(final)=8.675 | 5376.9 samples/s | 84.0 steps/s
[Step=6350 Epoch=31.1] | Loss=0.12939 | Reg=0.00186 | acc=0.8594 | L2-Norm=13.641 | L2-Norm(final)=8.790 | 5611.0 samples/s | 87.7 steps/s
[Step=6400 Epoch=31.4] | Loss=0.12907 | Reg=0.00186 | acc=0.9062 | L2-Norm=13.641 | L2-Norm(final)=8.899 | 7988.1 samples/s | 124.8 steps/s
[Step=6450 Epoch=31.6] | Loss=0.12836 | Reg=0.00186 | acc=0.9375 | L2-Norm=13.641 | L2-Norm(final)=9.003 | 2767.8 samples/s | 43.2 steps/s
[Step=6500 Epoch=31.9] | Loss=0.12714 | Reg=0.00186 | acc=0.8438 | L2-Norm=13.641 | L2-Norm(final)=9.105 | 5367.4 samples/s | 83.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=31.9] | Loss=0.11156 | Reg=0.00186 | acc=0.9219 | L2-Norm=13.641 | L2-Norm(final)=10.111 | 7992.0 samples/s | 124.9 steps/s
[Step=6550 Epoch=32.1] | Loss=0.09894 | Reg=0.00193 | acc=0.9219 | L2-Norm=13.883 | L2-Norm(final)=10.111 | 4003.4 samples/s | 62.6 steps/s
[Step=6600 Epoch=32.4] | Loss=0.08879 | Reg=0.00199 | acc=0.9375 | L2-Norm=14.090 | L2-Norm(final)=10.091 | 4778.2 samples/s | 74.7 steps/s
[Step=6650 Epoch=32.6] | Loss=0.08474 | Reg=0.00203 | acc=0.9062 | L2-Norm=14.245 | L2-Norm(final)=10.073 | 4814.0 samples/s | 75.2 steps/s
[Step=6700 Epoch=32.9] | Loss=0.07901 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.375 | L2-Norm(final)=10.061 | 6883.4 samples/s | 107.6 steps/s
[Step=6750 Epoch=33.1] | Loss=0.07128 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.481 | L2-Norm(final)=10.054 | 2448.7 samples/s | 38.3 steps/s
[Step=6800 Epoch=33.3] | Loss=0.06538 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.571 | L2-Norm(final)=10.050 | 4823.4 samples/s | 75.4 steps/s
[Step=6850 Epoch=33.6] | Loss=0.06344 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.648 | L2-Norm(final)=10.045 | 4722.7 samples/s | 73.8 steps/s
[Step=6900 Epoch=33.8] | Loss=0.06026 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.721 | L2-Norm(final)=10.041 | 6506.5 samples/s | 101.7 steps/s
[Step=6950 Epoch=34.1] | Loss=0.05657 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.787 | L2-Norm(final)=10.038 | 2504.9 samples/s | 39.1 steps/s
[Step=7000 Epoch=34.3] | Loss=0.05309 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.844 | L2-Norm(final)=10.037 | 4777.0 samples/s | 74.6 steps/s
[Step=7050 Epoch=34.6] | Loss=0.05080 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.896 | L2-Norm(final)=10.036 | 4828.8 samples/s | 75.4 steps/s
[Step=7100 Epoch=34.8] | Loss=0.04921 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.945 | L2-Norm(final)=10.035 | 6058.5 samples/s | 94.7 steps/s
[Step=7150 Epoch=35.1] | Loss=0.04690 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.992 | L2-Norm(final)=10.033 | 2587.6 samples/s | 40.4 steps/s
[Step=7200 Epoch=35.3] | Loss=0.04513 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.035 | L2-Norm(final)=10.031 | 4696.2 samples/s | 73.4 steps/s
[Step=7250 Epoch=35.6] | Loss=0.04393 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.075 | L2-Norm(final)=10.030 | 4767.3 samples/s | 74.5 steps/s
[Step=7300 Epoch=35.8] | Loss=0.04237 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.114 | L2-Norm(final)=10.029 | 5854.6 samples/s | 91.5 steps/s
[Step=7350 Epoch=36.0] | Loss=0.04090 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.151 | L2-Norm(final)=10.029 | 2632.2 samples/s | 41.1 steps/s
[Step=7400 Epoch=36.3] | Loss=0.03939 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.187 | L2-Norm(final)=10.029 | 4803.4 samples/s | 75.1 steps/s
[Step=7450 Epoch=36.5] | Loss=0.03812 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.221 | L2-Norm(final)=10.030 | 4716.7 samples/s | 73.7 steps/s
[Step=7500 Epoch=36.8] | Loss=0.03715 | Reg=0.00233 | acc=0.9531 | L2-Norm=15.253 | L2-Norm(final)=10.030 | 5483.4 samples/s | 85.7 steps/s
[Step=7550 Epoch=37.0] | Loss=0.03611 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.285 | L2-Norm(final)=10.031 | 2704.7 samples/s | 42.3 steps/s
[Step=7600 Epoch=37.3] | Loss=0.03526 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.315 | L2-Norm(final)=10.032 | 4756.8 samples/s | 74.3 steps/s
[Step=7650 Epoch=37.5] | Loss=0.03456 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.347 | L2-Norm(final)=10.033 | 4761.1 samples/s | 74.4 steps/s
[Step=7700 Epoch=37.8] | Loss=0.03418 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.378 | L2-Norm(final)=10.032 | 5239.8 samples/s | 81.9 steps/s
[Step=7750 Epoch=38.0] | Loss=0.03351 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.410 | L2-Norm(final)=10.032 | 2785.2 samples/s | 43.5 steps/s
[Step=7800 Epoch=38.2] | Loss=0.03278 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.441 | L2-Norm(final)=10.032 | 4729.8 samples/s | 73.9 steps/s
[Step=7850 Epoch=38.5] | Loss=0.03231 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.471 | L2-Norm(final)=10.032 | 4750.9 samples/s | 74.2 steps/s
[Step=7900 Epoch=38.7] | Loss=0.03186 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.501 | L2-Norm(final)=10.031 | 4982.6 samples/s | 77.9 steps/s
[Step=7950 Epoch=39.0] | Loss=0.03124 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.530 | L2-Norm(final)=10.031 | 2884.1 samples/s | 45.1 steps/s
[Step=8000 Epoch=39.2] | Loss=0.03073 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.558 | L2-Norm(final)=10.031 | 4644.2 samples/s | 72.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step8000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=56.9] | Loss=0.03260 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.632 | L2-Norm(final)=9.767 | 6529.5 samples/s | 102.0 steps/s
[Step=6050 Epoch=57.3] | Loss=0.02214 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.620 | L2-Norm(final)=9.807 | 4823.2 samples/s | 75.4 steps/s
[Step=6100 Epoch=57.8] | Loss=0.01967 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=9.883 | 7421.7 samples/s | 116.0 steps/s
[Step=6150 Epoch=58.3] | Loss=0.01799 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.618 | L2-Norm(final)=9.979 | 2571.9 samples/s | 40.2 steps/s
[Step=6200 Epoch=58.8] | Loss=0.01735 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.618 | L2-Norm(final)=10.086 | 7299.6 samples/s | 114.1 steps/s
[Step=6250 Epoch=59.2] | Loss=0.01673 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=10.196 | 2666.8 samples/s | 41.7 steps/s
[Step=6300 Epoch=59.7] | Loss=0.01636 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=10.306 | 6554.5 samples/s | 102.4 steps/s
[Step=6350 Epoch=60.2] | Loss=0.01613 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=10.416 | 2836.0 samples/s | 44.3 steps/s
[Step=6400 Epoch=60.6] | Loss=0.01561 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=10.523 | 5757.4 samples/s | 90.0 steps/s
[Step=6450 Epoch=61.1] | Loss=0.01535 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=10.628 | 2926.2 samples/s | 45.7 steps/s
[Step=6500 Epoch=61.6] | Loss=0.01496 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=10.729 | 5382.6 samples/s | 84.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=61.6] | Loss=0.00903 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=11.730 | 6985.7 samples/s | 109.2 steps/s
[Step=6550 Epoch=62.1] | Loss=0.01916 | Reg=0.00196 | acc=0.9531 | L2-Norm=14.006 | L2-Norm(final)=11.735 | 4031.9 samples/s | 63.0 steps/s
[Step=6600 Epoch=62.5] | Loss=0.02127 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.406 | L2-Norm(final)=11.672 | 6559.6 samples/s | 102.5 steps/s
[Step=6650 Epoch=63.0] | Loss=0.01523 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.572 | L2-Norm(final)=11.642 | 2409.4 samples/s | 37.6 steps/s
[Step=6700 Epoch=63.5] | Loss=0.01170 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.631 | L2-Norm(final)=11.628 | 5847.4 samples/s | 91.4 steps/s
[Step=6750 Epoch=64.0] | Loss=0.00986 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.649 | L2-Norm(final)=11.620 | 2497.5 samples/s | 39.0 steps/s
[Step=6800 Epoch=64.4] | Loss=0.00824 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.650 | L2-Norm(final)=11.615 | 5347.3 samples/s | 83.6 steps/s
[Step=6850 Epoch=64.9] | Loss=0.00707 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.636 | L2-Norm(final)=11.612 | 2585.1 samples/s | 40.4 steps/s
[Step=6900 Epoch=65.4] | Loss=0.00619 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.613 | L2-Norm(final)=11.611 | 5022.8 samples/s | 78.5 steps/s
[Step=6950 Epoch=65.9] | Loss=0.00550 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.584 | L2-Norm(final)=11.610 | 2691.7 samples/s | 42.1 steps/s
[Step=7000 Epoch=66.3] | Loss=0.00495 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.551 | L2-Norm(final)=11.609 | 4635.1 samples/s | 72.4 steps/s
[Step=7050 Epoch=66.8] | Loss=0.00450 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.516 | L2-Norm(final)=11.608 | 2847.7 samples/s | 44.5 steps/s
[Step=7100 Epoch=67.3] | Loss=0.00413 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.479 | L2-Norm(final)=11.608 | 4422.6 samples/s | 69.1 steps/s
[Step=7150 Epoch=67.8] | Loss=0.00381 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.441 | L2-Norm(final)=11.608 | 2864.4 samples/s | 44.8 steps/s
[Step=7200 Epoch=68.2] | Loss=0.00354 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.402 | L2-Norm(final)=11.608 | 4492.3 samples/s | 70.2 steps/s
[Step=7250 Epoch=68.7] | Loss=0.00331 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.363 | L2-Norm(final)=11.608 | 2860.5 samples/s | 44.7 steps/s
[Step=7300 Epoch=69.2] | Loss=0.00310 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.324 | L2-Norm(final)=11.608 | 4524.7 samples/s | 70.7 steps/s
[Step=7350 Epoch=69.6] | Loss=0.00292 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.285 | L2-Norm(final)=11.608 | 2899.5 samples/s | 45.3 steps/s
[Step=7400 Epoch=70.1] | Loss=0.00276 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.246 | L2-Norm(final)=11.608 | 4462.8 samples/s | 69.7 steps/s
[Step=7450 Epoch=70.6] | Loss=0.00261 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.207 | L2-Norm(final)=11.608 | 6743.3 samples/s | 105.4 steps/s
[Step=7500 Epoch=71.1] | Loss=0.00248 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.169 | L2-Norm(final)=11.608 | 2355.0 samples/s | 36.8 steps/s
[Step=7550 Epoch=71.5] | Loss=0.00236 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.130 | L2-Norm(final)=11.609 | 6168.7 samples/s | 96.4 steps/s
[Step=7600 Epoch=72.0] | Loss=0.00226 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.092 | L2-Norm(final)=11.609 | 2444.5 samples/s | 38.2 steps/s
[Step=7650 Epoch=72.5] | Loss=0.00216 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.054 | L2-Norm(final)=11.609 | 5603.1 samples/s | 87.5 steps/s
[Step=7700 Epoch=73.0] | Loss=0.00207 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.016 | L2-Norm(final)=11.609 | 2567.4 samples/s | 40.1 steps/s
[Step=7750 Epoch=73.4] | Loss=0.00199 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=11.610 | 5116.6 samples/s | 79.9 steps/s
[Step=7800 Epoch=73.9] | Loss=0.00191 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.941 | L2-Norm(final)=11.610 | 2667.4 samples/s | 41.7 steps/s
[Step=7850 Epoch=74.4] | Loss=0.00184 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.904 | L2-Norm(final)=11.610 | 4720.3 samples/s | 73.8 steps/s
[Step=7900 Epoch=74.9] | Loss=0.00177 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.867 | L2-Norm(final)=11.611 | 2770.0 samples/s | 43.3 steps/s
[Step=7950 Epoch=75.3] | Loss=0.00171 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.830 | L2-Norm(final)=11.611 | 4566.6 samples/s | 71.4 steps/s
[Step=8000 Epoch=75.8] | Loss=0.00166 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.794 | L2-Norm(final)=11.611 | 2856.5 samples/s | 44.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step8000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=38.2] | Loss=0.20513 | Reg=0.00186 | acc=0.8125 | L2-Norm=13.632 | L2-Norm(final)=6.606 | 7085.9 samples/s | 110.7 steps/s
[Step=4050 Epoch=38.7] | Loss=0.13564 | Reg=0.00186 | acc=0.9375 | L2-Norm=13.627 | L2-Norm(final)=6.567 | 4592.7 samples/s | 71.8 steps/s
[Step=4100 Epoch=39.2] | Loss=0.10438 | Reg=0.00186 | acc=0.9531 | L2-Norm=13.626 | L2-Norm(final)=6.587 | 8364.7 samples/s | 130.7 steps/s
[Step=4150 Epoch=39.6] | Loss=0.08841 | Reg=0.00186 | acc=0.9375 | L2-Norm=13.626 | L2-Norm(final)=6.650 | 2554.4 samples/s | 39.9 steps/s
[Step=4200 Epoch=40.1] | Loss=0.07958 | Reg=0.00186 | acc=0.9531 | L2-Norm=13.626 | L2-Norm(final)=6.734 | 7520.9 samples/s | 117.5 steps/s
[Step=4250 Epoch=40.6] | Loss=0.07273 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.625 | L2-Norm(final)=6.826 | 2641.9 samples/s | 41.3 steps/s
[Step=4300 Epoch=41.1] | Loss=0.06804 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.625 | L2-Norm(final)=6.922 | 6803.5 samples/s | 106.3 steps/s
[Step=4350 Epoch=41.5] | Loss=0.06416 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.625 | L2-Norm(final)=7.018 | 2780.7 samples/s | 43.4 steps/s
[Step=4400 Epoch=42.0] | Loss=0.06089 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.625 | L2-Norm(final)=7.114 | 6084.1 samples/s | 95.1 steps/s
[Step=4450 Epoch=42.5] | Loss=0.05817 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.625 | L2-Norm(final)=7.207 | 2916.0 samples/s | 45.6 steps/s
[Step=4500 Epoch=43.0] | Loss=0.05605 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.625 | L2-Norm(final)=7.299 | 5560.6 samples/s | 86.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=43.0] | Loss=0.03371 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.625 | L2-Norm(final)=8.202 | 6905.8 samples/s | 107.9 steps/s
[Step=4550 Epoch=43.4] | Loss=0.01805 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=8.231 | 4066.4 samples/s | 63.5 steps/s
[Step=4600 Epoch=43.9] | Loss=0.01101 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.051 | L2-Norm(final)=8.235 | 6735.6 samples/s | 105.2 steps/s
[Step=4650 Epoch=44.4] | Loss=0.00764 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.124 | L2-Norm(final)=8.240 | 2377.1 samples/s | 37.1 steps/s
[Step=4700 Epoch=44.9] | Loss=0.00589 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.152 | L2-Norm(final)=8.246 | 6131.4 samples/s | 95.8 steps/s
[Step=4750 Epoch=45.4] | Loss=0.00494 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.160 | L2-Norm(final)=8.249 | 2476.3 samples/s | 38.7 steps/s
[Step=4800 Epoch=45.8] | Loss=0.00422 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.162 | L2-Norm(final)=8.252 | 5584.9 samples/s | 87.3 steps/s
[Step=4850 Epoch=46.3] | Loss=0.00366 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.157 | L2-Norm(final)=8.255 | 2532.2 samples/s | 39.6 steps/s
[Step=4900 Epoch=46.8] | Loss=0.00321 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.147 | L2-Norm(final)=8.258 | 5299.2 samples/s | 82.8 steps/s
[Step=4950 Epoch=47.3] | Loss=0.00285 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.135 | L2-Norm(final)=8.260 | 2609.3 samples/s | 40.8 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00257 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=8.262 | 4950.4 samples/s | 77.3 steps/s
[Step=5050 Epoch=48.2] | Loss=0.00234 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.103 | L2-Norm(final)=8.263 | 2711.3 samples/s | 42.4 steps/s
[Step=5100 Epoch=48.7] | Loss=0.00214 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.085 | L2-Norm(final)=8.265 | 4647.1 samples/s | 72.6 steps/s
[Step=5150 Epoch=49.2] | Loss=0.00198 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.066 | L2-Norm(final)=8.266 | 2814.4 samples/s | 44.0 steps/s
[Step=5200 Epoch=49.7] | Loss=0.00184 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.047 | L2-Norm(final)=8.267 | 4591.2 samples/s | 71.7 steps/s
[Step=5250 Epoch=50.1] | Loss=0.00172 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.027 | L2-Norm(final)=8.268 | 2863.5 samples/s | 44.7 steps/s
[Step=5300 Epoch=50.6] | Loss=0.00161 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.007 | L2-Norm(final)=8.269 | 4392.4 samples/s | 68.6 steps/s
[Step=5350 Epoch=51.1] | Loss=0.00151 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.987 | L2-Norm(final)=8.270 | 2902.5 samples/s | 45.4 steps/s
[Step=5400 Epoch=51.6] | Loss=0.00143 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.966 | L2-Norm(final)=8.271 | 4521.9 samples/s | 70.7 steps/s
[Step=5450 Epoch=52.0] | Loss=0.00136 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.945 | L2-Norm(final)=8.272 | 2802.5 samples/s | 43.8 steps/s
[Step=5500 Epoch=52.5] | Loss=0.00129 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.924 | L2-Norm(final)=8.272 | 4550.5 samples/s | 71.1 steps/s
[Step=5550 Epoch=53.0] | Loss=0.00123 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.903 | L2-Norm(final)=8.273 | 7341.1 samples/s | 114.7 steps/s
[Step=5600 Epoch=53.5] | Loss=0.00117 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=8.274 | 2329.7 samples/s | 36.4 steps/s
[Step=5650 Epoch=54.0] | Loss=0.00112 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.861 | L2-Norm(final)=8.274 | 6380.0 samples/s | 99.7 steps/s
[Step=5700 Epoch=54.4] | Loss=0.00107 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.840 | L2-Norm(final)=8.275 | 2378.3 samples/s | 37.2 steps/s
[Step=5750 Epoch=54.9] | Loss=0.00103 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.818 | L2-Norm(final)=8.276 | 6090.8 samples/s | 95.2 steps/s
[Step=5800 Epoch=55.4] | Loss=0.00099 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.797 | L2-Norm(final)=8.276 | 2434.6 samples/s | 38.0 steps/s
[Step=5850 Epoch=55.9] | Loss=0.00096 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.775 | L2-Norm(final)=8.277 | 5646.8 samples/s | 88.2 steps/s
[Step=5900 Epoch=56.3] | Loss=0.00092 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.754 | L2-Norm(final)=8.277 | 2510.4 samples/s | 39.2 steps/s
[Step=5950 Epoch=56.8] | Loss=0.00089 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.732 | L2-Norm(final)=8.278 | 5296.1 samples/s | 82.8 steps/s
[Step=6000 Epoch=57.3] | Loss=0.00086 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.711 | L2-Norm(final)=8.278 | 2318.9 samples/s | 36.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step6000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=75.4] | Loss=0.03998 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.632 | L2-Norm(final)=9.552 | 7045.2 samples/s | 110.1 steps/s
[Step=8050 Epoch=75.9] | Loss=0.04031 | Reg=0.00186 | acc=0.9531 | L2-Norm=13.620 | L2-Norm(final)=9.554 | 4559.3 samples/s | 71.2 steps/s
[Step=8100 Epoch=76.3] | Loss=0.03152 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.619 | L2-Norm(final)=9.584 | 8215.2 samples/s | 128.4 steps/s
[Step=8150 Epoch=76.8] | Loss=0.02860 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=9.658 | 2585.8 samples/s | 40.4 steps/s
[Step=8200 Epoch=77.3] | Loss=0.02633 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=9.750 | 7126.4 samples/s | 111.3 steps/s
[Step=8250 Epoch=77.7] | Loss=0.02544 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.618 | L2-Norm(final)=9.845 | 2732.5 samples/s | 42.7 steps/s
[Step=8300 Epoch=78.2] | Loss=0.02491 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=9.943 | 6153.6 samples/s | 96.2 steps/s
[Step=8350 Epoch=78.7] | Loss=0.02400 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.618 | L2-Norm(final)=10.043 | 2867.2 samples/s | 44.8 steps/s
[Step=8400 Epoch=79.2] | Loss=0.02341 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.618 | L2-Norm(final)=10.142 | 5612.7 samples/s | 87.7 steps/s
[Step=8450 Epoch=79.6] | Loss=0.02286 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.618 | L2-Norm(final)=10.240 | 3034.1 samples/s | 47.4 steps/s
[Step=8500 Epoch=80.1] | Loss=0.02227 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=10.336 | 5233.3 samples/s | 81.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=80.1] | Loss=0.01004 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=11.292 | 6840.0 samples/s | 106.9 steps/s
[Step=8550 Epoch=80.6] | Loss=0.03858 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.083 | L2-Norm(final)=11.283 | 4115.4 samples/s | 64.3 steps/s
[Step=8600 Epoch=81.0] | Loss=0.02437 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.417 | L2-Norm(final)=11.246 | 6533.5 samples/s | 102.1 steps/s
[Step=8650 Epoch=81.5] | Loss=0.01852 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.542 | L2-Norm(final)=11.238 | 2430.3 samples/s | 38.0 steps/s
[Step=8700 Epoch=82.0] | Loss=0.01429 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.584 | L2-Norm(final)=11.233 | 5651.2 samples/s | 88.3 steps/s
[Step=8750 Epoch=82.4] | Loss=0.01151 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.590 | L2-Norm(final)=11.233 | 2507.0 samples/s | 39.2 steps/s
[Step=8800 Epoch=82.9] | Loss=0.00965 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.577 | L2-Norm(final)=11.234 | 5270.7 samples/s | 82.4 steps/s
[Step=8850 Epoch=83.4] | Loss=0.00828 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.554 | L2-Norm(final)=11.236 | 2660.9 samples/s | 41.6 steps/s
[Step=8900 Epoch=83.9] | Loss=0.00725 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.524 | L2-Norm(final)=11.237 | 4746.6 samples/s | 74.2 steps/s
[Step=8950 Epoch=84.3] | Loss=0.00644 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.489 | L2-Norm(final)=11.239 | 2742.4 samples/s | 42.9 steps/s
[Step=9000 Epoch=84.8] | Loss=0.00580 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.452 | L2-Norm(final)=11.240 | 4576.7 samples/s | 71.5 steps/s
[Step=9050 Epoch=85.3] | Loss=0.00527 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.413 | L2-Norm(final)=11.241 | 2840.8 samples/s | 44.4 steps/s
[Step=9100 Epoch=85.7] | Loss=0.00484 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.373 | L2-Norm(final)=11.243 | 4524.8 samples/s | 70.7 steps/s
[Step=9150 Epoch=86.2] | Loss=0.00446 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.332 | L2-Norm(final)=11.244 | 2900.3 samples/s | 45.3 steps/s
[Step=9200 Epoch=86.7] | Loss=0.00415 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.292 | L2-Norm(final)=11.245 | 4491.3 samples/s | 70.2 steps/s
[Step=9250 Epoch=87.2] | Loss=0.00387 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.251 | L2-Norm(final)=11.246 | 3088.9 samples/s | 48.3 steps/s
[Step=9300 Epoch=87.6] | Loss=0.00363 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.210 | L2-Norm(final)=11.247 | 4132.9 samples/s | 64.6 steps/s
[Step=9350 Epoch=88.1] | Loss=0.00342 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.169 | L2-Norm(final)=11.247 | 6360.6 samples/s | 99.4 steps/s
[Step=9400 Epoch=88.6] | Loss=0.00323 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.129 | L2-Norm(final)=11.248 | 2400.2 samples/s | 37.5 steps/s
[Step=9450 Epoch=89.0] | Loss=0.00306 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.088 | L2-Norm(final)=11.249 | 5913.6 samples/s | 92.4 steps/s
[Step=9500 Epoch=89.5] | Loss=0.00290 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.048 | L2-Norm(final)=11.250 | 2517.2 samples/s | 39.3 steps/s
[Step=9550 Epoch=90.0] | Loss=0.00277 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.009 | L2-Norm(final)=11.251 | 5268.7 samples/s | 82.3 steps/s
[Step=9600 Epoch=90.5] | Loss=0.00264 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.969 | L2-Norm(final)=11.251 | 2613.2 samples/s | 40.8 steps/s
[Step=9650 Epoch=90.9] | Loss=0.00253 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.930 | L2-Norm(final)=11.252 | 4860.9 samples/s | 76.0 steps/s
[Step=9700 Epoch=91.4] | Loss=0.00242 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.891 | L2-Norm(final)=11.253 | 2746.1 samples/s | 42.9 steps/s
[Step=9750 Epoch=91.9] | Loss=0.00232 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.853 | L2-Norm(final)=11.253 | 4577.2 samples/s | 71.5 steps/s
[Step=9800 Epoch=92.3] | Loss=0.00224 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.815 | L2-Norm(final)=11.254 | 2896.3 samples/s | 45.3 steps/s
[Step=9850 Epoch=92.8] | Loss=0.00215 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.777 | L2-Norm(final)=11.255 | 4510.4 samples/s | 70.5 steps/s
[Step=9900 Epoch=93.3] | Loss=0.00208 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.739 | L2-Norm(final)=11.255 | 2859.4 samples/s | 44.7 steps/s
[Step=9950 Epoch=93.8] | Loss=0.00200 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.702 | L2-Norm(final)=11.256 | 4547.5 samples/s | 71.1 steps/s
[Step=10000 Epoch=94.2] | Loss=0.00194 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.665 | L2-Norm(final)=11.256 | 3030.4 samples/s | 47.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.13386 | acc=0.9330 | tpr=0.9410 | fpr=0.0845 | 5947.1 samples/s | 23.2 steps/s
Avg test loss: 0.14189, Avg test acc: 0.92848, Avg tpr: 0.93682, Avg fpr: 0.08986, total FA: 701

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.13090 | acc=0.9357 | tpr=0.9605 | fpr=0.1182 | 5771.0 samples/s | 22.5 steps/s
Avg test loss: 0.13077, Avg test acc: 0.93569, Avg tpr: 0.96042, Avg fpr: 0.11870, total FA: 926

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.15329 | acc=0.9373 | tpr=0.9524 | fpr=0.0956 | 6092.4 samples/s | 23.8 steps/s
Avg test loss: 0.15689, Avg test acc: 0.93529, Avg tpr: 0.95005, Avg fpr: 0.09717, total FA: 758

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.13526 | acc=0.9387 | tpr=0.9553 | fpr=0.0974 | 5987.8 samples/s | 23.4 steps/s
Avg test loss: 0.14670, Avg test acc: 0.93549, Avg tpr: 0.95337, Avg fpr: 0.10383, total FA: 810

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.14279 | acc=0.9331 | tpr=0.9598 | fpr=0.1249 | 5912.6 samples/s | 23.1 steps/s
Avg test loss: 0.14646, Avg test acc: 0.93281, Avg tpr: 0.95786, Avg fpr: 0.12229, total FA: 954

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.86646 | acc=0.3149 | tpr=0.0146 | fpr=0.0330 | 5868.4 samples/s | 22.9 steps/s
Avg test loss: 5.87834, Avg test acc: 0.31265, Avg tpr: 0.01457, Avg fpr: 0.03179, total FA: 248

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.21096 | acc=0.3184 | tpr=0.0104 | fpr=0.0129 | 6095.1 samples/s | 23.8 steps/s
Avg test loss: 5.22606, Avg test acc: 0.31541, Avg tpr: 0.00985, Avg fpr: 0.01256, total FA: 98

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.13446 | acc=0.3227 | tpr=0.0330 | fpr=0.0481 | 5994.6 samples/s | 23.4 steps/s
Avg test loss: 4.14066, Avg test acc: 0.32086, Avg tpr: 0.03322, Avg fpr: 0.04653, total FA: 363

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.57220 | acc=0.3091 | tpr=0.0193 | fpr=0.0617 | 6036.2 samples/s | 23.6 steps/s
Avg test loss: 4.58498, Avg test acc: 0.30716, Avg tpr: 0.01970, Avg fpr: 0.06063, total FA: 473

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=6.04448 | acc=0.3141 | tpr=0.0086 | fpr=0.0225 | 5901.5 samples/s | 23.1 steps/s
Avg test loss: 6.06691, Avg test acc: 0.31261, Avg tpr: 0.00898, Avg fpr: 0.01961, total FA: 153

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.13482 | acc=0.1384 | tpr=0.8097 | fpr=0.8737 | 6101.9 samples/s | 23.8 steps/s
[Step= 100] | Loss=5.11966 | acc=0.1395 | tpr=0.7996 | fpr=0.8729 | 7402.4 samples/s | 28.9 steps/s
[Step= 150] | Loss=5.12125 | acc=0.1392 | tpr=0.8026 | fpr=0.8730 | 8185.3 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.11267 | acc=0.1398 | tpr=0.7956 | fpr=0.8721 | 7760.5 samples/s | 30.3 steps/s
[Step= 250] | Loss=5.11932 | acc=0.1398 | tpr=0.7956 | fpr=0.8722 | 8084.5 samples/s | 31.6 steps/s
[Step= 300] | Loss=5.11211 | acc=0.1400 | tpr=0.7956 | fpr=0.8719 | 8247.5 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.11481 | acc=0.1398 | tpr=0.7996 | fpr=0.8722 | 8659.9 samples/s | 33.8 steps/s
[Step= 400] | Loss=5.11526 | acc=0.1399 | tpr=0.7998 | fpr=0.8721 | 8451.7 samples/s | 33.0 steps/s
[Step= 450] | Loss=5.11904 | acc=0.1393 | tpr=0.7970 | fpr=0.8727 | 8026.3 samples/s | 31.4 steps/s
[Step= 500] | Loss=5.11711 | acc=0.1392 | tpr=0.8009 | fpr=0.8727 | 7966.7 samples/s | 31.1 steps/s
[Step= 550] | Loss=5.11749 | acc=0.1393 | tpr=0.7998 | fpr=0.8727 | 9063.2 samples/s | 35.4 steps/s
Avg test loss: 5.11835, Avg test acc: 0.13921, Avg tpr: 0.80032, Avg fpr: 0.87280, total FA: 121187

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.05186 | acc=0.1220 | tpr=0.7920 | fpr=0.8901 | 5961.5 samples/s | 23.3 steps/s
[Step= 100] | Loss=6.02769 | acc=0.1211 | tpr=0.7846 | fpr=0.8913 | 8133.8 samples/s | 31.8 steps/s
[Step= 150] | Loss=6.03050 | acc=0.1213 | tpr=0.7896 | fpr=0.8910 | 7370.9 samples/s | 28.8 steps/s
[Step= 200] | Loss=6.02958 | acc=0.1210 | tpr=0.7858 | fpr=0.8911 | 8155.0 samples/s | 31.9 steps/s
[Step= 250] | Loss=6.02991 | acc=0.1213 | tpr=0.7895 | fpr=0.8909 | 8222.9 samples/s | 32.1 steps/s
[Step= 300] | Loss=6.02814 | acc=0.1214 | tpr=0.7898 | fpr=0.8908 | 8303.3 samples/s | 32.4 steps/s
[Step= 350] | Loss=6.03199 | acc=0.1209 | tpr=0.7940 | fpr=0.8913 | 7725.4 samples/s | 30.2 steps/s
[Step= 400] | Loss=6.03452 | acc=0.1216 | tpr=0.7954 | fpr=0.8907 | 7698.0 samples/s | 30.1 steps/s
[Step= 450] | Loss=6.04000 | acc=0.1210 | tpr=0.7936 | fpr=0.8912 | 8294.2 samples/s | 32.4 steps/s
[Step= 500] | Loss=6.03925 | acc=0.1210 | tpr=0.7956 | fpr=0.8912 | 8724.0 samples/s | 34.1 steps/s
[Step= 550] | Loss=6.04222 | acc=0.1211 | tpr=0.7959 | fpr=0.8912 | 9502.6 samples/s | 37.1 steps/s
Avg test loss: 6.04366, Avg test acc: 0.12104, Avg tpr: 0.79556, Avg fpr: 0.89123, total FA: 123745

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.79943 | acc=0.1257 | tpr=0.8584 | fpr=0.8875 | 5811.9 samples/s | 22.7 steps/s
[Step= 100] | Loss=5.78174 | acc=0.1249 | tpr=0.8337 | fpr=0.8883 | 7244.5 samples/s | 28.3 steps/s
[Step= 150] | Loss=5.79062 | acc=0.1260 | tpr=0.8314 | fpr=0.8870 | 8475.9 samples/s | 33.1 steps/s
[Step= 200] | Loss=5.78785 | acc=0.1259 | tpr=0.8240 | fpr=0.8868 | 7859.9 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.79872 | acc=0.1258 | tpr=0.8236 | fpr=0.8869 | 8371.5 samples/s | 32.7 steps/s
[Step= 300] | Loss=5.79958 | acc=0.1261 | tpr=0.8291 | fpr=0.8868 | 8171.3 samples/s | 31.9 steps/s
[Step= 350] | Loss=5.79932 | acc=0.1265 | tpr=0.8353 | fpr=0.8864 | 8125.0 samples/s | 31.7 steps/s
[Step= 400] | Loss=5.79914 | acc=0.1266 | tpr=0.8337 | fpr=0.8863 | 7988.0 samples/s | 31.2 steps/s
[Step= 450] | Loss=5.80064 | acc=0.1263 | tpr=0.8320 | fpr=0.8865 | 8350.6 samples/s | 32.6 steps/s
[Step= 500] | Loss=5.80127 | acc=0.1265 | tpr=0.8352 | fpr=0.8863 | 7143.1 samples/s | 27.9 steps/s
[Step= 550] | Loss=5.80463 | acc=0.1268 | tpr=0.8353 | fpr=0.8860 | 11690.5 samples/s | 45.7 steps/s
Avg test loss: 5.80440, Avg test acc: 0.12679, Avg tpr: 0.83518, Avg fpr: 0.88609, total FA: 123032

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.38066 | acc=0.1390 | tpr=0.8009 | fpr=0.8729 | 6028.9 samples/s | 23.6 steps/s
[Step= 100] | Loss=5.34188 | acc=0.1410 | tpr=0.7740 | fpr=0.8708 | 7668.8 samples/s | 30.0 steps/s
[Step= 150] | Loss=5.33590 | acc=0.1418 | tpr=0.7781 | fpr=0.8699 | 7812.7 samples/s | 30.5 steps/s
[Step= 200] | Loss=5.33532 | acc=0.1419 | tpr=0.7738 | fpr=0.8696 | 8447.5 samples/s | 33.0 steps/s
[Step= 250] | Loss=5.34303 | acc=0.1410 | tpr=0.7782 | fpr=0.8706 | 7559.8 samples/s | 29.5 steps/s
[Step= 300] | Loss=5.33645 | acc=0.1415 | tpr=0.7840 | fpr=0.8702 | 8264.2 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.34096 | acc=0.1407 | tpr=0.7858 | fpr=0.8710 | 7796.5 samples/s | 30.5 steps/s
[Step= 400] | Loss=5.33958 | acc=0.1409 | tpr=0.7856 | fpr=0.8709 | 8460.8 samples/s | 33.0 steps/s
[Step= 450] | Loss=5.33964 | acc=0.1405 | tpr=0.7872 | fpr=0.8713 | 8459.5 samples/s | 33.0 steps/s
[Step= 500] | Loss=5.33653 | acc=0.1405 | tpr=0.7912 | fpr=0.8712 | 8084.5 samples/s | 31.6 steps/s
[Step= 550] | Loss=5.34064 | acc=0.1405 | tpr=0.7919 | fpr=0.8713 | 9216.0 samples/s | 36.0 steps/s
Avg test loss: 5.34119, Avg test acc: 0.14046, Avg tpr: 0.79200, Avg fpr: 0.87138, total FA: 120990

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.56352 | acc=0.1254 | tpr=0.7876 | fpr=0.8865 | 5972.6 samples/s | 23.3 steps/s
[Step= 100] | Loss=5.55297 | acc=0.1289 | tpr=0.7783 | fpr=0.8833 | 7878.0 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.55528 | acc=0.1283 | tpr=0.7767 | fpr=0.8836 | 7987.9 samples/s | 31.2 steps/s
[Step= 200] | Loss=5.55334 | acc=0.1283 | tpr=0.7683 | fpr=0.8833 | 7807.2 samples/s | 30.5 steps/s
[Step= 250] | Loss=5.54846 | acc=0.1281 | tpr=0.7659 | fpr=0.8835 | 8011.0 samples/s | 31.3 steps/s
[Step= 300] | Loss=5.54282 | acc=0.1285 | tpr=0.7651 | fpr=0.8832 | 8106.5 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.54577 | acc=0.1282 | tpr=0.7721 | fpr=0.8835 | 7960.8 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.54457 | acc=0.1286 | tpr=0.7708 | fpr=0.8831 | 8019.7 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.54932 | acc=0.1284 | tpr=0.7726 | fpr=0.8833 | 7213.6 samples/s | 28.2 steps/s
[Step= 500] | Loss=5.55283 | acc=0.1280 | tpr=0.7709 | fpr=0.8836 | 8493.9 samples/s | 33.2 steps/s
[Step= 550] | Loss=5.55557 | acc=0.1279 | tpr=0.7712 | fpr=0.8837 | 11271.9 samples/s | 44.0 steps/s
Avg test loss: 5.55715, Avg test acc: 0.12786, Avg tpr: 0.77179, Avg fpr: 0.88384, total FA: 122720

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.16497 | acc=0.9623 | tpr=0.9027 | fpr=0.0367 | 5986.4 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.17451 | acc=0.9600 | tpr=0.9211 | fpr=0.0392 | 7504.3 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.17610 | acc=0.9589 | tpr=0.9207 | fpr=0.0404 | 8110.4 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.17549 | acc=0.9593 | tpr=0.9290 | fpr=0.0402 | 7688.1 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.17703 | acc=0.9592 | tpr=0.9197 | fpr=0.0400 | 9212.7 samples/s | 36.0 steps/s
[Step= 300] | Loss=0.17984 | acc=0.9588 | tpr=0.9193 | fpr=0.0405 | 7981.1 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.17947 | acc=0.9588 | tpr=0.9180 | fpr=0.0404 | 8345.6 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.18032 | acc=0.9586 | tpr=0.9152 | fpr=0.0407 | 7982.6 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.18310 | acc=0.9581 | tpr=0.9143 | fpr=0.0411 | 7338.7 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.18354 | acc=0.9579 | tpr=0.9154 | fpr=0.0413 | 8499.5 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.18277 | acc=0.9580 | tpr=0.9129 | fpr=0.0412 | 9801.3 samples/s | 38.3 steps/s
Avg test loss: 0.18254, Avg test acc: 0.95803, Avg tpr: 0.91284, Avg fpr: 0.04115, total FA: 5713

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11033 | acc=0.9687 | tpr=0.8319 | fpr=0.0289 | 6069.9 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.11265 | acc=0.9680 | tpr=0.8571 | fpr=0.0299 | 7703.5 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.11360 | acc=0.9683 | tpr=0.8646 | fpr=0.0298 | 6916.6 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.11358 | acc=0.9686 | tpr=0.8743 | fpr=0.0297 | 8226.5 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.11486 | acc=0.9685 | tpr=0.8716 | fpr=0.0297 | 8204.2 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.11606 | acc=0.9683 | tpr=0.8727 | fpr=0.0299 | 8127.0 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.11540 | acc=0.9686 | tpr=0.8723 | fpr=0.0296 | 8119.7 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.11630 | acc=0.9683 | tpr=0.8693 | fpr=0.0299 | 7968.9 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.11812 | acc=0.9679 | tpr=0.8685 | fpr=0.0303 | 8477.8 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.11748 | acc=0.9679 | tpr=0.8722 | fpr=0.0304 | 8565.9 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.11709 | acc=0.9680 | tpr=0.8679 | fpr=0.0302 | 10864.3 samples/s | 42.4 steps/s
Avg test loss: 0.11695, Avg test acc: 0.96800, Avg tpr: 0.86767, Avg fpr: 0.03018, total FA: 4190

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26713 | acc=0.9463 | tpr=0.9425 | fpr=0.0536 | 5807.1 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.27335 | acc=0.9450 | tpr=0.9574 | fpr=0.0552 | 8186.2 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.28003 | acc=0.9435 | tpr=0.9524 | fpr=0.0567 | 7168.5 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.27906 | acc=0.9434 | tpr=0.9519 | fpr=0.0568 | 8136.1 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.27929 | acc=0.9433 | tpr=0.9459 | fpr=0.0567 | 8397.9 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.28174 | acc=0.9430 | tpr=0.9425 | fpr=0.0570 | 8039.8 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.28091 | acc=0.9429 | tpr=0.9436 | fpr=0.0572 | 8151.3 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.28145 | acc=0.9425 | tpr=0.9431 | fpr=0.0575 | 7866.6 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.28426 | acc=0.9420 | tpr=0.9430 | fpr=0.0581 | 7196.6 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.28518 | acc=0.9417 | tpr=0.9445 | fpr=0.0584 | 8054.8 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.28423 | acc=0.9418 | tpr=0.9451 | fpr=0.0583 | 12877.4 samples/s | 50.3 steps/s
Avg test loss: 0.28382, Avg test acc: 0.94186, Avg tpr: 0.94532, Avg fpr: 0.05821, total FA: 8082

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11000 | acc=0.9665 | tpr=0.8894 | fpr=0.0321 | 5915.7 samples/s | 23.1 steps/s
[Step= 100] | Loss=0.11553 | acc=0.9657 | tpr=0.8891 | fpr=0.0329 | 7882.3 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.11641 | acc=0.9654 | tpr=0.8948 | fpr=0.0333 | 7878.2 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.11562 | acc=0.9655 | tpr=0.8962 | fpr=0.0333 | 8305.2 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.11709 | acc=0.9652 | tpr=0.8934 | fpr=0.0335 | 8135.5 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.11854 | acc=0.9647 | tpr=0.8938 | fpr=0.0340 | 7995.3 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.11831 | acc=0.9646 | tpr=0.8942 | fpr=0.0341 | 7796.3 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.11822 | acc=0.9646 | tpr=0.8917 | fpr=0.0341 | 7797.0 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.11964 | acc=0.9643 | tpr=0.8909 | fpr=0.0344 | 8067.6 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.11934 | acc=0.9643 | tpr=0.8930 | fpr=0.0344 | 8180.5 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.11900 | acc=0.9645 | tpr=0.8934 | fpr=0.0342 | 10564.4 samples/s | 41.3 steps/s
Avg test loss: 0.11895, Avg test acc: 0.96444, Avg tpr: 0.89263, Avg fpr: 0.03425, total FA: 4756

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21249 | acc=0.9555 | tpr=0.8938 | fpr=0.0434 | 6099.4 samples/s | 23.8 steps/s
[Step= 100] | Loss=0.22081 | acc=0.9547 | tpr=0.9104 | fpr=0.0445 | 7452.9 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.22236 | acc=0.9538 | tpr=0.9222 | fpr=0.0456 | 7651.2 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.22323 | acc=0.9540 | tpr=0.9257 | fpr=0.0455 | 8073.0 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.22440 | acc=0.9536 | tpr=0.9205 | fpr=0.0458 | 8605.4 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.22727 | acc=0.9528 | tpr=0.9207 | fpr=0.0466 | 8002.3 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.22575 | acc=0.9531 | tpr=0.9205 | fpr=0.0463 | 8408.9 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.22546 | acc=0.9529 | tpr=0.9136 | fpr=0.0464 | 8213.5 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.22772 | acc=0.9525 | tpr=0.9114 | fpr=0.0468 | 7899.4 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.22895 | acc=0.9523 | tpr=0.9128 | fpr=0.0470 | 7375.2 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.22767 | acc=0.9525 | tpr=0.9121 | fpr=0.0467 | 10812.5 samples/s | 42.2 steps/s
Avg test loss: 0.22751, Avg test acc: 0.95256, Avg tpr: 0.91204, Avg fpr: 0.04670, total FA: 6484

server round 8/50

clients selected: [1 3 4 5 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=48.8] | Loss=0.20653 | Reg=0.00176 | acc=0.8125 | L2-Norm=13.261 | L2-Norm(final)=8.910 | 7796.0 samples/s | 121.8 steps/s
[Step=10050 Epoch=49.0] | Loss=0.22355 | Reg=0.00176 | acc=0.8750 | L2-Norm=13.273 | L2-Norm(final)=8.720 | 4625.3 samples/s | 72.3 steps/s
[Step=10100 Epoch=49.3] | Loss=0.18395 | Reg=0.00176 | acc=0.9219 | L2-Norm=13.275 | L2-Norm(final)=8.714 | 5553.5 samples/s | 86.8 steps/s
[Step=10150 Epoch=49.5] | Loss=0.16505 | Reg=0.00176 | acc=0.9062 | L2-Norm=13.275 | L2-Norm(final)=8.786 | 5592.3 samples/s | 87.4 steps/s
[Step=10200 Epoch=49.8] | Loss=0.15672 | Reg=0.00176 | acc=0.9062 | L2-Norm=13.276 | L2-Norm(final)=8.886 | 8636.4 samples/s | 134.9 steps/s
[Step=10250 Epoch=50.0] | Loss=0.15042 | Reg=0.00176 | acc=0.9062 | L2-Norm=13.276 | L2-Norm(final)=8.991 | 2673.4 samples/s | 41.8 steps/s
[Step=10300 Epoch=50.3] | Loss=0.14661 | Reg=0.00176 | acc=0.9219 | L2-Norm=13.276 | L2-Norm(final)=9.094 | 5529.8 samples/s | 86.4 steps/s
[Step=10350 Epoch=50.5] | Loss=0.14289 | Reg=0.00176 | acc=0.9062 | L2-Norm=13.276 | L2-Norm(final)=9.198 | 5747.1 samples/s | 89.8 steps/s
[Step=10400 Epoch=50.7] | Loss=0.14043 | Reg=0.00176 | acc=0.9062 | L2-Norm=13.276 | L2-Norm(final)=9.302 | 7391.7 samples/s | 115.5 steps/s
[Step=10450 Epoch=51.0] | Loss=0.13890 | Reg=0.00176 | acc=0.8906 | L2-Norm=13.276 | L2-Norm(final)=9.403 | 2756.4 samples/s | 43.1 steps/s
[Step=10500 Epoch=51.2] | Loss=0.13696 | Reg=0.00176 | acc=0.8906 | L2-Norm=13.276 | L2-Norm(final)=9.501 | 5548.1 samples/s | 86.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=51.2] | Loss=0.11397 | Reg=0.00176 | acc=0.9062 | L2-Norm=13.277 | L2-Norm(final)=10.480 | 6869.2 samples/s | 107.3 steps/s
[Step=10550 Epoch=51.5] | Loss=0.10314 | Reg=0.00186 | acc=0.9062 | L2-Norm=13.635 | L2-Norm(final)=10.489 | 4456.0 samples/s | 69.6 steps/s
[Step=10600 Epoch=51.7] | Loss=0.08952 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.911 | L2-Norm(final)=10.460 | 4613.0 samples/s | 72.1 steps/s
[Step=10650 Epoch=52.0] | Loss=0.08546 | Reg=0.00199 | acc=0.8906 | L2-Norm=14.084 | L2-Norm(final)=10.437 | 4816.3 samples/s | 75.3 steps/s
[Step=10700 Epoch=52.2] | Loss=0.07879 | Reg=0.00202 | acc=0.9531 | L2-Norm=14.208 | L2-Norm(final)=10.422 | 6837.1 samples/s | 106.8 steps/s
[Step=10750 Epoch=52.5] | Loss=0.07091 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.306 | L2-Norm(final)=10.414 | 2476.2 samples/s | 38.7 steps/s
[Step=10800 Epoch=52.7] | Loss=0.06611 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.389 | L2-Norm(final)=10.408 | 4732.5 samples/s | 73.9 steps/s
[Step=10850 Epoch=52.9] | Loss=0.06260 | Reg=0.00209 | acc=0.9375 | L2-Norm=14.460 | L2-Norm(final)=10.402 | 4846.0 samples/s | 75.7 steps/s
[Step=10900 Epoch=53.2] | Loss=0.05955 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.524 | L2-Norm(final)=10.397 | 6246.1 samples/s | 97.6 steps/s
[Step=10950 Epoch=53.4] | Loss=0.05649 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.582 | L2-Norm(final)=10.392 | 2535.1 samples/s | 39.6 steps/s
[Step=11000 Epoch=53.7] | Loss=0.05323 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.634 | L2-Norm(final)=10.389 | 4767.8 samples/s | 74.5 steps/s
[Step=11050 Epoch=53.9] | Loss=0.05074 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.683 | L2-Norm(final)=10.388 | 4770.6 samples/s | 74.5 steps/s
[Step=11100 Epoch=54.2] | Loss=0.04861 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.730 | L2-Norm(final)=10.385 | 5880.6 samples/s | 91.9 steps/s
[Step=11150 Epoch=54.4] | Loss=0.04689 | Reg=0.00219 | acc=0.9531 | L2-Norm=14.775 | L2-Norm(final)=10.381 | 2614.6 samples/s | 40.9 steps/s
[Step=11200 Epoch=54.7] | Loss=0.04515 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.818 | L2-Norm(final)=10.378 | 4780.6 samples/s | 74.7 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04344 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.858 | L2-Norm(final)=10.376 | 4762.5 samples/s | 74.4 steps/s
[Step=11300 Epoch=55.1] | Loss=0.04188 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.896 | L2-Norm(final)=10.374 | 5525.4 samples/s | 86.3 steps/s
[Step=11350 Epoch=55.4] | Loss=0.04049 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.932 | L2-Norm(final)=10.373 | 2695.6 samples/s | 42.1 steps/s
[Step=11400 Epoch=55.6] | Loss=0.03932 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.967 | L2-Norm(final)=10.371 | 4724.1 samples/s | 73.8 steps/s
[Step=11450 Epoch=55.9] | Loss=0.03803 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.002 | L2-Norm(final)=10.369 | 4756.5 samples/s | 74.3 steps/s
[Step=11500 Epoch=56.1] | Loss=0.03736 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.036 | L2-Norm(final)=10.367 | 5175.9 samples/s | 80.9 steps/s
[Step=11550 Epoch=56.4] | Loss=0.03684 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.071 | L2-Norm(final)=10.364 | 2822.3 samples/s | 44.1 steps/s
[Step=11600 Epoch=56.6] | Loss=0.03597 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.105 | L2-Norm(final)=10.361 | 4679.4 samples/s | 73.1 steps/s
[Step=11650 Epoch=56.8] | Loss=0.03546 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.137 | L2-Norm(final)=10.358 | 4743.2 samples/s | 74.1 steps/s
[Step=11700 Epoch=57.1] | Loss=0.03482 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.170 | L2-Norm(final)=10.355 | 4859.0 samples/s | 75.9 steps/s
[Step=11750 Epoch=57.3] | Loss=0.03418 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.202 | L2-Norm(final)=10.353 | 2928.0 samples/s | 45.8 steps/s
[Step=11800 Epoch=57.6] | Loss=0.03331 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.233 | L2-Norm(final)=10.352 | 4695.2 samples/s | 73.4 steps/s
[Step=11850 Epoch=57.8] | Loss=0.03267 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.262 | L2-Norm(final)=10.350 | 4749.1 samples/s | 74.2 steps/s
[Step=11900 Epoch=58.1] | Loss=0.03199 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.290 | L2-Norm(final)=10.349 | 4866.7 samples/s | 76.0 steps/s
[Step=11950 Epoch=58.3] | Loss=0.03120 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.317 | L2-Norm(final)=10.348 | 2882.3 samples/s | 45.0 steps/s
[Step=12000 Epoch=58.6] | Loss=0.03056 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.343 | L2-Norm(final)=10.347 | 4748.9 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step12000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=39.0] | Loss=0.16039 | Reg=0.00176 | acc=0.9062 | L2-Norm=13.261 | L2-Norm(final)=7.960 | 7342.9 samples/s | 114.7 steps/s
[Step=8050 Epoch=39.3] | Loss=0.12108 | Reg=0.00176 | acc=0.8750 | L2-Norm=13.263 | L2-Norm(final)=7.914 | 5159.6 samples/s | 80.6 steps/s
[Step=8100 Epoch=39.5] | Loss=0.11320 | Reg=0.00176 | acc=0.8906 | L2-Norm=13.263 | L2-Norm(final)=7.968 | 5223.9 samples/s | 81.6 steps/s
[Step=8150 Epoch=39.7] | Loss=0.11015 | Reg=0.00176 | acc=0.8906 | L2-Norm=13.264 | L2-Norm(final)=8.059 | 5488.2 samples/s | 85.8 steps/s
[Step=8200 Epoch=40.0] | Loss=0.10617 | Reg=0.00176 | acc=0.9688 | L2-Norm=13.264 | L2-Norm(final)=8.152 | 8579.6 samples/s | 134.1 steps/s
[Step=8250 Epoch=40.2] | Loss=0.10627 | Reg=0.00176 | acc=0.8906 | L2-Norm=13.264 | L2-Norm(final)=8.238 | 2667.1 samples/s | 41.7 steps/s
[Step=8300 Epoch=40.5] | Loss=0.10493 | Reg=0.00176 | acc=0.9219 | L2-Norm=13.264 | L2-Norm(final)=8.324 | 5633.5 samples/s | 88.0 steps/s
[Step=8350 Epoch=40.7] | Loss=0.10463 | Reg=0.00176 | acc=0.8906 | L2-Norm=13.264 | L2-Norm(final)=8.407 | 5568.7 samples/s | 87.0 steps/s
[Step=8400 Epoch=41.0] | Loss=0.10383 | Reg=0.00176 | acc=0.9219 | L2-Norm=13.264 | L2-Norm(final)=8.488 | 7557.7 samples/s | 118.1 steps/s
[Step=8450 Epoch=41.2] | Loss=0.10265 | Reg=0.00176 | acc=0.9219 | L2-Norm=13.264 | L2-Norm(final)=8.567 | 2782.2 samples/s | 43.5 steps/s
[Step=8500 Epoch=41.5] | Loss=0.10255 | Reg=0.00176 | acc=0.9375 | L2-Norm=13.264 | L2-Norm(final)=8.645 | 5599.2 samples/s | 87.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=41.5] | Loss=0.06655 | Reg=0.00176 | acc=0.9531 | L2-Norm=13.264 | L2-Norm(final)=9.402 | 6839.5 samples/s | 106.9 steps/s
[Step=8550 Epoch=41.7] | Loss=0.08616 | Reg=0.00183 | acc=0.9375 | L2-Norm=13.527 | L2-Norm(final)=9.406 | 4426.1 samples/s | 69.2 steps/s
[Step=8600 Epoch=41.9] | Loss=0.08229 | Reg=0.00190 | acc=0.9531 | L2-Norm=13.783 | L2-Norm(final)=9.378 | 4785.6 samples/s | 74.8 steps/s
[Step=8650 Epoch=42.2] | Loss=0.08011 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.955 | L2-Norm(final)=9.365 | 4734.2 samples/s | 74.0 steps/s
[Step=8700 Epoch=42.4] | Loss=0.07415 | Reg=0.00198 | acc=0.9531 | L2-Norm=14.082 | L2-Norm(final)=9.353 | 6891.7 samples/s | 107.7 steps/s
[Step=8750 Epoch=42.7] | Loss=0.06420 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.180 | L2-Norm(final)=9.350 | 2510.7 samples/s | 39.2 steps/s
[Step=8800 Epoch=42.9] | Loss=0.06151 | Reg=0.00203 | acc=0.9531 | L2-Norm=14.257 | L2-Norm(final)=9.346 | 4654.0 samples/s | 72.7 steps/s
[Step=8850 Epoch=43.2] | Loss=0.05838 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.327 | L2-Norm(final)=9.342 | 4798.4 samples/s | 75.0 steps/s
[Step=8900 Epoch=43.4] | Loss=0.05602 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.392 | L2-Norm(final)=9.338 | 6217.8 samples/s | 97.2 steps/s
[Step=8950 Epoch=43.6] | Loss=0.05305 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.455 | L2-Norm(final)=9.336 | 2565.4 samples/s | 40.1 steps/s
[Step=9000 Epoch=43.9] | Loss=0.04984 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.513 | L2-Norm(final)=9.335 | 4837.9 samples/s | 75.6 steps/s
[Step=9050 Epoch=44.1] | Loss=0.04761 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.564 | L2-Norm(final)=9.335 | 4705.6 samples/s | 73.5 steps/s
[Step=9100 Epoch=44.4] | Loss=0.04591 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.611 | L2-Norm(final)=9.334 | 5716.5 samples/s | 89.3 steps/s
[Step=9150 Epoch=44.6] | Loss=0.04360 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.656 | L2-Norm(final)=9.333 | 2667.0 samples/s | 41.7 steps/s
[Step=9200 Epoch=44.9] | Loss=0.04164 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.697 | L2-Norm(final)=9.334 | 4783.0 samples/s | 74.7 steps/s
[Step=9250 Epoch=45.1] | Loss=0.04016 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.735 | L2-Norm(final)=9.335 | 4740.0 samples/s | 74.1 steps/s
[Step=9300 Epoch=45.4] | Loss=0.03890 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.771 | L2-Norm(final)=9.335 | 5245.5 samples/s | 82.0 steps/s
[Step=9350 Epoch=45.6] | Loss=0.03731 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.806 | L2-Norm(final)=9.336 | 2751.5 samples/s | 43.0 steps/s
[Step=9400 Epoch=45.8] | Loss=0.03608 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.839 | L2-Norm(final)=9.338 | 4785.3 samples/s | 74.8 steps/s
[Step=9450 Epoch=46.1] | Loss=0.03545 | Reg=0.00221 | acc=0.9531 | L2-Norm=14.871 | L2-Norm(final)=9.339 | 4755.0 samples/s | 74.3 steps/s
[Step=9500 Epoch=46.3] | Loss=0.03461 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.903 | L2-Norm(final)=9.339 | 4898.7 samples/s | 76.5 steps/s
[Step=9550 Epoch=46.6] | Loss=0.03369 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.934 | L2-Norm(final)=9.339 | 2889.0 samples/s | 45.1 steps/s
[Step=9600 Epoch=46.8] | Loss=0.03271 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.965 | L2-Norm(final)=9.340 | 4820.5 samples/s | 75.3 steps/s
[Step=9650 Epoch=47.1] | Loss=0.03220 | Reg=0.00225 | acc=0.9688 | L2-Norm=14.997 | L2-Norm(final)=9.340 | 4764.0 samples/s | 74.4 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03155 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.029 | L2-Norm(final)=9.341 | 4731.2 samples/s | 73.9 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03111 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.061 | L2-Norm(final)=9.341 | 2989.9 samples/s | 46.7 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03048 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.093 | L2-Norm(final)=9.341 | 4699.3 samples/s | 73.4 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02996 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.125 | L2-Norm(final)=9.341 | 4819.7 samples/s | 75.3 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02959 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.156 | L2-Norm(final)=9.341 | 4726.7 samples/s | 73.9 steps/s
[Step=9950 Epoch=48.5] | Loss=0.02907 | Reg=0.00231 | acc=0.9688 | L2-Norm=15.187 | L2-Norm(final)=9.340 | 2962.3 samples/s | 46.3 steps/s
[Step=10000 Epoch=48.8] | Loss=0.02858 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.217 | L2-Norm(final)=9.340 | 4749.4 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step10000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=39.2] | Loss=0.10139 | Reg=0.00176 | acc=0.9062 | L2-Norm=13.261 | L2-Norm(final)=10.013 | 7307.3 samples/s | 114.2 steps/s
[Step=8050 Epoch=39.5] | Loss=0.23062 | Reg=0.00176 | acc=0.7656 | L2-Norm=13.273 | L2-Norm(final)=9.798 | 4830.0 samples/s | 75.5 steps/s
[Step=8100 Epoch=39.7] | Loss=0.18799 | Reg=0.00176 | acc=0.9219 | L2-Norm=13.275 | L2-Norm(final)=9.719 | 5648.0 samples/s | 88.2 steps/s
[Step=8150 Epoch=40.0] | Loss=0.17084 | Reg=0.00176 | acc=0.8281 | L2-Norm=13.276 | L2-Norm(final)=9.748 | 5456.4 samples/s | 85.3 steps/s
[Step=8200 Epoch=40.2] | Loss=0.16004 | Reg=0.00176 | acc=0.9375 | L2-Norm=13.276 | L2-Norm(final)=9.819 | 8997.8 samples/s | 140.6 steps/s
[Step=8250 Epoch=40.5] | Loss=0.15398 | Reg=0.00176 | acc=0.9219 | L2-Norm=13.276 | L2-Norm(final)=9.900 | 2638.0 samples/s | 41.2 steps/s
[Step=8300 Epoch=40.7] | Loss=0.15035 | Reg=0.00176 | acc=0.9375 | L2-Norm=13.276 | L2-Norm(final)=9.989 | 5546.7 samples/s | 86.7 steps/s
[Step=8350 Epoch=40.9] | Loss=0.14820 | Reg=0.00176 | acc=0.8906 | L2-Norm=13.276 | L2-Norm(final)=10.078 | 5691.7 samples/s | 88.9 steps/s
[Step=8400 Epoch=41.2] | Loss=0.14584 | Reg=0.00176 | acc=0.9219 | L2-Norm=13.276 | L2-Norm(final)=10.169 | 7967.8 samples/s | 124.5 steps/s
[Step=8450 Epoch=41.4] | Loss=0.14388 | Reg=0.00176 | acc=0.9375 | L2-Norm=13.277 | L2-Norm(final)=10.259 | 2738.1 samples/s | 42.8 steps/s
[Step=8500 Epoch=41.7] | Loss=0.14322 | Reg=0.00176 | acc=0.8750 | L2-Norm=13.277 | L2-Norm(final)=10.348 | 5509.9 samples/s | 86.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=41.7] | Loss=0.17879 | Reg=0.00176 | acc=0.8125 | L2-Norm=13.277 | L2-Norm(final)=11.225 | 7907.0 samples/s | 123.5 steps/s
[Step=8550 Epoch=41.9] | Loss=0.09511 | Reg=0.00186 | acc=0.8906 | L2-Norm=13.619 | L2-Norm(final)=11.245 | 4058.6 samples/s | 63.4 steps/s
[Step=8600 Epoch=42.2] | Loss=0.08783 | Reg=0.00193 | acc=0.9219 | L2-Norm=13.877 | L2-Norm(final)=11.215 | 4740.2 samples/s | 74.1 steps/s
[Step=8650 Epoch=42.4] | Loss=0.07976 | Reg=0.00197 | acc=0.9375 | L2-Norm=14.030 | L2-Norm(final)=11.196 | 4815.8 samples/s | 75.2 steps/s
[Step=8700 Epoch=42.7] | Loss=0.07430 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.151 | L2-Norm(final)=11.183 | 6903.1 samples/s | 107.9 steps/s
[Step=8750 Epoch=42.9] | Loss=0.06730 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.251 | L2-Norm(final)=11.173 | 2448.8 samples/s | 38.3 steps/s
[Step=8800 Epoch=43.2] | Loss=0.06313 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.337 | L2-Norm(final)=11.166 | 4779.7 samples/s | 74.7 steps/s
[Step=8850 Epoch=43.4] | Loss=0.06211 | Reg=0.00208 | acc=0.9375 | L2-Norm=14.422 | L2-Norm(final)=11.155 | 4707.6 samples/s | 73.6 steps/s
[Step=8900 Epoch=43.6] | Loss=0.05877 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.504 | L2-Norm(final)=11.145 | 6672.5 samples/s | 104.3 steps/s
[Step=8950 Epoch=43.9] | Loss=0.05482 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.576 | L2-Norm(final)=11.138 | 2510.5 samples/s | 39.2 steps/s
[Step=9000 Epoch=44.1] | Loss=0.05174 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.639 | L2-Norm(final)=11.134 | 4708.0 samples/s | 73.6 steps/s
[Step=9050 Epoch=44.4] | Loss=0.04884 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.696 | L2-Norm(final)=11.130 | 4762.4 samples/s | 74.4 steps/s
[Step=9100 Epoch=44.6] | Loss=0.04687 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.748 | L2-Norm(final)=11.126 | 6198.2 samples/s | 96.8 steps/s
[Step=9150 Epoch=44.9] | Loss=0.04466 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.795 | L2-Norm(final)=11.123 | 2558.4 samples/s | 40.0 steps/s
[Step=9200 Epoch=45.1] | Loss=0.04327 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.840 | L2-Norm(final)=11.120 | 4824.5 samples/s | 75.4 steps/s
[Step=9250 Epoch=45.4] | Loss=0.04158 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.881 | L2-Norm(final)=11.117 | 4688.3 samples/s | 73.3 steps/s
[Step=9300 Epoch=45.6] | Loss=0.04039 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.918 | L2-Norm(final)=11.115 | 5841.4 samples/s | 91.3 steps/s
[Step=9350 Epoch=45.9] | Loss=0.03901 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.955 | L2-Norm(final)=11.112 | 2645.4 samples/s | 41.3 steps/s
[Step=9400 Epoch=46.1] | Loss=0.03792 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.988 | L2-Norm(final)=11.109 | 4749.5 samples/s | 74.2 steps/s
[Step=9450 Epoch=46.3] | Loss=0.03681 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.020 | L2-Norm(final)=11.107 | 4670.8 samples/s | 73.0 steps/s
[Step=9500 Epoch=46.6] | Loss=0.03563 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.049 | L2-Norm(final)=11.105 | 5491.8 samples/s | 85.8 steps/s
[Step=9550 Epoch=46.8] | Loss=0.03449 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.078 | L2-Norm(final)=11.104 | 2728.7 samples/s | 42.6 steps/s
[Step=9600 Epoch=47.1] | Loss=0.03345 | Reg=0.00228 | acc=0.9531 | L2-Norm=15.105 | L2-Norm(final)=11.104 | 4730.2 samples/s | 73.9 steps/s
[Step=9650 Epoch=47.3] | Loss=0.03270 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.132 | L2-Norm(final)=11.103 | 4739.3 samples/s | 74.1 steps/s
[Step=9700 Epoch=47.6] | Loss=0.03218 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.160 | L2-Norm(final)=11.101 | 5204.4 samples/s | 81.3 steps/s
[Step=9750 Epoch=47.8] | Loss=0.03158 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.186 | L2-Norm(final)=11.100 | 2777.0 samples/s | 43.4 steps/s
[Step=9800 Epoch=48.1] | Loss=0.03099 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.211 | L2-Norm(final)=11.099 | 4773.5 samples/s | 74.6 steps/s
[Step=9850 Epoch=48.3] | Loss=0.03037 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.236 | L2-Norm(final)=11.097 | 4818.4 samples/s | 75.3 steps/s
[Step=9900 Epoch=48.5] | Loss=0.02988 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.261 | L2-Norm(final)=11.096 | 4949.3 samples/s | 77.3 steps/s
[Step=9950 Epoch=48.8] | Loss=0.02935 | Reg=0.00234 | acc=0.9531 | L2-Norm=15.288 | L2-Norm(final)=11.095 | 2863.0 samples/s | 44.7 steps/s
[Step=10000 Epoch=49.0] | Loss=0.02888 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.314 | L2-Norm(final)=11.094 | 4774.6 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step10000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=75.8] | Loss=0.01188 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.261 | L2-Norm(final)=11.623 | 7753.0 samples/s | 121.1 steps/s
[Step=8050 Epoch=76.3] | Loss=0.01274 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.250 | L2-Norm(final)=11.626 | 4100.0 samples/s | 64.1 steps/s
[Step=8100 Epoch=76.8] | Loss=0.01251 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.249 | L2-Norm(final)=11.647 | 8146.1 samples/s | 127.3 steps/s
[Step=8150 Epoch=77.2] | Loss=0.01227 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=11.673 | 2577.7 samples/s | 40.3 steps/s
[Step=8200 Epoch=77.7] | Loss=0.01174 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.248 | L2-Norm(final)=11.720 | 7200.4 samples/s | 112.5 steps/s
[Step=8250 Epoch=78.2] | Loss=0.01179 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=11.775 | 2665.6 samples/s | 41.7 steps/s
[Step=8300 Epoch=78.6] | Loss=0.01171 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=11.836 | 6561.3 samples/s | 102.5 steps/s
[Step=8350 Epoch=79.1] | Loss=0.01164 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=11.898 | 2812.1 samples/s | 43.9 steps/s
[Step=8400 Epoch=79.6] | Loss=0.01161 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.248 | L2-Norm(final)=11.962 | 5827.5 samples/s | 91.1 steps/s
[Step=8450 Epoch=80.1] | Loss=0.01146 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=12.024 | 2942.1 samples/s | 46.0 steps/s
[Step=8500 Epoch=80.5] | Loss=0.01127 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.248 | L2-Norm(final)=12.086 | 5408.0 samples/s | 84.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=80.6] | Loss=0.00281 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.247 | L2-Norm(final)=12.701 | 7292.9 samples/s | 114.0 steps/s
[Step=8550 Epoch=81.0] | Loss=0.03153 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.562 | L2-Norm(final)=12.686 | 3951.1 samples/s | 61.7 steps/s
[Step=8600 Epoch=81.5] | Loss=0.02011 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.962 | L2-Norm(final)=12.627 | 6616.7 samples/s | 103.4 steps/s
[Step=8650 Epoch=82.0] | Loss=0.01477 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.102 | L2-Norm(final)=12.611 | 2365.8 samples/s | 37.0 steps/s
[Step=8700 Epoch=82.4] | Loss=0.01128 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.152 | L2-Norm(final)=12.607 | 5923.9 samples/s | 92.6 steps/s
[Step=8750 Epoch=82.9] | Loss=0.00904 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.160 | L2-Norm(final)=12.606 | 2476.2 samples/s | 38.7 steps/s
[Step=8800 Epoch=83.4] | Loss=0.00754 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.148 | L2-Norm(final)=12.606 | 5459.2 samples/s | 85.3 steps/s
[Step=8850 Epoch=83.9] | Loss=0.00646 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.124 | L2-Norm(final)=12.606 | 2575.2 samples/s | 40.2 steps/s
[Step=8900 Epoch=84.3] | Loss=0.00566 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.094 | L2-Norm(final)=12.606 | 5027.9 samples/s | 78.6 steps/s
[Step=8950 Epoch=84.8] | Loss=0.00503 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.061 | L2-Norm(final)=12.607 | 2706.0 samples/s | 42.3 steps/s
[Step=9000 Epoch=85.3] | Loss=0.00453 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.025 | L2-Norm(final)=12.607 | 4540.2 samples/s | 70.9 steps/s
[Step=9050 Epoch=85.8] | Loss=0.00412 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.989 | L2-Norm(final)=12.608 | 2775.9 samples/s | 43.4 steps/s
[Step=9100 Epoch=86.2] | Loss=0.00378 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.951 | L2-Norm(final)=12.609 | 4558.0 samples/s | 71.2 steps/s
[Step=9150 Epoch=86.7] | Loss=0.00349 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.914 | L2-Norm(final)=12.609 | 2850.4 samples/s | 44.5 steps/s
[Step=9200 Epoch=87.2] | Loss=0.00324 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.877 | L2-Norm(final)=12.610 | 4463.4 samples/s | 69.7 steps/s
[Step=9250 Epoch=87.7] | Loss=0.00302 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=12.611 | 2861.0 samples/s | 44.7 steps/s
[Step=9300 Epoch=88.1] | Loss=0.00283 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.802 | L2-Norm(final)=12.612 | 4542.1 samples/s | 71.0 steps/s
[Step=9350 Epoch=88.6] | Loss=0.00267 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.765 | L2-Norm(final)=12.612 | 2933.3 samples/s | 45.8 steps/s
[Step=9400 Epoch=89.1] | Loss=0.00252 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.729 | L2-Norm(final)=12.613 | 4431.3 samples/s | 69.2 steps/s
[Step=9450 Epoch=89.5] | Loss=0.00239 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.693 | L2-Norm(final)=12.614 | 6780.5 samples/s | 105.9 steps/s
[Step=9500 Epoch=90.0] | Loss=0.00227 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.657 | L2-Norm(final)=12.614 | 2374.3 samples/s | 37.1 steps/s
[Step=9550 Epoch=90.5] | Loss=0.00216 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.622 | L2-Norm(final)=12.615 | 6082.9 samples/s | 95.0 steps/s
[Step=9600 Epoch=91.0] | Loss=0.00206 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.587 | L2-Norm(final)=12.616 | 2445.5 samples/s | 38.2 steps/s
[Step=9650 Epoch=91.4] | Loss=0.00197 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.552 | L2-Norm(final)=12.617 | 5609.0 samples/s | 87.6 steps/s
[Step=9700 Epoch=91.9] | Loss=0.00189 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=12.617 | 2607.0 samples/s | 40.7 steps/s
[Step=9750 Epoch=92.4] | Loss=0.00182 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=12.618 | 4924.0 samples/s | 76.9 steps/s
[Step=9800 Epoch=92.9] | Loss=0.00175 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.450 | L2-Norm(final)=12.619 | 2643.3 samples/s | 41.3 steps/s
[Step=9850 Epoch=93.3] | Loss=0.00168 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=12.619 | 4772.0 samples/s | 74.6 steps/s
[Step=9900 Epoch=93.8] | Loss=0.00162 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.384 | L2-Norm(final)=12.620 | 2727.9 samples/s | 42.6 steps/s
[Step=9950 Epoch=94.3] | Loss=0.00157 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=12.621 | 4555.6 samples/s | 71.2 steps/s
[Step=10000 Epoch=94.8] | Loss=0.00151 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.319 | L2-Norm(final)=12.621 | 2854.2 samples/s | 44.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step10000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=76.3] | Loss=0.04143 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.261 | L2-Norm(final)=9.803 | 6882.3 samples/s | 107.5 steps/s
[Step=8050 Epoch=76.7] | Loss=0.04295 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.250 | L2-Norm(final)=9.749 | 4658.5 samples/s | 72.8 steps/s
[Step=8100 Epoch=77.2] | Loss=0.03607 | Reg=0.00176 | acc=0.9531 | L2-Norm=13.249 | L2-Norm(final)=9.732 | 8352.4 samples/s | 130.5 steps/s
[Step=8150 Epoch=77.7] | Loss=0.03148 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=9.765 | 2534.2 samples/s | 39.6 steps/s
[Step=8200 Epoch=78.2] | Loss=0.02883 | Reg=0.00176 | acc=0.9688 | L2-Norm=13.248 | L2-Norm(final)=9.831 | 7621.5 samples/s | 119.1 steps/s
[Step=8250 Epoch=78.6] | Loss=0.02678 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=9.916 | 2634.7 samples/s | 41.2 steps/s
[Step=8300 Epoch=79.1] | Loss=0.02560 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.248 | L2-Norm(final)=10.011 | 6777.8 samples/s | 105.9 steps/s
[Step=8350 Epoch=79.6] | Loss=0.02467 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=10.113 | 2711.8 samples/s | 42.4 steps/s
[Step=8400 Epoch=80.1] | Loss=0.02384 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=10.217 | 6291.2 samples/s | 98.3 steps/s
[Step=8450 Epoch=80.5] | Loss=0.02318 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.248 | L2-Norm(final)=10.321 | 2831.0 samples/s | 44.2 steps/s
[Step=8500 Epoch=81.0] | Loss=0.02277 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=10.423 | 5812.8 samples/s | 90.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=81.0] | Loss=0.00853 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=11.431 | 6667.7 samples/s | 104.2 steps/s
[Step=8550 Epoch=81.5] | Loss=0.02629 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.763 | L2-Norm(final)=11.430 | 4195.7 samples/s | 65.6 steps/s
[Step=8600 Epoch=82.0] | Loss=0.01916 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.153 | L2-Norm(final)=11.402 | 6463.3 samples/s | 101.0 steps/s
[Step=8650 Epoch=82.4] | Loss=0.01331 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.290 | L2-Norm(final)=11.397 | 2393.0 samples/s | 37.4 steps/s
[Step=8700 Epoch=82.9] | Loss=0.01020 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.336 | L2-Norm(final)=11.398 | 5970.6 samples/s | 93.3 steps/s
[Step=8750 Epoch=83.4] | Loss=0.00818 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.345 | L2-Norm(final)=11.401 | 2446.8 samples/s | 38.2 steps/s
[Step=8800 Epoch=83.9] | Loss=0.00683 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.335 | L2-Norm(final)=11.405 | 5670.2 samples/s | 88.6 steps/s
[Step=8850 Epoch=84.3] | Loss=0.00586 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.316 | L2-Norm(final)=11.408 | 2539.7 samples/s | 39.7 steps/s
[Step=8900 Epoch=84.8] | Loss=0.00514 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.290 | L2-Norm(final)=11.411 | 5259.4 samples/s | 82.2 steps/s
[Step=8950 Epoch=85.3] | Loss=0.00457 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.261 | L2-Norm(final)=11.414 | 2629.9 samples/s | 41.1 steps/s
[Step=9000 Epoch=85.8] | Loss=0.00411 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.229 | L2-Norm(final)=11.416 | 4909.9 samples/s | 76.7 steps/s
[Step=9050 Epoch=86.3] | Loss=0.00374 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.197 | L2-Norm(final)=11.418 | 2684.7 samples/s | 41.9 steps/s
[Step=9100 Epoch=86.7] | Loss=0.00343 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.163 | L2-Norm(final)=11.421 | 4663.2 samples/s | 72.9 steps/s
[Step=9150 Epoch=87.2] | Loss=0.00317 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.129 | L2-Norm(final)=11.423 | 2798.8 samples/s | 43.7 steps/s
[Step=9200 Epoch=87.7] | Loss=0.00294 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.094 | L2-Norm(final)=11.425 | 4573.2 samples/s | 71.5 steps/s
[Step=9250 Epoch=88.2] | Loss=0.00275 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.060 | L2-Norm(final)=11.426 | 2854.3 samples/s | 44.6 steps/s
[Step=9300 Epoch=88.6] | Loss=0.00258 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.025 | L2-Norm(final)=11.428 | 4468.7 samples/s | 69.8 steps/s
[Step=9350 Epoch=89.1] | Loss=0.00243 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.991 | L2-Norm(final)=11.430 | 2925.1 samples/s | 45.7 steps/s
[Step=9400 Epoch=89.6] | Loss=0.00229 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.956 | L2-Norm(final)=11.432 | 4385.9 samples/s | 68.5 steps/s
[Step=9450 Epoch=90.1] | Loss=0.00217 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.922 | L2-Norm(final)=11.433 | 2921.2 samples/s | 45.6 steps/s
[Step=9500 Epoch=90.5] | Loss=0.00207 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.888 | L2-Norm(final)=11.435 | 4366.2 samples/s | 68.2 steps/s
[Step=9550 Epoch=91.0] | Loss=0.00197 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.854 | L2-Norm(final)=11.436 | 7321.0 samples/s | 114.4 steps/s
[Step=9600 Epoch=91.5] | Loss=0.00188 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.820 | L2-Norm(final)=11.438 | 2307.7 samples/s | 36.1 steps/s
[Step=9650 Epoch=92.0] | Loss=0.00180 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.787 | L2-Norm(final)=11.439 | 6676.1 samples/s | 104.3 steps/s
[Step=9700 Epoch=92.4] | Loss=0.00172 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.754 | L2-Norm(final)=11.441 | 2367.1 samples/s | 37.0 steps/s
[Step=9750 Epoch=92.9] | Loss=0.00165 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.721 | L2-Norm(final)=11.442 | 6134.1 samples/s | 95.8 steps/s
[Step=9800 Epoch=93.4] | Loss=0.00159 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.688 | L2-Norm(final)=11.443 | 2457.2 samples/s | 38.4 steps/s
[Step=9850 Epoch=93.9] | Loss=0.00153 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.655 | L2-Norm(final)=11.445 | 5655.5 samples/s | 88.4 steps/s
[Step=9900 Epoch=94.4] | Loss=0.00148 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.623 | L2-Norm(final)=11.446 | 2530.3 samples/s | 39.5 steps/s
[Step=9950 Epoch=94.8] | Loss=0.00143 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=11.447 | 5214.1 samples/s | 81.5 steps/s
[Step=10000 Epoch=95.3] | Loss=0.00138 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.558 | L2-Norm(final)=11.449 | 2639.5 samples/s | 41.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.13386 | acc=0.9330 | tpr=0.9410 | fpr=0.0845 | 6073.2 samples/s | 23.7 steps/s
Avg test loss: 0.14189, Avg test acc: 0.92848, Avg tpr: 0.93682, Avg fpr: 0.08986, total FA: 701

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14985 | acc=0.9369 | tpr=0.9654 | fpr=0.1251 | 6047.1 samples/s | 23.6 steps/s
Avg test loss: 0.15362, Avg test acc: 0.93569, Avg tpr: 0.96415, Avg fpr: 0.12691, total FA: 990

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.15329 | acc=0.9373 | tpr=0.9524 | fpr=0.0956 | 5916.7 samples/s | 23.1 steps/s
Avg test loss: 0.15689, Avg test acc: 0.93529, Avg tpr: 0.95005, Avg fpr: 0.09717, total FA: 758

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.13291 | acc=0.9371 | tpr=0.9571 | fpr=0.1063 | 5971.9 samples/s | 23.3 steps/s
Avg test loss: 0.14036, Avg test acc: 0.93585, Avg tpr: 0.95623, Avg fpr: 0.10896, total FA: 850

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.16531 | acc=0.9237 | tpr=0.9199 | fpr=0.0681 | 6109.0 samples/s | 23.9 steps/s
Avg test loss: 0.16825, Avg test acc: 0.92203, Avg tpr: 0.91694, Avg fpr: 0.06679, total FA: 521

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.03444 | acc=0.3173 | tpr=0.0151 | fpr=0.0263 | 6161.0 samples/s | 24.1 steps/s
Avg test loss: 4.03942, Avg test acc: 0.31529, Avg tpr: 0.01550, Avg fpr: 0.02538, total FA: 198

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.21096 | acc=0.3184 | tpr=0.0104 | fpr=0.0129 | 5884.7 samples/s | 23.0 steps/s
Avg test loss: 5.22606, Avg test acc: 0.31541, Avg tpr: 0.00985, Avg fpr: 0.01256, total FA: 98

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.13446 | acc=0.3227 | tpr=0.0330 | fpr=0.0481 | 6052.0 samples/s | 23.6 steps/s
Avg test loss: 4.14066, Avg test acc: 0.32086, Avg tpr: 0.03322, Avg fpr: 0.04653, total FA: 363

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.57220 | acc=0.3091 | tpr=0.0193 | fpr=0.0617 | 6145.4 samples/s | 24.0 steps/s
Avg test loss: 4.58498, Avg test acc: 0.30716, Avg tpr: 0.01970, Avg fpr: 0.06063, total FA: 473

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=3.91120 | acc=0.3131 | tpr=0.0135 | fpr=0.0362 | 6016.7 samples/s | 23.5 steps/s
Avg test loss: 3.92539, Avg test acc: 0.31160, Avg tpr: 0.01370, Avg fpr: 0.03320, total FA: 259

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.13482 | acc=0.1384 | tpr=0.8097 | fpr=0.8737 | 5790.4 samples/s | 22.6 steps/s
[Step= 100] | Loss=5.11966 | acc=0.1395 | tpr=0.7996 | fpr=0.8729 | 7926.2 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.12125 | acc=0.1392 | tpr=0.8026 | fpr=0.8730 | 8629.5 samples/s | 33.7 steps/s
[Step= 200] | Loss=5.11267 | acc=0.1398 | tpr=0.7956 | fpr=0.8721 | 7787.6 samples/s | 30.4 steps/s
[Step= 250] | Loss=5.11932 | acc=0.1398 | tpr=0.7956 | fpr=0.8722 | 7939.0 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.11211 | acc=0.1400 | tpr=0.7956 | fpr=0.8719 | 8317.7 samples/s | 32.5 steps/s
[Step= 350] | Loss=5.11481 | acc=0.1398 | tpr=0.7996 | fpr=0.8722 | 7766.4 samples/s | 30.3 steps/s
[Step= 400] | Loss=5.11526 | acc=0.1399 | tpr=0.7998 | fpr=0.8721 | 6215.0 samples/s | 24.3 steps/s
[Step= 450] | Loss=5.11904 | acc=0.1393 | tpr=0.7970 | fpr=0.8727 | 7995.4 samples/s | 31.2 steps/s
[Step= 500] | Loss=5.11711 | acc=0.1392 | tpr=0.8009 | fpr=0.8727 | 8122.4 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.11749 | acc=0.1393 | tpr=0.7998 | fpr=0.8727 | 9652.7 samples/s | 37.7 steps/s
Avg test loss: 5.11835, Avg test acc: 0.13921, Avg tpr: 0.80032, Avg fpr: 0.87280, total FA: 121187

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.16041 | acc=0.1341 | tpr=0.7611 | fpr=0.8771 | 5776.6 samples/s | 22.6 steps/s
[Step= 100] | Loss=5.14818 | acc=0.1340 | tpr=0.7356 | fpr=0.8772 | 8176.6 samples/s | 31.9 steps/s
[Step= 150] | Loss=5.13932 | acc=0.1333 | tpr=0.7219 | fpr=0.8775 | 8135.4 samples/s | 31.8 steps/s
[Step= 200] | Loss=5.14301 | acc=0.1331 | tpr=0.7137 | fpr=0.8775 | 8342.0 samples/s | 32.6 steps/s
[Step= 250] | Loss=5.14679 | acc=0.1330 | tpr=0.7109 | fpr=0.8776 | 7676.4 samples/s | 30.0 steps/s
[Step= 300] | Loss=5.13838 | acc=0.1331 | tpr=0.7113 | fpr=0.8775 | 8454.4 samples/s | 33.0 steps/s
[Step= 350] | Loss=5.14555 | acc=0.1326 | tpr=0.7082 | fpr=0.8779 | 5663.9 samples/s | 22.1 steps/s
[Step= 400] | Loss=5.14426 | acc=0.1332 | tpr=0.7095 | fpr=0.8773 | 7857.2 samples/s | 30.7 steps/s
[Step= 450] | Loss=5.14810 | acc=0.1331 | tpr=0.7103 | fpr=0.8774 | 8142.2 samples/s | 31.8 steps/s
[Step= 500] | Loss=5.14768 | acc=0.1330 | tpr=0.7106 | fpr=0.8774 | 8244.7 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.15266 | acc=0.1331 | tpr=0.7123 | fpr=0.8774 | 9995.0 samples/s | 39.0 steps/s
Avg test loss: 5.15279, Avg test acc: 0.13300, Avg tpr: 0.71236, Avg fpr: 0.87753, total FA: 121843

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.79943 | acc=0.1257 | tpr=0.8584 | fpr=0.8875 | 6122.2 samples/s | 23.9 steps/s
[Step= 100] | Loss=5.78174 | acc=0.1249 | tpr=0.8337 | fpr=0.8883 | 7527.8 samples/s | 29.4 steps/s
[Step= 150] | Loss=5.79062 | acc=0.1260 | tpr=0.8314 | fpr=0.8870 | 7895.3 samples/s | 30.8 steps/s
[Step= 200] | Loss=5.78785 | acc=0.1259 | tpr=0.8240 | fpr=0.8868 | 8034.0 samples/s | 31.4 steps/s
[Step= 250] | Loss=5.79872 | acc=0.1258 | tpr=0.8236 | fpr=0.8869 | 8135.0 samples/s | 31.8 steps/s
[Step= 300] | Loss=5.79958 | acc=0.1261 | tpr=0.8291 | fpr=0.8868 | 8302.4 samples/s | 32.4 steps/s
[Step= 350] | Loss=5.79932 | acc=0.1265 | tpr=0.8353 | fpr=0.8864 | 5852.7 samples/s | 22.9 steps/s
[Step= 400] | Loss=5.79914 | acc=0.1266 | tpr=0.8337 | fpr=0.8863 | 8373.1 samples/s | 32.7 steps/s
[Step= 450] | Loss=5.80064 | acc=0.1263 | tpr=0.8320 | fpr=0.8865 | 8064.2 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.80127 | acc=0.1265 | tpr=0.8352 | fpr=0.8863 | 8339.6 samples/s | 32.6 steps/s
[Step= 550] | Loss=5.80463 | acc=0.1268 | tpr=0.8353 | fpr=0.8860 | 8972.5 samples/s | 35.0 steps/s
Avg test loss: 5.80440, Avg test acc: 0.12679, Avg tpr: 0.83518, Avg fpr: 0.88609, total FA: 123032

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.04276 | acc=0.1211 | tpr=0.8009 | fpr=0.8911 | 5993.2 samples/s | 23.4 steps/s
[Step= 100] | Loss=6.00997 | acc=0.1218 | tpr=0.8124 | fpr=0.8911 | 8148.1 samples/s | 31.8 steps/s
[Step= 150] | Loss=5.99540 | acc=0.1222 | tpr=0.8055 | fpr=0.8904 | 8257.2 samples/s | 32.3 steps/s
[Step= 200] | Loss=5.99288 | acc=0.1220 | tpr=0.8022 | fpr=0.8904 | 7849.3 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.99480 | acc=0.1216 | tpr=0.8009 | fpr=0.8907 | 7896.8 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.98289 | acc=0.1221 | tpr=0.8029 | fpr=0.8903 | 7265.6 samples/s | 28.4 steps/s
[Step= 350] | Loss=5.98421 | acc=0.1219 | tpr=0.7990 | fpr=0.8904 | 6176.7 samples/s | 24.1 steps/s
[Step= 400] | Loss=5.98411 | acc=0.1219 | tpr=0.7927 | fpr=0.8903 | 7913.8 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.98494 | acc=0.1213 | tpr=0.7965 | fpr=0.8909 | 8571.3 samples/s | 33.5 steps/s
[Step= 500] | Loss=5.98097 | acc=0.1212 | tpr=0.7903 | fpr=0.8909 | 7452.6 samples/s | 29.1 steps/s
[Step= 550] | Loss=5.98651 | acc=0.1215 | tpr=0.7919 | fpr=0.8907 | 10632.7 samples/s | 41.5 steps/s
Avg test loss: 5.98808, Avg test acc: 0.12138, Avg tpr: 0.79239, Avg fpr: 0.89082, total FA: 123688

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.89922 | acc=0.1627 | tpr=0.7080 | fpr=0.8471 | 5933.0 samples/s | 23.2 steps/s
[Step= 100] | Loss=4.88316 | acc=0.1657 | tpr=0.6844 | fpr=0.8440 | 7566.5 samples/s | 29.6 steps/s
[Step= 150] | Loss=4.87701 | acc=0.1667 | tpr=0.6744 | fpr=0.8427 | 8022.5 samples/s | 31.3 steps/s
[Step= 200] | Loss=4.87954 | acc=0.1674 | tpr=0.6710 | fpr=0.8418 | 8050.9 samples/s | 31.4 steps/s
[Step= 250] | Loss=4.87735 | acc=0.1667 | tpr=0.6664 | fpr=0.8424 | 8167.6 samples/s | 31.9 steps/s
[Step= 300] | Loss=4.87023 | acc=0.1665 | tpr=0.6604 | fpr=0.8425 | 5753.6 samples/s | 22.5 steps/s
[Step= 350] | Loss=4.87748 | acc=0.1661 | tpr=0.6587 | fpr=0.8428 | 7938.8 samples/s | 31.0 steps/s
[Step= 400] | Loss=4.87476 | acc=0.1664 | tpr=0.6625 | fpr=0.8426 | 8537.5 samples/s | 33.3 steps/s
[Step= 450] | Loss=4.87823 | acc=0.1658 | tpr=0.6611 | fpr=0.8432 | 8134.4 samples/s | 31.8 steps/s
[Step= 500] | Loss=4.87641 | acc=0.1657 | tpr=0.6612 | fpr=0.8432 | 7802.8 samples/s | 30.5 steps/s
[Step= 550] | Loss=4.87846 | acc=0.1660 | tpr=0.6614 | fpr=0.8430 | 10658.2 samples/s | 41.6 steps/s
Avg test loss: 4.88026, Avg test acc: 0.16592, Avg tpr: 0.66204, Avg fpr: 0.84310, total FA: 117063

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.17220 | acc=0.9580 | tpr=0.9027 | fpr=0.0410 | 5972.8 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.17695 | acc=0.9575 | tpr=0.9168 | fpr=0.0417 | 7506.4 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.17765 | acc=0.9565 | tpr=0.9207 | fpr=0.0428 | 7589.3 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.17578 | acc=0.9572 | tpr=0.9279 | fpr=0.0423 | 8081.8 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.17646 | acc=0.9572 | tpr=0.9258 | fpr=0.0422 | 8578.7 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.17978 | acc=0.9564 | tpr=0.9222 | fpr=0.0430 | 6289.8 samples/s | 24.6 steps/s
[Step= 350] | Loss=0.17854 | acc=0.9564 | tpr=0.9192 | fpr=0.0429 | 7766.2 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.17845 | acc=0.9561 | tpr=0.9130 | fpr=0.0431 | 7818.3 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.18077 | acc=0.9557 | tpr=0.9119 | fpr=0.0435 | 8238.0 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.18098 | acc=0.9555 | tpr=0.9141 | fpr=0.0437 | 7661.1 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.18004 | acc=0.9558 | tpr=0.9136 | fpr=0.0434 | 10725.1 samples/s | 41.9 steps/s
Avg test loss: 0.17973, Avg test acc: 0.95585, Avg tpr: 0.91363, Avg fpr: 0.04339, total FA: 6024

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11033 | acc=0.9687 | tpr=0.8319 | fpr=0.0289 | 5976.2 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.11265 | acc=0.9680 | tpr=0.8571 | fpr=0.0299 | 8146.0 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.11360 | acc=0.9683 | tpr=0.8646 | fpr=0.0298 | 7251.4 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.11358 | acc=0.9686 | tpr=0.8743 | fpr=0.0297 | 8233.4 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.11486 | acc=0.9685 | tpr=0.8716 | fpr=0.0297 | 8709.0 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.11606 | acc=0.9683 | tpr=0.8727 | fpr=0.0299 | 5765.5 samples/s | 22.5 steps/s
[Step= 350] | Loss=0.11540 | acc=0.9686 | tpr=0.8723 | fpr=0.0296 | 8157.4 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.11630 | acc=0.9683 | tpr=0.8693 | fpr=0.0299 | 8195.7 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.11812 | acc=0.9679 | tpr=0.8685 | fpr=0.0303 | 7823.7 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.11748 | acc=0.9679 | tpr=0.8722 | fpr=0.0304 | 7685.1 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.11709 | acc=0.9680 | tpr=0.8679 | fpr=0.0302 | 10568.6 samples/s | 41.3 steps/s
Avg test loss: 0.11695, Avg test acc: 0.96800, Avg tpr: 0.86767, Avg fpr: 0.03018, total FA: 4190

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26713 | acc=0.9463 | tpr=0.9425 | fpr=0.0536 | 5844.0 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.27335 | acc=0.9450 | tpr=0.9574 | fpr=0.0552 | 8586.8 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.28003 | acc=0.9435 | tpr=0.9524 | fpr=0.0567 | 7781.9 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.27906 | acc=0.9434 | tpr=0.9519 | fpr=0.0568 | 8180.6 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.27929 | acc=0.9433 | tpr=0.9459 | fpr=0.0567 | 5921.3 samples/s | 23.1 steps/s
[Step= 300] | Loss=0.28174 | acc=0.9430 | tpr=0.9425 | fpr=0.0570 | 8332.9 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.28091 | acc=0.9429 | tpr=0.9436 | fpr=0.0572 | 7860.9 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.28145 | acc=0.9425 | tpr=0.9431 | fpr=0.0575 | 7466.2 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.28426 | acc=0.9420 | tpr=0.9430 | fpr=0.0581 | 7748.0 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.28518 | acc=0.9417 | tpr=0.9445 | fpr=0.0584 | 8589.1 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.28423 | acc=0.9418 | tpr=0.9451 | fpr=0.0583 | 9974.5 samples/s | 39.0 steps/s
Avg test loss: 0.28382, Avg test acc: 0.94186, Avg tpr: 0.94532, Avg fpr: 0.05821, total FA: 8082

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11000 | acc=0.9665 | tpr=0.8894 | fpr=0.0321 | 6007.0 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.11553 | acc=0.9657 | tpr=0.8891 | fpr=0.0329 | 8082.5 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.11641 | acc=0.9654 | tpr=0.8948 | fpr=0.0333 | 7817.3 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.11562 | acc=0.9655 | tpr=0.8962 | fpr=0.0333 | 8495.8 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.11709 | acc=0.9652 | tpr=0.8934 | fpr=0.0335 | 6236.7 samples/s | 24.4 steps/s
[Step= 300] | Loss=0.11854 | acc=0.9647 | tpr=0.8938 | fpr=0.0340 | 7923.6 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.11831 | acc=0.9646 | tpr=0.8942 | fpr=0.0341 | 7721.3 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.11822 | acc=0.9646 | tpr=0.8917 | fpr=0.0341 | 7863.7 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.11964 | acc=0.9643 | tpr=0.8909 | fpr=0.0344 | 8320.5 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.11934 | acc=0.9643 | tpr=0.8930 | fpr=0.0344 | 7213.6 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.11900 | acc=0.9645 | tpr=0.8934 | fpr=0.0342 | 10253.0 samples/s | 40.1 steps/s
Avg test loss: 0.11895, Avg test acc: 0.96444, Avg tpr: 0.89263, Avg fpr: 0.03425, total FA: 4756

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21303 | acc=0.9535 | tpr=0.8761 | fpr=0.0451 | 5698.1 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.21510 | acc=0.9529 | tpr=0.9083 | fpr=0.0463 | 8121.0 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.22071 | acc=0.9510 | tpr=0.9107 | fpr=0.0482 | 7376.0 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.22102 | acc=0.9512 | tpr=0.9169 | fpr=0.0482 | 8715.6 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.22287 | acc=0.9510 | tpr=0.9118 | fpr=0.0483 | 8623.8 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.22628 | acc=0.9504 | tpr=0.9047 | fpr=0.0488 | 7832.8 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.22485 | acc=0.9508 | tpr=0.9061 | fpr=0.0484 | 7557.5 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.22410 | acc=0.9506 | tpr=0.9032 | fpr=0.0485 | 8835.7 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.22604 | acc=0.9502 | tpr=0.9002 | fpr=0.0489 | 5526.0 samples/s | 21.6 steps/s
[Step= 500] | Loss=0.22738 | acc=0.9499 | tpr=0.8996 | fpr=0.0492 | 8269.9 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.22580 | acc=0.9501 | tpr=0.8973 | fpr=0.0489 | 10496.7 samples/s | 41.0 steps/s
Avg test loss: 0.22566, Avg test acc: 0.95016, Avg tpr: 0.89699, Avg fpr: 0.04887, total FA: 6786

server round 9/50

clients selected: [0 2 5 6 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=39.0] | Loss=0.14455 | Reg=0.00169 | acc=0.9062 | L2-Norm=13.009 | L2-Norm(final)=7.621 | 7386.4 samples/s | 115.4 steps/s
[Step=8050 Epoch=39.3] | Loss=0.12128 | Reg=0.00170 | acc=0.8594 | L2-Norm=13.029 | L2-Norm(final)=7.712 | 4774.4 samples/s | 74.6 steps/s
[Step=8100 Epoch=39.5] | Loss=0.12428 | Reg=0.00170 | acc=0.9062 | L2-Norm=13.032 | L2-Norm(final)=7.819 | 5527.3 samples/s | 86.4 steps/s
[Step=8150 Epoch=39.7] | Loss=0.12322 | Reg=0.00170 | acc=0.9219 | L2-Norm=13.033 | L2-Norm(final)=7.905 | 5519.3 samples/s | 86.2 steps/s
[Step=8200 Epoch=40.0] | Loss=0.12395 | Reg=0.00170 | acc=0.9062 | L2-Norm=13.034 | L2-Norm(final)=7.982 | 8573.2 samples/s | 134.0 steps/s
[Step=8250 Epoch=40.2] | Loss=0.12241 | Reg=0.00170 | acc=0.9531 | L2-Norm=13.034 | L2-Norm(final)=8.055 | 2695.3 samples/s | 42.1 steps/s
[Step=8300 Epoch=40.5] | Loss=0.12271 | Reg=0.00170 | acc=0.9375 | L2-Norm=13.035 | L2-Norm(final)=8.123 | 5720.6 samples/s | 89.4 steps/s
[Step=8350 Epoch=40.7] | Loss=0.12315 | Reg=0.00170 | acc=0.8750 | L2-Norm=13.035 | L2-Norm(final)=8.187 | 5350.9 samples/s | 83.6 steps/s
[Step=8400 Epoch=41.0] | Loss=0.12302 | Reg=0.00170 | acc=0.8906 | L2-Norm=13.035 | L2-Norm(final)=8.246 | 7740.7 samples/s | 120.9 steps/s
[Step=8450 Epoch=41.2] | Loss=0.12213 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.035 | L2-Norm(final)=8.305 | 2775.6 samples/s | 43.4 steps/s
[Step=8500 Epoch=41.4] | Loss=0.12172 | Reg=0.00170 | acc=0.8750 | L2-Norm=13.035 | L2-Norm(final)=8.364 | 5650.5 samples/s | 88.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=41.5] | Loss=0.14172 | Reg=0.00170 | acc=0.8750 | L2-Norm=13.036 | L2-Norm(final)=8.950 | 7560.6 samples/s | 118.1 steps/s
[Step=8550 Epoch=41.7] | Loss=0.09576 | Reg=0.00177 | acc=0.9375 | L2-Norm=13.289 | L2-Norm(final)=8.953 | 4137.7 samples/s | 64.7 steps/s
[Step=8600 Epoch=41.9] | Loss=0.08260 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.512 | L2-Norm(final)=8.932 | 4795.7 samples/s | 74.9 steps/s
[Step=8650 Epoch=42.2] | Loss=0.07690 | Reg=0.00187 | acc=0.9531 | L2-Norm=13.660 | L2-Norm(final)=8.917 | 4716.0 samples/s | 73.7 steps/s
[Step=8700 Epoch=42.4] | Loss=0.07269 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.778 | L2-Norm(final)=8.908 | 6893.2 samples/s | 107.7 steps/s
[Step=8750 Epoch=42.7] | Loss=0.06570 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.881 | L2-Norm(final)=8.902 | 2472.8 samples/s | 38.6 steps/s
[Step=8800 Epoch=42.9] | Loss=0.06090 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.970 | L2-Norm(final)=8.899 | 4750.5 samples/s | 74.2 steps/s
[Step=8850 Epoch=43.2] | Loss=0.05745 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.051 | L2-Norm(final)=8.895 | 4810.4 samples/s | 75.2 steps/s
[Step=8900 Epoch=43.4] | Loss=0.05547 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.126 | L2-Norm(final)=8.892 | 6164.5 samples/s | 96.3 steps/s
[Step=8950 Epoch=43.6] | Loss=0.05179 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.195 | L2-Norm(final)=8.889 | 2565.9 samples/s | 40.1 steps/s
[Step=9000 Epoch=43.9] | Loss=0.04918 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.257 | L2-Norm(final)=8.889 | 4796.9 samples/s | 75.0 steps/s
[Step=9050 Epoch=44.1] | Loss=0.04709 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.312 | L2-Norm(final)=8.887 | 4738.0 samples/s | 74.0 steps/s
[Step=9100 Epoch=44.4] | Loss=0.04550 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.366 | L2-Norm(final)=8.886 | 5704.6 samples/s | 89.1 steps/s
[Step=9150 Epoch=44.6] | Loss=0.04489 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.423 | L2-Norm(final)=8.885 | 2638.3 samples/s | 41.2 steps/s
[Step=9200 Epoch=44.9] | Loss=0.04456 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.485 | L2-Norm(final)=8.882 | 4763.1 samples/s | 74.4 steps/s
[Step=9250 Epoch=45.1] | Loss=0.04326 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.546 | L2-Norm(final)=8.880 | 4795.3 samples/s | 74.9 steps/s
[Step=9300 Epoch=45.3] | Loss=0.04244 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.602 | L2-Norm(final)=8.877 | 5207.1 samples/s | 81.4 steps/s
[Step=9350 Epoch=45.6] | Loss=0.04147 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.655 | L2-Norm(final)=8.874 | 2764.1 samples/s | 43.2 steps/s
[Step=9400 Epoch=45.8] | Loss=0.03980 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.705 | L2-Norm(final)=8.872 | 4750.3 samples/s | 74.2 steps/s
[Step=9450 Epoch=46.1] | Loss=0.03858 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.750 | L2-Norm(final)=8.871 | 4811.7 samples/s | 75.2 steps/s
[Step=9500 Epoch=46.3] | Loss=0.03753 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.791 | L2-Norm(final)=8.869 | 4880.6 samples/s | 76.3 steps/s
[Step=9550 Epoch=46.6] | Loss=0.03656 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.829 | L2-Norm(final)=8.868 | 2937.3 samples/s | 45.9 steps/s
[Step=9600 Epoch=46.8] | Loss=0.03567 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.866 | L2-Norm(final)=8.866 | 4654.4 samples/s | 72.7 steps/s
[Step=9650 Epoch=47.1] | Loss=0.03464 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.900 | L2-Norm(final)=8.865 | 4750.8 samples/s | 74.2 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03386 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.932 | L2-Norm(final)=8.864 | 4795.2 samples/s | 74.9 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03291 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.963 | L2-Norm(final)=8.863 | 2941.5 samples/s | 46.0 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03206 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.992 | L2-Norm(final)=8.862 | 4738.5 samples/s | 74.0 steps/s
[Step=9850 Epoch=48.0] | Loss=0.03122 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.019 | L2-Norm(final)=8.861 | 4774.7 samples/s | 74.6 steps/s
[Step=9900 Epoch=48.3] | Loss=0.03083 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.045 | L2-Norm(final)=8.860 | 4797.5 samples/s | 75.0 steps/s
[Step=9950 Epoch=48.5] | Loss=0.03013 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.071 | L2-Norm(final)=8.859 | 2932.8 samples/s | 45.8 steps/s
[Step=10000 Epoch=48.8] | Loss=0.02955 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.095 | L2-Norm(final)=8.859 | 4701.3 samples/s | 73.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step10000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=39.0] | Loss=0.28932 | Reg=0.00169 | acc=0.7344 | L2-Norm=13.009 | L2-Norm(final)=6.594 | 7369.9 samples/s | 115.2 steps/s
[Step=8050 Epoch=39.2] | Loss=0.15795 | Reg=0.00169 | acc=0.8125 | L2-Norm=13.008 | L2-Norm(final)=6.535 | 4979.8 samples/s | 77.8 steps/s
[Step=8100 Epoch=39.5] | Loss=0.14211 | Reg=0.00169 | acc=0.9531 | L2-Norm=13.008 | L2-Norm(final)=6.632 | 5302.7 samples/s | 82.9 steps/s
[Step=8150 Epoch=39.7] | Loss=0.13304 | Reg=0.00169 | acc=0.8750 | L2-Norm=13.008 | L2-Norm(final)=6.767 | 5699.7 samples/s | 89.1 steps/s
[Step=8200 Epoch=40.0] | Loss=0.12799 | Reg=0.00169 | acc=0.9062 | L2-Norm=13.008 | L2-Norm(final)=6.907 | 8381.1 samples/s | 131.0 steps/s
[Step=8250 Epoch=40.2] | Loss=0.12501 | Reg=0.00169 | acc=0.8750 | L2-Norm=13.008 | L2-Norm(final)=7.042 | 2675.2 samples/s | 41.8 steps/s
[Step=8300 Epoch=40.4] | Loss=0.12233 | Reg=0.00169 | acc=0.8750 | L2-Norm=13.008 | L2-Norm(final)=7.173 | 5558.0 samples/s | 86.8 steps/s
[Step=8350 Epoch=40.7] | Loss=0.12064 | Reg=0.00169 | acc=0.8750 | L2-Norm=13.008 | L2-Norm(final)=7.300 | 5670.0 samples/s | 88.6 steps/s
[Step=8400 Epoch=40.9] | Loss=0.11848 | Reg=0.00169 | acc=0.9531 | L2-Norm=13.008 | L2-Norm(final)=7.422 | 7376.7 samples/s | 115.3 steps/s
[Step=8450 Epoch=41.2] | Loss=0.11671 | Reg=0.00169 | acc=0.8750 | L2-Norm=13.008 | L2-Norm(final)=7.540 | 2783.4 samples/s | 43.5 steps/s
[Step=8500 Epoch=41.4] | Loss=0.11571 | Reg=0.00169 | acc=0.9688 | L2-Norm=13.008 | L2-Norm(final)=7.652 | 5577.9 samples/s | 87.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=41.4] | Loss=0.09818 | Reg=0.00169 | acc=0.9219 | L2-Norm=13.008 | L2-Norm(final)=8.751 | 7415.9 samples/s | 115.9 steps/s
[Step=8550 Epoch=41.7] | Loss=0.08550 | Reg=0.00177 | acc=0.9375 | L2-Norm=13.290 | L2-Norm(final)=8.767 | 4245.8 samples/s | 66.3 steps/s
[Step=8600 Epoch=41.9] | Loss=0.07817 | Reg=0.00183 | acc=0.9531 | L2-Norm=13.527 | L2-Norm(final)=8.739 | 4682.9 samples/s | 73.2 steps/s
[Step=8650 Epoch=42.1] | Loss=0.07398 | Reg=0.00188 | acc=0.9062 | L2-Norm=13.694 | L2-Norm(final)=8.725 | 4793.0 samples/s | 74.9 steps/s
[Step=8700 Epoch=42.4] | Loss=0.06949 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.827 | L2-Norm(final)=8.716 | 6873.0 samples/s | 107.4 steps/s
[Step=8750 Epoch=42.6] | Loss=0.06437 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.938 | L2-Norm(final)=8.708 | 2495.9 samples/s | 39.0 steps/s
[Step=8800 Epoch=42.9] | Loss=0.05936 | Reg=0.00197 | acc=0.9531 | L2-Norm=14.032 | L2-Norm(final)=8.705 | 4751.0 samples/s | 74.2 steps/s
[Step=8850 Epoch=43.1] | Loss=0.05618 | Reg=0.00199 | acc=0.9219 | L2-Norm=14.114 | L2-Norm(final)=8.701 | 4732.2 samples/s | 73.9 steps/s
[Step=8900 Epoch=43.4] | Loss=0.05360 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.189 | L2-Norm(final)=8.699 | 6238.2 samples/s | 97.5 steps/s
[Step=8950 Epoch=43.6] | Loss=0.05139 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.256 | L2-Norm(final)=8.697 | 2572.1 samples/s | 40.2 steps/s
[Step=9000 Epoch=43.9] | Loss=0.04843 | Reg=0.00205 | acc=0.9688 | L2-Norm=14.317 | L2-Norm(final)=8.696 | 4751.0 samples/s | 74.2 steps/s
[Step=9050 Epoch=44.1] | Loss=0.04709 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.374 | L2-Norm(final)=8.694 | 4773.5 samples/s | 74.6 steps/s
[Step=9100 Epoch=44.3] | Loss=0.04499 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.428 | L2-Norm(final)=8.692 | 5699.2 samples/s | 89.1 steps/s
[Step=9150 Epoch=44.6] | Loss=0.04285 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.477 | L2-Norm(final)=8.691 | 2667.0 samples/s | 41.7 steps/s
[Step=9200 Epoch=44.8] | Loss=0.04105 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.522 | L2-Norm(final)=8.691 | 4767.6 samples/s | 74.5 steps/s
[Step=9250 Epoch=45.1] | Loss=0.03957 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.564 | L2-Norm(final)=8.691 | 4813.0 samples/s | 75.2 steps/s
[Step=9300 Epoch=45.3] | Loss=0.03855 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.604 | L2-Norm(final)=8.691 | 5192.6 samples/s | 81.1 steps/s
[Step=9350 Epoch=45.6] | Loss=0.03727 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.643 | L2-Norm(final)=8.690 | 2795.2 samples/s | 43.7 steps/s
[Step=9400 Epoch=45.8] | Loss=0.03636 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.679 | L2-Norm(final)=8.690 | 4722.3 samples/s | 73.8 steps/s
[Step=9450 Epoch=46.0] | Loss=0.03533 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.716 | L2-Norm(final)=8.690 | 4772.3 samples/s | 74.6 steps/s
[Step=9500 Epoch=46.3] | Loss=0.03465 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.751 | L2-Norm(final)=8.691 | 4904.8 samples/s | 76.6 steps/s
[Step=9550 Epoch=46.5] | Loss=0.03405 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.786 | L2-Norm(final)=8.691 | 2896.8 samples/s | 45.3 steps/s
[Step=9600 Epoch=46.8] | Loss=0.03328 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.821 | L2-Norm(final)=8.691 | 4760.0 samples/s | 74.4 steps/s
[Step=9650 Epoch=47.0] | Loss=0.03245 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.856 | L2-Norm(final)=8.691 | 4750.0 samples/s | 74.2 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03159 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.888 | L2-Norm(final)=8.692 | 4868.0 samples/s | 76.1 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03090 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.920 | L2-Norm(final)=8.693 | 2960.9 samples/s | 46.3 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03013 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.950 | L2-Norm(final)=8.694 | 4697.9 samples/s | 73.4 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02935 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.979 | L2-Norm(final)=8.696 | 4665.1 samples/s | 72.9 steps/s
[Step=9900 Epoch=48.2] | Loss=0.02908 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.007 | L2-Norm(final)=8.697 | 4767.0 samples/s | 74.5 steps/s
[Step=9950 Epoch=48.5] | Loss=0.02892 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.037 | L2-Norm(final)=8.698 | 2975.4 samples/s | 46.5 steps/s
[Step=10000 Epoch=48.7] | Loss=0.02863 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.068 | L2-Norm(final)=8.699 | 4714.2 samples/s | 73.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step10000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=94.8] | Loss=0.00207 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.009 | L2-Norm(final)=12.642 | 6976.7 samples/s | 109.0 steps/s
[Step=10050 Epoch=95.2] | Loss=0.01146 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.000 | L2-Norm(final)=12.670 | 4784.1 samples/s | 74.8 steps/s
[Step=10100 Epoch=95.7] | Loss=0.01279 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=12.703 | 7706.8 samples/s | 120.4 steps/s
[Step=10150 Epoch=96.2] | Loss=0.01305 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.999 | L2-Norm(final)=12.744 | 1902.9 samples/s | 29.7 steps/s
[Step=10200 Epoch=96.7] | Loss=0.01243 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.998 | L2-Norm(final)=12.789 | 7182.5 samples/s | 112.2 steps/s
[Step=10250 Epoch=97.1] | Loss=0.01201 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.998 | L2-Norm(final)=12.848 | 2649.3 samples/s | 41.4 steps/s
[Step=10300 Epoch=97.6] | Loss=0.01198 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.998 | L2-Norm(final)=12.908 | 6565.1 samples/s | 102.6 steps/s
[Step=10350 Epoch=98.1] | Loss=0.01184 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.998 | L2-Norm(final)=12.966 | 2856.8 samples/s | 44.6 steps/s
[Step=10400 Epoch=98.5] | Loss=0.01181 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.998 | L2-Norm(final)=13.025 | 5688.5 samples/s | 88.9 steps/s
[Step=10450 Epoch=99.0] | Loss=0.01192 | Reg=0.00169 | acc=0.9688 | L2-Norm=12.998 | L2-Norm(final)=13.086 | 2948.5 samples/s | 46.1 steps/s
[Step=10500 Epoch=99.5] | Loss=0.01162 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.998 | L2-Norm(final)=13.144 | 5382.5 samples/s | 84.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=99.5] | Loss=0.01120 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.998 | L2-Norm(final)=13.737 | 6778.3 samples/s | 105.9 steps/s
[Step=10550 Epoch=100.0] | Loss=0.02818 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.548 | L2-Norm(final)=13.672 | 4269.8 samples/s | 66.7 steps/s
[Step=10600 Epoch=100.4] | Loss=0.02003 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.876 | L2-Norm(final)=13.616 | 6589.6 samples/s | 103.0 steps/s
[Step=10650 Epoch=100.9] | Loss=0.01432 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.988 | L2-Norm(final)=13.596 | 2382.7 samples/s | 37.2 steps/s
[Step=10700 Epoch=101.4] | Loss=0.01110 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.022 | L2-Norm(final)=13.589 | 5977.5 samples/s | 93.4 steps/s
[Step=10750 Epoch=101.9] | Loss=0.00892 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.020 | L2-Norm(final)=13.588 | 2483.0 samples/s | 38.8 steps/s
[Step=10800 Epoch=102.3] | Loss=0.00744 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.998 | L2-Norm(final)=13.589 | 5342.4 samples/s | 83.5 steps/s
[Step=10850 Epoch=102.8] | Loss=0.00638 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.967 | L2-Norm(final)=13.589 | 2567.6 samples/s | 40.1 steps/s
[Step=10900 Epoch=103.3] | Loss=0.00558 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.930 | L2-Norm(final)=13.590 | 4972.5 samples/s | 77.7 steps/s
[Step=10950 Epoch=103.8] | Loss=0.00496 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.890 | L2-Norm(final)=13.592 | 2714.9 samples/s | 42.4 steps/s
[Step=11000 Epoch=104.2] | Loss=0.00447 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.849 | L2-Norm(final)=13.593 | 4618.1 samples/s | 72.2 steps/s
[Step=11050 Epoch=104.7] | Loss=0.00406 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.807 | L2-Norm(final)=13.594 | 2810.6 samples/s | 43.9 steps/s
[Step=11100 Epoch=105.2] | Loss=0.00372 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.765 | L2-Norm(final)=13.595 | 4492.5 samples/s | 70.2 steps/s
[Step=11150 Epoch=105.7] | Loss=0.00344 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.724 | L2-Norm(final)=13.596 | 2819.4 samples/s | 44.1 steps/s
[Step=11200 Epoch=106.1] | Loss=0.00319 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.682 | L2-Norm(final)=13.597 | 4554.6 samples/s | 71.2 steps/s
[Step=11250 Epoch=106.6] | Loss=0.00298 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.641 | L2-Norm(final)=13.598 | 2828.2 samples/s | 44.2 steps/s
[Step=11300 Epoch=107.1] | Loss=0.00279 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.601 | L2-Norm(final)=13.599 | 4576.1 samples/s | 71.5 steps/s
[Step=11350 Epoch=107.6] | Loss=0.00263 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=13.600 | 3070.6 samples/s | 48.0 steps/s
[Step=11400 Epoch=108.0] | Loss=0.00248 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.521 | L2-Norm(final)=13.601 | 4085.0 samples/s | 63.8 steps/s
[Step=11450 Epoch=108.5] | Loss=0.00235 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=13.602 | 6790.0 samples/s | 106.1 steps/s
[Step=11500 Epoch=109.0] | Loss=0.00224 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.444 | L2-Norm(final)=13.603 | 2358.6 samples/s | 36.9 steps/s
[Step=11550 Epoch=109.4] | Loss=0.00213 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.406 | L2-Norm(final)=13.604 | 6158.3 samples/s | 96.2 steps/s
[Step=11600 Epoch=109.9] | Loss=0.00203 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=13.604 | 2297.7 samples/s | 35.9 steps/s
[Step=11650 Epoch=110.4] | Loss=0.00195 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.332 | L2-Norm(final)=13.605 | 5640.7 samples/s | 88.1 steps/s
[Step=11700 Epoch=110.9] | Loss=0.00186 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.295 | L2-Norm(final)=13.606 | 2542.8 samples/s | 39.7 steps/s
[Step=11750 Epoch=111.3] | Loss=0.00179 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.259 | L2-Norm(final)=13.607 | 5143.6 samples/s | 80.4 steps/s
[Step=11800 Epoch=111.8] | Loss=0.00172 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.224 | L2-Norm(final)=13.608 | 2661.7 samples/s | 41.6 steps/s
[Step=11850 Epoch=112.3] | Loss=0.00166 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.188 | L2-Norm(final)=13.608 | 4698.7 samples/s | 73.4 steps/s
[Step=11900 Epoch=112.8] | Loss=0.00160 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.154 | L2-Norm(final)=13.609 | 2760.5 samples/s | 43.1 steps/s
[Step=11950 Epoch=113.2] | Loss=0.00154 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.119 | L2-Norm(final)=13.610 | 4530.1 samples/s | 70.8 steps/s
[Step=12000 Epoch=113.7] | Loss=0.00149 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.085 | L2-Norm(final)=13.610 | 2875.0 samples/s | 44.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step12000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=57.1] | Loss=0.05184 | Reg=0.00169 | acc=0.9219 | L2-Norm=13.009 | L2-Norm(final)=9.455 | 7347.1 samples/s | 114.8 steps/s
[Step=6050 Epoch=57.6] | Loss=0.02746 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=9.451 | 4547.2 samples/s | 71.0 steps/s
[Step=6100 Epoch=58.0] | Loss=0.02411 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.998 | L2-Norm(final)=9.514 | 7957.2 samples/s | 124.3 steps/s
[Step=6150 Epoch=58.5] | Loss=0.02267 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.998 | L2-Norm(final)=9.593 | 2547.1 samples/s | 39.8 steps/s
[Step=6200 Epoch=59.0] | Loss=0.02205 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.998 | L2-Norm(final)=9.688 | 7301.6 samples/s | 114.1 steps/s
[Step=6250 Epoch=59.5] | Loss=0.02139 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.997 | L2-Norm(final)=9.781 | 2688.6 samples/s | 42.0 steps/s
[Step=6300 Epoch=59.9] | Loss=0.02017 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=9.882 | 6474.4 samples/s | 101.2 steps/s
[Step=6350 Epoch=60.4] | Loss=0.01969 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=9.985 | 2787.3 samples/s | 43.6 steps/s
[Step=6400 Epoch=60.9] | Loss=0.01930 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.997 | L2-Norm(final)=10.085 | 5972.6 samples/s | 93.3 steps/s
[Step=6450 Epoch=61.4] | Loss=0.01897 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.997 | L2-Norm(final)=10.181 | 2985.6 samples/s | 46.7 steps/s
[Step=6500 Epoch=61.8] | Loss=0.01871 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=10.274 | 5343.1 samples/s | 83.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=61.8] | Loss=0.01175 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.997 | L2-Norm(final)=11.198 | 6906.1 samples/s | 107.9 steps/s
[Step=6550 Epoch=62.3] | Loss=0.02185 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.416 | L2-Norm(final)=11.184 | 4100.5 samples/s | 64.1 steps/s
[Step=6600 Epoch=62.8] | Loss=0.01959 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.810 | L2-Norm(final)=11.134 | 6531.0 samples/s | 102.0 steps/s
[Step=6650 Epoch=63.3] | Loss=0.01347 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.973 | L2-Norm(final)=11.114 | 2394.6 samples/s | 37.4 steps/s
[Step=6700 Epoch=63.7] | Loss=0.01021 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.037 | L2-Norm(final)=11.109 | 6012.7 samples/s | 93.9 steps/s
[Step=6750 Epoch=64.2] | Loss=0.00818 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.058 | L2-Norm(final)=11.108 | 2485.3 samples/s | 38.8 steps/s
[Step=6800 Epoch=64.7] | Loss=0.00682 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.055 | L2-Norm(final)=11.108 | 5487.6 samples/s | 85.7 steps/s
[Step=6850 Epoch=65.2] | Loss=0.00585 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.040 | L2-Norm(final)=11.108 | 2616.4 samples/s | 40.9 steps/s
[Step=6900 Epoch=65.6] | Loss=0.00512 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.016 | L2-Norm(final)=11.108 | 4950.6 samples/s | 77.4 steps/s
[Step=6950 Epoch=66.1] | Loss=0.00455 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.988 | L2-Norm(final)=11.109 | 2730.1 samples/s | 42.7 steps/s
[Step=7000 Epoch=66.6] | Loss=0.00410 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.958 | L2-Norm(final)=11.109 | 4593.1 samples/s | 71.8 steps/s
[Step=7050 Epoch=67.1] | Loss=0.00372 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.925 | L2-Norm(final)=11.110 | 2764.8 samples/s | 43.2 steps/s
[Step=7100 Epoch=67.5] | Loss=0.00341 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.891 | L2-Norm(final)=11.110 | 4553.1 samples/s | 71.1 steps/s
[Step=7150 Epoch=68.0] | Loss=0.00315 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.856 | L2-Norm(final)=11.111 | 2863.3 samples/s | 44.7 steps/s
[Step=7200 Epoch=68.5] | Loss=0.00293 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.821 | L2-Norm(final)=11.111 | 4549.1 samples/s | 71.1 steps/s
[Step=7250 Epoch=69.0] | Loss=0.00273 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=11.111 | 2890.6 samples/s | 45.2 steps/s
[Step=7300 Epoch=69.4] | Loss=0.00256 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.750 | L2-Norm(final)=11.112 | 4486.0 samples/s | 70.1 steps/s
[Step=7350 Epoch=69.9] | Loss=0.00241 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=11.112 | 3026.3 samples/s | 47.3 steps/s
[Step=7400 Epoch=70.4] | Loss=0.00228 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.679 | L2-Norm(final)=11.113 | 4178.5 samples/s | 65.3 steps/s
[Step=7450 Epoch=70.9] | Loss=0.00216 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.644 | L2-Norm(final)=11.113 | 6897.9 samples/s | 107.8 steps/s
[Step=7500 Epoch=71.3] | Loss=0.00205 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.609 | L2-Norm(final)=11.114 | 2369.6 samples/s | 37.0 steps/s
[Step=7550 Epoch=71.8] | Loss=0.00195 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.574 | L2-Norm(final)=11.114 | 6187.6 samples/s | 96.7 steps/s
[Step=7600 Epoch=72.3] | Loss=0.00186 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.539 | L2-Norm(final)=11.115 | 2439.9 samples/s | 38.1 steps/s
[Step=7650 Epoch=72.8] | Loss=0.00178 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.504 | L2-Norm(final)=11.115 | 5670.6 samples/s | 88.6 steps/s
[Step=7700 Epoch=73.2] | Loss=0.00171 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.470 | L2-Norm(final)=11.116 | 2579.4 samples/s | 40.3 steps/s
[Step=7750 Epoch=73.7] | Loss=0.00164 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.436 | L2-Norm(final)=11.116 | 5018.2 samples/s | 78.4 steps/s
[Step=7800 Epoch=74.2] | Loss=0.00158 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=11.117 | 2620.3 samples/s | 40.9 steps/s
[Step=7850 Epoch=74.7] | Loss=0.00152 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=11.117 | 4796.4 samples/s | 74.9 steps/s
[Step=7900 Epoch=75.1] | Loss=0.00147 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=11.117 | 2769.9 samples/s | 43.3 steps/s
[Step=7950 Epoch=75.6] | Loss=0.00142 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.302 | L2-Norm(final)=11.118 | 4531.4 samples/s | 70.8 steps/s
[Step=8000 Epoch=76.1] | Loss=0.00137 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.269 | L2-Norm(final)=11.118 | 2883.5 samples/s | 45.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step8000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=94.2] | Loss=0.00917 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.009 | L2-Norm(final)=11.274 | 7113.2 samples/s | 111.1 steps/s
[Step=10050 Epoch=94.7] | Loss=0.01775 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=11.257 | 4672.7 samples/s | 73.0 steps/s
[Step=10100 Epoch=95.2] | Loss=0.01868 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.998 | L2-Norm(final)=11.270 | 7722.7 samples/s | 120.7 steps/s
[Step=10150 Epoch=95.6] | Loss=0.01779 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=11.306 | 2603.8 samples/s | 40.7 steps/s
[Step=10200 Epoch=96.1] | Loss=0.01757 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=11.362 | 6928.0 samples/s | 108.3 steps/s
[Step=10250 Epoch=96.6] | Loss=0.01689 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=11.427 | 2785.7 samples/s | 43.5 steps/s
[Step=10300 Epoch=97.1] | Loss=0.01648 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=11.495 | 5837.7 samples/s | 91.2 steps/s
[Step=10350 Epoch=97.5] | Loss=0.01645 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.997 | L2-Norm(final)=11.565 | 2863.5 samples/s | 44.7 steps/s
[Step=10400 Epoch=98.0] | Loss=0.01631 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.997 | L2-Norm(final)=11.632 | 5616.6 samples/s | 87.8 steps/s
[Step=10450 Epoch=98.5] | Loss=0.01577 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=11.702 | 3035.4 samples/s | 47.4 steps/s
[Step=10500 Epoch=98.9] | Loss=0.01557 | Reg=0.00169 | acc=0.9531 | L2-Norm=12.997 | L2-Norm(final)=11.772 | 5328.7 samples/s | 83.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=98.9] | Loss=0.01156 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=12.467 | 7538.6 samples/s | 117.8 steps/s
[Step=10550 Epoch=99.4] | Loss=0.03047 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.523 | L2-Norm(final)=12.397 | 3939.8 samples/s | 61.6 steps/s
[Step=10600 Epoch=99.9] | Loss=0.02065 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.858 | L2-Norm(final)=12.361 | 6326.5 samples/s | 98.9 steps/s
[Step=10650 Epoch=100.4] | Loss=0.01547 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.012 | L2-Norm(final)=12.346 | 2403.3 samples/s | 37.6 steps/s
[Step=10700 Epoch=100.8] | Loss=0.01183 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.080 | L2-Norm(final)=12.339 | 5655.4 samples/s | 88.4 steps/s
[Step=10750 Epoch=101.3] | Loss=0.00970 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.104 | L2-Norm(final)=12.337 | 2522.7 samples/s | 39.4 steps/s
[Step=10800 Epoch=101.8] | Loss=0.00826 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.109 | L2-Norm(final)=12.336 | 5216.8 samples/s | 81.5 steps/s
[Step=10850 Epoch=102.2] | Loss=0.00740 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.106 | L2-Norm(final)=12.337 | 2636.4 samples/s | 41.2 steps/s
[Step=10900 Epoch=102.7] | Loss=0.00650 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.096 | L2-Norm(final)=12.338 | 4770.7 samples/s | 74.5 steps/s
[Step=10950 Epoch=103.2] | Loss=0.00590 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.081 | L2-Norm(final)=12.339 | 2777.1 samples/s | 43.4 steps/s
[Step=11000 Epoch=103.7] | Loss=0.00531 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.063 | L2-Norm(final)=12.340 | 4532.9 samples/s | 70.8 steps/s
[Step=11050 Epoch=104.1] | Loss=0.00484 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.040 | L2-Norm(final)=12.341 | 2858.2 samples/s | 44.7 steps/s
[Step=11100 Epoch=104.6] | Loss=0.00444 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.016 | L2-Norm(final)=12.342 | 4628.1 samples/s | 72.3 steps/s
[Step=11150 Epoch=105.1] | Loss=0.00410 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.989 | L2-Norm(final)=12.343 | 2844.9 samples/s | 44.5 steps/s
[Step=11200 Epoch=105.5] | Loss=0.00381 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.960 | L2-Norm(final)=12.344 | 4510.9 samples/s | 70.5 steps/s
[Step=11250 Epoch=106.0] | Loss=0.00355 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.931 | L2-Norm(final)=12.346 | 3135.3 samples/s | 49.0 steps/s
[Step=11300 Epoch=106.5] | Loss=0.00333 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=12.347 | 4038.3 samples/s | 63.1 steps/s
[Step=11350 Epoch=106.9] | Loss=0.00314 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.870 | L2-Norm(final)=12.347 | 6513.5 samples/s | 101.8 steps/s
[Step=11400 Epoch=107.4] | Loss=0.00296 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.838 | L2-Norm(final)=12.348 | 2407.5 samples/s | 37.6 steps/s
[Step=11450 Epoch=107.9] | Loss=0.00281 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.807 | L2-Norm(final)=12.349 | 5761.4 samples/s | 90.0 steps/s
[Step=11500 Epoch=108.4] | Loss=0.00267 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.776 | L2-Norm(final)=12.350 | 2501.4 samples/s | 39.1 steps/s
[Step=11550 Epoch=108.8] | Loss=0.00254 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.744 | L2-Norm(final)=12.351 | 5331.9 samples/s | 83.3 steps/s
[Step=11600 Epoch=109.3] | Loss=0.00242 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.712 | L2-Norm(final)=12.352 | 2624.6 samples/s | 41.0 steps/s
[Step=11650 Epoch=109.8] | Loss=0.00232 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.681 | L2-Norm(final)=12.352 | 4843.1 samples/s | 75.7 steps/s
[Step=11700 Epoch=110.2] | Loss=0.00222 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.649 | L2-Norm(final)=12.353 | 2729.3 samples/s | 42.6 steps/s
[Step=11750 Epoch=110.7] | Loss=0.00213 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=12.354 | 4528.0 samples/s | 70.8 steps/s
[Step=11800 Epoch=111.2] | Loss=0.00205 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.587 | L2-Norm(final)=12.355 | 2861.3 samples/s | 44.7 steps/s
[Step=11850 Epoch=111.7] | Loss=0.00198 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.556 | L2-Norm(final)=12.355 | 4637.0 samples/s | 72.5 steps/s
[Step=11900 Epoch=112.1] | Loss=0.00191 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=12.356 | 2847.1 samples/s | 44.5 steps/s
[Step=11950 Epoch=112.6] | Loss=0.00184 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.494 | L2-Norm(final)=12.357 | 4512.5 samples/s | 70.5 steps/s
[Step=12000 Epoch=113.1] | Loss=0.00178 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.463 | L2-Norm(final)=12.358 | 3160.5 samples/s | 49.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.12077 | acc=0.9385 | tpr=0.9495 | fpr=0.0852 | 5785.3 samples/s | 22.6 steps/s
Avg test loss: 0.12964, Avg test acc: 0.93513, Avg tpr: 0.94603, Avg fpr: 0.08883, total FA: 693

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14985 | acc=0.9369 | tpr=0.9654 | fpr=0.1251 | 6197.9 samples/s | 24.2 steps/s
Avg test loss: 0.15362, Avg test acc: 0.93569, Avg tpr: 0.96415, Avg fpr: 0.12691, total FA: 990

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.13247 | acc=0.9334 | tpr=0.9445 | fpr=0.0909 | 6025.4 samples/s | 23.5 steps/s
Avg test loss: 0.13823, Avg test acc: 0.93064, Avg tpr: 0.94008, Avg fpr: 0.09012, total FA: 703

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.13291 | acc=0.9371 | tpr=0.9571 | fpr=0.1063 | 5991.1 samples/s | 23.4 steps/s
Avg test loss: 0.14036, Avg test acc: 0.93585, Avg tpr: 0.95623, Avg fpr: 0.10896, total FA: 850

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.16531 | acc=0.9237 | tpr=0.9199 | fpr=0.0681 | 5949.6 samples/s | 23.2 steps/s
Avg test loss: 0.16825, Avg test acc: 0.92203, Avg tpr: 0.91694, Avg fpr: 0.06679, total FA: 521

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.86993 | acc=0.3130 | tpr=0.0111 | fpr=0.0315 | 6218.2 samples/s | 24.3 steps/s
Avg test loss: 4.88424, Avg test acc: 0.31020, Avg tpr: 0.01137, Avg fpr: 0.03256, total FA: 254

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.12229 | acc=0.3223 | tpr=0.0209 | fpr=0.0230 | 5986.2 samples/s | 23.4 steps/s
Avg test loss: 5.13941, Avg test acc: 0.32046, Avg tpr: 0.02168, Avg fpr: 0.02243, total FA: 175

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.13446 | acc=0.3227 | tpr=0.0330 | fpr=0.0481 | 5905.0 samples/s | 23.1 steps/s
Avg test loss: 4.14066, Avg test acc: 0.32086, Avg tpr: 0.03322, Avg fpr: 0.04653, total FA: 363

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.75208 | acc=0.3192 | tpr=0.0413 | fpr=0.0773 | 5984.0 samples/s | 23.4 steps/s
Avg test loss: 4.75405, Avg test acc: 0.31697, Avg tpr: 0.04103, Avg fpr: 0.07614, total FA: 594

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=3.91120 | acc=0.3131 | tpr=0.0135 | fpr=0.0362 | 6013.4 samples/s | 23.5 steps/s
Avg test loss: 3.92539, Avg test acc: 0.31160, Avg tpr: 0.01370, Avg fpr: 0.03320, total FA: 259

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.86482 | acc=0.1541 | tpr=0.7345 | fpr=0.8563 | 5889.0 samples/s | 23.0 steps/s
[Step= 100] | Loss=4.84800 | acc=0.1537 | tpr=0.7036 | fpr=0.8566 | 8568.1 samples/s | 33.5 steps/s
[Step= 150] | Loss=4.84531 | acc=0.1546 | tpr=0.7147 | fpr=0.8558 | 7996.1 samples/s | 31.2 steps/s
[Step= 200] | Loss=4.84553 | acc=0.1545 | tpr=0.7148 | fpr=0.8557 | 7864.6 samples/s | 30.7 steps/s
[Step= 250] | Loss=4.84810 | acc=0.1550 | tpr=0.7162 | fpr=0.8552 | 8016.6 samples/s | 31.3 steps/s
[Step= 300] | Loss=4.83944 | acc=0.1549 | tpr=0.7135 | fpr=0.8552 | 8078.7 samples/s | 31.6 steps/s
[Step= 350] | Loss=4.84446 | acc=0.1547 | tpr=0.7176 | fpr=0.8555 | 8302.6 samples/s | 32.4 steps/s
[Step= 400] | Loss=4.84697 | acc=0.1552 | tpr=0.7155 | fpr=0.8550 | 7443.2 samples/s | 29.1 steps/s
[Step= 450] | Loss=4.85239 | acc=0.1548 | tpr=0.7181 | fpr=0.8554 | 8063.9 samples/s | 31.5 steps/s
[Step= 500] | Loss=4.85127 | acc=0.1549 | tpr=0.7167 | fpr=0.8553 | 7772.0 samples/s | 30.4 steps/s
[Step= 550] | Loss=4.85308 | acc=0.1549 | tpr=0.7211 | fpr=0.8554 | 10493.0 samples/s | 41.0 steps/s
Avg test loss: 4.85451, Avg test acc: 0.15478, Avg tpr: 0.72108, Avg fpr: 0.85552, total FA: 118787

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.16041 | acc=0.1341 | tpr=0.7611 | fpr=0.8771 | 5960.0 samples/s | 23.3 steps/s
[Step= 100] | Loss=5.14818 | acc=0.1340 | tpr=0.7356 | fpr=0.8772 | 8010.0 samples/s | 31.3 steps/s
[Step= 150] | Loss=5.13932 | acc=0.1333 | tpr=0.7219 | fpr=0.8775 | 8611.5 samples/s | 33.6 steps/s
[Step= 200] | Loss=5.14301 | acc=0.1331 | tpr=0.7137 | fpr=0.8775 | 7673.1 samples/s | 30.0 steps/s
[Step= 250] | Loss=5.14679 | acc=0.1330 | tpr=0.7109 | fpr=0.8776 | 8076.1 samples/s | 31.5 steps/s
[Step= 300] | Loss=5.13838 | acc=0.1331 | tpr=0.7113 | fpr=0.8775 | 8095.4 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.14555 | acc=0.1326 | tpr=0.7082 | fpr=0.8779 | 7801.2 samples/s | 30.5 steps/s
[Step= 400] | Loss=5.14426 | acc=0.1332 | tpr=0.7095 | fpr=0.8773 | 8055.1 samples/s | 31.5 steps/s
[Step= 450] | Loss=5.14810 | acc=0.1331 | tpr=0.7103 | fpr=0.8774 | 7584.5 samples/s | 29.6 steps/s
[Step= 500] | Loss=5.14768 | acc=0.1330 | tpr=0.7106 | fpr=0.8774 | 7771.0 samples/s | 30.4 steps/s
[Step= 550] | Loss=5.15266 | acc=0.1331 | tpr=0.7123 | fpr=0.8774 | 11013.9 samples/s | 43.0 steps/s
Avg test loss: 5.15279, Avg test acc: 0.13300, Avg tpr: 0.71236, Avg fpr: 0.87753, total FA: 121843

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.34471 | acc=0.1136 | tpr=0.7434 | fpr=0.8977 | 6110.0 samples/s | 23.9 steps/s
[Step= 100] | Loss=4.32650 | acc=0.1148 | tpr=0.7569 | fpr=0.8972 | 7895.4 samples/s | 30.8 steps/s
[Step= 150] | Loss=4.31349 | acc=0.1165 | tpr=0.7594 | fpr=0.8953 | 7229.2 samples/s | 28.2 steps/s
[Step= 200] | Loss=4.31334 | acc=0.1170 | tpr=0.7508 | fpr=0.8946 | 8864.8 samples/s | 34.6 steps/s
[Step= 250] | Loss=4.31276 | acc=0.1176 | tpr=0.7511 | fpr=0.8940 | 7904.6 samples/s | 30.9 steps/s
[Step= 300] | Loss=4.31065 | acc=0.1176 | tpr=0.7491 | fpr=0.8939 | 8195.7 samples/s | 32.0 steps/s
[Step= 350] | Loss=4.31380 | acc=0.1177 | tpr=0.7495 | fpr=0.8938 | 7789.4 samples/s | 30.4 steps/s
[Step= 400] | Loss=4.31518 | acc=0.1171 | tpr=0.7462 | fpr=0.8943 | 8568.3 samples/s | 33.5 steps/s
[Step= 450] | Loss=4.31839 | acc=0.1166 | tpr=0.7517 | fpr=0.8949 | 8025.4 samples/s | 31.3 steps/s
[Step= 500] | Loss=4.31930 | acc=0.1165 | tpr=0.7542 | fpr=0.8950 | 8151.0 samples/s | 31.8 steps/s
[Step= 550] | Loss=4.32218 | acc=0.1166 | tpr=0.7557 | fpr=0.8951 | 9340.7 samples/s | 36.5 steps/s
Avg test loss: 4.32309, Avg test acc: 0.11654, Avg tpr: 0.75634, Avg fpr: 0.89509, total FA: 124281

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.04276 | acc=0.1211 | tpr=0.8009 | fpr=0.8911 | 5924.2 samples/s | 23.1 steps/s
[Step= 100] | Loss=6.00997 | acc=0.1218 | tpr=0.8124 | fpr=0.8911 | 7934.7 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.99540 | acc=0.1222 | tpr=0.8055 | fpr=0.8904 | 8451.3 samples/s | 33.0 steps/s
[Step= 200] | Loss=5.99288 | acc=0.1220 | tpr=0.8022 | fpr=0.8904 | 8494.1 samples/s | 33.2 steps/s
[Step= 250] | Loss=5.99480 | acc=0.1216 | tpr=0.8009 | fpr=0.8907 | 7661.3 samples/s | 29.9 steps/s
[Step= 300] | Loss=5.98289 | acc=0.1221 | tpr=0.8029 | fpr=0.8903 | 8087.2 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.98421 | acc=0.1219 | tpr=0.7990 | fpr=0.8904 | 7203.7 samples/s | 28.1 steps/s
[Step= 400] | Loss=5.98411 | acc=0.1219 | tpr=0.7927 | fpr=0.8903 | 8530.2 samples/s | 33.3 steps/s
[Step= 450] | Loss=5.98494 | acc=0.1213 | tpr=0.7965 | fpr=0.8909 | 7915.7 samples/s | 30.9 steps/s
[Step= 500] | Loss=5.98097 | acc=0.1212 | tpr=0.7903 | fpr=0.8909 | 8532.8 samples/s | 33.3 steps/s
[Step= 550] | Loss=5.98651 | acc=0.1215 | tpr=0.7919 | fpr=0.8907 | 9621.1 samples/s | 37.6 steps/s
Avg test loss: 5.98808, Avg test acc: 0.12138, Avg tpr: 0.79239, Avg fpr: 0.89082, total FA: 123688

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.89922 | acc=0.1627 | tpr=0.7080 | fpr=0.8471 | 5874.4 samples/s | 22.9 steps/s
[Step= 100] | Loss=4.88316 | acc=0.1657 | tpr=0.6844 | fpr=0.8440 | 7838.4 samples/s | 30.6 steps/s
[Step= 150] | Loss=4.87701 | acc=0.1667 | tpr=0.6744 | fpr=0.8427 | 8541.7 samples/s | 33.4 steps/s
[Step= 200] | Loss=4.87954 | acc=0.1674 | tpr=0.6710 | fpr=0.8418 | 7734.3 samples/s | 30.2 steps/s
[Step= 250] | Loss=4.87735 | acc=0.1667 | tpr=0.6664 | fpr=0.8424 | 8556.6 samples/s | 33.4 steps/s
[Step= 300] | Loss=4.87023 | acc=0.1665 | tpr=0.6604 | fpr=0.8425 | 7611.5 samples/s | 29.7 steps/s
[Step= 350] | Loss=4.87748 | acc=0.1661 | tpr=0.6587 | fpr=0.8428 | 7806.4 samples/s | 30.5 steps/s
[Step= 400] | Loss=4.87476 | acc=0.1664 | tpr=0.6625 | fpr=0.8426 | 7961.9 samples/s | 31.1 steps/s
[Step= 450] | Loss=4.87823 | acc=0.1658 | tpr=0.6611 | fpr=0.8432 | 7714.1 samples/s | 30.1 steps/s
[Step= 500] | Loss=4.87641 | acc=0.1657 | tpr=0.6612 | fpr=0.8432 | 8024.1 samples/s | 31.3 steps/s
[Step= 550] | Loss=4.87846 | acc=0.1660 | tpr=0.6614 | fpr=0.8430 | 11000.0 samples/s | 43.0 steps/s
Avg test loss: 4.88026, Avg test acc: 0.16592, Avg tpr: 0.66204, Avg fpr: 0.84310, total FA: 117063

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14985 | acc=0.9626 | tpr=0.9115 | fpr=0.0365 | 5814.0 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.15095 | acc=0.9620 | tpr=0.9275 | fpr=0.0374 | 7777.7 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.15197 | acc=0.9611 | tpr=0.9251 | fpr=0.0383 | 8003.8 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.15280 | acc=0.9613 | tpr=0.9311 | fpr=0.0382 | 8039.3 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.15546 | acc=0.9609 | tpr=0.9266 | fpr=0.0385 | 8243.1 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.15722 | acc=0.9603 | tpr=0.9258 | fpr=0.0391 | 7857.6 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.15563 | acc=0.9605 | tpr=0.9249 | fpr=0.0389 | 8202.4 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.15611 | acc=0.9602 | tpr=0.9201 | fpr=0.0391 | 7851.8 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.15868 | acc=0.9597 | tpr=0.9172 | fpr=0.0396 | 7446.9 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.15899 | acc=0.9597 | tpr=0.9189 | fpr=0.0396 | 8654.9 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.15786 | acc=0.9600 | tpr=0.9196 | fpr=0.0393 | 10578.3 samples/s | 41.3 steps/s
Avg test loss: 0.15755, Avg test acc: 0.96003, Avg tpr: 0.91957, Avg fpr: 0.03924, total FA: 5448

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12713 | acc=0.9639 | tpr=0.8673 | fpr=0.0344 | 5972.0 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.12714 | acc=0.9631 | tpr=0.8891 | fpr=0.0355 | 7964.4 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.12938 | acc=0.9622 | tpr=0.9049 | fpr=0.0367 | 8117.7 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.12899 | acc=0.9622 | tpr=0.9016 | fpr=0.0367 | 7929.1 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.12841 | acc=0.9623 | tpr=0.9013 | fpr=0.0366 | 8071.1 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.12963 | acc=0.9620 | tpr=0.8989 | fpr=0.0368 | 8342.2 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.12964 | acc=0.9621 | tpr=0.9004 | fpr=0.0368 | 7318.7 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.13065 | acc=0.9619 | tpr=0.8988 | fpr=0.0370 | 7906.3 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.13256 | acc=0.9613 | tpr=0.8978 | fpr=0.0376 | 8565.3 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.13183 | acc=0.9612 | tpr=0.9000 | fpr=0.0377 | 8598.4 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.13168 | acc=0.9612 | tpr=0.8965 | fpr=0.0376 | 9561.7 samples/s | 37.4 steps/s
Avg test loss: 0.13151, Avg test acc: 0.96124, Avg tpr: 0.89659, Avg fpr: 0.03758, total FA: 5218

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26713 | acc=0.9463 | tpr=0.9425 | fpr=0.0536 | 6116.6 samples/s | 23.9 steps/s
[Step= 100] | Loss=0.27335 | acc=0.9450 | tpr=0.9574 | fpr=0.0552 | 7679.3 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.28003 | acc=0.9435 | tpr=0.9524 | fpr=0.0567 | 7509.2 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.27906 | acc=0.9434 | tpr=0.9519 | fpr=0.0568 | 8118.5 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.27929 | acc=0.9433 | tpr=0.9459 | fpr=0.0567 | 8105.1 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.28174 | acc=0.9430 | tpr=0.9425 | fpr=0.0570 | 8961.2 samples/s | 35.0 steps/s
[Step= 350] | Loss=0.28091 | acc=0.9429 | tpr=0.9436 | fpr=0.0572 | 7957.8 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.28145 | acc=0.9425 | tpr=0.9431 | fpr=0.0575 | 7888.4 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.28426 | acc=0.9420 | tpr=0.9430 | fpr=0.0581 | 7855.7 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.28518 | acc=0.9417 | tpr=0.9445 | fpr=0.0584 | 7963.2 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.28423 | acc=0.9418 | tpr=0.9451 | fpr=0.0583 | 10227.9 samples/s | 40.0 steps/s
Avg test loss: 0.28382, Avg test acc: 0.94186, Avg tpr: 0.94532, Avg fpr: 0.05821, total FA: 8082

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.12342 | acc=0.9639 | tpr=0.8805 | fpr=0.0346 | 5848.4 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.13045 | acc=0.9627 | tpr=0.9019 | fpr=0.0361 | 7754.4 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.13203 | acc=0.9628 | tpr=0.9078 | fpr=0.0362 | 7714.1 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.13276 | acc=0.9626 | tpr=0.9093 | fpr=0.0365 | 8641.5 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.13407 | acc=0.9623 | tpr=0.9083 | fpr=0.0368 | 8196.8 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.13657 | acc=0.9620 | tpr=0.9062 | fpr=0.0370 | 7647.2 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.13654 | acc=0.9619 | tpr=0.9054 | fpr=0.0371 | 8089.1 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.13680 | acc=0.9617 | tpr=0.9048 | fpr=0.0372 | 8228.9 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.13832 | acc=0.9614 | tpr=0.9031 | fpr=0.0376 | 8086.1 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.13899 | acc=0.9613 | tpr=0.9062 | fpr=0.0377 | 7747.2 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.13809 | acc=0.9615 | tpr=0.9045 | fpr=0.0375 | 10506.7 samples/s | 41.0 steps/s
Avg test loss: 0.13784, Avg test acc: 0.96156, Avg tpr: 0.90452, Avg fpr: 0.03741, total FA: 5194

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21303 | acc=0.9535 | tpr=0.8761 | fpr=0.0451 | 6076.0 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.21510 | acc=0.9529 | tpr=0.9083 | fpr=0.0463 | 7446.0 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.22071 | acc=0.9510 | tpr=0.9107 | fpr=0.0482 | 8124.1 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.22102 | acc=0.9512 | tpr=0.9169 | fpr=0.0482 | 8273.1 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.22287 | acc=0.9510 | tpr=0.9118 | fpr=0.0483 | 7652.5 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.22628 | acc=0.9504 | tpr=0.9047 | fpr=0.0488 | 8414.8 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.22485 | acc=0.9508 | tpr=0.9061 | fpr=0.0484 | 8029.1 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.22410 | acc=0.9506 | tpr=0.9032 | fpr=0.0485 | 8358.0 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.22604 | acc=0.9502 | tpr=0.9002 | fpr=0.0489 | 8335.5 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.22738 | acc=0.9499 | tpr=0.8996 | fpr=0.0492 | 7414.7 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.22580 | acc=0.9501 | tpr=0.8973 | fpr=0.0489 | 9949.9 samples/s | 38.9 steps/s
Avg test loss: 0.22566, Avg test acc: 0.95016, Avg tpr: 0.89699, Avg fpr: 0.04887, total FA: 6786

server round 10/50

clients selected: [0 1 3 5 6]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=48.8] | Loss=0.09212 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.785 | L2-Norm(final)=8.845 | 7425.2 samples/s | 116.0 steps/s
[Step=10050 Epoch=49.0] | Loss=0.12383 | Reg=0.00164 | acc=0.8594 | L2-Norm=12.788 | L2-Norm(final)=8.839 | 4847.0 samples/s | 75.7 steps/s
[Step=10100 Epoch=49.2] | Loss=0.11396 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.789 | L2-Norm(final)=8.861 | 5443.2 samples/s | 85.0 steps/s
[Step=10150 Epoch=49.5] | Loss=0.10815 | Reg=0.00164 | acc=0.9375 | L2-Norm=12.789 | L2-Norm(final)=8.898 | 5649.3 samples/s | 88.3 steps/s
[Step=10200 Epoch=49.7] | Loss=0.10730 | Reg=0.00164 | acc=0.9062 | L2-Norm=12.789 | L2-Norm(final)=8.943 | 8473.7 samples/s | 132.4 steps/s
[Step=10250 Epoch=50.0] | Loss=0.10606 | Reg=0.00164 | acc=0.8438 | L2-Norm=12.789 | L2-Norm(final)=8.987 | 2705.2 samples/s | 42.3 steps/s
[Step=10300 Epoch=50.2] | Loss=0.10433 | Reg=0.00164 | acc=0.9375 | L2-Norm=12.789 | L2-Norm(final)=9.034 | 5385.2 samples/s | 84.1 steps/s
[Step=10350 Epoch=50.5] | Loss=0.10312 | Reg=0.00164 | acc=0.9062 | L2-Norm=12.789 | L2-Norm(final)=9.083 | 5623.2 samples/s | 87.9 steps/s
[Step=10400 Epoch=50.7] | Loss=0.10278 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.789 | L2-Norm(final)=9.132 | 7568.8 samples/s | 118.3 steps/s
[Step=10450 Epoch=51.0] | Loss=0.10170 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.789 | L2-Norm(final)=9.181 | 2841.7 samples/s | 44.4 steps/s
[Step=10500 Epoch=51.2] | Loss=0.10127 | Reg=0.00164 | acc=0.9219 | L2-Norm=12.789 | L2-Norm(final)=9.230 | 5446.9 samples/s | 85.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=51.2] | Loss=0.12337 | Reg=0.00164 | acc=0.8750 | L2-Norm=12.790 | L2-Norm(final)=9.716 | 6581.3 samples/s | 102.8 steps/s
[Step=10550 Epoch=51.4] | Loss=0.07225 | Reg=0.00166 | acc=0.8906 | L2-Norm=12.879 | L2-Norm(final)=9.741 | 4536.7 samples/s | 70.9 steps/s
[Step=10600 Epoch=51.7] | Loss=0.06431 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.954 | L2-Norm(final)=9.741 | 4821.4 samples/s | 75.3 steps/s
[Step=10650 Epoch=51.9] | Loss=0.05851 | Reg=0.00169 | acc=0.9219 | L2-Norm=13.011 | L2-Norm(final)=9.738 | 4690.3 samples/s | 73.3 steps/s
[Step=10700 Epoch=52.2] | Loss=0.05436 | Reg=0.00170 | acc=0.9531 | L2-Norm=13.056 | L2-Norm(final)=9.735 | 6853.1 samples/s | 107.1 steps/s
[Step=10750 Epoch=52.4] | Loss=0.04808 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.095 | L2-Norm(final)=9.737 | 2471.2 samples/s | 38.6 steps/s
[Step=10800 Epoch=52.7] | Loss=0.04296 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.128 | L2-Norm(final)=9.741 | 4810.2 samples/s | 75.2 steps/s
[Step=10850 Epoch=52.9] | Loss=0.04018 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.157 | L2-Norm(final)=9.745 | 4779.4 samples/s | 74.7 steps/s
[Step=10900 Epoch=53.2] | Loss=0.03739 | Reg=0.00174 | acc=0.9688 | L2-Norm=13.183 | L2-Norm(final)=9.749 | 6170.3 samples/s | 96.4 steps/s
[Step=10950 Epoch=53.4] | Loss=0.03466 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.207 | L2-Norm(final)=9.753 | 2567.1 samples/s | 40.1 steps/s
[Step=11000 Epoch=53.6] | Loss=0.03236 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.229 | L2-Norm(final)=9.758 | 4761.3 samples/s | 74.4 steps/s
[Step=11050 Epoch=53.9] | Loss=0.03056 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.248 | L2-Norm(final)=9.763 | 4819.2 samples/s | 75.3 steps/s
[Step=11100 Epoch=54.1] | Loss=0.02902 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.266 | L2-Norm(final)=9.768 | 5628.7 samples/s | 87.9 steps/s
[Step=11150 Epoch=54.4] | Loss=0.02761 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=9.772 | 2673.7 samples/s | 41.8 steps/s
[Step=11200 Epoch=54.6] | Loss=0.02616 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.298 | L2-Norm(final)=9.776 | 4734.0 samples/s | 74.0 steps/s
[Step=11250 Epoch=54.9] | Loss=0.02510 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.312 | L2-Norm(final)=9.780 | 4795.4 samples/s | 74.9 steps/s
[Step=11300 Epoch=55.1] | Loss=0.02413 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=9.784 | 5238.3 samples/s | 81.8 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02311 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.336 | L2-Norm(final)=9.788 | 2759.9 samples/s | 43.1 steps/s
[Step=11400 Epoch=55.6] | Loss=0.02211 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=9.792 | 4772.6 samples/s | 74.6 steps/s
[Step=11450 Epoch=55.8] | Loss=0.02130 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.357 | L2-Norm(final)=9.795 | 4805.1 samples/s | 75.1 steps/s
[Step=11500 Epoch=56.1] | Loss=0.02060 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.367 | L2-Norm(final)=9.799 | 4856.7 samples/s | 75.9 steps/s
[Step=11550 Epoch=56.3] | Loss=0.02003 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.376 | L2-Norm(final)=9.803 | 2894.3 samples/s | 45.2 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01943 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.384 | L2-Norm(final)=9.806 | 4778.3 samples/s | 74.7 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01876 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.393 | L2-Norm(final)=9.810 | 4734.7 samples/s | 74.0 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01816 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.400 | L2-Norm(final)=9.814 | 4759.8 samples/s | 74.4 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01779 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.407 | L2-Norm(final)=9.817 | 2980.0 samples/s | 46.6 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01725 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.414 | L2-Norm(final)=9.820 | 4629.7 samples/s | 72.3 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01688 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.421 | L2-Norm(final)=9.824 | 4789.9 samples/s | 74.8 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01652 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.427 | L2-Norm(final)=9.827 | 4739.2 samples/s | 74.0 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01616 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.433 | L2-Norm(final)=9.830 | 2964.3 samples/s | 46.3 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01578 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.439 | L2-Norm(final)=9.833 | 4769.3 samples/s | 74.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step12000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=58.6] | Loss=0.07339 | Reg=0.00163 | acc=0.9375 | L2-Norm=12.785 | L2-Norm(final)=10.317 | 6703.3 samples/s | 104.7 steps/s
[Step=12050 Epoch=58.8] | Loss=0.09743 | Reg=0.00164 | acc=0.9219 | L2-Norm=12.787 | L2-Norm(final)=10.366 | 4296.0 samples/s | 67.1 steps/s
[Step=12100 Epoch=59.0] | Loss=0.09633 | Reg=0.00164 | acc=0.8906 | L2-Norm=12.787 | L2-Norm(final)=10.432 | 5597.2 samples/s | 87.5 steps/s
[Step=12150 Epoch=59.3] | Loss=0.09446 | Reg=0.00164 | acc=0.9375 | L2-Norm=12.787 | L2-Norm(final)=10.494 | 5522.7 samples/s | 86.3 steps/s
[Step=12200 Epoch=59.5] | Loss=0.09310 | Reg=0.00164 | acc=0.9219 | L2-Norm=12.787 | L2-Norm(final)=10.558 | 8684.5 samples/s | 135.7 steps/s
[Step=12250 Epoch=59.8] | Loss=0.09300 | Reg=0.00164 | acc=0.9062 | L2-Norm=12.787 | L2-Norm(final)=10.623 | 2647.8 samples/s | 41.4 steps/s
[Step=12300 Epoch=60.0] | Loss=0.09217 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.787 | L2-Norm(final)=10.686 | 5705.0 samples/s | 89.1 steps/s
[Step=12350 Epoch=60.3] | Loss=0.09253 | Reg=0.00164 | acc=0.9219 | L2-Norm=12.787 | L2-Norm(final)=10.747 | 5426.7 samples/s | 84.8 steps/s
[Step=12400 Epoch=60.5] | Loss=0.09215 | Reg=0.00164 | acc=0.9375 | L2-Norm=12.787 | L2-Norm(final)=10.806 | 7880.4 samples/s | 123.1 steps/s
[Step=12450 Epoch=60.8] | Loss=0.09108 | Reg=0.00164 | acc=0.9375 | L2-Norm=12.787 | L2-Norm(final)=10.864 | 2757.7 samples/s | 43.1 steps/s
[Step=12500 Epoch=61.0] | Loss=0.09093 | Reg=0.00164 | acc=0.9062 | L2-Norm=12.787 | L2-Norm(final)=10.921 | 5596.1 samples/s | 87.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=61.0] | Loss=0.12048 | Reg=0.00164 | acc=0.9062 | L2-Norm=12.787 | L2-Norm(final)=11.485 | 7011.7 samples/s | 109.6 steps/s
[Step=12550 Epoch=61.2] | Loss=0.06708 | Reg=0.00166 | acc=0.9375 | L2-Norm=12.879 | L2-Norm(final)=11.510 | 4548.4 samples/s | 71.1 steps/s
[Step=12600 Epoch=61.5] | Loss=0.06028 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.959 | L2-Norm(final)=11.508 | 4772.2 samples/s | 74.6 steps/s
[Step=12650 Epoch=61.7] | Loss=0.05543 | Reg=0.00169 | acc=0.9219 | L2-Norm=13.016 | L2-Norm(final)=11.505 | 4702.3 samples/s | 73.5 steps/s
[Step=12700 Epoch=62.0] | Loss=0.05220 | Reg=0.00171 | acc=0.9219 | L2-Norm=13.061 | L2-Norm(final)=11.501 | 6895.1 samples/s | 107.7 steps/s
[Step=12750 Epoch=62.2] | Loss=0.04654 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=11.500 | 2499.3 samples/s | 39.1 steps/s
[Step=12800 Epoch=62.5] | Loss=0.04256 | Reg=0.00173 | acc=0.9688 | L2-Norm=13.136 | L2-Norm(final)=11.503 | 4669.2 samples/s | 73.0 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03863 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.164 | L2-Norm(final)=11.505 | 4763.5 samples/s | 74.4 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03546 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.190 | L2-Norm(final)=11.509 | 6349.0 samples/s | 99.2 steps/s
[Step=12950 Epoch=63.2] | Loss=0.03303 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.213 | L2-Norm(final)=11.513 | 2533.7 samples/s | 39.6 steps/s
[Step=13000 Epoch=63.4] | Loss=0.03062 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.234 | L2-Norm(final)=11.517 | 4787.8 samples/s | 74.8 steps/s
[Step=13050 Epoch=63.7] | Loss=0.02871 | Reg=0.00176 | acc=0.9688 | L2-Norm=13.252 | L2-Norm(final)=11.521 | 4777.8 samples/s | 74.7 steps/s
[Step=13100 Epoch=63.9] | Loss=0.02737 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.269 | L2-Norm(final)=11.524 | 5882.6 samples/s | 91.9 steps/s
[Step=13150 Epoch=64.2] | Loss=0.02618 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=11.527 | 2631.9 samples/s | 41.1 steps/s
[Step=13200 Epoch=64.4] | Loss=0.02481 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.297 | L2-Norm(final)=11.531 | 4724.7 samples/s | 73.8 steps/s
[Step=13250 Epoch=64.7] | Loss=0.02363 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=11.534 | 4790.9 samples/s | 74.9 steps/s
[Step=13300 Epoch=64.9] | Loss=0.02282 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.321 | L2-Norm(final)=11.538 | 5507.6 samples/s | 86.1 steps/s
[Step=13350 Epoch=65.1] | Loss=0.02191 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=11.541 | 2705.3 samples/s | 42.3 steps/s
[Step=13400 Epoch=65.4] | Loss=0.02119 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.344 | L2-Norm(final)=11.544 | 4706.0 samples/s | 73.5 steps/s
[Step=13450 Epoch=65.6] | Loss=0.02036 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=11.546 | 4749.4 samples/s | 74.2 steps/s
[Step=13500 Epoch=65.9] | Loss=0.01972 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=11.549 | 5157.3 samples/s | 80.6 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01914 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=11.552 | 2801.8 samples/s | 43.8 steps/s
[Step=13600 Epoch=66.4] | Loss=0.01864 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.379 | L2-Norm(final)=11.554 | 4804.5 samples/s | 75.1 steps/s
[Step=13650 Epoch=66.6] | Loss=0.01807 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=11.557 | 4720.8 samples/s | 73.8 steps/s
[Step=13700 Epoch=66.8] | Loss=0.01755 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.394 | L2-Norm(final)=11.560 | 4887.2 samples/s | 76.4 steps/s
[Step=13750 Epoch=67.1] | Loss=0.01712 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.401 | L2-Norm(final)=11.563 | 2890.5 samples/s | 45.2 steps/s
[Step=13800 Epoch=67.3] | Loss=0.01665 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.407 | L2-Norm(final)=11.565 | 4745.9 samples/s | 74.2 steps/s
[Step=13850 Epoch=67.6] | Loss=0.01619 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.414 | L2-Norm(final)=11.568 | 4811.2 samples/s | 75.2 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01576 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.419 | L2-Norm(final)=11.571 | 4695.2 samples/s | 73.4 steps/s
[Step=13950 Epoch=68.1] | Loss=0.01533 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.425 | L2-Norm(final)=11.574 | 2920.8 samples/s | 45.6 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01498 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.430 | L2-Norm(final)=11.577 | 4794.8 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step14000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=48.8] | Loss=0.09548 | Reg=0.00163 | acc=0.9062 | L2-Norm=12.785 | L2-Norm(final)=9.333 | 7240.3 samples/s | 113.1 steps/s
[Step=10050 Epoch=49.0] | Loss=0.09818 | Reg=0.00164 | acc=0.9531 | L2-Norm=12.787 | L2-Norm(final)=9.362 | 4949.8 samples/s | 77.3 steps/s
[Step=10100 Epoch=49.3] | Loss=0.09547 | Reg=0.00164 | acc=0.9531 | L2-Norm=12.787 | L2-Norm(final)=9.418 | 5692.2 samples/s | 88.9 steps/s
[Step=10150 Epoch=49.5] | Loss=0.09671 | Reg=0.00164 | acc=0.8750 | L2-Norm=12.787 | L2-Norm(final)=9.483 | 5384.4 samples/s | 84.1 steps/s
[Step=10200 Epoch=49.7] | Loss=0.09422 | Reg=0.00164 | acc=0.9531 | L2-Norm=12.787 | L2-Norm(final)=9.550 | 8512.6 samples/s | 133.0 steps/s
[Step=10250 Epoch=50.0] | Loss=0.09362 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.787 | L2-Norm(final)=9.619 | 2692.6 samples/s | 42.1 steps/s
[Step=10300 Epoch=50.2] | Loss=0.09339 | Reg=0.00164 | acc=0.9219 | L2-Norm=12.787 | L2-Norm(final)=9.688 | 5565.0 samples/s | 87.0 steps/s
[Step=10350 Epoch=50.5] | Loss=0.09302 | Reg=0.00164 | acc=0.8750 | L2-Norm=12.787 | L2-Norm(final)=9.755 | 5526.5 samples/s | 86.4 steps/s
[Step=10400 Epoch=50.7] | Loss=0.09234 | Reg=0.00164 | acc=0.9219 | L2-Norm=12.787 | L2-Norm(final)=9.821 | 7674.7 samples/s | 119.9 steps/s
[Step=10450 Epoch=51.0] | Loss=0.09244 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.787 | L2-Norm(final)=9.885 | 2796.9 samples/s | 43.7 steps/s
[Step=10500 Epoch=51.2] | Loss=0.09127 | Reg=0.00164 | acc=0.9375 | L2-Norm=12.787 | L2-Norm(final)=9.948 | 5459.0 samples/s | 85.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=51.2] | Loss=0.12452 | Reg=0.00164 | acc=0.9062 | L2-Norm=12.787 | L2-Norm(final)=10.575 | 7138.0 samples/s | 111.5 steps/s
[Step=10550 Epoch=51.4] | Loss=0.06676 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.891 | L2-Norm(final)=10.605 | 4286.3 samples/s | 67.0 steps/s
[Step=10600 Epoch=51.7] | Loss=0.05350 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.973 | L2-Norm(final)=10.606 | 4805.0 samples/s | 75.1 steps/s
[Step=10650 Epoch=51.9] | Loss=0.05133 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.029 | L2-Norm(final)=10.604 | 4713.0 samples/s | 73.6 steps/s
[Step=10700 Epoch=52.2] | Loss=0.04826 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.072 | L2-Norm(final)=10.601 | 6885.2 samples/s | 107.6 steps/s
[Step=10750 Epoch=52.4] | Loss=0.04218 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.109 | L2-Norm(final)=10.602 | 2443.6 samples/s | 38.2 steps/s
[Step=10800 Epoch=52.7] | Loss=0.03813 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.140 | L2-Norm(final)=10.606 | 4699.8 samples/s | 73.4 steps/s
[Step=10850 Epoch=52.9] | Loss=0.03481 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.167 | L2-Norm(final)=10.610 | 4755.7 samples/s | 74.3 steps/s
[Step=10900 Epoch=53.2] | Loss=0.03257 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.191 | L2-Norm(final)=10.613 | 6264.3 samples/s | 97.9 steps/s
[Step=10950 Epoch=53.4] | Loss=0.03014 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.212 | L2-Norm(final)=10.617 | 2561.5 samples/s | 40.0 steps/s
[Step=11000 Epoch=53.6] | Loss=0.02811 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.231 | L2-Norm(final)=10.620 | 4769.3 samples/s | 74.5 steps/s
[Step=11050 Epoch=53.9] | Loss=0.02648 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=10.624 | 4803.9 samples/s | 75.1 steps/s
[Step=11100 Epoch=54.1] | Loss=0.02501 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.263 | L2-Norm(final)=10.628 | 5655.9 samples/s | 88.4 steps/s
[Step=11150 Epoch=54.4] | Loss=0.02362 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.277 | L2-Norm(final)=10.632 | 2669.9 samples/s | 41.7 steps/s
[Step=11200 Epoch=54.6] | Loss=0.02235 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=10.636 | 4751.8 samples/s | 74.2 steps/s
[Step=11250 Epoch=54.9] | Loss=0.02142 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.302 | L2-Norm(final)=10.640 | 4749.2 samples/s | 74.2 steps/s
[Step=11300 Epoch=55.1] | Loss=0.02082 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.314 | L2-Norm(final)=10.644 | 5300.3 samples/s | 82.8 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02000 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.325 | L2-Norm(final)=10.648 | 2790.1 samples/s | 43.6 steps/s
[Step=11400 Epoch=55.6] | Loss=0.01915 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.336 | L2-Norm(final)=10.652 | 4673.6 samples/s | 73.0 steps/s
[Step=11450 Epoch=55.8] | Loss=0.01870 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=10.656 | 4779.8 samples/s | 74.7 steps/s
[Step=11500 Epoch=56.1] | Loss=0.01815 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=10.660 | 4890.0 samples/s | 76.4 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01763 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=10.663 | 2901.8 samples/s | 45.3 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01704 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=10.666 | 4777.5 samples/s | 74.6 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01647 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.383 | L2-Norm(final)=10.669 | 4699.5 samples/s | 73.4 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01612 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.390 | L2-Norm(final)=10.673 | 4774.3 samples/s | 74.6 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01567 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.397 | L2-Norm(final)=10.676 | 2938.0 samples/s | 45.9 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01528 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.404 | L2-Norm(final)=10.679 | 4812.0 samples/s | 75.2 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01481 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.410 | L2-Norm(final)=10.682 | 4693.4 samples/s | 73.3 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01443 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.416 | L2-Norm(final)=10.686 | 4801.4 samples/s | 75.0 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01412 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.422 | L2-Norm(final)=10.689 | 2953.8 samples/s | 46.2 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01381 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.427 | L2-Norm(final)=10.692 | 4831.6 samples/s | 75.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step12000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=113.7] | Loss=0.00696 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.785 | L2-Norm(final)=13.631 | 6914.8 samples/s | 108.0 steps/s
[Step=12050 Epoch=114.2] | Loss=0.00943 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.781 | L2-Norm(final)=13.644 | 4654.0 samples/s | 72.7 steps/s
[Step=12100 Epoch=114.7] | Loss=0.01027 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=13.667 | 8208.2 samples/s | 128.3 steps/s
[Step=12150 Epoch=115.1] | Loss=0.01057 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=13.693 | 2598.5 samples/s | 40.6 steps/s
[Step=12200 Epoch=115.6] | Loss=0.01016 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=13.723 | 7076.9 samples/s | 110.6 steps/s
[Step=12250 Epoch=116.1] | Loss=0.00996 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.780 | L2-Norm(final)=13.753 | 2665.2 samples/s | 41.6 steps/s
[Step=12300 Epoch=116.6] | Loss=0.00995 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=13.784 | 6552.4 samples/s | 102.4 steps/s
[Step=12350 Epoch=117.0] | Loss=0.00988 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=13.816 | 2820.3 samples/s | 44.1 steps/s
[Step=12400 Epoch=117.5] | Loss=0.00973 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=13.847 | 5820.1 samples/s | 90.9 steps/s
[Step=12450 Epoch=118.0] | Loss=0.00965 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.780 | L2-Norm(final)=13.880 | 2938.2 samples/s | 45.9 steps/s
[Step=12500 Epoch=118.4] | Loss=0.00968 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.780 | L2-Norm(final)=13.912 | 5392.3 samples/s | 84.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=118.5] | Loss=0.01021 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=14.230 | 6628.3 samples/s | 103.6 steps/s
[Step=12550 Epoch=118.9] | Loss=0.01090 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.817 | L2-Norm(final)=14.243 | 4129.0 samples/s | 64.5 steps/s
[Step=12600 Epoch=119.4] | Loss=0.00799 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.877 | L2-Norm(final)=14.236 | 6634.3 samples/s | 103.7 steps/s
[Step=12650 Epoch=119.9] | Loss=0.00540 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.902 | L2-Norm(final)=14.233 | 2392.7 samples/s | 37.4 steps/s
[Step=12700 Epoch=120.3] | Loss=0.00407 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.898 | L2-Norm(final)=14.234 | 5915.8 samples/s | 92.4 steps/s
[Step=12750 Epoch=120.8] | Loss=0.00326 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.881 | L2-Norm(final)=14.235 | 2491.2 samples/s | 38.9 steps/s
[Step=12800 Epoch=121.3] | Loss=0.00272 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.858 | L2-Norm(final)=14.236 | 5453.8 samples/s | 85.2 steps/s
[Step=12850 Epoch=121.8] | Loss=0.00233 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.833 | L2-Norm(final)=14.237 | 2559.3 samples/s | 40.0 steps/s
[Step=12900 Epoch=122.2] | Loss=0.00204 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.807 | L2-Norm(final)=14.238 | 5051.6 samples/s | 78.9 steps/s
[Step=12950 Epoch=122.7] | Loss=0.00182 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=14.239 | 2703.0 samples/s | 42.2 steps/s
[Step=13000 Epoch=123.2] | Loss=0.00164 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.754 | L2-Norm(final)=14.240 | 4651.9 samples/s | 72.7 steps/s
[Step=13050 Epoch=123.7] | Loss=0.00149 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.727 | L2-Norm(final)=14.241 | 2810.7 samples/s | 43.9 steps/s
[Step=13100 Epoch=124.1] | Loss=0.00137 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.701 | L2-Norm(final)=14.242 | 4619.2 samples/s | 72.2 steps/s
[Step=13150 Epoch=124.6] | Loss=0.00126 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.676 | L2-Norm(final)=14.243 | 2833.4 samples/s | 44.3 steps/s
[Step=13200 Epoch=125.1] | Loss=0.00117 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.650 | L2-Norm(final)=14.243 | 4618.3 samples/s | 72.2 steps/s
[Step=13250 Epoch=125.6] | Loss=0.00109 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.625 | L2-Norm(final)=14.244 | 2807.8 samples/s | 43.9 steps/s
[Step=13300 Epoch=126.0] | Loss=0.00103 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=14.245 | 4548.1 samples/s | 71.1 steps/s
[Step=13350 Epoch=126.5] | Loss=0.00097 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=14.245 | 2850.0 samples/s | 44.5 steps/s
[Step=13400 Epoch=127.0] | Loss=0.00091 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=14.246 | 4510.6 samples/s | 70.5 steps/s
[Step=13450 Epoch=127.5] | Loss=0.00086 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=14.247 | 6878.5 samples/s | 107.5 steps/s
[Step=13500 Epoch=127.9] | Loss=0.00082 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=14.247 | 2378.9 samples/s | 37.2 steps/s
[Step=13550 Epoch=128.4] | Loss=0.00078 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=14.248 | 6069.3 samples/s | 94.8 steps/s
[Step=13600 Epoch=128.9] | Loss=0.00075 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=14.249 | 2443.3 samples/s | 38.2 steps/s
[Step=13650 Epoch=129.3] | Loss=0.00072 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=14.249 | 5625.6 samples/s | 87.9 steps/s
[Step=13700 Epoch=129.8] | Loss=0.00069 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.415 | L2-Norm(final)=14.250 | 2548.2 samples/s | 39.8 steps/s
[Step=13750 Epoch=130.3] | Loss=0.00066 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.393 | L2-Norm(final)=14.250 | 5169.8 samples/s | 80.8 steps/s
[Step=13800 Epoch=130.8] | Loss=0.00063 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=14.251 | 2649.6 samples/s | 41.4 steps/s
[Step=13850 Epoch=131.2] | Loss=0.00061 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.349 | L2-Norm(final)=14.251 | 4804.6 samples/s | 75.1 steps/s
[Step=13900 Epoch=131.7] | Loss=0.00059 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.328 | L2-Norm(final)=14.252 | 2754.2 samples/s | 43.0 steps/s
[Step=13950 Epoch=132.2] | Loss=0.00057 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=14.252 | 4563.0 samples/s | 71.3 steps/s
[Step=14000 Epoch=132.7] | Loss=0.00055 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=14.253 | 2855.9 samples/s | 44.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step14000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=8001 Epoch=76.1] | Loss=0.01574 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.785 | L2-Norm(final)=11.132 | 6228.2 samples/s | 97.3 steps/s
[Step=8050 Epoch=76.6] | Loss=0.01500 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.781 | L2-Norm(final)=11.153 | 5001.6 samples/s | 78.1 steps/s
[Step=8100 Epoch=77.1] | Loss=0.01687 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=11.192 | 8219.8 samples/s | 128.4 steps/s
[Step=8150 Epoch=77.5] | Loss=0.01601 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=11.229 | 2549.1 samples/s | 39.8 steps/s
[Step=8200 Epoch=78.0] | Loss=0.01583 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=11.271 | 7339.0 samples/s | 114.7 steps/s
[Step=8250 Epoch=78.5] | Loss=0.01584 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=11.318 | 2669.3 samples/s | 41.7 steps/s
[Step=8300 Epoch=79.0] | Loss=0.01579 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=11.366 | 6576.7 samples/s | 102.8 steps/s
[Step=8350 Epoch=79.4] | Loss=0.01551 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=11.413 | 2831.2 samples/s | 44.2 steps/s
[Step=8400 Epoch=79.9] | Loss=0.01543 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=11.463 | 5771.5 samples/s | 90.2 steps/s
[Step=8450 Epoch=80.4] | Loss=0.01539 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=11.510 | 2905.4 samples/s | 45.4 steps/s
[Step=8500 Epoch=80.9] | Loss=0.01546 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.780 | L2-Norm(final)=11.556 | 5461.7 samples/s | 85.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=80.9] | Loss=0.01221 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=12.009 | 7469.7 samples/s | 116.7 steps/s
[Step=8550 Epoch=81.3] | Loss=0.00539 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.874 | L2-Norm(final)=12.030 | 4188.8 samples/s | 65.5 steps/s
[Step=8600 Epoch=81.8] | Loss=0.00468 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.949 | L2-Norm(final)=12.038 | 6646.1 samples/s | 103.8 steps/s
[Step=8650 Epoch=82.3] | Loss=0.00461 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.996 | L2-Norm(final)=12.033 | 2386.9 samples/s | 37.3 steps/s
[Step=8700 Epoch=82.8] | Loss=0.00348 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.016 | L2-Norm(final)=12.032 | 6060.3 samples/s | 94.7 steps/s
[Step=8750 Epoch=83.2] | Loss=0.00279 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.016 | L2-Norm(final)=12.032 | 2486.2 samples/s | 38.8 steps/s
[Step=8800 Epoch=83.7] | Loss=0.00233 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.006 | L2-Norm(final)=12.033 | 5483.0 samples/s | 85.7 steps/s
[Step=8850 Epoch=84.2] | Loss=0.00200 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.990 | L2-Norm(final)=12.033 | 2572.2 samples/s | 40.2 steps/s
[Step=8900 Epoch=84.7] | Loss=0.00175 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.971 | L2-Norm(final)=12.034 | 5073.1 samples/s | 79.3 steps/s
[Step=8950 Epoch=85.1] | Loss=0.00156 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.950 | L2-Norm(final)=12.034 | 2654.0 samples/s | 41.5 steps/s
[Step=9000 Epoch=85.6] | Loss=0.00140 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.928 | L2-Norm(final)=12.035 | 4662.6 samples/s | 72.9 steps/s
[Step=9050 Epoch=86.1] | Loss=0.00128 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.906 | L2-Norm(final)=12.036 | 2805.1 samples/s | 43.8 steps/s
[Step=9100 Epoch=86.6] | Loss=0.00117 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.882 | L2-Norm(final)=12.036 | 4566.7 samples/s | 71.4 steps/s
[Step=9150 Epoch=87.0] | Loss=0.00108 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.859 | L2-Norm(final)=12.037 | 2847.1 samples/s | 44.5 steps/s
[Step=9200 Epoch=87.5] | Loss=0.00100 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.836 | L2-Norm(final)=12.038 | 4573.1 samples/s | 71.5 steps/s
[Step=9250 Epoch=88.0] | Loss=0.00094 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.812 | L2-Norm(final)=12.038 | 2836.7 samples/s | 44.3 steps/s
[Step=9300 Epoch=88.5] | Loss=0.00088 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=12.039 | 4554.7 samples/s | 71.2 steps/s
[Step=9350 Epoch=88.9] | Loss=0.00083 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.765 | L2-Norm(final)=12.039 | 3072.3 samples/s | 48.0 steps/s
[Step=9400 Epoch=89.4] | Loss=0.00078 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.741 | L2-Norm(final)=12.040 | 4165.3 samples/s | 65.1 steps/s
[Step=9450 Epoch=89.9] | Loss=0.00074 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.718 | L2-Norm(final)=12.040 | 6683.6 samples/s | 104.4 steps/s
[Step=9500 Epoch=90.4] | Loss=0.00070 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.694 | L2-Norm(final)=12.041 | 2359.6 samples/s | 36.9 steps/s
[Step=9550 Epoch=90.8] | Loss=0.00067 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.671 | L2-Norm(final)=12.041 | 6120.0 samples/s | 95.6 steps/s
[Step=9600 Epoch=91.3] | Loss=0.00064 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.648 | L2-Norm(final)=12.042 | 2444.0 samples/s | 38.2 steps/s
[Step=9650 Epoch=91.8] | Loss=0.00061 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.625 | L2-Norm(final)=12.043 | 5640.0 samples/s | 88.1 steps/s
[Step=9700 Epoch=92.3] | Loss=0.00059 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=12.043 | 2536.1 samples/s | 39.6 steps/s
[Step=9750 Epoch=92.7] | Loss=0.00056 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.579 | L2-Norm(final)=12.044 | 5187.1 samples/s | 81.0 steps/s
[Step=9800 Epoch=93.2] | Loss=0.00054 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.556 | L2-Norm(final)=12.044 | 2668.3 samples/s | 41.7 steps/s
[Step=9850 Epoch=93.7] | Loss=0.00052 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=12.045 | 4695.7 samples/s | 73.4 steps/s
[Step=9900 Epoch=94.2] | Loss=0.00050 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.510 | L2-Norm(final)=12.045 | 2801.0 samples/s | 43.8 steps/s
[Step=9950 Epoch=94.6] | Loss=0.00049 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=12.045 | 4433.7 samples/s | 69.3 steps/s
[Step=10000 Epoch=95.1] | Loss=0.00047 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=12.046 | 2866.2 samples/s | 44.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10312 | acc=0.9517 | tpr=0.9646 | fpr=0.0763 | 5660.6 samples/s | 22.1 steps/s
Avg test loss: 0.10951, Avg test acc: 0.94935, Avg tpr: 0.96252, Avg fpr: 0.07961, total FA: 621

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.12196 | acc=0.9471 | tpr=0.9683 | fpr=0.0989 | 6104.2 samples/s | 23.8 steps/s
Avg test loss: 0.12318, Avg test acc: 0.94811, Avg tpr: 0.96853, Avg fpr: 0.09678, total FA: 755

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.13247 | acc=0.9334 | tpr=0.9445 | fpr=0.0909 | 6072.7 samples/s | 23.7 steps/s
Avg test loss: 0.13823, Avg test acc: 0.93064, Avg tpr: 0.94008, Avg fpr: 0.09012, total FA: 703

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.11848 | acc=0.9509 | tpr=0.9633 | fpr=0.0758 | 6086.1 samples/s | 23.8 steps/s
Avg test loss: 0.12432, Avg test acc: 0.94859, Avg tpr: 0.96089, Avg fpr: 0.07845, total FA: 612

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.16531 | acc=0.9237 | tpr=0.9199 | fpr=0.0681 | 5926.5 samples/s | 23.2 steps/s
Avg test loss: 0.16825, Avg test acc: 0.92203, Avg tpr: 0.91694, Avg fpr: 0.06679, total FA: 521

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.34988 | acc=0.3104 | tpr=0.0173 | fpr=0.0533 | 5911.2 samples/s | 23.1 steps/s
Avg test loss: 5.36110, Avg test acc: 0.30708, Avg tpr: 0.01574, Avg fpr: 0.05217, total FA: 407

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.25237 | acc=0.3145 | tpr=0.0177 | fpr=0.0409 | 5964.0 samples/s | 23.3 steps/s
Avg test loss: 5.25584, Avg test acc: 0.31136, Avg tpr: 0.01632, Avg fpr: 0.03974, total FA: 310

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.13446 | acc=0.3227 | tpr=0.0330 | fpr=0.0481 | 6101.4 samples/s | 23.8 steps/s
Avg test loss: 4.14066, Avg test acc: 0.32086, Avg tpr: 0.03322, Avg fpr: 0.04653, total FA: 363

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.75208 | acc=0.3192 | tpr=0.0413 | fpr=0.0773 | 5985.2 samples/s | 23.4 steps/s
Avg test loss: 4.75405, Avg test acc: 0.31697, Avg tpr: 0.04103, Avg fpr: 0.07614, total FA: 594

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=3.91120 | acc=0.3131 | tpr=0.0135 | fpr=0.0362 | 6002.5 samples/s | 23.4 steps/s
Avg test loss: 3.92539, Avg test acc: 0.31160, Avg tpr: 0.01370, Avg fpr: 0.03320, total FA: 259

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.35001 | acc=0.1342 | tpr=0.6814 | fpr=0.8756 | 5946.7 samples/s | 23.2 steps/s
[Step= 100] | Loss=5.34005 | acc=0.1360 | tpr=0.6567 | fpr=0.8737 | 7573.9 samples/s | 29.6 steps/s
[Step= 150] | Loss=5.34241 | acc=0.1376 | tpr=0.6643 | fpr=0.8721 | 8294.0 samples/s | 32.4 steps/s
[Step= 200] | Loss=5.33589 | acc=0.1376 | tpr=0.6612 | fpr=0.8720 | 7898.7 samples/s | 30.9 steps/s
[Step= 250] | Loss=5.34203 | acc=0.1374 | tpr=0.6533 | fpr=0.8720 | 7263.9 samples/s | 28.4 steps/s
[Step= 300] | Loss=5.33571 | acc=0.1373 | tpr=0.6480 | fpr=0.8720 | 8411.5 samples/s | 32.9 steps/s
[Step= 350] | Loss=5.34084 | acc=0.1370 | tpr=0.6425 | fpr=0.8722 | 8441.8 samples/s | 33.0 steps/s
[Step= 400] | Loss=5.34077 | acc=0.1370 | tpr=0.6400 | fpr=0.8721 | 7737.0 samples/s | 30.2 steps/s
[Step= 450] | Loss=5.34257 | acc=0.1367 | tpr=0.6441 | fpr=0.8725 | 8259.2 samples/s | 32.3 steps/s
[Step= 500] | Loss=5.34335 | acc=0.1367 | tpr=0.6480 | fpr=0.8725 | 7950.7 samples/s | 31.1 steps/s
[Step= 550] | Loss=5.34731 | acc=0.1368 | tpr=0.6470 | fpr=0.8725 | 10844.4 samples/s | 42.4 steps/s
Avg test loss: 5.34820, Avg test acc: 0.13672, Avg tpr: 0.64739, Avg fpr: 0.87257, total FA: 121154

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.53833 | acc=0.1373 | tpr=0.6814 | fpr=0.8724 | 5537.0 samples/s | 21.6 steps/s
[Step= 100] | Loss=5.52258 | acc=0.1395 | tpr=0.6759 | fpr=0.8705 | 8318.9 samples/s | 32.5 steps/s
[Step= 150] | Loss=5.51394 | acc=0.1400 | tpr=0.6816 | fpr=0.8700 | 8276.1 samples/s | 32.3 steps/s
[Step= 200] | Loss=5.51769 | acc=0.1395 | tpr=0.6787 | fpr=0.8703 | 8184.6 samples/s | 32.0 steps/s
[Step= 250] | Loss=5.52439 | acc=0.1393 | tpr=0.6803 | fpr=0.8706 | 8081.9 samples/s | 31.6 steps/s
[Step= 300] | Loss=5.51914 | acc=0.1393 | tpr=0.6756 | fpr=0.8705 | 7664.4 samples/s | 29.9 steps/s
[Step= 350] | Loss=5.52539 | acc=0.1387 | tpr=0.6738 | fpr=0.8710 | 7926.0 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.52149 | acc=0.1390 | tpr=0.6767 | fpr=0.8707 | 7568.2 samples/s | 29.6 steps/s
[Step= 450] | Loss=5.52569 | acc=0.1387 | tpr=0.6782 | fpr=0.8711 | 8193.0 samples/s | 32.0 steps/s
[Step= 500] | Loss=5.52731 | acc=0.1386 | tpr=0.6802 | fpr=0.8711 | 8177.7 samples/s | 31.9 steps/s
[Step= 550] | Loss=5.53387 | acc=0.1385 | tpr=0.6844 | fpr=0.8714 | 11116.7 samples/s | 43.4 steps/s
Avg test loss: 5.53475, Avg test acc: 0.13844, Avg tpr: 0.68463, Avg fpr: 0.87149, total FA: 121005

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.34471 | acc=0.1136 | tpr=0.7434 | fpr=0.8977 | 5925.9 samples/s | 23.1 steps/s
[Step= 100] | Loss=4.32650 | acc=0.1148 | tpr=0.7569 | fpr=0.8972 | 8056.5 samples/s | 31.5 steps/s
[Step= 150] | Loss=4.31349 | acc=0.1165 | tpr=0.7594 | fpr=0.8953 | 8116.7 samples/s | 31.7 steps/s
[Step= 200] | Loss=4.31334 | acc=0.1170 | tpr=0.7508 | fpr=0.8946 | 8204.4 samples/s | 32.0 steps/s
[Step= 250] | Loss=4.31276 | acc=0.1176 | tpr=0.7511 | fpr=0.8940 | 7059.4 samples/s | 27.6 steps/s
[Step= 300] | Loss=4.31065 | acc=0.1176 | tpr=0.7491 | fpr=0.8939 | 8464.9 samples/s | 33.1 steps/s
[Step= 350] | Loss=4.31380 | acc=0.1177 | tpr=0.7495 | fpr=0.8938 | 8798.5 samples/s | 34.4 steps/s
[Step= 400] | Loss=4.31518 | acc=0.1171 | tpr=0.7462 | fpr=0.8943 | 8174.9 samples/s | 31.9 steps/s
[Step= 450] | Loss=4.31839 | acc=0.1166 | tpr=0.7517 | fpr=0.8949 | 7187.2 samples/s | 28.1 steps/s
[Step= 500] | Loss=4.31930 | acc=0.1165 | tpr=0.7542 | fpr=0.8950 | 8509.4 samples/s | 33.2 steps/s
[Step= 550] | Loss=4.32218 | acc=0.1166 | tpr=0.7557 | fpr=0.8951 | 10161.4 samples/s | 39.7 steps/s
Avg test loss: 4.32309, Avg test acc: 0.11654, Avg tpr: 0.75634, Avg fpr: 0.89509, total FA: 124281

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.66530 | acc=0.1398 | tpr=0.7257 | fpr=0.8707 | 6019.5 samples/s | 23.5 steps/s
[Step= 100] | Loss=5.64256 | acc=0.1419 | tpr=0.7079 | fpr=0.8686 | 7499.7 samples/s | 29.3 steps/s
[Step= 150] | Loss=5.63596 | acc=0.1435 | tpr=0.7161 | fpr=0.8670 | 8658.3 samples/s | 33.8 steps/s
[Step= 200] | Loss=5.63561 | acc=0.1438 | tpr=0.7137 | fpr=0.8665 | 7744.2 samples/s | 30.3 steps/s
[Step= 250] | Loss=5.63499 | acc=0.1436 | tpr=0.7135 | fpr=0.8668 | 7775.7 samples/s | 30.4 steps/s
[Step= 300] | Loss=5.62631 | acc=0.1437 | tpr=0.7091 | fpr=0.8666 | 8265.6 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.63170 | acc=0.1434 | tpr=0.7082 | fpr=0.8669 | 8094.0 samples/s | 31.6 steps/s
[Step= 400] | Loss=5.63056 | acc=0.1439 | tpr=0.7068 | fpr=0.8663 | 7918.8 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.63572 | acc=0.1435 | tpr=0.7103 | fpr=0.8668 | 8006.3 samples/s | 31.3 steps/s
[Step= 500] | Loss=5.63601 | acc=0.1436 | tpr=0.7115 | fpr=0.8667 | 7844.0 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.64309 | acc=0.1436 | tpr=0.7127 | fpr=0.8668 | 10477.8 samples/s | 40.9 steps/s
Avg test loss: 5.64422, Avg test acc: 0.14350, Avg tpr: 0.71355, Avg fpr: 0.86686, total FA: 120362

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.89922 | acc=0.1627 | tpr=0.7080 | fpr=0.8471 | 5936.6 samples/s | 23.2 steps/s
[Step= 100] | Loss=4.88316 | acc=0.1657 | tpr=0.6844 | fpr=0.8440 | 8212.5 samples/s | 32.1 steps/s
[Step= 150] | Loss=4.87701 | acc=0.1667 | tpr=0.6744 | fpr=0.8427 | 7640.1 samples/s | 29.8 steps/s
[Step= 200] | Loss=4.87954 | acc=0.1674 | tpr=0.6710 | fpr=0.8418 | 7480.4 samples/s | 29.2 steps/s
[Step= 250] | Loss=4.87735 | acc=0.1667 | tpr=0.6664 | fpr=0.8424 | 7849.2 samples/s | 30.7 steps/s
[Step= 300] | Loss=4.87023 | acc=0.1665 | tpr=0.6604 | fpr=0.8425 | 8256.4 samples/s | 32.3 steps/s
[Step= 350] | Loss=4.87748 | acc=0.1661 | tpr=0.6587 | fpr=0.8428 | 8259.8 samples/s | 32.3 steps/s
[Step= 400] | Loss=4.87476 | acc=0.1664 | tpr=0.6625 | fpr=0.8426 | 8055.5 samples/s | 31.5 steps/s
[Step= 450] | Loss=4.87823 | acc=0.1658 | tpr=0.6611 | fpr=0.8432 | 8396.4 samples/s | 32.8 steps/s
[Step= 500] | Loss=4.87641 | acc=0.1657 | tpr=0.6612 | fpr=0.8432 | 7851.4 samples/s | 30.7 steps/s
[Step= 550] | Loss=4.87846 | acc=0.1660 | tpr=0.6614 | fpr=0.8430 | 11044.6 samples/s | 43.1 steps/s
Avg test loss: 4.88026, Avg test acc: 0.16592, Avg tpr: 0.66204, Avg fpr: 0.84310, total FA: 117063

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.16830 | acc=0.9612 | tpr=0.9204 | fpr=0.0381 | 6092.7 samples/s | 23.8 steps/s
[Step= 100] | Loss=0.17017 | acc=0.9599 | tpr=0.9424 | fpr=0.0398 | 7721.2 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.16874 | acc=0.9590 | tpr=0.9409 | fpr=0.0407 | 7887.8 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.16895 | acc=0.9591 | tpr=0.9486 | fpr=0.0407 | 7606.0 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.16920 | acc=0.9593 | tpr=0.9424 | fpr=0.0404 | 8620.3 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.17150 | acc=0.9586 | tpr=0.9360 | fpr=0.0410 | 8256.9 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.16962 | acc=0.9589 | tpr=0.9380 | fpr=0.0407 | 7933.2 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.16946 | acc=0.9586 | tpr=0.9349 | fpr=0.0409 | 7974.2 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.17199 | acc=0.9584 | tpr=0.9323 | fpr=0.0411 | 7937.1 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.17167 | acc=0.9583 | tpr=0.9326 | fpr=0.0412 | 8090.3 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.17037 | acc=0.9586 | tpr=0.9304 | fpr=0.0409 | 9827.2 samples/s | 38.4 steps/s
Avg test loss: 0.17004, Avg test acc: 0.95859, Avg tpr: 0.93027, Avg fpr: 0.04089, total FA: 5678

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15937 | acc=0.9584 | tpr=0.8805 | fpr=0.0402 | 6007.8 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.16091 | acc=0.9589 | tpr=0.9147 | fpr=0.0403 | 8235.7 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.16429 | acc=0.9575 | tpr=0.9207 | fpr=0.0418 | 7130.7 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.16482 | acc=0.9578 | tpr=0.9235 | fpr=0.0416 | 8157.1 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.16369 | acc=0.9580 | tpr=0.9240 | fpr=0.0413 | 7806.9 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.16666 | acc=0.9574 | tpr=0.9236 | fpr=0.0420 | 7633.9 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.16703 | acc=0.9575 | tpr=0.9230 | fpr=0.0419 | 8376.0 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.16735 | acc=0.9573 | tpr=0.9207 | fpr=0.0420 | 7670.9 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.16964 | acc=0.9569 | tpr=0.9187 | fpr=0.0424 | 8417.9 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.16956 | acc=0.9569 | tpr=0.9194 | fpr=0.0425 | 8190.3 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.16821 | acc=0.9571 | tpr=0.9176 | fpr=0.0422 | 11658.9 samples/s | 45.5 steps/s
Avg test loss: 0.16791, Avg test acc: 0.95709, Avg tpr: 0.91759, Avg fpr: 0.04219, total FA: 5858

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26713 | acc=0.9463 | tpr=0.9425 | fpr=0.0536 | 5981.9 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.27335 | acc=0.9450 | tpr=0.9574 | fpr=0.0552 | 8199.3 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.28003 | acc=0.9435 | tpr=0.9524 | fpr=0.0567 | 7905.7 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.27906 | acc=0.9434 | tpr=0.9519 | fpr=0.0568 | 7430.8 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.27929 | acc=0.9433 | tpr=0.9459 | fpr=0.0567 | 8219.7 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.28174 | acc=0.9430 | tpr=0.9425 | fpr=0.0570 | 8865.8 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.28091 | acc=0.9429 | tpr=0.9436 | fpr=0.0572 | 7840.5 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.28145 | acc=0.9425 | tpr=0.9431 | fpr=0.0575 | 8158.6 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.28426 | acc=0.9420 | tpr=0.9430 | fpr=0.0581 | 8227.4 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.28518 | acc=0.9417 | tpr=0.9445 | fpr=0.0584 | 8505.7 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.28423 | acc=0.9418 | tpr=0.9451 | fpr=0.0583 | 9056.1 samples/s | 35.4 steps/s
Avg test loss: 0.28382, Avg test acc: 0.94186, Avg tpr: 0.94532, Avg fpr: 0.05821, total FA: 8082

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.12342 | acc=0.9639 | tpr=0.8805 | fpr=0.0346 | 5955.0 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.13045 | acc=0.9627 | tpr=0.9019 | fpr=0.0361 | 7889.3 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.13203 | acc=0.9628 | tpr=0.9078 | fpr=0.0362 | 8118.8 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.13276 | acc=0.9626 | tpr=0.9093 | fpr=0.0365 | 8155.5 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.13407 | acc=0.9623 | tpr=0.9083 | fpr=0.0368 | 7934.7 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.13657 | acc=0.9620 | tpr=0.9062 | fpr=0.0370 | 8091.7 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.13654 | acc=0.9619 | tpr=0.9054 | fpr=0.0371 | 7572.0 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.13680 | acc=0.9617 | tpr=0.9048 | fpr=0.0372 | 8098.0 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.13832 | acc=0.9614 | tpr=0.9031 | fpr=0.0376 | 8630.8 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.13899 | acc=0.9613 | tpr=0.9062 | fpr=0.0377 | 8245.2 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.13809 | acc=0.9615 | tpr=0.9045 | fpr=0.0375 | 9244.9 samples/s | 36.1 steps/s
Avg test loss: 0.13784, Avg test acc: 0.96156, Avg tpr: 0.90452, Avg fpr: 0.03741, total FA: 5194

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21303 | acc=0.9535 | tpr=0.8761 | fpr=0.0451 | 6121.1 samples/s | 23.9 steps/s
[Step= 100] | Loss=0.21510 | acc=0.9529 | tpr=0.9083 | fpr=0.0463 | 7435.1 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.22071 | acc=0.9510 | tpr=0.9107 | fpr=0.0482 | 7764.0 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.22102 | acc=0.9512 | tpr=0.9169 | fpr=0.0482 | 8098.7 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.22287 | acc=0.9510 | tpr=0.9118 | fpr=0.0483 | 7931.1 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.22628 | acc=0.9504 | tpr=0.9047 | fpr=0.0488 | 8438.6 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.22485 | acc=0.9508 | tpr=0.9061 | fpr=0.0484 | 7981.0 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.22410 | acc=0.9506 | tpr=0.9032 | fpr=0.0485 | 8002.0 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.22604 | acc=0.9502 | tpr=0.9002 | fpr=0.0489 | 8393.3 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.22738 | acc=0.9499 | tpr=0.8996 | fpr=0.0492 | 7667.7 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.22580 | acc=0.9501 | tpr=0.8973 | fpr=0.0489 | 10378.9 samples/s | 40.5 steps/s
Avg test loss: 0.22566, Avg test acc: 0.95016, Avg tpr: 0.89699, Avg fpr: 0.04887, total FA: 6786

server round 11/50

clients selected: [4 5 6 7 8]

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=49.0] | Loss=0.06276 | Reg=0.00156 | acc=0.9375 | L2-Norm=12.487 | L2-Norm(final)=11.060 | 7316.1 samples/s | 114.3 steps/s
[Step=10050 Epoch=49.3] | Loss=0.08508 | Reg=0.00156 | acc=0.9062 | L2-Norm=12.492 | L2-Norm(final)=11.094 | 4786.8 samples/s | 74.8 steps/s
[Step=10100 Epoch=49.5] | Loss=0.08026 | Reg=0.00156 | acc=0.9375 | L2-Norm=12.493 | L2-Norm(final)=11.132 | 5677.4 samples/s | 88.7 steps/s
[Step=10150 Epoch=49.8] | Loss=0.07941 | Reg=0.00156 | acc=0.9375 | L2-Norm=12.493 | L2-Norm(final)=11.168 | 5474.7 samples/s | 85.5 steps/s
[Step=10200 Epoch=50.0] | Loss=0.08093 | Reg=0.00156 | acc=0.8750 | L2-Norm=12.493 | L2-Norm(final)=11.198 | 8954.1 samples/s | 139.9 steps/s
[Step=10250 Epoch=50.3] | Loss=0.08169 | Reg=0.00156 | acc=0.9375 | L2-Norm=12.493 | L2-Norm(final)=11.223 | 2634.3 samples/s | 41.2 steps/s
[Step=10300 Epoch=50.5] | Loss=0.08117 | Reg=0.00156 | acc=0.9375 | L2-Norm=12.493 | L2-Norm(final)=11.247 | 5587.0 samples/s | 87.3 steps/s
[Step=10350 Epoch=50.8] | Loss=0.08031 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.493 | L2-Norm(final)=11.270 | 5551.6 samples/s | 86.7 steps/s
[Step=10400 Epoch=51.0] | Loss=0.07945 | Reg=0.00156 | acc=0.9375 | L2-Norm=12.493 | L2-Norm(final)=11.294 | 8185.3 samples/s | 127.9 steps/s
[Step=10450 Epoch=51.2] | Loss=0.07876 | Reg=0.00156 | acc=0.9062 | L2-Norm=12.493 | L2-Norm(final)=11.319 | 2727.7 samples/s | 42.6 steps/s
[Step=10500 Epoch=51.5] | Loss=0.07883 | Reg=0.00156 | acc=0.9531 | L2-Norm=12.493 | L2-Norm(final)=11.344 | 5486.1 samples/s | 85.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=51.5] | Loss=0.06066 | Reg=0.00156 | acc=0.9531 | L2-Norm=12.494 | L2-Norm(final)=11.589 | 7353.5 samples/s | 114.9 steps/s
[Step=10550 Epoch=51.7] | Loss=0.05617 | Reg=0.00159 | acc=0.9062 | L2-Norm=12.595 | L2-Norm(final)=11.605 | 4287.5 samples/s | 67.0 steps/s
[Step=10600 Epoch=52.0] | Loss=0.05241 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.690 | L2-Norm(final)=11.596 | 4665.4 samples/s | 72.9 steps/s
[Step=10650 Epoch=52.2] | Loss=0.04673 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=11.591 | 4794.5 samples/s | 74.9 steps/s
[Step=10700 Epoch=52.5] | Loss=0.04411 | Reg=0.00164 | acc=0.9375 | L2-Norm=12.812 | L2-Norm(final)=11.588 | 7012.0 samples/s | 109.6 steps/s
[Step=10750 Epoch=52.7] | Loss=0.03838 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.857 | L2-Norm(final)=11.588 | 2442.3 samples/s | 38.2 steps/s
[Step=10800 Epoch=53.0] | Loss=0.03471 | Reg=0.00166 | acc=0.9375 | L2-Norm=12.895 | L2-Norm(final)=11.592 | 4756.0 samples/s | 74.3 steps/s
[Step=10850 Epoch=53.2] | Loss=0.03207 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.927 | L2-Norm(final)=11.596 | 4817.9 samples/s | 75.3 steps/s
[Step=10900 Epoch=53.5] | Loss=0.02981 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.955 | L2-Norm(final)=11.600 | 6461.5 samples/s | 101.0 steps/s
[Step=10950 Epoch=53.7] | Loss=0.02786 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.980 | L2-Norm(final)=11.603 | 2514.0 samples/s | 39.3 steps/s
[Step=11000 Epoch=53.9] | Loss=0.02619 | Reg=0.00169 | acc=0.9688 | L2-Norm=13.002 | L2-Norm(final)=11.607 | 4710.8 samples/s | 73.6 steps/s
[Step=11050 Epoch=54.2] | Loss=0.02477 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.022 | L2-Norm(final)=11.610 | 4777.7 samples/s | 74.7 steps/s
[Step=11100 Epoch=54.4] | Loss=0.02348 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.039 | L2-Norm(final)=11.613 | 6147.1 samples/s | 96.0 steps/s
[Step=11150 Epoch=54.7] | Loss=0.02214 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.055 | L2-Norm(final)=11.617 | 2573.8 samples/s | 40.2 steps/s
[Step=11200 Epoch=54.9] | Loss=0.02119 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.070 | L2-Norm(final)=11.621 | 4756.8 samples/s | 74.3 steps/s
[Step=11250 Epoch=55.2] | Loss=0.02026 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=11.625 | 4758.0 samples/s | 74.3 steps/s
[Step=11300 Epoch=55.4] | Loss=0.01952 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.095 | L2-Norm(final)=11.628 | 5812.8 samples/s | 90.8 steps/s
[Step=11350 Epoch=55.7] | Loss=0.01863 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.106 | L2-Norm(final)=11.631 | 2619.8 samples/s | 40.9 steps/s
[Step=11400 Epoch=55.9] | Loss=0.01779 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.117 | L2-Norm(final)=11.635 | 4839.2 samples/s | 75.6 steps/s
[Step=11450 Epoch=56.1] | Loss=0.01732 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.127 | L2-Norm(final)=11.639 | 4691.7 samples/s | 73.3 steps/s
[Step=11500 Epoch=56.4] | Loss=0.01684 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.136 | L2-Norm(final)=11.642 | 5479.6 samples/s | 85.6 steps/s
[Step=11550 Epoch=56.6] | Loss=0.01633 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.144 | L2-Norm(final)=11.644 | 2713.5 samples/s | 42.4 steps/s
[Step=11600 Epoch=56.9] | Loss=0.01588 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.152 | L2-Norm(final)=11.647 | 4775.5 samples/s | 74.6 steps/s
[Step=11650 Epoch=57.1] | Loss=0.01550 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.160 | L2-Norm(final)=11.650 | 4822.9 samples/s | 75.4 steps/s
[Step=11700 Epoch=57.4] | Loss=0.01514 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.167 | L2-Norm(final)=11.652 | 5163.2 samples/s | 80.7 steps/s
[Step=11750 Epoch=57.6] | Loss=0.01473 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.175 | L2-Norm(final)=11.654 | 2810.2 samples/s | 43.9 steps/s
[Step=11800 Epoch=57.9] | Loss=0.01432 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.182 | L2-Norm(final)=11.657 | 4743.6 samples/s | 74.1 steps/s
[Step=11850 Epoch=58.1] | Loss=0.01408 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.189 | L2-Norm(final)=11.660 | 4673.7 samples/s | 73.0 steps/s
[Step=11900 Epoch=58.4] | Loss=0.01382 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.196 | L2-Norm(final)=11.662 | 4995.8 samples/s | 78.1 steps/s
[Step=11950 Epoch=58.6] | Loss=0.01358 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.204 | L2-Norm(final)=11.664 | 2860.2 samples/s | 44.7 steps/s
[Step=12000 Epoch=58.8] | Loss=0.01324 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.210 | L2-Norm(final)=11.667 | 4761.8 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step12000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=132.7] | Loss=0.00645 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=14.270 | 6843.3 samples/s | 106.9 steps/s
[Step=14050 Epoch=133.1] | Loss=0.00420 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.480 | L2-Norm(final)=14.304 | 4705.8 samples/s | 73.5 steps/s
[Step=14100 Epoch=133.6] | Loss=0.00451 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=14.344 | 8052.3 samples/s | 125.8 steps/s
[Step=14150 Epoch=134.1] | Loss=0.00476 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=14.382 | 2591.9 samples/s | 40.5 steps/s
[Step=14200 Epoch=134.6] | Loss=0.00453 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=14.419 | 7065.3 samples/s | 110.4 steps/s
[Step=14250 Epoch=135.0] | Loss=0.00427 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=14.454 | 2711.5 samples/s | 42.4 steps/s
[Step=14300 Epoch=135.5] | Loss=0.00431 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=14.487 | 6328.1 samples/s | 98.9 steps/s
[Step=14350 Epoch=136.0] | Loss=0.00441 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.479 | L2-Norm(final)=14.520 | 2822.7 samples/s | 44.1 steps/s
[Step=14400 Epoch=136.5] | Loss=0.00428 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=14.552 | 5724.5 samples/s | 89.4 steps/s
[Step=14450 Epoch=136.9] | Loss=0.00443 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=14.583 | 2937.3 samples/s | 45.9 steps/s
[Step=14500 Epoch=137.4] | Loss=0.00431 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=14.613 | 5365.9 samples/s | 83.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=137.4] | Loss=0.00274 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=14.916 | 6702.3 samples/s | 104.7 steps/s
[Step=14550 Epoch=137.9] | Loss=0.00862 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.577 | L2-Norm(final)=14.921 | 4153.5 samples/s | 64.9 steps/s
[Step=14600 Epoch=138.3] | Loss=0.00562 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.688 | L2-Norm(final)=14.907 | 6566.5 samples/s | 102.6 steps/s
[Step=14650 Epoch=138.8] | Loss=0.00445 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.753 | L2-Norm(final)=14.904 | 2384.9 samples/s | 37.3 steps/s
[Step=14700 Epoch=139.3] | Loss=0.00372 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=14.904 | 6014.6 samples/s | 94.0 steps/s
[Step=14750 Epoch=139.8] | Loss=0.00299 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.805 | L2-Norm(final)=14.904 | 2494.4 samples/s | 39.0 steps/s
[Step=14800 Epoch=140.2] | Loss=0.00251 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.808 | L2-Norm(final)=14.904 | 5429.0 samples/s | 84.8 steps/s
[Step=14850 Epoch=140.7] | Loss=0.00215 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.803 | L2-Norm(final)=14.905 | 2586.5 samples/s | 40.4 steps/s
[Step=14900 Epoch=141.2] | Loss=0.00188 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.793 | L2-Norm(final)=14.905 | 5030.8 samples/s | 78.6 steps/s
[Step=14950 Epoch=141.7] | Loss=0.00168 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=14.906 | 2690.4 samples/s | 42.0 steps/s
[Step=15000 Epoch=142.1] | Loss=0.00151 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.765 | L2-Norm(final)=14.906 | 4694.1 samples/s | 73.3 steps/s
[Step=15050 Epoch=142.6] | Loss=0.00137 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.749 | L2-Norm(final)=14.907 | 2823.7 samples/s | 44.1 steps/s
[Step=15100 Epoch=143.1] | Loss=0.00126 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.732 | L2-Norm(final)=14.907 | 4532.0 samples/s | 70.8 steps/s
[Step=15150 Epoch=143.6] | Loss=0.00116 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.715 | L2-Norm(final)=14.908 | 2889.3 samples/s | 45.1 steps/s
[Step=15200 Epoch=144.0] | Loss=0.00108 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.697 | L2-Norm(final)=14.908 | 4425.7 samples/s | 69.2 steps/s
[Step=15250 Epoch=144.5] | Loss=0.00101 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.678 | L2-Norm(final)=14.908 | 2881.0 samples/s | 45.0 steps/s
[Step=15300 Epoch=145.0] | Loss=0.00094 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.660 | L2-Norm(final)=14.909 | 4434.9 samples/s | 69.3 steps/s
[Step=15350 Epoch=145.5] | Loss=0.00089 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.641 | L2-Norm(final)=14.909 | 3135.5 samples/s | 49.0 steps/s
[Step=15400 Epoch=145.9] | Loss=0.00084 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.623 | L2-Norm(final)=14.909 | 3993.8 samples/s | 62.4 steps/s
[Step=15450 Epoch=146.4] | Loss=0.00080 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.604 | L2-Norm(final)=14.910 | 6712.3 samples/s | 104.9 steps/s
[Step=15500 Epoch=146.9] | Loss=0.00076 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.586 | L2-Norm(final)=14.910 | 2360.3 samples/s | 36.9 steps/s
[Step=15550 Epoch=147.3] | Loss=0.00072 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.567 | L2-Norm(final)=14.910 | 6110.9 samples/s | 95.5 steps/s
[Step=15600 Epoch=147.8] | Loss=0.00069 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=14.911 | 2442.8 samples/s | 38.2 steps/s
[Step=15650 Epoch=148.3] | Loss=0.00066 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=14.911 | 5596.4 samples/s | 87.4 steps/s
[Step=15700 Epoch=148.8] | Loss=0.00063 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.512 | L2-Norm(final)=14.911 | 2549.8 samples/s | 39.8 steps/s
[Step=15750 Epoch=149.2] | Loss=0.00061 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.494 | L2-Norm(final)=14.912 | 5122.5 samples/s | 80.0 steps/s
[Step=15800 Epoch=149.7] | Loss=0.00058 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=14.912 | 2648.9 samples/s | 41.4 steps/s
[Step=15850 Epoch=150.2] | Loss=0.00056 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=14.912 | 4745.5 samples/s | 74.1 steps/s
[Step=15900 Epoch=150.7] | Loss=0.00054 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=14.913 | 2791.0 samples/s | 43.6 steps/s
[Step=15950 Epoch=151.1] | Loss=0.00052 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=14.913 | 4477.8 samples/s | 70.0 steps/s
[Step=16000 Epoch=151.6] | Loss=0.00050 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.403 | L2-Norm(final)=14.913 | 2856.4 samples/s | 44.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step16000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=95.1] | Loss=0.01822 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.487 | L2-Norm(final)=12.060 | 6713.3 samples/s | 104.9 steps/s
[Step=10050 Epoch=95.6] | Loss=0.00966 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.480 | L2-Norm(final)=12.099 | 4815.0 samples/s | 75.2 steps/s
[Step=10100 Epoch=96.1] | Loss=0.01131 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=12.118 | 8029.2 samples/s | 125.5 steps/s
[Step=10150 Epoch=96.6] | Loss=0.01143 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=12.134 | 2563.2 samples/s | 40.0 steps/s
[Step=10200 Epoch=97.0] | Loss=0.01121 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=12.154 | 7371.9 samples/s | 115.2 steps/s
[Step=10250 Epoch=97.5] | Loss=0.01102 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.478 | L2-Norm(final)=12.177 | 2643.8 samples/s | 41.3 steps/s
[Step=10300 Epoch=98.0] | Loss=0.01098 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=12.197 | 6569.9 samples/s | 102.7 steps/s
[Step=10350 Epoch=98.5] | Loss=0.01103 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.478 | L2-Norm(final)=12.219 | 2791.8 samples/s | 43.6 steps/s
[Step=10400 Epoch=98.9] | Loss=0.01082 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=12.242 | 5959.5 samples/s | 93.1 steps/s
[Step=10450 Epoch=99.4] | Loss=0.01111 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=12.263 | 3013.1 samples/s | 47.1 steps/s
[Step=10500 Epoch=99.9] | Loss=0.01096 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=12.282 | 5141.9 samples/s | 80.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=99.9] | Loss=0.01662 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.478 | L2-Norm(final)=12.467 | 6926.9 samples/s | 108.2 steps/s
[Step=10550 Epoch=100.4] | Loss=0.01192 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.694 | L2-Norm(final)=12.469 | 4084.4 samples/s | 63.8 steps/s
[Step=10600 Epoch=100.8] | Loss=0.00732 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.811 | L2-Norm(final)=12.458 | 6586.3 samples/s | 102.9 steps/s
[Step=10650 Epoch=101.3] | Loss=0.00503 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.849 | L2-Norm(final)=12.456 | 2434.5 samples/s | 38.0 steps/s
[Step=10700 Epoch=101.8] | Loss=0.00379 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.856 | L2-Norm(final)=12.458 | 5750.7 samples/s | 89.9 steps/s
[Step=10750 Epoch=102.3] | Loss=0.00304 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.848 | L2-Norm(final)=12.459 | 2485.0 samples/s | 38.8 steps/s
[Step=10800 Epoch=102.7] | Loss=0.00254 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.832 | L2-Norm(final)=12.460 | 5519.4 samples/s | 86.2 steps/s
[Step=10850 Epoch=103.2] | Loss=0.00218 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.813 | L2-Norm(final)=12.462 | 2604.0 samples/s | 40.7 steps/s
[Step=10900 Epoch=103.7] | Loss=0.00191 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.791 | L2-Norm(final)=12.463 | 4953.6 samples/s | 77.4 steps/s
[Step=10950 Epoch=104.2] | Loss=0.00169 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.768 | L2-Norm(final)=12.463 | 2707.0 samples/s | 42.3 steps/s
[Step=11000 Epoch=104.6] | Loss=0.00153 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.744 | L2-Norm(final)=12.464 | 4637.9 samples/s | 72.5 steps/s
[Step=11050 Epoch=105.1] | Loss=0.00139 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.720 | L2-Norm(final)=12.465 | 2796.6 samples/s | 43.7 steps/s
[Step=11100 Epoch=105.6] | Loss=0.00127 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.696 | L2-Norm(final)=12.466 | 4576.5 samples/s | 71.5 steps/s
[Step=11150 Epoch=106.1] | Loss=0.00118 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=12.466 | 2870.4 samples/s | 44.8 steps/s
[Step=11200 Epoch=106.5] | Loss=0.00109 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.648 | L2-Norm(final)=12.467 | 4504.6 samples/s | 70.4 steps/s
[Step=11250 Epoch=107.0] | Loss=0.00102 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.624 | L2-Norm(final)=12.467 | 2857.1 samples/s | 44.6 steps/s
[Step=11300 Epoch=107.5] | Loss=0.00096 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.600 | L2-Norm(final)=12.468 | 4496.8 samples/s | 70.3 steps/s
[Step=11350 Epoch=108.0] | Loss=0.00090 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=12.469 | 2967.0 samples/s | 46.4 steps/s
[Step=11400 Epoch=108.4] | Loss=0.00085 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=12.469 | 4278.3 samples/s | 66.8 steps/s
[Step=11450 Epoch=108.9] | Loss=0.00081 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=12.470 | 6905.9 samples/s | 107.9 steps/s
[Step=11500 Epoch=109.4] | Loss=0.00077 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=12.470 | 2362.4 samples/s | 36.9 steps/s
[Step=11550 Epoch=109.9] | Loss=0.00073 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=12.471 | 6128.5 samples/s | 95.8 steps/s
[Step=11600 Epoch=110.3] | Loss=0.00070 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=12.471 | 2463.7 samples/s | 38.5 steps/s
[Step=11650 Epoch=110.8] | Loss=0.00067 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=12.472 | 5564.1 samples/s | 86.9 steps/s
[Step=11700 Epoch=111.3] | Loss=0.00064 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.414 | L2-Norm(final)=12.472 | 2548.6 samples/s | 39.8 steps/s
[Step=11750 Epoch=111.8] | Loss=0.00061 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.391 | L2-Norm(final)=12.473 | 5127.3 samples/s | 80.1 steps/s
[Step=11800 Epoch=112.2] | Loss=0.00059 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=12.473 | 2677.8 samples/s | 41.8 steps/s
[Step=11850 Epoch=112.7] | Loss=0.00057 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.347 | L2-Norm(final)=12.474 | 4671.0 samples/s | 73.0 steps/s
[Step=11900 Epoch=113.2] | Loss=0.00055 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.324 | L2-Norm(final)=12.474 | 2770.9 samples/s | 43.3 steps/s
[Step=11950 Epoch=113.7] | Loss=0.00053 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.302 | L2-Norm(final)=12.475 | 4596.4 samples/s | 71.8 steps/s
[Step=12000 Epoch=114.1] | Loss=0.00051 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=12.475 | 2836.5 samples/s | 44.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step12000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=6001 Epoch=57.3] | Loss=0.03109 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.487 | L2-Norm(final)=8.294 | 7092.1 samples/s | 110.8 steps/s
[Step=6050 Epoch=57.8] | Loss=0.02762 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.484 | L2-Norm(final)=8.253 | 4513.4 samples/s | 70.5 steps/s
[Step=6100 Epoch=58.3] | Loss=0.02397 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.484 | L2-Norm(final)=8.217 | 8322.3 samples/s | 130.0 steps/s
[Step=6150 Epoch=58.7] | Loss=0.02175 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=8.202 | 2549.8 samples/s | 39.8 steps/s
[Step=6200 Epoch=59.2] | Loss=0.02127 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.484 | L2-Norm(final)=8.193 | 7565.0 samples/s | 118.2 steps/s
[Step=6250 Epoch=59.7] | Loss=0.02036 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=8.189 | 2643.1 samples/s | 41.3 steps/s
[Step=6300 Epoch=60.2] | Loss=0.01992 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=8.192 | 6814.4 samples/s | 106.5 steps/s
[Step=6350 Epoch=60.6] | Loss=0.01925 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.484 | L2-Norm(final)=8.201 | 2729.9 samples/s | 42.7 steps/s
[Step=6400 Epoch=61.1] | Loss=0.01890 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=8.214 | 6263.0 samples/s | 97.9 steps/s
[Step=6450 Epoch=61.6] | Loss=0.01842 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.484 | L2-Norm(final)=8.230 | 2839.5 samples/s | 44.4 steps/s
[Step=6500 Epoch=62.1] | Loss=0.01807 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.484 | L2-Norm(final)=8.250 | 5769.7 samples/s | 90.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=6501 Epoch=62.1] | Loss=0.00952 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=8.459 | 7170.3 samples/s | 112.0 steps/s
[Step=6550 Epoch=62.5] | Loss=0.00444 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.578 | L2-Norm(final)=8.485 | 3982.8 samples/s | 62.2 steps/s
[Step=6600 Epoch=63.0] | Loss=0.00371 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.638 | L2-Norm(final)=8.490 | 6686.8 samples/s | 104.5 steps/s
[Step=6650 Epoch=63.5] | Loss=0.00280 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=8.493 | 2399.7 samples/s | 37.5 steps/s
[Step=6700 Epoch=64.0] | Loss=0.00212 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.689 | L2-Norm(final)=8.496 | 5954.0 samples/s | 93.0 steps/s
[Step=6750 Epoch=64.5] | Loss=0.00172 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.694 | L2-Norm(final)=8.499 | 2457.6 samples/s | 38.4 steps/s
[Step=6800 Epoch=64.9] | Loss=0.00144 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.693 | L2-Norm(final)=8.500 | 5633.1 samples/s | 88.0 steps/s
[Step=6850 Epoch=65.4] | Loss=0.00123 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.688 | L2-Norm(final)=8.502 | 2527.7 samples/s | 39.5 steps/s
[Step=6900 Epoch=65.9] | Loss=0.00108 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=8.503 | 5334.0 samples/s | 83.3 steps/s
[Step=6950 Epoch=66.4] | Loss=0.00096 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=8.504 | 2614.3 samples/s | 40.8 steps/s
[Step=7000 Epoch=66.8] | Loss=0.00087 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.664 | L2-Norm(final)=8.505 | 4868.2 samples/s | 76.1 steps/s
[Step=7050 Epoch=67.3] | Loss=0.00079 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.654 | L2-Norm(final)=8.506 | 2680.3 samples/s | 41.9 steps/s
[Step=7100 Epoch=67.8] | Loss=0.00072 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.644 | L2-Norm(final)=8.507 | 4635.7 samples/s | 72.4 steps/s
[Step=7150 Epoch=68.3] | Loss=0.00067 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.633 | L2-Norm(final)=8.508 | 2801.5 samples/s | 43.8 steps/s
[Step=7200 Epoch=68.8] | Loss=0.00062 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.622 | L2-Norm(final)=8.508 | 4543.0 samples/s | 71.0 steps/s
[Step=7250 Epoch=69.2] | Loss=0.00058 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.610 | L2-Norm(final)=8.509 | 2870.9 samples/s | 44.9 steps/s
[Step=7300 Epoch=69.7] | Loss=0.00054 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.599 | L2-Norm(final)=8.509 | 4564.0 samples/s | 71.3 steps/s
[Step=7350 Epoch=70.2] | Loss=0.00051 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.587 | L2-Norm(final)=8.510 | 2881.7 samples/s | 45.0 steps/s
[Step=7400 Epoch=70.7] | Loss=0.00048 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.575 | L2-Norm(final)=8.510 | 4452.6 samples/s | 69.6 steps/s
[Step=7450 Epoch=71.1] | Loss=0.00046 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=8.511 | 2829.7 samples/s | 44.2 steps/s
[Step=7500 Epoch=71.6] | Loss=0.00044 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=8.511 | 4621.7 samples/s | 72.2 steps/s
[Step=7550 Epoch=72.1] | Loss=0.00042 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.538 | L2-Norm(final)=8.512 | 7167.1 samples/s | 112.0 steps/s
[Step=7600 Epoch=72.6] | Loss=0.00040 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=8.512 | 2299.5 samples/s | 35.9 steps/s
[Step=7650 Epoch=73.1] | Loss=0.00038 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=8.513 | 6691.4 samples/s | 104.6 steps/s
[Step=7700 Epoch=73.5] | Loss=0.00036 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.500 | L2-Norm(final)=8.513 | 2395.0 samples/s | 37.4 steps/s
[Step=7750 Epoch=74.0] | Loss=0.00035 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=8.514 | 6068.3 samples/s | 94.8 steps/s
[Step=7800 Epoch=74.5] | Loss=0.00034 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=8.514 | 2437.7 samples/s | 38.1 steps/s
[Step=7850 Epoch=75.0] | Loss=0.00032 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=8.514 | 5668.2 samples/s | 88.6 steps/s
[Step=7900 Epoch=75.4] | Loss=0.00031 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.448 | L2-Norm(final)=8.515 | 2567.6 samples/s | 40.1 steps/s
[Step=7950 Epoch=75.9] | Loss=0.00030 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.434 | L2-Norm(final)=8.515 | 5172.7 samples/s | 80.8 steps/s
[Step=8000 Epoch=76.4] | Loss=0.00029 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=8.515 | 2603.0 samples/s | 40.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step8000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=113.1] | Loss=0.01617 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.487 | L2-Norm(final)=12.378 | 6660.7 samples/s | 104.1 steps/s
[Step=12050 Epoch=113.5] | Loss=0.01002 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=12.387 | 4817.5 samples/s | 75.3 steps/s
[Step=12100 Epoch=114.0] | Loss=0.01116 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=12.384 | 7968.8 samples/s | 124.5 steps/s
[Step=12150 Epoch=114.5] | Loss=0.01032 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=12.388 | 2592.7 samples/s | 40.5 steps/s
[Step=12200 Epoch=115.0] | Loss=0.01066 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=12.398 | 7001.7 samples/s | 109.4 steps/s
[Step=12250 Epoch=115.4] | Loss=0.01088 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.482 | L2-Norm(final)=12.407 | 2722.9 samples/s | 42.5 steps/s
[Step=12300 Epoch=115.9] | Loss=0.01086 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=12.418 | 6226.3 samples/s | 97.3 steps/s
[Step=12350 Epoch=116.4] | Loss=0.01055 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=12.433 | 2902.2 samples/s | 45.3 steps/s
[Step=12400 Epoch=116.8] | Loss=0.01071 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.482 | L2-Norm(final)=12.450 | 5434.6 samples/s | 84.9 steps/s
[Step=12450 Epoch=117.3] | Loss=0.01075 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.482 | L2-Norm(final)=12.467 | 3004.3 samples/s | 46.9 steps/s
[Step=12500 Epoch=117.8] | Loss=0.01051 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=12.484 | 5277.8 samples/s | 82.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=117.8] | Loss=0.00149 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=12.670 | 6985.6 samples/s | 109.1 steps/s
[Step=12550 Epoch=118.3] | Loss=0.01069 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.589 | L2-Norm(final)=12.668 | 4007.3 samples/s | 62.6 steps/s
[Step=12600 Epoch=118.7] | Loss=0.00736 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.688 | L2-Norm(final)=12.669 | 6505.6 samples/s | 101.6 steps/s
[Step=12650 Epoch=119.2] | Loss=0.00532 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.729 | L2-Norm(final)=12.669 | 2411.0 samples/s | 37.7 steps/s
[Step=12700 Epoch=119.7] | Loss=0.00403 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.746 | L2-Norm(final)=12.671 | 5789.0 samples/s | 90.5 steps/s
[Step=12750 Epoch=120.1] | Loss=0.00324 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.747 | L2-Norm(final)=12.673 | 2506.3 samples/s | 39.2 steps/s
[Step=12800 Epoch=120.6] | Loss=0.00270 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.739 | L2-Norm(final)=12.675 | 5279.1 samples/s | 82.5 steps/s
[Step=12850 Epoch=121.1] | Loss=0.00232 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.725 | L2-Norm(final)=12.677 | 2638.9 samples/s | 41.2 steps/s
[Step=12900 Epoch=121.6] | Loss=0.00203 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.709 | L2-Norm(final)=12.678 | 4787.0 samples/s | 74.8 steps/s
[Step=12950 Epoch=122.0] | Loss=0.00180 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.690 | L2-Norm(final)=12.679 | 2757.3 samples/s | 43.1 steps/s
[Step=13000 Epoch=122.5] | Loss=0.00162 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.671 | L2-Norm(final)=12.680 | 4551.2 samples/s | 71.1 steps/s
[Step=13050 Epoch=123.0] | Loss=0.00148 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=12.681 | 2866.8 samples/s | 44.8 steps/s
[Step=13100 Epoch=123.4] | Loss=0.00136 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.630 | L2-Norm(final)=12.682 | 4510.0 samples/s | 70.5 steps/s
[Step=13150 Epoch=123.9] | Loss=0.00125 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.610 | L2-Norm(final)=12.683 | 2856.5 samples/s | 44.6 steps/s
[Step=13200 Epoch=124.4] | Loss=0.00116 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.589 | L2-Norm(final)=12.684 | 4511.9 samples/s | 70.5 steps/s
[Step=13250 Epoch=124.9] | Loss=0.00109 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.568 | L2-Norm(final)=12.685 | 3067.7 samples/s | 47.9 steps/s
[Step=13300 Epoch=125.3] | Loss=0.00102 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.547 | L2-Norm(final)=12.686 | 4066.6 samples/s | 63.5 steps/s
[Step=13350 Epoch=125.8] | Loss=0.00096 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=12.686 | 6615.2 samples/s | 103.4 steps/s
[Step=13400 Epoch=126.3] | Loss=0.00091 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=12.687 | 2387.0 samples/s | 37.3 steps/s
[Step=13450 Epoch=126.7] | Loss=0.00086 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.485 | L2-Norm(final)=12.688 | 5846.3 samples/s | 91.3 steps/s
[Step=13500 Epoch=127.2] | Loss=0.00082 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.465 | L2-Norm(final)=12.688 | 2495.0 samples/s | 39.0 steps/s
[Step=13550 Epoch=127.7] | Loss=0.00078 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.444 | L2-Norm(final)=12.689 | 5332.8 samples/s | 83.3 steps/s
[Step=13600 Epoch=128.2] | Loss=0.00074 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.424 | L2-Norm(final)=12.690 | 2676.4 samples/s | 41.8 steps/s
[Step=13650 Epoch=128.6] | Loss=0.00071 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.403 | L2-Norm(final)=12.690 | 4690.8 samples/s | 73.3 steps/s
[Step=13700 Epoch=129.1] | Loss=0.00068 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.383 | L2-Norm(final)=12.691 | 2760.5 samples/s | 43.1 steps/s
[Step=13750 Epoch=129.6] | Loss=0.00065 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.363 | L2-Norm(final)=12.691 | 4538.0 samples/s | 70.9 steps/s
[Step=13800 Epoch=130.0] | Loss=0.00063 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.343 | L2-Norm(final)=12.692 | 2831.9 samples/s | 44.2 steps/s
[Step=13850 Epoch=130.5] | Loss=0.00060 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=12.692 | 4619.9 samples/s | 72.2 steps/s
[Step=13900 Epoch=131.0] | Loss=0.00058 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=12.693 | 2860.5 samples/s | 44.7 steps/s
[Step=13950 Epoch=131.4] | Loss=0.00056 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=12.694 | 4543.2 samples/s | 71.0 steps/s
[Step=14000 Epoch=131.9] | Loss=0.00054 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=12.694 | 3083.2 samples/s | 48.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step14000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10312 | acc=0.9517 | tpr=0.9646 | fpr=0.0763 | 6070.5 samples/s | 23.7 steps/s
Avg test loss: 0.10951, Avg test acc: 0.94935, Avg tpr: 0.96252, Avg fpr: 0.07961, total FA: 621

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.12196 | acc=0.9471 | tpr=0.9683 | fpr=0.0989 | 5764.4 samples/s | 22.5 steps/s
Avg test loss: 0.12318, Avg test acc: 0.94811, Avg tpr: 0.96853, Avg fpr: 0.09678, total FA: 755

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.13247 | acc=0.9334 | tpr=0.9445 | fpr=0.0909 | 5943.3 samples/s | 23.2 steps/s
Avg test loss: 0.13823, Avg test acc: 0.93064, Avg tpr: 0.94008, Avg fpr: 0.09012, total FA: 703

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.11848 | acc=0.9509 | tpr=0.9633 | fpr=0.0758 | 5893.0 samples/s | 23.0 steps/s
Avg test loss: 0.12432, Avg test acc: 0.94859, Avg tpr: 0.96089, Avg fpr: 0.07845, total FA: 612

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.12772 | acc=0.9494 | tpr=0.9683 | fpr=0.0917 | 5902.2 samples/s | 23.1 steps/s
Avg test loss: 0.13083, Avg test acc: 0.94799, Avg tpr: 0.96666, Avg fpr: 0.09306, total FA: 726

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.02843 | acc=0.2984 | tpr=0.0152 | fpr=0.0867 | 5704.1 samples/s | 22.3 steps/s
Avg test loss: 7.02985, Avg test acc: 0.29502, Avg tpr: 0.01445, Avg fpr: 0.08794, total FA: 686

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.13494 | acc=0.3137 | tpr=0.0209 | fpr=0.0505 | 6045.1 samples/s | 23.6 steps/s
Avg test loss: 5.14533, Avg test acc: 0.30988, Avg tpr: 0.02046, Avg fpr: 0.05358, total FA: 418

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.10733 | acc=0.3095 | tpr=0.0136 | fpr=0.0481 | 6041.2 samples/s | 23.6 steps/s
Avg test loss: 5.11498, Avg test acc: 0.30656, Avg tpr: 0.01329, Avg fpr: 0.04846, total FA: 378

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.28966 | acc=0.3059 | tpr=0.0273 | fpr=0.0889 | 6099.3 samples/s | 23.8 steps/s
Avg test loss: 5.29385, Avg test acc: 0.30499, Avg tpr: 0.02693, Avg fpr: 0.08345, total FA: 651

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=3.91120 | acc=0.3131 | tpr=0.0135 | fpr=0.0362 | 5989.1 samples/s | 23.4 steps/s
Avg test loss: 3.92539, Avg test acc: 0.31160, Avg tpr: 0.01370, Avg fpr: 0.03320, total FA: 259

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.35001 | acc=0.1342 | tpr=0.6814 | fpr=0.8756 | 5642.1 samples/s | 22.0 steps/s
[Step= 100] | Loss=5.34005 | acc=0.1360 | tpr=0.6567 | fpr=0.8737 | 8179.7 samples/s | 32.0 steps/s
[Step= 150] | Loss=5.34241 | acc=0.1376 | tpr=0.6643 | fpr=0.8721 | 8357.6 samples/s | 32.6 steps/s
[Step= 200] | Loss=5.33589 | acc=0.1376 | tpr=0.6612 | fpr=0.8720 | 8049.6 samples/s | 31.4 steps/s
[Step= 250] | Loss=5.34203 | acc=0.1374 | tpr=0.6533 | fpr=0.8720 | 8214.7 samples/s | 32.1 steps/s
[Step= 300] | Loss=5.33571 | acc=0.1373 | tpr=0.6480 | fpr=0.8720 | 8109.8 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.34084 | acc=0.1370 | tpr=0.6425 | fpr=0.8722 | 8407.4 samples/s | 32.8 steps/s
[Step= 400] | Loss=5.34077 | acc=0.1370 | tpr=0.6400 | fpr=0.8721 | 7804.6 samples/s | 30.5 steps/s
[Step= 450] | Loss=5.34257 | acc=0.1367 | tpr=0.6441 | fpr=0.8725 | 7537.6 samples/s | 29.4 steps/s
[Step= 500] | Loss=5.34335 | acc=0.1367 | tpr=0.6480 | fpr=0.8725 | 8227.1 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.34731 | acc=0.1368 | tpr=0.6470 | fpr=0.8725 | 10056.8 samples/s | 39.3 steps/s
Avg test loss: 5.34820, Avg test acc: 0.13672, Avg tpr: 0.64739, Avg fpr: 0.87257, total FA: 121154

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.53833 | acc=0.1373 | tpr=0.6814 | fpr=0.8724 | 5974.4 samples/s | 23.3 steps/s
[Step= 100] | Loss=5.52258 | acc=0.1395 | tpr=0.6759 | fpr=0.8705 | 7960.1 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.51394 | acc=0.1400 | tpr=0.6816 | fpr=0.8700 | 8214.1 samples/s | 32.1 steps/s
[Step= 200] | Loss=5.51769 | acc=0.1395 | tpr=0.6787 | fpr=0.8703 | 8158.1 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.52439 | acc=0.1393 | tpr=0.6803 | fpr=0.8706 | 7728.6 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.51914 | acc=0.1393 | tpr=0.6756 | fpr=0.8705 | 7425.1 samples/s | 29.0 steps/s
[Step= 350] | Loss=5.52539 | acc=0.1387 | tpr=0.6738 | fpr=0.8710 | 8560.6 samples/s | 33.4 steps/s
[Step= 400] | Loss=5.52149 | acc=0.1390 | tpr=0.6767 | fpr=0.8707 | 7940.1 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.52569 | acc=0.1387 | tpr=0.6782 | fpr=0.8711 | 8200.9 samples/s | 32.0 steps/s
[Step= 500] | Loss=5.52731 | acc=0.1386 | tpr=0.6802 | fpr=0.8711 | 8044.9 samples/s | 31.4 steps/s
[Step= 550] | Loss=5.53387 | acc=0.1385 | tpr=0.6844 | fpr=0.8714 | 10136.0 samples/s | 39.6 steps/s
Avg test loss: 5.53475, Avg test acc: 0.13844, Avg tpr: 0.68463, Avg fpr: 0.87149, total FA: 121005

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.34471 | acc=0.1136 | tpr=0.7434 | fpr=0.8977 | 6178.6 samples/s | 24.1 steps/s
[Step= 100] | Loss=4.32650 | acc=0.1148 | tpr=0.7569 | fpr=0.8972 | 8008.3 samples/s | 31.3 steps/s
[Step= 150] | Loss=4.31349 | acc=0.1165 | tpr=0.7594 | fpr=0.8953 | 7269.5 samples/s | 28.4 steps/s
[Step= 200] | Loss=4.31334 | acc=0.1170 | tpr=0.7508 | fpr=0.8946 | 7919.4 samples/s | 30.9 steps/s
[Step= 250] | Loss=4.31276 | acc=0.1176 | tpr=0.7511 | fpr=0.8940 | 7634.4 samples/s | 29.8 steps/s
[Step= 300] | Loss=4.31065 | acc=0.1176 | tpr=0.7491 | fpr=0.8939 | 7984.2 samples/s | 31.2 steps/s
[Step= 350] | Loss=4.31380 | acc=0.1177 | tpr=0.7495 | fpr=0.8938 | 8169.1 samples/s | 31.9 steps/s
[Step= 400] | Loss=4.31518 | acc=0.1171 | tpr=0.7462 | fpr=0.8943 | 8078.3 samples/s | 31.6 steps/s
[Step= 450] | Loss=4.31839 | acc=0.1166 | tpr=0.7517 | fpr=0.8949 | 8271.5 samples/s | 32.3 steps/s
[Step= 500] | Loss=4.31930 | acc=0.1165 | tpr=0.7542 | fpr=0.8950 | 7997.9 samples/s | 31.2 steps/s
[Step= 550] | Loss=4.32218 | acc=0.1166 | tpr=0.7557 | fpr=0.8951 | 11121.9 samples/s | 43.4 steps/s
Avg test loss: 4.32309, Avg test acc: 0.11654, Avg tpr: 0.75634, Avg fpr: 0.89509, total FA: 124281

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.66530 | acc=0.1398 | tpr=0.7257 | fpr=0.8707 | 5915.3 samples/s | 23.1 steps/s
[Step= 100] | Loss=5.64256 | acc=0.1419 | tpr=0.7079 | fpr=0.8686 | 8468.4 samples/s | 33.1 steps/s
[Step= 150] | Loss=5.63596 | acc=0.1435 | tpr=0.7161 | fpr=0.8670 | 7407.8 samples/s | 28.9 steps/s
[Step= 200] | Loss=5.63561 | acc=0.1438 | tpr=0.7137 | fpr=0.8665 | 8061.9 samples/s | 31.5 steps/s
[Step= 250] | Loss=5.63499 | acc=0.1436 | tpr=0.7135 | fpr=0.8668 | 8345.9 samples/s | 32.6 steps/s
[Step= 300] | Loss=5.62631 | acc=0.1437 | tpr=0.7091 | fpr=0.8666 | 8024.6 samples/s | 31.3 steps/s
[Step= 350] | Loss=5.63170 | acc=0.1434 | tpr=0.7082 | fpr=0.8669 | 7870.8 samples/s | 30.7 steps/s
[Step= 400] | Loss=5.63056 | acc=0.1439 | tpr=0.7068 | fpr=0.8663 | 7906.7 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.63572 | acc=0.1435 | tpr=0.7103 | fpr=0.8668 | 7590.4 samples/s | 29.6 steps/s
[Step= 500] | Loss=5.63601 | acc=0.1436 | tpr=0.7115 | fpr=0.8667 | 8601.6 samples/s | 33.6 steps/s
[Step= 550] | Loss=5.64309 | acc=0.1436 | tpr=0.7127 | fpr=0.8668 | 10092.3 samples/s | 39.4 steps/s
Avg test loss: 5.64422, Avg test acc: 0.14350, Avg tpr: 0.71355, Avg fpr: 0.86686, total FA: 120362

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.71595 | acc=0.1283 | tpr=0.6681 | fpr=0.8814 | 6120.9 samples/s | 23.9 steps/s
[Step= 100] | Loss=5.70721 | acc=0.1320 | tpr=0.6439 | fpr=0.8776 | 7864.1 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.70269 | acc=0.1347 | tpr=0.6556 | fpr=0.8748 | 7715.7 samples/s | 30.1 steps/s
[Step= 200] | Loss=5.70622 | acc=0.1352 | tpr=0.6590 | fpr=0.8744 | 7809.2 samples/s | 30.5 steps/s
[Step= 250] | Loss=5.71006 | acc=0.1350 | tpr=0.6559 | fpr=0.8745 | 7996.5 samples/s | 31.2 steps/s
[Step= 300] | Loss=5.70384 | acc=0.1352 | tpr=0.6575 | fpr=0.8743 | 8105.9 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.71223 | acc=0.1349 | tpr=0.6537 | fpr=0.8745 | 8313.6 samples/s | 32.5 steps/s
[Step= 400] | Loss=5.71195 | acc=0.1351 | tpr=0.6510 | fpr=0.8743 | 8056.9 samples/s | 31.5 steps/s
[Step= 450] | Loss=5.71734 | acc=0.1344 | tpr=0.6534 | fpr=0.8750 | 7883.2 samples/s | 30.8 steps/s
[Step= 500] | Loss=5.71594 | acc=0.1345 | tpr=0.6551 | fpr=0.8749 | 8028.1 samples/s | 31.4 steps/s
[Step= 550] | Loss=5.71995 | acc=0.1347 | tpr=0.6578 | fpr=0.8748 | 10404.4 samples/s | 40.6 steps/s
Avg test loss: 5.72078, Avg test acc: 0.13471, Avg tpr: 0.65887, Avg fpr: 0.87482, total FA: 121467

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.18580 | acc=0.9577 | tpr=0.9071 | fpr=0.0414 | 6044.8 samples/s | 23.6 steps/s
[Step= 100] | Loss=0.18741 | acc=0.9585 | tpr=0.9296 | fpr=0.0409 | 7775.3 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.18713 | acc=0.9579 | tpr=0.9280 | fpr=0.0416 | 7547.2 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.18547 | acc=0.9580 | tpr=0.9290 | fpr=0.0415 | 8352.7 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.18649 | acc=0.9578 | tpr=0.9249 | fpr=0.0416 | 8792.0 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.18996 | acc=0.9572 | tpr=0.9193 | fpr=0.0421 | 7052.9 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.18994 | acc=0.9575 | tpr=0.9224 | fpr=0.0419 | 7995.0 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.18979 | acc=0.9574 | tpr=0.9190 | fpr=0.0419 | 8368.1 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.19285 | acc=0.9571 | tpr=0.9167 | fpr=0.0422 | 8048.3 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.19295 | acc=0.9570 | tpr=0.9176 | fpr=0.0422 | 8552.1 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.19204 | acc=0.9572 | tpr=0.9152 | fpr=0.0421 | 9524.1 samples/s | 37.2 steps/s
Avg test loss: 0.19157, Avg test acc: 0.95723, Avg tpr: 0.91561, Avg fpr: 0.04201, total FA: 5833

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15022 | acc=0.9635 | tpr=0.8673 | fpr=0.0348 | 6057.3 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.15281 | acc=0.9626 | tpr=0.8934 | fpr=0.0361 | 7831.9 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.15425 | acc=0.9620 | tpr=0.9020 | fpr=0.0369 | 7120.4 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.15266 | acc=0.9620 | tpr=0.9082 | fpr=0.0370 | 8183.9 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.15338 | acc=0.9619 | tpr=0.9057 | fpr=0.0371 | 8276.7 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.15604 | acc=0.9613 | tpr=0.9004 | fpr=0.0376 | 7824.9 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.15543 | acc=0.9614 | tpr=0.9011 | fpr=0.0375 | 8332.3 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.15545 | acc=0.9613 | tpr=0.8982 | fpr=0.0376 | 8070.9 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.15813 | acc=0.9605 | tpr=0.8982 | fpr=0.0383 | 8543.2 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.15859 | acc=0.9604 | tpr=0.9022 | fpr=0.0386 | 8179.5 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.15795 | acc=0.9606 | tpr=0.9005 | fpr=0.0384 | 9787.1 samples/s | 38.2 steps/s
Avg test loss: 0.15771, Avg test acc: 0.96057, Avg tpr: 0.90016, Avg fpr: 0.03834, total FA: 5323

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.28665 | acc=0.9477 | tpr=0.9513 | fpr=0.0524 | 5973.5 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.29144 | acc=0.9464 | tpr=0.9531 | fpr=0.0537 | 8028.6 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.29721 | acc=0.9449 | tpr=0.9510 | fpr=0.0552 | 7930.8 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.29655 | acc=0.9449 | tpr=0.9530 | fpr=0.0552 | 8314.0 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.29714 | acc=0.9448 | tpr=0.9502 | fpr=0.0553 | 8156.6 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.30054 | acc=0.9445 | tpr=0.9484 | fpr=0.0556 | 8066.8 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.29948 | acc=0.9445 | tpr=0.9499 | fpr=0.0556 | 7102.5 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.30013 | acc=0.9442 | tpr=0.9469 | fpr=0.0559 | 7994.2 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.30375 | acc=0.9436 | tpr=0.9455 | fpr=0.0564 | 8575.9 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.30454 | acc=0.9435 | tpr=0.9458 | fpr=0.0566 | 8471.1 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.30314 | acc=0.9436 | tpr=0.9439 | fpr=0.0564 | 9598.2 samples/s | 37.5 steps/s
Avg test loss: 0.30282, Avg test acc: 0.94365, Avg tpr: 0.94374, Avg fpr: 0.05636, total FA: 7825

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11478 | acc=0.9707 | tpr=0.9027 | fpr=0.0281 | 5700.8 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.11808 | acc=0.9700 | tpr=0.8998 | fpr=0.0287 | 8239.0 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.11886 | acc=0.9702 | tpr=0.9020 | fpr=0.0286 | 8588.8 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.11850 | acc=0.9700 | tpr=0.9060 | fpr=0.0288 | 7815.7 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.11796 | acc=0.9704 | tpr=0.9057 | fpr=0.0285 | 7679.5 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.12123 | acc=0.9696 | tpr=0.9025 | fpr=0.0292 | 8077.0 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.12103 | acc=0.9695 | tpr=0.9029 | fpr=0.0293 | 8739.6 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.12013 | acc=0.9694 | tpr=0.9015 | fpr=0.0294 | 8000.4 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.12251 | acc=0.9689 | tpr=0.9002 | fpr=0.0298 | 7399.5 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.12209 | acc=0.9689 | tpr=0.9026 | fpr=0.0299 | 8312.9 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.12143 | acc=0.9691 | tpr=0.9025 | fpr=0.0297 | 10372.6 samples/s | 40.5 steps/s
Avg test loss: 0.12125, Avg test acc: 0.96915, Avg tpr: 0.90254, Avg fpr: 0.02964, total FA: 4116

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21303 | acc=0.9535 | tpr=0.8761 | fpr=0.0451 | 6017.5 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.21510 | acc=0.9529 | tpr=0.9083 | fpr=0.0463 | 7765.1 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.22071 | acc=0.9510 | tpr=0.9107 | fpr=0.0482 | 8652.7 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.22102 | acc=0.9512 | tpr=0.9169 | fpr=0.0482 | 7468.4 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.22287 | acc=0.9510 | tpr=0.9118 | fpr=0.0483 | 8174.1 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.22628 | acc=0.9504 | tpr=0.9047 | fpr=0.0488 | 8635.8 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.22485 | acc=0.9508 | tpr=0.9061 | fpr=0.0484 | 7957.3 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.22410 | acc=0.9506 | tpr=0.9032 | fpr=0.0485 | 7973.3 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.22604 | acc=0.9502 | tpr=0.9002 | fpr=0.0489 | 8203.4 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.22738 | acc=0.9499 | tpr=0.8996 | fpr=0.0492 | 8013.3 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.22580 | acc=0.9501 | tpr=0.8973 | fpr=0.0489 | 9369.9 samples/s | 36.6 steps/s
Avg test loss: 0.22566, Avg test acc: 0.95016, Avg tpr: 0.89699, Avg fpr: 0.04887, total FA: 6786

server round 12/50

clients selected: [0 2 5 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.08142 | Reg=0.00151 | acc=0.9219 | L2-Norm=12.297 | L2-Norm(final)=9.925 | 7448.6 samples/s | 116.4 steps/s
[Step=12050 Epoch=58.8] | Loss=0.07014 | Reg=0.00151 | acc=0.9219 | L2-Norm=12.298 | L2-Norm(final)=9.929 | 4760.9 samples/s | 74.4 steps/s
[Step=12100 Epoch=59.0] | Loss=0.06960 | Reg=0.00151 | acc=0.9531 | L2-Norm=12.299 | L2-Norm(final)=9.936 | 5594.8 samples/s | 87.4 steps/s
[Step=12150 Epoch=59.2] | Loss=0.06902 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.299 | L2-Norm(final)=9.950 | 5504.6 samples/s | 86.0 steps/s
[Step=12200 Epoch=59.5] | Loss=0.06957 | Reg=0.00151 | acc=0.9531 | L2-Norm=12.299 | L2-Norm(final)=9.969 | 8690.6 samples/s | 135.8 steps/s
[Step=12250 Epoch=59.7] | Loss=0.06848 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.299 | L2-Norm(final)=9.987 | 2739.7 samples/s | 42.8 steps/s
[Step=12300 Epoch=60.0] | Loss=0.06886 | Reg=0.00151 | acc=0.9219 | L2-Norm=12.299 | L2-Norm(final)=10.005 | 5347.1 samples/s | 83.5 steps/s
[Step=12350 Epoch=60.2] | Loss=0.06949 | Reg=0.00151 | acc=0.9531 | L2-Norm=12.299 | L2-Norm(final)=10.022 | 5533.2 samples/s | 86.5 steps/s
[Step=12400 Epoch=60.5] | Loss=0.06893 | Reg=0.00151 | acc=0.9375 | L2-Norm=12.299 | L2-Norm(final)=10.039 | 7694.0 samples/s | 120.2 steps/s
[Step=12450 Epoch=60.7] | Loss=0.06861 | Reg=0.00151 | acc=0.9531 | L2-Norm=12.299 | L2-Norm(final)=10.056 | 2783.4 samples/s | 43.5 steps/s
[Step=12500 Epoch=61.0] | Loss=0.06888 | Reg=0.00151 | acc=0.9375 | L2-Norm=12.299 | L2-Norm(final)=10.073 | 5518.0 samples/s | 86.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=61.0] | Loss=0.07689 | Reg=0.00151 | acc=0.9375 | L2-Norm=12.299 | L2-Norm(final)=10.254 | 6903.0 samples/s | 107.9 steps/s
[Step=12550 Epoch=61.2] | Loss=0.06462 | Reg=0.00154 | acc=0.9375 | L2-Norm=12.420 | L2-Norm(final)=10.257 | 4425.4 samples/s | 69.1 steps/s
[Step=12600 Epoch=61.4] | Loss=0.05621 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.528 | L2-Norm(final)=10.248 | 4687.1 samples/s | 73.2 steps/s
[Step=12650 Epoch=61.7] | Loss=0.05495 | Reg=0.00159 | acc=0.9375 | L2-Norm=12.610 | L2-Norm(final)=10.241 | 4819.6 samples/s | 75.3 steps/s
[Step=12700 Epoch=61.9] | Loss=0.05069 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.678 | L2-Norm(final)=10.236 | 6736.4 samples/s | 105.3 steps/s
[Step=12750 Epoch=62.2] | Loss=0.04575 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.736 | L2-Norm(final)=10.234 | 2476.6 samples/s | 38.7 steps/s
[Step=12800 Epoch=62.4] | Loss=0.04134 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.786 | L2-Norm(final)=10.234 | 4775.9 samples/s | 74.6 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03810 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.828 | L2-Norm(final)=10.236 | 4817.3 samples/s | 75.3 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03606 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.865 | L2-Norm(final)=10.238 | 6058.1 samples/s | 94.7 steps/s
[Step=12950 Epoch=63.1] | Loss=0.03373 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.899 | L2-Norm(final)=10.240 | 2596.5 samples/s | 40.6 steps/s
[Step=13000 Epoch=63.4] | Loss=0.03152 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.930 | L2-Norm(final)=10.242 | 4710.1 samples/s | 73.6 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02988 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.958 | L2-Norm(final)=10.244 | 4788.3 samples/s | 74.8 steps/s
[Step=13100 Epoch=63.9] | Loss=0.02837 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.982 | L2-Norm(final)=10.247 | 5650.8 samples/s | 88.3 steps/s
[Step=13150 Epoch=64.1] | Loss=0.02703 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.005 | L2-Norm(final)=10.250 | 2676.6 samples/s | 41.8 steps/s
[Step=13200 Epoch=64.4] | Loss=0.02568 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.025 | L2-Norm(final)=10.253 | 4740.4 samples/s | 74.1 steps/s
[Step=13250 Epoch=64.6] | Loss=0.02469 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.043 | L2-Norm(final)=10.256 | 4744.0 samples/s | 74.1 steps/s
[Step=13300 Epoch=64.9] | Loss=0.02372 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.059 | L2-Norm(final)=10.259 | 5284.5 samples/s | 82.6 steps/s
[Step=13350 Epoch=65.1] | Loss=0.02327 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.075 | L2-Norm(final)=10.261 | 2775.1 samples/s | 43.4 steps/s
[Step=13400 Epoch=65.3] | Loss=0.02260 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.091 | L2-Norm(final)=10.263 | 4769.6 samples/s | 74.5 steps/s
[Step=13450 Epoch=65.6] | Loss=0.02197 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.107 | L2-Norm(final)=10.266 | 4823.8 samples/s | 75.4 steps/s
[Step=13500 Epoch=65.8] | Loss=0.02141 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.122 | L2-Norm(final)=10.268 | 4831.0 samples/s | 75.5 steps/s
[Step=13550 Epoch=66.1] | Loss=0.02072 | Reg=0.00173 | acc=0.9688 | L2-Norm=13.137 | L2-Norm(final)=10.270 | 2934.9 samples/s | 45.9 steps/s
[Step=13600 Epoch=66.3] | Loss=0.02011 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.151 | L2-Norm(final)=10.273 | 4744.6 samples/s | 74.1 steps/s
[Step=13650 Epoch=66.6] | Loss=0.01952 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.163 | L2-Norm(final)=10.275 | 4708.1 samples/s | 73.6 steps/s
[Step=13700 Epoch=66.8] | Loss=0.01900 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.175 | L2-Norm(final)=10.278 | 4720.5 samples/s | 73.8 steps/s
[Step=13750 Epoch=67.0] | Loss=0.01848 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.186 | L2-Norm(final)=10.280 | 2982.8 samples/s | 46.6 steps/s
[Step=13800 Epoch=67.3] | Loss=0.01793 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.196 | L2-Norm(final)=10.282 | 4701.5 samples/s | 73.5 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01747 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.206 | L2-Norm(final)=10.285 | 4811.3 samples/s | 75.2 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01700 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=10.287 | 4626.9 samples/s | 72.3 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01667 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.223 | L2-Norm(final)=10.290 | 2939.4 samples/s | 45.9 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01624 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.230 | L2-Norm(final)=10.292 | 4738.1 samples/s | 74.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step14000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=48.7] | Loss=0.05795 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.297 | L2-Norm(final)=8.719 | 6890.9 samples/s | 107.7 steps/s
[Step=10050 Epoch=49.0] | Loss=0.06413 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.301 | L2-Norm(final)=8.732 | 4993.3 samples/s | 78.0 steps/s
[Step=10100 Epoch=49.2] | Loss=0.06417 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.302 | L2-Norm(final)=8.766 | 5480.6 samples/s | 85.6 steps/s
[Step=10150 Epoch=49.5] | Loss=0.06414 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.302 | L2-Norm(final)=8.806 | 5489.7 samples/s | 85.8 steps/s
[Step=10200 Epoch=49.7] | Loss=0.06296 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.302 | L2-Norm(final)=8.845 | 8659.5 samples/s | 135.3 steps/s
[Step=10250 Epoch=49.9] | Loss=0.06295 | Reg=0.00151 | acc=0.9531 | L2-Norm=12.302 | L2-Norm(final)=8.887 | 2663.9 samples/s | 41.6 steps/s
[Step=10300 Epoch=50.2] | Loss=0.06272 | Reg=0.00151 | acc=0.9531 | L2-Norm=12.302 | L2-Norm(final)=8.929 | 5501.2 samples/s | 86.0 steps/s
[Step=10350 Epoch=50.4] | Loss=0.06329 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.302 | L2-Norm(final)=8.970 | 5579.9 samples/s | 87.2 steps/s
[Step=10400 Epoch=50.7] | Loss=0.06268 | Reg=0.00151 | acc=0.9375 | L2-Norm=12.302 | L2-Norm(final)=9.008 | 7633.8 samples/s | 119.3 steps/s
[Step=10450 Epoch=50.9] | Loss=0.06281 | Reg=0.00151 | acc=0.9219 | L2-Norm=12.302 | L2-Norm(final)=9.047 | 2773.2 samples/s | 43.3 steps/s
[Step=10500 Epoch=51.2] | Loss=0.06274 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.302 | L2-Norm(final)=9.084 | 5585.5 samples/s | 87.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=51.2] | Loss=0.07020 | Reg=0.00151 | acc=0.9375 | L2-Norm=12.302 | L2-Norm(final)=9.451 | 6659.2 samples/s | 104.0 steps/s
[Step=10550 Epoch=51.4] | Loss=0.04879 | Reg=0.00154 | acc=0.9531 | L2-Norm=12.404 | L2-Norm(final)=9.468 | 4441.5 samples/s | 69.4 steps/s
[Step=10600 Epoch=51.6] | Loss=0.04696 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=9.460 | 4871.5 samples/s | 76.1 steps/s
[Step=10650 Epoch=51.9] | Loss=0.04347 | Reg=0.00158 | acc=0.9688 | L2-Norm=12.557 | L2-Norm(final)=9.457 | 4715.8 samples/s | 73.7 steps/s
[Step=10700 Epoch=52.1] | Loss=0.04265 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.609 | L2-Norm(final)=9.455 | 6797.1 samples/s | 106.2 steps/s
[Step=10750 Epoch=52.4] | Loss=0.03816 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.654 | L2-Norm(final)=9.455 | 2479.1 samples/s | 38.7 steps/s
[Step=10800 Epoch=52.6] | Loss=0.03467 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=9.458 | 4699.9 samples/s | 73.4 steps/s
[Step=10850 Epoch=52.9] | Loss=0.03184 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.724 | L2-Norm(final)=9.460 | 4803.4 samples/s | 75.1 steps/s
[Step=10900 Epoch=53.1] | Loss=0.02965 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.751 | L2-Norm(final)=9.463 | 6193.6 samples/s | 96.8 steps/s
[Step=10950 Epoch=53.4] | Loss=0.02796 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=9.466 | 2604.4 samples/s | 40.7 steps/s
[Step=11000 Epoch=53.6] | Loss=0.02598 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.794 | L2-Norm(final)=9.470 | 4647.4 samples/s | 72.6 steps/s
[Step=11050 Epoch=53.8] | Loss=0.02446 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.813 | L2-Norm(final)=9.473 | 4765.8 samples/s | 74.5 steps/s
[Step=11100 Epoch=54.1] | Loss=0.02345 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.829 | L2-Norm(final)=9.477 | 5710.1 samples/s | 89.2 steps/s
[Step=11150 Epoch=54.3] | Loss=0.02236 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.844 | L2-Norm(final)=9.480 | 2657.3 samples/s | 41.5 steps/s
[Step=11200 Epoch=54.6] | Loss=0.02136 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.859 | L2-Norm(final)=9.483 | 4812.8 samples/s | 75.2 steps/s
[Step=11250 Epoch=54.8] | Loss=0.02042 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.873 | L2-Norm(final)=9.487 | 4732.1 samples/s | 73.9 steps/s
[Step=11300 Epoch=55.1] | Loss=0.01970 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.885 | L2-Norm(final)=9.491 | 5208.0 samples/s | 81.4 steps/s
[Step=11350 Epoch=55.3] | Loss=0.01891 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.897 | L2-Norm(final)=9.494 | 2794.9 samples/s | 43.7 steps/s
[Step=11400 Epoch=55.5] | Loss=0.01829 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=9.497 | 4709.4 samples/s | 73.6 steps/s
[Step=11450 Epoch=55.8] | Loss=0.01765 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.917 | L2-Norm(final)=9.500 | 4792.6 samples/s | 74.9 steps/s
[Step=11500 Epoch=56.0] | Loss=0.01712 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.927 | L2-Norm(final)=9.504 | 4849.7 samples/s | 75.8 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01662 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.935 | L2-Norm(final)=9.507 | 2888.3 samples/s | 45.1 steps/s
[Step=11600 Epoch=56.5] | Loss=0.01616 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.944 | L2-Norm(final)=9.510 | 4696.9 samples/s | 73.4 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01571 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.952 | L2-Norm(final)=9.513 | 4756.0 samples/s | 74.3 steps/s
[Step=11700 Epoch=57.0] | Loss=0.01533 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.960 | L2-Norm(final)=9.515 | 4813.7 samples/s | 75.2 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01503 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.967 | L2-Norm(final)=9.518 | 2929.6 samples/s | 45.8 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01464 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.975 | L2-Norm(final)=9.521 | 4786.2 samples/s | 74.8 steps/s
[Step=11850 Epoch=57.7] | Loss=0.01435 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.982 | L2-Norm(final)=9.524 | 4724.2 samples/s | 73.8 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01407 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.989 | L2-Norm(final)=9.527 | 4775.2 samples/s | 74.6 steps/s
[Step=11950 Epoch=58.2] | Loss=0.01381 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.996 | L2-Norm(final)=9.529 | 2921.3 samples/s | 45.6 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01357 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.002 | L2-Norm(final)=9.532 | 4760.7 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step12000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=151.6] | Loss=0.00049 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=14.922 | 6718.0 samples/s | 105.0 steps/s
[Step=16050 Epoch=152.1] | Loss=0.00200 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=14.947 | 4566.9 samples/s | 71.4 steps/s
[Step=16100 Epoch=152.6] | Loss=0.00245 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=14.976 | 8174.3 samples/s | 127.7 steps/s
[Step=16150 Epoch=153.0] | Loss=0.00251 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=15.008 | 2549.7 samples/s | 39.8 steps/s
[Step=16200 Epoch=153.5] | Loss=0.00240 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=15.036 | 7313.8 samples/s | 114.3 steps/s
[Step=16250 Epoch=154.0] | Loss=0.00239 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=15.064 | 2670.4 samples/s | 41.7 steps/s
[Step=16300 Epoch=154.5] | Loss=0.00235 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=15.091 | 6520.6 samples/s | 101.9 steps/s
[Step=16350 Epoch=154.9] | Loss=0.00226 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=15.116 | 2788.0 samples/s | 43.6 steps/s
[Step=16400 Epoch=155.4] | Loss=0.00210 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=15.141 | 5923.2 samples/s | 92.6 steps/s
[Step=16450 Epoch=155.9] | Loss=0.00228 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=15.164 | 2960.7 samples/s | 46.3 steps/s
[Step=16500 Epoch=156.4] | Loss=0.00227 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=15.187 | 5288.4 samples/s | 82.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=156.4] | Loss=0.00112 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=15.413 | 6460.6 samples/s | 100.9 steps/s
[Step=16550 Epoch=156.8] | Loss=0.00517 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.399 | L2-Norm(final)=15.421 | 4230.7 samples/s | 66.1 steps/s
[Step=16600 Epoch=157.3] | Loss=0.00777 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.554 | L2-Norm(final)=15.407 | 6588.6 samples/s | 102.9 steps/s
[Step=16650 Epoch=157.8] | Loss=0.00770 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.645 | L2-Norm(final)=15.381 | 2391.7 samples/s | 37.4 steps/s
[Step=16700 Epoch=158.2] | Loss=0.00596 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=15.364 | 5954.2 samples/s | 93.0 steps/s
[Step=16750 Epoch=158.7] | Loss=0.00478 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.721 | L2-Norm(final)=15.355 | 2487.7 samples/s | 38.9 steps/s
[Step=16800 Epoch=159.2] | Loss=0.00399 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.731 | L2-Norm(final)=15.349 | 5461.7 samples/s | 85.3 steps/s
[Step=16850 Epoch=159.7] | Loss=0.00342 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.732 | L2-Norm(final)=15.345 | 2594.8 samples/s | 40.5 steps/s
[Step=16900 Epoch=160.1] | Loss=0.00299 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.728 | L2-Norm(final)=15.342 | 4938.4 samples/s | 77.2 steps/s
[Step=16950 Epoch=160.6] | Loss=0.00266 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.722 | L2-Norm(final)=15.340 | 2728.5 samples/s | 42.6 steps/s
[Step=17000 Epoch=161.1] | Loss=0.00240 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.713 | L2-Norm(final)=15.339 | 4564.1 samples/s | 71.3 steps/s
[Step=17050 Epoch=161.6] | Loss=0.00218 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.702 | L2-Norm(final)=15.338 | 2813.0 samples/s | 44.0 steps/s
[Step=17100 Epoch=162.0] | Loss=0.00200 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.691 | L2-Norm(final)=15.337 | 4571.5 samples/s | 71.4 steps/s
[Step=17150 Epoch=162.5] | Loss=0.00184 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.679 | L2-Norm(final)=15.336 | 2814.0 samples/s | 44.0 steps/s
[Step=17200 Epoch=163.0] | Loss=0.00171 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.667 | L2-Norm(final)=15.335 | 4517.6 samples/s | 70.6 steps/s
[Step=17250 Epoch=163.5] | Loss=0.00160 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.654 | L2-Norm(final)=15.335 | 2848.8 samples/s | 44.5 steps/s
[Step=17300 Epoch=163.9] | Loss=0.00150 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.641 | L2-Norm(final)=15.334 | 4527.8 samples/s | 70.7 steps/s
[Step=17350 Epoch=164.4] | Loss=0.00141 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.627 | L2-Norm(final)=15.334 | 2963.1 samples/s | 46.3 steps/s
[Step=17400 Epoch=164.9] | Loss=0.00133 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.614 | L2-Norm(final)=15.334 | 4315.1 samples/s | 67.4 steps/s
[Step=17450 Epoch=165.4] | Loss=0.00126 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.600 | L2-Norm(final)=15.333 | 6810.3 samples/s | 106.4 steps/s
[Step=17500 Epoch=165.8] | Loss=0.00120 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.587 | L2-Norm(final)=15.333 | 2366.0 samples/s | 37.0 steps/s
[Step=17550 Epoch=166.3] | Loss=0.00114 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.573 | L2-Norm(final)=15.333 | 6031.3 samples/s | 94.2 steps/s
[Step=17600 Epoch=166.8] | Loss=0.00109 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.560 | L2-Norm(final)=15.333 | 2454.9 samples/s | 38.4 steps/s
[Step=17650 Epoch=167.2] | Loss=0.00104 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.546 | L2-Norm(final)=15.333 | 5607.2 samples/s | 87.6 steps/s
[Step=17700 Epoch=167.7] | Loss=0.00100 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.532 | L2-Norm(final)=15.333 | 2542.7 samples/s | 39.7 steps/s
[Step=17750 Epoch=168.2] | Loss=0.00096 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=15.333 | 5217.0 samples/s | 81.5 steps/s
[Step=17800 Epoch=168.7] | Loss=0.00092 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.505 | L2-Norm(final)=15.333 | 2648.8 samples/s | 41.4 steps/s
[Step=17850 Epoch=169.1] | Loss=0.00089 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=15.333 | 4716.6 samples/s | 73.7 steps/s
[Step=17900 Epoch=169.6] | Loss=0.00086 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=15.333 | 1989.4 samples/s | 31.1 steps/s
[Step=17950 Epoch=170.1] | Loss=0.00083 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=15.333 | 4511.1 samples/s | 70.5 steps/s
[Step=18000 Epoch=170.6] | Loss=0.00080 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.450 | L2-Norm(final)=15.333 | 2832.0 samples/s | 44.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step18000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=8001 Epoch=76.4] | Loss=0.00488 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=8.527 | 7255.6 samples/s | 113.4 steps/s
[Step=8050 Epoch=76.9] | Loss=0.01045 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.292 | L2-Norm(final)=8.535 | 4477.9 samples/s | 70.0 steps/s
[Step=8100 Epoch=77.4] | Loss=0.01050 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=8.571 | 8386.7 samples/s | 131.0 steps/s
[Step=8150 Epoch=77.8] | Loss=0.01046 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=8.614 | 2563.4 samples/s | 40.1 steps/s
[Step=8200 Epoch=78.3] | Loss=0.01010 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=8.659 | 7499.3 samples/s | 117.2 steps/s
[Step=8250 Epoch=78.8] | Loss=0.01019 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.291 | L2-Norm(final)=8.707 | 2640.5 samples/s | 41.3 steps/s
[Step=8300 Epoch=79.3] | Loss=0.01000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=8.750 | 6817.5 samples/s | 106.5 steps/s
[Step=8350 Epoch=79.7] | Loss=0.00962 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.291 | L2-Norm(final)=8.794 | 2755.0 samples/s | 43.0 steps/s
[Step=8400 Epoch=80.2] | Loss=0.00961 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.291 | L2-Norm(final)=8.837 | 6265.8 samples/s | 97.9 steps/s
[Step=8450 Epoch=80.7] | Loss=0.00965 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=8.879 | 2870.9 samples/s | 44.9 steps/s
[Step=8500 Epoch=81.2] | Loss=0.00961 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=8.921 | 5662.5 samples/s | 88.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=81.2] | Loss=0.00275 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=9.335 | 6749.6 samples/s | 105.5 steps/s
[Step=8550 Epoch=81.6] | Loss=0.00523 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=9.359 | 4223.1 samples/s | 66.0 steps/s
[Step=8600 Epoch=82.1] | Loss=0.00481 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.516 | L2-Norm(final)=9.359 | 6553.5 samples/s | 102.4 steps/s
[Step=8650 Epoch=82.6] | Loss=0.00334 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=9.357 | 2360.7 samples/s | 36.9 steps/s
[Step=8700 Epoch=83.1] | Loss=0.00255 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=9.358 | 6144.3 samples/s | 96.0 steps/s
[Step=8750 Epoch=83.6] | Loss=0.00204 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.609 | L2-Norm(final)=9.360 | 2451.3 samples/s | 38.3 steps/s
[Step=8800 Epoch=84.0] | Loss=0.00170 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.609 | L2-Norm(final)=9.361 | 5666.6 samples/s | 88.5 steps/s
[Step=8850 Epoch=84.5] | Loss=0.00146 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.605 | L2-Norm(final)=9.361 | 2516.9 samples/s | 39.3 steps/s
[Step=8900 Epoch=85.0] | Loss=0.00128 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.597 | L2-Norm(final)=9.362 | 5330.6 samples/s | 83.3 steps/s
[Step=8950 Epoch=85.5] | Loss=0.00114 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.588 | L2-Norm(final)=9.363 | 2622.1 samples/s | 41.0 steps/s
[Step=9000 Epoch=85.9] | Loss=0.00102 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=9.363 | 4899.6 samples/s | 76.6 steps/s
[Step=9050 Epoch=86.4] | Loss=0.00093 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.565 | L2-Norm(final)=9.364 | 2687.4 samples/s | 42.0 steps/s
[Step=9100 Epoch=86.9] | Loss=0.00085 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=9.365 | 4637.4 samples/s | 72.5 steps/s
[Step=9150 Epoch=87.4] | Loss=0.00079 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.540 | L2-Norm(final)=9.365 | 2825.2 samples/s | 44.1 steps/s
[Step=9200 Epoch=87.9] | Loss=0.00073 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=9.365 | 4508.8 samples/s | 70.5 steps/s
[Step=9250 Epoch=88.3] | Loss=0.00068 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=9.366 | 2856.4 samples/s | 44.6 steps/s
[Step=9300 Epoch=88.8] | Loss=0.00064 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.499 | L2-Norm(final)=9.366 | 4431.9 samples/s | 69.2 steps/s
[Step=9350 Epoch=89.3] | Loss=0.00060 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=9.367 | 2853.4 samples/s | 44.6 steps/s
[Step=9400 Epoch=89.8] | Loss=0.00057 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.470 | L2-Norm(final)=9.367 | 4564.8 samples/s | 71.3 steps/s
[Step=9450 Epoch=90.2] | Loss=0.00054 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=9.368 | 2816.1 samples/s | 44.0 steps/s
[Step=9500 Epoch=90.7] | Loss=0.00051 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=9.368 | 4616.0 samples/s | 72.1 steps/s
[Step=9550 Epoch=91.2] | Loss=0.00049 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.426 | L2-Norm(final)=9.368 | 7057.5 samples/s | 110.3 steps/s
[Step=9600 Epoch=91.7] | Loss=0.00047 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.411 | L2-Norm(final)=9.369 | 2289.1 samples/s | 35.8 steps/s
[Step=9650 Epoch=92.2] | Loss=0.00045 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.396 | L2-Norm(final)=9.369 | 6601.1 samples/s | 103.1 steps/s
[Step=9700 Epoch=92.6] | Loss=0.00043 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.381 | L2-Norm(final)=9.370 | 2417.1 samples/s | 37.8 steps/s
[Step=9750 Epoch=93.1] | Loss=0.00041 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.366 | L2-Norm(final)=9.370 | 6038.3 samples/s | 94.3 steps/s
[Step=9800 Epoch=93.6] | Loss=0.00040 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.351 | L2-Norm(final)=9.370 | 2458.4 samples/s | 38.4 steps/s
[Step=9850 Epoch=94.1] | Loss=0.00038 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=9.371 | 5608.7 samples/s | 87.6 steps/s
[Step=9900 Epoch=94.5] | Loss=0.00037 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.320 | L2-Norm(final)=9.371 | 2538.5 samples/s | 39.7 steps/s
[Step=9950 Epoch=95.0] | Loss=0.00036 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.305 | L2-Norm(final)=9.371 | 5238.3 samples/s | 81.8 steps/s
[Step=10000 Epoch=95.5] | Loss=0.00034 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.289 | L2-Norm(final)=9.372 | 2627.3 samples/s | 41.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step10000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=95.3] | Loss=0.00354 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=11.494 | 6436.1 samples/s | 100.6 steps/s
[Step=10050 Epoch=95.8] | Loss=0.01081 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.293 | L2-Norm(final)=11.476 | 4793.0 samples/s | 74.9 steps/s
[Step=10100 Epoch=96.3] | Loss=0.01232 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=11.459 | 8232.4 samples/s | 128.6 steps/s
[Step=10150 Epoch=96.7] | Loss=0.01144 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=11.446 | 2552.3 samples/s | 39.9 steps/s
[Step=10200 Epoch=97.2] | Loss=0.01154 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.292 | L2-Norm(final)=11.440 | 7508.1 samples/s | 117.3 steps/s
[Step=10250 Epoch=97.7] | Loss=0.01140 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.292 | L2-Norm(final)=11.437 | 2632.4 samples/s | 41.1 steps/s
[Step=10300 Epoch=98.2] | Loss=0.01124 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.292 | L2-Norm(final)=11.440 | 6864.5 samples/s | 107.3 steps/s
[Step=10350 Epoch=98.6] | Loss=0.01117 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.292 | L2-Norm(final)=11.446 | 2814.6 samples/s | 44.0 steps/s
[Step=10400 Epoch=99.1] | Loss=0.01080 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=11.452 | 5917.0 samples/s | 92.5 steps/s
[Step=10450 Epoch=99.6] | Loss=0.01098 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=11.460 | 2885.8 samples/s | 45.1 steps/s
[Step=10500 Epoch=100.1] | Loss=0.01073 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=11.469 | 5636.3 samples/s | 88.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=100.1] | Loss=0.00823 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=11.566 | 7041.7 samples/s | 110.0 steps/s
[Step=10550 Epoch=100.6] | Loss=0.00921 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.424 | L2-Norm(final)=11.571 | 4053.1 samples/s | 63.3 steps/s
[Step=10600 Epoch=101.0] | Loss=0.00638 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=11.567 | 6717.1 samples/s | 105.0 steps/s
[Step=10650 Epoch=101.5] | Loss=0.00434 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.564 | L2-Norm(final)=11.567 | 2410.5 samples/s | 37.7 steps/s
[Step=10700 Epoch=102.0] | Loss=0.00327 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.574 | L2-Norm(final)=11.569 | 5940.7 samples/s | 92.8 steps/s
[Step=10750 Epoch=102.5] | Loss=0.00262 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.571 | L2-Norm(final)=11.570 | 2454.2 samples/s | 38.3 steps/s
[Step=10800 Epoch=102.9] | Loss=0.00219 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.562 | L2-Norm(final)=11.571 | 5708.3 samples/s | 89.2 steps/s
[Step=10850 Epoch=103.4] | Loss=0.00188 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=11.572 | 2514.0 samples/s | 39.3 steps/s
[Step=10900 Epoch=103.9] | Loss=0.00165 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=11.573 | 5274.9 samples/s | 82.4 steps/s
[Step=10950 Epoch=104.4] | Loss=0.00146 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=11.574 | 2622.4 samples/s | 41.0 steps/s
[Step=11000 Epoch=104.8] | Loss=0.00132 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.504 | L2-Norm(final)=11.574 | 4957.4 samples/s | 77.5 steps/s
[Step=11050 Epoch=105.3] | Loss=0.00120 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=11.575 | 2716.3 samples/s | 42.4 steps/s
[Step=11100 Epoch=105.8] | Loss=0.00110 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.470 | L2-Norm(final)=11.576 | 4623.3 samples/s | 72.2 steps/s
[Step=11150 Epoch=106.3] | Loss=0.00102 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.453 | L2-Norm(final)=11.576 | 2816.2 samples/s | 44.0 steps/s
[Step=11200 Epoch=106.7] | Loss=0.00094 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.436 | L2-Norm(final)=11.577 | 4601.4 samples/s | 71.9 steps/s
[Step=11250 Epoch=107.2] | Loss=0.00088 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.418 | L2-Norm(final)=11.577 | 2836.7 samples/s | 44.3 steps/s
[Step=11300 Epoch=107.7] | Loss=0.00083 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.401 | L2-Norm(final)=11.578 | 4466.8 samples/s | 69.8 steps/s
[Step=11350 Epoch=108.2] | Loss=0.00078 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.384 | L2-Norm(final)=11.578 | 2864.6 samples/s | 44.8 steps/s
[Step=11400 Epoch=108.7] | Loss=0.00074 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.366 | L2-Norm(final)=11.579 | 4487.1 samples/s | 70.1 steps/s
[Step=11450 Epoch=109.1] | Loss=0.00070 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.349 | L2-Norm(final)=11.579 | 2839.3 samples/s | 44.4 steps/s
[Step=11500 Epoch=109.6] | Loss=0.00066 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=11.580 | 4576.2 samples/s | 71.5 steps/s
[Step=11550 Epoch=110.1] | Loss=0.00063 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=11.580 | 7279.9 samples/s | 113.7 steps/s
[Step=11600 Epoch=110.6] | Loss=0.00060 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=11.581 | 2299.0 samples/s | 35.9 steps/s
[Step=11650 Epoch=111.0] | Loss=0.00058 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=11.581 | 6652.0 samples/s | 103.9 steps/s
[Step=11700 Epoch=111.5] | Loss=0.00055 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=11.581 | 2369.3 samples/s | 37.0 steps/s
[Step=11750 Epoch=112.0] | Loss=0.00053 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.245 | L2-Norm(final)=11.582 | 6122.1 samples/s | 95.7 steps/s
[Step=11800 Epoch=112.5] | Loss=0.00051 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=11.582 | 2470.6 samples/s | 38.6 steps/s
[Step=11850 Epoch=112.9] | Loss=0.00049 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=11.583 | 5565.5 samples/s | 87.0 steps/s
[Step=11900 Epoch=113.4] | Loss=0.00047 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.194 | L2-Norm(final)=11.583 | 2539.1 samples/s | 39.7 steps/s
[Step=11950 Epoch=113.9] | Loss=0.00046 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=11.583 | 5304.3 samples/s | 82.9 steps/s
[Step=12000 Epoch=114.4] | Loss=0.00044 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=11.584 | 2608.1 samples/s | 40.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11273 | acc=0.9507 | tpr=0.9625 | fpr=0.0748 | 5845.0 samples/s | 22.8 steps/s
Avg test loss: 0.11998, Avg test acc: 0.94791, Avg tpr: 0.95972, Avg fpr: 0.07807, total FA: 609

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.12196 | acc=0.9471 | tpr=0.9683 | fpr=0.0989 | 5951.5 samples/s | 23.2 steps/s
Avg test loss: 0.12318, Avg test acc: 0.94811, Avg tpr: 0.96853, Avg fpr: 0.09678, total FA: 755

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11141 | acc=0.9500 | tpr=0.9744 | fpr=0.1031 | 5994.4 samples/s | 23.4 steps/s
Avg test loss: 0.11265, Avg test acc: 0.94960, Avg tpr: 0.97319, Avg fpr: 0.10229, total FA: 798

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.11848 | acc=0.9509 | tpr=0.9633 | fpr=0.0758 | 5851.4 samples/s | 22.9 steps/s
Avg test loss: 0.12432, Avg test acc: 0.94859, Avg tpr: 0.96089, Avg fpr: 0.07845, total FA: 612

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.12772 | acc=0.9494 | tpr=0.9683 | fpr=0.0917 | 5956.9 samples/s | 23.3 steps/s
Avg test loss: 0.13083, Avg test acc: 0.94799, Avg tpr: 0.96666, Avg fpr: 0.09306, total FA: 726

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.57087 | acc=0.3069 | tpr=0.0218 | fpr=0.0741 | 5893.9 samples/s | 23.0 steps/s
Avg test loss: 6.57704, Avg test acc: 0.30579, Avg tpr: 0.02250, Avg fpr: 0.07114, total FA: 555

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.13494 | acc=0.3137 | tpr=0.0209 | fpr=0.0505 | 6049.7 samples/s | 23.6 steps/s
Avg test loss: 5.14533, Avg test acc: 0.30988, Avg tpr: 0.02046, Avg fpr: 0.05358, total FA: 418

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.98424 | acc=0.3064 | tpr=0.0122 | fpr=0.0548 | 6081.1 samples/s | 23.8 steps/s
Avg test loss: 4.99808, Avg test acc: 0.30347, Avg tpr: 0.01218, Avg fpr: 0.05589, total FA: 436

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.28966 | acc=0.3059 | tpr=0.0273 | fpr=0.0889 | 5872.9 samples/s | 22.9 steps/s
Avg test loss: 5.29385, Avg test acc: 0.30499, Avg tpr: 0.02693, Avg fpr: 0.08345, total FA: 651

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.54194 | acc=0.3100 | tpr=0.0143 | fpr=0.0478 | 5716.3 samples/s | 22.3 steps/s
Avg test loss: 5.56507, Avg test acc: 0.30832, Avg tpr: 0.01393, Avg fpr: 0.04423, total FA: 345

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.45839 | acc=0.1477 | tpr=0.6726 | fpr=0.8617 | 6137.3 samples/s | 24.0 steps/s
[Step= 100] | Loss=5.44051 | acc=0.1492 | tpr=0.6652 | fpr=0.8605 | 7860.8 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.43446 | acc=0.1506 | tpr=0.6758 | fpr=0.8591 | 8053.7 samples/s | 31.5 steps/s
[Step= 200] | Loss=5.43259 | acc=0.1504 | tpr=0.6776 | fpr=0.8592 | 7158.2 samples/s | 28.0 steps/s
[Step= 250] | Loss=5.43516 | acc=0.1502 | tpr=0.6734 | fpr=0.8593 | 8403.9 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.42985 | acc=0.1502 | tpr=0.6705 | fpr=0.8593 | 7602.0 samples/s | 29.7 steps/s
[Step= 350] | Loss=5.43268 | acc=0.1498 | tpr=0.6688 | fpr=0.8596 | 8263.7 samples/s | 32.3 steps/s
[Step= 400] | Loss=5.43140 | acc=0.1503 | tpr=0.6668 | fpr=0.8591 | 7984.5 samples/s | 31.2 steps/s
[Step= 450] | Loss=5.43488 | acc=0.1498 | tpr=0.6685 | fpr=0.8597 | 8334.6 samples/s | 32.6 steps/s
[Step= 500] | Loss=5.43466 | acc=0.1500 | tpr=0.6727 | fpr=0.8594 | 8179.2 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.43887 | acc=0.1498 | tpr=0.6729 | fpr=0.8597 | 10338.5 samples/s | 40.4 steps/s
Avg test loss: 5.43935, Avg test acc: 0.14978, Avg tpr: 0.67353, Avg fpr: 0.85975, total FA: 119374

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.53833 | acc=0.1373 | tpr=0.6814 | fpr=0.8724 | 5750.3 samples/s | 22.5 steps/s
[Step= 100] | Loss=5.52258 | acc=0.1395 | tpr=0.6759 | fpr=0.8705 | 8003.4 samples/s | 31.3 steps/s
[Step= 150] | Loss=5.51394 | acc=0.1400 | tpr=0.6816 | fpr=0.8700 | 8262.6 samples/s | 32.3 steps/s
[Step= 200] | Loss=5.51769 | acc=0.1395 | tpr=0.6787 | fpr=0.8703 | 7948.6 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.52439 | acc=0.1393 | tpr=0.6803 | fpr=0.8706 | 7941.5 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.51914 | acc=0.1393 | tpr=0.6756 | fpr=0.8705 | 8016.3 samples/s | 31.3 steps/s
[Step= 350] | Loss=5.52539 | acc=0.1387 | tpr=0.6738 | fpr=0.8710 | 8029.9 samples/s | 31.4 steps/s
[Step= 400] | Loss=5.52149 | acc=0.1390 | tpr=0.6767 | fpr=0.8707 | 7376.9 samples/s | 28.8 steps/s
[Step= 450] | Loss=5.52569 | acc=0.1387 | tpr=0.6782 | fpr=0.8711 | 8333.3 samples/s | 32.6 steps/s
[Step= 500] | Loss=5.52731 | acc=0.1386 | tpr=0.6802 | fpr=0.8711 | 8142.7 samples/s | 31.8 steps/s
[Step= 550] | Loss=5.53387 | acc=0.1385 | tpr=0.6844 | fpr=0.8714 | 10970.1 samples/s | 42.9 steps/s
Avg test loss: 5.53475, Avg test acc: 0.13844, Avg tpr: 0.68463, Avg fpr: 0.87149, total FA: 121005

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.75191 | acc=0.1116 | tpr=0.7522 | fpr=0.9000 | 6183.8 samples/s | 24.2 steps/s
[Step= 100] | Loss=5.73705 | acc=0.1121 | tpr=0.7527 | fpr=0.8998 | 7383.7 samples/s | 28.8 steps/s
[Step= 150] | Loss=5.73246 | acc=0.1138 | tpr=0.7493 | fpr=0.8979 | 7699.2 samples/s | 30.1 steps/s
[Step= 200] | Loss=5.72792 | acc=0.1140 | tpr=0.7410 | fpr=0.8974 | 7641.1 samples/s | 29.8 steps/s
[Step= 250] | Loss=5.73226 | acc=0.1143 | tpr=0.7406 | fpr=0.8971 | 8160.9 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.73034 | acc=0.1139 | tpr=0.7382 | fpr=0.8974 | 7470.9 samples/s | 29.2 steps/s
[Step= 350] | Loss=5.73647 | acc=0.1137 | tpr=0.7389 | fpr=0.8976 | 8332.6 samples/s | 32.5 steps/s
[Step= 400] | Loss=5.73395 | acc=0.1139 | tpr=0.7412 | fpr=0.8975 | 8328.5 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.73875 | acc=0.1132 | tpr=0.7444 | fpr=0.8982 | 8220.0 samples/s | 32.1 steps/s
[Step= 500] | Loss=5.73693 | acc=0.1131 | tpr=0.7449 | fpr=0.8983 | 7885.5 samples/s | 30.8 steps/s
[Step= 550] | Loss=5.74165 | acc=0.1132 | tpr=0.7441 | fpr=0.8983 | 11834.4 samples/s | 46.2 steps/s
Avg test loss: 5.74189, Avg test acc: 0.11305, Avg tpr: 0.74445, Avg fpr: 0.89843, total FA: 124745

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.66530 | acc=0.1398 | tpr=0.7257 | fpr=0.8707 | 6049.8 samples/s | 23.6 steps/s
[Step= 100] | Loss=5.64256 | acc=0.1419 | tpr=0.7079 | fpr=0.8686 | 7337.7 samples/s | 28.7 steps/s
[Step= 150] | Loss=5.63596 | acc=0.1435 | tpr=0.7161 | fpr=0.8670 | 8419.0 samples/s | 32.9 steps/s
[Step= 200] | Loss=5.63561 | acc=0.1438 | tpr=0.7137 | fpr=0.8665 | 8265.1 samples/s | 32.3 steps/s
[Step= 250] | Loss=5.63499 | acc=0.1436 | tpr=0.7135 | fpr=0.8668 | 7720.8 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.62631 | acc=0.1437 | tpr=0.7091 | fpr=0.8666 | 8248.3 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.63170 | acc=0.1434 | tpr=0.7082 | fpr=0.8669 | 8417.4 samples/s | 32.9 steps/s
[Step= 400] | Loss=5.63056 | acc=0.1439 | tpr=0.7068 | fpr=0.8663 | 7876.9 samples/s | 30.8 steps/s
[Step= 450] | Loss=5.63572 | acc=0.1435 | tpr=0.7103 | fpr=0.8668 | 7870.6 samples/s | 30.7 steps/s
[Step= 500] | Loss=5.63601 | acc=0.1436 | tpr=0.7115 | fpr=0.8667 | 8140.0 samples/s | 31.8 steps/s
[Step= 550] | Loss=5.64309 | acc=0.1436 | tpr=0.7127 | fpr=0.8668 | 9927.6 samples/s | 38.8 steps/s
Avg test loss: 5.64422, Avg test acc: 0.14350, Avg tpr: 0.71355, Avg fpr: 0.86686, total FA: 120362

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.71595 | acc=0.1283 | tpr=0.6681 | fpr=0.8814 | 5787.2 samples/s | 22.6 steps/s
[Step= 100] | Loss=5.70721 | acc=0.1320 | tpr=0.6439 | fpr=0.8776 | 8192.6 samples/s | 32.0 steps/s
[Step= 150] | Loss=5.70269 | acc=0.1347 | tpr=0.6556 | fpr=0.8748 | 7964.9 samples/s | 31.1 steps/s
[Step= 200] | Loss=5.70622 | acc=0.1352 | tpr=0.6590 | fpr=0.8744 | 7938.7 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.71006 | acc=0.1350 | tpr=0.6559 | fpr=0.8745 | 8391.6 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.70384 | acc=0.1352 | tpr=0.6575 | fpr=0.8743 | 8329.8 samples/s | 32.5 steps/s
[Step= 350] | Loss=5.71223 | acc=0.1349 | tpr=0.6537 | fpr=0.8745 | 8213.9 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.71195 | acc=0.1351 | tpr=0.6510 | fpr=0.8743 | 7768.8 samples/s | 30.3 steps/s
[Step= 450] | Loss=5.71734 | acc=0.1344 | tpr=0.6534 | fpr=0.8750 | 7328.5 samples/s | 28.6 steps/s
[Step= 500] | Loss=5.71594 | acc=0.1345 | tpr=0.6551 | fpr=0.8749 | 8614.2 samples/s | 33.6 steps/s
[Step= 550] | Loss=5.71995 | acc=0.1347 | tpr=0.6578 | fpr=0.8748 | 10157.0 samples/s | 39.7 steps/s
Avg test loss: 5.72078, Avg test acc: 0.13471, Avg tpr: 0.65887, Avg fpr: 0.87482, total FA: 121467

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.20676 | acc=0.9566 | tpr=0.9115 | fpr=0.0426 | 5938.3 samples/s | 23.2 steps/s
[Step= 100] | Loss=0.21176 | acc=0.9555 | tpr=0.9339 | fpr=0.0441 | 8045.1 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.21208 | acc=0.9538 | tpr=0.9337 | fpr=0.0458 | 7944.6 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.21129 | acc=0.9544 | tpr=0.9399 | fpr=0.0454 | 7913.0 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.21132 | acc=0.9540 | tpr=0.9345 | fpr=0.0456 | 7697.9 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.21456 | acc=0.9537 | tpr=0.9338 | fpr=0.0459 | 8303.9 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.21453 | acc=0.9539 | tpr=0.9330 | fpr=0.0457 | 8613.0 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.21425 | acc=0.9538 | tpr=0.9278 | fpr=0.0457 | 7844.2 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.21767 | acc=0.9534 | tpr=0.9255 | fpr=0.0461 | 7967.4 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.21737 | acc=0.9533 | tpr=0.9286 | fpr=0.0462 | 8093.5 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.21598 | acc=0.9536 | tpr=0.9288 | fpr=0.0460 | 9584.9 samples/s | 37.4 steps/s
Avg test loss: 0.21566, Avg test acc: 0.95360, Avg tpr: 0.92868, Avg fpr: 0.04595, total FA: 6380

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15022 | acc=0.9635 | tpr=0.8673 | fpr=0.0348 | 5931.1 samples/s | 23.2 steps/s
[Step= 100] | Loss=0.15281 | acc=0.9626 | tpr=0.8934 | fpr=0.0361 | 7521.6 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.15425 | acc=0.9620 | tpr=0.9020 | fpr=0.0369 | 8530.4 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.15266 | acc=0.9620 | tpr=0.9082 | fpr=0.0370 | 7993.6 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.15338 | acc=0.9619 | tpr=0.9057 | fpr=0.0371 | 8027.5 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.15604 | acc=0.9613 | tpr=0.9004 | fpr=0.0376 | 7974.2 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.15543 | acc=0.9614 | tpr=0.9011 | fpr=0.0375 | 8310.7 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.15545 | acc=0.9613 | tpr=0.8982 | fpr=0.0376 | 7748.7 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.15813 | acc=0.9605 | tpr=0.8982 | fpr=0.0383 | 7600.7 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.15859 | acc=0.9604 | tpr=0.9022 | fpr=0.0386 | 7161.8 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.15795 | acc=0.9606 | tpr=0.9005 | fpr=0.0384 | 12902.0 samples/s | 50.4 steps/s
Avg test loss: 0.15771, Avg test acc: 0.96057, Avg tpr: 0.90016, Avg fpr: 0.03834, total FA: 5323

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.25385 | acc=0.9466 | tpr=0.9248 | fpr=0.0530 | 6064.8 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.26008 | acc=0.9452 | tpr=0.9382 | fpr=0.0547 | 7845.0 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.26604 | acc=0.9441 | tpr=0.9352 | fpr=0.0558 | 7116.2 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.26450 | acc=0.9441 | tpr=0.9399 | fpr=0.0558 | 8679.6 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.26540 | acc=0.9443 | tpr=0.9380 | fpr=0.0556 | 8209.3 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.26842 | acc=0.9440 | tpr=0.9360 | fpr=0.0559 | 8002.8 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.26699 | acc=0.9442 | tpr=0.9368 | fpr=0.0556 | 8152.3 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.26679 | acc=0.9439 | tpr=0.9322 | fpr=0.0558 | 7778.7 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.27091 | acc=0.9434 | tpr=0.9284 | fpr=0.0563 | 8302.6 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.27153 | acc=0.9433 | tpr=0.9304 | fpr=0.0565 | 8145.5 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.27027 | acc=0.9434 | tpr=0.9300 | fpr=0.0563 | 9695.9 samples/s | 37.9 steps/s
Avg test loss: 0.26995, Avg test acc: 0.94346, Avg tpr: 0.92987, Avg fpr: 0.05629, total FA: 7816

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11478 | acc=0.9707 | tpr=0.9027 | fpr=0.0281 | 5995.5 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.11808 | acc=0.9700 | tpr=0.8998 | fpr=0.0287 | 7893.6 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.11886 | acc=0.9702 | tpr=0.9020 | fpr=0.0286 | 7860.3 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.11850 | acc=0.9700 | tpr=0.9060 | fpr=0.0288 | 7323.2 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.11796 | acc=0.9704 | tpr=0.9057 | fpr=0.0285 | 8744.3 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.12123 | acc=0.9696 | tpr=0.9025 | fpr=0.0292 | 8323.6 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.12103 | acc=0.9695 | tpr=0.9029 | fpr=0.0293 | 8315.7 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.12013 | acc=0.9694 | tpr=0.9015 | fpr=0.0294 | 8271.9 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.12251 | acc=0.9689 | tpr=0.9002 | fpr=0.0298 | 8067.8 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.12209 | acc=0.9689 | tpr=0.9026 | fpr=0.0299 | 7812.1 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.12143 | acc=0.9691 | tpr=0.9025 | fpr=0.0297 | 9550.8 samples/s | 37.3 steps/s
Avg test loss: 0.12125, Avg test acc: 0.96915, Avg tpr: 0.90254, Avg fpr: 0.02964, total FA: 4116

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21413 | acc=0.9546 | tpr=0.8805 | fpr=0.0441 | 6057.3 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.22223 | acc=0.9539 | tpr=0.9041 | fpr=0.0452 | 7911.0 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.22688 | acc=0.9531 | tpr=0.9164 | fpr=0.0463 | 8260.3 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.22685 | acc=0.9533 | tpr=0.9202 | fpr=0.0461 | 7220.2 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.22823 | acc=0.9533 | tpr=0.9153 | fpr=0.0460 | 7963.1 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.23089 | acc=0.9527 | tpr=0.9105 | fpr=0.0465 | 8123.5 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.22974 | acc=0.9527 | tpr=0.9117 | fpr=0.0466 | 7581.3 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.22922 | acc=0.9525 | tpr=0.9081 | fpr=0.0467 | 7787.0 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.23284 | acc=0.9520 | tpr=0.9070 | fpr=0.0472 | 8086.8 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.23321 | acc=0.9518 | tpr=0.9070 | fpr=0.0474 | 8114.5 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.23214 | acc=0.9519 | tpr=0.9081 | fpr=0.0473 | 12023.8 samples/s | 47.0 steps/s
Avg test loss: 0.23182, Avg test acc: 0.95194, Avg tpr: 0.90729, Avg fpr: 0.04725, total FA: 6561

server round 13/50

clients selected: [1 5 6 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=68.3] | Loss=0.05316 | Reg=0.00146 | acc=0.9375 | L2-Norm=12.070 | L2-Norm(final)=11.660 | 7288.0 samples/s | 113.9 steps/s
[Step=14050 Epoch=68.6] | Loss=0.05536 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.069 | L2-Norm(final)=11.639 | 5256.1 samples/s | 82.1 steps/s
[Step=14100 Epoch=68.8] | Loss=0.05536 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.069 | L2-Norm(final)=11.623 | 5574.3 samples/s | 87.1 steps/s
[Step=14150 Epoch=69.0] | Loss=0.05369 | Reg=0.00146 | acc=0.9219 | L2-Norm=12.069 | L2-Norm(final)=11.607 | 5439.4 samples/s | 85.0 steps/s
[Step=14200 Epoch=69.3] | Loss=0.05290 | Reg=0.00146 | acc=0.9375 | L2-Norm=12.069 | L2-Norm(final)=11.596 | 8808.1 samples/s | 137.6 steps/s
[Step=14250 Epoch=69.5] | Loss=0.05273 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.069 | L2-Norm(final)=11.587 | 2658.2 samples/s | 41.5 steps/s
[Step=14300 Epoch=69.8] | Loss=0.05219 | Reg=0.00146 | acc=0.9375 | L2-Norm=12.069 | L2-Norm(final)=11.579 | 5662.5 samples/s | 88.5 steps/s
[Step=14350 Epoch=70.0] | Loss=0.05161 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.069 | L2-Norm(final)=11.573 | 5422.8 samples/s | 84.7 steps/s
[Step=14400 Epoch=70.3] | Loss=0.05215 | Reg=0.00146 | acc=0.9531 | L2-Norm=12.069 | L2-Norm(final)=11.568 | 7916.3 samples/s | 123.7 steps/s
[Step=14450 Epoch=70.5] | Loss=0.05223 | Reg=0.00146 | acc=0.9375 | L2-Norm=12.069 | L2-Norm(final)=11.562 | 2750.8 samples/s | 43.0 steps/s
[Step=14500 Epoch=70.8] | Loss=0.05223 | Reg=0.00146 | acc=0.9531 | L2-Norm=12.069 | L2-Norm(final)=11.555 | 5650.7 samples/s | 88.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=70.8] | Loss=0.08814 | Reg=0.00146 | acc=0.9531 | L2-Norm=12.069 | L2-Norm(final)=11.483 | 7749.0 samples/s | 121.1 steps/s
[Step=14550 Epoch=71.0] | Loss=0.04805 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.182 | L2-Norm(final)=11.475 | 4057.1 samples/s | 63.4 steps/s
[Step=14600 Epoch=71.2] | Loss=0.04905 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.281 | L2-Norm(final)=11.464 | 4743.2 samples/s | 74.1 steps/s
[Step=14650 Epoch=71.5] | Loss=0.04939 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.358 | L2-Norm(final)=11.453 | 4827.5 samples/s | 75.4 steps/s
[Step=14700 Epoch=71.7] | Loss=0.04715 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.428 | L2-Norm(final)=11.444 | 6796.4 samples/s | 106.2 steps/s
[Step=14750 Epoch=72.0] | Loss=0.04148 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.487 | L2-Norm(final)=11.442 | 2489.8 samples/s | 38.9 steps/s
[Step=14800 Epoch=72.2] | Loss=0.03691 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=11.444 | 4668.5 samples/s | 72.9 steps/s
[Step=14850 Epoch=72.5] | Loss=0.03403 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.579 | L2-Norm(final)=11.446 | 4775.8 samples/s | 74.6 steps/s
[Step=14900 Epoch=72.7] | Loss=0.03234 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=11.448 | 6353.9 samples/s | 99.3 steps/s
[Step=14950 Epoch=72.9] | Loss=0.02986 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.650 | L2-Norm(final)=11.451 | 2553.0 samples/s | 39.9 steps/s
[Step=15000 Epoch=73.2] | Loss=0.02797 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.679 | L2-Norm(final)=11.453 | 4841.4 samples/s | 75.6 steps/s
[Step=15050 Epoch=73.4] | Loss=0.02627 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.705 | L2-Norm(final)=11.456 | 4666.6 samples/s | 72.9 steps/s
[Step=15100 Epoch=73.7] | Loss=0.02535 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.728 | L2-Norm(final)=11.460 | 5910.2 samples/s | 92.3 steps/s
[Step=15150 Epoch=73.9] | Loss=0.02439 | Reg=0.00163 | acc=0.9688 | L2-Norm=12.750 | L2-Norm(final)=11.462 | 2618.4 samples/s | 40.9 steps/s
[Step=15200 Epoch=74.2] | Loss=0.02342 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.772 | L2-Norm(final)=11.465 | 4747.1 samples/s | 74.2 steps/s
[Step=15250 Epoch=74.4] | Loss=0.02237 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.792 | L2-Norm(final)=11.468 | 4740.7 samples/s | 74.1 steps/s
[Step=15300 Epoch=74.7] | Loss=0.02137 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.811 | L2-Norm(final)=11.471 | 5580.8 samples/s | 87.2 steps/s
[Step=15350 Epoch=74.9] | Loss=0.02057 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.828 | L2-Norm(final)=11.474 | 2720.7 samples/s | 42.5 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01982 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.843 | L2-Norm(final)=11.476 | 4759.3 samples/s | 74.4 steps/s
[Step=15450 Epoch=75.4] | Loss=0.01925 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.858 | L2-Norm(final)=11.479 | 4710.5 samples/s | 73.6 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01870 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.871 | L2-Norm(final)=11.481 | 5176.2 samples/s | 80.9 steps/s
[Step=15550 Epoch=75.9] | Loss=0.01814 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.883 | L2-Norm(final)=11.483 | 2793.7 samples/s | 43.7 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01758 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.895 | L2-Norm(final)=11.485 | 4764.3 samples/s | 74.4 steps/s
[Step=15650 Epoch=76.4] | Loss=0.01709 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=11.488 | 4724.5 samples/s | 73.8 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01650 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.915 | L2-Norm(final)=11.490 | 4883.6 samples/s | 76.3 steps/s
[Step=15750 Epoch=76.9] | Loss=0.01605 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.924 | L2-Norm(final)=11.492 | 2927.2 samples/s | 45.7 steps/s
[Step=15800 Epoch=77.1] | Loss=0.01561 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.932 | L2-Norm(final)=11.494 | 4665.6 samples/s | 72.9 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01524 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=11.496 | 4721.6 samples/s | 73.8 steps/s
[Step=15900 Epoch=77.6] | Loss=0.01482 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.947 | L2-Norm(final)=11.498 | 4777.1 samples/s | 74.6 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01449 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.953 | L2-Norm(final)=11.500 | 2935.1 samples/s | 45.9 steps/s
[Step=16000 Epoch=78.1] | Loss=0.01416 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.960 | L2-Norm(final)=11.502 | 4784.9 samples/s | 74.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=170.6] | Loss=0.00007 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=15.334 | 6030.4 samples/s | 94.2 steps/s
[Step=18050 Epoch=171.0] | Loss=0.00109 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.066 | L2-Norm(final)=15.342 | 4703.1 samples/s | 73.5 steps/s
[Step=18100 Epoch=171.5] | Loss=0.00159 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.065 | L2-Norm(final)=15.357 | 7911.9 samples/s | 123.6 steps/s
[Step=18150 Epoch=172.0] | Loss=0.00161 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.065 | L2-Norm(final)=15.369 | 2549.2 samples/s | 39.8 steps/s
[Step=18200 Epoch=172.5] | Loss=0.00157 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.065 | L2-Norm(final)=15.379 | 7320.5 samples/s | 114.4 steps/s
[Step=18250 Epoch=172.9] | Loss=0.00159 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.065 | L2-Norm(final)=15.393 | 2697.8 samples/s | 42.2 steps/s
[Step=18300 Epoch=173.4] | Loss=0.00155 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.065 | L2-Norm(final)=15.405 | 6430.2 samples/s | 100.5 steps/s
[Step=18350 Epoch=173.9] | Loss=0.00148 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.065 | L2-Norm(final)=15.417 | 2803.9 samples/s | 43.8 steps/s
[Step=18400 Epoch=174.4] | Loss=0.00152 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.065 | L2-Norm(final)=15.428 | 5886.1 samples/s | 92.0 steps/s
[Step=18450 Epoch=174.8] | Loss=0.00154 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.065 | L2-Norm(final)=15.440 | 2928.3 samples/s | 45.8 steps/s
[Step=18500 Epoch=175.3] | Loss=0.00150 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.065 | L2-Norm(final)=15.451 | 5357.2 samples/s | 83.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=175.3] | Loss=0.00041 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.065 | L2-Norm(final)=15.566 | 7097.7 samples/s | 110.9 steps/s
[Step=18550 Epoch=175.8] | Loss=0.00533 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.097 | L2-Norm(final)=15.573 | 4001.2 samples/s | 62.5 steps/s
[Step=18600 Epoch=176.3] | Loss=0.00467 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=15.555 | 6492.0 samples/s | 101.4 steps/s
[Step=18650 Epoch=176.7] | Loss=0.00362 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=15.550 | 2392.4 samples/s | 37.4 steps/s
[Step=18700 Epoch=177.2] | Loss=0.00285 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.320 | L2-Norm(final)=15.549 | 5865.2 samples/s | 91.6 steps/s
[Step=18750 Epoch=177.7] | Loss=0.00229 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=15.549 | 2479.7 samples/s | 38.7 steps/s
[Step=18800 Epoch=178.1] | Loss=0.00191 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.340 | L2-Norm(final)=15.550 | 5419.4 samples/s | 84.7 steps/s
[Step=18850 Epoch=178.6] | Loss=0.00164 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.338 | L2-Norm(final)=15.551 | 2567.5 samples/s | 40.1 steps/s
[Step=18900 Epoch=179.1] | Loss=0.00144 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=15.552 | 5039.0 samples/s | 78.7 steps/s
[Step=18950 Epoch=179.6] | Loss=0.00128 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=15.553 | 2721.0 samples/s | 42.5 steps/s
[Step=19000 Epoch=180.0] | Loss=0.00115 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=15.553 | 4559.9 samples/s | 71.2 steps/s
[Step=19050 Epoch=180.5] | Loss=0.00105 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=15.554 | 2826.4 samples/s | 44.2 steps/s
[Step=19100 Epoch=181.0] | Loss=0.00096 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.289 | L2-Norm(final)=15.555 | 4544.4 samples/s | 71.0 steps/s
[Step=19150 Epoch=181.5] | Loss=0.00089 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.277 | L2-Norm(final)=15.555 | 2828.0 samples/s | 44.2 steps/s
[Step=19200 Epoch=181.9] | Loss=0.00082 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.263 | L2-Norm(final)=15.556 | 4536.8 samples/s | 70.9 steps/s
[Step=19250 Epoch=182.4] | Loss=0.00077 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.250 | L2-Norm(final)=15.557 | 2857.5 samples/s | 44.6 steps/s
[Step=19300 Epoch=182.9] | Loss=0.00072 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.237 | L2-Norm(final)=15.557 | 4618.7 samples/s | 72.2 steps/s
[Step=19350 Epoch=183.4] | Loss=0.00068 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=15.558 | 3055.2 samples/s | 47.7 steps/s
[Step=19400 Epoch=183.8] | Loss=0.00064 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.210 | L2-Norm(final)=15.559 | 4071.4 samples/s | 63.6 steps/s
[Step=19450 Epoch=184.3] | Loss=0.00061 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.196 | L2-Norm(final)=15.559 | 6839.8 samples/s | 106.9 steps/s
[Step=19500 Epoch=184.8] | Loss=0.00058 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=15.560 | 2400.7 samples/s | 37.5 steps/s
[Step=19550 Epoch=185.3] | Loss=0.00055 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=15.560 | 5984.8 samples/s | 93.5 steps/s
[Step=19600 Epoch=185.7] | Loss=0.00052 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=15.561 | 2427.3 samples/s | 37.9 steps/s
[Step=19650 Epoch=186.2] | Loss=0.00050 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=15.561 | 5658.8 samples/s | 88.4 steps/s
[Step=19700 Epoch=186.7] | Loss=0.00048 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.127 | L2-Norm(final)=15.562 | 2542.8 samples/s | 39.7 steps/s
[Step=19750 Epoch=187.1] | Loss=0.00046 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.113 | L2-Norm(final)=15.562 | 5176.7 samples/s | 80.9 steps/s
[Step=19800 Epoch=187.6] | Loss=0.00044 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.099 | L2-Norm(final)=15.563 | 2672.9 samples/s | 41.8 steps/s
[Step=19850 Epoch=188.1] | Loss=0.00043 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.085 | L2-Norm(final)=15.563 | 4678.1 samples/s | 73.1 steps/s
[Step=19900 Epoch=188.6] | Loss=0.00041 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.072 | L2-Norm(final)=15.564 | 2746.2 samples/s | 42.9 steps/s
[Step=19950 Epoch=189.0] | Loss=0.00040 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.058 | L2-Norm(final)=15.564 | 4546.0 samples/s | 71.0 steps/s
[Step=20000 Epoch=189.5] | Loss=0.00039 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.044 | L2-Norm(final)=15.564 | 2885.1 samples/s | 45.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step20000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=114.2] | Loss=0.00209 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=12.489 | 7604.1 samples/s | 118.8 steps/s
[Step=12050 Epoch=114.6] | Loss=0.00748 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.063 | L2-Norm(final)=12.498 | 4337.8 samples/s | 67.8 steps/s
[Step=12100 Epoch=115.1] | Loss=0.00741 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.063 | L2-Norm(final)=12.495 | 8339.8 samples/s | 130.3 steps/s
[Step=12150 Epoch=115.6] | Loss=0.00823 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.062 | L2-Norm(final)=12.491 | 2555.0 samples/s | 39.9 steps/s
[Step=12200 Epoch=116.1] | Loss=0.00760 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.062 | L2-Norm(final)=12.488 | 7384.0 samples/s | 115.4 steps/s
[Step=12250 Epoch=116.5] | Loss=0.00746 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.062 | L2-Norm(final)=12.494 | 2683.5 samples/s | 41.9 steps/s
[Step=12300 Epoch=117.0] | Loss=0.00767 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.062 | L2-Norm(final)=12.501 | 6554.6 samples/s | 102.4 steps/s
[Step=12350 Epoch=117.5] | Loss=0.00742 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.062 | L2-Norm(final)=12.504 | 2783.2 samples/s | 43.5 steps/s
[Step=12400 Epoch=118.0] | Loss=0.00744 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.062 | L2-Norm(final)=12.508 | 5948.1 samples/s | 92.9 steps/s
[Step=12450 Epoch=118.4] | Loss=0.00737 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.062 | L2-Norm(final)=12.511 | 2966.6 samples/s | 46.4 steps/s
[Step=12500 Epoch=118.9] | Loss=0.00746 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.062 | L2-Norm(final)=12.515 | 5303.5 samples/s | 82.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=118.9] | Loss=0.00074 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.062 | L2-Norm(final)=12.552 | 6880.8 samples/s | 107.5 steps/s
[Step=12550 Epoch=119.4] | Loss=0.01234 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=12.537 | 4103.1 samples/s | 64.1 steps/s
[Step=12600 Epoch=119.9] | Loss=0.00930 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=12.516 | 6551.5 samples/s | 102.4 steps/s
[Step=12650 Epoch=120.3] | Loss=0.00639 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.532 | L2-Norm(final)=12.511 | 2391.0 samples/s | 37.4 steps/s
[Step=12700 Epoch=120.8] | Loss=0.00481 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.557 | L2-Norm(final)=12.510 | 5922.3 samples/s | 92.5 steps/s
[Step=12750 Epoch=121.3] | Loss=0.00385 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=12.510 | 2479.4 samples/s | 38.7 steps/s
[Step=12800 Epoch=121.8] | Loss=0.00322 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.560 | L2-Norm(final)=12.511 | 5485.4 samples/s | 85.7 steps/s
[Step=12850 Epoch=122.2] | Loss=0.00276 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.552 | L2-Norm(final)=12.511 | 2587.7 samples/s | 40.4 steps/s
[Step=12900 Epoch=122.7] | Loss=0.00242 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.541 | L2-Norm(final)=12.512 | 5104.1 samples/s | 79.8 steps/s
[Step=12950 Epoch=123.2] | Loss=0.00215 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=12.513 | 2681.9 samples/s | 41.9 steps/s
[Step=13000 Epoch=123.7] | Loss=0.00194 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.514 | L2-Norm(final)=12.513 | 4702.8 samples/s | 73.5 steps/s
[Step=13050 Epoch=124.1] | Loss=0.00176 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.499 | L2-Norm(final)=12.514 | 2810.8 samples/s | 43.9 steps/s
[Step=13100 Epoch=124.6] | Loss=0.00161 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=12.515 | 4591.3 samples/s | 71.7 steps/s
[Step=13150 Epoch=125.1] | Loss=0.00149 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.468 | L2-Norm(final)=12.515 | 2826.8 samples/s | 44.2 steps/s
[Step=13200 Epoch=125.6] | Loss=0.00139 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.453 | L2-Norm(final)=12.516 | 4545.7 samples/s | 71.0 steps/s
[Step=13250 Epoch=126.0] | Loss=0.00129 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=12.517 | 2876.6 samples/s | 44.9 steps/s
[Step=13300 Epoch=126.5] | Loss=0.00121 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=12.517 | 4528.4 samples/s | 70.8 steps/s
[Step=13350 Epoch=127.0] | Loss=0.00114 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.404 | L2-Norm(final)=12.518 | 2868.0 samples/s | 44.8 steps/s
[Step=13400 Epoch=127.5] | Loss=0.00108 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.388 | L2-Norm(final)=12.519 | 4537.3 samples/s | 70.9 steps/s
[Step=13450 Epoch=127.9] | Loss=0.00102 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.372 | L2-Norm(final)=12.519 | 6797.4 samples/s | 106.2 steps/s
[Step=13500 Epoch=128.4] | Loss=0.00097 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.356 | L2-Norm(final)=12.520 | 2352.8 samples/s | 36.8 steps/s
[Step=13550 Epoch=128.9] | Loss=0.00093 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.340 | L2-Norm(final)=12.521 | 6234.7 samples/s | 97.4 steps/s
[Step=13600 Epoch=129.4] | Loss=0.00088 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.324 | L2-Norm(final)=12.521 | 2442.0 samples/s | 38.2 steps/s
[Step=13650 Epoch=129.8] | Loss=0.00085 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.308 | L2-Norm(final)=12.522 | 5639.0 samples/s | 88.1 steps/s
[Step=13700 Epoch=130.3] | Loss=0.00081 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=12.522 | 2543.8 samples/s | 39.7 steps/s
[Step=13750 Epoch=130.8] | Loss=0.00078 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.276 | L2-Norm(final)=12.523 | 5127.7 samples/s | 80.1 steps/s
[Step=13800 Epoch=131.3] | Loss=0.00075 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.260 | L2-Norm(final)=12.524 | 2681.9 samples/s | 41.9 steps/s
[Step=13850 Epoch=131.7] | Loss=0.00072 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.243 | L2-Norm(final)=12.524 | 4678.9 samples/s | 73.1 steps/s
[Step=13900 Epoch=132.2] | Loss=0.00070 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=12.525 | 2815.9 samples/s | 44.0 steps/s
[Step=13950 Epoch=132.7] | Loss=0.00067 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=12.525 | 4471.6 samples/s | 69.9 steps/s
[Step=14000 Epoch=133.2] | Loss=0.00065 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=12.526 | 2850.3 samples/s | 44.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step14000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=131.9] | Loss=0.00154 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=12.711 | 6647.3 samples/s | 103.9 steps/s
[Step=14050 Epoch=132.4] | Loss=0.00771 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.064 | L2-Norm(final)=12.713 | 4777.3 samples/s | 74.6 steps/s
[Step=14100 Epoch=132.9] | Loss=0.00979 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.063 | L2-Norm(final)=12.693 | 8054.3 samples/s | 125.8 steps/s
[Step=14150 Epoch=133.3] | Loss=0.00981 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.063 | L2-Norm(final)=12.679 | 2592.4 samples/s | 40.5 steps/s
[Step=14200 Epoch=133.8] | Loss=0.00903 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.063 | L2-Norm(final)=12.672 | 7062.8 samples/s | 110.4 steps/s
[Step=14250 Epoch=134.3] | Loss=0.00889 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.063 | L2-Norm(final)=12.673 | 2728.3 samples/s | 42.6 steps/s
[Step=14300 Epoch=134.7] | Loss=0.00877 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.063 | L2-Norm(final)=12.677 | 6140.5 samples/s | 95.9 steps/s
[Step=14350 Epoch=135.2] | Loss=0.00866 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.063 | L2-Norm(final)=12.681 | 2848.9 samples/s | 44.5 steps/s
[Step=14400 Epoch=135.7] | Loss=0.00885 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.063 | L2-Norm(final)=12.686 | 5593.4 samples/s | 87.4 steps/s
[Step=14450 Epoch=136.2] | Loss=0.00894 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.063 | L2-Norm(final)=12.691 | 3060.6 samples/s | 47.8 steps/s
[Step=14500 Epoch=136.6] | Loss=0.00874 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.063 | L2-Norm(final)=12.696 | 5329.1 samples/s | 83.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=136.6] | Loss=0.00182 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.063 | L2-Norm(final)=12.750 | 7425.6 samples/s | 116.0 steps/s
[Step=14550 Epoch=137.1] | Loss=0.01283 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.264 | L2-Norm(final)=12.737 | 3942.4 samples/s | 61.6 steps/s
[Step=14600 Epoch=137.6] | Loss=0.00937 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.444 | L2-Norm(final)=12.713 | 6517.0 samples/s | 101.8 steps/s
[Step=14650 Epoch=138.0] | Loss=0.00660 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.511 | L2-Norm(final)=12.704 | 2395.8 samples/s | 37.4 steps/s
[Step=14700 Epoch=138.5] | Loss=0.00497 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=12.701 | 5808.8 samples/s | 90.8 steps/s
[Step=14750 Epoch=139.0] | Loss=0.00399 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.542 | L2-Norm(final)=12.701 | 2531.2 samples/s | 39.6 steps/s
[Step=14800 Epoch=139.5] | Loss=0.00333 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.539 | L2-Norm(final)=12.701 | 5218.0 samples/s | 81.5 steps/s
[Step=14850 Epoch=139.9] | Loss=0.00285 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.532 | L2-Norm(final)=12.701 | 2618.1 samples/s | 40.9 steps/s
[Step=14900 Epoch=140.4] | Loss=0.00250 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.521 | L2-Norm(final)=12.701 | 4807.4 samples/s | 75.1 steps/s
[Step=14950 Epoch=140.9] | Loss=0.00222 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.509 | L2-Norm(final)=12.702 | 2768.0 samples/s | 43.3 steps/s
[Step=15000 Epoch=141.3] | Loss=0.00200 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.496 | L2-Norm(final)=12.702 | 4574.0 samples/s | 71.5 steps/s
[Step=15050 Epoch=141.8] | Loss=0.00182 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=12.703 | 2803.3 samples/s | 43.8 steps/s
[Step=15100 Epoch=142.3] | Loss=0.00167 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.467 | L2-Norm(final)=12.704 | 4518.3 samples/s | 70.6 steps/s
[Step=15150 Epoch=142.8] | Loss=0.00154 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=12.704 | 2850.0 samples/s | 44.5 steps/s
[Step=15200 Epoch=143.2] | Loss=0.00143 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=12.705 | 4523.7 samples/s | 70.7 steps/s
[Step=15250 Epoch=143.7] | Loss=0.00134 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.422 | L2-Norm(final)=12.705 | 3054.0 samples/s | 47.7 steps/s
[Step=15300 Epoch=144.2] | Loss=0.00125 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.406 | L2-Norm(final)=12.706 | 4158.3 samples/s | 65.0 steps/s
[Step=15350 Epoch=144.6] | Loss=0.00118 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.391 | L2-Norm(final)=12.706 | 6665.4 samples/s | 104.1 steps/s
[Step=15400 Epoch=145.1] | Loss=0.00112 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.375 | L2-Norm(final)=12.707 | 2368.5 samples/s | 37.0 steps/s
[Step=15450 Epoch=145.6] | Loss=0.00106 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.360 | L2-Norm(final)=12.707 | 5927.5 samples/s | 92.6 steps/s
[Step=15500 Epoch=146.1] | Loss=0.00100 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.344 | L2-Norm(final)=12.708 | 2502.8 samples/s | 39.1 steps/s
[Step=15550 Epoch=146.5] | Loss=0.00096 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.329 | L2-Norm(final)=12.708 | 5300.5 samples/s | 82.8 steps/s
[Step=15600 Epoch=147.0] | Loss=0.00091 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=12.709 | 2619.3 samples/s | 40.9 steps/s
[Step=15650 Epoch=147.5] | Loss=0.00087 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=12.709 | 4849.9 samples/s | 75.8 steps/s
[Step=15700 Epoch=147.9] | Loss=0.00084 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=12.710 | 2765.7 samples/s | 43.2 steps/s
[Step=15750 Epoch=148.4] | Loss=0.00080 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.267 | L2-Norm(final)=12.710 | 4465.6 samples/s | 69.8 steps/s
[Step=15800 Epoch=148.9] | Loss=0.00077 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=12.711 | 2884.8 samples/s | 45.1 steps/s
[Step=15850 Epoch=149.4] | Loss=0.00074 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=12.711 | 4474.8 samples/s | 69.9 steps/s
[Step=15900 Epoch=149.8] | Loss=0.00072 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.221 | L2-Norm(final)=12.712 | 2872.9 samples/s | 44.9 steps/s
[Step=15950 Epoch=150.3] | Loss=0.00069 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.206 | L2-Norm(final)=12.712 | 4491.9 samples/s | 70.2 steps/s
[Step=16000 Epoch=150.8] | Loss=0.00067 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.191 | L2-Norm(final)=12.712 | 2958.4 samples/s | 46.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step16000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=114.4] | Loss=0.00165 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=11.598 | 7308.9 samples/s | 114.2 steps/s
[Step=12050 Epoch=114.8] | Loss=0.00817 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.065 | L2-Norm(final)=11.604 | 4622.8 samples/s | 72.2 steps/s
[Step=12100 Epoch=115.3] | Loss=0.00901 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.064 | L2-Norm(final)=11.609 | 7867.4 samples/s | 122.9 steps/s
[Step=12150 Epoch=115.8] | Loss=0.00915 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.064 | L2-Norm(final)=11.617 | 2554.4 samples/s | 39.9 steps/s
[Step=12200 Epoch=116.3] | Loss=0.00879 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.064 | L2-Norm(final)=11.626 | 7562.6 samples/s | 118.2 steps/s
[Step=12250 Epoch=116.8] | Loss=0.00875 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.063 | L2-Norm(final)=11.635 | 2666.3 samples/s | 41.7 steps/s
[Step=12300 Epoch=117.2] | Loss=0.00858 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.063 | L2-Norm(final)=11.644 | 6568.1 samples/s | 102.6 steps/s
[Step=12350 Epoch=117.7] | Loss=0.00865 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.063 | L2-Norm(final)=11.655 | 2410.4 samples/s | 37.7 steps/s
[Step=12400 Epoch=118.2] | Loss=0.00848 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.063 | L2-Norm(final)=11.667 | 6309.2 samples/s | 98.6 steps/s
[Step=12450 Epoch=118.7] | Loss=0.00820 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.063 | L2-Norm(final)=11.679 | 2855.5 samples/s | 44.6 steps/s
[Step=12500 Epoch=119.1] | Loss=0.00834 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.063 | L2-Norm(final)=11.691 | 5699.4 samples/s | 89.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=119.1] | Loss=0.00182 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.063 | L2-Norm(final)=11.810 | 7157.6 samples/s | 111.8 steps/s
[Step=12550 Epoch=119.6] | Loss=0.00694 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.187 | L2-Norm(final)=11.805 | 3999.6 samples/s | 62.5 steps/s
[Step=12600 Epoch=120.1] | Loss=0.00436 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.302 | L2-Norm(final)=11.804 | 6682.7 samples/s | 104.4 steps/s
[Step=12650 Epoch=120.6] | Loss=0.00342 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.376 | L2-Norm(final)=11.803 | 2366.7 samples/s | 37.0 steps/s
[Step=12700 Epoch=121.0] | Loss=0.00258 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.413 | L2-Norm(final)=11.803 | 6157.2 samples/s | 96.2 steps/s
[Step=12750 Epoch=121.5] | Loss=0.00207 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.426 | L2-Norm(final)=11.804 | 2451.3 samples/s | 38.3 steps/s
[Step=12800 Epoch=122.0] | Loss=0.00172 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.426 | L2-Norm(final)=11.804 | 5687.4 samples/s | 88.9 steps/s
[Step=12850 Epoch=122.5] | Loss=0.00148 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=11.805 | 2545.4 samples/s | 39.8 steps/s
[Step=12900 Epoch=122.9] | Loss=0.00130 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.409 | L2-Norm(final)=11.805 | 5251.7 samples/s | 82.1 steps/s
[Step=12950 Epoch=123.4] | Loss=0.00115 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.396 | L2-Norm(final)=11.806 | 2617.1 samples/s | 40.9 steps/s
[Step=13000 Epoch=123.9] | Loss=0.00104 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.381 | L2-Norm(final)=11.806 | 4945.1 samples/s | 77.3 steps/s
[Step=13050 Epoch=124.4] | Loss=0.00094 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.365 | L2-Norm(final)=11.806 | 2710.5 samples/s | 42.4 steps/s
[Step=13100 Epoch=124.9] | Loss=0.00087 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.349 | L2-Norm(final)=11.807 | 4586.5 samples/s | 71.7 steps/s
[Step=13150 Epoch=125.3] | Loss=0.00080 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=11.807 | 2809.8 samples/s | 43.9 steps/s
[Step=13200 Epoch=125.8] | Loss=0.00074 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=11.807 | 4519.3 samples/s | 70.6 steps/s
[Step=13250 Epoch=126.3] | Loss=0.00069 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=11.808 | 2920.8 samples/s | 45.6 steps/s
[Step=13300 Epoch=126.8] | Loss=0.00065 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=11.808 | 4486.9 samples/s | 70.1 steps/s
[Step=13350 Epoch=127.2] | Loss=0.00061 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=11.808 | 2830.5 samples/s | 44.2 steps/s
[Step=13400 Epoch=127.7] | Loss=0.00058 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=11.809 | 4513.4 samples/s | 70.5 steps/s
[Step=13450 Epoch=128.2] | Loss=0.00055 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=11.809 | 2821.9 samples/s | 44.1 steps/s
[Step=13500 Epoch=128.7] | Loss=0.00052 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=11.809 | 4539.1 samples/s | 70.9 steps/s
[Step=13550 Epoch=129.1] | Loss=0.00050 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.190 | L2-Norm(final)=11.809 | 7378.9 samples/s | 115.3 steps/s
[Step=13600 Epoch=129.6] | Loss=0.00047 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=11.810 | 2291.2 samples/s | 35.8 steps/s
[Step=13650 Epoch=130.1] | Loss=0.00045 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=11.810 | 6686.1 samples/s | 104.5 steps/s
[Step=13700 Epoch=130.6] | Loss=0.00043 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=11.810 | 2388.7 samples/s | 37.3 steps/s
[Step=13750 Epoch=131.0] | Loss=0.00042 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.119 | L2-Norm(final)=11.811 | 6027.7 samples/s | 94.2 steps/s
[Step=13800 Epoch=131.5] | Loss=0.00040 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.101 | L2-Norm(final)=11.811 | 2212.0 samples/s | 34.6 steps/s
[Step=13850 Epoch=132.0] | Loss=0.00039 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.083 | L2-Norm(final)=11.811 | 5694.8 samples/s | 89.0 steps/s
[Step=13900 Epoch=132.5] | Loss=0.00037 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.066 | L2-Norm(final)=11.811 | 2540.2 samples/s | 39.7 steps/s
[Step=13950 Epoch=133.0] | Loss=0.00036 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.048 | L2-Norm(final)=11.812 | 5246.7 samples/s | 82.0 steps/s
[Step=14000 Epoch=133.4] | Loss=0.00035 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.030 | L2-Norm(final)=11.812 | 2613.8 samples/s | 40.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step14000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11273 | acc=0.9507 | tpr=0.9625 | fpr=0.0748 | 5983.7 samples/s | 23.4 steps/s
Avg test loss: 0.11998, Avg test acc: 0.94791, Avg tpr: 0.95972, Avg fpr: 0.07807, total FA: 609

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.13107 | acc=0.9480 | tpr=0.9743 | fpr=0.1093 | 6089.2 samples/s | 23.8 steps/s
Avg test loss: 0.13119, Avg test acc: 0.94759, Avg tpr: 0.97395, Avg fpr: 0.11037, total FA: 861

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11141 | acc=0.9500 | tpr=0.9744 | fpr=0.1031 | 6039.2 samples/s | 23.6 steps/s
Avg test loss: 0.11265, Avg test acc: 0.94960, Avg tpr: 0.97319, Avg fpr: 0.10229, total FA: 798

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.11848 | acc=0.9509 | tpr=0.9633 | fpr=0.0758 | 6176.0 samples/s | 24.1 steps/s
Avg test loss: 0.12432, Avg test acc: 0.94859, Avg tpr: 0.96089, Avg fpr: 0.07845, total FA: 612

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.12772 | acc=0.9494 | tpr=0.9683 | fpr=0.0917 | 5755.0 samples/s | 22.5 steps/s
Avg test loss: 0.13083, Avg test acc: 0.94799, Avg tpr: 0.96666, Avg fpr: 0.09306, total FA: 726

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.84244 | acc=0.3015 | tpr=0.0253 | fpr=0.0989 | 5904.3 samples/s | 23.1 steps/s
Avg test loss: 5.84640, Avg test acc: 0.30006, Avg tpr: 0.02465, Avg fpr: 0.09422, total FA: 735

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.57658 | acc=0.3168 | tpr=0.0151 | fpr=0.0280 | 5917.6 samples/s | 23.1 steps/s
Avg test loss: 4.59413, Avg test acc: 0.31293, Avg tpr: 0.01416, Avg fpr: 0.03000, total FA: 234

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.98424 | acc=0.3064 | tpr=0.0122 | fpr=0.0548 | 5974.2 samples/s | 23.3 steps/s
Avg test loss: 4.99808, Avg test acc: 0.30347, Avg tpr: 0.01218, Avg fpr: 0.05589, total FA: 436

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.99720 | acc=0.3095 | tpr=0.0254 | fpr=0.0736 | 5888.4 samples/s | 23.0 steps/s
Avg test loss: 5.01255, Avg test acc: 0.30688, Avg tpr: 0.02425, Avg fpr: 0.07153, total FA: 558

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.58079 | acc=0.3132 | tpr=0.0141 | fpr=0.0374 | 5881.4 samples/s | 23.0 steps/s
Avg test loss: 5.59305, Avg test acc: 0.31064, Avg tpr: 0.01352, Avg fpr: 0.03589, total FA: 280

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.45839 | acc=0.1477 | tpr=0.6726 | fpr=0.8617 | 5926.0 samples/s | 23.1 steps/s
[Step= 100] | Loss=5.44051 | acc=0.1492 | tpr=0.6652 | fpr=0.8605 | 7880.2 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.43446 | acc=0.1506 | tpr=0.6758 | fpr=0.8591 | 8441.6 samples/s | 33.0 steps/s
[Step= 200] | Loss=5.43259 | acc=0.1504 | tpr=0.6776 | fpr=0.8592 | 7939.2 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.43516 | acc=0.1502 | tpr=0.6734 | fpr=0.8593 | 7947.7 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.42985 | acc=0.1502 | tpr=0.6705 | fpr=0.8593 | 8012.6 samples/s | 31.3 steps/s
[Step= 350] | Loss=5.43268 | acc=0.1498 | tpr=0.6688 | fpr=0.8596 | 8026.3 samples/s | 31.4 steps/s
[Step= 400] | Loss=5.43140 | acc=0.1503 | tpr=0.6668 | fpr=0.8591 | 7253.0 samples/s | 28.3 steps/s
[Step= 450] | Loss=5.43488 | acc=0.1498 | tpr=0.6685 | fpr=0.8597 | 8206.8 samples/s | 32.1 steps/s
[Step= 500] | Loss=5.43466 | acc=0.1500 | tpr=0.6727 | fpr=0.8594 | 9183.3 samples/s | 35.9 steps/s
[Step= 550] | Loss=5.43887 | acc=0.1498 | tpr=0.6729 | fpr=0.8597 | 9418.0 samples/s | 36.8 steps/s
Avg test loss: 5.43935, Avg test acc: 0.14978, Avg tpr: 0.67353, Avg fpr: 0.85975, total FA: 119374

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.46272 | acc=0.1280 | tpr=0.7212 | fpr=0.8826 | 6162.0 samples/s | 24.1 steps/s
[Step= 100] | Loss=5.45748 | acc=0.1295 | tpr=0.7228 | fpr=0.8815 | 7371.6 samples/s | 28.8 steps/s
[Step= 150] | Loss=5.45064 | acc=0.1304 | tpr=0.7262 | fpr=0.8806 | 7991.4 samples/s | 31.2 steps/s
[Step= 200] | Loss=5.45087 | acc=0.1305 | tpr=0.7224 | fpr=0.8803 | 7500.3 samples/s | 29.3 steps/s
[Step= 250] | Loss=5.45704 | acc=0.1310 | tpr=0.7197 | fpr=0.8797 | 8381.4 samples/s | 32.7 steps/s
[Step= 300] | Loss=5.45000 | acc=0.1308 | tpr=0.7142 | fpr=0.8798 | 7935.1 samples/s | 31.0 steps/s
[Step= 350] | Loss=5.45818 | acc=0.1305 | tpr=0.7132 | fpr=0.8801 | 7874.6 samples/s | 30.8 steps/s
[Step= 400] | Loss=5.45665 | acc=0.1307 | tpr=0.7101 | fpr=0.8799 | 8231.1 samples/s | 32.2 steps/s
[Step= 450] | Loss=5.46020 | acc=0.1302 | tpr=0.7118 | fpr=0.8803 | 7985.1 samples/s | 31.2 steps/s
[Step= 500] | Loss=5.46152 | acc=0.1301 | tpr=0.7106 | fpr=0.8804 | 8216.7 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.46629 | acc=0.1301 | tpr=0.7119 | fpr=0.8805 | 11285.1 samples/s | 44.1 steps/s
Avg test loss: 5.46721, Avg test acc: 0.12994, Avg tpr: 0.71276, Avg fpr: 0.88065, total FA: 122277

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.75191 | acc=0.1116 | tpr=0.7522 | fpr=0.9000 | 5886.4 samples/s | 23.0 steps/s
[Step= 100] | Loss=5.73705 | acc=0.1121 | tpr=0.7527 | fpr=0.8998 | 7916.4 samples/s | 30.9 steps/s
[Step= 150] | Loss=5.73246 | acc=0.1138 | tpr=0.7493 | fpr=0.8979 | 8220.2 samples/s | 32.1 steps/s
[Step= 200] | Loss=5.72792 | acc=0.1140 | tpr=0.7410 | fpr=0.8974 | 7975.4 samples/s | 31.2 steps/s
[Step= 250] | Loss=5.73226 | acc=0.1143 | tpr=0.7406 | fpr=0.8971 | 8399.4 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.73034 | acc=0.1139 | tpr=0.7382 | fpr=0.8974 | 8071.3 samples/s | 31.5 steps/s
[Step= 350] | Loss=5.73647 | acc=0.1137 | tpr=0.7389 | fpr=0.8976 | 8075.4 samples/s | 31.5 steps/s
[Step= 400] | Loss=5.73395 | acc=0.1139 | tpr=0.7412 | fpr=0.8975 | 8216.2 samples/s | 32.1 steps/s
[Step= 450] | Loss=5.73875 | acc=0.1132 | tpr=0.7444 | fpr=0.8982 | 7968.2 samples/s | 31.1 steps/s
[Step= 500] | Loss=5.73693 | acc=0.1131 | tpr=0.7449 | fpr=0.8983 | 7569.0 samples/s | 29.6 steps/s
[Step= 550] | Loss=5.74165 | acc=0.1132 | tpr=0.7441 | fpr=0.8983 | 10308.3 samples/s | 40.3 steps/s
Avg test loss: 5.74189, Avg test acc: 0.11305, Avg tpr: 0.74445, Avg fpr: 0.89843, total FA: 124745

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.66530 | acc=0.1398 | tpr=0.7257 | fpr=0.8707 | 6071.4 samples/s | 23.7 steps/s
[Step= 100] | Loss=5.64256 | acc=0.1419 | tpr=0.7079 | fpr=0.8686 | 7365.1 samples/s | 28.8 steps/s
[Step= 150] | Loss=5.63596 | acc=0.1435 | tpr=0.7161 | fpr=0.8670 | 8031.8 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.63561 | acc=0.1438 | tpr=0.7137 | fpr=0.8665 | 7705.3 samples/s | 30.1 steps/s
[Step= 250] | Loss=5.63499 | acc=0.1436 | tpr=0.7135 | fpr=0.8668 | 7840.5 samples/s | 30.6 steps/s
[Step= 300] | Loss=5.62631 | acc=0.1437 | tpr=0.7091 | fpr=0.8666 | 8614.2 samples/s | 33.6 steps/s
[Step= 350] | Loss=5.63170 | acc=0.1434 | tpr=0.7082 | fpr=0.8669 | 8679.8 samples/s | 33.9 steps/s
[Step= 400] | Loss=5.63056 | acc=0.1439 | tpr=0.7068 | fpr=0.8663 | 8162.0 samples/s | 31.9 steps/s
[Step= 450] | Loss=5.63572 | acc=0.1435 | tpr=0.7103 | fpr=0.8668 | 7882.8 samples/s | 30.8 steps/s
[Step= 500] | Loss=5.63601 | acc=0.1436 | tpr=0.7115 | fpr=0.8667 | 7345.8 samples/s | 28.7 steps/s
[Step= 550] | Loss=5.64309 | acc=0.1436 | tpr=0.7127 | fpr=0.8668 | 11530.5 samples/s | 45.0 steps/s
Avg test loss: 5.64422, Avg test acc: 0.14350, Avg tpr: 0.71355, Avg fpr: 0.86686, total FA: 120362

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.71595 | acc=0.1283 | tpr=0.6681 | fpr=0.8814 | 6103.3 samples/s | 23.8 steps/s
[Step= 100] | Loss=5.70721 | acc=0.1320 | tpr=0.6439 | fpr=0.8776 | 7797.6 samples/s | 30.5 steps/s
[Step= 150] | Loss=5.70269 | acc=0.1347 | tpr=0.6556 | fpr=0.8748 | 8047.6 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.70622 | acc=0.1352 | tpr=0.6590 | fpr=0.8744 | 8509.3 samples/s | 33.2 steps/s
[Step= 250] | Loss=5.71006 | acc=0.1350 | tpr=0.6559 | fpr=0.8745 | 7786.4 samples/s | 30.4 steps/s
[Step= 300] | Loss=5.70384 | acc=0.1352 | tpr=0.6575 | fpr=0.8743 | 8292.6 samples/s | 32.4 steps/s
[Step= 350] | Loss=5.71223 | acc=0.1349 | tpr=0.6537 | fpr=0.8745 | 8105.6 samples/s | 31.7 steps/s
[Step= 400] | Loss=5.71195 | acc=0.1351 | tpr=0.6510 | fpr=0.8743 | 7621.6 samples/s | 29.8 steps/s
[Step= 450] | Loss=5.71734 | acc=0.1344 | tpr=0.6534 | fpr=0.8750 | 8032.6 samples/s | 31.4 steps/s
[Step= 500] | Loss=5.71594 | acc=0.1345 | tpr=0.6551 | fpr=0.8749 | 8114.5 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.71995 | acc=0.1347 | tpr=0.6578 | fpr=0.8748 | 9702.0 samples/s | 37.9 steps/s
Avg test loss: 5.72078, Avg test acc: 0.13471, Avg tpr: 0.65887, Avg fpr: 0.87482, total FA: 121467

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19730 | acc=0.9588 | tpr=0.9336 | fpr=0.0407 | 5946.6 samples/s | 23.2 steps/s
[Step= 100] | Loss=0.20484 | acc=0.9570 | tpr=0.9467 | fpr=0.0429 | 7671.8 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.20778 | acc=0.9558 | tpr=0.9452 | fpr=0.0440 | 7992.7 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.20646 | acc=0.9564 | tpr=0.9530 | fpr=0.0435 | 8195.0 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.20597 | acc=0.9562 | tpr=0.9476 | fpr=0.0437 | 7960.7 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.20970 | acc=0.9556 | tpr=0.9455 | fpr=0.0442 | 7976.7 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.21014 | acc=0.9558 | tpr=0.9455 | fpr=0.0440 | 8252.8 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.21010 | acc=0.9556 | tpr=0.9420 | fpr=0.0441 | 7941.4 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.21443 | acc=0.9551 | tpr=0.9396 | fpr=0.0446 | 7872.6 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.21437 | acc=0.9552 | tpr=0.9419 | fpr=0.0446 | 8054.6 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.21283 | acc=0.9554 | tpr=0.9415 | fpr=0.0444 | 10618.1 samples/s | 41.5 steps/s
Avg test loss: 0.21251, Avg test acc: 0.95542, Avg tpr: 0.94136, Avg fpr: 0.04433, total FA: 6155

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13867 | acc=0.9647 | tpr=0.8673 | fpr=0.0336 | 5959.2 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.14296 | acc=0.9641 | tpr=0.8955 | fpr=0.0347 | 7656.1 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.14474 | acc=0.9630 | tpr=0.9049 | fpr=0.0359 | 7862.4 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.14340 | acc=0.9630 | tpr=0.9038 | fpr=0.0359 | 7482.7 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.14370 | acc=0.9630 | tpr=0.9013 | fpr=0.0358 | 8439.0 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.14778 | acc=0.9623 | tpr=0.8960 | fpr=0.0365 | 8298.3 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.14751 | acc=0.9623 | tpr=0.8992 | fpr=0.0365 | 7858.7 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.14730 | acc=0.9623 | tpr=0.8972 | fpr=0.0366 | 7036.1 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.14931 | acc=0.9618 | tpr=0.8953 | fpr=0.0370 | 8287.4 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.14909 | acc=0.9617 | tpr=0.8965 | fpr=0.0371 | 8449.7 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.14810 | acc=0.9618 | tpr=0.8930 | fpr=0.0369 | 12151.7 samples/s | 47.5 steps/s
Avg test loss: 0.14788, Avg test acc: 0.96184, Avg tpr: 0.89303, Avg fpr: 0.03691, total FA: 5125

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.25385 | acc=0.9466 | tpr=0.9248 | fpr=0.0530 | 6121.0 samples/s | 23.9 steps/s
[Step= 100] | Loss=0.26008 | acc=0.9452 | tpr=0.9382 | fpr=0.0547 | 7320.2 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.26604 | acc=0.9441 | tpr=0.9352 | fpr=0.0558 | 8416.6 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.26450 | acc=0.9441 | tpr=0.9399 | fpr=0.0558 | 8300.8 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.26540 | acc=0.9443 | tpr=0.9380 | fpr=0.0556 | 7877.2 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.26842 | acc=0.9440 | tpr=0.9360 | fpr=0.0559 | 7707.6 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.26699 | acc=0.9442 | tpr=0.9368 | fpr=0.0556 | 7728.5 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.26679 | acc=0.9439 | tpr=0.9322 | fpr=0.0558 | 7884.6 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.27091 | acc=0.9434 | tpr=0.9284 | fpr=0.0563 | 8262.4 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.27153 | acc=0.9433 | tpr=0.9304 | fpr=0.0565 | 7732.9 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.27027 | acc=0.9434 | tpr=0.9300 | fpr=0.0563 | 11510.0 samples/s | 45.0 steps/s
Avg test loss: 0.26995, Avg test acc: 0.94346, Avg tpr: 0.92987, Avg fpr: 0.05629, total FA: 7816

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.13405 | acc=0.9674 | tpr=0.8982 | fpr=0.0313 | 5976.5 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.13860 | acc=0.9658 | tpr=0.8998 | fpr=0.0330 | 7420.2 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.14125 | acc=0.9651 | tpr=0.8934 | fpr=0.0336 | 8119.7 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.14106 | acc=0.9651 | tpr=0.9016 | fpr=0.0337 | 7970.4 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.14315 | acc=0.9649 | tpr=0.8996 | fpr=0.0339 | 8572.7 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.14668 | acc=0.9641 | tpr=0.8967 | fpr=0.0347 | 8330.5 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.14632 | acc=0.9639 | tpr=0.8967 | fpr=0.0349 | 8073.8 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.14566 | acc=0.9640 | tpr=0.8955 | fpr=0.0347 | 8015.4 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.14847 | acc=0.9636 | tpr=0.8924 | fpr=0.0351 | 7881.0 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.14793 | acc=0.9635 | tpr=0.8930 | fpr=0.0352 | 7986.6 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.14750 | acc=0.9636 | tpr=0.8934 | fpr=0.0351 | 9739.2 samples/s | 38.0 steps/s
Avg test loss: 0.14733, Avg test acc: 0.96361, Avg tpr: 0.89342, Avg fpr: 0.03512, total FA: 4876

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.22333 | acc=0.9580 | tpr=0.8717 | fpr=0.0404 | 5995.9 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.23169 | acc=0.9576 | tpr=0.9062 | fpr=0.0414 | 7549.7 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.23538 | acc=0.9566 | tpr=0.9135 | fpr=0.0426 | 7808.7 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.23601 | acc=0.9564 | tpr=0.9169 | fpr=0.0428 | 7670.2 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.23678 | acc=0.9565 | tpr=0.9153 | fpr=0.0427 | 8343.7 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.23864 | acc=0.9563 | tpr=0.9105 | fpr=0.0429 | 8511.2 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.23863 | acc=0.9562 | tpr=0.9111 | fpr=0.0430 | 8364.7 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.23835 | acc=0.9559 | tpr=0.9065 | fpr=0.0432 | 7905.3 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.24273 | acc=0.9554 | tpr=0.9026 | fpr=0.0436 | 8007.2 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.24270 | acc=0.9553 | tpr=0.9044 | fpr=0.0438 | 8162.9 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.24118 | acc=0.9554 | tpr=0.9033 | fpr=0.0437 | 9899.9 samples/s | 38.7 steps/s
Avg test loss: 0.24088, Avg test acc: 0.95539, Avg tpr: 0.90293, Avg fpr: 0.04366, total FA: 6062

server round 14/50

clients selected: [1 3 5 7 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=78.1] | Loss=0.02942 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.978 | L2-Norm(final)=11.560 | 7223.8 samples/s | 112.9 steps/s
[Step=16050 Epoch=78.3] | Loss=0.04389 | Reg=0.00143 | acc=0.9531 | L2-Norm=11.979 | L2-Norm(final)=11.581 | 4865.3 samples/s | 76.0 steps/s
[Step=16100 Epoch=78.6] | Loss=0.04281 | Reg=0.00143 | acc=0.9531 | L2-Norm=11.979 | L2-Norm(final)=11.599 | 5529.9 samples/s | 86.4 steps/s
[Step=16150 Epoch=78.8] | Loss=0.04323 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.979 | L2-Norm(final)=11.618 | 5558.5 samples/s | 86.9 steps/s
[Step=16200 Epoch=79.0] | Loss=0.04409 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.979 | L2-Norm(final)=11.633 | 8668.7 samples/s | 135.4 steps/s
[Step=16250 Epoch=79.3] | Loss=0.04459 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.979 | L2-Norm(final)=11.647 | 2651.4 samples/s | 41.4 steps/s
[Step=16300 Epoch=79.5] | Loss=0.04465 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.979 | L2-Norm(final)=11.661 | 5576.9 samples/s | 87.1 steps/s
[Step=16350 Epoch=79.8] | Loss=0.04389 | Reg=0.00143 | acc=0.9531 | L2-Norm=11.979 | L2-Norm(final)=11.675 | 5493.7 samples/s | 85.8 steps/s
[Step=16400 Epoch=80.0] | Loss=0.04409 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.979 | L2-Norm(final)=11.689 | 7904.5 samples/s | 123.5 steps/s
[Step=16450 Epoch=80.3] | Loss=0.04492 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.979 | L2-Norm(final)=11.701 | 2729.9 samples/s | 42.7 steps/s
[Step=16500 Epoch=80.5] | Loss=0.04443 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.979 | L2-Norm(final)=11.714 | 5561.0 samples/s | 86.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=80.5] | Loss=0.05032 | Reg=0.00143 | acc=0.9531 | L2-Norm=11.979 | L2-Norm(final)=11.840 | 7034.1 samples/s | 109.9 steps/s
[Step=16550 Epoch=80.8] | Loss=0.04907 | Reg=0.00146 | acc=0.9219 | L2-Norm=12.101 | L2-Norm(final)=11.842 | 4335.8 samples/s | 67.7 steps/s
[Step=16600 Epoch=81.0] | Loss=0.05055 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.235 | L2-Norm(final)=11.819 | 4777.8 samples/s | 74.7 steps/s
[Step=16650 Epoch=81.2] | Loss=0.05078 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.326 | L2-Norm(final)=11.802 | 4748.5 samples/s | 74.2 steps/s
[Step=16700 Epoch=81.5] | Loss=0.04749 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.394 | L2-Norm(final)=11.791 | 6886.3 samples/s | 107.6 steps/s
[Step=16750 Epoch=81.7] | Loss=0.04240 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.450 | L2-Norm(final)=11.785 | 2486.0 samples/s | 38.8 steps/s
[Step=16800 Epoch=82.0] | Loss=0.03860 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.497 | L2-Norm(final)=11.782 | 4816.3 samples/s | 75.3 steps/s
[Step=16850 Epoch=82.2] | Loss=0.03608 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=11.781 | 4824.1 samples/s | 75.4 steps/s
[Step=16900 Epoch=82.5] | Loss=0.03377 | Reg=0.00158 | acc=0.9531 | L2-Norm=12.572 | L2-Norm(final)=11.780 | 6164.1 samples/s | 96.3 steps/s
[Step=16950 Epoch=82.7] | Loss=0.03127 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=11.780 | 2537.9 samples/s | 39.7 steps/s
[Step=17000 Epoch=83.0] | Loss=0.02924 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.627 | L2-Norm(final)=11.782 | 4731.6 samples/s | 73.9 steps/s
[Step=17050 Epoch=83.2] | Loss=0.02761 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=11.784 | 4808.4 samples/s | 75.1 steps/s
[Step=17100 Epoch=83.4] | Loss=0.02610 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=11.786 | 5857.4 samples/s | 91.5 steps/s
[Step=17150 Epoch=83.7] | Loss=0.02463 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.690 | L2-Norm(final)=11.788 | 2617.3 samples/s | 40.9 steps/s
[Step=17200 Epoch=83.9] | Loss=0.02348 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.707 | L2-Norm(final)=11.790 | 4758.4 samples/s | 74.4 steps/s
[Step=17250 Epoch=84.2] | Loss=0.02269 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.723 | L2-Norm(final)=11.792 | 4728.0 samples/s | 73.9 steps/s
[Step=17300 Epoch=84.4] | Loss=0.02168 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.738 | L2-Norm(final)=11.795 | 5528.1 samples/s | 86.4 steps/s
[Step=17350 Epoch=84.7] | Loss=0.02070 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.751 | L2-Norm(final)=11.797 | 2731.9 samples/s | 42.7 steps/s
[Step=17400 Epoch=84.9] | Loss=0.01984 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.764 | L2-Norm(final)=11.800 | 4683.0 samples/s | 73.2 steps/s
[Step=17450 Epoch=85.1] | Loss=0.01937 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.776 | L2-Norm(final)=11.803 | 4847.1 samples/s | 75.7 steps/s
[Step=17500 Epoch=85.4] | Loss=0.01886 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.787 | L2-Norm(final)=11.805 | 5102.0 samples/s | 79.7 steps/s
[Step=17550 Epoch=85.6] | Loss=0.01825 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.798 | L2-Norm(final)=11.808 | 2795.7 samples/s | 43.7 steps/s
[Step=17600 Epoch=85.9] | Loss=0.01769 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.808 | L2-Norm(final)=11.810 | 4773.9 samples/s | 74.6 steps/s
[Step=17650 Epoch=86.1] | Loss=0.01709 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.818 | L2-Norm(final)=11.813 | 4733.9 samples/s | 74.0 steps/s
[Step=17700 Epoch=86.4] | Loss=0.01665 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.827 | L2-Norm(final)=11.816 | 4882.9 samples/s | 76.3 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01624 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.835 | L2-Norm(final)=11.818 | 2927.5 samples/s | 45.7 steps/s
[Step=17800 Epoch=86.9] | Loss=0.01581 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.843 | L2-Norm(final)=11.820 | 4672.0 samples/s | 73.0 steps/s
[Step=17850 Epoch=87.1] | Loss=0.01538 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.850 | L2-Norm(final)=11.823 | 4756.9 samples/s | 74.3 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01498 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.857 | L2-Norm(final)=11.825 | 4792.0 samples/s | 74.9 steps/s
[Step=17950 Epoch=87.6] | Loss=0.01461 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.863 | L2-Norm(final)=11.827 | 2907.2 samples/s | 45.4 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01422 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.869 | L2-Norm(final)=11.830 | 4800.0 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step18000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.03392 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.978 | L2-Norm(final)=10.778 | 6365.0 samples/s | 99.5 steps/s
[Step=12050 Epoch=58.8] | Loss=0.04814 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.978 | L2-Norm(final)=10.775 | 5161.4 samples/s | 80.6 steps/s
[Step=12100 Epoch=59.0] | Loss=0.04862 | Reg=0.00143 | acc=0.9375 | L2-Norm=11.978 | L2-Norm(final)=10.788 | 5445.3 samples/s | 85.1 steps/s
[Step=12150 Epoch=59.3] | Loss=0.04867 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.978 | L2-Norm(final)=10.806 | 5697.1 samples/s | 89.0 steps/s
[Step=12200 Epoch=59.5] | Loss=0.04795 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.978 | L2-Norm(final)=10.822 | 8432.4 samples/s | 131.8 steps/s
[Step=12250 Epoch=59.7] | Loss=0.04704 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.978 | L2-Norm(final)=10.841 | 2664.4 samples/s | 41.6 steps/s
[Step=12300 Epoch=60.0] | Loss=0.04743 | Reg=0.00143 | acc=0.9531 | L2-Norm=11.978 | L2-Norm(final)=10.862 | 5638.0 samples/s | 88.1 steps/s
[Step=12350 Epoch=60.2] | Loss=0.04733 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.978 | L2-Norm(final)=10.880 | 5483.9 samples/s | 85.7 steps/s
[Step=12400 Epoch=60.5] | Loss=0.04698 | Reg=0.00143 | acc=0.9531 | L2-Norm=11.978 | L2-Norm(final)=10.898 | 7722.4 samples/s | 120.7 steps/s
[Step=12450 Epoch=60.7] | Loss=0.04711 | Reg=0.00143 | acc=0.9531 | L2-Norm=11.978 | L2-Norm(final)=10.915 | 2814.7 samples/s | 44.0 steps/s
[Step=12500 Epoch=61.0] | Loss=0.04697 | Reg=0.00143 | acc=0.9375 | L2-Norm=11.978 | L2-Norm(final)=10.932 | 5502.3 samples/s | 86.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=61.0] | Loss=0.00704 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.978 | L2-Norm(final)=11.102 | 6908.0 samples/s | 107.9 steps/s
[Step=12550 Epoch=61.2] | Loss=0.04782 | Reg=0.00146 | acc=0.9375 | L2-Norm=12.095 | L2-Norm(final)=11.102 | 4404.1 samples/s | 68.8 steps/s
[Step=12600 Epoch=61.4] | Loss=0.04625 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.215 | L2-Norm(final)=11.093 | 4683.7 samples/s | 73.2 steps/s
[Step=12650 Epoch=61.7] | Loss=0.04421 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=11.089 | 4819.4 samples/s | 75.3 steps/s
[Step=12700 Epoch=61.9] | Loss=0.04295 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.378 | L2-Norm(final)=11.083 | 6820.8 samples/s | 106.6 steps/s
[Step=12750 Epoch=62.2] | Loss=0.03846 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.437 | L2-Norm(final)=11.080 | 2502.7 samples/s | 39.1 steps/s
[Step=12800 Epoch=62.4] | Loss=0.03416 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.486 | L2-Norm(final)=11.081 | 4618.6 samples/s | 72.2 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03143 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.527 | L2-Norm(final)=11.083 | 4785.5 samples/s | 74.8 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02956 | Reg=0.00158 | acc=0.9688 | L2-Norm=12.563 | L2-Norm(final)=11.085 | 6247.6 samples/s | 97.6 steps/s
[Step=12950 Epoch=63.2] | Loss=0.02727 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.595 | L2-Norm(final)=11.088 | 2575.4 samples/s | 40.2 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02583 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.625 | L2-Norm(final)=11.091 | 4823.7 samples/s | 75.4 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02440 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.652 | L2-Norm(final)=11.094 | 4707.9 samples/s | 73.6 steps/s
[Step=13100 Epoch=63.9] | Loss=0.02345 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.676 | L2-Norm(final)=11.097 | 5721.6 samples/s | 89.4 steps/s
[Step=13150 Epoch=64.1] | Loss=0.02228 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.699 | L2-Norm(final)=11.100 | 2670.9 samples/s | 41.7 steps/s
[Step=13200 Epoch=64.4] | Loss=0.02125 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.720 | L2-Norm(final)=11.103 | 4790.3 samples/s | 74.8 steps/s
[Step=13250 Epoch=64.6] | Loss=0.02041 | Reg=0.00162 | acc=0.9688 | L2-Norm=12.740 | L2-Norm(final)=11.107 | 4739.3 samples/s | 74.1 steps/s
[Step=13300 Epoch=64.9] | Loss=0.02008 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.759 | L2-Norm(final)=11.110 | 5270.7 samples/s | 82.4 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01939 | Reg=0.00163 | acc=0.9688 | L2-Norm=12.778 | L2-Norm(final)=11.112 | 2785.6 samples/s | 43.5 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01870 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.796 | L2-Norm(final)=11.114 | 4773.2 samples/s | 74.6 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01806 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.812 | L2-Norm(final)=11.117 | 4787.6 samples/s | 74.8 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01752 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.828 | L2-Norm(final)=11.120 | 4879.8 samples/s | 76.2 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01691 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.843 | L2-Norm(final)=11.123 | 2898.2 samples/s | 45.3 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01648 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.857 | L2-Norm(final)=11.126 | 4767.4 samples/s | 74.5 steps/s
[Step=13650 Epoch=66.6] | Loss=0.01600 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.871 | L2-Norm(final)=11.129 | 4770.9 samples/s | 74.5 steps/s
[Step=13700 Epoch=66.8] | Loss=0.01558 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.883 | L2-Norm(final)=11.132 | 4755.0 samples/s | 74.3 steps/s
[Step=13750 Epoch=67.1] | Loss=0.01517 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.895 | L2-Norm(final)=11.135 | 2952.8 samples/s | 46.1 steps/s
[Step=13800 Epoch=67.3] | Loss=0.01479 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.906 | L2-Norm(final)=11.138 | 4758.9 samples/s | 74.4 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01441 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.917 | L2-Norm(final)=11.141 | 4801.6 samples/s | 75.0 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01401 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.926 | L2-Norm(final)=11.144 | 4739.7 samples/s | 74.1 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01371 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.935 | L2-Norm(final)=11.147 | 2960.4 samples/s | 46.3 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01336 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.944 | L2-Norm(final)=11.149 | 4739.9 samples/s | 74.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step14000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=189.5] | Loss=0.00124 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.978 | L2-Norm(final)=15.578 | 6600.0 samples/s | 103.1 steps/s
[Step=20050 Epoch=190.0] | Loss=0.00183 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.974 | L2-Norm(final)=15.594 | 4718.1 samples/s | 73.7 steps/s
[Step=20100 Epoch=190.5] | Loss=0.00153 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.974 | L2-Norm(final)=15.613 | 8223.3 samples/s | 128.5 steps/s
[Step=20150 Epoch=190.9] | Loss=0.00137 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=15.633 | 2565.4 samples/s | 40.1 steps/s
[Step=20200 Epoch=191.4] | Loss=0.00145 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=15.652 | 7243.3 samples/s | 113.2 steps/s
[Step=20250 Epoch=191.9] | Loss=0.00132 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=15.669 | 2680.2 samples/s | 41.9 steps/s
[Step=20300 Epoch=192.4] | Loss=0.00142 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=15.685 | 6502.8 samples/s | 101.6 steps/s
[Step=20350 Epoch=192.8] | Loss=0.00140 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=15.701 | 2818.2 samples/s | 44.0 steps/s
[Step=20400 Epoch=193.3] | Loss=0.00140 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=15.719 | 5850.0 samples/s | 91.4 steps/s
[Step=20450 Epoch=193.8] | Loss=0.00145 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=15.735 | 2936.5 samples/s | 45.9 steps/s
[Step=20500 Epoch=194.3] | Loss=0.00143 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=15.750 | 5403.9 samples/s | 84.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=194.3] | Loss=0.00019 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=15.900 | 7512.3 samples/s | 117.4 steps/s
[Step=20550 Epoch=194.7] | Loss=0.00174 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.985 | L2-Norm(final)=15.907 | 3970.3 samples/s | 62.0 steps/s
[Step=20600 Epoch=195.2] | Loss=0.00676 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.096 | L2-Norm(final)=15.889 | 6483.2 samples/s | 101.3 steps/s
[Step=20650 Epoch=195.7] | Loss=0.00817 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=15.863 | 2378.9 samples/s | 37.2 steps/s
[Step=20700 Epoch=196.2] | Loss=0.00682 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.312 | L2-Norm(final)=15.843 | 6003.3 samples/s | 93.8 steps/s
[Step=20750 Epoch=196.6] | Loss=0.00549 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.358 | L2-Norm(final)=15.830 | 2471.3 samples/s | 38.6 steps/s
[Step=20800 Epoch=197.1] | Loss=0.00458 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.384 | L2-Norm(final)=15.822 | 5440.5 samples/s | 85.0 steps/s
[Step=20850 Epoch=197.6] | Loss=0.00393 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=15.817 | 2601.2 samples/s | 40.6 steps/s
[Step=20900 Epoch=198.0] | Loss=0.00344 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.405 | L2-Norm(final)=15.813 | 4965.3 samples/s | 77.6 steps/s
[Step=20950 Epoch=198.5] | Loss=0.00306 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.408 | L2-Norm(final)=15.810 | 2676.8 samples/s | 41.8 steps/s
[Step=21000 Epoch=199.0] | Loss=0.00275 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.407 | L2-Norm(final)=15.808 | 4676.5 samples/s | 73.1 steps/s
[Step=21050 Epoch=199.5] | Loss=0.00250 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.404 | L2-Norm(final)=15.806 | 2805.8 samples/s | 43.8 steps/s
[Step=21100 Epoch=199.9] | Loss=0.00230 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.399 | L2-Norm(final)=15.804 | 4548.8 samples/s | 71.1 steps/s
[Step=21150 Epoch=200.4] | Loss=0.00212 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.393 | L2-Norm(final)=15.803 | 2867.4 samples/s | 44.8 steps/s
[Step=21200 Epoch=200.9] | Loss=0.00197 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.387 | L2-Norm(final)=15.802 | 4518.4 samples/s | 70.6 steps/s
[Step=21250 Epoch=201.4] | Loss=0.00184 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.379 | L2-Norm(final)=15.801 | 2846.9 samples/s | 44.5 steps/s
[Step=21300 Epoch=201.8] | Loss=0.00172 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=15.801 | 4526.1 samples/s | 70.7 steps/s
[Step=21350 Epoch=202.3] | Loss=0.00162 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.363 | L2-Norm(final)=15.800 | 2994.2 samples/s | 46.8 steps/s
[Step=21400 Epoch=202.8] | Loss=0.00153 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.354 | L2-Norm(final)=15.800 | 4256.6 samples/s | 66.5 steps/s
[Step=21450 Epoch=203.3] | Loss=0.00145 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.345 | L2-Norm(final)=15.799 | 6650.0 samples/s | 103.9 steps/s
[Step=21500 Epoch=203.7] | Loss=0.00138 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=15.799 | 2349.5 samples/s | 36.7 steps/s
[Step=21550 Epoch=204.2] | Loss=0.00131 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=15.799 | 6215.3 samples/s | 97.1 steps/s
[Step=21600 Epoch=204.7] | Loss=0.00126 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=15.799 | 2444.9 samples/s | 38.2 steps/s
[Step=21650 Epoch=205.2] | Loss=0.00120 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=15.799 | 5558.2 samples/s | 86.8 steps/s
[Step=21700 Epoch=205.6] | Loss=0.00115 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=15.799 | 2559.0 samples/s | 40.0 steps/s
[Step=21750 Epoch=206.1] | Loss=0.00110 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=15.799 | 5120.4 samples/s | 80.0 steps/s
[Step=21800 Epoch=206.6] | Loss=0.00106 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.277 | L2-Norm(final)=15.799 | 2662.7 samples/s | 41.6 steps/s
[Step=21850 Epoch=207.0] | Loss=0.00102 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.267 | L2-Norm(final)=15.799 | 4706.4 samples/s | 73.5 steps/s
[Step=21900 Epoch=207.5] | Loss=0.00099 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=15.799 | 2777.7 samples/s | 43.4 steps/s
[Step=21950 Epoch=208.0] | Loss=0.00095 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.246 | L2-Norm(final)=15.800 | 4556.6 samples/s | 71.2 steps/s
[Step=22000 Epoch=208.5] | Loss=0.00092 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=15.800 | 2870.0 samples/s | 44.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step22000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=95.5] | Loss=0.00316 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.978 | L2-Norm(final)=9.383 | 6929.1 samples/s | 108.3 steps/s
[Step=10050 Epoch=96.0] | Loss=0.00444 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=9.429 | 4607.2 samples/s | 72.0 steps/s
[Step=10100 Epoch=96.4] | Loss=0.00420 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=9.477 | 8430.8 samples/s | 131.7 steps/s
[Step=10150 Epoch=96.9] | Loss=0.00432 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=9.517 | 2553.0 samples/s | 39.9 steps/s
[Step=10200 Epoch=97.4] | Loss=0.00408 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=9.558 | 7493.7 samples/s | 117.1 steps/s
[Step=10250 Epoch=97.9] | Loss=0.00388 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=9.599 | 2641.6 samples/s | 41.3 steps/s
[Step=10300 Epoch=98.4] | Loss=0.00397 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=9.638 | 6896.6 samples/s | 107.8 steps/s
[Step=10350 Epoch=98.8] | Loss=0.00398 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=9.678 | 2739.4 samples/s | 42.8 steps/s
[Step=10400 Epoch=99.3] | Loss=0.00394 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=9.716 | 6316.0 samples/s | 98.7 steps/s
[Step=10450 Epoch=99.8] | Loss=0.00392 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=9.753 | 2890.4 samples/s | 45.2 steps/s
[Step=10500 Epoch=100.3] | Loss=0.00381 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=9.789 | 5653.7 samples/s | 88.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=100.3] | Loss=0.00077 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=10.150 | 6502.0 samples/s | 101.6 steps/s
[Step=10550 Epoch=100.7] | Loss=0.00565 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.063 | L2-Norm(final)=10.164 | 4224.7 samples/s | 66.0 steps/s
[Step=10600 Epoch=101.2] | Loss=0.00692 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=10.142 | 6696.6 samples/s | 104.6 steps/s
[Step=10650 Epoch=101.7] | Loss=0.00473 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=10.132 | 2370.6 samples/s | 37.0 steps/s
[Step=10700 Epoch=102.2] | Loss=0.00388 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.307 | L2-Norm(final)=10.128 | 6166.5 samples/s | 96.4 steps/s
[Step=10750 Epoch=102.7] | Loss=0.00313 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.321 | L2-Norm(final)=10.125 | 2493.6 samples/s | 39.0 steps/s
[Step=10800 Epoch=103.1] | Loss=0.00261 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.327 | L2-Norm(final)=10.123 | 5542.2 samples/s | 86.6 steps/s
[Step=10850 Epoch=103.6] | Loss=0.00224 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=10.121 | 2570.6 samples/s | 40.2 steps/s
[Step=10900 Epoch=104.1] | Loss=0.00196 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.321 | L2-Norm(final)=10.120 | 5112.7 samples/s | 79.9 steps/s
[Step=10950 Epoch=104.6] | Loss=0.00174 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=10.120 | 2627.2 samples/s | 41.1 steps/s
[Step=11000 Epoch=105.0] | Loss=0.00157 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.305 | L2-Norm(final)=10.119 | 4953.8 samples/s | 77.4 steps/s
[Step=11050 Epoch=105.5] | Loss=0.00143 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.295 | L2-Norm(final)=10.119 | 2731.3 samples/s | 42.7 steps/s
[Step=11100 Epoch=106.0] | Loss=0.00131 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=10.119 | 4566.4 samples/s | 71.4 steps/s
[Step=11150 Epoch=106.5] | Loss=0.00121 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.272 | L2-Norm(final)=10.119 | 2801.3 samples/s | 43.8 steps/s
[Step=11200 Epoch=107.0] | Loss=0.00112 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=10.119 | 4522.1 samples/s | 70.7 steps/s
[Step=11250 Epoch=107.4] | Loss=0.00105 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.247 | L2-Norm(final)=10.119 | 2851.6 samples/s | 44.6 steps/s
[Step=11300 Epoch=107.9] | Loss=0.00098 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.234 | L2-Norm(final)=10.119 | 4523.8 samples/s | 70.7 steps/s
[Step=11350 Epoch=108.4] | Loss=0.00092 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.221 | L2-Norm(final)=10.119 | 2853.0 samples/s | 44.6 steps/s
[Step=11400 Epoch=108.9] | Loss=0.00087 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.207 | L2-Norm(final)=10.119 | 4583.1 samples/s | 71.6 steps/s
[Step=11450 Epoch=109.3] | Loss=0.00083 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.194 | L2-Norm(final)=10.119 | 2821.9 samples/s | 44.1 steps/s
[Step=11500 Epoch=109.8] | Loss=0.00079 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=10.119 | 4576.3 samples/s | 71.5 steps/s
[Step=11550 Epoch=110.3] | Loss=0.00075 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=10.119 | 7299.3 samples/s | 114.1 steps/s
[Step=11600 Epoch=110.8] | Loss=0.00071 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=10.119 | 2310.3 samples/s | 36.1 steps/s
[Step=11650 Epoch=111.3] | Loss=0.00068 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=10.119 | 6578.4 samples/s | 102.8 steps/s
[Step=11700 Epoch=111.7] | Loss=0.00066 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.125 | L2-Norm(final)=10.119 | 2366.8 samples/s | 37.0 steps/s
[Step=11750 Epoch=112.2] | Loss=0.00063 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.111 | L2-Norm(final)=10.119 | 6151.0 samples/s | 96.1 steps/s
[Step=11800 Epoch=112.7] | Loss=0.00060 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.097 | L2-Norm(final)=10.119 | 2444.7 samples/s | 38.2 steps/s
[Step=11850 Epoch=113.2] | Loss=0.00058 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.083 | L2-Norm(final)=10.120 | 5728.0 samples/s | 89.5 steps/s
[Step=11900 Epoch=113.6] | Loss=0.00056 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.069 | L2-Norm(final)=10.120 | 2520.0 samples/s | 39.4 steps/s
[Step=11950 Epoch=114.1] | Loss=0.00054 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.055 | L2-Norm(final)=10.120 | 5318.4 samples/s | 83.1 steps/s
[Step=12000 Epoch=114.6] | Loss=0.00052 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.041 | L2-Norm(final)=10.120 | 2659.2 samples/s | 41.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step12000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=150.8] | Loss=0.01128 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.978 | L2-Norm(final)=12.726 | 7430.4 samples/s | 116.1 steps/s
[Step=16050 Epoch=151.2] | Loss=0.00722 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.974 | L2-Norm(final)=12.731 | 4367.2 samples/s | 68.2 steps/s
[Step=16100 Epoch=151.7] | Loss=0.00694 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=12.753 | 8189.2 samples/s | 128.0 steps/s
[Step=16150 Epoch=152.2] | Loss=0.00681 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.973 | L2-Norm(final)=12.773 | 2609.7 samples/s | 40.8 steps/s
[Step=16200 Epoch=152.7] | Loss=0.00645 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.973 | L2-Norm(final)=12.790 | 6926.0 samples/s | 108.2 steps/s
[Step=16250 Epoch=153.1] | Loss=0.00667 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=12.809 | 2755.6 samples/s | 43.1 steps/s
[Step=16300 Epoch=153.6] | Loss=0.00652 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=12.828 | 6069.8 samples/s | 94.8 steps/s
[Step=16350 Epoch=154.1] | Loss=0.00631 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.973 | L2-Norm(final)=12.846 | 2900.1 samples/s | 45.3 steps/s
[Step=16400 Epoch=154.5] | Loss=0.00632 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=12.863 | 5429.4 samples/s | 84.8 steps/s
[Step=16450 Epoch=155.0] | Loss=0.00643 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=12.880 | 3032.5 samples/s | 47.4 steps/s
[Step=16500 Epoch=155.5] | Loss=0.00634 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.973 | L2-Norm(final)=12.897 | 5408.5 samples/s | 84.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=155.5] | Loss=0.00396 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=13.064 | 7508.0 samples/s | 117.3 steps/s
[Step=16550 Epoch=155.9] | Loss=0.01112 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=13.054 | 3941.4 samples/s | 61.6 steps/s
[Step=16600 Epoch=156.4] | Loss=0.01034 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=13.023 | 6382.3 samples/s | 99.7 steps/s
[Step=16650 Epoch=156.9] | Loss=0.00697 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.393 | L2-Norm(final)=13.016 | 2397.7 samples/s | 37.5 steps/s
[Step=16700 Epoch=157.4] | Loss=0.00525 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.414 | L2-Norm(final)=13.015 | 5818.1 samples/s | 90.9 steps/s
[Step=16750 Epoch=157.8] | Loss=0.00437 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=13.014 | 2518.7 samples/s | 39.4 steps/s
[Step=16800 Epoch=158.3] | Loss=0.00365 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.417 | L2-Norm(final)=13.015 | 5233.9 samples/s | 81.8 steps/s
[Step=16850 Epoch=158.8] | Loss=0.00313 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.411 | L2-Norm(final)=13.016 | 2631.6 samples/s | 41.1 steps/s
[Step=16900 Epoch=159.2] | Loss=0.00274 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.401 | L2-Norm(final)=13.017 | 4784.4 samples/s | 74.8 steps/s
[Step=16950 Epoch=159.7] | Loss=0.00244 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.388 | L2-Norm(final)=13.018 | 2742.4 samples/s | 42.8 steps/s
[Step=17000 Epoch=160.2] | Loss=0.00220 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.375 | L2-Norm(final)=13.019 | 4553.4 samples/s | 71.1 steps/s
[Step=17050 Epoch=160.7] | Loss=0.00200 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.361 | L2-Norm(final)=13.020 | 2838.7 samples/s | 44.4 steps/s
[Step=17100 Epoch=161.1] | Loss=0.00183 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.346 | L2-Norm(final)=13.020 | 4573.6 samples/s | 71.5 steps/s
[Step=17150 Epoch=161.6] | Loss=0.00169 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.330 | L2-Norm(final)=13.021 | 2830.0 samples/s | 44.2 steps/s
[Step=17200 Epoch=162.1] | Loss=0.00157 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=13.022 | 4517.9 samples/s | 70.6 steps/s
[Step=17250 Epoch=162.5] | Loss=0.00147 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=13.023 | 3133.1 samples/s | 49.0 steps/s
[Step=17300 Epoch=163.0] | Loss=0.00138 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=13.023 | 4017.6 samples/s | 62.8 steps/s
[Step=17350 Epoch=163.5] | Loss=0.00130 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=13.024 | 6619.7 samples/s | 103.4 steps/s
[Step=17400 Epoch=164.0] | Loss=0.00122 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=13.025 | 2377.3 samples/s | 37.1 steps/s
[Step=17450 Epoch=164.4] | Loss=0.00116 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=13.025 | 5930.1 samples/s | 92.7 steps/s
[Step=17500 Epoch=164.9] | Loss=0.00110 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.220 | L2-Norm(final)=13.026 | 2484.0 samples/s | 38.8 steps/s
[Step=17550 Epoch=165.4] | Loss=0.00105 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.204 | L2-Norm(final)=13.026 | 5356.1 samples/s | 83.7 steps/s
[Step=17600 Epoch=165.8] | Loss=0.00100 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.188 | L2-Norm(final)=13.027 | 2648.6 samples/s | 41.4 steps/s
[Step=17650 Epoch=166.3] | Loss=0.00096 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=13.028 | 4775.4 samples/s | 74.6 steps/s
[Step=17700 Epoch=166.8] | Loss=0.00092 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=13.028 | 2747.0 samples/s | 42.9 steps/s
[Step=17750 Epoch=167.3] | Loss=0.00088 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=13.029 | 4550.3 samples/s | 71.1 steps/s
[Step=17800 Epoch=167.7] | Loss=0.00085 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.124 | L2-Norm(final)=13.029 | 2855.2 samples/s | 44.6 steps/s
[Step=17850 Epoch=168.2] | Loss=0.00082 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.109 | L2-Norm(final)=13.030 | 4486.1 samples/s | 70.1 steps/s
[Step=17900 Epoch=168.7] | Loss=0.00079 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.093 | L2-Norm(final)=13.030 | 2878.0 samples/s | 45.0 steps/s
[Step=17950 Epoch=169.1] | Loss=0.00076 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.077 | L2-Norm(final)=13.031 | 4500.6 samples/s | 70.3 steps/s
[Step=18000 Epoch=169.6] | Loss=0.00074 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.061 | L2-Norm(final)=13.031 | 2939.6 samples/s | 45.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step18000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11273 | acc=0.9507 | tpr=0.9625 | fpr=0.0748 | 5742.5 samples/s | 22.4 steps/s
Avg test loss: 0.11998, Avg test acc: 0.94791, Avg tpr: 0.95972, Avg fpr: 0.07807, total FA: 609

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.12992 | acc=0.9505 | tpr=0.9716 | fpr=0.0951 | 6111.0 samples/s | 23.9 steps/s
Avg test loss: 0.13197, Avg test acc: 0.95020, Avg tpr: 0.97045, Avg fpr: 0.09435, total FA: 736

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11141 | acc=0.9500 | tpr=0.9744 | fpr=0.1031 | 6136.0 samples/s | 24.0 steps/s
Avg test loss: 0.11265, Avg test acc: 0.94960, Avg tpr: 0.97319, Avg fpr: 0.10229, total FA: 798

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.12008 | acc=0.9510 | tpr=0.9687 | fpr=0.0875 | 6140.4 samples/s | 24.0 steps/s
Avg test loss: 0.12713, Avg test acc: 0.94968, Avg tpr: 0.96835, Avg fpr: 0.09140, total FA: 713

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.12772 | acc=0.9494 | tpr=0.9683 | fpr=0.0917 | 5915.6 samples/s | 23.1 steps/s
Avg test loss: 0.13083, Avg test acc: 0.94799, Avg tpr: 0.96666, Avg fpr: 0.09306, total FA: 726

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.15449 | acc=0.3098 | tpr=0.0090 | fpr=0.0369 | 5892.2 samples/s | 23.0 steps/s
Avg test loss: 7.16150, Avg test acc: 0.30603, Avg tpr: 0.00851, Avg fpr: 0.03961, total FA: 309

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.57658 | acc=0.3168 | tpr=0.0151 | fpr=0.0280 | 5947.5 samples/s | 23.2 steps/s
Avg test loss: 4.59413, Avg test acc: 0.31293, Avg tpr: 0.01416, Avg fpr: 0.03000, total FA: 234

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.65481 | acc=0.3073 | tpr=0.0073 | fpr=0.0411 | 5858.3 samples/s | 22.9 steps/s
Avg test loss: 5.66506, Avg test acc: 0.30503, Avg tpr: 0.00740, Avg fpr: 0.04038, total FA: 315

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.97906 | acc=0.3002 | tpr=0.0314 | fpr=0.1160 | 5937.9 samples/s | 23.2 steps/s
Avg test loss: 4.98694, Avg test acc: 0.29718, Avg tpr: 0.03002, Avg fpr: 0.11524, total FA: 899

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.58079 | acc=0.3132 | tpr=0.0141 | fpr=0.0374 | 5932.2 samples/s | 23.2 steps/s
Avg test loss: 5.59305, Avg test acc: 0.31064, Avg tpr: 0.01352, Avg fpr: 0.03589, total FA: 280

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.45839 | acc=0.1477 | tpr=0.6726 | fpr=0.8617 | 5992.9 samples/s | 23.4 steps/s
[Step= 100] | Loss=5.44051 | acc=0.1492 | tpr=0.6652 | fpr=0.8605 | 7988.7 samples/s | 31.2 steps/s
[Step= 150] | Loss=5.43446 | acc=0.1506 | tpr=0.6758 | fpr=0.8591 | 7985.7 samples/s | 31.2 steps/s
[Step= 200] | Loss=5.43259 | acc=0.1504 | tpr=0.6776 | fpr=0.8592 | 8354.7 samples/s | 32.6 steps/s
[Step= 250] | Loss=5.43516 | acc=0.1502 | tpr=0.6734 | fpr=0.8593 | 7613.3 samples/s | 29.7 steps/s
[Step= 300] | Loss=5.42985 | acc=0.1502 | tpr=0.6705 | fpr=0.8593 | 8125.4 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.43268 | acc=0.1498 | tpr=0.6688 | fpr=0.8596 | 8446.7 samples/s | 33.0 steps/s
[Step= 400] | Loss=5.43140 | acc=0.1503 | tpr=0.6668 | fpr=0.8591 | 7910.1 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.43488 | acc=0.1498 | tpr=0.6685 | fpr=0.8597 | 8118.2 samples/s | 31.7 steps/s
[Step= 500] | Loss=5.43466 | acc=0.1500 | tpr=0.6727 | fpr=0.8594 | 8077.8 samples/s | 31.6 steps/s
[Step= 550] | Loss=5.43887 | acc=0.1498 | tpr=0.6729 | fpr=0.8597 | 9662.5 samples/s | 37.7 steps/s
Avg test loss: 5.43935, Avg test acc: 0.14978, Avg tpr: 0.67353, Avg fpr: 0.85975, total FA: 119374

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.70692 | acc=0.1313 | tpr=0.7035 | fpr=0.8790 | 5823.9 samples/s | 22.7 steps/s
[Step= 100] | Loss=5.70035 | acc=0.1330 | tpr=0.7058 | fpr=0.8777 | 7753.1 samples/s | 30.3 steps/s
[Step= 150] | Loss=5.70125 | acc=0.1351 | tpr=0.7075 | fpr=0.8754 | 8607.7 samples/s | 33.6 steps/s
[Step= 200] | Loss=5.70410 | acc=0.1349 | tpr=0.6940 | fpr=0.8753 | 7859.7 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.71064 | acc=0.1348 | tpr=0.6838 | fpr=0.8752 | 8422.0 samples/s | 32.9 steps/s
[Step= 300] | Loss=5.70839 | acc=0.1344 | tpr=0.6807 | fpr=0.8756 | 8380.6 samples/s | 32.7 steps/s
[Step= 350] | Loss=5.72029 | acc=0.1337 | tpr=0.6813 | fpr=0.8763 | 7967.9 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.71941 | acc=0.1341 | tpr=0.6854 | fpr=0.8759 | 7681.8 samples/s | 30.0 steps/s
[Step= 450] | Loss=5.72421 | acc=0.1336 | tpr=0.6874 | fpr=0.8765 | 7909.1 samples/s | 30.9 steps/s
[Step= 500] | Loss=5.72476 | acc=0.1335 | tpr=0.6899 | fpr=0.8765 | 8130.9 samples/s | 31.8 steps/s
[Step= 550] | Loss=5.72880 | acc=0.1335 | tpr=0.6912 | fpr=0.8766 | 9953.4 samples/s | 38.9 steps/s
Avg test loss: 5.72976, Avg test acc: 0.13345, Avg tpr: 0.69216, Avg fpr: 0.87671, total FA: 121729

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.75191 | acc=0.1116 | tpr=0.7522 | fpr=0.9000 | 6125.4 samples/s | 23.9 steps/s
[Step= 100] | Loss=5.73705 | acc=0.1121 | tpr=0.7527 | fpr=0.8998 | 7736.8 samples/s | 30.2 steps/s
[Step= 150] | Loss=5.73246 | acc=0.1138 | tpr=0.7493 | fpr=0.8979 | 8390.4 samples/s | 32.8 steps/s
[Step= 200] | Loss=5.72792 | acc=0.1140 | tpr=0.7410 | fpr=0.8974 | 8190.2 samples/s | 32.0 steps/s
[Step= 250] | Loss=5.73226 | acc=0.1143 | tpr=0.7406 | fpr=0.8971 | 7816.7 samples/s | 30.5 steps/s
[Step= 300] | Loss=5.73034 | acc=0.1139 | tpr=0.7382 | fpr=0.8974 | 7836.4 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.73647 | acc=0.1137 | tpr=0.7389 | fpr=0.8976 | 7958.3 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.73395 | acc=0.1139 | tpr=0.7412 | fpr=0.8975 | 8497.5 samples/s | 33.2 steps/s
[Step= 450] | Loss=5.73875 | acc=0.1132 | tpr=0.7444 | fpr=0.8982 | 8252.4 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.73693 | acc=0.1131 | tpr=0.7449 | fpr=0.8983 | 7785.7 samples/s | 30.4 steps/s
[Step= 550] | Loss=5.74165 | acc=0.1132 | tpr=0.7441 | fpr=0.8983 | 9391.2 samples/s | 36.7 steps/s
Avg test loss: 5.74189, Avg test acc: 0.11305, Avg tpr: 0.74445, Avg fpr: 0.89843, total FA: 124745

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.01035 | acc=0.1305 | tpr=0.7301 | fpr=0.8802 | 6231.9 samples/s | 24.3 steps/s
[Step= 100] | Loss=5.99061 | acc=0.1322 | tpr=0.7100 | fpr=0.8786 | 7486.5 samples/s | 29.2 steps/s
[Step= 150] | Loss=5.97906 | acc=0.1351 | tpr=0.7133 | fpr=0.8756 | 8115.7 samples/s | 31.7 steps/s
[Step= 200] | Loss=5.97501 | acc=0.1353 | tpr=0.7126 | fpr=0.8753 | 7419.8 samples/s | 29.0 steps/s
[Step= 250] | Loss=5.97333 | acc=0.1347 | tpr=0.7057 | fpr=0.8757 | 7811.9 samples/s | 30.5 steps/s
[Step= 300] | Loss=5.96523 | acc=0.1349 | tpr=0.7055 | fpr=0.8755 | 8131.9 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.97038 | acc=0.1345 | tpr=0.7063 | fpr=0.8759 | 8226.4 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.96859 | acc=0.1346 | tpr=0.7051 | fpr=0.8758 | 8197.0 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.97323 | acc=0.1343 | tpr=0.7064 | fpr=0.8761 | 8111.5 samples/s | 31.7 steps/s
[Step= 500] | Loss=5.97352 | acc=0.1341 | tpr=0.7066 | fpr=0.8763 | 8156.0 samples/s | 31.9 steps/s
[Step= 550] | Loss=5.97898 | acc=0.1341 | tpr=0.7051 | fpr=0.8762 | 10308.7 samples/s | 40.3 steps/s
Avg test loss: 5.98002, Avg test acc: 0.13411, Avg tpr: 0.70602, Avg fpr: 0.87628, total FA: 121670

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.71595 | acc=0.1283 | tpr=0.6681 | fpr=0.8814 | 5791.8 samples/s | 22.6 steps/s
[Step= 100] | Loss=5.70721 | acc=0.1320 | tpr=0.6439 | fpr=0.8776 | 7918.4 samples/s | 30.9 steps/s
[Step= 150] | Loss=5.70269 | acc=0.1347 | tpr=0.6556 | fpr=0.8748 | 8724.8 samples/s | 34.1 steps/s
[Step= 200] | Loss=5.70622 | acc=0.1352 | tpr=0.6590 | fpr=0.8744 | 8079.5 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.71006 | acc=0.1350 | tpr=0.6559 | fpr=0.8745 | 8154.2 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.70384 | acc=0.1352 | tpr=0.6575 | fpr=0.8743 | 7449.2 samples/s | 29.1 steps/s
[Step= 350] | Loss=5.71223 | acc=0.1349 | tpr=0.6537 | fpr=0.8745 | 8703.1 samples/s | 34.0 steps/s
[Step= 400] | Loss=5.71195 | acc=0.1351 | tpr=0.6510 | fpr=0.8743 | 7925.9 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.71734 | acc=0.1344 | tpr=0.6534 | fpr=0.8750 | 8164.9 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.71594 | acc=0.1345 | tpr=0.6551 | fpr=0.8749 | 7655.7 samples/s | 29.9 steps/s
[Step= 550] | Loss=5.71995 | acc=0.1347 | tpr=0.6578 | fpr=0.8748 | 9906.3 samples/s | 38.7 steps/s
Avg test loss: 5.72078, Avg test acc: 0.13471, Avg tpr: 0.65887, Avg fpr: 0.87482, total FA: 121467

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.18943 | acc=0.9525 | tpr=0.9071 | fpr=0.0467 | 5970.5 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.19304 | acc=0.9521 | tpr=0.9275 | fpr=0.0474 | 7893.7 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.19503 | acc=0.9515 | tpr=0.9352 | fpr=0.0482 | 6725.5 samples/s | 26.3 steps/s
[Step= 200] | Loss=0.19250 | acc=0.9521 | tpr=0.9377 | fpr=0.0477 | 8431.4 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.19253 | acc=0.9521 | tpr=0.9354 | fpr=0.0476 | 8244.5 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.19437 | acc=0.9516 | tpr=0.9338 | fpr=0.0480 | 8346.6 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.19363 | acc=0.9518 | tpr=0.9336 | fpr=0.0478 | 8019.9 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.19407 | acc=0.9515 | tpr=0.9305 | fpr=0.0481 | 8274.6 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.19716 | acc=0.9511 | tpr=0.9275 | fpr=0.0485 | 8190.4 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.19726 | acc=0.9509 | tpr=0.9295 | fpr=0.0487 | 8083.7 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.19607 | acc=0.9511 | tpr=0.9280 | fpr=0.0485 | 10816.3 samples/s | 42.3 steps/s
Avg test loss: 0.19587, Avg test acc: 0.95114, Avg tpr: 0.92789, Avg fpr: 0.04844, total FA: 6726

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13867 | acc=0.9647 | tpr=0.8673 | fpr=0.0336 | 6162.9 samples/s | 24.1 steps/s
[Step= 100] | Loss=0.14296 | acc=0.9641 | tpr=0.8955 | fpr=0.0347 | 8067.7 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.14474 | acc=0.9630 | tpr=0.9049 | fpr=0.0359 | 7774.8 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.14340 | acc=0.9630 | tpr=0.9038 | fpr=0.0359 | 7942.3 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.14370 | acc=0.9630 | tpr=0.9013 | fpr=0.0358 | 8262.7 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.14778 | acc=0.9623 | tpr=0.8960 | fpr=0.0365 | 7937.2 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.14751 | acc=0.9623 | tpr=0.8992 | fpr=0.0365 | 7630.2 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.14730 | acc=0.9623 | tpr=0.8972 | fpr=0.0366 | 8631.7 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.14931 | acc=0.9618 | tpr=0.8953 | fpr=0.0370 | 8483.2 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.14909 | acc=0.9617 | tpr=0.8965 | fpr=0.0371 | 8003.0 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.14810 | acc=0.9618 | tpr=0.8930 | fpr=0.0369 | 8905.4 samples/s | 34.8 steps/s
Avg test loss: 0.14788, Avg test acc: 0.96184, Avg tpr: 0.89303, Avg fpr: 0.03691, total FA: 5125

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26399 | acc=0.9546 | tpr=0.9248 | fpr=0.0449 | 6045.1 samples/s | 23.6 steps/s
[Step= 100] | Loss=0.27226 | acc=0.9533 | tpr=0.9424 | fpr=0.0465 | 7939.7 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.27629 | acc=0.9519 | tpr=0.9380 | fpr=0.0479 | 8144.1 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.27617 | acc=0.9521 | tpr=0.9377 | fpr=0.0476 | 7810.0 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.27799 | acc=0.9519 | tpr=0.9336 | fpr=0.0478 | 7982.8 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.28179 | acc=0.9515 | tpr=0.9287 | fpr=0.0481 | 8052.8 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.28020 | acc=0.9516 | tpr=0.9311 | fpr=0.0481 | 7979.5 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.28061 | acc=0.9514 | tpr=0.9289 | fpr=0.0482 | 8079.1 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.28367 | acc=0.9509 | tpr=0.9255 | fpr=0.0486 | 7933.6 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.28474 | acc=0.9508 | tpr=0.9264 | fpr=0.0488 | 8211.4 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.28323 | acc=0.9510 | tpr=0.9244 | fpr=0.0486 | 10221.4 samples/s | 39.9 steps/s
Avg test loss: 0.28281, Avg test acc: 0.95099, Avg tpr: 0.92472, Avg fpr: 0.04854, total FA: 6739

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15008 | acc=0.9609 | tpr=0.9159 | fpr=0.0383 | 5964.9 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.15431 | acc=0.9598 | tpr=0.9318 | fpr=0.0397 | 8167.0 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.15512 | acc=0.9588 | tpr=0.9265 | fpr=0.0406 | 8054.6 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.15463 | acc=0.9590 | tpr=0.9322 | fpr=0.0405 | 8037.0 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.15577 | acc=0.9586 | tpr=0.9310 | fpr=0.0409 | 7468.3 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.15776 | acc=0.9584 | tpr=0.9309 | fpr=0.0411 | 8488.3 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.15640 | acc=0.9586 | tpr=0.9330 | fpr=0.0409 | 8222.6 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.15566 | acc=0.9584 | tpr=0.9322 | fpr=0.0411 | 7972.3 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.15851 | acc=0.9580 | tpr=0.9299 | fpr=0.0415 | 8028.8 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.15847 | acc=0.9581 | tpr=0.9330 | fpr=0.0415 | 8002.2 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.15790 | acc=0.9582 | tpr=0.9312 | fpr=0.0413 | 9512.9 samples/s | 37.2 steps/s
Avg test loss: 0.15768, Avg test acc: 0.95830, Avg tpr: 0.93106, Avg fpr: 0.04120, total FA: 5721

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.22333 | acc=0.9580 | tpr=0.8717 | fpr=0.0404 | 5966.6 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.23169 | acc=0.9576 | tpr=0.9062 | fpr=0.0414 | 8019.7 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.23538 | acc=0.9566 | tpr=0.9135 | fpr=0.0426 | 8013.2 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.23601 | acc=0.9564 | tpr=0.9169 | fpr=0.0428 | 8686.2 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.23678 | acc=0.9565 | tpr=0.9153 | fpr=0.0427 | 7566.4 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.23864 | acc=0.9563 | tpr=0.9105 | fpr=0.0429 | 7775.3 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.23863 | acc=0.9562 | tpr=0.9111 | fpr=0.0430 | 8599.8 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.23835 | acc=0.9559 | tpr=0.9065 | fpr=0.0432 | 8043.4 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.24273 | acc=0.9554 | tpr=0.9026 | fpr=0.0436 | 7909.6 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.24270 | acc=0.9553 | tpr=0.9044 | fpr=0.0438 | 8432.4 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.24118 | acc=0.9554 | tpr=0.9033 | fpr=0.0437 | 9216.4 samples/s | 36.0 steps/s
Avg test loss: 0.24088, Avg test acc: 0.95539, Avg tpr: 0.90293, Avg fpr: 0.04366, total FA: 6062

server round 15/50

clients selected: [0 1 3 5 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=68.3] | Loss=0.05925 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.902 | L2-Norm(final)=10.365 | 6804.3 samples/s | 106.3 steps/s
[Step=14050 Epoch=68.5] | Loss=0.05774 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.904 | L2-Norm(final)=10.373 | 5310.0 samples/s | 83.0 steps/s
[Step=14100 Epoch=68.8] | Loss=0.05316 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.905 | L2-Norm(final)=10.389 | 5408.7 samples/s | 84.5 steps/s
[Step=14150 Epoch=69.0] | Loss=0.05244 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.905 | L2-Norm(final)=10.411 | 5662.4 samples/s | 88.5 steps/s
[Step=14200 Epoch=69.2] | Loss=0.05373 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.905 | L2-Norm(final)=10.433 | 8505.4 samples/s | 132.9 steps/s
[Step=14250 Epoch=69.5] | Loss=0.05426 | Reg=0.00142 | acc=0.9531 | L2-Norm=11.905 | L2-Norm(final)=10.454 | 2685.9 samples/s | 42.0 steps/s
[Step=14300 Epoch=69.7] | Loss=0.05399 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.905 | L2-Norm(final)=10.474 | 5566.0 samples/s | 87.0 steps/s
[Step=14350 Epoch=70.0] | Loss=0.05391 | Reg=0.00142 | acc=0.9375 | L2-Norm=11.905 | L2-Norm(final)=10.497 | 5489.1 samples/s | 85.8 steps/s
[Step=14400 Epoch=70.2] | Loss=0.05320 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.905 | L2-Norm(final)=10.520 | 7737.8 samples/s | 120.9 steps/s
[Step=14450 Epoch=70.5] | Loss=0.05280 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.905 | L2-Norm(final)=10.542 | 2775.4 samples/s | 43.4 steps/s
[Step=14500 Epoch=70.7] | Loss=0.05362 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.905 | L2-Norm(final)=10.561 | 5540.0 samples/s | 86.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=70.7] | Loss=0.03417 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.905 | L2-Norm(final)=10.746 | 6556.3 samples/s | 102.4 steps/s
[Step=14550 Epoch=70.9] | Loss=0.05010 | Reg=0.00145 | acc=0.9375 | L2-Norm=12.040 | L2-Norm(final)=10.747 | 4481.6 samples/s | 70.0 steps/s
[Step=14600 Epoch=71.2] | Loss=0.04985 | Reg=0.00148 | acc=0.9531 | L2-Norm=12.169 | L2-Norm(final)=10.736 | 4777.9 samples/s | 74.7 steps/s
[Step=14650 Epoch=71.4] | Loss=0.04968 | Reg=0.00150 | acc=0.9531 | L2-Norm=12.266 | L2-Norm(final)=10.723 | 4762.2 samples/s | 74.4 steps/s
[Step=14700 Epoch=71.7] | Loss=0.04695 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.335 | L2-Norm(final)=10.715 | 6874.1 samples/s | 107.4 steps/s
[Step=14750 Epoch=71.9] | Loss=0.04183 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.394 | L2-Norm(final)=10.712 | 2502.3 samples/s | 39.1 steps/s
[Step=14800 Epoch=72.2] | Loss=0.03760 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.442 | L2-Norm(final)=10.712 | 4813.1 samples/s | 75.2 steps/s
[Step=14850 Epoch=72.4] | Loss=0.03539 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.483 | L2-Norm(final)=10.713 | 4604.5 samples/s | 71.9 steps/s
[Step=14900 Epoch=72.7] | Loss=0.03314 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.521 | L2-Norm(final)=10.715 | 6234.2 samples/s | 97.4 steps/s
[Step=14950 Epoch=72.9] | Loss=0.03040 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.554 | L2-Norm(final)=10.719 | 2585.6 samples/s | 40.4 steps/s
[Step=15000 Epoch=73.1] | Loss=0.02859 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.583 | L2-Norm(final)=10.722 | 4735.1 samples/s | 74.0 steps/s
[Step=15050 Epoch=73.4] | Loss=0.02696 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.607 | L2-Norm(final)=10.725 | 4844.7 samples/s | 75.7 steps/s
[Step=15100 Epoch=73.6] | Loss=0.02609 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=10.727 | 5622.1 samples/s | 87.8 steps/s
[Step=15150 Epoch=73.9] | Loss=0.02475 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.647 | L2-Norm(final)=10.730 | 2664.5 samples/s | 41.6 steps/s
[Step=15200 Epoch=74.1] | Loss=0.02354 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.664 | L2-Norm(final)=10.733 | 4738.7 samples/s | 74.0 steps/s
[Step=15250 Epoch=74.4] | Loss=0.02260 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.680 | L2-Norm(final)=10.736 | 4793.2 samples/s | 74.9 steps/s
[Step=15300 Epoch=74.6] | Loss=0.02176 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.695 | L2-Norm(final)=10.739 | 5256.8 samples/s | 82.1 steps/s
[Step=15350 Epoch=74.8] | Loss=0.02068 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.708 | L2-Norm(final)=10.742 | 2775.5 samples/s | 43.4 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01985 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.721 | L2-Norm(final)=10.745 | 4833.0 samples/s | 75.5 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01921 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.732 | L2-Norm(final)=10.748 | 4730.2 samples/s | 73.9 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01855 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.742 | L2-Norm(final)=10.751 | 4847.9 samples/s | 75.7 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01798 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.752 | L2-Norm(final)=10.754 | 2898.3 samples/s | 45.3 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01745 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.761 | L2-Norm(final)=10.756 | 4733.4 samples/s | 74.0 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01695 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.769 | L2-Norm(final)=10.759 | 4783.8 samples/s | 74.7 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01649 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.776 | L2-Norm(final)=10.761 | 4810.8 samples/s | 75.2 steps/s
[Step=15750 Epoch=76.8] | Loss=0.01606 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.784 | L2-Norm(final)=10.764 | 2963.2 samples/s | 46.3 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01560 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.790 | L2-Norm(final)=10.767 | 4628.7 samples/s | 72.3 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01530 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.797 | L2-Norm(final)=10.770 | 4809.7 samples/s | 75.2 steps/s
[Step=15900 Epoch=77.5] | Loss=0.01490 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.804 | L2-Norm(final)=10.772 | 4785.5 samples/s | 74.8 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01458 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.810 | L2-Norm(final)=10.775 | 2957.8 samples/s | 46.2 steps/s
[Step=16000 Epoch=78.0] | Loss=0.01424 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.816 | L2-Norm(final)=10.777 | 4802.4 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=87.8] | Loss=0.05019 | Reg=0.00142 | acc=0.9531 | L2-Norm=11.902 | L2-Norm(final)=11.905 | 6654.1 samples/s | 104.0 steps/s
[Step=18050 Epoch=88.1] | Loss=0.04731 | Reg=0.00142 | acc=0.9531 | L2-Norm=11.902 | L2-Norm(final)=11.934 | 4876.7 samples/s | 76.2 steps/s
[Step=18100 Epoch=88.3] | Loss=0.04569 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.902 | L2-Norm(final)=11.957 | 5577.4 samples/s | 87.1 steps/s
[Step=18150 Epoch=88.6] | Loss=0.04415 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=11.983 | 5592.2 samples/s | 87.4 steps/s
[Step=18200 Epoch=88.8] | Loss=0.04421 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.902 | L2-Norm(final)=12.011 | 8502.9 samples/s | 132.9 steps/s
[Step=18250 Epoch=89.1] | Loss=0.04469 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.902 | L2-Norm(final)=12.033 | 2724.3 samples/s | 42.6 steps/s
[Step=18300 Epoch=89.3] | Loss=0.04466 | Reg=0.00142 | acc=0.9375 | L2-Norm=11.902 | L2-Norm(final)=12.055 | 5403.3 samples/s | 84.4 steps/s
[Step=18350 Epoch=89.5] | Loss=0.04452 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.902 | L2-Norm(final)=12.077 | 5376.4 samples/s | 84.0 steps/s
[Step=18400 Epoch=89.8] | Loss=0.04458 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.902 | L2-Norm(final)=12.100 | 7931.4 samples/s | 123.9 steps/s
[Step=18450 Epoch=90.0] | Loss=0.04413 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.902 | L2-Norm(final)=12.122 | 2728.9 samples/s | 42.6 steps/s
[Step=18500 Epoch=90.3] | Loss=0.04444 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.902 | L2-Norm(final)=12.143 | 5495.6 samples/s | 85.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=90.3] | Loss=0.02464 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=12.357 | 7245.8 samples/s | 113.2 steps/s
[Step=18550 Epoch=90.5] | Loss=0.04318 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.030 | L2-Norm(final)=12.360 | 4246.9 samples/s | 66.4 steps/s
[Step=18600 Epoch=90.8] | Loss=0.04692 | Reg=0.00148 | acc=0.9531 | L2-Norm=12.156 | L2-Norm(final)=12.339 | 4868.7 samples/s | 76.1 steps/s
[Step=18650 Epoch=91.0] | Loss=0.04588 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=12.327 | 4793.0 samples/s | 74.9 steps/s
[Step=18700 Epoch=91.2] | Loss=0.04433 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.309 | L2-Norm(final)=12.318 | 6801.9 samples/s | 106.3 steps/s
[Step=18750 Epoch=91.5] | Loss=0.03964 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.360 | L2-Norm(final)=12.314 | 2450.5 samples/s | 38.3 steps/s
[Step=18800 Epoch=91.7] | Loss=0.03571 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.401 | L2-Norm(final)=12.313 | 4796.8 samples/s | 74.9 steps/s
[Step=18850 Epoch=92.0] | Loss=0.03349 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.436 | L2-Norm(final)=12.312 | 4723.3 samples/s | 73.8 steps/s
[Step=18900 Epoch=92.2] | Loss=0.03153 | Reg=0.00155 | acc=0.9531 | L2-Norm=12.466 | L2-Norm(final)=12.312 | 6370.9 samples/s | 99.5 steps/s
[Step=18950 Epoch=92.5] | Loss=0.02941 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.493 | L2-Norm(final)=12.312 | 2551.8 samples/s | 39.9 steps/s
[Step=19000 Epoch=92.7] | Loss=0.02741 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.517 | L2-Norm(final)=12.314 | 4745.0 samples/s | 74.1 steps/s
[Step=19050 Epoch=93.0] | Loss=0.02602 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=12.316 | 4740.3 samples/s | 74.1 steps/s
[Step=19100 Epoch=93.2] | Loss=0.02478 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.556 | L2-Norm(final)=12.318 | 5868.6 samples/s | 91.7 steps/s
[Step=19150 Epoch=93.4] | Loss=0.02349 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.573 | L2-Norm(final)=12.320 | 2609.9 samples/s | 40.8 steps/s
[Step=19200 Epoch=93.7] | Loss=0.02231 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.589 | L2-Norm(final)=12.323 | 4788.4 samples/s | 74.8 steps/s
[Step=19250 Epoch=93.9] | Loss=0.02152 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=12.325 | 4807.6 samples/s | 75.1 steps/s
[Step=19300 Epoch=94.2] | Loss=0.02044 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.615 | L2-Norm(final)=12.328 | 5455.7 samples/s | 85.2 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01960 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.627 | L2-Norm(final)=12.331 | 2699.4 samples/s | 42.2 steps/s
[Step=19400 Epoch=94.7] | Loss=0.01868 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.639 | L2-Norm(final)=12.334 | 4722.0 samples/s | 73.8 steps/s
[Step=19450 Epoch=94.9] | Loss=0.01795 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.649 | L2-Norm(final)=12.337 | 4788.8 samples/s | 74.8 steps/s
[Step=19500 Epoch=95.2] | Loss=0.01742 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=12.340 | 5121.1 samples/s | 80.0 steps/s
[Step=19550 Epoch=95.4] | Loss=0.01681 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.667 | L2-Norm(final)=12.343 | 2815.9 samples/s | 44.0 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01622 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=12.346 | 4664.4 samples/s | 72.9 steps/s
[Step=19650 Epoch=95.9] | Loss=0.01577 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=12.349 | 4818.4 samples/s | 75.3 steps/s
[Step=19700 Epoch=96.1] | Loss=0.01532 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.689 | L2-Norm(final)=12.352 | 4833.9 samples/s | 75.5 steps/s
[Step=19750 Epoch=96.4] | Loss=0.01489 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=12.354 | 2902.7 samples/s | 45.4 steps/s
[Step=19800 Epoch=96.6] | Loss=0.01441 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.701 | L2-Norm(final)=12.358 | 4748.8 samples/s | 74.2 steps/s
[Step=19850 Epoch=96.9] | Loss=0.01409 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.707 | L2-Norm(final)=12.361 | 4807.4 samples/s | 75.1 steps/s
[Step=19900 Epoch=97.1] | Loss=0.01380 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.712 | L2-Norm(final)=12.363 | 4742.8 samples/s | 74.1 steps/s
[Step=19950 Epoch=97.3] | Loss=0.01340 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=12.366 | 2922.7 samples/s | 45.7 steps/s
[Step=20000 Epoch=97.6] | Loss=0.01304 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.721 | L2-Norm(final)=12.369 | 4749.5 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step20000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=68.3] | Loss=0.01592 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=11.234 | 7355.9 samples/s | 114.9 steps/s
[Step=14050 Epoch=68.5] | Loss=0.04843 | Reg=0.00142 | acc=0.9375 | L2-Norm=11.902 | L2-Norm(final)=11.250 | 3898.6 samples/s | 60.9 steps/s
[Step=14100 Epoch=68.8] | Loss=0.04538 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.902 | L2-Norm(final)=11.272 | 5644.2 samples/s | 88.2 steps/s
[Step=14150 Epoch=69.0] | Loss=0.04521 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.902 | L2-Norm(final)=11.298 | 5489.1 samples/s | 85.8 steps/s
[Step=14200 Epoch=69.2] | Loss=0.04490 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.902 | L2-Norm(final)=11.323 | 8702.3 samples/s | 136.0 steps/s
[Step=14250 Epoch=69.5] | Loss=0.04465 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.902 | L2-Norm(final)=11.348 | 2687.3 samples/s | 42.0 steps/s
[Step=14300 Epoch=69.7] | Loss=0.04467 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.902 | L2-Norm(final)=11.373 | 5525.7 samples/s | 86.3 steps/s
[Step=14350 Epoch=70.0] | Loss=0.04468 | Reg=0.00142 | acc=0.9531 | L2-Norm=11.902 | L2-Norm(final)=11.395 | 5550.8 samples/s | 86.7 steps/s
[Step=14400 Epoch=70.2] | Loss=0.04428 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.902 | L2-Norm(final)=11.416 | 7757.5 samples/s | 121.2 steps/s
[Step=14450 Epoch=70.5] | Loss=0.04385 | Reg=0.00142 | acc=0.9531 | L2-Norm=11.902 | L2-Norm(final)=11.438 | 2779.5 samples/s | 43.4 steps/s
[Step=14500 Epoch=70.7] | Loss=0.04398 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.902 | L2-Norm(final)=11.460 | 5656.3 samples/s | 88.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=70.7] | Loss=0.04971 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.902 | L2-Norm(final)=11.674 | 6838.7 samples/s | 106.9 steps/s
[Step=14550 Epoch=71.0] | Loss=0.04810 | Reg=0.00144 | acc=0.9688 | L2-Norm=12.011 | L2-Norm(final)=11.675 | 4450.9 samples/s | 69.5 steps/s
[Step=14600 Epoch=71.2] | Loss=0.04735 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=11.665 | 4692.3 samples/s | 73.3 steps/s
[Step=14650 Epoch=71.4] | Loss=0.04556 | Reg=0.00150 | acc=0.9531 | L2-Norm=12.235 | L2-Norm(final)=11.656 | 4751.9 samples/s | 74.2 steps/s
[Step=14700 Epoch=71.7] | Loss=0.04322 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.313 | L2-Norm(final)=11.651 | 6885.1 samples/s | 107.6 steps/s
[Step=14750 Epoch=71.9] | Loss=0.03852 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.381 | L2-Norm(final)=11.649 | 2476.8 samples/s | 38.7 steps/s
[Step=14800 Epoch=72.2] | Loss=0.03500 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.436 | L2-Norm(final)=11.649 | 4738.2 samples/s | 74.0 steps/s
[Step=14850 Epoch=72.4] | Loss=0.03307 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.481 | L2-Norm(final)=11.649 | 4776.4 samples/s | 74.6 steps/s
[Step=14900 Epoch=72.7] | Loss=0.03057 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.520 | L2-Norm(final)=11.650 | 6250.4 samples/s | 97.7 steps/s
[Step=14950 Epoch=72.9] | Loss=0.02820 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.554 | L2-Norm(final)=11.651 | 2567.9 samples/s | 40.1 steps/s
[Step=15000 Epoch=73.1] | Loss=0.02647 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.584 | L2-Norm(final)=11.654 | 4816.7 samples/s | 75.3 steps/s
[Step=15050 Epoch=73.4] | Loss=0.02472 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.611 | L2-Norm(final)=11.657 | 4792.0 samples/s | 74.9 steps/s
[Step=15100 Epoch=73.6] | Loss=0.02346 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.635 | L2-Norm(final)=11.659 | 5650.7 samples/s | 88.3 steps/s
[Step=15150 Epoch=73.9] | Loss=0.02242 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.655 | L2-Norm(final)=11.661 | 2663.4 samples/s | 41.6 steps/s
[Step=15200 Epoch=74.1] | Loss=0.02132 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.674 | L2-Norm(final)=11.663 | 4771.6 samples/s | 74.6 steps/s
[Step=15250 Epoch=74.4] | Loss=0.02045 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.691 | L2-Norm(final)=11.666 | 4727.2 samples/s | 73.9 steps/s
[Step=15300 Epoch=74.6] | Loss=0.01961 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.707 | L2-Norm(final)=11.668 | 5321.1 samples/s | 83.1 steps/s
[Step=15350 Epoch=74.9] | Loss=0.01875 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.722 | L2-Norm(final)=11.671 | 2781.8 samples/s | 43.5 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01808 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.735 | L2-Norm(final)=11.673 | 4746.5 samples/s | 74.2 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01740 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.747 | L2-Norm(final)=11.676 | 4779.5 samples/s | 74.7 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01686 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=11.678 | 4930.7 samples/s | 77.0 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01628 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.768 | L2-Norm(final)=11.681 | 2906.2 samples/s | 45.4 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01574 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.778 | L2-Norm(final)=11.683 | 4725.0 samples/s | 73.8 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01521 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=11.686 | 4781.5 samples/s | 74.7 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01471 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=11.688 | 4865.0 samples/s | 76.0 steps/s
[Step=15750 Epoch=76.8] | Loss=0.01435 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.803 | L2-Norm(final)=11.691 | 2905.0 samples/s | 45.4 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01398 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.810 | L2-Norm(final)=11.693 | 4705.4 samples/s | 73.5 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01359 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.818 | L2-Norm(final)=11.695 | 4760.5 samples/s | 74.4 steps/s
[Step=15900 Epoch=77.5] | Loss=0.01335 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.825 | L2-Norm(final)=11.697 | 4767.6 samples/s | 74.5 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01314 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.832 | L2-Norm(final)=11.699 | 2949.5 samples/s | 46.1 steps/s
[Step=16000 Epoch=78.0] | Loss=0.01284 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.838 | L2-Norm(final)=11.701 | 4747.8 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=208.5] | Loss=0.00012 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=15.810 | 5972.4 samples/s | 93.3 steps/s
[Step=22050 Epoch=208.9] | Loss=0.00110 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.899 | L2-Norm(final)=15.819 | 4715.5 samples/s | 73.7 steps/s
[Step=22100 Epoch=209.4] | Loss=0.00131 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=15.831 | 8144.3 samples/s | 127.3 steps/s
[Step=22150 Epoch=209.9] | Loss=0.00125 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=15.845 | 2540.7 samples/s | 39.7 steps/s
[Step=22200 Epoch=210.4] | Loss=0.00132 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=15.860 | 7317.0 samples/s | 114.3 steps/s
[Step=22250 Epoch=210.8] | Loss=0.00130 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=15.874 | 2706.1 samples/s | 42.3 steps/s
[Step=22300 Epoch=211.3] | Loss=0.00127 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.898 | L2-Norm(final)=15.887 | 6375.4 samples/s | 99.6 steps/s
[Step=22350 Epoch=211.8] | Loss=0.00117 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=15.899 | 2807.2 samples/s | 43.9 steps/s
[Step=22400 Epoch=212.3] | Loss=0.00114 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=15.913 | 5870.3 samples/s | 91.7 steps/s
[Step=22450 Epoch=212.7] | Loss=0.00124 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=15.926 | 2928.9 samples/s | 45.8 steps/s
[Step=22500 Epoch=213.2] | Loss=0.00124 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=15.938 | 5357.4 samples/s | 83.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=213.2] | Loss=0.00095 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=16.061 | 7320.7 samples/s | 114.4 steps/s
[Step=22550 Epoch=213.7] | Loss=0.00027 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.886 | L2-Norm(final)=16.070 | 4069.0 samples/s | 63.6 steps/s
[Step=22600 Epoch=214.2] | Loss=0.00402 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.929 | L2-Norm(final)=16.065 | 6588.9 samples/s | 103.0 steps/s
[Step=22650 Epoch=214.6] | Loss=0.00357 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.025 | L2-Norm(final)=16.048 | 2378.3 samples/s | 37.2 steps/s
[Step=22700 Epoch=215.1] | Loss=0.00288 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.079 | L2-Norm(final)=16.039 | 5912.1 samples/s | 92.4 steps/s
[Step=22750 Epoch=215.6] | Loss=0.00232 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=16.034 | 2510.6 samples/s | 39.2 steps/s
[Step=22800 Epoch=216.0] | Loss=0.00194 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=16.031 | 5292.6 samples/s | 82.7 steps/s
[Step=22850 Epoch=216.5] | Loss=0.00166 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.123 | L2-Norm(final)=16.030 | 2579.0 samples/s | 40.3 steps/s
[Step=22900 Epoch=217.0] | Loss=0.00145 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.123 | L2-Norm(final)=16.029 | 5034.5 samples/s | 78.7 steps/s
[Step=22950 Epoch=217.5] | Loss=0.00129 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.119 | L2-Norm(final)=16.029 | 2690.9 samples/s | 42.0 steps/s
[Step=23000 Epoch=217.9] | Loss=0.00116 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.114 | L2-Norm(final)=16.029 | 4659.0 samples/s | 72.8 steps/s
[Step=23050 Epoch=218.4] | Loss=0.00106 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.107 | L2-Norm(final)=16.029 | 2821.9 samples/s | 44.1 steps/s
[Step=23100 Epoch=218.9] | Loss=0.00097 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.099 | L2-Norm(final)=16.029 | 4481.1 samples/s | 70.0 steps/s
[Step=23150 Epoch=219.4] | Loss=0.00090 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.091 | L2-Norm(final)=16.029 | 2854.2 samples/s | 44.6 steps/s
[Step=23200 Epoch=219.8] | Loss=0.00083 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.082 | L2-Norm(final)=16.029 | 4554.2 samples/s | 71.2 steps/s
[Step=23250 Epoch=220.3] | Loss=0.00078 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.072 | L2-Norm(final)=16.029 | 2840.2 samples/s | 44.4 steps/s
[Step=23300 Epoch=220.8] | Loss=0.00073 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.062 | L2-Norm(final)=16.030 | 4665.7 samples/s | 72.9 steps/s
[Step=23350 Epoch=221.3] | Loss=0.00069 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.052 | L2-Norm(final)=16.030 | 3035.5 samples/s | 47.4 steps/s
[Step=23400 Epoch=221.7] | Loss=0.00065 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.042 | L2-Norm(final)=16.030 | 4164.0 samples/s | 65.1 steps/s
[Step=23450 Epoch=222.2] | Loss=0.00061 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.031 | L2-Norm(final)=16.031 | 6688.1 samples/s | 104.5 steps/s
[Step=23500 Epoch=222.7] | Loss=0.00058 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.021 | L2-Norm(final)=16.031 | 1803.3 samples/s | 28.2 steps/s
[Step=23550 Epoch=223.2] | Loss=0.00056 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.010 | L2-Norm(final)=16.031 | 6180.3 samples/s | 96.6 steps/s
[Step=23600 Epoch=223.6] | Loss=0.00053 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.999 | L2-Norm(final)=16.032 | 2431.0 samples/s | 38.0 steps/s
[Step=23650 Epoch=224.1] | Loss=0.00051 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.988 | L2-Norm(final)=16.032 | 5616.8 samples/s | 87.8 steps/s
[Step=23700 Epoch=224.6] | Loss=0.00049 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.977 | L2-Norm(final)=16.033 | 2567.0 samples/s | 40.1 steps/s
[Step=23750 Epoch=225.1] | Loss=0.00047 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.966 | L2-Norm(final)=16.033 | 5062.0 samples/s | 79.1 steps/s
[Step=23800 Epoch=225.5] | Loss=0.00045 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.955 | L2-Norm(final)=16.033 | 2690.7 samples/s | 42.0 steps/s
[Step=23850 Epoch=226.0] | Loss=0.00043 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.944 | L2-Norm(final)=16.034 | 4661.5 samples/s | 72.8 steps/s
[Step=23900 Epoch=226.5] | Loss=0.00042 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.932 | L2-Norm(final)=16.034 | 2769.8 samples/s | 43.3 steps/s
[Step=23950 Epoch=226.9] | Loss=0.00040 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.921 | L2-Norm(final)=16.035 | 4585.4 samples/s | 71.6 steps/s
[Step=24000 Epoch=227.4] | Loss=0.00039 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.910 | L2-Norm(final)=16.035 | 2870.3 samples/s | 44.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step24000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=133.4] | Loss=0.00063 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=11.820 | 6661.7 samples/s | 104.1 steps/s
[Step=14050 Epoch=133.9] | Loss=0.00764 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.897 | L2-Norm(final)=11.842 | 4747.4 samples/s | 74.2 steps/s
[Step=14100 Epoch=134.4] | Loss=0.00670 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.896 | L2-Norm(final)=11.869 | 8410.8 samples/s | 131.4 steps/s
[Step=14150 Epoch=134.9] | Loss=0.00623 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.896 | L2-Norm(final)=11.894 | 2584.5 samples/s | 40.4 steps/s
[Step=14200 Epoch=135.3] | Loss=0.00626 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.896 | L2-Norm(final)=11.917 | 7338.1 samples/s | 114.7 steps/s
[Step=14250 Epoch=135.8] | Loss=0.00646 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.896 | L2-Norm(final)=11.940 | 2664.8 samples/s | 41.6 steps/s
[Step=14300 Epoch=136.3] | Loss=0.00617 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.896 | L2-Norm(final)=11.962 | 6728.1 samples/s | 105.1 steps/s
[Step=14350 Epoch=136.8] | Loss=0.00613 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.895 | L2-Norm(final)=11.983 | 2769.0 samples/s | 43.3 steps/s
[Step=14400 Epoch=137.2] | Loss=0.00595 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.895 | L2-Norm(final)=12.005 | 6147.3 samples/s | 96.1 steps/s
[Step=14450 Epoch=137.7] | Loss=0.00607 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.895 | L2-Norm(final)=12.026 | 2856.4 samples/s | 44.6 steps/s
[Step=14500 Epoch=138.2] | Loss=0.00599 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.895 | L2-Norm(final)=12.048 | 5707.9 samples/s | 89.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=138.2] | Loss=0.00116 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.895 | L2-Norm(final)=12.266 | 6844.1 samples/s | 106.9 steps/s
[Step=14550 Epoch=138.7] | Loss=0.00585 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.122 | L2-Norm(final)=12.270 | 4108.5 samples/s | 64.2 steps/s
[Step=14600 Epoch=139.2] | Loss=0.00750 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=12.254 | 6708.9 samples/s | 104.8 steps/s
[Step=14650 Epoch=139.6] | Loss=0.00516 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.404 | L2-Norm(final)=12.240 | 2387.0 samples/s | 37.3 steps/s
[Step=14700 Epoch=140.1] | Loss=0.00422 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.442 | L2-Norm(final)=12.234 | 5967.8 samples/s | 93.2 steps/s
[Step=14750 Epoch=140.6] | Loss=0.00339 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=12.231 | 2448.8 samples/s | 38.3 steps/s
[Step=14800 Epoch=141.1] | Loss=0.00283 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.467 | L2-Norm(final)=12.229 | 5686.8 samples/s | 88.9 steps/s
[Step=14850 Epoch=141.5] | Loss=0.00243 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=12.227 | 2541.4 samples/s | 39.7 steps/s
[Step=14900 Epoch=142.0] | Loss=0.00213 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=12.226 | 5270.5 samples/s | 82.4 steps/s
[Step=14950 Epoch=142.5] | Loss=0.00189 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.451 | L2-Norm(final)=12.226 | 2610.4 samples/s | 40.8 steps/s
[Step=15000 Epoch=143.0] | Loss=0.00170 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=12.225 | 4935.2 samples/s | 77.1 steps/s
[Step=15050 Epoch=143.4] | Loss=0.00155 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.429 | L2-Norm(final)=12.225 | 2713.9 samples/s | 42.4 steps/s
[Step=15100 Epoch=143.9] | Loss=0.00142 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=12.225 | 4631.3 samples/s | 72.4 steps/s
[Step=15150 Epoch=144.4] | Loss=0.00131 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.403 | L2-Norm(final)=12.225 | 2787.3 samples/s | 43.6 steps/s
[Step=15200 Epoch=144.9] | Loss=0.00122 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.389 | L2-Norm(final)=12.225 | 4616.8 samples/s | 72.1 steps/s
[Step=15250 Epoch=145.3] | Loss=0.00114 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.375 | L2-Norm(final)=12.225 | 2846.7 samples/s | 44.5 steps/s
[Step=15300 Epoch=145.8] | Loss=0.00107 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.360 | L2-Norm(final)=12.225 | 4583.0 samples/s | 71.6 steps/s
[Step=15350 Epoch=146.3] | Loss=0.00100 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.346 | L2-Norm(final)=12.225 | 2807.8 samples/s | 43.9 steps/s
[Step=15400 Epoch=146.8] | Loss=0.00095 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.331 | L2-Norm(final)=12.225 | 4562.5 samples/s | 71.3 steps/s
[Step=15450 Epoch=147.3] | Loss=0.00090 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=12.225 | 2942.9 samples/s | 46.0 steps/s
[Step=15500 Epoch=147.7] | Loss=0.00085 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=12.225 | 4322.9 samples/s | 67.5 steps/s
[Step=15550 Epoch=148.2] | Loss=0.00081 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=12.225 | 7215.7 samples/s | 112.7 steps/s
[Step=15600 Epoch=148.7] | Loss=0.00078 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.272 | L2-Norm(final)=12.225 | 2304.7 samples/s | 36.0 steps/s
[Step=15650 Epoch=149.2] | Loss=0.00074 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=12.225 | 6464.5 samples/s | 101.0 steps/s
[Step=15700 Epoch=149.6] | Loss=0.00071 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=12.226 | 2377.5 samples/s | 37.1 steps/s
[Step=15750 Epoch=150.1] | Loss=0.00068 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=12.226 | 6105.9 samples/s | 95.4 steps/s
[Step=15800 Epoch=150.6] | Loss=0.00066 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=12.226 | 2461.4 samples/s | 38.5 steps/s
[Step=15850 Epoch=151.1] | Loss=0.00063 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=12.226 | 5630.9 samples/s | 88.0 steps/s
[Step=15900 Epoch=151.5] | Loss=0.00061 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=12.226 | 2495.3 samples/s | 39.0 steps/s
[Step=15950 Epoch=152.0] | Loss=0.00059 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=12.227 | 5283.7 samples/s | 82.6 steps/s
[Step=16000 Epoch=152.5] | Loss=0.00057 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=12.227 | 2612.9 samples/s | 40.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10394 | acc=0.9549 | tpr=0.9707 | fpr=0.0793 | 5815.1 samples/s | 22.7 steps/s
Avg test loss: 0.11508, Avg test acc: 0.95064, Avg tpr: 0.96765, Avg fpr: 0.08678, total FA: 677

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14044 | acc=0.9511 | tpr=0.9787 | fpr=0.1088 | 6132.6 samples/s | 24.0 steps/s
Avg test loss: 0.14300, Avg test acc: 0.95024, Avg tpr: 0.97715, Avg fpr: 0.10896, total FA: 850

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11141 | acc=0.9500 | tpr=0.9744 | fpr=0.1031 | 5682.2 samples/s | 22.2 steps/s
Avg test loss: 0.11265, Avg test acc: 0.94960, Avg tpr: 0.97319, Avg fpr: 0.10229, total FA: 798

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.11742 | acc=0.9525 | tpr=0.9743 | fpr=0.0949 | 6005.5 samples/s | 23.5 steps/s
Avg test loss: 0.12588, Avg test acc: 0.94980, Avg tpr: 0.97278, Avg fpr: 0.10076, total FA: 786

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.12772 | acc=0.9494 | tpr=0.9683 | fpr=0.0917 | 5873.2 samples/s | 22.9 steps/s
Avg test loss: 0.13083, Avg test acc: 0.94799, Avg tpr: 0.96666, Avg fpr: 0.09306, total FA: 726

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.74128 | acc=0.3084 | tpr=0.0262 | fpr=0.0790 | 6027.9 samples/s | 23.5 steps/s
Avg test loss: 5.75130, Avg test acc: 0.30680, Avg tpr: 0.02728, Avg fpr: 0.07845, total FA: 612

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.57658 | acc=0.3168 | tpr=0.0151 | fpr=0.0280 | 5726.0 samples/s | 22.4 steps/s
Avg test loss: 4.59413, Avg test acc: 0.31293, Avg tpr: 0.01416, Avg fpr: 0.03000, total FA: 234

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.65481 | acc=0.3073 | tpr=0.0073 | fpr=0.0411 | 5853.4 samples/s | 22.9 steps/s
Avg test loss: 5.66506, Avg test acc: 0.30503, Avg tpr: 0.00740, Avg fpr: 0.04038, total FA: 315

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.97906 | acc=0.3002 | tpr=0.0314 | fpr=0.1160 | 6069.9 samples/s | 23.7 steps/s
Avg test loss: 4.98694, Avg test acc: 0.29718, Avg tpr: 0.03002, Avg fpr: 0.11524, total FA: 899

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.55627 | acc=0.3090 | tpr=0.0105 | fpr=0.0429 | 6094.6 samples/s | 23.8 steps/s
Avg test loss: 5.57617, Avg test acc: 0.30643, Avg tpr: 0.00950, Avg fpr: 0.04051, total FA: 316

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.96854 | acc=0.1308 | tpr=0.7389 | fpr=0.8801 | 5961.4 samples/s | 23.3 steps/s
[Step= 100] | Loss=5.94230 | acc=0.1333 | tpr=0.7143 | fpr=0.8776 | 8074.3 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.93543 | acc=0.1341 | tpr=0.7262 | fpr=0.8768 | 8120.8 samples/s | 31.7 steps/s
[Step= 200] | Loss=5.92761 | acc=0.1349 | tpr=0.7246 | fpr=0.8758 | 8262.7 samples/s | 32.3 steps/s
[Step= 250] | Loss=5.93450 | acc=0.1348 | tpr=0.7135 | fpr=0.8758 | 6989.5 samples/s | 27.3 steps/s
[Step= 300] | Loss=5.92690 | acc=0.1345 | tpr=0.7127 | fpr=0.8760 | 8515.8 samples/s | 33.3 steps/s
[Step= 350] | Loss=5.93042 | acc=0.1344 | tpr=0.7170 | fpr=0.8762 | 8321.6 samples/s | 32.5 steps/s
[Step= 400] | Loss=5.92806 | acc=0.1347 | tpr=0.7133 | fpr=0.8759 | 8028.7 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.93250 | acc=0.1340 | tpr=0.7162 | fpr=0.8765 | 8491.1 samples/s | 33.2 steps/s
[Step= 500] | Loss=5.93111 | acc=0.1343 | tpr=0.7207 | fpr=0.8763 | 7676.8 samples/s | 30.0 steps/s
[Step= 550] | Loss=5.93290 | acc=0.1343 | tpr=0.7230 | fpr=0.8764 | 10082.0 samples/s | 39.4 steps/s
Avg test loss: 5.93360, Avg test acc: 0.13430, Avg tpr: 0.72385, Avg fpr: 0.87642, total FA: 121689

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.25154 | acc=0.1089 | tpr=0.6903 | fpr=0.9015 | 6068.7 samples/s | 23.7 steps/s
[Step= 100] | Loss=6.23588 | acc=0.1095 | tpr=0.6908 | fpr=0.9013 | 7667.9 samples/s | 30.0 steps/s
[Step= 150] | Loss=6.23114 | acc=0.1105 | tpr=0.7017 | fpr=0.9003 | 8479.6 samples/s | 33.1 steps/s
[Step= 200] | Loss=6.22485 | acc=0.1104 | tpr=0.6951 | fpr=0.9003 | 7154.5 samples/s | 27.9 steps/s
[Step= 250] | Loss=6.23495 | acc=0.1103 | tpr=0.6978 | fpr=0.9004 | 7580.7 samples/s | 29.6 steps/s
[Step= 300] | Loss=6.23039 | acc=0.1105 | tpr=0.6931 | fpr=0.9002 | 8385.5 samples/s | 32.8 steps/s
[Step= 350] | Loss=6.23930 | acc=0.1100 | tpr=0.6944 | fpr=0.9006 | 8241.0 samples/s | 32.2 steps/s
[Step= 400] | Loss=6.23533 | acc=0.1104 | tpr=0.6964 | fpr=0.9002 | 7749.6 samples/s | 30.3 steps/s
[Step= 450] | Loss=6.24038 | acc=0.1098 | tpr=0.6947 | fpr=0.9009 | 8507.5 samples/s | 33.2 steps/s
[Step= 500] | Loss=6.24141 | acc=0.1096 | tpr=0.6952 | fpr=0.9009 | 7964.9 samples/s | 31.1 steps/s
[Step= 550] | Loss=6.24468 | acc=0.1098 | tpr=0.6984 | fpr=0.9009 | 11109.2 samples/s | 43.4 steps/s
Avg test loss: 6.24611, Avg test acc: 0.10972, Avg tpr: 0.69929, Avg fpr: 0.90099, total FA: 125101

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.75191 | acc=0.1116 | tpr=0.7522 | fpr=0.9000 | 5934.8 samples/s | 23.2 steps/s
[Step= 100] | Loss=5.73705 | acc=0.1121 | tpr=0.7527 | fpr=0.8998 | 7826.5 samples/s | 30.6 steps/s
[Step= 150] | Loss=5.73246 | acc=0.1138 | tpr=0.7493 | fpr=0.8979 | 8152.1 samples/s | 31.8 steps/s
[Step= 200] | Loss=5.72792 | acc=0.1140 | tpr=0.7410 | fpr=0.8974 | 8173.2 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.73226 | acc=0.1143 | tpr=0.7406 | fpr=0.8971 | 8456.0 samples/s | 33.0 steps/s
[Step= 300] | Loss=5.73034 | acc=0.1139 | tpr=0.7382 | fpr=0.8974 | 8133.7 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.73647 | acc=0.1137 | tpr=0.7389 | fpr=0.8976 | 7958.8 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.73395 | acc=0.1139 | tpr=0.7412 | fpr=0.8975 | 7921.9 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.73875 | acc=0.1132 | tpr=0.7444 | fpr=0.8982 | 7916.0 samples/s | 30.9 steps/s
[Step= 500] | Loss=5.73693 | acc=0.1131 | tpr=0.7449 | fpr=0.8983 | 7914.8 samples/s | 30.9 steps/s
[Step= 550] | Loss=5.74165 | acc=0.1132 | tpr=0.7441 | fpr=0.8983 | 9795.0 samples/s | 38.3 steps/s
Avg test loss: 5.74189, Avg test acc: 0.11305, Avg tpr: 0.74445, Avg fpr: 0.89843, total FA: 124745

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.84409 | acc=0.1162 | tpr=0.7389 | fpr=0.8950 | 6033.7 samples/s | 23.6 steps/s
[Step= 100] | Loss=5.82377 | acc=0.1178 | tpr=0.7377 | fpr=0.8938 | 7767.9 samples/s | 30.3 steps/s
[Step= 150] | Loss=5.81120 | acc=0.1187 | tpr=0.7349 | fpr=0.8926 | 7355.9 samples/s | 28.7 steps/s
[Step= 200] | Loss=5.80760 | acc=0.1182 | tpr=0.7322 | fpr=0.8930 | 8210.9 samples/s | 32.1 steps/s
[Step= 250] | Loss=5.81016 | acc=0.1176 | tpr=0.7328 | fpr=0.8936 | 8178.0 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.80346 | acc=0.1173 | tpr=0.7316 | fpr=0.8939 | 7489.4 samples/s | 29.3 steps/s
[Step= 350] | Loss=5.81003 | acc=0.1171 | tpr=0.7351 | fpr=0.8941 | 8796.5 samples/s | 34.4 steps/s
[Step= 400] | Loss=5.80717 | acc=0.1174 | tpr=0.7314 | fpr=0.8937 | 8513.3 samples/s | 33.3 steps/s
[Step= 450] | Loss=5.81019 | acc=0.1170 | tpr=0.7342 | fpr=0.8943 | 7688.0 samples/s | 30.0 steps/s
[Step= 500] | Loss=5.81038 | acc=0.1168 | tpr=0.7383 | fpr=0.8944 | 8044.3 samples/s | 31.4 steps/s
[Step= 550] | Loss=5.81421 | acc=0.1169 | tpr=0.7366 | fpr=0.8944 | 10469.3 samples/s | 40.9 steps/s
Avg test loss: 5.81520, Avg test acc: 0.11683, Avg tpr: 0.73732, Avg fpr: 0.89445, total FA: 124192

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.71595 | acc=0.1283 | tpr=0.6681 | fpr=0.8814 | 5743.0 samples/s | 22.4 steps/s
[Step= 100] | Loss=5.70721 | acc=0.1320 | tpr=0.6439 | fpr=0.8776 | 8217.5 samples/s | 32.1 steps/s
[Step= 150] | Loss=5.70269 | acc=0.1347 | tpr=0.6556 | fpr=0.8748 | 8002.7 samples/s | 31.3 steps/s
[Step= 200] | Loss=5.70622 | acc=0.1352 | tpr=0.6590 | fpr=0.8744 | 8583.8 samples/s | 33.5 steps/s
[Step= 250] | Loss=5.71006 | acc=0.1350 | tpr=0.6559 | fpr=0.8745 | 7868.5 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.70384 | acc=0.1352 | tpr=0.6575 | fpr=0.8743 | 8063.0 samples/s | 31.5 steps/s
[Step= 350] | Loss=5.71223 | acc=0.1349 | tpr=0.6537 | fpr=0.8745 | 7895.2 samples/s | 30.8 steps/s
[Step= 400] | Loss=5.71195 | acc=0.1351 | tpr=0.6510 | fpr=0.8743 | 8314.0 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.71734 | acc=0.1344 | tpr=0.6534 | fpr=0.8750 | 7691.7 samples/s | 30.0 steps/s
[Step= 500] | Loss=5.71594 | acc=0.1345 | tpr=0.6551 | fpr=0.8749 | 7961.5 samples/s | 31.1 steps/s
[Step= 550] | Loss=5.71995 | acc=0.1347 | tpr=0.6578 | fpr=0.8748 | 10022.9 samples/s | 39.2 steps/s
Avg test loss: 5.72078, Avg test acc: 0.13471, Avg tpr: 0.65887, Avg fpr: 0.87482, total FA: 121467

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.16632 | acc=0.9596 | tpr=0.9248 | fpr=0.0398 | 6013.4 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.16921 | acc=0.9587 | tpr=0.9403 | fpr=0.0410 | 7214.5 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.17095 | acc=0.9579 | tpr=0.9395 | fpr=0.0417 | 8308.0 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.17026 | acc=0.9576 | tpr=0.9443 | fpr=0.0421 | 7808.2 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.17037 | acc=0.9574 | tpr=0.9406 | fpr=0.0423 | 8424.2 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.17238 | acc=0.9567 | tpr=0.9382 | fpr=0.0430 | 8330.5 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.17190 | acc=0.9569 | tpr=0.9374 | fpr=0.0428 | 7883.8 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.17185 | acc=0.9567 | tpr=0.9344 | fpr=0.0429 | 7964.1 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.17546 | acc=0.9562 | tpr=0.9338 | fpr=0.0434 | 7861.9 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.17556 | acc=0.9560 | tpr=0.9361 | fpr=0.0436 | 7624.5 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.17466 | acc=0.9562 | tpr=0.9359 | fpr=0.0434 | 11617.3 samples/s | 45.4 steps/s
Avg test loss: 0.17437, Avg test acc: 0.95625, Avg tpr: 0.93621, Avg fpr: 0.04339, total FA: 6024

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13867 | acc=0.9647 | tpr=0.8673 | fpr=0.0336 | 6039.5 samples/s | 23.6 steps/s
[Step= 100] | Loss=0.14296 | acc=0.9641 | tpr=0.8955 | fpr=0.0347 | 7815.6 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.14474 | acc=0.9630 | tpr=0.9049 | fpr=0.0359 | 8057.1 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.14340 | acc=0.9630 | tpr=0.9038 | fpr=0.0359 | 8135.5 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.14370 | acc=0.9630 | tpr=0.9013 | fpr=0.0358 | 7610.0 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.14778 | acc=0.9623 | tpr=0.8960 | fpr=0.0365 | 8324.8 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.14751 | acc=0.9623 | tpr=0.8992 | fpr=0.0365 | 8108.4 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.14730 | acc=0.9623 | tpr=0.8972 | fpr=0.0366 | 8010.2 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.14931 | acc=0.9618 | tpr=0.8953 | fpr=0.0370 | 8517.6 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.14909 | acc=0.9617 | tpr=0.8965 | fpr=0.0371 | 7544.3 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.14810 | acc=0.9618 | tpr=0.8930 | fpr=0.0369 | 10658.9 samples/s | 41.6 steps/s
Avg test loss: 0.14788, Avg test acc: 0.96184, Avg tpr: 0.89303, Avg fpr: 0.03691, total FA: 5125

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26399 | acc=0.9546 | tpr=0.9248 | fpr=0.0449 | 5958.9 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.27226 | acc=0.9533 | tpr=0.9424 | fpr=0.0465 | 7979.5 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.27629 | acc=0.9519 | tpr=0.9380 | fpr=0.0479 | 7504.2 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.27617 | acc=0.9521 | tpr=0.9377 | fpr=0.0476 | 8282.2 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.27799 | acc=0.9519 | tpr=0.9336 | fpr=0.0478 | 7933.4 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.28179 | acc=0.9515 | tpr=0.9287 | fpr=0.0481 | 8348.2 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.28020 | acc=0.9516 | tpr=0.9311 | fpr=0.0481 | 8074.4 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.28061 | acc=0.9514 | tpr=0.9289 | fpr=0.0482 | 8325.0 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.28367 | acc=0.9509 | tpr=0.9255 | fpr=0.0486 | 8225.8 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.28474 | acc=0.9508 | tpr=0.9264 | fpr=0.0488 | 8228.7 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.28323 | acc=0.9510 | tpr=0.9244 | fpr=0.0486 | 9444.9 samples/s | 36.9 steps/s
Avg test loss: 0.28281, Avg test acc: 0.95099, Avg tpr: 0.92472, Avg fpr: 0.04854, total FA: 6739

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15008 | acc=0.9609 | tpr=0.9159 | fpr=0.0383 | 5988.9 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.15431 | acc=0.9598 | tpr=0.9318 | fpr=0.0397 | 7826.8 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.15512 | acc=0.9588 | tpr=0.9265 | fpr=0.0406 | 7598.6 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.15463 | acc=0.9590 | tpr=0.9322 | fpr=0.0405 | 7820.7 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.15577 | acc=0.9586 | tpr=0.9310 | fpr=0.0409 | 8793.4 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.15776 | acc=0.9584 | tpr=0.9309 | fpr=0.0411 | 8045.3 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.15640 | acc=0.9586 | tpr=0.9330 | fpr=0.0409 | 8506.8 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.15566 | acc=0.9584 | tpr=0.9322 | fpr=0.0411 | 7697.2 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.15851 | acc=0.9580 | tpr=0.9299 | fpr=0.0415 | 8636.7 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.15847 | acc=0.9581 | tpr=0.9330 | fpr=0.0415 | 7734.0 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.15790 | acc=0.9582 | tpr=0.9312 | fpr=0.0413 | 10155.7 samples/s | 39.7 steps/s
Avg test loss: 0.15768, Avg test acc: 0.95830, Avg tpr: 0.93106, Avg fpr: 0.04120, total FA: 5721

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.24935 | acc=0.9525 | tpr=0.9071 | fpr=0.0467 | 5831.9 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.26159 | acc=0.9513 | tpr=0.9254 | fpr=0.0482 | 7912.3 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.26923 | acc=0.9499 | tpr=0.9337 | fpr=0.0498 | 7946.0 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.26948 | acc=0.9500 | tpr=0.9322 | fpr=0.0497 | 7787.8 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.27009 | acc=0.9500 | tpr=0.9275 | fpr=0.0495 | 8076.2 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.27327 | acc=0.9498 | tpr=0.9236 | fpr=0.0497 | 7868.6 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.27266 | acc=0.9499 | tpr=0.9236 | fpr=0.0496 | 8212.2 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.27241 | acc=0.9496 | tpr=0.9196 | fpr=0.0499 | 7824.0 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.27611 | acc=0.9491 | tpr=0.9182 | fpr=0.0503 | 7561.6 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.27695 | acc=0.9489 | tpr=0.9176 | fpr=0.0505 | 8421.3 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.27482 | acc=0.9492 | tpr=0.9180 | fpr=0.0502 | 11788.9 samples/s | 46.1 steps/s
Avg test loss: 0.27462, Avg test acc: 0.94923, Avg tpr: 0.91759, Avg fpr: 0.05019, total FA: 6969

server round 16/50

clients selected: [1 3 5 7 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=97.6] | Loss=0.03443 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.829 | L2-Norm(final)=12.455 | 7100.0 samples/s | 110.9 steps/s
[Step=20050 Epoch=97.8] | Loss=0.04014 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.829 | L2-Norm(final)=12.475 | 4996.7 samples/s | 78.1 steps/s
[Step=20100 Epoch=98.1] | Loss=0.04263 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.829 | L2-Norm(final)=12.518 | 5424.8 samples/s | 84.8 steps/s
[Step=20150 Epoch=98.3] | Loss=0.04448 | Reg=0.00140 | acc=0.9375 | L2-Norm=11.829 | L2-Norm(final)=12.555 | 5638.9 samples/s | 88.1 steps/s
[Step=20200 Epoch=98.6] | Loss=0.04413 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.829 | L2-Norm(final)=12.585 | 8656.4 samples/s | 135.3 steps/s
[Step=20250 Epoch=98.8] | Loss=0.04325 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.829 | L2-Norm(final)=12.618 | 2658.4 samples/s | 41.5 steps/s
[Step=20300 Epoch=99.1] | Loss=0.04413 | Reg=0.00140 | acc=0.8906 | L2-Norm=11.829 | L2-Norm(final)=12.649 | 5542.8 samples/s | 86.6 steps/s
[Step=20350 Epoch=99.3] | Loss=0.04400 | Reg=0.00140 | acc=0.9062 | L2-Norm=11.829 | L2-Norm(final)=12.674 | 5514.1 samples/s | 86.2 steps/s
[Step=20400 Epoch=99.5] | Loss=0.04398 | Reg=0.00140 | acc=0.9531 | L2-Norm=11.829 | L2-Norm(final)=12.701 | 7890.1 samples/s | 123.3 steps/s
[Step=20450 Epoch=99.8] | Loss=0.04357 | Reg=0.00140 | acc=0.9531 | L2-Norm=11.829 | L2-Norm(final)=12.728 | 2743.6 samples/s | 42.9 steps/s
[Step=20500 Epoch=100.0] | Loss=0.04360 | Reg=0.00140 | acc=0.9375 | L2-Norm=11.829 | L2-Norm(final)=12.756 | 5632.1 samples/s | 88.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=100.0] | Loss=0.02748 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.829 | L2-Norm(final)=13.038 | 7113.6 samples/s | 111.1 steps/s
[Step=20550 Epoch=100.3] | Loss=0.05469 | Reg=0.00143 | acc=0.9219 | L2-Norm=11.960 | L2-Norm(final)=13.030 | 4338.8 samples/s | 67.8 steps/s
[Step=20600 Epoch=100.5] | Loss=0.05402 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.079 | L2-Norm(final)=13.011 | 4708.0 samples/s | 73.6 steps/s
[Step=20650 Epoch=100.8] | Loss=0.05079 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.165 | L2-Norm(final)=13.000 | 4813.2 samples/s | 75.2 steps/s
[Step=20700 Epoch=101.0] | Loss=0.04611 | Reg=0.00150 | acc=0.9375 | L2-Norm=12.233 | L2-Norm(final)=12.994 | 6855.4 samples/s | 107.1 steps/s
[Step=20750 Epoch=101.3] | Loss=0.04140 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.288 | L2-Norm(final)=12.990 | 2486.7 samples/s | 38.9 steps/s
[Step=20800 Epoch=101.5] | Loss=0.03768 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.333 | L2-Norm(final)=12.987 | 4663.2 samples/s | 72.9 steps/s
[Step=20850 Epoch=101.7] | Loss=0.03449 | Reg=0.00153 | acc=0.9531 | L2-Norm=12.373 | L2-Norm(final)=12.986 | 4832.5 samples/s | 75.5 steps/s
[Step=20900 Epoch=102.0] | Loss=0.03271 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.410 | L2-Norm(final)=12.986 | 6209.7 samples/s | 97.0 steps/s
[Step=20950 Epoch=102.2] | Loss=0.03037 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.442 | L2-Norm(final)=12.987 | 2541.9 samples/s | 39.7 steps/s
[Step=21000 Epoch=102.5] | Loss=0.02829 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.471 | L2-Norm(final)=12.989 | 4706.2 samples/s | 73.5 steps/s
[Step=21050 Epoch=102.7] | Loss=0.02666 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.496 | L2-Norm(final)=12.991 | 4799.6 samples/s | 75.0 steps/s
[Step=21100 Epoch=103.0] | Loss=0.02537 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.518 | L2-Norm(final)=12.993 | 5860.8 samples/s | 91.6 steps/s
[Step=21150 Epoch=103.2] | Loss=0.02426 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.539 | L2-Norm(final)=12.996 | 2645.3 samples/s | 41.3 steps/s
[Step=21200 Epoch=103.4] | Loss=0.02299 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.560 | L2-Norm(final)=12.999 | 4706.8 samples/s | 73.5 steps/s
[Step=21250 Epoch=103.7] | Loss=0.02210 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.579 | L2-Norm(final)=13.001 | 4741.5 samples/s | 74.1 steps/s
[Step=21300 Epoch=103.9] | Loss=0.02113 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.596 | L2-Norm(final)=13.004 | 5470.6 samples/s | 85.5 steps/s
[Step=21350 Epoch=104.2] | Loss=0.02037 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.613 | L2-Norm(final)=13.007 | 2713.8 samples/s | 42.4 steps/s
[Step=21400 Epoch=104.4] | Loss=0.01976 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=13.009 | 4716.4 samples/s | 73.7 steps/s
[Step=21450 Epoch=104.7] | Loss=0.01899 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.642 | L2-Norm(final)=13.012 | 4864.2 samples/s | 76.0 steps/s
[Step=21500 Epoch=104.9] | Loss=0.01839 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.655 | L2-Norm(final)=13.014 | 5086.4 samples/s | 79.5 steps/s
[Step=21550 Epoch=105.2] | Loss=0.01775 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.667 | L2-Norm(final)=13.016 | 2810.3 samples/s | 43.9 steps/s
[Step=21600 Epoch=105.4] | Loss=0.01717 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.678 | L2-Norm(final)=13.018 | 4826.6 samples/s | 75.4 steps/s
[Step=21650 Epoch=105.6] | Loss=0.01663 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.689 | L2-Norm(final)=13.021 | 4672.9 samples/s | 73.0 steps/s
[Step=21700 Epoch=105.9] | Loss=0.01611 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=13.023 | 4850.2 samples/s | 75.8 steps/s
[Step=21750 Epoch=106.1] | Loss=0.01575 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.707 | L2-Norm(final)=13.025 | 2909.8 samples/s | 45.5 steps/s
[Step=21800 Epoch=106.4] | Loss=0.01540 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=13.027 | 4711.1 samples/s | 73.6 steps/s
[Step=21850 Epoch=106.6] | Loss=0.01501 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.725 | L2-Norm(final)=13.029 | 4770.1 samples/s | 74.5 steps/s
[Step=21900 Epoch=106.9] | Loss=0.01469 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.733 | L2-Norm(final)=13.031 | 4721.6 samples/s | 73.8 steps/s
[Step=21950 Epoch=107.1] | Loss=0.01433 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.740 | L2-Norm(final)=13.033 | 2937.1 samples/s | 45.9 steps/s
[Step=22000 Epoch=107.3] | Loss=0.01400 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.747 | L2-Norm(final)=13.035 | 4756.1 samples/s | 74.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step22000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=78.0] | Loss=0.00868 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.829 | L2-Norm(final)=11.759 | 7283.1 samples/s | 113.8 steps/s
[Step=16050 Epoch=78.3] | Loss=0.04524 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.829 | L2-Norm(final)=11.799 | 4906.5 samples/s | 76.7 steps/s
[Step=16100 Epoch=78.5] | Loss=0.04503 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.830 | L2-Norm(final)=11.831 | 5630.8 samples/s | 88.0 steps/s
[Step=16150 Epoch=78.8] | Loss=0.04685 | Reg=0.00140 | acc=0.9531 | L2-Norm=11.830 | L2-Norm(final)=11.860 | 5423.5 samples/s | 84.7 steps/s
[Step=16200 Epoch=79.0] | Loss=0.04626 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.830 | L2-Norm(final)=11.885 | 8676.4 samples/s | 135.6 steps/s
[Step=16250 Epoch=79.2] | Loss=0.04695 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.830 | L2-Norm(final)=11.908 | 2665.2 samples/s | 41.6 steps/s
[Step=16300 Epoch=79.5] | Loss=0.04711 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.830 | L2-Norm(final)=11.933 | 5573.3 samples/s | 87.1 steps/s
[Step=16350 Epoch=79.7] | Loss=0.04715 | Reg=0.00140 | acc=0.9375 | L2-Norm=11.830 | L2-Norm(final)=11.955 | 5494.1 samples/s | 85.8 steps/s
[Step=16400 Epoch=80.0] | Loss=0.04644 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.830 | L2-Norm(final)=11.978 | 7720.9 samples/s | 120.6 steps/s
[Step=16450 Epoch=80.2] | Loss=0.04668 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.830 | L2-Norm(final)=12.002 | 2782.5 samples/s | 43.5 steps/s
[Step=16500 Epoch=80.5] | Loss=0.04643 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.830 | L2-Norm(final)=12.025 | 5511.5 samples/s | 86.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=80.5] | Loss=0.06648 | Reg=0.00140 | acc=0.9219 | L2-Norm=11.830 | L2-Norm(final)=12.250 | 6613.4 samples/s | 103.3 steps/s
[Step=16550 Epoch=80.7] | Loss=0.04977 | Reg=0.00143 | acc=0.9531 | L2-Norm=11.974 | L2-Norm(final)=12.253 | 4542.6 samples/s | 71.0 steps/s
[Step=16600 Epoch=81.0] | Loss=0.05068 | Reg=0.00147 | acc=0.9531 | L2-Norm=12.110 | L2-Norm(final)=12.237 | 4784.2 samples/s | 74.8 steps/s
[Step=16650 Epoch=81.2] | Loss=0.04855 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.201 | L2-Norm(final)=12.224 | 4720.0 samples/s | 73.7 steps/s
[Step=16700 Epoch=81.4] | Loss=0.04575 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.271 | L2-Norm(final)=12.215 | 6811.8 samples/s | 106.4 steps/s
[Step=16750 Epoch=81.7] | Loss=0.03988 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.328 | L2-Norm(final)=12.210 | 2504.8 samples/s | 39.1 steps/s
[Step=16800 Epoch=81.9] | Loss=0.03591 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.375 | L2-Norm(final)=12.210 | 4772.2 samples/s | 74.6 steps/s
[Step=16850 Epoch=82.2] | Loss=0.03311 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=12.211 | 4706.0 samples/s | 73.5 steps/s
[Step=16900 Epoch=82.4] | Loss=0.03071 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.452 | L2-Norm(final)=12.212 | 6248.6 samples/s | 97.6 steps/s
[Step=16950 Epoch=82.7] | Loss=0.02847 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.483 | L2-Norm(final)=12.214 | 2582.3 samples/s | 40.3 steps/s
[Step=17000 Epoch=82.9] | Loss=0.02676 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.510 | L2-Norm(final)=12.216 | 4723.2 samples/s | 73.8 steps/s
[Step=17050 Epoch=83.1] | Loss=0.02552 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.534 | L2-Norm(final)=12.217 | 4788.5 samples/s | 74.8 steps/s
[Step=17100 Epoch=83.4] | Loss=0.02431 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.556 | L2-Norm(final)=12.219 | 5731.1 samples/s | 89.5 steps/s
[Step=17150 Epoch=83.6] | Loss=0.02310 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.575 | L2-Norm(final)=12.221 | 2695.6 samples/s | 42.1 steps/s
[Step=17200 Epoch=83.9] | Loss=0.02179 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.592 | L2-Norm(final)=12.223 | 4698.8 samples/s | 73.4 steps/s
[Step=17250 Epoch=84.1] | Loss=0.02086 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.608 | L2-Norm(final)=12.225 | 4756.2 samples/s | 74.3 steps/s
[Step=17300 Epoch=84.4] | Loss=0.02023 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.622 | L2-Norm(final)=12.227 | 5277.4 samples/s | 82.5 steps/s
[Step=17350 Epoch=84.6] | Loss=0.01928 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.635 | L2-Norm(final)=12.228 | 2787.3 samples/s | 43.6 steps/s
[Step=17400 Epoch=84.9] | Loss=0.01853 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.647 | L2-Norm(final)=12.231 | 4750.7 samples/s | 74.2 steps/s
[Step=17450 Epoch=85.1] | Loss=0.01775 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.657 | L2-Norm(final)=12.233 | 4784.0 samples/s | 74.8 steps/s
[Step=17500 Epoch=85.3] | Loss=0.01711 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.667 | L2-Norm(final)=12.235 | 4905.0 samples/s | 76.6 steps/s
[Step=17550 Epoch=85.6] | Loss=0.01657 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.676 | L2-Norm(final)=12.238 | 2856.4 samples/s | 44.6 steps/s
[Step=17600 Epoch=85.8] | Loss=0.01607 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.684 | L2-Norm(final)=12.240 | 4745.8 samples/s | 74.2 steps/s
[Step=17650 Epoch=86.1] | Loss=0.01556 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=12.242 | 4755.2 samples/s | 74.3 steps/s
[Step=17700 Epoch=86.3] | Loss=0.01502 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.699 | L2-Norm(final)=12.245 | 4789.7 samples/s | 74.8 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01455 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.706 | L2-Norm(final)=12.247 | 2954.0 samples/s | 46.2 steps/s
[Step=17800 Epoch=86.8] | Loss=0.01408 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.712 | L2-Norm(final)=12.250 | 4812.2 samples/s | 75.2 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01370 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.718 | L2-Norm(final)=12.252 | 4802.7 samples/s | 75.0 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01335 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.723 | L2-Norm(final)=12.254 | 4698.4 samples/s | 73.4 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01308 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.728 | L2-Norm(final)=12.256 | 2959.8 samples/s | 46.2 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01279 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.732 | L2-Norm(final)=12.258 | 4792.6 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step18000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=24001 Epoch=227.4] | Loss=0.00004 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.829 | L2-Norm(final)=16.047 | 7364.7 samples/s | 115.1 steps/s
[Step=24050 Epoch=227.9] | Loss=0.00107 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.825 | L2-Norm(final)=16.060 | 4425.0 samples/s | 69.1 steps/s
[Step=24100 Epoch=228.4] | Loss=0.00103 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.825 | L2-Norm(final)=16.072 | 8316.8 samples/s | 130.0 steps/s
[Step=24150 Epoch=228.8] | Loss=0.00088 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.825 | L2-Norm(final)=16.088 | 2556.1 samples/s | 39.9 steps/s
[Step=24200 Epoch=229.3] | Loss=0.00090 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.825 | L2-Norm(final)=16.104 | 7268.0 samples/s | 113.6 steps/s
[Step=24250 Epoch=229.8] | Loss=0.00093 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.825 | L2-Norm(final)=16.118 | 2655.8 samples/s | 41.5 steps/s
[Step=24300 Epoch=230.3] | Loss=0.00093 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.825 | L2-Norm(final)=16.132 | 6505.2 samples/s | 101.6 steps/s
[Step=24350 Epoch=230.7] | Loss=0.00093 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.825 | L2-Norm(final)=16.147 | 2785.7 samples/s | 43.5 steps/s
[Step=24400 Epoch=231.2] | Loss=0.00095 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.825 | L2-Norm(final)=16.161 | 5876.0 samples/s | 91.8 steps/s
[Step=24450 Epoch=231.7] | Loss=0.00097 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.825 | L2-Norm(final)=16.176 | 2969.9 samples/s | 46.4 steps/s
[Step=24500 Epoch=232.2] | Loss=0.00096 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.825 | L2-Norm(final)=16.191 | 5318.5 samples/s | 83.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=232.2] | Loss=0.00036 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=16.341 | 6959.6 samples/s | 108.7 steps/s
[Step=24550 Epoch=232.6] | Loss=0.00051 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.816 | L2-Norm(final)=16.352 | 4141.1 samples/s | 64.7 steps/s
[Step=24600 Epoch=233.1] | Loss=0.00188 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.860 | L2-Norm(final)=16.350 | 6411.9 samples/s | 100.2 steps/s
[Step=24650 Epoch=233.6] | Loss=0.00341 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.945 | L2-Norm(final)=16.338 | 2399.0 samples/s | 37.5 steps/s
[Step=24700 Epoch=234.1] | Loss=0.00288 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.033 | L2-Norm(final)=16.327 | 5955.0 samples/s | 93.0 steps/s
[Step=24750 Epoch=234.5] | Loss=0.00384 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.096 | L2-Norm(final)=16.318 | 2503.9 samples/s | 39.1 steps/s
[Step=24800 Epoch=235.0] | Loss=0.00352 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=16.306 | 5392.2 samples/s | 84.3 steps/s
[Step=24850 Epoch=235.5] | Loss=0.00306 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.185 | L2-Norm(final)=16.296 | 2571.1 samples/s | 40.2 steps/s
[Step=24900 Epoch=235.9] | Loss=0.00268 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.209 | L2-Norm(final)=16.290 | 5032.0 samples/s | 78.6 steps/s
[Step=24950 Epoch=236.4] | Loss=0.00239 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.224 | L2-Norm(final)=16.285 | 2668.8 samples/s | 41.7 steps/s
[Step=25000 Epoch=236.9] | Loss=0.00215 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.234 | L2-Norm(final)=16.281 | 4642.7 samples/s | 72.5 steps/s
[Step=25050 Epoch=237.4] | Loss=0.00196 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.239 | L2-Norm(final)=16.278 | 2801.3 samples/s | 43.8 steps/s
[Step=25100 Epoch=237.8] | Loss=0.00179 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=16.275 | 4502.0 samples/s | 70.3 steps/s
[Step=25150 Epoch=238.3] | Loss=0.00166 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=16.273 | 2856.8 samples/s | 44.6 steps/s
[Step=25200 Epoch=238.8] | Loss=0.00154 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.240 | L2-Norm(final)=16.271 | 4488.8 samples/s | 70.1 steps/s
[Step=25250 Epoch=239.3] | Loss=0.00144 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.237 | L2-Norm(final)=16.270 | 2891.7 samples/s | 45.2 steps/s
[Step=25300 Epoch=239.7] | Loss=0.00135 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=16.268 | 4478.4 samples/s | 70.0 steps/s
[Step=25350 Epoch=240.2] | Loss=0.00127 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=16.267 | 3003.6 samples/s | 46.9 steps/s
[Step=25400 Epoch=240.7] | Loss=0.00120 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=16.266 | 4237.3 samples/s | 66.2 steps/s
[Step=25450 Epoch=241.2] | Loss=0.00113 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=16.265 | 6703.2 samples/s | 104.7 steps/s
[Step=25500 Epoch=241.6] | Loss=0.00108 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.210 | L2-Norm(final)=16.265 | 2354.0 samples/s | 36.8 steps/s
[Step=25550 Epoch=242.1] | Loss=0.00103 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=16.264 | 6175.7 samples/s | 96.5 steps/s
[Step=25600 Epoch=242.6] | Loss=0.00098 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=16.264 | 2431.1 samples/s | 38.0 steps/s
[Step=25650 Epoch=243.1] | Loss=0.00094 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.188 | L2-Norm(final)=16.264 | 5639.9 samples/s | 88.1 steps/s
[Step=25700 Epoch=243.5] | Loss=0.00090 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=16.264 | 2562.8 samples/s | 40.0 steps/s
[Step=25750 Epoch=244.0] | Loss=0.00086 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=16.264 | 5113.4 samples/s | 79.9 steps/s
[Step=25800 Epoch=244.5] | Loss=0.00083 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=16.264 | 2643.2 samples/s | 41.3 steps/s
[Step=25850 Epoch=245.0] | Loss=0.00080 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=16.264 | 4695.0 samples/s | 73.4 steps/s
[Step=25900 Epoch=245.4] | Loss=0.00077 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=16.265 | 2776.9 samples/s | 43.4 steps/s
[Step=25950 Epoch=245.9] | Loss=0.00074 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=16.265 | 4526.7 samples/s | 70.7 steps/s
[Step=26000 Epoch=246.4] | Loss=0.00072 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=16.265 | 2864.0 samples/s | 44.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step26000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=114.6] | Loss=0.00096 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.829 | L2-Norm(final)=10.124 | 7680.9 samples/s | 120.0 steps/s
[Step=12050 Epoch=115.1] | Loss=0.00343 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=10.154 | 4580.7 samples/s | 71.6 steps/s
[Step=12100 Epoch=115.5] | Loss=0.00320 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=10.196 | 8106.3 samples/s | 126.7 steps/s
[Step=12150 Epoch=116.0] | Loss=0.00320 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=10.236 | 2585.5 samples/s | 40.4 steps/s
[Step=12200 Epoch=116.5] | Loss=0.00309 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=10.275 | 7316.7 samples/s | 114.3 steps/s
[Step=12250 Epoch=117.0] | Loss=0.00316 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.823 | L2-Norm(final)=10.310 | 2648.9 samples/s | 41.4 steps/s
[Step=12300 Epoch=117.5] | Loss=0.00303 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.823 | L2-Norm(final)=10.344 | 6900.5 samples/s | 107.8 steps/s
[Step=12350 Epoch=117.9] | Loss=0.00310 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.823 | L2-Norm(final)=10.380 | 2780.5 samples/s | 43.4 steps/s
[Step=12400 Epoch=118.4] | Loss=0.00307 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.823 | L2-Norm(final)=10.416 | 6130.9 samples/s | 95.8 steps/s
[Step=12450 Epoch=118.9] | Loss=0.00297 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.823 | L2-Norm(final)=10.450 | 2847.4 samples/s | 44.5 steps/s
[Step=12500 Epoch=119.4] | Loss=0.00300 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.823 | L2-Norm(final)=10.484 | 5764.6 samples/s | 90.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=119.4] | Loss=0.02659 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.823 | L2-Norm(final)=10.821 | 6470.4 samples/s | 101.1 steps/s
[Step=12550 Epoch=119.8] | Loss=0.00392 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.958 | L2-Norm(final)=10.833 | 4269.7 samples/s | 66.7 steps/s
[Step=12600 Epoch=120.3] | Loss=0.00476 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.083 | L2-Norm(final)=10.827 | 6573.5 samples/s | 102.7 steps/s
[Step=12650 Epoch=120.8] | Loss=0.00371 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=10.824 | 2386.4 samples/s | 37.3 steps/s
[Step=12700 Epoch=121.3] | Loss=0.00305 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=10.822 | 6163.5 samples/s | 96.3 steps/s
[Step=12750 Epoch=121.8] | Loss=0.00246 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.200 | L2-Norm(final)=10.822 | 2284.5 samples/s | 35.7 steps/s
[Step=12800 Epoch=122.2] | Loss=0.00205 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.205 | L2-Norm(final)=10.822 | 5687.0 samples/s | 88.9 steps/s
[Step=12850 Epoch=122.7] | Loss=0.00176 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=10.823 | 2526.9 samples/s | 39.5 steps/s
[Step=12900 Epoch=123.2] | Loss=0.00154 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.198 | L2-Norm(final)=10.823 | 5313.5 samples/s | 83.0 steps/s
[Step=12950 Epoch=123.7] | Loss=0.00137 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.190 | L2-Norm(final)=10.824 | 2630.0 samples/s | 41.1 steps/s
[Step=13000 Epoch=124.1] | Loss=0.00124 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=10.824 | 4885.7 samples/s | 76.3 steps/s
[Step=13050 Epoch=124.6] | Loss=0.00112 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=10.825 | 2711.5 samples/s | 42.4 steps/s
[Step=13100 Epoch=125.1] | Loss=0.00103 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=10.825 | 4628.8 samples/s | 72.3 steps/s
[Step=13150 Epoch=125.6] | Loss=0.00095 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=10.825 | 2808.4 samples/s | 43.9 steps/s
[Step=13200 Epoch=126.1] | Loss=0.00088 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=10.826 | 4515.5 samples/s | 70.6 steps/s
[Step=13250 Epoch=126.5] | Loss=0.00082 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.121 | L2-Norm(final)=10.826 | 2894.2 samples/s | 45.2 steps/s
[Step=13300 Epoch=127.0] | Loss=0.00077 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.107 | L2-Norm(final)=10.826 | 4460.8 samples/s | 69.7 steps/s
[Step=13350 Epoch=127.5] | Loss=0.00073 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.094 | L2-Norm(final)=10.827 | 2880.4 samples/s | 45.0 steps/s
[Step=13400 Epoch=128.0] | Loss=0.00069 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.081 | L2-Norm(final)=10.827 | 4467.0 samples/s | 69.8 steps/s
[Step=13450 Epoch=128.4] | Loss=0.00065 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.067 | L2-Norm(final)=10.827 | 2849.1 samples/s | 44.5 steps/s
[Step=13500 Epoch=128.9] | Loss=0.00062 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.054 | L2-Norm(final)=10.828 | 4545.2 samples/s | 71.0 steps/s
[Step=13550 Epoch=129.4] | Loss=0.00059 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.040 | L2-Norm(final)=10.828 | 7378.5 samples/s | 115.3 steps/s
[Step=13600 Epoch=129.9] | Loss=0.00056 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.027 | L2-Norm(final)=10.828 | 2297.5 samples/s | 35.9 steps/s
[Step=13650 Epoch=130.3] | Loss=0.00054 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.013 | L2-Norm(final)=10.828 | 6774.4 samples/s | 105.8 steps/s
[Step=13700 Epoch=130.8] | Loss=0.00052 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.999 | L2-Norm(final)=10.829 | 2364.0 samples/s | 36.9 steps/s
[Step=13750 Epoch=131.3] | Loss=0.00050 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.986 | L2-Norm(final)=10.829 | 6195.4 samples/s | 96.8 steps/s
[Step=13800 Epoch=131.8] | Loss=0.00048 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=10.829 | 2441.3 samples/s | 38.1 steps/s
[Step=13850 Epoch=132.3] | Loss=0.00046 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.958 | L2-Norm(final)=10.829 | 5679.3 samples/s | 88.7 steps/s
[Step=13900 Epoch=132.7] | Loss=0.00044 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.945 | L2-Norm(final)=10.830 | 2519.7 samples/s | 39.4 steps/s
[Step=13950 Epoch=133.2] | Loss=0.00043 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.931 | L2-Norm(final)=10.830 | 5275.1 samples/s | 82.4 steps/s
[Step=14000 Epoch=133.7] | Loss=0.00041 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.917 | L2-Norm(final)=10.830 | 2605.8 samples/s | 40.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step14000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=152.5] | Loss=0.01455 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.829 | L2-Norm(final)=12.233 | 6658.1 samples/s | 104.0 steps/s
[Step=16050 Epoch=153.0] | Loss=0.00395 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=12.253 | 4766.8 samples/s | 74.5 steps/s
[Step=16100 Epoch=153.4] | Loss=0.00452 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=12.283 | 8157.9 samples/s | 127.5 steps/s
[Step=16150 Epoch=153.9] | Loss=0.00418 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=12.315 | 2544.2 samples/s | 39.8 steps/s
[Step=16200 Epoch=154.4] | Loss=0.00436 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=12.347 | 7425.3 samples/s | 116.0 steps/s
[Step=16250 Epoch=154.9] | Loss=0.00447 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=12.379 | 2622.9 samples/s | 41.0 steps/s
[Step=16300 Epoch=155.4] | Loss=0.00432 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=12.409 | 6877.9 samples/s | 107.5 steps/s
[Step=16350 Epoch=155.8] | Loss=0.00424 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.823 | L2-Norm(final)=12.439 | 2731.9 samples/s | 42.7 steps/s
[Step=16400 Epoch=156.3] | Loss=0.00427 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.823 | L2-Norm(final)=12.468 | 6288.6 samples/s | 98.3 steps/s
[Step=16450 Epoch=156.8] | Loss=0.00426 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.823 | L2-Norm(final)=12.498 | 2895.4 samples/s | 45.2 steps/s
[Step=16500 Epoch=157.3] | Loss=0.00421 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.823 | L2-Norm(final)=12.527 | 5584.3 samples/s | 87.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=157.3] | Loss=0.00083 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.823 | L2-Norm(final)=12.822 | 6863.5 samples/s | 107.2 steps/s
[Step=16550 Epoch=157.7] | Loss=0.00875 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.954 | L2-Norm(final)=12.830 | 4086.4 samples/s | 63.8 steps/s
[Step=16600 Epoch=158.2] | Loss=0.00516 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=12.821 | 6684.5 samples/s | 104.4 steps/s
[Step=16650 Epoch=158.7] | Loss=0.00360 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=12.821 | 2394.7 samples/s | 37.4 steps/s
[Step=16700 Epoch=159.2] | Loss=0.00271 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.202 | L2-Norm(final)=12.822 | 5944.7 samples/s | 92.9 steps/s
[Step=16750 Epoch=159.6] | Loss=0.00217 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.206 | L2-Norm(final)=12.823 | 2438.9 samples/s | 38.1 steps/s
[Step=16800 Epoch=160.1] | Loss=0.00181 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.202 | L2-Norm(final)=12.824 | 5679.0 samples/s | 88.7 steps/s
[Step=16850 Epoch=160.6] | Loss=0.00155 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.193 | L2-Norm(final)=12.825 | 2571.8 samples/s | 40.2 steps/s
[Step=16900 Epoch=161.1] | Loss=0.00136 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=12.826 | 5219.2 samples/s | 81.5 steps/s
[Step=16950 Epoch=161.5] | Loss=0.00121 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=12.826 | 2612.0 samples/s | 40.8 steps/s
[Step=17000 Epoch=162.0] | Loss=0.00109 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=12.827 | 4955.3 samples/s | 77.4 steps/s
[Step=17050 Epoch=162.5] | Loss=0.00099 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=12.828 | 2710.2 samples/s | 42.3 steps/s
[Step=17100 Epoch=163.0] | Loss=0.00091 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.131 | L2-Norm(final)=12.829 | 4654.3 samples/s | 72.7 steps/s
[Step=17150 Epoch=163.5] | Loss=0.00084 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.117 | L2-Norm(final)=12.829 | 2795.7 samples/s | 43.7 steps/s
[Step=17200 Epoch=163.9] | Loss=0.00078 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.102 | L2-Norm(final)=12.830 | 4563.5 samples/s | 71.3 steps/s
[Step=17250 Epoch=164.4] | Loss=0.00073 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.088 | L2-Norm(final)=12.831 | 2860.4 samples/s | 44.7 steps/s
[Step=17300 Epoch=164.9] | Loss=0.00068 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=12.831 | 4479.2 samples/s | 70.0 steps/s
[Step=17350 Epoch=165.4] | Loss=0.00064 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.059 | L2-Norm(final)=12.832 | 2859.5 samples/s | 44.7 steps/s
[Step=17400 Epoch=165.8] | Loss=0.00061 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.044 | L2-Norm(final)=12.833 | 4531.1 samples/s | 70.8 steps/s
[Step=17450 Epoch=166.3] | Loss=0.00058 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.030 | L2-Norm(final)=12.833 | 2829.9 samples/s | 44.2 steps/s
[Step=17500 Epoch=166.8] | Loss=0.00055 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.015 | L2-Norm(final)=12.834 | 4532.3 samples/s | 70.8 steps/s
[Step=17550 Epoch=167.3] | Loss=0.00052 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.001 | L2-Norm(final)=12.835 | 7370.5 samples/s | 115.2 steps/s
[Step=17600 Epoch=167.7] | Loss=0.00050 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.986 | L2-Norm(final)=12.835 | 2293.5 samples/s | 35.8 steps/s
[Step=17650 Epoch=168.2] | Loss=0.00048 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=12.836 | 6698.7 samples/s | 104.7 steps/s
[Step=17700 Epoch=168.7] | Loss=0.00046 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.957 | L2-Norm(final)=12.836 | 2387.8 samples/s | 37.3 steps/s
[Step=17750 Epoch=169.2] | Loss=0.00044 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.943 | L2-Norm(final)=12.837 | 5983.1 samples/s | 93.5 steps/s
[Step=17800 Epoch=169.7] | Loss=0.00042 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.928 | L2-Norm(final)=12.838 | 2456.7 samples/s | 38.4 steps/s
[Step=17850 Epoch=170.1] | Loss=0.00041 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.914 | L2-Norm(final)=12.838 | 5645.6 samples/s | 88.2 steps/s
[Step=17900 Epoch=170.6] | Loss=0.00039 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.899 | L2-Norm(final)=12.839 | 2546.0 samples/s | 39.8 steps/s
[Step=17950 Epoch=171.1] | Loss=0.00038 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.885 | L2-Norm(final)=12.839 | 5134.9 samples/s | 80.2 steps/s
[Step=18000 Epoch=171.6] | Loss=0.00037 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.870 | L2-Norm(final)=12.840 | 2621.7 samples/s | 41.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step18000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10394 | acc=0.9549 | tpr=0.9707 | fpr=0.0793 | 5996.3 samples/s | 23.4 steps/s
Avg test loss: 0.11508, Avg test acc: 0.95064, Avg tpr: 0.96765, Avg fpr: 0.08678, total FA: 677

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.13220 | acc=0.9516 | tpr=0.9746 | fpr=0.0984 | 5908.0 samples/s | 23.1 steps/s
Avg test loss: 0.13300, Avg test acc: 0.95000, Avg tpr: 0.97237, Avg fpr: 0.09922, total FA: 774

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11141 | acc=0.9500 | tpr=0.9744 | fpr=0.1031 | 5786.0 samples/s | 22.6 steps/s
Avg test loss: 0.11265, Avg test acc: 0.94960, Avg tpr: 0.97319, Avg fpr: 0.10229, total FA: 798

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10846 | acc=0.9530 | tpr=0.9612 | fpr=0.0649 | 5982.1 samples/s | 23.4 steps/s
Avg test loss: 0.11939, Avg test acc: 0.94923, Avg tpr: 0.95803, Avg fpr: 0.07012, total FA: 547

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.12772 | acc=0.9494 | tpr=0.9683 | fpr=0.0917 | 6068.4 samples/s | 23.7 steps/s
Avg test loss: 0.13083, Avg test acc: 0.94799, Avg tpr: 0.96666, Avg fpr: 0.09306, total FA: 726

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.88562 | acc=0.3046 | tpr=0.0280 | fpr=0.0946 | 6011.9 samples/s | 23.5 steps/s
Avg test loss: 6.90202, Avg test acc: 0.30151, Avg tpr: 0.02774, Avg fpr: 0.09640, total FA: 752

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.57658 | acc=0.3168 | tpr=0.0151 | fpr=0.0280 | 6066.4 samples/s | 23.7 steps/s
Avg test loss: 4.59413, Avg test acc: 0.31293, Avg tpr: 0.01416, Avg fpr: 0.03000, total FA: 234

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.32108 | acc=0.3070 | tpr=0.0090 | fpr=0.0458 | 6079.0 samples/s | 23.7 steps/s
Avg test loss: 5.33115, Avg test acc: 0.30431, Avg tpr: 0.00898, Avg fpr: 0.04615, total FA: 360

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.97906 | acc=0.3002 | tpr=0.0314 | fpr=0.1160 | 5897.3 samples/s | 23.0 steps/s
Avg test loss: 4.98694, Avg test acc: 0.29718, Avg tpr: 0.03002, Avg fpr: 0.11524, total FA: 899

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.54734 | acc=0.3061 | tpr=0.0163 | fpr=0.0647 | 6047.2 samples/s | 23.6 steps/s
Avg test loss: 5.57382, Avg test acc: 0.30487, Avg tpr: 0.01626, Avg fpr: 0.06038, total FA: 471

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.96854 | acc=0.1308 | tpr=0.7389 | fpr=0.8801 | 6099.4 samples/s | 23.8 steps/s
[Step= 100] | Loss=5.94230 | acc=0.1333 | tpr=0.7143 | fpr=0.8776 | 8106.0 samples/s | 31.7 steps/s
[Step= 150] | Loss=5.93543 | acc=0.1341 | tpr=0.7262 | fpr=0.8768 | 7963.6 samples/s | 31.1 steps/s
[Step= 200] | Loss=5.92761 | acc=0.1349 | tpr=0.7246 | fpr=0.8758 | 7334.0 samples/s | 28.6 steps/s
[Step= 250] | Loss=5.93450 | acc=0.1348 | tpr=0.7135 | fpr=0.8758 | 8712.5 samples/s | 34.0 steps/s
[Step= 300] | Loss=5.92690 | acc=0.1345 | tpr=0.7127 | fpr=0.8760 | 8352.5 samples/s | 32.6 steps/s
[Step= 350] | Loss=5.93042 | acc=0.1344 | tpr=0.7170 | fpr=0.8762 | 7924.4 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.92806 | acc=0.1347 | tpr=0.7133 | fpr=0.8759 | 8212.6 samples/s | 32.1 steps/s
[Step= 450] | Loss=5.93250 | acc=0.1340 | tpr=0.7162 | fpr=0.8765 | 7766.9 samples/s | 30.3 steps/s
[Step= 500] | Loss=5.93111 | acc=0.1343 | tpr=0.7207 | fpr=0.8763 | 8234.7 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.93290 | acc=0.1343 | tpr=0.7230 | fpr=0.8764 | 9451.7 samples/s | 36.9 steps/s
Avg test loss: 5.93360, Avg test acc: 0.13430, Avg tpr: 0.72385, Avg fpr: 0.87642, total FA: 121689

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.80969 | acc=0.1240 | tpr=0.6903 | fpr=0.8862 | 6009.7 samples/s | 23.5 steps/s
[Step= 100] | Loss=5.78672 | acc=0.1284 | tpr=0.7036 | fpr=0.8823 | 8098.6 samples/s | 31.6 steps/s
[Step= 150] | Loss=5.77604 | acc=0.1296 | tpr=0.7118 | fpr=0.8812 | 7691.4 samples/s | 30.0 steps/s
[Step= 200] | Loss=5.77215 | acc=0.1297 | tpr=0.6995 | fpr=0.8806 | 7777.3 samples/s | 30.4 steps/s
[Step= 250] | Loss=5.77878 | acc=0.1293 | tpr=0.6961 | fpr=0.8810 | 8508.5 samples/s | 33.2 steps/s
[Step= 300] | Loss=5.77194 | acc=0.1294 | tpr=0.6880 | fpr=0.8807 | 8548.6 samples/s | 33.4 steps/s
[Step= 350] | Loss=5.78067 | acc=0.1291 | tpr=0.6850 | fpr=0.8810 | 7903.9 samples/s | 30.9 steps/s
[Step= 400] | Loss=5.77554 | acc=0.1293 | tpr=0.6865 | fpr=0.8808 | 7671.5 samples/s | 30.0 steps/s
[Step= 450] | Loss=5.78054 | acc=0.1289 | tpr=0.6918 | fpr=0.8813 | 8275.2 samples/s | 32.3 steps/s
[Step= 500] | Loss=5.77921 | acc=0.1290 | tpr=0.6952 | fpr=0.8813 | 7810.7 samples/s | 30.5 steps/s
[Step= 550] | Loss=5.78396 | acc=0.1291 | tpr=0.6988 | fpr=0.8812 | 9833.9 samples/s | 38.4 steps/s
Avg test loss: 5.78475, Avg test acc: 0.12901, Avg tpr: 0.69929, Avg fpr: 0.88136, total FA: 122375

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.75191 | acc=0.1116 | tpr=0.7522 | fpr=0.9000 | 6065.1 samples/s | 23.7 steps/s
[Step= 100] | Loss=5.73705 | acc=0.1121 | tpr=0.7527 | fpr=0.8998 | 7488.8 samples/s | 29.3 steps/s
[Step= 150] | Loss=5.73246 | acc=0.1138 | tpr=0.7493 | fpr=0.8979 | 8401.1 samples/s | 32.8 steps/s
[Step= 200] | Loss=5.72792 | acc=0.1140 | tpr=0.7410 | fpr=0.8974 | 7971.2 samples/s | 31.1 steps/s
[Step= 250] | Loss=5.73226 | acc=0.1143 | tpr=0.7406 | fpr=0.8971 | 8059.2 samples/s | 31.5 steps/s
[Step= 300] | Loss=5.73034 | acc=0.1139 | tpr=0.7382 | fpr=0.8974 | 8321.3 samples/s | 32.5 steps/s
[Step= 350] | Loss=5.73647 | acc=0.1137 | tpr=0.7389 | fpr=0.8976 | 8011.1 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.73395 | acc=0.1139 | tpr=0.7412 | fpr=0.8975 | 7432.7 samples/s | 29.0 steps/s
[Step= 450] | Loss=5.73875 | acc=0.1132 | tpr=0.7444 | fpr=0.8982 | 8620.7 samples/s | 33.7 steps/s
[Step= 500] | Loss=5.73693 | acc=0.1131 | tpr=0.7449 | fpr=0.8983 | 8396.9 samples/s | 32.8 steps/s
[Step= 550] | Loss=5.74165 | acc=0.1132 | tpr=0.7441 | fpr=0.8983 | 9348.0 samples/s | 36.5 steps/s
Avg test loss: 5.74189, Avg test acc: 0.11305, Avg tpr: 0.74445, Avg fpr: 0.89843, total FA: 124745

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.13132 | acc=0.1426 | tpr=0.6106 | fpr=0.8658 | 6005.1 samples/s | 23.5 steps/s
[Step= 100] | Loss=5.11608 | acc=0.1452 | tpr=0.6333 | fpr=0.8639 | 8030.4 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.10841 | acc=0.1478 | tpr=0.6455 | fpr=0.8614 | 8001.4 samples/s | 31.3 steps/s
[Step= 200] | Loss=5.10525 | acc=0.1487 | tpr=0.6481 | fpr=0.8604 | 8179.1 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.10786 | acc=0.1486 | tpr=0.6498 | fpr=0.8605 | 7946.9 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.10154 | acc=0.1488 | tpr=0.6444 | fpr=0.8602 | 7959.8 samples/s | 31.1 steps/s
[Step= 350] | Loss=5.10503 | acc=0.1487 | tpr=0.6462 | fpr=0.8603 | 8199.8 samples/s | 32.0 steps/s
[Step= 400] | Loss=5.10008 | acc=0.1493 | tpr=0.6450 | fpr=0.8597 | 7974.8 samples/s | 31.2 steps/s
[Step= 450] | Loss=5.10211 | acc=0.1489 | tpr=0.6470 | fpr=0.8601 | 8238.3 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.10137 | acc=0.1490 | tpr=0.6542 | fpr=0.8601 | 7268.3 samples/s | 28.4 steps/s
[Step= 550] | Loss=5.10793 | acc=0.1490 | tpr=0.6542 | fpr=0.8601 | 10331.9 samples/s | 40.4 steps/s
Avg test loss: 5.10895, Avg test acc: 0.14899, Avg tpr: 0.65452, Avg fpr: 0.86020, total FA: 119437

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.71595 | acc=0.1283 | tpr=0.6681 | fpr=0.8814 | 5936.1 samples/s | 23.2 steps/s
[Step= 100] | Loss=5.70721 | acc=0.1320 | tpr=0.6439 | fpr=0.8776 | 7884.7 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.70269 | acc=0.1347 | tpr=0.6556 | fpr=0.8748 | 7487.7 samples/s | 29.2 steps/s
[Step= 200] | Loss=5.70622 | acc=0.1352 | tpr=0.6590 | fpr=0.8744 | 8163.7 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.71006 | acc=0.1350 | tpr=0.6559 | fpr=0.8745 | 8163.3 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.70384 | acc=0.1352 | tpr=0.6575 | fpr=0.8743 | 8346.9 samples/s | 32.6 steps/s
[Step= 350] | Loss=5.71223 | acc=0.1349 | tpr=0.6537 | fpr=0.8745 | 7927.4 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.71195 | acc=0.1351 | tpr=0.6510 | fpr=0.8743 | 8201.3 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.71734 | acc=0.1344 | tpr=0.6534 | fpr=0.8750 | 7944.8 samples/s | 31.0 steps/s
[Step= 500] | Loss=5.71594 | acc=0.1345 | tpr=0.6551 | fpr=0.8749 | 8183.1 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.71995 | acc=0.1347 | tpr=0.6578 | fpr=0.8748 | 10198.2 samples/s | 39.8 steps/s
Avg test loss: 5.72078, Avg test acc: 0.13471, Avg tpr: 0.65887, Avg fpr: 0.87482, total FA: 121467

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19345 | acc=0.9594 | tpr=0.9292 | fpr=0.0401 | 5874.1 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.19607 | acc=0.9586 | tpr=0.9424 | fpr=0.0411 | 8662.3 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.19751 | acc=0.9573 | tpr=0.9395 | fpr=0.0424 | 7430.3 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.19689 | acc=0.9572 | tpr=0.9443 | fpr=0.0425 | 7800.5 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.19780 | acc=0.9572 | tpr=0.9432 | fpr=0.0426 | 7477.6 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.20146 | acc=0.9567 | tpr=0.9396 | fpr=0.0430 | 8360.0 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.20169 | acc=0.9569 | tpr=0.9399 | fpr=0.0428 | 8237.7 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.20207 | acc=0.9566 | tpr=0.9354 | fpr=0.0430 | 8519.4 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.20580 | acc=0.9562 | tpr=0.9323 | fpr=0.0433 | 7446.6 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.20524 | acc=0.9563 | tpr=0.9348 | fpr=0.0433 | 8453.6 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.20410 | acc=0.9565 | tpr=0.9343 | fpr=0.0431 | 10841.4 samples/s | 42.3 steps/s
Avg test loss: 0.20359, Avg test acc: 0.95658, Avg tpr: 0.93463, Avg fpr: 0.04303, total FA: 5974

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13867 | acc=0.9647 | tpr=0.8673 | fpr=0.0336 | 5953.9 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.14296 | acc=0.9641 | tpr=0.8955 | fpr=0.0347 | 8364.8 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.14474 | acc=0.9630 | tpr=0.9049 | fpr=0.0359 | 7792.4 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.14340 | acc=0.9630 | tpr=0.9038 | fpr=0.0359 | 7914.2 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.14370 | acc=0.9630 | tpr=0.9013 | fpr=0.0358 | 8105.9 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.14778 | acc=0.9623 | tpr=0.8960 | fpr=0.0365 | 8108.5 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.14751 | acc=0.9623 | tpr=0.8992 | fpr=0.0365 | 8070.5 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.14730 | acc=0.9623 | tpr=0.8972 | fpr=0.0366 | 8140.1 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.14931 | acc=0.9618 | tpr=0.8953 | fpr=0.0370 | 8211.0 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.14909 | acc=0.9617 | tpr=0.8965 | fpr=0.0371 | 7730.2 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.14810 | acc=0.9618 | tpr=0.8930 | fpr=0.0369 | 9620.6 samples/s | 37.6 steps/s
Avg test loss: 0.14788, Avg test acc: 0.96184, Avg tpr: 0.89303, Avg fpr: 0.03691, total FA: 5125

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.25390 | acc=0.9495 | tpr=0.9425 | fpr=0.0503 | 6087.7 samples/s | 23.8 steps/s
[Step= 100] | Loss=0.25873 | acc=0.9484 | tpr=0.9510 | fpr=0.0516 | 7315.9 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.26255 | acc=0.9476 | tpr=0.9553 | fpr=0.0526 | 7991.5 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.26278 | acc=0.9477 | tpr=0.9585 | fpr=0.0525 | 8076.3 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.26381 | acc=0.9474 | tpr=0.9546 | fpr=0.0528 | 8612.9 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.26629 | acc=0.9472 | tpr=0.9505 | fpr=0.0529 | 8294.8 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.26434 | acc=0.9474 | tpr=0.9518 | fpr=0.0527 | 7888.8 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.26471 | acc=0.9469 | tpr=0.9475 | fpr=0.0531 | 8537.1 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.26819 | acc=0.9462 | tpr=0.9460 | fpr=0.0538 | 8299.7 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.26831 | acc=0.9462 | tpr=0.9480 | fpr=0.0538 | 7956.3 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.26647 | acc=0.9465 | tpr=0.9463 | fpr=0.0535 | 9270.2 samples/s | 36.2 steps/s
Avg test loss: 0.26622, Avg test acc: 0.94652, Avg tpr: 0.94612, Avg fpr: 0.05348, total FA: 7425

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15008 | acc=0.9609 | tpr=0.9159 | fpr=0.0383 | 6139.9 samples/s | 24.0 steps/s
[Step= 100] | Loss=0.15431 | acc=0.9598 | tpr=0.9318 | fpr=0.0397 | 7500.3 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.15512 | acc=0.9588 | tpr=0.9265 | fpr=0.0406 | 7509.5 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.15463 | acc=0.9590 | tpr=0.9322 | fpr=0.0405 | 8614.2 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.15577 | acc=0.9586 | tpr=0.9310 | fpr=0.0409 | 7652.8 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.15776 | acc=0.9584 | tpr=0.9309 | fpr=0.0411 | 7729.9 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.15640 | acc=0.9586 | tpr=0.9330 | fpr=0.0409 | 8201.0 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.15566 | acc=0.9584 | tpr=0.9322 | fpr=0.0411 | 8708.0 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.15851 | acc=0.9580 | tpr=0.9299 | fpr=0.0415 | 8449.7 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.15847 | acc=0.9581 | tpr=0.9330 | fpr=0.0415 | 7050.6 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.15790 | acc=0.9582 | tpr=0.9312 | fpr=0.0413 | 11236.2 samples/s | 43.9 steps/s
Avg test loss: 0.15768, Avg test acc: 0.95830, Avg tpr: 0.93106, Avg fpr: 0.04120, total FA: 5721

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21660 | acc=0.9580 | tpr=0.8673 | fpr=0.0404 | 5857.5 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.22359 | acc=0.9575 | tpr=0.9019 | fpr=0.0415 | 7651.7 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.22617 | acc=0.9564 | tpr=0.9207 | fpr=0.0430 | 7779.6 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.22616 | acc=0.9562 | tpr=0.9191 | fpr=0.0431 | 8854.0 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.22813 | acc=0.9560 | tpr=0.9179 | fpr=0.0433 | 8255.1 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.23045 | acc=0.9556 | tpr=0.9156 | fpr=0.0437 | 8190.3 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.22915 | acc=0.9556 | tpr=0.9167 | fpr=0.0437 | 7936.3 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.22913 | acc=0.9554 | tpr=0.9152 | fpr=0.0439 | 7249.6 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.23324 | acc=0.9548 | tpr=0.9133 | fpr=0.0444 | 8006.7 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.23333 | acc=0.9546 | tpr=0.9154 | fpr=0.0447 | 8131.0 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.23182 | acc=0.9548 | tpr=0.9136 | fpr=0.0444 | 10752.5 samples/s | 42.0 steps/s
Avg test loss: 0.23164, Avg test acc: 0.95479, Avg tpr: 0.91284, Avg fpr: 0.04444, total FA: 6171

server round 17/50

clients selected: [1 5 6 7 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=107.4] | Loss=0.04839 | Reg=0.00139 | acc=0.9531 | L2-Norm=11.796 | L2-Norm(final)=13.092 | 7296.0 samples/s | 114.0 steps/s
[Step=22050 Epoch=107.6] | Loss=0.04812 | Reg=0.00139 | acc=0.9375 | L2-Norm=11.798 | L2-Norm(final)=13.114 | 4828.2 samples/s | 75.4 steps/s
[Step=22100 Epoch=107.8] | Loss=0.04696 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.798 | L2-Norm(final)=13.144 | 5651.0 samples/s | 88.3 steps/s
[Step=22150 Epoch=108.1] | Loss=0.04565 | Reg=0.00139 | acc=0.9688 | L2-Norm=11.798 | L2-Norm(final)=13.169 | 5473.5 samples/s | 85.5 steps/s
[Step=22200 Epoch=108.3] | Loss=0.04465 | Reg=0.00139 | acc=0.9688 | L2-Norm=11.798 | L2-Norm(final)=13.195 | 8576.7 samples/s | 134.0 steps/s
[Step=22250 Epoch=108.6] | Loss=0.04462 | Reg=0.00139 | acc=0.9531 | L2-Norm=11.798 | L2-Norm(final)=13.219 | 2705.7 samples/s | 42.3 steps/s
[Step=22300 Epoch=108.8] | Loss=0.04349 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.798 | L2-Norm(final)=13.243 | 5317.9 samples/s | 83.1 steps/s
[Step=22350 Epoch=109.1] | Loss=0.04367 | Reg=0.00139 | acc=0.9688 | L2-Norm=11.798 | L2-Norm(final)=13.269 | 5555.0 samples/s | 86.8 steps/s
[Step=22400 Epoch=109.3] | Loss=0.04420 | Reg=0.00139 | acc=0.9219 | L2-Norm=11.798 | L2-Norm(final)=13.293 | 7898.6 samples/s | 123.4 steps/s
[Step=22450 Epoch=109.5] | Loss=0.04378 | Reg=0.00139 | acc=0.9375 | L2-Norm=11.798 | L2-Norm(final)=13.316 | 2746.2 samples/s | 42.9 steps/s
[Step=22500 Epoch=109.8] | Loss=0.04374 | Reg=0.00139 | acc=0.9688 | L2-Norm=11.798 | L2-Norm(final)=13.341 | 5554.9 samples/s | 86.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=109.8] | Loss=0.04984 | Reg=0.00139 | acc=0.9531 | L2-Norm=11.798 | L2-Norm(final)=13.581 | 7207.4 samples/s | 112.6 steps/s
[Step=22550 Epoch=110.0] | Loss=0.05033 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.926 | L2-Norm(final)=13.574 | 4280.6 samples/s | 66.9 steps/s
[Step=22600 Epoch=110.3] | Loss=0.04979 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.068 | L2-Norm(final)=13.550 | 4802.9 samples/s | 75.0 steps/s
[Step=22650 Epoch=110.5] | Loss=0.04641 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.157 | L2-Norm(final)=13.539 | 4726.3 samples/s | 73.8 steps/s
[Step=22700 Epoch=110.8] | Loss=0.04357 | Reg=0.00149 | acc=0.9531 | L2-Norm=12.222 | L2-Norm(final)=13.532 | 6901.8 samples/s | 107.8 steps/s
[Step=22750 Epoch=111.0] | Loss=0.03829 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.276 | L2-Norm(final)=13.527 | 2455.7 samples/s | 38.4 steps/s
[Step=22800 Epoch=111.3] | Loss=0.03483 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.319 | L2-Norm(final)=13.525 | 4740.5 samples/s | 74.1 steps/s
[Step=22850 Epoch=111.5] | Loss=0.03247 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.355 | L2-Norm(final)=13.525 | 4773.3 samples/s | 74.6 steps/s
[Step=22900 Epoch=111.7] | Loss=0.03093 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.386 | L2-Norm(final)=13.525 | 6404.6 samples/s | 100.1 steps/s
[Step=22950 Epoch=112.0] | Loss=0.02928 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.413 | L2-Norm(final)=13.524 | 2550.4 samples/s | 39.8 steps/s
[Step=23000 Epoch=112.2] | Loss=0.02755 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.440 | L2-Norm(final)=13.524 | 4727.9 samples/s | 73.9 steps/s
[Step=23050 Epoch=112.5] | Loss=0.02600 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.463 | L2-Norm(final)=13.524 | 4771.1 samples/s | 74.5 steps/s
[Step=23100 Epoch=112.7] | Loss=0.02446 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.485 | L2-Norm(final)=13.525 | 5848.0 samples/s | 91.4 steps/s
[Step=23150 Epoch=113.0] | Loss=0.02332 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.504 | L2-Norm(final)=13.526 | 2630.9 samples/s | 41.1 steps/s
[Step=23200 Epoch=113.2] | Loss=0.02246 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.521 | L2-Norm(final)=13.527 | 4754.3 samples/s | 74.3 steps/s
[Step=23250 Epoch=113.4] | Loss=0.02140 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=13.528 | 4743.9 samples/s | 74.1 steps/s
[Step=23300 Epoch=113.7] | Loss=0.02070 | Reg=0.00158 | acc=0.9531 | L2-Norm=12.552 | L2-Norm(final)=13.530 | 5529.3 samples/s | 86.4 steps/s
[Step=23350 Epoch=113.9] | Loss=0.02002 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.566 | L2-Norm(final)=13.531 | 2734.5 samples/s | 42.7 steps/s
[Step=23400 Epoch=114.2] | Loss=0.01911 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.579 | L2-Norm(final)=13.533 | 4779.8 samples/s | 74.7 steps/s
[Step=23450 Epoch=114.4] | Loss=0.01850 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.591 | L2-Norm(final)=13.535 | 4644.1 samples/s | 72.6 steps/s
[Step=23500 Epoch=114.7] | Loss=0.01790 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=13.537 | 5185.1 samples/s | 81.0 steps/s
[Step=23550 Epoch=114.9] | Loss=0.01743 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.612 | L2-Norm(final)=13.538 | 2793.9 samples/s | 43.7 steps/s
[Step=23600 Epoch=115.2] | Loss=0.01685 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.621 | L2-Norm(final)=13.539 | 4795.9 samples/s | 74.9 steps/s
[Step=23650 Epoch=115.4] | Loss=0.01623 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.630 | L2-Norm(final)=13.541 | 4698.1 samples/s | 73.4 steps/s
[Step=23700 Epoch=115.6] | Loss=0.01579 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.638 | L2-Norm(final)=13.543 | 4860.3 samples/s | 75.9 steps/s
[Step=23750 Epoch=115.9] | Loss=0.01540 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.646 | L2-Norm(final)=13.545 | 2909.4 samples/s | 45.5 steps/s
[Step=23800 Epoch=116.1] | Loss=0.01500 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.653 | L2-Norm(final)=13.547 | 4790.0 samples/s | 74.8 steps/s
[Step=23850 Epoch=116.4] | Loss=0.01461 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.659 | L2-Norm(final)=13.549 | 4680.6 samples/s | 73.1 steps/s
[Step=23900 Epoch=116.6] | Loss=0.01428 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.666 | L2-Norm(final)=13.550 | 4754.7 samples/s | 74.3 steps/s
[Step=23950 Epoch=116.9] | Loss=0.01411 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=13.552 | 2934.1 samples/s | 45.8 steps/s
[Step=24000 Epoch=117.1] | Loss=0.01379 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.679 | L2-Norm(final)=13.553 | 4749.8 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step24000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=26001 Epoch=246.4] | Loss=0.00088 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.796 | L2-Norm(final)=16.278 | 6401.2 samples/s | 100.0 steps/s
[Step=26050 Epoch=246.8] | Loss=0.00127 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=16.287 | 4929.7 samples/s | 77.0 steps/s
[Step=26100 Epoch=247.3] | Loss=0.00088 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=16.299 | 7907.2 samples/s | 123.6 steps/s
[Step=26150 Epoch=247.8] | Loss=0.00090 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=16.312 | 2558.5 samples/s | 40.0 steps/s
[Step=26200 Epoch=248.3] | Loss=0.00094 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=16.325 | 7307.6 samples/s | 114.2 steps/s
[Step=26250 Epoch=248.7] | Loss=0.00097 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=16.338 | 2672.0 samples/s | 41.7 steps/s
[Step=26300 Epoch=249.2] | Loss=0.00093 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=16.351 | 6562.0 samples/s | 102.5 steps/s
[Step=26350 Epoch=249.7] | Loss=0.00092 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=16.363 | 2805.3 samples/s | 43.8 steps/s
[Step=26400 Epoch=250.2] | Loss=0.00088 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=16.374 | 5822.1 samples/s | 91.0 steps/s
[Step=26450 Epoch=250.6] | Loss=0.00087 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=16.386 | 2926.4 samples/s | 45.7 steps/s
[Step=26500 Epoch=251.1] | Loss=0.00089 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=16.397 | 5390.4 samples/s | 84.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=26501 Epoch=251.1] | Loss=0.00006 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=16.512 | 6542.1 samples/s | 102.2 steps/s
[Step=26550 Epoch=251.6] | Loss=0.00844 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.915 | L2-Norm(final)=16.504 | 4190.6 samples/s | 65.5 steps/s
[Step=26600 Epoch=252.1] | Loss=0.00554 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.044 | L2-Norm(final)=16.478 | 6656.0 samples/s | 104.0 steps/s
[Step=26650 Epoch=252.5] | Loss=0.00378 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.096 | L2-Norm(final)=16.466 | 2369.9 samples/s | 37.0 steps/s
[Step=26700 Epoch=253.0] | Loss=0.00286 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.114 | L2-Norm(final)=16.462 | 5982.8 samples/s | 93.5 steps/s
[Step=26750 Epoch=253.5] | Loss=0.00229 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=16.460 | 2468.0 samples/s | 38.6 steps/s
[Step=26800 Epoch=254.0] | Loss=0.00191 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.115 | L2-Norm(final)=16.459 | 5457.2 samples/s | 85.3 steps/s
[Step=26850 Epoch=254.4] | Loss=0.00164 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.109 | L2-Norm(final)=16.459 | 2568.0 samples/s | 40.1 steps/s
[Step=26900 Epoch=254.9] | Loss=0.00143 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.101 | L2-Norm(final)=16.460 | 5016.6 samples/s | 78.4 steps/s
[Step=26950 Epoch=255.4] | Loss=0.00128 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.092 | L2-Norm(final)=16.460 | 2732.1 samples/s | 42.7 steps/s
[Step=27000 Epoch=255.8] | Loss=0.00115 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.082 | L2-Norm(final)=16.461 | 4568.8 samples/s | 71.4 steps/s
[Step=27050 Epoch=256.3] | Loss=0.00104 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.071 | L2-Norm(final)=16.461 | 2790.2 samples/s | 43.6 steps/s
[Step=27100 Epoch=256.8] | Loss=0.00096 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.061 | L2-Norm(final)=16.462 | 4561.8 samples/s | 71.3 steps/s
[Step=27150 Epoch=257.3] | Loss=0.00088 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.049 | L2-Norm(final)=16.462 | 2850.3 samples/s | 44.5 steps/s
[Step=27200 Epoch=257.7] | Loss=0.00082 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.038 | L2-Norm(final)=16.463 | 4578.2 samples/s | 71.5 steps/s
[Step=27250 Epoch=258.2] | Loss=0.00077 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.027 | L2-Norm(final)=16.464 | 2899.7 samples/s | 45.3 steps/s
[Step=27300 Epoch=258.7] | Loss=0.00072 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.015 | L2-Norm(final)=16.464 | 4432.1 samples/s | 69.3 steps/s
[Step=27350 Epoch=259.2] | Loss=0.00068 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.004 | L2-Norm(final)=16.465 | 2879.8 samples/s | 45.0 steps/s
[Step=27400 Epoch=259.6] | Loss=0.00064 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.993 | L2-Norm(final)=16.465 | 4442.8 samples/s | 69.4 steps/s
[Step=27450 Epoch=260.1] | Loss=0.00061 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.981 | L2-Norm(final)=16.466 | 6813.9 samples/s | 106.5 steps/s
[Step=27500 Epoch=260.6] | Loss=0.00058 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.970 | L2-Norm(final)=16.466 | 2376.5 samples/s | 37.1 steps/s
[Step=27550 Epoch=261.1] | Loss=0.00055 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.958 | L2-Norm(final)=16.467 | 6083.8 samples/s | 95.1 steps/s
[Step=27600 Epoch=261.5] | Loss=0.00052 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.947 | L2-Norm(final)=16.467 | 2477.2 samples/s | 38.7 steps/s
[Step=27650 Epoch=262.0] | Loss=0.00050 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.936 | L2-Norm(final)=16.468 | 5435.9 samples/s | 84.9 steps/s
[Step=27700 Epoch=262.5] | Loss=0.00048 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.924 | L2-Norm(final)=16.469 | 2545.7 samples/s | 39.8 steps/s
[Step=27750 Epoch=263.0] | Loss=0.00046 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.913 | L2-Norm(final)=16.469 | 5198.7 samples/s | 81.2 steps/s
[Step=27800 Epoch=263.4] | Loss=0.00044 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.901 | L2-Norm(final)=16.470 | 2657.2 samples/s | 41.5 steps/s
[Step=27850 Epoch=263.9] | Loss=0.00043 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.890 | L2-Norm(final)=16.470 | 4732.9 samples/s | 74.0 steps/s
[Step=27900 Epoch=264.4] | Loss=0.00041 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.879 | L2-Norm(final)=16.470 | 2780.6 samples/s | 43.4 steps/s
[Step=27950 Epoch=264.9] | Loss=0.00040 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.867 | L2-Norm(final)=16.471 | 4473.4 samples/s | 69.9 steps/s
[Step=28000 Epoch=265.3] | Loss=0.00038 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.856 | L2-Norm(final)=16.471 | 2896.1 samples/s | 45.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step28000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=133.2] | Loss=0.00067 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.796 | L2-Norm(final)=12.543 | 6164.2 samples/s | 96.3 steps/s
[Step=14050 Epoch=133.7] | Loss=0.00571 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.792 | L2-Norm(final)=12.560 | 4868.6 samples/s | 76.1 steps/s
[Step=14100 Epoch=134.1] | Loss=0.00645 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=12.579 | 8149.9 samples/s | 127.3 steps/s
[Step=14150 Epoch=134.6] | Loss=0.00653 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.791 | L2-Norm(final)=12.592 | 2606.1 samples/s | 40.7 steps/s
[Step=14200 Epoch=135.1] | Loss=0.00642 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.791 | L2-Norm(final)=12.601 | 7034.8 samples/s | 109.9 steps/s
[Step=14250 Epoch=135.6] | Loss=0.00603 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=12.613 | 2676.9 samples/s | 41.8 steps/s
[Step=14300 Epoch=136.0] | Loss=0.00617 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=12.625 | 6647.6 samples/s | 103.9 steps/s
[Step=14350 Epoch=136.5] | Loss=0.00609 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=12.637 | 2821.3 samples/s | 44.1 steps/s
[Step=14400 Epoch=137.0] | Loss=0.00604 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=12.649 | 5859.9 samples/s | 91.6 steps/s
[Step=14450 Epoch=137.5] | Loss=0.00601 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.791 | L2-Norm(final)=12.661 | 2913.3 samples/s | 45.5 steps/s
[Step=14500 Epoch=137.9] | Loss=0.00591 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=12.673 | 5455.0 samples/s | 85.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=137.9] | Loss=0.00020 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=12.794 | 7105.9 samples/s | 111.0 steps/s
[Step=14550 Epoch=138.4] | Loss=0.00645 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.999 | L2-Norm(final)=12.799 | 4013.2 samples/s | 62.7 steps/s
[Step=14600 Epoch=138.9] | Loss=0.00532 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=12.794 | 6592.7 samples/s | 103.0 steps/s
[Step=14650 Epoch=139.4] | Loss=0.00368 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.190 | L2-Norm(final)=12.792 | 2377.3 samples/s | 37.1 steps/s
[Step=14700 Epoch=139.8] | Loss=0.00278 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=12.793 | 5986.1 samples/s | 93.5 steps/s
[Step=14750 Epoch=140.3] | Loss=0.00223 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=12.794 | 2473.9 samples/s | 38.7 steps/s
[Step=14800 Epoch=140.8] | Loss=0.00186 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.214 | L2-Norm(final)=12.795 | 5431.0 samples/s | 84.9 steps/s
[Step=14850 Epoch=141.3] | Loss=0.00159 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.206 | L2-Norm(final)=12.795 | 2621.1 samples/s | 41.0 steps/s
[Step=14900 Epoch=141.7] | Loss=0.00140 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.196 | L2-Norm(final)=12.796 | 4892.9 samples/s | 76.5 steps/s
[Step=14950 Epoch=142.2] | Loss=0.00124 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=12.797 | 2506.2 samples/s | 39.2 steps/s
[Step=15000 Epoch=142.7] | Loss=0.00112 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=12.797 | 4629.9 samples/s | 72.3 steps/s
[Step=15050 Epoch=143.2] | Loss=0.00102 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=12.798 | 2810.1 samples/s | 43.9 steps/s
[Step=15100 Epoch=143.6] | Loss=0.00093 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=12.798 | 4584.1 samples/s | 71.6 steps/s
[Step=15150 Epoch=144.1] | Loss=0.00086 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=12.799 | 2860.6 samples/s | 44.7 steps/s
[Step=15200 Epoch=144.6] | Loss=0.00080 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.114 | L2-Norm(final)=12.799 | 4434.6 samples/s | 69.3 steps/s
[Step=15250 Epoch=145.1] | Loss=0.00075 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.099 | L2-Norm(final)=12.800 | 2862.4 samples/s | 44.7 steps/s
[Step=15300 Epoch=145.5] | Loss=0.00070 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.084 | L2-Norm(final)=12.800 | 4484.5 samples/s | 70.1 steps/s
[Step=15350 Epoch=146.0] | Loss=0.00066 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.069 | L2-Norm(final)=12.801 | 2949.0 samples/s | 46.1 steps/s
[Step=15400 Epoch=146.5] | Loss=0.00062 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.054 | L2-Norm(final)=12.801 | 4263.3 samples/s | 66.6 steps/s
[Step=15450 Epoch=147.0] | Loss=0.00059 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.039 | L2-Norm(final)=12.802 | 6886.2 samples/s | 107.6 steps/s
[Step=15500 Epoch=147.4] | Loss=0.00056 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.024 | L2-Norm(final)=12.802 | 2357.0 samples/s | 36.8 steps/s
[Step=15550 Epoch=147.9] | Loss=0.00053 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.009 | L2-Norm(final)=12.803 | 6222.2 samples/s | 97.2 steps/s
[Step=15600 Epoch=148.4] | Loss=0.00051 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.994 | L2-Norm(final)=12.803 | 2439.3 samples/s | 38.1 steps/s
[Step=15650 Epoch=148.9] | Loss=0.00049 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.979 | L2-Norm(final)=12.803 | 5638.0 samples/s | 88.1 steps/s
[Step=15700 Epoch=149.3] | Loss=0.00047 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.963 | L2-Norm(final)=12.804 | 2563.7 samples/s | 40.1 steps/s
[Step=15750 Epoch=149.8] | Loss=0.00045 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.948 | L2-Norm(final)=12.804 | 5207.9 samples/s | 81.4 steps/s
[Step=15800 Epoch=150.3] | Loss=0.00043 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.933 | L2-Norm(final)=12.805 | 2673.5 samples/s | 41.8 steps/s
[Step=15850 Epoch=150.8] | Loss=0.00042 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.918 | L2-Norm(final)=12.805 | 4774.0 samples/s | 74.6 steps/s
[Step=15900 Epoch=151.2] | Loss=0.00040 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=12.805 | 2765.0 samples/s | 43.2 steps/s
[Step=15950 Epoch=151.7] | Loss=0.00039 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.888 | L2-Norm(final)=12.806 | 4634.3 samples/s | 72.4 steps/s
[Step=16000 Epoch=152.2] | Loss=0.00038 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.873 | L2-Norm(final)=12.806 | 2809.8 samples/s | 43.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step16000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=133.7] | Loss=0.00612 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.796 | L2-Norm(final)=10.838 | 6091.5 samples/s | 95.2 steps/s
[Step=14050 Epoch=134.2] | Loss=0.00269 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.792 | L2-Norm(final)=10.876 | 4898.4 samples/s | 76.5 steps/s
[Step=14100 Epoch=134.6] | Loss=0.00213 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=10.921 | 8304.6 samples/s | 129.8 steps/s
[Step=14150 Epoch=135.1] | Loss=0.00206 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=10.963 | 2554.6 samples/s | 39.9 steps/s
[Step=14200 Epoch=135.6] | Loss=0.00222 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=11.004 | 7536.0 samples/s | 117.8 steps/s
[Step=14250 Epoch=136.1] | Loss=0.00214 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=11.046 | 2702.2 samples/s | 42.2 steps/s
[Step=14300 Epoch=136.6] | Loss=0.00213 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=11.086 | 6474.7 samples/s | 101.2 steps/s
[Step=14350 Epoch=137.0] | Loss=0.00203 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=11.124 | 2721.6 samples/s | 42.5 steps/s
[Step=14400 Epoch=137.5] | Loss=0.00206 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=11.161 | 6334.3 samples/s | 99.0 steps/s
[Step=14450 Epoch=138.0] | Loss=0.00209 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=11.198 | 2859.4 samples/s | 44.7 steps/s
[Step=14500 Epoch=138.5] | Loss=0.00205 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=11.234 | 5688.8 samples/s | 88.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=138.5] | Loss=0.00193 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=11.591 | 6744.0 samples/s | 105.4 steps/s
[Step=14550 Epoch=138.9] | Loss=0.00074 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.819 | L2-Norm(final)=11.613 | 4210.6 samples/s | 65.8 steps/s
[Step=14600 Epoch=139.4] | Loss=0.00048 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.809 | L2-Norm(final)=11.622 | 6452.7 samples/s | 100.8 steps/s
[Step=14650 Epoch=139.9] | Loss=0.00034 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.796 | L2-Norm(final)=11.629 | 2373.0 samples/s | 37.1 steps/s
[Step=14700 Epoch=140.4] | Loss=0.00026 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.775 | L2-Norm(final)=11.634 | 6115.5 samples/s | 95.6 steps/s
[Step=14750 Epoch=140.9] | Loss=0.00021 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.753 | L2-Norm(final)=11.637 | 2475.8 samples/s | 38.7 steps/s
[Step=14800 Epoch=141.3] | Loss=0.00018 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.730 | L2-Norm(final)=11.640 | 5533.7 samples/s | 86.5 steps/s
[Step=14850 Epoch=141.8] | Loss=0.00015 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.706 | L2-Norm(final)=11.642 | 2523.6 samples/s | 39.4 steps/s
[Step=14900 Epoch=142.3] | Loss=0.00013 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=11.643 | 5197.7 samples/s | 81.2 steps/s
[Step=14950 Epoch=142.8] | Loss=0.00012 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.658 | L2-Norm(final)=11.644 | 2658.6 samples/s | 41.5 steps/s
[Step=15000 Epoch=143.2] | Loss=0.00011 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.635 | L2-Norm(final)=11.646 | 4784.8 samples/s | 74.8 steps/s
[Step=15050 Epoch=143.7] | Loss=0.00010 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.612 | L2-Norm(final)=11.646 | 2720.2 samples/s | 42.5 steps/s
[Step=15100 Epoch=144.2] | Loss=0.00009 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.589 | L2-Norm(final)=11.647 | 4649.5 samples/s | 72.6 steps/s
[Step=15150 Epoch=144.7] | Loss=0.00008 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.567 | L2-Norm(final)=11.648 | 2841.4 samples/s | 44.4 steps/s
[Step=15200 Epoch=145.2] | Loss=0.00008 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.544 | L2-Norm(final)=11.649 | 4472.6 samples/s | 69.9 steps/s
[Step=15250 Epoch=145.6] | Loss=0.00007 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.523 | L2-Norm(final)=11.650 | 2905.4 samples/s | 45.4 steps/s
[Step=15300 Epoch=146.1] | Loss=0.00007 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.501 | L2-Norm(final)=11.650 | 4383.9 samples/s | 68.5 steps/s
[Step=15350 Epoch=146.6] | Loss=0.00006 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.480 | L2-Norm(final)=11.651 | 2863.8 samples/s | 44.7 steps/s
[Step=15400 Epoch=147.1] | Loss=0.00006 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.458 | L2-Norm(final)=11.651 | 4458.1 samples/s | 69.7 steps/s
[Step=15450 Epoch=147.5] | Loss=0.00006 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.438 | L2-Norm(final)=11.652 | 2856.0 samples/s | 44.6 steps/s
[Step=15500 Epoch=148.0] | Loss=0.00006 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.417 | L2-Norm(final)=11.653 | 4566.1 samples/s | 71.3 steps/s
[Step=15550 Epoch=148.5] | Loss=0.00005 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.396 | L2-Norm(final)=11.653 | 7325.2 samples/s | 114.5 steps/s
[Step=15600 Epoch=149.0] | Loss=0.00005 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.376 | L2-Norm(final)=11.654 | 2318.5 samples/s | 36.2 steps/s
[Step=15650 Epoch=149.4] | Loss=0.00005 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=11.654 | 6630.1 samples/s | 103.6 steps/s
[Step=15700 Epoch=149.9] | Loss=0.00005 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.335 | L2-Norm(final)=11.655 | 2384.9 samples/s | 37.3 steps/s
[Step=15750 Epoch=150.4] | Loss=0.00004 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=11.655 | 6099.1 samples/s | 95.3 steps/s
[Step=15800 Epoch=150.9] | Loss=0.00004 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.295 | L2-Norm(final)=11.656 | 2448.2 samples/s | 38.3 steps/s
[Step=15850 Epoch=151.4] | Loss=0.00004 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.275 | L2-Norm(final)=11.656 | 5732.7 samples/s | 89.6 steps/s
[Step=15900 Epoch=151.8] | Loss=0.00004 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.255 | L2-Norm(final)=11.657 | 2526.7 samples/s | 39.5 steps/s
[Step=15950 Epoch=152.3] | Loss=0.00004 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.236 | L2-Norm(final)=11.657 | 5328.0 samples/s | 83.2 steps/s
[Step=16000 Epoch=152.8] | Loss=0.00004 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.216 | L2-Norm(final)=11.658 | 2631.1 samples/s | 41.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step16000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=169.6] | Loss=0.00111 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.796 | L2-Norm(final)=13.047 | 6597.2 samples/s | 103.1 steps/s
[Step=18050 Epoch=170.1] | Loss=0.00462 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.792 | L2-Norm(final)=13.073 | 4623.1 samples/s | 72.2 steps/s
[Step=18100 Epoch=170.6] | Loss=0.00522 | Reg=0.00139 | acc=0.9688 | L2-Norm=11.791 | L2-Norm(final)=13.105 | 8231.1 samples/s | 128.6 steps/s
[Step=18150 Epoch=171.0] | Loss=0.00526 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.791 | L2-Norm(final)=13.135 | 2581.7 samples/s | 40.3 steps/s
[Step=18200 Epoch=171.5] | Loss=0.00538 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.791 | L2-Norm(final)=13.165 | 7060.1 samples/s | 110.3 steps/s
[Step=18250 Epoch=172.0] | Loss=0.00540 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=13.195 | 2748.3 samples/s | 42.9 steps/s
[Step=18300 Epoch=172.4] | Loss=0.00538 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.791 | L2-Norm(final)=13.225 | 6187.5 samples/s | 96.7 steps/s
[Step=18350 Epoch=172.9] | Loss=0.00534 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=13.254 | 2960.0 samples/s | 46.3 steps/s
[Step=18400 Epoch=173.4] | Loss=0.00529 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.791 | L2-Norm(final)=13.282 | 5245.1 samples/s | 82.0 steps/s
[Step=18450 Epoch=173.9] | Loss=0.00514 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=13.309 | 3031.4 samples/s | 47.4 steps/s
[Step=18500 Epoch=174.3] | Loss=0.00504 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=13.338 | 5346.7 samples/s | 83.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=174.3] | Loss=0.00250 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=13.613 | 7219.1 samples/s | 112.8 steps/s
[Step=18550 Epoch=174.8] | Loss=0.01572 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.963 | L2-Norm(final)=13.597 | 3917.3 samples/s | 61.2 steps/s
[Step=18600 Epoch=175.3] | Loss=0.01118 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=13.566 | 6555.6 samples/s | 102.4 steps/s
[Step=18650 Epoch=175.7] | Loss=0.00758 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.206 | L2-Norm(final)=13.558 | 2407.5 samples/s | 37.6 steps/s
[Step=18700 Epoch=176.2] | Loss=0.00614 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=13.556 | 5723.7 samples/s | 89.4 steps/s
[Step=18750 Epoch=176.7] | Loss=0.00493 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=13.555 | 2519.6 samples/s | 39.4 steps/s
[Step=18800 Epoch=177.1] | Loss=0.00412 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=13.556 | 5284.1 samples/s | 82.6 steps/s
[Step=18850 Epoch=177.6] | Loss=0.00353 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=13.557 | 2697.9 samples/s | 42.2 steps/s
[Step=18900 Epoch=178.1] | Loss=0.00310 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=13.558 | 4638.8 samples/s | 72.5 steps/s
[Step=18950 Epoch=178.6] | Loss=0.00275 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=13.559 | 2776.3 samples/s | 43.4 steps/s
[Step=19000 Epoch=179.0] | Loss=0.00248 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=13.561 | 4603.8 samples/s | 71.9 steps/s
[Step=19050 Epoch=179.5] | Loss=0.00226 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.196 | L2-Norm(final)=13.562 | 2841.7 samples/s | 44.4 steps/s
[Step=19100 Epoch=180.0] | Loss=0.00207 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=13.563 | 4575.9 samples/s | 71.5 steps/s
[Step=19150 Epoch=180.4] | Loss=0.00191 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=13.564 | 2868.8 samples/s | 44.8 steps/s
[Step=19200 Epoch=180.9] | Loss=0.00178 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=13.565 | 4523.1 samples/s | 70.7 steps/s
[Step=19250 Epoch=181.4] | Loss=0.00166 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=13.566 | 3190.4 samples/s | 49.9 steps/s
[Step=19300 Epoch=181.9] | Loss=0.00155 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.131 | L2-Norm(final)=13.567 | 3929.8 samples/s | 61.4 steps/s
[Step=19350 Epoch=182.3] | Loss=0.00146 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=13.568 | 6564.3 samples/s | 102.6 steps/s
[Step=19400 Epoch=182.8] | Loss=0.00138 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=13.569 | 2391.2 samples/s | 37.4 steps/s
[Step=19450 Epoch=183.3] | Loss=0.00131 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.091 | L2-Norm(final)=13.571 | 5911.0 samples/s | 92.4 steps/s
[Step=19500 Epoch=183.7] | Loss=0.00125 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.077 | L2-Norm(final)=13.572 | 2272.6 samples/s | 35.5 steps/s
[Step=19550 Epoch=184.2] | Loss=0.00119 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.063 | L2-Norm(final)=13.573 | 5375.0 samples/s | 84.0 steps/s
[Step=19600 Epoch=184.7] | Loss=0.00113 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.050 | L2-Norm(final)=13.574 | 2606.5 samples/s | 40.7 steps/s
[Step=19650 Epoch=185.2] | Loss=0.00108 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.036 | L2-Norm(final)=13.575 | 4855.3 samples/s | 75.9 steps/s
[Step=19700 Epoch=185.6] | Loss=0.00104 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.023 | L2-Norm(final)=13.576 | 2749.9 samples/s | 43.0 steps/s
[Step=19750 Epoch=186.1] | Loss=0.00100 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.009 | L2-Norm(final)=13.578 | 4540.6 samples/s | 70.9 steps/s
[Step=19800 Epoch=186.6] | Loss=0.00096 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.995 | L2-Norm(final)=13.579 | 2859.9 samples/s | 44.7 steps/s
[Step=19850 Epoch=187.0] | Loss=0.00092 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.982 | L2-Norm(final)=13.580 | 4640.4 samples/s | 72.5 steps/s
[Step=19900 Epoch=187.5] | Loss=0.00089 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.968 | L2-Norm(final)=13.581 | 2845.1 samples/s | 44.5 steps/s
[Step=19950 Epoch=188.0] | Loss=0.00086 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.954 | L2-Norm(final)=13.582 | 4483.5 samples/s | 70.1 steps/s
[Step=20000 Epoch=188.5] | Loss=0.00083 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.941 | L2-Norm(final)=13.584 | 2918.6 samples/s | 45.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10394 | acc=0.9549 | tpr=0.9707 | fpr=0.0793 | 5904.7 samples/s | 23.1 steps/s
Avg test loss: 0.11508, Avg test acc: 0.95064, Avg tpr: 0.96765, Avg fpr: 0.08678, total FA: 677

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.11817 | acc=0.9507 | tpr=0.9622 | fpr=0.0743 | 6068.3 samples/s | 23.7 steps/s
Avg test loss: 0.12406, Avg test acc: 0.94839, Avg tpr: 0.96060, Avg fpr: 0.07845, total FA: 612

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11141 | acc=0.9500 | tpr=0.9744 | fpr=0.1031 | 5971.5 samples/s | 23.3 steps/s
Avg test loss: 0.11265, Avg test acc: 0.94960, Avg tpr: 0.97319, Avg fpr: 0.10229, total FA: 798

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10846 | acc=0.9530 | tpr=0.9612 | fpr=0.0649 | 5922.2 samples/s | 23.1 steps/s
Avg test loss: 0.11939, Avg test acc: 0.94923, Avg tpr: 0.95803, Avg fpr: 0.07012, total FA: 547

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.12772 | acc=0.9494 | tpr=0.9683 | fpr=0.0917 | 5935.9 samples/s | 23.2 steps/s
Avg test loss: 0.13083, Avg test acc: 0.94799, Avg tpr: 0.96666, Avg fpr: 0.09306, total FA: 726

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.12953 | acc=0.3070 | tpr=0.0224 | fpr=0.0748 | 5976.1 samples/s | 23.3 steps/s
Avg test loss: 6.13401, Avg test acc: 0.30435, Avg tpr: 0.02157, Avg fpr: 0.07371, total FA: 575

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.31999 | acc=0.3158 | tpr=0.0107 | fpr=0.0218 | 5745.9 samples/s | 22.4 steps/s
Avg test loss: 5.33256, Avg test acc: 0.31289, Avg tpr: 0.01072, Avg fpr: 0.02256, total FA: 176

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.12105 | acc=0.2997 | tpr=0.0131 | fpr=0.0780 | 5814.3 samples/s | 22.7 steps/s
Avg test loss: 5.14095, Avg test acc: 0.29746, Avg tpr: 0.01323, Avg fpr: 0.07743, total FA: 604

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.73257 | acc=0.2964 | tpr=0.0278 | fpr=0.1204 | 5965.6 samples/s | 23.3 steps/s
Avg test loss: 4.73846, Avg test acc: 0.29405, Avg tpr: 0.02704, Avg fpr: 0.11870, total FA: 926

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.54734 | acc=0.3061 | tpr=0.0163 | fpr=0.0647 | 6150.6 samples/s | 24.0 steps/s
Avg test loss: 5.57382, Avg test acc: 0.30487, Avg tpr: 0.01626, Avg fpr: 0.06038, total FA: 471

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.96854 | acc=0.1308 | tpr=0.7389 | fpr=0.8801 | 6033.0 samples/s | 23.6 steps/s
[Step= 100] | Loss=5.94230 | acc=0.1333 | tpr=0.7143 | fpr=0.8776 | 7664.0 samples/s | 29.9 steps/s
[Step= 150] | Loss=5.93543 | acc=0.1341 | tpr=0.7262 | fpr=0.8768 | 7593.5 samples/s | 29.7 steps/s
[Step= 200] | Loss=5.92761 | acc=0.1349 | tpr=0.7246 | fpr=0.8758 | 7850.8 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.93450 | acc=0.1348 | tpr=0.7135 | fpr=0.8758 | 8307.3 samples/s | 32.5 steps/s
[Step= 300] | Loss=5.92690 | acc=0.1345 | tpr=0.7127 | fpr=0.8760 | 8217.0 samples/s | 32.1 steps/s
[Step= 350] | Loss=5.93042 | acc=0.1344 | tpr=0.7170 | fpr=0.8762 | 8179.2 samples/s | 32.0 steps/s
[Step= 400] | Loss=5.92806 | acc=0.1347 | tpr=0.7133 | fpr=0.8759 | 8123.9 samples/s | 31.7 steps/s
[Step= 450] | Loss=5.93250 | acc=0.1340 | tpr=0.7162 | fpr=0.8765 | 8270.5 samples/s | 32.3 steps/s
[Step= 500] | Loss=5.93111 | acc=0.1343 | tpr=0.7207 | fpr=0.8763 | 8072.7 samples/s | 31.5 steps/s
[Step= 550] | Loss=5.93290 | acc=0.1343 | tpr=0.7230 | fpr=0.8764 | 9732.0 samples/s | 38.0 steps/s
Avg test loss: 5.93360, Avg test acc: 0.13430, Avg tpr: 0.72385, Avg fpr: 0.87642, total FA: 121689

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.70404 | acc=0.1384 | tpr=0.5752 | fpr=0.8695 | 5860.7 samples/s | 22.9 steps/s
[Step= 100] | Loss=4.68895 | acc=0.1410 | tpr=0.6034 | fpr=0.8676 | 7966.0 samples/s | 31.1 steps/s
[Step= 150] | Loss=4.67944 | acc=0.1435 | tpr=0.6167 | fpr=0.8652 | 7514.4 samples/s | 29.4 steps/s
[Step= 200] | Loss=4.68535 | acc=0.1436 | tpr=0.6109 | fpr=0.8649 | 8088.8 samples/s | 31.6 steps/s
[Step= 250] | Loss=4.68838 | acc=0.1433 | tpr=0.6061 | fpr=0.8651 | 7398.7 samples/s | 28.9 steps/s
[Step= 300] | Loss=4.68549 | acc=0.1433 | tpr=0.6007 | fpr=0.8650 | 8229.2 samples/s | 32.1 steps/s
[Step= 350] | Loss=4.69306 | acc=0.1432 | tpr=0.6036 | fpr=0.8652 | 8473.5 samples/s | 33.1 steps/s
[Step= 400] | Loss=4.69084 | acc=0.1436 | tpr=0.6028 | fpr=0.8648 | 7692.7 samples/s | 30.0 steps/s
[Step= 450] | Loss=4.69431 | acc=0.1433 | tpr=0.6081 | fpr=0.8652 | 8446.9 samples/s | 33.0 steps/s
[Step= 500] | Loss=4.69727 | acc=0.1431 | tpr=0.6123 | fpr=0.8653 | 8233.7 samples/s | 32.2 steps/s
[Step= 550] | Loss=4.70077 | acc=0.1433 | tpr=0.6140 | fpr=0.8653 | 11150.7 samples/s | 43.6 steps/s
Avg test loss: 4.70138, Avg test acc: 0.14311, Avg tpr: 0.61529, Avg fpr: 0.86547, total FA: 120169

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.75191 | acc=0.1116 | tpr=0.7522 | fpr=0.9000 | 6056.0 samples/s | 23.7 steps/s
[Step= 100] | Loss=5.73705 | acc=0.1121 | tpr=0.7527 | fpr=0.8998 | 7812.1 samples/s | 30.5 steps/s
[Step= 150] | Loss=5.73246 | acc=0.1138 | tpr=0.7493 | fpr=0.8979 | 7700.7 samples/s | 30.1 steps/s
[Step= 200] | Loss=5.72792 | acc=0.1140 | tpr=0.7410 | fpr=0.8974 | 8164.3 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.73226 | acc=0.1143 | tpr=0.7406 | fpr=0.8971 | 7888.6 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.73034 | acc=0.1139 | tpr=0.7382 | fpr=0.8974 | 8169.6 samples/s | 31.9 steps/s
[Step= 350] | Loss=5.73647 | acc=0.1137 | tpr=0.7389 | fpr=0.8976 | 7578.3 samples/s | 29.6 steps/s
[Step= 400] | Loss=5.73395 | acc=0.1139 | tpr=0.7412 | fpr=0.8975 | 8783.9 samples/s | 34.3 steps/s
[Step= 450] | Loss=5.73875 | acc=0.1132 | tpr=0.7444 | fpr=0.8982 | 8466.0 samples/s | 33.1 steps/s
[Step= 500] | Loss=5.73693 | acc=0.1131 | tpr=0.7449 | fpr=0.8983 | 7949.6 samples/s | 31.1 steps/s
[Step= 550] | Loss=5.74165 | acc=0.1132 | tpr=0.7441 | fpr=0.8983 | 9770.3 samples/s | 38.2 steps/s
Avg test loss: 5.74189, Avg test acc: 0.11305, Avg tpr: 0.74445, Avg fpr: 0.89843, total FA: 124745

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.13132 | acc=0.1426 | tpr=0.6106 | fpr=0.8658 | 6083.6 samples/s | 23.8 steps/s
[Step= 100] | Loss=5.11608 | acc=0.1452 | tpr=0.6333 | fpr=0.8639 | 7600.7 samples/s | 29.7 steps/s
[Step= 150] | Loss=5.10841 | acc=0.1478 | tpr=0.6455 | fpr=0.8614 | 7580.0 samples/s | 29.6 steps/s
[Step= 200] | Loss=5.10525 | acc=0.1487 | tpr=0.6481 | fpr=0.8604 | 7342.9 samples/s | 28.7 steps/s
[Step= 250] | Loss=5.10786 | acc=0.1486 | tpr=0.6498 | fpr=0.8605 | 8655.0 samples/s | 33.8 steps/s
[Step= 300] | Loss=5.10154 | acc=0.1488 | tpr=0.6444 | fpr=0.8602 | 7721.9 samples/s | 30.2 steps/s
[Step= 350] | Loss=5.10503 | acc=0.1487 | tpr=0.6462 | fpr=0.8603 | 7967.0 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.10008 | acc=0.1493 | tpr=0.6450 | fpr=0.8597 | 8254.1 samples/s | 32.2 steps/s
[Step= 450] | Loss=5.10211 | acc=0.1489 | tpr=0.6470 | fpr=0.8601 | 8776.6 samples/s | 34.3 steps/s
[Step= 500] | Loss=5.10137 | acc=0.1490 | tpr=0.6542 | fpr=0.8601 | 8124.8 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.10793 | acc=0.1490 | tpr=0.6542 | fpr=0.8601 | 10299.4 samples/s | 40.2 steps/s
Avg test loss: 5.10895, Avg test acc: 0.14899, Avg tpr: 0.65452, Avg fpr: 0.86020, total FA: 119437

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.71595 | acc=0.1283 | tpr=0.6681 | fpr=0.8814 | 5974.2 samples/s | 23.3 steps/s
[Step= 100] | Loss=5.70721 | acc=0.1320 | tpr=0.6439 | fpr=0.8776 | 7866.7 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.70269 | acc=0.1347 | tpr=0.6556 | fpr=0.8748 | 7829.5 samples/s | 30.6 steps/s
[Step= 200] | Loss=5.70622 | acc=0.1352 | tpr=0.6590 | fpr=0.8744 | 7503.9 samples/s | 29.3 steps/s
[Step= 250] | Loss=5.71006 | acc=0.1350 | tpr=0.6559 | fpr=0.8745 | 8700.2 samples/s | 34.0 steps/s
[Step= 300] | Loss=5.70384 | acc=0.1352 | tpr=0.6575 | fpr=0.8743 | 8547.3 samples/s | 33.4 steps/s
[Step= 350] | Loss=5.71223 | acc=0.1349 | tpr=0.6537 | fpr=0.8745 | 8281.1 samples/s | 32.3 steps/s
[Step= 400] | Loss=5.71195 | acc=0.1351 | tpr=0.6510 | fpr=0.8743 | 7802.6 samples/s | 30.5 steps/s
[Step= 450] | Loss=5.71734 | acc=0.1344 | tpr=0.6534 | fpr=0.8750 | 7459.1 samples/s | 29.1 steps/s
[Step= 500] | Loss=5.71594 | acc=0.1345 | tpr=0.6551 | fpr=0.8749 | 8222.8 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.71995 | acc=0.1347 | tpr=0.6578 | fpr=0.8748 | 10159.2 samples/s | 39.7 steps/s
Avg test loss: 5.72078, Avg test acc: 0.13471, Avg tpr: 0.65887, Avg fpr: 0.87482, total FA: 121467

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.22972 | acc=0.9510 | tpr=0.9159 | fpr=0.0484 | 5975.7 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.23890 | acc=0.9507 | tpr=0.9318 | fpr=0.0490 | 8220.0 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.24372 | acc=0.9495 | tpr=0.9323 | fpr=0.0502 | 7205.4 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.24245 | acc=0.9496 | tpr=0.9388 | fpr=0.0502 | 8302.0 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.24427 | acc=0.9495 | tpr=0.9362 | fpr=0.0503 | 8063.4 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.24685 | acc=0.9491 | tpr=0.9324 | fpr=0.0506 | 7963.7 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.24640 | acc=0.9493 | tpr=0.9317 | fpr=0.0504 | 8071.1 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.24593 | acc=0.9491 | tpr=0.9283 | fpr=0.0505 | 8056.7 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.24968 | acc=0.9487 | tpr=0.9260 | fpr=0.0509 | 7992.6 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.24954 | acc=0.9485 | tpr=0.9273 | fpr=0.0511 | 8518.5 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.24735 | acc=0.9487 | tpr=0.9280 | fpr=0.0509 | 9962.8 samples/s | 38.9 steps/s
Avg test loss: 0.24687, Avg test acc: 0.94875, Avg tpr: 0.92789, Avg fpr: 0.05088, total FA: 7064

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16940 | acc=0.9605 | tpr=0.8761 | fpr=0.0379 | 6055.7 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.17180 | acc=0.9607 | tpr=0.9104 | fpr=0.0384 | 8205.8 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.17446 | acc=0.9596 | tpr=0.9222 | fpr=0.0397 | 7985.9 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.17462 | acc=0.9595 | tpr=0.9169 | fpr=0.0398 | 8108.2 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.17512 | acc=0.9593 | tpr=0.9135 | fpr=0.0399 | 7836.6 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.17739 | acc=0.9589 | tpr=0.9113 | fpr=0.0403 | 8423.3 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.17677 | acc=0.9589 | tpr=0.9111 | fpr=0.0403 | 7428.9 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.17646 | acc=0.9588 | tpr=0.9081 | fpr=0.0403 | 8278.0 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.17958 | acc=0.9583 | tpr=0.9060 | fpr=0.0407 | 7503.1 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.17899 | acc=0.9584 | tpr=0.9075 | fpr=0.0407 | 8098.6 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.17780 | acc=0.9587 | tpr=0.9053 | fpr=0.0404 | 10502.6 samples/s | 41.0 steps/s
Avg test loss: 0.17762, Avg test acc: 0.95869, Avg tpr: 0.90531, Avg fpr: 0.04034, total FA: 5601

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.29353 | acc=0.9480 | tpr=0.9336 | fpr=0.0517 | 6006.7 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.30207 | acc=0.9468 | tpr=0.9446 | fpr=0.0531 | 7531.9 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.30840 | acc=0.9453 | tpr=0.9467 | fpr=0.0548 | 7739.4 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.30827 | acc=0.9454 | tpr=0.9519 | fpr=0.0548 | 8495.7 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.30908 | acc=0.9450 | tpr=0.9502 | fpr=0.0551 | 7459.9 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.31213 | acc=0.9448 | tpr=0.9455 | fpr=0.0553 | 7814.8 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.31023 | acc=0.9447 | tpr=0.9461 | fpr=0.0554 | 8574.2 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.31082 | acc=0.9443 | tpr=0.9415 | fpr=0.0556 | 8276.8 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.31499 | acc=0.9439 | tpr=0.9406 | fpr=0.0561 | 8099.9 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.31562 | acc=0.9438 | tpr=0.9423 | fpr=0.0562 | 8155.3 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.31383 | acc=0.9441 | tpr=0.9419 | fpr=0.0559 | 10629.9 samples/s | 41.5 steps/s
Avg test loss: 0.31340, Avg test acc: 0.94411, Avg tpr: 0.94176, Avg fpr: 0.05585, total FA: 7754

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11461 | acc=0.9670 | tpr=0.9115 | fpr=0.0321 | 5871.1 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.11825 | acc=0.9660 | tpr=0.9147 | fpr=0.0331 | 8226.2 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.11766 | acc=0.9654 | tpr=0.9207 | fpr=0.0338 | 8035.6 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.11778 | acc=0.9655 | tpr=0.9202 | fpr=0.0337 | 8038.4 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.11927 | acc=0.9655 | tpr=0.9153 | fpr=0.0336 | 7764.1 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.12114 | acc=0.9651 | tpr=0.9127 | fpr=0.0340 | 8406.7 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.12054 | acc=0.9652 | tpr=0.9173 | fpr=0.0339 | 8239.9 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.12019 | acc=0.9650 | tpr=0.9141 | fpr=0.0341 | 7749.0 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.12209 | acc=0.9647 | tpr=0.9153 | fpr=0.0344 | 7542.4 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.12218 | acc=0.9646 | tpr=0.9181 | fpr=0.0346 | 8739.9 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.12184 | acc=0.9648 | tpr=0.9176 | fpr=0.0344 | 9498.7 samples/s | 37.1 steps/s
Avg test loss: 0.12159, Avg test acc: 0.96482, Avg tpr: 0.91759, Avg fpr: 0.03433, total FA: 4766

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21660 | acc=0.9580 | tpr=0.8673 | fpr=0.0404 | 6191.4 samples/s | 24.2 steps/s
[Step= 100] | Loss=0.22359 | acc=0.9575 | tpr=0.9019 | fpr=0.0415 | 7692.1 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.22617 | acc=0.9564 | tpr=0.9207 | fpr=0.0430 | 8441.8 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.22616 | acc=0.9562 | tpr=0.9191 | fpr=0.0431 | 7484.4 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.22813 | acc=0.9560 | tpr=0.9179 | fpr=0.0433 | 7952.3 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.23045 | acc=0.9556 | tpr=0.9156 | fpr=0.0437 | 7618.0 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.22915 | acc=0.9556 | tpr=0.9167 | fpr=0.0437 | 8232.6 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.22913 | acc=0.9554 | tpr=0.9152 | fpr=0.0439 | 8431.2 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.23324 | acc=0.9548 | tpr=0.9133 | fpr=0.0444 | 8245.0 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.23333 | acc=0.9546 | tpr=0.9154 | fpr=0.0447 | 8426.7 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.23182 | acc=0.9548 | tpr=0.9136 | fpr=0.0444 | 9039.1 samples/s | 35.3 steps/s
Avg test loss: 0.23164, Avg test acc: 0.95479, Avg tpr: 0.91284, Avg fpr: 0.04444, total FA: 6171

server round 18/50

clients selected: [4 5 6 8 9]

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=58.9] | Loss=0.04829 | Reg=0.00136 | acc=0.9375 | L2-Norm=11.675 | L2-Norm(final)=11.742 | 7316.1 samples/s | 114.3 steps/s
[Step=12050 Epoch=59.1] | Loss=0.04631 | Reg=0.00136 | acc=0.9531 | L2-Norm=11.677 | L2-Norm(final)=11.757 | 4850.4 samples/s | 75.8 steps/s
[Step=12100 Epoch=59.3] | Loss=0.04529 | Reg=0.00136 | acc=0.9219 | L2-Norm=11.677 | L2-Norm(final)=11.774 | 5468.6 samples/s | 85.4 steps/s
[Step=12150 Epoch=59.6] | Loss=0.04309 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.677 | L2-Norm(final)=11.795 | 5565.5 samples/s | 87.0 steps/s
[Step=12200 Epoch=59.8] | Loss=0.04212 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.677 | L2-Norm(final)=11.820 | 8944.3 samples/s | 139.8 steps/s
[Step=12250 Epoch=60.1] | Loss=0.04149 | Reg=0.00136 | acc=0.9531 | L2-Norm=11.677 | L2-Norm(final)=11.848 | 2640.4 samples/s | 41.3 steps/s
[Step=12300 Epoch=60.3] | Loss=0.04124 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.677 | L2-Norm(final)=11.877 | 5581.6 samples/s | 87.2 steps/s
[Step=12350 Epoch=60.6] | Loss=0.04152 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.677 | L2-Norm(final)=11.905 | 5630.6 samples/s | 88.0 steps/s
[Step=12400 Epoch=60.8] | Loss=0.04140 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.677 | L2-Norm(final)=11.932 | 7936.9 samples/s | 124.0 steps/s
[Step=12450 Epoch=61.1] | Loss=0.04106 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.677 | L2-Norm(final)=11.959 | 2747.9 samples/s | 42.9 steps/s
[Step=12500 Epoch=61.3] | Loss=0.04142 | Reg=0.00136 | acc=0.9375 | L2-Norm=11.677 | L2-Norm(final)=11.986 | 5314.5 samples/s | 83.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=61.3] | Loss=0.02276 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.677 | L2-Norm(final)=12.248 | 6947.7 samples/s | 108.6 steps/s
[Step=12550 Epoch=61.5] | Loss=0.05064 | Reg=0.00139 | acc=0.9375 | L2-Norm=11.810 | L2-Norm(final)=12.249 | 4408.4 samples/s | 68.9 steps/s
[Step=12600 Epoch=61.8] | Loss=0.04758 | Reg=0.00142 | acc=0.9531 | L2-Norm=11.931 | L2-Norm(final)=12.236 | 4751.1 samples/s | 74.2 steps/s
[Step=12650 Epoch=62.0] | Loss=0.04483 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.024 | L2-Norm(final)=12.230 | 4768.0 samples/s | 74.5 steps/s
[Step=12700 Epoch=62.3] | Loss=0.04217 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.099 | L2-Norm(final)=12.228 | 6845.5 samples/s | 107.0 steps/s
[Step=12750 Epoch=62.5] | Loss=0.03744 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.160 | L2-Norm(final)=12.229 | 2437.3 samples/s | 38.1 steps/s
[Step=12800 Epoch=62.8] | Loss=0.03345 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=12.231 | 4768.1 samples/s | 74.5 steps/s
[Step=12850 Epoch=63.0] | Loss=0.03090 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=12.234 | 4712.4 samples/s | 73.6 steps/s
[Step=12900 Epoch=63.3] | Loss=0.02964 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.290 | L2-Norm(final)=12.236 | 6502.4 samples/s | 101.6 steps/s
[Step=12950 Epoch=63.5] | Loss=0.02762 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=12.237 | 2507.1 samples/s | 39.2 steps/s
[Step=13000 Epoch=63.7] | Loss=0.02570 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.352 | L2-Norm(final)=12.240 | 4786.7 samples/s | 74.8 steps/s
[Step=13050 Epoch=64.0] | Loss=0.02417 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.378 | L2-Norm(final)=12.242 | 4717.2 samples/s | 73.7 steps/s
[Step=13100 Epoch=64.2] | Loss=0.02299 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.401 | L2-Norm(final)=12.245 | 6151.0 samples/s | 96.1 steps/s
[Step=13150 Epoch=64.5] | Loss=0.02178 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.422 | L2-Norm(final)=12.247 | 2583.5 samples/s | 40.4 steps/s
[Step=13200 Epoch=64.7] | Loss=0.02060 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=12.250 | 4795.5 samples/s | 74.9 steps/s
[Step=13250 Epoch=65.0] | Loss=0.01986 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.457 | L2-Norm(final)=12.252 | 4722.5 samples/s | 73.8 steps/s
[Step=13300 Epoch=65.2] | Loss=0.01911 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.471 | L2-Norm(final)=12.254 | 5825.9 samples/s | 91.0 steps/s
[Step=13350 Epoch=65.5] | Loss=0.01826 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.485 | L2-Norm(final)=12.256 | 2644.7 samples/s | 41.3 steps/s
[Step=13400 Epoch=65.7] | Loss=0.01746 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=12.258 | 4752.3 samples/s | 74.3 steps/s
[Step=13450 Epoch=66.0] | Loss=0.01690 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.508 | L2-Norm(final)=12.260 | 4759.5 samples/s | 74.4 steps/s
[Step=13500 Epoch=66.2] | Loss=0.01638 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=12.262 | 5496.8 samples/s | 85.9 steps/s
[Step=13550 Epoch=66.4] | Loss=0.01592 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=12.263 | 2727.6 samples/s | 42.6 steps/s
[Step=13600 Epoch=66.7] | Loss=0.01543 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.541 | L2-Norm(final)=12.266 | 4684.6 samples/s | 73.2 steps/s
[Step=13650 Epoch=66.9] | Loss=0.01499 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=12.268 | 4765.9 samples/s | 74.5 steps/s
[Step=13700 Epoch=67.2] | Loss=0.01459 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.561 | L2-Norm(final)=12.270 | 5239.3 samples/s | 81.9 steps/s
[Step=13750 Epoch=67.4] | Loss=0.01416 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.571 | L2-Norm(final)=12.273 | 2768.0 samples/s | 43.3 steps/s
[Step=13800 Epoch=67.7] | Loss=0.01382 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.580 | L2-Norm(final)=12.275 | 4825.4 samples/s | 75.4 steps/s
[Step=13850 Epoch=67.9] | Loss=0.01348 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.588 | L2-Norm(final)=12.277 | 4790.4 samples/s | 74.8 steps/s
[Step=13900 Epoch=68.2] | Loss=0.01314 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.596 | L2-Norm(final)=12.279 | 4853.9 samples/s | 75.8 steps/s
[Step=13950 Epoch=68.4] | Loss=0.01278 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.603 | L2-Norm(final)=12.282 | 2831.6 samples/s | 44.2 steps/s
[Step=14000 Epoch=68.7] | Loss=0.01243 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.611 | L2-Norm(final)=12.284 | 4787.9 samples/s | 74.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step14000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=28001 Epoch=265.3] | Loss=0.00004 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=16.486 | 6662.8 samples/s | 104.1 steps/s
[Step=28050 Epoch=265.8] | Loss=0.00100 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.672 | L2-Norm(final)=16.498 | 4785.8 samples/s | 74.8 steps/s
[Step=28100 Epoch=266.3] | Loss=0.00076 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.672 | L2-Norm(final)=16.514 | 7745.5 samples/s | 121.0 steps/s
[Step=28150 Epoch=266.7] | Loss=0.00080 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=16.527 | 2565.2 samples/s | 40.1 steps/s
[Step=28200 Epoch=267.2] | Loss=0.00077 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=16.541 | 7318.7 samples/s | 114.4 steps/s
[Step=28250 Epoch=267.7] | Loss=0.00069 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=16.556 | 2678.4 samples/s | 41.9 steps/s
[Step=28300 Epoch=268.2] | Loss=0.00075 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=16.571 | 6535.1 samples/s | 102.1 steps/s
[Step=28350 Epoch=268.6] | Loss=0.00075 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=16.585 | 2804.6 samples/s | 43.8 steps/s
[Step=28400 Epoch=269.1] | Loss=0.00074 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=16.598 | 5911.4 samples/s | 92.4 steps/s
[Step=28450 Epoch=269.6] | Loss=0.00071 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=16.612 | 2934.6 samples/s | 45.9 steps/s
[Step=28500 Epoch=270.1] | Loss=0.00074 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=16.626 | 5401.9 samples/s | 84.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=28501 Epoch=270.1] | Loss=0.00007 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=16.765 | 6806.5 samples/s | 106.4 steps/s
[Step=28550 Epoch=270.5] | Loss=0.00637 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.725 | L2-Norm(final)=16.777 | 4108.4 samples/s | 64.2 steps/s
[Step=28600 Epoch=271.0] | Loss=0.00438 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.881 | L2-Norm(final)=16.758 | 6599.9 samples/s | 103.1 steps/s
[Step=28650 Epoch=271.5] | Loss=0.00307 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.960 | L2-Norm(final)=16.752 | 2384.2 samples/s | 37.3 steps/s
[Step=28700 Epoch=272.0] | Loss=0.00257 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.995 | L2-Norm(final)=16.750 | 5992.5 samples/s | 93.6 steps/s
[Step=28750 Epoch=272.4] | Loss=0.00222 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.016 | L2-Norm(final)=16.746 | 2474.8 samples/s | 38.7 steps/s
[Step=28800 Epoch=272.9] | Loss=0.00216 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.034 | L2-Norm(final)=16.744 | 5463.5 samples/s | 85.4 steps/s
[Step=28850 Epoch=273.4] | Loss=0.00216 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.051 | L2-Norm(final)=16.740 | 2572.6 samples/s | 40.2 steps/s
[Step=28900 Epoch=273.9] | Loss=0.00257 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=16.733 | 5025.5 samples/s | 78.5 steps/s
[Step=28950 Epoch=274.3] | Loss=0.00258 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.094 | L2-Norm(final)=16.725 | 2716.7 samples/s | 42.4 steps/s
[Step=29000 Epoch=274.8] | Loss=0.00239 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.112 | L2-Norm(final)=16.718 | 4585.8 samples/s | 71.7 steps/s
[Step=29050 Epoch=275.3] | Loss=0.00218 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.125 | L2-Norm(final)=16.713 | 2846.1 samples/s | 44.5 steps/s
[Step=29100 Epoch=275.7] | Loss=0.00200 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=16.708 | 4501.8 samples/s | 70.3 steps/s
[Step=29150 Epoch=276.2] | Loss=0.00184 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=16.704 | 2871.5 samples/s | 44.9 steps/s
[Step=29200 Epoch=276.7] | Loss=0.00171 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=16.701 | 4486.4 samples/s | 70.1 steps/s
[Step=29250 Epoch=277.2] | Loss=0.00160 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=16.699 | 2869.8 samples/s | 44.8 steps/s
[Step=29300 Epoch=277.6] | Loss=0.00150 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=16.696 | 4537.9 samples/s | 70.9 steps/s
[Step=29350 Epoch=278.1] | Loss=0.00141 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=16.694 | 3097.7 samples/s | 48.4 steps/s
[Step=29400 Epoch=278.6] | Loss=0.00133 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=16.692 | 4103.0 samples/s | 64.1 steps/s
[Step=29450 Epoch=279.1] | Loss=0.00126 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=16.691 | 6784.3 samples/s | 106.0 steps/s
[Step=29500 Epoch=279.5] | Loss=0.00120 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=16.689 | 2372.7 samples/s | 37.1 steps/s
[Step=29550 Epoch=280.0] | Loss=0.00114 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=16.688 | 6021.9 samples/s | 94.1 steps/s
[Step=29600 Epoch=280.5] | Loss=0.00109 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=16.687 | 2459.6 samples/s | 38.4 steps/s
[Step=29650 Epoch=281.0] | Loss=0.00104 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.125 | L2-Norm(final)=16.686 | 5433.9 samples/s | 84.9 steps/s
[Step=29700 Epoch=281.4] | Loss=0.00100 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.119 | L2-Norm(final)=16.685 | 2313.2 samples/s | 36.1 steps/s
[Step=29750 Epoch=281.9] | Loss=0.00096 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.114 | L2-Norm(final)=16.684 | 5023.7 samples/s | 78.5 steps/s
[Step=29800 Epoch=282.4] | Loss=0.00092 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.108 | L2-Norm(final)=16.683 | 2649.4 samples/s | 41.4 steps/s
[Step=29850 Epoch=282.9] | Loss=0.00089 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.102 | L2-Norm(final)=16.683 | 4788.5 samples/s | 74.8 steps/s
[Step=29900 Epoch=283.3] | Loss=0.00086 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.095 | L2-Norm(final)=16.682 | 2766.3 samples/s | 43.2 steps/s
[Step=29950 Epoch=283.8] | Loss=0.00083 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.088 | L2-Norm(final)=16.682 | 4574.1 samples/s | 71.5 steps/s
[Step=30000 Epoch=284.3] | Loss=0.00080 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.081 | L2-Norm(final)=16.681 | 2843.1 samples/s | 44.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step30000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=152.2] | Loss=0.00151 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=12.818 | 7151.9 samples/s | 111.7 steps/s
[Step=16050 Epoch=152.7] | Loss=0.00436 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=12.847 | 4628.9 samples/s | 72.3 steps/s
[Step=16100 Epoch=153.2] | Loss=0.00440 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=12.887 | 8187.8 samples/s | 127.9 steps/s
[Step=16150 Epoch=153.6] | Loss=0.00465 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.670 | L2-Norm(final)=12.923 | 2584.8 samples/s | 40.4 steps/s
[Step=16200 Epoch=154.1] | Loss=0.00428 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=12.956 | 7299.1 samples/s | 114.0 steps/s
[Step=16250 Epoch=154.6] | Loss=0.00418 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=12.986 | 2748.8 samples/s | 42.9 steps/s
[Step=16300 Epoch=155.1] | Loss=0.00426 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.018 | 6276.1 samples/s | 98.1 steps/s
[Step=16350 Epoch=155.5] | Loss=0.00414 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.049 | 2797.0 samples/s | 43.7 steps/s
[Step=16400 Epoch=156.0] | Loss=0.00419 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.079 | 5915.8 samples/s | 92.4 steps/s
[Step=16450 Epoch=156.5] | Loss=0.00416 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.107 | 2922.0 samples/s | 45.7 steps/s
[Step=16500 Epoch=157.0] | Loss=0.00418 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.135 | 5472.9 samples/s | 85.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=157.0] | Loss=0.01718 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.670 | L2-Norm(final)=13.412 | 7069.1 samples/s | 110.5 steps/s
[Step=16550 Epoch=157.4] | Loss=0.00902 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=13.404 | 4002.4 samples/s | 62.5 steps/s
[Step=16600 Epoch=157.9] | Loss=0.00544 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=13.396 | 6595.0 samples/s | 103.0 steps/s
[Step=16650 Epoch=158.4] | Loss=0.00406 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=13.393 | 2381.9 samples/s | 37.2 steps/s
[Step=16700 Epoch=158.9] | Loss=0.00389 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=13.389 | 5942.6 samples/s | 92.9 steps/s
[Step=16750 Epoch=159.3] | Loss=0.00314 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=13.386 | 2473.5 samples/s | 38.6 steps/s
[Step=16800 Epoch=159.8] | Loss=0.00263 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.220 | L2-Norm(final)=13.385 | 5516.2 samples/s | 86.2 steps/s
[Step=16850 Epoch=160.3] | Loss=0.00225 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=13.384 | 2616.7 samples/s | 40.9 steps/s
[Step=16900 Epoch=160.8] | Loss=0.00198 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.222 | L2-Norm(final)=13.384 | 4877.9 samples/s | 76.2 steps/s
[Step=16950 Epoch=161.2] | Loss=0.00176 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=13.384 | 2740.2 samples/s | 42.8 steps/s
[Step=17000 Epoch=161.7] | Loss=0.00158 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=13.385 | 4507.2 samples/s | 70.4 steps/s
[Step=17050 Epoch=162.2] | Loss=0.00144 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=13.385 | 2802.0 samples/s | 43.8 steps/s
[Step=17100 Epoch=162.7] | Loss=0.00132 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.194 | L2-Norm(final)=13.385 | 4525.7 samples/s | 70.7 steps/s
[Step=17150 Epoch=163.1] | Loss=0.00122 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=13.386 | 2861.7 samples/s | 44.7 steps/s
[Step=17200 Epoch=163.6] | Loss=0.00113 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=13.386 | 4543.2 samples/s | 71.0 steps/s
[Step=17250 Epoch=164.1] | Loss=0.00106 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=13.387 | 2860.3 samples/s | 44.7 steps/s
[Step=17300 Epoch=164.6] | Loss=0.00099 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=13.387 | 4607.1 samples/s | 72.0 steps/s
[Step=17350 Epoch=165.0] | Loss=0.00094 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=13.388 | 3096.6 samples/s | 48.4 steps/s
[Step=17400 Epoch=165.5] | Loss=0.00088 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=13.388 | 4001.5 samples/s | 62.5 steps/s
[Step=17450 Epoch=166.0] | Loss=0.00084 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.116 | L2-Norm(final)=13.389 | 6894.5 samples/s | 107.7 steps/s
[Step=17500 Epoch=166.5] | Loss=0.00080 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=13.389 | 2355.5 samples/s | 36.8 steps/s
[Step=17550 Epoch=166.9] | Loss=0.00076 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.092 | L2-Norm(final)=13.390 | 6199.3 samples/s | 96.9 steps/s
[Step=17600 Epoch=167.4] | Loss=0.00072 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.080 | L2-Norm(final)=13.390 | 2440.4 samples/s | 38.1 steps/s
[Step=17650 Epoch=167.9] | Loss=0.00069 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.067 | L2-Norm(final)=13.391 | 5661.7 samples/s | 88.5 steps/s
[Step=17700 Epoch=168.4] | Loss=0.00066 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.055 | L2-Norm(final)=13.391 | 2549.0 samples/s | 39.8 steps/s
[Step=17750 Epoch=168.8] | Loss=0.00064 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.042 | L2-Norm(final)=13.392 | 5187.5 samples/s | 81.1 steps/s
[Step=17800 Epoch=169.3] | Loss=0.00061 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.030 | L2-Norm(final)=13.392 | 2630.6 samples/s | 41.1 steps/s
[Step=17850 Epoch=169.8] | Loss=0.00059 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.017 | L2-Norm(final)=13.393 | 4684.0 samples/s | 73.2 steps/s
[Step=17900 Epoch=170.3] | Loss=0.00057 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.004 | L2-Norm(final)=13.394 | 2768.6 samples/s | 43.3 steps/s
[Step=17950 Epoch=170.7] | Loss=0.00055 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.992 | L2-Norm(final)=13.394 | 4697.2 samples/s | 73.4 steps/s
[Step=18000 Epoch=171.2] | Loss=0.00053 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.979 | L2-Norm(final)=13.395 | 2808.5 samples/s | 43.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step18000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=188.5] | Loss=0.01631 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.675 | L2-Norm(final)=13.620 | 6674.4 samples/s | 104.3 steps/s
[Step=20050 Epoch=188.9] | Loss=0.00517 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=13.642 | 4593.4 samples/s | 71.8 steps/s
[Step=20100 Epoch=189.4] | Loss=0.00495 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=13.668 | 7941.6 samples/s | 124.1 steps/s
[Step=20150 Epoch=189.9] | Loss=0.00541 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.700 | 2599.4 samples/s | 40.6 steps/s
[Step=20200 Epoch=190.3] | Loss=0.00512 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.730 | 7043.1 samples/s | 110.0 steps/s
[Step=20250 Epoch=190.8] | Loss=0.00481 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.760 | 2728.1 samples/s | 42.6 steps/s
[Step=20300 Epoch=191.3] | Loss=0.00479 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.791 | 6154.4 samples/s | 96.2 steps/s
[Step=20350 Epoch=191.8] | Loss=0.00489 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.821 | 2883.7 samples/s | 45.1 steps/s
[Step=20400 Epoch=192.2] | Loss=0.00480 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.849 | 5524.3 samples/s | 86.3 steps/s
[Step=20450 Epoch=192.7] | Loss=0.00489 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.877 | 2991.1 samples/s | 46.7 steps/s
[Step=20500 Epoch=193.2] | Loss=0.00488 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.904 | 5333.8 samples/s | 83.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=193.2] | Loss=0.00016 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=14.178 | 6689.7 samples/s | 104.5 steps/s
[Step=20550 Epoch=193.6] | Loss=0.00536 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.839 | L2-Norm(final)=14.192 | 4223.3 samples/s | 66.0 steps/s
[Step=20600 Epoch=194.1] | Loss=0.00769 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.013 | L2-Norm(final)=14.172 | 6252.7 samples/s | 97.7 steps/s
[Step=20650 Epoch=194.6] | Loss=0.00663 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.115 | L2-Norm(final)=14.155 | 2413.1 samples/s | 37.7 steps/s
[Step=20700 Epoch=195.1] | Loss=0.00531 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=14.145 | 5735.2 samples/s | 89.6 steps/s
[Step=20750 Epoch=195.5] | Loss=0.00436 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.194 | L2-Norm(final)=14.140 | 2504.4 samples/s | 39.1 steps/s
[Step=20800 Epoch=196.0] | Loss=0.00363 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.207 | L2-Norm(final)=14.137 | 5238.8 samples/s | 81.9 steps/s
[Step=20850 Epoch=196.5] | Loss=0.00312 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=14.135 | 2643.0 samples/s | 41.3 steps/s
[Step=20900 Epoch=196.9] | Loss=0.00273 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=14.134 | 4802.4 samples/s | 75.0 steps/s
[Step=20950 Epoch=197.4] | Loss=0.00243 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.209 | L2-Norm(final)=14.134 | 2763.1 samples/s | 43.2 steps/s
[Step=21000 Epoch=197.9] | Loss=0.00219 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.204 | L2-Norm(final)=14.133 | 4561.6 samples/s | 71.3 steps/s
[Step=21050 Epoch=198.4] | Loss=0.00199 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=14.133 | 2867.7 samples/s | 44.8 steps/s
[Step=21100 Epoch=198.8] | Loss=0.00183 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.189 | L2-Norm(final)=14.133 | 4514.9 samples/s | 70.5 steps/s
[Step=21150 Epoch=199.3] | Loss=0.00169 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=14.133 | 2857.1 samples/s | 44.6 steps/s
[Step=21200 Epoch=199.8] | Loss=0.00157 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=14.133 | 4552.4 samples/s | 71.1 steps/s
[Step=21250 Epoch=200.2] | Loss=0.00146 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=14.134 | 3048.4 samples/s | 47.6 steps/s
[Step=21300 Epoch=200.7] | Loss=0.00137 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=14.134 | 2640.3 samples/s | 41.3 steps/s
[Step=21350 Epoch=201.2] | Loss=0.00129 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=14.134 | 6667.9 samples/s | 104.2 steps/s
[Step=21400 Epoch=201.6] | Loss=0.00122 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=14.134 | 2378.2 samples/s | 37.2 steps/s
[Step=21450 Epoch=202.1] | Loss=0.00116 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=14.135 | 5863.8 samples/s | 91.6 steps/s
[Step=21500 Epoch=202.6] | Loss=0.00110 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.112 | L2-Norm(final)=14.135 | 2511.4 samples/s | 39.2 steps/s
[Step=21550 Epoch=203.1] | Loss=0.00105 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.101 | L2-Norm(final)=14.135 | 5310.1 samples/s | 83.0 steps/s
[Step=21600 Epoch=203.5] | Loss=0.00100 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.090 | L2-Norm(final)=14.136 | 2630.8 samples/s | 41.1 steps/s
[Step=21650 Epoch=204.0] | Loss=0.00096 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.080 | L2-Norm(final)=14.136 | 4825.5 samples/s | 75.4 steps/s
[Step=21700 Epoch=204.5] | Loss=0.00092 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.069 | L2-Norm(final)=14.136 | 2761.5 samples/s | 43.1 steps/s
[Step=21750 Epoch=204.9] | Loss=0.00088 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.058 | L2-Norm(final)=14.137 | 4541.5 samples/s | 71.0 steps/s
[Step=21800 Epoch=205.4] | Loss=0.00085 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.047 | L2-Norm(final)=14.137 | 2835.4 samples/s | 44.3 steps/s
[Step=21850 Epoch=205.9] | Loss=0.00081 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.036 | L2-Norm(final)=14.137 | 4570.7 samples/s | 71.4 steps/s
[Step=21900 Epoch=206.4] | Loss=0.00079 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.025 | L2-Norm(final)=14.138 | 2894.9 samples/s | 45.2 steps/s
[Step=21950 Epoch=206.8] | Loss=0.00076 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.014 | L2-Norm(final)=14.138 | 4430.2 samples/s | 69.2 steps/s
[Step=22000 Epoch=207.3] | Loss=0.00073 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.003 | L2-Norm(final)=14.138 | 2978.9 samples/s | 46.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step22000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=171.6] | Loss=0.00958 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.675 | L2-Norm(final)=12.856 | 6397.8 samples/s | 100.0 steps/s
[Step=18050 Epoch=172.0] | Loss=0.00366 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=12.894 | 4592.4 samples/s | 71.8 steps/s
[Step=18100 Epoch=172.5] | Loss=0.00383 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=12.936 | 8398.9 samples/s | 131.2 steps/s
[Step=18150 Epoch=173.0] | Loss=0.00366 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=12.973 | 2567.8 samples/s | 40.1 steps/s
[Step=18200 Epoch=173.5] | Loss=0.00363 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.008 | 7396.7 samples/s | 115.6 steps/s
[Step=18250 Epoch=173.9] | Loss=0.00395 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.045 | 2665.6 samples/s | 41.6 steps/s
[Step=18300 Epoch=174.4] | Loss=0.00378 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.082 | 6650.5 samples/s | 103.9 steps/s
[Step=18350 Epoch=174.9] | Loss=0.00370 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.117 | 2746.7 samples/s | 42.9 steps/s
[Step=18400 Epoch=175.4] | Loss=0.00367 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.151 | 6156.7 samples/s | 96.2 steps/s
[Step=18450 Epoch=175.8] | Loss=0.00355 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.186 | 2848.7 samples/s | 44.5 steps/s
[Step=18500 Epoch=176.3] | Loss=0.00366 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.219 | 5700.8 samples/s | 89.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=176.3] | Loss=0.00189 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.550 | 7175.7 samples/s | 112.1 steps/s
[Step=18550 Epoch=176.8] | Loss=0.01052 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.823 | L2-Norm(final)=13.557 | 4038.0 samples/s | 63.1 steps/s
[Step=18600 Epoch=177.3] | Loss=0.00812 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.022 | L2-Norm(final)=13.531 | 6651.6 samples/s | 103.9 steps/s
[Step=18650 Epoch=177.8] | Loss=0.00571 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.113 | L2-Norm(final)=13.525 | 2391.5 samples/s | 37.4 steps/s
[Step=18700 Epoch=178.2] | Loss=0.00441 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=13.523 | 6087.8 samples/s | 95.1 steps/s
[Step=18750 Epoch=178.7] | Loss=0.00359 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=13.523 | 2448.3 samples/s | 38.3 steps/s
[Step=18800 Epoch=179.2] | Loss=0.00299 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=13.523 | 5690.6 samples/s | 88.9 steps/s
[Step=18850 Epoch=179.7] | Loss=0.00257 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=13.524 | 2529.3 samples/s | 39.5 steps/s
[Step=18900 Epoch=180.1] | Loss=0.00225 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=13.524 | 5312.4 samples/s | 83.0 steps/s
[Step=18950 Epoch=180.6] | Loss=0.00200 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=13.525 | 2630.9 samples/s | 41.1 steps/s
[Step=19000 Epoch=181.1] | Loss=0.00180 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=13.525 | 4883.9 samples/s | 76.3 steps/s
[Step=19050 Epoch=181.6] | Loss=0.00164 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=13.526 | 2738.3 samples/s | 42.8 steps/s
[Step=19100 Epoch=182.0] | Loss=0.00150 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=13.526 | 4572.6 samples/s | 71.4 steps/s
[Step=19150 Epoch=182.5] | Loss=0.00139 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=13.527 | 2820.7 samples/s | 44.1 steps/s
[Step=19200 Epoch=183.0] | Loss=0.00129 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=13.527 | 4571.6 samples/s | 71.4 steps/s
[Step=19250 Epoch=183.5] | Loss=0.00120 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.108 | L2-Norm(final)=13.528 | 2796.8 samples/s | 43.7 steps/s
[Step=19300 Epoch=183.9] | Loss=0.00113 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.095 | L2-Norm(final)=13.528 | 4547.3 samples/s | 71.1 steps/s
[Step=19350 Epoch=184.4] | Loss=0.00106 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.082 | L2-Norm(final)=13.528 | 2845.2 samples/s | 44.5 steps/s
[Step=19400 Epoch=184.9] | Loss=0.00100 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.069 | L2-Norm(final)=13.529 | 4608.7 samples/s | 72.0 steps/s
[Step=19450 Epoch=185.4] | Loss=0.00095 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.056 | L2-Norm(final)=13.529 | 2834.4 samples/s | 44.3 steps/s
[Step=19500 Epoch=185.9] | Loss=0.00090 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.043 | L2-Norm(final)=13.530 | 4536.5 samples/s | 70.9 steps/s
[Step=19550 Epoch=186.3] | Loss=0.00086 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.029 | L2-Norm(final)=13.530 | 7357.1 samples/s | 115.0 steps/s
[Step=19600 Epoch=186.8] | Loss=0.00082 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.016 | L2-Norm(final)=13.530 | 2287.1 samples/s | 35.7 steps/s
[Step=19650 Epoch=187.3] | Loss=0.00078 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.003 | L2-Norm(final)=13.531 | 6571.4 samples/s | 102.7 steps/s
[Step=19700 Epoch=187.8] | Loss=0.00075 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.989 | L2-Norm(final)=13.531 | 2376.8 samples/s | 37.1 steps/s
[Step=19750 Epoch=188.2] | Loss=0.00072 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.976 | L2-Norm(final)=13.532 | 6147.7 samples/s | 96.1 steps/s
[Step=19800 Epoch=188.7] | Loss=0.00069 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.963 | L2-Norm(final)=13.532 | 2431.4 samples/s | 38.0 steps/s
[Step=19850 Epoch=189.2] | Loss=0.00067 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.949 | L2-Norm(final)=13.532 | 5679.2 samples/s | 88.7 steps/s
[Step=19900 Epoch=189.7] | Loss=0.00065 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.936 | L2-Norm(final)=13.533 | 2520.9 samples/s | 39.4 steps/s
[Step=19950 Epoch=190.1] | Loss=0.00062 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.922 | L2-Norm(final)=13.533 | 5310.0 samples/s | 83.0 steps/s
[Step=20000 Epoch=190.6] | Loss=0.00060 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.909 | L2-Norm(final)=13.533 | 2613.6 samples/s | 40.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10394 | acc=0.9549 | tpr=0.9707 | fpr=0.0793 | 6173.9 samples/s | 24.1 steps/s
Avg test loss: 0.11508, Avg test acc: 0.95064, Avg tpr: 0.96765, Avg fpr: 0.08678, total FA: 677

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.11817 | acc=0.9507 | tpr=0.9622 | fpr=0.0743 | 6039.0 samples/s | 23.6 steps/s
Avg test loss: 0.12406, Avg test acc: 0.94839, Avg tpr: 0.96060, Avg fpr: 0.07845, total FA: 612

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11141 | acc=0.9500 | tpr=0.9744 | fpr=0.1031 | 5896.5 samples/s | 23.0 steps/s
Avg test loss: 0.11265, Avg test acc: 0.94960, Avg tpr: 0.97319, Avg fpr: 0.10229, total FA: 798

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10846 | acc=0.9530 | tpr=0.9612 | fpr=0.0649 | 5967.9 samples/s | 23.3 steps/s
Avg test loss: 0.11939, Avg test acc: 0.94923, Avg tpr: 0.95803, Avg fpr: 0.07012, total FA: 547

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11956 | acc=0.9541 | tpr=0.9695 | fpr=0.0793 | 5998.2 samples/s | 23.4 steps/s
Avg test loss: 0.12642, Avg test acc: 0.95240, Avg tpr: 0.96794, Avg fpr: 0.08178, total FA: 638

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.78529 | acc=0.2984 | tpr=0.0245 | fpr=0.1070 | 6080.8 samples/s | 23.8 steps/s
Avg test loss: 6.79460, Avg test acc: 0.29638, Avg tpr: 0.02384, Avg fpr: 0.10422, total FA: 813

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.86704 | acc=0.3123 | tpr=0.0226 | fpr=0.0587 | 6090.4 samples/s | 23.8 steps/s
Avg test loss: 4.87636, Avg test acc: 0.31040, Avg tpr: 0.02256, Avg fpr: 0.05653, total FA: 441

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.12105 | acc=0.2997 | tpr=0.0131 | fpr=0.0780 | 6031.5 samples/s | 23.6 steps/s
Avg test loss: 5.14095, Avg test acc: 0.29746, Avg tpr: 0.01323, Avg fpr: 0.07743, total FA: 604

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.26259 | acc=0.2989 | tpr=0.0364 | fpr=0.1311 | 5805.4 samples/s | 22.7 steps/s
Avg test loss: 5.27132, Avg test acc: 0.29894, Avg tpr: 0.03736, Avg fpr: 0.12575, total FA: 981

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.92307 | acc=0.3152 | tpr=0.0104 | fpr=0.0230 | 6057.0 samples/s | 23.7 steps/s
Avg test loss: 5.94296, Avg test acc: 0.31277, Avg tpr: 0.00968, Avg fpr: 0.02064, total FA: 161

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.96854 | acc=0.1308 | tpr=0.7389 | fpr=0.8801 | 6041.9 samples/s | 23.6 steps/s
[Step= 100] | Loss=5.94230 | acc=0.1333 | tpr=0.7143 | fpr=0.8776 | 8092.3 samples/s | 31.6 steps/s
[Step= 150] | Loss=5.93543 | acc=0.1341 | tpr=0.7262 | fpr=0.8768 | 7607.1 samples/s | 29.7 steps/s
[Step= 200] | Loss=5.92761 | acc=0.1349 | tpr=0.7246 | fpr=0.8758 | 8180.8 samples/s | 32.0 steps/s
[Step= 250] | Loss=5.93450 | acc=0.1348 | tpr=0.7135 | fpr=0.8758 | 7674.7 samples/s | 30.0 steps/s
[Step= 300] | Loss=5.92690 | acc=0.1345 | tpr=0.7127 | fpr=0.8760 | 8520.3 samples/s | 33.3 steps/s
[Step= 350] | Loss=5.93042 | acc=0.1344 | tpr=0.7170 | fpr=0.8762 | 7913.4 samples/s | 30.9 steps/s
[Step= 400] | Loss=5.92806 | acc=0.1347 | tpr=0.7133 | fpr=0.8759 | 8118.6 samples/s | 31.7 steps/s
[Step= 450] | Loss=5.93250 | acc=0.1340 | tpr=0.7162 | fpr=0.8765 | 8327.2 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.93111 | acc=0.1343 | tpr=0.7207 | fpr=0.8763 | 8299.0 samples/s | 32.4 steps/s
[Step= 550] | Loss=5.93290 | acc=0.1343 | tpr=0.7230 | fpr=0.8764 | 9229.2 samples/s | 36.1 steps/s
Avg test loss: 5.93360, Avg test acc: 0.13430, Avg tpr: 0.72385, Avg fpr: 0.87642, total FA: 121689

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.70404 | acc=0.1384 | tpr=0.5752 | fpr=0.8695 | 5859.6 samples/s | 22.9 steps/s
[Step= 100] | Loss=4.68895 | acc=0.1410 | tpr=0.6034 | fpr=0.8676 | 7989.3 samples/s | 31.2 steps/s
[Step= 150] | Loss=4.67944 | acc=0.1435 | tpr=0.6167 | fpr=0.8652 | 7267.8 samples/s | 28.4 steps/s
[Step= 200] | Loss=4.68535 | acc=0.1436 | tpr=0.6109 | fpr=0.8649 | 8878.8 samples/s | 34.7 steps/s
[Step= 250] | Loss=4.68838 | acc=0.1433 | tpr=0.6061 | fpr=0.8651 | 7848.5 samples/s | 30.7 steps/s
[Step= 300] | Loss=4.68549 | acc=0.1433 | tpr=0.6007 | fpr=0.8650 | 8450.9 samples/s | 33.0 steps/s
[Step= 350] | Loss=4.69306 | acc=0.1432 | tpr=0.6036 | fpr=0.8652 | 7547.5 samples/s | 29.5 steps/s
[Step= 400] | Loss=4.69084 | acc=0.1436 | tpr=0.6028 | fpr=0.8648 | 8539.5 samples/s | 33.4 steps/s
[Step= 450] | Loss=4.69431 | acc=0.1433 | tpr=0.6081 | fpr=0.8652 | 8230.7 samples/s | 32.2 steps/s
[Step= 500] | Loss=4.69727 | acc=0.1431 | tpr=0.6123 | fpr=0.8653 | 8316.4 samples/s | 32.5 steps/s
[Step= 550] | Loss=4.70077 | acc=0.1433 | tpr=0.6140 | fpr=0.8653 | 9806.4 samples/s | 38.3 steps/s
Avg test loss: 4.70138, Avg test acc: 0.14311, Avg tpr: 0.61529, Avg fpr: 0.86547, total FA: 120169

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.75191 | acc=0.1116 | tpr=0.7522 | fpr=0.9000 | 6207.2 samples/s | 24.2 steps/s
[Step= 100] | Loss=5.73705 | acc=0.1121 | tpr=0.7527 | fpr=0.8998 | 8005.7 samples/s | 31.3 steps/s
[Step= 150] | Loss=5.73246 | acc=0.1138 | tpr=0.7493 | fpr=0.8979 | 7503.5 samples/s | 29.3 steps/s
[Step= 200] | Loss=5.72792 | acc=0.1140 | tpr=0.7410 | fpr=0.8974 | 8238.2 samples/s | 32.2 steps/s
[Step= 250] | Loss=5.73226 | acc=0.1143 | tpr=0.7406 | fpr=0.8971 | 8141.3 samples/s | 31.8 steps/s
[Step= 300] | Loss=5.73034 | acc=0.1139 | tpr=0.7382 | fpr=0.8974 | 7737.2 samples/s | 30.2 steps/s
[Step= 350] | Loss=5.73647 | acc=0.1137 | tpr=0.7389 | fpr=0.8976 | 8127.8 samples/s | 31.7 steps/s
[Step= 400] | Loss=5.73395 | acc=0.1139 | tpr=0.7412 | fpr=0.8975 | 7784.7 samples/s | 30.4 steps/s
[Step= 450] | Loss=5.73875 | acc=0.1132 | tpr=0.7444 | fpr=0.8982 | 8001.5 samples/s | 31.3 steps/s
[Step= 500] | Loss=5.73693 | acc=0.1131 | tpr=0.7449 | fpr=0.8983 | 8015.6 samples/s | 31.3 steps/s
[Step= 550] | Loss=5.74165 | acc=0.1132 | tpr=0.7441 | fpr=0.8983 | 10508.8 samples/s | 41.0 steps/s
Avg test loss: 5.74189, Avg test acc: 0.11305, Avg tpr: 0.74445, Avg fpr: 0.89843, total FA: 124745

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.13132 | acc=0.1426 | tpr=0.6106 | fpr=0.8658 | 6117.9 samples/s | 23.9 steps/s
[Step= 100] | Loss=5.11608 | acc=0.1452 | tpr=0.6333 | fpr=0.8639 | 7225.2 samples/s | 28.2 steps/s
[Step= 150] | Loss=5.10841 | acc=0.1478 | tpr=0.6455 | fpr=0.8614 | 8071.8 samples/s | 31.5 steps/s
[Step= 200] | Loss=5.10525 | acc=0.1487 | tpr=0.6481 | fpr=0.8604 | 8321.4 samples/s | 32.5 steps/s
[Step= 250] | Loss=5.10786 | acc=0.1486 | tpr=0.6498 | fpr=0.8605 | 8419.3 samples/s | 32.9 steps/s
[Step= 300] | Loss=5.10154 | acc=0.1488 | tpr=0.6444 | fpr=0.8602 | 7400.1 samples/s | 28.9 steps/s
[Step= 350] | Loss=5.10503 | acc=0.1487 | tpr=0.6462 | fpr=0.8603 | 8184.9 samples/s | 32.0 steps/s
[Step= 400] | Loss=5.10008 | acc=0.1493 | tpr=0.6450 | fpr=0.8597 | 8266.1 samples/s | 32.3 steps/s
[Step= 450] | Loss=5.10211 | acc=0.1489 | tpr=0.6470 | fpr=0.8601 | 8485.7 samples/s | 33.1 steps/s
[Step= 500] | Loss=5.10137 | acc=0.1490 | tpr=0.6542 | fpr=0.8601 | 7196.1 samples/s | 28.1 steps/s
[Step= 550] | Loss=5.10793 | acc=0.1490 | tpr=0.6542 | fpr=0.8601 | 11511.9 samples/s | 45.0 steps/s
Avg test loss: 5.10895, Avg test acc: 0.14899, Avg tpr: 0.65452, Avg fpr: 0.86020, total FA: 119437

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.03151 | acc=0.1251 | tpr=0.6416 | fpr=0.8842 | 6098.8 samples/s | 23.8 steps/s
[Step= 100] | Loss=6.02086 | acc=0.1273 | tpr=0.6247 | fpr=0.8819 | 7489.2 samples/s | 29.3 steps/s
[Step= 150] | Loss=6.00948 | acc=0.1292 | tpr=0.6354 | fpr=0.8801 | 7538.0 samples/s | 29.4 steps/s
[Step= 200] | Loss=6.01192 | acc=0.1299 | tpr=0.6372 | fpr=0.8794 | 7973.0 samples/s | 31.1 steps/s
[Step= 250] | Loss=6.01130 | acc=0.1295 | tpr=0.6314 | fpr=0.8797 | 8207.4 samples/s | 32.1 steps/s
[Step= 300] | Loss=6.00374 | acc=0.1290 | tpr=0.6262 | fpr=0.8801 | 8133.8 samples/s | 31.8 steps/s
[Step= 350] | Loss=6.00973 | acc=0.1285 | tpr=0.6249 | fpr=0.8805 | 8582.1 samples/s | 33.5 steps/s
[Step= 400] | Loss=6.00597 | acc=0.1284 | tpr=0.6182 | fpr=0.8805 | 7963.9 samples/s | 31.1 steps/s
[Step= 450] | Loss=6.01292 | acc=0.1276 | tpr=0.6212 | fpr=0.8814 | 7843.5 samples/s | 30.6 steps/s
[Step= 500] | Loss=6.01091 | acc=0.1275 | tpr=0.6207 | fpr=0.8814 | 7655.8 samples/s | 29.9 steps/s
[Step= 550] | Loss=6.01533 | acc=0.1277 | tpr=0.6216 | fpr=0.8812 | 11484.4 samples/s | 44.9 steps/s
Avg test loss: 6.01686, Avg test acc: 0.12768, Avg tpr: 0.62242, Avg fpr: 0.88131, total FA: 122368

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.20359 | acc=0.9531 | tpr=0.9071 | fpr=0.0460 | 6054.2 samples/s | 23.6 steps/s
[Step= 100] | Loss=0.20650 | acc=0.9532 | tpr=0.9296 | fpr=0.0464 | 7407.4 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.20624 | acc=0.9527 | tpr=0.9352 | fpr=0.0470 | 7946.3 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.20411 | acc=0.9528 | tpr=0.9432 | fpr=0.0470 | 8021.0 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.20536 | acc=0.9527 | tpr=0.9406 | fpr=0.0471 | 7779.8 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.20835 | acc=0.9523 | tpr=0.9345 | fpr=0.0474 | 8485.1 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.20817 | acc=0.9525 | tpr=0.9361 | fpr=0.0472 | 8081.1 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.20843 | acc=0.9523 | tpr=0.9333 | fpr=0.0474 | 8109.9 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.21203 | acc=0.9517 | tpr=0.9304 | fpr=0.0479 | 8150.0 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.21201 | acc=0.9515 | tpr=0.9313 | fpr=0.0481 | 7248.1 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.21069 | acc=0.9519 | tpr=0.9284 | fpr=0.0477 | 11778.5 samples/s | 46.0 steps/s
Avg test loss: 0.21041, Avg test acc: 0.95190, Avg tpr: 0.92868, Avg fpr: 0.04768, total FA: 6620

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16689 | acc=0.9598 | tpr=0.9027 | fpr=0.0392 | 6073.5 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.17173 | acc=0.9585 | tpr=0.9318 | fpr=0.0410 | 7734.8 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.17376 | acc=0.9573 | tpr=0.9366 | fpr=0.0423 | 8269.3 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.17493 | acc=0.9572 | tpr=0.9410 | fpr=0.0425 | 7383.4 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.17424 | acc=0.9573 | tpr=0.9362 | fpr=0.0424 | 8856.2 samples/s | 34.6 steps/s
[Step= 300] | Loss=0.17571 | acc=0.9569 | tpr=0.9360 | fpr=0.0427 | 7854.7 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.17429 | acc=0.9571 | tpr=0.9374 | fpr=0.0425 | 7924.2 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.17386 | acc=0.9570 | tpr=0.9333 | fpr=0.0426 | 7764.7 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.17652 | acc=0.9565 | tpr=0.9309 | fpr=0.0430 | 8177.2 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.17638 | acc=0.9563 | tpr=0.9300 | fpr=0.0432 | 7533.9 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.17526 | acc=0.9565 | tpr=0.9276 | fpr=0.0430 | 10985.6 samples/s | 42.9 steps/s
Avg test loss: 0.17490, Avg test acc: 0.95653, Avg tpr: 0.92750, Avg fpr: 0.04295, total FA: 5963

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.29353 | acc=0.9480 | tpr=0.9336 | fpr=0.0517 | 6089.6 samples/s | 23.8 steps/s
[Step= 100] | Loss=0.30207 | acc=0.9468 | tpr=0.9446 | fpr=0.0531 | 7601.7 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.30840 | acc=0.9453 | tpr=0.9467 | fpr=0.0548 | 8059.3 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.30827 | acc=0.9454 | tpr=0.9519 | fpr=0.0548 | 7623.0 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.30908 | acc=0.9450 | tpr=0.9502 | fpr=0.0551 | 8157.6 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.31213 | acc=0.9448 | tpr=0.9455 | fpr=0.0553 | 7903.2 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.31023 | acc=0.9447 | tpr=0.9461 | fpr=0.0554 | 8361.7 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.31082 | acc=0.9443 | tpr=0.9415 | fpr=0.0556 | 7933.8 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.31499 | acc=0.9439 | tpr=0.9406 | fpr=0.0561 | 7993.3 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.31562 | acc=0.9438 | tpr=0.9423 | fpr=0.0562 | 8308.2 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.31383 | acc=0.9441 | tpr=0.9419 | fpr=0.0559 | 10177.6 samples/s | 39.8 steps/s
Avg test loss: 0.31340, Avg test acc: 0.94411, Avg tpr: 0.94176, Avg fpr: 0.05585, total FA: 7754

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.12267 | acc=0.9668 | tpr=0.9336 | fpr=0.0326 | 5749.4 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.12575 | acc=0.9654 | tpr=0.9232 | fpr=0.0338 | 8191.0 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.12911 | acc=0.9647 | tpr=0.9280 | fpr=0.0346 | 7907.1 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.12950 | acc=0.9646 | tpr=0.9322 | fpr=0.0348 | 8044.1 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.13004 | acc=0.9646 | tpr=0.9249 | fpr=0.0347 | 8311.7 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.13213 | acc=0.9643 | tpr=0.9215 | fpr=0.0349 | 7757.5 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.13150 | acc=0.9645 | tpr=0.9211 | fpr=0.0347 | 8051.9 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.13147 | acc=0.9643 | tpr=0.9179 | fpr=0.0348 | 7118.0 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.13318 | acc=0.9641 | tpr=0.9167 | fpr=0.0351 | 8387.9 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.13335 | acc=0.9640 | tpr=0.9172 | fpr=0.0351 | 8262.6 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.13247 | acc=0.9641 | tpr=0.9152 | fpr=0.0350 | 11329.9 samples/s | 44.3 steps/s
Avg test loss: 0.13229, Avg test acc: 0.96412, Avg tpr: 0.91521, Avg fpr: 0.03499, total FA: 4858

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.22664 | acc=0.9567 | tpr=0.8673 | fpr=0.0417 | 5645.5 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.23346 | acc=0.9562 | tpr=0.8891 | fpr=0.0426 | 8200.8 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.23557 | acc=0.9559 | tpr=0.9006 | fpr=0.0431 | 8245.7 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.23629 | acc=0.9555 | tpr=0.9060 | fpr=0.0436 | 8330.4 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.23927 | acc=0.9552 | tpr=0.8978 | fpr=0.0438 | 7986.3 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.24276 | acc=0.9547 | tpr=0.8953 | fpr=0.0442 | 8023.6 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.24036 | acc=0.9551 | tpr=0.8948 | fpr=0.0438 | 7851.3 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.23979 | acc=0.9547 | tpr=0.8895 | fpr=0.0441 | 7653.7 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.24298 | acc=0.9542 | tpr=0.8885 | fpr=0.0446 | 8108.4 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.24410 | acc=0.9541 | tpr=0.8885 | fpr=0.0448 | 8417.5 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.24254 | acc=0.9543 | tpr=0.8870 | fpr=0.0444 | 10056.8 samples/s | 39.3 steps/s
Avg test loss: 0.24242, Avg test acc: 0.95434, Avg tpr: 0.88669, Avg fpr: 0.04443, total FA: 6169

server round 19/50

clients selected: [1 2 4 5 7]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=24001 Epoch=117.1] | Loss=0.03930 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.657 | L2-Norm(final)=13.593 | 7266.9 samples/s | 113.5 steps/s
[Step=24050 Epoch=117.4] | Loss=0.04375 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.660 | L2-Norm(final)=13.591 | 4909.9 samples/s | 76.7 steps/s
[Step=24100 Epoch=117.6] | Loss=0.04187 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.661 | L2-Norm(final)=13.587 | 5454.9 samples/s | 85.2 steps/s
[Step=24150 Epoch=117.8] | Loss=0.04115 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.661 | L2-Norm(final)=13.590 | 5518.5 samples/s | 86.2 steps/s
[Step=24200 Epoch=118.1] | Loss=0.04163 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.661 | L2-Norm(final)=13.588 | 8766.6 samples/s | 137.0 steps/s
[Step=24250 Epoch=118.3] | Loss=0.04141 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.661 | L2-Norm(final)=13.587 | 2681.7 samples/s | 41.9 steps/s
[Step=24300 Epoch=118.6] | Loss=0.04164 | Reg=0.00136 | acc=0.9375 | L2-Norm=11.661 | L2-Norm(final)=13.588 | 5503.7 samples/s | 86.0 steps/s
[Step=24350 Epoch=118.8] | Loss=0.04091 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.661 | L2-Norm(final)=13.589 | 5603.9 samples/s | 87.6 steps/s
[Step=24400 Epoch=119.1] | Loss=0.04106 | Reg=0.00136 | acc=0.9375 | L2-Norm=11.661 | L2-Norm(final)=13.590 | 7681.0 samples/s | 120.0 steps/s
[Step=24450 Epoch=119.3] | Loss=0.04168 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.661 | L2-Norm(final)=13.590 | 2768.7 samples/s | 43.3 steps/s
[Step=24500 Epoch=119.5] | Loss=0.04164 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.661 | L2-Norm(final)=13.590 | 5592.7 samples/s | 87.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=119.6] | Loss=0.01650 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.661 | L2-Norm(final)=13.601 | 6793.5 samples/s | 106.1 steps/s
[Step=24550 Epoch=119.8] | Loss=0.04301 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.765 | L2-Norm(final)=13.590 | 4436.1 samples/s | 69.3 steps/s
[Step=24600 Epoch=120.0] | Loss=0.04236 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.896 | L2-Norm(final)=13.575 | 4793.3 samples/s | 74.9 steps/s
[Step=24650 Epoch=120.3] | Loss=0.04151 | Reg=0.00144 | acc=0.9688 | L2-Norm=11.981 | L2-Norm(final)=13.566 | 4735.1 samples/s | 74.0 steps/s
[Step=24700 Epoch=120.5] | Loss=0.03981 | Reg=0.00145 | acc=0.8906 | L2-Norm=12.046 | L2-Norm(final)=13.560 | 6857.9 samples/s | 107.2 steps/s
[Step=24750 Epoch=120.8] | Loss=0.03561 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.101 | L2-Norm(final)=13.555 | 2477.7 samples/s | 38.7 steps/s
[Step=24800 Epoch=121.0] | Loss=0.03278 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=13.555 | 4631.7 samples/s | 72.4 steps/s
[Step=24850 Epoch=121.3] | Loss=0.03093 | Reg=0.00149 | acc=0.9375 | L2-Norm=12.187 | L2-Norm(final)=13.554 | 4772.3 samples/s | 74.6 steps/s
[Step=24900 Epoch=121.5] | Loss=0.02896 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.221 | L2-Norm(final)=13.555 | 6380.1 samples/s | 99.7 steps/s
[Step=24950 Epoch=121.7] | Loss=0.02674 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=13.556 | 2536.7 samples/s | 39.6 steps/s
[Step=25000 Epoch=122.0] | Loss=0.02466 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.278 | L2-Norm(final)=13.557 | 4773.2 samples/s | 74.6 steps/s
[Step=25050 Epoch=122.2] | Loss=0.02325 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=13.559 | 4757.0 samples/s | 74.3 steps/s
[Step=25100 Epoch=122.5] | Loss=0.02246 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.321 | L2-Norm(final)=13.561 | 5929.7 samples/s | 92.7 steps/s
[Step=25150 Epoch=122.7] | Loss=0.02130 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.339 | L2-Norm(final)=13.563 | 2637.8 samples/s | 41.2 steps/s
[Step=25200 Epoch=123.0] | Loss=0.02034 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.356 | L2-Norm(final)=13.564 | 4663.0 samples/s | 72.9 steps/s
[Step=25250 Epoch=123.2] | Loss=0.01956 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=13.566 | 4728.8 samples/s | 73.9 steps/s
[Step=25300 Epoch=123.5] | Loss=0.01888 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.385 | L2-Norm(final)=13.567 | 5516.7 samples/s | 86.2 steps/s
[Step=25350 Epoch=123.7] | Loss=0.01817 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.397 | L2-Norm(final)=13.569 | 2728.8 samples/s | 42.6 steps/s
[Step=25400 Epoch=123.9] | Loss=0.01743 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.409 | L2-Norm(final)=13.570 | 4650.4 samples/s | 72.7 steps/s
[Step=25450 Epoch=124.2] | Loss=0.01680 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.420 | L2-Norm(final)=13.572 | 4778.8 samples/s | 74.7 steps/s
[Step=25500 Epoch=124.4] | Loss=0.01631 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.429 | L2-Norm(final)=13.573 | 5131.4 samples/s | 80.2 steps/s
[Step=25550 Epoch=124.7] | Loss=0.01580 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=13.575 | 2810.8 samples/s | 43.9 steps/s
[Step=25600 Epoch=124.9] | Loss=0.01533 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.448 | L2-Norm(final)=13.577 | 4781.9 samples/s | 74.7 steps/s
[Step=25650 Epoch=125.2] | Loss=0.01483 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=13.578 | 4804.5 samples/s | 75.1 steps/s
[Step=25700 Epoch=125.4] | Loss=0.01438 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.465 | L2-Norm(final)=13.580 | 4736.1 samples/s | 74.0 steps/s
[Step=25750 Epoch=125.6] | Loss=0.01410 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.472 | L2-Norm(final)=13.582 | 2887.1 samples/s | 45.1 steps/s
[Step=25800 Epoch=125.9] | Loss=0.01376 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=13.584 | 4773.1 samples/s | 74.6 steps/s
[Step=25850 Epoch=126.1] | Loss=0.01338 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=13.585 | 4755.1 samples/s | 74.3 steps/s
[Step=25900 Epoch=126.4] | Loss=0.01304 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.494 | L2-Norm(final)=13.587 | 4763.9 samples/s | 74.4 steps/s
[Step=25950 Epoch=126.6] | Loss=0.01279 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.500 | L2-Norm(final)=13.589 | 2939.0 samples/s | 45.9 steps/s
[Step=26000 Epoch=126.9] | Loss=0.01257 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.507 | L2-Norm(final)=13.591 | 4779.5 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step26000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.05581 | Reg=0.00136 | acc=0.9531 | L2-Norm=11.657 | L2-Norm(final)=9.600 | 7030.3 samples/s | 109.8 steps/s
[Step=12050 Epoch=58.7] | Loss=0.06299 | Reg=0.00136 | acc=0.9375 | L2-Norm=11.659 | L2-Norm(final)=9.597 | 4968.0 samples/s | 77.6 steps/s
[Step=12100 Epoch=59.0] | Loss=0.05441 | Reg=0.00136 | acc=0.9375 | L2-Norm=11.660 | L2-Norm(final)=9.620 | 5427.6 samples/s | 84.8 steps/s
[Step=12150 Epoch=59.2] | Loss=0.05067 | Reg=0.00136 | acc=0.9219 | L2-Norm=11.660 | L2-Norm(final)=9.655 | 5560.4 samples/s | 86.9 steps/s
[Step=12200 Epoch=59.4] | Loss=0.04814 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.660 | L2-Norm(final)=9.695 | 8701.2 samples/s | 136.0 steps/s
[Step=12250 Epoch=59.7] | Loss=0.04618 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.660 | L2-Norm(final)=9.738 | 2679.2 samples/s | 41.9 steps/s
[Step=12300 Epoch=59.9] | Loss=0.04648 | Reg=0.00136 | acc=0.9375 | L2-Norm=11.660 | L2-Norm(final)=9.781 | 5548.3 samples/s | 86.7 steps/s
[Step=12350 Epoch=60.2] | Loss=0.04547 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.660 | L2-Norm(final)=9.824 | 5586.1 samples/s | 87.3 steps/s
[Step=12400 Epoch=60.4] | Loss=0.04561 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.660 | L2-Norm(final)=9.866 | 7650.8 samples/s | 119.5 steps/s
[Step=12450 Epoch=60.7] | Loss=0.04489 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.660 | L2-Norm(final)=9.907 | 2785.3 samples/s | 43.5 steps/s
[Step=12500 Epoch=60.9] | Loss=0.04458 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.660 | L2-Norm(final)=9.947 | 5528.4 samples/s | 86.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=60.9] | Loss=0.03054 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.660 | L2-Norm(final)=10.350 | 6997.2 samples/s | 109.3 steps/s
[Step=12550 Epoch=61.1] | Loss=0.04764 | Reg=0.00139 | acc=0.8750 | L2-Norm=11.791 | L2-Norm(final)=10.353 | 4391.0 samples/s | 68.6 steps/s
[Step=12600 Epoch=61.4] | Loss=0.05061 | Reg=0.00142 | acc=0.9531 | L2-Norm=11.924 | L2-Norm(final)=10.331 | 4708.5 samples/s | 73.6 steps/s
[Step=12650 Epoch=61.6] | Loss=0.04709 | Reg=0.00144 | acc=0.9688 | L2-Norm=12.018 | L2-Norm(final)=10.321 | 4783.1 samples/s | 74.7 steps/s
[Step=12700 Epoch=61.9] | Loss=0.04430 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.091 | L2-Norm(final)=10.317 | 6774.7 samples/s | 105.9 steps/s
[Step=12750 Epoch=62.1] | Loss=0.04000 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.152 | L2-Norm(final)=10.314 | 2496.8 samples/s | 39.0 steps/s
[Step=12800 Epoch=62.4] | Loss=0.03603 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.199 | L2-Norm(final)=10.314 | 4712.5 samples/s | 73.6 steps/s
[Step=12850 Epoch=62.6] | Loss=0.03383 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.238 | L2-Norm(final)=10.314 | 4788.3 samples/s | 74.8 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03144 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.272 | L2-Norm(final)=10.315 | 6228.2 samples/s | 97.3 steps/s
[Step=12950 Epoch=63.1] | Loss=0.02933 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=10.316 | 2580.6 samples/s | 40.3 steps/s
[Step=13000 Epoch=63.3] | Loss=0.02742 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.328 | L2-Norm(final)=10.318 | 4723.7 samples/s | 73.8 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02608 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.352 | L2-Norm(final)=10.321 | 4755.0 samples/s | 74.3 steps/s
[Step=13100 Epoch=63.8] | Loss=0.02477 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.374 | L2-Norm(final)=10.323 | 5748.9 samples/s | 89.8 steps/s
[Step=13150 Epoch=64.1] | Loss=0.02375 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.396 | L2-Norm(final)=10.326 | 2645.6 samples/s | 41.3 steps/s
[Step=13200 Epoch=64.3] | Loss=0.02278 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.415 | L2-Norm(final)=10.328 | 4756.6 samples/s | 74.3 steps/s
[Step=13250 Epoch=64.6] | Loss=0.02196 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.433 | L2-Norm(final)=10.330 | 4758.8 samples/s | 74.4 steps/s
[Step=13300 Epoch=64.8] | Loss=0.02098 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.450 | L2-Norm(final)=10.332 | 5296.8 samples/s | 82.8 steps/s
[Step=13350 Epoch=65.0] | Loss=0.02024 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=10.334 | 2789.1 samples/s | 43.6 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01943 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.480 | L2-Norm(final)=10.336 | 4791.1 samples/s | 74.9 steps/s
[Step=13450 Epoch=65.5] | Loss=0.01875 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.493 | L2-Norm(final)=10.339 | 4756.0 samples/s | 74.3 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01808 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=10.341 | 4861.4 samples/s | 76.0 steps/s
[Step=13550 Epoch=66.0] | Loss=0.01756 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.518 | L2-Norm(final)=10.344 | 2917.6 samples/s | 45.6 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01697 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=10.347 | 4737.5 samples/s | 74.0 steps/s
[Step=13650 Epoch=66.5] | Loss=0.01650 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.539 | L2-Norm(final)=10.349 | 4742.1 samples/s | 74.1 steps/s
[Step=13700 Epoch=66.8] | Loss=0.01609 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=10.352 | 4726.0 samples/s | 73.8 steps/s
[Step=13750 Epoch=67.0] | Loss=0.01566 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.558 | L2-Norm(final)=10.355 | 2949.1 samples/s | 46.1 steps/s
[Step=13800 Epoch=67.2] | Loss=0.01518 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.567 | L2-Norm(final)=10.357 | 4761.0 samples/s | 74.4 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01480 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.574 | L2-Norm(final)=10.360 | 4742.4 samples/s | 74.1 steps/s
[Step=13900 Epoch=67.7] | Loss=0.01447 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.581 | L2-Norm(final)=10.362 | 4784.0 samples/s | 74.7 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01411 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.588 | L2-Norm(final)=10.365 | 2951.7 samples/s | 46.1 steps/s
[Step=14000 Epoch=68.2] | Loss=0.01376 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.595 | L2-Norm(final)=10.367 | 4827.2 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step14000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=68.7] | Loss=0.08741 | Reg=0.00136 | acc=0.9375 | L2-Norm=11.657 | L2-Norm(final)=12.359 | 6545.6 samples/s | 102.3 steps/s
[Step=14050 Epoch=68.9] | Loss=0.03402 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.657 | L2-Norm(final)=12.380 | 4979.3 samples/s | 77.8 steps/s
[Step=14100 Epoch=69.1] | Loss=0.03837 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.657 | L2-Norm(final)=12.411 | 5554.5 samples/s | 86.8 steps/s
[Step=14150 Epoch=69.4] | Loss=0.03835 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.657 | L2-Norm(final)=12.431 | 5632.7 samples/s | 88.0 steps/s
[Step=14200 Epoch=69.6] | Loss=0.03792 | Reg=0.00136 | acc=0.9531 | L2-Norm=11.657 | L2-Norm(final)=12.450 | 8769.2 samples/s | 137.0 steps/s
[Step=14250 Epoch=69.9] | Loss=0.03861 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.657 | L2-Norm(final)=12.469 | 2636.4 samples/s | 41.2 steps/s
[Step=14300 Epoch=70.1] | Loss=0.03819 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.657 | L2-Norm(final)=12.487 | 5545.3 samples/s | 86.6 steps/s
[Step=14350 Epoch=70.4] | Loss=0.03758 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.657 | L2-Norm(final)=12.506 | 5584.4 samples/s | 87.3 steps/s
[Step=14400 Epoch=70.6] | Loss=0.03759 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.657 | L2-Norm(final)=12.526 | 8101.4 samples/s | 126.6 steps/s
[Step=14450 Epoch=70.9] | Loss=0.03779 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.657 | L2-Norm(final)=12.547 | 2752.7 samples/s | 43.0 steps/s
[Step=14500 Epoch=71.1] | Loss=0.03751 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.657 | L2-Norm(final)=12.568 | 5508.8 samples/s | 86.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=71.1] | Loss=0.05539 | Reg=0.00136 | acc=0.9531 | L2-Norm=11.657 | L2-Norm(final)=12.791 | 7151.9 samples/s | 111.7 steps/s
[Step=14550 Epoch=71.4] | Loss=0.05115 | Reg=0.00139 | acc=0.9531 | L2-Norm=11.792 | L2-Norm(final)=12.787 | 4600.7 samples/s | 71.9 steps/s
[Step=14600 Epoch=71.6] | Loss=0.04458 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.904 | L2-Norm(final)=12.775 | 4814.4 samples/s | 75.2 steps/s
[Step=14650 Epoch=71.8] | Loss=0.04234 | Reg=0.00144 | acc=0.9688 | L2-Norm=11.982 | L2-Norm(final)=12.768 | 4824.0 samples/s | 75.4 steps/s
[Step=14700 Epoch=72.1] | Loss=0.03969 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.049 | L2-Norm(final)=12.765 | 6757.4 samples/s | 105.6 steps/s
[Step=14750 Epoch=72.3] | Loss=0.03446 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.105 | L2-Norm(final)=12.766 | 2451.9 samples/s | 38.3 steps/s
[Step=14800 Epoch=72.6] | Loss=0.03138 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.153 | L2-Norm(final)=12.770 | 4783.5 samples/s | 74.7 steps/s
[Step=14850 Epoch=72.8] | Loss=0.02985 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.193 | L2-Norm(final)=12.772 | 4716.3 samples/s | 73.7 steps/s
[Step=14900 Epoch=73.1] | Loss=0.02786 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.231 | L2-Norm(final)=12.775 | 6547.2 samples/s | 102.3 steps/s
[Step=14950 Epoch=73.3] | Loss=0.02593 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.264 | L2-Norm(final)=12.778 | 2496.9 samples/s | 39.0 steps/s
[Step=15000 Epoch=73.6] | Loss=0.02460 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.293 | L2-Norm(final)=12.781 | 4724.4 samples/s | 73.8 steps/s
[Step=15050 Epoch=73.8] | Loss=0.02341 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.318 | L2-Norm(final)=12.784 | 4788.6 samples/s | 74.8 steps/s
[Step=15100 Epoch=74.0] | Loss=0.02222 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.341 | L2-Norm(final)=12.787 | 6212.7 samples/s | 97.1 steps/s
[Step=15150 Epoch=74.3] | Loss=0.02095 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.362 | L2-Norm(final)=12.790 | 2580.4 samples/s | 40.3 steps/s
[Step=15200 Epoch=74.5] | Loss=0.01999 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.381 | L2-Norm(final)=12.794 | 4762.7 samples/s | 74.4 steps/s
[Step=15250 Epoch=74.8] | Loss=0.01912 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.398 | L2-Norm(final)=12.797 | 4740.5 samples/s | 74.1 steps/s
[Step=15300 Epoch=75.0] | Loss=0.01827 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.414 | L2-Norm(final)=12.800 | 5845.8 samples/s | 91.3 steps/s
[Step=15350 Epoch=75.3] | Loss=0.01745 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.428 | L2-Norm(final)=12.802 | 2630.6 samples/s | 41.1 steps/s
[Step=15400 Epoch=75.5] | Loss=0.01671 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=12.806 | 4853.2 samples/s | 75.8 steps/s
[Step=15450 Epoch=75.8] | Loss=0.01608 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.452 | L2-Norm(final)=12.809 | 4620.7 samples/s | 72.2 steps/s
[Step=15500 Epoch=76.0] | Loss=0.01568 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.463 | L2-Norm(final)=12.812 | 5592.9 samples/s | 87.4 steps/s
[Step=15550 Epoch=76.3] | Loss=0.01520 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.472 | L2-Norm(final)=12.814 | 2685.3 samples/s | 42.0 steps/s
[Step=15600 Epoch=76.5] | Loss=0.01464 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=12.817 | 4799.5 samples/s | 75.0 steps/s
[Step=15650 Epoch=76.7] | Loss=0.01415 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.490 | L2-Norm(final)=12.820 | 4794.1 samples/s | 74.9 steps/s
[Step=15700 Epoch=77.0] | Loss=0.01376 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=12.822 | 5136.8 samples/s | 80.3 steps/s
[Step=15750 Epoch=77.2] | Loss=0.01333 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.505 | L2-Norm(final)=12.825 | 2763.5 samples/s | 43.2 steps/s
[Step=15800 Epoch=77.5] | Loss=0.01291 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.512 | L2-Norm(final)=12.828 | 4793.0 samples/s | 74.9 steps/s
[Step=15850 Epoch=77.7] | Loss=0.01252 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.518 | L2-Norm(final)=12.831 | 4844.1 samples/s | 75.7 steps/s
[Step=15900 Epoch=78.0] | Loss=0.01225 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=12.834 | 4873.1 samples/s | 76.1 steps/s
[Step=15950 Epoch=78.2] | Loss=0.01196 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=12.837 | 2823.8 samples/s | 44.1 steps/s
[Step=16000 Epoch=78.5] | Loss=0.01166 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=12.840 | 4824.6 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=30001 Epoch=284.3] | Loss=0.00217 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.657 | L2-Norm(final)=16.667 | 7119.2 samples/s | 111.2 steps/s
[Step=30050 Epoch=284.7] | Loss=0.00044 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=16.668 | 4546.1 samples/s | 71.0 steps/s
[Step=30100 Epoch=285.2] | Loss=0.00057 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=16.674 | 7942.9 samples/s | 124.1 steps/s
[Step=30150 Epoch=285.7] | Loss=0.00066 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=16.683 | 2586.6 samples/s | 40.4 steps/s
[Step=30200 Epoch=286.2] | Loss=0.00067 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=16.693 | 7103.6 samples/s | 111.0 steps/s
[Step=30250 Epoch=286.6] | Loss=0.00061 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=16.702 | 2686.6 samples/s | 42.0 steps/s
[Step=30300 Epoch=287.1] | Loss=0.00065 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=16.710 | 6421.9 samples/s | 100.3 steps/s
[Step=30350 Epoch=287.6] | Loss=0.00065 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=16.719 | 2790.2 samples/s | 43.6 steps/s
[Step=30400 Epoch=288.1] | Loss=0.00064 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=16.727 | 5951.1 samples/s | 93.0 steps/s
[Step=30450 Epoch=288.5] | Loss=0.00062 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=16.736 | 2937.9 samples/s | 45.9 steps/s
[Step=30500 Epoch=289.0] | Loss=0.00063 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=16.745 | 5378.5 samples/s | 84.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=30501 Epoch=289.0] | Loss=0.00174 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=16.835 | 6829.3 samples/s | 106.7 steps/s
[Step=30550 Epoch=289.5] | Loss=0.00216 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.678 | L2-Norm(final)=16.834 | 4071.4 samples/s | 63.6 steps/s
[Step=30600 Epoch=290.0] | Loss=0.00245 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.725 | L2-Norm(final)=16.829 | 6579.0 samples/s | 102.8 steps/s
[Step=30650 Epoch=290.4] | Loss=0.00222 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.773 | L2-Norm(final)=16.824 | 2413.8 samples/s | 37.7 steps/s
[Step=30700 Epoch=290.9] | Loss=0.00170 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=16.823 | 5809.5 samples/s | 90.8 steps/s
[Step=30750 Epoch=291.4] | Loss=0.00136 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.827 | L2-Norm(final)=16.824 | 2493.9 samples/s | 39.0 steps/s
[Step=30800 Epoch=291.9] | Loss=0.00113 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.833 | L2-Norm(final)=16.824 | 5417.3 samples/s | 84.6 steps/s
[Step=30850 Epoch=292.3] | Loss=0.00097 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.833 | L2-Norm(final)=16.825 | 2583.6 samples/s | 40.4 steps/s
[Step=30900 Epoch=292.8] | Loss=0.00085 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.829 | L2-Norm(final)=16.826 | 5032.9 samples/s | 78.6 steps/s
[Step=30950 Epoch=293.3] | Loss=0.00076 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.822 | L2-Norm(final)=16.826 | 2687.6 samples/s | 42.0 steps/s
[Step=31000 Epoch=293.8] | Loss=0.00068 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.815 | L2-Norm(final)=16.826 | 4642.1 samples/s | 72.5 steps/s
[Step=31050 Epoch=294.2] | Loss=0.00062 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.806 | L2-Norm(final)=16.827 | 2794.1 samples/s | 43.7 steps/s
[Step=31100 Epoch=294.7] | Loss=0.00057 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.797 | L2-Norm(final)=16.827 | 4600.6 samples/s | 71.9 steps/s
[Step=31150 Epoch=295.2] | Loss=0.00053 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.787 | L2-Norm(final)=16.828 | 2829.4 samples/s | 44.2 steps/s
[Step=31200 Epoch=295.6] | Loss=0.00049 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.777 | L2-Norm(final)=16.828 | 4549.0 samples/s | 71.1 steps/s
[Step=31250 Epoch=296.1] | Loss=0.00046 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.767 | L2-Norm(final)=16.828 | 2882.4 samples/s | 45.0 steps/s
[Step=31300 Epoch=296.6] | Loss=0.00043 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.756 | L2-Norm(final)=16.829 | 4547.1 samples/s | 71.0 steps/s
[Step=31350 Epoch=297.1] | Loss=0.00040 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.745 | L2-Norm(final)=16.829 | 2915.9 samples/s | 45.6 steps/s
[Step=31400 Epoch=297.5] | Loss=0.00038 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.734 | L2-Norm(final)=16.829 | 4363.2 samples/s | 68.2 steps/s
[Step=31450 Epoch=298.0] | Loss=0.00036 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.723 | L2-Norm(final)=16.830 | 6722.7 samples/s | 105.0 steps/s
[Step=31500 Epoch=298.5] | Loss=0.00034 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.712 | L2-Norm(final)=16.830 | 2368.8 samples/s | 37.0 steps/s
[Step=31550 Epoch=299.0] | Loss=0.00033 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.701 | L2-Norm(final)=16.830 | 6037.5 samples/s | 94.3 steps/s
[Step=31600 Epoch=299.4] | Loss=0.00031 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.690 | L2-Norm(final)=16.830 | 2448.8 samples/s | 38.3 steps/s
[Step=31650 Epoch=299.9] | Loss=0.00030 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.679 | L2-Norm(final)=16.831 | 5606.5 samples/s | 87.6 steps/s
[Step=31700 Epoch=300.4] | Loss=0.00029 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.668 | L2-Norm(final)=16.831 | 2523.6 samples/s | 39.4 steps/s
[Step=31750 Epoch=300.9] | Loss=0.00027 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.656 | L2-Norm(final)=16.831 | 5168.2 samples/s | 80.8 steps/s
[Step=31800 Epoch=301.3] | Loss=0.00026 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.645 | L2-Norm(final)=16.832 | 2650.0 samples/s | 41.4 steps/s
[Step=31850 Epoch=301.8] | Loss=0.00025 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.634 | L2-Norm(final)=16.832 | 4792.5 samples/s | 74.9 steps/s
[Step=31900 Epoch=302.3] | Loss=0.00024 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.623 | L2-Norm(final)=16.832 | 2773.2 samples/s | 43.3 steps/s
[Step=31950 Epoch=302.8] | Loss=0.00024 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.611 | L2-Norm(final)=16.832 | 4574.0 samples/s | 71.5 steps/s
[Step=32000 Epoch=303.2] | Loss=0.00023 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.600 | L2-Norm(final)=16.833 | 2839.2 samples/s | 44.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step32000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=152.8] | Loss=0.00783 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.657 | L2-Norm(final)=11.673 | 6614.5 samples/s | 103.4 steps/s
[Step=16050 Epoch=153.3] | Loss=0.00418 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.651 | L2-Norm(final)=11.672 | 4906.5 samples/s | 76.7 steps/s
[Step=16100 Epoch=153.7] | Loss=0.00349 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.650 | L2-Norm(final)=11.698 | 7969.2 samples/s | 124.5 steps/s
[Step=16150 Epoch=154.2] | Loss=0.00364 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.649 | L2-Norm(final)=11.738 | 2542.6 samples/s | 39.7 steps/s
[Step=16200 Epoch=154.7] | Loss=0.00318 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.649 | L2-Norm(final)=11.778 | 7654.2 samples/s | 119.6 steps/s
[Step=16250 Epoch=155.2] | Loss=0.00321 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.649 | L2-Norm(final)=11.819 | 2634.8 samples/s | 41.2 steps/s
[Step=16300 Epoch=155.7] | Loss=0.00301 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.649 | L2-Norm(final)=11.859 | 6921.8 samples/s | 108.2 steps/s
[Step=16350 Epoch=156.1] | Loss=0.00309 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.649 | L2-Norm(final)=11.900 | 2740.4 samples/s | 42.8 steps/s
[Step=16400 Epoch=156.6] | Loss=0.00294 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.649 | L2-Norm(final)=11.939 | 6243.9 samples/s | 97.6 steps/s
[Step=16450 Epoch=157.1] | Loss=0.00312 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.649 | L2-Norm(final)=11.979 | 2851.7 samples/s | 44.6 steps/s
[Step=16500 Epoch=157.6] | Loss=0.00308 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.649 | L2-Norm(final)=12.018 | 5790.2 samples/s | 90.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=157.6] | Loss=0.00878 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.649 | L2-Norm(final)=12.396 | 7207.3 samples/s | 112.6 steps/s
[Step=16550 Epoch=158.0] | Loss=0.00979 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.861 | L2-Norm(final)=12.403 | 4052.8 samples/s | 63.3 steps/s
[Step=16600 Epoch=158.5] | Loss=0.00670 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.054 | L2-Norm(final)=12.374 | 6710.3 samples/s | 104.8 steps/s
[Step=16650 Epoch=159.0] | Loss=0.00525 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=12.360 | 2371.4 samples/s | 37.1 steps/s
[Step=16700 Epoch=159.5] | Loss=0.00403 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.191 | L2-Norm(final)=12.354 | 6168.4 samples/s | 96.4 steps/s
[Step=16750 Epoch=160.0] | Loss=0.00324 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=12.351 | 2469.6 samples/s | 38.6 steps/s
[Step=16800 Epoch=160.4] | Loss=0.00271 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.218 | L2-Norm(final)=12.350 | 5692.9 samples/s | 89.0 steps/s
[Step=16850 Epoch=160.9] | Loss=0.00232 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=12.349 | 2528.4 samples/s | 39.5 steps/s
[Step=16900 Epoch=161.4] | Loss=0.00203 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=12.349 | 5282.6 samples/s | 82.5 steps/s
[Step=16950 Epoch=161.9] | Loss=0.00181 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=12.349 | 2604.7 samples/s | 40.7 steps/s
[Step=17000 Epoch=162.3] | Loss=0.00163 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.192 | L2-Norm(final)=12.349 | 4948.4 samples/s | 77.3 steps/s
[Step=17050 Epoch=162.8] | Loss=0.00148 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=12.348 | 2707.7 samples/s | 42.3 steps/s
[Step=17100 Epoch=163.3] | Loss=0.00136 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=12.349 | 4638.0 samples/s | 72.5 steps/s
[Step=17150 Epoch=163.8] | Loss=0.00125 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=12.349 | 2805.3 samples/s | 43.8 steps/s
[Step=17200 Epoch=164.2] | Loss=0.00116 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=12.349 | 4551.5 samples/s | 71.1 steps/s
[Step=17250 Epoch=164.7] | Loss=0.00109 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.129 | L2-Norm(final)=12.349 | 2860.5 samples/s | 44.7 steps/s
[Step=17300 Epoch=165.2] | Loss=0.00102 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.115 | L2-Norm(final)=12.349 | 4506.4 samples/s | 70.4 steps/s
[Step=17350 Epoch=165.7] | Loss=0.00096 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.101 | L2-Norm(final)=12.349 | 2902.2 samples/s | 45.3 steps/s
[Step=17400 Epoch=166.2] | Loss=0.00090 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.087 | L2-Norm(final)=12.349 | 4459.5 samples/s | 69.7 steps/s
[Step=17450 Epoch=166.6] | Loss=0.00086 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=12.350 | 2969.8 samples/s | 46.4 steps/s
[Step=17500 Epoch=167.1] | Loss=0.00081 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.059 | L2-Norm(final)=12.350 | 4343.5 samples/s | 67.9 steps/s
[Step=17550 Epoch=167.6] | Loss=0.00078 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.044 | L2-Norm(final)=12.350 | 7263.8 samples/s | 113.5 steps/s
[Step=17600 Epoch=168.1] | Loss=0.00074 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.030 | L2-Norm(final)=12.350 | 2311.6 samples/s | 36.1 steps/s
[Step=17650 Epoch=168.5] | Loss=0.00071 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.016 | L2-Norm(final)=12.351 | 6775.3 samples/s | 105.9 steps/s
[Step=17700 Epoch=169.0] | Loss=0.00068 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.002 | L2-Norm(final)=12.351 | 2380.5 samples/s | 37.2 steps/s
[Step=17750 Epoch=169.5] | Loss=0.00065 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.988 | L2-Norm(final)=12.351 | 6080.9 samples/s | 95.0 steps/s
[Step=17800 Epoch=170.0] | Loss=0.00063 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.974 | L2-Norm(final)=12.351 | 2456.8 samples/s | 38.4 steps/s
[Step=17850 Epoch=170.5] | Loss=0.00060 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.960 | L2-Norm(final)=12.352 | 5646.2 samples/s | 88.2 steps/s
[Step=17900 Epoch=170.9] | Loss=0.00058 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.946 | L2-Norm(final)=12.352 | 2503.8 samples/s | 39.1 steps/s
[Step=17950 Epoch=171.4] | Loss=0.00056 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.932 | L2-Norm(final)=12.352 | 5293.2 samples/s | 82.7 steps/s
[Step=18000 Epoch=171.9] | Loss=0.00054 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.917 | L2-Norm(final)=12.353 | 2614.1 samples/s | 40.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step18000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10394 | acc=0.9549 | tpr=0.9707 | fpr=0.0793 | 5861.0 samples/s | 22.9 steps/s
Avg test loss: 0.11508, Avg test acc: 0.95064, Avg tpr: 0.96765, Avg fpr: 0.08678, total FA: 677

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.13077 | acc=0.9484 | tpr=0.9791 | fpr=0.1182 | 6016.5 samples/s | 23.5 steps/s
Avg test loss: 0.13056, Avg test acc: 0.94859, Avg tpr: 0.97832, Avg fpr: 0.11678, total FA: 911

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.12033 | acc=0.9534 | tpr=0.9732 | fpr=0.0894 | 5924.4 samples/s | 23.1 steps/s
Avg test loss: 0.12040, Avg test acc: 0.95300, Avg tpr: 0.97173, Avg fpr: 0.08819, total FA: 688

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10846 | acc=0.9530 | tpr=0.9612 | fpr=0.0649 | 5855.1 samples/s | 22.9 steps/s
Avg test loss: 0.11939, Avg test acc: 0.94923, Avg tpr: 0.95803, Avg fpr: 0.07012, total FA: 547

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11715 | acc=0.9537 | tpr=0.9617 | fpr=0.0634 | 6069.5 samples/s | 23.7 steps/s
Avg test loss: 0.12395, Avg test acc: 0.95228, Avg tpr: 0.95920, Avg fpr: 0.06294, total FA: 491

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.86634 | acc=0.2957 | tpr=0.0161 | fpr=0.0971 | 6130.6 samples/s | 23.9 steps/s
Avg test loss: 6.87883, Avg test acc: 0.29377, Avg tpr: 0.01492, Avg fpr: 0.09294, total FA: 725

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.86704 | acc=0.3123 | tpr=0.0226 | fpr=0.0587 | 6135.0 samples/s | 24.0 steps/s
Avg test loss: 4.87636, Avg test acc: 0.31040, Avg tpr: 0.02256, Avg fpr: 0.05653, total FA: 441

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.53888 | acc=0.3059 | tpr=0.0186 | fpr=0.0701 | 5644.2 samples/s | 22.0 steps/s
Avg test loss: 4.54604, Avg test acc: 0.30355, Avg tpr: 0.01842, Avg fpr: 0.06935, total FA: 541

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.26259 | acc=0.2989 | tpr=0.0364 | fpr=0.1311 | 5921.2 samples/s | 23.1 steps/s
Avg test loss: 5.27132, Avg test acc: 0.29894, Avg tpr: 0.03736, Avg fpr: 0.12575, total FA: 981

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.92307 | acc=0.3152 | tpr=0.0104 | fpr=0.0230 | 5945.1 samples/s | 23.2 steps/s
Avg test loss: 5.94296, Avg test acc: 0.31277, Avg tpr: 0.00968, Avg fpr: 0.02064, total FA: 161

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.96854 | acc=0.1308 | tpr=0.7389 | fpr=0.8801 | 6062.8 samples/s | 23.7 steps/s
[Step= 100] | Loss=5.94230 | acc=0.1333 | tpr=0.7143 | fpr=0.8776 | 7649.4 samples/s | 29.9 steps/s
[Step= 150] | Loss=5.93543 | acc=0.1341 | tpr=0.7262 | fpr=0.8768 | 8301.6 samples/s | 32.4 steps/s
[Step= 200] | Loss=5.92761 | acc=0.1349 | tpr=0.7246 | fpr=0.8758 | 8075.6 samples/s | 31.5 steps/s
[Step= 250] | Loss=5.93450 | acc=0.1348 | tpr=0.7135 | fpr=0.8758 | 8166.3 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.92690 | acc=0.1345 | tpr=0.7127 | fpr=0.8760 | 7866.6 samples/s | 30.7 steps/s
[Step= 350] | Loss=5.93042 | acc=0.1344 | tpr=0.7170 | fpr=0.8762 | 8139.4 samples/s | 31.8 steps/s
[Step= 400] | Loss=5.92806 | acc=0.1347 | tpr=0.7133 | fpr=0.8759 | 7932.5 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.93250 | acc=0.1340 | tpr=0.7162 | fpr=0.8765 | 8115.3 samples/s | 31.7 steps/s
[Step= 500] | Loss=5.93111 | acc=0.1343 | tpr=0.7207 | fpr=0.8763 | 7743.2 samples/s | 30.2 steps/s
[Step= 550] | Loss=5.93290 | acc=0.1343 | tpr=0.7230 | fpr=0.8764 | 10226.2 samples/s | 39.9 steps/s
Avg test loss: 5.93360, Avg test acc: 0.13430, Avg tpr: 0.72385, Avg fpr: 0.87642, total FA: 121689

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.15135 | acc=0.1171 | tpr=0.7345 | fpr=0.8940 | 5909.8 samples/s | 23.1 steps/s
[Step= 100] | Loss=6.12843 | acc=0.1185 | tpr=0.7249 | fpr=0.8928 | 7304.2 samples/s | 28.5 steps/s
[Step= 150] | Loss=6.12530 | acc=0.1201 | tpr=0.7291 | fpr=0.8911 | 8156.8 samples/s | 31.9 steps/s
[Step= 200] | Loss=6.12114 | acc=0.1196 | tpr=0.7180 | fpr=0.8912 | 8168.7 samples/s | 31.9 steps/s
[Step= 250] | Loss=6.12302 | acc=0.1196 | tpr=0.7231 | fpr=0.8914 | 8342.3 samples/s | 32.6 steps/s
[Step= 300] | Loss=6.11747 | acc=0.1191 | tpr=0.7171 | fpr=0.8918 | 8276.2 samples/s | 32.3 steps/s
[Step= 350] | Loss=6.12908 | acc=0.1188 | tpr=0.7195 | fpr=0.8921 | 7971.9 samples/s | 31.1 steps/s
[Step= 400] | Loss=6.12530 | acc=0.1190 | tpr=0.7183 | fpr=0.8919 | 7779.8 samples/s | 30.4 steps/s
[Step= 450] | Loss=6.12891 | acc=0.1188 | tpr=0.7201 | fpr=0.8921 | 8274.2 samples/s | 32.3 steps/s
[Step= 500] | Loss=6.12872 | acc=0.1186 | tpr=0.7242 | fpr=0.8924 | 7582.0 samples/s | 29.6 steps/s
[Step= 550] | Loss=6.13506 | acc=0.1188 | tpr=0.7278 | fpr=0.8923 | 11387.5 samples/s | 44.5 steps/s
Avg test loss: 6.13551, Avg test acc: 0.11866, Avg tpr: 0.72821, Avg fpr: 0.89242, total FA: 123911

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.70458 | acc=0.1167 | tpr=0.7522 | fpr=0.8947 | 6157.0 samples/s | 24.1 steps/s
[Step= 100] | Loss=5.68649 | acc=0.1176 | tpr=0.7420 | fpr=0.8940 | 7723.6 samples/s | 30.2 steps/s
[Step= 150] | Loss=5.67981 | acc=0.1187 | tpr=0.7392 | fpr=0.8927 | 7322.6 samples/s | 28.6 steps/s
[Step= 200] | Loss=5.67573 | acc=0.1188 | tpr=0.7355 | fpr=0.8924 | 8252.2 samples/s | 32.2 steps/s
[Step= 250] | Loss=5.67782 | acc=0.1193 | tpr=0.7415 | fpr=0.8920 | 7937.8 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.67300 | acc=0.1191 | tpr=0.7382 | fpr=0.8922 | 8092.1 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.68081 | acc=0.1187 | tpr=0.7383 | fpr=0.8925 | 8386.5 samples/s | 32.8 steps/s
[Step= 400] | Loss=5.67938 | acc=0.1185 | tpr=0.7380 | fpr=0.8927 | 7759.6 samples/s | 30.3 steps/s
[Step= 450] | Loss=5.68359 | acc=0.1179 | tpr=0.7410 | fpr=0.8934 | 7944.6 samples/s | 31.0 steps/s
[Step= 500] | Loss=5.68323 | acc=0.1178 | tpr=0.7423 | fpr=0.8935 | 8351.8 samples/s | 32.6 steps/s
[Step= 550] | Loss=5.68750 | acc=0.1180 | tpr=0.7425 | fpr=0.8934 | 10423.6 samples/s | 40.7 steps/s
Avg test loss: 5.68757, Avg test acc: 0.11785, Avg tpr: 0.74287, Avg fpr: 0.89352, total FA: 124063

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.13132 | acc=0.1426 | tpr=0.6106 | fpr=0.8658 | 5988.7 samples/s | 23.4 steps/s
[Step= 100] | Loss=5.11608 | acc=0.1452 | tpr=0.6333 | fpr=0.8639 | 7451.5 samples/s | 29.1 steps/s
[Step= 150] | Loss=5.10841 | acc=0.1478 | tpr=0.6455 | fpr=0.8614 | 8513.7 samples/s | 33.3 steps/s
[Step= 200] | Loss=5.10525 | acc=0.1487 | tpr=0.6481 | fpr=0.8604 | 8239.5 samples/s | 32.2 steps/s
[Step= 250] | Loss=5.10786 | acc=0.1486 | tpr=0.6498 | fpr=0.8605 | 8153.7 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.10154 | acc=0.1488 | tpr=0.6444 | fpr=0.8602 | 7977.8 samples/s | 31.2 steps/s
[Step= 350] | Loss=5.10503 | acc=0.1487 | tpr=0.6462 | fpr=0.8603 | 7774.8 samples/s | 30.4 steps/s
[Step= 400] | Loss=5.10008 | acc=0.1493 | tpr=0.6450 | fpr=0.8597 | 8776.3 samples/s | 34.3 steps/s
[Step= 450] | Loss=5.10211 | acc=0.1489 | tpr=0.6470 | fpr=0.8601 | 7032.3 samples/s | 27.5 steps/s
[Step= 500] | Loss=5.10137 | acc=0.1490 | tpr=0.6542 | fpr=0.8601 | 8490.2 samples/s | 33.2 steps/s
[Step= 550] | Loss=5.10793 | acc=0.1490 | tpr=0.6542 | fpr=0.8601 | 10015.9 samples/s | 39.1 steps/s
Avg test loss: 5.10895, Avg test acc: 0.14899, Avg tpr: 0.65452, Avg fpr: 0.86020, total FA: 119437

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.29585 | acc=0.1362 | tpr=0.5708 | fpr=0.8716 | 6171.3 samples/s | 24.1 steps/s
[Step= 100] | Loss=5.28207 | acc=0.1372 | tpr=0.5736 | fpr=0.8709 | 7156.9 samples/s | 28.0 steps/s
[Step= 150] | Loss=5.26660 | acc=0.1386 | tpr=0.5749 | fpr=0.8694 | 7938.6 samples/s | 31.0 steps/s
[Step= 200] | Loss=5.26796 | acc=0.1395 | tpr=0.5738 | fpr=0.8684 | 8239.2 samples/s | 32.2 steps/s
[Step= 250] | Loss=5.26797 | acc=0.1391 | tpr=0.5677 | fpr=0.8687 | 8376.2 samples/s | 32.7 steps/s
[Step= 300] | Loss=5.26171 | acc=0.1395 | tpr=0.5724 | fpr=0.8684 | 8162.7 samples/s | 31.9 steps/s
[Step= 350] | Loss=5.27088 | acc=0.1393 | tpr=0.5654 | fpr=0.8684 | 8148.3 samples/s | 31.8 steps/s
[Step= 400] | Loss=5.26640 | acc=0.1396 | tpr=0.5629 | fpr=0.8681 | 8549.8 samples/s | 33.4 steps/s
[Step= 450] | Loss=5.27195 | acc=0.1388 | tpr=0.5682 | fpr=0.8689 | 8267.3 samples/s | 32.3 steps/s
[Step= 500] | Loss=5.27133 | acc=0.1389 | tpr=0.5714 | fpr=0.8689 | 7030.0 samples/s | 27.5 steps/s
[Step= 550] | Loss=5.27311 | acc=0.1389 | tpr=0.5726 | fpr=0.8689 | 10546.7 samples/s | 41.2 steps/s
Avg test loss: 5.27459, Avg test acc: 0.13887, Avg tpr: 0.57369, Avg fpr: 0.86904, total FA: 120664

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.21193 | acc=0.9596 | tpr=0.9204 | fpr=0.0397 | 6077.8 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.21355 | acc=0.9582 | tpr=0.9339 | fpr=0.0413 | 7257.5 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.21726 | acc=0.9569 | tpr=0.9294 | fpr=0.0426 | 7971.2 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.21787 | acc=0.9570 | tpr=0.9344 | fpr=0.0426 | 8124.9 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.21898 | acc=0.9568 | tpr=0.9319 | fpr=0.0427 | 8136.9 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.22126 | acc=0.9567 | tpr=0.9309 | fpr=0.0428 | 7750.6 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.22019 | acc=0.9570 | tpr=0.9317 | fpr=0.0425 | 8172.4 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.21943 | acc=0.9569 | tpr=0.9305 | fpr=0.0426 | 8161.2 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.22377 | acc=0.9564 | tpr=0.9294 | fpr=0.0431 | 7991.5 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.22337 | acc=0.9564 | tpr=0.9295 | fpr=0.0432 | 8247.0 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.22210 | acc=0.9566 | tpr=0.9288 | fpr=0.0429 | 11279.1 samples/s | 44.1 steps/s
Avg test loss: 0.22151, Avg test acc: 0.95665, Avg tpr: 0.92868, Avg fpr: 0.04285, total FA: 5949

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16689 | acc=0.9598 | tpr=0.9027 | fpr=0.0392 | 5933.0 samples/s | 23.2 steps/s
[Step= 100] | Loss=0.17173 | acc=0.9585 | tpr=0.9318 | fpr=0.0410 | 7892.5 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.17376 | acc=0.9573 | tpr=0.9366 | fpr=0.0423 | 8399.2 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.17493 | acc=0.9572 | tpr=0.9410 | fpr=0.0425 | 7654.5 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.17424 | acc=0.9573 | tpr=0.9362 | fpr=0.0424 | 8145.9 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.17571 | acc=0.9569 | tpr=0.9360 | fpr=0.0427 | 7674.4 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.17429 | acc=0.9571 | tpr=0.9374 | fpr=0.0425 | 7973.3 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.17386 | acc=0.9570 | tpr=0.9333 | fpr=0.0426 | 7662.5 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.17652 | acc=0.9565 | tpr=0.9309 | fpr=0.0430 | 8162.0 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.17638 | acc=0.9563 | tpr=0.9300 | fpr=0.0432 | 8125.6 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.17526 | acc=0.9565 | tpr=0.9276 | fpr=0.0430 | 10978.5 samples/s | 42.9 steps/s
Avg test loss: 0.17490, Avg test acc: 0.95653, Avg tpr: 0.92750, Avg fpr: 0.04295, total FA: 5963

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.29502 | acc=0.9495 | tpr=0.9381 | fpr=0.0503 | 5978.6 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.30097 | acc=0.9493 | tpr=0.9424 | fpr=0.0506 | 7799.4 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.30579 | acc=0.9486 | tpr=0.9424 | fpr=0.0512 | 7609.9 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.30498 | acc=0.9490 | tpr=0.9475 | fpr=0.0510 | 8044.4 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.30664 | acc=0.9488 | tpr=0.9467 | fpr=0.0512 | 7915.8 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.30943 | acc=0.9486 | tpr=0.9425 | fpr=0.0513 | 8803.4 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.30713 | acc=0.9488 | tpr=0.9436 | fpr=0.0511 | 8406.2 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.30703 | acc=0.9484 | tpr=0.9393 | fpr=0.0515 | 7829.9 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.30996 | acc=0.9479 | tpr=0.9372 | fpr=0.0519 | 8163.8 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.31201 | acc=0.9478 | tpr=0.9383 | fpr=0.0521 | 7924.8 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.31015 | acc=0.9480 | tpr=0.9371 | fpr=0.0518 | 9593.8 samples/s | 37.5 steps/s
Avg test loss: 0.30986, Avg test acc: 0.94801, Avg tpr: 0.93700, Avg fpr: 0.05179, total FA: 7191

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.12267 | acc=0.9668 | tpr=0.9336 | fpr=0.0326 | 5955.2 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.12575 | acc=0.9654 | tpr=0.9232 | fpr=0.0338 | 7705.4 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.12911 | acc=0.9647 | tpr=0.9280 | fpr=0.0346 | 8282.7 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.12950 | acc=0.9646 | tpr=0.9322 | fpr=0.0348 | 8252.5 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.13004 | acc=0.9646 | tpr=0.9249 | fpr=0.0347 | 8043.2 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.13213 | acc=0.9643 | tpr=0.9215 | fpr=0.0349 | 7804.1 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.13150 | acc=0.9645 | tpr=0.9211 | fpr=0.0347 | 7974.9 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.13147 | acc=0.9643 | tpr=0.9179 | fpr=0.0348 | 8109.0 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.13318 | acc=0.9641 | tpr=0.9167 | fpr=0.0351 | 7555.6 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.13335 | acc=0.9640 | tpr=0.9172 | fpr=0.0351 | 8514.7 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.13247 | acc=0.9641 | tpr=0.9152 | fpr=0.0350 | 10048.2 samples/s | 39.3 steps/s
Avg test loss: 0.13229, Avg test acc: 0.96412, Avg tpr: 0.91521, Avg fpr: 0.03499, total FA: 4858

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.22664 | acc=0.9567 | tpr=0.8673 | fpr=0.0417 | 5955.8 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.23346 | acc=0.9562 | tpr=0.8891 | fpr=0.0426 | 7951.9 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.23557 | acc=0.9559 | tpr=0.9006 | fpr=0.0431 | 7824.7 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.23629 | acc=0.9555 | tpr=0.9060 | fpr=0.0436 | 8036.2 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.23927 | acc=0.9552 | tpr=0.8978 | fpr=0.0438 | 8251.6 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.24276 | acc=0.9547 | tpr=0.8953 | fpr=0.0442 | 8049.2 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.24036 | acc=0.9551 | tpr=0.8948 | fpr=0.0438 | 7669.2 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.23979 | acc=0.9547 | tpr=0.8895 | fpr=0.0441 | 7739.4 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.24298 | acc=0.9542 | tpr=0.8885 | fpr=0.0446 | 8205.1 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.24410 | acc=0.9541 | tpr=0.8885 | fpr=0.0448 | 8349.7 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.24254 | acc=0.9543 | tpr=0.8870 | fpr=0.0444 | 10135.7 samples/s | 39.6 steps/s
Avg test loss: 0.24242, Avg test acc: 0.95434, Avg tpr: 0.88669, Avg fpr: 0.04443, total FA: 6169

server round 20/50

clients selected: [2 3 7 8 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=14001 Epoch=68.2] | Loss=0.02508 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.623 | L2-Norm(final)=10.444 | 7040.8 samples/s | 110.0 steps/s
[Step=14050 Epoch=68.5] | Loss=0.04297 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.623 | L2-Norm(final)=10.460 | 4965.2 samples/s | 77.6 steps/s
[Step=14100 Epoch=68.7] | Loss=0.04354 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.623 | L2-Norm(final)=10.483 | 5533.2 samples/s | 86.5 steps/s
[Step=14150 Epoch=68.9] | Loss=0.04295 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.623 | L2-Norm(final)=10.509 | 5692.9 samples/s | 89.0 steps/s
[Step=14200 Epoch=69.2] | Loss=0.04239 | Reg=0.00135 | acc=0.9375 | L2-Norm=11.623 | L2-Norm(final)=10.532 | 8348.8 samples/s | 130.5 steps/s
[Step=14250 Epoch=69.4] | Loss=0.04165 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.623 | L2-Norm(final)=10.556 | 2674.3 samples/s | 41.8 steps/s
[Step=14300 Epoch=69.7] | Loss=0.04114 | Reg=0.00135 | acc=0.9375 | L2-Norm=11.623 | L2-Norm(final)=10.581 | 5566.3 samples/s | 87.0 steps/s
[Step=14350 Epoch=69.9] | Loss=0.04158 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.623 | L2-Norm(final)=10.604 | 5604.8 samples/s | 87.6 steps/s
[Step=14400 Epoch=70.2] | Loss=0.04188 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.623 | L2-Norm(final)=10.627 | 7612.6 samples/s | 118.9 steps/s
[Step=14450 Epoch=70.4] | Loss=0.04181 | Reg=0.00135 | acc=0.9531 | L2-Norm=11.623 | L2-Norm(final)=10.648 | 2795.5 samples/s | 43.7 steps/s
[Step=14500 Epoch=70.7] | Loss=0.04198 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.623 | L2-Norm(final)=10.669 | 5532.5 samples/s | 86.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=14501 Epoch=70.7] | Loss=0.02558 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.623 | L2-Norm(final)=10.875 | 6659.3 samples/s | 104.1 steps/s
[Step=14550 Epoch=70.9] | Loss=0.03798 | Reg=0.00136 | acc=0.9531 | L2-Norm=11.662 | L2-Norm(final)=10.888 | 4491.1 samples/s | 70.2 steps/s
[Step=14600 Epoch=71.1] | Loss=0.03394 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.700 | L2-Norm(final)=10.889 | 4837.5 samples/s | 75.6 steps/s
[Step=14650 Epoch=71.4] | Loss=0.03050 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.727 | L2-Norm(final)=10.892 | 4675.8 samples/s | 73.1 steps/s
[Step=14700 Epoch=71.6] | Loss=0.02979 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.750 | L2-Norm(final)=10.895 | 6719.5 samples/s | 105.0 steps/s
[Step=14750 Epoch=71.9] | Loss=0.02544 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.769 | L2-Norm(final)=10.897 | 2512.5 samples/s | 39.3 steps/s
[Step=14800 Epoch=72.1] | Loss=0.02284 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.787 | L2-Norm(final)=10.902 | 4640.1 samples/s | 72.5 steps/s
[Step=14850 Epoch=72.4] | Loss=0.02114 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.803 | L2-Norm(final)=10.907 | 4790.6 samples/s | 74.9 steps/s
[Step=14900 Epoch=72.6] | Loss=0.01985 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.817 | L2-Norm(final)=10.912 | 6213.1 samples/s | 97.1 steps/s
[Step=14950 Epoch=72.8] | Loss=0.01867 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.829 | L2-Norm(final)=10.915 | 2570.6 samples/s | 40.2 steps/s
[Step=15000 Epoch=73.1] | Loss=0.01755 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.840 | L2-Norm(final)=10.919 | 4796.8 samples/s | 75.0 steps/s
[Step=15050 Epoch=73.3] | Loss=0.01654 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.850 | L2-Norm(final)=10.923 | 4727.1 samples/s | 73.9 steps/s
[Step=15100 Epoch=73.6] | Loss=0.01568 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.859 | L2-Norm(final)=10.928 | 5707.8 samples/s | 89.2 steps/s
[Step=15150 Epoch=73.8] | Loss=0.01474 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.867 | L2-Norm(final)=10.932 | 2677.0 samples/s | 41.8 steps/s
[Step=15200 Epoch=74.1] | Loss=0.01407 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.875 | L2-Norm(final)=10.936 | 4822.7 samples/s | 75.4 steps/s
[Step=15250 Epoch=74.3] | Loss=0.01344 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.882 | L2-Norm(final)=10.940 | 4734.5 samples/s | 74.0 steps/s
[Step=15300 Epoch=74.5] | Loss=0.01289 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.888 | L2-Norm(final)=10.943 | 5255.7 samples/s | 82.1 steps/s
[Step=15350 Epoch=74.8] | Loss=0.01254 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.894 | L2-Norm(final)=10.947 | 2781.5 samples/s | 43.5 steps/s
[Step=15400 Epoch=75.0] | Loss=0.01221 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=10.950 | 4803.8 samples/s | 75.1 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01182 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.905 | L2-Norm(final)=10.953 | 4711.1 samples/s | 73.6 steps/s
[Step=15500 Epoch=75.5] | Loss=0.01146 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.910 | L2-Norm(final)=10.956 | 4896.6 samples/s | 76.5 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01106 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.915 | L2-Norm(final)=10.959 | 2893.8 samples/s | 45.2 steps/s
[Step=15600 Epoch=76.0] | Loss=0.01073 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.920 | L2-Norm(final)=10.962 | 4754.3 samples/s | 74.3 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01044 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.924 | L2-Norm(final)=10.965 | 4766.3 samples/s | 74.5 steps/s
[Step=15700 Epoch=76.5] | Loss=0.01018 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.929 | L2-Norm(final)=10.968 | 4811.4 samples/s | 75.2 steps/s
[Step=15750 Epoch=76.7] | Loss=0.00992 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.933 | L2-Norm(final)=10.971 | 2945.7 samples/s | 46.0 steps/s
[Step=15800 Epoch=77.0] | Loss=0.00970 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.937 | L2-Norm(final)=10.974 | 4792.7 samples/s | 74.9 steps/s
[Step=15850 Epoch=77.2] | Loss=0.00947 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.940 | L2-Norm(final)=10.977 | 4712.9 samples/s | 73.6 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00929 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.944 | L2-Norm(final)=10.979 | 4768.1 samples/s | 74.5 steps/s
[Step=15950 Epoch=77.7] | Loss=0.00919 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.948 | L2-Norm(final)=10.982 | 2975.0 samples/s | 46.5 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00908 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.952 | L2-Norm(final)=10.985 | 4842.0 samples/s | 75.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step16000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=18001 Epoch=87.8] | Loss=0.03704 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.623 | L2-Norm(final)=12.314 | 5791.7 samples/s | 90.5 steps/s
[Step=18050 Epoch=88.0] | Loss=0.03829 | Reg=0.00135 | acc=0.9375 | L2-Norm=11.622 | L2-Norm(final)=12.325 | 5294.1 samples/s | 82.7 steps/s
[Step=18100 Epoch=88.3] | Loss=0.03831 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.622 | L2-Norm(final)=12.339 | 5370.8 samples/s | 83.9 steps/s
[Step=18150 Epoch=88.5] | Loss=0.03853 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.622 | L2-Norm(final)=12.354 | 5548.8 samples/s | 86.7 steps/s
[Step=18200 Epoch=88.8] | Loss=0.03808 | Reg=0.00135 | acc=0.9531 | L2-Norm=11.622 | L2-Norm(final)=12.367 | 8616.9 samples/s | 134.6 steps/s
[Step=18250 Epoch=89.0] | Loss=0.03742 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.622 | L2-Norm(final)=12.380 | 2703.1 samples/s | 42.2 steps/s
[Step=18300 Epoch=89.2] | Loss=0.03817 | Reg=0.00135 | acc=0.9531 | L2-Norm=11.622 | L2-Norm(final)=12.394 | 5508.3 samples/s | 86.1 steps/s
[Step=18350 Epoch=89.5] | Loss=0.03804 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.622 | L2-Norm(final)=12.407 | 5526.1 samples/s | 86.3 steps/s
[Step=18400 Epoch=89.7] | Loss=0.03801 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.622 | L2-Norm(final)=12.420 | 7584.8 samples/s | 118.5 steps/s
[Step=18450 Epoch=90.0] | Loss=0.03764 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.622 | L2-Norm(final)=12.433 | 2839.1 samples/s | 44.4 steps/s
[Step=18500 Epoch=90.2] | Loss=0.03755 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.622 | L2-Norm(final)=12.446 | 5507.8 samples/s | 86.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=90.2] | Loss=0.00962 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.622 | L2-Norm(final)=12.583 | 6693.6 samples/s | 104.6 steps/s
[Step=18550 Epoch=90.5] | Loss=0.03303 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=12.589 | 4426.7 samples/s | 69.2 steps/s
[Step=18600 Epoch=90.7] | Loss=0.03143 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.693 | L2-Norm(final)=12.592 | 4755.4 samples/s | 74.3 steps/s
[Step=18650 Epoch=90.9] | Loss=0.02857 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.725 | L2-Norm(final)=12.593 | 4769.1 samples/s | 74.5 steps/s
[Step=18700 Epoch=91.2] | Loss=0.02696 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.753 | L2-Norm(final)=12.594 | 6851.2 samples/s | 107.1 steps/s
[Step=18750 Epoch=91.4] | Loss=0.02333 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.776 | L2-Norm(final)=12.597 | 2474.5 samples/s | 38.7 steps/s
[Step=18800 Epoch=91.7] | Loss=0.02090 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.795 | L2-Norm(final)=12.601 | 4768.3 samples/s | 74.5 steps/s
[Step=18850 Epoch=91.9] | Loss=0.01914 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.811 | L2-Norm(final)=12.605 | 4787.5 samples/s | 74.8 steps/s
[Step=18900 Epoch=92.2] | Loss=0.01778 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.825 | L2-Norm(final)=12.609 | 6181.9 samples/s | 96.6 steps/s
[Step=18950 Epoch=92.4] | Loss=0.01624 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=12.614 | 2615.9 samples/s | 40.9 steps/s
[Step=19000 Epoch=92.7] | Loss=0.01509 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.848 | L2-Norm(final)=12.618 | 4663.4 samples/s | 72.9 steps/s
[Step=19050 Epoch=92.9] | Loss=0.01430 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.857 | L2-Norm(final)=12.622 | 4739.5 samples/s | 74.1 steps/s
[Step=19100 Epoch=93.1] | Loss=0.01351 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.866 | L2-Norm(final)=12.626 | 5720.5 samples/s | 89.4 steps/s
[Step=19150 Epoch=93.4] | Loss=0.01277 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.873 | L2-Norm(final)=12.629 | 2687.5 samples/s | 42.0 steps/s
[Step=19200 Epoch=93.6] | Loss=0.01212 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.880 | L2-Norm(final)=12.632 | 4719.0 samples/s | 73.7 steps/s
[Step=19250 Epoch=93.9] | Loss=0.01150 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.886 | L2-Norm(final)=12.636 | 4739.1 samples/s | 74.0 steps/s
[Step=19300 Epoch=94.1] | Loss=0.01108 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.892 | L2-Norm(final)=12.639 | 5287.4 samples/s | 82.6 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01072 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.898 | L2-Norm(final)=12.642 | 2802.9 samples/s | 43.8 steps/s
[Step=19400 Epoch=94.6] | Loss=0.01028 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=12.646 | 4752.7 samples/s | 74.3 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01013 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.908 | L2-Norm(final)=12.648 | 4748.7 samples/s | 74.2 steps/s
[Step=19500 Epoch=95.1] | Loss=0.00988 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.914 | L2-Norm(final)=12.651 | 4881.5 samples/s | 76.3 steps/s
[Step=19550 Epoch=95.3] | Loss=0.00962 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.919 | L2-Norm(final)=12.654 | 2896.0 samples/s | 45.2 steps/s
[Step=19600 Epoch=95.6] | Loss=0.00930 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.924 | L2-Norm(final)=12.656 | 4794.4 samples/s | 74.9 steps/s
[Step=19650 Epoch=95.8] | Loss=0.00911 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.929 | L2-Norm(final)=12.659 | 4811.4 samples/s | 75.2 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00887 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.933 | L2-Norm(final)=12.661 | 4671.2 samples/s | 73.0 steps/s
[Step=19750 Epoch=96.3] | Loss=0.00863 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.938 | L2-Norm(final)=12.663 | 3004.8 samples/s | 47.0 steps/s
[Step=19800 Epoch=96.6] | Loss=0.00836 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.942 | L2-Norm(final)=12.666 | 4749.9 samples/s | 74.2 steps/s
[Step=19850 Epoch=96.8] | Loss=0.00816 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.946 | L2-Norm(final)=12.668 | 4685.9 samples/s | 73.2 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00795 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.949 | L2-Norm(final)=12.671 | 4774.8 samples/s | 74.6 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00781 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.953 | L2-Norm(final)=12.673 | 2959.4 samples/s | 46.2 steps/s
[Step=20000 Epoch=97.5] | Loss=0.00764 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.956 | L2-Norm(final)=12.675 | 4746.4 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step20000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=18001 Epoch=171.9] | Loss=0.00096 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.623 | L2-Norm(final)=12.362 | 6842.4 samples/s | 106.9 steps/s
[Step=18050 Epoch=172.4] | Loss=0.00190 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=12.376 | 4605.4 samples/s | 72.0 steps/s
[Step=18100 Epoch=172.8] | Loss=0.00195 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.620 | L2-Norm(final)=12.392 | 8332.9 samples/s | 130.2 steps/s
[Step=18150 Epoch=173.3] | Loss=0.00186 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=12.406 | 2558.6 samples/s | 40.0 steps/s
[Step=18200 Epoch=173.8] | Loss=0.00207 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=12.419 | 7514.3 samples/s | 117.4 steps/s
[Step=18250 Epoch=174.3] | Loss=0.00213 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=12.434 | 2659.6 samples/s | 41.6 steps/s
[Step=18300 Epoch=174.8] | Loss=0.00213 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=12.448 | 6767.1 samples/s | 105.7 steps/s
[Step=18350 Epoch=175.2] | Loss=0.00198 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=12.463 | 2773.2 samples/s | 43.3 steps/s
[Step=18400 Epoch=175.7] | Loss=0.00210 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=12.477 | 6179.5 samples/s | 96.6 steps/s
[Step=18450 Epoch=176.2] | Loss=0.00210 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=12.491 | 2841.0 samples/s | 44.4 steps/s
[Step=18500 Epoch=176.7] | Loss=0.00208 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=12.504 | 5850.9 samples/s | 91.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=176.7] | Loss=0.00047 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=12.637 | 6689.8 samples/s | 104.5 steps/s
[Step=18550 Epoch=177.1] | Loss=0.00109 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.626 | L2-Norm(final)=12.647 | 4260.0 samples/s | 66.6 steps/s
[Step=18600 Epoch=177.6] | Loss=0.00088 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.631 | L2-Norm(final)=12.653 | 6740.9 samples/s | 105.3 steps/s
[Step=18650 Epoch=178.1] | Loss=0.00061 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.627 | L2-Norm(final)=12.657 | 2408.1 samples/s | 37.6 steps/s
[Step=18700 Epoch=178.6] | Loss=0.00046 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.617 | L2-Norm(final)=12.659 | 5961.4 samples/s | 93.1 steps/s
[Step=18750 Epoch=179.1] | Loss=0.00037 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.606 | L2-Norm(final)=12.661 | 2456.3 samples/s | 38.4 steps/s
[Step=18800 Epoch=179.5] | Loss=0.00031 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.594 | L2-Norm(final)=12.663 | 5639.5 samples/s | 88.1 steps/s
[Step=18850 Epoch=180.0] | Loss=0.00027 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=12.664 | 2493.4 samples/s | 39.0 steps/s
[Step=18900 Epoch=180.5] | Loss=0.00023 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.569 | L2-Norm(final)=12.665 | 5305.7 samples/s | 82.9 steps/s
[Step=18950 Epoch=181.0] | Loss=0.00021 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.557 | L2-Norm(final)=12.666 | 2616.2 samples/s | 40.9 steps/s
[Step=19000 Epoch=181.4] | Loss=0.00019 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.545 | L2-Norm(final)=12.667 | 4935.5 samples/s | 77.1 steps/s
[Step=19050 Epoch=181.9] | Loss=0.00017 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.533 | L2-Norm(final)=12.667 | 2765.8 samples/s | 43.2 steps/s
[Step=19100 Epoch=182.4] | Loss=0.00016 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.521 | L2-Norm(final)=12.668 | 4497.9 samples/s | 70.3 steps/s
[Step=19150 Epoch=182.9] | Loss=0.00015 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.509 | L2-Norm(final)=12.669 | 2821.8 samples/s | 44.1 steps/s
[Step=19200 Epoch=183.3] | Loss=0.00014 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.497 | L2-Norm(final)=12.669 | 4585.9 samples/s | 71.7 steps/s
[Step=19250 Epoch=183.8] | Loss=0.00013 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.485 | L2-Norm(final)=12.670 | 2830.6 samples/s | 44.2 steps/s
[Step=19300 Epoch=184.3] | Loss=0.00012 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.474 | L2-Norm(final)=12.670 | 4557.2 samples/s | 71.2 steps/s
[Step=19350 Epoch=184.8] | Loss=0.00011 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.462 | L2-Norm(final)=12.671 | 2844.3 samples/s | 44.4 steps/s
[Step=19400 Epoch=185.3] | Loss=0.00011 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.451 | L2-Norm(final)=12.672 | 4671.9 samples/s | 73.0 steps/s
[Step=19450 Epoch=185.7] | Loss=0.00010 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.439 | L2-Norm(final)=12.672 | 2873.1 samples/s | 44.9 steps/s
[Step=19500 Epoch=186.2] | Loss=0.00010 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.428 | L2-Norm(final)=12.673 | 4405.3 samples/s | 68.8 steps/s
[Step=19550 Epoch=186.7] | Loss=0.00009 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.417 | L2-Norm(final)=12.673 | 7330.1 samples/s | 114.5 steps/s
[Step=19600 Epoch=187.2] | Loss=0.00009 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=12.674 | 2306.2 samples/s | 36.0 steps/s
[Step=19650 Epoch=187.6] | Loss=0.00008 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.394 | L2-Norm(final)=12.674 | 6635.6 samples/s | 103.7 steps/s
[Step=19700 Epoch=188.1] | Loss=0.00008 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.383 | L2-Norm(final)=12.674 | 2382.6 samples/s | 37.2 steps/s
[Step=19750 Epoch=188.6] | Loss=0.00008 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.372 | L2-Norm(final)=12.675 | 6114.4 samples/s | 95.5 steps/s
[Step=19800 Epoch=189.1] | Loss=0.00007 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.360 | L2-Norm(final)=12.675 | 2461.7 samples/s | 38.5 steps/s
[Step=19850 Epoch=189.6] | Loss=0.00007 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=12.676 | 5618.3 samples/s | 87.8 steps/s
[Step=19900 Epoch=190.0] | Loss=0.00007 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.338 | L2-Norm(final)=12.676 | 2531.7 samples/s | 39.6 steps/s
[Step=19950 Epoch=190.5] | Loss=0.00007 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=12.677 | 5272.2 samples/s | 82.4 steps/s
[Step=20000 Epoch=191.0] | Loss=0.00007 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.316 | L2-Norm(final)=12.677 | 2657.1 samples/s | 41.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step20000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=207.3] | Loss=0.00774 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.623 | L2-Norm(final)=14.149 | 6995.5 samples/s | 109.3 steps/s
[Step=22050 Epoch=207.8] | Loss=0.00483 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=14.152 | 4697.6 samples/s | 73.4 steps/s
[Step=22100 Epoch=208.2] | Loss=0.00489 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=14.156 | 7890.5 samples/s | 123.3 steps/s
[Step=22150 Epoch=208.7] | Loss=0.00522 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.621 | L2-Norm(final)=14.158 | 2599.0 samples/s | 40.6 steps/s
[Step=22200 Epoch=209.2] | Loss=0.00485 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=14.162 | 7065.5 samples/s | 110.4 steps/s
[Step=22250 Epoch=209.7] | Loss=0.00482 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=14.168 | 2720.1 samples/s | 42.5 steps/s
[Step=22300 Epoch=210.1] | Loss=0.00470 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=14.174 | 6265.6 samples/s | 97.9 steps/s
[Step=22350 Epoch=210.6] | Loss=0.00465 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=14.181 | 2847.9 samples/s | 44.5 steps/s
[Step=22400 Epoch=211.1] | Loss=0.00465 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=14.188 | 5684.7 samples/s | 88.8 steps/s
[Step=22450 Epoch=211.5] | Loss=0.00452 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=14.196 | 3071.3 samples/s | 48.0 steps/s
[Step=22500 Epoch=212.0] | Loss=0.00460 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.621 | L2-Norm(final)=14.204 | 5023.5 samples/s | 78.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=212.0] | Loss=0.00217 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=14.286 | 6703.9 samples/s | 104.7 steps/s
[Step=22550 Epoch=212.5] | Loss=0.00295 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.641 | L2-Norm(final)=14.294 | 4132.0 samples/s | 64.6 steps/s
[Step=22600 Epoch=213.0] | Loss=0.00320 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.660 | L2-Norm(final)=14.296 | 6499.5 samples/s | 101.6 steps/s
[Step=22650 Epoch=213.4] | Loss=0.00223 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=14.295 | 2426.9 samples/s | 37.9 steps/s
[Step=22700 Epoch=213.9] | Loss=0.00170 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.672 | L2-Norm(final)=14.295 | 5736.7 samples/s | 89.6 steps/s
[Step=22750 Epoch=214.4] | Loss=0.00138 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=14.297 | 2521.0 samples/s | 39.4 steps/s
[Step=22800 Epoch=214.8] | Loss=0.00115 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.667 | L2-Norm(final)=14.298 | 5241.3 samples/s | 81.9 steps/s
[Step=22850 Epoch=215.3] | Loss=0.00099 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.661 | L2-Norm(final)=14.299 | 2662.3 samples/s | 41.6 steps/s
[Step=22900 Epoch=215.8] | Loss=0.00087 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=14.300 | 4739.1 samples/s | 74.0 steps/s
[Step=22950 Epoch=216.3] | Loss=0.00077 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.649 | L2-Norm(final)=14.301 | 2780.3 samples/s | 43.4 steps/s
[Step=23000 Epoch=216.7] | Loss=0.00070 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.642 | L2-Norm(final)=14.302 | 4509.3 samples/s | 70.5 steps/s
[Step=23050 Epoch=217.2] | Loss=0.00064 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.634 | L2-Norm(final)=14.303 | 2866.8 samples/s | 44.8 steps/s
[Step=23100 Epoch=217.7] | Loss=0.00058 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.627 | L2-Norm(final)=14.303 | 4556.3 samples/s | 71.2 steps/s
[Step=23150 Epoch=218.1] | Loss=0.00054 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.619 | L2-Norm(final)=14.304 | 2832.9 samples/s | 44.3 steps/s
[Step=23200 Epoch=218.6] | Loss=0.00050 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.612 | L2-Norm(final)=14.305 | 4573.2 samples/s | 71.5 steps/s
[Step=23250 Epoch=219.1] | Loss=0.00047 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.604 | L2-Norm(final)=14.306 | 3139.9 samples/s | 49.1 steps/s
[Step=23300 Epoch=219.6] | Loss=0.00044 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.596 | L2-Norm(final)=14.306 | 4008.0 samples/s | 62.6 steps/s
[Step=23350 Epoch=220.0] | Loss=0.00041 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.589 | L2-Norm(final)=14.307 | 6655.1 samples/s | 104.0 steps/s
[Step=23400 Epoch=220.5] | Loss=0.00039 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=14.308 | 2388.2 samples/s | 37.3 steps/s
[Step=23450 Epoch=221.0] | Loss=0.00037 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.573 | L2-Norm(final)=14.308 | 5878.8 samples/s | 91.9 steps/s
[Step=23500 Epoch=221.4] | Loss=0.00035 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.566 | L2-Norm(final)=14.309 | 2502.4 samples/s | 39.1 steps/s
[Step=23550 Epoch=221.9] | Loss=0.00034 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.558 | L2-Norm(final)=14.310 | 5286.1 samples/s | 82.6 steps/s
[Step=23600 Epoch=222.4] | Loss=0.00032 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.550 | L2-Norm(final)=14.310 | 2641.3 samples/s | 41.3 steps/s
[Step=23650 Epoch=222.9] | Loss=0.00031 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.542 | L2-Norm(final)=14.311 | 4784.0 samples/s | 74.7 steps/s
[Step=23700 Epoch=223.3] | Loss=0.00030 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.534 | L2-Norm(final)=14.311 | 2750.6 samples/s | 43.0 steps/s
[Step=23750 Epoch=223.8] | Loss=0.00028 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.526 | L2-Norm(final)=14.312 | 4588.5 samples/s | 71.7 steps/s
[Step=23800 Epoch=224.3] | Loss=0.00027 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.519 | L2-Norm(final)=14.313 | 2856.3 samples/s | 44.6 steps/s
[Step=23850 Epoch=224.7] | Loss=0.00026 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=14.313 | 4530.5 samples/s | 70.8 steps/s
[Step=23900 Epoch=225.2] | Loss=0.00025 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=14.314 | 2895.3 samples/s | 45.2 steps/s
[Step=23950 Epoch=225.7] | Loss=0.00024 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.495 | L2-Norm(final)=14.314 | 4599.2 samples/s | 71.9 steps/s
[Step=24000 Epoch=226.1] | Loss=0.00024 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.487 | L2-Norm(final)=14.315 | 2986.4 samples/s | 46.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step24000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=190.6] | Loss=0.00479 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.623 | L2-Norm(final)=13.544 | 7045.4 samples/s | 110.1 steps/s
[Step=20050 Epoch=191.1] | Loss=0.00515 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=13.548 | 3655.6 samples/s | 57.1 steps/s
[Step=20100 Epoch=191.6] | Loss=0.00471 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=13.554 | 8195.1 samples/s | 128.0 steps/s
[Step=20150 Epoch=192.0] | Loss=0.00446 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=13.562 | 2556.1 samples/s | 39.9 steps/s
[Step=20200 Epoch=192.5] | Loss=0.00430 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=13.572 | 7581.7 samples/s | 118.5 steps/s
[Step=20250 Epoch=193.0] | Loss=0.00423 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=13.583 | 2633.3 samples/s | 41.1 steps/s
[Step=20300 Epoch=193.5] | Loss=0.00406 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=13.594 | 6903.9 samples/s | 107.9 steps/s
[Step=20350 Epoch=194.0] | Loss=0.00400 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=13.607 | 2815.3 samples/s | 44.0 steps/s
[Step=20400 Epoch=194.4] | Loss=0.00396 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=13.620 | 6009.8 samples/s | 93.9 steps/s
[Step=20450 Epoch=194.9] | Loss=0.00392 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=13.633 | 2866.2 samples/s | 44.8 steps/s
[Step=20500 Epoch=195.4] | Loss=0.00386 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=13.646 | 5648.3 samples/s | 88.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=195.4] | Loss=0.00183 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=13.780 | 6976.8 samples/s | 109.0 steps/s
[Step=20550 Epoch=195.9] | Loss=0.00090 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.642 | L2-Norm(final)=13.793 | 4035.6 samples/s | 63.1 steps/s
[Step=20600 Epoch=196.3] | Loss=0.00072 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=13.800 | 6671.3 samples/s | 104.2 steps/s
[Step=20650 Epoch=196.8] | Loss=0.00049 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=13.803 | 2366.7 samples/s | 37.0 steps/s
[Step=20700 Epoch=197.3] | Loss=0.00037 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.648 | L2-Norm(final)=13.805 | 6070.1 samples/s | 94.8 steps/s
[Step=20750 Epoch=197.8] | Loss=0.00030 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.639 | L2-Norm(final)=13.807 | 2464.2 samples/s | 38.5 steps/s
[Step=20800 Epoch=198.2] | Loss=0.00025 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.628 | L2-Norm(final)=13.808 | 5562.7 samples/s | 86.9 steps/s
[Step=20850 Epoch=198.7] | Loss=0.00022 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.617 | L2-Norm(final)=13.809 | 2548.0 samples/s | 39.8 steps/s
[Step=20900 Epoch=199.2] | Loss=0.00019 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.606 | L2-Norm(final)=13.810 | 5231.3 samples/s | 81.7 steps/s
[Step=20950 Epoch=199.7] | Loss=0.00017 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.595 | L2-Norm(final)=13.811 | 2610.6 samples/s | 40.8 steps/s
[Step=21000 Epoch=200.1] | Loss=0.00015 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.584 | L2-Norm(final)=13.811 | 4906.2 samples/s | 76.7 steps/s
[Step=21050 Epoch=200.6] | Loss=0.00014 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.572 | L2-Norm(final)=13.812 | 2725.3 samples/s | 42.6 steps/s
[Step=21100 Epoch=201.1] | Loss=0.00013 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.561 | L2-Norm(final)=13.813 | 4639.2 samples/s | 72.5 steps/s
[Step=21150 Epoch=201.6] | Loss=0.00012 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.549 | L2-Norm(final)=13.813 | 2832.9 samples/s | 44.3 steps/s
[Step=21200 Epoch=202.1] | Loss=0.00011 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.538 | L2-Norm(final)=13.814 | 4457.8 samples/s | 69.7 steps/s
[Step=21250 Epoch=202.5] | Loss=0.00011 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.527 | L2-Norm(final)=13.814 | 2878.1 samples/s | 45.0 steps/s
[Step=21300 Epoch=203.0] | Loss=0.00010 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.515 | L2-Norm(final)=13.815 | 4622.2 samples/s | 72.2 steps/s
[Step=21350 Epoch=203.5] | Loss=0.00009 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.504 | L2-Norm(final)=13.815 | 2827.4 samples/s | 44.2 steps/s
[Step=21400 Epoch=204.0] | Loss=0.00009 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.492 | L2-Norm(final)=13.816 | 4610.0 samples/s | 72.0 steps/s
[Step=21450 Epoch=204.4] | Loss=0.00008 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.481 | L2-Norm(final)=13.816 | 2824.2 samples/s | 44.1 steps/s
[Step=21500 Epoch=204.9] | Loss=0.00008 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.470 | L2-Norm(final)=13.816 | 4440.4 samples/s | 69.4 steps/s
[Step=21550 Epoch=205.4] | Loss=0.00008 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.458 | L2-Norm(final)=13.817 | 7279.0 samples/s | 113.7 steps/s
[Step=21600 Epoch=205.9] | Loss=0.00007 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.447 | L2-Norm(final)=13.817 | 2328.0 samples/s | 36.4 steps/s
[Step=21650 Epoch=206.3] | Loss=0.00007 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.436 | L2-Norm(final)=13.818 | 6458.1 samples/s | 100.9 steps/s
[Step=21700 Epoch=206.8] | Loss=0.00007 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=13.818 | 2365.3 samples/s | 37.0 steps/s
[Step=21750 Epoch=207.3] | Loss=0.00006 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=13.818 | 6140.0 samples/s | 95.9 steps/s
[Step=21800 Epoch=207.8] | Loss=0.00006 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.402 | L2-Norm(final)=13.819 | 2440.3 samples/s | 38.1 steps/s
[Step=21850 Epoch=208.3] | Loss=0.00006 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.390 | L2-Norm(final)=13.819 | 5669.4 samples/s | 88.6 steps/s
[Step=21900 Epoch=208.7] | Loss=0.00006 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.379 | L2-Norm(final)=13.820 | 2546.8 samples/s | 39.8 steps/s
[Step=21950 Epoch=209.2] | Loss=0.00006 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.368 | L2-Norm(final)=13.820 | 5292.6 samples/s | 82.7 steps/s
[Step=22000 Epoch=209.7] | Loss=0.00005 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.356 | L2-Norm(final)=13.820 | 2617.7 samples/s | 40.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step22000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10394 | acc=0.9549 | tpr=0.9707 | fpr=0.0793 | 5551.9 samples/s | 21.7 steps/s
Avg test loss: 0.11508, Avg test acc: 0.95064, Avg tpr: 0.96765, Avg fpr: 0.08678, total FA: 677

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.13077 | acc=0.9484 | tpr=0.9791 | fpr=0.1182 | 5988.9 samples/s | 23.4 steps/s
Avg test loss: 0.13056, Avg test acc: 0.94859, Avg tpr: 0.97832, Avg fpr: 0.11678, total FA: 911

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.10054 | acc=0.9578 | tpr=0.9768 | fpr=0.0835 | 6029.7 samples/s | 23.6 steps/s
Avg test loss: 0.09998, Avg test acc: 0.95673, Avg tpr: 0.97435, Avg fpr: 0.08204, total FA: 640

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09808 | acc=0.9580 | tpr=0.9767 | fpr=0.0825 | 5922.0 samples/s | 23.1 steps/s
Avg test loss: 0.10399, Avg test acc: 0.95649, Avg tpr: 0.97570, Avg fpr: 0.08576, total FA: 669

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11715 | acc=0.9537 | tpr=0.9617 | fpr=0.0634 | 6130.5 samples/s | 23.9 steps/s
Avg test loss: 0.12395, Avg test acc: 0.95228, Avg tpr: 0.95920, Avg fpr: 0.06294, total FA: 491

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.86634 | acc=0.2957 | tpr=0.0161 | fpr=0.0971 | 5644.4 samples/s | 22.0 steps/s
Avg test loss: 6.87883, Avg test acc: 0.29377, Avg tpr: 0.01492, Avg fpr: 0.09294, total FA: 725

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.86704 | acc=0.3123 | tpr=0.0226 | fpr=0.0587 | 5660.4 samples/s | 22.1 steps/s
Avg test loss: 4.87636, Avg test acc: 0.31040, Avg tpr: 0.02256, Avg fpr: 0.05653, total FA: 441

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.16037 | acc=0.2809 | tpr=0.0152 | fpr=0.1420 | 6010.3 samples/s | 23.5 steps/s
Avg test loss: 5.16918, Avg test acc: 0.27911, Avg tpr: 0.01440, Avg fpr: 0.13870, total FA: 1082

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.15998 | acc=0.2762 | tpr=0.0277 | fpr=0.1843 | 5975.4 samples/s | 23.3 steps/s
Avg test loss: 5.16219, Avg test acc: 0.27518, Avg tpr: 0.02629, Avg fpr: 0.17741, total FA: 1384

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.73891 | acc=0.2989 | tpr=0.0186 | fpr=0.0924 | 6025.9 samples/s | 23.5 steps/s
Avg test loss: 4.75842, Avg test acc: 0.29614, Avg tpr: 0.01784, Avg fpr: 0.09178, total FA: 716

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.96854 | acc=0.1308 | tpr=0.7389 | fpr=0.8801 | 5862.9 samples/s | 22.9 steps/s
[Step= 100] | Loss=5.94230 | acc=0.1333 | tpr=0.7143 | fpr=0.8776 | 7875.3 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.93543 | acc=0.1341 | tpr=0.7262 | fpr=0.8768 | 8175.7 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.92761 | acc=0.1349 | tpr=0.7246 | fpr=0.8758 | 8553.1 samples/s | 33.4 steps/s
[Step= 250] | Loss=5.93450 | acc=0.1348 | tpr=0.7135 | fpr=0.8758 | 8187.2 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.92690 | acc=0.1345 | tpr=0.7127 | fpr=0.8760 | 8057.3 samples/s | 31.5 steps/s
[Step= 350] | Loss=5.93042 | acc=0.1344 | tpr=0.7170 | fpr=0.8762 | 7724.4 samples/s | 30.2 steps/s
[Step= 400] | Loss=5.92806 | acc=0.1347 | tpr=0.7133 | fpr=0.8759 | 8276.6 samples/s | 32.3 steps/s
[Step= 450] | Loss=5.93250 | acc=0.1340 | tpr=0.7162 | fpr=0.8765 | 7490.2 samples/s | 29.3 steps/s
[Step= 500] | Loss=5.93111 | acc=0.1343 | tpr=0.7207 | fpr=0.8763 | 8546.7 samples/s | 33.4 steps/s
[Step= 550] | Loss=5.93290 | acc=0.1343 | tpr=0.7230 | fpr=0.8764 | 9514.1 samples/s | 37.2 steps/s
Avg test loss: 5.93360, Avg test acc: 0.13430, Avg tpr: 0.72385, Avg fpr: 0.87642, total FA: 121689

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.15135 | acc=0.1171 | tpr=0.7345 | fpr=0.8940 | 5993.0 samples/s | 23.4 steps/s
[Step= 100] | Loss=6.12843 | acc=0.1185 | tpr=0.7249 | fpr=0.8928 | 7949.5 samples/s | 31.1 steps/s
[Step= 150] | Loss=6.12530 | acc=0.1201 | tpr=0.7291 | fpr=0.8911 | 8132.1 samples/s | 31.8 steps/s
[Step= 200] | Loss=6.12114 | acc=0.1196 | tpr=0.7180 | fpr=0.8912 | 8122.0 samples/s | 31.7 steps/s
[Step= 250] | Loss=6.12302 | acc=0.1196 | tpr=0.7231 | fpr=0.8914 | 8021.0 samples/s | 31.3 steps/s
[Step= 300] | Loss=6.11747 | acc=0.1191 | tpr=0.7171 | fpr=0.8918 | 7713.6 samples/s | 30.1 steps/s
[Step= 350] | Loss=6.12908 | acc=0.1188 | tpr=0.7195 | fpr=0.8921 | 7735.4 samples/s | 30.2 steps/s
[Step= 400] | Loss=6.12530 | acc=0.1190 | tpr=0.7183 | fpr=0.8919 | 8462.6 samples/s | 33.1 steps/s
[Step= 450] | Loss=6.12891 | acc=0.1188 | tpr=0.7201 | fpr=0.8921 | 8196.5 samples/s | 32.0 steps/s
[Step= 500] | Loss=6.12872 | acc=0.1186 | tpr=0.7242 | fpr=0.8924 | 8287.9 samples/s | 32.4 steps/s
[Step= 550] | Loss=6.13506 | acc=0.1188 | tpr=0.7278 | fpr=0.8923 | 9422.3 samples/s | 36.8 steps/s
Avg test loss: 6.13551, Avg test acc: 0.11866, Avg tpr: 0.72821, Avg fpr: 0.89242, total FA: 123911

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.40450 | acc=0.1255 | tpr=0.7168 | fpr=0.8852 | 6078.8 samples/s | 23.7 steps/s
[Step= 100] | Loss=5.37860 | acc=0.1275 | tpr=0.7100 | fpr=0.8833 | 7622.8 samples/s | 29.8 steps/s
[Step= 150] | Loss=5.36963 | acc=0.1296 | tpr=0.7061 | fpr=0.8811 | 8204.4 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.36227 | acc=0.1298 | tpr=0.6940 | fpr=0.8805 | 8456.3 samples/s | 33.0 steps/s
[Step= 250] | Loss=5.36516 | acc=0.1302 | tpr=0.6917 | fpr=0.8800 | 8109.3 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.36079 | acc=0.1301 | tpr=0.6909 | fpr=0.8801 | 7869.9 samples/s | 30.7 steps/s
[Step= 350] | Loss=5.36735 | acc=0.1300 | tpr=0.6932 | fpr=0.8802 | 8282.2 samples/s | 32.4 steps/s
[Step= 400] | Loss=5.36509 | acc=0.1302 | tpr=0.6920 | fpr=0.8800 | 8190.0 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.36863 | acc=0.1297 | tpr=0.6943 | fpr=0.8806 | 7980.2 samples/s | 31.2 steps/s
[Step= 500] | Loss=5.36805 | acc=0.1294 | tpr=0.6969 | fpr=0.8808 | 7564.5 samples/s | 29.5 steps/s
[Step= 550] | Loss=5.37222 | acc=0.1295 | tpr=0.6992 | fpr=0.8809 | 9796.4 samples/s | 38.3 steps/s
Avg test loss: 5.37278, Avg test acc: 0.12945, Avg tpr: 0.70008, Avg fpr: 0.88093, total FA: 122315

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.51370 | acc=0.1231 | tpr=0.7124 | fpr=0.8875 | 6032.5 samples/s | 23.6 steps/s
[Step= 100] | Loss=5.49380 | acc=0.1254 | tpr=0.6844 | fpr=0.8851 | 7526.8 samples/s | 29.4 steps/s
[Step= 150] | Loss=5.48351 | acc=0.1268 | tpr=0.6945 | fpr=0.8837 | 7951.9 samples/s | 31.1 steps/s
[Step= 200] | Loss=5.47890 | acc=0.1270 | tpr=0.6918 | fpr=0.8833 | 8736.7 samples/s | 34.1 steps/s
[Step= 250] | Loss=5.48056 | acc=0.1270 | tpr=0.6926 | fpr=0.8833 | 8393.7 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.47693 | acc=0.1269 | tpr=0.6924 | fpr=0.8834 | 7875.2 samples/s | 30.8 steps/s
[Step= 350] | Loss=5.48134 | acc=0.1266 | tpr=0.6957 | fpr=0.8837 | 7942.7 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.47927 | acc=0.1268 | tpr=0.6942 | fpr=0.8835 | 7303.1 samples/s | 28.5 steps/s
[Step= 450] | Loss=5.48405 | acc=0.1261 | tpr=0.6972 | fpr=0.8843 | 8666.5 samples/s | 33.9 steps/s
[Step= 500] | Loss=5.48288 | acc=0.1261 | tpr=0.6991 | fpr=0.8842 | 8072.7 samples/s | 31.5 steps/s
[Step= 550] | Loss=5.48948 | acc=0.1262 | tpr=0.6988 | fpr=0.8842 | 9840.8 samples/s | 38.4 steps/s
Avg test loss: 5.49069, Avg test acc: 0.12609, Avg tpr: 0.69929, Avg fpr: 0.88433, total FA: 122787

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.29585 | acc=0.1362 | tpr=0.5708 | fpr=0.8716 | 5933.7 samples/s | 23.2 steps/s
[Step= 100] | Loss=5.28207 | acc=0.1372 | tpr=0.5736 | fpr=0.8709 | 7969.4 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.26660 | acc=0.1386 | tpr=0.5749 | fpr=0.8694 | 7848.5 samples/s | 30.7 steps/s
[Step= 200] | Loss=5.26796 | acc=0.1395 | tpr=0.5738 | fpr=0.8684 | 8294.7 samples/s | 32.4 steps/s
[Step= 250] | Loss=5.26797 | acc=0.1391 | tpr=0.5677 | fpr=0.8687 | 8038.6 samples/s | 31.4 steps/s
[Step= 300] | Loss=5.26171 | acc=0.1395 | tpr=0.5724 | fpr=0.8684 | 7596.5 samples/s | 29.7 steps/s
[Step= 350] | Loss=5.27088 | acc=0.1393 | tpr=0.5654 | fpr=0.8684 | 7752.8 samples/s | 30.3 steps/s
[Step= 400] | Loss=5.26640 | acc=0.1396 | tpr=0.5629 | fpr=0.8681 | 8267.2 samples/s | 32.3 steps/s
[Step= 450] | Loss=5.27195 | acc=0.1388 | tpr=0.5682 | fpr=0.8689 | 8245.9 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.27133 | acc=0.1389 | tpr=0.5714 | fpr=0.8689 | 8249.8 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.27311 | acc=0.1389 | tpr=0.5726 | fpr=0.8689 | 9978.7 samples/s | 39.0 steps/s
Avg test loss: 5.27459, Avg test acc: 0.13887, Avg tpr: 0.57369, Avg fpr: 0.86904, total FA: 120664

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.21193 | acc=0.9596 | tpr=0.9204 | fpr=0.0397 | 5894.3 samples/s | 23.0 steps/s
[Step= 100] | Loss=0.21355 | acc=0.9582 | tpr=0.9339 | fpr=0.0413 | 7835.2 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.21726 | acc=0.9569 | tpr=0.9294 | fpr=0.0426 | 7989.1 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.21787 | acc=0.9570 | tpr=0.9344 | fpr=0.0426 | 8692.6 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.21898 | acc=0.9568 | tpr=0.9319 | fpr=0.0427 | 7804.3 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.22126 | acc=0.9567 | tpr=0.9309 | fpr=0.0428 | 7584.9 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.22019 | acc=0.9570 | tpr=0.9317 | fpr=0.0425 | 8374.7 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.21943 | acc=0.9569 | tpr=0.9305 | fpr=0.0426 | 8097.6 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.22377 | acc=0.9564 | tpr=0.9294 | fpr=0.0431 | 8072.0 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.22337 | acc=0.9564 | tpr=0.9295 | fpr=0.0432 | 8162.8 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.22210 | acc=0.9566 | tpr=0.9288 | fpr=0.0429 | 9748.8 samples/s | 38.1 steps/s
Avg test loss: 0.22151, Avg test acc: 0.95665, Avg tpr: 0.92868, Avg fpr: 0.04285, total FA: 5949

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16689 | acc=0.9598 | tpr=0.9027 | fpr=0.0392 | 5993.9 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.17173 | acc=0.9585 | tpr=0.9318 | fpr=0.0410 | 8198.5 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.17376 | acc=0.9573 | tpr=0.9366 | fpr=0.0423 | 7518.4 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.17493 | acc=0.9572 | tpr=0.9410 | fpr=0.0425 | 8100.0 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.17424 | acc=0.9573 | tpr=0.9362 | fpr=0.0424 | 7918.4 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.17571 | acc=0.9569 | tpr=0.9360 | fpr=0.0427 | 7498.6 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.17429 | acc=0.9571 | tpr=0.9374 | fpr=0.0425 | 7562.3 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.17386 | acc=0.9570 | tpr=0.9333 | fpr=0.0426 | 8522.3 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.17652 | acc=0.9565 | tpr=0.9309 | fpr=0.0430 | 8240.7 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.17638 | acc=0.9563 | tpr=0.9300 | fpr=0.0432 | 8147.1 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.17526 | acc=0.9565 | tpr=0.9276 | fpr=0.0430 | 10831.9 samples/s | 42.3 steps/s
Avg test loss: 0.17490, Avg test acc: 0.95653, Avg tpr: 0.92750, Avg fpr: 0.04295, total FA: 5963

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.23013 | acc=0.9537 | tpr=0.9513 | fpr=0.0463 | 6145.0 samples/s | 24.0 steps/s
[Step= 100] | Loss=0.23629 | acc=0.9521 | tpr=0.9595 | fpr=0.0480 | 7751.6 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.24044 | acc=0.9508 | tpr=0.9582 | fpr=0.0493 | 7344.0 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.24026 | acc=0.9510 | tpr=0.9617 | fpr=0.0492 | 7683.4 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.24034 | acc=0.9509 | tpr=0.9624 | fpr=0.0493 | 8091.6 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.24385 | acc=0.9506 | tpr=0.9593 | fpr=0.0495 | 8192.4 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.24152 | acc=0.9508 | tpr=0.9593 | fpr=0.0493 | 8099.6 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.24138 | acc=0.9505 | tpr=0.9562 | fpr=0.0496 | 8084.3 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.24518 | acc=0.9501 | tpr=0.9542 | fpr=0.0500 | 8350.8 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.24570 | acc=0.9499 | tpr=0.9555 | fpr=0.0502 | 7791.0 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.24412 | acc=0.9501 | tpr=0.9550 | fpr=0.0500 | 11365.3 samples/s | 44.4 steps/s
Avg test loss: 0.24376, Avg test acc: 0.95012, Avg tpr: 0.95483, Avg fpr: 0.04997, total FA: 6938

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.12840 | acc=0.9674 | tpr=0.9248 | fpr=0.0318 | 5826.6 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.13271 | acc=0.9664 | tpr=0.9339 | fpr=0.0329 | 8246.8 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.13229 | acc=0.9654 | tpr=0.9280 | fpr=0.0339 | 7754.4 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.13181 | acc=0.9658 | tpr=0.9344 | fpr=0.0336 | 7700.4 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.13289 | acc=0.9656 | tpr=0.9310 | fpr=0.0337 | 8921.9 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.13573 | acc=0.9652 | tpr=0.9273 | fpr=0.0342 | 8192.8 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.13500 | acc=0.9651 | tpr=0.9255 | fpr=0.0341 | 7817.0 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.13476 | acc=0.9650 | tpr=0.9245 | fpr=0.0343 | 8070.2 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.13685 | acc=0.9646 | tpr=0.9236 | fpr=0.0346 | 7829.0 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.13662 | acc=0.9645 | tpr=0.9233 | fpr=0.0348 | 8241.2 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.13577 | acc=0.9647 | tpr=0.9244 | fpr=0.0346 | 9880.8 samples/s | 38.6 steps/s
Avg test loss: 0.13550, Avg test acc: 0.96475, Avg tpr: 0.92433, Avg fpr: 0.03452, total FA: 4793

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.23536 | acc=0.9551 | tpr=0.9159 | fpr=0.0442 | 6164.2 samples/s | 24.1 steps/s
[Step= 100] | Loss=0.24331 | acc=0.9543 | tpr=0.9382 | fpr=0.0454 | 7713.8 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.24690 | acc=0.9524 | tpr=0.9438 | fpr=0.0474 | 7882.6 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.24785 | acc=0.9524 | tpr=0.9464 | fpr=0.0474 | 7836.2 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.24851 | acc=0.9524 | tpr=0.9450 | fpr=0.0475 | 8267.3 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.25188 | acc=0.9519 | tpr=0.9425 | fpr=0.0479 | 8341.1 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.24994 | acc=0.9521 | tpr=0.9436 | fpr=0.0478 | 7983.1 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.25022 | acc=0.9517 | tpr=0.9426 | fpr=0.0482 | 7461.4 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.25394 | acc=0.9513 | tpr=0.9416 | fpr=0.0486 | 8541.3 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.25409 | acc=0.9512 | tpr=0.9414 | fpr=0.0486 | 8121.4 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.25215 | acc=0.9516 | tpr=0.9423 | fpr=0.0482 | 9842.9 samples/s | 38.4 steps/s
Avg test loss: 0.25175, Avg test acc: 0.95168, Avg tpr: 0.94216, Avg fpr: 0.04815, total FA: 6685

server round 21/50

clients selected: [0 1 2 5 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=16001 Epoch=78.0] | Loss=0.00533 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.526 | L2-Norm(final)=10.856 | 6808.1 samples/s | 106.4 steps/s
[Step=16050 Epoch=78.3] | Loss=0.03713 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.527 | L2-Norm(final)=10.855 | 5064.6 samples/s | 79.1 steps/s
[Step=16100 Epoch=78.5] | Loss=0.03731 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.527 | L2-Norm(final)=10.855 | 5668.8 samples/s | 88.6 steps/s
[Step=16150 Epoch=78.8] | Loss=0.03466 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.527 | L2-Norm(final)=10.858 | 5484.7 samples/s | 85.7 steps/s
[Step=16200 Epoch=79.0] | Loss=0.03476 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.527 | L2-Norm(final)=10.863 | 8646.0 samples/s | 135.1 steps/s
[Step=16250 Epoch=79.2] | Loss=0.03492 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.527 | L2-Norm(final)=10.867 | 2700.4 samples/s | 42.2 steps/s
[Step=16300 Epoch=79.5] | Loss=0.03437 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.527 | L2-Norm(final)=10.870 | 5800.4 samples/s | 90.6 steps/s
[Step=16350 Epoch=79.7] | Loss=0.03374 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.527 | L2-Norm(final)=10.874 | 5223.3 samples/s | 81.6 steps/s
[Step=16400 Epoch=80.0] | Loss=0.03427 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.527 | L2-Norm(final)=10.878 | 7741.1 samples/s | 121.0 steps/s
[Step=16450 Epoch=80.2] | Loss=0.03417 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.527 | L2-Norm(final)=10.881 | 2799.6 samples/s | 43.7 steps/s
[Step=16500 Epoch=80.5] | Loss=0.03442 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.527 | L2-Norm(final)=10.884 | 5547.5 samples/s | 86.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=16501 Epoch=80.5] | Loss=0.03256 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.527 | L2-Norm(final)=10.916 | 6802.4 samples/s | 106.3 steps/s
[Step=16550 Epoch=80.7] | Loss=0.04038 | Reg=0.00133 | acc=0.9531 | L2-Norm=11.553 | L2-Norm(final)=10.914 | 4406.7 samples/s | 68.9 steps/s
[Step=16600 Epoch=80.9] | Loss=0.03427 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.584 | L2-Norm(final)=10.911 | 4757.0 samples/s | 74.3 steps/s
[Step=16650 Epoch=81.2] | Loss=0.03178 | Reg=0.00135 | acc=0.9219 | L2-Norm=11.617 | L2-Norm(final)=10.912 | 4774.0 samples/s | 74.6 steps/s
[Step=16700 Epoch=81.4] | Loss=0.02864 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.646 | L2-Norm(final)=10.915 | 6858.1 samples/s | 107.2 steps/s
[Step=16750 Epoch=81.7] | Loss=0.02463 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.669 | L2-Norm(final)=10.919 | 2506.3 samples/s | 39.2 steps/s
[Step=16800 Epoch=81.9] | Loss=0.02196 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.689 | L2-Norm(final)=10.924 | 4667.0 samples/s | 72.9 steps/s
[Step=16850 Epoch=82.2] | Loss=0.02017 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.706 | L2-Norm(final)=10.930 | 4756.5 samples/s | 74.3 steps/s
[Step=16900 Epoch=82.4] | Loss=0.01873 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.721 | L2-Norm(final)=10.935 | 6220.3 samples/s | 97.2 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01741 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.734 | L2-Norm(final)=10.939 | 2558.5 samples/s | 40.0 steps/s
[Step=17000 Epoch=82.9] | Loss=0.01643 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.745 | L2-Norm(final)=10.944 | 4780.5 samples/s | 74.7 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01548 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.755 | L2-Norm(final)=10.948 | 4743.3 samples/s | 74.1 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01475 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.764 | L2-Norm(final)=10.951 | 5704.3 samples/s | 89.1 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01392 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.772 | L2-Norm(final)=10.955 | 2682.3 samples/s | 41.9 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01341 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.780 | L2-Norm(final)=10.959 | 4831.9 samples/s | 75.5 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01290 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.787 | L2-Norm(final)=10.962 | 4665.6 samples/s | 72.9 steps/s
[Step=17300 Epoch=84.4] | Loss=0.01246 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.794 | L2-Norm(final)=10.966 | 5285.5 samples/s | 82.6 steps/s
[Step=17350 Epoch=84.6] | Loss=0.01200 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.800 | L2-Norm(final)=10.969 | 2813.6 samples/s | 44.0 steps/s
[Step=17400 Epoch=84.8] | Loss=0.01166 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.806 | L2-Norm(final)=10.972 | 4650.2 samples/s | 72.7 steps/s
[Step=17450 Epoch=85.1] | Loss=0.01128 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.811 | L2-Norm(final)=10.975 | 4814.0 samples/s | 75.2 steps/s
[Step=17500 Epoch=85.3] | Loss=0.01092 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.817 | L2-Norm(final)=10.978 | 4879.0 samples/s | 76.2 steps/s
[Step=17550 Epoch=85.6] | Loss=0.01057 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.821 | L2-Norm(final)=10.981 | 2913.2 samples/s | 45.5 steps/s
[Step=17600 Epoch=85.8] | Loss=0.01027 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=10.984 | 4654.9 samples/s | 72.7 steps/s
[Step=17650 Epoch=86.1] | Loss=0.01004 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.831 | L2-Norm(final)=10.987 | 4753.0 samples/s | 74.3 steps/s
[Step=17700 Epoch=86.3] | Loss=0.00977 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.835 | L2-Norm(final)=10.990 | 4763.9 samples/s | 74.4 steps/s
[Step=17750 Epoch=86.6] | Loss=0.00953 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.839 | L2-Norm(final)=10.993 | 2963.4 samples/s | 46.3 steps/s
[Step=17800 Epoch=86.8] | Loss=0.00935 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.843 | L2-Norm(final)=10.995 | 4753.3 samples/s | 74.3 steps/s
[Step=17850 Epoch=87.0] | Loss=0.00912 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.847 | L2-Norm(final)=10.998 | 4717.9 samples/s | 73.7 steps/s
[Step=17900 Epoch=87.3] | Loss=0.00894 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.850 | L2-Norm(final)=11.001 | 4784.3 samples/s | 74.8 steps/s
[Step=17950 Epoch=87.5] | Loss=0.00875 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.854 | L2-Norm(final)=11.003 | 2949.2 samples/s | 46.1 steps/s
[Step=18000 Epoch=87.8] | Loss=0.00856 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.858 | L2-Norm(final)=11.006 | 4771.0 samples/s | 74.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step18000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=126.9] | Loss=0.06450 | Reg=0.00133 | acc=0.9375 | L2-Norm=11.526 | L2-Norm(final)=13.642 | 6479.6 samples/s | 101.2 steps/s
[Step=26050 Epoch=127.1] | Loss=0.03544 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.527 | L2-Norm(final)=13.641 | 5019.4 samples/s | 78.4 steps/s
[Step=26100 Epoch=127.4] | Loss=0.03599 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.527 | L2-Norm(final)=13.645 | 5525.2 samples/s | 86.3 steps/s
[Step=26150 Epoch=127.6] | Loss=0.03710 | Reg=0.00133 | acc=0.9531 | L2-Norm=11.527 | L2-Norm(final)=13.649 | 5540.7 samples/s | 86.6 steps/s
[Step=26200 Epoch=127.8] | Loss=0.03659 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.527 | L2-Norm(final)=13.652 | 8711.3 samples/s | 136.1 steps/s
[Step=26250 Epoch=128.1] | Loss=0.03551 | Reg=0.00133 | acc=0.9375 | L2-Norm=11.527 | L2-Norm(final)=13.656 | 2684.1 samples/s | 41.9 steps/s
[Step=26300 Epoch=128.3] | Loss=0.03485 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.527 | L2-Norm(final)=13.659 | 5382.2 samples/s | 84.1 steps/s
[Step=26350 Epoch=128.6] | Loss=0.03491 | Reg=0.00133 | acc=0.9531 | L2-Norm=11.527 | L2-Norm(final)=13.663 | 5508.9 samples/s | 86.1 steps/s
[Step=26400 Epoch=128.8] | Loss=0.03431 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.527 | L2-Norm(final)=13.665 | 7915.2 samples/s | 123.7 steps/s
[Step=26450 Epoch=129.1] | Loss=0.03426 | Reg=0.00133 | acc=0.9531 | L2-Norm=11.527 | L2-Norm(final)=13.668 | 2710.4 samples/s | 42.4 steps/s
[Step=26500 Epoch=129.3] | Loss=0.03399 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.527 | L2-Norm(final)=13.671 | 5488.8 samples/s | 85.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=129.3] | Loss=0.05127 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.527 | L2-Norm(final)=13.696 | 7335.5 samples/s | 114.6 steps/s
[Step=26550 Epoch=129.6] | Loss=0.03168 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.561 | L2-Norm(final)=13.694 | 4203.7 samples/s | 65.7 steps/s
[Step=26600 Epoch=129.8] | Loss=0.02809 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.598 | L2-Norm(final)=13.692 | 4815.5 samples/s | 75.2 steps/s
[Step=26650 Epoch=130.0] | Loss=0.02581 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.628 | L2-Norm(final)=13.693 | 4771.9 samples/s | 74.6 steps/s
[Step=26700 Epoch=130.3] | Loss=0.02364 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.652 | L2-Norm(final)=13.694 | 6777.4 samples/s | 105.9 steps/s
[Step=26750 Epoch=130.5] | Loss=0.02058 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.672 | L2-Norm(final)=13.696 | 2476.2 samples/s | 38.7 steps/s
[Step=26800 Epoch=130.8] | Loss=0.01857 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.688 | L2-Norm(final)=13.699 | 4763.3 samples/s | 74.4 steps/s
[Step=26850 Epoch=131.0] | Loss=0.01710 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.702 | L2-Norm(final)=13.702 | 4765.0 samples/s | 74.5 steps/s
[Step=26900 Epoch=131.3] | Loss=0.01585 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.713 | L2-Norm(final)=13.705 | 6239.7 samples/s | 97.5 steps/s
[Step=26950 Epoch=131.5] | Loss=0.01463 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.723 | L2-Norm(final)=13.708 | 2554.8 samples/s | 39.9 steps/s
[Step=27000 Epoch=131.7] | Loss=0.01386 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.731 | L2-Norm(final)=13.711 | 4759.2 samples/s | 74.4 steps/s
[Step=27050 Epoch=132.0] | Loss=0.01309 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.739 | L2-Norm(final)=13.713 | 4749.9 samples/s | 74.2 steps/s
[Step=27100 Epoch=132.2] | Loss=0.01270 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.745 | L2-Norm(final)=13.715 | 5939.4 samples/s | 92.8 steps/s
[Step=27150 Epoch=132.5] | Loss=0.01207 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.751 | L2-Norm(final)=13.717 | 2621.3 samples/s | 41.0 steps/s
[Step=27200 Epoch=132.7] | Loss=0.01150 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.757 | L2-Norm(final)=13.719 | 4745.5 samples/s | 74.1 steps/s
[Step=27250 Epoch=133.0] | Loss=0.01101 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.762 | L2-Norm(final)=13.721 | 4783.8 samples/s | 74.7 steps/s
[Step=27300 Epoch=133.2] | Loss=0.01059 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.767 | L2-Norm(final)=13.723 | 5488.2 samples/s | 85.8 steps/s
[Step=27350 Epoch=133.5] | Loss=0.01028 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.771 | L2-Norm(final)=13.725 | 2703.3 samples/s | 42.2 steps/s
[Step=27400 Epoch=133.7] | Loss=0.00996 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.775 | L2-Norm(final)=13.727 | 4744.9 samples/s | 74.1 steps/s
[Step=27450 Epoch=133.9] | Loss=0.00964 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.779 | L2-Norm(final)=13.728 | 4784.4 samples/s | 74.8 steps/s
[Step=27500 Epoch=134.2] | Loss=0.00936 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.783 | L2-Norm(final)=13.730 | 5103.9 samples/s | 79.7 steps/s
[Step=27550 Epoch=134.4] | Loss=0.00915 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.786 | L2-Norm(final)=13.732 | 2851.8 samples/s | 44.6 steps/s
[Step=27600 Epoch=134.7] | Loss=0.00884 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.789 | L2-Norm(final)=13.734 | 4674.1 samples/s | 73.0 steps/s
[Step=27650 Epoch=134.9] | Loss=0.00865 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.792 | L2-Norm(final)=13.735 | 4736.2 samples/s | 74.0 steps/s
[Step=27700 Epoch=135.2] | Loss=0.00845 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.795 | L2-Norm(final)=13.737 | 4878.3 samples/s | 76.2 steps/s
[Step=27750 Epoch=135.4] | Loss=0.00823 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.798 | L2-Norm(final)=13.738 | 2921.0 samples/s | 45.6 steps/s
[Step=27800 Epoch=135.7] | Loss=0.00805 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.801 | L2-Norm(final)=13.740 | 4687.2 samples/s | 73.2 steps/s
[Step=27850 Epoch=135.9] | Loss=0.00786 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.803 | L2-Norm(final)=13.742 | 4801.4 samples/s | 75.0 steps/s
[Step=27900 Epoch=136.1] | Loss=0.00769 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.806 | L2-Norm(final)=13.743 | 4751.7 samples/s | 74.2 steps/s
[Step=27950 Epoch=136.4] | Loss=0.00754 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.809 | L2-Norm(final)=13.745 | 2910.9 samples/s | 45.5 steps/s
[Step=28000 Epoch=136.6] | Loss=0.00743 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.811 | L2-Norm(final)=13.747 | 4868.6 samples/s | 76.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step28000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=16001 Epoch=78.0] | Loss=0.01093 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.526 | L2-Norm(final)=11.057 | 6723.1 samples/s | 105.0 steps/s
[Step=16050 Epoch=78.2] | Loss=0.03335 | Reg=0.00133 | acc=0.9375 | L2-Norm=11.528 | L2-Norm(final)=11.071 | 5061.1 samples/s | 79.1 steps/s
[Step=16100 Epoch=78.4] | Loss=0.03790 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.529 | L2-Norm(final)=11.079 | 5567.0 samples/s | 87.0 steps/s
[Step=16150 Epoch=78.7] | Loss=0.03701 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.529 | L2-Norm(final)=11.085 | 5515.3 samples/s | 86.2 steps/s
[Step=16200 Epoch=78.9] | Loss=0.03573 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.529 | L2-Norm(final)=11.092 | 8730.7 samples/s | 136.4 steps/s
[Step=16250 Epoch=79.2] | Loss=0.03411 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.529 | L2-Norm(final)=11.101 | 2719.4 samples/s | 42.5 steps/s
[Step=16300 Epoch=79.4] | Loss=0.03442 | Reg=0.00133 | acc=0.9531 | L2-Norm=11.529 | L2-Norm(final)=11.112 | 5451.4 samples/s | 85.2 steps/s
[Step=16350 Epoch=79.7] | Loss=0.03508 | Reg=0.00133 | acc=0.9375 | L2-Norm=11.529 | L2-Norm(final)=11.121 | 5629.7 samples/s | 88.0 steps/s
[Step=16400 Epoch=79.9] | Loss=0.03516 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.529 | L2-Norm(final)=11.127 | 7497.1 samples/s | 117.1 steps/s
[Step=16450 Epoch=80.2] | Loss=0.03479 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.529 | L2-Norm(final)=11.133 | 2808.6 samples/s | 43.9 steps/s
[Step=16500 Epoch=80.4] | Loss=0.03491 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.529 | L2-Norm(final)=11.140 | 5683.9 samples/s | 88.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=16501 Epoch=80.4] | Loss=0.03787 | Reg=0.00133 | acc=0.9531 | L2-Norm=11.529 | L2-Norm(final)=11.206 | 7168.1 samples/s | 112.0 steps/s
[Step=16550 Epoch=80.6] | Loss=0.03662 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.561 | L2-Norm(final)=11.207 | 4288.6 samples/s | 67.0 steps/s
[Step=16600 Epoch=80.9] | Loss=0.03335 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.599 | L2-Norm(final)=11.208 | 4825.7 samples/s | 75.4 steps/s
[Step=16650 Epoch=81.1] | Loss=0.03040 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.633 | L2-Norm(final)=11.211 | 4675.3 samples/s | 73.1 steps/s
[Step=16700 Epoch=81.4] | Loss=0.02816 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.661 | L2-Norm(final)=11.214 | 6878.3 samples/s | 107.5 steps/s
[Step=16750 Epoch=81.6] | Loss=0.02472 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.683 | L2-Norm(final)=11.217 | 2457.8 samples/s | 38.4 steps/s
[Step=16800 Epoch=81.9] | Loss=0.02235 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.702 | L2-Norm(final)=11.222 | 4780.2 samples/s | 74.7 steps/s
[Step=16850 Epoch=82.1] | Loss=0.02057 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.718 | L2-Norm(final)=11.226 | 4846.6 samples/s | 75.7 steps/s
[Step=16900 Epoch=82.3] | Loss=0.01926 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.733 | L2-Norm(final)=11.230 | 6089.8 samples/s | 95.2 steps/s
[Step=16950 Epoch=82.6] | Loss=0.01797 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.746 | L2-Norm(final)=11.235 | 2585.0 samples/s | 40.4 steps/s
[Step=17000 Epoch=82.8] | Loss=0.01679 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.757 | L2-Norm(final)=11.239 | 4813.5 samples/s | 75.2 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01617 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.768 | L2-Norm(final)=11.243 | 4688.1 samples/s | 73.3 steps/s
[Step=17100 Epoch=83.3] | Loss=0.01535 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.779 | L2-Norm(final)=11.247 | 5733.0 samples/s | 89.6 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01462 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.788 | L2-Norm(final)=11.252 | 2408.7 samples/s | 37.6 steps/s
[Step=17200 Epoch=83.8] | Loss=0.01391 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.797 | L2-Norm(final)=11.256 | 4783.8 samples/s | 74.7 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01335 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.805 | L2-Norm(final)=11.260 | 4747.1 samples/s | 74.2 steps/s
[Step=17300 Epoch=84.3] | Loss=0.01281 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.812 | L2-Norm(final)=11.264 | 5257.2 samples/s | 82.1 steps/s
[Step=17350 Epoch=84.5] | Loss=0.01244 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.819 | L2-Norm(final)=11.267 | 2792.7 samples/s | 43.6 steps/s
[Step=17400 Epoch=84.8] | Loss=0.01202 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=11.271 | 4829.2 samples/s | 75.5 steps/s
[Step=17450 Epoch=85.0] | Loss=0.01159 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.832 | L2-Norm(final)=11.274 | 4686.3 samples/s | 73.2 steps/s
[Step=17500 Epoch=85.3] | Loss=0.01136 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.838 | L2-Norm(final)=11.278 | 4918.2 samples/s | 76.8 steps/s
[Step=17550 Epoch=85.5] | Loss=0.01103 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.843 | L2-Norm(final)=11.281 | 2898.1 samples/s | 45.3 steps/s
[Step=17600 Epoch=85.8] | Loss=0.01070 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.849 | L2-Norm(final)=11.284 | 4740.6 samples/s | 74.1 steps/s
[Step=17650 Epoch=86.0] | Loss=0.01038 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.854 | L2-Norm(final)=11.287 | 4796.4 samples/s | 74.9 steps/s
[Step=17700 Epoch=86.2] | Loss=0.01012 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.859 | L2-Norm(final)=11.290 | 4752.2 samples/s | 74.3 steps/s
[Step=17750 Epoch=86.5] | Loss=0.00988 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.864 | L2-Norm(final)=11.293 | 2971.4 samples/s | 46.4 steps/s
[Step=17800 Epoch=86.7] | Loss=0.00967 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.869 | L2-Norm(final)=11.297 | 4798.2 samples/s | 75.0 steps/s
[Step=17850 Epoch=87.0] | Loss=0.00941 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.873 | L2-Norm(final)=11.300 | 4706.9 samples/s | 73.5 steps/s
[Step=17900 Epoch=87.2] | Loss=0.00925 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.877 | L2-Norm(final)=11.303 | 4735.1 samples/s | 74.0 steps/s
[Step=17950 Epoch=87.5] | Loss=0.00909 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.881 | L2-Norm(final)=11.305 | 2960.0 samples/s | 46.2 steps/s
[Step=18000 Epoch=87.7] | Loss=0.00887 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.885 | L2-Norm(final)=11.308 | 4793.3 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step18000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=32001 Epoch=303.2] | Loss=0.00003 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.526 | L2-Norm(final)=16.841 | 6445.0 samples/s | 100.7 steps/s
[Step=32050 Epoch=303.7] | Loss=0.00090 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=16.845 | 4763.4 samples/s | 74.4 steps/s
[Step=32100 Epoch=304.2] | Loss=0.00066 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=16.849 | 7968.9 samples/s | 124.5 steps/s
[Step=32150 Epoch=304.6] | Loss=0.00055 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=16.852 | 2616.0 samples/s | 40.9 steps/s
[Step=32200 Epoch=305.1] | Loss=0.00065 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=16.855 | 6902.8 samples/s | 107.9 steps/s
[Step=32250 Epoch=305.6] | Loss=0.00059 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=16.860 | 2683.4 samples/s | 41.9 steps/s
[Step=32300 Epoch=306.1] | Loss=0.00056 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=16.867 | 6525.7 samples/s | 102.0 steps/s
[Step=32350 Epoch=306.5] | Loss=0.00068 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=16.872 | 2791.5 samples/s | 43.6 steps/s
[Step=32400 Epoch=307.0] | Loss=0.00064 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=16.877 | 5935.5 samples/s | 92.7 steps/s
[Step=32450 Epoch=307.5] | Loss=0.00061 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=16.883 | 2931.6 samples/s | 45.8 steps/s
[Step=32500 Epoch=308.0] | Loss=0.00063 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=16.888 | 5398.3 samples/s | 84.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=32501 Epoch=308.0] | Loss=0.00068 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=16.944 | 7105.5 samples/s | 111.0 steps/s
[Step=32550 Epoch=308.4] | Loss=0.00020 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.515 | L2-Norm(final)=16.949 | 4042.4 samples/s | 63.2 steps/s
[Step=32600 Epoch=308.9] | Loss=0.00029 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.512 | L2-Norm(final)=16.953 | 6523.5 samples/s | 101.9 steps/s
[Step=32650 Epoch=309.4] | Loss=0.00020 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.512 | L2-Norm(final)=16.956 | 2385.0 samples/s | 37.3 steps/s
[Step=32700 Epoch=309.9] | Loss=0.00015 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.505 | L2-Norm(final)=16.957 | 5983.4 samples/s | 93.5 steps/s
[Step=32750 Epoch=310.3] | Loss=0.00012 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.496 | L2-Norm(final)=16.959 | 2508.7 samples/s | 39.2 steps/s
[Step=32800 Epoch=310.8] | Loss=0.00010 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.486 | L2-Norm(final)=16.960 | 5336.8 samples/s | 83.4 steps/s
[Step=32850 Epoch=311.3] | Loss=0.00009 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.475 | L2-Norm(final)=16.960 | 2581.1 samples/s | 40.3 steps/s
[Step=32900 Epoch=311.8] | Loss=0.00008 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.465 | L2-Norm(final)=16.961 | 5046.2 samples/s | 78.8 steps/s
[Step=32950 Epoch=312.2] | Loss=0.00007 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.455 | L2-Norm(final)=16.962 | 2658.7 samples/s | 41.5 steps/s
[Step=33000 Epoch=312.7] | Loss=0.00006 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.444 | L2-Norm(final)=16.962 | 4663.8 samples/s | 72.9 steps/s
[Step=33050 Epoch=313.2] | Loss=0.00006 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.434 | L2-Norm(final)=16.962 | 2814.7 samples/s | 44.0 steps/s
[Step=33100 Epoch=313.7] | Loss=0.00005 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.423 | L2-Norm(final)=16.963 | 4602.8 samples/s | 71.9 steps/s
[Step=33150 Epoch=314.1] | Loss=0.00005 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=16.963 | 2856.6 samples/s | 44.6 steps/s
[Step=33200 Epoch=314.6] | Loss=0.00005 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.403 | L2-Norm(final)=16.964 | 4502.0 samples/s | 70.3 steps/s
[Step=33250 Epoch=315.1] | Loss=0.00004 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.393 | L2-Norm(final)=16.964 | 2887.8 samples/s | 45.1 steps/s
[Step=33300 Epoch=315.5] | Loss=0.00004 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.382 | L2-Norm(final)=16.964 | 4504.5 samples/s | 70.4 steps/s
[Step=33350 Epoch=316.0] | Loss=0.00004 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.372 | L2-Norm(final)=16.965 | 3027.4 samples/s | 47.3 steps/s
[Step=33400 Epoch=316.5] | Loss=0.00004 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.362 | L2-Norm(final)=16.965 | 4230.4 samples/s | 66.1 steps/s
[Step=33450 Epoch=317.0] | Loss=0.00003 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=16.965 | 6833.7 samples/s | 106.8 steps/s
[Step=33500 Epoch=317.4] | Loss=0.00003 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=16.966 | 2365.1 samples/s | 37.0 steps/s
[Step=33550 Epoch=317.9] | Loss=0.00003 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.332 | L2-Norm(final)=16.966 | 6168.5 samples/s | 96.4 steps/s
[Step=33600 Epoch=318.4] | Loss=0.00003 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.322 | L2-Norm(final)=16.966 | 2427.7 samples/s | 37.9 steps/s
[Step=33650 Epoch=318.9] | Loss=0.00003 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.311 | L2-Norm(final)=16.967 | 5623.6 samples/s | 87.9 steps/s
[Step=33700 Epoch=319.3] | Loss=0.00003 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.301 | L2-Norm(final)=16.967 | 2533.2 samples/s | 39.6 steps/s
[Step=33750 Epoch=319.8] | Loss=0.00003 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.291 | L2-Norm(final)=16.967 | 5138.0 samples/s | 80.3 steps/s
[Step=33800 Epoch=320.3] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.281 | L2-Norm(final)=16.968 | 2669.4 samples/s | 41.7 steps/s
[Step=33850 Epoch=320.8] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.271 | L2-Norm(final)=16.968 | 4769.8 samples/s | 74.5 steps/s
[Step=33900 Epoch=321.2] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=16.968 | 2773.9 samples/s | 43.3 steps/s
[Step=33950 Epoch=321.7] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.250 | L2-Norm(final)=16.968 | 4468.1 samples/s | 69.8 steps/s
[Step=34000 Epoch=322.2] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.240 | L2-Norm(final)=16.969 | 2861.6 samples/s | 44.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step34000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=209.7] | Loss=0.00302 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.526 | L2-Norm(final)=13.832 | 7592.7 samples/s | 118.6 steps/s
[Step=22050 Epoch=210.2] | Loss=0.00379 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.522 | L2-Norm(final)=13.855 | 4321.9 samples/s | 67.5 steps/s
[Step=22100 Epoch=210.6] | Loss=0.00370 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.522 | L2-Norm(final)=13.881 | 8319.6 samples/s | 130.0 steps/s
[Step=22150 Epoch=211.1] | Loss=0.00369 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.522 | L2-Norm(final)=13.905 | 2595.6 samples/s | 40.6 steps/s
[Step=22200 Epoch=211.6] | Loss=0.00372 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.521 | L2-Norm(final)=13.928 | 7174.7 samples/s | 112.1 steps/s
[Step=22250 Epoch=212.1] | Loss=0.00376 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.521 | L2-Norm(final)=13.950 | 2662.6 samples/s | 41.6 steps/s
[Step=22300 Epoch=212.5] | Loss=0.00362 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.521 | L2-Norm(final)=13.971 | 6694.0 samples/s | 104.6 steps/s
[Step=22350 Epoch=213.0] | Loss=0.00367 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.521 | L2-Norm(final)=13.991 | 2737.6 samples/s | 42.8 steps/s
[Step=22400 Epoch=213.5] | Loss=0.00358 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.521 | L2-Norm(final)=14.011 | 6256.0 samples/s | 97.7 steps/s
[Step=22450 Epoch=214.0] | Loss=0.00347 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.521 | L2-Norm(final)=14.029 | 2898.3 samples/s | 45.3 steps/s
[Step=22500 Epoch=214.4] | Loss=0.00353 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.521 | L2-Norm(final)=14.047 | 5603.4 samples/s | 87.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=214.5] | Loss=0.00027 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.521 | L2-Norm(final)=14.226 | 6635.5 samples/s | 103.7 steps/s
[Step=22550 Epoch=214.9] | Loss=0.00169 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.574 | L2-Norm(final)=14.233 | 4171.2 samples/s | 65.2 steps/s
[Step=22600 Epoch=215.4] | Loss=0.00249 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.625 | L2-Norm(final)=14.234 | 6690.6 samples/s | 104.5 steps/s
[Step=22650 Epoch=215.9] | Loss=0.00242 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=14.229 | 2376.7 samples/s | 37.1 steps/s
[Step=22700 Epoch=216.4] | Loss=0.00190 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=14.227 | 6124.5 samples/s | 95.7 steps/s
[Step=22750 Epoch=216.8] | Loss=0.00152 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.711 | L2-Norm(final)=14.226 | 2463.5 samples/s | 38.5 steps/s
[Step=22800 Epoch=217.3] | Loss=0.00127 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.717 | L2-Norm(final)=14.225 | 5610.0 samples/s | 87.7 steps/s
[Step=22850 Epoch=217.8] | Loss=0.00109 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.720 | L2-Norm(final)=14.225 | 2543.8 samples/s | 39.7 steps/s
[Step=22900 Epoch=218.3] | Loss=0.00096 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.719 | L2-Norm(final)=14.225 | 5214.7 samples/s | 81.5 steps/s
[Step=22950 Epoch=218.7] | Loss=0.00085 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.717 | L2-Norm(final)=14.225 | 2626.8 samples/s | 41.0 steps/s
[Step=23000 Epoch=219.2] | Loss=0.00077 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.714 | L2-Norm(final)=14.225 | 4892.1 samples/s | 76.4 steps/s
[Step=23050 Epoch=219.7] | Loss=0.00070 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.710 | L2-Norm(final)=14.225 | 2695.9 samples/s | 42.1 steps/s
[Step=23100 Epoch=220.2] | Loss=0.00064 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=14.225 | 4601.0 samples/s | 71.9 steps/s
[Step=23150 Epoch=220.6] | Loss=0.00059 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.700 | L2-Norm(final)=14.226 | 2828.7 samples/s | 44.2 steps/s
[Step=23200 Epoch=221.1] | Loss=0.00055 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.695 | L2-Norm(final)=14.226 | 4465.5 samples/s | 69.8 steps/s
[Step=23250 Epoch=221.6] | Loss=0.00051 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.689 | L2-Norm(final)=14.226 | 2880.6 samples/s | 45.0 steps/s
[Step=23300 Epoch=222.1] | Loss=0.00048 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=14.226 | 4395.1 samples/s | 68.7 steps/s
[Step=23350 Epoch=222.5] | Loss=0.00045 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.677 | L2-Norm(final)=14.226 | 2807.6 samples/s | 43.9 steps/s
[Step=23400 Epoch=223.0] | Loss=0.00043 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=14.227 | 4576.8 samples/s | 71.5 steps/s
[Step=23450 Epoch=223.5] | Loss=0.00041 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.665 | L2-Norm(final)=14.227 | 2839.0 samples/s | 44.4 steps/s
[Step=23500 Epoch=224.0] | Loss=0.00039 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.658 | L2-Norm(final)=14.227 | 4518.7 samples/s | 70.6 steps/s
[Step=23550 Epoch=224.5] | Loss=0.00037 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.652 | L2-Norm(final)=14.228 | 7310.5 samples/s | 114.2 steps/s
[Step=23600 Epoch=224.9] | Loss=0.00035 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.645 | L2-Norm(final)=14.228 | 2309.0 samples/s | 36.1 steps/s
[Step=23650 Epoch=225.4] | Loss=0.00034 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.639 | L2-Norm(final)=14.228 | 6588.1 samples/s | 102.9 steps/s
[Step=23700 Epoch=225.9] | Loss=0.00032 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.632 | L2-Norm(final)=14.229 | 2368.0 samples/s | 37.0 steps/s
[Step=23750 Epoch=226.4] | Loss=0.00031 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.625 | L2-Norm(final)=14.229 | 6143.7 samples/s | 96.0 steps/s
[Step=23800 Epoch=226.8] | Loss=0.00030 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.618 | L2-Norm(final)=14.229 | 2430.8 samples/s | 38.0 steps/s
[Step=23850 Epoch=227.3] | Loss=0.00029 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.611 | L2-Norm(final)=14.230 | 5693.4 samples/s | 89.0 steps/s
[Step=23900 Epoch=227.8] | Loss=0.00028 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.604 | L2-Norm(final)=14.230 | 2513.5 samples/s | 39.3 steps/s
[Step=23950 Epoch=228.3] | Loss=0.00027 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.598 | L2-Norm(final)=14.230 | 5288.5 samples/s | 82.6 steps/s
[Step=24000 Epoch=228.7] | Loss=0.00026 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.591 | L2-Norm(final)=14.231 | 2628.3 samples/s | 41.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09086 | acc=0.9605 | tpr=0.9675 | fpr=0.0548 | 5838.1 samples/s | 22.8 steps/s
Avg test loss: 0.10147, Avg test acc: 0.95621, Avg tpr: 0.96316, Avg fpr: 0.05909, total FA: 461

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10523 | acc=0.9577 | tpr=0.9766 | fpr=0.0835 | 6006.4 samples/s | 23.5 steps/s
Avg test loss: 0.10822, Avg test acc: 0.95693, Avg tpr: 0.97570, Avg fpr: 0.08435, total FA: 658

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.10701 | acc=0.9575 | tpr=0.9754 | fpr=0.0813 | 5877.4 samples/s | 23.0 steps/s
Avg test loss: 0.10625, Avg test acc: 0.95721, Avg tpr: 0.97366, Avg fpr: 0.07896, total FA: 616

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09808 | acc=0.9580 | tpr=0.9767 | fpr=0.0825 | 5637.3 samples/s | 22.0 steps/s
Avg test loss: 0.10399, Avg test acc: 0.95649, Avg tpr: 0.97570, Avg fpr: 0.08576, total FA: 669

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11715 | acc=0.9537 | tpr=0.9617 | fpr=0.0634 | 6012.1 samples/s | 23.5 steps/s
Avg test loss: 0.12395, Avg test acc: 0.95228, Avg tpr: 0.95920, Avg fpr: 0.06294, total FA: 491

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.50056 | acc=0.2737 | tpr=0.0181 | fpr=0.1712 | 6077.6 samples/s | 23.7 steps/s
Avg test loss: 6.51569, Avg test acc: 0.27294, Avg tpr: 0.01731, Avg fpr: 0.16485, total FA: 1286

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.86704 | acc=0.3123 | tpr=0.0226 | fpr=0.0587 | 5997.0 samples/s | 23.4 steps/s
Avg test loss: 4.87636, Avg test acc: 0.31040, Avg tpr: 0.02256, Avg fpr: 0.05653, total FA: 441

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.16037 | acc=0.2809 | tpr=0.0152 | fpr=0.1420 | 5949.1 samples/s | 23.2 steps/s
Avg test loss: 5.16918, Avg test acc: 0.27911, Avg tpr: 0.01440, Avg fpr: 0.13870, total FA: 1082

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.15998 | acc=0.2762 | tpr=0.0277 | fpr=0.1843 | 5977.8 samples/s | 23.4 steps/s
Avg test loss: 5.16219, Avg test acc: 0.27518, Avg tpr: 0.02629, Avg fpr: 0.17741, total FA: 1384

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.52018 | acc=0.2965 | tpr=0.0197 | fpr=0.1026 | 6184.0 samples/s | 24.2 steps/s
Avg test loss: 5.52953, Avg test acc: 0.29417, Avg tpr: 0.01853, Avg fpr: 0.09960, total FA: 777

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.92569 | acc=0.1481 | tpr=0.5841 | fpr=0.8597 | 6002.1 samples/s | 23.4 steps/s
[Step= 100] | Loss=4.91399 | acc=0.1524 | tpr=0.5714 | fpr=0.8554 | 7748.9 samples/s | 30.3 steps/s
[Step= 150] | Loss=4.90988 | acc=0.1540 | tpr=0.5965 | fpr=0.8541 | 5629.8 samples/s | 22.0 steps/s
[Step= 200] | Loss=4.90137 | acc=0.1544 | tpr=0.5836 | fpr=0.8534 | 8448.9 samples/s | 33.0 steps/s
[Step= 250] | Loss=4.90572 | acc=0.1537 | tpr=0.5799 | fpr=0.8541 | 8754.7 samples/s | 34.2 steps/s
[Step= 300] | Loss=4.89934 | acc=0.1535 | tpr=0.5724 | fpr=0.8541 | 7694.1 samples/s | 30.1 steps/s
[Step= 350] | Loss=4.90380 | acc=0.1530 | tpr=0.5686 | fpr=0.8546 | 7904.3 samples/s | 30.9 steps/s
[Step= 400] | Loss=4.90033 | acc=0.1538 | tpr=0.5667 | fpr=0.8537 | 7404.4 samples/s | 28.9 steps/s
[Step= 450] | Loss=4.90397 | acc=0.1535 | tpr=0.5725 | fpr=0.8541 | 8758.0 samples/s | 34.2 steps/s
[Step= 500] | Loss=4.90392 | acc=0.1536 | tpr=0.5762 | fpr=0.8541 | 8505.1 samples/s | 33.2 steps/s
[Step= 550] | Loss=4.90680 | acc=0.1536 | tpr=0.5774 | fpr=0.8541 | 9172.0 samples/s | 35.8 steps/s
Avg test loss: 4.90742, Avg test acc: 0.15350, Avg tpr: 0.57805, Avg fpr: 0.85422, total FA: 118607

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.32873 | acc=0.1220 | tpr=0.5973 | fpr=0.8865 | 5960.4 samples/s | 23.3 steps/s
[Step= 100] | Loss=5.30555 | acc=0.1260 | tpr=0.6055 | fpr=0.8830 | 8034.2 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.29567 | acc=0.1281 | tpr=0.6153 | fpr=0.8809 | 5322.8 samples/s | 20.8 steps/s
[Step= 200] | Loss=5.29231 | acc=0.1284 | tpr=0.6109 | fpr=0.8804 | 8600.1 samples/s | 33.6 steps/s
[Step= 250] | Loss=5.29620 | acc=0.1282 | tpr=0.6105 | fpr=0.8806 | 8232.7 samples/s | 32.2 steps/s
[Step= 300] | Loss=5.29192 | acc=0.1277 | tpr=0.6065 | fpr=0.8810 | 8072.7 samples/s | 31.5 steps/s
[Step= 350] | Loss=5.29986 | acc=0.1278 | tpr=0.6074 | fpr=0.8809 | 8060.4 samples/s | 31.5 steps/s
[Step= 400] | Loss=5.29804 | acc=0.1281 | tpr=0.6045 | fpr=0.8806 | 8306.6 samples/s | 32.4 steps/s
[Step= 450] | Loss=5.30109 | acc=0.1274 | tpr=0.6081 | fpr=0.8814 | 7957.4 samples/s | 31.1 steps/s
[Step= 500] | Loss=5.30153 | acc=0.1272 | tpr=0.6132 | fpr=0.8815 | 7841.7 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.30492 | acc=0.1274 | tpr=0.6148 | fpr=0.8814 | 10217.7 samples/s | 39.9 steps/s
Avg test loss: 5.30564, Avg test acc: 0.12737, Avg tpr: 0.61569, Avg fpr: 0.88151, total FA: 122396

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.54762 | acc=0.1235 | tpr=0.7080 | fpr=0.8870 | 5713.0 samples/s | 22.3 steps/s
[Step= 100] | Loss=5.52275 | acc=0.1260 | tpr=0.6994 | fpr=0.8847 | 5798.2 samples/s | 22.6 steps/s
[Step= 150] | Loss=5.51375 | acc=0.1274 | tpr=0.7003 | fpr=0.8831 | 8101.3 samples/s | 31.6 steps/s
[Step= 200] | Loss=5.50679 | acc=0.1279 | tpr=0.6885 | fpr=0.8823 | 7988.2 samples/s | 31.2 steps/s
[Step= 250] | Loss=5.50996 | acc=0.1283 | tpr=0.6873 | fpr=0.8819 | 8127.7 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.50800 | acc=0.1281 | tpr=0.6807 | fpr=0.8819 | 8090.5 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.51658 | acc=0.1277 | tpr=0.6807 | fpr=0.8823 | 7960.7 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.51447 | acc=0.1280 | tpr=0.6789 | fpr=0.8820 | 7798.2 samples/s | 30.5 steps/s
[Step= 450] | Loss=5.51897 | acc=0.1273 | tpr=0.6811 | fpr=0.8828 | 8570.0 samples/s | 33.5 steps/s
[Step= 500] | Loss=5.51675 | acc=0.1273 | tpr=0.6824 | fpr=0.8827 | 7282.5 samples/s | 28.4 steps/s
[Step= 550] | Loss=5.52111 | acc=0.1272 | tpr=0.6825 | fpr=0.8829 | 11367.7 samples/s | 44.4 steps/s
Avg test loss: 5.52149, Avg test acc: 0.12705, Avg tpr: 0.68344, Avg fpr: 0.88307, total FA: 122612

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.51370 | acc=0.1231 | tpr=0.7124 | fpr=0.8875 | 6083.4 samples/s | 23.8 steps/s
[Step= 100] | Loss=5.49380 | acc=0.1254 | tpr=0.6844 | fpr=0.8851 | 5425.5 samples/s | 21.2 steps/s
[Step= 150] | Loss=5.48351 | acc=0.1268 | tpr=0.6945 | fpr=0.8837 | 8063.6 samples/s | 31.5 steps/s
[Step= 200] | Loss=5.47890 | acc=0.1270 | tpr=0.6918 | fpr=0.8833 | 8084.3 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.48056 | acc=0.1270 | tpr=0.6926 | fpr=0.8833 | 8055.1 samples/s | 31.5 steps/s
[Step= 300] | Loss=5.47693 | acc=0.1269 | tpr=0.6924 | fpr=0.8834 | 7821.9 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.48134 | acc=0.1266 | tpr=0.6957 | fpr=0.8837 | 8166.3 samples/s | 31.9 steps/s
[Step= 400] | Loss=5.47927 | acc=0.1268 | tpr=0.6942 | fpr=0.8835 | 8245.1 samples/s | 32.2 steps/s
[Step= 450] | Loss=5.48405 | acc=0.1261 | tpr=0.6972 | fpr=0.8843 | 8096.7 samples/s | 31.6 steps/s
[Step= 500] | Loss=5.48288 | acc=0.1261 | tpr=0.6991 | fpr=0.8842 | 7971.7 samples/s | 31.1 steps/s
[Step= 550] | Loss=5.48948 | acc=0.1262 | tpr=0.6988 | fpr=0.8842 | 10416.2 samples/s | 40.7 steps/s
Avg test loss: 5.49069, Avg test acc: 0.12609, Avg tpr: 0.69929, Avg fpr: 0.88433, total FA: 122787

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.29585 | acc=0.1362 | tpr=0.5708 | fpr=0.8716 | 5822.4 samples/s | 22.7 steps/s
[Step= 100] | Loss=5.28207 | acc=0.1372 | tpr=0.5736 | fpr=0.8709 | 5793.1 samples/s | 22.6 steps/s
[Step= 150] | Loss=5.26660 | acc=0.1386 | tpr=0.5749 | fpr=0.8694 | 8627.7 samples/s | 33.7 steps/s
[Step= 200] | Loss=5.26796 | acc=0.1395 | tpr=0.5738 | fpr=0.8684 | 8190.5 samples/s | 32.0 steps/s
[Step= 250] | Loss=5.26797 | acc=0.1391 | tpr=0.5677 | fpr=0.8687 | 7530.5 samples/s | 29.4 steps/s
[Step= 300] | Loss=5.26171 | acc=0.1395 | tpr=0.5724 | fpr=0.8684 | 7916.8 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.27088 | acc=0.1393 | tpr=0.5654 | fpr=0.8684 | 8307.9 samples/s | 32.5 steps/s
[Step= 400] | Loss=5.26640 | acc=0.1396 | tpr=0.5629 | fpr=0.8681 | 8931.8 samples/s | 34.9 steps/s
[Step= 450] | Loss=5.27195 | acc=0.1388 | tpr=0.5682 | fpr=0.8689 | 7765.2 samples/s | 30.3 steps/s
[Step= 500] | Loss=5.27133 | acc=0.1389 | tpr=0.5714 | fpr=0.8689 | 7341.6 samples/s | 28.7 steps/s
[Step= 550] | Loss=5.27311 | acc=0.1389 | tpr=0.5726 | fpr=0.8689 | 10644.1 samples/s | 41.6 steps/s
Avg test loss: 5.27459, Avg test acc: 0.13887, Avg tpr: 0.57369, Avg fpr: 0.86904, total FA: 120664

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.22476 | acc=0.9596 | tpr=0.9292 | fpr=0.0398 | 4739.2 samples/s | 18.5 steps/s
[Step= 100] | Loss=0.23351 | acc=0.9579 | tpr=0.9446 | fpr=0.0419 | 7894.1 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.23549 | acc=0.9565 | tpr=0.9467 | fpr=0.0433 | 7627.2 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.23540 | acc=0.9566 | tpr=0.9497 | fpr=0.0433 | 8134.7 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.23536 | acc=0.9566 | tpr=0.9476 | fpr=0.0432 | 8676.3 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.23859 | acc=0.9563 | tpr=0.9440 | fpr=0.0435 | 7793.2 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.23654 | acc=0.9565 | tpr=0.9443 | fpr=0.0433 | 7904.4 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.23651 | acc=0.9561 | tpr=0.9426 | fpr=0.0437 | 8257.1 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.24055 | acc=0.9556 | tpr=0.9401 | fpr=0.0441 | 8022.3 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.24037 | acc=0.9554 | tpr=0.9423 | fpr=0.0444 | 8002.3 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.23882 | acc=0.9557 | tpr=0.9419 | fpr=0.0440 | 9566.2 samples/s | 37.4 steps/s
Avg test loss: 0.23837, Avg test acc: 0.95573, Avg tpr: 0.94176, Avg fpr: 0.04402, total FA: 6112

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16689 | acc=0.9598 | tpr=0.9027 | fpr=0.0392 | 4577.1 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.17173 | acc=0.9585 | tpr=0.9318 | fpr=0.0410 | 8069.0 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.17376 | acc=0.9573 | tpr=0.9366 | fpr=0.0423 | 7906.1 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.17493 | acc=0.9572 | tpr=0.9410 | fpr=0.0425 | 7861.1 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.17424 | acc=0.9573 | tpr=0.9362 | fpr=0.0424 | 7642.2 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.17571 | acc=0.9569 | tpr=0.9360 | fpr=0.0427 | 8005.6 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.17429 | acc=0.9571 | tpr=0.9374 | fpr=0.0425 | 7616.8 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.17386 | acc=0.9570 | tpr=0.9333 | fpr=0.0426 | 8302.3 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.17652 | acc=0.9565 | tpr=0.9309 | fpr=0.0430 | 7935.1 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.17638 | acc=0.9563 | tpr=0.9300 | fpr=0.0432 | 8291.6 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.17526 | acc=0.9565 | tpr=0.9276 | fpr=0.0430 | 11218.5 samples/s | 43.8 steps/s
Avg test loss: 0.17490, Avg test acc: 0.95653, Avg tpr: 0.92750, Avg fpr: 0.04295, total FA: 5963

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.23013 | acc=0.9537 | tpr=0.9513 | fpr=0.0463 | 4719.2 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.23629 | acc=0.9521 | tpr=0.9595 | fpr=0.0480 | 7792.0 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.24044 | acc=0.9508 | tpr=0.9582 | fpr=0.0493 | 7621.5 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.24026 | acc=0.9510 | tpr=0.9617 | fpr=0.0492 | 7749.8 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.24034 | acc=0.9509 | tpr=0.9624 | fpr=0.0493 | 7658.3 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.24385 | acc=0.9506 | tpr=0.9593 | fpr=0.0495 | 8345.2 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.24152 | acc=0.9508 | tpr=0.9593 | fpr=0.0493 | 8246.6 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.24138 | acc=0.9505 | tpr=0.9562 | fpr=0.0496 | 8534.8 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.24518 | acc=0.9501 | tpr=0.9542 | fpr=0.0500 | 8081.6 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.24570 | acc=0.9499 | tpr=0.9555 | fpr=0.0502 | 8296.7 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.24412 | acc=0.9501 | tpr=0.9550 | fpr=0.0500 | 9808.6 samples/s | 38.3 steps/s
Avg test loss: 0.24376, Avg test acc: 0.95012, Avg tpr: 0.95483, Avg fpr: 0.04997, total FA: 6938

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.12840 | acc=0.9674 | tpr=0.9248 | fpr=0.0318 | 4576.7 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.13271 | acc=0.9664 | tpr=0.9339 | fpr=0.0329 | 8002.1 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.13229 | acc=0.9654 | tpr=0.9280 | fpr=0.0339 | 7113.7 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.13181 | acc=0.9658 | tpr=0.9344 | fpr=0.0336 | 8012.6 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.13289 | acc=0.9656 | tpr=0.9310 | fpr=0.0337 | 8089.7 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.13573 | acc=0.9652 | tpr=0.9273 | fpr=0.0342 | 8045.9 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.13500 | acc=0.9651 | tpr=0.9255 | fpr=0.0341 | 7805.3 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.13476 | acc=0.9650 | tpr=0.9245 | fpr=0.0343 | 8422.3 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.13685 | acc=0.9646 | tpr=0.9236 | fpr=0.0346 | 8308.9 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.13662 | acc=0.9645 | tpr=0.9233 | fpr=0.0348 | 7637.6 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.13577 | acc=0.9647 | tpr=0.9244 | fpr=0.0346 | 12065.7 samples/s | 47.1 steps/s
Avg test loss: 0.13550, Avg test acc: 0.96475, Avg tpr: 0.92433, Avg fpr: 0.03452, total FA: 4793

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.24932 | acc=0.9574 | tpr=0.8938 | fpr=0.0414 | 6081.9 samples/s | 23.8 steps/s
[Step= 100] | Loss=0.25657 | acc=0.9566 | tpr=0.9232 | fpr=0.0428 | 8163.8 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.25886 | acc=0.9551 | tpr=0.9265 | fpr=0.0444 | 8082.9 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.25817 | acc=0.9551 | tpr=0.9301 | fpr=0.0445 | 7593.5 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.26047 | acc=0.9550 | tpr=0.9258 | fpr=0.0445 | 7622.0 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.26471 | acc=0.9543 | tpr=0.9251 | fpr=0.0452 | 7930.9 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.26269 | acc=0.9544 | tpr=0.9280 | fpr=0.0451 | 9149.0 samples/s | 35.7 steps/s
[Step= 400] | Loss=0.26319 | acc=0.9539 | tpr=0.9240 | fpr=0.0455 | 8102.3 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.26759 | acc=0.9533 | tpr=0.9221 | fpr=0.0461 | 7358.5 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.26767 | acc=0.9532 | tpr=0.9216 | fpr=0.0462 | 8242.5 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.26594 | acc=0.9535 | tpr=0.9220 | fpr=0.0459 | 10364.5 samples/s | 40.5 steps/s
Avg test loss: 0.26567, Avg test acc: 0.95351, Avg tpr: 0.92195, Avg fpr: 0.04591, total FA: 6375

server round 22/50

clients selected: [1 2 7 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=136.6] | Loss=0.05604 | Reg=0.00131 | acc=0.9375 | L2-Norm=11.427 | L2-Norm(final)=13.792 | 7051.6 samples/s | 110.2 steps/s
[Step=28050 Epoch=136.9] | Loss=0.03301 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.427 | L2-Norm(final)=13.778 | 4933.7 samples/s | 77.1 steps/s
[Step=28100 Epoch=137.1] | Loss=0.03331 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.427 | L2-Norm(final)=13.759 | 5469.3 samples/s | 85.5 steps/s
[Step=28150 Epoch=137.4] | Loss=0.03235 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.427 | L2-Norm(final)=13.739 | 5567.2 samples/s | 87.0 steps/s
[Step=28200 Epoch=137.6] | Loss=0.03259 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.427 | L2-Norm(final)=13.726 | 8658.9 samples/s | 135.3 steps/s
[Step=28250 Epoch=137.8] | Loss=0.03188 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=13.715 | 2661.9 samples/s | 41.6 steps/s
[Step=28300 Epoch=138.1] | Loss=0.03181 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.427 | L2-Norm(final)=13.705 | 5537.2 samples/s | 86.5 steps/s
[Step=28350 Epoch=138.3] | Loss=0.03138 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.427 | L2-Norm(final)=13.696 | 5600.4 samples/s | 87.5 steps/s
[Step=28400 Epoch=138.6] | Loss=0.03129 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.427 | L2-Norm(final)=13.687 | 7713.9 samples/s | 120.5 steps/s
[Step=28450 Epoch=138.8] | Loss=0.03075 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.427 | L2-Norm(final)=13.680 | 2787.7 samples/s | 43.6 steps/s
[Step=28500 Epoch=139.1] | Loss=0.03045 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.427 | L2-Norm(final)=13.675 | 5532.0 samples/s | 86.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=139.1] | Loss=0.05284 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.427 | L2-Norm(final)=13.619 | 6887.6 samples/s | 107.6 steps/s
[Step=28550 Epoch=139.3] | Loss=0.02578 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.463 | L2-Norm(final)=13.616 | 4396.5 samples/s | 68.7 steps/s
[Step=28600 Epoch=139.6] | Loss=0.02781 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.505 | L2-Norm(final)=13.612 | 4735.5 samples/s | 74.0 steps/s
[Step=28650 Epoch=139.8] | Loss=0.02740 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.538 | L2-Norm(final)=13.610 | 4797.0 samples/s | 75.0 steps/s
[Step=28700 Epoch=140.0] | Loss=0.02646 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.563 | L2-Norm(final)=13.607 | 6925.6 samples/s | 108.2 steps/s
[Step=28750 Epoch=140.3] | Loss=0.02323 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.584 | L2-Norm(final)=13.607 | 2477.9 samples/s | 38.7 steps/s
[Step=28800 Epoch=140.5] | Loss=0.02052 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.600 | L2-Norm(final)=13.608 | 4747.1 samples/s | 74.2 steps/s
[Step=28850 Epoch=140.8] | Loss=0.01886 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.614 | L2-Norm(final)=13.611 | 4764.6 samples/s | 74.4 steps/s
[Step=28900 Epoch=141.0] | Loss=0.01751 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.626 | L2-Norm(final)=13.613 | 6353.8 samples/s | 99.3 steps/s
[Step=28950 Epoch=141.3] | Loss=0.01628 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.637 | L2-Norm(final)=13.615 | 2563.5 samples/s | 40.1 steps/s
[Step=29000 Epoch=141.5] | Loss=0.01527 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.646 | L2-Norm(final)=13.617 | 4659.5 samples/s | 72.8 steps/s
[Step=29050 Epoch=141.8] | Loss=0.01427 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=13.619 | 4741.5 samples/s | 74.1 steps/s
[Step=29100 Epoch=142.0] | Loss=0.01363 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.661 | L2-Norm(final)=13.621 | 5903.1 samples/s | 92.2 steps/s
[Step=29150 Epoch=142.2] | Loss=0.01288 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.667 | L2-Norm(final)=13.623 | 2627.6 samples/s | 41.1 steps/s
[Step=29200 Epoch=142.5] | Loss=0.01244 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.672 | L2-Norm(final)=13.625 | 4745.5 samples/s | 74.1 steps/s
[Step=29250 Epoch=142.7] | Loss=0.01183 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.678 | L2-Norm(final)=13.627 | 4790.1 samples/s | 74.8 steps/s
[Step=29300 Epoch=143.0] | Loss=0.01140 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=13.629 | 5491.0 samples/s | 85.8 steps/s
[Step=29350 Epoch=143.2] | Loss=0.01099 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.687 | L2-Norm(final)=13.630 | 2721.6 samples/s | 42.5 steps/s
[Step=29400 Epoch=143.5] | Loss=0.01059 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.691 | L2-Norm(final)=13.632 | 4703.0 samples/s | 73.5 steps/s
[Step=29450 Epoch=143.7] | Loss=0.01022 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.695 | L2-Norm(final)=13.634 | 4751.7 samples/s | 74.2 steps/s
[Step=29500 Epoch=143.9] | Loss=0.00990 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.698 | L2-Norm(final)=13.635 | 5124.7 samples/s | 80.1 steps/s
[Step=29550 Epoch=144.2] | Loss=0.00956 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.702 | L2-Norm(final)=13.637 | 2786.6 samples/s | 43.5 steps/s
[Step=29600 Epoch=144.4] | Loss=0.00924 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=13.639 | 4773.1 samples/s | 74.6 steps/s
[Step=29650 Epoch=144.7] | Loss=0.00900 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.708 | L2-Norm(final)=13.641 | 4763.3 samples/s | 74.4 steps/s
[Step=29700 Epoch=144.9] | Loss=0.00883 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.711 | L2-Norm(final)=13.643 | 4855.5 samples/s | 75.9 steps/s
[Step=29750 Epoch=145.2] | Loss=0.00856 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.714 | L2-Norm(final)=13.644 | 2897.1 samples/s | 45.3 steps/s
[Step=29800 Epoch=145.4] | Loss=0.00838 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.716 | L2-Norm(final)=13.646 | 4764.3 samples/s | 74.4 steps/s
[Step=29850 Epoch=145.7] | Loss=0.00819 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.719 | L2-Norm(final)=13.647 | 4809.2 samples/s | 75.1 steps/s
[Step=29900 Epoch=145.9] | Loss=0.00807 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.721 | L2-Norm(final)=13.649 | 4709.7 samples/s | 73.6 steps/s
[Step=29950 Epoch=146.1] | Loss=0.00790 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.724 | L2-Norm(final)=13.650 | 2908.2 samples/s | 45.4 steps/s
[Step=30000 Epoch=146.4] | Loss=0.00776 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.726 | L2-Norm(final)=13.652 | 4798.8 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step30000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=18001 Epoch=87.7] | Loss=0.01349 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.427 | L2-Norm(final)=11.397 | 6670.3 samples/s | 104.2 steps/s
[Step=18050 Epoch=87.9] | Loss=0.03438 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=11.388 | 4850.9 samples/s | 75.8 steps/s
[Step=18100 Epoch=88.2] | Loss=0.03395 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.427 | L2-Norm(final)=11.381 | 5676.0 samples/s | 88.7 steps/s
[Step=18150 Epoch=88.4] | Loss=0.03226 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.427 | L2-Norm(final)=11.379 | 5501.5 samples/s | 86.0 steps/s
[Step=18200 Epoch=88.7] | Loss=0.03253 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.427 | L2-Norm(final)=11.380 | 8528.5 samples/s | 133.3 steps/s
[Step=18250 Epoch=88.9] | Loss=0.03213 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.427 | L2-Norm(final)=11.380 | 2675.0 samples/s | 41.8 steps/s
[Step=18300 Epoch=89.2] | Loss=0.03168 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.427 | L2-Norm(final)=11.381 | 5559.8 samples/s | 86.9 steps/s
[Step=18350 Epoch=89.4] | Loss=0.03175 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.427 | L2-Norm(final)=11.383 | 5668.0 samples/s | 88.6 steps/s
[Step=18400 Epoch=89.7] | Loss=0.03189 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.427 | L2-Norm(final)=11.385 | 7531.1 samples/s | 117.7 steps/s
[Step=18450 Epoch=89.9] | Loss=0.03183 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.427 | L2-Norm(final)=11.387 | 2794.9 samples/s | 43.7 steps/s
[Step=18500 Epoch=90.1] | Loss=0.03216 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.427 | L2-Norm(final)=11.389 | 5519.4 samples/s | 86.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=90.1] | Loss=0.03306 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.427 | L2-Norm(final)=11.408 | 7279.4 samples/s | 113.7 steps/s
[Step=18550 Epoch=90.4] | Loss=0.03177 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.457 | L2-Norm(final)=11.407 | 4419.3 samples/s | 69.1 steps/s
[Step=18600 Epoch=90.6] | Loss=0.02855 | Reg=0.00132 | acc=0.9219 | L2-Norm=11.493 | L2-Norm(final)=11.408 | 4759.3 samples/s | 74.4 steps/s
[Step=18650 Epoch=90.9] | Loss=0.02772 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.525 | L2-Norm(final)=11.409 | 4793.2 samples/s | 74.9 steps/s
[Step=18700 Epoch=91.1] | Loss=0.02679 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.555 | L2-Norm(final)=11.410 | 6822.0 samples/s | 106.6 steps/s
[Step=18750 Epoch=91.4] | Loss=0.02388 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.581 | L2-Norm(final)=11.411 | 2474.0 samples/s | 38.7 steps/s
[Step=18800 Epoch=91.6] | Loss=0.02178 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.604 | L2-Norm(final)=11.415 | 4743.9 samples/s | 74.1 steps/s
[Step=18850 Epoch=91.8] | Loss=0.02000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.624 | L2-Norm(final)=11.419 | 4837.5 samples/s | 75.6 steps/s
[Step=18900 Epoch=92.1] | Loss=0.01909 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.640 | L2-Norm(final)=11.423 | 6103.1 samples/s | 95.4 steps/s
[Step=18950 Epoch=92.3] | Loss=0.01797 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.655 | L2-Norm(final)=11.426 | 2574.3 samples/s | 40.2 steps/s
[Step=19000 Epoch=92.6] | Loss=0.01666 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.668 | L2-Norm(final)=11.430 | 4818.2 samples/s | 75.3 steps/s
[Step=19050 Epoch=92.8] | Loss=0.01565 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.680 | L2-Norm(final)=11.434 | 4663.4 samples/s | 72.9 steps/s
[Step=19100 Epoch=93.1] | Loss=0.01490 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.691 | L2-Norm(final)=11.437 | 5696.9 samples/s | 89.0 steps/s
[Step=19150 Epoch=93.3] | Loss=0.01423 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.700 | L2-Norm(final)=11.441 | 2685.9 samples/s | 42.0 steps/s
[Step=19200 Epoch=93.6] | Loss=0.01362 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.708 | L2-Norm(final)=11.444 | 4752.1 samples/s | 74.3 steps/s
[Step=19250 Epoch=93.8] | Loss=0.01303 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.716 | L2-Norm(final)=11.447 | 4765.5 samples/s | 74.5 steps/s
[Step=19300 Epoch=94.0] | Loss=0.01251 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.723 | L2-Norm(final)=11.450 | 5209.4 samples/s | 81.4 steps/s
[Step=19350 Epoch=94.3] | Loss=0.01240 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=11.453 | 2784.2 samples/s | 43.5 steps/s
[Step=19400 Epoch=94.5] | Loss=0.01193 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.736 | L2-Norm(final)=11.456 | 4775.2 samples/s | 74.6 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01148 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.743 | L2-Norm(final)=11.459 | 4703.4 samples/s | 73.5 steps/s
[Step=19500 Epoch=95.0] | Loss=0.01129 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.749 | L2-Norm(final)=11.462 | 4898.2 samples/s | 76.5 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01110 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.755 | L2-Norm(final)=11.464 | 2887.7 samples/s | 45.1 steps/s
[Step=19600 Epoch=95.5] | Loss=0.01079 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.760 | L2-Norm(final)=11.466 | 4766.4 samples/s | 74.5 steps/s
[Step=19650 Epoch=95.7] | Loss=0.01050 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.766 | L2-Norm(final)=11.468 | 4776.6 samples/s | 74.6 steps/s
[Step=19700 Epoch=96.0] | Loss=0.01024 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.771 | L2-Norm(final)=11.471 | 4703.5 samples/s | 73.5 steps/s
[Step=19750 Epoch=96.2] | Loss=0.00996 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.775 | L2-Norm(final)=11.473 | 2937.7 samples/s | 45.9 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00970 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.780 | L2-Norm(final)=11.475 | 4821.0 samples/s | 75.3 steps/s
[Step=19850 Epoch=96.7] | Loss=0.00949 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.784 | L2-Norm(final)=11.478 | 4714.8 samples/s | 73.7 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00927 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.788 | L2-Norm(final)=11.480 | 4755.7 samples/s | 74.3 steps/s
[Step=19950 Epoch=97.2] | Loss=0.00912 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.792 | L2-Norm(final)=11.482 | 2954.0 samples/s | 46.2 steps/s
[Step=20000 Epoch=97.4] | Loss=0.00893 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.796 | L2-Norm(final)=11.484 | 4719.1 samples/s | 73.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step20000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=191.0] | Loss=0.00222 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=12.691 | 6403.2 samples/s | 100.0 steps/s
[Step=20050 Epoch=191.5] | Loss=0.00194 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.423 | L2-Norm(final)=12.712 | 4714.7 samples/s | 73.7 steps/s
[Step=20100 Epoch=191.9] | Loss=0.00179 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.423 | L2-Norm(final)=12.741 | 8359.3 samples/s | 130.6 steps/s
[Step=20150 Epoch=192.4] | Loss=0.00152 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.423 | L2-Norm(final)=12.763 | 2559.7 samples/s | 40.0 steps/s
[Step=20200 Epoch=192.9] | Loss=0.00170 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.423 | L2-Norm(final)=12.783 | 7513.1 samples/s | 117.4 steps/s
[Step=20250 Epoch=193.4] | Loss=0.00178 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.422 | L2-Norm(final)=12.803 | 2693.0 samples/s | 42.1 steps/s
[Step=20300 Epoch=193.9] | Loss=0.00167 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.422 | L2-Norm(final)=12.821 | 6571.1 samples/s | 102.7 steps/s
[Step=20350 Epoch=194.3] | Loss=0.00157 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.422 | L2-Norm(final)=12.838 | 2763.5 samples/s | 43.2 steps/s
[Step=20400 Epoch=194.8] | Loss=0.00157 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.422 | L2-Norm(final)=12.855 | 6138.2 samples/s | 95.9 steps/s
[Step=20450 Epoch=195.3] | Loss=0.00159 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.422 | L2-Norm(final)=12.870 | 2871.1 samples/s | 44.9 steps/s
[Step=20500 Epoch=195.8] | Loss=0.00153 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.422 | L2-Norm(final)=12.885 | 5735.5 samples/s | 89.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=195.8] | Loss=0.00052 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.422 | L2-Norm(final)=13.026 | 7058.5 samples/s | 110.3 steps/s
[Step=20550 Epoch=196.2] | Loss=0.00216 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.456 | L2-Norm(final)=13.034 | 4051.6 samples/s | 63.3 steps/s
[Step=20600 Epoch=196.7] | Loss=0.00174 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.500 | L2-Norm(final)=13.034 | 6684.6 samples/s | 104.4 steps/s
[Step=20650 Epoch=197.2] | Loss=0.00120 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.521 | L2-Norm(final)=13.035 | 2381.2 samples/s | 37.2 steps/s
[Step=20700 Epoch=197.7] | Loss=0.00090 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.527 | L2-Norm(final)=13.035 | 6028.8 samples/s | 94.2 steps/s
[Step=20750 Epoch=198.1] | Loss=0.00072 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.525 | L2-Norm(final)=13.036 | 2418.0 samples/s | 37.8 steps/s
[Step=20800 Epoch=198.6] | Loss=0.00060 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.520 | L2-Norm(final)=13.037 | 5707.2 samples/s | 89.2 steps/s
[Step=20850 Epoch=199.1] | Loss=0.00052 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.514 | L2-Norm(final)=13.037 | 2557.8 samples/s | 40.0 steps/s
[Step=20900 Epoch=199.6] | Loss=0.00045 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=13.037 | 5220.3 samples/s | 81.6 steps/s
[Step=20950 Epoch=200.1] | Loss=0.00040 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.499 | L2-Norm(final)=13.038 | 2609.4 samples/s | 40.8 steps/s
[Step=21000 Epoch=200.5] | Loss=0.00036 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=13.038 | 4925.7 samples/s | 77.0 steps/s
[Step=21050 Epoch=201.0] | Loss=0.00033 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.483 | L2-Norm(final)=13.038 | 2748.8 samples/s | 43.0 steps/s
[Step=21100 Epoch=201.5] | Loss=0.00030 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.474 | L2-Norm(final)=13.039 | 4562.6 samples/s | 71.3 steps/s
[Step=21150 Epoch=202.0] | Loss=0.00028 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.466 | L2-Norm(final)=13.039 | 2827.9 samples/s | 44.2 steps/s
[Step=21200 Epoch=202.4] | Loss=0.00026 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.457 | L2-Norm(final)=13.039 | 4627.4 samples/s | 72.3 steps/s
[Step=21250 Epoch=202.9] | Loss=0.00024 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.448 | L2-Norm(final)=13.040 | 2905.7 samples/s | 45.4 steps/s
[Step=21300 Epoch=203.4] | Loss=0.00023 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.440 | L2-Norm(final)=13.040 | 4354.3 samples/s | 68.0 steps/s
[Step=21350 Epoch=203.9] | Loss=0.00022 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.431 | L2-Norm(final)=13.040 | 2874.3 samples/s | 44.9 steps/s
[Step=21400 Epoch=204.4] | Loss=0.00020 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.422 | L2-Norm(final)=13.041 | 4467.4 samples/s | 69.8 steps/s
[Step=21450 Epoch=204.8] | Loss=0.00019 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=13.041 | 2843.3 samples/s | 44.4 steps/s
[Step=21500 Epoch=205.3] | Loss=0.00018 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.404 | L2-Norm(final)=13.041 | 4676.1 samples/s | 73.1 steps/s
[Step=21550 Epoch=205.8] | Loss=0.00017 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.395 | L2-Norm(final)=13.041 | 7011.3 samples/s | 109.6 steps/s
[Step=21600 Epoch=206.3] | Loss=0.00017 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.386 | L2-Norm(final)=13.042 | 2291.2 samples/s | 35.8 steps/s
[Step=21650 Epoch=206.7] | Loss=0.00016 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.377 | L2-Norm(final)=13.042 | 6569.8 samples/s | 102.7 steps/s
[Step=21700 Epoch=207.2] | Loss=0.00015 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.368 | L2-Norm(final)=13.042 | 2405.5 samples/s | 37.6 steps/s
[Step=21750 Epoch=207.7] | Loss=0.00015 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.359 | L2-Norm(final)=13.043 | 6009.2 samples/s | 93.9 steps/s
[Step=21800 Epoch=208.2] | Loss=0.00014 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.350 | L2-Norm(final)=13.043 | 2455.6 samples/s | 38.4 steps/s
[Step=21850 Epoch=208.7] | Loss=0.00014 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=13.043 | 5675.4 samples/s | 88.7 steps/s
[Step=21900 Epoch=209.1] | Loss=0.00013 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.332 | L2-Norm(final)=13.043 | 2522.7 samples/s | 39.4 steps/s
[Step=21950 Epoch=209.6] | Loss=0.00013 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.323 | L2-Norm(final)=13.044 | 5305.3 samples/s | 82.9 steps/s
[Step=22000 Epoch=210.1] | Loss=0.00012 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.314 | L2-Norm(final)=13.044 | 2627.2 samples/s | 41.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step22000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=226.2] | Loss=0.00013 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=14.332 | 6282.9 samples/s | 98.2 steps/s
[Step=24050 Epoch=226.6] | Loss=0.00304 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.352 | 4658.8 samples/s | 72.8 steps/s
[Step=24100 Epoch=227.1] | Loss=0.00301 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.372 | 8229.5 samples/s | 128.6 steps/s
[Step=24150 Epoch=227.6] | Loss=0.00271 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.390 | 2603.0 samples/s | 40.7 steps/s
[Step=24200 Epoch=228.0] | Loss=0.00254 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.408 | 6943.1 samples/s | 108.5 steps/s
[Step=24250 Epoch=228.5] | Loss=0.00277 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.424 | 2749.4 samples/s | 43.0 steps/s
[Step=24300 Epoch=229.0] | Loss=0.00283 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.440 | 6020.8 samples/s | 94.1 steps/s
[Step=24350 Epoch=229.4] | Loss=0.00271 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.455 | 2899.7 samples/s | 45.3 steps/s
[Step=24400 Epoch=229.9] | Loss=0.00268 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.468 | 5443.3 samples/s | 85.1 steps/s
[Step=24450 Epoch=230.4] | Loss=0.00275 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.482 | 3040.5 samples/s | 47.5 steps/s
[Step=24500 Epoch=230.9] | Loss=0.00266 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.495 | 5392.1 samples/s | 84.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=230.9] | Loss=0.00019 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.628 | 6908.7 samples/s | 107.9 steps/s
[Step=24550 Epoch=231.3] | Loss=0.00290 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.465 | L2-Norm(final)=14.631 | 4084.3 samples/s | 63.8 steps/s
[Step=24600 Epoch=231.8] | Loss=0.00263 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.509 | L2-Norm(final)=14.628 | 6522.6 samples/s | 101.9 steps/s
[Step=24650 Epoch=232.3] | Loss=0.00178 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.528 | L2-Norm(final)=14.629 | 2413.4 samples/s | 37.7 steps/s
[Step=24700 Epoch=232.7] | Loss=0.00134 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.532 | L2-Norm(final)=14.630 | 5836.3 samples/s | 91.2 steps/s
[Step=24750 Epoch=233.2] | Loss=0.00107 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.531 | L2-Norm(final)=14.631 | 2542.3 samples/s | 39.7 steps/s
[Step=24800 Epoch=233.7] | Loss=0.00090 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.528 | L2-Norm(final)=14.632 | 5164.1 samples/s | 80.7 steps/s
[Step=24850 Epoch=234.2] | Loss=0.00077 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.522 | L2-Norm(final)=14.632 | 2603.9 samples/s | 40.7 steps/s
[Step=24900 Epoch=234.6] | Loss=0.00068 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.516 | L2-Norm(final)=14.633 | 4782.9 samples/s | 74.7 steps/s
[Step=24950 Epoch=235.1] | Loss=0.00060 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.510 | L2-Norm(final)=14.634 | 2771.1 samples/s | 43.3 steps/s
[Step=25000 Epoch=235.6] | Loss=0.00054 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=14.634 | 4551.0 samples/s | 71.1 steps/s
[Step=25050 Epoch=236.0] | Loss=0.00049 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.495 | L2-Norm(final)=14.635 | 2886.7 samples/s | 45.1 steps/s
[Step=25100 Epoch=236.5] | Loss=0.00045 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.488 | L2-Norm(final)=14.635 | 4516.1 samples/s | 70.6 steps/s
[Step=25150 Epoch=237.0] | Loss=0.00042 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.480 | L2-Norm(final)=14.636 | 2865.4 samples/s | 44.8 steps/s
[Step=25200 Epoch=237.5] | Loss=0.00039 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.473 | L2-Norm(final)=14.636 | 4507.9 samples/s | 70.4 steps/s
[Step=25250 Epoch=237.9] | Loss=0.00036 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.465 | L2-Norm(final)=14.637 | 3164.7 samples/s | 49.4 steps/s
[Step=25300 Epoch=238.4] | Loss=0.00034 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.457 | L2-Norm(final)=14.637 | 4136.2 samples/s | 64.6 steps/s
[Step=25350 Epoch=238.9] | Loss=0.00032 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=14.638 | 6675.2 samples/s | 104.3 steps/s
[Step=25400 Epoch=239.3] | Loss=0.00030 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.442 | L2-Norm(final)=14.638 | 2396.0 samples/s | 37.4 steps/s
[Step=25450 Epoch=239.8] | Loss=0.00029 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.434 | L2-Norm(final)=14.639 | 5898.0 samples/s | 92.2 steps/s
[Step=25500 Epoch=240.3] | Loss=0.00027 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.426 | L2-Norm(final)=14.639 | 2499.5 samples/s | 39.1 steps/s
[Step=25550 Epoch=240.8] | Loss=0.00026 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.418 | L2-Norm(final)=14.639 | 5271.2 samples/s | 82.4 steps/s
[Step=25600 Epoch=241.2] | Loss=0.00025 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.410 | L2-Norm(final)=14.640 | 2630.1 samples/s | 41.1 steps/s
[Step=25650 Epoch=241.7] | Loss=0.00024 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.402 | L2-Norm(final)=14.640 | 4823.3 samples/s | 75.4 steps/s
[Step=25700 Epoch=242.2] | Loss=0.00023 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.394 | L2-Norm(final)=14.641 | 2765.5 samples/s | 43.2 steps/s
[Step=25750 Epoch=242.6] | Loss=0.00022 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.385 | L2-Norm(final)=14.641 | 4502.1 samples/s | 70.3 steps/s
[Step=25800 Epoch=243.1] | Loss=0.00021 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.377 | L2-Norm(final)=14.641 | 2888.3 samples/s | 45.1 steps/s
[Step=25850 Epoch=243.6] | Loss=0.00020 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=14.642 | 4426.5 samples/s | 69.2 steps/s
[Step=25900 Epoch=244.1] | Loss=0.00020 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.361 | L2-Norm(final)=14.642 | 2910.6 samples/s | 45.5 steps/s
[Step=25950 Epoch=244.5] | Loss=0.00019 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=14.643 | 4543.6 samples/s | 71.0 steps/s
[Step=26000 Epoch=245.0] | Loss=0.00018 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.344 | L2-Norm(final)=14.643 | 2948.3 samples/s | 46.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step26000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=228.8] | Loss=0.00110 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=14.243 | 7140.1 samples/s | 111.6 steps/s
[Step=24050 Epoch=229.2] | Loss=0.00254 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=14.256 | 4454.3 samples/s | 69.6 steps/s
[Step=24100 Epoch=229.7] | Loss=0.00222 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.276 | 8360.1 samples/s | 130.6 steps/s
[Step=24150 Epoch=230.2] | Loss=0.00229 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.293 | 2588.4 samples/s | 40.4 steps/s
[Step=24200 Epoch=230.6] | Loss=0.00223 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.311 | 7380.2 samples/s | 115.3 steps/s
[Step=24250 Epoch=231.1] | Loss=0.00219 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.328 | 2649.6 samples/s | 41.4 steps/s
[Step=24300 Epoch=231.6] | Loss=0.00215 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.344 | 6777.8 samples/s | 105.9 steps/s
[Step=24350 Epoch=232.1] | Loss=0.00210 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.359 | 2740.9 samples/s | 42.8 steps/s
[Step=24400 Epoch=232.6] | Loss=0.00215 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.375 | 6205.6 samples/s | 97.0 steps/s
[Step=24450 Epoch=233.0] | Loss=0.00218 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.390 | 2850.0 samples/s | 44.5 steps/s
[Step=24500 Epoch=233.5] | Loss=0.00211 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.424 | L2-Norm(final)=14.406 | 5790.9 samples/s | 90.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=233.5] | Loss=0.00228 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.555 | 6938.4 samples/s | 108.4 steps/s
[Step=24550 Epoch=234.0] | Loss=0.00132 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.462 | L2-Norm(final)=14.562 | 3988.3 samples/s | 62.3 steps/s
[Step=24600 Epoch=234.5] | Loss=0.00074 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.481 | L2-Norm(final)=14.567 | 6702.4 samples/s | 104.7 steps/s
[Step=24650 Epoch=234.9] | Loss=0.00050 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.482 | L2-Norm(final)=14.569 | 2371.1 samples/s | 37.0 steps/s
[Step=24700 Epoch=235.4] | Loss=0.00038 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=14.571 | 6183.1 samples/s | 96.6 steps/s
[Step=24750 Epoch=235.9] | Loss=0.00031 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.468 | L2-Norm(final)=14.572 | 2445.2 samples/s | 38.2 steps/s
[Step=24800 Epoch=236.4] | Loss=0.00026 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.458 | L2-Norm(final)=14.573 | 5691.7 samples/s | 88.9 steps/s
[Step=24850 Epoch=236.8] | Loss=0.00022 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=14.574 | 2521.7 samples/s | 39.4 steps/s
[Step=24900 Epoch=237.3] | Loss=0.00019 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.439 | L2-Norm(final)=14.574 | 5281.0 samples/s | 82.5 steps/s
[Step=24950 Epoch=237.8] | Loss=0.00017 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=14.575 | 2614.2 samples/s | 40.8 steps/s
[Step=25000 Epoch=238.3] | Loss=0.00016 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.419 | L2-Norm(final)=14.575 | 4922.8 samples/s | 76.9 steps/s
[Step=25050 Epoch=238.7] | Loss=0.00014 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.409 | L2-Norm(final)=14.576 | 2704.8 samples/s | 42.3 steps/s
[Step=25100 Epoch=239.2] | Loss=0.00013 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.399 | L2-Norm(final)=14.577 | 4651.6 samples/s | 72.7 steps/s
[Step=25150 Epoch=239.7] | Loss=0.00012 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.389 | L2-Norm(final)=14.577 | 2818.3 samples/s | 44.0 steps/s
[Step=25200 Epoch=240.2] | Loss=0.00011 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.379 | L2-Norm(final)=14.578 | 4541.7 samples/s | 71.0 steps/s
[Step=25250 Epoch=240.7] | Loss=0.00011 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=14.579 | 2845.0 samples/s | 44.5 steps/s
[Step=25300 Epoch=241.1] | Loss=0.00010 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.359 | L2-Norm(final)=14.579 | 4558.1 samples/s | 71.2 steps/s
[Step=25350 Epoch=241.6] | Loss=0.00009 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=14.580 | 2843.2 samples/s | 44.4 steps/s
[Step=25400 Epoch=242.1] | Loss=0.00009 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.339 | L2-Norm(final)=14.580 | 4568.4 samples/s | 71.4 steps/s
[Step=25450 Epoch=242.6] | Loss=0.00008 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.329 | L2-Norm(final)=14.581 | 2836.2 samples/s | 44.3 steps/s
[Step=25500 Epoch=243.0] | Loss=0.00008 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.319 | L2-Norm(final)=14.582 | 4544.9 samples/s | 71.0 steps/s
[Step=25550 Epoch=243.5] | Loss=0.00008 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.309 | L2-Norm(final)=14.582 | 7302.1 samples/s | 114.1 steps/s
[Step=25600 Epoch=244.0] | Loss=0.00007 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.299 | L2-Norm(final)=14.583 | 2296.8 samples/s | 35.9 steps/s
[Step=25650 Epoch=244.5] | Loss=0.00007 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.289 | L2-Norm(final)=14.584 | 6667.3 samples/s | 104.2 steps/s
[Step=25700 Epoch=244.9] | Loss=0.00007 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.279 | L2-Norm(final)=14.584 | 2368.6 samples/s | 37.0 steps/s
[Step=25750 Epoch=245.4] | Loss=0.00007 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.269 | L2-Norm(final)=14.585 | 5992.1 samples/s | 93.6 steps/s
[Step=25800 Epoch=245.9] | Loss=0.00006 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.259 | L2-Norm(final)=14.586 | 2460.5 samples/s | 38.4 steps/s
[Step=25850 Epoch=246.4] | Loss=0.00006 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.249 | L2-Norm(final)=14.586 | 5701.3 samples/s | 89.1 steps/s
[Step=25900 Epoch=246.9] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.239 | L2-Norm(final)=14.587 | 2523.5 samples/s | 39.4 steps/s
[Step=25950 Epoch=247.3] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.229 | L2-Norm(final)=14.588 | 5300.3 samples/s | 82.8 steps/s
[Step=26000 Epoch=247.8] | Loss=0.00005 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.219 | L2-Norm(final)=14.588 | 2648.0 samples/s | 41.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step26000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09086 | acc=0.9605 | tpr=0.9675 | fpr=0.0548 | 5868.2 samples/s | 22.9 steps/s
Avg test loss: 0.10147, Avg test acc: 0.95621, Avg tpr: 0.96316, Avg fpr: 0.05909, total FA: 461

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10313 | acc=0.9586 | tpr=0.9777 | fpr=0.0830 | 5942.1 samples/s | 23.2 steps/s
Avg test loss: 0.10586, Avg test acc: 0.95773, Avg tpr: 0.97616, Avg fpr: 0.08281, total FA: 646

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09950 | acc=0.9584 | tpr=0.9724 | fpr=0.0719 | 5912.1 samples/s | 23.1 steps/s
Avg test loss: 0.10064, Avg test acc: 0.95621, Avg tpr: 0.96940, Avg fpr: 0.07281, total FA: 568

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09808 | acc=0.9580 | tpr=0.9767 | fpr=0.0825 | 5662.1 samples/s | 22.1 steps/s
Avg test loss: 0.10399, Avg test acc: 0.95649, Avg tpr: 0.97570, Avg fpr: 0.08576, total FA: 669

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11715 | acc=0.9537 | tpr=0.9617 | fpr=0.0634 | 5824.1 samples/s | 22.8 steps/s
Avg test loss: 0.12395, Avg test acc: 0.95228, Avg tpr: 0.95920, Avg fpr: 0.06294, total FA: 491

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.50056 | acc=0.2737 | tpr=0.0181 | fpr=0.1712 | 5983.1 samples/s | 23.4 steps/s
Avg test loss: 6.51569, Avg test acc: 0.27294, Avg tpr: 0.01731, Avg fpr: 0.16485, total FA: 1286

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.86704 | acc=0.3123 | tpr=0.0226 | fpr=0.0587 | 6015.2 samples/s | 23.5 steps/s
Avg test loss: 4.87636, Avg test acc: 0.31040, Avg tpr: 0.02256, Avg fpr: 0.05653, total FA: 441

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.10158 | acc=0.2972 | tpr=0.0127 | fpr=0.0850 | 6018.5 samples/s | 23.5 steps/s
Avg test loss: 5.10930, Avg test acc: 0.29417, Avg tpr: 0.01212, Avg fpr: 0.08550, total FA: 667

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.35029 | acc=0.2791 | tpr=0.0256 | fpr=0.1702 | 6022.8 samples/s | 23.5 steps/s
Avg test loss: 5.35228, Avg test acc: 0.27823, Avg tpr: 0.02500, Avg fpr: 0.16485, total FA: 1286

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.26252 | acc=0.2991 | tpr=0.0159 | fpr=0.0857 | 5964.2 samples/s | 23.3 steps/s
Avg test loss: 5.26980, Avg test acc: 0.29702, Avg tpr: 0.01475, Avg fpr: 0.08217, total FA: 641

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.92569 | acc=0.1481 | tpr=0.5841 | fpr=0.8597 | 5984.4 samples/s | 23.4 steps/s
[Step= 100] | Loss=4.91399 | acc=0.1524 | tpr=0.5714 | fpr=0.8554 | 8538.9 samples/s | 33.4 steps/s
[Step= 150] | Loss=4.90988 | acc=0.1540 | tpr=0.5965 | fpr=0.8541 | 8006.1 samples/s | 31.3 steps/s
[Step= 200] | Loss=4.90137 | acc=0.1544 | tpr=0.5836 | fpr=0.8534 | 7970.1 samples/s | 31.1 steps/s
[Step= 250] | Loss=4.90572 | acc=0.1537 | tpr=0.5799 | fpr=0.8541 | 7544.5 samples/s | 29.5 steps/s
[Step= 300] | Loss=4.89934 | acc=0.1535 | tpr=0.5724 | fpr=0.8541 | 8133.1 samples/s | 31.8 steps/s
[Step= 350] | Loss=4.90380 | acc=0.1530 | tpr=0.5686 | fpr=0.8546 | 7967.4 samples/s | 31.1 steps/s
[Step= 400] | Loss=4.90033 | acc=0.1538 | tpr=0.5667 | fpr=0.8537 | 8134.9 samples/s | 31.8 steps/s
[Step= 450] | Loss=4.90397 | acc=0.1535 | tpr=0.5725 | fpr=0.8541 | 8142.3 samples/s | 31.8 steps/s
[Step= 500] | Loss=4.90392 | acc=0.1536 | tpr=0.5762 | fpr=0.8541 | 8275.4 samples/s | 32.3 steps/s
[Step= 550] | Loss=4.90680 | acc=0.1536 | tpr=0.5774 | fpr=0.8541 | 9465.8 samples/s | 37.0 steps/s
Avg test loss: 4.90742, Avg test acc: 0.15350, Avg tpr: 0.57805, Avg fpr: 0.85422, total FA: 118607

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.26894 | acc=0.1295 | tpr=0.6770 | fpr=0.8804 | 5991.0 samples/s | 23.4 steps/s
[Step= 100] | Loss=5.24619 | acc=0.1329 | tpr=0.6780 | fpr=0.8772 | 7511.1 samples/s | 29.3 steps/s
[Step= 150] | Loss=5.24384 | acc=0.1343 | tpr=0.6916 | fpr=0.8759 | 7876.7 samples/s | 30.8 steps/s
[Step= 200] | Loss=5.23907 | acc=0.1342 | tpr=0.6852 | fpr=0.8759 | 8642.8 samples/s | 33.8 steps/s
[Step= 250] | Loss=5.24345 | acc=0.1342 | tpr=0.6803 | fpr=0.8758 | 8462.2 samples/s | 33.1 steps/s
[Step= 300] | Loss=5.23932 | acc=0.1338 | tpr=0.6742 | fpr=0.8760 | 7945.6 samples/s | 31.0 steps/s
[Step= 350] | Loss=5.24712 | acc=0.1337 | tpr=0.6675 | fpr=0.8760 | 7733.7 samples/s | 30.2 steps/s
[Step= 400] | Loss=5.24619 | acc=0.1338 | tpr=0.6674 | fpr=0.8759 | 8073.7 samples/s | 31.5 steps/s
[Step= 450] | Loss=5.24948 | acc=0.1333 | tpr=0.6704 | fpr=0.8765 | 7938.9 samples/s | 31.0 steps/s
[Step= 500] | Loss=5.25040 | acc=0.1330 | tpr=0.6722 | fpr=0.8768 | 7962.5 samples/s | 31.1 steps/s
[Step= 550] | Loss=5.25397 | acc=0.1333 | tpr=0.6733 | fpr=0.8766 | 10275.7 samples/s | 40.1 steps/s
Avg test loss: 5.25439, Avg test acc: 0.13315, Avg tpr: 0.67353, Avg fpr: 0.87667, total FA: 121724

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.08758 | acc=0.1251 | tpr=0.6504 | fpr=0.8844 | 5869.9 samples/s | 22.9 steps/s
[Step= 100] | Loss=5.06812 | acc=0.1267 | tpr=0.6525 | fpr=0.8831 | 8041.9 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.06240 | acc=0.1283 | tpr=0.6527 | fpr=0.8813 | 7561.6 samples/s | 29.5 steps/s
[Step= 200] | Loss=5.05963 | acc=0.1282 | tpr=0.6437 | fpr=0.8811 | 8040.5 samples/s | 31.4 steps/s
[Step= 250] | Loss=5.06275 | acc=0.1284 | tpr=0.6410 | fpr=0.8809 | 7940.7 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.05872 | acc=0.1283 | tpr=0.6364 | fpr=0.8810 | 8527.2 samples/s | 33.3 steps/s
[Step= 350] | Loss=5.06546 | acc=0.1281 | tpr=0.6374 | fpr=0.8811 | 7650.7 samples/s | 29.9 steps/s
[Step= 400] | Loss=5.06387 | acc=0.1283 | tpr=0.6362 | fpr=0.8810 | 7713.7 samples/s | 30.1 steps/s
[Step= 450] | Loss=5.06840 | acc=0.1277 | tpr=0.6407 | fpr=0.8816 | 8074.6 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.06732 | acc=0.1279 | tpr=0.6427 | fpr=0.8814 | 8195.7 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.07066 | acc=0.1279 | tpr=0.6411 | fpr=0.8815 | 11617.7 samples/s | 45.4 steps/s
Avg test loss: 5.07108, Avg test acc: 0.12778, Avg tpr: 0.64263, Avg fpr: 0.88158, total FA: 122406

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.51370 | acc=0.1231 | tpr=0.7124 | fpr=0.8875 | 6100.4 samples/s | 23.8 steps/s
[Step= 100] | Loss=5.49380 | acc=0.1254 | tpr=0.6844 | fpr=0.8851 | 7727.5 samples/s | 30.2 steps/s
[Step= 150] | Loss=5.48351 | acc=0.1268 | tpr=0.6945 | fpr=0.8837 | 7687.6 samples/s | 30.0 steps/s
[Step= 200] | Loss=5.47890 | acc=0.1270 | tpr=0.6918 | fpr=0.8833 | 7864.8 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.48056 | acc=0.1270 | tpr=0.6926 | fpr=0.8833 | 7634.9 samples/s | 29.8 steps/s
[Step= 300] | Loss=5.47693 | acc=0.1269 | tpr=0.6924 | fpr=0.8834 | 8383.1 samples/s | 32.7 steps/s
[Step= 350] | Loss=5.48134 | acc=0.1266 | tpr=0.6957 | fpr=0.8837 | 7848.8 samples/s | 30.7 steps/s
[Step= 400] | Loss=5.47927 | acc=0.1268 | tpr=0.6942 | fpr=0.8835 | 7238.4 samples/s | 28.3 steps/s
[Step= 450] | Loss=5.48405 | acc=0.1261 | tpr=0.6972 | fpr=0.8843 | 8303.7 samples/s | 32.4 steps/s
[Step= 500] | Loss=5.48288 | acc=0.1261 | tpr=0.6991 | fpr=0.8842 | 7894.8 samples/s | 30.8 steps/s
[Step= 550] | Loss=5.48948 | acc=0.1262 | tpr=0.6988 | fpr=0.8842 | 9538.5 samples/s | 37.3 steps/s
Avg test loss: 5.49069, Avg test acc: 0.12609, Avg tpr: 0.69929, Avg fpr: 0.88433, total FA: 122787

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.29585 | acc=0.1362 | tpr=0.5708 | fpr=0.8716 | 6105.7 samples/s | 23.9 steps/s
[Step= 100] | Loss=5.28207 | acc=0.1372 | tpr=0.5736 | fpr=0.8709 | 7874.1 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.26660 | acc=0.1386 | tpr=0.5749 | fpr=0.8694 | 7470.8 samples/s | 29.2 steps/s
[Step= 200] | Loss=5.26796 | acc=0.1395 | tpr=0.5738 | fpr=0.8684 | 7859.5 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.26797 | acc=0.1391 | tpr=0.5677 | fpr=0.8687 | 7867.4 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.26171 | acc=0.1395 | tpr=0.5724 | fpr=0.8684 | 7602.7 samples/s | 29.7 steps/s
[Step= 350] | Loss=5.27088 | acc=0.1393 | tpr=0.5654 | fpr=0.8684 | 8225.5 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.26640 | acc=0.1396 | tpr=0.5629 | fpr=0.8681 | 8190.2 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.27195 | acc=0.1388 | tpr=0.5682 | fpr=0.8689 | 8129.9 samples/s | 31.8 steps/s
[Step= 500] | Loss=5.27133 | acc=0.1389 | tpr=0.5714 | fpr=0.8689 | 8130.8 samples/s | 31.8 steps/s
[Step= 550] | Loss=5.27311 | acc=0.1389 | tpr=0.5726 | fpr=0.8689 | 10970.5 samples/s | 42.9 steps/s
Avg test loss: 5.27459, Avg test acc: 0.13887, Avg tpr: 0.57369, Avg fpr: 0.86904, total FA: 120664

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.22476 | acc=0.9596 | tpr=0.9292 | fpr=0.0398 | 6149.7 samples/s | 24.0 steps/s
[Step= 100] | Loss=0.23351 | acc=0.9579 | tpr=0.9446 | fpr=0.0419 | 7686.6 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.23549 | acc=0.9565 | tpr=0.9467 | fpr=0.0433 | 8024.5 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.23540 | acc=0.9566 | tpr=0.9497 | fpr=0.0433 | 7852.9 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.23536 | acc=0.9566 | tpr=0.9476 | fpr=0.0432 | 7905.6 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.23859 | acc=0.9563 | tpr=0.9440 | fpr=0.0435 | 8264.2 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.23654 | acc=0.9565 | tpr=0.9443 | fpr=0.0433 | 8099.8 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.23651 | acc=0.9561 | tpr=0.9426 | fpr=0.0437 | 7806.9 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.24055 | acc=0.9556 | tpr=0.9401 | fpr=0.0441 | 8236.1 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.24037 | acc=0.9554 | tpr=0.9423 | fpr=0.0444 | 8140.5 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.23882 | acc=0.9557 | tpr=0.9419 | fpr=0.0440 | 10428.6 samples/s | 40.7 steps/s
Avg test loss: 0.23837, Avg test acc: 0.95573, Avg tpr: 0.94176, Avg fpr: 0.04402, total FA: 6112

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16689 | acc=0.9598 | tpr=0.9027 | fpr=0.0392 | 5683.8 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.17173 | acc=0.9585 | tpr=0.9318 | fpr=0.0410 | 8761.5 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.17376 | acc=0.9573 | tpr=0.9366 | fpr=0.0423 | 7967.2 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.17493 | acc=0.9572 | tpr=0.9410 | fpr=0.0425 | 8145.3 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.17424 | acc=0.9573 | tpr=0.9362 | fpr=0.0424 | 7405.6 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.17571 | acc=0.9569 | tpr=0.9360 | fpr=0.0427 | 7771.3 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.17429 | acc=0.9571 | tpr=0.9374 | fpr=0.0425 | 8445.5 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.17386 | acc=0.9570 | tpr=0.9333 | fpr=0.0426 | 8067.0 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.17652 | acc=0.9565 | tpr=0.9309 | fpr=0.0430 | 7558.7 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.17638 | acc=0.9563 | tpr=0.9300 | fpr=0.0432 | 8310.3 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.17526 | acc=0.9565 | tpr=0.9276 | fpr=0.0430 | 10703.9 samples/s | 41.8 steps/s
Avg test loss: 0.17490, Avg test acc: 0.95653, Avg tpr: 0.92750, Avg fpr: 0.04295, total FA: 5963

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.29478 | acc=0.9483 | tpr=0.9248 | fpr=0.0513 | 5957.3 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.30079 | acc=0.9474 | tpr=0.9403 | fpr=0.0524 | 7793.6 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.30757 | acc=0.9460 | tpr=0.9409 | fpr=0.0539 | 7570.9 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.30717 | acc=0.9464 | tpr=0.9475 | fpr=0.0537 | 8195.0 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.30746 | acc=0.9460 | tpr=0.9450 | fpr=0.0539 | 8070.6 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.31045 | acc=0.9457 | tpr=0.9396 | fpr=0.0541 | 8400.4 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.30746 | acc=0.9458 | tpr=0.9411 | fpr=0.0541 | 7924.7 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.30780 | acc=0.9455 | tpr=0.9387 | fpr=0.0544 | 7503.2 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.31202 | acc=0.9451 | tpr=0.9352 | fpr=0.0547 | 8734.7 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.31265 | acc=0.9450 | tpr=0.9366 | fpr=0.0548 | 8097.4 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.31046 | acc=0.9453 | tpr=0.9359 | fpr=0.0546 | 10257.9 samples/s | 40.1 steps/s
Avg test loss: 0.31016, Avg test acc: 0.94527, Avg tpr: 0.93542, Avg fpr: 0.05455, total FA: 7574

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.16502 | acc=0.9603 | tpr=0.9159 | fpr=0.0389 | 5869.6 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.17080 | acc=0.9595 | tpr=0.9254 | fpr=0.0399 | 7785.5 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.17070 | acc=0.9585 | tpr=0.9251 | fpr=0.0409 | 8162.1 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.17014 | acc=0.9587 | tpr=0.9333 | fpr=0.0409 | 7903.0 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.17032 | acc=0.9587 | tpr=0.9284 | fpr=0.0407 | 7797.5 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.17288 | acc=0.9585 | tpr=0.9280 | fpr=0.0410 | 7631.9 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.17166 | acc=0.9587 | tpr=0.9274 | fpr=0.0408 | 7706.8 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.17136 | acc=0.9585 | tpr=0.9256 | fpr=0.0409 | 8130.3 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.17404 | acc=0.9581 | tpr=0.9236 | fpr=0.0413 | 8292.2 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.17395 | acc=0.9581 | tpr=0.9247 | fpr=0.0413 | 7879.2 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.17282 | acc=0.9583 | tpr=0.9268 | fpr=0.0411 | 12147.8 samples/s | 47.5 steps/s
Avg test loss: 0.17250, Avg test acc: 0.95833, Avg tpr: 0.92670, Avg fpr: 0.04110, total FA: 5706

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.23264 | acc=0.9564 | tpr=0.8982 | fpr=0.0425 | 5926.5 samples/s | 23.2 steps/s
[Step= 100] | Loss=0.24146 | acc=0.9552 | tpr=0.9254 | fpr=0.0442 | 7932.4 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.24465 | acc=0.9538 | tpr=0.9352 | fpr=0.0459 | 7296.0 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.24514 | acc=0.9538 | tpr=0.9399 | fpr=0.0459 | 8139.6 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.24629 | acc=0.9538 | tpr=0.9415 | fpr=0.0460 | 8503.9 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.25009 | acc=0.9532 | tpr=0.9411 | fpr=0.0465 | 8147.0 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.24850 | acc=0.9532 | tpr=0.9411 | fpr=0.0466 | 7828.9 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.24873 | acc=0.9528 | tpr=0.9376 | fpr=0.0469 | 7806.9 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.25250 | acc=0.9524 | tpr=0.9377 | fpr=0.0473 | 7971.0 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.25284 | acc=0.9523 | tpr=0.9370 | fpr=0.0475 | 8014.8 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.25106 | acc=0.9526 | tpr=0.9383 | fpr=0.0471 | 11555.8 samples/s | 45.1 steps/s
Avg test loss: 0.25071, Avg test acc: 0.95264, Avg tpr: 0.93819, Avg fpr: 0.04709, total FA: 6539

server round 23/50

clients selected: [2 4 5 6 8]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.09024 | Reg=0.00129 | acc=0.9531 | L2-Norm=11.358 | L2-Norm(final)=11.546 | 7415.9 samples/s | 115.9 steps/s
[Step=20050 Epoch=97.7] | Loss=0.03465 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.358 | L2-Norm(final)=11.551 | 4841.6 samples/s | 75.7 steps/s
[Step=20100 Epoch=97.9] | Loss=0.03075 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.358 | L2-Norm(final)=11.556 | 5567.0 samples/s | 87.0 steps/s
[Step=20150 Epoch=98.2] | Loss=0.03042 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=11.565 | 5505.2 samples/s | 86.0 steps/s
[Step=20200 Epoch=98.4] | Loss=0.03042 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.358 | L2-Norm(final)=11.573 | 8408.8 samples/s | 131.4 steps/s
[Step=20250 Epoch=98.7] | Loss=0.03005 | Reg=0.00129 | acc=0.9531 | L2-Norm=11.358 | L2-Norm(final)=11.581 | 2732.2 samples/s | 42.7 steps/s
[Step=20300 Epoch=98.9] | Loss=0.03004 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.358 | L2-Norm(final)=11.589 | 5334.2 samples/s | 83.3 steps/s
[Step=20350 Epoch=99.2] | Loss=0.03070 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.358 | L2-Norm(final)=11.596 | 5534.4 samples/s | 86.5 steps/s
[Step=20400 Epoch=99.4] | Loss=0.03023 | Reg=0.00129 | acc=0.9531 | L2-Norm=11.358 | L2-Norm(final)=11.602 | 7713.2 samples/s | 120.5 steps/s
[Step=20450 Epoch=99.6] | Loss=0.03041 | Reg=0.00129 | acc=0.9531 | L2-Norm=11.358 | L2-Norm(final)=11.608 | 2815.3 samples/s | 44.0 steps/s
[Step=20500 Epoch=99.9] | Loss=0.03017 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.358 | L2-Norm(final)=11.614 | 5361.3 samples/s | 83.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=99.9] | Loss=0.05822 | Reg=0.00129 | acc=0.9375 | L2-Norm=11.358 | L2-Norm(final)=11.677 | 7515.8 samples/s | 117.4 steps/s
[Step=20550 Epoch=100.1] | Loss=0.02916 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.395 | L2-Norm(final)=11.680 | 4173.3 samples/s | 65.2 steps/s
[Step=20600 Epoch=100.4] | Loss=0.02809 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.437 | L2-Norm(final)=11.678 | 4756.6 samples/s | 74.3 steps/s
[Step=20650 Epoch=100.6] | Loss=0.02822 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.469 | L2-Norm(final)=11.678 | 4723.9 samples/s | 73.8 steps/s
[Step=20700 Epoch=100.9] | Loss=0.02687 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.494 | L2-Norm(final)=11.679 | 6900.0 samples/s | 107.8 steps/s
[Step=20750 Epoch=101.1] | Loss=0.02402 | Reg=0.00133 | acc=0.9531 | L2-Norm=11.517 | L2-Norm(final)=11.681 | 2486.4 samples/s | 38.8 steps/s
[Step=20800 Epoch=101.3] | Loss=0.02133 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.535 | L2-Norm(final)=11.684 | 4782.8 samples/s | 74.7 steps/s
[Step=20850 Epoch=101.6] | Loss=0.01974 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.552 | L2-Norm(final)=11.688 | 4646.2 samples/s | 72.6 steps/s
[Step=20900 Epoch=101.8] | Loss=0.01886 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.565 | L2-Norm(final)=11.691 | 6232.3 samples/s | 97.4 steps/s
[Step=20950 Epoch=102.1] | Loss=0.01767 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.577 | L2-Norm(final)=11.694 | 2569.0 samples/s | 40.1 steps/s
[Step=21000 Epoch=102.3] | Loss=0.01667 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.588 | L2-Norm(final)=11.697 | 4821.7 samples/s | 75.3 steps/s
[Step=21050 Epoch=102.6] | Loss=0.01562 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.599 | L2-Norm(final)=11.700 | 4769.9 samples/s | 74.5 steps/s
[Step=21100 Epoch=102.8] | Loss=0.01493 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.608 | L2-Norm(final)=11.703 | 5597.9 samples/s | 87.5 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01417 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.616 | L2-Norm(final)=11.706 | 2680.9 samples/s | 41.9 steps/s
[Step=21200 Epoch=103.3] | Loss=0.01351 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.624 | L2-Norm(final)=11.709 | 4681.8 samples/s | 73.2 steps/s
[Step=21250 Epoch=103.5] | Loss=0.01297 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.631 | L2-Norm(final)=11.712 | 4799.7 samples/s | 75.0 steps/s
[Step=21300 Epoch=103.8] | Loss=0.01256 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.638 | L2-Norm(final)=11.715 | 5212.4 samples/s | 81.4 steps/s
[Step=21350 Epoch=104.0] | Loss=0.01206 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.644 | L2-Norm(final)=11.718 | 2749.1 samples/s | 43.0 steps/s
[Step=21400 Epoch=104.3] | Loss=0.01166 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.650 | L2-Norm(final)=11.721 | 4775.0 samples/s | 74.6 steps/s
[Step=21450 Epoch=104.5] | Loss=0.01118 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.655 | L2-Norm(final)=11.723 | 4802.6 samples/s | 75.0 steps/s
[Step=21500 Epoch=104.8] | Loss=0.01089 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.660 | L2-Norm(final)=11.726 | 4806.0 samples/s | 75.1 steps/s
[Step=21550 Epoch=105.0] | Loss=0.01068 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.665 | L2-Norm(final)=11.729 | 2897.8 samples/s | 45.3 steps/s
[Step=21600 Epoch=105.2] | Loss=0.01039 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.669 | L2-Norm(final)=11.731 | 4788.9 samples/s | 74.8 steps/s
[Step=21650 Epoch=105.5] | Loss=0.01010 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=11.733 | 4703.1 samples/s | 73.5 steps/s
[Step=21700 Epoch=105.7] | Loss=0.00984 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.678 | L2-Norm(final)=11.736 | 4805.7 samples/s | 75.1 steps/s
[Step=21750 Epoch=106.0] | Loss=0.00962 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.681 | L2-Norm(final)=11.738 | 2921.6 samples/s | 45.7 steps/s
[Step=21800 Epoch=106.2] | Loss=0.00941 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.685 | L2-Norm(final)=11.740 | 4754.7 samples/s | 74.3 steps/s
[Step=21850 Epoch=106.5] | Loss=0.00923 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.689 | L2-Norm(final)=11.743 | 4821.7 samples/s | 75.3 steps/s
[Step=21900 Epoch=106.7] | Loss=0.00897 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.692 | L2-Norm(final)=11.745 | 4744.4 samples/s | 74.1 steps/s
[Step=21950 Epoch=107.0] | Loss=0.00884 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.695 | L2-Norm(final)=11.747 | 2969.4 samples/s | 46.4 steps/s
[Step=22000 Epoch=107.2] | Loss=0.00869 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=11.749 | 4879.5 samples/s | 76.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step22000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=16001 Epoch=78.5] | Loss=0.02950 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.358 | L2-Norm(final)=12.921 | 6010.7 samples/s | 93.9 steps/s
[Step=16050 Epoch=78.7] | Loss=0.02846 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.358 | L2-Norm(final)=12.924 | 5329.6 samples/s | 83.3 steps/s
[Step=16100 Epoch=79.0] | Loss=0.02973 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.358 | L2-Norm(final)=12.927 | 5639.7 samples/s | 88.1 steps/s
[Step=16150 Epoch=79.2] | Loss=0.02756 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.358 | L2-Norm(final)=12.929 | 5530.9 samples/s | 86.4 steps/s
[Step=16200 Epoch=79.4] | Loss=0.02785 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=12.932 | 8642.8 samples/s | 135.0 steps/s
[Step=16250 Epoch=79.7] | Loss=0.02805 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.358 | L2-Norm(final)=12.935 | 2639.5 samples/s | 41.2 steps/s
[Step=16300 Epoch=79.9] | Loss=0.02814 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.358 | L2-Norm(final)=12.937 | 5520.8 samples/s | 86.3 steps/s
[Step=16350 Epoch=80.2] | Loss=0.02750 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.358 | L2-Norm(final)=12.939 | 5718.5 samples/s | 89.4 steps/s
[Step=16400 Epoch=80.4] | Loss=0.02765 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.358 | L2-Norm(final)=12.941 | 7921.7 samples/s | 123.8 steps/s
[Step=16450 Epoch=80.7] | Loss=0.02741 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.358 | L2-Norm(final)=12.944 | 2693.2 samples/s | 42.1 steps/s
[Step=16500 Epoch=80.9] | Loss=0.02737 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=12.946 | 5523.1 samples/s | 86.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=16501 Epoch=80.9] | Loss=0.08210 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.358 | L2-Norm(final)=12.967 | 6523.7 samples/s | 101.9 steps/s
[Step=16550 Epoch=81.2] | Loss=0.02673 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.395 | L2-Norm(final)=12.967 | 4471.7 samples/s | 69.9 steps/s
[Step=16600 Epoch=81.4] | Loss=0.02772 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.437 | L2-Norm(final)=12.967 | 4837.3 samples/s | 75.6 steps/s
[Step=16650 Epoch=81.6] | Loss=0.02707 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.471 | L2-Norm(final)=12.961 | 4672.0 samples/s | 73.0 steps/s
[Step=16700 Epoch=81.9] | Loss=0.02485 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.500 | L2-Norm(final)=12.960 | 7060.7 samples/s | 110.3 steps/s
[Step=16750 Epoch=82.1] | Loss=0.02154 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=12.963 | 2442.0 samples/s | 38.2 steps/s
[Step=16800 Epoch=82.4] | Loss=0.01898 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.544 | L2-Norm(final)=12.967 | 4730.4 samples/s | 73.9 steps/s
[Step=16850 Epoch=82.6] | Loss=0.01799 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.560 | L2-Norm(final)=12.971 | 4787.6 samples/s | 74.8 steps/s
[Step=16900 Epoch=82.9] | Loss=0.01679 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.574 | L2-Norm(final)=12.974 | 6601.8 samples/s | 103.2 steps/s
[Step=16950 Epoch=83.1] | Loss=0.01563 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.587 | L2-Norm(final)=12.977 | 2518.0 samples/s | 39.3 steps/s
[Step=17000 Epoch=83.4] | Loss=0.01456 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.599 | L2-Norm(final)=12.981 | 4699.8 samples/s | 73.4 steps/s
[Step=17050 Epoch=83.6] | Loss=0.01369 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.609 | L2-Norm(final)=12.985 | 4743.1 samples/s | 74.1 steps/s
[Step=17100 Epoch=83.9] | Loss=0.01298 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.619 | L2-Norm(final)=12.988 | 6186.5 samples/s | 96.7 steps/s
[Step=17150 Epoch=84.1] | Loss=0.01227 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.627 | L2-Norm(final)=12.992 | 2562.5 samples/s | 40.0 steps/s
[Step=17200 Epoch=84.3] | Loss=0.01165 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.635 | L2-Norm(final)=12.995 | 4853.0 samples/s | 75.8 steps/s
[Step=17250 Epoch=84.6] | Loss=0.01109 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.642 | L2-Norm(final)=12.998 | 4688.8 samples/s | 73.3 steps/s
[Step=17300 Epoch=84.8] | Loss=0.01073 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.648 | L2-Norm(final)=13.001 | 5837.8 samples/s | 91.2 steps/s
[Step=17350 Epoch=85.1] | Loss=0.01036 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=13.004 | 2627.1 samples/s | 41.0 steps/s
[Step=17400 Epoch=85.3] | Loss=0.00996 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.660 | L2-Norm(final)=13.007 | 4787.3 samples/s | 74.8 steps/s
[Step=17450 Epoch=85.6] | Loss=0.00960 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.665 | L2-Norm(final)=13.010 | 4824.8 samples/s | 75.4 steps/s
[Step=17500 Epoch=85.8] | Loss=0.00929 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.669 | L2-Norm(final)=13.012 | 5421.0 samples/s | 84.7 steps/s
[Step=17550 Epoch=86.1] | Loss=0.00898 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=13.015 | 2720.8 samples/s | 42.5 steps/s
[Step=17600 Epoch=86.3] | Loss=0.00867 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.678 | L2-Norm(final)=13.018 | 4688.2 samples/s | 73.3 steps/s
[Step=17650 Epoch=86.6] | Loss=0.00843 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=13.021 | 4783.1 samples/s | 74.7 steps/s
[Step=17700 Epoch=86.8] | Loss=0.00827 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.685 | L2-Norm(final)=13.023 | 5209.0 samples/s | 81.4 steps/s
[Step=17750 Epoch=87.0] | Loss=0.00805 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.689 | L2-Norm(final)=13.026 | 2789.6 samples/s | 43.6 steps/s
[Step=17800 Epoch=87.3] | Loss=0.00782 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.692 | L2-Norm(final)=13.028 | 4737.6 samples/s | 74.0 steps/s
[Step=17850 Epoch=87.5] | Loss=0.00766 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.696 | L2-Norm(final)=13.030 | 4824.5 samples/s | 75.4 steps/s
[Step=17900 Epoch=87.8] | Loss=0.00748 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.699 | L2-Norm(final)=13.033 | 4953.4 samples/s | 77.4 steps/s
[Step=17950 Epoch=88.0] | Loss=0.00732 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.702 | L2-Norm(final)=13.035 | 2887.3 samples/s | 45.1 steps/s
[Step=18000 Epoch=88.3] | Loss=0.00714 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=13.038 | 4766.7 samples/s | 74.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step18000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=34001 Epoch=322.2] | Loss=0.00005 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=16.978 | 7278.0 samples/s | 113.7 steps/s
[Step=34050 Epoch=322.7] | Loss=0.00049 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=16.985 | 4595.9 samples/s | 71.8 steps/s
[Step=34100 Epoch=323.1] | Loss=0.00041 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=16.999 | 8216.7 samples/s | 128.4 steps/s
[Step=34150 Epoch=323.6] | Loss=0.00037 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=17.014 | 2571.9 samples/s | 40.2 steps/s
[Step=34200 Epoch=324.1] | Loss=0.00037 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=17.027 | 7244.9 samples/s | 113.2 steps/s
[Step=34250 Epoch=324.5] | Loss=0.00041 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=17.040 | 2690.6 samples/s | 42.0 steps/s
[Step=34300 Epoch=325.0] | Loss=0.00040 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=17.052 | 6428.6 samples/s | 100.4 steps/s
[Step=34350 Epoch=325.5] | Loss=0.00040 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=17.064 | 2792.0 samples/s | 43.6 steps/s
[Step=34400 Epoch=326.0] | Loss=0.00041 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=17.075 | 5928.3 samples/s | 92.6 steps/s
[Step=34450 Epoch=326.4] | Loss=0.00039 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=17.086 | 2924.6 samples/s | 45.7 steps/s
[Step=34500 Epoch=326.9] | Loss=0.00040 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=17.097 | 5413.7 samples/s | 84.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=34501 Epoch=326.9] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=17.205 | 7229.2 samples/s | 113.0 steps/s
[Step=34550 Epoch=327.4] | Loss=0.00011 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=17.215 | 3979.5 samples/s | 62.2 steps/s
[Step=34600 Epoch=327.9] | Loss=0.00026 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=17.218 | 6622.9 samples/s | 103.5 steps/s
[Step=34650 Epoch=328.3] | Loss=0.00020 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.333 | L2-Norm(final)=17.221 | 2402.2 samples/s | 37.5 steps/s
[Step=34700 Epoch=328.8] | Loss=0.00030 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.335 | L2-Norm(final)=17.224 | 5913.2 samples/s | 92.4 steps/s
[Step=34750 Epoch=329.3] | Loss=0.00082 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=17.225 | 2474.7 samples/s | 38.7 steps/s
[Step=34800 Epoch=329.8] | Loss=0.00078 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=17.225 | 5467.7 samples/s | 85.4 steps/s
[Step=34850 Epoch=330.2] | Loss=0.00068 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.377 | L2-Norm(final)=17.225 | 2586.6 samples/s | 40.4 steps/s
[Step=34900 Epoch=330.7] | Loss=0.00059 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.384 | L2-Norm(final)=17.225 | 4999.3 samples/s | 78.1 steps/s
[Step=34950 Epoch=331.2] | Loss=0.00053 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.387 | L2-Norm(final)=17.225 | 2721.1 samples/s | 42.5 steps/s
[Step=35000 Epoch=331.7] | Loss=0.00048 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.388 | L2-Norm(final)=17.226 | 4595.2 samples/s | 71.8 steps/s
[Step=35050 Epoch=332.1] | Loss=0.00043 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.388 | L2-Norm(final)=17.226 | 2793.6 samples/s | 43.7 steps/s
[Step=35100 Epoch=332.6] | Loss=0.00040 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.387 | L2-Norm(final)=17.226 | 4540.6 samples/s | 70.9 steps/s
[Step=35150 Epoch=333.1] | Loss=0.00037 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.385 | L2-Norm(final)=17.226 | 2892.2 samples/s | 45.2 steps/s
[Step=35200 Epoch=333.6] | Loss=0.00034 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.383 | L2-Norm(final)=17.226 | 4412.9 samples/s | 69.0 steps/s
[Step=35250 Epoch=334.0] | Loss=0.00032 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=17.227 | 2856.6 samples/s | 44.6 steps/s
[Step=35300 Epoch=334.5] | Loss=0.00030 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.376 | L2-Norm(final)=17.227 | 4608.9 samples/s | 72.0 steps/s
[Step=35350 Epoch=335.0] | Loss=0.00028 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.372 | L2-Norm(final)=17.227 | 2933.3 samples/s | 45.8 steps/s
[Step=35400 Epoch=335.4] | Loss=0.00027 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.368 | L2-Norm(final)=17.227 | 4262.4 samples/s | 66.6 steps/s
[Step=35450 Epoch=335.9] | Loss=0.00025 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=17.227 | 6811.8 samples/s | 106.4 steps/s
[Step=35500 Epoch=336.4] | Loss=0.00024 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.359 | L2-Norm(final)=17.227 | 2393.2 samples/s | 37.4 steps/s
[Step=35550 Epoch=336.9] | Loss=0.00023 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=17.228 | 5904.8 samples/s | 92.3 steps/s
[Step=35600 Epoch=337.3] | Loss=0.00022 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.350 | L2-Norm(final)=17.228 | 2452.0 samples/s | 38.3 steps/s
[Step=35650 Epoch=337.8] | Loss=0.00021 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.345 | L2-Norm(final)=17.228 | 5591.6 samples/s | 87.4 steps/s
[Step=35700 Epoch=338.3] | Loss=0.00020 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=17.228 | 2550.8 samples/s | 39.9 steps/s
[Step=35750 Epoch=338.8] | Loss=0.00019 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.334 | L2-Norm(final)=17.228 | 5156.2 samples/s | 80.6 steps/s
[Step=35800 Epoch=339.2] | Loss=0.00018 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.329 | L2-Norm(final)=17.228 | 2654.4 samples/s | 41.5 steps/s
[Step=35850 Epoch=339.7] | Loss=0.00018 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.324 | L2-Norm(final)=17.228 | 4790.2 samples/s | 74.8 steps/s
[Step=35900 Epoch=340.2] | Loss=0.00017 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.318 | L2-Norm(final)=17.228 | 2766.6 samples/s | 43.2 steps/s
[Step=35950 Epoch=340.7] | Loss=0.00017 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.312 | L2-Norm(final)=17.229 | 4539.0 samples/s | 70.9 steps/s
[Step=36000 Epoch=341.1] | Loss=0.00016 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.307 | L2-Norm(final)=17.229 | 2865.4 samples/s | 44.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step36000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=18001 Epoch=171.2] | Loss=0.00375 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=13.420 | 6497.8 samples/s | 101.5 steps/s
[Step=18050 Epoch=171.7] | Loss=0.00342 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.356 | L2-Norm(final)=13.434 | 4790.9 samples/s | 74.9 steps/s
[Step=18100 Epoch=172.2] | Loss=0.00231 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=13.449 | 7809.1 samples/s | 122.0 steps/s
[Step=18150 Epoch=172.7] | Loss=0.00244 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=13.464 | 2622.6 samples/s | 41.0 steps/s
[Step=18200 Epoch=173.1] | Loss=0.00229 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.355 | L2-Norm(final)=13.476 | 6950.6 samples/s | 108.6 steps/s
[Step=18250 Epoch=173.6] | Loss=0.00227 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=13.489 | 2747.8 samples/s | 42.9 steps/s
[Step=18300 Epoch=174.1] | Loss=0.00211 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=13.501 | 6276.5 samples/s | 98.1 steps/s
[Step=18350 Epoch=174.6] | Loss=0.00223 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=13.512 | 2783.0 samples/s | 43.5 steps/s
[Step=18400 Epoch=175.0] | Loss=0.00215 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=13.522 | 5968.3 samples/s | 93.3 steps/s
[Step=18450 Epoch=175.5] | Loss=0.00217 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=13.532 | 2947.3 samples/s | 46.1 steps/s
[Step=18500 Epoch=176.0] | Loss=0.00215 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.355 | L2-Norm(final)=13.541 | 5524.1 samples/s | 86.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=176.0] | Loss=0.00035 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=13.633 | 7101.8 samples/s | 111.0 steps/s
[Step=18550 Epoch=176.5] | Loss=0.00155 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.385 | L2-Norm(final)=13.639 | 3974.9 samples/s | 62.1 steps/s
[Step=18600 Epoch=176.9] | Loss=0.00095 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=13.643 | 6715.8 samples/s | 104.9 steps/s
[Step=18650 Epoch=177.4] | Loss=0.00096 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=13.644 | 2380.1 samples/s | 37.2 steps/s
[Step=18700 Epoch=177.9] | Loss=0.00073 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.440 | L2-Norm(final)=13.645 | 6010.3 samples/s | 93.9 steps/s
[Step=18750 Epoch=178.4] | Loss=0.00059 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.444 | L2-Norm(final)=13.646 | 2511.7 samples/s | 39.2 steps/s
[Step=18800 Epoch=178.8] | Loss=0.00049 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.443 | L2-Norm(final)=13.647 | 5325.1 samples/s | 83.2 steps/s
[Step=18850 Epoch=179.3] | Loss=0.00042 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.441 | L2-Norm(final)=13.647 | 2628.3 samples/s | 41.1 steps/s
[Step=18900 Epoch=179.8] | Loss=0.00037 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.437 | L2-Norm(final)=13.648 | 4905.2 samples/s | 76.6 steps/s
[Step=18950 Epoch=180.3] | Loss=0.00033 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.432 | L2-Norm(final)=13.648 | 2693.2 samples/s | 42.1 steps/s
[Step=19000 Epoch=180.7] | Loss=0.00030 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.426 | L2-Norm(final)=13.649 | 4677.5 samples/s | 73.1 steps/s
[Step=19050 Epoch=181.2] | Loss=0.00027 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.420 | L2-Norm(final)=13.649 | 2836.4 samples/s | 44.3 steps/s
[Step=19100 Epoch=181.7] | Loss=0.00025 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.414 | L2-Norm(final)=13.650 | 4568.6 samples/s | 71.4 steps/s
[Step=19150 Epoch=182.2] | Loss=0.00023 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=13.650 | 2818.4 samples/s | 44.0 steps/s
[Step=19200 Epoch=182.6] | Loss=0.00022 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.401 | L2-Norm(final)=13.650 | 4537.7 samples/s | 70.9 steps/s
[Step=19250 Epoch=183.1] | Loss=0.00020 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.394 | L2-Norm(final)=13.651 | 2892.6 samples/s | 45.2 steps/s
[Step=19300 Epoch=183.6] | Loss=0.00019 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.388 | L2-Norm(final)=13.651 | 4488.7 samples/s | 70.1 steps/s
[Step=19350 Epoch=184.1] | Loss=0.00018 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=13.652 | 3103.5 samples/s | 48.5 steps/s
[Step=19400 Epoch=184.5] | Loss=0.00017 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=13.652 | 4036.3 samples/s | 63.1 steps/s
[Step=19450 Epoch=185.0] | Loss=0.00016 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.366 | L2-Norm(final)=13.652 | 6759.4 samples/s | 105.6 steps/s
[Step=19500 Epoch=185.5] | Loss=0.00015 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.359 | L2-Norm(final)=13.653 | 2361.7 samples/s | 36.9 steps/s
[Step=19550 Epoch=186.0] | Loss=0.00015 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=13.653 | 6177.2 samples/s | 96.5 steps/s
[Step=19600 Epoch=186.4] | Loss=0.00014 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.344 | L2-Norm(final)=13.653 | 2446.6 samples/s | 38.2 steps/s
[Step=19650 Epoch=186.9] | Loss=0.00013 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.337 | L2-Norm(final)=13.654 | 5694.1 samples/s | 89.0 steps/s
[Step=19700 Epoch=187.4] | Loss=0.00013 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.330 | L2-Norm(final)=13.654 | 2532.3 samples/s | 39.6 steps/s
[Step=19750 Epoch=187.9] | Loss=0.00012 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.322 | L2-Norm(final)=13.654 | 5227.3 samples/s | 81.7 steps/s
[Step=19800 Epoch=188.3] | Loss=0.00012 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.314 | L2-Norm(final)=13.654 | 2698.9 samples/s | 42.2 steps/s
[Step=19850 Epoch=188.8] | Loss=0.00011 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.307 | L2-Norm(final)=13.655 | 4657.9 samples/s | 72.8 steps/s
[Step=19900 Epoch=189.3] | Loss=0.00011 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.299 | L2-Norm(final)=13.655 | 2779.3 samples/s | 43.4 steps/s
[Step=19950 Epoch=189.8] | Loss=0.00011 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.291 | L2-Norm(final)=13.655 | 4592.5 samples/s | 71.8 steps/s
[Step=20000 Epoch=190.2] | Loss=0.00010 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.656 | 2839.5 samples/s | 44.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step20000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=245.0] | Loss=0.00064 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=14.654 | 6853.5 samples/s | 107.1 steps/s
[Step=26050 Epoch=245.5] | Loss=0.00262 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=14.662 | 4551.0 samples/s | 71.1 steps/s
[Step=26100 Epoch=245.9] | Loss=0.00235 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=14.679 | 7912.0 samples/s | 123.6 steps/s
[Step=26150 Epoch=246.4] | Loss=0.00239 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=14.698 | 2557.1 samples/s | 40.0 steps/s
[Step=26200 Epoch=246.9] | Loss=0.00255 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.354 | L2-Norm(final)=14.715 | 7015.3 samples/s | 109.6 steps/s
[Step=26250 Epoch=247.3] | Loss=0.00237 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=14.731 | 2711.9 samples/s | 42.4 steps/s
[Step=26300 Epoch=247.8] | Loss=0.00248 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=14.746 | 6238.4 samples/s | 97.5 steps/s
[Step=26350 Epoch=248.3] | Loss=0.00233 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=14.760 | 2934.1 samples/s | 45.8 steps/s
[Step=26400 Epoch=248.8] | Loss=0.00248 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=14.773 | 5382.8 samples/s | 84.1 steps/s
[Step=26450 Epoch=249.2] | Loss=0.00235 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=14.786 | 3064.1 samples/s | 47.9 steps/s
[Step=26500 Epoch=249.7] | Loss=0.00235 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=14.800 | 5166.5 samples/s | 80.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=249.7] | Loss=0.00133 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=14.934 | 7240.2 samples/s | 113.1 steps/s
[Step=26550 Epoch=250.2] | Loss=0.00637 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.387 | L2-Norm(final)=14.932 | 3952.0 samples/s | 61.7 steps/s
[Step=26600 Epoch=250.6] | Loss=0.00490 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.443 | L2-Norm(final)=14.925 | 6539.7 samples/s | 102.2 steps/s
[Step=26650 Epoch=251.1] | Loss=0.00332 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.470 | L2-Norm(final)=14.924 | 2436.3 samples/s | 38.1 steps/s
[Step=26700 Epoch=251.6] | Loss=0.00250 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.480 | L2-Norm(final)=14.925 | 5690.8 samples/s | 88.9 steps/s
[Step=26750 Epoch=252.1] | Loss=0.00201 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.484 | L2-Norm(final)=14.926 | 2502.5 samples/s | 39.1 steps/s
[Step=26800 Epoch=252.5] | Loss=0.00168 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.484 | L2-Norm(final)=14.927 | 5248.7 samples/s | 82.0 steps/s
[Step=26850 Epoch=253.0] | Loss=0.00144 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.482 | L2-Norm(final)=14.928 | 2649.9 samples/s | 41.4 steps/s
[Step=26900 Epoch=253.5] | Loss=0.00126 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.479 | L2-Norm(final)=14.929 | 4790.0 samples/s | 74.8 steps/s
[Step=26950 Epoch=253.9] | Loss=0.00112 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=14.930 | 2794.6 samples/s | 43.7 steps/s
[Step=27000 Epoch=254.4] | Loss=0.00101 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.471 | L2-Norm(final)=14.931 | 4630.9 samples/s | 72.4 steps/s
[Step=27050 Epoch=254.9] | Loss=0.00092 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.467 | L2-Norm(final)=14.932 | 2827.9 samples/s | 44.2 steps/s
[Step=27100 Epoch=255.4] | Loss=0.00084 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.462 | L2-Norm(final)=14.933 | 4514.6 samples/s | 70.5 steps/s
[Step=27150 Epoch=255.8] | Loss=0.00078 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.457 | L2-Norm(final)=14.934 | 2873.9 samples/s | 44.9 steps/s
[Step=27200 Epoch=256.3] | Loss=0.00073 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.451 | L2-Norm(final)=14.934 | 4529.5 samples/s | 70.8 steps/s
[Step=27250 Epoch=256.8] | Loss=0.00068 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.446 | L2-Norm(final)=14.935 | 3149.3 samples/s | 49.2 steps/s
[Step=27300 Epoch=257.2] | Loss=0.00064 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.440 | L2-Norm(final)=14.936 | 3968.4 samples/s | 62.0 steps/s
[Step=27350 Epoch=257.7] | Loss=0.00060 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=14.937 | 6637.0 samples/s | 103.7 steps/s
[Step=27400 Epoch=258.2] | Loss=0.00057 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=14.937 | 2412.8 samples/s | 37.7 steps/s
[Step=27450 Epoch=258.7] | Loss=0.00054 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.423 | L2-Norm(final)=14.938 | 5765.6 samples/s | 90.1 steps/s
[Step=27500 Epoch=259.1] | Loss=0.00051 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.417 | L2-Norm(final)=14.939 | 2495.9 samples/s | 39.0 steps/s
[Step=27550 Epoch=259.6] | Loss=0.00049 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.411 | L2-Norm(final)=14.940 | 5333.6 samples/s | 83.3 steps/s
[Step=27600 Epoch=260.1] | Loss=0.00046 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=14.940 | 2621.4 samples/s | 41.0 steps/s
[Step=27650 Epoch=260.5] | Loss=0.00044 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.399 | L2-Norm(final)=14.941 | 4847.8 samples/s | 75.7 steps/s
[Step=27700 Epoch=261.0] | Loss=0.00043 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.393 | L2-Norm(final)=14.942 | 2765.2 samples/s | 43.2 steps/s
[Step=27750 Epoch=261.5] | Loss=0.00041 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.387 | L2-Norm(final)=14.942 | 4524.7 samples/s | 70.7 steps/s
[Step=27800 Epoch=262.0] | Loss=0.00039 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=14.943 | 2886.1 samples/s | 45.1 steps/s
[Step=27850 Epoch=262.4] | Loss=0.00038 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.375 | L2-Norm(final)=14.943 | 4524.1 samples/s | 70.7 steps/s
[Step=27900 Epoch=262.9] | Loss=0.00037 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=14.944 | 2856.6 samples/s | 44.6 steps/s
[Step=27950 Epoch=263.4] | Loss=0.00035 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.362 | L2-Norm(final)=14.945 | 4507.0 samples/s | 70.4 steps/s
[Step=28000 Epoch=263.8] | Loss=0.00034 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.356 | L2-Norm(final)=14.945 | 3080.0 samples/s | 48.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09086 | acc=0.9605 | tpr=0.9675 | fpr=0.0548 | 5620.1 samples/s | 22.0 steps/s
Avg test loss: 0.10147, Avg test acc: 0.95621, Avg tpr: 0.96316, Avg fpr: 0.05909, total FA: 461

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10313 | acc=0.9586 | tpr=0.9777 | fpr=0.0830 | 5568.1 samples/s | 21.8 steps/s
Avg test loss: 0.10586, Avg test acc: 0.95773, Avg tpr: 0.97616, Avg fpr: 0.08281, total FA: 646

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.10244 | acc=0.9584 | tpr=0.9759 | fpr=0.0798 | 5835.1 samples/s | 22.8 steps/s
Avg test loss: 0.10283, Avg test acc: 0.95757, Avg tpr: 0.97494, Avg fpr: 0.08063, total FA: 629

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09808 | acc=0.9580 | tpr=0.9767 | fpr=0.0825 | 5828.7 samples/s | 22.8 steps/s
Avg test loss: 0.10399, Avg test acc: 0.95649, Avg tpr: 0.97570, Avg fpr: 0.08576, total FA: 669

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10559 | acc=0.9587 | tpr=0.9662 | fpr=0.0577 | 6101.9 samples/s | 23.8 steps/s
Avg test loss: 0.10873, Avg test acc: 0.95773, Avg tpr: 0.96550, Avg fpr: 0.05935, total FA: 463

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.30578 | acc=0.2991 | tpr=0.0272 | fpr=0.1105 | 6169.8 samples/s | 24.1 steps/s
Avg test loss: 6.31301, Avg test acc: 0.29754, Avg tpr: 0.02664, Avg fpr: 0.10665, total FA: 832

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.91732 | acc=0.3037 | tpr=0.0322 | fpr=0.1068 | 5998.2 samples/s | 23.4 steps/s
Avg test loss: 4.92237, Avg test acc: 0.30195, Avg tpr: 0.03060, Avg fpr: 0.10127, total FA: 790

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.10158 | acc=0.2972 | tpr=0.0127 | fpr=0.0850 | 5842.5 samples/s | 22.8 steps/s
Avg test loss: 5.10930, Avg test acc: 0.29417, Avg tpr: 0.01212, Avg fpr: 0.08550, total FA: 667

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.77238 | acc=0.2818 | tpr=0.0268 | fpr=0.1645 | 5608.9 samples/s | 21.9 steps/s
Avg test loss: 5.77930, Avg test acc: 0.28019, Avg tpr: 0.02483, Avg fpr: 0.15818, total FA: 1234

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.26252 | acc=0.2991 | tpr=0.0159 | fpr=0.0857 | 5942.7 samples/s | 23.2 steps/s
Avg test loss: 5.26980, Avg test acc: 0.29702, Avg tpr: 0.01475, Avg fpr: 0.08217, total FA: 641

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.92569 | acc=0.1481 | tpr=0.5841 | fpr=0.8597 | 5899.4 samples/s | 23.0 steps/s
[Step= 100] | Loss=4.91399 | acc=0.1524 | tpr=0.5714 | fpr=0.8554 | 7940.7 samples/s | 31.0 steps/s
[Step= 150] | Loss=4.90988 | acc=0.1540 | tpr=0.5965 | fpr=0.8541 | 7986.9 samples/s | 31.2 steps/s
[Step= 200] | Loss=4.90137 | acc=0.1544 | tpr=0.5836 | fpr=0.8534 | 7382.1 samples/s | 28.8 steps/s
[Step= 250] | Loss=4.90572 | acc=0.1537 | tpr=0.5799 | fpr=0.8541 | 8443.2 samples/s | 33.0 steps/s
[Step= 300] | Loss=4.89934 | acc=0.1535 | tpr=0.5724 | fpr=0.8541 | 8061.2 samples/s | 31.5 steps/s
[Step= 350] | Loss=4.90380 | acc=0.1530 | tpr=0.5686 | fpr=0.8546 | 8124.5 samples/s | 31.7 steps/s
[Step= 400] | Loss=4.90033 | acc=0.1538 | tpr=0.5667 | fpr=0.8537 | 7453.0 samples/s | 29.1 steps/s
[Step= 450] | Loss=4.90397 | acc=0.1535 | tpr=0.5725 | fpr=0.8541 | 8401.9 samples/s | 32.8 steps/s
[Step= 500] | Loss=4.90392 | acc=0.1536 | tpr=0.5762 | fpr=0.8541 | 8351.2 samples/s | 32.6 steps/s
[Step= 550] | Loss=4.90680 | acc=0.1536 | tpr=0.5774 | fpr=0.8541 | 10821.2 samples/s | 42.3 steps/s
Avg test loss: 4.90742, Avg test acc: 0.15350, Avg tpr: 0.57805, Avg fpr: 0.85422, total FA: 118607

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.26894 | acc=0.1295 | tpr=0.6770 | fpr=0.8804 | 6004.5 samples/s | 23.5 steps/s
[Step= 100] | Loss=5.24619 | acc=0.1329 | tpr=0.6780 | fpr=0.8772 | 7918.9 samples/s | 30.9 steps/s
[Step= 150] | Loss=5.24384 | acc=0.1343 | tpr=0.6916 | fpr=0.8759 | 7442.2 samples/s | 29.1 steps/s
[Step= 200] | Loss=5.23907 | acc=0.1342 | tpr=0.6852 | fpr=0.8759 | 8095.2 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.24345 | acc=0.1342 | tpr=0.6803 | fpr=0.8758 | 8068.5 samples/s | 31.5 steps/s
[Step= 300] | Loss=5.23932 | acc=0.1338 | tpr=0.6742 | fpr=0.8760 | 8318.3 samples/s | 32.5 steps/s
[Step= 350] | Loss=5.24712 | acc=0.1337 | tpr=0.6675 | fpr=0.8760 | 8018.9 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.24619 | acc=0.1338 | tpr=0.6674 | fpr=0.8759 | 7458.1 samples/s | 29.1 steps/s
[Step= 450] | Loss=5.24948 | acc=0.1333 | tpr=0.6704 | fpr=0.8765 | 8039.8 samples/s | 31.4 steps/s
[Step= 500] | Loss=5.25040 | acc=0.1330 | tpr=0.6722 | fpr=0.8768 | 8303.0 samples/s | 32.4 steps/s
[Step= 550] | Loss=5.25397 | acc=0.1333 | tpr=0.6733 | fpr=0.8766 | 11208.0 samples/s | 43.8 steps/s
Avg test loss: 5.25439, Avg test acc: 0.13315, Avg tpr: 0.67353, Avg fpr: 0.87667, total FA: 121724

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.49032 | acc=0.1166 | tpr=0.6814 | fpr=0.8935 | 6005.0 samples/s | 23.5 steps/s
[Step= 100] | Loss=5.47987 | acc=0.1167 | tpr=0.6716 | fpr=0.8936 | 8327.7 samples/s | 32.5 steps/s
[Step= 150] | Loss=5.47208 | acc=0.1179 | tpr=0.6715 | fpr=0.8923 | 7393.5 samples/s | 28.9 steps/s
[Step= 200] | Loss=5.46492 | acc=0.1181 | tpr=0.6612 | fpr=0.8918 | 8176.4 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.47103 | acc=0.1179 | tpr=0.6550 | fpr=0.8919 | 8544.7 samples/s | 33.4 steps/s
[Step= 300] | Loss=5.46591 | acc=0.1175 | tpr=0.6531 | fpr=0.8923 | 7285.6 samples/s | 28.5 steps/s
[Step= 350] | Loss=5.47491 | acc=0.1173 | tpr=0.6512 | fpr=0.8924 | 8643.9 samples/s | 33.8 steps/s
[Step= 400] | Loss=5.47284 | acc=0.1174 | tpr=0.6532 | fpr=0.8923 | 8577.9 samples/s | 33.5 steps/s
[Step= 450] | Loss=5.47777 | acc=0.1170 | tpr=0.6577 | fpr=0.8928 | 7908.2 samples/s | 30.9 steps/s
[Step= 500] | Loss=5.47702 | acc=0.1169 | tpr=0.6568 | fpr=0.8928 | 7923.4 samples/s | 31.0 steps/s
[Step= 550] | Loss=5.48081 | acc=0.1170 | tpr=0.6570 | fpr=0.8928 | 9421.2 samples/s | 36.8 steps/s
Avg test loss: 5.48130, Avg test acc: 0.11688, Avg tpr: 0.65848, Avg fpr: 0.89296, total FA: 123986

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.51370 | acc=0.1231 | tpr=0.7124 | fpr=0.8875 | 5606.5 samples/s | 21.9 steps/s
[Step= 100] | Loss=5.49380 | acc=0.1254 | tpr=0.6844 | fpr=0.8851 | 8352.0 samples/s | 32.6 steps/s
[Step= 150] | Loss=5.48351 | acc=0.1268 | tpr=0.6945 | fpr=0.8837 | 8127.8 samples/s | 31.7 steps/s
[Step= 200] | Loss=5.47890 | acc=0.1270 | tpr=0.6918 | fpr=0.8833 | 7942.4 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.48056 | acc=0.1270 | tpr=0.6926 | fpr=0.8833 | 8402.2 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.47693 | acc=0.1269 | tpr=0.6924 | fpr=0.8834 | 8128.3 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.48134 | acc=0.1266 | tpr=0.6957 | fpr=0.8837 | 7593.0 samples/s | 29.7 steps/s
[Step= 400] | Loss=5.47927 | acc=0.1268 | tpr=0.6942 | fpr=0.8835 | 7878.9 samples/s | 30.8 steps/s
[Step= 450] | Loss=5.48405 | acc=0.1261 | tpr=0.6972 | fpr=0.8843 | 8162.4 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.48288 | acc=0.1261 | tpr=0.6991 | fpr=0.8842 | 8247.8 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.48948 | acc=0.1262 | tpr=0.6988 | fpr=0.8842 | 10099.7 samples/s | 39.5 steps/s
Avg test loss: 5.49069, Avg test acc: 0.12609, Avg tpr: 0.69929, Avg fpr: 0.88433, total FA: 122787

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.97676 | acc=0.1274 | tpr=0.5885 | fpr=0.8809 | 6076.6 samples/s | 23.7 steps/s
[Step= 100] | Loss=5.95916 | acc=0.1305 | tpr=0.5821 | fpr=0.8779 | 7190.3 samples/s | 28.1 steps/s
[Step= 150] | Loss=5.94997 | acc=0.1320 | tpr=0.5908 | fpr=0.8764 | 7555.5 samples/s | 29.5 steps/s
[Step= 200] | Loss=5.95049 | acc=0.1323 | tpr=0.5836 | fpr=0.8759 | 8173.8 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.95248 | acc=0.1319 | tpr=0.5799 | fpr=0.8762 | 8819.2 samples/s | 34.4 steps/s
[Step= 300] | Loss=5.94782 | acc=0.1313 | tpr=0.5782 | fpr=0.8768 | 8212.6 samples/s | 32.1 steps/s
[Step= 350] | Loss=5.95846 | acc=0.1312 | tpr=0.5755 | fpr=0.8769 | 7874.6 samples/s | 30.8 steps/s
[Step= 400] | Loss=5.95505 | acc=0.1314 | tpr=0.5744 | fpr=0.8767 | 8390.3 samples/s | 32.8 steps/s
[Step= 450] | Loss=5.95978 | acc=0.1309 | tpr=0.5789 | fpr=0.8772 | 8122.2 samples/s | 31.7 steps/s
[Step= 500] | Loss=5.95849 | acc=0.1307 | tpr=0.5824 | fpr=0.8775 | 7346.7 samples/s | 28.7 steps/s
[Step= 550] | Loss=5.96226 | acc=0.1308 | tpr=0.5834 | fpr=0.8774 | 11200.5 samples/s | 43.8 steps/s
Avg test loss: 5.96341, Avg test acc: 0.13078, Avg tpr: 0.58399, Avg fpr: 0.87746, total FA: 121833

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.21215 | acc=0.9559 | tpr=0.9027 | fpr=0.0431 | 5629.2 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.21941 | acc=0.9559 | tpr=0.9275 | fpr=0.0436 | 8181.1 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.22337 | acc=0.9543 | tpr=0.9294 | fpr=0.0452 | 8401.6 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.22263 | acc=0.9539 | tpr=0.9322 | fpr=0.0457 | 7843.0 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.22266 | acc=0.9540 | tpr=0.9310 | fpr=0.0456 | 7509.1 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.22550 | acc=0.9536 | tpr=0.9324 | fpr=0.0460 | 8819.2 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.22442 | acc=0.9537 | tpr=0.9336 | fpr=0.0459 | 7908.2 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.22427 | acc=0.9536 | tpr=0.9294 | fpr=0.0459 | 8006.0 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.22871 | acc=0.9530 | tpr=0.9260 | fpr=0.0465 | 7811.8 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.22865 | acc=0.9530 | tpr=0.9238 | fpr=0.0465 | 7065.0 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.22747 | acc=0.9533 | tpr=0.9232 | fpr=0.0462 | 12993.3 samples/s | 50.8 steps/s
Avg test loss: 0.22706, Avg test acc: 0.95332, Avg tpr: 0.92314, Avg fpr: 0.04613, total FA: 6405

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16719 | acc=0.9632 | tpr=0.9159 | fpr=0.0359 | 6064.1 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.17367 | acc=0.9618 | tpr=0.9424 | fpr=0.0378 | 7217.6 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.17676 | acc=0.9608 | tpr=0.9452 | fpr=0.0389 | 8028.7 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.17730 | acc=0.9605 | tpr=0.9497 | fpr=0.0393 | 7912.6 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.17749 | acc=0.9605 | tpr=0.9476 | fpr=0.0393 | 7971.6 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.18033 | acc=0.9600 | tpr=0.9425 | fpr=0.0397 | 8108.1 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.17973 | acc=0.9600 | tpr=0.9418 | fpr=0.0396 | 7842.3 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.17988 | acc=0.9598 | tpr=0.9393 | fpr=0.0399 | 8180.7 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.18324 | acc=0.9592 | tpr=0.9387 | fpr=0.0404 | 7798.5 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.18289 | acc=0.9591 | tpr=0.9383 | fpr=0.0405 | 8250.4 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.18209 | acc=0.9594 | tpr=0.9379 | fpr=0.0403 | 11794.9 samples/s | 46.1 steps/s
Avg test loss: 0.18185, Avg test acc: 0.95939, Avg tpr: 0.93780, Avg fpr: 0.04022, total FA: 5584

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.29478 | acc=0.9483 | tpr=0.9248 | fpr=0.0513 | 5907.3 samples/s | 23.1 steps/s
[Step= 100] | Loss=0.30079 | acc=0.9474 | tpr=0.9403 | fpr=0.0524 | 7868.4 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.30757 | acc=0.9460 | tpr=0.9409 | fpr=0.0539 | 7747.1 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.30717 | acc=0.9464 | tpr=0.9475 | fpr=0.0537 | 8111.8 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.30746 | acc=0.9460 | tpr=0.9450 | fpr=0.0539 | 8483.9 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.31045 | acc=0.9457 | tpr=0.9396 | fpr=0.0541 | 8086.0 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.30746 | acc=0.9458 | tpr=0.9411 | fpr=0.0541 | 7500.3 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.30780 | acc=0.9455 | tpr=0.9387 | fpr=0.0544 | 8317.9 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.31202 | acc=0.9451 | tpr=0.9352 | fpr=0.0547 | 7699.4 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.31265 | acc=0.9450 | tpr=0.9366 | fpr=0.0548 | 8463.5 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.31046 | acc=0.9453 | tpr=0.9359 | fpr=0.0546 | 10064.7 samples/s | 39.3 steps/s
Avg test loss: 0.31016, Avg test acc: 0.94527, Avg tpr: 0.93542, Avg fpr: 0.05455, total FA: 7574

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14615 | acc=0.9641 | tpr=0.9159 | fpr=0.0350 | 5682.3 samples/s | 22.2 steps/s
[Step= 100] | Loss=0.15435 | acc=0.9620 | tpr=0.9275 | fpr=0.0374 | 8630.7 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.15528 | acc=0.9606 | tpr=0.9308 | fpr=0.0389 | 8152.3 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.15461 | acc=0.9607 | tpr=0.9322 | fpr=0.0388 | 8136.9 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.15451 | acc=0.9606 | tpr=0.9310 | fpr=0.0389 | 7881.0 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.15703 | acc=0.9601 | tpr=0.9302 | fpr=0.0394 | 8082.9 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.15603 | acc=0.9600 | tpr=0.9299 | fpr=0.0394 | 8196.4 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.15575 | acc=0.9599 | tpr=0.9267 | fpr=0.0395 | 7159.9 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.15842 | acc=0.9595 | tpr=0.9265 | fpr=0.0399 | 8618.4 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.15850 | acc=0.9594 | tpr=0.9269 | fpr=0.0400 | 7584.7 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.15739 | acc=0.9597 | tpr=0.9276 | fpr=0.0397 | 11015.6 samples/s | 43.0 steps/s
Avg test loss: 0.15715, Avg test acc: 0.95969, Avg tpr: 0.92750, Avg fpr: 0.03972, total FA: 5515

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.23264 | acc=0.9564 | tpr=0.8982 | fpr=0.0425 | 6016.6 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.24146 | acc=0.9552 | tpr=0.9254 | fpr=0.0442 | 8118.1 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.24465 | acc=0.9538 | tpr=0.9352 | fpr=0.0459 | 8357.3 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.24514 | acc=0.9538 | tpr=0.9399 | fpr=0.0459 | 7735.3 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.24629 | acc=0.9538 | tpr=0.9415 | fpr=0.0460 | 7608.5 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.25009 | acc=0.9532 | tpr=0.9411 | fpr=0.0465 | 8667.3 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.24850 | acc=0.9532 | tpr=0.9411 | fpr=0.0466 | 8201.3 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.24873 | acc=0.9528 | tpr=0.9376 | fpr=0.0469 | 7011.1 samples/s | 27.4 steps/s
[Step= 450] | Loss=0.25250 | acc=0.9524 | tpr=0.9377 | fpr=0.0473 | 8399.7 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.25284 | acc=0.9523 | tpr=0.9370 | fpr=0.0475 | 8588.8 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.25106 | acc=0.9526 | tpr=0.9383 | fpr=0.0471 | 9877.7 samples/s | 38.6 steps/s
Avg test loss: 0.25071, Avg test acc: 0.95264, Avg tpr: 0.93819, Avg fpr: 0.04709, total FA: 6539

server round 24/50

clients selected: [0 4 6 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=18001 Epoch=87.8] | Loss=0.04526 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.286 | L2-Norm(final)=11.087 | 7806.8 samples/s | 122.0 steps/s
[Step=18050 Epoch=88.0] | Loss=0.02938 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.286 | L2-Norm(final)=11.088 | 4578.1 samples/s | 71.5 steps/s
[Step=18100 Epoch=88.3] | Loss=0.02867 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.286 | L2-Norm(final)=11.095 | 5611.8 samples/s | 87.7 steps/s
[Step=18150 Epoch=88.5] | Loss=0.02969 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=11.102 | 5474.0 samples/s | 85.5 steps/s
[Step=18200 Epoch=88.7] | Loss=0.02955 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.286 | L2-Norm(final)=11.105 | 8599.2 samples/s | 134.4 steps/s
[Step=18250 Epoch=89.0] | Loss=0.02965 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.286 | L2-Norm(final)=11.108 | 2679.3 samples/s | 41.9 steps/s
[Step=18300 Epoch=89.2] | Loss=0.02994 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=11.110 | 5621.4 samples/s | 87.8 steps/s
[Step=18350 Epoch=89.5] | Loss=0.02959 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.286 | L2-Norm(final)=11.113 | 5573.4 samples/s | 87.1 steps/s
[Step=18400 Epoch=89.7] | Loss=0.02942 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.286 | L2-Norm(final)=11.117 | 7634.9 samples/s | 119.3 steps/s
[Step=18450 Epoch=90.0] | Loss=0.03010 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.286 | L2-Norm(final)=11.120 | 2791.2 samples/s | 43.6 steps/s
[Step=18500 Epoch=90.2] | Loss=0.03003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=11.122 | 5535.2 samples/s | 86.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=90.2] | Loss=0.02492 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.286 | L2-Norm(final)=11.145 | 7446.4 samples/s | 116.3 steps/s
[Step=18550 Epoch=90.5] | Loss=0.03013 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.328 | L2-Norm(final)=11.153 | 4159.4 samples/s | 65.0 steps/s
[Step=18600 Epoch=90.7] | Loss=0.03151 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.375 | L2-Norm(final)=11.152 | 4773.2 samples/s | 74.6 steps/s
[Step=18650 Epoch=90.9] | Loss=0.03070 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=11.150 | 4707.3 samples/s | 73.6 steps/s
[Step=18700 Epoch=91.2] | Loss=0.02768 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.444 | L2-Norm(final)=11.151 | 6906.7 samples/s | 107.9 steps/s
[Step=18750 Epoch=91.4] | Loss=0.02420 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.471 | L2-Norm(final)=11.154 | 2450.2 samples/s | 38.3 steps/s
[Step=18800 Epoch=91.7] | Loss=0.02172 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.492 | L2-Norm(final)=11.158 | 4742.4 samples/s | 74.1 steps/s
[Step=18850 Epoch=91.9] | Loss=0.02004 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.510 | L2-Norm(final)=11.163 | 4765.3 samples/s | 74.5 steps/s
[Step=18900 Epoch=92.2] | Loss=0.01847 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.526 | L2-Norm(final)=11.168 | 6269.3 samples/s | 98.0 steps/s
[Step=18950 Epoch=92.4] | Loss=0.01696 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.540 | L2-Norm(final)=11.173 | 2566.8 samples/s | 40.1 steps/s
[Step=19000 Epoch=92.6] | Loss=0.01579 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.553 | L2-Norm(final)=11.178 | 4774.4 samples/s | 74.6 steps/s
[Step=19050 Epoch=92.9] | Loss=0.01504 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.564 | L2-Norm(final)=11.183 | 4753.3 samples/s | 74.3 steps/s
[Step=19100 Epoch=93.1] | Loss=0.01432 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.573 | L2-Norm(final)=11.187 | 5735.0 samples/s | 89.6 steps/s
[Step=19150 Epoch=93.4] | Loss=0.01372 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.583 | L2-Norm(final)=11.191 | 2656.5 samples/s | 41.5 steps/s
[Step=19200 Epoch=93.6] | Loss=0.01322 | Reg=0.00134 | acc=0.9531 | L2-Norm=11.591 | L2-Norm(final)=11.195 | 4819.0 samples/s | 75.3 steps/s
[Step=19250 Epoch=93.9] | Loss=0.01262 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.599 | L2-Norm(final)=11.198 | 4772.3 samples/s | 74.6 steps/s
[Step=19300 Epoch=94.1] | Loss=0.01211 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.606 | L2-Norm(final)=11.202 | 5223.3 samples/s | 81.6 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01171 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.613 | L2-Norm(final)=11.206 | 2755.7 samples/s | 43.1 steps/s
[Step=19400 Epoch=94.6] | Loss=0.01124 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.619 | L2-Norm(final)=11.209 | 4761.4 samples/s | 74.4 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01085 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.625 | L2-Norm(final)=11.212 | 4738.0 samples/s | 74.0 steps/s
[Step=19500 Epoch=95.1] | Loss=0.01059 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.630 | L2-Norm(final)=11.215 | 4922.9 samples/s | 76.9 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01033 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.635 | L2-Norm(final)=11.218 | 2897.5 samples/s | 45.3 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01002 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.640 | L2-Norm(final)=11.221 | 4857.4 samples/s | 75.9 steps/s
[Step=19650 Epoch=95.8] | Loss=0.00979 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.644 | L2-Norm(final)=11.224 | 4669.8 samples/s | 73.0 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00953 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.649 | L2-Norm(final)=11.227 | 4753.4 samples/s | 74.3 steps/s
[Step=19750 Epoch=96.3] | Loss=0.00930 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.653 | L2-Norm(final)=11.230 | 2936.7 samples/s | 45.9 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00908 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.657 | L2-Norm(final)=11.233 | 4767.5 samples/s | 74.5 steps/s
[Step=19850 Epoch=96.8] | Loss=0.00884 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.661 | L2-Norm(final)=11.236 | 4805.2 samples/s | 75.1 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00867 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.665 | L2-Norm(final)=11.238 | 4698.3 samples/s | 73.4 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00850 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.668 | L2-Norm(final)=11.241 | 2945.2 samples/s | 46.0 steps/s
[Step=20000 Epoch=97.5] | Loss=0.00828 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.672 | L2-Norm(final)=11.244 | 4759.4 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step20000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=18001 Epoch=88.3] | Loss=0.02688 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.286 | L2-Norm(final)=13.110 | 6665.3 samples/s | 104.1 steps/s
[Step=18050 Epoch=88.5] | Loss=0.02701 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.286 | L2-Norm(final)=13.112 | 4904.1 samples/s | 76.6 steps/s
[Step=18100 Epoch=88.8] | Loss=0.02697 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.286 | L2-Norm(final)=13.112 | 5643.9 samples/s | 88.2 steps/s
[Step=18150 Epoch=89.0] | Loss=0.02617 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.286 | L2-Norm(final)=13.113 | 5479.8 samples/s | 85.6 steps/s
[Step=18200 Epoch=89.2] | Loss=0.02584 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.286 | L2-Norm(final)=13.112 | 8891.5 samples/s | 138.9 steps/s
[Step=18250 Epoch=89.5] | Loss=0.02597 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.286 | L2-Norm(final)=13.113 | 2665.7 samples/s | 41.7 steps/s
[Step=18300 Epoch=89.7] | Loss=0.02633 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=13.113 | 5628.2 samples/s | 87.9 steps/s
[Step=18350 Epoch=90.0] | Loss=0.02633 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=13.113 | 5485.8 samples/s | 85.7 steps/s
[Step=18400 Epoch=90.2] | Loss=0.02606 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.286 | L2-Norm(final)=13.114 | 8177.0 samples/s | 127.8 steps/s
[Step=18450 Epoch=90.5] | Loss=0.02608 | Reg=0.00127 | acc=0.9375 | L2-Norm=11.286 | L2-Norm(final)=13.114 | 2723.2 samples/s | 42.6 steps/s
[Step=18500 Epoch=90.7] | Loss=0.02577 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.286 | L2-Norm(final)=13.116 | 5474.3 samples/s | 85.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=90.7] | Loss=0.00544 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=13.131 | 7754.1 samples/s | 121.2 steps/s
[Step=18550 Epoch=91.0] | Loss=0.03345 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.329 | L2-Norm(final)=13.126 | 4156.3 samples/s | 64.9 steps/s
[Step=18600 Epoch=91.2] | Loss=0.03169 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.377 | L2-Norm(final)=13.122 | 4779.5 samples/s | 74.7 steps/s
[Step=18650 Epoch=91.5] | Loss=0.02964 | Reg=0.00130 | acc=0.9375 | L2-Norm=11.412 | L2-Norm(final)=13.121 | 4763.9 samples/s | 74.4 steps/s
[Step=18700 Epoch=91.7] | Loss=0.02643 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.443 | L2-Norm(final)=13.123 | 7039.2 samples/s | 110.0 steps/s
[Step=18750 Epoch=91.9] | Loss=0.02272 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.469 | L2-Norm(final)=13.126 | 2457.4 samples/s | 38.4 steps/s
[Step=18800 Epoch=92.2] | Loss=0.02046 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=13.130 | 4757.8 samples/s | 74.3 steps/s
[Step=18850 Epoch=92.4] | Loss=0.01841 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.506 | L2-Norm(final)=13.134 | 4732.9 samples/s | 74.0 steps/s
[Step=18900 Epoch=92.7] | Loss=0.01720 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.520 | L2-Norm(final)=13.138 | 6569.0 samples/s | 102.6 steps/s
[Step=18950 Epoch=92.9] | Loss=0.01610 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.531 | L2-Norm(final)=13.142 | 2513.0 samples/s | 39.3 steps/s
[Step=19000 Epoch=93.2] | Loss=0.01509 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.541 | L2-Norm(final)=13.145 | 4810.5 samples/s | 75.2 steps/s
[Step=19050 Epoch=93.4] | Loss=0.01407 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.551 | L2-Norm(final)=13.148 | 4728.5 samples/s | 73.9 steps/s
[Step=19100 Epoch=93.7] | Loss=0.01334 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.559 | L2-Norm(final)=13.152 | 6211.3 samples/s | 97.1 steps/s
[Step=19150 Epoch=93.9] | Loss=0.01264 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.567 | L2-Norm(final)=13.155 | 2560.4 samples/s | 40.0 steps/s
[Step=19200 Epoch=94.2] | Loss=0.01201 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.574 | L2-Norm(final)=13.159 | 4799.9 samples/s | 75.0 steps/s
[Step=19250 Epoch=94.4] | Loss=0.01144 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=13.162 | 4714.9 samples/s | 73.7 steps/s
[Step=19300 Epoch=94.6] | Loss=0.01103 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.588 | L2-Norm(final)=13.165 | 5843.6 samples/s | 91.3 steps/s
[Step=19350 Epoch=94.9] | Loss=0.01053 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.593 | L2-Norm(final)=13.169 | 2625.5 samples/s | 41.0 steps/s
[Step=19400 Epoch=95.1] | Loss=0.01028 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.599 | L2-Norm(final)=13.172 | 4763.5 samples/s | 74.4 steps/s
[Step=19450 Epoch=95.4] | Loss=0.00990 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.604 | L2-Norm(final)=13.175 | 4726.3 samples/s | 73.8 steps/s
[Step=19500 Epoch=95.6] | Loss=0.00961 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.609 | L2-Norm(final)=13.177 | 5522.1 samples/s | 86.3 steps/s
[Step=19550 Epoch=95.9] | Loss=0.00928 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.614 | L2-Norm(final)=13.180 | 2712.8 samples/s | 42.4 steps/s
[Step=19600 Epoch=96.1] | Loss=0.00899 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.618 | L2-Norm(final)=13.183 | 4790.7 samples/s | 74.9 steps/s
[Step=19650 Epoch=96.4] | Loss=0.00872 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.622 | L2-Norm(final)=13.186 | 4799.4 samples/s | 75.0 steps/s
[Step=19700 Epoch=96.6] | Loss=0.00850 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.626 | L2-Norm(final)=13.189 | 5136.9 samples/s | 80.3 steps/s
[Step=19750 Epoch=96.9] | Loss=0.00830 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.630 | L2-Norm(final)=13.192 | 2806.7 samples/s | 43.9 steps/s
[Step=19800 Epoch=97.1] | Loss=0.00806 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.633 | L2-Norm(final)=13.194 | 4702.7 samples/s | 73.5 steps/s
[Step=19850 Epoch=97.3] | Loss=0.00785 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.637 | L2-Norm(final)=13.197 | 4757.0 samples/s | 74.3 steps/s
[Step=19900 Epoch=97.6] | Loss=0.00770 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.640 | L2-Norm(final)=13.200 | 4972.8 samples/s | 77.7 steps/s
[Step=19950 Epoch=97.8] | Loss=0.00748 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.643 | L2-Norm(final)=13.202 | 2888.1 samples/s | 45.1 steps/s
[Step=20000 Epoch=98.1] | Loss=0.00729 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.646 | L2-Norm(final)=13.205 | 4641.5 samples/s | 72.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step20000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=190.3] | Loss=0.00008 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=13.664 | 6140.1 samples/s | 95.9 steps/s
[Step=20050 Epoch=190.7] | Loss=0.00161 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.284 | L2-Norm(final)=13.677 | 4864.8 samples/s | 76.0 steps/s
[Step=20100 Epoch=191.2] | Loss=0.00147 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.695 | 8303.8 samples/s | 129.7 steps/s
[Step=20150 Epoch=191.7] | Loss=0.00149 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.711 | 2543.2 samples/s | 39.7 steps/s
[Step=20200 Epoch=192.2] | Loss=0.00144 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.727 | 7389.1 samples/s | 115.5 steps/s
[Step=20250 Epoch=192.6] | Loss=0.00140 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.742 | 2698.2 samples/s | 42.2 steps/s
[Step=20300 Epoch=193.1] | Loss=0.00144 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.756 | 6534.4 samples/s | 102.1 steps/s
[Step=20350 Epoch=193.6] | Loss=0.00135 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.770 | 2812.3 samples/s | 43.9 steps/s
[Step=20400 Epoch=194.1] | Loss=0.00137 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.782 | 5888.3 samples/s | 92.0 steps/s
[Step=20450 Epoch=194.5] | Loss=0.00133 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.795 | 2929.3 samples/s | 45.8 steps/s
[Step=20500 Epoch=195.0] | Loss=0.00133 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.807 | 5462.9 samples/s | 85.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=195.0] | Loss=0.00018 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.926 | 7166.8 samples/s | 112.0 steps/s
[Step=20550 Epoch=195.5] | Loss=0.00258 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.339 | L2-Norm(final)=13.930 | 4018.4 samples/s | 62.8 steps/s
[Step=20600 Epoch=196.0] | Loss=0.00355 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.398 | L2-Norm(final)=13.930 | 6568.5 samples/s | 102.6 steps/s
[Step=20650 Epoch=196.4] | Loss=0.00261 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.434 | L2-Norm(final)=13.928 | 2393.7 samples/s | 37.4 steps/s
[Step=20700 Epoch=196.9] | Loss=0.00198 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.451 | L2-Norm(final)=13.927 | 5926.4 samples/s | 92.6 steps/s
[Step=20750 Epoch=197.4] | Loss=0.00159 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.458 | L2-Norm(final)=13.927 | 2472.6 samples/s | 38.6 steps/s
[Step=20800 Epoch=197.9] | Loss=0.00133 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.461 | L2-Norm(final)=13.927 | 5444.8 samples/s | 85.1 steps/s
[Step=20850 Epoch=198.3] | Loss=0.00114 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.461 | L2-Norm(final)=13.927 | 2581.6 samples/s | 40.3 steps/s
[Step=20900 Epoch=198.8] | Loss=0.00100 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.460 | L2-Norm(final)=13.927 | 5037.9 samples/s | 78.7 steps/s
[Step=20950 Epoch=199.3] | Loss=0.00089 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.458 | L2-Norm(final)=13.928 | 2689.9 samples/s | 42.0 steps/s
[Step=21000 Epoch=199.8] | Loss=0.00080 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.455 | L2-Norm(final)=13.928 | 4677.3 samples/s | 73.1 steps/s
[Step=21050 Epoch=200.2] | Loss=0.00073 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.451 | L2-Norm(final)=13.928 | 2806.3 samples/s | 43.8 steps/s
[Step=21100 Epoch=200.7] | Loss=0.00067 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.447 | L2-Norm(final)=13.929 | 4607.4 samples/s | 72.0 steps/s
[Step=21150 Epoch=201.2] | Loss=0.00062 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.443 | L2-Norm(final)=13.929 | 2892.3 samples/s | 45.2 steps/s
[Step=21200 Epoch=201.7] | Loss=0.00058 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.438 | L2-Norm(final)=13.929 | 4574.9 samples/s | 71.5 steps/s
[Step=21250 Epoch=202.1] | Loss=0.00054 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=13.930 | 2850.9 samples/s | 44.5 steps/s
[Step=21300 Epoch=202.6] | Loss=0.00050 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.428 | L2-Norm(final)=13.930 | 4592.7 samples/s | 71.8 steps/s
[Step=21350 Epoch=203.1] | Loss=0.00048 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.423 | L2-Norm(final)=13.930 | 2955.5 samples/s | 46.2 steps/s
[Step=21400 Epoch=203.6] | Loss=0.00045 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.418 | L2-Norm(final)=13.930 | 4297.6 samples/s | 67.2 steps/s
[Step=21450 Epoch=204.0] | Loss=0.00043 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=13.931 | 6653.1 samples/s | 104.0 steps/s
[Step=21500 Epoch=204.5] | Loss=0.00040 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=13.931 | 2375.3 samples/s | 37.1 steps/s
[Step=21550 Epoch=205.0] | Loss=0.00039 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.402 | L2-Norm(final)=13.931 | 6036.8 samples/s | 94.3 steps/s
[Step=21600 Epoch=205.5] | Loss=0.00037 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.396 | L2-Norm(final)=13.932 | 2472.5 samples/s | 38.6 steps/s
[Step=21650 Epoch=205.9] | Loss=0.00035 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.391 | L2-Norm(final)=13.932 | 5623.5 samples/s | 87.9 steps/s
[Step=21700 Epoch=206.4] | Loss=0.00034 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.385 | L2-Norm(final)=13.932 | 2512.4 samples/s | 39.3 steps/s
[Step=21750 Epoch=206.9] | Loss=0.00032 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.379 | L2-Norm(final)=13.933 | 5179.9 samples/s | 80.9 steps/s
[Step=21800 Epoch=207.4] | Loss=0.00031 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.373 | L2-Norm(final)=13.933 | 2646.7 samples/s | 41.4 steps/s
[Step=21850 Epoch=207.8] | Loss=0.00030 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=13.933 | 4846.2 samples/s | 75.7 steps/s
[Step=21900 Epoch=208.3] | Loss=0.00029 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.362 | L2-Norm(final)=13.933 | 2743.7 samples/s | 42.9 steps/s
[Step=21950 Epoch=208.8] | Loss=0.00028 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.356 | L2-Norm(final)=13.934 | 4606.3 samples/s | 72.0 steps/s
[Step=22000 Epoch=209.3] | Loss=0.00027 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=13.934 | 2843.9 samples/s | 44.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step22000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=210.1] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=13.052 | 6908.7 samples/s | 107.9 steps/s
[Step=22050 Epoch=210.6] | Loss=0.00083 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.063 | 4591.9 samples/s | 71.7 steps/s
[Step=22100 Epoch=211.0] | Loss=0.00106 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.080 | 8082.0 samples/s | 126.3 steps/s
[Step=22150 Epoch=211.5] | Loss=0.00109 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.093 | 2553.1 samples/s | 39.9 steps/s
[Step=22200 Epoch=212.0] | Loss=0.00103 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.107 | 7278.1 samples/s | 113.7 steps/s
[Step=22250 Epoch=212.5] | Loss=0.00107 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.118 | 2633.6 samples/s | 41.2 steps/s
[Step=22300 Epoch=213.0] | Loss=0.00102 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.130 | 6930.5 samples/s | 108.3 steps/s
[Step=22350 Epoch=213.4] | Loss=0.00103 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.140 | 2734.1 samples/s | 42.7 steps/s
[Step=22400 Epoch=213.9] | Loss=0.00096 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.150 | 6279.7 samples/s | 98.1 steps/s
[Step=22450 Epoch=214.4] | Loss=0.00095 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.160 | 2904.8 samples/s | 45.4 steps/s
[Step=22500 Epoch=214.9] | Loss=0.00100 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.170 | 5608.9 samples/s | 87.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=214.9] | Loss=0.00007 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.272 | 7481.8 samples/s | 116.9 steps/s
[Step=22550 Epoch=215.3] | Loss=0.00117 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.298 | L2-Norm(final)=13.278 | 3892.3 samples/s | 60.8 steps/s
[Step=22600 Epoch=215.8] | Loss=0.00192 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.351 | L2-Norm(final)=13.278 | 6627.7 samples/s | 103.6 steps/s
[Step=22650 Epoch=216.3] | Loss=0.00160 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.391 | L2-Norm(final)=13.278 | 2371.7 samples/s | 37.1 steps/s
[Step=22700 Epoch=216.8] | Loss=0.00129 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.411 | L2-Norm(final)=13.277 | 6085.0 samples/s | 95.1 steps/s
[Step=22750 Epoch=217.2] | Loss=0.00104 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.420 | L2-Norm(final)=13.278 | 2451.7 samples/s | 38.3 steps/s
[Step=22800 Epoch=217.7] | Loss=0.00087 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=13.278 | 5643.2 samples/s | 88.2 steps/s
[Step=22850 Epoch=218.2] | Loss=0.00075 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=13.278 | 2527.2 samples/s | 39.5 steps/s
[Step=22900 Epoch=218.7] | Loss=0.00066 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=13.279 | 5309.5 samples/s | 83.0 steps/s
[Step=22950 Epoch=219.2] | Loss=0.00058 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.421 | L2-Norm(final)=13.279 | 2634.6 samples/s | 41.2 steps/s
[Step=23000 Epoch=219.6] | Loss=0.00053 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.418 | L2-Norm(final)=13.280 | 4862.0 samples/s | 76.0 steps/s
[Step=23050 Epoch=220.1] | Loss=0.00048 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=13.280 | 2715.5 samples/s | 42.4 steps/s
[Step=23100 Epoch=220.6] | Loss=0.00044 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.409 | L2-Norm(final)=13.280 | 4653.5 samples/s | 72.7 steps/s
[Step=23150 Epoch=221.1] | Loss=0.00041 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.404 | L2-Norm(final)=13.280 | 2822.5 samples/s | 44.1 steps/s
[Step=23200 Epoch=221.5] | Loss=0.00038 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.399 | L2-Norm(final)=13.281 | 4479.3 samples/s | 70.0 steps/s
[Step=23250 Epoch=222.0] | Loss=0.00035 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.394 | L2-Norm(final)=13.281 | 2847.9 samples/s | 44.5 steps/s
[Step=23300 Epoch=222.5] | Loss=0.00033 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.388 | L2-Norm(final)=13.281 | 4521.0 samples/s | 70.6 steps/s
[Step=23350 Epoch=223.0] | Loss=0.00031 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.383 | L2-Norm(final)=13.282 | 2839.8 samples/s | 44.4 steps/s
[Step=23400 Epoch=223.5] | Loss=0.00029 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.377 | L2-Norm(final)=13.282 | 4564.4 samples/s | 71.3 steps/s
[Step=23450 Epoch=223.9] | Loss=0.00028 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.371 | L2-Norm(final)=13.282 | 2850.8 samples/s | 44.5 steps/s
[Step=23500 Epoch=224.4] | Loss=0.00026 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.365 | L2-Norm(final)=13.282 | 4576.5 samples/s | 71.5 steps/s
[Step=23550 Epoch=224.9] | Loss=0.00025 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.359 | L2-Norm(final)=13.283 | 7249.6 samples/s | 113.3 steps/s
[Step=23600 Epoch=225.4] | Loss=0.00024 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=13.283 | 2300.7 samples/s | 35.9 steps/s
[Step=23650 Epoch=225.8] | Loss=0.00023 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.347 | L2-Norm(final)=13.283 | 6624.8 samples/s | 103.5 steps/s
[Step=23700 Epoch=226.3] | Loss=0.00022 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=13.283 | 2387.1 samples/s | 37.3 steps/s
[Step=23750 Epoch=226.8] | Loss=0.00021 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.334 | L2-Norm(final)=13.284 | 6151.3 samples/s | 96.1 steps/s
[Step=23800 Epoch=227.3] | Loss=0.00020 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.328 | L2-Norm(final)=13.284 | 2445.8 samples/s | 38.2 steps/s
[Step=23850 Epoch=227.8] | Loss=0.00020 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.322 | L2-Norm(final)=13.284 | 5699.9 samples/s | 89.1 steps/s
[Step=23900 Epoch=228.2] | Loss=0.00019 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=13.284 | 2523.2 samples/s | 39.4 steps/s
[Step=23950 Epoch=228.7] | Loss=0.00018 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.309 | L2-Norm(final)=13.285 | 5234.7 samples/s | 81.8 steps/s
[Step=24000 Epoch=229.2] | Loss=0.00018 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=13.285 | 2627.2 samples/s | 41.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step24000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=247.8] | Loss=0.00320 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=14.610 | 6551.6 samples/s | 102.4 steps/s
[Step=26050 Epoch=248.3] | Loss=0.00271 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=14.629 | 4630.7 samples/s | 72.4 steps/s
[Step=26100 Epoch=248.8] | Loss=0.00239 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=14.653 | 8280.7 samples/s | 129.4 steps/s
[Step=26150 Epoch=249.2] | Loss=0.00240 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=14.674 | 2552.8 samples/s | 39.9 steps/s
[Step=26200 Epoch=249.7] | Loss=0.00230 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=14.694 | 7462.0 samples/s | 116.6 steps/s
[Step=26250 Epoch=250.2] | Loss=0.00228 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.282 | L2-Norm(final)=14.713 | 2641.9 samples/s | 41.3 steps/s
[Step=26300 Epoch=250.7] | Loss=0.00224 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=14.733 | 6657.9 samples/s | 104.0 steps/s
[Step=26350 Epoch=251.1] | Loss=0.00222 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=14.752 | 2745.4 samples/s | 42.9 steps/s
[Step=26400 Epoch=251.6] | Loss=0.00222 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=14.770 | 6232.5 samples/s | 97.4 steps/s
[Step=26450 Epoch=252.1] | Loss=0.00223 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=14.788 | 2831.0 samples/s | 44.2 steps/s
[Step=26500 Epoch=252.6] | Loss=0.00221 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=14.806 | 5779.6 samples/s | 90.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=252.6] | Loss=0.00155 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=14.980 | 6835.4 samples/s | 106.8 steps/s
[Step=26550 Epoch=253.0] | Loss=0.00193 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.348 | L2-Norm(final)=14.987 | 4087.5 samples/s | 63.9 steps/s
[Step=26600 Epoch=253.5] | Loss=0.00245 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=14.984 | 6665.0 samples/s | 104.1 steps/s
[Step=26650 Epoch=254.0] | Loss=0.00173 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.447 | L2-Norm(final)=14.983 | 2394.2 samples/s | 37.4 steps/s
[Step=26700 Epoch=254.5] | Loss=0.00133 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.461 | L2-Norm(final)=14.982 | 5987.3 samples/s | 93.6 steps/s
[Step=26750 Epoch=255.0] | Loss=0.00106 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.467 | L2-Norm(final)=14.983 | 2442.1 samples/s | 38.2 steps/s
[Step=26800 Epoch=255.4] | Loss=0.00089 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.468 | L2-Norm(final)=14.983 | 5706.4 samples/s | 89.2 steps/s
[Step=26850 Epoch=255.9] | Loss=0.00076 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.466 | L2-Norm(final)=14.984 | 2539.5 samples/s | 39.7 steps/s
[Step=26900 Epoch=256.4] | Loss=0.00067 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.463 | L2-Norm(final)=14.984 | 5268.0 samples/s | 82.3 steps/s
[Step=26950 Epoch=256.9] | Loss=0.00060 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.459 | L2-Norm(final)=14.985 | 2634.1 samples/s | 41.2 steps/s
[Step=27000 Epoch=257.3] | Loss=0.00054 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.454 | L2-Norm(final)=14.985 | 4788.8 samples/s | 74.8 steps/s
[Step=27050 Epoch=257.8] | Loss=0.00049 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=14.985 | 2724.9 samples/s | 42.6 steps/s
[Step=27100 Epoch=258.3] | Loss=0.00045 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.443 | L2-Norm(final)=14.986 | 4594.4 samples/s | 71.8 steps/s
[Step=27150 Epoch=258.8] | Loss=0.00041 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.437 | L2-Norm(final)=14.986 | 2811.6 samples/s | 43.9 steps/s
[Step=27200 Epoch=259.2] | Loss=0.00039 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.431 | L2-Norm(final)=14.986 | 4547.2 samples/s | 71.0 steps/s
[Step=27250 Epoch=259.7] | Loss=0.00036 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=14.987 | 2846.0 samples/s | 44.5 steps/s
[Step=27300 Epoch=260.2] | Loss=0.00034 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.418 | L2-Norm(final)=14.987 | 4549.6 samples/s | 71.1 steps/s
[Step=27350 Epoch=260.7] | Loss=0.00032 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.411 | L2-Norm(final)=14.988 | 2831.5 samples/s | 44.2 steps/s
[Step=27400 Epoch=261.1] | Loss=0.00030 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=14.988 | 4538.2 samples/s | 70.9 steps/s
[Step=27450 Epoch=261.6] | Loss=0.00029 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.398 | L2-Norm(final)=14.988 | 2841.6 samples/s | 44.4 steps/s
[Step=27500 Epoch=262.1] | Loss=0.00027 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.391 | L2-Norm(final)=14.988 | 4588.7 samples/s | 71.7 steps/s
[Step=27550 Epoch=262.6] | Loss=0.00026 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.384 | L2-Norm(final)=14.989 | 7283.9 samples/s | 113.8 steps/s
[Step=27600 Epoch=263.1] | Loss=0.00025 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.377 | L2-Norm(final)=14.989 | 2294.5 samples/s | 35.9 steps/s
[Step=27650 Epoch=263.5] | Loss=0.00024 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=14.989 | 6712.5 samples/s | 104.9 steps/s
[Step=27700 Epoch=264.0] | Loss=0.00023 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.363 | L2-Norm(final)=14.990 | 2368.9 samples/s | 37.0 steps/s
[Step=27750 Epoch=264.5] | Loss=0.00022 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.356 | L2-Norm(final)=14.990 | 6155.9 samples/s | 96.2 steps/s
[Step=27800 Epoch=265.0] | Loss=0.00021 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=14.990 | 2463.2 samples/s | 38.5 steps/s
[Step=27850 Epoch=265.4] | Loss=0.00020 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=14.991 | 5558.0 samples/s | 86.8 steps/s
[Step=27900 Epoch=265.9] | Loss=0.00019 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.334 | L2-Norm(final)=14.991 | 2508.1 samples/s | 39.2 steps/s
[Step=27950 Epoch=266.4] | Loss=0.00019 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=14.991 | 5280.0 samples/s | 82.5 steps/s
[Step=28000 Epoch=266.9] | Loss=0.00018 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.319 | L2-Norm(final)=14.991 | 2654.7 samples/s | 41.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09522 | acc=0.9599 | tpr=0.9742 | fpr=0.0711 | 5727.5 samples/s | 22.4 steps/s
Avg test loss: 0.10371, Avg test acc: 0.95765, Avg tpr: 0.97196, Avg fpr: 0.07384, total FA: 576

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10313 | acc=0.9586 | tpr=0.9777 | fpr=0.0830 | 6078.9 samples/s | 23.7 steps/s
Avg test loss: 0.10586, Avg test acc: 0.95773, Avg tpr: 0.97616, Avg fpr: 0.08281, total FA: 646

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.10244 | acc=0.9584 | tpr=0.9759 | fpr=0.0798 | 6034.9 samples/s | 23.6 steps/s
Avg test loss: 0.10283, Avg test acc: 0.95757, Avg tpr: 0.97494, Avg fpr: 0.08063, total FA: 629

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09808 | acc=0.9580 | tpr=0.9767 | fpr=0.0825 | 5881.8 samples/s | 23.0 steps/s
Avg test loss: 0.10399, Avg test acc: 0.95649, Avg tpr: 0.97570, Avg fpr: 0.08576, total FA: 669

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10479 | acc=0.9598 | tpr=0.9748 | fpr=0.0728 | 5897.4 samples/s | 23.0 steps/s
Avg test loss: 0.10949, Avg test acc: 0.95877, Avg tpr: 0.97383, Avg fpr: 0.07435, total FA: 580

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.30578 | acc=0.2991 | tpr=0.0272 | fpr=0.1105 | 5865.7 samples/s | 22.9 steps/s
Avg test loss: 6.31301, Avg test acc: 0.29754, Avg tpr: 0.02664, Avg fpr: 0.10665, total FA: 832

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.16187 | acc=0.3052 | tpr=0.0219 | fpr=0.0798 | 6085.3 samples/s | 23.8 steps/s
Avg test loss: 5.17438, Avg test acc: 0.30171, Avg tpr: 0.02151, Avg fpr: 0.08204, total FA: 640

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.40348 | acc=0.2726 | tpr=0.0210 | fpr=0.1811 | 6020.7 samples/s | 23.5 steps/s
Avg test loss: 5.40579, Avg test acc: 0.27049, Avg tpr: 0.02087, Avg fpr: 0.18049, total FA: 1408

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.77238 | acc=0.2818 | tpr=0.0268 | fpr=0.1645 | 6014.3 samples/s | 23.5 steps/s
Avg test loss: 5.77930, Avg test acc: 0.28019, Avg tpr: 0.02483, Avg fpr: 0.15818, total FA: 1234

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.30269 | acc=0.3032 | tpr=0.0195 | fpr=0.0808 | 6064.8 samples/s | 23.7 steps/s
Avg test loss: 5.31268, Avg test acc: 0.30147, Avg tpr: 0.01988, Avg fpr: 0.07922, total FA: 618

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.92574 | acc=0.1253 | tpr=0.6858 | fpr=0.8848 | 6084.4 samples/s | 23.8 steps/s
[Step= 100] | Loss=5.90523 | acc=0.1275 | tpr=0.6610 | fpr=0.8825 | 7553.3 samples/s | 29.5 steps/s
[Step= 150] | Loss=5.90045 | acc=0.1299 | tpr=0.6772 | fpr=0.8802 | 7538.6 samples/s | 29.4 steps/s
[Step= 200] | Loss=5.89346 | acc=0.1307 | tpr=0.6842 | fpr=0.8794 | 7873.6 samples/s | 30.8 steps/s
[Step= 250] | Loss=5.89752 | acc=0.1303 | tpr=0.6760 | fpr=0.8796 | 8185.7 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.88789 | acc=0.1304 | tpr=0.6735 | fpr=0.8795 | 8020.3 samples/s | 31.3 steps/s
[Step= 350] | Loss=5.89367 | acc=0.1300 | tpr=0.6719 | fpr=0.8798 | 8710.0 samples/s | 34.0 steps/s
[Step= 400] | Loss=5.89047 | acc=0.1302 | tpr=0.6707 | fpr=0.8796 | 8412.0 samples/s | 32.9 steps/s
[Step= 450] | Loss=5.89556 | acc=0.1295 | tpr=0.6723 | fpr=0.8804 | 8339.9 samples/s | 32.6 steps/s
[Step= 500] | Loss=5.89616 | acc=0.1293 | tpr=0.6736 | fpr=0.8805 | 5391.2 samples/s | 21.1 steps/s
[Step= 550] | Loss=5.89932 | acc=0.1294 | tpr=0.6757 | fpr=0.8805 | 11425.5 samples/s | 44.6 steps/s
Avg test loss: 5.89965, Avg test acc: 0.12935, Avg tpr: 0.67670, Avg fpr: 0.88060, total FA: 122270

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.26894 | acc=0.1295 | tpr=0.6770 | fpr=0.8804 | 5501.0 samples/s | 21.5 steps/s
[Step= 100] | Loss=5.24619 | acc=0.1329 | tpr=0.6780 | fpr=0.8772 | 8404.5 samples/s | 32.8 steps/s
[Step= 150] | Loss=5.24384 | acc=0.1343 | tpr=0.6916 | fpr=0.8759 | 8644.0 samples/s | 33.8 steps/s
[Step= 200] | Loss=5.23907 | acc=0.1342 | tpr=0.6852 | fpr=0.8759 | 8159.0 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.24345 | acc=0.1342 | tpr=0.6803 | fpr=0.8758 | 7731.4 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.23932 | acc=0.1338 | tpr=0.6742 | fpr=0.8760 | 8261.5 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.24712 | acc=0.1337 | tpr=0.6675 | fpr=0.8760 | 7979.7 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.24619 | acc=0.1338 | tpr=0.6674 | fpr=0.8759 | 7677.3 samples/s | 30.0 steps/s
[Step= 450] | Loss=5.24948 | acc=0.1333 | tpr=0.6704 | fpr=0.8765 | 6739.4 samples/s | 26.3 steps/s
[Step= 500] | Loss=5.25040 | acc=0.1330 | tpr=0.6722 | fpr=0.8768 | 6918.6 samples/s | 27.0 steps/s
[Step= 550] | Loss=5.25397 | acc=0.1333 | tpr=0.6733 | fpr=0.8766 | 10886.2 samples/s | 42.5 steps/s
Avg test loss: 5.25439, Avg test acc: 0.13315, Avg tpr: 0.67353, Avg fpr: 0.87667, total FA: 121724

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.49032 | acc=0.1166 | tpr=0.6814 | fpr=0.8935 | 5898.8 samples/s | 23.0 steps/s
[Step= 100] | Loss=5.47987 | acc=0.1167 | tpr=0.6716 | fpr=0.8936 | 8175.1 samples/s | 31.9 steps/s
[Step= 150] | Loss=5.47208 | acc=0.1179 | tpr=0.6715 | fpr=0.8923 | 8026.1 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.46492 | acc=0.1181 | tpr=0.6612 | fpr=0.8918 | 7331.5 samples/s | 28.6 steps/s
[Step= 250] | Loss=5.47103 | acc=0.1179 | tpr=0.6550 | fpr=0.8919 | 8026.2 samples/s | 31.4 steps/s
[Step= 300] | Loss=5.46591 | acc=0.1175 | tpr=0.6531 | fpr=0.8923 | 7773.8 samples/s | 30.4 steps/s
[Step= 350] | Loss=5.47491 | acc=0.1173 | tpr=0.6512 | fpr=0.8924 | 8487.6 samples/s | 33.2 steps/s
[Step= 400] | Loss=5.47284 | acc=0.1174 | tpr=0.6532 | fpr=0.8923 | 8377.5 samples/s | 32.7 steps/s
[Step= 450] | Loss=5.47777 | acc=0.1170 | tpr=0.6577 | fpr=0.8928 | 6160.7 samples/s | 24.1 steps/s
[Step= 500] | Loss=5.47702 | acc=0.1169 | tpr=0.6568 | fpr=0.8928 | 8027.7 samples/s | 31.4 steps/s
[Step= 550] | Loss=5.48081 | acc=0.1170 | tpr=0.6570 | fpr=0.8928 | 10969.2 samples/s | 42.8 steps/s
Avg test loss: 5.48130, Avg test acc: 0.11688, Avg tpr: 0.65848, Avg fpr: 0.89296, total FA: 123986

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.51370 | acc=0.1231 | tpr=0.7124 | fpr=0.8875 | 6053.0 samples/s | 23.6 steps/s
[Step= 100] | Loss=5.49380 | acc=0.1254 | tpr=0.6844 | fpr=0.8851 | 7600.8 samples/s | 29.7 steps/s
[Step= 150] | Loss=5.48351 | acc=0.1268 | tpr=0.6945 | fpr=0.8837 | 7307.4 samples/s | 28.5 steps/s
[Step= 200] | Loss=5.47890 | acc=0.1270 | tpr=0.6918 | fpr=0.8833 | 8488.1 samples/s | 33.2 steps/s
[Step= 250] | Loss=5.48056 | acc=0.1270 | tpr=0.6926 | fpr=0.8833 | 8466.4 samples/s | 33.1 steps/s
[Step= 300] | Loss=5.47693 | acc=0.1269 | tpr=0.6924 | fpr=0.8834 | 7913.8 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.48134 | acc=0.1266 | tpr=0.6957 | fpr=0.8837 | 8316.7 samples/s | 32.5 steps/s
[Step= 400] | Loss=5.47927 | acc=0.1268 | tpr=0.6942 | fpr=0.8835 | 8043.6 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.48405 | acc=0.1261 | tpr=0.6972 | fpr=0.8843 | 6456.6 samples/s | 25.2 steps/s
[Step= 500] | Loss=5.48288 | acc=0.1261 | tpr=0.6991 | fpr=0.8842 | 8174.7 samples/s | 31.9 steps/s
[Step= 550] | Loss=5.48948 | acc=0.1262 | tpr=0.6988 | fpr=0.8842 | 10878.9 samples/s | 42.5 steps/s
Avg test loss: 5.49069, Avg test acc: 0.12609, Avg tpr: 0.69929, Avg fpr: 0.88433, total FA: 122787

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.24820 | acc=0.1313 | tpr=0.6106 | fpr=0.8773 | 6142.3 samples/s | 24.0 steps/s
[Step= 100] | Loss=6.24351 | acc=0.1331 | tpr=0.6055 | fpr=0.8757 | 7288.8 samples/s | 28.5 steps/s
[Step= 150] | Loss=6.23182 | acc=0.1346 | tpr=0.6182 | fpr=0.8743 | 7705.6 samples/s | 30.1 steps/s
[Step= 200] | Loss=6.23012 | acc=0.1345 | tpr=0.6077 | fpr=0.8741 | 8083.9 samples/s | 31.6 steps/s
[Step= 250] | Loss=6.23088 | acc=0.1342 | tpr=0.5983 | fpr=0.8743 | 7886.6 samples/s | 30.8 steps/s
[Step= 300] | Loss=6.22376 | acc=0.1341 | tpr=0.5927 | fpr=0.8742 | 8174.0 samples/s | 31.9 steps/s
[Step= 350] | Loss=6.23429 | acc=0.1336 | tpr=0.5936 | fpr=0.8748 | 8154.4 samples/s | 31.9 steps/s
[Step= 400] | Loss=6.23120 | acc=0.1338 | tpr=0.5914 | fpr=0.8746 | 8328.4 samples/s | 32.5 steps/s
[Step= 450] | Loss=6.23621 | acc=0.1331 | tpr=0.5930 | fpr=0.8752 | 7847.5 samples/s | 30.7 steps/s
[Step= 500] | Loss=6.23512 | acc=0.1330 | tpr=0.5934 | fpr=0.8753 | 8498.7 samples/s | 33.2 steps/s
[Step= 550] | Loss=6.23887 | acc=0.1332 | tpr=0.5949 | fpr=0.8752 | 10260.2 samples/s | 40.1 steps/s
Avg test loss: 6.23985, Avg test acc: 0.13313, Avg tpr: 0.59588, Avg fpr: 0.87528, total FA: 121531

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.21215 | acc=0.9559 | tpr=0.9027 | fpr=0.0431 | 5800.3 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.21941 | acc=0.9559 | tpr=0.9275 | fpr=0.0436 | 7625.1 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.22337 | acc=0.9543 | tpr=0.9294 | fpr=0.0452 | 8523.4 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.22263 | acc=0.9539 | tpr=0.9322 | fpr=0.0457 | 8299.6 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.22266 | acc=0.9540 | tpr=0.9310 | fpr=0.0456 | 8048.1 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.22550 | acc=0.9536 | tpr=0.9324 | fpr=0.0460 | 8203.5 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.22442 | acc=0.9537 | tpr=0.9336 | fpr=0.0459 | 8198.6 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.22427 | acc=0.9536 | tpr=0.9294 | fpr=0.0459 | 5742.9 samples/s | 22.4 steps/s
[Step= 450] | Loss=0.22871 | acc=0.9530 | tpr=0.9260 | fpr=0.0465 | 7826.9 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.22865 | acc=0.9530 | tpr=0.9238 | fpr=0.0465 | 7961.6 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.22747 | acc=0.9533 | tpr=0.9232 | fpr=0.0462 | 10649.1 samples/s | 41.6 steps/s
Avg test loss: 0.22706, Avg test acc: 0.95332, Avg tpr: 0.92314, Avg fpr: 0.04613, total FA: 6405

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.18875 | acc=0.9555 | tpr=0.8938 | fpr=0.0434 | 5707.4 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.19408 | acc=0.9557 | tpr=0.9168 | fpr=0.0435 | 8587.4 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.19744 | acc=0.9541 | tpr=0.9222 | fpr=0.0453 | 8072.1 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.19825 | acc=0.9540 | tpr=0.9213 | fpr=0.0454 | 7992.1 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.19875 | acc=0.9539 | tpr=0.9214 | fpr=0.0455 | 8175.9 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.20067 | acc=0.9535 | tpr=0.9193 | fpr=0.0459 | 8255.0 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.19994 | acc=0.9537 | tpr=0.9211 | fpr=0.0457 | 8181.1 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.20021 | acc=0.9534 | tpr=0.9179 | fpr=0.0460 | 5633.7 samples/s | 22.0 steps/s
[Step= 450] | Loss=0.20368 | acc=0.9530 | tpr=0.9182 | fpr=0.0464 | 7847.6 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.20309 | acc=0.9529 | tpr=0.9189 | fpr=0.0465 | 8212.8 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.20155 | acc=0.9531 | tpr=0.9172 | fpr=0.0462 | 9890.1 samples/s | 38.6 steps/s
Avg test loss: 0.20130, Avg test acc: 0.95314, Avg tpr: 0.91719, Avg fpr: 0.04620, total FA: 6415

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.28214 | acc=0.9521 | tpr=0.9381 | fpr=0.0476 | 6061.9 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.28764 | acc=0.9507 | tpr=0.9403 | fpr=0.0491 | 7356.8 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.29107 | acc=0.9498 | tpr=0.9409 | fpr=0.0501 | 8323.2 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.29143 | acc=0.9497 | tpr=0.9454 | fpr=0.0502 | 8125.3 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.29062 | acc=0.9499 | tpr=0.9459 | fpr=0.0500 | 8143.9 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.29330 | acc=0.9497 | tpr=0.9433 | fpr=0.0501 | 7915.1 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.29042 | acc=0.9500 | tpr=0.9436 | fpr=0.0499 | 8027.4 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.29046 | acc=0.9496 | tpr=0.9398 | fpr=0.0502 | 5843.3 samples/s | 22.8 steps/s
[Step= 450] | Loss=0.29522 | acc=0.9491 | tpr=0.9391 | fpr=0.0508 | 8199.3 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.29549 | acc=0.9490 | tpr=0.9405 | fpr=0.0509 | 7400.5 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.29404 | acc=0.9492 | tpr=0.9399 | fpr=0.0506 | 10934.0 samples/s | 42.7 steps/s
Avg test loss: 0.29370, Avg test acc: 0.94925, Avg tpr: 0.93978, Avg fpr: 0.05058, total FA: 7023

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14615 | acc=0.9641 | tpr=0.9159 | fpr=0.0350 | 5978.1 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.15435 | acc=0.9620 | tpr=0.9275 | fpr=0.0374 | 8141.3 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.15528 | acc=0.9606 | tpr=0.9308 | fpr=0.0389 | 8105.3 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.15461 | acc=0.9607 | tpr=0.9322 | fpr=0.0388 | 7658.2 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.15451 | acc=0.9606 | tpr=0.9310 | fpr=0.0389 | 8370.6 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.15703 | acc=0.9601 | tpr=0.9302 | fpr=0.0394 | 8100.6 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.15603 | acc=0.9600 | tpr=0.9299 | fpr=0.0394 | 5667.7 samples/s | 22.1 steps/s
[Step= 400] | Loss=0.15575 | acc=0.9599 | tpr=0.9267 | fpr=0.0395 | 8074.4 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.15842 | acc=0.9595 | tpr=0.9265 | fpr=0.0399 | 8423.3 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.15850 | acc=0.9594 | tpr=0.9269 | fpr=0.0400 | 7930.5 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.15739 | acc=0.9597 | tpr=0.9276 | fpr=0.0397 | 9621.2 samples/s | 37.6 steps/s
Avg test loss: 0.15715, Avg test acc: 0.95969, Avg tpr: 0.92750, Avg fpr: 0.03972, total FA: 5515

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.22111 | acc=0.9572 | tpr=0.9115 | fpr=0.0420 | 6051.3 samples/s | 23.6 steps/s
[Step= 100] | Loss=0.22831 | acc=0.9556 | tpr=0.9318 | fpr=0.0440 | 7368.7 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.23129 | acc=0.9537 | tpr=0.9380 | fpr=0.0460 | 8048.2 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.23125 | acc=0.9535 | tpr=0.9410 | fpr=0.0463 | 8404.3 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.23271 | acc=0.9536 | tpr=0.9397 | fpr=0.0461 | 8234.4 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.23468 | acc=0.9533 | tpr=0.9375 | fpr=0.0464 | 7804.5 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.23362 | acc=0.9532 | tpr=0.9368 | fpr=0.0465 | 6072.7 samples/s | 23.7 steps/s
[Step= 400] | Loss=0.23383 | acc=0.9529 | tpr=0.9349 | fpr=0.0467 | 7972.7 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.23706 | acc=0.9526 | tpr=0.9318 | fpr=0.0470 | 8228.5 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.23698 | acc=0.9525 | tpr=0.9322 | fpr=0.0471 | 7591.6 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.23523 | acc=0.9528 | tpr=0.9308 | fpr=0.0468 | 10132.9 samples/s | 39.6 steps/s
Avg test loss: 0.23486, Avg test acc: 0.95283, Avg tpr: 0.93067, Avg fpr: 0.04676, total FA: 6493

server round 25/50

clients selected: [0 2 6 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.04737 | Reg=0.00127 | acc=0.9531 | L2-Norm=11.291 | L2-Norm(final)=11.332 | 6901.8 samples/s | 107.8 steps/s
[Step=20050 Epoch=97.8] | Loss=0.03276 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.291 | L2-Norm(final)=11.338 | 5062.4 samples/s | 79.1 steps/s
[Step=20100 Epoch=98.0] | Loss=0.02906 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.291 | L2-Norm(final)=11.342 | 5480.4 samples/s | 85.6 steps/s
[Step=20150 Epoch=98.3] | Loss=0.02918 | Reg=0.00127 | acc=0.9375 | L2-Norm=11.291 | L2-Norm(final)=11.349 | 5575.5 samples/s | 87.1 steps/s
[Step=20200 Epoch=98.5] | Loss=0.02910 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.291 | L2-Norm(final)=11.356 | 8643.7 samples/s | 135.1 steps/s
[Step=20250 Epoch=98.7] | Loss=0.02976 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.291 | L2-Norm(final)=11.361 | 2656.0 samples/s | 41.5 steps/s
[Step=20300 Epoch=99.0] | Loss=0.02897 | Reg=0.00127 | acc=0.9531 | L2-Norm=11.291 | L2-Norm(final)=11.366 | 5490.9 samples/s | 85.8 steps/s
[Step=20350 Epoch=99.2] | Loss=0.02853 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.291 | L2-Norm(final)=11.372 | 5512.9 samples/s | 86.1 steps/s
[Step=20400 Epoch=99.5] | Loss=0.02899 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.291 | L2-Norm(final)=11.378 | 7723.1 samples/s | 120.7 steps/s
[Step=20450 Epoch=99.7] | Loss=0.02930 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.291 | L2-Norm(final)=11.383 | 2790.8 samples/s | 43.6 steps/s
[Step=20500 Epoch=100.0] | Loss=0.02920 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.291 | L2-Norm(final)=11.388 | 5623.8 samples/s | 87.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=100.0] | Loss=0.07819 | Reg=0.00127 | acc=0.9375 | L2-Norm=11.291 | L2-Norm(final)=11.438 | 6904.9 samples/s | 107.9 steps/s
[Step=20550 Epoch=100.2] | Loss=0.03216 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.326 | L2-Norm(final)=11.435 | 4394.0 samples/s | 68.7 steps/s
[Step=20600 Epoch=100.4] | Loss=0.02969 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.374 | L2-Norm(final)=11.436 | 4766.7 samples/s | 74.5 steps/s
[Step=20650 Epoch=100.7] | Loss=0.02859 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.412 | L2-Norm(final)=11.436 | 4736.6 samples/s | 74.0 steps/s
[Step=20700 Epoch=100.9] | Loss=0.02596 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.444 | L2-Norm(final)=11.438 | 6849.8 samples/s | 107.0 steps/s
[Step=20750 Epoch=101.2] | Loss=0.02353 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.470 | L2-Norm(final)=11.441 | 2476.6 samples/s | 38.7 steps/s
[Step=20800 Epoch=101.4] | Loss=0.02108 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.490 | L2-Norm(final)=11.444 | 4895.7 samples/s | 76.5 steps/s
[Step=20850 Epoch=101.7] | Loss=0.01935 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.508 | L2-Norm(final)=11.448 | 4685.4 samples/s | 73.2 steps/s
[Step=20900 Epoch=101.9] | Loss=0.01781 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.522 | L2-Norm(final)=11.453 | 6205.2 samples/s | 97.0 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01678 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.535 | L2-Norm(final)=11.457 | 2565.1 samples/s | 40.1 steps/s
[Step=21000 Epoch=102.4] | Loss=0.01567 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.546 | L2-Norm(final)=11.461 | 4781.0 samples/s | 74.7 steps/s
[Step=21050 Epoch=102.6] | Loss=0.01477 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.556 | L2-Norm(final)=11.465 | 4738.3 samples/s | 74.0 steps/s
[Step=21100 Epoch=102.9] | Loss=0.01400 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.565 | L2-Norm(final)=11.468 | 5719.1 samples/s | 89.4 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01322 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.574 | L2-Norm(final)=11.472 | 2662.5 samples/s | 41.6 steps/s
[Step=21200 Epoch=103.4] | Loss=0.01261 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=11.476 | 4757.0 samples/s | 74.3 steps/s
[Step=21250 Epoch=103.6] | Loss=0.01208 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.589 | L2-Norm(final)=11.480 | 4740.6 samples/s | 74.1 steps/s
[Step=21300 Epoch=103.9] | Loss=0.01171 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.595 | L2-Norm(final)=11.483 | 5265.1 samples/s | 82.3 steps/s
[Step=21350 Epoch=104.1] | Loss=0.01129 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.486 | 2783.9 samples/s | 43.5 steps/s
[Step=21400 Epoch=104.4] | Loss=0.01101 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.607 | L2-Norm(final)=11.490 | 4777.9 samples/s | 74.7 steps/s
[Step=21450 Epoch=104.6] | Loss=0.01070 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.613 | L2-Norm(final)=11.492 | 4758.5 samples/s | 74.4 steps/s
[Step=21500 Epoch=104.8] | Loss=0.01033 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.618 | L2-Norm(final)=11.495 | 4847.5 samples/s | 75.7 steps/s
[Step=21550 Epoch=105.1] | Loss=0.01006 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.623 | L2-Norm(final)=11.498 | 2912.3 samples/s | 45.5 steps/s
[Step=21600 Epoch=105.3] | Loss=0.00982 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.628 | L2-Norm(final)=11.501 | 4751.9 samples/s | 74.2 steps/s
[Step=21650 Epoch=105.6] | Loss=0.00967 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.632 | L2-Norm(final)=11.504 | 4755.9 samples/s | 74.3 steps/s
[Step=21700 Epoch=105.8] | Loss=0.00936 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.637 | L2-Norm(final)=11.507 | 4751.0 samples/s | 74.2 steps/s
[Step=21750 Epoch=106.1] | Loss=0.00915 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.641 | L2-Norm(final)=11.510 | 2962.2 samples/s | 46.3 steps/s
[Step=21800 Epoch=106.3] | Loss=0.00901 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.645 | L2-Norm(final)=11.512 | 4684.1 samples/s | 73.2 steps/s
[Step=21850 Epoch=106.5] | Loss=0.00882 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.649 | L2-Norm(final)=11.515 | 4789.7 samples/s | 74.8 steps/s
[Step=21900 Epoch=106.8] | Loss=0.00862 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.652 | L2-Norm(final)=11.517 | 4722.8 samples/s | 73.8 steps/s
[Step=21950 Epoch=107.0] | Loss=0.00839 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.656 | L2-Norm(final)=11.520 | 2968.2 samples/s | 46.4 steps/s
[Step=22000 Epoch=107.3] | Loss=0.00824 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.659 | L2-Norm(final)=11.522 | 4667.9 samples/s | 72.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step22000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=107.2] | Loss=0.00372 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.291 | L2-Norm(final)=11.810 | 6663.3 samples/s | 104.1 steps/s
[Step=22050 Epoch=107.4] | Loss=0.03105 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.291 | L2-Norm(final)=11.818 | 5065.7 samples/s | 79.2 steps/s
[Step=22100 Epoch=107.7] | Loss=0.02920 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.292 | L2-Norm(final)=11.835 | 5577.2 samples/s | 87.1 steps/s
[Step=22150 Epoch=107.9] | Loss=0.02861 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.292 | L2-Norm(final)=11.853 | 5546.8 samples/s | 86.7 steps/s
[Step=22200 Epoch=108.2] | Loss=0.02981 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.292 | L2-Norm(final)=11.870 | 8514.1 samples/s | 133.0 steps/s
[Step=22250 Epoch=108.4] | Loss=0.02949 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.292 | L2-Norm(final)=11.884 | 2689.5 samples/s | 42.0 steps/s
[Step=22300 Epoch=108.7] | Loss=0.02875 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.292 | L2-Norm(final)=11.899 | 5600.5 samples/s | 87.5 steps/s
[Step=22350 Epoch=108.9] | Loss=0.02914 | Reg=0.00128 | acc=0.9375 | L2-Norm=11.292 | L2-Norm(final)=11.913 | 5514.5 samples/s | 86.2 steps/s
[Step=22400 Epoch=109.1] | Loss=0.02906 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.292 | L2-Norm(final)=11.926 | 7700.8 samples/s | 120.3 steps/s
[Step=22450 Epoch=109.4] | Loss=0.02894 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.292 | L2-Norm(final)=11.939 | 2773.8 samples/s | 43.3 steps/s
[Step=22500 Epoch=109.6] | Loss=0.02880 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.292 | L2-Norm(final)=11.952 | 5581.3 samples/s | 87.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=109.6] | Loss=0.01604 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.292 | L2-Norm(final)=12.082 | 7365.0 samples/s | 115.1 steps/s
[Step=22550 Epoch=109.9] | Loss=0.03230 | Reg=0.00128 | acc=0.9531 | L2-Norm=11.333 | L2-Norm(final)=12.085 | 4181.9 samples/s | 65.3 steps/s
[Step=22600 Epoch=110.1] | Loss=0.03012 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=12.082 | 4893.8 samples/s | 76.5 steps/s
[Step=22650 Epoch=110.4] | Loss=0.02939 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.404 | L2-Norm(final)=12.082 | 4653.0 samples/s | 72.7 steps/s
[Step=22700 Epoch=110.6] | Loss=0.02586 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=12.083 | 6852.4 samples/s | 107.1 steps/s
[Step=22750 Epoch=110.8] | Loss=0.02297 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.448 | L2-Norm(final)=12.086 | 2479.8 samples/s | 38.7 steps/s
[Step=22800 Epoch=111.1] | Loss=0.02048 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.465 | L2-Norm(final)=12.090 | 4775.8 samples/s | 74.6 steps/s
[Step=22850 Epoch=111.3] | Loss=0.01903 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.480 | L2-Norm(final)=12.094 | 4709.8 samples/s | 73.6 steps/s
[Step=22900 Epoch=111.6] | Loss=0.01792 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.493 | L2-Norm(final)=12.097 | 6262.0 samples/s | 97.8 steps/s
[Step=22950 Epoch=111.8] | Loss=0.01675 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.505 | L2-Norm(final)=12.101 | 2566.3 samples/s | 40.1 steps/s
[Step=23000 Epoch=112.1] | Loss=0.01571 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.516 | L2-Norm(final)=12.105 | 4752.7 samples/s | 74.3 steps/s
[Step=23050 Epoch=112.3] | Loss=0.01499 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.526 | L2-Norm(final)=12.108 | 4788.7 samples/s | 74.8 steps/s
[Step=23100 Epoch=112.6] | Loss=0.01415 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.535 | L2-Norm(final)=12.112 | 5666.8 samples/s | 88.5 steps/s
[Step=23150 Epoch=112.8] | Loss=0.01357 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.543 | L2-Norm(final)=12.115 | 2648.5 samples/s | 41.4 steps/s
[Step=23200 Epoch=113.0] | Loss=0.01293 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.551 | L2-Norm(final)=12.118 | 4814.8 samples/s | 75.2 steps/s
[Step=23250 Epoch=113.3] | Loss=0.01245 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.558 | L2-Norm(final)=12.122 | 4704.4 samples/s | 73.5 steps/s
[Step=23300 Epoch=113.5] | Loss=0.01203 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.565 | L2-Norm(final)=12.125 | 5288.3 samples/s | 82.6 steps/s
[Step=23350 Epoch=113.8] | Loss=0.01172 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.571 | L2-Norm(final)=12.128 | 2768.3 samples/s | 43.3 steps/s
[Step=23400 Epoch=114.0] | Loss=0.01136 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.577 | L2-Norm(final)=12.131 | 4788.4 samples/s | 74.8 steps/s
[Step=23450 Epoch=114.3] | Loss=0.01094 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.583 | L2-Norm(final)=12.133 | 4838.5 samples/s | 75.6 steps/s
[Step=23500 Epoch=114.5] | Loss=0.01074 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.588 | L2-Norm(final)=12.136 | 4831.7 samples/s | 75.5 steps/s
[Step=23550 Epoch=114.7] | Loss=0.01038 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.593 | L2-Norm(final)=12.138 | 2086.9 samples/s | 32.6 steps/s
[Step=23600 Epoch=115.0] | Loss=0.01003 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.598 | L2-Norm(final)=12.141 | 4815.1 samples/s | 75.2 steps/s
[Step=23650 Epoch=115.2] | Loss=0.00974 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.602 | L2-Norm(final)=12.144 | 4617.3 samples/s | 72.1 steps/s
[Step=23700 Epoch=115.5] | Loss=0.00947 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.606 | L2-Norm(final)=12.146 | 4767.4 samples/s | 74.5 steps/s
[Step=23750 Epoch=115.7] | Loss=0.00927 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.610 | L2-Norm(final)=12.149 | 2902.3 samples/s | 45.3 steps/s
[Step=23800 Epoch=116.0] | Loss=0.00908 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.614 | L2-Norm(final)=12.152 | 4740.6 samples/s | 74.1 steps/s
[Step=23850 Epoch=116.2] | Loss=0.00885 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.618 | L2-Norm(final)=12.154 | 4772.9 samples/s | 74.6 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00869 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=12.156 | 4806.9 samples/s | 75.1 steps/s
[Step=23950 Epoch=116.7] | Loss=0.00854 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.625 | L2-Norm(final)=12.159 | 2937.1 samples/s | 45.9 steps/s
[Step=24000 Epoch=116.9] | Loss=0.00834 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.628 | L2-Norm(final)=12.161 | 4816.8 samples/s | 75.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step24000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=209.3] | Loss=0.00148 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.291 | L2-Norm(final)=13.943 | 7101.4 samples/s | 111.0 steps/s
[Step=22050 Epoch=209.8] | Loss=0.00118 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.289 | L2-Norm(final)=13.954 | 4550.4 samples/s | 71.1 steps/s
[Step=22100 Epoch=210.2] | Loss=0.00129 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=13.965 | 8235.8 samples/s | 128.7 steps/s
[Step=22150 Epoch=210.7] | Loss=0.00119 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=13.976 | 2568.6 samples/s | 40.1 steps/s
[Step=22200 Epoch=211.2] | Loss=0.00126 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=13.988 | 7341.1 samples/s | 114.7 steps/s
[Step=22250 Epoch=211.7] | Loss=0.00133 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=13.999 | 2685.7 samples/s | 42.0 steps/s
[Step=22300 Epoch=212.1] | Loss=0.00128 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=14.010 | 6493.2 samples/s | 101.5 steps/s
[Step=22350 Epoch=212.6] | Loss=0.00123 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=14.022 | 2810.0 samples/s | 43.9 steps/s
[Step=22400 Epoch=213.1] | Loss=0.00123 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=14.033 | 5829.6 samples/s | 91.1 steps/s
[Step=22450 Epoch=213.6] | Loss=0.00125 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=14.044 | 2892.4 samples/s | 45.2 steps/s
[Step=22500 Epoch=214.0] | Loss=0.00122 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=14.055 | 5427.8 samples/s | 84.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=214.0] | Loss=0.00141 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=14.165 | 7075.8 samples/s | 110.6 steps/s
[Step=22550 Epoch=214.5] | Loss=0.00077 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.307 | L2-Norm(final)=14.171 | 4068.0 samples/s | 63.6 steps/s
[Step=22600 Epoch=215.0] | Loss=0.00083 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.320 | L2-Norm(final)=14.174 | 6411.3 samples/s | 100.2 steps/s
[Step=22650 Epoch=215.5] | Loss=0.00114 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.330 | L2-Norm(final)=14.175 | 2382.3 samples/s | 37.2 steps/s
[Step=22700 Epoch=215.9] | Loss=0.00088 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.333 | L2-Norm(final)=14.174 | 6013.0 samples/s | 94.0 steps/s
[Step=22750 Epoch=216.4] | Loss=0.00071 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.332 | L2-Norm(final)=14.175 | 2477.3 samples/s | 38.7 steps/s
[Step=22800 Epoch=216.9] | Loss=0.00060 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.329 | L2-Norm(final)=14.175 | 5495.1 samples/s | 85.9 steps/s
[Step=22850 Epoch=217.4] | Loss=0.00051 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.324 | L2-Norm(final)=14.176 | 2566.0 samples/s | 40.1 steps/s
[Step=22900 Epoch=217.8] | Loss=0.00045 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.318 | L2-Norm(final)=14.176 | 5056.4 samples/s | 79.0 steps/s
[Step=22950 Epoch=218.3] | Loss=0.00040 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.311 | L2-Norm(final)=14.177 | 2686.6 samples/s | 42.0 steps/s
[Step=23000 Epoch=218.8] | Loss=0.00036 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.304 | L2-Norm(final)=14.178 | 4658.9 samples/s | 72.8 steps/s
[Step=23050 Epoch=219.3] | Loss=0.00033 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.297 | L2-Norm(final)=14.178 | 2785.7 samples/s | 43.5 steps/s
[Step=23100 Epoch=219.7] | Loss=0.00030 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.289 | L2-Norm(final)=14.179 | 4556.4 samples/s | 71.2 steps/s
[Step=23150 Epoch=220.2] | Loss=0.00028 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=14.180 | 2829.7 samples/s | 44.2 steps/s
[Step=23200 Epoch=220.7] | Loss=0.00026 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.274 | L2-Norm(final)=14.180 | 4567.2 samples/s | 71.4 steps/s
[Step=23250 Epoch=221.2] | Loss=0.00024 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.266 | L2-Norm(final)=14.181 | 2884.6 samples/s | 45.1 steps/s
[Step=23300 Epoch=221.6] | Loss=0.00023 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.258 | L2-Norm(final)=14.181 | 4542.2 samples/s | 71.0 steps/s
[Step=23350 Epoch=222.1] | Loss=0.00022 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.249 | L2-Norm(final)=14.182 | 2978.4 samples/s | 46.5 steps/s
[Step=23400 Epoch=222.6] | Loss=0.00020 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.241 | L2-Norm(final)=14.182 | 4304.2 samples/s | 67.3 steps/s
[Step=23450 Epoch=223.1] | Loss=0.00019 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.233 | L2-Norm(final)=14.183 | 6859.2 samples/s | 107.2 steps/s
[Step=23500 Epoch=223.5] | Loss=0.00018 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=14.183 | 2382.4 samples/s | 37.2 steps/s
[Step=23550 Epoch=224.0] | Loss=0.00018 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.216 | L2-Norm(final)=14.184 | 6089.7 samples/s | 95.2 steps/s
[Step=23600 Epoch=224.5] | Loss=0.00017 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.207 | L2-Norm(final)=14.185 | 2451.4 samples/s | 38.3 steps/s
[Step=23650 Epoch=225.0] | Loss=0.00016 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.199 | L2-Norm(final)=14.185 | 5693.5 samples/s | 89.0 steps/s
[Step=23700 Epoch=225.4] | Loss=0.00015 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=14.186 | 2548.3 samples/s | 39.8 steps/s
[Step=23750 Epoch=225.9] | Loss=0.00015 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=14.187 | 5194.9 samples/s | 81.2 steps/s
[Step=23800 Epoch=226.4] | Loss=0.00014 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=14.187 | 2645.4 samples/s | 41.3 steps/s
[Step=23850 Epoch=226.9] | Loss=0.00014 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.164 | L2-Norm(final)=14.188 | 4801.7 samples/s | 75.0 steps/s
[Step=23900 Epoch=227.3] | Loss=0.00013 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=14.189 | 2753.0 samples/s | 43.0 steps/s
[Step=23950 Epoch=227.8] | Loss=0.00013 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.146 | L2-Norm(final)=14.189 | 4540.2 samples/s | 70.9 steps/s
[Step=24000 Epoch=228.3] | Loss=0.00012 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.137 | L2-Norm(final)=14.190 | 2923.4 samples/s | 45.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step24000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=229.2] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.291 | L2-Norm(final)=13.293 | 6948.2 samples/s | 108.6 steps/s
[Step=24050 Epoch=229.7] | Loss=0.00043 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=13.297 | 4650.3 samples/s | 72.7 steps/s
[Step=24100 Epoch=230.1] | Loss=0.00055 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=13.307 | 8209.5 samples/s | 128.3 steps/s
[Step=24150 Epoch=230.6] | Loss=0.00051 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=13.316 | 2566.5 samples/s | 40.1 steps/s
[Step=24200 Epoch=231.1] | Loss=0.00049 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=13.325 | 7436.3 samples/s | 116.2 steps/s
[Step=24250 Epoch=231.6] | Loss=0.00057 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.288 | L2-Norm(final)=13.335 | 2625.3 samples/s | 41.0 steps/s
[Step=24300 Epoch=232.1] | Loss=0.00053 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=13.345 | 6879.7 samples/s | 107.5 steps/s
[Step=24350 Epoch=232.5] | Loss=0.00052 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=13.354 | 2748.3 samples/s | 42.9 steps/s
[Step=24400 Epoch=233.0] | Loss=0.00054 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=13.364 | 6206.2 samples/s | 97.0 steps/s
[Step=24450 Epoch=233.5] | Loss=0.00051 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=13.373 | 2865.9 samples/s | 44.8 steps/s
[Step=24500 Epoch=234.0] | Loss=0.00053 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=13.383 | 5701.7 samples/s | 89.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=234.0] | Loss=0.00196 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=13.478 | 6870.1 samples/s | 107.3 steps/s
[Step=24550 Epoch=234.4] | Loss=0.00021 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=13.490 | 4055.6 samples/s | 63.4 steps/s
[Step=24600 Epoch=234.9] | Loss=0.00018 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=13.495 | 6638.5 samples/s | 103.7 steps/s
[Step=24650 Epoch=235.4] | Loss=0.00013 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=13.499 | 2390.9 samples/s | 37.4 steps/s
[Step=24700 Epoch=235.9] | Loss=0.00010 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.274 | L2-Norm(final)=13.501 | 6060.6 samples/s | 94.7 steps/s
[Step=24750 Epoch=236.3] | Loss=0.00008 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.264 | L2-Norm(final)=13.503 | 2462.2 samples/s | 38.5 steps/s
[Step=24800 Epoch=236.8] | Loss=0.00007 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.253 | L2-Norm(final)=13.504 | 5610.4 samples/s | 87.7 steps/s
[Step=24850 Epoch=237.3] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.241 | L2-Norm(final)=13.506 | 2526.8 samples/s | 39.5 steps/s
[Step=24900 Epoch=237.8] | Loss=0.00005 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.229 | L2-Norm(final)=13.507 | 5295.1 samples/s | 82.7 steps/s
[Step=24950 Epoch=238.3] | Loss=0.00005 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=13.508 | 2640.6 samples/s | 41.3 steps/s
[Step=25000 Epoch=238.7] | Loss=0.00004 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=13.508 | 4837.7 samples/s | 75.6 steps/s
[Step=25050 Epoch=239.2] | Loss=0.00004 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=13.509 | 2708.7 samples/s | 42.3 steps/s
[Step=25100 Epoch=239.7] | Loss=0.00003 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.183 | L2-Norm(final)=13.510 | 4667.9 samples/s | 72.9 steps/s
[Step=25150 Epoch=240.2] | Loss=0.00003 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.171 | L2-Norm(final)=13.511 | 2762.3 samples/s | 43.2 steps/s
[Step=25200 Epoch=240.6] | Loss=0.00003 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.159 | L2-Norm(final)=13.511 | 4537.7 samples/s | 70.9 steps/s
[Step=25250 Epoch=241.1] | Loss=0.00003 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.148 | L2-Norm(final)=13.512 | 2877.3 samples/s | 45.0 steps/s
[Step=25300 Epoch=241.6] | Loss=0.00003 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.136 | L2-Norm(final)=13.513 | 4488.5 samples/s | 70.1 steps/s
[Step=25350 Epoch=242.1] | Loss=0.00003 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.125 | L2-Norm(final)=13.513 | 2845.7 samples/s | 44.5 steps/s
[Step=25400 Epoch=242.6] | Loss=0.00002 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.113 | L2-Norm(final)=13.514 | 4553.3 samples/s | 71.1 steps/s
[Step=25450 Epoch=243.0] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=13.514 | 2826.1 samples/s | 44.2 steps/s
[Step=25500 Epoch=243.5] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.090 | L2-Norm(final)=13.515 | 4504.6 samples/s | 70.4 steps/s
[Step=25550 Epoch=244.0] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.079 | L2-Norm(final)=13.516 | 7382.2 samples/s | 115.3 steps/s
[Step=25600 Epoch=244.5] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.067 | L2-Norm(final)=13.516 | 2294.9 samples/s | 35.9 steps/s
[Step=25650 Epoch=244.9] | Loss=0.00002 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.056 | L2-Norm(final)=13.517 | 6743.4 samples/s | 105.4 steps/s
[Step=25700 Epoch=245.4] | Loss=0.00002 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.044 | L2-Norm(final)=13.517 | 2369.3 samples/s | 37.0 steps/s
[Step=25750 Epoch=245.9] | Loss=0.00002 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.032 | L2-Norm(final)=13.518 | 6189.9 samples/s | 96.7 steps/s
[Step=25800 Epoch=246.4] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.021 | L2-Norm(final)=13.518 | 2462.3 samples/s | 38.5 steps/s
[Step=25850 Epoch=246.9] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.009 | L2-Norm(final)=13.519 | 5549.9 samples/s | 86.7 steps/s
[Step=25900 Epoch=247.3] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.998 | L2-Norm(final)=13.519 | 2524.6 samples/s | 39.4 steps/s
[Step=25950 Epoch=247.8] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.986 | L2-Norm(final)=13.520 | 5303.6 samples/s | 82.9 steps/s
[Step=26000 Epoch=248.3] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.974 | L2-Norm(final)=13.520 | 2602.9 samples/s | 40.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step26000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=266.9] | Loss=0.00112 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.291 | L2-Norm(final)=15.000 | 6603.5 samples/s | 103.2 steps/s
[Step=28050 Epoch=267.3] | Loss=0.00150 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.288 | L2-Norm(final)=15.016 | 4719.6 samples/s | 73.7 steps/s
[Step=28100 Epoch=267.8] | Loss=0.00160 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=15.036 | 8255.5 samples/s | 129.0 steps/s
[Step=28150 Epoch=268.3] | Loss=0.00147 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=15.056 | 2554.8 samples/s | 39.9 steps/s
[Step=28200 Epoch=268.8] | Loss=0.00155 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=15.074 | 7465.7 samples/s | 116.7 steps/s
[Step=28250 Epoch=269.2] | Loss=0.00157 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=15.094 | 2636.8 samples/s | 41.2 steps/s
[Step=28300 Epoch=269.7] | Loss=0.00158 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=15.114 | 6866.4 samples/s | 107.3 steps/s
[Step=28350 Epoch=270.2] | Loss=0.00153 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=15.133 | 2744.0 samples/s | 42.9 steps/s
[Step=28400 Epoch=270.7] | Loss=0.00153 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=15.151 | 6243.8 samples/s | 97.6 steps/s
[Step=28450 Epoch=271.2] | Loss=0.00154 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=15.170 | 2874.4 samples/s | 44.9 steps/s
[Step=28500 Epoch=271.6] | Loss=0.00153 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=15.188 | 5655.8 samples/s | 88.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=271.6] | Loss=0.01389 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.288 | L2-Norm(final)=15.368 | 7069.1 samples/s | 110.5 steps/s
[Step=28550 Epoch=272.1] | Loss=0.00177 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=15.378 | 4053.5 samples/s | 63.3 steps/s
[Step=28600 Epoch=272.6] | Loss=0.00179 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.383 | L2-Norm(final)=15.381 | 6546.3 samples/s | 102.3 steps/s
[Step=28650 Epoch=273.1] | Loss=0.00129 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.411 | L2-Norm(final)=15.381 | 2389.0 samples/s | 37.3 steps/s
[Step=28700 Epoch=273.5] | Loss=0.00099 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=15.382 | 6037.1 samples/s | 94.3 steps/s
[Step=28750 Epoch=274.0] | Loss=0.00079 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.428 | L2-Norm(final)=15.383 | 2446.1 samples/s | 38.2 steps/s
[Step=28800 Epoch=274.5] | Loss=0.00066 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=15.384 | 5701.4 samples/s | 89.1 steps/s
[Step=28850 Epoch=275.0] | Loss=0.00057 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=15.384 | 2532.5 samples/s | 39.6 steps/s
[Step=28900 Epoch=275.4] | Loss=0.00050 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=15.385 | 5281.6 samples/s | 82.5 steps/s
[Step=28950 Epoch=275.9] | Loss=0.00044 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.420 | L2-Norm(final)=15.386 | 2587.7 samples/s | 40.4 steps/s
[Step=29000 Epoch=276.4] | Loss=0.00040 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.415 | L2-Norm(final)=15.386 | 4936.6 samples/s | 77.1 steps/s
[Step=29050 Epoch=276.9] | Loss=0.00037 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.410 | L2-Norm(final)=15.387 | 2724.9 samples/s | 42.6 steps/s
[Step=29100 Epoch=277.3] | Loss=0.00034 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=15.387 | 4610.8 samples/s | 72.0 steps/s
[Step=29150 Epoch=277.8] | Loss=0.00031 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.399 | L2-Norm(final)=15.388 | 2813.0 samples/s | 44.0 steps/s
[Step=29200 Epoch=278.3] | Loss=0.00029 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.393 | L2-Norm(final)=15.388 | 4551.8 samples/s | 71.1 steps/s
[Step=29250 Epoch=278.8] | Loss=0.00027 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.387 | L2-Norm(final)=15.389 | 2815.2 samples/s | 44.0 steps/s
[Step=29300 Epoch=279.3] | Loss=0.00025 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=15.389 | 4551.5 samples/s | 71.1 steps/s
[Step=29350 Epoch=279.7] | Loss=0.00024 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.375 | L2-Norm(final)=15.389 | 2869.1 samples/s | 44.8 steps/s
[Step=29400 Epoch=280.2] | Loss=0.00023 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.368 | L2-Norm(final)=15.390 | 4535.6 samples/s | 70.9 steps/s
[Step=29450 Epoch=280.7] | Loss=0.00021 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.362 | L2-Norm(final)=15.390 | 2870.6 samples/s | 44.9 steps/s
[Step=29500 Epoch=281.2] | Loss=0.00020 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=15.391 | 4429.2 samples/s | 69.2 steps/s
[Step=29550 Epoch=281.6] | Loss=0.00019 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=15.391 | 7338.4 samples/s | 114.7 steps/s
[Step=29600 Epoch=282.1] | Loss=0.00018 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=15.392 | 2284.2 samples/s | 35.7 steps/s
[Step=29650 Epoch=282.6] | Loss=0.00018 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.336 | L2-Norm(final)=15.392 | 6646.3 samples/s | 103.8 steps/s
[Step=29700 Epoch=283.1] | Loss=0.00017 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.329 | L2-Norm(final)=15.393 | 2374.8 samples/s | 37.1 steps/s
[Step=29750 Epoch=283.5] | Loss=0.00016 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.322 | L2-Norm(final)=15.393 | 6080.7 samples/s | 95.0 steps/s
[Step=29800 Epoch=284.0] | Loss=0.00016 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=15.394 | 2460.9 samples/s | 38.5 steps/s
[Step=29850 Epoch=284.5] | Loss=0.00015 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.308 | L2-Norm(final)=15.394 | 5582.0 samples/s | 87.2 steps/s
[Step=29900 Epoch=285.0] | Loss=0.00015 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.301 | L2-Norm(final)=15.395 | 2513.8 samples/s | 39.3 steps/s
[Step=29950 Epoch=285.5] | Loss=0.00014 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=15.395 | 5272.1 samples/s | 82.4 steps/s
[Step=30000 Epoch=285.9] | Loss=0.00014 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=15.395 | 2626.4 samples/s | 41.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step30000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09058 | acc=0.9598 | tpr=0.9691 | fpr=0.0605 | 5851.9 samples/s | 22.9 steps/s
Avg test loss: 0.09888, Avg test acc: 0.95649, Avg tpr: 0.96596, Avg fpr: 0.06435, total FA: 502

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10313 | acc=0.9586 | tpr=0.9777 | fpr=0.0830 | 6078.3 samples/s | 23.7 steps/s
Avg test loss: 0.10586, Avg test acc: 0.95773, Avg tpr: 0.97616, Avg fpr: 0.08281, total FA: 646

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09727 | acc=0.9608 | tpr=0.9740 | fpr=0.0679 | 5790.4 samples/s | 22.6 steps/s
Avg test loss: 0.10077, Avg test acc: 0.95833, Avg tpr: 0.97010, Avg fpr: 0.06756, total FA: 527

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09808 | acc=0.9580 | tpr=0.9767 | fpr=0.0825 | 6072.1 samples/s | 23.7 steps/s
Avg test loss: 0.10399, Avg test acc: 0.95649, Avg tpr: 0.97570, Avg fpr: 0.08576, total FA: 669

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10479 | acc=0.9598 | tpr=0.9748 | fpr=0.0728 | 5956.6 samples/s | 23.3 steps/s
Avg test loss: 0.10949, Avg test acc: 0.95877, Avg tpr: 0.97383, Avg fpr: 0.07435, total FA: 580

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.30578 | acc=0.2991 | tpr=0.0272 | fpr=0.1105 | 5857.0 samples/s | 22.9 steps/s
Avg test loss: 6.31301, Avg test acc: 0.29754, Avg tpr: 0.02664, Avg fpr: 0.10665, total FA: 832

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.75711 | acc=0.2997 | tpr=0.0282 | fpr=0.1108 | 5783.4 samples/s | 22.6 steps/s
Avg test loss: 4.76270, Avg test acc: 0.29810, Avg tpr: 0.02786, Avg fpr: 0.10755, total FA: 839

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.04685 | acc=0.2780 | tpr=0.0193 | fpr=0.1601 | 5946.8 samples/s | 23.2 steps/s
Avg test loss: 5.05299, Avg test acc: 0.27654, Avg tpr: 0.01859, Avg fpr: 0.15613, total FA: 1218

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.77238 | acc=0.2818 | tpr=0.0268 | fpr=0.1645 | 5897.2 samples/s | 23.0 steps/s
Avg test loss: 5.77930, Avg test acc: 0.28019, Avg tpr: 0.02483, Avg fpr: 0.15818, total FA: 1234

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.43697 | acc=0.2934 | tpr=0.0203 | fpr=0.1137 | 6152.0 samples/s | 24.0 steps/s
Avg test loss: 5.45568, Avg test acc: 0.29401, Avg tpr: 0.02057, Avg fpr: 0.10460, total FA: 816

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.94661 | acc=0.1456 | tpr=0.6150 | fpr=0.8628 | 5976.4 samples/s | 23.3 steps/s
[Step= 100] | Loss=4.93917 | acc=0.1488 | tpr=0.5842 | fpr=0.8593 | 8113.6 samples/s | 31.7 steps/s
[Step= 150] | Loss=4.93384 | acc=0.1514 | tpr=0.5937 | fpr=0.8568 | 8036.3 samples/s | 31.4 steps/s
[Step= 200] | Loss=4.92730 | acc=0.1514 | tpr=0.5891 | fpr=0.8566 | 8043.0 samples/s | 31.4 steps/s
[Step= 250] | Loss=4.93188 | acc=0.1508 | tpr=0.5843 | fpr=0.8571 | 7761.1 samples/s | 30.3 steps/s
[Step= 300] | Loss=4.92418 | acc=0.1512 | tpr=0.5767 | fpr=0.8565 | 8029.6 samples/s | 31.4 steps/s
[Step= 350] | Loss=4.92909 | acc=0.1508 | tpr=0.5698 | fpr=0.8568 | 8031.9 samples/s | 31.4 steps/s
[Step= 400] | Loss=4.92633 | acc=0.1513 | tpr=0.5673 | fpr=0.8562 | 7423.4 samples/s | 29.0 steps/s
[Step= 450] | Loss=4.92928 | acc=0.1510 | tpr=0.5735 | fpr=0.8566 | 8939.1 samples/s | 34.9 steps/s
[Step= 500] | Loss=4.92954 | acc=0.1510 | tpr=0.5780 | fpr=0.8567 | 8768.4 samples/s | 34.3 steps/s
[Step= 550] | Loss=4.93251 | acc=0.1512 | tpr=0.5798 | fpr=0.8566 | 8960.9 samples/s | 35.0 steps/s
Avg test loss: 4.93291, Avg test acc: 0.15118, Avg tpr: 0.58082, Avg fpr: 0.85663, total FA: 118942

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.26894 | acc=0.1295 | tpr=0.6770 | fpr=0.8804 | 5812.9 samples/s | 22.7 steps/s
[Step= 100] | Loss=5.24619 | acc=0.1329 | tpr=0.6780 | fpr=0.8772 | 8475.1 samples/s | 33.1 steps/s
[Step= 150] | Loss=5.24384 | acc=0.1343 | tpr=0.6916 | fpr=0.8759 | 8295.8 samples/s | 32.4 steps/s
[Step= 200] | Loss=5.23907 | acc=0.1342 | tpr=0.6852 | fpr=0.8759 | 7932.2 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.24345 | acc=0.1342 | tpr=0.6803 | fpr=0.8758 | 7986.4 samples/s | 31.2 steps/s
[Step= 300] | Loss=5.23932 | acc=0.1338 | tpr=0.6742 | fpr=0.8760 | 8111.0 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.24712 | acc=0.1337 | tpr=0.6675 | fpr=0.8760 | 7846.6 samples/s | 30.7 steps/s
[Step= 400] | Loss=5.24619 | acc=0.1338 | tpr=0.6674 | fpr=0.8759 | 7748.7 samples/s | 30.3 steps/s
[Step= 450] | Loss=5.24948 | acc=0.1333 | tpr=0.6704 | fpr=0.8765 | 7514.3 samples/s | 29.4 steps/s
[Step= 500] | Loss=5.25040 | acc=0.1330 | tpr=0.6722 | fpr=0.8768 | 8278.4 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.25397 | acc=0.1333 | tpr=0.6733 | fpr=0.8766 | 10783.9 samples/s | 42.1 steps/s
Avg test loss: 5.25439, Avg test acc: 0.13315, Avg tpr: 0.67353, Avg fpr: 0.87667, total FA: 121724

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.14242 | acc=0.1334 | tpr=0.6106 | fpr=0.8752 | 5865.1 samples/s | 22.9 steps/s
[Step= 100] | Loss=5.12372 | acc=0.1353 | tpr=0.6013 | fpr=0.8734 | 8151.3 samples/s | 31.8 steps/s
[Step= 150] | Loss=5.11623 | acc=0.1366 | tpr=0.6052 | fpr=0.8720 | 8087.7 samples/s | 31.6 steps/s
[Step= 200] | Loss=5.11041 | acc=0.1372 | tpr=0.5967 | fpr=0.8711 | 7385.1 samples/s | 28.8 steps/s
[Step= 250] | Loss=5.11512 | acc=0.1375 | tpr=0.5904 | fpr=0.8708 | 8422.3 samples/s | 32.9 steps/s
[Step= 300] | Loss=5.11073 | acc=0.1376 | tpr=0.5847 | fpr=0.8705 | 8265.7 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.11726 | acc=0.1374 | tpr=0.5823 | fpr=0.8707 | 8201.6 samples/s | 32.0 steps/s
[Step= 400] | Loss=5.11430 | acc=0.1375 | tpr=0.5821 | fpr=0.8706 | 7946.7 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.11791 | acc=0.1367 | tpr=0.5867 | fpr=0.8714 | 8318.9 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.11718 | acc=0.1366 | tpr=0.5868 | fpr=0.8715 | 7494.0 samples/s | 29.3 steps/s
[Step= 550] | Loss=5.12134 | acc=0.1367 | tpr=0.5889 | fpr=0.8715 | 10212.2 samples/s | 39.9 steps/s
Avg test loss: 5.12182, Avg test acc: 0.13665, Avg tpr: 0.59033, Avg fpr: 0.87160, total FA: 121020

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.51370 | acc=0.1231 | tpr=0.7124 | fpr=0.8875 | 5621.6 samples/s | 22.0 steps/s
[Step= 100] | Loss=5.49380 | acc=0.1254 | tpr=0.6844 | fpr=0.8851 | 8382.4 samples/s | 32.7 steps/s
[Step= 150] | Loss=5.48351 | acc=0.1268 | tpr=0.6945 | fpr=0.8837 | 8374.4 samples/s | 32.7 steps/s
[Step= 200] | Loss=5.47890 | acc=0.1270 | tpr=0.6918 | fpr=0.8833 | 7839.7 samples/s | 30.6 steps/s
[Step= 250] | Loss=5.48056 | acc=0.1270 | tpr=0.6926 | fpr=0.8833 | 8391.9 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.47693 | acc=0.1269 | tpr=0.6924 | fpr=0.8834 | 8125.1 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.48134 | acc=0.1266 | tpr=0.6957 | fpr=0.8837 | 7278.6 samples/s | 28.4 steps/s
[Step= 400] | Loss=5.47927 | acc=0.1268 | tpr=0.6942 | fpr=0.8835 | 8045.9 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.48405 | acc=0.1261 | tpr=0.6972 | fpr=0.8843 | 8178.2 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.48288 | acc=0.1261 | tpr=0.6991 | fpr=0.8842 | 8331.8 samples/s | 32.5 steps/s
[Step= 550] | Loss=5.48948 | acc=0.1262 | tpr=0.6988 | fpr=0.8842 | 10138.9 samples/s | 39.6 steps/s
Avg test loss: 5.49069, Avg test acc: 0.12609, Avg tpr: 0.69929, Avg fpr: 0.88433, total FA: 122787

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.24820 | acc=0.1313 | tpr=0.6106 | fpr=0.8773 | 6152.3 samples/s | 24.0 steps/s
[Step= 100] | Loss=6.24351 | acc=0.1331 | tpr=0.6055 | fpr=0.8757 | 7198.5 samples/s | 28.1 steps/s
[Step= 150] | Loss=6.23182 | acc=0.1346 | tpr=0.6182 | fpr=0.8743 | 8618.8 samples/s | 33.7 steps/s
[Step= 200] | Loss=6.23012 | acc=0.1345 | tpr=0.6077 | fpr=0.8741 | 8195.6 samples/s | 32.0 steps/s
[Step= 250] | Loss=6.23088 | acc=0.1342 | tpr=0.5983 | fpr=0.8743 | 8070.4 samples/s | 31.5 steps/s
[Step= 300] | Loss=6.22376 | acc=0.1341 | tpr=0.5927 | fpr=0.8742 | 7894.2 samples/s | 30.8 steps/s
[Step= 350] | Loss=6.23429 | acc=0.1336 | tpr=0.5936 | fpr=0.8748 | 7664.4 samples/s | 29.9 steps/s
[Step= 400] | Loss=6.23120 | acc=0.1338 | tpr=0.5914 | fpr=0.8746 | 7996.8 samples/s | 31.2 steps/s
[Step= 450] | Loss=6.23621 | acc=0.1331 | tpr=0.5930 | fpr=0.8752 | 7725.4 samples/s | 30.2 steps/s
[Step= 500] | Loss=6.23512 | acc=0.1330 | tpr=0.5934 | fpr=0.8753 | 8432.4 samples/s | 32.9 steps/s
[Step= 550] | Loss=6.23887 | acc=0.1332 | tpr=0.5949 | fpr=0.8752 | 10587.5 samples/s | 41.4 steps/s
Avg test loss: 6.23985, Avg test acc: 0.13313, Avg tpr: 0.59588, Avg fpr: 0.87528, total FA: 121531

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.21215 | acc=0.9559 | tpr=0.9027 | fpr=0.0431 | 6113.4 samples/s | 23.9 steps/s
[Step= 100] | Loss=0.21941 | acc=0.9559 | tpr=0.9275 | fpr=0.0436 | 7408.9 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.22337 | acc=0.9543 | tpr=0.9294 | fpr=0.0452 | 7578.7 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.22263 | acc=0.9539 | tpr=0.9322 | fpr=0.0457 | 8585.0 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.22266 | acc=0.9540 | tpr=0.9310 | fpr=0.0456 | 8646.6 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.22550 | acc=0.9536 | tpr=0.9324 | fpr=0.0460 | 7886.3 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.22442 | acc=0.9537 | tpr=0.9336 | fpr=0.0459 | 8052.3 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.22427 | acc=0.9536 | tpr=0.9294 | fpr=0.0459 | 7868.0 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.22871 | acc=0.9530 | tpr=0.9260 | fpr=0.0465 | 8108.4 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.22865 | acc=0.9530 | tpr=0.9238 | fpr=0.0465 | 8327.8 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.22747 | acc=0.9533 | tpr=0.9232 | fpr=0.0462 | 9475.7 samples/s | 37.0 steps/s
Avg test loss: 0.22706, Avg test acc: 0.95332, Avg tpr: 0.92314, Avg fpr: 0.04613, total FA: 6405

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14120 | acc=0.9637 | tpr=0.9115 | fpr=0.0353 | 5823.4 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.14576 | acc=0.9627 | tpr=0.9232 | fpr=0.0366 | 8202.2 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.14748 | acc=0.9617 | tpr=0.9251 | fpr=0.0376 | 8082.4 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.14765 | acc=0.9616 | tpr=0.9290 | fpr=0.0378 | 7808.8 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.14738 | acc=0.9615 | tpr=0.9284 | fpr=0.0379 | 8400.7 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.14949 | acc=0.9610 | tpr=0.9251 | fpr=0.0383 | 8083.9 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.14833 | acc=0.9612 | tpr=0.9274 | fpr=0.0382 | 8009.3 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.14877 | acc=0.9609 | tpr=0.9261 | fpr=0.0384 | 8227.9 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.15148 | acc=0.9604 | tpr=0.9255 | fpr=0.0390 | 7834.2 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.15110 | acc=0.9603 | tpr=0.9273 | fpr=0.0391 | 7926.0 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.15013 | acc=0.9606 | tpr=0.9268 | fpr=0.0388 | 10116.2 samples/s | 39.5 steps/s
Avg test loss: 0.14991, Avg test acc: 0.96059, Avg tpr: 0.92670, Avg fpr: 0.03880, total FA: 5387

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.25359 | acc=0.9509 | tpr=0.9602 | fpr=0.0492 | 6097.8 samples/s | 23.8 steps/s
[Step= 100] | Loss=0.26131 | acc=0.9501 | tpr=0.9659 | fpr=0.0502 | 7273.2 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.26517 | acc=0.9489 | tpr=0.9654 | fpr=0.0514 | 7938.6 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.26507 | acc=0.9489 | tpr=0.9661 | fpr=0.0514 | 7746.7 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.26510 | acc=0.9487 | tpr=0.9642 | fpr=0.0515 | 8382.9 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.26807 | acc=0.9486 | tpr=0.9593 | fpr=0.0516 | 8553.5 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.26546 | acc=0.9487 | tpr=0.9593 | fpr=0.0515 | 8454.6 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.26555 | acc=0.9484 | tpr=0.9562 | fpr=0.0518 | 8227.2 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.26948 | acc=0.9480 | tpr=0.9542 | fpr=0.0521 | 7752.5 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.26989 | acc=0.9478 | tpr=0.9551 | fpr=0.0523 | 8255.3 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.26803 | acc=0.9481 | tpr=0.9550 | fpr=0.0520 | 9334.5 samples/s | 36.5 steps/s
Avg test loss: 0.26770, Avg test acc: 0.94812, Avg tpr: 0.95483, Avg fpr: 0.05201, total FA: 7221

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14615 | acc=0.9641 | tpr=0.9159 | fpr=0.0350 | 5910.1 samples/s | 23.1 steps/s
[Step= 100] | Loss=0.15435 | acc=0.9620 | tpr=0.9275 | fpr=0.0374 | 8138.8 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.15528 | acc=0.9606 | tpr=0.9308 | fpr=0.0389 | 7216.9 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.15461 | acc=0.9607 | tpr=0.9322 | fpr=0.0388 | 8259.4 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.15451 | acc=0.9606 | tpr=0.9310 | fpr=0.0389 | 8219.8 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.15703 | acc=0.9601 | tpr=0.9302 | fpr=0.0394 | 8239.1 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.15603 | acc=0.9600 | tpr=0.9299 | fpr=0.0394 | 7975.5 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.15575 | acc=0.9599 | tpr=0.9267 | fpr=0.0395 | 7692.2 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.15842 | acc=0.9595 | tpr=0.9265 | fpr=0.0399 | 8122.6 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.15850 | acc=0.9594 | tpr=0.9269 | fpr=0.0400 | 7991.4 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.15739 | acc=0.9597 | tpr=0.9276 | fpr=0.0397 | 11186.5 samples/s | 43.7 steps/s
Avg test loss: 0.15715, Avg test acc: 0.95969, Avg tpr: 0.92750, Avg fpr: 0.03972, total FA: 5515

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.19912 | acc=0.9592 | tpr=0.9115 | fpr=0.0399 | 6026.2 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.20863 | acc=0.9574 | tpr=0.9339 | fpr=0.0421 | 7415.1 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.21288 | acc=0.9559 | tpr=0.9380 | fpr=0.0438 | 7752.8 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.21360 | acc=0.9558 | tpr=0.9443 | fpr=0.0440 | 8221.9 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.21489 | acc=0.9558 | tpr=0.9450 | fpr=0.0440 | 8479.2 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.21810 | acc=0.9555 | tpr=0.9425 | fpr=0.0443 | 8260.9 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.21714 | acc=0.9556 | tpr=0.9436 | fpr=0.0441 | 8499.4 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.21712 | acc=0.9553 | tpr=0.9393 | fpr=0.0445 | 7859.2 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.22058 | acc=0.9548 | tpr=0.9372 | fpr=0.0449 | 8173.7 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.22093 | acc=0.9546 | tpr=0.9383 | fpr=0.0451 | 7716.2 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.21929 | acc=0.9548 | tpr=0.9387 | fpr=0.0449 | 10063.7 samples/s | 39.3 steps/s
Avg test loss: 0.21904, Avg test acc: 0.95484, Avg tpr: 0.93859, Avg fpr: 0.04486, total FA: 6229

server round 26/50

clients selected: [0 1 4 5 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=107.3] | Loss=0.02475 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.217 | L2-Norm(final)=11.599 | 7251.4 samples/s | 113.3 steps/s
[Step=22050 Epoch=107.5] | Loss=0.02694 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.218 | L2-Norm(final)=11.602 | 4815.0 samples/s | 75.2 steps/s
[Step=22100 Epoch=107.8] | Loss=0.02909 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.218 | L2-Norm(final)=11.603 | 5544.5 samples/s | 86.6 steps/s
[Step=22150 Epoch=108.0] | Loss=0.02794 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.218 | L2-Norm(final)=11.607 | 5824.4 samples/s | 91.0 steps/s
[Step=22200 Epoch=108.3] | Loss=0.02802 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=11.613 | 8083.8 samples/s | 126.3 steps/s
[Step=22250 Epoch=108.5] | Loss=0.02941 | Reg=0.00126 | acc=0.9375 | L2-Norm=11.218 | L2-Norm(final)=11.613 | 2669.4 samples/s | 41.7 steps/s
[Step=22300 Epoch=108.7] | Loss=0.02906 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.218 | L2-Norm(final)=11.612 | 5767.8 samples/s | 90.1 steps/s
[Step=22350 Epoch=109.0] | Loss=0.02853 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.218 | L2-Norm(final)=11.612 | 5453.6 samples/s | 85.2 steps/s
[Step=22400 Epoch=109.2] | Loss=0.02856 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=11.614 | 7462.2 samples/s | 116.6 steps/s
[Step=22450 Epoch=109.5] | Loss=0.02817 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.218 | L2-Norm(final)=11.617 | 2854.6 samples/s | 44.6 steps/s
[Step=22500 Epoch=109.7] | Loss=0.02845 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.218 | L2-Norm(final)=11.621 | 5329.4 samples/s | 83.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=109.7] | Loss=0.00990 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=11.652 | 6605.4 samples/s | 103.2 steps/s
[Step=22550 Epoch=110.0] | Loss=0.02678 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.262 | L2-Norm(final)=11.650 | 4555.6 samples/s | 71.2 steps/s
[Step=22600 Epoch=110.2] | Loss=0.03153 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.308 | L2-Norm(final)=11.643 | 4772.0 samples/s | 74.6 steps/s
[Step=22650 Epoch=110.4] | Loss=0.02965 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.346 | L2-Norm(final)=11.640 | 4749.9 samples/s | 74.2 steps/s
[Step=22700 Epoch=110.7] | Loss=0.02677 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.375 | L2-Norm(final)=11.640 | 6867.7 samples/s | 107.3 steps/s
[Step=22750 Epoch=110.9] | Loss=0.02329 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.399 | L2-Norm(final)=11.643 | 2466.8 samples/s | 38.5 steps/s
[Step=22800 Epoch=111.2] | Loss=0.02079 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.418 | L2-Norm(final)=11.647 | 4846.8 samples/s | 75.7 steps/s
[Step=22850 Epoch=111.4] | Loss=0.01918 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=11.652 | 4714.7 samples/s | 73.7 steps/s
[Step=22900 Epoch=111.7] | Loss=0.01807 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.448 | L2-Norm(final)=11.655 | 6213.9 samples/s | 97.1 steps/s
[Step=22950 Epoch=111.9] | Loss=0.01751 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.461 | L2-Norm(final)=11.659 | 2572.9 samples/s | 40.2 steps/s
[Step=23000 Epoch=112.2] | Loss=0.01621 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.473 | L2-Norm(final)=11.663 | 4771.6 samples/s | 74.6 steps/s
[Step=23050 Epoch=112.4] | Loss=0.01550 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.484 | L2-Norm(final)=11.666 | 4786.7 samples/s | 74.8 steps/s
[Step=23100 Epoch=112.6] | Loss=0.01493 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.494 | L2-Norm(final)=11.669 | 5654.0 samples/s | 88.3 steps/s
[Step=23150 Epoch=112.9] | Loss=0.01422 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=11.672 | 2675.7 samples/s | 41.8 steps/s
[Step=23200 Epoch=113.1] | Loss=0.01345 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=11.676 | 4744.7 samples/s | 74.1 steps/s
[Step=23250 Epoch=113.4] | Loss=0.01292 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.519 | L2-Norm(final)=11.679 | 4844.4 samples/s | 75.7 steps/s
[Step=23300 Epoch=113.6] | Loss=0.01247 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.526 | L2-Norm(final)=11.682 | 5174.2 samples/s | 80.8 steps/s
[Step=23350 Epoch=113.9] | Loss=0.01190 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.533 | L2-Norm(final)=11.686 | 2797.8 samples/s | 43.7 steps/s
[Step=23400 Epoch=114.1] | Loss=0.01143 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.539 | L2-Norm(final)=11.689 | 4644.3 samples/s | 72.6 steps/s
[Step=23450 Epoch=114.3] | Loss=0.01111 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.545 | L2-Norm(final)=11.693 | 4764.3 samples/s | 74.4 steps/s
[Step=23500 Epoch=114.6] | Loss=0.01078 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.550 | L2-Norm(final)=11.696 | 4886.6 samples/s | 76.4 steps/s
[Step=23550 Epoch=114.8] | Loss=0.01040 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.555 | L2-Norm(final)=11.699 | 2934.8 samples/s | 45.9 steps/s
[Step=23600 Epoch=115.1] | Loss=0.01002 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.560 | L2-Norm(final)=11.702 | 4684.4 samples/s | 73.2 steps/s
[Step=23650 Epoch=115.3] | Loss=0.00979 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.565 | L2-Norm(final)=11.706 | 4744.1 samples/s | 74.1 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00955 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.569 | L2-Norm(final)=11.709 | 4786.8 samples/s | 74.8 steps/s
[Step=23750 Epoch=115.8] | Loss=0.00931 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.573 | L2-Norm(final)=11.712 | 2932.0 samples/s | 45.8 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00913 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.577 | L2-Norm(final)=11.715 | 4781.8 samples/s | 74.7 steps/s
[Step=23850 Epoch=116.3] | Loss=0.00888 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=11.717 | 4733.7 samples/s | 74.0 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00869 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.584 | L2-Norm(final)=11.720 | 4794.4 samples/s | 74.9 steps/s
[Step=23950 Epoch=116.8] | Loss=0.00851 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.588 | L2-Norm(final)=11.723 | 2934.4 samples/s | 45.9 steps/s
[Step=24000 Epoch=117.0] | Loss=0.00828 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.591 | L2-Norm(final)=11.726 | 4749.6 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step24000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=30001 Epoch=146.4] | Loss=0.02961 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.217 | L2-Norm(final)=13.697 | 7096.1 samples/s | 110.9 steps/s
[Step=30050 Epoch=146.6] | Loss=0.02438 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.217 | L2-Norm(final)=13.705 | 4872.1 samples/s | 76.1 steps/s
[Step=30100 Epoch=146.9] | Loss=0.02418 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.217 | L2-Norm(final)=13.710 | 5599.2 samples/s | 87.5 steps/s
[Step=30150 Epoch=147.1] | Loss=0.02366 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.218 | L2-Norm(final)=13.714 | 5456.5 samples/s | 85.3 steps/s
[Step=30200 Epoch=147.4] | Loss=0.02334 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.218 | L2-Norm(final)=13.721 | 8758.1 samples/s | 136.8 steps/s
[Step=30250 Epoch=147.6] | Loss=0.02318 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=13.727 | 2686.3 samples/s | 42.0 steps/s
[Step=30300 Epoch=147.8] | Loss=0.02313 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.218 | L2-Norm(final)=13.732 | 5468.8 samples/s | 85.5 steps/s
[Step=30350 Epoch=148.1] | Loss=0.02324 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=13.736 | 5694.9 samples/s | 89.0 steps/s
[Step=30400 Epoch=148.3] | Loss=0.02298 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.218 | L2-Norm(final)=13.741 | 7519.7 samples/s | 117.5 steps/s
[Step=30450 Epoch=148.6] | Loss=0.02294 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.218 | L2-Norm(final)=13.746 | 2766.5 samples/s | 43.2 steps/s
[Step=30500 Epoch=148.8] | Loss=0.02288 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.218 | L2-Norm(final)=13.751 | 5431.1 samples/s | 84.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=30501 Epoch=148.8] | Loss=0.03252 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.218 | L2-Norm(final)=13.801 | 7628.1 samples/s | 119.2 steps/s
[Step=30550 Epoch=149.1] | Loss=0.02315 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.257 | L2-Norm(final)=13.802 | 4127.3 samples/s | 64.5 steps/s
[Step=30600 Epoch=149.3] | Loss=0.02412 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.295 | L2-Norm(final)=13.798 | 4837.0 samples/s | 75.6 steps/s
[Step=30650 Epoch=149.6] | Loss=0.02413 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.327 | L2-Norm(final)=13.796 | 4682.6 samples/s | 73.2 steps/s
[Step=30700 Epoch=149.8] | Loss=0.02262 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=13.797 | 6904.7 samples/s | 107.9 steps/s
[Step=30750 Epoch=150.0] | Loss=0.01983 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.376 | L2-Norm(final)=13.799 | 2467.4 samples/s | 38.6 steps/s
[Step=30800 Epoch=150.3] | Loss=0.01776 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.393 | L2-Norm(final)=13.802 | 4774.2 samples/s | 74.6 steps/s
[Step=30850 Epoch=150.5] | Loss=0.01644 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=13.805 | 4696.2 samples/s | 73.4 steps/s
[Step=30900 Epoch=150.8] | Loss=0.01545 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.420 | L2-Norm(final)=13.808 | 6351.0 samples/s | 99.2 steps/s
[Step=30950 Epoch=151.0] | Loss=0.01427 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.431 | L2-Norm(final)=13.811 | 2542.2 samples/s | 39.7 steps/s
[Step=31000 Epoch=151.3] | Loss=0.01348 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.440 | L2-Norm(final)=13.813 | 4711.6 samples/s | 73.6 steps/s
[Step=31050 Epoch=151.5] | Loss=0.01288 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=13.816 | 4772.2 samples/s | 74.6 steps/s
[Step=31100 Epoch=151.8] | Loss=0.01215 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.456 | L2-Norm(final)=13.818 | 5920.7 samples/s | 92.5 steps/s
[Step=31150 Epoch=152.0] | Loss=0.01172 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.463 | L2-Norm(final)=13.820 | 2599.3 samples/s | 40.6 steps/s
[Step=31200 Epoch=152.2] | Loss=0.01122 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.469 | L2-Norm(final)=13.823 | 4711.1 samples/s | 73.6 steps/s
[Step=31250 Epoch=152.5] | Loss=0.01091 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.475 | L2-Norm(final)=13.825 | 4823.9 samples/s | 75.4 steps/s
[Step=31300 Epoch=152.7] | Loss=0.01048 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.480 | L2-Norm(final)=13.827 | 5443.5 samples/s | 85.1 steps/s
[Step=31350 Epoch=153.0] | Loss=0.01005 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.485 | L2-Norm(final)=13.829 | 2706.3 samples/s | 42.3 steps/s
[Step=31400 Epoch=153.2] | Loss=0.00973 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.490 | L2-Norm(final)=13.831 | 4816.1 samples/s | 75.3 steps/s
[Step=31450 Epoch=153.5] | Loss=0.00941 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.494 | L2-Norm(final)=13.832 | 4680.2 samples/s | 73.1 steps/s
[Step=31500 Epoch=153.7] | Loss=0.00920 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.498 | L2-Norm(final)=13.834 | 5183.3 samples/s | 81.0 steps/s
[Step=31550 Epoch=153.9] | Loss=0.00886 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.502 | L2-Norm(final)=13.836 | 2827.5 samples/s | 44.2 steps/s
[Step=31600 Epoch=154.2] | Loss=0.00858 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.505 | L2-Norm(final)=13.838 | 4669.0 samples/s | 73.0 steps/s
[Step=31650 Epoch=154.4] | Loss=0.00841 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.509 | L2-Norm(final)=13.840 | 4735.1 samples/s | 74.0 steps/s
[Step=31700 Epoch=154.7] | Loss=0.00817 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.512 | L2-Norm(final)=13.841 | 4861.3 samples/s | 76.0 steps/s
[Step=31750 Epoch=154.9] | Loss=0.00797 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.515 | L2-Norm(final)=13.843 | 2893.2 samples/s | 45.2 steps/s
[Step=31800 Epoch=155.2] | Loss=0.00774 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.518 | L2-Norm(final)=13.845 | 4780.3 samples/s | 74.7 steps/s
[Step=31850 Epoch=155.4] | Loss=0.00758 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.520 | L2-Norm(final)=13.846 | 4803.8 samples/s | 75.1 steps/s
[Step=31900 Epoch=155.7] | Loss=0.00742 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.523 | L2-Norm(final)=13.848 | 4719.3 samples/s | 73.7 steps/s
[Step=31950 Epoch=155.9] | Loss=0.00727 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.525 | L2-Norm(final)=13.850 | 2940.5 samples/s | 45.9 steps/s
[Step=32000 Epoch=156.1] | Loss=0.00711 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.528 | L2-Norm(final)=13.851 | 4678.9 samples/s | 73.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step32000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=98.1] | Loss=0.02338 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.217 | L2-Norm(final)=13.285 | 7285.6 samples/s | 113.8 steps/s
[Step=20050 Epoch=98.3] | Loss=0.02947 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.218 | L2-Norm(final)=13.289 | 4803.8 samples/s | 75.1 steps/s
[Step=20100 Epoch=98.6] | Loss=0.02805 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=13.282 | 5615.2 samples/s | 87.7 steps/s
[Step=20150 Epoch=98.8] | Loss=0.02569 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.218 | L2-Norm(final)=13.280 | 5516.0 samples/s | 86.2 steps/s
[Step=20200 Epoch=99.1] | Loss=0.02470 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.218 | L2-Norm(final)=13.284 | 8895.7 samples/s | 139.0 steps/s
[Step=20250 Epoch=99.3] | Loss=0.02401 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.218 | L2-Norm(final)=13.288 | 2557.7 samples/s | 40.0 steps/s
[Step=20300 Epoch=99.5] | Loss=0.02449 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.218 | L2-Norm(final)=13.292 | 5568.6 samples/s | 87.0 steps/s
[Step=20350 Epoch=99.8] | Loss=0.02492 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=13.295 | 5348.9 samples/s | 83.6 steps/s
[Step=20400 Epoch=100.0] | Loss=0.02458 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.218 | L2-Norm(final)=13.296 | 8178.5 samples/s | 127.8 steps/s
[Step=20450 Epoch=100.3] | Loss=0.02423 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.218 | L2-Norm(final)=13.297 | 2740.5 samples/s | 42.8 steps/s
[Step=20500 Epoch=100.5] | Loss=0.02435 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.218 | L2-Norm(final)=13.299 | 5469.7 samples/s | 85.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=100.5] | Loss=0.02381 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.218 | L2-Norm(final)=13.316 | 7357.2 samples/s | 115.0 steps/s
[Step=20550 Epoch=100.8] | Loss=0.03797 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.260 | L2-Norm(final)=13.306 | 4236.4 samples/s | 66.2 steps/s
[Step=20600 Epoch=101.0] | Loss=0.02898 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.308 | L2-Norm(final)=13.302 | 4773.4 samples/s | 74.6 steps/s
[Step=20650 Epoch=101.3] | Loss=0.02726 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.340 | L2-Norm(final)=13.303 | 4776.8 samples/s | 74.6 steps/s
[Step=20700 Epoch=101.5] | Loss=0.02567 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.366 | L2-Norm(final)=13.302 | 6992.6 samples/s | 109.3 steps/s
[Step=20750 Epoch=101.8] | Loss=0.02223 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.388 | L2-Norm(final)=13.303 | 2438.7 samples/s | 38.1 steps/s
[Step=20800 Epoch=102.0] | Loss=0.01997 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=13.307 | 4786.1 samples/s | 74.8 steps/s
[Step=20850 Epoch=102.2] | Loss=0.01815 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.422 | L2-Norm(final)=13.310 | 4746.7 samples/s | 74.2 steps/s
[Step=20900 Epoch=102.5] | Loss=0.01698 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=13.313 | 6589.5 samples/s | 103.0 steps/s
[Step=20950 Epoch=102.7] | Loss=0.01580 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.446 | L2-Norm(final)=13.316 | 2494.6 samples/s | 39.0 steps/s
[Step=21000 Epoch=103.0] | Loss=0.01461 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.457 | L2-Norm(final)=13.319 | 4804.0 samples/s | 75.1 steps/s
[Step=21050 Epoch=103.2] | Loss=0.01380 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.466 | L2-Norm(final)=13.322 | 4655.1 samples/s | 72.7 steps/s
[Step=21100 Epoch=103.5] | Loss=0.01312 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.473 | L2-Norm(final)=13.325 | 6172.8 samples/s | 96.4 steps/s
[Step=21150 Epoch=103.7] | Loss=0.01237 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.481 | L2-Norm(final)=13.328 | 2569.9 samples/s | 40.2 steps/s
[Step=21200 Epoch=104.0] | Loss=0.01169 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.487 | L2-Norm(final)=13.331 | 4749.6 samples/s | 74.2 steps/s
[Step=21250 Epoch=104.2] | Loss=0.01111 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.493 | L2-Norm(final)=13.334 | 4737.4 samples/s | 74.0 steps/s
[Step=21300 Epoch=104.5] | Loss=0.01070 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.499 | L2-Norm(final)=13.337 | 5848.3 samples/s | 91.4 steps/s
[Step=21350 Epoch=104.7] | Loss=0.01028 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.504 | L2-Norm(final)=13.340 | 2640.1 samples/s | 41.3 steps/s
[Step=21400 Epoch=104.9] | Loss=0.00989 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.509 | L2-Norm(final)=13.343 | 4660.6 samples/s | 72.8 steps/s
[Step=21450 Epoch=105.2] | Loss=0.00950 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.513 | L2-Norm(final)=13.346 | 4787.3 samples/s | 74.8 steps/s
[Step=21500 Epoch=105.4] | Loss=0.00922 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.518 | L2-Norm(final)=13.348 | 5451.1 samples/s | 85.2 steps/s
[Step=21550 Epoch=105.7] | Loss=0.00890 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.522 | L2-Norm(final)=13.351 | 2693.2 samples/s | 42.1 steps/s
[Step=21600 Epoch=105.9] | Loss=0.00857 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.525 | L2-Norm(final)=13.354 | 4717.9 samples/s | 73.7 steps/s
[Step=21650 Epoch=106.2] | Loss=0.00830 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.529 | L2-Norm(final)=13.357 | 4794.6 samples/s | 74.9 steps/s
[Step=21700 Epoch=106.4] | Loss=0.00810 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.532 | L2-Norm(final)=13.359 | 5219.1 samples/s | 81.5 steps/s
[Step=21750 Epoch=106.7] | Loss=0.00789 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.535 | L2-Norm(final)=13.362 | 2767.4 samples/s | 43.2 steps/s
[Step=21800 Epoch=106.9] | Loss=0.00766 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.538 | L2-Norm(final)=13.364 | 4732.3 samples/s | 73.9 steps/s
[Step=21850 Epoch=107.1] | Loss=0.00744 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.541 | L2-Norm(final)=13.367 | 4743.3 samples/s | 74.1 steps/s
[Step=21900 Epoch=107.4] | Loss=0.00729 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.544 | L2-Norm(final)=13.369 | 4983.3 samples/s | 77.9 steps/s
[Step=21950 Epoch=107.6] | Loss=0.00711 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.546 | L2-Norm(final)=13.372 | 2863.5 samples/s | 44.7 steps/s
[Step=22000 Epoch=107.9] | Loss=0.00698 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.549 | L2-Norm(final)=13.374 | 4755.8 samples/s | 74.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step22000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=36001 Epoch=341.1] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.217 | L2-Norm(final)=17.232 | 6228.2 samples/s | 97.3 steps/s
[Step=36050 Epoch=341.6] | Loss=0.00019 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=17.239 | 4763.8 samples/s | 74.4 steps/s
[Step=36100 Epoch=342.1] | Loss=0.00026 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=17.242 | 7919.0 samples/s | 123.7 steps/s
[Step=36150 Epoch=342.6] | Loss=0.00030 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=17.246 | 2557.3 samples/s | 40.0 steps/s
[Step=36200 Epoch=343.0] | Loss=0.00026 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=17.250 | 7313.4 samples/s | 114.3 steps/s
[Step=36250 Epoch=343.5] | Loss=0.00028 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=17.253 | 2689.3 samples/s | 42.0 steps/s
[Step=36300 Epoch=344.0] | Loss=0.00026 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=17.257 | 6337.7 samples/s | 99.0 steps/s
[Step=36350 Epoch=344.4] | Loss=0.00027 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=17.260 | 2783.6 samples/s | 43.5 steps/s
[Step=36400 Epoch=344.9] | Loss=0.00025 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=17.263 | 5890.2 samples/s | 92.0 steps/s
[Step=36450 Epoch=345.4] | Loss=0.00024 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=17.266 | 2936.3 samples/s | 45.9 steps/s
[Step=36500 Epoch=345.9] | Loss=0.00025 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=17.268 | 5379.3 samples/s | 84.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=36501 Epoch=345.9] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=17.298 | 7230.3 samples/s | 113.0 steps/s
[Step=36550 Epoch=346.3] | Loss=0.00047 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.229 | L2-Norm(final)=17.302 | 4043.4 samples/s | 63.2 steps/s
[Step=36600 Epoch=346.8] | Loss=0.00043 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.226 | L2-Norm(final)=17.304 | 6538.5 samples/s | 102.2 steps/s
[Step=36650 Epoch=347.3] | Loss=0.00118 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.236 | L2-Norm(final)=17.301 | 2379.9 samples/s | 37.2 steps/s
[Step=36700 Epoch=347.8] | Loss=0.00154 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.255 | L2-Norm(final)=17.294 | 5981.0 samples/s | 93.5 steps/s
[Step=36750 Epoch=348.2] | Loss=0.00141 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.271 | L2-Norm(final)=17.289 | 2483.6 samples/s | 38.8 steps/s
[Step=36800 Epoch=348.7] | Loss=0.00123 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=17.285 | 5423.0 samples/s | 84.7 steps/s
[Step=36850 Epoch=349.2] | Loss=0.00106 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=17.283 | 2614.2 samples/s | 40.8 steps/s
[Step=36900 Epoch=349.7] | Loss=0.00093 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.292 | L2-Norm(final)=17.281 | 4886.2 samples/s | 76.3 steps/s
[Step=36950 Epoch=350.1] | Loss=0.00082 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=17.279 | 2693.5 samples/s | 42.1 steps/s
[Step=37000 Epoch=350.6] | Loss=0.00074 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=17.278 | 4660.3 samples/s | 72.8 steps/s
[Step=37050 Epoch=351.1] | Loss=0.00068 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=17.277 | 2817.9 samples/s | 44.0 steps/s
[Step=37100 Epoch=351.6] | Loss=0.00062 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.292 | L2-Norm(final)=17.276 | 4467.1 samples/s | 69.8 steps/s
[Step=37150 Epoch=352.0] | Loss=0.00057 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.290 | L2-Norm(final)=17.276 | 2879.8 samples/s | 45.0 steps/s
[Step=37200 Epoch=352.5] | Loss=0.00053 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=17.275 | 4543.7 samples/s | 71.0 steps/s
[Step=37250 Epoch=353.0] | Loss=0.00050 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=17.275 | 2811.4 samples/s | 43.9 steps/s
[Step=37300 Epoch=353.4] | Loss=0.00047 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=17.275 | 4598.0 samples/s | 71.8 steps/s
[Step=37350 Epoch=353.9] | Loss=0.00044 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.280 | L2-Norm(final)=17.274 | 2990.2 samples/s | 46.7 steps/s
[Step=37400 Epoch=354.4] | Loss=0.00041 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.277 | L2-Norm(final)=17.274 | 4126.6 samples/s | 64.5 steps/s
[Step=37450 Epoch=354.9] | Loss=0.00039 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.274 | L2-Norm(final)=17.274 | 6854.9 samples/s | 107.1 steps/s
[Step=37500 Epoch=355.3] | Loss=0.00037 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.270 | L2-Norm(final)=17.274 | 2335.9 samples/s | 36.5 steps/s
[Step=37550 Epoch=355.8] | Loss=0.00036 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.267 | L2-Norm(final)=17.274 | 6213.6 samples/s | 97.1 steps/s
[Step=37600 Epoch=356.3] | Loss=0.00034 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.263 | L2-Norm(final)=17.274 | 2461.5 samples/s | 38.5 steps/s
[Step=37650 Epoch=356.8] | Loss=0.00033 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=17.274 | 5574.2 samples/s | 87.1 steps/s
[Step=37700 Epoch=357.2] | Loss=0.00031 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.256 | L2-Norm(final)=17.274 | 2540.5 samples/s | 39.7 steps/s
[Step=37750 Epoch=357.7] | Loss=0.00030 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.252 | L2-Norm(final)=17.274 | 5170.4 samples/s | 80.8 steps/s
[Step=37800 Epoch=358.2] | Loss=0.00029 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.249 | L2-Norm(final)=17.274 | 2662.4 samples/s | 41.6 steps/s
[Step=37850 Epoch=358.7] | Loss=0.00028 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=17.274 | 4674.6 samples/s | 73.0 steps/s
[Step=37900 Epoch=359.1] | Loss=0.00027 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.241 | L2-Norm(final)=17.274 | 2766.3 samples/s | 43.2 steps/s
[Step=37950 Epoch=359.6] | Loss=0.00026 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.237 | L2-Norm(final)=17.274 | 4535.0 samples/s | 70.9 steps/s
[Step=38000 Epoch=360.1] | Loss=0.00025 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.233 | L2-Norm(final)=17.274 | 2869.8 samples/s | 44.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step38000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=30001 Epoch=285.9] | Loss=0.00055 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.217 | L2-Norm(final)=15.409 | 6940.0 samples/s | 108.4 steps/s
[Step=30050 Epoch=286.4] | Loss=0.00153 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=15.430 | 4556.5 samples/s | 71.2 steps/s
[Step=30100 Epoch=286.9] | Loss=0.00137 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.215 | L2-Norm(final)=15.452 | 8368.2 samples/s | 130.8 steps/s
[Step=30150 Epoch=287.4] | Loss=0.00130 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=15.472 | 2541.5 samples/s | 39.7 steps/s
[Step=30200 Epoch=287.8] | Loss=0.00134 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=15.492 | 7585.0 samples/s | 118.5 steps/s
[Step=30250 Epoch=288.3] | Loss=0.00131 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=15.512 | 2646.8 samples/s | 41.4 steps/s
[Step=30300 Epoch=288.8] | Loss=0.00131 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=15.530 | 6842.1 samples/s | 106.9 steps/s
[Step=30350 Epoch=289.3] | Loss=0.00131 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=15.550 | 2716.6 samples/s | 42.4 steps/s
[Step=30400 Epoch=289.7] | Loss=0.00130 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=15.570 | 6263.6 samples/s | 97.9 steps/s
[Step=30450 Epoch=290.2] | Loss=0.00130 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=15.588 | 2861.5 samples/s | 44.7 steps/s
[Step=30500 Epoch=290.7] | Loss=0.00129 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=15.607 | 5714.5 samples/s | 89.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=30501 Epoch=290.7] | Loss=0.00032 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=15.788 | 7559.2 samples/s | 118.1 steps/s
[Step=30550 Epoch=291.2] | Loss=0.00126 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=15.796 | 3939.2 samples/s | 61.5 steps/s
[Step=30600 Epoch=291.6] | Loss=0.00195 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.296 | L2-Norm(final)=15.798 | 6686.1 samples/s | 104.5 steps/s
[Step=30650 Epoch=292.1] | Loss=0.00142 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.328 | L2-Norm(final)=15.796 | 2399.2 samples/s | 37.5 steps/s
[Step=30700 Epoch=292.6] | Loss=0.00107 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=15.796 | 5939.9 samples/s | 92.8 steps/s
[Step=30750 Epoch=293.1] | Loss=0.00086 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.348 | L2-Norm(final)=15.796 | 2470.6 samples/s | 38.6 steps/s
[Step=30800 Epoch=293.6] | Loss=0.00072 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=15.796 | 5552.4 samples/s | 86.8 steps/s
[Step=30850 Epoch=294.0] | Loss=0.00062 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.348 | L2-Norm(final)=15.796 | 2568.0 samples/s | 40.1 steps/s
[Step=30900 Epoch=294.5] | Loss=0.00054 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.346 | L2-Norm(final)=15.796 | 5149.6 samples/s | 80.5 steps/s
[Step=30950 Epoch=295.0] | Loss=0.00048 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=15.796 | 2630.7 samples/s | 41.1 steps/s
[Step=31000 Epoch=295.5] | Loss=0.00043 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.338 | L2-Norm(final)=15.796 | 4918.6 samples/s | 76.9 steps/s
[Step=31050 Epoch=295.9] | Loss=0.00039 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.334 | L2-Norm(final)=15.796 | 2690.7 samples/s | 42.0 steps/s
[Step=31100 Epoch=296.4] | Loss=0.00036 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.329 | L2-Norm(final)=15.797 | 4634.8 samples/s | 72.4 steps/s
[Step=31150 Epoch=296.9] | Loss=0.00033 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.324 | L2-Norm(final)=15.797 | 2817.3 samples/s | 44.0 steps/s
[Step=31200 Epoch=297.4] | Loss=0.00031 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.319 | L2-Norm(final)=15.797 | 4595.5 samples/s | 71.8 steps/s
[Step=31250 Epoch=297.8] | Loss=0.00029 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.313 | L2-Norm(final)=15.797 | 2836.4 samples/s | 44.3 steps/s
[Step=31300 Epoch=298.3] | Loss=0.00027 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.307 | L2-Norm(final)=15.798 | 4567.8 samples/s | 71.4 steps/s
[Step=31350 Epoch=298.8] | Loss=0.00026 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.302 | L2-Norm(final)=15.798 | 2832.4 samples/s | 44.3 steps/s
[Step=31400 Epoch=299.3] | Loss=0.00024 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.296 | L2-Norm(final)=15.798 | 4491.2 samples/s | 70.2 steps/s
[Step=31450 Epoch=299.7] | Loss=0.00023 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.290 | L2-Norm(final)=15.799 | 2863.1 samples/s | 44.7 steps/s
[Step=31500 Epoch=300.2] | Loss=0.00022 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.284 | L2-Norm(final)=15.799 | 4472.3 samples/s | 69.9 steps/s
[Step=31550 Epoch=300.7] | Loss=0.00021 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.278 | L2-Norm(final)=15.799 | 7312.3 samples/s | 114.3 steps/s
[Step=31600 Epoch=301.2] | Loss=0.00020 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.271 | L2-Norm(final)=15.799 | 2308.4 samples/s | 36.1 steps/s
[Step=31650 Epoch=301.7] | Loss=0.00019 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.265 | L2-Norm(final)=15.800 | 6689.5 samples/s | 104.5 steps/s
[Step=31700 Epoch=302.1] | Loss=0.00018 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.259 | L2-Norm(final)=15.800 | 2350.6 samples/s | 36.7 steps/s
[Step=31750 Epoch=302.6] | Loss=0.00018 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.253 | L2-Norm(final)=15.800 | 6149.3 samples/s | 96.1 steps/s
[Step=31800 Epoch=303.1] | Loss=0.00017 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.246 | L2-Norm(final)=15.801 | 2432.4 samples/s | 38.0 steps/s
[Step=31850 Epoch=303.6] | Loss=0.00016 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.240 | L2-Norm(final)=15.801 | 5689.3 samples/s | 88.9 steps/s
[Step=31900 Epoch=304.0] | Loss=0.00016 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.233 | L2-Norm(final)=15.801 | 2561.8 samples/s | 40.0 steps/s
[Step=31950 Epoch=304.5] | Loss=0.00015 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.227 | L2-Norm(final)=15.802 | 5222.4 samples/s | 81.6 steps/s
[Step=32000 Epoch=305.0] | Loss=0.00015 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.220 | L2-Norm(final)=15.802 | 2619.9 samples/s | 40.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09397 | acc=0.9625 | tpr=0.9710 | fpr=0.0560 | 6061.0 samples/s | 23.7 steps/s
Avg test loss: 0.10263, Avg test acc: 0.95849, Avg tpr: 0.96724, Avg fpr: 0.06076, total FA: 474

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10992 | acc=0.9589 | tpr=0.9724 | fpr=0.0704 | 6033.9 samples/s | 23.6 steps/s
Avg test loss: 0.11332, Avg test acc: 0.95773, Avg tpr: 0.97097, Avg fpr: 0.07140, total FA: 557

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09727 | acc=0.9608 | tpr=0.9740 | fpr=0.0679 | 5928.5 samples/s | 23.2 steps/s
Avg test loss: 0.10077, Avg test acc: 0.95833, Avg tpr: 0.97010, Avg fpr: 0.06756, total FA: 527

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09808 | acc=0.9580 | tpr=0.9767 | fpr=0.0825 | 6098.3 samples/s | 23.8 steps/s
Avg test loss: 0.10399, Avg test acc: 0.95649, Avg tpr: 0.97570, Avg fpr: 0.08576, total FA: 669

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09980 | acc=0.9590 | tpr=0.9654 | fpr=0.0550 | 5871.6 samples/s | 22.9 steps/s
Avg test loss: 0.10517, Avg test acc: 0.95765, Avg tpr: 0.96380, Avg fpr: 0.05589, total FA: 436

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.15543 | acc=0.2973 | tpr=0.0225 | fpr=0.1058 | 5686.9 samples/s | 22.2 steps/s
Avg test loss: 6.16536, Avg test acc: 0.29429, Avg tpr: 0.02139, Avg fpr: 0.10550, total FA: 823

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.75711 | acc=0.2997 | tpr=0.0282 | fpr=0.1108 | 5993.7 samples/s | 23.4 steps/s
Avg test loss: 4.76270, Avg test acc: 0.29810, Avg tpr: 0.02786, Avg fpr: 0.10755, total FA: 839

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.04685 | acc=0.2780 | tpr=0.0193 | fpr=0.1601 | 5989.9 samples/s | 23.4 steps/s
Avg test loss: 5.05299, Avg test acc: 0.27654, Avg tpr: 0.01859, Avg fpr: 0.15613, total FA: 1218

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.77238 | acc=0.2818 | tpr=0.0268 | fpr=0.1645 | 5857.4 samples/s | 22.9 steps/s
Avg test loss: 5.77930, Avg test acc: 0.28019, Avg tpr: 0.02483, Avg fpr: 0.15818, total FA: 1234

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.62707 | acc=0.3058 | tpr=0.0157 | fpr=0.0644 | 6156.4 samples/s | 24.0 steps/s
Avg test loss: 5.64633, Avg test acc: 0.30375, Avg tpr: 0.01556, Avg fpr: 0.06243, total FA: 487

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.66641 | acc=0.1336 | tpr=0.6681 | fpr=0.8760 | 5912.7 samples/s | 23.1 steps/s
[Step= 100] | Loss=5.64262 | acc=0.1378 | tpr=0.6397 | fpr=0.8716 | 7408.0 samples/s | 28.9 steps/s
[Step= 150] | Loss=5.63788 | acc=0.1401 | tpr=0.6527 | fpr=0.8693 | 8585.3 samples/s | 33.5 steps/s
[Step= 200] | Loss=5.63089 | acc=0.1401 | tpr=0.6459 | fpr=0.8691 | 7195.8 samples/s | 28.1 steps/s
[Step= 250] | Loss=5.63600 | acc=0.1394 | tpr=0.6402 | fpr=0.8697 | 8378.4 samples/s | 32.7 steps/s
[Step= 300] | Loss=5.62752 | acc=0.1398 | tpr=0.6378 | fpr=0.8693 | 8261.0 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.63395 | acc=0.1391 | tpr=0.6343 | fpr=0.8698 | 8260.2 samples/s | 32.3 steps/s
[Step= 400] | Loss=5.63056 | acc=0.1393 | tpr=0.6302 | fpr=0.8696 | 8346.1 samples/s | 32.6 steps/s
[Step= 450] | Loss=5.63530 | acc=0.1387 | tpr=0.6329 | fpr=0.8702 | 8086.7 samples/s | 31.6 steps/s
[Step= 500] | Loss=5.63457 | acc=0.1388 | tpr=0.6357 | fpr=0.8702 | 7327.9 samples/s | 28.6 steps/s
[Step= 550] | Loss=5.63836 | acc=0.1387 | tpr=0.6407 | fpr=0.8704 | 11338.0 samples/s | 44.3 steps/s
Avg test loss: 5.63876, Avg test acc: 0.13867, Avg tpr: 0.64144, Avg fpr: 0.87047, total FA: 120863

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.77937 | acc=0.1306 | tpr=0.6150 | fpr=0.8781 | 5985.4 samples/s | 23.4 steps/s
[Step= 100] | Loss=5.76048 | acc=0.1352 | tpr=0.6247 | fpr=0.8739 | 7978.6 samples/s | 31.2 steps/s
[Step= 150] | Loss=5.75181 | acc=0.1367 | tpr=0.6427 | fpr=0.8726 | 7341.0 samples/s | 28.7 steps/s
[Step= 200] | Loss=5.74350 | acc=0.1366 | tpr=0.6383 | fpr=0.8725 | 8055.7 samples/s | 31.5 steps/s
[Step= 250] | Loss=5.74925 | acc=0.1363 | tpr=0.6367 | fpr=0.8728 | 8344.6 samples/s | 32.6 steps/s
[Step= 300] | Loss=5.74325 | acc=0.1358 | tpr=0.6284 | fpr=0.8732 | 7970.8 samples/s | 31.1 steps/s
[Step= 350] | Loss=5.75111 | acc=0.1355 | tpr=0.6255 | fpr=0.8734 | 7898.1 samples/s | 30.9 steps/s
[Step= 400] | Loss=5.74615 | acc=0.1357 | tpr=0.6269 | fpr=0.8733 | 8136.3 samples/s | 31.8 steps/s
[Step= 450] | Loss=5.74940 | acc=0.1351 | tpr=0.6319 | fpr=0.8739 | 7743.2 samples/s | 30.2 steps/s
[Step= 500] | Loss=5.74988 | acc=0.1350 | tpr=0.6348 | fpr=0.8741 | 8482.6 samples/s | 33.1 steps/s
[Step= 550] | Loss=5.75352 | acc=0.1350 | tpr=0.6379 | fpr=0.8741 | 10715.2 samples/s | 41.9 steps/s
Avg test loss: 5.75415, Avg test acc: 0.13492, Avg tpr: 0.63827, Avg fpr: 0.87423, total FA: 121385

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.14242 | acc=0.1334 | tpr=0.6106 | fpr=0.8752 | 5847.8 samples/s | 22.8 steps/s
[Step= 100] | Loss=5.12372 | acc=0.1353 | tpr=0.6013 | fpr=0.8734 | 7582.0 samples/s | 29.6 steps/s
[Step= 150] | Loss=5.11623 | acc=0.1366 | tpr=0.6052 | fpr=0.8720 | 8086.1 samples/s | 31.6 steps/s
[Step= 200] | Loss=5.11041 | acc=0.1372 | tpr=0.5967 | fpr=0.8711 | 7305.3 samples/s | 28.5 steps/s
[Step= 250] | Loss=5.11512 | acc=0.1375 | tpr=0.5904 | fpr=0.8708 | 8387.9 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.11073 | acc=0.1376 | tpr=0.5847 | fpr=0.8705 | 8067.5 samples/s | 31.5 steps/s
[Step= 350] | Loss=5.11726 | acc=0.1374 | tpr=0.5823 | fpr=0.8707 | 8464.8 samples/s | 33.1 steps/s
[Step= 400] | Loss=5.11430 | acc=0.1375 | tpr=0.5821 | fpr=0.8706 | 7181.1 samples/s | 28.1 steps/s
[Step= 450] | Loss=5.11791 | acc=0.1367 | tpr=0.5867 | fpr=0.8714 | 8338.2 samples/s | 32.6 steps/s
[Step= 500] | Loss=5.11718 | acc=0.1366 | tpr=0.5868 | fpr=0.8715 | 8221.8 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.12134 | acc=0.1367 | tpr=0.5889 | fpr=0.8715 | 12039.7 samples/s | 47.0 steps/s
Avg test loss: 5.12182, Avg test acc: 0.13665, Avg tpr: 0.59033, Avg fpr: 0.87160, total FA: 121020

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.51370 | acc=0.1231 | tpr=0.7124 | fpr=0.8875 | 5949.8 samples/s | 23.2 steps/s
[Step= 100] | Loss=5.49380 | acc=0.1254 | tpr=0.6844 | fpr=0.8851 | 7944.1 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.48351 | acc=0.1268 | tpr=0.6945 | fpr=0.8837 | 8363.8 samples/s | 32.7 steps/s
[Step= 200] | Loss=5.47890 | acc=0.1270 | tpr=0.6918 | fpr=0.8833 | 7930.0 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.48056 | acc=0.1270 | tpr=0.6926 | fpr=0.8833 | 7778.5 samples/s | 30.4 steps/s
[Step= 300] | Loss=5.47693 | acc=0.1269 | tpr=0.6924 | fpr=0.8834 | 7727.0 samples/s | 30.2 steps/s
[Step= 350] | Loss=5.48134 | acc=0.1266 | tpr=0.6957 | fpr=0.8837 | 8018.0 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.47927 | acc=0.1268 | tpr=0.6942 | fpr=0.8835 | 8301.1 samples/s | 32.4 steps/s
[Step= 450] | Loss=5.48405 | acc=0.1261 | tpr=0.6972 | fpr=0.8843 | 8168.7 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.48288 | acc=0.1261 | tpr=0.6991 | fpr=0.8842 | 7242.3 samples/s | 28.3 steps/s
[Step= 550] | Loss=5.48948 | acc=0.1262 | tpr=0.6988 | fpr=0.8842 | 11352.8 samples/s | 44.3 steps/s
Avg test loss: 5.49069, Avg test acc: 0.12609, Avg tpr: 0.69929, Avg fpr: 0.88433, total FA: 122787

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.25403 | acc=0.1441 | tpr=0.5221 | fpr=0.8627 | 5984.8 samples/s | 23.4 steps/s
[Step= 100] | Loss=5.24007 | acc=0.1468 | tpr=0.5117 | fpr=0.8600 | 8226.0 samples/s | 32.1 steps/s
[Step= 150] | Loss=5.22999 | acc=0.1487 | tpr=0.5115 | fpr=0.8580 | 7686.2 samples/s | 30.0 steps/s
[Step= 200] | Loss=5.22543 | acc=0.1487 | tpr=0.5038 | fpr=0.8578 | 7628.3 samples/s | 29.8 steps/s
[Step= 250] | Loss=5.22655 | acc=0.1487 | tpr=0.4952 | fpr=0.8576 | 8045.4 samples/s | 31.4 steps/s
[Step= 300] | Loss=5.22244 | acc=0.1485 | tpr=0.4924 | fpr=0.8578 | 8202.0 samples/s | 32.0 steps/s
[Step= 350] | Loss=5.23034 | acc=0.1486 | tpr=0.4897 | fpr=0.8576 | 7993.2 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.22751 | acc=0.1489 | tpr=0.4891 | fpr=0.8573 | 7771.2 samples/s | 30.4 steps/s
[Step= 450] | Loss=5.23217 | acc=0.1482 | tpr=0.4912 | fpr=0.8580 | 8261.2 samples/s | 32.3 steps/s
[Step= 500] | Loss=5.23122 | acc=0.1484 | tpr=0.4952 | fpr=0.8579 | 8223.8 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.23360 | acc=0.1485 | tpr=0.4966 | fpr=0.8578 | 10448.7 samples/s | 40.8 steps/s
Avg test loss: 5.23446, Avg test acc: 0.14849, Avg tpr: 0.49723, Avg fpr: 0.85784, total FA: 119110

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.20565 | acc=0.9608 | tpr=0.9381 | fpr=0.0388 | 5976.3 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.21232 | acc=0.9593 | tpr=0.9488 | fpr=0.0405 | 8237.5 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.21610 | acc=0.9583 | tpr=0.9496 | fpr=0.0416 | 8069.2 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.21625 | acc=0.9581 | tpr=0.9530 | fpr=0.0418 | 7872.2 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.21587 | acc=0.9580 | tpr=0.9520 | fpr=0.0419 | 8019.7 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.21895 | acc=0.9575 | tpr=0.9462 | fpr=0.0423 | 7940.3 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.21785 | acc=0.9575 | tpr=0.9461 | fpr=0.0423 | 7674.2 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.21733 | acc=0.9573 | tpr=0.9437 | fpr=0.0425 | 8062.7 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.22196 | acc=0.9569 | tpr=0.9411 | fpr=0.0428 | 8160.2 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.22143 | acc=0.9569 | tpr=0.9423 | fpr=0.0429 | 7112.4 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.22033 | acc=0.9571 | tpr=0.9419 | fpr=0.0427 | 13116.4 samples/s | 51.2 steps/s
Avg test loss: 0.21994, Avg test acc: 0.95711, Avg tpr: 0.94176, Avg fpr: 0.04261, total FA: 5916

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14120 | acc=0.9637 | tpr=0.9115 | fpr=0.0353 | 5946.0 samples/s | 23.2 steps/s
[Step= 100] | Loss=0.14576 | acc=0.9627 | tpr=0.9232 | fpr=0.0366 | 8220.0 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.14748 | acc=0.9617 | tpr=0.9251 | fpr=0.0376 | 7317.1 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.14765 | acc=0.9616 | tpr=0.9290 | fpr=0.0378 | 7975.4 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.14738 | acc=0.9615 | tpr=0.9284 | fpr=0.0379 | 8282.2 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.14949 | acc=0.9610 | tpr=0.9251 | fpr=0.0383 | 7834.0 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.14833 | acc=0.9612 | tpr=0.9274 | fpr=0.0382 | 8424.8 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.14877 | acc=0.9609 | tpr=0.9261 | fpr=0.0384 | 7025.9 samples/s | 27.4 steps/s
[Step= 450] | Loss=0.15148 | acc=0.9604 | tpr=0.9255 | fpr=0.0390 | 8397.7 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.15110 | acc=0.9603 | tpr=0.9273 | fpr=0.0391 | 8150.7 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.15013 | acc=0.9606 | tpr=0.9268 | fpr=0.0388 | 11845.0 samples/s | 46.3 steps/s
Avg test loss: 0.14991, Avg test acc: 0.96059, Avg tpr: 0.92670, Avg fpr: 0.03880, total FA: 5387

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.25359 | acc=0.9509 | tpr=0.9602 | fpr=0.0492 | 6000.4 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.26131 | acc=0.9501 | tpr=0.9659 | fpr=0.0502 | 7649.5 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.26517 | acc=0.9489 | tpr=0.9654 | fpr=0.0514 | 8465.7 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.26507 | acc=0.9489 | tpr=0.9661 | fpr=0.0514 | 7700.7 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.26510 | acc=0.9487 | tpr=0.9642 | fpr=0.0515 | 8291.1 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.26807 | acc=0.9486 | tpr=0.9593 | fpr=0.0516 | 7967.2 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.26546 | acc=0.9487 | tpr=0.9593 | fpr=0.0515 | 7442.6 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.26555 | acc=0.9484 | tpr=0.9562 | fpr=0.0518 | 8709.4 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.26948 | acc=0.9480 | tpr=0.9542 | fpr=0.0521 | 8274.7 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.26989 | acc=0.9478 | tpr=0.9551 | fpr=0.0523 | 8328.4 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.26803 | acc=0.9481 | tpr=0.9550 | fpr=0.0520 | 9240.8 samples/s | 36.1 steps/s
Avg test loss: 0.26770, Avg test acc: 0.94812, Avg tpr: 0.95483, Avg fpr: 0.05201, total FA: 7221

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14615 | acc=0.9641 | tpr=0.9159 | fpr=0.0350 | 6130.8 samples/s | 23.9 steps/s
[Step= 100] | Loss=0.15435 | acc=0.9620 | tpr=0.9275 | fpr=0.0374 | 7994.6 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.15528 | acc=0.9606 | tpr=0.9308 | fpr=0.0389 | 7237.6 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.15461 | acc=0.9607 | tpr=0.9322 | fpr=0.0388 | 7617.7 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.15451 | acc=0.9606 | tpr=0.9310 | fpr=0.0389 | 8165.3 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.15703 | acc=0.9601 | tpr=0.9302 | fpr=0.0394 | 8336.2 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.15603 | acc=0.9600 | tpr=0.9299 | fpr=0.0394 | 8021.3 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.15575 | acc=0.9599 | tpr=0.9267 | fpr=0.0395 | 8142.7 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.15842 | acc=0.9595 | tpr=0.9265 | fpr=0.0399 | 7827.1 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.15850 | acc=0.9594 | tpr=0.9269 | fpr=0.0400 | 8248.1 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.15739 | acc=0.9597 | tpr=0.9276 | fpr=0.0397 | 11038.6 samples/s | 43.1 steps/s
Avg test loss: 0.15715, Avg test acc: 0.95969, Avg tpr: 0.92750, Avg fpr: 0.03972, total FA: 5515

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.23978 | acc=0.9541 | tpr=0.9115 | fpr=0.0451 | 5942.6 samples/s | 23.2 steps/s
[Step= 100] | Loss=0.24888 | acc=0.9532 | tpr=0.9275 | fpr=0.0463 | 8160.5 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.25424 | acc=0.9516 | tpr=0.9323 | fpr=0.0480 | 7928.0 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.25463 | acc=0.9515 | tpr=0.9355 | fpr=0.0482 | 8044.5 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.25591 | acc=0.9514 | tpr=0.9354 | fpr=0.0483 | 7986.5 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.25895 | acc=0.9510 | tpr=0.9353 | fpr=0.0487 | 7483.4 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.25788 | acc=0.9512 | tpr=0.9374 | fpr=0.0485 | 8201.9 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.25793 | acc=0.9509 | tpr=0.9360 | fpr=0.0488 | 8179.7 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.26198 | acc=0.9505 | tpr=0.9348 | fpr=0.0492 | 8017.7 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.26230 | acc=0.9504 | tpr=0.9344 | fpr=0.0493 | 8121.7 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.26075 | acc=0.9507 | tpr=0.9347 | fpr=0.0490 | 10294.3 samples/s | 40.2 steps/s
Avg test loss: 0.26044, Avg test acc: 0.95077, Avg tpr: 0.93463, Avg fpr: 0.04894, total FA: 6795

server round 27/50

clients selected: [2 3 5 6 7]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=116.9] | Loss=0.01439 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=12.233 | 7003.3 samples/s | 109.4 steps/s
[Step=24050 Epoch=117.2] | Loss=0.02161 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.178 | L2-Norm(final)=12.241 | 4987.2 samples/s | 77.9 steps/s
[Step=24100 Epoch=117.4] | Loss=0.02308 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=12.247 | 5588.0 samples/s | 87.3 steps/s
[Step=24150 Epoch=117.7] | Loss=0.02329 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.178 | L2-Norm(final)=12.251 | 5449.5 samples/s | 85.1 steps/s
[Step=24200 Epoch=117.9] | Loss=0.02385 | Reg=0.00125 | acc=0.9531 | L2-Norm=11.178 | L2-Norm(final)=12.255 | 8569.6 samples/s | 133.9 steps/s
[Step=24250 Epoch=118.2] | Loss=0.02442 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.178 | L2-Norm(final)=12.258 | 2670.5 samples/s | 41.7 steps/s
[Step=24300 Epoch=118.4] | Loss=0.02378 | Reg=0.00125 | acc=0.9688 | L2-Norm=11.178 | L2-Norm(final)=12.261 | 5542.9 samples/s | 86.6 steps/s
[Step=24350 Epoch=118.6] | Loss=0.02329 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=12.266 | 5503.8 samples/s | 86.0 steps/s
[Step=24400 Epoch=118.9] | Loss=0.02394 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.178 | L2-Norm(final)=12.273 | 7714.2 samples/s | 120.5 steps/s
[Step=24450 Epoch=119.1] | Loss=0.02346 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.178 | L2-Norm(final)=12.278 | 2826.0 samples/s | 44.2 steps/s
[Step=24500 Epoch=119.4] | Loss=0.02363 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.178 | L2-Norm(final)=12.284 | 5545.9 samples/s | 86.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=119.4] | Loss=0.00742 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=12.340 | 7386.7 samples/s | 115.4 steps/s
[Step=24550 Epoch=119.6] | Loss=0.03035 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=12.335 | 4177.9 samples/s | 65.3 steps/s
[Step=24600 Epoch=119.9] | Loss=0.03040 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.257 | L2-Norm(final)=12.330 | 4731.7 samples/s | 73.9 steps/s
[Step=24650 Epoch=120.1] | Loss=0.02742 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.289 | L2-Norm(final)=12.328 | 4806.7 samples/s | 75.1 steps/s
[Step=24700 Epoch=120.4] | Loss=0.02581 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.316 | L2-Norm(final)=12.330 | 6767.6 samples/s | 105.7 steps/s
[Step=24750 Epoch=120.6] | Loss=0.02314 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.339 | L2-Norm(final)=12.331 | 2478.4 samples/s | 38.7 steps/s
[Step=24800 Epoch=120.8] | Loss=0.02105 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=12.334 | 4663.1 samples/s | 72.9 steps/s
[Step=24850 Epoch=121.1] | Loss=0.01929 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=12.337 | 4779.6 samples/s | 74.7 steps/s
[Step=24900 Epoch=121.3] | Loss=0.01794 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.388 | L2-Norm(final)=12.340 | 6234.6 samples/s | 97.4 steps/s
[Step=24950 Epoch=121.6] | Loss=0.01710 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.401 | L2-Norm(final)=12.344 | 2581.9 samples/s | 40.3 steps/s
[Step=25000 Epoch=121.8] | Loss=0.01589 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.412 | L2-Norm(final)=12.346 | 4756.3 samples/s | 74.3 steps/s
[Step=25050 Epoch=122.1] | Loss=0.01514 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.422 | L2-Norm(final)=12.349 | 4742.7 samples/s | 74.1 steps/s
[Step=25100 Epoch=122.3] | Loss=0.01452 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.431 | L2-Norm(final)=12.352 | 5737.2 samples/s | 89.6 steps/s
[Step=25150 Epoch=122.5] | Loss=0.01375 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.439 | L2-Norm(final)=12.355 | 2669.8 samples/s | 41.7 steps/s
[Step=25200 Epoch=122.8] | Loss=0.01329 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.447 | L2-Norm(final)=12.357 | 4832.5 samples/s | 75.5 steps/s
[Step=25250 Epoch=123.0] | Loss=0.01264 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.453 | L2-Norm(final)=12.360 | 4780.9 samples/s | 74.7 steps/s
[Step=25300 Epoch=123.3] | Loss=0.01213 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.460 | L2-Norm(final)=12.363 | 5125.5 samples/s | 80.1 steps/s
[Step=25350 Epoch=123.5] | Loss=0.01160 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.466 | L2-Norm(final)=12.365 | 2778.0 samples/s | 43.4 steps/s
[Step=25400 Epoch=123.8] | Loss=0.01118 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.472 | L2-Norm(final)=12.368 | 4755.3 samples/s | 74.3 steps/s
[Step=25450 Epoch=124.0] | Loss=0.01088 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.477 | L2-Norm(final)=12.371 | 4763.2 samples/s | 74.4 steps/s
[Step=25500 Epoch=124.2] | Loss=0.01050 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.482 | L2-Norm(final)=12.374 | 4909.6 samples/s | 76.7 steps/s
[Step=25550 Epoch=124.5] | Loss=0.01023 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.487 | L2-Norm(final)=12.376 | 2913.7 samples/s | 45.5 steps/s
[Step=25600 Epoch=124.7] | Loss=0.01006 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=12.379 | 4716.2 samples/s | 73.7 steps/s
[Step=25650 Epoch=125.0] | Loss=0.00977 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.496 | L2-Norm(final)=12.381 | 4768.6 samples/s | 74.5 steps/s
[Step=25700 Epoch=125.2] | Loss=0.00956 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.500 | L2-Norm(final)=12.383 | 4748.8 samples/s | 74.2 steps/s
[Step=25750 Epoch=125.5] | Loss=0.00931 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.504 | L2-Norm(final)=12.385 | 2949.3 samples/s | 46.1 steps/s
[Step=25800 Epoch=125.7] | Loss=0.00904 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.508 | L2-Norm(final)=12.388 | 4722.7 samples/s | 73.8 steps/s
[Step=25850 Epoch=126.0] | Loss=0.00885 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.512 | L2-Norm(final)=12.390 | 4775.8 samples/s | 74.6 steps/s
[Step=25900 Epoch=126.2] | Loss=0.00867 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.515 | L2-Norm(final)=12.392 | 4741.1 samples/s | 74.1 steps/s
[Step=25950 Epoch=126.4] | Loss=0.00849 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.519 | L2-Norm(final)=12.395 | 2949.7 samples/s | 46.1 steps/s
[Step=26000 Epoch=126.7] | Loss=0.00829 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.522 | L2-Norm(final)=12.397 | 4746.4 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step26000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.00640 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=12.742 | 5930.2 samples/s | 92.7 steps/s
[Step=20050 Epoch=97.8] | Loss=0.02407 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.178 | L2-Norm(final)=12.750 | 5577.4 samples/s | 87.1 steps/s
[Step=20100 Epoch=98.0] | Loss=0.02325 | Reg=0.00125 | acc=0.9531 | L2-Norm=11.178 | L2-Norm(final)=12.757 | 5587.5 samples/s | 87.3 steps/s
[Step=20150 Epoch=98.3] | Loss=0.02359 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=12.766 | 5492.5 samples/s | 85.8 steps/s
[Step=20200 Epoch=98.5] | Loss=0.02424 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.178 | L2-Norm(final)=12.773 | 8628.4 samples/s | 134.8 steps/s
[Step=20250 Epoch=98.8] | Loss=0.02343 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.178 | L2-Norm(final)=12.779 | 2682.4 samples/s | 41.9 steps/s
[Step=20300 Epoch=99.0] | Loss=0.02281 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.178 | L2-Norm(final)=12.786 | 5429.4 samples/s | 84.8 steps/s
[Step=20350 Epoch=99.2] | Loss=0.02310 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=12.794 | 5563.9 samples/s | 86.9 steps/s
[Step=20400 Epoch=99.5] | Loss=0.02335 | Reg=0.00125 | acc=0.9688 | L2-Norm=11.178 | L2-Norm(final)=12.801 | 7581.2 samples/s | 118.5 steps/s
[Step=20450 Epoch=99.7] | Loss=0.02359 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=12.807 | 2798.8 samples/s | 43.7 steps/s
[Step=20500 Epoch=100.0] | Loss=0.02333 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=12.812 | 5611.6 samples/s | 87.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=100.0] | Loss=0.02981 | Reg=0.00125 | acc=0.9688 | L2-Norm=11.178 | L2-Norm(final)=12.869 | 7037.6 samples/s | 110.0 steps/s
[Step=20550 Epoch=100.2] | Loss=0.02521 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.225 | L2-Norm(final)=12.869 | 4313.6 samples/s | 67.4 steps/s
[Step=20600 Epoch=100.5] | Loss=0.02183 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.266 | L2-Norm(final)=12.870 | 4763.8 samples/s | 74.4 steps/s
[Step=20650 Epoch=100.7] | Loss=0.02316 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.299 | L2-Norm(final)=12.872 | 4749.0 samples/s | 74.2 steps/s
[Step=20700 Epoch=100.9] | Loss=0.02203 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=12.873 | 6760.8 samples/s | 105.6 steps/s
[Step=20750 Epoch=101.2] | Loss=0.02006 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=12.876 | 2477.0 samples/s | 38.7 steps/s
[Step=20800 Epoch=101.4] | Loss=0.01855 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=12.879 | 4707.8 samples/s | 73.6 steps/s
[Step=20850 Epoch=101.7] | Loss=0.01714 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.392 | L2-Norm(final)=12.882 | 4814.8 samples/s | 75.2 steps/s
[Step=20900 Epoch=101.9] | Loss=0.01585 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=12.886 | 6198.7 samples/s | 96.9 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01463 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.421 | L2-Norm(final)=12.889 | 2569.4 samples/s | 40.1 steps/s
[Step=21000 Epoch=102.4] | Loss=0.01366 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=12.893 | 4813.1 samples/s | 75.2 steps/s
[Step=21050 Epoch=102.7] | Loss=0.01279 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.443 | L2-Norm(final)=12.897 | 4650.3 samples/s | 72.7 steps/s
[Step=21100 Epoch=102.9] | Loss=0.01203 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.453 | L2-Norm(final)=12.901 | 5746.8 samples/s | 89.8 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01130 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.461 | L2-Norm(final)=12.905 | 2665.5 samples/s | 41.6 steps/s
[Step=21200 Epoch=103.4] | Loss=0.01073 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.469 | L2-Norm(final)=12.909 | 4795.6 samples/s | 74.9 steps/s
[Step=21250 Epoch=103.6] | Loss=0.01038 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=12.912 | 4727.4 samples/s | 73.9 steps/s
[Step=21300 Epoch=103.9] | Loss=0.00990 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.482 | L2-Norm(final)=12.916 | 5271.9 samples/s | 82.4 steps/s
[Step=21350 Epoch=104.1] | Loss=0.00955 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.488 | L2-Norm(final)=12.919 | 2773.5 samples/s | 43.3 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00909 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.494 | L2-Norm(final)=12.922 | 4760.6 samples/s | 74.4 steps/s
[Step=21450 Epoch=104.6] | Loss=0.00876 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.499 | L2-Norm(final)=12.925 | 4725.2 samples/s | 73.8 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00851 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=12.928 | 4926.4 samples/s | 77.0 steps/s
[Step=21550 Epoch=105.1] | Loss=0.00822 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.508 | L2-Norm(final)=12.931 | 2877.3 samples/s | 45.0 steps/s
[Step=21600 Epoch=105.3] | Loss=0.00790 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.512 | L2-Norm(final)=12.934 | 4753.8 samples/s | 74.3 steps/s
[Step=21650 Epoch=105.6] | Loss=0.00765 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.516 | L2-Norm(final)=12.936 | 4817.5 samples/s | 75.3 steps/s
[Step=21700 Epoch=105.8] | Loss=0.00744 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.519 | L2-Norm(final)=12.939 | 4731.2 samples/s | 73.9 steps/s
[Step=21750 Epoch=106.1] | Loss=0.00732 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.523 | L2-Norm(final)=12.942 | 2927.9 samples/s | 45.7 steps/s
[Step=21800 Epoch=106.3] | Loss=0.00714 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.526 | L2-Norm(final)=12.945 | 4763.6 samples/s | 74.4 steps/s
[Step=21850 Epoch=106.6] | Loss=0.00700 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.529 | L2-Norm(final)=12.947 | 4762.9 samples/s | 74.4 steps/s
[Step=21900 Epoch=106.8] | Loss=0.00683 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.532 | L2-Norm(final)=12.950 | 4742.8 samples/s | 74.1 steps/s
[Step=21950 Epoch=107.0] | Loss=0.00671 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.535 | L2-Norm(final)=12.952 | 2939.8 samples/s | 45.9 steps/s
[Step=22000 Epoch=107.3] | Loss=0.00655 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.538 | L2-Norm(final)=12.955 | 4814.9 samples/s | 75.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step22000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=38001 Epoch=360.1] | Loss=0.00160 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=17.275 | 6963.4 samples/s | 108.8 steps/s
[Step=38050 Epoch=360.6] | Loss=0.00013 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.177 | L2-Norm(final)=17.280 | 4444.1 samples/s | 69.4 steps/s
[Step=38100 Epoch=361.0] | Loss=0.00011 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=17.282 | 8206.2 samples/s | 128.2 steps/s
[Step=38150 Epoch=361.5] | Loss=0.00010 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=17.284 | 2555.2 samples/s | 39.9 steps/s
[Step=38200 Epoch=362.0] | Loss=0.00011 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=17.287 | 7321.9 samples/s | 114.4 steps/s
[Step=38250 Epoch=362.5] | Loss=0.00012 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=17.290 | 2689.4 samples/s | 42.0 steps/s
[Step=38300 Epoch=362.9] | Loss=0.00011 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=17.294 | 6511.1 samples/s | 101.7 steps/s
[Step=38350 Epoch=363.4] | Loss=0.00011 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=17.297 | 2807.1 samples/s | 43.9 steps/s
[Step=38400 Epoch=363.9] | Loss=0.00011 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=17.300 | 5859.3 samples/s | 91.6 steps/s
[Step=38450 Epoch=364.3] | Loss=0.00011 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=17.304 | 2978.6 samples/s | 46.5 steps/s
[Step=38500 Epoch=364.8] | Loss=0.00011 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=17.307 | 5330.2 samples/s | 83.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=38501 Epoch=364.8] | Loss=0.00064 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=17.338 | 6681.5 samples/s | 104.4 steps/s
[Step=38550 Epoch=365.3] | Loss=0.00007 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.168 | L2-Norm(final)=17.343 | 4155.1 samples/s | 64.9 steps/s
[Step=38600 Epoch=365.8] | Loss=0.00004 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=17.344 | 6606.4 samples/s | 103.2 steps/s
[Step=38650 Epoch=366.2] | Loss=0.00003 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.145 | L2-Norm(final)=17.345 | 2397.6 samples/s | 37.5 steps/s
[Step=38700 Epoch=366.7] | Loss=0.00002 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.134 | L2-Norm(final)=17.346 | 5926.6 samples/s | 92.6 steps/s
[Step=38750 Epoch=367.2] | Loss=0.00002 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.124 | L2-Norm(final)=17.347 | 2486.9 samples/s | 38.9 steps/s
[Step=38800 Epoch=367.7] | Loss=0.00002 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.114 | L2-Norm(final)=17.348 | 5404.9 samples/s | 84.5 steps/s
[Step=38850 Epoch=368.1] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=17.349 | 2624.5 samples/s | 41.0 steps/s
[Step=38900 Epoch=368.6] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.096 | L2-Norm(final)=17.350 | 4872.4 samples/s | 76.1 steps/s
[Step=38950 Epoch=369.1] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=17.351 | 2696.2 samples/s | 42.1 steps/s
[Step=39000 Epoch=369.6] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.078 | L2-Norm(final)=17.353 | 4599.4 samples/s | 71.9 steps/s
[Step=39050 Epoch=370.0] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.070 | L2-Norm(final)=17.354 | 2453.0 samples/s | 38.3 steps/s
[Step=39100 Epoch=370.5] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.062 | L2-Norm(final)=17.355 | 4412.0 samples/s | 68.9 steps/s
[Step=39150 Epoch=371.0] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.053 | L2-Norm(final)=17.356 | 2868.4 samples/s | 44.8 steps/s
[Step=39200 Epoch=371.5] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.045 | L2-Norm(final)=17.357 | 4514.2 samples/s | 70.5 steps/s
[Step=39250 Epoch=371.9] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.037 | L2-Norm(final)=17.358 | 2873.1 samples/s | 44.9 steps/s
[Step=39300 Epoch=372.4] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.029 | L2-Norm(final)=17.359 | 4582.9 samples/s | 71.6 steps/s
[Step=39350 Epoch=372.9] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=17.360 | 2892.6 samples/s | 45.2 steps/s
[Step=39400 Epoch=373.3] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.012 | L2-Norm(final)=17.361 | 4447.3 samples/s | 69.5 steps/s
[Step=39450 Epoch=373.8] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.004 | L2-Norm(final)=17.362 | 6678.7 samples/s | 104.4 steps/s
[Step=39500 Epoch=374.3] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.996 | L2-Norm(final)=17.363 | 2368.7 samples/s | 37.0 steps/s
[Step=39550 Epoch=374.8] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.988 | L2-Norm(final)=17.364 | 6216.5 samples/s | 97.1 steps/s
[Step=39600 Epoch=375.2] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.980 | L2-Norm(final)=17.365 | 2463.5 samples/s | 38.5 steps/s
[Step=39650 Epoch=375.7] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.972 | L2-Norm(final)=17.366 | 5555.8 samples/s | 86.8 steps/s
[Step=39700 Epoch=376.2] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.964 | L2-Norm(final)=17.367 | 2561.9 samples/s | 40.0 steps/s
[Step=39750 Epoch=376.7] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=17.368 | 5052.1 samples/s | 78.9 steps/s
[Step=39800 Epoch=377.1] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.947 | L2-Norm(final)=17.368 | 2664.8 samples/s | 41.6 steps/s
[Step=39850 Epoch=377.6] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.939 | L2-Norm(final)=17.369 | 4722.1 samples/s | 73.8 steps/s
[Step=39900 Epoch=378.1] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.931 | L2-Norm(final)=17.370 | 2756.8 samples/s | 43.1 steps/s
[Step=39950 Epoch=378.6] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=17.371 | 4510.4 samples/s | 70.5 steps/s
[Step=40000 Epoch=379.0] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.914 | L2-Norm(final)=17.372 | 2833.9 samples/s | 44.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step40000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=228.3] | Loss=0.00815 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.178 | L2-Norm(final)=14.210 | 6466.6 samples/s | 101.0 steps/s
[Step=24050 Epoch=228.8] | Loss=0.00119 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.175 | L2-Norm(final)=14.230 | 4590.8 samples/s | 71.7 steps/s
[Step=24100 Epoch=229.3] | Loss=0.00105 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.175 | L2-Norm(final)=14.255 | 8098.4 samples/s | 126.5 steps/s
[Step=24150 Epoch=229.7] | Loss=0.00097 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=14.280 | 2591.2 samples/s | 40.5 steps/s
[Step=24200 Epoch=230.2] | Loss=0.00097 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=14.303 | 7066.2 samples/s | 110.4 steps/s
[Step=24250 Epoch=230.7] | Loss=0.00099 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=14.324 | 2693.0 samples/s | 42.1 steps/s
[Step=24300 Epoch=231.2] | Loss=0.00096 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=14.343 | 6408.4 samples/s | 100.1 steps/s
[Step=24350 Epoch=231.6] | Loss=0.00097 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=14.362 | 2773.4 samples/s | 43.3 steps/s
[Step=24400 Epoch=232.1] | Loss=0.00095 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=14.379 | 5980.7 samples/s | 93.4 steps/s
[Step=24450 Epoch=232.6] | Loss=0.00093 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=14.396 | 2914.0 samples/s | 45.5 steps/s
[Step=24500 Epoch=233.1] | Loss=0.00091 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=14.412 | 5456.2 samples/s | 85.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=233.1] | Loss=0.00004 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=14.570 | 7114.9 samples/s | 111.2 steps/s
[Step=24550 Epoch=233.5] | Loss=0.00159 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.217 | L2-Norm(final)=14.575 | 4025.9 samples/s | 62.9 steps/s
[Step=24600 Epoch=234.0] | Loss=0.00088 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.267 | L2-Norm(final)=14.573 | 6526.1 samples/s | 102.0 steps/s
[Step=24650 Epoch=234.5] | Loss=0.00059 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=14.573 | 2358.6 samples/s | 36.9 steps/s
[Step=24700 Epoch=235.0] | Loss=0.00044 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=14.574 | 6023.9 samples/s | 94.1 steps/s
[Step=24750 Epoch=235.4] | Loss=0.00036 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.279 | L2-Norm(final)=14.575 | 2481.5 samples/s | 38.8 steps/s
[Step=24800 Epoch=235.9] | Loss=0.00030 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.272 | L2-Norm(final)=14.575 | 5486.5 samples/s | 85.7 steps/s
[Step=24850 Epoch=236.4] | Loss=0.00026 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.264 | L2-Norm(final)=14.576 | 2572.4 samples/s | 40.2 steps/s
[Step=24900 Epoch=236.9] | Loss=0.00023 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.255 | L2-Norm(final)=14.576 | 5041.3 samples/s | 78.8 steps/s
[Step=24950 Epoch=237.3] | Loss=0.00020 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.246 | L2-Norm(final)=14.577 | 2674.7 samples/s | 41.8 steps/s
[Step=25000 Epoch=237.8] | Loss=0.00018 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.236 | L2-Norm(final)=14.577 | 4662.7 samples/s | 72.9 steps/s
[Step=25050 Epoch=238.3] | Loss=0.00016 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.226 | L2-Norm(final)=14.578 | 2823.9 samples/s | 44.1 steps/s
[Step=25100 Epoch=238.8] | Loss=0.00015 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.216 | L2-Norm(final)=14.578 | 4590.2 samples/s | 71.7 steps/s
[Step=25150 Epoch=239.2] | Loss=0.00014 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=14.578 | 2852.7 samples/s | 44.6 steps/s
[Step=25200 Epoch=239.7] | Loss=0.00013 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.196 | L2-Norm(final)=14.579 | 4490.5 samples/s | 70.2 steps/s
[Step=25250 Epoch=240.2] | Loss=0.00012 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.185 | L2-Norm(final)=14.579 | 2851.8 samples/s | 44.6 steps/s
[Step=25300 Epoch=240.7] | Loss=0.00011 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.175 | L2-Norm(final)=14.580 | 4597.1 samples/s | 71.8 steps/s
[Step=25350 Epoch=241.1] | Loss=0.00011 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.164 | L2-Norm(final)=14.580 | 2979.2 samples/s | 46.5 steps/s
[Step=25400 Epoch=241.6] | Loss=0.00010 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.153 | L2-Norm(final)=14.580 | 4345.9 samples/s | 67.9 steps/s
[Step=25450 Epoch=242.1] | Loss=0.00010 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.143 | L2-Norm(final)=14.581 | 6596.4 samples/s | 103.1 steps/s
[Step=25500 Epoch=242.6] | Loss=0.00009 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.132 | L2-Norm(final)=14.581 | 2365.2 samples/s | 37.0 steps/s
[Step=25550 Epoch=243.0] | Loss=0.00009 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.121 | L2-Norm(final)=14.581 | 6054.2 samples/s | 94.6 steps/s
[Step=25600 Epoch=243.5] | Loss=0.00008 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.110 | L2-Norm(final)=14.582 | 2454.1 samples/s | 38.3 steps/s
[Step=25650 Epoch=244.0] | Loss=0.00008 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.099 | L2-Norm(final)=14.582 | 5618.6 samples/s | 87.8 steps/s
[Step=25700 Epoch=244.5] | Loss=0.00008 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.089 | L2-Norm(final)=14.582 | 2578.7 samples/s | 40.3 steps/s
[Step=25750 Epoch=244.9] | Loss=0.00007 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.078 | L2-Norm(final)=14.583 | 5069.3 samples/s | 79.2 steps/s
[Step=25800 Epoch=245.4] | Loss=0.00007 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.067 | L2-Norm(final)=14.583 | 2673.8 samples/s | 41.8 steps/s
[Step=25850 Epoch=245.9] | Loss=0.00007 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.055 | L2-Norm(final)=14.583 | 4767.2 samples/s | 74.5 steps/s
[Step=25900 Epoch=246.4] | Loss=0.00007 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.044 | L2-Norm(final)=14.584 | 2776.8 samples/s | 43.4 steps/s
[Step=25950 Epoch=246.8] | Loss=0.00006 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.033 | L2-Norm(final)=14.584 | 4576.7 samples/s | 71.5 steps/s
[Step=26000 Epoch=247.3] | Loss=0.00006 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=14.584 | 2838.2 samples/s | 44.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step26000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=248.3] | Loss=0.00011 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=13.536 | 7456.0 samples/s | 116.5 steps/s
[Step=26050 Epoch=248.8] | Loss=0.00081 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=13.562 | 4371.3 samples/s | 68.3 steps/s
[Step=26100 Epoch=249.2] | Loss=0.00077 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=13.588 | 8445.7 samples/s | 132.0 steps/s
[Step=26150 Epoch=249.7] | Loss=0.00071 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=13.612 | 2546.0 samples/s | 39.8 steps/s
[Step=26200 Epoch=250.2] | Loss=0.00077 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=13.635 | 7593.4 samples/s | 118.6 steps/s
[Step=26250 Epoch=250.7] | Loss=0.00072 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=13.656 | 2646.0 samples/s | 41.3 steps/s
[Step=26300 Epoch=251.1] | Loss=0.00071 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=13.675 | 6846.1 samples/s | 107.0 steps/s
[Step=26350 Epoch=251.6] | Loss=0.00070 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=13.693 | 2752.0 samples/s | 43.0 steps/s
[Step=26400 Epoch=252.1] | Loss=0.00072 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=13.711 | 6210.2 samples/s | 97.0 steps/s
[Step=26450 Epoch=252.6] | Loss=0.00069 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=13.728 | 2836.1 samples/s | 44.3 steps/s
[Step=26500 Epoch=253.1] | Loss=0.00072 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=13.744 | 5824.4 samples/s | 91.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=253.1] | Loss=0.00005 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=13.907 | 7098.0 samples/s | 110.9 steps/s
[Step=26550 Epoch=253.5] | Loss=0.00035 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.204 | L2-Norm(final)=13.919 | 4069.9 samples/s | 63.6 steps/s
[Step=26600 Epoch=254.0] | Loss=0.00308 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.242 | L2-Norm(final)=13.917 | 6775.0 samples/s | 105.9 steps/s
[Step=26650 Epoch=254.5] | Loss=0.00209 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.275 | L2-Norm(final)=13.912 | 2380.8 samples/s | 37.2 steps/s
[Step=26700 Epoch=255.0] | Loss=0.00158 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=13.910 | 6119.1 samples/s | 95.6 steps/s
[Step=26750 Epoch=255.4] | Loss=0.00127 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=13.910 | 2471.6 samples/s | 38.6 steps/s
[Step=26800 Epoch=255.9] | Loss=0.00106 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=13.909 | 5555.2 samples/s | 86.8 steps/s
[Step=26850 Epoch=256.4] | Loss=0.00091 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.291 | L2-Norm(final)=13.909 | 2494.1 samples/s | 39.0 steps/s
[Step=26900 Epoch=256.9] | Loss=0.00079 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=13.910 | 5303.8 samples/s | 82.9 steps/s
[Step=26950 Epoch=257.4] | Loss=0.00071 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=13.910 | 2626.1 samples/s | 41.0 steps/s
[Step=27000 Epoch=257.8] | Loss=0.00064 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.277 | L2-Norm(final)=13.911 | 4923.0 samples/s | 76.9 steps/s
[Step=27050 Epoch=258.3] | Loss=0.00058 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.271 | L2-Norm(final)=13.911 | 2725.5 samples/s | 42.6 steps/s
[Step=27100 Epoch=258.8] | Loss=0.00053 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.265 | L2-Norm(final)=13.912 | 4598.0 samples/s | 71.8 steps/s
[Step=27150 Epoch=259.3] | Loss=0.00049 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.259 | L2-Norm(final)=13.912 | 2825.7 samples/s | 44.2 steps/s
[Step=27200 Epoch=259.7] | Loss=0.00046 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.253 | L2-Norm(final)=13.913 | 4481.4 samples/s | 70.0 steps/s
[Step=27250 Epoch=260.2] | Loss=0.00043 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.246 | L2-Norm(final)=13.914 | 2860.7 samples/s | 44.7 steps/s
[Step=27300 Epoch=260.7] | Loss=0.00040 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.239 | L2-Norm(final)=13.914 | 4555.2 samples/s | 71.2 steps/s
[Step=27350 Epoch=261.2] | Loss=0.00038 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.233 | L2-Norm(final)=13.915 | 2840.1 samples/s | 44.4 steps/s
[Step=27400 Epoch=261.7] | Loss=0.00036 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.226 | L2-Norm(final)=13.916 | 4580.5 samples/s | 71.6 steps/s
[Step=27450 Epoch=262.1] | Loss=0.00034 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.219 | L2-Norm(final)=13.916 | 2818.1 samples/s | 44.0 steps/s
[Step=27500 Epoch=262.6] | Loss=0.00032 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.212 | L2-Norm(final)=13.917 | 4542.2 samples/s | 71.0 steps/s
[Step=27550 Epoch=263.1] | Loss=0.00031 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=13.918 | 7302.9 samples/s | 114.1 steps/s
[Step=27600 Epoch=263.6] | Loss=0.00029 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.198 | L2-Norm(final)=13.919 | 2292.7 samples/s | 35.8 steps/s
[Step=27650 Epoch=264.0] | Loss=0.00028 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=13.919 | 6608.8 samples/s | 103.3 steps/s
[Step=27700 Epoch=264.5] | Loss=0.00027 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.184 | L2-Norm(final)=13.920 | 2403.7 samples/s | 37.6 steps/s
[Step=27750 Epoch=265.0] | Loss=0.00026 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.177 | L2-Norm(final)=13.921 | 6023.4 samples/s | 94.1 steps/s
[Step=27800 Epoch=265.5] | Loss=0.00025 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.170 | L2-Norm(final)=13.922 | 2447.7 samples/s | 38.2 steps/s
[Step=27850 Epoch=266.0] | Loss=0.00024 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.163 | L2-Norm(final)=13.923 | 5686.7 samples/s | 88.9 steps/s
[Step=27900 Epoch=266.4] | Loss=0.00023 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=13.924 | 2538.7 samples/s | 39.7 steps/s
[Step=27950 Epoch=266.9] | Loss=0.00022 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.148 | L2-Norm(final)=13.925 | 5200.5 samples/s | 81.3 steps/s
[Step=28000 Epoch=267.4] | Loss=0.00021 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.141 | L2-Norm(final)=13.925 | 2639.9 samples/s | 41.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09397 | acc=0.9625 | tpr=0.9710 | fpr=0.0560 | 5955.4 samples/s | 23.3 steps/s
Avg test loss: 0.10263, Avg test acc: 0.95849, Avg tpr: 0.96724, Avg fpr: 0.06076, total FA: 474

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10992 | acc=0.9589 | tpr=0.9724 | fpr=0.0704 | 6092.3 samples/s | 23.8 steps/s
Avg test loss: 0.11332, Avg test acc: 0.95773, Avg tpr: 0.97097, Avg fpr: 0.07140, total FA: 557

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.10135 | acc=0.9605 | tpr=0.9754 | fpr=0.0719 | 5906.3 samples/s | 23.1 steps/s
Avg test loss: 0.10531, Avg test acc: 0.95873, Avg tpr: 0.97272, Avg fpr: 0.07204, total FA: 562

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10222 | acc=0.9585 | tpr=0.9736 | fpr=0.0743 | 5932.2 samples/s | 23.2 steps/s
Avg test loss: 0.10737, Avg test acc: 0.95753, Avg tpr: 0.97342, Avg fpr: 0.07743, total FA: 604

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09980 | acc=0.9590 | tpr=0.9654 | fpr=0.0550 | 6050.3 samples/s | 23.6 steps/s
Avg test loss: 0.10517, Avg test acc: 0.95765, Avg tpr: 0.96380, Avg fpr: 0.05589, total FA: 436

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.16570 | acc=0.2642 | tpr=0.0245 | fpr=0.2153 | 6017.1 samples/s | 23.5 steps/s
Avg test loss: 6.17270, Avg test acc: 0.26396, Avg tpr: 0.02361, Avg fpr: 0.20741, total FA: 1618

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.98928 | acc=0.3066 | tpr=0.0197 | fpr=0.0704 | 5869.8 samples/s | 22.9 steps/s
Avg test loss: 5.00277, Avg test acc: 0.30459, Avg tpr: 0.01988, Avg fpr: 0.06922, total FA: 540

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.35529 | acc=0.2973 | tpr=0.0095 | fpr=0.0778 | 6133.7 samples/s | 24.0 steps/s
Avg test loss: 5.36321, Avg test acc: 0.29526, Avg tpr: 0.00938, Avg fpr: 0.07602, total FA: 593

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.77238 | acc=0.2818 | tpr=0.0268 | fpr=0.1645 | 6007.0 samples/s | 23.5 steps/s
Avg test loss: 5.77930, Avg test acc: 0.28019, Avg tpr: 0.02483, Avg fpr: 0.15818, total FA: 1234

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.62707 | acc=0.3058 | tpr=0.0157 | fpr=0.0644 | 5812.2 samples/s | 22.7 steps/s
Avg test loss: 5.64633, Avg test acc: 0.30375, Avg tpr: 0.01556, Avg fpr: 0.06243, total FA: 487

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.66641 | acc=0.1336 | tpr=0.6681 | fpr=0.8760 | 5987.4 samples/s | 23.4 steps/s
[Step= 100] | Loss=5.64262 | acc=0.1378 | tpr=0.6397 | fpr=0.8716 | 7912.1 samples/s | 30.9 steps/s
[Step= 150] | Loss=5.63788 | acc=0.1401 | tpr=0.6527 | fpr=0.8693 | 7705.2 samples/s | 30.1 steps/s
[Step= 200] | Loss=5.63089 | acc=0.1401 | tpr=0.6459 | fpr=0.8691 | 7631.9 samples/s | 29.8 steps/s
[Step= 250] | Loss=5.63600 | acc=0.1394 | tpr=0.6402 | fpr=0.8697 | 7880.9 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.62752 | acc=0.1398 | tpr=0.6378 | fpr=0.8693 | 8122.2 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.63395 | acc=0.1391 | tpr=0.6343 | fpr=0.8698 | 7707.3 samples/s | 30.1 steps/s
[Step= 400] | Loss=5.63056 | acc=0.1393 | tpr=0.6302 | fpr=0.8696 | 8291.9 samples/s | 32.4 steps/s
[Step= 450] | Loss=5.63530 | acc=0.1387 | tpr=0.6329 | fpr=0.8702 | 8491.8 samples/s | 33.2 steps/s
[Step= 500] | Loss=5.63457 | acc=0.1388 | tpr=0.6357 | fpr=0.8702 | 8018.5 samples/s | 31.3 steps/s
[Step= 550] | Loss=5.63836 | acc=0.1387 | tpr=0.6407 | fpr=0.8704 | 10853.4 samples/s | 42.4 steps/s
Avg test loss: 5.63876, Avg test acc: 0.13867, Avg tpr: 0.64144, Avg fpr: 0.87047, total FA: 120863

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.77937 | acc=0.1306 | tpr=0.6150 | fpr=0.8781 | 6002.5 samples/s | 23.4 steps/s
[Step= 100] | Loss=5.76048 | acc=0.1352 | tpr=0.6247 | fpr=0.8739 | 7706.3 samples/s | 30.1 steps/s
[Step= 150] | Loss=5.75181 | acc=0.1367 | tpr=0.6427 | fpr=0.8726 | 8081.5 samples/s | 31.6 steps/s
[Step= 200] | Loss=5.74350 | acc=0.1366 | tpr=0.6383 | fpr=0.8725 | 8647.6 samples/s | 33.8 steps/s
[Step= 250] | Loss=5.74925 | acc=0.1363 | tpr=0.6367 | fpr=0.8728 | 8244.0 samples/s | 32.2 steps/s
[Step= 300] | Loss=5.74325 | acc=0.1358 | tpr=0.6284 | fpr=0.8732 | 7050.1 samples/s | 27.5 steps/s
[Step= 350] | Loss=5.75111 | acc=0.1355 | tpr=0.6255 | fpr=0.8734 | 8379.7 samples/s | 32.7 steps/s
[Step= 400] | Loss=5.74615 | acc=0.1357 | tpr=0.6269 | fpr=0.8733 | 8066.0 samples/s | 31.5 steps/s
[Step= 450] | Loss=5.74940 | acc=0.1351 | tpr=0.6319 | fpr=0.8739 | 8051.8 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.74988 | acc=0.1350 | tpr=0.6348 | fpr=0.8741 | 7661.8 samples/s | 29.9 steps/s
[Step= 550] | Loss=5.75352 | acc=0.1350 | tpr=0.6379 | fpr=0.8741 | 11008.6 samples/s | 43.0 steps/s
Avg test loss: 5.75415, Avg test acc: 0.13492, Avg tpr: 0.63827, Avg fpr: 0.87423, total FA: 121385

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.58034 | acc=0.1250 | tpr=0.6504 | fpr=0.8844 | 6016.4 samples/s | 23.5 steps/s
[Step= 100] | Loss=5.55634 | acc=0.1257 | tpr=0.6461 | fpr=0.8840 | 7375.2 samples/s | 28.8 steps/s
[Step= 150] | Loss=5.54722 | acc=0.1274 | tpr=0.6499 | fpr=0.8822 | 7997.6 samples/s | 31.2 steps/s
[Step= 200] | Loss=5.54166 | acc=0.1282 | tpr=0.6383 | fpr=0.8811 | 7800.3 samples/s | 30.5 steps/s
[Step= 250] | Loss=5.54484 | acc=0.1287 | tpr=0.6393 | fpr=0.8806 | 8026.9 samples/s | 31.4 steps/s
[Step= 300] | Loss=5.54059 | acc=0.1289 | tpr=0.6342 | fpr=0.8803 | 7843.9 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.54834 | acc=0.1288 | tpr=0.6324 | fpr=0.8804 | 8038.6 samples/s | 31.4 steps/s
[Step= 400] | Loss=5.54659 | acc=0.1289 | tpr=0.6296 | fpr=0.8802 | 8480.1 samples/s | 33.1 steps/s
[Step= 450] | Loss=5.55130 | acc=0.1281 | tpr=0.6324 | fpr=0.8810 | 8343.1 samples/s | 32.6 steps/s
[Step= 500] | Loss=5.55003 | acc=0.1283 | tpr=0.6344 | fpr=0.8809 | 7537.3 samples/s | 29.4 steps/s
[Step= 550] | Loss=5.55408 | acc=0.1284 | tpr=0.6351 | fpr=0.8808 | 11710.3 samples/s | 45.7 steps/s
Avg test loss: 5.55475, Avg test acc: 0.12829, Avg tpr: 0.63669, Avg fpr: 0.88096, total FA: 122319

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.77950 | acc=0.1355 | tpr=0.6814 | fpr=0.8743 | 6177.6 samples/s | 24.1 steps/s
[Step= 100] | Loss=5.76258 | acc=0.1379 | tpr=0.6588 | fpr=0.8718 | 7530.9 samples/s | 29.4 steps/s
[Step= 150] | Loss=5.74797 | acc=0.1395 | tpr=0.6700 | fpr=0.8703 | 8203.5 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.73847 | acc=0.1398 | tpr=0.6634 | fpr=0.8697 | 7774.0 samples/s | 30.4 steps/s
[Step= 250] | Loss=5.74136 | acc=0.1396 | tpr=0.6594 | fpr=0.8698 | 8008.8 samples/s | 31.3 steps/s
[Step= 300] | Loss=5.73557 | acc=0.1390 | tpr=0.6567 | fpr=0.8705 | 7901.4 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.74135 | acc=0.1389 | tpr=0.6562 | fpr=0.8704 | 7948.8 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.73827 | acc=0.1395 | tpr=0.6565 | fpr=0.8699 | 8094.2 samples/s | 31.6 steps/s
[Step= 450] | Loss=5.74342 | acc=0.1386 | tpr=0.6573 | fpr=0.8708 | 7860.4 samples/s | 30.7 steps/s
[Step= 500] | Loss=5.74306 | acc=0.1387 | tpr=0.6604 | fpr=0.8707 | 8262.4 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.74917 | acc=0.1388 | tpr=0.6614 | fpr=0.8707 | 10275.6 samples/s | 40.1 steps/s
Avg test loss: 5.75013, Avg test acc: 0.13873, Avg tpr: 0.66165, Avg fpr: 0.87077, total FA: 120905

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.25403 | acc=0.1441 | tpr=0.5221 | fpr=0.8627 | 5816.3 samples/s | 22.7 steps/s
[Step= 100] | Loss=5.24007 | acc=0.1468 | tpr=0.5117 | fpr=0.8600 | 7997.5 samples/s | 31.2 steps/s
[Step= 150] | Loss=5.22999 | acc=0.1487 | tpr=0.5115 | fpr=0.8580 | 7914.7 samples/s | 30.9 steps/s
[Step= 200] | Loss=5.22543 | acc=0.1487 | tpr=0.5038 | fpr=0.8578 | 7951.3 samples/s | 31.1 steps/s
[Step= 250] | Loss=5.22655 | acc=0.1487 | tpr=0.4952 | fpr=0.8576 | 8331.2 samples/s | 32.5 steps/s
[Step= 300] | Loss=5.22244 | acc=0.1485 | tpr=0.4924 | fpr=0.8578 | 7930.9 samples/s | 31.0 steps/s
[Step= 350] | Loss=5.23034 | acc=0.1486 | tpr=0.4897 | fpr=0.8576 | 7898.0 samples/s | 30.9 steps/s
[Step= 400] | Loss=5.22751 | acc=0.1489 | tpr=0.4891 | fpr=0.8573 | 8250.6 samples/s | 32.2 steps/s
[Step= 450] | Loss=5.23217 | acc=0.1482 | tpr=0.4912 | fpr=0.8580 | 7763.9 samples/s | 30.3 steps/s
[Step= 500] | Loss=5.23122 | acc=0.1484 | tpr=0.4952 | fpr=0.8579 | 8271.9 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.23360 | acc=0.1485 | tpr=0.4966 | fpr=0.8578 | 10326.8 samples/s | 40.3 steps/s
Avg test loss: 5.23446, Avg test acc: 0.14849, Avg tpr: 0.49723, Avg fpr: 0.85784, total FA: 119110

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.22977 | acc=0.9591 | tpr=0.9469 | fpr=0.0407 | 6150.5 samples/s | 24.0 steps/s
[Step= 100] | Loss=0.23825 | acc=0.9581 | tpr=0.9552 | fpr=0.0419 | 7615.6 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.24091 | acc=0.9565 | tpr=0.9568 | fpr=0.0435 | 7610.7 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.24092 | acc=0.9565 | tpr=0.9596 | fpr=0.0436 | 7705.5 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.24075 | acc=0.9563 | tpr=0.9563 | fpr=0.0438 | 7913.1 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.24482 | acc=0.9557 | tpr=0.9527 | fpr=0.0442 | 8202.9 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.24268 | acc=0.9559 | tpr=0.9518 | fpr=0.0441 | 8333.1 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.24275 | acc=0.9557 | tpr=0.9502 | fpr=0.0442 | 7667.4 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.24717 | acc=0.9551 | tpr=0.9489 | fpr=0.0448 | 8276.2 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.24722 | acc=0.9550 | tpr=0.9498 | fpr=0.0449 | 8118.9 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.24540 | acc=0.9553 | tpr=0.9507 | fpr=0.0446 | 10923.8 samples/s | 42.7 steps/s
Avg test loss: 0.24501, Avg test acc: 0.95529, Avg tpr: 0.95048, Avg fpr: 0.04462, total FA: 6196

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.17231 | acc=0.9611 | tpr=0.8982 | fpr=0.0378 | 5957.3 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.17963 | acc=0.9600 | tpr=0.9190 | fpr=0.0392 | 7819.5 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.18279 | acc=0.9589 | tpr=0.9280 | fpr=0.0406 | 7942.8 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.18282 | acc=0.9588 | tpr=0.9322 | fpr=0.0407 | 8311.2 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.18337 | acc=0.9588 | tpr=0.9301 | fpr=0.0407 | 7874.6 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.18543 | acc=0.9584 | tpr=0.9273 | fpr=0.0411 | 8385.6 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.18354 | acc=0.9585 | tpr=0.9280 | fpr=0.0409 | 7895.9 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.18432 | acc=0.9581 | tpr=0.9256 | fpr=0.0413 | 6936.9 samples/s | 27.1 steps/s
[Step= 450] | Loss=0.18762 | acc=0.9576 | tpr=0.9245 | fpr=0.0418 | 8615.3 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.18738 | acc=0.9575 | tpr=0.9260 | fpr=0.0419 | 7762.5 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.18650 | acc=0.9578 | tpr=0.9256 | fpr=0.0416 | 11479.9 samples/s | 44.8 steps/s
Avg test loss: 0.18617, Avg test acc: 0.95780, Avg tpr: 0.92552, Avg fpr: 0.04161, total FA: 5778

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26150 | acc=0.9484 | tpr=0.9513 | fpr=0.0517 | 6075.2 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.26395 | acc=0.9479 | tpr=0.9488 | fpr=0.0521 | 7507.9 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.26755 | acc=0.9471 | tpr=0.9481 | fpr=0.0529 | 8401.8 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.26766 | acc=0.9471 | tpr=0.9519 | fpr=0.0529 | 7135.1 samples/s | 27.9 steps/s
[Step= 250] | Loss=0.26741 | acc=0.9471 | tpr=0.9485 | fpr=0.0529 | 8136.0 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.26986 | acc=0.9467 | tpr=0.9455 | fpr=0.0533 | 8252.3 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.26818 | acc=0.9467 | tpr=0.9455 | fpr=0.0533 | 8201.7 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.26816 | acc=0.9464 | tpr=0.9426 | fpr=0.0535 | 8219.7 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.27162 | acc=0.9459 | tpr=0.9396 | fpr=0.0539 | 8225.5 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.27219 | acc=0.9457 | tpr=0.9414 | fpr=0.0542 | 7518.4 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.27029 | acc=0.9461 | tpr=0.9407 | fpr=0.0538 | 11379.1 samples/s | 44.4 steps/s
Avg test loss: 0.26997, Avg test acc: 0.94611, Avg tpr: 0.94057, Avg fpr: 0.05379, total FA: 7468

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14615 | acc=0.9641 | tpr=0.9159 | fpr=0.0350 | 5721.5 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.15435 | acc=0.9620 | tpr=0.9275 | fpr=0.0374 | 8104.7 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.15528 | acc=0.9606 | tpr=0.9308 | fpr=0.0389 | 8031.7 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.15461 | acc=0.9607 | tpr=0.9322 | fpr=0.0388 | 8588.2 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.15451 | acc=0.9606 | tpr=0.9310 | fpr=0.0389 | 7474.6 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.15703 | acc=0.9601 | tpr=0.9302 | fpr=0.0394 | 8078.7 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.15603 | acc=0.9600 | tpr=0.9299 | fpr=0.0394 | 7775.8 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.15575 | acc=0.9599 | tpr=0.9267 | fpr=0.0395 | 8014.6 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.15842 | acc=0.9595 | tpr=0.9265 | fpr=0.0399 | 8045.0 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.15850 | acc=0.9594 | tpr=0.9269 | fpr=0.0400 | 7151.5 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.15739 | acc=0.9597 | tpr=0.9276 | fpr=0.0397 | 13006.4 samples/s | 50.8 steps/s
Avg test loss: 0.15715, Avg test acc: 0.95969, Avg tpr: 0.92750, Avg fpr: 0.03972, total FA: 5515

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.23978 | acc=0.9541 | tpr=0.9115 | fpr=0.0451 | 6272.2 samples/s | 24.5 steps/s
[Step= 100] | Loss=0.24888 | acc=0.9532 | tpr=0.9275 | fpr=0.0463 | 7049.5 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.25424 | acc=0.9516 | tpr=0.9323 | fpr=0.0480 | 7985.0 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.25463 | acc=0.9515 | tpr=0.9355 | fpr=0.0482 | 8314.1 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.25591 | acc=0.9514 | tpr=0.9354 | fpr=0.0483 | 8390.5 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.25895 | acc=0.9510 | tpr=0.9353 | fpr=0.0487 | 8006.1 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.25788 | acc=0.9512 | tpr=0.9374 | fpr=0.0485 | 8237.9 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.25793 | acc=0.9509 | tpr=0.9360 | fpr=0.0488 | 8378.6 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.26198 | acc=0.9505 | tpr=0.9348 | fpr=0.0492 | 7845.4 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.26230 | acc=0.9504 | tpr=0.9344 | fpr=0.0493 | 7473.5 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.26075 | acc=0.9507 | tpr=0.9347 | fpr=0.0490 | 11196.2 samples/s | 43.7 steps/s
Avg test loss: 0.26044, Avg test acc: 0.95077, Avg tpr: 0.93463, Avg fpr: 0.04894, total FA: 6795

server round 28/50

clients selected: [2 4 5 7 8]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=126.7] | Loss=0.00609 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.098 | L2-Norm(final)=12.463 | 6954.6 samples/s | 108.7 steps/s
[Step=26050 Epoch=126.9] | Loss=0.02597 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.098 | L2-Norm(final)=12.462 | 4922.1 samples/s | 76.9 steps/s
[Step=26100 Epoch=127.2] | Loss=0.02620 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.098 | L2-Norm(final)=12.456 | 5567.4 samples/s | 87.0 steps/s
[Step=26150 Epoch=127.4] | Loss=0.02483 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.098 | L2-Norm(final)=12.453 | 5541.8 samples/s | 86.6 steps/s
[Step=26200 Epoch=127.7] | Loss=0.02504 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.098 | L2-Norm(final)=12.452 | 8774.4 samples/s | 137.1 steps/s
[Step=26250 Epoch=127.9] | Loss=0.02439 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.098 | L2-Norm(final)=12.451 | 2744.4 samples/s | 42.9 steps/s
[Step=26300 Epoch=128.1] | Loss=0.02442 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.098 | L2-Norm(final)=12.450 | 5284.2 samples/s | 82.6 steps/s
[Step=26350 Epoch=128.4] | Loss=0.02405 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.098 | L2-Norm(final)=12.451 | 5546.5 samples/s | 86.7 steps/s
[Step=26400 Epoch=128.6] | Loss=0.02418 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.098 | L2-Norm(final)=12.452 | 7681.0 samples/s | 120.0 steps/s
[Step=26450 Epoch=128.9] | Loss=0.02427 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.098 | L2-Norm(final)=12.454 | 2772.5 samples/s | 43.3 steps/s
[Step=26500 Epoch=129.1] | Loss=0.02451 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.098 | L2-Norm(final)=12.456 | 5576.3 samples/s | 87.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=129.1] | Loss=0.00666 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.098 | L2-Norm(final)=12.471 | 6781.7 samples/s | 106.0 steps/s
[Step=26550 Epoch=129.4] | Loss=0.02728 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.142 | L2-Norm(final)=12.470 | 4467.1 samples/s | 69.8 steps/s
[Step=26600 Epoch=129.6] | Loss=0.02598 | Reg=0.00125 | acc=0.9688 | L2-Norm=11.181 | L2-Norm(final)=12.466 | 4744.6 samples/s | 74.1 steps/s
[Step=26650 Epoch=129.9] | Loss=0.02479 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.210 | L2-Norm(final)=12.466 | 4779.6 samples/s | 74.7 steps/s
[Step=26700 Epoch=130.1] | Loss=0.02355 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.233 | L2-Norm(final)=12.467 | 6751.5 samples/s | 105.5 steps/s
[Step=26750 Epoch=130.3] | Loss=0.02052 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.253 | L2-Norm(final)=12.469 | 2483.8 samples/s | 38.8 steps/s
[Step=26800 Epoch=130.6] | Loss=0.01860 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.269 | L2-Norm(final)=12.473 | 4678.2 samples/s | 73.1 steps/s
[Step=26850 Epoch=130.8] | Loss=0.01779 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.282 | L2-Norm(final)=12.474 | 4779.5 samples/s | 74.7 steps/s
[Step=26900 Epoch=131.1] | Loss=0.01657 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=12.476 | 6262.0 samples/s | 97.8 steps/s
[Step=26950 Epoch=131.3] | Loss=0.01536 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.305 | L2-Norm(final)=12.477 | 2564.8 samples/s | 40.1 steps/s
[Step=27000 Epoch=131.6] | Loss=0.01444 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=12.479 | 4751.9 samples/s | 74.2 steps/s
[Step=27050 Epoch=131.8] | Loss=0.01399 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.324 | L2-Norm(final)=12.481 | 4781.3 samples/s | 74.7 steps/s
[Step=27100 Epoch=132.0] | Loss=0.01339 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.332 | L2-Norm(final)=12.483 | 5684.0 samples/s | 88.8 steps/s
[Step=27150 Epoch=132.3] | Loss=0.01265 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.339 | L2-Norm(final)=12.485 | 2696.6 samples/s | 42.1 steps/s
[Step=27200 Epoch=132.5] | Loss=0.01207 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.346 | L2-Norm(final)=12.487 | 4633.8 samples/s | 72.4 steps/s
[Step=27250 Epoch=132.8] | Loss=0.01170 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=12.489 | 4796.3 samples/s | 74.9 steps/s
[Step=27300 Epoch=133.0] | Loss=0.01129 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.357 | L2-Norm(final)=12.490 | 5263.6 samples/s | 82.2 steps/s
[Step=27350 Epoch=133.3] | Loss=0.01088 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.363 | L2-Norm(final)=12.492 | 2797.3 samples/s | 43.7 steps/s
[Step=27400 Epoch=133.5] | Loss=0.01049 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=12.494 | 4661.6 samples/s | 72.8 steps/s
[Step=27450 Epoch=133.7] | Loss=0.01012 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.372 | L2-Norm(final)=12.496 | 4768.9 samples/s | 74.5 steps/s
[Step=27500 Epoch=134.0] | Loss=0.00980 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.376 | L2-Norm(final)=12.499 | 4869.4 samples/s | 76.1 steps/s
[Step=27550 Epoch=134.2] | Loss=0.00953 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.381 | L2-Norm(final)=12.501 | 2883.7 samples/s | 45.1 steps/s
[Step=27600 Epoch=134.5] | Loss=0.00921 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.385 | L2-Norm(final)=12.503 | 4718.6 samples/s | 73.7 steps/s
[Step=27650 Epoch=134.7] | Loss=0.00897 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.389 | L2-Norm(final)=12.505 | 4862.9 samples/s | 76.0 steps/s
[Step=27700 Epoch=135.0] | Loss=0.00878 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.392 | L2-Norm(final)=12.507 | 4666.4 samples/s | 72.9 steps/s
[Step=27750 Epoch=135.2] | Loss=0.00860 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.396 | L2-Norm(final)=12.509 | 2949.4 samples/s | 46.1 steps/s
[Step=27800 Epoch=135.5] | Loss=0.00835 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.399 | L2-Norm(final)=12.511 | 4767.2 samples/s | 74.5 steps/s
[Step=27850 Epoch=135.7] | Loss=0.00815 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.402 | L2-Norm(final)=12.514 | 4775.9 samples/s | 74.6 steps/s
[Step=27900 Epoch=135.9] | Loss=0.00798 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=12.516 | 4774.4 samples/s | 74.6 steps/s
[Step=27950 Epoch=136.2] | Loss=0.00788 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.409 | L2-Norm(final)=12.518 | 2938.2 samples/s | 45.9 steps/s
[Step=28000 Epoch=136.4] | Loss=0.00770 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.412 | L2-Norm(final)=12.520 | 4773.6 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step28000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=107.9] | Loss=0.02137 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.098 | L2-Norm(final)=13.444 | 6420.8 samples/s | 100.3 steps/s
[Step=22050 Epoch=108.1] | Loss=0.01914 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.097 | L2-Norm(final)=13.457 | 5073.6 samples/s | 79.3 steps/s
[Step=22100 Epoch=108.4] | Loss=0.02346 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.097 | L2-Norm(final)=13.464 | 5521.1 samples/s | 86.3 steps/s
[Step=22150 Epoch=108.6] | Loss=0.02276 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.097 | L2-Norm(final)=13.465 | 5529.1 samples/s | 86.4 steps/s
[Step=22200 Epoch=108.9] | Loss=0.02251 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.097 | L2-Norm(final)=13.465 | 9003.6 samples/s | 140.7 steps/s
[Step=22250 Epoch=109.1] | Loss=0.02210 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.097 | L2-Norm(final)=13.468 | 2624.6 samples/s | 41.0 steps/s
[Step=22300 Epoch=109.4] | Loss=0.02203 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.097 | L2-Norm(final)=13.472 | 5559.4 samples/s | 86.9 steps/s
[Step=22350 Epoch=109.6] | Loss=0.02268 | Reg=0.00123 | acc=0.9531 | L2-Norm=11.097 | L2-Norm(final)=13.475 | 5589.6 samples/s | 87.3 steps/s
[Step=22400 Epoch=109.8] | Loss=0.02277 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.097 | L2-Norm(final)=13.478 | 8095.6 samples/s | 126.5 steps/s
[Step=22450 Epoch=110.1] | Loss=0.02275 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.097 | L2-Norm(final)=13.480 | 2721.8 samples/s | 42.5 steps/s
[Step=22500 Epoch=110.3] | Loss=0.02260 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.097 | L2-Norm(final)=13.483 | 5541.8 samples/s | 86.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=110.3] | Loss=0.01727 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.097 | L2-Norm(final)=13.509 | 7013.3 samples/s | 109.6 steps/s
[Step=22550 Epoch=110.6] | Loss=0.02299 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.149 | L2-Norm(final)=13.510 | 4448.4 samples/s | 69.5 steps/s
[Step=22600 Epoch=110.8] | Loss=0.02484 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.193 | L2-Norm(final)=13.508 | 4611.7 samples/s | 72.1 steps/s
[Step=22650 Epoch=111.1] | Loss=0.02504 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.226 | L2-Norm(final)=13.506 | 4768.1 samples/s | 74.5 steps/s
[Step=22700 Epoch=111.3] | Loss=0.02304 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.253 | L2-Norm(final)=13.506 | 7019.5 samples/s | 109.7 steps/s
[Step=22750 Epoch=111.6] | Loss=0.02119 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.278 | L2-Norm(final)=13.508 | 2424.8 samples/s | 37.9 steps/s
[Step=22800 Epoch=111.8] | Loss=0.01908 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.298 | L2-Norm(final)=13.509 | 4740.9 samples/s | 74.1 steps/s
[Step=22850 Epoch=112.1] | Loss=0.01780 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=13.512 | 4809.1 samples/s | 75.1 steps/s
[Step=22900 Epoch=112.3] | Loss=0.01624 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.329 | L2-Norm(final)=13.515 | 6453.5 samples/s | 100.8 steps/s
[Step=22950 Epoch=112.5] | Loss=0.01509 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=13.519 | 2506.6 samples/s | 39.2 steps/s
[Step=23000 Epoch=112.8] | Loss=0.01408 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.354 | L2-Norm(final)=13.522 | 4822.5 samples/s | 75.4 steps/s
[Step=23050 Epoch=113.0] | Loss=0.01321 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.364 | L2-Norm(final)=13.525 | 4722.6 samples/s | 73.8 steps/s
[Step=23100 Epoch=113.3] | Loss=0.01246 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.372 | L2-Norm(final)=13.529 | 6149.4 samples/s | 96.1 steps/s
[Step=23150 Epoch=113.5] | Loss=0.01177 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=13.532 | 2580.7 samples/s | 40.3 steps/s
[Step=23200 Epoch=113.8] | Loss=0.01125 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.388 | L2-Norm(final)=13.535 | 4719.8 samples/s | 73.7 steps/s
[Step=23250 Epoch=114.0] | Loss=0.01075 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.395 | L2-Norm(final)=13.539 | 4746.5 samples/s | 74.2 steps/s
[Step=23300 Epoch=114.3] | Loss=0.01038 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.401 | L2-Norm(final)=13.542 | 5791.8 samples/s | 90.5 steps/s
[Step=23350 Epoch=114.5] | Loss=0.00989 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=13.545 | 2630.7 samples/s | 41.1 steps/s
[Step=23400 Epoch=114.7] | Loss=0.00955 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=13.548 | 4842.0 samples/s | 75.7 steps/s
[Step=23450 Epoch=115.0] | Loss=0.00929 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.419 | L2-Norm(final)=13.551 | 4675.1 samples/s | 73.0 steps/s
[Step=23500 Epoch=115.2] | Loss=0.00906 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=13.553 | 5491.4 samples/s | 85.8 steps/s
[Step=23550 Epoch=115.5] | Loss=0.00873 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.428 | L2-Norm(final)=13.556 | 2705.7 samples/s | 42.3 steps/s
[Step=23600 Epoch=115.7] | Loss=0.00847 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=13.558 | 4717.4 samples/s | 73.7 steps/s
[Step=23650 Epoch=116.0] | Loss=0.00820 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.437 | L2-Norm(final)=13.561 | 4794.8 samples/s | 74.9 steps/s
[Step=23700 Epoch=116.2] | Loss=0.00800 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.441 | L2-Norm(final)=13.564 | 5173.8 samples/s | 80.8 steps/s
[Step=23750 Epoch=116.5] | Loss=0.00775 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.445 | L2-Norm(final)=13.566 | 2774.6 samples/s | 43.4 steps/s
[Step=23800 Epoch=116.7] | Loss=0.00757 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.449 | L2-Norm(final)=13.569 | 4809.9 samples/s | 75.2 steps/s
[Step=23850 Epoch=117.0] | Loss=0.00741 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=13.572 | 4726.9 samples/s | 73.9 steps/s
[Step=23900 Epoch=117.2] | Loss=0.00721 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.455 | L2-Norm(final)=13.575 | 4958.1 samples/s | 77.5 steps/s
[Step=23950 Epoch=117.4] | Loss=0.00709 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.459 | L2-Norm(final)=13.577 | 2856.5 samples/s | 44.6 steps/s
[Step=24000 Epoch=117.7] | Loss=0.00689 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.462 | L2-Norm(final)=13.580 | 4807.1 samples/s | 75.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step24000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=40001 Epoch=379.0] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.098 | L2-Norm(final)=17.397 | 6457.0 samples/s | 100.9 steps/s
[Step=40050 Epoch=379.5] | Loss=0.00021 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=17.397 | 4790.6 samples/s | 74.9 steps/s
[Step=40100 Epoch=380.0] | Loss=0.00021 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=17.403 | 8326.8 samples/s | 130.1 steps/s
[Step=40150 Epoch=380.5] | Loss=0.00021 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=17.412 | 2582.6 samples/s | 40.4 steps/s
[Step=40200 Epoch=380.9] | Loss=0.00020 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=17.420 | 7255.9 samples/s | 113.4 steps/s
[Step=40250 Epoch=381.4] | Loss=0.00019 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=17.428 | 2715.1 samples/s | 42.4 steps/s
[Step=40300 Epoch=381.9] | Loss=0.00019 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=17.436 | 6360.2 samples/s | 99.4 steps/s
[Step=40350 Epoch=382.4] | Loss=0.00019 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=17.444 | 2795.4 samples/s | 43.7 steps/s
[Step=40400 Epoch=382.8] | Loss=0.00019 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=17.452 | 5888.3 samples/s | 92.0 steps/s
[Step=40450 Epoch=383.3] | Loss=0.00019 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=17.460 | 3003.3 samples/s | 46.9 steps/s
[Step=40500 Epoch=383.8] | Loss=0.00019 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=17.468 | 5077.1 samples/s | 79.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=40501 Epoch=383.8] | Loss=0.00004 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=17.553 | 6883.4 samples/s | 107.6 steps/s
[Step=40550 Epoch=384.2] | Loss=0.00024 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=17.560 | 4077.4 samples/s | 63.7 steps/s
[Step=40600 Epoch=384.7] | Loss=0.00077 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.108 | L2-Norm(final)=17.564 | 6583.8 samples/s | 102.9 steps/s
[Step=40650 Epoch=385.2] | Loss=0.00054 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.124 | L2-Norm(final)=17.566 | 2369.8 samples/s | 37.0 steps/s
[Step=40700 Epoch=385.7] | Loss=0.00088 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.134 | L2-Norm(final)=17.565 | 5796.8 samples/s | 90.6 steps/s
[Step=40750 Epoch=386.1] | Loss=0.00082 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.147 | L2-Norm(final)=17.563 | 2395.5 samples/s | 37.4 steps/s
[Step=40800 Epoch=386.6] | Loss=0.00086 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=17.562 | 5484.0 samples/s | 85.7 steps/s
[Step=40850 Epoch=387.1] | Loss=0.00074 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.171 | L2-Norm(final)=17.562 | 2591.0 samples/s | 40.5 steps/s
[Step=40900 Epoch=387.6] | Loss=0.00065 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.179 | L2-Norm(final)=17.561 | 5006.5 samples/s | 78.2 steps/s
[Step=40950 Epoch=388.0] | Loss=0.00058 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.183 | L2-Norm(final)=17.561 | 2688.2 samples/s | 42.0 steps/s
[Step=41000 Epoch=388.5] | Loss=0.00052 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.186 | L2-Norm(final)=17.561 | 4657.7 samples/s | 72.8 steps/s
[Step=41050 Epoch=389.0] | Loss=0.00048 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.187 | L2-Norm(final)=17.561 | 2820.4 samples/s | 44.1 steps/s
[Step=41100 Epoch=389.5] | Loss=0.00044 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.187 | L2-Norm(final)=17.561 | 4589.1 samples/s | 71.7 steps/s
[Step=41150 Epoch=389.9] | Loss=0.00040 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.186 | L2-Norm(final)=17.561 | 2854.3 samples/s | 44.6 steps/s
[Step=41200 Epoch=390.4] | Loss=0.00037 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.184 | L2-Norm(final)=17.561 | 4458.6 samples/s | 69.7 steps/s
[Step=41250 Epoch=390.9] | Loss=0.00035 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=17.561 | 2864.6 samples/s | 44.8 steps/s
[Step=41300 Epoch=391.4] | Loss=0.00033 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.179 | L2-Norm(final)=17.561 | 4456.6 samples/s | 69.6 steps/s
[Step=41350 Epoch=391.8] | Loss=0.00031 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=17.561 | 3055.7 samples/s | 47.7 steps/s
[Step=41400 Epoch=392.3] | Loss=0.00029 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=17.561 | 4219.6 samples/s | 65.9 steps/s
[Step=41450 Epoch=392.8] | Loss=0.00028 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.170 | L2-Norm(final)=17.561 | 6565.8 samples/s | 102.6 steps/s
[Step=41500 Epoch=393.2] | Loss=0.00026 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.166 | L2-Norm(final)=17.562 | 2347.2 samples/s | 36.7 steps/s
[Step=41550 Epoch=393.7] | Loss=0.00025 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.162 | L2-Norm(final)=17.562 | 6170.1 samples/s | 96.4 steps/s
[Step=41600 Epoch=394.2] | Loss=0.00024 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.158 | L2-Norm(final)=17.562 | 2437.2 samples/s | 38.1 steps/s
[Step=41650 Epoch=394.7] | Loss=0.00023 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.154 | L2-Norm(final)=17.562 | 5627.9 samples/s | 87.9 steps/s
[Step=41700 Epoch=395.1] | Loss=0.00022 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.150 | L2-Norm(final)=17.562 | 2561.5 samples/s | 40.0 steps/s
[Step=41750 Epoch=395.6] | Loss=0.00021 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.145 | L2-Norm(final)=17.562 | 5141.1 samples/s | 80.3 steps/s
[Step=41800 Epoch=396.1] | Loss=0.00020 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.141 | L2-Norm(final)=17.562 | 2665.0 samples/s | 41.6 steps/s
[Step=41850 Epoch=396.6] | Loss=0.00019 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.136 | L2-Norm(final)=17.562 | 4730.2 samples/s | 73.9 steps/s
[Step=41900 Epoch=397.0] | Loss=0.00019 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.131 | L2-Norm(final)=17.562 | 2779.0 samples/s | 43.4 steps/s
[Step=41950 Epoch=397.5] | Loss=0.00018 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.127 | L2-Norm(final)=17.562 | 4475.7 samples/s | 69.9 steps/s
[Step=42000 Epoch=398.0] | Loss=0.00018 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.122 | L2-Norm(final)=17.563 | 2841.6 samples/s | 44.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step42000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=267.4] | Loss=0.00003 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.098 | L2-Norm(final)=13.951 | 6941.1 samples/s | 108.5 steps/s
[Step=28050 Epoch=267.9] | Loss=0.00031 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=13.957 | 4401.4 samples/s | 68.8 steps/s
[Step=28100 Epoch=268.3] | Loss=0.00037 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=13.966 | 8244.9 samples/s | 128.8 steps/s
[Step=28150 Epoch=268.8] | Loss=0.00039 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=13.979 | 2578.0 samples/s | 40.3 steps/s
[Step=28200 Epoch=269.3] | Loss=0.00037 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=13.991 | 7325.4 samples/s | 114.5 steps/s
[Step=28250 Epoch=269.8] | Loss=0.00033 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=14.002 | 2684.0 samples/s | 41.9 steps/s
[Step=28300 Epoch=270.2] | Loss=0.00036 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=14.012 | 6611.0 samples/s | 103.3 steps/s
[Step=28350 Epoch=270.7] | Loss=0.00035 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=14.023 | 2724.7 samples/s | 42.6 steps/s
[Step=28400 Epoch=271.2] | Loss=0.00034 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=14.033 | 6344.5 samples/s | 99.1 steps/s
[Step=28450 Epoch=271.7] | Loss=0.00035 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=14.043 | 2818.3 samples/s | 44.0 steps/s
[Step=28500 Epoch=272.2] | Loss=0.00034 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=14.053 | 5835.5 samples/s | 91.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=272.2] | Loss=0.00007 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=14.150 | 6729.9 samples/s | 105.2 steps/s
[Step=28550 Epoch=272.6] | Loss=0.00014 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.096 | L2-Norm(final)=14.154 | 4089.4 samples/s | 63.9 steps/s
[Step=28600 Epoch=273.1] | Loss=0.00013 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.090 | L2-Norm(final)=14.157 | 6711.2 samples/s | 104.9 steps/s
[Step=28650 Epoch=273.6] | Loss=0.00009 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.086 | L2-Norm(final)=14.159 | 2395.5 samples/s | 37.4 steps/s
[Step=28700 Epoch=274.1] | Loss=0.00007 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.077 | L2-Norm(final)=14.160 | 6020.4 samples/s | 94.1 steps/s
[Step=28750 Epoch=274.5] | Loss=0.00006 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.066 | L2-Norm(final)=14.161 | 2449.2 samples/s | 38.3 steps/s
[Step=28800 Epoch=275.0] | Loss=0.00005 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.054 | L2-Norm(final)=14.162 | 5611.1 samples/s | 87.7 steps/s
[Step=28850 Epoch=275.5] | Loss=0.00004 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.042 | L2-Norm(final)=14.163 | 2524.4 samples/s | 39.4 steps/s
[Step=28900 Epoch=276.0] | Loss=0.00004 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.030 | L2-Norm(final)=14.163 | 5324.1 samples/s | 83.2 steps/s
[Step=28950 Epoch=276.5] | Loss=0.00003 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=14.164 | 2603.2 samples/s | 40.7 steps/s
[Step=29000 Epoch=276.9] | Loss=0.00003 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.005 | L2-Norm(final)=14.165 | 4959.2 samples/s | 77.5 steps/s
[Step=29050 Epoch=277.4] | Loss=0.00003 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.992 | L2-Norm(final)=14.165 | 2706.2 samples/s | 42.3 steps/s
[Step=29100 Epoch=277.9] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.980 | L2-Norm(final)=14.166 | 4639.1 samples/s | 72.5 steps/s
[Step=29150 Epoch=278.4] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.968 | L2-Norm(final)=14.166 | 2810.7 samples/s | 43.9 steps/s
[Step=29200 Epoch=278.8] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=14.167 | 4535.2 samples/s | 70.9 steps/s
[Step=29250 Epoch=279.3] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.943 | L2-Norm(final)=14.168 | 2844.2 samples/s | 44.4 steps/s
[Step=29300 Epoch=279.8] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.931 | L2-Norm(final)=14.168 | 4590.8 samples/s | 71.7 steps/s
[Step=29350 Epoch=280.3] | Loss=0.00002 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.919 | L2-Norm(final)=14.169 | 2832.4 samples/s | 44.3 steps/s
[Step=29400 Epoch=280.8] | Loss=0.00002 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.907 | L2-Norm(final)=14.169 | 4547.7 samples/s | 71.1 steps/s
[Step=29450 Epoch=281.2] | Loss=0.00002 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=14.170 | 2861.4 samples/s | 44.7 steps/s
[Step=29500 Epoch=281.7] | Loss=0.00002 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.883 | L2-Norm(final)=14.170 | 4507.4 samples/s | 70.4 steps/s
[Step=29550 Epoch=282.2] | Loss=0.00002 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.871 | L2-Norm(final)=14.171 | 7296.0 samples/s | 114.0 steps/s
[Step=29600 Epoch=282.7] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.859 | L2-Norm(final)=14.171 | 1747.3 samples/s | 27.3 steps/s
[Step=29650 Epoch=283.1] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.846 | L2-Norm(final)=14.171 | 6590.8 samples/s | 103.0 steps/s
[Step=29700 Epoch=283.6] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=14.172 | 2325.8 samples/s | 36.3 steps/s
[Step=29750 Epoch=284.1] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.822 | L2-Norm(final)=14.172 | 6177.9 samples/s | 96.5 steps/s
[Step=29800 Epoch=284.6] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=14.173 | 2434.5 samples/s | 38.0 steps/s
[Step=29850 Epoch=285.0] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.798 | L2-Norm(final)=14.173 | 5685.6 samples/s | 88.8 steps/s
[Step=29900 Epoch=285.5] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.786 | L2-Norm(final)=14.174 | 2552.9 samples/s | 39.9 steps/s
[Step=29950 Epoch=286.0] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.774 | L2-Norm(final)=14.174 | 5135.5 samples/s | 80.2 steps/s
[Step=30000 Epoch=286.5] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.761 | L2-Norm(final)=14.175 | 2630.3 samples/s | 41.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step30000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=263.8] | Loss=0.00045 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.098 | L2-Norm(final)=14.963 | 6449.7 samples/s | 100.8 steps/s
[Step=28050 Epoch=264.3] | Loss=0.00132 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=14.977 | 4748.5 samples/s | 74.2 steps/s
[Step=28100 Epoch=264.8] | Loss=0.00145 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=14.990 | 7989.4 samples/s | 124.8 steps/s
[Step=28150 Epoch=265.3] | Loss=0.00158 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=15.003 | 2589.6 samples/s | 40.5 steps/s
[Step=28200 Epoch=265.7] | Loss=0.00151 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=15.016 | 7049.1 samples/s | 110.1 steps/s
[Step=28250 Epoch=266.2] | Loss=0.00137 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=15.027 | 2731.8 samples/s | 42.7 steps/s
[Step=28300 Epoch=266.7] | Loss=0.00130 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=15.038 | 6127.7 samples/s | 95.7 steps/s
[Step=28350 Epoch=267.1] | Loss=0.00138 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=15.049 | 2900.0 samples/s | 45.3 steps/s
[Step=28400 Epoch=267.6] | Loss=0.00136 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=15.060 | 5356.4 samples/s | 83.7 steps/s
[Step=28450 Epoch=268.1] | Loss=0.00133 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=15.071 | 3089.0 samples/s | 48.3 steps/s
[Step=28500 Epoch=268.6] | Loss=0.00129 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=15.081 | 5093.1 samples/s | 79.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=268.6] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=15.183 | 6710.7 samples/s | 104.9 steps/s
[Step=28550 Epoch=269.0] | Loss=0.00024 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.101 | L2-Norm(final)=15.193 | 4100.4 samples/s | 64.1 steps/s
[Step=28600 Epoch=269.5] | Loss=0.00186 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.103 | L2-Norm(final)=15.197 | 6524.2 samples/s | 101.9 steps/s
[Step=28650 Epoch=270.0] | Loss=0.00183 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.134 | L2-Norm(final)=15.191 | 2408.0 samples/s | 37.6 steps/s
[Step=28700 Epoch=270.4] | Loss=0.00149 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.152 | L2-Norm(final)=15.188 | 5813.4 samples/s | 90.8 steps/s
[Step=28750 Epoch=270.9] | Loss=0.00121 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.163 | L2-Norm(final)=15.186 | 2536.9 samples/s | 39.6 steps/s
[Step=28800 Epoch=271.4] | Loss=0.00101 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.168 | L2-Norm(final)=15.186 | 5165.0 samples/s | 80.7 steps/s
[Step=28850 Epoch=271.8] | Loss=0.00087 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.170 | L2-Norm(final)=15.185 | 2641.7 samples/s | 41.3 steps/s
[Step=28900 Epoch=272.3] | Loss=0.00076 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.170 | L2-Norm(final)=15.185 | 4786.0 samples/s | 74.8 steps/s
[Step=28950 Epoch=272.8] | Loss=0.00068 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.169 | L2-Norm(final)=15.185 | 2761.2 samples/s | 43.1 steps/s
[Step=29000 Epoch=273.3] | Loss=0.00061 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.166 | L2-Norm(final)=15.185 | 4592.8 samples/s | 71.8 steps/s
[Step=29050 Epoch=273.7] | Loss=0.00056 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.163 | L2-Norm(final)=15.186 | 2862.3 samples/s | 44.7 steps/s
[Step=29100 Epoch=274.2] | Loss=0.00051 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=15.186 | 4468.6 samples/s | 69.8 steps/s
[Step=29150 Epoch=274.7] | Loss=0.00047 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.156 | L2-Norm(final)=15.186 | 2894.3 samples/s | 45.2 steps/s
[Step=29200 Epoch=275.1] | Loss=0.00044 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.152 | L2-Norm(final)=15.186 | 4431.8 samples/s | 69.2 steps/s
[Step=29250 Epoch=275.6] | Loss=0.00041 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.148 | L2-Norm(final)=15.186 | 3169.4 samples/s | 49.5 steps/s
[Step=29300 Epoch=276.1] | Loss=0.00038 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.143 | L2-Norm(final)=15.187 | 3956.2 samples/s | 61.8 steps/s
[Step=29350 Epoch=276.6] | Loss=0.00036 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.138 | L2-Norm(final)=15.187 | 6540.8 samples/s | 102.2 steps/s
[Step=29400 Epoch=277.0] | Loss=0.00034 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.133 | L2-Norm(final)=15.187 | 2387.0 samples/s | 37.3 steps/s
[Step=29450 Epoch=277.5] | Loss=0.00032 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.128 | L2-Norm(final)=15.187 | 5925.4 samples/s | 92.6 steps/s
[Step=29500 Epoch=278.0] | Loss=0.00031 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.123 | L2-Norm(final)=15.188 | 2489.4 samples/s | 38.9 steps/s
[Step=29550 Epoch=278.4] | Loss=0.00029 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.118 | L2-Norm(final)=15.188 | 5343.0 samples/s | 83.5 steps/s
[Step=29600 Epoch=278.9] | Loss=0.00028 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.113 | L2-Norm(final)=15.188 | 2602.3 samples/s | 40.7 steps/s
[Step=29650 Epoch=279.4] | Loss=0.00027 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.108 | L2-Norm(final)=15.188 | 4864.9 samples/s | 76.0 steps/s
[Step=29700 Epoch=279.9] | Loss=0.00026 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=15.189 | 2774.5 samples/s | 43.4 steps/s
[Step=29750 Epoch=280.3] | Loss=0.00025 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.097 | L2-Norm(final)=15.189 | 4570.8 samples/s | 71.4 steps/s
[Step=29800 Epoch=280.8] | Loss=0.00024 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.091 | L2-Norm(final)=15.189 | 2855.2 samples/s | 44.6 steps/s
[Step=29850 Epoch=281.3] | Loss=0.00023 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.085 | L2-Norm(final)=15.189 | 4430.9 samples/s | 69.2 steps/s
[Step=29900 Epoch=281.7] | Loss=0.00022 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.080 | L2-Norm(final)=15.190 | 2869.3 samples/s | 44.8 steps/s
[Step=29950 Epoch=282.2] | Loss=0.00021 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.074 | L2-Norm(final)=15.190 | 4534.1 samples/s | 70.8 steps/s
[Step=30000 Epoch=282.7] | Loss=0.00021 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.068 | L2-Norm(final)=15.190 | 3002.8 samples/s | 46.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step30000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09397 | acc=0.9625 | tpr=0.9710 | fpr=0.0560 | 5987.1 samples/s | 23.4 steps/s
Avg test loss: 0.10263, Avg test acc: 0.95849, Avg tpr: 0.96724, Avg fpr: 0.06076, total FA: 474

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10992 | acc=0.9589 | tpr=0.9724 | fpr=0.0704 | 6051.8 samples/s | 23.6 steps/s
Avg test loss: 0.11332, Avg test acc: 0.95773, Avg tpr: 0.97097, Avg fpr: 0.07140, total FA: 557

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.10401 | acc=0.9586 | tpr=0.9670 | fpr=0.0597 | 6024.5 samples/s | 23.5 steps/s
Avg test loss: 0.10929, Avg test acc: 0.95633, Avg tpr: 0.96415, Avg fpr: 0.06089, total FA: 475

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10222 | acc=0.9585 | tpr=0.9736 | fpr=0.0743 | 5769.6 samples/s | 22.5 steps/s
Avg test loss: 0.10737, Avg test acc: 0.95753, Avg tpr: 0.97342, Avg fpr: 0.07743, total FA: 604

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09842 | acc=0.9593 | tpr=0.9722 | fpr=0.0686 | 5891.5 samples/s | 23.0 steps/s
Avg test loss: 0.10411, Avg test acc: 0.95825, Avg tpr: 0.97033, Avg fpr: 0.06832, total FA: 533

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.86810 | acc=0.2933 | tpr=0.0178 | fpr=0.1085 | 6120.5 samples/s | 23.9 steps/s
Avg test loss: 6.87030, Avg test acc: 0.29109, Avg tpr: 0.01644, Avg fpr: 0.10486, total FA: 818

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.98928 | acc=0.3066 | tpr=0.0197 | fpr=0.0704 | 5908.0 samples/s | 23.1 steps/s
Avg test loss: 5.00277, Avg test acc: 0.30459, Avg tpr: 0.01988, Avg fpr: 0.06922, total FA: 540

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.18778 | acc=0.2784 | tpr=0.0215 | fpr=0.1638 | 6161.7 samples/s | 24.1 steps/s
Avg test loss: 5.19142, Avg test acc: 0.27699, Avg tpr: 0.02034, Avg fpr: 0.15857, total FA: 1237

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.94386 | acc=0.2717 | tpr=0.0324 | fpr=0.2086 | 6105.7 samples/s | 23.9 steps/s
Avg test loss: 4.94662, Avg test acc: 0.27170, Avg tpr: 0.03002, Avg fpr: 0.19677, total FA: 1535

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.62707 | acc=0.3058 | tpr=0.0157 | fpr=0.0644 | 5840.4 samples/s | 22.8 steps/s
Avg test loss: 5.64633, Avg test acc: 0.30375, Avg tpr: 0.01556, Avg fpr: 0.06243, total FA: 487

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.66641 | acc=0.1336 | tpr=0.6681 | fpr=0.8760 | 5992.7 samples/s | 23.4 steps/s
[Step= 100] | Loss=5.64262 | acc=0.1378 | tpr=0.6397 | fpr=0.8716 | 7876.5 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.63788 | acc=0.1401 | tpr=0.6527 | fpr=0.8693 | 7900.8 samples/s | 30.9 steps/s
[Step= 200] | Loss=5.63089 | acc=0.1401 | tpr=0.6459 | fpr=0.8691 | 7896.2 samples/s | 30.8 steps/s
[Step= 250] | Loss=5.63600 | acc=0.1394 | tpr=0.6402 | fpr=0.8697 | 7625.5 samples/s | 29.8 steps/s
[Step= 300] | Loss=5.62752 | acc=0.1398 | tpr=0.6378 | fpr=0.8693 | 8387.2 samples/s | 32.8 steps/s
[Step= 350] | Loss=5.63395 | acc=0.1391 | tpr=0.6343 | fpr=0.8698 | 7790.0 samples/s | 30.4 steps/s
[Step= 400] | Loss=5.63056 | acc=0.1393 | tpr=0.6302 | fpr=0.8696 | 8267.2 samples/s | 32.3 steps/s
[Step= 450] | Loss=5.63530 | acc=0.1387 | tpr=0.6329 | fpr=0.8702 | 7775.6 samples/s | 30.4 steps/s
[Step= 500] | Loss=5.63457 | acc=0.1388 | tpr=0.6357 | fpr=0.8702 | 7865.9 samples/s | 30.7 steps/s
[Step= 550] | Loss=5.63836 | acc=0.1387 | tpr=0.6407 | fpr=0.8704 | 10993.8 samples/s | 42.9 steps/s
Avg test loss: 5.63876, Avg test acc: 0.13867, Avg tpr: 0.64144, Avg fpr: 0.87047, total FA: 120863

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.77937 | acc=0.1306 | tpr=0.6150 | fpr=0.8781 | 6096.0 samples/s | 23.8 steps/s
[Step= 100] | Loss=5.76048 | acc=0.1352 | tpr=0.6247 | fpr=0.8739 | 7838.8 samples/s | 30.6 steps/s
[Step= 150] | Loss=5.75181 | acc=0.1367 | tpr=0.6427 | fpr=0.8726 | 8169.2 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.74350 | acc=0.1366 | tpr=0.6383 | fpr=0.8725 | 7469.7 samples/s | 29.2 steps/s
[Step= 250] | Loss=5.74925 | acc=0.1363 | tpr=0.6367 | fpr=0.8728 | 8196.4 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.74325 | acc=0.1358 | tpr=0.6284 | fpr=0.8732 | 7675.2 samples/s | 30.0 steps/s
[Step= 350] | Loss=5.75111 | acc=0.1355 | tpr=0.6255 | fpr=0.8734 | 7811.1 samples/s | 30.5 steps/s
[Step= 400] | Loss=5.74615 | acc=0.1357 | tpr=0.6269 | fpr=0.8733 | 8495.4 samples/s | 33.2 steps/s
[Step= 450] | Loss=5.74940 | acc=0.1351 | tpr=0.6319 | fpr=0.8739 | 7793.0 samples/s | 30.4 steps/s
[Step= 500] | Loss=5.74988 | acc=0.1350 | tpr=0.6348 | fpr=0.8741 | 8138.1 samples/s | 31.8 steps/s
[Step= 550] | Loss=5.75352 | acc=0.1350 | tpr=0.6379 | fpr=0.8741 | 10652.9 samples/s | 41.6 steps/s
Avg test loss: 5.75415, Avg test acc: 0.13492, Avg tpr: 0.63827, Avg fpr: 0.87423, total FA: 121385

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.64709 | acc=0.1294 | tpr=0.6770 | fpr=0.8805 | 5720.6 samples/s | 22.3 steps/s
[Step= 100] | Loss=5.63188 | acc=0.1305 | tpr=0.6461 | fpr=0.8791 | 8279.8 samples/s | 32.3 steps/s
[Step= 150] | Loss=5.62500 | acc=0.1320 | tpr=0.6527 | fpr=0.8776 | 8163.8 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.61841 | acc=0.1322 | tpr=0.6393 | fpr=0.8770 | 8151.3 samples/s | 31.8 steps/s
[Step= 250] | Loss=5.62683 | acc=0.1323 | tpr=0.6297 | fpr=0.8767 | 7721.8 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.62388 | acc=0.1320 | tpr=0.6255 | fpr=0.8770 | 8238.4 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.63154 | acc=0.1316 | tpr=0.6199 | fpr=0.8773 | 7551.5 samples/s | 29.5 steps/s
[Step= 400] | Loss=5.62981 | acc=0.1317 | tpr=0.6165 | fpr=0.8771 | 8184.9 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.63537 | acc=0.1309 | tpr=0.6173 | fpr=0.8779 | 8413.7 samples/s | 32.9 steps/s
[Step= 500] | Loss=5.63326 | acc=0.1307 | tpr=0.6176 | fpr=0.8781 | 7929.8 samples/s | 31.0 steps/s
[Step= 550] | Loss=5.63729 | acc=0.1307 | tpr=0.6176 | fpr=0.8781 | 9899.7 samples/s | 38.7 steps/s
Avg test loss: 5.63820, Avg test acc: 0.13065, Avg tpr: 0.61846, Avg fpr: 0.87822, total FA: 121939

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.77950 | acc=0.1355 | tpr=0.6814 | fpr=0.8743 | 6136.5 samples/s | 24.0 steps/s
[Step= 100] | Loss=5.76258 | acc=0.1379 | tpr=0.6588 | fpr=0.8718 | 7296.5 samples/s | 28.5 steps/s
[Step= 150] | Loss=5.74797 | acc=0.1395 | tpr=0.6700 | fpr=0.8703 | 7652.9 samples/s | 29.9 steps/s
[Step= 200] | Loss=5.73847 | acc=0.1398 | tpr=0.6634 | fpr=0.8697 | 8005.3 samples/s | 31.3 steps/s
[Step= 250] | Loss=5.74136 | acc=0.1396 | tpr=0.6594 | fpr=0.8698 | 7985.8 samples/s | 31.2 steps/s
[Step= 300] | Loss=5.73557 | acc=0.1390 | tpr=0.6567 | fpr=0.8705 | 7610.4 samples/s | 29.7 steps/s
[Step= 350] | Loss=5.74135 | acc=0.1389 | tpr=0.6562 | fpr=0.8704 | 7833.5 samples/s | 30.6 steps/s
[Step= 400] | Loss=5.73827 | acc=0.1395 | tpr=0.6565 | fpr=0.8699 | 7918.7 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.74342 | acc=0.1386 | tpr=0.6573 | fpr=0.8708 | 8156.9 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.74306 | acc=0.1387 | tpr=0.6604 | fpr=0.8707 | 8412.1 samples/s | 32.9 steps/s
[Step= 550] | Loss=5.74917 | acc=0.1388 | tpr=0.6614 | fpr=0.8707 | 12188.9 samples/s | 47.6 steps/s
Avg test loss: 5.75013, Avg test acc: 0.13873, Avg tpr: 0.66165, Avg fpr: 0.87077, total FA: 120905

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.86724 | acc=0.1320 | tpr=0.5531 | fpr=0.8755 | 6049.3 samples/s | 23.6 steps/s
[Step= 100] | Loss=5.84098 | acc=0.1342 | tpr=0.5267 | fpr=0.8731 | 8145.3 samples/s | 31.8 steps/s
[Step= 150] | Loss=5.82751 | acc=0.1360 | tpr=0.5461 | fpr=0.8716 | 7214.8 samples/s | 28.2 steps/s
[Step= 200] | Loss=5.82465 | acc=0.1365 | tpr=0.5486 | fpr=0.8710 | 7762.7 samples/s | 30.3 steps/s
[Step= 250] | Loss=5.82445 | acc=0.1365 | tpr=0.5415 | fpr=0.8708 | 8313.5 samples/s | 32.5 steps/s
[Step= 300] | Loss=5.81767 | acc=0.1363 | tpr=0.5353 | fpr=0.8710 | 8515.6 samples/s | 33.3 steps/s
[Step= 350] | Loss=5.82748 | acc=0.1361 | tpr=0.5316 | fpr=0.8711 | 8439.3 samples/s | 33.0 steps/s
[Step= 400] | Loss=5.82444 | acc=0.1366 | tpr=0.5295 | fpr=0.8706 | 8010.0 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.82898 | acc=0.1359 | tpr=0.5326 | fpr=0.8713 | 8212.3 samples/s | 32.1 steps/s
[Step= 500] | Loss=5.82789 | acc=0.1360 | tpr=0.5322 | fpr=0.8712 | 7727.0 samples/s | 30.2 steps/s
[Step= 550] | Loss=5.83113 | acc=0.1361 | tpr=0.5336 | fpr=0.8711 | 9850.5 samples/s | 38.5 steps/s
Avg test loss: 5.83229, Avg test acc: 0.13601, Avg tpr: 0.53447, Avg fpr: 0.87123, total FA: 120969

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.23159 | acc=0.9603 | tpr=0.9159 | fpr=0.0389 | 6221.3 samples/s | 24.3 steps/s
[Step= 100] | Loss=0.23839 | acc=0.9587 | tpr=0.9360 | fpr=0.0409 | 7059.8 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.24337 | acc=0.9576 | tpr=0.9366 | fpr=0.0421 | 7825.4 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.24244 | acc=0.9569 | tpr=0.9410 | fpr=0.0428 | 7880.4 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.24226 | acc=0.9566 | tpr=0.9336 | fpr=0.0430 | 7693.7 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.24536 | acc=0.9563 | tpr=0.9316 | fpr=0.0433 | 8413.8 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.24507 | acc=0.9561 | tpr=0.9324 | fpr=0.0435 | 7947.6 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.24447 | acc=0.9560 | tpr=0.9305 | fpr=0.0436 | 8018.6 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.24898 | acc=0.9555 | tpr=0.9279 | fpr=0.0440 | 8115.0 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.24833 | acc=0.9553 | tpr=0.9291 | fpr=0.0442 | 7980.8 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.24701 | acc=0.9556 | tpr=0.9280 | fpr=0.0439 | 11324.3 samples/s | 44.2 steps/s
Avg test loss: 0.24674, Avg test acc: 0.95565, Avg tpr: 0.92789, Avg fpr: 0.04385, total FA: 6088

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.17231 | acc=0.9611 | tpr=0.8982 | fpr=0.0378 | 6067.1 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.17963 | acc=0.9600 | tpr=0.9190 | fpr=0.0392 | 7458.1 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.18279 | acc=0.9589 | tpr=0.9280 | fpr=0.0406 | 8233.9 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.18282 | acc=0.9588 | tpr=0.9322 | fpr=0.0407 | 7607.7 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.18337 | acc=0.9588 | tpr=0.9301 | fpr=0.0407 | 8296.9 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.18543 | acc=0.9584 | tpr=0.9273 | fpr=0.0411 | 8772.6 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.18354 | acc=0.9585 | tpr=0.9280 | fpr=0.0409 | 7883.2 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.18432 | acc=0.9581 | tpr=0.9256 | fpr=0.0413 | 7893.2 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.18762 | acc=0.9576 | tpr=0.9245 | fpr=0.0418 | 8589.6 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.18738 | acc=0.9575 | tpr=0.9260 | fpr=0.0419 | 7404.6 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.18650 | acc=0.9578 | tpr=0.9256 | fpr=0.0416 | 10016.8 samples/s | 39.1 steps/s
Avg test loss: 0.18617, Avg test acc: 0.95780, Avg tpr: 0.92552, Avg fpr: 0.04161, total FA: 5778

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26543 | acc=0.9510 | tpr=0.9558 | fpr=0.0491 | 5942.5 samples/s | 23.2 steps/s
[Step= 100] | Loss=0.27326 | acc=0.9498 | tpr=0.9595 | fpr=0.0504 | 7598.9 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.27849 | acc=0.9487 | tpr=0.9597 | fpr=0.0515 | 7725.2 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.27843 | acc=0.9487 | tpr=0.9628 | fpr=0.0515 | 7883.5 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.27868 | acc=0.9487 | tpr=0.9624 | fpr=0.0515 | 8639.2 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.28186 | acc=0.9484 | tpr=0.9607 | fpr=0.0518 | 8165.4 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.27947 | acc=0.9484 | tpr=0.9599 | fpr=0.0518 | 8099.9 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.27970 | acc=0.9481 | tpr=0.9573 | fpr=0.0521 | 8342.1 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.28386 | acc=0.9476 | tpr=0.9557 | fpr=0.0525 | 7964.4 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.28436 | acc=0.9475 | tpr=0.9568 | fpr=0.0527 | 8201.0 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.28250 | acc=0.9479 | tpr=0.9570 | fpr=0.0523 | 9563.1 samples/s | 37.4 steps/s
Avg test loss: 0.28216, Avg test acc: 0.94788, Avg tpr: 0.95681, Avg fpr: 0.05228, total FA: 7259

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14973 | acc=0.9616 | tpr=0.9248 | fpr=0.0378 | 5959.8 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.15547 | acc=0.9606 | tpr=0.9360 | fpr=0.0390 | 7907.4 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.15720 | acc=0.9596 | tpr=0.9337 | fpr=0.0400 | 7587.1 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.15675 | acc=0.9596 | tpr=0.9377 | fpr=0.0400 | 8592.1 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.15744 | acc=0.9595 | tpr=0.9354 | fpr=0.0401 | 7267.4 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.15898 | acc=0.9591 | tpr=0.9360 | fpr=0.0405 | 8526.4 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.15898 | acc=0.9590 | tpr=0.9349 | fpr=0.0406 | 8285.8 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.15899 | acc=0.9587 | tpr=0.9311 | fpr=0.0408 | 7466.8 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.16179 | acc=0.9582 | tpr=0.9323 | fpr=0.0414 | 8494.2 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.16150 | acc=0.9580 | tpr=0.9326 | fpr=0.0415 | 8758.4 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.16051 | acc=0.9583 | tpr=0.9324 | fpr=0.0413 | 9380.1 samples/s | 36.6 steps/s
Avg test loss: 0.16026, Avg test acc: 0.95828, Avg tpr: 0.93225, Avg fpr: 0.04125, total FA: 5727

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.23978 | acc=0.9541 | tpr=0.9115 | fpr=0.0451 | 5897.2 samples/s | 23.0 steps/s
[Step= 100] | Loss=0.24888 | acc=0.9532 | tpr=0.9275 | fpr=0.0463 | 7611.7 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.25424 | acc=0.9516 | tpr=0.9323 | fpr=0.0480 | 7837.1 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.25463 | acc=0.9515 | tpr=0.9355 | fpr=0.0482 | 8005.5 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.25591 | acc=0.9514 | tpr=0.9354 | fpr=0.0483 | 8839.1 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.25895 | acc=0.9510 | tpr=0.9353 | fpr=0.0487 | 8213.0 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.25788 | acc=0.9512 | tpr=0.9374 | fpr=0.0485 | 7071.9 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.25793 | acc=0.9509 | tpr=0.9360 | fpr=0.0488 | 8167.3 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.26198 | acc=0.9505 | tpr=0.9348 | fpr=0.0492 | 8240.3 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.26230 | acc=0.9504 | tpr=0.9344 | fpr=0.0493 | 8036.6 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.26075 | acc=0.9507 | tpr=0.9347 | fpr=0.0490 | 10768.1 samples/s | 42.1 steps/s
Avg test loss: 0.26044, Avg test acc: 0.95077, Avg tpr: 0.93463, Avg fpr: 0.04894, total FA: 6795

server round 29/50

clients selected: [0 2 4 6 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=117.0] | Loss=0.00654 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=11.811 | 7634.9 samples/s | 119.3 steps/s
[Step=24050 Epoch=117.3] | Loss=0.02774 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.025 | L2-Norm(final)=11.810 | 4658.7 samples/s | 72.8 steps/s
[Step=24100 Epoch=117.5] | Loss=0.02579 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.025 | L2-Norm(final)=11.813 | 5547.5 samples/s | 86.7 steps/s
[Step=24150 Epoch=117.8] | Loss=0.02564 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.025 | L2-Norm(final)=11.814 | 5527.0 samples/s | 86.4 steps/s
[Step=24200 Epoch=118.0] | Loss=0.02640 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.025 | L2-Norm(final)=11.815 | 8682.0 samples/s | 135.7 steps/s
[Step=24250 Epoch=118.2] | Loss=0.02706 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.025 | L2-Norm(final)=11.814 | 2669.7 samples/s | 41.7 steps/s
[Step=24300 Epoch=118.5] | Loss=0.02634 | Reg=0.00122 | acc=0.9531 | L2-Norm=11.025 | L2-Norm(final)=11.815 | 5522.0 samples/s | 86.3 steps/s
[Step=24350 Epoch=118.7] | Loss=0.02614 | Reg=0.00122 | acc=0.9375 | L2-Norm=11.025 | L2-Norm(final)=11.818 | 5647.0 samples/s | 88.2 steps/s
[Step=24400 Epoch=119.0] | Loss=0.02603 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.025 | L2-Norm(final)=11.820 | 7452.9 samples/s | 116.5 steps/s
[Step=24450 Epoch=119.2] | Loss=0.02596 | Reg=0.00122 | acc=0.9688 | L2-Norm=11.025 | L2-Norm(final)=11.822 | 2799.2 samples/s | 43.7 steps/s
[Step=24500 Epoch=119.5] | Loss=0.02616 | Reg=0.00122 | acc=0.9688 | L2-Norm=11.025 | L2-Norm(final)=11.823 | 5424.4 samples/s | 84.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=119.5] | Loss=0.00509 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.025 | L2-Norm(final)=11.838 | 6937.1 samples/s | 108.4 steps/s
[Step=24550 Epoch=119.7] | Loss=0.03181 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.066 | L2-Norm(final)=11.836 | 4265.8 samples/s | 66.7 steps/s
[Step=24600 Epoch=120.0] | Loss=0.02877 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.109 | L2-Norm(final)=11.835 | 4751.9 samples/s | 74.2 steps/s
[Step=24650 Epoch=120.2] | Loss=0.02662 | Reg=0.00124 | acc=0.9688 | L2-Norm=11.142 | L2-Norm(final)=11.835 | 4770.6 samples/s | 74.5 steps/s
[Step=24700 Epoch=120.4] | Loss=0.02473 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.168 | L2-Norm(final)=11.836 | 6850.7 samples/s | 107.0 steps/s
[Step=24750 Epoch=120.7] | Loss=0.02179 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=11.840 | 2474.7 samples/s | 38.7 steps/s
[Step=24800 Epoch=120.9] | Loss=0.01969 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.211 | L2-Norm(final)=11.845 | 4769.0 samples/s | 74.5 steps/s
[Step=24850 Epoch=121.2] | Loss=0.01856 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.228 | L2-Norm(final)=11.850 | 4851.4 samples/s | 75.8 steps/s
[Step=24900 Epoch=121.4] | Loss=0.01755 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.243 | L2-Norm(final)=11.854 | 6089.9 samples/s | 95.2 steps/s
[Step=24950 Epoch=121.7] | Loss=0.01642 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.257 | L2-Norm(final)=11.858 | 2588.6 samples/s | 40.4 steps/s
[Step=25000 Epoch=121.9] | Loss=0.01546 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.269 | L2-Norm(final)=11.862 | 4738.5 samples/s | 74.0 steps/s
[Step=25050 Epoch=122.1] | Loss=0.01456 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.279 | L2-Norm(final)=11.866 | 4693.6 samples/s | 73.3 steps/s
[Step=25100 Epoch=122.4] | Loss=0.01388 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.289 | L2-Norm(final)=11.870 | 5664.9 samples/s | 88.5 steps/s
[Step=25150 Epoch=122.6] | Loss=0.01309 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.297 | L2-Norm(final)=11.873 | 2642.7 samples/s | 41.3 steps/s
[Step=25200 Epoch=122.9] | Loss=0.01242 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.305 | L2-Norm(final)=11.877 | 4739.9 samples/s | 74.1 steps/s
[Step=25250 Epoch=123.1] | Loss=0.01184 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.313 | L2-Norm(final)=11.881 | 4756.6 samples/s | 74.3 steps/s
[Step=25300 Epoch=123.4] | Loss=0.01144 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.319 | L2-Norm(final)=11.884 | 5304.8 samples/s | 82.9 steps/s
[Step=25350 Epoch=123.6] | Loss=0.01115 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.326 | L2-Norm(final)=11.887 | 2766.5 samples/s | 43.2 steps/s
[Step=25400 Epoch=123.9] | Loss=0.01077 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.331 | L2-Norm(final)=11.890 | 4755.1 samples/s | 74.3 steps/s
[Step=25450 Epoch=124.1] | Loss=0.01042 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.337 | L2-Norm(final)=11.893 | 4845.1 samples/s | 75.7 steps/s
[Step=25500 Epoch=124.3] | Loss=0.01012 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=11.896 | 4792.1 samples/s | 74.9 steps/s
[Step=25550 Epoch=124.6] | Loss=0.00985 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.347 | L2-Norm(final)=11.900 | 2886.5 samples/s | 45.1 steps/s
[Step=25600 Epoch=124.8] | Loss=0.00949 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=11.903 | 4804.1 samples/s | 75.1 steps/s
[Step=25650 Epoch=125.1] | Loss=0.00923 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.356 | L2-Norm(final)=11.906 | 4708.7 samples/s | 73.6 steps/s
[Step=25700 Epoch=125.3] | Loss=0.00902 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.361 | L2-Norm(final)=11.909 | 4857.3 samples/s | 75.9 steps/s
[Step=25750 Epoch=125.6] | Loss=0.00887 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.365 | L2-Norm(final)=11.912 | 2883.7 samples/s | 45.1 steps/s
[Step=25800 Epoch=125.8] | Loss=0.00862 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=11.914 | 4772.9 samples/s | 74.6 steps/s
[Step=25850 Epoch=126.0] | Loss=0.00837 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.373 | L2-Norm(final)=11.917 | 4766.3 samples/s | 74.5 steps/s
[Step=25900 Epoch=126.3] | Loss=0.00822 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.377 | L2-Norm(final)=11.920 | 4749.8 samples/s | 74.2 steps/s
[Step=25950 Epoch=126.5] | Loss=0.00808 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.380 | L2-Norm(final)=11.923 | 2963.9 samples/s | 46.3 steps/s
[Step=26000 Epoch=126.8] | Loss=0.00791 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.384 | L2-Norm(final)=11.926 | 4692.0 samples/s | 73.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step26000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=136.4] | Loss=0.00347 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=12.584 | 6588.7 samples/s | 102.9 steps/s
[Step=28050 Epoch=136.7] | Loss=0.02395 | Reg=0.00122 | acc=0.9688 | L2-Norm=11.024 | L2-Norm(final)=12.591 | 5029.4 samples/s | 78.6 steps/s
[Step=28100 Epoch=136.9] | Loss=0.02278 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.024 | L2-Norm(final)=12.596 | 5580.7 samples/s | 87.2 steps/s
[Step=28150 Epoch=137.2] | Loss=0.02249 | Reg=0.00122 | acc=0.9688 | L2-Norm=11.024 | L2-Norm(final)=12.601 | 5499.3 samples/s | 85.9 steps/s
[Step=28200 Epoch=137.4] | Loss=0.02226 | Reg=0.00122 | acc=0.9688 | L2-Norm=11.024 | L2-Norm(final)=12.609 | 8684.9 samples/s | 135.7 steps/s
[Step=28250 Epoch=137.6] | Loss=0.02178 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=12.616 | 2677.5 samples/s | 41.8 steps/s
[Step=28300 Epoch=137.9] | Loss=0.02170 | Reg=0.00122 | acc=0.9688 | L2-Norm=11.024 | L2-Norm(final)=12.625 | 5439.6 samples/s | 85.0 steps/s
[Step=28350 Epoch=138.1] | Loss=0.02210 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=12.633 | 5560.0 samples/s | 86.9 steps/s
[Step=28400 Epoch=138.4] | Loss=0.02221 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.024 | L2-Norm(final)=12.639 | 7636.1 samples/s | 119.3 steps/s
[Step=28450 Epoch=138.6] | Loss=0.02242 | Reg=0.00122 | acc=0.9531 | L2-Norm=11.024 | L2-Norm(final)=12.646 | 2790.3 samples/s | 43.6 steps/s
[Step=28500 Epoch=138.9] | Loss=0.02218 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.024 | L2-Norm(final)=12.652 | 5549.2 samples/s | 86.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=138.9] | Loss=0.01619 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.024 | L2-Norm(final)=12.715 | 6766.1 samples/s | 105.7 steps/s
[Step=28550 Epoch=139.1] | Loss=0.02266 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.064 | L2-Norm(final)=12.718 | 4388.3 samples/s | 68.6 steps/s
[Step=28600 Epoch=139.4] | Loss=0.02431 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.105 | L2-Norm(final)=12.710 | 4799.5 samples/s | 75.0 steps/s
[Step=28650 Epoch=139.6] | Loss=0.02459 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.136 | L2-Norm(final)=12.706 | 4784.9 samples/s | 74.8 steps/s
[Step=28700 Epoch=139.8] | Loss=0.02420 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.161 | L2-Norm(final)=12.702 | 6830.1 samples/s | 106.7 steps/s
[Step=28750 Epoch=140.1] | Loss=0.02216 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.184 | L2-Norm(final)=12.702 | 2481.8 samples/s | 38.8 steps/s
[Step=28800 Epoch=140.3] | Loss=0.01999 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.204 | L2-Norm(final)=12.702 | 4766.7 samples/s | 74.5 steps/s
[Step=28850 Epoch=140.6] | Loss=0.01810 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.221 | L2-Norm(final)=12.704 | 4743.6 samples/s | 74.1 steps/s
[Step=28900 Epoch=140.8] | Loss=0.01721 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=12.707 | 6180.8 samples/s | 96.6 steps/s
[Step=28950 Epoch=141.1] | Loss=0.01586 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.246 | L2-Norm(final)=12.709 | 2561.2 samples/s | 40.0 steps/s
[Step=29000 Epoch=141.3] | Loss=0.01487 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.257 | L2-Norm(final)=12.712 | 4782.0 samples/s | 74.7 steps/s
[Step=29050 Epoch=141.5] | Loss=0.01423 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.266 | L2-Norm(final)=12.714 | 4754.8 samples/s | 74.3 steps/s
[Step=29100 Epoch=141.8] | Loss=0.01348 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.274 | L2-Norm(final)=12.716 | 5673.2 samples/s | 88.6 steps/s
[Step=29150 Epoch=142.0] | Loss=0.01265 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=12.719 | 2687.7 samples/s | 42.0 steps/s
[Step=29200 Epoch=142.3] | Loss=0.01207 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.289 | L2-Norm(final)=12.722 | 4786.1 samples/s | 74.8 steps/s
[Step=29250 Epoch=142.5] | Loss=0.01161 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.296 | L2-Norm(final)=12.725 | 4686.5 samples/s | 73.2 steps/s
[Step=29300 Epoch=142.8] | Loss=0.01127 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.302 | L2-Norm(final)=12.727 | 5268.7 samples/s | 82.3 steps/s
[Step=29350 Epoch=143.0] | Loss=0.01096 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.307 | L2-Norm(final)=12.729 | 2781.4 samples/s | 43.5 steps/s
[Step=29400 Epoch=143.3] | Loss=0.01055 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.313 | L2-Norm(final)=12.731 | 4833.6 samples/s | 75.5 steps/s
[Step=29450 Epoch=143.5] | Loss=0.01022 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.318 | L2-Norm(final)=12.733 | 4653.5 samples/s | 72.7 steps/s
[Step=29500 Epoch=143.7] | Loss=0.00983 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.323 | L2-Norm(final)=12.735 | 4883.3 samples/s | 76.3 steps/s
[Step=29550 Epoch=144.0] | Loss=0.00964 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.328 | L2-Norm(final)=12.737 | 2877.5 samples/s | 45.0 steps/s
[Step=29600 Epoch=144.2] | Loss=0.00929 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.332 | L2-Norm(final)=12.740 | 4802.3 samples/s | 75.0 steps/s
[Step=29650 Epoch=144.5] | Loss=0.00905 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.337 | L2-Norm(final)=12.742 | 4715.4 samples/s | 73.7 steps/s
[Step=29700 Epoch=144.7] | Loss=0.00887 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=12.744 | 4745.1 samples/s | 74.1 steps/s
[Step=29750 Epoch=145.0] | Loss=0.00865 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.345 | L2-Norm(final)=12.746 | 2970.7 samples/s | 46.4 steps/s
[Step=29800 Epoch=145.2] | Loss=0.00857 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=12.748 | 4728.2 samples/s | 73.9 steps/s
[Step=29850 Epoch=145.4] | Loss=0.00836 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=12.750 | 4762.0 samples/s | 74.4 steps/s
[Step=29900 Epoch=145.7] | Loss=0.00816 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.356 | L2-Norm(final)=12.752 | 4781.2 samples/s | 74.7 steps/s
[Step=29950 Epoch=145.9] | Loss=0.00799 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.359 | L2-Norm(final)=12.754 | 2936.7 samples/s | 45.9 steps/s
[Step=30000 Epoch=146.2] | Loss=0.00788 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.362 | L2-Norm(final)=12.756 | 4785.0 samples/s | 74.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step30000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=117.7] | Loss=0.01535 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.024 | L2-Norm(final)=13.657 | 6811.4 samples/s | 106.4 steps/s
[Step=24050 Epoch=117.9] | Loss=0.02210 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.024 | L2-Norm(final)=13.654 | 5063.6 samples/s | 79.1 steps/s
[Step=24100 Epoch=118.2] | Loss=0.02338 | Reg=0.00122 | acc=0.9688 | L2-Norm=11.024 | L2-Norm(final)=13.653 | 5562.5 samples/s | 86.9 steps/s
[Step=24150 Epoch=118.4] | Loss=0.02309 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=13.657 | 5369.5 samples/s | 83.9 steps/s
[Step=24200 Epoch=118.7] | Loss=0.02284 | Reg=0.00122 | acc=0.9531 | L2-Norm=11.024 | L2-Norm(final)=13.662 | 8986.0 samples/s | 140.4 steps/s
[Step=24250 Epoch=118.9] | Loss=0.02235 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.024 | L2-Norm(final)=13.667 | 2647.5 samples/s | 41.4 steps/s
[Step=24300 Epoch=119.2] | Loss=0.02220 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=13.672 | 5575.3 samples/s | 87.1 steps/s
[Step=24350 Epoch=119.4] | Loss=0.02218 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.024 | L2-Norm(final)=13.677 | 5578.9 samples/s | 87.2 steps/s
[Step=24400 Epoch=119.7] | Loss=0.02279 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=13.679 | 8121.8 samples/s | 126.9 steps/s
[Step=24450 Epoch=119.9] | Loss=0.02223 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.024 | L2-Norm(final)=13.682 | 2739.6 samples/s | 42.8 steps/s
[Step=24500 Epoch=120.1] | Loss=0.02205 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=13.686 | 5366.6 samples/s | 83.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=120.1] | Loss=0.07547 | Reg=0.00122 | acc=0.9219 | L2-Norm=11.024 | L2-Norm(final)=13.725 | 7071.4 samples/s | 110.5 steps/s
[Step=24550 Epoch=120.4] | Loss=0.02612 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.070 | L2-Norm(final)=13.728 | 4290.2 samples/s | 67.0 steps/s
[Step=24600 Epoch=120.6] | Loss=0.02697 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.117 | L2-Norm(final)=13.720 | 4750.1 samples/s | 74.2 steps/s
[Step=24650 Epoch=120.9] | Loss=0.02506 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.151 | L2-Norm(final)=13.715 | 4747.3 samples/s | 74.2 steps/s
[Step=24700 Epoch=121.1] | Loss=0.02356 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=13.715 | 7065.4 samples/s | 110.4 steps/s
[Step=24750 Epoch=121.4] | Loss=0.02037 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.201 | L2-Norm(final)=13.717 | 2458.7 samples/s | 38.4 steps/s
[Step=24800 Epoch=121.6] | Loss=0.01848 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.219 | L2-Norm(final)=13.720 | 4713.3 samples/s | 73.6 steps/s
[Step=24850 Epoch=121.9] | Loss=0.01701 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.234 | L2-Norm(final)=13.723 | 4769.7 samples/s | 74.5 steps/s
[Step=24900 Epoch=122.1] | Loss=0.01558 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.248 | L2-Norm(final)=13.726 | 6572.2 samples/s | 102.7 steps/s
[Step=24950 Epoch=122.4] | Loss=0.01429 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=13.730 | 2519.9 samples/s | 39.4 steps/s
[Step=25000 Epoch=122.6] | Loss=0.01330 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.270 | L2-Norm(final)=13.733 | 4747.6 samples/s | 74.2 steps/s
[Step=25050 Epoch=122.8] | Loss=0.01254 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.279 | L2-Norm(final)=13.737 | 4766.9 samples/s | 74.5 steps/s
[Step=25100 Epoch=123.1] | Loss=0.01193 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=13.740 | 6138.7 samples/s | 95.9 steps/s
[Step=25150 Epoch=123.3] | Loss=0.01134 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=13.743 | 2569.8 samples/s | 40.2 steps/s
[Step=25200 Epoch=123.6] | Loss=0.01085 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.300 | L2-Norm(final)=13.745 | 4794.9 samples/s | 74.9 steps/s
[Step=25250 Epoch=123.8] | Loss=0.01041 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.306 | L2-Norm(final)=13.748 | 4762.4 samples/s | 74.4 steps/s
[Step=25300 Epoch=124.1] | Loss=0.00996 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.312 | L2-Norm(final)=13.751 | 5742.3 samples/s | 89.7 steps/s
[Step=25350 Epoch=124.3] | Loss=0.00954 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.317 | L2-Norm(final)=13.754 | 2609.6 samples/s | 40.8 steps/s
[Step=25400 Epoch=124.6] | Loss=0.00911 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.322 | L2-Norm(final)=13.757 | 4740.7 samples/s | 74.1 steps/s
[Step=25450 Epoch=124.8] | Loss=0.00881 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.326 | L2-Norm(final)=13.760 | 4838.6 samples/s | 75.6 steps/s
[Step=25500 Epoch=125.0] | Loss=0.00865 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.330 | L2-Norm(final)=13.763 | 5414.3 samples/s | 84.6 steps/s
[Step=25550 Epoch=125.3] | Loss=0.00839 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.334 | L2-Norm(final)=13.765 | 2745.1 samples/s | 42.9 steps/s
[Step=25600 Epoch=125.5] | Loss=0.00811 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.338 | L2-Norm(final)=13.768 | 4651.2 samples/s | 72.7 steps/s
[Step=25650 Epoch=125.8] | Loss=0.00787 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=13.770 | 4782.2 samples/s | 74.7 steps/s
[Step=25700 Epoch=126.0] | Loss=0.00771 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.345 | L2-Norm(final)=13.773 | 5207.7 samples/s | 81.4 steps/s
[Step=25750 Epoch=126.3] | Loss=0.00755 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=13.775 | 2791.2 samples/s | 43.6 steps/s
[Step=25800 Epoch=126.5] | Loss=0.00745 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=13.778 | 4689.9 samples/s | 73.3 steps/s
[Step=25850 Epoch=126.8] | Loss=0.00726 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=13.780 | 4733.9 samples/s | 74.0 steps/s
[Step=25900 Epoch=127.0] | Loss=0.00707 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=13.782 | 5013.8 samples/s | 78.3 steps/s
[Step=25950 Epoch=127.3] | Loss=0.00692 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.361 | L2-Norm(final)=13.785 | 2816.7 samples/s | 44.0 steps/s
[Step=26000 Epoch=127.5] | Loss=0.00675 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=13.787 | 4764.4 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step26000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=247.3] | Loss=0.00011 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=14.594 | 6681.0 samples/s | 104.4 steps/s
[Step=26050 Epoch=247.8] | Loss=0.00081 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=14.615 | 4550.6 samples/s | 71.1 steps/s
[Step=26100 Epoch=248.3] | Loss=0.00074 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=14.642 | 8369.9 samples/s | 130.8 steps/s
[Step=26150 Epoch=248.8] | Loss=0.00064 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=14.662 | 2552.3 samples/s | 39.9 steps/s
[Step=26200 Epoch=249.2] | Loss=0.00066 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=14.680 | 7358.4 samples/s | 115.0 steps/s
[Step=26250 Epoch=249.7] | Loss=0.00067 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=14.699 | 2689.5 samples/s | 42.0 steps/s
[Step=26300 Epoch=250.2] | Loss=0.00067 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=14.717 | 6463.9 samples/s | 101.0 steps/s
[Step=26350 Epoch=250.7] | Loss=0.00065 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=14.734 | 2821.9 samples/s | 44.1 steps/s
[Step=26400 Epoch=251.1] | Loss=0.00066 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=14.750 | 5895.1 samples/s | 92.1 steps/s
[Step=26450 Epoch=251.6] | Loss=0.00067 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=14.766 | 2914.2 samples/s | 45.5 steps/s
[Step=26500 Epoch=252.1] | Loss=0.00066 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=14.782 | 5444.3 samples/s | 85.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=252.1] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=14.940 | 6749.3 samples/s | 105.5 steps/s
[Step=26550 Epoch=252.6] | Loss=0.00097 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.049 | L2-Norm(final)=14.945 | 4267.7 samples/s | 66.7 steps/s
[Step=26600 Epoch=253.0] | Loss=0.00144 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.097 | L2-Norm(final)=14.945 | 6556.6 samples/s | 102.4 steps/s
[Step=26650 Epoch=253.5] | Loss=0.00116 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.133 | L2-Norm(final)=14.944 | 2394.6 samples/s | 37.4 steps/s
[Step=26700 Epoch=254.0] | Loss=0.00104 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.156 | L2-Norm(final)=14.945 | 5987.9 samples/s | 93.6 steps/s
[Step=26750 Epoch=254.5] | Loss=0.00083 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.170 | L2-Norm(final)=14.945 | 2469.9 samples/s | 38.6 steps/s
[Step=26800 Epoch=254.9] | Loss=0.00070 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=14.946 | 5504.1 samples/s | 86.0 steps/s
[Step=26850 Epoch=255.4] | Loss=0.00060 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.179 | L2-Norm(final)=14.947 | 2556.8 samples/s | 39.9 steps/s
[Step=26900 Epoch=255.9] | Loss=0.00052 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.179 | L2-Norm(final)=14.948 | 5065.0 samples/s | 79.1 steps/s
[Step=26950 Epoch=256.4] | Loss=0.00047 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=14.948 | 2693.1 samples/s | 42.1 steps/s
[Step=27000 Epoch=256.8] | Loss=0.00042 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.175 | L2-Norm(final)=14.949 | 4639.7 samples/s | 72.5 steps/s
[Step=27050 Epoch=257.3] | Loss=0.00038 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.171 | L2-Norm(final)=14.949 | 2822.4 samples/s | 44.1 steps/s
[Step=27100 Epoch=257.8] | Loss=0.00035 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.167 | L2-Norm(final)=14.950 | 4552.2 samples/s | 71.1 steps/s
[Step=27150 Epoch=258.3] | Loss=0.00032 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.162 | L2-Norm(final)=14.950 | 2886.2 samples/s | 45.1 steps/s
[Step=27200 Epoch=258.7] | Loss=0.00030 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=14.951 | 4333.6 samples/s | 67.7 steps/s
[Step=27250 Epoch=259.2] | Loss=0.00028 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.152 | L2-Norm(final)=14.951 | 2871.7 samples/s | 44.9 steps/s
[Step=27300 Epoch=259.7] | Loss=0.00026 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.146 | L2-Norm(final)=14.951 | 4504.5 samples/s | 70.4 steps/s
[Step=27350 Epoch=260.2] | Loss=0.00025 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.141 | L2-Norm(final)=14.952 | 2930.8 samples/s | 45.8 steps/s
[Step=27400 Epoch=260.6] | Loss=0.00024 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.135 | L2-Norm(final)=14.952 | 4377.5 samples/s | 68.4 steps/s
[Step=27450 Epoch=261.1] | Loss=0.00022 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.128 | L2-Norm(final)=14.953 | 6881.1 samples/s | 107.5 steps/s
[Step=27500 Epoch=261.6] | Loss=0.00021 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.122 | L2-Norm(final)=14.953 | 2355.5 samples/s | 36.8 steps/s
[Step=27550 Epoch=262.1] | Loss=0.00020 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.116 | L2-Norm(final)=14.953 | 6232.1 samples/s | 97.4 steps/s
[Step=27600 Epoch=262.5] | Loss=0.00019 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.109 | L2-Norm(final)=14.954 | 2435.4 samples/s | 38.1 steps/s
[Step=27650 Epoch=263.0] | Loss=0.00018 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.103 | L2-Norm(final)=14.954 | 5659.4 samples/s | 88.4 steps/s
[Step=27700 Epoch=263.5] | Loss=0.00018 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.096 | L2-Norm(final)=14.954 | 2555.2 samples/s | 39.9 steps/s
[Step=27750 Epoch=264.0] | Loss=0.00017 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.089 | L2-Norm(final)=14.955 | 5156.5 samples/s | 80.6 steps/s
[Step=27800 Epoch=264.4] | Loss=0.00016 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.083 | L2-Norm(final)=14.955 | 2675.0 samples/s | 41.8 steps/s
[Step=27850 Epoch=264.9] | Loss=0.00016 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.076 | L2-Norm(final)=14.955 | 4731.1 samples/s | 73.9 steps/s
[Step=27900 Epoch=265.4] | Loss=0.00015 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.069 | L2-Norm(final)=14.956 | 2773.1 samples/s | 43.3 steps/s
[Step=27950 Epoch=265.9] | Loss=0.00015 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.062 | L2-Norm(final)=14.956 | 4527.6 samples/s | 70.7 steps/s
[Step=28000 Epoch=266.3] | Loss=0.00014 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.054 | L2-Norm(final)=14.956 | 2536.1 samples/s | 39.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step28000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=32001 Epoch=305.0] | Loss=0.00088 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=15.812 | 6572.8 samples/s | 102.7 steps/s
[Step=32050 Epoch=305.5] | Loss=0.00116 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=15.828 | 4596.3 samples/s | 71.8 steps/s
[Step=32100 Epoch=305.9] | Loss=0.00121 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=15.844 | 8145.7 samples/s | 127.3 steps/s
[Step=32150 Epoch=306.4] | Loss=0.00126 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=15.861 | 2555.8 samples/s | 39.9 steps/s
[Step=32200 Epoch=306.9] | Loss=0.00120 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=15.878 | 7453.1 samples/s | 116.5 steps/s
[Step=32250 Epoch=307.4] | Loss=0.00125 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=15.894 | 2644.1 samples/s | 41.3 steps/s
[Step=32300 Epoch=307.8] | Loss=0.00120 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=15.910 | 6726.0 samples/s | 105.1 steps/s
[Step=32350 Epoch=308.3] | Loss=0.00122 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=15.925 | 2758.0 samples/s | 43.1 steps/s
[Step=32400 Epoch=308.8] | Loss=0.00117 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=15.940 | 6115.1 samples/s | 95.5 steps/s
[Step=32450 Epoch=309.3] | Loss=0.00120 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=15.955 | 2846.8 samples/s | 44.5 steps/s
[Step=32500 Epoch=309.8] | Loss=0.00119 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=15.969 | 5689.4 samples/s | 88.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=32501 Epoch=309.8] | Loss=0.00214 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=16.114 | 6731.4 samples/s | 105.2 steps/s
[Step=32550 Epoch=310.2] | Loss=0.00052 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.051 | L2-Norm(final)=16.120 | 4127.6 samples/s | 64.5 steps/s
[Step=32600 Epoch=310.7] | Loss=0.00037 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.070 | L2-Norm(final)=16.123 | 6566.4 samples/s | 102.6 steps/s
[Step=32650 Epoch=311.2] | Loss=0.00025 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.073 | L2-Norm(final)=16.125 | 2374.9 samples/s | 37.1 steps/s
[Step=32700 Epoch=311.7] | Loss=0.00019 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.069 | L2-Norm(final)=16.126 | 6075.1 samples/s | 94.9 steps/s
[Step=32750 Epoch=312.1] | Loss=0.00015 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.063 | L2-Norm(final)=16.127 | 2443.7 samples/s | 38.2 steps/s
[Step=32800 Epoch=312.6] | Loss=0.00013 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.054 | L2-Norm(final)=16.128 | 5660.1 samples/s | 88.4 steps/s
[Step=32850 Epoch=313.1] | Loss=0.00011 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.046 | L2-Norm(final)=16.129 | 2537.5 samples/s | 39.6 steps/s
[Step=32900 Epoch=313.6] | Loss=0.00010 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.036 | L2-Norm(final)=16.129 | 5224.9 samples/s | 81.6 steps/s
[Step=32950 Epoch=314.0] | Loss=0.00009 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.027 | L2-Norm(final)=16.130 | 2624.9 samples/s | 41.0 steps/s
[Step=33000 Epoch=314.5] | Loss=0.00008 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=16.130 | 4942.0 samples/s | 77.2 steps/s
[Step=33050 Epoch=315.0] | Loss=0.00007 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.008 | L2-Norm(final)=16.131 | 2733.7 samples/s | 42.7 steps/s
[Step=33100 Epoch=315.5] | Loss=0.00007 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.998 | L2-Norm(final)=16.131 | 4602.2 samples/s | 71.9 steps/s
[Step=33150 Epoch=315.9] | Loss=0.00006 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.988 | L2-Norm(final)=16.132 | 2851.6 samples/s | 44.6 steps/s
[Step=33200 Epoch=316.4] | Loss=0.00006 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.978 | L2-Norm(final)=16.132 | 4463.5 samples/s | 69.7 steps/s
[Step=33250 Epoch=316.9] | Loss=0.00005 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.968 | L2-Norm(final)=16.132 | 2829.0 samples/s | 44.2 steps/s
[Step=33300 Epoch=317.4] | Loss=0.00005 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.958 | L2-Norm(final)=16.133 | 4613.1 samples/s | 72.1 steps/s
[Step=33350 Epoch=317.9] | Loss=0.00005 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.949 | L2-Norm(final)=16.133 | 2818.5 samples/s | 44.0 steps/s
[Step=33400 Epoch=318.3] | Loss=0.00005 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.939 | L2-Norm(final)=16.133 | 4581.2 samples/s | 71.6 steps/s
[Step=33450 Epoch=318.8] | Loss=0.00004 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.929 | L2-Norm(final)=16.134 | 2846.7 samples/s | 44.5 steps/s
[Step=33500 Epoch=319.3] | Loss=0.00004 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.919 | L2-Norm(final)=16.134 | 4190.9 samples/s | 65.5 steps/s
[Step=33550 Epoch=319.8] | Loss=0.00004 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.909 | L2-Norm(final)=16.134 | 7302.7 samples/s | 114.1 steps/s
[Step=33600 Epoch=320.2] | Loss=0.00004 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.898 | L2-Norm(final)=16.135 | 2339.0 samples/s | 36.5 steps/s
[Step=33650 Epoch=320.7] | Loss=0.00004 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.888 | L2-Norm(final)=16.135 | 6369.2 samples/s | 99.5 steps/s
[Step=33700 Epoch=321.2] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.878 | L2-Norm(final)=16.135 | 2360.2 samples/s | 36.9 steps/s
[Step=33750 Epoch=321.7] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.868 | L2-Norm(final)=16.135 | 6160.0 samples/s | 96.3 steps/s
[Step=33800 Epoch=322.1] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.858 | L2-Norm(final)=16.136 | 2454.0 samples/s | 38.3 steps/s
[Step=33850 Epoch=322.6] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.848 | L2-Norm(final)=16.136 | 5643.4 samples/s | 88.2 steps/s
[Step=33900 Epoch=323.1] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.837 | L2-Norm(final)=16.136 | 2513.3 samples/s | 39.3 steps/s
[Step=33950 Epoch=323.6] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.827 | L2-Norm(final)=16.137 | 5292.5 samples/s | 82.7 steps/s
[Step=34000 Epoch=324.1] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.817 | L2-Norm(final)=16.137 | 2613.4 samples/s | 40.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step34000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09866 | acc=0.9594 | tpr=0.9813 | fpr=0.0882 | 6014.2 samples/s | 23.5 steps/s
Avg test loss: 0.10521, Avg test acc: 0.95745, Avg tpr: 0.97884, Avg fpr: 0.08960, total FA: 699

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10992 | acc=0.9589 | tpr=0.9724 | fpr=0.0704 | 5819.1 samples/s | 22.7 steps/s
Avg test loss: 0.11332, Avg test acc: 0.95773, Avg tpr: 0.97097, Avg fpr: 0.07140, total FA: 557

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.12292 | acc=0.9564 | tpr=0.9846 | fpr=0.1048 | 6066.2 samples/s | 23.7 steps/s
Avg test loss: 0.12358, Avg test acc: 0.95504, Avg tpr: 0.98246, Avg fpr: 0.10524, total FA: 821

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10222 | acc=0.9585 | tpr=0.9736 | fpr=0.0743 | 6138.5 samples/s | 24.0 steps/s
Avg test loss: 0.10737, Avg test acc: 0.95753, Avg tpr: 0.97342, Avg fpr: 0.07743, total FA: 604

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10597 | acc=0.9583 | tpr=0.9766 | fpr=0.0815 | 5899.7 samples/s | 23.0 steps/s
Avg test loss: 0.10876, Avg test acc: 0.95757, Avg tpr: 0.97459, Avg fpr: 0.07986, total FA: 623

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.86810 | acc=0.2933 | tpr=0.0178 | fpr=0.1085 | 6057.8 samples/s | 23.7 steps/s
Avg test loss: 6.87030, Avg test acc: 0.29109, Avg tpr: 0.01644, Avg fpr: 0.10486, total FA: 818

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.96724 | acc=0.2916 | tpr=0.0406 | fpr=0.1633 | 5946.9 samples/s | 23.2 steps/s
Avg test loss: 4.98256, Avg test acc: 0.28820, Avg tpr: 0.03893, Avg fpr: 0.16357, total FA: 1276

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.18778 | acc=0.2784 | tpr=0.0215 | fpr=0.1638 | 5987.3 samples/s | 23.4 steps/s
Avg test loss: 5.19142, Avg test acc: 0.27699, Avg tpr: 0.02034, Avg fpr: 0.15857, total FA: 1237

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.94386 | acc=0.2717 | tpr=0.0324 | fpr=0.2086 | 5926.9 samples/s | 23.2 steps/s
Avg test loss: 4.94662, Avg test acc: 0.27170, Avg tpr: 0.03002, Avg fpr: 0.19677, total FA: 1535

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.22861 | acc=0.2937 | tpr=0.0154 | fpr=0.1021 | 6071.4 samples/s | 23.7 steps/s
Avg test loss: 5.24421, Avg test acc: 0.29269, Avg tpr: 0.01568, Avg fpr: 0.09806, total FA: 765

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.07631 | acc=0.1123 | tpr=0.6681 | fpr=0.8977 | 5804.1 samples/s | 22.7 steps/s
[Step= 100] | Loss=6.05396 | acc=0.1137 | tpr=0.6525 | fpr=0.8964 | 8206.6 samples/s | 32.1 steps/s
[Step= 150] | Loss=6.04692 | acc=0.1163 | tpr=0.6744 | fpr=0.8940 | 8075.1 samples/s | 31.5 steps/s
[Step= 200] | Loss=6.03708 | acc=0.1163 | tpr=0.6678 | fpr=0.8938 | 7926.3 samples/s | 31.0 steps/s
[Step= 250] | Loss=6.04044 | acc=0.1162 | tpr=0.6638 | fpr=0.8938 | 8035.6 samples/s | 31.4 steps/s
[Step= 300] | Loss=6.03125 | acc=0.1167 | tpr=0.6604 | fpr=0.8932 | 7911.2 samples/s | 30.9 steps/s
[Step= 350] | Loss=6.03773 | acc=0.1168 | tpr=0.6625 | fpr=0.8931 | 7822.4 samples/s | 30.6 steps/s
[Step= 400] | Loss=6.03365 | acc=0.1168 | tpr=0.6581 | fpr=0.8930 | 7819.9 samples/s | 30.5 steps/s
[Step= 450] | Loss=6.03888 | acc=0.1163 | tpr=0.6597 | fpr=0.8936 | 8339.0 samples/s | 32.6 steps/s
[Step= 500] | Loss=6.03940 | acc=0.1163 | tpr=0.6639 | fpr=0.8935 | 8330.2 samples/s | 32.5 steps/s
[Step= 550] | Loss=6.04112 | acc=0.1166 | tpr=0.6681 | fpr=0.8934 | 10117.1 samples/s | 39.5 steps/s
Avg test loss: 6.04146, Avg test acc: 0.11651, Avg tpr: 0.66878, Avg fpr: 0.89353, total FA: 124065

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.77937 | acc=0.1306 | tpr=0.6150 | fpr=0.8781 | 5948.7 samples/s | 23.2 steps/s
[Step= 100] | Loss=5.76048 | acc=0.1352 | tpr=0.6247 | fpr=0.8739 | 8038.0 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.75181 | acc=0.1367 | tpr=0.6427 | fpr=0.8726 | 8107.8 samples/s | 31.7 steps/s
[Step= 200] | Loss=5.74350 | acc=0.1366 | tpr=0.6383 | fpr=0.8725 | 8158.5 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.74925 | acc=0.1363 | tpr=0.6367 | fpr=0.8728 | 8044.7 samples/s | 31.4 steps/s
[Step= 300] | Loss=5.74325 | acc=0.1358 | tpr=0.6284 | fpr=0.8732 | 8026.3 samples/s | 31.4 steps/s
[Step= 350] | Loss=5.75111 | acc=0.1355 | tpr=0.6255 | fpr=0.8734 | 7685.7 samples/s | 30.0 steps/s
[Step= 400] | Loss=5.74615 | acc=0.1357 | tpr=0.6269 | fpr=0.8733 | 8298.8 samples/s | 32.4 steps/s
[Step= 450] | Loss=5.74940 | acc=0.1351 | tpr=0.6319 | fpr=0.8739 | 8048.6 samples/s | 31.4 steps/s
[Step= 500] | Loss=5.74988 | acc=0.1350 | tpr=0.6348 | fpr=0.8741 | 7336.5 samples/s | 28.7 steps/s
[Step= 550] | Loss=5.75352 | acc=0.1350 | tpr=0.6379 | fpr=0.8741 | 11240.2 samples/s | 43.9 steps/s
Avg test loss: 5.75415, Avg test acc: 0.13492, Avg tpr: 0.63827, Avg fpr: 0.87423, total FA: 121385

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.14906 | acc=0.1079 | tpr=0.7257 | fpr=0.9032 | 6002.5 samples/s | 23.4 steps/s
[Step= 100] | Loss=6.13469 | acc=0.1092 | tpr=0.7164 | fpr=0.9022 | 7955.6 samples/s | 31.1 steps/s
[Step= 150] | Loss=6.12805 | acc=0.1106 | tpr=0.7133 | fpr=0.9005 | 7895.7 samples/s | 30.8 steps/s
[Step= 200] | Loss=6.12325 | acc=0.1105 | tpr=0.7016 | fpr=0.9002 | 8174.2 samples/s | 31.9 steps/s
[Step= 250] | Loss=6.12814 | acc=0.1110 | tpr=0.7022 | fpr=0.8997 | 7911.4 samples/s | 30.9 steps/s
[Step= 300] | Loss=6.12392 | acc=0.1107 | tpr=0.6953 | fpr=0.8999 | 7943.0 samples/s | 31.0 steps/s
[Step= 350] | Loss=6.13102 | acc=0.1107 | tpr=0.7007 | fpr=0.9000 | 7944.1 samples/s | 31.0 steps/s
[Step= 400] | Loss=6.12959 | acc=0.1106 | tpr=0.7019 | fpr=0.9002 | 8236.9 samples/s | 32.2 steps/s
[Step= 450] | Loss=6.13525 | acc=0.1099 | tpr=0.7030 | fpr=0.9009 | 8324.1 samples/s | 32.5 steps/s
[Step= 500] | Loss=6.13533 | acc=0.1098 | tpr=0.7040 | fpr=0.9009 | 7898.2 samples/s | 30.9 steps/s
[Step= 550] | Loss=6.14065 | acc=0.1100 | tpr=0.7059 | fpr=0.9008 | 9816.6 samples/s | 38.3 steps/s
Avg test loss: 6.14106, Avg test acc: 0.10997, Avg tpr: 0.70721, Avg fpr: 0.90089, total FA: 125087

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.77950 | acc=0.1355 | tpr=0.6814 | fpr=0.8743 | 6097.0 samples/s | 23.8 steps/s
[Step= 100] | Loss=5.76258 | acc=0.1379 | tpr=0.6588 | fpr=0.8718 | 7684.9 samples/s | 30.0 steps/s
[Step= 150] | Loss=5.74797 | acc=0.1395 | tpr=0.6700 | fpr=0.8703 | 8622.1 samples/s | 33.7 steps/s
[Step= 200] | Loss=5.73847 | acc=0.1398 | tpr=0.6634 | fpr=0.8697 | 7524.5 samples/s | 29.4 steps/s
[Step= 250] | Loss=5.74136 | acc=0.1396 | tpr=0.6594 | fpr=0.8698 | 7557.8 samples/s | 29.5 steps/s
[Step= 300] | Loss=5.73557 | acc=0.1390 | tpr=0.6567 | fpr=0.8705 | 8143.9 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.74135 | acc=0.1389 | tpr=0.6562 | fpr=0.8704 | 8414.3 samples/s | 32.9 steps/s
[Step= 400] | Loss=5.73827 | acc=0.1395 | tpr=0.6565 | fpr=0.8699 | 8161.0 samples/s | 31.9 steps/s
[Step= 450] | Loss=5.74342 | acc=0.1386 | tpr=0.6573 | fpr=0.8708 | 8537.9 samples/s | 33.4 steps/s
[Step= 500] | Loss=5.74306 | acc=0.1387 | tpr=0.6604 | fpr=0.8707 | 7923.1 samples/s | 30.9 steps/s
[Step= 550] | Loss=5.74917 | acc=0.1388 | tpr=0.6614 | fpr=0.8707 | 9354.7 samples/s | 36.5 steps/s
Avg test loss: 5.75013, Avg test acc: 0.13873, Avg tpr: 0.66165, Avg fpr: 0.87077, total FA: 120905

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.75668 | acc=0.1354 | tpr=0.6018 | fpr=0.8730 | 6021.1 samples/s | 23.5 steps/s
[Step= 100] | Loss=5.75036 | acc=0.1381 | tpr=0.5928 | fpr=0.8704 | 8110.9 samples/s | 31.7 steps/s
[Step= 150] | Loss=5.73899 | acc=0.1390 | tpr=0.6023 | fpr=0.8695 | 7132.5 samples/s | 27.9 steps/s
[Step= 200] | Loss=5.73508 | acc=0.1390 | tpr=0.6055 | fpr=0.8694 | 8124.8 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.73740 | acc=0.1389 | tpr=0.5886 | fpr=0.8693 | 8241.9 samples/s | 32.2 steps/s
[Step= 300] | Loss=5.73275 | acc=0.1390 | tpr=0.5862 | fpr=0.8692 | 7973.1 samples/s | 31.1 steps/s
[Step= 350] | Loss=5.74147 | acc=0.1388 | tpr=0.5786 | fpr=0.8692 | 7872.0 samples/s | 30.7 steps/s
[Step= 400] | Loss=5.73821 | acc=0.1390 | tpr=0.5793 | fpr=0.8690 | 8816.6 samples/s | 34.4 steps/s
[Step= 450] | Loss=5.74381 | acc=0.1384 | tpr=0.5823 | fpr=0.8696 | 8015.0 samples/s | 31.3 steps/s
[Step= 500] | Loss=5.74264 | acc=0.1384 | tpr=0.5841 | fpr=0.8696 | 8243.9 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.74651 | acc=0.1384 | tpr=0.5822 | fpr=0.8696 | 9939.8 samples/s | 38.8 steps/s
Avg test loss: 5.74784, Avg test acc: 0.13837, Avg tpr: 0.58281, Avg fpr: 0.86971, total FA: 120758

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.23159 | acc=0.9603 | tpr=0.9159 | fpr=0.0389 | 6171.8 samples/s | 24.1 steps/s
[Step= 100] | Loss=0.23839 | acc=0.9587 | tpr=0.9360 | fpr=0.0409 | 6961.5 samples/s | 27.2 steps/s
[Step= 150] | Loss=0.24337 | acc=0.9576 | tpr=0.9366 | fpr=0.0421 | 7806.2 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.24244 | acc=0.9569 | tpr=0.9410 | fpr=0.0428 | 8738.2 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.24226 | acc=0.9566 | tpr=0.9336 | fpr=0.0430 | 8150.8 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.24536 | acc=0.9563 | tpr=0.9316 | fpr=0.0433 | 7942.8 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.24507 | acc=0.9561 | tpr=0.9324 | fpr=0.0435 | 7384.7 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.24447 | acc=0.9560 | tpr=0.9305 | fpr=0.0436 | 8186.7 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.24898 | acc=0.9555 | tpr=0.9279 | fpr=0.0440 | 8605.1 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.24833 | acc=0.9553 | tpr=0.9291 | fpr=0.0442 | 7253.9 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.24701 | acc=0.9556 | tpr=0.9280 | fpr=0.0439 | 12172.9 samples/s | 47.6 steps/s
Avg test loss: 0.24674, Avg test acc: 0.95565, Avg tpr: 0.92789, Avg fpr: 0.04385, total FA: 6088

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14185 | acc=0.9665 | tpr=0.9071 | fpr=0.0324 | 6132.5 samples/s | 24.0 steps/s
[Step= 100] | Loss=0.14832 | acc=0.9652 | tpr=0.9168 | fpr=0.0339 | 7769.1 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.15007 | acc=0.9644 | tpr=0.9179 | fpr=0.0348 | 7634.6 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.14864 | acc=0.9644 | tpr=0.9191 | fpr=0.0348 | 7897.0 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.14838 | acc=0.9640 | tpr=0.9170 | fpr=0.0351 | 8168.2 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.15099 | acc=0.9636 | tpr=0.9127 | fpr=0.0355 | 8647.9 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.14989 | acc=0.9637 | tpr=0.9148 | fpr=0.0354 | 7807.1 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.15031 | acc=0.9635 | tpr=0.9125 | fpr=0.0356 | 8005.3 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.15327 | acc=0.9631 | tpr=0.9124 | fpr=0.0360 | 8601.0 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.15296 | acc=0.9632 | tpr=0.9141 | fpr=0.0359 | 8212.4 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.15213 | acc=0.9634 | tpr=0.9125 | fpr=0.0357 | 8967.4 samples/s | 35.0 steps/s
Avg test loss: 0.15186, Avg test acc: 0.96344, Avg tpr: 0.91244, Avg fpr: 0.03563, total FA: 4947

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26543 | acc=0.9510 | tpr=0.9558 | fpr=0.0491 | 5852.3 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.27326 | acc=0.9498 | tpr=0.9595 | fpr=0.0504 | 8249.4 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.27849 | acc=0.9487 | tpr=0.9597 | fpr=0.0515 | 7486.0 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.27843 | acc=0.9487 | tpr=0.9628 | fpr=0.0515 | 8823.9 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.27868 | acc=0.9487 | tpr=0.9624 | fpr=0.0515 | 7949.6 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.28186 | acc=0.9484 | tpr=0.9607 | fpr=0.0518 | 7884.0 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.27947 | acc=0.9484 | tpr=0.9599 | fpr=0.0518 | 8360.9 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.27970 | acc=0.9481 | tpr=0.9573 | fpr=0.0521 | 7437.1 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.28386 | acc=0.9476 | tpr=0.9557 | fpr=0.0525 | 8424.8 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.28436 | acc=0.9475 | tpr=0.9568 | fpr=0.0527 | 8058.1 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.28250 | acc=0.9479 | tpr=0.9570 | fpr=0.0523 | 10068.0 samples/s | 39.3 steps/s
Avg test loss: 0.28216, Avg test acc: 0.94788, Avg tpr: 0.95681, Avg fpr: 0.05228, total FA: 7259

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14973 | acc=0.9616 | tpr=0.9248 | fpr=0.0378 | 6164.8 samples/s | 24.1 steps/s
[Step= 100] | Loss=0.15547 | acc=0.9606 | tpr=0.9360 | fpr=0.0390 | 7714.6 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.15720 | acc=0.9596 | tpr=0.9337 | fpr=0.0400 | 7947.1 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.15675 | acc=0.9596 | tpr=0.9377 | fpr=0.0400 | 8016.0 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.15744 | acc=0.9595 | tpr=0.9354 | fpr=0.0401 | 8078.4 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.15898 | acc=0.9591 | tpr=0.9360 | fpr=0.0405 | 8161.6 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.15898 | acc=0.9590 | tpr=0.9349 | fpr=0.0406 | 7460.8 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.15899 | acc=0.9587 | tpr=0.9311 | fpr=0.0408 | 8457.8 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.16179 | acc=0.9582 | tpr=0.9323 | fpr=0.0414 | 8321.1 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.16150 | acc=0.9580 | tpr=0.9326 | fpr=0.0415 | 7503.2 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.16051 | acc=0.9583 | tpr=0.9324 | fpr=0.0413 | 10665.2 samples/s | 41.7 steps/s
Avg test loss: 0.16026, Avg test acc: 0.95828, Avg tpr: 0.93225, Avg fpr: 0.04125, total FA: 5727

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.22196 | acc=0.9566 | tpr=0.9115 | fpr=0.0426 | 5948.9 samples/s | 23.2 steps/s
[Step= 100] | Loss=0.23096 | acc=0.9552 | tpr=0.9296 | fpr=0.0443 | 7946.8 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.23581 | acc=0.9536 | tpr=0.9380 | fpr=0.0461 | 8129.2 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.23649 | acc=0.9537 | tpr=0.9421 | fpr=0.0460 | 7314.6 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.23666 | acc=0.9537 | tpr=0.9441 | fpr=0.0461 | 8273.9 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.24041 | acc=0.9532 | tpr=0.9425 | fpr=0.0466 | 7996.1 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.23908 | acc=0.9532 | tpr=0.9418 | fpr=0.0465 | 8330.8 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.23923 | acc=0.9529 | tpr=0.9404 | fpr=0.0468 | 8248.9 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.24319 | acc=0.9525 | tpr=0.9396 | fpr=0.0472 | 8165.2 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.24312 | acc=0.9524 | tpr=0.9414 | fpr=0.0474 | 8223.2 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.24162 | acc=0.9528 | tpr=0.9419 | fpr=0.0470 | 9794.5 samples/s | 38.3 steps/s
Avg test loss: 0.24141, Avg test acc: 0.95286, Avg tpr: 0.94176, Avg fpr: 0.04694, total FA: 6517

server round 30/50

clients selected: [1 6 7 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=156.2] | Loss=0.00618 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=13.901 | 7863.3 samples/s | 122.9 steps/s
[Step=32050 Epoch=156.4] | Loss=0.02316 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.957 | L2-Norm(final)=13.905 | 4635.0 samples/s | 72.4 steps/s
[Step=32100 Epoch=156.6] | Loss=0.02303 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.957 | L2-Norm(final)=13.907 | 5677.2 samples/s | 88.7 steps/s
[Step=32150 Epoch=156.9] | Loss=0.02207 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=13.909 | 5436.7 samples/s | 84.9 steps/s
[Step=32200 Epoch=157.1] | Loss=0.02104 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.957 | L2-Norm(final)=13.913 | 8537.9 samples/s | 133.4 steps/s
[Step=32250 Epoch=157.4] | Loss=0.02065 | Reg=0.00120 | acc=0.9531 | L2-Norm=10.957 | L2-Norm(final)=13.917 | 2650.9 samples/s | 41.4 steps/s
[Step=32300 Epoch=157.6] | Loss=0.02078 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=13.920 | 5581.2 samples/s | 87.2 steps/s
[Step=32350 Epoch=157.9] | Loss=0.02049 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.957 | L2-Norm(final)=13.924 | 5470.1 samples/s | 85.5 steps/s
[Step=32400 Epoch=158.1] | Loss=0.02047 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=13.928 | 7943.3 samples/s | 124.1 steps/s
[Step=32450 Epoch=158.3] | Loss=0.02046 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=13.931 | 2767.9 samples/s | 43.2 steps/s
[Step=32500 Epoch=158.6] | Loss=0.02054 | Reg=0.00120 | acc=0.9531 | L2-Norm=10.957 | L2-Norm(final)=13.934 | 5627.7 samples/s | 87.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=158.6] | Loss=0.02786 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.957 | L2-Norm(final)=13.966 | 7270.5 samples/s | 113.6 steps/s
[Step=32550 Epoch=158.8] | Loss=0.01711 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.972 | L2-Norm(final)=13.969 | 4214.2 samples/s | 65.8 steps/s
[Step=32600 Epoch=159.1] | Loss=0.01720 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.986 | L2-Norm(final)=13.970 | 4785.5 samples/s | 74.8 steps/s
[Step=32650 Epoch=159.3] | Loss=0.01540 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.997 | L2-Norm(final)=13.972 | 4728.7 samples/s | 73.9 steps/s
[Step=32700 Epoch=159.6] | Loss=0.01531 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.007 | L2-Norm(final)=13.973 | 6946.4 samples/s | 108.5 steps/s
[Step=32750 Epoch=159.8] | Loss=0.01370 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.015 | L2-Norm(final)=13.975 | 2464.7 samples/s | 38.5 steps/s
[Step=32800 Epoch=160.0] | Loss=0.01238 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=13.977 | 4737.5 samples/s | 74.0 steps/s
[Step=32850 Epoch=160.3] | Loss=0.01125 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.028 | L2-Norm(final)=13.979 | 4825.8 samples/s | 75.4 steps/s
[Step=32900 Epoch=160.5] | Loss=0.01050 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.033 | L2-Norm(final)=13.981 | 6297.6 samples/s | 98.4 steps/s
[Step=32950 Epoch=160.8] | Loss=0.00969 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.038 | L2-Norm(final)=13.984 | 2565.9 samples/s | 40.1 steps/s
[Step=33000 Epoch=161.0] | Loss=0.00910 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.043 | L2-Norm(final)=13.987 | 4654.5 samples/s | 72.7 steps/s
[Step=33050 Epoch=161.3] | Loss=0.00858 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.047 | L2-Norm(final)=13.989 | 4750.2 samples/s | 74.2 steps/s
[Step=33100 Epoch=161.5] | Loss=0.00824 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.051 | L2-Norm(final)=13.992 | 5861.4 samples/s | 91.6 steps/s
[Step=33150 Epoch=161.8] | Loss=0.00789 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.055 | L2-Norm(final)=13.994 | 2614.3 samples/s | 40.8 steps/s
[Step=33200 Epoch=162.0] | Loss=0.00753 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.058 | L2-Norm(final)=13.996 | 4760.9 samples/s | 74.4 steps/s
[Step=33250 Epoch=162.2] | Loss=0.00719 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.061 | L2-Norm(final)=13.998 | 4726.9 samples/s | 73.9 steps/s
[Step=33300 Epoch=162.5] | Loss=0.00697 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.064 | L2-Norm(final)=14.001 | 5513.6 samples/s | 86.2 steps/s
[Step=33350 Epoch=162.7] | Loss=0.00679 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.066 | L2-Norm(final)=14.003 | 2713.8 samples/s | 42.4 steps/s
[Step=33400 Epoch=163.0] | Loss=0.00660 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.069 | L2-Norm(final)=14.005 | 4765.5 samples/s | 74.5 steps/s
[Step=33450 Epoch=163.2] | Loss=0.00639 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.071 | L2-Norm(final)=14.006 | 4699.6 samples/s | 73.4 steps/s
[Step=33500 Epoch=163.5] | Loss=0.00625 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.074 | L2-Norm(final)=14.008 | 5148.3 samples/s | 80.4 steps/s
[Step=33550 Epoch=163.7] | Loss=0.00607 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.076 | L2-Norm(final)=14.010 | 2785.9 samples/s | 43.5 steps/s
[Step=33600 Epoch=164.0] | Loss=0.00594 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.078 | L2-Norm(final)=14.012 | 4789.2 samples/s | 74.8 steps/s
[Step=33650 Epoch=164.2] | Loss=0.00576 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.080 | L2-Norm(final)=14.014 | 4794.0 samples/s | 74.9 steps/s
[Step=33700 Epoch=164.4] | Loss=0.00562 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.082 | L2-Norm(final)=14.016 | 4842.2 samples/s | 75.7 steps/s
[Step=33750 Epoch=164.7] | Loss=0.00548 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.084 | L2-Norm(final)=14.017 | 2947.6 samples/s | 46.1 steps/s
[Step=33800 Epoch=164.9] | Loss=0.00538 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.085 | L2-Norm(final)=14.019 | 4648.6 samples/s | 72.6 steps/s
[Step=33850 Epoch=165.2] | Loss=0.00528 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=14.021 | 4805.5 samples/s | 75.1 steps/s
[Step=33900 Epoch=165.4] | Loss=0.00518 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.089 | L2-Norm(final)=14.023 | 4765.4 samples/s | 74.5 steps/s
[Step=33950 Epoch=165.7] | Loss=0.00511 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.091 | L2-Norm(final)=14.024 | 2919.0 samples/s | 45.6 steps/s
[Step=34000 Epoch=165.9] | Loss=0.00503 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.092 | L2-Norm(final)=14.026 | 4717.7 samples/s | 73.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step34000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=28001 Epoch=266.4] | Loss=0.00005 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=14.966 | 6911.8 samples/s | 108.0 steps/s
[Step=28050 Epoch=266.8] | Loss=0.00062 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=14.974 | 4530.2 samples/s | 70.8 steps/s
[Step=28100 Epoch=267.3] | Loss=0.00065 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=14.981 | 8396.5 samples/s | 131.2 steps/s
[Step=28150 Epoch=267.8] | Loss=0.00065 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=14.989 | 2553.5 samples/s | 39.9 steps/s
[Step=28200 Epoch=268.3] | Loss=0.00064 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=14.996 | 7435.4 samples/s | 116.2 steps/s
[Step=28250 Epoch=268.7] | Loss=0.00064 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=15.002 | 2698.2 samples/s | 42.2 steps/s
[Step=28300 Epoch=269.2] | Loss=0.00061 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=15.008 | 6548.3 samples/s | 102.3 steps/s
[Step=28350 Epoch=269.7] | Loss=0.00066 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=15.015 | 2801.2 samples/s | 43.8 steps/s
[Step=28400 Epoch=270.2] | Loss=0.00064 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=15.021 | 5962.6 samples/s | 93.2 steps/s
[Step=28450 Epoch=270.6] | Loss=0.00063 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=15.028 | 2935.3 samples/s | 45.9 steps/s
[Step=28500 Epoch=271.1] | Loss=0.00063 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=15.034 | 5452.2 samples/s | 85.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=28501 Epoch=271.1] | Loss=0.00004 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=15.096 | 6898.9 samples/s | 107.8 steps/s
[Step=28550 Epoch=271.6] | Loss=0.00032 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.961 | L2-Norm(final)=15.100 | 3972.8 samples/s | 62.1 steps/s
[Step=28600 Epoch=272.1] | Loss=0.00021 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.960 | L2-Norm(final)=15.103 | 6691.2 samples/s | 104.6 steps/s
[Step=28650 Epoch=272.5] | Loss=0.00014 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=15.105 | 2394.2 samples/s | 37.4 steps/s
[Step=28700 Epoch=273.0] | Loss=0.00011 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=15.107 | 6023.2 samples/s | 94.1 steps/s
[Step=28750 Epoch=273.5] | Loss=0.00009 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.946 | L2-Norm(final)=15.108 | 2467.3 samples/s | 38.6 steps/s
[Step=28800 Epoch=274.0] | Loss=0.00008 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.940 | L2-Norm(final)=15.109 | 5514.1 samples/s | 86.2 steps/s
[Step=28850 Epoch=274.4] | Loss=0.00007 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.934 | L2-Norm(final)=15.109 | 2577.9 samples/s | 40.3 steps/s
[Step=28900 Epoch=274.9] | Loss=0.00006 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.928 | L2-Norm(final)=15.110 | 5052.0 samples/s | 78.9 steps/s
[Step=28950 Epoch=275.4] | Loss=0.00005 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.922 | L2-Norm(final)=15.111 | 2725.7 samples/s | 42.6 steps/s
[Step=29000 Epoch=275.9] | Loss=0.00005 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.916 | L2-Norm(final)=15.111 | 4603.8 samples/s | 71.9 steps/s
[Step=29050 Epoch=276.3] | Loss=0.00005 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.909 | L2-Norm(final)=15.112 | 2816.8 samples/s | 44.0 steps/s
[Step=29100 Epoch=276.8] | Loss=0.00004 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.903 | L2-Norm(final)=15.113 | 4608.2 samples/s | 72.0 steps/s
[Step=29150 Epoch=277.3] | Loss=0.00004 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.896 | L2-Norm(final)=15.113 | 2849.6 samples/s | 44.5 steps/s
[Step=29200 Epoch=277.8] | Loss=0.00004 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.890 | L2-Norm(final)=15.114 | 4524.3 samples/s | 70.7 steps/s
[Step=29250 Epoch=278.2] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.883 | L2-Norm(final)=15.114 | 2887.1 samples/s | 45.1 steps/s
[Step=29300 Epoch=278.7] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.877 | L2-Norm(final)=15.115 | 4504.8 samples/s | 70.4 steps/s
[Step=29350 Epoch=279.2] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.870 | L2-Norm(final)=15.115 | 3061.0 samples/s | 47.8 steps/s
[Step=29400 Epoch=279.7] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.864 | L2-Norm(final)=15.116 | 4134.9 samples/s | 64.6 steps/s
[Step=29450 Epoch=280.1] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=15.116 | 6837.7 samples/s | 106.8 steps/s
[Step=29500 Epoch=280.6] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.850 | L2-Norm(final)=15.117 | 2342.3 samples/s | 36.6 steps/s
[Step=29550 Epoch=281.1] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.843 | L2-Norm(final)=15.117 | 6214.6 samples/s | 97.1 steps/s
[Step=29600 Epoch=281.6] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.837 | L2-Norm(final)=15.117 | 2452.7 samples/s | 38.3 steps/s
[Step=29650 Epoch=282.0] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.830 | L2-Norm(final)=15.118 | 5603.3 samples/s | 87.6 steps/s
[Step=29700 Epoch=282.5] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.823 | L2-Norm(final)=15.118 | 2591.1 samples/s | 40.5 steps/s
[Step=29750 Epoch=283.0] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.816 | L2-Norm(final)=15.119 | 5000.6 samples/s | 78.1 steps/s
[Step=29800 Epoch=283.5] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.809 | L2-Norm(final)=15.119 | 2638.6 samples/s | 41.2 steps/s
[Step=29850 Epoch=283.9] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.802 | L2-Norm(final)=15.120 | 4796.4 samples/s | 74.9 steps/s
[Step=29900 Epoch=284.4] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.795 | L2-Norm(final)=15.120 | 2785.2 samples/s | 43.5 steps/s
[Step=29950 Epoch=284.9] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.787 | L2-Norm(final)=15.120 | 4565.5 samples/s | 71.3 steps/s
[Step=30000 Epoch=285.4] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.780 | L2-Norm(final)=15.121 | 2859.1 samples/s | 44.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step30000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=30001 Epoch=286.5] | Loss=0.00005 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=14.188 | 6889.9 samples/s | 107.7 steps/s
[Step=30050 Epoch=287.0] | Loss=0.00068 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=14.194 | 4515.6 samples/s | 70.6 steps/s
[Step=30100 Epoch=287.4] | Loss=0.00060 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=14.202 | 8310.9 samples/s | 129.9 steps/s
[Step=30150 Epoch=287.9] | Loss=0.00051 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=14.208 | 2542.2 samples/s | 39.7 steps/s
[Step=30200 Epoch=288.4] | Loss=0.00058 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=14.215 | 7612.5 samples/s | 118.9 steps/s
[Step=30250 Epoch=288.9] | Loss=0.00059 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=14.222 | 2636.8 samples/s | 41.2 steps/s
[Step=30300 Epoch=289.3] | Loss=0.00058 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=14.229 | 6871.4 samples/s | 107.4 steps/s
[Step=30350 Epoch=289.8] | Loss=0.00056 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=14.235 | 2211.5 samples/s | 34.6 steps/s
[Step=30400 Epoch=290.3] | Loss=0.00059 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=14.241 | 5616.5 samples/s | 87.8 steps/s
[Step=30450 Epoch=290.8] | Loss=0.00057 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=14.248 | 2842.9 samples/s | 44.4 steps/s
[Step=30500 Epoch=291.3] | Loss=0.00057 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=14.254 | 5780.2 samples/s | 90.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=291.3] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=14.312 | 7490.9 samples/s | 117.0 steps/s
[Step=30550 Epoch=291.7] | Loss=0.00015 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=14.318 | 3925.2 samples/s | 61.3 steps/s
[Step=30600 Epoch=292.2] | Loss=0.00009 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=14.321 | 6557.6 samples/s | 102.5 steps/s
[Step=30650 Epoch=292.7] | Loss=0.00007 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.937 | L2-Norm(final)=14.323 | 2396.1 samples/s | 37.4 steps/s
[Step=30700 Epoch=293.2] | Loss=0.00005 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.924 | L2-Norm(final)=14.324 | 5966.2 samples/s | 93.2 steps/s
[Step=30750 Epoch=293.6] | Loss=0.00004 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.912 | L2-Norm(final)=14.325 | 2435.9 samples/s | 38.1 steps/s
[Step=30800 Epoch=294.1] | Loss=0.00003 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.899 | L2-Norm(final)=14.325 | 5665.6 samples/s | 88.5 steps/s
[Step=30850 Epoch=294.6] | Loss=0.00003 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.887 | L2-Norm(final)=14.326 | 2540.6 samples/s | 39.7 steps/s
[Step=30900 Epoch=295.1] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.874 | L2-Norm(final)=14.326 | 5255.7 samples/s | 82.1 steps/s
[Step=30950 Epoch=295.6] | Loss=0.00002 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.862 | L2-Norm(final)=14.327 | 2619.7 samples/s | 40.9 steps/s
[Step=31000 Epoch=296.0] | Loss=0.00002 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.849 | L2-Norm(final)=14.327 | 4943.4 samples/s | 77.2 steps/s
[Step=31050 Epoch=296.5] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.837 | L2-Norm(final)=14.328 | 2727.1 samples/s | 42.6 steps/s
[Step=31100 Epoch=297.0] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.825 | L2-Norm(final)=14.328 | 4598.5 samples/s | 71.9 steps/s
[Step=31150 Epoch=297.5] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.813 | L2-Norm(final)=14.328 | 2825.7 samples/s | 44.2 steps/s
[Step=31200 Epoch=297.9] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.800 | L2-Norm(final)=14.329 | 4486.4 samples/s | 70.1 steps/s
[Step=31250 Epoch=298.4] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.788 | L2-Norm(final)=14.329 | 2814.7 samples/s | 44.0 steps/s
[Step=31300 Epoch=298.9] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.776 | L2-Norm(final)=14.329 | 4606.5 samples/s | 72.0 steps/s
[Step=31350 Epoch=299.4] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.764 | L2-Norm(final)=14.330 | 2816.9 samples/s | 44.0 steps/s
[Step=31400 Epoch=299.9] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.752 | L2-Norm(final)=14.330 | 4680.0 samples/s | 73.1 steps/s
[Step=31450 Epoch=300.3] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.739 | L2-Norm(final)=14.330 | 2823.6 samples/s | 44.1 steps/s
[Step=31500 Epoch=300.8] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.727 | L2-Norm(final)=14.330 | 4540.5 samples/s | 70.9 steps/s
[Step=31550 Epoch=301.3] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.715 | L2-Norm(final)=14.331 | 7237.4 samples/s | 113.1 steps/s
[Step=31600 Epoch=301.8] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.703 | L2-Norm(final)=14.331 | 2325.7 samples/s | 36.3 steps/s
[Step=31650 Epoch=302.2] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.690 | L2-Norm(final)=14.331 | 6554.7 samples/s | 102.4 steps/s
[Step=31700 Epoch=302.7] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.678 | L2-Norm(final)=14.332 | 2376.5 samples/s | 37.1 steps/s
[Step=31750 Epoch=303.2] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.666 | L2-Norm(final)=14.332 | 6076.2 samples/s | 94.9 steps/s
[Step=31800 Epoch=303.7] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.653 | L2-Norm(final)=14.332 | 2473.4 samples/s | 38.6 steps/s
[Step=31850 Epoch=304.1] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.641 | L2-Norm(final)=14.333 | 5583.4 samples/s | 87.2 steps/s
[Step=31900 Epoch=304.6] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.628 | L2-Norm(final)=14.333 | 2531.9 samples/s | 39.6 steps/s
[Step=31950 Epoch=305.1] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.616 | L2-Norm(final)=14.333 | 5248.9 samples/s | 82.0 steps/s
[Step=32000 Epoch=305.6] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.603 | L2-Norm(final)=14.333 | 2605.6 samples/s | 40.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step32000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=30001 Epoch=282.7] | Loss=0.00045 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=15.198 | 6140.4 samples/s | 95.9 steps/s
[Step=30050 Epoch=283.2] | Loss=0.00073 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=15.202 | 4939.4 samples/s | 77.2 steps/s
[Step=30100 Epoch=283.6] | Loss=0.00096 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=15.207 | 8106.6 samples/s | 126.7 steps/s
[Step=30150 Epoch=284.1] | Loss=0.00099 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=15.213 | 2579.1 samples/s | 40.3 steps/s
[Step=30200 Epoch=284.6] | Loss=0.00092 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=15.218 | 7099.1 samples/s | 110.9 steps/s
[Step=30250 Epoch=285.0] | Loss=0.00091 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=15.223 | 2714.6 samples/s | 42.4 steps/s
[Step=30300 Epoch=285.5] | Loss=0.00087 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=15.229 | 6254.4 samples/s | 97.7 steps/s
[Step=30350 Epoch=286.0] | Loss=0.00094 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=15.234 | 2835.1 samples/s | 44.3 steps/s
[Step=30400 Epoch=286.5] | Loss=0.00093 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=15.239 | 5592.4 samples/s | 87.4 steps/s
[Step=30450 Epoch=286.9] | Loss=0.00089 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=15.244 | 3014.7 samples/s | 47.1 steps/s
[Step=30500 Epoch=287.4] | Loss=0.00089 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=15.250 | 5336.4 samples/s | 83.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=287.4] | Loss=0.00045 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=15.302 | 7098.8 samples/s | 110.9 steps/s
[Step=30550 Epoch=287.9] | Loss=0.00037 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.958 | L2-Norm(final)=15.306 | 3990.8 samples/s | 62.4 steps/s
[Step=30600 Epoch=288.3] | Loss=0.00022 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=15.309 | 6541.8 samples/s | 102.2 steps/s
[Step=30650 Epoch=288.8] | Loss=0.00019 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=15.311 | 2391.4 samples/s | 37.4 steps/s
[Step=30700 Epoch=289.3] | Loss=0.00015 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=15.313 | 5797.8 samples/s | 90.6 steps/s
[Step=30750 Epoch=289.8] | Loss=0.00012 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=15.314 | 2508.1 samples/s | 39.2 steps/s
[Step=30800 Epoch=290.2] | Loss=0.00010 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.944 | L2-Norm(final)=15.315 | 5235.0 samples/s | 81.8 steps/s
[Step=30850 Epoch=290.7] | Loss=0.00009 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.939 | L2-Norm(final)=15.316 | 2644.0 samples/s | 41.3 steps/s
[Step=30900 Epoch=291.2] | Loss=0.00008 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.934 | L2-Norm(final)=15.317 | 4829.3 samples/s | 75.5 steps/s
[Step=30950 Epoch=291.6] | Loss=0.00007 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.929 | L2-Norm(final)=15.317 | 2748.0 samples/s | 42.9 steps/s
[Step=31000 Epoch=292.1] | Loss=0.00007 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.924 | L2-Norm(final)=15.318 | 4482.5 samples/s | 70.0 steps/s
[Step=31050 Epoch=292.6] | Loss=0.00006 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.919 | L2-Norm(final)=15.318 | 2908.0 samples/s | 45.4 steps/s
[Step=31100 Epoch=293.1] | Loss=0.00006 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.913 | L2-Norm(final)=15.319 | 4459.8 samples/s | 69.7 steps/s
[Step=31150 Epoch=293.5] | Loss=0.00005 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.908 | L2-Norm(final)=15.319 | 2861.0 samples/s | 44.7 steps/s
[Step=31200 Epoch=294.0] | Loss=0.00005 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.903 | L2-Norm(final)=15.320 | 4564.5 samples/s | 71.3 steps/s
[Step=31250 Epoch=294.5] | Loss=0.00005 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.897 | L2-Norm(final)=15.320 | 3037.8 samples/s | 47.5 steps/s
[Step=31300 Epoch=294.9] | Loss=0.00004 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.892 | L2-Norm(final)=15.321 | 4142.7 samples/s | 64.7 steps/s
[Step=31350 Epoch=295.4] | Loss=0.00004 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.887 | L2-Norm(final)=15.321 | 6595.2 samples/s | 103.1 steps/s
[Step=31400 Epoch=295.9] | Loss=0.00004 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=15.322 | 2401.4 samples/s | 37.5 steps/s
[Step=31450 Epoch=296.3] | Loss=0.00004 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.876 | L2-Norm(final)=15.322 | 5785.9 samples/s | 90.4 steps/s
[Step=31500 Epoch=296.8] | Loss=0.00004 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.870 | L2-Norm(final)=15.322 | 2501.7 samples/s | 39.1 steps/s
[Step=31550 Epoch=297.3] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.865 | L2-Norm(final)=15.323 | 5308.3 samples/s | 82.9 steps/s
[Step=31600 Epoch=297.8] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.859 | L2-Norm(final)=15.323 | 2649.9 samples/s | 41.4 steps/s
[Step=31650 Epoch=298.2] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.853 | L2-Norm(final)=15.323 | 4767.3 samples/s | 74.5 steps/s
[Step=31700 Epoch=298.7] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.848 | L2-Norm(final)=15.324 | 2774.0 samples/s | 43.3 steps/s
[Step=31750 Epoch=299.2] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.842 | L2-Norm(final)=15.324 | 4475.2 samples/s | 69.9 steps/s
[Step=31800 Epoch=299.6] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.836 | L2-Norm(final)=15.325 | 2895.2 samples/s | 45.2 steps/s
[Step=31850 Epoch=300.1] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.830 | L2-Norm(final)=15.325 | 4405.0 samples/s | 68.8 steps/s
[Step=31900 Epoch=300.6] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.824 | L2-Norm(final)=15.325 | 2866.9 samples/s | 44.8 steps/s
[Step=31950 Epoch=301.1] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.818 | L2-Norm(final)=15.326 | 4590.4 samples/s | 71.7 steps/s
[Step=32000 Epoch=301.5] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.812 | L2-Norm(final)=15.326 | 2871.3 samples/s | 44.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step32000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=324.1] | Loss=0.00232 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=16.146 | 6059.2 samples/s | 94.7 steps/s
[Step=34050 Epoch=324.5] | Loss=0.00167 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=16.155 | 4746.2 samples/s | 74.2 steps/s
[Step=34100 Epoch=325.0] | Loss=0.00142 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=16.164 | 8416.5 samples/s | 131.5 steps/s
[Step=34150 Epoch=325.5] | Loss=0.00130 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=16.174 | 2570.4 samples/s | 40.2 steps/s
[Step=34200 Epoch=326.0] | Loss=0.00134 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=16.183 | 7477.5 samples/s | 116.8 steps/s
[Step=34250 Epoch=326.4] | Loss=0.00131 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=16.192 | 2658.6 samples/s | 41.5 steps/s
[Step=34300 Epoch=326.9] | Loss=0.00135 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=16.200 | 6792.9 samples/s | 106.1 steps/s
[Step=34350 Epoch=327.4] | Loss=0.00130 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=16.208 | 2754.5 samples/s | 43.0 steps/s
[Step=34400 Epoch=327.9] | Loss=0.00131 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=16.217 | 6149.6 samples/s | 96.1 steps/s
[Step=34450 Epoch=328.3] | Loss=0.00131 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=16.225 | 2831.3 samples/s | 44.2 steps/s
[Step=34500 Epoch=328.8] | Loss=0.00134 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=16.233 | 5817.1 samples/s | 90.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=328.8] | Loss=0.00085 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=16.313 | 6820.7 samples/s | 106.6 steps/s
[Step=34550 Epoch=329.3] | Loss=0.00089 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.970 | L2-Norm(final)=16.314 | 4072.7 samples/s | 63.6 steps/s
[Step=34600 Epoch=329.8] | Loss=0.00048 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.972 | L2-Norm(final)=16.315 | 6728.3 samples/s | 105.1 steps/s
[Step=34650 Epoch=330.2] | Loss=0.00033 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.968 | L2-Norm(final)=16.316 | 2372.4 samples/s | 37.1 steps/s
[Step=34700 Epoch=330.7] | Loss=0.00025 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=16.317 | 6127.4 samples/s | 95.7 steps/s
[Step=34750 Epoch=331.2] | Loss=0.00020 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=16.317 | 2449.4 samples/s | 38.3 steps/s
[Step=34800 Epoch=331.7] | Loss=0.00017 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.950 | L2-Norm(final)=16.318 | 5651.4 samples/s | 88.3 steps/s
[Step=34850 Epoch=332.2] | Loss=0.00015 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.943 | L2-Norm(final)=16.318 | 2554.9 samples/s | 39.9 steps/s
[Step=34900 Epoch=332.6] | Loss=0.00013 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.936 | L2-Norm(final)=16.318 | 5193.7 samples/s | 81.2 steps/s
[Step=34950 Epoch=333.1] | Loss=0.00012 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.928 | L2-Norm(final)=16.319 | 2596.6 samples/s | 40.6 steps/s
[Step=35000 Epoch=333.6] | Loss=0.00011 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.921 | L2-Norm(final)=16.319 | 4929.2 samples/s | 77.0 steps/s
[Step=35050 Epoch=334.1] | Loss=0.00010 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.914 | L2-Norm(final)=16.319 | 2709.0 samples/s | 42.3 steps/s
[Step=35100 Epoch=334.5] | Loss=0.00009 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.906 | L2-Norm(final)=16.320 | 4635.1 samples/s | 72.4 steps/s
[Step=35150 Epoch=335.0] | Loss=0.00008 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.899 | L2-Norm(final)=16.320 | 2810.2 samples/s | 43.9 steps/s
[Step=35200 Epoch=335.5] | Loss=0.00008 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.891 | L2-Norm(final)=16.320 | 4498.5 samples/s | 70.3 steps/s
[Step=35250 Epoch=336.0] | Loss=0.00007 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.883 | L2-Norm(final)=16.320 | 2823.9 samples/s | 44.1 steps/s
[Step=35300 Epoch=336.4] | Loss=0.00007 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.876 | L2-Norm(final)=16.321 | 4587.2 samples/s | 71.7 steps/s
[Step=35350 Epoch=336.9] | Loss=0.00006 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.868 | L2-Norm(final)=16.321 | 2838.3 samples/s | 44.3 steps/s
[Step=35400 Epoch=337.4] | Loss=0.00006 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.860 | L2-Norm(final)=16.321 | 4548.3 samples/s | 71.1 steps/s
[Step=35450 Epoch=337.9] | Loss=0.00006 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.853 | L2-Norm(final)=16.321 | 2854.1 samples/s | 44.6 steps/s
[Step=35500 Epoch=338.3] | Loss=0.00006 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.845 | L2-Norm(final)=16.322 | 4493.3 samples/s | 70.2 steps/s
[Step=35550 Epoch=338.8] | Loss=0.00005 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.837 | L2-Norm(final)=16.322 | 7318.3 samples/s | 114.3 steps/s
[Step=35600 Epoch=339.3] | Loss=0.00005 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.829 | L2-Norm(final)=16.322 | 2303.1 samples/s | 36.0 steps/s
[Step=35650 Epoch=339.8] | Loss=0.00005 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.821 | L2-Norm(final)=16.322 | 6622.3 samples/s | 103.5 steps/s
[Step=35700 Epoch=340.3] | Loss=0.00005 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.813 | L2-Norm(final)=16.323 | 2380.9 samples/s | 37.2 steps/s
[Step=35750 Epoch=340.7] | Loss=0.00004 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.805 | L2-Norm(final)=16.323 | 6041.8 samples/s | 94.4 steps/s
[Step=35800 Epoch=341.2] | Loss=0.00004 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.797 | L2-Norm(final)=16.323 | 2451.3 samples/s | 38.3 steps/s
[Step=35850 Epoch=341.7] | Loss=0.00004 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.789 | L2-Norm(final)=16.323 | 5653.1 samples/s | 88.3 steps/s
[Step=35900 Epoch=342.2] | Loss=0.00004 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.781 | L2-Norm(final)=16.324 | 2538.9 samples/s | 39.7 steps/s
[Step=35950 Epoch=342.6] | Loss=0.00004 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.773 | L2-Norm(final)=16.324 | 5205.6 samples/s | 81.3 steps/s
[Step=36000 Epoch=343.1] | Loss=0.00004 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.764 | L2-Norm(final)=16.324 | 2643.0 samples/s | 41.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09866 | acc=0.9594 | tpr=0.9813 | fpr=0.0882 | 5789.6 samples/s | 22.6 steps/s
Avg test loss: 0.10521, Avg test acc: 0.95745, Avg tpr: 0.97884, Avg fpr: 0.08960, total FA: 699

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09276 | acc=0.9626 | tpr=0.9779 | fpr=0.0706 | 6040.7 samples/s | 23.6 steps/s
Avg test loss: 0.09733, Avg test acc: 0.96057, Avg tpr: 0.97593, Avg fpr: 0.07320, total FA: 571

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.12292 | acc=0.9564 | tpr=0.9846 | fpr=0.1048 | 5977.7 samples/s | 23.4 steps/s
Avg test loss: 0.12358, Avg test acc: 0.95504, Avg tpr: 0.98246, Avg fpr: 0.10524, total FA: 821

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10222 | acc=0.9585 | tpr=0.9736 | fpr=0.0743 | 6169.8 samples/s | 24.1 steps/s
Avg test loss: 0.10737, Avg test acc: 0.95753, Avg tpr: 0.97342, Avg fpr: 0.07743, total FA: 604

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10597 | acc=0.9583 | tpr=0.9766 | fpr=0.0815 | 6110.5 samples/s | 23.9 steps/s
Avg test loss: 0.10876, Avg test acc: 0.95757, Avg tpr: 0.97459, Avg fpr: 0.07986, total FA: 623

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.86810 | acc=0.2933 | tpr=0.0178 | fpr=0.1085 | 6006.7 samples/s | 23.5 steps/s
Avg test loss: 6.87030, Avg test acc: 0.29109, Avg tpr: 0.01644, Avg fpr: 0.10486, total FA: 818

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.68716 | acc=0.3028 | tpr=0.0319 | fpr=0.1090 | 5814.9 samples/s | 22.7 steps/s
Avg test loss: 4.69643, Avg test acc: 0.30046, Avg tpr: 0.03077, Avg fpr: 0.10640, total FA: 830

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.01280 | acc=0.2854 | tpr=0.0244 | fpr=0.1479 | 5876.7 samples/s | 23.0 steps/s
Avg test loss: 5.02175, Avg test acc: 0.28480, Avg tpr: 0.02343, Avg fpr: 0.14037, total FA: 1095

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.18498 | acc=0.2693 | tpr=0.0290 | fpr=0.2089 | 6017.7 samples/s | 23.5 steps/s
Avg test loss: 5.18330, Avg test acc: 0.26857, Avg tpr: 0.02739, Avg fpr: 0.20100, total FA: 1568

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.09700 | acc=0.2890 | tpr=0.0187 | fpr=0.1241 | 5977.4 samples/s | 23.3 steps/s
Avg test loss: 5.11268, Avg test acc: 0.28812, Avg tpr: 0.01842, Avg fpr: 0.11870, total FA: 926

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.07631 | acc=0.1123 | tpr=0.6681 | fpr=0.8977 | 6006.4 samples/s | 23.5 steps/s
[Step= 100] | Loss=6.05396 | acc=0.1137 | tpr=0.6525 | fpr=0.8964 | 7930.7 samples/s | 31.0 steps/s
[Step= 150] | Loss=6.04692 | acc=0.1163 | tpr=0.6744 | fpr=0.8940 | 7563.4 samples/s | 29.5 steps/s
[Step= 200] | Loss=6.03708 | acc=0.1163 | tpr=0.6678 | fpr=0.8938 | 7989.9 samples/s | 31.2 steps/s
[Step= 250] | Loss=6.04044 | acc=0.1162 | tpr=0.6638 | fpr=0.8938 | 8157.9 samples/s | 31.9 steps/s
[Step= 300] | Loss=6.03125 | acc=0.1167 | tpr=0.6604 | fpr=0.8932 | 8358.0 samples/s | 32.6 steps/s
[Step= 350] | Loss=6.03773 | acc=0.1168 | tpr=0.6625 | fpr=0.8931 | 8075.0 samples/s | 31.5 steps/s
[Step= 400] | Loss=6.03365 | acc=0.1168 | tpr=0.6581 | fpr=0.8930 | 8706.1 samples/s | 34.0 steps/s
[Step= 450] | Loss=6.03888 | acc=0.1163 | tpr=0.6597 | fpr=0.8936 | 7695.6 samples/s | 30.1 steps/s
[Step= 500] | Loss=6.03940 | acc=0.1163 | tpr=0.6639 | fpr=0.8935 | 8072.0 samples/s | 31.5 steps/s
[Step= 550] | Loss=6.04112 | acc=0.1166 | tpr=0.6681 | fpr=0.8934 | 9474.3 samples/s | 37.0 steps/s
Avg test loss: 6.04146, Avg test acc: 0.11651, Avg tpr: 0.66878, Avg fpr: 0.89353, total FA: 124065

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.32694 | acc=0.1364 | tpr=0.6195 | fpr=0.8723 | 5862.5 samples/s | 22.9 steps/s
[Step= 100] | Loss=5.31139 | acc=0.1394 | tpr=0.6119 | fpr=0.8694 | 7988.6 samples/s | 31.2 steps/s
[Step= 150] | Loss=5.30247 | acc=0.1415 | tpr=0.6326 | fpr=0.8676 | 7176.4 samples/s | 28.0 steps/s
[Step= 200] | Loss=5.29540 | acc=0.1416 | tpr=0.6240 | fpr=0.8671 | 7991.4 samples/s | 31.2 steps/s
[Step= 250] | Loss=5.29993 | acc=0.1417 | tpr=0.6227 | fpr=0.8671 | 8370.7 samples/s | 32.7 steps/s
[Step= 300] | Loss=5.29520 | acc=0.1413 | tpr=0.6131 | fpr=0.8673 | 8195.4 samples/s | 32.0 steps/s
[Step= 350] | Loss=5.30112 | acc=0.1411 | tpr=0.6099 | fpr=0.8674 | 8188.4 samples/s | 32.0 steps/s
[Step= 400] | Loss=5.29856 | acc=0.1412 | tpr=0.6111 | fpr=0.8673 | 8118.9 samples/s | 31.7 steps/s
[Step= 450] | Loss=5.30202 | acc=0.1406 | tpr=0.6164 | fpr=0.8680 | 8135.9 samples/s | 31.8 steps/s
[Step= 500] | Loss=5.30245 | acc=0.1405 | tpr=0.6211 | fpr=0.8681 | 8278.7 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.30640 | acc=0.1407 | tpr=0.6224 | fpr=0.8681 | 10775.5 samples/s | 42.1 steps/s
Avg test loss: 5.30677, Avg test acc: 0.14054, Avg tpr: 0.62282, Avg fpr: 0.86822, total FA: 120551

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.14906 | acc=0.1079 | tpr=0.7257 | fpr=0.9032 | 5895.1 samples/s | 23.0 steps/s
[Step= 100] | Loss=6.13469 | acc=0.1092 | tpr=0.7164 | fpr=0.9022 | 7811.0 samples/s | 30.5 steps/s
[Step= 150] | Loss=6.12805 | acc=0.1106 | tpr=0.7133 | fpr=0.9005 | 7853.1 samples/s | 30.7 steps/s
[Step= 200] | Loss=6.12325 | acc=0.1105 | tpr=0.7016 | fpr=0.9002 | 7951.3 samples/s | 31.1 steps/s
[Step= 250] | Loss=6.12814 | acc=0.1110 | tpr=0.7022 | fpr=0.8997 | 8067.0 samples/s | 31.5 steps/s
[Step= 300] | Loss=6.12392 | acc=0.1107 | tpr=0.6953 | fpr=0.8999 | 8445.9 samples/s | 33.0 steps/s
[Step= 350] | Loss=6.13102 | acc=0.1107 | tpr=0.7007 | fpr=0.9000 | 8082.6 samples/s | 31.6 steps/s
[Step= 400] | Loss=6.12959 | acc=0.1106 | tpr=0.7019 | fpr=0.9002 | 8140.4 samples/s | 31.8 steps/s
[Step= 450] | Loss=6.13525 | acc=0.1099 | tpr=0.7030 | fpr=0.9009 | 8191.6 samples/s | 32.0 steps/s
[Step= 500] | Loss=6.13533 | acc=0.1098 | tpr=0.7040 | fpr=0.9009 | 8011.9 samples/s | 31.3 steps/s
[Step= 550] | Loss=6.14065 | acc=0.1100 | tpr=0.7059 | fpr=0.9008 | 9882.7 samples/s | 38.6 steps/s
Avg test loss: 6.14106, Avg test acc: 0.10997, Avg tpr: 0.70721, Avg fpr: 0.90089, total FA: 125087

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.77950 | acc=0.1355 | tpr=0.6814 | fpr=0.8743 | 6121.1 samples/s | 23.9 steps/s
[Step= 100] | Loss=5.76258 | acc=0.1379 | tpr=0.6588 | fpr=0.8718 | 8059.1 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.74797 | acc=0.1395 | tpr=0.6700 | fpr=0.8703 | 7839.6 samples/s | 30.6 steps/s
[Step= 200] | Loss=5.73847 | acc=0.1398 | tpr=0.6634 | fpr=0.8697 | 7530.2 samples/s | 29.4 steps/s
[Step= 250] | Loss=5.74136 | acc=0.1396 | tpr=0.6594 | fpr=0.8698 | 7736.7 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.73557 | acc=0.1390 | tpr=0.6567 | fpr=0.8705 | 8656.7 samples/s | 33.8 steps/s
[Step= 350] | Loss=5.74135 | acc=0.1389 | tpr=0.6562 | fpr=0.8704 | 7863.3 samples/s | 30.7 steps/s
[Step= 400] | Loss=5.73827 | acc=0.1395 | tpr=0.6565 | fpr=0.8699 | 8489.5 samples/s | 33.2 steps/s
[Step= 450] | Loss=5.74342 | acc=0.1386 | tpr=0.6573 | fpr=0.8708 | 7718.8 samples/s | 30.2 steps/s
[Step= 500] | Loss=5.74306 | acc=0.1387 | tpr=0.6604 | fpr=0.8707 | 8313.6 samples/s | 32.5 steps/s
[Step= 550] | Loss=5.74917 | acc=0.1388 | tpr=0.6614 | fpr=0.8707 | 10038.7 samples/s | 39.2 steps/s
Avg test loss: 5.75013, Avg test acc: 0.13873, Avg tpr: 0.66165, Avg fpr: 0.87077, total FA: 120905

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.75668 | acc=0.1354 | tpr=0.6018 | fpr=0.8730 | 6093.5 samples/s | 23.8 steps/s
[Step= 100] | Loss=5.75036 | acc=0.1381 | tpr=0.5928 | fpr=0.8704 | 7584.0 samples/s | 29.6 steps/s
[Step= 150] | Loss=5.73899 | acc=0.1390 | tpr=0.6023 | fpr=0.8695 | 8005.9 samples/s | 31.3 steps/s
[Step= 200] | Loss=5.73508 | acc=0.1390 | tpr=0.6055 | fpr=0.8694 | 8084.8 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.73740 | acc=0.1389 | tpr=0.5886 | fpr=0.8693 | 8111.3 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.73275 | acc=0.1390 | tpr=0.5862 | fpr=0.8692 | 8020.0 samples/s | 31.3 steps/s
[Step= 350] | Loss=5.74147 | acc=0.1388 | tpr=0.5786 | fpr=0.8692 | 7490.5 samples/s | 29.3 steps/s
[Step= 400] | Loss=5.73821 | acc=0.1390 | tpr=0.5793 | fpr=0.8690 | 8134.2 samples/s | 31.8 steps/s
[Step= 450] | Loss=5.74381 | acc=0.1384 | tpr=0.5823 | fpr=0.8696 | 8083.3 samples/s | 31.6 steps/s
[Step= 500] | Loss=5.74264 | acc=0.1384 | tpr=0.5841 | fpr=0.8696 | 7978.8 samples/s | 31.2 steps/s
[Step= 550] | Loss=5.74651 | acc=0.1384 | tpr=0.5822 | fpr=0.8696 | 10671.5 samples/s | 41.7 steps/s
Avg test loss: 5.74784, Avg test acc: 0.13837, Avg tpr: 0.58281, Avg fpr: 0.86971, total FA: 120758

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.23159 | acc=0.9603 | tpr=0.9159 | fpr=0.0389 | 5713.8 samples/s | 22.3 steps/s
[Step= 100] | Loss=0.23839 | acc=0.9587 | tpr=0.9360 | fpr=0.0409 | 8289.4 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.24337 | acc=0.9576 | tpr=0.9366 | fpr=0.0421 | 8039.5 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.24244 | acc=0.9569 | tpr=0.9410 | fpr=0.0428 | 7813.9 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.24226 | acc=0.9566 | tpr=0.9336 | fpr=0.0430 | 7686.2 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.24536 | acc=0.9563 | tpr=0.9316 | fpr=0.0433 | 8380.9 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.24507 | acc=0.9561 | tpr=0.9324 | fpr=0.0435 | 7466.4 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.24447 | acc=0.9560 | tpr=0.9305 | fpr=0.0436 | 7957.0 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.24898 | acc=0.9555 | tpr=0.9279 | fpr=0.0440 | 8141.0 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.24833 | acc=0.9553 | tpr=0.9291 | fpr=0.0442 | 8019.3 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.24701 | acc=0.9556 | tpr=0.9280 | fpr=0.0439 | 11505.9 samples/s | 44.9 steps/s
Avg test loss: 0.24674, Avg test acc: 0.95565, Avg tpr: 0.92789, Avg fpr: 0.04385, total FA: 6088

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.18138 | acc=0.9611 | tpr=0.9248 | fpr=0.0383 | 6150.8 samples/s | 24.0 steps/s
[Step= 100] | Loss=0.18879 | acc=0.9595 | tpr=0.9318 | fpr=0.0400 | 7898.0 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.19150 | acc=0.9579 | tpr=0.9308 | fpr=0.0416 | 8257.7 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.19195 | acc=0.9580 | tpr=0.9366 | fpr=0.0416 | 7156.9 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.19159 | acc=0.9580 | tpr=0.9371 | fpr=0.0417 | 8616.8 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.19487 | acc=0.9576 | tpr=0.9353 | fpr=0.0420 | 8620.2 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.19346 | acc=0.9577 | tpr=0.9355 | fpr=0.0419 | 7448.2 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.19413 | acc=0.9573 | tpr=0.9327 | fpr=0.0422 | 8473.5 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.19750 | acc=0.9569 | tpr=0.9328 | fpr=0.0427 | 8258.6 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.19707 | acc=0.9567 | tpr=0.9348 | fpr=0.0429 | 8018.1 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.19579 | acc=0.9570 | tpr=0.9351 | fpr=0.0426 | 9385.9 samples/s | 36.7 steps/s
Avg test loss: 0.19555, Avg test acc: 0.95702, Avg tpr: 0.93502, Avg fpr: 0.04258, total FA: 5912

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26324 | acc=0.9509 | tpr=0.9558 | fpr=0.0492 | 5993.7 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.27120 | acc=0.9499 | tpr=0.9595 | fpr=0.0503 | 8203.4 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.27608 | acc=0.9485 | tpr=0.9625 | fpr=0.0517 | 7904.7 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.27566 | acc=0.9487 | tpr=0.9650 | fpr=0.0516 | 7434.7 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.27554 | acc=0.9485 | tpr=0.9642 | fpr=0.0518 | 8171.4 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.27891 | acc=0.9481 | tpr=0.9615 | fpr=0.0521 | 8241.9 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.27690 | acc=0.9481 | tpr=0.9606 | fpr=0.0521 | 8256.9 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.27743 | acc=0.9478 | tpr=0.9568 | fpr=0.0524 | 8281.4 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.28118 | acc=0.9473 | tpr=0.9542 | fpr=0.0528 | 7985.1 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.28155 | acc=0.9472 | tpr=0.9551 | fpr=0.0529 | 7674.5 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.27979 | acc=0.9475 | tpr=0.9554 | fpr=0.0527 | 10078.3 samples/s | 39.4 steps/s
Avg test loss: 0.27948, Avg test acc: 0.94749, Avg tpr: 0.95523, Avg fpr: 0.05265, total FA: 7311

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14962 | acc=0.9655 | tpr=0.9292 | fpr=0.0339 | 5887.8 samples/s | 23.0 steps/s
[Step= 100] | Loss=0.15530 | acc=0.9646 | tpr=0.9424 | fpr=0.0350 | 8378.8 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.15626 | acc=0.9629 | tpr=0.9438 | fpr=0.0368 | 7887.3 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.15585 | acc=0.9629 | tpr=0.9464 | fpr=0.0368 | 7786.2 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.15566 | acc=0.9628 | tpr=0.9467 | fpr=0.0369 | 7573.4 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.15865 | acc=0.9624 | tpr=0.9455 | fpr=0.0373 | 7745.9 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.15757 | acc=0.9624 | tpr=0.9430 | fpr=0.0372 | 8188.8 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.15771 | acc=0.9620 | tpr=0.9409 | fpr=0.0376 | 8156.0 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.16036 | acc=0.9615 | tpr=0.9401 | fpr=0.0381 | 8658.1 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.16003 | acc=0.9615 | tpr=0.9419 | fpr=0.0382 | 7937.1 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.15906 | acc=0.9616 | tpr=0.9423 | fpr=0.0380 | 10045.8 samples/s | 39.2 steps/s
Avg test loss: 0.15878, Avg test acc: 0.96163, Avg tpr: 0.94216, Avg fpr: 0.03801, total FA: 5278

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.23128 | acc=0.9577 | tpr=0.9381 | fpr=0.0419 | 6062.6 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.24061 | acc=0.9563 | tpr=0.9510 | fpr=0.0436 | 7481.2 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.24389 | acc=0.9546 | tpr=0.9568 | fpr=0.0455 | 7450.6 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.24450 | acc=0.9545 | tpr=0.9585 | fpr=0.0456 | 8420.5 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.24545 | acc=0.9543 | tpr=0.9563 | fpr=0.0458 | 7955.4 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.24912 | acc=0.9538 | tpr=0.9535 | fpr=0.0462 | 7982.6 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.24794 | acc=0.9537 | tpr=0.9530 | fpr=0.0462 | 8117.4 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.24821 | acc=0.9534 | tpr=0.9480 | fpr=0.0465 | 7489.3 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.25223 | acc=0.9530 | tpr=0.9464 | fpr=0.0469 | 8466.4 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.25217 | acc=0.9528 | tpr=0.9463 | fpr=0.0471 | 8702.5 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.25054 | acc=0.9531 | tpr=0.9471 | fpr=0.0467 | 10296.3 samples/s | 40.2 steps/s
Avg test loss: 0.25024, Avg test acc: 0.95317, Avg tpr: 0.94691, Avg fpr: 0.04672, total FA: 6487

server round 31/50

clients selected: [0 1 2 4 5]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=26001 Epoch=126.8] | Loss=0.03132 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.880 | L2-Norm(final)=12.014 | 7512.1 samples/s | 117.4 steps/s
[Step=26050 Epoch=127.0] | Loss=0.02966 | Reg=0.00118 | acc=0.9531 | L2-Norm=10.881 | L2-Norm(final)=12.013 | 4802.5 samples/s | 75.0 steps/s
[Step=26100 Epoch=127.3] | Loss=0.02664 | Reg=0.00118 | acc=0.9531 | L2-Norm=10.881 | L2-Norm(final)=12.011 | 5798.8 samples/s | 90.6 steps/s
[Step=26150 Epoch=127.5] | Loss=0.02471 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=12.012 | 5292.2 samples/s | 82.7 steps/s
[Step=26200 Epoch=127.8] | Loss=0.02579 | Reg=0.00118 | acc=0.9531 | L2-Norm=10.881 | L2-Norm(final)=12.012 | 8646.1 samples/s | 135.1 steps/s
[Step=26250 Epoch=128.0] | Loss=0.02534 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.881 | L2-Norm(final)=12.013 | 2686.2 samples/s | 42.0 steps/s
[Step=26300 Epoch=128.2] | Loss=0.02553 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.881 | L2-Norm(final)=12.012 | 5657.9 samples/s | 88.4 steps/s
[Step=26350 Epoch=128.5] | Loss=0.02528 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=12.013 | 5359.5 samples/s | 83.7 steps/s
[Step=26400 Epoch=128.7] | Loss=0.02489 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=12.013 | 7660.9 samples/s | 119.7 steps/s
[Step=26450 Epoch=129.0] | Loss=0.02506 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=12.013 | 2799.5 samples/s | 43.7 steps/s
[Step=26500 Epoch=129.2] | Loss=0.02473 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=12.014 | 5485.9 samples/s | 85.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=26501 Epoch=129.2] | Loss=0.00788 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=12.018 | 7119.9 samples/s | 111.2 steps/s
[Step=26550 Epoch=129.5] | Loss=0.02365 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.894 | L2-Norm(final)=12.017 | 4356.4 samples/s | 68.1 steps/s
[Step=26600 Epoch=129.7] | Loss=0.02132 | Reg=0.00119 | acc=0.9688 | L2-Norm=10.911 | L2-Norm(final)=12.018 | 4709.4 samples/s | 73.6 steps/s
[Step=26650 Epoch=130.0] | Loss=0.01966 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.925 | L2-Norm(final)=12.020 | 4729.6 samples/s | 73.9 steps/s
[Step=26700 Epoch=130.2] | Loss=0.01895 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.937 | L2-Norm(final)=12.022 | 6855.1 samples/s | 107.1 steps/s
[Step=26750 Epoch=130.4] | Loss=0.01643 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.947 | L2-Norm(final)=12.025 | 2487.1 samples/s | 38.9 steps/s
[Step=26800 Epoch=130.7] | Loss=0.01460 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=12.029 | 4828.3 samples/s | 75.4 steps/s
[Step=26850 Epoch=130.9] | Loss=0.01338 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.964 | L2-Norm(final)=12.033 | 4774.3 samples/s | 74.6 steps/s
[Step=26900 Epoch=131.2] | Loss=0.01248 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.971 | L2-Norm(final)=12.037 | 6098.3 samples/s | 95.3 steps/s
[Step=26950 Epoch=131.4] | Loss=0.01172 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.977 | L2-Norm(final)=12.040 | 2558.4 samples/s | 40.0 steps/s
[Step=27000 Epoch=131.7] | Loss=0.01111 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.983 | L2-Norm(final)=12.044 | 4805.8 samples/s | 75.1 steps/s
[Step=27050 Epoch=131.9] | Loss=0.01047 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.989 | L2-Norm(final)=12.047 | 4739.6 samples/s | 74.1 steps/s
[Step=27100 Epoch=132.1] | Loss=0.00988 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.994 | L2-Norm(final)=12.051 | 5701.1 samples/s | 89.1 steps/s
[Step=27150 Epoch=132.4] | Loss=0.00936 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.999 | L2-Norm(final)=12.055 | 2690.4 samples/s | 42.0 steps/s
[Step=27200 Epoch=132.6] | Loss=0.00892 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.003 | L2-Norm(final)=12.058 | 4766.1 samples/s | 74.5 steps/s
[Step=27250 Epoch=132.9] | Loss=0.00866 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.008 | L2-Norm(final)=12.061 | 4762.2 samples/s | 74.4 steps/s
[Step=27300 Epoch=133.1] | Loss=0.00835 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.012 | L2-Norm(final)=12.065 | 5302.0 samples/s | 82.8 steps/s
[Step=27350 Epoch=133.4] | Loss=0.00812 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=12.068 | 2497.2 samples/s | 39.0 steps/s
[Step=27400 Epoch=133.6] | Loss=0.00786 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=12.071 | 4725.8 samples/s | 73.8 steps/s
[Step=27450 Epoch=133.9] | Loss=0.00761 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.023 | L2-Norm(final)=12.074 | 4758.8 samples/s | 74.4 steps/s
[Step=27500 Epoch=134.1] | Loss=0.00741 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.026 | L2-Norm(final)=12.076 | 4900.3 samples/s | 76.6 steps/s
[Step=27550 Epoch=134.3] | Loss=0.00723 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.030 | L2-Norm(final)=12.079 | 2479.8 samples/s | 38.7 steps/s
[Step=27600 Epoch=134.6] | Loss=0.00700 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.033 | L2-Norm(final)=12.082 | 4765.9 samples/s | 74.5 steps/s
[Step=27650 Epoch=134.8] | Loss=0.00684 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.036 | L2-Norm(final)=12.085 | 4776.9 samples/s | 74.6 steps/s
[Step=27700 Epoch=135.1] | Loss=0.00674 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.039 | L2-Norm(final)=12.087 | 4807.1 samples/s | 75.1 steps/s
[Step=27750 Epoch=135.3] | Loss=0.00664 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.041 | L2-Norm(final)=12.090 | 2934.1 samples/s | 45.8 steps/s
[Step=27800 Epoch=135.6] | Loss=0.00648 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.044 | L2-Norm(final)=12.093 | 4884.6 samples/s | 76.3 steps/s
[Step=27850 Epoch=135.8] | Loss=0.00636 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.047 | L2-Norm(final)=12.095 | 4683.5 samples/s | 73.2 steps/s
[Step=27900 Epoch=136.0] | Loss=0.00628 | Reg=0.00122 | acc=0.9688 | L2-Norm=11.050 | L2-Norm(final)=12.098 | 4858.0 samples/s | 75.9 steps/s
[Step=27950 Epoch=136.3] | Loss=0.00618 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.052 | L2-Norm(final)=12.100 | 2930.4 samples/s | 45.8 steps/s
[Step=28000 Epoch=136.5] | Loss=0.00606 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.055 | L2-Norm(final)=12.102 | 4822.6 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step28000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=165.9] | Loss=0.05325 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.880 | L2-Norm(final)=14.077 | 6030.2 samples/s | 94.2 steps/s
[Step=34050 Epoch=166.1] | Loss=0.02239 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.880 | L2-Norm(final)=14.077 | 4965.0 samples/s | 77.6 steps/s
[Step=34100 Epoch=166.4] | Loss=0.02037 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.881 | L2-Norm(final)=14.080 | 5490.2 samples/s | 85.8 steps/s
[Step=34150 Epoch=166.6] | Loss=0.02075 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.881 | L2-Norm(final)=14.084 | 5522.6 samples/s | 86.3 steps/s
[Step=34200 Epoch=166.9] | Loss=0.02057 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.881 | L2-Norm(final)=14.088 | 8739.6 samples/s | 136.6 steps/s
[Step=34250 Epoch=167.1] | Loss=0.02039 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=14.090 | 2689.9 samples/s | 42.0 steps/s
[Step=34300 Epoch=167.4] | Loss=0.01981 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=14.092 | 5446.4 samples/s | 85.1 steps/s
[Step=34350 Epoch=167.6] | Loss=0.02018 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=14.096 | 5457.0 samples/s | 85.3 steps/s
[Step=34400 Epoch=167.9] | Loss=0.02023 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=14.097 | 7929.7 samples/s | 123.9 steps/s
[Step=34450 Epoch=168.1] | Loss=0.02023 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.881 | L2-Norm(final)=14.099 | 2751.8 samples/s | 43.0 steps/s
[Step=34500 Epoch=168.3] | Loss=0.02031 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=14.101 | 5539.2 samples/s | 86.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=168.3] | Loss=0.00564 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=14.114 | 6946.9 samples/s | 108.5 steps/s
[Step=34550 Epoch=168.6] | Loss=0.01963 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.894 | L2-Norm(final)=14.114 | 4388.3 samples/s | 68.6 steps/s
[Step=34600 Epoch=168.8] | Loss=0.01897 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.908 | L2-Norm(final)=14.115 | 4790.9 samples/s | 74.9 steps/s
[Step=34650 Epoch=169.1] | Loss=0.01730 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.922 | L2-Norm(final)=14.117 | 4710.3 samples/s | 73.6 steps/s
[Step=34700 Epoch=169.3] | Loss=0.01580 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=14.120 | 6889.0 samples/s | 107.6 steps/s
[Step=34750 Epoch=169.6] | Loss=0.01352 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.943 | L2-Norm(final)=14.122 | 2464.6 samples/s | 38.5 steps/s
[Step=34800 Epoch=169.8] | Loss=0.01210 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.951 | L2-Norm(final)=14.125 | 4764.9 samples/s | 74.5 steps/s
[Step=34850 Epoch=170.1] | Loss=0.01131 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.958 | L2-Norm(final)=14.128 | 4830.4 samples/s | 75.5 steps/s
[Step=34900 Epoch=170.3] | Loss=0.01056 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.964 | L2-Norm(final)=14.131 | 6257.3 samples/s | 97.8 steps/s
[Step=34950 Epoch=170.5] | Loss=0.00979 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.970 | L2-Norm(final)=14.133 | 2541.9 samples/s | 39.7 steps/s
[Step=35000 Epoch=170.8] | Loss=0.00930 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.975 | L2-Norm(final)=14.136 | 4878.8 samples/s | 76.2 steps/s
[Step=35050 Epoch=171.0] | Loss=0.00883 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.979 | L2-Norm(final)=14.138 | 4768.1 samples/s | 74.5 steps/s
[Step=35100 Epoch=171.3] | Loss=0.00841 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.983 | L2-Norm(final)=14.141 | 5790.3 samples/s | 90.5 steps/s
[Step=35150 Epoch=171.5] | Loss=0.00811 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.987 | L2-Norm(final)=14.143 | 2654.6 samples/s | 41.5 steps/s
[Step=35200 Epoch=171.8] | Loss=0.00775 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.990 | L2-Norm(final)=14.145 | 4634.9 samples/s | 72.4 steps/s
[Step=35250 Epoch=172.0] | Loss=0.00746 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.994 | L2-Norm(final)=14.147 | 4739.0 samples/s | 74.0 steps/s
[Step=35300 Epoch=172.2] | Loss=0.00720 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.996 | L2-Norm(final)=14.149 | 5521.8 samples/s | 86.3 steps/s
[Step=35350 Epoch=172.5] | Loss=0.00692 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.999 | L2-Norm(final)=14.151 | 2718.8 samples/s | 42.5 steps/s
[Step=35400 Epoch=172.7] | Loss=0.00664 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.002 | L2-Norm(final)=14.153 | 4767.1 samples/s | 74.5 steps/s
[Step=35450 Epoch=173.0] | Loss=0.00643 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.004 | L2-Norm(final)=14.155 | 4795.7 samples/s | 74.9 steps/s
[Step=35500 Epoch=173.2] | Loss=0.00633 | Reg=0.00121 | acc=0.9688 | L2-Norm=11.007 | L2-Norm(final)=14.157 | 5072.1 samples/s | 79.3 steps/s
[Step=35550 Epoch=173.5] | Loss=0.00617 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.009 | L2-Norm(final)=14.159 | 2813.9 samples/s | 44.0 steps/s
[Step=35600 Epoch=173.7] | Loss=0.00604 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.011 | L2-Norm(final)=14.161 | 4725.6 samples/s | 73.8 steps/s
[Step=35650 Epoch=174.0] | Loss=0.00587 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.013 | L2-Norm(final)=14.162 | 4765.0 samples/s | 74.5 steps/s
[Step=35700 Epoch=174.2] | Loss=0.00573 | Reg=0.00121 | acc=0.9531 | L2-Norm=11.016 | L2-Norm(final)=14.164 | 4856.3 samples/s | 75.9 steps/s
[Step=35750 Epoch=174.4] | Loss=0.00559 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.018 | L2-Norm(final)=14.166 | 2897.2 samples/s | 45.3 steps/s
[Step=35800 Epoch=174.7] | Loss=0.00545 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=14.167 | 4784.6 samples/s | 74.8 steps/s
[Step=35850 Epoch=174.9] | Loss=0.00530 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.021 | L2-Norm(final)=14.169 | 4756.1 samples/s | 74.3 steps/s
[Step=35900 Epoch=175.2] | Loss=0.00521 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.023 | L2-Norm(final)=14.171 | 4739.9 samples/s | 74.1 steps/s
[Step=35950 Epoch=175.4] | Loss=0.00520 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.025 | L2-Norm(final)=14.172 | 2955.8 samples/s | 46.2 steps/s
[Step=36000 Epoch=175.7] | Loss=0.00515 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.026 | L2-Norm(final)=14.174 | 4696.8 samples/s | 73.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step36000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=30001 Epoch=146.2] | Loss=0.01117 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=12.811 | 6827.2 samples/s | 106.7 steps/s
[Step=30050 Epoch=146.4] | Loss=0.02194 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=12.813 | 4987.4 samples/s | 77.9 steps/s
[Step=30100 Epoch=146.7] | Loss=0.02217 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.880 | L2-Norm(final)=12.815 | 5292.0 samples/s | 82.7 steps/s
[Step=30150 Epoch=146.9] | Loss=0.02198 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=12.818 | 5673.9 samples/s | 88.7 steps/s
[Step=30200 Epoch=147.1] | Loss=0.02106 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.880 | L2-Norm(final)=12.821 | 8400.7 samples/s | 131.3 steps/s
[Step=30250 Epoch=147.4] | Loss=0.02048 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.880 | L2-Norm(final)=12.824 | 2687.5 samples/s | 42.0 steps/s
[Step=30300 Epoch=147.6] | Loss=0.01984 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.880 | L2-Norm(final)=12.828 | 5604.5 samples/s | 87.6 steps/s
[Step=30350 Epoch=147.9] | Loss=0.02063 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.880 | L2-Norm(final)=12.831 | 5503.6 samples/s | 86.0 steps/s
[Step=30400 Epoch=148.1] | Loss=0.02031 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.880 | L2-Norm(final)=12.833 | 7618.1 samples/s | 119.0 steps/s
[Step=30450 Epoch=148.4] | Loss=0.02019 | Reg=0.00118 | acc=0.9531 | L2-Norm=10.880 | L2-Norm(final)=12.835 | 2832.6 samples/s | 44.3 steps/s
[Step=30500 Epoch=148.6] | Loss=0.02031 | Reg=0.00118 | acc=0.9531 | L2-Norm=10.880 | L2-Norm(final)=12.837 | 5661.1 samples/s | 88.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=148.6] | Loss=0.00735 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=12.856 | 7528.8 samples/s | 117.6 steps/s
[Step=30550 Epoch=148.9] | Loss=0.01819 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.889 | L2-Norm(final)=12.856 | 4161.5 samples/s | 65.0 steps/s
[Step=30600 Epoch=149.1] | Loss=0.01728 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.902 | L2-Norm(final)=12.856 | 4805.2 samples/s | 75.1 steps/s
[Step=30650 Epoch=149.3] | Loss=0.01732 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.914 | L2-Norm(final)=12.857 | 4862.7 samples/s | 76.0 steps/s
[Step=30700 Epoch=149.6] | Loss=0.01632 | Reg=0.00119 | acc=0.9531 | L2-Norm=10.923 | L2-Norm(final)=12.859 | 6675.6 samples/s | 104.3 steps/s
[Step=30750 Epoch=149.8] | Loss=0.01443 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=12.862 | 2508.2 samples/s | 39.2 steps/s
[Step=30800 Epoch=150.1] | Loss=0.01307 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.941 | L2-Norm(final)=12.866 | 4689.0 samples/s | 73.3 steps/s
[Step=30850 Epoch=150.3] | Loss=0.01195 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=12.869 | 4743.0 samples/s | 74.1 steps/s
[Step=30900 Epoch=150.6] | Loss=0.01152 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.954 | L2-Norm(final)=12.873 | 6239.7 samples/s | 97.5 steps/s
[Step=30950 Epoch=150.8] | Loss=0.01067 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.960 | L2-Norm(final)=12.876 | 2591.7 samples/s | 40.5 steps/s
[Step=31000 Epoch=151.0] | Loss=0.01000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.965 | L2-Norm(final)=12.879 | 4684.8 samples/s | 73.2 steps/s
[Step=31050 Epoch=151.3] | Loss=0.00952 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.970 | L2-Norm(final)=12.883 | 4724.6 samples/s | 73.8 steps/s
[Step=31100 Epoch=151.5] | Loss=0.00898 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.974 | L2-Norm(final)=12.886 | 5743.3 samples/s | 89.7 steps/s
[Step=31150 Epoch=151.8] | Loss=0.00856 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.978 | L2-Norm(final)=12.889 | 2658.3 samples/s | 41.5 steps/s
[Step=31200 Epoch=152.0] | Loss=0.00821 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.982 | L2-Norm(final)=12.892 | 4773.3 samples/s | 74.6 steps/s
[Step=31250 Epoch=152.3] | Loss=0.00787 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.986 | L2-Norm(final)=12.895 | 4803.4 samples/s | 75.1 steps/s
[Step=31300 Epoch=152.5] | Loss=0.00762 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.989 | L2-Norm(final)=12.897 | 5197.9 samples/s | 81.2 steps/s
[Step=31350 Epoch=152.8] | Loss=0.00731 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.992 | L2-Norm(final)=12.900 | 2807.1 samples/s | 43.9 steps/s
[Step=31400 Epoch=153.0] | Loss=0.00710 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.995 | L2-Norm(final)=12.903 | 4716.2 samples/s | 73.7 steps/s
[Step=31450 Epoch=153.2] | Loss=0.00689 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.998 | L2-Norm(final)=12.905 | 4720.4 samples/s | 73.8 steps/s
[Step=31500 Epoch=153.5] | Loss=0.00675 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.001 | L2-Norm(final)=12.908 | 4917.8 samples/s | 76.8 steps/s
[Step=31550 Epoch=153.7] | Loss=0.00657 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.004 | L2-Norm(final)=12.910 | 2894.9 samples/s | 45.2 steps/s
[Step=31600 Epoch=154.0] | Loss=0.00644 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.006 | L2-Norm(final)=12.912 | 4775.9 samples/s | 74.6 steps/s
[Step=31650 Epoch=154.2] | Loss=0.00632 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.009 | L2-Norm(final)=12.915 | 4774.4 samples/s | 74.6 steps/s
[Step=31700 Epoch=154.5] | Loss=0.00619 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.011 | L2-Norm(final)=12.917 | 4789.2 samples/s | 74.8 steps/s
[Step=31750 Epoch=154.7] | Loss=0.00605 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.014 | L2-Norm(final)=12.919 | 2997.9 samples/s | 46.8 steps/s
[Step=31800 Epoch=154.9] | Loss=0.00595 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=12.921 | 4725.4 samples/s | 73.8 steps/s
[Step=31850 Epoch=155.2] | Loss=0.00586 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.018 | L2-Norm(final)=12.923 | 4734.3 samples/s | 74.0 steps/s
[Step=31900 Epoch=155.4] | Loss=0.00578 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=12.925 | 4678.1 samples/s | 73.1 steps/s
[Step=31950 Epoch=155.7] | Loss=0.00566 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.023 | L2-Norm(final)=12.927 | 2981.2 samples/s | 46.6 steps/s
[Step=32000 Epoch=155.9] | Loss=0.00557 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.025 | L2-Norm(final)=12.929 | 4715.0 samples/s | 73.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step32000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=26001 Epoch=127.5] | Loss=0.00595 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=13.858 | 7512.8 samples/s | 117.4 steps/s
[Step=26050 Epoch=127.7] | Loss=0.01834 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.880 | L2-Norm(final)=13.862 | 4588.4 samples/s | 71.7 steps/s
[Step=26100 Epoch=128.0] | Loss=0.01856 | Reg=0.00118 | acc=0.9531 | L2-Norm=10.880 | L2-Norm(final)=13.866 | 5572.4 samples/s | 87.1 steps/s
[Step=26150 Epoch=128.2] | Loss=0.01953 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.880 | L2-Norm(final)=13.868 | 5557.8 samples/s | 86.8 steps/s
[Step=26200 Epoch=128.5] | Loss=0.02092 | Reg=0.00118 | acc=0.9531 | L2-Norm=10.880 | L2-Norm(final)=13.868 | 8905.7 samples/s | 139.2 steps/s
[Step=26250 Epoch=128.7] | Loss=0.02074 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.880 | L2-Norm(final)=13.868 | 2631.9 samples/s | 41.1 steps/s
[Step=26300 Epoch=129.0] | Loss=0.02075 | Reg=0.00118 | acc=0.9219 | L2-Norm=10.880 | L2-Norm(final)=13.869 | 5621.1 samples/s | 87.8 steps/s
[Step=26350 Epoch=129.2] | Loss=0.02077 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=13.869 | 5510.6 samples/s | 86.1 steps/s
[Step=26400 Epoch=129.5] | Loss=0.02075 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.880 | L2-Norm(final)=13.869 | 8183.9 samples/s | 127.9 steps/s
[Step=26450 Epoch=129.7] | Loss=0.02080 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.880 | L2-Norm(final)=13.869 | 2697.9 samples/s | 42.2 steps/s
[Step=26500 Epoch=130.0] | Loss=0.02079 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=13.869 | 5654.9 samples/s | 88.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=26501 Epoch=130.0] | Loss=0.00487 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=13.871 | 6975.5 samples/s | 109.0 steps/s
[Step=26550 Epoch=130.2] | Loss=0.02320 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.892 | L2-Norm(final)=13.870 | 4326.0 samples/s | 67.6 steps/s
[Step=26600 Epoch=130.4] | Loss=0.02006 | Reg=0.00119 | acc=0.9688 | L2-Norm=10.907 | L2-Norm(final)=13.870 | 4752.2 samples/s | 74.3 steps/s
[Step=26650 Epoch=130.7] | Loss=0.01727 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.920 | L2-Norm(final)=13.872 | 4752.3 samples/s | 74.3 steps/s
[Step=26700 Epoch=130.9] | Loss=0.01691 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.931 | L2-Norm(final)=13.874 | 7029.8 samples/s | 109.8 steps/s
[Step=26750 Epoch=131.2] | Loss=0.01455 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.941 | L2-Norm(final)=13.877 | 2481.9 samples/s | 38.8 steps/s
[Step=26800 Epoch=131.4] | Loss=0.01316 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.949 | L2-Norm(final)=13.881 | 4616.6 samples/s | 72.1 steps/s
[Step=26850 Epoch=131.7] | Loss=0.01190 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=13.884 | 4781.8 samples/s | 74.7 steps/s
[Step=26900 Epoch=131.9] | Loss=0.01121 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.963 | L2-Norm(final)=13.888 | 6532.9 samples/s | 102.1 steps/s
[Step=26950 Epoch=132.2] | Loss=0.01041 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.968 | L2-Norm(final)=13.891 | 2493.3 samples/s | 39.0 steps/s
[Step=27000 Epoch=132.4] | Loss=0.00968 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.974 | L2-Norm(final)=13.894 | 4796.8 samples/s | 75.0 steps/s
[Step=27050 Epoch=132.6] | Loss=0.00926 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.978 | L2-Norm(final)=13.897 | 4735.3 samples/s | 74.0 steps/s
[Step=27100 Epoch=132.9] | Loss=0.00877 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.983 | L2-Norm(final)=13.900 | 6170.7 samples/s | 96.4 steps/s
[Step=27150 Epoch=133.1] | Loss=0.00823 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.987 | L2-Norm(final)=13.903 | 2579.9 samples/s | 40.3 steps/s
[Step=27200 Epoch=133.4] | Loss=0.00785 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.991 | L2-Norm(final)=13.905 | 4806.4 samples/s | 75.1 steps/s
[Step=27250 Epoch=133.6] | Loss=0.00762 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.994 | L2-Norm(final)=13.908 | 4742.5 samples/s | 74.1 steps/s
[Step=27300 Epoch=133.9] | Loss=0.00733 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.998 | L2-Norm(final)=13.911 | 5820.1 samples/s | 90.9 steps/s
[Step=27350 Epoch=134.1] | Loss=0.00701 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.001 | L2-Norm(final)=13.913 | 2656.9 samples/s | 41.5 steps/s
[Step=27400 Epoch=134.4] | Loss=0.00675 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.004 | L2-Norm(final)=13.916 | 4805.6 samples/s | 75.1 steps/s
[Step=27450 Epoch=134.6] | Loss=0.00657 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.007 | L2-Norm(final)=13.918 | 4733.8 samples/s | 74.0 steps/s
[Step=27500 Epoch=134.9] | Loss=0.00644 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.010 | L2-Norm(final)=13.921 | 5380.7 samples/s | 84.1 steps/s
[Step=27550 Epoch=135.1] | Loss=0.00624 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.012 | L2-Norm(final)=13.923 | 2694.6 samples/s | 42.1 steps/s
[Step=27600 Epoch=135.3] | Loss=0.00606 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.015 | L2-Norm(final)=13.926 | 4779.4 samples/s | 74.7 steps/s
[Step=27650 Epoch=135.6] | Loss=0.00590 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=13.928 | 4792.4 samples/s | 74.9 steps/s
[Step=27700 Epoch=135.8] | Loss=0.00578 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=13.930 | 5195.3 samples/s | 81.2 steps/s
[Step=27750 Epoch=136.1] | Loss=0.00564 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=13.932 | 2778.5 samples/s | 43.4 steps/s
[Step=27800 Epoch=136.3] | Loss=0.00548 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=13.935 | 4764.0 samples/s | 74.4 steps/s
[Step=27850 Epoch=136.6] | Loss=0.00540 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.027 | L2-Norm(final)=13.937 | 4776.8 samples/s | 74.6 steps/s
[Step=27900 Epoch=136.8] | Loss=0.00527 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.029 | L2-Norm(final)=13.939 | 4968.8 samples/s | 77.6 steps/s
[Step=27950 Epoch=137.1] | Loss=0.00516 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.031 | L2-Norm(final)=13.941 | 2892.6 samples/s | 45.2 steps/s
[Step=28000 Epoch=137.3] | Loss=0.00507 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.033 | L2-Norm(final)=13.943 | 4660.3 samples/s | 72.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step28000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=42001 Epoch=398.0] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=17.566 | 7002.5 samples/s | 109.4 steps/s
[Step=42050 Epoch=398.5] | Loss=0.00026 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.879 | L2-Norm(final)=17.570 | 4452.3 samples/s | 69.6 steps/s
[Step=42100 Epoch=398.9] | Loss=0.00017 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.879 | L2-Norm(final)=17.577 | 8342.9 samples/s | 130.4 steps/s
[Step=42150 Epoch=399.4] | Loss=0.00013 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.879 | L2-Norm(final)=17.581 | 2573.9 samples/s | 40.2 steps/s
[Step=42200 Epoch=399.9] | Loss=0.00016 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.879 | L2-Norm(final)=17.585 | 7356.0 samples/s | 114.9 steps/s
[Step=42250 Epoch=400.4] | Loss=0.00018 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.879 | L2-Norm(final)=17.590 | 2739.3 samples/s | 42.8 steps/s
[Step=42300 Epoch=400.8] | Loss=0.00016 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.879 | L2-Norm(final)=17.594 | 6204.2 samples/s | 96.9 steps/s
[Step=42350 Epoch=401.3] | Loss=0.00015 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.879 | L2-Norm(final)=17.599 | 2814.6 samples/s | 44.0 steps/s
[Step=42400 Epoch=401.8] | Loss=0.00014 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.879 | L2-Norm(final)=17.602 | 5827.3 samples/s | 91.1 steps/s
[Step=42450 Epoch=402.3] | Loss=0.00015 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.879 | L2-Norm(final)=17.606 | 2925.0 samples/s | 45.7 steps/s
[Step=42500 Epoch=402.7] | Loss=0.00016 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.879 | L2-Norm(final)=17.610 | 5422.8 samples/s | 84.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=42501 Epoch=402.7] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.879 | L2-Norm(final)=17.650 | 7001.6 samples/s | 109.4 steps/s
[Step=42550 Epoch=403.2] | Loss=0.00004 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.873 | L2-Norm(final)=17.652 | 4008.5 samples/s | 62.6 steps/s
[Step=42600 Epoch=403.7] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.867 | L2-Norm(final)=17.653 | 6623.1 samples/s | 103.5 steps/s
[Step=42650 Epoch=404.1] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.861 | L2-Norm(final)=17.654 | 2421.2 samples/s | 37.8 steps/s
[Step=42700 Epoch=404.6] | Loss=0.00002 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=17.655 | 5800.7 samples/s | 90.6 steps/s
[Step=42750 Epoch=405.1] | Loss=0.00002 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.850 | L2-Norm(final)=17.655 | 2473.0 samples/s | 38.6 steps/s
[Step=42800 Epoch=405.6] | Loss=0.00002 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.845 | L2-Norm(final)=17.656 | 5448.8 samples/s | 85.1 steps/s
[Step=42850 Epoch=406.0] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.839 | L2-Norm(final)=17.656 | 2600.4 samples/s | 40.6 steps/s
[Step=42900 Epoch=406.5] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=17.656 | 4974.4 samples/s | 77.7 steps/s
[Step=42950 Epoch=407.0] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.829 | L2-Norm(final)=17.657 | 2717.5 samples/s | 42.5 steps/s
[Step=43000 Epoch=407.5] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.823 | L2-Norm(final)=17.657 | 4621.0 samples/s | 72.2 steps/s
[Step=43050 Epoch=407.9] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.818 | L2-Norm(final)=17.657 | 2799.0 samples/s | 43.7 steps/s
[Step=43100 Epoch=408.4] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.813 | L2-Norm(final)=17.658 | 4565.8 samples/s | 71.3 steps/s
[Step=43150 Epoch=408.9] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.808 | L2-Norm(final)=17.658 | 2910.9 samples/s | 45.5 steps/s
[Step=43200 Epoch=409.4] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.802 | L2-Norm(final)=17.658 | 4466.3 samples/s | 69.8 steps/s
[Step=43250 Epoch=409.8] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.797 | L2-Norm(final)=17.658 | 2866.7 samples/s | 44.8 steps/s
[Step=43300 Epoch=410.3] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.792 | L2-Norm(final)=17.659 | 4540.4 samples/s | 70.9 steps/s
[Step=43350 Epoch=410.8] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.787 | L2-Norm(final)=17.659 | 2993.5 samples/s | 46.8 steps/s
[Step=43400 Epoch=411.3] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.781 | L2-Norm(final)=17.659 | 4224.6 samples/s | 66.0 steps/s
[Step=43450 Epoch=411.7] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.776 | L2-Norm(final)=17.659 | 6818.9 samples/s | 106.5 steps/s
[Step=43500 Epoch=412.2] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.771 | L2-Norm(final)=17.660 | 2344.3 samples/s | 36.6 steps/s
[Step=43550 Epoch=412.7] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.766 | L2-Norm(final)=17.660 | 6174.7 samples/s | 96.5 steps/s
[Step=43600 Epoch=413.1] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.760 | L2-Norm(final)=17.660 | 2442.8 samples/s | 38.2 steps/s
[Step=43650 Epoch=413.6] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=17.660 | 5553.8 samples/s | 86.8 steps/s
[Step=43700 Epoch=414.1] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.750 | L2-Norm(final)=17.661 | 2529.3 samples/s | 39.5 steps/s
[Step=43750 Epoch=414.6] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.744 | L2-Norm(final)=17.661 | 5184.0 samples/s | 81.0 steps/s
[Step=43800 Epoch=415.0] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.739 | L2-Norm(final)=17.661 | 2651.4 samples/s | 41.4 steps/s
[Step=43850 Epoch=415.5] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.734 | L2-Norm(final)=17.661 | 4762.3 samples/s | 74.4 steps/s
[Step=43900 Epoch=416.0] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.728 | L2-Norm(final)=17.662 | 2798.5 samples/s | 43.7 steps/s
[Step=43950 Epoch=416.5] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.723 | L2-Norm(final)=17.662 | 4421.6 samples/s | 69.1 steps/s
[Step=44000 Epoch=416.9] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.717 | L2-Norm(final)=17.662 | 2856.2 samples/s | 44.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step44000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08138 | acc=0.9640 | tpr=0.9723 | fpr=0.0540 | 5640.3 samples/s | 22.0 steps/s
Avg test loss: 0.08738, Avg test acc: 0.96109, Avg tpr: 0.96987, Avg fpr: 0.05820, total FA: 454

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09139 | acc=0.9638 | tpr=0.9750 | fpr=0.0605 | 5878.6 samples/s | 23.0 steps/s
Avg test loss: 0.09545, Avg test acc: 0.96202, Avg tpr: 0.97255, Avg fpr: 0.06115, total FA: 477

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09447 | acc=0.9622 | tpr=0.9723 | fpr=0.0597 | 6075.7 samples/s | 23.7 steps/s
Avg test loss: 0.09945, Avg test acc: 0.96013, Avg tpr: 0.96870, Avg fpr: 0.05871, total FA: 458

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10222 | acc=0.9585 | tpr=0.9736 | fpr=0.0743 | 6170.2 samples/s | 24.1 steps/s
Avg test loss: 0.10737, Avg test acc: 0.95753, Avg tpr: 0.97342, Avg fpr: 0.07743, total FA: 604

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09102 | acc=0.9623 | tpr=0.9759 | fpr=0.0674 | 5796.9 samples/s | 22.6 steps/s
Avg test loss: 0.09365, Avg test acc: 0.96190, Avg tpr: 0.97476, Avg fpr: 0.06640, total FA: 518

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.30044 | acc=0.2627 | tpr=0.0249 | fpr=0.2210 | 6102.0 samples/s | 23.8 steps/s
Avg test loss: 6.30513, Avg test acc: 0.26176, Avg tpr: 0.02343, Avg fpr: 0.21408, total FA: 1670

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.68716 | acc=0.3028 | tpr=0.0319 | fpr=0.1090 | 5820.9 samples/s | 22.7 steps/s
Avg test loss: 4.69643, Avg test acc: 0.30046, Avg tpr: 0.03077, Avg fpr: 0.10640, total FA: 830

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.01280 | acc=0.2854 | tpr=0.0244 | fpr=0.1479 | 5938.3 samples/s | 23.2 steps/s
Avg test loss: 5.02175, Avg test acc: 0.28480, Avg tpr: 0.02343, Avg fpr: 0.14037, total FA: 1095

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.18498 | acc=0.2693 | tpr=0.0290 | fpr=0.2089 | 6082.8 samples/s | 23.8 steps/s
Avg test loss: 5.18330, Avg test acc: 0.26857, Avg tpr: 0.02739, Avg fpr: 0.20100, total FA: 1568

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.09700 | acc=0.2890 | tpr=0.0187 | fpr=0.1241 | 5926.0 samples/s | 23.1 steps/s
Avg test loss: 5.11268, Avg test acc: 0.28812, Avg tpr: 0.01842, Avg fpr: 0.11870, total FA: 926

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.15408 | acc=0.1349 | tpr=0.5664 | fpr=0.8728 | 5847.0 samples/s | 22.8 steps/s
[Step= 100] | Loss=5.13333 | acc=0.1379 | tpr=0.5458 | fpr=0.8697 | 8265.8 samples/s | 32.3 steps/s
[Step= 150] | Loss=5.12436 | acc=0.1401 | tpr=0.5634 | fpr=0.8677 | 7325.3 samples/s | 28.6 steps/s
[Step= 200] | Loss=5.11585 | acc=0.1399 | tpr=0.5497 | fpr=0.8676 | 5754.2 samples/s | 22.5 steps/s
[Step= 250] | Loss=5.11947 | acc=0.1392 | tpr=0.5406 | fpr=0.8681 | 8034.8 samples/s | 31.4 steps/s
[Step= 300] | Loss=5.11361 | acc=0.1395 | tpr=0.5331 | fpr=0.8676 | 7955.8 samples/s | 31.1 steps/s
[Step= 350] | Loss=5.11883 | acc=0.1393 | tpr=0.5285 | fpr=0.8677 | 7775.9 samples/s | 30.4 steps/s
[Step= 400] | Loss=5.11586 | acc=0.1398 | tpr=0.5295 | fpr=0.8673 | 8049.3 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.11965 | acc=0.1395 | tpr=0.5365 | fpr=0.8677 | 8176.6 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.12042 | acc=0.1393 | tpr=0.5370 | fpr=0.8679 | 7813.1 samples/s | 30.5 steps/s
[Step= 550] | Loss=5.12387 | acc=0.1394 | tpr=0.5360 | fpr=0.8678 | 12653.3 samples/s | 49.4 steps/s
Avg test loss: 5.12432, Avg test acc: 0.13929, Avg tpr: 0.53724, Avg fpr: 0.86794, total FA: 120512

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.07500 | acc=0.1465 | tpr=0.5398 | fpr=0.8606 | 6062.3 samples/s | 23.7 steps/s
[Step= 100] | Loss=5.06248 | acc=0.1507 | tpr=0.5437 | fpr=0.8566 | 7555.5 samples/s | 29.5 steps/s
[Step= 150] | Loss=5.05063 | acc=0.1534 | tpr=0.5591 | fpr=0.8541 | 5976.7 samples/s | 23.3 steps/s
[Step= 200] | Loss=5.04333 | acc=0.1538 | tpr=0.5530 | fpr=0.8535 | 7245.9 samples/s | 28.3 steps/s
[Step= 250] | Loss=5.04595 | acc=0.1534 | tpr=0.5459 | fpr=0.8537 | 8273.3 samples/s | 32.3 steps/s
[Step= 300] | Loss=5.04186 | acc=0.1529 | tpr=0.5367 | fpr=0.8541 | 8571.9 samples/s | 33.5 steps/s
[Step= 350] | Loss=5.04748 | acc=0.1527 | tpr=0.5329 | fpr=0.8542 | 8261.8 samples/s | 32.3 steps/s
[Step= 400] | Loss=5.04499 | acc=0.1529 | tpr=0.5328 | fpr=0.8540 | 7656.5 samples/s | 29.9 steps/s
[Step= 450] | Loss=5.04752 | acc=0.1526 | tpr=0.5394 | fpr=0.8544 | 7632.1 samples/s | 29.8 steps/s
[Step= 500] | Loss=5.04868 | acc=0.1524 | tpr=0.5410 | fpr=0.8546 | 8353.1 samples/s | 32.6 steps/s
[Step= 550] | Loss=5.05295 | acc=0.1524 | tpr=0.5428 | fpr=0.8547 | 10924.3 samples/s | 42.7 steps/s
Avg test loss: 5.05335, Avg test acc: 0.15234, Avg tpr: 0.54358, Avg fpr: 0.85477, total FA: 118683

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.41631 | acc=0.1293 | tpr=0.5752 | fpr=0.8787 | 6138.6 samples/s | 24.0 steps/s
[Step= 100] | Loss=5.40089 | acc=0.1315 | tpr=0.5778 | fpr=0.8768 | 7442.7 samples/s | 29.1 steps/s
[Step= 150] | Loss=5.39082 | acc=0.1323 | tpr=0.5850 | fpr=0.8760 | 5878.2 samples/s | 23.0 steps/s
[Step= 200] | Loss=5.38299 | acc=0.1325 | tpr=0.5760 | fpr=0.8755 | 8205.1 samples/s | 32.1 steps/s
[Step= 250] | Loss=5.38805 | acc=0.1330 | tpr=0.5703 | fpr=0.8750 | 8248.1 samples/s | 32.2 steps/s
[Step= 300] | Loss=5.38435 | acc=0.1328 | tpr=0.5651 | fpr=0.8751 | 8762.3 samples/s | 34.2 steps/s
[Step= 350] | Loss=5.39055 | acc=0.1326 | tpr=0.5604 | fpr=0.8752 | 7802.2 samples/s | 30.5 steps/s
[Step= 400] | Loss=5.38901 | acc=0.1330 | tpr=0.5580 | fpr=0.8747 | 7285.4 samples/s | 28.5 steps/s
[Step= 450] | Loss=5.39409 | acc=0.1323 | tpr=0.5643 | fpr=0.8756 | 8003.8 samples/s | 31.3 steps/s
[Step= 500] | Loss=5.39277 | acc=0.1324 | tpr=0.5643 | fpr=0.8754 | 8229.9 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.39655 | acc=0.1325 | tpr=0.5659 | fpr=0.8753 | 10473.0 samples/s | 40.9 steps/s
Avg test loss: 5.39705, Avg test acc: 0.13248, Avg tpr: 0.56735, Avg fpr: 0.87542, total FA: 121551

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.77950 | acc=0.1355 | tpr=0.6814 | fpr=0.8743 | 6269.1 samples/s | 24.5 steps/s
[Step= 100] | Loss=5.76258 | acc=0.1379 | tpr=0.6588 | fpr=0.8718 | 7555.5 samples/s | 29.5 steps/s
[Step= 150] | Loss=5.74797 | acc=0.1395 | tpr=0.6700 | fpr=0.8703 | 5823.0 samples/s | 22.7 steps/s
[Step= 200] | Loss=5.73847 | acc=0.1398 | tpr=0.6634 | fpr=0.8697 | 8160.0 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.74136 | acc=0.1396 | tpr=0.6594 | fpr=0.8698 | 7725.9 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.73557 | acc=0.1390 | tpr=0.6567 | fpr=0.8705 | 8170.2 samples/s | 31.9 steps/s
[Step= 350] | Loss=5.74135 | acc=0.1389 | tpr=0.6562 | fpr=0.8704 | 8098.0 samples/s | 31.6 steps/s
[Step= 400] | Loss=5.73827 | acc=0.1395 | tpr=0.6565 | fpr=0.8699 | 8052.7 samples/s | 31.5 steps/s
[Step= 450] | Loss=5.74342 | acc=0.1386 | tpr=0.6573 | fpr=0.8708 | 8624.1 samples/s | 33.7 steps/s
[Step= 500] | Loss=5.74306 | acc=0.1387 | tpr=0.6604 | fpr=0.8707 | 7852.7 samples/s | 30.7 steps/s
[Step= 550] | Loss=5.74917 | acc=0.1388 | tpr=0.6614 | fpr=0.8707 | 9453.1 samples/s | 36.9 steps/s
Avg test loss: 5.75013, Avg test acc: 0.13873, Avg tpr: 0.66165, Avg fpr: 0.87077, total FA: 120905

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.51280 | acc=0.1364 | tpr=0.5531 | fpr=0.8711 | 5889.1 samples/s | 23.0 steps/s
[Step= 100] | Loss=5.49949 | acc=0.1384 | tpr=0.5437 | fpr=0.8691 | 6524.4 samples/s | 25.5 steps/s
[Step= 150] | Loss=5.48852 | acc=0.1393 | tpr=0.5504 | fpr=0.8682 | 6500.7 samples/s | 25.4 steps/s
[Step= 200] | Loss=5.48295 | acc=0.1399 | tpr=0.5464 | fpr=0.8675 | 8226.2 samples/s | 32.1 steps/s
[Step= 250] | Loss=5.48455 | acc=0.1396 | tpr=0.5319 | fpr=0.8675 | 8660.7 samples/s | 33.8 steps/s
[Step= 300] | Loss=5.48091 | acc=0.1393 | tpr=0.5273 | fpr=0.8678 | 7767.8 samples/s | 30.3 steps/s
[Step= 350] | Loss=5.48906 | acc=0.1394 | tpr=0.5241 | fpr=0.8676 | 8365.2 samples/s | 32.7 steps/s
[Step= 400] | Loss=5.48498 | acc=0.1397 | tpr=0.5246 | fpr=0.8673 | 8229.6 samples/s | 32.1 steps/s
[Step= 450] | Loss=5.48998 | acc=0.1393 | tpr=0.5258 | fpr=0.8678 | 7938.9 samples/s | 31.0 steps/s
[Step= 500] | Loss=5.48969 | acc=0.1393 | tpr=0.5260 | fpr=0.8677 | 8441.1 samples/s | 33.0 steps/s
[Step= 550] | Loss=5.49308 | acc=0.1393 | tpr=0.5241 | fpr=0.8677 | 9498.1 samples/s | 37.1 steps/s
Avg test loss: 5.49388, Avg test acc: 0.13928, Avg tpr: 0.52496, Avg fpr: 0.86773, total FA: 120483

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.23022 | acc=0.9598 | tpr=0.9381 | fpr=0.0398 | 5587.7 samples/s | 21.8 steps/s
[Step= 100] | Loss=0.23848 | acc=0.9588 | tpr=0.9510 | fpr=0.0411 | 6233.7 samples/s | 24.4 steps/s
[Step= 150] | Loss=0.24138 | acc=0.9571 | tpr=0.9510 | fpr=0.0428 | 7850.7 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.24129 | acc=0.9573 | tpr=0.9541 | fpr=0.0427 | 8214.5 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.24082 | acc=0.9572 | tpr=0.9528 | fpr=0.0427 | 8292.9 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.24507 | acc=0.9567 | tpr=0.9505 | fpr=0.0432 | 8035.9 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.24302 | acc=0.9568 | tpr=0.9499 | fpr=0.0431 | 7423.5 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.24306 | acc=0.9566 | tpr=0.9480 | fpr=0.0433 | 7544.6 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.24706 | acc=0.9561 | tpr=0.9469 | fpr=0.0438 | 8672.0 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.24688 | acc=0.9560 | tpr=0.9480 | fpr=0.0438 | 7540.5 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.24522 | acc=0.9563 | tpr=0.9491 | fpr=0.0435 | 11300.0 samples/s | 44.1 steps/s
Avg test loss: 0.24486, Avg test acc: 0.95636, Avg tpr: 0.94889, Avg fpr: 0.04350, total FA: 6040

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.18138 | acc=0.9611 | tpr=0.9248 | fpr=0.0383 | 5773.2 samples/s | 22.6 steps/s
[Step= 100] | Loss=0.18879 | acc=0.9595 | tpr=0.9318 | fpr=0.0400 | 6049.6 samples/s | 23.6 steps/s
[Step= 150] | Loss=0.19150 | acc=0.9579 | tpr=0.9308 | fpr=0.0416 | 7726.8 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.19195 | acc=0.9580 | tpr=0.9366 | fpr=0.0416 | 7983.6 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.19159 | acc=0.9580 | tpr=0.9371 | fpr=0.0417 | 8066.6 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.19487 | acc=0.9576 | tpr=0.9353 | fpr=0.0420 | 8247.6 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.19346 | acc=0.9577 | tpr=0.9355 | fpr=0.0419 | 7759.7 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.19413 | acc=0.9573 | tpr=0.9327 | fpr=0.0422 | 7793.9 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.19750 | acc=0.9569 | tpr=0.9328 | fpr=0.0427 | 8265.6 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.19707 | acc=0.9567 | tpr=0.9348 | fpr=0.0429 | 8387.9 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.19579 | acc=0.9570 | tpr=0.9351 | fpr=0.0426 | 9817.8 samples/s | 38.4 steps/s
Avg test loss: 0.19555, Avg test acc: 0.95702, Avg tpr: 0.93502, Avg fpr: 0.04258, total FA: 5912

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26324 | acc=0.9509 | tpr=0.9558 | fpr=0.0492 | 4551.9 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.27120 | acc=0.9499 | tpr=0.9595 | fpr=0.0503 | 8018.9 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.27608 | acc=0.9485 | tpr=0.9625 | fpr=0.0517 | 8425.3 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.27566 | acc=0.9487 | tpr=0.9650 | fpr=0.0516 | 8260.4 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.27554 | acc=0.9485 | tpr=0.9642 | fpr=0.0518 | 8174.3 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.27891 | acc=0.9481 | tpr=0.9615 | fpr=0.0521 | 7924.0 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.27690 | acc=0.9481 | tpr=0.9606 | fpr=0.0521 | 7961.1 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.27743 | acc=0.9478 | tpr=0.9568 | fpr=0.0524 | 7790.1 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.28118 | acc=0.9473 | tpr=0.9542 | fpr=0.0528 | 7971.4 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.28155 | acc=0.9472 | tpr=0.9551 | fpr=0.0529 | 8175.7 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.27979 | acc=0.9475 | tpr=0.9554 | fpr=0.0527 | 9729.1 samples/s | 38.0 steps/s
Avg test loss: 0.27948, Avg test acc: 0.94749, Avg tpr: 0.95523, Avg fpr: 0.05265, total FA: 7311

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14962 | acc=0.9655 | tpr=0.9292 | fpr=0.0339 | 4778.7 samples/s | 18.7 steps/s
[Step= 100] | Loss=0.15530 | acc=0.9646 | tpr=0.9424 | fpr=0.0350 | 7655.5 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.15626 | acc=0.9629 | tpr=0.9438 | fpr=0.0368 | 7777.6 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.15585 | acc=0.9629 | tpr=0.9464 | fpr=0.0368 | 8153.2 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.15566 | acc=0.9628 | tpr=0.9467 | fpr=0.0369 | 8560.3 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.15865 | acc=0.9624 | tpr=0.9455 | fpr=0.0373 | 7716.2 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.15757 | acc=0.9624 | tpr=0.9430 | fpr=0.0372 | 8294.8 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.15771 | acc=0.9620 | tpr=0.9409 | fpr=0.0376 | 7996.7 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.16036 | acc=0.9615 | tpr=0.9401 | fpr=0.0381 | 7881.6 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.16003 | acc=0.9615 | tpr=0.9419 | fpr=0.0382 | 8114.6 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.15906 | acc=0.9616 | tpr=0.9423 | fpr=0.0380 | 9680.8 samples/s | 37.8 steps/s
Avg test loss: 0.15878, Avg test acc: 0.96163, Avg tpr: 0.94216, Avg fpr: 0.03801, total FA: 5278

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.23128 | acc=0.9577 | tpr=0.9381 | fpr=0.0419 | 4786.7 samples/s | 18.7 steps/s
[Step= 100] | Loss=0.24061 | acc=0.9563 | tpr=0.9510 | fpr=0.0436 | 7752.6 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.24389 | acc=0.9546 | tpr=0.9568 | fpr=0.0455 | 7714.4 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.24450 | acc=0.9545 | tpr=0.9585 | fpr=0.0456 | 7575.2 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.24545 | acc=0.9543 | tpr=0.9563 | fpr=0.0458 | 8428.6 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.24912 | acc=0.9538 | tpr=0.9535 | fpr=0.0462 | 7345.4 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.24794 | acc=0.9537 | tpr=0.9530 | fpr=0.0462 | 8460.2 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.24821 | acc=0.9534 | tpr=0.9480 | fpr=0.0465 | 8499.7 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.25223 | acc=0.9530 | tpr=0.9464 | fpr=0.0469 | 8520.5 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.25217 | acc=0.9528 | tpr=0.9463 | fpr=0.0471 | 7869.5 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.25054 | acc=0.9531 | tpr=0.9471 | fpr=0.0467 | 9682.2 samples/s | 37.8 steps/s
Avg test loss: 0.25024, Avg test acc: 0.95317, Avg tpr: 0.94691, Avg fpr: 0.04672, total FA: 6487

server round 32/50

clients selected: [2 3 4 5 6]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=155.9] | Loss=0.01743 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=12.992 | 6353.9 samples/s | 99.3 steps/s
[Step=32050 Epoch=156.2] | Loss=0.01760 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=12.993 | 3123.7 samples/s | 48.8 steps/s
[Step=32100 Epoch=156.4] | Loss=0.01796 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.772 | L2-Norm(final)=12.994 | 5356.7 samples/s | 83.7 steps/s
[Step=32150 Epoch=156.7] | Loss=0.01758 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=12.995 | 5289.8 samples/s | 82.7 steps/s
[Step=32200 Epoch=156.9] | Loss=0.01836 | Reg=0.00116 | acc=0.9531 | L2-Norm=10.772 | L2-Norm(final)=12.996 | 8599.7 samples/s | 134.4 steps/s
[Step=32250 Epoch=157.1] | Loss=0.01879 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.772 | L2-Norm(final)=12.995 | 2686.5 samples/s | 42.0 steps/s
[Step=32300 Epoch=157.4] | Loss=0.01894 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=12.993 | 5391.4 samples/s | 84.2 steps/s
[Step=32350 Epoch=157.6] | Loss=0.01841 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.772 | L2-Norm(final)=12.993 | 5513.7 samples/s | 86.2 steps/s
[Step=32400 Epoch=157.9] | Loss=0.01824 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.772 | L2-Norm(final)=12.992 | 7708.0 samples/s | 120.4 steps/s
[Step=32450 Epoch=158.1] | Loss=0.01866 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.772 | L2-Norm(final)=12.992 | 2596.2 samples/s | 40.6 steps/s
[Step=32500 Epoch=158.4] | Loss=0.01853 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=12.992 | 5551.0 samples/s | 86.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=158.4] | Loss=0.01931 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.772 | L2-Norm(final)=12.988 | 6531.2 samples/s | 102.1 steps/s
[Step=32550 Epoch=158.6] | Loss=0.01531 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.781 | L2-Norm(final)=12.989 | 4544.4 samples/s | 71.0 steps/s
[Step=32600 Epoch=158.8] | Loss=0.01538 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.796 | L2-Norm(final)=12.990 | 4749.9 samples/s | 74.2 steps/s
[Step=32650 Epoch=159.1] | Loss=0.01572 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.808 | L2-Norm(final)=12.991 | 4803.5 samples/s | 75.1 steps/s
[Step=32700 Epoch=159.3] | Loss=0.01581 | Reg=0.00117 | acc=0.9531 | L2-Norm=10.818 | L2-Norm(final)=12.992 | 6776.3 samples/s | 105.9 steps/s
[Step=32750 Epoch=159.6] | Loss=0.01422 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.827 | L2-Norm(final)=12.993 | 2479.0 samples/s | 38.7 steps/s
[Step=32800 Epoch=159.8] | Loss=0.01297 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.834 | L2-Norm(final)=12.995 | 4831.3 samples/s | 75.5 steps/s
[Step=32850 Epoch=160.1] | Loss=0.01203 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=12.997 | 4817.3 samples/s | 75.3 steps/s
[Step=32900 Epoch=160.3] | Loss=0.01112 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.847 | L2-Norm(final)=13.000 | 6036.8 samples/s | 94.3 steps/s
[Step=32950 Epoch=160.5] | Loss=0.01030 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.852 | L2-Norm(final)=13.003 | 2585.9 samples/s | 40.4 steps/s
[Step=33000 Epoch=160.8] | Loss=0.00976 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=13.005 | 4759.4 samples/s | 74.4 steps/s
[Step=33050 Epoch=161.0] | Loss=0.00915 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.862 | L2-Norm(final)=13.008 | 4735.7 samples/s | 74.0 steps/s
[Step=33100 Epoch=161.3] | Loss=0.00888 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.866 | L2-Norm(final)=13.011 | 5688.3 samples/s | 88.9 steps/s
[Step=33150 Epoch=161.5] | Loss=0.00842 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.870 | L2-Norm(final)=13.013 | 2667.2 samples/s | 41.7 steps/s
[Step=33200 Epoch=161.8] | Loss=0.00808 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.874 | L2-Norm(final)=13.016 | 4795.7 samples/s | 74.9 steps/s
[Step=33250 Epoch=162.0] | Loss=0.00777 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.877 | L2-Norm(final)=13.018 | 4734.9 samples/s | 74.0 steps/s
[Step=33300 Epoch=162.3] | Loss=0.00750 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=13.021 | 5236.1 samples/s | 81.8 steps/s
[Step=33350 Epoch=162.5] | Loss=0.00725 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.884 | L2-Norm(final)=13.023 | 2798.1 samples/s | 43.7 steps/s
[Step=33400 Epoch=162.7] | Loss=0.00700 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.887 | L2-Norm(final)=13.026 | 4689.7 samples/s | 73.3 steps/s
[Step=33450 Epoch=163.0] | Loss=0.00677 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.890 | L2-Norm(final)=13.028 | 4795.6 samples/s | 74.9 steps/s
[Step=33500 Epoch=163.2] | Loss=0.00664 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.893 | L2-Norm(final)=13.030 | 4878.3 samples/s | 76.2 steps/s
[Step=33550 Epoch=163.5] | Loss=0.00646 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=13.033 | 2944.3 samples/s | 46.0 steps/s
[Step=33600 Epoch=163.7] | Loss=0.00634 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.898 | L2-Norm(final)=13.035 | 4651.9 samples/s | 72.7 steps/s
[Step=33650 Epoch=164.0] | Loss=0.00624 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.900 | L2-Norm(final)=13.037 | 4819.0 samples/s | 75.3 steps/s
[Step=33700 Epoch=164.2] | Loss=0.00609 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.903 | L2-Norm(final)=13.039 | 4704.6 samples/s | 73.5 steps/s
[Step=33750 Epoch=164.4] | Loss=0.00594 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.905 | L2-Norm(final)=13.041 | 2945.4 samples/s | 46.0 steps/s
[Step=33800 Epoch=164.7] | Loss=0.00578 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.908 | L2-Norm(final)=13.043 | 4784.7 samples/s | 74.8 steps/s
[Step=33850 Epoch=164.9] | Loss=0.00567 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.910 | L2-Norm(final)=13.046 | 4824.6 samples/s | 75.4 steps/s
[Step=33900 Epoch=165.2] | Loss=0.00561 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.912 | L2-Norm(final)=13.048 | 4690.2 samples/s | 73.3 steps/s
[Step=33950 Epoch=165.4] | Loss=0.00553 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.914 | L2-Norm(final)=13.050 | 2970.5 samples/s | 46.4 steps/s
[Step=34000 Epoch=165.7] | Loss=0.00540 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.917 | L2-Norm(final)=13.052 | 4832.0 samples/s | 75.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step34000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=22001 Epoch=107.3] | Loss=0.04951 | Reg=0.00116 | acc=0.9531 | L2-Norm=10.772 | L2-Norm(final)=13.030 | 6900.9 samples/s | 107.8 steps/s
[Step=22050 Epoch=107.5] | Loss=0.01772 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.772 | L2-Norm(final)=13.033 | 5061.2 samples/s | 79.1 steps/s
[Step=22100 Epoch=107.8] | Loss=0.01689 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=13.037 | 5507.3 samples/s | 86.1 steps/s
[Step=22150 Epoch=108.0] | Loss=0.01622 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=13.040 | 5569.0 samples/s | 87.0 steps/s
[Step=22200 Epoch=108.3] | Loss=0.01780 | Reg=0.00116 | acc=0.9531 | L2-Norm=10.772 | L2-Norm(final)=13.042 | 8717.4 samples/s | 136.2 steps/s
[Step=22250 Epoch=108.5] | Loss=0.01798 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=13.042 | 2675.2 samples/s | 41.8 steps/s
[Step=22300 Epoch=108.7] | Loss=0.01740 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.772 | L2-Norm(final)=13.041 | 5550.4 samples/s | 86.7 steps/s
[Step=22350 Epoch=109.0] | Loss=0.01790 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.772 | L2-Norm(final)=13.041 | 5515.2 samples/s | 86.2 steps/s
[Step=22400 Epoch=109.2] | Loss=0.01759 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.772 | L2-Norm(final)=13.042 | 7740.1 samples/s | 120.9 steps/s
[Step=22450 Epoch=109.5] | Loss=0.01777 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=13.042 | 2775.0 samples/s | 43.4 steps/s
[Step=22500 Epoch=109.7] | Loss=0.01730 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=13.043 | 5501.1 samples/s | 86.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=22501 Epoch=109.7] | Loss=0.01777 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.772 | L2-Norm(final)=13.050 | 6819.9 samples/s | 106.6 steps/s
[Step=22550 Epoch=110.0] | Loss=0.01633 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.788 | L2-Norm(final)=13.052 | 4427.2 samples/s | 69.2 steps/s
[Step=22600 Epoch=110.2] | Loss=0.01697 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.807 | L2-Norm(final)=13.051 | 4746.7 samples/s | 74.2 steps/s
[Step=22650 Epoch=110.5] | Loss=0.01567 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.821 | L2-Norm(final)=13.052 | 4768.9 samples/s | 74.5 steps/s
[Step=22700 Epoch=110.7] | Loss=0.01546 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.834 | L2-Norm(final)=13.055 | 6963.2 samples/s | 108.8 steps/s
[Step=22750 Epoch=110.9] | Loss=0.01335 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.845 | L2-Norm(final)=13.057 | 2473.7 samples/s | 38.7 steps/s
[Step=22800 Epoch=111.2] | Loss=0.01209 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.855 | L2-Norm(final)=13.060 | 4776.9 samples/s | 74.6 steps/s
[Step=22850 Epoch=111.4] | Loss=0.01126 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.864 | L2-Norm(final)=13.064 | 4749.8 samples/s | 74.2 steps/s
[Step=22900 Epoch=111.7] | Loss=0.01042 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.872 | L2-Norm(final)=13.067 | 6269.4 samples/s | 98.0 steps/s
[Step=22950 Epoch=111.9] | Loss=0.00984 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.879 | L2-Norm(final)=13.071 | 2582.9 samples/s | 40.4 steps/s
[Step=23000 Epoch=112.2] | Loss=0.00919 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.886 | L2-Norm(final)=13.074 | 4794.7 samples/s | 74.9 steps/s
[Step=23050 Epoch=112.4] | Loss=0.00875 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.892 | L2-Norm(final)=13.078 | 4722.1 samples/s | 73.8 steps/s
[Step=23100 Epoch=112.6] | Loss=0.00834 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.897 | L2-Norm(final)=13.081 | 5699.0 samples/s | 89.0 steps/s
[Step=23150 Epoch=112.9] | Loss=0.00784 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.902 | L2-Norm(final)=13.084 | 2682.7 samples/s | 41.9 steps/s
[Step=23200 Epoch=113.1] | Loss=0.00749 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.907 | L2-Norm(final)=13.086 | 4732.7 samples/s | 73.9 steps/s
[Step=23250 Epoch=113.4] | Loss=0.00718 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.911 | L2-Norm(final)=13.089 | 4754.5 samples/s | 74.3 steps/s
[Step=23300 Epoch=113.6] | Loss=0.00701 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.915 | L2-Norm(final)=13.092 | 5283.9 samples/s | 82.6 steps/s
[Step=23350 Epoch=113.9] | Loss=0.00675 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.919 | L2-Norm(final)=13.094 | 2799.6 samples/s | 43.7 steps/s
[Step=23400 Epoch=114.1] | Loss=0.00653 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.922 | L2-Norm(final)=13.097 | 4720.1 samples/s | 73.8 steps/s
[Step=23450 Epoch=114.4] | Loss=0.00631 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.925 | L2-Norm(final)=13.100 | 4759.8 samples/s | 74.4 steps/s
[Step=23500 Epoch=114.6] | Loss=0.00613 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.929 | L2-Norm(final)=13.102 | 4905.8 samples/s | 76.7 steps/s
[Step=23550 Epoch=114.8] | Loss=0.00598 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.932 | L2-Norm(final)=13.104 | 2902.4 samples/s | 45.3 steps/s
[Step=23600 Epoch=115.1] | Loss=0.00580 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.935 | L2-Norm(final)=13.107 | 4743.9 samples/s | 74.1 steps/s
[Step=23650 Epoch=115.3] | Loss=0.00572 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.938 | L2-Norm(final)=13.109 | 4745.2 samples/s | 74.1 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00557 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.940 | L2-Norm(final)=13.111 | 4759.5 samples/s | 74.4 steps/s
[Step=23750 Epoch=115.8] | Loss=0.00545 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.943 | L2-Norm(final)=13.114 | 2960.5 samples/s | 46.3 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00530 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.946 | L2-Norm(final)=13.116 | 4799.7 samples/s | 75.0 steps/s
[Step=23850 Epoch=116.3] | Loss=0.00518 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=13.118 | 4704.3 samples/s | 73.5 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00511 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.950 | L2-Norm(final)=13.120 | 4825.4 samples/s | 75.4 steps/s
[Step=23950 Epoch=116.8] | Loss=0.00503 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.953 | L2-Norm(final)=13.122 | 2940.0 samples/s | 45.9 steps/s
[Step=24000 Epoch=117.0] | Loss=0.00494 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.955 | L2-Norm(final)=13.124 | 4777.6 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step24000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=28001 Epoch=137.3] | Loss=0.08211 | Reg=0.00116 | acc=0.9531 | L2-Norm=10.772 | L2-Norm(final)=14.007 | 7127.2 samples/s | 111.4 steps/s
[Step=28050 Epoch=137.6] | Loss=0.02422 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.772 | L2-Norm(final)=14.002 | 4740.3 samples/s | 74.1 steps/s
[Step=28100 Epoch=137.8] | Loss=0.02218 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=13.997 | 5703.4 samples/s | 89.1 steps/s
[Step=28150 Epoch=138.0] | Loss=0.02042 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.772 | L2-Norm(final)=13.992 | 5390.9 samples/s | 84.2 steps/s
[Step=28200 Epoch=138.3] | Loss=0.01959 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=13.989 | 8923.9 samples/s | 139.4 steps/s
[Step=28250 Epoch=138.5] | Loss=0.01975 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.772 | L2-Norm(final)=13.987 | 2629.4 samples/s | 41.1 steps/s
[Step=28300 Epoch=138.8] | Loss=0.01983 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=13.985 | 5581.7 samples/s | 87.2 steps/s
[Step=28350 Epoch=139.0] | Loss=0.01964 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.772 | L2-Norm(final)=13.983 | 5505.9 samples/s | 86.0 steps/s
[Step=28400 Epoch=139.3] | Loss=0.01967 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=13.980 | 8230.9 samples/s | 128.6 steps/s
[Step=28450 Epoch=139.5] | Loss=0.02001 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.772 | L2-Norm(final)=13.978 | 2717.7 samples/s | 42.5 steps/s
[Step=28500 Epoch=139.8] | Loss=0.01988 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=13.975 | 5629.0 samples/s | 88.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=28501 Epoch=139.8] | Loss=0.00273 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=13.946 | 6839.5 samples/s | 106.9 steps/s
[Step=28550 Epoch=140.0] | Loss=0.02033 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.786 | L2-Norm(final)=13.945 | 4415.8 samples/s | 69.0 steps/s
[Step=28600 Epoch=140.2] | Loss=0.01915 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.802 | L2-Norm(final)=13.945 | 4824.8 samples/s | 75.4 steps/s
[Step=28650 Epoch=140.5] | Loss=0.01743 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.815 | L2-Norm(final)=13.947 | 4706.8 samples/s | 73.5 steps/s
[Step=28700 Epoch=140.7] | Loss=0.01629 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.826 | L2-Norm(final)=13.949 | 7020.5 samples/s | 109.7 steps/s
[Step=28750 Epoch=141.0] | Loss=0.01457 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.836 | L2-Norm(final)=13.951 | 2446.9 samples/s | 38.2 steps/s
[Step=28800 Epoch=141.2] | Loss=0.01310 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.845 | L2-Norm(final)=13.954 | 4785.6 samples/s | 74.8 steps/s
[Step=28850 Epoch=141.5] | Loss=0.01195 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.853 | L2-Norm(final)=13.957 | 4799.7 samples/s | 75.0 steps/s
[Step=28900 Epoch=141.7] | Loss=0.01109 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.860 | L2-Norm(final)=13.960 | 6488.1 samples/s | 101.4 steps/s
[Step=28950 Epoch=142.0] | Loss=0.01037 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.866 | L2-Norm(final)=13.963 | 2505.7 samples/s | 39.2 steps/s
[Step=29000 Epoch=142.2] | Loss=0.00969 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.871 | L2-Norm(final)=13.966 | 4810.8 samples/s | 75.2 steps/s
[Step=29050 Epoch=142.5] | Loss=0.00930 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.877 | L2-Norm(final)=13.969 | 4745.3 samples/s | 74.1 steps/s
[Step=29100 Epoch=142.7] | Loss=0.00884 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=13.971 | 6117.7 samples/s | 95.6 steps/s
[Step=29150 Epoch=142.9] | Loss=0.00840 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.886 | L2-Norm(final)=13.974 | 2565.6 samples/s | 40.1 steps/s
[Step=29200 Epoch=143.2] | Loss=0.00807 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.890 | L2-Norm(final)=13.976 | 4800.3 samples/s | 75.0 steps/s
[Step=29250 Epoch=143.4] | Loss=0.00774 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.894 | L2-Norm(final)=13.979 | 4750.2 samples/s | 74.2 steps/s
[Step=29300 Epoch=143.7] | Loss=0.00747 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.898 | L2-Norm(final)=13.981 | 5814.4 samples/s | 90.8 steps/s
[Step=29350 Epoch=143.9] | Loss=0.00715 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.901 | L2-Norm(final)=13.984 | 2622.4 samples/s | 41.0 steps/s
[Step=29400 Epoch=144.2] | Loss=0.00692 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.905 | L2-Norm(final)=13.986 | 4756.1 samples/s | 74.3 steps/s
[Step=29450 Epoch=144.4] | Loss=0.00672 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.908 | L2-Norm(final)=13.989 | 4765.7 samples/s | 74.5 steps/s
[Step=29500 Epoch=144.7] | Loss=0.00653 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.911 | L2-Norm(final)=13.991 | 5531.6 samples/s | 86.4 steps/s
[Step=29550 Epoch=144.9] | Loss=0.00631 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.914 | L2-Norm(final)=13.993 | 2684.0 samples/s | 41.9 steps/s
[Step=29600 Epoch=145.2] | Loss=0.00616 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.917 | L2-Norm(final)=13.995 | 4890.3 samples/s | 76.4 steps/s
[Step=29650 Epoch=145.4] | Loss=0.00597 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.919 | L2-Norm(final)=13.998 | 4690.4 samples/s | 73.3 steps/s
[Step=29700 Epoch=145.6] | Loss=0.00583 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.922 | L2-Norm(final)=14.000 | 5216.9 samples/s | 81.5 steps/s
[Step=29750 Epoch=145.9] | Loss=0.00570 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.924 | L2-Norm(final)=14.002 | 2741.8 samples/s | 42.8 steps/s
[Step=29800 Epoch=146.1] | Loss=0.00558 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.927 | L2-Norm(final)=14.004 | 4765.5 samples/s | 74.5 steps/s
[Step=29850 Epoch=146.4] | Loss=0.00544 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.929 | L2-Norm(final)=14.006 | 4795.1 samples/s | 74.9 steps/s
[Step=29900 Epoch=146.6] | Loss=0.00533 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.931 | L2-Norm(final)=14.008 | 4958.6 samples/s | 77.5 steps/s
[Step=29950 Epoch=146.9] | Loss=0.00522 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=14.010 | 2881.6 samples/s | 45.0 steps/s
[Step=30000 Epoch=147.1] | Loss=0.00511 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.935 | L2-Norm(final)=14.012 | 4826.5 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step30000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=44001 Epoch=416.9] | Loss=0.00003 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=17.669 | 7366.5 samples/s | 115.1 steps/s
[Step=44050 Epoch=417.4] | Loss=0.00020 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=17.676 | 4361.2 samples/s | 68.1 steps/s
[Step=44100 Epoch=417.9] | Loss=0.00014 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=17.684 | 8037.2 samples/s | 125.6 steps/s
[Step=44150 Epoch=418.4] | Loss=0.00012 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=17.690 | 2576.3 samples/s | 40.3 steps/s
[Step=44200 Epoch=418.8] | Loss=0.00014 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=17.697 | 7281.8 samples/s | 113.8 steps/s
[Step=44250 Epoch=419.3] | Loss=0.00013 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=17.704 | 2664.4 samples/s | 41.6 steps/s
[Step=44300 Epoch=419.8] | Loss=0.00013 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=17.710 | 6513.9 samples/s | 101.8 steps/s
[Step=44350 Epoch=420.3] | Loss=0.00013 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=17.716 | 2793.7 samples/s | 43.7 steps/s
[Step=44400 Epoch=420.7] | Loss=0.00013 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=17.722 | 5903.8 samples/s | 92.2 steps/s
[Step=44450 Epoch=421.2] | Loss=0.00012 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=17.727 | 2933.5 samples/s | 45.8 steps/s
[Step=44500 Epoch=421.7] | Loss=0.00013 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=17.732 | 5373.3 samples/s | 84.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=44501 Epoch=421.7] | Loss=0.00013 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=17.783 | 6994.7 samples/s | 109.3 steps/s
[Step=44550 Epoch=422.1] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.760 | L2-Norm(final)=17.785 | 4258.0 samples/s | 66.5 steps/s
[Step=44600 Epoch=422.6] | Loss=0.00002 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.747 | L2-Norm(final)=17.786 | 6633.9 samples/s | 103.7 steps/s
[Step=44650 Epoch=423.1] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.735 | L2-Norm(final)=17.786 | 2407.3 samples/s | 37.6 steps/s
[Step=44700 Epoch=423.6] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.723 | L2-Norm(final)=17.787 | 5847.4 samples/s | 91.4 steps/s
[Step=44750 Epoch=424.0] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.712 | L2-Norm(final)=17.787 | 2495.4 samples/s | 39.0 steps/s
[Step=44800 Epoch=424.5] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.700 | L2-Norm(final)=17.787 | 5420.5 samples/s | 84.7 steps/s
[Step=44850 Epoch=425.0] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.689 | L2-Norm(final)=17.788 | 2582.5 samples/s | 40.4 steps/s
[Step=44900 Epoch=425.5] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.678 | L2-Norm(final)=17.788 | 5007.5 samples/s | 78.2 steps/s
[Step=44950 Epoch=425.9] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.667 | L2-Norm(final)=17.788 | 2687.3 samples/s | 42.0 steps/s
[Step=45000 Epoch=426.4] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.657 | L2-Norm(final)=17.788 | 4632.0 samples/s | 72.4 steps/s
[Step=45050 Epoch=426.9] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.646 | L2-Norm(final)=17.789 | 2822.4 samples/s | 44.1 steps/s
[Step=45100 Epoch=427.4] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.635 | L2-Norm(final)=17.789 | 4483.3 samples/s | 70.1 steps/s
[Step=45150 Epoch=427.8] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.625 | L2-Norm(final)=17.789 | 2869.6 samples/s | 44.8 steps/s
[Step=45200 Epoch=428.3] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.614 | L2-Norm(final)=17.789 | 4543.5 samples/s | 71.0 steps/s
[Step=45250 Epoch=428.8] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.604 | L2-Norm(final)=17.789 | 2848.5 samples/s | 44.5 steps/s
[Step=45300 Epoch=429.3] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.593 | L2-Norm(final)=17.790 | 4617.6 samples/s | 72.1 steps/s
[Step=45350 Epoch=429.7] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.583 | L2-Norm(final)=17.790 | 2886.4 samples/s | 45.1 steps/s
[Step=45400 Epoch=430.2] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.572 | L2-Norm(final)=17.790 | 4393.0 samples/s | 68.6 steps/s
[Step=45450 Epoch=430.7] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.562 | L2-Norm(final)=17.790 | 6855.4 samples/s | 107.1 steps/s
[Step=45500 Epoch=431.2] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.551 | L2-Norm(final)=17.791 | 2349.1 samples/s | 36.7 steps/s
[Step=45550 Epoch=431.6] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.541 | L2-Norm(final)=17.791 | 6160.9 samples/s | 96.3 steps/s
[Step=45600 Epoch=432.1] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.530 | L2-Norm(final)=17.791 | 2441.4 samples/s | 38.1 steps/s
[Step=45650 Epoch=432.6] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.520 | L2-Norm(final)=17.791 | 5588.2 samples/s | 87.3 steps/s
[Step=45700 Epoch=433.0] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.509 | L2-Norm(final)=17.791 | 2052.2 samples/s | 32.1 steps/s
[Step=45750 Epoch=433.5] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.498 | L2-Norm(final)=17.792 | 4764.4 samples/s | 74.4 steps/s
[Step=45800 Epoch=434.0] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.488 | L2-Norm(final)=17.792 | 2669.8 samples/s | 41.7 steps/s
[Step=45850 Epoch=434.5] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.477 | L2-Norm(final)=17.792 | 4667.7 samples/s | 72.9 steps/s
[Step=45900 Epoch=434.9] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.466 | L2-Norm(final)=17.792 | 2761.7 samples/s | 43.2 steps/s
[Step=45950 Epoch=435.4] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.455 | L2-Norm(final)=17.793 | 4621.7 samples/s | 72.2 steps/s
[Step=46000 Epoch=435.9] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.444 | L2-Norm(final)=17.793 | 2825.9 samples/s | 44.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step46000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=30001 Epoch=285.4] | Loss=0.00172 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=15.133 | 5844.5 samples/s | 91.3 steps/s
[Step=30050 Epoch=285.9] | Loss=0.00074 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=15.141 | 4723.0 samples/s | 73.8 steps/s
[Step=30100 Epoch=286.3] | Loss=0.00077 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=15.156 | 8344.3 samples/s | 130.4 steps/s
[Step=30150 Epoch=286.8] | Loss=0.00075 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=15.169 | 2578.1 samples/s | 40.3 steps/s
[Step=30200 Epoch=287.3] | Loss=0.00073 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=15.180 | 7334.4 samples/s | 114.6 steps/s
[Step=30250 Epoch=287.8] | Loss=0.00078 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=15.192 | 2656.9 samples/s | 41.5 steps/s
[Step=30300 Epoch=288.2] | Loss=0.00077 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=15.202 | 6516.0 samples/s | 101.8 steps/s
[Step=30350 Epoch=288.7] | Loss=0.00077 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=15.212 | 2795.6 samples/s | 43.7 steps/s
[Step=30400 Epoch=289.2] | Loss=0.00076 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=15.220 | 5949.2 samples/s | 93.0 steps/s
[Step=30450 Epoch=289.7] | Loss=0.00074 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=15.228 | 2970.3 samples/s | 46.4 steps/s
[Step=30500 Epoch=290.1] | Loss=0.00075 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=15.236 | 5373.8 samples/s | 84.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=290.1] | Loss=0.00025 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=15.314 | 6830.9 samples/s | 106.7 steps/s
[Step=30550 Epoch=290.6] | Loss=0.00036 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.786 | L2-Norm(final)=15.318 | 4099.9 samples/s | 64.1 steps/s
[Step=30600 Epoch=291.1] | Loss=0.00022 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.791 | L2-Norm(final)=15.320 | 6598.1 samples/s | 103.1 steps/s
[Step=30650 Epoch=291.6] | Loss=0.00015 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.789 | L2-Norm(final)=15.322 | 2381.3 samples/s | 37.2 steps/s
[Step=30700 Epoch=292.0] | Loss=0.00012 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.785 | L2-Norm(final)=15.323 | 5970.2 samples/s | 93.3 steps/s
[Step=30750 Epoch=292.5] | Loss=0.00009 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.779 | L2-Norm(final)=15.323 | 2464.4 samples/s | 38.5 steps/s
[Step=30800 Epoch=293.0] | Loss=0.00008 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=15.324 | 5490.1 samples/s | 85.8 steps/s
[Step=30850 Epoch=293.5] | Loss=0.00007 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.765 | L2-Norm(final)=15.324 | 2594.4 samples/s | 40.5 steps/s
[Step=30900 Epoch=293.9] | Loss=0.00006 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.757 | L2-Norm(final)=15.325 | 4987.9 samples/s | 77.9 steps/s
[Step=30950 Epoch=294.4] | Loss=0.00005 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.750 | L2-Norm(final)=15.325 | 2694.5 samples/s | 42.1 steps/s
[Step=31000 Epoch=294.9] | Loss=0.00005 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.742 | L2-Norm(final)=15.326 | 4639.6 samples/s | 72.5 steps/s
[Step=31050 Epoch=295.4] | Loss=0.00005 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.734 | L2-Norm(final)=15.326 | 2816.6 samples/s | 44.0 steps/s
[Step=31100 Epoch=295.8] | Loss=0.00004 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.726 | L2-Norm(final)=15.327 | 4532.4 samples/s | 70.8 steps/s
[Step=31150 Epoch=296.3] | Loss=0.00004 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.718 | L2-Norm(final)=15.327 | 2851.5 samples/s | 44.6 steps/s
[Step=31200 Epoch=296.8] | Loss=0.00004 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.710 | L2-Norm(final)=15.328 | 4584.3 samples/s | 71.6 steps/s
[Step=31250 Epoch=297.3] | Loss=0.00003 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.701 | L2-Norm(final)=15.328 | 2816.6 samples/s | 44.0 steps/s
[Step=31300 Epoch=297.7] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.693 | L2-Norm(final)=15.329 | 4528.9 samples/s | 70.8 steps/s
[Step=31350 Epoch=298.2] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.685 | L2-Norm(final)=15.329 | 3073.6 samples/s | 48.0 steps/s
[Step=31400 Epoch=298.7] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.676 | L2-Norm(final)=15.329 | 4256.3 samples/s | 66.5 steps/s
[Step=31450 Epoch=299.2] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.668 | L2-Norm(final)=15.330 | 6887.2 samples/s | 107.6 steps/s
[Step=31500 Epoch=299.6] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.659 | L2-Norm(final)=15.330 | 2390.5 samples/s | 37.4 steps/s
[Step=31550 Epoch=300.1] | Loss=0.00002 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.650 | L2-Norm(final)=15.330 | 6071.4 samples/s | 94.9 steps/s
[Step=31600 Epoch=300.6] | Loss=0.00002 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.642 | L2-Norm(final)=15.331 | 2451.1 samples/s | 38.3 steps/s
[Step=31650 Epoch=301.1] | Loss=0.00002 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.633 | L2-Norm(final)=15.331 | 5670.3 samples/s | 88.6 steps/s
[Step=31700 Epoch=301.5] | Loss=0.00002 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=15.332 | 2554.9 samples/s | 39.9 steps/s
[Step=31750 Epoch=302.0] | Loss=0.00002 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.615 | L2-Norm(final)=15.332 | 5193.8 samples/s | 81.2 steps/s
[Step=31800 Epoch=302.5] | Loss=0.00002 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.606 | L2-Norm(final)=15.332 | 2669.1 samples/s | 41.7 steps/s
[Step=31850 Epoch=303.0] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.597 | L2-Norm(final)=15.333 | 4718.2 samples/s | 73.7 steps/s
[Step=31900 Epoch=303.4] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.588 | L2-Norm(final)=15.333 | 2785.3 samples/s | 43.5 steps/s
[Step=31950 Epoch=303.9] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.579 | L2-Norm(final)=15.333 | 4605.7 samples/s | 72.0 steps/s
[Step=32000 Epoch=304.4] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.569 | L2-Norm(final)=15.334 | 2807.0 samples/s | 43.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08138 | acc=0.9640 | tpr=0.9723 | fpr=0.0540 | 5747.4 samples/s | 22.5 steps/s
Avg test loss: 0.08738, Avg test acc: 0.96109, Avg tpr: 0.96987, Avg fpr: 0.05820, total FA: 454

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09139 | acc=0.9638 | tpr=0.9750 | fpr=0.0605 | 5956.6 samples/s | 23.3 steps/s
Avg test loss: 0.09545, Avg test acc: 0.96202, Avg tpr: 0.97255, Avg fpr: 0.06115, total FA: 477

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09624 | acc=0.9627 | tpr=0.9750 | fpr=0.0639 | 5970.7 samples/s | 23.3 steps/s
Avg test loss: 0.09791, Avg test acc: 0.96138, Avg tpr: 0.97196, Avg fpr: 0.06192, total FA: 483

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08881 | acc=0.9612 | tpr=0.9752 | fpr=0.0694 | 5861.7 samples/s | 22.9 steps/s
Avg test loss: 0.09313, Avg test acc: 0.96045, Avg tpr: 0.97465, Avg fpr: 0.07076, total FA: 552

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09120 | acc=0.9620 | tpr=0.9722 | fpr=0.0602 | 5678.4 samples/s | 22.2 steps/s
Avg test loss: 0.09526, Avg test acc: 0.96069, Avg tpr: 0.96992, Avg fpr: 0.05961, total FA: 465

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.32420 | acc=0.2605 | tpr=0.0250 | fpr=0.2279 | 5731.6 samples/s | 22.4 steps/s
Avg test loss: 6.32969, Avg test acc: 0.26036, Avg tpr: 0.02366, Avg fpr: 0.21907, total FA: 1709

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.87335 | acc=0.3091 | tpr=0.0227 | fpr=0.0691 | 5906.4 samples/s | 23.1 steps/s
Avg test loss: 4.88463, Avg test acc: 0.30599, Avg tpr: 0.02209, Avg fpr: 0.06961, total FA: 543

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.01280 | acc=0.2854 | tpr=0.0244 | fpr=0.1479 | 6099.8 samples/s | 23.8 steps/s
Avg test loss: 5.02175, Avg test acc: 0.28480, Avg tpr: 0.02343, Avg fpr: 0.14037, total FA: 1095

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.18498 | acc=0.2693 | tpr=0.0290 | fpr=0.2089 | 5909.3 samples/s | 23.1 steps/s
Avg test loss: 5.18330, Avg test acc: 0.26857, Avg tpr: 0.02739, Avg fpr: 0.20100, total FA: 1568

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.09700 | acc=0.2890 | tpr=0.0187 | fpr=0.1241 | 5568.9 samples/s | 21.8 steps/s
Avg test loss: 5.11268, Avg test acc: 0.28812, Avg tpr: 0.01842, Avg fpr: 0.11870, total FA: 926

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.15408 | acc=0.1349 | tpr=0.5664 | fpr=0.8728 | 5913.2 samples/s | 23.1 steps/s
[Step= 100] | Loss=5.13333 | acc=0.1379 | tpr=0.5458 | fpr=0.8697 | 8166.8 samples/s | 31.9 steps/s
[Step= 150] | Loss=5.12436 | acc=0.1401 | tpr=0.5634 | fpr=0.8677 | 8043.5 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.11585 | acc=0.1399 | tpr=0.5497 | fpr=0.8676 | 7694.4 samples/s | 30.1 steps/s
[Step= 250] | Loss=5.11947 | acc=0.1392 | tpr=0.5406 | fpr=0.8681 | 7831.9 samples/s | 30.6 steps/s
[Step= 300] | Loss=5.11361 | acc=0.1395 | tpr=0.5331 | fpr=0.8676 | 8513.2 samples/s | 33.3 steps/s
[Step= 350] | Loss=5.11883 | acc=0.1393 | tpr=0.5285 | fpr=0.8677 | 8263.2 samples/s | 32.3 steps/s
[Step= 400] | Loss=5.11586 | acc=0.1398 | tpr=0.5295 | fpr=0.8673 | 7400.4 samples/s | 28.9 steps/s
[Step= 450] | Loss=5.11965 | acc=0.1395 | tpr=0.5365 | fpr=0.8677 | 8675.1 samples/s | 33.9 steps/s
[Step= 500] | Loss=5.12042 | acc=0.1393 | tpr=0.5370 | fpr=0.8679 | 8023.1 samples/s | 31.3 steps/s
[Step= 550] | Loss=5.12387 | acc=0.1394 | tpr=0.5360 | fpr=0.8678 | 9817.5 samples/s | 38.3 steps/s
Avg test loss: 5.12432, Avg test acc: 0.13929, Avg tpr: 0.53724, Avg fpr: 0.86794, total FA: 120512

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.07500 | acc=0.1465 | tpr=0.5398 | fpr=0.8606 | 6030.6 samples/s | 23.6 steps/s
[Step= 100] | Loss=5.06248 | acc=0.1507 | tpr=0.5437 | fpr=0.8566 | 7746.1 samples/s | 30.3 steps/s
[Step= 150] | Loss=5.05063 | acc=0.1534 | tpr=0.5591 | fpr=0.8541 | 7713.2 samples/s | 30.1 steps/s
[Step= 200] | Loss=5.04333 | acc=0.1538 | tpr=0.5530 | fpr=0.8535 | 7871.9 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.04595 | acc=0.1534 | tpr=0.5459 | fpr=0.8537 | 8157.4 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.04186 | acc=0.1529 | tpr=0.5367 | fpr=0.8541 | 7991.3 samples/s | 31.2 steps/s
[Step= 350] | Loss=5.04748 | acc=0.1527 | tpr=0.5329 | fpr=0.8542 | 7981.8 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.04499 | acc=0.1529 | tpr=0.5328 | fpr=0.8540 | 7789.9 samples/s | 30.4 steps/s
[Step= 450] | Loss=5.04752 | acc=0.1526 | tpr=0.5394 | fpr=0.8544 | 8462.7 samples/s | 33.1 steps/s
[Step= 500] | Loss=5.04868 | acc=0.1524 | tpr=0.5410 | fpr=0.8546 | 8511.9 samples/s | 33.2 steps/s
[Step= 550] | Loss=5.05295 | acc=0.1524 | tpr=0.5428 | fpr=0.8547 | 10043.5 samples/s | 39.2 steps/s
Avg test loss: 5.05335, Avg test acc: 0.15234, Avg tpr: 0.54358, Avg fpr: 0.85477, total FA: 118683

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.64110 | acc=0.1207 | tpr=0.6593 | fpr=0.8890 | 6101.1 samples/s | 23.8 steps/s
[Step= 100] | Loss=5.62805 | acc=0.1221 | tpr=0.6482 | fpr=0.8877 | 7349.3 samples/s | 28.7 steps/s
[Step= 150] | Loss=5.62002 | acc=0.1230 | tpr=0.6484 | fpr=0.8867 | 7982.8 samples/s | 31.2 steps/s
[Step= 200] | Loss=5.61284 | acc=0.1231 | tpr=0.6339 | fpr=0.8862 | 8069.4 samples/s | 31.5 steps/s
[Step= 250] | Loss=5.61807 | acc=0.1229 | tpr=0.6271 | fpr=0.8863 | 7614.6 samples/s | 29.7 steps/s
[Step= 300] | Loss=5.61392 | acc=0.1227 | tpr=0.6240 | fpr=0.8864 | 8376.2 samples/s | 32.7 steps/s
[Step= 350] | Loss=5.62123 | acc=0.1227 | tpr=0.6249 | fpr=0.8864 | 7915.8 samples/s | 30.9 steps/s
[Step= 400] | Loss=5.61986 | acc=0.1230 | tpr=0.6220 | fpr=0.8860 | 7987.2 samples/s | 31.2 steps/s
[Step= 450] | Loss=5.62562 | acc=0.1222 | tpr=0.6246 | fpr=0.8870 | 8460.4 samples/s | 33.0 steps/s
[Step= 500] | Loss=5.62439 | acc=0.1221 | tpr=0.6264 | fpr=0.8870 | 7807.7 samples/s | 30.5 steps/s
[Step= 550] | Loss=5.62761 | acc=0.1222 | tpr=0.6271 | fpr=0.8870 | 11103.5 samples/s | 43.4 steps/s
Avg test loss: 5.62816, Avg test acc: 0.12217, Avg tpr: 0.62837, Avg fpr: 0.88703, total FA: 123163

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.05178 | acc=0.1363 | tpr=0.6637 | fpr=0.8732 | 6016.1 samples/s | 23.5 steps/s
[Step= 100] | Loss=5.04754 | acc=0.1393 | tpr=0.6418 | fpr=0.8701 | 7273.6 samples/s | 28.4 steps/s
[Step= 150] | Loss=5.03675 | acc=0.1404 | tpr=0.6571 | fpr=0.8691 | 8673.6 samples/s | 33.9 steps/s
[Step= 200] | Loss=5.02760 | acc=0.1406 | tpr=0.6557 | fpr=0.8688 | 8033.6 samples/s | 31.4 steps/s
[Step= 250] | Loss=5.02934 | acc=0.1406 | tpr=0.6515 | fpr=0.8687 | 7893.0 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.02601 | acc=0.1402 | tpr=0.6458 | fpr=0.8690 | 7768.7 samples/s | 30.3 steps/s
[Step= 350] | Loss=5.03187 | acc=0.1400 | tpr=0.6456 | fpr=0.8692 | 8826.5 samples/s | 34.5 steps/s
[Step= 400] | Loss=5.03067 | acc=0.1404 | tpr=0.6444 | fpr=0.8688 | 8202.1 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.03590 | acc=0.1396 | tpr=0.6465 | fpr=0.8696 | 8090.3 samples/s | 31.6 steps/s
[Step= 500] | Loss=5.03519 | acc=0.1396 | tpr=0.6471 | fpr=0.8696 | 7846.8 samples/s | 30.7 steps/s
[Step= 550] | Loss=5.03981 | acc=0.1395 | tpr=0.6474 | fpr=0.8697 | 9420.6 samples/s | 36.8 steps/s
Avg test loss: 5.04066, Avg test acc: 0.13945, Avg tpr: 0.64857, Avg fpr: 0.86981, total FA: 120771

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.30104 | acc=0.1456 | tpr=0.5487 | fpr=0.8616 | 5985.3 samples/s | 23.4 steps/s
[Step= 100] | Loss=5.29144 | acc=0.1471 | tpr=0.5458 | fpr=0.8603 | 7687.8 samples/s | 30.0 steps/s
[Step= 150] | Loss=5.28142 | acc=0.1493 | tpr=0.5576 | fpr=0.8582 | 7564.8 samples/s | 29.5 steps/s
[Step= 200] | Loss=5.27441 | acc=0.1497 | tpr=0.5497 | fpr=0.8576 | 8275.6 samples/s | 32.3 steps/s
[Step= 250] | Loss=5.27647 | acc=0.1490 | tpr=0.5328 | fpr=0.8579 | 7727.0 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.27239 | acc=0.1488 | tpr=0.5258 | fpr=0.8580 | 7797.6 samples/s | 30.5 steps/s
[Step= 350] | Loss=5.28071 | acc=0.1487 | tpr=0.5229 | fpr=0.8581 | 7934.0 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.27695 | acc=0.1489 | tpr=0.5241 | fpr=0.8579 | 8203.1 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.28143 | acc=0.1486 | tpr=0.5282 | fpr=0.8583 | 7936.0 samples/s | 31.0 steps/s
[Step= 500] | Loss=5.28039 | acc=0.1489 | tpr=0.5304 | fpr=0.8579 | 8278.4 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.28340 | acc=0.1490 | tpr=0.5277 | fpr=0.8579 | 11806.3 samples/s | 46.1 steps/s
Avg test loss: 5.28420, Avg test acc: 0.14895, Avg tpr: 0.52853, Avg fpr: 0.85795, total FA: 119124

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.22670 | acc=0.9603 | tpr=0.9469 | fpr=0.0394 | 5827.8 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.23539 | acc=0.9592 | tpr=0.9552 | fpr=0.0407 | 7996.8 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.23832 | acc=0.9579 | tpr=0.9539 | fpr=0.0420 | 7874.8 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.23834 | acc=0.9579 | tpr=0.9563 | fpr=0.0420 | 8366.2 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.23809 | acc=0.9578 | tpr=0.9555 | fpr=0.0422 | 8094.8 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.24232 | acc=0.9573 | tpr=0.9527 | fpr=0.0427 | 8039.1 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.24032 | acc=0.9573 | tpr=0.9518 | fpr=0.0426 | 8267.4 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.24047 | acc=0.9570 | tpr=0.9497 | fpr=0.0428 | 7179.0 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.24443 | acc=0.9566 | tpr=0.9484 | fpr=0.0433 | 8050.4 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.24449 | acc=0.9564 | tpr=0.9493 | fpr=0.0435 | 8235.7 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.24284 | acc=0.9567 | tpr=0.9499 | fpr=0.0431 | 10735.7 samples/s | 41.9 steps/s
Avg test loss: 0.24248, Avg test acc: 0.95674, Avg tpr: 0.94968, Avg fpr: 0.04313, total FA: 5989

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.17467 | acc=0.9600 | tpr=0.8982 | fpr=0.0389 | 6098.5 samples/s | 23.8 steps/s
[Step= 100] | Loss=0.18251 | acc=0.9589 | tpr=0.9168 | fpr=0.0403 | 7483.3 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.18511 | acc=0.9573 | tpr=0.9179 | fpr=0.0420 | 8464.5 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.18541 | acc=0.9577 | tpr=0.9246 | fpr=0.0417 | 8059.6 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.18497 | acc=0.9579 | tpr=0.9266 | fpr=0.0416 | 7572.4 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.18784 | acc=0.9576 | tpr=0.9273 | fpr=0.0419 | 8057.3 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.18655 | acc=0.9576 | tpr=0.9286 | fpr=0.0419 | 7671.0 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.18731 | acc=0.9573 | tpr=0.9256 | fpr=0.0421 | 8695.9 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.19067 | acc=0.9568 | tpr=0.9255 | fpr=0.0427 | 8847.4 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.19008 | acc=0.9568 | tpr=0.9278 | fpr=0.0427 | 7567.2 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.18877 | acc=0.9570 | tpr=0.9288 | fpr=0.0424 | 9755.7 samples/s | 38.1 steps/s
Avg test loss: 0.18857, Avg test acc: 0.95705, Avg tpr: 0.92868, Avg fpr: 0.04243, total FA: 5892

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26324 | acc=0.9509 | tpr=0.9558 | fpr=0.0492 | 5755.4 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.27120 | acc=0.9499 | tpr=0.9595 | fpr=0.0503 | 7538.6 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.27608 | acc=0.9485 | tpr=0.9625 | fpr=0.0517 | 8164.7 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.27566 | acc=0.9487 | tpr=0.9650 | fpr=0.0516 | 8299.8 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.27554 | acc=0.9485 | tpr=0.9642 | fpr=0.0518 | 7889.7 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.27891 | acc=0.9481 | tpr=0.9615 | fpr=0.0521 | 8226.6 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.27690 | acc=0.9481 | tpr=0.9606 | fpr=0.0521 | 8554.7 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.27743 | acc=0.9478 | tpr=0.9568 | fpr=0.0524 | 8069.0 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.28118 | acc=0.9473 | tpr=0.9542 | fpr=0.0528 | 8211.7 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.28155 | acc=0.9472 | tpr=0.9551 | fpr=0.0529 | 7248.3 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.27979 | acc=0.9475 | tpr=0.9554 | fpr=0.0527 | 11712.7 samples/s | 45.8 steps/s
Avg test loss: 0.27948, Avg test acc: 0.94749, Avg tpr: 0.95523, Avg fpr: 0.05265, total FA: 7311

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14962 | acc=0.9655 | tpr=0.9292 | fpr=0.0339 | 5953.2 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.15530 | acc=0.9646 | tpr=0.9424 | fpr=0.0350 | 7952.6 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.15626 | acc=0.9629 | tpr=0.9438 | fpr=0.0368 | 7751.2 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.15585 | acc=0.9629 | tpr=0.9464 | fpr=0.0368 | 8574.3 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.15566 | acc=0.9628 | tpr=0.9467 | fpr=0.0369 | 7719.4 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.15865 | acc=0.9624 | tpr=0.9455 | fpr=0.0373 | 8367.8 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.15757 | acc=0.9624 | tpr=0.9430 | fpr=0.0372 | 7705.2 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.15771 | acc=0.9620 | tpr=0.9409 | fpr=0.0376 | 8214.4 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.16036 | acc=0.9615 | tpr=0.9401 | fpr=0.0381 | 8158.4 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.16003 | acc=0.9615 | tpr=0.9419 | fpr=0.0382 | 8504.9 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.15906 | acc=0.9616 | tpr=0.9423 | fpr=0.0380 | 9426.2 samples/s | 36.8 steps/s
Avg test loss: 0.15878, Avg test acc: 0.96163, Avg tpr: 0.94216, Avg fpr: 0.03801, total FA: 5278

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.23128 | acc=0.9577 | tpr=0.9381 | fpr=0.0419 | 5662.0 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.24061 | acc=0.9563 | tpr=0.9510 | fpr=0.0436 | 8459.0 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.24389 | acc=0.9546 | tpr=0.9568 | fpr=0.0455 | 8330.4 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.24450 | acc=0.9545 | tpr=0.9585 | fpr=0.0456 | 8044.4 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.24545 | acc=0.9543 | tpr=0.9563 | fpr=0.0458 | 8144.0 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.24912 | acc=0.9538 | tpr=0.9535 | fpr=0.0462 | 8163.8 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.24794 | acc=0.9537 | tpr=0.9530 | fpr=0.0462 | 7312.9 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.24821 | acc=0.9534 | tpr=0.9480 | fpr=0.0465 | 8025.8 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.25223 | acc=0.9530 | tpr=0.9464 | fpr=0.0469 | 8559.1 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.25217 | acc=0.9528 | tpr=0.9463 | fpr=0.0471 | 7934.8 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.25054 | acc=0.9531 | tpr=0.9471 | fpr=0.0467 | 10018.2 samples/s | 39.1 steps/s
Avg test loss: 0.25024, Avg test acc: 0.95317, Avg tpr: 0.94691, Avg fpr: 0.04672, total FA: 6487

server round 33/50

clients selected: [0 2 4 5 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=28001 Epoch=136.5] | Loss=0.01608 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.629 | L2-Norm(final)=12.175 | 6956.2 samples/s | 108.7 steps/s
[Step=28050 Epoch=136.8] | Loss=0.02210 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.629 | L2-Norm(final)=12.173 | 5021.4 samples/s | 78.5 steps/s
[Step=28100 Epoch=137.0] | Loss=0.02315 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=12.165 | 5577.2 samples/s | 87.1 steps/s
[Step=28150 Epoch=137.3] | Loss=0.02346 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=12.158 | 5426.9 samples/s | 84.8 steps/s
[Step=28200 Epoch=137.5] | Loss=0.02256 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=12.153 | 8790.2 samples/s | 137.3 steps/s
[Step=28250 Epoch=137.8] | Loss=0.02252 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=12.150 | 2650.2 samples/s | 41.4 steps/s
[Step=28300 Epoch=138.0] | Loss=0.02250 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=12.147 | 5579.8 samples/s | 87.2 steps/s
[Step=28350 Epoch=138.2] | Loss=0.02197 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.629 | L2-Norm(final)=12.146 | 5530.1 samples/s | 86.4 steps/s
[Step=28400 Epoch=138.5] | Loss=0.02222 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.629 | L2-Norm(final)=12.143 | 7658.3 samples/s | 119.7 steps/s
[Step=28450 Epoch=138.7] | Loss=0.02186 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.629 | L2-Norm(final)=12.141 | 2772.4 samples/s | 43.3 steps/s
[Step=28500 Epoch=139.0] | Loss=0.02220 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=12.139 | 5716.3 samples/s | 89.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=28501 Epoch=139.0] | Loss=0.00727 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=12.116 | 7376.7 samples/s | 115.3 steps/s
[Step=28550 Epoch=139.2] | Loss=0.02190 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.645 | L2-Norm(final)=12.115 | 4188.2 samples/s | 65.4 steps/s
[Step=28600 Epoch=139.5] | Loss=0.02161 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.663 | L2-Norm(final)=12.117 | 4769.6 samples/s | 74.5 steps/s
[Step=28650 Epoch=139.7] | Loss=0.01861 | Reg=0.00114 | acc=0.9844 | L2-Norm=10.679 | L2-Norm(final)=12.119 | 4802.0 samples/s | 75.0 steps/s
[Step=28700 Epoch=139.9] | Loss=0.01817 | Reg=0.00114 | acc=0.9844 | L2-Norm=10.692 | L2-Norm(final)=12.121 | 6750.1 samples/s | 105.5 steps/s
[Step=28750 Epoch=140.2] | Loss=0.01578 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.702 | L2-Norm(final)=12.123 | 2481.3 samples/s | 38.8 steps/s
[Step=28800 Epoch=140.4] | Loss=0.01402 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.711 | L2-Norm(final)=12.127 | 4702.0 samples/s | 73.5 steps/s
[Step=28850 Epoch=140.7] | Loss=0.01295 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.720 | L2-Norm(final)=12.131 | 4854.0 samples/s | 75.8 steps/s
[Step=28900 Epoch=140.9] | Loss=0.01234 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.727 | L2-Norm(final)=12.135 | 6107.4 samples/s | 95.4 steps/s
[Step=28950 Epoch=141.2] | Loss=0.01137 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.733 | L2-Norm(final)=12.138 | 2590.0 samples/s | 40.5 steps/s
[Step=29000 Epoch=141.4] | Loss=0.01057 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.740 | L2-Norm(final)=12.142 | 4665.1 samples/s | 72.9 steps/s
[Step=29050 Epoch=141.7] | Loss=0.01010 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.746 | L2-Norm(final)=12.146 | 4793.4 samples/s | 74.9 steps/s
[Step=29100 Epoch=141.9] | Loss=0.00970 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.751 | L2-Norm(final)=12.150 | 5649.3 samples/s | 88.3 steps/s
[Step=29150 Epoch=142.1] | Loss=0.00924 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.756 | L2-Norm(final)=12.153 | 2682.9 samples/s | 41.9 steps/s
[Step=29200 Epoch=142.4] | Loss=0.00884 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.761 | L2-Norm(final)=12.157 | 4748.5 samples/s | 74.2 steps/s
[Step=29250 Epoch=142.6] | Loss=0.00860 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.765 | L2-Norm(final)=12.160 | 4772.3 samples/s | 74.6 steps/s
[Step=29300 Epoch=142.9] | Loss=0.00822 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=12.163 | 5256.4 samples/s | 82.1 steps/s
[Step=29350 Epoch=143.1] | Loss=0.00796 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.773 | L2-Norm(final)=12.166 | 2790.3 samples/s | 43.6 steps/s
[Step=29400 Epoch=143.4] | Loss=0.00769 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.777 | L2-Norm(final)=12.170 | 4730.8 samples/s | 73.9 steps/s
[Step=29450 Epoch=143.6] | Loss=0.00748 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.781 | L2-Norm(final)=12.173 | 4892.6 samples/s | 76.4 steps/s
[Step=29500 Epoch=143.8] | Loss=0.00730 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.785 | L2-Norm(final)=12.176 | 4755.1 samples/s | 74.3 steps/s
[Step=29550 Epoch=144.1] | Loss=0.00712 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.788 | L2-Norm(final)=12.179 | 2885.8 samples/s | 45.1 steps/s
[Step=29600 Epoch=144.3] | Loss=0.00692 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.791 | L2-Norm(final)=12.181 | 4807.2 samples/s | 75.1 steps/s
[Step=29650 Epoch=144.6] | Loss=0.00682 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.795 | L2-Norm(final)=12.184 | 4709.3 samples/s | 73.6 steps/s
[Step=29700 Epoch=144.8] | Loss=0.00670 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.798 | L2-Norm(final)=12.187 | 4781.0 samples/s | 74.7 steps/s
[Step=29750 Epoch=145.1] | Loss=0.00662 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.801 | L2-Norm(final)=12.190 | 2970.5 samples/s | 46.4 steps/s
[Step=29800 Epoch=145.3] | Loss=0.00658 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.804 | L2-Norm(final)=12.192 | 4694.9 samples/s | 73.4 steps/s
[Step=29850 Epoch=145.6] | Loss=0.00641 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.806 | L2-Norm(final)=12.195 | 4854.4 samples/s | 75.8 steps/s
[Step=29900 Epoch=145.8] | Loss=0.00633 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.809 | L2-Norm(final)=12.197 | 4678.0 samples/s | 73.1 steps/s
[Step=29950 Epoch=146.0] | Loss=0.00619 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.812 | L2-Norm(final)=12.199 | 2935.6 samples/s | 45.9 steps/s
[Step=30000 Epoch=146.3] | Loss=0.00607 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.814 | L2-Norm(final)=12.202 | 4747.7 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step30000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=165.7] | Loss=0.01594 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.629 | L2-Norm(final)=13.113 | 7043.6 samples/s | 110.1 steps/s
[Step=34050 Epoch=165.9] | Loss=0.01590 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=13.118 | 4958.9 samples/s | 77.5 steps/s
[Step=34100 Epoch=166.2] | Loss=0.01682 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=13.125 | 5644.9 samples/s | 88.2 steps/s
[Step=34150 Epoch=166.4] | Loss=0.01804 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=13.129 | 5494.6 samples/s | 85.9 steps/s
[Step=34200 Epoch=166.6] | Loss=0.01851 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.629 | L2-Norm(final)=13.130 | 8525.6 samples/s | 133.2 steps/s
[Step=34250 Epoch=166.9] | Loss=0.01866 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.629 | L2-Norm(final)=13.132 | 2685.0 samples/s | 42.0 steps/s
[Step=34300 Epoch=167.1] | Loss=0.01826 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.629 | L2-Norm(final)=13.133 | 5522.8 samples/s | 86.3 steps/s
[Step=34350 Epoch=167.4] | Loss=0.01798 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.629 | L2-Norm(final)=13.135 | 5567.5 samples/s | 87.0 steps/s
[Step=34400 Epoch=167.6] | Loss=0.01810 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.629 | L2-Norm(final)=13.137 | 7652.3 samples/s | 119.6 steps/s
[Step=34450 Epoch=167.9] | Loss=0.01805 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=13.139 | 2794.5 samples/s | 43.7 steps/s
[Step=34500 Epoch=168.1] | Loss=0.01775 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.629 | L2-Norm(final)=13.141 | 5574.7 samples/s | 87.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=168.1] | Loss=0.00396 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=13.160 | 7272.2 samples/s | 113.6 steps/s
[Step=34550 Epoch=168.3] | Loss=0.01767 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.643 | L2-Norm(final)=13.161 | 4272.5 samples/s | 66.8 steps/s
[Step=34600 Epoch=168.6] | Loss=0.01623 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.658 | L2-Norm(final)=13.162 | 4737.3 samples/s | 74.0 steps/s
[Step=34650 Epoch=168.8] | Loss=0.01664 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.668 | L2-Norm(final)=13.162 | 4798.6 samples/s | 75.0 steps/s
[Step=34700 Epoch=169.1] | Loss=0.01657 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.677 | L2-Norm(final)=13.164 | 6879.1 samples/s | 107.5 steps/s
[Step=34750 Epoch=169.3] | Loss=0.01504 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.685 | L2-Norm(final)=13.166 | 2484.3 samples/s | 38.8 steps/s
[Step=34800 Epoch=169.6] | Loss=0.01387 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.693 | L2-Norm(final)=13.169 | 4789.8 samples/s | 74.8 steps/s
[Step=34850 Epoch=169.8] | Loss=0.01262 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.699 | L2-Norm(final)=13.172 | 4744.8 samples/s | 74.1 steps/s
[Step=34900 Epoch=170.0] | Loss=0.01203 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.706 | L2-Norm(final)=13.175 | 6220.3 samples/s | 97.2 steps/s
[Step=34950 Epoch=170.3] | Loss=0.01106 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.711 | L2-Norm(final)=13.178 | 2601.5 samples/s | 40.6 steps/s
[Step=35000 Epoch=170.5] | Loss=0.01042 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.716 | L2-Norm(final)=13.181 | 4681.0 samples/s | 73.1 steps/s
[Step=35050 Epoch=170.8] | Loss=0.00984 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.721 | L2-Norm(final)=13.184 | 4742.8 samples/s | 74.1 steps/s
[Step=35100 Epoch=171.0] | Loss=0.00953 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.726 | L2-Norm(final)=13.187 | 5720.4 samples/s | 89.4 steps/s
[Step=35150 Epoch=171.3] | Loss=0.00911 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=13.190 | 2684.0 samples/s | 41.9 steps/s
[Step=35200 Epoch=171.5] | Loss=0.00873 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.734 | L2-Norm(final)=13.193 | 4795.0 samples/s | 74.9 steps/s
[Step=35250 Epoch=171.8] | Loss=0.00846 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.738 | L2-Norm(final)=13.195 | 4791.2 samples/s | 74.9 steps/s
[Step=35300 Epoch=172.0] | Loss=0.00814 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.741 | L2-Norm(final)=13.198 | 5228.5 samples/s | 81.7 steps/s
[Step=35350 Epoch=172.2] | Loss=0.00787 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.745 | L2-Norm(final)=13.200 | 2807.6 samples/s | 43.9 steps/s
[Step=35400 Epoch=172.5] | Loss=0.00760 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.748 | L2-Norm(final)=13.203 | 4699.4 samples/s | 73.4 steps/s
[Step=35450 Epoch=172.7] | Loss=0.00737 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.751 | L2-Norm(final)=13.206 | 4735.6 samples/s | 74.0 steps/s
[Step=35500 Epoch=173.0] | Loss=0.00720 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.754 | L2-Norm(final)=13.208 | 4907.8 samples/s | 76.7 steps/s
[Step=35550 Epoch=173.2] | Loss=0.00704 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.757 | L2-Norm(final)=13.210 | 2904.7 samples/s | 45.4 steps/s
[Step=35600 Epoch=173.5] | Loss=0.00684 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.760 | L2-Norm(final)=13.213 | 4873.2 samples/s | 76.1 steps/s
[Step=35650 Epoch=173.7] | Loss=0.00663 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.763 | L2-Norm(final)=13.215 | 4693.0 samples/s | 73.3 steps/s
[Step=35700 Epoch=173.9] | Loss=0.00649 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.765 | L2-Norm(final)=13.218 | 4764.2 samples/s | 74.4 steps/s
[Step=35750 Epoch=174.2] | Loss=0.00637 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.768 | L2-Norm(final)=13.220 | 2966.5 samples/s | 46.4 steps/s
[Step=35800 Epoch=174.4] | Loss=0.00625 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.771 | L2-Norm(final)=13.223 | 4746.8 samples/s | 74.2 steps/s
[Step=35850 Epoch=174.7] | Loss=0.00611 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.773 | L2-Norm(final)=13.225 | 4746.0 samples/s | 74.2 steps/s
[Step=35900 Epoch=174.9] | Loss=0.00598 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.775 | L2-Norm(final)=13.227 | 4777.0 samples/s | 74.6 steps/s
[Step=35950 Epoch=175.2] | Loss=0.00590 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.778 | L2-Norm(final)=13.229 | 2928.3 samples/s | 45.8 steps/s
[Step=36000 Epoch=175.4] | Loss=0.00580 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.780 | L2-Norm(final)=13.232 | 4779.6 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step36000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=30001 Epoch=147.1] | Loss=0.00306 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=14.072 | 6646.5 samples/s | 103.9 steps/s
[Step=30050 Epoch=147.4] | Loss=0.01712 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.629 | L2-Norm(final)=14.072 | 4989.6 samples/s | 78.0 steps/s
[Step=30100 Epoch=147.6] | Loss=0.01815 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=14.074 | 5679.9 samples/s | 88.7 steps/s
[Step=30150 Epoch=147.9] | Loss=0.01847 | Reg=0.00113 | acc=0.9375 | L2-Norm=10.629 | L2-Norm(final)=14.074 | 5427.3 samples/s | 84.8 steps/s
[Step=30200 Epoch=148.1] | Loss=0.01867 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=14.074 | 8981.2 samples/s | 140.3 steps/s
[Step=30250 Epoch=148.3] | Loss=0.01886 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.629 | L2-Norm(final)=14.075 | 2644.5 samples/s | 41.3 steps/s
[Step=30300 Epoch=148.6] | Loss=0.01921 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=14.074 | 5526.5 samples/s | 86.4 steps/s
[Step=30350 Epoch=148.8] | Loss=0.01913 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.629 | L2-Norm(final)=14.073 | 5548.7 samples/s | 86.7 steps/s
[Step=30400 Epoch=149.1] | Loss=0.01868 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=14.073 | 8157.5 samples/s | 127.5 steps/s
[Step=30450 Epoch=149.3] | Loss=0.01885 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.629 | L2-Norm(final)=14.074 | 2694.2 samples/s | 42.1 steps/s
[Step=30500 Epoch=149.6] | Loss=0.01862 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=14.074 | 5618.6 samples/s | 87.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=149.6] | Loss=0.01622 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.629 | L2-Norm(final)=14.080 | 7050.4 samples/s | 110.2 steps/s
[Step=30550 Epoch=149.8] | Loss=0.02543 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.646 | L2-Norm(final)=14.076 | 4327.1 samples/s | 67.6 steps/s
[Step=30600 Epoch=150.1] | Loss=0.02139 | Reg=0.00114 | acc=0.9844 | L2-Norm=10.664 | L2-Norm(final)=14.074 | 4713.4 samples/s | 73.6 steps/s
[Step=30650 Epoch=150.3] | Loss=0.01892 | Reg=0.00114 | acc=0.9688 | L2-Norm=10.676 | L2-Norm(final)=14.076 | 4777.5 samples/s | 74.6 steps/s
[Step=30700 Epoch=150.5] | Loss=0.01748 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.687 | L2-Norm(final)=14.078 | 7077.3 samples/s | 110.6 steps/s
[Step=30750 Epoch=150.8] | Loss=0.01527 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.696 | L2-Norm(final)=14.081 | 2441.7 samples/s | 38.2 steps/s
[Step=30800 Epoch=151.0] | Loss=0.01363 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=14.084 | 4813.7 samples/s | 75.2 steps/s
[Step=30850 Epoch=151.3] | Loss=0.01254 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.712 | L2-Norm(final)=14.088 | 4698.9 samples/s | 73.4 steps/s
[Step=30900 Epoch=151.5] | Loss=0.01153 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.718 | L2-Norm(final)=14.091 | 6560.6 samples/s | 102.5 steps/s
[Step=30950 Epoch=151.8] | Loss=0.01071 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.724 | L2-Norm(final)=14.094 | 2513.0 samples/s | 39.3 steps/s
[Step=31000 Epoch=152.0] | Loss=0.01001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.729 | L2-Norm(final)=14.098 | 4736.5 samples/s | 74.0 steps/s
[Step=31050 Epoch=152.3] | Loss=0.00942 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.734 | L2-Norm(final)=14.101 | 4740.7 samples/s | 74.1 steps/s
[Step=31100 Epoch=152.5] | Loss=0.00887 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.738 | L2-Norm(final)=14.104 | 6238.0 samples/s | 97.5 steps/s
[Step=31150 Epoch=152.8] | Loss=0.00844 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.742 | L2-Norm(final)=14.107 | 2566.3 samples/s | 40.1 steps/s
[Step=31200 Epoch=153.0] | Loss=0.00804 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.746 | L2-Norm(final)=14.110 | 4791.6 samples/s | 74.9 steps/s
[Step=31250 Epoch=153.2] | Loss=0.00771 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.750 | L2-Norm(final)=14.113 | 4755.8 samples/s | 74.3 steps/s
[Step=31300 Epoch=153.5] | Loss=0.00743 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.754 | L2-Norm(final)=14.116 | 5814.8 samples/s | 90.9 steps/s
[Step=31350 Epoch=153.7] | Loss=0.00717 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.757 | L2-Norm(final)=14.119 | 2640.6 samples/s | 41.3 steps/s
[Step=31400 Epoch=154.0] | Loss=0.00695 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.760 | L2-Norm(final)=14.122 | 4761.3 samples/s | 74.4 steps/s
[Step=31450 Epoch=154.2] | Loss=0.00674 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.763 | L2-Norm(final)=14.124 | 4812.9 samples/s | 75.2 steps/s
[Step=31500 Epoch=154.5] | Loss=0.00660 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.766 | L2-Norm(final)=14.127 | 5454.8 samples/s | 85.2 steps/s
[Step=31550 Epoch=154.7] | Loss=0.00638 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=14.129 | 2697.2 samples/s | 42.1 steps/s
[Step=31600 Epoch=155.0] | Loss=0.00621 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.772 | L2-Norm(final)=14.132 | 4818.4 samples/s | 75.3 steps/s
[Step=31650 Epoch=155.2] | Loss=0.00609 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.774 | L2-Norm(final)=14.134 | 4662.0 samples/s | 72.8 steps/s
[Step=31700 Epoch=155.5] | Loss=0.00597 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.777 | L2-Norm(final)=14.136 | 5233.8 samples/s | 81.8 steps/s
[Step=31750 Epoch=155.7] | Loss=0.00582 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.779 | L2-Norm(final)=14.139 | 2771.0 samples/s | 43.3 steps/s
[Step=31800 Epoch=155.9] | Loss=0.00571 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.782 | L2-Norm(final)=14.141 | 4752.1 samples/s | 74.3 steps/s
[Step=31850 Epoch=156.2] | Loss=0.00559 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.784 | L2-Norm(final)=14.143 | 4791.5 samples/s | 74.9 steps/s
[Step=31900 Epoch=156.4] | Loss=0.00547 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.787 | L2-Norm(final)=14.146 | 4920.6 samples/s | 76.9 steps/s
[Step=31950 Epoch=156.7] | Loss=0.00538 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.789 | L2-Norm(final)=14.148 | 2898.5 samples/s | 45.3 steps/s
[Step=32000 Epoch=156.9] | Loss=0.00525 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.791 | L2-Norm(final)=14.150 | 4664.3 samples/s | 72.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step32000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=46001 Epoch=435.9] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=17.800 | 7432.7 samples/s | 116.1 steps/s
[Step=46050 Epoch=436.4] | Loss=0.00006 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.625 | L2-Norm(final)=17.800 | 4327.9 samples/s | 67.6 steps/s
[Step=46100 Epoch=436.8] | Loss=0.00010 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=17.806 | 8264.5 samples/s | 129.1 steps/s
[Step=46150 Epoch=437.3] | Loss=0.00012 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=17.816 | 2581.0 samples/s | 40.3 steps/s
[Step=46200 Epoch=437.8] | Loss=0.00011 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=17.823 | 7317.7 samples/s | 114.3 steps/s
[Step=46250 Epoch=438.3] | Loss=0.00011 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=17.829 | 2661.7 samples/s | 41.6 steps/s
[Step=46300 Epoch=438.7] | Loss=0.00011 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=17.835 | 6511.1 samples/s | 101.7 steps/s
[Step=46350 Epoch=439.2] | Loss=0.00010 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=17.840 | 2841.2 samples/s | 44.4 steps/s
[Step=46400 Epoch=439.7] | Loss=0.00010 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=17.845 | 5711.7 samples/s | 89.2 steps/s
[Step=46450 Epoch=440.2] | Loss=0.00010 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=17.850 | 2944.9 samples/s | 46.0 steps/s
[Step=46500 Epoch=440.6] | Loss=0.00010 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=17.854 | 5342.6 samples/s | 83.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=46501 Epoch=440.6] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=17.897 | 7441.8 samples/s | 116.3 steps/s
[Step=46550 Epoch=441.1] | Loss=0.00003 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.606 | L2-Norm(final)=17.900 | 3911.3 samples/s | 61.1 steps/s
[Step=46600 Epoch=441.6] | Loss=0.00003 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.585 | L2-Norm(final)=17.901 | 6616.1 samples/s | 103.4 steps/s
[Step=46650 Epoch=442.0] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.567 | L2-Norm(final)=17.902 | 2407.3 samples/s | 37.6 steps/s
[Step=46700 Epoch=442.5] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.548 | L2-Norm(final)=17.903 | 5851.7 samples/s | 91.4 steps/s
[Step=46750 Epoch=443.0] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.528 | L2-Norm(final)=17.903 | 2485.8 samples/s | 38.8 steps/s
[Step=46800 Epoch=443.5] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.508 | L2-Norm(final)=17.903 | 5418.1 samples/s | 84.7 steps/s
[Step=46850 Epoch=443.9] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.489 | L2-Norm(final)=17.904 | 2552.4 samples/s | 39.9 steps/s
[Step=46900 Epoch=444.4] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.469 | L2-Norm(final)=17.904 | 5012.5 samples/s | 78.3 steps/s
[Step=46950 Epoch=444.9] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.450 | L2-Norm(final)=17.904 | 2702.0 samples/s | 42.2 steps/s
[Step=47000 Epoch=445.4] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.431 | L2-Norm(final)=17.904 | 4663.8 samples/s | 72.9 steps/s
[Step=47050 Epoch=445.8] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.412 | L2-Norm(final)=17.905 | 2785.6 samples/s | 43.5 steps/s
[Step=47100 Epoch=446.3] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.393 | L2-Norm(final)=17.905 | 4561.9 samples/s | 71.3 steps/s
[Step=47150 Epoch=446.8] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.374 | L2-Norm(final)=17.905 | 2858.6 samples/s | 44.7 steps/s
[Step=47200 Epoch=447.3] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.355 | L2-Norm(final)=17.905 | 4441.5 samples/s | 69.4 steps/s
[Step=47250 Epoch=447.7] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.336 | L2-Norm(final)=17.905 | 2806.2 samples/s | 43.8 steps/s
[Step=47300 Epoch=448.2] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.318 | L2-Norm(final)=17.905 | 4605.2 samples/s | 72.0 steps/s
[Step=47350 Epoch=448.7] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.299 | L2-Norm(final)=17.906 | 2930.1 samples/s | 45.8 steps/s
[Step=47400 Epoch=449.2] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.280 | L2-Norm(final)=17.906 | 4369.2 samples/s | 68.3 steps/s
[Step=47450 Epoch=449.6] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.262 | L2-Norm(final)=17.906 | 6457.7 samples/s | 100.9 steps/s
[Step=47500 Epoch=450.1] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=17.906 | 2338.0 samples/s | 36.5 steps/s
[Step=47550 Epoch=450.6] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.225 | L2-Norm(final)=17.906 | 6201.4 samples/s | 96.9 steps/s
[Step=47600 Epoch=451.1] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.206 | L2-Norm(final)=17.906 | 2469.2 samples/s | 38.6 steps/s
[Step=47650 Epoch=451.5] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.187 | L2-Norm(final)=17.907 | 5506.1 samples/s | 86.0 steps/s
[Step=47700 Epoch=452.0] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.169 | L2-Norm(final)=17.907 | 2571.1 samples/s | 40.2 steps/s
[Step=47750 Epoch=452.5] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.150 | L2-Norm(final)=17.907 | 5121.2 samples/s | 80.0 steps/s
[Step=47800 Epoch=452.9] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.131 | L2-Norm(final)=17.907 | 2659.8 samples/s | 41.6 steps/s
[Step=47850 Epoch=453.4] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.113 | L2-Norm(final)=17.907 | 4769.4 samples/s | 74.5 steps/s
[Step=47900 Epoch=453.9] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.094 | L2-Norm(final)=17.908 | 2768.2 samples/s | 43.3 steps/s
[Step=47950 Epoch=454.4] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.075 | L2-Norm(final)=17.908 | 4586.7 samples/s | 71.7 steps/s
[Step=48000 Epoch=454.8] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.056 | L2-Norm(final)=17.908 | 2834.8 samples/s | 44.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step48000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=301.5] | Loss=0.00009 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=15.336 | 6745.0 samples/s | 105.4 steps/s
[Step=32050 Epoch=302.0] | Loss=0.00062 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=15.346 | 4614.7 samples/s | 72.1 steps/s
[Step=32100 Epoch=302.5] | Loss=0.00085 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=15.363 | 8041.2 samples/s | 125.6 steps/s
[Step=32150 Epoch=302.9] | Loss=0.00087 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=15.378 | 2563.4 samples/s | 40.1 steps/s
[Step=32200 Epoch=303.4] | Loss=0.00077 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=15.390 | 7188.8 samples/s | 112.3 steps/s
[Step=32250 Epoch=303.9] | Loss=0.00074 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=15.400 | 2707.5 samples/s | 42.3 steps/s
[Step=32300 Epoch=304.4] | Loss=0.00077 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=15.409 | 6109.4 samples/s | 95.5 steps/s
[Step=32350 Epoch=304.8] | Loss=0.00080 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=15.418 | 2853.6 samples/s | 44.6 steps/s
[Step=32400 Epoch=305.3] | Loss=0.00078 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=15.427 | 5600.6 samples/s | 87.5 steps/s
[Step=32450 Epoch=305.8] | Loss=0.00072 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=15.435 | 3136.1 samples/s | 49.0 steps/s
[Step=32500 Epoch=306.2] | Loss=0.00076 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=15.443 | 4959.2 samples/s | 77.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=306.3] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=15.518 | 6799.9 samples/s | 106.2 steps/s
[Step=32550 Epoch=306.7] | Loss=0.00041 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=15.521 | 4138.4 samples/s | 64.7 steps/s
[Step=32600 Epoch=307.2] | Loss=0.00063 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.642 | L2-Norm(final)=15.522 | 6355.6 samples/s | 99.3 steps/s
[Step=32650 Epoch=307.7] | Loss=0.00047 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.652 | L2-Norm(final)=15.522 | 2398.2 samples/s | 37.5 steps/s
[Step=32700 Epoch=308.1] | Loss=0.00036 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.657 | L2-Norm(final)=15.523 | 5792.4 samples/s | 90.5 steps/s
[Step=32750 Epoch=308.6] | Loss=0.00029 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.658 | L2-Norm(final)=15.523 | 2529.9 samples/s | 39.5 steps/s
[Step=32800 Epoch=309.1] | Loss=0.00024 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.657 | L2-Norm(final)=15.524 | 5216.3 samples/s | 81.5 steps/s
[Step=32850 Epoch=309.5] | Loss=0.00021 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.656 | L2-Norm(final)=15.524 | 2647.4 samples/s | 41.4 steps/s
[Step=32900 Epoch=310.0] | Loss=0.00019 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.654 | L2-Norm(final)=15.524 | 4750.1 samples/s | 74.2 steps/s
[Step=32950 Epoch=310.5] | Loss=0.00017 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.651 | L2-Norm(final)=15.525 | 2801.9 samples/s | 43.8 steps/s
[Step=33000 Epoch=311.0] | Loss=0.00015 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.648 | L2-Norm(final)=15.525 | 4489.7 samples/s | 70.2 steps/s
[Step=33050 Epoch=311.4] | Loss=0.00014 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.645 | L2-Norm(final)=15.525 | 2873.1 samples/s | 44.9 steps/s
[Step=33100 Epoch=311.9] | Loss=0.00013 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.641 | L2-Norm(final)=15.525 | 4508.2 samples/s | 70.4 steps/s
[Step=33150 Epoch=312.4] | Loss=0.00012 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.638 | L2-Norm(final)=15.526 | 2857.2 samples/s | 44.6 steps/s
[Step=33200 Epoch=312.8] | Loss=0.00011 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.634 | L2-Norm(final)=15.526 | 4612.6 samples/s | 72.1 steps/s
[Step=33250 Epoch=313.3] | Loss=0.00010 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.630 | L2-Norm(final)=15.526 | 2977.2 samples/s | 46.5 steps/s
[Step=33300 Epoch=313.8] | Loss=0.00009 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=15.526 | 4214.4 samples/s | 65.9 steps/s
[Step=33350 Epoch=314.3] | Loss=0.00009 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.622 | L2-Norm(final)=15.526 | 6576.1 samples/s | 102.8 steps/s
[Step=33400 Epoch=314.7] | Loss=0.00008 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.618 | L2-Norm(final)=15.527 | 2376.8 samples/s | 37.1 steps/s
[Step=33450 Epoch=315.2] | Loss=0.00008 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.614 | L2-Norm(final)=15.527 | 5877.5 samples/s | 91.8 steps/s
[Step=33500 Epoch=315.7] | Loss=0.00008 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.610 | L2-Norm(final)=15.527 | 2495.7 samples/s | 39.0 steps/s
[Step=33550 Epoch=316.1] | Loss=0.00007 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.606 | L2-Norm(final)=15.527 | 5328.3 samples/s | 83.3 steps/s
[Step=33600 Epoch=316.6] | Loss=0.00007 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.602 | L2-Norm(final)=15.527 | 2615.0 samples/s | 40.9 steps/s
[Step=33650 Epoch=317.1] | Loss=0.00007 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.597 | L2-Norm(final)=15.528 | 4865.2 samples/s | 76.0 steps/s
[Step=33700 Epoch=317.6] | Loss=0.00006 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.593 | L2-Norm(final)=15.528 | 2786.8 samples/s | 43.5 steps/s
[Step=33750 Epoch=318.0] | Loss=0.00006 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.589 | L2-Norm(final)=15.528 | 4471.9 samples/s | 69.9 steps/s
[Step=33800 Epoch=318.5] | Loss=0.00006 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.584 | L2-Norm(final)=15.528 | 2852.5 samples/s | 44.6 steps/s
[Step=33850 Epoch=319.0] | Loss=0.00006 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.580 | L2-Norm(final)=15.528 | 4528.4 samples/s | 70.8 steps/s
[Step=33900 Epoch=319.4] | Loss=0.00006 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.575 | L2-Norm(final)=15.528 | 2898.4 samples/s | 45.3 steps/s
[Step=33950 Epoch=319.9] | Loss=0.00005 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.571 | L2-Norm(final)=15.529 | 4421.2 samples/s | 69.1 steps/s
[Step=34000 Epoch=320.4] | Loss=0.00005 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.566 | L2-Norm(final)=15.529 | 2963.9 samples/s | 46.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step34000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08112 | acc=0.9638 | tpr=0.9709 | fpr=0.0515 | 5650.4 samples/s | 22.1 steps/s
Avg test loss: 0.08744, Avg test acc: 0.96085, Avg tpr: 0.96864, Avg fpr: 0.05627, total FA: 439

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09139 | acc=0.9638 | tpr=0.9750 | fpr=0.0605 | 6051.0 samples/s | 23.6 steps/s
Avg test loss: 0.09545, Avg test acc: 0.96202, Avg tpr: 0.97255, Avg fpr: 0.06115, total FA: 477

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09038 | acc=0.9620 | tpr=0.9700 | fpr=0.0555 | 5849.4 samples/s | 22.8 steps/s
Avg test loss: 0.09484, Avg test acc: 0.95985, Avg tpr: 0.96689, Avg fpr: 0.05563, total FA: 434

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08881 | acc=0.9612 | tpr=0.9752 | fpr=0.0694 | 5806.3 samples/s | 22.7 steps/s
Avg test loss: 0.09313, Avg test acc: 0.96045, Avg tpr: 0.97465, Avg fpr: 0.07076, total FA: 552

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08978 | acc=0.9630 | tpr=0.9758 | fpr=0.0647 | 6026.8 samples/s | 23.5 steps/s
Avg test loss: 0.09203, Avg test acc: 0.96214, Avg tpr: 0.97400, Avg fpr: 0.06397, total FA: 499

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.15333 | acc=0.2744 | tpr=0.0207 | fpr=0.1747 | 5865.5 samples/s | 22.9 steps/s
Avg test loss: 6.16075, Avg test acc: 0.27302, Avg tpr: 0.01947, Avg fpr: 0.16934, total FA: 1321

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.87335 | acc=0.3091 | tpr=0.0227 | fpr=0.0691 | 6041.6 samples/s | 23.6 steps/s
Avg test loss: 4.88463, Avg test acc: 0.30599, Avg tpr: 0.02209, Avg fpr: 0.06961, total FA: 543

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.01280 | acc=0.2854 | tpr=0.0244 | fpr=0.1479 | 5881.4 samples/s | 23.0 steps/s
Avg test loss: 5.02175, Avg test acc: 0.28480, Avg tpr: 0.02343, Avg fpr: 0.14037, total FA: 1095

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.53167 | acc=0.2843 | tpr=0.0286 | fpr=0.1606 | 6020.8 samples/s | 23.5 steps/s
Avg test loss: 5.53864, Avg test acc: 0.28384, Avg tpr: 0.02763, Avg fpr: 0.15267, total FA: 1191

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.09700 | acc=0.2890 | tpr=0.0187 | fpr=0.1241 | 5835.5 samples/s | 22.8 steps/s
Avg test loss: 5.11268, Avg test acc: 0.28812, Avg tpr: 0.01842, Avg fpr: 0.11870, total FA: 926

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.17688 | acc=0.1372 | tpr=0.6239 | fpr=0.8716 | 5871.5 samples/s | 22.9 steps/s
[Step= 100] | Loss=5.16090 | acc=0.1398 | tpr=0.6077 | fpr=0.8690 | 7455.9 samples/s | 29.1 steps/s
[Step= 150] | Loss=5.14960 | acc=0.1422 | tpr=0.6138 | fpr=0.8665 | 8064.8 samples/s | 31.5 steps/s
[Step= 200] | Loss=5.14045 | acc=0.1422 | tpr=0.6033 | fpr=0.8662 | 8006.6 samples/s | 31.3 steps/s
[Step= 250] | Loss=5.14414 | acc=0.1420 | tpr=0.5921 | fpr=0.8662 | 8280.6 samples/s | 32.3 steps/s
[Step= 300] | Loss=5.13712 | acc=0.1425 | tpr=0.5833 | fpr=0.8655 | 8074.4 samples/s | 31.5 steps/s
[Step= 350] | Loss=5.14256 | acc=0.1424 | tpr=0.5817 | fpr=0.8656 | 7410.4 samples/s | 28.9 steps/s
[Step= 400] | Loss=5.13955 | acc=0.1427 | tpr=0.5766 | fpr=0.8652 | 8207.2 samples/s | 32.1 steps/s
[Step= 450] | Loss=5.14292 | acc=0.1423 | tpr=0.5808 | fpr=0.8657 | 8413.1 samples/s | 32.9 steps/s
[Step= 500] | Loss=5.14279 | acc=0.1422 | tpr=0.5828 | fpr=0.8658 | 7943.7 samples/s | 31.0 steps/s
[Step= 550] | Loss=5.14636 | acc=0.1422 | tpr=0.5846 | fpr=0.8659 | 11191.8 samples/s | 43.7 steps/s
Avg test loss: 5.14674, Avg test acc: 0.14214, Avg tpr: 0.58558, Avg fpr: 0.86592, total FA: 120231

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.07500 | acc=0.1465 | tpr=0.5398 | fpr=0.8606 | 6084.4 samples/s | 23.8 steps/s
[Step= 100] | Loss=5.06248 | acc=0.1507 | tpr=0.5437 | fpr=0.8566 | 7897.5 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.05063 | acc=0.1534 | tpr=0.5591 | fpr=0.8541 | 8040.1 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.04333 | acc=0.1538 | tpr=0.5530 | fpr=0.8535 | 8019.2 samples/s | 31.3 steps/s
[Step= 250] | Loss=5.04595 | acc=0.1534 | tpr=0.5459 | fpr=0.8537 | 7605.8 samples/s | 29.7 steps/s
[Step= 300] | Loss=5.04186 | acc=0.1529 | tpr=0.5367 | fpr=0.8541 | 7882.6 samples/s | 30.8 steps/s
[Step= 350] | Loss=5.04748 | acc=0.1527 | tpr=0.5329 | fpr=0.8542 | 7932.0 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.04499 | acc=0.1529 | tpr=0.5328 | fpr=0.8540 | 7578.4 samples/s | 29.6 steps/s
[Step= 450] | Loss=5.04752 | acc=0.1526 | tpr=0.5394 | fpr=0.8544 | 8556.9 samples/s | 33.4 steps/s
[Step= 500] | Loss=5.04868 | acc=0.1524 | tpr=0.5410 | fpr=0.8546 | 7608.4 samples/s | 29.7 steps/s
[Step= 550] | Loss=5.05295 | acc=0.1524 | tpr=0.5428 | fpr=0.8547 | 11674.0 samples/s | 45.6 steps/s
Avg test loss: 5.05335, Avg test acc: 0.15234, Avg tpr: 0.54358, Avg fpr: 0.85477, total FA: 118683

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.07927 | acc=0.1330 | tpr=0.6106 | fpr=0.8755 | 6006.6 samples/s | 23.5 steps/s
[Step= 100] | Loss=5.06777 | acc=0.1354 | tpr=0.6098 | fpr=0.8735 | 7959.2 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.06051 | acc=0.1364 | tpr=0.6138 | fpr=0.8724 | 7874.0 samples/s | 30.8 steps/s
[Step= 200] | Loss=5.05234 | acc=0.1367 | tpr=0.6022 | fpr=0.8718 | 8031.3 samples/s | 31.4 steps/s
[Step= 250] | Loss=5.05725 | acc=0.1369 | tpr=0.5991 | fpr=0.8715 | 8212.1 samples/s | 32.1 steps/s
[Step= 300] | Loss=5.05363 | acc=0.1365 | tpr=0.5935 | fpr=0.8718 | 7499.4 samples/s | 29.3 steps/s
[Step= 350] | Loss=5.06022 | acc=0.1365 | tpr=0.5892 | fpr=0.8717 | 8867.6 samples/s | 34.6 steps/s
[Step= 400] | Loss=5.05932 | acc=0.1371 | tpr=0.5886 | fpr=0.8711 | 7826.4 samples/s | 30.6 steps/s
[Step= 450] | Loss=5.06451 | acc=0.1364 | tpr=0.5925 | fpr=0.8719 | 8205.5 samples/s | 32.1 steps/s
[Step= 500] | Loss=5.06319 | acc=0.1366 | tpr=0.5921 | fpr=0.8717 | 8275.2 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.06678 | acc=0.1367 | tpr=0.5929 | fpr=0.8716 | 9209.0 samples/s | 36.0 steps/s
Avg test loss: 5.06725, Avg test acc: 0.13659, Avg tpr: 0.59390, Avg fpr: 0.87172, total FA: 121037

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.05178 | acc=0.1363 | tpr=0.6637 | fpr=0.8732 | 6182.4 samples/s | 24.2 steps/s
[Step= 100] | Loss=5.04754 | acc=0.1393 | tpr=0.6418 | fpr=0.8701 | 7012.5 samples/s | 27.4 steps/s
[Step= 150] | Loss=5.03675 | acc=0.1404 | tpr=0.6571 | fpr=0.8691 | 8384.0 samples/s | 32.7 steps/s
[Step= 200] | Loss=5.02760 | acc=0.1406 | tpr=0.6557 | fpr=0.8688 | 8230.6 samples/s | 32.2 steps/s
[Step= 250] | Loss=5.02934 | acc=0.1406 | tpr=0.6515 | fpr=0.8687 | 8700.2 samples/s | 34.0 steps/s
[Step= 300] | Loss=5.02601 | acc=0.1402 | tpr=0.6458 | fpr=0.8690 | 8251.4 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.03187 | acc=0.1400 | tpr=0.6456 | fpr=0.8692 | 7531.4 samples/s | 29.4 steps/s
[Step= 400] | Loss=5.03067 | acc=0.1404 | tpr=0.6444 | fpr=0.8688 | 7889.3 samples/s | 30.8 steps/s
[Step= 450] | Loss=5.03590 | acc=0.1396 | tpr=0.6465 | fpr=0.8696 | 7990.0 samples/s | 31.2 steps/s
[Step= 500] | Loss=5.03519 | acc=0.1396 | tpr=0.6471 | fpr=0.8696 | 7998.8 samples/s | 31.2 steps/s
[Step= 550] | Loss=5.03981 | acc=0.1395 | tpr=0.6474 | fpr=0.8697 | 10465.3 samples/s | 40.9 steps/s
Avg test loss: 5.04066, Avg test acc: 0.13945, Avg tpr: 0.64857, Avg fpr: 0.86981, total FA: 120771

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.43301 | acc=0.1361 | tpr=0.5088 | fpr=0.8706 | 5672.3 samples/s | 22.2 steps/s
[Step= 100] | Loss=5.41787 | acc=0.1386 | tpr=0.5203 | fpr=0.8685 | 8354.2 samples/s | 32.6 steps/s
[Step= 150] | Loss=5.40750 | acc=0.1401 | tpr=0.5245 | fpr=0.8669 | 8325.0 samples/s | 32.5 steps/s
[Step= 200] | Loss=5.40129 | acc=0.1408 | tpr=0.5246 | fpr=0.8661 | 7732.1 samples/s | 30.2 steps/s
[Step= 250] | Loss=5.40320 | acc=0.1405 | tpr=0.5127 | fpr=0.8663 | 7822.3 samples/s | 30.6 steps/s
[Step= 300] | Loss=5.39857 | acc=0.1399 | tpr=0.5055 | fpr=0.8668 | 8023.2 samples/s | 31.3 steps/s
[Step= 350] | Loss=5.40694 | acc=0.1396 | tpr=0.5028 | fpr=0.8669 | 8390.5 samples/s | 32.8 steps/s
[Step= 400] | Loss=5.40402 | acc=0.1399 | tpr=0.5033 | fpr=0.8668 | 7785.5 samples/s | 30.4 steps/s
[Step= 450] | Loss=5.40906 | acc=0.1393 | tpr=0.5049 | fpr=0.8673 | 8115.2 samples/s | 31.7 steps/s
[Step= 500] | Loss=5.40870 | acc=0.1394 | tpr=0.5079 | fpr=0.8672 | 8202.3 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.41203 | acc=0.1394 | tpr=0.5062 | fpr=0.8672 | 10365.2 samples/s | 40.5 steps/s
Avg test loss: 5.41287, Avg test acc: 0.13943, Avg tpr: 0.50753, Avg fpr: 0.86726, total FA: 120417

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.20353 | acc=0.9606 | tpr=0.9425 | fpr=0.0390 | 5768.4 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.21107 | acc=0.9601 | tpr=0.9531 | fpr=0.0398 | 7882.7 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.21338 | acc=0.9587 | tpr=0.9510 | fpr=0.0412 | 8026.4 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.21323 | acc=0.9587 | tpr=0.9552 | fpr=0.0412 | 7939.5 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.21329 | acc=0.9587 | tpr=0.9546 | fpr=0.0412 | 8052.8 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.21682 | acc=0.9581 | tpr=0.9520 | fpr=0.0418 | 8531.1 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.21523 | acc=0.9582 | tpr=0.9518 | fpr=0.0417 | 8114.4 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.21516 | acc=0.9579 | tpr=0.9491 | fpr=0.0420 | 8576.0 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.21870 | acc=0.9574 | tpr=0.9474 | fpr=0.0425 | 7549.5 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.21889 | acc=0.9573 | tpr=0.9485 | fpr=0.0426 | 8384.2 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.21755 | acc=0.9575 | tpr=0.9487 | fpr=0.0423 | 9380.8 samples/s | 36.6 steps/s
Avg test loss: 0.21720, Avg test acc: 0.95753, Avg tpr: 0.94849, Avg fpr: 0.04231, total FA: 5874

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.17467 | acc=0.9600 | tpr=0.8982 | fpr=0.0389 | 6123.8 samples/s | 23.9 steps/s
[Step= 100] | Loss=0.18251 | acc=0.9589 | tpr=0.9168 | fpr=0.0403 | 7926.2 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.18511 | acc=0.9573 | tpr=0.9179 | fpr=0.0420 | 7879.7 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.18541 | acc=0.9577 | tpr=0.9246 | fpr=0.0417 | 7415.0 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.18497 | acc=0.9579 | tpr=0.9266 | fpr=0.0416 | 7347.5 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.18784 | acc=0.9576 | tpr=0.9273 | fpr=0.0419 | 8459.8 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.18655 | acc=0.9576 | tpr=0.9286 | fpr=0.0419 | 8460.7 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.18731 | acc=0.9573 | tpr=0.9256 | fpr=0.0421 | 8448.2 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.19067 | acc=0.9568 | tpr=0.9255 | fpr=0.0427 | 7608.3 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.19008 | acc=0.9568 | tpr=0.9278 | fpr=0.0427 | 8624.0 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.18877 | acc=0.9570 | tpr=0.9288 | fpr=0.0424 | 9751.6 samples/s | 38.1 steps/s
Avg test loss: 0.18857, Avg test acc: 0.95705, Avg tpr: 0.92868, Avg fpr: 0.04243, total FA: 5892

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26324 | acc=0.9509 | tpr=0.9558 | fpr=0.0492 | 6154.0 samples/s | 24.0 steps/s
[Step= 100] | Loss=0.27120 | acc=0.9499 | tpr=0.9595 | fpr=0.0503 | 7896.6 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.27608 | acc=0.9485 | tpr=0.9625 | fpr=0.0517 | 7527.1 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.27566 | acc=0.9487 | tpr=0.9650 | fpr=0.0516 | 8497.5 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.27554 | acc=0.9485 | tpr=0.9642 | fpr=0.0518 | 7939.2 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.27891 | acc=0.9481 | tpr=0.9615 | fpr=0.0521 | 7598.3 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.27690 | acc=0.9481 | tpr=0.9606 | fpr=0.0521 | 8208.1 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.27743 | acc=0.9478 | tpr=0.9568 | fpr=0.0524 | 8358.9 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.28118 | acc=0.9473 | tpr=0.9542 | fpr=0.0528 | 7682.8 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.28155 | acc=0.9472 | tpr=0.9551 | fpr=0.0529 | 8381.8 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.27979 | acc=0.9475 | tpr=0.9554 | fpr=0.0527 | 9658.0 samples/s | 37.7 steps/s
Avg test loss: 0.27948, Avg test acc: 0.94749, Avg tpr: 0.95523, Avg fpr: 0.05265, total FA: 7311

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.17155 | acc=0.9619 | tpr=0.9248 | fpr=0.0375 | 6058.7 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.18066 | acc=0.9605 | tpr=0.9275 | fpr=0.0389 | 7853.9 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.18275 | acc=0.9587 | tpr=0.9265 | fpr=0.0407 | 8161.5 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.18247 | acc=0.9589 | tpr=0.9311 | fpr=0.0406 | 7954.7 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.18270 | acc=0.9585 | tpr=0.9249 | fpr=0.0409 | 8161.2 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.18597 | acc=0.9582 | tpr=0.9229 | fpr=0.0412 | 7936.0 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.18457 | acc=0.9583 | tpr=0.9236 | fpr=0.0411 | 6969.7 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.18464 | acc=0.9581 | tpr=0.9229 | fpr=0.0413 | 8525.2 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.18753 | acc=0.9576 | tpr=0.9221 | fpr=0.0418 | 8561.8 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.18752 | acc=0.9575 | tpr=0.9242 | fpr=0.0419 | 7888.8 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.18639 | acc=0.9577 | tpr=0.9252 | fpr=0.0417 | 10411.3 samples/s | 40.7 steps/s
Avg test loss: 0.18613, Avg test acc: 0.95774, Avg tpr: 0.92512, Avg fpr: 0.04166, total FA: 5785

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.23128 | acc=0.9577 | tpr=0.9381 | fpr=0.0419 | 5992.9 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.24061 | acc=0.9563 | tpr=0.9510 | fpr=0.0436 | 7357.4 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.24389 | acc=0.9546 | tpr=0.9568 | fpr=0.0455 | 8707.0 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.24450 | acc=0.9545 | tpr=0.9585 | fpr=0.0456 | 8141.9 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.24545 | acc=0.9543 | tpr=0.9563 | fpr=0.0458 | 7919.8 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.24912 | acc=0.9538 | tpr=0.9535 | fpr=0.0462 | 8042.4 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.24794 | acc=0.9537 | tpr=0.9530 | fpr=0.0462 | 8248.9 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.24821 | acc=0.9534 | tpr=0.9480 | fpr=0.0465 | 7642.2 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.25223 | acc=0.9530 | tpr=0.9464 | fpr=0.0469 | 8200.4 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.25217 | acc=0.9528 | tpr=0.9463 | fpr=0.0471 | 7621.8 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.25054 | acc=0.9531 | tpr=0.9471 | fpr=0.0467 | 10428.5 samples/s | 40.7 steps/s
Avg test loss: 0.25024, Avg test acc: 0.95317, Avg tpr: 0.94691, Avg fpr: 0.04672, total FA: 6487

server round 34/50

clients selected: [1 2 3 5 7]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=36001 Epoch=175.7] | Loss=0.01466 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.487 | L2-Norm(final)=14.218 | 7140.8 samples/s | 111.6 steps/s
[Step=36050 Epoch=175.9] | Loss=0.01857 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=14.215 | 4915.3 samples/s | 76.8 steps/s
[Step=36100 Epoch=176.2] | Loss=0.01816 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=14.215 | 5567.6 samples/s | 87.0 steps/s
[Step=36150 Epoch=176.4] | Loss=0.01738 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.487 | L2-Norm(final)=14.216 | 5489.9 samples/s | 85.8 steps/s
[Step=36200 Epoch=176.6] | Loss=0.01722 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.487 | L2-Norm(final)=14.218 | 8718.2 samples/s | 136.2 steps/s
[Step=36250 Epoch=176.9] | Loss=0.01730 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=14.219 | 2646.2 samples/s | 41.3 steps/s
[Step=36300 Epoch=177.1] | Loss=0.01759 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.487 | L2-Norm(final)=14.220 | 5589.9 samples/s | 87.3 steps/s
[Step=36350 Epoch=177.4] | Loss=0.01739 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.487 | L2-Norm(final)=14.222 | 5546.7 samples/s | 86.7 steps/s
[Step=36400 Epoch=177.6] | Loss=0.01740 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.487 | L2-Norm(final)=14.223 | 7833.7 samples/s | 122.4 steps/s
[Step=36450 Epoch=177.9] | Loss=0.01750 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.487 | L2-Norm(final)=14.224 | 2753.8 samples/s | 43.0 steps/s
[Step=36500 Epoch=178.1] | Loss=0.01763 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.487 | L2-Norm(final)=14.224 | 5551.2 samples/s | 86.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=178.1] | Loss=0.03178 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.487 | L2-Norm(final)=14.231 | 6410.7 samples/s | 100.2 steps/s
[Step=36550 Epoch=178.3] | Loss=0.01682 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.503 | L2-Norm(final)=14.231 | 4709.7 samples/s | 73.6 steps/s
[Step=36600 Epoch=178.6] | Loss=0.01799 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.523 | L2-Norm(final)=14.231 | 4787.2 samples/s | 74.8 steps/s
[Step=36650 Epoch=178.8] | Loss=0.01668 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.539 | L2-Norm(final)=14.232 | 4802.5 samples/s | 75.0 steps/s
[Step=36700 Epoch=179.1] | Loss=0.01548 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.551 | L2-Norm(final)=14.233 | 6867.9 samples/s | 107.3 steps/s
[Step=36750 Epoch=179.3] | Loss=0.01326 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.562 | L2-Norm(final)=14.236 | 2462.2 samples/s | 38.5 steps/s
[Step=36800 Epoch=179.6] | Loss=0.01196 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.571 | L2-Norm(final)=14.240 | 4764.5 samples/s | 74.4 steps/s
[Step=36850 Epoch=179.8] | Loss=0.01095 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.579 | L2-Norm(final)=14.243 | 4732.8 samples/s | 73.9 steps/s
[Step=36900 Epoch=180.1] | Loss=0.01040 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.585 | L2-Norm(final)=14.247 | 6344.0 samples/s | 99.1 steps/s
[Step=36950 Epoch=180.3] | Loss=0.00980 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.591 | L2-Norm(final)=14.249 | 2536.8 samples/s | 39.6 steps/s
[Step=37000 Epoch=180.5] | Loss=0.00928 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.596 | L2-Norm(final)=14.252 | 4829.6 samples/s | 75.5 steps/s
[Step=37050 Epoch=180.8] | Loss=0.00880 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.600 | L2-Norm(final)=14.254 | 4703.8 samples/s | 73.5 steps/s
[Step=37100 Epoch=181.0] | Loss=0.00835 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.604 | L2-Norm(final)=14.257 | 5890.9 samples/s | 92.0 steps/s
[Step=37150 Epoch=181.3] | Loss=0.00805 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.608 | L2-Norm(final)=14.259 | 2591.0 samples/s | 40.5 steps/s
[Step=37200 Epoch=181.5] | Loss=0.00768 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.612 | L2-Norm(final)=14.262 | 4815.8 samples/s | 75.2 steps/s
[Step=37250 Epoch=181.8] | Loss=0.00749 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.615 | L2-Norm(final)=14.264 | 4796.1 samples/s | 74.9 steps/s
[Step=37300 Epoch=182.0] | Loss=0.00718 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.618 | L2-Norm(final)=14.266 | 5432.9 samples/s | 84.9 steps/s
[Step=37350 Epoch=182.3] | Loss=0.00688 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.622 | L2-Norm(final)=14.268 | 2712.7 samples/s | 42.4 steps/s
[Step=37400 Epoch=182.5] | Loss=0.00665 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=14.271 | 4834.5 samples/s | 75.5 steps/s
[Step=37450 Epoch=182.7] | Loss=0.00648 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=14.273 | 4757.5 samples/s | 74.3 steps/s
[Step=37500 Epoch=183.0] | Loss=0.00631 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.630 | L2-Norm(final)=14.275 | 5093.8 samples/s | 79.6 steps/s
[Step=37550 Epoch=183.2] | Loss=0.00616 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.632 | L2-Norm(final)=14.277 | 2802.7 samples/s | 43.8 steps/s
[Step=37600 Epoch=183.5] | Loss=0.00603 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.635 | L2-Norm(final)=14.279 | 4782.8 samples/s | 74.7 steps/s
[Step=37650 Epoch=183.7] | Loss=0.00589 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.637 | L2-Norm(final)=14.281 | 4781.9 samples/s | 74.7 steps/s
[Step=37700 Epoch=184.0] | Loss=0.00574 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.639 | L2-Norm(final)=14.283 | 4803.8 samples/s | 75.1 steps/s
[Step=37750 Epoch=184.2] | Loss=0.00562 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.641 | L2-Norm(final)=14.285 | 2906.9 samples/s | 45.4 steps/s
[Step=37800 Epoch=184.4] | Loss=0.00558 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.643 | L2-Norm(final)=14.287 | 4805.8 samples/s | 75.1 steps/s
[Step=37850 Epoch=184.7] | Loss=0.00547 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.645 | L2-Norm(final)=14.289 | 4686.2 samples/s | 73.2 steps/s
[Step=37900 Epoch=184.9] | Loss=0.00532 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.647 | L2-Norm(final)=14.290 | 4816.1 samples/s | 75.3 steps/s
[Step=37950 Epoch=185.2] | Loss=0.00518 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.649 | L2-Norm(final)=14.292 | 2911.4 samples/s | 45.5 steps/s
[Step=38000 Epoch=185.4] | Loss=0.00505 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.651 | L2-Norm(final)=14.294 | 4744.8 samples/s | 74.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step38000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=36001 Epoch=175.4] | Loss=0.00252 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=13.298 | 6649.2 samples/s | 103.9 steps/s
[Step=36050 Epoch=175.7] | Loss=0.01973 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=13.299 | 4988.9 samples/s | 78.0 steps/s
[Step=36100 Epoch=175.9] | Loss=0.01791 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=13.296 | 5527.4 samples/s | 86.4 steps/s
[Step=36150 Epoch=176.1] | Loss=0.01834 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=13.298 | 5583.1 samples/s | 87.2 steps/s
[Step=36200 Epoch=176.4] | Loss=0.01850 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=13.298 | 8570.1 samples/s | 133.9 steps/s
[Step=36250 Epoch=176.6] | Loss=0.01868 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.487 | L2-Norm(final)=13.297 | 2685.9 samples/s | 42.0 steps/s
[Step=36300 Epoch=176.9] | Loss=0.01848 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.487 | L2-Norm(final)=13.297 | 5550.4 samples/s | 86.7 steps/s
[Step=36350 Epoch=177.1] | Loss=0.01832 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=13.298 | 5520.4 samples/s | 86.3 steps/s
[Step=36400 Epoch=177.4] | Loss=0.01826 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=13.298 | 7551.6 samples/s | 118.0 steps/s
[Step=36450 Epoch=177.6] | Loss=0.01855 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=13.299 | 2778.9 samples/s | 43.4 steps/s
[Step=36500 Epoch=177.8] | Loss=0.01837 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=13.299 | 5638.8 samples/s | 88.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=177.9] | Loss=0.03199 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.487 | L2-Norm(final)=13.300 | 6217.8 samples/s | 97.2 steps/s
[Step=36550 Epoch=178.1] | Loss=0.01814 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.498 | L2-Norm(final)=13.300 | 4748.5 samples/s | 74.2 steps/s
[Step=36600 Epoch=178.3] | Loss=0.01832 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.512 | L2-Norm(final)=13.300 | 4671.2 samples/s | 73.0 steps/s
[Step=36650 Epoch=178.6] | Loss=0.01683 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.524 | L2-Norm(final)=13.302 | 4728.7 samples/s | 73.9 steps/s
[Step=36700 Epoch=178.8] | Loss=0.01594 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.535 | L2-Norm(final)=13.305 | 6832.8 samples/s | 106.8 steps/s
[Step=36750 Epoch=179.1] | Loss=0.01427 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.544 | L2-Norm(final)=13.308 | 2486.2 samples/s | 38.8 steps/s
[Step=36800 Epoch=179.3] | Loss=0.01277 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.551 | L2-Norm(final)=13.312 | 4716.1 samples/s | 73.7 steps/s
[Step=36850 Epoch=179.6] | Loss=0.01187 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.558 | L2-Norm(final)=13.315 | 4798.2 samples/s | 75.0 steps/s
[Step=36900 Epoch=179.8] | Loss=0.01117 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.564 | L2-Norm(final)=13.318 | 6185.0 samples/s | 96.6 steps/s
[Step=36950 Epoch=180.0] | Loss=0.01081 | Reg=0.00112 | acc=0.9688 | L2-Norm=10.569 | L2-Norm(final)=13.322 | 2576.3 samples/s | 40.3 steps/s
[Step=37000 Epoch=180.3] | Loss=0.01021 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.574 | L2-Norm(final)=13.324 | 4760.2 samples/s | 74.4 steps/s
[Step=37050 Epoch=180.5] | Loss=0.00973 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.579 | L2-Norm(final)=13.327 | 4772.9 samples/s | 74.6 steps/s
[Step=37100 Epoch=180.8] | Loss=0.00930 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.583 | L2-Norm(final)=13.330 | 5705.2 samples/s | 89.1 steps/s
[Step=37150 Epoch=181.0] | Loss=0.00893 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.587 | L2-Norm(final)=13.333 | 2677.5 samples/s | 41.8 steps/s
[Step=37200 Epoch=181.3] | Loss=0.00862 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.591 | L2-Norm(final)=13.336 | 4741.0 samples/s | 74.1 steps/s
[Step=37250 Epoch=181.5] | Loss=0.00823 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.595 | L2-Norm(final)=13.338 | 4822.1 samples/s | 75.3 steps/s
[Step=37300 Epoch=181.7] | Loss=0.00797 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.598 | L2-Norm(final)=13.341 | 5177.3 samples/s | 80.9 steps/s
[Step=37350 Epoch=182.0] | Loss=0.00771 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.602 | L2-Norm(final)=13.344 | 2801.8 samples/s | 43.8 steps/s
[Step=37400 Epoch=182.2] | Loss=0.00747 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.605 | L2-Norm(final)=13.346 | 4763.4 samples/s | 74.4 steps/s
[Step=37450 Epoch=182.5] | Loss=0.00732 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.608 | L2-Norm(final)=13.349 | 4776.1 samples/s | 74.6 steps/s
[Step=37500 Epoch=182.7] | Loss=0.00709 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.611 | L2-Norm(final)=13.351 | 4899.9 samples/s | 76.6 steps/s
[Step=37550 Epoch=183.0] | Loss=0.00690 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.614 | L2-Norm(final)=13.354 | 2899.2 samples/s | 45.3 steps/s
[Step=37600 Epoch=183.2] | Loss=0.00669 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.617 | L2-Norm(final)=13.356 | 4755.5 samples/s | 74.3 steps/s
[Step=37650 Epoch=183.4] | Loss=0.00655 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.620 | L2-Norm(final)=13.359 | 4729.2 samples/s | 73.9 steps/s
[Step=37700 Epoch=183.7] | Loss=0.00643 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.623 | L2-Norm(final)=13.361 | 4762.6 samples/s | 74.4 steps/s
[Step=37750 Epoch=183.9] | Loss=0.00632 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=13.363 | 2945.6 samples/s | 46.0 steps/s
[Step=37800 Epoch=184.2] | Loss=0.00620 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.628 | L2-Norm(final)=13.366 | 4803.2 samples/s | 75.0 steps/s
[Step=37850 Epoch=184.4] | Loss=0.00607 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=13.368 | 4835.9 samples/s | 75.6 steps/s
[Step=37900 Epoch=184.7] | Loss=0.00598 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.633 | L2-Norm(final)=13.370 | 4689.7 samples/s | 73.3 steps/s
[Step=37950 Epoch=184.9] | Loss=0.00587 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.636 | L2-Norm(final)=13.372 | 2959.7 samples/s | 46.2 steps/s
[Step=38000 Epoch=185.2] | Loss=0.00578 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.638 | L2-Norm(final)=13.374 | 4698.5 samples/s | 73.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step38000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=24001 Epoch=117.0] | Loss=0.00990 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.487 | L2-Norm(final)=13.185 | 6621.4 samples/s | 103.5 steps/s
[Step=24050 Epoch=117.3] | Loss=0.01755 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=13.197 | 5290.7 samples/s | 82.7 steps/s
[Step=24100 Epoch=117.5] | Loss=0.02016 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=13.210 | 5483.7 samples/s | 85.7 steps/s
[Step=24150 Epoch=117.8] | Loss=0.02150 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=13.218 | 5511.5 samples/s | 86.1 steps/s
[Step=24200 Epoch=118.0] | Loss=0.02094 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.487 | L2-Norm(final)=13.224 | 8581.5 samples/s | 134.1 steps/s
[Step=24250 Epoch=118.3] | Loss=0.02085 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=13.230 | 2686.3 samples/s | 42.0 steps/s
[Step=24300 Epoch=118.5] | Loss=0.01988 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=13.236 | 5575.7 samples/s | 87.1 steps/s
[Step=24350 Epoch=118.7] | Loss=0.01975 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=13.242 | 5469.5 samples/s | 85.5 steps/s
[Step=24400 Epoch=119.0] | Loss=0.02040 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.487 | L2-Norm(final)=13.248 | 7643.4 samples/s | 119.4 steps/s
[Step=24450 Epoch=119.2] | Loss=0.02022 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.487 | L2-Norm(final)=13.253 | 2783.7 samples/s | 43.5 steps/s
[Step=24500 Epoch=119.5] | Loss=0.02011 | Reg=0.00110 | acc=0.9531 | L2-Norm=10.487 | L2-Norm(final)=13.257 | 5629.3 samples/s | 88.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=24501 Epoch=119.5] | Loss=0.01142 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.487 | L2-Norm(final)=13.305 | 7012.5 samples/s | 109.6 steps/s
[Step=24550 Epoch=119.7] | Loss=0.01947 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.503 | L2-Norm(final)=13.306 | 4352.6 samples/s | 68.0 steps/s
[Step=24600 Epoch=120.0] | Loss=0.01773 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.523 | L2-Norm(final)=13.308 | 4781.5 samples/s | 74.7 steps/s
[Step=24650 Epoch=120.2] | Loss=0.01608 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.540 | L2-Norm(final)=13.311 | 4811.2 samples/s | 75.2 steps/s
[Step=24700 Epoch=120.5] | Loss=0.01508 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.555 | L2-Norm(final)=13.314 | 6701.1 samples/s | 104.7 steps/s
[Step=24750 Epoch=120.7] | Loss=0.01337 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.568 | L2-Norm(final)=13.319 | 2509.1 samples/s | 39.2 steps/s
[Step=24800 Epoch=120.9] | Loss=0.01218 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.579 | L2-Norm(final)=13.323 | 4702.4 samples/s | 73.5 steps/s
[Step=24850 Epoch=121.2] | Loss=0.01101 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.589 | L2-Norm(final)=13.327 | 4728.2 samples/s | 73.9 steps/s
[Step=24900 Epoch=121.4] | Loss=0.01044 | Reg=0.00112 | acc=0.9688 | L2-Norm=10.597 | L2-Norm(final)=13.331 | 6215.5 samples/s | 97.1 steps/s
[Step=24950 Epoch=121.7] | Loss=0.00982 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.605 | L2-Norm(final)=13.335 | 2563.3 samples/s | 40.1 steps/s
[Step=25000 Epoch=121.9] | Loss=0.00919 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.612 | L2-Norm(final)=13.339 | 4767.0 samples/s | 74.5 steps/s
[Step=25050 Epoch=122.2] | Loss=0.00881 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.618 | L2-Norm(final)=13.342 | 4777.9 samples/s | 74.7 steps/s
[Step=25100 Epoch=122.4] | Loss=0.00843 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=13.346 | 5687.1 samples/s | 88.9 steps/s
[Step=25150 Epoch=122.6] | Loss=0.00801 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.630 | L2-Norm(final)=13.349 | 2698.8 samples/s | 42.2 steps/s
[Step=25200 Epoch=122.9] | Loss=0.00772 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.635 | L2-Norm(final)=13.352 | 4631.1 samples/s | 72.4 steps/s
[Step=25250 Epoch=123.1] | Loss=0.00742 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.640 | L2-Norm(final)=13.355 | 4796.2 samples/s | 74.9 steps/s
[Step=25300 Epoch=123.4] | Loss=0.00720 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.645 | L2-Norm(final)=13.358 | 5229.5 samples/s | 81.7 steps/s
[Step=25350 Epoch=123.6] | Loss=0.00695 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.649 | L2-Norm(final)=13.361 | 2781.0 samples/s | 43.5 steps/s
[Step=25400 Epoch=123.9] | Loss=0.00669 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.653 | L2-Norm(final)=13.364 | 4702.9 samples/s | 73.5 steps/s
[Step=25450 Epoch=124.1] | Loss=0.00646 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.657 | L2-Norm(final)=13.367 | 4779.4 samples/s | 74.7 steps/s
[Step=25500 Epoch=124.4] | Loss=0.00629 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.660 | L2-Norm(final)=13.370 | 4912.1 samples/s | 76.8 steps/s
[Step=25550 Epoch=124.6] | Loss=0.00607 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.664 | L2-Norm(final)=13.373 | 2908.8 samples/s | 45.5 steps/s
[Step=25600 Epoch=124.8] | Loss=0.00596 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.667 | L2-Norm(final)=13.375 | 4749.7 samples/s | 74.2 steps/s
[Step=25650 Epoch=125.1] | Loss=0.00580 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.670 | L2-Norm(final)=13.378 | 4707.9 samples/s | 73.6 steps/s
[Step=25700 Epoch=125.3] | Loss=0.00565 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.673 | L2-Norm(final)=13.380 | 4771.1 samples/s | 74.5 steps/s
[Step=25750 Epoch=125.6] | Loss=0.00556 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.676 | L2-Norm(final)=13.382 | 2946.5 samples/s | 46.0 steps/s
[Step=25800 Epoch=125.8] | Loss=0.00544 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.679 | L2-Norm(final)=13.385 | 4750.6 samples/s | 74.2 steps/s
[Step=25850 Epoch=126.1] | Loss=0.00531 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.682 | L2-Norm(final)=13.387 | 4760.0 samples/s | 74.4 steps/s
[Step=25900 Epoch=126.3] | Loss=0.00521 | Reg=0.00114 | acc=0.9844 | L2-Norm=10.684 | L2-Norm(final)=13.389 | 4783.6 samples/s | 74.7 steps/s
[Step=25950 Epoch=126.5] | Loss=0.00511 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.687 | L2-Norm(final)=13.392 | 2974.0 samples/s | 46.5 steps/s
[Step=26000 Epoch=126.8] | Loss=0.00502 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.690 | L2-Norm(final)=13.394 | 4685.8 samples/s | 73.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step26000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=48001 Epoch=454.9] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=17.915 | 7341.9 samples/s | 114.7 steps/s
[Step=48050 Epoch=455.3] | Loss=0.00004 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.480 | L2-Norm(final)=17.917 | 4473.4 samples/s | 69.9 steps/s
[Step=48100 Epoch=455.8] | Loss=0.00006 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=17.919 | 7876.9 samples/s | 123.1 steps/s
[Step=48150 Epoch=456.3] | Loss=0.00006 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=17.922 | 2590.1 samples/s | 40.5 steps/s
[Step=48200 Epoch=456.7] | Loss=0.00006 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=17.924 | 7141.7 samples/s | 111.6 steps/s
[Step=48250 Epoch=457.2] | Loss=0.00005 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=17.928 | 2669.5 samples/s | 41.7 steps/s
[Step=48300 Epoch=457.7] | Loss=0.00005 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=17.931 | 6508.6 samples/s | 101.7 steps/s
[Step=48350 Epoch=458.2] | Loss=0.00006 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=17.934 | 2832.8 samples/s | 44.3 steps/s
[Step=48400 Epoch=458.6] | Loss=0.00005 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=17.937 | 5777.5 samples/s | 90.3 steps/s
[Step=48450 Epoch=459.1] | Loss=0.00006 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=17.940 | 2910.7 samples/s | 45.5 steps/s
[Step=48500 Epoch=459.6] | Loss=0.00006 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=17.944 | 5409.1 samples/s | 84.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=48501 Epoch=459.6] | Loss=0.00019 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=17.978 | 6346.7 samples/s | 99.2 steps/s
[Step=48550 Epoch=460.1] | Loss=0.00002 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.452 | L2-Norm(final)=17.980 | 4268.1 samples/s | 66.7 steps/s
[Step=48600 Epoch=460.5] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.413 | L2-Norm(final)=17.982 | 6609.4 samples/s | 103.3 steps/s
[Step=48650 Epoch=461.0] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.373 | L2-Norm(final)=17.982 | 2372.8 samples/s | 37.1 steps/s
[Step=48700 Epoch=461.5] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.334 | L2-Norm(final)=17.983 | 5957.4 samples/s | 93.1 steps/s
[Step=48750 Epoch=461.9] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.296 | L2-Norm(final)=17.983 | 2484.7 samples/s | 38.8 steps/s
[Step=48800 Epoch=462.4] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.259 | L2-Norm(final)=17.983 | 5391.2 samples/s | 84.2 steps/s
[Step=48850 Epoch=462.9] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.223 | L2-Norm(final)=17.984 | 2337.2 samples/s | 36.5 steps/s
[Step=48900 Epoch=463.4] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.187 | L2-Norm(final)=17.984 | 5013.9 samples/s | 78.3 steps/s
[Step=48950 Epoch=463.8] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.152 | L2-Norm(final)=17.984 | 2694.8 samples/s | 42.1 steps/s
[Step=49000 Epoch=464.3] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.117 | L2-Norm(final)=17.984 | 4665.1 samples/s | 72.9 steps/s
[Step=49050 Epoch=464.8] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.083 | L2-Norm(final)=17.985 | 2774.5 samples/s | 43.4 steps/s
[Step=49100 Epoch=465.3] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.049 | L2-Norm(final)=17.985 | 4552.3 samples/s | 71.1 steps/s
[Step=49150 Epoch=465.7] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=17.985 | 2847.2 samples/s | 44.5 steps/s
[Step=49200 Epoch=466.2] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.982 | L2-Norm(final)=17.985 | 4564.6 samples/s | 71.3 steps/s
[Step=49250 Epoch=466.7] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.949 | L2-Norm(final)=17.986 | 2868.6 samples/s | 44.8 steps/s
[Step=49300 Epoch=467.2] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.916 | L2-Norm(final)=17.986 | 4536.1 samples/s | 70.9 steps/s
[Step=49350 Epoch=467.6] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.884 | L2-Norm(final)=17.986 | 2960.6 samples/s | 46.3 steps/s
[Step=49400 Epoch=468.1] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.851 | L2-Norm(final)=17.987 | 4298.8 samples/s | 67.2 steps/s
[Step=49450 Epoch=468.6] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.819 | L2-Norm(final)=17.987 | 6758.5 samples/s | 105.6 steps/s
[Step=49500 Epoch=469.1] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.786 | L2-Norm(final)=17.987 | 2393.7 samples/s | 37.4 steps/s
[Step=49550 Epoch=469.5] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.754 | L2-Norm(final)=17.988 | 5911.0 samples/s | 92.4 steps/s
[Step=49600 Epoch=470.0] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.722 | L2-Norm(final)=17.988 | 2446.9 samples/s | 38.2 steps/s
[Step=49650 Epoch=470.5] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.690 | L2-Norm(final)=17.988 | 5546.5 samples/s | 86.7 steps/s
[Step=49700 Epoch=471.0] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.659 | L2-Norm(final)=17.989 | 2560.2 samples/s | 40.0 steps/s
[Step=49750 Epoch=471.4] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.627 | L2-Norm(final)=17.989 | 5107.5 samples/s | 79.8 steps/s
[Step=49800 Epoch=471.9] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.595 | L2-Norm(final)=17.990 | 2652.6 samples/s | 41.4 steps/s
[Step=49850 Epoch=472.4] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.564 | L2-Norm(final)=17.990 | 4749.4 samples/s | 74.2 steps/s
[Step=49900 Epoch=472.8] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.532 | L2-Norm(final)=17.991 | 2777.7 samples/s | 43.4 steps/s
[Step=49950 Epoch=473.3] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.501 | L2-Norm(final)=17.991 | 4569.2 samples/s | 71.4 steps/s
[Step=50000 Epoch=473.8] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.469 | L2-Norm(final)=17.992 | 2738.3 samples/s | 42.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step50000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=305.6] | Loss=0.00024 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=14.342 | 6371.0 samples/s | 99.5 steps/s
[Step=32050 Epoch=306.1] | Loss=0.00052 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.483 | L2-Norm(final)=14.362 | 4788.7 samples/s | 74.8 steps/s
[Step=32100 Epoch=306.5] | Loss=0.00050 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=14.380 | 8443.0 samples/s | 131.9 steps/s
[Step=32150 Epoch=307.0] | Loss=0.00049 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=14.395 | 2548.0 samples/s | 39.8 steps/s
[Step=32200 Epoch=307.5] | Loss=0.00049 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=14.408 | 7510.4 samples/s | 117.3 steps/s
[Step=32250 Epoch=308.0] | Loss=0.00046 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=14.420 | 2704.7 samples/s | 42.3 steps/s
[Step=32300 Epoch=308.4] | Loss=0.00045 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=14.431 | 6513.8 samples/s | 101.8 steps/s
[Step=32350 Epoch=308.9] | Loss=0.00047 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=14.442 | 2736.8 samples/s | 42.8 steps/s
[Step=32400 Epoch=309.4] | Loss=0.00045 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=14.453 | 6299.3 samples/s | 98.4 steps/s
[Step=32450 Epoch=309.9] | Loss=0.00044 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=14.462 | 2858.4 samples/s | 44.7 steps/s
[Step=32500 Epoch=310.4] | Loss=0.00044 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=14.470 | 5608.6 samples/s | 87.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=310.4] | Loss=0.00024 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.481 | L2-Norm(final)=14.555 | 7135.0 samples/s | 111.5 steps/s
[Step=32550 Epoch=310.8] | Loss=0.00046 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=14.558 | 4123.9 samples/s | 64.4 steps/s
[Step=32600 Epoch=311.3] | Loss=0.00060 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.514 | L2-Norm(final)=14.560 | 6337.8 samples/s | 99.0 steps/s
[Step=32650 Epoch=311.8] | Loss=0.00041 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.519 | L2-Norm(final)=14.560 | 2415.7 samples/s | 37.7 steps/s
[Step=32700 Epoch=312.3] | Loss=0.00031 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.518 | L2-Norm(final)=14.561 | 5915.9 samples/s | 92.4 steps/s
[Step=32750 Epoch=312.7] | Loss=0.00025 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.516 | L2-Norm(final)=14.561 | 2494.3 samples/s | 39.0 steps/s
[Step=32800 Epoch=313.2] | Loss=0.00021 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.511 | L2-Norm(final)=14.562 | 5515.4 samples/s | 86.2 steps/s
[Step=32850 Epoch=313.7] | Loss=0.00018 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.507 | L2-Norm(final)=14.562 | 2544.8 samples/s | 39.8 steps/s
[Step=32900 Epoch=314.2] | Loss=0.00016 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.502 | L2-Norm(final)=14.562 | 5259.9 samples/s | 82.2 steps/s
[Step=32950 Epoch=314.7] | Loss=0.00014 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=14.563 | 2611.0 samples/s | 40.8 steps/s
[Step=33000 Epoch=315.1] | Loss=0.00013 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.491 | L2-Norm(final)=14.563 | 4921.2 samples/s | 76.9 steps/s
[Step=33050 Epoch=315.6] | Loss=0.00011 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.486 | L2-Norm(final)=14.563 | 2735.2 samples/s | 42.7 steps/s
[Step=33100 Epoch=316.1] | Loss=0.00011 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.480 | L2-Norm(final)=14.563 | 4579.1 samples/s | 71.5 steps/s
[Step=33150 Epoch=316.6] | Loss=0.00010 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.474 | L2-Norm(final)=14.563 | 2783.7 samples/s | 43.5 steps/s
[Step=33200 Epoch=317.0] | Loss=0.00009 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.469 | L2-Norm(final)=14.564 | 4553.6 samples/s | 71.2 steps/s
[Step=33250 Epoch=317.5] | Loss=0.00008 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.463 | L2-Norm(final)=14.564 | 2849.0 samples/s | 44.5 steps/s
[Step=33300 Epoch=318.0] | Loss=0.00008 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.457 | L2-Norm(final)=14.564 | 4554.8 samples/s | 71.2 steps/s
[Step=33350 Epoch=318.5] | Loss=0.00007 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.451 | L2-Norm(final)=14.564 | 2839.1 samples/s | 44.4 steps/s
[Step=33400 Epoch=318.9] | Loss=0.00007 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.445 | L2-Norm(final)=14.565 | 4529.0 samples/s | 70.8 steps/s
[Step=33450 Epoch=319.4] | Loss=0.00007 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.439 | L2-Norm(final)=14.565 | 2875.8 samples/s | 44.9 steps/s
[Step=33500 Epoch=319.9] | Loss=0.00006 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.433 | L2-Norm(final)=14.565 | 4527.9 samples/s | 70.7 steps/s
[Step=33550 Epoch=320.4] | Loss=0.00006 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.427 | L2-Norm(final)=14.565 | 7268.1 samples/s | 113.6 steps/s
[Step=33600 Epoch=320.9] | Loss=0.00006 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.421 | L2-Norm(final)=14.566 | 2305.7 samples/s | 36.0 steps/s
[Step=33650 Epoch=321.3] | Loss=0.00006 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.415 | L2-Norm(final)=14.566 | 6582.0 samples/s | 102.8 steps/s
[Step=33700 Epoch=321.8] | Loss=0.00005 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.409 | L2-Norm(final)=14.566 | 2393.6 samples/s | 37.4 steps/s
[Step=33750 Epoch=322.3] | Loss=0.00005 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.402 | L2-Norm(final)=14.566 | 6010.1 samples/s | 93.9 steps/s
[Step=33800 Epoch=322.8] | Loss=0.00005 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=14.566 | 2452.6 samples/s | 38.3 steps/s
[Step=33850 Epoch=323.2] | Loss=0.00005 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.390 | L2-Norm(final)=14.567 | 5626.2 samples/s | 87.9 steps/s
[Step=33900 Epoch=323.7] | Loss=0.00005 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.384 | L2-Norm(final)=14.567 | 2535.0 samples/s | 39.6 steps/s
[Step=33950 Epoch=324.2] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.377 | L2-Norm(final)=14.567 | 5288.0 samples/s | 82.6 steps/s
[Step=34000 Epoch=324.7] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.371 | L2-Norm(final)=14.567 | 2617.4 samples/s | 40.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step34000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08112 | acc=0.9638 | tpr=0.9709 | fpr=0.0515 | 5633.8 samples/s | 22.0 steps/s
Avg test loss: 0.08744, Avg test acc: 0.96085, Avg tpr: 0.96864, Avg fpr: 0.05627, total FA: 439

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09619 | acc=0.9623 | tpr=0.9816 | fpr=0.0798 | 6158.0 samples/s | 24.1 steps/s
Avg test loss: 0.09959, Avg test acc: 0.96065, Avg tpr: 0.97989, Avg fpr: 0.08166, total FA: 637

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09007 | acc=0.9619 | tpr=0.9709 | fpr=0.0577 | 6145.6 samples/s | 24.0 steps/s
Avg test loss: 0.09443, Avg test acc: 0.95989, Avg tpr: 0.96794, Avg fpr: 0.05781, total FA: 451

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09201 | acc=0.9599 | tpr=0.9784 | fpr=0.0803 | 5939.5 samples/s | 23.2 steps/s
Avg test loss: 0.09632, Avg test acc: 0.95941, Avg tpr: 0.97826, Avg fpr: 0.08204, total FA: 640

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08978 | acc=0.9630 | tpr=0.9758 | fpr=0.0647 | 6186.7 samples/s | 24.2 steps/s
Avg test loss: 0.09203, Avg test acc: 0.96214, Avg tpr: 0.97400, Avg fpr: 0.06397, total FA: 499

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.69048 | acc=0.2839 | tpr=0.0211 | fpr=0.1454 | 5758.4 samples/s | 22.5 steps/s
Avg test loss: 5.69765, Avg test acc: 0.28284, Avg tpr: 0.02005, Avg fpr: 0.13921, total FA: 1086

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.87335 | acc=0.3091 | tpr=0.0227 | fpr=0.0691 | 5915.5 samples/s | 23.1 steps/s
Avg test loss: 4.88463, Avg test acc: 0.30599, Avg tpr: 0.02209, Avg fpr: 0.06961, total FA: 543

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.07399 | acc=0.2930 | tpr=0.0216 | fpr=0.1177 | 6009.8 samples/s | 23.5 steps/s
Avg test loss: 5.08425, Avg test acc: 0.29021, Avg tpr: 0.02116, Avg fpr: 0.11806, total FA: 921

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.53167 | acc=0.2843 | tpr=0.0286 | fpr=0.1606 | 5860.0 samples/s | 22.9 steps/s
Avg test loss: 5.53864, Avg test acc: 0.28384, Avg tpr: 0.02763, Avg fpr: 0.15267, total FA: 1191

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.09700 | acc=0.2890 | tpr=0.0187 | fpr=0.1241 | 5994.0 samples/s | 23.4 steps/s
Avg test loss: 5.11268, Avg test acc: 0.28812, Avg tpr: 0.01842, Avg fpr: 0.11870, total FA: 926

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.17688 | acc=0.1372 | tpr=0.6239 | fpr=0.8716 | 6029.9 samples/s | 23.6 steps/s
[Step= 100] | Loss=5.16090 | acc=0.1398 | tpr=0.6077 | fpr=0.8690 | 7516.1 samples/s | 29.4 steps/s
[Step= 150] | Loss=5.14960 | acc=0.1422 | tpr=0.6138 | fpr=0.8665 | 7452.1 samples/s | 29.1 steps/s
[Step= 200] | Loss=5.14045 | acc=0.1422 | tpr=0.6033 | fpr=0.8662 | 8470.2 samples/s | 33.1 steps/s
[Step= 250] | Loss=5.14414 | acc=0.1420 | tpr=0.5921 | fpr=0.8662 | 8732.3 samples/s | 34.1 steps/s
[Step= 300] | Loss=5.13712 | acc=0.1425 | tpr=0.5833 | fpr=0.8655 | 8479.4 samples/s | 33.1 steps/s
[Step= 350] | Loss=5.14256 | acc=0.1424 | tpr=0.5817 | fpr=0.8656 | 7754.5 samples/s | 30.3 steps/s
[Step= 400] | Loss=5.13955 | acc=0.1427 | tpr=0.5766 | fpr=0.8652 | 7794.5 samples/s | 30.4 steps/s
[Step= 450] | Loss=5.14292 | acc=0.1423 | tpr=0.5808 | fpr=0.8657 | 7762.2 samples/s | 30.3 steps/s
[Step= 500] | Loss=5.14279 | acc=0.1422 | tpr=0.5828 | fpr=0.8658 | 8186.4 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.14636 | acc=0.1422 | tpr=0.5846 | fpr=0.8659 | 9859.9 samples/s | 38.5 steps/s
Avg test loss: 5.14674, Avg test acc: 0.14214, Avg tpr: 0.58558, Avg fpr: 0.86592, total FA: 120231

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.59862 | acc=0.1206 | tpr=0.6327 | fpr=0.8886 | 6094.1 samples/s | 23.8 steps/s
[Step= 100] | Loss=5.58796 | acc=0.1243 | tpr=0.6354 | fpr=0.8853 | 7866.6 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.57493 | acc=0.1267 | tpr=0.6527 | fpr=0.8830 | 8094.0 samples/s | 31.6 steps/s
[Step= 200] | Loss=5.56790 | acc=0.1272 | tpr=0.6492 | fpr=0.8823 | 8114.6 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.57204 | acc=0.1271 | tpr=0.6498 | fpr=0.8824 | 7588.0 samples/s | 29.6 steps/s
[Step= 300] | Loss=5.56781 | acc=0.1262 | tpr=0.6429 | fpr=0.8832 | 8053.0 samples/s | 31.5 steps/s
[Step= 350] | Loss=5.57367 | acc=0.1258 | tpr=0.6381 | fpr=0.8835 | 7957.1 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.57090 | acc=0.1263 | tpr=0.6406 | fpr=0.8831 | 8474.9 samples/s | 33.1 steps/s
[Step= 450] | Loss=5.57493 | acc=0.1256 | tpr=0.6446 | fpr=0.8838 | 7861.6 samples/s | 30.7 steps/s
[Step= 500] | Loss=5.57608 | acc=0.1255 | tpr=0.6489 | fpr=0.8840 | 8177.1 samples/s | 31.9 steps/s
[Step= 550] | Loss=5.57940 | acc=0.1256 | tpr=0.6498 | fpr=0.8839 | 9828.3 samples/s | 38.4 steps/s
Avg test loss: 5.57988, Avg test acc: 0.12555, Avg tpr: 0.65055, Avg fpr: 0.88400, total FA: 122741

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.16837 | acc=0.1291 | tpr=0.5929 | fpr=0.8793 | 5923.7 samples/s | 23.1 steps/s
[Step= 100] | Loss=5.15386 | acc=0.1308 | tpr=0.5906 | fpr=0.8778 | 7284.7 samples/s | 28.5 steps/s
[Step= 150] | Loss=5.14527 | acc=0.1325 | tpr=0.5965 | fpr=0.8760 | 7912.7 samples/s | 30.9 steps/s
[Step= 200] | Loss=5.13802 | acc=0.1328 | tpr=0.5891 | fpr=0.8755 | 8082.5 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.14303 | acc=0.1328 | tpr=0.5852 | fpr=0.8755 | 7731.0 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.13901 | acc=0.1324 | tpr=0.5804 | fpr=0.8757 | 8343.9 samples/s | 32.6 steps/s
[Step= 350] | Loss=5.14467 | acc=0.1323 | tpr=0.5761 | fpr=0.8757 | 8534.1 samples/s | 33.3 steps/s
[Step= 400] | Loss=5.14405 | acc=0.1327 | tpr=0.5744 | fpr=0.8754 | 7506.5 samples/s | 29.3 steps/s
[Step= 450] | Loss=5.14894 | acc=0.1320 | tpr=0.5774 | fpr=0.8760 | 8415.3 samples/s | 32.9 steps/s
[Step= 500] | Loss=5.14756 | acc=0.1321 | tpr=0.5793 | fpr=0.8760 | 8057.4 samples/s | 31.5 steps/s
[Step= 550] | Loss=5.15142 | acc=0.1322 | tpr=0.5790 | fpr=0.8760 | 11037.5 samples/s | 43.1 steps/s
Avg test loss: 5.15205, Avg test acc: 0.13208, Avg tpr: 0.58003, Avg fpr: 0.87607, total FA: 121640

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.37596 | acc=0.1250 | tpr=0.6504 | fpr=0.8844 | 6131.0 samples/s | 23.9 steps/s
[Step= 100] | Loss=5.36531 | acc=0.1291 | tpr=0.6503 | fpr=0.8806 | 7533.3 samples/s | 29.4 steps/s
[Step= 150] | Loss=5.35285 | acc=0.1307 | tpr=0.6628 | fpr=0.8791 | 7506.6 samples/s | 29.3 steps/s
[Step= 200] | Loss=5.34374 | acc=0.1313 | tpr=0.6601 | fpr=0.8784 | 7820.8 samples/s | 30.5 steps/s
[Step= 250] | Loss=5.34576 | acc=0.1309 | tpr=0.6524 | fpr=0.8786 | 8293.3 samples/s | 32.4 steps/s
[Step= 300] | Loss=5.34304 | acc=0.1301 | tpr=0.6516 | fpr=0.8794 | 8046.2 samples/s | 31.4 steps/s
[Step= 350] | Loss=5.34928 | acc=0.1302 | tpr=0.6525 | fpr=0.8793 | 8068.8 samples/s | 31.5 steps/s
[Step= 400] | Loss=5.34814 | acc=0.1304 | tpr=0.6521 | fpr=0.8791 | 8020.6 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.35372 | acc=0.1296 | tpr=0.6553 | fpr=0.8800 | 7991.6 samples/s | 31.2 steps/s
[Step= 500] | Loss=5.35357 | acc=0.1295 | tpr=0.6599 | fpr=0.8801 | 8047.2 samples/s | 31.4 steps/s
[Step= 550] | Loss=5.35795 | acc=0.1295 | tpr=0.6614 | fpr=0.8802 | 11222.1 samples/s | 43.8 steps/s
Avg test loss: 5.35873, Avg test acc: 0.12947, Avg tpr: 0.66244, Avg fpr: 0.88021, total FA: 122216

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.43301 | acc=0.1361 | tpr=0.5088 | fpr=0.8706 | 6035.4 samples/s | 23.6 steps/s
[Step= 100] | Loss=5.41787 | acc=0.1386 | tpr=0.5203 | fpr=0.8685 | 7180.9 samples/s | 28.1 steps/s
[Step= 150] | Loss=5.40750 | acc=0.1401 | tpr=0.5245 | fpr=0.8669 | 8677.6 samples/s | 33.9 steps/s
[Step= 200] | Loss=5.40129 | acc=0.1408 | tpr=0.5246 | fpr=0.8661 | 8254.7 samples/s | 32.2 steps/s
[Step= 250] | Loss=5.40320 | acc=0.1405 | tpr=0.5127 | fpr=0.8663 | 7960.8 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.39857 | acc=0.1399 | tpr=0.5055 | fpr=0.8668 | 8079.8 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.40694 | acc=0.1396 | tpr=0.5028 | fpr=0.8669 | 8006.9 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.40402 | acc=0.1399 | tpr=0.5033 | fpr=0.8668 | 7423.7 samples/s | 29.0 steps/s
[Step= 450] | Loss=5.40906 | acc=0.1393 | tpr=0.5049 | fpr=0.8673 | 8759.4 samples/s | 34.2 steps/s
[Step= 500] | Loss=5.40870 | acc=0.1394 | tpr=0.5079 | fpr=0.8672 | 7827.3 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.41203 | acc=0.1394 | tpr=0.5062 | fpr=0.8672 | 10119.2 samples/s | 39.5 steps/s
Avg test loss: 5.41287, Avg test acc: 0.13943, Avg tpr: 0.50753, Avg fpr: 0.86726, total FA: 120417

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19439 | acc=0.9606 | tpr=0.9469 | fpr=0.0391 | 5956.3 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.20174 | acc=0.9599 | tpr=0.9574 | fpr=0.0401 | 7725.2 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.20386 | acc=0.9584 | tpr=0.9553 | fpr=0.0415 | 7952.6 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.20372 | acc=0.9583 | tpr=0.9585 | fpr=0.0417 | 7577.9 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.20377 | acc=0.9582 | tpr=0.9572 | fpr=0.0418 | 8167.5 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.20678 | acc=0.9577 | tpr=0.9549 | fpr=0.0423 | 8266.3 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.20510 | acc=0.9576 | tpr=0.9543 | fpr=0.0423 | 7688.0 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.20499 | acc=0.9573 | tpr=0.9519 | fpr=0.0426 | 8322.6 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.20822 | acc=0.9568 | tpr=0.9508 | fpr=0.0431 | 8289.9 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.20855 | acc=0.9567 | tpr=0.9515 | fpr=0.0432 | 7033.2 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.20746 | acc=0.9570 | tpr=0.9519 | fpr=0.0429 | 12261.2 samples/s | 47.9 steps/s
Avg test loss: 0.20715, Avg test acc: 0.95701, Avg tpr: 0.95166, Avg fpr: 0.04289, total FA: 5955

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.17467 | acc=0.9600 | tpr=0.8982 | fpr=0.0389 | 5899.0 samples/s | 23.0 steps/s
[Step= 100] | Loss=0.18251 | acc=0.9589 | tpr=0.9168 | fpr=0.0403 | 8061.1 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.18511 | acc=0.9573 | tpr=0.9179 | fpr=0.0420 | 8421.2 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.18541 | acc=0.9577 | tpr=0.9246 | fpr=0.0417 | 7547.5 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.18497 | acc=0.9579 | tpr=0.9266 | fpr=0.0416 | 8283.0 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.18784 | acc=0.9576 | tpr=0.9273 | fpr=0.0419 | 8543.4 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.18655 | acc=0.9576 | tpr=0.9286 | fpr=0.0419 | 7933.5 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.18731 | acc=0.9573 | tpr=0.9256 | fpr=0.0421 | 7469.2 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.19067 | acc=0.9568 | tpr=0.9255 | fpr=0.0427 | 8105.0 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.19008 | acc=0.9568 | tpr=0.9278 | fpr=0.0427 | 8576.2 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.18877 | acc=0.9570 | tpr=0.9288 | fpr=0.0424 | 9234.4 samples/s | 36.1 steps/s
Avg test loss: 0.18857, Avg test acc: 0.95705, Avg tpr: 0.92868, Avg fpr: 0.04243, total FA: 5892

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26467 | acc=0.9527 | tpr=0.9513 | fpr=0.0473 | 6061.2 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.27006 | acc=0.9510 | tpr=0.9531 | fpr=0.0490 | 7732.2 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.27389 | acc=0.9495 | tpr=0.9496 | fpr=0.0505 | 7694.2 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.27484 | acc=0.9494 | tpr=0.9552 | fpr=0.0507 | 7645.7 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.27557 | acc=0.9491 | tpr=0.9546 | fpr=0.0510 | 7489.9 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.27868 | acc=0.9487 | tpr=0.9498 | fpr=0.0513 | 8561.9 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.27684 | acc=0.9487 | tpr=0.9493 | fpr=0.0513 | 8040.2 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.27723 | acc=0.9483 | tpr=0.9458 | fpr=0.0516 | 8204.2 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.28127 | acc=0.9478 | tpr=0.9445 | fpr=0.0521 | 8391.8 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.28147 | acc=0.9477 | tpr=0.9463 | fpr=0.0522 | 7825.6 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.27987 | acc=0.9480 | tpr=0.9475 | fpr=0.0519 | 10777.5 samples/s | 42.1 steps/s
Avg test loss: 0.27960, Avg test acc: 0.94807, Avg tpr: 0.94731, Avg fpr: 0.05192, total FA: 7209

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.17155 | acc=0.9619 | tpr=0.9248 | fpr=0.0375 | 5669.8 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.18066 | acc=0.9605 | tpr=0.9275 | fpr=0.0389 | 8318.4 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.18275 | acc=0.9587 | tpr=0.9265 | fpr=0.0407 | 7972.2 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.18247 | acc=0.9589 | tpr=0.9311 | fpr=0.0406 | 7620.7 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.18270 | acc=0.9585 | tpr=0.9249 | fpr=0.0409 | 8311.5 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.18597 | acc=0.9582 | tpr=0.9229 | fpr=0.0412 | 7990.7 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.18457 | acc=0.9583 | tpr=0.9236 | fpr=0.0411 | 8116.3 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.18464 | acc=0.9581 | tpr=0.9229 | fpr=0.0413 | 7677.9 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.18753 | acc=0.9576 | tpr=0.9221 | fpr=0.0418 | 8463.5 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.18752 | acc=0.9575 | tpr=0.9242 | fpr=0.0419 | 8121.8 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.18639 | acc=0.9577 | tpr=0.9252 | fpr=0.0417 | 10269.5 samples/s | 40.1 steps/s
Avg test loss: 0.18613, Avg test acc: 0.95774, Avg tpr: 0.92512, Avg fpr: 0.04166, total FA: 5785

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.23128 | acc=0.9577 | tpr=0.9381 | fpr=0.0419 | 6087.6 samples/s | 23.8 steps/s
[Step= 100] | Loss=0.24061 | acc=0.9563 | tpr=0.9510 | fpr=0.0436 | 7860.2 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.24389 | acc=0.9546 | tpr=0.9568 | fpr=0.0455 | 7122.8 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.24450 | acc=0.9545 | tpr=0.9585 | fpr=0.0456 | 8130.7 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.24545 | acc=0.9543 | tpr=0.9563 | fpr=0.0458 | 8344.4 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.24912 | acc=0.9538 | tpr=0.9535 | fpr=0.0462 | 8636.2 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.24794 | acc=0.9537 | tpr=0.9530 | fpr=0.0462 | 7772.6 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.24821 | acc=0.9534 | tpr=0.9480 | fpr=0.0465 | 7897.1 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.25223 | acc=0.9530 | tpr=0.9464 | fpr=0.0469 | 7949.7 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.25217 | acc=0.9528 | tpr=0.9463 | fpr=0.0471 | 8225.1 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.25054 | acc=0.9531 | tpr=0.9471 | fpr=0.0467 | 10488.4 samples/s | 41.0 steps/s
Avg test loss: 0.25024, Avg test acc: 0.95317, Avg tpr: 0.94691, Avg fpr: 0.04672, total FA: 6487

server round 35/50

clients selected: [0 4 6 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=30001 Epoch=146.3] | Loss=0.06059 | Reg=0.00106 | acc=0.9531 | L2-Norm=10.298 | L2-Norm(final)=12.276 | 7130.6 samples/s | 111.4 steps/s
[Step=30050 Epoch=146.5] | Loss=0.02436 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.298 | L2-Norm(final)=12.279 | 4939.7 samples/s | 77.2 steps/s
[Step=30100 Epoch=146.8] | Loss=0.02141 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.298 | L2-Norm(final)=12.283 | 5500.6 samples/s | 85.9 steps/s
[Step=30150 Epoch=147.0] | Loss=0.02130 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.298 | L2-Norm(final)=12.289 | 5649.4 samples/s | 88.3 steps/s
[Step=30200 Epoch=147.3] | Loss=0.02100 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.298 | L2-Norm(final)=12.294 | 8395.5 samples/s | 131.2 steps/s
[Step=30250 Epoch=147.5] | Loss=0.02184 | Reg=0.00106 | acc=0.9688 | L2-Norm=10.298 | L2-Norm(final)=12.297 | 2669.0 samples/s | 41.7 steps/s
[Step=30300 Epoch=147.7] | Loss=0.02235 | Reg=0.00106 | acc=0.9688 | L2-Norm=10.298 | L2-Norm(final)=12.299 | 5509.8 samples/s | 86.1 steps/s
[Step=30350 Epoch=148.0] | Loss=0.02198 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.298 | L2-Norm(final)=12.301 | 5632.6 samples/s | 88.0 steps/s
[Step=30400 Epoch=148.2] | Loss=0.02158 | Reg=0.00106 | acc=0.9688 | L2-Norm=10.298 | L2-Norm(final)=12.304 | 7593.1 samples/s | 118.6 steps/s
[Step=30450 Epoch=148.5] | Loss=0.02163 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.298 | L2-Norm(final)=12.307 | 2819.1 samples/s | 44.0 steps/s
[Step=30500 Epoch=148.7] | Loss=0.02187 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.298 | L2-Norm(final)=12.310 | 5409.6 samples/s | 84.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=148.7] | Loss=0.03892 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.298 | L2-Norm(final)=12.335 | 6893.1 samples/s | 107.7 steps/s
[Step=30550 Epoch=149.0] | Loss=0.02457 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.319 | L2-Norm(final)=12.335 | 4359.8 samples/s | 68.1 steps/s
[Step=30600 Epoch=149.2] | Loss=0.02193 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.340 | L2-Norm(final)=12.337 | 4862.9 samples/s | 76.0 steps/s
[Step=30650 Epoch=149.5] | Loss=0.01936 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.355 | L2-Norm(final)=12.339 | 4657.8 samples/s | 72.8 steps/s
[Step=30700 Epoch=149.7] | Loss=0.01863 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.369 | L2-Norm(final)=12.343 | 6894.4 samples/s | 107.7 steps/s
[Step=30750 Epoch=149.9] | Loss=0.01656 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.381 | L2-Norm(final)=12.346 | 2489.2 samples/s | 38.9 steps/s
[Step=30800 Epoch=150.2] | Loss=0.01492 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=12.350 | 4751.8 samples/s | 74.2 steps/s
[Step=30850 Epoch=150.4] | Loss=0.01355 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=12.355 | 4764.2 samples/s | 74.4 steps/s
[Step=30900 Epoch=150.7] | Loss=0.01261 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.407 | L2-Norm(final)=12.359 | 6205.6 samples/s | 97.0 steps/s
[Step=30950 Epoch=150.9] | Loss=0.01183 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.414 | L2-Norm(final)=12.364 | 2618.2 samples/s | 40.9 steps/s
[Step=31000 Epoch=151.2] | Loss=0.01105 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.421 | L2-Norm(final)=12.368 | 4690.5 samples/s | 73.3 steps/s
[Step=31050 Epoch=151.4] | Loss=0.01039 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.427 | L2-Norm(final)=12.372 | 4755.1 samples/s | 74.3 steps/s
[Step=31100 Epoch=151.6] | Loss=0.00999 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.433 | L2-Norm(final)=12.377 | 5665.6 samples/s | 88.5 steps/s
[Step=31150 Epoch=151.9] | Loss=0.00959 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.438 | L2-Norm(final)=12.381 | 2643.3 samples/s | 41.3 steps/s
[Step=31200 Epoch=152.1] | Loss=0.00924 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.443 | L2-Norm(final)=12.385 | 4767.0 samples/s | 74.5 steps/s
[Step=31250 Epoch=152.4] | Loss=0.00888 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.448 | L2-Norm(final)=12.389 | 4743.4 samples/s | 74.1 steps/s
[Step=31300 Epoch=152.6] | Loss=0.00862 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.452 | L2-Norm(final)=12.392 | 5270.5 samples/s | 82.4 steps/s
[Step=31350 Epoch=152.9] | Loss=0.00829 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.456 | L2-Norm(final)=12.396 | 2782.4 samples/s | 43.5 steps/s
[Step=31400 Epoch=153.1] | Loss=0.00815 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.460 | L2-Norm(final)=12.400 | 4791.3 samples/s | 74.9 steps/s
[Step=31450 Epoch=153.4] | Loss=0.00786 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.464 | L2-Norm(final)=12.403 | 4702.0 samples/s | 73.5 steps/s
[Step=31500 Epoch=153.6] | Loss=0.00762 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.468 | L2-Norm(final)=12.407 | 4894.6 samples/s | 76.5 steps/s
[Step=31550 Epoch=153.8] | Loss=0.00743 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=12.410 | 2872.1 samples/s | 44.9 steps/s
[Step=31600 Epoch=154.1] | Loss=0.00722 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.475 | L2-Norm(final)=12.413 | 4777.4 samples/s | 74.6 steps/s
[Step=31650 Epoch=154.3] | Loss=0.00704 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=12.417 | 4704.7 samples/s | 73.5 steps/s
[Step=31700 Epoch=154.6] | Loss=0.00697 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.482 | L2-Norm(final)=12.420 | 4727.6 samples/s | 73.9 steps/s
[Step=31750 Epoch=154.8] | Loss=0.00682 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.485 | L2-Norm(final)=12.423 | 2950.1 samples/s | 46.1 steps/s
[Step=31800 Epoch=155.1] | Loss=0.00670 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.488 | L2-Norm(final)=12.426 | 4768.0 samples/s | 74.5 steps/s
[Step=31850 Epoch=155.3] | Loss=0.00656 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.491 | L2-Norm(final)=12.429 | 4754.9 samples/s | 74.3 steps/s
[Step=31900 Epoch=155.6] | Loss=0.00643 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.494 | L2-Norm(final)=12.432 | 4823.4 samples/s | 75.4 steps/s
[Step=31950 Epoch=155.8] | Loss=0.00627 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=12.435 | 2905.4 samples/s | 45.4 steps/s
[Step=32000 Epoch=156.0] | Loss=0.00614 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.500 | L2-Norm(final)=12.438 | 4779.9 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step32000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=156.9] | Loss=0.00825 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.298 | L2-Norm(final)=14.216 | 5688.9 samples/s | 88.9 steps/s
[Step=32050 Epoch=157.2] | Loss=0.01980 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.300 | L2-Norm(final)=14.222 | 5300.6 samples/s | 82.8 steps/s
[Step=32100 Epoch=157.4] | Loss=0.01867 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.300 | L2-Norm(final)=14.228 | 5496.6 samples/s | 85.9 steps/s
[Step=32150 Epoch=157.7] | Loss=0.01883 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.300 | L2-Norm(final)=14.235 | 5507.7 samples/s | 86.1 steps/s
[Step=32200 Epoch=157.9] | Loss=0.02036 | Reg=0.00106 | acc=0.9688 | L2-Norm=10.300 | L2-Norm(final)=14.241 | 9004.5 samples/s | 140.7 steps/s
[Step=32250 Epoch=158.1] | Loss=0.01964 | Reg=0.00106 | acc=0.9688 | L2-Norm=10.300 | L2-Norm(final)=14.246 | 2606.3 samples/s | 40.7 steps/s
[Step=32300 Epoch=158.4] | Loss=0.01979 | Reg=0.00106 | acc=0.9531 | L2-Norm=10.300 | L2-Norm(final)=14.250 | 5786.6 samples/s | 90.4 steps/s
[Step=32350 Epoch=158.6] | Loss=0.01967 | Reg=0.00106 | acc=0.9688 | L2-Norm=10.300 | L2-Norm(final)=14.254 | 5508.0 samples/s | 86.1 steps/s
[Step=32400 Epoch=158.9] | Loss=0.02008 | Reg=0.00106 | acc=0.9688 | L2-Norm=10.300 | L2-Norm(final)=14.258 | 7998.4 samples/s | 125.0 steps/s
[Step=32450 Epoch=159.1] | Loss=0.01970 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.300 | L2-Norm(final)=14.261 | 2712.7 samples/s | 42.4 steps/s
[Step=32500 Epoch=159.4] | Loss=0.01986 | Reg=0.00106 | acc=0.9688 | L2-Norm=10.300 | L2-Norm(final)=14.265 | 5491.2 samples/s | 85.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=159.4] | Loss=0.02119 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.300 | L2-Norm(final)=14.300 | 7526.6 samples/s | 117.6 steps/s
[Step=32550 Epoch=159.6] | Loss=0.02271 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.319 | L2-Norm(final)=14.298 | 3867.3 samples/s | 60.4 steps/s
[Step=32600 Epoch=159.9] | Loss=0.02103 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.336 | L2-Norm(final)=14.297 | 4760.0 samples/s | 74.4 steps/s
[Step=32650 Epoch=160.1] | Loss=0.01945 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.351 | L2-Norm(final)=14.299 | 4774.4 samples/s | 74.6 steps/s
[Step=32700 Epoch=160.4] | Loss=0.01822 | Reg=0.00107 | acc=0.9688 | L2-Norm=10.363 | L2-Norm(final)=14.301 | 7039.7 samples/s | 110.0 steps/s
[Step=32750 Epoch=160.6] | Loss=0.01609 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.374 | L2-Norm(final)=14.305 | 2449.5 samples/s | 38.3 steps/s
[Step=32800 Epoch=160.8] | Loss=0.01418 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.384 | L2-Norm(final)=14.309 | 4818.7 samples/s | 75.3 steps/s
[Step=32850 Epoch=161.1] | Loss=0.01288 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.392 | L2-Norm(final)=14.313 | 4715.9 samples/s | 73.7 steps/s
[Step=32900 Epoch=161.3] | Loss=0.01194 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=14.317 | 6507.7 samples/s | 101.7 steps/s
[Step=32950 Epoch=161.6] | Loss=0.01104 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.406 | L2-Norm(final)=14.321 | 2505.1 samples/s | 39.1 steps/s
[Step=33000 Epoch=161.8] | Loss=0.01049 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.412 | L2-Norm(final)=14.325 | 4796.9 samples/s | 75.0 steps/s
[Step=33050 Epoch=162.1] | Loss=0.00983 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.418 | L2-Norm(final)=14.328 | 4730.2 samples/s | 73.9 steps/s
[Step=33100 Epoch=162.3] | Loss=0.00937 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.423 | L2-Norm(final)=14.332 | 6159.7 samples/s | 96.2 steps/s
[Step=33150 Epoch=162.6] | Loss=0.00886 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.428 | L2-Norm(final)=14.336 | 2567.2 samples/s | 40.1 steps/s
[Step=33200 Epoch=162.8] | Loss=0.00842 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.432 | L2-Norm(final)=14.339 | 4739.1 samples/s | 74.0 steps/s
[Step=33250 Epoch=163.1] | Loss=0.00812 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.436 | L2-Norm(final)=14.342 | 4781.7 samples/s | 74.7 steps/s
[Step=33300 Epoch=163.3] | Loss=0.00783 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.440 | L2-Norm(final)=14.346 | 5758.0 samples/s | 90.0 steps/s
[Step=33350 Epoch=163.5] | Loss=0.00749 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.444 | L2-Norm(final)=14.349 | 2644.5 samples/s | 41.3 steps/s
[Step=33400 Epoch=163.8] | Loss=0.00723 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.448 | L2-Norm(final)=14.352 | 4773.2 samples/s | 74.6 steps/s
[Step=33450 Epoch=164.0] | Loss=0.00704 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.452 | L2-Norm(final)=14.355 | 4829.9 samples/s | 75.5 steps/s
[Step=33500 Epoch=164.3] | Loss=0.00685 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.455 | L2-Norm(final)=14.358 | 5408.9 samples/s | 84.5 steps/s
[Step=33550 Epoch=164.5] | Loss=0.00663 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.458 | L2-Norm(final)=14.361 | 2716.8 samples/s | 42.4 steps/s
[Step=33600 Epoch=164.8] | Loss=0.00646 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.461 | L2-Norm(final)=14.364 | 4805.5 samples/s | 75.1 steps/s
[Step=33650 Epoch=165.0] | Loss=0.00634 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.465 | L2-Norm(final)=14.366 | 4733.4 samples/s | 74.0 steps/s
[Step=33700 Epoch=165.3] | Loss=0.00617 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.468 | L2-Norm(final)=14.369 | 5249.0 samples/s | 82.0 steps/s
[Step=33750 Epoch=165.5] | Loss=0.00602 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.471 | L2-Norm(final)=14.372 | 2776.4 samples/s | 43.4 steps/s
[Step=33800 Epoch=165.7] | Loss=0.00586 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.473 | L2-Norm(final)=14.375 | 4780.1 samples/s | 74.7 steps/s
[Step=33850 Epoch=166.0] | Loss=0.00573 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.476 | L2-Norm(final)=14.377 | 4748.1 samples/s | 74.2 steps/s
[Step=33900 Epoch=166.2] | Loss=0.00562 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=14.380 | 4941.4 samples/s | 77.2 steps/s
[Step=33950 Epoch=166.5] | Loss=0.00556 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=14.383 | 2871.2 samples/s | 44.9 steps/s
[Step=34000 Epoch=166.7] | Loss=0.00555 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.484 | L2-Norm(final)=14.385 | 4715.6 samples/s | 73.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step34000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=304.4] | Loss=0.00002 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.298 | L2-Norm(final)=15.344 | 7041.6 samples/s | 110.0 steps/s
[Step=32050 Epoch=304.9] | Loss=0.00101 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=15.345 | 4446.8 samples/s | 69.5 steps/s
[Step=32100 Epoch=305.4] | Loss=0.00101 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=15.347 | 8362.7 samples/s | 130.7 steps/s
[Step=32150 Epoch=305.8] | Loss=0.00092 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=15.352 | 2554.2 samples/s | 39.9 steps/s
[Step=32200 Epoch=306.3] | Loss=0.00096 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=15.358 | 7380.3 samples/s | 115.3 steps/s
[Step=32250 Epoch=306.8] | Loss=0.00092 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=15.361 | 2620.5 samples/s | 40.9 steps/s
[Step=32300 Epoch=307.3] | Loss=0.00094 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=15.364 | 6586.6 samples/s | 102.9 steps/s
[Step=32350 Epoch=307.7] | Loss=0.00092 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=15.368 | 2802.3 samples/s | 43.8 steps/s
[Step=32400 Epoch=308.2] | Loss=0.00091 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=15.371 | 5881.1 samples/s | 91.9 steps/s
[Step=32450 Epoch=308.7] | Loss=0.00091 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=15.375 | 2959.2 samples/s | 46.2 steps/s
[Step=32500 Epoch=309.2] | Loss=0.00089 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=15.380 | 5254.0 samples/s | 82.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=309.2] | Loss=0.00363 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=15.425 | 6568.3 samples/s | 102.6 steps/s
[Step=32550 Epoch=309.6] | Loss=0.00209 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.330 | L2-Norm(final)=15.419 | 4251.0 samples/s | 66.4 steps/s
[Step=32600 Epoch=310.1] | Loss=0.00119 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.345 | L2-Norm(final)=15.418 | 6395.0 samples/s | 99.9 steps/s
[Step=32650 Epoch=310.6] | Loss=0.00081 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.351 | L2-Norm(final)=15.419 | 2371.4 samples/s | 37.1 steps/s
[Step=32700 Epoch=311.1] | Loss=0.00061 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.353 | L2-Norm(final)=15.419 | 5988.0 samples/s | 93.6 steps/s
[Step=32750 Epoch=311.5] | Loss=0.00050 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.352 | L2-Norm(final)=15.420 | 2473.4 samples/s | 38.6 steps/s
[Step=32800 Epoch=312.0] | Loss=0.00042 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.351 | L2-Norm(final)=15.420 | 5473.5 samples/s | 85.5 steps/s
[Step=32850 Epoch=312.5] | Loss=0.00036 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.349 | L2-Norm(final)=15.421 | 2564.9 samples/s | 40.1 steps/s
[Step=32900 Epoch=313.0] | Loss=0.00031 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.347 | L2-Norm(final)=15.421 | 5055.2 samples/s | 79.0 steps/s
[Step=32950 Epoch=313.4] | Loss=0.00028 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.345 | L2-Norm(final)=15.421 | 2701.0 samples/s | 42.2 steps/s
[Step=33000 Epoch=313.9] | Loss=0.00025 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.343 | L2-Norm(final)=15.422 | 4597.9 samples/s | 71.8 steps/s
[Step=33050 Epoch=314.4] | Loss=0.00023 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.340 | L2-Norm(final)=15.422 | 2829.5 samples/s | 44.2 steps/s
[Step=33100 Epoch=314.9] | Loss=0.00021 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.337 | L2-Norm(final)=15.422 | 4584.9 samples/s | 71.6 steps/s
[Step=33150 Epoch=315.3] | Loss=0.00020 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.335 | L2-Norm(final)=15.423 | 2825.2 samples/s | 44.1 steps/s
[Step=33200 Epoch=315.8] | Loss=0.00018 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.332 | L2-Norm(final)=15.423 | 4554.4 samples/s | 71.2 steps/s
[Step=33250 Epoch=316.3] | Loss=0.00017 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.329 | L2-Norm(final)=15.423 | 2887.4 samples/s | 45.1 steps/s
[Step=33300 Epoch=316.8] | Loss=0.00016 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.326 | L2-Norm(final)=15.424 | 4419.3 samples/s | 69.1 steps/s
[Step=33350 Epoch=317.2] | Loss=0.00015 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.323 | L2-Norm(final)=15.424 | 2967.6 samples/s | 46.4 steps/s
[Step=33400 Epoch=317.7] | Loss=0.00014 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.319 | L2-Norm(final)=15.424 | 4359.2 samples/s | 68.1 steps/s
[Step=33450 Epoch=318.2] | Loss=0.00014 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.316 | L2-Norm(final)=15.424 | 6722.5 samples/s | 105.0 steps/s
[Step=33500 Epoch=318.7] | Loss=0.00013 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.313 | L2-Norm(final)=15.425 | 2354.0 samples/s | 36.8 steps/s
[Step=33550 Epoch=319.1] | Loss=0.00012 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.310 | L2-Norm(final)=15.425 | 6209.9 samples/s | 97.0 steps/s
[Step=33600 Epoch=319.6] | Loss=0.00012 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.307 | L2-Norm(final)=15.425 | 2460.4 samples/s | 38.4 steps/s
[Step=33650 Epoch=320.1] | Loss=0.00011 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.303 | L2-Norm(final)=15.426 | 5547.6 samples/s | 86.7 steps/s
[Step=33700 Epoch=320.6] | Loss=0.00011 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.300 | L2-Norm(final)=15.426 | 2542.4 samples/s | 39.7 steps/s
[Step=33750 Epoch=321.0] | Loss=0.00011 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.296 | L2-Norm(final)=15.426 | 5203.5 samples/s | 81.3 steps/s
[Step=33800 Epoch=321.5] | Loss=0.00010 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.293 | L2-Norm(final)=15.426 | 2636.6 samples/s | 41.2 steps/s
[Step=33850 Epoch=322.0] | Loss=0.00010 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.289 | L2-Norm(final)=15.426 | 4811.5 samples/s | 75.2 steps/s
[Step=33900 Epoch=322.5] | Loss=0.00009 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.286 | L2-Norm(final)=15.427 | 2756.9 samples/s | 43.1 steps/s
[Step=33950 Epoch=322.9] | Loss=0.00009 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.282 | L2-Norm(final)=15.427 | 4527.2 samples/s | 70.7 steps/s
[Step=34000 Epoch=323.4] | Loss=0.00009 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.279 | L2-Norm(final)=15.427 | 2873.5 samples/s | 44.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step34000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=320.4] | Loss=0.00130 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.298 | L2-Norm(final)=15.534 | 6445.1 samples/s | 100.7 steps/s
[Step=34050 Epoch=320.8] | Loss=0.00050 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.297 | L2-Norm(final)=15.535 | 4945.6 samples/s | 77.3 steps/s
[Step=34100 Epoch=321.3] | Loss=0.00062 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.297 | L2-Norm(final)=15.539 | 7830.7 samples/s | 122.4 steps/s
[Step=34150 Epoch=321.8] | Loss=0.00055 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.297 | L2-Norm(final)=15.545 | 2606.9 samples/s | 40.7 steps/s
[Step=34200 Epoch=322.3] | Loss=0.00061 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.297 | L2-Norm(final)=15.550 | 6994.2 samples/s | 109.3 steps/s
[Step=34250 Epoch=322.7] | Loss=0.00060 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.297 | L2-Norm(final)=15.555 | 2664.6 samples/s | 41.6 steps/s
[Step=34300 Epoch=323.2] | Loss=0.00058 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.297 | L2-Norm(final)=15.559 | 5958.6 samples/s | 93.1 steps/s
[Step=34350 Epoch=323.7] | Loss=0.00058 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.297 | L2-Norm(final)=15.564 | 2892.1 samples/s | 45.2 steps/s
[Step=34400 Epoch=324.1] | Loss=0.00060 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.297 | L2-Norm(final)=15.569 | 5537.4 samples/s | 86.5 steps/s
[Step=34450 Epoch=324.6] | Loss=0.00059 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.296 | L2-Norm(final)=15.574 | 3013.0 samples/s | 47.1 steps/s
[Step=34500 Epoch=325.1] | Loss=0.00059 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.296 | L2-Norm(final)=15.579 | 5184.7 samples/s | 81.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=325.1] | Loss=0.00035 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.296 | L2-Norm(final)=15.628 | 7225.2 samples/s | 112.9 steps/s
[Step=34550 Epoch=325.6] | Loss=0.00093 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.304 | L2-Norm(final)=15.631 | 3852.8 samples/s | 60.2 steps/s
[Step=34600 Epoch=326.0] | Loss=0.00069 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.316 | L2-Norm(final)=15.631 | 6575.8 samples/s | 102.7 steps/s
[Step=34650 Epoch=326.5] | Loss=0.00050 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.322 | L2-Norm(final)=15.633 | 2410.2 samples/s | 37.7 steps/s
[Step=34700 Epoch=327.0] | Loss=0.00039 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.323 | L2-Norm(final)=15.634 | 5755.2 samples/s | 89.9 steps/s
[Step=34750 Epoch=327.4] | Loss=0.00032 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.323 | L2-Norm(final)=15.634 | 2545.9 samples/s | 39.8 steps/s
[Step=34800 Epoch=327.9] | Loss=0.00026 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.322 | L2-Norm(final)=15.635 | 5119.8 samples/s | 80.0 steps/s
[Step=34850 Epoch=328.4] | Loss=0.00023 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.320 | L2-Norm(final)=15.636 | 2631.4 samples/s | 41.1 steps/s
[Step=34900 Epoch=328.9] | Loss=0.00020 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.318 | L2-Norm(final)=15.636 | 4801.8 samples/s | 75.0 steps/s
[Step=34950 Epoch=329.3] | Loss=0.00018 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.315 | L2-Norm(final)=15.637 | 2781.5 samples/s | 43.5 steps/s
[Step=35000 Epoch=329.8] | Loss=0.00016 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.312 | L2-Norm(final)=15.637 | 4495.2 samples/s | 70.2 steps/s
[Step=35050 Epoch=330.3] | Loss=0.00015 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.309 | L2-Norm(final)=15.638 | 2895.2 samples/s | 45.2 steps/s
[Step=35100 Epoch=330.7] | Loss=0.00014 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.306 | L2-Norm(final)=15.638 | 4506.5 samples/s | 70.4 steps/s
[Step=35150 Epoch=331.2] | Loss=0.00013 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.303 | L2-Norm(final)=15.638 | 2917.2 samples/s | 45.6 steps/s
[Step=35200 Epoch=331.7] | Loss=0.00012 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.300 | L2-Norm(final)=15.639 | 4430.0 samples/s | 69.2 steps/s
[Step=35250 Epoch=332.2] | Loss=0.00011 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.297 | L2-Norm(final)=15.639 | 3137.7 samples/s | 49.0 steps/s
[Step=35300 Epoch=332.6] | Loss=0.00010 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.293 | L2-Norm(final)=15.639 | 3939.7 samples/s | 61.6 steps/s
[Step=35350 Epoch=333.1] | Loss=0.00010 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=15.640 | 6678.1 samples/s | 104.3 steps/s
[Step=35400 Epoch=333.6] | Loss=0.00009 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.286 | L2-Norm(final)=15.640 | 2376.0 samples/s | 37.1 steps/s
[Step=35450 Epoch=334.0] | Loss=0.00009 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.283 | L2-Norm(final)=15.640 | 5895.1 samples/s | 92.1 steps/s
[Step=35500 Epoch=334.5] | Loss=0.00008 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.279 | L2-Norm(final)=15.641 | 2481.2 samples/s | 38.8 steps/s
[Step=35550 Epoch=335.0] | Loss=0.00008 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.276 | L2-Norm(final)=15.641 | 5356.2 samples/s | 83.7 steps/s
[Step=35600 Epoch=335.5] | Loss=0.00008 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.272 | L2-Norm(final)=15.641 | 2619.1 samples/s | 40.9 steps/s
[Step=35650 Epoch=335.9] | Loss=0.00007 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.268 | L2-Norm(final)=15.642 | 4829.3 samples/s | 75.5 steps/s
[Step=35700 Epoch=336.4] | Loss=0.00007 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.265 | L2-Norm(final)=15.642 | 2757.2 samples/s | 43.1 steps/s
[Step=35750 Epoch=336.9] | Loss=0.00007 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.261 | L2-Norm(final)=15.642 | 4573.9 samples/s | 71.5 steps/s
[Step=35800 Epoch=337.3] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.257 | L2-Norm(final)=15.642 | 2803.6 samples/s | 43.8 steps/s
[Step=35850 Epoch=337.8] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.253 | L2-Norm(final)=15.643 | 4551.6 samples/s | 71.1 steps/s
[Step=35900 Epoch=338.3] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.249 | L2-Norm(final)=15.643 | 2863.1 samples/s | 44.7 steps/s
[Step=35950 Epoch=338.8] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.245 | L2-Norm(final)=15.643 | 4543.4 samples/s | 71.0 steps/s
[Step=36000 Epoch=339.2] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.241 | L2-Norm(final)=15.644 | 2942.0 samples/s | 46.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step36000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=36001 Epoch=343.1] | Loss=0.00006 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.298 | L2-Norm(final)=16.332 | 6665.3 samples/s | 104.1 steps/s
[Step=36050 Epoch=343.6] | Loss=0.00119 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.296 | L2-Norm(final)=16.345 | 4779.0 samples/s | 74.7 steps/s
[Step=36100 Epoch=344.1] | Loss=0.00187 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=16.355 | 8199.3 samples/s | 128.1 steps/s
[Step=36150 Epoch=344.5] | Loss=0.00180 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=16.366 | 2554.4 samples/s | 39.9 steps/s
[Step=36200 Epoch=345.0] | Loss=0.00182 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=16.376 | 7503.4 samples/s | 117.2 steps/s
[Step=36250 Epoch=345.5] | Loss=0.00183 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=16.385 | 2617.6 samples/s | 40.9 steps/s
[Step=36300 Epoch=346.0] | Loss=0.00182 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=16.393 | 6851.1 samples/s | 107.0 steps/s
[Step=36350 Epoch=346.4] | Loss=0.00184 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=16.401 | 2748.9 samples/s | 43.0 steps/s
[Step=36400 Epoch=346.9] | Loss=0.00188 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=16.409 | 6229.4 samples/s | 97.3 steps/s
[Step=36450 Epoch=347.4] | Loss=0.00187 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=16.417 | 2836.8 samples/s | 44.3 steps/s
[Step=36500 Epoch=347.9] | Loss=0.00186 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=16.425 | 5753.8 samples/s | 89.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=347.9] | Loss=0.00111 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=16.499 | 6757.6 samples/s | 105.6 steps/s
[Step=36550 Epoch=348.4] | Loss=0.00438 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.327 | L2-Norm(final)=16.495 | 4122.6 samples/s | 64.4 steps/s
[Step=36600 Epoch=348.8] | Loss=0.00233 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.346 | L2-Norm(final)=16.494 | 6559.9 samples/s | 102.5 steps/s
[Step=36650 Epoch=349.3] | Loss=0.00156 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.353 | L2-Norm(final)=16.495 | 2385.0 samples/s | 37.3 steps/s
[Step=36700 Epoch=349.8] | Loss=0.00119 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.355 | L2-Norm(final)=16.495 | 6065.0 samples/s | 94.8 steps/s
[Step=36750 Epoch=350.3] | Loss=0.00095 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.356 | L2-Norm(final)=16.495 | 2442.7 samples/s | 38.2 steps/s
[Step=36800 Epoch=350.7] | Loss=0.00080 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.355 | L2-Norm(final)=16.496 | 5656.7 samples/s | 88.4 steps/s
[Step=36850 Epoch=351.2] | Loss=0.00069 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.353 | L2-Norm(final)=16.496 | 2526.4 samples/s | 39.5 steps/s
[Step=36900 Epoch=351.7] | Loss=0.00060 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.351 | L2-Norm(final)=16.496 | 5282.4 samples/s | 82.5 steps/s
[Step=36950 Epoch=352.2] | Loss=0.00054 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.349 | L2-Norm(final)=16.497 | 2608.7 samples/s | 40.8 steps/s
[Step=37000 Epoch=352.6] | Loss=0.00049 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.347 | L2-Norm(final)=16.497 | 4927.7 samples/s | 77.0 steps/s
[Step=37050 Epoch=353.1] | Loss=0.00044 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.344 | L2-Norm(final)=16.497 | 2701.5 samples/s | 42.2 steps/s
[Step=37100 Epoch=353.6] | Loss=0.00041 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.342 | L2-Norm(final)=16.498 | 4665.0 samples/s | 72.9 steps/s
[Step=37150 Epoch=354.1] | Loss=0.00038 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.339 | L2-Norm(final)=16.498 | 2827.0 samples/s | 44.2 steps/s
[Step=37200 Epoch=354.5] | Loss=0.00035 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.336 | L2-Norm(final)=16.498 | 4527.6 samples/s | 70.7 steps/s
[Step=37250 Epoch=355.0] | Loss=0.00033 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.333 | L2-Norm(final)=16.498 | 2828.4 samples/s | 44.2 steps/s
[Step=37300 Epoch=355.5] | Loss=0.00031 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.331 | L2-Norm(final)=16.499 | 4625.1 samples/s | 72.3 steps/s
[Step=37350 Epoch=356.0] | Loss=0.00029 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.328 | L2-Norm(final)=16.499 | 2838.6 samples/s | 44.4 steps/s
[Step=37400 Epoch=356.5] | Loss=0.00027 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.325 | L2-Norm(final)=16.499 | 4540.0 samples/s | 70.9 steps/s
[Step=37450 Epoch=356.9] | Loss=0.00026 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.322 | L2-Norm(final)=16.499 | 2840.5 samples/s | 44.4 steps/s
[Step=37500 Epoch=357.4] | Loss=0.00025 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.318 | L2-Norm(final)=16.499 | 4537.8 samples/s | 70.9 steps/s
[Step=37550 Epoch=357.9] | Loss=0.00024 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.315 | L2-Norm(final)=16.500 | 7305.1 samples/s | 114.1 steps/s
[Step=37600 Epoch=358.4] | Loss=0.00023 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.312 | L2-Norm(final)=16.500 | 2296.9 samples/s | 35.9 steps/s
[Step=37650 Epoch=358.8] | Loss=0.00022 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.309 | L2-Norm(final)=16.500 | 6610.4 samples/s | 103.3 steps/s
[Step=37700 Epoch=359.3] | Loss=0.00021 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.306 | L2-Norm(final)=16.500 | 2404.9 samples/s | 37.6 steps/s
[Step=37750 Epoch=359.8] | Loss=0.00020 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.302 | L2-Norm(final)=16.501 | 5917.1 samples/s | 92.5 steps/s
[Step=37800 Epoch=360.3] | Loss=0.00019 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.299 | L2-Norm(final)=16.501 | 2440.3 samples/s | 38.1 steps/s
[Step=37850 Epoch=360.7] | Loss=0.00018 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=16.501 | 5656.5 samples/s | 88.4 steps/s
[Step=37900 Epoch=361.2] | Loss=0.00018 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.292 | L2-Norm(final)=16.501 | 2531.5 samples/s | 39.6 steps/s
[Step=37950 Epoch=361.7] | Loss=0.00017 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.288 | L2-Norm(final)=16.501 | 5255.3 samples/s | 82.1 steps/s
[Step=38000 Epoch=362.2] | Loss=0.00017 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.285 | L2-Norm(final)=16.502 | 2624.7 samples/s | 41.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step38000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08094 | acc=0.9650 | tpr=0.9726 | fpr=0.0515 | 5657.6 samples/s | 22.1 steps/s
Avg test loss: 0.08651, Avg test acc: 0.96242, Avg tpr: 0.97121, Avg fpr: 0.05692, total FA: 444

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09619 | acc=0.9623 | tpr=0.9816 | fpr=0.0798 | 5871.6 samples/s | 22.9 steps/s
Avg test loss: 0.09959, Avg test acc: 0.96065, Avg tpr: 0.97989, Avg fpr: 0.08166, total FA: 637

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09007 | acc=0.9619 | tpr=0.9709 | fpr=0.0577 | 5920.5 samples/s | 23.1 steps/s
Avg test loss: 0.09443, Avg test acc: 0.95989, Avg tpr: 0.96794, Avg fpr: 0.05781, total FA: 451

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09201 | acc=0.9599 | tpr=0.9784 | fpr=0.0803 | 5877.9 samples/s | 23.0 steps/s
Avg test loss: 0.09632, Avg test acc: 0.95941, Avg tpr: 0.97826, Avg fpr: 0.08204, total FA: 640

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08309 | acc=0.9623 | tpr=0.9739 | fpr=0.0629 | 5971.2 samples/s | 23.3 steps/s
Avg test loss: 0.08720, Avg test acc: 0.96053, Avg tpr: 0.97156, Avg fpr: 0.06371, total FA: 497

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.69048 | acc=0.2839 | tpr=0.0211 | fpr=0.1454 | 6206.2 samples/s | 24.2 steps/s
Avg test loss: 5.69765, Avg test acc: 0.28284, Avg tpr: 0.02005, Avg fpr: 0.13921, total FA: 1086

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.79264 | acc=0.2985 | tpr=0.0333 | fpr=0.1256 | 6156.2 samples/s | 24.0 steps/s
Avg test loss: 4.79965, Avg test acc: 0.29429, Avg tpr: 0.03142, Avg fpr: 0.12755, total FA: 995

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.07399 | acc=0.2930 | tpr=0.0216 | fpr=0.1177 | 6052.6 samples/s | 23.6 steps/s
Avg test loss: 5.08425, Avg test acc: 0.29021, Avg tpr: 0.02116, Avg fpr: 0.11806, total FA: 921

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.25868 | acc=0.2785 | tpr=0.0185 | fpr=0.1568 | 5988.4 samples/s | 23.4 steps/s
Avg test loss: 5.26064, Avg test acc: 0.27811, Avg tpr: 0.01865, Avg fpr: 0.15126, total FA: 1180

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.79580 | acc=0.2959 | tpr=0.0181 | fpr=0.1008 | 5966.6 samples/s | 23.3 steps/s
Avg test loss: 4.81165, Avg test acc: 0.29538, Avg tpr: 0.01877, Avg fpr: 0.09627, total FA: 751

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.08771 | acc=0.1305 | tpr=0.5973 | fpr=0.8779 | 5822.1 samples/s | 22.7 steps/s
[Step= 100] | Loss=5.06976 | acc=0.1343 | tpr=0.5821 | fpr=0.8740 | 8071.9 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.06058 | acc=0.1368 | tpr=0.5980 | fpr=0.8716 | 8426.9 samples/s | 32.9 steps/s
[Step= 200] | Loss=5.05072 | acc=0.1373 | tpr=0.5913 | fpr=0.8710 | 8043.7 samples/s | 31.4 steps/s
[Step= 250] | Loss=5.05481 | acc=0.1368 | tpr=0.5799 | fpr=0.8713 | 8021.5 samples/s | 31.3 steps/s
[Step= 300] | Loss=5.04869 | acc=0.1367 | tpr=0.5709 | fpr=0.8712 | 7314.1 samples/s | 28.6 steps/s
[Step= 350] | Loss=5.05347 | acc=0.1366 | tpr=0.5692 | fpr=0.8712 | 8265.9 samples/s | 32.3 steps/s
[Step= 400] | Loss=5.05078 | acc=0.1372 | tpr=0.5689 | fpr=0.8707 | 8134.7 samples/s | 31.8 steps/s
[Step= 450] | Loss=5.05508 | acc=0.1367 | tpr=0.5735 | fpr=0.8713 | 7825.0 samples/s | 30.6 steps/s
[Step= 500] | Loss=5.05506 | acc=0.1366 | tpr=0.5771 | fpr=0.8714 | 7983.8 samples/s | 31.2 steps/s
[Step= 550] | Loss=5.05806 | acc=0.1365 | tpr=0.5778 | fpr=0.8715 | 10731.1 samples/s | 41.9 steps/s
Avg test loss: 5.05828, Avg test acc: 0.13649, Avg tpr: 0.57884, Avg fpr: 0.87155, total FA: 121013

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.59862 | acc=0.1206 | tpr=0.6327 | fpr=0.8886 | 6269.0 samples/s | 24.5 steps/s
[Step= 100] | Loss=5.58796 | acc=0.1243 | tpr=0.6354 | fpr=0.8853 | 7153.2 samples/s | 27.9 steps/s
[Step= 150] | Loss=5.57493 | acc=0.1267 | tpr=0.6527 | fpr=0.8830 | 8140.2 samples/s | 31.8 steps/s
[Step= 200] | Loss=5.56790 | acc=0.1272 | tpr=0.6492 | fpr=0.8823 | 7634.8 samples/s | 29.8 steps/s
[Step= 250] | Loss=5.57204 | acc=0.1271 | tpr=0.6498 | fpr=0.8824 | 8203.4 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.56781 | acc=0.1262 | tpr=0.6429 | fpr=0.8832 | 8568.8 samples/s | 33.5 steps/s
[Step= 350] | Loss=5.57367 | acc=0.1258 | tpr=0.6381 | fpr=0.8835 | 8012.4 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.57090 | acc=0.1263 | tpr=0.6406 | fpr=0.8831 | 8068.3 samples/s | 31.5 steps/s
[Step= 450] | Loss=5.57493 | acc=0.1256 | tpr=0.6446 | fpr=0.8838 | 8466.5 samples/s | 33.1 steps/s
[Step= 500] | Loss=5.57608 | acc=0.1255 | tpr=0.6489 | fpr=0.8840 | 7422.0 samples/s | 29.0 steps/s
[Step= 550] | Loss=5.57940 | acc=0.1256 | tpr=0.6498 | fpr=0.8839 | 10090.0 samples/s | 39.4 steps/s
Avg test loss: 5.57988, Avg test acc: 0.12555, Avg tpr: 0.65055, Avg fpr: 0.88400, total FA: 122741

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.16837 | acc=0.1291 | tpr=0.5929 | fpr=0.8793 | 5951.5 samples/s | 23.2 steps/s
[Step= 100] | Loss=5.15386 | acc=0.1308 | tpr=0.5906 | fpr=0.8778 | 7814.8 samples/s | 30.5 steps/s
[Step= 150] | Loss=5.14527 | acc=0.1325 | tpr=0.5965 | fpr=0.8760 | 8145.5 samples/s | 31.8 steps/s
[Step= 200] | Loss=5.13802 | acc=0.1328 | tpr=0.5891 | fpr=0.8755 | 8373.4 samples/s | 32.7 steps/s
[Step= 250] | Loss=5.14303 | acc=0.1328 | tpr=0.5852 | fpr=0.8755 | 8070.1 samples/s | 31.5 steps/s
[Step= 300] | Loss=5.13901 | acc=0.1324 | tpr=0.5804 | fpr=0.8757 | 6986.8 samples/s | 27.3 steps/s
[Step= 350] | Loss=5.14467 | acc=0.1323 | tpr=0.5761 | fpr=0.8757 | 8495.0 samples/s | 33.2 steps/s
[Step= 400] | Loss=5.14405 | acc=0.1327 | tpr=0.5744 | fpr=0.8754 | 8214.0 samples/s | 32.1 steps/s
[Step= 450] | Loss=5.14894 | acc=0.1320 | tpr=0.5774 | fpr=0.8760 | 8374.2 samples/s | 32.7 steps/s
[Step= 500] | Loss=5.14756 | acc=0.1321 | tpr=0.5793 | fpr=0.8760 | 8025.7 samples/s | 31.4 steps/s
[Step= 550] | Loss=5.15142 | acc=0.1322 | tpr=0.5790 | fpr=0.8760 | 9723.5 samples/s | 38.0 steps/s
Avg test loss: 5.15205, Avg test acc: 0.13208, Avg tpr: 0.58003, Avg fpr: 0.87607, total FA: 121640

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.37596 | acc=0.1250 | tpr=0.6504 | fpr=0.8844 | 5992.7 samples/s | 23.4 steps/s
[Step= 100] | Loss=5.36531 | acc=0.1291 | tpr=0.6503 | fpr=0.8806 | 8128.3 samples/s | 31.8 steps/s
[Step= 150] | Loss=5.35285 | acc=0.1307 | tpr=0.6628 | fpr=0.8791 | 8007.9 samples/s | 31.3 steps/s
[Step= 200] | Loss=5.34374 | acc=0.1313 | tpr=0.6601 | fpr=0.8784 | 7501.0 samples/s | 29.3 steps/s
[Step= 250] | Loss=5.34576 | acc=0.1309 | tpr=0.6524 | fpr=0.8786 | 8179.4 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.34304 | acc=0.1301 | tpr=0.6516 | fpr=0.8794 | 8699.2 samples/s | 34.0 steps/s
[Step= 350] | Loss=5.34928 | acc=0.1302 | tpr=0.6525 | fpr=0.8793 | 7932.1 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.34814 | acc=0.1304 | tpr=0.6521 | fpr=0.8791 | 7799.5 samples/s | 30.5 steps/s
[Step= 450] | Loss=5.35372 | acc=0.1296 | tpr=0.6553 | fpr=0.8800 | 8094.5 samples/s | 31.6 steps/s
[Step= 500] | Loss=5.35357 | acc=0.1295 | tpr=0.6599 | fpr=0.8801 | 8138.2 samples/s | 31.8 steps/s
[Step= 550] | Loss=5.35795 | acc=0.1295 | tpr=0.6614 | fpr=0.8802 | 9966.1 samples/s | 38.9 steps/s
Avg test loss: 5.35873, Avg test acc: 0.12947, Avg tpr: 0.66244, Avg fpr: 0.88021, total FA: 122216

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.72925 | acc=0.1493 | tpr=0.5133 | fpr=0.8572 | 6095.8 samples/s | 23.8 steps/s
[Step= 100] | Loss=4.72094 | acc=0.1516 | tpr=0.5011 | fpr=0.8550 | 8059.2 samples/s | 31.5 steps/s
[Step= 150] | Loss=4.70813 | acc=0.1537 | tpr=0.5159 | fpr=0.8530 | 7966.3 samples/s | 31.1 steps/s
[Step= 200] | Loss=4.70249 | acc=0.1547 | tpr=0.5148 | fpr=0.8518 | 7663.0 samples/s | 29.9 steps/s
[Step= 250] | Loss=4.70379 | acc=0.1548 | tpr=0.5048 | fpr=0.8516 | 8470.4 samples/s | 33.1 steps/s
[Step= 300] | Loss=4.69987 | acc=0.1543 | tpr=0.4960 | fpr=0.8519 | 7760.9 samples/s | 30.3 steps/s
[Step= 350] | Loss=4.70662 | acc=0.1541 | tpr=0.4941 | fpr=0.8521 | 8093.0 samples/s | 31.6 steps/s
[Step= 400] | Loss=4.70398 | acc=0.1545 | tpr=0.4973 | fpr=0.8517 | 7501.1 samples/s | 29.3 steps/s
[Step= 450] | Loss=4.70824 | acc=0.1541 | tpr=0.5019 | fpr=0.8523 | 8069.7 samples/s | 31.5 steps/s
[Step= 500] | Loss=4.70768 | acc=0.1545 | tpr=0.5026 | fpr=0.8518 | 7852.3 samples/s | 30.7 steps/s
[Step= 550] | Loss=4.71082 | acc=0.1543 | tpr=0.5006 | fpr=0.8520 | 11235.1 samples/s | 43.9 steps/s
Avg test loss: 4.71141, Avg test acc: 0.15429, Avg tpr: 0.50119, Avg fpr: 0.85202, total FA: 118301

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19439 | acc=0.9606 | tpr=0.9469 | fpr=0.0391 | 6089.6 samples/s | 23.8 steps/s
[Step= 100] | Loss=0.20174 | acc=0.9599 | tpr=0.9574 | fpr=0.0401 | 7079.1 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.20386 | acc=0.9584 | tpr=0.9553 | fpr=0.0415 | 8238.3 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.20372 | acc=0.9583 | tpr=0.9585 | fpr=0.0417 | 8160.4 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.20377 | acc=0.9582 | tpr=0.9572 | fpr=0.0418 | 8006.7 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.20678 | acc=0.9577 | tpr=0.9549 | fpr=0.0423 | 8402.7 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.20510 | acc=0.9576 | tpr=0.9543 | fpr=0.0423 | 8030.3 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.20499 | acc=0.9573 | tpr=0.9519 | fpr=0.0426 | 7718.7 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.20822 | acc=0.9568 | tpr=0.9508 | fpr=0.0431 | 8289.9 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.20855 | acc=0.9567 | tpr=0.9515 | fpr=0.0432 | 7587.5 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.20746 | acc=0.9570 | tpr=0.9519 | fpr=0.0429 | 11178.1 samples/s | 43.7 steps/s
Avg test loss: 0.20715, Avg test acc: 0.95701, Avg tpr: 0.95166, Avg fpr: 0.04289, total FA: 5955

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14766 | acc=0.9635 | tpr=0.9292 | fpr=0.0359 | 5740.1 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.15465 | acc=0.9623 | tpr=0.9339 | fpr=0.0372 | 8272.1 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.15589 | acc=0.9614 | tpr=0.9380 | fpr=0.0382 | 8310.2 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.15556 | acc=0.9614 | tpr=0.9432 | fpr=0.0382 | 7873.7 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.15502 | acc=0.9614 | tpr=0.9432 | fpr=0.0383 | 8365.0 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.15722 | acc=0.9610 | tpr=0.9411 | fpr=0.0386 | 8010.5 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.15605 | acc=0.9609 | tpr=0.9399 | fpr=0.0387 | 7624.1 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.15677 | acc=0.9606 | tpr=0.9365 | fpr=0.0390 | 7503.0 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.15978 | acc=0.9600 | tpr=0.9352 | fpr=0.0395 | 8605.2 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.15938 | acc=0.9598 | tpr=0.9374 | fpr=0.0398 | 8714.4 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.15834 | acc=0.9600 | tpr=0.9379 | fpr=0.0396 | 9240.8 samples/s | 36.1 steps/s
Avg test loss: 0.15817, Avg test acc: 0.96005, Avg tpr: 0.93780, Avg fpr: 0.03955, total FA: 5491

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26467 | acc=0.9527 | tpr=0.9513 | fpr=0.0473 | 5762.7 samples/s | 22.5 steps/s
[Step= 100] | Loss=0.27006 | acc=0.9510 | tpr=0.9531 | fpr=0.0490 | 8423.8 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.27389 | acc=0.9495 | tpr=0.9496 | fpr=0.0505 | 7867.1 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.27484 | acc=0.9494 | tpr=0.9552 | fpr=0.0507 | 8426.7 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.27557 | acc=0.9491 | tpr=0.9546 | fpr=0.0510 | 8363.4 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.27868 | acc=0.9487 | tpr=0.9498 | fpr=0.0513 | 7232.6 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.27684 | acc=0.9487 | tpr=0.9493 | fpr=0.0513 | 7975.4 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.27723 | acc=0.9483 | tpr=0.9458 | fpr=0.0516 | 8506.5 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.28127 | acc=0.9478 | tpr=0.9445 | fpr=0.0521 | 7812.8 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.28147 | acc=0.9477 | tpr=0.9463 | fpr=0.0522 | 8117.5 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.27987 | acc=0.9480 | tpr=0.9475 | fpr=0.0519 | 9752.5 samples/s | 38.1 steps/s
Avg test loss: 0.27960, Avg test acc: 0.94807, Avg tpr: 0.94731, Avg fpr: 0.05192, total FA: 7209

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14229 | acc=0.9654 | tpr=0.9469 | fpr=0.0343 | 6059.9 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.14719 | acc=0.9642 | tpr=0.9467 | fpr=0.0355 | 8049.2 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.14898 | acc=0.9625 | tpr=0.9438 | fpr=0.0371 | 7848.7 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.14888 | acc=0.9626 | tpr=0.9475 | fpr=0.0371 | 7491.4 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.14896 | acc=0.9624 | tpr=0.9450 | fpr=0.0373 | 8457.0 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.15139 | acc=0.9621 | tpr=0.9433 | fpr=0.0375 | 8197.4 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.15040 | acc=0.9621 | tpr=0.9405 | fpr=0.0375 | 8175.9 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.15023 | acc=0.9617 | tpr=0.9382 | fpr=0.0379 | 7224.3 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.15248 | acc=0.9613 | tpr=0.9372 | fpr=0.0383 | 8339.8 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.15262 | acc=0.9612 | tpr=0.9388 | fpr=0.0384 | 8494.6 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.15169 | acc=0.9614 | tpr=0.9399 | fpr=0.0383 | 9798.7 samples/s | 38.3 steps/s
Avg test loss: 0.15143, Avg test acc: 0.96137, Avg tpr: 0.93978, Avg fpr: 0.03824, total FA: 5309

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.22192 | acc=0.9563 | tpr=0.9159 | fpr=0.0429 | 5803.1 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.23082 | acc=0.9554 | tpr=0.9339 | fpr=0.0442 | 8506.9 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.23308 | acc=0.9539 | tpr=0.9395 | fpr=0.0458 | 7339.7 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.23333 | acc=0.9540 | tpr=0.9464 | fpr=0.0459 | 8286.6 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.23393 | acc=0.9540 | tpr=0.9459 | fpr=0.0458 | 8399.1 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.23691 | acc=0.9536 | tpr=0.9440 | fpr=0.0462 | 8313.4 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.23597 | acc=0.9536 | tpr=0.9430 | fpr=0.0462 | 7793.5 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.23605 | acc=0.9533 | tpr=0.9404 | fpr=0.0465 | 8447.8 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.23938 | acc=0.9528 | tpr=0.9396 | fpr=0.0470 | 7598.0 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.23940 | acc=0.9526 | tpr=0.9388 | fpr=0.0471 | 8550.8 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.23784 | acc=0.9529 | tpr=0.9395 | fpr=0.0469 | 9208.1 samples/s | 36.0 steps/s
Avg test loss: 0.23755, Avg test acc: 0.95290, Avg tpr: 0.93938, Avg fpr: 0.04685, total FA: 6505

server round 36/50

clients selected: [0 4 6 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=156.0] | Loss=0.02127 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.164 | L2-Norm(final)=12.529 | 6917.7 samples/s | 108.1 steps/s
[Step=32050 Epoch=156.3] | Loss=0.02397 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=12.534 | 5030.4 samples/s | 78.6 steps/s
[Step=32100 Epoch=156.5] | Loss=0.02484 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.164 | L2-Norm(final)=12.542 | 5484.5 samples/s | 85.7 steps/s
[Step=32150 Epoch=156.8] | Loss=0.02277 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.164 | L2-Norm(final)=12.549 | 5613.5 samples/s | 87.7 steps/s
[Step=32200 Epoch=157.0] | Loss=0.02301 | Reg=0.00103 | acc=0.9688 | L2-Norm=10.164 | L2-Norm(final)=12.556 | 8519.6 samples/s | 133.1 steps/s
[Step=32250 Epoch=157.3] | Loss=0.02343 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.164 | L2-Norm(final)=12.562 | 2706.2 samples/s | 42.3 steps/s
[Step=32300 Epoch=157.5] | Loss=0.02305 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=12.568 | 5697.2 samples/s | 89.0 steps/s
[Step=32350 Epoch=157.7] | Loss=0.02281 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.164 | L2-Norm(final)=12.574 | 5524.1 samples/s | 86.3 steps/s
[Step=32400 Epoch=158.0] | Loss=0.02282 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.164 | L2-Norm(final)=12.580 | 7215.0 samples/s | 112.7 steps/s
[Step=32450 Epoch=158.2] | Loss=0.02257 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=12.585 | 2790.2 samples/s | 43.6 steps/s
[Step=32500 Epoch=158.5] | Loss=0.02244 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=12.591 | 5573.8 samples/s | 87.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=158.5] | Loss=0.00158 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=12.648 | 7238.4 samples/s | 113.1 steps/s
[Step=32550 Epoch=158.7] | Loss=0.02463 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.185 | L2-Norm(final)=12.652 | 4339.0 samples/s | 67.8 steps/s
[Step=32600 Epoch=159.0] | Loss=0.02340 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.207 | L2-Norm(final)=12.652 | 4709.2 samples/s | 73.6 steps/s
[Step=32650 Epoch=159.2] | Loss=0.02147 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.224 | L2-Norm(final)=12.655 | 4810.5 samples/s | 75.2 steps/s
[Step=32700 Epoch=159.5] | Loss=0.01919 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.239 | L2-Norm(final)=12.659 | 6791.5 samples/s | 106.1 steps/s
[Step=32750 Epoch=159.7] | Loss=0.01672 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.251 | L2-Norm(final)=12.664 | 2474.1 samples/s | 38.7 steps/s
[Step=32800 Epoch=159.9] | Loss=0.01497 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.262 | L2-Norm(final)=12.670 | 4793.0 samples/s | 74.9 steps/s
[Step=32850 Epoch=160.2] | Loss=0.01399 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.271 | L2-Norm(final)=12.675 | 4780.9 samples/s | 74.7 steps/s
[Step=32900 Epoch=160.4] | Loss=0.01282 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.279 | L2-Norm(final)=12.680 | 6090.7 samples/s | 95.2 steps/s
[Step=32950 Epoch=160.7] | Loss=0.01290 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.286 | L2-Norm(final)=12.684 | 2576.0 samples/s | 40.3 steps/s
[Step=33000 Epoch=160.9] | Loss=0.01270 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.293 | L2-Norm(final)=12.688 | 4821.1 samples/s | 75.3 steps/s
[Step=33050 Epoch=161.2] | Loss=0.01204 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.300 | L2-Norm(final)=12.692 | 4762.2 samples/s | 74.4 steps/s
[Step=33100 Epoch=161.4] | Loss=0.01146 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.306 | L2-Norm(final)=12.696 | 5665.6 samples/s | 88.5 steps/s
[Step=33150 Epoch=161.6] | Loss=0.01085 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.311 | L2-Norm(final)=12.700 | 2669.7 samples/s | 41.7 steps/s
[Step=33200 Epoch=161.9] | Loss=0.01042 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.316 | L2-Norm(final)=12.703 | 4699.2 samples/s | 73.4 steps/s
[Step=33250 Epoch=162.1] | Loss=0.01000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.321 | L2-Norm(final)=12.707 | 4844.8 samples/s | 75.7 steps/s
[Step=33300 Epoch=162.4] | Loss=0.00974 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.326 | L2-Norm(final)=12.711 | 5177.4 samples/s | 80.9 steps/s
[Step=33350 Epoch=162.6] | Loss=0.00937 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.331 | L2-Norm(final)=12.715 | 2741.7 samples/s | 42.8 steps/s
[Step=33400 Epoch=162.9] | Loss=0.00902 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.335 | L2-Norm(final)=12.719 | 4759.5 samples/s | 74.4 steps/s
[Step=33450 Epoch=163.1] | Loss=0.00879 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.339 | L2-Norm(final)=12.722 | 4739.9 samples/s | 74.1 steps/s
[Step=33500 Epoch=163.4] | Loss=0.00858 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.343 | L2-Norm(final)=12.726 | 4819.8 samples/s | 75.3 steps/s
[Step=33550 Epoch=163.6] | Loss=0.00835 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.347 | L2-Norm(final)=12.729 | 2896.9 samples/s | 45.3 steps/s
[Step=33600 Epoch=163.8] | Loss=0.00807 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.351 | L2-Norm(final)=12.732 | 4721.6 samples/s | 73.8 steps/s
[Step=33650 Epoch=164.1] | Loss=0.00788 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.355 | L2-Norm(final)=12.736 | 4767.3 samples/s | 74.5 steps/s
[Step=33700 Epoch=164.3] | Loss=0.00777 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.358 | L2-Norm(final)=12.739 | 4824.2 samples/s | 75.4 steps/s
[Step=33750 Epoch=164.6] | Loss=0.00760 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.361 | L2-Norm(final)=12.742 | 2923.2 samples/s | 45.7 steps/s
[Step=33800 Epoch=164.8] | Loss=0.00745 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.364 | L2-Norm(final)=12.745 | 4729.4 samples/s | 73.9 steps/s
[Step=33850 Epoch=165.1] | Loss=0.00726 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.368 | L2-Norm(final)=12.748 | 4775.7 samples/s | 74.6 steps/s
[Step=33900 Epoch=165.3] | Loss=0.00713 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.371 | L2-Norm(final)=12.751 | 4777.3 samples/s | 74.6 steps/s
[Step=33950 Epoch=165.5] | Loss=0.00700 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.374 | L2-Norm(final)=12.754 | 2943.7 samples/s | 46.0 steps/s
[Step=34000 Epoch=165.8] | Loss=0.00687 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.376 | L2-Norm(final)=12.757 | 4799.2 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step34000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=166.7] | Loss=0.01139 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=14.458 | 6248.7 samples/s | 97.6 steps/s
[Step=34050 Epoch=167.0] | Loss=0.02305 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=14.451 | 5241.0 samples/s | 81.9 steps/s
[Step=34100 Epoch=167.2] | Loss=0.02165 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.164 | L2-Norm(final)=14.443 | 5595.3 samples/s | 87.4 steps/s
[Step=34150 Epoch=167.5] | Loss=0.02039 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=14.439 | 5445.9 samples/s | 85.1 steps/s
[Step=34200 Epoch=167.7] | Loss=0.01993 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.164 | L2-Norm(final)=14.435 | 8958.5 samples/s | 140.0 steps/s
[Step=34250 Epoch=168.0] | Loss=0.01970 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=14.433 | 2637.4 samples/s | 41.2 steps/s
[Step=34300 Epoch=168.2] | Loss=0.01953 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.164 | L2-Norm(final)=14.431 | 5525.3 samples/s | 86.3 steps/s
[Step=34350 Epoch=168.4] | Loss=0.01930 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.164 | L2-Norm(final)=14.431 | 5601.5 samples/s | 87.5 steps/s
[Step=34400 Epoch=168.7] | Loss=0.01950 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.164 | L2-Norm(final)=14.430 | 8160.5 samples/s | 127.5 steps/s
[Step=34450 Epoch=168.9] | Loss=0.01898 | Reg=0.00103 | acc=0.9531 | L2-Norm=10.164 | L2-Norm(final)=14.430 | 2714.1 samples/s | 42.4 steps/s
[Step=34500 Epoch=169.2] | Loss=0.01899 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=14.431 | 5552.3 samples/s | 86.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=169.2] | Loss=0.00476 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=14.437 | 7208.8 samples/s | 112.6 steps/s
[Step=34550 Epoch=169.4] | Loss=0.02277 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.176 | L2-Norm(final)=14.437 | 4260.0 samples/s | 66.6 steps/s
[Step=34600 Epoch=169.7] | Loss=0.01883 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.196 | L2-Norm(final)=14.439 | 4792.0 samples/s | 74.9 steps/s
[Step=34650 Epoch=169.9] | Loss=0.01800 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.211 | L2-Norm(final)=14.442 | 4783.1 samples/s | 74.7 steps/s
[Step=34700 Epoch=170.2] | Loss=0.01616 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.223 | L2-Norm(final)=14.445 | 6968.1 samples/s | 108.9 steps/s
[Step=34750 Epoch=170.4] | Loss=0.01412 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.234 | L2-Norm(final)=14.448 | 2449.3 samples/s | 38.3 steps/s
[Step=34800 Epoch=170.7] | Loss=0.01269 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=14.452 | 4744.6 samples/s | 74.1 steps/s
[Step=34850 Epoch=170.9] | Loss=0.01179 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.251 | L2-Norm(final)=14.456 | 4765.9 samples/s | 74.5 steps/s
[Step=34900 Epoch=171.1] | Loss=0.01093 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.258 | L2-Norm(final)=14.460 | 6616.3 samples/s | 103.4 steps/s
[Step=34950 Epoch=171.4] | Loss=0.01008 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.265 | L2-Norm(final)=14.465 | 2516.9 samples/s | 39.3 steps/s
[Step=35000 Epoch=171.6] | Loss=0.00953 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.271 | L2-Norm(final)=14.469 | 4750.0 samples/s | 74.2 steps/s
[Step=35050 Epoch=171.9] | Loss=0.00914 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.277 | L2-Norm(final)=14.472 | 4826.1 samples/s | 75.4 steps/s
[Step=35100 Epoch=172.1] | Loss=0.00871 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.282 | L2-Norm(final)=14.476 | 6092.7 samples/s | 95.2 steps/s
[Step=35150 Epoch=172.4] | Loss=0.00823 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=14.479 | 2565.6 samples/s | 40.1 steps/s
[Step=35200 Epoch=172.6] | Loss=0.00783 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.291 | L2-Norm(final)=14.483 | 4792.6 samples/s | 74.9 steps/s
[Step=35250 Epoch=172.9] | Loss=0.00749 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.296 | L2-Norm(final)=14.486 | 4763.6 samples/s | 74.4 steps/s
[Step=35300 Epoch=173.1] | Loss=0.00732 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.300 | L2-Norm(final)=14.490 | 5855.7 samples/s | 91.5 steps/s
[Step=35350 Epoch=173.4] | Loss=0.00711 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.304 | L2-Norm(final)=14.493 | 2685.2 samples/s | 42.0 steps/s
[Step=35400 Epoch=173.6] | Loss=0.00690 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.307 | L2-Norm(final)=14.496 | 4706.9 samples/s | 73.5 steps/s
[Step=35450 Epoch=173.8] | Loss=0.00670 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.311 | L2-Norm(final)=14.499 | 4767.4 samples/s | 74.5 steps/s
[Step=35500 Epoch=174.1] | Loss=0.00649 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.315 | L2-Norm(final)=14.502 | 5499.6 samples/s | 85.9 steps/s
[Step=35550 Epoch=174.3] | Loss=0.00634 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.318 | L2-Norm(final)=14.505 | 2700.7 samples/s | 42.2 steps/s
[Step=35600 Epoch=174.6] | Loss=0.00613 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.321 | L2-Norm(final)=14.508 | 4790.6 samples/s | 74.9 steps/s
[Step=35650 Epoch=174.8] | Loss=0.00594 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.324 | L2-Norm(final)=14.511 | 4724.7 samples/s | 73.8 steps/s
[Step=35700 Epoch=175.1] | Loss=0.00579 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.328 | L2-Norm(final)=14.514 | 5243.1 samples/s | 81.9 steps/s
[Step=35750 Epoch=175.3] | Loss=0.00567 | Reg=0.00107 | acc=0.9688 | L2-Norm=10.331 | L2-Norm(final)=14.517 | 2829.8 samples/s | 44.2 steps/s
[Step=35800 Epoch=175.6] | Loss=0.00556 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.334 | L2-Norm(final)=14.520 | 4815.6 samples/s | 75.2 steps/s
[Step=35850 Epoch=175.8] | Loss=0.00544 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.337 | L2-Norm(final)=14.523 | 4650.0 samples/s | 72.7 steps/s
[Step=35900 Epoch=176.0] | Loss=0.00533 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.339 | L2-Norm(final)=14.526 | 4966.6 samples/s | 77.6 steps/s
[Step=35950 Epoch=176.3] | Loss=0.00521 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.342 | L2-Norm(final)=14.528 | 2894.9 samples/s | 45.2 steps/s
[Step=36000 Epoch=176.5] | Loss=0.00512 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.345 | L2-Norm(final)=14.531 | 4686.7 samples/s | 73.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step36000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=323.4] | Loss=0.00227 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=15.434 | 7587.3 samples/s | 118.6 steps/s
[Step=34050 Epoch=323.9] | Loss=0.00098 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=15.439 | 4367.5 samples/s | 68.2 steps/s
[Step=34100 Epoch=324.4] | Loss=0.00087 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=15.446 | 7990.3 samples/s | 124.8 steps/s
[Step=34150 Epoch=324.9] | Loss=0.00090 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=15.451 | 2592.9 samples/s | 40.5 steps/s
[Step=34200 Epoch=325.3] | Loss=0.00082 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=15.457 | 7242.6 samples/s | 113.2 steps/s
[Step=34250 Epoch=325.8] | Loss=0.00082 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=15.462 | 2739.9 samples/s | 42.8 steps/s
[Step=34300 Epoch=326.3] | Loss=0.00082 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=15.468 | 6253.5 samples/s | 97.7 steps/s
[Step=34350 Epoch=326.8] | Loss=0.00081 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=15.473 | 2848.6 samples/s | 44.5 steps/s
[Step=34400 Epoch=327.2] | Loss=0.00081 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=15.478 | 5797.8 samples/s | 90.6 steps/s
[Step=34450 Epoch=327.7] | Loss=0.00080 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=15.483 | 2941.9 samples/s | 46.0 steps/s
[Step=34500 Epoch=328.2] | Loss=0.00080 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=15.489 | 5467.6 samples/s | 85.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=328.2] | Loss=0.00727 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=15.539 | 7245.1 samples/s | 113.2 steps/s
[Step=34550 Epoch=328.7] | Loss=0.00038 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.184 | L2-Norm(final)=15.540 | 4013.7 samples/s | 62.7 steps/s
[Step=34600 Epoch=329.1] | Loss=0.00022 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.187 | L2-Norm(final)=15.541 | 6591.4 samples/s | 103.0 steps/s
[Step=34650 Epoch=329.6] | Loss=0.00016 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.186 | L2-Norm(final)=15.543 | 2401.2 samples/s | 37.5 steps/s
[Step=34700 Epoch=330.1] | Loss=0.00012 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.183 | L2-Norm(final)=15.543 | 5900.6 samples/s | 92.2 steps/s
[Step=34750 Epoch=330.6] | Loss=0.00010 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.179 | L2-Norm(final)=15.544 | 2516.6 samples/s | 39.3 steps/s
[Step=34800 Epoch=331.0] | Loss=0.00008 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.175 | L2-Norm(final)=15.545 | 5338.0 samples/s | 83.4 steps/s
[Step=34850 Epoch=331.5] | Loss=0.00007 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.171 | L2-Norm(final)=15.545 | 2600.6 samples/s | 40.6 steps/s
[Step=34900 Epoch=332.0] | Loss=0.00006 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.166 | L2-Norm(final)=15.545 | 4962.6 samples/s | 77.5 steps/s
[Step=34950 Epoch=332.5] | Loss=0.00006 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=15.546 | 2736.8 samples/s | 42.8 steps/s
[Step=35000 Epoch=332.9] | Loss=0.00005 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.157 | L2-Norm(final)=15.546 | 4573.1 samples/s | 71.5 steps/s
[Step=35050 Epoch=333.4] | Loss=0.00005 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.152 | L2-Norm(final)=15.547 | 2835.6 samples/s | 44.3 steps/s
[Step=35100 Epoch=333.9] | Loss=0.00004 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.147 | L2-Norm(final)=15.547 | 4583.6 samples/s | 71.6 steps/s
[Step=35150 Epoch=334.4] | Loss=0.00004 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.142 | L2-Norm(final)=15.547 | 2811.3 samples/s | 43.9 steps/s
[Step=35200 Epoch=334.8] | Loss=0.00004 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.137 | L2-Norm(final)=15.548 | 4584.3 samples/s | 71.6 steps/s
[Step=35250 Epoch=335.3] | Loss=0.00004 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.132 | L2-Norm(final)=15.548 | 2858.1 samples/s | 44.7 steps/s
[Step=35300 Epoch=335.8] | Loss=0.00003 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.127 | L2-Norm(final)=15.548 | 4612.9 samples/s | 72.1 steps/s
[Step=35350 Epoch=336.3] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.122 | L2-Norm(final)=15.549 | 2874.3 samples/s | 44.9 steps/s
[Step=35400 Epoch=336.7] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.116 | L2-Norm(final)=15.549 | 4539.5 samples/s | 70.9 steps/s
[Step=35450 Epoch=337.2] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.111 | L2-Norm(final)=15.549 | 6695.1 samples/s | 104.6 steps/s
[Step=35500 Epoch=337.7] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.105 | L2-Norm(final)=15.550 | 2376.3 samples/s | 37.1 steps/s
[Step=35550 Epoch=338.2] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.100 | L2-Norm(final)=15.550 | 6111.6 samples/s | 95.5 steps/s
[Step=35600 Epoch=338.6] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.095 | L2-Norm(final)=15.550 | 2455.1 samples/s | 38.4 steps/s
[Step=35650 Epoch=339.1] | Loss=0.00002 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.089 | L2-Norm(final)=15.551 | 5645.6 samples/s | 88.2 steps/s
[Step=35700 Epoch=339.6] | Loss=0.00002 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.083 | L2-Norm(final)=15.551 | 2555.1 samples/s | 39.9 steps/s
[Step=35750 Epoch=340.1] | Loss=0.00002 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.078 | L2-Norm(final)=15.551 | 5208.3 samples/s | 81.4 steps/s
[Step=35800 Epoch=340.5] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.072 | L2-Norm(final)=15.551 | 2652.4 samples/s | 41.4 steps/s
[Step=35850 Epoch=341.0] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.066 | L2-Norm(final)=15.552 | 4816.2 samples/s | 75.3 steps/s
[Step=35900 Epoch=341.5] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.060 | L2-Norm(final)=15.552 | 2766.3 samples/s | 43.2 steps/s
[Step=35950 Epoch=342.0] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.054 | L2-Norm(final)=15.552 | 4535.6 samples/s | 70.9 steps/s
[Step=36000 Epoch=342.4] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.048 | L2-Norm(final)=15.553 | 2918.6 samples/s | 45.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step36000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=324.7] | Loss=0.00003 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=14.574 | 7078.5 samples/s | 110.6 steps/s
[Step=34050 Epoch=325.2] | Loss=0.00046 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=14.585 | 4514.1 samples/s | 70.5 steps/s
[Step=34100 Epoch=325.6] | Loss=0.00037 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=14.592 | 8259.2 samples/s | 129.1 steps/s
[Step=34150 Epoch=326.1] | Loss=0.00037 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=14.598 | 2548.1 samples/s | 39.8 steps/s
[Step=34200 Epoch=326.6] | Loss=0.00039 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=14.605 | 7614.3 samples/s | 119.0 steps/s
[Step=34250 Epoch=327.1] | Loss=0.00034 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=14.613 | 2628.4 samples/s | 41.1 steps/s
[Step=34300 Epoch=327.5] | Loss=0.00037 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=14.619 | 6842.5 samples/s | 106.9 steps/s
[Step=34350 Epoch=328.0] | Loss=0.00039 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=14.626 | 2742.5 samples/s | 42.9 steps/s
[Step=34400 Epoch=328.5] | Loss=0.00038 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=14.634 | 6337.3 samples/s | 99.0 steps/s
[Step=34450 Epoch=329.0] | Loss=0.00037 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=14.641 | 2946.0 samples/s | 46.0 steps/s
[Step=34500 Epoch=329.5] | Loss=0.00038 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=14.647 | 5459.7 samples/s | 85.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=329.5] | Loss=0.00007 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=14.714 | 7713.2 samples/s | 120.5 steps/s
[Step=34550 Epoch=329.9] | Loss=0.00013 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.167 | L2-Norm(final)=14.717 | 3848.3 samples/s | 60.1 steps/s
[Step=34600 Epoch=330.4] | Loss=0.00009 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=14.719 | 6659.7 samples/s | 104.1 steps/s
[Step=34650 Epoch=330.9] | Loss=0.00006 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.159 | L2-Norm(final)=14.720 | 2356.7 samples/s | 36.8 steps/s
[Step=34700 Epoch=331.4] | Loss=0.00005 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.152 | L2-Norm(final)=14.721 | 6170.2 samples/s | 96.4 steps/s
[Step=34750 Epoch=331.8] | Loss=0.00004 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.144 | L2-Norm(final)=14.722 | 2437.8 samples/s | 38.1 steps/s
[Step=34800 Epoch=332.3] | Loss=0.00003 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=14.722 | 5660.9 samples/s | 88.5 steps/s
[Step=34850 Epoch=332.8] | Loss=0.00003 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.126 | L2-Norm(final)=14.722 | 2552.2 samples/s | 39.9 steps/s
[Step=34900 Epoch=333.3] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.117 | L2-Norm(final)=14.723 | 5282.6 samples/s | 82.5 steps/s
[Step=34950 Epoch=333.8] | Loss=0.00002 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.108 | L2-Norm(final)=14.723 | 2632.7 samples/s | 41.1 steps/s
[Step=35000 Epoch=334.2] | Loss=0.00002 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.099 | L2-Norm(final)=14.723 | 4935.0 samples/s | 77.1 steps/s
[Step=35050 Epoch=334.7] | Loss=0.00002 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.090 | L2-Norm(final)=14.724 | 2756.1 samples/s | 43.1 steps/s
[Step=35100 Epoch=335.2] | Loss=0.00002 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=14.724 | 4520.1 samples/s | 70.6 steps/s
[Step=35150 Epoch=335.7] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.071 | L2-Norm(final)=14.724 | 2856.9 samples/s | 44.6 steps/s
[Step=35200 Epoch=336.1] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.062 | L2-Norm(final)=14.724 | 4416.9 samples/s | 69.0 steps/s
[Step=35250 Epoch=336.6] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.052 | L2-Norm(final)=14.725 | 2852.6 samples/s | 44.6 steps/s
[Step=35300 Epoch=337.1] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.043 | L2-Norm(final)=14.725 | 4487.9 samples/s | 70.1 steps/s
[Step=35350 Epoch=337.6] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.033 | L2-Norm(final)=14.725 | 2867.4 samples/s | 44.8 steps/s
[Step=35400 Epoch=338.0] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.024 | L2-Norm(final)=14.725 | 4544.0 samples/s | 71.0 steps/s
[Step=35450 Epoch=338.5] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=14.725 | 2844.6 samples/s | 44.4 steps/s
[Step=35500 Epoch=339.0] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.005 | L2-Norm(final)=14.726 | 4530.1 samples/s | 70.8 steps/s
[Step=35550 Epoch=339.5] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.995 | L2-Norm(final)=14.726 | 7341.9 samples/s | 114.7 steps/s
[Step=35600 Epoch=340.0] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.985 | L2-Norm(final)=14.726 | 2325.6 samples/s | 36.3 steps/s
[Step=35650 Epoch=340.4] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.975 | L2-Norm(final)=14.726 | 6469.0 samples/s | 101.1 steps/s
[Step=35700 Epoch=340.9] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.965 | L2-Norm(final)=14.727 | 2379.6 samples/s | 37.2 steps/s
[Step=35750 Epoch=341.4] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.955 | L2-Norm(final)=14.727 | 6180.9 samples/s | 96.6 steps/s
[Step=35800 Epoch=341.9] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.945 | L2-Norm(final)=14.727 | 2460.5 samples/s | 38.4 steps/s
[Step=35850 Epoch=342.3] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.935 | L2-Norm(final)=14.727 | 5634.7 samples/s | 88.0 steps/s
[Step=35900 Epoch=342.8] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.925 | L2-Norm(final)=14.728 | 2532.7 samples/s | 39.6 steps/s
[Step=35950 Epoch=343.3] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.915 | L2-Norm(final)=14.728 | 5277.3 samples/s | 82.5 steps/s
[Step=36000 Epoch=343.8] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=14.728 | 2635.6 samples/s | 41.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step36000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=38001 Epoch=362.2] | Loss=0.00038 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=16.508 | 6245.8 samples/s | 97.6 steps/s
[Step=38050 Epoch=362.7] | Loss=0.00137 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=16.519 | 4518.6 samples/s | 70.6 steps/s
[Step=38100 Epoch=363.1] | Loss=0.00144 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=16.529 | 8324.4 samples/s | 130.1 steps/s
[Step=38150 Epoch=363.6] | Loss=0.00128 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=16.538 | 2555.6 samples/s | 39.9 steps/s
[Step=38200 Epoch=364.1] | Loss=0.00136 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=16.548 | 7502.8 samples/s | 117.2 steps/s
[Step=38250 Epoch=364.6] | Loss=0.00141 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=16.557 | 2632.5 samples/s | 41.1 steps/s
[Step=38300 Epoch=365.0] | Loss=0.00140 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=16.566 | 6897.8 samples/s | 107.8 steps/s
[Step=38350 Epoch=365.5] | Loss=0.00147 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=16.574 | 2739.4 samples/s | 42.8 steps/s
[Step=38400 Epoch=366.0] | Loss=0.00143 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=16.583 | 6245.5 samples/s | 97.6 steps/s
[Step=38450 Epoch=366.5] | Loss=0.00143 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=16.591 | 2825.4 samples/s | 44.1 steps/s
[Step=38500 Epoch=366.9] | Loss=0.00141 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=16.599 | 5753.0 samples/s | 89.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=366.9] | Loss=0.00061 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=16.676 | 6829.6 samples/s | 106.7 steps/s
[Step=38550 Epoch=367.4] | Loss=0.00056 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.183 | L2-Norm(final)=16.679 | 4090.0 samples/s | 63.9 steps/s
[Step=38600 Epoch=367.9] | Loss=0.00031 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.191 | L2-Norm(final)=16.681 | 6679.9 samples/s | 104.4 steps/s
[Step=38650 Epoch=368.4] | Loss=0.00021 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.192 | L2-Norm(final)=16.682 | 2375.1 samples/s | 37.1 steps/s
[Step=38700 Epoch=368.8] | Loss=0.00016 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.190 | L2-Norm(final)=16.683 | 6034.0 samples/s | 94.3 steps/s
[Step=38750 Epoch=369.3] | Loss=0.00013 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.187 | L2-Norm(final)=16.684 | 2444.3 samples/s | 38.2 steps/s
[Step=38800 Epoch=369.8] | Loss=0.00011 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.184 | L2-Norm(final)=16.684 | 5682.3 samples/s | 88.8 steps/s
[Step=38850 Epoch=370.3] | Loss=0.00010 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.180 | L2-Norm(final)=16.685 | 2551.4 samples/s | 39.9 steps/s
[Step=38900 Epoch=370.8] | Loss=0.00009 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.176 | L2-Norm(final)=16.685 | 5232.3 samples/s | 81.8 steps/s
[Step=38950 Epoch=371.2] | Loss=0.00008 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.171 | L2-Norm(final)=16.685 | 2652.2 samples/s | 41.4 steps/s
[Step=39000 Epoch=371.7] | Loss=0.00007 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.167 | L2-Norm(final)=16.686 | 4833.6 samples/s | 75.5 steps/s
[Step=39050 Epoch=372.2] | Loss=0.00006 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=16.686 | 2737.7 samples/s | 42.8 steps/s
[Step=39100 Epoch=372.7] | Loss=0.00006 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.158 | L2-Norm(final)=16.686 | 4573.6 samples/s | 71.5 steps/s
[Step=39150 Epoch=373.1] | Loss=0.00006 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.153 | L2-Norm(final)=16.687 | 2811.3 samples/s | 43.9 steps/s
[Step=39200 Epoch=373.6] | Loss=0.00005 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.149 | L2-Norm(final)=16.687 | 4544.4 samples/s | 71.0 steps/s
[Step=39250 Epoch=374.1] | Loss=0.00005 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.144 | L2-Norm(final)=16.687 | 2854.1 samples/s | 44.6 steps/s
[Step=39300 Epoch=374.6] | Loss=0.00005 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.139 | L2-Norm(final)=16.688 | 4543.0 samples/s | 71.0 steps/s
[Step=39350 Epoch=375.0] | Loss=0.00004 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.134 | L2-Norm(final)=16.688 | 2840.4 samples/s | 44.4 steps/s
[Step=39400 Epoch=375.5] | Loss=0.00004 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.129 | L2-Norm(final)=16.688 | 4564.3 samples/s | 71.3 steps/s
[Step=39450 Epoch=376.0] | Loss=0.00004 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.124 | L2-Norm(final)=16.689 | 2849.6 samples/s | 44.5 steps/s
[Step=39500 Epoch=376.5] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.119 | L2-Norm(final)=16.689 | 4550.1 samples/s | 71.1 steps/s
[Step=39550 Epoch=376.9] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.114 | L2-Norm(final)=16.689 | 7325.8 samples/s | 114.5 steps/s
[Step=39600 Epoch=377.4] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.109 | L2-Norm(final)=16.690 | 2311.6 samples/s | 36.1 steps/s
[Step=39650 Epoch=377.9] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.104 | L2-Norm(final)=16.690 | 6620.8 samples/s | 103.5 steps/s
[Step=39700 Epoch=378.4] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.099 | L2-Norm(final)=16.690 | 2384.2 samples/s | 37.3 steps/s
[Step=39750 Epoch=378.9] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.093 | L2-Norm(final)=16.690 | 6128.9 samples/s | 95.8 steps/s
[Step=39800 Epoch=379.3] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.088 | L2-Norm(final)=16.691 | 2462.0 samples/s | 38.5 steps/s
[Step=39850 Epoch=379.8] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.083 | L2-Norm(final)=16.691 | 5652.5 samples/s | 88.3 steps/s
[Step=39900 Epoch=380.3] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.077 | L2-Norm(final)=16.691 | 2536.4 samples/s | 39.6 steps/s
[Step=39950 Epoch=380.8] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.072 | L2-Norm(final)=16.691 | 5251.9 samples/s | 82.1 steps/s
[Step=40000 Epoch=381.2] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.066 | L2-Norm(final)=16.692 | 2660.8 samples/s | 41.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08184 | acc=0.9623 | tpr=0.9688 | fpr=0.0518 | 5868.7 samples/s | 22.9 steps/s
Avg test loss: 0.08833, Avg test acc: 0.95949, Avg tpr: 0.96672, Avg fpr: 0.05640, total FA: 440

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09619 | acc=0.9623 | tpr=0.9816 | fpr=0.0798 | 5768.8 samples/s | 22.5 steps/s
Avg test loss: 0.09959, Avg test acc: 0.96065, Avg tpr: 0.97989, Avg fpr: 0.08166, total FA: 637

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09007 | acc=0.9619 | tpr=0.9709 | fpr=0.0577 | 6097.6 samples/s | 23.8 steps/s
Avg test loss: 0.09443, Avg test acc: 0.95989, Avg tpr: 0.96794, Avg fpr: 0.05781, total FA: 451

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09201 | acc=0.9599 | tpr=0.9784 | fpr=0.0803 | 6002.1 samples/s | 23.4 steps/s
Avg test loss: 0.09632, Avg test acc: 0.95941, Avg tpr: 0.97826, Avg fpr: 0.08204, total FA: 640

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09383 | acc=0.9627 | tpr=0.9690 | fpr=0.0508 | 6115.8 samples/s | 23.9 steps/s
Avg test loss: 0.09787, Avg test acc: 0.96146, Avg tpr: 0.96649, Avg fpr: 0.04961, total FA: 387

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.69048 | acc=0.2839 | tpr=0.0211 | fpr=0.1454 | 5566.4 samples/s | 21.7 steps/s
Avg test loss: 5.69765, Avg test acc: 0.28284, Avg tpr: 0.02005, Avg fpr: 0.13921, total FA: 1086

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.71258 | acc=0.3064 | tpr=0.0319 | fpr=0.0976 | 6184.2 samples/s | 24.2 steps/s
Avg test loss: 4.72212, Avg test acc: 0.30399, Avg tpr: 0.03130, Avg fpr: 0.09627, total FA: 751

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.04505 | acc=0.2930 | tpr=0.0210 | fpr=0.1162 | 5908.0 samples/s | 23.1 steps/s
Avg test loss: 5.05229, Avg test acc: 0.29089, Avg tpr: 0.01976, Avg fpr: 0.11281, total FA: 880

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.25868 | acc=0.2785 | tpr=0.0185 | fpr=0.1568 | 6078.0 samples/s | 23.7 steps/s
Avg test loss: 5.26064, Avg test acc: 0.27811, Avg tpr: 0.01865, Avg fpr: 0.15126, total FA: 1180

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.99435 | acc=0.2956 | tpr=0.0165 | fpr=0.0984 | 6140.0 samples/s | 24.0 steps/s
Avg test loss: 5.01189, Avg test acc: 0.29401, Avg tpr: 0.01655, Avg fpr: 0.09576, total FA: 747

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.73972 | acc=0.1391 | tpr=0.5354 | fpr=0.8681 | 6002.1 samples/s | 23.4 steps/s
[Step= 100] | Loss=4.72684 | acc=0.1424 | tpr=0.5181 | fpr=0.8646 | 7981.7 samples/s | 31.2 steps/s
[Step= 150] | Loss=4.71583 | acc=0.1450 | tpr=0.5303 | fpr=0.8621 | 8392.5 samples/s | 32.8 steps/s
[Step= 200] | Loss=4.70729 | acc=0.1452 | tpr=0.5246 | fpr=0.8617 | 7851.9 samples/s | 30.7 steps/s
[Step= 250] | Loss=4.71101 | acc=0.1446 | tpr=0.5179 | fpr=0.8622 | 7984.0 samples/s | 31.2 steps/s
[Step= 300] | Loss=4.70441 | acc=0.1449 | tpr=0.5069 | fpr=0.8617 | 7971.3 samples/s | 31.1 steps/s
[Step= 350] | Loss=4.70986 | acc=0.1448 | tpr=0.5041 | fpr=0.8617 | 7575.7 samples/s | 29.6 steps/s
[Step= 400] | Loss=4.70716 | acc=0.1456 | tpr=0.5038 | fpr=0.8610 | 7819.1 samples/s | 30.5 steps/s
[Step= 450] | Loss=4.71071 | acc=0.1452 | tpr=0.5107 | fpr=0.8614 | 8703.9 samples/s | 34.0 steps/s
[Step= 500] | Loss=4.71071 | acc=0.1452 | tpr=0.5132 | fpr=0.8615 | 7476.1 samples/s | 29.2 steps/s
[Step= 550] | Loss=4.71379 | acc=0.1451 | tpr=0.5137 | fpr=0.8616 | 11102.7 samples/s | 43.4 steps/s
Avg test loss: 4.71421, Avg test acc: 0.14502, Avg tpr: 0.51426, Avg fpr: 0.86169, total FA: 119644

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.59862 | acc=0.1206 | tpr=0.6327 | fpr=0.8886 | 5793.0 samples/s | 22.6 steps/s
[Step= 100] | Loss=5.58796 | acc=0.1243 | tpr=0.6354 | fpr=0.8853 | 8273.8 samples/s | 32.3 steps/s
[Step= 150] | Loss=5.57493 | acc=0.1267 | tpr=0.6527 | fpr=0.8830 | 8189.9 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.56790 | acc=0.1272 | tpr=0.6492 | fpr=0.8823 | 8345.6 samples/s | 32.6 steps/s
[Step= 250] | Loss=5.57204 | acc=0.1271 | tpr=0.6498 | fpr=0.8824 | 7820.5 samples/s | 30.5 steps/s
[Step= 300] | Loss=5.56781 | acc=0.1262 | tpr=0.6429 | fpr=0.8832 | 8126.7 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.57367 | acc=0.1258 | tpr=0.6381 | fpr=0.8835 | 7968.6 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.57090 | acc=0.1263 | tpr=0.6406 | fpr=0.8831 | 7198.0 samples/s | 28.1 steps/s
[Step= 450] | Loss=5.57493 | acc=0.1256 | tpr=0.6446 | fpr=0.8838 | 8389.2 samples/s | 32.8 steps/s
[Step= 500] | Loss=5.57608 | acc=0.1255 | tpr=0.6489 | fpr=0.8840 | 8452.5 samples/s | 33.0 steps/s
[Step= 550] | Loss=5.57940 | acc=0.1256 | tpr=0.6498 | fpr=0.8839 | 10117.2 samples/s | 39.5 steps/s
Avg test loss: 5.57988, Avg test acc: 0.12555, Avg tpr: 0.65055, Avg fpr: 0.88400, total FA: 122741

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.16837 | acc=0.1291 | tpr=0.5929 | fpr=0.8793 | 5981.4 samples/s | 23.4 steps/s
[Step= 100] | Loss=5.15386 | acc=0.1308 | tpr=0.5906 | fpr=0.8778 | 8059.1 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.14527 | acc=0.1325 | tpr=0.5965 | fpr=0.8760 | 8367.1 samples/s | 32.7 steps/s
[Step= 200] | Loss=5.13802 | acc=0.1328 | tpr=0.5891 | fpr=0.8755 | 7921.8 samples/s | 30.9 steps/s
[Step= 250] | Loss=5.14303 | acc=0.1328 | tpr=0.5852 | fpr=0.8755 | 7971.8 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.13901 | acc=0.1324 | tpr=0.5804 | fpr=0.8757 | 8076.0 samples/s | 31.5 steps/s
[Step= 350] | Loss=5.14467 | acc=0.1323 | tpr=0.5761 | fpr=0.8757 | 8312.4 samples/s | 32.5 steps/s
[Step= 400] | Loss=5.14405 | acc=0.1327 | tpr=0.5744 | fpr=0.8754 | 7912.1 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.14894 | acc=0.1320 | tpr=0.5774 | fpr=0.8760 | 8663.2 samples/s | 33.8 steps/s
[Step= 500] | Loss=5.14756 | acc=0.1321 | tpr=0.5793 | fpr=0.8760 | 7187.4 samples/s | 28.1 steps/s
[Step= 550] | Loss=5.15142 | acc=0.1322 | tpr=0.5790 | fpr=0.8760 | 10220.6 samples/s | 39.9 steps/s
Avg test loss: 5.15205, Avg test acc: 0.13208, Avg tpr: 0.58003, Avg fpr: 0.87607, total FA: 121640

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.37596 | acc=0.1250 | tpr=0.6504 | fpr=0.8844 | 6144.4 samples/s | 24.0 steps/s
[Step= 100] | Loss=5.36531 | acc=0.1291 | tpr=0.6503 | fpr=0.8806 | 8043.4 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.35285 | acc=0.1307 | tpr=0.6628 | fpr=0.8791 | 7267.3 samples/s | 28.4 steps/s
[Step= 200] | Loss=5.34374 | acc=0.1313 | tpr=0.6601 | fpr=0.8784 | 8052.0 samples/s | 31.5 steps/s
[Step= 250] | Loss=5.34576 | acc=0.1309 | tpr=0.6524 | fpr=0.8786 | 7175.1 samples/s | 28.0 steps/s
[Step= 300] | Loss=5.34304 | acc=0.1301 | tpr=0.6516 | fpr=0.8794 | 8320.1 samples/s | 32.5 steps/s
[Step= 350] | Loss=5.34928 | acc=0.1302 | tpr=0.6525 | fpr=0.8793 | 8469.3 samples/s | 33.1 steps/s
[Step= 400] | Loss=5.34814 | acc=0.1304 | tpr=0.6521 | fpr=0.8791 | 8227.7 samples/s | 32.1 steps/s
[Step= 450] | Loss=5.35372 | acc=0.1296 | tpr=0.6553 | fpr=0.8800 | 7574.4 samples/s | 29.6 steps/s
[Step= 500] | Loss=5.35357 | acc=0.1295 | tpr=0.6599 | fpr=0.8801 | 8391.5 samples/s | 32.8 steps/s
[Step= 550] | Loss=5.35795 | acc=0.1295 | tpr=0.6614 | fpr=0.8802 | 10929.7 samples/s | 42.7 steps/s
Avg test loss: 5.35873, Avg test acc: 0.12947, Avg tpr: 0.66244, Avg fpr: 0.88021, total FA: 122216

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.28901 | acc=0.1422 | tpr=0.4690 | fpr=0.8637 | 5860.1 samples/s | 22.9 steps/s
[Step= 100] | Loss=5.27488 | acc=0.1442 | tpr=0.4584 | fpr=0.8616 | 8011.0 samples/s | 31.3 steps/s
[Step= 150] | Loss=5.26396 | acc=0.1466 | tpr=0.4683 | fpr=0.8593 | 8091.4 samples/s | 31.6 steps/s
[Step= 200] | Loss=5.25822 | acc=0.1473 | tpr=0.4689 | fpr=0.8585 | 8043.7 samples/s | 31.4 steps/s
[Step= 250] | Loss=5.26212 | acc=0.1474 | tpr=0.4611 | fpr=0.8583 | 8104.8 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.25817 | acc=0.1470 | tpr=0.4545 | fpr=0.8586 | 8111.9 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.26509 | acc=0.1471 | tpr=0.4546 | fpr=0.8585 | 8044.0 samples/s | 31.4 steps/s
[Step= 400] | Loss=5.26113 | acc=0.1473 | tpr=0.4546 | fpr=0.8583 | 7956.6 samples/s | 31.1 steps/s
[Step= 450] | Loss=5.26571 | acc=0.1467 | tpr=0.4581 | fpr=0.8589 | 7848.8 samples/s | 30.7 steps/s
[Step= 500] | Loss=5.26569 | acc=0.1469 | tpr=0.4590 | fpr=0.8587 | 7549.9 samples/s | 29.5 steps/s
[Step= 550] | Loss=5.26884 | acc=0.1468 | tpr=0.4560 | fpr=0.8589 | 11162.8 samples/s | 43.6 steps/s
Avg test loss: 5.26965, Avg test acc: 0.14675, Avg tpr: 0.45681, Avg fpr: 0.85888, total FA: 119254

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19439 | acc=0.9606 | tpr=0.9469 | fpr=0.0391 | 6076.1 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.20174 | acc=0.9599 | tpr=0.9574 | fpr=0.0401 | 7683.0 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.20386 | acc=0.9584 | tpr=0.9553 | fpr=0.0415 | 7771.5 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.20372 | acc=0.9583 | tpr=0.9585 | fpr=0.0417 | 8044.2 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.20377 | acc=0.9582 | tpr=0.9572 | fpr=0.0418 | 8112.9 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.20678 | acc=0.9577 | tpr=0.9549 | fpr=0.0423 | 8041.8 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.20510 | acc=0.9576 | tpr=0.9543 | fpr=0.0423 | 7968.0 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.20499 | acc=0.9573 | tpr=0.9519 | fpr=0.0426 | 7845.5 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.20822 | acc=0.9568 | tpr=0.9508 | fpr=0.0431 | 8127.2 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.20855 | acc=0.9567 | tpr=0.9515 | fpr=0.0432 | 8017.5 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.20746 | acc=0.9570 | tpr=0.9519 | fpr=0.0429 | 10614.0 samples/s | 41.5 steps/s
Avg test loss: 0.20715, Avg test acc: 0.95701, Avg tpr: 0.95166, Avg fpr: 0.04289, total FA: 5955

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16715 | acc=0.9623 | tpr=0.9336 | fpr=0.0372 | 6133.3 samples/s | 24.0 steps/s
[Step= 100] | Loss=0.17522 | acc=0.9612 | tpr=0.9360 | fpr=0.0383 | 7445.9 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.17742 | acc=0.9599 | tpr=0.9352 | fpr=0.0397 | 7655.2 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.17758 | acc=0.9598 | tpr=0.9377 | fpr=0.0398 | 8295.7 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.17712 | acc=0.9599 | tpr=0.9380 | fpr=0.0397 | 8760.5 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.18003 | acc=0.9595 | tpr=0.9367 | fpr=0.0401 | 8110.5 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.17876 | acc=0.9596 | tpr=0.9361 | fpr=0.0400 | 7168.7 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.17935 | acc=0.9592 | tpr=0.9333 | fpr=0.0403 | 8107.4 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.18217 | acc=0.9587 | tpr=0.9323 | fpr=0.0409 | 7805.8 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.18169 | acc=0.9586 | tpr=0.9348 | fpr=0.0410 | 8454.5 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.18062 | acc=0.9589 | tpr=0.9363 | fpr=0.0407 | 10774.5 samples/s | 42.1 steps/s
Avg test loss: 0.18038, Avg test acc: 0.95889, Avg tpr: 0.93621, Avg fpr: 0.04070, total FA: 5651

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26662 | acc=0.9491 | tpr=0.9558 | fpr=0.0511 | 6051.6 samples/s | 23.6 steps/s
[Step= 100] | Loss=0.27413 | acc=0.9481 | tpr=0.9638 | fpr=0.0522 | 7067.0 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.27870 | acc=0.9470 | tpr=0.9625 | fpr=0.0533 | 8459.4 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.27858 | acc=0.9474 | tpr=0.9639 | fpr=0.0529 | 8603.0 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.27885 | acc=0.9472 | tpr=0.9633 | fpr=0.0531 | 8192.8 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.28173 | acc=0.9469 | tpr=0.9600 | fpr=0.0533 | 8063.2 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.27989 | acc=0.9471 | tpr=0.9593 | fpr=0.0531 | 7870.1 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.28028 | acc=0.9466 | tpr=0.9562 | fpr=0.0535 | 8215.5 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.28407 | acc=0.9463 | tpr=0.9542 | fpr=0.0538 | 7967.1 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.28464 | acc=0.9463 | tpr=0.9555 | fpr=0.0539 | 8462.1 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.28276 | acc=0.9466 | tpr=0.9562 | fpr=0.0536 | 9529.4 samples/s | 37.2 steps/s
Avg test loss: 0.28250, Avg test acc: 0.94658, Avg tpr: 0.95602, Avg fpr: 0.05359, total FA: 7441

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14229 | acc=0.9654 | tpr=0.9469 | fpr=0.0343 | 5890.2 samples/s | 23.0 steps/s
[Step= 100] | Loss=0.14719 | acc=0.9642 | tpr=0.9467 | fpr=0.0355 | 8054.9 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.14898 | acc=0.9625 | tpr=0.9438 | fpr=0.0371 | 8102.6 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.14888 | acc=0.9626 | tpr=0.9475 | fpr=0.0371 | 7290.8 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.14896 | acc=0.9624 | tpr=0.9450 | fpr=0.0373 | 8217.1 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.15139 | acc=0.9621 | tpr=0.9433 | fpr=0.0375 | 9017.1 samples/s | 35.2 steps/s
[Step= 350] | Loss=0.15040 | acc=0.9621 | tpr=0.9405 | fpr=0.0375 | 7693.0 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.15023 | acc=0.9617 | tpr=0.9382 | fpr=0.0379 | 8015.4 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.15248 | acc=0.9613 | tpr=0.9372 | fpr=0.0383 | 8231.9 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.15262 | acc=0.9612 | tpr=0.9388 | fpr=0.0384 | 8420.1 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.15169 | acc=0.9614 | tpr=0.9399 | fpr=0.0383 | 9521.6 samples/s | 37.2 steps/s
Avg test loss: 0.15143, Avg test acc: 0.96137, Avg tpr: 0.93978, Avg fpr: 0.03824, total FA: 5309

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.22131 | acc=0.9585 | tpr=0.9425 | fpr=0.0412 | 6138.0 samples/s | 24.0 steps/s
[Step= 100] | Loss=0.23026 | acc=0.9568 | tpr=0.9510 | fpr=0.0431 | 7313.0 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.23285 | acc=0.9552 | tpr=0.9481 | fpr=0.0447 | 7608.7 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.23325 | acc=0.9550 | tpr=0.9519 | fpr=0.0449 | 8312.0 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.23382 | acc=0.9549 | tpr=0.9511 | fpr=0.0450 | 8485.0 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.23745 | acc=0.9544 | tpr=0.9476 | fpr=0.0455 | 7547.6 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.23638 | acc=0.9542 | tpr=0.9480 | fpr=0.0457 | 8359.9 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.23662 | acc=0.9539 | tpr=0.9447 | fpr=0.0459 | 7948.1 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.24004 | acc=0.9534 | tpr=0.9445 | fpr=0.0464 | 8110.8 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.23994 | acc=0.9533 | tpr=0.9449 | fpr=0.0465 | 7661.0 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.23833 | acc=0.9537 | tpr=0.9463 | fpr=0.0462 | 11379.5 samples/s | 44.5 steps/s
Avg test loss: 0.23809, Avg test acc: 0.95370, Avg tpr: 0.94612, Avg fpr: 0.04617, total FA: 6410

server round 37/50

clients selected: [1 2 3 5 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=38001 Epoch=185.4] | Loss=0.00319 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.024 | L2-Norm(final)=14.353 | 6796.4 samples/s | 106.2 steps/s
[Step=38050 Epoch=185.7] | Loss=0.01527 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.025 | L2-Norm(final)=14.360 | 5009.1 samples/s | 78.3 steps/s
[Step=38100 Epoch=185.9] | Loss=0.01808 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.025 | L2-Norm(final)=14.367 | 5567.6 samples/s | 87.0 steps/s
[Step=38150 Epoch=186.2] | Loss=0.01678 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=14.374 | 5623.9 samples/s | 87.9 steps/s
[Step=38200 Epoch=186.4] | Loss=0.01725 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=14.382 | 8444.1 samples/s | 131.9 steps/s
[Step=38250 Epoch=186.6] | Loss=0.01721 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=14.390 | 2660.8 samples/s | 41.6 steps/s
[Step=38300 Epoch=186.9] | Loss=0.01681 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=14.398 | 5476.6 samples/s | 85.6 steps/s
[Step=38350 Epoch=187.1] | Loss=0.01734 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.025 | L2-Norm(final)=14.405 | 5656.1 samples/s | 88.4 steps/s
[Step=38400 Epoch=187.4] | Loss=0.01744 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.025 | L2-Norm(final)=14.411 | 7743.5 samples/s | 121.0 steps/s
[Step=38450 Epoch=187.6] | Loss=0.01748 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=14.417 | 2749.2 samples/s | 43.0 steps/s
[Step=38500 Epoch=187.9] | Loss=0.01776 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.025 | L2-Norm(final)=14.422 | 5543.3 samples/s | 86.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=187.9] | Loss=0.04474 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.025 | L2-Norm(final)=14.473 | 7019.5 samples/s | 109.7 steps/s
[Step=38550 Epoch=188.1] | Loss=0.01955 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.046 | L2-Norm(final)=14.470 | 4415.3 samples/s | 69.0 steps/s
[Step=38600 Epoch=188.4] | Loss=0.01698 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.065 | L2-Norm(final)=14.472 | 4745.6 samples/s | 74.2 steps/s
[Step=38650 Epoch=188.6] | Loss=0.01616 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.082 | L2-Norm(final)=14.477 | 4815.3 samples/s | 75.2 steps/s
[Step=38700 Epoch=188.8] | Loss=0.01633 | Reg=0.00102 | acc=0.9688 | L2-Norm=10.096 | L2-Norm(final)=14.480 | 6812.1 samples/s | 106.4 steps/s
[Step=38750 Epoch=189.1] | Loss=0.01426 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.107 | L2-Norm(final)=14.483 | 2473.8 samples/s | 38.7 steps/s
[Step=38800 Epoch=189.3] | Loss=0.01287 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.117 | L2-Norm(final)=14.487 | 4730.5 samples/s | 73.9 steps/s
[Step=38850 Epoch=189.6] | Loss=0.01163 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.126 | L2-Norm(final)=14.492 | 4728.4 samples/s | 73.9 steps/s
[Step=38900 Epoch=189.8] | Loss=0.01101 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=14.496 | 6354.0 samples/s | 99.3 steps/s
[Step=38950 Epoch=190.1] | Loss=0.01045 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.140 | L2-Norm(final)=14.500 | 2553.2 samples/s | 39.9 steps/s
[Step=39000 Epoch=190.3] | Loss=0.00977 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.146 | L2-Norm(final)=14.503 | 4751.3 samples/s | 74.2 steps/s
[Step=39050 Epoch=190.5] | Loss=0.00921 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.151 | L2-Norm(final)=14.507 | 4691.0 samples/s | 73.3 steps/s
[Step=39100 Epoch=190.8] | Loss=0.00886 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.156 | L2-Norm(final)=14.510 | 5933.6 samples/s | 92.7 steps/s
[Step=39150 Epoch=191.0] | Loss=0.00855 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=14.513 | 2616.9 samples/s | 40.9 steps/s
[Step=39200 Epoch=191.3] | Loss=0.00821 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.166 | L2-Norm(final)=14.516 | 4756.5 samples/s | 74.3 steps/s
[Step=39250 Epoch=191.5] | Loss=0.00782 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.170 | L2-Norm(final)=14.519 | 4825.0 samples/s | 75.4 steps/s
[Step=39300 Epoch=191.8] | Loss=0.00751 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.174 | L2-Norm(final)=14.522 | 5456.1 samples/s | 85.3 steps/s
[Step=39350 Epoch=192.0] | Loss=0.00725 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.177 | L2-Norm(final)=14.525 | 2702.8 samples/s | 42.2 steps/s
[Step=39400 Epoch=192.3] | Loss=0.00705 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.181 | L2-Norm(final)=14.528 | 4794.2 samples/s | 74.9 steps/s
[Step=39450 Epoch=192.5] | Loss=0.00679 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.184 | L2-Norm(final)=14.531 | 4719.5 samples/s | 73.7 steps/s
[Step=39500 Epoch=192.7] | Loss=0.00666 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.187 | L2-Norm(final)=14.534 | 5174.2 samples/s | 80.8 steps/s
[Step=39550 Epoch=193.0] | Loss=0.00643 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.190 | L2-Norm(final)=14.536 | 2797.0 samples/s | 43.7 steps/s
[Step=39600 Epoch=193.2] | Loss=0.00629 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.193 | L2-Norm(final)=14.539 | 4783.6 samples/s | 74.7 steps/s
[Step=39650 Epoch=193.5] | Loss=0.00619 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.196 | L2-Norm(final)=14.542 | 4749.5 samples/s | 74.2 steps/s
[Step=39700 Epoch=193.7] | Loss=0.00610 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.199 | L2-Norm(final)=14.544 | 4847.1 samples/s | 75.7 steps/s
[Step=39750 Epoch=194.0] | Loss=0.00598 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.202 | L2-Norm(final)=14.547 | 2914.7 samples/s | 45.5 steps/s
[Step=39800 Epoch=194.2] | Loss=0.00582 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.205 | L2-Norm(final)=14.549 | 4637.0 samples/s | 72.5 steps/s
[Step=39850 Epoch=194.4] | Loss=0.00572 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.207 | L2-Norm(final)=14.552 | 4736.0 samples/s | 74.0 steps/s
[Step=39900 Epoch=194.7] | Loss=0.00562 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.210 | L2-Norm(final)=14.554 | 4759.7 samples/s | 74.4 steps/s
[Step=39950 Epoch=194.9] | Loss=0.00552 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.212 | L2-Norm(final)=14.557 | 2947.0 samples/s | 46.0 steps/s
[Step=40000 Epoch=195.2] | Loss=0.00546 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.215 | L2-Norm(final)=14.559 | 4755.8 samples/s | 74.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step40000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=38001 Epoch=185.2] | Loss=0.01862 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.024 | L2-Norm(final)=13.439 | 7236.5 samples/s | 113.1 steps/s
[Step=38050 Epoch=185.4] | Loss=0.02309 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=13.447 | 4850.1 samples/s | 75.8 steps/s
[Step=38100 Epoch=185.6] | Loss=0.02166 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.025 | L2-Norm(final)=13.455 | 5464.2 samples/s | 85.4 steps/s
[Step=38150 Epoch=185.9] | Loss=0.02143 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.025 | L2-Norm(final)=13.464 | 5552.4 samples/s | 86.8 steps/s
[Step=38200 Epoch=186.1] | Loss=0.02090 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=13.471 | 8505.2 samples/s | 132.9 steps/s
[Step=38250 Epoch=186.4] | Loss=0.02001 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.025 | L2-Norm(final)=13.479 | 2683.5 samples/s | 41.9 steps/s
[Step=38300 Epoch=186.6] | Loss=0.01999 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=13.488 | 5589.6 samples/s | 87.3 steps/s
[Step=38350 Epoch=186.9] | Loss=0.01968 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=13.496 | 5628.3 samples/s | 87.9 steps/s
[Step=38400 Epoch=187.1] | Loss=0.01983 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=13.504 | 7378.6 samples/s | 115.3 steps/s
[Step=38450 Epoch=187.3] | Loss=0.01934 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.025 | L2-Norm(final)=13.510 | 2762.3 samples/s | 43.2 steps/s
[Step=38500 Epoch=187.6] | Loss=0.01944 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=13.517 | 5594.7 samples/s | 87.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=187.6] | Loss=0.00510 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=13.578 | 7304.2 samples/s | 114.1 steps/s
[Step=38550 Epoch=187.8] | Loss=0.01680 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.044 | L2-Norm(final)=13.581 | 4220.7 samples/s | 65.9 steps/s
[Step=38600 Epoch=188.1] | Loss=0.01593 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.062 | L2-Norm(final)=13.585 | 4672.5 samples/s | 73.0 steps/s
[Step=38650 Epoch=188.3] | Loss=0.01714 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.078 | L2-Norm(final)=13.589 | 4808.5 samples/s | 75.1 steps/s
[Step=38700 Epoch=188.6] | Loss=0.01627 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.090 | L2-Norm(final)=13.592 | 6747.3 samples/s | 105.4 steps/s
[Step=38750 Epoch=188.8] | Loss=0.01418 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.101 | L2-Norm(final)=13.596 | 2311.5 samples/s | 36.1 steps/s
[Step=38800 Epoch=189.1] | Loss=0.01305 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.111 | L2-Norm(final)=13.600 | 4723.7 samples/s | 73.8 steps/s
[Step=38850 Epoch=189.3] | Loss=0.01227 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.119 | L2-Norm(final)=13.604 | 4827.5 samples/s | 75.4 steps/s
[Step=38900 Epoch=189.5] | Loss=0.01145 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.126 | L2-Norm(final)=13.608 | 6101.2 samples/s | 95.3 steps/s
[Step=38950 Epoch=189.8] | Loss=0.01068 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=13.612 | 2564.3 samples/s | 40.1 steps/s
[Step=39000 Epoch=190.0] | Loss=0.01012 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.139 | L2-Norm(final)=13.616 | 4833.2 samples/s | 75.5 steps/s
[Step=39050 Epoch=190.3] | Loss=0.00970 | Reg=0.00103 | acc=0.9688 | L2-Norm=10.145 | L2-Norm(final)=13.620 | 4689.9 samples/s | 73.3 steps/s
[Step=39100 Epoch=190.5] | Loss=0.00929 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.150 | L2-Norm(final)=13.624 | 5736.8 samples/s | 89.6 steps/s
[Step=39150 Epoch=190.8] | Loss=0.00886 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.155 | L2-Norm(final)=13.628 | 2633.2 samples/s | 41.1 steps/s
[Step=39200 Epoch=191.0] | Loss=0.00841 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.160 | L2-Norm(final)=13.631 | 4763.4 samples/s | 74.4 steps/s
[Step=39250 Epoch=191.2] | Loss=0.00821 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=13.635 | 4863.7 samples/s | 76.0 steps/s
[Step=39300 Epoch=191.5] | Loss=0.00800 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.169 | L2-Norm(final)=13.638 | 5154.7 samples/s | 80.5 steps/s
[Step=39350 Epoch=191.7] | Loss=0.00774 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.173 | L2-Norm(final)=13.642 | 2780.3 samples/s | 43.4 steps/s
[Step=39400 Epoch=192.0] | Loss=0.00743 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.177 | L2-Norm(final)=13.645 | 4748.2 samples/s | 74.2 steps/s
[Step=39450 Epoch=192.2] | Loss=0.00727 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.180 | L2-Norm(final)=13.648 | 4820.2 samples/s | 75.3 steps/s
[Step=39500 Epoch=192.5] | Loss=0.00710 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.184 | L2-Norm(final)=13.651 | 4773.4 samples/s | 74.6 steps/s
[Step=39550 Epoch=192.7] | Loss=0.00702 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.187 | L2-Norm(final)=13.654 | 2901.3 samples/s | 45.3 steps/s
[Step=39600 Epoch=193.0] | Loss=0.00683 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.191 | L2-Norm(final)=13.657 | 4796.4 samples/s | 74.9 steps/s
[Step=39650 Epoch=193.2] | Loss=0.00665 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.194 | L2-Norm(final)=13.660 | 4815.4 samples/s | 75.2 steps/s
[Step=39700 Epoch=193.4] | Loss=0.00649 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.197 | L2-Norm(final)=13.662 | 4689.2 samples/s | 73.3 steps/s
[Step=39750 Epoch=193.7] | Loss=0.00641 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.200 | L2-Norm(final)=13.665 | 2907.2 samples/s | 45.4 steps/s
[Step=39800 Epoch=193.9] | Loss=0.00629 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.203 | L2-Norm(final)=13.668 | 4770.6 samples/s | 74.5 steps/s
[Step=39850 Epoch=194.2] | Loss=0.00615 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.206 | L2-Norm(final)=13.670 | 4728.7 samples/s | 73.9 steps/s
[Step=39900 Epoch=194.4] | Loss=0.00602 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.209 | L2-Norm(final)=13.673 | 4762.1 samples/s | 74.4 steps/s
[Step=39950 Epoch=194.7] | Loss=0.00587 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.212 | L2-Norm(final)=13.676 | 2965.6 samples/s | 46.3 steps/s
[Step=40000 Epoch=194.9] | Loss=0.00578 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.215 | L2-Norm(final)=13.678 | 4774.2 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step40000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=26001 Epoch=126.8] | Loss=0.00618 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.024 | L2-Norm(final)=13.460 | 6636.0 samples/s | 103.7 steps/s
[Step=26050 Epoch=127.0] | Loss=0.01821 | Reg=0.00100 | acc=0.9688 | L2-Norm=10.025 | L2-Norm(final)=13.466 | 4990.4 samples/s | 78.0 steps/s
[Step=26100 Epoch=127.3] | Loss=0.01862 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=13.470 | 5487.1 samples/s | 85.7 steps/s
[Step=26150 Epoch=127.5] | Loss=0.01867 | Reg=0.00100 | acc=0.9688 | L2-Norm=10.025 | L2-Norm(final)=13.476 | 5642.1 samples/s | 88.2 steps/s
[Step=26200 Epoch=127.8] | Loss=0.01877 | Reg=0.00100 | acc=0.9688 | L2-Norm=10.025 | L2-Norm(final)=13.481 | 8452.8 samples/s | 132.1 steps/s
[Step=26250 Epoch=128.0] | Loss=0.01860 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=13.484 | 2669.0 samples/s | 41.7 steps/s
[Step=26300 Epoch=128.3] | Loss=0.01891 | Reg=0.00100 | acc=0.9688 | L2-Norm=10.025 | L2-Norm(final)=13.487 | 5591.2 samples/s | 87.4 steps/s
[Step=26350 Epoch=128.5] | Loss=0.01881 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=13.490 | 5549.0 samples/s | 86.7 steps/s
[Step=26400 Epoch=128.7] | Loss=0.01851 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.025 | L2-Norm(final)=13.494 | 7653.5 samples/s | 119.6 steps/s
[Step=26450 Epoch=129.0] | Loss=0.01877 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.025 | L2-Norm(final)=13.499 | 2812.1 samples/s | 43.9 steps/s
[Step=26500 Epoch=129.2] | Loss=0.01853 | Reg=0.00100 | acc=0.9531 | L2-Norm=10.025 | L2-Norm(final)=13.503 | 5511.5 samples/s | 86.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=26501 Epoch=129.2] | Loss=0.01471 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.025 | L2-Norm(final)=13.540 | 7218.7 samples/s | 112.8 steps/s
[Step=26550 Epoch=129.5] | Loss=0.02139 | Reg=0.00101 | acc=0.9531 | L2-Norm=10.048 | L2-Norm(final)=13.542 | 4353.3 samples/s | 68.0 steps/s
[Step=26600 Epoch=129.7] | Loss=0.01930 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.074 | L2-Norm(final)=13.544 | 4635.5 samples/s | 72.4 steps/s
[Step=26650 Epoch=130.0] | Loss=0.01735 | Reg=0.00102 | acc=0.9688 | L2-Norm=10.093 | L2-Norm(final)=13.548 | 4773.9 samples/s | 74.6 steps/s
[Step=26700 Epoch=130.2] | Loss=0.01581 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.109 | L2-Norm(final)=13.553 | 6836.3 samples/s | 106.8 steps/s
[Step=26750 Epoch=130.4] | Loss=0.01422 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.123 | L2-Norm(final)=13.558 | 2452.8 samples/s | 38.3 steps/s
[Step=26800 Epoch=130.7] | Loss=0.01274 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=13.563 | 4751.9 samples/s | 74.2 steps/s
[Step=26850 Epoch=130.9] | Loss=0.01158 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.145 | L2-Norm(final)=13.568 | 4796.4 samples/s | 74.9 steps/s
[Step=26900 Epoch=131.2] | Loss=0.01083 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.154 | L2-Norm(final)=13.573 | 6236.5 samples/s | 97.4 steps/s
[Step=26950 Epoch=131.4] | Loss=0.01003 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=13.578 | 2572.3 samples/s | 40.2 steps/s
[Step=27000 Epoch=131.7] | Loss=0.00940 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.170 | L2-Norm(final)=13.583 | 4752.9 samples/s | 74.3 steps/s
[Step=27050 Epoch=131.9] | Loss=0.00899 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.177 | L2-Norm(final)=13.587 | 4793.2 samples/s | 74.9 steps/s
[Step=27100 Epoch=132.2] | Loss=0.00856 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.183 | L2-Norm(final)=13.592 | 5619.1 samples/s | 87.8 steps/s
[Step=27150 Epoch=132.4] | Loss=0.00819 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.189 | L2-Norm(final)=13.596 | 2676.7 samples/s | 41.8 steps/s
[Step=27200 Epoch=132.6] | Loss=0.00783 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.194 | L2-Norm(final)=13.600 | 4789.7 samples/s | 74.8 steps/s
[Step=27250 Epoch=132.9] | Loss=0.00749 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.199 | L2-Norm(final)=13.604 | 4739.6 samples/s | 74.1 steps/s
[Step=27300 Epoch=133.1] | Loss=0.00729 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.204 | L2-Norm(final)=13.607 | 5240.9 samples/s | 81.9 steps/s
[Step=27350 Epoch=133.4] | Loss=0.00705 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.209 | L2-Norm(final)=13.611 | 2750.0 samples/s | 43.0 steps/s
[Step=27400 Epoch=133.6] | Loss=0.00680 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.213 | L2-Norm(final)=13.614 | 4764.2 samples/s | 74.4 steps/s
[Step=27450 Epoch=133.9] | Loss=0.00659 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.218 | L2-Norm(final)=13.618 | 4746.0 samples/s | 74.2 steps/s
[Step=27500 Epoch=134.1] | Loss=0.00639 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.222 | L2-Norm(final)=13.621 | 4912.6 samples/s | 76.8 steps/s
[Step=27550 Epoch=134.3] | Loss=0.00627 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.226 | L2-Norm(final)=13.624 | 2908.3 samples/s | 45.4 steps/s
[Step=27600 Epoch=134.6] | Loss=0.00607 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.229 | L2-Norm(final)=13.627 | 4675.1 samples/s | 73.0 steps/s
[Step=27650 Epoch=134.8] | Loss=0.00595 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.233 | L2-Norm(final)=13.631 | 4830.4 samples/s | 75.5 steps/s
[Step=27700 Epoch=135.1] | Loss=0.00580 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.236 | L2-Norm(final)=13.634 | 4639.6 samples/s | 72.5 steps/s
[Step=27750 Epoch=135.3] | Loss=0.00563 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.240 | L2-Norm(final)=13.637 | 2931.8 samples/s | 45.8 steps/s
[Step=27800 Epoch=135.6] | Loss=0.00552 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.243 | L2-Norm(final)=13.640 | 4737.0 samples/s | 74.0 steps/s
[Step=27850 Epoch=135.8] | Loss=0.00545 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=13.643 | 4747.9 samples/s | 74.2 steps/s
[Step=27900 Epoch=136.1] | Loss=0.00534 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.250 | L2-Norm(final)=13.645 | 4783.8 samples/s | 74.7 steps/s
[Step=27950 Epoch=136.3] | Loss=0.00524 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.253 | L2-Norm(final)=13.648 | 2983.9 samples/s | 46.6 steps/s
[Step=28000 Epoch=136.5] | Loss=0.00514 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.256 | L2-Norm(final)=13.651 | 4695.5 samples/s | 73.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step28000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=50001 Epoch=473.8] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.024 | L2-Norm(final)=18.010 | 5575.3 samples/s | 87.1 steps/s
[Step=50050 Epoch=474.3] | Loss=0.00006 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=18.017 | 4855.9 samples/s | 75.9 steps/s
[Step=50100 Epoch=474.7] | Loss=0.00006 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.013 | L2-Norm(final)=18.024 | 8327.6 samples/s | 130.1 steps/s
[Step=50150 Epoch=475.2] | Loss=0.00005 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=18.029 | 2565.2 samples/s | 40.1 steps/s
[Step=50200 Epoch=475.7] | Loss=0.00006 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=18.035 | 7337.8 samples/s | 114.7 steps/s
[Step=50250 Epoch=476.2] | Loss=0.00006 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=18.040 | 2672.1 samples/s | 41.8 steps/s
[Step=50300 Epoch=476.6] | Loss=0.00006 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=18.045 | 6571.0 samples/s | 102.7 steps/s
[Step=50350 Epoch=477.1] | Loss=0.00006 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=18.050 | 2807.6 samples/s | 43.9 steps/s
[Step=50400 Epoch=477.6] | Loss=0.00006 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=18.055 | 5915.7 samples/s | 92.4 steps/s
[Step=50450 Epoch=478.1] | Loss=0.00006 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=18.060 | 2928.1 samples/s | 45.8 steps/s
[Step=50500 Epoch=478.5] | Loss=0.00006 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=18.064 | 5366.4 samples/s | 83.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=50501 Epoch=478.5] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=18.104 | 6357.8 samples/s | 99.3 steps/s
[Step=50550 Epoch=479.0] | Loss=0.00023 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=18.108 | 4272.6 samples/s | 66.8 steps/s
[Step=50600 Epoch=479.5] | Loss=0.00015 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.008 | L2-Norm(final)=18.110 | 6596.6 samples/s | 103.1 steps/s
[Step=50650 Epoch=480.0] | Loss=0.00013 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.007 | L2-Norm(final)=18.111 | 2389.2 samples/s | 37.3 steps/s
[Step=50700 Epoch=480.4] | Loss=0.00011 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.005 | L2-Norm(final)=18.112 | 5942.1 samples/s | 92.8 steps/s
[Step=50750 Epoch=480.9] | Loss=0.00009 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.002 | L2-Norm(final)=18.113 | 2407.0 samples/s | 37.6 steps/s
[Step=50800 Epoch=481.4] | Loss=0.00007 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.998 | L2-Norm(final)=18.113 | 5469.5 samples/s | 85.5 steps/s
[Step=50850 Epoch=481.8] | Loss=0.00006 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.992 | L2-Norm(final)=18.114 | 2574.2 samples/s | 40.2 steps/s
[Step=50900 Epoch=482.3] | Loss=0.00005 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.987 | L2-Norm(final)=18.114 | 5013.9 samples/s | 78.3 steps/s
[Step=50950 Epoch=482.8] | Loss=0.00005 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.981 | L2-Norm(final)=18.115 | 2685.5 samples/s | 42.0 steps/s
[Step=51000 Epoch=483.3] | Loss=0.00004 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.975 | L2-Norm(final)=18.115 | 4669.7 samples/s | 73.0 steps/s
[Step=51050 Epoch=483.7] | Loss=0.00004 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.969 | L2-Norm(final)=18.115 | 2792.3 samples/s | 43.6 steps/s
[Step=51100 Epoch=484.2] | Loss=0.00004 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.963 | L2-Norm(final)=18.115 | 4489.6 samples/s | 70.2 steps/s
[Step=51150 Epoch=484.7] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.957 | L2-Norm(final)=18.115 | 2903.9 samples/s | 45.4 steps/s
[Step=51200 Epoch=485.2] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.951 | L2-Norm(final)=18.115 | 4418.8 samples/s | 69.0 steps/s
[Step=51250 Epoch=485.6] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.944 | L2-Norm(final)=18.116 | 2834.2 samples/s | 44.3 steps/s
[Step=51300 Epoch=486.1] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.938 | L2-Norm(final)=18.116 | 4519.8 samples/s | 70.6 steps/s
[Step=51350 Epoch=486.6] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.932 | L2-Norm(final)=18.116 | 2927.9 samples/s | 45.7 steps/s
[Step=51400 Epoch=487.1] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.926 | L2-Norm(final)=18.116 | 4451.8 samples/s | 69.6 steps/s
[Step=51450 Epoch=487.5] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.919 | L2-Norm(final)=18.116 | 6783.1 samples/s | 106.0 steps/s
[Step=51500 Epoch=488.0] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.913 | L2-Norm(final)=18.116 | 2352.6 samples/s | 36.8 steps/s
[Step=51550 Epoch=488.5] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=18.116 | 6191.9 samples/s | 96.7 steps/s
[Step=51600 Epoch=489.0] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=18.116 | 2450.1 samples/s | 38.3 steps/s
[Step=51650 Epoch=489.4] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.893 | L2-Norm(final)=18.116 | 5643.1 samples/s | 88.2 steps/s
[Step=51700 Epoch=489.9] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.887 | L2-Norm(final)=18.117 | 2532.4 samples/s | 39.6 steps/s
[Step=51750 Epoch=490.4] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.880 | L2-Norm(final)=18.117 | 5154.7 samples/s | 80.5 steps/s
[Step=51800 Epoch=490.8] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=18.117 | 2661.3 samples/s | 41.6 steps/s
[Step=51850 Epoch=491.3] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.867 | L2-Norm(final)=18.117 | 4756.5 samples/s | 74.3 steps/s
[Step=51900 Epoch=491.8] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.861 | L2-Norm(final)=18.117 | 2787.2 samples/s | 43.6 steps/s
[Step=51950 Epoch=492.3] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.854 | L2-Norm(final)=18.117 | 4538.8 samples/s | 70.9 steps/s
[Step=52000 Epoch=492.7] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=18.117 | 2865.3 samples/s | 44.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step52000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=36001 Epoch=339.2] | Loss=0.00115 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.024 | L2-Norm(final)=15.653 | 7162.5 samples/s | 111.9 steps/s
[Step=36050 Epoch=339.7] | Loss=0.00077 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=15.658 | 4396.6 samples/s | 68.7 steps/s
[Step=36100 Epoch=340.2] | Loss=0.00066 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=15.665 | 8159.8 samples/s | 127.5 steps/s
[Step=36150 Epoch=340.6] | Loss=0.00062 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=15.671 | 2587.9 samples/s | 40.4 steps/s
[Step=36200 Epoch=341.1] | Loss=0.00064 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=15.676 | 7011.5 samples/s | 109.6 steps/s
[Step=36250 Epoch=341.6] | Loss=0.00061 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=15.682 | 2756.8 samples/s | 43.1 steps/s
[Step=36300 Epoch=342.0] | Loss=0.00059 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=15.686 | 6015.6 samples/s | 94.0 steps/s
[Step=36350 Epoch=342.5] | Loss=0.00060 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=15.692 | 2893.4 samples/s | 45.2 steps/s
[Step=36400 Epoch=343.0] | Loss=0.00064 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=15.697 | 5501.3 samples/s | 86.0 steps/s
[Step=36450 Epoch=343.5] | Loss=0.00061 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=15.703 | 3100.1 samples/s | 48.4 steps/s
[Step=36500 Epoch=343.9] | Loss=0.00062 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=15.708 | 5023.5 samples/s | 78.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=343.9] | Loss=0.00010 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=15.761 | 6984.9 samples/s | 109.1 steps/s
[Step=36550 Epoch=344.4] | Loss=0.00250 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.043 | L2-Norm(final)=15.760 | 4057.1 samples/s | 63.4 steps/s
[Step=36600 Epoch=344.9] | Loss=0.00161 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.065 | L2-Norm(final)=15.758 | 6422.3 samples/s | 100.3 steps/s
[Step=36650 Epoch=345.3] | Loss=0.00129 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.075 | L2-Norm(final)=15.757 | 2398.2 samples/s | 37.5 steps/s
[Step=36700 Epoch=345.8] | Loss=0.00097 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.081 | L2-Norm(final)=15.757 | 5858.4 samples/s | 91.5 steps/s
[Step=36750 Epoch=346.3] | Loss=0.00078 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.083 | L2-Norm(final)=15.758 | 2521.2 samples/s | 39.4 steps/s
[Step=36800 Epoch=346.8] | Loss=0.00065 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.084 | L2-Norm(final)=15.758 | 5252.8 samples/s | 82.1 steps/s
[Step=36850 Epoch=347.2] | Loss=0.00056 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.085 | L2-Norm(final)=15.758 | 2633.0 samples/s | 41.1 steps/s
[Step=36900 Epoch=347.7] | Loss=0.00049 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.084 | L2-Norm(final)=15.758 | 4804.2 samples/s | 75.1 steps/s
[Step=36950 Epoch=348.2] | Loss=0.00044 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.084 | L2-Norm(final)=15.759 | 2756.4 samples/s | 43.1 steps/s
[Step=37000 Epoch=348.6] | Loss=0.00040 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.083 | L2-Norm(final)=15.759 | 4538.5 samples/s | 70.9 steps/s
[Step=37050 Epoch=349.1] | Loss=0.00036 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.082 | L2-Norm(final)=15.759 | 2880.6 samples/s | 45.0 steps/s
[Step=37100 Epoch=349.6] | Loss=0.00033 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=15.759 | 4501.9 samples/s | 70.3 steps/s
[Step=37150 Epoch=350.1] | Loss=0.00031 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.079 | L2-Norm(final)=15.760 | 2868.3 samples/s | 44.8 steps/s
[Step=37200 Epoch=350.5] | Loss=0.00029 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.077 | L2-Norm(final)=15.760 | 4569.2 samples/s | 71.4 steps/s
[Step=37250 Epoch=351.0] | Loss=0.00027 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.076 | L2-Norm(final)=15.760 | 3173.8 samples/s | 49.6 steps/s
[Step=37300 Epoch=351.5] | Loss=0.00025 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.074 | L2-Norm(final)=15.761 | 3870.0 samples/s | 60.5 steps/s
[Step=37350 Epoch=351.9] | Loss=0.00024 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.072 | L2-Norm(final)=15.761 | 6638.9 samples/s | 103.7 steps/s
[Step=37400 Epoch=352.4] | Loss=0.00022 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.071 | L2-Norm(final)=15.761 | 2369.1 samples/s | 37.0 steps/s
[Step=37450 Epoch=352.9] | Loss=0.00021 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.069 | L2-Norm(final)=15.761 | 5855.1 samples/s | 91.5 steps/s
[Step=37500 Epoch=353.4] | Loss=0.00020 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=15.762 | 2489.0 samples/s | 38.9 steps/s
[Step=37550 Epoch=353.8] | Loss=0.00019 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.065 | L2-Norm(final)=15.762 | 5310.4 samples/s | 83.0 steps/s
[Step=37600 Epoch=354.3] | Loss=0.00018 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=15.762 | 2664.1 samples/s | 41.6 steps/s
[Step=37650 Epoch=354.8] | Loss=0.00018 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.061 | L2-Norm(final)=15.762 | 4683.5 samples/s | 73.2 steps/s
[Step=37700 Epoch=355.2] | Loss=0.00017 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.059 | L2-Norm(final)=15.763 | 2747.2 samples/s | 42.9 steps/s
[Step=37750 Epoch=355.7] | Loss=0.00016 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.057 | L2-Norm(final)=15.763 | 4590.6 samples/s | 71.7 steps/s
[Step=37800 Epoch=356.2] | Loss=0.00016 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.055 | L2-Norm(final)=15.763 | 2862.3 samples/s | 44.7 steps/s
[Step=37850 Epoch=356.7] | Loss=0.00015 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.053 | L2-Norm(final)=15.763 | 4471.1 samples/s | 69.9 steps/s
[Step=37900 Epoch=357.1] | Loss=0.00015 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.050 | L2-Norm(final)=15.764 | 2882.7 samples/s | 45.0 steps/s
[Step=37950 Epoch=357.6] | Loss=0.00014 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.048 | L2-Norm(final)=15.764 | 4513.3 samples/s | 70.5 steps/s
[Step=38000 Epoch=358.1] | Loss=0.00014 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.046 | L2-Norm(final)=15.764 | 2955.2 samples/s | 46.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step38000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08184 | acc=0.9623 | tpr=0.9688 | fpr=0.0518 | 5716.3 samples/s | 22.3 steps/s
Avg test loss: 0.08833, Avg test acc: 0.95949, Avg tpr: 0.96672, Avg fpr: 0.05640, total FA: 440

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08714 | acc=0.9618 | tpr=0.9743 | fpr=0.0654 | 5841.4 samples/s | 22.8 steps/s
Avg test loss: 0.09104, Avg test acc: 0.96117, Avg tpr: 0.97290, Avg fpr: 0.06461, total FA: 504

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08900 | acc=0.9631 | tpr=0.9762 | fpr=0.0652 | 5895.5 samples/s | 23.0 steps/s
Avg test loss: 0.09150, Avg test acc: 0.96109, Avg tpr: 0.97354, Avg fpr: 0.06627, total FA: 517

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08775 | acc=0.9619 | tpr=0.9754 | fpr=0.0674 | 5838.8 samples/s | 22.8 steps/s
Avg test loss: 0.09303, Avg test acc: 0.96069, Avg tpr: 0.97395, Avg fpr: 0.06845, total FA: 534

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09383 | acc=0.9627 | tpr=0.9690 | fpr=0.0508 | 5998.5 samples/s | 23.4 steps/s
Avg test loss: 0.09787, Avg test acc: 0.96146, Avg tpr: 0.96649, Avg fpr: 0.04961, total FA: 387

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.81640 | acc=0.2913 | tpr=0.0143 | fpr=0.1070 | 6242.3 samples/s | 24.4 steps/s
Avg test loss: 6.82868, Avg test acc: 0.28897, Avg tpr: 0.01399, Avg fpr: 0.10627, total FA: 829

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.71258 | acc=0.3064 | tpr=0.0319 | fpr=0.0976 | 5749.9 samples/s | 22.5 steps/s
Avg test loss: 4.72212, Avg test acc: 0.30399, Avg tpr: 0.03130, Avg fpr: 0.09627, total FA: 751

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.04505 | acc=0.2930 | tpr=0.0210 | fpr=0.1162 | 5996.9 samples/s | 23.4 steps/s
Avg test loss: 5.05229, Avg test acc: 0.29089, Avg tpr: 0.01976, Avg fpr: 0.11281, total FA: 880

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.06720 | acc=0.2727 | tpr=0.0294 | fpr=0.1990 | 6186.4 samples/s | 24.2 steps/s
Avg test loss: 5.07509, Avg test acc: 0.27258, Avg tpr: 0.02751, Avg fpr: 0.18844, total FA: 1470

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.99435 | acc=0.2956 | tpr=0.0165 | fpr=0.0984 | 6171.0 samples/s | 24.1 steps/s
Avg test loss: 5.01189, Avg test acc: 0.29401, Avg tpr: 0.01655, Avg fpr: 0.09576, total FA: 747

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.73972 | acc=0.1391 | tpr=0.5354 | fpr=0.8681 | 5971.2 samples/s | 23.3 steps/s
[Step= 100] | Loss=4.72684 | acc=0.1424 | tpr=0.5181 | fpr=0.8646 | 7860.7 samples/s | 30.7 steps/s
[Step= 150] | Loss=4.71583 | acc=0.1450 | tpr=0.5303 | fpr=0.8621 | 7636.4 samples/s | 29.8 steps/s
[Step= 200] | Loss=4.70729 | acc=0.1452 | tpr=0.5246 | fpr=0.8617 | 8166.2 samples/s | 31.9 steps/s
[Step= 250] | Loss=4.71101 | acc=0.1446 | tpr=0.5179 | fpr=0.8622 | 7682.7 samples/s | 30.0 steps/s
[Step= 300] | Loss=4.70441 | acc=0.1449 | tpr=0.5069 | fpr=0.8617 | 8230.5 samples/s | 32.2 steps/s
[Step= 350] | Loss=4.70986 | acc=0.1448 | tpr=0.5041 | fpr=0.8617 | 8220.7 samples/s | 32.1 steps/s
[Step= 400] | Loss=4.70716 | acc=0.1456 | tpr=0.5038 | fpr=0.8610 | 8062.8 samples/s | 31.5 steps/s
[Step= 450] | Loss=4.71071 | acc=0.1452 | tpr=0.5107 | fpr=0.8614 | 7967.9 samples/s | 31.1 steps/s
[Step= 500] | Loss=4.71071 | acc=0.1452 | tpr=0.5132 | fpr=0.8615 | 8216.5 samples/s | 32.1 steps/s
[Step= 550] | Loss=4.71379 | acc=0.1451 | tpr=0.5137 | fpr=0.8616 | 10650.5 samples/s | 41.6 steps/s
Avg test loss: 4.71421, Avg test acc: 0.14502, Avg tpr: 0.51426, Avg fpr: 0.86169, total FA: 119644

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.71279 | acc=0.1379 | tpr=0.5752 | fpr=0.8700 | 6032.7 samples/s | 23.6 steps/s
[Step= 100] | Loss=4.69918 | acc=0.1415 | tpr=0.5864 | fpr=0.8668 | 8068.7 samples/s | 31.5 steps/s
[Step= 150] | Loss=4.68728 | acc=0.1441 | tpr=0.6052 | fpr=0.8644 | 8043.6 samples/s | 31.4 steps/s
[Step= 200] | Loss=4.68060 | acc=0.1444 | tpr=0.5989 | fpr=0.8639 | 6907.9 samples/s | 27.0 steps/s
[Step= 250] | Loss=4.68421 | acc=0.1445 | tpr=0.5904 | fpr=0.8636 | 8744.3 samples/s | 34.2 steps/s
[Step= 300] | Loss=4.68056 | acc=0.1439 | tpr=0.5796 | fpr=0.8641 | 8150.0 samples/s | 31.8 steps/s
[Step= 350] | Loss=4.68614 | acc=0.1436 | tpr=0.5736 | fpr=0.8642 | 8132.7 samples/s | 31.8 steps/s
[Step= 400] | Loss=4.68405 | acc=0.1440 | tpr=0.5749 | fpr=0.8639 | 8474.1 samples/s | 33.1 steps/s
[Step= 450] | Loss=4.68756 | acc=0.1435 | tpr=0.5813 | fpr=0.8645 | 8075.3 samples/s | 31.5 steps/s
[Step= 500] | Loss=4.68864 | acc=0.1433 | tpr=0.5819 | fpr=0.8646 | 7951.7 samples/s | 31.1 steps/s
[Step= 550] | Loss=4.69142 | acc=0.1435 | tpr=0.5842 | fpr=0.8645 | 9855.2 samples/s | 38.5 steps/s
Avg test loss: 4.69173, Avg test acc: 0.14337, Avg tpr: 0.58479, Avg fpr: 0.86466, total FA: 120056

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.17704 | acc=0.1237 | tpr=0.6195 | fpr=0.8852 | 6016.5 samples/s | 23.5 steps/s
[Step= 100] | Loss=5.16235 | acc=0.1264 | tpr=0.6226 | fpr=0.8829 | 7611.4 samples/s | 29.7 steps/s
[Step= 150] | Loss=5.15417 | acc=0.1283 | tpr=0.6311 | fpr=0.8809 | 8530.7 samples/s | 33.3 steps/s
[Step= 200] | Loss=5.14610 | acc=0.1286 | tpr=0.6186 | fpr=0.8803 | 7951.1 samples/s | 31.1 steps/s
[Step= 250] | Loss=5.15129 | acc=0.1288 | tpr=0.6201 | fpr=0.8801 | 7825.6 samples/s | 30.6 steps/s
[Step= 300] | Loss=5.14801 | acc=0.1284 | tpr=0.6211 | fpr=0.8806 | 7902.1 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.15392 | acc=0.1284 | tpr=0.6180 | fpr=0.8805 | 8207.1 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.15281 | acc=0.1286 | tpr=0.6154 | fpr=0.8803 | 7931.8 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.15794 | acc=0.1278 | tpr=0.6173 | fpr=0.8811 | 7957.5 samples/s | 31.1 steps/s
[Step= 500] | Loss=5.15693 | acc=0.1277 | tpr=0.6189 | fpr=0.8812 | 8002.8 samples/s | 31.3 steps/s
[Step= 550] | Loss=5.15984 | acc=0.1278 | tpr=0.6188 | fpr=0.8811 | 10189.0 samples/s | 39.8 steps/s
Avg test loss: 5.16037, Avg test acc: 0.12771, Avg tpr: 0.62005, Avg fpr: 0.88124, total FA: 122358

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.96585 | acc=0.1342 | tpr=0.6637 | fpr=0.8753 | 6155.7 samples/s | 24.0 steps/s
[Step= 100] | Loss=4.95726 | acc=0.1376 | tpr=0.6503 | fpr=0.8720 | 7640.1 samples/s | 29.8 steps/s
[Step= 150] | Loss=4.94590 | acc=0.1394 | tpr=0.6585 | fpr=0.8702 | 7629.9 samples/s | 29.8 steps/s
[Step= 200] | Loss=4.93632 | acc=0.1401 | tpr=0.6590 | fpr=0.8694 | 8604.1 samples/s | 33.6 steps/s
[Step= 250] | Loss=4.93840 | acc=0.1397 | tpr=0.6515 | fpr=0.8696 | 7898.1 samples/s | 30.9 steps/s
[Step= 300] | Loss=4.93465 | acc=0.1392 | tpr=0.6509 | fpr=0.8701 | 7852.6 samples/s | 30.7 steps/s
[Step= 350] | Loss=4.94029 | acc=0.1389 | tpr=0.6500 | fpr=0.8704 | 8000.9 samples/s | 31.3 steps/s
[Step= 400] | Loss=4.93911 | acc=0.1394 | tpr=0.6472 | fpr=0.8698 | 7855.2 samples/s | 30.7 steps/s
[Step= 450] | Loss=4.94419 | acc=0.1386 | tpr=0.6509 | fpr=0.8707 | 7676.5 samples/s | 30.0 steps/s
[Step= 500] | Loss=4.94339 | acc=0.1385 | tpr=0.6533 | fpr=0.8708 | 7893.7 samples/s | 30.8 steps/s
[Step= 550] | Loss=4.94766 | acc=0.1383 | tpr=0.6538 | fpr=0.8710 | 11245.8 samples/s | 43.9 steps/s
Avg test loss: 4.94828, Avg test acc: 0.13826, Avg tpr: 0.65491, Avg fpr: 0.87113, total FA: 120955

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.28901 | acc=0.1422 | tpr=0.4690 | fpr=0.8637 | 5967.8 samples/s | 23.3 steps/s
[Step= 100] | Loss=5.27488 | acc=0.1442 | tpr=0.4584 | fpr=0.8616 | 8198.7 samples/s | 32.0 steps/s
[Step= 150] | Loss=5.26396 | acc=0.1466 | tpr=0.4683 | fpr=0.8593 | 7230.5 samples/s | 28.2 steps/s
[Step= 200] | Loss=5.25822 | acc=0.1473 | tpr=0.4689 | fpr=0.8585 | 8626.9 samples/s | 33.7 steps/s
[Step= 250] | Loss=5.26212 | acc=0.1474 | tpr=0.4611 | fpr=0.8583 | 8211.3 samples/s | 32.1 steps/s
[Step= 300] | Loss=5.25817 | acc=0.1470 | tpr=0.4545 | fpr=0.8586 | 8307.8 samples/s | 32.5 steps/s
[Step= 350] | Loss=5.26509 | acc=0.1471 | tpr=0.4546 | fpr=0.8585 | 8019.4 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.26113 | acc=0.1473 | tpr=0.4546 | fpr=0.8583 | 8200.4 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.26571 | acc=0.1467 | tpr=0.4581 | fpr=0.8589 | 7799.8 samples/s | 30.5 steps/s
[Step= 500] | Loss=5.26569 | acc=0.1469 | tpr=0.4590 | fpr=0.8587 | 8369.6 samples/s | 32.7 steps/s
[Step= 550] | Loss=5.26884 | acc=0.1468 | tpr=0.4560 | fpr=0.8589 | 9034.6 samples/s | 35.3 steps/s
Avg test loss: 5.26965, Avg test acc: 0.14675, Avg tpr: 0.45681, Avg fpr: 0.85888, total FA: 119254

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.21658 | acc=0.9584 | tpr=0.9336 | fpr=0.0412 | 6107.0 samples/s | 23.9 steps/s
[Step= 100] | Loss=0.22480 | acc=0.9584 | tpr=0.9446 | fpr=0.0413 | 7941.3 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.22533 | acc=0.9569 | tpr=0.9409 | fpr=0.0428 | 7481.0 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.22602 | acc=0.9567 | tpr=0.9443 | fpr=0.0431 | 8025.4 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.22686 | acc=0.9567 | tpr=0.9424 | fpr=0.0431 | 7666.5 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.22989 | acc=0.9563 | tpr=0.9404 | fpr=0.0434 | 8408.8 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.22864 | acc=0.9565 | tpr=0.9405 | fpr=0.0432 | 7807.5 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.22839 | acc=0.9562 | tpr=0.9409 | fpr=0.0435 | 7887.6 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.23224 | acc=0.9557 | tpr=0.9396 | fpr=0.0440 | 8044.4 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.23224 | acc=0.9557 | tpr=0.9414 | fpr=0.0440 | 8214.9 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.23082 | acc=0.9561 | tpr=0.9423 | fpr=0.0437 | 10597.5 samples/s | 41.4 steps/s
Avg test loss: 0.23049, Avg test acc: 0.95607, Avg tpr: 0.94216, Avg fpr: 0.04367, total FA: 6064

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16715 | acc=0.9623 | tpr=0.9336 | fpr=0.0372 | 5849.8 samples/s | 22.9 steps/s
[Step= 100] | Loss=0.17522 | acc=0.9612 | tpr=0.9360 | fpr=0.0383 | 7447.0 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.17742 | acc=0.9599 | tpr=0.9352 | fpr=0.0397 | 8132.5 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.17758 | acc=0.9598 | tpr=0.9377 | fpr=0.0398 | 8006.9 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.17712 | acc=0.9599 | tpr=0.9380 | fpr=0.0397 | 8304.5 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.18003 | acc=0.9595 | tpr=0.9367 | fpr=0.0401 | 8413.6 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.17876 | acc=0.9596 | tpr=0.9361 | fpr=0.0400 | 8122.7 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.17935 | acc=0.9592 | tpr=0.9333 | fpr=0.0403 | 8039.8 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.18217 | acc=0.9587 | tpr=0.9323 | fpr=0.0409 | 8144.7 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.18169 | acc=0.9586 | tpr=0.9348 | fpr=0.0410 | 7989.2 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.18062 | acc=0.9589 | tpr=0.9363 | fpr=0.0407 | 9906.7 samples/s | 38.7 steps/s
Avg test loss: 0.18038, Avg test acc: 0.95889, Avg tpr: 0.93621, Avg fpr: 0.04070, total FA: 5651

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26662 | acc=0.9491 | tpr=0.9558 | fpr=0.0511 | 6098.7 samples/s | 23.8 steps/s
[Step= 100] | Loss=0.27413 | acc=0.9481 | tpr=0.9638 | fpr=0.0522 | 7116.8 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.27870 | acc=0.9470 | tpr=0.9625 | fpr=0.0533 | 8086.7 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.27858 | acc=0.9474 | tpr=0.9639 | fpr=0.0529 | 8643.4 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.27885 | acc=0.9472 | tpr=0.9633 | fpr=0.0531 | 8233.2 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.28173 | acc=0.9469 | tpr=0.9600 | fpr=0.0533 | 7976.6 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.27989 | acc=0.9471 | tpr=0.9593 | fpr=0.0531 | 8453.4 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.28028 | acc=0.9466 | tpr=0.9562 | fpr=0.0535 | 8186.1 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.28407 | acc=0.9463 | tpr=0.9542 | fpr=0.0538 | 7816.4 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.28464 | acc=0.9463 | tpr=0.9555 | fpr=0.0539 | 7737.5 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.28276 | acc=0.9466 | tpr=0.9562 | fpr=0.0536 | 9658.4 samples/s | 37.7 steps/s
Avg test loss: 0.28250, Avg test acc: 0.94658, Avg tpr: 0.95602, Avg fpr: 0.05359, total FA: 7441

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15515 | acc=0.9626 | tpr=0.9248 | fpr=0.0367 | 5974.8 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.16154 | acc=0.9617 | tpr=0.9339 | fpr=0.0378 | 7552.6 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.16303 | acc=0.9600 | tpr=0.9323 | fpr=0.0395 | 8032.4 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.16250 | acc=0.9603 | tpr=0.9399 | fpr=0.0394 | 8578.7 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.16175 | acc=0.9602 | tpr=0.9389 | fpr=0.0395 | 7855.8 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.16464 | acc=0.9599 | tpr=0.9360 | fpr=0.0397 | 8516.5 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.16353 | acc=0.9599 | tpr=0.9343 | fpr=0.0396 | 7951.2 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.16342 | acc=0.9596 | tpr=0.9316 | fpr=0.0399 | 8034.3 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.16583 | acc=0.9592 | tpr=0.9314 | fpr=0.0403 | 8101.6 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.16590 | acc=0.9592 | tpr=0.9326 | fpr=0.0403 | 7515.2 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.16484 | acc=0.9594 | tpr=0.9351 | fpr=0.0402 | 10252.0 samples/s | 40.0 steps/s
Avg test loss: 0.16460, Avg test acc: 0.95939, Avg tpr: 0.93502, Avg fpr: 0.04017, total FA: 5577

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.22131 | acc=0.9585 | tpr=0.9425 | fpr=0.0412 | 6026.5 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.23026 | acc=0.9568 | tpr=0.9510 | fpr=0.0431 | 7742.6 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.23285 | acc=0.9552 | tpr=0.9481 | fpr=0.0447 | 8007.5 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.23325 | acc=0.9550 | tpr=0.9519 | fpr=0.0449 | 8501.2 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.23382 | acc=0.9549 | tpr=0.9511 | fpr=0.0450 | 7380.7 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.23745 | acc=0.9544 | tpr=0.9476 | fpr=0.0455 | 8735.1 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.23638 | acc=0.9542 | tpr=0.9480 | fpr=0.0457 | 7902.3 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.23662 | acc=0.9539 | tpr=0.9447 | fpr=0.0459 | 7798.1 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.24004 | acc=0.9534 | tpr=0.9445 | fpr=0.0464 | 8317.5 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.23994 | acc=0.9533 | tpr=0.9449 | fpr=0.0465 | 7747.1 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.23833 | acc=0.9537 | tpr=0.9463 | fpr=0.0462 | 10470.0 samples/s | 40.9 steps/s
Avg test loss: 0.23809, Avg test acc: 0.95370, Avg tpr: 0.94612, Avg fpr: 0.04617, total FA: 6410

server round 38/50

clients selected: [0 1 2 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=165.8] | Loss=0.01920 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.012 | L2-Norm(final)=12.842 | 6939.5 samples/s | 108.4 steps/s
[Step=34050 Epoch=166.0] | Loss=0.02150 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=12.842 | 5001.2 samples/s | 78.1 steps/s
[Step=34100 Epoch=166.3] | Loss=0.02299 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.012 | L2-Norm(final)=12.839 | 5509.4 samples/s | 86.1 steps/s
[Step=34150 Epoch=166.5] | Loss=0.02286 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=12.833 | 5565.5 samples/s | 87.0 steps/s
[Step=34200 Epoch=166.8] | Loss=0.02275 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.012 | L2-Norm(final)=12.829 | 8696.0 samples/s | 135.9 steps/s
[Step=34250 Epoch=167.0] | Loss=0.02138 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.012 | L2-Norm(final)=12.827 | 2670.7 samples/s | 41.7 steps/s
[Step=34300 Epoch=167.3] | Loss=0.02221 | Reg=0.00100 | acc=0.9688 | L2-Norm=10.012 | L2-Norm(final)=12.826 | 5548.9 samples/s | 86.7 steps/s
[Step=34350 Epoch=167.5] | Loss=0.02171 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.012 | L2-Norm(final)=12.824 | 5845.2 samples/s | 91.3 steps/s
[Step=34400 Epoch=167.7] | Loss=0.02196 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.012 | L2-Norm(final)=12.823 | 7298.7 samples/s | 114.0 steps/s
[Step=34450 Epoch=168.0] | Loss=0.02142 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.012 | L2-Norm(final)=12.821 | 2848.3 samples/s | 44.5 steps/s
[Step=34500 Epoch=168.2] | Loss=0.02148 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=12.821 | 5465.3 samples/s | 85.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=168.2] | Loss=0.00767 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.012 | L2-Norm(final)=12.817 | 7650.9 samples/s | 119.5 steps/s
[Step=34550 Epoch=168.5] | Loss=0.02346 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.027 | L2-Norm(final)=12.818 | 4434.2 samples/s | 69.3 steps/s
[Step=34600 Epoch=168.7] | Loss=0.02113 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.044 | L2-Norm(final)=12.821 | 4790.0 samples/s | 74.8 steps/s
[Step=34650 Epoch=169.0] | Loss=0.01890 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.059 | L2-Norm(final)=12.825 | 4749.8 samples/s | 74.2 steps/s
[Step=34700 Epoch=169.2] | Loss=0.01716 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.074 | L2-Norm(final)=12.829 | 6819.8 samples/s | 106.6 steps/s
[Step=34750 Epoch=169.4] | Loss=0.01510 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.086 | L2-Norm(final)=12.833 | 2498.8 samples/s | 39.0 steps/s
[Step=34800 Epoch=169.7] | Loss=0.01376 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.097 | L2-Norm(final)=12.838 | 4789.5 samples/s | 74.8 steps/s
[Step=34850 Epoch=169.9] | Loss=0.01257 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.105 | L2-Norm(final)=12.843 | 4689.1 samples/s | 73.3 steps/s
[Step=34900 Epoch=170.2] | Loss=0.01178 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.113 | L2-Norm(final)=12.848 | 6230.6 samples/s | 97.4 steps/s
[Step=34950 Epoch=170.4] | Loss=0.01087 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.121 | L2-Norm(final)=12.852 | 2564.4 samples/s | 40.1 steps/s
[Step=35000 Epoch=170.7] | Loss=0.01015 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.127 | L2-Norm(final)=12.857 | 4811.2 samples/s | 75.2 steps/s
[Step=35050 Epoch=170.9] | Loss=0.00970 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=12.861 | 4763.1 samples/s | 74.4 steps/s
[Step=35100 Epoch=171.2] | Loss=0.00944 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.139 | L2-Norm(final)=12.865 | 5671.4 samples/s | 88.6 steps/s
[Step=35150 Epoch=171.4] | Loss=0.00894 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.144 | L2-Norm(final)=12.869 | 2677.0 samples/s | 41.8 steps/s
[Step=35200 Epoch=171.6] | Loss=0.00859 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.149 | L2-Norm(final)=12.873 | 4797.6 samples/s | 75.0 steps/s
[Step=35250 Epoch=171.9] | Loss=0.00848 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.154 | L2-Norm(final)=12.877 | 4789.2 samples/s | 74.8 steps/s
[Step=35300 Epoch=172.1] | Loss=0.00821 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.158 | L2-Norm(final)=12.880 | 5198.7 samples/s | 81.2 steps/s
[Step=35350 Epoch=172.4] | Loss=0.00795 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.163 | L2-Norm(final)=12.884 | 2772.0 samples/s | 43.3 steps/s
[Step=35400 Epoch=172.6] | Loss=0.00770 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.167 | L2-Norm(final)=12.887 | 4776.7 samples/s | 74.6 steps/s
[Step=35450 Epoch=172.9] | Loss=0.00750 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.171 | L2-Norm(final)=12.890 | 4749.6 samples/s | 74.2 steps/s
[Step=35500 Epoch=173.1] | Loss=0.00733 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.175 | L2-Norm(final)=12.893 | 4888.9 samples/s | 76.4 steps/s
[Step=35550 Epoch=173.3] | Loss=0.00714 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.179 | L2-Norm(final)=12.897 | 2943.2 samples/s | 46.0 steps/s
[Step=35600 Epoch=173.6] | Loss=0.00697 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.183 | L2-Norm(final)=12.900 | 4672.2 samples/s | 73.0 steps/s
[Step=35650 Epoch=173.8] | Loss=0.00676 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.186 | L2-Norm(final)=12.903 | 4800.4 samples/s | 75.0 steps/s
[Step=35700 Epoch=174.1] | Loss=0.00669 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.190 | L2-Norm(final)=12.906 | 4757.9 samples/s | 74.3 steps/s
[Step=35750 Epoch=174.3] | Loss=0.00659 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.193 | L2-Norm(final)=12.909 | 2901.6 samples/s | 45.3 steps/s
[Step=35800 Epoch=174.6] | Loss=0.00647 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.196 | L2-Norm(final)=12.912 | 4799.0 samples/s | 75.0 steps/s
[Step=35850 Epoch=174.8] | Loss=0.00638 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.199 | L2-Norm(final)=12.915 | 4709.0 samples/s | 73.6 steps/s
[Step=35900 Epoch=175.1] | Loss=0.00624 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.203 | L2-Norm(final)=12.918 | 4755.0 samples/s | 74.3 steps/s
[Step=35950 Epoch=175.3] | Loss=0.00614 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.206 | L2-Norm(final)=12.921 | 2965.3 samples/s | 46.3 steps/s
[Step=36000 Epoch=175.5] | Loss=0.00606 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.208 | L2-Norm(final)=12.923 | 4748.8 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step36000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=40001 Epoch=195.2] | Loss=0.01854 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.012 | L2-Norm(final)=14.628 | 6669.2 samples/s | 104.2 steps/s
[Step=40050 Epoch=195.4] | Loss=0.01572 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=14.626 | 5013.2 samples/s | 78.3 steps/s
[Step=40100 Epoch=195.7] | Loss=0.01639 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=14.629 | 5654.6 samples/s | 88.4 steps/s
[Step=40150 Epoch=195.9] | Loss=0.01709 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.012 | L2-Norm(final)=14.634 | 5498.9 samples/s | 85.9 steps/s
[Step=40200 Epoch=196.2] | Loss=0.01661 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=14.639 | 8598.2 samples/s | 134.3 steps/s
[Step=40250 Epoch=196.4] | Loss=0.01683 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.012 | L2-Norm(final)=14.641 | 2690.4 samples/s | 42.0 steps/s
[Step=40300 Epoch=196.6] | Loss=0.01648 | Reg=0.00100 | acc=0.9688 | L2-Norm=10.012 | L2-Norm(final)=14.644 | 5389.3 samples/s | 84.2 steps/s
[Step=40350 Epoch=196.9] | Loss=0.01666 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=14.647 | 5632.7 samples/s | 88.0 steps/s
[Step=40400 Epoch=197.1] | Loss=0.01646 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=14.650 | 7665.7 samples/s | 119.8 steps/s
[Step=40450 Epoch=197.4] | Loss=0.01634 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=14.654 | 2723.4 samples/s | 42.6 steps/s
[Step=40500 Epoch=197.6] | Loss=0.01658 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=14.658 | 5558.8 samples/s | 86.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=40501 Epoch=197.6] | Loss=0.00768 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=14.695 | 7145.5 samples/s | 111.6 steps/s
[Step=40550 Epoch=197.9] | Loss=0.02015 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.028 | L2-Norm(final)=14.696 | 4241.7 samples/s | 66.3 steps/s
[Step=40600 Epoch=198.1] | Loss=0.01752 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.049 | L2-Norm(final)=14.699 | 4780.5 samples/s | 74.7 steps/s
[Step=40650 Epoch=198.4] | Loss=0.01647 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.064 | L2-Norm(final)=14.702 | 4703.5 samples/s | 73.5 steps/s
[Step=40700 Epoch=198.6] | Loss=0.01528 | Reg=0.00102 | acc=0.9688 | L2-Norm=10.076 | L2-Norm(final)=14.705 | 6904.1 samples/s | 107.9 steps/s
[Step=40750 Epoch=198.8] | Loss=0.01322 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.087 | L2-Norm(final)=14.709 | 2452.2 samples/s | 38.3 steps/s
[Step=40800 Epoch=199.1] | Loss=0.01169 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.095 | L2-Norm(final)=14.713 | 4781.1 samples/s | 74.7 steps/s
[Step=40850 Epoch=199.3] | Loss=0.01089 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.103 | L2-Norm(final)=14.717 | 4728.0 samples/s | 73.9 steps/s
[Step=40900 Epoch=199.6] | Loss=0.01052 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.110 | L2-Norm(final)=14.721 | 6379.4 samples/s | 99.7 steps/s
[Step=40950 Epoch=199.8] | Loss=0.00978 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.117 | L2-Norm(final)=14.725 | 2541.3 samples/s | 39.7 steps/s
[Step=41000 Epoch=200.1] | Loss=0.00913 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.123 | L2-Norm(final)=14.728 | 4748.5 samples/s | 74.2 steps/s
[Step=41050 Epoch=200.3] | Loss=0.00880 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.128 | L2-Norm(final)=14.732 | 4775.4 samples/s | 74.6 steps/s
[Step=41100 Epoch=200.5] | Loss=0.00856 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=14.735 | 5911.0 samples/s | 92.4 steps/s
[Step=41150 Epoch=200.8] | Loss=0.00810 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.137 | L2-Norm(final)=14.738 | 2629.6 samples/s | 41.1 steps/s
[Step=41200 Epoch=201.0] | Loss=0.00778 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.141 | L2-Norm(final)=14.741 | 4800.9 samples/s | 75.0 steps/s
[Step=41250 Epoch=201.3] | Loss=0.00746 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.145 | L2-Norm(final)=14.744 | 4848.8 samples/s | 75.8 steps/s
[Step=41300 Epoch=201.5] | Loss=0.00717 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.149 | L2-Norm(final)=14.747 | 5353.3 samples/s | 83.6 steps/s
[Step=41350 Epoch=201.8] | Loss=0.00695 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.152 | L2-Norm(final)=14.750 | 2693.8 samples/s | 42.1 steps/s
[Step=41400 Epoch=202.0] | Loss=0.00675 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.155 | L2-Norm(final)=14.753 | 4853.9 samples/s | 75.8 steps/s
[Step=41450 Epoch=202.3] | Loss=0.00653 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.158 | L2-Norm(final)=14.755 | 4701.8 samples/s | 73.5 steps/s
[Step=41500 Epoch=202.5] | Loss=0.00634 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=14.758 | 5168.6 samples/s | 80.8 steps/s
[Step=41550 Epoch=202.7] | Loss=0.00618 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.164 | L2-Norm(final)=14.761 | 2804.8 samples/s | 43.8 steps/s
[Step=41600 Epoch=203.0] | Loss=0.00598 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.167 | L2-Norm(final)=14.763 | 4791.9 samples/s | 74.9 steps/s
[Step=41650 Epoch=203.2] | Loss=0.00585 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.170 | L2-Norm(final)=14.766 | 4739.8 samples/s | 74.1 steps/s
[Step=41700 Epoch=203.5] | Loss=0.00572 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.172 | L2-Norm(final)=14.768 | 4826.4 samples/s | 75.4 steps/s
[Step=41750 Epoch=203.7] | Loss=0.00561 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.175 | L2-Norm(final)=14.771 | 2901.2 samples/s | 45.3 steps/s
[Step=41800 Epoch=204.0] | Loss=0.00547 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.177 | L2-Norm(final)=14.773 | 4695.4 samples/s | 73.4 steps/s
[Step=41850 Epoch=204.2] | Loss=0.00534 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.180 | L2-Norm(final)=14.776 | 4760.7 samples/s | 74.4 steps/s
[Step=41900 Epoch=204.5] | Loss=0.00522 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.182 | L2-Norm(final)=14.778 | 4736.7 samples/s | 74.0 steps/s
[Step=41950 Epoch=204.7] | Loss=0.00517 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.184 | L2-Norm(final)=14.780 | 2940.7 samples/s | 45.9 steps/s
[Step=42000 Epoch=204.9] | Loss=0.00509 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.186 | L2-Norm(final)=14.783 | 4692.1 samples/s | 73.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step42000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=40001 Epoch=194.9] | Loss=0.00389 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=13.759 | 6929.7 samples/s | 108.3 steps/s
[Step=40050 Epoch=195.1] | Loss=0.01928 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=13.759 | 5078.4 samples/s | 79.4 steps/s
[Step=40100 Epoch=195.4] | Loss=0.01991 | Reg=0.00100 | acc=0.9688 | L2-Norm=10.012 | L2-Norm(final)=13.754 | 5481.0 samples/s | 85.6 steps/s
[Step=40150 Epoch=195.6] | Loss=0.01900 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=13.748 | 5534.7 samples/s | 86.5 steps/s
[Step=40200 Epoch=195.9] | Loss=0.01861 | Reg=0.00100 | acc=0.9531 | L2-Norm=10.012 | L2-Norm(final)=13.746 | 8693.8 samples/s | 135.8 steps/s
[Step=40250 Epoch=196.1] | Loss=0.01889 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=13.744 | 2662.8 samples/s | 41.6 steps/s
[Step=40300 Epoch=196.4] | Loss=0.01846 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.012 | L2-Norm(final)=13.742 | 5563.8 samples/s | 86.9 steps/s
[Step=40350 Epoch=196.6] | Loss=0.01816 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.012 | L2-Norm(final)=13.742 | 5669.8 samples/s | 88.6 steps/s
[Step=40400 Epoch=196.8] | Loss=0.01799 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.012 | L2-Norm(final)=13.742 | 7399.5 samples/s | 115.6 steps/s
[Step=40450 Epoch=197.1] | Loss=0.01774 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=13.742 | 2802.2 samples/s | 43.8 steps/s
[Step=40500 Epoch=197.3] | Loss=0.01772 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=13.744 | 5478.3 samples/s | 85.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=40501 Epoch=197.3] | Loss=0.00462 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=13.757 | 6691.1 samples/s | 104.5 steps/s
[Step=40550 Epoch=197.6] | Loss=0.01889 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.026 | L2-Norm(final)=13.759 | 4476.6 samples/s | 69.9 steps/s
[Step=40600 Epoch=197.8] | Loss=0.01703 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.042 | L2-Norm(final)=13.762 | 4775.4 samples/s | 74.6 steps/s
[Step=40650 Epoch=198.1] | Loss=0.01628 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.055 | L2-Norm(final)=13.765 | 4757.8 samples/s | 74.3 steps/s
[Step=40700 Epoch=198.3] | Loss=0.01584 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.066 | L2-Norm(final)=13.768 | 6870.8 samples/s | 107.4 steps/s
[Step=40750 Epoch=198.6] | Loss=0.01391 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.076 | L2-Norm(final)=13.772 | 2503.6 samples/s | 39.1 steps/s
[Step=40800 Epoch=198.8] | Loss=0.01249 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.084 | L2-Norm(final)=13.776 | 4716.0 samples/s | 73.7 steps/s
[Step=40850 Epoch=199.0] | Loss=0.01164 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.092 | L2-Norm(final)=13.780 | 4790.7 samples/s | 74.9 steps/s
[Step=40900 Epoch=199.3] | Loss=0.01118 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.099 | L2-Norm(final)=13.785 | 6174.3 samples/s | 96.5 steps/s
[Step=40950 Epoch=199.5] | Loss=0.01065 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.106 | L2-Norm(final)=13.788 | 2584.6 samples/s | 40.4 steps/s
[Step=41000 Epoch=199.8] | Loss=0.01017 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.112 | L2-Norm(final)=13.792 | 4725.0 samples/s | 73.8 steps/s
[Step=41050 Epoch=200.0] | Loss=0.00971 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.118 | L2-Norm(final)=13.795 | 4822.6 samples/s | 75.4 steps/s
[Step=41100 Epoch=200.3] | Loss=0.00931 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.123 | L2-Norm(final)=13.798 | 5603.4 samples/s | 87.6 steps/s
[Step=41150 Epoch=200.5] | Loss=0.00888 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.128 | L2-Norm(final)=13.802 | 2694.3 samples/s | 42.1 steps/s
[Step=41200 Epoch=200.7] | Loss=0.00859 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.133 | L2-Norm(final)=13.805 | 4713.4 samples/s | 73.6 steps/s
[Step=41250 Epoch=201.0] | Loss=0.00835 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.137 | L2-Norm(final)=13.808 | 4744.9 samples/s | 74.1 steps/s
[Step=41300 Epoch=201.2] | Loss=0.00800 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.141 | L2-Norm(final)=13.811 | 5263.2 samples/s | 82.2 steps/s
[Step=41350 Epoch=201.5] | Loss=0.00768 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.145 | L2-Norm(final)=13.814 | 2766.6 samples/s | 43.2 steps/s
[Step=41400 Epoch=201.7] | Loss=0.00744 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.149 | L2-Norm(final)=13.817 | 4782.9 samples/s | 74.7 steps/s
[Step=41450 Epoch=202.0] | Loss=0.00723 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.153 | L2-Norm(final)=13.820 | 4779.6 samples/s | 74.7 steps/s
[Step=41500 Epoch=202.2] | Loss=0.00703 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.156 | L2-Norm(final)=13.823 | 4861.9 samples/s | 76.0 steps/s
[Step=41550 Epoch=202.5] | Loss=0.00689 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.159 | L2-Norm(final)=13.826 | 2902.3 samples/s | 45.3 steps/s
[Step=41600 Epoch=202.7] | Loss=0.00674 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.163 | L2-Norm(final)=13.829 | 4742.4 samples/s | 74.1 steps/s
[Step=41650 Epoch=202.9] | Loss=0.00664 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.166 | L2-Norm(final)=13.832 | 4750.6 samples/s | 74.2 steps/s
[Step=41700 Epoch=203.2] | Loss=0.00659 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.169 | L2-Norm(final)=13.834 | 4780.7 samples/s | 74.7 steps/s
[Step=41750 Epoch=203.4] | Loss=0.00646 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.172 | L2-Norm(final)=13.837 | 2926.4 samples/s | 45.7 steps/s
[Step=41800 Epoch=203.7] | Loss=0.00628 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.175 | L2-Norm(final)=13.840 | 4764.6 samples/s | 74.4 steps/s
[Step=41850 Epoch=203.9] | Loss=0.00615 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.178 | L2-Norm(final)=13.842 | 4757.7 samples/s | 74.3 steps/s
[Step=41900 Epoch=204.2] | Loss=0.00614 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.181 | L2-Norm(final)=13.844 | 4792.9 samples/s | 74.9 steps/s
[Step=41950 Epoch=204.4] | Loss=0.00602 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.183 | L2-Norm(final)=13.847 | 2921.5 samples/s | 45.6 steps/s
[Step=42000 Epoch=204.6] | Loss=0.00588 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.186 | L2-Norm(final)=13.849 | 4749.5 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step42000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=38001 Epoch=358.1] | Loss=0.00015 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=15.772 | 7112.5 samples/s | 111.1 steps/s
[Step=38050 Epoch=358.5] | Loss=0.00055 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=15.774 | 4371.3 samples/s | 68.3 steps/s
[Step=38100 Epoch=359.0] | Loss=0.00048 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=15.778 | 8285.6 samples/s | 129.5 steps/s
[Step=38150 Epoch=359.5] | Loss=0.00046 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=15.780 | 2583.4 samples/s | 40.4 steps/s
[Step=38200 Epoch=360.0] | Loss=0.00048 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=15.784 | 7143.0 samples/s | 111.6 steps/s
[Step=38250 Epoch=360.4] | Loss=0.00045 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=15.787 | 2725.2 samples/s | 42.6 steps/s
[Step=38300 Epoch=360.9] | Loss=0.00046 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=15.791 | 6264.5 samples/s | 97.9 steps/s
[Step=38350 Epoch=361.4] | Loss=0.00047 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=15.795 | 2915.2 samples/s | 45.5 steps/s
[Step=38400 Epoch=361.8] | Loss=0.00045 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=15.800 | 5439.1 samples/s | 85.0 steps/s
[Step=38450 Epoch=362.3] | Loss=0.00045 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=15.804 | 3031.7 samples/s | 47.4 steps/s
[Step=38500 Epoch=362.8] | Loss=0.00046 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=15.808 | 5284.9 samples/s | 82.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=362.8] | Loss=0.00009 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=15.855 | 6545.3 samples/s | 102.3 steps/s
[Step=38550 Epoch=363.3] | Loss=0.00191 | Reg=0.00100 | acc=0.9688 | L2-Norm=10.022 | L2-Norm(final)=15.857 | 4187.7 samples/s | 65.4 steps/s
[Step=38600 Epoch=363.7] | Loss=0.00124 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.037 | L2-Norm(final)=15.854 | 6446.8 samples/s | 100.7 steps/s
[Step=38650 Epoch=364.2] | Loss=0.00084 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.044 | L2-Norm(final)=15.854 | 2397.2 samples/s | 37.5 steps/s
[Step=38700 Epoch=364.7] | Loss=0.00063 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.046 | L2-Norm(final)=15.854 | 5829.1 samples/s | 91.1 steps/s
[Step=38750 Epoch=365.1] | Loss=0.00051 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.047 | L2-Norm(final)=15.854 | 2528.5 samples/s | 39.5 steps/s
[Step=38800 Epoch=365.6] | Loss=0.00043 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.046 | L2-Norm(final)=15.854 | 5214.4 samples/s | 81.5 steps/s
[Step=38850 Epoch=366.1] | Loss=0.00037 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.045 | L2-Norm(final)=15.855 | 2630.6 samples/s | 41.1 steps/s
[Step=38900 Epoch=366.5] | Loss=0.00032 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.044 | L2-Norm(final)=15.855 | 4765.2 samples/s | 74.5 steps/s
[Step=38950 Epoch=367.0] | Loss=0.00029 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.043 | L2-Norm(final)=15.856 | 2739.9 samples/s | 42.8 steps/s
[Step=39000 Epoch=367.5] | Loss=0.00026 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.041 | L2-Norm(final)=15.856 | 4496.9 samples/s | 70.3 steps/s
[Step=39050 Epoch=368.0] | Loss=0.00024 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.039 | L2-Norm(final)=15.856 | 2856.0 samples/s | 44.6 steps/s
[Step=39100 Epoch=368.4] | Loss=0.00022 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.037 | L2-Norm(final)=15.857 | 4518.7 samples/s | 70.6 steps/s
[Step=39150 Epoch=368.9] | Loss=0.00020 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.035 | L2-Norm(final)=15.857 | 2839.7 samples/s | 44.4 steps/s
[Step=39200 Epoch=369.4] | Loss=0.00019 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.033 | L2-Norm(final)=15.858 | 4539.5 samples/s | 70.9 steps/s
[Step=39250 Epoch=369.8] | Loss=0.00018 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.031 | L2-Norm(final)=15.858 | 3156.7 samples/s | 49.3 steps/s
[Step=39300 Epoch=370.3] | Loss=0.00017 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.029 | L2-Norm(final)=15.858 | 4013.3 samples/s | 62.7 steps/s
[Step=39350 Epoch=370.8] | Loss=0.00016 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.027 | L2-Norm(final)=15.859 | 6481.1 samples/s | 101.3 steps/s
[Step=39400 Epoch=371.3] | Loss=0.00015 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=15.859 | 2389.6 samples/s | 37.3 steps/s
[Step=39450 Epoch=371.7] | Loss=0.00014 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=15.859 | 5915.7 samples/s | 92.4 steps/s
[Step=39500 Epoch=372.2] | Loss=0.00013 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.020 | L2-Norm(final)=15.860 | 2501.9 samples/s | 39.1 steps/s
[Step=39550 Epoch=372.7] | Loss=0.00013 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.018 | L2-Norm(final)=15.860 | 5314.2 samples/s | 83.0 steps/s
[Step=39600 Epoch=373.1] | Loss=0.00012 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.016 | L2-Norm(final)=15.861 | 2635.8 samples/s | 41.2 steps/s
[Step=39650 Epoch=373.6] | Loss=0.00012 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.013 | L2-Norm(final)=15.861 | 4723.0 samples/s | 73.8 steps/s
[Step=39700 Epoch=374.1] | Loss=0.00011 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=15.861 | 2770.4 samples/s | 43.3 steps/s
[Step=39750 Epoch=374.6] | Loss=0.00011 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.008 | L2-Norm(final)=15.862 | 4550.4 samples/s | 71.1 steps/s
[Step=39800 Epoch=375.0] | Loss=0.00010 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.006 | L2-Norm(final)=15.862 | 2857.0 samples/s | 44.6 steps/s
[Step=39850 Epoch=375.5] | Loss=0.00010 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.003 | L2-Norm(final)=15.862 | 4525.3 samples/s | 70.7 steps/s
[Step=39900 Epoch=376.0] | Loss=0.00010 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.001 | L2-Norm(final)=15.863 | 2853.4 samples/s | 44.6 steps/s
[Step=39950 Epoch=376.4] | Loss=0.00009 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.998 | L2-Norm(final)=15.863 | 4503.1 samples/s | 70.4 steps/s
[Step=40000 Epoch=376.9] | Loss=0.00009 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.995 | L2-Norm(final)=15.864 | 3021.0 samples/s | 47.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step40000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=40001 Epoch=381.2] | Loss=0.00022 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=16.699 | 6023.0 samples/s | 94.1 steps/s
[Step=40050 Epoch=381.7] | Loss=0.00157 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=16.706 | 4909.8 samples/s | 76.7 steps/s
[Step=40100 Epoch=382.2] | Loss=0.00155 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=16.715 | 8000.8 samples/s | 125.0 steps/s
[Step=40150 Epoch=382.7] | Loss=0.00168 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=16.726 | 2552.1 samples/s | 39.9 steps/s
[Step=40200 Epoch=383.1] | Loss=0.00155 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=16.736 | 7482.8 samples/s | 116.9 steps/s
[Step=40250 Epoch=383.6] | Loss=0.00152 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=16.745 | 2655.4 samples/s | 41.5 steps/s
[Step=40300 Epoch=384.1] | Loss=0.00150 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=16.754 | 6821.7 samples/s | 106.6 steps/s
[Step=40350 Epoch=384.6] | Loss=0.00155 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.009 | L2-Norm(final)=16.763 | 2725.4 samples/s | 42.6 steps/s
[Step=40400 Epoch=385.0] | Loss=0.00154 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.009 | L2-Norm(final)=16.771 | 6335.1 samples/s | 99.0 steps/s
[Step=40450 Epoch=385.5] | Loss=0.00153 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.009 | L2-Norm(final)=16.779 | 2883.6 samples/s | 45.1 steps/s
[Step=40500 Epoch=386.0] | Loss=0.00154 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.009 | L2-Norm(final)=16.787 | 5684.9 samples/s | 88.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=40501 Epoch=386.0] | Loss=0.00016 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.009 | L2-Norm(final)=16.866 | 7713.8 samples/s | 120.5 steps/s
[Step=40550 Epoch=386.5] | Loss=0.00138 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.042 | L2-Norm(final)=16.868 | 3796.2 samples/s | 59.3 steps/s
[Step=40600 Epoch=387.0] | Loss=0.00082 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.060 | L2-Norm(final)=16.869 | 6726.4 samples/s | 105.1 steps/s
[Step=40650 Epoch=387.4] | Loss=0.00055 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=16.869 | 2363.6 samples/s | 36.9 steps/s
[Step=40700 Epoch=387.9] | Loss=0.00042 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.068 | L2-Norm(final)=16.870 | 6130.1 samples/s | 95.8 steps/s
[Step=40750 Epoch=388.4] | Loss=0.00034 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.068 | L2-Norm(final)=16.871 | 2426.7 samples/s | 37.9 steps/s
[Step=40800 Epoch=388.9] | Loss=0.00029 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.066 | L2-Norm(final)=16.871 | 5695.4 samples/s | 89.0 steps/s
[Step=40850 Epoch=389.3] | Loss=0.00025 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.064 | L2-Norm(final)=16.871 | 2545.0 samples/s | 39.8 steps/s
[Step=40900 Epoch=389.8] | Loss=0.00022 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.062 | L2-Norm(final)=16.872 | 5212.6 samples/s | 81.4 steps/s
[Step=40950 Epoch=390.3] | Loss=0.00019 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.059 | L2-Norm(final)=16.872 | 2613.8 samples/s | 40.8 steps/s
[Step=41000 Epoch=390.8] | Loss=0.00017 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.056 | L2-Norm(final)=16.872 | 4942.3 samples/s | 77.2 steps/s
[Step=41050 Epoch=391.2] | Loss=0.00016 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.052 | L2-Norm(final)=16.873 | 2700.6 samples/s | 42.2 steps/s
[Step=41100 Epoch=391.7] | Loss=0.00015 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.049 | L2-Norm(final)=16.873 | 4640.6 samples/s | 72.5 steps/s
[Step=41150 Epoch=392.2] | Loss=0.00014 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.045 | L2-Norm(final)=16.873 | 2837.6 samples/s | 44.3 steps/s
[Step=41200 Epoch=392.7] | Loss=0.00013 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.042 | L2-Norm(final)=16.873 | 4485.6 samples/s | 70.1 steps/s
[Step=41250 Epoch=393.1] | Loss=0.00012 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.038 | L2-Norm(final)=16.873 | 2150.4 samples/s | 33.6 steps/s
[Step=41300 Epoch=393.6] | Loss=0.00011 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.034 | L2-Norm(final)=16.874 | 4332.3 samples/s | 67.7 steps/s
[Step=41350 Epoch=394.1] | Loss=0.00010 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.030 | L2-Norm(final)=16.874 | 2794.6 samples/s | 43.7 steps/s
[Step=41400 Epoch=394.6] | Loss=0.00010 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.026 | L2-Norm(final)=16.874 | 4540.1 samples/s | 70.9 steps/s
[Step=41450 Epoch=395.1] | Loss=0.00009 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=16.874 | 2828.9 samples/s | 44.2 steps/s
[Step=41500 Epoch=395.5] | Loss=0.00009 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.018 | L2-Norm(final)=16.874 | 4578.9 samples/s | 71.5 steps/s
[Step=41550 Epoch=396.0] | Loss=0.00009 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=16.875 | 7125.5 samples/s | 111.3 steps/s
[Step=41600 Epoch=396.5] | Loss=0.00008 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=16.875 | 2315.1 samples/s | 36.2 steps/s
[Step=41650 Epoch=397.0] | Loss=0.00008 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.006 | L2-Norm(final)=16.875 | 6549.7 samples/s | 102.3 steps/s
[Step=41700 Epoch=397.4] | Loss=0.00008 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.002 | L2-Norm(final)=16.875 | 2390.8 samples/s | 37.4 steps/s
[Step=41750 Epoch=397.9] | Loss=0.00007 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.998 | L2-Norm(final)=16.875 | 5932.7 samples/s | 92.7 steps/s
[Step=41800 Epoch=398.4] | Loss=0.00007 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.993 | L2-Norm(final)=16.875 | 2448.1 samples/s | 38.3 steps/s
[Step=41850 Epoch=398.9] | Loss=0.00007 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.989 | L2-Norm(final)=16.876 | 5641.6 samples/s | 88.1 steps/s
[Step=41900 Epoch=399.3] | Loss=0.00007 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.984 | L2-Norm(final)=16.876 | 2539.6 samples/s | 39.7 steps/s
[Step=41950 Epoch=399.8] | Loss=0.00006 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.980 | L2-Norm(final)=16.876 | 5297.9 samples/s | 82.8 steps/s
[Step=42000 Epoch=400.3] | Loss=0.00006 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.975 | L2-Norm(final)=16.876 | 2611.3 samples/s | 40.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step42000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08348 | acc=0.9630 | tpr=0.9815 | fpr=0.0773 | 5628.0 samples/s | 22.0 steps/s
Avg test loss: 0.08858, Avg test acc: 0.96033, Avg tpr: 0.97966, Avg fpr: 0.08217, total FA: 641

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08800 | acc=0.9621 | tpr=0.9712 | fpr=0.0577 | 5924.8 samples/s | 23.1 steps/s
Avg test loss: 0.09252, Avg test acc: 0.96077, Avg tpr: 0.96876, Avg fpr: 0.05679, total FA: 443

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08845 | acc=0.9627 | tpr=0.9760 | fpr=0.0662 | 5980.1 samples/s | 23.4 steps/s
Avg test loss: 0.09188, Avg test acc: 0.96138, Avg tpr: 0.97342, Avg fpr: 0.06512, total FA: 508

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08775 | acc=0.9619 | tpr=0.9754 | fpr=0.0674 | 5855.2 samples/s | 22.9 steps/s
Avg test loss: 0.09303, Avg test acc: 0.96069, Avg tpr: 0.97395, Avg fpr: 0.06845, total FA: 534

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09383 | acc=0.9627 | tpr=0.9690 | fpr=0.0508 | 5755.5 samples/s | 22.5 steps/s
Avg test loss: 0.09787, Avg test acc: 0.96146, Avg tpr: 0.96649, Avg fpr: 0.04961, total FA: 387

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.81640 | acc=0.2913 | tpr=0.0143 | fpr=0.1070 | 5769.4 samples/s | 22.5 steps/s
Avg test loss: 6.82868, Avg test acc: 0.28897, Avg tpr: 0.01399, Avg fpr: 0.10627, total FA: 829

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.71258 | acc=0.3064 | tpr=0.0319 | fpr=0.0976 | 5928.8 samples/s | 23.2 steps/s
Avg test loss: 4.72212, Avg test acc: 0.30399, Avg tpr: 0.03130, Avg fpr: 0.09627, total FA: 751

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.04505 | acc=0.2930 | tpr=0.0210 | fpr=0.1162 | 5883.9 samples/s | 23.0 steps/s
Avg test loss: 5.05229, Avg test acc: 0.29089, Avg tpr: 0.01976, Avg fpr: 0.11281, total FA: 880

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.09536 | acc=0.2791 | tpr=0.0215 | fpr=0.1613 | 6188.3 samples/s | 24.2 steps/s
Avg test loss: 5.10295, Avg test acc: 0.27767, Avg tpr: 0.02017, Avg fpr: 0.15601, total FA: 1217

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.70946 | acc=0.3033 | tpr=0.0194 | fpr=0.0803 | 6095.6 samples/s | 23.8 steps/s
Avg test loss: 4.73245, Avg test acc: 0.30058, Avg tpr: 0.01801, Avg fpr: 0.07794, total FA: 608

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.40640 | acc=0.1163 | tpr=0.6681 | fpr=0.8936 | 6135.1 samples/s | 24.0 steps/s
[Step= 100] | Loss=5.38996 | acc=0.1185 | tpr=0.6567 | fpr=0.8916 | 7887.0 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.38087 | acc=0.1204 | tpr=0.6686 | fpr=0.8896 | 7861.9 samples/s | 30.7 steps/s
[Step= 200] | Loss=5.36999 | acc=0.1208 | tpr=0.6656 | fpr=0.8892 | 8205.1 samples/s | 32.1 steps/s
[Step= 250] | Loss=5.37494 | acc=0.1206 | tpr=0.6585 | fpr=0.8892 | 7867.7 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.36849 | acc=0.1209 | tpr=0.6596 | fpr=0.8889 | 8278.3 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.37403 | acc=0.1208 | tpr=0.6587 | fpr=0.8889 | 7620.2 samples/s | 29.8 steps/s
[Step= 400] | Loss=5.37129 | acc=0.1212 | tpr=0.6543 | fpr=0.8885 | 8159.9 samples/s | 31.9 steps/s
[Step= 450] | Loss=5.37658 | acc=0.1208 | tpr=0.6563 | fpr=0.8889 | 8358.4 samples/s | 32.6 steps/s
[Step= 500] | Loss=5.37671 | acc=0.1206 | tpr=0.6590 | fpr=0.8891 | 8126.1 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.37954 | acc=0.1208 | tpr=0.6626 | fpr=0.8890 | 9484.6 samples/s | 37.0 steps/s
Avg test loss: 5.37976, Avg test acc: 0.12075, Avg tpr: 0.66363, Avg fpr: 0.88912, total FA: 123453

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.64583 | acc=0.1472 | tpr=0.5619 | fpr=0.8603 | 5870.3 samples/s | 22.9 steps/s
[Step= 100] | Loss=4.63291 | acc=0.1520 | tpr=0.5672 | fpr=0.8558 | 7682.1 samples/s | 30.0 steps/s
[Step= 150] | Loss=4.62202 | acc=0.1548 | tpr=0.5893 | fpr=0.8532 | 7661.1 samples/s | 29.9 steps/s
[Step= 200] | Loss=4.61378 | acc=0.1555 | tpr=0.5880 | fpr=0.8524 | 8099.2 samples/s | 31.6 steps/s
[Step= 250] | Loss=4.61723 | acc=0.1553 | tpr=0.5808 | fpr=0.8524 | 8152.2 samples/s | 31.8 steps/s
[Step= 300] | Loss=4.61335 | acc=0.1549 | tpr=0.5745 | fpr=0.8528 | 8147.8 samples/s | 31.8 steps/s
[Step= 350] | Loss=4.61791 | acc=0.1548 | tpr=0.5686 | fpr=0.8527 | 8156.0 samples/s | 31.9 steps/s
[Step= 400] | Loss=4.61598 | acc=0.1549 | tpr=0.5689 | fpr=0.8526 | 7150.2 samples/s | 27.9 steps/s
[Step= 450] | Loss=4.61949 | acc=0.1546 | tpr=0.5755 | fpr=0.8531 | 8383.5 samples/s | 32.7 steps/s
[Step= 500] | Loss=4.62059 | acc=0.1544 | tpr=0.5784 | fpr=0.8533 | 7956.7 samples/s | 31.1 steps/s
[Step= 550] | Loss=4.62381 | acc=0.1544 | tpr=0.5790 | fpr=0.8533 | 12582.5 samples/s | 49.2 steps/s
Avg test loss: 4.62390, Avg test acc: 0.15435, Avg tpr: 0.57964, Avg fpr: 0.85338, total FA: 118490

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.08812 | acc=0.1222 | tpr=0.6372 | fpr=0.8871 | 6079.0 samples/s | 23.7 steps/s
[Step= 100] | Loss=5.07512 | acc=0.1232 | tpr=0.6311 | fpr=0.8862 | 7704.3 samples/s | 30.1 steps/s
[Step= 150] | Loss=5.06669 | acc=0.1251 | tpr=0.6427 | fpr=0.8845 | 7751.1 samples/s | 30.3 steps/s
[Step= 200] | Loss=5.05929 | acc=0.1254 | tpr=0.6295 | fpr=0.8838 | 8680.2 samples/s | 33.9 steps/s
[Step= 250] | Loss=5.06489 | acc=0.1256 | tpr=0.6279 | fpr=0.8836 | 8195.4 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.06078 | acc=0.1253 | tpr=0.6240 | fpr=0.8838 | 7694.7 samples/s | 30.1 steps/s
[Step= 350] | Loss=5.06640 | acc=0.1252 | tpr=0.6224 | fpr=0.8838 | 7977.6 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.06597 | acc=0.1254 | tpr=0.6209 | fpr=0.8836 | 7638.3 samples/s | 29.8 steps/s
[Step= 450] | Loss=5.07105 | acc=0.1246 | tpr=0.6212 | fpr=0.8844 | 8264.6 samples/s | 32.3 steps/s
[Step= 500] | Loss=5.07061 | acc=0.1244 | tpr=0.6198 | fpr=0.8846 | 8368.2 samples/s | 32.7 steps/s
[Step= 550] | Loss=5.07329 | acc=0.1245 | tpr=0.6204 | fpr=0.8846 | 10322.3 samples/s | 40.3 steps/s
Avg test loss: 5.07370, Avg test acc: 0.12439, Avg tpr: 0.62163, Avg fpr: 0.88465, total FA: 122832

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.96585 | acc=0.1342 | tpr=0.6637 | fpr=0.8753 | 5836.2 samples/s | 22.8 steps/s
[Step= 100] | Loss=4.95726 | acc=0.1376 | tpr=0.6503 | fpr=0.8720 | 8240.7 samples/s | 32.2 steps/s
[Step= 150] | Loss=4.94590 | acc=0.1394 | tpr=0.6585 | fpr=0.8702 | 7997.4 samples/s | 31.2 steps/s
[Step= 200] | Loss=4.93632 | acc=0.1401 | tpr=0.6590 | fpr=0.8694 | 7961.1 samples/s | 31.1 steps/s
[Step= 250] | Loss=4.93840 | acc=0.1397 | tpr=0.6515 | fpr=0.8696 | 7783.1 samples/s | 30.4 steps/s
[Step= 300] | Loss=4.93465 | acc=0.1392 | tpr=0.6509 | fpr=0.8701 | 8395.5 samples/s | 32.8 steps/s
[Step= 350] | Loss=4.94029 | acc=0.1389 | tpr=0.6500 | fpr=0.8704 | 8104.0 samples/s | 31.7 steps/s
[Step= 400] | Loss=4.93911 | acc=0.1394 | tpr=0.6472 | fpr=0.8698 | 7911.8 samples/s | 30.9 steps/s
[Step= 450] | Loss=4.94419 | acc=0.1386 | tpr=0.6509 | fpr=0.8707 | 8294.9 samples/s | 32.4 steps/s
[Step= 500] | Loss=4.94339 | acc=0.1385 | tpr=0.6533 | fpr=0.8708 | 8164.2 samples/s | 31.9 steps/s
[Step= 550] | Loss=4.94766 | acc=0.1383 | tpr=0.6538 | fpr=0.8710 | 9603.1 samples/s | 37.5 steps/s
Avg test loss: 4.94828, Avg test acc: 0.13826, Avg tpr: 0.65491, Avg fpr: 0.87113, total FA: 120955

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.28901 | acc=0.1422 | tpr=0.4690 | fpr=0.8637 | 5824.4 samples/s | 22.8 steps/s
[Step= 100] | Loss=5.27488 | acc=0.1442 | tpr=0.4584 | fpr=0.8616 | 8134.4 samples/s | 31.8 steps/s
[Step= 150] | Loss=5.26396 | acc=0.1466 | tpr=0.4683 | fpr=0.8593 | 7871.7 samples/s | 30.7 steps/s
[Step= 200] | Loss=5.25822 | acc=0.1473 | tpr=0.4689 | fpr=0.8585 | 7956.3 samples/s | 31.1 steps/s
[Step= 250] | Loss=5.26212 | acc=0.1474 | tpr=0.4611 | fpr=0.8583 | 8124.9 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.25817 | acc=0.1470 | tpr=0.4545 | fpr=0.8586 | 7682.3 samples/s | 30.0 steps/s
[Step= 350] | Loss=5.26509 | acc=0.1471 | tpr=0.4546 | fpr=0.8585 | 8363.3 samples/s | 32.7 steps/s
[Step= 400] | Loss=5.26113 | acc=0.1473 | tpr=0.4546 | fpr=0.8583 | 7422.2 samples/s | 29.0 steps/s
[Step= 450] | Loss=5.26571 | acc=0.1467 | tpr=0.4581 | fpr=0.8589 | 8058.0 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.26569 | acc=0.1469 | tpr=0.4590 | fpr=0.8587 | 8322.7 samples/s | 32.5 steps/s
[Step= 550] | Loss=5.26884 | acc=0.1468 | tpr=0.4560 | fpr=0.8589 | 11139.3 samples/s | 43.5 steps/s
Avg test loss: 5.26965, Avg test acc: 0.14675, Avg tpr: 0.45681, Avg fpr: 0.85888, total FA: 119254

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.21658 | acc=0.9584 | tpr=0.9336 | fpr=0.0412 | 5826.0 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.22480 | acc=0.9584 | tpr=0.9446 | fpr=0.0413 | 7967.9 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.22533 | acc=0.9569 | tpr=0.9409 | fpr=0.0428 | 8063.1 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.22602 | acc=0.9567 | tpr=0.9443 | fpr=0.0431 | 8582.2 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.22686 | acc=0.9567 | tpr=0.9424 | fpr=0.0431 | 8051.8 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.22989 | acc=0.9563 | tpr=0.9404 | fpr=0.0434 | 7521.0 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.22864 | acc=0.9565 | tpr=0.9405 | fpr=0.0432 | 8449.5 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.22839 | acc=0.9562 | tpr=0.9409 | fpr=0.0435 | 7864.9 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.23224 | acc=0.9557 | tpr=0.9396 | fpr=0.0440 | 7750.1 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.23224 | acc=0.9557 | tpr=0.9414 | fpr=0.0440 | 8754.6 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.23082 | acc=0.9561 | tpr=0.9423 | fpr=0.0437 | 9651.4 samples/s | 37.7 steps/s
Avg test loss: 0.23049, Avg test acc: 0.95607, Avg tpr: 0.94216, Avg fpr: 0.04367, total FA: 6064

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16715 | acc=0.9623 | tpr=0.9336 | fpr=0.0372 | 6114.0 samples/s | 23.9 steps/s
[Step= 100] | Loss=0.17522 | acc=0.9612 | tpr=0.9360 | fpr=0.0383 | 8090.4 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.17742 | acc=0.9599 | tpr=0.9352 | fpr=0.0397 | 8103.5 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.17758 | acc=0.9598 | tpr=0.9377 | fpr=0.0398 | 7113.2 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.17712 | acc=0.9599 | tpr=0.9380 | fpr=0.0397 | 8132.1 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.18003 | acc=0.9595 | tpr=0.9367 | fpr=0.0401 | 8330.6 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.17876 | acc=0.9596 | tpr=0.9361 | fpr=0.0400 | 8033.5 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.17935 | acc=0.9592 | tpr=0.9333 | fpr=0.0403 | 8176.1 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.18217 | acc=0.9587 | tpr=0.9323 | fpr=0.0409 | 8097.9 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.18169 | acc=0.9586 | tpr=0.9348 | fpr=0.0410 | 8260.2 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.18062 | acc=0.9589 | tpr=0.9363 | fpr=0.0407 | 9736.6 samples/s | 38.0 steps/s
Avg test loss: 0.18038, Avg test acc: 0.95889, Avg tpr: 0.93621, Avg fpr: 0.04070, total FA: 5651

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26662 | acc=0.9491 | tpr=0.9558 | fpr=0.0511 | 5902.5 samples/s | 23.1 steps/s
[Step= 100] | Loss=0.27413 | acc=0.9481 | tpr=0.9638 | fpr=0.0522 | 7972.6 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.27870 | acc=0.9470 | tpr=0.9625 | fpr=0.0533 | 8232.6 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.27858 | acc=0.9474 | tpr=0.9639 | fpr=0.0529 | 8511.0 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.27885 | acc=0.9472 | tpr=0.9633 | fpr=0.0531 | 7916.5 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.28173 | acc=0.9469 | tpr=0.9600 | fpr=0.0533 | 7846.8 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.27989 | acc=0.9471 | tpr=0.9593 | fpr=0.0531 | 7666.7 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.28028 | acc=0.9466 | tpr=0.9562 | fpr=0.0535 | 7498.0 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.28407 | acc=0.9463 | tpr=0.9542 | fpr=0.0538 | 8116.3 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.28464 | acc=0.9463 | tpr=0.9555 | fpr=0.0539 | 8625.4 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.28276 | acc=0.9466 | tpr=0.9562 | fpr=0.0536 | 10170.9 samples/s | 39.7 steps/s
Avg test loss: 0.28250, Avg test acc: 0.94658, Avg tpr: 0.95602, Avg fpr: 0.05359, total FA: 7441

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15124 | acc=0.9644 | tpr=0.9204 | fpr=0.0348 | 5884.0 samples/s | 23.0 steps/s
[Step= 100] | Loss=0.15687 | acc=0.9632 | tpr=0.9403 | fpr=0.0364 | 8015.5 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.15715 | acc=0.9616 | tpr=0.9424 | fpr=0.0380 | 7446.8 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.15744 | acc=0.9617 | tpr=0.9475 | fpr=0.0381 | 8217.6 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.15739 | acc=0.9615 | tpr=0.9459 | fpr=0.0383 | 8001.9 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.16023 | acc=0.9611 | tpr=0.9418 | fpr=0.0386 | 8477.9 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.15899 | acc=0.9612 | tpr=0.9405 | fpr=0.0384 | 7732.5 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.15847 | acc=0.9611 | tpr=0.9398 | fpr=0.0385 | 7663.9 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.16085 | acc=0.9606 | tpr=0.9387 | fpr=0.0390 | 8133.7 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.16079 | acc=0.9605 | tpr=0.9410 | fpr=0.0391 | 8561.0 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.15977 | acc=0.9608 | tpr=0.9423 | fpr=0.0389 | 10179.6 samples/s | 39.8 steps/s
Avg test loss: 0.15958, Avg test acc: 0.96080, Avg tpr: 0.94216, Avg fpr: 0.03886, total FA: 5396

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.23580 | acc=0.9534 | tpr=0.9292 | fpr=0.0461 | 5801.2 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.24384 | acc=0.9526 | tpr=0.9403 | fpr=0.0472 | 8151.1 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.24740 | acc=0.9516 | tpr=0.9481 | fpr=0.0483 | 7540.6 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.24781 | acc=0.9515 | tpr=0.9519 | fpr=0.0485 | 8283.9 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.24856 | acc=0.9514 | tpr=0.9493 | fpr=0.0486 | 8227.3 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.25202 | acc=0.9509 | tpr=0.9455 | fpr=0.0490 | 8153.4 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.25118 | acc=0.9509 | tpr=0.9455 | fpr=0.0490 | 8795.7 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.25142 | acc=0.9506 | tpr=0.9415 | fpr=0.0493 | 7844.5 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.25502 | acc=0.9502 | tpr=0.9416 | fpr=0.0497 | 7763.2 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.25507 | acc=0.9501 | tpr=0.9414 | fpr=0.0497 | 8343.7 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.25351 | acc=0.9504 | tpr=0.9415 | fpr=0.0494 | 9414.1 samples/s | 36.8 steps/s
Avg test loss: 0.25321, Avg test acc: 0.95045, Avg tpr: 0.94136, Avg fpr: 0.04938, total FA: 6857

server round 39/50

clients selected: [2 3 5 6 8]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=42001 Epoch=204.6] | Loss=0.07029 | Reg=0.00100 | acc=0.9531 | L2-Norm=9.979 | L2-Norm(final)=13.919 | 7825.9 samples/s | 122.3 steps/s
[Step=42050 Epoch=204.9] | Loss=0.01758 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.979 | L2-Norm(final)=13.923 | 4605.0 samples/s | 72.0 steps/s
[Step=42100 Epoch=205.1] | Loss=0.01741 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.926 | 5597.6 samples/s | 87.5 steps/s
[Step=42150 Epoch=205.4] | Loss=0.01793 | Reg=0.00100 | acc=0.9531 | L2-Norm=9.979 | L2-Norm(final)=13.930 | 5557.1 samples/s | 86.8 steps/s
[Step=42200 Epoch=205.6] | Loss=0.01735 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.934 | 8611.0 samples/s | 134.5 steps/s
[Step=42250 Epoch=205.9] | Loss=0.01753 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.939 | 2708.7 samples/s | 42.3 steps/s
[Step=42300 Epoch=206.1] | Loss=0.01734 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.943 | 5480.2 samples/s | 85.6 steps/s
[Step=42350 Epoch=206.3] | Loss=0.01708 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.947 | 5464.3 samples/s | 85.4 steps/s
[Step=42400 Epoch=206.6] | Loss=0.01713 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.952 | 7713.1 samples/s | 120.5 steps/s
[Step=42450 Epoch=206.8] | Loss=0.01730 | Reg=0.00100 | acc=0.9688 | L2-Norm=9.979 | L2-Norm(final)=13.956 | 2818.3 samples/s | 44.0 steps/s
[Step=42500 Epoch=207.1] | Loss=0.01709 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.961 | 5489.9 samples/s | 85.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=42501 Epoch=207.1] | Loss=0.01174 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=14.003 | 7267.8 samples/s | 113.6 steps/s
[Step=42550 Epoch=207.3] | Loss=0.01754 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.993 | L2-Norm(final)=14.005 | 4252.6 samples/s | 66.4 steps/s
[Step=42600 Epoch=207.6] | Loss=0.01772 | Reg=0.00100 | acc=0.9531 | L2-Norm=10.009 | L2-Norm(final)=14.007 | 4768.5 samples/s | 74.5 steps/s
[Step=42650 Epoch=207.8] | Loss=0.01611 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.022 | L2-Norm(final)=14.011 | 4732.9 samples/s | 74.0 steps/s
[Step=42700 Epoch=208.1] | Loss=0.01521 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.034 | L2-Norm(final)=14.016 | 6853.3 samples/s | 107.1 steps/s
[Step=42750 Epoch=208.3] | Loss=0.01382 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.044 | L2-Norm(final)=14.020 | 2478.9 samples/s | 38.7 steps/s
[Step=42800 Epoch=208.5] | Loss=0.01245 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.053 | L2-Norm(final)=14.025 | 4782.7 samples/s | 74.7 steps/s
[Step=42850 Epoch=208.8] | Loss=0.01158 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.061 | L2-Norm(final)=14.031 | 4837.7 samples/s | 75.6 steps/s
[Step=42900 Epoch=209.0] | Loss=0.01074 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.068 | L2-Norm(final)=14.036 | 6110.6 samples/s | 95.5 steps/s
[Step=42950 Epoch=209.3] | Loss=0.01018 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.075 | L2-Norm(final)=14.040 | 2585.3 samples/s | 40.4 steps/s
[Step=43000 Epoch=209.5] | Loss=0.00948 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.081 | L2-Norm(final)=14.044 | 4809.2 samples/s | 75.1 steps/s
[Step=43050 Epoch=209.8] | Loss=0.00897 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.086 | L2-Norm(final)=14.049 | 4705.1 samples/s | 73.5 steps/s
[Step=43100 Epoch=210.0] | Loss=0.00853 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.091 | L2-Norm(final)=14.053 | 5663.9 samples/s | 88.5 steps/s
[Step=43150 Epoch=210.2] | Loss=0.00814 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.096 | L2-Norm(final)=14.057 | 2665.5 samples/s | 41.6 steps/s
[Step=43200 Epoch=210.5] | Loss=0.00786 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.100 | L2-Norm(final)=14.061 | 4720.4 samples/s | 73.8 steps/s
[Step=43250 Epoch=210.7] | Loss=0.00754 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.104 | L2-Norm(final)=14.064 | 4799.7 samples/s | 75.0 steps/s
[Step=43300 Epoch=211.0] | Loss=0.00738 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.108 | L2-Norm(final)=14.068 | 5216.0 samples/s | 81.5 steps/s
[Step=43350 Epoch=211.2] | Loss=0.00710 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.112 | L2-Norm(final)=14.071 | 2802.3 samples/s | 43.8 steps/s
[Step=43400 Epoch=211.5] | Loss=0.00685 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.116 | L2-Norm(final)=14.075 | 4707.6 samples/s | 73.6 steps/s
[Step=43450 Epoch=211.7] | Loss=0.00667 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.119 | L2-Norm(final)=14.078 | 4859.9 samples/s | 75.9 steps/s
[Step=43500 Epoch=212.0] | Loss=0.00647 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.123 | L2-Norm(final)=14.081 | 4767.5 samples/s | 74.5 steps/s
[Step=43550 Epoch=212.2] | Loss=0.00639 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.126 | L2-Norm(final)=14.084 | 2897.1 samples/s | 45.3 steps/s
[Step=43600 Epoch=212.4] | Loss=0.00626 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.129 | L2-Norm(final)=14.087 | 4878.7 samples/s | 76.2 steps/s
[Step=43650 Epoch=212.7] | Loss=0.00616 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.132 | L2-Norm(final)=14.090 | 4662.0 samples/s | 72.8 steps/s
[Step=43700 Epoch=212.9] | Loss=0.00606 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=14.093 | 4763.7 samples/s | 74.4 steps/s
[Step=43750 Epoch=213.2] | Loss=0.00597 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.138 | L2-Norm(final)=14.095 | 2972.1 samples/s | 46.4 steps/s
[Step=43800 Epoch=213.4] | Loss=0.00587 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.140 | L2-Norm(final)=14.098 | 4695.7 samples/s | 73.4 steps/s
[Step=43850 Epoch=213.7] | Loss=0.00577 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.143 | L2-Norm(final)=14.101 | 4789.3 samples/s | 74.8 steps/s
[Step=43900 Epoch=213.9] | Loss=0.00565 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.146 | L2-Norm(final)=14.103 | 4699.2 samples/s | 73.4 steps/s
[Step=43950 Epoch=214.1] | Loss=0.00556 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.148 | L2-Norm(final)=14.106 | 2927.9 samples/s | 45.7 steps/s
[Step=44000 Epoch=214.4] | Loss=0.00548 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.151 | L2-Norm(final)=14.108 | 4815.2 samples/s | 75.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step44000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=28001 Epoch=136.5] | Loss=0.00419 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.735 | 6688.2 samples/s | 104.5 steps/s
[Step=28050 Epoch=136.8] | Loss=0.01914 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.734 | 5080.4 samples/s | 79.4 steps/s
[Step=28100 Epoch=137.0] | Loss=0.01825 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.734 | 5463.1 samples/s | 85.4 steps/s
[Step=28150 Epoch=137.3] | Loss=0.01777 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.737 | 5562.9 samples/s | 86.9 steps/s
[Step=28200 Epoch=137.5] | Loss=0.01704 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.741 | 8622.5 samples/s | 134.7 steps/s
[Step=28250 Epoch=137.8] | Loss=0.01679 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.979 | L2-Norm(final)=13.746 | 2666.0 samples/s | 41.7 steps/s
[Step=28300 Epoch=138.0] | Loss=0.01671 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.750 | 5546.2 samples/s | 86.7 steps/s
[Step=28350 Epoch=138.3] | Loss=0.01695 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.979 | L2-Norm(final)=13.754 | 5588.3 samples/s | 87.3 steps/s
[Step=28400 Epoch=138.5] | Loss=0.01691 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.758 | 7594.1 samples/s | 118.7 steps/s
[Step=28450 Epoch=138.7] | Loss=0.01658 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.762 | 2835.0 samples/s | 44.3 steps/s
[Step=28500 Epoch=139.0] | Loss=0.01673 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.766 | 5395.8 samples/s | 84.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=28501 Epoch=139.0] | Loss=0.00531 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.809 | 7282.5 samples/s | 113.8 steps/s
[Step=28550 Epoch=139.2] | Loss=0.01881 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.998 | L2-Norm(final)=13.809 | 4227.7 samples/s | 66.1 steps/s
[Step=28600 Epoch=139.5] | Loss=0.01675 | Reg=0.00100 | acc=0.9531 | L2-Norm=10.022 | L2-Norm(final)=13.813 | 4845.7 samples/s | 75.7 steps/s
[Step=28650 Epoch=139.7] | Loss=0.01595 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.039 | L2-Norm(final)=13.816 | 4725.1 samples/s | 73.8 steps/s
[Step=28700 Epoch=140.0] | Loss=0.01447 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.054 | L2-Norm(final)=13.820 | 6756.3 samples/s | 105.6 steps/s
[Step=28750 Epoch=140.2] | Loss=0.01287 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=13.826 | 2472.1 samples/s | 38.6 steps/s
[Step=28800 Epoch=140.4] | Loss=0.01178 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.079 | L2-Norm(final)=13.831 | 4839.4 samples/s | 75.6 steps/s
[Step=28850 Epoch=140.7] | Loss=0.01115 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.089 | L2-Norm(final)=13.837 | 4724.2 samples/s | 73.8 steps/s
[Step=28900 Epoch=140.9] | Loss=0.01054 | Reg=0.00102 | acc=0.9531 | L2-Norm=10.098 | L2-Norm(final)=13.842 | 6239.6 samples/s | 97.5 steps/s
[Step=28950 Epoch=141.2] | Loss=0.00978 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.106 | L2-Norm(final)=13.846 | 2565.6 samples/s | 40.1 steps/s
[Step=29000 Epoch=141.4] | Loss=0.00920 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.113 | L2-Norm(final)=13.851 | 4774.0 samples/s | 74.6 steps/s
[Step=29050 Epoch=141.7] | Loss=0.00864 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.119 | L2-Norm(final)=13.855 | 4739.0 samples/s | 74.0 steps/s
[Step=29100 Epoch=141.9] | Loss=0.00823 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.125 | L2-Norm(final)=13.860 | 5712.0 samples/s | 89.2 steps/s
[Step=29150 Epoch=142.2] | Loss=0.00792 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.130 | L2-Norm(final)=13.864 | 2674.1 samples/s | 41.8 steps/s
[Step=29200 Epoch=142.4] | Loss=0.00758 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.136 | L2-Norm(final)=13.868 | 4789.1 samples/s | 74.8 steps/s
[Step=29250 Epoch=142.6] | Loss=0.00725 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.141 | L2-Norm(final)=13.872 | 4744.6 samples/s | 74.1 steps/s
[Step=29300 Epoch=142.9] | Loss=0.00703 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.146 | L2-Norm(final)=13.876 | 5238.3 samples/s | 81.8 steps/s
[Step=29350 Epoch=143.1] | Loss=0.00676 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.150 | L2-Norm(final)=13.880 | 2751.4 samples/s | 43.0 steps/s
[Step=29400 Epoch=143.4] | Loss=0.00656 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.155 | L2-Norm(final)=13.884 | 4725.4 samples/s | 73.8 steps/s
[Step=29450 Epoch=143.6] | Loss=0.00635 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.159 | L2-Norm(final)=13.887 | 4744.6 samples/s | 74.1 steps/s
[Step=29500 Epoch=143.9] | Loss=0.00615 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=13.891 | 4917.5 samples/s | 76.8 steps/s
[Step=29550 Epoch=144.1] | Loss=0.00599 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.166 | L2-Norm(final)=13.894 | 2903.0 samples/s | 45.4 steps/s
[Step=29600 Epoch=144.3] | Loss=0.00580 | Reg=0.00103 | acc=0.9688 | L2-Norm=10.170 | L2-Norm(final)=13.897 | 4769.3 samples/s | 74.5 steps/s
[Step=29650 Epoch=144.6] | Loss=0.00569 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.173 | L2-Norm(final)=13.901 | 4787.8 samples/s | 74.8 steps/s
[Step=29700 Epoch=144.8] | Loss=0.00553 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.176 | L2-Norm(final)=13.904 | 4795.4 samples/s | 74.9 steps/s
[Step=29750 Epoch=145.1] | Loss=0.00541 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.179 | L2-Norm(final)=13.907 | 2949.0 samples/s | 46.1 steps/s
[Step=29800 Epoch=145.3] | Loss=0.00527 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.182 | L2-Norm(final)=13.910 | 4670.1 samples/s | 73.0 steps/s
[Step=29850 Epoch=145.6] | Loss=0.00517 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.185 | L2-Norm(final)=13.913 | 4796.9 samples/s | 75.0 steps/s
[Step=29900 Epoch=145.8] | Loss=0.00509 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.188 | L2-Norm(final)=13.916 | 4770.5 samples/s | 74.5 steps/s
[Step=29950 Epoch=146.1] | Loss=0.00503 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.191 | L2-Norm(final)=13.919 | 2978.1 samples/s | 46.5 steps/s
[Step=30000 Epoch=146.3] | Loss=0.00495 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.194 | L2-Norm(final)=13.922 | 4797.7 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step30000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=52001 Epoch=492.8] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=18.119 | 5155.1 samples/s | 80.5 steps/s
[Step=52050 Epoch=493.2] | Loss=0.00005 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=18.122 | 5283.5 samples/s | 82.6 steps/s
[Step=52100 Epoch=493.7] | Loss=0.00004 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=18.122 | 8222.2 samples/s | 128.5 steps/s
[Step=52150 Epoch=494.2] | Loss=0.00004 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=18.122 | 2592.8 samples/s | 40.5 steps/s
[Step=52200 Epoch=494.6] | Loss=0.00004 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=18.122 | 7146.7 samples/s | 111.7 steps/s
[Step=52250 Epoch=495.1] | Loss=0.00004 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=18.123 | 2676.1 samples/s | 41.8 steps/s
[Step=52300 Epoch=495.6] | Loss=0.00004 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=18.123 | 6502.7 samples/s | 101.6 steps/s
[Step=52350 Epoch=496.1] | Loss=0.00004 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=18.124 | 2822.5 samples/s | 44.1 steps/s
[Step=52400 Epoch=496.5] | Loss=0.00004 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=18.125 | 5816.2 samples/s | 90.9 steps/s
[Step=52450 Epoch=497.0] | Loss=0.00004 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=18.127 | 2947.5 samples/s | 46.1 steps/s
[Step=52500 Epoch=497.5] | Loss=0.00004 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=18.128 | 5371.3 samples/s | 83.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=52501 Epoch=497.5] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=18.140 | 7317.5 samples/s | 114.3 steps/s
[Step=52550 Epoch=498.0] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.961 | L2-Norm(final)=18.141 | 3957.5 samples/s | 61.8 steps/s
[Step=52600 Epoch=498.4] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.946 | L2-Norm(final)=18.143 | 6559.8 samples/s | 102.5 steps/s
[Step=52650 Epoch=498.9] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.931 | L2-Norm(final)=18.144 | 2376.3 samples/s | 37.1 steps/s
[Step=52700 Epoch=499.4] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.917 | L2-Norm(final)=18.145 | 5962.2 samples/s | 93.2 steps/s
[Step=52750 Epoch=499.9] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.902 | L2-Norm(final)=18.145 | 2483.8 samples/s | 38.8 steps/s
[Step=52800 Epoch=500.3] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.888 | L2-Norm(final)=18.146 | 5396.7 samples/s | 84.3 steps/s
[Step=52850 Epoch=500.8] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=18.146 | 2576.0 samples/s | 40.3 steps/s
[Step=52900 Epoch=501.3] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.861 | L2-Norm(final)=18.146 | 4992.2 samples/s | 78.0 steps/s
[Step=52950 Epoch=501.7] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.848 | L2-Norm(final)=18.147 | 2695.0 samples/s | 42.1 steps/s
[Step=53000 Epoch=502.2] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.834 | L2-Norm(final)=18.147 | 4662.6 samples/s | 72.9 steps/s
[Step=53050 Epoch=502.7] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.821 | L2-Norm(final)=18.147 | 2811.8 samples/s | 43.9 steps/s
[Step=53100 Epoch=503.2] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.808 | L2-Norm(final)=18.148 | 4508.3 samples/s | 70.4 steps/s
[Step=53150 Epoch=503.6] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.795 | L2-Norm(final)=18.148 | 2920.4 samples/s | 45.6 steps/s
[Step=53200 Epoch=504.1] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.782 | L2-Norm(final)=18.148 | 4438.9 samples/s | 69.4 steps/s
[Step=53250 Epoch=504.6] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.770 | L2-Norm(final)=18.149 | 2870.7 samples/s | 44.9 steps/s
[Step=53300 Epoch=505.1] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.757 | L2-Norm(final)=18.149 | 4642.3 samples/s | 72.5 steps/s
[Step=53350 Epoch=505.5] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.744 | L2-Norm(final)=18.149 | 3024.0 samples/s | 47.3 steps/s
[Step=53400 Epoch=506.0] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.731 | L2-Norm(final)=18.150 | 4017.1 samples/s | 62.8 steps/s
[Step=53450 Epoch=506.5] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.718 | L2-Norm(final)=18.150 | 6845.7 samples/s | 107.0 steps/s
[Step=53500 Epoch=507.0] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.706 | L2-Norm(final)=18.150 | 2388.3 samples/s | 37.3 steps/s
[Step=53550 Epoch=507.4] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.693 | L2-Norm(final)=18.151 | 5960.5 samples/s | 93.1 steps/s
[Step=53600 Epoch=507.9] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=18.151 | 2472.0 samples/s | 38.6 steps/s
[Step=53650 Epoch=508.4] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=18.151 | 5445.7 samples/s | 85.1 steps/s
[Step=53700 Epoch=508.9] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=18.152 | 2532.7 samples/s | 39.6 steps/s
[Step=53750 Epoch=509.3] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.642 | L2-Norm(final)=18.152 | 5181.5 samples/s | 81.0 steps/s
[Step=53800 Epoch=509.8] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.629 | L2-Norm(final)=18.152 | 2665.6 samples/s | 41.6 steps/s
[Step=53850 Epoch=510.3] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.616 | L2-Norm(final)=18.153 | 4693.5 samples/s | 73.3 steps/s
[Step=53900 Epoch=510.7] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=18.153 | 2754.3 samples/s | 43.0 steps/s
[Step=53950 Epoch=511.2] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.590 | L2-Norm(final)=18.154 | 4560.1 samples/s | 71.3 steps/s
[Step=54000 Epoch=511.7] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=18.154 | 2858.9 samples/s | 44.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step54000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=36001 Epoch=342.5] | Loss=0.00006 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=15.561 | 7830.8 samples/s | 122.4 steps/s
[Step=36050 Epoch=342.9] | Loss=0.00125 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.977 | L2-Norm(final)=15.558 | 4282.1 samples/s | 66.9 steps/s
[Step=36100 Epoch=343.4] | Loss=0.00103 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=15.560 | 8210.4 samples/s | 128.3 steps/s
[Step=36150 Epoch=343.9] | Loss=0.00101 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=15.562 | 2563.5 samples/s | 40.1 steps/s
[Step=36200 Epoch=344.4] | Loss=0.00100 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=15.565 | 7308.2 samples/s | 114.2 steps/s
[Step=36250 Epoch=344.8] | Loss=0.00095 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=15.567 | 2695.0 samples/s | 42.1 steps/s
[Step=36300 Epoch=345.3] | Loss=0.00100 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=15.570 | 6524.8 samples/s | 101.9 steps/s
[Step=36350 Epoch=345.8] | Loss=0.00099 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=15.573 | 2800.8 samples/s | 43.8 steps/s
[Step=36400 Epoch=346.3] | Loss=0.00097 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=15.576 | 5859.9 samples/s | 91.6 steps/s
[Step=36450 Epoch=346.7] | Loss=0.00099 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=15.580 | 2924.7 samples/s | 45.7 steps/s
[Step=36500 Epoch=347.2] | Loss=0.00099 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=15.584 | 5456.2 samples/s | 85.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=347.2] | Loss=0.00013 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=15.622 | 7103.3 samples/s | 111.0 steps/s
[Step=36550 Epoch=347.7] | Loss=0.00161 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=15.619 | 3992.9 samples/s | 62.4 steps/s
[Step=36600 Epoch=348.2] | Loss=0.00136 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.034 | L2-Norm(final)=15.617 | 6697.6 samples/s | 104.7 steps/s
[Step=36650 Epoch=348.6] | Loss=0.00094 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.043 | L2-Norm(final)=15.616 | 2387.3 samples/s | 37.3 steps/s
[Step=36700 Epoch=349.1] | Loss=0.00071 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.047 | L2-Norm(final)=15.617 | 6030.5 samples/s | 94.2 steps/s
[Step=36750 Epoch=349.6] | Loss=0.00058 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.049 | L2-Norm(final)=15.617 | 2489.3 samples/s | 38.9 steps/s
[Step=36800 Epoch=350.1] | Loss=0.00048 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.049 | L2-Norm(final)=15.617 | 5439.7 samples/s | 85.0 steps/s
[Step=36850 Epoch=350.5] | Loss=0.00042 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.048 | L2-Norm(final)=15.618 | 2581.9 samples/s | 40.3 steps/s
[Step=36900 Epoch=351.0] | Loss=0.00037 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.047 | L2-Norm(final)=15.618 | 5017.4 samples/s | 78.4 steps/s
[Step=36950 Epoch=351.5] | Loss=0.00033 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.046 | L2-Norm(final)=15.618 | 2696.4 samples/s | 42.1 steps/s
[Step=37000 Epoch=352.0] | Loss=0.00029 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.044 | L2-Norm(final)=15.619 | 4687.9 samples/s | 73.2 steps/s
[Step=37050 Epoch=352.4] | Loss=0.00027 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.042 | L2-Norm(final)=15.619 | 2826.5 samples/s | 44.2 steps/s
[Step=37100 Epoch=352.9] | Loss=0.00025 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.040 | L2-Norm(final)=15.619 | 4611.7 samples/s | 72.1 steps/s
[Step=37150 Epoch=353.4] | Loss=0.00023 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.038 | L2-Norm(final)=15.620 | 2836.4 samples/s | 44.3 steps/s
[Step=37200 Epoch=353.9] | Loss=0.00021 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.036 | L2-Norm(final)=15.620 | 4484.1 samples/s | 70.1 steps/s
[Step=37250 Epoch=354.3] | Loss=0.00020 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.033 | L2-Norm(final)=15.620 | 2865.1 samples/s | 44.8 steps/s
[Step=37300 Epoch=354.8] | Loss=0.00019 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.031 | L2-Norm(final)=15.621 | 4521.5 samples/s | 70.6 steps/s
[Step=37350 Epoch=355.3] | Loss=0.00018 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.028 | L2-Norm(final)=15.621 | 2960.1 samples/s | 46.3 steps/s
[Step=37400 Epoch=355.8] | Loss=0.00017 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.026 | L2-Norm(final)=15.621 | 4315.2 samples/s | 67.4 steps/s
[Step=37450 Epoch=356.2] | Loss=0.00016 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=15.621 | 6920.9 samples/s | 108.1 steps/s
[Step=37500 Epoch=356.7] | Loss=0.00015 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.020 | L2-Norm(final)=15.622 | 2393.9 samples/s | 37.4 steps/s
[Step=37550 Epoch=357.2] | Loss=0.00014 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.018 | L2-Norm(final)=15.622 | 6037.6 samples/s | 94.3 steps/s
[Step=37600 Epoch=357.7] | Loss=0.00014 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=15.622 | 2441.1 samples/s | 38.1 steps/s
[Step=37650 Epoch=358.1] | Loss=0.00013 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=15.623 | 5639.3 samples/s | 88.1 steps/s
[Step=37700 Epoch=358.6] | Loss=0.00013 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.009 | L2-Norm(final)=15.623 | 2543.6 samples/s | 39.7 steps/s
[Step=37750 Epoch=359.1] | Loss=0.00012 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.006 | L2-Norm(final)=15.623 | 5161.6 samples/s | 80.6 steps/s
[Step=37800 Epoch=359.6] | Loss=0.00012 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.003 | L2-Norm(final)=15.623 | 2673.0 samples/s | 41.8 steps/s
[Step=37850 Epoch=360.0] | Loss=0.00011 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.000 | L2-Norm(final)=15.624 | 4763.0 samples/s | 74.4 steps/s
[Step=37900 Epoch=360.5] | Loss=0.00011 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.997 | L2-Norm(final)=15.624 | 2760.5 samples/s | 43.1 steps/s
[Step=37950 Epoch=361.0] | Loss=0.00011 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.994 | L2-Norm(final)=15.624 | 4585.4 samples/s | 71.6 steps/s
[Step=38000 Epoch=361.5] | Loss=0.00010 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.991 | L2-Norm(final)=15.624 | 2841.1 samples/s | 44.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step38000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=40001 Epoch=376.9] | Loss=0.00037 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=15.875 | 6634.6 samples/s | 103.7 steps/s
[Step=40050 Epoch=377.4] | Loss=0.00068 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.978 | L2-Norm(final)=15.879 | 4797.8 samples/s | 75.0 steps/s
[Step=40100 Epoch=377.9] | Loss=0.00048 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.978 | L2-Norm(final)=15.883 | 7962.6 samples/s | 124.4 steps/s
[Step=40150 Epoch=378.3] | Loss=0.00046 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.978 | L2-Norm(final)=15.887 | 2599.9 samples/s | 40.6 steps/s
[Step=40200 Epoch=378.8] | Loss=0.00045 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.978 | L2-Norm(final)=15.890 | 6903.3 samples/s | 107.9 steps/s
[Step=40250 Epoch=379.3] | Loss=0.00046 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.978 | L2-Norm(final)=15.894 | 2719.3 samples/s | 42.5 steps/s
[Step=40300 Epoch=379.7] | Loss=0.00046 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.978 | L2-Norm(final)=15.899 | 6183.6 samples/s | 96.6 steps/s
[Step=40350 Epoch=380.2] | Loss=0.00044 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.978 | L2-Norm(final)=15.903 | 2879.9 samples/s | 45.0 steps/s
[Step=40400 Epoch=380.7] | Loss=0.00046 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.978 | L2-Norm(final)=15.907 | 5534.2 samples/s | 86.5 steps/s
[Step=40450 Epoch=381.2] | Loss=0.00044 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.978 | L2-Norm(final)=15.912 | 3040.2 samples/s | 47.5 steps/s
[Step=40500 Epoch=381.6] | Loss=0.00046 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.978 | L2-Norm(final)=15.917 | 5312.8 samples/s | 83.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=40501 Epoch=381.6] | Loss=0.00034 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.977 | L2-Norm(final)=15.967 | 6882.8 samples/s | 107.5 steps/s
[Step=40550 Epoch=382.1] | Loss=0.00023 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.981 | L2-Norm(final)=15.970 | 4100.4 samples/s | 64.1 steps/s
[Step=40600 Epoch=382.6] | Loss=0.00019 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.985 | L2-Norm(final)=15.973 | 6493.9 samples/s | 101.5 steps/s
[Step=40650 Epoch=383.0] | Loss=0.00014 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.987 | L2-Norm(final)=15.975 | 2406.6 samples/s | 37.6 steps/s
[Step=40700 Epoch=383.5] | Loss=0.00011 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.985 | L2-Norm(final)=15.977 | 5737.1 samples/s | 89.6 steps/s
[Step=40750 Epoch=384.0] | Loss=0.00009 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.983 | L2-Norm(final)=15.978 | 2508.1 samples/s | 39.2 steps/s
[Step=40800 Epoch=384.5] | Loss=0.00007 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.980 | L2-Norm(final)=15.979 | 5257.8 samples/s | 82.2 steps/s
[Step=40850 Epoch=384.9] | Loss=0.00006 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=15.979 | 2631.1 samples/s | 41.1 steps/s
[Step=40900 Epoch=385.4] | Loss=0.00006 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.972 | L2-Norm(final)=15.980 | 4795.7 samples/s | 74.9 steps/s
[Step=40950 Epoch=385.9] | Loss=0.00005 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.968 | L2-Norm(final)=15.981 | 2768.8 samples/s | 43.3 steps/s
[Step=41000 Epoch=386.3] | Loss=0.00005 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.964 | L2-Norm(final)=15.981 | 4595.3 samples/s | 71.8 steps/s
[Step=41050 Epoch=386.8] | Loss=0.00004 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.959 | L2-Norm(final)=15.982 | 2884.5 samples/s | 45.1 steps/s
[Step=41100 Epoch=387.3] | Loss=0.00004 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.955 | L2-Norm(final)=15.982 | 4575.0 samples/s | 71.5 steps/s
[Step=41150 Epoch=387.8] | Loss=0.00004 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.951 | L2-Norm(final)=15.982 | 2845.7 samples/s | 44.5 steps/s
[Step=41200 Epoch=388.2] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.946 | L2-Norm(final)=15.983 | 4478.2 samples/s | 70.0 steps/s
[Step=41250 Epoch=388.7] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.941 | L2-Norm(final)=15.983 | 3093.9 samples/s | 48.3 steps/s
[Step=41300 Epoch=389.2] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.937 | L2-Norm(final)=15.984 | 4091.2 samples/s | 63.9 steps/s
[Step=41350 Epoch=389.6] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.932 | L2-Norm(final)=15.984 | 6644.1 samples/s | 103.8 steps/s
[Step=41400 Epoch=390.1] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.927 | L2-Norm(final)=15.984 | 2402.2 samples/s | 37.5 steps/s
[Step=41450 Epoch=390.6] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.923 | L2-Norm(final)=15.985 | 5895.6 samples/s | 92.1 steps/s
[Step=41500 Epoch=391.0] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.918 | L2-Norm(final)=15.985 | 2492.6 samples/s | 38.9 steps/s
[Step=41550 Epoch=391.5] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.913 | L2-Norm(final)=15.986 | 5340.3 samples/s | 83.4 steps/s
[Step=41600 Epoch=392.0] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.908 | L2-Norm(final)=15.986 | 2619.9 samples/s | 40.9 steps/s
[Step=41650 Epoch=392.5] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.903 | L2-Norm(final)=15.986 | 4874.7 samples/s | 76.2 steps/s
[Step=41700 Epoch=392.9] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=15.987 | 2733.2 samples/s | 42.7 steps/s
[Step=41750 Epoch=393.4] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.893 | L2-Norm(final)=15.987 | 4615.9 samples/s | 72.1 steps/s
[Step=41800 Epoch=393.9] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.888 | L2-Norm(final)=15.987 | 2803.2 samples/s | 43.8 steps/s
[Step=41850 Epoch=394.3] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=15.988 | 4593.3 samples/s | 71.8 steps/s
[Step=41900 Epoch=394.8] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=15.988 | 2826.1 samples/s | 44.2 steps/s
[Step=41950 Epoch=395.3] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.872 | L2-Norm(final)=15.988 | 4584.7 samples/s | 71.6 steps/s
[Step=42000 Epoch=395.8] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.866 | L2-Norm(final)=15.989 | 3003.2 samples/s | 46.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step42000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08348 | acc=0.9630 | tpr=0.9815 | fpr=0.0773 | 5876.5 samples/s | 23.0 steps/s
Avg test loss: 0.08858, Avg test acc: 0.96033, Avg tpr: 0.97966, Avg fpr: 0.08217, total FA: 641

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08800 | acc=0.9621 | tpr=0.9712 | fpr=0.0577 | 6039.5 samples/s | 23.6 steps/s
Avg test loss: 0.09252, Avg test acc: 0.96077, Avg tpr: 0.96876, Avg fpr: 0.05679, total FA: 443

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09224 | acc=0.9628 | tpr=0.9787 | fpr=0.0716 | 6036.0 samples/s | 23.6 steps/s
Avg test loss: 0.09533, Avg test acc: 0.96097, Avg tpr: 0.97575, Avg fpr: 0.07153, total FA: 558

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08728 | acc=0.9617 | tpr=0.9700 | fpr=0.0562 | 5840.1 samples/s | 22.8 steps/s
Avg test loss: 0.09207, Avg test acc: 0.96077, Avg tpr: 0.96917, Avg fpr: 0.05768, total FA: 450

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09383 | acc=0.9627 | tpr=0.9690 | fpr=0.0508 | 5643.4 samples/s | 22.0 steps/s
Avg test loss: 0.09787, Avg test acc: 0.96146, Avg tpr: 0.96649, Avg fpr: 0.04961, total FA: 387

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.22356 | acc=0.2743 | tpr=0.0203 | fpr=0.1742 | 5849.2 samples/s | 22.8 steps/s
Avg test loss: 6.22949, Avg test acc: 0.27326, Avg tpr: 0.01923, Avg fpr: 0.16806, total FA: 1311

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.57198 | acc=0.3013 | tpr=0.0251 | fpr=0.0991 | 6051.4 samples/s | 23.6 steps/s
Avg test loss: 4.58208, Avg test acc: 0.29918, Avg tpr: 0.02500, Avg fpr: 0.09781, total FA: 763

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.04505 | acc=0.2930 | tpr=0.0210 | fpr=0.1162 | 6052.1 samples/s | 23.6 steps/s
Avg test loss: 5.05229, Avg test acc: 0.29089, Avg tpr: 0.01976, Avg fpr: 0.11281, total FA: 880

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.23941 | acc=0.2753 | tpr=0.0259 | fpr=0.1831 | 5935.5 samples/s | 23.2 steps/s
Avg test loss: 5.24373, Avg test acc: 0.27474, Avg tpr: 0.02518, Avg fpr: 0.17639, total FA: 1376

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.70946 | acc=0.3033 | tpr=0.0194 | fpr=0.0803 | 6070.3 samples/s | 23.7 steps/s
Avg test loss: 4.73245, Avg test acc: 0.30058, Avg tpr: 0.01801, Avg fpr: 0.07794, total FA: 608

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.40640 | acc=0.1163 | tpr=0.6681 | fpr=0.8936 | 6056.2 samples/s | 23.7 steps/s
[Step= 100] | Loss=5.38996 | acc=0.1185 | tpr=0.6567 | fpr=0.8916 | 7561.2 samples/s | 29.5 steps/s
[Step= 150] | Loss=5.38087 | acc=0.1204 | tpr=0.6686 | fpr=0.8896 | 7613.5 samples/s | 29.7 steps/s
[Step= 200] | Loss=5.36999 | acc=0.1208 | tpr=0.6656 | fpr=0.8892 | 8054.3 samples/s | 31.5 steps/s
[Step= 250] | Loss=5.37494 | acc=0.1206 | tpr=0.6585 | fpr=0.8892 | 8287.7 samples/s | 32.4 steps/s
[Step= 300] | Loss=5.36849 | acc=0.1209 | tpr=0.6596 | fpr=0.8889 | 8263.1 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.37403 | acc=0.1208 | tpr=0.6587 | fpr=0.8889 | 8085.7 samples/s | 31.6 steps/s
[Step= 400] | Loss=5.37129 | acc=0.1212 | tpr=0.6543 | fpr=0.8885 | 7744.6 samples/s | 30.3 steps/s
[Step= 450] | Loss=5.37658 | acc=0.1208 | tpr=0.6563 | fpr=0.8889 | 8269.2 samples/s | 32.3 steps/s
[Step= 500] | Loss=5.37671 | acc=0.1206 | tpr=0.6590 | fpr=0.8891 | 7685.0 samples/s | 30.0 steps/s
[Step= 550] | Loss=5.37954 | acc=0.1208 | tpr=0.6626 | fpr=0.8890 | 10524.9 samples/s | 41.1 steps/s
Avg test loss: 5.37976, Avg test acc: 0.12075, Avg tpr: 0.66363, Avg fpr: 0.88912, total FA: 123453

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.64583 | acc=0.1472 | tpr=0.5619 | fpr=0.8603 | 5787.7 samples/s | 22.6 steps/s
[Step= 100] | Loss=4.63291 | acc=0.1520 | tpr=0.5672 | fpr=0.8558 | 8270.8 samples/s | 32.3 steps/s
[Step= 150] | Loss=4.62202 | acc=0.1548 | tpr=0.5893 | fpr=0.8532 | 7879.7 samples/s | 30.8 steps/s
[Step= 200] | Loss=4.61378 | acc=0.1555 | tpr=0.5880 | fpr=0.8524 | 8100.1 samples/s | 31.6 steps/s
[Step= 250] | Loss=4.61723 | acc=0.1553 | tpr=0.5808 | fpr=0.8524 | 8406.4 samples/s | 32.8 steps/s
[Step= 300] | Loss=4.61335 | acc=0.1549 | tpr=0.5745 | fpr=0.8528 | 8061.5 samples/s | 31.5 steps/s
[Step= 350] | Loss=4.61791 | acc=0.1548 | tpr=0.5686 | fpr=0.8527 | 7630.8 samples/s | 29.8 steps/s
[Step= 400] | Loss=4.61598 | acc=0.1549 | tpr=0.5689 | fpr=0.8526 | 8277.1 samples/s | 32.3 steps/s
[Step= 450] | Loss=4.61949 | acc=0.1546 | tpr=0.5755 | fpr=0.8531 | 7847.1 samples/s | 30.7 steps/s
[Step= 500] | Loss=4.62059 | acc=0.1544 | tpr=0.5784 | fpr=0.8533 | 8056.5 samples/s | 31.5 steps/s
[Step= 550] | Loss=4.62381 | acc=0.1544 | tpr=0.5790 | fpr=0.8533 | 9939.4 samples/s | 38.8 steps/s
Avg test loss: 4.62390, Avg test acc: 0.15435, Avg tpr: 0.57964, Avg fpr: 0.85338, total FA: 118490

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.30580 | acc=0.1205 | tpr=0.6460 | fpr=0.8889 | 5855.0 samples/s | 22.9 steps/s
[Step= 100] | Loss=5.29587 | acc=0.1221 | tpr=0.6397 | fpr=0.8876 | 8248.0 samples/s | 32.2 steps/s
[Step= 150] | Loss=5.28653 | acc=0.1238 | tpr=0.6484 | fpr=0.8858 | 8102.9 samples/s | 31.7 steps/s
[Step= 200] | Loss=5.27791 | acc=0.1240 | tpr=0.6361 | fpr=0.8854 | 7591.0 samples/s | 29.7 steps/s
[Step= 250] | Loss=5.28441 | acc=0.1241 | tpr=0.6314 | fpr=0.8852 | 8714.2 samples/s | 34.0 steps/s
[Step= 300] | Loss=5.28069 | acc=0.1239 | tpr=0.6269 | fpr=0.8853 | 7875.0 samples/s | 30.8 steps/s
[Step= 350] | Loss=5.28648 | acc=0.1239 | tpr=0.6255 | fpr=0.8852 | 7876.2 samples/s | 30.8 steps/s
[Step= 400] | Loss=5.28547 | acc=0.1240 | tpr=0.6253 | fpr=0.8851 | 8293.8 samples/s | 32.4 steps/s
[Step= 450] | Loss=5.29084 | acc=0.1234 | tpr=0.6261 | fpr=0.8857 | 7459.4 samples/s | 29.1 steps/s
[Step= 500] | Loss=5.29038 | acc=0.1233 | tpr=0.6273 | fpr=0.8858 | 8271.8 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.29362 | acc=0.1234 | tpr=0.6291 | fpr=0.8858 | 10117.4 samples/s | 39.5 steps/s
Avg test loss: 5.29407, Avg test acc: 0.12333, Avg tpr: 0.63035, Avg fpr: 0.88589, total FA: 123004

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.94780 | acc=0.1384 | tpr=0.6195 | fpr=0.8702 | 6021.2 samples/s | 23.5 steps/s
[Step= 100] | Loss=4.93897 | acc=0.1408 | tpr=0.6055 | fpr=0.8679 | 8229.6 samples/s | 32.1 steps/s
[Step= 150] | Loss=4.92659 | acc=0.1426 | tpr=0.6167 | fpr=0.8661 | 7715.2 samples/s | 30.1 steps/s
[Step= 200] | Loss=4.91760 | acc=0.1432 | tpr=0.6164 | fpr=0.8654 | 8077.4 samples/s | 31.6 steps/s
[Step= 250] | Loss=4.92030 | acc=0.1430 | tpr=0.6105 | fpr=0.8656 | 7905.5 samples/s | 30.9 steps/s
[Step= 300] | Loss=4.91626 | acc=0.1426 | tpr=0.6044 | fpr=0.8658 | 7196.0 samples/s | 28.1 steps/s
[Step= 350] | Loss=4.92154 | acc=0.1426 | tpr=0.6036 | fpr=0.8658 | 8137.7 samples/s | 31.8 steps/s
[Step= 400] | Loss=4.91928 | acc=0.1428 | tpr=0.6045 | fpr=0.8656 | 8072.8 samples/s | 31.5 steps/s
[Step= 450] | Loss=4.92420 | acc=0.1420 | tpr=0.6076 | fpr=0.8664 | 7973.3 samples/s | 31.1 steps/s
[Step= 500] | Loss=4.92313 | acc=0.1423 | tpr=0.6106 | fpr=0.8662 | 8148.1 samples/s | 31.8 steps/s
[Step= 550] | Loss=4.92762 | acc=0.1423 | tpr=0.6116 | fpr=0.8663 | 11644.5 samples/s | 45.5 steps/s
Avg test loss: 4.92822, Avg test acc: 0.14222, Avg tpr: 0.61292, Avg fpr: 0.86634, total FA: 120289

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.28901 | acc=0.1422 | tpr=0.4690 | fpr=0.8637 | 5877.2 samples/s | 23.0 steps/s
[Step= 100] | Loss=5.27488 | acc=0.1442 | tpr=0.4584 | fpr=0.8616 | 8003.3 samples/s | 31.3 steps/s
[Step= 150] | Loss=5.26396 | acc=0.1466 | tpr=0.4683 | fpr=0.8593 | 8492.9 samples/s | 33.2 steps/s
[Step= 200] | Loss=5.25822 | acc=0.1473 | tpr=0.4689 | fpr=0.8585 | 8081.1 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.26212 | acc=0.1474 | tpr=0.4611 | fpr=0.8583 | 7861.2 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.25817 | acc=0.1470 | tpr=0.4545 | fpr=0.8586 | 8244.0 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.26509 | acc=0.1471 | tpr=0.4546 | fpr=0.8585 | 8155.8 samples/s | 31.9 steps/s
[Step= 400] | Loss=5.26113 | acc=0.1473 | tpr=0.4546 | fpr=0.8583 | 7366.7 samples/s | 28.8 steps/s
[Step= 450] | Loss=5.26571 | acc=0.1467 | tpr=0.4581 | fpr=0.8589 | 8310.8 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.26569 | acc=0.1469 | tpr=0.4590 | fpr=0.8587 | 8348.8 samples/s | 32.6 steps/s
[Step= 550] | Loss=5.26884 | acc=0.1468 | tpr=0.4560 | fpr=0.8589 | 9911.0 samples/s | 38.7 steps/s
Avg test loss: 5.26965, Avg test acc: 0.14675, Avg tpr: 0.45681, Avg fpr: 0.85888, total FA: 119254

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.21976 | acc=0.9595 | tpr=0.9513 | fpr=0.0404 | 6062.4 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.22823 | acc=0.9584 | tpr=0.9574 | fpr=0.0416 | 8245.5 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.23035 | acc=0.9570 | tpr=0.9553 | fpr=0.0429 | 8039.4 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.23058 | acc=0.9570 | tpr=0.9585 | fpr=0.0430 | 8159.7 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.23040 | acc=0.9570 | tpr=0.9563 | fpr=0.0430 | 7558.6 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.23398 | acc=0.9565 | tpr=0.9542 | fpr=0.0434 | 8182.2 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.23214 | acc=0.9568 | tpr=0.9537 | fpr=0.0432 | 7812.9 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.23197 | acc=0.9564 | tpr=0.9513 | fpr=0.0435 | 7594.8 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.23555 | acc=0.9559 | tpr=0.9499 | fpr=0.0440 | 8468.5 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.23593 | acc=0.9557 | tpr=0.9515 | fpr=0.0442 | 8659.9 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.23459 | acc=0.9561 | tpr=0.9522 | fpr=0.0439 | 9352.6 samples/s | 36.5 steps/s
Avg test loss: 0.23428, Avg test acc: 0.95607, Avg tpr: 0.95206, Avg fpr: 0.04385, total FA: 6089

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16790 | acc=0.9590 | tpr=0.9336 | fpr=0.0406 | 6070.6 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.17162 | acc=0.9582 | tpr=0.9382 | fpr=0.0414 | 7849.4 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.17518 | acc=0.9563 | tpr=0.9409 | fpr=0.0434 | 7653.2 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.17543 | acc=0.9566 | tpr=0.9454 | fpr=0.0432 | 8211.6 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.17601 | acc=0.9566 | tpr=0.9432 | fpr=0.0432 | 8013.4 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.17846 | acc=0.9562 | tpr=0.9425 | fpr=0.0435 | 8449.8 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.17756 | acc=0.9563 | tpr=0.9430 | fpr=0.0434 | 7719.2 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.17815 | acc=0.9560 | tpr=0.9404 | fpr=0.0437 | 8009.8 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.18098 | acc=0.9555 | tpr=0.9391 | fpr=0.0442 | 8224.0 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.18071 | acc=0.9554 | tpr=0.9410 | fpr=0.0443 | 8046.7 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.17955 | acc=0.9557 | tpr=0.9411 | fpr=0.0441 | 9822.7 samples/s | 38.4 steps/s
Avg test loss: 0.17937, Avg test acc: 0.95566, Avg tpr: 0.94097, Avg fpr: 0.04407, total FA: 6119

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26662 | acc=0.9491 | tpr=0.9558 | fpr=0.0511 | 5994.2 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.27413 | acc=0.9481 | tpr=0.9638 | fpr=0.0522 | 7209.1 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.27870 | acc=0.9470 | tpr=0.9625 | fpr=0.0533 | 8339.3 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.27858 | acc=0.9474 | tpr=0.9639 | fpr=0.0529 | 8707.2 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.27885 | acc=0.9472 | tpr=0.9633 | fpr=0.0531 | 8002.6 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.28173 | acc=0.9469 | tpr=0.9600 | fpr=0.0533 | 8292.2 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.27989 | acc=0.9471 | tpr=0.9593 | fpr=0.0531 | 7840.6 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.28028 | acc=0.9466 | tpr=0.9562 | fpr=0.0535 | 8186.5 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.28407 | acc=0.9463 | tpr=0.9542 | fpr=0.0538 | 7779.4 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.28464 | acc=0.9463 | tpr=0.9555 | fpr=0.0539 | 7680.1 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.28276 | acc=0.9466 | tpr=0.9562 | fpr=0.0536 | 10384.1 samples/s | 40.6 steps/s
Avg test loss: 0.28250, Avg test acc: 0.94658, Avg tpr: 0.95602, Avg fpr: 0.05359, total FA: 7441

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.16188 | acc=0.9647 | tpr=0.9425 | fpr=0.0349 | 6015.1 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.16837 | acc=0.9638 | tpr=0.9531 | fpr=0.0360 | 7323.1 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.16871 | acc=0.9622 | tpr=0.9510 | fpr=0.0376 | 7598.8 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.16918 | acc=0.9620 | tpr=0.9552 | fpr=0.0379 | 8115.5 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.16871 | acc=0.9618 | tpr=0.9537 | fpr=0.0381 | 8799.8 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.17165 | acc=0.9613 | tpr=0.9520 | fpr=0.0385 | 8219.2 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.17023 | acc=0.9613 | tpr=0.9505 | fpr=0.0385 | 8154.2 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.16977 | acc=0.9611 | tpr=0.9486 | fpr=0.0386 | 8111.5 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.17213 | acc=0.9606 | tpr=0.9479 | fpr=0.0391 | 8250.4 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.17214 | acc=0.9606 | tpr=0.9493 | fpr=0.0392 | 7502.2 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.17115 | acc=0.9608 | tpr=0.9499 | fpr=0.0390 | 10114.5 samples/s | 39.5 steps/s
Avg test loss: 0.17092, Avg test acc: 0.96085, Avg tpr: 0.94968, Avg fpr: 0.03895, total FA: 5408

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.23580 | acc=0.9534 | tpr=0.9292 | fpr=0.0461 | 5898.1 samples/s | 23.0 steps/s
[Step= 100] | Loss=0.24384 | acc=0.9526 | tpr=0.9403 | fpr=0.0472 | 7893.1 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.24740 | acc=0.9516 | tpr=0.9481 | fpr=0.0483 | 8095.2 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.24781 | acc=0.9515 | tpr=0.9519 | fpr=0.0485 | 8663.8 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.24856 | acc=0.9514 | tpr=0.9493 | fpr=0.0486 | 7237.2 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.25202 | acc=0.9509 | tpr=0.9455 | fpr=0.0490 | 8466.0 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.25118 | acc=0.9509 | tpr=0.9455 | fpr=0.0490 | 7767.2 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.25142 | acc=0.9506 | tpr=0.9415 | fpr=0.0493 | 8323.0 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.25502 | acc=0.9502 | tpr=0.9416 | fpr=0.0497 | 8251.7 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.25507 | acc=0.9501 | tpr=0.9414 | fpr=0.0497 | 7554.2 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.25351 | acc=0.9504 | tpr=0.9415 | fpr=0.0494 | 10661.1 samples/s | 41.6 steps/s
Avg test loss: 0.25321, Avg test acc: 0.95045, Avg tpr: 0.94136, Avg fpr: 0.04938, total FA: 6857

server round 40/50

clients selected: [0 1 4 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=36001 Epoch=175.5] | Loss=0.00713 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=13.006 | 7426.7 samples/s | 116.0 steps/s
[Step=36050 Epoch=175.8] | Loss=0.02011 | Reg=0.00098 | acc=0.9375 | L2-Norm=9.900 | L2-Norm(final)=13.008 | 4776.3 samples/s | 74.6 steps/s
[Step=36100 Epoch=176.0] | Loss=0.02041 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.900 | L2-Norm(final)=13.010 | 5547.9 samples/s | 86.7 steps/s
[Step=36150 Epoch=176.3] | Loss=0.01955 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.901 | L2-Norm(final)=13.013 | 5425.0 samples/s | 84.8 steps/s
[Step=36200 Epoch=176.5] | Loss=0.02000 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.901 | L2-Norm(final)=13.015 | 8681.9 samples/s | 135.7 steps/s
[Step=36250 Epoch=176.8] | Loss=0.02058 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=13.018 | 2657.2 samples/s | 41.5 steps/s
[Step=36300 Epoch=177.0] | Loss=0.02016 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.901 | L2-Norm(final)=13.020 | 5481.5 samples/s | 85.6 steps/s
[Step=36350 Epoch=177.2] | Loss=0.01995 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=13.022 | 5529.7 samples/s | 86.4 steps/s
[Step=36400 Epoch=177.5] | Loss=0.02000 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.901 | L2-Norm(final)=13.024 | 7667.7 samples/s | 119.8 steps/s
[Step=36450 Epoch=177.7] | Loss=0.02009 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.901 | L2-Norm(final)=13.027 | 2757.3 samples/s | 43.1 steps/s
[Step=36500 Epoch=178.0] | Loss=0.02013 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=13.028 | 5572.3 samples/s | 87.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=36501 Epoch=178.0] | Loss=0.00580 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=13.048 | 6824.4 samples/s | 106.6 steps/s
[Step=36550 Epoch=178.2] | Loss=0.02148 | Reg=0.00098 | acc=0.9531 | L2-Norm=9.908 | L2-Norm(final)=13.050 | 4407.4 samples/s | 68.9 steps/s
[Step=36600 Epoch=178.5] | Loss=0.02004 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.917 | L2-Norm(final)=13.052 | 4795.6 samples/s | 74.9 steps/s
[Step=36650 Epoch=178.7] | Loss=0.01729 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.923 | L2-Norm(final)=13.055 | 4768.1 samples/s | 74.5 steps/s
[Step=36700 Epoch=179.0] | Loss=0.01538 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.929 | L2-Norm(final)=13.058 | 6757.3 samples/s | 105.6 steps/s
[Step=36750 Epoch=179.2] | Loss=0.01357 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.935 | L2-Norm(final)=13.062 | 2507.5 samples/s | 39.2 steps/s
[Step=36800 Epoch=179.4] | Loss=0.01254 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.941 | L2-Norm(final)=13.066 | 4684.6 samples/s | 73.2 steps/s
[Step=36850 Epoch=179.7] | Loss=0.01139 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.946 | L2-Norm(final)=13.070 | 4745.8 samples/s | 74.2 steps/s
[Step=36900 Epoch=179.9] | Loss=0.01075 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.951 | L2-Norm(final)=13.074 | 6259.1 samples/s | 97.8 steps/s
[Step=36950 Epoch=180.2] | Loss=0.01005 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.955 | L2-Norm(final)=13.078 | 2574.7 samples/s | 40.2 steps/s
[Step=37000 Epoch=180.4] | Loss=0.00954 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.960 | L2-Norm(final)=13.082 | 4760.8 samples/s | 74.4 steps/s
[Step=37050 Epoch=180.7] | Loss=0.00921 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.964 | L2-Norm(final)=13.086 | 4777.5 samples/s | 74.6 steps/s
[Step=37100 Epoch=180.9] | Loss=0.00875 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.968 | L2-Norm(final)=13.090 | 5678.0 samples/s | 88.7 steps/s
[Step=37150 Epoch=181.2] | Loss=0.00834 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.972 | L2-Norm(final)=13.093 | 2669.8 samples/s | 41.7 steps/s
[Step=37200 Epoch=181.4] | Loss=0.00807 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=13.097 | 4804.5 samples/s | 75.1 steps/s
[Step=37250 Epoch=181.6] | Loss=0.00777 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.101 | 4798.8 samples/s | 75.0 steps/s
[Step=37300 Epoch=181.9] | Loss=0.00755 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.983 | L2-Norm(final)=13.104 | 5183.7 samples/s | 81.0 steps/s
[Step=37350 Epoch=182.1] | Loss=0.00730 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.986 | L2-Norm(final)=13.108 | 2783.7 samples/s | 43.5 steps/s
[Step=37400 Epoch=182.4] | Loss=0.00717 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.989 | L2-Norm(final)=13.111 | 4738.9 samples/s | 74.0 steps/s
[Step=37450 Epoch=182.6] | Loss=0.00699 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.992 | L2-Norm(final)=13.114 | 4888.7 samples/s | 76.4 steps/s
[Step=37500 Epoch=182.9] | Loss=0.00680 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.996 | L2-Norm(final)=13.118 | 4805.7 samples/s | 75.1 steps/s
[Step=37550 Epoch=183.1] | Loss=0.00663 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.999 | L2-Norm(final)=13.121 | 2882.2 samples/s | 45.0 steps/s
[Step=37600 Epoch=183.3] | Loss=0.00649 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.001 | L2-Norm(final)=13.124 | 4747.0 samples/s | 74.2 steps/s
[Step=37650 Epoch=183.6] | Loss=0.00636 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.004 | L2-Norm(final)=13.127 | 4748.4 samples/s | 74.2 steps/s
[Step=37700 Epoch=183.8] | Loss=0.00623 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.007 | L2-Norm(final)=13.130 | 4753.8 samples/s | 74.3 steps/s
[Step=37750 Epoch=184.1] | Loss=0.00610 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=13.133 | 2987.9 samples/s | 46.7 steps/s
[Step=37800 Epoch=184.3] | Loss=0.00596 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.013 | L2-Norm(final)=13.136 | 4674.2 samples/s | 73.0 steps/s
[Step=37850 Epoch=184.6] | Loss=0.00589 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=13.139 | 4780.9 samples/s | 74.7 steps/s
[Step=37900 Epoch=184.8] | Loss=0.00578 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.018 | L2-Norm(final)=13.142 | 4771.6 samples/s | 74.6 steps/s
[Step=37950 Epoch=185.1] | Loss=0.00568 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.020 | L2-Norm(final)=13.144 | 2962.3 samples/s | 46.3 steps/s
[Step=38000 Epoch=185.3] | Loss=0.00556 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=13.147 | 4846.7 samples/s | 75.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step38000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=42001 Epoch=204.9] | Loss=0.02473 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.900 | L2-Norm(final)=14.851 | 7117.5 samples/s | 111.2 steps/s
[Step=42050 Epoch=205.2] | Loss=0.01893 | Reg=0.00098 | acc=0.9531 | L2-Norm=9.901 | L2-Norm(final)=14.852 | 4861.1 samples/s | 76.0 steps/s
[Step=42100 Epoch=205.4] | Loss=0.01569 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.853 | 5545.9 samples/s | 86.7 steps/s
[Step=42150 Epoch=205.7] | Loss=0.01605 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.901 | L2-Norm(final)=14.855 | 5540.0 samples/s | 86.6 steps/s
[Step=42200 Epoch=205.9] | Loss=0.01561 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.901 | L2-Norm(final)=14.857 | 8751.6 samples/s | 136.7 steps/s
[Step=42250 Epoch=206.2] | Loss=0.01547 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.860 | 2659.4 samples/s | 41.6 steps/s
[Step=42300 Epoch=206.4] | Loss=0.01508 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.901 | L2-Norm(final)=14.863 | 5570.7 samples/s | 87.0 steps/s
[Step=42350 Epoch=206.6] | Loss=0.01557 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.901 | L2-Norm(final)=14.865 | 5672.3 samples/s | 88.6 steps/s
[Step=42400 Epoch=206.9] | Loss=0.01565 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.868 | 7737.0 samples/s | 120.9 steps/s
[Step=42450 Epoch=207.1] | Loss=0.01575 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.901 | L2-Norm(final)=14.870 | 2753.5 samples/s | 43.0 steps/s
[Step=42500 Epoch=207.4] | Loss=0.01584 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.872 | 5584.5 samples/s | 87.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=207.4] | Loss=0.01335 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.901 | L2-Norm(final)=14.892 | 7345.9 samples/s | 114.8 steps/s
[Step=42550 Epoch=207.6] | Loss=0.01755 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.908 | L2-Norm(final)=14.892 | 4258.8 samples/s | 66.5 steps/s
[Step=42600 Epoch=207.9] | Loss=0.01446 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.916 | L2-Norm(final)=14.895 | 4707.6 samples/s | 73.6 steps/s
[Step=42650 Epoch=208.1] | Loss=0.01434 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.923 | L2-Norm(final)=14.897 | 4804.9 samples/s | 75.1 steps/s
[Step=42700 Epoch=208.4] | Loss=0.01326 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.929 | L2-Norm(final)=14.900 | 6803.8 samples/s | 106.3 steps/s
[Step=42750 Epoch=208.6] | Loss=0.01158 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.935 | L2-Norm(final)=14.903 | 2460.7 samples/s | 38.4 steps/s
[Step=42800 Epoch=208.8] | Loss=0.01049 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.940 | L2-Norm(final)=14.906 | 4786.3 samples/s | 74.8 steps/s
[Step=42850 Epoch=209.1] | Loss=0.00966 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.944 | L2-Norm(final)=14.909 | 4728.5 samples/s | 73.9 steps/s
[Step=42900 Epoch=209.3] | Loss=0.00915 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.949 | L2-Norm(final)=14.912 | 6349.0 samples/s | 99.2 steps/s
[Step=42950 Epoch=209.6] | Loss=0.00851 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.952 | L2-Norm(final)=14.915 | 2531.5 samples/s | 39.6 steps/s
[Step=43000 Epoch=209.8] | Loss=0.00804 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.956 | L2-Norm(final)=14.918 | 4791.5 samples/s | 74.9 steps/s
[Step=43050 Epoch=210.1] | Loss=0.00767 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.959 | L2-Norm(final)=14.921 | 4760.7 samples/s | 74.4 steps/s
[Step=43100 Epoch=210.3] | Loss=0.00731 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.962 | L2-Norm(final)=14.924 | 5932.7 samples/s | 92.7 steps/s
[Step=43150 Epoch=210.6] | Loss=0.00702 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.965 | L2-Norm(final)=14.927 | 2626.9 samples/s | 41.0 steps/s
[Step=43200 Epoch=210.8] | Loss=0.00672 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.968 | L2-Norm(final)=14.930 | 4738.1 samples/s | 74.0 steps/s
[Step=43250 Epoch=211.0] | Loss=0.00647 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.971 | L2-Norm(final)=14.932 | 4864.8 samples/s | 76.0 steps/s
[Step=43300 Epoch=211.3] | Loss=0.00627 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.974 | L2-Norm(final)=14.935 | 5381.3 samples/s | 84.1 steps/s
[Step=43350 Epoch=211.5] | Loss=0.00608 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=14.938 | 2706.5 samples/s | 42.3 steps/s
[Step=43400 Epoch=211.8] | Loss=0.00585 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=14.940 | 4771.1 samples/s | 74.5 steps/s
[Step=43450 Epoch=212.0] | Loss=0.00574 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.981 | L2-Norm(final)=14.943 | 4781.5 samples/s | 74.7 steps/s
[Step=43500 Epoch=212.3] | Loss=0.00563 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.984 | L2-Norm(final)=14.945 | 5142.2 samples/s | 80.3 steps/s
[Step=43550 Epoch=212.5] | Loss=0.00545 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.986 | L2-Norm(final)=14.948 | 2824.0 samples/s | 44.1 steps/s
[Step=43600 Epoch=212.7] | Loss=0.00535 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.988 | L2-Norm(final)=14.950 | 4679.9 samples/s | 73.1 steps/s
[Step=43650 Epoch=213.0] | Loss=0.00523 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.990 | L2-Norm(final)=14.952 | 4757.1 samples/s | 74.3 steps/s
[Step=43700 Epoch=213.2] | Loss=0.00512 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.992 | L2-Norm(final)=14.955 | 4874.3 samples/s | 76.2 steps/s
[Step=43750 Epoch=213.5] | Loss=0.00504 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.994 | L2-Norm(final)=14.957 | 2908.0 samples/s | 45.4 steps/s
[Step=43800 Epoch=213.7] | Loss=0.00493 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.997 | L2-Norm(final)=14.959 | 4722.8 samples/s | 73.8 steps/s
[Step=43850 Epoch=214.0] | Loss=0.00484 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.998 | L2-Norm(final)=14.962 | 4780.3 samples/s | 74.7 steps/s
[Step=43900 Epoch=214.2] | Loss=0.00477 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.000 | L2-Norm(final)=14.964 | 4686.6 samples/s | 73.2 steps/s
[Step=43950 Epoch=214.5] | Loss=0.00469 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.002 | L2-Norm(final)=14.966 | 2905.8 samples/s | 45.4 steps/s
[Step=44000 Epoch=214.7] | Loss=0.00460 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.004 | L2-Norm(final)=14.968 | 4781.5 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step44000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=36001 Epoch=176.5] | Loss=0.00211 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=14.614 | 6818.5 samples/s | 106.5 steps/s
[Step=36050 Epoch=176.8] | Loss=0.01817 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.616 | 4846.7 samples/s | 75.7 steps/s
[Step=36100 Epoch=177.0] | Loss=0.01764 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.619 | 5431.8 samples/s | 84.9 steps/s
[Step=36150 Epoch=177.3] | Loss=0.01796 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.901 | L2-Norm(final)=14.623 | 5549.9 samples/s | 86.7 steps/s
[Step=36200 Epoch=177.5] | Loss=0.01741 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.901 | L2-Norm(final)=14.626 | 8936.6 samples/s | 139.6 steps/s
[Step=36250 Epoch=177.8] | Loss=0.01681 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.630 | 2660.4 samples/s | 41.6 steps/s
[Step=36300 Epoch=178.0] | Loss=0.01688 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.901 | L2-Norm(final)=14.633 | 5485.7 samples/s | 85.7 steps/s
[Step=36350 Epoch=178.3] | Loss=0.01699 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.636 | 5516.9 samples/s | 86.2 steps/s
[Step=36400 Epoch=178.5] | Loss=0.01722 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.901 | L2-Norm(final)=14.640 | 8105.3 samples/s | 126.6 steps/s
[Step=36450 Epoch=178.7] | Loss=0.01718 | Reg=0.00098 | acc=0.9531 | L2-Norm=9.901 | L2-Norm(final)=14.642 | 2709.2 samples/s | 42.3 steps/s
[Step=36500 Epoch=179.0] | Loss=0.01690 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=14.645 | 5520.5 samples/s | 86.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=36501 Epoch=179.0] | Loss=0.02284 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.901 | L2-Norm(final)=14.673 | 7454.7 samples/s | 116.5 steps/s
[Step=36550 Epoch=179.2] | Loss=0.01843 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.906 | L2-Norm(final)=14.674 | 4215.2 samples/s | 65.9 steps/s
[Step=36600 Epoch=179.5] | Loss=0.01735 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.913 | L2-Norm(final)=14.675 | 4694.2 samples/s | 73.3 steps/s
[Step=36650 Epoch=179.7] | Loss=0.01557 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.920 | L2-Norm(final)=14.677 | 4816.4 samples/s | 75.3 steps/s
[Step=36700 Epoch=180.0] | Loss=0.01474 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.925 | L2-Norm(final)=14.679 | 6970.9 samples/s | 108.9 steps/s
[Step=36750 Epoch=180.2] | Loss=0.01293 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.931 | L2-Norm(final)=14.682 | 2460.8 samples/s | 38.4 steps/s
[Step=36800 Epoch=180.5] | Loss=0.01153 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.936 | L2-Norm(final)=14.686 | 4733.4 samples/s | 74.0 steps/s
[Step=36850 Epoch=180.7] | Loss=0.01067 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.941 | L2-Norm(final)=14.689 | 4803.1 samples/s | 75.0 steps/s
[Step=36900 Epoch=181.0] | Loss=0.00992 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.945 | L2-Norm(final)=14.693 | 6521.3 samples/s | 101.9 steps/s
[Step=36950 Epoch=181.2] | Loss=0.00920 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.949 | L2-Norm(final)=14.696 | 2539.0 samples/s | 39.7 steps/s
[Step=37000 Epoch=181.4] | Loss=0.00867 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.953 | L2-Norm(final)=14.699 | 4745.2 samples/s | 74.1 steps/s
[Step=37050 Epoch=181.7] | Loss=0.00821 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.956 | L2-Norm(final)=14.703 | 4668.3 samples/s | 72.9 steps/s
[Step=37100 Epoch=181.9] | Loss=0.00795 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.960 | L2-Norm(final)=14.706 | 6196.0 samples/s | 96.8 steps/s
[Step=37150 Epoch=182.2] | Loss=0.00759 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.963 | L2-Norm(final)=14.709 | 2566.9 samples/s | 40.1 steps/s
[Step=37200 Epoch=182.4] | Loss=0.00726 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.966 | L2-Norm(final)=14.712 | 4760.3 samples/s | 74.4 steps/s
[Step=37250 Epoch=182.7] | Loss=0.00701 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.969 | L2-Norm(final)=14.716 | 4746.6 samples/s | 74.2 steps/s
[Step=37300 Epoch=182.9] | Loss=0.00672 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.972 | L2-Norm(final)=14.719 | 5778.4 samples/s | 90.3 steps/s
[Step=37350 Epoch=183.2] | Loss=0.00650 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.975 | L2-Norm(final)=14.722 | 2608.2 samples/s | 40.8 steps/s
[Step=37400 Epoch=183.4] | Loss=0.00626 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.978 | L2-Norm(final)=14.725 | 4766.9 samples/s | 74.5 steps/s
[Step=37450 Epoch=183.6] | Loss=0.00607 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.980 | L2-Norm(final)=14.728 | 4746.8 samples/s | 74.2 steps/s
[Step=37500 Epoch=183.9] | Loss=0.00595 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.983 | L2-Norm(final)=14.731 | 5558.5 samples/s | 86.9 steps/s
[Step=37550 Epoch=184.1] | Loss=0.00578 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.986 | L2-Norm(final)=14.733 | 2678.5 samples/s | 41.9 steps/s
[Step=37600 Epoch=184.4] | Loss=0.00563 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.988 | L2-Norm(final)=14.736 | 4773.7 samples/s | 74.6 steps/s
[Step=37650 Epoch=184.6] | Loss=0.00547 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.990 | L2-Norm(final)=14.739 | 4738.0 samples/s | 74.0 steps/s
[Step=37700 Epoch=184.9] | Loss=0.00540 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.993 | L2-Norm(final)=14.742 | 5262.9 samples/s | 82.2 steps/s
[Step=37750 Epoch=185.1] | Loss=0.00525 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.995 | L2-Norm(final)=14.745 | 2773.3 samples/s | 43.3 steps/s
[Step=37800 Epoch=185.4] | Loss=0.00513 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.997 | L2-Norm(final)=14.747 | 4822.0 samples/s | 75.3 steps/s
[Step=37850 Epoch=185.6] | Loss=0.00503 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.000 | L2-Norm(final)=14.750 | 4783.5 samples/s | 74.7 steps/s
[Step=37900 Epoch=185.9] | Loss=0.00496 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.002 | L2-Norm(final)=14.753 | 4871.1 samples/s | 76.1 steps/s
[Step=37950 Epoch=186.1] | Loss=0.00486 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.004 | L2-Norm(final)=14.755 | 2850.1 samples/s | 44.5 steps/s
[Step=38000 Epoch=186.3] | Loss=0.00477 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.006 | L2-Norm(final)=14.758 | 4878.9 samples/s | 76.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step38000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=42001 Epoch=395.8] | Loss=0.00080 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=16.000 | 6487.1 samples/s | 101.4 steps/s
[Step=42050 Epoch=396.2] | Loss=0.00062 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.003 | 4844.7 samples/s | 75.7 steps/s
[Step=42100 Epoch=396.7] | Loss=0.00051 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.009 | 8111.9 samples/s | 126.7 steps/s
[Step=42150 Epoch=397.2] | Loss=0.00054 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.014 | 2594.1 samples/s | 40.5 steps/s
[Step=42200 Epoch=397.6] | Loss=0.00051 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.019 | 7113.2 samples/s | 111.1 steps/s
[Step=42250 Epoch=398.1] | Loss=0.00053 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.024 | 2610.7 samples/s | 40.8 steps/s
[Step=42300 Epoch=398.6] | Loss=0.00051 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.028 | 6090.1 samples/s | 95.2 steps/s
[Step=42350 Epoch=399.1] | Loss=0.00051 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.033 | 2896.5 samples/s | 45.3 steps/s
[Step=42400 Epoch=399.5] | Loss=0.00051 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.037 | 5460.7 samples/s | 85.3 steps/s
[Step=42450 Epoch=400.0] | Loss=0.00049 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.041 | 2993.1 samples/s | 46.8 steps/s
[Step=42500 Epoch=400.5] | Loss=0.00050 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.045 | 5203.3 samples/s | 81.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=400.5] | Loss=0.00012 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.086 | 6734.5 samples/s | 105.2 steps/s
[Step=42550 Epoch=400.9] | Loss=0.00017 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=16.088 | 4156.8 samples/s | 65.0 steps/s
[Step=42600 Epoch=401.4] | Loss=0.00015 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=16.090 | 6528.0 samples/s | 102.0 steps/s
[Step=42650 Epoch=401.9] | Loss=0.00011 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=16.091 | 2414.3 samples/s | 37.7 steps/s
[Step=42700 Epoch=402.4] | Loss=0.00009 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.896 | L2-Norm(final)=16.093 | 5807.3 samples/s | 90.7 steps/s
[Step=42750 Epoch=402.8] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.892 | L2-Norm(final)=16.093 | 2537.0 samples/s | 39.6 steps/s
[Step=42800 Epoch=403.3] | Loss=0.00006 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=16.094 | 5173.9 samples/s | 80.8 steps/s
[Step=42850 Epoch=403.8] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=16.095 | 2677.4 samples/s | 41.8 steps/s
[Step=42900 Epoch=404.2] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=16.095 | 4679.9 samples/s | 73.1 steps/s
[Step=42950 Epoch=404.7] | Loss=0.00004 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.878 | L2-Norm(final)=16.095 | 2788.1 samples/s | 43.6 steps/s
[Step=43000 Epoch=405.2] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=16.096 | 4533.5 samples/s | 70.8 steps/s
[Step=43050 Epoch=405.7] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.870 | L2-Norm(final)=16.096 | 2839.0 samples/s | 44.4 steps/s
[Step=43100 Epoch=406.1] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.866 | L2-Norm(final)=16.096 | 4555.5 samples/s | 71.2 steps/s
[Step=43150 Epoch=406.6] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.861 | L2-Norm(final)=16.097 | 2853.7 samples/s | 44.6 steps/s
[Step=43200 Epoch=407.1] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.857 | L2-Norm(final)=16.097 | 4511.9 samples/s | 70.5 steps/s
[Step=43250 Epoch=407.5] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.853 | L2-Norm(final)=16.097 | 3086.3 samples/s | 48.2 steps/s
[Step=43300 Epoch=408.0] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.849 | L2-Norm(final)=16.098 | 4077.1 samples/s | 63.7 steps/s
[Step=43350 Epoch=408.5] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.844 | L2-Norm(final)=16.098 | 6576.7 samples/s | 102.8 steps/s
[Step=43400 Epoch=409.0] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=16.098 | 2404.3 samples/s | 37.6 steps/s
[Step=43450 Epoch=409.4] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.835 | L2-Norm(final)=16.098 | 5878.9 samples/s | 91.9 steps/s
[Step=43500 Epoch=409.9] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.831 | L2-Norm(final)=16.099 | 2496.7 samples/s | 39.0 steps/s
[Step=43550 Epoch=410.4] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=16.099 | 5340.2 samples/s | 83.4 steps/s
[Step=43600 Epoch=410.8] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.822 | L2-Norm(final)=16.099 | 2626.4 samples/s | 41.0 steps/s
[Step=43650 Epoch=411.3] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.817 | L2-Norm(final)=16.099 | 4835.0 samples/s | 75.5 steps/s
[Step=43700 Epoch=411.8] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.812 | L2-Norm(final)=16.100 | 2722.9 samples/s | 42.5 steps/s
[Step=43750 Epoch=412.2] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.807 | L2-Norm(final)=16.100 | 4585.1 samples/s | 71.6 steps/s
[Step=43800 Epoch=412.7] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=16.100 | 2838.5 samples/s | 44.4 steps/s
[Step=43850 Epoch=413.2] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.798 | L2-Norm(final)=16.100 | 4560.6 samples/s | 71.3 steps/s
[Step=43900 Epoch=413.7] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.793 | L2-Norm(final)=16.101 | 2880.9 samples/s | 45.0 steps/s
[Step=43950 Epoch=414.1] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.788 | L2-Norm(final)=16.101 | 4476.2 samples/s | 69.9 steps/s
[Step=44000 Epoch=414.6] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.783 | L2-Norm(final)=16.101 | 3214.7 samples/s | 50.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step44000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=42001 Epoch=400.3] | Loss=0.00114 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=16.881 | 7083.9 samples/s | 110.7 steps/s
[Step=42050 Epoch=400.8] | Loss=0.00087 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=16.886 | 4519.4 samples/s | 70.6 steps/s
[Step=42100 Epoch=401.3] | Loss=0.00119 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=16.891 | 8222.7 samples/s | 128.5 steps/s
[Step=42150 Epoch=401.7] | Loss=0.00116 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=16.896 | 2555.2 samples/s | 39.9 steps/s
[Step=42200 Epoch=402.2] | Loss=0.00119 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=16.901 | 7704.1 samples/s | 120.4 steps/s
[Step=42250 Epoch=402.7] | Loss=0.00113 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.906 | 2615.1 samples/s | 40.9 steps/s
[Step=42300 Epoch=403.2] | Loss=0.00119 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.910 | 6894.5 samples/s | 107.7 steps/s
[Step=42350 Epoch=403.6] | Loss=0.00123 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.915 | 2807.4 samples/s | 43.9 steps/s
[Step=42400 Epoch=404.1] | Loss=0.00119 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.919 | 5946.7 samples/s | 92.9 steps/s
[Step=42450 Epoch=404.6] | Loss=0.00117 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.924 | 2803.0 samples/s | 43.8 steps/s
[Step=42500 Epoch=405.1] | Loss=0.00115 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.928 | 5823.2 samples/s | 91.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=405.1] | Loss=0.00468 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=16.966 | 7199.5 samples/s | 112.5 steps/s
[Step=42550 Epoch=405.5] | Loss=0.00058 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.907 | L2-Norm(final)=16.968 | 3962.6 samples/s | 61.9 steps/s
[Step=42600 Epoch=406.0] | Loss=0.00036 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.909 | L2-Norm(final)=16.969 | 6631.0 samples/s | 103.6 steps/s
[Step=42650 Epoch=406.5] | Loss=0.00026 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.910 | L2-Norm(final)=16.969 | 2366.6 samples/s | 37.0 steps/s
[Step=42700 Epoch=407.0] | Loss=0.00020 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.910 | L2-Norm(final)=16.970 | 6130.2 samples/s | 95.8 steps/s
[Step=42750 Epoch=407.4] | Loss=0.00017 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.909 | L2-Norm(final)=16.970 | 2447.9 samples/s | 38.2 steps/s
[Step=42800 Epoch=407.9] | Loss=0.00014 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.907 | L2-Norm(final)=16.971 | 5703.0 samples/s | 89.1 steps/s
[Step=42850 Epoch=408.4] | Loss=0.00012 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=16.971 | 2517.3 samples/s | 39.3 steps/s
[Step=42900 Epoch=408.9] | Loss=0.00011 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=16.971 | 5299.4 samples/s | 82.8 steps/s
[Step=42950 Epoch=409.4] | Loss=0.00010 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.902 | L2-Norm(final)=16.972 | 2631.2 samples/s | 41.1 steps/s
[Step=43000 Epoch=409.8] | Loss=0.00009 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=16.972 | 4841.2 samples/s | 75.6 steps/s
[Step=43050 Epoch=410.3] | Loss=0.00008 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=16.972 | 2694.8 samples/s | 42.1 steps/s
[Step=43100 Epoch=410.8] | Loss=0.00008 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.896 | L2-Norm(final)=16.972 | 4656.1 samples/s | 72.8 steps/s
[Step=43150 Epoch=411.3] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.894 | L2-Norm(final)=16.973 | 2818.3 samples/s | 44.0 steps/s
[Step=43200 Epoch=411.7] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.892 | L2-Norm(final)=16.973 | 4526.2 samples/s | 70.7 steps/s
[Step=43250 Epoch=412.2] | Loss=0.00006 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=16.973 | 2854.8 samples/s | 44.6 steps/s
[Step=43300 Epoch=412.7] | Loss=0.00006 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.887 | L2-Norm(final)=16.973 | 4654.6 samples/s | 72.7 steps/s
[Step=43350 Epoch=413.2] | Loss=0.00006 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=16.973 | 2858.9 samples/s | 44.7 steps/s
[Step=43400 Epoch=413.6] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=16.974 | 4518.0 samples/s | 70.6 steps/s
[Step=43450 Epoch=414.1] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.880 | L2-Norm(final)=16.974 | 2967.0 samples/s | 46.4 steps/s
[Step=43500 Epoch=414.6] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=16.974 | 4168.8 samples/s | 65.1 steps/s
[Step=43550 Epoch=415.1] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=16.974 | 7367.5 samples/s | 115.1 steps/s
[Step=43600 Epoch=415.5] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.872 | L2-Norm(final)=16.974 | 2309.8 samples/s | 36.1 steps/s
[Step=43650 Epoch=416.0] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.869 | L2-Norm(final)=16.975 | 6616.5 samples/s | 103.4 steps/s
[Step=43700 Epoch=416.5] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.867 | L2-Norm(final)=16.975 | 2385.8 samples/s | 37.3 steps/s
[Step=43750 Epoch=417.0] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.864 | L2-Norm(final)=16.975 | 6050.5 samples/s | 94.5 steps/s
[Step=43800 Epoch=417.5] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.861 | L2-Norm(final)=16.975 | 2444.1 samples/s | 38.2 steps/s
[Step=43850 Epoch=417.9] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.858 | L2-Norm(final)=16.975 | 5659.2 samples/s | 88.4 steps/s
[Step=43900 Epoch=418.4] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.855 | L2-Norm(final)=16.975 | 2522.0 samples/s | 39.4 steps/s
[Step=43950 Epoch=418.9] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.852 | L2-Norm(final)=16.976 | 5285.6 samples/s | 82.6 steps/s
[Step=44000 Epoch=419.4] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.849 | L2-Norm(final)=16.976 | 2655.2 samples/s | 41.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step44000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07939 | acc=0.9640 | tpr=0.9692 | fpr=0.0473 | 5815.1 samples/s | 22.7 steps/s
Avg test loss: 0.08427, Avg test acc: 0.96222, Avg tpr: 0.96748, Avg fpr: 0.04935, total FA: 385

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08376 | acc=0.9634 | tpr=0.9738 | fpr=0.0592 | 5820.8 samples/s | 22.7 steps/s
Avg test loss: 0.08813, Avg test acc: 0.96210, Avg tpr: 0.97208, Avg fpr: 0.05986, total FA: 467

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09224 | acc=0.9628 | tpr=0.9787 | fpr=0.0716 | 5850.4 samples/s | 22.9 steps/s
Avg test loss: 0.09533, Avg test acc: 0.96097, Avg tpr: 0.97575, Avg fpr: 0.07153, total FA: 558

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08728 | acc=0.9617 | tpr=0.9700 | fpr=0.0562 | 6025.5 samples/s | 23.5 steps/s
Avg test loss: 0.09207, Avg test acc: 0.96077, Avg tpr: 0.96917, Avg fpr: 0.05768, total FA: 450

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08399 | acc=0.9630 | tpr=0.9742 | fpr=0.0614 | 5934.3 samples/s | 23.2 steps/s
Avg test loss: 0.08714, Avg test acc: 0.96218, Avg tpr: 0.97255, Avg fpr: 0.06063, total FA: 473

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.22356 | acc=0.2743 | tpr=0.0203 | fpr=0.1742 | 5869.5 samples/s | 22.9 steps/s
Avg test loss: 6.22949, Avg test acc: 0.27326, Avg tpr: 0.01923, Avg fpr: 0.16806, total FA: 1311

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.57198 | acc=0.3013 | tpr=0.0251 | fpr=0.0991 | 5916.1 samples/s | 23.1 steps/s
Avg test loss: 4.58208, Avg test acc: 0.29918, Avg tpr: 0.02500, Avg fpr: 0.09781, total FA: 763

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.04505 | acc=0.2930 | tpr=0.0210 | fpr=0.1162 | 6063.5 samples/s | 23.7 steps/s
Avg test loss: 5.05229, Avg test acc: 0.29089, Avg tpr: 0.01976, Avg fpr: 0.11281, total FA: 880

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.20468 | acc=0.2738 | tpr=0.0237 | fpr=0.1831 | 6171.1 samples/s | 24.1 steps/s
Avg test loss: 5.20674, Avg test acc: 0.27298, Avg tpr: 0.02326, Avg fpr: 0.17780, total FA: 1387

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.60923 | acc=0.2880 | tpr=0.0209 | fpr=0.1318 | 5646.5 samples/s | 22.1 steps/s
Avg test loss: 4.62293, Avg test acc: 0.28768, Avg tpr: 0.02133, Avg fpr: 0.12652, total FA: 987

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.93688 | acc=0.1327 | tpr=0.5664 | fpr=0.8751 | 5970.5 samples/s | 23.3 steps/s
[Step= 100] | Loss=4.92326 | acc=0.1349 | tpr=0.5608 | fpr=0.8731 | 7860.8 samples/s | 30.7 steps/s
[Step= 150] | Loss=4.91295 | acc=0.1373 | tpr=0.5764 | fpr=0.8708 | 7549.2 samples/s | 29.5 steps/s
[Step= 200] | Loss=4.90233 | acc=0.1379 | tpr=0.5661 | fpr=0.8699 | 8434.9 samples/s | 32.9 steps/s
[Step= 250] | Loss=4.90758 | acc=0.1378 | tpr=0.5572 | fpr=0.8698 | 8222.6 samples/s | 32.1 steps/s
[Step= 300] | Loss=4.90194 | acc=0.1379 | tpr=0.5484 | fpr=0.8696 | 8221.5 samples/s | 32.1 steps/s
[Step= 350] | Loss=4.90725 | acc=0.1382 | tpr=0.5479 | fpr=0.8693 | 8388.4 samples/s | 32.8 steps/s
[Step= 400] | Loss=4.90502 | acc=0.1386 | tpr=0.5476 | fpr=0.8689 | 7220.5 samples/s | 28.2 steps/s
[Step= 450] | Loss=4.90963 | acc=0.1381 | tpr=0.5526 | fpr=0.8694 | 8191.4 samples/s | 32.0 steps/s
[Step= 500] | Loss=4.90945 | acc=0.1379 | tpr=0.5559 | fpr=0.8697 | 8282.0 samples/s | 32.4 steps/s
[Step= 550] | Loss=4.91256 | acc=0.1379 | tpr=0.5555 | fpr=0.8697 | 9669.2 samples/s | 37.8 steps/s
Avg test loss: 4.91287, Avg test acc: 0.13781, Avg tpr: 0.55626, Avg fpr: 0.86979, total FA: 120769

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.01031 | acc=0.1327 | tpr=0.5442 | fpr=0.8747 | 6155.8 samples/s | 24.0 steps/s
[Step= 100] | Loss=5.00042 | acc=0.1359 | tpr=0.5565 | fpr=0.8720 | 7464.9 samples/s | 29.2 steps/s
[Step= 150] | Loss=4.98739 | acc=0.1394 | tpr=0.5865 | fpr=0.8688 | 7977.1 samples/s | 31.2 steps/s
[Step= 200] | Loss=4.97858 | acc=0.1400 | tpr=0.5836 | fpr=0.8681 | 8458.0 samples/s | 33.0 steps/s
[Step= 250] | Loss=4.98273 | acc=0.1394 | tpr=0.5790 | fpr=0.8686 | 7300.6 samples/s | 28.5 steps/s
[Step= 300] | Loss=4.97866 | acc=0.1387 | tpr=0.5731 | fpr=0.8692 | 7998.5 samples/s | 31.2 steps/s
[Step= 350] | Loss=4.98383 | acc=0.1385 | tpr=0.5679 | fpr=0.8693 | 8297.1 samples/s | 32.4 steps/s
[Step= 400] | Loss=4.98161 | acc=0.1387 | tpr=0.5684 | fpr=0.8691 | 7960.7 samples/s | 31.1 steps/s
[Step= 450] | Loss=4.98538 | acc=0.1382 | tpr=0.5750 | fpr=0.8698 | 7901.7 samples/s | 30.9 steps/s
[Step= 500] | Loss=4.98622 | acc=0.1381 | tpr=0.5775 | fpr=0.8699 | 7933.3 samples/s | 31.0 steps/s
[Step= 550] | Loss=4.98975 | acc=0.1382 | tpr=0.5778 | fpr=0.8698 | 12134.3 samples/s | 47.4 steps/s
Avg test loss: 4.99019, Avg test acc: 0.13813, Avg tpr: 0.57845, Avg fpr: 0.86987, total FA: 120780

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.30580 | acc=0.1205 | tpr=0.6460 | fpr=0.8889 | 5976.2 samples/s | 23.3 steps/s
[Step= 100] | Loss=5.29587 | acc=0.1221 | tpr=0.6397 | fpr=0.8876 | 8064.7 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.28653 | acc=0.1238 | tpr=0.6484 | fpr=0.8858 | 8078.0 samples/s | 31.6 steps/s
[Step= 200] | Loss=5.27791 | acc=0.1240 | tpr=0.6361 | fpr=0.8854 | 8133.8 samples/s | 31.8 steps/s
[Step= 250] | Loss=5.28441 | acc=0.1241 | tpr=0.6314 | fpr=0.8852 | 7726.2 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.28069 | acc=0.1239 | tpr=0.6269 | fpr=0.8853 | 8017.8 samples/s | 31.3 steps/s
[Step= 350] | Loss=5.28648 | acc=0.1239 | tpr=0.6255 | fpr=0.8852 | 8681.2 samples/s | 33.9 steps/s
[Step= 400] | Loss=5.28547 | acc=0.1240 | tpr=0.6253 | fpr=0.8851 | 7732.2 samples/s | 30.2 steps/s
[Step= 450] | Loss=5.29084 | acc=0.1234 | tpr=0.6261 | fpr=0.8857 | 7956.3 samples/s | 31.1 steps/s
[Step= 500] | Loss=5.29038 | acc=0.1233 | tpr=0.6273 | fpr=0.8858 | 8172.4 samples/s | 31.9 steps/s
[Step= 550] | Loss=5.29362 | acc=0.1234 | tpr=0.6291 | fpr=0.8858 | 9535.2 samples/s | 37.2 steps/s
Avg test loss: 5.29407, Avg test acc: 0.12333, Avg tpr: 0.63035, Avg fpr: 0.88589, total FA: 123004

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.94780 | acc=0.1384 | tpr=0.6195 | fpr=0.8702 | 6202.7 samples/s | 24.2 steps/s
[Step= 100] | Loss=4.93897 | acc=0.1408 | tpr=0.6055 | fpr=0.8679 | 7722.8 samples/s | 30.2 steps/s
[Step= 150] | Loss=4.92659 | acc=0.1426 | tpr=0.6167 | fpr=0.8661 | 8075.8 samples/s | 31.5 steps/s
[Step= 200] | Loss=4.91760 | acc=0.1432 | tpr=0.6164 | fpr=0.8654 | 7842.4 samples/s | 30.6 steps/s
[Step= 250] | Loss=4.92030 | acc=0.1430 | tpr=0.6105 | fpr=0.8656 | 7805.9 samples/s | 30.5 steps/s
[Step= 300] | Loss=4.91626 | acc=0.1426 | tpr=0.6044 | fpr=0.8658 | 8022.7 samples/s | 31.3 steps/s
[Step= 350] | Loss=4.92154 | acc=0.1426 | tpr=0.6036 | fpr=0.8658 | 7342.4 samples/s | 28.7 steps/s
[Step= 400] | Loss=4.91928 | acc=0.1428 | tpr=0.6045 | fpr=0.8656 | 8391.8 samples/s | 32.8 steps/s
[Step= 450] | Loss=4.92420 | acc=0.1420 | tpr=0.6076 | fpr=0.8664 | 8245.8 samples/s | 32.2 steps/s
[Step= 500] | Loss=4.92313 | acc=0.1423 | tpr=0.6106 | fpr=0.8662 | 7714.1 samples/s | 30.1 steps/s
[Step= 550] | Loss=4.92762 | acc=0.1423 | tpr=0.6116 | fpr=0.8663 | 11491.9 samples/s | 44.9 steps/s
Avg test loss: 4.92822, Avg test acc: 0.14222, Avg tpr: 0.61292, Avg fpr: 0.86634, total FA: 120289

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.01770 | acc=0.1368 | tpr=0.5044 | fpr=0.8698 | 6057.9 samples/s | 23.7 steps/s
[Step= 100] | Loss=5.00636 | acc=0.1383 | tpr=0.4904 | fpr=0.8683 | 7444.3 samples/s | 29.1 steps/s
[Step= 150] | Loss=4.99483 | acc=0.1402 | tpr=0.5043 | fpr=0.8665 | 7713.4 samples/s | 30.1 steps/s
[Step= 200] | Loss=4.98745 | acc=0.1411 | tpr=0.4995 | fpr=0.8655 | 8062.2 samples/s | 31.5 steps/s
[Step= 250] | Loss=4.99216 | acc=0.1408 | tpr=0.4882 | fpr=0.8655 | 7946.4 samples/s | 31.0 steps/s
[Step= 300] | Loss=4.98884 | acc=0.1406 | tpr=0.4822 | fpr=0.8656 | 8209.4 samples/s | 32.1 steps/s
[Step= 350] | Loss=4.99544 | acc=0.1405 | tpr=0.4828 | fpr=0.8657 | 7765.5 samples/s | 30.3 steps/s
[Step= 400] | Loss=4.99245 | acc=0.1407 | tpr=0.4858 | fpr=0.8656 | 8050.3 samples/s | 31.4 steps/s
[Step= 450] | Loss=4.99694 | acc=0.1401 | tpr=0.4903 | fpr=0.8662 | 7626.8 samples/s | 29.8 steps/s
[Step= 500] | Loss=4.99651 | acc=0.1401 | tpr=0.4916 | fpr=0.8662 | 8005.8 samples/s | 31.3 steps/s
[Step= 550] | Loss=4.99960 | acc=0.1402 | tpr=0.4914 | fpr=0.8662 | 12453.5 samples/s | 48.6 steps/s
Avg test loss: 5.00022, Avg test acc: 0.14013, Avg tpr: 0.49208, Avg fpr: 0.86627, total FA: 120280

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.21976 | acc=0.9595 | tpr=0.9513 | fpr=0.0404 | 6003.0 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.22823 | acc=0.9584 | tpr=0.9574 | fpr=0.0416 | 8122.0 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.23035 | acc=0.9570 | tpr=0.9553 | fpr=0.0429 | 7300.4 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.23058 | acc=0.9570 | tpr=0.9585 | fpr=0.0430 | 8052.3 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.23040 | acc=0.9570 | tpr=0.9563 | fpr=0.0430 | 8195.0 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.23398 | acc=0.9565 | tpr=0.9542 | fpr=0.0434 | 8452.0 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.23214 | acc=0.9568 | tpr=0.9537 | fpr=0.0432 | 8409.1 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.23197 | acc=0.9564 | tpr=0.9513 | fpr=0.0435 | 7866.0 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.23555 | acc=0.9559 | tpr=0.9499 | fpr=0.0440 | 7761.5 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.23593 | acc=0.9557 | tpr=0.9515 | fpr=0.0442 | 8115.0 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.23459 | acc=0.9561 | tpr=0.9522 | fpr=0.0439 | 9698.5 samples/s | 37.9 steps/s
Avg test loss: 0.23428, Avg test acc: 0.95607, Avg tpr: 0.95206, Avg fpr: 0.04385, total FA: 6089

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16790 | acc=0.9590 | tpr=0.9336 | fpr=0.0406 | 6076.8 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.17162 | acc=0.9582 | tpr=0.9382 | fpr=0.0414 | 7532.9 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.17518 | acc=0.9563 | tpr=0.9409 | fpr=0.0434 | 8008.6 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.17543 | acc=0.9566 | tpr=0.9454 | fpr=0.0432 | 8054.8 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.17601 | acc=0.9566 | tpr=0.9432 | fpr=0.0432 | 7997.4 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.17846 | acc=0.9562 | tpr=0.9425 | fpr=0.0435 | 7528.8 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.17756 | acc=0.9563 | tpr=0.9430 | fpr=0.0434 | 8153.2 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.17815 | acc=0.9560 | tpr=0.9404 | fpr=0.0437 | 7602.1 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.18098 | acc=0.9555 | tpr=0.9391 | fpr=0.0442 | 8042.2 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.18071 | acc=0.9554 | tpr=0.9410 | fpr=0.0443 | 7715.9 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.17955 | acc=0.9557 | tpr=0.9411 | fpr=0.0441 | 12400.6 samples/s | 48.4 steps/s
Avg test loss: 0.17937, Avg test acc: 0.95566, Avg tpr: 0.94097, Avg fpr: 0.04407, total FA: 6119

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26662 | acc=0.9491 | tpr=0.9558 | fpr=0.0511 | 5729.1 samples/s | 22.4 steps/s
[Step= 100] | Loss=0.27413 | acc=0.9481 | tpr=0.9638 | fpr=0.0522 | 8323.5 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.27870 | acc=0.9470 | tpr=0.9625 | fpr=0.0533 | 7871.0 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.27858 | acc=0.9474 | tpr=0.9639 | fpr=0.0529 | 8017.3 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.27885 | acc=0.9472 | tpr=0.9633 | fpr=0.0531 | 8298.1 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.28173 | acc=0.9469 | tpr=0.9600 | fpr=0.0533 | 8058.8 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.27989 | acc=0.9471 | tpr=0.9593 | fpr=0.0531 | 8141.7 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.28028 | acc=0.9466 | tpr=0.9562 | fpr=0.0535 | 7416.9 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.28407 | acc=0.9463 | tpr=0.9542 | fpr=0.0538 | 8427.2 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.28464 | acc=0.9463 | tpr=0.9555 | fpr=0.0539 | 8496.0 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.28276 | acc=0.9466 | tpr=0.9562 | fpr=0.0536 | 9592.9 samples/s | 37.5 steps/s
Avg test loss: 0.28250, Avg test acc: 0.94658, Avg tpr: 0.95602, Avg fpr: 0.05359, total FA: 7441

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15514 | acc=0.9648 | tpr=0.9469 | fpr=0.0348 | 5893.2 samples/s | 23.0 steps/s
[Step= 100] | Loss=0.16185 | acc=0.9634 | tpr=0.9488 | fpr=0.0363 | 8156.5 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.16287 | acc=0.9617 | tpr=0.9452 | fpr=0.0380 | 8116.8 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.16314 | acc=0.9618 | tpr=0.9508 | fpr=0.0380 | 8298.0 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.16287 | acc=0.9618 | tpr=0.9493 | fpr=0.0380 | 7188.6 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.16591 | acc=0.9614 | tpr=0.9476 | fpr=0.0383 | 7936.2 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.16453 | acc=0.9615 | tpr=0.9468 | fpr=0.0383 | 8026.0 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.16437 | acc=0.9612 | tpr=0.9447 | fpr=0.0385 | 7934.7 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.16674 | acc=0.9608 | tpr=0.9445 | fpr=0.0389 | 8201.9 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.16678 | acc=0.9607 | tpr=0.9463 | fpr=0.0390 | 8025.8 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.16589 | acc=0.9610 | tpr=0.9471 | fpr=0.0388 | 11341.0 samples/s | 44.3 steps/s
Avg test loss: 0.16565, Avg test acc: 0.96098, Avg tpr: 0.94691, Avg fpr: 0.03876, total FA: 5382

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21924 | acc=0.9563 | tpr=0.9381 | fpr=0.0433 | 6110.4 samples/s | 23.9 steps/s
[Step= 100] | Loss=0.22834 | acc=0.9550 | tpr=0.9488 | fpr=0.0449 | 7657.9 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.23156 | acc=0.9537 | tpr=0.9539 | fpr=0.0463 | 7691.2 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.23192 | acc=0.9537 | tpr=0.9563 | fpr=0.0464 | 8207.1 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.23240 | acc=0.9537 | tpr=0.9555 | fpr=0.0463 | 8569.8 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.23600 | acc=0.9532 | tpr=0.9513 | fpr=0.0468 | 8205.5 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.23459 | acc=0.9531 | tpr=0.9512 | fpr=0.0468 | 7914.2 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.23495 | acc=0.9527 | tpr=0.9486 | fpr=0.0472 | 7453.3 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.23836 | acc=0.9522 | tpr=0.9484 | fpr=0.0477 | 8885.3 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.23834 | acc=0.9521 | tpr=0.9485 | fpr=0.0478 | 7018.1 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.23675 | acc=0.9525 | tpr=0.9491 | fpr=0.0475 | 11226.9 samples/s | 43.9 steps/s
Avg test loss: 0.23653, Avg test acc: 0.95249, Avg tpr: 0.94889, Avg fpr: 0.04745, total FA: 6588

server round 41/50

clients selected: [0 1 3 4 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=38001 Epoch=185.3] | Loss=0.00850 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=13.232 | 6843.8 samples/s | 106.9 steps/s
[Step=38050 Epoch=185.5] | Loss=0.02479 | Reg=0.00097 | acc=0.9531 | L2-Norm=9.826 | L2-Norm(final)=13.233 | 5077.8 samples/s | 79.3 steps/s
[Step=38100 Epoch=185.8] | Loss=0.02190 | Reg=0.00097 | acc=0.9375 | L2-Norm=9.827 | L2-Norm(final)=13.235 | 5598.6 samples/s | 87.5 steps/s
[Step=38150 Epoch=186.0] | Loss=0.02026 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.827 | L2-Norm(final)=13.238 | 5465.0 samples/s | 85.4 steps/s
[Step=38200 Epoch=186.3] | Loss=0.02024 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.827 | L2-Norm(final)=13.241 | 8653.7 samples/s | 135.2 steps/s
[Step=38250 Epoch=186.5] | Loss=0.02101 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.827 | L2-Norm(final)=13.243 | 2678.1 samples/s | 41.8 steps/s
[Step=38300 Epoch=186.8] | Loss=0.02059 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.827 | L2-Norm(final)=13.244 | 5660.6 samples/s | 88.4 steps/s
[Step=38350 Epoch=187.0] | Loss=0.02062 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.827 | L2-Norm(final)=13.246 | 5438.0 samples/s | 85.0 steps/s
[Step=38400 Epoch=187.2] | Loss=0.02058 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.827 | L2-Norm(final)=13.248 | 7615.4 samples/s | 119.0 steps/s
[Step=38450 Epoch=187.5] | Loss=0.02072 | Reg=0.00097 | acc=0.9531 | L2-Norm=9.827 | L2-Norm(final)=13.250 | 2777.7 samples/s | 43.4 steps/s
[Step=38500 Epoch=187.7] | Loss=0.02086 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.827 | L2-Norm(final)=13.252 | 5699.2 samples/s | 89.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=38501 Epoch=187.7] | Loss=0.01859 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.827 | L2-Norm(final)=13.268 | 6949.1 samples/s | 108.6 steps/s
[Step=38550 Epoch=188.0] | Loss=0.01940 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.836 | L2-Norm(final)=13.269 | 4338.2 samples/s | 67.8 steps/s
[Step=38600 Epoch=188.2] | Loss=0.01850 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.844 | L2-Norm(final)=13.271 | 4829.8 samples/s | 75.5 steps/s
[Step=38650 Epoch=188.5] | Loss=0.01680 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.851 | L2-Norm(final)=13.273 | 4658.8 samples/s | 72.8 steps/s
[Step=38700 Epoch=188.7] | Loss=0.01573 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.858 | L2-Norm(final)=13.276 | 6868.1 samples/s | 107.3 steps/s
[Step=38750 Epoch=189.0] | Loss=0.01389 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.863 | L2-Norm(final)=13.280 | 2485.6 samples/s | 38.8 steps/s
[Step=38800 Epoch=189.2] | Loss=0.01246 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.869 | L2-Norm(final)=13.283 | 4886.0 samples/s | 76.3 steps/s
[Step=38850 Epoch=189.4] | Loss=0.01175 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=13.287 | 4637.3 samples/s | 72.5 steps/s
[Step=38900 Epoch=189.7] | Loss=0.01102 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.878 | L2-Norm(final)=13.291 | 6239.6 samples/s | 97.5 steps/s
[Step=38950 Epoch=189.9] | Loss=0.01023 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.883 | L2-Norm(final)=13.295 | 2578.6 samples/s | 40.3 steps/s
[Step=39000 Epoch=190.2] | Loss=0.00965 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.887 | L2-Norm(final)=13.298 | 4827.7 samples/s | 75.4 steps/s
[Step=39050 Epoch=190.4] | Loss=0.00917 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.891 | L2-Norm(final)=13.302 | 4651.9 samples/s | 72.7 steps/s
[Step=39100 Epoch=190.7] | Loss=0.00891 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.895 | L2-Norm(final)=13.306 | 5720.9 samples/s | 89.4 steps/s
[Step=39150 Epoch=190.9] | Loss=0.00848 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=13.309 | 2657.8 samples/s | 41.5 steps/s
[Step=39200 Epoch=191.1] | Loss=0.00815 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.903 | L2-Norm(final)=13.313 | 4739.7 samples/s | 74.1 steps/s
[Step=39250 Epoch=191.4] | Loss=0.00786 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.906 | L2-Norm(final)=13.316 | 4739.1 samples/s | 74.0 steps/s
[Step=39300 Epoch=191.6] | Loss=0.00773 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.910 | L2-Norm(final)=13.320 | 5289.5 samples/s | 82.6 steps/s
[Step=39350 Epoch=191.9] | Loss=0.00745 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.913 | L2-Norm(final)=13.323 | 2795.9 samples/s | 43.7 steps/s
[Step=39400 Epoch=192.1] | Loss=0.00717 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.916 | L2-Norm(final)=13.326 | 4743.1 samples/s | 74.1 steps/s
[Step=39450 Epoch=192.4] | Loss=0.00698 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.919 | L2-Norm(final)=13.330 | 4752.6 samples/s | 74.3 steps/s
[Step=39500 Epoch=192.6] | Loss=0.00690 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.922 | L2-Norm(final)=13.333 | 4882.7 samples/s | 76.3 steps/s
[Step=39550 Epoch=192.9] | Loss=0.00676 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.925 | L2-Norm(final)=13.336 | 2888.8 samples/s | 45.1 steps/s
[Step=39600 Epoch=193.1] | Loss=0.00661 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.928 | L2-Norm(final)=13.339 | 4749.6 samples/s | 74.2 steps/s
[Step=39650 Epoch=193.3] | Loss=0.00647 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.931 | L2-Norm(final)=13.342 | 4807.7 samples/s | 75.1 steps/s
[Step=39700 Epoch=193.6] | Loss=0.00633 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.934 | L2-Norm(final)=13.345 | 4682.0 samples/s | 73.2 steps/s
[Step=39750 Epoch=193.8] | Loss=0.00623 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.936 | L2-Norm(final)=13.348 | 2984.6 samples/s | 46.6 steps/s
[Step=39800 Epoch=194.1] | Loss=0.00608 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.939 | L2-Norm(final)=13.351 | 4643.1 samples/s | 72.5 steps/s
[Step=39850 Epoch=194.3] | Loss=0.00595 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.941 | L2-Norm(final)=13.354 | 4816.2 samples/s | 75.3 steps/s
[Step=39900 Epoch=194.6] | Loss=0.00589 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.944 | L2-Norm(final)=13.356 | 4709.7 samples/s | 73.6 steps/s
[Step=39950 Epoch=194.8] | Loss=0.00582 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.946 | L2-Norm(final)=13.359 | 2964.9 samples/s | 46.3 steps/s
[Step=40000 Epoch=195.0] | Loss=0.00574 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.949 | L2-Norm(final)=13.362 | 4739.5 samples/s | 74.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step40000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=44001 Epoch=214.7] | Loss=0.01166 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=15.033 | 7169.3 samples/s | 112.0 steps/s
[Step=44050 Epoch=214.9] | Loss=0.01669 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=15.034 | 5173.9 samples/s | 80.8 steps/s
[Step=44100 Epoch=215.2] | Loss=0.01562 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=15.036 | 5536.8 samples/s | 86.5 steps/s
[Step=44150 Epoch=215.4] | Loss=0.01574 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=15.038 | 5580.1 samples/s | 87.2 steps/s
[Step=44200 Epoch=215.7] | Loss=0.01631 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=15.040 | 8705.1 samples/s | 136.0 steps/s
[Step=44250 Epoch=215.9] | Loss=0.01651 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=15.041 | 2652.4 samples/s | 41.4 steps/s
[Step=44300 Epoch=216.2] | Loss=0.01654 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=15.044 | 5638.6 samples/s | 88.1 steps/s
[Step=44350 Epoch=216.4] | Loss=0.01658 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=15.045 | 5395.6 samples/s | 84.3 steps/s
[Step=44400 Epoch=216.7] | Loss=0.01629 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=15.047 | 7914.4 samples/s | 123.7 steps/s
[Step=44450 Epoch=216.9] | Loss=0.01638 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=15.049 | 2745.3 samples/s | 42.9 steps/s
[Step=44500 Epoch=217.1] | Loss=0.01630 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=15.050 | 5512.8 samples/s | 86.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=217.1] | Loss=0.01483 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=15.065 | 6813.1 samples/s | 106.5 steps/s
[Step=44550 Epoch=217.4] | Loss=0.01570 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.836 | L2-Norm(final)=15.067 | 4329.8 samples/s | 67.7 steps/s
[Step=44600 Epoch=217.6] | Loss=0.01562 | Reg=0.00097 | acc=0.9531 | L2-Norm=9.845 | L2-Norm(final)=15.069 | 4754.9 samples/s | 74.3 steps/s
[Step=44650 Epoch=217.9] | Loss=0.01447 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.852 | L2-Norm(final)=15.070 | 4847.3 samples/s | 75.7 steps/s
[Step=44700 Epoch=218.1] | Loss=0.01297 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.858 | L2-Norm(final)=15.073 | 6734.1 samples/s | 105.2 steps/s
[Step=44750 Epoch=218.4] | Loss=0.01121 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.863 | L2-Norm(final)=15.076 | 2456.4 samples/s | 38.4 steps/s
[Step=44800 Epoch=218.6] | Loss=0.01007 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.868 | L2-Norm(final)=15.079 | 4860.4 samples/s | 75.9 steps/s
[Step=44850 Epoch=218.8] | Loss=0.00924 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.872 | L2-Norm(final)=15.082 | 4775.3 samples/s | 74.6 steps/s
[Step=44900 Epoch=219.1] | Loss=0.00879 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.876 | L2-Norm(final)=15.085 | 6206.0 samples/s | 97.0 steps/s
[Step=44950 Epoch=219.3] | Loss=0.00818 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.880 | L2-Norm(final)=15.088 | 2532.6 samples/s | 39.6 steps/s
[Step=45000 Epoch=219.6] | Loss=0.00771 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.884 | L2-Norm(final)=15.091 | 4766.8 samples/s | 74.5 steps/s
[Step=45050 Epoch=219.8] | Loss=0.00731 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.887 | L2-Norm(final)=15.094 | 4697.6 samples/s | 73.4 steps/s
[Step=45100 Epoch=220.1] | Loss=0.00701 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.890 | L2-Norm(final)=15.097 | 5890.8 samples/s | 92.0 steps/s
[Step=45150 Epoch=220.3] | Loss=0.00685 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.893 | L2-Norm(final)=15.100 | 2614.5 samples/s | 40.9 steps/s
[Step=45200 Epoch=220.6] | Loss=0.00658 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.896 | L2-Norm(final)=15.103 | 4816.4 samples/s | 75.3 steps/s
[Step=45250 Epoch=220.8] | Loss=0.00631 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=15.105 | 4727.8 samples/s | 73.9 steps/s
[Step=45300 Epoch=221.0] | Loss=0.00608 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=15.108 | 5477.0 samples/s | 85.6 steps/s
[Step=45350 Epoch=221.3] | Loss=0.00591 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=15.111 | 2698.3 samples/s | 42.2 steps/s
[Step=45400 Epoch=221.5] | Loss=0.00570 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.907 | L2-Norm(final)=15.113 | 4841.0 samples/s | 75.6 steps/s
[Step=45450 Epoch=221.8] | Loss=0.00557 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.909 | L2-Norm(final)=15.116 | 4823.2 samples/s | 75.4 steps/s
[Step=45500 Epoch=222.0] | Loss=0.00550 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.911 | L2-Norm(final)=15.118 | 5044.9 samples/s | 78.8 steps/s
[Step=45550 Epoch=222.3] | Loss=0.00539 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.914 | L2-Norm(final)=15.121 | 2787.6 samples/s | 43.6 steps/s
[Step=45600 Epoch=222.5] | Loss=0.00528 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.916 | L2-Norm(final)=15.123 | 4738.5 samples/s | 74.0 steps/s
[Step=45650 Epoch=222.8] | Loss=0.00517 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.918 | L2-Norm(final)=15.125 | 4806.0 samples/s | 75.1 steps/s
[Step=45700 Epoch=223.0] | Loss=0.00504 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.920 | L2-Norm(final)=15.128 | 4860.6 samples/s | 75.9 steps/s
[Step=45750 Epoch=223.2] | Loss=0.00496 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.922 | L2-Norm(final)=15.130 | 2876.7 samples/s | 44.9 steps/s
[Step=45800 Epoch=223.5] | Loss=0.00484 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.925 | L2-Norm(final)=15.132 | 4752.1 samples/s | 74.3 steps/s
[Step=45850 Epoch=223.7] | Loss=0.00475 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.927 | L2-Norm(final)=15.134 | 4854.7 samples/s | 75.9 steps/s
[Step=45900 Epoch=224.0] | Loss=0.00465 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.929 | L2-Norm(final)=15.136 | 4702.9 samples/s | 73.5 steps/s
[Step=45950 Epoch=224.2] | Loss=0.00461 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.930 | L2-Norm(final)=15.139 | 2927.4 samples/s | 45.7 steps/s
[Step=46000 Epoch=224.5] | Loss=0.00454 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.932 | L2-Norm(final)=15.141 | 4776.0 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step46000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=30001 Epoch=146.3] | Loss=0.01265 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=14.005 | 8033.4 samples/s | 125.5 steps/s
[Step=30050 Epoch=146.5] | Loss=0.01390 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=14.008 | 4634.8 samples/s | 72.4 steps/s
[Step=30100 Epoch=146.8] | Loss=0.01470 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=14.012 | 5386.4 samples/s | 84.2 steps/s
[Step=30150 Epoch=147.0] | Loss=0.01531 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=14.014 | 5539.6 samples/s | 86.6 steps/s
[Step=30200 Epoch=147.3] | Loss=0.01619 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=14.015 | 8595.1 samples/s | 134.3 steps/s
[Step=30250 Epoch=147.5] | Loss=0.01587 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=14.017 | 2734.9 samples/s | 42.7 steps/s
[Step=30300 Epoch=147.8] | Loss=0.01584 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.826 | L2-Norm(final)=14.019 | 5421.3 samples/s | 84.7 steps/s
[Step=30350 Epoch=148.0] | Loss=0.01586 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=14.020 | 5583.7 samples/s | 87.2 steps/s
[Step=30400 Epoch=148.2] | Loss=0.01590 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=14.022 | 7431.9 samples/s | 116.1 steps/s
[Step=30450 Epoch=148.5] | Loss=0.01598 | Reg=0.00097 | acc=0.9531 | L2-Norm=9.826 | L2-Norm(final)=14.024 | 2776.3 samples/s | 43.4 steps/s
[Step=30500 Epoch=148.7] | Loss=0.01596 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=14.025 | 5757.0 samples/s | 90.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=30501 Epoch=148.7] | Loss=0.03066 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=14.043 | 6834.7 samples/s | 106.8 steps/s
[Step=30550 Epoch=149.0] | Loss=0.01707 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.834 | L2-Norm(final)=14.044 | 4393.0 samples/s | 68.6 steps/s
[Step=30600 Epoch=149.2] | Loss=0.01427 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.843 | L2-Norm(final)=14.046 | 4741.9 samples/s | 74.1 steps/s
[Step=30650 Epoch=149.5] | Loss=0.01294 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.851 | L2-Norm(final)=14.049 | 4756.1 samples/s | 74.3 steps/s
[Step=30700 Epoch=149.7] | Loss=0.01221 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.857 | L2-Norm(final)=14.052 | 6931.8 samples/s | 108.3 steps/s
[Step=30750 Epoch=150.0] | Loss=0.01088 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.864 | L2-Norm(final)=14.056 | 2475.0 samples/s | 38.7 steps/s
[Step=30800 Epoch=150.2] | Loss=0.00981 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.869 | L2-Norm(final)=14.059 | 4768.1 samples/s | 74.5 steps/s
[Step=30850 Epoch=150.4] | Loss=0.00914 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=14.063 | 4765.1 samples/s | 74.5 steps/s
[Step=30900 Epoch=150.7] | Loss=0.00861 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.879 | L2-Norm(final)=14.067 | 6234.1 samples/s | 97.4 steps/s
[Step=30950 Epoch=150.9] | Loss=0.00808 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.884 | L2-Norm(final)=14.070 | 2582.1 samples/s | 40.3 steps/s
[Step=31000 Epoch=151.2] | Loss=0.00764 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.888 | L2-Norm(final)=14.074 | 4771.8 samples/s | 74.6 steps/s
[Step=31050 Epoch=151.4] | Loss=0.00727 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.892 | L2-Norm(final)=14.077 | 4747.5 samples/s | 74.2 steps/s
[Step=31100 Epoch=151.7] | Loss=0.00704 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.896 | L2-Norm(final)=14.081 | 5692.4 samples/s | 88.9 steps/s
[Step=31150 Epoch=151.9] | Loss=0.00670 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=14.084 | 2673.4 samples/s | 41.8 steps/s
[Step=31200 Epoch=152.1] | Loss=0.00639 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.904 | L2-Norm(final)=14.088 | 4775.5 samples/s | 74.6 steps/s
[Step=31250 Epoch=152.4] | Loss=0.00615 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.907 | L2-Norm(final)=14.091 | 4773.0 samples/s | 74.6 steps/s
[Step=31300 Epoch=152.6] | Loss=0.00599 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.910 | L2-Norm(final)=14.094 | 5264.5 samples/s | 82.3 steps/s
[Step=31350 Epoch=152.9] | Loss=0.00589 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.914 | L2-Norm(final)=14.097 | 2581.6 samples/s | 40.3 steps/s
[Step=31400 Epoch=153.1] | Loss=0.00570 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.917 | L2-Norm(final)=14.100 | 4778.0 samples/s | 74.7 steps/s
[Step=31450 Epoch=153.4] | Loss=0.00553 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.920 | L2-Norm(final)=14.103 | 4729.0 samples/s | 73.9 steps/s
[Step=31500 Epoch=153.6] | Loss=0.00540 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.923 | L2-Norm(final)=14.107 | 4894.4 samples/s | 76.5 steps/s
[Step=31550 Epoch=153.9] | Loss=0.00526 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.926 | L2-Norm(final)=14.109 | 2914.6 samples/s | 45.5 steps/s
[Step=31600 Epoch=154.1] | Loss=0.00513 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.929 | L2-Norm(final)=14.112 | 4646.7 samples/s | 72.6 steps/s
[Step=31650 Epoch=154.3] | Loss=0.00505 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.932 | L2-Norm(final)=14.115 | 4759.4 samples/s | 74.4 steps/s
[Step=31700 Epoch=154.6] | Loss=0.00496 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.934 | L2-Norm(final)=14.118 | 4792.6 samples/s | 74.9 steps/s
[Step=31750 Epoch=154.8] | Loss=0.00487 | Reg=0.00099 | acc=0.9688 | L2-Norm=9.937 | L2-Norm(final)=14.121 | 2951.8 samples/s | 46.1 steps/s
[Step=31800 Epoch=155.1] | Loss=0.00478 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.939 | L2-Norm(final)=14.124 | 4740.9 samples/s | 74.1 steps/s
[Step=31850 Epoch=155.3] | Loss=0.00468 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.942 | L2-Norm(final)=14.126 | 4829.8 samples/s | 75.5 steps/s
[Step=31900 Epoch=155.6] | Loss=0.00463 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.944 | L2-Norm(final)=14.129 | 4675.3 samples/s | 73.1 steps/s
[Step=31950 Epoch=155.8] | Loss=0.00453 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.947 | L2-Norm(final)=14.132 | 2947.4 samples/s | 46.1 steps/s
[Step=32000 Epoch=156.0] | Loss=0.00443 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.949 | L2-Norm(final)=14.134 | 4791.4 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step32000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=38001 Epoch=186.4] | Loss=0.02166 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=14.836 | 7835.4 samples/s | 122.4 steps/s
[Step=38050 Epoch=186.6] | Loss=0.01752 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=14.838 | 4650.7 samples/s | 72.7 steps/s
[Step=38100 Epoch=186.8] | Loss=0.01778 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=14.840 | 5577.9 samples/s | 87.2 steps/s
[Step=38150 Epoch=187.1] | Loss=0.01779 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=14.841 | 5461.3 samples/s | 85.3 steps/s
[Step=38200 Epoch=187.3] | Loss=0.01797 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.826 | L2-Norm(final)=14.844 | 8973.5 samples/s | 140.2 steps/s
[Step=38250 Epoch=187.6] | Loss=0.01819 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=14.846 | 2641.5 samples/s | 41.3 steps/s
[Step=38300 Epoch=187.8] | Loss=0.01840 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=14.849 | 5536.1 samples/s | 86.5 steps/s
[Step=38350 Epoch=188.1] | Loss=0.01840 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=14.851 | 5581.3 samples/s | 87.2 steps/s
[Step=38400 Epoch=188.3] | Loss=0.01808 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=14.853 | 8063.3 samples/s | 126.0 steps/s
[Step=38450 Epoch=188.6] | Loss=0.01756 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=14.855 | 2716.0 samples/s | 42.4 steps/s
[Step=38500 Epoch=188.8] | Loss=0.01775 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=14.858 | 5553.9 samples/s | 86.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=38501 Epoch=188.8] | Loss=0.00867 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=14.879 | 7042.1 samples/s | 110.0 steps/s
[Step=38550 Epoch=189.0] | Loss=0.01747 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.832 | L2-Norm(final)=14.879 | 4343.4 samples/s | 67.9 steps/s
[Step=38600 Epoch=189.3] | Loss=0.01691 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.839 | L2-Norm(final)=14.880 | 4733.0 samples/s | 74.0 steps/s
[Step=38650 Epoch=189.5] | Loss=0.01582 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.846 | L2-Norm(final)=14.882 | 4777.2 samples/s | 74.6 steps/s
[Step=38700 Epoch=189.8] | Loss=0.01432 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.851 | L2-Norm(final)=14.884 | 6958.6 samples/s | 108.7 steps/s
[Step=38750 Epoch=190.0] | Loss=0.01273 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.856 | L2-Norm(final)=14.887 | 2431.8 samples/s | 38.0 steps/s
[Step=38800 Epoch=190.3] | Loss=0.01134 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.861 | L2-Norm(final)=14.889 | 4774.0 samples/s | 74.6 steps/s
[Step=38850 Epoch=190.5] | Loss=0.01053 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.866 | L2-Norm(final)=14.893 | 4820.3 samples/s | 75.3 steps/s
[Step=38900 Epoch=190.8] | Loss=0.00988 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.870 | L2-Norm(final)=14.896 | 6408.3 samples/s | 100.1 steps/s
[Step=38950 Epoch=191.0] | Loss=0.00918 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=14.899 | 2521.9 samples/s | 39.4 steps/s
[Step=39000 Epoch=191.2] | Loss=0.00862 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.878 | L2-Norm(final)=14.902 | 4817.0 samples/s | 75.3 steps/s
[Step=39050 Epoch=191.5] | Loss=0.00808 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.881 | L2-Norm(final)=14.905 | 4624.5 samples/s | 72.3 steps/s
[Step=39100 Epoch=191.7] | Loss=0.00777 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=14.909 | 6180.1 samples/s | 96.6 steps/s
[Step=39150 Epoch=192.0] | Loss=0.00746 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.888 | L2-Norm(final)=14.912 | 2578.9 samples/s | 40.3 steps/s
[Step=39200 Epoch=192.2] | Loss=0.00716 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.891 | L2-Norm(final)=14.915 | 4778.0 samples/s | 74.7 steps/s
[Step=39250 Epoch=192.5] | Loss=0.00695 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.894 | L2-Norm(final)=14.918 | 4727.4 samples/s | 73.9 steps/s
[Step=39300 Epoch=192.7] | Loss=0.00669 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.897 | L2-Norm(final)=14.921 | 5802.4 samples/s | 90.7 steps/s
[Step=39350 Epoch=193.0] | Loss=0.00648 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=14.923 | 2636.4 samples/s | 41.2 steps/s
[Step=39400 Epoch=193.2] | Loss=0.00624 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.903 | L2-Norm(final)=14.926 | 4772.6 samples/s | 74.6 steps/s
[Step=39450 Epoch=193.5] | Loss=0.00610 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=14.929 | 4809.6 samples/s | 75.1 steps/s
[Step=39500 Epoch=193.7] | Loss=0.00597 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.908 | L2-Norm(final)=14.932 | 5407.4 samples/s | 84.5 steps/s
[Step=39550 Epoch=193.9] | Loss=0.00580 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.911 | L2-Norm(final)=14.935 | 2698.7 samples/s | 42.2 steps/s
[Step=39600 Epoch=194.2] | Loss=0.00564 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.913 | L2-Norm(final)=14.937 | 4775.3 samples/s | 74.6 steps/s
[Step=39650 Epoch=194.4] | Loss=0.00551 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.916 | L2-Norm(final)=14.940 | 4734.3 samples/s | 74.0 steps/s
[Step=39700 Epoch=194.7] | Loss=0.00540 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.918 | L2-Norm(final)=14.943 | 5239.9 samples/s | 81.9 steps/s
[Step=39750 Epoch=194.9] | Loss=0.00529 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.920 | L2-Norm(final)=14.945 | 2774.8 samples/s | 43.4 steps/s
[Step=39800 Epoch=195.2] | Loss=0.00516 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.923 | L2-Norm(final)=14.948 | 4709.5 samples/s | 73.6 steps/s
[Step=39850 Epoch=195.4] | Loss=0.00510 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.925 | L2-Norm(final)=14.950 | 4778.7 samples/s | 74.7 steps/s
[Step=39900 Epoch=195.7] | Loss=0.00501 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.927 | L2-Norm(final)=14.953 | 4935.6 samples/s | 77.1 steps/s
[Step=39950 Epoch=195.9] | Loss=0.00494 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.929 | L2-Norm(final)=14.955 | 2841.1 samples/s | 44.4 steps/s
[Step=40000 Epoch=196.2] | Loss=0.00485 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.932 | L2-Norm(final)=14.958 | 4720.9 samples/s | 73.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step40000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=44001 Epoch=419.4] | Loss=0.00047 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=16.980 | 6597.4 samples/s | 103.1 steps/s
[Step=44050 Epoch=419.8] | Loss=0.00147 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.825 | L2-Norm(final)=16.985 | 4637.1 samples/s | 72.5 steps/s
[Step=44100 Epoch=420.3] | Loss=0.00131 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=16.992 | 8285.4 samples/s | 129.5 steps/s
[Step=44150 Epoch=420.8] | Loss=0.00145 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=16.999 | 2540.0 samples/s | 39.7 steps/s
[Step=44200 Epoch=421.3] | Loss=0.00129 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=17.005 | 7484.9 samples/s | 117.0 steps/s
[Step=44250 Epoch=421.7] | Loss=0.00124 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=17.010 | 2654.4 samples/s | 41.5 steps/s
[Step=44300 Epoch=422.2] | Loss=0.00123 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=17.016 | 6816.3 samples/s | 106.5 steps/s
[Step=44350 Epoch=422.7] | Loss=0.00126 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=17.021 | 2772.4 samples/s | 43.3 steps/s
[Step=44400 Epoch=423.2] | Loss=0.00127 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=17.026 | 6084.5 samples/s | 95.1 steps/s
[Step=44450 Epoch=423.6] | Loss=0.00127 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=17.031 | 2845.9 samples/s | 44.5 steps/s
[Step=44500 Epoch=424.1] | Loss=0.00128 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=17.035 | 5748.0 samples/s | 89.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=424.1] | Loss=0.00045 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=17.081 | 6912.3 samples/s | 108.0 steps/s
[Step=44550 Epoch=424.6] | Loss=0.00037 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.834 | L2-Norm(final)=17.083 | 4071.5 samples/s | 63.6 steps/s
[Step=44600 Epoch=425.1] | Loss=0.00022 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.837 | L2-Norm(final)=17.083 | 6678.3 samples/s | 104.3 steps/s
[Step=44650 Epoch=425.6] | Loss=0.00016 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.837 | L2-Norm(final)=17.084 | 2370.1 samples/s | 37.0 steps/s
[Step=44700 Epoch=426.0] | Loss=0.00012 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.836 | L2-Norm(final)=17.084 | 6134.9 samples/s | 95.9 steps/s
[Step=44750 Epoch=426.5] | Loss=0.00010 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.833 | L2-Norm(final)=17.085 | 2440.8 samples/s | 38.1 steps/s
[Step=44800 Epoch=427.0] | Loss=0.00009 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.831 | L2-Norm(final)=17.085 | 5710.8 samples/s | 89.2 steps/s
[Step=44850 Epoch=427.5] | Loss=0.00007 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.828 | L2-Norm(final)=17.085 | 2535.6 samples/s | 39.6 steps/s
[Step=44900 Epoch=427.9] | Loss=0.00007 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.825 | L2-Norm(final)=17.085 | 5210.3 samples/s | 81.4 steps/s
[Step=44950 Epoch=428.4] | Loss=0.00006 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.822 | L2-Norm(final)=17.086 | 2614.7 samples/s | 40.9 steps/s
[Step=45000 Epoch=428.9] | Loss=0.00005 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.819 | L2-Norm(final)=17.086 | 4891.9 samples/s | 76.4 steps/s
[Step=45050 Epoch=429.4] | Loss=0.00005 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=17.086 | 2702.5 samples/s | 42.2 steps/s
[Step=45100 Epoch=429.8] | Loss=0.00005 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.812 | L2-Norm(final)=17.086 | 4594.0 samples/s | 71.8 steps/s
[Step=45150 Epoch=430.3] | Loss=0.00004 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.808 | L2-Norm(final)=17.086 | 2816.1 samples/s | 44.0 steps/s
[Step=45200 Epoch=430.8] | Loss=0.00004 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.805 | L2-Norm(final)=17.087 | 4574.9 samples/s | 71.5 steps/s
[Step=45250 Epoch=431.3] | Loss=0.00004 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.801 | L2-Norm(final)=17.087 | 2833.0 samples/s | 44.3 steps/s
[Step=45300 Epoch=431.7] | Loss=0.00004 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.798 | L2-Norm(final)=17.087 | 4481.0 samples/s | 70.0 steps/s
[Step=45350 Epoch=432.2] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.794 | L2-Norm(final)=17.087 | 2850.9 samples/s | 44.5 steps/s
[Step=45400 Epoch=432.7] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.790 | L2-Norm(final)=17.087 | 4564.8 samples/s | 71.3 steps/s
[Step=45450 Epoch=433.2] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.786 | L2-Norm(final)=17.088 | 2865.4 samples/s | 44.8 steps/s
[Step=45500 Epoch=433.7] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.783 | L2-Norm(final)=17.088 | 4500.7 samples/s | 70.3 steps/s
[Step=45550 Epoch=434.1] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.779 | L2-Norm(final)=17.088 | 7333.1 samples/s | 114.6 steps/s
[Step=45600 Epoch=434.6] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.775 | L2-Norm(final)=17.088 | 2295.7 samples/s | 35.9 steps/s
[Step=45650 Epoch=435.1] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.771 | L2-Norm(final)=17.088 | 6637.9 samples/s | 103.7 steps/s
[Step=45700 Epoch=435.6] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=17.088 | 2402.1 samples/s | 37.5 steps/s
[Step=45750 Epoch=436.0] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.762 | L2-Norm(final)=17.088 | 6022.0 samples/s | 94.1 steps/s
[Step=45800 Epoch=436.5] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.758 | L2-Norm(final)=17.089 | 2453.5 samples/s | 38.3 steps/s
[Step=45850 Epoch=437.0] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.754 | L2-Norm(final)=17.089 | 5658.2 samples/s | 88.4 steps/s
[Step=45900 Epoch=437.5] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=17.089 | 2508.4 samples/s | 39.2 steps/s
[Step=45950 Epoch=437.9] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.745 | L2-Norm(final)=17.089 | 5276.0 samples/s | 82.4 steps/s
[Step=46000 Epoch=438.4] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.741 | L2-Norm(final)=17.089 | 2627.1 samples/s | 41.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step46000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07719 | acc=0.9641 | tpr=0.9733 | fpr=0.0560 | 5730.2 samples/s | 22.4 steps/s
Avg test loss: 0.08128, Avg test acc: 0.96270, Avg tpr: 0.97196, Avg fpr: 0.05768, total FA: 450

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08536 | acc=0.9633 | tpr=0.9742 | fpr=0.0605 | 6022.8 samples/s | 23.5 steps/s
Avg test loss: 0.08849, Avg test acc: 0.96190, Avg tpr: 0.97255, Avg fpr: 0.06153, total FA: 480

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09224 | acc=0.9628 | tpr=0.9787 | fpr=0.0716 | 6103.1 samples/s | 23.8 steps/s
Avg test loss: 0.09533, Avg test acc: 0.96097, Avg tpr: 0.97575, Avg fpr: 0.07153, total FA: 558

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08162 | acc=0.9627 | tpr=0.9746 | fpr=0.0629 | 5826.3 samples/s | 22.8 steps/s
Avg test loss: 0.08593, Avg test acc: 0.96190, Avg tpr: 0.97360, Avg fpr: 0.06384, total FA: 498

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08452 | acc=0.9630 | tpr=0.9739 | fpr=0.0605 | 5774.3 samples/s | 22.6 steps/s
Avg test loss: 0.08755, Avg test acc: 0.96210, Avg tpr: 0.97208, Avg fpr: 0.05986, total FA: 467

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.22356 | acc=0.2743 | tpr=0.0203 | fpr=0.1742 | 5950.8 samples/s | 23.2 steps/s
Avg test loss: 6.22949, Avg test acc: 0.27326, Avg tpr: 0.01923, Avg fpr: 0.16806, total FA: 1311

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.57198 | acc=0.3013 | tpr=0.0251 | fpr=0.0991 | 5967.4 samples/s | 23.3 steps/s
Avg test loss: 4.58208, Avg test acc: 0.29918, Avg tpr: 0.02500, Avg fpr: 0.09781, total FA: 763

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.04505 | acc=0.2930 | tpr=0.0210 | fpr=0.1162 | 6023.9 samples/s | 23.5 steps/s
Avg test loss: 5.05229, Avg test acc: 0.29089, Avg tpr: 0.01976, Avg fpr: 0.11281, total FA: 880

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.20468 | acc=0.2738 | tpr=0.0237 | fpr=0.1831 | 5769.2 samples/s | 22.5 steps/s
Avg test loss: 5.20674, Avg test acc: 0.27298, Avg tpr: 0.02326, Avg fpr: 0.17780, total FA: 1387

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.90266 | acc=0.2911 | tpr=0.0189 | fpr=0.1179 | 6172.3 samples/s | 24.1 steps/s
Avg test loss: 4.91703, Avg test acc: 0.29033, Avg tpr: 0.01883, Avg fpr: 0.11255, total FA: 878

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.92755 | acc=0.1268 | tpr=0.6062 | fpr=0.8818 | 6068.7 samples/s | 23.7 steps/s
[Step= 100] | Loss=4.91517 | acc=0.1282 | tpr=0.5885 | fpr=0.8804 | 7260.6 samples/s | 28.4 steps/s
[Step= 150] | Loss=4.90562 | acc=0.1304 | tpr=0.6009 | fpr=0.8782 | 7831.6 samples/s | 30.6 steps/s
[Step= 200] | Loss=4.89565 | acc=0.1306 | tpr=0.5902 | fpr=0.8778 | 7845.4 samples/s | 30.6 steps/s
[Step= 250] | Loss=4.90087 | acc=0.1303 | tpr=0.5817 | fpr=0.8780 | 8101.0 samples/s | 31.6 steps/s
[Step= 300] | Loss=4.89543 | acc=0.1299 | tpr=0.5716 | fpr=0.8781 | 8163.2 samples/s | 31.9 steps/s
[Step= 350] | Loss=4.90055 | acc=0.1303 | tpr=0.5698 | fpr=0.8777 | 7891.0 samples/s | 30.8 steps/s
[Step= 400] | Loss=4.89832 | acc=0.1306 | tpr=0.5700 | fpr=0.8774 | 7867.7 samples/s | 30.7 steps/s
[Step= 450] | Loss=4.90317 | acc=0.1302 | tpr=0.5740 | fpr=0.8779 | 6320.0 samples/s | 24.7 steps/s
[Step= 500] | Loss=4.90291 | acc=0.1301 | tpr=0.5775 | fpr=0.8780 | 8209.7 samples/s | 32.1 steps/s
[Step= 550] | Loss=4.90571 | acc=0.1301 | tpr=0.5770 | fpr=0.8780 | 11866.9 samples/s | 46.4 steps/s
Avg test loss: 4.90598, Avg test acc: 0.13000, Avg tpr: 0.57765, Avg fpr: 0.87814, total FA: 121928

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.01083 | acc=0.1315 | tpr=0.5708 | fpr=0.8764 | 6140.3 samples/s | 24.0 steps/s
[Step= 100] | Loss=5.00069 | acc=0.1349 | tpr=0.5693 | fpr=0.8732 | 7619.2 samples/s | 29.8 steps/s
[Step= 150] | Loss=4.99049 | acc=0.1377 | tpr=0.5922 | fpr=0.8707 | 8317.3 samples/s | 32.5 steps/s
[Step= 200] | Loss=4.98114 | acc=0.1383 | tpr=0.5891 | fpr=0.8699 | 7938.3 samples/s | 31.0 steps/s
[Step= 250] | Loss=4.98527 | acc=0.1379 | tpr=0.5808 | fpr=0.8702 | 8113.6 samples/s | 31.7 steps/s
[Step= 300] | Loss=4.98175 | acc=0.1373 | tpr=0.5731 | fpr=0.8707 | 8440.2 samples/s | 33.0 steps/s
[Step= 350] | Loss=4.98708 | acc=0.1370 | tpr=0.5679 | fpr=0.8709 | 7792.5 samples/s | 30.4 steps/s
[Step= 400] | Loss=4.98475 | acc=0.1372 | tpr=0.5678 | fpr=0.8706 | 8281.8 samples/s | 32.4 steps/s
[Step= 450] | Loss=4.98866 | acc=0.1367 | tpr=0.5735 | fpr=0.8712 | 5779.5 samples/s | 22.6 steps/s
[Step= 500] | Loss=4.98965 | acc=0.1365 | tpr=0.5762 | fpr=0.8714 | 7662.6 samples/s | 29.9 steps/s
[Step= 550] | Loss=4.99309 | acc=0.1367 | tpr=0.5782 | fpr=0.8713 | 10399.3 samples/s | 40.6 steps/s
Avg test loss: 4.99344, Avg test acc: 0.13658, Avg tpr: 0.57884, Avg fpr: 0.87146, total FA: 121000

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.30580 | acc=0.1205 | tpr=0.6460 | fpr=0.8889 | 6085.7 samples/s | 23.8 steps/s
[Step= 100] | Loss=5.29587 | acc=0.1221 | tpr=0.6397 | fpr=0.8876 | 7800.4 samples/s | 30.5 steps/s
[Step= 150] | Loss=5.28653 | acc=0.1238 | tpr=0.6484 | fpr=0.8858 | 7845.2 samples/s | 30.6 steps/s
[Step= 200] | Loss=5.27791 | acc=0.1240 | tpr=0.6361 | fpr=0.8854 | 7153.7 samples/s | 27.9 steps/s
[Step= 250] | Loss=5.28441 | acc=0.1241 | tpr=0.6314 | fpr=0.8852 | 8247.8 samples/s | 32.2 steps/s
[Step= 300] | Loss=5.28069 | acc=0.1239 | tpr=0.6269 | fpr=0.8853 | 8134.3 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.28648 | acc=0.1239 | tpr=0.6255 | fpr=0.8852 | 8038.6 samples/s | 31.4 steps/s
[Step= 400] | Loss=5.28547 | acc=0.1240 | tpr=0.6253 | fpr=0.8851 | 5821.5 samples/s | 22.7 steps/s
[Step= 450] | Loss=5.29084 | acc=0.1234 | tpr=0.6261 | fpr=0.8857 | 8147.9 samples/s | 31.8 steps/s
[Step= 500] | Loss=5.29038 | acc=0.1233 | tpr=0.6273 | fpr=0.8858 | 8244.3 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.29362 | acc=0.1234 | tpr=0.6291 | fpr=0.8858 | 11349.0 samples/s | 44.3 steps/s
Avg test loss: 5.29407, Avg test acc: 0.12333, Avg tpr: 0.63035, Avg fpr: 0.88589, total FA: 123004

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.96858 | acc=0.1317 | tpr=0.6460 | fpr=0.8775 | 5879.3 samples/s | 23.0 steps/s
[Step= 100] | Loss=4.95864 | acc=0.1351 | tpr=0.6418 | fpr=0.8744 | 7955.8 samples/s | 31.1 steps/s
[Step= 150] | Loss=4.94719 | acc=0.1370 | tpr=0.6527 | fpr=0.8725 | 7497.6 samples/s | 29.3 steps/s
[Step= 200] | Loss=4.93725 | acc=0.1377 | tpr=0.6514 | fpr=0.8717 | 8024.9 samples/s | 31.3 steps/s
[Step= 250] | Loss=4.94016 | acc=0.1374 | tpr=0.6419 | fpr=0.8718 | 8225.6 samples/s | 32.1 steps/s
[Step= 300] | Loss=4.93583 | acc=0.1370 | tpr=0.6349 | fpr=0.8721 | 8181.5 samples/s | 32.0 steps/s
[Step= 350] | Loss=4.94112 | acc=0.1369 | tpr=0.6343 | fpr=0.8721 | 7946.8 samples/s | 31.0 steps/s
[Step= 400] | Loss=4.93990 | acc=0.1374 | tpr=0.6362 | fpr=0.8717 | 6075.0 samples/s | 23.7 steps/s
[Step= 450] | Loss=4.94501 | acc=0.1365 | tpr=0.6383 | fpr=0.8726 | 7684.0 samples/s | 30.0 steps/s
[Step= 500] | Loss=4.94436 | acc=0.1364 | tpr=0.6405 | fpr=0.8727 | 7952.3 samples/s | 31.1 steps/s
[Step= 550] | Loss=4.94872 | acc=0.1363 | tpr=0.6415 | fpr=0.8729 | 11220.1 samples/s | 43.8 steps/s
Avg test loss: 4.94937, Avg test acc: 0.13621, Avg tpr: 0.64263, Avg fpr: 0.87300, total FA: 121214

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.97711 | acc=0.1332 | tpr=0.5177 | fpr=0.8737 | 6113.1 samples/s | 23.9 steps/s
[Step= 100] | Loss=4.96681 | acc=0.1348 | tpr=0.5053 | fpr=0.8721 | 7853.2 samples/s | 30.7 steps/s
[Step= 150] | Loss=4.95605 | acc=0.1369 | tpr=0.5202 | fpr=0.8701 | 7782.9 samples/s | 30.4 steps/s
[Step= 200] | Loss=4.94827 | acc=0.1382 | tpr=0.5115 | fpr=0.8686 | 7463.8 samples/s | 29.2 steps/s
[Step= 250] | Loss=4.95265 | acc=0.1380 | tpr=0.4996 | fpr=0.8686 | 8228.3 samples/s | 32.1 steps/s
[Step= 300] | Loss=4.94938 | acc=0.1378 | tpr=0.4909 | fpr=0.8686 | 8538.9 samples/s | 33.4 steps/s
[Step= 350] | Loss=4.95575 | acc=0.1376 | tpr=0.4890 | fpr=0.8688 | 7911.2 samples/s | 30.9 steps/s
[Step= 400] | Loss=4.95274 | acc=0.1378 | tpr=0.4902 | fpr=0.8686 | 5861.4 samples/s | 22.9 steps/s
[Step= 450] | Loss=4.95705 | acc=0.1371 | tpr=0.4932 | fpr=0.8694 | 8113.8 samples/s | 31.7 steps/s
[Step= 500] | Loss=4.95670 | acc=0.1372 | tpr=0.4943 | fpr=0.8693 | 8210.0 samples/s | 32.1 steps/s
[Step= 550] | Loss=4.95962 | acc=0.1373 | tpr=0.4930 | fpr=0.8691 | 9983.6 samples/s | 39.0 steps/s
Avg test loss: 4.96019, Avg test acc: 0.13722, Avg tpr: 0.49366, Avg fpr: 0.86926, total FA: 120695

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.21976 | acc=0.9595 | tpr=0.9513 | fpr=0.0404 | 6079.1 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.22823 | acc=0.9584 | tpr=0.9574 | fpr=0.0416 | 8035.9 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.23035 | acc=0.9570 | tpr=0.9553 | fpr=0.0429 | 7393.0 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.23058 | acc=0.9570 | tpr=0.9585 | fpr=0.0430 | 6843.5 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.23040 | acc=0.9570 | tpr=0.9563 | fpr=0.0430 | 8178.3 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.23398 | acc=0.9565 | tpr=0.9542 | fpr=0.0434 | 8337.2 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.23214 | acc=0.9568 | tpr=0.9537 | fpr=0.0432 | 7237.1 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.23197 | acc=0.9564 | tpr=0.9513 | fpr=0.0435 | 8122.7 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.23555 | acc=0.9559 | tpr=0.9499 | fpr=0.0440 | 7489.7 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.23593 | acc=0.9557 | tpr=0.9515 | fpr=0.0442 | 7905.2 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.23459 | acc=0.9561 | tpr=0.9522 | fpr=0.0439 | 10147.4 samples/s | 39.6 steps/s
Avg test loss: 0.23428, Avg test acc: 0.95607, Avg tpr: 0.95206, Avg fpr: 0.04385, total FA: 6089

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16790 | acc=0.9590 | tpr=0.9336 | fpr=0.0406 | 5937.0 samples/s | 23.2 steps/s
[Step= 100] | Loss=0.17162 | acc=0.9582 | tpr=0.9382 | fpr=0.0414 | 8170.2 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.17518 | acc=0.9563 | tpr=0.9409 | fpr=0.0434 | 7363.5 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.17543 | acc=0.9566 | tpr=0.9454 | fpr=0.0432 | 7869.3 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.17601 | acc=0.9566 | tpr=0.9432 | fpr=0.0432 | 8169.4 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.17846 | acc=0.9562 | tpr=0.9425 | fpr=0.0435 | 7837.2 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.17756 | acc=0.9563 | tpr=0.9430 | fpr=0.0434 | 5883.5 samples/s | 23.0 steps/s
[Step= 400] | Loss=0.17815 | acc=0.9560 | tpr=0.9404 | fpr=0.0437 | 8141.2 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.18098 | acc=0.9555 | tpr=0.9391 | fpr=0.0442 | 8115.7 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.18071 | acc=0.9554 | tpr=0.9410 | fpr=0.0443 | 8304.2 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.17955 | acc=0.9557 | tpr=0.9411 | fpr=0.0441 | 11034.5 samples/s | 43.1 steps/s
Avg test loss: 0.17937, Avg test acc: 0.95566, Avg tpr: 0.94097, Avg fpr: 0.04407, total FA: 6119

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26662 | acc=0.9491 | tpr=0.9558 | fpr=0.0511 | 6051.9 samples/s | 23.6 steps/s
[Step= 100] | Loss=0.27413 | acc=0.9481 | tpr=0.9638 | fpr=0.0522 | 8129.8 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.27870 | acc=0.9470 | tpr=0.9625 | fpr=0.0533 | 7134.2 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.27858 | acc=0.9474 | tpr=0.9639 | fpr=0.0529 | 8208.7 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.27885 | acc=0.9472 | tpr=0.9633 | fpr=0.0531 | 8443.1 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.28173 | acc=0.9469 | tpr=0.9600 | fpr=0.0533 | 8004.5 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.27989 | acc=0.9471 | tpr=0.9593 | fpr=0.0531 | 5796.2 samples/s | 22.6 steps/s
[Step= 400] | Loss=0.28028 | acc=0.9466 | tpr=0.9562 | fpr=0.0535 | 8088.0 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.28407 | acc=0.9463 | tpr=0.9542 | fpr=0.0538 | 8243.4 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.28464 | acc=0.9463 | tpr=0.9555 | fpr=0.0539 | 8330.8 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.28276 | acc=0.9466 | tpr=0.9562 | fpr=0.0536 | 9950.5 samples/s | 38.9 steps/s
Avg test loss: 0.28250, Avg test acc: 0.94658, Avg tpr: 0.95602, Avg fpr: 0.05359, total FA: 7441

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15514 | acc=0.9648 | tpr=0.9469 | fpr=0.0348 | 6078.2 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.16185 | acc=0.9634 | tpr=0.9488 | fpr=0.0363 | 7465.9 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.16287 | acc=0.9617 | tpr=0.9452 | fpr=0.0380 | 4591.7 samples/s | 17.9 steps/s
[Step= 200] | Loss=0.16314 | acc=0.9618 | tpr=0.9508 | fpr=0.0380 | 9327.3 samples/s | 36.4 steps/s
[Step= 250] | Loss=0.16287 | acc=0.9618 | tpr=0.9493 | fpr=0.0380 | 8805.7 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.16591 | acc=0.9614 | tpr=0.9476 | fpr=0.0383 | 5931.3 samples/s | 23.2 steps/s
[Step= 350] | Loss=0.16453 | acc=0.9615 | tpr=0.9468 | fpr=0.0383 | 8135.2 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.16437 | acc=0.9612 | tpr=0.9447 | fpr=0.0385 | 7840.8 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.16674 | acc=0.9608 | tpr=0.9445 | fpr=0.0389 | 7008.7 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.16678 | acc=0.9607 | tpr=0.9463 | fpr=0.0390 | 8205.3 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.16589 | acc=0.9610 | tpr=0.9471 | fpr=0.0388 | 11773.5 samples/s | 46.0 steps/s
Avg test loss: 0.16565, Avg test acc: 0.96098, Avg tpr: 0.94691, Avg fpr: 0.03876, total FA: 5382

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21562 | acc=0.9586 | tpr=0.9513 | fpr=0.0413 | 6009.9 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.22490 | acc=0.9569 | tpr=0.9574 | fpr=0.0431 | 8269.3 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.22815 | acc=0.9553 | tpr=0.9582 | fpr=0.0447 | 7454.7 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.22815 | acc=0.9552 | tpr=0.9596 | fpr=0.0449 | 8068.9 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.22848 | acc=0.9551 | tpr=0.9590 | fpr=0.0450 | 8296.9 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.23213 | acc=0.9546 | tpr=0.9549 | fpr=0.0454 | 5963.5 samples/s | 23.3 steps/s
[Step= 350] | Loss=0.23079 | acc=0.9546 | tpr=0.9549 | fpr=0.0454 | 7801.1 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.23106 | acc=0.9542 | tpr=0.9513 | fpr=0.0457 | 8231.2 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.23452 | acc=0.9537 | tpr=0.9508 | fpr=0.0462 | 8233.6 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.23454 | acc=0.9536 | tpr=0.9502 | fpr=0.0463 | 8013.3 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.23306 | acc=0.9539 | tpr=0.9507 | fpr=0.0460 | 9328.4 samples/s | 36.4 steps/s
Avg test loss: 0.23287, Avg test acc: 0.95393, Avg tpr: 0.95048, Avg fpr: 0.04601, total FA: 6388

server round 42/50

clients selected: [0 1 3 6 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=40001 Epoch=195.1] | Loss=0.01137 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=13.441 | 6506.0 samples/s | 101.7 steps/s
[Step=40050 Epoch=195.3] | Loss=0.02320 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=13.443 | 5381.5 samples/s | 84.1 steps/s
[Step=40100 Epoch=195.5] | Loss=0.02180 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=13.445 | 5561.6 samples/s | 86.9 steps/s
[Step=40150 Epoch=195.8] | Loss=0.02211 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=13.446 | 5477.5 samples/s | 85.6 steps/s
[Step=40200 Epoch=196.0] | Loss=0.02077 | Reg=0.00095 | acc=0.9531 | L2-Norm=9.768 | L2-Norm(final)=13.448 | 8530.0 samples/s | 133.3 steps/s
[Step=40250 Epoch=196.3] | Loss=0.02010 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.768 | L2-Norm(final)=13.451 | 2677.9 samples/s | 41.8 steps/s
[Step=40300 Epoch=196.5] | Loss=0.01982 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=13.453 | 5639.7 samples/s | 88.1 steps/s
[Step=40350 Epoch=196.8] | Loss=0.02041 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=13.455 | 5554.2 samples/s | 86.8 steps/s
[Step=40400 Epoch=197.0] | Loss=0.02054 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=13.457 | 7413.1 samples/s | 115.8 steps/s
[Step=40450 Epoch=197.2] | Loss=0.02058 | Reg=0.00095 | acc=0.9531 | L2-Norm=9.768 | L2-Norm(final)=13.459 | 2788.7 samples/s | 43.6 steps/s
[Step=40500 Epoch=197.5] | Loss=0.02079 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=13.461 | 5520.3 samples/s | 86.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=197.5] | Loss=0.01399 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=13.477 | 7162.4 samples/s | 111.9 steps/s
[Step=40550 Epoch=197.7] | Loss=0.02099 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.776 | L2-Norm(final)=13.477 | 4298.4 samples/s | 67.2 steps/s
[Step=40600 Epoch=198.0] | Loss=0.01888 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.784 | L2-Norm(final)=13.479 | 4786.2 samples/s | 74.8 steps/s
[Step=40650 Epoch=198.2] | Loss=0.01703 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.792 | L2-Norm(final)=13.481 | 4737.4 samples/s | 74.0 steps/s
[Step=40700 Epoch=198.5] | Loss=0.01572 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.798 | L2-Norm(final)=13.484 | 6716.4 samples/s | 104.9 steps/s
[Step=40750 Epoch=198.7] | Loss=0.01392 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.804 | L2-Norm(final)=13.488 | 2479.9 samples/s | 38.7 steps/s
[Step=40800 Epoch=198.9] | Loss=0.01277 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.810 | L2-Norm(final)=13.492 | 4778.9 samples/s | 74.7 steps/s
[Step=40850 Epoch=199.2] | Loss=0.01187 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=13.495 | 4781.3 samples/s | 74.7 steps/s
[Step=40900 Epoch=199.4] | Loss=0.01114 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.819 | L2-Norm(final)=13.499 | 6180.2 samples/s | 96.6 steps/s
[Step=40950 Epoch=199.7] | Loss=0.01042 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=13.503 | 2567.5 samples/s | 40.1 steps/s
[Step=41000 Epoch=199.9] | Loss=0.00984 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.828 | L2-Norm(final)=13.507 | 4713.4 samples/s | 73.6 steps/s
[Step=41050 Epoch=200.2] | Loss=0.00932 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.832 | L2-Norm(final)=13.510 | 4808.4 samples/s | 75.1 steps/s
[Step=41100 Epoch=200.4] | Loss=0.00894 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.836 | L2-Norm(final)=13.514 | 5666.2 samples/s | 88.5 steps/s
[Step=41150 Epoch=200.7] | Loss=0.00861 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.839 | L2-Norm(final)=13.517 | 2660.3 samples/s | 41.6 steps/s
[Step=41200 Epoch=200.9] | Loss=0.00827 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.843 | L2-Norm(final)=13.521 | 4765.9 samples/s | 74.5 steps/s
[Step=41250 Epoch=201.1] | Loss=0.00799 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.846 | L2-Norm(final)=13.524 | 4724.2 samples/s | 73.8 steps/s
[Step=41300 Epoch=201.4] | Loss=0.00777 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.850 | L2-Norm(final)=13.528 | 5326.3 samples/s | 83.2 steps/s
[Step=41350 Epoch=201.6] | Loss=0.00757 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.853 | L2-Norm(final)=13.531 | 2788.5 samples/s | 43.6 steps/s
[Step=41400 Epoch=201.9] | Loss=0.00734 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.856 | L2-Norm(final)=13.534 | 4784.3 samples/s | 74.8 steps/s
[Step=41450 Epoch=202.1] | Loss=0.00720 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.859 | L2-Norm(final)=13.537 | 4672.5 samples/s | 73.0 steps/s
[Step=41500 Epoch=202.4] | Loss=0.00701 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.862 | L2-Norm(final)=13.540 | 4900.2 samples/s | 76.6 steps/s
[Step=41550 Epoch=202.6] | Loss=0.00684 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.865 | L2-Norm(final)=13.543 | 2890.9 samples/s | 45.2 steps/s
[Step=41600 Epoch=202.8] | Loss=0.00668 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.867 | L2-Norm(final)=13.546 | 4756.3 samples/s | 74.3 steps/s
[Step=41650 Epoch=203.1] | Loss=0.00656 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.870 | L2-Norm(final)=13.549 | 4797.4 samples/s | 75.0 steps/s
[Step=41700 Epoch=203.3] | Loss=0.00643 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=13.552 | 4780.1 samples/s | 74.7 steps/s
[Step=41750 Epoch=203.6] | Loss=0.00630 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=13.555 | 2921.2 samples/s | 45.6 steps/s
[Step=41800 Epoch=203.8] | Loss=0.00616 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.878 | L2-Norm(final)=13.557 | 4767.4 samples/s | 74.5 steps/s
[Step=41850 Epoch=204.1] | Loss=0.00609 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.880 | L2-Norm(final)=13.560 | 4746.8 samples/s | 74.2 steps/s
[Step=41900 Epoch=204.3] | Loss=0.00600 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.883 | L2-Norm(final)=13.563 | 4781.8 samples/s | 74.7 steps/s
[Step=41950 Epoch=204.6] | Loss=0.00592 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=13.565 | 2956.2 samples/s | 46.2 steps/s
[Step=42000 Epoch=204.8] | Loss=0.00583 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.887 | L2-Norm(final)=13.568 | 4729.2 samples/s | 73.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step42000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=46001 Epoch=224.5] | Loss=0.00982 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=15.204 | 7437.4 samples/s | 116.2 steps/s
[Step=46050 Epoch=224.7] | Loss=0.01854 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=15.205 | 4513.7 samples/s | 70.5 steps/s
[Step=46100 Epoch=224.9] | Loss=0.01855 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=15.207 | 5531.2 samples/s | 86.4 steps/s
[Step=46150 Epoch=225.2] | Loss=0.01604 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=15.209 | 5606.9 samples/s | 87.6 steps/s
[Step=46200 Epoch=225.4] | Loss=0.01656 | Reg=0.00095 | acc=0.9219 | L2-Norm=9.768 | L2-Norm(final)=15.211 | 8541.1 samples/s | 133.5 steps/s
[Step=46250 Epoch=225.7] | Loss=0.01650 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=15.213 | 2651.6 samples/s | 41.4 steps/s
[Step=46300 Epoch=225.9] | Loss=0.01696 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=15.215 | 5573.9 samples/s | 87.1 steps/s
[Step=46350 Epoch=226.2] | Loss=0.01677 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=15.216 | 5575.5 samples/s | 87.1 steps/s
[Step=46400 Epoch=226.4] | Loss=0.01668 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.768 | L2-Norm(final)=15.218 | 7780.2 samples/s | 121.6 steps/s
[Step=46450 Epoch=226.7] | Loss=0.01674 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=15.220 | 2729.5 samples/s | 42.6 steps/s
[Step=46500 Epoch=226.9] | Loss=0.01648 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=15.222 | 5571.7 samples/s | 87.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=226.9] | Loss=0.00620 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=15.240 | 6220.7 samples/s | 97.2 steps/s
[Step=46550 Epoch=227.1] | Loss=0.01851 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.776 | L2-Norm(final)=15.240 | 2123.4 samples/s | 33.2 steps/s
[Step=46600 Epoch=227.4] | Loss=0.01397 | Reg=0.00096 | acc=0.9688 | L2-Norm=9.784 | L2-Norm(final)=15.241 | 4466.1 samples/s | 69.8 steps/s
[Step=46650 Epoch=227.6] | Loss=0.01320 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.791 | L2-Norm(final)=15.244 | 4540.1 samples/s | 70.9 steps/s
[Step=46700 Epoch=227.9] | Loss=0.01260 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.797 | L2-Norm(final)=15.246 | 6924.0 samples/s | 108.2 steps/s
[Step=46750 Epoch=228.1] | Loss=0.01154 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.802 | L2-Norm(final)=15.249 | 2415.5 samples/s | 37.7 steps/s
[Step=46800 Epoch=228.4] | Loss=0.01022 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.807 | L2-Norm(final)=15.252 | 4757.6 samples/s | 74.3 steps/s
[Step=46850 Epoch=228.6] | Loss=0.00946 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.811 | L2-Norm(final)=15.255 | 4738.0 samples/s | 74.0 steps/s
[Step=46900 Epoch=228.9] | Loss=0.00892 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=15.258 | 6352.6 samples/s | 99.3 steps/s
[Step=46950 Epoch=229.1] | Loss=0.00832 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.819 | L2-Norm(final)=15.261 | 2543.4 samples/s | 39.7 steps/s
[Step=47000 Epoch=229.3] | Loss=0.00784 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.822 | L2-Norm(final)=15.264 | 4827.3 samples/s | 75.4 steps/s
[Step=47050 Epoch=229.6] | Loss=0.00751 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=15.267 | 4698.4 samples/s | 73.4 steps/s
[Step=47100 Epoch=229.8] | Loss=0.00718 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.829 | L2-Norm(final)=15.270 | 5906.1 samples/s | 92.3 steps/s
[Step=47150 Epoch=230.1] | Loss=0.00680 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.832 | L2-Norm(final)=15.273 | 2627.7 samples/s | 41.1 steps/s
[Step=47200 Epoch=230.3] | Loss=0.00656 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.835 | L2-Norm(final)=15.276 | 4756.3 samples/s | 74.3 steps/s
[Step=47250 Epoch=230.6] | Loss=0.00637 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.837 | L2-Norm(final)=15.279 | 4772.3 samples/s | 74.6 steps/s
[Step=47300 Epoch=230.8] | Loss=0.00616 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=15.281 | 5510.9 samples/s | 86.1 steps/s
[Step=47350 Epoch=231.0] | Loss=0.00605 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.843 | L2-Norm(final)=15.284 | 2705.0 samples/s | 42.3 steps/s
[Step=47400 Epoch=231.3] | Loss=0.00585 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=15.286 | 4763.2 samples/s | 74.4 steps/s
[Step=47450 Epoch=231.5] | Loss=0.00572 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.848 | L2-Norm(final)=15.289 | 4745.1 samples/s | 74.1 steps/s
[Step=47500 Epoch=231.8] | Loss=0.00557 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.850 | L2-Norm(final)=15.291 | 5151.0 samples/s | 80.5 steps/s
[Step=47550 Epoch=232.0] | Loss=0.00542 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.852 | L2-Norm(final)=15.294 | 2789.8 samples/s | 43.6 steps/s
[Step=47600 Epoch=232.3] | Loss=0.00525 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.855 | L2-Norm(final)=15.296 | 4730.9 samples/s | 73.9 steps/s
[Step=47650 Epoch=232.5] | Loss=0.00518 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.857 | L2-Norm(final)=15.298 | 4760.4 samples/s | 74.4 steps/s
[Step=47700 Epoch=232.8] | Loss=0.00509 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.859 | L2-Norm(final)=15.301 | 4869.4 samples/s | 76.1 steps/s
[Step=47750 Epoch=233.0] | Loss=0.00500 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.861 | L2-Norm(final)=15.303 | 2893.7 samples/s | 45.2 steps/s
[Step=47800 Epoch=233.2] | Loss=0.00492 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.863 | L2-Norm(final)=15.305 | 4748.2 samples/s | 74.2 steps/s
[Step=47850 Epoch=233.5] | Loss=0.00483 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.865 | L2-Norm(final)=15.307 | 4782.6 samples/s | 74.7 steps/s
[Step=47900 Epoch=233.7] | Loss=0.00476 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.867 | L2-Norm(final)=15.310 | 4740.9 samples/s | 74.1 steps/s
[Step=47950 Epoch=234.0] | Loss=0.00467 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.869 | L2-Norm(final)=15.312 | 2929.3 samples/s | 45.8 steps/s
[Step=48000 Epoch=234.2] | Loss=0.00459 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.871 | L2-Norm(final)=15.314 | 4791.8 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step48000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=32001 Epoch=156.1] | Loss=0.01059 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=14.215 | 6848.0 samples/s | 107.0 steps/s
[Step=32050 Epoch=156.3] | Loss=0.01696 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.768 | L2-Norm(final)=14.218 | 5052.0 samples/s | 78.9 steps/s
[Step=32100 Epoch=156.5] | Loss=0.01738 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=14.221 | 5722.5 samples/s | 89.4 steps/s
[Step=32150 Epoch=156.8] | Loss=0.01718 | Reg=0.00095 | acc=0.9531 | L2-Norm=9.768 | L2-Norm(final)=14.226 | 5369.5 samples/s | 83.9 steps/s
[Step=32200 Epoch=157.0] | Loss=0.01714 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=14.230 | 8715.0 samples/s | 136.2 steps/s
[Step=32250 Epoch=157.3] | Loss=0.01637 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=14.233 | 2662.0 samples/s | 41.6 steps/s
[Step=32300 Epoch=157.5] | Loss=0.01656 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=14.237 | 5655.8 samples/s | 88.4 steps/s
[Step=32350 Epoch=157.8] | Loss=0.01677 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=14.241 | 5447.2 samples/s | 85.1 steps/s
[Step=32400 Epoch=158.0] | Loss=0.01688 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=14.244 | 7692.1 samples/s | 120.2 steps/s
[Step=32450 Epoch=158.2] | Loss=0.01666 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=14.247 | 2798.4 samples/s | 43.7 steps/s
[Step=32500 Epoch=158.5] | Loss=0.01686 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=14.250 | 5484.4 samples/s | 85.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=32501 Epoch=158.5] | Loss=0.01659 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=14.277 | 7036.9 samples/s | 110.0 steps/s
[Step=32550 Epoch=158.7] | Loss=0.01380 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.778 | L2-Norm(final)=14.279 | 4308.8 samples/s | 67.3 steps/s
[Step=32600 Epoch=159.0] | Loss=0.01446 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.786 | L2-Norm(final)=14.281 | 4799.3 samples/s | 75.0 steps/s
[Step=32650 Epoch=159.2] | Loss=0.01457 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.794 | L2-Norm(final)=14.283 | 4714.0 samples/s | 73.7 steps/s
[Step=32700 Epoch=159.5] | Loss=0.01319 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.801 | L2-Norm(final)=14.285 | 6852.1 samples/s | 107.1 steps/s
[Step=32750 Epoch=159.7] | Loss=0.01178 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.808 | L2-Norm(final)=14.288 | 2472.1 samples/s | 38.6 steps/s
[Step=32800 Epoch=160.0] | Loss=0.01085 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.814 | L2-Norm(final)=14.291 | 4775.2 samples/s | 74.6 steps/s
[Step=32850 Epoch=160.2] | Loss=0.00988 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.819 | L2-Norm(final)=14.295 | 4772.6 samples/s | 74.6 steps/s
[Step=32900 Epoch=160.4] | Loss=0.00922 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=14.299 | 6256.4 samples/s | 97.8 steps/s
[Step=32950 Epoch=160.7] | Loss=0.00858 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.828 | L2-Norm(final)=14.302 | 2581.5 samples/s | 40.3 steps/s
[Step=33000 Epoch=160.9] | Loss=0.00807 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.833 | L2-Norm(final)=14.305 | 4729.5 samples/s | 73.9 steps/s
[Step=33050 Epoch=161.2] | Loss=0.00770 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.837 | L2-Norm(final)=14.309 | 4790.3 samples/s | 74.8 steps/s
[Step=33100 Epoch=161.4] | Loss=0.00738 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.841 | L2-Norm(final)=14.312 | 5675.5 samples/s | 88.7 steps/s
[Step=33150 Epoch=161.7] | Loss=0.00708 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.844 | L2-Norm(final)=14.315 | 2656.0 samples/s | 41.5 steps/s
[Step=33200 Epoch=161.9] | Loss=0.00678 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.848 | L2-Norm(final)=14.319 | 4805.9 samples/s | 75.1 steps/s
[Step=33250 Epoch=162.1] | Loss=0.00655 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.851 | L2-Norm(final)=14.322 | 4762.7 samples/s | 74.4 steps/s
[Step=33300 Epoch=162.4] | Loss=0.00639 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.855 | L2-Norm(final)=14.325 | 5263.2 samples/s | 82.2 steps/s
[Step=33350 Epoch=162.6] | Loss=0.00614 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.858 | L2-Norm(final)=14.328 | 2773.6 samples/s | 43.3 steps/s
[Step=33400 Epoch=162.9] | Loss=0.00592 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.861 | L2-Norm(final)=14.331 | 4736.4 samples/s | 74.0 steps/s
[Step=33450 Epoch=163.1] | Loss=0.00581 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.864 | L2-Norm(final)=14.334 | 4789.5 samples/s | 74.8 steps/s
[Step=33500 Epoch=163.4] | Loss=0.00567 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.867 | L2-Norm(final)=14.337 | 4900.9 samples/s | 76.6 steps/s
[Step=33550 Epoch=163.6] | Loss=0.00552 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.870 | L2-Norm(final)=14.340 | 2915.9 samples/s | 45.6 steps/s
[Step=33600 Epoch=163.9] | Loss=0.00539 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.872 | L2-Norm(final)=14.343 | 4792.0 samples/s | 74.9 steps/s
[Step=33650 Epoch=164.1] | Loss=0.00529 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.875 | L2-Norm(final)=14.345 | 4702.5 samples/s | 73.5 steps/s
[Step=33700 Epoch=164.3] | Loss=0.00518 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.878 | L2-Norm(final)=14.348 | 4740.1 samples/s | 74.1 steps/s
[Step=33750 Epoch=164.6] | Loss=0.00507 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.880 | L2-Norm(final)=14.351 | 2963.6 samples/s | 46.3 steps/s
[Step=33800 Epoch=164.8] | Loss=0.00496 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.883 | L2-Norm(final)=14.354 | 4731.1 samples/s | 73.9 steps/s
[Step=33850 Epoch=165.1] | Loss=0.00486 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=14.356 | 4715.9 samples/s | 73.7 steps/s
[Step=33900 Epoch=165.3] | Loss=0.00476 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.887 | L2-Norm(final)=14.359 | 4780.5 samples/s | 74.7 steps/s
[Step=33950 Epoch=165.6] | Loss=0.00471 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.890 | L2-Norm(final)=14.361 | 2956.0 samples/s | 46.2 steps/s
[Step=34000 Epoch=165.8] | Loss=0.00465 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.892 | L2-Norm(final)=14.364 | 4781.2 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step34000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=38001 Epoch=361.5] | Loss=0.00011 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=15.632 | 6523.7 samples/s | 101.9 steps/s
[Step=38050 Epoch=362.0] | Loss=0.00083 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=15.635 | 5004.1 samples/s | 78.2 steps/s
[Step=38100 Epoch=362.4] | Loss=0.00075 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=15.642 | 7908.0 samples/s | 123.6 steps/s
[Step=38150 Epoch=362.9] | Loss=0.00071 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=15.647 | 2546.7 samples/s | 39.8 steps/s
[Step=38200 Epoch=363.4] | Loss=0.00070 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=15.652 | 7255.5 samples/s | 113.4 steps/s
[Step=38250 Epoch=363.9] | Loss=0.00069 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=15.657 | 2668.3 samples/s | 41.7 steps/s
[Step=38300 Epoch=364.3] | Loss=0.00071 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=15.661 | 6525.1 samples/s | 102.0 steps/s
[Step=38350 Epoch=364.8] | Loss=0.00070 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=15.666 | 2808.1 samples/s | 43.9 steps/s
[Step=38400 Epoch=365.3] | Loss=0.00070 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=15.669 | 5910.2 samples/s | 92.3 steps/s
[Step=38450 Epoch=365.8] | Loss=0.00070 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=15.674 | 2972.3 samples/s | 46.4 steps/s
[Step=38500 Epoch=366.2] | Loss=0.00070 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=15.678 | 5289.9 samples/s | 82.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=38501 Epoch=366.2] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=15.720 | 6697.2 samples/s | 104.6 steps/s
[Step=38550 Epoch=366.7] | Loss=0.00028 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.772 | L2-Norm(final)=15.722 | 4168.5 samples/s | 65.1 steps/s
[Step=38600 Epoch=367.2] | Loss=0.00017 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.774 | L2-Norm(final)=15.723 | 6536.8 samples/s | 102.1 steps/s
[Step=38650 Epoch=367.7] | Loss=0.00012 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.773 | L2-Norm(final)=15.723 | 2407.1 samples/s | 37.6 steps/s
[Step=38700 Epoch=368.1] | Loss=0.00010 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.772 | L2-Norm(final)=15.724 | 5853.5 samples/s | 91.5 steps/s
[Step=38750 Epoch=368.6] | Loss=0.00008 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.771 | L2-Norm(final)=15.725 | 2470.3 samples/s | 38.6 steps/s
[Step=38800 Epoch=369.1] | Loss=0.00007 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.769 | L2-Norm(final)=15.725 | 5542.4 samples/s | 86.6 steps/s
[Step=38850 Epoch=369.6] | Loss=0.00006 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=15.726 | 2586.1 samples/s | 40.4 steps/s
[Step=38900 Epoch=370.0] | Loss=0.00006 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.766 | L2-Norm(final)=15.727 | 5015.0 samples/s | 78.4 steps/s
[Step=38950 Epoch=370.5] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.764 | L2-Norm(final)=15.727 | 2736.6 samples/s | 42.8 steps/s
[Step=39000 Epoch=371.0] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.762 | L2-Norm(final)=15.728 | 4520.0 samples/s | 70.6 steps/s
[Step=39050 Epoch=371.5] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.760 | L2-Norm(final)=15.728 | 2808.9 samples/s | 43.9 steps/s
[Step=39100 Epoch=371.9] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.758 | L2-Norm(final)=15.729 | 4517.3 samples/s | 70.6 steps/s
[Step=39150 Epoch=372.4] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.755 | L2-Norm(final)=15.729 | 2882.8 samples/s | 45.0 steps/s
[Step=39200 Epoch=372.9] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.753 | L2-Norm(final)=15.730 | 4453.5 samples/s | 69.6 steps/s
[Step=39250 Epoch=373.4] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.751 | L2-Norm(final)=15.730 | 2880.6 samples/s | 45.0 steps/s
[Step=39300 Epoch=373.8] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=15.730 | 4497.6 samples/s | 70.3 steps/s
[Step=39350 Epoch=374.3] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.746 | L2-Norm(final)=15.731 | 3040.3 samples/s | 47.5 steps/s
[Step=39400 Epoch=374.8] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.744 | L2-Norm(final)=15.731 | 4364.4 samples/s | 68.2 steps/s
[Step=39450 Epoch=375.3] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.741 | L2-Norm(final)=15.732 | 6767.5 samples/s | 105.7 steps/s
[Step=39500 Epoch=375.7] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=15.732 | 2336.8 samples/s | 36.5 steps/s
[Step=39550 Epoch=376.2] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.736 | L2-Norm(final)=15.732 | 6188.1 samples/s | 96.7 steps/s
[Step=39600 Epoch=376.7] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.733 | L2-Norm(final)=15.733 | 2439.8 samples/s | 38.1 steps/s
[Step=39650 Epoch=377.2] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.731 | L2-Norm(final)=15.733 | 5640.1 samples/s | 88.1 steps/s
[Step=39700 Epoch=377.6] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.728 | L2-Norm(final)=15.733 | 2549.9 samples/s | 39.8 steps/s
[Step=39750 Epoch=378.1] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.725 | L2-Norm(final)=15.734 | 5178.2 samples/s | 80.9 steps/s
[Step=39800 Epoch=378.6] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.722 | L2-Norm(final)=15.734 | 2680.1 samples/s | 41.9 steps/s
[Step=39850 Epoch=379.1] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.719 | L2-Norm(final)=15.735 | 4704.2 samples/s | 73.5 steps/s
[Step=39900 Epoch=379.5] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.716 | L2-Norm(final)=15.735 | 2766.7 samples/s | 43.2 steps/s
[Step=39950 Epoch=380.0] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.713 | L2-Norm(final)=15.735 | 4538.6 samples/s | 70.9 steps/s
[Step=40000 Epoch=380.5] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.710 | L2-Norm(final)=15.736 | 2896.4 samples/s | 45.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step40000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=36001 Epoch=343.8] | Loss=0.00163 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=14.736 | 6920.5 samples/s | 108.1 steps/s
[Step=36050 Epoch=344.3] | Loss=0.00053 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.766 | L2-Norm(final)=14.738 | 4472.1 samples/s | 69.9 steps/s
[Step=36100 Epoch=344.7] | Loss=0.00044 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.766 | L2-Norm(final)=14.740 | 8313.5 samples/s | 129.9 steps/s
[Step=36150 Epoch=345.2] | Loss=0.00044 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=14.742 | 2587.8 samples/s | 40.4 steps/s
[Step=36200 Epoch=345.7] | Loss=0.00041 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=14.744 | 7268.1 samples/s | 113.6 steps/s
[Step=36250 Epoch=346.2] | Loss=0.00040 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=14.747 | 2645.4 samples/s | 41.3 steps/s
[Step=36300 Epoch=346.6] | Loss=0.00042 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=14.750 | 6810.6 samples/s | 106.4 steps/s
[Step=36350 Epoch=347.1] | Loss=0.00041 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=14.752 | 2724.6 samples/s | 42.6 steps/s
[Step=36400 Epoch=347.6] | Loss=0.00041 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=14.755 | 6324.1 samples/s | 98.8 steps/s
[Step=36450 Epoch=348.1] | Loss=0.00040 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=14.758 | 2851.3 samples/s | 44.6 steps/s
[Step=36500 Epoch=348.6] | Loss=0.00041 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=14.761 | 5760.2 samples/s | 90.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=36501 Epoch=348.6] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=14.790 | 6690.2 samples/s | 104.5 steps/s
[Step=36550 Epoch=349.0] | Loss=0.00029 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.773 | L2-Norm(final)=14.793 | 4185.9 samples/s | 65.4 steps/s
[Step=36600 Epoch=349.5] | Loss=0.00018 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.776 | L2-Norm(final)=14.794 | 6652.0 samples/s | 103.9 steps/s
[Step=36650 Epoch=350.0] | Loss=0.00012 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.775 | L2-Norm(final)=14.795 | 2376.0 samples/s | 37.1 steps/s
[Step=36700 Epoch=350.5] | Loss=0.00009 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.773 | L2-Norm(final)=14.795 | 6158.6 samples/s | 96.2 steps/s
[Step=36750 Epoch=350.9] | Loss=0.00008 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.770 | L2-Norm(final)=14.796 | 2453.1 samples/s | 38.3 steps/s
[Step=36800 Epoch=351.4] | Loss=0.00006 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=14.796 | 5604.3 samples/s | 87.6 steps/s
[Step=36850 Epoch=351.9] | Loss=0.00006 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.764 | L2-Norm(final)=14.796 | 2526.9 samples/s | 39.5 steps/s
[Step=36900 Epoch=352.4] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.761 | L2-Norm(final)=14.796 | 5278.0 samples/s | 82.5 steps/s
[Step=36950 Epoch=352.8] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.757 | L2-Norm(final)=14.796 | 2586.9 samples/s | 40.4 steps/s
[Step=37000 Epoch=353.3] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.754 | L2-Norm(final)=14.797 | 4920.8 samples/s | 76.9 steps/s
[Step=37050 Epoch=353.8] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=14.797 | 2704.3 samples/s | 42.3 steps/s
[Step=37100 Epoch=354.3] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=14.797 | 4630.7 samples/s | 72.4 steps/s
[Step=37150 Epoch=354.8] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.743 | L2-Norm(final)=14.797 | 2836.6 samples/s | 44.3 steps/s
[Step=37200 Epoch=355.2] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.739 | L2-Norm(final)=14.797 | 4603.9 samples/s | 71.9 steps/s
[Step=37250 Epoch=355.7] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.735 | L2-Norm(final)=14.797 | 2870.0 samples/s | 44.8 steps/s
[Step=37300 Epoch=356.2] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.731 | L2-Norm(final)=14.798 | 4460.6 samples/s | 69.7 steps/s
[Step=37350 Epoch=356.7] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.727 | L2-Norm(final)=14.798 | 2886.9 samples/s | 45.1 steps/s
[Step=37400 Epoch=357.1] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=14.798 | 4502.7 samples/s | 70.4 steps/s
[Step=37450 Epoch=357.6] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.719 | L2-Norm(final)=14.798 | 2848.8 samples/s | 44.5 steps/s
[Step=37500 Epoch=358.1] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.715 | L2-Norm(final)=14.798 | 4506.7 samples/s | 70.4 steps/s
[Step=37550 Epoch=358.6] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.711 | L2-Norm(final)=14.798 | 7368.0 samples/s | 115.1 steps/s
[Step=37600 Epoch=359.1] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.707 | L2-Norm(final)=14.798 | 2334.1 samples/s | 36.5 steps/s
[Step=37650 Epoch=359.5] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.703 | L2-Norm(final)=14.799 | 6461.1 samples/s | 101.0 steps/s
[Step=37700 Epoch=360.0] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.698 | L2-Norm(final)=14.799 | 2357.1 samples/s | 36.8 steps/s
[Step=37750 Epoch=360.5] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.694 | L2-Norm(final)=14.799 | 6166.8 samples/s | 96.4 steps/s
[Step=37800 Epoch=361.0] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.690 | L2-Norm(final)=14.799 | 2465.9 samples/s | 38.5 steps/s
[Step=37850 Epoch=361.4] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.685 | L2-Norm(final)=14.799 | 5588.5 samples/s | 87.3 steps/s
[Step=37900 Epoch=361.9] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.681 | L2-Norm(final)=14.799 | 2526.1 samples/s | 39.5 steps/s
[Step=37950 Epoch=362.4] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.676 | L2-Norm(final)=14.799 | 5266.5 samples/s | 82.3 steps/s
[Step=38000 Epoch=362.9] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.672 | L2-Norm(final)=14.800 | 2594.9 samples/s | 40.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step38000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07771 | acc=0.9647 | tpr=0.9710 | fpr=0.0491 | 5790.9 samples/s | 22.6 steps/s
Avg test loss: 0.08211, Avg test acc: 0.96222, Avg tpr: 0.96882, Avg fpr: 0.05230, total FA: 408

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08609 | acc=0.9620 | tpr=0.9722 | fpr=0.0600 | 6121.2 samples/s | 23.9 steps/s
Avg test loss: 0.08954, Avg test acc: 0.96069, Avg tpr: 0.97010, Avg fpr: 0.05999, total FA: 468

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09224 | acc=0.9628 | tpr=0.9787 | fpr=0.0716 | 6042.6 samples/s | 23.6 steps/s
Avg test loss: 0.09533, Avg test acc: 0.96097, Avg tpr: 0.97575, Avg fpr: 0.07153, total FA: 558

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08146 | acc=0.9638 | tpr=0.9779 | fpr=0.0667 | 6030.5 samples/s | 23.6 steps/s
Avg test loss: 0.08522, Avg test acc: 0.96246, Avg tpr: 0.97610, Avg fpr: 0.06756, total FA: 527

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08452 | acc=0.9630 | tpr=0.9739 | fpr=0.0605 | 5760.2 samples/s | 22.5 steps/s
Avg test loss: 0.08755, Avg test acc: 0.96210, Avg tpr: 0.97208, Avg fpr: 0.05986, total FA: 467

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.22356 | acc=0.2743 | tpr=0.0203 | fpr=0.1742 | 5766.1 samples/s | 22.5 steps/s
Avg test loss: 6.22949, Avg test acc: 0.27326, Avg tpr: 0.01923, Avg fpr: 0.16806, total FA: 1311

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.51065 | acc=0.3063 | tpr=0.0300 | fpr=0.0937 | 5971.0 samples/s | 23.3 steps/s
Avg test loss: 4.51916, Avg test acc: 0.30471, Avg tpr: 0.02967, Avg fpr: 0.09037, total FA: 705

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.84255 | acc=0.2929 | tpr=0.0245 | fpr=0.1244 | 5898.9 samples/s | 23.0 steps/s
Avg test loss: 4.84905, Avg test acc: 0.29165, Avg tpr: 0.02349, Avg fpr: 0.11857, total FA: 925

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.20468 | acc=0.2738 | tpr=0.0237 | fpr=0.1831 | 5782.8 samples/s | 22.6 steps/s
Avg test loss: 5.20674, Avg test acc: 0.27298, Avg tpr: 0.02326, Avg fpr: 0.17780, total FA: 1387

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.90266 | acc=0.2911 | tpr=0.0189 | fpr=0.1179 | 6014.0 samples/s | 23.5 steps/s
Avg test loss: 4.91703, Avg test acc: 0.29033, Avg tpr: 0.01883, Avg fpr: 0.11255, total FA: 878

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.85212 | acc=0.1317 | tpr=0.5708 | fpr=0.8762 | 5960.8 samples/s | 23.3 steps/s
[Step= 100] | Loss=4.83911 | acc=0.1337 | tpr=0.5586 | fpr=0.8743 | 7581.1 samples/s | 29.6 steps/s
[Step= 150] | Loss=4.82953 | acc=0.1358 | tpr=0.5821 | fpr=0.8724 | 8116.6 samples/s | 31.7 steps/s
[Step= 200] | Loss=4.81902 | acc=0.1361 | tpr=0.5760 | fpr=0.8719 | 8686.3 samples/s | 33.9 steps/s
[Step= 250] | Loss=4.82478 | acc=0.1358 | tpr=0.5642 | fpr=0.8721 | 7690.2 samples/s | 30.0 steps/s
[Step= 300] | Loss=4.81897 | acc=0.1358 | tpr=0.5549 | fpr=0.8719 | 8516.4 samples/s | 33.3 steps/s
[Step= 350] | Loss=4.82422 | acc=0.1360 | tpr=0.5529 | fpr=0.8715 | 8205.9 samples/s | 32.1 steps/s
[Step= 400] | Loss=4.82173 | acc=0.1366 | tpr=0.5520 | fpr=0.8710 | 7563.8 samples/s | 29.5 steps/s
[Step= 450] | Loss=4.82607 | acc=0.1362 | tpr=0.5574 | fpr=0.8714 | 8252.4 samples/s | 32.2 steps/s
[Step= 500] | Loss=4.82597 | acc=0.1361 | tpr=0.5608 | fpr=0.8716 | 8009.7 samples/s | 31.3 steps/s
[Step= 550] | Loss=4.82876 | acc=0.1360 | tpr=0.5599 | fpr=0.8717 | 9605.8 samples/s | 37.5 steps/s
Avg test loss: 4.82911, Avg test acc: 0.13591, Avg tpr: 0.56062, Avg fpr: 0.87181, total FA: 121049

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.79324 | acc=0.1352 | tpr=0.5619 | fpr=0.8724 | 5875.8 samples/s | 23.0 steps/s
[Step= 100] | Loss=4.78583 | acc=0.1384 | tpr=0.5608 | fpr=0.8695 | 7439.3 samples/s | 29.1 steps/s
[Step= 150] | Loss=4.77441 | acc=0.1414 | tpr=0.5893 | fpr=0.8668 | 7763.2 samples/s | 30.3 steps/s
[Step= 200] | Loss=4.76447 | acc=0.1420 | tpr=0.5891 | fpr=0.8661 | 8452.3 samples/s | 33.0 steps/s
[Step= 250] | Loss=4.76878 | acc=0.1419 | tpr=0.5799 | fpr=0.8661 | 8843.2 samples/s | 34.5 steps/s
[Step= 300] | Loss=4.76518 | acc=0.1415 | tpr=0.5695 | fpr=0.8663 | 7751.8 samples/s | 30.3 steps/s
[Step= 350] | Loss=4.76975 | acc=0.1414 | tpr=0.5667 | fpr=0.8663 | 8055.6 samples/s | 31.5 steps/s
[Step= 400] | Loss=4.76775 | acc=0.1418 | tpr=0.5667 | fpr=0.8659 | 8152.2 samples/s | 31.8 steps/s
[Step= 450] | Loss=4.77131 | acc=0.1412 | tpr=0.5740 | fpr=0.8667 | 8507.0 samples/s | 33.2 steps/s
[Step= 500] | Loss=4.77218 | acc=0.1410 | tpr=0.5762 | fpr=0.8668 | 7624.6 samples/s | 29.8 steps/s
[Step= 550] | Loss=4.77554 | acc=0.1412 | tpr=0.5770 | fpr=0.8667 | 9952.2 samples/s | 38.9 steps/s
Avg test loss: 4.77577, Avg test acc: 0.14114, Avg tpr: 0.57845, Avg fpr: 0.86681, total FA: 120355

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.30580 | acc=0.1205 | tpr=0.6460 | fpr=0.8889 | 5781.6 samples/s | 22.6 steps/s
[Step= 100] | Loss=5.29587 | acc=0.1221 | tpr=0.6397 | fpr=0.8876 | 7928.1 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.28653 | acc=0.1238 | tpr=0.6484 | fpr=0.8858 | 7932.3 samples/s | 31.0 steps/s
[Step= 200] | Loss=5.27791 | acc=0.1240 | tpr=0.6361 | fpr=0.8854 | 7760.9 samples/s | 30.3 steps/s
[Step= 250] | Loss=5.28441 | acc=0.1241 | tpr=0.6314 | fpr=0.8852 | 8128.7 samples/s | 31.8 steps/s
[Step= 300] | Loss=5.28069 | acc=0.1239 | tpr=0.6269 | fpr=0.8853 | 8360.6 samples/s | 32.7 steps/s
[Step= 350] | Loss=5.28648 | acc=0.1239 | tpr=0.6255 | fpr=0.8852 | 8403.0 samples/s | 32.8 steps/s
[Step= 400] | Loss=5.28547 | acc=0.1240 | tpr=0.6253 | fpr=0.8851 | 7770.1 samples/s | 30.4 steps/s
[Step= 450] | Loss=5.29084 | acc=0.1234 | tpr=0.6261 | fpr=0.8857 | 8607.6 samples/s | 33.6 steps/s
[Step= 500] | Loss=5.29038 | acc=0.1233 | tpr=0.6273 | fpr=0.8858 | 8025.1 samples/s | 31.3 steps/s
[Step= 550] | Loss=5.29362 | acc=0.1234 | tpr=0.6291 | fpr=0.8858 | 9426.4 samples/s | 36.8 steps/s
Avg test loss: 5.29407, Avg test acc: 0.12333, Avg tpr: 0.63035, Avg fpr: 0.88589, total FA: 123004

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.94657 | acc=0.1264 | tpr=0.6504 | fpr=0.8830 | 5998.4 samples/s | 23.4 steps/s
[Step= 100] | Loss=4.93739 | acc=0.1299 | tpr=0.6503 | fpr=0.8798 | 7575.7 samples/s | 29.6 steps/s
[Step= 150] | Loss=4.92658 | acc=0.1316 | tpr=0.6614 | fpr=0.8781 | 8033.1 samples/s | 31.4 steps/s
[Step= 200] | Loss=4.91670 | acc=0.1320 | tpr=0.6568 | fpr=0.8776 | 8221.8 samples/s | 32.1 steps/s
[Step= 250] | Loss=4.91957 | acc=0.1317 | tpr=0.6472 | fpr=0.8777 | 8234.9 samples/s | 32.2 steps/s
[Step= 300] | Loss=4.91614 | acc=0.1312 | tpr=0.6465 | fpr=0.8782 | 7389.6 samples/s | 28.9 steps/s
[Step= 350] | Loss=4.92140 | acc=0.1312 | tpr=0.6456 | fpr=0.8781 | 8341.8 samples/s | 32.6 steps/s
[Step= 400] | Loss=4.92034 | acc=0.1314 | tpr=0.6455 | fpr=0.8780 | 7586.4 samples/s | 29.6 steps/s
[Step= 450] | Loss=4.92533 | acc=0.1304 | tpr=0.6495 | fpr=0.8790 | 8587.6 samples/s | 33.5 steps/s
[Step= 500] | Loss=4.92504 | acc=0.1303 | tpr=0.6533 | fpr=0.8791 | 8256.8 samples/s | 32.3 steps/s
[Step= 550] | Loss=4.92896 | acc=0.1303 | tpr=0.6558 | fpr=0.8792 | 10247.5 samples/s | 40.0 steps/s
Avg test loss: 4.92957, Avg test acc: 0.13028, Avg tpr: 0.65689, Avg fpr: 0.87929, total FA: 122088

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.97711 | acc=0.1332 | tpr=0.5177 | fpr=0.8737 | 6034.4 samples/s | 23.6 steps/s
[Step= 100] | Loss=4.96681 | acc=0.1348 | tpr=0.5053 | fpr=0.8721 | 7849.4 samples/s | 30.7 steps/s
[Step= 150] | Loss=4.95605 | acc=0.1369 | tpr=0.5202 | fpr=0.8701 | 8123.4 samples/s | 31.7 steps/s
[Step= 200] | Loss=4.94827 | acc=0.1382 | tpr=0.5115 | fpr=0.8686 | 8493.3 samples/s | 33.2 steps/s
[Step= 250] | Loss=4.95265 | acc=0.1380 | tpr=0.4996 | fpr=0.8686 | 8177.3 samples/s | 31.9 steps/s
[Step= 300] | Loss=4.94938 | acc=0.1378 | tpr=0.4909 | fpr=0.8686 | 7063.2 samples/s | 27.6 steps/s
[Step= 350] | Loss=4.95575 | acc=0.1376 | tpr=0.4890 | fpr=0.8688 | 7981.2 samples/s | 31.2 steps/s
[Step= 400] | Loss=4.95274 | acc=0.1378 | tpr=0.4902 | fpr=0.8686 | 8151.4 samples/s | 31.8 steps/s
[Step= 450] | Loss=4.95705 | acc=0.1371 | tpr=0.4932 | fpr=0.8694 | 8027.6 samples/s | 31.4 steps/s
[Step= 500] | Loss=4.95670 | acc=0.1372 | tpr=0.4943 | fpr=0.8693 | 8608.8 samples/s | 33.6 steps/s
[Step= 550] | Loss=4.95962 | acc=0.1373 | tpr=0.4930 | fpr=0.8691 | 9611.5 samples/s | 37.5 steps/s
Avg test loss: 4.96019, Avg test acc: 0.13722, Avg tpr: 0.49366, Avg fpr: 0.86926, total FA: 120695

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.21976 | acc=0.9595 | tpr=0.9513 | fpr=0.0404 | 6189.2 samples/s | 24.2 steps/s
[Step= 100] | Loss=0.22823 | acc=0.9584 | tpr=0.9574 | fpr=0.0416 | 7642.0 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.23035 | acc=0.9570 | tpr=0.9553 | fpr=0.0429 | 8038.5 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.23058 | acc=0.9570 | tpr=0.9585 | fpr=0.0430 | 7526.7 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.23040 | acc=0.9570 | tpr=0.9563 | fpr=0.0430 | 7803.0 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.23398 | acc=0.9565 | tpr=0.9542 | fpr=0.0434 | 7974.0 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.23214 | acc=0.9568 | tpr=0.9537 | fpr=0.0432 | 8351.7 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.23197 | acc=0.9564 | tpr=0.9513 | fpr=0.0435 | 8091.4 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.23555 | acc=0.9559 | tpr=0.9499 | fpr=0.0440 | 8045.2 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.23593 | acc=0.9557 | tpr=0.9515 | fpr=0.0442 | 7107.6 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.23459 | acc=0.9561 | tpr=0.9522 | fpr=0.0439 | 13169.5 samples/s | 51.4 steps/s
Avg test loss: 0.23428, Avg test acc: 0.95607, Avg tpr: 0.95206, Avg fpr: 0.04385, total FA: 6089

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.17187 | acc=0.9609 | tpr=0.9248 | fpr=0.0384 | 5896.7 samples/s | 23.0 steps/s
[Step= 100] | Loss=0.17931 | acc=0.9595 | tpr=0.9318 | fpr=0.0400 | 8049.8 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.18179 | acc=0.9581 | tpr=0.9323 | fpr=0.0414 | 7378.9 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.18224 | acc=0.9582 | tpr=0.9355 | fpr=0.0414 | 7902.7 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.18184 | acc=0.9583 | tpr=0.9371 | fpr=0.0413 | 8075.5 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.18488 | acc=0.9579 | tpr=0.9360 | fpr=0.0417 | 8176.6 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.18347 | acc=0.9580 | tpr=0.9361 | fpr=0.0416 | 7817.6 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.18396 | acc=0.9578 | tpr=0.9333 | fpr=0.0418 | 8318.5 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.18676 | acc=0.9573 | tpr=0.9333 | fpr=0.0423 | 8432.2 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.18644 | acc=0.9572 | tpr=0.9352 | fpr=0.0424 | 7894.0 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.18539 | acc=0.9575 | tpr=0.9371 | fpr=0.0422 | 10688.9 samples/s | 41.8 steps/s
Avg test loss: 0.18518, Avg test acc: 0.95750, Avg tpr: 0.93700, Avg fpr: 0.04213, total FA: 5850

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.24418 | acc=0.9513 | tpr=0.9558 | fpr=0.0488 | 5957.6 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.25164 | acc=0.9502 | tpr=0.9595 | fpr=0.0500 | 7579.3 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.25563 | acc=0.9491 | tpr=0.9611 | fpr=0.0511 | 8736.3 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.25577 | acc=0.9493 | tpr=0.9628 | fpr=0.0509 | 8405.9 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.25616 | acc=0.9491 | tpr=0.9624 | fpr=0.0511 | 7287.6 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.25899 | acc=0.9489 | tpr=0.9600 | fpr=0.0513 | 8143.5 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.25709 | acc=0.9490 | tpr=0.9593 | fpr=0.0512 | 8481.7 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.25737 | acc=0.9487 | tpr=0.9584 | fpr=0.0515 | 8118.4 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.26077 | acc=0.9483 | tpr=0.9572 | fpr=0.0519 | 8043.0 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.26108 | acc=0.9482 | tpr=0.9577 | fpr=0.0520 | 7405.3 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.25942 | acc=0.9485 | tpr=0.9574 | fpr=0.0517 | 10520.0 samples/s | 41.1 steps/s
Avg test loss: 0.25918, Avg test acc: 0.94852, Avg tpr: 0.95721, Avg fpr: 0.05164, total FA: 7170

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15514 | acc=0.9648 | tpr=0.9469 | fpr=0.0348 | 6027.9 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.16185 | acc=0.9634 | tpr=0.9488 | fpr=0.0363 | 7706.0 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.16287 | acc=0.9617 | tpr=0.9452 | fpr=0.0380 | 8148.7 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.16314 | acc=0.9618 | tpr=0.9508 | fpr=0.0380 | 8129.6 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.16287 | acc=0.9618 | tpr=0.9493 | fpr=0.0380 | 7979.8 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.16591 | acc=0.9614 | tpr=0.9476 | fpr=0.0383 | 7666.2 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.16453 | acc=0.9615 | tpr=0.9468 | fpr=0.0383 | 8141.3 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.16437 | acc=0.9612 | tpr=0.9447 | fpr=0.0385 | 8160.3 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.16674 | acc=0.9608 | tpr=0.9445 | fpr=0.0389 | 7981.1 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.16678 | acc=0.9607 | tpr=0.9463 | fpr=0.0390 | 7429.1 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.16589 | acc=0.9610 | tpr=0.9471 | fpr=0.0388 | 11389.5 samples/s | 44.5 steps/s
Avg test loss: 0.16565, Avg test acc: 0.96098, Avg tpr: 0.94691, Avg fpr: 0.03876, total FA: 5382

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21562 | acc=0.9586 | tpr=0.9513 | fpr=0.0413 | 6314.0 samples/s | 24.7 steps/s
[Step= 100] | Loss=0.22490 | acc=0.9569 | tpr=0.9574 | fpr=0.0431 | 7887.5 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.22815 | acc=0.9553 | tpr=0.9582 | fpr=0.0447 | 7866.6 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.22815 | acc=0.9552 | tpr=0.9596 | fpr=0.0449 | 7480.2 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.22848 | acc=0.9551 | tpr=0.9590 | fpr=0.0450 | 7237.6 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.23213 | acc=0.9546 | tpr=0.9549 | fpr=0.0454 | 8344.2 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.23079 | acc=0.9546 | tpr=0.9549 | fpr=0.0454 | 8316.8 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.23106 | acc=0.9542 | tpr=0.9513 | fpr=0.0457 | 8078.4 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.23452 | acc=0.9537 | tpr=0.9508 | fpr=0.0462 | 8149.6 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.23454 | acc=0.9536 | tpr=0.9502 | fpr=0.0463 | 8290.8 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.23306 | acc=0.9539 | tpr=0.9507 | fpr=0.0460 | 10197.2 samples/s | 39.8 steps/s
Avg test loss: 0.23287, Avg test acc: 0.95393, Avg tpr: 0.95048, Avg fpr: 0.04601, total FA: 6388

server round 43/50

clients selected: [0 1 2 3 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=42001 Epoch=204.8] | Loss=0.02316 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.723 | L2-Norm(final)=13.644 | 7052.7 samples/s | 110.2 steps/s
[Step=42050 Epoch=205.0] | Loss=0.02226 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.723 | L2-Norm(final)=13.641 | 5001.1 samples/s | 78.1 steps/s
[Step=42100 Epoch=205.3] | Loss=0.02013 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.723 | L2-Norm(final)=13.640 | 5401.4 samples/s | 84.4 steps/s
[Step=42150 Epoch=205.5] | Loss=0.02071 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=13.640 | 5587.9 samples/s | 87.3 steps/s
[Step=42200 Epoch=205.8] | Loss=0.02082 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.723 | L2-Norm(final)=13.640 | 8600.9 samples/s | 134.4 steps/s
[Step=42250 Epoch=206.0] | Loss=0.02036 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.723 | L2-Norm(final)=13.640 | 2677.5 samples/s | 41.8 steps/s
[Step=42300 Epoch=206.3] | Loss=0.02034 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.723 | L2-Norm(final)=13.641 | 5528.7 samples/s | 86.4 steps/s
[Step=42350 Epoch=206.5] | Loss=0.02034 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.723 | L2-Norm(final)=13.641 | 5578.4 samples/s | 87.2 steps/s
[Step=42400 Epoch=206.8] | Loss=0.02072 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.723 | L2-Norm(final)=13.642 | 7648.1 samples/s | 119.5 steps/s
[Step=42450 Epoch=207.0] | Loss=0.02039 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=13.642 | 2777.8 samples/s | 43.4 steps/s
[Step=42500 Epoch=207.2] | Loss=0.02028 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=13.642 | 5662.7 samples/s | 88.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=207.2] | Loss=0.02195 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.723 | L2-Norm(final)=13.647 | 7741.4 samples/s | 121.0 steps/s
[Step=42550 Epoch=207.5] | Loss=0.01563 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.730 | L2-Norm(final)=13.648 | 4034.0 samples/s | 63.0 steps/s
[Step=42600 Epoch=207.7] | Loss=0.01655 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.738 | L2-Norm(final)=13.650 | 4757.3 samples/s | 74.3 steps/s
[Step=42650 Epoch=208.0] | Loss=0.01637 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.746 | L2-Norm(final)=13.652 | 4759.2 samples/s | 74.4 steps/s
[Step=42700 Epoch=208.2] | Loss=0.01512 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.752 | L2-Norm(final)=13.655 | 6884.6 samples/s | 107.6 steps/s
[Step=42750 Epoch=208.5] | Loss=0.01345 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.757 | L2-Norm(final)=13.658 | 2499.9 samples/s | 39.1 steps/s
[Step=42800 Epoch=208.7] | Loss=0.01200 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.763 | L2-Norm(final)=13.662 | 4768.1 samples/s | 74.5 steps/s
[Step=42850 Epoch=208.9] | Loss=0.01117 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.768 | L2-Norm(final)=13.665 | 4764.5 samples/s | 74.4 steps/s
[Step=42900 Epoch=209.2] | Loss=0.01051 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.772 | L2-Norm(final)=13.669 | 6106.7 samples/s | 95.4 steps/s
[Step=42950 Epoch=209.4] | Loss=0.00991 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.777 | L2-Norm(final)=13.673 | 2569.2 samples/s | 40.1 steps/s
[Step=43000 Epoch=209.7] | Loss=0.00939 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.781 | L2-Norm(final)=13.676 | 4882.9 samples/s | 76.3 steps/s
[Step=43050 Epoch=209.9] | Loss=0.00903 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.785 | L2-Norm(final)=13.680 | 4695.0 samples/s | 73.4 steps/s
[Step=43100 Epoch=210.2] | Loss=0.00868 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.789 | L2-Norm(final)=13.684 | 5621.1 samples/s | 87.8 steps/s
[Step=43150 Epoch=210.4] | Loss=0.00822 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.793 | L2-Norm(final)=13.687 | 2663.2 samples/s | 41.6 steps/s
[Step=43200 Epoch=210.7] | Loss=0.00794 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.796 | L2-Norm(final)=13.690 | 4754.2 samples/s | 74.3 steps/s
[Step=43250 Epoch=210.9] | Loss=0.00770 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.800 | L2-Norm(final)=13.694 | 4755.8 samples/s | 74.3 steps/s
[Step=43300 Epoch=211.1] | Loss=0.00748 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=13.697 | 5299.8 samples/s | 82.8 steps/s
[Step=43350 Epoch=211.4] | Loss=0.00725 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.807 | L2-Norm(final)=13.700 | 2783.4 samples/s | 43.5 steps/s
[Step=43400 Epoch=211.6] | Loss=0.00710 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.810 | L2-Norm(final)=13.703 | 4767.7 samples/s | 74.5 steps/s
[Step=43450 Epoch=211.9] | Loss=0.00689 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=13.706 | 4750.2 samples/s | 74.2 steps/s
[Step=43500 Epoch=212.1] | Loss=0.00668 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=13.709 | 4887.3 samples/s | 76.4 steps/s
[Step=43550 Epoch=212.4] | Loss=0.00656 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.818 | L2-Norm(final)=13.712 | 2907.4 samples/s | 45.4 steps/s
[Step=43600 Epoch=212.6] | Loss=0.00645 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.821 | L2-Norm(final)=13.715 | 4736.5 samples/s | 74.0 steps/s
[Step=43650 Epoch=212.8] | Loss=0.00630 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=13.718 | 4757.2 samples/s | 74.3 steps/s
[Step=43700 Epoch=213.1] | Loss=0.00620 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.827 | L2-Norm(final)=13.720 | 4793.2 samples/s | 74.9 steps/s
[Step=43750 Epoch=213.3] | Loss=0.00610 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.829 | L2-Norm(final)=13.723 | 2933.9 samples/s | 45.8 steps/s
[Step=43800 Epoch=213.6] | Loss=0.00595 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.832 | L2-Norm(final)=13.726 | 4732.9 samples/s | 74.0 steps/s
[Step=43850 Epoch=213.8] | Loss=0.00586 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.834 | L2-Norm(final)=13.728 | 4789.7 samples/s | 74.8 steps/s
[Step=43900 Epoch=214.1] | Loss=0.00581 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.837 | L2-Norm(final)=13.731 | 4768.2 samples/s | 74.5 steps/s
[Step=43950 Epoch=214.3] | Loss=0.00572 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.839 | L2-Norm(final)=13.734 | 2971.4 samples/s | 46.4 steps/s
[Step=44000 Epoch=214.6] | Loss=0.00560 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.841 | L2-Norm(final)=13.736 | 4750.4 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step44000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=48001 Epoch=234.2] | Loss=0.01151 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=15.379 | 6912.1 samples/s | 108.0 steps/s
[Step=48050 Epoch=234.5] | Loss=0.01547 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.724 | L2-Norm(final)=15.384 | 5205.9 samples/s | 81.3 steps/s
[Step=48100 Epoch=234.7] | Loss=0.01818 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.724 | L2-Norm(final)=15.389 | 5469.5 samples/s | 85.5 steps/s
[Step=48150 Epoch=234.9] | Loss=0.01758 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.724 | L2-Norm(final)=15.394 | 5629.8 samples/s | 88.0 steps/s
[Step=48200 Epoch=235.2] | Loss=0.01778 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.724 | L2-Norm(final)=15.399 | 8529.6 samples/s | 133.3 steps/s
[Step=48250 Epoch=235.4] | Loss=0.01707 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.724 | L2-Norm(final)=15.402 | 2638.8 samples/s | 41.2 steps/s
[Step=48300 Epoch=235.7] | Loss=0.01667 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.724 | L2-Norm(final)=15.406 | 5595.1 samples/s | 87.4 steps/s
[Step=48350 Epoch=235.9] | Loss=0.01693 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.724 | L2-Norm(final)=15.410 | 5487.1 samples/s | 85.7 steps/s
[Step=48400 Epoch=236.2] | Loss=0.01733 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.724 | L2-Norm(final)=15.413 | 7836.3 samples/s | 122.4 steps/s
[Step=48450 Epoch=236.4] | Loss=0.01691 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.724 | L2-Norm(final)=15.416 | 2737.8 samples/s | 42.8 steps/s
[Step=48500 Epoch=236.7] | Loss=0.01670 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.724 | L2-Norm(final)=15.419 | 5564.6 samples/s | 86.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=48501 Epoch=236.7] | Loss=0.00109 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.724 | L2-Norm(final)=15.450 | 7326.2 samples/s | 114.5 steps/s
[Step=48550 Epoch=236.9] | Loss=0.01683 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.729 | L2-Norm(final)=15.450 | 4204.9 samples/s | 65.7 steps/s
[Step=48600 Epoch=237.1] | Loss=0.01505 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.736 | L2-Norm(final)=15.451 | 4853.7 samples/s | 75.8 steps/s
[Step=48650 Epoch=237.4] | Loss=0.01391 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.743 | L2-Norm(final)=15.453 | 4806.8 samples/s | 75.1 steps/s
[Step=48700 Epoch=237.6] | Loss=0.01304 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=15.456 | 6660.3 samples/s | 104.1 steps/s
[Step=48750 Epoch=237.9] | Loss=0.01145 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.754 | L2-Norm(final)=15.458 | 2488.6 samples/s | 38.9 steps/s
[Step=48800 Epoch=238.1] | Loss=0.01036 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.759 | L2-Norm(final)=15.461 | 4720.3 samples/s | 73.8 steps/s
[Step=48850 Epoch=238.4] | Loss=0.00952 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.763 | L2-Norm(final)=15.464 | 4794.3 samples/s | 74.9 steps/s
[Step=48900 Epoch=238.6] | Loss=0.00896 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=15.467 | 6230.0 samples/s | 97.3 steps/s
[Step=48950 Epoch=238.9] | Loss=0.00837 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.771 | L2-Norm(final)=15.470 | 2544.2 samples/s | 39.8 steps/s
[Step=49000 Epoch=239.1] | Loss=0.00803 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.774 | L2-Norm(final)=15.473 | 4737.6 samples/s | 74.0 steps/s
[Step=49050 Epoch=239.3] | Loss=0.00763 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.778 | L2-Norm(final)=15.476 | 4806.6 samples/s | 75.1 steps/s
[Step=49100 Epoch=239.6] | Loss=0.00727 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.781 | L2-Norm(final)=15.478 | 5811.1 samples/s | 90.8 steps/s
[Step=49150 Epoch=239.8] | Loss=0.00695 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.784 | L2-Norm(final)=15.481 | 2619.4 samples/s | 40.9 steps/s
[Step=49200 Epoch=240.1] | Loss=0.00669 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.787 | L2-Norm(final)=15.484 | 4698.7 samples/s | 73.4 steps/s
[Step=49250 Epoch=240.3] | Loss=0.00644 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.790 | L2-Norm(final)=15.486 | 4807.1 samples/s | 75.1 steps/s
[Step=49300 Epoch=240.6] | Loss=0.00623 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.793 | L2-Norm(final)=15.489 | 5468.7 samples/s | 85.4 steps/s
[Step=49350 Epoch=240.8] | Loss=0.00601 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.795 | L2-Norm(final)=15.491 | 2727.7 samples/s | 42.6 steps/s
[Step=49400 Epoch=241.0] | Loss=0.00580 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.798 | L2-Norm(final)=15.494 | 4652.8 samples/s | 72.7 steps/s
[Step=49450 Epoch=241.3] | Loss=0.00566 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.800 | L2-Norm(final)=15.496 | 4744.6 samples/s | 74.1 steps/s
[Step=49500 Epoch=241.5] | Loss=0.00555 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=15.499 | 5162.9 samples/s | 80.7 steps/s
[Step=49550 Epoch=241.8] | Loss=0.00544 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.805 | L2-Norm(final)=15.501 | 2830.0 samples/s | 44.2 steps/s
[Step=49600 Epoch=242.0] | Loss=0.00534 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.807 | L2-Norm(final)=15.503 | 4806.4 samples/s | 75.1 steps/s
[Step=49650 Epoch=242.3] | Loss=0.00518 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.809 | L2-Norm(final)=15.505 | 4669.8 samples/s | 73.0 steps/s
[Step=49700 Epoch=242.5] | Loss=0.00511 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.812 | L2-Norm(final)=15.508 | 4859.1 samples/s | 75.9 steps/s
[Step=49750 Epoch=242.8] | Loss=0.00501 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.814 | L2-Norm(final)=15.510 | 2902.5 samples/s | 45.4 steps/s
[Step=49800 Epoch=243.0] | Loss=0.00489 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=15.512 | 4758.0 samples/s | 74.3 steps/s
[Step=49850 Epoch=243.2] | Loss=0.00484 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.818 | L2-Norm(final)=15.514 | 4747.5 samples/s | 74.2 steps/s
[Step=49900 Epoch=243.5] | Loss=0.00475 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.820 | L2-Norm(final)=15.516 | 4778.2 samples/s | 74.7 steps/s
[Step=49950 Epoch=243.7] | Loss=0.00467 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.821 | L2-Norm(final)=15.518 | 2974.7 samples/s | 46.5 steps/s
[Step=50000 Epoch=244.0] | Loss=0.00456 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.823 | L2-Norm(final)=15.520 | 4670.2 samples/s | 73.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step50000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=44001 Epoch=214.4] | Loss=0.00994 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=14.182 | 7518.0 samples/s | 117.5 steps/s
[Step=44050 Epoch=214.6] | Loss=0.01544 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.723 | L2-Norm(final)=14.185 | 5045.5 samples/s | 78.8 steps/s
[Step=44100 Epoch=214.9] | Loss=0.01387 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=14.189 | 5405.6 samples/s | 84.5 steps/s
[Step=44150 Epoch=215.1] | Loss=0.01484 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.723 | L2-Norm(final)=14.192 | 5612.2 samples/s | 87.7 steps/s
[Step=44200 Epoch=215.4] | Loss=0.01566 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=14.196 | 8666.4 samples/s | 135.4 steps/s
[Step=44250 Epoch=215.6] | Loss=0.01621 | Reg=0.00095 | acc=0.9531 | L2-Norm=9.723 | L2-Norm(final)=14.199 | 2662.9 samples/s | 41.6 steps/s
[Step=44300 Epoch=215.9] | Loss=0.01584 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=14.202 | 5601.4 samples/s | 87.5 steps/s
[Step=44350 Epoch=216.1] | Loss=0.01563 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.723 | L2-Norm(final)=14.205 | 5553.7 samples/s | 86.8 steps/s
[Step=44400 Epoch=216.3] | Loss=0.01551 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=14.208 | 7681.7 samples/s | 120.0 steps/s
[Step=44450 Epoch=216.6] | Loss=0.01517 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.723 | L2-Norm(final)=14.211 | 2712.1 samples/s | 42.4 steps/s
[Step=44500 Epoch=216.8] | Loss=0.01534 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=14.214 | 5405.1 samples/s | 84.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=216.8] | Loss=0.06633 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.723 | L2-Norm(final)=14.246 | 7308.5 samples/s | 114.2 steps/s
[Step=44550 Epoch=217.1] | Loss=0.01557 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.730 | L2-Norm(final)=14.247 | 4205.8 samples/s | 65.7 steps/s
[Step=44600 Epoch=217.3] | Loss=0.01433 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.738 | L2-Norm(final)=14.250 | 4819.9 samples/s | 75.3 steps/s
[Step=44650 Epoch=217.6] | Loss=0.01383 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.744 | L2-Norm(final)=14.253 | 4745.3 samples/s | 74.1 steps/s
[Step=44700 Epoch=217.8] | Loss=0.01263 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.749 | L2-Norm(final)=14.256 | 6822.5 samples/s | 106.6 steps/s
[Step=44750 Epoch=218.0] | Loss=0.01104 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.755 | L2-Norm(final)=14.259 | 2488.7 samples/s | 38.9 steps/s
[Step=44800 Epoch=218.3] | Loss=0.00993 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.760 | L2-Norm(final)=14.263 | 4904.4 samples/s | 76.6 steps/s
[Step=44850 Epoch=218.5] | Loss=0.00924 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.764 | L2-Norm(final)=14.266 | 4638.6 samples/s | 72.5 steps/s
[Step=44900 Epoch=218.8] | Loss=0.00881 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=14.270 | 6196.2 samples/s | 96.8 steps/s
[Step=44950 Epoch=219.0] | Loss=0.00828 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.772 | L2-Norm(final)=14.273 | 2573.1 samples/s | 40.2 steps/s
[Step=45000 Epoch=219.3] | Loss=0.00775 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.776 | L2-Norm(final)=14.277 | 4781.1 samples/s | 74.7 steps/s
[Step=45050 Epoch=219.5] | Loss=0.00741 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.780 | L2-Norm(final)=14.280 | 4724.7 samples/s | 73.8 steps/s
[Step=45100 Epoch=219.7] | Loss=0.00714 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.784 | L2-Norm(final)=14.284 | 5716.1 samples/s | 89.3 steps/s
[Step=45150 Epoch=220.0] | Loss=0.00688 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.787 | L2-Norm(final)=14.287 | 2677.9 samples/s | 41.8 steps/s
[Step=45200 Epoch=220.2] | Loss=0.00663 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.790 | L2-Norm(final)=14.290 | 4829.6 samples/s | 75.5 steps/s
[Step=45250 Epoch=220.5] | Loss=0.00636 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.794 | L2-Norm(final)=14.293 | 4833.4 samples/s | 75.5 steps/s
[Step=45300 Epoch=220.7] | Loss=0.00624 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.797 | L2-Norm(final)=14.297 | 5108.9 samples/s | 79.8 steps/s
[Step=45350 Epoch=221.0] | Loss=0.00604 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.800 | L2-Norm(final)=14.300 | 2792.3 samples/s | 43.6 steps/s
[Step=45400 Epoch=221.2] | Loss=0.00588 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=14.303 | 4768.4 samples/s | 74.5 steps/s
[Step=45450 Epoch=221.5] | Loss=0.00576 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=14.306 | 4831.1 samples/s | 75.5 steps/s
[Step=45500 Epoch=221.7] | Loss=0.00562 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.809 | L2-Norm(final)=14.309 | 4854.0 samples/s | 75.8 steps/s
[Step=45550 Epoch=221.9] | Loss=0.00549 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.811 | L2-Norm(final)=14.311 | 2880.0 samples/s | 45.0 steps/s
[Step=45600 Epoch=222.2] | Loss=0.00538 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.814 | L2-Norm(final)=14.314 | 4806.9 samples/s | 75.1 steps/s
[Step=45650 Epoch=222.4] | Loss=0.00527 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.817 | L2-Norm(final)=14.317 | 4729.4 samples/s | 73.9 steps/s
[Step=45700 Epoch=222.7] | Loss=0.00516 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.819 | L2-Norm(final)=14.320 | 4850.8 samples/s | 75.8 steps/s
[Step=45750 Epoch=222.9] | Loss=0.00504 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.822 | L2-Norm(final)=14.323 | 2886.8 samples/s | 45.1 steps/s
[Step=45800 Epoch=223.2] | Loss=0.00493 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=14.325 | 4817.9 samples/s | 75.3 steps/s
[Step=45850 Epoch=223.4] | Loss=0.00485 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=14.328 | 4716.1 samples/s | 73.7 steps/s
[Step=45900 Epoch=223.6] | Loss=0.00480 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.829 | L2-Norm(final)=14.330 | 4818.5 samples/s | 75.3 steps/s
[Step=45950 Epoch=223.9] | Loss=0.00472 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.831 | L2-Norm(final)=14.333 | 2927.0 samples/s | 45.7 steps/s
[Step=46000 Epoch=224.1] | Loss=0.00465 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.833 | L2-Norm(final)=14.336 | 4760.7 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step46000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=34001 Epoch=165.8] | Loss=0.02535 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.723 | L2-Norm(final)=14.439 | 7878.9 samples/s | 123.1 steps/s
[Step=34050 Epoch=166.0] | Loss=0.02284 | Reg=0.00095 | acc=0.9375 | L2-Norm=9.724 | L2-Norm(final)=14.438 | 4547.5 samples/s | 71.1 steps/s
[Step=34100 Epoch=166.3] | Loss=0.01868 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.724 | L2-Norm(final)=14.440 | 5538.0 samples/s | 86.5 steps/s
[Step=34150 Epoch=166.5] | Loss=0.01784 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.724 | L2-Norm(final)=14.443 | 5542.3 samples/s | 86.6 steps/s
[Step=34200 Epoch=166.8] | Loss=0.01723 | Reg=0.00095 | acc=0.9531 | L2-Norm=9.724 | L2-Norm(final)=14.447 | 8781.4 samples/s | 137.2 steps/s
[Step=34250 Epoch=167.0] | Loss=0.01613 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.724 | L2-Norm(final)=14.451 | 2669.7 samples/s | 41.7 steps/s
[Step=34300 Epoch=167.3] | Loss=0.01657 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.724 | L2-Norm(final)=14.455 | 5435.4 samples/s | 84.9 steps/s
[Step=34350 Epoch=167.5] | Loss=0.01717 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.724 | L2-Norm(final)=14.458 | 5580.0 samples/s | 87.2 steps/s
[Step=34400 Epoch=167.8] | Loss=0.01708 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.724 | L2-Norm(final)=14.461 | 7652.5 samples/s | 119.6 steps/s
[Step=34450 Epoch=168.0] | Loss=0.01675 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.724 | L2-Norm(final)=14.464 | 2562.0 samples/s | 40.0 steps/s
[Step=34500 Epoch=168.2] | Loss=0.01698 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.724 | L2-Norm(final)=14.466 | 5503.5 samples/s | 86.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=34501 Epoch=168.2] | Loss=0.00590 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.724 | L2-Norm(final)=14.489 | 7059.7 samples/s | 110.3 steps/s
[Step=34550 Epoch=168.5] | Loss=0.01468 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.731 | L2-Norm(final)=14.489 | 4316.2 samples/s | 67.4 steps/s
[Step=34600 Epoch=168.7] | Loss=0.01546 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=14.491 | 4742.4 samples/s | 74.1 steps/s
[Step=34650 Epoch=169.0] | Loss=0.01430 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.745 | L2-Norm(final)=14.493 | 4756.6 samples/s | 74.3 steps/s
[Step=34700 Epoch=169.2] | Loss=0.01339 | Reg=0.00095 | acc=0.9531 | L2-Norm=9.752 | L2-Norm(final)=14.495 | 6870.0 samples/s | 107.3 steps/s
[Step=34750 Epoch=169.5] | Loss=0.01200 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.758 | L2-Norm(final)=14.498 | 2489.3 samples/s | 38.9 steps/s
[Step=34800 Epoch=169.7] | Loss=0.01091 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.764 | L2-Norm(final)=14.501 | 4759.2 samples/s | 74.4 steps/s
[Step=34850 Epoch=169.9] | Loss=0.01012 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.769 | L2-Norm(final)=14.504 | 4852.4 samples/s | 75.8 steps/s
[Step=34900 Epoch=170.2] | Loss=0.00938 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.773 | L2-Norm(final)=14.507 | 6088.9 samples/s | 95.1 steps/s
[Step=34950 Epoch=170.4] | Loss=0.00873 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.777 | L2-Norm(final)=14.510 | 2580.9 samples/s | 40.3 steps/s
[Step=35000 Epoch=170.7] | Loss=0.00823 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.781 | L2-Norm(final)=14.513 | 4732.6 samples/s | 73.9 steps/s
[Step=35050 Epoch=170.9] | Loss=0.00786 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.785 | L2-Norm(final)=14.516 | 4791.8 samples/s | 74.9 steps/s
[Step=35100 Epoch=171.2] | Loss=0.00750 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.789 | L2-Norm(final)=14.519 | 5682.0 samples/s | 88.8 steps/s
[Step=35150 Epoch=171.4] | Loss=0.00710 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.792 | L2-Norm(final)=14.522 | 2665.3 samples/s | 41.6 steps/s
[Step=35200 Epoch=171.7] | Loss=0.00684 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.796 | L2-Norm(final)=14.526 | 4744.7 samples/s | 74.1 steps/s
[Step=35250 Epoch=171.9] | Loss=0.00653 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.799 | L2-Norm(final)=14.529 | 4808.3 samples/s | 75.1 steps/s
[Step=35300 Epoch=172.1] | Loss=0.00634 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.802 | L2-Norm(final)=14.532 | 5242.6 samples/s | 81.9 steps/s
[Step=35350 Epoch=172.4] | Loss=0.00620 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.805 | L2-Norm(final)=14.534 | 2791.5 samples/s | 43.6 steps/s
[Step=35400 Epoch=172.6] | Loss=0.00600 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.808 | L2-Norm(final)=14.537 | 4707.9 samples/s | 73.6 steps/s
[Step=35450 Epoch=172.9] | Loss=0.00585 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.811 | L2-Norm(final)=14.540 | 4762.8 samples/s | 74.4 steps/s
[Step=35500 Epoch=173.1] | Loss=0.00568 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=14.543 | 4905.4 samples/s | 76.6 steps/s
[Step=35550 Epoch=173.4] | Loss=0.00552 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=14.545 | 2865.9 samples/s | 44.8 steps/s
[Step=35600 Epoch=173.6] | Loss=0.00539 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.819 | L2-Norm(final)=14.548 | 4765.3 samples/s | 74.5 steps/s
[Step=35650 Epoch=173.8] | Loss=0.00533 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.821 | L2-Norm(final)=14.551 | 4761.8 samples/s | 74.4 steps/s
[Step=35700 Epoch=174.1] | Loss=0.00520 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=14.553 | 4770.7 samples/s | 74.5 steps/s
[Step=35750 Epoch=174.3] | Loss=0.00510 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.826 | L2-Norm(final)=14.556 | 2957.3 samples/s | 46.2 steps/s
[Step=35800 Epoch=174.6] | Loss=0.00500 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.829 | L2-Norm(final)=14.558 | 4767.3 samples/s | 74.5 steps/s
[Step=35850 Epoch=174.8] | Loss=0.00493 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.831 | L2-Norm(final)=14.561 | 4755.9 samples/s | 74.3 steps/s
[Step=35900 Epoch=175.1] | Loss=0.00483 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.833 | L2-Norm(final)=14.563 | 4769.6 samples/s | 74.5 steps/s
[Step=35950 Epoch=175.3] | Loss=0.00476 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.836 | L2-Norm(final)=14.566 | 2941.0 samples/s | 46.0 steps/s
[Step=36000 Epoch=175.6] | Loss=0.00469 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.838 | L2-Norm(final)=14.568 | 4815.0 samples/s | 75.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step36000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=44001 Epoch=414.6] | Loss=0.00006 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=16.108 | 7035.2 samples/s | 109.9 steps/s
[Step=44050 Epoch=415.1] | Loss=0.00066 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=16.112 | 4565.0 samples/s | 71.3 steps/s
[Step=44100 Epoch=415.5] | Loss=0.00048 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=16.119 | 8157.1 samples/s | 127.5 steps/s
[Step=44150 Epoch=416.0] | Loss=0.00048 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=16.125 | 2614.5 samples/s | 40.9 steps/s
[Step=44200 Epoch=416.5] | Loss=0.00052 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=16.130 | 6815.2 samples/s | 106.5 steps/s
[Step=44250 Epoch=417.0] | Loss=0.00051 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=16.135 | 2758.7 samples/s | 43.1 steps/s
[Step=44300 Epoch=417.4] | Loss=0.00048 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=16.140 | 6082.3 samples/s | 95.0 steps/s
[Step=44350 Epoch=417.9] | Loss=0.00050 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=16.145 | 2872.8 samples/s | 44.9 steps/s
[Step=44400 Epoch=418.4] | Loss=0.00050 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=16.149 | 5460.7 samples/s | 85.3 steps/s
[Step=44450 Epoch=418.8] | Loss=0.00049 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=16.153 | 3027.4 samples/s | 47.3 steps/s
[Step=44500 Epoch=419.3] | Loss=0.00049 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=16.157 | 5337.6 samples/s | 83.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=419.3] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=16.197 | 6833.1 samples/s | 106.8 steps/s
[Step=44550 Epoch=419.8] | Loss=0.00078 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.728 | L2-Norm(final)=16.198 | 4140.6 samples/s | 64.7 steps/s
[Step=44600 Epoch=420.3] | Loss=0.00051 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.735 | L2-Norm(final)=16.199 | 6414.9 samples/s | 100.2 steps/s
[Step=44650 Epoch=420.7] | Loss=0.00036 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=16.201 | 2338.8 samples/s | 36.5 steps/s
[Step=44700 Epoch=421.2] | Loss=0.00028 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=16.201 | 5775.5 samples/s | 90.2 steps/s
[Step=44750 Epoch=421.7] | Loss=0.00022 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=16.202 | 2502.7 samples/s | 39.1 steps/s
[Step=44800 Epoch=422.1] | Loss=0.00019 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=16.202 | 5281.8 samples/s | 82.5 steps/s
[Step=44850 Epoch=422.6] | Loss=0.00016 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.737 | L2-Norm(final)=16.203 | 2645.6 samples/s | 41.3 steps/s
[Step=44900 Epoch=423.1] | Loss=0.00014 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.736 | L2-Norm(final)=16.203 | 4738.6 samples/s | 74.0 steps/s
[Step=44950 Epoch=423.6] | Loss=0.00013 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.735 | L2-Norm(final)=16.203 | 2760.3 samples/s | 43.1 steps/s
[Step=45000 Epoch=424.0] | Loss=0.00012 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.733 | L2-Norm(final)=16.204 | 4509.5 samples/s | 70.5 steps/s
[Step=45050 Epoch=424.5] | Loss=0.00011 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.732 | L2-Norm(final)=16.204 | 2873.3 samples/s | 44.9 steps/s
[Step=45100 Epoch=425.0] | Loss=0.00010 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.731 | L2-Norm(final)=16.204 | 4582.8 samples/s | 71.6 steps/s
[Step=45150 Epoch=425.4] | Loss=0.00009 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.729 | L2-Norm(final)=16.205 | 2814.0 samples/s | 44.0 steps/s
[Step=45200 Epoch=425.9] | Loss=0.00009 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.728 | L2-Norm(final)=16.205 | 4577.9 samples/s | 71.5 steps/s
[Step=45250 Epoch=426.4] | Loss=0.00008 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.726 | L2-Norm(final)=16.205 | 3195.0 samples/s | 49.9 steps/s
[Step=45300 Epoch=426.9] | Loss=0.00008 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.724 | L2-Norm(final)=16.205 | 3948.0 samples/s | 61.7 steps/s
[Step=45350 Epoch=427.3] | Loss=0.00007 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=16.206 | 6632.6 samples/s | 103.6 steps/s
[Step=45400 Epoch=427.8] | Loss=0.00007 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=16.206 | 2380.8 samples/s | 37.2 steps/s
[Step=45450 Epoch=428.3] | Loss=0.00006 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.720 | L2-Norm(final)=16.206 | 5967.7 samples/s | 93.2 steps/s
[Step=45500 Epoch=428.7] | Loss=0.00006 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.718 | L2-Norm(final)=16.206 | 2476.1 samples/s | 38.7 steps/s
[Step=45550 Epoch=429.2] | Loss=0.00006 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.716 | L2-Norm(final)=16.206 | 5330.5 samples/s | 83.3 steps/s
[Step=45600 Epoch=429.7] | Loss=0.00006 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.714 | L2-Norm(final)=16.207 | 2653.4 samples/s | 41.5 steps/s
[Step=45650 Epoch=430.2] | Loss=0.00005 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.713 | L2-Norm(final)=16.207 | 4753.9 samples/s | 74.3 steps/s
[Step=45700 Epoch=430.6] | Loss=0.00005 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.711 | L2-Norm(final)=16.207 | 2753.1 samples/s | 43.0 steps/s
[Step=45750 Epoch=431.1] | Loss=0.00005 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.709 | L2-Norm(final)=16.207 | 4560.6 samples/s | 71.3 steps/s
[Step=45800 Epoch=431.6] | Loss=0.00005 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.707 | L2-Norm(final)=16.208 | 2861.4 samples/s | 44.7 steps/s
[Step=45850 Epoch=432.0] | Loss=0.00005 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.705 | L2-Norm(final)=16.208 | 4531.4 samples/s | 70.8 steps/s
[Step=45900 Epoch=432.5] | Loss=0.00005 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.703 | L2-Norm(final)=16.208 | 2893.1 samples/s | 45.2 steps/s
[Step=45950 Epoch=433.0] | Loss=0.00004 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.702 | L2-Norm(final)=16.208 | 4531.4 samples/s | 70.8 steps/s
[Step=46000 Epoch=433.5] | Loss=0.00004 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.700 | L2-Norm(final)=16.209 | 2863.2 samples/s | 44.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step46000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07805 | acc=0.9652 | tpr=0.9759 | fpr=0.0582 | 5832.3 samples/s | 22.8 steps/s
Avg test loss: 0.08220, Avg test acc: 0.96302, Avg tpr: 0.97447, Avg fpr: 0.06217, total FA: 485

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08541 | acc=0.9637 | tpr=0.9765 | fpr=0.0639 | 5977.4 samples/s | 23.3 steps/s
Avg test loss: 0.08879, Avg test acc: 0.96234, Avg tpr: 0.97424, Avg fpr: 0.06384, total FA: 498

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08528 | acc=0.9635 | tpr=0.9742 | fpr=0.0597 | 5895.8 samples/s | 23.0 steps/s
Avg test loss: 0.08920, Avg test acc: 0.96129, Avg tpr: 0.97103, Avg fpr: 0.06012, total FA: 469

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08168 | acc=0.9633 | tpr=0.9777 | fpr=0.0681 | 6007.7 samples/s | 23.5 steps/s
Avg test loss: 0.08576, Avg test acc: 0.96250, Avg tpr: 0.97674, Avg fpr: 0.06884, total FA: 537

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08452 | acc=0.9630 | tpr=0.9739 | fpr=0.0605 | 6038.2 samples/s | 23.6 steps/s
Avg test loss: 0.08755, Avg test acc: 0.96210, Avg tpr: 0.97208, Avg fpr: 0.05986, total FA: 467

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.22356 | acc=0.2743 | tpr=0.0203 | fpr=0.1742 | 5985.8 samples/s | 23.4 steps/s
Avg test loss: 6.22949, Avg test acc: 0.27326, Avg tpr: 0.01923, Avg fpr: 0.16806, total FA: 1311

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.51065 | acc=0.3063 | tpr=0.0300 | fpr=0.0937 | 5875.2 samples/s | 23.0 steps/s
Avg test loss: 4.51916, Avg test acc: 0.30471, Avg tpr: 0.02967, Avg fpr: 0.09037, total FA: 705

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.84255 | acc=0.2929 | tpr=0.0245 | fpr=0.1244 | 5805.6 samples/s | 22.7 steps/s
Avg test loss: 4.84905, Avg test acc: 0.29165, Avg tpr: 0.02349, Avg fpr: 0.11857, total FA: 925

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.87807 | acc=0.2747 | tpr=0.0285 | fpr=0.1908 | 5966.1 samples/s | 23.3 steps/s
Avg test loss: 4.88206, Avg test acc: 0.27390, Avg tpr: 0.02664, Avg fpr: 0.18228, total FA: 1422

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.90266 | acc=0.2911 | tpr=0.0189 | fpr=0.1179 | 5788.4 samples/s | 22.6 steps/s
Avg test loss: 4.91703, Avg test acc: 0.29033, Avg tpr: 0.01883, Avg fpr: 0.11255, total FA: 878

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.10174 | acc=0.1237 | tpr=0.6239 | fpr=0.8853 | 6052.9 samples/s | 23.6 steps/s
[Step= 100] | Loss=5.09013 | acc=0.1261 | tpr=0.6141 | fpr=0.8830 | 7641.4 samples/s | 29.8 steps/s
[Step= 150] | Loss=5.07950 | acc=0.1288 | tpr=0.6268 | fpr=0.8804 | 8044.4 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.06874 | acc=0.1290 | tpr=0.6186 | fpr=0.8799 | 7768.8 samples/s | 30.3 steps/s
[Step= 250] | Loss=5.07426 | acc=0.1288 | tpr=0.6096 | fpr=0.8799 | 7238.6 samples/s | 28.3 steps/s
[Step= 300] | Loss=5.06819 | acc=0.1286 | tpr=0.6015 | fpr=0.8800 | 8423.2 samples/s | 32.9 steps/s
[Step= 350] | Loss=5.07340 | acc=0.1288 | tpr=0.5974 | fpr=0.8797 | 8267.8 samples/s | 32.3 steps/s
[Step= 400] | Loss=5.07099 | acc=0.1291 | tpr=0.5952 | fpr=0.8794 | 8291.9 samples/s | 32.4 steps/s
[Step= 450] | Loss=5.07615 | acc=0.1286 | tpr=0.5983 | fpr=0.8799 | 8131.6 samples/s | 31.8 steps/s
[Step= 500] | Loss=5.07619 | acc=0.1284 | tpr=0.6013 | fpr=0.8801 | 8411.4 samples/s | 32.9 steps/s
[Step= 550] | Loss=5.07925 | acc=0.1285 | tpr=0.6029 | fpr=0.8801 | 9951.5 samples/s | 38.9 steps/s
Avg test loss: 5.07956, Avg test acc: 0.12839, Avg tpr: 0.60380, Avg fpr: 0.88025, total FA: 122221

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.94226 | acc=0.1315 | tpr=0.5796 | fpr=0.8766 | 5712.5 samples/s | 22.3 steps/s
[Step= 100] | Loss=4.93487 | acc=0.1347 | tpr=0.5821 | fpr=0.8737 | 8404.5 samples/s | 32.8 steps/s
[Step= 150] | Loss=4.92374 | acc=0.1376 | tpr=0.6066 | fpr=0.8711 | 8027.3 samples/s | 31.4 steps/s
[Step= 200] | Loss=4.91413 | acc=0.1382 | tpr=0.6022 | fpr=0.8702 | 8051.9 samples/s | 31.5 steps/s
[Step= 250] | Loss=4.91908 | acc=0.1378 | tpr=0.5974 | fpr=0.8705 | 7751.7 samples/s | 30.3 steps/s
[Step= 300] | Loss=4.91575 | acc=0.1373 | tpr=0.5905 | fpr=0.8710 | 8405.5 samples/s | 32.8 steps/s
[Step= 350] | Loss=4.92063 | acc=0.1370 | tpr=0.5855 | fpr=0.8712 | 7470.4 samples/s | 29.2 steps/s
[Step= 400] | Loss=4.91822 | acc=0.1374 | tpr=0.5870 | fpr=0.8708 | 8312.0 samples/s | 32.5 steps/s
[Step= 450] | Loss=4.92227 | acc=0.1368 | tpr=0.5925 | fpr=0.8715 | 7909.5 samples/s | 30.9 steps/s
[Step= 500] | Loss=4.92337 | acc=0.1366 | tpr=0.5947 | fpr=0.8717 | 8233.7 samples/s | 32.2 steps/s
[Step= 550] | Loss=4.92696 | acc=0.1369 | tpr=0.5965 | fpr=0.8715 | 10629.8 samples/s | 41.5 steps/s
Avg test loss: 4.92714, Avg test acc: 0.13677, Avg tpr: 0.59786, Avg fpr: 0.87162, total FA: 121022

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.12202 | acc=0.1241 | tpr=0.5708 | fpr=0.8840 | 6036.2 samples/s | 23.6 steps/s
[Step= 100] | Loss=5.10821 | acc=0.1264 | tpr=0.5778 | fpr=0.8820 | 7918.2 samples/s | 30.9 steps/s
[Step= 150] | Loss=5.09892 | acc=0.1288 | tpr=0.5893 | fpr=0.8796 | 7469.2 samples/s | 29.2 steps/s
[Step= 200] | Loss=5.08957 | acc=0.1294 | tpr=0.5836 | fpr=0.8788 | 7681.7 samples/s | 30.0 steps/s
[Step= 250] | Loss=5.09588 | acc=0.1295 | tpr=0.5825 | fpr=0.8787 | 7761.0 samples/s | 30.3 steps/s
[Step= 300] | Loss=5.09195 | acc=0.1294 | tpr=0.5804 | fpr=0.8788 | 8817.2 samples/s | 34.4 steps/s
[Step= 350] | Loss=5.09689 | acc=0.1294 | tpr=0.5792 | fpr=0.8787 | 8709.7 samples/s | 34.0 steps/s
[Step= 400] | Loss=5.09603 | acc=0.1296 | tpr=0.5799 | fpr=0.8786 | 8260.2 samples/s | 32.3 steps/s
[Step= 450] | Loss=5.10098 | acc=0.1289 | tpr=0.5808 | fpr=0.8793 | 7299.6 samples/s | 28.5 steps/s
[Step= 500] | Loss=5.10015 | acc=0.1287 | tpr=0.5811 | fpr=0.8795 | 8087.3 samples/s | 31.6 steps/s
[Step= 550] | Loss=5.10318 | acc=0.1288 | tpr=0.5794 | fpr=0.8794 | 9920.7 samples/s | 38.8 steps/s
Avg test loss: 5.10361, Avg test acc: 0.12867, Avg tpr: 0.58043, Avg fpr: 0.87954, total FA: 122122

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.97536 | acc=0.1264 | tpr=0.6549 | fpr=0.8831 | 5941.4 samples/s | 23.2 steps/s
[Step= 100] | Loss=4.96438 | acc=0.1298 | tpr=0.6546 | fpr=0.8800 | 7169.5 samples/s | 28.0 steps/s
[Step= 150] | Loss=4.95241 | acc=0.1315 | tpr=0.6585 | fpr=0.8782 | 8028.8 samples/s | 31.4 steps/s
[Step= 200] | Loss=4.94232 | acc=0.1320 | tpr=0.6557 | fpr=0.8776 | 8469.5 samples/s | 33.1 steps/s
[Step= 250] | Loss=4.94554 | acc=0.1317 | tpr=0.6454 | fpr=0.8776 | 8092.6 samples/s | 31.6 steps/s
[Step= 300] | Loss=4.94148 | acc=0.1313 | tpr=0.6422 | fpr=0.8781 | 7814.9 samples/s | 30.5 steps/s
[Step= 350] | Loss=4.94654 | acc=0.1312 | tpr=0.6412 | fpr=0.8781 | 8275.9 samples/s | 32.3 steps/s
[Step= 400] | Loss=4.94530 | acc=0.1314 | tpr=0.6411 | fpr=0.8779 | 7943.8 samples/s | 31.0 steps/s
[Step= 450] | Loss=4.95046 | acc=0.1305 | tpr=0.6446 | fpr=0.8789 | 7904.3 samples/s | 30.9 steps/s
[Step= 500] | Loss=4.95001 | acc=0.1304 | tpr=0.6489 | fpr=0.8790 | 7480.8 samples/s | 29.2 steps/s
[Step= 550] | Loss=4.95424 | acc=0.1303 | tpr=0.6498 | fpr=0.8791 | 11393.3 samples/s | 44.5 steps/s
Avg test loss: 4.95484, Avg test acc: 0.13027, Avg tpr: 0.65095, Avg fpr: 0.87919, total FA: 122074

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.97711 | acc=0.1332 | tpr=0.5177 | fpr=0.8737 | 5985.5 samples/s | 23.4 steps/s
[Step= 100] | Loss=4.96681 | acc=0.1348 | tpr=0.5053 | fpr=0.8721 | 7909.1 samples/s | 30.9 steps/s
[Step= 150] | Loss=4.95605 | acc=0.1369 | tpr=0.5202 | fpr=0.8701 | 7616.7 samples/s | 29.8 steps/s
[Step= 200] | Loss=4.94827 | acc=0.1382 | tpr=0.5115 | fpr=0.8686 | 8554.4 samples/s | 33.4 steps/s
[Step= 250] | Loss=4.95265 | acc=0.1380 | tpr=0.4996 | fpr=0.8686 | 7786.4 samples/s | 30.4 steps/s
[Step= 300] | Loss=4.94938 | acc=0.1378 | tpr=0.4909 | fpr=0.8686 | 7716.8 samples/s | 30.1 steps/s
[Step= 350] | Loss=4.95575 | acc=0.1376 | tpr=0.4890 | fpr=0.8688 | 8187.7 samples/s | 32.0 steps/s
[Step= 400] | Loss=4.95274 | acc=0.1378 | tpr=0.4902 | fpr=0.8686 | 8375.0 samples/s | 32.7 steps/s
[Step= 450] | Loss=4.95705 | acc=0.1371 | tpr=0.4932 | fpr=0.8694 | 7362.7 samples/s | 28.8 steps/s
[Step= 500] | Loss=4.95670 | acc=0.1372 | tpr=0.4943 | fpr=0.8693 | 7568.9 samples/s | 29.6 steps/s
[Step= 550] | Loss=4.95962 | acc=0.1373 | tpr=0.4930 | fpr=0.8691 | 11952.9 samples/s | 46.7 steps/s
Avg test loss: 4.96019, Avg test acc: 0.13722, Avg tpr: 0.49366, Avg fpr: 0.86926, total FA: 120695

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.21976 | acc=0.9595 | tpr=0.9513 | fpr=0.0404 | 5443.8 samples/s | 21.3 steps/s
[Step= 100] | Loss=0.22823 | acc=0.9584 | tpr=0.9574 | fpr=0.0416 | 8962.0 samples/s | 35.0 steps/s
[Step= 150] | Loss=0.23035 | acc=0.9570 | tpr=0.9553 | fpr=0.0429 | 8651.1 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.23058 | acc=0.9570 | tpr=0.9585 | fpr=0.0430 | 7784.6 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.23040 | acc=0.9570 | tpr=0.9563 | fpr=0.0430 | 8001.8 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.23398 | acc=0.9565 | tpr=0.9542 | fpr=0.0434 | 7339.8 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.23214 | acc=0.9568 | tpr=0.9537 | fpr=0.0432 | 7919.7 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.23197 | acc=0.9564 | tpr=0.9513 | fpr=0.0435 | 8206.4 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.23555 | acc=0.9559 | tpr=0.9499 | fpr=0.0440 | 8092.7 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.23593 | acc=0.9557 | tpr=0.9515 | fpr=0.0442 | 7827.2 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.23459 | acc=0.9561 | tpr=0.9522 | fpr=0.0439 | 10827.9 samples/s | 42.3 steps/s
Avg test loss: 0.23428, Avg test acc: 0.95607, Avg tpr: 0.95206, Avg fpr: 0.04385, total FA: 6089

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.17187 | acc=0.9609 | tpr=0.9248 | fpr=0.0384 | 6069.4 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.17931 | acc=0.9595 | tpr=0.9318 | fpr=0.0400 | 8319.9 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.18179 | acc=0.9581 | tpr=0.9323 | fpr=0.0414 | 7442.2 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.18224 | acc=0.9582 | tpr=0.9355 | fpr=0.0414 | 7755.7 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.18184 | acc=0.9583 | tpr=0.9371 | fpr=0.0413 | 8700.5 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.18488 | acc=0.9579 | tpr=0.9360 | fpr=0.0417 | 7939.8 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.18347 | acc=0.9580 | tpr=0.9361 | fpr=0.0416 | 7802.5 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.18396 | acc=0.9578 | tpr=0.9333 | fpr=0.0418 | 8269.5 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.18676 | acc=0.9573 | tpr=0.9333 | fpr=0.0423 | 7747.2 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.18644 | acc=0.9572 | tpr=0.9352 | fpr=0.0424 | 7906.6 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.18539 | acc=0.9575 | tpr=0.9371 | fpr=0.0422 | 10248.7 samples/s | 40.0 steps/s
Avg test loss: 0.18518, Avg test acc: 0.95750, Avg tpr: 0.93700, Avg fpr: 0.04213, total FA: 5850

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.24418 | acc=0.9513 | tpr=0.9558 | fpr=0.0488 | 5938.9 samples/s | 23.2 steps/s
[Step= 100] | Loss=0.25164 | acc=0.9502 | tpr=0.9595 | fpr=0.0500 | 8083.8 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.25563 | acc=0.9491 | tpr=0.9611 | fpr=0.0511 | 7757.0 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.25577 | acc=0.9493 | tpr=0.9628 | fpr=0.0509 | 8010.8 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.25616 | acc=0.9491 | tpr=0.9624 | fpr=0.0511 | 8228.7 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.25899 | acc=0.9489 | tpr=0.9600 | fpr=0.0513 | 8072.9 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.25709 | acc=0.9490 | tpr=0.9593 | fpr=0.0512 | 7783.9 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.25737 | acc=0.9487 | tpr=0.9584 | fpr=0.0515 | 7482.9 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.26077 | acc=0.9483 | tpr=0.9572 | fpr=0.0519 | 8666.0 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.26108 | acc=0.9482 | tpr=0.9577 | fpr=0.0520 | 8159.8 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.25942 | acc=0.9485 | tpr=0.9574 | fpr=0.0517 | 9616.8 samples/s | 37.6 steps/s
Avg test loss: 0.25918, Avg test acc: 0.94852, Avg tpr: 0.95721, Avg fpr: 0.05164, total FA: 7170

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15392 | acc=0.9636 | tpr=0.9336 | fpr=0.0359 | 5947.8 samples/s | 23.2 steps/s
[Step= 100] | Loss=0.15888 | acc=0.9627 | tpr=0.9446 | fpr=0.0370 | 7293.5 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.15963 | acc=0.9610 | tpr=0.9438 | fpr=0.0387 | 7937.0 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.15974 | acc=0.9611 | tpr=0.9475 | fpr=0.0386 | 8567.3 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.15985 | acc=0.9608 | tpr=0.9450 | fpr=0.0389 | 7974.7 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.16210 | acc=0.9604 | tpr=0.9440 | fpr=0.0393 | 8436.7 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.16118 | acc=0.9604 | tpr=0.9418 | fpr=0.0393 | 8292.6 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.16099 | acc=0.9601 | tpr=0.9404 | fpr=0.0395 | 7988.0 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.16359 | acc=0.9597 | tpr=0.9401 | fpr=0.0400 | 7652.6 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.16345 | acc=0.9597 | tpr=0.9427 | fpr=0.0400 | 7824.5 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.16260 | acc=0.9600 | tpr=0.9443 | fpr=0.0398 | 10014.7 samples/s | 39.1 steps/s
Avg test loss: 0.16239, Avg test acc: 0.95999, Avg tpr: 0.94414, Avg fpr: 0.03973, total FA: 5516

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21562 | acc=0.9586 | tpr=0.9513 | fpr=0.0413 | 5875.7 samples/s | 23.0 steps/s
[Step= 100] | Loss=0.22490 | acc=0.9569 | tpr=0.9574 | fpr=0.0431 | 8425.8 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.22815 | acc=0.9553 | tpr=0.9582 | fpr=0.0447 | 7719.0 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.22815 | acc=0.9552 | tpr=0.9596 | fpr=0.0449 | 8325.5 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.22848 | acc=0.9551 | tpr=0.9590 | fpr=0.0450 | 8076.2 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.23213 | acc=0.9546 | tpr=0.9549 | fpr=0.0454 | 7035.7 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.23079 | acc=0.9546 | tpr=0.9549 | fpr=0.0454 | 7883.0 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.23106 | acc=0.9542 | tpr=0.9513 | fpr=0.0457 | 7745.5 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.23452 | acc=0.9537 | tpr=0.9508 | fpr=0.0462 | 8178.9 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.23454 | acc=0.9536 | tpr=0.9502 | fpr=0.0463 | 8552.0 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.23306 | acc=0.9539 | tpr=0.9507 | fpr=0.0460 | 10298.3 samples/s | 40.2 steps/s
Avg test loss: 0.23287, Avg test acc: 0.95393, Avg tpr: 0.95048, Avg fpr: 0.04601, total FA: 6388

server round 44/50

clients selected: [0 3 5 6 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=44001 Epoch=214.6] | Loss=0.02480 | Reg=0.00094 | acc=0.9688 | L2-Norm=9.681 | L2-Norm(final)=13.812 | 6807.1 samples/s | 106.4 steps/s
[Step=44050 Epoch=214.8] | Loss=0.02442 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.682 | L2-Norm(final)=13.812 | 5047.9 samples/s | 78.9 steps/s
[Step=44100 Epoch=215.0] | Loss=0.02288 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.682 | L2-Norm(final)=13.811 | 5451.7 samples/s | 85.2 steps/s
[Step=44150 Epoch=215.3] | Loss=0.02127 | Reg=0.00094 | acc=0.9688 | L2-Norm=9.682 | L2-Norm(final)=13.811 | 5513.2 samples/s | 86.1 steps/s
[Step=44200 Epoch=215.5] | Loss=0.02045 | Reg=0.00094 | acc=0.9688 | L2-Norm=9.682 | L2-Norm(final)=13.812 | 8499.9 samples/s | 132.8 steps/s
[Step=44250 Epoch=215.8] | Loss=0.01988 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.682 | L2-Norm(final)=13.813 | 2648.1 samples/s | 41.4 steps/s
[Step=44300 Epoch=216.0] | Loss=0.02045 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=13.814 | 5610.1 samples/s | 87.7 steps/s
[Step=44350 Epoch=216.3] | Loss=0.02062 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=13.815 | 5426.1 samples/s | 84.8 steps/s
[Step=44400 Epoch=216.5] | Loss=0.02011 | Reg=0.00094 | acc=0.9688 | L2-Norm=9.682 | L2-Norm(final)=13.816 | 7579.8 samples/s | 118.4 steps/s
[Step=44450 Epoch=216.7] | Loss=0.02006 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.682 | L2-Norm(final)=13.817 | 2763.1 samples/s | 43.2 steps/s
[Step=44500 Epoch=217.0] | Loss=0.02021 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=13.818 | 5539.0 samples/s | 86.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=217.0] | Loss=0.04012 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.682 | L2-Norm(final)=13.824 | 7580.2 samples/s | 118.4 steps/s
[Step=44550 Epoch=217.2] | Loss=0.01847 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.690 | L2-Norm(final)=13.825 | 4134.8 samples/s | 64.6 steps/s
[Step=44600 Epoch=217.5] | Loss=0.01717 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.699 | L2-Norm(final)=13.826 | 4662.5 samples/s | 72.9 steps/s
[Step=44650 Epoch=217.7] | Loss=0.01558 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.707 | L2-Norm(final)=13.829 | 4701.1 samples/s | 73.5 steps/s
[Step=44700 Epoch=218.0] | Loss=0.01498 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.713 | L2-Norm(final)=13.831 | 6875.4 samples/s | 107.4 steps/s
[Step=44750 Epoch=218.2] | Loss=0.01338 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.718 | L2-Norm(final)=13.834 | 2450.8 samples/s | 38.3 steps/s
[Step=44800 Epoch=218.5] | Loss=0.01221 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.723 | L2-Norm(final)=13.837 | 4743.8 samples/s | 74.1 steps/s
[Step=44850 Epoch=218.7] | Loss=0.01137 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.728 | L2-Norm(final)=13.840 | 4718.6 samples/s | 73.7 steps/s
[Step=44900 Epoch=218.9] | Loss=0.01075 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.732 | L2-Norm(final)=13.843 | 6161.0 samples/s | 96.3 steps/s
[Step=44950 Epoch=219.2] | Loss=0.00995 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.736 | L2-Norm(final)=13.847 | 2574.3 samples/s | 40.2 steps/s
[Step=45000 Epoch=219.4] | Loss=0.00942 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.740 | L2-Norm(final)=13.850 | 4627.8 samples/s | 72.3 steps/s
[Step=45050 Epoch=219.7] | Loss=0.00907 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.744 | L2-Norm(final)=13.853 | 4752.4 samples/s | 74.3 steps/s
[Step=45100 Epoch=219.9] | Loss=0.00875 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=13.856 | 5636.9 samples/s | 88.1 steps/s
[Step=45150 Epoch=220.2] | Loss=0.00838 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.752 | L2-Norm(final)=13.859 | 2655.3 samples/s | 41.5 steps/s
[Step=45200 Epoch=220.4] | Loss=0.00808 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.755 | L2-Norm(final)=13.862 | 4729.6 samples/s | 73.9 steps/s
[Step=45250 Epoch=220.6] | Loss=0.00782 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.758 | L2-Norm(final)=13.866 | 4721.0 samples/s | 73.8 steps/s
[Step=45300 Epoch=220.9] | Loss=0.00760 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.762 | L2-Norm(final)=13.869 | 5250.7 samples/s | 82.0 steps/s
[Step=45350 Epoch=221.1] | Loss=0.00745 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=13.872 | 2741.2 samples/s | 42.8 steps/s
[Step=45400 Epoch=221.4] | Loss=0.00723 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=13.874 | 4713.1 samples/s | 73.6 steps/s
[Step=45450 Epoch=221.6] | Loss=0.00714 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.771 | L2-Norm(final)=13.877 | 4783.7 samples/s | 74.7 steps/s
[Step=45500 Epoch=221.9] | Loss=0.00696 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.774 | L2-Norm(final)=13.880 | 4803.0 samples/s | 75.0 steps/s
[Step=45550 Epoch=222.1] | Loss=0.00674 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.776 | L2-Norm(final)=13.883 | 2866.4 samples/s | 44.8 steps/s
[Step=45600 Epoch=222.4] | Loss=0.00652 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.779 | L2-Norm(final)=13.885 | 4739.1 samples/s | 74.0 steps/s
[Step=45650 Epoch=222.6] | Loss=0.00641 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.782 | L2-Norm(final)=13.888 | 4734.1 samples/s | 74.0 steps/s
[Step=45700 Epoch=222.8] | Loss=0.00635 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.784 | L2-Norm(final)=13.891 | 4714.6 samples/s | 73.7 steps/s
[Step=45750 Epoch=223.1] | Loss=0.00623 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.787 | L2-Norm(final)=13.893 | 2939.2 samples/s | 45.9 steps/s
[Step=45800 Epoch=223.3] | Loss=0.00608 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.789 | L2-Norm(final)=13.896 | 4767.4 samples/s | 74.5 steps/s
[Step=45850 Epoch=223.6] | Loss=0.00597 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.792 | L2-Norm(final)=13.898 | 4698.2 samples/s | 73.4 steps/s
[Step=45900 Epoch=223.8] | Loss=0.00586 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.794 | L2-Norm(final)=13.901 | 4693.4 samples/s | 73.3 steps/s
[Step=45950 Epoch=224.1] | Loss=0.00580 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.796 | L2-Norm(final)=13.903 | 2927.3 samples/s | 45.7 steps/s
[Step=46000 Epoch=224.3] | Loss=0.00571 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.798 | L2-Norm(final)=13.906 | 4670.2 samples/s | 73.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step46000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=36001 Epoch=175.6] | Loss=0.02557 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.681 | L2-Norm(final)=14.642 | 6591.5 samples/s | 103.0 steps/s
[Step=36050 Epoch=175.8] | Loss=0.02087 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=14.644 | 4995.7 samples/s | 78.1 steps/s
[Step=36100 Epoch=176.0] | Loss=0.01902 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=14.647 | 5475.2 samples/s | 85.5 steps/s
[Step=36150 Epoch=176.3] | Loss=0.01832 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=14.650 | 5504.2 samples/s | 86.0 steps/s
[Step=36200 Epoch=176.5] | Loss=0.01737 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=14.654 | 8656.0 samples/s | 135.3 steps/s
[Step=36250 Epoch=176.8] | Loss=0.01649 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=14.658 | 2629.7 samples/s | 41.1 steps/s
[Step=36300 Epoch=177.0] | Loss=0.01679 | Reg=0.00094 | acc=0.9531 | L2-Norm=9.682 | L2-Norm(final)=14.663 | 5702.7 samples/s | 89.1 steps/s
[Step=36350 Epoch=177.3] | Loss=0.01732 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=14.667 | 5345.7 samples/s | 83.5 steps/s
[Step=36400 Epoch=177.5] | Loss=0.01714 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=14.670 | 7582.6 samples/s | 118.5 steps/s
[Step=36450 Epoch=177.8] | Loss=0.01671 | Reg=0.00094 | acc=0.9531 | L2-Norm=9.682 | L2-Norm(final)=14.673 | 2766.7 samples/s | 43.2 steps/s
[Step=36500 Epoch=178.0] | Loss=0.01681 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=14.677 | 5500.3 samples/s | 85.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=36501 Epoch=178.0] | Loss=0.00868 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=14.710 | 7239.5 samples/s | 113.1 steps/s
[Step=36550 Epoch=178.2] | Loss=0.01740 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.689 | L2-Norm(final)=14.712 | 4264.2 samples/s | 66.6 steps/s
[Step=36600 Epoch=178.5] | Loss=0.01550 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.697 | L2-Norm(final)=14.713 | 4664.5 samples/s | 72.9 steps/s
[Step=36650 Epoch=178.7] | Loss=0.01389 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.704 | L2-Norm(final)=14.715 | 4776.5 samples/s | 74.6 steps/s
[Step=36700 Epoch=179.0] | Loss=0.01235 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.711 | L2-Norm(final)=14.718 | 6752.8 samples/s | 105.5 steps/s
[Step=36750 Epoch=179.2] | Loss=0.01129 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.717 | L2-Norm(final)=14.721 | 2472.7 samples/s | 38.6 steps/s
[Step=36800 Epoch=179.5] | Loss=0.01029 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=14.725 | 4687.3 samples/s | 73.2 steps/s
[Step=36850 Epoch=179.7] | Loss=0.00948 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.728 | L2-Norm(final)=14.728 | 4782.6 samples/s | 74.7 steps/s
[Step=36900 Epoch=179.9] | Loss=0.00881 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.732 | L2-Norm(final)=14.732 | 6168.7 samples/s | 96.4 steps/s
[Step=36950 Epoch=180.2] | Loss=0.00848 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.737 | L2-Norm(final)=14.735 | 2563.0 samples/s | 40.0 steps/s
[Step=37000 Epoch=180.4] | Loss=0.00799 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.741 | L2-Norm(final)=14.738 | 4697.5 samples/s | 73.4 steps/s
[Step=37050 Epoch=180.7] | Loss=0.00753 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.744 | L2-Norm(final)=14.741 | 4719.2 samples/s | 73.7 steps/s
[Step=37100 Epoch=180.9] | Loss=0.00721 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.748 | L2-Norm(final)=14.744 | 5649.7 samples/s | 88.3 steps/s
[Step=37150 Epoch=181.2] | Loss=0.00686 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.752 | L2-Norm(final)=14.747 | 2690.4 samples/s | 42.0 steps/s
[Step=37200 Epoch=181.4] | Loss=0.00668 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.755 | L2-Norm(final)=14.750 | 4670.2 samples/s | 73.0 steps/s
[Step=37250 Epoch=181.7] | Loss=0.00648 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.758 | L2-Norm(final)=14.753 | 4769.0 samples/s | 74.5 steps/s
[Step=37300 Epoch=181.9] | Loss=0.00622 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.761 | L2-Norm(final)=14.756 | 5157.3 samples/s | 80.6 steps/s
[Step=37350 Epoch=182.1] | Loss=0.00599 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.764 | L2-Norm(final)=14.759 | 2762.8 samples/s | 43.2 steps/s
[Step=37400 Epoch=182.4] | Loss=0.00574 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=14.762 | 4701.9 samples/s | 73.5 steps/s
[Step=37450 Epoch=182.6] | Loss=0.00566 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.770 | L2-Norm(final)=14.765 | 4760.8 samples/s | 74.4 steps/s
[Step=37500 Epoch=182.9] | Loss=0.00558 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.773 | L2-Norm(final)=14.768 | 4829.8 samples/s | 75.5 steps/s
[Step=37550 Epoch=183.1] | Loss=0.00545 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.776 | L2-Norm(final)=14.770 | 2866.6 samples/s | 44.8 steps/s
[Step=37600 Epoch=183.4] | Loss=0.00529 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.778 | L2-Norm(final)=14.773 | 4702.0 samples/s | 73.5 steps/s
[Step=37650 Epoch=183.6] | Loss=0.00513 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.781 | L2-Norm(final)=14.776 | 4751.4 samples/s | 74.2 steps/s
[Step=37700 Epoch=183.8] | Loss=0.00503 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.784 | L2-Norm(final)=14.778 | 4746.6 samples/s | 74.2 steps/s
[Step=37750 Epoch=184.1] | Loss=0.00495 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.786 | L2-Norm(final)=14.781 | 2947.7 samples/s | 46.1 steps/s
[Step=37800 Epoch=184.3] | Loss=0.00484 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.788 | L2-Norm(final)=14.784 | 4674.6 samples/s | 73.0 steps/s
[Step=37850 Epoch=184.6] | Loss=0.00477 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.791 | L2-Norm(final)=14.786 | 4771.5 samples/s | 74.6 steps/s
[Step=37900 Epoch=184.8] | Loss=0.00470 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.793 | L2-Norm(final)=14.789 | 4717.7 samples/s | 73.7 steps/s
[Step=37950 Epoch=185.1] | Loss=0.00462 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.795 | L2-Norm(final)=14.791 | 2922.6 samples/s | 45.7 steps/s
[Step=38000 Epoch=185.3] | Loss=0.00455 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.798 | L2-Norm(final)=14.794 | 4743.4 samples/s | 74.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step38000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=54001 Epoch=511.7] | Loss=0.00005 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.681 | L2-Norm(final)=18.166 | 6415.2 samples/s | 100.2 steps/s
[Step=54050 Epoch=512.2] | Loss=0.00005 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=18.166 | 4454.6 samples/s | 69.6 steps/s
[Step=54100 Epoch=512.6] | Loss=0.00004 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=18.169 | 8164.4 samples/s | 127.6 steps/s
[Step=54150 Epoch=513.1] | Loss=0.00004 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=18.171 | 2546.5 samples/s | 39.8 steps/s
[Step=54200 Epoch=513.6] | Loss=0.00004 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=18.174 | 7079.4 samples/s | 110.6 steps/s
[Step=54250 Epoch=514.1] | Loss=0.00003 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.678 | L2-Norm(final)=18.175 | 2658.0 samples/s | 41.5 steps/s
[Step=54300 Epoch=514.5] | Loss=0.00004 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.678 | L2-Norm(final)=18.176 | 6534.6 samples/s | 102.1 steps/s
[Step=54350 Epoch=515.0] | Loss=0.00004 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.678 | L2-Norm(final)=18.178 | 2866.8 samples/s | 44.8 steps/s
[Step=54400 Epoch=515.5] | Loss=0.00003 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.678 | L2-Norm(final)=18.179 | 5529.3 samples/s | 86.4 steps/s
[Step=54450 Epoch=516.0] | Loss=0.00003 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.678 | L2-Norm(final)=18.180 | 2920.0 samples/s | 45.6 steps/s
[Step=54500 Epoch=516.4] | Loss=0.00004 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.678 | L2-Norm(final)=18.182 | 5358.8 samples/s | 83.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=54501 Epoch=516.4] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.678 | L2-Norm(final)=18.196 | 6710.1 samples/s | 104.8 steps/s
[Step=54550 Epoch=516.9] | Loss=0.00008 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=18.197 | 4076.1 samples/s | 63.7 steps/s
[Step=54600 Epoch=517.4] | Loss=0.00005 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.675 | L2-Norm(final)=18.197 | 6567.7 samples/s | 102.6 steps/s
[Step=54650 Epoch=517.9] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=18.198 | 2374.6 samples/s | 37.1 steps/s
[Step=54700 Epoch=518.3] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.661 | L2-Norm(final)=18.198 | 5960.6 samples/s | 93.1 steps/s
[Step=54750 Epoch=518.8] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=18.198 | 2481.8 samples/s | 38.8 steps/s
[Step=54800 Epoch=519.3] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.646 | L2-Norm(final)=18.199 | 5330.5 samples/s | 83.3 steps/s
[Step=54850 Epoch=519.8] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.639 | L2-Norm(final)=18.199 | 2558.4 samples/s | 40.0 steps/s
[Step=54900 Epoch=520.2] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.632 | L2-Norm(final)=18.199 | 4999.2 samples/s | 78.1 steps/s
[Step=54950 Epoch=520.7] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.625 | L2-Norm(final)=18.199 | 2694.6 samples/s | 42.1 steps/s
[Step=55000 Epoch=521.2] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.617 | L2-Norm(final)=18.199 | 4565.9 samples/s | 71.3 steps/s
[Step=55050 Epoch=521.6] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.610 | L2-Norm(final)=18.200 | 2814.9 samples/s | 44.0 steps/s
[Step=55100 Epoch=522.1] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=18.200 | 4491.6 samples/s | 70.2 steps/s
[Step=55150 Epoch=522.6] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.596 | L2-Norm(final)=18.200 | 2848.7 samples/s | 44.5 steps/s
[Step=55200 Epoch=523.1] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.588 | L2-Norm(final)=18.200 | 4519.6 samples/s | 70.6 steps/s
[Step=55250 Epoch=523.5] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.581 | L2-Norm(final)=18.200 | 2797.3 samples/s | 43.7 steps/s
[Step=55300 Epoch=524.0] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.574 | L2-Norm(final)=18.200 | 4561.1 samples/s | 71.3 steps/s
[Step=55350 Epoch=524.5] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.566 | L2-Norm(final)=18.201 | 2891.2 samples/s | 45.2 steps/s
[Step=55400 Epoch=525.0] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.559 | L2-Norm(final)=18.201 | 4303.0 samples/s | 67.2 steps/s
[Step=55450 Epoch=525.4] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.551 | L2-Norm(final)=18.201 | 6741.9 samples/s | 105.3 steps/s
[Step=55500 Epoch=525.9] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.544 | L2-Norm(final)=18.201 | 2330.6 samples/s | 36.4 steps/s
[Step=55550 Epoch=526.4] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=18.201 | 6079.4 samples/s | 95.0 steps/s
[Step=55600 Epoch=526.9] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.529 | L2-Norm(final)=18.201 | 2407.7 samples/s | 37.6 steps/s
[Step=55650 Epoch=527.3] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.521 | L2-Norm(final)=18.201 | 5666.7 samples/s | 88.5 steps/s
[Step=55700 Epoch=527.8] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.513 | L2-Norm(final)=18.202 | 2523.7 samples/s | 39.4 steps/s
[Step=55750 Epoch=528.3] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.505 | L2-Norm(final)=18.202 | 5121.6 samples/s | 80.0 steps/s
[Step=55800 Epoch=528.8] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.497 | L2-Norm(final)=18.202 | 2660.6 samples/s | 41.6 steps/s
[Step=55850 Epoch=529.2] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.490 | L2-Norm(final)=18.202 | 4685.6 samples/s | 73.2 steps/s
[Step=55900 Epoch=529.7] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.482 | L2-Norm(final)=18.202 | 2746.1 samples/s | 42.9 steps/s
[Step=55950 Epoch=530.2] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.474 | L2-Norm(final)=18.202 | 4491.4 samples/s | 70.2 steps/s
[Step=56000 Epoch=530.6] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.466 | L2-Norm(final)=18.202 | 2830.8 samples/s | 44.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step56000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=40001 Epoch=380.5] | Loss=0.00017 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.681 | L2-Norm(final)=15.745 | 7263.4 samples/s | 113.5 steps/s
[Step=40050 Epoch=381.0] | Loss=0.00091 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=15.748 | 4403.5 samples/s | 68.8 steps/s
[Step=40100 Epoch=381.5] | Loss=0.00083 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=15.756 | 8296.3 samples/s | 129.6 steps/s
[Step=40150 Epoch=381.9] | Loss=0.00077 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=15.761 | 2549.6 samples/s | 39.8 steps/s
[Step=40200 Epoch=382.4] | Loss=0.00081 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=15.767 | 7301.9 samples/s | 114.1 steps/s
[Step=40250 Epoch=382.9] | Loss=0.00085 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=15.771 | 2673.9 samples/s | 41.8 steps/s
[Step=40300 Epoch=383.4] | Loss=0.00083 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=15.776 | 6512.6 samples/s | 101.8 steps/s
[Step=40350 Epoch=383.8] | Loss=0.00080 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=15.781 | 2773.9 samples/s | 43.3 steps/s
[Step=40400 Epoch=384.3] | Loss=0.00083 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=15.785 | 5848.9 samples/s | 91.4 steps/s
[Step=40450 Epoch=384.8] | Loss=0.00084 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=15.789 | 2945.5 samples/s | 46.0 steps/s
[Step=40500 Epoch=385.3] | Loss=0.00083 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=15.793 | 5423.1 samples/s | 84.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=385.3] | Loss=0.00008 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=15.830 | 7013.4 samples/s | 109.6 steps/s
[Step=40550 Epoch=385.7] | Loss=0.00053 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.691 | L2-Norm(final)=15.831 | 4016.0 samples/s | 62.8 steps/s
[Step=40600 Epoch=386.2] | Loss=0.00035 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.698 | L2-Norm(final)=15.832 | 6514.6 samples/s | 101.8 steps/s
[Step=40650 Epoch=386.7] | Loss=0.00024 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.701 | L2-Norm(final)=15.833 | 2382.5 samples/s | 37.2 steps/s
[Step=40700 Epoch=387.2] | Loss=0.00018 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.701 | L2-Norm(final)=15.833 | 5940.9 samples/s | 92.8 steps/s
[Step=40750 Epoch=387.6] | Loss=0.00015 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.700 | L2-Norm(final)=15.833 | 2248.6 samples/s | 35.1 steps/s
[Step=40800 Epoch=388.1] | Loss=0.00012 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.698 | L2-Norm(final)=15.834 | 5303.4 samples/s | 82.9 steps/s
[Step=40850 Epoch=388.6] | Loss=0.00011 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.696 | L2-Norm(final)=15.834 | 2588.1 samples/s | 40.4 steps/s
[Step=40900 Epoch=389.1] | Loss=0.00010 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.694 | L2-Norm(final)=15.834 | 4872.8 samples/s | 76.1 steps/s
[Step=40950 Epoch=389.5] | Loss=0.00009 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.692 | L2-Norm(final)=15.835 | 2658.8 samples/s | 41.5 steps/s
[Step=41000 Epoch=390.0] | Loss=0.00008 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.689 | L2-Norm(final)=15.835 | 4626.4 samples/s | 72.3 steps/s
[Step=41050 Epoch=390.5] | Loss=0.00007 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.687 | L2-Norm(final)=15.835 | 2786.7 samples/s | 43.5 steps/s
[Step=41100 Epoch=391.0] | Loss=0.00007 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.684 | L2-Norm(final)=15.835 | 4623.1 samples/s | 72.2 steps/s
[Step=41150 Epoch=391.4] | Loss=0.00006 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.681 | L2-Norm(final)=15.836 | 2805.1 samples/s | 43.8 steps/s
[Step=41200 Epoch=391.9] | Loss=0.00006 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=15.836 | 4523.4 samples/s | 70.7 steps/s
[Step=41250 Epoch=392.4] | Loss=0.00005 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.676 | L2-Norm(final)=15.836 | 2844.2 samples/s | 44.4 steps/s
[Step=41300 Epoch=392.9] | Loss=0.00005 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.673 | L2-Norm(final)=15.837 | 4474.6 samples/s | 69.9 steps/s
[Step=41350 Epoch=393.3] | Loss=0.00005 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.670 | L2-Norm(final)=15.837 | 3019.1 samples/s | 47.2 steps/s
[Step=41400 Epoch=393.8] | Loss=0.00005 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=15.837 | 4236.3 samples/s | 66.2 steps/s
[Step=41450 Epoch=394.3] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=15.837 | 6732.8 samples/s | 105.2 steps/s
[Step=41500 Epoch=394.8] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.661 | L2-Norm(final)=15.838 | 2355.7 samples/s | 36.8 steps/s
[Step=41550 Epoch=395.2] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.658 | L2-Norm(final)=15.838 | 6018.2 samples/s | 94.0 steps/s
[Step=41600 Epoch=395.7] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=15.838 | 2440.4 samples/s | 38.1 steps/s
[Step=41650 Epoch=396.2] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.651 | L2-Norm(final)=15.838 | 5568.5 samples/s | 87.0 steps/s
[Step=41700 Epoch=396.7] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.648 | L2-Norm(final)=15.838 | 2534.3 samples/s | 39.6 steps/s
[Step=41750 Epoch=397.1] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.645 | L2-Norm(final)=15.839 | 5131.1 samples/s | 80.2 steps/s
[Step=41800 Epoch=397.6] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.641 | L2-Norm(final)=15.839 | 2414.5 samples/s | 37.7 steps/s
[Step=41850 Epoch=398.1] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.638 | L2-Norm(final)=15.839 | 4699.0 samples/s | 73.4 steps/s
[Step=41900 Epoch=398.6] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.634 | L2-Norm(final)=15.839 | 2764.8 samples/s | 43.2 steps/s
[Step=41950 Epoch=399.0] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.631 | L2-Norm(final)=15.840 | 4508.5 samples/s | 70.4 steps/s
[Step=42000 Epoch=399.5] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.627 | L2-Norm(final)=15.840 | 2811.8 samples/s | 43.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step42000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=38001 Epoch=362.9] | Loss=0.00130 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.681 | L2-Norm(final)=14.804 | 7439.1 samples/s | 116.2 steps/s
[Step=38050 Epoch=363.4] | Loss=0.00032 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=14.810 | 4766.8 samples/s | 74.5 steps/s
[Step=38100 Epoch=363.8] | Loss=0.00025 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=14.813 | 8161.3 samples/s | 127.5 steps/s
[Step=38150 Epoch=364.3] | Loss=0.00029 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=14.816 | 2542.7 samples/s | 39.7 steps/s
[Step=38200 Epoch=364.8] | Loss=0.00029 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=14.819 | 7461.0 samples/s | 116.6 steps/s
[Step=38250 Epoch=365.3] | Loss=0.00028 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=14.823 | 2630.4 samples/s | 41.1 steps/s
[Step=38300 Epoch=365.7] | Loss=0.00029 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=14.826 | 6801.6 samples/s | 106.3 steps/s
[Step=38350 Epoch=366.2] | Loss=0.00029 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=14.829 | 2799.4 samples/s | 43.7 steps/s
[Step=38400 Epoch=366.7] | Loss=0.00028 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=14.832 | 5867.9 samples/s | 91.7 steps/s
[Step=38450 Epoch=367.2] | Loss=0.00028 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=14.835 | 2810.9 samples/s | 43.9 steps/s
[Step=38500 Epoch=367.7] | Loss=0.00029 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=14.838 | 5726.2 samples/s | 89.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=38501 Epoch=367.7] | Loss=0.00003 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=14.870 | 6470.3 samples/s | 101.1 steps/s
[Step=38550 Epoch=368.1] | Loss=0.00020 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.686 | L2-Norm(final)=14.873 | 4164.0 samples/s | 65.1 steps/s
[Step=38600 Epoch=368.6] | Loss=0.00012 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.686 | L2-Norm(final)=14.874 | 6693.7 samples/s | 104.6 steps/s
[Step=38650 Epoch=369.1] | Loss=0.00008 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.683 | L2-Norm(final)=14.874 | 2347.7 samples/s | 36.7 steps/s
[Step=38700 Epoch=369.6] | Loss=0.00006 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=14.875 | 6007.3 samples/s | 93.9 steps/s
[Step=38750 Epoch=370.0] | Loss=0.00005 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.676 | L2-Norm(final)=14.875 | 2444.5 samples/s | 38.2 steps/s
[Step=38800 Epoch=370.5] | Loss=0.00004 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.672 | L2-Norm(final)=14.876 | 5633.5 samples/s | 88.0 steps/s
[Step=38850 Epoch=371.0] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=14.876 | 2520.4 samples/s | 39.4 steps/s
[Step=38900 Epoch=371.5] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.663 | L2-Norm(final)=14.876 | 5240.6 samples/s | 81.9 steps/s
[Step=38950 Epoch=371.9] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.658 | L2-Norm(final)=14.876 | 2587.3 samples/s | 40.4 steps/s
[Step=39000 Epoch=372.4] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=14.877 | 4932.6 samples/s | 77.1 steps/s
[Step=39050 Epoch=372.9] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.649 | L2-Norm(final)=14.877 | 2681.2 samples/s | 41.9 steps/s
[Step=39100 Epoch=373.4] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.645 | L2-Norm(final)=14.877 | 4644.6 samples/s | 72.6 steps/s
[Step=39150 Epoch=373.9] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.640 | L2-Norm(final)=14.877 | 2806.4 samples/s | 43.8 steps/s
[Step=39200 Epoch=374.3] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.635 | L2-Norm(final)=14.877 | 4424.5 samples/s | 69.1 steps/s
[Step=39250 Epoch=374.8] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.630 | L2-Norm(final)=14.878 | 2878.9 samples/s | 45.0 steps/s
[Step=39300 Epoch=375.3] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.625 | L2-Norm(final)=14.878 | 4469.1 samples/s | 69.8 steps/s
[Step=39350 Epoch=375.8] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.620 | L2-Norm(final)=14.878 | 2831.4 samples/s | 44.2 steps/s
[Step=39400 Epoch=376.2] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.615 | L2-Norm(final)=14.878 | 4437.0 samples/s | 69.3 steps/s
[Step=39450 Epoch=376.7] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.610 | L2-Norm(final)=14.878 | 2904.5 samples/s | 45.4 steps/s
[Step=39500 Epoch=377.2] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.605 | L2-Norm(final)=14.879 | 4527.3 samples/s | 70.7 steps/s
[Step=39550 Epoch=377.7] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.600 | L2-Norm(final)=14.879 | 7113.4 samples/s | 111.1 steps/s
[Step=39600 Epoch=378.2] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.595 | L2-Norm(final)=14.879 | 2278.9 samples/s | 35.6 steps/s
[Step=39650 Epoch=378.6] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.589 | L2-Norm(final)=14.879 | 6598.4 samples/s | 103.1 steps/s
[Step=39700 Epoch=379.1] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.584 | L2-Norm(final)=14.879 | 2381.6 samples/s | 37.2 steps/s
[Step=39750 Epoch=379.6] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=14.879 | 5982.2 samples/s | 93.5 steps/s
[Step=39800 Epoch=380.1] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.573 | L2-Norm(final)=14.880 | 2426.0 samples/s | 37.9 steps/s
[Step=39850 Epoch=380.5] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.567 | L2-Norm(final)=14.880 | 5620.5 samples/s | 87.8 steps/s
[Step=39900 Epoch=381.0] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.562 | L2-Norm(final)=14.880 | 2544.4 samples/s | 39.8 steps/s
[Step=39950 Epoch=381.5] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.556 | L2-Norm(final)=14.880 | 5153.8 samples/s | 80.5 steps/s
[Step=40000 Epoch=382.0] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.550 | L2-Norm(final)=14.880 | 2316.5 samples/s | 36.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07777 | acc=0.9647 | tpr=0.9751 | fpr=0.0580 | 6040.0 samples/s | 23.6 steps/s
Avg test loss: 0.08131, Avg test acc: 0.96294, Avg tpr: 0.97453, Avg fpr: 0.06256, total FA: 488

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08541 | acc=0.9637 | tpr=0.9765 | fpr=0.0639 | 5953.8 samples/s | 23.3 steps/s
Avg test loss: 0.08879, Avg test acc: 0.96234, Avg tpr: 0.97424, Avg fpr: 0.06384, total FA: 498

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08528 | acc=0.9635 | tpr=0.9742 | fpr=0.0597 | 5919.2 samples/s | 23.1 steps/s
Avg test loss: 0.08920, Avg test acc: 0.96129, Avg tpr: 0.97103, Avg fpr: 0.06012, total FA: 469

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08141 | acc=0.9634 | tpr=0.9751 | fpr=0.0622 | 6190.2 samples/s | 24.2 steps/s
Avg test loss: 0.08578, Avg test acc: 0.96238, Avg tpr: 0.97418, Avg fpr: 0.06358, total FA: 496

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08452 | acc=0.9630 | tpr=0.9739 | fpr=0.0605 | 5994.5 samples/s | 23.4 steps/s
Avg test loss: 0.08755, Avg test acc: 0.96210, Avg tpr: 0.97208, Avg fpr: 0.05986, total FA: 467

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.57213 | acc=0.2752 | tpr=0.0219 | fpr=0.1747 | 6213.5 samples/s | 24.3 steps/s
Avg test loss: 6.57960, Avg test acc: 0.27522, Avg tpr: 0.02139, Avg fpr: 0.16652, total FA: 1299

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.62925 | acc=0.3075 | tpr=0.0280 | fpr=0.0855 | 5910.6 samples/s | 23.1 steps/s
Avg test loss: 4.63957, Avg test acc: 0.30535, Avg tpr: 0.02751, Avg fpr: 0.08358, total FA: 652

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.92413 | acc=0.2955 | tpr=0.0243 | fpr=0.1157 | 5955.8 samples/s | 23.3 steps/s
Avg test loss: 4.93020, Avg test acc: 0.29337, Avg tpr: 0.02314, Avg fpr: 0.11229, total FA: 876

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.87807 | acc=0.2747 | tpr=0.0285 | fpr=0.1908 | 5877.3 samples/s | 23.0 steps/s
Avg test loss: 4.88206, Avg test acc: 0.27390, Avg tpr: 0.02664, Avg fpr: 0.18228, total FA: 1422

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.90266 | acc=0.2911 | tpr=0.0189 | fpr=0.1179 | 5790.1 samples/s | 22.6 steps/s
Avg test loss: 4.91703, Avg test acc: 0.29033, Avg tpr: 0.01883, Avg fpr: 0.11255, total FA: 878

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.04402 | acc=0.1254 | tpr=0.6150 | fpr=0.8834 | 6111.9 samples/s | 23.9 steps/s
[Step= 100] | Loss=5.03113 | acc=0.1280 | tpr=0.6077 | fpr=0.8809 | 7372.7 samples/s | 28.8 steps/s
[Step= 150] | Loss=5.02105 | acc=0.1298 | tpr=0.6196 | fpr=0.8792 | 7620.9 samples/s | 29.8 steps/s
[Step= 200] | Loss=5.01011 | acc=0.1299 | tpr=0.6120 | fpr=0.8788 | 7984.1 samples/s | 31.2 steps/s
[Step= 250] | Loss=5.01582 | acc=0.1294 | tpr=0.5983 | fpr=0.8791 | 7964.4 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.01008 | acc=0.1294 | tpr=0.5905 | fpr=0.8790 | 8691.6 samples/s | 34.0 steps/s
[Step= 350] | Loss=5.01549 | acc=0.1296 | tpr=0.5855 | fpr=0.8787 | 8391.6 samples/s | 32.8 steps/s
[Step= 400] | Loss=5.01313 | acc=0.1298 | tpr=0.5837 | fpr=0.8784 | 7924.5 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.01802 | acc=0.1295 | tpr=0.5871 | fpr=0.8788 | 7975.2 samples/s | 31.2 steps/s
[Step= 500] | Loss=5.01797 | acc=0.1294 | tpr=0.5912 | fpr=0.8789 | 7558.9 samples/s | 29.5 steps/s
[Step= 550] | Loss=5.02101 | acc=0.1295 | tpr=0.5929 | fpr=0.8789 | 10119.9 samples/s | 39.5 steps/s
Avg test loss: 5.02129, Avg test acc: 0.12941, Avg tpr: 0.59390, Avg fpr: 0.87903, total FA: 122052

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.94226 | acc=0.1315 | tpr=0.5796 | fpr=0.8766 | 5906.2 samples/s | 23.1 steps/s
[Step= 100] | Loss=4.93487 | acc=0.1347 | tpr=0.5821 | fpr=0.8737 | 7370.7 samples/s | 28.8 steps/s
[Step= 150] | Loss=4.92374 | acc=0.1376 | tpr=0.6066 | fpr=0.8711 | 8355.0 samples/s | 32.6 steps/s
[Step= 200] | Loss=4.91413 | acc=0.1382 | tpr=0.6022 | fpr=0.8702 | 7503.9 samples/s | 29.3 steps/s
[Step= 250] | Loss=4.91908 | acc=0.1378 | tpr=0.5974 | fpr=0.8705 | 8136.6 samples/s | 31.8 steps/s
[Step= 300] | Loss=4.91575 | acc=0.1373 | tpr=0.5905 | fpr=0.8710 | 8281.1 samples/s | 32.3 steps/s
[Step= 350] | Loss=4.92063 | acc=0.1370 | tpr=0.5855 | fpr=0.8712 | 7995.8 samples/s | 31.2 steps/s
[Step= 400] | Loss=4.91822 | acc=0.1374 | tpr=0.5870 | fpr=0.8708 | 8003.3 samples/s | 31.3 steps/s
[Step= 450] | Loss=4.92227 | acc=0.1368 | tpr=0.5925 | fpr=0.8715 | 8122.8 samples/s | 31.7 steps/s
[Step= 500] | Loss=4.92337 | acc=0.1366 | tpr=0.5947 | fpr=0.8717 | 7619.5 samples/s | 29.8 steps/s
[Step= 550] | Loss=4.92696 | acc=0.1369 | tpr=0.5965 | fpr=0.8715 | 11044.7 samples/s | 43.1 steps/s
Avg test loss: 4.92714, Avg test acc: 0.13677, Avg tpr: 0.59786, Avg fpr: 0.87162, total FA: 121022

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.12202 | acc=0.1241 | tpr=0.5708 | fpr=0.8840 | 6194.4 samples/s | 24.2 steps/s
[Step= 100] | Loss=5.10821 | acc=0.1264 | tpr=0.5778 | fpr=0.8820 | 7875.0 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.09892 | acc=0.1288 | tpr=0.5893 | fpr=0.8796 | 7958.2 samples/s | 31.1 steps/s
[Step= 200] | Loss=5.08957 | acc=0.1294 | tpr=0.5836 | fpr=0.8788 | 7333.4 samples/s | 28.6 steps/s
[Step= 250] | Loss=5.09588 | acc=0.1295 | tpr=0.5825 | fpr=0.8787 | 7584.5 samples/s | 29.6 steps/s
[Step= 300] | Loss=5.09195 | acc=0.1294 | tpr=0.5804 | fpr=0.8788 | 7713.6 samples/s | 30.1 steps/s
[Step= 350] | Loss=5.09689 | acc=0.1294 | tpr=0.5792 | fpr=0.8787 | 7864.8 samples/s | 30.7 steps/s
[Step= 400] | Loss=5.09603 | acc=0.1296 | tpr=0.5799 | fpr=0.8786 | 8179.9 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.10098 | acc=0.1289 | tpr=0.5808 | fpr=0.8793 | 7896.8 samples/s | 30.8 steps/s
[Step= 500] | Loss=5.10015 | acc=0.1287 | tpr=0.5811 | fpr=0.8795 | 8535.8 samples/s | 33.3 steps/s
[Step= 550] | Loss=5.10318 | acc=0.1288 | tpr=0.5794 | fpr=0.8794 | 10940.9 samples/s | 42.7 steps/s
Avg test loss: 5.10361, Avg test acc: 0.12867, Avg tpr: 0.58043, Avg fpr: 0.87954, total FA: 122122

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.93556 | acc=0.1320 | tpr=0.6681 | fpr=0.8776 | 6090.6 samples/s | 23.8 steps/s
[Step= 100] | Loss=4.92545 | acc=0.1354 | tpr=0.6546 | fpr=0.8743 | 7730.5 samples/s | 30.2 steps/s
[Step= 150] | Loss=4.91354 | acc=0.1371 | tpr=0.6585 | fpr=0.8725 | 7987.0 samples/s | 31.2 steps/s
[Step= 200] | Loss=4.90331 | acc=0.1375 | tpr=0.6536 | fpr=0.8719 | 8158.3 samples/s | 31.9 steps/s
[Step= 250] | Loss=4.90669 | acc=0.1370 | tpr=0.6410 | fpr=0.8722 | 7782.7 samples/s | 30.4 steps/s
[Step= 300] | Loss=4.90222 | acc=0.1366 | tpr=0.6356 | fpr=0.8725 | 8117.9 samples/s | 31.7 steps/s
[Step= 350] | Loss=4.90747 | acc=0.1366 | tpr=0.6337 | fpr=0.8724 | 7475.4 samples/s | 29.2 steps/s
[Step= 400] | Loss=4.90620 | acc=0.1370 | tpr=0.6335 | fpr=0.8720 | 8398.3 samples/s | 32.8 steps/s
[Step= 450] | Loss=4.91126 | acc=0.1361 | tpr=0.6363 | fpr=0.8730 | 7992.4 samples/s | 31.2 steps/s
[Step= 500] | Loss=4.91082 | acc=0.1360 | tpr=0.6392 | fpr=0.8731 | 7901.8 samples/s | 30.9 steps/s
[Step= 550] | Loss=4.91497 | acc=0.1358 | tpr=0.6407 | fpr=0.8733 | 10220.3 samples/s | 39.9 steps/s
Avg test loss: 4.91555, Avg test acc: 0.13576, Avg tpr: 0.64184, Avg fpr: 0.87344, total FA: 121275

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.97711 | acc=0.1332 | tpr=0.5177 | fpr=0.8737 | 6040.5 samples/s | 23.6 steps/s
[Step= 100] | Loss=4.96681 | acc=0.1348 | tpr=0.5053 | fpr=0.8721 | 7869.6 samples/s | 30.7 steps/s
[Step= 150] | Loss=4.95605 | acc=0.1369 | tpr=0.5202 | fpr=0.8701 | 7747.7 samples/s | 30.3 steps/s
[Step= 200] | Loss=4.94827 | acc=0.1382 | tpr=0.5115 | fpr=0.8686 | 8448.1 samples/s | 33.0 steps/s
[Step= 250] | Loss=4.95265 | acc=0.1380 | tpr=0.4996 | fpr=0.8686 | 7819.3 samples/s | 30.5 steps/s
[Step= 300] | Loss=4.94938 | acc=0.1378 | tpr=0.4909 | fpr=0.8686 | 7975.8 samples/s | 31.2 steps/s
[Step= 350] | Loss=4.95575 | acc=0.1376 | tpr=0.4890 | fpr=0.8688 | 7495.8 samples/s | 29.3 steps/s
[Step= 400] | Loss=4.95274 | acc=0.1378 | tpr=0.4902 | fpr=0.8686 | 8068.1 samples/s | 31.5 steps/s
[Step= 450] | Loss=4.95705 | acc=0.1371 | tpr=0.4932 | fpr=0.8694 | 8080.3 samples/s | 31.6 steps/s
[Step= 500] | Loss=4.95670 | acc=0.1372 | tpr=0.4943 | fpr=0.8693 | 7703.9 samples/s | 30.1 steps/s
[Step= 550] | Loss=4.95962 | acc=0.1373 | tpr=0.4930 | fpr=0.8691 | 10884.1 samples/s | 42.5 steps/s
Avg test loss: 4.96019, Avg test acc: 0.13722, Avg tpr: 0.49366, Avg fpr: 0.86926, total FA: 120695

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.23833 | acc=0.9573 | tpr=0.9513 | fpr=0.0425 | 6135.7 samples/s | 24.0 steps/s
[Step= 100] | Loss=0.24657 | acc=0.9569 | tpr=0.9595 | fpr=0.0431 | 7201.7 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.24963 | acc=0.9555 | tpr=0.9582 | fpr=0.0446 | 7839.9 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.24996 | acc=0.9556 | tpr=0.9617 | fpr=0.0445 | 8435.2 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.25004 | acc=0.9555 | tpr=0.9590 | fpr=0.0445 | 7530.6 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.25372 | acc=0.9551 | tpr=0.9556 | fpr=0.0449 | 8285.5 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.25200 | acc=0.9553 | tpr=0.9555 | fpr=0.0447 | 8242.7 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.25199 | acc=0.9550 | tpr=0.9530 | fpr=0.0450 | 7915.6 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.25568 | acc=0.9545 | tpr=0.9523 | fpr=0.0455 | 7975.3 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.25593 | acc=0.9544 | tpr=0.9537 | fpr=0.0455 | 8191.0 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.25453 | acc=0.9547 | tpr=0.9542 | fpr=0.0453 | 10215.6 samples/s | 39.9 steps/s
Avg test loss: 0.25423, Avg test acc: 0.95473, Avg tpr: 0.95404, Avg fpr: 0.04526, total FA: 6284

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14794 | acc=0.9644 | tpr=0.9292 | fpr=0.0350 | 5996.4 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.15443 | acc=0.9632 | tpr=0.9318 | fpr=0.0362 | 7596.7 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.15653 | acc=0.9621 | tpr=0.9323 | fpr=0.0373 | 7930.8 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.15687 | acc=0.9622 | tpr=0.9366 | fpr=0.0374 | 8042.6 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.15624 | acc=0.9623 | tpr=0.9371 | fpr=0.0373 | 8122.4 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.15896 | acc=0.9618 | tpr=0.9353 | fpr=0.0377 | 7289.0 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.15773 | acc=0.9619 | tpr=0.9343 | fpr=0.0376 | 8367.0 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.15823 | acc=0.9616 | tpr=0.9311 | fpr=0.0378 | 8389.6 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.16087 | acc=0.9611 | tpr=0.9309 | fpr=0.0384 | 7394.0 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.16025 | acc=0.9610 | tpr=0.9322 | fpr=0.0384 | 8551.0 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.15946 | acc=0.9614 | tpr=0.9331 | fpr=0.0381 | 10444.4 samples/s | 40.8 steps/s
Avg test loss: 0.15928, Avg test acc: 0.96138, Avg tpr: 0.93304, Avg fpr: 0.03811, total FA: 5291

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.25530 | acc=0.9499 | tpr=0.9513 | fpr=0.0501 | 6039.6 samples/s | 23.6 steps/s
[Step= 100] | Loss=0.26410 | acc=0.9485 | tpr=0.9595 | fpr=0.0517 | 7679.3 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.26834 | acc=0.9476 | tpr=0.9611 | fpr=0.0527 | 7101.9 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.26827 | acc=0.9478 | tpr=0.9639 | fpr=0.0525 | 8033.4 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.26833 | acc=0.9477 | tpr=0.9633 | fpr=0.0526 | 8591.8 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.27121 | acc=0.9476 | tpr=0.9622 | fpr=0.0527 | 7978.9 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.26935 | acc=0.9478 | tpr=0.9612 | fpr=0.0525 | 7736.8 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.26950 | acc=0.9474 | tpr=0.9590 | fpr=0.0528 | 7879.3 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.27286 | acc=0.9470 | tpr=0.9586 | fpr=0.0532 | 8344.3 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.27332 | acc=0.9469 | tpr=0.9590 | fpr=0.0533 | 8114.7 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.27169 | acc=0.9472 | tpr=0.9594 | fpr=0.0530 | 10198.9 samples/s | 39.8 steps/s
Avg test loss: 0.27148, Avg test acc: 0.94722, Avg tpr: 0.95919, Avg fpr: 0.05300, total FA: 7359

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15392 | acc=0.9636 | tpr=0.9336 | fpr=0.0359 | 5918.6 samples/s | 23.1 steps/s
[Step= 100] | Loss=0.15888 | acc=0.9627 | tpr=0.9446 | fpr=0.0370 | 8088.5 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.15963 | acc=0.9610 | tpr=0.9438 | fpr=0.0387 | 7631.2 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.15974 | acc=0.9611 | tpr=0.9475 | fpr=0.0386 | 7546.1 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.15985 | acc=0.9608 | tpr=0.9450 | fpr=0.0389 | 7859.0 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.16210 | acc=0.9604 | tpr=0.9440 | fpr=0.0393 | 7838.1 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.16118 | acc=0.9604 | tpr=0.9418 | fpr=0.0393 | 8126.7 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.16099 | acc=0.9601 | tpr=0.9404 | fpr=0.0395 | 7135.5 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.16359 | acc=0.9597 | tpr=0.9401 | fpr=0.0400 | 8248.0 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.16345 | acc=0.9597 | tpr=0.9427 | fpr=0.0400 | 8559.4 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.16260 | acc=0.9600 | tpr=0.9443 | fpr=0.0398 | 11869.0 samples/s | 46.4 steps/s
Avg test loss: 0.16239, Avg test acc: 0.95999, Avg tpr: 0.94414, Avg fpr: 0.03973, total FA: 5516

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21562 | acc=0.9586 | tpr=0.9513 | fpr=0.0413 | 6035.5 samples/s | 23.6 steps/s
[Step= 100] | Loss=0.22490 | acc=0.9569 | tpr=0.9574 | fpr=0.0431 | 7451.6 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.22815 | acc=0.9553 | tpr=0.9582 | fpr=0.0447 | 7933.4 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.22815 | acc=0.9552 | tpr=0.9596 | fpr=0.0449 | 7662.8 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.22848 | acc=0.9551 | tpr=0.9590 | fpr=0.0450 | 8746.2 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.23213 | acc=0.9546 | tpr=0.9549 | fpr=0.0454 | 8639.1 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.23079 | acc=0.9546 | tpr=0.9549 | fpr=0.0454 | 7936.3 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.23106 | acc=0.9542 | tpr=0.9513 | fpr=0.0457 | 7838.8 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.23452 | acc=0.9537 | tpr=0.9508 | fpr=0.0462 | 8049.2 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.23454 | acc=0.9536 | tpr=0.9502 | fpr=0.0463 | 7946.2 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.23306 | acc=0.9539 | tpr=0.9507 | fpr=0.0460 | 9298.0 samples/s | 36.3 steps/s
Avg test loss: 0.23287, Avg test acc: 0.95393, Avg tpr: 0.95048, Avg fpr: 0.04601, total FA: 6388

server round 45/50

clients selected: [0 1 3 5 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=46001 Epoch=224.3] | Loss=0.00212 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=13.978 | 6777.4 samples/s | 105.9 steps/s
[Step=46050 Epoch=224.5] | Loss=0.01778 | Reg=0.00093 | acc=0.9531 | L2-Norm=9.654 | L2-Norm(final)=13.980 | 5045.2 samples/s | 78.8 steps/s
[Step=46100 Epoch=224.8] | Loss=0.01986 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.654 | L2-Norm(final)=13.981 | 5517.9 samples/s | 86.2 steps/s
[Step=46150 Epoch=225.0] | Loss=0.02076 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.654 | L2-Norm(final)=13.980 | 5444.6 samples/s | 85.1 steps/s
[Step=46200 Epoch=225.3] | Loss=0.01954 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.654 | L2-Norm(final)=13.979 | 8555.7 samples/s | 133.7 steps/s
[Step=46250 Epoch=225.5] | Loss=0.01931 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=13.979 | 2653.5 samples/s | 41.5 steps/s
[Step=46300 Epoch=225.8] | Loss=0.01995 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=13.979 | 5538.8 samples/s | 86.5 steps/s
[Step=46350 Epoch=226.0] | Loss=0.01959 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.654 | L2-Norm(final)=13.979 | 5405.3 samples/s | 84.5 steps/s
[Step=46400 Epoch=226.3] | Loss=0.01974 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.654 | L2-Norm(final)=13.979 | 7636.9 samples/s | 119.3 steps/s
[Step=46450 Epoch=226.5] | Loss=0.01987 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=13.979 | 2831.0 samples/s | 44.2 steps/s
[Step=46500 Epoch=226.7] | Loss=0.01996 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.654 | L2-Norm(final)=13.979 | 5321.3 samples/s | 83.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=226.7] | Loss=0.00761 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=13.975 | 7232.7 samples/s | 113.0 steps/s
[Step=46550 Epoch=227.0] | Loss=0.01786 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.660 | L2-Norm(final)=13.976 | 4177.0 samples/s | 65.3 steps/s
[Step=46600 Epoch=227.2] | Loss=0.01897 | Reg=0.00093 | acc=0.9531 | L2-Norm=9.668 | L2-Norm(final)=13.976 | 4720.7 samples/s | 73.8 steps/s
[Step=46650 Epoch=227.5] | Loss=0.01733 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.675 | L2-Norm(final)=13.978 | 4714.1 samples/s | 73.7 steps/s
[Step=46700 Epoch=227.7] | Loss=0.01522 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.681 | L2-Norm(final)=13.980 | 6828.4 samples/s | 106.7 steps/s
[Step=46750 Epoch=228.0] | Loss=0.01359 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.686 | L2-Norm(final)=13.983 | 2469.1 samples/s | 38.6 steps/s
[Step=46800 Epoch=228.2] | Loss=0.01235 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.691 | L2-Norm(final)=13.987 | 4742.9 samples/s | 74.1 steps/s
[Step=46850 Epoch=228.4] | Loss=0.01128 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.696 | L2-Norm(final)=13.990 | 4756.0 samples/s | 74.3 steps/s
[Step=46900 Epoch=228.7] | Loss=0.01059 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.700 | L2-Norm(final)=13.994 | 6101.5 samples/s | 95.3 steps/s
[Step=46950 Epoch=228.9] | Loss=0.01001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.705 | L2-Norm(final)=13.997 | 2563.7 samples/s | 40.1 steps/s
[Step=47000 Epoch=229.2] | Loss=0.00941 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.709 | L2-Norm(final)=14.001 | 4633.0 samples/s | 72.4 steps/s
[Step=47050 Epoch=229.4] | Loss=0.00901 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.712 | L2-Norm(final)=14.004 | 4726.1 samples/s | 73.8 steps/s
[Step=47100 Epoch=229.7] | Loss=0.00866 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.716 | L2-Norm(final)=14.007 | 5710.9 samples/s | 89.2 steps/s
[Step=47150 Epoch=229.9] | Loss=0.00818 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.719 | L2-Norm(final)=14.010 | 2619.5 samples/s | 40.9 steps/s
[Step=47200 Epoch=230.2] | Loss=0.00787 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=14.013 | 4727.9 samples/s | 73.9 steps/s
[Step=47250 Epoch=230.4] | Loss=0.00763 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.726 | L2-Norm(final)=14.017 | 4731.8 samples/s | 73.9 steps/s
[Step=47300 Epoch=230.6] | Loss=0.00745 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.729 | L2-Norm(final)=14.020 | 5182.7 samples/s | 81.0 steps/s
[Step=47350 Epoch=230.9] | Loss=0.00720 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.732 | L2-Norm(final)=14.023 | 2734.8 samples/s | 42.7 steps/s
[Step=47400 Epoch=231.1] | Loss=0.00702 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.735 | L2-Norm(final)=14.026 | 4745.4 samples/s | 74.1 steps/s
[Step=47450 Epoch=231.4] | Loss=0.00688 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=14.029 | 4783.3 samples/s | 74.7 steps/s
[Step=47500 Epoch=231.6] | Loss=0.00673 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.741 | L2-Norm(final)=14.031 | 4756.9 samples/s | 74.3 steps/s
[Step=47550 Epoch=231.9] | Loss=0.00656 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.744 | L2-Norm(final)=14.034 | 2926.3 samples/s | 45.7 steps/s
[Step=47600 Epoch=232.1] | Loss=0.00643 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.746 | L2-Norm(final)=14.037 | 4571.1 samples/s | 71.4 steps/s
[Step=47650 Epoch=232.4] | Loss=0.00626 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.749 | L2-Norm(final)=14.040 | 4734.1 samples/s | 74.0 steps/s
[Step=47700 Epoch=232.6] | Loss=0.00613 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.751 | L2-Norm(final)=14.042 | 4715.4 samples/s | 73.7 steps/s
[Step=47750 Epoch=232.8] | Loss=0.00601 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.754 | L2-Norm(final)=14.045 | 2954.5 samples/s | 46.2 steps/s
[Step=47800 Epoch=233.1] | Loss=0.00586 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.756 | L2-Norm(final)=14.048 | 4689.8 samples/s | 73.3 steps/s
[Step=47850 Epoch=233.3] | Loss=0.00571 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.759 | L2-Norm(final)=14.050 | 4690.0 samples/s | 73.3 steps/s
[Step=47900 Epoch=233.6] | Loss=0.00568 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.761 | L2-Norm(final)=14.053 | 4742.3 samples/s | 74.1 steps/s
[Step=47950 Epoch=233.8] | Loss=0.00563 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.763 | L2-Norm(final)=14.055 | 2881.0 samples/s | 45.0 steps/s
[Step=48000 Epoch=234.1] | Loss=0.00556 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=14.058 | 4742.1 samples/s | 74.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step48000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=50001 Epoch=244.0] | Loss=0.03838 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.654 | L2-Norm(final)=15.582 | 7520.0 samples/s | 117.5 steps/s
[Step=50050 Epoch=244.2] | Loss=0.01662 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=15.583 | 4607.3 samples/s | 72.0 steps/s
[Step=50100 Epoch=244.5] | Loss=0.01713 | Reg=0.00093 | acc=0.9531 | L2-Norm=9.654 | L2-Norm(final)=15.581 | 5490.8 samples/s | 85.8 steps/s
[Step=50150 Epoch=244.7] | Loss=0.01685 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=15.580 | 5514.2 samples/s | 86.2 steps/s
[Step=50200 Epoch=245.0] | Loss=0.01617 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.654 | L2-Norm(final)=15.580 | 8739.0 samples/s | 136.5 steps/s
[Step=50250 Epoch=245.2] | Loss=0.01596 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.654 | L2-Norm(final)=15.581 | 2646.9 samples/s | 41.4 steps/s
[Step=50300 Epoch=245.4] | Loss=0.01616 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=15.582 | 5539.6 samples/s | 86.6 steps/s
[Step=50350 Epoch=245.7] | Loss=0.01590 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.654 | L2-Norm(final)=15.582 | 5406.2 samples/s | 84.5 steps/s
[Step=50400 Epoch=245.9] | Loss=0.01587 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.654 | L2-Norm(final)=15.582 | 7793.2 samples/s | 121.8 steps/s
[Step=50450 Epoch=246.2] | Loss=0.01616 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.654 | L2-Norm(final)=15.583 | 2726.8 samples/s | 42.6 steps/s
[Step=50500 Epoch=246.4] | Loss=0.01611 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=15.584 | 5413.7 samples/s | 84.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=50501 Epoch=246.4] | Loss=0.00420 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=15.591 | 7265.0 samples/s | 113.5 steps/s
[Step=50550 Epoch=246.7] | Loss=0.01567 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.661 | L2-Norm(final)=15.592 | 4194.1 samples/s | 65.5 steps/s
[Step=50600 Epoch=246.9] | Loss=0.01466 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.669 | L2-Norm(final)=15.592 | 4766.4 samples/s | 74.5 steps/s
[Step=50650 Epoch=247.1] | Loss=0.01341 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.676 | L2-Norm(final)=15.594 | 4773.7 samples/s | 74.6 steps/s
[Step=50700 Epoch=247.4] | Loss=0.01233 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.682 | L2-Norm(final)=15.596 | 6746.3 samples/s | 105.4 steps/s
[Step=50750 Epoch=247.6] | Loss=0.01092 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.688 | L2-Norm(final)=15.599 | 2442.8 samples/s | 38.2 steps/s
[Step=50800 Epoch=247.9] | Loss=0.00994 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.693 | L2-Norm(final)=15.601 | 4798.5 samples/s | 75.0 steps/s
[Step=50850 Epoch=248.1] | Loss=0.00922 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.697 | L2-Norm(final)=15.604 | 4696.7 samples/s | 73.4 steps/s
[Step=50900 Epoch=248.4] | Loss=0.00868 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.701 | L2-Norm(final)=15.606 | 6264.9 samples/s | 97.9 steps/s
[Step=50950 Epoch=248.6] | Loss=0.00822 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.705 | L2-Norm(final)=15.609 | 2516.5 samples/s | 39.3 steps/s
[Step=51000 Epoch=248.9] | Loss=0.00770 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.709 | L2-Norm(final)=15.611 | 4752.4 samples/s | 74.3 steps/s
[Step=51050 Epoch=249.1] | Loss=0.00735 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.712 | L2-Norm(final)=15.614 | 4821.6 samples/s | 75.3 steps/s
[Step=51100 Epoch=249.3] | Loss=0.00709 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.715 | L2-Norm(final)=15.616 | 5695.9 samples/s | 89.0 steps/s
[Step=51150 Epoch=249.6] | Loss=0.00677 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.718 | L2-Norm(final)=15.619 | 2612.1 samples/s | 40.8 steps/s
[Step=51200 Epoch=249.8] | Loss=0.00654 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.721 | L2-Norm(final)=15.621 | 4674.7 samples/s | 73.0 steps/s
[Step=51250 Epoch=250.1] | Loss=0.00632 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.724 | L2-Norm(final)=15.623 | 4731.9 samples/s | 73.9 steps/s
[Step=51300 Epoch=250.3] | Loss=0.00608 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.726 | L2-Norm(final)=15.625 | 5428.5 samples/s | 84.8 steps/s
[Step=51350 Epoch=250.6] | Loss=0.00587 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.729 | L2-Norm(final)=15.628 | 2675.4 samples/s | 41.8 steps/s
[Step=51400 Epoch=250.8] | Loss=0.00572 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.731 | L2-Norm(final)=15.630 | 4813.4 samples/s | 75.2 steps/s
[Step=51450 Epoch=251.1] | Loss=0.00560 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.734 | L2-Norm(final)=15.632 | 4682.2 samples/s | 73.2 steps/s
[Step=51500 Epoch=251.3] | Loss=0.00540 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.736 | L2-Norm(final)=15.634 | 5081.7 samples/s | 79.4 steps/s
[Step=51550 Epoch=251.5] | Loss=0.00526 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=15.637 | 2809.2 samples/s | 43.9 steps/s
[Step=51600 Epoch=251.8] | Loss=0.00513 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.740 | L2-Norm(final)=15.639 | 4616.3 samples/s | 72.1 steps/s
[Step=51650 Epoch=252.0] | Loss=0.00504 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.743 | L2-Norm(final)=15.641 | 4739.3 samples/s | 74.1 steps/s
[Step=51700 Epoch=252.3] | Loss=0.00497 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.745 | L2-Norm(final)=15.643 | 4829.8 samples/s | 75.5 steps/s
[Step=51750 Epoch=252.5] | Loss=0.00492 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=15.645 | 2874.0 samples/s | 44.9 steps/s
[Step=51800 Epoch=252.8] | Loss=0.00483 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.749 | L2-Norm(final)=15.647 | 4743.7 samples/s | 74.1 steps/s
[Step=51850 Epoch=253.0] | Loss=0.00473 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.751 | L2-Norm(final)=15.649 | 4763.0 samples/s | 74.4 steps/s
[Step=51900 Epoch=253.2] | Loss=0.00467 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.753 | L2-Norm(final)=15.650 | 4697.0 samples/s | 73.4 steps/s
[Step=51950 Epoch=253.5] | Loss=0.00457 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.755 | L2-Norm(final)=15.652 | 2925.3 samples/s | 45.7 steps/s
[Step=52000 Epoch=253.7] | Loss=0.00450 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.756 | L2-Norm(final)=15.654 | 4753.4 samples/s | 74.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step52000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=38001 Epoch=185.3] | Loss=0.01914 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.654 | L2-Norm(final)=14.866 | 7349.5 samples/s | 114.8 steps/s
[Step=38050 Epoch=185.6] | Loss=0.01977 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.654 | L2-Norm(final)=14.868 | 4757.9 samples/s | 74.3 steps/s
[Step=38100 Epoch=185.8] | Loss=0.01737 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.654 | L2-Norm(final)=14.868 | 5529.3 samples/s | 86.4 steps/s
[Step=38150 Epoch=186.0] | Loss=0.01681 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.654 | L2-Norm(final)=14.868 | 5485.4 samples/s | 85.7 steps/s
[Step=38200 Epoch=186.3] | Loss=0.01616 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.654 | L2-Norm(final)=14.870 | 8623.9 samples/s | 134.7 steps/s
[Step=38250 Epoch=186.5] | Loss=0.01555 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=14.872 | 2676.0 samples/s | 41.8 steps/s
[Step=38300 Epoch=186.8] | Loss=0.01538 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.654 | L2-Norm(final)=14.874 | 5423.2 samples/s | 84.7 steps/s
[Step=38350 Epoch=187.0] | Loss=0.01568 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.654 | L2-Norm(final)=14.877 | 5471.4 samples/s | 85.5 steps/s
[Step=38400 Epoch=187.3] | Loss=0.01553 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.654 | L2-Norm(final)=14.879 | 7661.2 samples/s | 119.7 steps/s
[Step=38450 Epoch=187.5] | Loss=0.01566 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=14.880 | 2806.4 samples/s | 43.8 steps/s
[Step=38500 Epoch=187.7] | Loss=0.01594 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.654 | L2-Norm(final)=14.881 | 5324.5 samples/s | 83.2 steps/s
All layers training...
LR=0.00006, len=1
[Step=38501 Epoch=187.8] | Loss=0.01690 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.654 | L2-Norm(final)=14.894 | 6685.9 samples/s | 104.5 steps/s
[Step=38550 Epoch=188.0] | Loss=0.01596 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.660 | L2-Norm(final)=14.894 | 4432.5 samples/s | 69.3 steps/s
[Step=38600 Epoch=188.2] | Loss=0.01493 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.670 | L2-Norm(final)=14.895 | 4698.5 samples/s | 73.4 steps/s
[Step=38650 Epoch=188.5] | Loss=0.01346 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.678 | L2-Norm(final)=14.897 | 4755.1 samples/s | 74.3 steps/s
[Step=38700 Epoch=188.7] | Loss=0.01237 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.685 | L2-Norm(final)=14.900 | 6726.0 samples/s | 105.1 steps/s
[Step=38750 Epoch=189.0] | Loss=0.01106 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.691 | L2-Norm(final)=14.903 | 2472.1 samples/s | 38.6 steps/s
[Step=38800 Epoch=189.2] | Loss=0.00993 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.696 | L2-Norm(final)=14.906 | 4720.9 samples/s | 73.8 steps/s
[Step=38850 Epoch=189.5] | Loss=0.00926 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.701 | L2-Norm(final)=14.909 | 4699.0 samples/s | 73.4 steps/s
[Step=38900 Epoch=189.7] | Loss=0.00857 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.705 | L2-Norm(final)=14.913 | 6146.7 samples/s | 96.0 steps/s
[Step=38950 Epoch=189.9] | Loss=0.00821 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.710 | L2-Norm(final)=14.916 | 2559.3 samples/s | 40.0 steps/s
[Step=39000 Epoch=190.2] | Loss=0.00772 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.714 | L2-Norm(final)=14.919 | 4703.9 samples/s | 73.5 steps/s
[Step=39050 Epoch=190.4] | Loss=0.00743 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.717 | L2-Norm(final)=14.922 | 4791.9 samples/s | 74.9 steps/s
[Step=39100 Epoch=190.7] | Loss=0.00714 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.721 | L2-Norm(final)=14.925 | 5675.6 samples/s | 88.7 steps/s
[Step=39150 Epoch=190.9] | Loss=0.00678 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.724 | L2-Norm(final)=14.928 | 2639.8 samples/s | 41.2 steps/s
[Step=39200 Epoch=191.2] | Loss=0.00651 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.728 | L2-Norm(final)=14.931 | 4734.0 samples/s | 74.0 steps/s
[Step=39250 Epoch=191.4] | Loss=0.00630 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.731 | L2-Norm(final)=14.934 | 4745.4 samples/s | 74.1 steps/s
[Step=39300 Epoch=191.6] | Loss=0.00609 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.734 | L2-Norm(final)=14.937 | 5280.8 samples/s | 82.5 steps/s
[Step=39350 Epoch=191.9] | Loss=0.00591 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.737 | L2-Norm(final)=14.940 | 2761.7 samples/s | 43.2 steps/s
[Step=39400 Epoch=192.1] | Loss=0.00573 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.740 | L2-Norm(final)=14.943 | 4743.5 samples/s | 74.1 steps/s
[Step=39450 Epoch=192.4] | Loss=0.00559 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.743 | L2-Norm(final)=14.946 | 4799.7 samples/s | 75.0 steps/s
[Step=39500 Epoch=192.6] | Loss=0.00545 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.746 | L2-Norm(final)=14.948 | 4762.9 samples/s | 74.4 steps/s
[Step=39550 Epoch=192.9] | Loss=0.00529 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=14.951 | 2888.5 samples/s | 45.1 steps/s
[Step=39600 Epoch=193.1] | Loss=0.00512 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.751 | L2-Norm(final)=14.954 | 4625.4 samples/s | 72.3 steps/s
[Step=39650 Epoch=193.4] | Loss=0.00504 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.753 | L2-Norm(final)=14.956 | 4786.2 samples/s | 74.8 steps/s
[Step=39700 Epoch=193.6] | Loss=0.00494 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.756 | L2-Norm(final)=14.959 | 4765.2 samples/s | 74.5 steps/s
[Step=39750 Epoch=193.8] | Loss=0.00487 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.758 | L2-Norm(final)=14.962 | 2914.8 samples/s | 45.5 steps/s
[Step=39800 Epoch=194.1] | Loss=0.00477 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.761 | L2-Norm(final)=14.964 | 4682.4 samples/s | 73.2 steps/s
[Step=39850 Epoch=194.3] | Loss=0.00468 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.763 | L2-Norm(final)=14.967 | 4642.0 samples/s | 72.5 steps/s
[Step=39900 Epoch=194.6] | Loss=0.00458 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=14.969 | 4775.5 samples/s | 74.6 steps/s
[Step=39950 Epoch=194.8] | Loss=0.00451 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=14.972 | 2909.8 samples/s | 45.5 steps/s
[Step=40000 Epoch=195.1] | Loss=0.00448 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.770 | L2-Norm(final)=14.974 | 4821.1 samples/s | 75.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step40000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=56001 Epoch=530.7] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=18.207 | 6518.1 samples/s | 101.8 steps/s
[Step=56050 Epoch=531.1] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.651 | L2-Norm(final)=18.208 | 4843.7 samples/s | 75.7 steps/s
[Step=56100 Epoch=531.6] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=18.209 | 8165.7 samples/s | 127.6 steps/s
[Step=56150 Epoch=532.1] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=18.210 | 2545.6 samples/s | 39.8 steps/s
[Step=56200 Epoch=532.5] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=18.211 | 7249.9 samples/s | 113.3 steps/s
[Step=56250 Epoch=533.0] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=18.212 | 2679.7 samples/s | 41.9 steps/s
[Step=56300 Epoch=533.5] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=18.213 | 6285.3 samples/s | 98.2 steps/s
[Step=56350 Epoch=534.0] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=18.214 | 2823.3 samples/s | 44.1 steps/s
[Step=56400 Epoch=534.4] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=18.216 | 5729.2 samples/s | 89.5 steps/s
[Step=56450 Epoch=534.9] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=18.217 | 2907.9 samples/s | 45.4 steps/s
[Step=56500 Epoch=535.4] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=18.218 | 5374.8 samples/s | 84.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=56501 Epoch=535.4] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=18.230 | 6671.1 samples/s | 104.2 steps/s
[Step=56550 Epoch=535.9] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.638 | L2-Norm(final)=18.232 | 4076.7 samples/s | 63.7 steps/s
[Step=56600 Epoch=536.3] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.625 | L2-Norm(final)=18.233 | 6513.1 samples/s | 101.8 steps/s
[Step=56650 Epoch=536.8] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.612 | L2-Norm(final)=18.234 | 2371.4 samples/s | 37.1 steps/s
[Step=56700 Epoch=537.3] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.598 | L2-Norm(final)=18.234 | 5879.4 samples/s | 91.9 steps/s
[Step=56750 Epoch=537.8] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.584 | L2-Norm(final)=18.235 | 2448.8 samples/s | 38.3 steps/s
[Step=56800 Epoch=538.2] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.570 | L2-Norm(final)=18.235 | 5492.7 samples/s | 85.8 steps/s
[Step=56850 Epoch=538.7] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.556 | L2-Norm(final)=18.235 | 2528.6 samples/s | 39.5 steps/s
[Step=56900 Epoch=539.2] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.542 | L2-Norm(final)=18.235 | 4997.6 samples/s | 78.1 steps/s
[Step=56950 Epoch=539.7] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.528 | L2-Norm(final)=18.236 | 2693.5 samples/s | 42.1 steps/s
[Step=57000 Epoch=540.1] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=18.236 | 4587.4 samples/s | 71.7 steps/s
[Step=57050 Epoch=540.6] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.500 | L2-Norm(final)=18.236 | 2870.6 samples/s | 44.9 steps/s
[Step=57100 Epoch=541.1] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.486 | L2-Norm(final)=18.236 | 4345.8 samples/s | 67.9 steps/s
[Step=57150 Epoch=541.5] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.472 | L2-Norm(final)=18.237 | 2846.1 samples/s | 44.5 steps/s
[Step=57200 Epoch=542.0] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.458 | L2-Norm(final)=18.237 | 4508.5 samples/s | 70.4 steps/s
[Step=57250 Epoch=542.5] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.444 | L2-Norm(final)=18.237 | 2835.8 samples/s | 44.3 steps/s
[Step=57300 Epoch=543.0] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.430 | L2-Norm(final)=18.237 | 4526.8 samples/s | 70.7 steps/s
[Step=57350 Epoch=543.4] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.416 | L2-Norm(final)=18.237 | 3122.6 samples/s | 48.8 steps/s
[Step=57400 Epoch=543.9] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.402 | L2-Norm(final)=18.238 | 3869.1 samples/s | 60.5 steps/s
[Step=57450 Epoch=544.4] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.388 | L2-Norm(final)=18.238 | 6806.6 samples/s | 106.4 steps/s
[Step=57500 Epoch=544.9] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.373 | L2-Norm(final)=18.238 | 2343.1 samples/s | 36.6 steps/s
[Step=57550 Epoch=545.3] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=18.238 | 6098.4 samples/s | 95.3 steps/s
[Step=57600 Epoch=545.8] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.345 | L2-Norm(final)=18.239 | 2430.1 samples/s | 38.0 steps/s
[Step=57650 Epoch=546.3] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.330 | L2-Norm(final)=18.239 | 5588.9 samples/s | 87.3 steps/s
[Step=57700 Epoch=546.8] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.316 | L2-Norm(final)=18.239 | 2549.6 samples/s | 39.8 steps/s
[Step=57750 Epoch=547.2] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.301 | L2-Norm(final)=18.240 | 5021.0 samples/s | 78.5 steps/s
[Step=57800 Epoch=547.7] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.287 | L2-Norm(final)=18.240 | 2656.5 samples/s | 41.5 steps/s
[Step=57850 Epoch=548.2] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.272 | L2-Norm(final)=18.240 | 4718.0 samples/s | 73.7 steps/s
[Step=57900 Epoch=548.7] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.257 | L2-Norm(final)=18.240 | 2716.1 samples/s | 42.4 steps/s
[Step=57950 Epoch=549.1] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.243 | L2-Norm(final)=18.241 | 4588.3 samples/s | 71.7 steps/s
[Step=58000 Epoch=549.6] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.228 | L2-Norm(final)=18.241 | 2016.4 samples/s | 31.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_0/client_state-step58000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=46001 Epoch=433.5] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=16.215 | 7337.2 samples/s | 114.6 steps/s
[Step=46050 Epoch=433.9] | Loss=0.00055 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.653 | L2-Norm(final)=16.219 | 4305.4 samples/s | 67.3 steps/s
[Step=46100 Epoch=434.4] | Loss=0.00044 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.653 | L2-Norm(final)=16.223 | 8183.0 samples/s | 127.9 steps/s
[Step=46150 Epoch=434.9] | Loss=0.00047 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.653 | L2-Norm(final)=16.227 | 2559.3 samples/s | 40.0 steps/s
[Step=46200 Epoch=435.3] | Loss=0.00044 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.653 | L2-Norm(final)=16.231 | 7057.0 samples/s | 110.3 steps/s
[Step=46250 Epoch=435.8] | Loss=0.00042 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.653 | L2-Norm(final)=16.234 | 2689.8 samples/s | 42.0 steps/s
[Step=46300 Epoch=436.3] | Loss=0.00043 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.653 | L2-Norm(final)=16.238 | 6211.5 samples/s | 97.1 steps/s
[Step=46350 Epoch=436.7] | Loss=0.00043 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.653 | L2-Norm(final)=16.241 | 2834.7 samples/s | 44.3 steps/s
[Step=46400 Epoch=437.2] | Loss=0.00043 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.653 | L2-Norm(final)=16.244 | 5527.8 samples/s | 86.4 steps/s
[Step=46450 Epoch=437.7] | Loss=0.00042 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.653 | L2-Norm(final)=16.247 | 3030.1 samples/s | 47.3 steps/s
[Step=46500 Epoch=438.2] | Loss=0.00040 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.653 | L2-Norm(final)=16.250 | 5121.8 samples/s | 80.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=438.2] | Loss=0.00030 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.653 | L2-Norm(final)=16.276 | 7042.7 samples/s | 110.0 steps/s
[Step=46550 Epoch=438.6] | Loss=0.00038 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.656 | L2-Norm(final)=16.278 | 4018.8 samples/s | 62.8 steps/s
[Step=46600 Epoch=439.1] | Loss=0.00022 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.659 | L2-Norm(final)=16.280 | 6472.8 samples/s | 101.1 steps/s
[Step=46650 Epoch=439.6] | Loss=0.00015 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.659 | L2-Norm(final)=16.281 | 2391.5 samples/s | 37.4 steps/s
[Step=46700 Epoch=440.0] | Loss=0.00012 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.658 | L2-Norm(final)=16.281 | 5708.3 samples/s | 89.2 steps/s
[Step=46750 Epoch=440.5] | Loss=0.00010 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.656 | L2-Norm(final)=16.282 | 2489.4 samples/s | 38.9 steps/s
[Step=46800 Epoch=441.0] | Loss=0.00008 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=16.282 | 5242.7 samples/s | 81.9 steps/s
[Step=46850 Epoch=441.5] | Loss=0.00007 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.652 | L2-Norm(final)=16.283 | 2602.6 samples/s | 40.7 steps/s
[Step=46900 Epoch=441.9] | Loss=0.00006 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=16.283 | 4760.5 samples/s | 74.4 steps/s
[Step=46950 Epoch=442.4] | Loss=0.00006 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.647 | L2-Norm(final)=16.284 | 2734.1 samples/s | 42.7 steps/s
[Step=47000 Epoch=442.9] | Loss=0.00005 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.645 | L2-Norm(final)=16.284 | 4500.3 samples/s | 70.3 steps/s
[Step=47050 Epoch=443.3] | Loss=0.00005 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.643 | L2-Norm(final)=16.284 | 2837.5 samples/s | 44.3 steps/s
[Step=47100 Epoch=443.8] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.640 | L2-Norm(final)=16.284 | 4497.4 samples/s | 70.3 steps/s
[Step=47150 Epoch=444.3] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.638 | L2-Norm(final)=16.285 | 2848.2 samples/s | 44.5 steps/s
[Step=47200 Epoch=444.8] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.635 | L2-Norm(final)=16.285 | 4517.0 samples/s | 70.6 steps/s
[Step=47250 Epoch=445.2] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.633 | L2-Norm(final)=16.285 | 3150.3 samples/s | 49.2 steps/s
[Step=47300 Epoch=445.7] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.630 | L2-Norm(final)=16.286 | 3927.1 samples/s | 61.4 steps/s
[Step=47350 Epoch=446.2] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.627 | L2-Norm(final)=16.286 | 6503.5 samples/s | 101.6 steps/s
[Step=47400 Epoch=446.6] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.625 | L2-Norm(final)=16.286 | 2369.7 samples/s | 37.0 steps/s
[Step=47450 Epoch=447.1] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.622 | L2-Norm(final)=16.287 | 5859.5 samples/s | 91.6 steps/s
[Step=47500 Epoch=447.6] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.619 | L2-Norm(final)=16.287 | 2473.6 samples/s | 38.6 steps/s
[Step=47550 Epoch=448.1] | Loss=0.00003 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.616 | L2-Norm(final)=16.287 | 5181.9 samples/s | 81.0 steps/s
[Step=47600 Epoch=448.5] | Loss=0.00003 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.613 | L2-Norm(final)=16.287 | 2606.4 samples/s | 40.7 steps/s
[Step=47650 Epoch=449.0] | Loss=0.00003 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.610 | L2-Norm(final)=16.288 | 4783.5 samples/s | 74.7 steps/s
[Step=47700 Epoch=449.5] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.608 | L2-Norm(final)=16.288 | 2778.3 samples/s | 43.4 steps/s
[Step=47750 Epoch=449.9] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.605 | L2-Norm(final)=16.288 | 4383.7 samples/s | 68.5 steps/s
[Step=47800 Epoch=450.4] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.602 | L2-Norm(final)=16.288 | 2851.0 samples/s | 44.5 steps/s
[Step=47850 Epoch=450.9] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.599 | L2-Norm(final)=16.289 | 4544.9 samples/s | 71.0 steps/s
[Step=47900 Epoch=451.4] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.595 | L2-Norm(final)=16.289 | 2880.7 samples/s | 45.0 steps/s
[Step=47950 Epoch=451.8] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.592 | L2-Norm(final)=16.289 | 4313.4 samples/s | 67.4 steps/s
[Step=48000 Epoch=452.3] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.589 | L2-Norm(final)=16.289 | 3096.0 samples/s | 48.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step48000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07905 | acc=0.9648 | tpr=0.9775 | fpr=0.0627 | 5913.5 samples/s | 23.1 steps/s
Avg test loss: 0.08339, Avg test acc: 0.96254, Avg tpr: 0.97622, Avg fpr: 0.06756, total FA: 527

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08530 | acc=0.9635 | tpr=0.9760 | fpr=0.0637 | 5969.1 samples/s | 23.3 steps/s
Avg test loss: 0.08863, Avg test acc: 0.96190, Avg tpr: 0.97354, Avg fpr: 0.06371, total FA: 497

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08528 | acc=0.9635 | tpr=0.9742 | fpr=0.0597 | 6096.2 samples/s | 23.8 steps/s
Avg test loss: 0.08920, Avg test acc: 0.96129, Avg tpr: 0.97103, Avg fpr: 0.06012, total FA: 469

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08462 | acc=0.9634 | tpr=0.9815 | fpr=0.0758 | 5798.2 samples/s | 22.6 steps/s
Avg test loss: 0.08868, Avg test acc: 0.96266, Avg tpr: 0.98036, Avg fpr: 0.07627, total FA: 595

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08452 | acc=0.9630 | tpr=0.9739 | fpr=0.0605 | 6078.5 samples/s | 23.7 steps/s
Avg test loss: 0.08755, Avg test acc: 0.96210, Avg tpr: 0.97208, Avg fpr: 0.05986, total FA: 467

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.16973 | acc=0.2797 | tpr=0.0203 | fpr=0.1571 | 5874.2 samples/s | 22.9 steps/s
Avg test loss: 6.17438, Avg test acc: 0.27879, Avg tpr: 0.01970, Avg fpr: 0.15139, total FA: 1181

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.62925 | acc=0.3075 | tpr=0.0280 | fpr=0.0855 | 5945.8 samples/s | 23.2 steps/s
Avg test loss: 4.63957, Avg test acc: 0.30535, Avg tpr: 0.02751, Avg fpr: 0.08358, total FA: 652

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.92413 | acc=0.2955 | tpr=0.0243 | fpr=0.1157 | 5887.4 samples/s | 23.0 steps/s
Avg test loss: 4.93020, Avg test acc: 0.29337, Avg tpr: 0.02314, Avg fpr: 0.11229, total FA: 876

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.11880 | acc=0.2757 | tpr=0.0223 | fpr=0.1739 | 5957.0 samples/s | 23.3 steps/s
Avg test loss: 5.12231, Avg test acc: 0.27578, Avg tpr: 0.02209, Avg fpr: 0.16626, total FA: 1297

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.90266 | acc=0.2911 | tpr=0.0189 | fpr=0.1179 | 5912.6 samples/s | 23.1 steps/s
Avg test loss: 4.91703, Avg test acc: 0.29033, Avg tpr: 0.01883, Avg fpr: 0.11255, total FA: 878

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.27028 | acc=0.1180 | tpr=0.6504 | fpr=0.8916 | 6032.9 samples/s | 23.6 steps/s
[Step= 100] | Loss=5.25690 | acc=0.1187 | tpr=0.6311 | fpr=0.8908 | 7887.2 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.24645 | acc=0.1206 | tpr=0.6441 | fpr=0.8891 | 7651.3 samples/s | 29.9 steps/s
[Step= 200] | Loss=5.23550 | acc=0.1211 | tpr=0.6393 | fpr=0.8883 | 7871.8 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.24255 | acc=0.1209 | tpr=0.6332 | fpr=0.8884 | 7706.8 samples/s | 30.1 steps/s
[Step= 300] | Loss=5.23644 | acc=0.1206 | tpr=0.6262 | fpr=0.8886 | 8303.9 samples/s | 32.4 steps/s
[Step= 350] | Loss=5.24124 | acc=0.1208 | tpr=0.6218 | fpr=0.8883 | 7520.3 samples/s | 29.4 steps/s
[Step= 400] | Loss=5.23873 | acc=0.1211 | tpr=0.6204 | fpr=0.8880 | 7959.9 samples/s | 31.1 steps/s
[Step= 450] | Loss=5.24422 | acc=0.1208 | tpr=0.6232 | fpr=0.8884 | 8401.4 samples/s | 32.8 steps/s
[Step= 500] | Loss=5.24439 | acc=0.1207 | tpr=0.6286 | fpr=0.8885 | 7719.5 samples/s | 30.2 steps/s
[Step= 550] | Loss=5.24716 | acc=0.1207 | tpr=0.6299 | fpr=0.8885 | 11076.2 samples/s | 43.3 steps/s
Avg test loss: 5.24747, Avg test acc: 0.12063, Avg tpr: 0.63074, Avg fpr: 0.88864, total FA: 123386

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.92291 | acc=0.1320 | tpr=0.5752 | fpr=0.8759 | 5959.1 samples/s | 23.3 steps/s
[Step= 100] | Loss=4.91471 | acc=0.1356 | tpr=0.5800 | fpr=0.8727 | 7895.4 samples/s | 30.8 steps/s
[Step= 150] | Loss=4.90459 | acc=0.1386 | tpr=0.6052 | fpr=0.8699 | 6946.8 samples/s | 27.1 steps/s
[Step= 200] | Loss=4.89518 | acc=0.1393 | tpr=0.6055 | fpr=0.8692 | 8132.5 samples/s | 31.8 steps/s
[Step= 250] | Loss=4.90002 | acc=0.1389 | tpr=0.6009 | fpr=0.8696 | 8007.6 samples/s | 31.3 steps/s
[Step= 300] | Loss=4.89577 | acc=0.1384 | tpr=0.5935 | fpr=0.8699 | 8272.0 samples/s | 32.3 steps/s
[Step= 350] | Loss=4.90045 | acc=0.1382 | tpr=0.5892 | fpr=0.8700 | 7842.5 samples/s | 30.6 steps/s
[Step= 400] | Loss=4.89832 | acc=0.1386 | tpr=0.5886 | fpr=0.8696 | 8462.8 samples/s | 33.1 steps/s
[Step= 450] | Loss=4.90233 | acc=0.1379 | tpr=0.5959 | fpr=0.8704 | 7962.1 samples/s | 31.1 steps/s
[Step= 500] | Loss=4.90356 | acc=0.1378 | tpr=0.5978 | fpr=0.8705 | 8340.0 samples/s | 32.6 steps/s
[Step= 550] | Loss=4.90718 | acc=0.1379 | tpr=0.5993 | fpr=0.8704 | 10540.0 samples/s | 41.2 steps/s
Avg test loss: 4.90742, Avg test acc: 0.13783, Avg tpr: 0.60063, Avg fpr: 0.87058, total FA: 120878

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.12202 | acc=0.1241 | tpr=0.5708 | fpr=0.8840 | 5636.6 samples/s | 22.0 steps/s
[Step= 100] | Loss=5.10821 | acc=0.1264 | tpr=0.5778 | fpr=0.8820 | 7815.9 samples/s | 30.5 steps/s
[Step= 150] | Loss=5.09892 | acc=0.1288 | tpr=0.5893 | fpr=0.8796 | 8457.2 samples/s | 33.0 steps/s
[Step= 200] | Loss=5.08957 | acc=0.1294 | tpr=0.5836 | fpr=0.8788 | 8123.8 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.09588 | acc=0.1295 | tpr=0.5825 | fpr=0.8787 | 8210.6 samples/s | 32.1 steps/s
[Step= 300] | Loss=5.09195 | acc=0.1294 | tpr=0.5804 | fpr=0.8788 | 8104.4 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.09689 | acc=0.1294 | tpr=0.5792 | fpr=0.8787 | 8030.5 samples/s | 31.4 steps/s
[Step= 400] | Loss=5.09603 | acc=0.1296 | tpr=0.5799 | fpr=0.8786 | 7526.2 samples/s | 29.4 steps/s
[Step= 450] | Loss=5.10098 | acc=0.1289 | tpr=0.5808 | fpr=0.8793 | 8100.5 samples/s | 31.6 steps/s
[Step= 500] | Loss=5.10015 | acc=0.1287 | tpr=0.5811 | fpr=0.8795 | 7809.2 samples/s | 30.5 steps/s
[Step= 550] | Loss=5.10318 | acc=0.1288 | tpr=0.5794 | fpr=0.8794 | 10377.1 samples/s | 40.5 steps/s
Avg test loss: 5.10361, Avg test acc: 0.12867, Avg tpr: 0.58043, Avg fpr: 0.87954, total FA: 122122

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.23383 | acc=0.1218 | tpr=0.6903 | fpr=0.8884 | 5919.3 samples/s | 23.1 steps/s
[Step= 100] | Loss=5.22284 | acc=0.1246 | tpr=0.6716 | fpr=0.8856 | 8133.7 samples/s | 31.8 steps/s
[Step= 150] | Loss=5.21154 | acc=0.1264 | tpr=0.6787 | fpr=0.8837 | 7572.4 samples/s | 29.6 steps/s
[Step= 200] | Loss=5.20142 | acc=0.1273 | tpr=0.6765 | fpr=0.8827 | 8273.4 samples/s | 32.3 steps/s
[Step= 250] | Loss=5.20556 | acc=0.1268 | tpr=0.6655 | fpr=0.8830 | 8075.7 samples/s | 31.5 steps/s
[Step= 300] | Loss=5.20183 | acc=0.1264 | tpr=0.6640 | fpr=0.8834 | 8024.1 samples/s | 31.3 steps/s
[Step= 350] | Loss=5.20728 | acc=0.1262 | tpr=0.6644 | fpr=0.8836 | 8152.5 samples/s | 31.8 steps/s
[Step= 400] | Loss=5.20582 | acc=0.1264 | tpr=0.6630 | fpr=0.8834 | 8273.3 samples/s | 32.3 steps/s
[Step= 450] | Loss=5.21097 | acc=0.1256 | tpr=0.6665 | fpr=0.8842 | 7571.2 samples/s | 29.6 steps/s
[Step= 500] | Loss=5.21076 | acc=0.1256 | tpr=0.6714 | fpr=0.8843 | 8325.2 samples/s | 32.5 steps/s
[Step= 550] | Loss=5.21490 | acc=0.1256 | tpr=0.6741 | fpr=0.8843 | 9182.2 samples/s | 35.9 steps/s
Avg test loss: 5.21540, Avg test acc: 0.12556, Avg tpr: 0.67512, Avg fpr: 0.88443, total FA: 122801

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.97711 | acc=0.1332 | tpr=0.5177 | fpr=0.8737 | 6111.9 samples/s | 23.9 steps/s
[Step= 100] | Loss=4.96681 | acc=0.1348 | tpr=0.5053 | fpr=0.8721 | 7540.2 samples/s | 29.5 steps/s
[Step= 150] | Loss=4.95605 | acc=0.1369 | tpr=0.5202 | fpr=0.8701 | 7253.2 samples/s | 28.3 steps/s
[Step= 200] | Loss=4.94827 | acc=0.1382 | tpr=0.5115 | fpr=0.8686 | 8222.5 samples/s | 32.1 steps/s
[Step= 250] | Loss=4.95265 | acc=0.1380 | tpr=0.4996 | fpr=0.8686 | 8063.9 samples/s | 31.5 steps/s
[Step= 300] | Loss=4.94938 | acc=0.1378 | tpr=0.4909 | fpr=0.8686 | 8965.2 samples/s | 35.0 steps/s
[Step= 350] | Loss=4.95575 | acc=0.1376 | tpr=0.4890 | fpr=0.8688 | 8303.8 samples/s | 32.4 steps/s
[Step= 400] | Loss=4.95274 | acc=0.1378 | tpr=0.4902 | fpr=0.8686 | 7578.9 samples/s | 29.6 steps/s
[Step= 450] | Loss=4.95705 | acc=0.1371 | tpr=0.4932 | fpr=0.8694 | 7960.2 samples/s | 31.1 steps/s
[Step= 500] | Loss=4.95670 | acc=0.1372 | tpr=0.4943 | fpr=0.8693 | 8290.5 samples/s | 32.4 steps/s
[Step= 550] | Loss=4.95962 | acc=0.1373 | tpr=0.4930 | fpr=0.8691 | 9256.3 samples/s | 36.2 steps/s
Avg test loss: 4.96019, Avg test acc: 0.13722, Avg tpr: 0.49366, Avg fpr: 0.86926, total FA: 120695

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.22570 | acc=0.9580 | tpr=0.9513 | fpr=0.0418 | 5829.1 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.23417 | acc=0.9574 | tpr=0.9595 | fpr=0.0426 | 7448.0 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.23649 | acc=0.9559 | tpr=0.9568 | fpr=0.0442 | 7929.4 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.23671 | acc=0.9559 | tpr=0.9607 | fpr=0.0442 | 8367.6 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.23701 | acc=0.9557 | tpr=0.9581 | fpr=0.0443 | 7873.2 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.24060 | acc=0.9554 | tpr=0.9564 | fpr=0.0446 | 8169.8 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.23867 | acc=0.9556 | tpr=0.9555 | fpr=0.0444 | 8220.4 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.23846 | acc=0.9553 | tpr=0.9535 | fpr=0.0446 | 7890.4 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.24193 | acc=0.9549 | tpr=0.9523 | fpr=0.0450 | 8192.8 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.24242 | acc=0.9548 | tpr=0.9533 | fpr=0.0452 | 7666.5 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.24116 | acc=0.9550 | tpr=0.9538 | fpr=0.0450 | 10762.1 samples/s | 42.0 steps/s
Avg test loss: 0.24085, Avg test acc: 0.95503, Avg tpr: 0.95365, Avg fpr: 0.04494, total FA: 6240

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14794 | acc=0.9644 | tpr=0.9292 | fpr=0.0350 | 5943.2 samples/s | 23.2 steps/s
[Step= 100] | Loss=0.15443 | acc=0.9632 | tpr=0.9318 | fpr=0.0362 | 8123.4 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.15653 | acc=0.9621 | tpr=0.9323 | fpr=0.0373 | 7753.4 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.15687 | acc=0.9622 | tpr=0.9366 | fpr=0.0374 | 7798.6 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.15624 | acc=0.9623 | tpr=0.9371 | fpr=0.0373 | 8112.9 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.15896 | acc=0.9618 | tpr=0.9353 | fpr=0.0377 | 7912.3 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.15773 | acc=0.9619 | tpr=0.9343 | fpr=0.0376 | 8362.4 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.15823 | acc=0.9616 | tpr=0.9311 | fpr=0.0378 | 7776.2 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.16087 | acc=0.9611 | tpr=0.9309 | fpr=0.0384 | 8016.7 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.16025 | acc=0.9610 | tpr=0.9322 | fpr=0.0384 | 8157.7 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.15946 | acc=0.9614 | tpr=0.9331 | fpr=0.0381 | 9415.3 samples/s | 36.8 steps/s
Avg test loss: 0.15928, Avg test acc: 0.96138, Avg tpr: 0.93304, Avg fpr: 0.03811, total FA: 5291

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.25530 | acc=0.9499 | tpr=0.9513 | fpr=0.0501 | 5911.6 samples/s | 23.1 steps/s
[Step= 100] | Loss=0.26410 | acc=0.9485 | tpr=0.9595 | fpr=0.0517 | 8150.8 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.26834 | acc=0.9476 | tpr=0.9611 | fpr=0.0527 | 7843.3 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.26827 | acc=0.9478 | tpr=0.9639 | fpr=0.0525 | 8016.5 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.26833 | acc=0.9477 | tpr=0.9633 | fpr=0.0526 | 7826.7 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.27121 | acc=0.9476 | tpr=0.9622 | fpr=0.0527 | 7417.8 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.26935 | acc=0.9478 | tpr=0.9612 | fpr=0.0525 | 8020.3 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.26950 | acc=0.9474 | tpr=0.9590 | fpr=0.0528 | 8369.7 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.27286 | acc=0.9470 | tpr=0.9586 | fpr=0.0532 | 7956.3 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.27332 | acc=0.9469 | tpr=0.9590 | fpr=0.0533 | 8156.6 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.27169 | acc=0.9472 | tpr=0.9594 | fpr=0.0530 | 10174.5 samples/s | 39.7 steps/s
Avg test loss: 0.27148, Avg test acc: 0.94722, Avg tpr: 0.95919, Avg fpr: 0.05300, total FA: 7359

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.16010 | acc=0.9636 | tpr=0.9469 | fpr=0.0361 | 5892.8 samples/s | 23.0 steps/s
[Step= 100] | Loss=0.16683 | acc=0.9625 | tpr=0.9552 | fpr=0.0374 | 7973.8 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.16771 | acc=0.9607 | tpr=0.9496 | fpr=0.0391 | 8025.8 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.16793 | acc=0.9607 | tpr=0.9519 | fpr=0.0392 | 7964.7 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.16755 | acc=0.9607 | tpr=0.9502 | fpr=0.0392 | 7871.0 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.17056 | acc=0.9602 | tpr=0.9476 | fpr=0.0395 | 7695.6 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.16920 | acc=0.9602 | tpr=0.9468 | fpr=0.0395 | 8086.9 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.16896 | acc=0.9601 | tpr=0.9453 | fpr=0.0396 | 7793.9 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.17120 | acc=0.9598 | tpr=0.9450 | fpr=0.0400 | 8558.5 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.17130 | acc=0.9597 | tpr=0.9467 | fpr=0.0401 | 7793.9 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.17032 | acc=0.9599 | tpr=0.9479 | fpr=0.0399 | 10625.2 samples/s | 41.5 steps/s
Avg test loss: 0.17010, Avg test acc: 0.95991, Avg tpr: 0.94770, Avg fpr: 0.03987, total FA: 5536

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21562 | acc=0.9586 | tpr=0.9513 | fpr=0.0413 | 6074.8 samples/s | 23.7 steps/s
[Step= 100] | Loss=0.22490 | acc=0.9569 | tpr=0.9574 | fpr=0.0431 | 7887.4 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.22815 | acc=0.9553 | tpr=0.9582 | fpr=0.0447 | 7721.5 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.22815 | acc=0.9552 | tpr=0.9596 | fpr=0.0449 | 7115.0 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.22848 | acc=0.9551 | tpr=0.9590 | fpr=0.0450 | 8422.2 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.23213 | acc=0.9546 | tpr=0.9549 | fpr=0.0454 | 8836.5 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.23079 | acc=0.9546 | tpr=0.9549 | fpr=0.0454 | 7975.1 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.23106 | acc=0.9542 | tpr=0.9513 | fpr=0.0457 | 8273.6 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.23452 | acc=0.9537 | tpr=0.9508 | fpr=0.0462 | 8350.8 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.23454 | acc=0.9536 | tpr=0.9502 | fpr=0.0463 | 6962.6 samples/s | 27.2 steps/s
[Step= 550] | Loss=0.23306 | acc=0.9539 | tpr=0.9507 | fpr=0.0460 | 10314.5 samples/s | 40.3 steps/s
Avg test loss: 0.23287, Avg test acc: 0.95393, Avg tpr: 0.95048, Avg fpr: 0.04601, total FA: 6388

server round 46/50

clients selected: [1 4 6 7 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=52001 Epoch=253.7] | Loss=0.00398 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=15.711 | 7322.7 samples/s | 114.4 steps/s
[Step=52050 Epoch=254.0] | Loss=0.01779 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=15.712 | 4920.3 samples/s | 76.9 steps/s
[Step=52100 Epoch=254.2] | Loss=0.01514 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=15.714 | 5265.2 samples/s | 82.3 steps/s
[Step=52150 Epoch=254.5] | Loss=0.01593 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=15.716 | 5572.8 samples/s | 87.1 steps/s
[Step=52200 Epoch=254.7] | Loss=0.01591 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.578 | L2-Norm(final)=15.717 | 8557.5 samples/s | 133.7 steps/s
[Step=52250 Epoch=255.0] | Loss=0.01622 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=15.718 | 2645.1 samples/s | 41.3 steps/s
[Step=52300 Epoch=255.2] | Loss=0.01629 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=15.718 | 5490.9 samples/s | 85.8 steps/s
[Step=52350 Epoch=255.4] | Loss=0.01632 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=15.719 | 5415.9 samples/s | 84.6 steps/s
[Step=52400 Epoch=255.7] | Loss=0.01598 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.578 | L2-Norm(final)=15.720 | 7894.8 samples/s | 123.4 steps/s
[Step=52450 Epoch=255.9] | Loss=0.01625 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.578 | L2-Norm(final)=15.721 | 2726.5 samples/s | 42.6 steps/s
[Step=52500 Epoch=256.2] | Loss=0.01626 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=15.722 | 5479.9 samples/s | 85.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=52501 Epoch=256.2] | Loss=0.00302 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=15.733 | 6904.5 samples/s | 107.9 steps/s
[Step=52550 Epoch=256.4] | Loss=0.01644 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.585 | L2-Norm(final)=15.734 | 4318.3 samples/s | 67.5 steps/s
[Step=52600 Epoch=256.7] | Loss=0.01431 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=15.735 | 4757.9 samples/s | 74.3 steps/s
[Step=52650 Epoch=256.9] | Loss=0.01266 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.600 | L2-Norm(final)=15.737 | 4678.2 samples/s | 73.1 steps/s
[Step=52700 Epoch=257.2] | Loss=0.01218 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.605 | L2-Norm(final)=15.739 | 6881.4 samples/s | 107.5 steps/s
[Step=52750 Epoch=257.4] | Loss=0.01077 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.611 | L2-Norm(final)=15.742 | 2434.1 samples/s | 38.0 steps/s
[Step=52800 Epoch=257.6] | Loss=0.00968 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.616 | L2-Norm(final)=15.745 | 4758.9 samples/s | 74.4 steps/s
[Step=52850 Epoch=257.9] | Loss=0.00896 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.620 | L2-Norm(final)=15.748 | 4716.7 samples/s | 73.7 steps/s
[Step=52900 Epoch=258.1] | Loss=0.00860 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.624 | L2-Norm(final)=15.751 | 6260.8 samples/s | 97.8 steps/s
[Step=52950 Epoch=258.4] | Loss=0.00822 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.628 | L2-Norm(final)=15.754 | 2517.4 samples/s | 39.3 steps/s
[Step=53000 Epoch=258.6] | Loss=0.00781 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.632 | L2-Norm(final)=15.756 | 4767.8 samples/s | 74.5 steps/s
[Step=53050 Epoch=258.9] | Loss=0.00751 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.635 | L2-Norm(final)=15.759 | 4688.0 samples/s | 73.2 steps/s
[Step=53100 Epoch=259.1] | Loss=0.00713 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.639 | L2-Norm(final)=15.762 | 5833.1 samples/s | 91.1 steps/s
[Step=53150 Epoch=259.3] | Loss=0.00680 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.642 | L2-Norm(final)=15.764 | 2594.6 samples/s | 40.5 steps/s
[Step=53200 Epoch=259.6] | Loss=0.00655 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.645 | L2-Norm(final)=15.767 | 4756.2 samples/s | 74.3 steps/s
[Step=53250 Epoch=259.8] | Loss=0.00636 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.647 | L2-Norm(final)=15.769 | 4697.3 samples/s | 73.4 steps/s
[Step=53300 Epoch=260.1] | Loss=0.00614 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=15.772 | 5472.7 samples/s | 85.5 steps/s
[Step=53350 Epoch=260.3] | Loss=0.00599 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.653 | L2-Norm(final)=15.774 | 2730.1 samples/s | 42.7 steps/s
[Step=53400 Epoch=260.6] | Loss=0.00581 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.655 | L2-Norm(final)=15.776 | 4558.3 samples/s | 71.2 steps/s
[Step=53450 Epoch=260.8] | Loss=0.00562 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.658 | L2-Norm(final)=15.779 | 4809.8 samples/s | 75.2 steps/s
[Step=53500 Epoch=261.1] | Loss=0.00553 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.660 | L2-Norm(final)=15.781 | 5068.1 samples/s | 79.2 steps/s
[Step=53550 Epoch=261.3] | Loss=0.00538 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.663 | L2-Norm(final)=15.783 | 2786.4 samples/s | 43.5 steps/s
[Step=53600 Epoch=261.5] | Loss=0.00521 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.665 | L2-Norm(final)=15.785 | 4738.2 samples/s | 74.0 steps/s
[Step=53650 Epoch=261.8] | Loss=0.00514 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=15.788 | 4705.0 samples/s | 73.5 steps/s
[Step=53700 Epoch=262.0] | Loss=0.00508 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.669 | L2-Norm(final)=15.790 | 4791.0 samples/s | 74.9 steps/s
[Step=53750 Epoch=262.3] | Loss=0.00497 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.671 | L2-Norm(final)=15.792 | 2877.8 samples/s | 45.0 steps/s
[Step=53800 Epoch=262.5] | Loss=0.00486 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.673 | L2-Norm(final)=15.794 | 4718.2 samples/s | 73.7 steps/s
[Step=53850 Epoch=262.8] | Loss=0.00474 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.676 | L2-Norm(final)=15.796 | 4734.2 samples/s | 74.0 steps/s
[Step=53900 Epoch=263.0] | Loss=0.00467 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.678 | L2-Norm(final)=15.798 | 4731.8 samples/s | 73.9 steps/s
[Step=53950 Epoch=263.3] | Loss=0.00459 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=15.800 | 2917.8 samples/s | 45.6 steps/s
[Step=54000 Epoch=263.5] | Loss=0.00451 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=15.802 | 4770.7 samples/s | 74.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step54000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=40001 Epoch=196.2] | Loss=0.00590 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=15.030 | 6628.2 samples/s | 103.6 steps/s
[Step=40050 Epoch=196.4] | Loss=0.01715 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.579 | L2-Norm(final)=15.035 | 5186.1 samples/s | 81.0 steps/s
[Step=40100 Epoch=196.6] | Loss=0.01786 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.579 | L2-Norm(final)=15.042 | 5491.3 samples/s | 85.8 steps/s
[Step=40150 Epoch=196.9] | Loss=0.01805 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.579 | L2-Norm(final)=15.050 | 5324.0 samples/s | 83.2 steps/s
[Step=40200 Epoch=197.1] | Loss=0.01803 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.579 | L2-Norm(final)=15.056 | 8933.3 samples/s | 139.6 steps/s
[Step=40250 Epoch=197.4] | Loss=0.01892 | Reg=0.00092 | acc=0.9375 | L2-Norm=9.579 | L2-Norm(final)=15.061 | 2624.7 samples/s | 41.0 steps/s
[Step=40300 Epoch=197.6] | Loss=0.01837 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.579 | L2-Norm(final)=15.067 | 5435.7 samples/s | 84.9 steps/s
[Step=40350 Epoch=197.9] | Loss=0.01810 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.579 | L2-Norm(final)=15.072 | 5498.3 samples/s | 85.9 steps/s
[Step=40400 Epoch=198.1] | Loss=0.01787 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.579 | L2-Norm(final)=15.077 | 8121.3 samples/s | 126.9 steps/s
[Step=40450 Epoch=198.4] | Loss=0.01794 | Reg=0.00092 | acc=0.9375 | L2-Norm=9.579 | L2-Norm(final)=15.082 | 2680.9 samples/s | 41.9 steps/s
[Step=40500 Epoch=198.6] | Loss=0.01795 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.579 | L2-Norm(final)=15.086 | 5501.8 samples/s | 86.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=198.6] | Loss=0.00180 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.579 | L2-Norm(final)=15.129 | 7040.8 samples/s | 110.0 steps/s
[Step=40550 Epoch=198.9] | Loss=0.01785 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.585 | L2-Norm(final)=15.129 | 4549.9 samples/s | 71.1 steps/s
[Step=40600 Epoch=199.1] | Loss=0.01695 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.594 | L2-Norm(final)=15.130 | 4708.6 samples/s | 73.6 steps/s
[Step=40650 Epoch=199.3] | Loss=0.01521 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.600 | L2-Norm(final)=15.132 | 4723.5 samples/s | 73.8 steps/s
[Step=40700 Epoch=199.6] | Loss=0.01432 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.607 | L2-Norm(final)=15.134 | 6997.6 samples/s | 109.3 steps/s
[Step=40750 Epoch=199.8] | Loss=0.01253 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.613 | L2-Norm(final)=15.137 | 2427.6 samples/s | 37.9 steps/s
[Step=40800 Epoch=200.1] | Loss=0.01135 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.618 | L2-Norm(final)=15.140 | 4751.3 samples/s | 74.2 steps/s
[Step=40850 Epoch=200.3] | Loss=0.01053 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.623 | L2-Norm(final)=15.144 | 4728.5 samples/s | 73.9 steps/s
[Step=40900 Epoch=200.6] | Loss=0.00981 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.627 | L2-Norm(final)=15.147 | 6494.3 samples/s | 101.5 steps/s
[Step=40950 Epoch=200.8] | Loss=0.00916 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.631 | L2-Norm(final)=15.150 | 2489.8 samples/s | 38.9 steps/s
[Step=41000 Epoch=201.1] | Loss=0.00861 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.635 | L2-Norm(final)=15.154 | 4709.4 samples/s | 73.6 steps/s
[Step=41050 Epoch=201.3] | Loss=0.00817 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.639 | L2-Norm(final)=15.157 | 4714.4 samples/s | 73.7 steps/s
[Step=41100 Epoch=201.5] | Loss=0.00787 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.642 | L2-Norm(final)=15.160 | 6137.8 samples/s | 95.9 steps/s
[Step=41150 Epoch=201.8] | Loss=0.00742 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.646 | L2-Norm(final)=15.163 | 2541.1 samples/s | 39.7 steps/s
[Step=41200 Epoch=202.0] | Loss=0.00710 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.649 | L2-Norm(final)=15.166 | 4692.0 samples/s | 73.3 steps/s
[Step=41250 Epoch=202.3] | Loss=0.00686 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.652 | L2-Norm(final)=15.169 | 4782.2 samples/s | 74.7 steps/s
[Step=41300 Epoch=202.5] | Loss=0.00668 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.655 | L2-Norm(final)=15.172 | 5738.0 samples/s | 89.7 steps/s
[Step=41350 Epoch=202.8] | Loss=0.00652 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.658 | L2-Norm(final)=15.175 | 2602.5 samples/s | 40.7 steps/s
[Step=41400 Epoch=203.0] | Loss=0.00634 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.661 | L2-Norm(final)=15.178 | 4798.5 samples/s | 75.0 steps/s
[Step=41450 Epoch=203.3] | Loss=0.00617 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=15.181 | 4650.0 samples/s | 72.7 steps/s
[Step=41500 Epoch=203.5] | Loss=0.00605 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=15.184 | 5516.2 samples/s | 86.2 steps/s
[Step=41550 Epoch=203.8] | Loss=0.00585 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.669 | L2-Norm(final)=15.187 | 2692.8 samples/s | 42.1 steps/s
[Step=41600 Epoch=204.0] | Loss=0.00572 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.672 | L2-Norm(final)=15.190 | 4731.2 samples/s | 73.9 steps/s
[Step=41650 Epoch=204.2] | Loss=0.00561 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.674 | L2-Norm(final)=15.192 | 4751.8 samples/s | 74.2 steps/s
[Step=41700 Epoch=204.5] | Loss=0.00546 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.677 | L2-Norm(final)=15.195 | 5143.9 samples/s | 80.4 steps/s
[Step=41750 Epoch=204.7] | Loss=0.00534 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=15.198 | 2775.5 samples/s | 43.4 steps/s
[Step=41800 Epoch=205.0] | Loss=0.00524 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=15.200 | 4678.8 samples/s | 73.1 steps/s
[Step=41850 Epoch=205.2] | Loss=0.00515 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.684 | L2-Norm(final)=15.203 | 4709.8 samples/s | 73.6 steps/s
[Step=41900 Epoch=205.5] | Loss=0.00506 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.686 | L2-Norm(final)=15.205 | 4942.2 samples/s | 77.2 steps/s
[Step=41950 Epoch=205.7] | Loss=0.00499 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.689 | L2-Norm(final)=15.208 | 2816.4 samples/s | 44.0 steps/s
[Step=42000 Epoch=206.0] | Loss=0.00491 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.691 | L2-Norm(final)=15.210 | 4731.8 samples/s | 73.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step42000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=42001 Epoch=399.5] | Loss=0.00059 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=15.847 | 7592.1 samples/s | 118.6 steps/s
[Step=42050 Epoch=400.0] | Loss=0.00062 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=15.853 | 4321.8 samples/s | 67.5 steps/s
[Step=42100 Epoch=400.5] | Loss=0.00068 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=15.858 | 8042.8 samples/s | 125.7 steps/s
[Step=42150 Epoch=401.0] | Loss=0.00061 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=15.865 | 2516.8 samples/s | 39.3 steps/s
[Step=42200 Epoch=401.4] | Loss=0.00065 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=15.872 | 7274.0 samples/s | 113.7 steps/s
[Step=42250 Epoch=401.9] | Loss=0.00062 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=15.877 | 2670.2 samples/s | 41.7 steps/s
[Step=42300 Epoch=402.4] | Loss=0.00067 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=15.882 | 6501.9 samples/s | 101.6 steps/s
[Step=42350 Epoch=402.9] | Loss=0.00067 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=15.887 | 2793.8 samples/s | 43.7 steps/s
[Step=42400 Epoch=403.3] | Loss=0.00065 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=15.892 | 5828.0 samples/s | 91.1 steps/s
[Step=42450 Epoch=403.8] | Loss=0.00063 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=15.897 | 2942.6 samples/s | 46.0 steps/s
[Step=42500 Epoch=404.3] | Loss=0.00064 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=15.901 | 5264.6 samples/s | 82.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=404.3] | Loss=0.00011 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=15.945 | 7422.5 samples/s | 116.0 steps/s
[Step=42550 Epoch=404.8] | Loss=0.00016 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.584 | L2-Norm(final)=15.947 | 3858.3 samples/s | 60.3 steps/s
[Step=42600 Epoch=405.2] | Loss=0.00011 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.584 | L2-Norm(final)=15.948 | 6585.2 samples/s | 102.9 steps/s
[Step=42650 Epoch=405.7] | Loss=0.00007 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.582 | L2-Norm(final)=15.949 | 2388.8 samples/s | 37.3 steps/s
[Step=42700 Epoch=406.2] | Loss=0.00006 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.579 | L2-Norm(final)=15.950 | 5909.0 samples/s | 92.3 steps/s
[Step=42750 Epoch=406.7] | Loss=0.00005 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.574 | L2-Norm(final)=15.950 | 2471.4 samples/s | 38.6 steps/s
[Step=42800 Epoch=407.1] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.570 | L2-Norm(final)=15.951 | 5447.0 samples/s | 85.1 steps/s
[Step=42850 Epoch=407.6] | Loss=0.00004 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.565 | L2-Norm(final)=15.951 | 2566.5 samples/s | 40.1 steps/s
[Step=42900 Epoch=408.1] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.560 | L2-Norm(final)=15.951 | 5009.3 samples/s | 78.3 steps/s
[Step=42950 Epoch=408.6] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.555 | L2-Norm(final)=15.952 | 2674.6 samples/s | 41.8 steps/s
[Step=43000 Epoch=409.0] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.550 | L2-Norm(final)=15.952 | 4600.5 samples/s | 71.9 steps/s
[Step=43050 Epoch=409.5] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.545 | L2-Norm(final)=15.952 | 2788.5 samples/s | 43.6 steps/s
[Step=43100 Epoch=410.0] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=15.952 | 4536.3 samples/s | 70.9 steps/s
[Step=43150 Epoch=410.5] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.534 | L2-Norm(final)=15.953 | 2833.0 samples/s | 44.3 steps/s
[Step=43200 Epoch=410.9] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.528 | L2-Norm(final)=15.953 | 4472.9 samples/s | 69.9 steps/s
[Step=43250 Epoch=411.4] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.522 | L2-Norm(final)=15.953 | 2836.2 samples/s | 44.3 steps/s
[Step=43300 Epoch=411.9] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.517 | L2-Norm(final)=15.953 | 4609.6 samples/s | 72.0 steps/s
[Step=43350 Epoch=412.4] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.511 | L2-Norm(final)=15.954 | 2902.2 samples/s | 45.3 steps/s
[Step=43400 Epoch=412.8] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.505 | L2-Norm(final)=15.954 | 4387.4 samples/s | 68.6 steps/s
[Step=43450 Epoch=413.3] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.499 | L2-Norm(final)=15.954 | 6642.7 samples/s | 103.8 steps/s
[Step=43500 Epoch=413.8] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.493 | L2-Norm(final)=15.954 | 2321.7 samples/s | 36.3 steps/s
[Step=43550 Epoch=414.3] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.486 | L2-Norm(final)=15.954 | 6165.1 samples/s | 96.3 steps/s
[Step=43600 Epoch=414.7] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.480 | L2-Norm(final)=15.955 | 2457.4 samples/s | 38.4 steps/s
[Step=43650 Epoch=415.2] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.474 | L2-Norm(final)=15.955 | 5476.7 samples/s | 85.6 steps/s
[Step=43700 Epoch=415.7] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.467 | L2-Norm(final)=15.955 | 2543.8 samples/s | 39.7 steps/s
[Step=43750 Epoch=416.2] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.461 | L2-Norm(final)=15.955 | 5047.5 samples/s | 78.9 steps/s
[Step=43800 Epoch=416.6] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.454 | L2-Norm(final)=15.956 | 2646.8 samples/s | 41.4 steps/s
[Step=43850 Epoch=417.1] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.448 | L2-Norm(final)=15.956 | 4697.3 samples/s | 73.4 steps/s
[Step=43900 Epoch=417.6] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.441 | L2-Norm(final)=15.956 | 2750.2 samples/s | 43.0 steps/s
[Step=43950 Epoch=418.1] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.434 | L2-Norm(final)=15.956 | 4503.7 samples/s | 70.4 steps/s
[Step=44000 Epoch=418.5] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.427 | L2-Norm(final)=15.956 | 2839.9 samples/s | 44.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_1/client_state-step44000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=40001 Epoch=382.0] | Loss=0.00013 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=14.885 | 6500.9 samples/s | 101.6 steps/s
[Step=40050 Epoch=382.5] | Loss=0.00023 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=14.889 | 4781.2 samples/s | 74.7 steps/s
[Step=40100 Epoch=382.9] | Loss=0.00023 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=14.892 | 8024.2 samples/s | 125.4 steps/s
[Step=40150 Epoch=383.4] | Loss=0.00023 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=14.899 | 2527.9 samples/s | 39.5 steps/s
[Step=40200 Epoch=383.9] | Loss=0.00024 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=14.905 | 7564.3 samples/s | 118.2 steps/s
[Step=40250 Epoch=384.4] | Loss=0.00024 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=14.911 | 2653.8 samples/s | 41.5 steps/s
[Step=40300 Epoch=384.8] | Loss=0.00023 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=14.916 | 6633.7 samples/s | 103.7 steps/s
[Step=40350 Epoch=385.3] | Loss=0.00024 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=14.921 | 2721.4 samples/s | 42.5 steps/s
[Step=40400 Epoch=385.8] | Loss=0.00023 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=14.926 | 6210.9 samples/s | 97.0 steps/s
[Step=40450 Epoch=386.3] | Loss=0.00024 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.575 | L2-Norm(final)=14.931 | 2816.8 samples/s | 44.0 steps/s
[Step=40500 Epoch=386.8] | Loss=0.00023 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.575 | L2-Norm(final)=14.936 | 5769.9 samples/s | 90.2 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=386.8] | Loss=0.00075 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.575 | L2-Norm(final)=14.982 | 6692.0 samples/s | 104.6 steps/s
[Step=40550 Epoch=387.2] | Loss=0.00009 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.580 | L2-Norm(final)=14.985 | 4203.3 samples/s | 65.7 steps/s
[Step=40600 Epoch=387.7] | Loss=0.00007 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=14.986 | 6690.2 samples/s | 104.5 steps/s
[Step=40650 Epoch=388.2] | Loss=0.00005 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.573 | L2-Norm(final)=14.987 | 2353.7 samples/s | 36.8 steps/s
[Step=40700 Epoch=388.7] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.568 | L2-Norm(final)=14.988 | 6151.8 samples/s | 96.1 steps/s
[Step=40750 Epoch=389.1] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.561 | L2-Norm(final)=14.988 | 2427.0 samples/s | 37.9 steps/s
[Step=40800 Epoch=389.6] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.555 | L2-Norm(final)=14.989 | 5606.0 samples/s | 87.6 steps/s
[Step=40850 Epoch=390.1] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.549 | L2-Norm(final)=14.989 | 2519.3 samples/s | 39.4 steps/s
[Step=40900 Epoch=390.6] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.542 | L2-Norm(final)=14.989 | 5202.6 samples/s | 81.3 steps/s
[Step=40950 Epoch=391.0] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.535 | L2-Norm(final)=14.989 | 2627.5 samples/s | 41.1 steps/s
[Step=41000 Epoch=391.5] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.528 | L2-Norm(final)=14.990 | 4798.5 samples/s | 75.0 steps/s
[Step=41050 Epoch=392.0] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.521 | L2-Norm(final)=14.990 | 2700.1 samples/s | 42.2 steps/s
[Step=41100 Epoch=392.5] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=14.990 | 4568.4 samples/s | 71.4 steps/s
[Step=41150 Epoch=393.0] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.507 | L2-Norm(final)=14.990 | 2751.3 samples/s | 43.0 steps/s
[Step=41200 Epoch=393.4] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.500 | L2-Norm(final)=14.990 | 4545.2 samples/s | 71.0 steps/s
[Step=41250 Epoch=393.9] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.492 | L2-Norm(final)=14.990 | 2804.2 samples/s | 43.8 steps/s
[Step=41300 Epoch=394.4] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.485 | L2-Norm(final)=14.991 | 4553.0 samples/s | 71.1 steps/s
[Step=41350 Epoch=394.9] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.478 | L2-Norm(final)=14.991 | 2816.6 samples/s | 44.0 steps/s
[Step=41400 Epoch=395.3] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.470 | L2-Norm(final)=14.991 | 4505.4 samples/s | 70.4 steps/s
[Step=41450 Epoch=395.8] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.462 | L2-Norm(final)=14.991 | 2851.9 samples/s | 44.6 steps/s
[Step=41500 Epoch=396.3] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.455 | L2-Norm(final)=14.991 | 4423.1 samples/s | 69.1 steps/s
[Step=41550 Epoch=396.8] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.447 | L2-Norm(final)=14.991 | 7306.3 samples/s | 114.2 steps/s
[Step=41600 Epoch=397.3] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.439 | L2-Norm(final)=14.992 | 2309.9 samples/s | 36.1 steps/s
[Step=41650 Epoch=397.7] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.431 | L2-Norm(final)=14.992 | 6459.4 samples/s | 100.9 steps/s
[Step=41700 Epoch=398.2] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.424 | L2-Norm(final)=14.992 | 2341.1 samples/s | 36.6 steps/s
[Step=41750 Epoch=398.7] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.416 | L2-Norm(final)=14.992 | 6179.4 samples/s | 96.6 steps/s
[Step=41800 Epoch=399.2] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.407 | L2-Norm(final)=14.992 | 2423.8 samples/s | 37.9 steps/s
[Step=41850 Epoch=399.6] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.399 | L2-Norm(final)=14.993 | 5662.9 samples/s | 88.5 steps/s
[Step=41900 Epoch=400.1] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.391 | L2-Norm(final)=14.993 | 2519.6 samples/s | 39.4 steps/s
[Step=41950 Epoch=400.6] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.383 | L2-Norm(final)=14.993 | 5143.5 samples/s | 80.4 steps/s
[Step=42000 Epoch=401.1] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.374 | L2-Norm(final)=14.993 | 2606.9 samples/s | 40.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step42000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=48001 Epoch=452.3] | Loss=0.00119 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=16.297 | 6946.9 samples/s | 108.5 steps/s
[Step=48050 Epoch=452.8] | Loss=0.00040 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=16.300 | 4584.5 samples/s | 71.6 steps/s
[Step=48100 Epoch=453.2] | Loss=0.00047 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=16.305 | 7929.6 samples/s | 123.9 steps/s
[Step=48150 Epoch=453.7] | Loss=0.00042 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=16.311 | 2590.8 samples/s | 40.5 steps/s
[Step=48200 Epoch=454.2] | Loss=0.00043 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=16.315 | 6794.6 samples/s | 106.2 steps/s
[Step=48250 Epoch=454.7] | Loss=0.00044 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=16.320 | 2718.8 samples/s | 42.5 steps/s
[Step=48300 Epoch=455.1] | Loss=0.00045 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=16.324 | 6156.1 samples/s | 96.2 steps/s
[Step=48350 Epoch=455.6] | Loss=0.00047 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=16.329 | 2835.4 samples/s | 44.3 steps/s
[Step=48400 Epoch=456.1] | Loss=0.00046 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=16.333 | 5549.4 samples/s | 86.7 steps/s
[Step=48450 Epoch=456.5] | Loss=0.00044 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=16.337 | 2916.7 samples/s | 45.6 steps/s
[Step=48500 Epoch=457.0] | Loss=0.00046 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=16.341 | 5163.1 samples/s | 80.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=48501 Epoch=457.0] | Loss=0.00135 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=16.378 | 6707.3 samples/s | 104.8 steps/s
[Step=48550 Epoch=457.5] | Loss=0.00084 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.584 | L2-Norm(final)=16.381 | 4110.6 samples/s | 64.2 steps/s
[Step=48600 Epoch=458.0] | Loss=0.00044 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=16.382 | 6450.7 samples/s | 100.8 steps/s
[Step=48650 Epoch=458.4] | Loss=0.00030 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=16.383 | 2374.2 samples/s | 37.1 steps/s
[Step=48700 Epoch=458.9] | Loss=0.00023 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=16.383 | 5825.5 samples/s | 91.0 steps/s
[Step=48750 Epoch=459.4] | Loss=0.00019 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.592 | L2-Norm(final)=16.383 | 2481.2 samples/s | 38.8 steps/s
[Step=48800 Epoch=459.8] | Loss=0.00016 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.590 | L2-Norm(final)=16.384 | 5232.0 samples/s | 81.8 steps/s
[Step=48850 Epoch=460.3] | Loss=0.00014 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.589 | L2-Norm(final)=16.384 | 2655.8 samples/s | 41.5 steps/s
[Step=48900 Epoch=460.8] | Loss=0.00012 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.587 | L2-Norm(final)=16.384 | 4618.3 samples/s | 72.2 steps/s
[Step=48950 Epoch=461.2] | Loss=0.00011 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.586 | L2-Norm(final)=16.384 | 2735.7 samples/s | 42.7 steps/s
[Step=49000 Epoch=461.7] | Loss=0.00010 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.584 | L2-Norm(final)=16.385 | 4490.1 samples/s | 70.2 steps/s
[Step=49050 Epoch=462.2] | Loss=0.00009 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.582 | L2-Norm(final)=16.385 | 2839.1 samples/s | 44.4 steps/s
[Step=49100 Epoch=462.7] | Loss=0.00008 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.580 | L2-Norm(final)=16.385 | 4504.9 samples/s | 70.4 steps/s
[Step=49150 Epoch=463.1] | Loss=0.00008 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.579 | L2-Norm(final)=16.385 | 2853.5 samples/s | 44.6 steps/s
[Step=49200 Epoch=463.6] | Loss=0.00007 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=16.385 | 4477.1 samples/s | 70.0 steps/s
[Step=49250 Epoch=464.1] | Loss=0.00007 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.575 | L2-Norm(final)=16.386 | 3148.6 samples/s | 49.2 steps/s
[Step=49300 Epoch=464.5] | Loss=0.00006 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.573 | L2-Norm(final)=16.386 | 3961.2 samples/s | 61.9 steps/s
[Step=49350 Epoch=465.0] | Loss=0.00006 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.571 | L2-Norm(final)=16.386 | 6540.9 samples/s | 102.2 steps/s
[Step=49400 Epoch=465.5] | Loss=0.00006 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.569 | L2-Norm(final)=16.386 | 2387.2 samples/s | 37.3 steps/s
[Step=49450 Epoch=466.0] | Loss=0.00005 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.567 | L2-Norm(final)=16.386 | 5794.8 samples/s | 90.5 steps/s
[Step=49500 Epoch=466.4] | Loss=0.00005 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.564 | L2-Norm(final)=16.387 | 2488.6 samples/s | 38.9 steps/s
[Step=49550 Epoch=466.9] | Loss=0.00005 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.562 | L2-Norm(final)=16.387 | 5304.9 samples/s | 82.9 steps/s
[Step=49600 Epoch=467.4] | Loss=0.00005 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.560 | L2-Norm(final)=16.387 | 2609.9 samples/s | 40.8 steps/s
[Step=49650 Epoch=467.8] | Loss=0.00005 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.558 | L2-Norm(final)=16.387 | 4750.8 samples/s | 74.2 steps/s
[Step=49700 Epoch=468.3] | Loss=0.00004 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.556 | L2-Norm(final)=16.387 | 2722.0 samples/s | 42.5 steps/s
[Step=49750 Epoch=468.8] | Loss=0.00004 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.553 | L2-Norm(final)=16.387 | 4480.6 samples/s | 70.0 steps/s
[Step=49800 Epoch=469.3] | Loss=0.00004 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.551 | L2-Norm(final)=16.388 | 2901.0 samples/s | 45.3 steps/s
[Step=49850 Epoch=469.7] | Loss=0.00004 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.549 | L2-Norm(final)=16.388 | 4398.8 samples/s | 68.7 steps/s
[Step=49900 Epoch=470.2] | Loss=0.00004 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.546 | L2-Norm(final)=16.388 | 2882.7 samples/s | 45.0 steps/s
[Step=49950 Epoch=470.7] | Loss=0.00004 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.544 | L2-Norm(final)=16.388 | 4411.4 samples/s | 68.9 steps/s
[Step=50000 Epoch=471.1] | Loss=0.00004 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.542 | L2-Norm(final)=16.388 | 2941.0 samples/s | 46.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_3/client_state-step50000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07905 | acc=0.9648 | tpr=0.9775 | fpr=0.0627 | 5672.1 samples/s | 22.2 steps/s
Avg test loss: 0.08339, Avg test acc: 0.96254, Avg tpr: 0.97622, Avg fpr: 0.06756, total FA: 527

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08578 | acc=0.9627 | tpr=0.9722 | fpr=0.0577 | 5977.8 samples/s | 23.4 steps/s
Avg test loss: 0.09053, Avg test acc: 0.96105, Avg tpr: 0.96923, Avg fpr: 0.05692, total FA: 444

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08528 | acc=0.9635 | tpr=0.9742 | fpr=0.0597 | 6046.8 samples/s | 23.6 steps/s
Avg test loss: 0.08920, Avg test acc: 0.96129, Avg tpr: 0.97103, Avg fpr: 0.06012, total FA: 469

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08462 | acc=0.9634 | tpr=0.9815 | fpr=0.0758 | 5914.1 samples/s | 23.1 steps/s
Avg test loss: 0.08868, Avg test acc: 0.96266, Avg tpr: 0.98036, Avg fpr: 0.07627, total FA: 595

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08369 | acc=0.9620 | tpr=0.9777 | fpr=0.0723 | 5993.1 samples/s | 23.4 steps/s
Avg test loss: 0.08668, Avg test acc: 0.96170, Avg tpr: 0.97628, Avg fpr: 0.07038, total FA: 549

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.16973 | acc=0.2797 | tpr=0.0203 | fpr=0.1571 | 5795.1 samples/s | 22.6 steps/s
Avg test loss: 6.17438, Avg test acc: 0.27879, Avg tpr: 0.01970, Avg fpr: 0.15139, total FA: 1181

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.66509 | acc=0.3106 | tpr=0.0259 | fpr=0.0711 | 6053.5 samples/s | 23.6 steps/s
Avg test loss: 4.67431, Avg test acc: 0.30800, Avg tpr: 0.02547, Avg fpr: 0.07063, total FA: 551

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.85183 | acc=0.3001 | tpr=0.0240 | fpr=0.1003 | 5746.4 samples/s | 22.4 steps/s
Avg test loss: 4.85816, Avg test acc: 0.29878, Avg tpr: 0.02349, Avg fpr: 0.09576, total FA: 747

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.20279 | acc=0.2759 | tpr=0.0249 | fpr=0.1791 | 6213.9 samples/s | 24.3 steps/s
Avg test loss: 5.20459, Avg test acc: 0.27578, Avg tpr: 0.02448, Avg fpr: 0.17152, total FA: 1338

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.90266 | acc=0.2911 | tpr=0.0189 | fpr=0.1179 | 6014.0 samples/s | 23.5 steps/s
Avg test loss: 4.91703, Avg test acc: 0.29033, Avg tpr: 0.01883, Avg fpr: 0.11255, total FA: 878

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.27028 | acc=0.1180 | tpr=0.6504 | fpr=0.8916 | 5880.5 samples/s | 23.0 steps/s
[Step= 100] | Loss=5.25690 | acc=0.1187 | tpr=0.6311 | fpr=0.8908 | 7451.0 samples/s | 29.1 steps/s
[Step= 150] | Loss=5.24645 | acc=0.1206 | tpr=0.6441 | fpr=0.8891 | 7944.0 samples/s | 31.0 steps/s
[Step= 200] | Loss=5.23550 | acc=0.1211 | tpr=0.6393 | fpr=0.8883 | 7837.5 samples/s | 30.6 steps/s
[Step= 250] | Loss=5.24255 | acc=0.1209 | tpr=0.6332 | fpr=0.8884 | 8062.9 samples/s | 31.5 steps/s
[Step= 300] | Loss=5.23644 | acc=0.1206 | tpr=0.6262 | fpr=0.8886 | 8474.2 samples/s | 33.1 steps/s
[Step= 350] | Loss=5.24124 | acc=0.1208 | tpr=0.6218 | fpr=0.8883 | 7502.3 samples/s | 29.3 steps/s
[Step= 400] | Loss=5.23873 | acc=0.1211 | tpr=0.6204 | fpr=0.8880 | 8316.8 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.24422 | acc=0.1208 | tpr=0.6232 | fpr=0.8884 | 8386.0 samples/s | 32.8 steps/s
[Step= 500] | Loss=5.24439 | acc=0.1207 | tpr=0.6286 | fpr=0.8885 | 7259.9 samples/s | 28.4 steps/s
[Step= 550] | Loss=5.24716 | acc=0.1207 | tpr=0.6299 | fpr=0.8885 | 11835.6 samples/s | 46.2 steps/s
Avg test loss: 5.24747, Avg test acc: 0.12063, Avg tpr: 0.63074, Avg fpr: 0.88864, total FA: 123386

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.84296 | acc=0.1377 | tpr=0.5531 | fpr=0.8698 | 6053.8 samples/s | 23.6 steps/s
[Step= 100] | Loss=4.83423 | acc=0.1421 | tpr=0.5629 | fpr=0.8658 | 7593.6 samples/s | 29.7 steps/s
[Step= 150] | Loss=4.82255 | acc=0.1448 | tpr=0.5879 | fpr=0.8633 | 7613.3 samples/s | 29.7 steps/s
[Step= 200] | Loss=4.81299 | acc=0.1453 | tpr=0.5814 | fpr=0.8627 | 8507.3 samples/s | 33.2 steps/s
[Step= 250] | Loss=4.81742 | acc=0.1449 | tpr=0.5729 | fpr=0.8629 | 7325.4 samples/s | 28.6 steps/s
[Step= 300] | Loss=4.81346 | acc=0.1445 | tpr=0.5636 | fpr=0.8631 | 8787.3 samples/s | 34.3 steps/s
[Step= 350] | Loss=4.81825 | acc=0.1441 | tpr=0.5585 | fpr=0.8635 | 7989.7 samples/s | 31.2 steps/s
[Step= 400] | Loss=4.81591 | acc=0.1444 | tpr=0.5585 | fpr=0.8632 | 7661.5 samples/s | 29.9 steps/s
[Step= 450] | Loss=4.81958 | acc=0.1439 | tpr=0.5657 | fpr=0.8638 | 8802.9 samples/s | 34.4 steps/s
[Step= 500] | Loss=4.82073 | acc=0.1437 | tpr=0.5687 | fpr=0.8640 | 7830.9 samples/s | 30.6 steps/s
[Step= 550] | Loss=4.82464 | acc=0.1439 | tpr=0.5702 | fpr=0.8638 | 9828.3 samples/s | 38.4 steps/s
Avg test loss: 4.82498, Avg test acc: 0.14385, Avg tpr: 0.57092, Avg fpr: 0.86392, total FA: 119953

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.12202 | acc=0.1241 | tpr=0.5708 | fpr=0.8840 | 5888.4 samples/s | 23.0 steps/s
[Step= 100] | Loss=5.10821 | acc=0.1264 | tpr=0.5778 | fpr=0.8820 | 7549.5 samples/s | 29.5 steps/s
[Step= 150] | Loss=5.09892 | acc=0.1288 | tpr=0.5893 | fpr=0.8796 | 8797.2 samples/s | 34.4 steps/s
[Step= 200] | Loss=5.08957 | acc=0.1294 | tpr=0.5836 | fpr=0.8788 | 8023.9 samples/s | 31.3 steps/s
[Step= 250] | Loss=5.09588 | acc=0.1295 | tpr=0.5825 | fpr=0.8787 | 8122.9 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.09195 | acc=0.1294 | tpr=0.5804 | fpr=0.8788 | 7828.9 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.09689 | acc=0.1294 | tpr=0.5792 | fpr=0.8787 | 8095.7 samples/s | 31.6 steps/s
[Step= 400] | Loss=5.09603 | acc=0.1296 | tpr=0.5799 | fpr=0.8786 | 7418.9 samples/s | 29.0 steps/s
[Step= 450] | Loss=5.10098 | acc=0.1289 | tpr=0.5808 | fpr=0.8793 | 8582.1 samples/s | 33.5 steps/s
[Step= 500] | Loss=5.10015 | acc=0.1287 | tpr=0.5811 | fpr=0.8795 | 7617.4 samples/s | 29.8 steps/s
[Step= 550] | Loss=5.10318 | acc=0.1288 | tpr=0.5794 | fpr=0.8794 | 9845.2 samples/s | 38.5 steps/s
Avg test loss: 5.10361, Avg test acc: 0.12867, Avg tpr: 0.58043, Avg fpr: 0.87954, total FA: 122122

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.23383 | acc=0.1218 | tpr=0.6903 | fpr=0.8884 | 5939.9 samples/s | 23.2 steps/s
[Step= 100] | Loss=5.22284 | acc=0.1246 | tpr=0.6716 | fpr=0.8856 | 7837.4 samples/s | 30.6 steps/s
[Step= 150] | Loss=5.21154 | acc=0.1264 | tpr=0.6787 | fpr=0.8837 | 7641.6 samples/s | 29.8 steps/s
[Step= 200] | Loss=5.20142 | acc=0.1273 | tpr=0.6765 | fpr=0.8827 | 7901.3 samples/s | 30.9 steps/s
[Step= 250] | Loss=5.20556 | acc=0.1268 | tpr=0.6655 | fpr=0.8830 | 8393.9 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.20183 | acc=0.1264 | tpr=0.6640 | fpr=0.8834 | 8041.9 samples/s | 31.4 steps/s
[Step= 350] | Loss=5.20728 | acc=0.1262 | tpr=0.6644 | fpr=0.8836 | 8301.4 samples/s | 32.4 steps/s
[Step= 400] | Loss=5.20582 | acc=0.1264 | tpr=0.6630 | fpr=0.8834 | 7148.9 samples/s | 27.9 steps/s
[Step= 450] | Loss=5.21097 | acc=0.1256 | tpr=0.6665 | fpr=0.8842 | 8408.8 samples/s | 32.8 steps/s
[Step= 500] | Loss=5.21076 | acc=0.1256 | tpr=0.6714 | fpr=0.8843 | 8580.1 samples/s | 33.5 steps/s
[Step= 550] | Loss=5.21490 | acc=0.1256 | tpr=0.6741 | fpr=0.8843 | 9840.0 samples/s | 38.4 steps/s
Avg test loss: 5.21540, Avg test acc: 0.12556, Avg tpr: 0.67512, Avg fpr: 0.88443, total FA: 122801

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.09137 | acc=0.1245 | tpr=0.5310 | fpr=0.8828 | 6068.7 samples/s | 23.7 steps/s
[Step= 100] | Loss=5.08096 | acc=0.1269 | tpr=0.5203 | fpr=0.8804 | 7371.4 samples/s | 28.8 steps/s
[Step= 150] | Loss=5.06988 | acc=0.1292 | tpr=0.5403 | fpr=0.8783 | 8054.3 samples/s | 31.5 steps/s
[Step= 200] | Loss=5.06236 | acc=0.1304 | tpr=0.5344 | fpr=0.8769 | 8028.3 samples/s | 31.4 steps/s
[Step= 250] | Loss=5.06729 | acc=0.1301 | tpr=0.5188 | fpr=0.8770 | 7763.2 samples/s | 30.3 steps/s
[Step= 300] | Loss=5.06417 | acc=0.1297 | tpr=0.5091 | fpr=0.8772 | 8254.1 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.06978 | acc=0.1298 | tpr=0.5091 | fpr=0.8771 | 8201.4 samples/s | 32.0 steps/s
[Step= 400] | Loss=5.06675 | acc=0.1299 | tpr=0.5104 | fpr=0.8770 | 7959.3 samples/s | 31.1 steps/s
[Step= 450] | Loss=5.07121 | acc=0.1293 | tpr=0.5146 | fpr=0.8777 | 7701.7 samples/s | 30.1 steps/s
[Step= 500] | Loss=5.07089 | acc=0.1292 | tpr=0.5159 | fpr=0.8778 | 7452.2 samples/s | 29.1 steps/s
[Step= 550] | Loss=5.07324 | acc=0.1292 | tpr=0.5145 | fpr=0.8778 | 11878.3 samples/s | 46.4 steps/s
Avg test loss: 5.07381, Avg test acc: 0.12913, Avg tpr: 0.51506, Avg fpr: 0.87788, total FA: 121892

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.22570 | acc=0.9580 | tpr=0.9513 | fpr=0.0418 | 6184.2 samples/s | 24.2 steps/s
[Step= 100] | Loss=0.23417 | acc=0.9574 | tpr=0.9595 | fpr=0.0426 | 7287.5 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.23649 | acc=0.9559 | tpr=0.9568 | fpr=0.0442 | 7410.6 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.23671 | acc=0.9559 | tpr=0.9607 | fpr=0.0442 | 7901.8 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.23701 | acc=0.9557 | tpr=0.9581 | fpr=0.0443 | 7806.8 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.24060 | acc=0.9554 | tpr=0.9564 | fpr=0.0446 | 8264.0 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.23867 | acc=0.9556 | tpr=0.9555 | fpr=0.0444 | 8128.0 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.23846 | acc=0.9553 | tpr=0.9535 | fpr=0.0446 | 7891.8 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.24193 | acc=0.9549 | tpr=0.9523 | fpr=0.0450 | 7965.9 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.24242 | acc=0.9548 | tpr=0.9533 | fpr=0.0452 | 7918.3 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.24116 | acc=0.9550 | tpr=0.9538 | fpr=0.0450 | 11520.1 samples/s | 45.0 steps/s
Avg test loss: 0.24085, Avg test acc: 0.95503, Avg tpr: 0.95365, Avg fpr: 0.04494, total FA: 6240

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16702 | acc=0.9615 | tpr=0.9204 | fpr=0.0378 | 6028.1 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.17437 | acc=0.9605 | tpr=0.9275 | fpr=0.0389 | 7146.7 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.17684 | acc=0.9591 | tpr=0.9323 | fpr=0.0404 | 7974.1 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.17725 | acc=0.9592 | tpr=0.9355 | fpr=0.0404 | 8195.7 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.17675 | acc=0.9593 | tpr=0.9362 | fpr=0.0403 | 7535.5 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.17948 | acc=0.9589 | tpr=0.9331 | fpr=0.0407 | 8354.9 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.17804 | acc=0.9590 | tpr=0.9336 | fpr=0.0406 | 8460.2 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.17840 | acc=0.9588 | tpr=0.9311 | fpr=0.0407 | 7643.3 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.18104 | acc=0.9584 | tpr=0.9309 | fpr=0.0411 | 8424.1 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.18071 | acc=0.9584 | tpr=0.9330 | fpr=0.0412 | 8248.6 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.17970 | acc=0.9586 | tpr=0.9347 | fpr=0.0410 | 10394.1 samples/s | 40.6 steps/s
Avg test loss: 0.17949, Avg test acc: 0.95861, Avg tpr: 0.93463, Avg fpr: 0.04095, total FA: 5686

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.25152 | acc=0.9504 | tpr=0.9558 | fpr=0.0497 | 5811.7 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.26005 | acc=0.9496 | tpr=0.9638 | fpr=0.0506 | 7743.7 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.26442 | acc=0.9485 | tpr=0.9640 | fpr=0.0517 | 8043.0 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.26459 | acc=0.9487 | tpr=0.9661 | fpr=0.0516 | 8402.4 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.26456 | acc=0.9486 | tpr=0.9659 | fpr=0.0517 | 8034.6 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.26747 | acc=0.9484 | tpr=0.9629 | fpr=0.0519 | 7894.1 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.26559 | acc=0.9485 | tpr=0.9618 | fpr=0.0517 | 8419.3 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.26582 | acc=0.9481 | tpr=0.9601 | fpr=0.0521 | 8005.4 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.26914 | acc=0.9477 | tpr=0.9591 | fpr=0.0525 | 8121.1 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.26943 | acc=0.9476 | tpr=0.9595 | fpr=0.0526 | 7745.9 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.26784 | acc=0.9479 | tpr=0.9598 | fpr=0.0523 | 9431.3 samples/s | 36.8 steps/s
Avg test loss: 0.26763, Avg test acc: 0.94790, Avg tpr: 0.95959, Avg fpr: 0.05231, total FA: 7263

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15832 | acc=0.9649 | tpr=0.9425 | fpr=0.0347 | 5965.4 samples/s | 23.3 steps/s
[Step= 100] | Loss=0.16525 | acc=0.9635 | tpr=0.9446 | fpr=0.0362 | 7529.8 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.16670 | acc=0.9615 | tpr=0.9380 | fpr=0.0381 | 7806.5 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.16657 | acc=0.9615 | tpr=0.9421 | fpr=0.0381 | 8144.7 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.16649 | acc=0.9614 | tpr=0.9406 | fpr=0.0382 | 8238.3 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.16928 | acc=0.9611 | tpr=0.9418 | fpr=0.0385 | 7733.1 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.16784 | acc=0.9611 | tpr=0.9399 | fpr=0.0385 | 8389.9 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.16740 | acc=0.9609 | tpr=0.9371 | fpr=0.0387 | 7397.9 samples/s | 28.9 steps/s
[Step= 450] | Loss=0.16978 | acc=0.9605 | tpr=0.9372 | fpr=0.0391 | 8153.1 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.17000 | acc=0.9604 | tpr=0.9392 | fpr=0.0392 | 8099.1 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.16894 | acc=0.9607 | tpr=0.9399 | fpr=0.0390 | 10536.4 samples/s | 41.2 steps/s
Avg test loss: 0.16869, Avg test acc: 0.96066, Avg tpr: 0.93978, Avg fpr: 0.03896, total FA: 5410

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21562 | acc=0.9586 | tpr=0.9513 | fpr=0.0413 | 6006.5 samples/s | 23.5 steps/s
[Step= 100] | Loss=0.22490 | acc=0.9569 | tpr=0.9574 | fpr=0.0431 | 7555.6 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.22815 | acc=0.9553 | tpr=0.9582 | fpr=0.0447 | 7670.4 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.22815 | acc=0.9552 | tpr=0.9596 | fpr=0.0449 | 7845.1 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.22848 | acc=0.9551 | tpr=0.9590 | fpr=0.0450 | 7851.2 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.23213 | acc=0.9546 | tpr=0.9549 | fpr=0.0454 | 8193.1 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.23079 | acc=0.9546 | tpr=0.9549 | fpr=0.0454 | 8214.8 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.23106 | acc=0.9542 | tpr=0.9513 | fpr=0.0457 | 8128.4 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.23452 | acc=0.9537 | tpr=0.9508 | fpr=0.0462 | 7836.2 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.23454 | acc=0.9536 | tpr=0.9502 | fpr=0.0463 | 7636.1 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.23306 | acc=0.9539 | tpr=0.9507 | fpr=0.0460 | 11695.2 samples/s | 45.7 steps/s
Avg test loss: 0.23287, Avg test acc: 0.95393, Avg tpr: 0.95048, Avg fpr: 0.04601, total FA: 6388

server round 47/50

clients selected: [1 2 4 7 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=54001 Epoch=263.5] | Loss=0.01743 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.487 | L2-Norm(final)=15.863 | 6957.4 samples/s | 108.7 steps/s
[Step=54050 Epoch=263.7] | Loss=0.01786 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=15.866 | 5075.7 samples/s | 79.3 steps/s
[Step=54100 Epoch=264.0] | Loss=0.01724 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=15.870 | 5483.2 samples/s | 85.7 steps/s
[Step=54150 Epoch=264.2] | Loss=0.01671 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=15.875 | 5543.8 samples/s | 86.6 steps/s
[Step=54200 Epoch=264.5] | Loss=0.01674 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=15.879 | 8417.2 samples/s | 131.5 steps/s
[Step=54250 Epoch=264.7] | Loss=0.01646 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=15.884 | 2650.9 samples/s | 41.4 steps/s
[Step=54300 Epoch=265.0] | Loss=0.01709 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.488 | L2-Norm(final)=15.888 | 5580.1 samples/s | 87.2 steps/s
[Step=54350 Epoch=265.2] | Loss=0.01672 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.488 | L2-Norm(final)=15.892 | 5535.0 samples/s | 86.5 steps/s
[Step=54400 Epoch=265.4] | Loss=0.01638 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=15.895 | 7639.6 samples/s | 119.4 steps/s
[Step=54450 Epoch=265.7] | Loss=0.01643 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.488 | L2-Norm(final)=15.899 | 2716.9 samples/s | 42.5 steps/s
[Step=54500 Epoch=265.9] | Loss=0.01619 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.488 | L2-Norm(final)=15.902 | 5536.8 samples/s | 86.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=54501 Epoch=265.9] | Loss=0.00814 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.488 | L2-Norm(final)=15.933 | 7132.0 samples/s | 111.4 steps/s
[Step=54550 Epoch=266.2] | Loss=0.01574 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.495 | L2-Norm(final)=15.934 | 4230.6 samples/s | 66.1 steps/s
[Step=54600 Epoch=266.4] | Loss=0.01487 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.503 | L2-Norm(final)=15.935 | 4823.2 samples/s | 75.4 steps/s
[Step=54650 Epoch=266.7] | Loss=0.01445 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.511 | L2-Norm(final)=15.937 | 4664.7 samples/s | 72.9 steps/s
[Step=54700 Epoch=266.9] | Loss=0.01323 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.518 | L2-Norm(final)=15.939 | 6867.3 samples/s | 107.3 steps/s
[Step=54750 Epoch=267.2] | Loss=0.01164 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.523 | L2-Norm(final)=15.942 | 2437.3 samples/s | 38.1 steps/s
[Step=54800 Epoch=267.4] | Loss=0.01066 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.528 | L2-Norm(final)=15.945 | 4754.5 samples/s | 74.3 steps/s
[Step=54850 Epoch=267.6] | Loss=0.00992 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.533 | L2-Norm(final)=15.948 | 4816.8 samples/s | 75.3 steps/s
[Step=54900 Epoch=267.9] | Loss=0.00923 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.537 | L2-Norm(final)=15.950 | 5993.3 samples/s | 93.6 steps/s
[Step=54950 Epoch=268.1] | Loss=0.00864 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.541 | L2-Norm(final)=15.953 | 2528.9 samples/s | 39.5 steps/s
[Step=55000 Epoch=268.4] | Loss=0.00820 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.545 | L2-Norm(final)=15.956 | 4718.1 samples/s | 73.7 steps/s
[Step=55050 Epoch=268.6] | Loss=0.00780 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.548 | L2-Norm(final)=15.959 | 4679.0 samples/s | 73.1 steps/s
[Step=55100 Epoch=268.9] | Loss=0.00749 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.551 | L2-Norm(final)=15.962 | 5820.6 samples/s | 90.9 steps/s
[Step=55150 Epoch=269.1] | Loss=0.00715 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.555 | L2-Norm(final)=15.965 | 2604.9 samples/s | 40.7 steps/s
[Step=55200 Epoch=269.4] | Loss=0.00692 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.558 | L2-Norm(final)=15.967 | 4760.3 samples/s | 74.4 steps/s
[Step=55250 Epoch=269.6] | Loss=0.00670 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.560 | L2-Norm(final)=15.970 | 4720.1 samples/s | 73.8 steps/s
[Step=55300 Epoch=269.8] | Loss=0.00647 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.563 | L2-Norm(final)=15.973 | 5482.4 samples/s | 85.7 steps/s
[Step=55350 Epoch=270.1] | Loss=0.00625 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.566 | L2-Norm(final)=15.975 | 2675.5 samples/s | 41.8 steps/s
[Step=55400 Epoch=270.3] | Loss=0.00611 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.569 | L2-Norm(final)=15.978 | 4789.7 samples/s | 74.8 steps/s
[Step=55450 Epoch=270.6] | Loss=0.00589 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.571 | L2-Norm(final)=15.980 | 4662.2 samples/s | 72.8 steps/s
[Step=55500 Epoch=270.8] | Loss=0.00571 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.574 | L2-Norm(final)=15.983 | 5116.1 samples/s | 79.9 steps/s
[Step=55550 Epoch=271.1] | Loss=0.00563 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=15.985 | 2791.9 samples/s | 43.6 steps/s
[Step=55600 Epoch=271.3] | Loss=0.00550 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.579 | L2-Norm(final)=15.987 | 4672.4 samples/s | 73.0 steps/s
[Step=55650 Epoch=271.5] | Loss=0.00540 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.581 | L2-Norm(final)=15.990 | 4722.3 samples/s | 73.8 steps/s
[Step=55700 Epoch=271.8] | Loss=0.00527 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.583 | L2-Norm(final)=15.992 | 4802.6 samples/s | 75.0 steps/s
[Step=55750 Epoch=272.0] | Loss=0.00516 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.585 | L2-Norm(final)=15.994 | 2867.7 samples/s | 44.8 steps/s
[Step=55800 Epoch=272.3] | Loss=0.00506 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.588 | L2-Norm(final)=15.997 | 4775.0 samples/s | 74.6 steps/s
[Step=55850 Epoch=272.5] | Loss=0.00495 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.590 | L2-Norm(final)=15.999 | 4670.6 samples/s | 73.0 steps/s
[Step=55900 Epoch=272.8] | Loss=0.00488 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.592 | L2-Norm(final)=16.001 | 4797.8 samples/s | 75.0 steps/s
[Step=55950 Epoch=273.0] | Loss=0.00482 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=16.003 | 2895.7 samples/s | 45.2 steps/s
[Step=56000 Epoch=273.3] | Loss=0.00475 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.596 | L2-Norm(final)=16.005 | 4713.3 samples/s | 73.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step56000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=46001 Epoch=224.1] | Loss=0.01259 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.487 | L2-Norm(final)=14.411 | 6467.8 samples/s | 101.1 steps/s
[Step=46050 Epoch=224.4] | Loss=0.01654 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.487 | L2-Norm(final)=14.417 | 4979.8 samples/s | 77.8 steps/s
[Step=46100 Epoch=224.6] | Loss=0.01770 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.487 | L2-Norm(final)=14.421 | 5568.2 samples/s | 87.0 steps/s
[Step=46150 Epoch=224.9] | Loss=0.01636 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.487 | L2-Norm(final)=14.427 | 5425.0 samples/s | 84.8 steps/s
[Step=46200 Epoch=225.1] | Loss=0.01721 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.488 | L2-Norm(final)=14.431 | 8663.5 samples/s | 135.4 steps/s
[Step=46250 Epoch=225.4] | Loss=0.01680 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=14.435 | 2631.3 samples/s | 41.1 steps/s
[Step=46300 Epoch=225.6] | Loss=0.01710 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=14.439 | 5536.0 samples/s | 86.5 steps/s
[Step=46350 Epoch=225.8] | Loss=0.01700 | Reg=0.00090 | acc=0.9531 | L2-Norm=9.488 | L2-Norm(final)=14.443 | 5499.2 samples/s | 85.9 steps/s
[Step=46400 Epoch=226.1] | Loss=0.01710 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.488 | L2-Norm(final)=14.447 | 7642.7 samples/s | 119.4 steps/s
[Step=46450 Epoch=226.3] | Loss=0.01728 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.488 | L2-Norm(final)=14.451 | 2762.3 samples/s | 43.2 steps/s
[Step=46500 Epoch=226.6] | Loss=0.01697 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.488 | L2-Norm(final)=14.454 | 5525.4 samples/s | 86.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=226.6] | Loss=0.00427 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=14.490 | 7090.8 samples/s | 110.8 steps/s
[Step=46550 Epoch=226.8] | Loss=0.01520 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.496 | L2-Norm(final)=14.493 | 4268.6 samples/s | 66.7 steps/s
[Step=46600 Epoch=227.1] | Loss=0.01556 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.505 | L2-Norm(final)=14.496 | 4652.9 samples/s | 72.7 steps/s
[Step=46650 Epoch=227.3] | Loss=0.01465 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.513 | L2-Norm(final)=14.499 | 4724.2 samples/s | 73.8 steps/s
[Step=46700 Epoch=227.5] | Loss=0.01345 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.519 | L2-Norm(final)=14.502 | 6882.5 samples/s | 107.5 steps/s
[Step=46750 Epoch=227.8] | Loss=0.01210 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.525 | L2-Norm(final)=14.506 | 2462.4 samples/s | 38.5 steps/s
[Step=46800 Epoch=228.0] | Loss=0.01106 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.531 | L2-Norm(final)=14.510 | 4714.6 samples/s | 73.7 steps/s
[Step=46850 Epoch=228.3] | Loss=0.01026 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=14.514 | 4721.8 samples/s | 73.8 steps/s
[Step=46900 Epoch=228.5] | Loss=0.00961 | Reg=0.00091 | acc=0.9688 | L2-Norm=9.541 | L2-Norm(final)=14.518 | 6158.8 samples/s | 96.2 steps/s
[Step=46950 Epoch=228.8] | Loss=0.00911 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.546 | L2-Norm(final)=14.522 | 2548.2 samples/s | 39.8 steps/s
[Step=47000 Epoch=229.0] | Loss=0.00869 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.550 | L2-Norm(final)=14.526 | 4693.1 samples/s | 73.3 steps/s
[Step=47050 Epoch=229.3] | Loss=0.00822 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.554 | L2-Norm(final)=14.529 | 4726.7 samples/s | 73.9 steps/s
[Step=47100 Epoch=229.5] | Loss=0.00792 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.559 | L2-Norm(final)=14.533 | 5652.8 samples/s | 88.3 steps/s
[Step=47150 Epoch=229.7] | Loss=0.00754 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.562 | L2-Norm(final)=14.537 | 2691.8 samples/s | 42.1 steps/s
[Step=47200 Epoch=230.0] | Loss=0.00726 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.566 | L2-Norm(final)=14.540 | 4638.1 samples/s | 72.5 steps/s
[Step=47250 Epoch=230.2] | Loss=0.00705 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.570 | L2-Norm(final)=14.543 | 4723.1 samples/s | 73.8 steps/s
[Step=47300 Epoch=230.5] | Loss=0.00682 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.573 | L2-Norm(final)=14.547 | 5228.4 samples/s | 81.7 steps/s
[Step=47350 Epoch=230.7] | Loss=0.00657 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=14.550 | 2780.7 samples/s | 43.4 steps/s
[Step=47400 Epoch=231.0] | Loss=0.00640 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.580 | L2-Norm(final)=14.554 | 4699.6 samples/s | 73.4 steps/s
[Step=47450 Epoch=231.2] | Loss=0.00619 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.583 | L2-Norm(final)=14.557 | 4770.3 samples/s | 74.5 steps/s
[Step=47500 Epoch=231.4] | Loss=0.00606 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.587 | L2-Norm(final)=14.560 | 4799.5 samples/s | 75.0 steps/s
[Step=47550 Epoch=231.7] | Loss=0.00593 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.590 | L2-Norm(final)=14.563 | 2880.5 samples/s | 45.0 steps/s
[Step=47600 Epoch=231.9] | Loss=0.00578 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=14.566 | 4712.7 samples/s | 73.6 steps/s
[Step=47650 Epoch=232.2] | Loss=0.00567 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.596 | L2-Norm(final)=14.569 | 4711.1 samples/s | 73.6 steps/s
[Step=47700 Epoch=232.4] | Loss=0.00559 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.598 | L2-Norm(final)=14.572 | 4733.4 samples/s | 74.0 steps/s
[Step=47750 Epoch=232.7] | Loss=0.00546 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.601 | L2-Norm(final)=14.575 | 2941.2 samples/s | 46.0 steps/s
[Step=47800 Epoch=232.9] | Loss=0.00535 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=14.578 | 4652.3 samples/s | 72.7 steps/s
[Step=47850 Epoch=233.1] | Loss=0.00527 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.607 | L2-Norm(final)=14.581 | 4708.6 samples/s | 73.6 steps/s
[Step=47900 Epoch=233.4] | Loss=0.00519 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.609 | L2-Norm(final)=14.584 | 4698.5 samples/s | 73.4 steps/s
[Step=47950 Epoch=233.6] | Loss=0.00507 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.612 | L2-Norm(final)=14.586 | 2911.6 samples/s | 45.5 steps/s
[Step=48000 Epoch=233.9] | Loss=0.00498 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.614 | L2-Norm(final)=14.589 | 4718.3 samples/s | 73.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step48000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=42001 Epoch=206.0] | Loss=0.00231 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.487 | L2-Norm(final)=15.284 | 6795.3 samples/s | 106.2 steps/s
[Step=42050 Epoch=206.2] | Loss=0.01688 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=15.286 | 4915.3 samples/s | 76.8 steps/s
[Step=42100 Epoch=206.5] | Loss=0.01713 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.488 | L2-Norm(final)=15.286 | 5512.5 samples/s | 86.1 steps/s
[Step=42150 Epoch=206.7] | Loss=0.01790 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.488 | L2-Norm(final)=15.285 | 5515.1 samples/s | 86.2 steps/s
[Step=42200 Epoch=206.9] | Loss=0.01802 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=15.283 | 8903.4 samples/s | 139.1 steps/s
[Step=42250 Epoch=207.2] | Loss=0.01842 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=15.282 | 2633.9 samples/s | 41.2 steps/s
[Step=42300 Epoch=207.4] | Loss=0.01785 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=15.281 | 5399.4 samples/s | 84.4 steps/s
[Step=42350 Epoch=207.7] | Loss=0.01797 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=15.281 | 5480.3 samples/s | 85.6 steps/s
[Step=42400 Epoch=207.9] | Loss=0.01777 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.488 | L2-Norm(final)=15.281 | 8153.6 samples/s | 127.4 steps/s
[Step=42450 Epoch=208.2] | Loss=0.01784 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=15.281 | 2696.6 samples/s | 42.1 steps/s
[Step=42500 Epoch=208.4] | Loss=0.01791 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.488 | L2-Norm(final)=15.281 | 5589.4 samples/s | 87.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=208.4] | Loss=0.01445 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.488 | L2-Norm(final)=15.282 | 7214.7 samples/s | 112.7 steps/s
[Step=42550 Epoch=208.7] | Loss=0.01575 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.494 | L2-Norm(final)=15.283 | 4208.0 samples/s | 65.8 steps/s
[Step=42600 Epoch=208.9] | Loss=0.01492 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.501 | L2-Norm(final)=15.285 | 4782.1 samples/s | 74.7 steps/s
[Step=42650 Epoch=209.1] | Loss=0.01548 | Reg=0.00090 | acc=0.9531 | L2-Norm=9.508 | L2-Norm(final)=15.287 | 4706.9 samples/s | 73.5 steps/s
[Step=42700 Epoch=209.4] | Loss=0.01402 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.515 | L2-Norm(final)=15.289 | 6852.7 samples/s | 107.1 steps/s
[Step=42750 Epoch=209.6] | Loss=0.01212 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.520 | L2-Norm(final)=15.292 | 2435.0 samples/s | 38.0 steps/s
[Step=42800 Epoch=209.9] | Loss=0.01106 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.526 | L2-Norm(final)=15.296 | 4764.7 samples/s | 74.4 steps/s
[Step=42850 Epoch=210.1] | Loss=0.01035 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.530 | L2-Norm(final)=15.299 | 4631.3 samples/s | 72.4 steps/s
[Step=42900 Epoch=210.4] | Loss=0.00974 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.535 | L2-Norm(final)=15.302 | 6559.6 samples/s | 102.5 steps/s
[Step=42950 Epoch=210.6] | Loss=0.00906 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=15.305 | 2510.6 samples/s | 39.2 steps/s
[Step=43000 Epoch=210.9] | Loss=0.00855 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.543 | L2-Norm(final)=15.309 | 4603.8 samples/s | 71.9 steps/s
[Step=43050 Epoch=211.1] | Loss=0.00824 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.546 | L2-Norm(final)=15.312 | 4797.2 samples/s | 75.0 steps/s
[Step=43100 Epoch=211.4] | Loss=0.00786 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.550 | L2-Norm(final)=15.315 | 6076.2 samples/s | 94.9 steps/s
[Step=43150 Epoch=211.6] | Loss=0.00750 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.553 | L2-Norm(final)=15.318 | 2548.9 samples/s | 39.8 steps/s
[Step=43200 Epoch=211.8] | Loss=0.00717 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.557 | L2-Norm(final)=15.322 | 4758.1 samples/s | 74.3 steps/s
[Step=43250 Epoch=212.1] | Loss=0.00692 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.560 | L2-Norm(final)=15.325 | 4759.6 samples/s | 74.4 steps/s
[Step=43300 Epoch=212.3] | Loss=0.00674 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.563 | L2-Norm(final)=15.328 | 5698.9 samples/s | 89.0 steps/s
[Step=43350 Epoch=212.6] | Loss=0.00660 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.566 | L2-Norm(final)=15.331 | 2621.3 samples/s | 41.0 steps/s
[Step=43400 Epoch=212.8] | Loss=0.00640 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.569 | L2-Norm(final)=15.334 | 4785.0 samples/s | 74.8 steps/s
[Step=43450 Epoch=213.1] | Loss=0.00622 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.572 | L2-Norm(final)=15.337 | 4665.5 samples/s | 72.9 steps/s
[Step=43500 Epoch=213.3] | Loss=0.00609 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.575 | L2-Norm(final)=15.340 | 5439.1 samples/s | 85.0 steps/s
[Step=43550 Epoch=213.6] | Loss=0.00593 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=15.343 | 2723.2 samples/s | 42.5 steps/s
[Step=43600 Epoch=213.8] | Loss=0.00576 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.581 | L2-Norm(final)=15.345 | 4770.5 samples/s | 74.5 steps/s
[Step=43650 Epoch=214.1] | Loss=0.00565 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.583 | L2-Norm(final)=15.348 | 4664.8 samples/s | 72.9 steps/s
[Step=43700 Epoch=214.3] | Loss=0.00555 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.586 | L2-Norm(final)=15.351 | 5189.0 samples/s | 81.1 steps/s
[Step=43750 Epoch=214.5] | Loss=0.00543 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.589 | L2-Norm(final)=15.354 | 2767.6 samples/s | 43.2 steps/s
[Step=43800 Epoch=214.8] | Loss=0.00532 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.591 | L2-Norm(final)=15.356 | 4731.2 samples/s | 73.9 steps/s
[Step=43850 Epoch=215.0] | Loss=0.00518 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=15.359 | 4763.8 samples/s | 74.4 steps/s
[Step=43900 Epoch=215.3] | Loss=0.00515 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.596 | L2-Norm(final)=15.361 | 4917.5 samples/s | 76.8 steps/s
[Step=43950 Epoch=215.5] | Loss=0.00508 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.598 | L2-Norm(final)=15.364 | 2838.7 samples/s | 44.4 steps/s
[Step=44000 Epoch=215.8] | Loss=0.00499 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.601 | L2-Norm(final)=15.367 | 4680.8 samples/s | 73.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step44000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=42001 Epoch=401.1] | Loss=0.00026 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.487 | L2-Norm(final)=14.998 | 7083.9 samples/s | 110.7 steps/s
[Step=42050 Epoch=401.6] | Loss=0.00023 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.484 | L2-Norm(final)=15.007 | 4357.2 samples/s | 68.1 steps/s
[Step=42100 Epoch=402.0] | Loss=0.00021 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.484 | L2-Norm(final)=15.012 | 8361.8 samples/s | 130.7 steps/s
[Step=42150 Epoch=402.5] | Loss=0.00021 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.484 | L2-Norm(final)=15.018 | 2524.4 samples/s | 39.4 steps/s
[Step=42200 Epoch=403.0] | Loss=0.00022 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.484 | L2-Norm(final)=15.023 | 7629.9 samples/s | 119.2 steps/s
[Step=42250 Epoch=403.5] | Loss=0.00022 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.484 | L2-Norm(final)=15.030 | 2630.1 samples/s | 41.1 steps/s
[Step=42300 Epoch=403.9] | Loss=0.00022 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.484 | L2-Norm(final)=15.036 | 6846.5 samples/s | 107.0 steps/s
[Step=42350 Epoch=404.4] | Loss=0.00021 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.484 | L2-Norm(final)=15.042 | 2718.6 samples/s | 42.5 steps/s
[Step=42400 Epoch=404.9] | Loss=0.00022 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.483 | L2-Norm(final)=15.047 | 6283.6 samples/s | 98.2 steps/s
[Step=42450 Epoch=405.4] | Loss=0.00021 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.483 | L2-Norm(final)=15.052 | 2854.4 samples/s | 44.6 steps/s
[Step=42500 Epoch=405.8] | Loss=0.00021 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.483 | L2-Norm(final)=15.057 | 5618.6 samples/s | 87.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=405.9] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.483 | L2-Norm(final)=15.104 | 6845.8 samples/s | 107.0 steps/s
[Step=42550 Epoch=406.3] | Loss=0.00011 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.487 | L2-Norm(final)=15.107 | 4031.7 samples/s | 63.0 steps/s
[Step=42600 Epoch=406.8] | Loss=0.00006 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.485 | L2-Norm(final)=15.109 | 6665.6 samples/s | 104.2 steps/s
[Step=42650 Epoch=407.3] | Loss=0.00005 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.479 | L2-Norm(final)=15.110 | 2363.8 samples/s | 36.9 steps/s
[Step=42700 Epoch=407.8] | Loss=0.00003 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.471 | L2-Norm(final)=15.110 | 6008.6 samples/s | 93.9 steps/s
[Step=42750 Epoch=408.2] | Loss=0.00003 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.463 | L2-Norm(final)=15.111 | 2428.1 samples/s | 37.9 steps/s
[Step=42800 Epoch=408.7] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.455 | L2-Norm(final)=15.111 | 5639.0 samples/s | 88.1 steps/s
[Step=42850 Epoch=409.2] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.446 | L2-Norm(final)=15.111 | 2506.7 samples/s | 39.2 steps/s
[Step=42900 Epoch=409.7] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.437 | L2-Norm(final)=15.111 | 5240.6 samples/s | 81.9 steps/s
[Step=42950 Epoch=410.1] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.428 | L2-Norm(final)=15.112 | 2583.9 samples/s | 40.4 steps/s
[Step=43000 Epoch=410.6] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.419 | L2-Norm(final)=15.112 | 4834.6 samples/s | 75.5 steps/s
[Step=43050 Epoch=411.1] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=15.112 | 2696.6 samples/s | 42.1 steps/s
[Step=43100 Epoch=411.6] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.401 | L2-Norm(final)=15.112 | 4598.5 samples/s | 71.9 steps/s
[Step=43150 Epoch=412.1] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.391 | L2-Norm(final)=15.112 | 2783.6 samples/s | 43.5 steps/s
[Step=43200 Epoch=412.5] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.382 | L2-Norm(final)=15.113 | 4570.9 samples/s | 71.4 steps/s
[Step=43250 Epoch=413.0] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.373 | L2-Norm(final)=15.113 | 2806.1 samples/s | 43.8 steps/s
[Step=43300 Epoch=413.5] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.363 | L2-Norm(final)=15.113 | 4480.7 samples/s | 70.0 steps/s
[Step=43350 Epoch=414.0] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.354 | L2-Norm(final)=15.113 | 2794.0 samples/s | 43.7 steps/s
[Step=43400 Epoch=414.4] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.344 | L2-Norm(final)=15.113 | 4482.0 samples/s | 70.0 steps/s
[Step=43450 Epoch=414.9] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.334 | L2-Norm(final)=15.113 | 2845.7 samples/s | 44.5 steps/s
[Step=43500 Epoch=415.4] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.324 | L2-Norm(final)=15.113 | 4478.9 samples/s | 70.0 steps/s
[Step=43550 Epoch=415.9] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.314 | L2-Norm(final)=15.114 | 7345.3 samples/s | 114.8 steps/s
[Step=43600 Epoch=416.4] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.304 | L2-Norm(final)=15.114 | 2271.6 samples/s | 35.5 steps/s
[Step=43650 Epoch=416.8] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.294 | L2-Norm(final)=15.114 | 6731.5 samples/s | 105.2 steps/s
[Step=43700 Epoch=417.3] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=15.114 | 2376.2 samples/s | 37.1 steps/s
[Step=43750 Epoch=417.8] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.274 | L2-Norm(final)=15.114 | 6011.7 samples/s | 93.9 steps/s
[Step=43800 Epoch=418.3] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.264 | L2-Norm(final)=15.114 | 2427.8 samples/s | 37.9 steps/s
[Step=43850 Epoch=418.7] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.253 | L2-Norm(final)=15.115 | 5654.9 samples/s | 88.4 steps/s
[Step=43900 Epoch=419.2] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.243 | L2-Norm(final)=15.115 | 2511.5 samples/s | 39.2 steps/s
[Step=43950 Epoch=419.7] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.232 | L2-Norm(final)=15.115 | 5233.2 samples/s | 81.8 steps/s
[Step=44000 Epoch=420.2] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.221 | L2-Norm(final)=15.115 | 2604.5 samples/s | 40.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step44000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=46001 Epoch=438.4] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.487 | L2-Norm(final)=17.093 | 7363.5 samples/s | 115.1 steps/s
[Step=46050 Epoch=438.9] | Loss=0.00158 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.486 | L2-Norm(final)=17.098 | 4385.8 samples/s | 68.5 steps/s
[Step=46100 Epoch=439.4] | Loss=0.00129 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.485 | L2-Norm(final)=17.105 | 8310.8 samples/s | 129.9 steps/s
[Step=46150 Epoch=439.9] | Loss=0.00127 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.485 | L2-Norm(final)=17.112 | 2532.9 samples/s | 39.6 steps/s
[Step=46200 Epoch=440.3] | Loss=0.00128 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.485 | L2-Norm(final)=17.117 | 7424.3 samples/s | 116.0 steps/s
[Step=46250 Epoch=440.8] | Loss=0.00128 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.485 | L2-Norm(final)=17.123 | 2607.4 samples/s | 40.7 steps/s
[Step=46300 Epoch=441.3] | Loss=0.00127 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.485 | L2-Norm(final)=17.128 | 6783.5 samples/s | 106.0 steps/s
[Step=46350 Epoch=441.8] | Loss=0.00124 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.485 | L2-Norm(final)=17.133 | 2743.7 samples/s | 42.9 steps/s
[Step=46400 Epoch=442.2] | Loss=0.00126 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.485 | L2-Norm(final)=17.138 | 6122.4 samples/s | 95.7 steps/s
[Step=46450 Epoch=442.7] | Loss=0.00124 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.485 | L2-Norm(final)=17.142 | 2809.8 samples/s | 43.9 steps/s
[Step=46500 Epoch=443.2] | Loss=0.00129 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.485 | L2-Norm(final)=17.146 | 5740.0 samples/s | 89.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=443.2] | Loss=0.00212 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.485 | L2-Norm(final)=17.191 | 6707.9 samples/s | 104.8 steps/s
[Step=46550 Epoch=443.7] | Loss=0.00160 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.502 | L2-Norm(final)=17.192 | 4110.1 samples/s | 64.2 steps/s
[Step=46600 Epoch=444.1] | Loss=0.00089 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.510 | L2-Norm(final)=17.192 | 6650.6 samples/s | 103.9 steps/s
[Step=46650 Epoch=444.6] | Loss=0.00061 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.513 | L2-Norm(final)=17.193 | 2345.8 samples/s | 36.7 steps/s
[Step=46700 Epoch=445.1] | Loss=0.00047 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=17.193 | 6127.1 samples/s | 95.7 steps/s
[Step=46750 Epoch=445.6] | Loss=0.00038 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=17.193 | 2403.3 samples/s | 37.6 steps/s
[Step=46800 Epoch=446.0] | Loss=0.00032 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=17.193 | 5649.2 samples/s | 88.3 steps/s
[Step=46850 Epoch=446.5] | Loss=0.00028 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=17.194 | 2512.1 samples/s | 39.3 steps/s
[Step=46900 Epoch=447.0] | Loss=0.00025 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.513 | L2-Norm(final)=17.194 | 5200.7 samples/s | 81.3 steps/s
[Step=46950 Epoch=447.5] | Loss=0.00022 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.513 | L2-Norm(final)=17.194 | 2605.3 samples/s | 40.7 steps/s
[Step=47000 Epoch=448.0] | Loss=0.00020 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.512 | L2-Norm(final)=17.194 | 4778.2 samples/s | 74.7 steps/s
[Step=47050 Epoch=448.4] | Loss=0.00018 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.511 | L2-Norm(final)=17.194 | 2751.7 samples/s | 43.0 steps/s
[Step=47100 Epoch=448.9] | Loss=0.00017 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.510 | L2-Norm(final)=17.194 | 4480.1 samples/s | 70.0 steps/s
[Step=47150 Epoch=449.4] | Loss=0.00016 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.509 | L2-Norm(final)=17.195 | 2790.7 samples/s | 43.6 steps/s
[Step=47200 Epoch=449.9] | Loss=0.00015 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.508 | L2-Norm(final)=17.195 | 4508.0 samples/s | 70.4 steps/s
[Step=47250 Epoch=450.3] | Loss=0.00014 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.507 | L2-Norm(final)=17.195 | 2826.5 samples/s | 44.2 steps/s
[Step=47300 Epoch=450.8] | Loss=0.00013 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.506 | L2-Norm(final)=17.195 | 4533.2 samples/s | 70.8 steps/s
[Step=47350 Epoch=451.3] | Loss=0.00012 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.505 | L2-Norm(final)=17.195 | 2814.4 samples/s | 44.0 steps/s
[Step=47400 Epoch=451.8] | Loss=0.00012 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.504 | L2-Norm(final)=17.195 | 4472.7 samples/s | 69.9 steps/s
[Step=47450 Epoch=452.2] | Loss=0.00011 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.503 | L2-Norm(final)=17.196 | 2806.8 samples/s | 43.9 steps/s
[Step=47500 Epoch=452.7] | Loss=0.00011 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.502 | L2-Norm(final)=17.196 | 4551.0 samples/s | 71.1 steps/s
[Step=47550 Epoch=453.2] | Loss=0.00010 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.501 | L2-Norm(final)=17.196 | 7088.6 samples/s | 110.8 steps/s
[Step=47600 Epoch=453.7] | Loss=0.00010 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.500 | L2-Norm(final)=17.196 | 2256.1 samples/s | 35.3 steps/s
[Step=47650 Epoch=454.1] | Loss=0.00009 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.498 | L2-Norm(final)=17.196 | 6620.2 samples/s | 103.4 steps/s
[Step=47700 Epoch=454.6] | Loss=0.00009 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.497 | L2-Norm(final)=17.196 | 2352.4 samples/s | 36.8 steps/s
[Step=47750 Epoch=455.1] | Loss=0.00009 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.496 | L2-Norm(final)=17.196 | 5964.1 samples/s | 93.2 steps/s
[Step=47800 Epoch=455.6] | Loss=0.00008 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.495 | L2-Norm(final)=17.197 | 2428.5 samples/s | 37.9 steps/s
[Step=47850 Epoch=456.1] | Loss=0.00008 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.493 | L2-Norm(final)=17.197 | 5653.7 samples/s | 88.3 steps/s
[Step=47900 Epoch=456.5] | Loss=0.00008 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.492 | L2-Norm(final)=17.197 | 2505.9 samples/s | 39.2 steps/s
[Step=47950 Epoch=457.0] | Loss=0.00008 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.491 | L2-Norm(final)=17.197 | 5268.7 samples/s | 82.3 steps/s
[Step=48000 Epoch=457.5] | Loss=0.00007 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.489 | L2-Norm(final)=17.197 | 2592.9 samples/s | 40.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_4/client_state-step48000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07905 | acc=0.9648 | tpr=0.9775 | fpr=0.0627 | 5740.8 samples/s | 22.4 steps/s
Avg test loss: 0.08339, Avg test acc: 0.96254, Avg tpr: 0.97622, Avg fpr: 0.06756, total FA: 527

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08492 | acc=0.9632 | tpr=0.9763 | fpr=0.0652 | 5839.4 samples/s | 22.8 steps/s
Avg test loss: 0.08835, Avg test acc: 0.96186, Avg tpr: 0.97406, Avg fpr: 0.06499, total FA: 507

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08619 | acc=0.9620 | tpr=0.9711 | fpr=0.0577 | 6081.7 samples/s | 23.8 steps/s
Avg test loss: 0.09020, Avg test acc: 0.96037, Avg tpr: 0.96823, Avg fpr: 0.05692, total FA: 444

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08462 | acc=0.9634 | tpr=0.9815 | fpr=0.0758 | 6105.0 samples/s | 23.8 steps/s
Avg test loss: 0.08868, Avg test acc: 0.96266, Avg tpr: 0.98036, Avg fpr: 0.07627, total FA: 595

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08314 | acc=0.9627 | tpr=0.9747 | fpr=0.0634 | 5864.0 samples/s | 22.9 steps/s
Avg test loss: 0.08650, Avg test acc: 0.96194, Avg tpr: 0.97319, Avg fpr: 0.06281, total FA: 490

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.16973 | acc=0.2797 | tpr=0.0203 | fpr=0.1571 | 5808.9 samples/s | 22.7 steps/s
Avg test loss: 6.17438, Avg test acc: 0.27879, Avg tpr: 0.01970, Avg fpr: 0.15139, total FA: 1181

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.66509 | acc=0.3106 | tpr=0.0259 | fpr=0.0711 | 6090.4 samples/s | 23.8 steps/s
Avg test loss: 4.67431, Avg test acc: 0.30800, Avg tpr: 0.02547, Avg fpr: 0.07063, total FA: 551

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.98615 | acc=0.3007 | tpr=0.0227 | fpr=0.0956 | 5982.7 samples/s | 23.4 steps/s
Avg test loss: 4.99136, Avg test acc: 0.29946, Avg tpr: 0.02209, Avg fpr: 0.09050, total FA: 706

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.20279 | acc=0.2759 | tpr=0.0249 | fpr=0.1791 | 6059.3 samples/s | 23.7 steps/s
Avg test loss: 5.20459, Avg test acc: 0.27578, Avg tpr: 0.02448, Avg fpr: 0.17152, total FA: 1338

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.47805 | acc=0.2924 | tpr=0.0203 | fpr=0.1167 | 5840.2 samples/s | 22.8 steps/s
Avg test loss: 4.49510, Avg test acc: 0.29169, Avg tpr: 0.02005, Avg fpr: 0.11088, total FA: 865

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.27028 | acc=0.1180 | tpr=0.6504 | fpr=0.8916 | 5961.0 samples/s | 23.3 steps/s
[Step= 100] | Loss=5.25690 | acc=0.1187 | tpr=0.6311 | fpr=0.8908 | 8023.1 samples/s | 31.3 steps/s
[Step= 150] | Loss=5.24645 | acc=0.1206 | tpr=0.6441 | fpr=0.8891 | 7262.8 samples/s | 28.4 steps/s
[Step= 200] | Loss=5.23550 | acc=0.1211 | tpr=0.6393 | fpr=0.8883 | 8009.8 samples/s | 31.3 steps/s
[Step= 250] | Loss=5.24255 | acc=0.1209 | tpr=0.6332 | fpr=0.8884 | 7966.0 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.23644 | acc=0.1206 | tpr=0.6262 | fpr=0.8886 | 7728.1 samples/s | 30.2 steps/s
[Step= 350] | Loss=5.24124 | acc=0.1208 | tpr=0.6218 | fpr=0.8883 | 7945.2 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.23873 | acc=0.1211 | tpr=0.6204 | fpr=0.8880 | 8042.8 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.24422 | acc=0.1208 | tpr=0.6232 | fpr=0.8884 | 7951.5 samples/s | 31.1 steps/s
[Step= 500] | Loss=5.24439 | acc=0.1207 | tpr=0.6286 | fpr=0.8885 | 8196.1 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.24716 | acc=0.1207 | tpr=0.6299 | fpr=0.8885 | 11232.6 samples/s | 43.9 steps/s
Avg test loss: 5.24747, Avg test acc: 0.12063, Avg tpr: 0.63074, Avg fpr: 0.88864, total FA: 123386

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.89348 | acc=0.1335 | tpr=0.5619 | fpr=0.8742 | 5853.5 samples/s | 22.9 steps/s
[Step= 100] | Loss=4.88482 | acc=0.1372 | tpr=0.5693 | fpr=0.8709 | 8029.9 samples/s | 31.4 steps/s
[Step= 150] | Loss=4.87347 | acc=0.1399 | tpr=0.5951 | fpr=0.8684 | 7858.6 samples/s | 30.7 steps/s
[Step= 200] | Loss=4.86398 | acc=0.1406 | tpr=0.5934 | fpr=0.8676 | 8416.8 samples/s | 32.9 steps/s
[Step= 250] | Loss=4.86865 | acc=0.1400 | tpr=0.5860 | fpr=0.8681 | 8024.0 samples/s | 31.3 steps/s
[Step= 300] | Loss=4.86418 | acc=0.1396 | tpr=0.5767 | fpr=0.8684 | 8026.6 samples/s | 31.4 steps/s
[Step= 350] | Loss=4.86928 | acc=0.1392 | tpr=0.5698 | fpr=0.8686 | 7887.9 samples/s | 30.8 steps/s
[Step= 400] | Loss=4.86725 | acc=0.1395 | tpr=0.5706 | fpr=0.8684 | 7556.4 samples/s | 29.5 steps/s
[Step= 450] | Loss=4.87109 | acc=0.1389 | tpr=0.5774 | fpr=0.8691 | 8019.1 samples/s | 31.3 steps/s
[Step= 500] | Loss=4.87207 | acc=0.1385 | tpr=0.5802 | fpr=0.8695 | 8478.5 samples/s | 33.1 steps/s
[Step= 550] | Loss=4.87552 | acc=0.1387 | tpr=0.5818 | fpr=0.8693 | 9829.2 samples/s | 38.4 steps/s
Avg test loss: 4.87576, Avg test acc: 0.13864, Avg tpr: 0.58281, Avg fpr: 0.86943, total FA: 120719

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.11266 | acc=0.1258 | tpr=0.5575 | fpr=0.8820 | 5915.7 samples/s | 23.1 steps/s
[Step= 100] | Loss=5.09912 | acc=0.1277 | tpr=0.5565 | fpr=0.8803 | 7885.6 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.08967 | acc=0.1303 | tpr=0.5749 | fpr=0.8779 | 8435.6 samples/s | 33.0 steps/s
[Step= 200] | Loss=5.07991 | acc=0.1310 | tpr=0.5705 | fpr=0.8770 | 8114.7 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.08659 | acc=0.1309 | tpr=0.5651 | fpr=0.8770 | 7777.5 samples/s | 30.4 steps/s
[Step= 300] | Loss=5.08190 | acc=0.1307 | tpr=0.5615 | fpr=0.8772 | 7872.0 samples/s | 30.8 steps/s
[Step= 350] | Loss=5.08638 | acc=0.1306 | tpr=0.5592 | fpr=0.8771 | 8514.3 samples/s | 33.3 steps/s
[Step= 400] | Loss=5.08486 | acc=0.1309 | tpr=0.5596 | fpr=0.8769 | 7377.3 samples/s | 28.8 steps/s
[Step= 450] | Loss=5.08933 | acc=0.1303 | tpr=0.5618 | fpr=0.8776 | 8266.2 samples/s | 32.3 steps/s
[Step= 500] | Loss=5.08876 | acc=0.1301 | tpr=0.5621 | fpr=0.8777 | 7878.5 samples/s | 30.8 steps/s
[Step= 550] | Loss=5.09159 | acc=0.1301 | tpr=0.5619 | fpr=0.8777 | 9584.3 samples/s | 37.4 steps/s
Avg test loss: 5.09197, Avg test acc: 0.13008, Avg tpr: 0.56300, Avg fpr: 0.87779, total FA: 121880

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.23383 | acc=0.1218 | tpr=0.6903 | fpr=0.8884 | 5679.6 samples/s | 22.2 steps/s
[Step= 100] | Loss=5.22284 | acc=0.1246 | tpr=0.6716 | fpr=0.8856 | 8089.3 samples/s | 31.6 steps/s
[Step= 150] | Loss=5.21154 | acc=0.1264 | tpr=0.6787 | fpr=0.8837 | 7864.4 samples/s | 30.7 steps/s
[Step= 200] | Loss=5.20142 | acc=0.1273 | tpr=0.6765 | fpr=0.8827 | 7941.6 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.20556 | acc=0.1268 | tpr=0.6655 | fpr=0.8830 | 8612.4 samples/s | 33.6 steps/s
[Step= 300] | Loss=5.20183 | acc=0.1264 | tpr=0.6640 | fpr=0.8834 | 8338.0 samples/s | 32.6 steps/s
[Step= 350] | Loss=5.20728 | acc=0.1262 | tpr=0.6644 | fpr=0.8836 | 8017.9 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.20582 | acc=0.1264 | tpr=0.6630 | fpr=0.8834 | 7858.8 samples/s | 30.7 steps/s
[Step= 450] | Loss=5.21097 | acc=0.1256 | tpr=0.6665 | fpr=0.8842 | 8075.5 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.21076 | acc=0.1256 | tpr=0.6714 | fpr=0.8843 | 7964.2 samples/s | 31.1 steps/s
[Step= 550] | Loss=5.21490 | acc=0.1256 | tpr=0.6741 | fpr=0.8843 | 9357.5 samples/s | 36.6 steps/s
Avg test loss: 5.21540, Avg test acc: 0.12556, Avg tpr: 0.67512, Avg fpr: 0.88443, total FA: 122801

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.92712 | acc=0.1314 | tpr=0.5044 | fpr=0.8753 | 6068.9 samples/s | 23.7 steps/s
[Step= 100] | Loss=4.91786 | acc=0.1332 | tpr=0.4861 | fpr=0.8734 | 7792.8 samples/s | 30.4 steps/s
[Step= 150] | Loss=4.90651 | acc=0.1351 | tpr=0.5072 | fpr=0.8718 | 7982.4 samples/s | 31.2 steps/s
[Step= 200] | Loss=4.89875 | acc=0.1361 | tpr=0.5038 | fpr=0.8706 | 8055.0 samples/s | 31.5 steps/s
[Step= 250] | Loss=4.90438 | acc=0.1356 | tpr=0.4908 | fpr=0.8709 | 7548.7 samples/s | 29.5 steps/s
[Step= 300] | Loss=4.90124 | acc=0.1355 | tpr=0.4836 | fpr=0.8709 | 7898.0 samples/s | 30.9 steps/s
[Step= 350] | Loss=4.90743 | acc=0.1354 | tpr=0.4847 | fpr=0.8709 | 7780.3 samples/s | 30.4 steps/s
[Step= 400] | Loss=4.90451 | acc=0.1355 | tpr=0.4863 | fpr=0.8708 | 7518.0 samples/s | 29.4 steps/s
[Step= 450] | Loss=4.90891 | acc=0.1350 | tpr=0.4898 | fpr=0.8714 | 8286.7 samples/s | 32.4 steps/s
[Step= 500] | Loss=4.90893 | acc=0.1348 | tpr=0.4916 | fpr=0.8716 | 8407.1 samples/s | 32.8 steps/s
[Step= 550] | Loss=4.91156 | acc=0.1349 | tpr=0.4879 | fpr=0.8715 | 10441.6 samples/s | 40.8 steps/s
Avg test loss: 4.91211, Avg test acc: 0.13478, Avg tpr: 0.48851, Avg fpr: 0.87165, total FA: 121027

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.22570 | acc=0.9580 | tpr=0.9513 | fpr=0.0418 | 5948.6 samples/s | 23.2 steps/s
[Step= 100] | Loss=0.23417 | acc=0.9574 | tpr=0.9595 | fpr=0.0426 | 7907.0 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.23649 | acc=0.9559 | tpr=0.9568 | fpr=0.0442 | 7167.3 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.23671 | acc=0.9559 | tpr=0.9607 | fpr=0.0442 | 8353.5 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.23701 | acc=0.9557 | tpr=0.9581 | fpr=0.0443 | 8177.7 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.24060 | acc=0.9554 | tpr=0.9564 | fpr=0.0446 | 7561.1 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.23867 | acc=0.9556 | tpr=0.9555 | fpr=0.0444 | 8167.3 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.23846 | acc=0.9553 | tpr=0.9535 | fpr=0.0446 | 8170.6 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.24193 | acc=0.9549 | tpr=0.9523 | fpr=0.0450 | 8194.4 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.24242 | acc=0.9548 | tpr=0.9533 | fpr=0.0452 | 8239.4 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.24116 | acc=0.9550 | tpr=0.9538 | fpr=0.0450 | 10034.9 samples/s | 39.2 steps/s
Avg test loss: 0.24085, Avg test acc: 0.95503, Avg tpr: 0.95365, Avg fpr: 0.04494, total FA: 6240

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16702 | acc=0.9615 | tpr=0.9204 | fpr=0.0378 | 6119.3 samples/s | 23.9 steps/s
[Step= 100] | Loss=0.17437 | acc=0.9605 | tpr=0.9275 | fpr=0.0389 | 7914.0 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.17684 | acc=0.9591 | tpr=0.9323 | fpr=0.0404 | 7164.1 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.17725 | acc=0.9592 | tpr=0.9355 | fpr=0.0404 | 8147.2 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.17675 | acc=0.9593 | tpr=0.9362 | fpr=0.0403 | 8240.8 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.17948 | acc=0.9589 | tpr=0.9331 | fpr=0.0407 | 8258.7 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.17804 | acc=0.9590 | tpr=0.9336 | fpr=0.0406 | 8080.4 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.17840 | acc=0.9588 | tpr=0.9311 | fpr=0.0407 | 7871.3 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.18104 | acc=0.9584 | tpr=0.9309 | fpr=0.0411 | 7975.6 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.18071 | acc=0.9584 | tpr=0.9330 | fpr=0.0412 | 7523.3 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.17970 | acc=0.9586 | tpr=0.9347 | fpr=0.0410 | 10586.1 samples/s | 41.4 steps/s
Avg test loss: 0.17949, Avg test acc: 0.95861, Avg tpr: 0.93463, Avg fpr: 0.04095, total FA: 5686

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.25239 | acc=0.9510 | tpr=0.9469 | fpr=0.0489 | 5920.8 samples/s | 23.1 steps/s
[Step= 100] | Loss=0.26108 | acc=0.9502 | tpr=0.9574 | fpr=0.0499 | 7749.0 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.26584 | acc=0.9490 | tpr=0.9597 | fpr=0.0512 | 7978.5 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.26597 | acc=0.9491 | tpr=0.9628 | fpr=0.0511 | 8055.0 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.26591 | acc=0.9491 | tpr=0.9633 | fpr=0.0512 | 8081.2 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.26868 | acc=0.9488 | tpr=0.9600 | fpr=0.0514 | 7820.8 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.26680 | acc=0.9489 | tpr=0.9593 | fpr=0.0512 | 8362.0 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.26686 | acc=0.9486 | tpr=0.9579 | fpr=0.0516 | 7638.6 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.27008 | acc=0.9481 | tpr=0.9567 | fpr=0.0520 | 8158.9 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.27061 | acc=0.9481 | tpr=0.9573 | fpr=0.0521 | 8434.8 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.26909 | acc=0.9484 | tpr=0.9578 | fpr=0.0518 | 9494.3 samples/s | 37.1 steps/s
Avg test loss: 0.26887, Avg test acc: 0.94838, Avg tpr: 0.95761, Avg fpr: 0.05178, total FA: 7190

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15832 | acc=0.9649 | tpr=0.9425 | fpr=0.0347 | 5637.7 samples/s | 22.0 steps/s
[Step= 100] | Loss=0.16525 | acc=0.9635 | tpr=0.9446 | fpr=0.0362 | 7890.1 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.16670 | acc=0.9615 | tpr=0.9380 | fpr=0.0381 | 7674.4 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.16657 | acc=0.9615 | tpr=0.9421 | fpr=0.0381 | 8624.8 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.16649 | acc=0.9614 | tpr=0.9406 | fpr=0.0382 | 8236.7 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.16928 | acc=0.9611 | tpr=0.9418 | fpr=0.0385 | 8366.5 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.16784 | acc=0.9611 | tpr=0.9399 | fpr=0.0385 | 8069.7 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.16740 | acc=0.9609 | tpr=0.9371 | fpr=0.0387 | 8083.7 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.16978 | acc=0.9605 | tpr=0.9372 | fpr=0.0391 | 7622.9 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.17000 | acc=0.9604 | tpr=0.9392 | fpr=0.0392 | 8054.0 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.16894 | acc=0.9607 | tpr=0.9399 | fpr=0.0390 | 9677.4 samples/s | 37.8 steps/s
Avg test loss: 0.16869, Avg test acc: 0.96066, Avg tpr: 0.93978, Avg fpr: 0.03896, total FA: 5410

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.20353 | acc=0.9555 | tpr=0.9425 | fpr=0.0443 | 5667.6 samples/s | 22.1 steps/s
[Step= 100] | Loss=0.21180 | acc=0.9545 | tpr=0.9531 | fpr=0.0455 | 8237.9 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.21472 | acc=0.9530 | tpr=0.9568 | fpr=0.0471 | 8287.3 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.21487 | acc=0.9530 | tpr=0.9585 | fpr=0.0471 | 8256.0 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.21534 | acc=0.9531 | tpr=0.9581 | fpr=0.0470 | 7609.4 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.21858 | acc=0.9526 | tpr=0.9549 | fpr=0.0475 | 7797.1 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.21739 | acc=0.9526 | tpr=0.9549 | fpr=0.0474 | 7372.6 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.21767 | acc=0.9523 | tpr=0.9524 | fpr=0.0477 | 8272.8 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.22087 | acc=0.9519 | tpr=0.9518 | fpr=0.0481 | 7897.3 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.22081 | acc=0.9518 | tpr=0.9520 | fpr=0.0482 | 8212.9 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.21943 | acc=0.9521 | tpr=0.9526 | fpr=0.0479 | 10872.9 samples/s | 42.5 steps/s
Avg test loss: 0.21923, Avg test acc: 0.95211, Avg tpr: 0.95246, Avg fpr: 0.04790, total FA: 6651

server round 48/50

clients selected: [1 2 3 4 7]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=56001 Epoch=273.3] | Loss=0.00548 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=16.069 | 7108.2 samples/s | 111.1 steps/s
[Step=56050 Epoch=273.5] | Loss=0.01645 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.411 | L2-Norm(final)=16.070 | 4884.3 samples/s | 76.3 steps/s
[Step=56100 Epoch=273.7] | Loss=0.01765 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.411 | L2-Norm(final)=16.068 | 5365.8 samples/s | 83.8 steps/s
[Step=56150 Epoch=274.0] | Loss=0.01742 | Reg=0.00089 | acc=0.9531 | L2-Norm=9.411 | L2-Norm(final)=16.067 | 5502.5 samples/s | 86.0 steps/s
[Step=56200 Epoch=274.2] | Loss=0.01684 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.411 | L2-Norm(final)=16.067 | 8635.9 samples/s | 134.9 steps/s
[Step=56250 Epoch=274.5] | Loss=0.01673 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.411 | L2-Norm(final)=16.068 | 2629.3 samples/s | 41.1 steps/s
[Step=56300 Epoch=274.7] | Loss=0.01652 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.411 | L2-Norm(final)=16.068 | 5489.2 samples/s | 85.8 steps/s
[Step=56350 Epoch=275.0] | Loss=0.01625 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.411 | L2-Norm(final)=16.069 | 5527.5 samples/s | 86.4 steps/s
[Step=56400 Epoch=275.2] | Loss=0.01658 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.411 | L2-Norm(final)=16.070 | 7704.7 samples/s | 120.4 steps/s
[Step=56450 Epoch=275.4] | Loss=0.01662 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.411 | L2-Norm(final)=16.070 | 2762.0 samples/s | 43.2 steps/s
[Step=56500 Epoch=275.7] | Loss=0.01646 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.411 | L2-Norm(final)=16.071 | 5534.9 samples/s | 86.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=56501 Epoch=275.7] | Loss=0.01498 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.411 | L2-Norm(final)=16.077 | 7515.7 samples/s | 117.4 steps/s
[Step=56550 Epoch=275.9] | Loss=0.01364 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.419 | L2-Norm(final)=16.079 | 4153.1 samples/s | 64.9 steps/s
[Step=56600 Epoch=276.2] | Loss=0.01359 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.427 | L2-Norm(final)=16.081 | 4713.5 samples/s | 73.6 steps/s
[Step=56650 Epoch=276.4] | Loss=0.01261 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.434 | L2-Norm(final)=16.083 | 4705.3 samples/s | 73.5 steps/s
[Step=56700 Epoch=276.7] | Loss=0.01267 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.441 | L2-Norm(final)=16.086 | 6849.8 samples/s | 107.0 steps/s
[Step=56750 Epoch=276.9] | Loss=0.01112 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.447 | L2-Norm(final)=16.089 | 2449.4 samples/s | 38.3 steps/s
[Step=56800 Epoch=277.2] | Loss=0.01037 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.452 | L2-Norm(final)=16.092 | 4733.8 samples/s | 74.0 steps/s
[Step=56850 Epoch=277.4] | Loss=0.00958 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.456 | L2-Norm(final)=16.095 | 4768.3 samples/s | 74.5 steps/s
[Step=56900 Epoch=277.6] | Loss=0.00886 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.461 | L2-Norm(final)=16.098 | 6190.3 samples/s | 96.7 steps/s
[Step=56950 Epoch=277.9] | Loss=0.00826 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.465 | L2-Norm(final)=16.101 | 2517.1 samples/s | 39.3 steps/s
[Step=57000 Epoch=278.1] | Loss=0.00783 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.469 | L2-Norm(final)=16.104 | 4708.3 samples/s | 73.6 steps/s
[Step=57050 Epoch=278.4] | Loss=0.00746 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.472 | L2-Norm(final)=16.107 | 4779.8 samples/s | 74.7 steps/s
[Step=57100 Epoch=278.6] | Loss=0.00720 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.476 | L2-Norm(final)=16.110 | 5818.6 samples/s | 90.9 steps/s
[Step=57150 Epoch=278.9] | Loss=0.00690 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.479 | L2-Norm(final)=16.112 | 2264.2 samples/s | 35.4 steps/s
[Step=57200 Epoch=279.1] | Loss=0.00662 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.483 | L2-Norm(final)=16.115 | 4826.4 samples/s | 75.4 steps/s
[Step=57250 Epoch=279.4] | Loss=0.00645 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.486 | L2-Norm(final)=16.118 | 4782.9 samples/s | 74.7 steps/s
[Step=57300 Epoch=279.6] | Loss=0.00621 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.489 | L2-Norm(final)=16.121 | 5346.2 samples/s | 83.5 steps/s
[Step=57350 Epoch=279.8] | Loss=0.00607 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.492 | L2-Norm(final)=16.123 | 2677.5 samples/s | 41.8 steps/s
[Step=57400 Epoch=280.1] | Loss=0.00590 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.494 | L2-Norm(final)=16.126 | 4811.7 samples/s | 75.2 steps/s
[Step=57450 Epoch=280.3] | Loss=0.00574 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.497 | L2-Norm(final)=16.128 | 4654.5 samples/s | 72.7 steps/s
[Step=57500 Epoch=280.6] | Loss=0.00559 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.500 | L2-Norm(final)=16.131 | 5044.5 samples/s | 78.8 steps/s
[Step=57550 Epoch=280.8] | Loss=0.00547 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.502 | L2-Norm(final)=16.133 | 2828.0 samples/s | 44.2 steps/s
[Step=57600 Epoch=281.1] | Loss=0.00536 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.505 | L2-Norm(final)=16.136 | 4628.7 samples/s | 72.3 steps/s
[Step=57650 Epoch=281.3] | Loss=0.00527 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.507 | L2-Norm(final)=16.138 | 4738.2 samples/s | 74.0 steps/s
[Step=57700 Epoch=281.5] | Loss=0.00512 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.510 | L2-Norm(final)=16.140 | 4775.0 samples/s | 74.6 steps/s
[Step=57750 Epoch=281.8] | Loss=0.00500 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.512 | L2-Norm(final)=16.143 | 2893.1 samples/s | 45.2 steps/s
[Step=57800 Epoch=282.0] | Loss=0.00496 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=16.145 | 4699.9 samples/s | 73.4 steps/s
[Step=57850 Epoch=282.3] | Loss=0.00485 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.516 | L2-Norm(final)=16.147 | 4803.5 samples/s | 75.1 steps/s
[Step=57900 Epoch=282.5] | Loss=0.00478 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.518 | L2-Norm(final)=16.149 | 4648.3 samples/s | 72.6 steps/s
[Step=57950 Epoch=282.8] | Loss=0.00470 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.521 | L2-Norm(final)=16.151 | 2905.5 samples/s | 45.4 steps/s
[Step=58000 Epoch=283.0] | Loss=0.00463 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.523 | L2-Norm(final)=16.154 | 4737.4 samples/s | 74.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_1/client_state-step58000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=48001 Epoch=233.9] | Loss=0.00284 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=14.671 | 6968.2 samples/s | 108.9 steps/s
[Step=48050 Epoch=234.1] | Loss=0.01632 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.410 | L2-Norm(final)=14.676 | 4797.1 samples/s | 75.0 steps/s
[Step=48100 Epoch=234.4] | Loss=0.01815 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.410 | L2-Norm(final)=14.680 | 5506.5 samples/s | 86.0 steps/s
[Step=48150 Epoch=234.6] | Loss=0.01782 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.410 | L2-Norm(final)=14.683 | 5523.7 samples/s | 86.3 steps/s
[Step=48200 Epoch=234.9] | Loss=0.01744 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.410 | L2-Norm(final)=14.687 | 8582.4 samples/s | 134.1 steps/s
[Step=48250 Epoch=235.1] | Loss=0.01766 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.410 | L2-Norm(final)=14.691 | 2654.1 samples/s | 41.5 steps/s
[Step=48300 Epoch=235.3] | Loss=0.01717 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=14.695 | 5509.3 samples/s | 86.1 steps/s
[Step=48350 Epoch=235.6] | Loss=0.01699 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.410 | L2-Norm(final)=14.699 | 5522.1 samples/s | 86.3 steps/s
[Step=48400 Epoch=235.8] | Loss=0.01720 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.410 | L2-Norm(final)=14.703 | 7525.0 samples/s | 117.6 steps/s
[Step=48450 Epoch=236.1] | Loss=0.01757 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=14.706 | 2736.3 samples/s | 42.8 steps/s
[Step=48500 Epoch=236.3] | Loss=0.01760 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.410 | L2-Norm(final)=14.709 | 5565.8 samples/s | 87.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=48501 Epoch=236.3] | Loss=0.00880 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=14.740 | 7255.3 samples/s | 113.4 steps/s
[Step=48550 Epoch=236.6] | Loss=0.01772 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.418 | L2-Norm(final)=14.743 | 4239.6 samples/s | 66.2 steps/s
[Step=48600 Epoch=236.8] | Loss=0.01570 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.427 | L2-Norm(final)=14.746 | 4666.2 samples/s | 72.9 steps/s
[Step=48650 Epoch=237.0] | Loss=0.01463 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.435 | L2-Norm(final)=14.749 | 4711.9 samples/s | 73.6 steps/s
[Step=48700 Epoch=237.3] | Loss=0.01360 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.443 | L2-Norm(final)=14.752 | 6777.3 samples/s | 105.9 steps/s
[Step=48750 Epoch=237.5] | Loss=0.01198 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.449 | L2-Norm(final)=14.756 | 2471.6 samples/s | 38.6 steps/s
[Step=48800 Epoch=237.8] | Loss=0.01087 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.455 | L2-Norm(final)=14.760 | 4713.5 samples/s | 73.6 steps/s
[Step=48850 Epoch=238.0] | Loss=0.01022 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.460 | L2-Norm(final)=14.764 | 4767.8 samples/s | 74.5 steps/s
[Step=48900 Epoch=238.3] | Loss=0.00966 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.465 | L2-Norm(final)=14.768 | 6154.5 samples/s | 96.2 steps/s
[Step=48950 Epoch=238.5] | Loss=0.00906 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.470 | L2-Norm(final)=14.772 | 2576.0 samples/s | 40.3 steps/s
[Step=49000 Epoch=238.8] | Loss=0.00852 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.475 | L2-Norm(final)=14.775 | 4637.4 samples/s | 72.5 steps/s
[Step=49050 Epoch=239.0] | Loss=0.00807 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.479 | L2-Norm(final)=14.779 | 4744.2 samples/s | 74.1 steps/s
[Step=49100 Epoch=239.2] | Loss=0.00780 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.483 | L2-Norm(final)=14.783 | 5708.2 samples/s | 89.2 steps/s
[Step=49150 Epoch=239.5] | Loss=0.00755 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.487 | L2-Norm(final)=14.786 | 2635.7 samples/s | 41.2 steps/s
[Step=49200 Epoch=239.7] | Loss=0.00725 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.491 | L2-Norm(final)=14.790 | 4782.4 samples/s | 74.7 steps/s
[Step=49250 Epoch=240.0] | Loss=0.00696 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.494 | L2-Norm(final)=14.793 | 4699.6 samples/s | 73.4 steps/s
[Step=49300 Epoch=240.2] | Loss=0.00678 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.498 | L2-Norm(final)=14.797 | 5303.2 samples/s | 82.9 steps/s
[Step=49350 Epoch=240.5] | Loss=0.00655 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.501 | L2-Norm(final)=14.800 | 2716.5 samples/s | 42.4 steps/s
[Step=49400 Epoch=240.7] | Loss=0.00636 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.504 | L2-Norm(final)=14.803 | 4832.3 samples/s | 75.5 steps/s
[Step=49450 Epoch=240.9] | Loss=0.00621 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.507 | L2-Norm(final)=14.806 | 4640.7 samples/s | 72.5 steps/s
[Step=49500 Epoch=241.2] | Loss=0.00605 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.511 | L2-Norm(final)=14.809 | 4847.8 samples/s | 75.7 steps/s
[Step=49550 Epoch=241.4] | Loss=0.00593 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=14.813 | 2865.4 samples/s | 44.8 steps/s
[Step=49600 Epoch=241.7] | Loss=0.00575 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.517 | L2-Norm(final)=14.816 | 4784.4 samples/s | 74.8 steps/s
[Step=49650 Epoch=241.9] | Loss=0.00559 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.519 | L2-Norm(final)=14.819 | 4671.2 samples/s | 73.0 steps/s
[Step=49700 Epoch=242.2] | Loss=0.00548 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.522 | L2-Norm(final)=14.822 | 4728.8 samples/s | 73.9 steps/s
[Step=49750 Epoch=242.4] | Loss=0.00543 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.525 | L2-Norm(final)=14.824 | 2926.6 samples/s | 45.7 steps/s
[Step=49800 Epoch=242.6] | Loss=0.00531 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.528 | L2-Norm(final)=14.827 | 4678.7 samples/s | 73.1 steps/s
[Step=49850 Epoch=242.9] | Loss=0.00527 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.530 | L2-Norm(final)=14.830 | 4742.1 samples/s | 74.1 steps/s
[Step=49900 Epoch=243.1] | Loss=0.00521 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.533 | L2-Norm(final)=14.833 | 4738.1 samples/s | 74.0 steps/s
[Step=49950 Epoch=243.4] | Loss=0.00514 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=14.836 | 2906.3 samples/s | 45.4 steps/s
[Step=50000 Epoch=243.6] | Loss=0.00504 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.538 | L2-Norm(final)=14.838 | 4753.4 samples/s | 74.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step50000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=40001 Epoch=195.1] | Loss=0.01257 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.410 | L2-Norm(final)=15.048 | 6661.0 samples/s | 104.1 steps/s
[Step=40050 Epoch=195.3] | Loss=0.01877 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.410 | L2-Norm(final)=15.052 | 5065.9 samples/s | 79.2 steps/s
[Step=40100 Epoch=195.6] | Loss=0.02016 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=15.057 | 5423.1 samples/s | 84.7 steps/s
[Step=40150 Epoch=195.8] | Loss=0.01813 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.410 | L2-Norm(final)=15.062 | 5563.7 samples/s | 86.9 steps/s
[Step=40200 Epoch=196.0] | Loss=0.01728 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=15.066 | 8524.5 samples/s | 133.2 steps/s
[Step=40250 Epoch=196.3] | Loss=0.01692 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.410 | L2-Norm(final)=15.070 | 2670.0 samples/s | 41.7 steps/s
[Step=40300 Epoch=196.5] | Loss=0.01686 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.410 | L2-Norm(final)=15.074 | 5446.4 samples/s | 85.1 steps/s
[Step=40350 Epoch=196.8] | Loss=0.01669 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.410 | L2-Norm(final)=15.078 | 5483.1 samples/s | 85.7 steps/s
[Step=40400 Epoch=197.0] | Loss=0.01715 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.410 | L2-Norm(final)=15.081 | 7699.4 samples/s | 120.3 steps/s
[Step=40450 Epoch=197.3] | Loss=0.01742 | Reg=0.00089 | acc=0.9531 | L2-Norm=9.410 | L2-Norm(final)=15.085 | 2785.6 samples/s | 43.5 steps/s
[Step=40500 Epoch=197.5] | Loss=0.01728 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.410 | L2-Norm(final)=15.088 | 5564.9 samples/s | 87.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=197.5] | Loss=0.00348 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=15.121 | 7084.0 samples/s | 110.7 steps/s
[Step=40550 Epoch=197.7] | Loss=0.01572 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.418 | L2-Norm(final)=15.122 | 4310.5 samples/s | 67.4 steps/s
[Step=40600 Epoch=198.0] | Loss=0.01462 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.427 | L2-Norm(final)=15.124 | 4741.9 samples/s | 74.1 steps/s
[Step=40650 Epoch=198.2] | Loss=0.01418 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.436 | L2-Norm(final)=15.126 | 4768.2 samples/s | 74.5 steps/s
[Step=40700 Epoch=198.5] | Loss=0.01333 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.444 | L2-Norm(final)=15.129 | 6730.5 samples/s | 105.2 steps/s
[Step=40750 Epoch=198.7] | Loss=0.01186 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.450 | L2-Norm(final)=15.132 | 2439.8 samples/s | 38.1 steps/s
[Step=40800 Epoch=199.0] | Loss=0.01080 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.457 | L2-Norm(final)=15.136 | 4742.2 samples/s | 74.1 steps/s
[Step=40850 Epoch=199.2] | Loss=0.00996 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.462 | L2-Norm(final)=15.140 | 4717.1 samples/s | 73.7 steps/s
[Step=40900 Epoch=199.5] | Loss=0.00935 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.467 | L2-Norm(final)=15.143 | 6197.2 samples/s | 96.8 steps/s
[Step=40950 Epoch=199.7] | Loss=0.00872 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.472 | L2-Norm(final)=15.147 | 2553.1 samples/s | 39.9 steps/s
[Step=41000 Epoch=199.9] | Loss=0.00815 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.476 | L2-Norm(final)=15.150 | 4817.9 samples/s | 75.3 steps/s
[Step=41050 Epoch=200.2] | Loss=0.00781 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.481 | L2-Norm(final)=15.153 | 4630.4 samples/s | 72.4 steps/s
[Step=41100 Epoch=200.4] | Loss=0.00755 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.485 | L2-Norm(final)=15.157 | 5659.6 samples/s | 88.4 steps/s
[Step=41150 Epoch=200.7] | Loss=0.00722 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.489 | L2-Norm(final)=15.160 | 2649.7 samples/s | 41.4 steps/s
[Step=41200 Epoch=200.9] | Loss=0.00688 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.492 | L2-Norm(final)=15.164 | 4746.7 samples/s | 74.2 steps/s
[Step=41250 Epoch=201.2] | Loss=0.00660 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.496 | L2-Norm(final)=15.167 | 4703.4 samples/s | 73.5 steps/s
[Step=41300 Epoch=201.4] | Loss=0.00643 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.499 | L2-Norm(final)=15.170 | 5200.8 samples/s | 81.3 steps/s
[Step=41350 Epoch=201.6] | Loss=0.00626 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.503 | L2-Norm(final)=15.173 | 2764.8 samples/s | 43.2 steps/s
[Step=41400 Epoch=201.9] | Loss=0.00602 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.506 | L2-Norm(final)=15.176 | 4693.3 samples/s | 73.3 steps/s
[Step=41450 Epoch=202.1] | Loss=0.00593 | Reg=0.00090 | acc=0.9531 | L2-Norm=9.509 | L2-Norm(final)=15.179 | 4720.2 samples/s | 73.8 steps/s
[Step=41500 Epoch=202.4] | Loss=0.00578 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.512 | L2-Norm(final)=15.182 | 4878.0 samples/s | 76.2 steps/s
[Step=41550 Epoch=202.6] | Loss=0.00565 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.515 | L2-Norm(final)=15.185 | 2861.3 samples/s | 44.7 steps/s
[Step=41600 Epoch=202.9] | Loss=0.00548 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.518 | L2-Norm(final)=15.188 | 4749.2 samples/s | 74.2 steps/s
[Step=41650 Epoch=203.1] | Loss=0.00535 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.521 | L2-Norm(final)=15.191 | 4660.6 samples/s | 72.8 steps/s
[Step=41700 Epoch=203.4] | Loss=0.00526 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.523 | L2-Norm(final)=15.194 | 4683.0 samples/s | 73.2 steps/s
[Step=41750 Epoch=203.6] | Loss=0.00519 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.526 | L2-Norm(final)=15.197 | 2953.2 samples/s | 46.1 steps/s
[Step=41800 Epoch=203.8] | Loss=0.00509 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.529 | L2-Norm(final)=15.199 | 4669.7 samples/s | 73.0 steps/s
[Step=41850 Epoch=204.1] | Loss=0.00500 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.531 | L2-Norm(final)=15.202 | 4738.8 samples/s | 74.0 steps/s
[Step=41900 Epoch=204.3] | Loss=0.00492 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.534 | L2-Norm(final)=15.205 | 4692.3 samples/s | 73.3 steps/s
[Step=41950 Epoch=204.6] | Loss=0.00482 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=15.207 | 2946.2 samples/s | 46.0 steps/s
[Step=42000 Epoch=204.8] | Loss=0.00472 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=15.210 | 4728.5 samples/s | 73.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step42000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=44001 Epoch=215.8] | Loss=0.00718 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=15.441 | 6350.7 samples/s | 99.2 steps/s
[Step=44050 Epoch=216.0] | Loss=0.01334 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.411 | L2-Norm(final)=15.447 | 5180.9 samples/s | 81.0 steps/s
[Step=44100 Epoch=216.3] | Loss=0.01749 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.411 | L2-Norm(final)=15.454 | 5573.5 samples/s | 87.1 steps/s
[Step=44150 Epoch=216.5] | Loss=0.01808 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.411 | L2-Norm(final)=15.458 | 5533.5 samples/s | 86.5 steps/s
[Step=44200 Epoch=216.7] | Loss=0.01819 | Reg=0.00089 | acc=0.9531 | L2-Norm=9.411 | L2-Norm(final)=15.463 | 8567.1 samples/s | 133.9 steps/s
[Step=44250 Epoch=217.0] | Loss=0.01809 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.411 | L2-Norm(final)=15.466 | 2616.2 samples/s | 40.9 steps/s
[Step=44300 Epoch=217.2] | Loss=0.01808 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.411 | L2-Norm(final)=15.470 | 5568.9 samples/s | 87.0 steps/s
[Step=44350 Epoch=217.5] | Loss=0.01805 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.411 | L2-Norm(final)=15.473 | 5461.2 samples/s | 85.3 steps/s
[Step=44400 Epoch=217.7] | Loss=0.01780 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.411 | L2-Norm(final)=15.477 | 8146.8 samples/s | 127.3 steps/s
[Step=44450 Epoch=218.0] | Loss=0.01790 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.411 | L2-Norm(final)=15.481 | 2700.1 samples/s | 42.2 steps/s
[Step=44500 Epoch=218.2] | Loss=0.01791 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.411 | L2-Norm(final)=15.484 | 5472.6 samples/s | 85.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=218.2] | Loss=0.01142 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.411 | L2-Norm(final)=15.521 | 7125.0 samples/s | 111.3 steps/s
[Step=44550 Epoch=218.5] | Loss=0.01766 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.419 | L2-Norm(final)=15.525 | 4200.1 samples/s | 65.6 steps/s
[Step=44600 Epoch=218.7] | Loss=0.01569 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.427 | L2-Norm(final)=15.527 | 4757.2 samples/s | 74.3 steps/s
[Step=44650 Epoch=219.0] | Loss=0.01496 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.433 | L2-Norm(final)=15.529 | 4816.6 samples/s | 75.3 steps/s
[Step=44700 Epoch=219.2] | Loss=0.01406 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.439 | L2-Norm(final)=15.532 | 6799.8 samples/s | 106.2 steps/s
[Step=44750 Epoch=219.4] | Loss=0.01267 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.445 | L2-Norm(final)=15.535 | 2451.1 samples/s | 38.3 steps/s
[Step=44800 Epoch=219.7] | Loss=0.01141 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.450 | L2-Norm(final)=15.539 | 4711.5 samples/s | 73.6 steps/s
[Step=44850 Epoch=219.9] | Loss=0.01054 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.454 | L2-Norm(final)=15.542 | 4727.1 samples/s | 73.9 steps/s
[Step=44900 Epoch=220.2] | Loss=0.00976 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.459 | L2-Norm(final)=15.545 | 6469.6 samples/s | 101.1 steps/s
[Step=44950 Epoch=220.4] | Loss=0.00917 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.463 | L2-Norm(final)=15.549 | 2499.2 samples/s | 39.1 steps/s
[Step=45000 Epoch=220.7] | Loss=0.00869 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.467 | L2-Norm(final)=15.552 | 4729.0 samples/s | 73.9 steps/s
[Step=45050 Epoch=220.9] | Loss=0.00825 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.470 | L2-Norm(final)=15.556 | 4662.0 samples/s | 72.8 steps/s
[Step=45100 Epoch=221.2] | Loss=0.00796 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.474 | L2-Norm(final)=15.559 | 6146.1 samples/s | 96.0 steps/s
[Step=45150 Epoch=221.4] | Loss=0.00761 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.477 | L2-Norm(final)=15.562 | 2518.1 samples/s | 39.3 steps/s
[Step=45200 Epoch=221.7] | Loss=0.00735 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.481 | L2-Norm(final)=15.566 | 4738.2 samples/s | 74.0 steps/s
[Step=45250 Epoch=221.9] | Loss=0.00706 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.484 | L2-Norm(final)=15.569 | 4728.4 samples/s | 73.9 steps/s
[Step=45300 Epoch=222.1] | Loss=0.00682 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.487 | L2-Norm(final)=15.572 | 5731.5 samples/s | 89.6 steps/s
[Step=45350 Epoch=222.4] | Loss=0.00659 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.490 | L2-Norm(final)=15.575 | 2601.7 samples/s | 40.7 steps/s
[Step=45400 Epoch=222.6] | Loss=0.00643 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.493 | L2-Norm(final)=15.578 | 4689.3 samples/s | 73.3 steps/s
[Step=45450 Epoch=222.9] | Loss=0.00628 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.496 | L2-Norm(final)=15.581 | 4696.2 samples/s | 73.4 steps/s
[Step=45500 Epoch=223.1] | Loss=0.00612 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.499 | L2-Norm(final)=15.584 | 5445.1 samples/s | 85.1 steps/s
[Step=45550 Epoch=223.4] | Loss=0.00600 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.502 | L2-Norm(final)=15.587 | 2681.0 samples/s | 41.9 steps/s
[Step=45600 Epoch=223.6] | Loss=0.00582 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.505 | L2-Norm(final)=15.590 | 4741.4 samples/s | 74.1 steps/s
[Step=45650 Epoch=223.9] | Loss=0.00569 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.507 | L2-Norm(final)=15.593 | 4687.2 samples/s | 73.2 steps/s
[Step=45700 Epoch=224.1] | Loss=0.00564 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.510 | L2-Norm(final)=15.596 | 5216.3 samples/s | 81.5 steps/s
[Step=45750 Epoch=224.4] | Loss=0.00549 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.512 | L2-Norm(final)=15.599 | 2777.5 samples/s | 43.4 steps/s
[Step=45800 Epoch=224.6] | Loss=0.00536 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.515 | L2-Norm(final)=15.601 | 4692.2 samples/s | 73.3 steps/s
[Step=45850 Epoch=224.8] | Loss=0.00526 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.517 | L2-Norm(final)=15.604 | 4762.9 samples/s | 74.4 steps/s
[Step=45900 Epoch=225.1] | Loss=0.00519 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.520 | L2-Norm(final)=15.607 | 4910.7 samples/s | 76.7 steps/s
[Step=45950 Epoch=225.3] | Loss=0.00509 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.522 | L2-Norm(final)=15.609 | 2827.0 samples/s | 44.2 steps/s
[Step=46000 Epoch=225.6] | Loss=0.00499 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.524 | L2-Norm(final)=15.612 | 4759.2 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step46000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=44001 Epoch=420.2] | Loss=0.00004 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=15.121 | 6618.5 samples/s | 103.4 steps/s
[Step=44050 Epoch=420.7] | Loss=0.00017 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.406 | L2-Norm(final)=15.125 | 4682.9 samples/s | 73.2 steps/s
[Step=44100 Epoch=421.1] | Loss=0.00021 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.406 | L2-Norm(final)=15.134 | 8409.9 samples/s | 131.4 steps/s
[Step=44150 Epoch=421.6] | Loss=0.00020 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.406 | L2-Norm(final)=15.142 | 2521.7 samples/s | 39.4 steps/s
[Step=44200 Epoch=422.1] | Loss=0.00021 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.406 | L2-Norm(final)=15.149 | 7469.6 samples/s | 116.7 steps/s
[Step=44250 Epoch=422.6] | Loss=0.00020 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.406 | L2-Norm(final)=15.156 | 2634.6 samples/s | 41.2 steps/s
[Step=44300 Epoch=423.0] | Loss=0.00021 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.406 | L2-Norm(final)=15.163 | 6751.1 samples/s | 105.5 steps/s
[Step=44350 Epoch=423.5] | Loss=0.00020 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.406 | L2-Norm(final)=15.169 | 2753.7 samples/s | 43.0 steps/s
[Step=44400 Epoch=424.0] | Loss=0.00020 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.406 | L2-Norm(final)=15.175 | 5973.3 samples/s | 93.3 steps/s
[Step=44450 Epoch=424.5] | Loss=0.00020 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.406 | L2-Norm(final)=15.181 | 2846.5 samples/s | 44.5 steps/s
[Step=44500 Epoch=424.9] | Loss=0.00020 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.406 | L2-Norm(final)=15.186 | 5655.8 samples/s | 88.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=425.0] | Loss=0.00016 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.406 | L2-Norm(final)=15.239 | 7090.6 samples/s | 110.8 steps/s
[Step=44550 Epoch=425.4] | Loss=0.00010 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=15.243 | 3994.7 samples/s | 62.4 steps/s
[Step=44600 Epoch=425.9] | Loss=0.00006 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.407 | L2-Norm(final)=15.244 | 6557.2 samples/s | 102.5 steps/s
[Step=44650 Epoch=426.4] | Loss=0.00004 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.402 | L2-Norm(final)=15.245 | 2355.7 samples/s | 36.8 steps/s
[Step=44700 Epoch=426.9] | Loss=0.00003 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.395 | L2-Norm(final)=15.246 | 6125.7 samples/s | 95.7 steps/s
[Step=44750 Epoch=427.3] | Loss=0.00003 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.387 | L2-Norm(final)=15.246 | 2409.3 samples/s | 37.6 steps/s
[Step=44800 Epoch=427.8] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.379 | L2-Norm(final)=15.247 | 5694.9 samples/s | 89.0 steps/s
[Step=44850 Epoch=428.3] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.371 | L2-Norm(final)=15.247 | 2497.8 samples/s | 39.0 steps/s
[Step=44900 Epoch=428.8] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.362 | L2-Norm(final)=15.247 | 5298.6 samples/s | 82.8 steps/s
[Step=44950 Epoch=429.2] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.354 | L2-Norm(final)=15.248 | 2603.6 samples/s | 40.7 steps/s
[Step=45000 Epoch=429.7] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.345 | L2-Norm(final)=15.248 | 4881.1 samples/s | 76.3 steps/s
[Step=45050 Epoch=430.2] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.336 | L2-Norm(final)=15.248 | 2713.0 samples/s | 42.4 steps/s
[Step=45100 Epoch=430.7] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.327 | L2-Norm(final)=15.249 | 4587.4 samples/s | 71.7 steps/s
[Step=45150 Epoch=431.2] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.318 | L2-Norm(final)=15.249 | 2791.4 samples/s | 43.6 steps/s
[Step=45200 Epoch=431.6] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.309 | L2-Norm(final)=15.249 | 4490.0 samples/s | 70.2 steps/s
[Step=45250 Epoch=432.1] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=15.249 | 2814.6 samples/s | 44.0 steps/s
[Step=45300 Epoch=432.6] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.290 | L2-Norm(final)=15.250 | 4573.7 samples/s | 71.5 steps/s
[Step=45350 Epoch=433.1] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.281 | L2-Norm(final)=15.250 | 2813.2 samples/s | 44.0 steps/s
[Step=45400 Epoch=433.5] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.271 | L2-Norm(final)=15.250 | 4474.6 samples/s | 69.9 steps/s
[Step=45450 Epoch=434.0] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.262 | L2-Norm(final)=15.250 | 2849.1 samples/s | 44.5 steps/s
[Step=45500 Epoch=434.5] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.252 | L2-Norm(final)=15.251 | 4521.8 samples/s | 70.7 steps/s
[Step=45550 Epoch=435.0] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.242 | L2-Norm(final)=15.251 | 7220.2 samples/s | 112.8 steps/s
[Step=45600 Epoch=435.5] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.233 | L2-Norm(final)=15.251 | 2282.6 samples/s | 35.7 steps/s
[Step=45650 Epoch=435.9] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.223 | L2-Norm(final)=15.251 | 6629.3 samples/s | 103.6 steps/s
[Step=45700 Epoch=436.4] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.213 | L2-Norm(final)=15.252 | 2361.5 samples/s | 36.9 steps/s
[Step=45750 Epoch=436.9] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.203 | L2-Norm(final)=15.252 | 6009.7 samples/s | 93.9 steps/s
[Step=45800 Epoch=437.4] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.193 | L2-Norm(final)=15.252 | 2436.8 samples/s | 38.1 steps/s
[Step=45850 Epoch=437.8] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.183 | L2-Norm(final)=15.252 | 5678.6 samples/s | 88.7 steps/s
[Step=45900 Epoch=438.3] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.172 | L2-Norm(final)=15.253 | 2516.5 samples/s | 39.3 steps/s
[Step=45950 Epoch=438.8] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.162 | L2-Norm(final)=15.253 | 5234.3 samples/s | 81.8 steps/s
[Step=46000 Epoch=439.3] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.151 | L2-Norm(final)=15.253 | 2598.8 samples/s | 40.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step46000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07905 | acc=0.9648 | tpr=0.9775 | fpr=0.0627 | 5855.3 samples/s | 22.9 steps/s
Avg test loss: 0.08339, Avg test acc: 0.96254, Avg tpr: 0.97622, Avg fpr: 0.06756, total FA: 527

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08834 | acc=0.9627 | tpr=0.9799 | fpr=0.0746 | 6106.4 samples/s | 23.9 steps/s
Avg test loss: 0.09138, Avg test acc: 0.96182, Avg tpr: 0.97814, Avg fpr: 0.07409, total FA: 578

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08567 | acc=0.9626 | tpr=0.9772 | fpr=0.0691 | 5990.3 samples/s | 23.4 steps/s
Avg test loss: 0.08803, Avg test acc: 0.96218, Avg tpr: 0.97540, Avg fpr: 0.06691, total FA: 522

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08155 | acc=0.9621 | tpr=0.9707 | fpr=0.0565 | 5911.2 samples/s | 23.1 steps/s
Avg test loss: 0.08691, Avg test acc: 0.96129, Avg tpr: 0.96998, Avg fpr: 0.05781, total FA: 451

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08526 | acc=0.9623 | tpr=0.9741 | fpr=0.0634 | 5854.7 samples/s | 22.9 steps/s
Avg test loss: 0.08852, Avg test acc: 0.96162, Avg tpr: 0.97261, Avg fpr: 0.06256, total FA: 488

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.16973 | acc=0.2797 | tpr=0.0203 | fpr=0.1571 | 5955.8 samples/s | 23.3 steps/s
Avg test loss: 6.17438, Avg test acc: 0.27879, Avg tpr: 0.01970, Avg fpr: 0.15139, total FA: 1181

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.66509 | acc=0.3106 | tpr=0.0259 | fpr=0.0711 | 5894.8 samples/s | 23.0 steps/s
Avg test loss: 4.67431, Avg test acc: 0.30800, Avg tpr: 0.02547, Avg fpr: 0.07063, total FA: 551

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.98430 | acc=0.2996 | tpr=0.0217 | fpr=0.0969 | 5737.3 samples/s | 22.4 steps/s
Avg test loss: 4.99021, Avg test acc: 0.29818, Avg tpr: 0.02092, Avg fpr: 0.09204, total FA: 718

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.20279 | acc=0.2759 | tpr=0.0249 | fpr=0.1791 | 5939.3 samples/s | 23.2 steps/s
Avg test loss: 5.20459, Avg test acc: 0.27578, Avg tpr: 0.02448, Avg fpr: 0.17152, total FA: 1338

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.47805 | acc=0.2924 | tpr=0.0203 | fpr=0.1167 | 5959.4 samples/s | 23.3 steps/s
Avg test loss: 4.49510, Avg test acc: 0.29169, Avg tpr: 0.02005, Avg fpr: 0.11088, total FA: 865

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.27028 | acc=0.1180 | tpr=0.6504 | fpr=0.8916 | 6109.4 samples/s | 23.9 steps/s
[Step= 100] | Loss=5.25690 | acc=0.1187 | tpr=0.6311 | fpr=0.8908 | 7211.9 samples/s | 28.2 steps/s
[Step= 150] | Loss=5.24645 | acc=0.1206 | tpr=0.6441 | fpr=0.8891 | 6077.3 samples/s | 23.7 steps/s
[Step= 200] | Loss=5.23550 | acc=0.1211 | tpr=0.6393 | fpr=0.8883 | 8176.3 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.24255 | acc=0.1209 | tpr=0.6332 | fpr=0.8884 | 7623.9 samples/s | 29.8 steps/s
[Step= 300] | Loss=5.23644 | acc=0.1206 | tpr=0.6262 | fpr=0.8886 | 8050.0 samples/s | 31.4 steps/s
[Step= 350] | Loss=5.24124 | acc=0.1208 | tpr=0.6218 | fpr=0.8883 | 8085.2 samples/s | 31.6 steps/s
[Step= 400] | Loss=5.23873 | acc=0.1211 | tpr=0.6204 | fpr=0.8880 | 7948.5 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.24422 | acc=0.1208 | tpr=0.6232 | fpr=0.8884 | 8001.2 samples/s | 31.3 steps/s
[Step= 500] | Loss=5.24439 | acc=0.1207 | tpr=0.6286 | fpr=0.8885 | 7849.8 samples/s | 30.7 steps/s
[Step= 550] | Loss=5.24716 | acc=0.1207 | tpr=0.6299 | fpr=0.8885 | 10608.6 samples/s | 41.4 steps/s
Avg test loss: 5.24747, Avg test acc: 0.12063, Avg tpr: 0.63074, Avg fpr: 0.88864, total FA: 123386

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.19149 | acc=0.1195 | tpr=0.5973 | fpr=0.8891 | 5958.1 samples/s | 23.3 steps/s
[Step= 100] | Loss=5.18289 | acc=0.1225 | tpr=0.6077 | fpr=0.8866 | 8069.9 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.17182 | acc=0.1250 | tpr=0.6282 | fpr=0.8842 | 6222.4 samples/s | 24.3 steps/s
[Step= 200] | Loss=5.16336 | acc=0.1256 | tpr=0.6262 | fpr=0.8835 | 8273.3 samples/s | 32.3 steps/s
[Step= 250] | Loss=5.16874 | acc=0.1254 | tpr=0.6227 | fpr=0.8837 | 7581.1 samples/s | 29.6 steps/s
[Step= 300] | Loss=5.16458 | acc=0.1248 | tpr=0.6189 | fpr=0.8842 | 8086.0 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.16947 | acc=0.1246 | tpr=0.6168 | fpr=0.8843 | 7931.1 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.16717 | acc=0.1246 | tpr=0.6165 | fpr=0.8843 | 7596.1 samples/s | 29.7 steps/s
[Step= 450] | Loss=5.17144 | acc=0.1241 | tpr=0.6227 | fpr=0.8849 | 7575.4 samples/s | 29.6 steps/s
[Step= 500] | Loss=5.17297 | acc=0.1239 | tpr=0.6247 | fpr=0.8852 | 7896.6 samples/s | 30.8 steps/s
[Step= 550] | Loss=5.17645 | acc=0.1241 | tpr=0.6267 | fpr=0.8850 | 10512.8 samples/s | 41.1 steps/s
Avg test loss: 5.17682, Avg test acc: 0.12404, Avg tpr: 0.62797, Avg fpr: 0.88512, total FA: 122897

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.41462 | acc=0.1128 | tpr=0.6327 | fpr=0.8965 | 5916.7 samples/s | 23.1 steps/s
[Step= 100] | Loss=5.39851 | acc=0.1144 | tpr=0.6205 | fpr=0.8951 | 6087.7 samples/s | 23.8 steps/s
[Step= 150] | Loss=5.38884 | acc=0.1165 | tpr=0.6326 | fpr=0.8930 | 8168.6 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.37946 | acc=0.1169 | tpr=0.6240 | fpr=0.8923 | 7824.3 samples/s | 30.6 steps/s
[Step= 250] | Loss=5.38569 | acc=0.1166 | tpr=0.6218 | fpr=0.8926 | 7922.7 samples/s | 30.9 steps/s
[Step= 300] | Loss=5.38138 | acc=0.1164 | tpr=0.6175 | fpr=0.8927 | 7891.6 samples/s | 30.8 steps/s
[Step= 350] | Loss=5.38590 | acc=0.1161 | tpr=0.6174 | fpr=0.8929 | 8099.9 samples/s | 31.6 steps/s
[Step= 400] | Loss=5.38455 | acc=0.1163 | tpr=0.6165 | fpr=0.8928 | 7884.8 samples/s | 30.8 steps/s
[Step= 450] | Loss=5.38970 | acc=0.1158 | tpr=0.6183 | fpr=0.8934 | 8041.4 samples/s | 31.4 steps/s
[Step= 500] | Loss=5.38933 | acc=0.1156 | tpr=0.6185 | fpr=0.8935 | 7508.7 samples/s | 29.3 steps/s
[Step= 550] | Loss=5.39178 | acc=0.1159 | tpr=0.6192 | fpr=0.8933 | 10204.8 samples/s | 39.9 steps/s
Avg test loss: 5.39224, Avg test acc: 0.11579, Avg tpr: 0.62005, Avg fpr: 0.89337, total FA: 124043

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.71430 | acc=0.1375 | tpr=0.6150 | fpr=0.8711 | 5956.1 samples/s | 23.3 steps/s
[Step= 100] | Loss=4.70431 | acc=0.1409 | tpr=0.6119 | fpr=0.8679 | 5794.2 samples/s | 22.6 steps/s
[Step= 150] | Loss=4.69226 | acc=0.1426 | tpr=0.6254 | fpr=0.8663 | 8638.0 samples/s | 33.7 steps/s
[Step= 200] | Loss=4.68184 | acc=0.1431 | tpr=0.6197 | fpr=0.8656 | 8465.3 samples/s | 33.1 steps/s
[Step= 250] | Loss=4.68600 | acc=0.1427 | tpr=0.6087 | fpr=0.8658 | 7989.1 samples/s | 31.2 steps/s
[Step= 300] | Loss=4.68167 | acc=0.1423 | tpr=0.6029 | fpr=0.8661 | 7178.7 samples/s | 28.0 steps/s
[Step= 350] | Loss=4.68663 | acc=0.1423 | tpr=0.6024 | fpr=0.8660 | 8453.7 samples/s | 33.0 steps/s
[Step= 400] | Loss=4.68537 | acc=0.1428 | tpr=0.6039 | fpr=0.8656 | 7867.7 samples/s | 30.7 steps/s
[Step= 450] | Loss=4.69026 | acc=0.1422 | tpr=0.6066 | fpr=0.8663 | 7997.5 samples/s | 31.2 steps/s
[Step= 500] | Loss=4.69004 | acc=0.1421 | tpr=0.6084 | fpr=0.8663 | 7720.5 samples/s | 30.2 steps/s
[Step= 550] | Loss=4.69425 | acc=0.1421 | tpr=0.6100 | fpr=0.8664 | 10171.6 samples/s | 39.7 steps/s
Avg test loss: 4.69484, Avg test acc: 0.14204, Avg tpr: 0.61133, Avg fpr: 0.86649, total FA: 120311

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.00146 | acc=0.1298 | tpr=0.5088 | fpr=0.8770 | 5879.7 samples/s | 23.0 steps/s
[Step= 100] | Loss=4.99150 | acc=0.1316 | tpr=0.4883 | fpr=0.8750 | 6046.4 samples/s | 23.6 steps/s
[Step= 150] | Loss=4.98036 | acc=0.1334 | tpr=0.5101 | fpr=0.8735 | 7983.6 samples/s | 31.2 steps/s
[Step= 200] | Loss=4.97290 | acc=0.1341 | tpr=0.5082 | fpr=0.8727 | 8870.0 samples/s | 34.6 steps/s
[Step= 250] | Loss=4.97923 | acc=0.1337 | tpr=0.4961 | fpr=0.8729 | 7076.4 samples/s | 27.6 steps/s
[Step= 300] | Loss=4.97594 | acc=0.1336 | tpr=0.4880 | fpr=0.8729 | 8052.7 samples/s | 31.5 steps/s
[Step= 350] | Loss=4.98207 | acc=0.1335 | tpr=0.4884 | fpr=0.8729 | 8660.4 samples/s | 33.8 steps/s
[Step= 400] | Loss=4.97891 | acc=0.1336 | tpr=0.4880 | fpr=0.8728 | 7928.5 samples/s | 31.0 steps/s
[Step= 450] | Loss=4.98313 | acc=0.1331 | tpr=0.4907 | fpr=0.8734 | 7066.4 samples/s | 27.6 steps/s
[Step= 500] | Loss=4.98277 | acc=0.1330 | tpr=0.4925 | fpr=0.8735 | 8566.9 samples/s | 33.5 steps/s
[Step= 550] | Loss=4.98537 | acc=0.1331 | tpr=0.4883 | fpr=0.8734 | 9576.6 samples/s | 37.4 steps/s
Avg test loss: 4.98596, Avg test acc: 0.13298, Avg tpr: 0.48891, Avg fpr: 0.87349, total FA: 121282

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.22570 | acc=0.9580 | tpr=0.9513 | fpr=0.0418 | 4698.6 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.23417 | acc=0.9574 | tpr=0.9595 | fpr=0.0426 | 8323.2 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.23649 | acc=0.9559 | tpr=0.9568 | fpr=0.0442 | 8425.4 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.23671 | acc=0.9559 | tpr=0.9607 | fpr=0.0442 | 7712.1 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.23701 | acc=0.9557 | tpr=0.9581 | fpr=0.0443 | 7943.2 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.24060 | acc=0.9554 | tpr=0.9564 | fpr=0.0446 | 7640.1 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.23867 | acc=0.9556 | tpr=0.9555 | fpr=0.0444 | 8092.5 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.23846 | acc=0.9553 | tpr=0.9535 | fpr=0.0446 | 8027.5 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.24193 | acc=0.9549 | tpr=0.9523 | fpr=0.0450 | 7632.2 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.24242 | acc=0.9548 | tpr=0.9533 | fpr=0.0452 | 7665.5 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.24116 | acc=0.9550 | tpr=0.9538 | fpr=0.0450 | 10326.8 samples/s | 40.3 steps/s
Avg test loss: 0.24085, Avg test acc: 0.95503, Avg tpr: 0.95365, Avg fpr: 0.04494, total FA: 6240

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16702 | acc=0.9615 | tpr=0.9204 | fpr=0.0378 | 6031.2 samples/s | 23.6 steps/s
[Step= 100] | Loss=0.17437 | acc=0.9605 | tpr=0.9275 | fpr=0.0389 | 7547.7 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.17684 | acc=0.9591 | tpr=0.9323 | fpr=0.0404 | 7295.4 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.17725 | acc=0.9592 | tpr=0.9355 | fpr=0.0404 | 7741.4 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.17675 | acc=0.9593 | tpr=0.9362 | fpr=0.0403 | 6143.0 samples/s | 24.0 steps/s
[Step= 300] | Loss=0.17948 | acc=0.9589 | tpr=0.9331 | fpr=0.0407 | 8131.2 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.17804 | acc=0.9590 | tpr=0.9336 | fpr=0.0406 | 8667.0 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.17840 | acc=0.9588 | tpr=0.9311 | fpr=0.0407 | 7285.1 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.18104 | acc=0.9584 | tpr=0.9309 | fpr=0.0411 | 8420.1 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.18071 | acc=0.9584 | tpr=0.9330 | fpr=0.0412 | 8361.9 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.17970 | acc=0.9586 | tpr=0.9347 | fpr=0.0410 | 10346.0 samples/s | 40.4 steps/s
Avg test loss: 0.17949, Avg test acc: 0.95861, Avg tpr: 0.93463, Avg fpr: 0.04095, total FA: 5686

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26253 | acc=0.9496 | tpr=0.9469 | fpr=0.0503 | 6088.3 samples/s | 23.8 steps/s
[Step= 100] | Loss=0.27093 | acc=0.9487 | tpr=0.9595 | fpr=0.0515 | 7504.4 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.27587 | acc=0.9477 | tpr=0.9611 | fpr=0.0525 | 8510.9 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.27592 | acc=0.9478 | tpr=0.9639 | fpr=0.0525 | 5856.4 samples/s | 22.9 steps/s
[Step= 250] | Loss=0.27625 | acc=0.9478 | tpr=0.9642 | fpr=0.0525 | 8105.6 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.27908 | acc=0.9475 | tpr=0.9615 | fpr=0.0528 | 7617.1 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.27671 | acc=0.9475 | tpr=0.9606 | fpr=0.0527 | 7597.5 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.27669 | acc=0.9471 | tpr=0.9590 | fpr=0.0531 | 7685.6 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.28014 | acc=0.9467 | tpr=0.9581 | fpr=0.0535 | 8238.0 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.28068 | acc=0.9467 | tpr=0.9586 | fpr=0.0535 | 8149.3 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.27906 | acc=0.9470 | tpr=0.9590 | fpr=0.0532 | 10178.4 samples/s | 39.8 steps/s
Avg test loss: 0.27886, Avg test acc: 0.94705, Avg tpr: 0.95880, Avg fpr: 0.05317, total FA: 7382

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15832 | acc=0.9649 | tpr=0.9425 | fpr=0.0347 | 5977.7 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.16525 | acc=0.9635 | tpr=0.9446 | fpr=0.0362 | 7458.9 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.16670 | acc=0.9615 | tpr=0.9380 | fpr=0.0381 | 8089.7 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.16657 | acc=0.9615 | tpr=0.9421 | fpr=0.0381 | 5888.1 samples/s | 23.0 steps/s
[Step= 250] | Loss=0.16649 | acc=0.9614 | tpr=0.9406 | fpr=0.0382 | 8323.9 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.16928 | acc=0.9611 | tpr=0.9418 | fpr=0.0385 | 7265.2 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.16784 | acc=0.9611 | tpr=0.9399 | fpr=0.0385 | 8073.1 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.16740 | acc=0.9609 | tpr=0.9371 | fpr=0.0387 | 8306.2 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.16978 | acc=0.9605 | tpr=0.9372 | fpr=0.0391 | 8153.8 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.17000 | acc=0.9604 | tpr=0.9392 | fpr=0.0392 | 7935.4 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.16894 | acc=0.9607 | tpr=0.9399 | fpr=0.0390 | 9945.9 samples/s | 38.9 steps/s
Avg test loss: 0.16869, Avg test acc: 0.96066, Avg tpr: 0.93978, Avg fpr: 0.03896, total FA: 5410

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.20353 | acc=0.9555 | tpr=0.9425 | fpr=0.0443 | 5812.4 samples/s | 22.7 steps/s
[Step= 100] | Loss=0.21180 | acc=0.9545 | tpr=0.9531 | fpr=0.0455 | 7533.0 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.21472 | acc=0.9530 | tpr=0.9568 | fpr=0.0471 | 8245.8 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.21487 | acc=0.9530 | tpr=0.9585 | fpr=0.0471 | 5589.1 samples/s | 21.8 steps/s
[Step= 250] | Loss=0.21534 | acc=0.9531 | tpr=0.9581 | fpr=0.0470 | 8339.8 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.21858 | acc=0.9526 | tpr=0.9549 | fpr=0.0475 | 8278.3 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.21739 | acc=0.9526 | tpr=0.9549 | fpr=0.0474 | 8100.0 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.21767 | acc=0.9523 | tpr=0.9524 | fpr=0.0477 | 7887.6 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.22087 | acc=0.9519 | tpr=0.9518 | fpr=0.0481 | 7977.3 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.22081 | acc=0.9518 | tpr=0.9520 | fpr=0.0482 | 8087.4 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.21943 | acc=0.9521 | tpr=0.9526 | fpr=0.0479 | 10056.2 samples/s | 39.3 steps/s
Avg test loss: 0.21923, Avg test acc: 0.95211, Avg tpr: 0.95246, Avg fpr: 0.04790, total FA: 6651

server round 49/50

clients selected: [0 2 3 4 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=48001 Epoch=234.1] | Loss=0.00680 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=14.130 | 7012.2 samples/s | 109.6 steps/s
[Step=48050 Epoch=234.3] | Loss=0.02651 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.359 | L2-Norm(final)=14.132 | 4972.1 samples/s | 77.7 steps/s
[Step=48100 Epoch=234.5] | Loss=0.02574 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=14.136 | 5400.1 samples/s | 84.4 steps/s
[Step=48150 Epoch=234.8] | Loss=0.02489 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.359 | L2-Norm(final)=14.140 | 5529.7 samples/s | 86.4 steps/s
[Step=48200 Epoch=235.0] | Loss=0.02446 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.359 | L2-Norm(final)=14.143 | 8554.4 samples/s | 133.7 steps/s
[Step=48250 Epoch=235.3] | Loss=0.02395 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=14.147 | 2661.0 samples/s | 41.6 steps/s
[Step=48300 Epoch=235.5] | Loss=0.02410 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=14.150 | 5464.8 samples/s | 85.4 steps/s
[Step=48350 Epoch=235.8] | Loss=0.02376 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=14.153 | 5600.5 samples/s | 87.5 steps/s
[Step=48400 Epoch=236.0] | Loss=0.02372 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.359 | L2-Norm(final)=14.156 | 7404.6 samples/s | 115.7 steps/s
[Step=48450 Epoch=236.3] | Loss=0.02323 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=14.159 | 2760.8 samples/s | 43.1 steps/s
[Step=48500 Epoch=236.5] | Loss=0.02277 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=14.162 | 5582.6 samples/s | 87.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_0/client_state-step48500.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=50001 Epoch=243.6] | Loss=0.00474 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=14.916 | 6613.6 samples/s | 103.3 steps/s
[Step=50050 Epoch=243.9] | Loss=0.01699 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=14.920 | 5065.9 samples/s | 79.2 steps/s
[Step=50100 Epoch=244.1] | Loss=0.01627 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.359 | L2-Norm(final)=14.923 | 5577.9 samples/s | 87.2 steps/s
[Step=50150 Epoch=244.4] | Loss=0.01674 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=14.927 | 5458.9 samples/s | 85.3 steps/s
[Step=50200 Epoch=244.6] | Loss=0.01702 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.359 | L2-Norm(final)=14.930 | 8637.4 samples/s | 135.0 steps/s
[Step=50250 Epoch=244.8] | Loss=0.01649 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.359 | L2-Norm(final)=14.934 | 2641.6 samples/s | 41.3 steps/s
[Step=50300 Epoch=245.1] | Loss=0.01701 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=14.938 | 5469.3 samples/s | 85.5 steps/s
[Step=50350 Epoch=245.3] | Loss=0.01701 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.359 | L2-Norm(final)=14.941 | 5674.3 samples/s | 88.7 steps/s
[Step=50400 Epoch=245.6] | Loss=0.01717 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.359 | L2-Norm(final)=14.945 | 7304.4 samples/s | 114.1 steps/s
[Step=50450 Epoch=245.8] | Loss=0.01715 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.359 | L2-Norm(final)=14.948 | 2817.6 samples/s | 44.0 steps/s
[Step=50500 Epoch=246.1] | Loss=0.01710 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.359 | L2-Norm(final)=14.951 | 5474.7 samples/s | 85.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_2/client_state-step50500.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=42001 Epoch=204.8] | Loss=0.02193 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.359 | L2-Norm(final)=15.290 | 7934.2 samples/s | 124.0 steps/s
[Step=42050 Epoch=205.1] | Loss=0.01682 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=15.291 | 4564.1 samples/s | 71.3 steps/s
[Step=42100 Epoch=205.3] | Loss=0.01876 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=15.294 | 5486.0 samples/s | 85.7 steps/s
[Step=42150 Epoch=205.5] | Loss=0.01793 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=15.296 | 5465.3 samples/s | 85.4 steps/s
[Step=42200 Epoch=205.8] | Loss=0.01763 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=15.299 | 8726.1 samples/s | 136.3 steps/s
[Step=42250 Epoch=206.0] | Loss=0.01777 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=15.302 | 2346.2 samples/s | 36.7 steps/s
[Step=42300 Epoch=206.3] | Loss=0.01779 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.359 | L2-Norm(final)=15.304 | 5493.8 samples/s | 85.8 steps/s
[Step=42350 Epoch=206.5] | Loss=0.01771 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.359 | L2-Norm(final)=15.306 | 5591.6 samples/s | 87.4 steps/s
[Step=42400 Epoch=206.8] | Loss=0.01738 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.359 | L2-Norm(final)=15.308 | 7456.3 samples/s | 116.5 steps/s
[Step=42450 Epoch=207.0] | Loss=0.01762 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=15.310 | 1998.8 samples/s | 31.2 steps/s
[Step=42500 Epoch=207.3] | Loss=0.01756 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.359 | L2-Norm(final)=15.312 | 5530.2 samples/s | 86.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_3/client_state-step42500.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=46001 Epoch=225.6] | Loss=0.02563 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.359 | L2-Norm(final)=15.689 | 7321.3 samples/s | 114.4 steps/s
[Step=46050 Epoch=225.8] | Loss=0.01821 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.359 | L2-Norm(final)=15.691 | 4714.8 samples/s | 73.7 steps/s
[Step=46100 Epoch=226.1] | Loss=0.01793 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=15.690 | 5443.2 samples/s | 85.1 steps/s
[Step=46150 Epoch=226.3] | Loss=0.01705 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=15.690 | 5526.4 samples/s | 86.3 steps/s
[Step=46200 Epoch=226.6] | Loss=0.01756 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.359 | L2-Norm(final)=15.691 | 8666.8 samples/s | 135.4 steps/s
[Step=46250 Epoch=226.8] | Loss=0.01819 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.360 | L2-Norm(final)=15.690 | 2657.9 samples/s | 41.5 steps/s
[Step=46300 Epoch=227.0] | Loss=0.01797 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.360 | L2-Norm(final)=15.690 | 5621.2 samples/s | 87.8 steps/s
[Step=46350 Epoch=227.3] | Loss=0.01772 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.360 | L2-Norm(final)=15.689 | 5269.1 samples/s | 82.3 steps/s
[Step=46400 Epoch=227.5] | Loss=0.01788 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.360 | L2-Norm(final)=15.690 | 8141.4 samples/s | 127.2 steps/s
[Step=46450 Epoch=227.8] | Loss=0.01766 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.360 | L2-Norm(final)=15.690 | 2740.9 samples/s | 42.8 steps/s
[Step=46500 Epoch=228.0] | Loss=0.01760 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.360 | L2-Norm(final)=15.691 | 5267.8 samples/s | 82.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_asml1_4/client_state-step46500.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=46001 Epoch=439.3] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=15.262 | 6483.6 samples/s | 101.3 steps/s
[Step=46050 Epoch=439.7] | Loss=0.00020 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.355 | L2-Norm(final)=15.268 | 4703.3 samples/s | 73.5 steps/s
[Step=46100 Epoch=440.2] | Loss=0.00019 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.355 | L2-Norm(final)=15.274 | 8368.1 samples/s | 130.8 steps/s
[Step=46150 Epoch=440.7] | Loss=0.00019 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.355 | L2-Norm(final)=15.282 | 2506.6 samples/s | 39.2 steps/s
[Step=46200 Epoch=441.2] | Loss=0.00018 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.354 | L2-Norm(final)=15.289 | 7568.5 samples/s | 118.3 steps/s
[Step=46250 Epoch=441.7] | Loss=0.00018 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.354 | L2-Norm(final)=15.295 | 2627.4 samples/s | 41.1 steps/s
[Step=46300 Epoch=442.1] | Loss=0.00018 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.354 | L2-Norm(final)=15.301 | 6820.1 samples/s | 106.6 steps/s
[Step=46350 Epoch=442.6] | Loss=0.00018 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.354 | L2-Norm(final)=15.307 | 2720.0 samples/s | 42.5 steps/s
[Step=46400 Epoch=443.1] | Loss=0.00018 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.354 | L2-Norm(final)=15.313 | 6193.0 samples/s | 96.8 steps/s
[Step=46450 Epoch=443.6] | Loss=0.00018 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.354 | L2-Norm(final)=15.319 | 2824.3 samples/s | 44.1 steps/s
[Step=46500 Epoch=444.0] | Loss=0.00018 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.354 | L2-Norm(final)=15.325 | 5786.0 samples/s | 90.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch17/client_iccad2012_2/client_state-step46500.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06237 | acc=0.9646 | tpr=0.9752 | fpr=0.0585 | 5782.9 samples/s | 22.6 steps/s
Avg test loss: 0.06532, Avg test acc: 0.96366, Avg tpr: 0.97412, Avg fpr: 0.05935, total FA: 463

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08834 | acc=0.9627 | tpr=0.9799 | fpr=0.0746 | 5919.9 samples/s | 23.1 steps/s
Avg test loss: 0.09138, Avg test acc: 0.96182, Avg tpr: 0.97814, Avg fpr: 0.07409, total FA: 578

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.06520 | acc=0.9642 | tpr=0.9712 | fpr=0.0510 | 6003.9 samples/s | 23.5 steps/s
Avg test loss: 0.06899, Avg test acc: 0.96298, Avg tpr: 0.96981, Avg fpr: 0.05204, total FA: 406

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.06601 | acc=0.9637 | tpr=0.9712 | fpr=0.0525 | 6023.4 samples/s | 23.5 steps/s
Avg test loss: 0.06948, Avg test acc: 0.96282, Avg tpr: 0.96998, Avg fpr: 0.05294, total FA: 413

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.06663 | acc=0.9639 | tpr=0.9688 | fpr=0.0468 | 5945.6 samples/s | 23.2 steps/s
Avg test loss: 0.07048, Avg test acc: 0.96222, Avg tpr: 0.96672, Avg fpr: 0.04769, total FA: 372

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.16973 | acc=0.2797 | tpr=0.0203 | fpr=0.1571 | 6065.3 samples/s | 23.7 steps/s
Avg test loss: 6.17438, Avg test acc: 0.27879, Avg tpr: 0.01970, Avg fpr: 0.15139, total FA: 1181

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.66509 | acc=0.3106 | tpr=0.0259 | fpr=0.0711 | 5578.1 samples/s | 21.8 steps/s
Avg test loss: 4.67431, Avg test acc: 0.30800, Avg tpr: 0.02547, Avg fpr: 0.07063, total FA: 551

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=3.81524 | acc=0.2947 | tpr=0.0407 | fpr=0.1539 | 5858.1 samples/s | 22.9 steps/s
Avg test loss: 3.81739, Avg test acc: 0.29413, Avg tpr: 0.03946, Avg fpr: 0.14575, total FA: 1137

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.20279 | acc=0.2759 | tpr=0.0249 | fpr=0.1791 | 5996.0 samples/s | 23.4 steps/s
Avg test loss: 5.20459, Avg test acc: 0.27578, Avg tpr: 0.02448, Avg fpr: 0.17152, total FA: 1338

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.47805 | acc=0.2924 | tpr=0.0203 | fpr=0.1167 | 5799.8 samples/s | 22.7 steps/s
Avg test loss: 4.49510, Avg test acc: 0.29169, Avg tpr: 0.02005, Avg fpr: 0.11088, total FA: 865

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.45641 | acc=0.1331 | tpr=0.5575 | fpr=0.8745 | 5724.5 samples/s | 22.4 steps/s
[Step= 100] | Loss=3.45066 | acc=0.1346 | tpr=0.5437 | fpr=0.8730 | 8261.9 samples/s | 32.3 steps/s
[Step= 150] | Loss=3.44433 | acc=0.1361 | tpr=0.5692 | fpr=0.8719 | 7920.7 samples/s | 30.9 steps/s
[Step= 200] | Loss=3.43760 | acc=0.1365 | tpr=0.5727 | fpr=0.8715 | 8348.1 samples/s | 32.6 steps/s
[Step= 250] | Loss=3.44277 | acc=0.1361 | tpr=0.5642 | fpr=0.8717 | 7474.0 samples/s | 29.2 steps/s
[Step= 300] | Loss=3.43987 | acc=0.1358 | tpr=0.5607 | fpr=0.8719 | 7946.3 samples/s | 31.0 steps/s
[Step= 350] | Loss=3.44338 | acc=0.1360 | tpr=0.5585 | fpr=0.8717 | 7066.8 samples/s | 27.6 steps/s
[Step= 400] | Loss=3.44181 | acc=0.1360 | tpr=0.5574 | fpr=0.8717 | 8310.1 samples/s | 32.5 steps/s
[Step= 450] | Loss=3.44522 | acc=0.1355 | tpr=0.5628 | fpr=0.8723 | 8185.6 samples/s | 32.0 steps/s
[Step= 500] | Loss=3.44533 | acc=0.1354 | tpr=0.5652 | fpr=0.8724 | 8667.3 samples/s | 33.9 steps/s
[Step= 550] | Loss=3.44766 | acc=0.1354 | tpr=0.5667 | fpr=0.8724 | 11038.4 samples/s | 43.1 steps/s
Avg test loss: 3.44790, Avg test acc: 0.13530, Avg tpr: 0.56775, Avg fpr: 0.87257, total FA: 121154

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.19149 | acc=0.1195 | tpr=0.5973 | fpr=0.8891 | 6215.3 samples/s | 24.3 steps/s
[Step= 100] | Loss=5.18289 | acc=0.1225 | tpr=0.6077 | fpr=0.8866 | 7103.9 samples/s | 27.7 steps/s
[Step= 150] | Loss=5.17182 | acc=0.1250 | tpr=0.6282 | fpr=0.8842 | 7501.2 samples/s | 29.3 steps/s
[Step= 200] | Loss=5.16336 | acc=0.1256 | tpr=0.6262 | fpr=0.8835 | 8083.0 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.16874 | acc=0.1254 | tpr=0.6227 | fpr=0.8837 | 8198.9 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.16458 | acc=0.1248 | tpr=0.6189 | fpr=0.8842 | 8543.4 samples/s | 33.4 steps/s
[Step= 350] | Loss=5.16947 | acc=0.1246 | tpr=0.6168 | fpr=0.8843 | 8291.8 samples/s | 32.4 steps/s
[Step= 400] | Loss=5.16717 | acc=0.1246 | tpr=0.6165 | fpr=0.8843 | 8039.7 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.17144 | acc=0.1241 | tpr=0.6227 | fpr=0.8849 | 7685.5 samples/s | 30.0 steps/s
[Step= 500] | Loss=5.17297 | acc=0.1239 | tpr=0.6247 | fpr=0.8852 | 7548.2 samples/s | 29.5 steps/s
[Step= 550] | Loss=5.17645 | acc=0.1241 | tpr=0.6267 | fpr=0.8850 | 10886.5 samples/s | 42.5 steps/s
Avg test loss: 5.17682, Avg test acc: 0.12404, Avg tpr: 0.62797, Avg fpr: 0.88512, total FA: 122897

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=3.53168 | acc=0.1357 | tpr=0.4823 | fpr=0.8705 | 5765.1 samples/s | 22.5 steps/s
[Step= 100] | Loss=3.52603 | acc=0.1373 | tpr=0.4776 | fpr=0.8690 | 8208.5 samples/s | 32.1 steps/s
[Step= 150] | Loss=3.51832 | acc=0.1393 | tpr=0.5058 | fpr=0.8674 | 8182.7 samples/s | 32.0 steps/s
[Step= 200] | Loss=3.51131 | acc=0.1400 | tpr=0.4984 | fpr=0.8665 | 8141.4 samples/s | 31.8 steps/s
[Step= 250] | Loss=3.51637 | acc=0.1397 | tpr=0.4917 | fpr=0.8668 | 7472.4 samples/s | 29.2 steps/s
[Step= 300] | Loss=3.51330 | acc=0.1397 | tpr=0.4844 | fpr=0.8666 | 8007.7 samples/s | 31.3 steps/s
[Step= 350] | Loss=3.51682 | acc=0.1398 | tpr=0.4847 | fpr=0.8664 | 8206.6 samples/s | 32.1 steps/s
[Step= 400] | Loss=3.51498 | acc=0.1400 | tpr=0.4858 | fpr=0.8663 | 8013.7 samples/s | 31.3 steps/s
[Step= 450] | Loss=3.51814 | acc=0.1396 | tpr=0.4903 | fpr=0.8668 | 8189.9 samples/s | 32.0 steps/s
[Step= 500] | Loss=3.51814 | acc=0.1395 | tpr=0.4925 | fpr=0.8669 | 7930.0 samples/s | 31.0 steps/s
[Step= 550] | Loss=3.52062 | acc=0.1395 | tpr=0.4899 | fpr=0.8669 | 9613.2 samples/s | 37.6 steps/s
Avg test loss: 3.52089, Avg test acc: 0.13938, Avg tpr: 0.49049, Avg fpr: 0.86701, total FA: 120382

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=3.50573 | acc=0.1412 | tpr=0.5531 | fpr=0.8662 | 5942.6 samples/s | 23.2 steps/s
[Step= 100] | Loss=3.50049 | acc=0.1437 | tpr=0.5458 | fpr=0.8638 | 8050.1 samples/s | 31.4 steps/s
[Step= 150] | Loss=3.49387 | acc=0.1449 | tpr=0.5720 | fpr=0.8630 | 8023.6 samples/s | 31.3 steps/s
[Step= 200] | Loss=3.48686 | acc=0.1460 | tpr=0.5770 | fpr=0.8619 | 7551.9 samples/s | 29.5 steps/s
[Step= 250] | Loss=3.49222 | acc=0.1457 | tpr=0.5686 | fpr=0.8620 | 8797.0 samples/s | 34.4 steps/s
[Step= 300] | Loss=3.48898 | acc=0.1457 | tpr=0.5636 | fpr=0.8619 | 7577.0 samples/s | 29.6 steps/s
[Step= 350] | Loss=3.49262 | acc=0.1459 | tpr=0.5611 | fpr=0.8616 | 8095.9 samples/s | 31.6 steps/s
[Step= 400] | Loss=3.49107 | acc=0.1462 | tpr=0.5602 | fpr=0.8613 | 8002.2 samples/s | 31.3 steps/s
[Step= 450] | Loss=3.49465 | acc=0.1459 | tpr=0.5672 | fpr=0.8618 | 8286.9 samples/s | 32.4 steps/s
[Step= 500] | Loss=3.49462 | acc=0.1459 | tpr=0.5692 | fpr=0.8618 | 7888.5 samples/s | 30.8 steps/s
[Step= 550] | Loss=3.49717 | acc=0.1459 | tpr=0.5698 | fpr=0.8618 | 9545.8 samples/s | 37.3 steps/s
Avg test loss: 3.49741, Avg test acc: 0.14580, Avg tpr: 0.57092, Avg fpr: 0.86193, total FA: 119677

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=3.51671 | acc=0.1417 | tpr=0.4823 | fpr=0.8644 | 6105.0 samples/s | 23.8 steps/s
[Step= 100] | Loss=3.51070 | acc=0.1437 | tpr=0.4755 | fpr=0.8624 | 7873.8 samples/s | 30.8 steps/s
[Step= 150] | Loss=3.50282 | acc=0.1459 | tpr=0.5029 | fpr=0.8607 | 7594.1 samples/s | 29.7 steps/s
[Step= 200] | Loss=3.49585 | acc=0.1466 | tpr=0.4973 | fpr=0.8598 | 8035.9 samples/s | 31.4 steps/s
[Step= 250] | Loss=3.50097 | acc=0.1464 | tpr=0.4908 | fpr=0.8599 | 8126.1 samples/s | 31.7 steps/s
[Step= 300] | Loss=3.49767 | acc=0.1464 | tpr=0.4815 | fpr=0.8597 | 7945.1 samples/s | 31.0 steps/s
[Step= 350] | Loss=3.50139 | acc=0.1466 | tpr=0.4834 | fpr=0.8595 | 7449.2 samples/s | 29.1 steps/s
[Step= 400] | Loss=3.49950 | acc=0.1469 | tpr=0.4847 | fpr=0.8593 | 8452.7 samples/s | 33.0 steps/s
[Step= 450] | Loss=3.50262 | acc=0.1464 | tpr=0.4888 | fpr=0.8598 | 8534.0 samples/s | 33.3 steps/s
[Step= 500] | Loss=3.50268 | acc=0.1464 | tpr=0.4921 | fpr=0.8598 | 7875.0 samples/s | 30.8 steps/s
[Step= 550] | Loss=3.50537 | acc=0.1464 | tpr=0.4899 | fpr=0.8599 | 9638.3 samples/s | 37.6 steps/s
Avg test loss: 3.50565, Avg test acc: 0.14625, Avg tpr: 0.49049, Avg fpr: 0.86001, total FA: 119411

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.22570 | acc=0.9580 | tpr=0.9513 | fpr=0.0418 | 5849.5 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.23417 | acc=0.9574 | tpr=0.9595 | fpr=0.0426 | 7985.4 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.23649 | acc=0.9559 | tpr=0.9568 | fpr=0.0442 | 7919.4 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.23671 | acc=0.9559 | tpr=0.9607 | fpr=0.0442 | 7437.2 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.23701 | acc=0.9557 | tpr=0.9581 | fpr=0.0443 | 7947.7 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.24060 | acc=0.9554 | tpr=0.9564 | fpr=0.0446 | 7653.3 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.23867 | acc=0.9556 | tpr=0.9555 | fpr=0.0444 | 8012.4 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.23846 | acc=0.9553 | tpr=0.9535 | fpr=0.0446 | 8519.7 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.24193 | acc=0.9549 | tpr=0.9523 | fpr=0.0450 | 7845.9 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.24242 | acc=0.9548 | tpr=0.9533 | fpr=0.0452 | 8234.2 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.24116 | acc=0.9550 | tpr=0.9538 | fpr=0.0450 | 10998.9 samples/s | 43.0 steps/s
Avg test loss: 0.24085, Avg test acc: 0.95503, Avg tpr: 0.95365, Avg fpr: 0.04494, total FA: 6240

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16702 | acc=0.9615 | tpr=0.9204 | fpr=0.0378 | 5981.7 samples/s | 23.4 steps/s
[Step= 100] | Loss=0.17437 | acc=0.9605 | tpr=0.9275 | fpr=0.0389 | 7538.1 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.17684 | acc=0.9591 | tpr=0.9323 | fpr=0.0404 | 8493.3 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.17725 | acc=0.9592 | tpr=0.9355 | fpr=0.0404 | 7659.1 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.17675 | acc=0.9593 | tpr=0.9362 | fpr=0.0403 | 8663.9 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.17948 | acc=0.9589 | tpr=0.9331 | fpr=0.0407 | 8019.9 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.17804 | acc=0.9590 | tpr=0.9336 | fpr=0.0406 | 8180.1 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.17840 | acc=0.9588 | tpr=0.9311 | fpr=0.0407 | 7257.0 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.18104 | acc=0.9584 | tpr=0.9309 | fpr=0.0411 | 8826.7 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.18071 | acc=0.9584 | tpr=0.9330 | fpr=0.0412 | 7971.2 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.17970 | acc=0.9586 | tpr=0.9347 | fpr=0.0410 | 9307.8 samples/s | 36.4 steps/s
Avg test loss: 0.17949, Avg test acc: 0.95861, Avg tpr: 0.93463, Avg fpr: 0.04095, total FA: 5686

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.22372 | acc=0.9474 | tpr=0.9690 | fpr=0.0530 | 6035.8 samples/s | 23.6 steps/s
[Step= 100] | Loss=0.23153 | acc=0.9471 | tpr=0.9744 | fpr=0.0534 | 8260.8 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.23505 | acc=0.9459 | tpr=0.9726 | fpr=0.0546 | 7722.8 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.23498 | acc=0.9461 | tpr=0.9738 | fpr=0.0544 | 8171.7 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.23480 | acc=0.9462 | tpr=0.9729 | fpr=0.0543 | 8367.0 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.23784 | acc=0.9461 | tpr=0.9709 | fpr=0.0543 | 7271.2 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.23629 | acc=0.9464 | tpr=0.9693 | fpr=0.0540 | 8370.1 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.23656 | acc=0.9459 | tpr=0.9666 | fpr=0.0545 | 8029.8 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.23979 | acc=0.9455 | tpr=0.9654 | fpr=0.0549 | 7933.9 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.23996 | acc=0.9455 | tpr=0.9665 | fpr=0.0549 | 8147.1 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.23865 | acc=0.9458 | tpr=0.9662 | fpr=0.0545 | 9501.4 samples/s | 37.1 steps/s
Avg test loss: 0.23841, Avg test acc: 0.94585, Avg tpr: 0.96593, Avg fpr: 0.05451, total FA: 7569

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15832 | acc=0.9649 | tpr=0.9425 | fpr=0.0347 | 5826.1 samples/s | 22.8 steps/s
[Step= 100] | Loss=0.16525 | acc=0.9635 | tpr=0.9446 | fpr=0.0362 | 7582.6 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.16670 | acc=0.9615 | tpr=0.9380 | fpr=0.0381 | 7934.8 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.16657 | acc=0.9615 | tpr=0.9421 | fpr=0.0381 | 7752.2 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.16649 | acc=0.9614 | tpr=0.9406 | fpr=0.0382 | 7964.6 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.16928 | acc=0.9611 | tpr=0.9418 | fpr=0.0385 | 8227.8 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.16784 | acc=0.9611 | tpr=0.9399 | fpr=0.0385 | 7858.3 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.16740 | acc=0.9609 | tpr=0.9371 | fpr=0.0387 | 7493.9 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.16978 | acc=0.9605 | tpr=0.9372 | fpr=0.0391 | 8516.3 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.17000 | acc=0.9604 | tpr=0.9392 | fpr=0.0392 | 7747.3 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.16894 | acc=0.9607 | tpr=0.9399 | fpr=0.0390 | 11926.7 samples/s | 46.6 steps/s
Avg test loss: 0.16869, Avg test acc: 0.96066, Avg tpr: 0.93978, Avg fpr: 0.03896, total FA: 5410

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.20353 | acc=0.9555 | tpr=0.9425 | fpr=0.0443 | 5927.2 samples/s | 23.2 steps/s
[Step= 100] | Loss=0.21180 | acc=0.9545 | tpr=0.9531 | fpr=0.0455 | 7829.3 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.21472 | acc=0.9530 | tpr=0.9568 | fpr=0.0471 | 7918.1 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.21487 | acc=0.9530 | tpr=0.9585 | fpr=0.0471 | 7516.4 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.21534 | acc=0.9531 | tpr=0.9581 | fpr=0.0470 | 7347.6 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.21858 | acc=0.9526 | tpr=0.9549 | fpr=0.0475 | 8432.1 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.21739 | acc=0.9526 | tpr=0.9549 | fpr=0.0474 | 8027.1 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.21767 | acc=0.9523 | tpr=0.9524 | fpr=0.0477 | 8102.6 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.22087 | acc=0.9519 | tpr=0.9518 | fpr=0.0481 | 8306.7 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.22081 | acc=0.9518 | tpr=0.9520 | fpr=0.0482 | 7809.8 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.21943 | acc=0.9521 | tpr=0.9526 | fpr=0.0479 | 11547.6 samples/s | 45.1 steps/s
Avg test loss: 0.21923, Avg test acc: 0.95211, Avg tpr: 0.95246, Avg fpr: 0.04790, total FA: 6651
