#clients of iccad2012: 5
#clients of asml1: 5
select ratio: 0.5
Total num clients: 10
client model path: ['models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0', 'models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_1', 'models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_2', 'models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3', 'models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_4', 'models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0', 'models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1', 'models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2', 'models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_3', 'models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (9983, 144, 14)
Resampled dataset to size (13125, 144, 14)
Using transform option: train
#pos = 6841, #neg = 6284
Allocated dataset with size (9983, 144, 14)
Resampled dataset to size (13116, 144, 14)
Using transform option: train
#pos = 6850, #neg = 6266
Allocated dataset with size (9983, 144, 14)
Resampled dataset to size (13135, 144, 14)
Using transform option: train
#pos = 6831, #neg = 6304
Allocated dataset with size (9983, 144, 14)
Resampled dataset to size (13124, 144, 14)
Using transform option: train
#pos = 6842, #neg = 6282
Allocated dataset with size (9984, 144, 14)
Resampled dataset to size (13051, 144, 14)
Using transform option: train
#pos = 6917, #neg = 6134
loading data into the main memory...
Allocated dataset with size (3660, 144, 14)
Resampled dataset to size (6754, 144, 14)
Using transform option: train
#pos = 3332, #neg = 3422
Allocated dataset with size (3660, 144, 14)
Resampled dataset to size (6728, 144, 14)
Using transform option: train
#pos = 3304, #neg = 3424
Allocated dataset with size (3660, 144, 14)
Resampled dataset to size (6702, 144, 14)
Using transform option: train
#pos = 3276, #neg = 3426
Allocated dataset with size (3660, 144, 14)
Resampled dataset to size (6792, 144, 14)
Using transform option: train
#pos = 3393, #neg = 3399
Allocated dataset with size (3660, 144, 14)
Resampled dataset to size (6715, 144, 14)
Using transform option: train
#pos = 3290, #neg = 3425
loading data into the main memory...
Allocated dataset with size (24958, 144, 14)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 14)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1 3 5 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36744 | Reg=0.00351 | acc=0.4531 | L2-Norm=18.727 | L2-Norm(final)=1.883 | 516.0 samples/s |  8.1 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.34893 | Reg=0.00351 | acc=0.4844 | L2-Norm=18.727 | L2-Norm(final)=1.880 | 6025.6 samples/s | 94.2 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.34431 | Reg=0.00351 | acc=0.6719 | L2-Norm=18.727 | L2-Norm(final)=1.888 | 6079.7 samples/s | 95.0 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.34012 | Reg=0.00351 | acc=0.6250 | L2-Norm=18.727 | L2-Norm(final)=1.904 | 6203.6 samples/s | 96.9 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.33712 | Reg=0.00351 | acc=0.6719 | L2-Norm=18.727 | L2-Norm(final)=1.928 | 9660.4 samples/s | 150.9 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.33523 | Reg=0.00351 | acc=0.6719 | L2-Norm=18.727 | L2-Norm(final)=1.956 | 1521.6 samples/s | 23.8 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.33322 | Reg=0.00351 | acc=0.5938 | L2-Norm=18.727 | L2-Norm(final)=1.987 | 6220.2 samples/s | 97.2 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.33105 | Reg=0.00351 | acc=0.6094 | L2-Norm=18.727 | L2-Norm(final)=2.020 | 6019.4 samples/s | 94.1 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.32950 | Reg=0.00351 | acc=0.6719 | L2-Norm=18.727 | L2-Norm(final)=2.057 | 8806.5 samples/s | 137.6 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.32788 | Reg=0.00351 | acc=0.6406 | L2-Norm=18.727 | L2-Norm(final)=2.095 | 1546.3 samples/s | 24.2 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.32643 | Reg=0.00351 | acc=0.6406 | L2-Norm=18.727 | L2-Norm(final)=2.135 | 6491.9 samples/s | 101.4 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.31130 | Reg=0.00351 | acc=0.6562 | L2-Norm=18.727 | L2-Norm(final)=2.545 | 3199.4 samples/s | 50.0 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.26873 | Reg=0.00333 | acc=0.8750 | L2-Norm=18.245 | L2-Norm(final)=2.572 | 4134.7 samples/s | 64.6 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.23745 | Reg=0.00326 | acc=0.8750 | L2-Norm=18.046 | L2-Norm(final)=2.589 | 4638.6 samples/s | 72.5 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.22071 | Reg=0.00322 | acc=0.7969 | L2-Norm=17.935 | L2-Norm(final)=2.598 | 4687.0 samples/s | 73.2 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.20361 | Reg=0.00319 | acc=0.8281 | L2-Norm=17.866 | L2-Norm(final)=2.610 | 6717.7 samples/s | 105.0 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.18865 | Reg=0.00318 | acc=0.9531 | L2-Norm=17.822 | L2-Norm(final)=2.623 | 1408.0 samples/s | 22.0 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.17769 | Reg=0.00317 | acc=0.9219 | L2-Norm=17.792 | L2-Norm(final)=2.636 | 4679.3 samples/s | 73.1 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.16654 | Reg=0.00316 | acc=0.9219 | L2-Norm=17.772 | L2-Norm(final)=2.650 | 4623.3 samples/s | 72.2 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.15799 | Reg=0.00315 | acc=0.9219 | L2-Norm=17.758 | L2-Norm(final)=2.665 | 6056.0 samples/s | 94.6 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.14893 | Reg=0.00315 | acc=0.9375 | L2-Norm=17.751 | L2-Norm(final)=2.679 | 1427.1 samples/s | 22.3 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.14150 | Reg=0.00315 | acc=0.9531 | L2-Norm=17.748 | L2-Norm(final)=2.693 | 4676.4 samples/s | 73.1 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.13458 | Reg=0.00315 | acc=0.9375 | L2-Norm=17.750 | L2-Norm(final)=2.707 | 4628.4 samples/s | 72.3 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.12935 | Reg=0.00315 | acc=0.9531 | L2-Norm=17.753 | L2-Norm(final)=2.721 | 5633.7 samples/s | 88.0 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.12413 | Reg=0.00315 | acc=0.9375 | L2-Norm=17.758 | L2-Norm(final)=2.733 | 1429.6 samples/s | 22.3 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.11952 | Reg=0.00316 | acc=0.9688 | L2-Norm=17.765 | L2-Norm(final)=2.745 | 4722.3 samples/s | 73.8 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.11542 | Reg=0.00316 | acc=0.9688 | L2-Norm=17.772 | L2-Norm(final)=2.756 | 4547.3 samples/s | 71.1 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.11151 | Reg=0.00316 | acc=0.9688 | L2-Norm=17.780 | L2-Norm(final)=2.767 | 5142.6 samples/s | 80.4 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.10726 | Reg=0.00316 | acc=0.9688 | L2-Norm=17.787 | L2-Norm(final)=2.778 | 1487.7 samples/s | 23.2 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.10304 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.794 | L2-Norm(final)=2.788 | 4614.3 samples/s | 72.1 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.09959 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.801 | L2-Norm(final)=2.798 | 4642.4 samples/s | 72.5 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.09664 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.808 | L2-Norm(final)=2.808 | 4778.5 samples/s | 74.7 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.09403 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.815 | L2-Norm(final)=2.817 | 1506.9 samples/s | 23.5 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.09117 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.822 | L2-Norm(final)=2.825 | 4587.0 samples/s | 71.7 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.08877 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.831 | L2-Norm(final)=2.834 | 4726.3 samples/s | 73.8 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.08640 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.839 | L2-Norm(final)=2.842 | 4541.8 samples/s | 71.0 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.08423 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.847 | L2-Norm(final)=2.850 | 1513.9 samples/s | 23.7 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.08207 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.854 | L2-Norm(final)=2.858 | 4633.8 samples/s | 72.4 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.07995 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.861 | L2-Norm(final)=2.866 | 4658.7 samples/s | 72.8 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07804 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.868 | L2-Norm(final)=2.873 | 4691.1 samples/s | 73.3 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07632 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.875 | L2-Norm(final)=2.880 | 1587.9 samples/s | 24.8 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.07449 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.882 | L2-Norm(final)=2.886 | 4636.0 samples/s | 72.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step2000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.38289 | Reg=0.00351 | acc=0.4375 | L2-Norm=18.727 | L2-Norm(final)=1.884 | 3025.8 samples/s | 47.3 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.34754 | Reg=0.00351 | acc=0.5781 | L2-Norm=18.727 | L2-Norm(final)=1.882 | 5510.4 samples/s | 86.1 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.34243 | Reg=0.00351 | acc=0.6719 | L2-Norm=18.727 | L2-Norm(final)=1.891 | 5945.5 samples/s | 92.9 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.33822 | Reg=0.00351 | acc=0.5469 | L2-Norm=18.727 | L2-Norm(final)=1.910 | 6064.6 samples/s | 94.8 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.33560 | Reg=0.00351 | acc=0.5000 | L2-Norm=18.727 | L2-Norm(final)=1.938 | 10222.1 samples/s | 159.7 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.33318 | Reg=0.00351 | acc=0.6875 | L2-Norm=18.727 | L2-Norm(final)=1.970 | 1516.9 samples/s | 23.7 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.33078 | Reg=0.00351 | acc=0.6562 | L2-Norm=18.727 | L2-Norm(final)=2.006 | 5834.8 samples/s | 91.2 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.32881 | Reg=0.00351 | acc=0.6406 | L2-Norm=18.727 | L2-Norm(final)=2.046 | 6059.9 samples/s | 94.7 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.32713 | Reg=0.00351 | acc=0.7031 | L2-Norm=18.727 | L2-Norm(final)=2.088 | 9134.6 samples/s | 142.7 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.32568 | Reg=0.00351 | acc=0.5469 | L2-Norm=18.727 | L2-Norm(final)=2.132 | 1525.0 samples/s | 23.8 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.32452 | Reg=0.00351 | acc=0.6719 | L2-Norm=18.727 | L2-Norm(final)=2.177 | 6034.5 samples/s | 94.3 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.30638 | Reg=0.00351 | acc=0.6875 | L2-Norm=18.727 | L2-Norm(final)=2.624 | 3161.1 samples/s | 49.4 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.28702 | Reg=0.00336 | acc=0.8594 | L2-Norm=18.319 | L2-Norm(final)=2.632 | 4226.2 samples/s | 66.0 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.25560 | Reg=0.00331 | acc=0.8750 | L2-Norm=18.183 | L2-Norm(final)=2.659 | 4765.5 samples/s | 74.5 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.23015 | Reg=0.00328 | acc=0.7969 | L2-Norm=18.108 | L2-Norm(final)=2.680 | 4656.6 samples/s | 72.8 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.21490 | Reg=0.00326 | acc=0.8906 | L2-Norm=18.064 | L2-Norm(final)=2.698 | 6640.2 samples/s | 103.8 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.19691 | Reg=0.00325 | acc=0.9062 | L2-Norm=18.037 | L2-Norm(final)=2.715 | 1406.7 samples/s | 22.0 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.18473 | Reg=0.00325 | acc=0.8906 | L2-Norm=18.022 | L2-Norm(final)=2.734 | 4725.6 samples/s | 73.8 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.17464 | Reg=0.00325 | acc=0.9375 | L2-Norm=18.014 | L2-Norm(final)=2.751 | 4585.3 samples/s | 71.6 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.16636 | Reg=0.00324 | acc=0.9688 | L2-Norm=18.012 | L2-Norm(final)=2.766 | 6142.7 samples/s | 96.0 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.15646 | Reg=0.00325 | acc=0.9219 | L2-Norm=18.014 | L2-Norm(final)=2.781 | 1407.2 samples/s | 22.0 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.14837 | Reg=0.00325 | acc=0.9219 | L2-Norm=18.020 | L2-Norm(final)=2.797 | 4570.9 samples/s | 71.4 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.14170 | Reg=0.00325 | acc=0.9062 | L2-Norm=18.030 | L2-Norm(final)=2.812 | 4722.3 samples/s | 73.8 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.13573 | Reg=0.00325 | acc=0.9219 | L2-Norm=18.040 | L2-Norm(final)=2.827 | 5660.9 samples/s | 88.5 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.13023 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.051 | L2-Norm(final)=2.841 | 1431.2 samples/s | 22.4 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.12466 | Reg=0.00326 | acc=0.9531 | L2-Norm=18.063 | L2-Norm(final)=2.855 | 4685.7 samples/s | 73.2 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.11972 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.076 | L2-Norm(final)=2.868 | 4587.5 samples/s | 71.7 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.11491 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.090 | L2-Norm(final)=2.882 | 5399.6 samples/s | 84.4 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.11106 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.105 | L2-Norm(final)=2.895 | 1471.6 samples/s | 23.0 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.10746 | Reg=0.00328 | acc=0.9219 | L2-Norm=18.120 | L2-Norm(final)=2.907 | 4581.0 samples/s | 71.6 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.10387 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.135 | L2-Norm(final)=2.919 | 4636.1 samples/s | 72.4 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.10043 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.149 | L2-Norm(final)=2.929 | 5023.0 samples/s | 78.5 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.09735 | Reg=0.00330 | acc=0.9844 | L2-Norm=18.162 | L2-Norm(final)=2.940 | 1487.8 samples/s | 23.2 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.09415 | Reg=0.00330 | acc=0.9844 | L2-Norm=18.174 | L2-Norm(final)=2.950 | 4599.6 samples/s | 71.9 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.09125 | Reg=0.00331 | acc=0.9531 | L2-Norm=18.184 | L2-Norm(final)=2.959 | 4648.4 samples/s | 72.6 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.08877 | Reg=0.00331 | acc=0.9531 | L2-Norm=18.194 | L2-Norm(final)=2.968 | 4797.6 samples/s | 75.0 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.08632 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.203 | L2-Norm(final)=2.976 | 1578.3 samples/s | 24.7 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.08410 | Reg=0.00332 | acc=0.9062 | L2-Norm=18.212 | L2-Norm(final)=2.985 | 4588.8 samples/s | 71.7 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.08198 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.221 | L2-Norm(final)=2.992 | 4656.8 samples/s | 72.8 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.08006 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.230 | L2-Norm(final)=3.000 | 4697.4 samples/s | 73.4 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07803 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.239 | L2-Norm(final)=3.007 | 1548.4 samples/s | 24.2 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.07633 | Reg=0.00333 | acc=0.9844 | L2-Norm=18.247 | L2-Norm(final)=3.015 | 4639.8 samples/s | 72.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_1/client_state-step2000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36455 | Reg=0.00351 | acc=0.5625 | L2-Norm=18.727 | L2-Norm(final)=1.882 | 3211.7 samples/s | 50.2 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.34980 | Reg=0.00351 | acc=0.5000 | L2-Norm=18.727 | L2-Norm(final)=1.872 | 5429.7 samples/s | 84.8 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.34377 | Reg=0.00351 | acc=0.6250 | L2-Norm=18.727 | L2-Norm(final)=1.878 | 5917.9 samples/s | 92.5 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.33929 | Reg=0.00351 | acc=0.6250 | L2-Norm=18.727 | L2-Norm(final)=1.897 | 6068.9 samples/s | 94.8 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.33633 | Reg=0.00351 | acc=0.6406 | L2-Norm=18.727 | L2-Norm(final)=1.923 | 9883.9 samples/s | 154.4 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.33364 | Reg=0.00351 | acc=0.7031 | L2-Norm=18.727 | L2-Norm(final)=1.955 | 1528.7 samples/s | 23.9 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.33148 | Reg=0.00351 | acc=0.7344 | L2-Norm=18.727 | L2-Norm(final)=1.989 | 5980.7 samples/s | 93.4 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.32954 | Reg=0.00351 | acc=0.6094 | L2-Norm=18.727 | L2-Norm(final)=2.026 | 6148.1 samples/s | 96.1 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.32810 | Reg=0.00351 | acc=0.6875 | L2-Norm=18.727 | L2-Norm(final)=2.065 | 8628.7 samples/s | 134.8 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.32651 | Reg=0.00351 | acc=0.8438 | L2-Norm=18.727 | L2-Norm(final)=2.106 | 1528.4 samples/s | 23.9 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.32498 | Reg=0.00351 | acc=0.6875 | L2-Norm=18.727 | L2-Norm(final)=2.148 | 6216.7 samples/s | 97.1 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.29461 | Reg=0.00351 | acc=0.7656 | L2-Norm=18.727 | L2-Norm(final)=2.582 | 3256.7 samples/s | 50.9 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.27261 | Reg=0.00334 | acc=0.7500 | L2-Norm=18.270 | L2-Norm(final)=2.604 | 4284.7 samples/s | 66.9 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.23693 | Reg=0.00328 | acc=0.8750 | L2-Norm=18.101 | L2-Norm(final)=2.625 | 4651.0 samples/s | 72.7 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.21800 | Reg=0.00325 | acc=0.9219 | L2-Norm=18.020 | L2-Norm(final)=2.643 | 4685.4 samples/s | 73.2 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.20070 | Reg=0.00323 | acc=0.9062 | L2-Norm=17.976 | L2-Norm(final)=2.663 | 6594.5 samples/s | 103.0 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.18535 | Reg=0.00322 | acc=0.8906 | L2-Norm=17.952 | L2-Norm(final)=2.681 | 1411.5 samples/s | 22.1 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.17225 | Reg=0.00322 | acc=0.9062 | L2-Norm=17.939 | L2-Norm(final)=2.699 | 4622.9 samples/s | 72.2 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.16251 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.933 | L2-Norm(final)=2.718 | 4717.6 samples/s | 73.7 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.15301 | Reg=0.00322 | acc=0.8906 | L2-Norm=17.933 | L2-Norm(final)=2.737 | 5967.9 samples/s | 93.2 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.14365 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.936 | L2-Norm(final)=2.755 | 1426.4 samples/s | 22.3 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.13772 | Reg=0.00322 | acc=0.9062 | L2-Norm=17.942 | L2-Norm(final)=2.772 | 4621.9 samples/s | 72.2 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.13092 | Reg=0.00322 | acc=0.9531 | L2-Norm=17.951 | L2-Norm(final)=2.789 | 4631.5 samples/s | 72.4 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.12573 | Reg=0.00323 | acc=0.9375 | L2-Norm=17.961 | L2-Norm(final)=2.804 | 5602.7 samples/s | 87.5 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.12000 | Reg=0.00323 | acc=0.9375 | L2-Norm=17.971 | L2-Norm(final)=2.818 | 1453.2 samples/s | 22.7 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.11449 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.983 | L2-Norm(final)=2.833 | 4717.3 samples/s | 73.7 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.10993 | Reg=0.00324 | acc=0.9844 | L2-Norm=17.994 | L2-Norm(final)=2.846 | 4565.2 samples/s | 71.3 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.10666 | Reg=0.00324 | acc=0.9688 | L2-Norm=18.005 | L2-Norm(final)=2.859 | 5175.6 samples/s | 80.9 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.10284 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.016 | L2-Norm(final)=2.870 | 1486.4 samples/s | 23.2 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.09874 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.026 | L2-Norm(final)=2.882 | 4641.1 samples/s | 72.5 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.09565 | Reg=0.00325 | acc=0.9531 | L2-Norm=18.037 | L2-Norm(final)=2.893 | 4661.5 samples/s | 72.8 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.09288 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.048 | L2-Norm(final)=2.904 | 4797.3 samples/s | 75.0 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.08982 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.060 | L2-Norm(final)=2.915 | 1546.2 samples/s | 24.2 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.08684 | Reg=0.00327 | acc=0.9688 | L2-Norm=18.072 | L2-Norm(final)=2.925 | 4623.2 samples/s | 72.2 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.08445 | Reg=0.00327 | acc=0.9375 | L2-Norm=18.083 | L2-Norm(final)=2.935 | 4631.6 samples/s | 72.4 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.08220 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.093 | L2-Norm(final)=2.944 | 4670.0 samples/s | 73.0 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.07995 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.103 | L2-Norm(final)=2.953 | 1530.3 samples/s | 23.9 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.07774 | Reg=0.00328 | acc=0.9844 | L2-Norm=18.112 | L2-Norm(final)=2.962 | 4671.7 samples/s | 73.0 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.07575 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.121 | L2-Norm(final)=2.970 | 4638.8 samples/s | 72.5 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07408 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.129 | L2-Norm(final)=2.979 | 4627.2 samples/s | 72.3 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.07243 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.138 | L2-Norm(final)=2.986 | 1532.6 samples/s | 23.9 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.07071 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.147 | L2-Norm(final)=2.994 | 4649.5 samples/s | 72.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step2000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.32846 | Reg=0.00351 | acc=0.5000 | L2-Norm=18.727 | L2-Norm(final)=1.884 | 3296.2 samples/s | 51.5 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.31467 | Reg=0.00351 | acc=0.5625 | L2-Norm=18.727 | L2-Norm(final)=1.905 | 4739.8 samples/s | 74.1 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.30334 | Reg=0.00351 | acc=0.7188 | L2-Norm=18.727 | L2-Norm(final)=1.961 | 9300.7 samples/s | 145.3 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.29317 | Reg=0.00351 | acc=0.6875 | L2-Norm=18.727 | L2-Norm(final)=2.041 | 1478.4 samples/s | 23.1 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.28361 | Reg=0.00351 | acc=0.8594 | L2-Norm=18.727 | L2-Norm(final)=2.139 | 8296.5 samples/s | 129.6 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.27513 | Reg=0.00351 | acc=0.8594 | L2-Norm=18.727 | L2-Norm(final)=2.246 | 1523.9 samples/s | 23.8 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.26761 | Reg=0.00351 | acc=0.7344 | L2-Norm=18.727 | L2-Norm(final)=2.359 | 6986.2 samples/s | 109.2 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.26095 | Reg=0.00351 | acc=0.9375 | L2-Norm=18.727 | L2-Norm(final)=2.475 | 1558.9 samples/s | 24.4 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.25488 | Reg=0.00351 | acc=0.8438 | L2-Norm=18.727 | L2-Norm(final)=2.591 | 6623.5 samples/s | 103.5 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.24944 | Reg=0.00351 | acc=0.8906 | L2-Norm=18.727 | L2-Norm(final)=2.708 | 1631.7 samples/s | 25.5 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.24415 | Reg=0.00351 | acc=0.9375 | L2-Norm=18.727 | L2-Norm(final)=2.825 | 6054.1 samples/s | 94.6 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.7] | Loss=0.18311 | Reg=0.00351 | acc=0.8594 | L2-Norm=18.727 | L2-Norm(final)=3.987 | 3124.1 samples/s | 48.8 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.11939 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.386 | L2-Norm(final)=4.048 | 4039.9 samples/s | 63.1 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.07112 | Reg=0.00335 | acc=0.9844 | L2-Norm=18.299 | L2-Norm(final)=4.096 | 6354.6 samples/s | 99.3 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.04897 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.247 | L2-Norm(final)=4.126 | 1368.0 samples/s | 21.4 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.03951 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.207 | L2-Norm(final)=4.147 | 5836.1 samples/s | 91.2 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.03186 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.176 | L2-Norm(final)=4.162 | 1395.7 samples/s | 21.8 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.02668 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.143 | L2-Norm(final)=4.174 | 5264.1 samples/s | 82.3 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.02289 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.109 | L2-Norm(final)=4.184 | 1402.2 samples/s | 21.9 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.02004 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.074 | L2-Norm(final)=4.192 | 4891.0 samples/s | 76.4 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01782 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.038 | L2-Norm(final)=4.199 | 1440.8 samples/s | 22.5 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01604 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.000 | L2-Norm(final)=4.204 | 4532.1 samples/s | 70.8 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.01459 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.962 | L2-Norm(final)=4.209 | 1475.8 samples/s | 23.1 steps/s
[Step=1100 Epoch=10.4] | Loss=0.01338 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.923 | L2-Norm(final)=4.213 | 4427.4 samples/s | 69.2 steps/s
[Step=1150 Epoch=10.9] | Loss=0.01235 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.884 | L2-Norm(final)=4.218 | 1522.9 samples/s | 23.8 steps/s
[Step=1200 Epoch=11.4] | Loss=0.01147 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.844 | L2-Norm(final)=4.221 | 4462.6 samples/s | 69.7 steps/s
[Step=1250 Epoch=11.8] | Loss=0.01071 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.805 | L2-Norm(final)=4.225 | 1527.5 samples/s | 23.9 steps/s
[Step=1300 Epoch=12.3] | Loss=0.01004 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.765 | L2-Norm(final)=4.228 | 4451.5 samples/s | 69.6 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00945 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.724 | L2-Norm(final)=4.231 | 1498.6 samples/s | 23.4 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00892 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.684 | L2-Norm(final)=4.234 | 4455.0 samples/s | 69.6 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00846 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.643 | L2-Norm(final)=4.237 | 6501.8 samples/s | 101.6 steps/s
[Step=1500 Epoch=14.2] | Loss=0.00803 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.603 | L2-Norm(final)=4.240 | 1372.1 samples/s | 21.4 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00765 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.562 | L2-Norm(final)=4.243 | 6160.2 samples/s | 96.3 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00730 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.521 | L2-Norm(final)=4.246 | 1426.5 samples/s | 22.3 steps/s
[Step=1650 Epoch=15.6] | Loss=0.00699 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.480 | L2-Norm(final)=4.249 | 5436.1 samples/s | 84.9 steps/s
[Step=1700 Epoch=16.1] | Loss=0.00670 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.439 | L2-Norm(final)=4.251 | 1442.0 samples/s | 22.5 steps/s
[Step=1750 Epoch=16.6] | Loss=0.00643 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.398 | L2-Norm(final)=4.254 | 5137.4 samples/s | 80.3 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00618 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.357 | L2-Norm(final)=4.257 | 1490.1 samples/s | 23.3 steps/s
[Step=1850 Epoch=17.5] | Loss=0.00595 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.316 | L2-Norm(final)=4.259 | 4748.4 samples/s | 74.2 steps/s
[Step=1900 Epoch=18.0] | Loss=0.00574 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.274 | L2-Norm(final)=4.262 | 1501.5 samples/s | 23.5 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00554 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.233 | L2-Norm(final)=4.264 | 4532.2 samples/s | 70.8 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00536 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.192 | L2-Norm(final)=4.267 | 1542.1 samples/s | 24.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step2000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33084 | Reg=0.00351 | acc=0.4844 | L2-Norm=18.727 | L2-Norm(final)=1.884 | 3172.2 samples/s | 49.6 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.31199 | Reg=0.00351 | acc=0.6562 | L2-Norm=18.727 | L2-Norm(final)=1.909 | 5070.0 samples/s | 79.2 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.29740 | Reg=0.00351 | acc=0.7500 | L2-Norm=18.727 | L2-Norm(final)=1.973 | 9974.9 samples/s | 155.9 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.28697 | Reg=0.00351 | acc=0.7969 | L2-Norm=18.727 | L2-Norm(final)=2.062 | 1501.3 samples/s | 23.5 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.27628 | Reg=0.00351 | acc=0.8750 | L2-Norm=18.727 | L2-Norm(final)=2.168 | 8711.4 samples/s | 136.1 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.26691 | Reg=0.00351 | acc=0.8594 | L2-Norm=18.727 | L2-Norm(final)=2.283 | 1526.2 samples/s | 23.8 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.25939 | Reg=0.00351 | acc=0.8750 | L2-Norm=18.727 | L2-Norm(final)=2.403 | 7911.6 samples/s | 123.6 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.25237 | Reg=0.00351 | acc=0.9062 | L2-Norm=18.727 | L2-Norm(final)=2.524 | 1571.5 samples/s | 24.6 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.24594 | Reg=0.00351 | acc=0.9062 | L2-Norm=18.727 | L2-Norm(final)=2.646 | 6724.2 samples/s | 105.1 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.24027 | Reg=0.00351 | acc=0.9531 | L2-Norm=18.727 | L2-Norm(final)=2.767 | 1590.5 samples/s | 24.9 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.23488 | Reg=0.00351 | acc=0.9062 | L2-Norm=18.727 | L2-Norm(final)=2.887 | 6431.3 samples/s | 100.5 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.8] | Loss=0.16266 | Reg=0.00351 | acc=0.9375 | L2-Norm=18.727 | L2-Norm(final)=4.083 | 3044.5 samples/s | 47.6 steps/s
[Step= 550 Epoch= 5.3] | Loss=0.08369 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.369 | L2-Norm(final)=4.150 | 4247.0 samples/s | 66.4 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.04814 | Reg=0.00333 | acc=0.9844 | L2-Norm=18.244 | L2-Norm(final)=4.191 | 6674.5 samples/s | 104.3 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.03292 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.163 | L2-Norm(final)=4.218 | 1388.3 samples/s | 21.7 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.02534 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.097 | L2-Norm(final)=4.236 | 6058.9 samples/s | 94.7 steps/s
[Step= 750 Epoch= 7.2] | Loss=0.02181 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.045 | L2-Norm(final)=4.248 | 1438.6 samples/s | 22.5 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01828 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.001 | L2-Norm(final)=4.257 | 5666.4 samples/s | 88.5 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.01569 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.957 | L2-Norm(final)=4.265 | 1464.5 samples/s | 22.9 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.01374 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.913 | L2-Norm(final)=4.272 | 5096.8 samples/s | 79.6 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.01222 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.869 | L2-Norm(final)=4.277 | 1451.7 samples/s | 22.7 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01100 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.825 | L2-Norm(final)=4.282 | 4859.3 samples/s | 75.9 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01001 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.781 | L2-Norm(final)=4.286 | 1511.1 samples/s | 23.6 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00917 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.738 | L2-Norm(final)=4.289 | 4519.1 samples/s | 70.6 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00847 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.694 | L2-Norm(final)=4.292 | 1529.6 samples/s | 23.9 steps/s
[Step=1200 Epoch=11.5] | Loss=0.00787 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.651 | L2-Norm(final)=4.295 | 4560.4 samples/s | 71.3 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00734 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.608 | L2-Norm(final)=4.297 | 1533.5 samples/s | 24.0 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00689 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.566 | L2-Norm(final)=4.299 | 4529.3 samples/s | 70.8 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00648 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.523 | L2-Norm(final)=4.301 | 1530.4 samples/s | 23.9 steps/s
[Step=1400 Epoch=13.4] | Loss=0.00612 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.481 | L2-Norm(final)=4.303 | 4435.8 samples/s | 69.3 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00580 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.439 | L2-Norm(final)=4.305 | 1563.7 samples/s | 24.4 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00551 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.397 | L2-Norm(final)=4.307 | 4513.5 samples/s | 70.5 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00525 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.355 | L2-Norm(final)=4.309 | 7077.8 samples/s | 110.6 steps/s
[Step=1600 Epoch=15.3] | Loss=0.00501 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.313 | L2-Norm(final)=4.311 | 1357.1 samples/s | 21.2 steps/s
[Step=1650 Epoch=15.8] | Loss=0.00479 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.271 | L2-Norm(final)=4.313 | 6579.7 samples/s | 102.8 steps/s
[Step=1700 Epoch=16.2] | Loss=0.00460 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.230 | L2-Norm(final)=4.314 | 1389.9 samples/s | 21.7 steps/s
[Step=1750 Epoch=16.7] | Loss=0.00441 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.189 | L2-Norm(final)=4.316 | 6125.8 samples/s | 95.7 steps/s
[Step=1800 Epoch=17.2] | Loss=0.00424 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.147 | L2-Norm(final)=4.318 | 1380.3 samples/s | 21.6 steps/s
[Step=1850 Epoch=17.7] | Loss=0.00409 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.106 | L2-Norm(final)=4.319 | 5643.5 samples/s | 88.2 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00394 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.065 | L2-Norm(final)=4.321 | 1450.2 samples/s | 22.7 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00380 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.024 | L2-Norm(final)=4.323 | 5259.0 samples/s | 82.2 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00368 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.983 | L2-Norm(final)=4.324 | 1462.9 samples/s | 22.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.16249 | acc=0.9197 | tpr=0.9493 | fpr=0.1447 | 4583.2 samples/s | 17.9 steps/s
Avg test loss: 0.16758, Avg test acc: 0.91714, Avg tpr: 0.94801, Avg fpr: 0.15075, total FA: 1176

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14966 | acc=0.9211 | tpr=0.9455 | fpr=0.1318 | 4747.5 samples/s | 18.5 steps/s
Avg test loss: 0.14698, Avg test acc: 0.92075, Avg tpr: 0.94533, Avg fpr: 0.13332, total FA: 1040

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.33024 | acc=0.6731 | tpr=0.9720 | fpr=0.9760 | 4682.0 samples/s | 18.3 steps/s
Avg test loss: 0.32979, Avg test acc: 0.67465, Avg tpr: 0.97109, Avg fpr: 0.97731, total FA: 7624

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.16932 | acc=0.9149 | tpr=0.9459 | fpr=0.1524 | 4684.9 samples/s | 18.3 steps/s
Avg test loss: 0.17192, Avg test acc: 0.91634, Avg tpr: 0.94865, Avg fpr: 0.15472, total FA: 1207

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.33024 | acc=0.6731 | tpr=0.9720 | fpr=0.9760 | 4746.9 samples/s | 18.5 steps/s
Avg test loss: 0.32979, Avg test acc: 0.67465, Avg tpr: 0.97109, Avg fpr: 0.97731, total FA: 7624

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.14430 | acc=0.3195 | tpr=0.0366 | fpr=0.0662 | 4802.4 samples/s | 18.8 steps/s
Avg test loss: 4.16190, Avg test acc: 0.31817, Avg tpr: 0.03672, Avg fpr: 0.06281, total FA: 490

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=0.33024 | acc=0.6731 | tpr=0.9720 | fpr=0.9760 | 4750.5 samples/s | 18.6 steps/s
Avg test loss: 0.32979, Avg test acc: 0.67465, Avg tpr: 0.97109, Avg fpr: 0.97731, total FA: 7624

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.24635 | acc=0.3234 | tpr=0.0513 | fpr=0.0857 | 4753.0 samples/s | 18.6 steps/s
Avg test loss: 4.27502, Avg test acc: 0.32366, Avg tpr: 0.05246, Avg fpr: 0.07986, total FA: 623

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=0.33024 | acc=0.6731 | tpr=0.9720 | fpr=0.9760 | 4769.1 samples/s | 18.6 steps/s
Avg test loss: 0.32979, Avg test acc: 0.67465, Avg tpr: 0.97109, Avg fpr: 0.97731, total FA: 7624

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=0.33024 | acc=0.6731 | tpr=0.9720 | fpr=0.9760 | 4607.6 samples/s | 18.0 steps/s
Avg test loss: 0.32979, Avg test acc: 0.67465, Avg tpr: 0.97109, Avg fpr: 0.97731, total FA: 7624

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.38681 | acc=0.1292 | tpr=0.8850 | fpr=0.8844 | 4446.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=4.39336 | acc=0.1289 | tpr=0.8593 | fpr=0.8848 | 8122.8 samples/s | 31.7 steps/s
[Step= 150] | Loss=4.40862 | acc=0.1290 | tpr=0.8631 | fpr=0.8845 | 8070.5 samples/s | 31.5 steps/s
[Step= 200] | Loss=4.39892 | acc=0.1294 | tpr=0.8656 | fpr=0.8840 | 7960.6 samples/s | 31.1 steps/s
[Step= 250] | Loss=4.40326 | acc=0.1297 | tpr=0.8646 | fpr=0.8837 | 8041.1 samples/s | 31.4 steps/s
[Step= 300] | Loss=4.40387 | acc=0.1295 | tpr=0.8647 | fpr=0.8839 | 8040.9 samples/s | 31.4 steps/s
[Step= 350] | Loss=4.40319 | acc=0.1290 | tpr=0.8647 | fpr=0.8844 | 8357.2 samples/s | 32.6 steps/s
[Step= 400] | Loss=4.40291 | acc=0.1288 | tpr=0.8643 | fpr=0.8845 | 7919.7 samples/s | 30.9 steps/s
[Step= 450] | Loss=4.40187 | acc=0.1287 | tpr=0.8637 | fpr=0.8846 | 7232.3 samples/s | 28.3 steps/s
[Step= 500] | Loss=4.40583 | acc=0.1287 | tpr=0.8670 | fpr=0.8846 | 8581.7 samples/s | 33.5 steps/s
[Step= 550] | Loss=4.40646 | acc=0.1287 | tpr=0.8691 | fpr=0.8848 | 10598.1 samples/s | 41.4 steps/s
Avg test loss: 4.40610, Avg test acc: 0.12855, Avg tpr: 0.86846, Avg fpr: 0.88490, total FA: 122866

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.23742 | acc=0.1430 | tpr=0.8496 | fpr=0.8697 | 4758.9 samples/s | 18.6 steps/s
[Step= 100] | Loss=4.21925 | acc=0.1465 | tpr=0.8443 | fpr=0.8665 | 7271.1 samples/s | 28.4 steps/s
[Step= 150] | Loss=4.20221 | acc=0.1473 | tpr=0.8545 | fpr=0.8657 | 8062.9 samples/s | 31.5 steps/s
[Step= 200] | Loss=4.19299 | acc=0.1474 | tpr=0.8568 | fpr=0.8655 | 7574.5 samples/s | 29.6 steps/s
[Step= 250] | Loss=4.19540 | acc=0.1485 | tpr=0.8515 | fpr=0.8643 | 8264.1 samples/s | 32.3 steps/s
[Step= 300] | Loss=4.19184 | acc=0.1485 | tpr=0.8509 | fpr=0.8643 | 7779.2 samples/s | 30.4 steps/s
[Step= 350] | Loss=4.19322 | acc=0.1484 | tpr=0.8516 | fpr=0.8643 | 8133.0 samples/s | 31.8 steps/s
[Step= 400] | Loss=4.19503 | acc=0.1484 | tpr=0.8507 | fpr=0.8643 | 8299.2 samples/s | 32.4 steps/s
[Step= 450] | Loss=4.19314 | acc=0.1483 | tpr=0.8476 | fpr=0.8644 | 7888.6 samples/s | 30.8 steps/s
[Step= 500] | Loss=4.19334 | acc=0.1482 | tpr=0.8445 | fpr=0.8644 | 7663.4 samples/s | 29.9 steps/s
[Step= 550] | Loss=4.19282 | acc=0.1484 | tpr=0.8468 | fpr=0.8643 | 11849.2 samples/s | 46.3 steps/s
Avg test loss: 4.19332, Avg test acc: 0.14830, Avg tpr: 0.84707, Avg fpr: 0.86440, total FA: 120020

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=0.42796 | acc=0.0340 | tpr=0.9956 | fpr=0.9833 | 4747.4 samples/s | 18.5 steps/s
[Step= 100] | Loss=0.42727 | acc=0.0343 | tpr=0.9936 | fpr=0.9836 | 7583.3 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.42780 | acc=0.0336 | tpr=0.9957 | fpr=0.9841 | 7602.1 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.42777 | acc=0.0336 | tpr=0.9967 | fpr=0.9839 | 8209.4 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.42806 | acc=0.0340 | tpr=0.9974 | fpr=0.9836 | 8394.8 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.42806 | acc=0.0338 | tpr=0.9971 | fpr=0.9838 | 8365.3 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.42815 | acc=0.0335 | tpr=0.9969 | fpr=0.9840 | 8212.1 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.42819 | acc=0.0334 | tpr=0.9956 | fpr=0.9841 | 7207.6 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.42822 | acc=0.0332 | tpr=0.9961 | fpr=0.9843 | 8090.1 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.42830 | acc=0.0330 | tpr=0.9960 | fpr=0.9844 | 7923.6 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.42825 | acc=0.0330 | tpr=0.9956 | fpr=0.9845 | 10515.7 samples/s | 41.1 steps/s
Avg test loss: 0.42824, Avg test acc: 0.03300, Avg tpr: 0.99564, Avg fpr: 0.98450, total FA: 136696

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=3.88889 | acc=0.1301 | tpr=0.9027 | fpr=0.8838 | 4558.8 samples/s | 17.8 steps/s
[Step= 100] | Loss=3.88015 | acc=0.1293 | tpr=0.9019 | fpr=0.8851 | 7921.6 samples/s | 30.9 steps/s
[Step= 150] | Loss=3.88394 | acc=0.1295 | tpr=0.9092 | fpr=0.8849 | 7922.6 samples/s | 30.9 steps/s
[Step= 200] | Loss=3.87764 | acc=0.1283 | tpr=0.9082 | fpr=0.8859 | 7842.4 samples/s | 30.6 steps/s
[Step= 250] | Loss=3.88172 | acc=0.1290 | tpr=0.9066 | fpr=0.8851 | 8431.4 samples/s | 32.9 steps/s
[Step= 300] | Loss=3.87763 | acc=0.1294 | tpr=0.9098 | fpr=0.8848 | 7894.8 samples/s | 30.8 steps/s
[Step= 350] | Loss=3.87981 | acc=0.1292 | tpr=0.9054 | fpr=0.8849 | 7927.0 samples/s | 31.0 steps/s
[Step= 400] | Loss=3.87920 | acc=0.1294 | tpr=0.9015 | fpr=0.8847 | 8117.9 samples/s | 31.7 steps/s
[Step= 450] | Loss=3.88059 | acc=0.1291 | tpr=0.8997 | fpr=0.8849 | 7096.5 samples/s | 27.7 steps/s
[Step= 500] | Loss=3.88041 | acc=0.1292 | tpr=0.9035 | fpr=0.8848 | 8260.4 samples/s | 32.3 steps/s
[Step= 550] | Loss=3.87837 | acc=0.1291 | tpr=0.9045 | fpr=0.8849 | 12050.0 samples/s | 47.1 steps/s
Avg test loss: 3.87931, Avg test acc: 0.12904, Avg tpr: 0.90452, Avg fpr: 0.88505, total FA: 122888

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=0.42796 | acc=0.0340 | tpr=0.9956 | fpr=0.9833 | 4755.6 samples/s | 18.6 steps/s
[Step= 100] | Loss=0.42727 | acc=0.0343 | tpr=0.9936 | fpr=0.9836 | 7369.7 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.42780 | acc=0.0336 | tpr=0.9957 | fpr=0.9841 | 8375.2 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.42777 | acc=0.0336 | tpr=0.9967 | fpr=0.9839 | 8089.1 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.42806 | acc=0.0340 | tpr=0.9974 | fpr=0.9836 | 8043.2 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.42806 | acc=0.0338 | tpr=0.9971 | fpr=0.9838 | 8119.6 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.42815 | acc=0.0335 | tpr=0.9969 | fpr=0.9840 | 7841.4 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.42819 | acc=0.0334 | tpr=0.9956 | fpr=0.9841 | 7823.1 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.42822 | acc=0.0332 | tpr=0.9961 | fpr=0.9843 | 7666.9 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.42830 | acc=0.0330 | tpr=0.9960 | fpr=0.9844 | 8349.5 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.42825 | acc=0.0330 | tpr=0.9956 | fpr=0.9845 | 10203.4 samples/s | 39.9 steps/s
Avg test loss: 0.42824, Avg test acc: 0.03300, Avg tpr: 0.99564, Avg fpr: 0.98450, total FA: 136696

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13470 | acc=0.9583 | tpr=0.9159 | fpr=0.0410 | 4543.5 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.13566 | acc=0.9580 | tpr=0.9424 | fpr=0.0417 | 8181.8 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.13770 | acc=0.9575 | tpr=0.9467 | fpr=0.0423 | 8287.3 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.13644 | acc=0.9576 | tpr=0.9486 | fpr=0.0422 | 7870.5 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.13755 | acc=0.9572 | tpr=0.9467 | fpr=0.0426 | 8085.1 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.13988 | acc=0.9566 | tpr=0.9418 | fpr=0.0431 | 7741.0 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.14059 | acc=0.9564 | tpr=0.9386 | fpr=0.0433 | 8770.7 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.14188 | acc=0.9559 | tpr=0.9333 | fpr=0.0437 | 7926.9 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.14294 | acc=0.9558 | tpr=0.9333 | fpr=0.0438 | 7595.9 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.14294 | acc=0.9558 | tpr=0.9348 | fpr=0.0438 | 8213.2 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.14226 | acc=0.9558 | tpr=0.9331 | fpr=0.0438 | 9761.4 samples/s | 38.1 steps/s
Avg test loss: 0.14199, Avg test acc: 0.95585, Avg tpr: 0.93304, Avg fpr: 0.04374, total FA: 6073

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.42796 | acc=0.0340 | tpr=0.9956 | fpr=0.9833 | 4572.0 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.42727 | acc=0.0343 | tpr=0.9936 | fpr=0.9836 | 8138.4 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.42780 | acc=0.0336 | tpr=0.9957 | fpr=0.9841 | 8171.8 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.42777 | acc=0.0336 | tpr=0.9967 | fpr=0.9839 | 7953.7 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.42806 | acc=0.0340 | tpr=0.9974 | fpr=0.9836 | 7728.1 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.42806 | acc=0.0338 | tpr=0.9971 | fpr=0.9838 | 8268.4 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.42815 | acc=0.0335 | tpr=0.9969 | fpr=0.9840 | 8469.9 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.42819 | acc=0.0334 | tpr=0.9956 | fpr=0.9841 | 7961.5 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.42822 | acc=0.0332 | tpr=0.9961 | fpr=0.9843 | 8299.4 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.42830 | acc=0.0330 | tpr=0.9960 | fpr=0.9844 | 7970.0 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.42825 | acc=0.0330 | tpr=0.9956 | fpr=0.9845 | 9638.8 samples/s | 37.7 steps/s
Avg test loss: 0.42824, Avg test acc: 0.03300, Avg tpr: 0.99564, Avg fpr: 0.98450, total FA: 136696

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.14814 | acc=0.9580 | tpr=0.8938 | fpr=0.0409 | 4710.7 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.14760 | acc=0.9583 | tpr=0.9126 | fpr=0.0408 | 7688.0 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.15028 | acc=0.9569 | tpr=0.9092 | fpr=0.0422 | 8005.3 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.15032 | acc=0.9563 | tpr=0.9104 | fpr=0.0428 | 7266.2 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.15139 | acc=0.9564 | tpr=0.9118 | fpr=0.0428 | 8296.1 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.15342 | acc=0.9557 | tpr=0.9113 | fpr=0.0435 | 8240.8 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.15275 | acc=0.9559 | tpr=0.9111 | fpr=0.0433 | 7714.8 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.15304 | acc=0.9557 | tpr=0.9059 | fpr=0.0434 | 8224.2 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.15341 | acc=0.9554 | tpr=0.9051 | fpr=0.0437 | 8063.6 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.15383 | acc=0.9552 | tpr=0.9066 | fpr=0.0439 | 8222.1 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.15355 | acc=0.9554 | tpr=0.9049 | fpr=0.0437 | 10839.2 samples/s | 42.3 steps/s
Avg test loss: 0.15339, Avg test acc: 0.95538, Avg tpr: 0.90531, Avg fpr: 0.04371, total FA: 6069

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.42796 | acc=0.0340 | tpr=0.9956 | fpr=0.9833 | 4728.5 samples/s | 18.5 steps/s
[Step= 100] | Loss=0.42727 | acc=0.0343 | tpr=0.9936 | fpr=0.9836 | 8064.1 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.42780 | acc=0.0336 | tpr=0.9957 | fpr=0.9841 | 7382.3 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.42777 | acc=0.0336 | tpr=0.9967 | fpr=0.9839 | 8539.7 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.42806 | acc=0.0340 | tpr=0.9974 | fpr=0.9836 | 7489.2 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.42806 | acc=0.0338 | tpr=0.9971 | fpr=0.9838 | 8012.9 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.42815 | acc=0.0335 | tpr=0.9969 | fpr=0.9840 | 7679.0 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.42819 | acc=0.0334 | tpr=0.9956 | fpr=0.9841 | 7957.3 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.42822 | acc=0.0332 | tpr=0.9961 | fpr=0.9843 | 8360.2 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.42830 | acc=0.0330 | tpr=0.9960 | fpr=0.9844 | 7959.1 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.42825 | acc=0.0330 | tpr=0.9956 | fpr=0.9845 | 11041.7 samples/s | 43.1 steps/s
Avg test loss: 0.42824, Avg test acc: 0.03300, Avg tpr: 0.99564, Avg fpr: 0.98450, total FA: 136696

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.42796 | acc=0.0340 | tpr=0.9956 | fpr=0.9833 | 4619.5 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.42727 | acc=0.0343 | tpr=0.9936 | fpr=0.9836 | 7734.7 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.42780 | acc=0.0336 | tpr=0.9957 | fpr=0.9841 | 7817.9 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.42777 | acc=0.0336 | tpr=0.9967 | fpr=0.9839 | 8332.5 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.42806 | acc=0.0340 | tpr=0.9974 | fpr=0.9836 | 7905.6 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.42806 | acc=0.0338 | tpr=0.9971 | fpr=0.9838 | 8206.6 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.42815 | acc=0.0335 | tpr=0.9969 | fpr=0.9840 | 8172.9 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.42819 | acc=0.0334 | tpr=0.9956 | fpr=0.9841 | 7830.1 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.42822 | acc=0.0332 | tpr=0.9961 | fpr=0.9843 | 7991.6 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.42830 | acc=0.0330 | tpr=0.9960 | fpr=0.9844 | 8282.9 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.42825 | acc=0.0330 | tpr=0.9956 | fpr=0.9845 | 9853.1 samples/s | 38.5 steps/s
Avg test loss: 0.42824, Avg test acc: 0.03300, Avg tpr: 0.99564, Avg fpr: 0.98450, total FA: 136696

server round 1/50

clients selected: [1 5 6 7 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.20107 | Reg=0.00290 | acc=0.8750 | L2-Norm=17.037 | L2-Norm(final)=3.219 | 3201.4 samples/s | 50.0 steps/s
[Step=2050 Epoch=10.0] | Loss=0.21780 | Reg=0.00290 | acc=0.7656 | L2-Norm=17.036 | L2-Norm(final)=3.263 | 4913.0 samples/s | 76.8 steps/s
[Step=2100 Epoch=10.2] | Loss=0.21964 | Reg=0.00290 | acc=0.7500 | L2-Norm=17.036 | L2-Norm(final)=3.300 | 5378.4 samples/s | 84.0 steps/s
[Step=2150 Epoch=10.5] | Loss=0.21946 | Reg=0.00290 | acc=0.8438 | L2-Norm=17.036 | L2-Norm(final)=3.336 | 5476.3 samples/s | 85.6 steps/s
[Step=2200 Epoch=10.7] | Loss=0.22095 | Reg=0.00290 | acc=0.7969 | L2-Norm=17.036 | L2-Norm(final)=3.374 | 8704.0 samples/s | 136.0 steps/s
[Step=2250 Epoch=11.0] | Loss=0.21985 | Reg=0.00290 | acc=0.8281 | L2-Norm=17.036 | L2-Norm(final)=3.411 | 1464.9 samples/s | 22.9 steps/s
[Step=2300 Epoch=11.2] | Loss=0.21891 | Reg=0.00290 | acc=0.8125 | L2-Norm=17.036 | L2-Norm(final)=3.450 | 5397.5 samples/s | 84.3 steps/s
[Step=2350 Epoch=11.5] | Loss=0.21835 | Reg=0.00290 | acc=0.8750 | L2-Norm=17.036 | L2-Norm(final)=3.489 | 5666.5 samples/s | 88.5 steps/s
[Step=2400 Epoch=11.7] | Loss=0.21686 | Reg=0.00290 | acc=0.7812 | L2-Norm=17.036 | L2-Norm(final)=3.530 | 7409.1 samples/s | 115.8 steps/s
[Step=2450 Epoch=12.0] | Loss=0.21615 | Reg=0.00290 | acc=0.8906 | L2-Norm=17.036 | L2-Norm(final)=3.570 | 1544.8 samples/s | 24.1 steps/s
[Step=2500 Epoch=12.2] | Loss=0.21564 | Reg=0.00290 | acc=0.7500 | L2-Norm=17.036 | L2-Norm(final)=3.612 | 5604.5 samples/s | 87.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.25175 | Reg=0.00290 | acc=0.7812 | L2-Norm=17.036 | L2-Norm(final)=4.034 | 3283.1 samples/s | 51.3 steps/s
[Step=2550 Epoch=12.4] | Loss=0.19444 | Reg=0.00294 | acc=0.9062 | L2-Norm=17.153 | L2-Norm(final)=4.031 | 4169.5 samples/s | 65.1 steps/s
[Step=2600 Epoch=12.7] | Loss=0.17727 | Reg=0.00297 | acc=0.9062 | L2-Norm=17.239 | L2-Norm(final)=4.021 | 4658.0 samples/s | 72.8 steps/s
[Step=2650 Epoch=12.9] | Loss=0.15868 | Reg=0.00299 | acc=0.9062 | L2-Norm=17.290 | L2-Norm(final)=4.021 | 4699.6 samples/s | 73.4 steps/s
[Step=2700 Epoch=13.2] | Loss=0.14641 | Reg=0.00300 | acc=0.8594 | L2-Norm=17.327 | L2-Norm(final)=4.025 | 6821.0 samples/s | 106.6 steps/s
[Step=2750 Epoch=13.4] | Loss=0.13354 | Reg=0.00301 | acc=0.9375 | L2-Norm=17.359 | L2-Norm(final)=4.029 | 1437.6 samples/s | 22.5 steps/s
[Step=2800 Epoch=13.7] | Loss=0.12407 | Reg=0.00302 | acc=0.9375 | L2-Norm=17.388 | L2-Norm(final)=4.035 | 4678.2 samples/s | 73.1 steps/s
[Step=2850 Epoch=13.9] | Loss=0.11786 | Reg=0.00303 | acc=0.9688 | L2-Norm=17.412 | L2-Norm(final)=4.040 | 4684.0 samples/s | 73.2 steps/s
[Step=2900 Epoch=14.2] | Loss=0.11303 | Reg=0.00304 | acc=0.9219 | L2-Norm=17.434 | L2-Norm(final)=4.045 | 6231.0 samples/s | 97.4 steps/s
[Step=2950 Epoch=14.4] | Loss=0.10577 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.457 | L2-Norm(final)=4.050 | 1469.8 samples/s | 23.0 steps/s
[Step=3000 Epoch=14.6] | Loss=0.10034 | Reg=0.00305 | acc=0.9531 | L2-Norm=17.477 | L2-Norm(final)=4.057 | 4684.8 samples/s | 73.2 steps/s
[Step=3050 Epoch=14.9] | Loss=0.09589 | Reg=0.00306 | acc=0.9844 | L2-Norm=17.496 | L2-Norm(final)=4.063 | 4678.1 samples/s | 73.1 steps/s
[Step=3100 Epoch=15.1] | Loss=0.09221 | Reg=0.00307 | acc=0.9375 | L2-Norm=17.514 | L2-Norm(final)=4.068 | 5825.6 samples/s | 91.0 steps/s
[Step=3150 Epoch=15.4] | Loss=0.08818 | Reg=0.00307 | acc=0.9531 | L2-Norm=17.530 | L2-Norm(final)=4.072 | 1463.9 samples/s | 22.9 steps/s
[Step=3200 Epoch=15.6] | Loss=0.08463 | Reg=0.00308 | acc=0.9688 | L2-Norm=17.545 | L2-Norm(final)=4.078 | 4705.0 samples/s | 73.5 steps/s
[Step=3250 Epoch=15.9] | Loss=0.08124 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.560 | L2-Norm(final)=4.083 | 4680.9 samples/s | 73.1 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07878 | Reg=0.00309 | acc=0.9844 | L2-Norm=17.573 | L2-Norm(final)=4.089 | 5470.0 samples/s | 85.5 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07579 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.586 | L2-Norm(final)=4.093 | 1469.4 samples/s | 23.0 steps/s
[Step=3400 Epoch=16.6] | Loss=0.07318 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.597 | L2-Norm(final)=4.098 | 4786.5 samples/s | 74.8 steps/s
[Step=3450 Epoch=16.8] | Loss=0.07094 | Reg=0.00310 | acc=0.9531 | L2-Norm=17.607 | L2-Norm(final)=4.103 | 4657.1 samples/s | 72.8 steps/s
[Step=3500 Epoch=17.1] | Loss=0.06925 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.617 | L2-Norm(final)=4.107 | 5079.5 samples/s | 79.4 steps/s
[Step=3550 Epoch=17.3] | Loss=0.06711 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.627 | L2-Norm(final)=4.111 | 1517.5 samples/s | 23.7 steps/s
[Step=3600 Epoch=17.6] | Loss=0.06489 | Reg=0.00311 | acc=0.9531 | L2-Norm=17.635 | L2-Norm(final)=4.116 | 4706.0 samples/s | 73.5 steps/s
[Step=3650 Epoch=17.8] | Loss=0.06326 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.643 | L2-Norm(final)=4.120 | 4847.6 samples/s | 75.7 steps/s
[Step=3700 Epoch=18.1] | Loss=0.06186 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.651 | L2-Norm(final)=4.124 | 4679.6 samples/s | 73.1 steps/s
[Step=3750 Epoch=18.3] | Loss=0.06038 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.658 | L2-Norm(final)=4.127 | 1540.5 samples/s | 24.1 steps/s
[Step=3800 Epoch=18.5] | Loss=0.05909 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.666 | L2-Norm(final)=4.131 | 4710.2 samples/s | 73.6 steps/s
[Step=3850 Epoch=18.8] | Loss=0.05758 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.673 | L2-Norm(final)=4.134 | 4720.3 samples/s | 73.8 steps/s
[Step=3900 Epoch=19.0] | Loss=0.05637 | Reg=0.00313 | acc=0.9688 | L2-Norm=17.680 | L2-Norm(final)=4.138 | 4719.8 samples/s | 73.7 steps/s
[Step=3950 Epoch=19.3] | Loss=0.05527 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.687 | L2-Norm(final)=4.141 | 1558.2 samples/s | 24.3 steps/s
[Step=4000 Epoch=19.5] | Loss=0.05399 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.695 | L2-Norm(final)=4.145 | 4717.9 samples/s | 73.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_1/client_state-step4000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch=19.0] | Loss=0.14484 | Reg=0.00290 | acc=0.8750 | L2-Norm=17.037 | L2-Norm(final)=4.344 | 3312.2 samples/s | 51.8 steps/s
[Step=2050 Epoch=19.4] | Loss=0.11801 | Reg=0.00290 | acc=0.9062 | L2-Norm=17.023 | L2-Norm(final)=4.528 | 4410.3 samples/s | 68.9 steps/s
[Step=2100 Epoch=19.9] | Loss=0.11222 | Reg=0.00290 | acc=0.9375 | L2-Norm=17.021 | L2-Norm(final)=4.786 | 7918.4 samples/s | 123.7 steps/s
[Step=2150 Epoch=20.4] | Loss=0.10780 | Reg=0.00290 | acc=0.9375 | L2-Norm=17.021 | L2-Norm(final)=5.012 | 1440.9 samples/s | 22.5 steps/s
[Step=2200 Epoch=20.8] | Loss=0.10463 | Reg=0.00290 | acc=0.9531 | L2-Norm=17.020 | L2-Norm(final)=5.209 | 7137.7 samples/s | 111.5 steps/s
[Step=2250 Epoch=21.3] | Loss=0.10207 | Reg=0.00290 | acc=0.9844 | L2-Norm=17.020 | L2-Norm(final)=5.383 | 1490.2 samples/s | 23.3 steps/s
[Step=2300 Epoch=21.8] | Loss=0.09954 | Reg=0.00290 | acc=0.9688 | L2-Norm=17.020 | L2-Norm(final)=5.542 | 6507.3 samples/s | 101.7 steps/s
[Step=2350 Epoch=22.3] | Loss=0.09794 | Reg=0.00290 | acc=0.9688 | L2-Norm=17.020 | L2-Norm(final)=5.688 | 1559.4 samples/s | 24.4 steps/s
[Step=2400 Epoch=22.7] | Loss=0.09627 | Reg=0.00290 | acc=0.9531 | L2-Norm=17.020 | L2-Norm(final)=5.824 | 5753.2 samples/s | 89.9 steps/s
[Step=2450 Epoch=23.2] | Loss=0.09480 | Reg=0.00290 | acc=0.9219 | L2-Norm=17.020 | L2-Norm(final)=5.952 | 1563.1 samples/s | 24.4 steps/s
[Step=2500 Epoch=23.7] | Loss=0.09303 | Reg=0.00290 | acc=0.9844 | L2-Norm=17.020 | L2-Norm(final)=6.073 | 5399.0 samples/s | 84.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.7] | Loss=0.09151 | Reg=0.00290 | acc=0.9219 | L2-Norm=17.019 | L2-Norm(final)=7.256 | 3230.5 samples/s | 50.5 steps/s
[Step=2550 Epoch=24.2] | Loss=0.17481 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.617 | L2-Norm(final)=7.129 | 3946.6 samples/s | 61.7 steps/s
[Step=2600 Epoch=24.6] | Loss=0.09802 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.790 | L2-Norm(final)=7.120 | 6507.3 samples/s | 101.7 steps/s
[Step=2650 Epoch=25.1] | Loss=0.06678 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.833 | L2-Norm(final)=7.124 | 1387.1 samples/s | 21.7 steps/s
[Step=2700 Epoch=25.6] | Loss=0.05122 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.837 | L2-Norm(final)=7.130 | 5834.4 samples/s | 91.2 steps/s
[Step=2750 Epoch=26.1] | Loss=0.04250 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.826 | L2-Norm(final)=7.133 | 1412.9 samples/s | 22.1 steps/s
[Step=2800 Epoch=26.5] | Loss=0.03556 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.810 | L2-Norm(final)=7.136 | 5395.5 samples/s | 84.3 steps/s
[Step=2850 Epoch=27.0] | Loss=0.03069 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=7.140 | 1479.7 samples/s | 23.1 steps/s
[Step=2900 Epoch=27.5] | Loss=0.02692 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.765 | L2-Norm(final)=7.144 | 4986.8 samples/s | 77.9 steps/s
[Step=2950 Epoch=28.0] | Loss=0.02394 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.740 | L2-Norm(final)=7.147 | 1491.5 samples/s | 23.3 steps/s
[Step=3000 Epoch=28.4] | Loss=0.02155 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.712 | L2-Norm(final)=7.150 | 4499.2 samples/s | 70.3 steps/s
[Step=3050 Epoch=28.9] | Loss=0.01960 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.683 | L2-Norm(final)=7.152 | 1532.7 samples/s | 23.9 steps/s
[Step=3100 Epoch=29.4] | Loss=0.01797 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.654 | L2-Norm(final)=7.155 | 4508.7 samples/s | 70.4 steps/s
[Step=3150 Epoch=29.8] | Loss=0.01659 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.623 | L2-Norm(final)=7.157 | 1518.9 samples/s | 23.7 steps/s
[Step=3200 Epoch=30.3] | Loss=0.01541 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.593 | L2-Norm(final)=7.158 | 4430.2 samples/s | 69.2 steps/s
[Step=3250 Epoch=30.8] | Loss=0.01438 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.562 | L2-Norm(final)=7.160 | 1522.0 samples/s | 23.8 steps/s
[Step=3300 Epoch=31.3] | Loss=0.01348 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.530 | L2-Norm(final)=7.162 | 4483.3 samples/s | 70.1 steps/s
[Step=3350 Epoch=31.7] | Loss=0.01269 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.499 | L2-Norm(final)=7.163 | 1593.1 samples/s | 24.9 steps/s
[Step=3400 Epoch=32.2] | Loss=0.01199 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.467 | L2-Norm(final)=7.164 | 4310.8 samples/s | 67.4 steps/s
[Step=3450 Epoch=32.7] | Loss=0.01136 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.436 | L2-Norm(final)=7.165 | 6742.7 samples/s | 105.4 steps/s
[Step=3500 Epoch=33.2] | Loss=0.01079 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.404 | L2-Norm(final)=7.167 | 1373.4 samples/s | 21.5 steps/s
[Step=3550 Epoch=33.6] | Loss=0.01028 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.372 | L2-Norm(final)=7.168 | 6049.3 samples/s | 94.5 steps/s
[Step=3600 Epoch=34.1] | Loss=0.00981 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.341 | L2-Norm(final)=7.169 | 1405.5 samples/s | 22.0 steps/s
[Step=3650 Epoch=34.6] | Loss=0.00938 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.309 | L2-Norm(final)=7.170 | 5549.9 samples/s | 86.7 steps/s
[Step=3700 Epoch=35.1] | Loss=0.00899 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.277 | L2-Norm(final)=7.170 | 1435.0 samples/s | 22.4 steps/s
[Step=3750 Epoch=35.5] | Loss=0.00863 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.246 | L2-Norm(final)=7.171 | 5071.7 samples/s | 79.2 steps/s
[Step=3800 Epoch=36.0] | Loss=0.00830 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.214 | L2-Norm(final)=7.172 | 1454.0 samples/s | 22.7 steps/s
[Step=3850 Epoch=36.5] | Loss=0.00800 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.183 | L2-Norm(final)=7.173 | 4745.3 samples/s | 74.1 steps/s
[Step=3900 Epoch=37.0] | Loss=0.00771 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.151 | L2-Norm(final)=7.174 | 1489.1 samples/s | 23.3 steps/s
[Step=3950 Epoch=37.4] | Loss=0.00745 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.120 | L2-Norm(final)=7.174 | 4475.5 samples/s | 69.9 steps/s
[Step=4000 Epoch=37.9] | Loss=0.00720 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.088 | L2-Norm(final)=7.175 | 1554.9 samples/s | 24.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step4000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.31386 | Reg=0.00290 | acc=0.5938 | L2-Norm=17.037 | L2-Norm(final)=1.884 | 3211.0 samples/s | 50.2 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.28799 | Reg=0.00290 | acc=0.8750 | L2-Norm=17.037 | L2-Norm(final)=1.932 | 4964.6 samples/s | 77.6 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.26148 | Reg=0.00290 | acc=0.8438 | L2-Norm=17.037 | L2-Norm(final)=2.035 | 9691.7 samples/s | 151.4 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.24156 | Reg=0.00290 | acc=0.9219 | L2-Norm=17.037 | L2-Norm(final)=2.163 | 1499.4 samples/s | 23.4 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.22581 | Reg=0.00290 | acc=0.9375 | L2-Norm=17.037 | L2-Norm(final)=2.303 | 8096.8 samples/s | 126.5 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.21251 | Reg=0.00290 | acc=0.8906 | L2-Norm=17.037 | L2-Norm(final)=2.445 | 1529.2 samples/s | 23.9 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.20196 | Reg=0.00290 | acc=0.9062 | L2-Norm=17.037 | L2-Norm(final)=2.584 | 7119.7 samples/s | 111.2 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.19283 | Reg=0.00290 | acc=0.9219 | L2-Norm=17.037 | L2-Norm(final)=2.720 | 1604.2 samples/s | 25.1 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.18547 | Reg=0.00290 | acc=0.9219 | L2-Norm=17.037 | L2-Norm(final)=2.852 | 6702.4 samples/s | 104.7 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.17825 | Reg=0.00290 | acc=0.9375 | L2-Norm=17.037 | L2-Norm(final)=2.979 | 1602.0 samples/s | 25.0 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.17307 | Reg=0.00290 | acc=0.9219 | L2-Norm=17.037 | L2-Norm(final)=3.101 | 6050.6 samples/s | 94.5 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.8] | Loss=0.15235 | Reg=0.00290 | acc=0.8906 | L2-Norm=17.037 | L2-Norm(final)=4.303 | 3187.8 samples/s | 49.8 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.07974 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.986 | L2-Norm(final)=4.339 | 4004.4 samples/s | 62.6 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.04592 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.994 | L2-Norm(final)=4.363 | 6592.2 samples/s | 103.0 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.03274 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.994 | L2-Norm(final)=4.378 | 1385.2 samples/s | 21.6 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.02519 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.990 | L2-Norm(final)=4.390 | 5942.3 samples/s | 92.8 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.02024 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.982 | L2-Norm(final)=4.400 | 1412.9 samples/s | 22.1 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01691 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.967 | L2-Norm(final)=4.407 | 5307.4 samples/s | 82.9 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.01451 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.949 | L2-Norm(final)=4.414 | 1454.5 samples/s | 22.7 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.01270 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.927 | L2-Norm(final)=4.418 | 4934.5 samples/s | 77.1 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01130 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.903 | L2-Norm(final)=4.423 | 1475.4 samples/s | 23.1 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01017 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.876 | L2-Norm(final)=4.426 | 4630.6 samples/s | 72.4 steps/s
[Step=1050 Epoch=10.0] | Loss=0.00925 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.849 | L2-Norm(final)=4.429 | 1521.5 samples/s | 23.8 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00848 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.820 | L2-Norm(final)=4.431 | 4487.9 samples/s | 70.1 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00783 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.791 | L2-Norm(final)=4.434 | 1550.2 samples/s | 24.2 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00727 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.761 | L2-Norm(final)=4.436 | 4497.7 samples/s | 70.3 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00679 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.730 | L2-Norm(final)=4.438 | 1523.7 samples/s | 23.8 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00637 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.698 | L2-Norm(final)=4.439 | 4526.5 samples/s | 70.7 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00599 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.666 | L2-Norm(final)=4.441 | 1618.9 samples/s | 25.3 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00566 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.633 | L2-Norm(final)=4.443 | 4014.8 samples/s | 62.7 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00536 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.601 | L2-Norm(final)=4.444 | 6852.2 samples/s | 107.1 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00510 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.567 | L2-Norm(final)=4.445 | 1395.7 samples/s | 21.8 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00485 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.534 | L2-Norm(final)=4.446 | 5997.2 samples/s | 93.7 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00463 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.500 | L2-Norm(final)=4.448 | 1421.0 samples/s | 22.2 steps/s
[Step=1650 Epoch=15.7] | Loss=0.00443 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.466 | L2-Norm(final)=4.449 | 5605.3 samples/s | 87.6 steps/s
[Step=1700 Epoch=16.2] | Loss=0.00425 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.431 | L2-Norm(final)=4.450 | 1463.8 samples/s | 22.9 steps/s
[Step=1750 Epoch=16.6] | Loss=0.00408 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.397 | L2-Norm(final)=4.451 | 5151.2 samples/s | 80.5 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00392 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.362 | L2-Norm(final)=4.452 | 1481.1 samples/s | 23.1 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00378 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.327 | L2-Norm(final)=4.453 | 4660.1 samples/s | 72.8 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00364 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.292 | L2-Norm(final)=4.454 | 1501.2 samples/s | 23.5 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00352 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.256 | L2-Norm(final)=4.455 | 4548.6 samples/s | 71.1 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00340 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.221 | L2-Norm(final)=4.456 | 1527.0 samples/s | 23.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step2000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch=19.1] | Loss=0.15666 | Reg=0.00290 | acc=0.8906 | L2-Norm=17.037 | L2-Norm(final)=4.371 | 3286.3 samples/s | 51.3 steps/s
[Step=2050 Epoch=19.6] | Loss=0.10975 | Reg=0.00290 | acc=0.9375 | L2-Norm=17.024 | L2-Norm(final)=4.552 | 4384.0 samples/s | 68.5 steps/s
[Step=2100 Epoch=20.1] | Loss=0.10491 | Reg=0.00290 | acc=0.9375 | L2-Norm=17.022 | L2-Norm(final)=4.806 | 8267.1 samples/s | 129.2 steps/s
[Step=2150 Epoch=20.5] | Loss=0.10363 | Reg=0.00290 | acc=0.9375 | L2-Norm=17.021 | L2-Norm(final)=5.020 | 1432.2 samples/s | 22.4 steps/s
[Step=2200 Epoch=21.0] | Loss=0.09800 | Reg=0.00290 | acc=0.9531 | L2-Norm=17.021 | L2-Norm(final)=5.204 | 7431.6 samples/s | 116.1 steps/s
[Step=2250 Epoch=21.5] | Loss=0.09548 | Reg=0.00290 | acc=0.9531 | L2-Norm=17.021 | L2-Norm(final)=5.375 | 1474.1 samples/s | 23.0 steps/s
[Step=2300 Epoch=22.0] | Loss=0.09354 | Reg=0.00290 | acc=0.9844 | L2-Norm=17.021 | L2-Norm(final)=5.531 | 6639.0 samples/s | 103.7 steps/s
[Step=2350 Epoch=22.4] | Loss=0.09182 | Reg=0.00290 | acc=0.9688 | L2-Norm=17.021 | L2-Norm(final)=5.673 | 1509.4 samples/s | 23.6 steps/s
[Step=2400 Epoch=22.9] | Loss=0.09022 | Reg=0.00290 | acc=0.9688 | L2-Norm=17.021 | L2-Norm(final)=5.805 | 6223.9 samples/s | 97.2 steps/s
[Step=2450 Epoch=23.4] | Loss=0.08873 | Reg=0.00290 | acc=0.9531 | L2-Norm=17.020 | L2-Norm(final)=5.929 | 1506.6 samples/s | 23.5 steps/s
[Step=2500 Epoch=23.9] | Loss=0.08749 | Reg=0.00290 | acc=0.9531 | L2-Norm=17.020 | L2-Norm(final)=6.047 | 5801.5 samples/s | 90.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.9] | Loss=0.07509 | Reg=0.00290 | acc=0.9688 | L2-Norm=17.020 | L2-Norm(final)=7.196 | 3125.1 samples/s | 48.8 steps/s
[Step=2550 Epoch=24.4] | Loss=0.17670 | Reg=0.00310 | acc=0.9531 | L2-Norm=17.593 | L2-Norm(final)=7.060 | 4111.6 samples/s | 64.2 steps/s
[Step=2600 Epoch=24.8] | Loss=0.09711 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.738 | L2-Norm(final)=7.057 | 6681.7 samples/s | 104.4 steps/s
[Step=2650 Epoch=25.3] | Loss=0.06609 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.766 | L2-Norm(final)=7.066 | 1377.2 samples/s | 21.5 steps/s
[Step=2700 Epoch=25.8] | Loss=0.05049 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.761 | L2-Norm(final)=7.075 | 6065.6 samples/s | 94.8 steps/s
[Step=2750 Epoch=26.3] | Loss=0.04088 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.744 | L2-Norm(final)=7.083 | 1413.9 samples/s | 22.1 steps/s
[Step=2800 Epoch=26.7] | Loss=0.03413 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.721 | L2-Norm(final)=7.090 | 5595.7 samples/s | 87.4 steps/s
[Step=2850 Epoch=27.2] | Loss=0.02931 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.694 | L2-Norm(final)=7.096 | 1471.4 samples/s | 23.0 steps/s
[Step=2900 Epoch=27.7] | Loss=0.02566 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.665 | L2-Norm(final)=7.100 | 5215.0 samples/s | 81.5 steps/s
[Step=2950 Epoch=28.2] | Loss=0.02282 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.634 | L2-Norm(final)=7.104 | 1451.2 samples/s | 22.7 steps/s
[Step=3000 Epoch=28.6] | Loss=0.02055 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.602 | L2-Norm(final)=7.108 | 4871.1 samples/s | 76.1 steps/s
[Step=3050 Epoch=29.1] | Loss=0.01868 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.570 | L2-Norm(final)=7.111 | 1488.4 samples/s | 23.3 steps/s
[Step=3100 Epoch=29.6] | Loss=0.01713 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.537 | L2-Norm(final)=7.114 | 4674.4 samples/s | 73.0 steps/s
[Step=3150 Epoch=30.1] | Loss=0.01582 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.505 | L2-Norm(final)=7.116 | 1507.8 samples/s | 23.6 steps/s
[Step=3200 Epoch=30.6] | Loss=0.01469 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.472 | L2-Norm(final)=7.118 | 4491.6 samples/s | 70.2 steps/s
[Step=3250 Epoch=31.0] | Loss=0.01371 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.439 | L2-Norm(final)=7.120 | 1516.6 samples/s | 23.7 steps/s
[Step=3300 Epoch=31.5] | Loss=0.01286 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.406 | L2-Norm(final)=7.122 | 4536.2 samples/s | 70.9 steps/s
[Step=3350 Epoch=32.0] | Loss=0.01210 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.373 | L2-Norm(final)=7.124 | 1516.2 samples/s | 23.7 steps/s
[Step=3400 Epoch=32.5] | Loss=0.01143 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.340 | L2-Norm(final)=7.125 | 4573.3 samples/s | 71.5 steps/s
[Step=3450 Epoch=32.9] | Loss=0.01083 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.308 | L2-Norm(final)=7.127 | 1569.3 samples/s | 24.5 steps/s
[Step=3500 Epoch=33.4] | Loss=0.01029 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.275 | L2-Norm(final)=7.128 | 4476.6 samples/s | 69.9 steps/s
[Step=3550 Epoch=33.9] | Loss=0.00980 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.243 | L2-Norm(final)=7.129 | 7013.8 samples/s | 109.6 steps/s
[Step=3600 Epoch=34.4] | Loss=0.00936 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.210 | L2-Norm(final)=7.130 | 1356.2 samples/s | 21.2 steps/s
[Step=3650 Epoch=34.9] | Loss=0.00895 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.178 | L2-Norm(final)=7.132 | 6427.2 samples/s | 100.4 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00858 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.146 | L2-Norm(final)=7.133 | 1419.3 samples/s | 22.2 steps/s
[Step=3750 Epoch=35.8] | Loss=0.00824 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.113 | L2-Norm(final)=7.134 | 5848.5 samples/s | 91.4 steps/s
[Step=3800 Epoch=36.3] | Loss=0.00792 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.081 | L2-Norm(final)=7.135 | 1390.8 samples/s | 21.7 steps/s
[Step=3850 Epoch=36.8] | Loss=0.00763 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.049 | L2-Norm(final)=7.136 | 5599.0 samples/s | 87.5 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00736 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.017 | L2-Norm(final)=7.137 | 1436.2 samples/s | 22.4 steps/s
[Step=3950 Epoch=37.7] | Loss=0.00710 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.985 | L2-Norm(final)=7.137 | 5207.4 samples/s | 81.4 steps/s
[Step=4000 Epoch=38.2] | Loss=0.00687 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.953 | L2-Norm(final)=7.138 | 1480.9 samples/s | 23.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step4000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.30914 | Reg=0.00290 | acc=0.6562 | L2-Norm=17.037 | L2-Norm(final)=1.885 | 3326.1 samples/s | 52.0 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.28761 | Reg=0.00290 | acc=0.7500 | L2-Norm=17.037 | L2-Norm(final)=1.934 | 4831.7 samples/s | 75.5 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.26185 | Reg=0.00290 | acc=0.8906 | L2-Norm=17.037 | L2-Norm(final)=2.037 | 9054.8 samples/s | 141.5 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.24185 | Reg=0.00290 | acc=0.8906 | L2-Norm=17.037 | L2-Norm(final)=2.170 | 1540.8 samples/s | 24.1 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.22595 | Reg=0.00290 | acc=0.9219 | L2-Norm=17.037 | L2-Norm(final)=2.313 | 7964.4 samples/s | 124.4 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.21330 | Reg=0.00290 | acc=0.9688 | L2-Norm=17.037 | L2-Norm(final)=2.458 | 1569.5 samples/s | 24.5 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.20317 | Reg=0.00290 | acc=0.9219 | L2-Norm=17.037 | L2-Norm(final)=2.600 | 7089.8 samples/s | 110.8 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.19400 | Reg=0.00290 | acc=0.9062 | L2-Norm=17.037 | L2-Norm(final)=2.738 | 1608.4 samples/s | 25.1 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.18650 | Reg=0.00290 | acc=0.9375 | L2-Norm=17.037 | L2-Norm(final)=2.872 | 6039.2 samples/s | 94.4 steps/s
[Step= 450 Epoch= 4.2] | Loss=0.17983 | Reg=0.00290 | acc=0.9531 | L2-Norm=17.037 | L2-Norm(final)=3.001 | 1607.3 samples/s | 25.1 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.17418 | Reg=0.00290 | acc=0.9375 | L2-Norm=17.037 | L2-Norm(final)=3.125 | 5955.1 samples/s | 93.0 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.7] | Loss=0.13407 | Reg=0.00290 | acc=0.8750 | L2-Norm=17.037 | L2-Norm(final)=4.347 | 3150.2 samples/s | 49.2 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.08701 | Reg=0.00288 | acc=0.9844 | L2-Norm=16.967 | L2-Norm(final)=4.374 | 4064.5 samples/s | 63.5 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.05053 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.958 | L2-Norm(final)=4.394 | 6496.2 samples/s | 101.5 steps/s
[Step= 650 Epoch= 6.1] | Loss=0.03560 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.949 | L2-Norm(final)=4.410 | 1401.5 samples/s | 21.9 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.02732 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.936 | L2-Norm(final)=4.422 | 5673.0 samples/s | 88.6 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.02194 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.919 | L2-Norm(final)=4.432 | 1420.3 samples/s | 22.2 steps/s
[Step= 800 Epoch= 7.5] | Loss=0.01832 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.899 | L2-Norm(final)=4.440 | 5089.5 samples/s | 79.5 steps/s
[Step= 850 Epoch= 8.0] | Loss=0.01571 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.876 | L2-Norm(final)=4.446 | 1471.7 samples/s | 23.0 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.01376 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.850 | L2-Norm(final)=4.451 | 4665.4 samples/s | 72.9 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01224 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.823 | L2-Norm(final)=4.455 | 1435.7 samples/s | 22.4 steps/s
[Step=1000 Epoch= 9.4] | Loss=0.01102 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.795 | L2-Norm(final)=4.459 | 4478.5 samples/s | 70.0 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.01002 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.767 | L2-Norm(final)=4.462 | 1537.8 samples/s | 24.0 steps/s
[Step=1100 Epoch=10.4] | Loss=0.00919 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.737 | L2-Norm(final)=4.464 | 4479.7 samples/s | 70.0 steps/s
[Step=1150 Epoch=10.8] | Loss=0.00849 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.707 | L2-Norm(final)=4.467 | 1572.8 samples/s | 24.6 steps/s
[Step=1200 Epoch=11.3] | Loss=0.00788 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.677 | L2-Norm(final)=4.469 | 4403.3 samples/s | 68.8 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00736 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.646 | L2-Norm(final)=4.471 | 1650.1 samples/s | 25.8 steps/s
[Step=1300 Epoch=12.2] | Loss=0.00690 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.615 | L2-Norm(final)=4.473 | 3979.3 samples/s | 62.2 steps/s
[Step=1350 Epoch=12.7] | Loss=0.00649 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.584 | L2-Norm(final)=4.475 | 6501.6 samples/s | 101.6 steps/s
[Step=1400 Epoch=13.2] | Loss=0.00613 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.552 | L2-Norm(final)=4.477 | 1388.9 samples/s | 21.7 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00581 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.520 | L2-Norm(final)=4.478 | 5814.5 samples/s | 90.9 steps/s
[Step=1500 Epoch=14.1] | Loss=0.00552 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.488 | L2-Norm(final)=4.480 | 1422.7 samples/s | 22.2 steps/s
[Step=1550 Epoch=14.6] | Loss=0.00526 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.456 | L2-Norm(final)=4.481 | 5284.4 samples/s | 82.6 steps/s
[Step=1600 Epoch=15.1] | Loss=0.00502 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.423 | L2-Norm(final)=4.483 | 1464.7 samples/s | 22.9 steps/s
[Step=1650 Epoch=15.5] | Loss=0.00480 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.391 | L2-Norm(final)=4.484 | 4782.9 samples/s | 74.7 steps/s
[Step=1700 Epoch=16.0] | Loss=0.00461 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.358 | L2-Norm(final)=4.485 | 1489.6 samples/s | 23.3 steps/s
[Step=1750 Epoch=16.5] | Loss=0.00442 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.325 | L2-Norm(final)=4.487 | 4579.7 samples/s | 71.6 steps/s
[Step=1800 Epoch=17.0] | Loss=0.00425 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.292 | L2-Norm(final)=4.488 | 1536.3 samples/s | 24.0 steps/s
[Step=1850 Epoch=17.4] | Loss=0.00409 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.259 | L2-Norm(final)=4.489 | 4450.1 samples/s | 69.5 steps/s
[Step=1900 Epoch=17.9] | Loss=0.00395 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.226 | L2-Norm(final)=4.490 | 1511.0 samples/s | 23.6 steps/s
[Step=1950 Epoch=18.4] | Loss=0.00381 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.192 | L2-Norm(final)=4.491 | 4490.9 samples/s | 70.2 steps/s
[Step=2000 Epoch=18.8] | Loss=0.00369 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.159 | L2-Norm(final)=4.492 | 1540.8 samples/s | 24.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_3/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.16249 | acc=0.9197 | tpr=0.9493 | fpr=0.1447 | 4598.3 samples/s | 18.0 steps/s
Avg test loss: 0.16758, Avg test acc: 0.91714, Avg tpr: 0.94801, Avg fpr: 0.15075, total FA: 1176

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.16322 | acc=0.9130 | tpr=0.9186 | fpr=0.0991 | 4788.1 samples/s | 18.7 steps/s
Avg test loss: 0.16728, Avg test acc: 0.91149, Avg tpr: 0.91584, Avg fpr: 0.09806, total FA: 765

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.33024 | acc=0.6731 | tpr=0.9720 | fpr=0.9760 | 4782.0 samples/s | 18.7 steps/s
Avg test loss: 0.32979, Avg test acc: 0.67465, Avg tpr: 0.97109, Avg fpr: 0.97731, total FA: 7624

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.16932 | acc=0.9149 | tpr=0.9459 | fpr=0.1524 | 4767.2 samples/s | 18.6 steps/s
Avg test loss: 0.17192, Avg test acc: 0.91634, Avg tpr: 0.94865, Avg fpr: 0.15472, total FA: 1207

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.33024 | acc=0.6731 | tpr=0.9720 | fpr=0.9760 | 4501.2 samples/s | 17.6 steps/s
Avg test loss: 0.32979, Avg test acc: 0.67465, Avg tpr: 0.97109, Avg fpr: 0.97731, total FA: 7624

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.56137 | acc=0.3142 | tpr=0.0100 | fpr=0.0253 | 4677.3 samples/s | 18.3 steps/s
Avg test loss: 6.57903, Avg test acc: 0.31176, Avg tpr: 0.00944, Avg fpr: 0.02333, total FA: 182

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.00409 | acc=0.3272 | tpr=0.0480 | fpr=0.0667 | 4505.0 samples/s | 17.6 steps/s
Avg test loss: 4.02813, Avg test acc: 0.32623, Avg tpr: 0.04779, Avg fpr: 0.06140, total FA: 479

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.90231 | acc=0.3292 | tpr=0.0488 | fpr=0.0619 | 4524.3 samples/s | 17.7 steps/s
Avg test loss: 4.92551, Avg test acc: 0.32611, Avg tpr: 0.04733, Avg fpr: 0.06076, total FA: 474

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.62448 | acc=0.3311 | tpr=0.0577 | fpr=0.0753 | 4453.7 samples/s | 17.4 steps/s
Avg test loss: 4.65194, Avg test acc: 0.32927, Avg tpr: 0.05572, Avg fpr: 0.06909, total FA: 539

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=0.33024 | acc=0.6731 | tpr=0.9720 | fpr=0.9760 | 4584.1 samples/s | 17.9 steps/s
Avg test loss: 0.32979, Avg test acc: 0.67465, Avg tpr: 0.97109, Avg fpr: 0.97731, total FA: 7624

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.38681 | acc=0.1292 | tpr=0.8850 | fpr=0.8844 | 4714.9 samples/s | 18.4 steps/s
[Step= 100] | Loss=4.39336 | acc=0.1289 | tpr=0.8593 | fpr=0.8848 | 7388.2 samples/s | 28.9 steps/s
[Step= 150] | Loss=4.40862 | acc=0.1290 | tpr=0.8631 | fpr=0.8845 | 8277.5 samples/s | 32.3 steps/s
[Step= 200] | Loss=4.39892 | acc=0.1294 | tpr=0.8656 | fpr=0.8840 | 7601.0 samples/s | 29.7 steps/s
[Step= 250] | Loss=4.40326 | acc=0.1297 | tpr=0.8646 | fpr=0.8837 | 8220.8 samples/s | 32.1 steps/s
[Step= 300] | Loss=4.40387 | acc=0.1295 | tpr=0.8647 | fpr=0.8839 | 8148.0 samples/s | 31.8 steps/s
[Step= 350] | Loss=4.40319 | acc=0.1290 | tpr=0.8647 | fpr=0.8844 | 8259.3 samples/s | 32.3 steps/s
[Step= 400] | Loss=4.40291 | acc=0.1288 | tpr=0.8643 | fpr=0.8845 | 8215.1 samples/s | 32.1 steps/s
[Step= 450] | Loss=4.40187 | acc=0.1287 | tpr=0.8637 | fpr=0.8846 | 5464.7 samples/s | 21.3 steps/s
[Step= 500] | Loss=4.40583 | acc=0.1287 | tpr=0.8670 | fpr=0.8846 | 7673.6 samples/s | 30.0 steps/s
[Step= 550] | Loss=4.40646 | acc=0.1287 | tpr=0.8691 | fpr=0.8848 | 10549.8 samples/s | 41.2 steps/s
Avg test loss: 4.40610, Avg test acc: 0.12855, Avg tpr: 0.86846, Avg fpr: 0.88490, total FA: 122866

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.01911 | acc=0.1702 | tpr=0.7699 | fpr=0.8405 | 4724.6 samples/s | 18.5 steps/s
[Step= 100] | Loss=3.99437 | acc=0.1721 | tpr=0.7932 | fpr=0.8395 | 7579.0 samples/s | 29.6 steps/s
[Step= 150] | Loss=3.98907 | acc=0.1722 | tpr=0.7983 | fpr=0.8394 | 8254.2 samples/s | 32.2 steps/s
[Step= 200] | Loss=3.97754 | acc=0.1722 | tpr=0.7956 | fpr=0.8391 | 7497.9 samples/s | 29.3 steps/s
[Step= 250] | Loss=3.97564 | acc=0.1732 | tpr=0.7843 | fpr=0.8379 | 6739.9 samples/s | 26.3 steps/s
[Step= 300] | Loss=3.97896 | acc=0.1729 | tpr=0.7862 | fpr=0.8382 | 8186.1 samples/s | 32.0 steps/s
[Step= 350] | Loss=3.97963 | acc=0.1725 | tpr=0.7821 | fpr=0.8386 | 7418.1 samples/s | 29.0 steps/s
[Step= 400] | Loss=3.98131 | acc=0.1722 | tpr=0.7752 | fpr=0.8388 | 7814.9 samples/s | 30.5 steps/s
[Step= 450] | Loss=3.98530 | acc=0.1720 | tpr=0.7804 | fpr=0.8391 | 7821.1 samples/s | 30.6 steps/s
[Step= 500] | Loss=3.98545 | acc=0.1721 | tpr=0.7767 | fpr=0.8389 | 7558.1 samples/s | 29.5 steps/s
[Step= 550] | Loss=3.98532 | acc=0.1720 | tpr=0.7784 | fpr=0.8390 | 9942.8 samples/s | 38.8 steps/s
Avg test loss: 3.98618, Avg test acc: 0.17189, Avg tpr: 0.77853, Avg fpr: 0.83914, total FA: 116513

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=0.42796 | acc=0.0340 | tpr=0.9956 | fpr=0.9833 | 4414.7 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.42727 | acc=0.0343 | tpr=0.9936 | fpr=0.9836 | 8186.1 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.42780 | acc=0.0336 | tpr=0.9957 | fpr=0.9841 | 8010.7 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.42777 | acc=0.0336 | tpr=0.9967 | fpr=0.9839 | 6578.1 samples/s | 25.7 steps/s
[Step= 250] | Loss=0.42806 | acc=0.0340 | tpr=0.9974 | fpr=0.9836 | 8064.3 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.42806 | acc=0.0338 | tpr=0.9971 | fpr=0.9838 | 7827.0 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.42815 | acc=0.0335 | tpr=0.9969 | fpr=0.9840 | 7836.9 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.42819 | acc=0.0334 | tpr=0.9956 | fpr=0.9841 | 7439.6 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.42822 | acc=0.0332 | tpr=0.9961 | fpr=0.9843 | 7760.8 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.42830 | acc=0.0330 | tpr=0.9960 | fpr=0.9844 | 7613.5 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.42825 | acc=0.0330 | tpr=0.9956 | fpr=0.9845 | 10860.8 samples/s | 42.4 steps/s
Avg test loss: 0.42824, Avg test acc: 0.03300, Avg tpr: 0.99564, Avg fpr: 0.98450, total FA: 136696

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=3.88889 | acc=0.1301 | tpr=0.9027 | fpr=0.8838 | 4741.6 samples/s | 18.5 steps/s
[Step= 100] | Loss=3.88015 | acc=0.1293 | tpr=0.9019 | fpr=0.8851 | 7455.8 samples/s | 29.1 steps/s
[Step= 150] | Loss=3.88394 | acc=0.1295 | tpr=0.9092 | fpr=0.8849 | 7564.2 samples/s | 29.5 steps/s
[Step= 200] | Loss=3.87764 | acc=0.1283 | tpr=0.9082 | fpr=0.8859 | 6556.4 samples/s | 25.6 steps/s
[Step= 250] | Loss=3.88172 | acc=0.1290 | tpr=0.9066 | fpr=0.8851 | 7693.2 samples/s | 30.1 steps/s
[Step= 300] | Loss=3.87763 | acc=0.1294 | tpr=0.9098 | fpr=0.8848 | 8223.8 samples/s | 32.1 steps/s
[Step= 350] | Loss=3.87981 | acc=0.1292 | tpr=0.9054 | fpr=0.8849 | 7911.8 samples/s | 30.9 steps/s
[Step= 400] | Loss=3.87920 | acc=0.1294 | tpr=0.9015 | fpr=0.8847 | 7838.7 samples/s | 30.6 steps/s
[Step= 450] | Loss=3.88059 | acc=0.1291 | tpr=0.8997 | fpr=0.8849 | 7816.1 samples/s | 30.5 steps/s
[Step= 500] | Loss=3.88041 | acc=0.1292 | tpr=0.9035 | fpr=0.8848 | 7843.2 samples/s | 30.6 steps/s
[Step= 550] | Loss=3.87837 | acc=0.1291 | tpr=0.9045 | fpr=0.8849 | 9710.8 samples/s | 37.9 steps/s
Avg test loss: 3.87931, Avg test acc: 0.12904, Avg tpr: 0.90452, Avg fpr: 0.88505, total FA: 122888

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=0.42796 | acc=0.0340 | tpr=0.9956 | fpr=0.9833 | 4570.7 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.42727 | acc=0.0343 | tpr=0.9936 | fpr=0.9836 | 8272.0 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.42780 | acc=0.0336 | tpr=0.9957 | fpr=0.9841 | 7665.7 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.42777 | acc=0.0336 | tpr=0.9967 | fpr=0.9839 | 6295.1 samples/s | 24.6 steps/s
[Step= 250] | Loss=0.42806 | acc=0.0340 | tpr=0.9974 | fpr=0.9836 | 7839.3 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.42806 | acc=0.0338 | tpr=0.9971 | fpr=0.9838 | 7922.2 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.42815 | acc=0.0335 | tpr=0.9969 | fpr=0.9840 | 7721.3 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.42819 | acc=0.0334 | tpr=0.9956 | fpr=0.9841 | 7934.2 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.42822 | acc=0.0332 | tpr=0.9961 | fpr=0.9843 | 7585.7 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.42830 | acc=0.0330 | tpr=0.9960 | fpr=0.9844 | 8233.3 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.42825 | acc=0.0330 | tpr=0.9956 | fpr=0.9845 | 9610.1 samples/s | 37.5 steps/s
Avg test loss: 0.42824, Avg test acc: 0.03300, Avg tpr: 0.99564, Avg fpr: 0.98450, total FA: 136696

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10685 | acc=0.9652 | tpr=0.9292 | fpr=0.0342 | 4700.7 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.10904 | acc=0.9650 | tpr=0.9339 | fpr=0.0344 | 7461.2 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.11006 | acc=0.9643 | tpr=0.9337 | fpr=0.0351 | 6178.3 samples/s | 24.1 steps/s
[Step= 200] | Loss=0.11037 | acc=0.9644 | tpr=0.9377 | fpr=0.0351 | 8153.2 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.11115 | acc=0.9640 | tpr=0.9389 | fpr=0.0356 | 7955.0 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.11263 | acc=0.9633 | tpr=0.9360 | fpr=0.0362 | 7955.0 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.11275 | acc=0.9634 | tpr=0.9349 | fpr=0.0361 | 7816.5 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.11308 | acc=0.9632 | tpr=0.9322 | fpr=0.0363 | 7301.2 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.11392 | acc=0.9631 | tpr=0.9314 | fpr=0.0364 | 7842.8 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.11404 | acc=0.9629 | tpr=0.9330 | fpr=0.0366 | 8466.2 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.11352 | acc=0.9629 | tpr=0.9327 | fpr=0.0366 | 9857.9 samples/s | 38.5 steps/s
Avg test loss: 0.11337, Avg test acc: 0.96289, Avg tpr: 0.93265, Avg fpr: 0.03657, total FA: 5077

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10469 | acc=0.9652 | tpr=0.8982 | fpr=0.0336 | 4733.8 samples/s | 18.5 steps/s
[Step= 100] | Loss=0.10479 | acc=0.9644 | tpr=0.9168 | fpr=0.0347 | 8204.8 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.10596 | acc=0.9633 | tpr=0.9164 | fpr=0.0358 | 5750.9 samples/s | 22.5 steps/s
[Step= 200] | Loss=0.10633 | acc=0.9630 | tpr=0.9115 | fpr=0.0360 | 7950.4 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.10708 | acc=0.9627 | tpr=0.9057 | fpr=0.0362 | 8081.1 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.10837 | acc=0.9623 | tpr=0.9040 | fpr=0.0366 | 8413.6 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.10845 | acc=0.9623 | tpr=0.9067 | fpr=0.0367 | 7361.9 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.10907 | acc=0.9619 | tpr=0.9010 | fpr=0.0370 | 7823.1 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.11010 | acc=0.9617 | tpr=0.8987 | fpr=0.0371 | 7478.3 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.10972 | acc=0.9619 | tpr=0.9009 | fpr=0.0370 | 7965.4 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.10953 | acc=0.9620 | tpr=0.8977 | fpr=0.0369 | 10790.3 samples/s | 42.1 steps/s
Avg test loss: 0.10923, Avg test acc: 0.96201, Avg tpr: 0.89818, Avg fpr: 0.03683, total FA: 5114

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.19612 | acc=0.9514 | tpr=0.9204 | fpr=0.0480 | 4462.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.20145 | acc=0.9518 | tpr=0.9467 | fpr=0.0481 | 8030.6 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.20680 | acc=0.9499 | tpr=0.9510 | fpr=0.0501 | 6456.4 samples/s | 25.2 steps/s
[Step= 200] | Loss=0.20799 | acc=0.9500 | tpr=0.9486 | fpr=0.0500 | 8082.4 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.20963 | acc=0.9497 | tpr=0.9459 | fpr=0.0502 | 7541.3 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.21174 | acc=0.9492 | tpr=0.9396 | fpr=0.0506 | 7467.7 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.21159 | acc=0.9492 | tpr=0.9399 | fpr=0.0506 | 8139.0 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.21222 | acc=0.9488 | tpr=0.9354 | fpr=0.0509 | 8282.8 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.21269 | acc=0.9484 | tpr=0.9318 | fpr=0.0513 | 8036.9 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.21360 | acc=0.9482 | tpr=0.9344 | fpr=0.0516 | 8031.2 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.21277 | acc=0.9484 | tpr=0.9316 | fpr=0.0513 | 9176.8 samples/s | 35.8 steps/s
Avg test loss: 0.21250, Avg test acc: 0.94846, Avg tpr: 0.93185, Avg fpr: 0.05124, total FA: 7114

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09731 | acc=0.9685 | tpr=0.9115 | fpr=0.0305 | 4764.3 samples/s | 18.6 steps/s
[Step= 100] | Loss=0.09795 | acc=0.9679 | tpr=0.9254 | fpr=0.0314 | 5829.0 samples/s | 22.8 steps/s
[Step= 150] | Loss=0.10023 | acc=0.9669 | tpr=0.9251 | fpr=0.0324 | 8033.2 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.09999 | acc=0.9669 | tpr=0.9290 | fpr=0.0324 | 7889.1 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.10157 | acc=0.9670 | tpr=0.9197 | fpr=0.0322 | 7974.5 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.10301 | acc=0.9664 | tpr=0.9142 | fpr=0.0327 | 7633.2 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.10342 | acc=0.9662 | tpr=0.9148 | fpr=0.0328 | 8072.4 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.10401 | acc=0.9658 | tpr=0.9086 | fpr=0.0332 | 7584.7 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.10491 | acc=0.9657 | tpr=0.9060 | fpr=0.0332 | 7697.0 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.10459 | acc=0.9658 | tpr=0.9084 | fpr=0.0332 | 8140.7 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.10399 | acc=0.9658 | tpr=0.9045 | fpr=0.0331 | 10102.1 samples/s | 39.5 steps/s
Avg test loss: 0.10385, Avg test acc: 0.96586, Avg tpr: 0.90491, Avg fpr: 0.03304, total FA: 4587

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.42796 | acc=0.0340 | tpr=0.9956 | fpr=0.9833 | 4633.1 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.42727 | acc=0.0343 | tpr=0.9936 | fpr=0.9836 | 6006.3 samples/s | 23.5 steps/s
[Step= 150] | Loss=0.42780 | acc=0.0336 | tpr=0.9957 | fpr=0.9841 | 8627.2 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.42777 | acc=0.0336 | tpr=0.9967 | fpr=0.9839 | 7585.5 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.42806 | acc=0.0340 | tpr=0.9974 | fpr=0.9836 | 8635.2 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.42806 | acc=0.0338 | tpr=0.9971 | fpr=0.9838 | 7117.3 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.42815 | acc=0.0335 | tpr=0.9969 | fpr=0.9840 | 7807.0 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.42819 | acc=0.0334 | tpr=0.9956 | fpr=0.9841 | 8119.4 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.42822 | acc=0.0332 | tpr=0.9961 | fpr=0.9843 | 8250.4 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.42830 | acc=0.0330 | tpr=0.9960 | fpr=0.9844 | 8217.1 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.42825 | acc=0.0330 | tpr=0.9956 | fpr=0.9845 | 9018.0 samples/s | 35.2 steps/s
Avg test loss: 0.42824, Avg test acc: 0.03300, Avg tpr: 0.99564, Avg fpr: 0.98450, total FA: 136696

server round 2/50

clients selected: [0 1 2 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.27520 | Reg=0.00261 | acc=0.7500 | L2-Norm=16.161 | L2-Norm(final)=3.089 | 3278.5 samples/s | 51.2 steps/s
[Step=2050 Epoch=10.0] | Loss=0.27277 | Reg=0.00261 | acc=0.7969 | L2-Norm=16.159 | L2-Norm(final)=3.174 | 4725.8 samples/s | 73.8 steps/s
[Step=2100 Epoch=10.2] | Loss=0.26706 | Reg=0.00261 | acc=0.7656 | L2-Norm=16.159 | L2-Norm(final)=3.296 | 5430.4 samples/s | 84.8 steps/s
[Step=2150 Epoch=10.5] | Loss=0.26375 | Reg=0.00261 | acc=0.8281 | L2-Norm=16.159 | L2-Norm(final)=3.414 | 5479.1 samples/s | 85.6 steps/s
[Step=2200 Epoch=10.7] | Loss=0.26171 | Reg=0.00261 | acc=0.7500 | L2-Norm=16.159 | L2-Norm(final)=3.527 | 8630.2 samples/s | 134.8 steps/s
[Step=2250 Epoch=11.0] | Loss=0.25994 | Reg=0.00261 | acc=0.7812 | L2-Norm=16.159 | L2-Norm(final)=3.636 | 1468.0 samples/s | 22.9 steps/s
[Step=2300 Epoch=11.2] | Loss=0.25787 | Reg=0.00261 | acc=0.8750 | L2-Norm=16.159 | L2-Norm(final)=3.740 | 5510.4 samples/s | 86.1 steps/s
[Step=2350 Epoch=11.5] | Loss=0.25592 | Reg=0.00261 | acc=0.7188 | L2-Norm=16.159 | L2-Norm(final)=3.840 | 5485.9 samples/s | 85.7 steps/s
[Step=2400 Epoch=11.7] | Loss=0.25369 | Reg=0.00261 | acc=0.7500 | L2-Norm=16.159 | L2-Norm(final)=3.938 | 7572.1 samples/s | 118.3 steps/s
[Step=2450 Epoch=11.9] | Loss=0.25138 | Reg=0.00261 | acc=0.7656 | L2-Norm=16.159 | L2-Norm(final)=4.034 | 1491.2 samples/s | 23.3 steps/s
[Step=2500 Epoch=12.2] | Loss=0.24970 | Reg=0.00261 | acc=0.7344 | L2-Norm=16.159 | L2-Norm(final)=4.128 | 5582.1 samples/s | 87.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.22887 | Reg=0.00261 | acc=0.8594 | L2-Norm=16.159 | L2-Norm(final)=5.048 | 3132.0 samples/s | 48.9 steps/s
[Step=2550 Epoch=12.4] | Loss=0.17523 | Reg=0.00267 | acc=0.8906 | L2-Norm=16.335 | L2-Norm(final)=5.057 | 4367.3 samples/s | 68.2 steps/s
[Step=2600 Epoch=12.7] | Loss=0.15957 | Reg=0.00270 | acc=0.8438 | L2-Norm=16.443 | L2-Norm(final)=5.053 | 4797.9 samples/s | 75.0 steps/s
[Step=2650 Epoch=12.9] | Loss=0.14696 | Reg=0.00272 | acc=0.9062 | L2-Norm=16.499 | L2-Norm(final)=5.047 | 4631.3 samples/s | 72.4 steps/s
[Step=2700 Epoch=13.2] | Loss=0.13496 | Reg=0.00274 | acc=0.9062 | L2-Norm=16.542 | L2-Norm(final)=5.047 | 6762.1 samples/s | 105.7 steps/s
[Step=2750 Epoch=13.4] | Loss=0.12132 | Reg=0.00275 | acc=0.9688 | L2-Norm=16.575 | L2-Norm(final)=5.048 | 1415.7 samples/s | 22.1 steps/s
[Step=2800 Epoch=13.7] | Loss=0.11246 | Reg=0.00276 | acc=0.9531 | L2-Norm=16.605 | L2-Norm(final)=5.053 | 4728.5 samples/s | 73.9 steps/s
[Step=2850 Epoch=13.9] | Loss=0.10630 | Reg=0.00277 | acc=0.9531 | L2-Norm=16.635 | L2-Norm(final)=5.057 | 4670.7 samples/s | 73.0 steps/s
[Step=2900 Epoch=14.1] | Loss=0.10011 | Reg=0.00278 | acc=0.8906 | L2-Norm=16.661 | L2-Norm(final)=5.060 | 6180.6 samples/s | 96.6 steps/s
[Step=2950 Epoch=14.4] | Loss=0.09377 | Reg=0.00278 | acc=0.9531 | L2-Norm=16.685 | L2-Norm(final)=5.063 | 1430.0 samples/s | 22.3 steps/s
[Step=3000 Epoch=14.6] | Loss=0.08884 | Reg=0.00279 | acc=0.9531 | L2-Norm=16.709 | L2-Norm(final)=5.068 | 4689.7 samples/s | 73.3 steps/s
[Step=3050 Epoch=14.9] | Loss=0.08520 | Reg=0.00280 | acc=0.9844 | L2-Norm=16.733 | L2-Norm(final)=5.072 | 4743.9 samples/s | 74.1 steps/s
[Step=3100 Epoch=15.1] | Loss=0.08182 | Reg=0.00281 | acc=0.9531 | L2-Norm=16.756 | L2-Norm(final)=5.075 | 5628.9 samples/s | 88.0 steps/s
[Step=3150 Epoch=15.4] | Loss=0.07833 | Reg=0.00282 | acc=0.9688 | L2-Norm=16.778 | L2-Norm(final)=5.078 | 1460.2 samples/s | 22.8 steps/s
[Step=3200 Epoch=15.6] | Loss=0.07479 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.797 | L2-Norm(final)=5.081 | 4714.0 samples/s | 73.7 steps/s
[Step=3250 Epoch=15.8] | Loss=0.07179 | Reg=0.00283 | acc=0.9844 | L2-Norm=16.814 | L2-Norm(final)=5.084 | 4687.9 samples/s | 73.2 steps/s
[Step=3300 Epoch=16.1] | Loss=0.06958 | Reg=0.00283 | acc=0.9844 | L2-Norm=16.831 | L2-Norm(final)=5.087 | 5209.0 samples/s | 81.4 steps/s
[Step=3350 Epoch=16.3] | Loss=0.06742 | Reg=0.00284 | acc=0.9844 | L2-Norm=16.848 | L2-Norm(final)=5.090 | 1518.7 samples/s | 23.7 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06506 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.865 | L2-Norm(final)=5.092 | 4762.2 samples/s | 74.4 steps/s
[Step=3450 Epoch=16.8] | Loss=0.06329 | Reg=0.00285 | acc=0.9688 | L2-Norm=16.882 | L2-Norm(final)=5.095 | 4634.3 samples/s | 72.4 steps/s
[Step=3500 Epoch=17.1] | Loss=0.06184 | Reg=0.00286 | acc=0.9688 | L2-Norm=16.897 | L2-Norm(final)=5.097 | 4870.4 samples/s | 76.1 steps/s
[Step=3550 Epoch=17.3] | Loss=0.06052 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.913 | L2-Norm(final)=5.098 | 1543.4 samples/s | 24.1 steps/s
[Step=3600 Epoch=17.6] | Loss=0.05896 | Reg=0.00287 | acc=0.9688 | L2-Norm=16.928 | L2-Norm(final)=5.100 | 4560.4 samples/s | 71.3 steps/s
[Step=3650 Epoch=17.8] | Loss=0.05729 | Reg=0.00287 | acc=0.9844 | L2-Norm=16.942 | L2-Norm(final)=5.101 | 4704.0 samples/s | 73.5 steps/s
[Step=3700 Epoch=18.0] | Loss=0.05592 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.955 | L2-Norm(final)=5.103 | 4696.3 samples/s | 73.4 steps/s
[Step=3750 Epoch=18.3] | Loss=0.05439 | Reg=0.00288 | acc=0.9844 | L2-Norm=16.968 | L2-Norm(final)=5.105 | 1595.0 samples/s | 24.9 steps/s
[Step=3800 Epoch=18.5] | Loss=0.05295 | Reg=0.00288 | acc=0.9844 | L2-Norm=16.981 | L2-Norm(final)=5.107 | 4620.6 samples/s | 72.2 steps/s
[Step=3850 Epoch=18.8] | Loss=0.05183 | Reg=0.00289 | acc=0.9844 | L2-Norm=16.992 | L2-Norm(final)=5.109 | 4694.9 samples/s | 73.4 steps/s
[Step=3900 Epoch=19.0] | Loss=0.05072 | Reg=0.00289 | acc=0.9688 | L2-Norm=17.003 | L2-Norm(final)=5.111 | 4759.6 samples/s | 74.4 steps/s
[Step=3950 Epoch=19.3] | Loss=0.04985 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.013 | L2-Norm(final)=5.112 | 1558.2 samples/s | 24.3 steps/s
[Step=4000 Epoch=19.5] | Loss=0.04895 | Reg=0.00290 | acc=0.9844 | L2-Norm=17.024 | L2-Norm(final)=5.114 | 4682.4 samples/s | 73.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.31285 | Reg=0.00261 | acc=0.6406 | L2-Norm=16.161 | L2-Norm(final)=4.248 | 3086.7 samples/s | 48.2 steps/s
[Step=4050 Epoch=19.8] | Loss=0.26354 | Reg=0.00261 | acc=0.7969 | L2-Norm=16.159 | L2-Norm(final)=4.306 | 5234.5 samples/s | 81.8 steps/s
[Step=4100 Epoch=20.0] | Loss=0.26378 | Reg=0.00261 | acc=0.8125 | L2-Norm=16.159 | L2-Norm(final)=4.383 | 5455.4 samples/s | 85.2 steps/s
[Step=4150 Epoch=20.3] | Loss=0.26109 | Reg=0.00261 | acc=0.7031 | L2-Norm=16.159 | L2-Norm(final)=4.459 | 5477.3 samples/s | 85.6 steps/s
[Step=4200 Epoch=20.5] | Loss=0.25888 | Reg=0.00261 | acc=0.8281 | L2-Norm=16.159 | L2-Norm(final)=4.536 | 8633.6 samples/s | 134.9 steps/s
[Step=4250 Epoch=20.7] | Loss=0.25735 | Reg=0.00261 | acc=0.7500 | L2-Norm=16.159 | L2-Norm(final)=4.612 | 1459.2 samples/s | 22.8 steps/s
[Step=4300 Epoch=21.0] | Loss=0.25538 | Reg=0.00261 | acc=0.7344 | L2-Norm=16.159 | L2-Norm(final)=4.685 | 5390.6 samples/s | 84.2 steps/s
[Step=4350 Epoch=21.2] | Loss=0.25460 | Reg=0.00261 | acc=0.7344 | L2-Norm=16.159 | L2-Norm(final)=4.757 | 5580.7 samples/s | 87.2 steps/s
[Step=4400 Epoch=21.5] | Loss=0.25240 | Reg=0.00261 | acc=0.8281 | L2-Norm=16.159 | L2-Norm(final)=4.827 | 7727.6 samples/s | 120.7 steps/s
[Step=4450 Epoch=21.7] | Loss=0.25092 | Reg=0.00261 | acc=0.8594 | L2-Norm=16.159 | L2-Norm(final)=4.897 | 1244.4 samples/s | 19.4 steps/s
[Step=4500 Epoch=22.0] | Loss=0.24966 | Reg=0.00261 | acc=0.7500 | L2-Norm=16.159 | L2-Norm(final)=4.966 | 5527.5 samples/s | 86.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=22.0] | Loss=0.23070 | Reg=0.00261 | acc=0.7344 | L2-Norm=16.159 | L2-Norm(final)=5.645 | 3319.0 samples/s | 51.9 steps/s
[Step=4550 Epoch=22.2] | Loss=0.18733 | Reg=0.00269 | acc=0.8750 | L2-Norm=16.390 | L2-Norm(final)=5.644 | 4121.7 samples/s | 64.4 steps/s
[Step=4600 Epoch=22.4] | Loss=0.16175 | Reg=0.00273 | acc=0.9219 | L2-Norm=16.534 | L2-Norm(final)=5.640 | 4708.6 samples/s | 73.6 steps/s
[Step=4650 Epoch=22.7] | Loss=0.14916 | Reg=0.00277 | acc=0.9062 | L2-Norm=16.630 | L2-Norm(final)=5.634 | 4758.7 samples/s | 74.4 steps/s
[Step=4700 Epoch=22.9] | Loss=0.13684 | Reg=0.00279 | acc=0.8281 | L2-Norm=16.700 | L2-Norm(final)=5.634 | 6654.0 samples/s | 104.0 steps/s
[Step=4750 Epoch=23.2] | Loss=0.12398 | Reg=0.00281 | acc=0.9688 | L2-Norm=16.758 | L2-Norm(final)=5.636 | 1408.1 samples/s | 22.0 steps/s
[Step=4800 Epoch=23.4] | Loss=0.11529 | Reg=0.00283 | acc=0.9531 | L2-Norm=16.809 | L2-Norm(final)=5.639 | 4687.2 samples/s | 73.2 steps/s
[Step=4850 Epoch=23.7] | Loss=0.10990 | Reg=0.00284 | acc=0.9375 | L2-Norm=16.854 | L2-Norm(final)=5.641 | 4713.8 samples/s | 73.7 steps/s
[Step=4900 Epoch=23.9] | Loss=0.10504 | Reg=0.00286 | acc=0.9531 | L2-Norm=16.896 | L2-Norm(final)=5.643 | 6297.8 samples/s | 98.4 steps/s
[Step=4950 Epoch=24.2] | Loss=0.09889 | Reg=0.00287 | acc=0.9531 | L2-Norm=16.936 | L2-Norm(final)=5.646 | 1423.8 samples/s | 22.2 steps/s
[Step=5000 Epoch=24.4] | Loss=0.09319 | Reg=0.00288 | acc=0.9688 | L2-Norm=16.972 | L2-Norm(final)=5.650 | 4704.9 samples/s | 73.5 steps/s
[Step=5050 Epoch=24.6] | Loss=0.08904 | Reg=0.00289 | acc=0.9688 | L2-Norm=17.006 | L2-Norm(final)=5.654 | 4704.6 samples/s | 73.5 steps/s
[Step=5100 Epoch=24.9] | Loss=0.08631 | Reg=0.00290 | acc=0.9844 | L2-Norm=17.036 | L2-Norm(final)=5.657 | 5849.1 samples/s | 91.4 steps/s
[Step=5150 Epoch=25.1] | Loss=0.08329 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.065 | L2-Norm(final)=5.659 | 1466.4 samples/s | 22.9 steps/s
[Step=5200 Epoch=25.4] | Loss=0.07929 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.093 | L2-Norm(final)=5.662 | 4591.1 samples/s | 71.7 steps/s
[Step=5250 Epoch=25.6] | Loss=0.07667 | Reg=0.00293 | acc=0.9531 | L2-Norm=17.119 | L2-Norm(final)=5.665 | 4704.0 samples/s | 73.5 steps/s
[Step=5300 Epoch=25.9] | Loss=0.07421 | Reg=0.00294 | acc=0.9844 | L2-Norm=17.144 | L2-Norm(final)=5.668 | 5469.1 samples/s | 85.5 steps/s
[Step=5350 Epoch=26.1] | Loss=0.07192 | Reg=0.00295 | acc=0.9844 | L2-Norm=17.167 | L2-Norm(final)=5.670 | 1479.5 samples/s | 23.1 steps/s
[Step=5400 Epoch=26.3] | Loss=0.06931 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.189 | L2-Norm(final)=5.672 | 4678.7 samples/s | 73.1 steps/s
[Step=5450 Epoch=26.6] | Loss=0.06700 | Reg=0.00296 | acc=0.9688 | L2-Norm=17.209 | L2-Norm(final)=5.674 | 4748.1 samples/s | 74.2 steps/s
[Step=5500 Epoch=26.8] | Loss=0.06534 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.228 | L2-Norm(final)=5.676 | 5080.8 samples/s | 79.4 steps/s
[Step=5550 Epoch=27.1] | Loss=0.06358 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.245 | L2-Norm(final)=5.677 | 1520.2 samples/s | 23.8 steps/s
[Step=5600 Epoch=27.3] | Loss=0.06166 | Reg=0.00298 | acc=0.9844 | L2-Norm=17.262 | L2-Norm(final)=5.678 | 4694.5 samples/s | 73.4 steps/s
[Step=5650 Epoch=27.6] | Loss=0.05984 | Reg=0.00299 | acc=0.9688 | L2-Norm=17.278 | L2-Norm(final)=5.681 | 4699.7 samples/s | 73.4 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05823 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.293 | L2-Norm(final)=5.683 | 4812.2 samples/s | 75.2 steps/s
[Step=5750 Epoch=28.1] | Loss=0.05692 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.308 | L2-Norm(final)=5.685 | 1518.4 samples/s | 23.7 steps/s
[Step=5800 Epoch=28.3] | Loss=0.05546 | Reg=0.00300 | acc=0.9688 | L2-Norm=17.322 | L2-Norm(final)=5.687 | 4782.2 samples/s | 74.7 steps/s
[Step=5850 Epoch=28.5] | Loss=0.05422 | Reg=0.00301 | acc=0.9844 | L2-Norm=17.336 | L2-Norm(final)=5.690 | 4632.7 samples/s | 72.4 steps/s
[Step=5900 Epoch=28.8] | Loss=0.05298 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.348 | L2-Norm(final)=5.692 | 4715.8 samples/s | 73.7 steps/s
[Step=5950 Epoch=29.0] | Loss=0.05185 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.360 | L2-Norm(final)=5.693 | 1574.6 samples/s | 24.6 steps/s
[Step=6000 Epoch=29.3] | Loss=0.05086 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.371 | L2-Norm(final)=5.695 | 4694.5 samples/s | 73.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_1/client_state-step6000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35964 | Reg=0.00261 | acc=0.4219 | L2-Norm=16.161 | L2-Norm(final)=1.884 | 3298.3 samples/s | 51.5 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.33050 | Reg=0.00261 | acc=0.8125 | L2-Norm=16.161 | L2-Norm(final)=1.919 | 5166.0 samples/s | 80.7 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.31928 | Reg=0.00261 | acc=0.8438 | L2-Norm=16.161 | L2-Norm(final)=1.999 | 6214.6 samples/s | 97.1 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.30941 | Reg=0.00261 | acc=0.8281 | L2-Norm=16.161 | L2-Norm(final)=2.114 | 6250.4 samples/s | 97.7 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.30130 | Reg=0.00261 | acc=0.7969 | L2-Norm=16.161 | L2-Norm(final)=2.248 | 9886.2 samples/s | 154.5 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.29494 | Reg=0.00261 | acc=0.7500 | L2-Norm=16.161 | L2-Norm(final)=2.389 | 1532.3 samples/s | 23.9 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.28843 | Reg=0.00261 | acc=0.8438 | L2-Norm=16.161 | L2-Norm(final)=2.535 | 6293.2 samples/s | 98.3 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.28357 | Reg=0.00261 | acc=0.8125 | L2-Norm=16.161 | L2-Norm(final)=2.681 | 6253.6 samples/s | 97.7 steps/s
[Step= 400 Epoch= 1.9] | Loss=0.27880 | Reg=0.00261 | acc=0.7656 | L2-Norm=16.161 | L2-Norm(final)=2.824 | 8437.8 samples/s | 131.8 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.27443 | Reg=0.00261 | acc=0.7656 | L2-Norm=16.161 | L2-Norm(final)=2.966 | 1605.0 samples/s | 25.1 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.27071 | Reg=0.00261 | acc=0.8750 | L2-Norm=16.161 | L2-Norm(final)=3.106 | 6045.7 samples/s | 94.5 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.24563 | Reg=0.00261 | acc=0.8125 | L2-Norm=16.161 | L2-Norm(final)=4.489 | 3143.8 samples/s | 49.1 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.18078 | Reg=0.00258 | acc=0.7969 | L2-Norm=16.047 | L2-Norm(final)=4.528 | 4330.4 samples/s | 67.7 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.15731 | Reg=0.00258 | acc=0.8906 | L2-Norm=16.060 | L2-Norm(final)=4.551 | 4698.2 samples/s | 73.4 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.14947 | Reg=0.00259 | acc=0.9062 | L2-Norm=16.081 | L2-Norm(final)=4.565 | 4729.0 samples/s | 73.9 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.14075 | Reg=0.00259 | acc=0.9375 | L2-Norm=16.108 | L2-Norm(final)=4.575 | 6747.4 samples/s | 105.4 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.12923 | Reg=0.00260 | acc=0.9375 | L2-Norm=16.138 | L2-Norm(final)=4.588 | 1413.3 samples/s | 22.1 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.11860 | Reg=0.00262 | acc=0.9375 | L2-Norm=16.171 | L2-Norm(final)=4.606 | 4690.3 samples/s | 73.3 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.11167 | Reg=0.00263 | acc=0.9688 | L2-Norm=16.202 | L2-Norm(final)=4.621 | 4768.3 samples/s | 74.5 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.10708 | Reg=0.00264 | acc=0.9531 | L2-Norm=16.233 | L2-Norm(final)=4.635 | 6030.7 samples/s | 94.2 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.10087 | Reg=0.00265 | acc=0.9531 | L2-Norm=16.264 | L2-Norm(final)=4.649 | 1459.9 samples/s | 22.8 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.09497 | Reg=0.00266 | acc=0.9531 | L2-Norm=16.293 | L2-Norm(final)=4.664 | 4678.0 samples/s | 73.1 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.09076 | Reg=0.00266 | acc=0.8906 | L2-Norm=16.322 | L2-Norm(final)=4.678 | 4725.7 samples/s | 73.8 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.08742 | Reg=0.00267 | acc=0.8906 | L2-Norm=16.348 | L2-Norm(final)=4.690 | 5682.2 samples/s | 88.8 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.08414 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.373 | L2-Norm(final)=4.701 | 1483.2 samples/s | 23.2 steps/s
[Step=1200 Epoch= 5.8] | Loss=0.08050 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.398 | L2-Norm(final)=4.712 | 4771.3 samples/s | 74.6 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.07729 | Reg=0.00270 | acc=0.9688 | L2-Norm=16.422 | L2-Norm(final)=4.724 | 4691.2 samples/s | 73.3 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.07486 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.447 | L2-Norm(final)=4.734 | 5208.4 samples/s | 81.4 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.07274 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.471 | L2-Norm(final)=4.745 | 1557.0 samples/s | 24.3 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.07011 | Reg=0.00272 | acc=0.9688 | L2-Norm=16.495 | L2-Norm(final)=4.754 | 4722.6 samples/s | 73.8 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.06794 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.518 | L2-Norm(final)=4.764 | 4705.8 samples/s | 73.5 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.06639 | Reg=0.00274 | acc=0.9219 | L2-Norm=16.540 | L2-Norm(final)=4.772 | 4813.3 samples/s | 75.2 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.06454 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.562 | L2-Norm(final)=4.780 | 1536.8 samples/s | 24.0 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06286 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.584 | L2-Norm(final)=4.787 | 4667.4 samples/s | 72.9 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.06122 | Reg=0.00276 | acc=0.9844 | L2-Norm=16.605 | L2-Norm(final)=4.794 | 4716.1 samples/s | 73.7 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.05989 | Reg=0.00277 | acc=0.9844 | L2-Norm=16.626 | L2-Norm(final)=4.801 | 4788.4 samples/s | 74.8 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.05847 | Reg=0.00277 | acc=0.9844 | L2-Norm=16.645 | L2-Norm(final)=4.808 | 1564.3 samples/s | 24.4 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.05694 | Reg=0.00278 | acc=0.9844 | L2-Norm=16.664 | L2-Norm(final)=4.815 | 4680.0 samples/s | 73.1 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.05595 | Reg=0.00278 | acc=0.9844 | L2-Norm=16.683 | L2-Norm(final)=4.821 | 4652.7 samples/s | 72.7 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.05522 | Reg=0.00279 | acc=0.9531 | L2-Norm=16.702 | L2-Norm(final)=4.826 | 4693.3 samples/s | 73.3 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.05427 | Reg=0.00280 | acc=0.9688 | L2-Norm=16.721 | L2-Norm(final)=4.831 | 1560.9 samples/s | 24.4 steps/s
[Step=2000 Epoch= 9.7] | Loss=0.05297 | Reg=0.00280 | acc=0.9688 | L2-Norm=16.740 | L2-Norm(final)=4.836 | 4645.7 samples/s | 72.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_2/client_state-step2000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=38.2] | Loss=0.13538 | Reg=0.00261 | acc=0.8750 | L2-Norm=16.161 | L2-Norm(final)=7.164 | 3149.1 samples/s | 49.2 steps/s
[Step=4050 Epoch=38.7] | Loss=0.11326 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.151 | L2-Norm(final)=7.272 | 4568.6 samples/s | 71.4 steps/s
[Step=4100 Epoch=39.2] | Loss=0.10427 | Reg=0.00261 | acc=0.9688 | L2-Norm=16.150 | L2-Norm(final)=7.420 | 8406.3 samples/s | 131.3 steps/s
[Step=4150 Epoch=39.6] | Loss=0.09707 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.149 | L2-Norm(final)=7.559 | 1437.7 samples/s | 22.5 steps/s
[Step=4200 Epoch=40.1] | Loss=0.09339 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.149 | L2-Norm(final)=7.689 | 7189.6 samples/s | 112.3 steps/s
[Step=4250 Epoch=40.6] | Loss=0.08993 | Reg=0.00261 | acc=0.9375 | L2-Norm=16.149 | L2-Norm(final)=7.812 | 1476.0 samples/s | 23.1 steps/s
[Step=4300 Epoch=41.1] | Loss=0.08704 | Reg=0.00261 | acc=0.9219 | L2-Norm=16.149 | L2-Norm(final)=7.928 | 6722.0 samples/s | 105.0 steps/s
[Step=4350 Epoch=41.5] | Loss=0.08440 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.149 | L2-Norm(final)=8.039 | 1532.0 samples/s | 23.9 steps/s
[Step=4400 Epoch=42.0] | Loss=0.08264 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.149 | L2-Norm(final)=8.145 | 6117.0 samples/s | 95.6 steps/s
[Step=4450 Epoch=42.5] | Loss=0.08086 | Reg=0.00261 | acc=0.9219 | L2-Norm=16.149 | L2-Norm(final)=8.247 | 1520.9 samples/s | 23.8 steps/s
[Step=4500 Epoch=43.0] | Loss=0.07886 | Reg=0.00261 | acc=0.9688 | L2-Norm=16.149 | L2-Norm(final)=8.345 | 5794.2 samples/s | 90.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=43.0] | Loss=0.06305 | Reg=0.00261 | acc=0.9688 | L2-Norm=16.149 | L2-Norm(final)=9.316 | 3173.7 samples/s | 49.6 steps/s
[Step=4550 Epoch=43.4] | Loss=0.03893 | Reg=0.00270 | acc=0.9844 | L2-Norm=16.423 | L2-Norm(final)=9.314 | 4048.3 samples/s | 63.3 steps/s
[Step=4600 Epoch=43.9] | Loss=0.02414 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.533 | L2-Norm(final)=9.305 | 6597.8 samples/s | 103.1 steps/s
[Step=4650 Epoch=44.4] | Loss=0.01632 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.554 | L2-Norm(final)=9.305 | 1395.0 samples/s | 21.8 steps/s
[Step=4700 Epoch=44.9] | Loss=0.01229 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.539 | L2-Norm(final)=9.306 | 5980.9 samples/s | 93.5 steps/s
[Step=4750 Epoch=45.4] | Loss=0.00998 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.511 | L2-Norm(final)=9.307 | 1401.0 samples/s | 21.9 steps/s
[Step=4800 Epoch=45.8] | Loss=0.00833 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.478 | L2-Norm(final)=9.309 | 5632.6 samples/s | 88.0 steps/s
[Step=4850 Epoch=46.3] | Loss=0.00715 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.440 | L2-Norm(final)=9.310 | 1437.3 samples/s | 22.5 steps/s
[Step=4900 Epoch=46.8] | Loss=0.00626 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.401 | L2-Norm(final)=9.311 | 5166.9 samples/s | 80.7 steps/s
[Step=4950 Epoch=47.3] | Loss=0.00556 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.361 | L2-Norm(final)=9.312 | 1453.8 samples/s | 22.7 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00501 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.320 | L2-Norm(final)=9.313 | 4903.0 samples/s | 76.6 steps/s
[Step=5050 Epoch=48.2] | Loss=0.00456 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.279 | L2-Norm(final)=9.314 | 1469.9 samples/s | 23.0 steps/s
[Step=5100 Epoch=48.7] | Loss=0.00418 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.238 | L2-Norm(final)=9.314 | 4591.4 samples/s | 71.7 steps/s
[Step=5150 Epoch=49.2] | Loss=0.00386 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.198 | L2-Norm(final)=9.315 | 1546.1 samples/s | 24.2 steps/s
[Step=5200 Epoch=49.7] | Loss=0.00358 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.157 | L2-Norm(final)=9.316 | 4542.6 samples/s | 71.0 steps/s
[Step=5250 Epoch=50.1] | Loss=0.00334 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.117 | L2-Norm(final)=9.316 | 1513.0 samples/s | 23.6 steps/s
[Step=5300 Epoch=50.6] | Loss=0.00314 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.077 | L2-Norm(final)=9.317 | 4518.5 samples/s | 70.6 steps/s
[Step=5350 Epoch=51.1] | Loss=0.00295 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.037 | L2-Norm(final)=9.317 | 1545.6 samples/s | 24.2 steps/s
[Step=5400 Epoch=51.6] | Loss=0.00279 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.998 | L2-Norm(final)=9.318 | 4489.3 samples/s | 70.1 steps/s
[Step=5450 Epoch=52.0] | Loss=0.00264 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.958 | L2-Norm(final)=9.318 | 1509.3 samples/s | 23.6 steps/s
[Step=5500 Epoch=52.5] | Loss=0.00251 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.919 | L2-Norm(final)=9.319 | 4475.8 samples/s | 69.9 steps/s
[Step=5550 Epoch=53.0] | Loss=0.00239 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.881 | L2-Norm(final)=9.319 | 7278.4 samples/s | 113.7 steps/s
[Step=5600 Epoch=53.5] | Loss=0.00228 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.842 | L2-Norm(final)=9.319 | 1348.2 samples/s | 21.1 steps/s
[Step=5650 Epoch=54.0] | Loss=0.00218 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.804 | L2-Norm(final)=9.320 | 6645.0 samples/s | 103.8 steps/s
[Step=5700 Epoch=54.4] | Loss=0.00209 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.766 | L2-Norm(final)=9.320 | 1367.3 samples/s | 21.4 steps/s
[Step=5750 Epoch=54.9] | Loss=0.00201 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.728 | L2-Norm(final)=9.321 | 6071.7 samples/s | 94.9 steps/s
[Step=5800 Epoch=55.4] | Loss=0.00193 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.691 | L2-Norm(final)=9.321 | 1413.0 samples/s | 22.1 steps/s
[Step=5850 Epoch=55.9] | Loss=0.00186 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.653 | L2-Norm(final)=9.321 | 5610.3 samples/s | 87.7 steps/s
[Step=5900 Epoch=56.3] | Loss=0.00180 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.616 | L2-Norm(final)=9.322 | 1443.1 samples/s | 22.5 steps/s
[Step=5950 Epoch=56.8] | Loss=0.00173 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.579 | L2-Norm(final)=9.322 | 5196.9 samples/s | 81.2 steps/s
[Step=6000 Epoch=57.3] | Loss=0.00168 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.542 | L2-Norm(final)=9.322 | 1462.8 samples/s | 22.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step6000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.31662 | Reg=0.00261 | acc=0.5938 | L2-Norm=16.161 | L2-Norm(final)=1.884 | 3267.1 samples/s | 51.0 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.29112 | Reg=0.00261 | acc=0.7500 | L2-Norm=16.161 | L2-Norm(final)=1.966 | 4876.7 samples/s | 76.2 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.27087 | Reg=0.00261 | acc=0.8438 | L2-Norm=16.161 | L2-Norm(final)=2.118 | 9478.0 samples/s | 148.1 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.25488 | Reg=0.00261 | acc=0.9531 | L2-Norm=16.161 | L2-Norm(final)=2.305 | 1499.4 samples/s | 23.4 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.24058 | Reg=0.00261 | acc=0.8750 | L2-Norm=16.161 | L2-Norm(final)=2.510 | 7710.3 samples/s | 120.5 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.22740 | Reg=0.00261 | acc=0.9375 | L2-Norm=16.161 | L2-Norm(final)=2.721 | 1509.7 samples/s | 23.6 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.21764 | Reg=0.00261 | acc=0.8906 | L2-Norm=16.161 | L2-Norm(final)=2.933 | 7681.5 samples/s | 120.0 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.20842 | Reg=0.00261 | acc=0.9531 | L2-Norm=16.161 | L2-Norm(final)=3.140 | 1564.4 samples/s | 24.4 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.20050 | Reg=0.00261 | acc=0.9062 | L2-Norm=16.161 | L2-Norm(final)=3.343 | 7107.0 samples/s | 111.0 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.19335 | Reg=0.00261 | acc=0.8594 | L2-Norm=16.161 | L2-Norm(final)=3.539 | 1567.0 samples/s | 24.5 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.18726 | Reg=0.00261 | acc=0.9531 | L2-Norm=16.161 | L2-Norm(final)=3.730 | 6442.9 samples/s | 100.7 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.8] | Loss=0.12254 | Reg=0.00261 | acc=0.9219 | L2-Norm=16.161 | L2-Norm(final)=5.606 | 3224.3 samples/s | 50.4 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.04148 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.096 | L2-Norm(final)=5.675 | 3903.8 samples/s | 61.0 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.02508 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.080 | L2-Norm(final)=5.702 | 6595.0 samples/s | 103.0 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01779 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.065 | L2-Norm(final)=5.717 | 1361.9 samples/s | 21.3 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01380 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.047 | L2-Norm(final)=5.729 | 6058.9 samples/s | 94.7 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01107 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.023 | L2-Norm(final)=5.738 | 1395.1 samples/s | 21.8 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.00923 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.990 | L2-Norm(final)=5.745 | 5538.2 samples/s | 86.5 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.00792 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.953 | L2-Norm(final)=5.751 | 1478.7 samples/s | 23.1 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.00693 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.912 | L2-Norm(final)=5.755 | 5202.5 samples/s | 81.3 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.00616 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.869 | L2-Norm(final)=5.758 | 1458.5 samples/s | 22.8 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.00555 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.825 | L2-Norm(final)=5.761 | 4789.5 samples/s | 74.8 steps/s
[Step=1050 Epoch=10.0] | Loss=0.00505 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.779 | L2-Norm(final)=5.764 | 1498.3 samples/s | 23.4 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00463 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.733 | L2-Norm(final)=5.766 | 4602.4 samples/s | 71.9 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00427 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.687 | L2-Norm(final)=5.768 | 1494.6 samples/s | 23.4 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00397 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.639 | L2-Norm(final)=5.770 | 4516.1 samples/s | 70.6 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00370 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.592 | L2-Norm(final)=5.772 | 1511.2 samples/s | 23.6 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00347 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.544 | L2-Norm(final)=5.774 | 4509.0 samples/s | 70.5 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00327 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.496 | L2-Norm(final)=5.775 | 1517.7 samples/s | 23.7 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00309 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.448 | L2-Norm(final)=5.776 | 4481.1 samples/s | 70.0 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00293 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.400 | L2-Norm(final)=5.778 | 1530.6 samples/s | 23.9 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00278 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.351 | L2-Norm(final)=5.779 | 4455.2 samples/s | 69.6 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00265 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.303 | L2-Norm(final)=5.780 | 7285.2 samples/s | 113.8 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00253 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.254 | L2-Norm(final)=5.781 | 1359.1 samples/s | 21.2 steps/s
[Step=1650 Epoch=15.7] | Loss=0.00242 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.206 | L2-Norm(final)=5.782 | 6352.0 samples/s | 99.2 steps/s
[Step=1700 Epoch=16.2] | Loss=0.00232 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.158 | L2-Norm(final)=5.783 | 1366.5 samples/s | 21.4 steps/s
[Step=1750 Epoch=16.7] | Loss=0.00223 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.109 | L2-Norm(final)=5.784 | 6095.1 samples/s | 95.2 steps/s
[Step=1800 Epoch=17.2] | Loss=0.00214 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.061 | L2-Norm(final)=5.785 | 1429.2 samples/s | 22.3 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00206 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.012 | L2-Norm(final)=5.786 | 5503.8 samples/s | 86.0 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00199 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.964 | L2-Norm(final)=5.787 | 1472.1 samples/s | 23.0 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00192 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.916 | L2-Norm(final)=5.788 | 5204.4 samples/s | 81.3 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00186 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.868 | L2-Norm(final)=5.789 | 1456.6 samples/s | 22.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.15683 | acc=0.9297 | tpr=0.9536 | fpr=0.1222 | 4728.0 samples/s | 18.5 steps/s
Avg test loss: 0.16625, Avg test acc: 0.92612, Avg tpr: 0.95133, Avg fpr: 0.12934, total FA: 1009

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14434 | acc=0.9268 | tpr=0.9482 | fpr=0.1197 | 4789.7 samples/s | 18.7 steps/s
Avg test loss: 0.14888, Avg test acc: 0.92479, Avg tpr: 0.94504, Avg fpr: 0.11973, total FA: 934

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.16279 | acc=0.9205 | tpr=0.9228 | fpr=0.0842 | 4361.4 samples/s | 17.0 steps/s
Avg test loss: 0.16840, Avg test acc: 0.91878, Avg tpr: 0.92137, Avg fpr: 0.08691, total FA: 678

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.16932 | acc=0.9149 | tpr=0.9459 | fpr=0.1524 | 4776.7 samples/s | 18.7 steps/s
Avg test loss: 0.17192, Avg test acc: 0.91634, Avg tpr: 0.94865, Avg fpr: 0.15472, total FA: 1207

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.33024 | acc=0.6731 | tpr=0.9720 | fpr=0.9760 | 4545.4 samples/s | 17.8 steps/s
Avg test loss: 0.32979, Avg test acc: 0.67465, Avg tpr: 0.97109, Avg fpr: 0.97731, total FA: 7624

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.56137 | acc=0.3142 | tpr=0.0100 | fpr=0.0253 | 4645.6 samples/s | 18.1 steps/s
Avg test loss: 6.57903, Avg test acc: 0.31176, Avg tpr: 0.00944, Avg fpr: 0.02333, total FA: 182

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.00409 | acc=0.3272 | tpr=0.0480 | fpr=0.0667 | 4742.5 samples/s | 18.5 steps/s
Avg test loss: 4.02813, Avg test acc: 0.32623, Avg tpr: 0.04779, Avg fpr: 0.06140, total FA: 479

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=3.92073 | acc=0.3219 | tpr=0.0399 | fpr=0.0659 | 4820.0 samples/s | 18.8 steps/s
Avg test loss: 3.94040, Avg test acc: 0.31978, Avg tpr: 0.04045, Avg fpr: 0.06589, total FA: 514

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.62448 | acc=0.3311 | tpr=0.0577 | fpr=0.0753 | 4704.3 samples/s | 18.4 steps/s
Avg test loss: 4.65194, Avg test acc: 0.32927, Avg tpr: 0.05572, Avg fpr: 0.06909, total FA: 539

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.84014 | acc=0.3270 | tpr=0.0408 | fpr=0.0515 | 4686.1 samples/s | 18.3 steps/s
Avg test loss: 4.86085, Avg test acc: 0.32595, Avg tpr: 0.04068, Avg fpr: 0.04666, total FA: 364

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.81057 | acc=0.1252 | tpr=0.9027 | fpr=0.8888 | 4639.4 samples/s | 18.1 steps/s
[Step= 100] | Loss=5.81266 | acc=0.1246 | tpr=0.8913 | fpr=0.8897 | 7766.2 samples/s | 30.3 steps/s
[Step= 150] | Loss=5.81512 | acc=0.1258 | tpr=0.8934 | fpr=0.8884 | 8173.2 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.80688 | acc=0.1256 | tpr=0.8962 | fpr=0.8884 | 8097.2 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.81743 | acc=0.1259 | tpr=0.8934 | fpr=0.8881 | 8031.6 samples/s | 31.4 steps/s
[Step= 300] | Loss=5.81567 | acc=0.1263 | tpr=0.8982 | fpr=0.8878 | 7936.3 samples/s | 31.0 steps/s
[Step= 350] | Loss=5.82129 | acc=0.1258 | tpr=0.8992 | fpr=0.8882 | 7983.4 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.82033 | acc=0.1253 | tpr=0.8988 | fpr=0.8887 | 8045.2 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.81909 | acc=0.1253 | tpr=0.8992 | fpr=0.8888 | 8206.1 samples/s | 32.1 steps/s
[Step= 500] | Loss=5.82108 | acc=0.1253 | tpr=0.8996 | fpr=0.8887 | 7488.4 samples/s | 29.3 steps/s
[Step= 550] | Loss=5.82154 | acc=0.1254 | tpr=0.9005 | fpr=0.8887 | 10638.2 samples/s | 41.6 steps/s
Avg test loss: 5.82171, Avg test acc: 0.12538, Avg tpr: 0.90016, Avg fpr: 0.88871, total FA: 123395

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.15785 | acc=0.1488 | tpr=0.8142 | fpr=0.8631 | 4692.8 samples/s | 18.3 steps/s
[Step= 100] | Loss=4.16745 | acc=0.1495 | tpr=0.8273 | fpr=0.8631 | 8082.1 samples/s | 31.6 steps/s
[Step= 150] | Loss=4.17109 | acc=0.1505 | tpr=0.8444 | fpr=0.8623 | 7313.7 samples/s | 28.6 steps/s
[Step= 200] | Loss=4.16197 | acc=0.1510 | tpr=0.8514 | fpr=0.8618 | 8138.0 samples/s | 31.8 steps/s
[Step= 250] | Loss=4.16852 | acc=0.1514 | tpr=0.8454 | fpr=0.8613 | 8447.5 samples/s | 33.0 steps/s
[Step= 300] | Loss=4.16977 | acc=0.1516 | tpr=0.8415 | fpr=0.8610 | 8074.7 samples/s | 31.5 steps/s
[Step= 350] | Loss=4.17332 | acc=0.1515 | tpr=0.8403 | fpr=0.8610 | 8249.4 samples/s | 32.2 steps/s
[Step= 400] | Loss=4.17405 | acc=0.1513 | tpr=0.8425 | fpr=0.8612 | 8051.9 samples/s | 31.5 steps/s
[Step= 450] | Loss=4.17480 | acc=0.1509 | tpr=0.8408 | fpr=0.8616 | 7463.2 samples/s | 29.2 steps/s
[Step= 500] | Loss=4.17432 | acc=0.1512 | tpr=0.8410 | fpr=0.8612 | 8626.7 samples/s | 33.7 steps/s
[Step= 550] | Loss=4.17389 | acc=0.1513 | tpr=0.8464 | fpr=0.8614 | 9462.1 samples/s | 37.0 steps/s
Avg test loss: 4.17527, Avg test acc: 0.15118, Avg tpr: 0.84667, Avg fpr: 0.86146, total FA: 119612

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.00332 | acc=0.1375 | tpr=0.8496 | fpr=0.8753 | 4585.0 samples/s | 17.9 steps/s
[Step= 100] | Loss=4.98696 | acc=0.1412 | tpr=0.8571 | fpr=0.8721 | 8028.2 samples/s | 31.4 steps/s
[Step= 150] | Loss=4.98563 | acc=0.1424 | tpr=0.8444 | fpr=0.8705 | 8166.2 samples/s | 31.9 steps/s
[Step= 200] | Loss=4.97103 | acc=0.1424 | tpr=0.8481 | fpr=0.8704 | 8106.5 samples/s | 31.7 steps/s
[Step= 250] | Loss=4.97581 | acc=0.1431 | tpr=0.8454 | fpr=0.8697 | 7837.9 samples/s | 30.6 steps/s
[Step= 300] | Loss=4.97708 | acc=0.1432 | tpr=0.8531 | fpr=0.8697 | 7580.5 samples/s | 29.6 steps/s
[Step= 350] | Loss=4.97685 | acc=0.1432 | tpr=0.8547 | fpr=0.8697 | 8303.6 samples/s | 32.4 steps/s
[Step= 400] | Loss=4.97787 | acc=0.1433 | tpr=0.8567 | fpr=0.8697 | 7579.9 samples/s | 29.6 steps/s
[Step= 450] | Loss=4.98027 | acc=0.1428 | tpr=0.8559 | fpr=0.8701 | 8186.7 samples/s | 32.0 steps/s
[Step= 500] | Loss=4.98009 | acc=0.1430 | tpr=0.8529 | fpr=0.8698 | 8238.9 samples/s | 32.2 steps/s
[Step= 550] | Loss=4.97635 | acc=0.1434 | tpr=0.8532 | fpr=0.8695 | 10412.6 samples/s | 40.7 steps/s
Avg test loss: 4.97751, Avg test acc: 0.14332, Avg tpr: 0.85341, Avg fpr: 0.86959, total FA: 120741

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=3.88889 | acc=0.1301 | tpr=0.9027 | fpr=0.8838 | 4623.1 samples/s | 18.1 steps/s
[Step= 100] | Loss=3.88015 | acc=0.1293 | tpr=0.9019 | fpr=0.8851 | 7924.2 samples/s | 31.0 steps/s
[Step= 150] | Loss=3.88394 | acc=0.1295 | tpr=0.9092 | fpr=0.8849 | 7591.5 samples/s | 29.7 steps/s
[Step= 200] | Loss=3.87764 | acc=0.1283 | tpr=0.9082 | fpr=0.8859 | 8389.5 samples/s | 32.8 steps/s
[Step= 250] | Loss=3.88172 | acc=0.1290 | tpr=0.9066 | fpr=0.8851 | 7574.2 samples/s | 29.6 steps/s
[Step= 300] | Loss=3.87763 | acc=0.1294 | tpr=0.9098 | fpr=0.8848 | 8452.9 samples/s | 33.0 steps/s
[Step= 350] | Loss=3.87981 | acc=0.1292 | tpr=0.9054 | fpr=0.8849 | 7639.3 samples/s | 29.8 steps/s
[Step= 400] | Loss=3.87920 | acc=0.1294 | tpr=0.9015 | fpr=0.8847 | 7862.7 samples/s | 30.7 steps/s
[Step= 450] | Loss=3.88059 | acc=0.1291 | tpr=0.8997 | fpr=0.8849 | 7775.5 samples/s | 30.4 steps/s
[Step= 500] | Loss=3.88041 | acc=0.1292 | tpr=0.9035 | fpr=0.8848 | 8398.5 samples/s | 32.8 steps/s
[Step= 550] | Loss=3.87837 | acc=0.1291 | tpr=0.9045 | fpr=0.8849 | 10966.7 samples/s | 42.8 steps/s
Avg test loss: 3.87931, Avg test acc: 0.12904, Avg tpr: 0.90452, Avg fpr: 0.88505, total FA: 122888

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=0.42796 | acc=0.0340 | tpr=0.9956 | fpr=0.9833 | 4680.0 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.42727 | acc=0.0343 | tpr=0.9936 | fpr=0.9836 | 8356.9 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.42780 | acc=0.0336 | tpr=0.9957 | fpr=0.9841 | 7882.9 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.42777 | acc=0.0336 | tpr=0.9967 | fpr=0.9839 | 8178.9 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.42806 | acc=0.0340 | tpr=0.9974 | fpr=0.9836 | 8058.2 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.42806 | acc=0.0338 | tpr=0.9971 | fpr=0.9838 | 7398.4 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.42815 | acc=0.0335 | tpr=0.9969 | fpr=0.9840 | 7994.0 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.42819 | acc=0.0334 | tpr=0.9956 | fpr=0.9841 | 7658.2 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.42822 | acc=0.0332 | tpr=0.9961 | fpr=0.9843 | 8244.1 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.42830 | acc=0.0330 | tpr=0.9960 | fpr=0.9844 | 7784.9 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.42825 | acc=0.0330 | tpr=0.9956 | fpr=0.9845 | 10463.3 samples/s | 40.9 steps/s
Avg test loss: 0.42824, Avg test acc: 0.03300, Avg tpr: 0.99564, Avg fpr: 0.98450, total FA: 136696

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10685 | acc=0.9652 | tpr=0.9292 | fpr=0.0342 | 4704.8 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.10904 | acc=0.9650 | tpr=0.9339 | fpr=0.0344 | 8047.6 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.11006 | acc=0.9643 | tpr=0.9337 | fpr=0.0351 | 8027.1 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.11037 | acc=0.9644 | tpr=0.9377 | fpr=0.0351 | 7470.5 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.11115 | acc=0.9640 | tpr=0.9389 | fpr=0.0356 | 8633.8 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.11263 | acc=0.9633 | tpr=0.9360 | fpr=0.0362 | 7543.1 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.11275 | acc=0.9634 | tpr=0.9349 | fpr=0.0361 | 7861.3 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.11308 | acc=0.9632 | tpr=0.9322 | fpr=0.0363 | 8346.2 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.11392 | acc=0.9631 | tpr=0.9314 | fpr=0.0364 | 8365.7 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.11404 | acc=0.9629 | tpr=0.9330 | fpr=0.0366 | 7523.4 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.11352 | acc=0.9629 | tpr=0.9327 | fpr=0.0366 | 10211.0 samples/s | 39.9 steps/s
Avg test loss: 0.11337, Avg test acc: 0.96289, Avg tpr: 0.93265, Avg fpr: 0.03657, total FA: 5077

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10469 | acc=0.9652 | tpr=0.8982 | fpr=0.0336 | 4665.4 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.10479 | acc=0.9644 | tpr=0.9168 | fpr=0.0347 | 7506.9 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.10596 | acc=0.9633 | tpr=0.9164 | fpr=0.0358 | 7895.1 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.10633 | acc=0.9630 | tpr=0.9115 | fpr=0.0360 | 7488.0 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.10708 | acc=0.9627 | tpr=0.9057 | fpr=0.0362 | 8122.5 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.10837 | acc=0.9623 | tpr=0.9040 | fpr=0.0366 | 8169.7 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.10845 | acc=0.9623 | tpr=0.9067 | fpr=0.0367 | 8068.2 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.10907 | acc=0.9619 | tpr=0.9010 | fpr=0.0370 | 8280.9 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.11010 | acc=0.9617 | tpr=0.8987 | fpr=0.0371 | 7817.4 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.10972 | acc=0.9619 | tpr=0.9009 | fpr=0.0370 | 7446.4 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.10953 | acc=0.9620 | tpr=0.8977 | fpr=0.0369 | 12947.8 samples/s | 50.6 steps/s
Avg test loss: 0.10923, Avg test acc: 0.96201, Avg tpr: 0.89818, Avg fpr: 0.03683, total FA: 5114

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.23833 | acc=0.9477 | tpr=0.9159 | fpr=0.0518 | 4802.2 samples/s | 18.8 steps/s
[Step= 100] | Loss=0.24201 | acc=0.9478 | tpr=0.9190 | fpr=0.0516 | 7588.8 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.24700 | acc=0.9468 | tpr=0.9222 | fpr=0.0527 | 8265.9 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.24893 | acc=0.9468 | tpr=0.9235 | fpr=0.0528 | 7811.3 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.25040 | acc=0.9466 | tpr=0.9214 | fpr=0.0530 | 7652.9 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.25354 | acc=0.9456 | tpr=0.9164 | fpr=0.0539 | 7861.0 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.25293 | acc=0.9457 | tpr=0.9192 | fpr=0.0538 | 8059.8 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.25353 | acc=0.9454 | tpr=0.9136 | fpr=0.0541 | 8491.6 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.25445 | acc=0.9450 | tpr=0.9129 | fpr=0.0544 | 8389.7 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.25518 | acc=0.9448 | tpr=0.9163 | fpr=0.0547 | 8288.7 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.25415 | acc=0.9450 | tpr=0.9129 | fpr=0.0544 | 8915.3 samples/s | 34.8 steps/s
Avg test loss: 0.25380, Avg test acc: 0.94505, Avg tpr: 0.91323, Avg fpr: 0.05437, total FA: 7549

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09731 | acc=0.9685 | tpr=0.9115 | fpr=0.0305 | 4618.1 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.09795 | acc=0.9679 | tpr=0.9254 | fpr=0.0314 | 7880.7 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.10023 | acc=0.9669 | tpr=0.9251 | fpr=0.0324 | 8313.6 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.09999 | acc=0.9669 | tpr=0.9290 | fpr=0.0324 | 7658.2 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.10157 | acc=0.9670 | tpr=0.9197 | fpr=0.0322 | 8328.1 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.10301 | acc=0.9664 | tpr=0.9142 | fpr=0.0327 | 7929.7 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.10342 | acc=0.9662 | tpr=0.9148 | fpr=0.0328 | 7842.2 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.10401 | acc=0.9658 | tpr=0.9086 | fpr=0.0332 | 8224.7 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.10491 | acc=0.9657 | tpr=0.9060 | fpr=0.0332 | 8530.0 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.10459 | acc=0.9658 | tpr=0.9084 | fpr=0.0332 | 7884.5 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.10399 | acc=0.9658 | tpr=0.9045 | fpr=0.0331 | 9425.2 samples/s | 36.8 steps/s
Avg test loss: 0.10385, Avg test acc: 0.96586, Avg tpr: 0.90491, Avg fpr: 0.03304, total FA: 4587

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.18005 | acc=0.9548 | tpr=0.8584 | fpr=0.0435 | 4593.9 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.18075 | acc=0.9544 | tpr=0.8977 | fpr=0.0445 | 8147.6 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.18170 | acc=0.9541 | tpr=0.9135 | fpr=0.0451 | 7843.2 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.18170 | acc=0.9540 | tpr=0.9191 | fpr=0.0453 | 8290.2 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.18307 | acc=0.9537 | tpr=0.9127 | fpr=0.0455 | 8232.9 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.18551 | acc=0.9531 | tpr=0.9120 | fpr=0.0462 | 7721.7 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.18552 | acc=0.9531 | tpr=0.9117 | fpr=0.0462 | 7835.6 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.18641 | acc=0.9527 | tpr=0.9043 | fpr=0.0464 | 8106.3 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.18753 | acc=0.9523 | tpr=0.9036 | fpr=0.0468 | 7950.7 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.18829 | acc=0.9522 | tpr=0.9057 | fpr=0.0470 | 8008.1 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.18783 | acc=0.9523 | tpr=0.9021 | fpr=0.0468 | 10081.3 samples/s | 39.4 steps/s
Avg test loss: 0.18747, Avg test acc: 0.95228, Avg tpr: 0.90174, Avg fpr: 0.04680, total FA: 6498

server round 3/50

clients selected: [0 3 6 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.16859 | Reg=0.00229 | acc=0.8594 | L2-Norm=15.148 | L2-Norm(final)=5.158 | 3266.0 samples/s | 51.0 steps/s
[Step=4050 Epoch=19.7] | Loss=0.16120 | Reg=0.00229 | acc=0.8438 | L2-Norm=15.147 | L2-Norm(final)=5.197 | 4711.2 samples/s | 73.6 steps/s
[Step=4100 Epoch=20.0] | Loss=0.16347 | Reg=0.00229 | acc=0.9062 | L2-Norm=15.147 | L2-Norm(final)=5.250 | 5500.6 samples/s | 85.9 steps/s
[Step=4150 Epoch=20.2] | Loss=0.16289 | Reg=0.00229 | acc=0.9062 | L2-Norm=15.147 | L2-Norm(final)=5.314 | 5546.5 samples/s | 86.7 steps/s
[Step=4200 Epoch=20.5] | Loss=0.16033 | Reg=0.00229 | acc=0.8438 | L2-Norm=15.147 | L2-Norm(final)=5.378 | 8549.0 samples/s | 133.6 steps/s
[Step=4250 Epoch=20.7] | Loss=0.15975 | Reg=0.00229 | acc=0.8750 | L2-Norm=15.147 | L2-Norm(final)=5.445 | 1503.9 samples/s | 23.5 steps/s
[Step=4300 Epoch=21.0] | Loss=0.15912 | Reg=0.00229 | acc=0.8438 | L2-Norm=15.147 | L2-Norm(final)=5.510 | 5488.9 samples/s | 85.8 steps/s
[Step=4350 Epoch=21.2] | Loss=0.15750 | Reg=0.00229 | acc=0.8906 | L2-Norm=15.147 | L2-Norm(final)=5.575 | 5555.2 samples/s | 86.8 steps/s
[Step=4400 Epoch=21.5] | Loss=0.15698 | Reg=0.00229 | acc=0.8125 | L2-Norm=15.147 | L2-Norm(final)=5.640 | 7550.5 samples/s | 118.0 steps/s
[Step=4450 Epoch=21.7] | Loss=0.15592 | Reg=0.00229 | acc=0.8281 | L2-Norm=15.147 | L2-Norm(final)=5.705 | 1543.6 samples/s | 24.1 steps/s
[Step=4500 Epoch=21.9] | Loss=0.15542 | Reg=0.00229 | acc=0.9062 | L2-Norm=15.147 | L2-Norm(final)=5.767 | 5563.0 samples/s | 86.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=21.9] | Loss=0.14312 | Reg=0.00229 | acc=0.8750 | L2-Norm=15.147 | L2-Norm(final)=6.391 | 3206.5 samples/s | 50.1 steps/s
[Step=4550 Epoch=22.2] | Loss=0.13570 | Reg=0.00238 | acc=0.9219 | L2-Norm=15.438 | L2-Norm(final)=6.396 | 4246.7 samples/s | 66.4 steps/s
[Step=4600 Epoch=22.4] | Loss=0.12232 | Reg=0.00244 | acc=0.9062 | L2-Norm=15.618 | L2-Norm(final)=6.387 | 4713.7 samples/s | 73.7 steps/s
[Step=4650 Epoch=22.7] | Loss=0.11255 | Reg=0.00247 | acc=0.9219 | L2-Norm=15.714 | L2-Norm(final)=6.382 | 4698.5 samples/s | 73.4 steps/s
[Step=4700 Epoch=22.9] | Loss=0.10844 | Reg=0.00249 | acc=0.9219 | L2-Norm=15.775 | L2-Norm(final)=6.376 | 6760.3 samples/s | 105.6 steps/s
[Step=4750 Epoch=23.2] | Loss=0.09942 | Reg=0.00251 | acc=0.9219 | L2-Norm=15.826 | L2-Norm(final)=6.374 | 1401.1 samples/s | 21.9 steps/s
[Step=4800 Epoch=23.4] | Loss=0.09140 | Reg=0.00252 | acc=0.9375 | L2-Norm=15.873 | L2-Norm(final)=6.375 | 4686.6 samples/s | 73.2 steps/s
[Step=4850 Epoch=23.6] | Loss=0.08625 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.915 | L2-Norm(final)=6.378 | 4741.2 samples/s | 74.1 steps/s
[Step=4900 Epoch=23.9] | Loss=0.08281 | Reg=0.00255 | acc=0.9062 | L2-Norm=15.953 | L2-Norm(final)=6.380 | 6162.2 samples/s | 96.3 steps/s
[Step=4950 Epoch=24.1] | Loss=0.07819 | Reg=0.00256 | acc=0.9844 | L2-Norm=15.985 | L2-Norm(final)=6.381 | 1471.0 samples/s | 23.0 steps/s
[Step=5000 Epoch=24.4] | Loss=0.07438 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.019 | L2-Norm(final)=6.383 | 4779.6 samples/s | 74.7 steps/s
[Step=5050 Epoch=24.6] | Loss=0.07260 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.050 | L2-Norm(final)=6.385 | 4632.6 samples/s | 72.4 steps/s
[Step=5100 Epoch=24.9] | Loss=0.07039 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.079 | L2-Norm(final)=6.385 | 5662.0 samples/s | 88.5 steps/s
[Step=5150 Epoch=25.1] | Loss=0.06746 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.106 | L2-Norm(final)=6.385 | 1477.9 samples/s | 23.1 steps/s
[Step=5200 Epoch=25.4] | Loss=0.06423 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.131 | L2-Norm(final)=6.386 | 4794.6 samples/s | 74.9 steps/s
[Step=5250 Epoch=25.6] | Loss=0.06213 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.155 | L2-Norm(final)=6.388 | 4610.2 samples/s | 72.0 steps/s
[Step=5300 Epoch=25.8] | Loss=0.05998 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.178 | L2-Norm(final)=6.390 | 5213.7 samples/s | 81.5 steps/s
[Step=5350 Epoch=26.1] | Loss=0.05792 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.199 | L2-Norm(final)=6.391 | 1502.5 samples/s | 23.5 steps/s
[Step=5400 Epoch=26.3] | Loss=0.05607 | Reg=0.00263 | acc=0.9844 | L2-Norm=16.218 | L2-Norm(final)=6.392 | 4689.0 samples/s | 73.3 steps/s
[Step=5450 Epoch=26.6] | Loss=0.05443 | Reg=0.00264 | acc=0.9844 | L2-Norm=16.237 | L2-Norm(final)=6.394 | 4781.0 samples/s | 74.7 steps/s
[Step=5500 Epoch=26.8] | Loss=0.05293 | Reg=0.00264 | acc=0.9844 | L2-Norm=16.255 | L2-Norm(final)=6.396 | 4783.5 samples/s | 74.7 steps/s
[Step=5550 Epoch=27.1] | Loss=0.05182 | Reg=0.00265 | acc=0.9375 | L2-Norm=16.273 | L2-Norm(final)=6.397 | 1553.6 samples/s | 24.3 steps/s
[Step=5600 Epoch=27.3] | Loss=0.05039 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.290 | L2-Norm(final)=6.398 | 4653.9 samples/s | 72.7 steps/s
[Step=5650 Epoch=27.6] | Loss=0.04917 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.307 | L2-Norm(final)=6.399 | 4709.0 samples/s | 73.6 steps/s
[Step=5700 Epoch=27.8] | Loss=0.04808 | Reg=0.00267 | acc=0.9688 | L2-Norm=16.324 | L2-Norm(final)=6.401 | 4684.3 samples/s | 73.2 steps/s
[Step=5750 Epoch=28.0] | Loss=0.04788 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.340 | L2-Norm(final)=6.402 | 1580.1 samples/s | 24.7 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04736 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.359 | L2-Norm(final)=6.401 | 4652.7 samples/s | 72.7 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04658 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.379 | L2-Norm(final)=6.401 | 4742.5 samples/s | 74.1 steps/s
[Step=5900 Epoch=28.8] | Loss=0.04597 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.398 | L2-Norm(final)=6.401 | 4731.4 samples/s | 73.9 steps/s
[Step=5950 Epoch=29.0] | Loss=0.04517 | Reg=0.00270 | acc=0.9844 | L2-Norm=16.418 | L2-Norm(final)=6.401 | 1589.5 samples/s | 24.8 steps/s
[Step=6000 Epoch=29.3] | Loss=0.04412 | Reg=0.00270 | acc=0.9688 | L2-Norm=16.436 | L2-Norm(final)=6.401 | 4709.7 samples/s | 73.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step6000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.17005 | Reg=0.00229 | acc=0.9062 | L2-Norm=15.148 | L2-Norm(final)=3.221 | 3030.4 samples/s | 47.4 steps/s
[Step=2050 Epoch=10.0] | Loss=0.19680 | Reg=0.00229 | acc=0.7812 | L2-Norm=15.149 | L2-Norm(final)=3.326 | 5196.8 samples/s | 81.2 steps/s
[Step=2100 Epoch=10.2] | Loss=0.18744 | Reg=0.00230 | acc=0.8906 | L2-Norm=15.150 | L2-Norm(final)=3.464 | 5326.8 samples/s | 83.2 steps/s
[Step=2150 Epoch=10.5] | Loss=0.18172 | Reg=0.00230 | acc=0.9062 | L2-Norm=15.150 | L2-Norm(final)=3.605 | 5552.7 samples/s | 86.8 steps/s
[Step=2200 Epoch=10.7] | Loss=0.17684 | Reg=0.00230 | acc=0.9062 | L2-Norm=15.150 | L2-Norm(final)=3.737 | 8439.0 samples/s | 131.9 steps/s
[Step=2250 Epoch=11.0] | Loss=0.17313 | Reg=0.00230 | acc=0.9219 | L2-Norm=15.150 | L2-Norm(final)=3.861 | 1468.8 samples/s | 23.0 steps/s
[Step=2300 Epoch=11.2] | Loss=0.17167 | Reg=0.00230 | acc=0.8594 | L2-Norm=15.150 | L2-Norm(final)=3.975 | 5418.6 samples/s | 84.7 steps/s
[Step=2350 Epoch=11.5] | Loss=0.16900 | Reg=0.00230 | acc=0.9062 | L2-Norm=15.150 | L2-Norm(final)=4.082 | 5587.9 samples/s | 87.3 steps/s
[Step=2400 Epoch=11.7] | Loss=0.16697 | Reg=0.00230 | acc=0.8906 | L2-Norm=15.150 | L2-Norm(final)=4.184 | 7412.5 samples/s | 115.8 steps/s
[Step=2450 Epoch=11.9] | Loss=0.16536 | Reg=0.00230 | acc=0.8281 | L2-Norm=15.150 | L2-Norm(final)=4.280 | 1515.6 samples/s | 23.7 steps/s
[Step=2500 Epoch=12.2] | Loss=0.16364 | Reg=0.00230 | acc=0.8125 | L2-Norm=15.150 | L2-Norm(final)=4.371 | 5409.7 samples/s | 84.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.12438 | Reg=0.00230 | acc=0.8750 | L2-Norm=15.150 | L2-Norm(final)=5.257 | 3170.0 samples/s | 49.5 steps/s
[Step=2550 Epoch=12.4] | Loss=0.13596 | Reg=0.00237 | acc=0.8438 | L2-Norm=15.382 | L2-Norm(final)=5.261 | 4283.9 samples/s | 66.9 steps/s
[Step=2600 Epoch=12.7] | Loss=0.12069 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.523 | L2-Norm(final)=5.252 | 4695.3 samples/s | 73.4 steps/s
[Step=2650 Epoch=12.9] | Loss=0.11429 | Reg=0.00244 | acc=0.9531 | L2-Norm=15.612 | L2-Norm(final)=5.249 | 4708.9 samples/s | 73.6 steps/s
[Step=2700 Epoch=13.2] | Loss=0.10735 | Reg=0.00246 | acc=0.9219 | L2-Norm=15.677 | L2-Norm(final)=5.247 | 6727.4 samples/s | 105.1 steps/s
[Step=2750 Epoch=13.4] | Loss=0.09850 | Reg=0.00248 | acc=0.9531 | L2-Norm=15.739 | L2-Norm(final)=5.247 | 1409.4 samples/s | 22.0 steps/s
[Step=2800 Epoch=13.7] | Loss=0.09106 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.797 | L2-Norm(final)=5.251 | 4719.7 samples/s | 73.7 steps/s
[Step=2850 Epoch=13.9] | Loss=0.08691 | Reg=0.00251 | acc=0.9688 | L2-Norm=15.849 | L2-Norm(final)=5.253 | 4742.0 samples/s | 74.1 steps/s
[Step=2900 Epoch=14.1] | Loss=0.08227 | Reg=0.00253 | acc=0.9219 | L2-Norm=15.897 | L2-Norm(final)=5.255 | 6111.9 samples/s | 95.5 steps/s
[Step=2950 Epoch=14.4] | Loss=0.07794 | Reg=0.00254 | acc=0.9688 | L2-Norm=15.943 | L2-Norm(final)=5.258 | 1476.8 samples/s | 23.1 steps/s
[Step=3000 Epoch=14.6] | Loss=0.07362 | Reg=0.00256 | acc=0.9531 | L2-Norm=15.987 | L2-Norm(final)=5.261 | 4794.7 samples/s | 74.9 steps/s
[Step=3050 Epoch=14.9] | Loss=0.07060 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.024 | L2-Norm(final)=5.264 | 4569.2 samples/s | 71.4 steps/s
[Step=3100 Epoch=15.1] | Loss=0.06831 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.060 | L2-Norm(final)=5.267 | 5671.4 samples/s | 88.6 steps/s
[Step=3150 Epoch=15.4] | Loss=0.06557 | Reg=0.00259 | acc=0.9531 | L2-Norm=16.094 | L2-Norm(final)=5.269 | 1465.1 samples/s | 22.9 steps/s
[Step=3200 Epoch=15.6] | Loss=0.06324 | Reg=0.00260 | acc=0.9844 | L2-Norm=16.125 | L2-Norm(final)=5.270 | 4709.0 samples/s | 73.6 steps/s
[Step=3250 Epoch=15.8] | Loss=0.06122 | Reg=0.00261 | acc=0.9688 | L2-Norm=16.157 | L2-Norm(final)=5.272 | 4737.7 samples/s | 74.0 steps/s
[Step=3300 Epoch=16.1] | Loss=0.05939 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.187 | L2-Norm(final)=5.274 | 5154.9 samples/s | 80.5 steps/s
[Step=3350 Epoch=16.3] | Loss=0.05764 | Reg=0.00263 | acc=0.9531 | L2-Norm=16.215 | L2-Norm(final)=5.276 | 1488.0 samples/s | 23.3 steps/s
[Step=3400 Epoch=16.6] | Loss=0.05608 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.243 | L2-Norm(final)=5.278 | 4699.2 samples/s | 73.4 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05431 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.268 | L2-Norm(final)=5.280 | 4734.5 samples/s | 74.0 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05300 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.292 | L2-Norm(final)=5.282 | 4801.9 samples/s | 75.0 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05192 | Reg=0.00266 | acc=0.9688 | L2-Norm=16.315 | L2-Norm(final)=5.283 | 1571.4 samples/s | 24.6 steps/s
[Step=3600 Epoch=17.6] | Loss=0.05049 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.338 | L2-Norm(final)=5.284 | 4718.2 samples/s | 73.7 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04925 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.360 | L2-Norm(final)=5.286 | 4736.3 samples/s | 74.0 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04808 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.381 | L2-Norm(final)=5.287 | 4732.3 samples/s | 73.9 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04713 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.402 | L2-Norm(final)=5.288 | 1568.7 samples/s | 24.5 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04583 | Reg=0.00270 | acc=0.9531 | L2-Norm=16.421 | L2-Norm(final)=5.290 | 4576.5 samples/s | 71.5 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04485 | Reg=0.00270 | acc=0.9844 | L2-Norm=16.440 | L2-Norm(final)=5.291 | 4744.0 samples/s | 74.1 steps/s
[Step=3900 Epoch=19.0] | Loss=0.04385 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.458 | L2-Norm(final)=5.293 | 4693.0 samples/s | 73.3 steps/s
[Step=3950 Epoch=19.3] | Loss=0.04299 | Reg=0.00272 | acc=0.9844 | L2-Norm=16.475 | L2-Norm(final)=5.294 | 1565.8 samples/s | 24.5 steps/s
[Step=4000 Epoch=19.5] | Loss=0.04207 | Reg=0.00272 | acc=0.9844 | L2-Norm=16.491 | L2-Norm(final)=5.295 | 4703.8 samples/s | 73.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step4000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch=19.0] | Loss=0.08242 | Reg=0.00229 | acc=0.9531 | L2-Norm=15.148 | L2-Norm(final)=4.484 | 3167.5 samples/s | 49.5 steps/s
[Step=2050 Epoch=19.5] | Loss=0.07383 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.137 | L2-Norm(final)=4.746 | 4548.4 samples/s | 71.1 steps/s
[Step=2100 Epoch=20.0] | Loss=0.06822 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.135 | L2-Norm(final)=5.014 | 8284.2 samples/s | 129.4 steps/s
[Step=2150 Epoch=20.5] | Loss=0.06628 | Reg=0.00229 | acc=0.9531 | L2-Norm=15.135 | L2-Norm(final)=5.235 | 1437.5 samples/s | 22.5 steps/s
[Step=2200 Epoch=20.9] | Loss=0.06303 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.135 | L2-Norm(final)=5.421 | 7093.3 samples/s | 110.8 steps/s
[Step=2250 Epoch=21.4] | Loss=0.06083 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.135 | L2-Norm(final)=5.589 | 1506.6 samples/s | 23.5 steps/s
[Step=2300 Epoch=21.9] | Loss=0.05941 | Reg=0.00229 | acc=0.9062 | L2-Norm=15.135 | L2-Norm(final)=5.740 | 6530.5 samples/s | 102.0 steps/s
[Step=2350 Epoch=22.4] | Loss=0.05798 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.134 | L2-Norm(final)=5.879 | 1503.2 samples/s | 23.5 steps/s
[Step=2400 Epoch=22.8] | Loss=0.05682 | Reg=0.00229 | acc=0.9375 | L2-Norm=15.134 | L2-Norm(final)=6.006 | 5870.3 samples/s | 91.7 steps/s
[Step=2450 Epoch=23.3] | Loss=0.05559 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.134 | L2-Norm(final)=6.124 | 1580.5 samples/s | 24.7 steps/s
[Step=2500 Epoch=23.8] | Loss=0.05482 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.134 | L2-Norm(final)=6.235 | 5279.9 samples/s | 82.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.8] | Loss=0.03101 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.134 | L2-Norm(final)=7.315 | 3185.9 samples/s | 49.8 steps/s
[Step=2550 Epoch=24.3] | Loss=0.04201 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.502 | L2-Norm(final)=7.297 | 3977.6 samples/s | 62.2 steps/s
[Step=2600 Epoch=24.7] | Loss=0.02921 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.743 | L2-Norm(final)=7.268 | 6618.8 samples/s | 103.4 steps/s
[Step=2650 Epoch=25.2] | Loss=0.02010 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.835 | L2-Norm(final)=7.257 | 1410.7 samples/s | 22.0 steps/s
[Step=2700 Epoch=25.7] | Loss=0.01527 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.862 | L2-Norm(final)=7.253 | 5884.3 samples/s | 91.9 steps/s
[Step=2750 Epoch=26.2] | Loss=0.01224 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.862 | L2-Norm(final)=7.251 | 1405.7 samples/s | 22.0 steps/s
[Step=2800 Epoch=26.6] | Loss=0.01021 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.849 | L2-Norm(final)=7.250 | 5505.2 samples/s | 86.0 steps/s
[Step=2850 Epoch=27.1] | Loss=0.00876 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.827 | L2-Norm(final)=7.250 | 1447.2 samples/s | 22.6 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00767 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.801 | L2-Norm(final)=7.250 | 4842.3 samples/s | 75.7 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00682 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.772 | L2-Norm(final)=7.250 | 1507.9 samples/s | 23.6 steps/s
[Step=3000 Epoch=28.5] | Loss=0.00614 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.740 | L2-Norm(final)=7.251 | 4579.5 samples/s | 71.6 steps/s
[Step=3050 Epoch=29.0] | Loss=0.00558 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.707 | L2-Norm(final)=7.251 | 1550.4 samples/s | 24.2 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00512 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.673 | L2-Norm(final)=7.251 | 4557.8 samples/s | 71.2 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00472 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.639 | L2-Norm(final)=7.251 | 1531.1 samples/s | 23.9 steps/s
[Step=3200 Epoch=30.4] | Loss=0.00439 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.604 | L2-Norm(final)=7.252 | 4440.3 samples/s | 69.4 steps/s
[Step=3250 Epoch=30.9] | Loss=0.00410 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.568 | L2-Norm(final)=7.252 | 1515.8 samples/s | 23.7 steps/s
[Step=3300 Epoch=31.4] | Loss=0.00384 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.533 | L2-Norm(final)=7.252 | 4425.4 samples/s | 69.1 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00362 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.497 | L2-Norm(final)=7.253 | 1583.8 samples/s | 24.7 steps/s
[Step=3400 Epoch=32.3] | Loss=0.00341 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.461 | L2-Norm(final)=7.253 | 4347.0 samples/s | 67.9 steps/s
[Step=3450 Epoch=32.8] | Loss=0.00324 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.425 | L2-Norm(final)=7.253 | 6596.7 samples/s | 103.1 steps/s
[Step=3500 Epoch=33.3] | Loss=0.00307 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.388 | L2-Norm(final)=7.253 | 1350.6 samples/s | 21.1 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00293 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.352 | L2-Norm(final)=7.254 | 6005.6 samples/s | 93.8 steps/s
[Step=3600 Epoch=34.2] | Loss=0.00280 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.316 | L2-Norm(final)=7.254 | 1438.7 samples/s | 22.5 steps/s
[Step=3650 Epoch=34.7] | Loss=0.00267 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.280 | L2-Norm(final)=7.254 | 5514.0 samples/s | 86.2 steps/s
[Step=3700 Epoch=35.2] | Loss=0.00256 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.243 | L2-Norm(final)=7.255 | 1423.7 samples/s | 22.2 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00246 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.207 | L2-Norm(final)=7.255 | 5038.8 samples/s | 78.7 steps/s
[Step=3800 Epoch=36.1] | Loss=0.00237 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.171 | L2-Norm(final)=7.255 | 1451.6 samples/s | 22.7 steps/s
[Step=3850 Epoch=36.6] | Loss=0.00228 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.134 | L2-Norm(final)=7.255 | 4668.6 samples/s | 72.9 steps/s
[Step=3900 Epoch=37.1] | Loss=0.00220 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.098 | L2-Norm(final)=7.256 | 1459.7 samples/s | 22.8 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00212 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.062 | L2-Norm(final)=7.256 | 4450.0 samples/s | 69.5 steps/s
[Step=4000 Epoch=38.0] | Loss=0.00205 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.025 | L2-Norm(final)=7.256 | 1499.1 samples/s | 23.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step4000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=57.3] | Loss=0.04575 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.148 | L2-Norm(final)=9.332 | 3134.7 samples/s | 49.0 steps/s
[Step=6050 Epoch=57.8] | Loss=0.03786 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.137 | L2-Norm(final)=9.324 | 4529.0 samples/s | 70.8 steps/s
[Step=6100 Epoch=58.3] | Loss=0.03452 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.135 | L2-Norm(final)=9.363 | 8176.5 samples/s | 127.8 steps/s
[Step=6150 Epoch=58.7] | Loss=0.03310 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.135 | L2-Norm(final)=9.418 | 1447.7 samples/s | 22.6 steps/s
[Step=6200 Epoch=59.2] | Loss=0.03200 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.135 | L2-Norm(final)=9.475 | 7440.7 samples/s | 116.3 steps/s
[Step=6250 Epoch=59.7] | Loss=0.03127 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.135 | L2-Norm(final)=9.529 | 1433.7 samples/s | 22.4 steps/s
[Step=6300 Epoch=60.2] | Loss=0.03103 | Reg=0.00229 | acc=0.9375 | L2-Norm=15.135 | L2-Norm(final)=9.583 | 6797.6 samples/s | 106.2 steps/s
[Step=6350 Epoch=60.6] | Loss=0.03047 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.134 | L2-Norm(final)=9.637 | 1463.7 samples/s | 22.9 steps/s
[Step=6400 Epoch=61.1] | Loss=0.03038 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.134 | L2-Norm(final)=9.690 | 6070.1 samples/s | 94.8 steps/s
[Step=6450 Epoch=61.6] | Loss=0.03004 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.134 | L2-Norm(final)=9.742 | 1476.1 samples/s | 23.1 steps/s
[Step=6500 Epoch=62.1] | Loss=0.02965 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.134 | L2-Norm(final)=9.794 | 5720.0 samples/s | 89.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=62.1] | Loss=0.04699 | Reg=0.00229 | acc=0.9531 | L2-Norm=15.134 | L2-Norm(final)=10.327 | 3043.7 samples/s | 47.6 steps/s
[Step=6550 Epoch=62.5] | Loss=0.04451 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.619 | L2-Norm(final)=10.278 | 4049.7 samples/s | 63.3 steps/s
[Step=6600 Epoch=63.0] | Loss=0.02564 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.826 | L2-Norm(final)=10.257 | 6526.9 samples/s | 102.0 steps/s
[Step=6650 Epoch=63.5] | Loss=0.01770 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.890 | L2-Norm(final)=10.249 | 1338.8 samples/s | 20.9 steps/s
[Step=6700 Epoch=64.0] | Loss=0.01335 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.899 | L2-Norm(final)=10.247 | 5985.5 samples/s | 93.5 steps/s
[Step=6750 Epoch=64.5] | Loss=0.01071 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.883 | L2-Norm(final)=10.247 | 1377.5 samples/s | 21.5 steps/s
[Step=6800 Epoch=64.9] | Loss=0.00893 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.855 | L2-Norm(final)=10.247 | 5471.8 samples/s | 85.5 steps/s
[Step=6850 Epoch=65.4] | Loss=0.00766 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.820 | L2-Norm(final)=10.247 | 1408.6 samples/s | 22.0 steps/s
[Step=6900 Epoch=65.9] | Loss=0.00670 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.782 | L2-Norm(final)=10.247 | 5173.9 samples/s | 80.8 steps/s
[Step=6950 Epoch=66.4] | Loss=0.00596 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.741 | L2-Norm(final)=10.247 | 1411.7 samples/s | 22.1 steps/s
[Step=7000 Epoch=66.8] | Loss=0.00537 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.700 | L2-Norm(final)=10.248 | 4813.9 samples/s | 75.2 steps/s
[Step=7050 Epoch=67.3] | Loss=0.00488 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.658 | L2-Norm(final)=10.248 | 1467.6 samples/s | 22.9 steps/s
[Step=7100 Epoch=67.8] | Loss=0.00447 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.616 | L2-Norm(final)=10.248 | 4508.1 samples/s | 70.4 steps/s
[Step=7150 Epoch=68.3] | Loss=0.00413 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.573 | L2-Norm(final)=10.249 | 1520.4 samples/s | 23.8 steps/s
[Step=7200 Epoch=68.8] | Loss=0.00384 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.531 | L2-Norm(final)=10.249 | 4378.1 samples/s | 68.4 steps/s
[Step=7250 Epoch=69.2] | Loss=0.00358 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.489 | L2-Norm(final)=10.249 | 1477.8 samples/s | 23.1 steps/s
[Step=7300 Epoch=69.7] | Loss=0.00336 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.447 | L2-Norm(final)=10.250 | 4466.7 samples/s | 69.8 steps/s
[Step=7350 Epoch=70.2] | Loss=0.00316 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.405 | L2-Norm(final)=10.250 | 1472.3 samples/s | 23.0 steps/s
[Step=7400 Epoch=70.7] | Loss=0.00298 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.364 | L2-Norm(final)=10.250 | 4419.3 samples/s | 69.1 steps/s
[Step=7450 Epoch=71.1] | Loss=0.00283 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.323 | L2-Norm(final)=10.250 | 1480.7 samples/s | 23.1 steps/s
[Step=7500 Epoch=71.6] | Loss=0.00269 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.282 | L2-Norm(final)=10.251 | 4474.7 samples/s | 69.9 steps/s
[Step=7550 Epoch=72.1] | Loss=0.00256 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.241 | L2-Norm(final)=10.251 | 7028.9 samples/s | 109.8 steps/s
[Step=7600 Epoch=72.6] | Loss=0.00244 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.201 | L2-Norm(final)=10.251 | 1344.9 samples/s | 21.0 steps/s
[Step=7650 Epoch=73.1] | Loss=0.00234 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.161 | L2-Norm(final)=10.252 | 6451.0 samples/s | 100.8 steps/s
[Step=7700 Epoch=73.5] | Loss=0.00224 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.121 | L2-Norm(final)=10.252 | 1372.2 samples/s | 21.4 steps/s
[Step=7750 Epoch=74.0] | Loss=0.00215 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.082 | L2-Norm(final)=10.252 | 5945.7 samples/s | 92.9 steps/s
[Step=7800 Epoch=74.5] | Loss=0.00207 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.043 | L2-Norm(final)=10.252 | 1394.2 samples/s | 21.8 steps/s
[Step=7850 Epoch=75.0] | Loss=0.00199 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.004 | L2-Norm(final)=10.253 | 5508.8 samples/s | 86.1 steps/s
[Step=7900 Epoch=75.4] | Loss=0.00192 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.965 | L2-Norm(final)=10.253 | 1415.6 samples/s | 22.1 steps/s
[Step=7950 Epoch=75.9] | Loss=0.00185 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.926 | L2-Norm(final)=10.253 | 5240.8 samples/s | 81.9 steps/s
[Step=8000 Epoch=76.4] | Loss=0.00179 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.888 | L2-Norm(final)=10.253 | 1453.1 samples/s | 22.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step8000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch=19.1] | Loss=0.10157 | Reg=0.00229 | acc=0.8906 | L2-Norm=15.148 | L2-Norm(final)=5.816 | 3033.9 samples/s | 47.4 steps/s
[Step=2050 Epoch=19.5] | Loss=0.06672 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.132 | L2-Norm(final)=5.963 | 4741.4 samples/s | 74.1 steps/s
[Step=2100 Epoch=20.0] | Loss=0.06451 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.130 | L2-Norm(final)=6.182 | 8178.5 samples/s | 127.8 steps/s
[Step=2150 Epoch=20.5] | Loss=0.06299 | Reg=0.00229 | acc=0.9219 | L2-Norm=15.129 | L2-Norm(final)=6.372 | 1436.7 samples/s | 22.4 steps/s
[Step=2200 Epoch=21.0] | Loss=0.06124 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.129 | L2-Norm(final)=6.543 | 7369.4 samples/s | 115.1 steps/s
[Step=2250 Epoch=21.4] | Loss=0.06068 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.129 | L2-Norm(final)=6.697 | 1461.6 samples/s | 22.8 steps/s
[Step=2300 Epoch=21.9] | Loss=0.05949 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.129 | L2-Norm(final)=6.838 | 6597.3 samples/s | 103.1 steps/s
[Step=2350 Epoch=22.4] | Loss=0.05924 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.129 | L2-Norm(final)=6.971 | 1490.0 samples/s | 23.3 steps/s
[Step=2400 Epoch=22.9] | Loss=0.05750 | Reg=0.00229 | acc=0.8906 | L2-Norm=15.129 | L2-Norm(final)=7.096 | 6148.4 samples/s | 96.1 steps/s
[Step=2450 Epoch=23.4] | Loss=0.05660 | Reg=0.00229 | acc=0.9531 | L2-Norm=15.129 | L2-Norm(final)=7.218 | 1499.2 samples/s | 23.4 steps/s
[Step=2500 Epoch=23.8] | Loss=0.05624 | Reg=0.00229 | acc=0.9531 | L2-Norm=15.128 | L2-Norm(final)=7.334 | 5688.6 samples/s | 88.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.8] | Loss=0.04779 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.128 | L2-Norm(final)=8.447 | 3147.3 samples/s | 49.2 steps/s
[Step=2550 Epoch=24.3] | Loss=0.06704 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.773 | L2-Norm(final)=8.399 | 3982.2 samples/s | 62.2 steps/s
[Step=2600 Epoch=24.8] | Loss=0.04396 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.079 | L2-Norm(final)=8.347 | 6480.1 samples/s | 101.3 steps/s
[Step=2650 Epoch=25.3] | Loss=0.03066 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.178 | L2-Norm(final)=8.328 | 1336.3 samples/s | 20.9 steps/s
[Step=2700 Epoch=25.7] | Loss=0.02327 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.201 | L2-Norm(final)=8.321 | 5981.7 samples/s | 93.5 steps/s
[Step=2750 Epoch=26.2] | Loss=0.01868 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.190 | L2-Norm(final)=8.318 | 1386.4 samples/s | 21.7 steps/s
[Step=2800 Epoch=26.7] | Loss=0.01560 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.165 | L2-Norm(final)=8.316 | 5501.9 samples/s | 86.0 steps/s
[Step=2850 Epoch=27.2] | Loss=0.01338 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.131 | L2-Norm(final)=8.316 | 1417.0 samples/s | 22.1 steps/s
[Step=2900 Epoch=27.6] | Loss=0.01171 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.093 | L2-Norm(final)=8.316 | 5154.7 samples/s | 80.5 steps/s
[Step=2950 Epoch=28.1] | Loss=0.01041 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.051 | L2-Norm(final)=8.316 | 1423.1 samples/s | 22.2 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00937 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.008 | L2-Norm(final)=8.316 | 4894.2 samples/s | 76.5 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00852 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.964 | L2-Norm(final)=8.316 | 1473.4 samples/s | 23.0 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00781 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.920 | L2-Norm(final)=8.316 | 4526.6 samples/s | 70.7 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00721 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.875 | L2-Norm(final)=8.317 | 1495.6 samples/s | 23.4 steps/s
[Step=3200 Epoch=30.5] | Loss=0.00670 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.831 | L2-Norm(final)=8.317 | 4494.0 samples/s | 70.2 steps/s
[Step=3250 Epoch=31.0] | Loss=0.00625 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.786 | L2-Norm(final)=8.317 | 1472.6 samples/s | 23.0 steps/s
[Step=3300 Epoch=31.5] | Loss=0.00586 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.742 | L2-Norm(final)=8.318 | 4465.4 samples/s | 69.8 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00552 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.697 | L2-Norm(final)=8.318 | 1482.0 samples/s | 23.2 steps/s
[Step=3400 Epoch=32.4] | Loss=0.00521 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.653 | L2-Norm(final)=8.318 | 4403.5 samples/s | 68.8 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00494 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.610 | L2-Norm(final)=8.319 | 1508.4 samples/s | 23.6 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00469 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.566 | L2-Norm(final)=8.319 | 4503.3 samples/s | 70.4 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00447 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.523 | L2-Norm(final)=8.319 | 7046.7 samples/s | 110.1 steps/s
[Step=3600 Epoch=34.3] | Loss=0.00427 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.480 | L2-Norm(final)=8.320 | 1339.0 samples/s | 20.9 steps/s
[Step=3650 Epoch=34.8] | Loss=0.00408 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.437 | L2-Norm(final)=8.320 | 6534.0 samples/s | 102.1 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00391 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.395 | L2-Norm(final)=8.320 | 1357.0 samples/s | 21.2 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00376 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.353 | L2-Norm(final)=8.321 | 6003.9 samples/s | 93.8 steps/s
[Step=3800 Epoch=36.2] | Loss=0.00361 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.311 | L2-Norm(final)=8.321 | 1385.4 samples/s | 21.6 steps/s
[Step=3850 Epoch=36.7] | Loss=0.00348 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.269 | L2-Norm(final)=8.321 | 5542.3 samples/s | 86.6 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00335 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.228 | L2-Norm(final)=8.322 | 1409.1 samples/s | 22.0 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00324 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.186 | L2-Norm(final)=8.322 | 5093.2 samples/s | 79.6 steps/s
[Step=4000 Epoch=38.1] | Loss=0.00313 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.145 | L2-Norm(final)=8.322 | 1420.5 samples/s | 22.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.14242 | acc=0.9323 | tpr=0.9481 | fpr=0.1021 | 4484.4 samples/s | 17.5 steps/s
Avg test loss: 0.14696, Avg test acc: 0.93020, Avg tpr: 0.94667, Avg fpr: 0.10601, total FA: 827

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14434 | acc=0.9268 | tpr=0.9482 | fpr=0.1197 | 4545.9 samples/s | 17.8 steps/s
Avg test loss: 0.14888, Avg test acc: 0.92479, Avg tpr: 0.94504, Avg fpr: 0.11973, total FA: 934

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.16279 | acc=0.9205 | tpr=0.9228 | fpr=0.0842 | 4739.6 samples/s | 18.5 steps/s
Avg test loss: 0.16840, Avg test acc: 0.91878, Avg tpr: 0.92137, Avg fpr: 0.08691, total FA: 678

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.16058 | acc=0.9286 | tpr=0.9555 | fpr=0.1298 | 4466.8 samples/s | 17.4 steps/s
Avg test loss: 0.16125, Avg test acc: 0.92908, Avg tpr: 0.95710, Avg fpr: 0.13255, total FA: 1034

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.33024 | acc=0.6731 | tpr=0.9720 | fpr=0.9760 | 4714.7 samples/s | 18.4 steps/s
Avg test loss: 0.32979, Avg test acc: 0.67465, Avg tpr: 0.97109, Avg fpr: 0.97731, total FA: 7624

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.56137 | acc=0.3142 | tpr=0.0100 | fpr=0.0253 | 4703.6 samples/s | 18.4 steps/s
Avg test loss: 6.57903, Avg test acc: 0.31176, Avg tpr: 0.00944, Avg fpr: 0.02333, total FA: 182

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.48975 | acc=0.3237 | tpr=0.0302 | fpr=0.0389 | 4672.6 samples/s | 18.3 steps/s
Avg test loss: 4.52178, Avg test acc: 0.32162, Avg tpr: 0.02938, Avg fpr: 0.03564, total FA: 278

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.21601 | acc=0.3152 | tpr=0.0367 | fpr=0.0803 | 4594.4 samples/s | 17.9 steps/s
Avg test loss: 4.22643, Avg test acc: 0.31461, Avg tpr: 0.03707, Avg fpr: 0.07499, total FA: 585

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.62448 | acc=0.3311 | tpr=0.0577 | fpr=0.0753 | 4614.4 samples/s | 18.0 steps/s
Avg test loss: 4.65194, Avg test acc: 0.32927, Avg tpr: 0.05572, Avg fpr: 0.06909, total FA: 539

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=6.29498 | acc=0.3173 | tpr=0.0124 | fpr=0.0208 | 4516.8 samples/s | 17.6 steps/s
Avg test loss: 6.31964, Avg test acc: 0.31573, Avg tpr: 0.01323, Avg fpr: 0.01897, total FA: 148

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.76829 | acc=0.1405 | tpr=0.9027 | fpr=0.8732 | 4676.9 samples/s | 18.3 steps/s
[Step= 100] | Loss=5.76375 | acc=0.1418 | tpr=0.8635 | fpr=0.8717 | 7882.3 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.77413 | acc=0.1428 | tpr=0.8718 | fpr=0.8706 | 8361.3 samples/s | 32.7 steps/s
[Step= 200] | Loss=5.75976 | acc=0.1425 | tpr=0.8754 | fpr=0.8708 | 7616.3 samples/s | 29.8 steps/s
[Step= 250] | Loss=5.76590 | acc=0.1430 | tpr=0.8699 | fpr=0.8703 | 7281.8 samples/s | 28.4 steps/s
[Step= 300] | Loss=5.75991 | acc=0.1437 | tpr=0.8720 | fpr=0.8696 | 8461.5 samples/s | 33.1 steps/s
[Step= 350] | Loss=5.76393 | acc=0.1435 | tpr=0.8691 | fpr=0.8697 | 7834.7 samples/s | 30.6 steps/s
[Step= 400] | Loss=5.76264 | acc=0.1434 | tpr=0.8649 | fpr=0.8697 | 7966.1 samples/s | 31.1 steps/s
[Step= 450] | Loss=5.76302 | acc=0.1432 | tpr=0.8666 | fpr=0.8700 | 8157.5 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.76669 | acc=0.1427 | tpr=0.8648 | fpr=0.8703 | 8171.4 samples/s | 31.9 steps/s
[Step= 550] | Loss=5.76511 | acc=0.1428 | tpr=0.8683 | fpr=0.8703 | 10025.2 samples/s | 39.2 steps/s
Avg test loss: 5.76571, Avg test acc: 0.14275, Avg tpr: 0.86807, Avg fpr: 0.87043, total FA: 120858

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.15785 | acc=0.1488 | tpr=0.8142 | fpr=0.8631 | 4660.4 samples/s | 18.2 steps/s
[Step= 100] | Loss=4.16745 | acc=0.1495 | tpr=0.8273 | fpr=0.8631 | 7963.5 samples/s | 31.1 steps/s
[Step= 150] | Loss=4.17109 | acc=0.1505 | tpr=0.8444 | fpr=0.8623 | 8193.5 samples/s | 32.0 steps/s
[Step= 200] | Loss=4.16197 | acc=0.1510 | tpr=0.8514 | fpr=0.8618 | 8140.7 samples/s | 31.8 steps/s
[Step= 250] | Loss=4.16852 | acc=0.1514 | tpr=0.8454 | fpr=0.8613 | 7858.3 samples/s | 30.7 steps/s
[Step= 300] | Loss=4.16977 | acc=0.1516 | tpr=0.8415 | fpr=0.8610 | 7216.2 samples/s | 28.2 steps/s
[Step= 350] | Loss=4.17332 | acc=0.1515 | tpr=0.8403 | fpr=0.8610 | 7670.1 samples/s | 30.0 steps/s
[Step= 400] | Loss=4.17405 | acc=0.1513 | tpr=0.8425 | fpr=0.8612 | 8192.0 samples/s | 32.0 steps/s
[Step= 450] | Loss=4.17480 | acc=0.1509 | tpr=0.8408 | fpr=0.8616 | 8121.9 samples/s | 31.7 steps/s
[Step= 500] | Loss=4.17432 | acc=0.1512 | tpr=0.8410 | fpr=0.8612 | 7947.4 samples/s | 31.0 steps/s
[Step= 550] | Loss=4.17389 | acc=0.1513 | tpr=0.8464 | fpr=0.8614 | 11040.6 samples/s | 43.1 steps/s
Avg test loss: 4.17527, Avg test acc: 0.15118, Avg tpr: 0.84667, Avg fpr: 0.86146, total FA: 119612

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.00332 | acc=0.1375 | tpr=0.8496 | fpr=0.8753 | 4627.9 samples/s | 18.1 steps/s
[Step= 100] | Loss=4.98696 | acc=0.1412 | tpr=0.8571 | fpr=0.8721 | 7681.3 samples/s | 30.0 steps/s
[Step= 150] | Loss=4.98563 | acc=0.1424 | tpr=0.8444 | fpr=0.8705 | 8502.4 samples/s | 33.2 steps/s
[Step= 200] | Loss=4.97103 | acc=0.1424 | tpr=0.8481 | fpr=0.8704 | 8397.3 samples/s | 32.8 steps/s
[Step= 250] | Loss=4.97581 | acc=0.1431 | tpr=0.8454 | fpr=0.8697 | 7787.3 samples/s | 30.4 steps/s
[Step= 300] | Loss=4.97708 | acc=0.1432 | tpr=0.8531 | fpr=0.8697 | 8091.6 samples/s | 31.6 steps/s
[Step= 350] | Loss=4.97685 | acc=0.1432 | tpr=0.8547 | fpr=0.8697 | 7599.5 samples/s | 29.7 steps/s
[Step= 400] | Loss=4.97787 | acc=0.1433 | tpr=0.8567 | fpr=0.8697 | 7708.3 samples/s | 30.1 steps/s
[Step= 450] | Loss=4.98027 | acc=0.1428 | tpr=0.8559 | fpr=0.8701 | 8245.1 samples/s | 32.2 steps/s
[Step= 500] | Loss=4.98009 | acc=0.1430 | tpr=0.8529 | fpr=0.8698 | 8366.9 samples/s | 32.7 steps/s
[Step= 550] | Loss=4.97635 | acc=0.1434 | tpr=0.8532 | fpr=0.8695 | 9461.5 samples/s | 37.0 steps/s
Avg test loss: 4.97751, Avg test acc: 0.14332, Avg tpr: 0.85341, Avg fpr: 0.86959, total FA: 120741

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.82916 | acc=0.1148 | tpr=0.9115 | fpr=0.8996 | 4755.5 samples/s | 18.6 steps/s
[Step= 100] | Loss=5.81614 | acc=0.1133 | tpr=0.9062 | fpr=0.9015 | 7683.5 samples/s | 30.0 steps/s
[Step= 150] | Loss=5.81559 | acc=0.1133 | tpr=0.9150 | fpr=0.9014 | 7248.9 samples/s | 28.3 steps/s
[Step= 200] | Loss=5.80588 | acc=0.1135 | tpr=0.9126 | fpr=0.9010 | 8489.6 samples/s | 33.2 steps/s
[Step= 250] | Loss=5.81133 | acc=0.1140 | tpr=0.9074 | fpr=0.9005 | 8423.7 samples/s | 32.9 steps/s
[Step= 300] | Loss=5.80695 | acc=0.1143 | tpr=0.9047 | fpr=0.9001 | 7799.4 samples/s | 30.5 steps/s
[Step= 350] | Loss=5.81209 | acc=0.1141 | tpr=0.9023 | fpr=0.9002 | 7977.3 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.81270 | acc=0.1138 | tpr=0.8977 | fpr=0.9005 | 7855.6 samples/s | 30.7 steps/s
[Step= 450] | Loss=5.81575 | acc=0.1132 | tpr=0.8958 | fpr=0.9010 | 7691.3 samples/s | 30.0 steps/s
[Step= 500] | Loss=5.81675 | acc=0.1130 | tpr=0.8930 | fpr=0.9011 | 8031.3 samples/s | 31.4 steps/s
[Step= 550] | Loss=5.81296 | acc=0.1131 | tpr=0.8949 | fpr=0.9011 | 10771.6 samples/s | 42.1 steps/s
Avg test loss: 5.81455, Avg test acc: 0.11304, Avg tpr: 0.89501, Avg fpr: 0.90117, total FA: 125126

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=0.42796 | acc=0.0340 | tpr=0.9956 | fpr=0.9833 | 4745.8 samples/s | 18.5 steps/s
[Step= 100] | Loss=0.42727 | acc=0.0343 | tpr=0.9936 | fpr=0.9836 | 7823.3 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.42780 | acc=0.0336 | tpr=0.9957 | fpr=0.9841 | 8090.2 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.42777 | acc=0.0336 | tpr=0.9967 | fpr=0.9839 | 7182.3 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.42806 | acc=0.0340 | tpr=0.9974 | fpr=0.9836 | 8358.1 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.42806 | acc=0.0338 | tpr=0.9971 | fpr=0.9838 | 8445.8 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.42815 | acc=0.0335 | tpr=0.9969 | fpr=0.9840 | 8178.7 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.42819 | acc=0.0334 | tpr=0.9956 | fpr=0.9841 | 7873.3 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.42822 | acc=0.0332 | tpr=0.9961 | fpr=0.9843 | 7636.3 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.42830 | acc=0.0330 | tpr=0.9960 | fpr=0.9844 | 8076.3 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.42825 | acc=0.0330 | tpr=0.9956 | fpr=0.9845 | 9901.6 samples/s | 38.7 steps/s
Avg test loss: 0.42824, Avg test acc: 0.03300, Avg tpr: 0.99564, Avg fpr: 0.98450, total FA: 136696

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10685 | acc=0.9652 | tpr=0.9292 | fpr=0.0342 | 4633.4 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.10904 | acc=0.9650 | tpr=0.9339 | fpr=0.0344 | 7751.9 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.11006 | acc=0.9643 | tpr=0.9337 | fpr=0.0351 | 7693.2 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.11037 | acc=0.9644 | tpr=0.9377 | fpr=0.0351 | 8562.6 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.11115 | acc=0.9640 | tpr=0.9389 | fpr=0.0356 | 7783.9 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.11263 | acc=0.9633 | tpr=0.9360 | fpr=0.0362 | 8221.4 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.11275 | acc=0.9634 | tpr=0.9349 | fpr=0.0361 | 8016.1 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.11308 | acc=0.9632 | tpr=0.9322 | fpr=0.0363 | 7898.9 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.11392 | acc=0.9631 | tpr=0.9314 | fpr=0.0364 | 8275.0 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.11404 | acc=0.9629 | tpr=0.9330 | fpr=0.0366 | 8153.3 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.11352 | acc=0.9629 | tpr=0.9327 | fpr=0.0366 | 9959.9 samples/s | 38.9 steps/s
Avg test loss: 0.11337, Avg test acc: 0.96289, Avg tpr: 0.93265, Avg fpr: 0.03657, total FA: 5077

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12198 | acc=0.9623 | tpr=0.9027 | fpr=0.0366 | 4765.5 samples/s | 18.6 steps/s
[Step= 100] | Loss=0.12261 | acc=0.9623 | tpr=0.9062 | fpr=0.0366 | 7407.3 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.12595 | acc=0.9610 | tpr=0.9092 | fpr=0.0380 | 7613.5 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.12581 | acc=0.9613 | tpr=0.9126 | fpr=0.0378 | 8161.7 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.12718 | acc=0.9610 | tpr=0.9074 | fpr=0.0380 | 7658.5 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.12810 | acc=0.9607 | tpr=0.9084 | fpr=0.0383 | 7637.9 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.12892 | acc=0.9609 | tpr=0.9130 | fpr=0.0383 | 8123.5 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.12916 | acc=0.9606 | tpr=0.9048 | fpr=0.0384 | 8341.4 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.13076 | acc=0.9602 | tpr=0.9036 | fpr=0.0387 | 8357.4 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.13069 | acc=0.9603 | tpr=0.9057 | fpr=0.0388 | 7778.8 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.13084 | acc=0.9603 | tpr=0.9017 | fpr=0.0386 | 10872.3 samples/s | 42.5 steps/s
Avg test loss: 0.13064, Avg test acc: 0.96029, Avg tpr: 0.90135, Avg fpr: 0.03864, total FA: 5365

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.25680 | acc=0.9483 | tpr=0.9027 | fpr=0.0509 | 4700.1 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.26125 | acc=0.9477 | tpr=0.9211 | fpr=0.0518 | 7567.2 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.27037 | acc=0.9462 | tpr=0.9265 | fpr=0.0534 | 8123.6 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.27179 | acc=0.9464 | tpr=0.9322 | fpr=0.0534 | 7936.6 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.27287 | acc=0.9461 | tpr=0.9258 | fpr=0.0535 | 8503.6 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.27481 | acc=0.9458 | tpr=0.9229 | fpr=0.0538 | 8243.3 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.27397 | acc=0.9458 | tpr=0.9224 | fpr=0.0537 | 7974.2 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.27500 | acc=0.9457 | tpr=0.9201 | fpr=0.0539 | 7797.0 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.27646 | acc=0.9453 | tpr=0.9177 | fpr=0.0542 | 7929.9 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.27637 | acc=0.9452 | tpr=0.9185 | fpr=0.0543 | 7948.4 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.27538 | acc=0.9455 | tpr=0.9188 | fpr=0.0540 | 9674.5 samples/s | 37.8 steps/s
Avg test loss: 0.27520, Avg test acc: 0.94553, Avg tpr: 0.91918, Avg fpr: 0.05399, total FA: 7496

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09731 | acc=0.9685 | tpr=0.9115 | fpr=0.0305 | 4614.7 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.09795 | acc=0.9679 | tpr=0.9254 | fpr=0.0314 | 7929.0 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.10023 | acc=0.9669 | tpr=0.9251 | fpr=0.0324 | 7646.8 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.09999 | acc=0.9669 | tpr=0.9290 | fpr=0.0324 | 8073.8 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.10157 | acc=0.9670 | tpr=0.9197 | fpr=0.0322 | 8271.5 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.10301 | acc=0.9664 | tpr=0.9142 | fpr=0.0327 | 7192.5 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.10342 | acc=0.9662 | tpr=0.9148 | fpr=0.0328 | 8100.5 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.10401 | acc=0.9658 | tpr=0.9086 | fpr=0.0332 | 8356.6 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.10491 | acc=0.9657 | tpr=0.9060 | fpr=0.0332 | 7456.6 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.10459 | acc=0.9658 | tpr=0.9084 | fpr=0.0332 | 8423.6 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.10399 | acc=0.9658 | tpr=0.9045 | fpr=0.0331 | 11266.8 samples/s | 44.0 steps/s
Avg test loss: 0.10385, Avg test acc: 0.96586, Avg tpr: 0.90491, Avg fpr: 0.03304, total FA: 4587

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.25496 | acc=0.9522 | tpr=0.8761 | fpr=0.0464 | 4315.2 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.26142 | acc=0.9511 | tpr=0.8998 | fpr=0.0479 | 8122.5 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.26451 | acc=0.9501 | tpr=0.9107 | fpr=0.0491 | 8452.1 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.26572 | acc=0.9504 | tpr=0.9158 | fpr=0.0490 | 8276.9 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.26818 | acc=0.9501 | tpr=0.9144 | fpr=0.0492 | 7868.7 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.27075 | acc=0.9497 | tpr=0.9113 | fpr=0.0496 | 8066.5 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.27032 | acc=0.9497 | tpr=0.9073 | fpr=0.0495 | 8155.5 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.27092 | acc=0.9495 | tpr=0.9021 | fpr=0.0497 | 8353.3 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.27309 | acc=0.9491 | tpr=0.9002 | fpr=0.0500 | 7163.5 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.27505 | acc=0.9489 | tpr=0.8991 | fpr=0.0502 | 8476.4 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.27419 | acc=0.9490 | tpr=0.8981 | fpr=0.0501 | 10478.4 samples/s | 40.9 steps/s
Avg test loss: 0.27390, Avg test acc: 0.94905, Avg tpr: 0.89818, Avg fpr: 0.05003, total FA: 6946

server round 4/50

clients selected: [0 3 4 5 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=29.3] | Loss=0.17793 | Reg=0.00214 | acc=0.8750 | L2-Norm=14.622 | L2-Norm(final)=6.418 | 3239.0 samples/s | 50.6 steps/s
[Step=6050 Epoch=29.5] | Loss=0.16352 | Reg=0.00214 | acc=0.9062 | L2-Norm=14.621 | L2-Norm(final)=6.537 | 4853.4 samples/s | 75.8 steps/s
[Step=6100 Epoch=29.7] | Loss=0.16051 | Reg=0.00214 | acc=0.9219 | L2-Norm=14.621 | L2-Norm(final)=6.686 | 5439.9 samples/s | 85.0 steps/s
[Step=6150 Epoch=30.0] | Loss=0.15943 | Reg=0.00214 | acc=0.9375 | L2-Norm=14.621 | L2-Norm(final)=6.832 | 5569.9 samples/s | 87.0 steps/s
[Step=6200 Epoch=30.2] | Loss=0.15908 | Reg=0.00214 | acc=0.8438 | L2-Norm=14.621 | L2-Norm(final)=6.962 | 8412.3 samples/s | 131.4 steps/s
[Step=6250 Epoch=30.5] | Loss=0.15771 | Reg=0.00214 | acc=0.8594 | L2-Norm=14.622 | L2-Norm(final)=7.083 | 1471.4 samples/s | 23.0 steps/s
[Step=6300 Epoch=30.7] | Loss=0.15670 | Reg=0.00214 | acc=0.9219 | L2-Norm=14.622 | L2-Norm(final)=7.201 | 5542.0 samples/s | 86.6 steps/s
[Step=6350 Epoch=31.0] | Loss=0.15593 | Reg=0.00214 | acc=0.9062 | L2-Norm=14.622 | L2-Norm(final)=7.311 | 5594.3 samples/s | 87.4 steps/s
[Step=6400 Epoch=31.2] | Loss=0.15537 | Reg=0.00214 | acc=0.8750 | L2-Norm=14.622 | L2-Norm(final)=7.416 | 7255.2 samples/s | 113.4 steps/s
[Step=6450 Epoch=31.5] | Loss=0.15530 | Reg=0.00214 | acc=0.8750 | L2-Norm=14.622 | L2-Norm(final)=7.516 | 1522.0 samples/s | 23.8 steps/s
[Step=6500 Epoch=31.7] | Loss=0.15430 | Reg=0.00214 | acc=0.9219 | L2-Norm=14.622 | L2-Norm(final)=7.612 | 5443.8 samples/s | 85.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=31.7] | Loss=0.15568 | Reg=0.00214 | acc=0.8906 | L2-Norm=14.622 | L2-Norm(final)=8.565 | 3160.8 samples/s | 49.4 steps/s
[Step=6550 Epoch=31.9] | Loss=0.12051 | Reg=0.00221 | acc=0.9219 | L2-Norm=14.861 | L2-Norm(final)=8.576 | 4305.9 samples/s | 67.3 steps/s
[Step=6600 Epoch=32.2] | Loss=0.11375 | Reg=0.00226 | acc=0.8906 | L2-Norm=15.026 | L2-Norm(final)=8.559 | 4776.6 samples/s | 74.6 steps/s
[Step=6650 Epoch=32.4] | Loss=0.10418 | Reg=0.00229 | acc=0.9531 | L2-Norm=15.115 | L2-Norm(final)=8.543 | 4646.9 samples/s | 72.6 steps/s
[Step=6700 Epoch=32.7] | Loss=0.09863 | Reg=0.00230 | acc=0.9219 | L2-Norm=15.179 | L2-Norm(final)=8.534 | 6769.9 samples/s | 105.8 steps/s
[Step=6750 Epoch=32.9] | Loss=0.09178 | Reg=0.00232 | acc=0.9531 | L2-Norm=15.237 | L2-Norm(final)=8.526 | 1409.2 samples/s | 22.0 steps/s
[Step=6800 Epoch=33.2] | Loss=0.08502 | Reg=0.00234 | acc=0.9531 | L2-Norm=15.292 | L2-Norm(final)=8.520 | 4665.4 samples/s | 72.9 steps/s
[Step=6850 Epoch=33.4] | Loss=0.08072 | Reg=0.00235 | acc=0.9688 | L2-Norm=15.340 | L2-Norm(final)=8.515 | 4674.0 samples/s | 73.0 steps/s
[Step=6900 Epoch=33.6] | Loss=0.07753 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.384 | L2-Norm(final)=8.511 | 6188.0 samples/s | 96.7 steps/s
[Step=6950 Epoch=33.9] | Loss=0.07298 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.425 | L2-Norm(final)=8.508 | 1434.2 samples/s | 22.4 steps/s
[Step=7000 Epoch=34.1] | Loss=0.06912 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.465 | L2-Norm(final)=8.507 | 4781.2 samples/s | 74.7 steps/s
[Step=7050 Epoch=34.4] | Loss=0.06629 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.500 | L2-Norm(final)=8.506 | 4655.9 samples/s | 72.7 steps/s
[Step=7100 Epoch=34.6] | Loss=0.06440 | Reg=0.00241 | acc=0.9531 | L2-Norm=15.535 | L2-Norm(final)=8.504 | 5612.3 samples/s | 87.7 steps/s
[Step=7150 Epoch=34.9] | Loss=0.06315 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.569 | L2-Norm(final)=8.503 | 1488.1 samples/s | 23.3 steps/s
[Step=7200 Epoch=35.1] | Loss=0.06131 | Reg=0.00244 | acc=0.9531 | L2-Norm=15.603 | L2-Norm(final)=8.501 | 4654.5 samples/s | 72.7 steps/s
[Step=7250 Epoch=35.4] | Loss=0.05900 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.634 | L2-Norm(final)=8.500 | 4761.7 samples/s | 74.4 steps/s
[Step=7300 Epoch=35.6] | Loss=0.05716 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.664 | L2-Norm(final)=8.500 | 5167.7 samples/s | 80.7 steps/s
[Step=7350 Epoch=35.8] | Loss=0.05533 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.691 | L2-Norm(final)=8.500 | 1527.1 samples/s | 23.9 steps/s
[Step=7400 Epoch=36.1] | Loss=0.05346 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.716 | L2-Norm(final)=8.500 | 4661.6 samples/s | 72.8 steps/s
[Step=7450 Epoch=36.3] | Loss=0.05162 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.739 | L2-Norm(final)=8.501 | 4724.6 samples/s | 73.8 steps/s
[Step=7500 Epoch=36.6] | Loss=0.05026 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.761 | L2-Norm(final)=8.501 | 4841.1 samples/s | 75.6 steps/s
[Step=7550 Epoch=36.8] | Loss=0.04897 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.783 | L2-Norm(final)=8.502 | 1574.3 samples/s | 24.6 steps/s
[Step=7600 Epoch=37.1] | Loss=0.04752 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.803 | L2-Norm(final)=8.502 | 4668.0 samples/s | 72.9 steps/s
[Step=7650 Epoch=37.3] | Loss=0.04626 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.823 | L2-Norm(final)=8.503 | 4677.1 samples/s | 73.1 steps/s
[Step=7700 Epoch=37.5] | Loss=0.04512 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.842 | L2-Norm(final)=8.504 | 4748.9 samples/s | 74.2 steps/s
[Step=7750 Epoch=37.8] | Loss=0.04481 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.862 | L2-Norm(final)=8.505 | 1545.0 samples/s | 24.1 steps/s
[Step=7800 Epoch=38.0] | Loss=0.04498 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.884 | L2-Norm(final)=8.503 | 4663.1 samples/s | 72.9 steps/s
[Step=7850 Epoch=38.3] | Loss=0.04424 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.909 | L2-Norm(final)=8.502 | 4686.8 samples/s | 73.2 steps/s
[Step=7900 Epoch=38.5] | Loss=0.04369 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.934 | L2-Norm(final)=8.500 | 4723.7 samples/s | 73.8 steps/s
[Step=7950 Epoch=38.8] | Loss=0.04314 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.958 | L2-Norm(final)=8.499 | 1583.9 samples/s | 24.7 steps/s
[Step=8000 Epoch=39.0] | Loss=0.04219 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.983 | L2-Norm(final)=8.498 | 4656.5 samples/s | 72.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step8000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.25239 | Reg=0.00214 | acc=0.7031 | L2-Norm=14.622 | L2-Norm(final)=5.334 | 3077.8 samples/s | 48.1 steps/s
[Step=4050 Epoch=19.8] | Loss=0.20735 | Reg=0.00214 | acc=0.9062 | L2-Norm=14.623 | L2-Norm(final)=5.292 | 4825.9 samples/s | 75.4 steps/s
[Step=4100 Epoch=20.0] | Loss=0.19242 | Reg=0.00214 | acc=0.7969 | L2-Norm=14.623 | L2-Norm(final)=5.357 | 5652.9 samples/s | 88.3 steps/s
[Step=4150 Epoch=20.2] | Loss=0.18541 | Reg=0.00214 | acc=0.7812 | L2-Norm=14.623 | L2-Norm(final)=5.465 | 5378.3 samples/s | 84.0 steps/s
[Step=4200 Epoch=20.5] | Loss=0.18218 | Reg=0.00214 | acc=0.9219 | L2-Norm=14.623 | L2-Norm(final)=5.575 | 8472.7 samples/s | 132.4 steps/s
[Step=4250 Epoch=20.7] | Loss=0.18007 | Reg=0.00214 | acc=0.8125 | L2-Norm=14.623 | L2-Norm(final)=5.681 | 1458.6 samples/s | 22.8 steps/s
[Step=4300 Epoch=21.0] | Loss=0.17683 | Reg=0.00214 | acc=0.8594 | L2-Norm=14.623 | L2-Norm(final)=5.788 | 5524.0 samples/s | 86.3 steps/s
[Step=4350 Epoch=21.2] | Loss=0.17453 | Reg=0.00214 | acc=0.8125 | L2-Norm=14.623 | L2-Norm(final)=5.896 | 5504.1 samples/s | 86.0 steps/s
[Step=4400 Epoch=21.5] | Loss=0.17242 | Reg=0.00214 | acc=0.8906 | L2-Norm=14.623 | L2-Norm(final)=6.003 | 7529.4 samples/s | 117.6 steps/s
[Step=4450 Epoch=21.7] | Loss=0.17094 | Reg=0.00214 | acc=0.8438 | L2-Norm=14.623 | L2-Norm(final)=6.108 | 1532.2 samples/s | 23.9 steps/s
[Step=4500 Epoch=21.9] | Loss=0.16943 | Reg=0.00214 | acc=0.8594 | L2-Norm=14.623 | L2-Norm(final)=6.209 | 5430.6 samples/s | 84.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=21.9] | Loss=0.14369 | Reg=0.00214 | acc=0.8906 | L2-Norm=14.624 | L2-Norm(final)=7.212 | 3229.4 samples/s | 50.5 steps/s
[Step=4550 Epoch=22.2] | Loss=0.12355 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.904 | L2-Norm(final)=7.228 | 4160.4 samples/s | 65.0 steps/s
[Step=4600 Epoch=22.4] | Loss=0.11632 | Reg=0.00228 | acc=0.9375 | L2-Norm=15.092 | L2-Norm(final)=7.211 | 4705.8 samples/s | 73.5 steps/s
[Step=4650 Epoch=22.7] | Loss=0.10869 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.217 | L2-Norm(final)=7.199 | 4724.4 samples/s | 73.8 steps/s
[Step=4700 Epoch=22.9] | Loss=0.10309 | Reg=0.00235 | acc=0.9219 | L2-Norm=15.313 | L2-Norm(final)=7.190 | 6771.9 samples/s | 105.8 steps/s
[Step=4750 Epoch=23.2] | Loss=0.09423 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.404 | L2-Norm(final)=7.183 | 1416.8 samples/s | 22.1 steps/s
[Step=4800 Epoch=23.4] | Loss=0.08807 | Reg=0.00240 | acc=0.9219 | L2-Norm=15.484 | L2-Norm(final)=7.180 | 4643.3 samples/s | 72.6 steps/s
[Step=4850 Epoch=23.7] | Loss=0.08360 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.553 | L2-Norm(final)=7.177 | 4683.9 samples/s | 73.2 steps/s
[Step=4900 Epoch=23.9] | Loss=0.07995 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.613 | L2-Norm(final)=7.176 | 6185.3 samples/s | 96.6 steps/s
[Step=4950 Epoch=24.1] | Loss=0.07608 | Reg=0.00246 | acc=0.9375 | L2-Norm=15.667 | L2-Norm(final)=7.174 | 1464.8 samples/s | 22.9 steps/s
[Step=5000 Epoch=24.4] | Loss=0.07117 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.717 | L2-Norm(final)=7.174 | 4757.1 samples/s | 74.3 steps/s
[Step=5050 Epoch=24.6] | Loss=0.06731 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.762 | L2-Norm(final)=7.175 | 4654.4 samples/s | 72.7 steps/s
[Step=5100 Epoch=24.9] | Loss=0.06463 | Reg=0.00250 | acc=0.9531 | L2-Norm=15.803 | L2-Norm(final)=7.176 | 5644.7 samples/s | 88.2 steps/s
[Step=5150 Epoch=25.1] | Loss=0.06203 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.842 | L2-Norm(final)=7.177 | 1492.3 samples/s | 23.3 steps/s
[Step=5200 Epoch=25.4] | Loss=0.05926 | Reg=0.00252 | acc=0.9531 | L2-Norm=15.880 | L2-Norm(final)=7.179 | 4739.4 samples/s | 74.1 steps/s
[Step=5250 Epoch=25.6] | Loss=0.05705 | Reg=0.00254 | acc=0.9688 | L2-Norm=15.916 | L2-Norm(final)=7.181 | 4738.9 samples/s | 74.0 steps/s
[Step=5300 Epoch=25.8] | Loss=0.05566 | Reg=0.00255 | acc=0.9844 | L2-Norm=15.951 | L2-Norm(final)=7.183 | 5112.5 samples/s | 79.9 steps/s
[Step=5350 Epoch=26.1] | Loss=0.05387 | Reg=0.00256 | acc=0.9688 | L2-Norm=15.984 | L2-Norm(final)=7.184 | 1523.0 samples/s | 23.8 steps/s
[Step=5400 Epoch=26.3] | Loss=0.05221 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.016 | L2-Norm(final)=7.185 | 4682.5 samples/s | 73.2 steps/s
[Step=5450 Epoch=26.6] | Loss=0.05056 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.045 | L2-Norm(final)=7.186 | 4750.8 samples/s | 74.2 steps/s
[Step=5500 Epoch=26.8] | Loss=0.04926 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.073 | L2-Norm(final)=7.188 | 4806.1 samples/s | 75.1 steps/s
[Step=5550 Epoch=27.1] | Loss=0.04803 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.099 | L2-Norm(final)=7.189 | 1548.5 samples/s | 24.2 steps/s
[Step=5600 Epoch=27.3] | Loss=0.04668 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.123 | L2-Norm(final)=7.190 | 4717.7 samples/s | 73.7 steps/s
[Step=5650 Epoch=27.6] | Loss=0.04545 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.146 | L2-Norm(final)=7.191 | 4647.0 samples/s | 72.6 steps/s
[Step=5700 Epoch=27.8] | Loss=0.04460 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.168 | L2-Norm(final)=7.193 | 4843.8 samples/s | 75.7 steps/s
[Step=5750 Epoch=28.0] | Loss=0.04382 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.189 | L2-Norm(final)=7.193 | 1530.3 samples/s | 23.9 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04304 | Reg=0.00263 | acc=0.9844 | L2-Norm=16.212 | L2-Norm(final)=7.194 | 4677.2 samples/s | 73.1 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04254 | Reg=0.00264 | acc=0.9062 | L2-Norm=16.236 | L2-Norm(final)=7.194 | 4697.3 samples/s | 73.4 steps/s
[Step=5900 Epoch=28.8] | Loss=0.04174 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.260 | L2-Norm(final)=7.195 | 4680.7 samples/s | 73.1 steps/s
[Step=5950 Epoch=29.0] | Loss=0.04100 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.283 | L2-Norm(final)=7.195 | 1568.3 samples/s | 24.5 steps/s
[Step=6000 Epoch=29.3] | Loss=0.04038 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.306 | L2-Norm(final)=7.195 | 4726.5 samples/s | 73.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step6000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33872 | Reg=0.00214 | acc=0.5938 | L2-Norm=14.622 | L2-Norm(final)=1.886 | 3226.6 samples/s | 50.4 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.31068 | Reg=0.00214 | acc=0.8594 | L2-Norm=14.622 | L2-Norm(final)=1.993 | 5322.2 samples/s | 83.2 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.29073 | Reg=0.00214 | acc=0.8594 | L2-Norm=14.622 | L2-Norm(final)=2.175 | 6214.4 samples/s | 97.1 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.27567 | Reg=0.00214 | acc=0.8594 | L2-Norm=14.622 | L2-Norm(final)=2.388 | 6119.0 samples/s | 95.6 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.26286 | Reg=0.00214 | acc=0.8594 | L2-Norm=14.622 | L2-Norm(final)=2.612 | 9986.7 samples/s | 156.0 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.25290 | Reg=0.00214 | acc=0.8438 | L2-Norm=14.622 | L2-Norm(final)=2.834 | 1520.2 samples/s | 23.8 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.24502 | Reg=0.00214 | acc=0.7969 | L2-Norm=14.622 | L2-Norm(final)=3.049 | 5965.9 samples/s | 93.2 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.23832 | Reg=0.00214 | acc=0.9219 | L2-Norm=14.622 | L2-Norm(final)=3.254 | 6137.8 samples/s | 95.9 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.23203 | Reg=0.00214 | acc=0.9375 | L2-Norm=14.622 | L2-Norm(final)=3.452 | 9595.9 samples/s | 149.9 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.22684 | Reg=0.00214 | acc=0.8594 | L2-Norm=14.622 | L2-Norm(final)=3.642 | 1538.5 samples/s | 24.0 steps/s
[Step= 500 Epoch= 2.5] | Loss=0.22245 | Reg=0.00214 | acc=0.9219 | L2-Norm=14.622 | L2-Norm(final)=3.823 | 5942.4 samples/s | 92.9 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.5] | Loss=0.20409 | Reg=0.00214 | acc=0.7969 | L2-Norm=14.622 | L2-Norm(final)=5.606 | 3127.4 samples/s | 48.9 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12344 | Reg=0.00215 | acc=0.8906 | L2-Norm=14.676 | L2-Norm(final)=5.652 | 4342.9 samples/s | 67.9 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.11806 | Reg=0.00217 | acc=0.9375 | L2-Norm=14.726 | L2-Norm(final)=5.648 | 4711.9 samples/s | 73.6 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11187 | Reg=0.00218 | acc=0.9531 | L2-Norm=14.776 | L2-Norm(final)=5.639 | 4662.3 samples/s | 72.8 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.10544 | Reg=0.00220 | acc=0.8906 | L2-Norm=14.824 | L2-Norm(final)=5.638 | 6919.7 samples/s | 108.1 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.09515 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.873 | L2-Norm(final)=5.642 | 1412.5 samples/s | 22.1 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.08908 | Reg=0.00223 | acc=0.9531 | L2-Norm=14.922 | L2-Norm(final)=5.651 | 4700.0 samples/s | 73.4 steps/s
[Step= 850 Epoch= 4.2] | Loss=0.08383 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.972 | L2-Norm(final)=5.659 | 4668.9 samples/s | 73.0 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.08063 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.020 | L2-Norm(final)=5.668 | 6497.2 samples/s | 101.5 steps/s
[Step= 950 Epoch= 4.7] | Loss=0.07633 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.068 | L2-Norm(final)=5.677 | 1427.0 samples/s | 22.3 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.07170 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.114 | L2-Norm(final)=5.688 | 4700.0 samples/s | 73.4 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.06889 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.159 | L2-Norm(final)=5.699 | 4674.8 samples/s | 73.0 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.06627 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.204 | L2-Norm(final)=5.709 | 6094.8 samples/s | 95.2 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.06309 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.249 | L2-Norm(final)=5.720 | 1461.9 samples/s | 22.8 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.06103 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.291 | L2-Norm(final)=5.730 | 4657.9 samples/s | 72.8 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.05863 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.332 | L2-Norm(final)=5.739 | 4676.9 samples/s | 73.1 steps/s
[Step=1300 Epoch= 6.4] | Loss=0.05665 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.372 | L2-Norm(final)=5.750 | 5714.9 samples/s | 89.3 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.05510 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.411 | L2-Norm(final)=5.758 | 1473.2 samples/s | 23.0 steps/s
[Step=1400 Epoch= 6.9] | Loss=0.05391 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.449 | L2-Norm(final)=5.767 | 4635.4 samples/s | 72.4 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.05242 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.488 | L2-Norm(final)=5.775 | 4782.4 samples/s | 74.7 steps/s
[Step=1500 Epoch= 7.4] | Loss=0.05136 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.525 | L2-Norm(final)=5.782 | 5340.7 samples/s | 83.4 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.05006 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.562 | L2-Norm(final)=5.789 | 1479.1 samples/s | 23.1 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.04858 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.598 | L2-Norm(final)=5.797 | 4757.1 samples/s | 74.3 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.04783 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.634 | L2-Norm(final)=5.804 | 4658.2 samples/s | 72.8 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.04687 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.670 | L2-Norm(final)=5.810 | 5150.7 samples/s | 80.5 steps/s
[Step=1750 Epoch= 8.6] | Loss=0.04593 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.705 | L2-Norm(final)=5.816 | 1540.1 samples/s | 24.1 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.04492 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.739 | L2-Norm(final)=5.823 | 4688.1 samples/s | 73.3 steps/s
[Step=1850 Epoch= 9.1] | Loss=0.04381 | Reg=0.00249 | acc=0.9688 | L2-Norm=15.773 | L2-Norm(final)=5.829 | 4704.2 samples/s | 73.5 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.04318 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.806 | L2-Norm(final)=5.834 | 4890.1 samples/s | 76.4 steps/s
[Step=1950 Epoch= 9.6] | Loss=0.04231 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.838 | L2-Norm(final)=5.839 | 1516.9 samples/s | 23.7 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.04147 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.870 | L2-Norm(final)=5.845 | 4795.9 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_4/client_state-step2000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=37.9] | Loss=0.04231 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.622 | L2-Norm(final)=7.197 | 3224.9 samples/s | 50.4 steps/s
[Step=4050 Epoch=38.4] | Loss=0.05358 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.613 | L2-Norm(final)=7.300 | 4459.6 samples/s | 69.7 steps/s
[Step=4100 Epoch=38.9] | Loss=0.05154 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.612 | L2-Norm(final)=7.436 | 8189.6 samples/s | 128.0 steps/s
[Step=4150 Epoch=39.3] | Loss=0.04971 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.612 | L2-Norm(final)=7.564 | 1434.2 samples/s | 22.4 steps/s
[Step=4200 Epoch=39.8] | Loss=0.04922 | Reg=0.00214 | acc=0.9531 | L2-Norm=14.612 | L2-Norm(final)=7.686 | 7187.8 samples/s | 112.3 steps/s
[Step=4250 Epoch=40.3] | Loss=0.04789 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.612 | L2-Norm(final)=7.800 | 1465.7 samples/s | 22.9 steps/s
[Step=4300 Epoch=40.7] | Loss=0.04716 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.612 | L2-Norm(final)=7.908 | 6452.3 samples/s | 100.8 steps/s
[Step=4350 Epoch=41.2] | Loss=0.04693 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.612 | L2-Norm(final)=8.009 | 1526.3 samples/s | 23.8 steps/s
[Step=4400 Epoch=41.7] | Loss=0.04642 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.612 | L2-Norm(final)=8.103 | 5885.9 samples/s | 92.0 steps/s
[Step=4450 Epoch=42.2] | Loss=0.04586 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.612 | L2-Norm(final)=8.194 | 1558.3 samples/s | 24.3 steps/s
[Step=4500 Epoch=42.6] | Loss=0.04552 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.612 | L2-Norm(final)=8.280 | 5320.1 samples/s | 83.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.7] | Loss=0.02808 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.611 | L2-Norm(final)=9.126 | 3305.5 samples/s | 51.6 steps/s
[Step=4550 Epoch=43.1] | Loss=0.02224 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.809 | L2-Norm(final)=9.148 | 3777.3 samples/s | 59.0 steps/s
[Step=4600 Epoch=43.6] | Loss=0.01990 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.966 | L2-Norm(final)=9.138 | 6554.3 samples/s | 102.4 steps/s
[Step=4650 Epoch=44.1] | Loss=0.01379 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.039 | L2-Norm(final)=9.129 | 1395.9 samples/s | 21.8 steps/s
[Step=4700 Epoch=44.5] | Loss=0.01071 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.070 | L2-Norm(final)=9.127 | 5824.4 samples/s | 91.0 steps/s
[Step=4750 Epoch=45.0] | Loss=0.00864 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.084 | L2-Norm(final)=9.127 | 1412.9 samples/s | 22.1 steps/s
[Step=4800 Epoch=45.5] | Loss=0.00721 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.082 | L2-Norm(final)=9.127 | 5377.7 samples/s | 84.0 steps/s
[Step=4850 Epoch=46.0] | Loss=0.00619 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.071 | L2-Norm(final)=9.128 | 1454.6 samples/s | 22.7 steps/s
[Step=4900 Epoch=46.4] | Loss=0.00542 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.053 | L2-Norm(final)=9.128 | 4926.1 samples/s | 77.0 steps/s
[Step=4950 Epoch=46.9] | Loss=0.00482 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.031 | L2-Norm(final)=9.129 | 1501.4 samples/s | 23.5 steps/s
[Step=5000 Epoch=47.4] | Loss=0.00434 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.007 | L2-Norm(final)=9.130 | 4596.2 samples/s | 71.8 steps/s
[Step=5050 Epoch=47.9] | Loss=0.00394 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.981 | L2-Norm(final)=9.130 | 1535.5 samples/s | 24.0 steps/s
[Step=5100 Epoch=48.3] | Loss=0.00361 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.954 | L2-Norm(final)=9.131 | 4452.2 samples/s | 69.6 steps/s
[Step=5150 Epoch=48.8] | Loss=0.00334 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.926 | L2-Norm(final)=9.131 | 1514.3 samples/s | 23.7 steps/s
[Step=5200 Epoch=49.3] | Loss=0.00310 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.898 | L2-Norm(final)=9.131 | 4494.3 samples/s | 70.2 steps/s
[Step=5250 Epoch=49.7] | Loss=0.00289 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.869 | L2-Norm(final)=9.132 | 1519.3 samples/s | 23.7 steps/s
[Step=5300 Epoch=50.2] | Loss=0.00271 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.840 | L2-Norm(final)=9.132 | 4502.0 samples/s | 70.3 steps/s
[Step=5350 Epoch=50.7] | Loss=0.00255 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.810 | L2-Norm(final)=9.133 | 1589.6 samples/s | 24.8 steps/s
[Step=5400 Epoch=51.2] | Loss=0.00241 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.781 | L2-Norm(final)=9.133 | 4235.7 samples/s | 66.2 steps/s
[Step=5450 Epoch=51.6] | Loss=0.00229 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.751 | L2-Norm(final)=9.133 | 6679.4 samples/s | 104.4 steps/s
[Step=5500 Epoch=52.1] | Loss=0.00217 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.721 | L2-Norm(final)=9.134 | 1356.0 samples/s | 21.2 steps/s
[Step=5550 Epoch=52.6] | Loss=0.00207 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.691 | L2-Norm(final)=9.134 | 6011.8 samples/s | 93.9 steps/s
[Step=5600 Epoch=53.1] | Loss=0.00197 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.661 | L2-Norm(final)=9.134 | 1418.6 samples/s | 22.2 steps/s
[Step=5650 Epoch=53.5] | Loss=0.00189 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.631 | L2-Norm(final)=9.135 | 5445.3 samples/s | 85.1 steps/s
[Step=5700 Epoch=54.0] | Loss=0.00181 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.601 | L2-Norm(final)=9.135 | 1421.6 samples/s | 22.2 steps/s
[Step=5750 Epoch=54.5] | Loss=0.00174 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.571 | L2-Norm(final)=9.135 | 5102.3 samples/s | 79.7 steps/s
[Step=5800 Epoch=55.0] | Loss=0.00167 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.541 | L2-Norm(final)=9.135 | 1492.3 samples/s | 23.3 steps/s
[Step=5850 Epoch=55.4] | Loss=0.00161 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.511 | L2-Norm(final)=9.136 | 4705.5 samples/s | 73.5 steps/s
[Step=5900 Epoch=55.9] | Loss=0.00155 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.481 | L2-Norm(final)=9.136 | 1497.5 samples/s | 23.4 steps/s
[Step=5950 Epoch=56.4] | Loss=0.00150 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.451 | L2-Norm(final)=9.136 | 4528.5 samples/s | 70.8 steps/s
[Step=6000 Epoch=56.9] | Loss=0.00145 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.421 | L2-Norm(final)=9.137 | 1509.4 samples/s | 23.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step6000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch=18.9] | Loss=0.09625 | Reg=0.00214 | acc=0.9219 | L2-Norm=14.622 | L2-Norm(final)=4.526 | 3219.0 samples/s | 50.3 steps/s
[Step=2050 Epoch=19.3] | Loss=0.07948 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.612 | L2-Norm(final)=4.809 | 4437.1 samples/s | 69.3 steps/s
[Step=2100 Epoch=19.8] | Loss=0.07311 | Reg=0.00213 | acc=0.9062 | L2-Norm=14.611 | L2-Norm(final)=5.119 | 8055.4 samples/s | 125.9 steps/s
[Step=2150 Epoch=20.3] | Loss=0.06812 | Reg=0.00213 | acc=0.9375 | L2-Norm=14.610 | L2-Norm(final)=5.378 | 1478.5 samples/s | 23.1 steps/s
[Step=2200 Epoch=20.7] | Loss=0.06544 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.610 | L2-Norm(final)=5.602 | 6979.1 samples/s | 109.0 steps/s
[Step=2250 Epoch=21.2] | Loss=0.06315 | Reg=0.00213 | acc=0.9062 | L2-Norm=14.610 | L2-Norm(final)=5.803 | 1470.6 samples/s | 23.0 steps/s
[Step=2300 Epoch=21.7] | Loss=0.06155 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.610 | L2-Norm(final)=5.984 | 6220.1 samples/s | 97.2 steps/s
[Step=2350 Epoch=22.1] | Loss=0.05976 | Reg=0.00213 | acc=0.9375 | L2-Norm=14.610 | L2-Norm(final)=6.150 | 1560.0 samples/s | 24.4 steps/s
[Step=2400 Epoch=22.6] | Loss=0.05842 | Reg=0.00213 | acc=0.9531 | L2-Norm=14.610 | L2-Norm(final)=6.303 | 5479.0 samples/s | 85.6 steps/s
[Step=2450 Epoch=23.1] | Loss=0.05720 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.610 | L2-Norm(final)=6.446 | 1570.5 samples/s | 24.5 steps/s
[Step=2500 Epoch=23.6] | Loss=0.05656 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.610 | L2-Norm(final)=6.580 | 5163.3 samples/s | 80.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.6] | Loss=0.03614 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.609 | L2-Norm(final)=7.875 | 3154.8 samples/s | 49.3 steps/s
[Step=2550 Epoch=24.0] | Loss=0.04787 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.926 | L2-Norm(final)=7.856 | 4007.1 samples/s | 62.6 steps/s
[Step=2600 Epoch=24.5] | Loss=0.03328 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.184 | L2-Norm(final)=7.825 | 6440.7 samples/s | 100.6 steps/s
[Step=2650 Epoch=25.0] | Loss=0.02401 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.285 | L2-Norm(final)=7.816 | 1388.8 samples/s | 21.7 steps/s
[Step=2700 Epoch=25.4] | Loss=0.01854 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.329 | L2-Norm(final)=7.814 | 5725.6 samples/s | 89.5 steps/s
[Step=2750 Epoch=25.9] | Loss=0.01489 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.342 | L2-Norm(final)=7.814 | 1424.0 samples/s | 22.2 steps/s
[Step=2800 Epoch=26.4] | Loss=0.01242 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.339 | L2-Norm(final)=7.814 | 5017.8 samples/s | 78.4 steps/s
[Step=2850 Epoch=26.9] | Loss=0.01076 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.329 | L2-Norm(final)=7.815 | 1464.6 samples/s | 22.9 steps/s
[Step=2900 Epoch=27.3] | Loss=0.00942 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.313 | L2-Norm(final)=7.815 | 4724.7 samples/s | 73.8 steps/s
[Step=2950 Epoch=27.8] | Loss=0.00837 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.293 | L2-Norm(final)=7.816 | 1517.1 samples/s | 23.7 steps/s
[Step=3000 Epoch=28.3] | Loss=0.00754 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.270 | L2-Norm(final)=7.817 | 4533.5 samples/s | 70.8 steps/s
[Step=3050 Epoch=28.7] | Loss=0.00685 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.245 | L2-Norm(final)=7.817 | 1554.7 samples/s | 24.3 steps/s
[Step=3100 Epoch=29.2] | Loss=0.00628 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.218 | L2-Norm(final)=7.818 | 4391.3 samples/s | 68.6 steps/s
[Step=3150 Epoch=29.7] | Loss=0.00580 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.190 | L2-Norm(final)=7.819 | 1532.1 samples/s | 23.9 steps/s
[Step=3200 Epoch=30.2] | Loss=0.00539 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.161 | L2-Norm(final)=7.819 | 4460.5 samples/s | 69.7 steps/s
[Step=3250 Epoch=30.6] | Loss=0.00503 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.132 | L2-Norm(final)=7.820 | 1604.3 samples/s | 25.1 steps/s
[Step=3300 Epoch=31.1] | Loss=0.00471 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.102 | L2-Norm(final)=7.820 | 3911.7 samples/s | 61.1 steps/s
[Step=3350 Epoch=31.6] | Loss=0.00444 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.072 | L2-Norm(final)=7.820 | 6458.2 samples/s | 100.9 steps/s
[Step=3400 Epoch=32.0] | Loss=0.00419 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.041 | L2-Norm(final)=7.821 | 1440.7 samples/s | 22.5 steps/s
[Step=3450 Epoch=32.5] | Loss=0.00397 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.010 | L2-Norm(final)=7.821 | 5716.4 samples/s | 89.3 steps/s
[Step=3500 Epoch=33.0] | Loss=0.00377 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.979 | L2-Norm(final)=7.822 | 1422.1 samples/s | 22.2 steps/s
[Step=3550 Epoch=33.5] | Loss=0.00359 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.948 | L2-Norm(final)=7.822 | 5278.3 samples/s | 82.5 steps/s
[Step=3600 Epoch=33.9] | Loss=0.00343 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.916 | L2-Norm(final)=7.822 | 1472.2 samples/s | 23.0 steps/s
[Step=3650 Epoch=34.4] | Loss=0.00328 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.885 | L2-Norm(final)=7.823 | 4750.9 samples/s | 74.2 steps/s
[Step=3700 Epoch=34.9] | Loss=0.00315 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.853 | L2-Norm(final)=7.823 | 1477.8 samples/s | 23.1 steps/s
[Step=3750 Epoch=35.3] | Loss=0.00302 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.821 | L2-Norm(final)=7.824 | 4531.2 samples/s | 70.8 steps/s
[Step=3800 Epoch=35.8] | Loss=0.00290 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.789 | L2-Norm(final)=7.824 | 1539.4 samples/s | 24.1 steps/s
[Step=3850 Epoch=36.3] | Loss=0.00280 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.758 | L2-Norm(final)=7.824 | 4485.3 samples/s | 70.1 steps/s
[Step=3900 Epoch=36.7] | Loss=0.00270 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.726 | L2-Norm(final)=7.825 | 1506.2 samples/s | 23.5 steps/s
[Step=3950 Epoch=37.2] | Loss=0.00260 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.694 | L2-Norm(final)=7.825 | 4550.6 samples/s | 71.1 steps/s
[Step=4000 Epoch=37.7] | Loss=0.00252 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.662 | L2-Norm(final)=7.825 | 1546.8 samples/s | 24.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_3/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.14971 | acc=0.9328 | tpr=0.9456 | fpr=0.0949 | 4741.4 samples/s | 18.5 steps/s
Avg test loss: 0.15461, Avg test acc: 0.92948, Avg tpr: 0.94224, Avg fpr: 0.09858, total FA: 769

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14434 | acc=0.9268 | tpr=0.9482 | fpr=0.1197 | 4741.9 samples/s | 18.5 steps/s
Avg test loss: 0.14888, Avg test acc: 0.92479, Avg tpr: 0.94504, Avg fpr: 0.11973, total FA: 934

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.16279 | acc=0.9205 | tpr=0.9228 | fpr=0.0842 | 4527.5 samples/s | 17.7 steps/s
Avg test loss: 0.16840, Avg test acc: 0.91878, Avg tpr: 0.92137, Avg fpr: 0.08691, total FA: 678

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.16202 | acc=0.9276 | tpr=0.9698 | fpr=0.1640 | 4798.5 samples/s | 18.7 steps/s
Avg test loss: 0.16617, Avg test acc: 0.92680, Avg tpr: 0.96923, Avg fpr: 0.16652, total FA: 1299

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.13553 | acc=0.9330 | tpr=0.9469 | fpr=0.0974 | 4661.8 samples/s | 18.2 steps/s
Avg test loss: 0.13614, Avg test acc: 0.93249, Avg tpr: 0.94579, Avg fpr: 0.09678, total FA: 755

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.25207 | acc=0.3233 | tpr=0.0186 | fpr=0.0151 | 4727.2 samples/s | 18.5 steps/s
Avg test loss: 5.27372, Avg test acc: 0.31990, Avg tpr: 0.01801, Avg fpr: 0.01615, total FA: 126

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.48975 | acc=0.3237 | tpr=0.0302 | fpr=0.0389 | 4608.4 samples/s | 18.0 steps/s
Avg test loss: 4.52178, Avg test acc: 0.32162, Avg tpr: 0.02938, Avg fpr: 0.03564, total FA: 278

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.21601 | acc=0.3152 | tpr=0.0367 | fpr=0.0803 | 4661.5 samples/s | 18.2 steps/s
Avg test loss: 4.22643, Avg test acc: 0.31461, Avg tpr: 0.03707, Avg fpr: 0.07499, total FA: 585

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.26754 | acc=0.3180 | tpr=0.0269 | fpr=0.0500 | 4759.5 samples/s | 18.6 steps/s
Avg test loss: 5.28804, Avg test acc: 0.31705, Avg tpr: 0.02757, Avg fpr: 0.04628, total FA: 361

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=6.29498 | acc=0.3173 | tpr=0.0124 | fpr=0.0208 | 4822.0 samples/s | 18.8 steps/s
Avg test loss: 6.31964, Avg test acc: 0.31573, Avg tpr: 0.01323, Avg fpr: 0.01897, total FA: 148

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.41825 | acc=0.1585 | tpr=0.8363 | fpr=0.8537 | 4787.8 samples/s | 18.7 steps/s
[Step= 100] | Loss=5.39950 | acc=0.1608 | tpr=0.8124 | fpr=0.8514 | 7865.4 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.40799 | acc=0.1612 | tpr=0.8055 | fpr=0.8507 | 8042.5 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.40032 | acc=0.1600 | tpr=0.8033 | fpr=0.8517 | 7862.5 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.40631 | acc=0.1599 | tpr=0.7930 | fpr=0.8516 | 8370.3 samples/s | 32.7 steps/s
[Step= 300] | Loss=5.40899 | acc=0.1599 | tpr=0.7949 | fpr=0.8517 | 7932.2 samples/s | 31.0 steps/s
[Step= 350] | Loss=5.41473 | acc=0.1594 | tpr=0.7921 | fpr=0.8521 | 7133.6 samples/s | 27.9 steps/s
[Step= 400] | Loss=5.41193 | acc=0.1595 | tpr=0.7888 | fpr=0.8520 | 8171.0 samples/s | 31.9 steps/s
[Step= 450] | Loss=5.41104 | acc=0.1592 | tpr=0.7907 | fpr=0.8522 | 8708.0 samples/s | 34.0 steps/s
[Step= 500] | Loss=5.41082 | acc=0.1592 | tpr=0.7899 | fpr=0.8522 | 8303.1 samples/s | 32.4 steps/s
[Step= 550] | Loss=5.41128 | acc=0.1594 | tpr=0.7919 | fpr=0.8521 | 9293.1 samples/s | 36.3 steps/s
Avg test loss: 5.41131, Avg test acc: 0.15926, Avg tpr: 0.79160, Avg fpr: 0.85223, total FA: 118331

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.15785 | acc=0.1488 | tpr=0.8142 | fpr=0.8631 | 4516.0 samples/s | 17.6 steps/s
[Step= 100] | Loss=4.16745 | acc=0.1495 | tpr=0.8273 | fpr=0.8631 | 8030.2 samples/s | 31.4 steps/s
[Step= 150] | Loss=4.17109 | acc=0.1505 | tpr=0.8444 | fpr=0.8623 | 8399.4 samples/s | 32.8 steps/s
[Step= 200] | Loss=4.16197 | acc=0.1510 | tpr=0.8514 | fpr=0.8618 | 7727.9 samples/s | 30.2 steps/s
[Step= 250] | Loss=4.16852 | acc=0.1514 | tpr=0.8454 | fpr=0.8613 | 8520.0 samples/s | 33.3 steps/s
[Step= 300] | Loss=4.16977 | acc=0.1516 | tpr=0.8415 | fpr=0.8610 | 7148.2 samples/s | 27.9 steps/s
[Step= 350] | Loss=4.17332 | acc=0.1515 | tpr=0.8403 | fpr=0.8610 | 8251.6 samples/s | 32.2 steps/s
[Step= 400] | Loss=4.17405 | acc=0.1513 | tpr=0.8425 | fpr=0.8612 | 8340.6 samples/s | 32.6 steps/s
[Step= 450] | Loss=4.17480 | acc=0.1509 | tpr=0.8408 | fpr=0.8616 | 8201.5 samples/s | 32.0 steps/s
[Step= 500] | Loss=4.17432 | acc=0.1512 | tpr=0.8410 | fpr=0.8612 | 8062.7 samples/s | 31.5 steps/s
[Step= 550] | Loss=4.17389 | acc=0.1513 | tpr=0.8464 | fpr=0.8614 | 9444.8 samples/s | 36.9 steps/s
Avg test loss: 4.17527, Avg test acc: 0.15118, Avg tpr: 0.84667, Avg fpr: 0.86146, total FA: 119612

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.00332 | acc=0.1375 | tpr=0.8496 | fpr=0.8753 | 4467.6 samples/s | 17.5 steps/s
[Step= 100] | Loss=4.98696 | acc=0.1412 | tpr=0.8571 | fpr=0.8721 | 8202.3 samples/s | 32.0 steps/s
[Step= 150] | Loss=4.98563 | acc=0.1424 | tpr=0.8444 | fpr=0.8705 | 8236.8 samples/s | 32.2 steps/s
[Step= 200] | Loss=4.97103 | acc=0.1424 | tpr=0.8481 | fpr=0.8704 | 8161.1 samples/s | 31.9 steps/s
[Step= 250] | Loss=4.97581 | acc=0.1431 | tpr=0.8454 | fpr=0.8697 | 7932.4 samples/s | 31.0 steps/s
[Step= 300] | Loss=4.97708 | acc=0.1432 | tpr=0.8531 | fpr=0.8697 | 8113.0 samples/s | 31.7 steps/s
[Step= 350] | Loss=4.97685 | acc=0.1432 | tpr=0.8547 | fpr=0.8697 | 7925.0 samples/s | 31.0 steps/s
[Step= 400] | Loss=4.97787 | acc=0.1433 | tpr=0.8567 | fpr=0.8697 | 7815.3 samples/s | 30.5 steps/s
[Step= 450] | Loss=4.98027 | acc=0.1428 | tpr=0.8559 | fpr=0.8701 | 7948.5 samples/s | 31.0 steps/s
[Step= 500] | Loss=4.98009 | acc=0.1430 | tpr=0.8529 | fpr=0.8698 | 8175.4 samples/s | 31.9 steps/s
[Step= 550] | Loss=4.97635 | acc=0.1434 | tpr=0.8532 | fpr=0.8695 | 10071.0 samples/s | 39.3 steps/s
Avg test loss: 4.97751, Avg test acc: 0.14332, Avg tpr: 0.85341, Avg fpr: 0.86959, total FA: 120741

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.61413 | acc=0.1196 | tpr=0.9292 | fpr=0.8949 | 4786.4 samples/s | 18.7 steps/s
[Step= 100] | Loss=5.60495 | acc=0.1199 | tpr=0.9403 | fpr=0.8954 | 7663.2 samples/s | 29.9 steps/s
[Step= 150] | Loss=5.61780 | acc=0.1204 | tpr=0.9424 | fpr=0.8948 | 8039.2 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.60833 | acc=0.1203 | tpr=0.9410 | fpr=0.8946 | 8098.4 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.61189 | acc=0.1212 | tpr=0.9397 | fpr=0.8938 | 7569.2 samples/s | 29.6 steps/s
[Step= 300] | Loss=5.60522 | acc=0.1216 | tpr=0.9396 | fpr=0.8933 | 8116.1 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.61665 | acc=0.1214 | tpr=0.9349 | fpr=0.8934 | 7724.4 samples/s | 30.2 steps/s
[Step= 400] | Loss=5.62192 | acc=0.1210 | tpr=0.9360 | fpr=0.8939 | 8250.6 samples/s | 32.2 steps/s
[Step= 450] | Loss=5.62356 | acc=0.1207 | tpr=0.9372 | fpr=0.8941 | 7767.8 samples/s | 30.3 steps/s
[Step= 500] | Loss=5.62819 | acc=0.1207 | tpr=0.9348 | fpr=0.8940 | 8182.7 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.62815 | acc=0.1208 | tpr=0.9355 | fpr=0.8940 | 10131.1 samples/s | 39.6 steps/s
Avg test loss: 5.62940, Avg test acc: 0.12069, Avg tpr: 0.93542, Avg fpr: 0.89412, total FA: 124147

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.29061 | acc=0.1190 | tpr=0.8451 | fpr=0.8941 | 4760.6 samples/s | 18.6 steps/s
[Step= 100] | Loss=5.28413 | acc=0.1181 | tpr=0.8593 | fpr=0.8957 | 7309.1 samples/s | 28.6 steps/s
[Step= 150] | Loss=5.28027 | acc=0.1189 | tpr=0.8674 | fpr=0.8948 | 8926.4 samples/s | 34.9 steps/s
[Step= 200] | Loss=5.27034 | acc=0.1200 | tpr=0.8634 | fpr=0.8935 | 7979.0 samples/s | 31.2 steps/s
[Step= 250] | Loss=5.27005 | acc=0.1214 | tpr=0.8559 | fpr=0.8920 | 7680.4 samples/s | 30.0 steps/s
[Step= 300] | Loss=5.26995 | acc=0.1214 | tpr=0.8524 | fpr=0.8919 | 7844.5 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.27303 | acc=0.1212 | tpr=0.8535 | fpr=0.8921 | 8177.8 samples/s | 31.9 steps/s
[Step= 400] | Loss=5.27466 | acc=0.1210 | tpr=0.8528 | fpr=0.8923 | 8034.0 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.27909 | acc=0.1207 | tpr=0.8544 | fpr=0.8927 | 7679.9 samples/s | 30.0 steps/s
[Step= 500] | Loss=5.28194 | acc=0.1204 | tpr=0.8515 | fpr=0.8928 | 8109.4 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.28064 | acc=0.1205 | tpr=0.8536 | fpr=0.8928 | 10071.0 samples/s | 39.3 steps/s
Avg test loss: 5.28182, Avg test acc: 0.12046, Avg tpr: 0.85380, Avg fpr: 0.89287, total FA: 123973

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.18243 | acc=0.9515 | tpr=0.8982 | fpr=0.0476 | 4502.5 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.18349 | acc=0.9514 | tpr=0.9190 | fpr=0.0479 | 7897.2 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.18414 | acc=0.9509 | tpr=0.9222 | fpr=0.0486 | 8194.8 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.18410 | acc=0.9511 | tpr=0.9213 | fpr=0.0484 | 8216.6 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.18434 | acc=0.9508 | tpr=0.9205 | fpr=0.0486 | 7783.8 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.18660 | acc=0.9503 | tpr=0.9200 | fpr=0.0491 | 8123.1 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.18612 | acc=0.9505 | tpr=0.9205 | fpr=0.0489 | 7726.2 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.18769 | acc=0.9503 | tpr=0.9174 | fpr=0.0491 | 7983.9 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.18901 | acc=0.9499 | tpr=0.9163 | fpr=0.0495 | 7211.1 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.18928 | acc=0.9499 | tpr=0.9189 | fpr=0.0496 | 8207.3 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.18897 | acc=0.9500 | tpr=0.9156 | fpr=0.0494 | 11678.8 samples/s | 45.6 steps/s
Avg test loss: 0.18870, Avg test acc: 0.95006, Avg tpr: 0.91601, Avg fpr: 0.04932, total FA: 6848

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12198 | acc=0.9623 | tpr=0.9027 | fpr=0.0366 | 4674.7 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.12261 | acc=0.9623 | tpr=0.9062 | fpr=0.0366 | 7831.9 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.12595 | acc=0.9610 | tpr=0.9092 | fpr=0.0380 | 8170.7 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.12581 | acc=0.9613 | tpr=0.9126 | fpr=0.0378 | 7315.1 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.12718 | acc=0.9610 | tpr=0.9074 | fpr=0.0380 | 8083.2 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.12810 | acc=0.9607 | tpr=0.9084 | fpr=0.0383 | 8294.1 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.12892 | acc=0.9609 | tpr=0.9130 | fpr=0.0383 | 8094.2 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.12916 | acc=0.9606 | tpr=0.9048 | fpr=0.0384 | 7790.0 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.13076 | acc=0.9602 | tpr=0.9036 | fpr=0.0387 | 7776.7 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.13069 | acc=0.9603 | tpr=0.9057 | fpr=0.0388 | 8408.5 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.13084 | acc=0.9603 | tpr=0.9017 | fpr=0.0386 | 10558.8 samples/s | 41.2 steps/s
Avg test loss: 0.13064, Avg test acc: 0.96029, Avg tpr: 0.90135, Avg fpr: 0.03864, total FA: 5365

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.25680 | acc=0.9483 | tpr=0.9027 | fpr=0.0509 | 4628.1 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.26125 | acc=0.9477 | tpr=0.9211 | fpr=0.0518 | 8428.2 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.27037 | acc=0.9462 | tpr=0.9265 | fpr=0.0534 | 7921.8 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.27179 | acc=0.9464 | tpr=0.9322 | fpr=0.0534 | 8532.2 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.27287 | acc=0.9461 | tpr=0.9258 | fpr=0.0535 | 7630.2 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.27481 | acc=0.9458 | tpr=0.9229 | fpr=0.0538 | 8107.6 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.27397 | acc=0.9458 | tpr=0.9224 | fpr=0.0537 | 7853.4 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.27500 | acc=0.9457 | tpr=0.9201 | fpr=0.0539 | 7759.8 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.27646 | acc=0.9453 | tpr=0.9177 | fpr=0.0542 | 7682.9 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.27637 | acc=0.9452 | tpr=0.9185 | fpr=0.0543 | 8239.4 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.27538 | acc=0.9455 | tpr=0.9188 | fpr=0.0540 | 10000.6 samples/s | 39.1 steps/s
Avg test loss: 0.27520, Avg test acc: 0.94553, Avg tpr: 0.91918, Avg fpr: 0.05399, total FA: 7496

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10480 | acc=0.9698 | tpr=0.8938 | fpr=0.0288 | 4698.7 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.10923 | acc=0.9687 | tpr=0.8913 | fpr=0.0299 | 8296.5 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.11452 | acc=0.9674 | tpr=0.8890 | fpr=0.0312 | 8230.0 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.11619 | acc=0.9672 | tpr=0.8973 | fpr=0.0315 | 7627.6 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.11765 | acc=0.9670 | tpr=0.8891 | fpr=0.0316 | 7573.6 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.11841 | acc=0.9669 | tpr=0.8924 | fpr=0.0317 | 8196.7 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.11930 | acc=0.9668 | tpr=0.8973 | fpr=0.0319 | 8303.3 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.11999 | acc=0.9666 | tpr=0.8944 | fpr=0.0321 | 7520.1 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.12072 | acc=0.9666 | tpr=0.8929 | fpr=0.0321 | 8028.7 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.12009 | acc=0.9666 | tpr=0.8952 | fpr=0.0321 | 8610.4 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.11949 | acc=0.9666 | tpr=0.8949 | fpr=0.0321 | 9201.7 samples/s | 35.9 steps/s
Avg test loss: 0.11935, Avg test acc: 0.96665, Avg tpr: 0.89501, Avg fpr: 0.03205, total FA: 4450

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.25496 | acc=0.9522 | tpr=0.8761 | fpr=0.0464 | 4472.1 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.26142 | acc=0.9511 | tpr=0.8998 | fpr=0.0479 | 8273.5 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.26451 | acc=0.9501 | tpr=0.9107 | fpr=0.0491 | 8011.1 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.26572 | acc=0.9504 | tpr=0.9158 | fpr=0.0490 | 7921.7 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.26818 | acc=0.9501 | tpr=0.9144 | fpr=0.0492 | 7901.1 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.27075 | acc=0.9497 | tpr=0.9113 | fpr=0.0496 | 7735.9 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.27032 | acc=0.9497 | tpr=0.9073 | fpr=0.0495 | 8268.2 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.27092 | acc=0.9495 | tpr=0.9021 | fpr=0.0497 | 7675.8 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.27309 | acc=0.9491 | tpr=0.9002 | fpr=0.0500 | 7443.4 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.27505 | acc=0.9489 | tpr=0.8991 | fpr=0.0502 | 8465.7 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.27419 | acc=0.9490 | tpr=0.8981 | fpr=0.0501 | 10651.0 samples/s | 41.6 steps/s
Avg test loss: 0.27390, Avg test acc: 0.94905, Avg tpr: 0.89818, Avg fpr: 0.05003, total FA: 6946

server round 5/50

clients selected: [3 5 7 8 9]

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=29.3] | Loss=0.15779 | Reg=0.00199 | acc=0.9219 | L2-Norm=14.115 | L2-Norm(final)=7.202 | 3181.4 samples/s | 49.7 steps/s
[Step=6050 Epoch=29.5] | Loss=0.19138 | Reg=0.00199 | acc=0.9219 | L2-Norm=14.124 | L2-Norm(final)=7.064 | 4749.2 samples/s | 74.2 steps/s
[Step=6100 Epoch=29.7] | Loss=0.16815 | Reg=0.00200 | acc=0.8594 | L2-Norm=14.126 | L2-Norm(final)=7.042 | 5400.3 samples/s | 84.4 steps/s
[Step=6150 Epoch=30.0] | Loss=0.15592 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.127 | L2-Norm(final)=7.104 | 5404.1 samples/s | 84.4 steps/s
[Step=6200 Epoch=30.2] | Loss=0.15193 | Reg=0.00200 | acc=0.8438 | L2-Norm=14.127 | L2-Norm(final)=7.191 | 8485.0 samples/s | 132.6 steps/s
[Step=6250 Epoch=30.5] | Loss=0.14714 | Reg=0.00200 | acc=0.8750 | L2-Norm=14.127 | L2-Norm(final)=7.282 | 1448.0 samples/s | 22.6 steps/s
[Step=6300 Epoch=30.7] | Loss=0.14512 | Reg=0.00200 | acc=0.9062 | L2-Norm=14.127 | L2-Norm(final)=7.372 | 5339.0 samples/s | 83.4 steps/s
[Step=6350 Epoch=31.0] | Loss=0.14248 | Reg=0.00200 | acc=0.8906 | L2-Norm=14.128 | L2-Norm(final)=7.459 | 5396.3 samples/s | 84.3 steps/s
[Step=6400 Epoch=31.2] | Loss=0.14075 | Reg=0.00200 | acc=0.9062 | L2-Norm=14.128 | L2-Norm(final)=7.546 | 7422.8 samples/s | 116.0 steps/s
[Step=6450 Epoch=31.5] | Loss=0.13923 | Reg=0.00200 | acc=0.8750 | L2-Norm=14.128 | L2-Norm(final)=7.631 | 1498.3 samples/s | 23.4 steps/s
[Step=6500 Epoch=31.7] | Loss=0.13811 | Reg=0.00200 | acc=0.9062 | L2-Norm=14.128 | L2-Norm(final)=7.714 | 5416.1 samples/s | 84.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=31.7] | Loss=0.15127 | Reg=0.00200 | acc=0.8281 | L2-Norm=14.128 | L2-Norm(final)=8.533 | 3205.5 samples/s | 50.1 steps/s
[Step=6550 Epoch=31.9] | Loss=0.10847 | Reg=0.00206 | acc=0.9062 | L2-Norm=14.349 | L2-Norm(final)=8.549 | 4083.1 samples/s | 63.8 steps/s
[Step=6600 Epoch=32.2] | Loss=0.09899 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.527 | L2-Norm(final)=8.534 | 4651.7 samples/s | 72.7 steps/s
[Step=6650 Epoch=32.4] | Loss=0.09494 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.644 | L2-Norm(final)=8.522 | 4639.8 samples/s | 72.5 steps/s
[Step=6700 Epoch=32.7] | Loss=0.08881 | Reg=0.00217 | acc=0.9375 | L2-Norm=14.737 | L2-Norm(final)=8.516 | 6657.4 samples/s | 104.0 steps/s
[Step=6750 Epoch=32.9] | Loss=0.08028 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.819 | L2-Norm(final)=8.513 | 1374.8 samples/s | 21.5 steps/s
[Step=6800 Epoch=33.2] | Loss=0.07511 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.890 | L2-Norm(final)=8.513 | 4619.2 samples/s | 72.2 steps/s
[Step=6850 Epoch=33.4] | Loss=0.07121 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.955 | L2-Norm(final)=8.512 | 4645.7 samples/s | 72.6 steps/s
[Step=6900 Epoch=33.6] | Loss=0.06808 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.013 | L2-Norm(final)=8.510 | 6030.3 samples/s | 94.2 steps/s
[Step=6950 Epoch=33.9] | Loss=0.06398 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.065 | L2-Norm(final)=8.511 | 1413.6 samples/s | 22.1 steps/s
[Step=7000 Epoch=34.1] | Loss=0.06091 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.110 | L2-Norm(final)=8.511 | 4665.3 samples/s | 72.9 steps/s
[Step=7050 Epoch=34.4] | Loss=0.05775 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.151 | L2-Norm(final)=8.513 | 4566.7 samples/s | 71.4 steps/s
[Step=7100 Epoch=34.6] | Loss=0.05544 | Reg=0.00231 | acc=0.9688 | L2-Norm=15.188 | L2-Norm(final)=8.514 | 5532.8 samples/s | 86.5 steps/s
[Step=7150 Epoch=34.9] | Loss=0.05335 | Reg=0.00232 | acc=0.9375 | L2-Norm=15.224 | L2-Norm(final)=8.515 | 1464.3 samples/s | 22.9 steps/s
[Step=7200 Epoch=35.1] | Loss=0.05172 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.257 | L2-Norm(final)=8.515 | 4635.7 samples/s | 72.4 steps/s
[Step=7250 Epoch=35.4] | Loss=0.05011 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.290 | L2-Norm(final)=8.516 | 4592.8 samples/s | 71.8 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04844 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.321 | L2-Norm(final)=8.516 | 5142.3 samples/s | 80.3 steps/s
[Step=7350 Epoch=35.8] | Loss=0.04674 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.352 | L2-Norm(final)=8.517 | 1475.6 samples/s | 23.1 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04509 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.381 | L2-Norm(final)=8.519 | 4592.0 samples/s | 71.8 steps/s
[Step=7450 Epoch=36.3] | Loss=0.04368 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.408 | L2-Norm(final)=8.520 | 4714.6 samples/s | 73.7 steps/s
[Step=7500 Epoch=36.6] | Loss=0.04310 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.435 | L2-Norm(final)=8.521 | 4708.8 samples/s | 73.6 steps/s
[Step=7550 Epoch=36.8] | Loss=0.04302 | Reg=0.00239 | acc=0.9531 | L2-Norm=15.465 | L2-Norm(final)=8.520 | 1510.4 samples/s | 23.6 steps/s
[Step=7600 Epoch=37.1] | Loss=0.04233 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.497 | L2-Norm(final)=8.520 | 4631.9 samples/s | 72.4 steps/s
[Step=7650 Epoch=37.3] | Loss=0.04149 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.529 | L2-Norm(final)=8.519 | 4625.4 samples/s | 72.3 steps/s
[Step=7700 Epoch=37.5] | Loss=0.04091 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.560 | L2-Norm(final)=8.518 | 4652.3 samples/s | 72.7 steps/s
[Step=7750 Epoch=37.8] | Loss=0.04006 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.591 | L2-Norm(final)=8.518 | 1553.9 samples/s | 24.3 steps/s
[Step=7800 Epoch=38.0] | Loss=0.03913 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.620 | L2-Norm(final)=8.517 | 4600.8 samples/s | 71.9 steps/s
[Step=7850 Epoch=38.3] | Loss=0.03817 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.647 | L2-Norm(final)=8.518 | 4639.9 samples/s | 72.5 steps/s
[Step=7900 Epoch=38.5] | Loss=0.03737 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.673 | L2-Norm(final)=8.518 | 4692.9 samples/s | 73.3 steps/s
[Step=7950 Epoch=38.8] | Loss=0.03671 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.699 | L2-Norm(final)=8.518 | 1527.5 samples/s | 23.9 steps/s
[Step=8000 Epoch=39.0] | Loss=0.03590 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.723 | L2-Norm(final)=8.519 | 4596.0 samples/s | 71.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step8000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=56.9] | Loss=0.04205 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.115 | L2-Norm(final)=9.144 | 3127.1 samples/s | 48.9 steps/s
[Step=6050 Epoch=57.3] | Loss=0.04715 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.105 | L2-Norm(final)=9.026 | 4305.5 samples/s | 67.3 steps/s
[Step=6100 Epoch=57.8] | Loss=0.04018 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.104 | L2-Norm(final)=8.972 | 8140.5 samples/s | 127.2 steps/s
[Step=6150 Epoch=58.3] | Loss=0.03707 | Reg=0.00199 | acc=0.9375 | L2-Norm=14.104 | L2-Norm(final)=8.971 | 1431.7 samples/s | 22.4 steps/s
[Step=6200 Epoch=58.8] | Loss=0.03570 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.103 | L2-Norm(final)=8.995 | 7041.6 samples/s | 110.0 steps/s
[Step=6250 Epoch=59.2] | Loss=0.03518 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.103 | L2-Norm(final)=9.032 | 1477.6 samples/s | 23.1 steps/s
[Step=6300 Epoch=59.7] | Loss=0.03400 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.103 | L2-Norm(final)=9.077 | 6234.3 samples/s | 97.4 steps/s
[Step=6350 Epoch=60.2] | Loss=0.03348 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.103 | L2-Norm(final)=9.129 | 1482.2 samples/s | 23.2 steps/s
[Step=6400 Epoch=60.6] | Loss=0.03273 | Reg=0.00199 | acc=0.9375 | L2-Norm=14.103 | L2-Norm(final)=9.182 | 5806.0 samples/s | 90.7 steps/s
[Step=6450 Epoch=61.1] | Loss=0.03234 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.103 | L2-Norm(final)=9.238 | 1513.5 samples/s | 23.6 steps/s
[Step=6500 Epoch=61.6] | Loss=0.03214 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.103 | L2-Norm(final)=9.292 | 5221.7 samples/s | 81.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=61.6] | Loss=0.02784 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.103 | L2-Norm(final)=9.821 | 3159.2 samples/s | 49.4 steps/s
[Step=6550 Epoch=62.1] | Loss=0.03812 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.488 | L2-Norm(final)=9.806 | 3920.6 samples/s | 61.3 steps/s
[Step=6600 Epoch=62.5] | Loss=0.02506 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.785 | L2-Norm(final)=9.779 | 6446.3 samples/s | 100.7 steps/s
[Step=6650 Epoch=63.0] | Loss=0.01801 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.889 | L2-Norm(final)=9.774 | 1351.4 samples/s | 21.1 steps/s
[Step=6700 Epoch=63.5] | Loss=0.01418 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.940 | L2-Norm(final)=9.772 | 5905.8 samples/s | 92.3 steps/s
[Step=6750 Epoch=64.0] | Loss=0.01142 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.961 | L2-Norm(final)=9.773 | 1435.5 samples/s | 22.4 steps/s
[Step=6800 Epoch=64.4] | Loss=0.00954 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.961 | L2-Norm(final)=9.775 | 5275.4 samples/s | 82.4 steps/s
[Step=6850 Epoch=64.9] | Loss=0.00818 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.949 | L2-Norm(final)=9.777 | 1431.3 samples/s | 22.4 steps/s
[Step=6900 Epoch=65.4] | Loss=0.00716 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.929 | L2-Norm(final)=9.778 | 4848.7 samples/s | 75.8 steps/s
[Step=6950 Epoch=65.9] | Loss=0.00637 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.903 | L2-Norm(final)=9.780 | 1456.8 samples/s | 22.8 steps/s
[Step=7000 Epoch=66.3] | Loss=0.00573 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.875 | L2-Norm(final)=9.781 | 4522.7 samples/s | 70.7 steps/s
[Step=7050 Epoch=66.8] | Loss=0.00521 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.844 | L2-Norm(final)=9.782 | 1469.2 samples/s | 23.0 steps/s
[Step=7100 Epoch=67.3] | Loss=0.00478 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.812 | L2-Norm(final)=9.783 | 4467.9 samples/s | 69.8 steps/s
[Step=7150 Epoch=67.8] | Loss=0.00441 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.778 | L2-Norm(final)=9.784 | 1477.8 samples/s | 23.1 steps/s
[Step=7200 Epoch=68.2] | Loss=0.00410 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.744 | L2-Norm(final)=9.785 | 4433.2 samples/s | 69.3 steps/s
[Step=7250 Epoch=68.7] | Loss=0.00383 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.709 | L2-Norm(final)=9.786 | 1497.1 samples/s | 23.4 steps/s
[Step=7300 Epoch=69.2] | Loss=0.00359 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.674 | L2-Norm(final)=9.786 | 4302.8 samples/s | 67.2 steps/s
[Step=7350 Epoch=69.6] | Loss=0.00338 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.639 | L2-Norm(final)=9.787 | 1527.3 samples/s | 23.9 steps/s
[Step=7400 Epoch=70.1] | Loss=0.00319 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.603 | L2-Norm(final)=9.788 | 4291.6 samples/s | 67.1 steps/s
[Step=7450 Epoch=70.6] | Loss=0.00302 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.568 | L2-Norm(final)=9.788 | 6623.0 samples/s | 103.5 steps/s
[Step=7500 Epoch=71.1] | Loss=0.00287 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.532 | L2-Norm(final)=9.790 | 1351.2 samples/s | 21.1 steps/s
[Step=7550 Epoch=71.5] | Loss=0.00274 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.496 | L2-Norm(final)=9.791 | 5908.5 samples/s | 92.3 steps/s
[Step=7600 Epoch=72.0] | Loss=0.00261 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.461 | L2-Norm(final)=9.792 | 1410.6 samples/s | 22.0 steps/s
[Step=7650 Epoch=72.5] | Loss=0.00250 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.425 | L2-Norm(final)=9.794 | 5506.1 samples/s | 86.0 steps/s
[Step=7700 Epoch=73.0] | Loss=0.00239 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.390 | L2-Norm(final)=9.797 | 1398.8 samples/s | 21.9 steps/s
[Step=7750 Epoch=73.4] | Loss=0.00230 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.354 | L2-Norm(final)=9.799 | 5014.2 samples/s | 78.3 steps/s
[Step=7800 Epoch=73.9] | Loss=0.00221 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.319 | L2-Norm(final)=9.802 | 1423.2 samples/s | 22.2 steps/s
[Step=7850 Epoch=74.4] | Loss=0.00213 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.283 | L2-Norm(final)=9.805 | 4657.0 samples/s | 72.8 steps/s
[Step=7900 Epoch=74.9] | Loss=0.00205 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.248 | L2-Norm(final)=9.808 | 1470.1 samples/s | 23.0 steps/s
[Step=7950 Epoch=75.3] | Loss=0.00198 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.213 | L2-Norm(final)=9.811 | 4414.5 samples/s | 69.0 steps/s
[Step=8000 Epoch=75.8] | Loss=0.00192 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.178 | L2-Norm(final)=9.815 | 1508.1 samples/s | 23.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step8000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=76.4] | Loss=0.13262 | Reg=0.00199 | acc=0.8750 | L2-Norm=14.115 | L2-Norm(final)=10.258 | 3081.6 samples/s | 48.2 steps/s
[Step=8050 Epoch=76.9] | Loss=0.05220 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.104 | L2-Norm(final)=10.165 | 4713.4 samples/s | 73.6 steps/s
[Step=8100 Epoch=77.4] | Loss=0.03908 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.102 | L2-Norm(final)=10.141 | 7816.5 samples/s | 122.1 steps/s
[Step=8150 Epoch=77.8] | Loss=0.03283 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.102 | L2-Norm(final)=10.161 | 1442.5 samples/s | 22.5 steps/s
[Step=8200 Epoch=78.3] | Loss=0.03064 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.102 | L2-Norm(final)=10.208 | 7187.0 samples/s | 112.3 steps/s
[Step=8250 Epoch=78.8] | Loss=0.02863 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.102 | L2-Norm(final)=10.264 | 1430.1 samples/s | 22.3 steps/s
[Step=8300 Epoch=79.3] | Loss=0.02781 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.101 | L2-Norm(final)=10.327 | 6692.8 samples/s | 104.6 steps/s
[Step=8350 Epoch=79.7] | Loss=0.02677 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.101 | L2-Norm(final)=10.390 | 1474.2 samples/s | 23.0 steps/s
[Step=8400 Epoch=80.2] | Loss=0.02574 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.101 | L2-Norm(final)=10.454 | 6053.2 samples/s | 94.6 steps/s
[Step=8450 Epoch=80.7] | Loss=0.02518 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.101 | L2-Norm(final)=10.518 | 1484.5 samples/s | 23.2 steps/s
[Step=8500 Epoch=81.2] | Loss=0.02467 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.101 | L2-Norm(final)=10.582 | 5708.5 samples/s | 89.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=81.2] | Loss=0.01330 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.101 | L2-Norm(final)=11.224 | 3128.0 samples/s | 48.9 steps/s
[Step=8550 Epoch=81.6] | Loss=0.03107 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.539 | L2-Norm(final)=11.220 | 3946.4 samples/s | 61.7 steps/s
[Step=8600 Epoch=82.1] | Loss=0.02306 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.859 | L2-Norm(final)=11.172 | 6434.7 samples/s | 100.5 steps/s
[Step=8650 Epoch=82.6] | Loss=0.01750 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.988 | L2-Norm(final)=11.143 | 1340.9 samples/s | 21.0 steps/s
[Step=8700 Epoch=83.1] | Loss=0.01323 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.040 | L2-Norm(final)=11.129 | 5948.5 samples/s | 92.9 steps/s
[Step=8750 Epoch=83.6] | Loss=0.01060 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.051 | L2-Norm(final)=11.122 | 1397.1 samples/s | 21.8 steps/s
[Step=8800 Epoch=84.0] | Loss=0.00884 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.041 | L2-Norm(final)=11.118 | 5456.8 samples/s | 85.3 steps/s
[Step=8850 Epoch=84.5] | Loss=0.00758 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.020 | L2-Norm(final)=11.115 | 1402.9 samples/s | 21.9 steps/s
[Step=8900 Epoch=85.0] | Loss=0.00663 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.991 | L2-Norm(final)=11.113 | 5184.5 samples/s | 81.0 steps/s
[Step=8950 Epoch=85.5] | Loss=0.00590 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.958 | L2-Norm(final)=11.111 | 1406.7 samples/s | 22.0 steps/s
[Step=9000 Epoch=85.9] | Loss=0.00531 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.923 | L2-Norm(final)=11.110 | 4811.6 samples/s | 75.2 steps/s
[Step=9050 Epoch=86.4] | Loss=0.00483 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.886 | L2-Norm(final)=11.109 | 1477.7 samples/s | 23.1 steps/s
[Step=9100 Epoch=86.9] | Loss=0.00443 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.848 | L2-Norm(final)=11.108 | 4494.0 samples/s | 70.2 steps/s
[Step=9150 Epoch=87.4] | Loss=0.00409 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.809 | L2-Norm(final)=11.108 | 1507.4 samples/s | 23.6 steps/s
[Step=9200 Epoch=87.9] | Loss=0.00379 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.770 | L2-Norm(final)=11.107 | 4357.7 samples/s | 68.1 steps/s
[Step=9250 Epoch=88.3] | Loss=0.00354 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.730 | L2-Norm(final)=11.107 | 1490.8 samples/s | 23.3 steps/s
[Step=9300 Epoch=88.8] | Loss=0.00332 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.691 | L2-Norm(final)=11.107 | 4342.9 samples/s | 67.9 steps/s
[Step=9350 Epoch=89.3] | Loss=0.00313 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.652 | L2-Norm(final)=11.107 | 1484.0 samples/s | 23.2 steps/s
[Step=9400 Epoch=89.8] | Loss=0.00295 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.612 | L2-Norm(final)=11.107 | 4374.3 samples/s | 68.3 steps/s
[Step=9450 Epoch=90.2] | Loss=0.00280 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.573 | L2-Norm(final)=11.106 | 1489.8 samples/s | 23.3 steps/s
[Step=9500 Epoch=90.7] | Loss=0.00266 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.534 | L2-Norm(final)=11.106 | 4373.9 samples/s | 68.3 steps/s
[Step=9550 Epoch=91.2] | Loss=0.00253 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.495 | L2-Norm(final)=11.106 | 7070.3 samples/s | 110.5 steps/s
[Step=9600 Epoch=91.7] | Loss=0.00242 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.456 | L2-Norm(final)=11.106 | 1319.0 samples/s | 20.6 steps/s
[Step=9650 Epoch=92.2] | Loss=0.00231 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.418 | L2-Norm(final)=11.106 | 6519.6 samples/s | 101.9 steps/s
[Step=9700 Epoch=92.6] | Loss=0.00221 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.379 | L2-Norm(final)=11.106 | 1355.6 samples/s | 21.2 steps/s
[Step=9750 Epoch=93.1] | Loss=0.00213 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.341 | L2-Norm(final)=11.106 | 6105.6 samples/s | 95.4 steps/s
[Step=9800 Epoch=93.6] | Loss=0.00204 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.303 | L2-Norm(final)=11.106 | 1379.5 samples/s | 21.6 steps/s
[Step=9850 Epoch=94.1] | Loss=0.00197 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.266 | L2-Norm(final)=11.106 | 5551.6 samples/s | 86.7 steps/s
[Step=9900 Epoch=94.5] | Loss=0.00190 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.228 | L2-Norm(final)=11.107 | 1429.5 samples/s | 22.3 steps/s
[Step=9950 Epoch=95.0] | Loss=0.00183 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.191 | L2-Norm(final)=11.107 | 5167.7 samples/s | 80.7 steps/s
[Step=10000 Epoch=95.5] | Loss=0.00177 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.154 | L2-Norm(final)=11.107 | 1410.7 samples/s | 22.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step10000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=37.7] | Loss=0.05583 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.115 | L2-Norm(final)=7.834 | 3300.9 samples/s | 51.6 steps/s
[Step=4050 Epoch=38.2] | Loss=0.04509 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.104 | L2-Norm(final)=7.800 | 4302.2 samples/s | 67.2 steps/s
[Step=4100 Epoch=38.6] | Loss=0.04154 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.103 | L2-Norm(final)=7.797 | 8019.0 samples/s | 125.3 steps/s
[Step=4150 Epoch=39.1] | Loss=0.04035 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.103 | L2-Norm(final)=7.831 | 1457.5 samples/s | 22.8 steps/s
[Step=4200 Epoch=39.6] | Loss=0.03900 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.103 | L2-Norm(final)=7.880 | 6777.2 samples/s | 105.9 steps/s
[Step=4250 Epoch=40.0] | Loss=0.03834 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.102 | L2-Norm(final)=7.934 | 1501.5 samples/s | 23.5 steps/s
[Step=4300 Epoch=40.5] | Loss=0.03791 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.102 | L2-Norm(final)=7.991 | 6261.9 samples/s | 97.8 steps/s
[Step=4350 Epoch=41.0] | Loss=0.03686 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.102 | L2-Norm(final)=8.050 | 1528.8 samples/s | 23.9 steps/s
[Step=4400 Epoch=41.5] | Loss=0.03639 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.102 | L2-Norm(final)=8.111 | 5558.4 samples/s | 86.8 steps/s
[Step=4450 Epoch=41.9] | Loss=0.03616 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.102 | L2-Norm(final)=8.172 | 1623.5 samples/s | 25.4 steps/s
[Step=4500 Epoch=42.4] | Loss=0.03608 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.102 | L2-Norm(final)=8.233 | 5120.7 samples/s | 80.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.4] | Loss=0.06529 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.102 | L2-Norm(final)=8.825 | 3292.3 samples/s | 51.4 steps/s
[Step=4550 Epoch=42.9] | Loss=0.03458 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.519 | L2-Norm(final)=8.814 | 3823.6 samples/s | 59.7 steps/s
[Step=4600 Epoch=43.3] | Loss=0.02207 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.846 | L2-Norm(final)=8.788 | 6443.8 samples/s | 100.7 steps/s
[Step=4650 Epoch=43.8] | Loss=0.01624 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.001 | L2-Norm(final)=8.773 | 1370.2 samples/s | 21.4 steps/s
[Step=4700 Epoch=44.3] | Loss=0.01414 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.092 | L2-Norm(final)=8.763 | 5767.0 samples/s | 90.1 steps/s
[Step=4750 Epoch=44.8] | Loss=0.01246 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.150 | L2-Norm(final)=8.752 | 1196.9 samples/s | 18.7 steps/s
[Step=4800 Epoch=45.2] | Loss=0.01045 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.178 | L2-Norm(final)=8.745 | 5113.4 samples/s | 79.9 steps/s
[Step=4850 Epoch=45.7] | Loss=0.00916 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.188 | L2-Norm(final)=8.742 | 1450.4 samples/s | 22.7 steps/s
[Step=4900 Epoch=46.2] | Loss=0.00803 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.187 | L2-Norm(final)=8.739 | 4742.8 samples/s | 74.1 steps/s
[Step=4950 Epoch=46.6] | Loss=0.00716 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.179 | L2-Norm(final)=8.738 | 1501.9 samples/s | 23.5 steps/s
[Step=5000 Epoch=47.1] | Loss=0.00644 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.164 | L2-Norm(final)=8.737 | 4395.6 samples/s | 68.7 steps/s
[Step=5050 Epoch=47.6] | Loss=0.00586 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.145 | L2-Norm(final)=8.736 | 1504.0 samples/s | 23.5 steps/s
[Step=5100 Epoch=48.1] | Loss=0.00537 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.122 | L2-Norm(final)=8.735 | 4482.4 samples/s | 70.0 steps/s
[Step=5150 Epoch=48.5] | Loss=0.00496 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.097 | L2-Norm(final)=8.735 | 1526.9 samples/s | 23.9 steps/s
[Step=5200 Epoch=49.0] | Loss=0.00460 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.070 | L2-Norm(final)=8.734 | 4510.8 samples/s | 70.5 steps/s
[Step=5250 Epoch=49.5] | Loss=0.00430 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.041 | L2-Norm(final)=8.734 | 1602.6 samples/s | 25.0 steps/s
[Step=5300 Epoch=49.9] | Loss=0.00403 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.012 | L2-Norm(final)=8.734 | 4084.2 samples/s | 63.8 steps/s
[Step=5350 Epoch=50.4] | Loss=0.00379 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.982 | L2-Norm(final)=8.734 | 6453.8 samples/s | 100.8 steps/s
[Step=5400 Epoch=50.9] | Loss=0.00358 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.950 | L2-Norm(final)=8.734 | 1367.3 samples/s | 21.4 steps/s
[Step=5450 Epoch=51.4] | Loss=0.00339 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.919 | L2-Norm(final)=8.734 | 5816.3 samples/s | 90.9 steps/s
[Step=5500 Epoch=51.8] | Loss=0.00322 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.887 | L2-Norm(final)=8.734 | 1414.8 samples/s | 22.1 steps/s
[Step=5550 Epoch=52.3] | Loss=0.00307 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.854 | L2-Norm(final)=8.734 | 5203.0 samples/s | 81.3 steps/s
[Step=5600 Epoch=52.8] | Loss=0.00293 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.822 | L2-Norm(final)=8.734 | 1457.2 samples/s | 22.8 steps/s
[Step=5650 Epoch=53.2] | Loss=0.00280 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.789 | L2-Norm(final)=8.734 | 4748.4 samples/s | 74.2 steps/s
[Step=5700 Epoch=53.7] | Loss=0.00269 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.756 | L2-Norm(final)=8.734 | 1518.6 samples/s | 23.7 steps/s
[Step=5750 Epoch=54.2] | Loss=0.00258 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.723 | L2-Norm(final)=8.734 | 4462.2 samples/s | 69.7 steps/s
[Step=5800 Epoch=54.7] | Loss=0.00248 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.689 | L2-Norm(final)=8.734 | 1510.6 samples/s | 23.6 steps/s
[Step=5850 Epoch=55.1] | Loss=0.00239 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.656 | L2-Norm(final)=8.734 | 4436.9 samples/s | 69.3 steps/s
[Step=5900 Epoch=55.6] | Loss=0.00230 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.623 | L2-Norm(final)=8.734 | 1575.9 samples/s | 24.6 steps/s
[Step=5950 Epoch=56.1] | Loss=0.00222 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.589 | L2-Norm(final)=8.734 | 4488.0 samples/s | 70.1 steps/s
[Step=6000 Epoch=56.5] | Loss=0.00215 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.556 | L2-Norm(final)=8.734 | 1573.4 samples/s | 24.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_3/client_state-step6000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.05595 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.115 | L2-Norm(final)=8.332 | 3195.8 samples/s | 49.9 steps/s
[Step=4050 Epoch=38.6] | Loss=0.05390 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.103 | L2-Norm(final)=8.179 | 4577.4 samples/s | 71.5 steps/s
[Step=4100 Epoch=39.1] | Loss=0.05130 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.102 | L2-Norm(final)=8.124 | 8025.8 samples/s | 125.4 steps/s
[Step=4150 Epoch=39.6] | Loss=0.04820 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.101 | L2-Norm(final)=8.145 | 1462.8 samples/s | 22.9 steps/s
[Step=4200 Epoch=40.0] | Loss=0.04584 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.101 | L2-Norm(final)=8.201 | 6910.2 samples/s | 108.0 steps/s
[Step=4250 Epoch=40.5] | Loss=0.04548 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.101 | L2-Norm(final)=8.267 | 1456.3 samples/s | 22.8 steps/s
[Step=4300 Epoch=41.0] | Loss=0.04376 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.101 | L2-Norm(final)=8.345 | 6841.0 samples/s | 106.9 steps/s
[Step=4350 Epoch=41.5] | Loss=0.04262 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.100 | L2-Norm(final)=8.430 | 1480.8 samples/s | 23.1 steps/s
[Step=4400 Epoch=41.9] | Loss=0.04248 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.100 | L2-Norm(final)=8.514 | 6136.1 samples/s | 95.9 steps/s
[Step=4450 Epoch=42.4] | Loss=0.04192 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.100 | L2-Norm(final)=8.594 | 1553.2 samples/s | 24.3 steps/s
[Step=4500 Epoch=42.9] | Loss=0.04154 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.100 | L2-Norm(final)=8.674 | 5433.5 samples/s | 84.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.9] | Loss=0.00950 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.100 | L2-Norm(final)=9.470 | 3171.0 samples/s | 49.5 steps/s
[Step=4550 Epoch=43.4] | Loss=0.03512 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.659 | L2-Norm(final)=9.455 | 3983.2 samples/s | 62.2 steps/s
[Step=4600 Epoch=43.8] | Loss=0.02103 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.977 | L2-Norm(final)=9.435 | 6623.0 samples/s | 103.5 steps/s
[Step=4650 Epoch=44.3] | Loss=0.01467 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.073 | L2-Norm(final)=9.432 | 1399.5 samples/s | 21.9 steps/s
[Step=4700 Epoch=44.8] | Loss=0.01114 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.100 | L2-Norm(final)=9.431 | 5917.6 samples/s | 92.5 steps/s
[Step=4750 Epoch=45.3] | Loss=0.00894 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.096 | L2-Norm(final)=9.432 | 1407.6 samples/s | 22.0 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00745 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.076 | L2-Norm(final)=9.434 | 5541.2 samples/s | 86.6 steps/s
[Step=4850 Epoch=46.2] | Loss=0.00639 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.047 | L2-Norm(final)=9.435 | 1435.3 samples/s | 22.4 steps/s
[Step=4900 Epoch=46.7] | Loss=0.00560 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.013 | L2-Norm(final)=9.436 | 5240.7 samples/s | 81.9 steps/s
[Step=4950 Epoch=47.2] | Loss=0.00498 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.976 | L2-Norm(final)=9.437 | 1476.6 samples/s | 23.1 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00448 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.937 | L2-Norm(final)=9.437 | 4887.1 samples/s | 76.4 steps/s
[Step=5050 Epoch=48.1] | Loss=0.00408 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.898 | L2-Norm(final)=9.438 | 1495.6 samples/s | 23.4 steps/s
[Step=5100 Epoch=48.6] | Loss=0.00374 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.857 | L2-Norm(final)=9.439 | 4565.1 samples/s | 71.3 steps/s
[Step=5150 Epoch=49.1] | Loss=0.00345 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.817 | L2-Norm(final)=9.440 | 1526.5 samples/s | 23.9 steps/s
[Step=5200 Epoch=49.6] | Loss=0.00320 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.776 | L2-Norm(final)=9.440 | 4466.9 samples/s | 69.8 steps/s
[Step=5250 Epoch=50.0] | Loss=0.00299 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.735 | L2-Norm(final)=9.441 | 1525.2 samples/s | 23.8 steps/s
[Step=5300 Epoch=50.5] | Loss=0.00281 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.694 | L2-Norm(final)=9.441 | 4465.7 samples/s | 69.8 steps/s
[Step=5350 Epoch=51.0] | Loss=0.00264 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.654 | L2-Norm(final)=9.442 | 1519.9 samples/s | 23.7 steps/s
[Step=5400 Epoch=51.5] | Loss=0.00249 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.613 | L2-Norm(final)=9.443 | 4495.1 samples/s | 70.2 steps/s
[Step=5450 Epoch=51.9] | Loss=0.00236 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.573 | L2-Norm(final)=9.443 | 1520.8 samples/s | 23.8 steps/s
[Step=5500 Epoch=52.4] | Loss=0.00225 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.533 | L2-Norm(final)=9.444 | 4509.6 samples/s | 70.5 steps/s
[Step=5550 Epoch=52.9] | Loss=0.00214 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.494 | L2-Norm(final)=9.444 | 6959.9 samples/s | 108.7 steps/s
[Step=5600 Epoch=53.4] | Loss=0.00204 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.454 | L2-Norm(final)=9.445 | 1365.5 samples/s | 21.3 steps/s
[Step=5650 Epoch=53.8] | Loss=0.00195 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.415 | L2-Norm(final)=9.445 | 6534.5 samples/s | 102.1 steps/s
[Step=5700 Epoch=54.3] | Loss=0.00187 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.376 | L2-Norm(final)=9.445 | 1398.2 samples/s | 21.8 steps/s
[Step=5750 Epoch=54.8] | Loss=0.00180 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.337 | L2-Norm(final)=9.446 | 6002.8 samples/s | 93.8 steps/s
[Step=5800 Epoch=55.3] | Loss=0.00173 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.299 | L2-Norm(final)=9.446 | 1407.3 samples/s | 22.0 steps/s
[Step=5850 Epoch=55.8] | Loss=0.00167 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.261 | L2-Norm(final)=9.447 | 5578.4 samples/s | 87.2 steps/s
[Step=5900 Epoch=56.2] | Loss=0.00161 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.223 | L2-Norm(final)=9.447 | 1429.6 samples/s | 22.3 steps/s
[Step=5950 Epoch=56.7] | Loss=0.00155 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.185 | L2-Norm(final)=9.448 | 5180.2 samples/s | 80.9 steps/s
[Step=6000 Epoch=57.2] | Loss=0.00150 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.147 | L2-Norm(final)=9.448 | 1451.2 samples/s | 22.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.14971 | acc=0.9328 | tpr=0.9456 | fpr=0.0949 | 4722.3 samples/s | 18.4 steps/s
Avg test loss: 0.15461, Avg test acc: 0.92948, Avg tpr: 0.94224, Avg fpr: 0.09858, total FA: 769

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14434 | acc=0.9268 | tpr=0.9482 | fpr=0.1197 | 4710.8 samples/s | 18.4 steps/s
Avg test loss: 0.14888, Avg test acc: 0.92479, Avg tpr: 0.94504, Avg fpr: 0.11973, total FA: 934

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.16279 | acc=0.9205 | tpr=0.9228 | fpr=0.0842 | 4752.0 samples/s | 18.6 steps/s
Avg test loss: 0.16840, Avg test acc: 0.91878, Avg tpr: 0.92137, Avg fpr: 0.08691, total FA: 678

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.14571 | acc=0.9366 | tpr=0.9580 | fpr=0.1100 | 4696.3 samples/s | 18.3 steps/s
Avg test loss: 0.15085, Avg test acc: 0.93517, Avg tpr: 0.95914, Avg fpr: 0.11755, total FA: 917

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.13553 | acc=0.9330 | tpr=0.9469 | fpr=0.0974 | 4790.0 samples/s | 18.7 steps/s
Avg test loss: 0.13614, Avg test acc: 0.93249, Avg tpr: 0.94579, Avg fpr: 0.09678, total FA: 755

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.06257 | acc=0.3223 | tpr=0.0179 | fpr=0.0166 | 4688.2 samples/s | 18.3 steps/s
Avg test loss: 4.07030, Avg test acc: 0.31994, Avg tpr: 0.01813, Avg fpr: 0.01628, total FA: 127

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.48975 | acc=0.3237 | tpr=0.0302 | fpr=0.0389 | 4710.6 samples/s | 18.4 steps/s
Avg test loss: 4.52178, Avg test acc: 0.32162, Avg tpr: 0.02938, Avg fpr: 0.03564, total FA: 278

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.78315 | acc=0.3148 | tpr=0.0280 | fpr=0.0624 | 4792.6 samples/s | 18.7 steps/s
Avg test loss: 4.80851, Avg test acc: 0.31321, Avg tpr: 0.02809, Avg fpr: 0.05974, total FA: 466

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.59891 | acc=0.3179 | tpr=0.0275 | fpr=0.0515 | 4825.1 samples/s | 18.8 steps/s
Avg test loss: 4.62530, Avg test acc: 0.31657, Avg tpr: 0.02827, Avg fpr: 0.04935, total FA: 385

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.19693 | acc=0.3222 | tpr=0.0156 | fpr=0.0121 | 4828.2 samples/s | 18.9 steps/s
Avg test loss: 5.21574, Avg test acc: 0.31982, Avg tpr: 0.01533, Avg fpr: 0.01051, total FA: 82

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.41825 | acc=0.1585 | tpr=0.8363 | fpr=0.8537 | 4623.3 samples/s | 18.1 steps/s
[Step= 100] | Loss=5.39950 | acc=0.1608 | tpr=0.8124 | fpr=0.8514 | 7777.7 samples/s | 30.4 steps/s
[Step= 150] | Loss=5.40799 | acc=0.1612 | tpr=0.8055 | fpr=0.8507 | 8428.0 samples/s | 32.9 steps/s
[Step= 200] | Loss=5.40032 | acc=0.1600 | tpr=0.8033 | fpr=0.8517 | 7357.0 samples/s | 28.7 steps/s
[Step= 250] | Loss=5.40631 | acc=0.1599 | tpr=0.7930 | fpr=0.8516 | 8361.4 samples/s | 32.7 steps/s
[Step= 300] | Loss=5.40899 | acc=0.1599 | tpr=0.7949 | fpr=0.8517 | 8153.6 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.41473 | acc=0.1594 | tpr=0.7921 | fpr=0.8521 | 7971.6 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.41193 | acc=0.1595 | tpr=0.7888 | fpr=0.8520 | 8619.9 samples/s | 33.7 steps/s
[Step= 450] | Loss=5.41104 | acc=0.1592 | tpr=0.7907 | fpr=0.8522 | 7578.5 samples/s | 29.6 steps/s
[Step= 500] | Loss=5.41082 | acc=0.1592 | tpr=0.7899 | fpr=0.8522 | 8015.8 samples/s | 31.3 steps/s
[Step= 550] | Loss=5.41128 | acc=0.1594 | tpr=0.7919 | fpr=0.8521 | 9614.8 samples/s | 37.6 steps/s
Avg test loss: 5.41131, Avg test acc: 0.15926, Avg tpr: 0.79160, Avg fpr: 0.85223, total FA: 118331

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.15785 | acc=0.1488 | tpr=0.8142 | fpr=0.8631 | 4626.6 samples/s | 18.1 steps/s
[Step= 100] | Loss=4.16745 | acc=0.1495 | tpr=0.8273 | fpr=0.8631 | 7497.3 samples/s | 29.3 steps/s
[Step= 150] | Loss=4.17109 | acc=0.1505 | tpr=0.8444 | fpr=0.8623 | 8636.5 samples/s | 33.7 steps/s
[Step= 200] | Loss=4.16197 | acc=0.1510 | tpr=0.8514 | fpr=0.8618 | 7380.7 samples/s | 28.8 steps/s
[Step= 250] | Loss=4.16852 | acc=0.1514 | tpr=0.8454 | fpr=0.8613 | 7863.4 samples/s | 30.7 steps/s
[Step= 300] | Loss=4.16977 | acc=0.1516 | tpr=0.8415 | fpr=0.8610 | 8574.3 samples/s | 33.5 steps/s
[Step= 350] | Loss=4.17332 | acc=0.1515 | tpr=0.8403 | fpr=0.8610 | 8350.0 samples/s | 32.6 steps/s
[Step= 400] | Loss=4.17405 | acc=0.1513 | tpr=0.8425 | fpr=0.8612 | 7436.0 samples/s | 29.0 steps/s
[Step= 450] | Loss=4.17480 | acc=0.1509 | tpr=0.8408 | fpr=0.8616 | 7916.1 samples/s | 30.9 steps/s
[Step= 500] | Loss=4.17432 | acc=0.1512 | tpr=0.8410 | fpr=0.8612 | 8314.5 samples/s | 32.5 steps/s
[Step= 550] | Loss=4.17389 | acc=0.1513 | tpr=0.8464 | fpr=0.8614 | 10422.2 samples/s | 40.7 steps/s
Avg test loss: 4.17527, Avg test acc: 0.15118, Avg tpr: 0.84667, Avg fpr: 0.86146, total FA: 119612

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.00332 | acc=0.1375 | tpr=0.8496 | fpr=0.8753 | 4628.8 samples/s | 18.1 steps/s
[Step= 100] | Loss=4.98696 | acc=0.1412 | tpr=0.8571 | fpr=0.8721 | 8208.9 samples/s | 32.1 steps/s
[Step= 150] | Loss=4.98563 | acc=0.1424 | tpr=0.8444 | fpr=0.8705 | 8154.2 samples/s | 31.9 steps/s
[Step= 200] | Loss=4.97103 | acc=0.1424 | tpr=0.8481 | fpr=0.8704 | 7848.2 samples/s | 30.7 steps/s
[Step= 250] | Loss=4.97581 | acc=0.1431 | tpr=0.8454 | fpr=0.8697 | 7592.1 samples/s | 29.7 steps/s
[Step= 300] | Loss=4.97708 | acc=0.1432 | tpr=0.8531 | fpr=0.8697 | 8207.0 samples/s | 32.1 steps/s
[Step= 350] | Loss=4.97685 | acc=0.1432 | tpr=0.8547 | fpr=0.8697 | 7942.7 samples/s | 31.0 steps/s
[Step= 400] | Loss=4.97787 | acc=0.1433 | tpr=0.8567 | fpr=0.8697 | 8530.6 samples/s | 33.3 steps/s
[Step= 450] | Loss=4.98027 | acc=0.1428 | tpr=0.8559 | fpr=0.8701 | 7127.7 samples/s | 27.8 steps/s
[Step= 500] | Loss=4.98009 | acc=0.1430 | tpr=0.8529 | fpr=0.8698 | 8857.2 samples/s | 34.6 steps/s
[Step= 550] | Loss=4.97635 | acc=0.1434 | tpr=0.8532 | fpr=0.8695 | 9414.3 samples/s | 36.8 steps/s
Avg test loss: 4.97751, Avg test acc: 0.14332, Avg tpr: 0.85341, Avg fpr: 0.86959, total FA: 120741

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.94172 | acc=0.1334 | tpr=0.9292 | fpr=0.8809 | 4663.2 samples/s | 18.2 steps/s
[Step= 100] | Loss=5.92106 | acc=0.1330 | tpr=0.9211 | fpr=0.8817 | 8511.5 samples/s | 33.2 steps/s
[Step= 150] | Loss=5.93007 | acc=0.1329 | tpr=0.9222 | fpr=0.8817 | 7246.8 samples/s | 28.3 steps/s
[Step= 200] | Loss=5.92175 | acc=0.1330 | tpr=0.9213 | fpr=0.8814 | 7996.2 samples/s | 31.2 steps/s
[Step= 250] | Loss=5.92647 | acc=0.1340 | tpr=0.9240 | fpr=0.8803 | 7914.5 samples/s | 30.9 steps/s
[Step= 300] | Loss=5.92251 | acc=0.1342 | tpr=0.9236 | fpr=0.8802 | 8187.3 samples/s | 32.0 steps/s
[Step= 350] | Loss=5.92944 | acc=0.1341 | tpr=0.9255 | fpr=0.8803 | 8345.6 samples/s | 32.6 steps/s
[Step= 400] | Loss=5.93397 | acc=0.1341 | tpr=0.9256 | fpr=0.8803 | 8097.1 samples/s | 31.6 steps/s
[Step= 450] | Loss=5.93779 | acc=0.1337 | tpr=0.9250 | fpr=0.8806 | 7759.0 samples/s | 30.3 steps/s
[Step= 500] | Loss=5.93918 | acc=0.1338 | tpr=0.9220 | fpr=0.8804 | 8300.0 samples/s | 32.4 steps/s
[Step= 550] | Loss=5.93821 | acc=0.1339 | tpr=0.9224 | fpr=0.8805 | 9380.8 samples/s | 36.6 steps/s
Avg test loss: 5.93950, Avg test acc: 0.13380, Avg tpr: 0.92235, Avg fpr: 0.88053, total FA: 122260

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.29061 | acc=0.1190 | tpr=0.8451 | fpr=0.8941 | 4491.8 samples/s | 17.5 steps/s
[Step= 100] | Loss=5.28413 | acc=0.1181 | tpr=0.8593 | fpr=0.8957 | 7995.3 samples/s | 31.2 steps/s
[Step= 150] | Loss=5.28027 | acc=0.1189 | tpr=0.8674 | fpr=0.8948 | 8389.5 samples/s | 32.8 steps/s
[Step= 200] | Loss=5.27034 | acc=0.1200 | tpr=0.8634 | fpr=0.8935 | 8471.5 samples/s | 33.1 steps/s
[Step= 250] | Loss=5.27005 | acc=0.1214 | tpr=0.8559 | fpr=0.8920 | 7208.5 samples/s | 28.2 steps/s
[Step= 300] | Loss=5.26995 | acc=0.1214 | tpr=0.8524 | fpr=0.8919 | 8336.1 samples/s | 32.6 steps/s
[Step= 350] | Loss=5.27303 | acc=0.1212 | tpr=0.8535 | fpr=0.8921 | 8005.7 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.27466 | acc=0.1210 | tpr=0.8528 | fpr=0.8923 | 8385.4 samples/s | 32.8 steps/s
[Step= 450] | Loss=5.27909 | acc=0.1207 | tpr=0.8544 | fpr=0.8927 | 7795.9 samples/s | 30.5 steps/s
[Step= 500] | Loss=5.28194 | acc=0.1204 | tpr=0.8515 | fpr=0.8928 | 8168.0 samples/s | 31.9 steps/s
[Step= 550] | Loss=5.28064 | acc=0.1205 | tpr=0.8536 | fpr=0.8928 | 9484.5 samples/s | 37.0 steps/s
Avg test loss: 5.28182, Avg test acc: 0.12046, Avg tpr: 0.85380, Avg fpr: 0.89287, total FA: 123973

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.20919 | acc=0.9518 | tpr=0.8894 | fpr=0.0471 | 4571.3 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.21104 | acc=0.9501 | tpr=0.9062 | fpr=0.0491 | 8331.0 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.21329 | acc=0.9494 | tpr=0.9049 | fpr=0.0498 | 7548.4 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.21226 | acc=0.9498 | tpr=0.9115 | fpr=0.0495 | 8206.3 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.21241 | acc=0.9497 | tpr=0.9057 | fpr=0.0495 | 7867.5 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.21486 | acc=0.9490 | tpr=0.9040 | fpr=0.0502 | 7883.9 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.21376 | acc=0.9493 | tpr=0.9042 | fpr=0.0499 | 8258.7 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.21536 | acc=0.9490 | tpr=0.9010 | fpr=0.0501 | 7960.4 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.21603 | acc=0.9486 | tpr=0.9007 | fpr=0.0505 | 8059.3 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.21624 | acc=0.9485 | tpr=0.9048 | fpr=0.0507 | 8058.7 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.21566 | acc=0.9486 | tpr=0.9037 | fpr=0.0506 | 9895.7 samples/s | 38.7 steps/s
Avg test loss: 0.21521, Avg test acc: 0.94862, Avg tpr: 0.90372, Avg fpr: 0.05056, total FA: 7020

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12198 | acc=0.9623 | tpr=0.9027 | fpr=0.0366 | 4847.4 samples/s | 18.9 steps/s
[Step= 100] | Loss=0.12261 | acc=0.9623 | tpr=0.9062 | fpr=0.0366 | 7291.5 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.12595 | acc=0.9610 | tpr=0.9092 | fpr=0.0380 | 7849.9 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.12581 | acc=0.9613 | tpr=0.9126 | fpr=0.0378 | 8390.9 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.12718 | acc=0.9610 | tpr=0.9074 | fpr=0.0380 | 8001.7 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.12810 | acc=0.9607 | tpr=0.9084 | fpr=0.0383 | 8068.1 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.12892 | acc=0.9609 | tpr=0.9130 | fpr=0.0383 | 7770.8 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.12916 | acc=0.9606 | tpr=0.9048 | fpr=0.0384 | 7685.5 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.13076 | acc=0.9602 | tpr=0.9036 | fpr=0.0387 | 8120.9 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.13069 | acc=0.9603 | tpr=0.9057 | fpr=0.0388 | 7399.7 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.13084 | acc=0.9603 | tpr=0.9017 | fpr=0.0386 | 11703.8 samples/s | 45.7 steps/s
Avg test loss: 0.13064, Avg test acc: 0.96029, Avg tpr: 0.90135, Avg fpr: 0.03864, total FA: 5365

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.25178 | acc=0.9465 | tpr=0.9159 | fpr=0.0530 | 4632.6 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.25438 | acc=0.9466 | tpr=0.9190 | fpr=0.0529 | 8581.2 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.26101 | acc=0.9449 | tpr=0.9222 | fpr=0.0547 | 7845.7 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.26440 | acc=0.9446 | tpr=0.9246 | fpr=0.0550 | 7957.0 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.26720 | acc=0.9440 | tpr=0.9179 | fpr=0.0556 | 7089.5 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.27044 | acc=0.9433 | tpr=0.9156 | fpr=0.0562 | 8410.3 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.26979 | acc=0.9433 | tpr=0.9148 | fpr=0.0561 | 8094.3 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.27087 | acc=0.9429 | tpr=0.9097 | fpr=0.0565 | 8109.1 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.27224 | acc=0.9424 | tpr=0.9070 | fpr=0.0569 | 7440.7 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.27244 | acc=0.9423 | tpr=0.9097 | fpr=0.0571 | 7929.4 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.27169 | acc=0.9424 | tpr=0.9093 | fpr=0.0570 | 10990.4 samples/s | 42.9 steps/s
Avg test loss: 0.27140, Avg test acc: 0.94245, Avg tpr: 0.90967, Avg fpr: 0.05695, total FA: 7908

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11329 | acc=0.9647 | tpr=0.9027 | fpr=0.0342 | 4786.4 samples/s | 18.7 steps/s
[Step= 100] | Loss=0.11799 | acc=0.9638 | tpr=0.8977 | fpr=0.0349 | 7565.0 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.11933 | acc=0.9631 | tpr=0.9035 | fpr=0.0358 | 7642.3 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.12139 | acc=0.9627 | tpr=0.9049 | fpr=0.0363 | 7673.0 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.12175 | acc=0.9625 | tpr=0.9004 | fpr=0.0364 | 7821.1 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.12310 | acc=0.9621 | tpr=0.8945 | fpr=0.0367 | 8270.1 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.12300 | acc=0.9622 | tpr=0.8998 | fpr=0.0367 | 7878.7 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.12392 | acc=0.9617 | tpr=0.8939 | fpr=0.0371 | 8198.7 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.12507 | acc=0.9615 | tpr=0.8900 | fpr=0.0372 | 8106.6 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.12493 | acc=0.9614 | tpr=0.8943 | fpr=0.0374 | 7847.5 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.12469 | acc=0.9615 | tpr=0.8934 | fpr=0.0372 | 10930.8 samples/s | 42.7 steps/s
Avg test loss: 0.12446, Avg test acc: 0.96158, Avg tpr: 0.89382, Avg fpr: 0.03718, total FA: 5163

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.24433 | acc=0.9469 | tpr=0.8540 | fpr=0.0515 | 4681.5 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.24577 | acc=0.9470 | tpr=0.8870 | fpr=0.0519 | 7652.9 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.24951 | acc=0.9462 | tpr=0.9035 | fpr=0.0530 | 7914.4 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.25052 | acc=0.9467 | tpr=0.9082 | fpr=0.0526 | 8171.8 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.25160 | acc=0.9464 | tpr=0.8987 | fpr=0.0528 | 8192.0 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.25326 | acc=0.9458 | tpr=0.8967 | fpr=0.0533 | 7797.7 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.25373 | acc=0.9460 | tpr=0.8967 | fpr=0.0531 | 8130.8 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.25436 | acc=0.9459 | tpr=0.8933 | fpr=0.0531 | 8230.6 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.25587 | acc=0.9456 | tpr=0.8919 | fpr=0.0534 | 7888.2 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.25667 | acc=0.9456 | tpr=0.8943 | fpr=0.0535 | 8237.4 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.25603 | acc=0.9456 | tpr=0.8914 | fpr=0.0534 | 9412.9 samples/s | 36.8 steps/s
Avg test loss: 0.25585, Avg test acc: 0.94563, Avg tpr: 0.89025, Avg fpr: 0.05337, total FA: 7410

server round 6/50

clients selected: [1 3 5 7 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=29.3] | Loss=0.12899 | Reg=0.00189 | acc=0.8594 | L2-Norm=13.754 | L2-Norm(final)=5.748 | 3309.0 samples/s | 51.7 steps/s
[Step=6050 Epoch=29.5] | Loss=0.13396 | Reg=0.00189 | acc=0.8750 | L2-Norm=13.759 | L2-Norm(final)=5.798 | 4768.5 samples/s | 74.5 steps/s
[Step=6100 Epoch=29.8] | Loss=0.13209 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.761 | L2-Norm(final)=5.886 | 5474.5 samples/s | 85.5 steps/s
[Step=6150 Epoch=30.0] | Loss=0.12927 | Reg=0.00189 | acc=0.8594 | L2-Norm=13.761 | L2-Norm(final)=5.974 | 5417.8 samples/s | 84.7 steps/s
[Step=6200 Epoch=30.3] | Loss=0.12662 | Reg=0.00189 | acc=0.8750 | L2-Norm=13.761 | L2-Norm(final)=6.059 | 8634.2 samples/s | 134.9 steps/s
[Step=6250 Epoch=30.5] | Loss=0.12439 | Reg=0.00189 | acc=0.8750 | L2-Norm=13.761 | L2-Norm(final)=6.143 | 1490.0 samples/s | 23.3 steps/s
[Step=6300 Epoch=30.7] | Loss=0.12354 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.761 | L2-Norm(final)=6.224 | 5379.4 samples/s | 84.1 steps/s
[Step=6350 Epoch=31.0] | Loss=0.12266 | Reg=0.00189 | acc=0.9062 | L2-Norm=13.761 | L2-Norm(final)=6.303 | 5582.9 samples/s | 87.2 steps/s
[Step=6400 Epoch=31.2] | Loss=0.12133 | Reg=0.00189 | acc=0.8906 | L2-Norm=13.761 | L2-Norm(final)=6.379 | 7691.5 samples/s | 120.2 steps/s
[Step=6450 Epoch=31.5] | Loss=0.12052 | Reg=0.00189 | acc=0.8594 | L2-Norm=13.761 | L2-Norm(final)=6.453 | 1501.3 samples/s | 23.5 steps/s
[Step=6500 Epoch=31.7] | Loss=0.11959 | Reg=0.00189 | acc=0.8438 | L2-Norm=13.762 | L2-Norm(final)=6.525 | 5561.5 samples/s | 86.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=31.7] | Loss=0.06430 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.762 | L2-Norm(final)=7.245 | 3198.6 samples/s | 50.0 steps/s
[Step=6550 Epoch=32.0] | Loss=0.09301 | Reg=0.00196 | acc=0.9531 | L2-Norm=13.982 | L2-Norm(final)=7.262 | 4231.6 samples/s | 66.1 steps/s
[Step=6600 Epoch=32.2] | Loss=0.09495 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.152 | L2-Norm(final)=7.244 | 4704.1 samples/s | 73.5 steps/s
[Step=6650 Epoch=32.4] | Loss=0.08916 | Reg=0.00203 | acc=0.9219 | L2-Norm=14.260 | L2-Norm(final)=7.233 | 4697.9 samples/s | 73.4 steps/s
[Step=6700 Epoch=32.7] | Loss=0.08652 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.346 | L2-Norm(final)=7.221 | 6716.7 samples/s | 104.9 steps/s
[Step=6750 Epoch=32.9] | Loss=0.07745 | Reg=0.00208 | acc=0.9531 | L2-Norm=14.423 | L2-Norm(final)=7.215 | 1411.4 samples/s | 22.1 steps/s
[Step=6800 Epoch=33.2] | Loss=0.07239 | Reg=0.00210 | acc=0.9531 | L2-Norm=14.489 | L2-Norm(final)=7.213 | 4708.2 samples/s | 73.6 steps/s
[Step=6850 Epoch=33.4] | Loss=0.06964 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.549 | L2-Norm(final)=7.210 | 4654.9 samples/s | 72.7 steps/s
[Step=6900 Epoch=33.7] | Loss=0.06677 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.608 | L2-Norm(final)=7.208 | 6271.1 samples/s | 98.0 steps/s
[Step=6950 Epoch=33.9] | Loss=0.06280 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.665 | L2-Norm(final)=7.206 | 1438.9 samples/s | 22.5 steps/s
[Step=7000 Epoch=34.2] | Loss=0.05932 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.718 | L2-Norm(final)=7.205 | 4789.3 samples/s | 74.8 steps/s
[Step=7050 Epoch=34.4] | Loss=0.05710 | Reg=0.00218 | acc=0.9219 | L2-Norm=14.766 | L2-Norm(final)=7.204 | 4588.0 samples/s | 71.7 steps/s
[Step=7100 Epoch=34.6] | Loss=0.05523 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.813 | L2-Norm(final)=7.203 | 5860.2 samples/s | 91.6 steps/s
[Step=7150 Epoch=34.9] | Loss=0.05309 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.857 | L2-Norm(final)=7.202 | 1467.5 samples/s | 22.9 steps/s
[Step=7200 Epoch=35.1] | Loss=0.05092 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.899 | L2-Norm(final)=7.203 | 4603.1 samples/s | 71.9 steps/s
[Step=7250 Epoch=35.4] | Loss=0.04909 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.939 | L2-Norm(final)=7.204 | 4719.2 samples/s | 73.7 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04774 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.976 | L2-Norm(final)=7.204 | 5397.2 samples/s | 84.3 steps/s
[Step=7350 Epoch=35.9] | Loss=0.04628 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.011 | L2-Norm(final)=7.205 | 1471.1 samples/s | 23.0 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04472 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.045 | L2-Norm(final)=7.206 | 4702.6 samples/s | 73.5 steps/s
[Step=7450 Epoch=36.4] | Loss=0.04337 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.076 | L2-Norm(final)=7.207 | 4731.9 samples/s | 73.9 steps/s
[Step=7500 Epoch=36.6] | Loss=0.04232 | Reg=0.00228 | acc=0.9688 | L2-Norm=15.106 | L2-Norm(final)=7.208 | 5026.1 samples/s | 78.5 steps/s
[Step=7550 Epoch=36.8] | Loss=0.04096 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.135 | L2-Norm(final)=7.210 | 1528.4 samples/s | 23.9 steps/s
[Step=7600 Epoch=37.1] | Loss=0.03977 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.163 | L2-Norm(final)=7.212 | 4660.3 samples/s | 72.8 steps/s
[Step=7650 Epoch=37.3] | Loss=0.03868 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.191 | L2-Norm(final)=7.214 | 4690.9 samples/s | 73.3 steps/s
[Step=7700 Epoch=37.6] | Loss=0.03788 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.217 | L2-Norm(final)=7.216 | 4769.1 samples/s | 74.5 steps/s
[Step=7750 Epoch=37.8] | Loss=0.03701 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.243 | L2-Norm(final)=7.218 | 1531.8 samples/s | 23.9 steps/s
[Step=7800 Epoch=38.1] | Loss=0.03616 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.268 | L2-Norm(final)=7.220 | 4679.7 samples/s | 73.1 steps/s
[Step=7850 Epoch=38.3] | Loss=0.03536 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.292 | L2-Norm(final)=7.221 | 4721.5 samples/s | 73.8 steps/s
[Step=7900 Epoch=38.5] | Loss=0.03482 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.316 | L2-Norm(final)=7.223 | 4676.9 samples/s | 73.1 steps/s
[Step=7950 Epoch=38.8] | Loss=0.03412 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.339 | L2-Norm(final)=7.224 | 1576.0 samples/s | 24.6 steps/s
[Step=8000 Epoch=39.0] | Loss=0.03350 | Reg=0.00236 | acc=0.9531 | L2-Norm=15.361 | L2-Norm(final)=7.226 | 4618.9 samples/s | 72.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_1/client_state-step8000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=39.0] | Loss=0.20987 | Reg=0.00189 | acc=0.8281 | L2-Norm=13.754 | L2-Norm(final)=8.534 | 3172.1 samples/s | 49.6 steps/s
[Step=8050 Epoch=39.3] | Loss=0.12765 | Reg=0.00189 | acc=0.8750 | L2-Norm=13.756 | L2-Norm(final)=8.545 | 5060.5 samples/s | 79.1 steps/s
[Step=8100 Epoch=39.5] | Loss=0.11654 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.757 | L2-Norm(final)=8.601 | 5259.5 samples/s | 82.2 steps/s
[Step=8150 Epoch=39.7] | Loss=0.11278 | Reg=0.00189 | acc=0.8750 | L2-Norm=13.757 | L2-Norm(final)=8.659 | 5490.1 samples/s | 85.8 steps/s
[Step=8200 Epoch=40.0] | Loss=0.11088 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.758 | L2-Norm(final)=8.713 | 8522.7 samples/s | 133.2 steps/s
[Step=8250 Epoch=40.2] | Loss=0.11025 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.758 | L2-Norm(final)=8.763 | 1466.3 samples/s | 22.9 steps/s
[Step=8300 Epoch=40.5] | Loss=0.11015 | Reg=0.00189 | acc=0.8438 | L2-Norm=13.758 | L2-Norm(final)=8.813 | 5516.3 samples/s | 86.2 steps/s
[Step=8350 Epoch=40.7] | Loss=0.10870 | Reg=0.00189 | acc=0.9219 | L2-Norm=13.758 | L2-Norm(final)=8.860 | 5496.0 samples/s | 85.9 steps/s
[Step=8400 Epoch=41.0] | Loss=0.10854 | Reg=0.00189 | acc=0.8594 | L2-Norm=13.758 | L2-Norm(final)=8.907 | 7539.6 samples/s | 117.8 steps/s
[Step=8450 Epoch=41.2] | Loss=0.10824 | Reg=0.00189 | acc=0.9062 | L2-Norm=13.758 | L2-Norm(final)=8.953 | 1502.3 samples/s | 23.5 steps/s
[Step=8500 Epoch=41.5] | Loss=0.10814 | Reg=0.00189 | acc=0.8906 | L2-Norm=13.758 | L2-Norm(final)=8.997 | 5341.8 samples/s | 83.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=41.5] | Loss=0.09361 | Reg=0.00189 | acc=0.9375 | L2-Norm=13.758 | L2-Norm(final)=9.426 | 3250.7 samples/s | 50.8 steps/s
[Step=8550 Epoch=41.7] | Loss=0.08763 | Reg=0.00197 | acc=0.9219 | L2-Norm=14.030 | L2-Norm(final)=9.427 | 4125.4 samples/s | 64.5 steps/s
[Step=8600 Epoch=41.9] | Loss=0.09186 | Reg=0.00203 | acc=0.9219 | L2-Norm=14.251 | L2-Norm(final)=9.398 | 4694.6 samples/s | 73.4 steps/s
[Step=8650 Epoch=42.2] | Loss=0.08792 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.405 | L2-Norm(final)=9.376 | 4682.7 samples/s | 73.2 steps/s
[Step=8700 Epoch=42.4] | Loss=0.08313 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.523 | L2-Norm(final)=9.359 | 6749.0 samples/s | 105.5 steps/s
[Step=8750 Epoch=42.7] | Loss=0.07413 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.619 | L2-Norm(final)=9.352 | 1399.5 samples/s | 21.9 steps/s
[Step=8800 Epoch=42.9] | Loss=0.06982 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.701 | L2-Norm(final)=9.347 | 4709.6 samples/s | 73.6 steps/s
[Step=8850 Epoch=43.2] | Loss=0.06548 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.773 | L2-Norm(final)=9.344 | 4682.3 samples/s | 73.2 steps/s
[Step=8900 Epoch=43.4] | Loss=0.06198 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.836 | L2-Norm(final)=9.341 | 6171.7 samples/s | 96.4 steps/s
[Step=8950 Epoch=43.6] | Loss=0.05884 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.895 | L2-Norm(final)=9.340 | 1423.8 samples/s | 22.2 steps/s
[Step=9000 Epoch=43.9] | Loss=0.05709 | Reg=0.00224 | acc=0.9219 | L2-Norm=14.951 | L2-Norm(final)=9.338 | 4736.3 samples/s | 74.0 steps/s
[Step=9050 Epoch=44.1] | Loss=0.05464 | Reg=0.00225 | acc=0.9844 | L2-Norm=15.007 | L2-Norm(final)=9.337 | 4759.3 samples/s | 74.4 steps/s
[Step=9100 Epoch=44.4] | Loss=0.05279 | Reg=0.00227 | acc=0.9375 | L2-Norm=15.059 | L2-Norm(final)=9.338 | 5519.5 samples/s | 86.2 steps/s
[Step=9150 Epoch=44.6] | Loss=0.05090 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.109 | L2-Norm(final)=9.337 | 1491.2 samples/s | 23.3 steps/s
[Step=9200 Epoch=44.9] | Loss=0.04899 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.155 | L2-Norm(final)=9.337 | 4657.9 samples/s | 72.8 steps/s
[Step=9250 Epoch=45.1] | Loss=0.04733 | Reg=0.00231 | acc=0.9688 | L2-Norm=15.197 | L2-Norm(final)=9.337 | 4680.7 samples/s | 73.1 steps/s
[Step=9300 Epoch=45.4] | Loss=0.04568 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.236 | L2-Norm(final)=9.337 | 5181.1 samples/s | 81.0 steps/s
[Step=9350 Epoch=45.6] | Loss=0.04422 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.272 | L2-Norm(final)=9.337 | 1492.9 samples/s | 23.3 steps/s
[Step=9400 Epoch=45.8] | Loss=0.04285 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.305 | L2-Norm(final)=9.337 | 4701.4 samples/s | 73.5 steps/s
[Step=9450 Epoch=46.1] | Loss=0.04182 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.337 | L2-Norm(final)=9.337 | 4654.4 samples/s | 72.7 steps/s
[Step=9500 Epoch=46.3] | Loss=0.04059 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.367 | L2-Norm(final)=9.337 | 4855.7 samples/s | 75.9 steps/s
[Step=9550 Epoch=46.6] | Loss=0.03912 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.395 | L2-Norm(final)=9.337 | 1566.7 samples/s | 24.5 steps/s
[Step=9600 Epoch=46.8] | Loss=0.03807 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.421 | L2-Norm(final)=9.338 | 4781.9 samples/s | 74.7 steps/s
[Step=9650 Epoch=47.1] | Loss=0.03713 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.445 | L2-Norm(final)=9.339 | 4625.6 samples/s | 72.3 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03615 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.469 | L2-Norm(final)=9.340 | 4747.7 samples/s | 74.2 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03536 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.491 | L2-Norm(final)=9.340 | 1545.1 samples/s | 24.1 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03460 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.513 | L2-Norm(final)=9.341 | 4722.1 samples/s | 73.8 steps/s
[Step=9850 Epoch=48.0] | Loss=0.03374 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.534 | L2-Norm(final)=9.341 | 4790.3 samples/s | 74.8 steps/s
[Step=9900 Epoch=48.3] | Loss=0.03317 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.554 | L2-Norm(final)=9.342 | 4581.0 samples/s | 71.6 steps/s
[Step=9950 Epoch=48.5] | Loss=0.03253 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.574 | L2-Norm(final)=9.343 | 1566.5 samples/s | 24.5 steps/s
[Step=10000 Epoch=48.8] | Loss=0.03209 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.595 | L2-Norm(final)=9.344 | 4685.9 samples/s | 73.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step10000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=75.8] | Loss=0.07146 | Reg=0.00189 | acc=0.9375 | L2-Norm=13.754 | L2-Norm(final)=9.920 | 3159.2 samples/s | 49.4 steps/s
[Step=8050 Epoch=76.3] | Loss=0.03727 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.743 | L2-Norm(final)=9.863 | 4664.2 samples/s | 72.9 steps/s
[Step=8100 Epoch=76.8] | Loss=0.03321 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.742 | L2-Norm(final)=9.871 | 7769.3 samples/s | 121.4 steps/s
[Step=8150 Epoch=77.2] | Loss=0.03105 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.741 | L2-Norm(final)=9.923 | 1465.0 samples/s | 22.9 steps/s
[Step=8200 Epoch=77.7] | Loss=0.02938 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.741 | L2-Norm(final)=10.003 | 7101.5 samples/s | 111.0 steps/s
[Step=8250 Epoch=78.2] | Loss=0.02876 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.741 | L2-Norm(final)=10.093 | 1502.9 samples/s | 23.5 steps/s
[Step=8300 Epoch=78.6] | Loss=0.02801 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.741 | L2-Norm(final)=10.186 | 6366.1 samples/s | 99.5 steps/s
[Step=8350 Epoch=79.1] | Loss=0.02723 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.741 | L2-Norm(final)=10.282 | 1521.6 samples/s | 23.8 steps/s
[Step=8400 Epoch=79.6] | Loss=0.02705 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.741 | L2-Norm(final)=10.379 | 5782.6 samples/s | 90.4 steps/s
[Step=8450 Epoch=80.1] | Loss=0.02689 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.740 | L2-Norm(final)=10.470 | 1534.8 samples/s | 24.0 steps/s
[Step=8500 Epoch=80.5] | Loss=0.02615 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.740 | L2-Norm(final)=10.559 | 5282.5 samples/s | 82.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=80.6] | Loss=0.00991 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=11.443 | 3222.6 samples/s | 50.4 steps/s
[Step=8550 Epoch=81.0] | Loss=0.02801 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.289 | L2-Norm(final)=11.436 | 3936.3 samples/s | 61.5 steps/s
[Step=8600 Epoch=81.5] | Loss=0.02700 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.699 | L2-Norm(final)=11.395 | 6433.9 samples/s | 100.5 steps/s
[Step=8650 Epoch=82.0] | Loss=0.01826 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.877 | L2-Norm(final)=11.374 | 1394.3 samples/s | 21.8 steps/s
[Step=8700 Epoch=82.4] | Loss=0.01437 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.944 | L2-Norm(final)=11.367 | 5909.8 samples/s | 92.3 steps/s
[Step=8750 Epoch=82.9] | Loss=0.01167 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.973 | L2-Norm(final)=11.363 | 1414.4 samples/s | 22.1 steps/s
[Step=8800 Epoch=83.4] | Loss=0.00974 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.977 | L2-Norm(final)=11.361 | 5368.5 samples/s | 83.9 steps/s
[Step=8850 Epoch=83.9] | Loss=0.00835 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.966 | L2-Norm(final)=11.360 | 1442.4 samples/s | 22.5 steps/s
[Step=8900 Epoch=84.3] | Loss=0.00731 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.946 | L2-Norm(final)=11.359 | 4890.1 samples/s | 76.4 steps/s
[Step=8950 Epoch=84.8] | Loss=0.00650 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.921 | L2-Norm(final)=11.359 | 1481.7 samples/s | 23.2 steps/s
[Step=9000 Epoch=85.3] | Loss=0.00585 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.891 | L2-Norm(final)=11.359 | 4591.2 samples/s | 71.7 steps/s
[Step=9050 Epoch=85.8] | Loss=0.00532 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.859 | L2-Norm(final)=11.359 | 1538.3 samples/s | 24.0 steps/s
[Step=9100 Epoch=86.2] | Loss=0.00488 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.825 | L2-Norm(final)=11.359 | 4481.9 samples/s | 70.0 steps/s
[Step=9150 Epoch=86.7] | Loss=0.00451 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.790 | L2-Norm(final)=11.359 | 1524.9 samples/s | 23.8 steps/s
[Step=9200 Epoch=87.2] | Loss=0.00418 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.754 | L2-Norm(final)=11.359 | 4376.6 samples/s | 68.4 steps/s
[Step=9250 Epoch=87.7] | Loss=0.00391 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.718 | L2-Norm(final)=11.360 | 1553.6 samples/s | 24.3 steps/s
[Step=9300 Epoch=88.1] | Loss=0.00366 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.681 | L2-Norm(final)=11.360 | 4568.4 samples/s | 71.4 steps/s
[Step=9350 Epoch=88.6] | Loss=0.00345 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.644 | L2-Norm(final)=11.360 | 1551.5 samples/s | 24.2 steps/s
[Step=9400 Epoch=89.1] | Loss=0.00326 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.607 | L2-Norm(final)=11.361 | 4034.3 samples/s | 63.0 steps/s
[Step=9450 Epoch=89.5] | Loss=0.00309 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.569 | L2-Norm(final)=11.361 | 6734.1 samples/s | 105.2 steps/s
[Step=9500 Epoch=90.0] | Loss=0.00293 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.532 | L2-Norm(final)=11.361 | 1377.4 samples/s | 21.5 steps/s
[Step=9550 Epoch=90.5] | Loss=0.00279 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.495 | L2-Norm(final)=11.362 | 6113.9 samples/s | 95.5 steps/s
[Step=9600 Epoch=91.0] | Loss=0.00267 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.458 | L2-Norm(final)=11.362 | 1399.0 samples/s | 21.9 steps/s
[Step=9650 Epoch=91.4] | Loss=0.00255 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.421 | L2-Norm(final)=11.362 | 5523.6 samples/s | 86.3 steps/s
[Step=9700 Epoch=91.9] | Loss=0.00244 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.384 | L2-Norm(final)=11.363 | 1441.9 samples/s | 22.5 steps/s
[Step=9750 Epoch=92.4] | Loss=0.00235 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.347 | L2-Norm(final)=11.363 | 5060.5 samples/s | 79.1 steps/s
[Step=9800 Epoch=92.9] | Loss=0.00226 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.310 | L2-Norm(final)=11.363 | 1446.2 samples/s | 22.6 steps/s
[Step=9850 Epoch=93.3] | Loss=0.00217 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.274 | L2-Norm(final)=11.364 | 4644.1 samples/s | 72.6 steps/s
[Step=9900 Epoch=93.8] | Loss=0.00210 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.237 | L2-Norm(final)=11.364 | 1495.5 samples/s | 23.4 steps/s
[Step=9950 Epoch=94.3] | Loss=0.00202 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.201 | L2-Norm(final)=11.364 | 4456.2 samples/s | 69.6 steps/s
[Step=10000 Epoch=94.8] | Loss=0.00196 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.165 | L2-Norm(final)=11.365 | 1530.3 samples/s | 23.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step10000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=95.5] | Loss=0.07642 | Reg=0.00189 | acc=0.8750 | L2-Norm=13.754 | L2-Norm(final)=11.108 | 3096.1 samples/s | 48.4 steps/s
[Step=10050 Epoch=96.0] | Loss=0.03292 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.743 | L2-Norm(final)=11.068 | 4801.6 samples/s | 75.0 steps/s
[Step=10100 Epoch=96.4] | Loss=0.02667 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.741 | L2-Norm(final)=11.102 | 8064.4 samples/s | 126.0 steps/s
[Step=10150 Epoch=96.9] | Loss=0.02382 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.741 | L2-Norm(final)=11.174 | 1466.2 samples/s | 22.9 steps/s
[Step=10200 Epoch=97.4] | Loss=0.02283 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=11.264 | 7492.8 samples/s | 117.1 steps/s
[Step=10250 Epoch=97.9] | Loss=0.02211 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.740 | L2-Norm(final)=11.359 | 1459.7 samples/s | 22.8 steps/s
[Step=10300 Epoch=98.4] | Loss=0.02097 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.740 | L2-Norm(final)=11.453 | 6831.7 samples/s | 106.7 steps/s
[Step=10350 Epoch=98.8] | Loss=0.02001 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.740 | L2-Norm(final)=11.548 | 1533.0 samples/s | 24.0 steps/s
[Step=10400 Epoch=99.3] | Loss=0.01955 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=11.641 | 5953.6 samples/s | 93.0 steps/s
[Step=10450 Epoch=99.8] | Loss=0.01922 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=11.732 | 1530.3 samples/s | 23.9 steps/s
[Step=10500 Epoch=100.3] | Loss=0.01875 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=11.820 | 5726.8 samples/s | 89.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=100.3] | Loss=0.01559 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=12.694 | 3206.5 samples/s | 50.1 steps/s
[Step=10550 Epoch=100.7] | Loss=0.02789 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.275 | L2-Norm(final)=12.671 | 3869.0 samples/s | 60.5 steps/s
[Step=10600 Epoch=101.2] | Loss=0.01761 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.569 | L2-Norm(final)=12.631 | 6625.2 samples/s | 103.5 steps/s
[Step=10650 Epoch=101.7] | Loss=0.01210 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.657 | L2-Norm(final)=12.614 | 1376.2 samples/s | 21.5 steps/s
[Step=10700 Epoch=102.2] | Loss=0.00921 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.673 | L2-Norm(final)=12.608 | 5868.0 samples/s | 91.7 steps/s
[Step=10750 Epoch=102.7] | Loss=0.00742 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.663 | L2-Norm(final)=12.605 | 1388.2 samples/s | 21.7 steps/s
[Step=10800 Epoch=103.1] | Loss=0.00622 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.639 | L2-Norm(final)=12.605 | 5591.4 samples/s | 87.4 steps/s
[Step=10850 Epoch=103.6] | Loss=0.00534 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.607 | L2-Norm(final)=12.605 | 1452.6 samples/s | 22.7 steps/s
[Step=10900 Epoch=104.1] | Loss=0.00467 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.571 | L2-Norm(final)=12.606 | 5238.4 samples/s | 81.9 steps/s
[Step=10950 Epoch=104.6] | Loss=0.00416 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.531 | L2-Norm(final)=12.606 | 1472.3 samples/s | 23.0 steps/s
[Step=11000 Epoch=105.0] | Loss=0.00374 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.490 | L2-Norm(final)=12.607 | 4858.9 samples/s | 75.9 steps/s
[Step=11050 Epoch=105.5] | Loss=0.00340 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.448 | L2-Norm(final)=12.607 | 1513.6 samples/s | 23.7 steps/s
[Step=11100 Epoch=106.0] | Loss=0.00312 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.405 | L2-Norm(final)=12.608 | 4539.1 samples/s | 70.9 steps/s
[Step=11150 Epoch=106.5] | Loss=0.00288 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.362 | L2-Norm(final)=12.608 | 1542.4 samples/s | 24.1 steps/s
[Step=11200 Epoch=107.0] | Loss=0.00267 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.319 | L2-Norm(final)=12.609 | 4475.0 samples/s | 69.9 steps/s
[Step=11250 Epoch=107.4] | Loss=0.00250 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.276 | L2-Norm(final)=12.609 | 1512.3 samples/s | 23.6 steps/s
[Step=11300 Epoch=107.9] | Loss=0.00234 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.234 | L2-Norm(final)=12.610 | 4483.0 samples/s | 70.0 steps/s
[Step=11350 Epoch=108.4] | Loss=0.00220 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.192 | L2-Norm(final)=12.610 | 1517.4 samples/s | 23.7 steps/s
[Step=11400 Epoch=108.9] | Loss=0.00208 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.150 | L2-Norm(final)=12.610 | 4491.7 samples/s | 70.2 steps/s
[Step=11450 Epoch=109.3] | Loss=0.00197 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.109 | L2-Norm(final)=12.611 | 1518.4 samples/s | 23.7 steps/s
[Step=11500 Epoch=109.8] | Loss=0.00187 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.067 | L2-Norm(final)=12.611 | 4444.1 samples/s | 69.4 steps/s
[Step=11550 Epoch=110.3] | Loss=0.00178 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.027 | L2-Norm(final)=12.611 | 7234.5 samples/s | 113.0 steps/s
[Step=11600 Epoch=110.8] | Loss=0.00170 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.987 | L2-Norm(final)=12.612 | 1348.0 samples/s | 21.1 steps/s
[Step=11650 Epoch=111.3] | Loss=0.00163 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.947 | L2-Norm(final)=12.612 | 6578.0 samples/s | 102.8 steps/s
[Step=11700 Epoch=111.7] | Loss=0.00156 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.907 | L2-Norm(final)=12.612 | 1392.6 samples/s | 21.8 steps/s
[Step=11750 Epoch=112.2] | Loss=0.00150 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.868 | L2-Norm(final)=12.613 | 5797.2 samples/s | 90.6 steps/s
[Step=11800 Epoch=112.7] | Loss=0.00144 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.829 | L2-Norm(final)=12.613 | 1418.4 samples/s | 22.2 steps/s
[Step=11850 Epoch=113.2] | Loss=0.00139 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.791 | L2-Norm(final)=12.613 | 5594.5 samples/s | 87.4 steps/s
[Step=11900 Epoch=113.6] | Loss=0.00134 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.752 | L2-Norm(final)=12.614 | 1419.2 samples/s | 22.2 steps/s
[Step=11950 Epoch=114.1] | Loss=0.00129 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=12.614 | 5174.4 samples/s | 80.8 steps/s
[Step=12000 Epoch=114.6] | Loss=0.00125 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.677 | L2-Norm(final)=12.614 | 1472.6 samples/s | 23.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step12000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=57.2] | Loss=0.13946 | Reg=0.00189 | acc=0.8906 | L2-Norm=13.754 | L2-Norm(final)=9.456 | 3220.9 samples/s | 50.3 steps/s
[Step=6050 Epoch=57.7] | Loss=0.04443 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.743 | L2-Norm(final)=9.372 | 4655.1 samples/s | 72.7 steps/s
[Step=6100 Epoch=58.1] | Loss=0.03989 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.741 | L2-Norm(final)=9.423 | 7955.5 samples/s | 124.3 steps/s
[Step=6150 Epoch=58.6] | Loss=0.03797 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.741 | L2-Norm(final)=9.516 | 1435.9 samples/s | 22.4 steps/s
[Step=6200 Epoch=59.1] | Loss=0.03637 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=9.630 | 7416.8 samples/s | 115.9 steps/s
[Step=6250 Epoch=59.6] | Loss=0.03577 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=9.742 | 1468.6 samples/s | 22.9 steps/s
[Step=6300 Epoch=60.0] | Loss=0.03483 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.740 | L2-Norm(final)=9.856 | 6665.9 samples/s | 104.2 steps/s
[Step=6350 Epoch=60.5] | Loss=0.03402 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.740 | L2-Norm(final)=9.966 | 1486.5 samples/s | 23.2 steps/s
[Step=6400 Epoch=61.0] | Loss=0.03378 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.740 | L2-Norm(final)=10.072 | 6034.5 samples/s | 94.3 steps/s
[Step=6450 Epoch=61.5] | Loss=0.03372 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.740 | L2-Norm(final)=10.176 | 1538.0 samples/s | 24.0 steps/s
[Step=6500 Epoch=62.0] | Loss=0.03316 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=10.278 | 5760.9 samples/s | 90.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=62.0] | Loss=0.06504 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.740 | L2-Norm(final)=11.275 | 3146.9 samples/s | 49.2 steps/s
[Step=6550 Epoch=62.4] | Loss=0.03505 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.533 | L2-Norm(final)=11.213 | 4043.2 samples/s | 63.2 steps/s
[Step=6600 Epoch=62.9] | Loss=0.02187 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.896 | L2-Norm(final)=11.171 | 6612.2 samples/s | 103.3 steps/s
[Step=6650 Epoch=63.4] | Loss=0.01520 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.013 | L2-Norm(final)=11.159 | 1382.5 samples/s | 21.6 steps/s
[Step=6700 Epoch=63.9] | Loss=0.01143 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.048 | L2-Norm(final)=11.154 | 5979.8 samples/s | 93.4 steps/s
[Step=6750 Epoch=64.3] | Loss=0.00919 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.047 | L2-Norm(final)=11.152 | 1397.6 samples/s | 21.8 steps/s
[Step=6800 Epoch=64.8] | Loss=0.00766 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.028 | L2-Norm(final)=11.151 | 5585.6 samples/s | 87.3 steps/s
[Step=6850 Epoch=65.3] | Loss=0.00657 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.999 | L2-Norm(final)=11.151 | 1457.5 samples/s | 22.8 steps/s
[Step=6900 Epoch=65.8] | Loss=0.00575 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.965 | L2-Norm(final)=11.151 | 5244.1 samples/s | 81.9 steps/s
[Step=6950 Epoch=66.2] | Loss=0.00511 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.927 | L2-Norm(final)=11.151 | 1457.1 samples/s | 22.8 steps/s
[Step=7000 Epoch=66.7] | Loss=0.00460 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.887 | L2-Norm(final)=11.151 | 4764.6 samples/s | 74.4 steps/s
[Step=7050 Epoch=67.2] | Loss=0.00419 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.846 | L2-Norm(final)=11.151 | 1531.3 samples/s | 23.9 steps/s
[Step=7100 Epoch=67.7] | Loss=0.00384 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.805 | L2-Norm(final)=11.151 | 4511.1 samples/s | 70.5 steps/s
[Step=7150 Epoch=68.1] | Loss=0.00354 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.763 | L2-Norm(final)=11.151 | 1497.3 samples/s | 23.4 steps/s
[Step=7200 Epoch=68.6] | Loss=0.00329 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.721 | L2-Norm(final)=11.151 | 4439.5 samples/s | 69.4 steps/s
[Step=7250 Epoch=69.1] | Loss=0.00307 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.680 | L2-Norm(final)=11.151 | 1565.0 samples/s | 24.5 steps/s
[Step=7300 Epoch=69.6] | Loss=0.00288 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.638 | L2-Norm(final)=11.152 | 4410.2 samples/s | 68.9 steps/s
[Step=7350 Epoch=70.1] | Loss=0.00271 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.597 | L2-Norm(final)=11.152 | 1539.1 samples/s | 24.0 steps/s
[Step=7400 Epoch=70.5] | Loss=0.00256 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.556 | L2-Norm(final)=11.152 | 4467.3 samples/s | 69.8 steps/s
[Step=7450 Epoch=71.0] | Loss=0.00243 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.515 | L2-Norm(final)=11.152 | 1518.3 samples/s | 23.7 steps/s
[Step=7500 Epoch=71.5] | Loss=0.00231 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.474 | L2-Norm(final)=11.153 | 4480.4 samples/s | 70.0 steps/s
[Step=7550 Epoch=72.0] | Loss=0.00220 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.434 | L2-Norm(final)=11.153 | 7271.5 samples/s | 113.6 steps/s
[Step=7600 Epoch=72.4] | Loss=0.00210 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.394 | L2-Norm(final)=11.153 | 1358.6 samples/s | 21.2 steps/s
[Step=7650 Epoch=72.9] | Loss=0.00201 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=11.153 | 6511.3 samples/s | 101.7 steps/s
[Step=7700 Epoch=73.4] | Loss=0.00192 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.316 | L2-Norm(final)=11.153 | 1390.1 samples/s | 21.7 steps/s
[Step=7750 Epoch=73.9] | Loss=0.00185 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.277 | L2-Norm(final)=11.154 | 5996.9 samples/s | 93.7 steps/s
[Step=7800 Epoch=74.3] | Loss=0.00177 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.238 | L2-Norm(final)=11.154 | 1397.5 samples/s | 21.8 steps/s
[Step=7850 Epoch=74.8] | Loss=0.00171 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.200 | L2-Norm(final)=11.154 | 5593.5 samples/s | 87.4 steps/s
[Step=7900 Epoch=75.3] | Loss=0.00165 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.162 | L2-Norm(final)=11.154 | 1442.6 samples/s | 22.5 steps/s
[Step=7950 Epoch=75.8] | Loss=0.00159 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.124 | L2-Norm(final)=11.155 | 5235.4 samples/s | 81.8 steps/s
[Step=8000 Epoch=76.2] | Loss=0.00154 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=11.155 | 1461.6 samples/s | 22.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.14971 | acc=0.9328 | tpr=0.9456 | fpr=0.0949 | 4762.4 samples/s | 18.6 steps/s
Avg test loss: 0.15461, Avg test acc: 0.92948, Avg tpr: 0.94224, Avg fpr: 0.09858, total FA: 769

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14372 | acc=0.9259 | tpr=0.9332 | fpr=0.0899 | 4521.3 samples/s | 17.7 steps/s
Avg test loss: 0.14575, Avg test acc: 0.92427, Avg tpr: 0.93082, Avg fpr: 0.09012, total FA: 703

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.16279 | acc=0.9205 | tpr=0.9228 | fpr=0.0842 | 4590.8 samples/s | 17.9 steps/s
Avg test loss: 0.16840, Avg test acc: 0.91878, Avg tpr: 0.92137, Avg fpr: 0.08691, total FA: 678

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.15320 | acc=0.9349 | tpr=0.9642 | fpr=0.1286 | 4811.2 samples/s | 18.8 steps/s
Avg test loss: 0.16034, Avg test acc: 0.93169, Avg tpr: 0.96328, Avg fpr: 0.13780, total FA: 1075

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.13553 | acc=0.9330 | tpr=0.9469 | fpr=0.0974 | 4637.6 samples/s | 18.1 steps/s
Avg test loss: 0.13614, Avg test acc: 0.93249, Avg tpr: 0.94579, Avg fpr: 0.09678, total FA: 755

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.28115 | acc=0.3213 | tpr=0.0251 | fpr=0.0354 | 4558.5 samples/s | 17.8 steps/s
Avg test loss: 4.29847, Avg test acc: 0.31725, Avg tpr: 0.02425, Avg fpr: 0.03833, total FA: 299

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.48975 | acc=0.3237 | tpr=0.0302 | fpr=0.0389 | 4520.9 samples/s | 17.7 steps/s
Avg test loss: 4.52178, Avg test acc: 0.32162, Avg tpr: 0.02938, Avg fpr: 0.03564, total FA: 278

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.10127 | acc=0.3223 | tpr=0.0430 | fpr=0.0714 | 4586.3 samples/s | 17.9 steps/s
Avg test loss: 4.12030, Avg test acc: 0.32006, Avg tpr: 0.04237, Avg fpr: 0.06922, total FA: 540

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.59891 | acc=0.3179 | tpr=0.0275 | fpr=0.0515 | 4562.2 samples/s | 17.8 steps/s
Avg test loss: 4.62530, Avg test acc: 0.31657, Avg tpr: 0.02827, Avg fpr: 0.04935, total FA: 385

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.18461 | acc=0.3141 | tpr=0.0132 | fpr=0.0327 | 4483.6 samples/s | 17.5 steps/s
Avg test loss: 5.20267, Avg test acc: 0.31341, Avg tpr: 0.01539, Avg fpr: 0.03115, total FA: 243

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.41825 | acc=0.1585 | tpr=0.8363 | fpr=0.8537 | 4731.0 samples/s | 18.5 steps/s
[Step= 100] | Loss=5.39950 | acc=0.1608 | tpr=0.8124 | fpr=0.8514 | 8029.7 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.40799 | acc=0.1612 | tpr=0.8055 | fpr=0.8507 | 7788.9 samples/s | 30.4 steps/s
[Step= 200] | Loss=5.40032 | acc=0.1600 | tpr=0.8033 | fpr=0.8517 | 7714.1 samples/s | 30.1 steps/s
[Step= 250] | Loss=5.40631 | acc=0.1599 | tpr=0.7930 | fpr=0.8516 | 7569.6 samples/s | 29.6 steps/s
[Step= 300] | Loss=5.40899 | acc=0.1599 | tpr=0.7949 | fpr=0.8517 | 8111.0 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.41473 | acc=0.1594 | tpr=0.7921 | fpr=0.8521 | 8019.0 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.41193 | acc=0.1595 | tpr=0.7888 | fpr=0.8520 | 8261.4 samples/s | 32.3 steps/s
[Step= 450] | Loss=5.41104 | acc=0.1592 | tpr=0.7907 | fpr=0.8522 | 8086.8 samples/s | 31.6 steps/s
[Step= 500] | Loss=5.41082 | acc=0.1592 | tpr=0.7899 | fpr=0.8522 | 7906.4 samples/s | 30.9 steps/s
[Step= 550] | Loss=5.41128 | acc=0.1594 | tpr=0.7919 | fpr=0.8521 | 10117.2 samples/s | 39.5 steps/s
Avg test loss: 5.41131, Avg test acc: 0.15926, Avg tpr: 0.79160, Avg fpr: 0.85223, total FA: 118331

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.05026 | acc=0.1929 | tpr=0.7257 | fpr=0.8167 | 4748.4 samples/s | 18.5 steps/s
[Step= 100] | Loss=4.04745 | acc=0.1934 | tpr=0.7249 | fpr=0.8165 | 7303.0 samples/s | 28.5 steps/s
[Step= 150] | Loss=4.03826 | acc=0.1956 | tpr=0.7493 | fpr=0.8146 | 8017.3 samples/s | 31.3 steps/s
[Step= 200] | Loss=4.02988 | acc=0.1969 | tpr=0.7574 | fpr=0.8133 | 7563.5 samples/s | 29.5 steps/s
[Step= 250] | Loss=4.02709 | acc=0.1982 | tpr=0.7520 | fpr=0.8119 | 7929.8 samples/s | 31.0 steps/s
[Step= 300] | Loss=4.02660 | acc=0.1979 | tpr=0.7520 | fpr=0.8122 | 7949.8 samples/s | 31.1 steps/s
[Step= 350] | Loss=4.02252 | acc=0.1977 | tpr=0.7489 | fpr=0.8123 | 8205.0 samples/s | 32.1 steps/s
[Step= 400] | Loss=4.02084 | acc=0.1968 | tpr=0.7423 | fpr=0.8131 | 7512.2 samples/s | 29.3 steps/s
[Step= 450] | Loss=4.02146 | acc=0.1962 | tpr=0.7347 | fpr=0.8135 | 8015.1 samples/s | 31.3 steps/s
[Step= 500] | Loss=4.02252 | acc=0.1964 | tpr=0.7304 | fpr=0.8133 | 8167.3 samples/s | 31.9 steps/s
[Step= 550] | Loss=4.01864 | acc=0.1967 | tpr=0.7330 | fpr=0.8131 | 11138.5 samples/s | 43.5 steps/s
Avg test loss: 4.02036, Avg test acc: 0.19655, Avg tpr: 0.73296, Avg fpr: 0.81321, total FA: 112912

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.00332 | acc=0.1375 | tpr=0.8496 | fpr=0.8753 | 4687.8 samples/s | 18.3 steps/s
[Step= 100] | Loss=4.98696 | acc=0.1412 | tpr=0.8571 | fpr=0.8721 | 8005.3 samples/s | 31.3 steps/s
[Step= 150] | Loss=4.98563 | acc=0.1424 | tpr=0.8444 | fpr=0.8705 | 7127.2 samples/s | 27.8 steps/s
[Step= 200] | Loss=4.97103 | acc=0.1424 | tpr=0.8481 | fpr=0.8704 | 8204.3 samples/s | 32.0 steps/s
[Step= 250] | Loss=4.97581 | acc=0.1431 | tpr=0.8454 | fpr=0.8697 | 8015.9 samples/s | 31.3 steps/s
[Step= 300] | Loss=4.97708 | acc=0.1432 | tpr=0.8531 | fpr=0.8697 | 8210.8 samples/s | 32.1 steps/s
[Step= 350] | Loss=4.97685 | acc=0.1432 | tpr=0.8547 | fpr=0.8697 | 7898.3 samples/s | 30.9 steps/s
[Step= 400] | Loss=4.97787 | acc=0.1433 | tpr=0.8567 | fpr=0.8697 | 7957.3 samples/s | 31.1 steps/s
[Step= 450] | Loss=4.98027 | acc=0.1428 | tpr=0.8559 | fpr=0.8701 | 8063.7 samples/s | 31.5 steps/s
[Step= 500] | Loss=4.98009 | acc=0.1430 | tpr=0.8529 | fpr=0.8698 | 8024.5 samples/s | 31.3 steps/s
[Step= 550] | Loss=4.97635 | acc=0.1434 | tpr=0.8532 | fpr=0.8695 | 9578.1 samples/s | 37.4 steps/s
Avg test loss: 4.97751, Avg test acc: 0.14332, Avg tpr: 0.85341, Avg fpr: 0.86959, total FA: 120741

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.89460 | acc=0.1209 | tpr=0.9204 | fpr=0.8935 | 4612.3 samples/s | 18.0 steps/s
[Step= 100] | Loss=6.85225 | acc=0.1228 | tpr=0.9211 | fpr=0.8921 | 8016.8 samples/s | 31.3 steps/s
[Step= 150] | Loss=6.85850 | acc=0.1230 | tpr=0.9179 | fpr=0.8916 | 7543.0 samples/s | 29.5 steps/s
[Step= 200] | Loss=6.83757 | acc=0.1232 | tpr=0.9158 | fpr=0.8913 | 8235.6 samples/s | 32.2 steps/s
[Step= 250] | Loss=6.83038 | acc=0.1235 | tpr=0.9135 | fpr=0.8909 | 8401.1 samples/s | 32.8 steps/s
[Step= 300] | Loss=6.82468 | acc=0.1236 | tpr=0.9127 | fpr=0.8908 | 7780.3 samples/s | 30.4 steps/s
[Step= 350] | Loss=6.82812 | acc=0.1240 | tpr=0.9142 | fpr=0.8903 | 8070.6 samples/s | 31.5 steps/s
[Step= 400] | Loss=6.82979 | acc=0.1240 | tpr=0.9108 | fpr=0.8903 | 7254.1 samples/s | 28.3 steps/s
[Step= 450] | Loss=6.83326 | acc=0.1237 | tpr=0.9109 | fpr=0.8906 | 7906.9 samples/s | 30.9 steps/s
[Step= 500] | Loss=6.83241 | acc=0.1238 | tpr=0.9070 | fpr=0.8904 | 8518.8 samples/s | 33.3 steps/s
[Step= 550] | Loss=6.82871 | acc=0.1238 | tpr=0.9065 | fpr=0.8904 | 9910.0 samples/s | 38.7 steps/s
Avg test loss: 6.83008, Avg test acc: 0.12371, Avg tpr: 0.90650, Avg fpr: 0.89052, total FA: 123647

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.29061 | acc=0.1190 | tpr=0.8451 | fpr=0.8941 | 4634.3 samples/s | 18.1 steps/s
[Step= 100] | Loss=5.28413 | acc=0.1181 | tpr=0.8593 | fpr=0.8957 | 7562.2 samples/s | 29.5 steps/s
[Step= 150] | Loss=5.28027 | acc=0.1189 | tpr=0.8674 | fpr=0.8948 | 8258.3 samples/s | 32.3 steps/s
[Step= 200] | Loss=5.27034 | acc=0.1200 | tpr=0.8634 | fpr=0.8935 | 8403.0 samples/s | 32.8 steps/s
[Step= 250] | Loss=5.27005 | acc=0.1214 | tpr=0.8559 | fpr=0.8920 | 7934.7 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.26995 | acc=0.1214 | tpr=0.8524 | fpr=0.8919 | 8141.1 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.27303 | acc=0.1212 | tpr=0.8535 | fpr=0.8921 | 7425.8 samples/s | 29.0 steps/s
[Step= 400] | Loss=5.27466 | acc=0.1210 | tpr=0.8528 | fpr=0.8923 | 8048.2 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.27909 | acc=0.1207 | tpr=0.8544 | fpr=0.8927 | 7274.6 samples/s | 28.4 steps/s
[Step= 500] | Loss=5.28194 | acc=0.1204 | tpr=0.8515 | fpr=0.8928 | 8114.2 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.28064 | acc=0.1205 | tpr=0.8536 | fpr=0.8928 | 10739.5 samples/s | 42.0 steps/s
Avg test loss: 5.28182, Avg test acc: 0.12046, Avg tpr: 0.85380, Avg fpr: 0.89287, total FA: 123973

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19869 | acc=0.9541 | tpr=0.9159 | fpr=0.0452 | 4548.3 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.20385 | acc=0.9530 | tpr=0.9232 | fpr=0.0464 | 7628.6 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.20813 | acc=0.9516 | tpr=0.9251 | fpr=0.0479 | 8041.3 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.20768 | acc=0.9520 | tpr=0.9322 | fpr=0.0476 | 8214.2 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.20850 | acc=0.9520 | tpr=0.9336 | fpr=0.0477 | 8066.5 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.21042 | acc=0.9513 | tpr=0.9302 | fpr=0.0483 | 7819.7 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.20968 | acc=0.9516 | tpr=0.9317 | fpr=0.0481 | 7726.0 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.21148 | acc=0.9512 | tpr=0.9272 | fpr=0.0484 | 8008.8 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.21330 | acc=0.9507 | tpr=0.9245 | fpr=0.0489 | 7648.7 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.21376 | acc=0.9506 | tpr=0.9269 | fpr=0.0490 | 8526.3 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.21317 | acc=0.9507 | tpr=0.9276 | fpr=0.0489 | 10097.2 samples/s | 39.4 steps/s
Avg test loss: 0.21269, Avg test acc: 0.95071, Avg tpr: 0.92750, Avg fpr: 0.04887, total FA: 6785

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12198 | acc=0.9623 | tpr=0.9027 | fpr=0.0366 | 4687.1 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.12261 | acc=0.9623 | tpr=0.9062 | fpr=0.0366 | 7914.2 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.12595 | acc=0.9610 | tpr=0.9092 | fpr=0.0380 | 8129.4 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.12581 | acc=0.9613 | tpr=0.9126 | fpr=0.0378 | 7256.2 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.12718 | acc=0.9610 | tpr=0.9074 | fpr=0.0380 | 8346.9 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.12810 | acc=0.9607 | tpr=0.9084 | fpr=0.0383 | 8101.7 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.12892 | acc=0.9609 | tpr=0.9130 | fpr=0.0383 | 7876.8 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.12916 | acc=0.9606 | tpr=0.9048 | fpr=0.0384 | 8213.0 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.13076 | acc=0.9602 | tpr=0.9036 | fpr=0.0387 | 7669.2 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.13069 | acc=0.9603 | tpr=0.9057 | fpr=0.0388 | 8009.7 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.13084 | acc=0.9603 | tpr=0.9017 | fpr=0.0386 | 10325.2 samples/s | 40.3 steps/s
Avg test loss: 0.13064, Avg test acc: 0.96029, Avg tpr: 0.90135, Avg fpr: 0.03864, total FA: 5365

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26655 | acc=0.9484 | tpr=0.9159 | fpr=0.0511 | 4593.3 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.26933 | acc=0.9471 | tpr=0.9062 | fpr=0.0522 | 8137.1 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.27438 | acc=0.9456 | tpr=0.9092 | fpr=0.0538 | 7816.7 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.27663 | acc=0.9456 | tpr=0.9148 | fpr=0.0539 | 7921.3 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.27965 | acc=0.9454 | tpr=0.9074 | fpr=0.0539 | 7876.4 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.28389 | acc=0.9450 | tpr=0.9033 | fpr=0.0542 | 7648.3 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.28256 | acc=0.9452 | tpr=0.9042 | fpr=0.0540 | 8261.8 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.28386 | acc=0.9450 | tpr=0.9026 | fpr=0.0543 | 8044.3 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.28438 | acc=0.9446 | tpr=0.9012 | fpr=0.0546 | 8377.4 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.28486 | acc=0.9445 | tpr=0.9044 | fpr=0.0548 | 8195.4 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.28398 | acc=0.9447 | tpr=0.9041 | fpr=0.0546 | 9285.7 samples/s | 36.3 steps/s
Avg test loss: 0.28375, Avg test acc: 0.94469, Avg tpr: 0.90452, Avg fpr: 0.05458, total FA: 7578

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11329 | acc=0.9647 | tpr=0.9027 | fpr=0.0342 | 4698.9 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.11799 | acc=0.9638 | tpr=0.8977 | fpr=0.0349 | 7541.2 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.11933 | acc=0.9631 | tpr=0.9035 | fpr=0.0358 | 8035.5 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.12139 | acc=0.9627 | tpr=0.9049 | fpr=0.0363 | 7698.9 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.12175 | acc=0.9625 | tpr=0.9004 | fpr=0.0364 | 8317.4 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.12310 | acc=0.9621 | tpr=0.8945 | fpr=0.0367 | 8440.1 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.12300 | acc=0.9622 | tpr=0.8998 | fpr=0.0367 | 7676.2 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.12392 | acc=0.9617 | tpr=0.8939 | fpr=0.0371 | 7845.4 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.12507 | acc=0.9615 | tpr=0.8900 | fpr=0.0372 | 7997.0 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.12493 | acc=0.9614 | tpr=0.8943 | fpr=0.0374 | 7763.5 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.12469 | acc=0.9615 | tpr=0.8934 | fpr=0.0372 | 10680.5 samples/s | 41.7 steps/s
Avg test loss: 0.12446, Avg test acc: 0.96158, Avg tpr: 0.89382, Avg fpr: 0.03718, total FA: 5163

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.24759 | acc=0.9570 | tpr=0.8673 | fpr=0.0414 | 4534.1 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.25388 | acc=0.9568 | tpr=0.9062 | fpr=0.0422 | 7799.1 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.25815 | acc=0.9560 | tpr=0.9135 | fpr=0.0433 | 8291.3 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.25980 | acc=0.9563 | tpr=0.9224 | fpr=0.0431 | 8700.0 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.26226 | acc=0.9560 | tpr=0.9197 | fpr=0.0434 | 8005.6 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.26475 | acc=0.9556 | tpr=0.9178 | fpr=0.0437 | 7851.8 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.26508 | acc=0.9555 | tpr=0.9161 | fpr=0.0438 | 7924.8 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.26547 | acc=0.9553 | tpr=0.9114 | fpr=0.0439 | 7878.6 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.26637 | acc=0.9550 | tpr=0.9060 | fpr=0.0441 | 7970.8 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.26747 | acc=0.9550 | tpr=0.9084 | fpr=0.0442 | 7861.3 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.26647 | acc=0.9551 | tpr=0.9077 | fpr=0.0440 | 10308.5 samples/s | 40.3 steps/s
Avg test loss: 0.26613, Avg test acc: 0.95511, Avg tpr: 0.90689, Avg fpr: 0.04401, total FA: 6111

server round 7/50

clients selected: [0 2 3 5 6]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=39.0] | Loss=0.08176 | Reg=0.00180 | acc=0.9531 | L2-Norm=13.428 | L2-Norm(final)=8.487 | 3198.9 samples/s | 50.0 steps/s
[Step=8050 Epoch=39.3] | Loss=0.10493 | Reg=0.00180 | acc=0.8906 | L2-Norm=13.431 | L2-Norm(final)=8.535 | 4884.8 samples/s | 76.3 steps/s
[Step=8100 Epoch=39.5] | Loss=0.10429 | Reg=0.00180 | acc=0.8594 | L2-Norm=13.431 | L2-Norm(final)=8.613 | 5517.7 samples/s | 86.2 steps/s
[Step=8150 Epoch=39.7] | Loss=0.10648 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.431 | L2-Norm(final)=8.688 | 5385.5 samples/s | 84.1 steps/s
[Step=8200 Epoch=40.0] | Loss=0.10533 | Reg=0.00180 | acc=0.9531 | L2-Norm=13.431 | L2-Norm(final)=8.763 | 8492.3 samples/s | 132.7 steps/s
[Step=8250 Epoch=40.2] | Loss=0.10467 | Reg=0.00180 | acc=0.9375 | L2-Norm=13.431 | L2-Norm(final)=8.840 | 1458.8 samples/s | 22.8 steps/s
[Step=8300 Epoch=40.5] | Loss=0.10377 | Reg=0.00180 | acc=0.9062 | L2-Norm=13.431 | L2-Norm(final)=8.917 | 5543.7 samples/s | 86.6 steps/s
[Step=8350 Epoch=40.7] | Loss=0.10392 | Reg=0.00180 | acc=0.9375 | L2-Norm=13.432 | L2-Norm(final)=8.991 | 5482.0 samples/s | 85.7 steps/s
[Step=8400 Epoch=41.0] | Loss=0.10377 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.432 | L2-Norm(final)=9.062 | 7476.1 samples/s | 116.8 steps/s
[Step=8450 Epoch=41.2] | Loss=0.10389 | Reg=0.00180 | acc=0.9062 | L2-Norm=13.432 | L2-Norm(final)=9.132 | 1501.4 samples/s | 23.5 steps/s
[Step=8500 Epoch=41.4] | Loss=0.10330 | Reg=0.00180 | acc=0.9219 | L2-Norm=13.432 | L2-Norm(final)=9.199 | 5475.2 samples/s | 85.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=41.5] | Loss=0.08028 | Reg=0.00180 | acc=0.9375 | L2-Norm=13.432 | L2-Norm(final)=9.871 | 3203.1 samples/s | 50.0 steps/s
[Step=8550 Epoch=41.7] | Loss=0.08410 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.663 | L2-Norm(final)=9.889 | 4201.8 samples/s | 65.7 steps/s
[Step=8600 Epoch=41.9] | Loss=0.08622 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.858 | L2-Norm(final)=9.866 | 4689.7 samples/s | 73.3 steps/s
[Step=8650 Epoch=42.2] | Loss=0.08170 | Reg=0.00196 | acc=0.9219 | L2-Norm=13.984 | L2-Norm(final)=9.846 | 4680.8 samples/s | 73.1 steps/s
[Step=8700 Epoch=42.4] | Loss=0.07633 | Reg=0.00198 | acc=0.9219 | L2-Norm=14.083 | L2-Norm(final)=9.834 | 6834.4 samples/s | 106.8 steps/s
[Step=8750 Epoch=42.7] | Loss=0.06904 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.162 | L2-Norm(final)=9.826 | 1407.9 samples/s | 22.0 steps/s
[Step=8800 Epoch=42.9] | Loss=0.06375 | Reg=0.00203 | acc=0.9531 | L2-Norm=14.229 | L2-Norm(final)=9.822 | 4676.4 samples/s | 73.1 steps/s
[Step=8850 Epoch=43.2] | Loss=0.05990 | Reg=0.00204 | acc=0.9375 | L2-Norm=14.289 | L2-Norm(final)=9.819 | 4693.1 samples/s | 73.3 steps/s
[Step=8900 Epoch=43.4] | Loss=0.05764 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.344 | L2-Norm(final)=9.816 | 6108.9 samples/s | 95.5 steps/s
[Step=8950 Epoch=43.6] | Loss=0.05377 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.394 | L2-Norm(final)=9.814 | 1459.3 samples/s | 22.8 steps/s
[Step=9000 Epoch=43.9] | Loss=0.05167 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.438 | L2-Norm(final)=9.812 | 4694.4 samples/s | 73.3 steps/s
[Step=9050 Epoch=44.1] | Loss=0.05010 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.481 | L2-Norm(final)=9.809 | 4671.6 samples/s | 73.0 steps/s
[Step=9100 Epoch=44.4] | Loss=0.04871 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.522 | L2-Norm(final)=9.807 | 5674.8 samples/s | 88.7 steps/s
[Step=9150 Epoch=44.6] | Loss=0.04693 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.562 | L2-Norm(final)=9.805 | 1479.8 samples/s | 23.1 steps/s
[Step=9200 Epoch=44.9] | Loss=0.04542 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.599 | L2-Norm(final)=9.804 | 4705.8 samples/s | 73.5 steps/s
[Step=9250 Epoch=45.1] | Loss=0.04413 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.636 | L2-Norm(final)=9.803 | 4736.0 samples/s | 74.0 steps/s
[Step=9300 Epoch=45.3] | Loss=0.04285 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.672 | L2-Norm(final)=9.803 | 5123.3 samples/s | 80.1 steps/s
[Step=9350 Epoch=45.6] | Loss=0.04252 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.708 | L2-Norm(final)=9.802 | 1500.1 samples/s | 23.4 steps/s
[Step=9400 Epoch=45.8] | Loss=0.04182 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.749 | L2-Norm(final)=9.800 | 4687.9 samples/s | 73.2 steps/s
[Step=9450 Epoch=46.1] | Loss=0.04129 | Reg=0.00219 | acc=0.9375 | L2-Norm=14.790 | L2-Norm(final)=9.797 | 4700.9 samples/s | 73.5 steps/s
[Step=9500 Epoch=46.3] | Loss=0.04060 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.829 | L2-Norm(final)=9.795 | 4843.2 samples/s | 75.7 steps/s
[Step=9550 Epoch=46.6] | Loss=0.03946 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.868 | L2-Norm(final)=9.793 | 1532.7 samples/s | 23.9 steps/s
[Step=9600 Epoch=46.8] | Loss=0.03825 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.904 | L2-Norm(final)=9.792 | 4714.6 samples/s | 73.7 steps/s
[Step=9650 Epoch=47.1] | Loss=0.03742 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.936 | L2-Norm(final)=9.791 | 4640.9 samples/s | 72.5 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03668 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.967 | L2-Norm(final)=9.790 | 4701.5 samples/s | 73.5 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03580 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.996 | L2-Norm(final)=9.789 | 1545.1 samples/s | 24.1 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03482 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.022 | L2-Norm(final)=9.788 | 4734.1 samples/s | 74.0 steps/s
[Step=9850 Epoch=48.0] | Loss=0.03407 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.047 | L2-Norm(final)=9.788 | 4675.4 samples/s | 73.1 steps/s
[Step=9900 Epoch=48.3] | Loss=0.03321 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.070 | L2-Norm(final)=9.787 | 4644.5 samples/s | 72.6 steps/s
[Step=9950 Epoch=48.5] | Loss=0.03250 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.092 | L2-Norm(final)=9.787 | 1543.0 samples/s | 24.1 steps/s
[Step=10000 Epoch=48.8] | Loss=0.03189 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.112 | L2-Norm(final)=9.786 | 4780.4 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step10000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 9.7] | Loss=0.19010 | Reg=0.00180 | acc=0.8281 | L2-Norm=13.428 | L2-Norm(final)=5.001 | 3148.8 samples/s | 49.2 steps/s
[Step=2050 Epoch=10.0] | Loss=0.17165 | Reg=0.00180 | acc=0.8906 | L2-Norm=13.432 | L2-Norm(final)=4.958 | 5102.5 samples/s | 79.7 steps/s
[Step=2100 Epoch=10.2] | Loss=0.15730 | Reg=0.00180 | acc=0.8438 | L2-Norm=13.433 | L2-Norm(final)=5.018 | 5335.4 samples/s | 83.4 steps/s
[Step=2150 Epoch=10.5] | Loss=0.15083 | Reg=0.00180 | acc=0.9062 | L2-Norm=13.434 | L2-Norm(final)=5.122 | 5479.7 samples/s | 85.6 steps/s
[Step=2200 Epoch=10.7] | Loss=0.14600 | Reg=0.00180 | acc=0.9531 | L2-Norm=13.434 | L2-Norm(final)=5.236 | 8528.5 samples/s | 133.3 steps/s
[Step=2250 Epoch=11.0] | Loss=0.14291 | Reg=0.00180 | acc=0.9531 | L2-Norm=13.434 | L2-Norm(final)=5.347 | 1499.2 samples/s | 23.4 steps/s
[Step=2300 Epoch=11.2] | Loss=0.13987 | Reg=0.00180 | acc=0.9062 | L2-Norm=13.434 | L2-Norm(final)=5.459 | 5424.3 samples/s | 84.8 steps/s
[Step=2350 Epoch=11.5] | Loss=0.13816 | Reg=0.00180 | acc=0.9062 | L2-Norm=13.434 | L2-Norm(final)=5.567 | 5574.8 samples/s | 87.1 steps/s
[Step=2400 Epoch=11.7] | Loss=0.13643 | Reg=0.00180 | acc=0.8594 | L2-Norm=13.434 | L2-Norm(final)=5.671 | 7564.9 samples/s | 118.2 steps/s
[Step=2450 Epoch=11.9] | Loss=0.13446 | Reg=0.00180 | acc=0.8906 | L2-Norm=13.434 | L2-Norm(final)=5.772 | 1512.8 samples/s | 23.6 steps/s
[Step=2500 Epoch=12.2] | Loss=0.13347 | Reg=0.00180 | acc=0.8750 | L2-Norm=13.434 | L2-Norm(final)=5.869 | 5375.7 samples/s | 84.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.10083 | Reg=0.00180 | acc=0.9219 | L2-Norm=13.434 | L2-Norm(final)=6.819 | 3207.4 samples/s | 50.1 steps/s
[Step=2550 Epoch=12.4] | Loss=0.09383 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.638 | L2-Norm(final)=6.848 | 4316.7 samples/s | 67.4 steps/s
[Step=2600 Epoch=12.7] | Loss=0.08827 | Reg=0.00190 | acc=0.9062 | L2-Norm=13.784 | L2-Norm(final)=6.832 | 4731.1 samples/s | 73.9 steps/s
[Step=2650 Epoch=12.9] | Loss=0.08270 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.881 | L2-Norm(final)=6.823 | 4711.7 samples/s | 73.6 steps/s
[Step=2700 Epoch=13.2] | Loss=0.08111 | Reg=0.00195 | acc=0.8906 | L2-Norm=13.962 | L2-Norm(final)=6.818 | 6760.7 samples/s | 105.6 steps/s
[Step=2750 Epoch=13.4] | Loss=0.07555 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.040 | L2-Norm(final)=6.814 | 1412.8 samples/s | 22.1 steps/s
[Step=2800 Epoch=13.6] | Loss=0.06975 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.111 | L2-Norm(final)=6.813 | 4710.0 samples/s | 73.6 steps/s
[Step=2850 Epoch=13.9] | Loss=0.06645 | Reg=0.00201 | acc=0.9219 | L2-Norm=14.174 | L2-Norm(final)=6.813 | 4674.7 samples/s | 73.0 steps/s
[Step=2900 Epoch=14.1] | Loss=0.06425 | Reg=0.00203 | acc=0.9375 | L2-Norm=14.236 | L2-Norm(final)=6.812 | 6162.1 samples/s | 96.3 steps/s
[Step=2950 Epoch=14.4] | Loss=0.06023 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.293 | L2-Norm(final)=6.812 | 1427.8 samples/s | 22.3 steps/s
[Step=3000 Epoch=14.6] | Loss=0.05686 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.344 | L2-Norm(final)=6.813 | 4773.9 samples/s | 74.6 steps/s
[Step=3050 Epoch=14.9] | Loss=0.05468 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.392 | L2-Norm(final)=6.814 | 4703.7 samples/s | 73.5 steps/s
[Step=3100 Epoch=15.1] | Loss=0.05240 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.437 | L2-Norm(final)=6.814 | 5507.0 samples/s | 86.0 steps/s
[Step=3150 Epoch=15.3] | Loss=0.05077 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.482 | L2-Norm(final)=6.816 | 1468.2 samples/s | 22.9 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04851 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.526 | L2-Norm(final)=6.817 | 4702.6 samples/s | 73.5 steps/s
[Step=3250 Epoch=15.8] | Loss=0.04693 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.567 | L2-Norm(final)=6.820 | 4654.4 samples/s | 72.7 steps/s
[Step=3300 Epoch=16.1] | Loss=0.04581 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.605 | L2-Norm(final)=6.822 | 5209.0 samples/s | 81.4 steps/s
[Step=3350 Epoch=16.3] | Loss=0.04469 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.642 | L2-Norm(final)=6.824 | 1490.5 samples/s | 23.3 steps/s
[Step=3400 Epoch=16.6] | Loss=0.04340 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.678 | L2-Norm(final)=6.825 | 4688.3 samples/s | 73.3 steps/s
[Step=3450 Epoch=16.8] | Loss=0.04223 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.713 | L2-Norm(final)=6.827 | 4685.4 samples/s | 73.2 steps/s
[Step=3500 Epoch=17.1] | Loss=0.04136 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.746 | L2-Norm(final)=6.830 | 4810.1 samples/s | 75.2 steps/s
[Step=3550 Epoch=17.3] | Loss=0.04036 | Reg=0.00219 | acc=0.9375 | L2-Norm=14.780 | L2-Norm(final)=6.832 | 1553.6 samples/s | 24.3 steps/s
[Step=3600 Epoch=17.5] | Loss=0.03956 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.813 | L2-Norm(final)=6.834 | 4650.9 samples/s | 72.7 steps/s
[Step=3650 Epoch=17.8] | Loss=0.03859 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.844 | L2-Norm(final)=6.836 | 4721.9 samples/s | 73.8 steps/s
[Step=3700 Epoch=18.0] | Loss=0.03777 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.875 | L2-Norm(final)=6.838 | 4648.3 samples/s | 72.6 steps/s
[Step=3750 Epoch=18.3] | Loss=0.03694 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.904 | L2-Norm(final)=6.840 | 1586.2 samples/s | 24.8 steps/s
[Step=3800 Epoch=18.5] | Loss=0.03607 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.932 | L2-Norm(final)=6.842 | 4697.2 samples/s | 73.4 steps/s
[Step=3850 Epoch=18.8] | Loss=0.03524 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.959 | L2-Norm(final)=6.844 | 4693.6 samples/s | 73.3 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03460 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.985 | L2-Norm(final)=6.845 | 4692.6 samples/s | 73.3 steps/s
[Step=3950 Epoch=19.2] | Loss=0.03392 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.011 | L2-Norm(final)=6.847 | 1568.1 samples/s | 24.5 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03329 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.036 | L2-Norm(final)=6.849 | 4702.4 samples/s | 73.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_2/client_state-step4000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=48.8] | Loss=0.12125 | Reg=0.00180 | acc=0.9219 | L2-Norm=13.428 | L2-Norm(final)=9.349 | 3210.6 samples/s | 50.2 steps/s
[Step=10050 Epoch=49.0] | Loss=0.11520 | Reg=0.00181 | acc=0.8906 | L2-Norm=13.435 | L2-Norm(final)=9.389 | 4861.8 samples/s | 76.0 steps/s
[Step=10100 Epoch=49.3] | Loss=0.11011 | Reg=0.00181 | acc=0.9531 | L2-Norm=13.437 | L2-Norm(final)=9.469 | 5615.6 samples/s | 87.7 steps/s
[Step=10150 Epoch=49.5] | Loss=0.10915 | Reg=0.00181 | acc=0.8594 | L2-Norm=13.437 | L2-Norm(final)=9.552 | 5209.4 samples/s | 81.4 steps/s
[Step=10200 Epoch=49.7] | Loss=0.10727 | Reg=0.00181 | acc=0.8594 | L2-Norm=13.437 | L2-Norm(final)=9.634 | 8599.1 samples/s | 134.4 steps/s
[Step=10250 Epoch=50.0] | Loss=0.10619 | Reg=0.00181 | acc=0.8906 | L2-Norm=13.438 | L2-Norm(final)=9.718 | 1481.0 samples/s | 23.1 steps/s
[Step=10300 Epoch=50.2] | Loss=0.10616 | Reg=0.00181 | acc=0.9375 | L2-Norm=13.438 | L2-Norm(final)=9.796 | 5480.7 samples/s | 85.6 steps/s
[Step=10350 Epoch=50.5] | Loss=0.10606 | Reg=0.00181 | acc=0.8750 | L2-Norm=13.438 | L2-Norm(final)=9.872 | 5496.5 samples/s | 85.9 steps/s
[Step=10400 Epoch=50.7] | Loss=0.10515 | Reg=0.00181 | acc=0.8906 | L2-Norm=13.438 | L2-Norm(final)=9.944 | 7548.5 samples/s | 117.9 steps/s
[Step=10450 Epoch=51.0] | Loss=0.10430 | Reg=0.00181 | acc=0.8750 | L2-Norm=13.438 | L2-Norm(final)=10.014 | 1553.0 samples/s | 24.3 steps/s
[Step=10500 Epoch=51.2] | Loss=0.10463 | Reg=0.00181 | acc=0.9219 | L2-Norm=13.438 | L2-Norm(final)=10.080 | 5417.6 samples/s | 84.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=51.2] | Loss=0.08846 | Reg=0.00181 | acc=0.9375 | L2-Norm=13.438 | L2-Norm(final)=10.715 | 3229.4 samples/s | 50.5 steps/s
[Step=10550 Epoch=51.4] | Loss=0.10406 | Reg=0.00189 | acc=0.8594 | L2-Norm=13.742 | L2-Norm(final)=10.697 | 4200.4 samples/s | 65.6 steps/s
[Step=10600 Epoch=51.7] | Loss=0.09252 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.049 | L2-Norm(final)=10.666 | 4617.8 samples/s | 72.2 steps/s
[Step=10650 Epoch=51.9] | Loss=0.08503 | Reg=0.00202 | acc=0.9688 | L2-Norm=14.224 | L2-Norm(final)=10.648 | 4769.0 samples/s | 74.5 steps/s
[Step=10700 Epoch=52.2] | Loss=0.08072 | Reg=0.00206 | acc=0.9375 | L2-Norm=14.344 | L2-Norm(final)=10.634 | 6594.3 samples/s | 103.0 steps/s
[Step=10750 Epoch=52.4] | Loss=0.07209 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.441 | L2-Norm(final)=10.628 | 1429.7 samples/s | 22.3 steps/s
[Step=10800 Epoch=52.7] | Loss=0.06591 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.518 | L2-Norm(final)=10.624 | 4742.5 samples/s | 74.1 steps/s
[Step=10850 Epoch=52.9] | Loss=0.06324 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.585 | L2-Norm(final)=10.618 | 4723.2 samples/s | 73.8 steps/s
[Step=10900 Epoch=53.2] | Loss=0.06124 | Reg=0.00215 | acc=0.9531 | L2-Norm=14.649 | L2-Norm(final)=10.612 | 6031.8 samples/s | 94.2 steps/s
[Step=10950 Epoch=53.4] | Loss=0.05737 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.707 | L2-Norm(final)=10.608 | 1474.4 samples/s | 23.0 steps/s
[Step=11000 Epoch=53.6] | Loss=0.05434 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.758 | L2-Norm(final)=10.606 | 4700.2 samples/s | 73.4 steps/s
[Step=11050 Epoch=53.9] | Loss=0.05218 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.804 | L2-Norm(final)=10.603 | 4722.1 samples/s | 73.8 steps/s
[Step=11100 Epoch=54.1] | Loss=0.05062 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.847 | L2-Norm(final)=10.601 | 5567.4 samples/s | 87.0 steps/s
[Step=11150 Epoch=54.4] | Loss=0.04871 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.887 | L2-Norm(final)=10.599 | 1473.5 samples/s | 23.0 steps/s
[Step=11200 Epoch=54.6] | Loss=0.04678 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.925 | L2-Norm(final)=10.597 | 4755.8 samples/s | 74.3 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04545 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.961 | L2-Norm(final)=10.596 | 4681.3 samples/s | 73.1 steps/s
[Step=11300 Epoch=55.1] | Loss=0.04408 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.997 | L2-Norm(final)=10.595 | 5181.8 samples/s | 81.0 steps/s
[Step=11350 Epoch=55.3] | Loss=0.04310 | Reg=0.00226 | acc=0.9531 | L2-Norm=15.032 | L2-Norm(final)=10.593 | 1538.4 samples/s | 24.0 steps/s
[Step=11400 Epoch=55.6] | Loss=0.04164 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.065 | L2-Norm(final)=10.592 | 4682.5 samples/s | 73.2 steps/s
[Step=11450 Epoch=55.8] | Loss=0.04041 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.096 | L2-Norm(final)=10.591 | 4706.8 samples/s | 73.5 steps/s
[Step=11500 Epoch=56.1] | Loss=0.03925 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.126 | L2-Norm(final)=10.590 | 4810.3 samples/s | 75.2 steps/s
[Step=11550 Epoch=56.3] | Loss=0.03841 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.155 | L2-Norm(final)=10.589 | 1521.6 samples/s | 23.8 steps/s
[Step=11600 Epoch=56.6] | Loss=0.03725 | Reg=0.00231 | acc=0.9531 | L2-Norm=15.182 | L2-Norm(final)=10.589 | 4694.5 samples/s | 73.4 steps/s
[Step=11650 Epoch=56.8] | Loss=0.03648 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.207 | L2-Norm(final)=10.588 | 4723.4 samples/s | 73.8 steps/s
[Step=11700 Epoch=57.1] | Loss=0.03560 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.231 | L2-Norm(final)=10.588 | 4723.7 samples/s | 73.8 steps/s
[Step=11750 Epoch=57.3] | Loss=0.03495 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.255 | L2-Norm(final)=10.587 | 1544.7 samples/s | 24.1 steps/s
[Step=11800 Epoch=57.5] | Loss=0.03417 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.278 | L2-Norm(final)=10.586 | 4675.4 samples/s | 73.1 steps/s
[Step=11850 Epoch=57.8] | Loss=0.03355 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.301 | L2-Norm(final)=10.585 | 4664.5 samples/s | 72.9 steps/s
[Step=11900 Epoch=58.0] | Loss=0.03281 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.323 | L2-Norm(final)=10.584 | 4716.7 samples/s | 73.7 steps/s
[Step=11950 Epoch=58.3] | Loss=0.03200 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.344 | L2-Norm(final)=10.584 | 1571.6 samples/s | 24.6 steps/s
[Step=12000 Epoch=58.5] | Loss=0.03126 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.364 | L2-Norm(final)=10.584 | 4679.0 samples/s | 73.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step12000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=94.8] | Loss=0.00535 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.428 | L2-Norm(final)=11.376 | 3291.0 samples/s | 51.4 steps/s
[Step=10050 Epoch=95.2] | Loss=0.01570 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=11.444 | 4565.4 samples/s | 71.3 steps/s
[Step=10100 Epoch=95.7] | Loss=0.01691 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.416 | L2-Norm(final)=11.536 | 7924.2 samples/s | 123.8 steps/s
[Step=10150 Epoch=96.2] | Loss=0.01698 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.415 | L2-Norm(final)=11.633 | 1427.7 samples/s | 22.3 steps/s
[Step=10200 Epoch=96.7] | Loss=0.01741 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=11.728 | 7278.5 samples/s | 113.7 steps/s
[Step=10250 Epoch=97.1] | Loss=0.01680 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=11.817 | 1484.5 samples/s | 23.2 steps/s
[Step=10300 Epoch=97.6] | Loss=0.01678 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=11.906 | 6196.3 samples/s | 96.8 steps/s
[Step=10350 Epoch=98.1] | Loss=0.01658 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.415 | L2-Norm(final)=11.992 | 1505.4 samples/s | 23.5 steps/s
[Step=10400 Epoch=98.5] | Loss=0.01645 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=12.076 | 5873.9 samples/s | 91.8 steps/s
[Step=10450 Epoch=99.0] | Loss=0.01610 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.415 | L2-Norm(final)=12.159 | 1576.9 samples/s | 24.6 steps/s
[Step=10500 Epoch=99.5] | Loss=0.01604 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=12.239 | 5255.8 samples/s | 82.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=99.5] | Loss=0.01074 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.414 | L2-Norm(final)=13.040 | 3128.8 samples/s | 48.9 steps/s
[Step=10550 Epoch=100.0] | Loss=0.02325 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.935 | L2-Norm(final)=13.040 | 3997.0 samples/s | 62.5 steps/s
[Step=10600 Epoch=100.4] | Loss=0.01908 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.321 | L2-Norm(final)=12.997 | 6517.3 samples/s | 101.8 steps/s
[Step=10650 Epoch=100.9] | Loss=0.01405 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.465 | L2-Norm(final)=12.977 | 1398.7 samples/s | 21.9 steps/s
[Step=10700 Epoch=101.4] | Loss=0.01124 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.521 | L2-Norm(final)=12.969 | 5810.2 samples/s | 90.8 steps/s
[Step=10750 Epoch=101.9] | Loss=0.00909 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.541 | L2-Norm(final)=12.965 | 1421.1 samples/s | 22.2 steps/s
[Step=10800 Epoch=102.3] | Loss=0.00758 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.537 | L2-Norm(final)=12.963 | 5299.7 samples/s | 82.8 steps/s
[Step=10850 Epoch=102.8] | Loss=0.00650 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.519 | L2-Norm(final)=12.962 | 1459.2 samples/s | 22.8 steps/s
[Step=10900 Epoch=103.3] | Loss=0.00569 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.493 | L2-Norm(final)=12.962 | 4904.4 samples/s | 76.6 steps/s
[Step=10950 Epoch=103.8] | Loss=0.00506 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.462 | L2-Norm(final)=12.962 | 1472.0 samples/s | 23.0 steps/s
[Step=11000 Epoch=104.2] | Loss=0.00456 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.428 | L2-Norm(final)=12.962 | 4579.0 samples/s | 71.5 steps/s
[Step=11050 Epoch=104.7] | Loss=0.00414 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.392 | L2-Norm(final)=12.962 | 1504.3 samples/s | 23.5 steps/s
[Step=11100 Epoch=105.2] | Loss=0.00380 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=12.962 | 4463.6 samples/s | 69.7 steps/s
[Step=11150 Epoch=105.7] | Loss=0.00351 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.318 | L2-Norm(final)=12.962 | 1524.7 samples/s | 23.8 steps/s
[Step=11200 Epoch=106.1] | Loss=0.00326 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.280 | L2-Norm(final)=12.963 | 4579.6 samples/s | 71.6 steps/s
[Step=11250 Epoch=106.6] | Loss=0.00304 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.241 | L2-Norm(final)=12.963 | 1572.1 samples/s | 24.6 steps/s
[Step=11300 Epoch=107.1] | Loss=0.00285 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.203 | L2-Norm(final)=12.963 | 4431.1 samples/s | 69.2 steps/s
[Step=11350 Epoch=107.6] | Loss=0.00268 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.165 | L2-Norm(final)=12.963 | 1618.4 samples/s | 25.3 steps/s
[Step=11400 Epoch=108.0] | Loss=0.00253 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.127 | L2-Norm(final)=12.964 | 3931.8 samples/s | 61.4 steps/s
[Step=11450 Epoch=108.5] | Loss=0.00240 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=12.964 | 6782.4 samples/s | 106.0 steps/s
[Step=11500 Epoch=109.0] | Loss=0.00228 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.051 | L2-Norm(final)=12.964 | 1370.0 samples/s | 21.4 steps/s
[Step=11550 Epoch=109.4] | Loss=0.00217 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.014 | L2-Norm(final)=12.964 | 5949.0 samples/s | 93.0 steps/s
[Step=11600 Epoch=109.9] | Loss=0.00207 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.976 | L2-Norm(final)=12.965 | 1424.1 samples/s | 22.3 steps/s
[Step=11650 Epoch=110.4] | Loss=0.00198 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.939 | L2-Norm(final)=12.965 | 5495.7 samples/s | 85.9 steps/s
[Step=11700 Epoch=110.9] | Loss=0.00190 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.902 | L2-Norm(final)=12.965 | 1422.4 samples/s | 22.2 steps/s
[Step=11750 Epoch=111.3] | Loss=0.00183 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.866 | L2-Norm(final)=12.966 | 5083.0 samples/s | 79.4 steps/s
[Step=11800 Epoch=111.8] | Loss=0.00176 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.830 | L2-Norm(final)=12.966 | 1468.5 samples/s | 22.9 steps/s
[Step=11850 Epoch=112.3] | Loss=0.00169 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.794 | L2-Norm(final)=12.966 | 4669.9 samples/s | 73.0 steps/s
[Step=11900 Epoch=112.8] | Loss=0.00163 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=12.967 | 1483.7 samples/s | 23.2 steps/s
[Step=11950 Epoch=113.2] | Loss=0.00157 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.722 | L2-Norm(final)=12.967 | 4438.4 samples/s | 69.3 steps/s
[Step=12000 Epoch=113.7] | Loss=0.00152 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.687 | L2-Norm(final)=12.967 | 1542.8 samples/s | 24.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step12000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.08516 | Reg=0.00180 | acc=0.9375 | L2-Norm=13.428 | L2-Norm(final)=7.264 | 3093.5 samples/s | 48.3 steps/s
[Step=4050 Epoch=38.5] | Loss=0.06994 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.418 | L2-Norm(final)=7.189 | 4848.1 samples/s | 75.8 steps/s
[Step=4100 Epoch=39.0] | Loss=0.05541 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=7.145 | 7625.8 samples/s | 119.2 steps/s
[Step=4150 Epoch=39.5] | Loss=0.04922 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.417 | L2-Norm(final)=7.133 | 1440.5 samples/s | 22.5 steps/s
[Step=4200 Epoch=40.0] | Loss=0.04462 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.417 | L2-Norm(final)=7.161 | 7087.3 samples/s | 110.7 steps/s
[Step=4250 Epoch=40.4] | Loss=0.04179 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.417 | L2-Norm(final)=7.208 | 1479.9 samples/s | 23.1 steps/s
[Step=4300 Epoch=40.9] | Loss=0.03965 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.416 | L2-Norm(final)=7.271 | 6501.1 samples/s | 101.6 steps/s
[Step=4350 Epoch=41.4] | Loss=0.03804 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.416 | L2-Norm(final)=7.343 | 1545.9 samples/s | 24.2 steps/s
[Step=4400 Epoch=41.9] | Loss=0.03650 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.416 | L2-Norm(final)=7.419 | 5885.5 samples/s | 92.0 steps/s
[Step=4450 Epoch=42.3] | Loss=0.03541 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.416 | L2-Norm(final)=7.498 | 1589.4 samples/s | 24.8 steps/s
[Step=4500 Epoch=42.8] | Loss=0.03431 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.416 | L2-Norm(final)=7.578 | 5382.3 samples/s | 84.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.8] | Loss=0.01287 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.416 | L2-Norm(final)=8.379 | 3074.1 samples/s | 48.0 steps/s
[Step=4550 Epoch=43.3] | Loss=0.01841 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.731 | L2-Norm(final)=8.406 | 4157.5 samples/s | 65.0 steps/s
[Step=4600 Epoch=43.8] | Loss=0.01748 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.025 | L2-Norm(final)=8.376 | 6520.8 samples/s | 101.9 steps/s
[Step=4650 Epoch=44.2] | Loss=0.01274 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.206 | L2-Norm(final)=8.361 | 1382.5 samples/s | 21.6 steps/s
[Step=4700 Epoch=44.7] | Loss=0.01010 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.301 | L2-Norm(final)=8.356 | 5952.3 samples/s | 93.0 steps/s
[Step=4750 Epoch=45.2] | Loss=0.00835 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.356 | L2-Norm(final)=8.354 | 1411.5 samples/s | 22.1 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00703 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.387 | L2-Norm(final)=8.354 | 5433.0 samples/s | 84.9 steps/s
[Step=4850 Epoch=46.1] | Loss=0.00603 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.399 | L2-Norm(final)=8.354 | 1458.1 samples/s | 22.8 steps/s
[Step=4900 Epoch=46.6] | Loss=0.00528 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.399 | L2-Norm(final)=8.354 | 4963.3 samples/s | 77.6 steps/s
[Step=4950 Epoch=47.1] | Loss=0.00469 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.390 | L2-Norm(final)=8.355 | 1477.0 samples/s | 23.1 steps/s
[Step=5000 Epoch=47.6] | Loss=0.00423 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.376 | L2-Norm(final)=8.355 | 4584.3 samples/s | 71.6 steps/s
[Step=5050 Epoch=48.0] | Loss=0.00384 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.358 | L2-Norm(final)=8.356 | 1540.7 samples/s | 24.1 steps/s
[Step=5100 Epoch=48.5] | Loss=0.00352 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.337 | L2-Norm(final)=8.356 | 4468.8 samples/s | 69.8 steps/s
[Step=5150 Epoch=49.0] | Loss=0.00325 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.314 | L2-Norm(final)=8.356 | 1519.7 samples/s | 23.7 steps/s
[Step=5200 Epoch=49.5] | Loss=0.00302 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.289 | L2-Norm(final)=8.357 | 4490.4 samples/s | 70.2 steps/s
[Step=5250 Epoch=49.9] | Loss=0.00282 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.263 | L2-Norm(final)=8.357 | 1503.8 samples/s | 23.5 steps/s
[Step=5300 Epoch=50.4] | Loss=0.00264 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.236 | L2-Norm(final)=8.358 | 4449.9 samples/s | 69.5 steps/s
[Step=5350 Epoch=50.9] | Loss=0.00249 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.209 | L2-Norm(final)=8.358 | 1532.7 samples/s | 23.9 steps/s
[Step=5400 Epoch=51.4] | Loss=0.00235 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.181 | L2-Norm(final)=8.358 | 4341.5 samples/s | 67.8 steps/s
[Step=5450 Epoch=51.8] | Loss=0.00223 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.152 | L2-Norm(final)=8.359 | 6709.2 samples/s | 104.8 steps/s
[Step=5500 Epoch=52.3] | Loss=0.00212 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=8.359 | 1370.4 samples/s | 21.4 steps/s
[Step=5550 Epoch=52.8] | Loss=0.00202 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.094 | L2-Norm(final)=8.360 | 6092.5 samples/s | 95.2 steps/s
[Step=5600 Epoch=53.3] | Loss=0.00192 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.064 | L2-Norm(final)=8.360 | 1413.5 samples/s | 22.1 steps/s
[Step=5650 Epoch=53.7] | Loss=0.00184 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.034 | L2-Norm(final)=8.360 | 5584.0 samples/s | 87.2 steps/s
[Step=5700 Epoch=54.2] | Loss=0.00176 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.004 | L2-Norm(final)=8.361 | 1432.4 samples/s | 22.4 steps/s
[Step=5750 Epoch=54.7] | Loss=0.00169 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.974 | L2-Norm(final)=8.361 | 4992.2 samples/s | 78.0 steps/s
[Step=5800 Epoch=55.2] | Loss=0.00163 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.944 | L2-Norm(final)=8.361 | 1455.9 samples/s | 22.7 steps/s
[Step=5850 Epoch=55.6] | Loss=0.00157 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.914 | L2-Norm(final)=8.362 | 4743.2 samples/s | 74.1 steps/s
[Step=5900 Epoch=56.1] | Loss=0.00151 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.884 | L2-Norm(final)=8.362 | 1496.2 samples/s | 23.4 steps/s
[Step=5950 Epoch=56.6] | Loss=0.00146 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.853 | L2-Norm(final)=8.362 | 4502.6 samples/s | 70.4 steps/s
[Step=6000 Epoch=57.1] | Loss=0.00141 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.823 | L2-Norm(final)=8.363 | 1521.5 samples/s | 23.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.14210 | acc=0.9389 | tpr=0.9526 | fpr=0.0909 | 4667.9 samples/s | 18.2 steps/s
Avg test loss: 0.14568, Avg test acc: 0.93677, Avg tpr: 0.95098, Avg fpr: 0.09448, total FA: 737

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14372 | acc=0.9259 | tpr=0.9332 | fpr=0.0899 | 4439.2 samples/s | 17.3 steps/s
Avg test loss: 0.14575, Avg test acc: 0.92427, Avg tpr: 0.93082, Avg fpr: 0.09012, total FA: 703

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.14190 | acc=0.9352 | tpr=0.9533 | fpr=0.1043 | 4515.5 samples/s | 17.6 steps/s
Avg test loss: 0.14511, Avg test acc: 0.93445, Avg tpr: 0.95279, Avg fpr: 0.10588, total FA: 826

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.14977 | acc=0.9390 | tpr=0.9611 | fpr=0.1090 | 4839.3 samples/s | 18.9 steps/s
Avg test loss: 0.15945, Avg test acc: 0.93433, Avg tpr: 0.95833, Avg fpr: 0.11845, total FA: 924

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.13553 | acc=0.9330 | tpr=0.9469 | fpr=0.0974 | 4718.9 samples/s | 18.4 steps/s
Avg test loss: 0.13614, Avg test acc: 0.93249, Avg tpr: 0.94579, Avg fpr: 0.09678, total FA: 755

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.50966 | acc=0.3161 | tpr=0.0035 | fpr=0.0052 | 4783.7 samples/s | 18.7 steps/s
Avg test loss: 4.53322, Avg test acc: 0.31377, Avg tpr: 0.00414, Avg fpr: 0.00526, total FA: 41

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.12240 | acc=0.3212 | tpr=0.0226 | fpr=0.0305 | 4683.7 samples/s | 18.3 steps/s
Avg test loss: 4.14503, Avg test acc: 0.31958, Avg tpr: 0.02273, Avg fpr: 0.02756, total FA: 215

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.10127 | acc=0.3223 | tpr=0.0430 | fpr=0.0714 | 4446.0 samples/s | 17.4 steps/s
Avg test loss: 4.12030, Avg test acc: 0.32006, Avg tpr: 0.04237, Avg fpr: 0.06922, total FA: 540

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.59891 | acc=0.3179 | tpr=0.0275 | fpr=0.0515 | 4697.8 samples/s | 18.4 steps/s
Avg test loss: 4.62530, Avg test acc: 0.31657, Avg tpr: 0.02827, Avg fpr: 0.04935, total FA: 385

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.18461 | acc=0.3141 | tpr=0.0132 | fpr=0.0327 | 4760.3 samples/s | 18.6 steps/s
Avg test loss: 5.20267, Avg test acc: 0.31341, Avg tpr: 0.01539, Avg fpr: 0.03115, total FA: 243

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.05494 | acc=0.1245 | tpr=0.8540 | fpr=0.8886 | 4566.0 samples/s | 17.8 steps/s
[Step= 100] | Loss=6.03639 | acc=0.1252 | tpr=0.8422 | fpr=0.8881 | 7718.8 samples/s | 30.2 steps/s
[Step= 150] | Loss=6.04913 | acc=0.1258 | tpr=0.8415 | fpr=0.8874 | 8074.7 samples/s | 31.5 steps/s
[Step= 200] | Loss=6.03523 | acc=0.1257 | tpr=0.8415 | fpr=0.8873 | 8161.4 samples/s | 31.9 steps/s
[Step= 250] | Loss=6.03936 | acc=0.1257 | tpr=0.8332 | fpr=0.8872 | 8257.8 samples/s | 32.3 steps/s
[Step= 300] | Loss=6.04245 | acc=0.1263 | tpr=0.8385 | fpr=0.8867 | 7755.7 samples/s | 30.3 steps/s
[Step= 350] | Loss=6.05114 | acc=0.1259 | tpr=0.8359 | fpr=0.8870 | 7676.0 samples/s | 30.0 steps/s
[Step= 400] | Loss=6.05340 | acc=0.1259 | tpr=0.8293 | fpr=0.8868 | 8051.2 samples/s | 31.5 steps/s
[Step= 450] | Loss=6.05423 | acc=0.1254 | tpr=0.8286 | fpr=0.8874 | 7810.6 samples/s | 30.5 steps/s
[Step= 500] | Loss=6.05507 | acc=0.1252 | tpr=0.8295 | fpr=0.8875 | 8026.4 samples/s | 31.4 steps/s
[Step= 550] | Loss=6.05365 | acc=0.1255 | tpr=0.8329 | fpr=0.8873 | 11255.6 samples/s | 44.0 steps/s
Avg test loss: 6.05384, Avg test acc: 0.12543, Avg tpr: 0.83241, Avg fpr: 0.88742, total FA: 123217

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.05026 | acc=0.1929 | tpr=0.7257 | fpr=0.8167 | 4779.1 samples/s | 18.7 steps/s
[Step= 100] | Loss=4.04745 | acc=0.1934 | tpr=0.7249 | fpr=0.8165 | 7045.1 samples/s | 27.5 steps/s
[Step= 150] | Loss=4.03826 | acc=0.1956 | tpr=0.7493 | fpr=0.8146 | 8435.9 samples/s | 33.0 steps/s
[Step= 200] | Loss=4.02988 | acc=0.1969 | tpr=0.7574 | fpr=0.8133 | 8309.8 samples/s | 32.5 steps/s
[Step= 250] | Loss=4.02709 | acc=0.1982 | tpr=0.7520 | fpr=0.8119 | 7847.5 samples/s | 30.7 steps/s
[Step= 300] | Loss=4.02660 | acc=0.1979 | tpr=0.7520 | fpr=0.8122 | 7701.5 samples/s | 30.1 steps/s
[Step= 350] | Loss=4.02252 | acc=0.1977 | tpr=0.7489 | fpr=0.8123 | 7390.7 samples/s | 28.9 steps/s
[Step= 400] | Loss=4.02084 | acc=0.1968 | tpr=0.7423 | fpr=0.8131 | 8051.4 samples/s | 31.5 steps/s
[Step= 450] | Loss=4.02146 | acc=0.1962 | tpr=0.7347 | fpr=0.8135 | 7879.5 samples/s | 30.8 steps/s
[Step= 500] | Loss=4.02252 | acc=0.1964 | tpr=0.7304 | fpr=0.8133 | 8011.6 samples/s | 31.3 steps/s
[Step= 550] | Loss=4.01864 | acc=0.1967 | tpr=0.7330 | fpr=0.8131 | 11762.7 samples/s | 45.9 steps/s
Avg test loss: 4.02036, Avg test acc: 0.19655, Avg tpr: 0.73296, Avg fpr: 0.81321, total FA: 112912

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.81440 | acc=0.1557 | tpr=0.8673 | fpr=0.8571 | 4754.0 samples/s | 18.6 steps/s
[Step= 100] | Loss=4.79084 | acc=0.1573 | tpr=0.8422 | fpr=0.8555 | 7955.4 samples/s | 31.1 steps/s
[Step= 150] | Loss=4.79254 | acc=0.1579 | tpr=0.8559 | fpr=0.8550 | 7417.9 samples/s | 29.0 steps/s
[Step= 200] | Loss=4.77531 | acc=0.1579 | tpr=0.8546 | fpr=0.8548 | 8026.7 samples/s | 31.4 steps/s
[Step= 250] | Loss=4.76951 | acc=0.1592 | tpr=0.8515 | fpr=0.8534 | 7639.1 samples/s | 29.8 steps/s
[Step= 300] | Loss=4.76695 | acc=0.1593 | tpr=0.8524 | fpr=0.8534 | 8372.6 samples/s | 32.7 steps/s
[Step= 350] | Loss=4.77000 | acc=0.1592 | tpr=0.8541 | fpr=0.8535 | 7413.0 samples/s | 29.0 steps/s
[Step= 400] | Loss=4.77175 | acc=0.1591 | tpr=0.8556 | fpr=0.8536 | 7688.9 samples/s | 30.0 steps/s
[Step= 450] | Loss=4.76988 | acc=0.1589 | tpr=0.8505 | fpr=0.8537 | 8268.1 samples/s | 32.3 steps/s
[Step= 500] | Loss=4.77227 | acc=0.1590 | tpr=0.8480 | fpr=0.8535 | 8052.3 samples/s | 31.5 steps/s
[Step= 550] | Loss=4.77279 | acc=0.1591 | tpr=0.8512 | fpr=0.8535 | 11537.6 samples/s | 45.1 steps/s
Avg test loss: 4.77273, Avg test acc: 0.15904, Avg tpr: 0.85143, Avg fpr: 0.85354, total FA: 118513

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.07861 | acc=0.1545 | tpr=0.8805 | fpr=0.8586 | 4805.4 samples/s | 18.8 steps/s
[Step= 100] | Loss=6.06549 | acc=0.1551 | tpr=0.8699 | fpr=0.8582 | 7843.5 samples/s | 30.6 steps/s
[Step= 150] | Loss=6.08199 | acc=0.1543 | tpr=0.8674 | fpr=0.8588 | 7837.2 samples/s | 30.6 steps/s
[Step= 200] | Loss=6.06704 | acc=0.1555 | tpr=0.8656 | fpr=0.8574 | 7716.5 samples/s | 30.1 steps/s
[Step= 250] | Loss=6.06627 | acc=0.1568 | tpr=0.8638 | fpr=0.8561 | 8504.7 samples/s | 33.2 steps/s
[Step= 300] | Loss=6.05551 | acc=0.1571 | tpr=0.8640 | fpr=0.8558 | 8121.8 samples/s | 31.7 steps/s
[Step= 350] | Loss=6.06580 | acc=0.1564 | tpr=0.8654 | fpr=0.8565 | 7731.9 samples/s | 30.2 steps/s
[Step= 400] | Loss=6.06592 | acc=0.1563 | tpr=0.8632 | fpr=0.8566 | 7762.1 samples/s | 30.3 steps/s
[Step= 450] | Loss=6.06846 | acc=0.1564 | tpr=0.8632 | fpr=0.8564 | 7171.8 samples/s | 28.0 steps/s
[Step= 500] | Loss=6.06762 | acc=0.1564 | tpr=0.8639 | fpr=0.8564 | 8147.3 samples/s | 31.8 steps/s
[Step= 550] | Loss=6.06915 | acc=0.1564 | tpr=0.8659 | fpr=0.8565 | 11402.4 samples/s | 44.5 steps/s
Avg test loss: 6.07035, Avg test acc: 0.15630, Avg tpr: 0.86569, Avg fpr: 0.85659, total FA: 118936

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.29061 | acc=0.1190 | tpr=0.8451 | fpr=0.8941 | 4479.3 samples/s | 17.5 steps/s
[Step= 100] | Loss=5.28413 | acc=0.1181 | tpr=0.8593 | fpr=0.8957 | 8450.9 samples/s | 33.0 steps/s
[Step= 150] | Loss=5.28027 | acc=0.1189 | tpr=0.8674 | fpr=0.8948 | 7831.2 samples/s | 30.6 steps/s
[Step= 200] | Loss=5.27034 | acc=0.1200 | tpr=0.8634 | fpr=0.8935 | 8297.5 samples/s | 32.4 steps/s
[Step= 250] | Loss=5.27005 | acc=0.1214 | tpr=0.8559 | fpr=0.8920 | 8025.1 samples/s | 31.3 steps/s
[Step= 300] | Loss=5.26995 | acc=0.1214 | tpr=0.8524 | fpr=0.8919 | 7928.0 samples/s | 31.0 steps/s
[Step= 350] | Loss=5.27303 | acc=0.1212 | tpr=0.8535 | fpr=0.8921 | 8272.0 samples/s | 32.3 steps/s
[Step= 400] | Loss=5.27466 | acc=0.1210 | tpr=0.8528 | fpr=0.8923 | 8312.1 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.27909 | acc=0.1207 | tpr=0.8544 | fpr=0.8927 | 7610.2 samples/s | 29.7 steps/s
[Step= 500] | Loss=5.28194 | acc=0.1204 | tpr=0.8515 | fpr=0.8928 | 8001.4 samples/s | 31.3 steps/s
[Step= 550] | Loss=5.28064 | acc=0.1205 | tpr=0.8536 | fpr=0.8928 | 9687.2 samples/s | 37.8 steps/s
Avg test loss: 5.28182, Avg test acc: 0.12046, Avg tpr: 0.85380, Avg fpr: 0.89287, total FA: 123973

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.15772 | acc=0.9566 | tpr=0.9159 | fpr=0.0427 | 4503.5 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.16015 | acc=0.9557 | tpr=0.9083 | fpr=0.0435 | 7890.5 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.16340 | acc=0.9543 | tpr=0.9164 | fpr=0.0450 | 7983.0 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.16513 | acc=0.9543 | tpr=0.9180 | fpr=0.0450 | 7885.4 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.16574 | acc=0.9542 | tpr=0.9135 | fpr=0.0451 | 8307.9 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.16731 | acc=0.9537 | tpr=0.9127 | fpr=0.0456 | 8007.8 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.16732 | acc=0.9538 | tpr=0.9123 | fpr=0.0455 | 8237.6 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.16801 | acc=0.9536 | tpr=0.9048 | fpr=0.0455 | 8170.3 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.16964 | acc=0.9533 | tpr=0.9031 | fpr=0.0458 | 7242.9 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.16980 | acc=0.9533 | tpr=0.9075 | fpr=0.0459 | 8406.2 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.16965 | acc=0.9533 | tpr=0.9061 | fpr=0.0458 | 10412.3 samples/s | 40.7 steps/s
Avg test loss: 0.16955, Avg test acc: 0.95335, Avg tpr: 0.90571, Avg fpr: 0.04578, total FA: 6357

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11344 | acc=0.9641 | tpr=0.8938 | fpr=0.0347 | 4607.0 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.11657 | acc=0.9634 | tpr=0.8998 | fpr=0.0354 | 7931.0 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.11730 | acc=0.9633 | tpr=0.8977 | fpr=0.0355 | 7707.6 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.11669 | acc=0.9634 | tpr=0.8962 | fpr=0.0354 | 8590.8 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.11857 | acc=0.9630 | tpr=0.8987 | fpr=0.0359 | 8292.5 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.11906 | acc=0.9628 | tpr=0.8982 | fpr=0.0360 | 7609.3 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.12009 | acc=0.9628 | tpr=0.9023 | fpr=0.0361 | 8340.4 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.12136 | acc=0.9623 | tpr=0.8977 | fpr=0.0366 | 7794.7 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.12224 | acc=0.9619 | tpr=0.8968 | fpr=0.0369 | 7990.0 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.12191 | acc=0.9620 | tpr=0.9000 | fpr=0.0369 | 7672.9 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.12205 | acc=0.9619 | tpr=0.8957 | fpr=0.0369 | 10107.6 samples/s | 39.5 steps/s
Avg test loss: 0.12190, Avg test acc: 0.96191, Avg tpr: 0.89540, Avg fpr: 0.03688, total FA: 5121

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26655 | acc=0.9484 | tpr=0.9159 | fpr=0.0511 | 4682.9 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.26933 | acc=0.9471 | tpr=0.9062 | fpr=0.0522 | 8109.7 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.27438 | acc=0.9456 | tpr=0.9092 | fpr=0.0538 | 7737.5 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.27663 | acc=0.9456 | tpr=0.9148 | fpr=0.0539 | 8095.8 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.27965 | acc=0.9454 | tpr=0.9074 | fpr=0.0539 | 8239.6 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.28389 | acc=0.9450 | tpr=0.9033 | fpr=0.0542 | 7639.4 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.28256 | acc=0.9452 | tpr=0.9042 | fpr=0.0540 | 8158.0 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.28386 | acc=0.9450 | tpr=0.9026 | fpr=0.0543 | 8101.3 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.28438 | acc=0.9446 | tpr=0.9012 | fpr=0.0546 | 7833.2 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.28486 | acc=0.9445 | tpr=0.9044 | fpr=0.0548 | 8263.4 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.28398 | acc=0.9447 | tpr=0.9041 | fpr=0.0546 | 9288.0 samples/s | 36.3 steps/s
Avg test loss: 0.28375, Avg test acc: 0.94469, Avg tpr: 0.90452, Avg fpr: 0.05458, total FA: 7578

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11329 | acc=0.9647 | tpr=0.9027 | fpr=0.0342 | 4710.7 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.11799 | acc=0.9638 | tpr=0.8977 | fpr=0.0349 | 8027.4 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.11933 | acc=0.9631 | tpr=0.9035 | fpr=0.0358 | 8245.5 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.12139 | acc=0.9627 | tpr=0.9049 | fpr=0.0363 | 7863.0 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.12175 | acc=0.9625 | tpr=0.9004 | fpr=0.0364 | 7780.7 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.12310 | acc=0.9621 | tpr=0.8945 | fpr=0.0367 | 7642.1 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.12300 | acc=0.9622 | tpr=0.8998 | fpr=0.0367 | 8424.3 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.12392 | acc=0.9617 | tpr=0.8939 | fpr=0.0371 | 8071.0 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.12507 | acc=0.9615 | tpr=0.8900 | fpr=0.0372 | 7222.3 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.12493 | acc=0.9614 | tpr=0.8943 | fpr=0.0374 | 7740.5 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.12469 | acc=0.9615 | tpr=0.8934 | fpr=0.0372 | 11439.3 samples/s | 44.7 steps/s
Avg test loss: 0.12446, Avg test acc: 0.96158, Avg tpr: 0.89382, Avg fpr: 0.03718, total FA: 5163

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.24759 | acc=0.9570 | tpr=0.8673 | fpr=0.0414 | 4607.0 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.25388 | acc=0.9568 | tpr=0.9062 | fpr=0.0422 | 8118.3 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.25815 | acc=0.9560 | tpr=0.9135 | fpr=0.0433 | 7850.9 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.25980 | acc=0.9563 | tpr=0.9224 | fpr=0.0431 | 7792.6 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.26226 | acc=0.9560 | tpr=0.9197 | fpr=0.0434 | 7954.9 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.26475 | acc=0.9556 | tpr=0.9178 | fpr=0.0437 | 7799.8 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.26508 | acc=0.9555 | tpr=0.9161 | fpr=0.0438 | 7980.7 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.26547 | acc=0.9553 | tpr=0.9114 | fpr=0.0439 | 8101.4 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.26637 | acc=0.9550 | tpr=0.9060 | fpr=0.0441 | 8476.7 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.26747 | acc=0.9550 | tpr=0.9084 | fpr=0.0442 | 7912.7 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.26647 | acc=0.9551 | tpr=0.9077 | fpr=0.0440 | 9884.3 samples/s | 38.6 steps/s
Avg test loss: 0.26613, Avg test acc: 0.95511, Avg tpr: 0.90689, Avg fpr: 0.04401, total FA: 6111

server round 8/50

clients selected: [0 1 3 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=48.8] | Loss=0.08262 | Reg=0.00171 | acc=0.9531 | L2-Norm=13.081 | L2-Norm(final)=9.766 | 3202.1 samples/s | 50.0 steps/s
[Step=10050 Epoch=49.0] | Loss=0.10834 | Reg=0.00171 | acc=0.9531 | L2-Norm=13.082 | L2-Norm(final)=9.818 | 4867.5 samples/s | 76.1 steps/s
[Step=10100 Epoch=49.2] | Loss=0.10622 | Reg=0.00171 | acc=0.9219 | L2-Norm=13.083 | L2-Norm(final)=9.905 | 5511.6 samples/s | 86.1 steps/s
[Step=10150 Epoch=49.5] | Loss=0.10390 | Reg=0.00171 | acc=0.9062 | L2-Norm=13.083 | L2-Norm(final)=9.992 | 5460.0 samples/s | 85.3 steps/s
[Step=10200 Epoch=49.7] | Loss=0.10140 | Reg=0.00171 | acc=0.9375 | L2-Norm=13.083 | L2-Norm(final)=10.083 | 8367.3 samples/s | 130.7 steps/s
[Step=10250 Epoch=50.0] | Loss=0.10065 | Reg=0.00171 | acc=0.9219 | L2-Norm=13.083 | L2-Norm(final)=10.178 | 1487.1 samples/s | 23.2 steps/s
[Step=10300 Epoch=50.2] | Loss=0.10022 | Reg=0.00171 | acc=0.8906 | L2-Norm=13.083 | L2-Norm(final)=10.265 | 5419.6 samples/s | 84.7 steps/s
[Step=10350 Epoch=50.5] | Loss=0.09947 | Reg=0.00171 | acc=0.9375 | L2-Norm=13.083 | L2-Norm(final)=10.351 | 5383.2 samples/s | 84.1 steps/s
[Step=10400 Epoch=50.7] | Loss=0.09913 | Reg=0.00171 | acc=0.9531 | L2-Norm=13.083 | L2-Norm(final)=10.433 | 7687.3 samples/s | 120.1 steps/s
[Step=10450 Epoch=51.0] | Loss=0.09901 | Reg=0.00171 | acc=0.8750 | L2-Norm=13.083 | L2-Norm(final)=10.510 | 1511.7 samples/s | 23.6 steps/s
[Step=10500 Epoch=51.2] | Loss=0.09899 | Reg=0.00171 | acc=0.9375 | L2-Norm=13.083 | L2-Norm(final)=10.585 | 5388.3 samples/s | 84.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=51.2] | Loss=0.17559 | Reg=0.00171 | acc=0.8438 | L2-Norm=13.083 | L2-Norm(final)=11.310 | 3293.1 samples/s | 51.5 steps/s
[Step=10550 Epoch=51.4] | Loss=0.08567 | Reg=0.00178 | acc=0.8906 | L2-Norm=13.347 | L2-Norm(final)=11.309 | 4205.5 samples/s | 65.7 steps/s
[Step=10600 Epoch=51.7] | Loss=0.08132 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.575 | L2-Norm(final)=11.279 | 4658.9 samples/s | 72.8 steps/s
[Step=10650 Epoch=51.9] | Loss=0.07666 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.736 | L2-Norm(final)=11.256 | 4691.5 samples/s | 73.3 steps/s
[Step=10700 Epoch=52.2] | Loss=0.07337 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.852 | L2-Norm(final)=11.240 | 6715.0 samples/s | 104.9 steps/s
[Step=10750 Epoch=52.4] | Loss=0.06814 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.953 | L2-Norm(final)=11.228 | 1419.1 samples/s | 22.2 steps/s
[Step=10800 Epoch=52.7] | Loss=0.06351 | Reg=0.00197 | acc=0.9531 | L2-Norm=14.040 | L2-Norm(final)=11.220 | 4753.9 samples/s | 74.3 steps/s
[Step=10850 Epoch=52.9] | Loss=0.05967 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.114 | L2-Norm(final)=11.213 | 4627.2 samples/s | 72.3 steps/s
[Step=10900 Epoch=53.2] | Loss=0.05743 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.179 | L2-Norm(final)=11.208 | 6183.0 samples/s | 96.6 steps/s
[Step=10950 Epoch=53.4] | Loss=0.05411 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.238 | L2-Norm(final)=11.205 | 1440.1 samples/s | 22.5 steps/s
[Step=11000 Epoch=53.6] | Loss=0.05229 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.292 | L2-Norm(final)=11.202 | 4704.8 samples/s | 73.5 steps/s
[Step=11050 Epoch=53.9] | Loss=0.05004 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.343 | L2-Norm(final)=11.198 | 4740.2 samples/s | 74.1 steps/s
[Step=11100 Epoch=54.1] | Loss=0.04849 | Reg=0.00207 | acc=0.9531 | L2-Norm=14.391 | L2-Norm(final)=11.195 | 5577.6 samples/s | 87.1 steps/s
[Step=11150 Epoch=54.4] | Loss=0.04626 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.434 | L2-Norm(final)=11.191 | 1463.9 samples/s | 22.9 steps/s
[Step=11200 Epoch=54.6] | Loss=0.04432 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.473 | L2-Norm(final)=11.189 | 4710.8 samples/s | 73.6 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04301 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.509 | L2-Norm(final)=11.187 | 4676.3 samples/s | 73.1 steps/s
[Step=11300 Epoch=55.1] | Loss=0.04187 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.542 | L2-Norm(final)=11.185 | 5195.9 samples/s | 81.2 steps/s
[Step=11350 Epoch=55.3] | Loss=0.04045 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.575 | L2-Norm(final)=11.184 | 1534.1 samples/s | 24.0 steps/s
[Step=11400 Epoch=55.6] | Loss=0.03911 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.606 | L2-Norm(final)=11.183 | 4757.9 samples/s | 74.3 steps/s
[Step=11450 Epoch=55.8] | Loss=0.03785 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.636 | L2-Norm(final)=11.182 | 4649.0 samples/s | 72.6 steps/s
[Step=11500 Epoch=56.1] | Loss=0.03740 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.666 | L2-Norm(final)=11.181 | 4842.7 samples/s | 75.7 steps/s
[Step=11550 Epoch=56.3] | Loss=0.03667 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.698 | L2-Norm(final)=11.180 | 1550.9 samples/s | 24.2 steps/s
[Step=11600 Epoch=56.6] | Loss=0.03562 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.730 | L2-Norm(final)=11.179 | 4708.3 samples/s | 73.6 steps/s
[Step=11650 Epoch=56.8] | Loss=0.03523 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.761 | L2-Norm(final)=11.179 | 4707.2 samples/s | 73.5 steps/s
[Step=11700 Epoch=57.1] | Loss=0.03455 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.792 | L2-Norm(final)=11.177 | 4811.7 samples/s | 75.2 steps/s
[Step=11750 Epoch=57.3] | Loss=0.03385 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.823 | L2-Norm(final)=11.177 | 1549.7 samples/s | 24.2 steps/s
[Step=11800 Epoch=57.5] | Loss=0.03301 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.853 | L2-Norm(final)=11.176 | 4689.2 samples/s | 73.3 steps/s
[Step=11850 Epoch=57.8] | Loss=0.03226 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.882 | L2-Norm(final)=11.176 | 4734.2 samples/s | 74.0 steps/s
[Step=11900 Epoch=58.0] | Loss=0.03183 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.911 | L2-Norm(final)=11.176 | 4667.4 samples/s | 72.9 steps/s
[Step=11950 Epoch=58.3] | Loss=0.03150 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.940 | L2-Norm(final)=11.175 | 1574.7 samples/s | 24.6 steps/s
[Step=12000 Epoch=58.5] | Loss=0.03084 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.970 | L2-Norm(final)=11.174 | 4616.6 samples/s | 72.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step12000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=39.0] | Loss=0.16394 | Reg=0.00171 | acc=0.8438 | L2-Norm=13.081 | L2-Norm(final)=7.270 | 3238.6 samples/s | 50.6 steps/s
[Step=8050 Epoch=39.3] | Loss=0.12889 | Reg=0.00172 | acc=0.9375 | L2-Norm=13.097 | L2-Norm(final)=7.318 | 4727.7 samples/s | 73.9 steps/s
[Step=8100 Epoch=39.5] | Loss=0.12571 | Reg=0.00172 | acc=0.9531 | L2-Norm=13.100 | L2-Norm(final)=7.425 | 5469.7 samples/s | 85.5 steps/s
[Step=8150 Epoch=39.8] | Loss=0.12169 | Reg=0.00172 | acc=0.8750 | L2-Norm=13.101 | L2-Norm(final)=7.563 | 5483.5 samples/s | 85.7 steps/s
[Step=8200 Epoch=40.0] | Loss=0.11977 | Reg=0.00172 | acc=0.9219 | L2-Norm=13.101 | L2-Norm(final)=7.708 | 8549.9 samples/s | 133.6 steps/s
[Step=8250 Epoch=40.3] | Loss=0.11866 | Reg=0.00172 | acc=0.8906 | L2-Norm=13.101 | L2-Norm(final)=7.846 | 1471.1 samples/s | 23.0 steps/s
[Step=8300 Epoch=40.5] | Loss=0.11709 | Reg=0.00172 | acc=0.8750 | L2-Norm=13.101 | L2-Norm(final)=7.980 | 5508.8 samples/s | 86.1 steps/s
[Step=8350 Epoch=40.7] | Loss=0.11606 | Reg=0.00172 | acc=0.9062 | L2-Norm=13.102 | L2-Norm(final)=8.105 | 5472.1 samples/s | 85.5 steps/s
[Step=8400 Epoch=41.0] | Loss=0.11415 | Reg=0.00172 | acc=0.9062 | L2-Norm=13.102 | L2-Norm(final)=8.226 | 7787.3 samples/s | 121.7 steps/s
[Step=8450 Epoch=41.2] | Loss=0.11212 | Reg=0.00172 | acc=0.9375 | L2-Norm=13.102 | L2-Norm(final)=8.344 | 1528.3 samples/s | 23.9 steps/s
[Step=8500 Epoch=41.5] | Loss=0.11160 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.102 | L2-Norm(final)=8.458 | 5428.7 samples/s | 84.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=41.5] | Loss=0.07267 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.102 | L2-Norm(final)=9.584 | 3171.9 samples/s | 49.6 steps/s
[Step=8550 Epoch=41.7] | Loss=0.08326 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.395 | L2-Norm(final)=9.614 | 4249.4 samples/s | 66.4 steps/s
[Step=8600 Epoch=42.0] | Loss=0.08283 | Reg=0.00186 | acc=0.9531 | L2-Norm=13.632 | L2-Norm(final)=9.597 | 4668.5 samples/s | 72.9 steps/s
[Step=8650 Epoch=42.2] | Loss=0.07966 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.787 | L2-Norm(final)=9.585 | 4670.2 samples/s | 73.0 steps/s
[Step=8700 Epoch=42.5] | Loss=0.07589 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.912 | L2-Norm(final)=9.578 | 6815.2 samples/s | 106.5 steps/s
[Step=8750 Epoch=42.7] | Loss=0.06908 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.012 | L2-Norm(final)=9.571 | 1427.6 samples/s | 22.3 steps/s
[Step=8800 Epoch=42.9] | Loss=0.06538 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.096 | L2-Norm(final)=9.566 | 4689.7 samples/s | 73.3 steps/s
[Step=8850 Epoch=43.2] | Loss=0.06208 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.173 | L2-Norm(final)=9.561 | 4704.2 samples/s | 73.5 steps/s
[Step=8900 Epoch=43.4] | Loss=0.05937 | Reg=0.00203 | acc=0.9375 | L2-Norm=14.242 | L2-Norm(final)=9.557 | 6218.7 samples/s | 97.2 steps/s
[Step=8950 Epoch=43.7] | Loss=0.05627 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.307 | L2-Norm(final)=9.554 | 1418.0 samples/s | 22.2 steps/s
[Step=9000 Epoch=43.9] | Loss=0.05335 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.368 | L2-Norm(final)=9.554 | 4731.6 samples/s | 73.9 steps/s
[Step=9050 Epoch=44.2] | Loss=0.05062 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.425 | L2-Norm(final)=9.554 | 4686.2 samples/s | 73.2 steps/s
[Step=9100 Epoch=44.4] | Loss=0.04868 | Reg=0.00210 | acc=0.9531 | L2-Norm=14.478 | L2-Norm(final)=9.554 | 5761.7 samples/s | 90.0 steps/s
[Step=9150 Epoch=44.6] | Loss=0.04648 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.529 | L2-Norm(final)=9.554 | 1455.1 samples/s | 22.7 steps/s
[Step=9200 Epoch=44.9] | Loss=0.04491 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.577 | L2-Norm(final)=9.555 | 4748.2 samples/s | 74.2 steps/s
[Step=9250 Epoch=45.1] | Loss=0.04304 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.621 | L2-Norm(final)=9.555 | 4642.7 samples/s | 72.5 steps/s
[Step=9300 Epoch=45.4] | Loss=0.04165 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.662 | L2-Norm(final)=9.556 | 5425.9 samples/s | 84.8 steps/s
[Step=9350 Epoch=45.6] | Loss=0.04048 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.701 | L2-Norm(final)=9.556 | 1482.1 samples/s | 23.2 steps/s
[Step=9400 Epoch=45.9] | Loss=0.03919 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.739 | L2-Norm(final)=9.556 | 4817.3 samples/s | 75.3 steps/s
[Step=9450 Epoch=46.1] | Loss=0.03807 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.774 | L2-Norm(final)=9.557 | 4584.7 samples/s | 71.6 steps/s
[Step=9500 Epoch=46.4] | Loss=0.03688 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.809 | L2-Norm(final)=9.558 | 5040.5 samples/s | 78.8 steps/s
[Step=9550 Epoch=46.6] | Loss=0.03599 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.844 | L2-Norm(final)=9.559 | 1520.6 samples/s | 23.8 steps/s
[Step=9600 Epoch=46.8] | Loss=0.03518 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.879 | L2-Norm(final)=9.559 | 4700.0 samples/s | 73.4 steps/s
[Step=9650 Epoch=47.1] | Loss=0.03460 | Reg=0.00223 | acc=0.9531 | L2-Norm=14.912 | L2-Norm(final)=9.559 | 4676.6 samples/s | 73.1 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03392 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.946 | L2-Norm(final)=9.559 | 4776.8 samples/s | 74.6 steps/s
[Step=9750 Epoch=47.6] | Loss=0.03313 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.978 | L2-Norm(final)=9.559 | 1559.8 samples/s | 24.4 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03243 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.010 | L2-Norm(final)=9.559 | 4679.4 samples/s | 73.1 steps/s
[Step=9850 Epoch=48.1] | Loss=0.03176 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.040 | L2-Norm(final)=9.559 | 4754.3 samples/s | 74.3 steps/s
[Step=9900 Epoch=48.3] | Loss=0.03105 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.070 | L2-Norm(final)=9.559 | 4640.4 samples/s | 72.5 steps/s
[Step=9950 Epoch=48.6] | Loss=0.03048 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.098 | L2-Norm(final)=9.559 | 1587.6 samples/s | 24.8 steps/s
[Step=10000 Epoch=48.8] | Loss=0.02976 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.125 | L2-Norm(final)=9.560 | 4666.8 samples/s | 72.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_1/client_state-step10000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=12001 Epoch=58.5] | Loss=0.06779 | Reg=0.00171 | acc=0.9531 | L2-Norm=13.081 | L2-Norm(final)=10.591 | 3171.3 samples/s | 49.6 steps/s
[Step=12050 Epoch=58.8] | Loss=0.10241 | Reg=0.00171 | acc=0.8750 | L2-Norm=13.089 | L2-Norm(final)=10.651 | 4963.0 samples/s | 77.5 steps/s
[Step=12100 Epoch=59.0] | Loss=0.10661 | Reg=0.00171 | acc=0.9062 | L2-Norm=13.091 | L2-Norm(final)=10.707 | 5464.5 samples/s | 85.4 steps/s
[Step=12150 Epoch=59.3] | Loss=0.10451 | Reg=0.00171 | acc=0.9219 | L2-Norm=13.091 | L2-Norm(final)=10.755 | 5440.8 samples/s | 85.0 steps/s
[Step=12200 Epoch=59.5] | Loss=0.10384 | Reg=0.00171 | acc=0.8906 | L2-Norm=13.092 | L2-Norm(final)=10.805 | 8676.9 samples/s | 135.6 steps/s
[Step=12250 Epoch=59.7] | Loss=0.10248 | Reg=0.00171 | acc=0.9375 | L2-Norm=13.092 | L2-Norm(final)=10.864 | 1466.8 samples/s | 22.9 steps/s
[Step=12300 Epoch=60.0] | Loss=0.10268 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.092 | L2-Norm(final)=10.927 | 5416.0 samples/s | 84.6 steps/s
[Step=12350 Epoch=60.2] | Loss=0.10256 | Reg=0.00171 | acc=0.8594 | L2-Norm=13.092 | L2-Norm(final)=10.988 | 5464.2 samples/s | 85.4 steps/s
[Step=12400 Epoch=60.5] | Loss=0.10176 | Reg=0.00171 | acc=0.9531 | L2-Norm=13.092 | L2-Norm(final)=11.054 | 7569.1 samples/s | 118.3 steps/s
[Step=12450 Epoch=60.7] | Loss=0.10200 | Reg=0.00171 | acc=0.8906 | L2-Norm=13.092 | L2-Norm(final)=11.117 | 1533.7 samples/s | 24.0 steps/s
[Step=12500 Epoch=61.0] | Loss=0.10193 | Reg=0.00171 | acc=0.9375 | L2-Norm=13.092 | L2-Norm(final)=11.180 | 5555.2 samples/s | 86.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=61.0] | Loss=0.11470 | Reg=0.00171 | acc=0.8906 | L2-Norm=13.092 | L2-Norm(final)=11.807 | 3145.4 samples/s | 49.1 steps/s
[Step=12550 Epoch=61.2] | Loss=0.09065 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.391 | L2-Norm(final)=11.800 | 4339.5 samples/s | 67.8 steps/s
[Step=12600 Epoch=61.4] | Loss=0.08589 | Reg=0.00187 | acc=0.9062 | L2-Norm=13.656 | L2-Norm(final)=11.767 | 4674.6 samples/s | 73.0 steps/s
[Step=12650 Epoch=61.7] | Loss=0.08074 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.831 | L2-Norm(final)=11.739 | 4673.2 samples/s | 73.0 steps/s
[Step=12700 Epoch=61.9] | Loss=0.07498 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.962 | L2-Norm(final)=11.721 | 6822.7 samples/s | 106.6 steps/s
[Step=12750 Epoch=62.2] | Loss=0.06860 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.069 | L2-Norm(final)=11.710 | 1444.8 samples/s | 22.6 steps/s
[Step=12800 Epoch=62.4] | Loss=0.06524 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.158 | L2-Norm(final)=11.700 | 4707.3 samples/s | 73.6 steps/s
[Step=12850 Epoch=62.7] | Loss=0.06147 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.237 | L2-Norm(final)=11.692 | 4701.4 samples/s | 73.5 steps/s
[Step=12900 Epoch=62.9] | Loss=0.05825 | Reg=0.00205 | acc=0.9531 | L2-Norm=14.308 | L2-Norm(final)=11.687 | 6107.3 samples/s | 95.4 steps/s
[Step=12950 Epoch=63.2] | Loss=0.05525 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.371 | L2-Norm(final)=11.684 | 1396.7 samples/s | 21.8 steps/s
[Step=13000 Epoch=63.4] | Loss=0.05269 | Reg=0.00208 | acc=0.9531 | L2-Norm=14.428 | L2-Norm(final)=11.679 | 4670.6 samples/s | 73.0 steps/s
[Step=13050 Epoch=63.6] | Loss=0.04989 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.480 | L2-Norm(final)=11.676 | 4559.7 samples/s | 71.2 steps/s
[Step=13100 Epoch=63.9] | Loss=0.04822 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.529 | L2-Norm(final)=11.674 | 5526.6 samples/s | 86.4 steps/s
[Step=13150 Epoch=64.1] | Loss=0.04736 | Reg=0.00213 | acc=0.9531 | L2-Norm=14.576 | L2-Norm(final)=11.672 | 1464.0 samples/s | 22.9 steps/s
[Step=13200 Epoch=64.4] | Loss=0.04574 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.622 | L2-Norm(final)=11.668 | 4596.8 samples/s | 71.8 steps/s
[Step=13250 Epoch=64.6] | Loss=0.04415 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.666 | L2-Norm(final)=11.664 | 4591.6 samples/s | 71.7 steps/s
[Step=13300 Epoch=64.9] | Loss=0.04298 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.707 | L2-Norm(final)=11.661 | 5139.0 samples/s | 80.3 steps/s
[Step=13350 Epoch=65.1] | Loss=0.04198 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.745 | L2-Norm(final)=11.657 | 1472.1 samples/s | 23.0 steps/s
[Step=13400 Epoch=65.3] | Loss=0.04088 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.785 | L2-Norm(final)=11.654 | 4708.1 samples/s | 73.6 steps/s
[Step=13450 Epoch=65.6] | Loss=0.03965 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.823 | L2-Norm(final)=11.651 | 4756.6 samples/s | 74.3 steps/s
[Step=13500 Epoch=65.8] | Loss=0.03888 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.859 | L2-Norm(final)=11.647 | 4739.8 samples/s | 74.1 steps/s
[Step=13550 Epoch=66.1] | Loss=0.03813 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.893 | L2-Norm(final)=11.644 | 1497.8 samples/s | 23.4 steps/s
[Step=13600 Epoch=66.3] | Loss=0.03705 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.929 | L2-Norm(final)=11.642 | 4550.7 samples/s | 71.1 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03626 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.963 | L2-Norm(final)=11.640 | 4631.4 samples/s | 72.4 steps/s
[Step=13700 Epoch=66.8] | Loss=0.03558 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.997 | L2-Norm(final)=11.637 | 4613.9 samples/s | 72.1 steps/s
[Step=13750 Epoch=67.1] | Loss=0.03504 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.031 | L2-Norm(final)=11.635 | 1548.4 samples/s | 24.2 steps/s
[Step=13800 Epoch=67.3] | Loss=0.03409 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.064 | L2-Norm(final)=11.633 | 4674.4 samples/s | 73.0 steps/s
[Step=13850 Epoch=67.5] | Loss=0.03346 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.094 | L2-Norm(final)=11.630 | 4571.7 samples/s | 71.4 steps/s
[Step=13900 Epoch=67.8] | Loss=0.03270 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.124 | L2-Norm(final)=11.629 | 4572.7 samples/s | 71.4 steps/s
[Step=13950 Epoch=68.0] | Loss=0.03218 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.154 | L2-Norm(final)=11.627 | 1548.8 samples/s | 24.2 steps/s
[Step=14000 Epoch=68.3] | Loss=0.03140 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.182 | L2-Norm(final)=11.626 | 4636.9 samples/s | 72.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step14000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=56.5] | Loss=0.05845 | Reg=0.00171 | acc=0.9375 | L2-Norm=13.081 | L2-Norm(final)=8.738 | 3152.5 samples/s | 49.3 steps/s
[Step=6050 Epoch=57.0] | Loss=0.03992 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.072 | L2-Norm(final)=8.680 | 4490.6 samples/s | 70.2 steps/s
[Step=6100 Epoch=57.5] | Loss=0.03445 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.071 | L2-Norm(final)=8.670 | 7607.0 samples/s | 118.9 steps/s
[Step=6150 Epoch=58.0] | Loss=0.03181 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.070 | L2-Norm(final)=8.732 | 1433.0 samples/s | 22.4 steps/s
[Step=6200 Epoch=58.4] | Loss=0.02979 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.070 | L2-Norm(final)=8.824 | 6477.5 samples/s | 101.2 steps/s
[Step=6250 Epoch=58.9] | Loss=0.02845 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.070 | L2-Norm(final)=8.928 | 1490.7 samples/s | 23.3 steps/s
[Step=6300 Epoch=59.4] | Loss=0.02757 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.070 | L2-Norm(final)=9.037 | 6000.0 samples/s | 93.7 steps/s
[Step=6350 Epoch=59.8] | Loss=0.02699 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.070 | L2-Norm(final)=9.147 | 1511.2 samples/s | 23.6 steps/s
[Step=6400 Epoch=60.3] | Loss=0.02650 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.070 | L2-Norm(final)=9.256 | 5451.0 samples/s | 85.2 steps/s
[Step=6450 Epoch=60.8] | Loss=0.02564 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.070 | L2-Norm(final)=9.362 | 1555.3 samples/s | 24.3 steps/s
[Step=6500 Epoch=61.2] | Loss=0.02527 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.070 | L2-Norm(final)=9.466 | 5169.4 samples/s | 80.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=61.3] | Loss=0.00652 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.069 | L2-Norm(final)=10.503 | 3087.3 samples/s | 48.2 steps/s
[Step=6550 Epoch=61.7] | Loss=0.02120 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=10.519 | 3984.9 samples/s | 62.3 steps/s
[Step=6600 Epoch=62.2] | Loss=0.01999 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.776 | L2-Norm(final)=10.473 | 6383.9 samples/s | 99.7 steps/s
[Step=6650 Epoch=62.7] | Loss=0.01423 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.944 | L2-Norm(final)=10.450 | 1358.1 samples/s | 21.2 steps/s
[Step=6700 Epoch=63.1] | Loss=0.01095 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.016 | L2-Norm(final)=10.441 | 5655.0 samples/s | 88.4 steps/s
[Step=6750 Epoch=63.6] | Loss=0.00898 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.044 | L2-Norm(final)=10.437 | 1394.0 samples/s | 21.8 steps/s
[Step=6800 Epoch=64.1] | Loss=0.00749 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.050 | L2-Norm(final)=10.434 | 5090.1 samples/s | 79.5 steps/s
[Step=6850 Epoch=64.5] | Loss=0.00642 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.042 | L2-Norm(final)=10.433 | 1424.3 samples/s | 22.3 steps/s
[Step=6900 Epoch=65.0] | Loss=0.00562 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.027 | L2-Norm(final)=10.433 | 4665.4 samples/s | 72.9 steps/s
[Step=6950 Epoch=65.5] | Loss=0.00500 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.006 | L2-Norm(final)=10.433 | 1505.0 samples/s | 23.5 steps/s
[Step=7000 Epoch=66.0] | Loss=0.00450 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.982 | L2-Norm(final)=10.433 | 4295.1 samples/s | 67.1 steps/s
[Step=7050 Epoch=66.4] | Loss=0.00409 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.956 | L2-Norm(final)=10.433 | 1487.3 samples/s | 23.2 steps/s
[Step=7100 Epoch=66.9] | Loss=0.00375 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.928 | L2-Norm(final)=10.433 | 4504.2 samples/s | 70.4 steps/s
[Step=7150 Epoch=67.4] | Loss=0.00347 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.899 | L2-Norm(final)=10.434 | 1545.5 samples/s | 24.1 steps/s
[Step=7200 Epoch=67.8] | Loss=0.00322 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.869 | L2-Norm(final)=10.434 | 4443.3 samples/s | 69.4 steps/s
[Step=7250 Epoch=68.3] | Loss=0.00300 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=10.435 | 1612.4 samples/s | 25.2 steps/s
[Step=7300 Epoch=68.8] | Loss=0.00282 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.808 | L2-Norm(final)=10.435 | 3830.8 samples/s | 59.9 steps/s
[Step=7350 Epoch=69.3] | Loss=0.00265 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.777 | L2-Norm(final)=10.436 | 6450.2 samples/s | 100.8 steps/s
[Step=7400 Epoch=69.7] | Loss=0.00251 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.746 | L2-Norm(final)=10.436 | 1356.0 samples/s | 21.2 steps/s
[Step=7450 Epoch=70.2] | Loss=0.00237 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=10.437 | 5677.1 samples/s | 88.7 steps/s
[Step=7500 Epoch=70.7] | Loss=0.00226 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.683 | L2-Norm(final)=10.437 | 1390.1 samples/s | 21.7 steps/s
[Step=7550 Epoch=71.1] | Loss=0.00215 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.652 | L2-Norm(final)=10.438 | 5192.9 samples/s | 81.1 steps/s
[Step=7600 Epoch=71.6] | Loss=0.00205 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.620 | L2-Norm(final)=10.439 | 1429.0 samples/s | 22.3 steps/s
[Step=7650 Epoch=72.1] | Loss=0.00196 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.589 | L2-Norm(final)=10.439 | 4756.9 samples/s | 74.3 steps/s
[Step=7700 Epoch=72.6] | Loss=0.00188 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=10.440 | 1452.2 samples/s | 22.7 steps/s
[Step=7750 Epoch=73.0] | Loss=0.00181 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.526 | L2-Norm(final)=10.440 | 4482.9 samples/s | 70.0 steps/s
[Step=7800 Epoch=73.5] | Loss=0.00174 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.495 | L2-Norm(final)=10.441 | 1477.6 samples/s | 23.1 steps/s
[Step=7850 Epoch=74.0] | Loss=0.00167 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.464 | L2-Norm(final)=10.441 | 4428.1 samples/s | 69.2 steps/s
[Step=7900 Epoch=74.4] | Loss=0.00161 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.432 | L2-Norm(final)=10.442 | 1483.1 samples/s | 23.2 steps/s
[Step=7950 Epoch=74.9] | Loss=0.00156 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=10.442 | 4438.3 samples/s | 69.3 steps/s
[Step=8000 Epoch=75.4] | Loss=0.00151 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=10.443 | 1564.5 samples/s | 24.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_3/client_state-step8000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=76.3] | Loss=0.01228 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=11.163 | 3150.7 samples/s | 49.2 steps/s
[Step=8050 Epoch=76.7] | Loss=0.02414 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.071 | L2-Norm(final)=11.219 | 4499.5 samples/s | 70.3 steps/s
[Step=8100 Epoch=77.2] | Loss=0.02261 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.070 | L2-Norm(final)=11.305 | 8003.8 samples/s | 125.1 steps/s
[Step=8150 Epoch=77.7] | Loss=0.02188 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.070 | L2-Norm(final)=11.411 | 1393.6 samples/s | 21.8 steps/s
[Step=8200 Epoch=78.2] | Loss=0.02219 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.069 | L2-Norm(final)=11.523 | 7309.5 samples/s | 114.2 steps/s
[Step=8250 Epoch=78.6] | Loss=0.02182 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.069 | L2-Norm(final)=11.636 | 1424.2 samples/s | 22.3 steps/s
[Step=8300 Epoch=79.1] | Loss=0.02173 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.069 | L2-Norm(final)=11.748 | 6736.7 samples/s | 105.3 steps/s
[Step=8350 Epoch=79.6] | Loss=0.02134 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.069 | L2-Norm(final)=11.857 | 1462.1 samples/s | 22.8 steps/s
[Step=8400 Epoch=80.1] | Loss=0.02111 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.069 | L2-Norm(final)=11.961 | 6100.7 samples/s | 95.3 steps/s
[Step=8450 Epoch=80.5] | Loss=0.02103 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.069 | L2-Norm(final)=12.063 | 1529.9 samples/s | 23.9 steps/s
[Step=8500 Epoch=81.0] | Loss=0.02084 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.069 | L2-Norm(final)=12.161 | 5537.7 samples/s | 86.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=81.0] | Loss=0.02282 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.069 | L2-Norm(final)=13.135 | 3111.5 samples/s | 48.6 steps/s
[Step=8550 Epoch=81.5] | Loss=0.02797 | Reg=0.00183 | acc=0.9375 | L2-Norm=13.527 | L2-Norm(final)=13.147 | 3925.7 samples/s | 61.3 steps/s
[Step=8600 Epoch=82.0] | Loss=0.02020 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.970 | L2-Norm(final)=13.092 | 6483.8 samples/s | 101.3 steps/s
[Step=8650 Epoch=82.4] | Loss=0.01432 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.173 | L2-Norm(final)=13.066 | 1364.3 samples/s | 21.3 steps/s
[Step=8700 Epoch=82.9] | Loss=0.01091 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.263 | L2-Norm(final)=13.055 | 5893.6 samples/s | 92.1 steps/s
[Step=8750 Epoch=83.4] | Loss=0.00902 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.304 | L2-Norm(final)=13.046 | 1399.6 samples/s | 21.9 steps/s
[Step=8800 Epoch=83.9] | Loss=0.00768 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.317 | L2-Norm(final)=13.041 | 5440.1 samples/s | 85.0 steps/s
[Step=8850 Epoch=84.3] | Loss=0.00659 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.318 | L2-Norm(final)=13.038 | 1409.6 samples/s | 22.0 steps/s
[Step=8900 Epoch=84.8] | Loss=0.00577 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.308 | L2-Norm(final)=13.035 | 5117.8 samples/s | 80.0 steps/s
[Step=8950 Epoch=85.3] | Loss=0.00513 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.291 | L2-Norm(final)=13.034 | 1426.1 samples/s | 22.3 steps/s
[Step=9000 Epoch=85.8] | Loss=0.00462 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.270 | L2-Norm(final)=13.033 | 4820.8 samples/s | 75.3 steps/s
[Step=9050 Epoch=86.3] | Loss=0.00420 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.245 | L2-Norm(final)=13.032 | 1444.9 samples/s | 22.6 steps/s
[Step=9100 Epoch=86.7] | Loss=0.00385 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.219 | L2-Norm(final)=13.032 | 4471.5 samples/s | 69.9 steps/s
[Step=9150 Epoch=87.2] | Loss=0.00356 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.191 | L2-Norm(final)=13.032 | 1458.3 samples/s | 22.8 steps/s
[Step=9200 Epoch=87.7] | Loss=0.00330 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.162 | L2-Norm(final)=13.031 | 4503.4 samples/s | 70.4 steps/s
[Step=9250 Epoch=88.2] | Loss=0.00308 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.132 | L2-Norm(final)=13.031 | 1479.9 samples/s | 23.1 steps/s
[Step=9300 Epoch=88.6] | Loss=0.00289 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.102 | L2-Norm(final)=13.031 | 4458.7 samples/s | 69.7 steps/s
[Step=9350 Epoch=89.1] | Loss=0.00272 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.072 | L2-Norm(final)=13.031 | 1478.5 samples/s | 23.1 steps/s
[Step=9400 Epoch=89.6] | Loss=0.00257 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.041 | L2-Norm(final)=13.031 | 4412.3 samples/s | 68.9 steps/s
[Step=9450 Epoch=90.1] | Loss=0.00243 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.010 | L2-Norm(final)=13.031 | 1493.2 samples/s | 23.3 steps/s
[Step=9500 Epoch=90.5] | Loss=0.00231 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.980 | L2-Norm(final)=13.031 | 4365.5 samples/s | 68.2 steps/s
[Step=9550 Epoch=91.0] | Loss=0.00220 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.949 | L2-Norm(final)=13.031 | 7118.5 samples/s | 111.2 steps/s
[Step=9600 Epoch=91.5] | Loss=0.00210 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.918 | L2-Norm(final)=13.032 | 1310.6 samples/s | 20.5 steps/s
[Step=9650 Epoch=92.0] | Loss=0.00201 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.887 | L2-Norm(final)=13.032 | 6443.5 samples/s | 100.7 steps/s
[Step=9700 Epoch=92.4] | Loss=0.00193 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.856 | L2-Norm(final)=13.032 | 1348.9 samples/s | 21.1 steps/s
[Step=9750 Epoch=92.9] | Loss=0.00185 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.826 | L2-Norm(final)=13.032 | 5958.9 samples/s | 93.1 steps/s
[Step=9800 Epoch=93.4] | Loss=0.00178 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.795 | L2-Norm(final)=13.032 | 1371.5 samples/s | 21.4 steps/s
[Step=9850 Epoch=93.9] | Loss=0.00171 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.765 | L2-Norm(final)=13.033 | 5532.5 samples/s | 86.4 steps/s
[Step=9900 Epoch=94.4] | Loss=0.00165 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.735 | L2-Norm(final)=13.033 | 1403.1 samples/s | 21.9 steps/s
[Step=9950 Epoch=94.8] | Loss=0.00160 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=13.033 | 5117.8 samples/s | 80.0 steps/s
[Step=10000 Epoch=95.3] | Loss=0.00154 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.674 | L2-Norm(final)=13.033 | 1410.6 samples/s | 22.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.14846 | acc=0.9359 | tpr=0.9594 | fpr=0.1150 | 4760.5 samples/s | 18.6 steps/s
Avg test loss: 0.15488, Avg test acc: 0.93433, Avg tpr: 0.95722, Avg fpr: 0.11601, total FA: 905

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14324 | acc=0.9378 | tpr=0.9536 | fpr=0.0964 | 4603.9 samples/s | 18.0 steps/s
Avg test loss: 0.14442, Avg test acc: 0.93770, Avg tpr: 0.95343, Avg fpr: 0.09691, total FA: 756

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.14190 | acc=0.9352 | tpr=0.9533 | fpr=0.1043 | 4691.4 samples/s | 18.3 steps/s
Avg test loss: 0.14511, Avg test acc: 0.93445, Avg tpr: 0.95279, Avg fpr: 0.10588, total FA: 826

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.16568 | acc=0.9382 | tpr=0.9549 | fpr=0.0981 | 4731.5 samples/s | 18.5 steps/s
Avg test loss: 0.17206, Avg test acc: 0.93589, Avg tpr: 0.95291, Avg fpr: 0.10153, total FA: 792

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.13553 | acc=0.9330 | tpr=0.9469 | fpr=0.0974 | 4688.3 samples/s | 18.3 steps/s
Avg test loss: 0.13614, Avg test acc: 0.93249, Avg tpr: 0.94579, Avg fpr: 0.09678, total FA: 755

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.50966 | acc=0.3161 | tpr=0.0035 | fpr=0.0052 | 4814.6 samples/s | 18.8 steps/s
Avg test loss: 4.53322, Avg test acc: 0.31377, Avg tpr: 0.00414, Avg fpr: 0.00526, total FA: 41

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.12240 | acc=0.3212 | tpr=0.0226 | fpr=0.0305 | 4493.7 samples/s | 17.6 steps/s
Avg test loss: 4.14503, Avg test acc: 0.31958, Avg tpr: 0.02273, Avg fpr: 0.02756, total FA: 215

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.10127 | acc=0.3223 | tpr=0.0430 | fpr=0.0714 | 4590.5 samples/s | 17.9 steps/s
Avg test loss: 4.12030, Avg test acc: 0.32006, Avg tpr: 0.04237, Avg fpr: 0.06922, total FA: 540

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=3.89136 | acc=0.3230 | tpr=0.0221 | fpr=0.0235 | 4835.4 samples/s | 18.9 steps/s
Avg test loss: 3.91250, Avg test acc: 0.32142, Avg tpr: 0.02261, Avg fpr: 0.02141, total FA: 167

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.80806 | acc=0.3236 | tpr=0.0316 | fpr=0.0424 | 4654.9 samples/s | 18.2 steps/s
Avg test loss: 4.82929, Avg test acc: 0.32234, Avg tpr: 0.03270, Avg fpr: 0.04064, total FA: 317

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.65019 | acc=0.1337 | tpr=0.8628 | fpr=0.8794 | 4607.3 samples/s | 18.0 steps/s
[Step= 100] | Loss=5.65326 | acc=0.1348 | tpr=0.8486 | fpr=0.8785 | 7916.4 samples/s | 30.9 steps/s
[Step= 150] | Loss=5.66407 | acc=0.1350 | tpr=0.8588 | fpr=0.8783 | 8580.6 samples/s | 33.5 steps/s
[Step= 200] | Loss=5.64865 | acc=0.1353 | tpr=0.8590 | fpr=0.8779 | 8112.9 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.64110 | acc=0.1368 | tpr=0.8559 | fpr=0.8764 | 7348.2 samples/s | 28.7 steps/s
[Step= 300] | Loss=5.63974 | acc=0.1369 | tpr=0.8560 | fpr=0.8762 | 8237.2 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.64735 | acc=0.1356 | tpr=0.8554 | fpr=0.8774 | 7928.3 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.64974 | acc=0.1354 | tpr=0.8512 | fpr=0.8776 | 7899.3 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.65149 | acc=0.1351 | tpr=0.8544 | fpr=0.8780 | 8071.8 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.65369 | acc=0.1348 | tpr=0.8507 | fpr=0.8781 | 8272.6 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.65115 | acc=0.1351 | tpr=0.8544 | fpr=0.8780 | 9390.1 samples/s | 36.7 steps/s
Avg test loss: 5.65174, Avg test acc: 0.13503, Avg tpr: 0.85420, Avg fpr: 0.87805, total FA: 121915

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.56502 | acc=0.1625 | tpr=0.7965 | fpr=0.8489 | 4673.9 samples/s | 18.3 steps/s
[Step= 100] | Loss=5.53402 | acc=0.1658 | tpr=0.7889 | fpr=0.8458 | 8315.0 samples/s | 32.5 steps/s
[Step= 150] | Loss=5.52876 | acc=0.1667 | tpr=0.8026 | fpr=0.8450 | 7608.3 samples/s | 29.7 steps/s
[Step= 200] | Loss=5.51890 | acc=0.1664 | tpr=0.8109 | fpr=0.8453 | 7840.0 samples/s | 30.6 steps/s
[Step= 250] | Loss=5.51290 | acc=0.1676 | tpr=0.8070 | fpr=0.8440 | 8160.8 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.51023 | acc=0.1669 | tpr=0.8065 | fpr=0.8447 | 8272.0 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.51298 | acc=0.1672 | tpr=0.8140 | fpr=0.8445 | 8255.5 samples/s | 32.2 steps/s
[Step= 400] | Loss=5.51268 | acc=0.1668 | tpr=0.8096 | fpr=0.8448 | 7834.5 samples/s | 30.6 steps/s
[Step= 450] | Loss=5.51732 | acc=0.1664 | tpr=0.8053 | fpr=0.8452 | 7862.2 samples/s | 30.7 steps/s
[Step= 500] | Loss=5.51875 | acc=0.1662 | tpr=0.8026 | fpr=0.8453 | 7833.7 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.51421 | acc=0.1663 | tpr=0.8050 | fpr=0.8453 | 9774.4 samples/s | 38.2 steps/s
Avg test loss: 5.51504, Avg test acc: 0.16616, Avg tpr: 0.80468, Avg fpr: 0.84544, total FA: 117388

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.81440 | acc=0.1557 | tpr=0.8673 | fpr=0.8571 | 4808.0 samples/s | 18.8 steps/s
[Step= 100] | Loss=4.79084 | acc=0.1573 | tpr=0.8422 | fpr=0.8555 | 7325.8 samples/s | 28.6 steps/s
[Step= 150] | Loss=4.79254 | acc=0.1579 | tpr=0.8559 | fpr=0.8550 | 7571.3 samples/s | 29.6 steps/s
[Step= 200] | Loss=4.77531 | acc=0.1579 | tpr=0.8546 | fpr=0.8548 | 8165.2 samples/s | 31.9 steps/s
[Step= 250] | Loss=4.76951 | acc=0.1592 | tpr=0.8515 | fpr=0.8534 | 8470.9 samples/s | 33.1 steps/s
[Step= 300] | Loss=4.76695 | acc=0.1593 | tpr=0.8524 | fpr=0.8534 | 8386.7 samples/s | 32.8 steps/s
[Step= 350] | Loss=4.77000 | acc=0.1592 | tpr=0.8541 | fpr=0.8535 | 8197.2 samples/s | 32.0 steps/s
[Step= 400] | Loss=4.77175 | acc=0.1591 | tpr=0.8556 | fpr=0.8536 | 7748.6 samples/s | 30.3 steps/s
[Step= 450] | Loss=4.76988 | acc=0.1589 | tpr=0.8505 | fpr=0.8537 | 8201.4 samples/s | 32.0 steps/s
[Step= 500] | Loss=4.77227 | acc=0.1590 | tpr=0.8480 | fpr=0.8535 | 8107.0 samples/s | 31.7 steps/s
[Step= 550] | Loss=4.77279 | acc=0.1591 | tpr=0.8512 | fpr=0.8535 | 9364.0 samples/s | 36.6 steps/s
Avg test loss: 4.77273, Avg test acc: 0.15904, Avg tpr: 0.85143, Avg fpr: 0.85354, total FA: 118513

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=7.49663 | acc=0.1298 | tpr=0.8761 | fpr=0.8836 | 4628.1 samples/s | 18.1 steps/s
[Step= 100] | Loss=7.46933 | acc=0.1316 | tpr=0.8721 | fpr=0.8822 | 7879.0 samples/s | 30.8 steps/s
[Step= 150] | Loss=7.47770 | acc=0.1313 | tpr=0.8818 | fpr=0.8825 | 8206.7 samples/s | 32.1 steps/s
[Step= 200] | Loss=7.47449 | acc=0.1311 | tpr=0.8907 | fpr=0.8827 | 7849.4 samples/s | 30.7 steps/s
[Step= 250] | Loss=7.46515 | acc=0.1315 | tpr=0.8900 | fpr=0.8823 | 7836.0 samples/s | 30.6 steps/s
[Step= 300] | Loss=7.45745 | acc=0.1320 | tpr=0.8865 | fpr=0.8818 | 8270.7 samples/s | 32.3 steps/s
[Step= 350] | Loss=7.46781 | acc=0.1318 | tpr=0.8936 | fpr=0.8820 | 7602.3 samples/s | 29.7 steps/s
[Step= 400] | Loss=7.46974 | acc=0.1317 | tpr=0.8972 | fpr=0.8822 | 7850.8 samples/s | 30.7 steps/s
[Step= 450] | Loss=7.47753 | acc=0.1312 | tpr=0.8948 | fpr=0.8826 | 8360.2 samples/s | 32.7 steps/s
[Step= 500] | Loss=7.48034 | acc=0.1314 | tpr=0.8938 | fpr=0.8824 | 7958.2 samples/s | 31.1 steps/s
[Step= 550] | Loss=7.48048 | acc=0.1313 | tpr=0.8957 | fpr=0.8826 | 10028.1 samples/s | 39.2 steps/s
Avg test loss: 7.48067, Avg test acc: 0.13123, Avg tpr: 0.89580, Avg fpr: 0.88267, total FA: 122557

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.29061 | acc=0.1190 | tpr=0.8451 | fpr=0.8941 | 4591.3 samples/s | 17.9 steps/s
[Step= 100] | Loss=5.28413 | acc=0.1181 | tpr=0.8593 | fpr=0.8957 | 7859.2 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.28027 | acc=0.1189 | tpr=0.8674 | fpr=0.8948 | 7718.0 samples/s | 30.1 steps/s
[Step= 200] | Loss=5.27034 | acc=0.1200 | tpr=0.8634 | fpr=0.8935 | 8062.5 samples/s | 31.5 steps/s
[Step= 250] | Loss=5.27005 | acc=0.1214 | tpr=0.8559 | fpr=0.8920 | 8189.1 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.26995 | acc=0.1214 | tpr=0.8524 | fpr=0.8919 | 7847.5 samples/s | 30.7 steps/s
[Step= 350] | Loss=5.27303 | acc=0.1212 | tpr=0.8535 | fpr=0.8921 | 8275.2 samples/s | 32.3 steps/s
[Step= 400] | Loss=5.27466 | acc=0.1210 | tpr=0.8528 | fpr=0.8923 | 7702.9 samples/s | 30.1 steps/s
[Step= 450] | Loss=5.27909 | acc=0.1207 | tpr=0.8544 | fpr=0.8927 | 7614.3 samples/s | 29.7 steps/s
[Step= 500] | Loss=5.28194 | acc=0.1204 | tpr=0.8515 | fpr=0.8928 | 8264.7 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.28064 | acc=0.1205 | tpr=0.8536 | fpr=0.8928 | 11118.0 samples/s | 43.4 steps/s
Avg test loss: 5.28182, Avg test acc: 0.12046, Avg tpr: 0.85380, Avg fpr: 0.89287, total FA: 123973

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.15772 | acc=0.9566 | tpr=0.9159 | fpr=0.0427 | 4686.4 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.16015 | acc=0.9557 | tpr=0.9083 | fpr=0.0435 | 7837.3 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.16340 | acc=0.9543 | tpr=0.9164 | fpr=0.0450 | 7561.4 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.16513 | acc=0.9543 | tpr=0.9180 | fpr=0.0450 | 8079.2 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.16574 | acc=0.9542 | tpr=0.9135 | fpr=0.0451 | 8189.9 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.16731 | acc=0.9537 | tpr=0.9127 | fpr=0.0456 | 8743.5 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.16732 | acc=0.9538 | tpr=0.9123 | fpr=0.0455 | 7762.7 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.16801 | acc=0.9536 | tpr=0.9048 | fpr=0.0455 | 7867.5 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.16964 | acc=0.9533 | tpr=0.9031 | fpr=0.0458 | 7699.4 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.16980 | acc=0.9533 | tpr=0.9075 | fpr=0.0459 | 8468.5 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.16965 | acc=0.9533 | tpr=0.9061 | fpr=0.0458 | 9521.3 samples/s | 37.2 steps/s
Avg test loss: 0.16955, Avg test acc: 0.95335, Avg tpr: 0.90571, Avg fpr: 0.04578, total FA: 6357

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11344 | acc=0.9641 | tpr=0.8938 | fpr=0.0347 | 4647.9 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.11657 | acc=0.9634 | tpr=0.8998 | fpr=0.0354 | 7987.9 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.11730 | acc=0.9633 | tpr=0.8977 | fpr=0.0355 | 7612.4 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.11669 | acc=0.9634 | tpr=0.8962 | fpr=0.0354 | 8464.4 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.11857 | acc=0.9630 | tpr=0.8987 | fpr=0.0359 | 7549.5 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.11906 | acc=0.9628 | tpr=0.8982 | fpr=0.0360 | 7953.1 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.12009 | acc=0.9628 | tpr=0.9023 | fpr=0.0361 | 7897.4 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.12136 | acc=0.9623 | tpr=0.8977 | fpr=0.0366 | 8104.6 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.12224 | acc=0.9619 | tpr=0.8968 | fpr=0.0369 | 7836.1 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.12191 | acc=0.9620 | tpr=0.9000 | fpr=0.0369 | 7673.5 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.12205 | acc=0.9619 | tpr=0.8957 | fpr=0.0369 | 11662.6 samples/s | 45.6 steps/s
Avg test loss: 0.12190, Avg test acc: 0.96191, Avg tpr: 0.89540, Avg fpr: 0.03688, total FA: 5121

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26655 | acc=0.9484 | tpr=0.9159 | fpr=0.0511 | 4689.4 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.26933 | acc=0.9471 | tpr=0.9062 | fpr=0.0522 | 8243.8 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.27438 | acc=0.9456 | tpr=0.9092 | fpr=0.0538 | 7804.9 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.27663 | acc=0.9456 | tpr=0.9148 | fpr=0.0539 | 8009.1 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.27965 | acc=0.9454 | tpr=0.9074 | fpr=0.0539 | 7882.5 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.28389 | acc=0.9450 | tpr=0.9033 | fpr=0.0542 | 7887.1 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.28256 | acc=0.9452 | tpr=0.9042 | fpr=0.0540 | 8090.8 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.28386 | acc=0.9450 | tpr=0.9026 | fpr=0.0543 | 7428.0 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.28438 | acc=0.9446 | tpr=0.9012 | fpr=0.0546 | 8188.4 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.28486 | acc=0.9445 | tpr=0.9044 | fpr=0.0548 | 8185.6 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.28398 | acc=0.9447 | tpr=0.9041 | fpr=0.0546 | 10052.8 samples/s | 39.3 steps/s
Avg test loss: 0.28375, Avg test acc: 0.94469, Avg tpr: 0.90452, Avg fpr: 0.05458, total FA: 7578

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10109 | acc=0.9677 | tpr=0.8628 | fpr=0.0304 | 4791.5 samples/s | 18.7 steps/s
[Step= 100] | Loss=0.10345 | acc=0.9681 | tpr=0.8742 | fpr=0.0301 | 7758.7 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.10545 | acc=0.9673 | tpr=0.8905 | fpr=0.0312 | 8066.4 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.10506 | acc=0.9678 | tpr=0.8973 | fpr=0.0309 | 7542.8 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.10693 | acc=0.9678 | tpr=0.8908 | fpr=0.0308 | 8311.9 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.10755 | acc=0.9677 | tpr=0.8909 | fpr=0.0309 | 7625.9 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.10807 | acc=0.9676 | tpr=0.8936 | fpr=0.0310 | 7907.3 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.10869 | acc=0.9675 | tpr=0.8917 | fpr=0.0312 | 7885.2 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.10985 | acc=0.9673 | tpr=0.8900 | fpr=0.0313 | 7437.4 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.10891 | acc=0.9674 | tpr=0.8912 | fpr=0.0312 | 8341.9 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.10837 | acc=0.9675 | tpr=0.8906 | fpr=0.0311 | 11043.2 samples/s | 43.1 steps/s
Avg test loss: 0.10826, Avg test acc: 0.96755, Avg tpr: 0.89105, Avg fpr: 0.03106, total FA: 4313

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.22605 | acc=0.9578 | tpr=0.8938 | fpr=0.0410 | 4462.7 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.23137 | acc=0.9575 | tpr=0.9126 | fpr=0.0416 | 8640.5 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.23793 | acc=0.9564 | tpr=0.9049 | fpr=0.0426 | 8267.1 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.23877 | acc=0.9562 | tpr=0.9093 | fpr=0.0430 | 8036.4 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.24197 | acc=0.9557 | tpr=0.9031 | fpr=0.0433 | 7822.1 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.24571 | acc=0.9553 | tpr=0.9040 | fpr=0.0438 | 8124.0 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.24611 | acc=0.9554 | tpr=0.9042 | fpr=0.0437 | 7673.2 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.24626 | acc=0.9552 | tpr=0.9021 | fpr=0.0438 | 8473.9 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.24838 | acc=0.9547 | tpr=0.8982 | fpr=0.0442 | 7342.5 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.24910 | acc=0.9546 | tpr=0.9000 | fpr=0.0444 | 8404.5 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.24867 | acc=0.9547 | tpr=0.8981 | fpr=0.0443 | 9708.8 samples/s | 37.9 steps/s
Avg test loss: 0.24834, Avg test acc: 0.95473, Avg tpr: 0.89739, Avg fpr: 0.04423, total FA: 6141

server round 9/50

clients selected: [0 1 3 5 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=12001 Epoch=58.5] | Loss=0.07529 | Reg=0.00166 | acc=0.9062 | L2-Norm=12.876 | L2-Norm(final)=11.168 | 3179.8 samples/s | 49.7 steps/s
[Step=12050 Epoch=58.8] | Loss=0.08896 | Reg=0.00166 | acc=0.9219 | L2-Norm=12.880 | L2-Norm(final)=11.226 | 4927.5 samples/s | 77.0 steps/s
[Step=12100 Epoch=59.0] | Loss=0.08814 | Reg=0.00166 | acc=0.9375 | L2-Norm=12.881 | L2-Norm(final)=11.304 | 5556.5 samples/s | 86.8 steps/s
[Step=12150 Epoch=59.2] | Loss=0.08631 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.881 | L2-Norm(final)=11.387 | 5403.6 samples/s | 84.4 steps/s
[Step=12200 Epoch=59.5] | Loss=0.08727 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.881 | L2-Norm(final)=11.462 | 8456.4 samples/s | 132.1 steps/s
[Step=12250 Epoch=59.7] | Loss=0.08644 | Reg=0.00166 | acc=0.9531 | L2-Norm=12.881 | L2-Norm(final)=11.531 | 1514.7 samples/s | 23.7 steps/s
[Step=12300 Epoch=60.0] | Loss=0.08759 | Reg=0.00166 | acc=0.9375 | L2-Norm=12.881 | L2-Norm(final)=11.597 | 5428.2 samples/s | 84.8 steps/s
[Step=12350 Epoch=60.2] | Loss=0.08728 | Reg=0.00166 | acc=0.9219 | L2-Norm=12.881 | L2-Norm(final)=11.656 | 5551.6 samples/s | 86.7 steps/s
[Step=12400 Epoch=60.5] | Loss=0.08704 | Reg=0.00166 | acc=0.9375 | L2-Norm=12.881 | L2-Norm(final)=11.714 | 7510.4 samples/s | 117.3 steps/s
[Step=12450 Epoch=60.7] | Loss=0.08655 | Reg=0.00166 | acc=0.8906 | L2-Norm=12.881 | L2-Norm(final)=11.772 | 1502.5 samples/s | 23.5 steps/s
[Step=12500 Epoch=61.0] | Loss=0.08653 | Reg=0.00166 | acc=0.8906 | L2-Norm=12.881 | L2-Norm(final)=11.829 | 5446.0 samples/s | 85.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=61.0] | Loss=0.06073 | Reg=0.00166 | acc=0.9375 | L2-Norm=12.882 | L2-Norm(final)=12.402 | 3125.6 samples/s | 48.8 steps/s
[Step=12550 Epoch=61.2] | Loss=0.07911 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.227 | L2-Norm(final)=12.378 | 4355.2 samples/s | 68.0 steps/s
[Step=12600 Epoch=61.4] | Loss=0.07575 | Reg=0.00181 | acc=0.9375 | L2-Norm=13.460 | L2-Norm(final)=12.349 | 4717.4 samples/s | 73.7 steps/s
[Step=12650 Epoch=61.7] | Loss=0.07097 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.607 | L2-Norm(final)=12.328 | 4689.0 samples/s | 73.3 steps/s
[Step=12700 Epoch=61.9] | Loss=0.07083 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.718 | L2-Norm(final)=12.310 | 6750.4 samples/s | 105.5 steps/s
[Step=12750 Epoch=62.2] | Loss=0.06378 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.811 | L2-Norm(final)=12.297 | 1451.7 samples/s | 22.7 steps/s
[Step=12800 Epoch=62.4] | Loss=0.06045 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.894 | L2-Norm(final)=12.289 | 4679.3 samples/s | 73.1 steps/s
[Step=12850 Epoch=62.7] | Loss=0.05718 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.971 | L2-Norm(final)=12.280 | 4582.7 samples/s | 71.6 steps/s
[Step=12900 Epoch=62.9] | Loss=0.05553 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.042 | L2-Norm(final)=12.274 | 6135.9 samples/s | 95.9 steps/s
[Step=12950 Epoch=63.1] | Loss=0.05347 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.114 | L2-Norm(final)=12.266 | 1442.4 samples/s | 22.5 steps/s
[Step=13000 Epoch=63.4] | Loss=0.05120 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.184 | L2-Norm(final)=12.261 | 4702.8 samples/s | 73.5 steps/s
[Step=13050 Epoch=63.6] | Loss=0.04930 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.248 | L2-Norm(final)=12.256 | 4697.9 samples/s | 73.4 steps/s
[Step=13100 Epoch=63.9] | Loss=0.04756 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.309 | L2-Norm(final)=12.251 | 5623.1 samples/s | 87.9 steps/s
[Step=13150 Epoch=64.1] | Loss=0.04598 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.366 | L2-Norm(final)=12.245 | 1453.9 samples/s | 22.7 steps/s
[Step=13200 Epoch=64.4] | Loss=0.04413 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.417 | L2-Norm(final)=12.241 | 4688.9 samples/s | 73.3 steps/s
[Step=13250 Epoch=64.6] | Loss=0.04249 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.464 | L2-Norm(final)=12.237 | 4668.3 samples/s | 72.9 steps/s
[Step=13300 Epoch=64.9] | Loss=0.04135 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.507 | L2-Norm(final)=12.234 | 5201.1 samples/s | 81.3 steps/s
[Step=13350 Epoch=65.1] | Loss=0.04001 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.549 | L2-Norm(final)=12.230 | 1496.9 samples/s | 23.4 steps/s
[Step=13400 Epoch=65.3] | Loss=0.03879 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.589 | L2-Norm(final)=12.227 | 4697.0 samples/s | 73.4 steps/s
[Step=13450 Epoch=65.6] | Loss=0.03761 | Reg=0.00214 | acc=0.9531 | L2-Norm=14.625 | L2-Norm(final)=12.225 | 4654.9 samples/s | 72.7 steps/s
[Step=13500 Epoch=65.8] | Loss=0.03715 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.661 | L2-Norm(final)=12.222 | 4859.9 samples/s | 75.9 steps/s
[Step=13550 Epoch=66.1] | Loss=0.03627 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.696 | L2-Norm(final)=12.219 | 1573.4 samples/s | 24.6 steps/s
[Step=13600 Epoch=66.3] | Loss=0.03511 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.729 | L2-Norm(final)=12.216 | 4672.7 samples/s | 73.0 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03427 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.760 | L2-Norm(final)=12.214 | 4681.4 samples/s | 73.1 steps/s
[Step=13700 Epoch=66.8] | Loss=0.03342 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.790 | L2-Norm(final)=12.212 | 4684.9 samples/s | 73.2 steps/s
[Step=13750 Epoch=67.0] | Loss=0.03282 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.819 | L2-Norm(final)=12.210 | 1556.2 samples/s | 24.3 steps/s
[Step=13800 Epoch=67.3] | Loss=0.03214 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.846 | L2-Norm(final)=12.209 | 4761.2 samples/s | 74.4 steps/s
[Step=13850 Epoch=67.5] | Loss=0.03148 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.873 | L2-Norm(final)=12.207 | 4612.6 samples/s | 72.1 steps/s
[Step=13900 Epoch=67.8] | Loss=0.03070 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.899 | L2-Norm(final)=12.206 | 4679.4 samples/s | 73.1 steps/s
[Step=13950 Epoch=68.0] | Loss=0.03026 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.924 | L2-Norm(final)=12.204 | 1563.9 samples/s | 24.4 steps/s
[Step=14000 Epoch=68.3] | Loss=0.02979 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.949 | L2-Norm(final)=12.203 | 4709.0 samples/s | 73.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step14000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=48.8] | Loss=0.16717 | Reg=0.00166 | acc=0.8750 | L2-Norm=12.876 | L2-Norm(final)=9.578 | 3209.0 samples/s | 50.1 steps/s
[Step=10050 Epoch=49.0] | Loss=0.12631 | Reg=0.00166 | acc=0.9219 | L2-Norm=12.878 | L2-Norm(final)=9.652 | 4803.2 samples/s | 75.0 steps/s
[Step=10100 Epoch=49.3] | Loss=0.11008 | Reg=0.00166 | acc=0.9219 | L2-Norm=12.879 | L2-Norm(final)=9.725 | 5585.7 samples/s | 87.3 steps/s
[Step=10150 Epoch=49.5] | Loss=0.10511 | Reg=0.00166 | acc=0.9375 | L2-Norm=12.879 | L2-Norm(final)=9.799 | 5429.9 samples/s | 84.8 steps/s
[Step=10200 Epoch=49.8] | Loss=0.10252 | Reg=0.00166 | acc=0.9375 | L2-Norm=12.879 | L2-Norm(final)=9.867 | 8476.4 samples/s | 132.4 steps/s
[Step=10250 Epoch=50.0] | Loss=0.10127 | Reg=0.00166 | acc=0.8906 | L2-Norm=12.880 | L2-Norm(final)=9.929 | 1461.7 samples/s | 22.8 steps/s
[Step=10300 Epoch=50.3] | Loss=0.10019 | Reg=0.00166 | acc=0.9375 | L2-Norm=12.880 | L2-Norm(final)=9.991 | 5626.0 samples/s | 87.9 steps/s
[Step=10350 Epoch=50.5] | Loss=0.09936 | Reg=0.00166 | acc=0.8906 | L2-Norm=12.880 | L2-Norm(final)=10.052 | 5457.6 samples/s | 85.3 steps/s
[Step=10400 Epoch=50.7] | Loss=0.09793 | Reg=0.00166 | acc=0.9531 | L2-Norm=12.880 | L2-Norm(final)=10.111 | 7605.4 samples/s | 118.8 steps/s
[Step=10450 Epoch=51.0] | Loss=0.09694 | Reg=0.00166 | acc=0.9375 | L2-Norm=12.880 | L2-Norm(final)=10.169 | 1492.5 samples/s | 23.3 steps/s
[Step=10500 Epoch=51.2] | Loss=0.09684 | Reg=0.00166 | acc=0.9219 | L2-Norm=12.880 | L2-Norm(final)=10.226 | 5417.1 samples/s | 84.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=51.2] | Loss=0.09877 | Reg=0.00166 | acc=0.9062 | L2-Norm=12.880 | L2-Norm(final)=10.790 | 3225.3 samples/s | 50.4 steps/s
[Step=10550 Epoch=51.5] | Loss=0.08050 | Reg=0.00174 | acc=0.9375 | L2-Norm=13.205 | L2-Norm(final)=10.780 | 4149.7 samples/s | 64.8 steps/s
[Step=10600 Epoch=51.7] | Loss=0.08500 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.502 | L2-Norm(final)=10.744 | 4704.4 samples/s | 73.5 steps/s
[Step=10650 Epoch=52.0] | Loss=0.08073 | Reg=0.00188 | acc=0.9375 | L2-Norm=13.709 | L2-Norm(final)=10.716 | 4706.1 samples/s | 73.5 steps/s
[Step=10700 Epoch=52.2] | Loss=0.07419 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.853 | L2-Norm(final)=10.701 | 6815.8 samples/s | 106.5 steps/s
[Step=10750 Epoch=52.5] | Loss=0.06661 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.961 | L2-Norm(final)=10.690 | 1422.7 samples/s | 22.2 steps/s
[Step=10800 Epoch=52.7] | Loss=0.06153 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.048 | L2-Norm(final)=10.684 | 4707.2 samples/s | 73.6 steps/s
[Step=10850 Epoch=52.9] | Loss=0.05811 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.121 | L2-Norm(final)=10.680 | 4783.2 samples/s | 74.7 steps/s
[Step=10900 Epoch=53.2] | Loss=0.05566 | Reg=0.00201 | acc=0.9219 | L2-Norm=14.185 | L2-Norm(final)=10.676 | 6127.4 samples/s | 95.7 steps/s
[Step=10950 Epoch=53.4] | Loss=0.05379 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.248 | L2-Norm(final)=10.670 | 1455.6 samples/s | 22.7 steps/s
[Step=11000 Epoch=53.7] | Loss=0.05095 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.313 | L2-Norm(final)=10.665 | 4679.1 samples/s | 73.1 steps/s
[Step=11050 Epoch=53.9] | Loss=0.04899 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.373 | L2-Norm(final)=10.662 | 4678.6 samples/s | 73.1 steps/s
[Step=11100 Epoch=54.2] | Loss=0.04706 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.429 | L2-Norm(final)=10.659 | 5855.5 samples/s | 91.5 steps/s
[Step=11150 Epoch=54.4] | Loss=0.04498 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.481 | L2-Norm(final)=10.657 | 1497.6 samples/s | 23.4 steps/s
[Step=11200 Epoch=54.7] | Loss=0.04305 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.528 | L2-Norm(final)=10.655 | 4717.3 samples/s | 73.7 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04139 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.571 | L2-Norm(final)=10.654 | 4667.1 samples/s | 72.9 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03998 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.609 | L2-Norm(final)=10.653 | 5468.3 samples/s | 85.4 steps/s
[Step=11350 Epoch=55.4] | Loss=0.03837 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.644 | L2-Norm(final)=10.652 | 1499.3 samples/s | 23.4 steps/s
[Step=11400 Epoch=55.6] | Loss=0.03699 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.676 | L2-Norm(final)=10.652 | 4707.4 samples/s | 73.6 steps/s
[Step=11450 Epoch=55.9] | Loss=0.03578 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.706 | L2-Norm(final)=10.652 | 4656.9 samples/s | 72.8 steps/s
[Step=11500 Epoch=56.1] | Loss=0.03495 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.734 | L2-Norm(final)=10.652 | 5087.8 samples/s | 79.5 steps/s
[Step=11550 Epoch=56.4] | Loss=0.03405 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.761 | L2-Norm(final)=10.652 | 1555.4 samples/s | 24.3 steps/s
[Step=11600 Epoch=56.6] | Loss=0.03308 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.789 | L2-Norm(final)=10.652 | 4682.5 samples/s | 73.2 steps/s
[Step=11650 Epoch=56.8] | Loss=0.03260 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.817 | L2-Norm(final)=10.651 | 4728.0 samples/s | 73.9 steps/s
[Step=11700 Epoch=57.1] | Loss=0.03187 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.845 | L2-Norm(final)=10.650 | 4798.5 samples/s | 75.0 steps/s
[Step=11750 Epoch=57.3] | Loss=0.03138 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.873 | L2-Norm(final)=10.649 | 1533.5 samples/s | 24.0 steps/s
[Step=11800 Epoch=57.6] | Loss=0.03069 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.901 | L2-Norm(final)=10.648 | 4677.9 samples/s | 73.1 steps/s
[Step=11850 Epoch=57.8] | Loss=0.03019 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.929 | L2-Norm(final)=10.647 | 4735.7 samples/s | 74.0 steps/s
[Step=11900 Epoch=58.1] | Loss=0.02985 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.957 | L2-Norm(final)=10.646 | 4703.3 samples/s | 73.5 steps/s
[Step=11950 Epoch=58.3] | Loss=0.02983 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.986 | L2-Norm(final)=10.644 | 1532.3 samples/s | 23.9 steps/s
[Step=12000 Epoch=58.6] | Loss=0.02956 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.017 | L2-Norm(final)=10.642 | 4719.5 samples/s | 73.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_1/client_state-step12000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=14001 Epoch=68.3] | Loss=0.09475 | Reg=0.00166 | acc=0.9219 | L2-Norm=12.876 | L2-Norm(final)=11.588 | 3284.9 samples/s | 51.3 steps/s
[Step=14050 Epoch=68.5] | Loss=0.09538 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.881 | L2-Norm(final)=11.656 | 4723.6 samples/s | 73.8 steps/s
[Step=14100 Epoch=68.8] | Loss=0.09314 | Reg=0.00166 | acc=0.8906 | L2-Norm=12.882 | L2-Norm(final)=11.732 | 5491.3 samples/s | 85.8 steps/s
[Step=14150 Epoch=69.0] | Loss=0.09196 | Reg=0.00166 | acc=0.9375 | L2-Norm=12.882 | L2-Norm(final)=11.803 | 5462.2 samples/s | 85.3 steps/s
[Step=14200 Epoch=69.2] | Loss=0.09053 | Reg=0.00166 | acc=0.9375 | L2-Norm=12.882 | L2-Norm(final)=11.880 | 8550.9 samples/s | 133.6 steps/s
[Step=14250 Epoch=69.5] | Loss=0.08923 | Reg=0.00166 | acc=0.9062 | L2-Norm=12.882 | L2-Norm(final)=11.958 | 1478.7 samples/s | 23.1 steps/s
[Step=14300 Epoch=69.7] | Loss=0.08974 | Reg=0.00166 | acc=0.9219 | L2-Norm=12.883 | L2-Norm(final)=12.032 | 5513.5 samples/s | 86.1 steps/s
[Step=14350 Epoch=70.0] | Loss=0.09061 | Reg=0.00166 | acc=0.9219 | L2-Norm=12.883 | L2-Norm(final)=12.103 | 5681.8 samples/s | 88.8 steps/s
[Step=14400 Epoch=70.2] | Loss=0.08939 | Reg=0.00166 | acc=0.9219 | L2-Norm=12.883 | L2-Norm(final)=12.173 | 7250.1 samples/s | 113.3 steps/s
[Step=14450 Epoch=70.5] | Loss=0.08932 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.883 | L2-Norm(final)=12.242 | 1514.6 samples/s | 23.7 steps/s
[Step=14500 Epoch=70.7] | Loss=0.08892 | Reg=0.00166 | acc=0.9062 | L2-Norm=12.883 | L2-Norm(final)=12.309 | 5422.9 samples/s | 84.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=14501 Epoch=70.7] | Loss=0.06420 | Reg=0.00166 | acc=0.9531 | L2-Norm=12.883 | L2-Norm(final)=12.981 | 3268.9 samples/s | 51.1 steps/s
[Step=14550 Epoch=71.0] | Loss=0.07818 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.209 | L2-Norm(final)=12.975 | 4166.9 samples/s | 65.1 steps/s
[Step=14600 Epoch=71.2] | Loss=0.07808 | Reg=0.00182 | acc=0.8750 | L2-Norm=13.489 | L2-Norm(final)=12.933 | 4755.7 samples/s | 74.3 steps/s
[Step=14650 Epoch=71.4] | Loss=0.07460 | Reg=0.00187 | acc=0.9531 | L2-Norm=13.666 | L2-Norm(final)=12.909 | 4616.5 samples/s | 72.1 steps/s
[Step=14700 Epoch=71.7] | Loss=0.07176 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.799 | L2-Norm(final)=12.890 | 6704.6 samples/s | 104.8 steps/s
[Step=14750 Epoch=71.9] | Loss=0.06569 | Reg=0.00194 | acc=0.9531 | L2-Norm=13.906 | L2-Norm(final)=12.878 | 1421.7 samples/s | 22.2 steps/s
[Step=14800 Epoch=72.2] | Loss=0.06034 | Reg=0.00196 | acc=0.9688 | L2-Norm=13.993 | L2-Norm(final)=12.872 | 4625.7 samples/s | 72.3 steps/s
[Step=14850 Epoch=72.4] | Loss=0.05696 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.068 | L2-Norm(final)=12.865 | 4720.4 samples/s | 73.8 steps/s
[Step=14900 Epoch=72.7] | Loss=0.05507 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.135 | L2-Norm(final)=12.860 | 6108.9 samples/s | 95.5 steps/s
[Step=14950 Epoch=72.9] | Loss=0.05205 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.199 | L2-Norm(final)=12.856 | 1435.7 samples/s | 22.4 steps/s
[Step=15000 Epoch=73.1] | Loss=0.04943 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.258 | L2-Norm(final)=12.854 | 4726.8 samples/s | 73.9 steps/s
[Step=15050 Epoch=73.4] | Loss=0.04713 | Reg=0.00205 | acc=0.9531 | L2-Norm=14.313 | L2-Norm(final)=12.853 | 4678.6 samples/s | 73.1 steps/s
[Step=15100 Epoch=73.6] | Loss=0.04596 | Reg=0.00207 | acc=0.9531 | L2-Norm=14.367 | L2-Norm(final)=12.851 | 5681.9 samples/s | 88.8 steps/s
[Step=15150 Epoch=73.9] | Loss=0.04467 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.421 | L2-Norm(final)=12.849 | 1519.5 samples/s | 23.7 steps/s
[Step=15200 Epoch=74.1] | Loss=0.04329 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.470 | L2-Norm(final)=12.847 | 4779.2 samples/s | 74.7 steps/s
[Step=15250 Epoch=74.4] | Loss=0.04210 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.517 | L2-Norm(final)=12.844 | 4596.7 samples/s | 71.8 steps/s
[Step=15300 Epoch=74.6] | Loss=0.04070 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.561 | L2-Norm(final)=12.842 | 5243.2 samples/s | 81.9 steps/s
[Step=15350 Epoch=74.9] | Loss=0.03935 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.602 | L2-Norm(final)=12.841 | 1520.3 samples/s | 23.8 steps/s
[Step=15400 Epoch=75.1] | Loss=0.03776 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.640 | L2-Norm(final)=12.840 | 4692.8 samples/s | 73.3 steps/s
[Step=15450 Epoch=75.3] | Loss=0.03654 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.674 | L2-Norm(final)=12.839 | 4668.9 samples/s | 73.0 steps/s
[Step=15500 Epoch=75.6] | Loss=0.03574 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.706 | L2-Norm(final)=12.838 | 4832.0 samples/s | 75.5 steps/s
[Step=15550 Epoch=75.8] | Loss=0.03476 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.737 | L2-Norm(final)=12.838 | 1550.7 samples/s | 24.2 steps/s
[Step=15600 Epoch=76.1] | Loss=0.03379 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.767 | L2-Norm(final)=12.837 | 4609.9 samples/s | 72.0 steps/s
[Step=15650 Epoch=76.3] | Loss=0.03310 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.796 | L2-Norm(final)=12.836 | 4712.5 samples/s | 73.6 steps/s
[Step=15700 Epoch=76.6] | Loss=0.03248 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.824 | L2-Norm(final)=12.835 | 4705.2 samples/s | 73.5 steps/s
[Step=15750 Epoch=76.8] | Loss=0.03197 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.852 | L2-Norm(final)=12.833 | 1568.5 samples/s | 24.5 steps/s
[Step=15800 Epoch=77.0] | Loss=0.03127 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.880 | L2-Norm(final)=12.832 | 4728.0 samples/s | 73.9 steps/s
[Step=15850 Epoch=77.3] | Loss=0.03068 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.908 | L2-Norm(final)=12.831 | 4669.8 samples/s | 73.0 steps/s
[Step=15900 Epoch=77.5] | Loss=0.03027 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.935 | L2-Norm(final)=12.830 | 4723.6 samples/s | 73.8 steps/s
[Step=15950 Epoch=77.8] | Loss=0.02995 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.963 | L2-Norm(final)=12.828 | 1564.0 samples/s | 24.4 steps/s
[Step=16000 Epoch=78.0] | Loss=0.02980 | Reg=0.00225 | acc=0.9688 | L2-Norm=14.994 | L2-Norm(final)=12.826 | 4750.3 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=12001 Epoch=113.7] | Loss=0.06964 | Reg=0.00166 | acc=0.9375 | L2-Norm=12.876 | L2-Norm(final)=12.974 | 3206.2 samples/s | 50.1 steps/s
[Step=12050 Epoch=114.2] | Loss=0.02692 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.866 | L2-Norm(final)=12.888 | 4542.7 samples/s | 71.0 steps/s
[Step=12100 Epoch=114.7] | Loss=0.02229 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.865 | L2-Norm(final)=12.864 | 7996.4 samples/s | 124.9 steps/s
[Step=12150 Epoch=115.1] | Loss=0.02019 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.865 | L2-Norm(final)=12.898 | 1463.8 samples/s | 22.9 steps/s
[Step=12200 Epoch=115.6] | Loss=0.01958 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.865 | L2-Norm(final)=12.964 | 7202.9 samples/s | 112.5 steps/s
[Step=12250 Epoch=116.1] | Loss=0.01880 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.864 | L2-Norm(final)=13.055 | 1471.3 samples/s | 23.0 steps/s
[Step=12300 Epoch=116.6] | Loss=0.01824 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.864 | L2-Norm(final)=13.149 | 6546.8 samples/s | 102.3 steps/s
[Step=12350 Epoch=117.0] | Loss=0.01791 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.864 | L2-Norm(final)=13.245 | 1542.8 samples/s | 24.1 steps/s
[Step=12400 Epoch=117.5] | Loss=0.01739 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.864 | L2-Norm(final)=13.337 | 5882.0 samples/s | 91.9 steps/s
[Step=12450 Epoch=118.0] | Loss=0.01725 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.864 | L2-Norm(final)=13.430 | 1543.0 samples/s | 24.1 steps/s
[Step=12500 Epoch=118.4] | Loss=0.01689 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.864 | L2-Norm(final)=13.519 | 5288.7 samples/s | 82.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=118.5] | Loss=0.01225 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.864 | L2-Norm(final)=14.402 | 3152.4 samples/s | 49.3 steps/s
[Step=12550 Epoch=118.9] | Loss=0.02544 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.289 | L2-Norm(final)=14.394 | 4022.9 samples/s | 62.9 steps/s
[Step=12600 Epoch=119.4] | Loss=0.02230 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.707 | L2-Norm(final)=14.319 | 6560.0 samples/s | 102.5 steps/s
[Step=12650 Epoch=119.9] | Loss=0.01709 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.881 | L2-Norm(final)=14.286 | 1379.5 samples/s | 21.6 steps/s
[Step=12700 Epoch=120.3] | Loss=0.01292 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.951 | L2-Norm(final)=14.275 | 5780.6 samples/s | 90.3 steps/s
[Step=12750 Epoch=120.8] | Loss=0.01034 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.972 | L2-Norm(final)=14.271 | 1394.5 samples/s | 21.8 steps/s
[Step=12800 Epoch=121.3] | Loss=0.00864 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.969 | L2-Norm(final)=14.269 | 5396.8 samples/s | 84.3 steps/s
[Step=12850 Epoch=121.8] | Loss=0.00741 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.954 | L2-Norm(final)=14.268 | 1463.4 samples/s | 22.9 steps/s
[Step=12900 Epoch=122.2] | Loss=0.00649 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.931 | L2-Norm(final)=14.267 | 4886.2 samples/s | 76.3 steps/s
[Step=12950 Epoch=122.7] | Loss=0.00577 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.903 | L2-Norm(final)=14.267 | 1459.5 samples/s | 22.8 steps/s
[Step=13000 Epoch=123.2] | Loss=0.00519 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.873 | L2-Norm(final)=14.267 | 4588.8 samples/s | 71.7 steps/s
[Step=13050 Epoch=123.7] | Loss=0.00472 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.841 | L2-Norm(final)=14.267 | 1509.4 samples/s | 23.6 steps/s
[Step=13100 Epoch=124.1] | Loss=0.00433 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.809 | L2-Norm(final)=14.268 | 4548.6 samples/s | 71.1 steps/s
[Step=13150 Epoch=124.6] | Loss=0.00400 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.775 | L2-Norm(final)=14.268 | 1536.6 samples/s | 24.0 steps/s
[Step=13200 Epoch=125.1] | Loss=0.00371 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.741 | L2-Norm(final)=14.268 | 4420.0 samples/s | 69.1 steps/s
[Step=13250 Epoch=125.6] | Loss=0.00346 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.707 | L2-Norm(final)=14.269 | 1516.0 samples/s | 23.7 steps/s
[Step=13300 Epoch=126.0] | Loss=0.00325 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.673 | L2-Norm(final)=14.269 | 4523.5 samples/s | 70.7 steps/s
[Step=13350 Epoch=126.5] | Loss=0.00306 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.639 | L2-Norm(final)=14.270 | 1552.6 samples/s | 24.3 steps/s
[Step=13400 Epoch=127.0] | Loss=0.00289 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.605 | L2-Norm(final)=14.270 | 4303.9 samples/s | 67.2 steps/s
[Step=13450 Epoch=127.5] | Loss=0.00274 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.572 | L2-Norm(final)=14.271 | 6532.6 samples/s | 102.1 steps/s
[Step=13500 Epoch=127.9] | Loss=0.00260 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.538 | L2-Norm(final)=14.271 | 1375.5 samples/s | 21.5 steps/s
[Step=13550 Epoch=128.4] | Loss=0.00248 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.505 | L2-Norm(final)=14.272 | 6001.5 samples/s | 93.8 steps/s
[Step=13600 Epoch=128.9] | Loss=0.00236 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.472 | L2-Norm(final)=14.272 | 1397.9 samples/s | 21.8 steps/s
[Step=13650 Epoch=129.3] | Loss=0.00226 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.439 | L2-Norm(final)=14.273 | 5445.8 samples/s | 85.1 steps/s
[Step=13700 Epoch=129.8] | Loss=0.00217 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.406 | L2-Norm(final)=14.273 | 1443.2 samples/s | 22.6 steps/s
[Step=13750 Epoch=130.3] | Loss=0.00208 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=14.274 | 5078.1 samples/s | 79.3 steps/s
[Step=13800 Epoch=130.8] | Loss=0.00200 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=14.274 | 1456.2 samples/s | 22.8 steps/s
[Step=13850 Epoch=131.2] | Loss=0.00193 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=14.275 | 4627.4 samples/s | 72.3 steps/s
[Step=13900 Epoch=131.7] | Loss=0.00186 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.278 | L2-Norm(final)=14.276 | 1522.2 samples/s | 23.8 steps/s
[Step=13950 Epoch=132.2] | Loss=0.00179 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.247 | L2-Norm(final)=14.276 | 4455.6 samples/s | 69.6 steps/s
[Step=14000 Epoch=132.7] | Loss=0.00173 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.215 | L2-Norm(final)=14.277 | 1549.5 samples/s | 24.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step14000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=95.3] | Loss=0.03985 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.876 | L2-Norm(final)=13.040 | 3237.1 samples/s | 50.6 steps/s
[Step=10050 Epoch=95.8] | Loss=0.02190 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.867 | L2-Norm(final)=13.009 | 4547.5 samples/s | 71.1 steps/s
[Step=10100 Epoch=96.3] | Loss=0.01950 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.866 | L2-Norm(final)=13.073 | 8271.6 samples/s | 129.2 steps/s
[Step=10150 Epoch=96.7] | Loss=0.01934 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.866 | L2-Norm(final)=13.172 | 1425.1 samples/s | 22.3 steps/s
[Step=10200 Epoch=97.2] | Loss=0.01924 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.865 | L2-Norm(final)=13.283 | 7508.5 samples/s | 117.3 steps/s
[Step=10250 Epoch=97.7] | Loss=0.01834 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.865 | L2-Norm(final)=13.403 | 1455.4 samples/s | 22.7 steps/s
[Step=10300 Epoch=98.2] | Loss=0.01832 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.865 | L2-Norm(final)=13.521 | 6739.6 samples/s | 105.3 steps/s
[Step=10350 Epoch=98.6] | Loss=0.01797 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.865 | L2-Norm(final)=13.636 | 1526.1 samples/s | 23.8 steps/s
[Step=10400 Epoch=99.1] | Loss=0.01774 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.865 | L2-Norm(final)=13.751 | 6067.6 samples/s | 94.8 steps/s
[Step=10450 Epoch=99.6] | Loss=0.01755 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.865 | L2-Norm(final)=13.864 | 1517.4 samples/s | 23.7 steps/s
[Step=10500 Epoch=100.1] | Loss=0.01747 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.865 | L2-Norm(final)=13.974 | 5719.4 samples/s | 89.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=100.1] | Loss=0.01592 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.865 | L2-Norm(final)=15.078 | 3120.0 samples/s | 48.7 steps/s
[Step=10550 Epoch=100.6] | Loss=0.02811 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.477 | L2-Norm(final)=15.071 | 4105.6 samples/s | 64.1 steps/s
[Step=10600 Epoch=101.0] | Loss=0.02113 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.958 | L2-Norm(final)=14.993 | 6558.3 samples/s | 102.5 steps/s
[Step=10650 Epoch=101.5] | Loss=0.01495 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.143 | L2-Norm(final)=14.963 | 1399.1 samples/s | 21.9 steps/s
[Step=10700 Epoch=102.0] | Loss=0.01202 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.219 | L2-Norm(final)=14.949 | 6092.0 samples/s | 95.2 steps/s
[Step=10750 Epoch=102.5] | Loss=0.01070 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.264 | L2-Norm(final)=14.937 | 1418.0 samples/s | 22.2 steps/s
[Step=10800 Epoch=102.9] | Loss=0.00948 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.310 | L2-Norm(final)=14.925 | 5516.3 samples/s | 86.2 steps/s
[Step=10850 Epoch=103.4] | Loss=0.00833 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.340 | L2-Norm(final)=14.916 | 1439.7 samples/s | 22.5 steps/s
[Step=10900 Epoch=103.9] | Loss=0.00731 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=14.910 | 5230.8 samples/s | 81.7 steps/s
[Step=10950 Epoch=104.4] | Loss=0.00650 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.358 | L2-Norm(final)=14.905 | 1462.5 samples/s | 22.9 steps/s
[Step=11000 Epoch=104.8] | Loss=0.00585 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.353 | L2-Norm(final)=14.902 | 4832.7 samples/s | 75.5 steps/s
[Step=11050 Epoch=105.3] | Loss=0.00532 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.342 | L2-Norm(final)=14.899 | 1512.1 samples/s | 23.6 steps/s
[Step=11100 Epoch=105.8] | Loss=0.00488 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.327 | L2-Norm(final)=14.896 | 4607.5 samples/s | 72.0 steps/s
[Step=11150 Epoch=106.3] | Loss=0.00450 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.308 | L2-Norm(final)=14.895 | 1519.9 samples/s | 23.7 steps/s
[Step=11200 Epoch=106.7] | Loss=0.00418 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.288 | L2-Norm(final)=14.893 | 4347.2 samples/s | 67.9 steps/s
[Step=11250 Epoch=107.2] | Loss=0.00390 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.266 | L2-Norm(final)=14.892 | 1513.1 samples/s | 23.6 steps/s
[Step=11300 Epoch=107.7] | Loss=0.00366 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.243 | L2-Norm(final)=14.891 | 4455.2 samples/s | 69.6 steps/s
[Step=11350 Epoch=108.2] | Loss=0.00345 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.219 | L2-Norm(final)=14.890 | 1542.0 samples/s | 24.1 steps/s
[Step=11400 Epoch=108.7] | Loss=0.00326 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.194 | L2-Norm(final)=14.889 | 4484.0 samples/s | 70.1 steps/s
[Step=11450 Epoch=109.1] | Loss=0.00308 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.168 | L2-Norm(final)=14.888 | 1534.8 samples/s | 24.0 steps/s
[Step=11500 Epoch=109.6] | Loss=0.00293 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.142 | L2-Norm(final)=14.888 | 4489.8 samples/s | 70.2 steps/s
[Step=11550 Epoch=110.1] | Loss=0.00279 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.116 | L2-Norm(final)=14.887 | 7273.3 samples/s | 113.6 steps/s
[Step=11600 Epoch=110.6] | Loss=0.00266 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=14.887 | 1364.0 samples/s | 21.3 steps/s
[Step=11650 Epoch=111.0] | Loss=0.00255 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.063 | L2-Norm(final)=14.886 | 6551.8 samples/s | 102.4 steps/s
[Step=11700 Epoch=111.5] | Loss=0.00244 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.036 | L2-Norm(final)=14.886 | 1410.7 samples/s | 22.0 steps/s
[Step=11750 Epoch=112.0] | Loss=0.00235 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.009 | L2-Norm(final)=14.886 | 6079.6 samples/s | 95.0 steps/s
[Step=11800 Epoch=112.5] | Loss=0.00226 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.982 | L2-Norm(final)=14.886 | 1408.1 samples/s | 22.0 steps/s
[Step=11850 Epoch=112.9] | Loss=0.00217 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.955 | L2-Norm(final)=14.885 | 5531.8 samples/s | 86.4 steps/s
[Step=11900 Epoch=113.4] | Loss=0.00209 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.928 | L2-Norm(final)=14.885 | 1428.4 samples/s | 22.3 steps/s
[Step=11950 Epoch=113.9] | Loss=0.00202 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.901 | L2-Norm(final)=14.885 | 5245.4 samples/s | 82.0 steps/s
[Step=12000 Epoch=114.4] | Loss=0.00196 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.874 | L2-Norm(final)=14.885 | 1425.5 samples/s | 22.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.13400 | acc=0.9428 | tpr=0.9628 | fpr=0.1006 | 4666.7 samples/s | 18.2 steps/s
Avg test loss: 0.14192, Avg test acc: 0.94022, Avg tpr: 0.96083, Avg fpr: 0.10511, total FA: 820

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.12567 | acc=0.9355 | tpr=0.9525 | fpr=0.1013 | 4608.7 samples/s | 18.0 steps/s
Avg test loss: 0.12758, Avg test acc: 0.93497, Avg tpr: 0.95215, Avg fpr: 0.10281, total FA: 802

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.14190 | acc=0.9352 | tpr=0.9533 | fpr=0.1043 | 4744.7 samples/s | 18.5 steps/s
Avg test loss: 0.14511, Avg test acc: 0.93445, Avg tpr: 0.95279, Avg fpr: 0.10588, total FA: 826

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.13608 | acc=0.9345 | tpr=0.9544 | fpr=0.1088 | 4516.3 samples/s | 17.6 steps/s
Avg test loss: 0.14166, Avg test acc: 0.93249, Avg tpr: 0.95326, Avg fpr: 0.11319, total FA: 883

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.13553 | acc=0.9330 | tpr=0.9469 | fpr=0.0974 | 4417.0 samples/s | 17.3 steps/s
Avg test loss: 0.13614, Avg test acc: 0.93249, Avg tpr: 0.94579, Avg fpr: 0.09678, total FA: 755

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.31758 | acc=0.3142 | tpr=0.0119 | fpr=0.0292 | 4556.7 samples/s | 17.8 steps/s
Avg test loss: 4.33461, Avg test acc: 0.31088, Avg tpr: 0.01078, Avg fpr: 0.02910, total FA: 227

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.12240 | acc=0.3212 | tpr=0.0226 | fpr=0.0305 | 4518.0 samples/s | 17.6 steps/s
Avg test loss: 4.14503, Avg test acc: 0.31958, Avg tpr: 0.02273, Avg fpr: 0.02756, total FA: 215

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.10127 | acc=0.3223 | tpr=0.0430 | fpr=0.0714 | 4777.4 samples/s | 18.7 steps/s
Avg test loss: 4.12030, Avg test acc: 0.32006, Avg tpr: 0.04237, Avg fpr: 0.06922, total FA: 540

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=3.89136 | acc=0.3230 | tpr=0.0221 | fpr=0.0235 | 4723.4 samples/s | 18.5 steps/s
Avg test loss: 3.91250, Avg test acc: 0.32142, Avg tpr: 0.02261, Avg fpr: 0.02141, total FA: 167

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.60683 | acc=0.3137 | tpr=0.0094 | fpr=0.0255 | 4460.6 samples/s | 17.4 steps/s
Avg test loss: 5.63480, Avg test acc: 0.31100, Avg tpr: 0.00868, Avg fpr: 0.02410, total FA: 188

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.76295 | acc=0.1222 | tpr=0.8274 | fpr=0.8905 | 4714.2 samples/s | 18.4 steps/s
[Step= 100] | Loss=6.73096 | acc=0.1220 | tpr=0.8209 | fpr=0.8910 | 7413.2 samples/s | 29.0 steps/s
[Step= 150] | Loss=6.74071 | acc=0.1219 | tpr=0.8228 | fpr=0.8910 | 8427.6 samples/s | 32.9 steps/s
[Step= 200] | Loss=6.72521 | acc=0.1217 | tpr=0.8208 | fpr=0.8910 | 8242.1 samples/s | 32.2 steps/s
[Step= 250] | Loss=6.72249 | acc=0.1216 | tpr=0.8175 | fpr=0.8910 | 7930.5 samples/s | 31.0 steps/s
[Step= 300] | Loss=6.71838 | acc=0.1219 | tpr=0.8131 | fpr=0.8907 | 7764.1 samples/s | 30.3 steps/s
[Step= 350] | Loss=6.72795 | acc=0.1212 | tpr=0.8140 | fpr=0.8914 | 7988.6 samples/s | 31.2 steps/s
[Step= 400] | Loss=6.72365 | acc=0.1212 | tpr=0.8140 | fpr=0.8914 | 8522.2 samples/s | 33.3 steps/s
[Step= 450] | Loss=6.72627 | acc=0.1215 | tpr=0.8101 | fpr=0.8910 | 7612.3 samples/s | 29.7 steps/s
[Step= 500] | Loss=6.72998 | acc=0.1214 | tpr=0.8101 | fpr=0.8910 | 8275.3 samples/s | 32.3 steps/s
[Step= 550] | Loss=6.72718 | acc=0.1213 | tpr=0.8126 | fpr=0.8912 | 9517.3 samples/s | 37.2 steps/s
Avg test loss: 6.72820, Avg test acc: 0.12121, Avg tpr: 0.81181, Avg fpr: 0.89134, total FA: 123761

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.83342 | acc=0.1494 | tpr=0.7920 | fpr=0.8622 | 4568.2 samples/s | 17.8 steps/s
[Step= 100] | Loss=5.79863 | acc=0.1514 | tpr=0.7761 | fpr=0.8602 | 8016.2 samples/s | 31.3 steps/s
[Step= 150] | Loss=5.78499 | acc=0.1522 | tpr=0.7853 | fpr=0.8594 | 7745.3 samples/s | 30.3 steps/s
[Step= 200] | Loss=5.78008 | acc=0.1523 | tpr=0.7803 | fpr=0.8592 | 8599.1 samples/s | 33.6 steps/s
[Step= 250] | Loss=5.77499 | acc=0.1527 | tpr=0.7852 | fpr=0.8588 | 7767.7 samples/s | 30.3 steps/s
[Step= 300] | Loss=5.77359 | acc=0.1538 | tpr=0.7891 | fpr=0.8578 | 7674.7 samples/s | 30.0 steps/s
[Step= 350] | Loss=5.78149 | acc=0.1531 | tpr=0.7896 | fpr=0.8584 | 8249.4 samples/s | 32.2 steps/s
[Step= 400] | Loss=5.78330 | acc=0.1529 | tpr=0.7784 | fpr=0.8584 | 7738.8 samples/s | 30.2 steps/s
[Step= 450] | Loss=5.78605 | acc=0.1525 | tpr=0.7780 | fpr=0.8588 | 7437.4 samples/s | 29.1 steps/s
[Step= 500] | Loss=5.78887 | acc=0.1527 | tpr=0.7762 | fpr=0.8586 | 8213.6 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.78719 | acc=0.1529 | tpr=0.7791 | fpr=0.8585 | 11439.4 samples/s | 44.7 steps/s
Avg test loss: 5.78796, Avg test acc: 0.15279, Avg tpr: 0.77892, Avg fpr: 0.85859, total FA: 119214

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.81440 | acc=0.1557 | tpr=0.8673 | fpr=0.8571 | 4648.3 samples/s | 18.2 steps/s
[Step= 100] | Loss=4.79084 | acc=0.1573 | tpr=0.8422 | fpr=0.8555 | 7802.4 samples/s | 30.5 steps/s
[Step= 150] | Loss=4.79254 | acc=0.1579 | tpr=0.8559 | fpr=0.8550 | 7438.1 samples/s | 29.1 steps/s
[Step= 200] | Loss=4.77531 | acc=0.1579 | tpr=0.8546 | fpr=0.8548 | 8186.2 samples/s | 32.0 steps/s
[Step= 250] | Loss=4.76951 | acc=0.1592 | tpr=0.8515 | fpr=0.8534 | 8128.7 samples/s | 31.8 steps/s
[Step= 300] | Loss=4.76695 | acc=0.1593 | tpr=0.8524 | fpr=0.8534 | 7999.2 samples/s | 31.2 steps/s
[Step= 350] | Loss=4.77000 | acc=0.1592 | tpr=0.8541 | fpr=0.8535 | 7820.8 samples/s | 30.6 steps/s
[Step= 400] | Loss=4.77175 | acc=0.1591 | tpr=0.8556 | fpr=0.8536 | 8385.0 samples/s | 32.8 steps/s
[Step= 450] | Loss=4.76988 | acc=0.1589 | tpr=0.8505 | fpr=0.8537 | 6970.1 samples/s | 27.2 steps/s
[Step= 500] | Loss=4.77227 | acc=0.1590 | tpr=0.8480 | fpr=0.8535 | 8229.5 samples/s | 32.1 steps/s
[Step= 550] | Loss=4.77279 | acc=0.1591 | tpr=0.8512 | fpr=0.8535 | 12276.2 samples/s | 48.0 steps/s
Avg test loss: 4.77273, Avg test acc: 0.15904, Avg tpr: 0.85143, Avg fpr: 0.85354, total FA: 118513

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.06937 | acc=0.1381 | tpr=0.8850 | fpr=0.8753 | 4474.3 samples/s | 17.5 steps/s
[Step= 100] | Loss=6.02414 | acc=0.1409 | tpr=0.8635 | fpr=0.8726 | 8505.9 samples/s | 33.2 steps/s
[Step= 150] | Loss=6.02465 | acc=0.1410 | tpr=0.8703 | fpr=0.8724 | 8219.2 samples/s | 32.1 steps/s
[Step= 200] | Loss=6.00648 | acc=0.1405 | tpr=0.8623 | fpr=0.8727 | 8199.7 samples/s | 32.0 steps/s
[Step= 250] | Loss=6.00279 | acc=0.1418 | tpr=0.8707 | fpr=0.8715 | 7805.7 samples/s | 30.5 steps/s
[Step= 300] | Loss=5.99710 | acc=0.1421 | tpr=0.8655 | fpr=0.8711 | 7842.1 samples/s | 30.6 steps/s
[Step= 350] | Loss=6.01192 | acc=0.1419 | tpr=0.8710 | fpr=0.8713 | 7907.5 samples/s | 30.9 steps/s
[Step= 400] | Loss=6.01258 | acc=0.1416 | tpr=0.8671 | fpr=0.8716 | 7739.3 samples/s | 30.2 steps/s
[Step= 450] | Loss=6.01956 | acc=0.1413 | tpr=0.8671 | fpr=0.8719 | 7799.8 samples/s | 30.5 steps/s
[Step= 500] | Loss=6.02590 | acc=0.1413 | tpr=0.8674 | fpr=0.8718 | 8172.4 samples/s | 31.9 steps/s
[Step= 550] | Loss=6.02516 | acc=0.1415 | tpr=0.8667 | fpr=0.8717 | 10443.4 samples/s | 40.8 steps/s
Avg test loss: 6.02523, Avg test acc: 0.14140, Avg tpr: 0.86688, Avg fpr: 0.87179, total FA: 121046

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.29061 | acc=0.1190 | tpr=0.8451 | fpr=0.8941 | 4756.7 samples/s | 18.6 steps/s
[Step= 100] | Loss=5.28413 | acc=0.1181 | tpr=0.8593 | fpr=0.8957 | 8059.7 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.28027 | acc=0.1189 | tpr=0.8674 | fpr=0.8948 | 7739.1 samples/s | 30.2 steps/s
[Step= 200] | Loss=5.27034 | acc=0.1200 | tpr=0.8634 | fpr=0.8935 | 7255.7 samples/s | 28.3 steps/s
[Step= 250] | Loss=5.27005 | acc=0.1214 | tpr=0.8559 | fpr=0.8920 | 8055.4 samples/s | 31.5 steps/s
[Step= 300] | Loss=5.26995 | acc=0.1214 | tpr=0.8524 | fpr=0.8919 | 8232.5 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.27303 | acc=0.1212 | tpr=0.8535 | fpr=0.8921 | 8003.5 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.27466 | acc=0.1210 | tpr=0.8528 | fpr=0.8923 | 8207.5 samples/s | 32.1 steps/s
[Step= 450] | Loss=5.27909 | acc=0.1207 | tpr=0.8544 | fpr=0.8927 | 8016.2 samples/s | 31.3 steps/s
[Step= 500] | Loss=5.28194 | acc=0.1204 | tpr=0.8515 | fpr=0.8928 | 7883.4 samples/s | 30.8 steps/s
[Step= 550] | Loss=5.28064 | acc=0.1205 | tpr=0.8536 | fpr=0.8928 | 10691.5 samples/s | 41.8 steps/s
Avg test loss: 5.28182, Avg test acc: 0.12046, Avg tpr: 0.85380, Avg fpr: 0.89287, total FA: 123973

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.16213 | acc=0.9622 | tpr=0.9027 | fpr=0.0367 | 4742.7 samples/s | 18.5 steps/s
[Step= 100] | Loss=0.16260 | acc=0.9600 | tpr=0.9147 | fpr=0.0391 | 7867.3 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.16700 | acc=0.9593 | tpr=0.9207 | fpr=0.0399 | 7110.6 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.16841 | acc=0.9597 | tpr=0.9257 | fpr=0.0397 | 7825.3 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.16981 | acc=0.9596 | tpr=0.9223 | fpr=0.0397 | 8287.4 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.17138 | acc=0.9592 | tpr=0.9200 | fpr=0.0401 | 7856.2 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.17060 | acc=0.9593 | tpr=0.9167 | fpr=0.0399 | 8473.0 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.17156 | acc=0.9590 | tpr=0.9130 | fpr=0.0402 | 7450.6 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.17285 | acc=0.9586 | tpr=0.9085 | fpr=0.0405 | 8316.9 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.17300 | acc=0.9586 | tpr=0.9106 | fpr=0.0405 | 7885.8 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.17255 | acc=0.9588 | tpr=0.9065 | fpr=0.0403 | 11027.7 samples/s | 43.1 steps/s
Avg test loss: 0.17227, Avg test acc: 0.95880, Avg tpr: 0.90689, Avg fpr: 0.04025, total FA: 5589

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11344 | acc=0.9641 | tpr=0.8938 | fpr=0.0347 | 4668.1 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.11657 | acc=0.9634 | tpr=0.8998 | fpr=0.0354 | 7656.8 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.11730 | acc=0.9633 | tpr=0.8977 | fpr=0.0355 | 7844.9 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.11669 | acc=0.9634 | tpr=0.8962 | fpr=0.0354 | 8228.0 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.11857 | acc=0.9630 | tpr=0.8987 | fpr=0.0359 | 8367.2 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.11906 | acc=0.9628 | tpr=0.8982 | fpr=0.0360 | 7514.3 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.12009 | acc=0.9628 | tpr=0.9023 | fpr=0.0361 | 8198.3 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.12136 | acc=0.9623 | tpr=0.8977 | fpr=0.0366 | 8185.9 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.12224 | acc=0.9619 | tpr=0.8968 | fpr=0.0369 | 7346.1 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.12191 | acc=0.9620 | tpr=0.9000 | fpr=0.0369 | 7893.4 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.12205 | acc=0.9619 | tpr=0.8957 | fpr=0.0369 | 11471.4 samples/s | 44.8 steps/s
Avg test loss: 0.12190, Avg test acc: 0.96191, Avg tpr: 0.89540, Avg fpr: 0.03688, total FA: 5121

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26655 | acc=0.9484 | tpr=0.9159 | fpr=0.0511 | 4740.0 samples/s | 18.5 steps/s
[Step= 100] | Loss=0.26933 | acc=0.9471 | tpr=0.9062 | fpr=0.0522 | 8205.8 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.27438 | acc=0.9456 | tpr=0.9092 | fpr=0.0538 | 7678.7 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.27663 | acc=0.9456 | tpr=0.9148 | fpr=0.0539 | 7248.0 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.27965 | acc=0.9454 | tpr=0.9074 | fpr=0.0539 | 8561.9 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.28389 | acc=0.9450 | tpr=0.9033 | fpr=0.0542 | 7997.5 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.28256 | acc=0.9452 | tpr=0.9042 | fpr=0.0540 | 8148.0 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.28386 | acc=0.9450 | tpr=0.9026 | fpr=0.0543 | 7641.7 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.28438 | acc=0.9446 | tpr=0.9012 | fpr=0.0546 | 8270.0 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.28486 | acc=0.9445 | tpr=0.9044 | fpr=0.0548 | 7992.8 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.28398 | acc=0.9447 | tpr=0.9041 | fpr=0.0546 | 9840.0 samples/s | 38.4 steps/s
Avg test loss: 0.28375, Avg test acc: 0.94469, Avg tpr: 0.90452, Avg fpr: 0.05458, total FA: 7578

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10109 | acc=0.9677 | tpr=0.8628 | fpr=0.0304 | 4683.1 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.10345 | acc=0.9681 | tpr=0.8742 | fpr=0.0301 | 7385.5 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.10545 | acc=0.9673 | tpr=0.8905 | fpr=0.0312 | 8419.7 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.10506 | acc=0.9678 | tpr=0.8973 | fpr=0.0309 | 7863.8 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.10693 | acc=0.9678 | tpr=0.8908 | fpr=0.0308 | 8096.1 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.10755 | acc=0.9677 | tpr=0.8909 | fpr=0.0309 | 7526.3 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.10807 | acc=0.9676 | tpr=0.8936 | fpr=0.0310 | 7581.8 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.10869 | acc=0.9675 | tpr=0.8917 | fpr=0.0312 | 8123.8 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.10985 | acc=0.9673 | tpr=0.8900 | fpr=0.0313 | 7992.8 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.10891 | acc=0.9674 | tpr=0.8912 | fpr=0.0312 | 7910.8 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.10837 | acc=0.9675 | tpr=0.8906 | fpr=0.0311 | 10944.9 samples/s | 42.8 steps/s
Avg test loss: 0.10826, Avg test acc: 0.96755, Avg tpr: 0.89105, Avg fpr: 0.03106, total FA: 4313

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.17299 | acc=0.9644 | tpr=0.9115 | fpr=0.0347 | 4495.3 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.17871 | acc=0.9623 | tpr=0.9211 | fpr=0.0370 | 8185.9 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.17975 | acc=0.9620 | tpr=0.9280 | fpr=0.0374 | 8129.4 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.18024 | acc=0.9624 | tpr=0.9333 | fpr=0.0371 | 8092.5 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.18173 | acc=0.9622 | tpr=0.9293 | fpr=0.0372 | 7746.7 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.18334 | acc=0.9619 | tpr=0.9258 | fpr=0.0375 | 7738.2 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.18523 | acc=0.9618 | tpr=0.9224 | fpr=0.0375 | 8355.0 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.18582 | acc=0.9616 | tpr=0.9190 | fpr=0.0377 | 8032.3 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.18717 | acc=0.9611 | tpr=0.9172 | fpr=0.0382 | 7616.0 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.18765 | acc=0.9609 | tpr=0.9181 | fpr=0.0384 | 8312.7 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.18650 | acc=0.9611 | tpr=0.9160 | fpr=0.0381 | 9492.8 samples/s | 37.1 steps/s
Avg test loss: 0.18612, Avg test acc: 0.96114, Avg tpr: 0.91601, Avg fpr: 0.03804, total FA: 5282

server round 10/50

clients selected: [2 3 4 6 7]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=4001 Epoch=19.5] | Loss=0.14443 | Reg=0.00163 | acc=0.8906 | L2-Norm=12.776 | L2-Norm(final)=6.897 | 3095.1 samples/s | 48.4 steps/s
[Step=4050 Epoch=19.7] | Loss=0.11945 | Reg=0.00163 | acc=0.9219 | L2-Norm=12.780 | L2-Norm(final)=6.984 | 4909.4 samples/s | 76.7 steps/s
[Step=4100 Epoch=20.0] | Loss=0.12036 | Reg=0.00163 | acc=0.9375 | L2-Norm=12.781 | L2-Norm(final)=7.082 | 5441.6 samples/s | 85.0 steps/s
[Step=4150 Epoch=20.2] | Loss=0.11876 | Reg=0.00163 | acc=0.9375 | L2-Norm=12.781 | L2-Norm(final)=7.176 | 5383.5 samples/s | 84.1 steps/s
[Step=4200 Epoch=20.5] | Loss=0.11814 | Reg=0.00163 | acc=0.8594 | L2-Norm=12.781 | L2-Norm(final)=7.264 | 8368.4 samples/s | 130.8 steps/s
[Step=4250 Epoch=20.7] | Loss=0.11781 | Reg=0.00163 | acc=0.8906 | L2-Norm=12.781 | L2-Norm(final)=7.346 | 1473.0 samples/s | 23.0 steps/s
[Step=4300 Epoch=21.0] | Loss=0.11671 | Reg=0.00163 | acc=0.9062 | L2-Norm=12.781 | L2-Norm(final)=7.425 | 5481.6 samples/s | 85.6 steps/s
[Step=4350 Epoch=21.2] | Loss=0.11607 | Reg=0.00163 | acc=0.9062 | L2-Norm=12.781 | L2-Norm(final)=7.499 | 5435.2 samples/s | 84.9 steps/s
[Step=4400 Epoch=21.4] | Loss=0.11532 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.781 | L2-Norm(final)=7.572 | 7446.7 samples/s | 116.4 steps/s
[Step=4450 Epoch=21.7] | Loss=0.11417 | Reg=0.00163 | acc=0.9219 | L2-Norm=12.781 | L2-Norm(final)=7.643 | 1474.1 samples/s | 23.0 steps/s
[Step=4500 Epoch=21.9] | Loss=0.11420 | Reg=0.00163 | acc=0.9062 | L2-Norm=12.781 | L2-Norm(final)=7.711 | 5526.3 samples/s | 86.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=4501 Epoch=21.9] | Loss=0.11084 | Reg=0.00163 | acc=0.9062 | L2-Norm=12.781 | L2-Norm(final)=8.378 | 3166.7 samples/s | 49.5 steps/s
[Step=4550 Epoch=22.2] | Loss=0.07817 | Reg=0.00165 | acc=0.9062 | L2-Norm=12.864 | L2-Norm(final)=8.411 | 4186.1 samples/s | 65.4 steps/s
[Step=4600 Epoch=22.4] | Loss=0.06802 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.932 | L2-Norm(final)=8.416 | 4662.0 samples/s | 72.8 steps/s
[Step=4650 Epoch=22.7] | Loss=0.06165 | Reg=0.00169 | acc=0.9375 | L2-Norm=12.982 | L2-Norm(final)=8.418 | 4650.4 samples/s | 72.7 steps/s
[Step=4700 Epoch=22.9] | Loss=0.05756 | Reg=0.00170 | acc=0.9531 | L2-Norm=13.025 | L2-Norm(final)=8.420 | 6560.4 samples/s | 102.5 steps/s
[Step=4750 Epoch=23.1] | Loss=0.05121 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.063 | L2-Norm(final)=8.423 | 1394.4 samples/s | 21.8 steps/s
[Step=4800 Epoch=23.4] | Loss=0.04737 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.096 | L2-Norm(final)=8.427 | 4628.4 samples/s | 72.3 steps/s
[Step=4850 Epoch=23.6] | Loss=0.04411 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.124 | L2-Norm(final)=8.431 | 4651.2 samples/s | 72.7 steps/s
[Step=4900 Epoch=23.9] | Loss=0.04148 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.151 | L2-Norm(final)=8.435 | 5983.7 samples/s | 93.5 steps/s
[Step=4950 Epoch=24.1] | Loss=0.03826 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.177 | L2-Norm(final)=8.440 | 1430.3 samples/s | 22.3 steps/s
[Step=5000 Epoch=24.4] | Loss=0.03597 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.201 | L2-Norm(final)=8.446 | 4619.4 samples/s | 72.2 steps/s
[Step=5050 Epoch=24.6] | Loss=0.03388 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.223 | L2-Norm(final)=8.452 | 4611.6 samples/s | 72.1 steps/s
[Step=5100 Epoch=24.8] | Loss=0.03214 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=8.456 | 5532.0 samples/s | 86.4 steps/s
[Step=5150 Epoch=25.1] | Loss=0.03041 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.261 | L2-Norm(final)=8.461 | 1482.5 samples/s | 23.2 steps/s
[Step=5200 Epoch=25.3] | Loss=0.02906 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.279 | L2-Norm(final)=8.466 | 4619.5 samples/s | 72.2 steps/s
[Step=5250 Epoch=25.6] | Loss=0.02782 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.295 | L2-Norm(final)=8.471 | 4640.6 samples/s | 72.5 steps/s
[Step=5300 Epoch=25.8] | Loss=0.02666 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=8.475 | 5084.9 samples/s | 79.5 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02564 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.325 | L2-Norm(final)=8.480 | 1473.5 samples/s | 23.0 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02475 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.338 | L2-Norm(final)=8.485 | 4667.6 samples/s | 72.9 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02389 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=8.489 | 4691.4 samples/s | 73.3 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02311 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=8.494 | 4684.6 samples/s | 73.2 steps/s
[Step=5550 Epoch=27.0] | Loss=0.02238 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.374 | L2-Norm(final)=8.498 | 1514.0 samples/s | 23.7 steps/s
[Step=5600 Epoch=27.3] | Loss=0.02167 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.385 | L2-Norm(final)=8.502 | 4679.4 samples/s | 73.1 steps/s
[Step=5650 Epoch=27.5] | Loss=0.02103 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.395 | L2-Norm(final)=8.506 | 4582.0 samples/s | 71.6 steps/s
[Step=5700 Epoch=27.8] | Loss=0.02056 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.404 | L2-Norm(final)=8.509 | 4707.8 samples/s | 73.6 steps/s
[Step=5750 Epoch=28.0] | Loss=0.02005 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.413 | L2-Norm(final)=8.513 | 1521.8 samples/s | 23.8 steps/s
[Step=5800 Epoch=28.3] | Loss=0.01955 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.422 | L2-Norm(final)=8.517 | 4682.7 samples/s | 73.2 steps/s
[Step=5850 Epoch=28.5] | Loss=0.01908 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.431 | L2-Norm(final)=8.521 | 4592.5 samples/s | 71.8 steps/s
[Step=5900 Epoch=28.7] | Loss=0.01865 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.439 | L2-Norm(final)=8.525 | 4603.5 samples/s | 71.9 steps/s
[Step=5950 Epoch=29.0] | Loss=0.01828 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.447 | L2-Norm(final)=8.528 | 1505.8 samples/s | 23.5 steps/s
[Step=6000 Epoch=29.2] | Loss=0.01788 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.455 | L2-Norm(final)=8.532 | 4588.9 samples/s | 71.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_2/client_state-step6000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=78.0] | Loss=0.08578 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.776 | L2-Norm(final)=12.759 | 2952.3 samples/s | 46.1 steps/s
[Step=16050 Epoch=78.3] | Loss=0.08016 | Reg=0.00163 | acc=0.9375 | L2-Norm=12.779 | L2-Norm(final)=12.802 | 5245.0 samples/s | 82.0 steps/s
[Step=16100 Epoch=78.5] | Loss=0.08369 | Reg=0.00163 | acc=0.9375 | L2-Norm=12.780 | L2-Norm(final)=12.858 | 5373.9 samples/s | 84.0 steps/s
[Step=16150 Epoch=78.8] | Loss=0.08428 | Reg=0.00163 | acc=0.9375 | L2-Norm=12.780 | L2-Norm(final)=12.909 | 5460.0 samples/s | 85.3 steps/s
[Step=16200 Epoch=79.0] | Loss=0.08487 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.780 | L2-Norm(final)=12.958 | 8273.1 samples/s | 129.3 steps/s
[Step=16250 Epoch=79.2] | Loss=0.08522 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.780 | L2-Norm(final)=13.004 | 1470.2 samples/s | 23.0 steps/s
[Step=16300 Epoch=79.5] | Loss=0.08458 | Reg=0.00163 | acc=0.9219 | L2-Norm=12.780 | L2-Norm(final)=13.048 | 5221.7 samples/s | 81.6 steps/s
[Step=16350 Epoch=79.7] | Loss=0.08432 | Reg=0.00163 | acc=0.9219 | L2-Norm=12.780 | L2-Norm(final)=13.091 | 5435.8 samples/s | 84.9 steps/s
[Step=16400 Epoch=80.0] | Loss=0.08417 | Reg=0.00163 | acc=0.9375 | L2-Norm=12.780 | L2-Norm(final)=13.134 | 7507.0 samples/s | 117.3 steps/s
[Step=16450 Epoch=80.2] | Loss=0.08401 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.780 | L2-Norm(final)=13.176 | 1489.3 samples/s | 23.3 steps/s
[Step=16500 Epoch=80.5] | Loss=0.08423 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.780 | L2-Norm(final)=13.217 | 5539.6 samples/s | 86.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=80.5] | Loss=0.11465 | Reg=0.00163 | acc=0.9062 | L2-Norm=12.780 | L2-Norm(final)=13.620 | 2924.8 samples/s | 45.7 steps/s
[Step=16550 Epoch=80.7] | Loss=0.06927 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.868 | L2-Norm(final)=13.626 | 4727.0 samples/s | 73.9 steps/s
[Step=16600 Epoch=81.0] | Loss=0.06030 | Reg=0.00168 | acc=0.9375 | L2-Norm=12.947 | L2-Norm(final)=13.620 | 4588.1 samples/s | 71.7 steps/s
[Step=16650 Epoch=81.2] | Loss=0.05430 | Reg=0.00169 | acc=0.9375 | L2-Norm=13.002 | L2-Norm(final)=13.619 | 4600.9 samples/s | 71.9 steps/s
[Step=16700 Epoch=81.4] | Loss=0.05071 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.044 | L2-Norm(final)=13.617 | 6609.3 samples/s | 103.3 steps/s
[Step=16750 Epoch=81.7] | Loss=0.04517 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.078 | L2-Norm(final)=13.617 | 1392.8 samples/s | 21.8 steps/s
[Step=16800 Epoch=81.9] | Loss=0.04071 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.106 | L2-Norm(final)=13.619 | 4708.0 samples/s | 73.6 steps/s
[Step=16850 Epoch=82.2] | Loss=0.03729 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.129 | L2-Norm(final)=13.621 | 4570.7 samples/s | 71.4 steps/s
[Step=16900 Epoch=82.4] | Loss=0.03487 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.149 | L2-Norm(final)=13.625 | 5992.0 samples/s | 93.6 steps/s
[Step=16950 Epoch=82.7] | Loss=0.03230 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.167 | L2-Norm(final)=13.628 | 1428.7 samples/s | 22.3 steps/s
[Step=17000 Epoch=82.9] | Loss=0.03049 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.184 | L2-Norm(final)=13.631 | 4698.5 samples/s | 73.4 steps/s
[Step=17050 Epoch=83.1] | Loss=0.02872 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.199 | L2-Norm(final)=13.635 | 4574.9 samples/s | 71.5 steps/s
[Step=17100 Epoch=83.4] | Loss=0.02747 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.212 | L2-Norm(final)=13.638 | 5501.0 samples/s | 86.0 steps/s
[Step=17150 Epoch=83.6] | Loss=0.02626 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=13.642 | 1421.7 samples/s | 22.2 steps/s
[Step=17200 Epoch=83.9] | Loss=0.02511 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.236 | L2-Norm(final)=13.645 | 4676.8 samples/s | 73.1 steps/s
[Step=17250 Epoch=84.1] | Loss=0.02407 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.246 | L2-Norm(final)=13.648 | 4631.0 samples/s | 72.4 steps/s
[Step=17300 Epoch=84.4] | Loss=0.02305 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.256 | L2-Norm(final)=13.651 | 5165.7 samples/s | 80.7 steps/s
[Step=17350 Epoch=84.6] | Loss=0.02197 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.264 | L2-Norm(final)=13.654 | 1475.2 samples/s | 23.1 steps/s
[Step=17400 Epoch=84.9] | Loss=0.02105 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.272 | L2-Norm(final)=13.658 | 4643.7 samples/s | 72.6 steps/s
[Step=17450 Epoch=85.1] | Loss=0.02029 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.280 | L2-Norm(final)=13.661 | 4595.0 samples/s | 71.8 steps/s
[Step=17500 Epoch=85.3] | Loss=0.01978 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.286 | L2-Norm(final)=13.664 | 4765.0 samples/s | 74.5 steps/s
[Step=17550 Epoch=85.6] | Loss=0.01921 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.293 | L2-Norm(final)=13.667 | 1481.6 samples/s | 23.2 steps/s
[Step=17600 Epoch=85.8] | Loss=0.01874 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.299 | L2-Norm(final)=13.669 | 4688.4 samples/s | 73.3 steps/s
[Step=17650 Epoch=86.1] | Loss=0.01820 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.305 | L2-Norm(final)=13.672 | 4585.8 samples/s | 71.7 steps/s
[Step=17700 Epoch=86.3] | Loss=0.01760 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=13.675 | 4603.7 samples/s | 71.9 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01710 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.316 | L2-Norm(final)=13.678 | 1543.2 samples/s | 24.1 steps/s
[Step=17800 Epoch=86.8] | Loss=0.01659 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.321 | L2-Norm(final)=13.681 | 4634.2 samples/s | 72.4 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01609 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.326 | L2-Norm(final)=13.684 | 4590.5 samples/s | 71.7 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01578 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.330 | L2-Norm(final)=13.687 | 4644.5 samples/s | 72.6 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01545 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=13.690 | 1502.7 samples/s | 23.5 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01503 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=13.692 | 4625.0 samples/s | 72.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step18000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=2001 Epoch= 9.8] | Loss=0.12274 | Reg=0.00163 | acc=0.8906 | L2-Norm=12.776 | L2-Norm(final)=6.013 | 3150.7 samples/s | 49.2 steps/s
[Step=2050 Epoch=10.1] | Loss=0.13472 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.780 | L2-Norm(final)=6.079 | 4799.1 samples/s | 75.0 steps/s
[Step=2100 Epoch=10.3] | Loss=0.13065 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.781 | L2-Norm(final)=6.187 | 5403.8 samples/s | 84.4 steps/s
[Step=2150 Epoch=10.5] | Loss=0.12885 | Reg=0.00163 | acc=0.8750 | L2-Norm=12.781 | L2-Norm(final)=6.292 | 5470.5 samples/s | 85.5 steps/s
[Step=2200 Epoch=10.8] | Loss=0.12666 | Reg=0.00163 | acc=0.9219 | L2-Norm=12.782 | L2-Norm(final)=6.390 | 8583.8 samples/s | 134.1 steps/s
[Step=2250 Epoch=11.0] | Loss=0.12475 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.782 | L2-Norm(final)=6.486 | 1452.8 samples/s | 22.7 steps/s
[Step=2300 Epoch=11.3] | Loss=0.12367 | Reg=0.00163 | acc=0.9219 | L2-Norm=12.782 | L2-Norm(final)=6.577 | 5457.5 samples/s | 85.3 steps/s
[Step=2350 Epoch=11.5] | Loss=0.12274 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.782 | L2-Norm(final)=6.664 | 5292.9 samples/s | 82.7 steps/s
[Step=2400 Epoch=11.8] | Loss=0.12166 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.782 | L2-Norm(final)=6.745 | 8022.3 samples/s | 125.3 steps/s
[Step=2450 Epoch=12.0] | Loss=0.12069 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.782 | L2-Norm(final)=6.824 | 1460.2 samples/s | 22.8 steps/s
[Step=2500 Epoch=12.3] | Loss=0.11991 | Reg=0.00163 | acc=0.9375 | L2-Norm=12.782 | L2-Norm(final)=6.901 | 5381.9 samples/s | 84.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=2501 Epoch=12.3] | Loss=0.11960 | Reg=0.00163 | acc=0.8906 | L2-Norm=12.782 | L2-Norm(final)=7.659 | 3215.0 samples/s | 50.2 steps/s
[Step=2550 Epoch=12.5] | Loss=0.08309 | Reg=0.00165 | acc=0.8906 | L2-Norm=12.860 | L2-Norm(final)=7.698 | 4168.5 samples/s | 65.1 steps/s
[Step=2600 Epoch=12.7] | Loss=0.07549 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.916 | L2-Norm(final)=7.698 | 4599.4 samples/s | 71.9 steps/s
[Step=2650 Epoch=13.0] | Loss=0.06839 | Reg=0.00168 | acc=0.9219 | L2-Norm=12.961 | L2-Norm(final)=7.699 | 4612.8 samples/s | 72.1 steps/s
[Step=2700 Epoch=13.2] | Loss=0.06327 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.000 | L2-Norm(final)=7.702 | 6788.5 samples/s | 106.1 steps/s
[Step=2750 Epoch=13.5] | Loss=0.05532 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.036 | L2-Norm(final)=7.706 | 1378.0 samples/s | 21.5 steps/s
[Step=2800 Epoch=13.7] | Loss=0.04985 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.068 | L2-Norm(final)=7.713 | 4519.0 samples/s | 70.6 steps/s
[Step=2850 Epoch=14.0] | Loss=0.04647 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.097 | L2-Norm(final)=7.720 | 4634.1 samples/s | 72.4 steps/s
[Step=2900 Epoch=14.2] | Loss=0.04345 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.123 | L2-Norm(final)=7.726 | 6361.6 samples/s | 99.4 steps/s
[Step=2950 Epoch=14.5] | Loss=0.04016 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.148 | L2-Norm(final)=7.733 | 1391.6 samples/s | 21.7 steps/s
[Step=3000 Epoch=14.7] | Loss=0.03730 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.172 | L2-Norm(final)=7.741 | 4627.3 samples/s | 72.3 steps/s
[Step=3050 Epoch=15.0] | Loss=0.03530 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.194 | L2-Norm(final)=7.748 | 4656.7 samples/s | 72.8 steps/s
[Step=3100 Epoch=15.2] | Loss=0.03380 | Reg=0.00175 | acc=0.9531 | L2-Norm=13.215 | L2-Norm(final)=7.754 | 6047.6 samples/s | 94.5 steps/s
[Step=3150 Epoch=15.4] | Loss=0.03185 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.235 | L2-Norm(final)=7.759 | 1482.4 samples/s | 23.2 steps/s
[Step=3200 Epoch=15.7] | Loss=0.03041 | Reg=0.00176 | acc=0.9688 | L2-Norm=13.253 | L2-Norm(final)=7.765 | 4590.8 samples/s | 71.7 steps/s
[Step=3250 Epoch=15.9] | Loss=0.02912 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=7.771 | 4676.8 samples/s | 73.1 steps/s
[Step=3300 Epoch=16.2] | Loss=0.02809 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=7.776 | 5619.6 samples/s | 87.8 steps/s
[Step=3350 Epoch=16.4] | Loss=0.02709 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.301 | L2-Norm(final)=7.780 | 1418.0 samples/s | 22.2 steps/s
[Step=3400 Epoch=16.7] | Loss=0.02614 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.316 | L2-Norm(final)=7.785 | 4636.0 samples/s | 72.4 steps/s
[Step=3450 Epoch=16.9] | Loss=0.02516 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.330 | L2-Norm(final)=7.790 | 4562.1 samples/s | 71.3 steps/s
[Step=3500 Epoch=17.2] | Loss=0.02427 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=7.795 | 5379.6 samples/s | 84.1 steps/s
[Step=3550 Epoch=17.4] | Loss=0.02351 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=7.800 | 1440.4 samples/s | 22.5 steps/s
[Step=3600 Epoch=17.7] | Loss=0.02268 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=7.804 | 4653.2 samples/s | 72.7 steps/s
[Step=3650 Epoch=17.9] | Loss=0.02192 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=7.809 | 4655.2 samples/s | 72.7 steps/s
[Step=3700 Epoch=18.1] | Loss=0.02123 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.391 | L2-Norm(final)=7.814 | 5060.5 samples/s | 79.1 steps/s
[Step=3750 Epoch=18.4] | Loss=0.02068 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=7.818 | 1463.4 samples/s | 22.9 steps/s
[Step=3800 Epoch=18.6] | Loss=0.02015 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.411 | L2-Norm(final)=7.823 | 4576.7 samples/s | 71.5 steps/s
[Step=3850 Epoch=18.9] | Loss=0.01971 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=7.827 | 4618.8 samples/s | 72.2 steps/s
[Step=3900 Epoch=19.1] | Loss=0.01933 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.430 | L2-Norm(final)=7.831 | 4840.2 samples/s | 75.6 steps/s
[Step=3950 Epoch=19.4] | Loss=0.01884 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.439 | L2-Norm(final)=7.835 | 1481.3 samples/s | 23.1 steps/s
[Step=4000 Epoch=19.6] | Loss=0.01834 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.448 | L2-Norm(final)=7.839 | 4637.7 samples/s | 72.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_4/client_state-step4000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=6001 Epoch=57.1] | Loss=0.04817 | Reg=0.00163 | acc=0.9688 | L2-Norm=12.776 | L2-Norm(final)=8.373 | 3211.7 samples/s | 50.2 steps/s
[Step=6050 Epoch=57.6] | Loss=0.03060 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.772 | L2-Norm(final)=8.370 | 4425.3 samples/s | 69.1 steps/s
[Step=6100 Epoch=58.0] | Loss=0.02814 | Reg=0.00163 | acc=0.9688 | L2-Norm=12.771 | L2-Norm(final)=8.379 | 8240.4 samples/s | 128.8 steps/s
[Step=6150 Epoch=58.5] | Loss=0.02670 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=8.396 | 1416.0 samples/s | 22.1 steps/s
[Step=6200 Epoch=59.0] | Loss=0.02592 | Reg=0.00163 | acc=0.9688 | L2-Norm=12.771 | L2-Norm(final)=8.425 | 7211.2 samples/s | 112.7 steps/s
[Step=6250 Epoch=59.5] | Loss=0.02553 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.771 | L2-Norm(final)=8.460 | 1448.2 samples/s | 22.6 steps/s
[Step=6300 Epoch=59.9] | Loss=0.02473 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=8.498 | 6326.4 samples/s | 98.8 steps/s
[Step=6350 Epoch=60.4] | Loss=0.02416 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.771 | L2-Norm(final)=8.543 | 1502.5 samples/s | 23.5 steps/s
[Step=6400 Epoch=60.9] | Loss=0.02383 | Reg=0.00163 | acc=0.9688 | L2-Norm=12.771 | L2-Norm(final)=8.590 | 5865.0 samples/s | 91.6 steps/s
[Step=6450 Epoch=61.4] | Loss=0.02365 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.771 | L2-Norm(final)=8.637 | 1530.5 samples/s | 23.9 steps/s
[Step=6500 Epoch=61.8] | Loss=0.02326 | Reg=0.00163 | acc=0.9688 | L2-Norm=12.771 | L2-Norm(final)=8.682 | 5389.8 samples/s | 84.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=6501 Epoch=61.8] | Loss=0.00658 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=9.149 | 3267.0 samples/s | 51.0 steps/s
[Step=6550 Epoch=62.3] | Loss=0.00829 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.866 | L2-Norm(final)=9.183 | 3847.1 samples/s | 60.1 steps/s
[Step=6600 Epoch=62.8] | Loss=0.00564 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=9.193 | 6538.8 samples/s | 102.2 steps/s
[Step=6650 Epoch=63.3] | Loss=0.00406 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.942 | L2-Norm(final)=9.201 | 1406.1 samples/s | 22.0 steps/s
[Step=6700 Epoch=63.7] | Loss=0.00308 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=9.206 | 5860.6 samples/s | 91.6 steps/s
[Step=6750 Epoch=64.2] | Loss=0.00247 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.944 | L2-Norm(final)=9.210 | 1405.4 samples/s | 22.0 steps/s
[Step=6800 Epoch=64.7] | Loss=0.00206 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.933 | L2-Norm(final)=9.214 | 5414.2 samples/s | 84.6 steps/s
[Step=6850 Epoch=65.2] | Loss=0.00177 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=9.216 | 1467.0 samples/s | 22.9 steps/s
[Step=6900 Epoch=65.6] | Loss=0.00155 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.903 | L2-Norm(final)=9.218 | 4828.5 samples/s | 75.4 steps/s
[Step=6950 Epoch=66.1] | Loss=0.00138 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.885 | L2-Norm(final)=9.220 | 1489.5 samples/s | 23.3 steps/s
[Step=7000 Epoch=66.6] | Loss=0.00124 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.866 | L2-Norm(final)=9.221 | 4596.3 samples/s | 71.8 steps/s
[Step=7050 Epoch=67.1] | Loss=0.00113 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.847 | L2-Norm(final)=9.222 | 1510.7 samples/s | 23.6 steps/s
[Step=7100 Epoch=67.5] | Loss=0.00104 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.828 | L2-Norm(final)=9.223 | 4455.8 samples/s | 69.6 steps/s
[Step=7150 Epoch=68.0] | Loss=0.00096 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.808 | L2-Norm(final)=9.224 | 1544.1 samples/s | 24.1 steps/s
[Step=7200 Epoch=68.5] | Loss=0.00089 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=9.225 | 4494.1 samples/s | 70.2 steps/s
[Step=7250 Epoch=69.0] | Loss=0.00083 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.767 | L2-Norm(final)=9.226 | 1543.0 samples/s | 24.1 steps/s
[Step=7300 Epoch=69.4] | Loss=0.00078 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.747 | L2-Norm(final)=9.226 | 4505.5 samples/s | 70.4 steps/s
[Step=7350 Epoch=69.9] | Loss=0.00073 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.726 | L2-Norm(final)=9.227 | 1604.2 samples/s | 25.1 steps/s
[Step=7400 Epoch=70.4] | Loss=0.00069 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.706 | L2-Norm(final)=9.228 | 4088.0 samples/s | 63.9 steps/s
[Step=7450 Epoch=70.9] | Loss=0.00066 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.685 | L2-Norm(final)=9.228 | 6682.6 samples/s | 104.4 steps/s
[Step=7500 Epoch=71.3] | Loss=0.00062 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.664 | L2-Norm(final)=9.229 | 1361.8 samples/s | 21.3 steps/s
[Step=7550 Epoch=71.8] | Loss=0.00059 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.643 | L2-Norm(final)=9.229 | 6042.4 samples/s | 94.4 steps/s
[Step=7600 Epoch=72.3] | Loss=0.00057 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.623 | L2-Norm(final)=9.230 | 1384.8 samples/s | 21.6 steps/s
[Step=7650 Epoch=72.8] | Loss=0.00054 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=9.230 | 5562.9 samples/s | 86.9 steps/s
[Step=7700 Epoch=73.2] | Loss=0.00052 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.581 | L2-Norm(final)=9.231 | 1415.6 samples/s | 22.1 steps/s
[Step=7750 Epoch=73.7] | Loss=0.00050 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.560 | L2-Norm(final)=9.231 | 5102.8 samples/s | 79.7 steps/s
[Step=7800 Epoch=74.2] | Loss=0.00048 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.539 | L2-Norm(final)=9.232 | 1453.6 samples/s | 22.7 steps/s
[Step=7850 Epoch=74.7] | Loss=0.00046 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=9.232 | 4732.2 samples/s | 73.9 steps/s
[Step=7900 Epoch=75.1] | Loss=0.00045 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=9.233 | 1499.2 samples/s | 23.4 steps/s
[Step=7950 Epoch=75.6] | Loss=0.00043 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.477 | L2-Norm(final)=9.233 | 4402.8 samples/s | 68.8 steps/s
[Step=8000 Epoch=76.1] | Loss=0.00042 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=9.234 | 1516.8 samples/s | 23.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step8000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=114.6] | Loss=0.02778 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.776 | L2-Norm(final)=12.624 | 3217.0 samples/s | 50.3 steps/s
[Step=12050 Epoch=115.1] | Loss=0.04265 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.772 | L2-Norm(final)=12.589 | 4377.7 samples/s | 68.4 steps/s
[Step=12100 Epoch=115.5] | Loss=0.03572 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=12.574 | 8388.0 samples/s | 131.1 steps/s
[Step=12150 Epoch=116.0] | Loss=0.03241 | Reg=0.00163 | acc=0.9688 | L2-Norm=12.771 | L2-Norm(final)=12.576 | 1442.8 samples/s | 22.5 steps/s
[Step=12200 Epoch=116.5] | Loss=0.03063 | Reg=0.00163 | acc=0.9688 | L2-Norm=12.771 | L2-Norm(final)=12.586 | 7388.7 samples/s | 115.4 steps/s
[Step=12250 Epoch=117.0] | Loss=0.02810 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.771 | L2-Norm(final)=12.604 | 1507.8 samples/s | 23.6 steps/s
[Step=12300 Epoch=117.5] | Loss=0.02672 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=12.630 | 6648.5 samples/s | 103.9 steps/s
[Step=12350 Epoch=117.9] | Loss=0.02584 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.771 | L2-Norm(final)=12.660 | 1502.7 samples/s | 23.5 steps/s
[Step=12400 Epoch=118.4] | Loss=0.02487 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=12.695 | 6072.1 samples/s | 94.9 steps/s
[Step=12450 Epoch=118.9] | Loss=0.02415 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.770 | L2-Norm(final)=12.734 | 1526.3 samples/s | 23.8 steps/s
[Step=12500 Epoch=119.4] | Loss=0.02351 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.770 | L2-Norm(final)=12.776 | 5610.0 samples/s | 87.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=119.4] | Loss=0.01023 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.770 | L2-Norm(final)=13.216 | 3160.3 samples/s | 49.4 steps/s
[Step=12550 Epoch=119.8] | Loss=0.00859 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.863 | L2-Norm(final)=13.242 | 3970.3 samples/s | 62.0 steps/s
[Step=12600 Epoch=120.3] | Loss=0.00523 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=13.247 | 6625.6 samples/s | 103.5 steps/s
[Step=12650 Epoch=120.8] | Loss=0.00368 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.906 | L2-Norm(final)=13.250 | 1370.3 samples/s | 21.4 steps/s
[Step=12700 Epoch=121.3] | Loss=0.00282 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=13.254 | 5912.0 samples/s | 92.4 steps/s
[Step=12750 Epoch=121.8] | Loss=0.00226 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=13.256 | 1385.1 samples/s | 21.6 steps/s
[Step=12800 Epoch=122.2] | Loss=0.00188 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.868 | L2-Norm(final)=13.258 | 5654.0 samples/s | 88.3 steps/s
[Step=12850 Epoch=122.7] | Loss=0.00162 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.847 | L2-Norm(final)=13.260 | 1438.5 samples/s | 22.5 steps/s
[Step=12900 Epoch=123.2] | Loss=0.00141 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.825 | L2-Norm(final)=13.261 | 5243.4 samples/s | 81.9 steps/s
[Step=12950 Epoch=123.7] | Loss=0.00126 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.802 | L2-Norm(final)=13.262 | 1430.5 samples/s | 22.4 steps/s
[Step=13000 Epoch=124.1] | Loss=0.00113 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.779 | L2-Norm(final)=13.263 | 4874.8 samples/s | 76.2 steps/s
[Step=13050 Epoch=124.6] | Loss=0.00103 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.756 | L2-Norm(final)=13.264 | 1492.5 samples/s | 23.3 steps/s
[Step=13100 Epoch=125.1] | Loss=0.00095 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.733 | L2-Norm(final)=13.265 | 4570.2 samples/s | 71.4 steps/s
[Step=13150 Epoch=125.6] | Loss=0.00087 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.709 | L2-Norm(final)=13.265 | 1510.4 samples/s | 23.6 steps/s
[Step=13200 Epoch=126.1] | Loss=0.00081 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=13.266 | 4567.2 samples/s | 71.4 steps/s
[Step=13250 Epoch=126.5] | Loss=0.00076 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.664 | L2-Norm(final)=13.266 | 1509.9 samples/s | 23.6 steps/s
[Step=13300 Epoch=127.0] | Loss=0.00071 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.641 | L2-Norm(final)=13.267 | 4463.1 samples/s | 69.7 steps/s
[Step=13350 Epoch=127.5] | Loss=0.00067 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.618 | L2-Norm(final)=13.268 | 1541.7 samples/s | 24.1 steps/s
[Step=13400 Epoch=128.0] | Loss=0.00063 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.596 | L2-Norm(final)=13.268 | 4408.7 samples/s | 68.9 steps/s
[Step=13450 Epoch=128.4] | Loss=0.00060 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.574 | L2-Norm(final)=13.269 | 1517.5 samples/s | 23.7 steps/s
[Step=13500 Epoch=128.9] | Loss=0.00057 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.552 | L2-Norm(final)=13.269 | 4581.2 samples/s | 71.6 steps/s
[Step=13550 Epoch=129.4] | Loss=0.00054 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=13.269 | 7015.6 samples/s | 109.6 steps/s
[Step=13600 Epoch=129.9] | Loss=0.00052 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.508 | L2-Norm(final)=13.270 | 1355.6 samples/s | 21.2 steps/s
[Step=13650 Epoch=130.3] | Loss=0.00050 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.486 | L2-Norm(final)=13.270 | 6667.4 samples/s | 104.2 steps/s
[Step=13700 Epoch=130.8] | Loss=0.00047 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=13.271 | 1392.9 samples/s | 21.8 steps/s
[Step=13750 Epoch=131.3] | Loss=0.00046 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.443 | L2-Norm(final)=13.271 | 6105.3 samples/s | 95.4 steps/s
[Step=13800 Epoch=131.8] | Loss=0.00044 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=13.272 | 1418.5 samples/s | 22.2 steps/s
[Step=13850 Epoch=132.3] | Loss=0.00042 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.400 | L2-Norm(final)=13.272 | 5536.2 samples/s | 86.5 steps/s
[Step=13900 Epoch=132.7] | Loss=0.00041 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.379 | L2-Norm(final)=13.272 | 1427.4 samples/s | 22.3 steps/s
[Step=13950 Epoch=133.2] | Loss=0.00039 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.358 | L2-Norm(final)=13.273 | 5231.8 samples/s | 81.7 steps/s
[Step=14000 Epoch=133.7] | Loss=0.00038 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.337 | L2-Norm(final)=13.273 | 1478.8 samples/s | 23.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step14000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.13400 | acc=0.9428 | tpr=0.9628 | fpr=0.1006 | 4666.3 samples/s | 18.2 steps/s
Avg test loss: 0.14192, Avg test acc: 0.94022, Avg tpr: 0.96083, Avg fpr: 0.10511, total FA: 820

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.12567 | acc=0.9355 | tpr=0.9525 | fpr=0.1013 | 4669.0 samples/s | 18.2 steps/s
Avg test loss: 0.12758, Avg test acc: 0.93497, Avg tpr: 0.95215, Avg fpr: 0.10281, total FA: 802

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11812 | acc=0.9465 | tpr=0.9684 | fpr=0.1011 | 4624.9 samples/s | 18.1 steps/s
Avg test loss: 0.11926, Avg test acc: 0.94627, Avg tpr: 0.96818, Avg fpr: 0.10191, total FA: 795

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.12202 | acc=0.9505 | tpr=0.9637 | fpr=0.0783 | 4642.5 samples/s | 18.1 steps/s
Avg test loss: 0.12140, Avg test acc: 0.94915, Avg tpr: 0.96287, Avg fpr: 0.08102, total FA: 632

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11111 | acc=0.9511 | tpr=0.9671 | fpr=0.0837 | 4740.5 samples/s | 18.5 steps/s
Avg test loss: 0.11621, Avg test acc: 0.94899, Avg tpr: 0.96544, Avg fpr: 0.08717, total FA: 680

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.31758 | acc=0.3142 | tpr=0.0119 | fpr=0.0292 | 4774.9 samples/s | 18.7 steps/s
Avg test loss: 4.33461, Avg test acc: 0.31088, Avg tpr: 0.01078, Avg fpr: 0.02910, total FA: 227

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=3.83233 | acc=0.3043 | tpr=0.0179 | fpr=0.0738 | 4629.7 samples/s | 18.1 steps/s
Avg test loss: 3.85153, Avg test acc: 0.30151, Avg tpr: 0.01649, Avg fpr: 0.07166, total FA: 559

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.13936 | acc=0.3086 | tpr=0.0097 | fpr=0.0424 | 4829.3 samples/s | 18.9 steps/s
Avg test loss: 4.15877, Avg test acc: 0.30676, Avg tpr: 0.00909, Avg fpr: 0.03858, total FA: 301

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=3.89136 | acc=0.3230 | tpr=0.0221 | fpr=0.0235 | 4794.5 samples/s | 18.7 steps/s
Avg test loss: 3.91250, Avg test acc: 0.32142, Avg tpr: 0.02261, Avg fpr: 0.02141, total FA: 167

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.60683 | acc=0.3137 | tpr=0.0094 | fpr=0.0255 | 4579.0 samples/s | 17.9 steps/s
Avg test loss: 5.63480, Avg test acc: 0.31100, Avg tpr: 0.00868, Avg fpr: 0.02410, total FA: 188

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.76295 | acc=0.1222 | tpr=0.8274 | fpr=0.8905 | 4661.1 samples/s | 18.2 steps/s
[Step= 100] | Loss=6.73096 | acc=0.1220 | tpr=0.8209 | fpr=0.8910 | 7647.0 samples/s | 29.9 steps/s
[Step= 150] | Loss=6.74071 | acc=0.1219 | tpr=0.8228 | fpr=0.8910 | 8473.6 samples/s | 33.1 steps/s
[Step= 200] | Loss=6.72521 | acc=0.1217 | tpr=0.8208 | fpr=0.8910 | 8003.5 samples/s | 31.3 steps/s
[Step= 250] | Loss=6.72249 | acc=0.1216 | tpr=0.8175 | fpr=0.8910 | 7818.4 samples/s | 30.5 steps/s
[Step= 300] | Loss=6.71838 | acc=0.1219 | tpr=0.8131 | fpr=0.8907 | 7671.6 samples/s | 30.0 steps/s
[Step= 350] | Loss=6.72795 | acc=0.1212 | tpr=0.8140 | fpr=0.8914 | 7905.9 samples/s | 30.9 steps/s
[Step= 400] | Loss=6.72365 | acc=0.1212 | tpr=0.8140 | fpr=0.8914 | 8030.5 samples/s | 31.4 steps/s
[Step= 450] | Loss=6.72627 | acc=0.1215 | tpr=0.8101 | fpr=0.8910 | 8173.0 samples/s | 31.9 steps/s
[Step= 500] | Loss=6.72998 | acc=0.1214 | tpr=0.8101 | fpr=0.8910 | 8236.5 samples/s | 32.2 steps/s
[Step= 550] | Loss=6.72718 | acc=0.1213 | tpr=0.8126 | fpr=0.8912 | 10074.9 samples/s | 39.4 steps/s
Avg test loss: 6.72820, Avg test acc: 0.12121, Avg tpr: 0.81181, Avg fpr: 0.89134, total FA: 123761

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.83342 | acc=0.1494 | tpr=0.7920 | fpr=0.8622 | 4592.5 samples/s | 17.9 steps/s
[Step= 100] | Loss=5.79863 | acc=0.1514 | tpr=0.7761 | fpr=0.8602 | 7823.5 samples/s | 30.6 steps/s
[Step= 150] | Loss=5.78499 | acc=0.1522 | tpr=0.7853 | fpr=0.8594 | 8133.0 samples/s | 31.8 steps/s
[Step= 200] | Loss=5.78008 | acc=0.1523 | tpr=0.7803 | fpr=0.8592 | 8417.0 samples/s | 32.9 steps/s
[Step= 250] | Loss=5.77499 | acc=0.1527 | tpr=0.7852 | fpr=0.8588 | 8009.4 samples/s | 31.3 steps/s
[Step= 300] | Loss=5.77359 | acc=0.1538 | tpr=0.7891 | fpr=0.8578 | 7804.6 samples/s | 30.5 steps/s
[Step= 350] | Loss=5.78149 | acc=0.1531 | tpr=0.7896 | fpr=0.8584 | 7992.8 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.78330 | acc=0.1529 | tpr=0.7784 | fpr=0.8584 | 7962.8 samples/s | 31.1 steps/s
[Step= 450] | Loss=5.78605 | acc=0.1525 | tpr=0.7780 | fpr=0.8588 | 7805.3 samples/s | 30.5 steps/s
[Step= 500] | Loss=5.78887 | acc=0.1527 | tpr=0.7762 | fpr=0.8586 | 7395.3 samples/s | 28.9 steps/s
[Step= 550] | Loss=5.78719 | acc=0.1529 | tpr=0.7791 | fpr=0.8585 | 11246.3 samples/s | 43.9 steps/s
Avg test loss: 5.78796, Avg test acc: 0.15279, Avg tpr: 0.77892, Avg fpr: 0.85859, total FA: 119214

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.97436 | acc=0.1412 | tpr=0.8186 | fpr=0.8709 | 4822.6 samples/s | 18.8 steps/s
[Step= 100] | Loss=5.95727 | acc=0.1423 | tpr=0.7719 | fpr=0.8695 | 7847.2 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.96448 | acc=0.1430 | tpr=0.7839 | fpr=0.8688 | 7428.6 samples/s | 29.0 steps/s
[Step= 200] | Loss=5.94983 | acc=0.1435 | tpr=0.7825 | fpr=0.8681 | 8486.7 samples/s | 33.2 steps/s
[Step= 250] | Loss=5.94308 | acc=0.1442 | tpr=0.7782 | fpr=0.8674 | 7982.4 samples/s | 31.2 steps/s
[Step= 300] | Loss=5.93942 | acc=0.1440 | tpr=0.7782 | fpr=0.8675 | 7556.7 samples/s | 29.5 steps/s
[Step= 350] | Loss=5.94823 | acc=0.1432 | tpr=0.7771 | fpr=0.8683 | 8059.4 samples/s | 31.5 steps/s
[Step= 400] | Loss=5.95090 | acc=0.1430 | tpr=0.7790 | fpr=0.8685 | 8228.5 samples/s | 32.1 steps/s
[Step= 450] | Loss=5.95073 | acc=0.1429 | tpr=0.7804 | fpr=0.8687 | 8564.5 samples/s | 33.5 steps/s
[Step= 500] | Loss=5.95174 | acc=0.1430 | tpr=0.7793 | fpr=0.8685 | 7908.1 samples/s | 30.9 steps/s
[Step= 550] | Loss=5.95101 | acc=0.1431 | tpr=0.7803 | fpr=0.8685 | 9268.7 samples/s | 36.2 steps/s
Avg test loss: 5.95182, Avg test acc: 0.14293, Avg tpr: 0.78011, Avg fpr: 0.86865, total FA: 120610

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.95808 | acc=0.1422 | tpr=0.8274 | fpr=0.8701 | 4801.2 samples/s | 18.8 steps/s
[Step= 100] | Loss=6.93450 | acc=0.1445 | tpr=0.8166 | fpr=0.8680 | 7979.2 samples/s | 31.2 steps/s
[Step= 150] | Loss=6.93716 | acc=0.1459 | tpr=0.8069 | fpr=0.8663 | 7730.3 samples/s | 30.2 steps/s
[Step= 200] | Loss=6.92130 | acc=0.1466 | tpr=0.8164 | fpr=0.8656 | 7703.8 samples/s | 30.1 steps/s
[Step= 250] | Loss=6.91644 | acc=0.1472 | tpr=0.8157 | fpr=0.8650 | 7824.9 samples/s | 30.6 steps/s
[Step= 300] | Loss=6.90999 | acc=0.1479 | tpr=0.8196 | fpr=0.8643 | 8668.8 samples/s | 33.9 steps/s
[Step= 350] | Loss=6.92039 | acc=0.1476 | tpr=0.8253 | fpr=0.8647 | 8486.4 samples/s | 33.1 steps/s
[Step= 400] | Loss=6.92483 | acc=0.1473 | tpr=0.8239 | fpr=0.8650 | 7857.9 samples/s | 30.7 steps/s
[Step= 450] | Loss=6.92552 | acc=0.1469 | tpr=0.8218 | fpr=0.8654 | 8150.3 samples/s | 31.8 steps/s
[Step= 500] | Loss=6.92808 | acc=0.1470 | tpr=0.8203 | fpr=0.8651 | 7927.9 samples/s | 31.0 steps/s
[Step= 550] | Loss=6.92957 | acc=0.1471 | tpr=0.8201 | fpr=0.8651 | 9230.8 samples/s | 36.1 steps/s
Avg test loss: 6.93112, Avg test acc: 0.14697, Avg tpr: 0.82013, Avg fpr: 0.86526, total FA: 120140

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.31670 | acc=0.1378 | tpr=0.7522 | fpr=0.8732 | 4773.0 samples/s | 18.6 steps/s
[Step= 100] | Loss=6.29761 | acc=0.1387 | tpr=0.7143 | fpr=0.8721 | 7987.3 samples/s | 31.2 steps/s
[Step= 150] | Loss=6.30412 | acc=0.1401 | tpr=0.7147 | fpr=0.8705 | 7751.7 samples/s | 30.3 steps/s
[Step= 200] | Loss=6.29852 | acc=0.1396 | tpr=0.7060 | fpr=0.8707 | 7020.1 samples/s | 27.4 steps/s
[Step= 250] | Loss=6.29183 | acc=0.1407 | tpr=0.7074 | fpr=0.8696 | 8258.4 samples/s | 32.3 steps/s
[Step= 300] | Loss=6.29169 | acc=0.1405 | tpr=0.7156 | fpr=0.8700 | 8127.3 samples/s | 31.7 steps/s
[Step= 350] | Loss=6.29861 | acc=0.1403 | tpr=0.7201 | fpr=0.8702 | 8236.0 samples/s | 32.2 steps/s
[Step= 400] | Loss=6.29929 | acc=0.1401 | tpr=0.7144 | fpr=0.8704 | 8012.4 samples/s | 31.3 steps/s
[Step= 450] | Loss=6.29849 | acc=0.1399 | tpr=0.7142 | fpr=0.8705 | 8123.4 samples/s | 31.7 steps/s
[Step= 500] | Loss=6.30330 | acc=0.1398 | tpr=0.7110 | fpr=0.8705 | 8367.3 samples/s | 32.7 steps/s
[Step= 550] | Loss=6.30182 | acc=0.1400 | tpr=0.7115 | fpr=0.8704 | 10113.4 samples/s | 39.5 steps/s
Avg test loss: 6.30254, Avg test acc: 0.13988, Avg tpr: 0.71157, Avg fpr: 0.87051, total FA: 120869

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.16213 | acc=0.9622 | tpr=0.9027 | fpr=0.0367 | 4757.3 samples/s | 18.6 steps/s
[Step= 100] | Loss=0.16260 | acc=0.9600 | tpr=0.9147 | fpr=0.0391 | 7282.1 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.16700 | acc=0.9593 | tpr=0.9207 | fpr=0.0399 | 8407.4 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.16841 | acc=0.9597 | tpr=0.9257 | fpr=0.0397 | 8412.2 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.16981 | acc=0.9596 | tpr=0.9223 | fpr=0.0397 | 7903.6 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.17138 | acc=0.9592 | tpr=0.9200 | fpr=0.0401 | 7746.7 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.17060 | acc=0.9593 | tpr=0.9167 | fpr=0.0399 | 7434.5 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.17156 | acc=0.9590 | tpr=0.9130 | fpr=0.0402 | 8205.9 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.17285 | acc=0.9586 | tpr=0.9085 | fpr=0.0405 | 8153.9 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.17300 | acc=0.9586 | tpr=0.9106 | fpr=0.0405 | 7614.4 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.17255 | acc=0.9588 | tpr=0.9065 | fpr=0.0403 | 11163.2 samples/s | 43.6 steps/s
Avg test loss: 0.17227, Avg test acc: 0.95880, Avg tpr: 0.90689, Avg fpr: 0.04025, total FA: 5589

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11878 | acc=0.9676 | tpr=0.8982 | fpr=0.0312 | 4474.7 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.11930 | acc=0.9670 | tpr=0.9126 | fpr=0.0320 | 8235.6 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.12066 | acc=0.9667 | tpr=0.9135 | fpr=0.0323 | 8584.3 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.12037 | acc=0.9671 | tpr=0.9169 | fpr=0.0320 | 8145.9 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.12311 | acc=0.9667 | tpr=0.9162 | fpr=0.0324 | 8229.7 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.12388 | acc=0.9663 | tpr=0.9156 | fpr=0.0328 | 8025.6 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.12450 | acc=0.9665 | tpr=0.9167 | fpr=0.0326 | 7359.9 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.12538 | acc=0.9661 | tpr=0.9108 | fpr=0.0329 | 8450.0 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.12576 | acc=0.9659 | tpr=0.9085 | fpr=0.0331 | 7516.0 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.12517 | acc=0.9658 | tpr=0.9101 | fpr=0.0332 | 8490.8 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.12550 | acc=0.9656 | tpr=0.9065 | fpr=0.0333 | 9849.6 samples/s | 38.5 steps/s
Avg test loss: 0.12521, Avg test acc: 0.96564, Avg tpr: 0.90689, Avg fpr: 0.03329, total FA: 4622

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.20171 | acc=0.9550 | tpr=0.9336 | fpr=0.0446 | 4664.3 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.21181 | acc=0.9549 | tpr=0.9232 | fpr=0.0445 | 7975.5 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.21524 | acc=0.9539 | tpr=0.9251 | fpr=0.0456 | 8142.1 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.21641 | acc=0.9541 | tpr=0.9301 | fpr=0.0454 | 7248.2 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.21890 | acc=0.9536 | tpr=0.9293 | fpr=0.0459 | 8912.9 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.22155 | acc=0.9528 | tpr=0.9265 | fpr=0.0467 | 7319.6 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.22202 | acc=0.9529 | tpr=0.9274 | fpr=0.0467 | 8213.1 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.22296 | acc=0.9527 | tpr=0.9229 | fpr=0.0468 | 7819.0 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.22394 | acc=0.9523 | tpr=0.9197 | fpr=0.0471 | 8339.9 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.22367 | acc=0.9521 | tpr=0.9220 | fpr=0.0473 | 8171.7 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.22320 | acc=0.9522 | tpr=0.9208 | fpr=0.0473 | 10328.7 samples/s | 40.3 steps/s
Avg test loss: 0.22283, Avg test acc: 0.95218, Avg tpr: 0.92036, Avg fpr: 0.04724, total FA: 6559

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10109 | acc=0.9677 | tpr=0.8628 | fpr=0.0304 | 4705.5 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.10345 | acc=0.9681 | tpr=0.8742 | fpr=0.0301 | 7924.4 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.10545 | acc=0.9673 | tpr=0.8905 | fpr=0.0312 | 7979.1 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.10506 | acc=0.9678 | tpr=0.8973 | fpr=0.0309 | 8279.7 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.10693 | acc=0.9678 | tpr=0.8908 | fpr=0.0308 | 7642.4 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.10755 | acc=0.9677 | tpr=0.8909 | fpr=0.0309 | 8110.1 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.10807 | acc=0.9676 | tpr=0.8936 | fpr=0.0310 | 7618.2 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.10869 | acc=0.9675 | tpr=0.8917 | fpr=0.0312 | 8080.0 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.10985 | acc=0.9673 | tpr=0.8900 | fpr=0.0313 | 8773.9 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.10891 | acc=0.9674 | tpr=0.8912 | fpr=0.0312 | 8261.7 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.10837 | acc=0.9675 | tpr=0.8906 | fpr=0.0311 | 8998.7 samples/s | 35.2 steps/s
Avg test loss: 0.10826, Avg test acc: 0.96755, Avg tpr: 0.89105, Avg fpr: 0.03106, total FA: 4313

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.17299 | acc=0.9644 | tpr=0.9115 | fpr=0.0347 | 4744.9 samples/s | 18.5 steps/s
[Step= 100] | Loss=0.17871 | acc=0.9623 | tpr=0.9211 | fpr=0.0370 | 7254.3 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.17975 | acc=0.9620 | tpr=0.9280 | fpr=0.0374 | 8731.2 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.18024 | acc=0.9624 | tpr=0.9333 | fpr=0.0371 | 8056.2 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.18173 | acc=0.9622 | tpr=0.9293 | fpr=0.0372 | 7392.0 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.18334 | acc=0.9619 | tpr=0.9258 | fpr=0.0375 | 8342.1 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.18523 | acc=0.9618 | tpr=0.9224 | fpr=0.0375 | 8429.2 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.18582 | acc=0.9616 | tpr=0.9190 | fpr=0.0377 | 7855.2 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.18717 | acc=0.9611 | tpr=0.9172 | fpr=0.0382 | 7822.7 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.18765 | acc=0.9609 | tpr=0.9181 | fpr=0.0384 | 7708.9 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.18650 | acc=0.9611 | tpr=0.9160 | fpr=0.0381 | 10336.3 samples/s | 40.4 steps/s
Avg test loss: 0.18612, Avg test acc: 0.96114, Avg tpr: 0.91601, Avg fpr: 0.03804, total FA: 5282

server round 11/50

clients selected: [1 3 5 6 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=58.6] | Loss=0.10554 | Reg=0.00155 | acc=0.9219 | L2-Norm=12.430 | L2-Norm(final)=10.574 | 3301.5 samples/s | 51.6 steps/s
[Step=12050 Epoch=58.8] | Loss=0.09190 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.435 | L2-Norm(final)=10.558 | 4682.6 samples/s | 73.2 steps/s
[Step=12100 Epoch=59.0] | Loss=0.08475 | Reg=0.00155 | acc=0.9531 | L2-Norm=12.436 | L2-Norm(final)=10.558 | 5583.4 samples/s | 87.2 steps/s
[Step=12150 Epoch=59.3] | Loss=0.08239 | Reg=0.00155 | acc=0.9531 | L2-Norm=12.436 | L2-Norm(final)=10.569 | 5330.5 samples/s | 83.3 steps/s
[Step=12200 Epoch=59.5] | Loss=0.08075 | Reg=0.00155 | acc=0.8906 | L2-Norm=12.436 | L2-Norm(final)=10.587 | 8639.6 samples/s | 135.0 steps/s
[Step=12250 Epoch=59.8] | Loss=0.08015 | Reg=0.00155 | acc=0.9375 | L2-Norm=12.436 | L2-Norm(final)=10.608 | 1492.9 samples/s | 23.3 steps/s
[Step=12300 Epoch=60.0] | Loss=0.08007 | Reg=0.00155 | acc=0.9375 | L2-Norm=12.436 | L2-Norm(final)=10.629 | 5350.1 samples/s | 83.6 steps/s
[Step=12350 Epoch=60.3] | Loss=0.07889 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.436 | L2-Norm(final)=10.650 | 5483.4 samples/s | 85.7 steps/s
[Step=12400 Epoch=60.5] | Loss=0.07949 | Reg=0.00155 | acc=0.9219 | L2-Norm=12.436 | L2-Norm(final)=10.672 | 7714.2 samples/s | 120.5 steps/s
[Step=12450 Epoch=60.8] | Loss=0.07840 | Reg=0.00155 | acc=0.9219 | L2-Norm=12.436 | L2-Norm(final)=10.694 | 1496.2 samples/s | 23.4 steps/s
[Step=12500 Epoch=61.0] | Loss=0.07839 | Reg=0.00155 | acc=0.8906 | L2-Norm=12.436 | L2-Norm(final)=10.717 | 5478.1 samples/s | 85.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=61.0] | Loss=0.04354 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.436 | L2-Norm(final)=10.943 | 3117.1 samples/s | 48.7 steps/s
[Step=12550 Epoch=61.2] | Loss=0.06587 | Reg=0.00157 | acc=0.9219 | L2-Norm=12.528 | L2-Norm(final)=10.949 | 4349.1 samples/s | 68.0 steps/s
[Step=12600 Epoch=61.5] | Loss=0.05489 | Reg=0.00159 | acc=0.9375 | L2-Norm=12.611 | L2-Norm(final)=10.946 | 4726.2 samples/s | 73.8 steps/s
[Step=12650 Epoch=61.7] | Loss=0.05249 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.663 | L2-Norm(final)=10.943 | 4658.1 samples/s | 72.8 steps/s
[Step=12700 Epoch=62.0] | Loss=0.04888 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.704 | L2-Norm(final)=10.943 | 6837.9 samples/s | 106.8 steps/s
[Step=12750 Epoch=62.2] | Loss=0.04304 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.736 | L2-Norm(final)=10.944 | 1418.1 samples/s | 22.2 steps/s
[Step=12800 Epoch=62.5] | Loss=0.03896 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.764 | L2-Norm(final)=10.948 | 4667.0 samples/s | 72.9 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03637 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.790 | L2-Norm(final)=10.950 | 4697.1 samples/s | 73.4 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03390 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.813 | L2-Norm(final)=10.952 | 6226.5 samples/s | 97.3 steps/s
[Step=12950 Epoch=63.2] | Loss=0.03116 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.834 | L2-Norm(final)=10.956 | 1434.1 samples/s | 22.4 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02928 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.853 | L2-Norm(final)=10.959 | 4582.6 samples/s | 71.6 steps/s
[Step=13050 Epoch=63.7] | Loss=0.02797 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.871 | L2-Norm(final)=10.963 | 4686.1 samples/s | 73.2 steps/s
[Step=13100 Epoch=63.9] | Loss=0.02672 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.888 | L2-Norm(final)=10.966 | 5783.9 samples/s | 90.4 steps/s
[Step=13150 Epoch=64.2] | Loss=0.02521 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=10.970 | 1475.0 samples/s | 23.0 steps/s
[Step=13200 Epoch=64.4] | Loss=0.02394 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.920 | L2-Norm(final)=10.974 | 4648.1 samples/s | 72.6 steps/s
[Step=13250 Epoch=64.7] | Loss=0.02299 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.933 | L2-Norm(final)=10.978 | 4684.9 samples/s | 73.2 steps/s
[Step=13300 Epoch=64.9] | Loss=0.02228 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.946 | L2-Norm(final)=10.982 | 5435.8 samples/s | 84.9 steps/s
[Step=13350 Epoch=65.1] | Loss=0.02141 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.958 | L2-Norm(final)=10.985 | 1506.2 samples/s | 23.5 steps/s
[Step=13400 Epoch=65.4] | Loss=0.02060 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.969 | L2-Norm(final)=10.988 | 4682.7 samples/s | 73.2 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01993 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.980 | L2-Norm(final)=10.991 | 4705.6 samples/s | 73.5 steps/s
[Step=13500 Epoch=65.9] | Loss=0.01924 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.990 | L2-Norm(final)=10.995 | 5098.0 samples/s | 79.7 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01861 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=10.998 | 1514.9 samples/s | 23.7 steps/s
[Step=13600 Epoch=66.4] | Loss=0.01808 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.007 | L2-Norm(final)=11.001 | 4697.6 samples/s | 73.4 steps/s
[Step=13650 Epoch=66.6] | Loss=0.01753 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.015 | L2-Norm(final)=11.004 | 4753.5 samples/s | 74.3 steps/s
[Step=13700 Epoch=66.8] | Loss=0.01710 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.022 | L2-Norm(final)=11.007 | 4701.5 samples/s | 73.5 steps/s
[Step=13750 Epoch=67.1] | Loss=0.01675 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.029 | L2-Norm(final)=11.010 | 1512.8 samples/s | 23.6 steps/s
[Step=13800 Epoch=67.3] | Loss=0.01633 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.036 | L2-Norm(final)=11.013 | 4646.8 samples/s | 72.6 steps/s
[Step=13850 Epoch=67.6] | Loss=0.01585 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.043 | L2-Norm(final)=11.016 | 4639.3 samples/s | 72.5 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01553 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.049 | L2-Norm(final)=11.019 | 4651.4 samples/s | 72.7 steps/s
[Step=13950 Epoch=68.1] | Loss=0.01520 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.055 | L2-Norm(final)=11.022 | 1562.4 samples/s | 24.4 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01478 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=11.025 | 4654.3 samples/s | 72.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_1/client_state-step14000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=87.8] | Loss=0.05053 | Reg=0.00155 | acc=0.9531 | L2-Norm=12.430 | L2-Norm(final)=13.776 | 3208.3 samples/s | 50.1 steps/s
[Step=18050 Epoch=88.0] | Loss=0.07345 | Reg=0.00154 | acc=0.9219 | L2-Norm=12.430 | L2-Norm(final)=13.783 | 4748.3 samples/s | 74.2 steps/s
[Step=18100 Epoch=88.3] | Loss=0.07597 | Reg=0.00154 | acc=0.8750 | L2-Norm=12.430 | L2-Norm(final)=13.789 | 5452.6 samples/s | 85.2 steps/s
[Step=18150 Epoch=88.5] | Loss=0.07272 | Reg=0.00154 | acc=0.9219 | L2-Norm=12.430 | L2-Norm(final)=13.800 | 5498.8 samples/s | 85.9 steps/s
[Step=18200 Epoch=88.8] | Loss=0.07219 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.430 | L2-Norm(final)=13.811 | 8565.5 samples/s | 133.8 steps/s
[Step=18250 Epoch=89.0] | Loss=0.07198 | Reg=0.00154 | acc=0.9219 | L2-Norm=12.430 | L2-Norm(final)=13.825 | 1511.1 samples/s | 23.6 steps/s
[Step=18300 Epoch=89.2] | Loss=0.07200 | Reg=0.00154 | acc=0.9531 | L2-Norm=12.430 | L2-Norm(final)=13.841 | 5342.6 samples/s | 83.5 steps/s
[Step=18350 Epoch=89.5] | Loss=0.07160 | Reg=0.00154 | acc=0.9375 | L2-Norm=12.430 | L2-Norm(final)=13.855 | 5429.1 samples/s | 84.8 steps/s
[Step=18400 Epoch=89.7] | Loss=0.07173 | Reg=0.00154 | acc=0.9375 | L2-Norm=12.430 | L2-Norm(final)=13.869 | 7586.8 samples/s | 118.5 steps/s
[Step=18450 Epoch=90.0] | Loss=0.07074 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.430 | L2-Norm(final)=13.881 | 1515.6 samples/s | 23.7 steps/s
[Step=18500 Epoch=90.2] | Loss=0.07127 | Reg=0.00154 | acc=0.9062 | L2-Norm=12.430 | L2-Norm(final)=13.894 | 5484.5 samples/s | 85.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=90.2] | Loss=0.05420 | Reg=0.00154 | acc=0.9375 | L2-Norm=12.430 | L2-Norm(final)=14.027 | 3281.1 samples/s | 51.3 steps/s
[Step=18550 Epoch=90.5] | Loss=0.06480 | Reg=0.00157 | acc=0.9531 | L2-Norm=12.532 | L2-Norm(final)=14.025 | 4100.9 samples/s | 64.1 steps/s
[Step=18600 Epoch=90.7] | Loss=0.05860 | Reg=0.00159 | acc=0.9375 | L2-Norm=12.628 | L2-Norm(final)=14.015 | 4790.1 samples/s | 74.8 steps/s
[Step=18650 Epoch=90.9] | Loss=0.05383 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.695 | L2-Norm(final)=14.005 | 4585.6 samples/s | 71.6 steps/s
[Step=18700 Epoch=91.2] | Loss=0.04969 | Reg=0.00162 | acc=0.9688 | L2-Norm=12.746 | L2-Norm(final)=14.000 | 6778.5 samples/s | 105.9 steps/s
[Step=18750 Epoch=91.4] | Loss=0.04822 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.798 | L2-Norm(final)=13.997 | 1407.3 samples/s | 22.0 steps/s
[Step=18800 Epoch=91.7] | Loss=0.04504 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.846 | L2-Norm(final)=13.995 | 4699.3 samples/s | 73.4 steps/s
[Step=18850 Epoch=91.9] | Loss=0.04290 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.887 | L2-Norm(final)=13.992 | 4684.0 samples/s | 73.2 steps/s
[Step=18900 Epoch=92.2] | Loss=0.04088 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.923 | L2-Norm(final)=13.989 | 6176.6 samples/s | 96.5 steps/s
[Step=18950 Epoch=92.4] | Loss=0.03766 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.954 | L2-Norm(final)=13.988 | 1466.8 samples/s | 22.9 steps/s
[Step=19000 Epoch=92.7] | Loss=0.03513 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.982 | L2-Norm(final)=13.988 | 4737.4 samples/s | 74.0 steps/s
[Step=19050 Epoch=92.9] | Loss=0.03279 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.005 | L2-Norm(final)=13.990 | 4624.8 samples/s | 72.3 steps/s
[Step=19100 Epoch=93.1] | Loss=0.03083 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.025 | L2-Norm(final)=13.991 | 5662.0 samples/s | 88.5 steps/s
[Step=19150 Epoch=93.4] | Loss=0.02934 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.043 | L2-Norm(final)=13.993 | 1480.9 samples/s | 23.1 steps/s
[Step=19200 Epoch=93.6] | Loss=0.02778 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.058 | L2-Norm(final)=13.994 | 4576.6 samples/s | 71.5 steps/s
[Step=19250 Epoch=93.9] | Loss=0.02672 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.072 | L2-Norm(final)=13.996 | 4695.4 samples/s | 73.4 steps/s
[Step=19300 Epoch=94.1] | Loss=0.02555 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=13.998 | 5180.4 samples/s | 80.9 steps/s
[Step=19350 Epoch=94.4] | Loss=0.02448 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.096 | L2-Norm(final)=14.000 | 1536.1 samples/s | 24.0 steps/s
[Step=19400 Epoch=94.6] | Loss=0.02342 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.106 | L2-Norm(final)=14.002 | 4705.0 samples/s | 73.5 steps/s
[Step=19450 Epoch=94.8] | Loss=0.02273 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.116 | L2-Norm(final)=14.003 | 4672.1 samples/s | 73.0 steps/s
[Step=19500 Epoch=95.1] | Loss=0.02190 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.124 | L2-Norm(final)=14.005 | 4841.8 samples/s | 75.7 steps/s
[Step=19550 Epoch=95.3] | Loss=0.02116 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.132 | L2-Norm(final)=14.007 | 1586.6 samples/s | 24.8 steps/s
[Step=19600 Epoch=95.6] | Loss=0.02048 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.140 | L2-Norm(final)=14.009 | 4690.4 samples/s | 73.3 steps/s
[Step=19650 Epoch=95.8] | Loss=0.01989 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.147 | L2-Norm(final)=14.010 | 4775.4 samples/s | 74.6 steps/s
[Step=19700 Epoch=96.1] | Loss=0.01943 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.154 | L2-Norm(final)=14.012 | 4617.5 samples/s | 72.1 steps/s
[Step=19750 Epoch=96.3] | Loss=0.01882 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.161 | L2-Norm(final)=14.014 | 1538.6 samples/s | 24.0 steps/s
[Step=19800 Epoch=96.6] | Loss=0.01823 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.168 | L2-Norm(final)=14.015 | 4671.4 samples/s | 73.0 steps/s
[Step=19850 Epoch=96.8] | Loss=0.01776 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.174 | L2-Norm(final)=14.017 | 4714.0 samples/s | 73.7 steps/s
[Step=19900 Epoch=97.0] | Loss=0.01738 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.180 | L2-Norm(final)=14.019 | 4681.2 samples/s | 73.1 steps/s
[Step=19950 Epoch=97.3] | Loss=0.01710 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.185 | L2-Norm(final)=14.021 | 1547.0 samples/s | 24.2 steps/s
[Step=20000 Epoch=97.5] | Loss=0.01672 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.191 | L2-Norm(final)=14.023 | 4838.2 samples/s | 75.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step20000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=132.7] | Loss=0.01258 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=14.293 | 3141.4 samples/s | 49.1 steps/s
[Step=14050 Epoch=133.1] | Loss=0.00956 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.426 | L2-Norm(final)=14.293 | 4618.1 samples/s | 72.2 steps/s
[Step=14100 Epoch=133.6] | Loss=0.00888 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=14.300 | 8200.3 samples/s | 128.1 steps/s
[Step=14150 Epoch=134.1] | Loss=0.00923 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=14.315 | 1452.0 samples/s | 22.7 steps/s
[Step=14200 Epoch=134.6] | Loss=0.00935 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.425 | L2-Norm(final)=14.332 | 7191.7 samples/s | 112.4 steps/s
[Step=14250 Epoch=135.0] | Loss=0.00938 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=14.350 | 1479.8 samples/s | 23.1 steps/s
[Step=14300 Epoch=135.5] | Loss=0.00920 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=14.368 | 6295.8 samples/s | 98.4 steps/s
[Step=14350 Epoch=136.0] | Loss=0.00905 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.425 | L2-Norm(final)=14.389 | 1551.5 samples/s | 24.2 steps/s
[Step=14400 Epoch=136.5] | Loss=0.00893 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.425 | L2-Norm(final)=14.410 | 5784.0 samples/s | 90.4 steps/s
[Step=14450 Epoch=136.9] | Loss=0.00883 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.425 | L2-Norm(final)=14.432 | 1536.2 samples/s | 24.0 steps/s
[Step=14500 Epoch=137.4] | Loss=0.00865 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=14.456 | 5371.3 samples/s | 83.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=137.4] | Loss=0.01040 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=14.694 | 3150.3 samples/s | 49.2 steps/s
[Step=14550 Epoch=137.9] | Loss=0.01017 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=14.707 | 4006.4 samples/s | 62.6 steps/s
[Step=14600 Epoch=138.3] | Loss=0.00749 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=14.699 | 6487.2 samples/s | 101.4 steps/s
[Step=14650 Epoch=138.8] | Loss=0.00528 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.657 | L2-Norm(final)=14.696 | 1378.9 samples/s | 21.5 steps/s
[Step=14700 Epoch=139.3] | Loss=0.00406 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.680 | L2-Norm(final)=14.696 | 5828.9 samples/s | 91.1 steps/s
[Step=14750 Epoch=139.8] | Loss=0.00326 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=14.697 | 1414.9 samples/s | 22.1 steps/s
[Step=14800 Epoch=140.2] | Loss=0.00272 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.684 | L2-Norm(final)=14.697 | 5384.8 samples/s | 84.1 steps/s
[Step=14850 Epoch=140.7] | Loss=0.00233 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.676 | L2-Norm(final)=14.698 | 1428.6 samples/s | 22.3 steps/s
[Step=14900 Epoch=141.2] | Loss=0.00204 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.664 | L2-Norm(final)=14.699 | 4973.3 samples/s | 77.7 steps/s
[Step=14950 Epoch=141.7] | Loss=0.00181 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=14.700 | 1455.6 samples/s | 22.7 steps/s
[Step=15000 Epoch=142.1] | Loss=0.00163 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.637 | L2-Norm(final)=14.700 | 4612.4 samples/s | 72.1 steps/s
[Step=15050 Epoch=142.6] | Loss=0.00149 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.622 | L2-Norm(final)=14.701 | 1513.1 samples/s | 23.6 steps/s
[Step=15100 Epoch=143.1] | Loss=0.00136 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.606 | L2-Norm(final)=14.701 | 4489.7 samples/s | 70.2 steps/s
[Step=15150 Epoch=143.6] | Loss=0.00126 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.590 | L2-Norm(final)=14.702 | 1507.9 samples/s | 23.6 steps/s
[Step=15200 Epoch=144.0] | Loss=0.00117 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.573 | L2-Norm(final)=14.702 | 4442.6 samples/s | 69.4 steps/s
[Step=15250 Epoch=144.5] | Loss=0.00109 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.557 | L2-Norm(final)=14.703 | 1530.8 samples/s | 23.9 steps/s
[Step=15300 Epoch=145.0] | Loss=0.00102 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.540 | L2-Norm(final)=14.703 | 4640.2 samples/s | 72.5 steps/s
[Step=15350 Epoch=145.5] | Loss=0.00096 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=14.704 | 1583.5 samples/s | 24.7 steps/s
[Step=15400 Epoch=145.9] | Loss=0.00091 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.507 | L2-Norm(final)=14.704 | 3829.0 samples/s | 59.8 steps/s
[Step=15450 Epoch=146.4] | Loss=0.00086 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.490 | L2-Norm(final)=14.705 | 6730.0 samples/s | 105.2 steps/s
[Step=15500 Epoch=146.9] | Loss=0.00082 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.473 | L2-Norm(final)=14.705 | 1379.5 samples/s | 21.6 steps/s
[Step=15550 Epoch=147.3] | Loss=0.00078 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=14.705 | 6072.1 samples/s | 94.9 steps/s
[Step=15600 Epoch=147.8] | Loss=0.00075 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=14.706 | 1395.4 samples/s | 21.8 steps/s
[Step=15650 Epoch=148.3] | Loss=0.00071 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=14.706 | 5497.0 samples/s | 85.9 steps/s
[Step=15700 Epoch=148.8] | Loss=0.00068 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.406 | L2-Norm(final)=14.706 | 1460.4 samples/s | 22.8 steps/s
[Step=15750 Epoch=149.2] | Loss=0.00066 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.390 | L2-Norm(final)=14.707 | 5041.2 samples/s | 78.8 steps/s
[Step=15800 Epoch=149.7] | Loss=0.00063 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=14.707 | 1464.8 samples/s | 22.9 steps/s
[Step=15850 Epoch=150.2] | Loss=0.00061 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.356 | L2-Norm(final)=14.707 | 4634.7 samples/s | 72.4 steps/s
[Step=15900 Epoch=150.7] | Loss=0.00059 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.339 | L2-Norm(final)=14.708 | 1501.4 samples/s | 23.5 steps/s
[Step=15950 Epoch=151.1] | Loss=0.00057 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=14.708 | 4481.9 samples/s | 70.0 steps/s
[Step=16000 Epoch=151.6] | Loss=0.00055 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=14.708 | 1513.5 samples/s | 23.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step16000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=8001 Epoch=76.1] | Loss=0.00201 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=9.247 | 3100.3 samples/s | 48.4 steps/s
[Step=8050 Epoch=76.6] | Loss=0.01657 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.423 | L2-Norm(final)=9.218 | 4628.9 samples/s | 72.3 steps/s
[Step=8100 Epoch=77.1] | Loss=0.01373 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.422 | L2-Norm(final)=9.218 | 8165.4 samples/s | 127.6 steps/s
[Step=8150 Epoch=77.5] | Loss=0.01470 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.422 | L2-Norm(final)=9.227 | 1443.9 samples/s | 22.6 steps/s
[Step=8200 Epoch=78.0] | Loss=0.01348 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.422 | L2-Norm(final)=9.241 | 6923.0 samples/s | 108.2 steps/s
[Step=8250 Epoch=78.5] | Loss=0.01369 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.422 | L2-Norm(final)=9.262 | 1511.3 samples/s | 23.6 steps/s
[Step=8300 Epoch=79.0] | Loss=0.01326 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.422 | L2-Norm(final)=9.285 | 6484.0 samples/s | 101.3 steps/s
[Step=8350 Epoch=79.4] | Loss=0.01342 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.422 | L2-Norm(final)=9.311 | 1511.0 samples/s | 23.6 steps/s
[Step=8400 Epoch=79.9] | Loss=0.01318 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.422 | L2-Norm(final)=9.337 | 5859.3 samples/s | 91.6 steps/s
[Step=8450 Epoch=80.4] | Loss=0.01289 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.422 | L2-Norm(final)=9.365 | 1558.2 samples/s | 24.3 steps/s
[Step=8500 Epoch=80.9] | Loss=0.01295 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.422 | L2-Norm(final)=9.394 | 5401.5 samples/s | 84.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=80.9] | Loss=0.02051 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.421 | L2-Norm(final)=9.681 | 3222.5 samples/s | 50.4 steps/s
[Step=8550 Epoch=81.3] | Loss=0.01107 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.615 | L2-Norm(final)=9.688 | 3912.9 samples/s | 61.1 steps/s
[Step=8600 Epoch=81.8] | Loss=0.00725 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=9.684 | 6514.6 samples/s | 101.8 steps/s
[Step=8650 Epoch=82.3] | Loss=0.00492 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.818 | L2-Norm(final)=9.679 | 1377.8 samples/s | 21.5 steps/s
[Step=8700 Epoch=82.8] | Loss=0.00372 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.840 | L2-Norm(final)=9.678 | 5905.5 samples/s | 92.3 steps/s
[Step=8750 Epoch=83.2] | Loss=0.00298 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.844 | L2-Norm(final)=9.678 | 1397.4 samples/s | 21.8 steps/s
[Step=8800 Epoch=83.7] | Loss=0.00249 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.837 | L2-Norm(final)=9.678 | 5414.2 samples/s | 84.6 steps/s
[Step=8850 Epoch=84.2] | Loss=0.00213 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.825 | L2-Norm(final)=9.679 | 1444.0 samples/s | 22.6 steps/s
[Step=8900 Epoch=84.7] | Loss=0.00187 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.810 | L2-Norm(final)=9.679 | 4992.6 samples/s | 78.0 steps/s
[Step=8950 Epoch=85.1] | Loss=0.00166 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.792 | L2-Norm(final)=9.680 | 1465.7 samples/s | 22.9 steps/s
[Step=9000 Epoch=85.6] | Loss=0.00150 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=9.680 | 4574.5 samples/s | 71.5 steps/s
[Step=9050 Epoch=86.1] | Loss=0.00136 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.754 | L2-Norm(final)=9.680 | 1516.6 samples/s | 23.7 steps/s
[Step=9100 Epoch=86.6] | Loss=0.00125 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.734 | L2-Norm(final)=9.681 | 4520.9 samples/s | 70.6 steps/s
[Step=9150 Epoch=87.0] | Loss=0.00115 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.713 | L2-Norm(final)=9.681 | 1514.5 samples/s | 23.7 steps/s
[Step=9200 Epoch=87.5] | Loss=0.00107 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=9.681 | 4460.0 samples/s | 69.7 steps/s
[Step=9250 Epoch=88.0] | Loss=0.00100 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.671 | L2-Norm(final)=9.682 | 1512.9 samples/s | 23.6 steps/s
[Step=9300 Epoch=88.5] | Loss=0.00094 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.650 | L2-Norm(final)=9.682 | 4510.5 samples/s | 70.5 steps/s
[Step=9350 Epoch=88.9] | Loss=0.00088 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.629 | L2-Norm(final)=9.682 | 1599.4 samples/s | 25.0 steps/s
[Step=9400 Epoch=89.4] | Loss=0.00083 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.607 | L2-Norm(final)=9.683 | 3891.6 samples/s | 60.8 steps/s
[Step=9450 Epoch=89.9] | Loss=0.00079 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.586 | L2-Norm(final)=9.683 | 6642.1 samples/s | 103.8 steps/s
[Step=9500 Epoch=90.4] | Loss=0.00075 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.565 | L2-Norm(final)=9.684 | 1361.4 samples/s | 21.3 steps/s
[Step=9550 Epoch=90.8] | Loss=0.00071 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.544 | L2-Norm(final)=9.684 | 6088.4 samples/s | 95.1 steps/s
[Step=9600 Epoch=91.3] | Loss=0.00068 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=9.684 | 1434.7 samples/s | 22.4 steps/s
[Step=9650 Epoch=91.8] | Loss=0.00065 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=9.685 | 5489.2 samples/s | 85.8 steps/s
[Step=9700 Epoch=92.3] | Loss=0.00063 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.480 | L2-Norm(final)=9.685 | 1420.9 samples/s | 22.2 steps/s
[Step=9750 Epoch=92.7] | Loss=0.00060 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.459 | L2-Norm(final)=9.685 | 5038.7 samples/s | 78.7 steps/s
[Step=9800 Epoch=93.2] | Loss=0.00058 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=9.686 | 1482.0 samples/s | 23.2 steps/s
[Step=9850 Epoch=93.7] | Loss=0.00056 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.417 | L2-Norm(final)=9.686 | 4732.9 samples/s | 74.0 steps/s
[Step=9900 Epoch=94.2] | Loss=0.00054 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.396 | L2-Norm(final)=9.686 | 1517.1 samples/s | 23.7 steps/s
[Step=9950 Epoch=94.6] | Loss=0.00052 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.375 | L2-Norm(final)=9.687 | 4482.3 samples/s | 70.0 steps/s
[Step=10000 Epoch=95.1] | Loss=0.00050 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.354 | L2-Norm(final)=9.687 | 1528.2 samples/s | 23.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step10000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=8001 Epoch=75.4] | Loss=0.00844 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=10.459 | 3177.9 samples/s | 49.7 steps/s
[Step=8050 Epoch=75.9] | Loss=0.01835 | Reg=0.00154 | acc=0.9375 | L2-Norm=12.426 | L2-Norm(final)=10.431 | 4667.5 samples/s | 72.9 steps/s
[Step=8100 Epoch=76.3] | Loss=0.01664 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.425 | L2-Norm(final)=10.408 | 7474.1 samples/s | 116.8 steps/s
[Step=8150 Epoch=76.8] | Loss=0.01553 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.425 | L2-Norm(final)=10.407 | 1446.8 samples/s | 22.6 steps/s
[Step=8200 Epoch=77.3] | Loss=0.01504 | Reg=0.00154 | acc=0.9531 | L2-Norm=12.425 | L2-Norm(final)=10.416 | 6734.3 samples/s | 105.2 steps/s
[Step=8250 Epoch=77.7] | Loss=0.01432 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.425 | L2-Norm(final)=10.434 | 1479.1 samples/s | 23.1 steps/s
[Step=8300 Epoch=78.2] | Loss=0.01415 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.425 | L2-Norm(final)=10.460 | 6096.3 samples/s | 95.3 steps/s
[Step=8350 Epoch=78.7] | Loss=0.01378 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.425 | L2-Norm(final)=10.488 | 1603.9 samples/s | 25.1 steps/s
[Step=8400 Epoch=79.2] | Loss=0.01346 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.425 | L2-Norm(final)=10.519 | 5176.6 samples/s | 80.9 steps/s
[Step=8450 Epoch=79.6] | Loss=0.01318 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=10.554 | 1605.4 samples/s | 25.1 steps/s
[Step=8500 Epoch=80.1] | Loss=0.01298 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=10.591 | 5100.3 samples/s | 79.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=80.1] | Loss=0.00576 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=10.969 | 3241.7 samples/s | 50.7 steps/s
[Step=8550 Epoch=80.6] | Loss=0.00920 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.511 | L2-Norm(final)=10.993 | 3894.7 samples/s | 60.9 steps/s
[Step=8600 Epoch=81.0] | Loss=0.00601 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.588 | L2-Norm(final)=11.003 | 6395.4 samples/s | 99.9 steps/s
[Step=8650 Epoch=81.5] | Loss=0.00535 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.637 | L2-Norm(final)=11.005 | 1414.0 samples/s | 22.1 steps/s
[Step=8700 Epoch=82.0] | Loss=0.00406 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.667 | L2-Norm(final)=11.006 | 5609.5 samples/s | 87.6 steps/s
[Step=8750 Epoch=82.4] | Loss=0.00326 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.679 | L2-Norm(final)=11.008 | 1411.3 samples/s | 22.1 steps/s
[Step=8800 Epoch=82.9] | Loss=0.00272 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.680 | L2-Norm(final)=11.009 | 5213.8 samples/s | 81.5 steps/s
[Step=8850 Epoch=83.4] | Loss=0.00234 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.674 | L2-Norm(final)=11.011 | 1472.5 samples/s | 23.0 steps/s
[Step=8900 Epoch=83.9] | Loss=0.00205 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.666 | L2-Norm(final)=11.012 | 4691.3 samples/s | 73.3 steps/s
[Step=8950 Epoch=84.3] | Loss=0.00182 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.654 | L2-Norm(final)=11.013 | 1501.4 samples/s | 23.5 steps/s
[Step=9000 Epoch=84.8] | Loss=0.00164 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.642 | L2-Norm(final)=11.014 | 4459.0 samples/s | 69.7 steps/s
[Step=9050 Epoch=85.3] | Loss=0.00149 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=11.015 | 1558.8 samples/s | 24.4 steps/s
[Step=9100 Epoch=85.7] | Loss=0.00137 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.613 | L2-Norm(final)=11.016 | 4381.5 samples/s | 68.5 steps/s
[Step=9150 Epoch=86.2] | Loss=0.00126 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.597 | L2-Norm(final)=11.016 | 1505.4 samples/s | 23.5 steps/s
[Step=9200 Epoch=86.7] | Loss=0.00117 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.582 | L2-Norm(final)=11.017 | 4504.3 samples/s | 70.4 steps/s
[Step=9250 Epoch=87.2] | Loss=0.00109 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.565 | L2-Norm(final)=11.018 | 1648.8 samples/s | 25.8 steps/s
[Step=9300 Epoch=87.6] | Loss=0.00103 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=11.018 | 3758.5 samples/s | 58.7 steps/s
[Step=9350 Epoch=88.1] | Loss=0.00097 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.532 | L2-Norm(final)=11.019 | 6545.4 samples/s | 102.3 steps/s
[Step=9400 Epoch=88.6] | Loss=0.00091 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=11.020 | 1391.2 samples/s | 21.7 steps/s
[Step=9450 Epoch=89.0] | Loss=0.00087 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=11.020 | 5877.2 samples/s | 91.8 steps/s
[Step=9500 Epoch=89.5] | Loss=0.00082 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=11.021 | 1415.3 samples/s | 22.1 steps/s
[Step=9550 Epoch=90.0] | Loss=0.00078 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.463 | L2-Norm(final)=11.021 | 5267.3 samples/s | 82.3 steps/s
[Step=9600 Epoch=90.5] | Loss=0.00075 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.446 | L2-Norm(final)=11.022 | 1476.8 samples/s | 23.1 steps/s
[Step=9650 Epoch=90.9] | Loss=0.00072 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.428 | L2-Norm(final)=11.022 | 4717.5 samples/s | 73.7 steps/s
[Step=9700 Epoch=91.4] | Loss=0.00069 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.411 | L2-Norm(final)=11.023 | 1502.3 samples/s | 23.5 steps/s
[Step=9750 Epoch=91.9] | Loss=0.00066 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.393 | L2-Norm(final)=11.023 | 4487.8 samples/s | 70.1 steps/s
[Step=9800 Epoch=92.3] | Loss=0.00063 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.376 | L2-Norm(final)=11.024 | 1549.8 samples/s | 24.2 steps/s
[Step=9850 Epoch=92.8] | Loss=0.00061 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.358 | L2-Norm(final)=11.024 | 4430.3 samples/s | 69.2 steps/s
[Step=9900 Epoch=93.3] | Loss=0.00059 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.340 | L2-Norm(final)=11.025 | 1521.8 samples/s | 23.8 steps/s
[Step=9950 Epoch=93.8] | Loss=0.00057 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=11.025 | 4537.7 samples/s | 70.9 steps/s
[Step=10000 Epoch=94.2] | Loss=0.00055 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=11.025 | 1523.6 samples/s | 23.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_3/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.13400 | acc=0.9428 | tpr=0.9628 | fpr=0.1006 | 4599.0 samples/s | 18.0 steps/s
Avg test loss: 0.14192, Avg test acc: 0.94022, Avg tpr: 0.96083, Avg fpr: 0.10511, total FA: 820

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.13479 | acc=0.9495 | tpr=0.9735 | fpr=0.1028 | 4506.3 samples/s | 17.6 steps/s
Avg test loss: 0.13693, Avg test acc: 0.94799, Avg tpr: 0.97371, Avg fpr: 0.10858, total FA: 847

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11812 | acc=0.9465 | tpr=0.9684 | fpr=0.1011 | 4793.5 samples/s | 18.7 steps/s
Avg test loss: 0.11926, Avg test acc: 0.94627, Avg tpr: 0.96818, Avg fpr: 0.10191, total FA: 795

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.12913 | acc=0.9492 | tpr=0.9676 | fpr=0.0907 | 4795.2 samples/s | 18.7 steps/s
Avg test loss: 0.13557, Avg test acc: 0.94671, Avg tpr: 0.96678, Avg fpr: 0.09742, total FA: 760

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11111 | acc=0.9511 | tpr=0.9671 | fpr=0.0837 | 4646.1 samples/s | 18.1 steps/s
Avg test loss: 0.11621, Avg test acc: 0.94899, Avg tpr: 0.96544, Avg fpr: 0.08717, total FA: 680

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.81051 | acc=0.3040 | tpr=0.0082 | fpr=0.0538 | 4705.0 samples/s | 18.4 steps/s
Avg test loss: 4.82461, Avg test acc: 0.30203, Avg tpr: 0.00915, Avg fpr: 0.05384, total FA: 420

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.17873 | acc=0.3143 | tpr=0.0251 | fpr=0.0577 | 4726.4 samples/s | 18.5 steps/s
Avg test loss: 4.20685, Avg test acc: 0.31112, Avg tpr: 0.02500, Avg fpr: 0.05961, total FA: 465

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.13936 | acc=0.3086 | tpr=0.0097 | fpr=0.0424 | 4643.9 samples/s | 18.1 steps/s
Avg test loss: 4.15877, Avg test acc: 0.30676, Avg tpr: 0.00909, Avg fpr: 0.03858, total FA: 301

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.46640 | acc=0.3191 | tpr=0.0192 | fpr=0.0295 | 4511.2 samples/s | 17.6 steps/s
Avg test loss: 4.47871, Avg test acc: 0.31637, Avg tpr: 0.01877, Avg fpr: 0.02910, total FA: 227

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.60683 | acc=0.3137 | tpr=0.0094 | fpr=0.0255 | 4727.8 samples/s | 18.5 steps/s
Avg test loss: 5.63480, Avg test acc: 0.31100, Avg tpr: 0.00868, Avg fpr: 0.02410, total FA: 188

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.76295 | acc=0.1222 | tpr=0.8274 | fpr=0.8905 | 4693.2 samples/s | 18.3 steps/s
[Step= 100] | Loss=6.73096 | acc=0.1220 | tpr=0.8209 | fpr=0.8910 | 7824.3 samples/s | 30.6 steps/s
[Step= 150] | Loss=6.74071 | acc=0.1219 | tpr=0.8228 | fpr=0.8910 | 7302.7 samples/s | 28.5 steps/s
[Step= 200] | Loss=6.72521 | acc=0.1217 | tpr=0.8208 | fpr=0.8910 | 8357.3 samples/s | 32.6 steps/s
[Step= 250] | Loss=6.72249 | acc=0.1216 | tpr=0.8175 | fpr=0.8910 | 8136.3 samples/s | 31.8 steps/s
[Step= 300] | Loss=6.71838 | acc=0.1219 | tpr=0.8131 | fpr=0.8907 | 7887.3 samples/s | 30.8 steps/s
[Step= 350] | Loss=6.72795 | acc=0.1212 | tpr=0.8140 | fpr=0.8914 | 7922.3 samples/s | 30.9 steps/s
[Step= 400] | Loss=6.72365 | acc=0.1212 | tpr=0.8140 | fpr=0.8914 | 7675.7 samples/s | 30.0 steps/s
[Step= 450] | Loss=6.72627 | acc=0.1215 | tpr=0.8101 | fpr=0.8910 | 7829.4 samples/s | 30.6 steps/s
[Step= 500] | Loss=6.72998 | acc=0.1214 | tpr=0.8101 | fpr=0.8910 | 7966.1 samples/s | 31.1 steps/s
[Step= 550] | Loss=6.72718 | acc=0.1213 | tpr=0.8126 | fpr=0.8912 | 8451.2 samples/s | 33.0 steps/s
Avg test loss: 6.72820, Avg test acc: 0.12121, Avg tpr: 0.81181, Avg fpr: 0.89134, total FA: 123761

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.83656 | acc=0.1270 | tpr=0.8142 | fpr=0.8854 | 4544.6 samples/s | 17.8 steps/s
[Step= 100] | Loss=6.82038 | acc=0.1271 | tpr=0.7804 | fpr=0.8851 | 7880.0 samples/s | 30.8 steps/s
[Step= 150] | Loss=6.82313 | acc=0.1279 | tpr=0.7896 | fpr=0.8843 | 7723.6 samples/s | 30.2 steps/s
[Step= 200] | Loss=6.81719 | acc=0.1279 | tpr=0.7880 | fpr=0.8841 | 8657.2 samples/s | 33.8 steps/s
[Step= 250] | Loss=6.81465 | acc=0.1289 | tpr=0.7904 | fpr=0.8831 | 8450.4 samples/s | 33.0 steps/s
[Step= 300] | Loss=6.81338 | acc=0.1293 | tpr=0.7956 | fpr=0.8828 | 7779.3 samples/s | 30.4 steps/s
[Step= 350] | Loss=6.82042 | acc=0.1288 | tpr=0.7927 | fpr=0.8832 | 7567.4 samples/s | 29.6 steps/s
[Step= 400] | Loss=6.82414 | acc=0.1289 | tpr=0.7899 | fpr=0.8831 | 8340.3 samples/s | 32.6 steps/s
[Step= 450] | Loss=6.82502 | acc=0.1289 | tpr=0.7877 | fpr=0.8831 | 7306.8 samples/s | 28.5 steps/s
[Step= 500] | Loss=6.82580 | acc=0.1289 | tpr=0.7828 | fpr=0.8829 | 8719.4 samples/s | 34.1 steps/s
[Step= 550] | Loss=6.82478 | acc=0.1292 | tpr=0.7875 | fpr=0.8828 | 6379.5 samples/s | 24.9 steps/s
Avg test loss: 6.82722, Avg test acc: 0.12906, Avg tpr: 0.78764, Avg fpr: 0.88292, total FA: 122591

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.97436 | acc=0.1412 | tpr=0.8186 | fpr=0.8709 | 4576.4 samples/s | 17.9 steps/s
[Step= 100] | Loss=5.95727 | acc=0.1423 | tpr=0.7719 | fpr=0.8695 | 8324.4 samples/s | 32.5 steps/s
[Step= 150] | Loss=5.96448 | acc=0.1430 | tpr=0.7839 | fpr=0.8688 | 6979.4 samples/s | 27.3 steps/s
[Step= 200] | Loss=5.94983 | acc=0.1435 | tpr=0.7825 | fpr=0.8681 | 7794.4 samples/s | 30.4 steps/s
[Step= 250] | Loss=5.94308 | acc=0.1442 | tpr=0.7782 | fpr=0.8674 | 8336.7 samples/s | 32.6 steps/s
[Step= 300] | Loss=5.93942 | acc=0.1440 | tpr=0.7782 | fpr=0.8675 | 7975.7 samples/s | 31.2 steps/s
[Step= 350] | Loss=5.94823 | acc=0.1432 | tpr=0.7771 | fpr=0.8683 | 7880.9 samples/s | 30.8 steps/s
[Step= 400] | Loss=5.95090 | acc=0.1430 | tpr=0.7790 | fpr=0.8685 | 7783.5 samples/s | 30.4 steps/s
[Step= 450] | Loss=5.95073 | acc=0.1429 | tpr=0.7804 | fpr=0.8687 | 8392.2 samples/s | 32.8 steps/s
[Step= 500] | Loss=5.95174 | acc=0.1430 | tpr=0.7793 | fpr=0.8685 | 8091.3 samples/s | 31.6 steps/s
[Step= 550] | Loss=5.95101 | acc=0.1431 | tpr=0.7803 | fpr=0.8685 | 6984.2 samples/s | 27.3 steps/s
Avg test loss: 5.95182, Avg test acc: 0.14293, Avg tpr: 0.78011, Avg fpr: 0.86865, total FA: 120610

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=7.33611 | acc=0.1271 | tpr=0.7611 | fpr=0.8843 | 4693.2 samples/s | 18.3 steps/s
[Step= 100] | Loss=7.32092 | acc=0.1292 | tpr=0.7527 | fpr=0.8824 | 7899.7 samples/s | 30.9 steps/s
[Step= 150] | Loss=7.31771 | acc=0.1302 | tpr=0.7579 | fpr=0.8814 | 8083.8 samples/s | 31.6 steps/s
[Step= 200] | Loss=7.30246 | acc=0.1304 | tpr=0.7607 | fpr=0.8811 | 7949.9 samples/s | 31.1 steps/s
[Step= 250] | Loss=7.29472 | acc=0.1314 | tpr=0.7633 | fpr=0.8801 | 7675.8 samples/s | 30.0 steps/s
[Step= 300] | Loss=7.29001 | acc=0.1316 | tpr=0.7644 | fpr=0.8800 | 7909.3 samples/s | 30.9 steps/s
[Step= 350] | Loss=7.29872 | acc=0.1314 | tpr=0.7646 | fpr=0.8801 | 7815.0 samples/s | 30.5 steps/s
[Step= 400] | Loss=7.30070 | acc=0.1312 | tpr=0.7637 | fpr=0.8803 | 7544.9 samples/s | 29.5 steps/s
[Step= 450] | Loss=7.30441 | acc=0.1307 | tpr=0.7629 | fpr=0.8808 | 8107.0 samples/s | 31.7 steps/s
[Step= 500] | Loss=7.30434 | acc=0.1311 | tpr=0.7608 | fpr=0.8803 | 5999.9 samples/s | 23.4 steps/s
[Step= 550] | Loss=7.30439 | acc=0.1312 | tpr=0.7648 | fpr=0.8803 | 9937.1 samples/s | 38.8 steps/s
Avg test loss: 7.30636, Avg test acc: 0.13109, Avg tpr: 0.76506, Avg fpr: 0.88044, total FA: 122247

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.31670 | acc=0.1378 | tpr=0.7522 | fpr=0.8732 | 4529.3 samples/s | 17.7 steps/s
[Step= 100] | Loss=6.29761 | acc=0.1387 | tpr=0.7143 | fpr=0.8721 | 7948.8 samples/s | 31.0 steps/s
[Step= 150] | Loss=6.30412 | acc=0.1401 | tpr=0.7147 | fpr=0.8705 | 8098.1 samples/s | 31.6 steps/s
[Step= 200] | Loss=6.29852 | acc=0.1396 | tpr=0.7060 | fpr=0.8707 | 8357.9 samples/s | 32.6 steps/s
[Step= 250] | Loss=6.29183 | acc=0.1407 | tpr=0.7074 | fpr=0.8696 | 8051.1 samples/s | 31.4 steps/s
[Step= 300] | Loss=6.29169 | acc=0.1405 | tpr=0.7156 | fpr=0.8700 | 7328.2 samples/s | 28.6 steps/s
[Step= 350] | Loss=6.29861 | acc=0.1403 | tpr=0.7201 | fpr=0.8702 | 7751.8 samples/s | 30.3 steps/s
[Step= 400] | Loss=6.29929 | acc=0.1401 | tpr=0.7144 | fpr=0.8704 | 8098.9 samples/s | 31.6 steps/s
[Step= 450] | Loss=6.29849 | acc=0.1399 | tpr=0.7142 | fpr=0.8705 | 8139.7 samples/s | 31.8 steps/s
[Step= 500] | Loss=6.30330 | acc=0.1398 | tpr=0.7110 | fpr=0.8705 | 5878.0 samples/s | 23.0 steps/s
[Step= 550] | Loss=6.30182 | acc=0.1400 | tpr=0.7115 | fpr=0.8704 | 9846.4 samples/s | 38.5 steps/s
Avg test loss: 6.30254, Avg test acc: 0.13988, Avg tpr: 0.71157, Avg fpr: 0.87051, total FA: 120869

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14558 | acc=0.9641 | tpr=0.9248 | fpr=0.0352 | 4646.1 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.14681 | acc=0.9629 | tpr=0.9296 | fpr=0.0364 | 7559.0 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.15060 | acc=0.9619 | tpr=0.9337 | fpr=0.0376 | 7781.3 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.15010 | acc=0.9622 | tpr=0.9344 | fpr=0.0372 | 7882.5 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.15147 | acc=0.9618 | tpr=0.9301 | fpr=0.0376 | 8086.6 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.15333 | acc=0.9613 | tpr=0.9287 | fpr=0.0381 | 7781.5 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.15456 | acc=0.9611 | tpr=0.9280 | fpr=0.0383 | 8296.5 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.15549 | acc=0.9608 | tpr=0.9240 | fpr=0.0386 | 7724.5 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.15722 | acc=0.9606 | tpr=0.9226 | fpr=0.0387 | 7936.0 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.15691 | acc=0.9606 | tpr=0.9247 | fpr=0.0388 | 5990.3 samples/s | 23.4 steps/s
[Step= 550] | Loss=0.15669 | acc=0.9606 | tpr=0.9248 | fpr=0.0387 | 10263.7 samples/s | 40.1 steps/s
Avg test loss: 0.15633, Avg test acc: 0.96066, Avg tpr: 0.92512, Avg fpr: 0.03870, total FA: 5373

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14292 | acc=0.9639 | tpr=0.9071 | fpr=0.0351 | 4649.9 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.14856 | acc=0.9630 | tpr=0.9254 | fpr=0.0363 | 7825.2 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.15095 | acc=0.9623 | tpr=0.9207 | fpr=0.0370 | 7729.2 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.15007 | acc=0.9624 | tpr=0.9268 | fpr=0.0369 | 7410.0 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.15184 | acc=0.9619 | tpr=0.9240 | fpr=0.0374 | 8251.8 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.15162 | acc=0.9619 | tpr=0.9258 | fpr=0.0374 | 8317.4 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.15141 | acc=0.9621 | tpr=0.9261 | fpr=0.0372 | 8713.6 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.15264 | acc=0.9617 | tpr=0.9212 | fpr=0.0376 | 7867.4 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.15389 | acc=0.9615 | tpr=0.9197 | fpr=0.0378 | 5895.7 samples/s | 23.0 steps/s
[Step= 500] | Loss=0.15361 | acc=0.9615 | tpr=0.9220 | fpr=0.0378 | 7046.6 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.15349 | acc=0.9615 | tpr=0.9196 | fpr=0.0378 | 10529.3 samples/s | 41.1 steps/s
Avg test loss: 0.15317, Avg test acc: 0.96148, Avg tpr: 0.91918, Avg fpr: 0.03775, total FA: 5241

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.20171 | acc=0.9550 | tpr=0.9336 | fpr=0.0446 | 4683.8 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.21181 | acc=0.9549 | tpr=0.9232 | fpr=0.0445 | 7163.3 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.21524 | acc=0.9539 | tpr=0.9251 | fpr=0.0456 | 8132.4 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.21641 | acc=0.9541 | tpr=0.9301 | fpr=0.0454 | 7996.9 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.21890 | acc=0.9536 | tpr=0.9293 | fpr=0.0459 | 7586.2 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.22155 | acc=0.9528 | tpr=0.9265 | fpr=0.0467 | 8115.9 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.22202 | acc=0.9529 | tpr=0.9274 | fpr=0.0467 | 8210.2 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.22296 | acc=0.9527 | tpr=0.9229 | fpr=0.0468 | 8188.1 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.22394 | acc=0.9523 | tpr=0.9197 | fpr=0.0471 | 5772.8 samples/s | 22.5 steps/s
[Step= 500] | Loss=0.22367 | acc=0.9521 | tpr=0.9220 | fpr=0.0473 | 7608.4 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.22320 | acc=0.9522 | tpr=0.9208 | fpr=0.0473 | 11458.7 samples/s | 44.8 steps/s
Avg test loss: 0.22283, Avg test acc: 0.95218, Avg tpr: 0.92036, Avg fpr: 0.04724, total FA: 6559

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14360 | acc=0.9602 | tpr=0.9248 | fpr=0.0391 | 4641.0 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.14334 | acc=0.9594 | tpr=0.9382 | fpr=0.0402 | 7523.3 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.14688 | acc=0.9591 | tpr=0.9424 | fpr=0.0406 | 8096.7 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.14608 | acc=0.9592 | tpr=0.9475 | fpr=0.0406 | 7898.2 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.14812 | acc=0.9591 | tpr=0.9459 | fpr=0.0406 | 7485.4 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.14880 | acc=0.9588 | tpr=0.9440 | fpr=0.0409 | 7979.3 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.14989 | acc=0.9588 | tpr=0.9436 | fpr=0.0410 | 7653.0 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.15101 | acc=0.9584 | tpr=0.9409 | fpr=0.0413 | 8269.0 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.15150 | acc=0.9581 | tpr=0.9382 | fpr=0.0415 | 6125.0 samples/s | 23.9 steps/s
[Step= 500] | Loss=0.15108 | acc=0.9581 | tpr=0.9392 | fpr=0.0415 | 7207.9 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.15097 | acc=0.9581 | tpr=0.9371 | fpr=0.0415 | 13442.9 samples/s | 52.5 steps/s
Avg test loss: 0.15066, Avg test acc: 0.95817, Avg tpr: 0.93740, Avg fpr: 0.04145, total FA: 5755

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.17299 | acc=0.9644 | tpr=0.9115 | fpr=0.0347 | 4594.4 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.17871 | acc=0.9623 | tpr=0.9211 | fpr=0.0370 | 7870.7 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.17975 | acc=0.9620 | tpr=0.9280 | fpr=0.0374 | 8213.6 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.18024 | acc=0.9624 | tpr=0.9333 | fpr=0.0371 | 8320.6 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.18173 | acc=0.9622 | tpr=0.9293 | fpr=0.0372 | 7313.6 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.18334 | acc=0.9619 | tpr=0.9258 | fpr=0.0375 | 7945.2 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.18523 | acc=0.9618 | tpr=0.9224 | fpr=0.0375 | 8314.7 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.18582 | acc=0.9616 | tpr=0.9190 | fpr=0.0377 | 7967.1 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.18717 | acc=0.9611 | tpr=0.9172 | fpr=0.0382 | 5958.7 samples/s | 23.3 steps/s
[Step= 500] | Loss=0.18765 | acc=0.9609 | tpr=0.9181 | fpr=0.0384 | 8035.3 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.18650 | acc=0.9611 | tpr=0.9160 | fpr=0.0381 | 9708.6 samples/s | 37.9 steps/s
Avg test loss: 0.18612, Avg test acc: 0.96114, Avg tpr: 0.91601, Avg fpr: 0.03804, total FA: 5282

server round 12/50

clients selected: [0 3 5 6 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=68.3] | Loss=0.02411 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.265 | L2-Norm(final)=12.163 | 3289.0 samples/s | 51.4 steps/s
[Step=14050 Epoch=68.5] | Loss=0.06918 | Reg=0.00151 | acc=0.9531 | L2-Norm=12.268 | L2-Norm(final)=12.147 | 4786.3 samples/s | 74.8 steps/s
[Step=14100 Epoch=68.8] | Loss=0.06535 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.269 | L2-Norm(final)=12.133 | 5414.3 samples/s | 84.6 steps/s
[Step=14150 Epoch=69.0] | Loss=0.06431 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.269 | L2-Norm(final)=12.129 | 5438.0 samples/s | 85.0 steps/s
[Step=14200 Epoch=69.2] | Loss=0.06228 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.269 | L2-Norm(final)=12.127 | 8610.8 samples/s | 134.5 steps/s
[Step=14250 Epoch=69.5] | Loss=0.06060 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.269 | L2-Norm(final)=12.129 | 1494.7 samples/s | 23.4 steps/s
[Step=14300 Epoch=69.7] | Loss=0.06123 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.269 | L2-Norm(final)=12.131 | 5467.1 samples/s | 85.4 steps/s
[Step=14350 Epoch=70.0] | Loss=0.06160 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.269 | L2-Norm(final)=12.131 | 5545.5 samples/s | 86.6 steps/s
[Step=14400 Epoch=70.2] | Loss=0.06165 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.269 | L2-Norm(final)=12.129 | 7456.2 samples/s | 116.5 steps/s
[Step=14450 Epoch=70.5] | Loss=0.06143 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.269 | L2-Norm(final)=12.128 | 1520.3 samples/s | 23.8 steps/s
[Step=14500 Epoch=70.7] | Loss=0.06179 | Reg=0.00151 | acc=0.9375 | L2-Norm=12.269 | L2-Norm(final)=12.126 | 5422.0 samples/s | 84.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=70.7] | Loss=0.09285 | Reg=0.00151 | acc=0.9531 | L2-Norm=12.269 | L2-Norm(final)=12.106 | 3181.3 samples/s | 49.7 steps/s
[Step=14550 Epoch=70.9] | Loss=0.05392 | Reg=0.00153 | acc=0.9531 | L2-Norm=12.351 | L2-Norm(final)=12.096 | 4278.3 samples/s | 66.8 steps/s
[Step=14600 Epoch=71.2] | Loss=0.04657 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.422 | L2-Norm(final)=12.090 | 4661.5 samples/s | 72.8 steps/s
[Step=14650 Epoch=71.4] | Loss=0.04368 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.470 | L2-Norm(final)=12.087 | 4720.7 samples/s | 73.8 steps/s
[Step=14700 Epoch=71.7] | Loss=0.04238 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.509 | L2-Norm(final)=12.082 | 6760.3 samples/s | 105.6 steps/s
[Step=14750 Epoch=71.9] | Loss=0.03752 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.542 | L2-Norm(final)=12.081 | 1428.9 samples/s | 22.3 steps/s
[Step=14800 Epoch=72.2] | Loss=0.03413 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.571 | L2-Norm(final)=12.082 | 4739.3 samples/s | 74.1 steps/s
[Step=14850 Epoch=72.4] | Loss=0.03210 | Reg=0.00159 | acc=0.9531 | L2-Norm=12.596 | L2-Norm(final)=12.084 | 4656.8 samples/s | 72.8 steps/s
[Step=14900 Epoch=72.7] | Loss=0.03039 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.617 | L2-Norm(final)=12.085 | 6116.4 samples/s | 95.6 steps/s
[Step=14950 Epoch=72.9] | Loss=0.02820 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.636 | L2-Norm(final)=12.087 | 1444.9 samples/s | 22.6 steps/s
[Step=15000 Epoch=73.1] | Loss=0.02679 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.654 | L2-Norm(final)=12.090 | 4680.4 samples/s | 73.1 steps/s
[Step=15050 Epoch=73.4] | Loss=0.02509 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.670 | L2-Norm(final)=12.092 | 4721.8 samples/s | 73.8 steps/s
[Step=15100 Epoch=73.6] | Loss=0.02389 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.683 | L2-Norm(final)=12.095 | 5580.3 samples/s | 87.2 steps/s
[Step=15150 Epoch=73.9] | Loss=0.02276 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.696 | L2-Norm(final)=12.098 | 1514.3 samples/s | 23.7 steps/s
[Step=15200 Epoch=74.1] | Loss=0.02160 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.707 | L2-Norm(final)=12.101 | 4698.5 samples/s | 73.4 steps/s
[Step=15250 Epoch=74.4] | Loss=0.02063 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.717 | L2-Norm(final)=12.104 | 4651.5 samples/s | 72.7 steps/s
[Step=15300 Epoch=74.6] | Loss=0.01982 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.727 | L2-Norm(final)=12.107 | 5196.7 samples/s | 81.2 steps/s
[Step=15350 Epoch=74.8] | Loss=0.01925 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.735 | L2-Norm(final)=12.109 | 1531.1 samples/s | 23.9 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01848 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.744 | L2-Norm(final)=12.112 | 4713.1 samples/s | 73.6 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01792 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.752 | L2-Norm(final)=12.115 | 4713.6 samples/s | 73.7 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01749 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.759 | L2-Norm(final)=12.117 | 4822.0 samples/s | 75.3 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01701 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.766 | L2-Norm(final)=12.120 | 1559.4 samples/s | 24.4 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01651 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=12.122 | 4705.3 samples/s | 73.5 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01610 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.779 | L2-Norm(final)=12.125 | 4696.2 samples/s | 73.4 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01567 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.785 | L2-Norm(final)=12.127 | 4668.3 samples/s | 72.9 steps/s
[Step=15750 Epoch=76.8] | Loss=0.01526 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.791 | L2-Norm(final)=12.129 | 1556.3 samples/s | 24.3 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01483 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.798 | L2-Norm(final)=12.132 | 4767.6 samples/s | 74.5 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01449 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.804 | L2-Norm(final)=12.135 | 4653.0 samples/s | 72.7 steps/s
[Step=15900 Epoch=77.5] | Loss=0.01423 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.810 | L2-Norm(final)=12.138 | 4688.8 samples/s | 73.3 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01389 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.816 | L2-Norm(final)=12.140 | 1544.5 samples/s | 24.1 steps/s
[Step=16000 Epoch=78.0] | Loss=0.01360 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.822 | L2-Norm(final)=12.143 | 4797.1 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step16000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=97.5] | Loss=0.09117 | Reg=0.00150 | acc=0.9062 | L2-Norm=12.265 | L2-Norm(final)=14.083 | 3251.3 samples/s | 50.8 steps/s
[Step=20050 Epoch=97.8] | Loss=0.06118 | Reg=0.00151 | acc=0.9375 | L2-Norm=12.268 | L2-Norm(final)=14.056 | 4729.3 samples/s | 73.9 steps/s
[Step=20100 Epoch=98.0] | Loss=0.06049 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.269 | L2-Norm(final)=14.032 | 5434.9 samples/s | 84.9 steps/s
[Step=20150 Epoch=98.3] | Loss=0.05945 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.269 | L2-Norm(final)=14.013 | 5436.6 samples/s | 84.9 steps/s
[Step=20200 Epoch=98.5] | Loss=0.05876 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.269 | L2-Norm(final)=13.998 | 8646.9 samples/s | 135.1 steps/s
[Step=20250 Epoch=98.8] | Loss=0.05818 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.269 | L2-Norm(final)=13.991 | 1496.9 samples/s | 23.4 steps/s
[Step=20300 Epoch=99.0] | Loss=0.05858 | Reg=0.00151 | acc=0.9531 | L2-Norm=12.269 | L2-Norm(final)=13.984 | 5428.4 samples/s | 84.8 steps/s
[Step=20350 Epoch=99.2] | Loss=0.05819 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.269 | L2-Norm(final)=13.977 | 5574.9 samples/s | 87.1 steps/s
[Step=20400 Epoch=99.5] | Loss=0.05752 | Reg=0.00151 | acc=0.9375 | L2-Norm=12.269 | L2-Norm(final)=13.973 | 7474.8 samples/s | 116.8 steps/s
[Step=20450 Epoch=99.7] | Loss=0.05781 | Reg=0.00151 | acc=0.9531 | L2-Norm=12.269 | L2-Norm(final)=13.969 | 1497.0 samples/s | 23.4 steps/s
[Step=20500 Epoch=100.0] | Loss=0.05763 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.269 | L2-Norm(final)=13.966 | 5397.1 samples/s | 84.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=100.0] | Loss=0.03865 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.269 | L2-Norm(final)=13.930 | 3267.7 samples/s | 51.1 steps/s
[Step=20550 Epoch=100.2] | Loss=0.05290 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.357 | L2-Norm(final)=13.918 | 4209.7 samples/s | 65.8 steps/s
[Step=20600 Epoch=100.5] | Loss=0.05260 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.443 | L2-Norm(final)=13.905 | 4692.9 samples/s | 73.3 steps/s
[Step=20650 Epoch=100.7] | Loss=0.04804 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.510 | L2-Norm(final)=13.898 | 4682.9 samples/s | 73.2 steps/s
[Step=20700 Epoch=100.9] | Loss=0.04607 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=13.891 | 6781.0 samples/s | 106.0 steps/s
[Step=20750 Epoch=101.2] | Loss=0.04003 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.606 | L2-Norm(final)=13.889 | 1401.5 samples/s | 21.9 steps/s
[Step=20800 Epoch=101.4] | Loss=0.03636 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.641 | L2-Norm(final)=13.889 | 4712.4 samples/s | 73.6 steps/s
[Step=20850 Epoch=101.7] | Loss=0.03382 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.672 | L2-Norm(final)=13.890 | 4629.7 samples/s | 72.3 steps/s
[Step=20900 Epoch=101.9] | Loss=0.03183 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.699 | L2-Norm(final)=13.892 | 6090.7 samples/s | 95.2 steps/s
[Step=20950 Epoch=102.2] | Loss=0.02993 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.724 | L2-Norm(final)=13.893 | 1448.7 samples/s | 22.6 steps/s
[Step=21000 Epoch=102.4] | Loss=0.02800 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.745 | L2-Norm(final)=13.895 | 4715.1 samples/s | 73.7 steps/s
[Step=21050 Epoch=102.7] | Loss=0.02636 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.764 | L2-Norm(final)=13.897 | 4592.1 samples/s | 71.8 steps/s
[Step=21100 Epoch=102.9] | Loss=0.02499 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.781 | L2-Norm(final)=13.899 | 5615.9 samples/s | 87.7 steps/s
[Step=21150 Epoch=103.1] | Loss=0.02408 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.797 | L2-Norm(final)=13.902 | 1455.0 samples/s | 22.7 steps/s
[Step=21200 Epoch=103.4] | Loss=0.02279 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.813 | L2-Norm(final)=13.904 | 4642.6 samples/s | 72.5 steps/s
[Step=21250 Epoch=103.6] | Loss=0.02204 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.826 | L2-Norm(final)=13.907 | 4722.3 samples/s | 73.8 steps/s
[Step=21300 Epoch=103.9] | Loss=0.02124 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.840 | L2-Norm(final)=13.909 | 5177.1 samples/s | 80.9 steps/s
[Step=21350 Epoch=104.1] | Loss=0.02047 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.852 | L2-Norm(final)=13.912 | 1534.9 samples/s | 24.0 steps/s
[Step=21400 Epoch=104.4] | Loss=0.01981 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.864 | L2-Norm(final)=13.915 | 4667.2 samples/s | 72.9 steps/s
[Step=21450 Epoch=104.6] | Loss=0.01909 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.876 | L2-Norm(final)=13.917 | 4670.1 samples/s | 73.0 steps/s
[Step=21500 Epoch=104.8] | Loss=0.01846 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.886 | L2-Norm(final)=13.920 | 4867.5 samples/s | 76.1 steps/s
[Step=21550 Epoch=105.1] | Loss=0.01800 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.896 | L2-Norm(final)=13.922 | 1533.3 samples/s | 24.0 steps/s
[Step=21600 Epoch=105.3] | Loss=0.01746 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=13.924 | 4717.9 samples/s | 73.7 steps/s
[Step=21650 Epoch=105.6] | Loss=0.01704 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.913 | L2-Norm(final)=13.926 | 4671.0 samples/s | 73.0 steps/s
[Step=21700 Epoch=105.8] | Loss=0.01647 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=13.928 | 4766.3 samples/s | 74.5 steps/s
[Step=21750 Epoch=106.1] | Loss=0.01605 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.930 | L2-Norm(final)=13.931 | 1555.8 samples/s | 24.3 steps/s
[Step=21800 Epoch=106.3] | Loss=0.01561 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.937 | L2-Norm(final)=13.933 | 4720.2 samples/s | 73.8 steps/s
[Step=21850 Epoch=106.6] | Loss=0.01514 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.944 | L2-Norm(final)=13.936 | 4632.9 samples/s | 72.4 steps/s
[Step=21900 Epoch=106.8] | Loss=0.01485 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.951 | L2-Norm(final)=13.939 | 4690.1 samples/s | 73.3 steps/s
[Step=21950 Epoch=107.0] | Loss=0.01452 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.957 | L2-Norm(final)=13.941 | 1598.0 samples/s | 25.0 steps/s
[Step=22000 Epoch=107.3] | Loss=0.01430 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.963 | L2-Norm(final)=13.943 | 4708.7 samples/s | 73.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step22000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=151.6] | Loss=0.00027 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=14.718 | 3107.5 samples/s | 48.6 steps/s
[Step=16050 Epoch=152.1] | Loss=0.00511 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.260 | L2-Norm(final)=14.754 | 2805.5 samples/s | 43.8 steps/s
[Step=16100 Epoch=152.6] | Loss=0.00451 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=14.783 | 8074.5 samples/s | 126.2 steps/s
[Step=16150 Epoch=153.0] | Loss=0.00468 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=14.813 | 1457.5 samples/s | 22.8 steps/s
[Step=16200 Epoch=153.5] | Loss=0.00433 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=14.845 | 7272.0 samples/s | 113.6 steps/s
[Step=16250 Epoch=154.0] | Loss=0.00441 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=14.873 | 1471.6 samples/s | 23.0 steps/s
[Step=16300 Epoch=154.5] | Loss=0.00437 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=14.900 | 6389.3 samples/s | 99.8 steps/s
[Step=16350 Epoch=154.9] | Loss=0.00451 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=14.928 | 1533.8 samples/s | 24.0 steps/s
[Step=16400 Epoch=155.4] | Loss=0.00440 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=14.954 | 5853.7 samples/s | 91.5 steps/s
[Step=16450 Epoch=155.9] | Loss=0.00469 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=14.980 | 1562.6 samples/s | 24.4 steps/s
[Step=16500 Epoch=156.4] | Loss=0.00444 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=15.006 | 5273.5 samples/s | 82.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=156.4] | Loss=0.00331 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=15.257 | 3149.0 samples/s | 49.2 steps/s
[Step=16550 Epoch=156.8] | Loss=0.01425 | Reg=0.00153 | acc=0.9531 | L2-Norm=12.385 | L2-Norm(final)=15.252 | 4052.2 samples/s | 63.3 steps/s
[Step=16600 Epoch=157.3] | Loss=0.00840 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.510 | L2-Norm(final)=15.241 | 6449.9 samples/s | 100.8 steps/s
[Step=16650 Epoch=157.8] | Loss=0.00793 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.568 | L2-Norm(final)=15.238 | 1394.7 samples/s | 21.8 steps/s
[Step=16700 Epoch=158.2] | Loss=0.00606 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.612 | L2-Norm(final)=15.237 | 5810.2 samples/s | 90.8 steps/s
[Step=16750 Epoch=158.7] | Loss=0.00489 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.633 | L2-Norm(final)=15.238 | 1402.6 samples/s | 21.9 steps/s
[Step=16800 Epoch=159.2] | Loss=0.00410 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=15.239 | 5227.0 samples/s | 81.7 steps/s
[Step=16850 Epoch=159.7] | Loss=0.00352 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.641 | L2-Norm(final)=15.241 | 1446.2 samples/s | 22.6 steps/s
[Step=16900 Epoch=160.1] | Loss=0.00308 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.636 | L2-Norm(final)=15.242 | 4953.6 samples/s | 77.4 steps/s
[Step=16950 Epoch=160.6] | Loss=0.00274 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=15.243 | 1498.4 samples/s | 23.4 steps/s
[Step=17000 Epoch=161.1] | Loss=0.00247 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.618 | L2-Norm(final)=15.244 | 4579.0 samples/s | 71.5 steps/s
[Step=17050 Epoch=161.6] | Loss=0.00224 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.607 | L2-Norm(final)=15.245 | 1511.1 samples/s | 23.6 steps/s
[Step=17100 Epoch=162.0] | Loss=0.00206 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.594 | L2-Norm(final)=15.246 | 4556.3 samples/s | 71.2 steps/s
[Step=17150 Epoch=162.5] | Loss=0.00190 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.581 | L2-Norm(final)=15.247 | 1524.7 samples/s | 23.8 steps/s
[Step=17200 Epoch=163.0] | Loss=0.00176 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.568 | L2-Norm(final)=15.247 | 4482.8 samples/s | 70.0 steps/s
[Step=17250 Epoch=163.5] | Loss=0.00165 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=15.248 | 1534.0 samples/s | 24.0 steps/s
[Step=17300 Epoch=163.9] | Loss=0.00154 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.539 | L2-Norm(final)=15.249 | 4491.2 samples/s | 70.2 steps/s
[Step=17350 Epoch=164.4] | Loss=0.00145 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=15.249 | 1605.3 samples/s | 25.1 steps/s
[Step=17400 Epoch=164.9] | Loss=0.00137 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.510 | L2-Norm(final)=15.250 | 4135.6 samples/s | 64.6 steps/s
[Step=17450 Epoch=165.4] | Loss=0.00130 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=15.250 | 6745.5 samples/s | 105.4 steps/s
[Step=17500 Epoch=165.8] | Loss=0.00124 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.480 | L2-Norm(final)=15.251 | 1369.2 samples/s | 21.4 steps/s
[Step=17550 Epoch=166.3] | Loss=0.00118 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=15.251 | 6095.2 samples/s | 95.2 steps/s
[Step=17600 Epoch=166.8] | Loss=0.00112 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.449 | L2-Norm(final)=15.252 | 1423.2 samples/s | 22.2 steps/s
[Step=17650 Epoch=167.2] | Loss=0.00108 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.434 | L2-Norm(final)=15.252 | 5491.9 samples/s | 85.8 steps/s
[Step=17700 Epoch=167.7] | Loss=0.00103 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.418 | L2-Norm(final)=15.253 | 1437.2 samples/s | 22.5 steps/s
[Step=17750 Epoch=168.2] | Loss=0.00099 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.403 | L2-Norm(final)=15.253 | 5085.0 samples/s | 79.5 steps/s
[Step=17800 Epoch=168.7] | Loss=0.00095 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.388 | L2-Norm(final)=15.254 | 1458.4 samples/s | 22.8 steps/s
[Step=17850 Epoch=169.1] | Loss=0.00092 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.372 | L2-Norm(final)=15.254 | 4651.7 samples/s | 72.7 steps/s
[Step=17900 Epoch=169.6] | Loss=0.00088 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.357 | L2-Norm(final)=15.255 | 1492.7 samples/s | 23.3 steps/s
[Step=17950 Epoch=170.1] | Loss=0.00085 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.341 | L2-Norm(final)=15.255 | 4480.5 samples/s | 70.0 steps/s
[Step=18000 Epoch=170.6] | Loss=0.00083 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=15.255 | 1559.7 samples/s | 24.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step18000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=95.1] | Loss=0.02455 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.265 | L2-Norm(final)=9.696 | 3322.9 samples/s | 51.9 steps/s
[Step=10050 Epoch=95.6] | Loss=0.00713 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.259 | L2-Norm(final)=9.714 | 4275.9 samples/s | 66.8 steps/s
[Step=10100 Epoch=96.1] | Loss=0.00792 | Reg=0.00150 | acc=0.9531 | L2-Norm=12.258 | L2-Norm(final)=9.753 | 7867.1 samples/s | 122.9 steps/s
[Step=10150 Epoch=96.6] | Loss=0.00732 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=9.787 | 1473.9 samples/s | 23.0 steps/s
[Step=10200 Epoch=97.0] | Loss=0.00783 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.258 | L2-Norm(final)=9.823 | 7023.8 samples/s | 109.7 steps/s
[Step=10250 Epoch=97.5] | Loss=0.00799 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=9.849 | 1464.0 samples/s | 22.9 steps/s
[Step=10300 Epoch=98.0] | Loss=0.00784 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.257 | L2-Norm(final)=9.875 | 6529.1 samples/s | 102.0 steps/s
[Step=10350 Epoch=98.5] | Loss=0.00797 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=9.902 | 1520.1 samples/s | 23.8 steps/s
[Step=10400 Epoch=98.9] | Loss=0.00772 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=9.930 | 5769.4 samples/s | 90.1 steps/s
[Step=10450 Epoch=99.4] | Loss=0.00766 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=9.957 | 1548.9 samples/s | 24.2 steps/s
[Step=10500 Epoch=99.9] | Loss=0.00772 | Reg=0.00150 | acc=0.9531 | L2-Norm=12.257 | L2-Norm(final)=9.985 | 5390.1 samples/s | 84.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=99.9] | Loss=0.00316 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=10.257 | 3342.9 samples/s | 52.2 steps/s
[Step=10550 Epoch=100.4] | Loss=0.00533 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.370 | L2-Norm(final)=10.266 | 3781.5 samples/s | 59.1 steps/s
[Step=10600 Epoch=100.8] | Loss=0.00535 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.507 | L2-Norm(final)=10.261 | 6468.2 samples/s | 101.1 steps/s
[Step=10650 Epoch=101.3] | Loss=0.00394 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.589 | L2-Norm(final)=10.257 | 1388.4 samples/s | 21.7 steps/s
[Step=10700 Epoch=101.8] | Loss=0.00298 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.624 | L2-Norm(final)=10.256 | 5906.9 samples/s | 92.3 steps/s
[Step=10750 Epoch=102.3] | Loss=0.00238 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.634 | L2-Norm(final)=10.256 | 1409.3 samples/s | 22.0 steps/s
[Step=10800 Epoch=102.7] | Loss=0.00199 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.632 | L2-Norm(final)=10.256 | 5374.2 samples/s | 84.0 steps/s
[Step=10850 Epoch=103.2] | Loss=0.00171 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.623 | L2-Norm(final)=10.257 | 1467.6 samples/s | 22.9 steps/s
[Step=10900 Epoch=103.7] | Loss=0.00149 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.610 | L2-Norm(final)=10.257 | 4908.0 samples/s | 76.7 steps/s
[Step=10950 Epoch=104.2] | Loss=0.00133 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.595 | L2-Norm(final)=10.257 | 1492.0 samples/s | 23.3 steps/s
[Step=11000 Epoch=104.6] | Loss=0.00120 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.578 | L2-Norm(final)=10.258 | 4536.9 samples/s | 70.9 steps/s
[Step=11050 Epoch=105.1] | Loss=0.00109 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.560 | L2-Norm(final)=10.258 | 1537.0 samples/s | 24.0 steps/s
[Step=11100 Epoch=105.6] | Loss=0.00100 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.542 | L2-Norm(final)=10.258 | 4402.5 samples/s | 68.8 steps/s
[Step=11150 Epoch=106.1] | Loss=0.00092 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=10.259 | 1510.5 samples/s | 23.6 steps/s
[Step=11200 Epoch=106.5] | Loss=0.00086 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.503 | L2-Norm(final)=10.259 | 4432.4 samples/s | 69.3 steps/s
[Step=11250 Epoch=107.0] | Loss=0.00080 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=10.259 | 1544.5 samples/s | 24.1 steps/s
[Step=11300 Epoch=107.5] | Loss=0.00075 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=10.260 | 4420.8 samples/s | 69.1 steps/s
[Step=11350 Epoch=108.0] | Loss=0.00071 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.445 | L2-Norm(final)=10.260 | 1555.0 samples/s | 24.3 steps/s
[Step=11400 Epoch=108.4] | Loss=0.00067 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=10.260 | 4361.3 samples/s | 68.1 steps/s
[Step=11450 Epoch=108.9] | Loss=0.00063 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.405 | L2-Norm(final)=10.261 | 6704.6 samples/s | 104.8 steps/s
[Step=11500 Epoch=109.4] | Loss=0.00060 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.385 | L2-Norm(final)=10.261 | 1361.0 samples/s | 21.3 steps/s
[Step=11550 Epoch=109.9] | Loss=0.00057 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.365 | L2-Norm(final)=10.261 | 6128.7 samples/s | 95.8 steps/s
[Step=11600 Epoch=110.3] | Loss=0.00055 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.346 | L2-Norm(final)=10.262 | 1402.0 samples/s | 21.9 steps/s
[Step=11650 Epoch=110.8] | Loss=0.00052 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=10.262 | 5537.9 samples/s | 86.5 steps/s
[Step=11700 Epoch=111.3] | Loss=0.00050 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=10.262 | 1418.4 samples/s | 22.2 steps/s
[Step=11750 Epoch=111.8] | Loss=0.00048 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=10.263 | 5094.9 samples/s | 79.6 steps/s
[Step=11800 Epoch=112.2] | Loss=0.00046 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.267 | L2-Norm(final)=10.263 | 1458.7 samples/s | 22.8 steps/s
[Step=11850 Epoch=112.7] | Loss=0.00045 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.247 | L2-Norm(final)=10.263 | 4666.3 samples/s | 72.9 steps/s
[Step=11900 Epoch=113.2] | Loss=0.00043 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=10.264 | 1524.6 samples/s | 23.8 steps/s
[Step=11950 Epoch=113.7] | Loss=0.00041 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=10.264 | 4477.3 samples/s | 70.0 steps/s
[Step=12000 Epoch=114.1] | Loss=0.00040 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.189 | L2-Norm(final)=10.265 | 1526.5 samples/s | 23.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step12000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=133.7] | Loss=0.00208 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=13.285 | 3314.6 samples/s | 51.8 steps/s
[Step=14050 Epoch=134.2] | Loss=0.00560 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.259 | L2-Norm(final)=13.302 | 4456.3 samples/s | 69.6 steps/s
[Step=14100 Epoch=134.6] | Loss=0.00595 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.258 | L2-Norm(final)=13.322 | 8198.4 samples/s | 128.1 steps/s
[Step=14150 Epoch=135.1] | Loss=0.00536 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=13.342 | 1421.7 samples/s | 22.2 steps/s
[Step=14200 Epoch=135.6] | Loss=0.00590 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=13.360 | 7501.0 samples/s | 117.2 steps/s
[Step=14250 Epoch=136.1] | Loss=0.00586 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=13.378 | 1453.6 samples/s | 22.7 steps/s
[Step=14300 Epoch=136.6] | Loss=0.00586 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=13.395 | 6729.9 samples/s | 105.2 steps/s
[Step=14350 Epoch=137.0] | Loss=0.00582 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.258 | L2-Norm(final)=13.413 | 1500.5 samples/s | 23.4 steps/s
[Step=14400 Epoch=137.5] | Loss=0.00579 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=13.431 | 6166.8 samples/s | 96.4 steps/s
[Step=14450 Epoch=138.0] | Loss=0.00582 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=13.448 | 1522.4 samples/s | 23.8 steps/s
[Step=14500 Epoch=138.5] | Loss=0.00584 | Reg=0.00150 | acc=0.9531 | L2-Norm=12.258 | L2-Norm(final)=13.465 | 5753.6 samples/s | 89.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=138.5] | Loss=0.00135 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=13.635 | 3146.6 samples/s | 49.2 steps/s
[Step=14550 Epoch=138.9] | Loss=0.00775 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=13.634 | 4008.2 samples/s | 62.6 steps/s
[Step=14600 Epoch=139.4] | Loss=0.00725 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=13.618 | 6556.2 samples/s | 102.4 steps/s
[Step=14650 Epoch=139.9] | Loss=0.00503 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.604 | L2-Norm(final)=13.605 | 1383.4 samples/s | 21.6 steps/s
[Step=14700 Epoch=140.4] | Loss=0.00391 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.635 | L2-Norm(final)=13.599 | 6044.0 samples/s | 94.4 steps/s
[Step=14750 Epoch=140.9] | Loss=0.00313 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.645 | L2-Norm(final)=13.596 | 1399.2 samples/s | 21.9 steps/s
[Step=14800 Epoch=141.3] | Loss=0.00261 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.645 | L2-Norm(final)=13.594 | 5582.7 samples/s | 87.2 steps/s
[Step=14850 Epoch=141.8] | Loss=0.00224 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.639 | L2-Norm(final)=13.593 | 1424.3 samples/s | 22.3 steps/s
[Step=14900 Epoch=142.3] | Loss=0.00196 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.629 | L2-Norm(final)=13.592 | 5192.9 samples/s | 81.1 steps/s
[Step=14950 Epoch=142.8] | Loss=0.00175 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.617 | L2-Norm(final)=13.592 | 1453.4 samples/s | 22.7 steps/s
[Step=15000 Epoch=143.2] | Loss=0.00157 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.603 | L2-Norm(final)=13.591 | 4865.5 samples/s | 76.0 steps/s
[Step=15050 Epoch=143.7] | Loss=0.00143 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.589 | L2-Norm(final)=13.591 | 1464.1 samples/s | 22.9 steps/s
[Step=15100 Epoch=144.2] | Loss=0.00131 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.574 | L2-Norm(final)=13.591 | 4595.9 samples/s | 71.8 steps/s
[Step=15150 Epoch=144.7] | Loss=0.00121 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=13.591 | 1524.9 samples/s | 23.8 steps/s
[Step=15200 Epoch=145.2] | Loss=0.00113 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.542 | L2-Norm(final)=13.591 | 4445.5 samples/s | 69.5 steps/s
[Step=15250 Epoch=145.6] | Loss=0.00105 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=13.592 | 1520.9 samples/s | 23.8 steps/s
[Step=15300 Epoch=146.1] | Loss=0.00099 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.510 | L2-Norm(final)=13.592 | 4489.5 samples/s | 70.1 steps/s
[Step=15350 Epoch=146.6] | Loss=0.00093 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.494 | L2-Norm(final)=13.592 | 1523.2 samples/s | 23.8 steps/s
[Step=15400 Epoch=147.1] | Loss=0.00088 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=13.592 | 4484.7 samples/s | 70.1 steps/s
[Step=15450 Epoch=147.5] | Loss=0.00083 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=13.592 | 1507.7 samples/s | 23.6 steps/s
[Step=15500 Epoch=148.0] | Loss=0.00079 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.445 | L2-Norm(final)=13.592 | 4513.4 samples/s | 70.5 steps/s
[Step=15550 Epoch=148.5] | Loss=0.00075 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.429 | L2-Norm(final)=13.593 | 7074.4 samples/s | 110.5 steps/s
[Step=15600 Epoch=149.0] | Loss=0.00072 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.412 | L2-Norm(final)=13.593 | 1347.3 samples/s | 21.1 steps/s
[Step=15650 Epoch=149.4] | Loss=0.00069 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.396 | L2-Norm(final)=13.593 | 6512.9 samples/s | 101.8 steps/s
[Step=15700 Epoch=149.9] | Loss=0.00066 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.379 | L2-Norm(final)=13.593 | 1370.4 samples/s | 21.4 steps/s
[Step=15750 Epoch=150.4] | Loss=0.00063 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.363 | L2-Norm(final)=13.594 | 6095.8 samples/s | 95.2 steps/s
[Step=15800 Epoch=150.9] | Loss=0.00061 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.347 | L2-Norm(final)=13.594 | 1395.2 samples/s | 21.8 steps/s
[Step=15850 Epoch=151.4] | Loss=0.00059 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.331 | L2-Norm(final)=13.594 | 5629.9 samples/s | 88.0 steps/s
[Step=15900 Epoch=151.8] | Loss=0.00056 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=13.594 | 1422.9 samples/s | 22.2 steps/s
[Step=15950 Epoch=152.3] | Loss=0.00055 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=13.595 | 5137.5 samples/s | 80.3 steps/s
[Step=16000 Epoch=152.8] | Loss=0.00053 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=13.595 | 1479.1 samples/s | 23.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.12501 | acc=0.9509 | tpr=0.9674 | fpr=0.0847 | 4682.4 samples/s | 18.3 steps/s
Avg test loss: 0.13131, Avg test acc: 0.94903, Avg tpr: 0.96654, Avg fpr: 0.08948, total FA: 698

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.13479 | acc=0.9495 | tpr=0.9735 | fpr=0.1028 | 4627.9 samples/s | 18.1 steps/s
Avg test loss: 0.13693, Avg test acc: 0.94799, Avg tpr: 0.97371, Avg fpr: 0.10858, total FA: 847

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11812 | acc=0.9465 | tpr=0.9684 | fpr=0.1011 | 4662.3 samples/s | 18.2 steps/s
Avg test loss: 0.11926, Avg test acc: 0.94627, Avg tpr: 0.96818, Avg fpr: 0.10191, total FA: 795

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.11058 | acc=0.9521 | tpr=0.9709 | fpr=0.0887 | 4503.6 samples/s | 17.6 steps/s
Avg test loss: 0.11534, Avg test acc: 0.95048, Avg tpr: 0.97074, Avg fpr: 0.09409, total FA: 734

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11111 | acc=0.9511 | tpr=0.9671 | fpr=0.0837 | 4444.6 samples/s | 17.4 steps/s
Avg test loss: 0.11621, Avg test acc: 0.94899, Avg tpr: 0.96544, Avg fpr: 0.08717, total FA: 680

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.46641 | acc=0.3178 | tpr=0.0215 | fpr=0.0387 | 4560.7 samples/s | 17.8 steps/s
Avg test loss: 4.49112, Avg test acc: 0.31517, Avg tpr: 0.02186, Avg fpr: 0.03974, total FA: 310

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.39109 | acc=0.3063 | tpr=0.0055 | fpr=0.0404 | 4718.6 samples/s | 18.4 steps/s
Avg test loss: 4.41110, Avg test acc: 0.30355, Avg tpr: 0.00583, Avg fpr: 0.04166, total FA: 325

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.04084 | acc=0.3000 | tpr=0.0149 | fpr=0.0810 | 4750.5 samples/s | 18.6 steps/s
Avg test loss: 4.05923, Avg test acc: 0.29874, Avg tpr: 0.01463, Avg fpr: 0.07640, total FA: 596

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.46640 | acc=0.3191 | tpr=0.0192 | fpr=0.0295 | 4685.1 samples/s | 18.3 steps/s
Avg test loss: 4.47871, Avg test acc: 0.31637, Avg tpr: 0.01877, Avg fpr: 0.02910, total FA: 227

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.60683 | acc=0.3137 | tpr=0.0094 | fpr=0.0255 | 4813.3 samples/s | 18.8 steps/s
Avg test loss: 5.63480, Avg test acc: 0.31100, Avg tpr: 0.00868, Avg fpr: 0.02410, total FA: 188

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.36342 | acc=0.1459 | tpr=0.7566 | fpr=0.8651 | 4672.1 samples/s | 18.3 steps/s
[Step= 100] | Loss=6.35183 | acc=0.1459 | tpr=0.7249 | fpr=0.8649 | 7545.4 samples/s | 29.5 steps/s
[Step= 150] | Loss=6.36129 | acc=0.1470 | tpr=0.7507 | fpr=0.8642 | 7866.2 samples/s | 30.7 steps/s
[Step= 200] | Loss=6.35444 | acc=0.1465 | tpr=0.7541 | fpr=0.8646 | 7991.7 samples/s | 31.2 steps/s
[Step= 250] | Loss=6.34888 | acc=0.1472 | tpr=0.7459 | fpr=0.8637 | 7856.2 samples/s | 30.7 steps/s
[Step= 300] | Loss=6.35042 | acc=0.1475 | tpr=0.7462 | fpr=0.8634 | 8362.8 samples/s | 32.7 steps/s
[Step= 350] | Loss=6.35893 | acc=0.1470 | tpr=0.7464 | fpr=0.8639 | 8175.8 samples/s | 31.9 steps/s
[Step= 400] | Loss=6.35838 | acc=0.1466 | tpr=0.7429 | fpr=0.8642 | 7802.7 samples/s | 30.5 steps/s
[Step= 450] | Loss=6.35871 | acc=0.1464 | tpr=0.7463 | fpr=0.8645 | 8026.4 samples/s | 31.4 steps/s
[Step= 500] | Loss=6.36188 | acc=0.1464 | tpr=0.7463 | fpr=0.8644 | 7180.0 samples/s | 28.0 steps/s
[Step= 550] | Loss=6.36002 | acc=0.1466 | tpr=0.7469 | fpr=0.8643 | 12281.7 samples/s | 48.0 steps/s
Avg test loss: 6.36077, Avg test acc: 0.14652, Avg tpr: 0.74683, Avg fpr: 0.86439, total FA: 120019

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.83656 | acc=0.1270 | tpr=0.8142 | fpr=0.8854 | 4644.3 samples/s | 18.1 steps/s
[Step= 100] | Loss=6.82038 | acc=0.1271 | tpr=0.7804 | fpr=0.8851 | 7602.4 samples/s | 29.7 steps/s
[Step= 150] | Loss=6.82313 | acc=0.1279 | tpr=0.7896 | fpr=0.8843 | 8009.5 samples/s | 31.3 steps/s
[Step= 200] | Loss=6.81719 | acc=0.1279 | tpr=0.7880 | fpr=0.8841 | 7781.8 samples/s | 30.4 steps/s
[Step= 250] | Loss=6.81465 | acc=0.1289 | tpr=0.7904 | fpr=0.8831 | 7989.9 samples/s | 31.2 steps/s
[Step= 300] | Loss=6.81338 | acc=0.1293 | tpr=0.7956 | fpr=0.8828 | 7947.9 samples/s | 31.0 steps/s
[Step= 350] | Loss=6.82042 | acc=0.1288 | tpr=0.7927 | fpr=0.8832 | 8220.1 samples/s | 32.1 steps/s
[Step= 400] | Loss=6.82414 | acc=0.1289 | tpr=0.7899 | fpr=0.8831 | 8175.6 samples/s | 31.9 steps/s
[Step= 450] | Loss=6.82502 | acc=0.1289 | tpr=0.7877 | fpr=0.8831 | 7943.8 samples/s | 31.0 steps/s
[Step= 500] | Loss=6.82580 | acc=0.1289 | tpr=0.7828 | fpr=0.8829 | 8106.7 samples/s | 31.7 steps/s
[Step= 550] | Loss=6.82478 | acc=0.1292 | tpr=0.7875 | fpr=0.8828 | 10004.3 samples/s | 39.1 steps/s
Avg test loss: 6.82722, Avg test acc: 0.12906, Avg tpr: 0.78764, Avg fpr: 0.88292, total FA: 122591

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.97436 | acc=0.1412 | tpr=0.8186 | fpr=0.8709 | 4669.4 samples/s | 18.2 steps/s
[Step= 100] | Loss=5.95727 | acc=0.1423 | tpr=0.7719 | fpr=0.8695 | 8499.4 samples/s | 33.2 steps/s
[Step= 150] | Loss=5.96448 | acc=0.1430 | tpr=0.7839 | fpr=0.8688 | 7987.0 samples/s | 31.2 steps/s
[Step= 200] | Loss=5.94983 | acc=0.1435 | tpr=0.7825 | fpr=0.8681 | 7166.6 samples/s | 28.0 steps/s
[Step= 250] | Loss=5.94308 | acc=0.1442 | tpr=0.7782 | fpr=0.8674 | 8011.1 samples/s | 31.3 steps/s
[Step= 300] | Loss=5.93942 | acc=0.1440 | tpr=0.7782 | fpr=0.8675 | 8623.6 samples/s | 33.7 steps/s
[Step= 350] | Loss=5.94823 | acc=0.1432 | tpr=0.7771 | fpr=0.8683 | 7963.3 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.95090 | acc=0.1430 | tpr=0.7790 | fpr=0.8685 | 8079.1 samples/s | 31.6 steps/s
[Step= 450] | Loss=5.95073 | acc=0.1429 | tpr=0.7804 | fpr=0.8687 | 7522.3 samples/s | 29.4 steps/s
[Step= 500] | Loss=5.95174 | acc=0.1430 | tpr=0.7793 | fpr=0.8685 | 8213.9 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.95101 | acc=0.1431 | tpr=0.7803 | fpr=0.8685 | 10144.3 samples/s | 39.6 steps/s
Avg test loss: 5.95182, Avg test acc: 0.14293, Avg tpr: 0.78011, Avg fpr: 0.86865, total FA: 120610

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.55512 | acc=0.1270 | tpr=0.8451 | fpr=0.8859 | 4625.4 samples/s | 18.1 steps/s
[Step= 100] | Loss=6.53607 | acc=0.1293 | tpr=0.8571 | fpr=0.8842 | 7756.9 samples/s | 30.3 steps/s
[Step= 150] | Loss=6.54045 | acc=0.1299 | tpr=0.8631 | fpr=0.8836 | 8017.0 samples/s | 31.3 steps/s
[Step= 200] | Loss=6.52892 | acc=0.1300 | tpr=0.8721 | fpr=0.8835 | 8631.9 samples/s | 33.7 steps/s
[Step= 250] | Loss=6.52621 | acc=0.1303 | tpr=0.8716 | fpr=0.8833 | 7725.7 samples/s | 30.2 steps/s
[Step= 300] | Loss=6.52406 | acc=0.1302 | tpr=0.8691 | fpr=0.8833 | 8312.9 samples/s | 32.5 steps/s
[Step= 350] | Loss=6.53275 | acc=0.1296 | tpr=0.8698 | fpr=0.8839 | 7945.0 samples/s | 31.0 steps/s
[Step= 400] | Loss=6.53429 | acc=0.1296 | tpr=0.8638 | fpr=0.8838 | 8014.9 samples/s | 31.3 steps/s
[Step= 450] | Loss=6.53666 | acc=0.1292 | tpr=0.8627 | fpr=0.8841 | 7134.2 samples/s | 27.9 steps/s
[Step= 500] | Loss=6.53853 | acc=0.1293 | tpr=0.8573 | fpr=0.8838 | 8268.0 samples/s | 32.3 steps/s
[Step= 550] | Loss=6.53865 | acc=0.1294 | tpr=0.8611 | fpr=0.8839 | 10454.4 samples/s | 40.8 steps/s
Avg test loss: 6.53954, Avg test acc: 0.12930, Avg tpr: 0.86094, Avg fpr: 0.88400, total FA: 122741

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.31670 | acc=0.1378 | tpr=0.7522 | fpr=0.8732 | 4796.1 samples/s | 18.7 steps/s
[Step= 100] | Loss=6.29761 | acc=0.1387 | tpr=0.7143 | fpr=0.8721 | 7000.2 samples/s | 27.3 steps/s
[Step= 150] | Loss=6.30412 | acc=0.1401 | tpr=0.7147 | fpr=0.8705 | 8396.2 samples/s | 32.8 steps/s
[Step= 200] | Loss=6.29852 | acc=0.1396 | tpr=0.7060 | fpr=0.8707 | 8301.8 samples/s | 32.4 steps/s
[Step= 250] | Loss=6.29183 | acc=0.1407 | tpr=0.7074 | fpr=0.8696 | 8109.5 samples/s | 31.7 steps/s
[Step= 300] | Loss=6.29169 | acc=0.1405 | tpr=0.7156 | fpr=0.8700 | 7917.3 samples/s | 30.9 steps/s
[Step= 350] | Loss=6.29861 | acc=0.1403 | tpr=0.7201 | fpr=0.8702 | 8197.2 samples/s | 32.0 steps/s
[Step= 400] | Loss=6.29929 | acc=0.1401 | tpr=0.7144 | fpr=0.8704 | 8060.4 samples/s | 31.5 steps/s
[Step= 450] | Loss=6.29849 | acc=0.1399 | tpr=0.7142 | fpr=0.8705 | 8354.3 samples/s | 32.6 steps/s
[Step= 500] | Loss=6.30330 | acc=0.1398 | tpr=0.7110 | fpr=0.8705 | 7929.3 samples/s | 31.0 steps/s
[Step= 550] | Loss=6.30182 | acc=0.1400 | tpr=0.7115 | fpr=0.8704 | 9181.8 samples/s | 35.9 steps/s
Avg test loss: 6.30254, Avg test acc: 0.13988, Avg tpr: 0.71157, Avg fpr: 0.87051, total FA: 120869

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.16159 | acc=0.9591 | tpr=0.9071 | fpr=0.0400 | 4787.0 samples/s | 18.7 steps/s
[Step= 100] | Loss=0.16615 | acc=0.9582 | tpr=0.9211 | fpr=0.0411 | 7975.9 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.17085 | acc=0.9573 | tpr=0.9222 | fpr=0.0421 | 7362.7 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.17115 | acc=0.9573 | tpr=0.9235 | fpr=0.0421 | 8124.3 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.17303 | acc=0.9570 | tpr=0.9205 | fpr=0.0423 | 8210.4 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.17513 | acc=0.9565 | tpr=0.9207 | fpr=0.0428 | 8095.3 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.17659 | acc=0.9563 | tpr=0.9192 | fpr=0.0430 | 7812.4 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.17737 | acc=0.9561 | tpr=0.9147 | fpr=0.0432 | 8429.9 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.17879 | acc=0.9558 | tpr=0.9133 | fpr=0.0435 | 7734.2 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.17765 | acc=0.9559 | tpr=0.9163 | fpr=0.0434 | 8351.2 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.17783 | acc=0.9560 | tpr=0.9152 | fpr=0.0433 | 9904.8 samples/s | 38.7 steps/s
Avg test loss: 0.17744, Avg test acc: 0.95599, Avg tpr: 0.91482, Avg fpr: 0.04326, total FA: 6007

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12613 | acc=0.9681 | tpr=0.9115 | fpr=0.0309 | 4705.7 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.13386 | acc=0.9671 | tpr=0.9190 | fpr=0.0320 | 7189.6 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.13552 | acc=0.9666 | tpr=0.9193 | fpr=0.0325 | 7912.0 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.13595 | acc=0.9668 | tpr=0.9235 | fpr=0.0324 | 7955.8 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.13665 | acc=0.9666 | tpr=0.9205 | fpr=0.0326 | 8313.5 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.13731 | acc=0.9662 | tpr=0.9193 | fpr=0.0329 | 7530.3 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.13703 | acc=0.9663 | tpr=0.9186 | fpr=0.0329 | 8213.1 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.13871 | acc=0.9658 | tpr=0.9136 | fpr=0.0332 | 7879.1 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.13924 | acc=0.9657 | tpr=0.9114 | fpr=0.0333 | 8209.6 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.13904 | acc=0.9656 | tpr=0.9132 | fpr=0.0334 | 7570.6 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.13881 | acc=0.9656 | tpr=0.9113 | fpr=0.0334 | 11909.7 samples/s | 46.5 steps/s
Avg test loss: 0.13856, Avg test acc: 0.96559, Avg tpr: 0.91165, Avg fpr: 0.03343, total FA: 4642

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.27923 | acc=0.9463 | tpr=0.9469 | fpr=0.0537 | 4801.2 samples/s | 18.8 steps/s
[Step= 100] | Loss=0.28497 | acc=0.9451 | tpr=0.9382 | fpr=0.0548 | 7727.1 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.29045 | acc=0.9440 | tpr=0.9366 | fpr=0.0559 | 7892.4 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.29153 | acc=0.9444 | tpr=0.9399 | fpr=0.0555 | 7319.1 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.29384 | acc=0.9442 | tpr=0.9371 | fpr=0.0557 | 7860.1 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.29560 | acc=0.9439 | tpr=0.9360 | fpr=0.0560 | 9096.5 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.29591 | acc=0.9438 | tpr=0.9361 | fpr=0.0561 | 7632.2 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.29780 | acc=0.9435 | tpr=0.9338 | fpr=0.0563 | 8515.9 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.29922 | acc=0.9432 | tpr=0.9318 | fpr=0.0566 | 7990.0 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.29895 | acc=0.9429 | tpr=0.9335 | fpr=0.0569 | 8055.3 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.29849 | acc=0.9430 | tpr=0.9327 | fpr=0.0568 | 9297.2 samples/s | 36.3 steps/s
Avg test loss: 0.29801, Avg test acc: 0.94306, Avg tpr: 0.93304, Avg fpr: 0.05676, total FA: 7881

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14360 | acc=0.9602 | tpr=0.9248 | fpr=0.0391 | 4652.9 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.14334 | acc=0.9594 | tpr=0.9382 | fpr=0.0402 | 7920.8 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.14688 | acc=0.9591 | tpr=0.9424 | fpr=0.0406 | 8462.5 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.14608 | acc=0.9592 | tpr=0.9475 | fpr=0.0406 | 7194.8 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.14812 | acc=0.9591 | tpr=0.9459 | fpr=0.0406 | 8398.6 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.14880 | acc=0.9588 | tpr=0.9440 | fpr=0.0409 | 8701.9 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.14989 | acc=0.9588 | tpr=0.9436 | fpr=0.0410 | 7397.2 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.15101 | acc=0.9584 | tpr=0.9409 | fpr=0.0413 | 7877.7 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.15150 | acc=0.9581 | tpr=0.9382 | fpr=0.0415 | 8067.8 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.15108 | acc=0.9581 | tpr=0.9392 | fpr=0.0415 | 7103.9 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.15097 | acc=0.9581 | tpr=0.9371 | fpr=0.0415 | 11964.6 samples/s | 46.7 steps/s
Avg test loss: 0.15066, Avg test acc: 0.95817, Avg tpr: 0.93740, Avg fpr: 0.04145, total FA: 5755

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.17299 | acc=0.9644 | tpr=0.9115 | fpr=0.0347 | 4691.5 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.17871 | acc=0.9623 | tpr=0.9211 | fpr=0.0370 | 7822.4 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.17975 | acc=0.9620 | tpr=0.9280 | fpr=0.0374 | 7514.1 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.18024 | acc=0.9624 | tpr=0.9333 | fpr=0.0371 | 8087.3 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.18173 | acc=0.9622 | tpr=0.9293 | fpr=0.0372 | 8122.1 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.18334 | acc=0.9619 | tpr=0.9258 | fpr=0.0375 | 7919.2 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.18523 | acc=0.9618 | tpr=0.9224 | fpr=0.0375 | 8084.7 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.18582 | acc=0.9616 | tpr=0.9190 | fpr=0.0377 | 8204.8 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.18717 | acc=0.9611 | tpr=0.9172 | fpr=0.0382 | 8224.5 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.18765 | acc=0.9609 | tpr=0.9181 | fpr=0.0384 | 8146.6 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.18650 | acc=0.9611 | tpr=0.9160 | fpr=0.0381 | 9760.1 samples/s | 38.1 steps/s
Avg test loss: 0.18612, Avg test acc: 0.96114, Avg tpr: 0.91601, Avg fpr: 0.03804, total FA: 5282

server round 13/50

clients selected: [0 5 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=78.0] | Loss=0.08612 | Reg=0.00146 | acc=0.9219 | L2-Norm=12.076 | L2-Norm(final)=12.226 | 3215.3 samples/s | 50.2 steps/s
[Step=16050 Epoch=78.3] | Loss=0.06943 | Reg=0.00146 | acc=0.9219 | L2-Norm=12.077 | L2-Norm(final)=12.215 | 4890.1 samples/s | 76.4 steps/s
[Step=16100 Epoch=78.5] | Loss=0.06353 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.077 | L2-Norm(final)=12.207 | 5354.8 samples/s | 83.7 steps/s
[Step=16150 Epoch=78.8] | Loss=0.06342 | Reg=0.00146 | acc=0.9062 | L2-Norm=12.077 | L2-Norm(final)=12.205 | 5477.7 samples/s | 85.6 steps/s
[Step=16200 Epoch=79.0] | Loss=0.06362 | Reg=0.00146 | acc=0.9375 | L2-Norm=12.077 | L2-Norm(final)=12.204 | 8501.2 samples/s | 132.8 steps/s
[Step=16250 Epoch=79.2] | Loss=0.06372 | Reg=0.00146 | acc=0.9375 | L2-Norm=12.078 | L2-Norm(final)=12.198 | 1494.9 samples/s | 23.4 steps/s
[Step=16300 Epoch=79.5] | Loss=0.06418 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.078 | L2-Norm(final)=12.194 | 5290.4 samples/s | 82.7 steps/s
[Step=16350 Epoch=79.7] | Loss=0.06437 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.078 | L2-Norm(final)=12.190 | 5530.8 samples/s | 86.4 steps/s
[Step=16400 Epoch=80.0] | Loss=0.06330 | Reg=0.00146 | acc=0.9219 | L2-Norm=12.078 | L2-Norm(final)=12.188 | 7562.9 samples/s | 118.2 steps/s
[Step=16450 Epoch=80.2] | Loss=0.06295 | Reg=0.00146 | acc=0.9219 | L2-Norm=12.078 | L2-Norm(final)=12.187 | 1535.1 samples/s | 24.0 steps/s
[Step=16500 Epoch=80.5] | Loss=0.06308 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.078 | L2-Norm(final)=12.187 | 5403.9 samples/s | 84.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=80.5] | Loss=0.07005 | Reg=0.00146 | acc=0.9375 | L2-Norm=12.078 | L2-Norm(final)=12.187 | 3270.8 samples/s | 51.1 steps/s
[Step=16550 Epoch=80.7] | Loss=0.06206 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.180 | L2-Norm(final)=12.173 | 4149.3 samples/s | 64.8 steps/s
[Step=16600 Epoch=80.9] | Loss=0.06111 | Reg=0.00151 | acc=0.9375 | L2-Norm=12.296 | L2-Norm(final)=12.158 | 4660.4 samples/s | 72.8 steps/s
[Step=16650 Epoch=81.2] | Loss=0.05578 | Reg=0.00153 | acc=0.9531 | L2-Norm=12.373 | L2-Norm(final)=12.148 | 4650.6 samples/s | 72.7 steps/s
[Step=16700 Epoch=81.4] | Loss=0.05040 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.427 | L2-Norm(final)=12.141 | 6757.6 samples/s | 105.6 steps/s
[Step=16750 Epoch=81.7] | Loss=0.04428 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.472 | L2-Norm(final)=12.138 | 1400.7 samples/s | 21.9 steps/s
[Step=16800 Epoch=81.9] | Loss=0.04015 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.507 | L2-Norm(final)=12.138 | 4693.2 samples/s | 73.3 steps/s
[Step=16850 Epoch=82.2] | Loss=0.03822 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=12.137 | 4692.8 samples/s | 73.3 steps/s
[Step=16900 Epoch=82.4] | Loss=0.03549 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.565 | L2-Norm(final)=12.138 | 6135.2 samples/s | 95.9 steps/s
[Step=16950 Epoch=82.7] | Loss=0.03280 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.589 | L2-Norm(final)=12.140 | 1453.8 samples/s | 22.7 steps/s
[Step=17000 Epoch=82.9] | Loss=0.03103 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.610 | L2-Norm(final)=12.142 | 4576.1 samples/s | 71.5 steps/s
[Step=17050 Epoch=83.1] | Loss=0.02946 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.629 | L2-Norm(final)=12.143 | 4613.0 samples/s | 72.1 steps/s
[Step=17100 Epoch=83.4] | Loss=0.02795 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.647 | L2-Norm(final)=12.145 | 5479.2 samples/s | 85.6 steps/s
[Step=17150 Epoch=83.6] | Loss=0.02658 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.662 | L2-Norm(final)=12.147 | 1499.0 samples/s | 23.4 steps/s
[Step=17200 Epoch=83.9] | Loss=0.02522 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.676 | L2-Norm(final)=12.149 | 4713.8 samples/s | 73.7 steps/s
[Step=17250 Epoch=84.1] | Loss=0.02411 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.688 | L2-Norm(final)=12.151 | 4676.9 samples/s | 73.1 steps/s
[Step=17300 Epoch=84.4] | Loss=0.02321 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.700 | L2-Norm(final)=12.153 | 5198.7 samples/s | 81.2 steps/s
[Step=17350 Epoch=84.6] | Loss=0.02260 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.712 | L2-Norm(final)=12.155 | 1500.5 samples/s | 23.4 steps/s
[Step=17400 Epoch=84.8] | Loss=0.02190 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.723 | L2-Norm(final)=12.157 | 4705.2 samples/s | 73.5 steps/s
[Step=17450 Epoch=85.1] | Loss=0.02122 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.733 | L2-Norm(final)=12.159 | 4688.0 samples/s | 73.2 steps/s
[Step=17500 Epoch=85.3] | Loss=0.02059 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.743 | L2-Norm(final)=12.161 | 4824.0 samples/s | 75.4 steps/s
[Step=17550 Epoch=85.6] | Loss=0.01993 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.753 | L2-Norm(final)=12.163 | 1530.3 samples/s | 23.9 steps/s
[Step=17600 Epoch=85.8] | Loss=0.01927 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.762 | L2-Norm(final)=12.166 | 4693.4 samples/s | 73.3 steps/s
[Step=17650 Epoch=86.1] | Loss=0.01868 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.770 | L2-Norm(final)=12.168 | 4679.3 samples/s | 73.1 steps/s
[Step=17700 Epoch=86.3] | Loss=0.01813 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.778 | L2-Norm(final)=12.170 | 4705.2 samples/s | 73.5 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01770 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.785 | L2-Norm(final)=12.172 | 1555.7 samples/s | 24.3 steps/s
[Step=17800 Epoch=86.8] | Loss=0.01716 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.791 | L2-Norm(final)=12.174 | 4674.5 samples/s | 73.0 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01675 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.798 | L2-Norm(final)=12.177 | 4746.8 samples/s | 74.2 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01643 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.804 | L2-Norm(final)=12.179 | 4679.0 samples/s | 73.1 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01605 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.809 | L2-Norm(final)=12.181 | 1568.4 samples/s | 24.5 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01568 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.815 | L2-Norm(final)=12.183 | 4612.5 samples/s | 72.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step18000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=170.6] | Loss=0.00034 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.076 | L2-Norm(final)=15.267 | 3026.3 samples/s | 47.3 steps/s
[Step=18050 Epoch=171.0] | Loss=0.00201 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.071 | L2-Norm(final)=15.304 | 4767.0 samples/s | 74.5 steps/s
[Step=18100 Epoch=171.5] | Loss=0.00330 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.071 | L2-Norm(final)=15.332 | 8065.4 samples/s | 126.0 steps/s
[Step=18150 Epoch=172.0] | Loss=0.00315 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=15.360 | 1465.5 samples/s | 22.9 steps/s
[Step=18200 Epoch=172.5] | Loss=0.00318 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=15.386 | 7133.1 samples/s | 111.5 steps/s
[Step=18250 Epoch=172.9] | Loss=0.00323 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=15.415 | 1467.7 samples/s | 22.9 steps/s
[Step=18300 Epoch=173.4] | Loss=0.00316 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=15.443 | 6451.6 samples/s | 100.8 steps/s
[Step=18350 Epoch=173.9] | Loss=0.00319 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=15.469 | 1504.9 samples/s | 23.5 steps/s
[Step=18400 Epoch=174.4] | Loss=0.00315 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=15.494 | 5883.1 samples/s | 91.9 steps/s
[Step=18450 Epoch=174.8] | Loss=0.00307 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=15.519 | 1542.7 samples/s | 24.1 steps/s
[Step=18500 Epoch=175.3] | Loss=0.00305 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=15.544 | 5166.3 samples/s | 80.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=175.3] | Loss=0.00304 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=15.795 | 3151.2 samples/s | 49.2 steps/s
[Step=18550 Epoch=175.8] | Loss=0.00311 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.127 | L2-Norm(final)=15.810 | 4032.4 samples/s | 63.0 steps/s
[Step=18600 Epoch=176.3] | Loss=0.01065 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.254 | L2-Norm(final)=15.793 | 6440.8 samples/s | 100.6 steps/s
[Step=18650 Epoch=176.7] | Loss=0.00949 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.368 | L2-Norm(final)=15.760 | 1401.1 samples/s | 21.9 steps/s
[Step=18700 Epoch=177.2] | Loss=0.00720 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.434 | L2-Norm(final)=15.745 | 5822.8 samples/s | 91.0 steps/s
[Step=18750 Epoch=177.7] | Loss=0.00610 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.473 | L2-Norm(final)=15.738 | 1407.2 samples/s | 22.0 steps/s
[Step=18800 Epoch=178.1] | Loss=0.00511 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=15.733 | 5344.6 samples/s | 83.5 steps/s
[Step=18850 Epoch=178.6] | Loss=0.00439 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.512 | L2-Norm(final)=15.730 | 1455.5 samples/s | 22.7 steps/s
[Step=18900 Epoch=179.1] | Loss=0.00385 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=15.729 | 4860.9 samples/s | 76.0 steps/s
[Step=18950 Epoch=179.6] | Loss=0.00342 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=15.727 | 1479.4 samples/s | 23.1 steps/s
[Step=19000 Epoch=180.0] | Loss=0.00308 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.518 | L2-Norm(final)=15.727 | 4593.6 samples/s | 71.8 steps/s
[Step=19050 Epoch=180.5] | Loss=0.00280 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.514 | L2-Norm(final)=15.726 | 1544.6 samples/s | 24.1 steps/s
[Step=19100 Epoch=181.0] | Loss=0.00257 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.507 | L2-Norm(final)=15.726 | 4492.4 samples/s | 70.2 steps/s
[Step=19150 Epoch=181.5] | Loss=0.00237 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.500 | L2-Norm(final)=15.725 | 1553.4 samples/s | 24.3 steps/s
[Step=19200 Epoch=181.9] | Loss=0.00220 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=15.725 | 4494.6 samples/s | 70.2 steps/s
[Step=19250 Epoch=182.4] | Loss=0.00206 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=15.725 | 1513.6 samples/s | 23.7 steps/s
[Step=19300 Epoch=182.9] | Loss=0.00193 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.472 | L2-Norm(final)=15.725 | 4475.4 samples/s | 69.9 steps/s
[Step=19350 Epoch=183.4] | Loss=0.00182 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.462 | L2-Norm(final)=15.725 | 1566.4 samples/s | 24.5 steps/s
[Step=19400 Epoch=183.8] | Loss=0.00171 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.451 | L2-Norm(final)=15.725 | 4196.5 samples/s | 65.6 steps/s
[Step=19450 Epoch=184.3] | Loss=0.00162 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=15.725 | 6745.2 samples/s | 105.4 steps/s
[Step=19500 Epoch=184.8] | Loss=0.00154 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.429 | L2-Norm(final)=15.725 | 1380.1 samples/s | 21.6 steps/s
[Step=19550 Epoch=185.3] | Loss=0.00147 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.417 | L2-Norm(final)=15.725 | 6111.5 samples/s | 95.5 steps/s
[Step=19600 Epoch=185.7] | Loss=0.00140 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.405 | L2-Norm(final)=15.725 | 1384.8 samples/s | 21.6 steps/s
[Step=19650 Epoch=186.2] | Loss=0.00134 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.393 | L2-Norm(final)=15.725 | 5480.8 samples/s | 85.6 steps/s
[Step=19700 Epoch=186.7] | Loss=0.00129 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.381 | L2-Norm(final)=15.725 | 1417.0 samples/s | 22.1 steps/s
[Step=19750 Epoch=187.1] | Loss=0.00124 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=15.725 | 5028.5 samples/s | 78.6 steps/s
[Step=19800 Epoch=187.6] | Loss=0.00119 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.357 | L2-Norm(final)=15.726 | 1446.6 samples/s | 22.6 steps/s
[Step=19850 Epoch=188.1] | Loss=0.00114 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.345 | L2-Norm(final)=15.726 | 4582.9 samples/s | 71.6 steps/s
[Step=19900 Epoch=188.6] | Loss=0.00110 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=15.726 | 1502.2 samples/s | 23.5 steps/s
[Step=19950 Epoch=189.0] | Loss=0.00107 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.320 | L2-Norm(final)=15.726 | 4352.2 samples/s | 68.0 steps/s
[Step=20000 Epoch=189.5] | Loss=0.00103 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=15.726 | 1486.7 samples/s | 23.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step20000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=152.8] | Loss=0.00662 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.076 | L2-Norm(final)=13.603 | 3125.7 samples/s | 48.8 steps/s
[Step=16050 Epoch=153.3] | Loss=0.00249 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.071 | L2-Norm(final)=13.622 | 4360.0 samples/s | 68.1 steps/s
[Step=16100 Epoch=153.7] | Loss=0.00306 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=13.645 | 8237.4 samples/s | 128.7 steps/s
[Step=16150 Epoch=154.2] | Loss=0.00275 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=13.668 | 1398.3 samples/s | 21.8 steps/s
[Step=16200 Epoch=154.7] | Loss=0.00299 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.070 | L2-Norm(final)=13.692 | 7167.0 samples/s | 112.0 steps/s
[Step=16250 Epoch=155.2] | Loss=0.00291 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=13.714 | 1429.3 samples/s | 22.3 steps/s
[Step=16300 Epoch=155.7] | Loss=0.00282 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.070 | L2-Norm(final)=13.736 | 6666.9 samples/s | 104.2 steps/s
[Step=16350 Epoch=156.1] | Loss=0.00295 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=13.756 | 1452.5 samples/s | 22.7 steps/s
[Step=16400 Epoch=156.6] | Loss=0.00283 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=13.775 | 6181.9 samples/s | 96.6 steps/s
[Step=16450 Epoch=157.1] | Loss=0.00288 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=13.795 | 1494.7 samples/s | 23.4 steps/s
[Step=16500 Epoch=157.6] | Loss=0.00286 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=13.814 | 5646.3 samples/s | 88.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=157.6] | Loss=0.00239 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=14.007 | 3063.8 samples/s | 47.9 steps/s
[Step=16550 Epoch=158.0] | Loss=0.00516 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.206 | L2-Norm(final)=14.010 | 4070.4 samples/s | 63.6 steps/s
[Step=16600 Epoch=158.5] | Loss=0.00503 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.346 | L2-Norm(final)=13.994 | 6507.3 samples/s | 101.7 steps/s
[Step=16650 Epoch=159.0] | Loss=0.00337 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.406 | L2-Norm(final)=13.988 | 1343.7 samples/s | 21.0 steps/s
[Step=16700 Epoch=159.5] | Loss=0.00256 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=13.986 | 5943.7 samples/s | 92.9 steps/s
[Step=16750 Epoch=160.0] | Loss=0.00206 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=13.984 | 1355.8 samples/s | 21.2 steps/s
[Step=16800 Epoch=160.4] | Loss=0.00172 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=13.984 | 5521.2 samples/s | 86.3 steps/s
[Step=16850 Epoch=160.9] | Loss=0.00147 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=13.984 | 1374.4 samples/s | 21.5 steps/s
[Step=16900 Epoch=161.4] | Loss=0.00129 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.420 | L2-Norm(final)=13.984 | 5180.3 samples/s | 80.9 steps/s
[Step=16950 Epoch=161.9] | Loss=0.00115 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.408 | L2-Norm(final)=13.984 | 1467.9 samples/s | 22.9 steps/s
[Step=17000 Epoch=162.3] | Loss=0.00103 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=13.984 | 4827.5 samples/s | 75.4 steps/s
[Step=17050 Epoch=162.8] | Loss=0.00094 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.381 | L2-Norm(final)=13.984 | 1438.7 samples/s | 22.5 steps/s
[Step=17100 Epoch=163.3] | Loss=0.00086 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.366 | L2-Norm(final)=13.984 | 4533.3 samples/s | 70.8 steps/s
[Step=17150 Epoch=163.8] | Loss=0.00080 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.351 | L2-Norm(final)=13.984 | 1501.7 samples/s | 23.5 steps/s
[Step=17200 Epoch=164.2] | Loss=0.00074 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.335 | L2-Norm(final)=13.984 | 4372.4 samples/s | 68.3 steps/s
[Step=17250 Epoch=164.7] | Loss=0.00069 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.320 | L2-Norm(final)=13.984 | 1477.1 samples/s | 23.1 steps/s
[Step=17300 Epoch=165.2] | Loss=0.00065 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=13.984 | 4425.3 samples/s | 69.1 steps/s
[Step=17350 Epoch=165.7] | Loss=0.00061 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=13.985 | 1474.3 samples/s | 23.0 steps/s
[Step=17400 Epoch=166.2] | Loss=0.00057 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.272 | L2-Norm(final)=13.985 | 4342.3 samples/s | 67.8 steps/s
[Step=17450 Epoch=166.6] | Loss=0.00054 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=13.985 | 1512.3 samples/s | 23.6 steps/s
[Step=17500 Epoch=167.1] | Loss=0.00052 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=13.985 | 4364.8 samples/s | 68.2 steps/s
[Step=17550 Epoch=167.6] | Loss=0.00049 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.225 | L2-Norm(final)=13.985 | 7024.3 samples/s | 109.8 steps/s
[Step=17600 Epoch=168.1] | Loss=0.00047 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.209 | L2-Norm(final)=13.985 | 1312.8 samples/s | 20.5 steps/s
[Step=17650 Epoch=168.5] | Loss=0.00045 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.193 | L2-Norm(final)=13.985 | 6563.6 samples/s | 102.6 steps/s
[Step=17700 Epoch=169.0] | Loss=0.00043 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=13.986 | 1360.3 samples/s | 21.3 steps/s
[Step=17750 Epoch=169.5] | Loss=0.00041 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=13.986 | 5948.5 samples/s | 92.9 steps/s
[Step=17800 Epoch=170.0] | Loss=0.00040 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=13.986 | 1379.9 samples/s | 21.6 steps/s
[Step=17850 Epoch=170.5] | Loss=0.00038 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=13.986 | 5442.0 samples/s | 85.0 steps/s
[Step=17900 Epoch=170.9] | Loss=0.00037 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.114 | L2-Norm(final)=13.986 | 1383.5 samples/s | 21.6 steps/s
[Step=17950 Epoch=171.4] | Loss=0.00036 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.098 | L2-Norm(final)=13.986 | 5168.6 samples/s | 80.8 steps/s
[Step=18000 Epoch=171.9] | Loss=0.00035 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.083 | L2-Norm(final)=13.986 | 1450.5 samples/s | 22.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step18000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=94.2] | Loss=0.00105 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.076 | L2-Norm(final)=11.039 | 3051.6 samples/s | 47.7 steps/s
[Step=10050 Epoch=94.7] | Loss=0.00706 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.070 | L2-Norm(final)=11.060 | 4649.7 samples/s | 72.7 steps/s
[Step=10100 Epoch=95.2] | Loss=0.00800 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=11.094 | 7790.4 samples/s | 121.7 steps/s
[Step=10150 Epoch=95.6] | Loss=0.00804 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.069 | L2-Norm(final)=11.126 | 1428.3 samples/s | 22.3 steps/s
[Step=10200 Epoch=96.1] | Loss=0.00813 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.069 | L2-Norm(final)=11.166 | 6702.8 samples/s | 104.7 steps/s
[Step=10250 Epoch=96.6] | Loss=0.00797 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.069 | L2-Norm(final)=11.208 | 1448.6 samples/s | 22.6 steps/s
[Step=10300 Epoch=97.1] | Loss=0.00813 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.069 | L2-Norm(final)=11.249 | 6091.5 samples/s | 95.2 steps/s
[Step=10350 Epoch=97.5] | Loss=0.00800 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.069 | L2-Norm(final)=11.289 | 1532.9 samples/s | 24.0 steps/s
[Step=10400 Epoch=98.0] | Loss=0.00795 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.069 | L2-Norm(final)=11.328 | 5327.4 samples/s | 83.2 steps/s
[Step=10450 Epoch=98.5] | Loss=0.00765 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.069 | L2-Norm(final)=11.366 | 1543.8 samples/s | 24.1 steps/s
[Step=10500 Epoch=98.9] | Loss=0.00770 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.069 | L2-Norm(final)=11.405 | 5361.2 samples/s | 83.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=98.9] | Loss=0.00800 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.069 | L2-Norm(final)=11.787 | 3015.9 samples/s | 47.1 steps/s
[Step=10550 Epoch=99.4] | Loss=0.01211 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.249 | L2-Norm(final)=11.791 | 4117.7 samples/s | 64.3 steps/s
[Step=10600 Epoch=99.9] | Loss=0.00916 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=11.785 | 6330.2 samples/s | 98.9 steps/s
[Step=10650 Epoch=100.4] | Loss=0.00643 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.494 | L2-Norm(final)=11.783 | 1354.7 samples/s | 21.2 steps/s
[Step=10700 Epoch=100.8] | Loss=0.00489 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=11.784 | 5475.9 samples/s | 85.6 steps/s
[Step=10750 Epoch=101.3] | Loss=0.00392 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=11.787 | 1378.4 samples/s | 21.5 steps/s
[Step=10800 Epoch=101.8] | Loss=0.00328 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=11.789 | 5082.7 samples/s | 79.4 steps/s
[Step=10850 Epoch=102.2] | Loss=0.00281 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.532 | L2-Norm(final)=11.791 | 1419.0 samples/s | 22.2 steps/s
[Step=10900 Epoch=102.7] | Loss=0.00246 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=11.793 | 4672.1 samples/s | 73.0 steps/s
[Step=10950 Epoch=103.2] | Loss=0.00219 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=11.794 | 1461.1 samples/s | 22.8 steps/s
[Step=11000 Epoch=103.7] | Loss=0.00197 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.504 | L2-Norm(final)=11.795 | 4486.8 samples/s | 70.1 steps/s
[Step=11050 Epoch=104.1] | Loss=0.00179 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=11.796 | 1495.4 samples/s | 23.4 steps/s
[Step=11100 Epoch=104.6] | Loss=0.00164 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=11.798 | 4455.1 samples/s | 69.6 steps/s
[Step=11150 Epoch=105.1] | Loss=0.00152 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=11.799 | 1517.2 samples/s | 23.7 steps/s
[Step=11200 Epoch=105.5] | Loss=0.00141 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.450 | L2-Norm(final)=11.799 | 4291.4 samples/s | 67.1 steps/s
[Step=11250 Epoch=106.0] | Loss=0.00132 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.436 | L2-Norm(final)=11.800 | 1580.0 samples/s | 24.7 steps/s
[Step=11300 Epoch=106.5] | Loss=0.00123 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=11.801 | 3799.4 samples/s | 59.4 steps/s
[Step=11350 Epoch=106.9] | Loss=0.00116 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.406 | L2-Norm(final)=11.802 | 6459.2 samples/s | 100.9 steps/s
[Step=11400 Epoch=107.4] | Loss=0.00110 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.391 | L2-Norm(final)=11.803 | 1366.1 samples/s | 21.3 steps/s
[Step=11450 Epoch=107.9] | Loss=0.00104 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.376 | L2-Norm(final)=11.803 | 5751.4 samples/s | 89.9 steps/s
[Step=11500 Epoch=108.4] | Loss=0.00099 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.361 | L2-Norm(final)=11.804 | 1391.4 samples/s | 21.7 steps/s
[Step=11550 Epoch=108.8] | Loss=0.00094 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.346 | L2-Norm(final)=11.805 | 5155.9 samples/s | 80.6 steps/s
[Step=11600 Epoch=109.3] | Loss=0.00090 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.331 | L2-Norm(final)=11.805 | 1441.7 samples/s | 22.5 steps/s
[Step=11650 Epoch=109.8] | Loss=0.00086 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=11.806 | 4603.8 samples/s | 71.9 steps/s
[Step=11700 Epoch=110.2] | Loss=0.00082 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.300 | L2-Norm(final)=11.807 | 1480.9 samples/s | 23.1 steps/s
[Step=11750 Epoch=110.7] | Loss=0.00079 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=11.807 | 4340.8 samples/s | 67.8 steps/s
[Step=11800 Epoch=111.2] | Loss=0.00076 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.269 | L2-Norm(final)=11.808 | 1587.0 samples/s | 24.8 steps/s
[Step=11850 Epoch=111.7] | Loss=0.00073 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=11.808 | 4411.2 samples/s | 68.9 steps/s
[Step=11900 Epoch=112.1] | Loss=0.00071 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=11.809 | 1504.2 samples/s | 23.5 steps/s
[Step=11950 Epoch=112.6] | Loss=0.00068 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=11.810 | 4429.0 samples/s | 69.2 steps/s
[Step=12000 Epoch=113.1] | Loss=0.00066 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.207 | L2-Norm(final)=11.810 | 1614.6 samples/s | 25.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_3/client_state-step12000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=114.4] | Loss=0.01178 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.076 | L2-Norm(final)=14.882 | 3081.6 samples/s | 48.1 steps/s
[Step=12050 Epoch=114.8] | Loss=0.00921 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=14.842 | 4636.7 samples/s | 72.4 steps/s
[Step=12100 Epoch=115.3] | Loss=0.00931 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.072 | L2-Norm(final)=14.814 | 8034.6 samples/s | 125.5 steps/s
[Step=12150 Epoch=115.8] | Loss=0.00874 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.072 | L2-Norm(final)=14.798 | 1434.5 samples/s | 22.4 steps/s
[Step=12200 Epoch=116.3] | Loss=0.00849 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.072 | L2-Norm(final)=14.784 | 7395.0 samples/s | 115.5 steps/s
[Step=12250 Epoch=116.8] | Loss=0.00850 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.072 | L2-Norm(final)=14.773 | 1455.9 samples/s | 22.7 steps/s
[Step=12300 Epoch=117.2] | Loss=0.00817 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.072 | L2-Norm(final)=14.765 | 6656.1 samples/s | 104.0 steps/s
[Step=12350 Epoch=117.7] | Loss=0.00791 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.072 | L2-Norm(final)=14.760 | 1456.6 samples/s | 22.8 steps/s
[Step=12400 Epoch=118.2] | Loss=0.00799 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.072 | L2-Norm(final)=14.756 | 6186.9 samples/s | 96.7 steps/s
[Step=12450 Epoch=118.7] | Loss=0.00778 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.072 | L2-Norm(final)=14.756 | 1492.7 samples/s | 23.3 steps/s
[Step=12500 Epoch=119.1] | Loss=0.00783 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.072 | L2-Norm(final)=14.756 | 5651.4 samples/s | 88.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=119.1] | Loss=0.02338 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.072 | L2-Norm(final)=14.765 | 3000.9 samples/s | 46.9 steps/s
[Step=12550 Epoch=119.6] | Loss=0.00543 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=14.767 | 4183.4 samples/s | 65.4 steps/s
[Step=12600 Epoch=120.1] | Loss=0.00406 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.271 | L2-Norm(final)=14.768 | 6519.0 samples/s | 101.9 steps/s
[Step=12650 Epoch=120.6] | Loss=0.00275 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=14.770 | 1352.7 samples/s | 21.1 steps/s
[Step=12700 Epoch=121.0] | Loss=0.00207 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=14.771 | 5855.1 samples/s | 91.5 steps/s
[Step=12750 Epoch=121.5] | Loss=0.00166 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.295 | L2-Norm(final)=14.773 | 1374.3 samples/s | 21.5 steps/s
[Step=12800 Epoch=122.0] | Loss=0.00138 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=14.774 | 5499.3 samples/s | 85.9 steps/s
[Step=12850 Epoch=122.5] | Loss=0.00119 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.272 | L2-Norm(final)=14.775 | 1400.9 samples/s | 21.9 steps/s
[Step=12900 Epoch=122.9] | Loss=0.00104 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=14.775 | 5088.0 samples/s | 79.5 steps/s
[Step=12950 Epoch=123.4] | Loss=0.00092 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.243 | L2-Norm(final)=14.776 | 1409.3 samples/s | 22.0 steps/s
[Step=13000 Epoch=123.9] | Loss=0.00083 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=14.777 | 4799.9 samples/s | 75.0 steps/s
[Step=13050 Epoch=124.4] | Loss=0.00076 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=14.777 | 1465.1 samples/s | 22.9 steps/s
[Step=13100 Epoch=124.9] | Loss=0.00069 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.196 | L2-Norm(final)=14.778 | 4448.7 samples/s | 69.5 steps/s
[Step=13150 Epoch=125.3] | Loss=0.00064 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=14.778 | 1472.6 samples/s | 23.0 steps/s
[Step=13200 Epoch=125.8] | Loss=0.00060 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=14.779 | 4363.2 samples/s | 68.2 steps/s
[Step=13250 Epoch=126.3] | Loss=0.00056 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=14.779 | 1507.2 samples/s | 23.5 steps/s
[Step=13300 Epoch=126.8] | Loss=0.00052 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=14.779 | 4496.2 samples/s | 70.3 steps/s
[Step=13350 Epoch=127.2] | Loss=0.00049 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.116 | L2-Norm(final)=14.780 | 1498.0 samples/s | 23.4 steps/s
[Step=13400 Epoch=127.7] | Loss=0.00046 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=14.780 | 4396.7 samples/s | 68.7 steps/s
[Step=13450 Epoch=128.2] | Loss=0.00044 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.084 | L2-Norm(final)=14.780 | 1474.4 samples/s | 23.0 steps/s
[Step=13500 Epoch=128.7] | Loss=0.00042 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.068 | L2-Norm(final)=14.781 | 4396.7 samples/s | 68.7 steps/s
[Step=13550 Epoch=129.1] | Loss=0.00040 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.052 | L2-Norm(final)=14.781 | 7111.9 samples/s | 111.1 steps/s
[Step=13600 Epoch=129.6] | Loss=0.00038 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.036 | L2-Norm(final)=14.781 | 1329.9 samples/s | 20.8 steps/s
[Step=13650 Epoch=130.1] | Loss=0.00036 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.020 | L2-Norm(final)=14.782 | 6466.7 samples/s | 101.0 steps/s
[Step=13700 Epoch=130.6] | Loss=0.00035 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.004 | L2-Norm(final)=14.782 | 1354.5 samples/s | 21.2 steps/s
[Step=13750 Epoch=131.0] | Loss=0.00034 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.988 | L2-Norm(final)=14.782 | 5937.8 samples/s | 92.8 steps/s
[Step=13800 Epoch=131.5] | Loss=0.00032 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=14.782 | 1383.4 samples/s | 21.6 steps/s
[Step=13850 Epoch=132.0] | Loss=0.00031 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.957 | L2-Norm(final)=14.783 | 5550.3 samples/s | 86.7 steps/s
[Step=13900 Epoch=132.5] | Loss=0.00030 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.941 | L2-Norm(final)=14.783 | 1419.8 samples/s | 22.2 steps/s
[Step=13950 Epoch=133.0] | Loss=0.00029 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.925 | L2-Norm(final)=14.783 | 5122.2 samples/s | 80.0 steps/s
[Step=14000 Epoch=133.4] | Loss=0.00028 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.909 | L2-Norm(final)=14.783 | 1423.1 samples/s | 22.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4/client_state-step14000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11470 | acc=0.9503 | tpr=0.9647 | fpr=0.0810 | 4677.6 samples/s | 18.3 steps/s
Avg test loss: 0.11721, Avg test acc: 0.94919, Avg tpr: 0.96474, Avg fpr: 0.08499, total FA: 663

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.13479 | acc=0.9495 | tpr=0.9735 | fpr=0.1028 | 4728.3 samples/s | 18.5 steps/s
Avg test loss: 0.13693, Avg test acc: 0.94799, Avg tpr: 0.97371, Avg fpr: 0.10858, total FA: 847

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11812 | acc=0.9465 | tpr=0.9684 | fpr=0.1011 | 4436.7 samples/s | 17.3 steps/s
Avg test loss: 0.11926, Avg test acc: 0.94627, Avg tpr: 0.96818, Avg fpr: 0.10191, total FA: 795

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.11058 | acc=0.9521 | tpr=0.9709 | fpr=0.0887 | 4617.5 samples/s | 18.0 steps/s
Avg test loss: 0.11534, Avg test acc: 0.95048, Avg tpr: 0.97074, Avg fpr: 0.09409, total FA: 734

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11111 | acc=0.9511 | tpr=0.9671 | fpr=0.0837 | 4486.5 samples/s | 17.5 steps/s
Avg test loss: 0.11621, Avg test acc: 0.94899, Avg tpr: 0.96544, Avg fpr: 0.08717, total FA: 680

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.83591 | acc=0.3019 | tpr=0.0110 | fpr=0.0664 | 4735.3 samples/s | 18.5 steps/s
Avg test loss: 4.85344, Avg test acc: 0.29930, Avg tpr: 0.01061, Avg fpr: 0.06576, total FA: 513

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.39109 | acc=0.3063 | tpr=0.0055 | fpr=0.0404 | 4739.6 samples/s | 18.5 steps/s
Avg test loss: 4.41110, Avg test acc: 0.30355, Avg tpr: 0.00583, Avg fpr: 0.04166, total FA: 325

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.74940 | acc=0.3040 | tpr=0.0113 | fpr=0.0605 | 4603.9 samples/s | 18.0 steps/s
Avg test loss: 4.76594, Avg test acc: 0.30323, Avg tpr: 0.01049, Avg fpr: 0.05294, total FA: 413

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.11710 | acc=0.3128 | tpr=0.0245 | fpr=0.0612 | 4615.7 samples/s | 18.0 steps/s
Avg test loss: 4.13379, Avg test acc: 0.31164, Avg tpr: 0.02547, Avg fpr: 0.05897, total FA: 460

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.74808 | acc=0.3074 | tpr=0.0086 | fpr=0.0436 | 4625.7 samples/s | 18.1 steps/s
Avg test loss: 4.77092, Avg test acc: 0.30459, Avg tpr: 0.00886, Avg fpr: 0.04499, total FA: 351

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.33188 | acc=0.1429 | tpr=0.7832 | fpr=0.8686 | 4820.7 samples/s | 18.8 steps/s
[Step= 100] | Loss=6.31071 | acc=0.1449 | tpr=0.7591 | fpr=0.8665 | 7579.3 samples/s | 29.6 steps/s
[Step= 150] | Loss=6.32557 | acc=0.1467 | tpr=0.7637 | fpr=0.8647 | 7807.8 samples/s | 30.5 steps/s
[Step= 200] | Loss=6.31366 | acc=0.1468 | tpr=0.7694 | fpr=0.8646 | 7609.7 samples/s | 29.7 steps/s
[Step= 250] | Loss=6.30922 | acc=0.1473 | tpr=0.7703 | fpr=0.8640 | 8051.9 samples/s | 31.5 steps/s
[Step= 300] | Loss=6.30784 | acc=0.1480 | tpr=0.7760 | fpr=0.8634 | 7460.2 samples/s | 29.1 steps/s
[Step= 350] | Loss=6.31465 | acc=0.1479 | tpr=0.7852 | fpr=0.8637 | 8301.1 samples/s | 32.4 steps/s
[Step= 400] | Loss=6.31285 | acc=0.1475 | tpr=0.7828 | fpr=0.8641 | 7802.5 samples/s | 30.5 steps/s
[Step= 450] | Loss=6.30933 | acc=0.1473 | tpr=0.7853 | fpr=0.8643 | 8452.6 samples/s | 33.0 steps/s
[Step= 500] | Loss=6.31184 | acc=0.1472 | tpr=0.7824 | fpr=0.8642 | 7686.0 samples/s | 30.0 steps/s
[Step= 550] | Loss=6.30955 | acc=0.1475 | tpr=0.7875 | fpr=0.8641 | 11702.2 samples/s | 45.7 steps/s
Avg test loss: 6.31064, Avg test acc: 0.14743, Avg tpr: 0.78724, Avg fpr: 0.86420, total FA: 119992

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.83656 | acc=0.1270 | tpr=0.8142 | fpr=0.8854 | 4619.2 samples/s | 18.0 steps/s
[Step= 100] | Loss=6.82038 | acc=0.1271 | tpr=0.7804 | fpr=0.8851 | 8078.2 samples/s | 31.6 steps/s
[Step= 150] | Loss=6.82313 | acc=0.1279 | tpr=0.7896 | fpr=0.8843 | 8193.1 samples/s | 32.0 steps/s
[Step= 200] | Loss=6.81719 | acc=0.1279 | tpr=0.7880 | fpr=0.8841 | 8290.1 samples/s | 32.4 steps/s
[Step= 250] | Loss=6.81465 | acc=0.1289 | tpr=0.7904 | fpr=0.8831 | 7747.2 samples/s | 30.3 steps/s
[Step= 300] | Loss=6.81338 | acc=0.1293 | tpr=0.7956 | fpr=0.8828 | 7442.0 samples/s | 29.1 steps/s
[Step= 350] | Loss=6.82042 | acc=0.1288 | tpr=0.7927 | fpr=0.8832 | 7845.9 samples/s | 30.6 steps/s
[Step= 400] | Loss=6.82414 | acc=0.1289 | tpr=0.7899 | fpr=0.8831 | 8094.2 samples/s | 31.6 steps/s
[Step= 450] | Loss=6.82502 | acc=0.1289 | tpr=0.7877 | fpr=0.8831 | 8196.5 samples/s | 32.0 steps/s
[Step= 500] | Loss=6.82580 | acc=0.1289 | tpr=0.7828 | fpr=0.8829 | 7941.0 samples/s | 31.0 steps/s
[Step= 550] | Loss=6.82478 | acc=0.1292 | tpr=0.7875 | fpr=0.8828 | 10383.5 samples/s | 40.6 steps/s
Avg test loss: 6.82722, Avg test acc: 0.12906, Avg tpr: 0.78764, Avg fpr: 0.88292, total FA: 122591

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.97436 | acc=0.1412 | tpr=0.8186 | fpr=0.8709 | 4677.9 samples/s | 18.3 steps/s
[Step= 100] | Loss=5.95727 | acc=0.1423 | tpr=0.7719 | fpr=0.8695 | 8531.2 samples/s | 33.3 steps/s
[Step= 150] | Loss=5.96448 | acc=0.1430 | tpr=0.7839 | fpr=0.8688 | 7640.6 samples/s | 29.8 steps/s
[Step= 200] | Loss=5.94983 | acc=0.1435 | tpr=0.7825 | fpr=0.8681 | 7209.7 samples/s | 28.2 steps/s
[Step= 250] | Loss=5.94308 | acc=0.1442 | tpr=0.7782 | fpr=0.8674 | 8089.4 samples/s | 31.6 steps/s
[Step= 300] | Loss=5.93942 | acc=0.1440 | tpr=0.7782 | fpr=0.8675 | 7803.4 samples/s | 30.5 steps/s
[Step= 350] | Loss=5.94823 | acc=0.1432 | tpr=0.7771 | fpr=0.8683 | 7739.8 samples/s | 30.2 steps/s
[Step= 400] | Loss=5.95090 | acc=0.1430 | tpr=0.7790 | fpr=0.8685 | 8925.2 samples/s | 34.9 steps/s
[Step= 450] | Loss=5.95073 | acc=0.1429 | tpr=0.7804 | fpr=0.8687 | 8006.4 samples/s | 31.3 steps/s
[Step= 500] | Loss=5.95174 | acc=0.1430 | tpr=0.7793 | fpr=0.8685 | 8055.5 samples/s | 31.5 steps/s
[Step= 550] | Loss=5.95101 | acc=0.1431 | tpr=0.7803 | fpr=0.8685 | 10306.7 samples/s | 40.3 steps/s
Avg test loss: 5.95182, Avg test acc: 0.14293, Avg tpr: 0.78011, Avg fpr: 0.86865, total FA: 120610

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.55512 | acc=0.1270 | tpr=0.8451 | fpr=0.8859 | 4673.1 samples/s | 18.3 steps/s
[Step= 100] | Loss=6.53607 | acc=0.1293 | tpr=0.8571 | fpr=0.8842 | 8392.5 samples/s | 32.8 steps/s
[Step= 150] | Loss=6.54045 | acc=0.1299 | tpr=0.8631 | fpr=0.8836 | 7609.5 samples/s | 29.7 steps/s
[Step= 200] | Loss=6.52892 | acc=0.1300 | tpr=0.8721 | fpr=0.8835 | 7596.4 samples/s | 29.7 steps/s
[Step= 250] | Loss=6.52621 | acc=0.1303 | tpr=0.8716 | fpr=0.8833 | 7495.7 samples/s | 29.3 steps/s
[Step= 300] | Loss=6.52406 | acc=0.1302 | tpr=0.8691 | fpr=0.8833 | 8489.1 samples/s | 33.2 steps/s
[Step= 350] | Loss=6.53275 | acc=0.1296 | tpr=0.8698 | fpr=0.8839 | 8205.7 samples/s | 32.1 steps/s
[Step= 400] | Loss=6.53429 | acc=0.1296 | tpr=0.8638 | fpr=0.8838 | 8099.2 samples/s | 31.6 steps/s
[Step= 450] | Loss=6.53666 | acc=0.1292 | tpr=0.8627 | fpr=0.8841 | 8062.5 samples/s | 31.5 steps/s
[Step= 500] | Loss=6.53853 | acc=0.1293 | tpr=0.8573 | fpr=0.8838 | 8093.1 samples/s | 31.6 steps/s
[Step= 550] | Loss=6.53865 | acc=0.1294 | tpr=0.8611 | fpr=0.8839 | 10544.3 samples/s | 41.2 steps/s
Avg test loss: 6.53954, Avg test acc: 0.12930, Avg tpr: 0.86094, Avg fpr: 0.88400, total FA: 122741

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.31670 | acc=0.1378 | tpr=0.7522 | fpr=0.8732 | 4776.9 samples/s | 18.7 steps/s
[Step= 100] | Loss=6.29761 | acc=0.1387 | tpr=0.7143 | fpr=0.8721 | 7726.3 samples/s | 30.2 steps/s
[Step= 150] | Loss=6.30412 | acc=0.1401 | tpr=0.7147 | fpr=0.8705 | 7408.2 samples/s | 28.9 steps/s
[Step= 200] | Loss=6.29852 | acc=0.1396 | tpr=0.7060 | fpr=0.8707 | 7798.0 samples/s | 30.5 steps/s
[Step= 250] | Loss=6.29183 | acc=0.1407 | tpr=0.7074 | fpr=0.8696 | 8161.8 samples/s | 31.9 steps/s
[Step= 300] | Loss=6.29169 | acc=0.1405 | tpr=0.7156 | fpr=0.8700 | 8540.5 samples/s | 33.4 steps/s
[Step= 350] | Loss=6.29861 | acc=0.1403 | tpr=0.7201 | fpr=0.8702 | 7880.7 samples/s | 30.8 steps/s
[Step= 400] | Loss=6.29929 | acc=0.1401 | tpr=0.7144 | fpr=0.8704 | 8379.4 samples/s | 32.7 steps/s
[Step= 450] | Loss=6.29849 | acc=0.1399 | tpr=0.7142 | fpr=0.8705 | 7885.6 samples/s | 30.8 steps/s
[Step= 500] | Loss=6.30330 | acc=0.1398 | tpr=0.7110 | fpr=0.8705 | 7231.5 samples/s | 28.2 steps/s
[Step= 550] | Loss=6.30182 | acc=0.1400 | tpr=0.7115 | fpr=0.8704 | 12169.3 samples/s | 47.5 steps/s
Avg test loss: 6.30254, Avg test acc: 0.13988, Avg tpr: 0.71157, Avg fpr: 0.87051, total FA: 120869

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19357 | acc=0.9535 | tpr=0.9248 | fpr=0.0460 | 4724.3 samples/s | 18.5 steps/s
[Step= 100] | Loss=0.19857 | acc=0.9530 | tpr=0.9403 | fpr=0.0467 | 7859.9 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.20310 | acc=0.9519 | tpr=0.9438 | fpr=0.0480 | 7653.3 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.20306 | acc=0.9520 | tpr=0.9508 | fpr=0.0480 | 8603.7 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.20465 | acc=0.9520 | tpr=0.9485 | fpr=0.0480 | 8023.6 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.20640 | acc=0.9513 | tpr=0.9455 | fpr=0.0486 | 7673.4 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.20670 | acc=0.9514 | tpr=0.9449 | fpr=0.0485 | 8154.6 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.20802 | acc=0.9511 | tpr=0.9409 | fpr=0.0488 | 8117.4 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.20901 | acc=0.9507 | tpr=0.9382 | fpr=0.0490 | 8090.3 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.20859 | acc=0.9507 | tpr=0.9396 | fpr=0.0491 | 7560.8 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.20768 | acc=0.9509 | tpr=0.9399 | fpr=0.0489 | 10535.3 samples/s | 41.2 steps/s
Avg test loss: 0.20748, Avg test acc: 0.95090, Avg tpr: 0.94017, Avg fpr: 0.04891, total FA: 6791

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12613 | acc=0.9681 | tpr=0.9115 | fpr=0.0309 | 4718.4 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.13386 | acc=0.9671 | tpr=0.9190 | fpr=0.0320 | 8177.1 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.13552 | acc=0.9666 | tpr=0.9193 | fpr=0.0325 | 7066.0 samples/s | 27.6 steps/s
[Step= 200] | Loss=0.13595 | acc=0.9668 | tpr=0.9235 | fpr=0.0324 | 8194.1 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.13665 | acc=0.9666 | tpr=0.9205 | fpr=0.0326 | 7969.2 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.13731 | acc=0.9662 | tpr=0.9193 | fpr=0.0329 | 8048.0 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.13703 | acc=0.9663 | tpr=0.9186 | fpr=0.0329 | 7564.9 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.13871 | acc=0.9658 | tpr=0.9136 | fpr=0.0332 | 7796.9 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.13924 | acc=0.9657 | tpr=0.9114 | fpr=0.0333 | 8092.0 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.13904 | acc=0.9656 | tpr=0.9132 | fpr=0.0334 | 7961.7 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.13881 | acc=0.9656 | tpr=0.9113 | fpr=0.0334 | 11642.2 samples/s | 45.5 steps/s
Avg test loss: 0.13856, Avg test acc: 0.96559, Avg tpr: 0.91165, Avg fpr: 0.03343, total FA: 4642

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26264 | acc=0.9498 | tpr=0.9292 | fpr=0.0499 | 4675.1 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.26991 | acc=0.9489 | tpr=0.9318 | fpr=0.0508 | 8002.0 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.27483 | acc=0.9478 | tpr=0.9323 | fpr=0.0519 | 7663.9 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.27735 | acc=0.9479 | tpr=0.9377 | fpr=0.0519 | 8435.7 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.27961 | acc=0.9475 | tpr=0.9371 | fpr=0.0524 | 8080.3 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.28172 | acc=0.9469 | tpr=0.9360 | fpr=0.0529 | 7789.6 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.28264 | acc=0.9468 | tpr=0.9368 | fpr=0.0531 | 7679.7 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.28490 | acc=0.9463 | tpr=0.9338 | fpr=0.0534 | 8467.3 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.28586 | acc=0.9460 | tpr=0.9343 | fpr=0.0538 | 7890.6 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.28546 | acc=0.9457 | tpr=0.9348 | fpr=0.0541 | 8004.8 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.28482 | acc=0.9458 | tpr=0.9351 | fpr=0.0540 | 9789.2 samples/s | 38.2 steps/s
Avg test loss: 0.28451, Avg test acc: 0.94582, Avg tpr: 0.93502, Avg fpr: 0.05399, total FA: 7496

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11950 | acc=0.9677 | tpr=0.9071 | fpr=0.0312 | 4869.0 samples/s | 19.0 steps/s
[Step= 100] | Loss=0.12217 | acc=0.9665 | tpr=0.9104 | fpr=0.0325 | 7666.6 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.12661 | acc=0.9655 | tpr=0.9179 | fpr=0.0336 | 8033.7 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.12593 | acc=0.9659 | tpr=0.9279 | fpr=0.0334 | 7677.3 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.12754 | acc=0.9656 | tpr=0.9249 | fpr=0.0336 | 7965.3 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.12882 | acc=0.9654 | tpr=0.9244 | fpr=0.0339 | 7737.8 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.12991 | acc=0.9652 | tpr=0.9261 | fpr=0.0340 | 8610.0 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.13072 | acc=0.9650 | tpr=0.9223 | fpr=0.0342 | 8108.9 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.13201 | acc=0.9648 | tpr=0.9202 | fpr=0.0344 | 7683.7 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.13162 | acc=0.9649 | tpr=0.9238 | fpr=0.0344 | 7956.2 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.13104 | acc=0.9650 | tpr=0.9228 | fpr=0.0342 | 9690.3 samples/s | 37.9 steps/s
Avg test loss: 0.13082, Avg test acc: 0.96506, Avg tpr: 0.92274, Avg fpr: 0.03417, total FA: 4744

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.26734 | acc=0.9513 | tpr=0.9115 | fpr=0.0480 | 4537.7 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.27393 | acc=0.9501 | tpr=0.9126 | fpr=0.0492 | 8201.0 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.27810 | acc=0.9493 | tpr=0.9179 | fpr=0.0502 | 7574.3 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.27934 | acc=0.9495 | tpr=0.9235 | fpr=0.0500 | 8231.5 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.28322 | acc=0.9486 | tpr=0.9223 | fpr=0.0509 | 7964.3 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.28535 | acc=0.9481 | tpr=0.9236 | fpr=0.0514 | 7897.2 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.28594 | acc=0.9484 | tpr=0.9242 | fpr=0.0512 | 8031.0 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.28698 | acc=0.9481 | tpr=0.9218 | fpr=0.0514 | 8096.1 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.28914 | acc=0.9477 | tpr=0.9192 | fpr=0.0518 | 7667.6 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.28970 | acc=0.9476 | tpr=0.9198 | fpr=0.0519 | 8396.0 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.28917 | acc=0.9474 | tpr=0.9164 | fpr=0.0521 | 10667.1 samples/s | 41.7 steps/s
Avg test loss: 0.28877, Avg test acc: 0.94742, Avg tpr: 0.91601, Avg fpr: 0.05201, total FA: 7221

server round 14/50

clients selected: [0 2 4 6 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=87.8] | Loss=0.03966 | Reg=0.00143 | acc=0.9531 | L2-Norm=11.979 | L2-Norm(final)=12.246 | 3352.6 samples/s | 52.4 steps/s
[Step=18050 Epoch=88.0] | Loss=0.05091 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.979 | L2-Norm(final)=12.229 | 4521.4 samples/s | 70.6 steps/s
[Step=18100 Epoch=88.3] | Loss=0.04971 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.979 | L2-Norm(final)=12.223 | 5517.0 samples/s | 86.2 steps/s
[Step=18150 Epoch=88.5] | Loss=0.05031 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.979 | L2-Norm(final)=12.214 | 5458.5 samples/s | 85.3 steps/s
[Step=18200 Epoch=88.7] | Loss=0.04909 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.979 | L2-Norm(final)=12.213 | 8610.1 samples/s | 134.5 steps/s
[Step=18250 Epoch=89.0] | Loss=0.04839 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.979 | L2-Norm(final)=12.212 | 1465.7 samples/s | 22.9 steps/s
[Step=18300 Epoch=89.2] | Loss=0.04832 | Reg=0.00143 | acc=0.9375 | L2-Norm=11.979 | L2-Norm(final)=12.212 | 5568.8 samples/s | 87.0 steps/s
[Step=18350 Epoch=89.5] | Loss=0.04803 | Reg=0.00143 | acc=0.9219 | L2-Norm=11.979 | L2-Norm(final)=12.214 | 5353.9 samples/s | 83.7 steps/s
[Step=18400 Epoch=89.7] | Loss=0.04852 | Reg=0.00143 | acc=0.9375 | L2-Norm=11.979 | L2-Norm(final)=12.216 | 7597.0 samples/s | 118.7 steps/s
[Step=18450 Epoch=90.0] | Loss=0.04807 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.979 | L2-Norm(final)=12.216 | 1502.6 samples/s | 23.5 steps/s
[Step=18500 Epoch=90.2] | Loss=0.04850 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.979 | L2-Norm(final)=12.218 | 5471.0 samples/s | 85.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=90.2] | Loss=0.05343 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.979 | L2-Norm(final)=12.222 | 3158.8 samples/s | 49.4 steps/s
[Step=18550 Epoch=90.5] | Loss=0.04780 | Reg=0.00146 | acc=0.9375 | L2-Norm=12.074 | L2-Norm(final)=12.208 | 4530.5 samples/s | 70.8 steps/s
[Step=18600 Epoch=90.7] | Loss=0.04881 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.166 | L2-Norm(final)=12.192 | 4734.9 samples/s | 74.0 steps/s
[Step=18650 Epoch=90.9] | Loss=0.04844 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.238 | L2-Norm(final)=12.182 | 4690.7 samples/s | 73.3 steps/s
[Step=18700 Epoch=91.2] | Loss=0.04617 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=12.175 | 6788.1 samples/s | 106.1 steps/s
[Step=18750 Epoch=91.4] | Loss=0.04090 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.348 | L2-Norm(final)=12.172 | 1429.8 samples/s | 22.3 steps/s
[Step=18800 Epoch=91.7] | Loss=0.03666 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.388 | L2-Norm(final)=12.174 | 4765.9 samples/s | 74.5 steps/s
[Step=18850 Epoch=91.9] | Loss=0.03415 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=12.175 | 4612.7 samples/s | 72.1 steps/s
[Step=18900 Epoch=92.2] | Loss=0.03256 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.450 | L2-Norm(final)=12.176 | 6122.3 samples/s | 95.7 steps/s
[Step=18950 Epoch=92.4] | Loss=0.03008 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.475 | L2-Norm(final)=12.177 | 1468.0 samples/s | 22.9 steps/s
[Step=19000 Epoch=92.6] | Loss=0.02834 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=12.180 | 4709.3 samples/s | 73.6 steps/s
[Step=19050 Epoch=92.9] | Loss=0.02675 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=12.181 | 4748.8 samples/s | 74.2 steps/s
[Step=19100 Epoch=93.1] | Loss=0.02546 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.532 | L2-Norm(final)=12.183 | 5537.1 samples/s | 86.5 steps/s
[Step=19150 Epoch=93.4] | Loss=0.02466 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.549 | L2-Norm(final)=12.185 | 1471.0 samples/s | 23.0 steps/s
[Step=19200 Epoch=93.6] | Loss=0.02379 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.566 | L2-Norm(final)=12.187 | 4723.1 samples/s | 73.8 steps/s
[Step=19250 Epoch=93.9] | Loss=0.02372 | Reg=0.00158 | acc=0.9688 | L2-Norm=12.583 | L2-Norm(final)=12.188 | 4712.7 samples/s | 73.6 steps/s
[Step=19300 Epoch=94.1] | Loss=0.02294 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.600 | L2-Norm(final)=12.189 | 5174.4 samples/s | 80.9 steps/s
[Step=19350 Epoch=94.4] | Loss=0.02231 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=12.190 | 1514.8 samples/s | 23.7 steps/s
[Step=19400 Epoch=94.6] | Loss=0.02146 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.633 | L2-Norm(final)=12.191 | 4734.6 samples/s | 74.0 steps/s
[Step=19450 Epoch=94.8] | Loss=0.02104 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.649 | L2-Norm(final)=12.193 | 4670.0 samples/s | 73.0 steps/s
[Step=19500 Epoch=95.1] | Loss=0.02049 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.665 | L2-Norm(final)=12.194 | 4812.7 samples/s | 75.2 steps/s
[Step=19550 Epoch=95.3] | Loss=0.02020 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.679 | L2-Norm(final)=12.194 | 1561.9 samples/s | 24.4 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01974 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.693 | L2-Norm(final)=12.195 | 4738.7 samples/s | 74.0 steps/s
[Step=19650 Epoch=95.8] | Loss=0.01927 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.705 | L2-Norm(final)=12.195 | 4663.4 samples/s | 72.9 steps/s
[Step=19700 Epoch=96.1] | Loss=0.01871 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.718 | L2-Norm(final)=12.196 | 4686.1 samples/s | 73.2 steps/s
[Step=19750 Epoch=96.3] | Loss=0.01821 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.729 | L2-Norm(final)=12.197 | 1600.3 samples/s | 25.0 steps/s
[Step=19800 Epoch=96.5] | Loss=0.01770 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.740 | L2-Norm(final)=12.199 | 4666.8 samples/s | 72.9 steps/s
[Step=19850 Epoch=96.8] | Loss=0.01719 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.750 | L2-Norm(final)=12.200 | 4739.2 samples/s | 74.1 steps/s
[Step=19900 Epoch=97.0] | Loss=0.01693 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.760 | L2-Norm(final)=12.202 | 4649.7 samples/s | 72.7 steps/s
[Step=19950 Epoch=97.3] | Loss=0.01651 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.769 | L2-Norm(final)=12.203 | 1541.9 samples/s | 24.1 steps/s
[Step=20000 Epoch=97.5] | Loss=0.01605 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.778 | L2-Norm(final)=12.204 | 4646.7 samples/s | 72.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step20000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=6001 Epoch=29.2] | Loss=0.08097 | Reg=0.00143 | acc=0.9062 | L2-Norm=11.979 | L2-Norm(final)=8.637 | 3220.5 samples/s | 50.3 steps/s
[Step=6050 Epoch=29.5] | Loss=0.05361 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.980 | L2-Norm(final)=8.655 | 4778.7 samples/s | 74.7 steps/s
[Step=6100 Epoch=29.7] | Loss=0.05432 | Reg=0.00144 | acc=0.9531 | L2-Norm=11.980 | L2-Norm(final)=8.675 | 5462.6 samples/s | 85.4 steps/s
[Step=6150 Epoch=30.0] | Loss=0.05662 | Reg=0.00144 | acc=0.9531 | L2-Norm=11.980 | L2-Norm(final)=8.691 | 5500.5 samples/s | 85.9 steps/s
[Step=6200 Epoch=30.2] | Loss=0.05550 | Reg=0.00144 | acc=0.9688 | L2-Norm=11.980 | L2-Norm(final)=8.708 | 8520.2 samples/s | 133.1 steps/s
[Step=6250 Epoch=30.5] | Loss=0.05701 | Reg=0.00144 | acc=0.9688 | L2-Norm=11.980 | L2-Norm(final)=8.726 | 1465.8 samples/s | 22.9 steps/s
[Step=6300 Epoch=30.7] | Loss=0.05727 | Reg=0.00144 | acc=0.9531 | L2-Norm=11.980 | L2-Norm(final)=8.741 | 5437.5 samples/s | 85.0 steps/s
[Step=6350 Epoch=30.9] | Loss=0.05638 | Reg=0.00144 | acc=0.9375 | L2-Norm=11.980 | L2-Norm(final)=8.759 | 5516.7 samples/s | 86.2 steps/s
[Step=6400 Epoch=31.2] | Loss=0.05568 | Reg=0.00144 | acc=0.9688 | L2-Norm=11.980 | L2-Norm(final)=8.778 | 7511.3 samples/s | 117.4 steps/s
[Step=6450 Epoch=31.4] | Loss=0.05599 | Reg=0.00144 | acc=0.9375 | L2-Norm=11.980 | L2-Norm(final)=8.798 | 1547.5 samples/s | 24.2 steps/s
[Step=6500 Epoch=31.7] | Loss=0.05590 | Reg=0.00144 | acc=0.9531 | L2-Norm=11.980 | L2-Norm(final)=8.818 | 5416.1 samples/s | 84.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=6501 Epoch=31.7] | Loss=0.03708 | Reg=0.00144 | acc=0.9688 | L2-Norm=11.980 | L2-Norm(final)=9.015 | 3358.8 samples/s | 52.5 steps/s
[Step=6550 Epoch=31.9] | Loss=0.05710 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.075 | L2-Norm(final)=9.023 | 4152.4 samples/s | 64.9 steps/s
[Step=6600 Epoch=32.2] | Loss=0.05520 | Reg=0.00148 | acc=0.9531 | L2-Norm=12.177 | L2-Norm(final)=9.013 | 4600.8 samples/s | 71.9 steps/s
[Step=6650 Epoch=32.4] | Loss=0.05291 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.253 | L2-Norm(final)=9.008 | 4801.0 samples/s | 75.0 steps/s
[Step=6700 Epoch=32.6] | Loss=0.04736 | Reg=0.00152 | acc=0.9531 | L2-Norm=12.312 | L2-Norm(final)=9.006 | 6530.2 samples/s | 102.0 steps/s
[Step=6750 Epoch=32.9] | Loss=0.04226 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.363 | L2-Norm(final)=9.008 | 1391.2 samples/s | 21.7 steps/s
[Step=6800 Epoch=33.1] | Loss=0.03871 | Reg=0.00154 | acc=0.9375 | L2-Norm=12.406 | L2-Norm(final)=9.012 | 4695.3 samples/s | 73.4 steps/s
[Step=6850 Epoch=33.4] | Loss=0.03641 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.445 | L2-Norm(final)=9.016 | 4706.9 samples/s | 73.5 steps/s
[Step=6900 Epoch=33.6] | Loss=0.03423 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.481 | L2-Norm(final)=9.020 | 6129.7 samples/s | 95.8 steps/s
[Step=6950 Epoch=33.9] | Loss=0.03220 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.513 | L2-Norm(final)=9.023 | 1442.2 samples/s | 22.5 steps/s
[Step=7000 Epoch=34.1] | Loss=0.03050 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.542 | L2-Norm(final)=9.027 | 4706.9 samples/s | 73.5 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02918 | Reg=0.00158 | acc=0.9688 | L2-Norm=12.568 | L2-Norm(final)=9.031 | 4758.1 samples/s | 74.3 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02792 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.593 | L2-Norm(final)=9.035 | 5556.8 samples/s | 86.8 steps/s
[Step=7150 Epoch=34.8] | Loss=0.02687 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.616 | L2-Norm(final)=9.039 | 1474.5 samples/s | 23.0 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02540 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.636 | L2-Norm(final)=9.043 | 4631.5 samples/s | 72.4 steps/s
[Step=7250 Epoch=35.3] | Loss=0.02417 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.655 | L2-Norm(final)=9.047 | 4713.3 samples/s | 73.6 steps/s
[Step=7300 Epoch=35.6] | Loss=0.02340 | Reg=0.00161 | acc=0.9531 | L2-Norm=12.673 | L2-Norm(final)=9.051 | 5187.0 samples/s | 81.0 steps/s
[Step=7350 Epoch=35.8] | Loss=0.02249 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.689 | L2-Norm(final)=9.055 | 1498.8 samples/s | 23.4 steps/s
[Step=7400 Epoch=36.1] | Loss=0.02158 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.705 | L2-Norm(final)=9.059 | 4715.3 samples/s | 73.7 steps/s
[Step=7450 Epoch=36.3] | Loss=0.02075 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.719 | L2-Norm(final)=9.063 | 4698.9 samples/s | 73.4 steps/s
[Step=7500 Epoch=36.5] | Loss=0.02009 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.732 | L2-Norm(final)=9.066 | 4799.5 samples/s | 75.0 steps/s
[Step=7550 Epoch=36.8] | Loss=0.01942 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.744 | L2-Norm(final)=9.070 | 1544.0 samples/s | 24.1 steps/s
[Step=7600 Epoch=37.0] | Loss=0.01877 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.756 | L2-Norm(final)=9.074 | 4704.0 samples/s | 73.5 steps/s
[Step=7650 Epoch=37.3] | Loss=0.01829 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.767 | L2-Norm(final)=9.077 | 4657.0 samples/s | 72.8 steps/s
[Step=7700 Epoch=37.5] | Loss=0.01785 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.777 | L2-Norm(final)=9.081 | 4751.3 samples/s | 74.2 steps/s
[Step=7750 Epoch=37.8] | Loss=0.01742 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.787 | L2-Norm(final)=9.084 | 1558.2 samples/s | 24.3 steps/s
[Step=7800 Epoch=38.0] | Loss=0.01696 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=9.087 | 4647.2 samples/s | 72.6 steps/s
[Step=7850 Epoch=38.2] | Loss=0.01654 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.804 | L2-Norm(final)=9.090 | 4681.1 samples/s | 73.1 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01618 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.812 | L2-Norm(final)=9.093 | 4692.1 samples/s | 73.3 steps/s
[Step=7950 Epoch=38.7] | Loss=0.01576 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.820 | L2-Norm(final)=9.096 | 1547.5 samples/s | 24.2 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01539 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.827 | L2-Norm(final)=9.099 | 4689.8 samples/s | 73.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_2/client_state-step8000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=4001 Epoch=19.6] | Loss=0.04573 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.979 | L2-Norm(final)=7.963 | 3108.5 samples/s | 48.6 steps/s
[Step=4050 Epoch=19.9] | Loss=0.05555 | Reg=0.00144 | acc=0.9688 | L2-Norm=11.979 | L2-Norm(final)=7.969 | 5030.4 samples/s | 78.6 steps/s
[Step=4100 Epoch=20.1] | Loss=0.05703 | Reg=0.00144 | acc=0.9375 | L2-Norm=11.979 | L2-Norm(final)=7.987 | 5474.8 samples/s | 85.5 steps/s
[Step=4150 Epoch=20.4] | Loss=0.05584 | Reg=0.00144 | acc=0.9531 | L2-Norm=11.979 | L2-Norm(final)=8.010 | 5580.9 samples/s | 87.2 steps/s
[Step=4200 Epoch=20.6] | Loss=0.05721 | Reg=0.00144 | acc=0.9531 | L2-Norm=11.979 | L2-Norm(final)=8.033 | 8569.1 samples/s | 133.9 steps/s
[Step=4250 Epoch=20.8] | Loss=0.05629 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.979 | L2-Norm(final)=8.053 | 1497.1 samples/s | 23.4 steps/s
[Step=4300 Epoch=21.1] | Loss=0.05662 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.979 | L2-Norm(final)=8.075 | 5390.5 samples/s | 84.2 steps/s
[Step=4350 Epoch=21.3] | Loss=0.05627 | Reg=0.00144 | acc=0.9375 | L2-Norm=11.979 | L2-Norm(final)=8.099 | 5473.9 samples/s | 85.5 steps/s
[Step=4400 Epoch=21.6] | Loss=0.05583 | Reg=0.00144 | acc=0.9688 | L2-Norm=11.979 | L2-Norm(final)=8.123 | 8129.4 samples/s | 127.0 steps/s
[Step=4450 Epoch=21.8] | Loss=0.05571 | Reg=0.00144 | acc=0.9531 | L2-Norm=11.979 | L2-Norm(final)=8.148 | 1501.1 samples/s | 23.5 steps/s
[Step=4500 Epoch=22.1] | Loss=0.05570 | Reg=0.00144 | acc=0.9688 | L2-Norm=11.979 | L2-Norm(final)=8.172 | 5557.4 samples/s | 86.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=4501 Epoch=22.1] | Loss=0.08794 | Reg=0.00144 | acc=0.9531 | L2-Norm=11.979 | L2-Norm(final)=8.406 | 3232.2 samples/s | 50.5 steps/s
[Step=4550 Epoch=22.3] | Loss=0.05543 | Reg=0.00145 | acc=0.9531 | L2-Norm=12.052 | L2-Norm(final)=8.410 | 4123.7 samples/s | 64.4 steps/s
[Step=4600 Epoch=22.6] | Loss=0.05491 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=8.401 | 4768.9 samples/s | 74.5 steps/s
[Step=4650 Epoch=22.8] | Loss=0.05158 | Reg=0.00149 | acc=0.9531 | L2-Norm=12.211 | L2-Norm(final)=8.401 | 4677.5 samples/s | 73.1 steps/s
[Step=4700 Epoch=23.0] | Loss=0.04752 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.271 | L2-Norm(final)=8.402 | 6827.3 samples/s | 106.7 steps/s
[Step=4750 Epoch=23.3] | Loss=0.04220 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.324 | L2-Norm(final)=8.405 | 1408.5 samples/s | 22.0 steps/s
[Step=4800 Epoch=23.5] | Loss=0.03856 | Reg=0.00153 | acc=0.9531 | L2-Norm=12.371 | L2-Norm(final)=8.410 | 4608.8 samples/s | 72.0 steps/s
[Step=4850 Epoch=23.8] | Loss=0.03569 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.412 | L2-Norm(final)=8.415 | 4716.7 samples/s | 73.7 steps/s
[Step=4900 Epoch=24.0] | Loss=0.03339 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.447 | L2-Norm(final)=8.421 | 6458.6 samples/s | 100.9 steps/s
[Step=4950 Epoch=24.3] | Loss=0.03111 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=8.426 | 1452.2 samples/s | 22.7 steps/s
[Step=5000 Epoch=24.5] | Loss=0.02921 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.508 | L2-Norm(final)=8.432 | 4641.2 samples/s | 72.5 steps/s
[Step=5050 Epoch=24.8] | Loss=0.02793 | Reg=0.00157 | acc=0.9531 | L2-Norm=12.535 | L2-Norm(final)=8.437 | 4686.3 samples/s | 73.2 steps/s
[Step=5100 Epoch=25.0] | Loss=0.02686 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.559 | L2-Norm(final)=8.442 | 6060.4 samples/s | 94.7 steps/s
[Step=5150 Epoch=25.3] | Loss=0.02573 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.583 | L2-Norm(final)=8.447 | 1442.5 samples/s | 22.5 steps/s
[Step=5200 Epoch=25.5] | Loss=0.02444 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.605 | L2-Norm(final)=8.452 | 4640.1 samples/s | 72.5 steps/s
[Step=5250 Epoch=25.7] | Loss=0.02354 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.626 | L2-Norm(final)=8.457 | 4686.1 samples/s | 73.2 steps/s
[Step=5300 Epoch=26.0] | Loss=0.02289 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.646 | L2-Norm(final)=8.461 | 5702.7 samples/s | 89.1 steps/s
[Step=5350 Epoch=26.2] | Loss=0.02192 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.666 | L2-Norm(final)=8.466 | 1451.9 samples/s | 22.7 steps/s
[Step=5400 Epoch=26.5] | Loss=0.02118 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.684 | L2-Norm(final)=8.471 | 4605.0 samples/s | 72.0 steps/s
[Step=5450 Epoch=26.7] | Loss=0.02052 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.701 | L2-Norm(final)=8.474 | 4713.3 samples/s | 73.6 steps/s
[Step=5500 Epoch=27.0] | Loss=0.02003 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=8.478 | 5424.9 samples/s | 84.8 steps/s
[Step=5550 Epoch=27.2] | Loss=0.01944 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.732 | L2-Norm(final)=8.482 | 1477.9 samples/s | 23.1 steps/s
[Step=5600 Epoch=27.5] | Loss=0.01880 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.746 | L2-Norm(final)=8.487 | 4725.1 samples/s | 73.8 steps/s
[Step=5650 Epoch=27.7] | Loss=0.01827 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.760 | L2-Norm(final)=8.491 | 4759.0 samples/s | 74.4 steps/s
[Step=5700 Epoch=28.0] | Loss=0.01767 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=8.496 | 5072.9 samples/s | 79.3 steps/s
[Step=5750 Epoch=28.2] | Loss=0.01723 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=8.500 | 1514.8 samples/s | 23.7 steps/s
[Step=5800 Epoch=28.4] | Loss=0.01680 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.798 | L2-Norm(final)=8.504 | 4706.3 samples/s | 73.5 steps/s
[Step=5850 Epoch=28.7] | Loss=0.01642 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.810 | L2-Norm(final)=8.509 | 4650.9 samples/s | 72.7 steps/s
[Step=5900 Epoch=28.9] | Loss=0.01602 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.820 | L2-Norm(final)=8.512 | 4925.3 samples/s | 77.0 steps/s
[Step=5950 Epoch=29.2] | Loss=0.01566 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.831 | L2-Norm(final)=8.516 | 1517.3 samples/s | 23.7 steps/s
[Step=6000 Epoch=29.4] | Loss=0.01527 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.841 | L2-Norm(final)=8.520 | 4680.2 samples/s | 73.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_4/client_state-step6000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=114.2] | Loss=0.00062 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.979 | L2-Norm(final)=10.275 | 3158.8 samples/s | 49.4 steps/s
[Step=12050 Epoch=114.6] | Loss=0.00516 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=10.305 | 4449.6 samples/s | 69.5 steps/s
[Step=12100 Epoch=115.1] | Loss=0.00612 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.972 | L2-Norm(final)=10.338 | 8291.5 samples/s | 129.6 steps/s
[Step=12150 Epoch=115.6] | Loss=0.00644 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=10.362 | 1440.4 samples/s | 22.5 steps/s
[Step=12200 Epoch=116.1] | Loss=0.00613 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=10.384 | 7216.8 samples/s | 112.8 steps/s
[Step=12250 Epoch=116.5] | Loss=0.00573 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=10.408 | 1500.5 samples/s | 23.4 steps/s
[Step=12300 Epoch=117.0] | Loss=0.00585 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=10.428 | 6185.1 samples/s | 96.6 steps/s
[Step=12350 Epoch=117.5] | Loss=0.00573 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=10.448 | 1516.2 samples/s | 23.7 steps/s
[Step=12400 Epoch=118.0] | Loss=0.00575 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.971 | L2-Norm(final)=10.467 | 5947.1 samples/s | 92.9 steps/s
[Step=12450 Epoch=118.4] | Loss=0.00580 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.971 | L2-Norm(final)=10.486 | 1551.1 samples/s | 24.2 steps/s
[Step=12500 Epoch=118.9] | Loss=0.00557 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.971 | L2-Norm(final)=10.504 | 5380.4 samples/s | 84.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=118.9] | Loss=0.03656 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.971 | L2-Norm(final)=10.691 | 3088.1 samples/s | 48.3 steps/s
[Step=12550 Epoch=119.4] | Loss=0.00784 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=10.701 | 4101.1 samples/s | 64.1 steps/s
[Step=12600 Epoch=119.9] | Loss=0.00512 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=10.689 | 6573.8 samples/s | 102.7 steps/s
[Step=12650 Epoch=120.3] | Loss=0.00349 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.337 | L2-Norm(final)=10.686 | 1381.2 samples/s | 21.6 steps/s
[Step=12700 Epoch=120.8] | Loss=0.00263 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.352 | L2-Norm(final)=10.688 | 5859.9 samples/s | 91.6 steps/s
[Step=12750 Epoch=121.3] | Loss=0.00211 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.350 | L2-Norm(final)=10.689 | 1403.8 samples/s | 21.9 steps/s
[Step=12800 Epoch=121.8] | Loss=0.00176 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.340 | L2-Norm(final)=10.690 | 5453.3 samples/s | 85.2 steps/s
[Step=12850 Epoch=122.2] | Loss=0.00151 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=10.692 | 1443.4 samples/s | 22.6 steps/s
[Step=12900 Epoch=122.7] | Loss=0.00132 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=10.693 | 4875.7 samples/s | 76.2 steps/s
[Step=12950 Epoch=123.2] | Loss=0.00117 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=10.694 | 1513.7 samples/s | 23.7 steps/s
[Step=13000 Epoch=123.7] | Loss=0.00106 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.272 | L2-Norm(final)=10.695 | 4534.1 samples/s | 70.8 steps/s
[Step=13050 Epoch=124.1] | Loss=0.00096 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=10.696 | 1520.7 samples/s | 23.8 steps/s
[Step=13100 Epoch=124.6] | Loss=0.00088 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=10.696 | 4429.3 samples/s | 69.2 steps/s
[Step=13150 Epoch=125.1] | Loss=0.00082 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=10.697 | 1543.7 samples/s | 24.1 steps/s
[Step=13200 Epoch=125.6] | Loss=0.00076 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.193 | L2-Norm(final)=10.698 | 4352.3 samples/s | 68.0 steps/s
[Step=13250 Epoch=126.0] | Loss=0.00071 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=10.699 | 1509.5 samples/s | 23.6 steps/s
[Step=13300 Epoch=126.5] | Loss=0.00066 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=10.700 | 4452.4 samples/s | 69.6 steps/s
[Step=13350 Epoch=127.0] | Loss=0.00062 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=10.700 | 1557.9 samples/s | 24.3 steps/s
[Step=13400 Epoch=127.5] | Loss=0.00059 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.113 | L2-Norm(final)=10.701 | 4316.0 samples/s | 67.4 steps/s
[Step=13450 Epoch=127.9] | Loss=0.00056 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.093 | L2-Norm(final)=10.702 | 6713.2 samples/s | 104.9 steps/s
[Step=13500 Epoch=128.4] | Loss=0.00053 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=10.702 | 1379.1 samples/s | 21.5 steps/s
[Step=13550 Epoch=128.9] | Loss=0.00051 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.053 | L2-Norm(final)=10.703 | 6093.7 samples/s | 95.2 steps/s
[Step=13600 Epoch=129.4] | Loss=0.00048 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.034 | L2-Norm(final)=10.704 | 1402.6 samples/s | 21.9 steps/s
[Step=13650 Epoch=129.8] | Loss=0.00046 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.014 | L2-Norm(final)=10.704 | 5517.3 samples/s | 86.2 steps/s
[Step=13700 Epoch=130.3] | Loss=0.00044 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.994 | L2-Norm(final)=10.705 | 1464.6 samples/s | 22.9 steps/s
[Step=13750 Epoch=130.8] | Loss=0.00043 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.975 | L2-Norm(final)=10.706 | 5019.3 samples/s | 78.4 steps/s
[Step=13800 Epoch=131.3] | Loss=0.00041 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.956 | L2-Norm(final)=10.706 | 1486.2 samples/s | 23.2 steps/s
[Step=13850 Epoch=131.7] | Loss=0.00039 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.936 | L2-Norm(final)=10.707 | 4763.8 samples/s | 74.4 steps/s
[Step=13900 Epoch=132.2] | Loss=0.00038 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.917 | L2-Norm(final)=10.708 | 1484.5 samples/s | 23.2 steps/s
[Step=13950 Epoch=132.7] | Loss=0.00037 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=10.708 | 4511.4 samples/s | 70.5 steps/s
[Step=14000 Epoch=133.2] | Loss=0.00036 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.878 | L2-Norm(final)=10.709 | 1550.6 samples/s | 24.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step14000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=133.4] | Loss=0.00816 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.979 | L2-Norm(final)=14.792 | 3129.6 samples/s | 48.9 steps/s
[Step=14050 Epoch=133.9] | Loss=0.00557 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.974 | L2-Norm(final)=14.829 | 4622.7 samples/s | 72.2 steps/s
[Step=14100 Epoch=134.4] | Loss=0.00591 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=14.878 | 8020.1 samples/s | 125.3 steps/s
[Step=14150 Epoch=134.9] | Loss=0.00543 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.973 | L2-Norm(final)=14.919 | 1414.8 samples/s | 22.1 steps/s
[Step=14200 Epoch=135.3] | Loss=0.00590 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=14.955 | 7511.6 samples/s | 117.4 steps/s
[Step=14250 Epoch=135.8] | Loss=0.00589 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=14.989 | 1479.4 samples/s | 23.1 steps/s
[Step=14300 Epoch=136.3] | Loss=0.00569 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.972 | L2-Norm(final)=15.020 | 6751.8 samples/s | 105.5 steps/s
[Step=14350 Epoch=136.8] | Loss=0.00581 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=15.049 | 1535.6 samples/s | 24.0 steps/s
[Step=14400 Epoch=137.2] | Loss=0.00565 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=15.077 | 6054.7 samples/s | 94.6 steps/s
[Step=14450 Epoch=137.7] | Loss=0.00572 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=15.105 | 1549.6 samples/s | 24.2 steps/s
[Step=14500 Epoch=138.2] | Loss=0.00569 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=15.131 | 5712.4 samples/s | 89.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=138.2] | Loss=0.00714 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.972 | L2-Norm(final)=15.399 | 3048.7 samples/s | 47.6 steps/s
[Step=14550 Epoch=138.7] | Loss=0.01228 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.235 | L2-Norm(final)=15.390 | 4130.5 samples/s | 64.5 steps/s
[Step=14600 Epoch=139.2] | Loss=0.00873 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.403 | L2-Norm(final)=15.380 | 6526.7 samples/s | 102.0 steps/s
[Step=14650 Epoch=139.6] | Loss=0.00624 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=15.374 | 1369.6 samples/s | 21.4 steps/s
[Step=14700 Epoch=140.1] | Loss=0.00489 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.511 | L2-Norm(final)=15.372 | 6007.7 samples/s | 93.9 steps/s
[Step=14750 Epoch=140.6] | Loss=0.00393 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=15.371 | 1401.0 samples/s | 21.9 steps/s
[Step=14800 Epoch=141.1] | Loss=0.00328 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.527 | L2-Norm(final)=15.371 | 5525.1 samples/s | 86.3 steps/s
[Step=14850 Epoch=141.5] | Loss=0.00281 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=15.371 | 1456.9 samples/s | 22.8 steps/s
[Step=14900 Epoch=142.0] | Loss=0.00246 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.517 | L2-Norm(final)=15.371 | 5116.9 samples/s | 80.0 steps/s
[Step=14950 Epoch=142.5] | Loss=0.00219 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.509 | L2-Norm(final)=15.371 | 1462.4 samples/s | 22.9 steps/s
[Step=15000 Epoch=143.0] | Loss=0.00197 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=15.371 | 4879.7 samples/s | 76.2 steps/s
[Step=15050 Epoch=143.4] | Loss=0.00179 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=15.371 | 1490.3 samples/s | 23.3 steps/s
[Step=15100 Epoch=143.9] | Loss=0.00164 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=15.371 | 4556.5 samples/s | 71.2 steps/s
[Step=15150 Epoch=144.4] | Loss=0.00152 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.463 | L2-Norm(final)=15.371 | 1550.0 samples/s | 24.2 steps/s
[Step=15200 Epoch=144.9] | Loss=0.00141 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.450 | L2-Norm(final)=15.371 | 4554.8 samples/s | 71.2 steps/s
[Step=15250 Epoch=145.3] | Loss=0.00131 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=15.372 | 1504.9 samples/s | 23.5 steps/s
[Step=15300 Epoch=145.8] | Loss=0.00123 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.424 | L2-Norm(final)=15.372 | 4501.0 samples/s | 70.3 steps/s
[Step=15350 Epoch=146.3] | Loss=0.00116 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.411 | L2-Norm(final)=15.372 | 1544.7 samples/s | 24.1 steps/s
[Step=15400 Epoch=146.8] | Loss=0.00110 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.397 | L2-Norm(final)=15.372 | 4458.2 samples/s | 69.7 steps/s
[Step=15450 Epoch=147.3] | Loss=0.00104 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.384 | L2-Norm(final)=15.372 | 1596.3 samples/s | 24.9 steps/s
[Step=15500 Epoch=147.7] | Loss=0.00099 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.370 | L2-Norm(final)=15.373 | 4047.8 samples/s | 63.2 steps/s
[Step=15550 Epoch=148.2] | Loss=0.00094 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.356 | L2-Norm(final)=15.373 | 7200.4 samples/s | 112.5 steps/s
[Step=15600 Epoch=148.7] | Loss=0.00090 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.343 | L2-Norm(final)=15.373 | 1364.5 samples/s | 21.3 steps/s
[Step=15650 Epoch=149.2] | Loss=0.00086 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.329 | L2-Norm(final)=15.373 | 6455.7 samples/s | 100.9 steps/s
[Step=15700 Epoch=149.6] | Loss=0.00082 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=15.374 | 1358.4 samples/s | 21.2 steps/s
[Step=15750 Epoch=150.1] | Loss=0.00079 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=15.374 | 6074.2 samples/s | 94.9 steps/s
[Step=15800 Epoch=150.6] | Loss=0.00076 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=15.374 | 1395.2 samples/s | 21.8 steps/s
[Step=15850 Epoch=151.1] | Loss=0.00073 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.273 | L2-Norm(final)=15.374 | 5580.7 samples/s | 87.2 steps/s
[Step=15900 Epoch=151.5] | Loss=0.00071 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=15.374 | 1462.4 samples/s | 22.9 steps/s
[Step=15950 Epoch=152.0] | Loss=0.00068 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.246 | L2-Norm(final)=15.375 | 5156.7 samples/s | 80.6 steps/s
[Step=16000 Epoch=152.5] | Loss=0.00066 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=15.375 | 1477.8 samples/s | 23.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11998 | acc=0.9485 | tpr=0.9574 | fpr=0.0709 | 4756.3 samples/s | 18.6 steps/s
Avg test loss: 0.12570, Avg test acc: 0.94623, Avg tpr: 0.95547, Avg fpr: 0.07409, total FA: 578

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.13479 | acc=0.9495 | tpr=0.9735 | fpr=0.1028 | 4646.0 samples/s | 18.1 steps/s
Avg test loss: 0.13693, Avg test acc: 0.94799, Avg tpr: 0.97371, Avg fpr: 0.10858, total FA: 847

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11908 | acc=0.9527 | tpr=0.9719 | fpr=0.0892 | 4822.1 samples/s | 18.8 steps/s
Avg test loss: 0.12056, Avg test acc: 0.95268, Avg tpr: 0.97086, Avg fpr: 0.08730, total FA: 681

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.11058 | acc=0.9521 | tpr=0.9709 | fpr=0.0887 | 4792.5 samples/s | 18.7 steps/s
Avg test loss: 0.11534, Avg test acc: 0.95048, Avg tpr: 0.97074, Avg fpr: 0.09409, total FA: 734

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11188 | acc=0.9540 | tpr=0.9740 | fpr=0.0894 | 4505.6 samples/s | 17.6 steps/s
Avg test loss: 0.11842, Avg test acc: 0.95244, Avg tpr: 0.97255, Avg fpr: 0.09178, total FA: 716

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.83591 | acc=0.3019 | tpr=0.0110 | fpr=0.0664 | 4642.1 samples/s | 18.1 steps/s
Avg test loss: 4.85344, Avg test acc: 0.29930, Avg tpr: 0.01061, Avg fpr: 0.06576, total FA: 513

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.14769 | acc=0.3072 | tpr=0.0127 | fpr=0.0533 | 4511.3 samples/s | 17.6 steps/s
Avg test loss: 4.16151, Avg test acc: 0.30547, Avg tpr: 0.01253, Avg fpr: 0.05025, total FA: 392

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.74940 | acc=0.3040 | tpr=0.0113 | fpr=0.0605 | 4735.5 samples/s | 18.5 steps/s
Avg test loss: 4.76594, Avg test acc: 0.30323, Avg tpr: 0.01049, Avg fpr: 0.05294, total FA: 413

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.11710 | acc=0.3128 | tpr=0.0245 | fpr=0.0612 | 4794.7 samples/s | 18.7 steps/s
Avg test loss: 4.13379, Avg test acc: 0.31164, Avg tpr: 0.02547, Avg fpr: 0.05897, total FA: 460

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.12451 | acc=0.3127 | tpr=0.0131 | fpr=0.0369 | 4656.1 samples/s | 18.2 steps/s
Avg test loss: 5.14391, Avg test acc: 0.31016, Avg tpr: 0.01411, Avg fpr: 0.03871, total FA: 302

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.66870 | acc=0.1478 | tpr=0.8274 | fpr=0.8644 | 4845.0 samples/s | 18.9 steps/s
[Step= 100] | Loss=5.65692 | acc=0.1496 | tpr=0.7783 | fpr=0.8621 | 7796.8 samples/s | 30.5 steps/s
[Step= 150] | Loss=5.67547 | acc=0.1502 | tpr=0.7824 | fpr=0.8614 | 7174.5 samples/s | 28.0 steps/s
[Step= 200] | Loss=5.66141 | acc=0.1506 | tpr=0.7869 | fpr=0.8610 | 8021.7 samples/s | 31.3 steps/s
[Step= 250] | Loss=5.66077 | acc=0.1515 | tpr=0.7860 | fpr=0.8600 | 7564.0 samples/s | 29.5 steps/s
[Step= 300] | Loss=5.65615 | acc=0.1519 | tpr=0.7876 | fpr=0.8597 | 8200.3 samples/s | 32.0 steps/s
[Step= 350] | Loss=5.66462 | acc=0.1511 | tpr=0.7871 | fpr=0.8604 | 8113.3 samples/s | 31.7 steps/s
[Step= 400] | Loss=5.66594 | acc=0.1510 | tpr=0.7812 | fpr=0.8604 | 7950.2 samples/s | 31.1 steps/s
[Step= 450] | Loss=5.66403 | acc=0.1509 | tpr=0.7804 | fpr=0.8606 | 8141.6 samples/s | 31.8 steps/s
[Step= 500] | Loss=5.66454 | acc=0.1510 | tpr=0.7767 | fpr=0.8603 | 8138.2 samples/s | 31.8 steps/s
[Step= 550] | Loss=5.66316 | acc=0.1513 | tpr=0.7807 | fpr=0.8601 | 10769.5 samples/s | 42.1 steps/s
Avg test loss: 5.66324, Avg test acc: 0.15126, Avg tpr: 0.78051, Avg fpr: 0.86018, total FA: 119434

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.83656 | acc=0.1270 | tpr=0.8142 | fpr=0.8854 | 4663.4 samples/s | 18.2 steps/s
[Step= 100] | Loss=6.82038 | acc=0.1271 | tpr=0.7804 | fpr=0.8851 | 8164.6 samples/s | 31.9 steps/s
[Step= 150] | Loss=6.82313 | acc=0.1279 | tpr=0.7896 | fpr=0.8843 | 7713.6 samples/s | 30.1 steps/s
[Step= 200] | Loss=6.81719 | acc=0.1279 | tpr=0.7880 | fpr=0.8841 | 8201.8 samples/s | 32.0 steps/s
[Step= 250] | Loss=6.81465 | acc=0.1289 | tpr=0.7904 | fpr=0.8831 | 8070.9 samples/s | 31.5 steps/s
[Step= 300] | Loss=6.81338 | acc=0.1293 | tpr=0.7956 | fpr=0.8828 | 7715.3 samples/s | 30.1 steps/s
[Step= 350] | Loss=6.82042 | acc=0.1288 | tpr=0.7927 | fpr=0.8832 | 8405.7 samples/s | 32.8 steps/s
[Step= 400] | Loss=6.82414 | acc=0.1289 | tpr=0.7899 | fpr=0.8831 | 8051.0 samples/s | 31.4 steps/s
[Step= 450] | Loss=6.82502 | acc=0.1289 | tpr=0.7877 | fpr=0.8831 | 8074.5 samples/s | 31.5 steps/s
[Step= 500] | Loss=6.82580 | acc=0.1289 | tpr=0.7828 | fpr=0.8829 | 7893.0 samples/s | 30.8 steps/s
[Step= 550] | Loss=6.82478 | acc=0.1292 | tpr=0.7875 | fpr=0.8828 | 9414.9 samples/s | 36.8 steps/s
Avg test loss: 6.82722, Avg test acc: 0.12906, Avg tpr: 0.78764, Avg fpr: 0.88292, total FA: 122591

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=7.00720 | acc=0.1305 | tpr=0.7876 | fpr=0.8813 | 4702.6 samples/s | 18.4 steps/s
[Step= 100] | Loss=6.97178 | acc=0.1327 | tpr=0.7548 | fpr=0.8789 | 7417.7 samples/s | 29.0 steps/s
[Step= 150] | Loss=6.98533 | acc=0.1328 | tpr=0.7550 | fpr=0.8787 | 8075.9 samples/s | 31.5 steps/s
[Step= 200] | Loss=6.97181 | acc=0.1328 | tpr=0.7628 | fpr=0.8787 | 7279.8 samples/s | 28.4 steps/s
[Step= 250] | Loss=6.96396 | acc=0.1327 | tpr=0.7590 | fpr=0.8787 | 7832.3 samples/s | 30.6 steps/s
[Step= 300] | Loss=6.95635 | acc=0.1329 | tpr=0.7644 | fpr=0.8786 | 8120.4 samples/s | 31.7 steps/s
[Step= 350] | Loss=6.96743 | acc=0.1323 | tpr=0.7683 | fpr=0.8792 | 8052.7 samples/s | 31.5 steps/s
[Step= 400] | Loss=6.96743 | acc=0.1321 | tpr=0.7653 | fpr=0.8794 | 7667.3 samples/s | 30.0 steps/s
[Step= 450] | Loss=6.96673 | acc=0.1321 | tpr=0.7610 | fpr=0.8793 | 8463.5 samples/s | 33.1 steps/s
[Step= 500] | Loss=6.96872 | acc=0.1320 | tpr=0.7586 | fpr=0.8793 | 8088.0 samples/s | 31.6 steps/s
[Step= 550] | Loss=6.96828 | acc=0.1321 | tpr=0.7604 | fpr=0.8793 | 11602.0 samples/s | 45.3 steps/s
Avg test loss: 6.96953, Avg test acc: 0.13203, Avg tpr: 0.75951, Avg fpr: 0.87937, total FA: 122099

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.55512 | acc=0.1270 | tpr=0.8451 | fpr=0.8859 | 4710.6 samples/s | 18.4 steps/s
[Step= 100] | Loss=6.53607 | acc=0.1293 | tpr=0.8571 | fpr=0.8842 | 7342.6 samples/s | 28.7 steps/s
[Step= 150] | Loss=6.54045 | acc=0.1299 | tpr=0.8631 | fpr=0.8836 | 7707.5 samples/s | 30.1 steps/s
[Step= 200] | Loss=6.52892 | acc=0.1300 | tpr=0.8721 | fpr=0.8835 | 7899.1 samples/s | 30.9 steps/s
[Step= 250] | Loss=6.52621 | acc=0.1303 | tpr=0.8716 | fpr=0.8833 | 8117.4 samples/s | 31.7 steps/s
[Step= 300] | Loss=6.52406 | acc=0.1302 | tpr=0.8691 | fpr=0.8833 | 7823.2 samples/s | 30.6 steps/s
[Step= 350] | Loss=6.53275 | acc=0.1296 | tpr=0.8698 | fpr=0.8839 | 8097.5 samples/s | 31.6 steps/s
[Step= 400] | Loss=6.53429 | acc=0.1296 | tpr=0.8638 | fpr=0.8838 | 7799.2 samples/s | 30.5 steps/s
[Step= 450] | Loss=6.53666 | acc=0.1292 | tpr=0.8627 | fpr=0.8841 | 8062.3 samples/s | 31.5 steps/s
[Step= 500] | Loss=6.53853 | acc=0.1293 | tpr=0.8573 | fpr=0.8838 | 7346.9 samples/s | 28.7 steps/s
[Step= 550] | Loss=6.53865 | acc=0.1294 | tpr=0.8611 | fpr=0.8839 | 13250.3 samples/s | 51.8 steps/s
Avg test loss: 6.53954, Avg test acc: 0.12930, Avg tpr: 0.86094, Avg fpr: 0.88400, total FA: 122741

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.85046 | acc=0.1372 | tpr=0.8142 | fpr=0.8750 | 4689.2 samples/s | 18.3 steps/s
[Step= 100] | Loss=5.83305 | acc=0.1380 | tpr=0.7996 | fpr=0.8743 | 8175.7 samples/s | 31.9 steps/s
[Step= 150] | Loss=5.83760 | acc=0.1401 | tpr=0.7853 | fpr=0.8717 | 7682.7 samples/s | 30.0 steps/s
[Step= 200] | Loss=5.82984 | acc=0.1399 | tpr=0.7880 | fpr=0.8719 | 7547.4 samples/s | 29.5 steps/s
[Step= 250] | Loss=5.82654 | acc=0.1405 | tpr=0.7834 | fpr=0.8712 | 8337.0 samples/s | 32.6 steps/s
[Step= 300] | Loss=5.82453 | acc=0.1407 | tpr=0.7855 | fpr=0.8711 | 8577.8 samples/s | 33.5 steps/s
[Step= 350] | Loss=5.83268 | acc=0.1403 | tpr=0.7840 | fpr=0.8713 | 7820.8 samples/s | 30.5 steps/s
[Step= 400] | Loss=5.83458 | acc=0.1397 | tpr=0.7812 | fpr=0.8720 | 8386.4 samples/s | 32.8 steps/s
[Step= 450] | Loss=5.83240 | acc=0.1394 | tpr=0.7795 | fpr=0.8722 | 8100.9 samples/s | 31.6 steps/s
[Step= 500] | Loss=5.83695 | acc=0.1392 | tpr=0.7736 | fpr=0.8722 | 7747.5 samples/s | 30.3 steps/s
[Step= 550] | Loss=5.83739 | acc=0.1393 | tpr=0.7712 | fpr=0.8722 | 9659.8 samples/s | 37.7 steps/s
Avg test loss: 5.83782, Avg test acc: 0.13918, Avg tpr: 0.77021, Avg fpr: 0.87229, total FA: 121116

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19357 | acc=0.9535 | tpr=0.9248 | fpr=0.0460 | 4727.2 samples/s | 18.5 steps/s
[Step= 100] | Loss=0.19857 | acc=0.9530 | tpr=0.9403 | fpr=0.0467 | 7564.5 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.20310 | acc=0.9519 | tpr=0.9438 | fpr=0.0480 | 7792.3 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.20306 | acc=0.9520 | tpr=0.9508 | fpr=0.0480 | 8343.4 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.20465 | acc=0.9520 | tpr=0.9485 | fpr=0.0480 | 7624.6 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.20640 | acc=0.9513 | tpr=0.9455 | fpr=0.0486 | 8517.5 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.20670 | acc=0.9514 | tpr=0.9449 | fpr=0.0485 | 7690.8 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.20802 | acc=0.9511 | tpr=0.9409 | fpr=0.0488 | 8489.9 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.20901 | acc=0.9507 | tpr=0.9382 | fpr=0.0490 | 7803.9 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.20859 | acc=0.9507 | tpr=0.9396 | fpr=0.0491 | 7962.0 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.20768 | acc=0.9509 | tpr=0.9399 | fpr=0.0489 | 9374.8 samples/s | 36.6 steps/s
Avg test loss: 0.20748, Avg test acc: 0.95090, Avg tpr: 0.94017, Avg fpr: 0.04891, total FA: 6791

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12031 | acc=0.9652 | tpr=0.9292 | fpr=0.0341 | 4630.3 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.12378 | acc=0.9649 | tpr=0.9360 | fpr=0.0346 | 7405.0 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.12477 | acc=0.9642 | tpr=0.9337 | fpr=0.0352 | 7845.6 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.12616 | acc=0.9640 | tpr=0.9344 | fpr=0.0355 | 7997.2 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.12769 | acc=0.9637 | tpr=0.9328 | fpr=0.0357 | 8158.0 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.12811 | acc=0.9635 | tpr=0.9331 | fpr=0.0360 | 7987.2 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.12795 | acc=0.9637 | tpr=0.9324 | fpr=0.0358 | 8210.1 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.12893 | acc=0.9632 | tpr=0.9261 | fpr=0.0361 | 8067.1 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.12965 | acc=0.9630 | tpr=0.9236 | fpr=0.0363 | 8198.9 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.12936 | acc=0.9631 | tpr=0.9256 | fpr=0.0362 | 7305.2 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.12926 | acc=0.9631 | tpr=0.9212 | fpr=0.0361 | 10668.7 samples/s | 41.7 steps/s
Avg test loss: 0.12893, Avg test acc: 0.96311, Avg tpr: 0.92155, Avg fpr: 0.03613, total FA: 5017

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26264 | acc=0.9498 | tpr=0.9292 | fpr=0.0499 | 4509.8 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.26991 | acc=0.9489 | tpr=0.9318 | fpr=0.0508 | 7827.1 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.27483 | acc=0.9478 | tpr=0.9323 | fpr=0.0519 | 7808.3 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.27735 | acc=0.9479 | tpr=0.9377 | fpr=0.0519 | 7988.8 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.27961 | acc=0.9475 | tpr=0.9371 | fpr=0.0524 | 8002.0 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.28172 | acc=0.9469 | tpr=0.9360 | fpr=0.0529 | 8220.8 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.28264 | acc=0.9468 | tpr=0.9368 | fpr=0.0531 | 7888.6 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.28490 | acc=0.9463 | tpr=0.9338 | fpr=0.0534 | 8081.0 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.28586 | acc=0.9460 | tpr=0.9343 | fpr=0.0538 | 6974.4 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.28546 | acc=0.9457 | tpr=0.9348 | fpr=0.0541 | 8028.1 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.28482 | acc=0.9458 | tpr=0.9351 | fpr=0.0540 | 11781.4 samples/s | 46.0 steps/s
Avg test loss: 0.28451, Avg test acc: 0.94582, Avg tpr: 0.93502, Avg fpr: 0.05399, total FA: 7496

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11950 | acc=0.9677 | tpr=0.9071 | fpr=0.0312 | 4452.6 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.12217 | acc=0.9665 | tpr=0.9104 | fpr=0.0325 | 8403.1 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.12661 | acc=0.9655 | tpr=0.9179 | fpr=0.0336 | 7907.3 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.12593 | acc=0.9659 | tpr=0.9279 | fpr=0.0334 | 8162.1 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.12754 | acc=0.9656 | tpr=0.9249 | fpr=0.0336 | 8185.2 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.12882 | acc=0.9654 | tpr=0.9244 | fpr=0.0339 | 7963.6 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.12991 | acc=0.9652 | tpr=0.9261 | fpr=0.0340 | 7279.2 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.13072 | acc=0.9650 | tpr=0.9223 | fpr=0.0342 | 7979.3 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.13201 | acc=0.9648 | tpr=0.9202 | fpr=0.0344 | 7032.5 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.13162 | acc=0.9649 | tpr=0.9238 | fpr=0.0344 | 8342.2 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.13104 | acc=0.9650 | tpr=0.9228 | fpr=0.0342 | 12057.0 samples/s | 47.1 steps/s
Avg test loss: 0.13082, Avg test acc: 0.96506, Avg tpr: 0.92274, Avg fpr: 0.03417, total FA: 4744

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.20127 | acc=0.9563 | tpr=0.9115 | fpr=0.0429 | 4618.9 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.20245 | acc=0.9560 | tpr=0.9275 | fpr=0.0435 | 7770.1 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.20824 | acc=0.9549 | tpr=0.9352 | fpr=0.0447 | 7692.9 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.21068 | acc=0.9547 | tpr=0.9388 | fpr=0.0450 | 8072.6 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.21255 | acc=0.9545 | tpr=0.9354 | fpr=0.0451 | 8010.9 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.21476 | acc=0.9541 | tpr=0.9360 | fpr=0.0456 | 7756.3 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.21504 | acc=0.9542 | tpr=0.9349 | fpr=0.0454 | 6882.4 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.21565 | acc=0.9541 | tpr=0.9349 | fpr=0.0456 | 8266.2 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.21685 | acc=0.9537 | tpr=0.9333 | fpr=0.0459 | 8226.3 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.21738 | acc=0.9535 | tpr=0.9352 | fpr=0.0461 | 8353.2 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.21633 | acc=0.9537 | tpr=0.9331 | fpr=0.0459 | 10935.0 samples/s | 42.7 steps/s
Avg test loss: 0.21612, Avg test acc: 0.95372, Avg tpr: 0.93304, Avg fpr: 0.04591, total FA: 6374

server round 15/50

clients selected: [0 2 4 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=97.5] | Loss=0.09337 | Reg=0.00141 | acc=0.9531 | L2-Norm=11.878 | L2-Norm(final)=12.252 | 3246.7 samples/s | 50.7 steps/s
[Step=20050 Epoch=97.8] | Loss=0.04351 | Reg=0.00141 | acc=0.9531 | L2-Norm=11.877 | L2-Norm(final)=12.263 | 4979.0 samples/s | 77.8 steps/s
[Step=20100 Epoch=98.0] | Loss=0.04527 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.877 | L2-Norm(final)=12.275 | 5456.0 samples/s | 85.3 steps/s
[Step=20150 Epoch=98.3] | Loss=0.04525 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.877 | L2-Norm(final)=12.285 | 5364.5 samples/s | 83.8 steps/s
[Step=20200 Epoch=98.5] | Loss=0.04457 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.877 | L2-Norm(final)=12.296 | 8477.9 samples/s | 132.5 steps/s
[Step=20250 Epoch=98.7] | Loss=0.04402 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.877 | L2-Norm(final)=12.306 | 1469.2 samples/s | 23.0 steps/s
[Step=20300 Epoch=99.0] | Loss=0.04383 | Reg=0.00141 | acc=0.9531 | L2-Norm=11.877 | L2-Norm(final)=12.318 | 5173.6 samples/s | 80.8 steps/s
[Step=20350 Epoch=99.2] | Loss=0.04419 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.877 | L2-Norm(final)=12.329 | 5473.0 samples/s | 85.5 steps/s
[Step=20400 Epoch=99.5] | Loss=0.04399 | Reg=0.00141 | acc=0.9531 | L2-Norm=11.877 | L2-Norm(final)=12.341 | 7452.0 samples/s | 116.4 steps/s
[Step=20450 Epoch=99.7] | Loss=0.04417 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.877 | L2-Norm(final)=12.351 | 1511.6 samples/s | 23.6 steps/s
[Step=20500 Epoch=100.0] | Loss=0.04381 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.877 | L2-Norm(final)=12.362 | 5376.6 samples/s | 84.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=100.0] | Loss=0.01864 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.877 | L2-Norm(final)=12.476 | 3154.2 samples/s | 49.3 steps/s
[Step=20550 Epoch=100.2] | Loss=0.04777 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.966 | L2-Norm(final)=12.467 | 4238.9 samples/s | 66.2 steps/s
[Step=20600 Epoch=100.4] | Loss=0.04498 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.057 | L2-Norm(final)=12.453 | 4653.5 samples/s | 72.7 steps/s
[Step=20650 Epoch=100.7] | Loss=0.04430 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=12.444 | 4611.6 samples/s | 72.1 steps/s
[Step=20700 Epoch=100.9] | Loss=0.04357 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.185 | L2-Norm(final)=12.438 | 6541.7 samples/s | 102.2 steps/s
[Step=20750 Epoch=101.2] | Loss=0.03882 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=12.436 | 1366.8 samples/s | 21.4 steps/s
[Step=20800 Epoch=101.4] | Loss=0.03503 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.265 | L2-Norm(final)=12.437 | 4637.3 samples/s | 72.5 steps/s
[Step=20850 Epoch=101.7] | Loss=0.03282 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.295 | L2-Norm(final)=12.439 | 4712.9 samples/s | 73.6 steps/s
[Step=20900 Epoch=101.9] | Loss=0.03032 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.321 | L2-Norm(final)=12.441 | 5937.9 samples/s | 92.8 steps/s
[Step=20950 Epoch=102.2] | Loss=0.02813 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.344 | L2-Norm(final)=12.444 | 1425.5 samples/s | 22.3 steps/s
[Step=21000 Epoch=102.4] | Loss=0.02633 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.365 | L2-Norm(final)=12.447 | 4607.7 samples/s | 72.0 steps/s
[Step=21050 Epoch=102.6] | Loss=0.02508 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.383 | L2-Norm(final)=12.450 | 4677.5 samples/s | 73.1 steps/s
[Step=21100 Epoch=102.9] | Loss=0.02383 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.400 | L2-Norm(final)=12.453 | 5444.8 samples/s | 85.1 steps/s
[Step=21150 Epoch=103.1] | Loss=0.02267 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=12.456 | 1425.0 samples/s | 22.3 steps/s
[Step=21200 Epoch=103.4] | Loss=0.02168 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=12.459 | 4634.3 samples/s | 72.4 steps/s
[Step=21250 Epoch=103.6] | Loss=0.02084 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.442 | L2-Norm(final)=12.463 | 4710.2 samples/s | 73.6 steps/s
[Step=21300 Epoch=103.9] | Loss=0.02008 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=12.465 | 5033.3 samples/s | 78.6 steps/s
[Step=21350 Epoch=104.1] | Loss=0.01956 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.465 | L2-Norm(final)=12.468 | 1459.4 samples/s | 22.8 steps/s
[Step=21400 Epoch=104.4] | Loss=0.01880 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=12.471 | 4686.9 samples/s | 73.2 steps/s
[Step=21450 Epoch=104.6] | Loss=0.01824 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.486 | L2-Norm(final)=12.474 | 4639.2 samples/s | 72.5 steps/s
[Step=21500 Epoch=104.8] | Loss=0.01776 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.496 | L2-Norm(final)=12.477 | 4794.9 samples/s | 74.9 steps/s
[Step=21550 Epoch=105.1] | Loss=0.01718 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=12.480 | 1502.1 samples/s | 23.5 steps/s
[Step=21600 Epoch=105.3] | Loss=0.01671 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.514 | L2-Norm(final)=12.483 | 4665.8 samples/s | 72.9 steps/s
[Step=21650 Epoch=105.6] | Loss=0.01612 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=12.486 | 4618.0 samples/s | 72.2 steps/s
[Step=21700 Epoch=105.8] | Loss=0.01582 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=12.488 | 4655.6 samples/s | 72.7 steps/s
[Step=21750 Epoch=106.1] | Loss=0.01539 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=12.490 | 1536.9 samples/s | 24.0 steps/s
[Step=21800 Epoch=106.3] | Loss=0.01501 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.544 | L2-Norm(final)=12.493 | 4570.3 samples/s | 71.4 steps/s
[Step=21850 Epoch=106.5] | Loss=0.01460 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=12.495 | 4647.4 samples/s | 72.6 steps/s
[Step=21900 Epoch=106.8] | Loss=0.01428 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=12.498 | 4636.4 samples/s | 72.4 steps/s
[Step=21950 Epoch=107.0] | Loss=0.01401 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.564 | L2-Norm(final)=12.500 | 1508.3 samples/s | 23.6 steps/s
[Step=22000 Epoch=107.3] | Loss=0.01366 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.570 | L2-Norm(final)=12.503 | 4687.0 samples/s | 73.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step22000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.05137 | Reg=0.00141 | acc=0.9375 | L2-Norm=11.878 | L2-Norm(final)=9.188 | 3141.5 samples/s | 49.1 steps/s
[Step=8050 Epoch=39.2] | Loss=0.05720 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.879 | L2-Norm(final)=9.214 | 4792.7 samples/s | 74.9 steps/s
[Step=8100 Epoch=39.5] | Loss=0.05544 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.879 | L2-Norm(final)=9.251 | 5635.6 samples/s | 88.1 steps/s
[Step=8150 Epoch=39.7] | Loss=0.05781 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.879 | L2-Norm(final)=9.283 | 5122.2 samples/s | 80.0 steps/s
[Step=8200 Epoch=40.0] | Loss=0.05744 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.879 | L2-Norm(final)=9.311 | 8466.0 samples/s | 132.3 steps/s
[Step=8250 Epoch=40.2] | Loss=0.05781 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.879 | L2-Norm(final)=9.337 | 1434.2 samples/s | 22.4 steps/s
[Step=8300 Epoch=40.4] | Loss=0.05621 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.879 | L2-Norm(final)=9.365 | 5437.4 samples/s | 85.0 steps/s
[Step=8350 Epoch=40.7] | Loss=0.05754 | Reg=0.00141 | acc=0.9531 | L2-Norm=11.879 | L2-Norm(final)=9.393 | 5597.0 samples/s | 87.5 steps/s
[Step=8400 Epoch=40.9] | Loss=0.05711 | Reg=0.00141 | acc=0.9531 | L2-Norm=11.879 | L2-Norm(final)=9.419 | 7039.9 samples/s | 110.0 steps/s
[Step=8450 Epoch=41.2] | Loss=0.05650 | Reg=0.00141 | acc=0.9531 | L2-Norm=11.879 | L2-Norm(final)=9.446 | 1491.2 samples/s | 23.3 steps/s
[Step=8500 Epoch=41.4] | Loss=0.05646 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.879 | L2-Norm(final)=9.474 | 5382.8 samples/s | 84.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=41.4] | Loss=0.04484 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.879 | L2-Norm(final)=9.743 | 3152.7 samples/s | 49.3 steps/s
[Step=8550 Epoch=41.7] | Loss=0.05269 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.977 | L2-Norm(final)=9.744 | 4220.7 samples/s | 65.9 steps/s
[Step=8600 Epoch=41.9] | Loss=0.05251 | Reg=0.00146 | acc=0.9531 | L2-Norm=12.084 | L2-Norm(final)=9.735 | 4586.8 samples/s | 71.7 steps/s
[Step=8650 Epoch=42.1] | Loss=0.05050 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.172 | L2-Norm(final)=9.727 | 4603.8 samples/s | 71.9 steps/s
[Step=8700 Epoch=42.4] | Loss=0.04837 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.242 | L2-Norm(final)=9.722 | 6652.3 samples/s | 103.9 steps/s
[Step=8750 Epoch=42.6] | Loss=0.04300 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.300 | L2-Norm(final)=9.720 | 1380.2 samples/s | 21.6 steps/s
[Step=8800 Epoch=42.9] | Loss=0.03971 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.345 | L2-Norm(final)=9.720 | 4551.0 samples/s | 71.1 steps/s
[Step=8850 Epoch=43.1] | Loss=0.03706 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.385 | L2-Norm(final)=9.722 | 4622.8 samples/s | 72.2 steps/s
[Step=8900 Epoch=43.4] | Loss=0.03498 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.419 | L2-Norm(final)=9.723 | 6017.6 samples/s | 94.0 steps/s
[Step=8950 Epoch=43.6] | Loss=0.03242 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.451 | L2-Norm(final)=9.726 | 1401.1 samples/s | 21.9 steps/s
[Step=9000 Epoch=43.9] | Loss=0.03016 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=9.730 | 4649.4 samples/s | 72.6 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02869 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.502 | L2-Norm(final)=9.734 | 4588.6 samples/s | 71.7 steps/s
[Step=9100 Epoch=44.3] | Loss=0.02750 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=9.737 | 5541.7 samples/s | 86.6 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02606 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.542 | L2-Norm(final)=9.740 | 1453.6 samples/s | 22.7 steps/s
[Step=9200 Epoch=44.8] | Loss=0.02483 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.560 | L2-Norm(final)=9.744 | 4728.1 samples/s | 73.9 steps/s
[Step=9250 Epoch=45.1] | Loss=0.02383 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=9.747 | 4801.8 samples/s | 75.0 steps/s
[Step=9300 Epoch=45.3] | Loss=0.02304 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.591 | L2-Norm(final)=9.750 | 5019.4 samples/s | 78.4 steps/s
[Step=9350 Epoch=45.6] | Loss=0.02216 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.605 | L2-Norm(final)=9.753 | 1484.6 samples/s | 23.2 steps/s
[Step=9400 Epoch=45.8] | Loss=0.02133 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.619 | L2-Norm(final)=9.756 | 4619.8 samples/s | 72.2 steps/s
[Step=9450 Epoch=46.0] | Loss=0.02071 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.632 | L2-Norm(final)=9.759 | 4631.8 samples/s | 72.4 steps/s
[Step=9500 Epoch=46.3] | Loss=0.02006 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.644 | L2-Norm(final)=9.762 | 4757.8 samples/s | 74.3 steps/s
[Step=9550 Epoch=46.5] | Loss=0.01939 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.655 | L2-Norm(final)=9.764 | 1513.4 samples/s | 23.6 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01872 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.665 | L2-Norm(final)=9.767 | 4623.7 samples/s | 72.2 steps/s
[Step=9650 Epoch=47.0] | Loss=0.01827 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=9.770 | 4603.5 samples/s | 71.9 steps/s
[Step=9700 Epoch=47.3] | Loss=0.01774 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.684 | L2-Norm(final)=9.773 | 4718.5 samples/s | 73.7 steps/s
[Step=9750 Epoch=47.5] | Loss=0.01722 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.693 | L2-Norm(final)=9.776 | 1513.2 samples/s | 23.6 steps/s
[Step=9800 Epoch=47.8] | Loss=0.01675 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.702 | L2-Norm(final)=9.779 | 4607.7 samples/s | 72.0 steps/s
[Step=9850 Epoch=48.0] | Loss=0.01633 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.710 | L2-Norm(final)=9.782 | 4612.4 samples/s | 72.1 steps/s
[Step=9900 Epoch=48.2] | Loss=0.01596 | Reg=0.00162 | acc=0.9688 | L2-Norm=12.717 | L2-Norm(final)=9.785 | 4621.1 samples/s | 72.2 steps/s
[Step=9950 Epoch=48.5] | Loss=0.01565 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.724 | L2-Norm(final)=9.788 | 1542.4 samples/s | 24.1 steps/s
[Step=10000 Epoch=48.7] | Loss=0.01526 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.731 | L2-Norm(final)=9.791 | 4695.9 samples/s | 73.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_2/client_state-step10000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=6001 Epoch=29.4] | Loss=0.03859 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.878 | L2-Norm(final)=8.636 | 3344.8 samples/s | 52.3 steps/s
[Step=6050 Epoch=29.7] | Loss=0.05487 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.879 | L2-Norm(final)=8.666 | 4479.5 samples/s | 70.0 steps/s
[Step=6100 Epoch=29.9] | Loss=0.05306 | Reg=0.00141 | acc=0.9531 | L2-Norm=11.879 | L2-Norm(final)=8.706 | 5545.2 samples/s | 86.6 steps/s
[Step=6150 Epoch=30.2] | Loss=0.05332 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.879 | L2-Norm(final)=8.742 | 5477.5 samples/s | 85.6 steps/s
[Step=6200 Epoch=30.4] | Loss=0.05317 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.879 | L2-Norm(final)=8.773 | 8776.0 samples/s | 137.1 steps/s
[Step=6250 Epoch=30.6] | Loss=0.05298 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.879 | L2-Norm(final)=8.803 | 1505.0 samples/s | 23.5 steps/s
[Step=6300 Epoch=30.9] | Loss=0.05231 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.879 | L2-Norm(final)=8.834 | 5296.5 samples/s | 82.8 steps/s
[Step=6350 Epoch=31.1] | Loss=0.05235 | Reg=0.00141 | acc=0.9375 | L2-Norm=11.879 | L2-Norm(final)=8.865 | 5507.9 samples/s | 86.1 steps/s
[Step=6400 Epoch=31.4] | Loss=0.05216 | Reg=0.00141 | acc=0.9062 | L2-Norm=11.879 | L2-Norm(final)=8.893 | 8052.4 samples/s | 125.8 steps/s
[Step=6450 Epoch=31.6] | Loss=0.05175 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.879 | L2-Norm(final)=8.923 | 1514.9 samples/s | 23.7 steps/s
[Step=6500 Epoch=31.9] | Loss=0.05112 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.879 | L2-Norm(final)=8.952 | 5387.6 samples/s | 84.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=6501 Epoch=31.9] | Loss=0.04574 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.879 | L2-Norm(final)=9.264 | 3242.6 samples/s | 50.7 steps/s
[Step=6550 Epoch=32.1] | Loss=0.05502 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.986 | L2-Norm(final)=9.269 | 4171.8 samples/s | 65.2 steps/s
[Step=6600 Epoch=32.4] | Loss=0.05522 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.090 | L2-Norm(final)=9.254 | 4683.7 samples/s | 73.2 steps/s
[Step=6650 Epoch=32.6] | Loss=0.05195 | Reg=0.00148 | acc=0.9219 | L2-Norm=12.166 | L2-Norm(final)=9.250 | 4756.9 samples/s | 74.3 steps/s
[Step=6700 Epoch=32.9] | Loss=0.04754 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.225 | L2-Norm(final)=9.247 | 6809.8 samples/s | 106.4 steps/s
[Step=6750 Epoch=33.1] | Loss=0.04259 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.276 | L2-Norm(final)=9.250 | 1400.7 samples/s | 21.9 steps/s
[Step=6800 Epoch=33.3] | Loss=0.03883 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.320 | L2-Norm(final)=9.253 | 4698.3 samples/s | 73.4 steps/s
[Step=6850 Epoch=33.6] | Loss=0.03570 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.358 | L2-Norm(final)=9.257 | 4690.3 samples/s | 73.3 steps/s
[Step=6900 Epoch=33.8] | Loss=0.03384 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.392 | L2-Norm(final)=9.260 | 6487.6 samples/s | 101.4 steps/s
[Step=6950 Epoch=34.1] | Loss=0.03149 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.425 | L2-Norm(final)=9.265 | 1438.8 samples/s | 22.5 steps/s
[Step=7000 Epoch=34.3] | Loss=0.02986 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.455 | L2-Norm(final)=9.269 | 4676.6 samples/s | 73.1 steps/s
[Step=7050 Epoch=34.6] | Loss=0.02823 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.482 | L2-Norm(final)=9.274 | 4838.0 samples/s | 75.6 steps/s
[Step=7100 Epoch=34.8] | Loss=0.02688 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.506 | L2-Norm(final)=9.278 | 5900.0 samples/s | 92.2 steps/s
[Step=7150 Epoch=35.1] | Loss=0.02558 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=9.283 | 1428.9 samples/s | 22.3 steps/s
[Step=7200 Epoch=35.3] | Loss=0.02427 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=9.288 | 4694.0 samples/s | 73.3 steps/s
[Step=7250 Epoch=35.6] | Loss=0.02319 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.569 | L2-Norm(final)=9.293 | 4714.9 samples/s | 73.7 steps/s
[Step=7300 Epoch=35.8] | Loss=0.02229 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.586 | L2-Norm(final)=9.298 | 5707.2 samples/s | 89.2 steps/s
[Step=7350 Epoch=36.0] | Loss=0.02140 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.603 | L2-Norm(final)=9.302 | 1481.4 samples/s | 23.1 steps/s
[Step=7400 Epoch=36.3] | Loss=0.02073 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.618 | L2-Norm(final)=9.306 | 4685.3 samples/s | 73.2 steps/s
[Step=7450 Epoch=36.5] | Loss=0.02015 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.632 | L2-Norm(final)=9.309 | 4705.7 samples/s | 73.5 steps/s
[Step=7500 Epoch=36.8] | Loss=0.01940 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.645 | L2-Norm(final)=9.313 | 5416.1 samples/s | 84.6 steps/s
[Step=7550 Epoch=37.0] | Loss=0.01892 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.658 | L2-Norm(final)=9.317 | 1500.5 samples/s | 23.4 steps/s
[Step=7600 Epoch=37.3] | Loss=0.01838 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.670 | L2-Norm(final)=9.321 | 4704.8 samples/s | 73.5 steps/s
[Step=7650 Epoch=37.5] | Loss=0.01793 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.682 | L2-Norm(final)=9.324 | 4633.2 samples/s | 72.4 steps/s
[Step=7700 Epoch=37.8] | Loss=0.01746 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.694 | L2-Norm(final)=9.328 | 5142.5 samples/s | 80.4 steps/s
[Step=7750 Epoch=38.0] | Loss=0.01708 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.706 | L2-Norm(final)=9.331 | 1538.8 samples/s | 24.0 steps/s
[Step=7800 Epoch=38.2] | Loss=0.01671 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.718 | L2-Norm(final)=9.335 | 4687.3 samples/s | 73.2 steps/s
[Step=7850 Epoch=38.5] | Loss=0.01637 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.730 | L2-Norm(final)=9.339 | 4710.4 samples/s | 73.6 steps/s
[Step=7900 Epoch=38.7] | Loss=0.01607 | Reg=0.00162 | acc=0.9531 | L2-Norm=12.742 | L2-Norm(final)=9.343 | 4843.8 samples/s | 75.7 steps/s
[Step=7950 Epoch=39.0] | Loss=0.01578 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.754 | L2-Norm(final)=9.346 | 1505.5 samples/s | 23.5 steps/s
[Step=8000 Epoch=39.2] | Loss=0.01539 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.766 | L2-Norm(final)=9.350 | 4720.4 samples/s | 73.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_4/client_state-step8000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=171.9] | Loss=0.00052 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.878 | L2-Norm(final)=13.991 | 3110.7 samples/s | 48.6 steps/s
[Step=18050 Epoch=172.4] | Loss=0.00285 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.873 | L2-Norm(final)=14.016 | 4631.6 samples/s | 72.4 steps/s
[Step=18100 Epoch=172.8] | Loss=0.00283 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=14.044 | 8056.0 samples/s | 125.9 steps/s
[Step=18150 Epoch=173.3] | Loss=0.00259 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.872 | L2-Norm(final)=14.070 | 1421.6 samples/s | 22.2 steps/s
[Step=18200 Epoch=173.8] | Loss=0.00280 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=14.093 | 7391.7 samples/s | 115.5 steps/s
[Step=18250 Epoch=174.3] | Loss=0.00273 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=14.116 | 1463.6 samples/s | 22.9 steps/s
[Step=18300 Epoch=174.8] | Loss=0.00278 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=14.139 | 6767.5 samples/s | 105.7 steps/s
[Step=18350 Epoch=175.2] | Loss=0.00272 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=14.161 | 1489.1 samples/s | 23.3 steps/s
[Step=18400 Epoch=175.7] | Loss=0.00259 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=14.183 | 6243.1 samples/s | 97.5 steps/s
[Step=18450 Epoch=176.2] | Loss=0.00268 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=14.204 | 1541.4 samples/s | 24.1 steps/s
[Step=18500 Epoch=176.7] | Loss=0.00270 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=14.223 | 5668.8 samples/s | 88.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=176.7] | Loss=0.00032 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=14.418 | 3283.4 samples/s | 51.3 steps/s
[Step=18550 Epoch=177.1] | Loss=0.01107 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.002 | L2-Norm(final)=14.419 | 3806.4 samples/s | 59.5 steps/s
[Step=18600 Epoch=177.6] | Loss=0.00649 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=14.394 | 6643.6 samples/s | 103.8 steps/s
[Step=18650 Epoch=178.1] | Loss=0.00458 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.225 | L2-Norm(final)=14.387 | 1159.0 samples/s | 18.1 steps/s
[Step=18700 Epoch=178.6] | Loss=0.00351 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=14.385 | 6091.6 samples/s | 95.2 steps/s
[Step=18750 Epoch=179.1] | Loss=0.00281 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=14.385 | 1380.2 samples/s | 21.6 steps/s
[Step=18800 Epoch=179.5] | Loss=0.00235 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=14.385 | 5637.4 samples/s | 88.1 steps/s
[Step=18850 Epoch=180.0] | Loss=0.00201 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=14.385 | 1413.8 samples/s | 22.1 steps/s
[Step=18900 Epoch=180.5] | Loss=0.00176 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=14.385 | 5216.8 samples/s | 81.5 steps/s
[Step=18950 Epoch=181.0] | Loss=0.00157 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=14.385 | 1447.5 samples/s | 22.6 steps/s
[Step=19000 Epoch=181.4] | Loss=0.00141 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=14.385 | 4876.5 samples/s | 76.2 steps/s
[Step=19050 Epoch=181.9] | Loss=0.00128 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.222 | L2-Norm(final)=14.385 | 1483.7 samples/s | 23.2 steps/s
[Step=19100 Epoch=182.4] | Loss=0.00118 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.210 | L2-Norm(final)=14.386 | 4519.2 samples/s | 70.6 steps/s
[Step=19150 Epoch=182.9] | Loss=0.00109 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=14.386 | 1489.8 samples/s | 23.3 steps/s
[Step=19200 Epoch=183.3] | Loss=0.00101 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=14.386 | 4489.0 samples/s | 70.1 steps/s
[Step=19250 Epoch=183.8] | Loss=0.00094 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=14.386 | 1515.9 samples/s | 23.7 steps/s
[Step=19300 Epoch=184.3] | Loss=0.00088 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=14.386 | 4448.2 samples/s | 69.5 steps/s
[Step=19350 Epoch=184.8] | Loss=0.00083 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=14.386 | 1534.5 samples/s | 24.0 steps/s
[Step=19400 Epoch=185.3] | Loss=0.00078 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=14.387 | 4430.5 samples/s | 69.2 steps/s
[Step=19450 Epoch=185.7] | Loss=0.00074 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.119 | L2-Norm(final)=14.387 | 1520.8 samples/s | 23.8 steps/s
[Step=19500 Epoch=186.2] | Loss=0.00071 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.105 | L2-Norm(final)=14.387 | 4448.9 samples/s | 69.5 steps/s
[Step=19550 Epoch=186.7] | Loss=0.00067 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.092 | L2-Norm(final)=14.387 | 7175.9 samples/s | 112.1 steps/s
[Step=19600 Epoch=187.2] | Loss=0.00064 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.079 | L2-Norm(final)=14.387 | 1344.0 samples/s | 21.0 steps/s
[Step=19650 Epoch=187.6] | Loss=0.00061 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.065 | L2-Norm(final)=14.387 | 6572.3 samples/s | 102.7 steps/s
[Step=19700 Epoch=188.1] | Loss=0.00059 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.052 | L2-Norm(final)=14.388 | 1380.6 samples/s | 21.6 steps/s
[Step=19750 Epoch=188.6] | Loss=0.00057 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.039 | L2-Norm(final)=14.388 | 6042.2 samples/s | 94.4 steps/s
[Step=19800 Epoch=189.1] | Loss=0.00054 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.025 | L2-Norm(final)=14.388 | 1418.7 samples/s | 22.2 steps/s
[Step=19850 Epoch=189.6] | Loss=0.00052 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.012 | L2-Norm(final)=14.388 | 5583.7 samples/s | 87.2 steps/s
[Step=19900 Epoch=190.0] | Loss=0.00050 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.998 | L2-Norm(final)=14.388 | 1448.4 samples/s | 22.6 steps/s
[Step=19950 Epoch=190.5] | Loss=0.00049 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.985 | L2-Norm(final)=14.388 | 5151.0 samples/s | 80.5 steps/s
[Step=20000 Epoch=191.0] | Loss=0.00047 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=14.389 | 1456.6 samples/s | 22.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step20000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=152.5] | Loss=0.00124 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.878 | L2-Norm(final)=15.381 | 3155.0 samples/s | 49.3 steps/s
[Step=16050 Epoch=153.0] | Loss=0.00365 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.873 | L2-Norm(final)=15.418 | 4561.6 samples/s | 71.3 steps/s
[Step=16100 Epoch=153.4] | Loss=0.00372 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.873 | L2-Norm(final)=15.458 | 8180.8 samples/s | 127.8 steps/s
[Step=16150 Epoch=153.9] | Loss=0.00419 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.873 | L2-Norm(final)=15.495 | 1429.3 samples/s | 22.3 steps/s
[Step=16200 Epoch=154.4] | Loss=0.00387 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.873 | L2-Norm(final)=15.530 | 7361.2 samples/s | 115.0 steps/s
[Step=16250 Epoch=154.9] | Loss=0.00397 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.873 | L2-Norm(final)=15.565 | 1464.1 samples/s | 22.9 steps/s
[Step=16300 Epoch=155.4] | Loss=0.00410 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=15.598 | 6792.9 samples/s | 106.1 steps/s
[Step=16350 Epoch=155.8] | Loss=0.00404 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=15.631 | 1492.6 samples/s | 23.3 steps/s
[Step=16400 Epoch=156.3] | Loss=0.00398 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=15.662 | 6101.0 samples/s | 95.3 steps/s
[Step=16450 Epoch=156.8] | Loss=0.00399 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=15.694 | 1558.5 samples/s | 24.4 steps/s
[Step=16500 Epoch=157.3] | Loss=0.00382 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=15.726 | 5546.7 samples/s | 86.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=157.3] | Loss=0.00075 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=16.034 | 3031.9 samples/s | 47.4 steps/s
[Step=16550 Epoch=157.7] | Loss=0.00848 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.969 | L2-Norm(final)=16.034 | 4220.9 samples/s | 66.0 steps/s
[Step=16600 Epoch=158.2] | Loss=0.00870 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=16.002 | 6603.8 samples/s | 103.2 steps/s
[Step=16650 Epoch=158.7] | Loss=0.00591 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.240 | L2-Norm(final)=15.991 | 1372.3 samples/s | 21.4 steps/s
[Step=16700 Epoch=159.2] | Loss=0.00445 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.277 | L2-Norm(final)=15.987 | 5815.7 samples/s | 90.9 steps/s
[Step=16750 Epoch=159.6] | Loss=0.00356 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=15.985 | 1400.6 samples/s | 21.9 steps/s
[Step=16800 Epoch=160.1] | Loss=0.00297 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=15.984 | 5581.5 samples/s | 87.2 steps/s
[Step=16850 Epoch=160.6] | Loss=0.00255 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=15.984 | 1401.5 samples/s | 21.9 steps/s
[Step=16900 Epoch=161.1] | Loss=0.00223 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.293 | L2-Norm(final)=15.983 | 5188.9 samples/s | 81.1 steps/s
[Step=16950 Epoch=161.5] | Loss=0.00199 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=15.983 | 1442.1 samples/s | 22.5 steps/s
[Step=17000 Epoch=162.0] | Loss=0.00179 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=15.983 | 4874.8 samples/s | 76.2 steps/s
[Step=17050 Epoch=162.5] | Loss=0.00163 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.270 | L2-Norm(final)=15.984 | 1484.0 samples/s | 23.2 steps/s
[Step=17100 Epoch=163.0] | Loss=0.00149 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=15.984 | 4535.2 samples/s | 70.9 steps/s
[Step=17150 Epoch=163.5] | Loss=0.00138 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=15.984 | 1528.6 samples/s | 23.9 steps/s
[Step=17200 Epoch=163.9] | Loss=0.00128 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.240 | L2-Norm(final)=15.984 | 4490.6 samples/s | 70.2 steps/s
[Step=17250 Epoch=164.4] | Loss=0.00120 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=15.985 | 1540.9 samples/s | 24.1 steps/s
[Step=17300 Epoch=164.9] | Loss=0.00112 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=15.985 | 4390.9 samples/s | 68.6 steps/s
[Step=17350 Epoch=165.4] | Loss=0.00106 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.207 | L2-Norm(final)=15.985 | 1520.5 samples/s | 23.8 steps/s
[Step=17400 Epoch=165.8] | Loss=0.00100 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.196 | L2-Norm(final)=15.986 | 4535.6 samples/s | 70.9 steps/s
[Step=17450 Epoch=166.3] | Loss=0.00095 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.185 | L2-Norm(final)=15.986 | 1558.0 samples/s | 24.3 steps/s
[Step=17500 Epoch=166.8] | Loss=0.00090 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=15.986 | 4433.6 samples/s | 69.3 steps/s
[Step=17550 Epoch=167.3] | Loss=0.00086 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=15.987 | 7170.7 samples/s | 112.0 steps/s
[Step=17600 Epoch=167.7] | Loss=0.00082 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=15.987 | 1347.8 samples/s | 21.1 steps/s
[Step=17650 Epoch=168.2] | Loss=0.00078 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=15.987 | 6600.5 samples/s | 103.1 steps/s
[Step=17700 Epoch=168.7] | Loss=0.00075 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.127 | L2-Norm(final)=15.988 | 1363.0 samples/s | 21.3 steps/s
[Step=17750 Epoch=169.2] | Loss=0.00072 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.115 | L2-Norm(final)=15.988 | 6041.6 samples/s | 94.4 steps/s
[Step=17800 Epoch=169.7] | Loss=0.00069 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.103 | L2-Norm(final)=15.988 | 1418.5 samples/s | 22.2 steps/s
[Step=17850 Epoch=170.1] | Loss=0.00067 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.091 | L2-Norm(final)=15.989 | 5593.5 samples/s | 87.4 steps/s
[Step=17900 Epoch=170.6] | Loss=0.00064 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.079 | L2-Norm(final)=15.989 | 1439.9 samples/s | 22.5 steps/s
[Step=17950 Epoch=171.1] | Loss=0.00062 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.067 | L2-Norm(final)=15.989 | 5062.8 samples/s | 79.1 steps/s
[Step=18000 Epoch=171.6] | Loss=0.00060 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.055 | L2-Norm(final)=15.990 | 1456.2 samples/s | 22.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4/client_state-step18000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11800 | acc=0.9504 | tpr=0.9702 | fpr=0.0927 | 4617.9 samples/s | 18.0 steps/s
Avg test loss: 0.12196, Avg test acc: 0.94988, Avg tpr: 0.96998, Avg fpr: 0.09435, total FA: 736

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.13479 | acc=0.9495 | tpr=0.9735 | fpr=0.1028 | 4708.8 samples/s | 18.4 steps/s
Avg test loss: 0.13693, Avg test acc: 0.94799, Avg tpr: 0.97371, Avg fpr: 0.10858, total FA: 847

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11102 | acc=0.9488 | tpr=0.9604 | fpr=0.0763 | 4559.6 samples/s | 17.8 steps/s
Avg test loss: 0.11593, Avg test acc: 0.94883, Avg tpr: 0.95978, Avg fpr: 0.07525, total FA: 587

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.11058 | acc=0.9521 | tpr=0.9709 | fpr=0.0887 | 4667.8 samples/s | 18.2 steps/s
Avg test loss: 0.11534, Avg test acc: 0.95048, Avg tpr: 0.97074, Avg fpr: 0.09409, total FA: 734

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11692 | acc=0.9533 | tpr=0.9738 | fpr=0.0912 | 4669.8 samples/s | 18.2 steps/s
Avg test loss: 0.12300, Avg test acc: 0.95076, Avg tpr: 0.97202, Avg fpr: 0.09601, total FA: 749

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.83591 | acc=0.3019 | tpr=0.0110 | fpr=0.0664 | 4613.1 samples/s | 18.0 steps/s
Avg test loss: 4.85344, Avg test acc: 0.29930, Avg tpr: 0.01061, Avg fpr: 0.06576, total FA: 513

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.14769 | acc=0.3072 | tpr=0.0127 | fpr=0.0533 | 4675.7 samples/s | 18.3 steps/s
Avg test loss: 4.16151, Avg test acc: 0.30547, Avg tpr: 0.01253, Avg fpr: 0.05025, total FA: 392

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.01410 | acc=0.3154 | tpr=0.0194 | fpr=0.0419 | 4548.8 samples/s | 17.8 steps/s
Avg test loss: 5.04015, Avg test acc: 0.31216, Avg tpr: 0.01935, Avg fpr: 0.04384, total FA: 342

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.11710 | acc=0.3128 | tpr=0.0245 | fpr=0.0612 | 4726.1 samples/s | 18.5 steps/s
Avg test loss: 4.13379, Avg test acc: 0.31164, Avg tpr: 0.02547, Avg fpr: 0.05897, total FA: 460

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.95400 | acc=0.3049 | tpr=0.0164 | fpr=0.0686 | 4687.8 samples/s | 18.3 steps/s
Avg test loss: 4.96477, Avg test acc: 0.30231, Avg tpr: 0.01556, Avg fpr: 0.06704, total FA: 523

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.92854 | acc=0.1250 | tpr=0.8274 | fpr=0.8876 | 4653.8 samples/s | 18.2 steps/s
[Step= 100] | Loss=6.90362 | acc=0.1260 | tpr=0.7996 | fpr=0.8866 | 7523.6 samples/s | 29.4 steps/s
[Step= 150] | Loss=6.92067 | acc=0.1271 | tpr=0.8040 | fpr=0.8853 | 8437.1 samples/s | 33.0 steps/s
[Step= 200] | Loss=6.90999 | acc=0.1274 | tpr=0.8011 | fpr=0.8848 | 8026.0 samples/s | 31.4 steps/s
[Step= 250] | Loss=6.90838 | acc=0.1280 | tpr=0.7965 | fpr=0.8842 | 7718.6 samples/s | 30.2 steps/s
[Step= 300] | Loss=6.90814 | acc=0.1282 | tpr=0.7978 | fpr=0.8840 | 7589.9 samples/s | 29.6 steps/s
[Step= 350] | Loss=6.91250 | acc=0.1279 | tpr=0.8028 | fpr=0.8843 | 8415.4 samples/s | 32.9 steps/s
[Step= 400] | Loss=6.91217 | acc=0.1278 | tpr=0.8003 | fpr=0.8844 | 7696.8 samples/s | 30.1 steps/s
[Step= 450] | Loss=6.91115 | acc=0.1276 | tpr=0.7960 | fpr=0.8845 | 8551.2 samples/s | 33.4 steps/s
[Step= 500] | Loss=6.91337 | acc=0.1275 | tpr=0.7934 | fpr=0.8846 | 7457.9 samples/s | 29.1 steps/s
[Step= 550] | Loss=6.91050 | acc=0.1278 | tpr=0.7971 | fpr=0.8844 | 11075.8 samples/s | 43.3 steps/s
Avg test loss: 6.91100, Avg test acc: 0.12768, Avg tpr: 0.79715, Avg fpr: 0.88449, total FA: 122810

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.83656 | acc=0.1270 | tpr=0.8142 | fpr=0.8854 | 4481.1 samples/s | 17.5 steps/s
[Step= 100] | Loss=6.82038 | acc=0.1271 | tpr=0.7804 | fpr=0.8851 | 7980.9 samples/s | 31.2 steps/s
[Step= 150] | Loss=6.82313 | acc=0.1279 | tpr=0.7896 | fpr=0.8843 | 7819.2 samples/s | 30.5 steps/s
[Step= 200] | Loss=6.81719 | acc=0.1279 | tpr=0.7880 | fpr=0.8841 | 8297.6 samples/s | 32.4 steps/s
[Step= 250] | Loss=6.81465 | acc=0.1289 | tpr=0.7904 | fpr=0.8831 | 8306.3 samples/s | 32.4 steps/s
[Step= 300] | Loss=6.81338 | acc=0.1293 | tpr=0.7956 | fpr=0.8828 | 8040.2 samples/s | 31.4 steps/s
[Step= 350] | Loss=6.82042 | acc=0.1288 | tpr=0.7927 | fpr=0.8832 | 7936.3 samples/s | 31.0 steps/s
[Step= 400] | Loss=6.82414 | acc=0.1289 | tpr=0.7899 | fpr=0.8831 | 7983.8 samples/s | 31.2 steps/s
[Step= 450] | Loss=6.82502 | acc=0.1289 | tpr=0.7877 | fpr=0.8831 | 7208.0 samples/s | 28.2 steps/s
[Step= 500] | Loss=6.82580 | acc=0.1289 | tpr=0.7828 | fpr=0.8829 | 8157.0 samples/s | 31.9 steps/s
[Step= 550] | Loss=6.82478 | acc=0.1292 | tpr=0.7875 | fpr=0.8828 | 12021.6 samples/s | 47.0 steps/s
Avg test loss: 6.82722, Avg test acc: 0.12906, Avg tpr: 0.78764, Avg fpr: 0.88292, total FA: 122591

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.85306 | acc=0.1357 | tpr=0.7920 | fpr=0.8761 | 4808.9 samples/s | 18.8 steps/s
[Step= 100] | Loss=5.82866 | acc=0.1381 | tpr=0.7527 | fpr=0.8733 | 7531.9 samples/s | 29.4 steps/s
[Step= 150] | Loss=5.83928 | acc=0.1396 | tpr=0.7622 | fpr=0.8719 | 7511.4 samples/s | 29.3 steps/s
[Step= 200] | Loss=5.82199 | acc=0.1404 | tpr=0.7628 | fpr=0.8709 | 7716.1 samples/s | 30.1 steps/s
[Step= 250] | Loss=5.81661 | acc=0.1410 | tpr=0.7555 | fpr=0.8702 | 8259.4 samples/s | 32.3 steps/s
[Step= 300] | Loss=5.80871 | acc=0.1411 | tpr=0.7593 | fpr=0.8702 | 8019.0 samples/s | 31.3 steps/s
[Step= 350] | Loss=5.82031 | acc=0.1403 | tpr=0.7564 | fpr=0.8709 | 8078.6 samples/s | 31.6 steps/s
[Step= 400] | Loss=5.82266 | acc=0.1402 | tpr=0.7571 | fpr=0.8710 | 7785.5 samples/s | 30.4 steps/s
[Step= 450] | Loss=5.81925 | acc=0.1406 | tpr=0.7551 | fpr=0.8705 | 8364.3 samples/s | 32.7 steps/s
[Step= 500] | Loss=5.81900 | acc=0.1409 | tpr=0.7537 | fpr=0.8701 | 7237.1 samples/s | 28.3 steps/s
[Step= 550] | Loss=5.81889 | acc=0.1409 | tpr=0.7537 | fpr=0.8702 | 12185.8 samples/s | 47.6 steps/s
Avg test loss: 5.81926, Avg test acc: 0.14081, Avg tpr: 0.75238, Avg fpr: 0.87030, total FA: 120840

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.55512 | acc=0.1270 | tpr=0.8451 | fpr=0.8859 | 4473.7 samples/s | 17.5 steps/s
[Step= 100] | Loss=6.53607 | acc=0.1293 | tpr=0.8571 | fpr=0.8842 | 8078.2 samples/s | 31.6 steps/s
[Step= 150] | Loss=6.54045 | acc=0.1299 | tpr=0.8631 | fpr=0.8836 | 8693.8 samples/s | 34.0 steps/s
[Step= 200] | Loss=6.52892 | acc=0.1300 | tpr=0.8721 | fpr=0.8835 | 7878.8 samples/s | 30.8 steps/s
[Step= 250] | Loss=6.52621 | acc=0.1303 | tpr=0.8716 | fpr=0.8833 | 7874.4 samples/s | 30.8 steps/s
[Step= 300] | Loss=6.52406 | acc=0.1302 | tpr=0.8691 | fpr=0.8833 | 7600.6 samples/s | 29.7 steps/s
[Step= 350] | Loss=6.53275 | acc=0.1296 | tpr=0.8698 | fpr=0.8839 | 8573.3 samples/s | 33.5 steps/s
[Step= 400] | Loss=6.53429 | acc=0.1296 | tpr=0.8638 | fpr=0.8838 | 8320.8 samples/s | 32.5 steps/s
[Step= 450] | Loss=6.53666 | acc=0.1292 | tpr=0.8627 | fpr=0.8841 | 7502.9 samples/s | 29.3 steps/s
[Step= 500] | Loss=6.53853 | acc=0.1293 | tpr=0.8573 | fpr=0.8838 | 8401.7 samples/s | 32.8 steps/s
[Step= 550] | Loss=6.53865 | acc=0.1294 | tpr=0.8611 | fpr=0.8839 | 9957.9 samples/s | 38.9 steps/s
Avg test loss: 6.53954, Avg test acc: 0.12930, Avg tpr: 0.86094, Avg fpr: 0.88400, total FA: 122741

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.86573 | acc=0.1179 | tpr=0.8274 | fpr=0.8949 | 4574.3 samples/s | 17.9 steps/s
[Step= 100] | Loss=6.85102 | acc=0.1196 | tpr=0.8017 | fpr=0.8931 | 8510.4 samples/s | 33.2 steps/s
[Step= 150] | Loss=6.86391 | acc=0.1208 | tpr=0.7997 | fpr=0.8917 | 7236.7 samples/s | 28.3 steps/s
[Step= 200] | Loss=6.85892 | acc=0.1208 | tpr=0.7978 | fpr=0.8915 | 7865.6 samples/s | 30.7 steps/s
[Step= 250] | Loss=6.85935 | acc=0.1215 | tpr=0.7904 | fpr=0.8907 | 7608.1 samples/s | 29.7 steps/s
[Step= 300] | Loss=6.85649 | acc=0.1217 | tpr=0.7949 | fpr=0.8906 | 8299.8 samples/s | 32.4 steps/s
[Step= 350] | Loss=6.86394 | acc=0.1215 | tpr=0.7971 | fpr=0.8908 | 7735.6 samples/s | 30.2 steps/s
[Step= 400] | Loss=6.86665 | acc=0.1212 | tpr=0.7960 | fpr=0.8910 | 8316.2 samples/s | 32.5 steps/s
[Step= 450] | Loss=6.86494 | acc=0.1210 | tpr=0.7955 | fpr=0.8912 | 8078.9 samples/s | 31.6 steps/s
[Step= 500] | Loss=6.87115 | acc=0.1208 | tpr=0.7916 | fpr=0.8913 | 7817.1 samples/s | 30.5 steps/s
[Step= 550] | Loss=6.87101 | acc=0.1212 | tpr=0.7931 | fpr=0.8911 | 11191.9 samples/s | 43.7 steps/s
Avg test loss: 6.87165, Avg test acc: 0.12106, Avg tpr: 0.79279, Avg fpr: 0.89115, total FA: 123734

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19357 | acc=0.9535 | tpr=0.9248 | fpr=0.0460 | 4742.4 samples/s | 18.5 steps/s
[Step= 100] | Loss=0.19857 | acc=0.9530 | tpr=0.9403 | fpr=0.0467 | 7354.2 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.20310 | acc=0.9519 | tpr=0.9438 | fpr=0.0480 | 8088.7 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.20306 | acc=0.9520 | tpr=0.9508 | fpr=0.0480 | 8251.7 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.20465 | acc=0.9520 | tpr=0.9485 | fpr=0.0480 | 7834.0 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.20640 | acc=0.9513 | tpr=0.9455 | fpr=0.0486 | 7802.4 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.20670 | acc=0.9514 | tpr=0.9449 | fpr=0.0485 | 7867.2 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.20802 | acc=0.9511 | tpr=0.9409 | fpr=0.0488 | 7562.0 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.20901 | acc=0.9507 | tpr=0.9382 | fpr=0.0490 | 8573.1 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.20859 | acc=0.9507 | tpr=0.9396 | fpr=0.0491 | 7500.3 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.20768 | acc=0.9509 | tpr=0.9399 | fpr=0.0489 | 12195.2 samples/s | 47.6 steps/s
Avg test loss: 0.20748, Avg test acc: 0.95090, Avg tpr: 0.94017, Avg fpr: 0.04891, total FA: 6791

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12031 | acc=0.9652 | tpr=0.9292 | fpr=0.0341 | 4564.9 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.12378 | acc=0.9649 | tpr=0.9360 | fpr=0.0346 | 8180.4 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.12477 | acc=0.9642 | tpr=0.9337 | fpr=0.0352 | 7529.7 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.12616 | acc=0.9640 | tpr=0.9344 | fpr=0.0355 | 7894.8 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.12769 | acc=0.9637 | tpr=0.9328 | fpr=0.0357 | 7884.9 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.12811 | acc=0.9635 | tpr=0.9331 | fpr=0.0360 | 8344.7 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.12795 | acc=0.9637 | tpr=0.9324 | fpr=0.0358 | 7776.6 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.12893 | acc=0.9632 | tpr=0.9261 | fpr=0.0361 | 7796.7 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.12965 | acc=0.9630 | tpr=0.9236 | fpr=0.0363 | 8486.6 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.12936 | acc=0.9631 | tpr=0.9256 | fpr=0.0362 | 7995.7 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.12926 | acc=0.9631 | tpr=0.9212 | fpr=0.0361 | 10389.9 samples/s | 40.6 steps/s
Avg test loss: 0.12893, Avg test acc: 0.96311, Avg tpr: 0.92155, Avg fpr: 0.03613, total FA: 5017

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.33227 | acc=0.9429 | tpr=0.9204 | fpr=0.0567 | 4716.9 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.33371 | acc=0.9437 | tpr=0.9318 | fpr=0.0561 | 7926.3 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.33934 | acc=0.9428 | tpr=0.9352 | fpr=0.0571 | 7702.9 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.34037 | acc=0.9427 | tpr=0.9399 | fpr=0.0572 | 8383.5 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.34328 | acc=0.9426 | tpr=0.9371 | fpr=0.0573 | 8231.8 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.34708 | acc=0.9420 | tpr=0.9316 | fpr=0.0578 | 7966.3 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.34751 | acc=0.9420 | tpr=0.9317 | fpr=0.0578 | 7370.1 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.34919 | acc=0.9418 | tpr=0.9294 | fpr=0.0579 | 8191.9 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.35159 | acc=0.9415 | tpr=0.9284 | fpr=0.0582 | 7996.5 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.35174 | acc=0.9414 | tpr=0.9317 | fpr=0.0585 | 8109.7 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.35104 | acc=0.9415 | tpr=0.9288 | fpr=0.0582 | 9885.0 samples/s | 38.6 steps/s
Avg test loss: 0.35060, Avg test acc: 0.94157, Avg tpr: 0.92908, Avg fpr: 0.05821, total FA: 8082

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11950 | acc=0.9677 | tpr=0.9071 | fpr=0.0312 | 4794.9 samples/s | 18.7 steps/s
[Step= 100] | Loss=0.12217 | acc=0.9665 | tpr=0.9104 | fpr=0.0325 | 7615.2 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.12661 | acc=0.9655 | tpr=0.9179 | fpr=0.0336 | 7515.8 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.12593 | acc=0.9659 | tpr=0.9279 | fpr=0.0334 | 7234.0 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.12754 | acc=0.9656 | tpr=0.9249 | fpr=0.0336 | 8447.8 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.12882 | acc=0.9654 | tpr=0.9244 | fpr=0.0339 | 8412.8 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.12991 | acc=0.9652 | tpr=0.9261 | fpr=0.0340 | 8175.1 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.13072 | acc=0.9650 | tpr=0.9223 | fpr=0.0342 | 7756.6 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.13201 | acc=0.9648 | tpr=0.9202 | fpr=0.0344 | 8038.9 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.13162 | acc=0.9649 | tpr=0.9238 | fpr=0.0344 | 8209.7 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.13104 | acc=0.9650 | tpr=0.9228 | fpr=0.0342 | 10230.6 samples/s | 40.0 steps/s
Avg test loss: 0.13082, Avg test acc: 0.96506, Avg tpr: 0.92274, Avg fpr: 0.03417, total FA: 4744

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21452 | acc=0.9581 | tpr=0.9204 | fpr=0.0412 | 4634.4 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.21828 | acc=0.9565 | tpr=0.9339 | fpr=0.0431 | 8376.3 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.22031 | acc=0.9556 | tpr=0.9380 | fpr=0.0441 | 7581.1 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.22136 | acc=0.9562 | tpr=0.9454 | fpr=0.0436 | 8450.0 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.22332 | acc=0.9560 | tpr=0.9424 | fpr=0.0437 | 7453.0 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.22564 | acc=0.9555 | tpr=0.9418 | fpr=0.0443 | 8351.5 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.22547 | acc=0.9556 | tpr=0.9411 | fpr=0.0441 | 8405.2 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.22633 | acc=0.9553 | tpr=0.9338 | fpr=0.0443 | 8205.5 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.22674 | acc=0.9550 | tpr=0.9328 | fpr=0.0446 | 7327.7 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.22694 | acc=0.9549 | tpr=0.9348 | fpr=0.0447 | 8728.9 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.22608 | acc=0.9550 | tpr=0.9324 | fpr=0.0446 | 9061.8 samples/s | 35.4 steps/s
Avg test loss: 0.22576, Avg test acc: 0.95509, Avg tpr: 0.93265, Avg fpr: 0.04450, total FA: 6179

server round 16/50

clients selected: [0 3 5 6 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=107.3] | Loss=0.03379 | Reg=0.00140 | acc=0.9531 | L2-Norm=11.831 | L2-Norm(final)=12.578 | 3328.4 samples/s | 52.0 steps/s
[Step=22050 Epoch=107.5] | Loss=0.05194 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.830 | L2-Norm(final)=12.571 | 4578.6 samples/s | 71.5 steps/s
[Step=22100 Epoch=107.8] | Loss=0.04569 | Reg=0.00140 | acc=0.9531 | L2-Norm=11.830 | L2-Norm(final)=12.582 | 5409.0 samples/s | 84.5 steps/s
[Step=22150 Epoch=108.0] | Loss=0.04451 | Reg=0.00140 | acc=0.9531 | L2-Norm=11.829 | L2-Norm(final)=12.600 | 5460.3 samples/s | 85.3 steps/s
[Step=22200 Epoch=108.3] | Loss=0.04553 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.829 | L2-Norm(final)=12.613 | 8580.3 samples/s | 134.1 steps/s
[Step=22250 Epoch=108.5] | Loss=0.04534 | Reg=0.00140 | acc=0.9219 | L2-Norm=11.829 | L2-Norm(final)=12.620 | 1480.6 samples/s | 23.1 steps/s
[Step=22300 Epoch=108.7] | Loss=0.04519 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.829 | L2-Norm(final)=12.630 | 5518.5 samples/s | 86.2 steps/s
[Step=22350 Epoch=109.0] | Loss=0.04537 | Reg=0.00140 | acc=0.9375 | L2-Norm=11.829 | L2-Norm(final)=12.640 | 5393.8 samples/s | 84.3 steps/s
[Step=22400 Epoch=109.2] | Loss=0.04542 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.829 | L2-Norm(final)=12.648 | 7639.4 samples/s | 119.4 steps/s
[Step=22450 Epoch=109.5] | Loss=0.04523 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.829 | L2-Norm(final)=12.658 | 1530.4 samples/s | 23.9 steps/s
[Step=22500 Epoch=109.7] | Loss=0.04557 | Reg=0.00140 | acc=0.9531 | L2-Norm=11.829 | L2-Norm(final)=12.668 | 5356.0 samples/s | 83.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=109.7] | Loss=0.08524 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.829 | L2-Norm(final)=12.760 | 3180.0 samples/s | 49.7 steps/s
[Step=22550 Epoch=110.0] | Loss=0.04824 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.923 | L2-Norm(final)=12.751 | 4248.2 samples/s | 66.4 steps/s
[Step=22600 Epoch=110.2] | Loss=0.05188 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.037 | L2-Norm(final)=12.726 | 4769.7 samples/s | 74.5 steps/s
[Step=22650 Epoch=110.4] | Loss=0.04593 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.112 | L2-Norm(final)=12.717 | 4613.1 samples/s | 72.1 steps/s
[Step=22700 Epoch=110.7] | Loss=0.04289 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.169 | L2-Norm(final)=12.712 | 6738.2 samples/s | 105.3 steps/s
[Step=22750 Epoch=110.9] | Loss=0.03868 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.216 | L2-Norm(final)=12.710 | 1410.6 samples/s | 22.0 steps/s
[Step=22800 Epoch=111.2] | Loss=0.03516 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=12.709 | 4715.0 samples/s | 73.7 steps/s
[Step=22850 Epoch=111.4] | Loss=0.03258 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=12.710 | 4690.3 samples/s | 73.3 steps/s
[Step=22900 Epoch=111.7] | Loss=0.03121 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.314 | L2-Norm(final)=12.710 | 6078.4 samples/s | 95.0 steps/s
[Step=22950 Epoch=111.9] | Loss=0.02908 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.340 | L2-Norm(final)=12.711 | 1420.3 samples/s | 22.2 steps/s
[Step=23000 Epoch=112.2] | Loss=0.02727 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.364 | L2-Norm(final)=12.713 | 4709.6 samples/s | 73.6 steps/s
[Step=23050 Epoch=112.4] | Loss=0.02572 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.386 | L2-Norm(final)=12.716 | 4727.1 samples/s | 73.9 steps/s
[Step=23100 Epoch=112.6] | Loss=0.02463 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.406 | L2-Norm(final)=12.718 | 5553.6 samples/s | 86.8 steps/s
[Step=23150 Epoch=112.9] | Loss=0.02372 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=12.720 | 1465.4 samples/s | 22.9 steps/s
[Step=23200 Epoch=113.1] | Loss=0.02268 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=12.721 | 4774.8 samples/s | 74.6 steps/s
[Step=23250 Epoch=113.4] | Loss=0.02161 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.454 | L2-Norm(final)=12.724 | 4616.5 samples/s | 72.1 steps/s
[Step=23300 Epoch=113.6] | Loss=0.02098 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.467 | L2-Norm(final)=12.726 | 5200.2 samples/s | 81.3 steps/s
[Step=23350 Epoch=113.9] | Loss=0.02030 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.480 | L2-Norm(final)=12.728 | 1497.8 samples/s | 23.4 steps/s
[Step=23400 Epoch=114.1] | Loss=0.01964 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.492 | L2-Norm(final)=12.730 | 4665.3 samples/s | 72.9 steps/s
[Step=23450 Epoch=114.3] | Loss=0.01894 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.503 | L2-Norm(final)=12.732 | 4737.0 samples/s | 74.0 steps/s
[Step=23500 Epoch=114.6] | Loss=0.01845 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.514 | L2-Norm(final)=12.734 | 4804.2 samples/s | 75.1 steps/s
[Step=23550 Epoch=114.8] | Loss=0.01779 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.523 | L2-Norm(final)=12.736 | 1532.3 samples/s | 23.9 steps/s
[Step=23600 Epoch=115.1] | Loss=0.01716 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.532 | L2-Norm(final)=12.738 | 4705.6 samples/s | 73.5 steps/s
[Step=23650 Epoch=115.3] | Loss=0.01666 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.540 | L2-Norm(final)=12.740 | 4740.3 samples/s | 74.1 steps/s
[Step=23700 Epoch=115.6] | Loss=0.01626 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.547 | L2-Norm(final)=12.742 | 4688.8 samples/s | 73.3 steps/s
[Step=23750 Epoch=115.8] | Loss=0.01582 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.554 | L2-Norm(final)=12.744 | 1561.6 samples/s | 24.4 steps/s
[Step=23800 Epoch=116.1] | Loss=0.01542 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.560 | L2-Norm(final)=12.746 | 4706.5 samples/s | 73.5 steps/s
[Step=23850 Epoch=116.3] | Loss=0.01503 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.567 | L2-Norm(final)=12.748 | 4696.2 samples/s | 73.4 steps/s
[Step=23900 Epoch=116.5] | Loss=0.01460 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.572 | L2-Norm(final)=12.750 | 4726.4 samples/s | 73.8 steps/s
[Step=23950 Epoch=116.8] | Loss=0.01419 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=12.753 | 1531.8 samples/s | 23.9 steps/s
[Step=24000 Epoch=117.0] | Loss=0.01379 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.582 | L2-Norm(final)=12.755 | 4684.2 samples/s | 73.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step24000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=107.3] | Loss=0.02670 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.831 | L2-Norm(final)=14.000 | 3144.3 samples/s | 49.1 steps/s
[Step=22050 Epoch=107.5] | Loss=0.03923 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.833 | L2-Norm(final)=14.007 | 4916.1 samples/s | 76.8 steps/s
[Step=22100 Epoch=107.8] | Loss=0.03889 | Reg=0.00140 | acc=0.9219 | L2-Norm=11.833 | L2-Norm(final)=14.011 | 5467.8 samples/s | 85.4 steps/s
[Step=22150 Epoch=108.0] | Loss=0.04105 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.833 | L2-Norm(final)=14.016 | 5401.9 samples/s | 84.4 steps/s
[Step=22200 Epoch=108.3] | Loss=0.03984 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.833 | L2-Norm(final)=14.020 | 8594.9 samples/s | 134.3 steps/s
[Step=22250 Epoch=108.5] | Loss=0.04091 | Reg=0.00140 | acc=0.9531 | L2-Norm=11.833 | L2-Norm(final)=14.028 | 1504.4 samples/s | 23.5 steps/s
[Step=22300 Epoch=108.7] | Loss=0.03995 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.833 | L2-Norm(final)=14.034 | 5193.3 samples/s | 81.1 steps/s
[Step=22350 Epoch=109.0] | Loss=0.04006 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.833 | L2-Norm(final)=14.042 | 5504.0 samples/s | 86.0 steps/s
[Step=22400 Epoch=109.2] | Loss=0.03954 | Reg=0.00140 | acc=0.9375 | L2-Norm=11.833 | L2-Norm(final)=14.050 | 7582.3 samples/s | 118.5 steps/s
[Step=22450 Epoch=109.5] | Loss=0.03940 | Reg=0.00140 | acc=0.9219 | L2-Norm=11.833 | L2-Norm(final)=14.058 | 1518.9 samples/s | 23.7 steps/s
[Step=22500 Epoch=109.7] | Loss=0.03941 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.833 | L2-Norm(final)=14.066 | 5681.1 samples/s | 88.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=109.7] | Loss=0.03032 | Reg=0.00140 | acc=0.9531 | L2-Norm=11.833 | L2-Norm(final)=14.139 | 3210.5 samples/s | 50.2 steps/s
[Step=22550 Epoch=110.0] | Loss=0.04567 | Reg=0.00142 | acc=0.9531 | L2-Norm=11.923 | L2-Norm(final)=14.134 | 4233.1 samples/s | 66.1 steps/s
[Step=22600 Epoch=110.2] | Loss=0.04428 | Reg=0.00145 | acc=0.9531 | L2-Norm=12.023 | L2-Norm(final)=14.120 | 4743.9 samples/s | 74.1 steps/s
[Step=22650 Epoch=110.5] | Loss=0.04441 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.092 | L2-Norm(final)=14.107 | 4638.2 samples/s | 72.5 steps/s
[Step=22700 Epoch=110.7] | Loss=0.04223 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=14.100 | 6688.5 samples/s | 104.5 steps/s
[Step=22750 Epoch=110.9] | Loss=0.03761 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.192 | L2-Norm(final)=14.096 | 1392.4 samples/s | 21.8 steps/s
[Step=22800 Epoch=111.2] | Loss=0.03433 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.229 | L2-Norm(final)=14.094 | 4702.2 samples/s | 73.5 steps/s
[Step=22850 Epoch=111.4] | Loss=0.03158 | Reg=0.00150 | acc=0.9531 | L2-Norm=12.261 | L2-Norm(final)=14.094 | 4779.2 samples/s | 74.7 steps/s
[Step=22900 Epoch=111.7] | Loss=0.02970 | Reg=0.00151 | acc=0.9375 | L2-Norm=12.288 | L2-Norm(final)=14.094 | 6023.6 samples/s | 94.1 steps/s
[Step=22950 Epoch=111.9] | Loss=0.02781 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=14.094 | 1436.7 samples/s | 22.4 steps/s
[Step=23000 Epoch=112.2] | Loss=0.02614 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.337 | L2-Norm(final)=14.095 | 4721.0 samples/s | 73.8 steps/s
[Step=23050 Epoch=112.4] | Loss=0.02449 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.357 | L2-Norm(final)=14.097 | 4657.5 samples/s | 72.8 steps/s
[Step=23100 Epoch=112.6] | Loss=0.02367 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.375 | L2-Norm(final)=14.098 | 5562.6 samples/s | 86.9 steps/s
[Step=23150 Epoch=112.9] | Loss=0.02253 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.391 | L2-Norm(final)=14.099 | 1486.6 samples/s | 23.2 steps/s
[Step=23200 Epoch=113.1] | Loss=0.02137 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.407 | L2-Norm(final)=14.100 | 4690.3 samples/s | 73.3 steps/s
[Step=23250 Epoch=113.4] | Loss=0.02051 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.420 | L2-Norm(final)=14.102 | 4677.3 samples/s | 73.1 steps/s
[Step=23300 Epoch=113.6] | Loss=0.01995 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.434 | L2-Norm(final)=14.103 | 5218.4 samples/s | 81.5 steps/s
[Step=23350 Epoch=113.9] | Loss=0.01925 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.446 | L2-Norm(final)=14.104 | 1526.9 samples/s | 23.9 steps/s
[Step=23400 Epoch=114.1] | Loss=0.01846 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=14.106 | 4679.9 samples/s | 73.1 steps/s
[Step=23450 Epoch=114.4] | Loss=0.01795 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.468 | L2-Norm(final)=14.108 | 4668.1 samples/s | 72.9 steps/s
[Step=23500 Epoch=114.6] | Loss=0.01738 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=14.109 | 4849.3 samples/s | 75.8 steps/s
[Step=23550 Epoch=114.8] | Loss=0.01674 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=14.111 | 1541.4 samples/s | 24.1 steps/s
[Step=23600 Epoch=115.1] | Loss=0.01621 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=14.112 | 4692.5 samples/s | 73.3 steps/s
[Step=23650 Epoch=115.3] | Loss=0.01577 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.505 | L2-Norm(final)=14.114 | 4799.2 samples/s | 75.0 steps/s
[Step=23700 Epoch=115.6] | Loss=0.01534 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.512 | L2-Norm(final)=14.115 | 4622.3 samples/s | 72.2 steps/s
[Step=23750 Epoch=115.8] | Loss=0.01496 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=14.117 | 1560.4 samples/s | 24.4 steps/s
[Step=23800 Epoch=116.1] | Loss=0.01452 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=14.118 | 4700.9 samples/s | 73.5 steps/s
[Step=23850 Epoch=116.3] | Loss=0.01419 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.531 | L2-Norm(final)=14.120 | 4723.9 samples/s | 73.8 steps/s
[Step=23900 Epoch=116.5] | Loss=0.01377 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=14.121 | 4685.2 samples/s | 73.2 steps/s
[Step=23950 Epoch=116.8] | Loss=0.01343 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.542 | L2-Norm(final)=14.123 | 1537.4 samples/s | 24.0 steps/s
[Step=24000 Epoch=117.0] | Loss=0.01304 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.547 | L2-Norm(final)=14.125 | 4681.7 samples/s | 73.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step24000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=189.5] | Loss=0.00115 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.831 | L2-Norm(final)=15.732 | 3034.9 samples/s | 47.4 steps/s
[Step=20050 Epoch=190.0] | Loss=0.00340 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.827 | L2-Norm(final)=15.743 | 4713.0 samples/s | 73.6 steps/s
[Step=20100 Epoch=190.5] | Loss=0.00318 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=15.762 | 8145.8 samples/s | 127.3 steps/s
[Step=20150 Epoch=190.9] | Loss=0.00293 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=15.784 | 1417.0 samples/s | 22.1 steps/s
[Step=20200 Epoch=191.4] | Loss=0.00300 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=15.802 | 7262.5 samples/s | 113.5 steps/s
[Step=20250 Epoch=191.9] | Loss=0.00302 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.826 | L2-Norm(final)=15.820 | 1493.0 samples/s | 23.3 steps/s
[Step=20300 Epoch=192.4] | Loss=0.00302 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=15.838 | 6297.5 samples/s | 98.4 steps/s
[Step=20350 Epoch=192.8] | Loss=0.00287 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=15.855 | 1533.8 samples/s | 24.0 steps/s
[Step=20400 Epoch=193.3] | Loss=0.00293 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=15.872 | 5782.1 samples/s | 90.3 steps/s
[Step=20450 Epoch=193.8] | Loss=0.00299 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.826 | L2-Norm(final)=15.890 | 1597.8 samples/s | 25.0 steps/s
[Step=20500 Epoch=194.3] | Loss=0.00293 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=15.908 | 5282.4 samples/s | 82.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=194.3] | Loss=0.00654 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.826 | L2-Norm(final)=16.089 | 3278.0 samples/s | 51.2 steps/s
[Step=20550 Epoch=194.7] | Loss=0.00736 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.950 | L2-Norm(final)=16.073 | 3824.2 samples/s | 59.8 steps/s
[Step=20600 Epoch=195.2] | Loss=0.00548 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.041 | L2-Norm(final)=16.067 | 6500.2 samples/s | 101.6 steps/s
[Step=20650 Epoch=195.7] | Loss=0.00420 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.097 | L2-Norm(final)=16.066 | 1364.9 samples/s | 21.3 steps/s
[Step=20700 Epoch=196.2] | Loss=0.00324 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=16.068 | 5860.7 samples/s | 91.6 steps/s
[Step=20750 Epoch=196.6] | Loss=0.00260 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=16.070 | 1412.8 samples/s | 22.1 steps/s
[Step=20800 Epoch=197.1] | Loss=0.00217 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=16.072 | 5403.7 samples/s | 84.4 steps/s
[Step=20850 Epoch=197.6] | Loss=0.00186 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=16.073 | 1451.6 samples/s | 22.7 steps/s
[Step=20900 Epoch=198.0] | Loss=0.00163 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=16.075 | 4889.6 samples/s | 76.4 steps/s
[Step=20950 Epoch=198.5] | Loss=0.00145 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=16.076 | 1501.0 samples/s | 23.5 steps/s
[Step=21000 Epoch=199.0] | Loss=0.00130 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=16.077 | 4556.0 samples/s | 71.2 steps/s
[Step=21050 Epoch=199.5] | Loss=0.00119 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=16.077 | 1530.4 samples/s | 23.9 steps/s
[Step=21100 Epoch=199.9] | Loss=0.00109 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.125 | L2-Norm(final)=16.078 | 4506.0 samples/s | 70.4 steps/s
[Step=21150 Epoch=200.4] | Loss=0.00100 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.114 | L2-Norm(final)=16.079 | 1535.3 samples/s | 24.0 steps/s
[Step=21200 Epoch=200.9] | Loss=0.00093 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.103 | L2-Norm(final)=16.079 | 4437.6 samples/s | 69.3 steps/s
[Step=21250 Epoch=201.4] | Loss=0.00087 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.091 | L2-Norm(final)=16.080 | 1533.7 samples/s | 24.0 steps/s
[Step=21300 Epoch=201.8] | Loss=0.00082 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.079 | L2-Norm(final)=16.080 | 4489.6 samples/s | 70.2 steps/s
[Step=21350 Epoch=202.3] | Loss=0.00077 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.067 | L2-Norm(final)=16.081 | 1606.1 samples/s | 25.1 steps/s
[Step=21400 Epoch=202.8] | Loss=0.00073 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.055 | L2-Norm(final)=16.081 | 4113.9 samples/s | 64.3 steps/s
[Step=21450 Epoch=203.3] | Loss=0.00069 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.043 | L2-Norm(final)=16.082 | 6773.8 samples/s | 105.8 steps/s
[Step=21500 Epoch=203.7] | Loss=0.00065 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.030 | L2-Norm(final)=16.082 | 1362.9 samples/s | 21.3 steps/s
[Step=21550 Epoch=204.2] | Loss=0.00062 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.018 | L2-Norm(final)=16.083 | 6134.0 samples/s | 95.8 steps/s
[Step=21600 Epoch=204.7] | Loss=0.00059 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.005 | L2-Norm(final)=16.083 | 1407.6 samples/s | 22.0 steps/s
[Step=21650 Epoch=205.2] | Loss=0.00057 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.992 | L2-Norm(final)=16.083 | 5386.8 samples/s | 84.2 steps/s
[Step=21700 Epoch=205.6] | Loss=0.00054 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.979 | L2-Norm(final)=16.084 | 1430.1 samples/s | 22.3 steps/s
[Step=21750 Epoch=206.1] | Loss=0.00052 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.967 | L2-Norm(final)=16.084 | 5079.3 samples/s | 79.4 steps/s
[Step=21800 Epoch=206.6] | Loss=0.00050 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.954 | L2-Norm(final)=16.084 | 1460.1 samples/s | 22.8 steps/s
[Step=21850 Epoch=207.0] | Loss=0.00048 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.941 | L2-Norm(final)=16.085 | 4703.6 samples/s | 73.5 steps/s
[Step=21900 Epoch=207.5] | Loss=0.00047 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.928 | L2-Norm(final)=16.085 | 1499.3 samples/s | 23.4 steps/s
[Step=21950 Epoch=208.0] | Loss=0.00045 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.915 | L2-Norm(final)=16.085 | 4394.8 samples/s | 68.7 steps/s
[Step=22000 Epoch=208.5] | Loss=0.00044 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=16.086 | 1514.3 samples/s | 23.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step22000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=133.2] | Loss=0.00030 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.831 | L2-Norm(final)=10.728 | 3171.8 samples/s | 49.6 steps/s
[Step=14050 Epoch=133.7] | Loss=0.00443 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.825 | L2-Norm(final)=10.766 | 4353.4 samples/s | 68.0 steps/s
[Step=14100 Epoch=134.1] | Loss=0.00471 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=10.805 | 8070.6 samples/s | 126.1 steps/s
[Step=14150 Epoch=134.6] | Loss=0.00442 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=10.835 | 1433.8 samples/s | 22.4 steps/s
[Step=14200 Epoch=135.1] | Loss=0.00449 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=10.870 | 7351.6 samples/s | 114.9 steps/s
[Step=14250 Epoch=135.6] | Loss=0.00436 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=10.903 | 1472.1 samples/s | 23.0 steps/s
[Step=14300 Epoch=136.0] | Loss=0.00443 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=10.935 | 6120.4 samples/s | 95.6 steps/s
[Step=14350 Epoch=136.5] | Loss=0.00450 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=10.965 | 1518.9 samples/s | 23.7 steps/s
[Step=14400 Epoch=137.0] | Loss=0.00460 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=10.994 | 5942.2 samples/s | 92.8 steps/s
[Step=14450 Epoch=137.5] | Loss=0.00445 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=11.023 | 1534.3 samples/s | 24.0 steps/s
[Step=14500 Epoch=137.9] | Loss=0.00447 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=11.052 | 5388.2 samples/s | 84.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=137.9] | Loss=0.00036 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.823 | L2-Norm(final)=11.341 | 3131.1 samples/s | 48.9 steps/s
[Step=14550 Epoch=138.4] | Loss=0.00707 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.026 | L2-Norm(final)=11.341 | 4057.4 samples/s | 63.4 steps/s
[Step=14600 Epoch=138.9] | Loss=0.00475 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.187 | L2-Norm(final)=11.342 | 6519.3 samples/s | 101.9 steps/s
[Step=14650 Epoch=139.4] | Loss=0.00343 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=11.345 | 1367.5 samples/s | 21.4 steps/s
[Step=14700 Epoch=139.8] | Loss=0.00307 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=11.346 | 5957.6 samples/s | 93.1 steps/s
[Step=14750 Epoch=140.3] | Loss=0.00302 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=11.342 | 1401.4 samples/s | 21.9 steps/s
[Step=14800 Epoch=140.8] | Loss=0.00280 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=11.338 | 5384.7 samples/s | 84.1 steps/s
[Step=14850 Epoch=141.3] | Loss=0.00241 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.349 | L2-Norm(final)=11.336 | 1436.3 samples/s | 22.4 steps/s
[Step=14900 Epoch=141.7] | Loss=0.00212 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.356 | L2-Norm(final)=11.335 | 4958.7 samples/s | 77.5 steps/s
[Step=14950 Epoch=142.2] | Loss=0.00188 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.358 | L2-Norm(final)=11.334 | 1496.8 samples/s | 23.4 steps/s
[Step=15000 Epoch=142.7] | Loss=0.00170 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.356 | L2-Norm(final)=11.334 | 4625.3 samples/s | 72.3 steps/s
[Step=15050 Epoch=143.2] | Loss=0.00154 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.352 | L2-Norm(final)=11.333 | 1505.6 samples/s | 23.5 steps/s
[Step=15100 Epoch=143.6] | Loss=0.00142 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.346 | L2-Norm(final)=11.333 | 4495.9 samples/s | 70.2 steps/s
[Step=15150 Epoch=144.1] | Loss=0.00131 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.338 | L2-Norm(final)=11.333 | 1546.3 samples/s | 24.2 steps/s
[Step=15200 Epoch=144.6] | Loss=0.00121 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.330 | L2-Norm(final)=11.334 | 4476.9 samples/s | 70.0 steps/s
[Step=15250 Epoch=145.1] | Loss=0.00113 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.321 | L2-Norm(final)=11.334 | 1538.9 samples/s | 24.0 steps/s
[Step=15300 Epoch=145.5] | Loss=0.00106 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=11.335 | 4534.0 samples/s | 70.8 steps/s
[Step=15350 Epoch=146.0] | Loss=0.00100 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.300 | L2-Norm(final)=11.335 | 1543.1 samples/s | 24.1 steps/s
[Step=15400 Epoch=146.5] | Loss=0.00095 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.289 | L2-Norm(final)=11.336 | 4369.5 samples/s | 68.3 steps/s
[Step=15450 Epoch=147.0] | Loss=0.00090 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.278 | L2-Norm(final)=11.337 | 6741.0 samples/s | 105.3 steps/s
[Step=15500 Epoch=147.4] | Loss=0.00085 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.267 | L2-Norm(final)=11.337 | 1361.9 samples/s | 21.3 steps/s
[Step=15550 Epoch=147.9] | Loss=0.00081 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.255 | L2-Norm(final)=11.338 | 6145.8 samples/s | 96.0 steps/s
[Step=15600 Epoch=148.4] | Loss=0.00077 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.243 | L2-Norm(final)=11.339 | 1435.4 samples/s | 22.4 steps/s
[Step=15650 Epoch=148.9] | Loss=0.00074 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.231 | L2-Norm(final)=11.340 | 5477.1 samples/s | 85.6 steps/s
[Step=15700 Epoch=149.3] | Loss=0.00071 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=11.341 | 1435.7 samples/s | 22.4 steps/s
[Step=15750 Epoch=149.8] | Loss=0.00068 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.207 | L2-Norm(final)=11.342 | 5151.8 samples/s | 80.5 steps/s
[Step=15800 Epoch=150.3] | Loss=0.00066 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=11.343 | 1461.7 samples/s | 22.8 steps/s
[Step=15850 Epoch=150.8] | Loss=0.00063 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=11.345 | 4652.8 samples/s | 72.7 steps/s
[Step=15900 Epoch=151.2] | Loss=0.00061 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=11.346 | 1496.6 samples/s | 23.4 steps/s
[Step=15950 Epoch=151.7] | Loss=0.00059 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=11.347 | 4470.4 samples/s | 69.9 steps/s
[Step=16000 Epoch=152.2] | Loss=0.00057 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=11.348 | 1550.1 samples/s | 24.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step16000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=191.0] | Loss=0.00146 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.831 | L2-Norm(final)=14.394 | 3154.3 samples/s | 49.3 steps/s
[Step=20050 Epoch=191.5] | Loss=0.00179 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=14.418 | 4444.7 samples/s | 69.4 steps/s
[Step=20100 Epoch=191.9] | Loss=0.00148 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=14.444 | 8322.4 samples/s | 130.0 steps/s
[Step=20150 Epoch=192.4] | Loss=0.00136 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.826 | L2-Norm(final)=14.467 | 1464.5 samples/s | 22.9 steps/s
[Step=20200 Epoch=192.9] | Loss=0.00140 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=14.490 | 7441.5 samples/s | 116.3 steps/s
[Step=20250 Epoch=193.4] | Loss=0.00130 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=14.514 | 1454.8 samples/s | 22.7 steps/s
[Step=20300 Epoch=193.9] | Loss=0.00138 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=14.537 | 6743.3 samples/s | 105.4 steps/s
[Step=20350 Epoch=194.3] | Loss=0.00131 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=14.560 | 1480.7 samples/s | 23.1 steps/s
[Step=20400 Epoch=194.8] | Loss=0.00132 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=14.582 | 6215.7 samples/s | 97.1 steps/s
[Step=20450 Epoch=195.3] | Loss=0.00129 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=14.604 | 1555.4 samples/s | 24.3 steps/s
[Step=20500 Epoch=195.8] | Loss=0.00130 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=14.625 | 5753.1 samples/s | 89.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=195.8] | Loss=0.00091 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.825 | L2-Norm(final)=14.838 | 3133.7 samples/s | 49.0 steps/s
[Step=20550 Epoch=196.2] | Loss=0.00956 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.908 | L2-Norm(final)=14.836 | 4116.5 samples/s | 64.3 steps/s
[Step=20600 Epoch=196.7] | Loss=0.00779 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.080 | L2-Norm(final)=14.798 | 6463.8 samples/s | 101.0 steps/s
[Step=20650 Epoch=197.2] | Loss=0.00536 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=14.782 | 1432.9 samples/s | 22.4 steps/s
[Step=20700 Epoch=197.7] | Loss=0.00404 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=14.775 | 6040.9 samples/s | 94.4 steps/s
[Step=20750 Epoch=198.1] | Loss=0.00324 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.186 | L2-Norm(final)=14.772 | 1394.4 samples/s | 21.8 steps/s
[Step=20800 Epoch=198.6] | Loss=0.00270 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.187 | L2-Norm(final)=14.769 | 5491.2 samples/s | 85.8 steps/s
[Step=20850 Epoch=199.1] | Loss=0.00231 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=14.768 | 1388.0 samples/s | 21.7 steps/s
[Step=20900 Epoch=199.6] | Loss=0.00203 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=14.767 | 5139.6 samples/s | 80.3 steps/s
[Step=20950 Epoch=200.1] | Loss=0.00180 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=14.767 | 1442.6 samples/s | 22.5 steps/s
[Step=21000 Epoch=200.5] | Loss=0.00162 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=14.766 | 4802.2 samples/s | 75.0 steps/s
[Step=21050 Epoch=201.0] | Loss=0.00148 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=14.766 | 1454.4 samples/s | 22.7 steps/s
[Step=21100 Epoch=201.5] | Loss=0.00135 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=14.766 | 4540.6 samples/s | 70.9 steps/s
[Step=21150 Epoch=202.0] | Loss=0.00125 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.124 | L2-Norm(final)=14.766 | 1475.6 samples/s | 23.1 steps/s
[Step=21200 Epoch=202.4] | Loss=0.00116 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.112 | L2-Norm(final)=14.766 | 4461.8 samples/s | 69.7 steps/s
[Step=21250 Epoch=202.9] | Loss=0.00108 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=14.766 | 1507.7 samples/s | 23.6 steps/s
[Step=21300 Epoch=203.4] | Loss=0.00102 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.088 | L2-Norm(final)=14.766 | 4479.4 samples/s | 70.0 steps/s
[Step=21350 Epoch=203.9] | Loss=0.00096 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.076 | L2-Norm(final)=14.766 | 1493.4 samples/s | 23.3 steps/s
[Step=21400 Epoch=204.4] | Loss=0.00090 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.064 | L2-Norm(final)=14.767 | 4439.2 samples/s | 69.4 steps/s
[Step=21450 Epoch=204.8] | Loss=0.00086 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.051 | L2-Norm(final)=14.767 | 1511.9 samples/s | 23.6 steps/s
[Step=21500 Epoch=205.3] | Loss=0.00081 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.039 | L2-Norm(final)=14.767 | 4461.7 samples/s | 69.7 steps/s
[Step=21550 Epoch=205.8] | Loss=0.00077 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.026 | L2-Norm(final)=14.767 | 6993.0 samples/s | 109.3 steps/s
[Step=21600 Epoch=206.3] | Loss=0.00074 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.014 | L2-Norm(final)=14.768 | 1313.0 samples/s | 20.5 steps/s
[Step=21650 Epoch=206.7] | Loss=0.00071 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.001 | L2-Norm(final)=14.768 | 6541.5 samples/s | 102.2 steps/s
[Step=21700 Epoch=207.2] | Loss=0.00068 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.989 | L2-Norm(final)=14.768 | 1342.8 samples/s | 21.0 steps/s
[Step=21750 Epoch=207.7] | Loss=0.00065 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.976 | L2-Norm(final)=14.769 | 5843.4 samples/s | 91.3 steps/s
[Step=21800 Epoch=208.2] | Loss=0.00063 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.964 | L2-Norm(final)=14.769 | 1378.5 samples/s | 21.5 steps/s
[Step=21850 Epoch=208.7] | Loss=0.00060 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.951 | L2-Norm(final)=14.769 | 5559.7 samples/s | 86.9 steps/s
[Step=21900 Epoch=209.1] | Loss=0.00058 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.939 | L2-Norm(final)=14.770 | 1387.3 samples/s | 21.7 steps/s
[Step=21950 Epoch=209.6] | Loss=0.00056 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.926 | L2-Norm(final)=14.770 | 5160.7 samples/s | 80.6 steps/s
[Step=22000 Epoch=210.1] | Loss=0.00054 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.914 | L2-Norm(final)=14.771 | 1428.9 samples/s | 22.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step22000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.13256 | acc=0.9514 | tpr=0.9720 | fpr=0.0934 | 4654.3 samples/s | 18.2 steps/s
Avg test loss: 0.14063, Avg test acc: 0.94944, Avg tpr: 0.97086, Avg fpr: 0.09768, total FA: 762

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.13479 | acc=0.9495 | tpr=0.9735 | fpr=0.1028 | 4651.8 samples/s | 18.2 steps/s
Avg test loss: 0.13693, Avg test acc: 0.94799, Avg tpr: 0.97371, Avg fpr: 0.10858, total FA: 847

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11102 | acc=0.9488 | tpr=0.9604 | fpr=0.0763 | 4618.1 samples/s | 18.0 steps/s
Avg test loss: 0.11593, Avg test acc: 0.94883, Avg tpr: 0.95978, Avg fpr: 0.07525, total FA: 587

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.12736 | acc=0.9501 | tpr=0.9550 | fpr=0.0607 | 4599.0 samples/s | 18.0 steps/s
Avg test loss: 0.13036, Avg test acc: 0.95032, Avg tpr: 0.95623, Avg fpr: 0.06268, total FA: 489

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11692 | acc=0.9533 | tpr=0.9738 | fpr=0.0912 | 4752.1 samples/s | 18.6 steps/s
Avg test loss: 0.12300, Avg test acc: 0.95076, Avg tpr: 0.97202, Avg fpr: 0.09601, total FA: 749

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.28386 | acc=0.3085 | tpr=0.0057 | fpr=0.0339 | 4668.9 samples/s | 18.2 steps/s
Avg test loss: 5.30827, Avg test acc: 0.30603, Avg tpr: 0.00565, Avg fpr: 0.03333, total FA: 260

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.28243 | acc=0.3152 | tpr=0.0257 | fpr=0.0562 | 4712.2 samples/s | 18.4 steps/s
Avg test loss: 4.31269, Avg test acc: 0.31156, Avg tpr: 0.02559, Avg fpr: 0.05948, total FA: 464

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.35563 | acc=0.3071 | tpr=0.0149 | fpr=0.0585 | 4640.8 samples/s | 18.1 steps/s
Avg test loss: 4.37873, Avg test acc: 0.30439, Avg tpr: 0.01457, Avg fpr: 0.05820, total FA: 454

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.11710 | acc=0.3128 | tpr=0.0245 | fpr=0.0612 | 4499.9 samples/s | 17.6 steps/s
Avg test loss: 4.13379, Avg test acc: 0.31164, Avg tpr: 0.02547, Avg fpr: 0.05897, total FA: 460

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.95400 | acc=0.3049 | tpr=0.0164 | fpr=0.0686 | 4677.5 samples/s | 18.3 steps/s
Avg test loss: 4.96477, Avg test acc: 0.30231, Avg tpr: 0.01556, Avg fpr: 0.06704, total FA: 523

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.86347 | acc=0.1269 | tpr=0.8319 | fpr=0.8858 | 4608.1 samples/s | 18.0 steps/s
[Step= 100] | Loss=7.82817 | acc=0.1291 | tpr=0.8081 | fpr=0.8835 | 7890.3 samples/s | 30.8 steps/s
[Step= 150] | Loss=7.84123 | acc=0.1294 | tpr=0.8098 | fpr=0.8831 | 7900.0 samples/s | 30.9 steps/s
[Step= 200] | Loss=7.82602 | acc=0.1290 | tpr=0.8077 | fpr=0.8833 | 8089.7 samples/s | 31.6 steps/s
[Step= 250] | Loss=7.82034 | acc=0.1290 | tpr=0.8061 | fpr=0.8834 | 7920.2 samples/s | 30.9 steps/s
[Step= 300] | Loss=7.81708 | acc=0.1291 | tpr=0.8080 | fpr=0.8832 | 7956.7 samples/s | 31.1 steps/s
[Step= 350] | Loss=7.82625 | acc=0.1289 | tpr=0.8115 | fpr=0.8835 | 8304.3 samples/s | 32.4 steps/s
[Step= 400] | Loss=7.82613 | acc=0.1289 | tpr=0.8107 | fpr=0.8835 | 7944.5 samples/s | 31.0 steps/s
[Step= 450] | Loss=7.82465 | acc=0.1289 | tpr=0.8130 | fpr=0.8835 | 8074.9 samples/s | 31.5 steps/s
[Step= 500] | Loss=7.82600 | acc=0.1291 | tpr=0.8097 | fpr=0.8831 | 7698.7 samples/s | 30.1 steps/s
[Step= 550] | Loss=7.82401 | acc=0.1292 | tpr=0.8114 | fpr=0.8832 | 9971.6 samples/s | 39.0 steps/s
Avg test loss: 7.82408, Avg test acc: 0.12909, Avg tpr: 0.81141, Avg fpr: 0.88331, total FA: 122646

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.83656 | acc=0.1270 | tpr=0.8142 | fpr=0.8854 | 4700.4 samples/s | 18.4 steps/s
[Step= 100] | Loss=6.82038 | acc=0.1271 | tpr=0.7804 | fpr=0.8851 | 7728.0 samples/s | 30.2 steps/s
[Step= 150] | Loss=6.82313 | acc=0.1279 | tpr=0.7896 | fpr=0.8843 | 7618.4 samples/s | 29.8 steps/s
[Step= 200] | Loss=6.81719 | acc=0.1279 | tpr=0.7880 | fpr=0.8841 | 8170.6 samples/s | 31.9 steps/s
[Step= 250] | Loss=6.81465 | acc=0.1289 | tpr=0.7904 | fpr=0.8831 | 7787.1 samples/s | 30.4 steps/s
[Step= 300] | Loss=6.81338 | acc=0.1293 | tpr=0.7956 | fpr=0.8828 | 8394.9 samples/s | 32.8 steps/s
[Step= 350] | Loss=6.82042 | acc=0.1288 | tpr=0.7927 | fpr=0.8832 | 8146.7 samples/s | 31.8 steps/s
[Step= 400] | Loss=6.82414 | acc=0.1289 | tpr=0.7899 | fpr=0.8831 | 7996.5 samples/s | 31.2 steps/s
[Step= 450] | Loss=6.82502 | acc=0.1289 | tpr=0.7877 | fpr=0.8831 | 8075.6 samples/s | 31.5 steps/s
[Step= 500] | Loss=6.82580 | acc=0.1289 | tpr=0.7828 | fpr=0.8829 | 8086.3 samples/s | 31.6 steps/s
[Step= 550] | Loss=6.82478 | acc=0.1292 | tpr=0.7875 | fpr=0.8828 | 9060.2 samples/s | 35.4 steps/s
Avg test loss: 6.82722, Avg test acc: 0.12906, Avg tpr: 0.78764, Avg fpr: 0.88292, total FA: 122591

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.85306 | acc=0.1357 | tpr=0.7920 | fpr=0.8761 | 4501.7 samples/s | 17.6 steps/s
[Step= 100] | Loss=5.82866 | acc=0.1381 | tpr=0.7527 | fpr=0.8733 | 8009.9 samples/s | 31.3 steps/s
[Step= 150] | Loss=5.83928 | acc=0.1396 | tpr=0.7622 | fpr=0.8719 | 8064.1 samples/s | 31.5 steps/s
[Step= 200] | Loss=5.82199 | acc=0.1404 | tpr=0.7628 | fpr=0.8709 | 7920.4 samples/s | 30.9 steps/s
[Step= 250] | Loss=5.81661 | acc=0.1410 | tpr=0.7555 | fpr=0.8702 | 7712.0 samples/s | 30.1 steps/s
[Step= 300] | Loss=5.80871 | acc=0.1411 | tpr=0.7593 | fpr=0.8702 | 7940.8 samples/s | 31.0 steps/s
[Step= 350] | Loss=5.82031 | acc=0.1403 | tpr=0.7564 | fpr=0.8709 | 8004.1 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.82266 | acc=0.1402 | tpr=0.7571 | fpr=0.8710 | 7540.2 samples/s | 29.5 steps/s
[Step= 450] | Loss=5.81925 | acc=0.1406 | tpr=0.7551 | fpr=0.8705 | 7663.8 samples/s | 29.9 steps/s
[Step= 500] | Loss=5.81900 | acc=0.1409 | tpr=0.7537 | fpr=0.8701 | 8253.4 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.81889 | acc=0.1409 | tpr=0.7537 | fpr=0.8702 | 11185.5 samples/s | 43.7 steps/s
Avg test loss: 5.81926, Avg test acc: 0.14081, Avg tpr: 0.75238, Avg fpr: 0.87030, total FA: 120840

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.95066 | acc=0.1497 | tpr=0.7699 | fpr=0.8615 | 4624.8 samples/s | 18.1 steps/s
[Step= 100] | Loss=6.92029 | acc=0.1511 | tpr=0.7505 | fpr=0.8601 | 7903.1 samples/s | 30.9 steps/s
[Step= 150] | Loss=6.92525 | acc=0.1519 | tpr=0.7478 | fpr=0.8591 | 8135.8 samples/s | 31.8 steps/s
[Step= 200] | Loss=6.91252 | acc=0.1520 | tpr=0.7454 | fpr=0.8588 | 8192.2 samples/s | 32.0 steps/s
[Step= 250] | Loss=6.91266 | acc=0.1522 | tpr=0.7432 | fpr=0.8585 | 7525.6 samples/s | 29.4 steps/s
[Step= 300] | Loss=6.90855 | acc=0.1529 | tpr=0.7425 | fpr=0.8578 | 7949.4 samples/s | 31.1 steps/s
[Step= 350] | Loss=6.91988 | acc=0.1522 | tpr=0.7470 | fpr=0.8586 | 7886.5 samples/s | 30.8 steps/s
[Step= 400] | Loss=6.92339 | acc=0.1521 | tpr=0.7429 | fpr=0.8587 | 7952.9 samples/s | 31.1 steps/s
[Step= 450] | Loss=6.92003 | acc=0.1522 | tpr=0.7410 | fpr=0.8585 | 8276.5 samples/s | 32.3 steps/s
[Step= 500] | Loss=6.92233 | acc=0.1525 | tpr=0.7379 | fpr=0.8581 | 7970.3 samples/s | 31.1 steps/s
[Step= 550] | Loss=6.92202 | acc=0.1526 | tpr=0.7398 | fpr=0.8581 | 9536.8 samples/s | 37.3 steps/s
Avg test loss: 6.92405, Avg test acc: 0.15243, Avg tpr: 0.73891, Avg fpr: 0.85823, total FA: 119164

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.86573 | acc=0.1179 | tpr=0.8274 | fpr=0.8949 | 4582.5 samples/s | 17.9 steps/s
[Step= 100] | Loss=6.85102 | acc=0.1196 | tpr=0.8017 | fpr=0.8931 | 7868.4 samples/s | 30.7 steps/s
[Step= 150] | Loss=6.86391 | acc=0.1208 | tpr=0.7997 | fpr=0.8917 | 8263.8 samples/s | 32.3 steps/s
[Step= 200] | Loss=6.85892 | acc=0.1208 | tpr=0.7978 | fpr=0.8915 | 8050.7 samples/s | 31.4 steps/s
[Step= 250] | Loss=6.85935 | acc=0.1215 | tpr=0.7904 | fpr=0.8907 | 8255.9 samples/s | 32.2 steps/s
[Step= 300] | Loss=6.85649 | acc=0.1217 | tpr=0.7949 | fpr=0.8906 | 7823.6 samples/s | 30.6 steps/s
[Step= 350] | Loss=6.86394 | acc=0.1215 | tpr=0.7971 | fpr=0.8908 | 8292.2 samples/s | 32.4 steps/s
[Step= 400] | Loss=6.86665 | acc=0.1212 | tpr=0.7960 | fpr=0.8910 | 7628.4 samples/s | 29.8 steps/s
[Step= 450] | Loss=6.86494 | acc=0.1210 | tpr=0.7955 | fpr=0.8912 | 7651.1 samples/s | 29.9 steps/s
[Step= 500] | Loss=6.87115 | acc=0.1208 | tpr=0.7916 | fpr=0.8913 | 8072.6 samples/s | 31.5 steps/s
[Step= 550] | Loss=6.87101 | acc=0.1212 | tpr=0.7931 | fpr=0.8911 | 9679.6 samples/s | 37.8 steps/s
Avg test loss: 6.87165, Avg test acc: 0.12106, Avg tpr: 0.79279, Avg fpr: 0.89115, total FA: 123734

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19069 | acc=0.9615 | tpr=0.9115 | fpr=0.0376 | 4576.8 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.19244 | acc=0.9597 | tpr=0.9211 | fpr=0.0396 | 8374.6 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.19563 | acc=0.9587 | tpr=0.9265 | fpr=0.0407 | 7193.7 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.19523 | acc=0.9591 | tpr=0.9355 | fpr=0.0405 | 8391.3 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.19537 | acc=0.9590 | tpr=0.9345 | fpr=0.0406 | 7544.0 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.19726 | acc=0.9585 | tpr=0.9345 | fpr=0.0411 | 8399.1 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.19824 | acc=0.9584 | tpr=0.9343 | fpr=0.0412 | 8341.8 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.19974 | acc=0.9581 | tpr=0.9300 | fpr=0.0414 | 8125.8 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.20122 | acc=0.9577 | tpr=0.9265 | fpr=0.0417 | 7803.9 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.20061 | acc=0.9577 | tpr=0.9286 | fpr=0.0417 | 8193.6 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.20034 | acc=0.9579 | tpr=0.9288 | fpr=0.0416 | 9692.8 samples/s | 37.9 steps/s
Avg test loss: 0.19995, Avg test acc: 0.95794, Avg tpr: 0.92908, Avg fpr: 0.04153, total FA: 5767

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14384 | acc=0.9618 | tpr=0.9027 | fpr=0.0371 | 4860.3 samples/s | 19.0 steps/s
[Step= 100] | Loss=0.14497 | acc=0.9612 | tpr=0.9211 | fpr=0.0381 | 7536.7 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.14866 | acc=0.9601 | tpr=0.9164 | fpr=0.0391 | 7240.2 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.14989 | acc=0.9603 | tpr=0.9213 | fpr=0.0390 | 8442.8 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.15097 | acc=0.9597 | tpr=0.9214 | fpr=0.0396 | 8210.7 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.15128 | acc=0.9593 | tpr=0.9200 | fpr=0.0400 | 7777.7 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.15138 | acc=0.9593 | tpr=0.9224 | fpr=0.0400 | 7668.5 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.15292 | acc=0.9588 | tpr=0.9174 | fpr=0.0405 | 8421.8 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.15375 | acc=0.9586 | tpr=0.9172 | fpr=0.0407 | 8015.5 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.15340 | acc=0.9586 | tpr=0.9181 | fpr=0.0407 | 7484.3 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.15395 | acc=0.9586 | tpr=0.9156 | fpr=0.0406 | 11280.0 samples/s | 44.1 steps/s
Avg test loss: 0.15373, Avg test acc: 0.95861, Avg tpr: 0.91601, Avg fpr: 0.04061, total FA: 5639

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.24799 | acc=0.9530 | tpr=0.9292 | fpr=0.0466 | 4775.5 samples/s | 18.7 steps/s
[Step= 100] | Loss=0.25900 | acc=0.9511 | tpr=0.9211 | fpr=0.0483 | 7286.0 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.26647 | acc=0.9497 | tpr=0.9236 | fpr=0.0498 | 7773.9 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.26973 | acc=0.9497 | tpr=0.9279 | fpr=0.0499 | 8657.3 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.27109 | acc=0.9494 | tpr=0.9301 | fpr=0.0502 | 8423.2 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.27333 | acc=0.9490 | tpr=0.9265 | fpr=0.0506 | 7678.3 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.27401 | acc=0.9490 | tpr=0.9292 | fpr=0.0507 | 8412.6 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.27574 | acc=0.9487 | tpr=0.9256 | fpr=0.0509 | 7809.9 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.27735 | acc=0.9483 | tpr=0.9216 | fpr=0.0512 | 7908.6 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.27747 | acc=0.9481 | tpr=0.9242 | fpr=0.0514 | 7656.1 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.27644 | acc=0.9482 | tpr=0.9228 | fpr=0.0513 | 10137.8 samples/s | 39.6 steps/s
Avg test loss: 0.27604, Avg test acc: 0.94824, Avg tpr: 0.92314, Avg fpr: 0.05130, total FA: 7123

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11950 | acc=0.9677 | tpr=0.9071 | fpr=0.0312 | 4825.0 samples/s | 18.8 steps/s
[Step= 100] | Loss=0.12217 | acc=0.9665 | tpr=0.9104 | fpr=0.0325 | 7484.3 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.12661 | acc=0.9655 | tpr=0.9179 | fpr=0.0336 | 7188.8 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.12593 | acc=0.9659 | tpr=0.9279 | fpr=0.0334 | 8127.9 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.12754 | acc=0.9656 | tpr=0.9249 | fpr=0.0336 | 8252.5 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.12882 | acc=0.9654 | tpr=0.9244 | fpr=0.0339 | 7556.9 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.12991 | acc=0.9652 | tpr=0.9261 | fpr=0.0340 | 8115.0 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.13072 | acc=0.9650 | tpr=0.9223 | fpr=0.0342 | 8176.7 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.13201 | acc=0.9648 | tpr=0.9202 | fpr=0.0344 | 8046.9 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.13162 | acc=0.9649 | tpr=0.9238 | fpr=0.0344 | 8448.5 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.13104 | acc=0.9650 | tpr=0.9228 | fpr=0.0342 | 10607.8 samples/s | 41.4 steps/s
Avg test loss: 0.13082, Avg test acc: 0.96506, Avg tpr: 0.92274, Avg fpr: 0.03417, total FA: 4744

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21452 | acc=0.9581 | tpr=0.9204 | fpr=0.0412 | 4668.6 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.21828 | acc=0.9565 | tpr=0.9339 | fpr=0.0431 | 7988.7 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.22031 | acc=0.9556 | tpr=0.9380 | fpr=0.0441 | 7439.6 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.22136 | acc=0.9562 | tpr=0.9454 | fpr=0.0436 | 7628.4 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.22332 | acc=0.9560 | tpr=0.9424 | fpr=0.0437 | 8470.2 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.22564 | acc=0.9555 | tpr=0.9418 | fpr=0.0443 | 8046.0 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.22547 | acc=0.9556 | tpr=0.9411 | fpr=0.0441 | 8338.2 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.22633 | acc=0.9553 | tpr=0.9338 | fpr=0.0443 | 7764.4 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.22674 | acc=0.9550 | tpr=0.9328 | fpr=0.0446 | 7593.1 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.22694 | acc=0.9549 | tpr=0.9348 | fpr=0.0447 | 8378.0 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.22608 | acc=0.9550 | tpr=0.9324 | fpr=0.0446 | 10315.7 samples/s | 40.3 steps/s
Avg test loss: 0.22576, Avg test acc: 0.95509, Avg tpr: 0.93265, Avg fpr: 0.04450, total FA: 6179

server round 17/50

clients selected: [0 4 5 6 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=24001 Epoch=117.0] | Loss=0.01674 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.790 | L2-Norm(final)=12.829 | 3240.6 samples/s | 50.6 steps/s
[Step=24050 Epoch=117.3] | Loss=0.04350 | Reg=0.00139 | acc=0.9688 | L2-Norm=11.790 | L2-Norm(final)=12.831 | 4754.4 samples/s | 74.3 steps/s
[Step=24100 Epoch=117.5] | Loss=0.04144 | Reg=0.00139 | acc=0.9531 | L2-Norm=11.791 | L2-Norm(final)=12.838 | 5542.8 samples/s | 86.6 steps/s
[Step=24150 Epoch=117.8] | Loss=0.04373 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=12.844 | 5422.0 samples/s | 84.7 steps/s
[Step=24200 Epoch=118.0] | Loss=0.04344 | Reg=0.00139 | acc=0.9688 | L2-Norm=11.791 | L2-Norm(final)=12.845 | 8499.7 samples/s | 132.8 steps/s
[Step=24250 Epoch=118.2] | Loss=0.04224 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=12.848 | 1513.8 samples/s | 23.7 steps/s
[Step=24300 Epoch=118.5] | Loss=0.04233 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.791 | L2-Norm(final)=12.854 | 5363.0 samples/s | 83.8 steps/s
[Step=24350 Epoch=118.7] | Loss=0.04251 | Reg=0.00139 | acc=0.9688 | L2-Norm=11.791 | L2-Norm(final)=12.861 | 5432.7 samples/s | 84.9 steps/s
[Step=24400 Epoch=119.0] | Loss=0.04255 | Reg=0.00139 | acc=0.9219 | L2-Norm=11.791 | L2-Norm(final)=12.866 | 7590.6 samples/s | 118.6 steps/s
[Step=24450 Epoch=119.2] | Loss=0.04196 | Reg=0.00139 | acc=0.9688 | L2-Norm=11.791 | L2-Norm(final)=12.871 | 1508.3 samples/s | 23.6 steps/s
[Step=24500 Epoch=119.5] | Loss=0.04257 | Reg=0.00139 | acc=0.9688 | L2-Norm=11.791 | L2-Norm(final)=12.877 | 5408.3 samples/s | 84.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=119.5] | Loss=0.05278 | Reg=0.00139 | acc=0.9375 | L2-Norm=11.791 | L2-Norm(final)=12.918 | 3262.9 samples/s | 51.0 steps/s
[Step=24550 Epoch=119.7] | Loss=0.04280 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.895 | L2-Norm(final)=12.908 | 4124.6 samples/s | 64.4 steps/s
[Step=24600 Epoch=120.0] | Loss=0.04381 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.001 | L2-Norm(final)=12.888 | 4652.0 samples/s | 72.7 steps/s
[Step=24650 Epoch=120.2] | Loss=0.04427 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.080 | L2-Norm(final)=12.873 | 4806.2 samples/s | 75.1 steps/s
[Step=24700 Epoch=120.4] | Loss=0.04283 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.140 | L2-Norm(final)=12.862 | 6557.4 samples/s | 102.5 steps/s
[Step=24750 Epoch=120.7] | Loss=0.03756 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.189 | L2-Norm(final)=12.858 | 1413.2 samples/s | 22.1 steps/s
[Step=24800 Epoch=120.9] | Loss=0.03465 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.230 | L2-Norm(final)=12.857 | 4684.4 samples/s | 73.2 steps/s
[Step=24850 Epoch=121.2] | Loss=0.03226 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=12.857 | 4709.3 samples/s | 73.6 steps/s
[Step=24900 Epoch=121.4] | Loss=0.03034 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.298 | L2-Norm(final)=12.858 | 6164.1 samples/s | 96.3 steps/s
[Step=24950 Epoch=121.7] | Loss=0.02830 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.326 | L2-Norm(final)=12.858 | 1436.8 samples/s | 22.4 steps/s
[Step=25000 Epoch=121.9] | Loss=0.02712 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.351 | L2-Norm(final)=12.858 | 4694.1 samples/s | 73.3 steps/s
[Step=25050 Epoch=122.1] | Loss=0.02587 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.374 | L2-Norm(final)=12.859 | 4689.5 samples/s | 73.3 steps/s
[Step=25100 Epoch=122.4] | Loss=0.02460 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.396 | L2-Norm(final)=12.860 | 5645.0 samples/s | 88.2 steps/s
[Step=25150 Epoch=122.6] | Loss=0.02346 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.415 | L2-Norm(final)=12.862 | 1495.2 samples/s | 23.4 steps/s
[Step=25200 Epoch=122.9] | Loss=0.02226 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.433 | L2-Norm(final)=12.863 | 4702.8 samples/s | 73.5 steps/s
[Step=25250 Epoch=123.1] | Loss=0.02135 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.448 | L2-Norm(final)=12.865 | 4674.6 samples/s | 73.0 steps/s
[Step=25300 Epoch=123.4] | Loss=0.02072 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.462 | L2-Norm(final)=12.866 | 5191.7 samples/s | 81.1 steps/s
[Step=25350 Epoch=123.6] | Loss=0.01984 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=12.868 | 1510.8 samples/s | 23.6 steps/s
[Step=25400 Epoch=123.9] | Loss=0.01912 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=12.870 | 4707.7 samples/s | 73.6 steps/s
[Step=25450 Epoch=124.1] | Loss=0.01846 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.499 | L2-Norm(final)=12.871 | 4715.6 samples/s | 73.7 steps/s
[Step=25500 Epoch=124.3] | Loss=0.01795 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.510 | L2-Norm(final)=12.873 | 4806.1 samples/s | 75.1 steps/s
[Step=25550 Epoch=124.6] | Loss=0.01746 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.521 | L2-Norm(final)=12.875 | 1547.4 samples/s | 24.2 steps/s
[Step=25600 Epoch=124.8] | Loss=0.01690 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.531 | L2-Norm(final)=12.877 | 4673.0 samples/s | 73.0 steps/s
[Step=25650 Epoch=125.1] | Loss=0.01639 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.541 | L2-Norm(final)=12.879 | 4711.7 samples/s | 73.6 steps/s
[Step=25700 Epoch=125.3] | Loss=0.01592 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=12.881 | 4788.8 samples/s | 74.8 steps/s
[Step=25750 Epoch=125.6] | Loss=0.01562 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.560 | L2-Norm(final)=12.883 | 1583.2 samples/s | 24.7 steps/s
[Step=25800 Epoch=125.8] | Loss=0.01520 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.569 | L2-Norm(final)=12.886 | 4603.7 samples/s | 71.9 steps/s
[Step=25850 Epoch=126.0] | Loss=0.01485 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=12.888 | 4668.5 samples/s | 72.9 steps/s
[Step=25900 Epoch=126.3] | Loss=0.01455 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.586 | L2-Norm(final)=12.890 | 4693.0 samples/s | 73.3 steps/s
[Step=25950 Epoch=126.5] | Loss=0.01435 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.594 | L2-Norm(final)=12.892 | 1544.3 samples/s | 24.1 steps/s
[Step=26000 Epoch=126.8] | Loss=0.01417 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.602 | L2-Norm(final)=12.894 | 4658.9 samples/s | 72.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step26000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=8001 Epoch=39.2] | Loss=0.06929 | Reg=0.00139 | acc=0.8906 | L2-Norm=11.790 | L2-Norm(final)=9.462 | 3280.4 samples/s | 51.3 steps/s
[Step=8050 Epoch=39.5] | Loss=0.04758 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=9.467 | 4668.6 samples/s | 72.9 steps/s
[Step=8100 Epoch=39.7] | Loss=0.04543 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.791 | L2-Norm(final)=9.481 | 5402.7 samples/s | 84.4 steps/s
[Step=8150 Epoch=40.0] | Loss=0.04557 | Reg=0.00139 | acc=0.9688 | L2-Norm=11.791 | L2-Norm(final)=9.508 | 5543.2 samples/s | 86.6 steps/s
[Step=8200 Epoch=40.2] | Loss=0.04465 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.791 | L2-Norm(final)=9.536 | 8623.1 samples/s | 134.7 steps/s
[Step=8250 Epoch=40.5] | Loss=0.04465 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.791 | L2-Norm(final)=9.563 | 1445.4 samples/s | 22.6 steps/s
[Step=8300 Epoch=40.7] | Loss=0.04511 | Reg=0.00139 | acc=0.9531 | L2-Norm=11.791 | L2-Norm(final)=9.590 | 5488.0 samples/s | 85.7 steps/s
[Step=8350 Epoch=40.9] | Loss=0.04499 | Reg=0.00139 | acc=0.9688 | L2-Norm=11.791 | L2-Norm(final)=9.617 | 5476.9 samples/s | 85.6 steps/s
[Step=8400 Epoch=41.2] | Loss=0.04447 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=9.643 | 7904.3 samples/s | 123.5 steps/s
[Step=8450 Epoch=41.4] | Loss=0.04398 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.791 | L2-Norm(final)=9.671 | 1504.7 samples/s | 23.5 steps/s
[Step=8500 Epoch=41.7] | Loss=0.04437 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=9.699 | 5483.2 samples/s | 85.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=41.7] | Loss=0.03144 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.792 | L2-Norm(final)=9.960 | 3203.5 samples/s | 50.1 steps/s
[Step=8550 Epoch=41.9] | Loss=0.05023 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.887 | L2-Norm(final)=9.961 | 4230.5 samples/s | 66.1 steps/s
[Step=8600 Epoch=42.2] | Loss=0.05342 | Reg=0.00144 | acc=0.9375 | L2-Norm=11.992 | L2-Norm(final)=9.944 | 4683.3 samples/s | 73.2 steps/s
[Step=8650 Epoch=42.4] | Loss=0.04955 | Reg=0.00146 | acc=0.9531 | L2-Norm=12.071 | L2-Norm(final)=9.938 | 4697.6 samples/s | 73.4 steps/s
[Step=8700 Epoch=42.7] | Loss=0.04447 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=9.938 | 6889.6 samples/s | 107.6 steps/s
[Step=8750 Epoch=42.9] | Loss=0.03990 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.186 | L2-Norm(final)=9.942 | 1400.0 samples/s | 21.9 steps/s
[Step=8800 Epoch=43.2] | Loss=0.03648 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.230 | L2-Norm(final)=9.946 | 4668.6 samples/s | 72.9 steps/s
[Step=8850 Epoch=43.4] | Loss=0.03317 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.267 | L2-Norm(final)=9.951 | 4668.1 samples/s | 72.9 steps/s
[Step=8900 Epoch=43.6] | Loss=0.03202 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.300 | L2-Norm(final)=9.956 | 6517.3 samples/s | 101.8 steps/s
[Step=8950 Epoch=43.9] | Loss=0.02976 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.330 | L2-Norm(final)=9.959 | 1438.1 samples/s | 22.5 steps/s
[Step=9000 Epoch=44.1] | Loss=0.02784 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.357 | L2-Norm(final)=9.963 | 4668.9 samples/s | 73.0 steps/s
[Step=9050 Epoch=44.4] | Loss=0.02662 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.381 | L2-Norm(final)=9.967 | 4618.7 samples/s | 72.2 steps/s
[Step=9100 Epoch=44.6] | Loss=0.02536 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.403 | L2-Norm(final)=9.970 | 6120.4 samples/s | 95.6 steps/s
[Step=9150 Epoch=44.9] | Loss=0.02395 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.424 | L2-Norm(final)=9.974 | 1478.5 samples/s | 23.1 steps/s
[Step=9200 Epoch=45.1] | Loss=0.02269 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.443 | L2-Norm(final)=9.979 | 4709.2 samples/s | 73.6 steps/s
[Step=9250 Epoch=45.4] | Loss=0.02179 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=9.983 | 4786.9 samples/s | 74.8 steps/s
[Step=9300 Epoch=45.6] | Loss=0.02102 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.478 | L2-Norm(final)=9.987 | 5608.8 samples/s | 87.6 steps/s
[Step=9350 Epoch=45.9] | Loss=0.02026 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=9.990 | 1449.0 samples/s | 22.6 steps/s
[Step=9400 Epoch=46.1] | Loss=0.01944 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.510 | L2-Norm(final)=9.995 | 4687.6 samples/s | 73.2 steps/s
[Step=9450 Epoch=46.3] | Loss=0.01878 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=9.999 | 4639.1 samples/s | 72.5 steps/s
[Step=9500 Epoch=46.6] | Loss=0.01808 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=10.003 | 5437.5 samples/s | 85.0 steps/s
[Step=9550 Epoch=46.8] | Loss=0.01753 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=10.007 | 1485.8 samples/s | 23.2 steps/s
[Step=9600 Epoch=47.1] | Loss=0.01713 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.562 | L2-Norm(final)=10.010 | 4663.6 samples/s | 72.9 steps/s
[Step=9650 Epoch=47.3] | Loss=0.01662 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.574 | L2-Norm(final)=10.014 | 4713.3 samples/s | 73.6 steps/s
[Step=9700 Epoch=47.6] | Loss=0.01612 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.585 | L2-Norm(final)=10.018 | 5160.8 samples/s | 80.6 steps/s
[Step=9750 Epoch=47.8] | Loss=0.01576 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.596 | L2-Norm(final)=10.022 | 1514.6 samples/s | 23.7 steps/s
[Step=9800 Epoch=48.1] | Loss=0.01534 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.606 | L2-Norm(final)=10.025 | 4684.2 samples/s | 73.2 steps/s
[Step=9850 Epoch=48.3] | Loss=0.01490 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=10.029 | 4762.3 samples/s | 74.4 steps/s
[Step=9900 Epoch=48.5] | Loss=0.01459 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.625 | L2-Norm(final)=10.032 | 4859.1 samples/s | 75.9 steps/s
[Step=9950 Epoch=48.8] | Loss=0.01425 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.633 | L2-Norm(final)=10.035 | 1550.2 samples/s | 24.2 steps/s
[Step=10000 Epoch=49.0] | Loss=0.01394 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.641 | L2-Norm(final)=10.038 | 4761.7 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_4/client_state-step10000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=208.5] | Loss=0.00189 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.790 | L2-Norm(final)=16.095 | 3251.2 samples/s | 50.8 steps/s
[Step=22050 Epoch=208.9] | Loss=0.00219 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.786 | L2-Norm(final)=16.109 | 4450.5 samples/s | 69.5 steps/s
[Step=22100 Epoch=209.4] | Loss=0.00242 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=16.135 | 8199.8 samples/s | 128.1 steps/s
[Step=22150 Epoch=209.9] | Loss=0.00262 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=16.158 | 1470.7 samples/s | 23.0 steps/s
[Step=22200 Epoch=210.4] | Loss=0.00234 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=16.181 | 7181.5 samples/s | 112.2 steps/s
[Step=22250 Epoch=210.8] | Loss=0.00253 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=16.203 | 1471.2 samples/s | 23.0 steps/s
[Step=22300 Epoch=211.3] | Loss=0.00246 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=16.225 | 6438.1 samples/s | 100.6 steps/s
[Step=22350 Epoch=211.8] | Loss=0.00238 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=16.245 | 1556.7 samples/s | 24.3 steps/s
[Step=22400 Epoch=212.3] | Loss=0.00234 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.785 | L2-Norm(final)=16.266 | 5865.0 samples/s | 91.6 steps/s
[Step=22450 Epoch=212.7] | Loss=0.00238 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.785 | L2-Norm(final)=16.286 | 1550.5 samples/s | 24.2 steps/s
[Step=22500 Epoch=213.2] | Loss=0.00237 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=16.305 | 5230.1 samples/s | 81.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=213.2] | Loss=0.00024 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=16.495 | 3104.5 samples/s | 48.5 steps/s
[Step=22550 Epoch=213.7] | Loss=0.00268 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.826 | L2-Norm(final)=16.510 | 4085.3 samples/s | 63.8 steps/s
[Step=22600 Epoch=214.2] | Loss=0.00400 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.930 | L2-Norm(final)=16.514 | 6525.5 samples/s | 102.0 steps/s
[Step=22650 Epoch=214.6] | Loss=0.00618 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.039 | L2-Norm(final)=16.505 | 1374.8 samples/s | 21.5 steps/s
[Step=22700 Epoch=215.1] | Loss=0.00532 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.119 | L2-Norm(final)=16.490 | 5758.1 samples/s | 90.0 steps/s
[Step=22750 Epoch=215.6] | Loss=0.00441 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=16.482 | 1400.8 samples/s | 21.9 steps/s
[Step=22800 Epoch=216.0] | Loss=0.00372 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.199 | L2-Norm(final)=16.478 | 5251.4 samples/s | 82.1 steps/s
[Step=22850 Epoch=216.5] | Loss=0.00319 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.216 | L2-Norm(final)=16.475 | 1470.2 samples/s | 23.0 steps/s
[Step=22900 Epoch=217.0] | Loss=0.00279 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=16.474 | 4909.8 samples/s | 76.7 steps/s
[Step=22950 Epoch=217.5] | Loss=0.00248 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.231 | L2-Norm(final)=16.473 | 1502.4 samples/s | 23.5 steps/s
[Step=23000 Epoch=217.9] | Loss=0.00223 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=16.472 | 4614.6 samples/s | 72.1 steps/s
[Step=23050 Epoch=218.4] | Loss=0.00203 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.231 | L2-Norm(final)=16.472 | 1518.2 samples/s | 23.7 steps/s
[Step=23100 Epoch=218.9] | Loss=0.00186 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=16.472 | 4482.2 samples/s | 70.0 steps/s
[Step=23150 Epoch=219.4] | Loss=0.00172 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.224 | L2-Norm(final)=16.472 | 1565.5 samples/s | 24.5 steps/s
[Step=23200 Epoch=219.8] | Loss=0.00160 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.218 | L2-Norm(final)=16.472 | 4346.8 samples/s | 67.9 steps/s
[Step=23250 Epoch=220.3] | Loss=0.00149 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=16.472 | 1515.2 samples/s | 23.7 steps/s
[Step=23300 Epoch=220.8] | Loss=0.00140 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.205 | L2-Norm(final)=16.472 | 4460.2 samples/s | 69.7 steps/s
[Step=23350 Epoch=221.3] | Loss=0.00132 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.198 | L2-Norm(final)=16.472 | 1565.6 samples/s | 24.5 steps/s
[Step=23400 Epoch=221.7] | Loss=0.00124 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.190 | L2-Norm(final)=16.472 | 4304.5 samples/s | 67.3 steps/s
[Step=23450 Epoch=222.2] | Loss=0.00118 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=16.473 | 6705.0 samples/s | 104.8 steps/s
[Step=23500 Epoch=222.7] | Loss=0.00112 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=16.473 | 1356.4 samples/s | 21.2 steps/s
[Step=23550 Epoch=223.2] | Loss=0.00107 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=16.474 | 6112.4 samples/s | 95.5 steps/s
[Step=23600 Epoch=223.6] | Loss=0.00102 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=16.474 | 1401.7 samples/s | 21.9 steps/s
[Step=23650 Epoch=224.1] | Loss=0.00097 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=16.474 | 5535.9 samples/s | 86.5 steps/s
[Step=23700 Epoch=224.6] | Loss=0.00093 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=16.475 | 1440.7 samples/s | 22.5 steps/s
[Step=23750 Epoch=225.1] | Loss=0.00090 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.126 | L2-Norm(final)=16.476 | 5099.6 samples/s | 79.7 steps/s
[Step=23800 Epoch=225.5] | Loss=0.00086 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.116 | L2-Norm(final)=16.476 | 1478.0 samples/s | 23.1 steps/s
[Step=23850 Epoch=226.0] | Loss=0.00083 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.107 | L2-Norm(final)=16.477 | 4714.0 samples/s | 73.7 steps/s
[Step=23900 Epoch=226.5] | Loss=0.00080 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.097 | L2-Norm(final)=16.478 | 1500.5 samples/s | 23.4 steps/s
[Step=23950 Epoch=226.9] | Loss=0.00077 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.086 | L2-Norm(final)=16.478 | 4483.5 samples/s | 70.1 steps/s
[Step=24000 Epoch=227.4] | Loss=0.00075 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.076 | L2-Norm(final)=16.479 | 1538.6 samples/s | 24.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step24000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=152.2] | Loss=0.00032 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.790 | L2-Norm(final)=11.385 | 3202.5 samples/s | 50.0 steps/s
[Step=16050 Epoch=152.7] | Loss=0.00267 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.786 | L2-Norm(final)=11.419 | 4527.6 samples/s | 70.7 steps/s
[Step=16100 Epoch=153.2] | Loss=0.00245 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=11.460 | 8003.7 samples/s | 125.1 steps/s
[Step=16150 Epoch=153.6] | Loss=0.00249 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=11.500 | 1444.0 samples/s | 22.6 steps/s
[Step=16200 Epoch=154.1] | Loss=0.00244 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=11.538 | 7046.1 samples/s | 110.1 steps/s
[Step=16250 Epoch=154.6] | Loss=0.00252 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.785 | L2-Norm(final)=11.572 | 1496.6 samples/s | 23.4 steps/s
[Step=16300 Epoch=155.1] | Loss=0.00236 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=11.605 | 6474.6 samples/s | 101.2 steps/s
[Step=16350 Epoch=155.5] | Loss=0.00229 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=11.636 | 1528.6 samples/s | 23.9 steps/s
[Step=16400 Epoch=156.0] | Loss=0.00221 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=11.667 | 5758.5 samples/s | 90.0 steps/s
[Step=16450 Epoch=156.5] | Loss=0.00231 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=11.696 | 1545.4 samples/s | 24.1 steps/s
[Step=16500 Epoch=157.0] | Loss=0.00224 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=11.724 | 5274.4 samples/s | 82.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=157.0] | Loss=0.00298 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=12.000 | 3109.7 samples/s | 48.6 steps/s
[Step=16550 Epoch=157.4] | Loss=0.00410 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.859 | L2-Norm(final)=12.014 | 4088.1 samples/s | 63.9 steps/s
[Step=16600 Epoch=157.9] | Loss=0.00424 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.995 | L2-Norm(final)=12.009 | 6564.1 samples/s | 102.6 steps/s
[Step=16650 Epoch=158.4] | Loss=0.00345 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.081 | L2-Norm(final)=11.999 | 1368.4 samples/s | 21.4 steps/s
[Step=16700 Epoch=158.9] | Loss=0.00263 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.126 | L2-Norm(final)=11.995 | 5940.2 samples/s | 92.8 steps/s
[Step=16750 Epoch=159.3] | Loss=0.00211 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=11.993 | 1422.0 samples/s | 22.2 steps/s
[Step=16800 Epoch=159.8] | Loss=0.00176 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=11.993 | 5376.8 samples/s | 84.0 steps/s
[Step=16850 Epoch=160.3] | Loss=0.00151 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=11.993 | 1467.3 samples/s | 22.9 steps/s
[Step=16900 Epoch=160.8] | Loss=0.00132 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=11.993 | 4963.7 samples/s | 77.6 steps/s
[Step=16950 Epoch=161.2] | Loss=0.00118 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=11.993 | 1467.5 samples/s | 22.9 steps/s
[Step=17000 Epoch=161.7] | Loss=0.00106 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=11.993 | 4586.2 samples/s | 71.7 steps/s
[Step=17050 Epoch=162.2] | Loss=0.00096 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.127 | L2-Norm(final)=11.994 | 1521.3 samples/s | 23.8 steps/s
[Step=17100 Epoch=162.7] | Loss=0.00088 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.116 | L2-Norm(final)=11.994 | 4416.8 samples/s | 69.0 steps/s
[Step=17150 Epoch=163.1] | Loss=0.00082 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.105 | L2-Norm(final)=11.994 | 1532.6 samples/s | 23.9 steps/s
[Step=17200 Epoch=163.6] | Loss=0.00076 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.094 | L2-Norm(final)=11.994 | 4441.0 samples/s | 69.4 steps/s
[Step=17250 Epoch=164.1] | Loss=0.00071 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.082 | L2-Norm(final)=11.995 | 1517.0 samples/s | 23.7 steps/s
[Step=17300 Epoch=164.6] | Loss=0.00066 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=11.995 | 4443.8 samples/s | 69.4 steps/s
[Step=17350 Epoch=165.0] | Loss=0.00063 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.057 | L2-Norm(final)=11.995 | 1574.9 samples/s | 24.6 steps/s
[Step=17400 Epoch=165.5] | Loss=0.00059 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.045 | L2-Norm(final)=11.996 | 4418.7 samples/s | 69.0 steps/s
[Step=17450 Epoch=166.0] | Loss=0.00056 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.032 | L2-Norm(final)=11.996 | 6718.3 samples/s | 105.0 steps/s
[Step=17500 Epoch=166.5] | Loss=0.00053 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.020 | L2-Norm(final)=11.996 | 1354.2 samples/s | 21.2 steps/s
[Step=17550 Epoch=166.9] | Loss=0.00051 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.007 | L2-Norm(final)=11.997 | 6046.4 samples/s | 94.5 steps/s
[Step=17600 Epoch=167.4] | Loss=0.00048 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.994 | L2-Norm(final)=11.997 | 1417.1 samples/s | 22.1 steps/s
[Step=17650 Epoch=167.9] | Loss=0.00046 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.981 | L2-Norm(final)=11.997 | 5391.9 samples/s | 84.2 steps/s
[Step=17700 Epoch=168.4] | Loss=0.00044 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.968 | L2-Norm(final)=11.998 | 1420.3 samples/s | 22.2 steps/s
[Step=17750 Epoch=168.8] | Loss=0.00043 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.955 | L2-Norm(final)=11.998 | 5120.1 samples/s | 80.0 steps/s
[Step=17800 Epoch=169.3] | Loss=0.00041 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.942 | L2-Norm(final)=11.999 | 1478.9 samples/s | 23.1 steps/s
[Step=17850 Epoch=169.8] | Loss=0.00040 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.929 | L2-Norm(final)=11.999 | 4753.0 samples/s | 74.3 steps/s
[Step=17900 Epoch=170.3] | Loss=0.00038 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.916 | L2-Norm(final)=11.999 | 1514.8 samples/s | 23.7 steps/s
[Step=17950 Epoch=170.7] | Loss=0.00037 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=12.000 | 4460.7 samples/s | 69.7 steps/s
[Step=18000 Epoch=171.2] | Loss=0.00036 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.890 | L2-Norm(final)=12.000 | 1532.4 samples/s | 23.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step18000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=210.1] | Loss=0.00002 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.790 | L2-Norm(final)=14.786 | 3109.8 samples/s | 48.6 steps/s
[Step=22050 Epoch=210.6] | Loss=0.00110 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.786 | L2-Norm(final)=14.799 | 4740.4 samples/s | 74.1 steps/s
[Step=22100 Epoch=211.0] | Loss=0.00108 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=14.821 | 8156.6 samples/s | 127.4 steps/s
[Step=22150 Epoch=211.5] | Loss=0.00101 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=14.838 | 1444.8 samples/s | 22.6 steps/s
[Step=22200 Epoch=212.0] | Loss=0.00108 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=14.857 | 7474.3 samples/s | 116.8 steps/s
[Step=22250 Epoch=212.5] | Loss=0.00108 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=14.876 | 1503.1 samples/s | 23.5 steps/s
[Step=22300 Epoch=213.0] | Loss=0.00103 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=14.894 | 6836.2 samples/s | 106.8 steps/s
[Step=22350 Epoch=213.4] | Loss=0.00102 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=14.914 | 1499.2 samples/s | 23.4 steps/s
[Step=22400 Epoch=213.9] | Loss=0.00106 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=14.934 | 6203.5 samples/s | 96.9 steps/s
[Step=22450 Epoch=214.4] | Loss=0.00104 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=14.954 | 1550.6 samples/s | 24.2 steps/s
[Step=22500 Epoch=214.9] | Loss=0.00101 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=14.975 | 5588.0 samples/s | 87.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=214.9] | Loss=0.00245 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=15.180 | 3165.4 samples/s | 49.5 steps/s
[Step=22550 Epoch=215.3] | Loss=0.00022 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.790 | L2-Norm(final)=15.195 | 3976.3 samples/s | 62.1 steps/s
[Step=22600 Epoch=215.8] | Loss=0.00022 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.779 | L2-Norm(final)=15.202 | 6621.7 samples/s | 103.5 steps/s
[Step=22650 Epoch=216.3] | Loss=0.00016 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.767 | L2-Norm(final)=15.207 | 1367.5 samples/s | 21.4 steps/s
[Step=22700 Epoch=216.8] | Loss=0.00012 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.748 | L2-Norm(final)=15.211 | 6078.9 samples/s | 95.0 steps/s
[Step=22750 Epoch=217.2] | Loss=0.00010 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.725 | L2-Norm(final)=15.213 | 1423.6 samples/s | 22.2 steps/s
[Step=22800 Epoch=217.7] | Loss=0.00008 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.701 | L2-Norm(final)=15.215 | 5615.1 samples/s | 87.7 steps/s
[Step=22850 Epoch=218.2] | Loss=0.00007 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.677 | L2-Norm(final)=15.216 | 1480.1 samples/s | 23.1 steps/s
[Step=22900 Epoch=218.7] | Loss=0.00006 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=15.218 | 5168.1 samples/s | 80.8 steps/s
[Step=22950 Epoch=219.2] | Loss=0.00006 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.630 | L2-Norm(final)=15.218 | 1464.9 samples/s | 22.9 steps/s
[Step=23000 Epoch=219.6] | Loss=0.00005 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.607 | L2-Norm(final)=15.219 | 4789.6 samples/s | 74.8 steps/s
[Step=23050 Epoch=220.1] | Loss=0.00005 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.585 | L2-Norm(final)=15.220 | 1532.7 samples/s | 23.9 steps/s
[Step=23100 Epoch=220.6] | Loss=0.00004 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.562 | L2-Norm(final)=15.221 | 4550.7 samples/s | 71.1 steps/s
[Step=23150 Epoch=221.1] | Loss=0.00004 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.540 | L2-Norm(final)=15.221 | 1510.0 samples/s | 23.6 steps/s
[Step=23200 Epoch=221.5] | Loss=0.00004 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.519 | L2-Norm(final)=15.222 | 4516.1 samples/s | 70.6 steps/s
[Step=23250 Epoch=222.0] | Loss=0.00003 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.497 | L2-Norm(final)=15.222 | 1528.2 samples/s | 23.9 steps/s
[Step=23300 Epoch=222.5] | Loss=0.00003 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=15.223 | 4450.9 samples/s | 69.5 steps/s
[Step=23350 Epoch=223.0] | Loss=0.00003 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.455 | L2-Norm(final)=15.223 | 1520.3 samples/s | 23.8 steps/s
[Step=23400 Epoch=223.5] | Loss=0.00003 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.434 | L2-Norm(final)=15.224 | 4591.1 samples/s | 71.7 steps/s
[Step=23450 Epoch=223.9] | Loss=0.00003 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.414 | L2-Norm(final)=15.224 | 1526.0 samples/s | 23.8 steps/s
[Step=23500 Epoch=224.4] | Loss=0.00003 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.393 | L2-Norm(final)=15.225 | 4425.7 samples/s | 69.2 steps/s
[Step=23550 Epoch=224.9] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.373 | L2-Norm(final)=15.225 | 7203.0 samples/s | 112.5 steps/s
[Step=23600 Epoch=225.4] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=15.226 | 1361.7 samples/s | 21.3 steps/s
[Step=23650 Epoch=225.8] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.333 | L2-Norm(final)=15.226 | 6547.8 samples/s | 102.3 steps/s
[Step=23700 Epoch=226.3] | Loss=0.00002 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.313 | L2-Norm(final)=15.226 | 1389.5 samples/s | 21.7 steps/s
[Step=23750 Epoch=226.8] | Loss=0.00002 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=15.227 | 5946.3 samples/s | 92.9 steps/s
[Step=23800 Epoch=227.3] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.273 | L2-Norm(final)=15.227 | 1391.3 samples/s | 21.7 steps/s
[Step=23850 Epoch=227.8] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.253 | L2-Norm(final)=15.228 | 5572.8 samples/s | 87.1 steps/s
[Step=23900 Epoch=228.2] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.234 | L2-Norm(final)=15.228 | 1446.0 samples/s | 22.6 steps/s
[Step=23950 Epoch=228.7] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.214 | L2-Norm(final)=15.229 | 5219.8 samples/s | 81.6 steps/s
[Step=24000 Epoch=229.2] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=15.229 | 1458.6 samples/s | 22.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11762 | acc=0.9485 | tpr=0.9688 | fpr=0.0956 | 4479.1 samples/s | 17.5 steps/s
Avg test loss: 0.12355, Avg test acc: 0.94719, Avg tpr: 0.96777, Avg fpr: 0.09806, total FA: 765

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.13479 | acc=0.9495 | tpr=0.9735 | fpr=0.1028 | 4747.7 samples/s | 18.5 steps/s
Avg test loss: 0.13693, Avg test acc: 0.94799, Avg tpr: 0.97371, Avg fpr: 0.10858, total FA: 847

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11102 | acc=0.9488 | tpr=0.9604 | fpr=0.0763 | 4690.8 samples/s | 18.3 steps/s
Avg test loss: 0.11593, Avg test acc: 0.94883, Avg tpr: 0.95978, Avg fpr: 0.07525, total FA: 587

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.12736 | acc=0.9501 | tpr=0.9550 | fpr=0.0607 | 4737.2 samples/s | 18.5 steps/s
Avg test loss: 0.13036, Avg test acc: 0.95032, Avg tpr: 0.95623, Avg fpr: 0.06268, total FA: 489

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10896 | acc=0.9539 | tpr=0.9692 | fpr=0.0793 | 4710.5 samples/s | 18.4 steps/s
Avg test loss: 0.11827, Avg test acc: 0.95248, Avg tpr: 0.96829, Avg fpr: 0.08230, total FA: 642

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.79613 | acc=0.3158 | tpr=0.0062 | fpr=0.0119 | 4727.3 samples/s | 18.5 steps/s
Avg test loss: 5.80721, Avg test acc: 0.31329, Avg tpr: 0.00624, Avg fpr: 0.01141, total FA: 89

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.67836 | acc=0.3033 | tpr=0.0209 | fpr=0.0835 | 4800.0 samples/s | 18.8 steps/s
Avg test loss: 4.70378, Avg test acc: 0.30307, Avg tpr: 0.02116, Avg fpr: 0.07691, total FA: 600

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.57575 | acc=0.2980 | tpr=0.0132 | fpr=0.0835 | 4599.0 samples/s | 18.0 steps/s
Avg test loss: 4.59596, Avg test acc: 0.29570, Avg tpr: 0.01323, Avg fpr: 0.08307, total FA: 648

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.11710 | acc=0.3128 | tpr=0.0245 | fpr=0.0612 | 4665.9 samples/s | 18.2 steps/s
Avg test loss: 4.13379, Avg test acc: 0.31164, Avg tpr: 0.02547, Avg fpr: 0.05897, total FA: 460

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.95400 | acc=0.3049 | tpr=0.0164 | fpr=0.0686 | 4470.9 samples/s | 17.5 steps/s
Avg test loss: 4.96477, Avg test acc: 0.30231, Avg tpr: 0.01556, Avg fpr: 0.06704, total FA: 523

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.99769 | acc=0.1193 | tpr=0.8319 | fpr=0.8935 | 4732.5 samples/s | 18.5 steps/s
[Step= 100] | Loss=6.97565 | acc=0.1208 | tpr=0.7889 | fpr=0.8916 | 7246.7 samples/s | 28.3 steps/s
[Step= 150] | Loss=6.98404 | acc=0.1215 | tpr=0.7983 | fpr=0.8909 | 8118.2 samples/s | 31.7 steps/s
[Step= 200] | Loss=6.96740 | acc=0.1212 | tpr=0.8022 | fpr=0.8911 | 8305.9 samples/s | 32.4 steps/s
[Step= 250] | Loss=6.96845 | acc=0.1213 | tpr=0.7991 | fpr=0.8911 | 7871.7 samples/s | 30.7 steps/s
[Step= 300] | Loss=6.96135 | acc=0.1215 | tpr=0.8036 | fpr=0.8909 | 8062.1 samples/s | 31.5 steps/s
[Step= 350] | Loss=6.96535 | acc=0.1211 | tpr=0.8059 | fpr=0.8913 | 7799.7 samples/s | 30.5 steps/s
[Step= 400] | Loss=6.96611 | acc=0.1208 | tpr=0.8020 | fpr=0.8916 | 8149.3 samples/s | 31.8 steps/s
[Step= 450] | Loss=6.96600 | acc=0.1207 | tpr=0.8014 | fpr=0.8917 | 8417.1 samples/s | 32.9 steps/s
[Step= 500] | Loss=6.96698 | acc=0.1208 | tpr=0.7996 | fpr=0.8915 | 7412.7 samples/s | 29.0 steps/s
[Step= 550] | Loss=6.96406 | acc=0.1210 | tpr=0.8050 | fpr=0.8914 | 10969.2 samples/s | 42.8 steps/s
Avg test loss: 6.96500, Avg test acc: 0.12090, Avg tpr: 0.80507, Avg fpr: 0.89154, total FA: 123788

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.83656 | acc=0.1270 | tpr=0.8142 | fpr=0.8854 | 4480.9 samples/s | 17.5 steps/s
[Step= 100] | Loss=6.82038 | acc=0.1271 | tpr=0.7804 | fpr=0.8851 | 8006.7 samples/s | 31.3 steps/s
[Step= 150] | Loss=6.82313 | acc=0.1279 | tpr=0.7896 | fpr=0.8843 | 7866.2 samples/s | 30.7 steps/s
[Step= 200] | Loss=6.81719 | acc=0.1279 | tpr=0.7880 | fpr=0.8841 | 8035.2 samples/s | 31.4 steps/s
[Step= 250] | Loss=6.81465 | acc=0.1289 | tpr=0.7904 | fpr=0.8831 | 8044.1 samples/s | 31.4 steps/s
[Step= 300] | Loss=6.81338 | acc=0.1293 | tpr=0.7956 | fpr=0.8828 | 8235.3 samples/s | 32.2 steps/s
[Step= 350] | Loss=6.82042 | acc=0.1288 | tpr=0.7927 | fpr=0.8832 | 8055.8 samples/s | 31.5 steps/s
[Step= 400] | Loss=6.82414 | acc=0.1289 | tpr=0.7899 | fpr=0.8831 | 7997.8 samples/s | 31.2 steps/s
[Step= 450] | Loss=6.82502 | acc=0.1289 | tpr=0.7877 | fpr=0.8831 | 7605.8 samples/s | 29.7 steps/s
[Step= 500] | Loss=6.82580 | acc=0.1289 | tpr=0.7828 | fpr=0.8829 | 8673.9 samples/s | 33.9 steps/s
[Step= 550] | Loss=6.82478 | acc=0.1292 | tpr=0.7875 | fpr=0.8828 | 9742.7 samples/s | 38.1 steps/s
Avg test loss: 6.82722, Avg test acc: 0.12906, Avg tpr: 0.78764, Avg fpr: 0.88292, total FA: 122591

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.85306 | acc=0.1357 | tpr=0.7920 | fpr=0.8761 | 4714.7 samples/s | 18.4 steps/s
[Step= 100] | Loss=5.82866 | acc=0.1381 | tpr=0.7527 | fpr=0.8733 | 7975.4 samples/s | 31.2 steps/s
[Step= 150] | Loss=5.83928 | acc=0.1396 | tpr=0.7622 | fpr=0.8719 | 8216.1 samples/s | 32.1 steps/s
[Step= 200] | Loss=5.82199 | acc=0.1404 | tpr=0.7628 | fpr=0.8709 | 7930.6 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.81661 | acc=0.1410 | tpr=0.7555 | fpr=0.8702 | 7968.1 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.80871 | acc=0.1411 | tpr=0.7593 | fpr=0.8702 | 8194.0 samples/s | 32.0 steps/s
[Step= 350] | Loss=5.82031 | acc=0.1403 | tpr=0.7564 | fpr=0.8709 | 7713.7 samples/s | 30.1 steps/s
[Step= 400] | Loss=5.82266 | acc=0.1402 | tpr=0.7571 | fpr=0.8710 | 7603.0 samples/s | 29.7 steps/s
[Step= 450] | Loss=5.81925 | acc=0.1406 | tpr=0.7551 | fpr=0.8705 | 8289.9 samples/s | 32.4 steps/s
[Step= 500] | Loss=5.81900 | acc=0.1409 | tpr=0.7537 | fpr=0.8701 | 8288.2 samples/s | 32.4 steps/s
[Step= 550] | Loss=5.81889 | acc=0.1409 | tpr=0.7537 | fpr=0.8702 | 9663.8 samples/s | 37.7 steps/s
Avg test loss: 5.81926, Avg test acc: 0.14081, Avg tpr: 0.75238, Avg fpr: 0.87030, total FA: 120840

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.95066 | acc=0.1497 | tpr=0.7699 | fpr=0.8615 | 4521.0 samples/s | 17.7 steps/s
[Step= 100] | Loss=6.92029 | acc=0.1511 | tpr=0.7505 | fpr=0.8601 | 8314.8 samples/s | 32.5 steps/s
[Step= 150] | Loss=6.92525 | acc=0.1519 | tpr=0.7478 | fpr=0.8591 | 8122.3 samples/s | 31.7 steps/s
[Step= 200] | Loss=6.91252 | acc=0.1520 | tpr=0.7454 | fpr=0.8588 | 7983.2 samples/s | 31.2 steps/s
[Step= 250] | Loss=6.91266 | acc=0.1522 | tpr=0.7432 | fpr=0.8585 | 8300.6 samples/s | 32.4 steps/s
[Step= 300] | Loss=6.90855 | acc=0.1529 | tpr=0.7425 | fpr=0.8578 | 7518.8 samples/s | 29.4 steps/s
[Step= 350] | Loss=6.91988 | acc=0.1522 | tpr=0.7470 | fpr=0.8586 | 8350.9 samples/s | 32.6 steps/s
[Step= 400] | Loss=6.92339 | acc=0.1521 | tpr=0.7429 | fpr=0.8587 | 7831.3 samples/s | 30.6 steps/s
[Step= 450] | Loss=6.92003 | acc=0.1522 | tpr=0.7410 | fpr=0.8585 | 7232.9 samples/s | 28.3 steps/s
[Step= 500] | Loss=6.92233 | acc=0.1525 | tpr=0.7379 | fpr=0.8581 | 8302.5 samples/s | 32.4 steps/s
[Step= 550] | Loss=6.92202 | acc=0.1526 | tpr=0.7398 | fpr=0.8581 | 10706.8 samples/s | 41.8 steps/s
Avg test loss: 6.92405, Avg test acc: 0.15243, Avg tpr: 0.73891, Avg fpr: 0.85823, total FA: 119164

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.06980 | acc=0.1375 | tpr=0.7876 | fpr=0.8742 | 4769.8 samples/s | 18.6 steps/s
[Step= 100] | Loss=6.04999 | acc=0.1402 | tpr=0.7441 | fpr=0.8711 | 7236.9 samples/s | 28.3 steps/s
[Step= 150] | Loss=6.05982 | acc=0.1422 | tpr=0.7291 | fpr=0.8686 | 7528.4 samples/s | 29.4 steps/s
[Step= 200] | Loss=6.05397 | acc=0.1420 | tpr=0.7377 | fpr=0.8688 | 8489.5 samples/s | 33.2 steps/s
[Step= 250] | Loss=6.05387 | acc=0.1428 | tpr=0.7432 | fpr=0.8681 | 8354.8 samples/s | 32.6 steps/s
[Step= 300] | Loss=6.05178 | acc=0.1431 | tpr=0.7498 | fpr=0.8679 | 8461.2 samples/s | 33.1 steps/s
[Step= 350] | Loss=6.05874 | acc=0.1430 | tpr=0.7539 | fpr=0.8681 | 7971.0 samples/s | 31.1 steps/s
[Step= 400] | Loss=6.06063 | acc=0.1426 | tpr=0.7484 | fpr=0.8684 | 7597.2 samples/s | 29.7 steps/s
[Step= 450] | Loss=6.06014 | acc=0.1425 | tpr=0.7425 | fpr=0.8684 | 7898.7 samples/s | 30.9 steps/s
[Step= 500] | Loss=6.06556 | acc=0.1423 | tpr=0.7405 | fpr=0.8685 | 7727.1 samples/s | 30.2 steps/s
[Step= 550] | Loss=6.06520 | acc=0.1427 | tpr=0.7409 | fpr=0.8682 | 10790.5 samples/s | 42.2 steps/s
Avg test loss: 6.06653, Avg test acc: 0.14257, Avg tpr: 0.74049, Avg fpr: 0.86829, total FA: 120561

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.15719 | acc=0.9637 | tpr=0.9204 | fpr=0.0355 | 4664.5 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.15958 | acc=0.9620 | tpr=0.9275 | fpr=0.0374 | 8076.7 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.16249 | acc=0.9612 | tpr=0.9308 | fpr=0.0382 | 7960.7 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.16141 | acc=0.9613 | tpr=0.9333 | fpr=0.0381 | 7254.3 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.16285 | acc=0.9612 | tpr=0.9293 | fpr=0.0383 | 8315.2 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.16329 | acc=0.9609 | tpr=0.9309 | fpr=0.0386 | 7908.2 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.16382 | acc=0.9608 | tpr=0.9317 | fpr=0.0387 | 8234.5 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.16533 | acc=0.9603 | tpr=0.9251 | fpr=0.0390 | 7993.0 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.16573 | acc=0.9602 | tpr=0.9241 | fpr=0.0392 | 7810.3 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.16562 | acc=0.9603 | tpr=0.9256 | fpr=0.0391 | 8062.3 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.16558 | acc=0.9603 | tpr=0.9244 | fpr=0.0390 | 10801.3 samples/s | 42.2 steps/s
Avg test loss: 0.16544, Avg test acc: 0.96031, Avg tpr: 0.92433, Avg fpr: 0.03904, total FA: 5420

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14137 | acc=0.9640 | tpr=0.8850 | fpr=0.0346 | 4887.2 samples/s | 19.1 steps/s
[Step= 100] | Loss=0.14608 | acc=0.9629 | tpr=0.9019 | fpr=0.0359 | 7340.9 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.14958 | acc=0.9623 | tpr=0.9049 | fpr=0.0367 | 7595.6 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.14973 | acc=0.9623 | tpr=0.9082 | fpr=0.0367 | 7869.6 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.15156 | acc=0.9619 | tpr=0.9092 | fpr=0.0371 | 7746.6 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.15149 | acc=0.9618 | tpr=0.9098 | fpr=0.0373 | 7883.9 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.15217 | acc=0.9616 | tpr=0.9130 | fpr=0.0375 | 8245.4 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.15327 | acc=0.9614 | tpr=0.9092 | fpr=0.0377 | 8033.0 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.15417 | acc=0.9611 | tpr=0.9094 | fpr=0.0379 | 8089.1 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.15393 | acc=0.9612 | tpr=0.9128 | fpr=0.0379 | 7798.4 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.15395 | acc=0.9612 | tpr=0.9101 | fpr=0.0378 | 11031.4 samples/s | 43.1 steps/s
Avg test loss: 0.15379, Avg test acc: 0.96127, Avg tpr: 0.91046, Avg fpr: 0.03781, total FA: 5250

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26303 | acc=0.9528 | tpr=0.9469 | fpr=0.0471 | 4618.8 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.27008 | acc=0.9519 | tpr=0.9446 | fpr=0.0479 | 7814.8 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.27698 | acc=0.9510 | tpr=0.9424 | fpr=0.0489 | 8416.0 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.27795 | acc=0.9510 | tpr=0.9486 | fpr=0.0490 | 7992.0 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.28077 | acc=0.9505 | tpr=0.9511 | fpr=0.0495 | 7816.0 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.28331 | acc=0.9501 | tpr=0.9513 | fpr=0.0499 | 8198.3 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.28367 | acc=0.9501 | tpr=0.9524 | fpr=0.0500 | 7810.0 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.28567 | acc=0.9498 | tpr=0.9502 | fpr=0.0502 | 8114.9 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.28744 | acc=0.9493 | tpr=0.9479 | fpr=0.0507 | 7829.6 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.28737 | acc=0.9492 | tpr=0.9493 | fpr=0.0508 | 8697.4 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.28672 | acc=0.9493 | tpr=0.9475 | fpr=0.0506 | 9084.7 samples/s | 35.5 steps/s
Avg test loss: 0.28624, Avg test acc: 0.94938, Avg tpr: 0.94770, Avg fpr: 0.05059, total FA: 7024

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11950 | acc=0.9677 | tpr=0.9071 | fpr=0.0312 | 4779.3 samples/s | 18.7 steps/s
[Step= 100] | Loss=0.12217 | acc=0.9665 | tpr=0.9104 | fpr=0.0325 | 7807.5 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.12661 | acc=0.9655 | tpr=0.9179 | fpr=0.0336 | 7709.2 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.12593 | acc=0.9659 | tpr=0.9279 | fpr=0.0334 | 7891.1 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.12754 | acc=0.9656 | tpr=0.9249 | fpr=0.0336 | 8068.2 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.12882 | acc=0.9654 | tpr=0.9244 | fpr=0.0339 | 7970.4 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.12991 | acc=0.9652 | tpr=0.9261 | fpr=0.0340 | 8708.1 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.13072 | acc=0.9650 | tpr=0.9223 | fpr=0.0342 | 8283.7 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.13201 | acc=0.9648 | tpr=0.9202 | fpr=0.0344 | 7393.5 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.13162 | acc=0.9649 | tpr=0.9238 | fpr=0.0344 | 7739.2 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.13104 | acc=0.9650 | tpr=0.9228 | fpr=0.0342 | 10255.0 samples/s | 40.1 steps/s
Avg test loss: 0.13082, Avg test acc: 0.96506, Avg tpr: 0.92274, Avg fpr: 0.03417, total FA: 4744

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21452 | acc=0.9581 | tpr=0.9204 | fpr=0.0412 | 4685.9 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.21828 | acc=0.9565 | tpr=0.9339 | fpr=0.0431 | 7717.8 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.22031 | acc=0.9556 | tpr=0.9380 | fpr=0.0441 | 8111.4 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.22136 | acc=0.9562 | tpr=0.9454 | fpr=0.0436 | 7805.1 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.22332 | acc=0.9560 | tpr=0.9424 | fpr=0.0437 | 7900.9 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.22564 | acc=0.9555 | tpr=0.9418 | fpr=0.0443 | 8246.0 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.22547 | acc=0.9556 | tpr=0.9411 | fpr=0.0441 | 7856.5 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.22633 | acc=0.9553 | tpr=0.9338 | fpr=0.0443 | 7383.7 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.22674 | acc=0.9550 | tpr=0.9328 | fpr=0.0446 | 8355.4 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.22694 | acc=0.9549 | tpr=0.9348 | fpr=0.0447 | 8100.2 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.22608 | acc=0.9550 | tpr=0.9324 | fpr=0.0446 | 10711.2 samples/s | 41.8 steps/s
Avg test loss: 0.22576, Avg test acc: 0.95509, Avg tpr: 0.93265, Avg fpr: 0.04450, total FA: 6179

server round 18/50

clients selected: [0 4 7 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=26001 Epoch=126.8] | Loss=0.05876 | Reg=0.00137 | acc=0.9375 | L2-Norm=11.702 | L2-Norm(final)=12.941 | 3328.7 samples/s | 52.0 steps/s
[Step=26050 Epoch=127.0] | Loss=0.06102 | Reg=0.00137 | acc=0.9531 | L2-Norm=11.705 | L2-Norm(final)=12.911 | 4862.9 samples/s | 76.0 steps/s
[Step=26100 Epoch=127.3] | Loss=0.05447 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.706 | L2-Norm(final)=12.892 | 5521.5 samples/s | 86.3 steps/s
[Step=26150 Epoch=127.5] | Loss=0.05019 | Reg=0.00137 | acc=0.9531 | L2-Norm=11.706 | L2-Norm(final)=12.894 | 5379.2 samples/s | 84.1 steps/s
[Step=26200 Epoch=127.8] | Loss=0.04863 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.707 | L2-Norm(final)=12.896 | 8498.1 samples/s | 132.8 steps/s
[Step=26250 Epoch=128.0] | Loss=0.04768 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.707 | L2-Norm(final)=12.901 | 1487.0 samples/s | 23.2 steps/s
[Step=26300 Epoch=128.2] | Loss=0.04631 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.707 | L2-Norm(final)=12.907 | 5556.6 samples/s | 86.8 steps/s
[Step=26350 Epoch=128.5] | Loss=0.04565 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.707 | L2-Norm(final)=12.917 | 5396.2 samples/s | 84.3 steps/s
[Step=26400 Epoch=128.7] | Loss=0.04548 | Reg=0.00137 | acc=0.9531 | L2-Norm=11.707 | L2-Norm(final)=12.926 | 7558.6 samples/s | 118.1 steps/s
[Step=26450 Epoch=129.0] | Loss=0.04550 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.707 | L2-Norm(final)=12.935 | 1506.9 samples/s | 23.5 steps/s
[Step=26500 Epoch=129.2] | Loss=0.04502 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.707 | L2-Norm(final)=12.944 | 5519.4 samples/s | 86.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=26501 Epoch=129.2] | Loss=0.03958 | Reg=0.00137 | acc=0.9531 | L2-Norm=11.707 | L2-Norm(final)=13.040 | 3205.8 samples/s | 50.1 steps/s
[Step=26550 Epoch=129.5] | Loss=0.04346 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.811 | L2-Norm(final)=13.042 | 4195.7 samples/s | 65.6 steps/s
[Step=26600 Epoch=129.7] | Loss=0.04770 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.906 | L2-Norm(final)=13.026 | 4688.7 samples/s | 73.3 steps/s
[Step=26650 Epoch=130.0] | Loss=0.04503 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.976 | L2-Norm(final)=13.016 | 4731.3 samples/s | 73.9 steps/s
[Step=26700 Epoch=130.2] | Loss=0.04310 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.033 | L2-Norm(final)=13.011 | 6760.5 samples/s | 105.6 steps/s
[Step=26750 Epoch=130.4] | Loss=0.03766 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.080 | L2-Norm(final)=13.007 | 1426.7 samples/s | 22.3 steps/s
[Step=26800 Epoch=130.7] | Loss=0.03358 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.119 | L2-Norm(final)=13.008 | 4643.6 samples/s | 72.6 steps/s
[Step=26850 Epoch=130.9] | Loss=0.03167 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=13.008 | 4693.5 samples/s | 73.3 steps/s
[Step=26900 Epoch=131.2] | Loss=0.03033 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.181 | L2-Norm(final)=13.008 | 6131.7 samples/s | 95.8 steps/s
[Step=26950 Epoch=131.4] | Loss=0.02847 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.207 | L2-Norm(final)=13.008 | 1449.6 samples/s | 22.6 steps/s
[Step=27000 Epoch=131.7] | Loss=0.02681 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=13.010 | 4593.8 samples/s | 71.8 steps/s
[Step=27050 Epoch=131.9] | Loss=0.02518 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=13.011 | 4708.3 samples/s | 73.6 steps/s
[Step=27100 Epoch=132.1] | Loss=0.02398 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.273 | L2-Norm(final)=13.013 | 5636.8 samples/s | 88.1 steps/s
[Step=27150 Epoch=132.4] | Loss=0.02303 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.291 | L2-Norm(final)=13.015 | 1471.7 samples/s | 23.0 steps/s
[Step=27200 Epoch=132.6] | Loss=0.02198 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=13.016 | 4752.2 samples/s | 74.3 steps/s
[Step=27250 Epoch=132.9] | Loss=0.02092 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=13.018 | 4745.5 samples/s | 74.1 steps/s
[Step=27300 Epoch=133.1] | Loss=0.02025 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=13.020 | 5255.2 samples/s | 82.1 steps/s
[Step=27350 Epoch=133.4] | Loss=0.01945 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.349 | L2-Norm(final)=13.022 | 1496.2 samples/s | 23.4 steps/s
[Step=27400 Epoch=133.6] | Loss=0.01870 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.361 | L2-Norm(final)=13.024 | 4633.3 samples/s | 72.4 steps/s
[Step=27450 Epoch=133.9] | Loss=0.01824 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.373 | L2-Norm(final)=13.026 | 4664.4 samples/s | 72.9 steps/s
[Step=27500 Epoch=134.1] | Loss=0.01777 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.383 | L2-Norm(final)=13.028 | 4803.7 samples/s | 75.1 steps/s
[Step=27550 Epoch=134.3] | Loss=0.01726 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.394 | L2-Norm(final)=13.030 | 1497.6 samples/s | 23.4 steps/s
[Step=27600 Epoch=134.6] | Loss=0.01668 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.404 | L2-Norm(final)=13.032 | 4613.2 samples/s | 72.1 steps/s
[Step=27650 Epoch=134.8] | Loss=0.01633 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.414 | L2-Norm(final)=13.034 | 4625.5 samples/s | 72.3 steps/s
[Step=27700 Epoch=135.1] | Loss=0.01603 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.424 | L2-Norm(final)=13.035 | 4642.0 samples/s | 72.5 steps/s
[Step=27750 Epoch=135.3] | Loss=0.01565 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=13.037 | 1524.1 samples/s | 23.8 steps/s
[Step=27800 Epoch=135.6] | Loss=0.01526 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.442 | L2-Norm(final)=13.038 | 4601.5 samples/s | 71.9 steps/s
[Step=27850 Epoch=135.8] | Loss=0.01487 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.450 | L2-Norm(final)=13.040 | 4618.1 samples/s | 72.2 steps/s
[Step=27900 Epoch=136.0] | Loss=0.01450 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=13.042 | 4611.6 samples/s | 72.1 steps/s
[Step=27950 Epoch=136.3] | Loss=0.01427 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=13.044 | 1525.9 samples/s | 23.8 steps/s
[Step=28000 Epoch=136.5] | Loss=0.01402 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.473 | L2-Norm(final)=13.045 | 4641.8 samples/s | 72.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step28000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=49.0] | Loss=0.03566 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.702 | L2-Norm(final)=10.135 | 3190.7 samples/s | 49.9 steps/s
[Step=10050 Epoch=49.3] | Loss=0.04427 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.701 | L2-Norm(final)=10.144 | 4674.3 samples/s | 73.0 steps/s
[Step=10100 Epoch=49.5] | Loss=0.04328 | Reg=0.00137 | acc=0.9375 | L2-Norm=11.701 | L2-Norm(final)=10.156 | 5417.6 samples/s | 84.7 steps/s
[Step=10150 Epoch=49.8] | Loss=0.04203 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.701 | L2-Norm(final)=10.168 | 5336.8 samples/s | 83.4 steps/s
[Step=10200 Epoch=50.0] | Loss=0.04114 | Reg=0.00137 | acc=0.9531 | L2-Norm=11.701 | L2-Norm(final)=10.187 | 8708.0 samples/s | 136.1 steps/s
[Step=10250 Epoch=50.3] | Loss=0.04081 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.701 | L2-Norm(final)=10.208 | 1438.5 samples/s | 22.5 steps/s
[Step=10300 Epoch=50.5] | Loss=0.04105 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.701 | L2-Norm(final)=10.227 | 5286.8 samples/s | 82.6 steps/s
[Step=10350 Epoch=50.8] | Loss=0.04083 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.701 | L2-Norm(final)=10.245 | 5387.0 samples/s | 84.2 steps/s
[Step=10400 Epoch=51.0] | Loss=0.04084 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.701 | L2-Norm(final)=10.261 | 8091.5 samples/s | 126.4 steps/s
[Step=10450 Epoch=51.2] | Loss=0.04117 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.701 | L2-Norm(final)=10.277 | 1456.7 samples/s | 22.8 steps/s
[Step=10500 Epoch=51.5] | Loss=0.04133 | Reg=0.00137 | acc=0.9531 | L2-Norm=11.701 | L2-Norm(final)=10.293 | 5423.6 samples/s | 84.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=51.5] | Loss=0.03124 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.701 | L2-Norm(final)=10.447 | 3178.5 samples/s | 49.7 steps/s
[Step=10550 Epoch=51.7] | Loss=0.04563 | Reg=0.00139 | acc=0.9219 | L2-Norm=11.782 | L2-Norm(final)=10.435 | 4250.4 samples/s | 66.4 steps/s
[Step=10600 Epoch=52.0] | Loss=0.04564 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.883 | L2-Norm(final)=10.417 | 4695.3 samples/s | 73.4 steps/s
[Step=10650 Epoch=52.2] | Loss=0.04485 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.965 | L2-Norm(final)=10.406 | 4642.3 samples/s | 72.5 steps/s
[Step=10700 Epoch=52.5] | Loss=0.04450 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.030 | L2-Norm(final)=10.396 | 6677.4 samples/s | 104.3 steps/s
[Step=10750 Epoch=52.7] | Loss=0.04086 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.086 | L2-Norm(final)=10.390 | 1366.9 samples/s | 21.4 steps/s
[Step=10800 Epoch=53.0] | Loss=0.03656 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=10.391 | 4580.3 samples/s | 71.6 steps/s
[Step=10850 Epoch=53.2] | Loss=0.03430 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.177 | L2-Norm(final)=10.394 | 4665.5 samples/s | 72.9 steps/s
[Step=10900 Epoch=53.5] | Loss=0.03224 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.213 | L2-Norm(final)=10.396 | 6336.9 samples/s | 99.0 steps/s
[Step=10950 Epoch=53.7] | Loss=0.02977 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.245 | L2-Norm(final)=10.401 | 1400.0 samples/s | 21.9 steps/s
[Step=11000 Epoch=53.9] | Loss=0.02786 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=10.406 | 4630.3 samples/s | 72.3 steps/s
[Step=11050 Epoch=54.2] | Loss=0.02655 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.300 | L2-Norm(final)=10.410 | 4579.3 samples/s | 71.6 steps/s
[Step=11100 Epoch=54.4] | Loss=0.02513 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=10.414 | 6021.7 samples/s | 94.1 steps/s
[Step=11150 Epoch=54.7] | Loss=0.02391 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.345 | L2-Norm(final)=10.419 | 1399.1 samples/s | 21.9 steps/s
[Step=11200 Epoch=54.9] | Loss=0.02272 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.364 | L2-Norm(final)=10.424 | 4597.9 samples/s | 71.8 steps/s
[Step=11250 Epoch=55.2] | Loss=0.02167 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.382 | L2-Norm(final)=10.428 | 4659.7 samples/s | 72.8 steps/s
[Step=11300 Epoch=55.4] | Loss=0.02078 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=10.433 | 5550.0 samples/s | 86.7 steps/s
[Step=11350 Epoch=55.7] | Loss=0.01997 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.413 | L2-Norm(final)=10.437 | 1433.4 samples/s | 22.4 steps/s
[Step=11400 Epoch=55.9] | Loss=0.01918 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=10.442 | 4647.3 samples/s | 72.6 steps/s
[Step=11450 Epoch=56.1] | Loss=0.01845 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=10.446 | 4542.8 samples/s | 71.0 steps/s
[Step=11500 Epoch=56.4] | Loss=0.01807 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.453 | L2-Norm(final)=10.451 | 5338.9 samples/s | 83.4 steps/s
[Step=11550 Epoch=56.6] | Loss=0.01751 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.465 | L2-Norm(final)=10.454 | 1457.9 samples/s | 22.8 steps/s
[Step=11600 Epoch=56.9] | Loss=0.01688 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=10.458 | 4592.3 samples/s | 71.8 steps/s
[Step=11650 Epoch=57.1] | Loss=0.01644 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.487 | L2-Norm(final)=10.462 | 4635.4 samples/s | 72.4 steps/s
[Step=11700 Epoch=57.4] | Loss=0.01604 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=10.466 | 5047.3 samples/s | 78.9 steps/s
[Step=11750 Epoch=57.6] | Loss=0.01560 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.508 | L2-Norm(final)=10.469 | 1461.8 samples/s | 22.8 steps/s
[Step=11800 Epoch=57.9] | Loss=0.01515 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.518 | L2-Norm(final)=10.473 | 4585.1 samples/s | 71.6 steps/s
[Step=11850 Epoch=58.1] | Loss=0.01486 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.529 | L2-Norm(final)=10.477 | 4663.2 samples/s | 72.9 steps/s
[Step=11900 Epoch=58.4] | Loss=0.01460 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.539 | L2-Norm(final)=10.480 | 4812.7 samples/s | 75.2 steps/s
[Step=11950 Epoch=58.6] | Loss=0.01442 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=10.484 | 1477.2 samples/s | 23.1 steps/s
[Step=12000 Epoch=58.8] | Loss=0.01431 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.560 | L2-Norm(final)=10.487 | 4626.3 samples/s | 72.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_4/client_state-step12000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=24001 Epoch=229.2] | Loss=0.00063 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.702 | L2-Norm(final)=15.243 | 3054.8 samples/s | 47.7 steps/s
[Step=24050 Epoch=229.7] | Loss=0.00092 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.695 | L2-Norm(final)=15.280 | 4575.6 samples/s | 71.5 steps/s
[Step=24100 Epoch=230.1] | Loss=0.00086 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.694 | L2-Norm(final)=15.322 | 8202.2 samples/s | 128.2 steps/s
[Step=24150 Epoch=230.6] | Loss=0.00072 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.694 | L2-Norm(final)=15.361 | 1410.4 samples/s | 22.0 steps/s
[Step=24200 Epoch=231.1] | Loss=0.00082 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.694 | L2-Norm(final)=15.398 | 7390.8 samples/s | 115.5 steps/s
[Step=24250 Epoch=231.6] | Loss=0.00083 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.694 | L2-Norm(final)=15.435 | 1474.0 samples/s | 23.0 steps/s
[Step=24300 Epoch=232.1] | Loss=0.00080 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.694 | L2-Norm(final)=15.469 | 6684.3 samples/s | 104.4 steps/s
[Step=24350 Epoch=232.5] | Loss=0.00079 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.694 | L2-Norm(final)=15.502 | 1459.9 samples/s | 22.8 steps/s
[Step=24400 Epoch=233.0] | Loss=0.00079 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.694 | L2-Norm(final)=15.535 | 6105.8 samples/s | 95.4 steps/s
[Step=24450 Epoch=233.5] | Loss=0.00079 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.694 | L2-Norm(final)=15.566 | 1461.6 samples/s | 22.8 steps/s
[Step=24500 Epoch=234.0] | Loss=0.00077 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.694 | L2-Norm(final)=15.597 | 5585.8 samples/s | 87.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=234.0] | Loss=0.00709 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.693 | L2-Norm(final)=15.897 | 3030.9 samples/s | 47.4 steps/s
[Step=24550 Epoch=234.4] | Loss=0.01340 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.951 | L2-Norm(final)=15.852 | 4061.6 samples/s | 63.5 steps/s
[Step=24600 Epoch=234.9] | Loss=0.00758 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=15.820 | 6523.3 samples/s | 101.9 steps/s
[Step=24650 Epoch=235.4] | Loss=0.00589 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=15.808 | 1349.0 samples/s | 21.1 steps/s
[Step=24700 Epoch=235.9] | Loss=0.00455 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.189 | L2-Norm(final)=15.802 | 5969.1 samples/s | 93.3 steps/s
[Step=24750 Epoch=236.3] | Loss=0.00365 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.201 | L2-Norm(final)=15.798 | 1388.3 samples/s | 21.7 steps/s
[Step=24800 Epoch=236.8] | Loss=0.00305 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=15.797 | 5537.7 samples/s | 86.5 steps/s
[Step=24850 Epoch=237.3] | Loss=0.00261 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.200 | L2-Norm(final)=15.797 | 1392.2 samples/s | 21.8 steps/s
[Step=24900 Epoch=237.8] | Loss=0.00229 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.193 | L2-Norm(final)=15.797 | 5149.6 samples/s | 80.5 steps/s
[Step=24950 Epoch=238.3] | Loss=0.00203 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=15.798 | 1423.0 samples/s | 22.2 steps/s
[Step=25000 Epoch=238.7] | Loss=0.00183 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=15.798 | 4827.7 samples/s | 75.4 steps/s
[Step=25050 Epoch=239.2] | Loss=0.00167 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=15.799 | 1453.1 samples/s | 22.7 steps/s
[Step=25100 Epoch=239.7] | Loss=0.00153 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=15.800 | 4580.1 samples/s | 71.6 steps/s
[Step=25150 Epoch=240.2] | Loss=0.00141 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=15.801 | 1482.5 samples/s | 23.2 steps/s
[Step=25200 Epoch=240.6] | Loss=0.00131 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.126 | L2-Norm(final)=15.802 | 4455.3 samples/s | 69.6 steps/s
[Step=25250 Epoch=241.1] | Loss=0.00122 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.114 | L2-Norm(final)=15.802 | 1495.5 samples/s | 23.4 steps/s
[Step=25300 Epoch=241.6] | Loss=0.00115 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.101 | L2-Norm(final)=15.803 | 4542.4 samples/s | 71.0 steps/s
[Step=25350 Epoch=242.1] | Loss=0.00108 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.088 | L2-Norm(final)=15.805 | 1491.0 samples/s | 23.3 steps/s
[Step=25400 Epoch=242.6] | Loss=0.00102 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.076 | L2-Norm(final)=15.806 | 4362.3 samples/s | 68.2 steps/s
[Step=25450 Epoch=243.0] | Loss=0.00097 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.063 | L2-Norm(final)=15.807 | 1483.9 samples/s | 23.2 steps/s
[Step=25500 Epoch=243.5] | Loss=0.00092 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.050 | L2-Norm(final)=15.808 | 4371.3 samples/s | 68.3 steps/s
[Step=25550 Epoch=244.0] | Loss=0.00087 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.037 | L2-Norm(final)=15.810 | 7137.6 samples/s | 111.5 steps/s
[Step=25600 Epoch=244.5] | Loss=0.00083 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.024 | L2-Norm(final)=15.811 | 1311.3 samples/s | 20.5 steps/s
[Step=25650 Epoch=244.9] | Loss=0.00080 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.012 | L2-Norm(final)=15.812 | 6425.6 samples/s | 100.4 steps/s
[Step=25700 Epoch=245.4] | Loss=0.00076 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.999 | L2-Norm(final)=15.814 | 1342.9 samples/s | 21.0 steps/s
[Step=25750 Epoch=245.9] | Loss=0.00073 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.986 | L2-Norm(final)=15.815 | 6043.3 samples/s | 94.4 steps/s
[Step=25800 Epoch=246.4] | Loss=0.00071 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.974 | L2-Norm(final)=15.817 | 1359.5 samples/s | 21.2 steps/s
[Step=25850 Epoch=246.9] | Loss=0.00068 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.961 | L2-Norm(final)=15.818 | 5538.5 samples/s | 86.5 steps/s
[Step=25900 Epoch=247.3] | Loss=0.00066 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.948 | L2-Norm(final)=15.820 | 1398.6 samples/s | 21.9 steps/s
[Step=25950 Epoch=247.8] | Loss=0.00063 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.935 | L2-Norm(final)=15.821 | 5119.7 samples/s | 80.0 steps/s
[Step=26000 Epoch=248.3] | Loss=0.00061 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.923 | L2-Norm(final)=15.823 | 1421.0 samples/s | 22.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step26000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=113.1] | Loss=0.00415 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.702 | L2-Norm(final)=11.827 | 3025.0 samples/s | 47.3 steps/s
[Step=12050 Epoch=113.5] | Loss=0.00565 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=11.875 | 4461.2 samples/s | 69.7 steps/s
[Step=12100 Epoch=114.0] | Loss=0.00554 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=11.914 | 7880.5 samples/s | 123.1 steps/s
[Step=12150 Epoch=114.5] | Loss=0.00557 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.696 | L2-Norm(final)=11.958 | 1429.3 samples/s | 22.3 steps/s
[Step=12200 Epoch=115.0] | Loss=0.00508 | Reg=0.00137 | acc=0.9531 | L2-Norm=11.696 | L2-Norm(final)=11.994 | 6868.1 samples/s | 107.3 steps/s
[Step=12250 Epoch=115.4] | Loss=0.00564 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.696 | L2-Norm(final)=12.030 | 1454.8 samples/s | 22.7 steps/s
[Step=12300 Epoch=115.9] | Loss=0.00534 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.696 | L2-Norm(final)=12.062 | 6103.3 samples/s | 95.4 steps/s
[Step=12350 Epoch=116.4] | Loss=0.00540 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.696 | L2-Norm(final)=12.092 | 1496.7 samples/s | 23.4 steps/s
[Step=12400 Epoch=116.8] | Loss=0.00535 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.696 | L2-Norm(final)=12.119 | 5450.0 samples/s | 85.2 steps/s
[Step=12450 Epoch=117.3] | Loss=0.00518 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.696 | L2-Norm(final)=12.147 | 1559.5 samples/s | 24.4 steps/s
[Step=12500 Epoch=117.8] | Loss=0.00522 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.696 | L2-Norm(final)=12.175 | 5154.5 samples/s | 80.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=117.8] | Loss=0.00055 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.696 | L2-Norm(final)=12.450 | 3172.3 samples/s | 49.6 steps/s
[Step=12550 Epoch=118.3] | Loss=0.00523 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.841 | L2-Norm(final)=12.456 | 3909.5 samples/s | 61.1 steps/s
[Step=12600 Epoch=118.7] | Loss=0.00866 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.018 | L2-Norm(final)=12.440 | 6293.9 samples/s | 98.3 steps/s
[Step=12650 Epoch=119.2] | Loss=0.00656 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=12.424 | 1344.5 samples/s | 21.0 steps/s
[Step=12700 Epoch=119.7] | Loss=0.00512 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=12.419 | 5675.1 samples/s | 88.7 steps/s
[Step=12750 Epoch=120.1] | Loss=0.00414 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.192 | L2-Norm(final)=12.417 | 1392.0 samples/s | 21.7 steps/s
[Step=12800 Epoch=120.6] | Loss=0.00346 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.205 | L2-Norm(final)=12.416 | 4960.8 samples/s | 77.5 steps/s
[Step=12850 Epoch=121.1] | Loss=0.00297 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.210 | L2-Norm(final)=12.416 | 1440.1 samples/s | 22.5 steps/s
[Step=12900 Epoch=121.6] | Loss=0.00260 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.210 | L2-Norm(final)=12.416 | 4630.9 samples/s | 72.4 steps/s
[Step=12950 Epoch=122.0] | Loss=0.00231 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=12.416 | 1470.7 samples/s | 23.0 steps/s
[Step=13000 Epoch=122.5] | Loss=0.00208 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.204 | L2-Norm(final)=12.416 | 4346.2 samples/s | 67.9 steps/s
[Step=13050 Epoch=123.0] | Loss=0.00189 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.198 | L2-Norm(final)=12.416 | 1481.6 samples/s | 23.2 steps/s
[Step=13100 Epoch=123.4] | Loss=0.00173 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.191 | L2-Norm(final)=12.416 | 4412.7 samples/s | 68.9 steps/s
[Step=13150 Epoch=123.9] | Loss=0.00160 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=12.417 | 1496.0 samples/s | 23.4 steps/s
[Step=13200 Epoch=124.4] | Loss=0.00149 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=12.417 | 4400.9 samples/s | 68.8 steps/s
[Step=13250 Epoch=124.9] | Loss=0.00139 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=12.417 | 1628.9 samples/s | 25.5 steps/s
[Step=13300 Epoch=125.3] | Loss=0.00130 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=12.417 | 3665.2 samples/s | 57.3 steps/s
[Step=13350 Epoch=125.8] | Loss=0.00122 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=12.417 | 6457.4 samples/s | 100.9 steps/s
[Step=13400 Epoch=126.3] | Loss=0.00116 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=12.417 | 1356.5 samples/s | 21.2 steps/s
[Step=13450 Epoch=126.7] | Loss=0.00109 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.126 | L2-Norm(final)=12.417 | 5789.5 samples/s | 90.5 steps/s
[Step=13500 Epoch=127.2] | Loss=0.00104 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.115 | L2-Norm(final)=12.418 | 1395.5 samples/s | 21.8 steps/s
[Step=13550 Epoch=127.7] | Loss=0.00099 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=12.418 | 5198.4 samples/s | 81.2 steps/s
[Step=13600 Epoch=128.2] | Loss=0.00095 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.093 | L2-Norm(final)=12.418 | 1434.1 samples/s | 22.4 steps/s
[Step=13650 Epoch=128.6] | Loss=0.00090 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.082 | L2-Norm(final)=12.418 | 4722.5 samples/s | 73.8 steps/s
[Step=13700 Epoch=129.1] | Loss=0.00087 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.071 | L2-Norm(final)=12.418 | 1477.0 samples/s | 23.1 steps/s
[Step=13750 Epoch=129.6] | Loss=0.00083 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.060 | L2-Norm(final)=12.418 | 4448.1 samples/s | 69.5 steps/s
[Step=13800 Epoch=130.0] | Loss=0.00080 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.049 | L2-Norm(final)=12.418 | 1495.9 samples/s | 23.4 steps/s
[Step=13850 Epoch=130.5] | Loss=0.00077 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.037 | L2-Norm(final)=12.418 | 4399.6 samples/s | 68.7 steps/s
[Step=13900 Epoch=131.0] | Loss=0.00074 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.026 | L2-Norm(final)=12.419 | 1499.8 samples/s | 23.4 steps/s
[Step=13950 Epoch=131.4] | Loss=0.00072 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.015 | L2-Norm(final)=12.419 | 4383.7 samples/s | 68.5 steps/s
[Step=14000 Epoch=131.9] | Loss=0.00069 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.003 | L2-Norm(final)=12.419 | 1587.3 samples/s | 24.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_3/client_state-step14000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=171.6] | Loss=0.00060 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.702 | L2-Norm(final)=16.000 | 3096.9 samples/s | 48.4 steps/s
[Step=18050 Epoch=172.0] | Loss=0.00423 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.698 | L2-Norm(final)=15.993 | 4666.2 samples/s | 72.9 steps/s
[Step=18100 Epoch=172.5] | Loss=0.00540 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=16.006 | 7819.7 samples/s | 122.2 steps/s
[Step=18150 Epoch=173.0] | Loss=0.00527 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=16.030 | 1414.9 samples/s | 22.1 steps/s
[Step=18200 Epoch=173.5] | Loss=0.00498 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=16.052 | 7162.7 samples/s | 111.9 steps/s
[Step=18250 Epoch=173.9] | Loss=0.00505 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=16.076 | 1428.5 samples/s | 22.3 steps/s
[Step=18300 Epoch=174.4] | Loss=0.00507 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=16.101 | 6693.6 samples/s | 104.6 steps/s
[Step=18350 Epoch=174.9] | Loss=0.00505 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=16.126 | 1455.8 samples/s | 22.7 steps/s
[Step=18400 Epoch=175.4] | Loss=0.00503 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=16.150 | 6028.9 samples/s | 94.2 steps/s
[Step=18450 Epoch=175.8] | Loss=0.00494 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=16.177 | 1491.2 samples/s | 23.3 steps/s
[Step=18500 Epoch=176.3] | Loss=0.00489 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=16.203 | 5611.0 samples/s | 87.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=176.3] | Loss=0.00430 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=16.465 | 3243.7 samples/s | 50.7 steps/s
[Step=18550 Epoch=176.8] | Loss=0.00749 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.820 | L2-Norm(final)=16.471 | 3843.4 samples/s | 60.1 steps/s
[Step=18600 Epoch=177.3] | Loss=0.00716 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.952 | L2-Norm(final)=16.451 | 6630.4 samples/s | 103.6 steps/s
[Step=18650 Epoch=177.8] | Loss=0.00485 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.014 | L2-Norm(final)=16.445 | 1397.4 samples/s | 21.8 steps/s
[Step=18700 Epoch=178.2] | Loss=0.00377 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.038 | L2-Norm(final)=16.443 | 6049.9 samples/s | 94.5 steps/s
[Step=18750 Epoch=178.7] | Loss=0.00304 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.049 | L2-Norm(final)=16.443 | 1416.0 samples/s | 22.1 steps/s
[Step=18800 Epoch=179.2] | Loss=0.00253 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.052 | L2-Norm(final)=16.443 | 5620.1 samples/s | 87.8 steps/s
[Step=18850 Epoch=179.7] | Loss=0.00217 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.049 | L2-Norm(final)=16.444 | 1427.1 samples/s | 22.3 steps/s
[Step=18900 Epoch=180.1] | Loss=0.00190 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.043 | L2-Norm(final)=16.444 | 5168.3 samples/s | 80.8 steps/s
[Step=18950 Epoch=180.6] | Loss=0.00169 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.036 | L2-Norm(final)=16.444 | 1448.1 samples/s | 22.6 steps/s
[Step=19000 Epoch=181.1] | Loss=0.00152 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.027 | L2-Norm(final)=16.445 | 4877.7 samples/s | 76.2 steps/s
[Step=19050 Epoch=181.6] | Loss=0.00139 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.017 | L2-Norm(final)=16.445 | 1497.1 samples/s | 23.4 steps/s
[Step=19100 Epoch=182.0] | Loss=0.00127 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.007 | L2-Norm(final)=16.445 | 4554.4 samples/s | 71.2 steps/s
[Step=19150 Epoch=182.5] | Loss=0.00117 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.996 | L2-Norm(final)=16.446 | 1519.1 samples/s | 23.7 steps/s
[Step=19200 Epoch=183.0] | Loss=0.00109 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.985 | L2-Norm(final)=16.446 | 4476.5 samples/s | 69.9 steps/s
[Step=19250 Epoch=183.5] | Loss=0.00102 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.974 | L2-Norm(final)=16.446 | 1521.3 samples/s | 23.8 steps/s
[Step=19300 Epoch=183.9] | Loss=0.00095 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.962 | L2-Norm(final)=16.447 | 4511.1 samples/s | 70.5 steps/s
[Step=19350 Epoch=184.4] | Loss=0.00090 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.951 | L2-Norm(final)=16.447 | 1298.2 samples/s | 20.3 steps/s
[Step=19400 Epoch=184.9] | Loss=0.00085 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.939 | L2-Norm(final)=16.447 | 4179.9 samples/s | 65.3 steps/s
[Step=19450 Epoch=185.4] | Loss=0.00080 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.927 | L2-Norm(final)=16.448 | 1498.4 samples/s | 23.4 steps/s
[Step=19500 Epoch=185.9] | Loss=0.00076 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.915 | L2-Norm(final)=16.448 | 4441.1 samples/s | 69.4 steps/s
[Step=19550 Epoch=186.3] | Loss=0.00073 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=16.448 | 7251.5 samples/s | 113.3 steps/s
[Step=19600 Epoch=186.8] | Loss=0.00069 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.891 | L2-Norm(final)=16.449 | 1359.9 samples/s | 21.2 steps/s
[Step=19650 Epoch=187.3] | Loss=0.00066 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.879 | L2-Norm(final)=16.449 | 6529.1 samples/s | 102.0 steps/s
[Step=19700 Epoch=187.8] | Loss=0.00064 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.867 | L2-Norm(final)=16.449 | 1371.6 samples/s | 21.4 steps/s
[Step=19750 Epoch=188.2] | Loss=0.00061 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.855 | L2-Norm(final)=16.450 | 6071.4 samples/s | 94.9 steps/s
[Step=19800 Epoch=188.7] | Loss=0.00059 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.843 | L2-Norm(final)=16.450 | 1398.4 samples/s | 21.8 steps/s
[Step=19850 Epoch=189.2] | Loss=0.00057 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.831 | L2-Norm(final)=16.450 | 5608.3 samples/s | 87.6 steps/s
[Step=19900 Epoch=189.7] | Loss=0.00055 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.818 | L2-Norm(final)=16.451 | 1417.7 samples/s | 22.2 steps/s
[Step=19950 Epoch=190.1] | Loss=0.00053 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.806 | L2-Norm(final)=16.451 | 5169.1 samples/s | 80.8 steps/s
[Step=20000 Epoch=190.6] | Loss=0.00051 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.794 | L2-Norm(final)=16.451 | 1466.3 samples/s | 22.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09932 | acc=0.9533 | tpr=0.9630 | fpr=0.0679 | 4660.0 samples/s | 18.2 steps/s
Avg test loss: 0.10789, Avg test acc: 0.94915, Avg tpr: 0.96002, Avg fpr: 0.07473, total FA: 583

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.13479 | acc=0.9495 | tpr=0.9735 | fpr=0.1028 | 4465.6 samples/s | 17.4 steps/s
Avg test loss: 0.13693, Avg test acc: 0.94799, Avg tpr: 0.97371, Avg fpr: 0.10858, total FA: 847

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11102 | acc=0.9488 | tpr=0.9604 | fpr=0.0763 | 4599.2 samples/s | 18.0 steps/s
Avg test loss: 0.11593, Avg test acc: 0.94883, Avg tpr: 0.95978, Avg fpr: 0.07525, total FA: 587

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.12736 | acc=0.9501 | tpr=0.9550 | fpr=0.0607 | 4659.9 samples/s | 18.2 steps/s
Avg test loss: 0.13036, Avg test acc: 0.95032, Avg tpr: 0.95623, Avg fpr: 0.06268, total FA: 489

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10287 | acc=0.9495 | tpr=0.9637 | fpr=0.0815 | 4747.7 samples/s | 18.5 steps/s
Avg test loss: 0.10637, Avg test acc: 0.94903, Avg tpr: 0.96328, Avg fpr: 0.08230, total FA: 642

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.79613 | acc=0.3158 | tpr=0.0062 | fpr=0.0119 | 4775.2 samples/s | 18.7 steps/s
Avg test loss: 5.80721, Avg test acc: 0.31329, Avg tpr: 0.00624, Avg fpr: 0.01141, total FA: 89

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.67836 | acc=0.3033 | tpr=0.0209 | fpr=0.0835 | 4590.6 samples/s | 17.9 steps/s
Avg test loss: 4.70378, Avg test acc: 0.30307, Avg tpr: 0.02116, Avg fpr: 0.07691, total FA: 600

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.73506 | acc=0.3112 | tpr=0.0033 | fpr=0.0203 | 4852.4 samples/s | 19.0 steps/s
Avg test loss: 4.75639, Avg test acc: 0.30820, Avg tpr: 0.00332, Avg fpr: 0.02128, total FA: 166

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.64201 | acc=0.2994 | tpr=0.0260 | fpr=0.1070 | 4649.2 samples/s | 18.2 steps/s
Avg test loss: 4.66010, Avg test acc: 0.29562, Avg tpr: 0.02489, Avg fpr: 0.10896, total FA: 850

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.03713 | acc=0.3154 | tpr=0.0131 | fpr=0.0282 | 4792.6 samples/s | 18.7 steps/s
Avg test loss: 5.06746, Avg test acc: 0.31317, Avg tpr: 0.01381, Avg fpr: 0.02846, total FA: 222

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.19493 | acc=0.1490 | tpr=0.7566 | fpr=0.8619 | 4510.3 samples/s | 17.6 steps/s
[Step= 100] | Loss=5.16932 | acc=0.1499 | tpr=0.7186 | fpr=0.8607 | 8283.1 samples/s | 32.4 steps/s
[Step= 150] | Loss=5.18262 | acc=0.1517 | tpr=0.7363 | fpr=0.8591 | 8307.3 samples/s | 32.5 steps/s
[Step= 200] | Loss=5.16862 | acc=0.1517 | tpr=0.7421 | fpr=0.8590 | 7334.1 samples/s | 28.6 steps/s
[Step= 250] | Loss=5.16327 | acc=0.1525 | tpr=0.7371 | fpr=0.8581 | 8326.0 samples/s | 32.5 steps/s
[Step= 300] | Loss=5.15923 | acc=0.1536 | tpr=0.7360 | fpr=0.8570 | 7723.8 samples/s | 30.2 steps/s
[Step= 350] | Loss=5.16565 | acc=0.1535 | tpr=0.7439 | fpr=0.8572 | 8220.7 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.16473 | acc=0.1529 | tpr=0.7358 | fpr=0.8577 | 8639.1 samples/s | 33.7 steps/s
[Step= 450] | Loss=5.16558 | acc=0.1529 | tpr=0.7337 | fpr=0.8577 | 7087.8 samples/s | 27.7 steps/s
[Step= 500] | Loss=5.16780 | acc=0.1531 | tpr=0.7300 | fpr=0.8573 | 8143.4 samples/s | 31.8 steps/s
[Step= 550] | Loss=5.16520 | acc=0.1534 | tpr=0.7318 | fpr=0.8572 | 10761.5 samples/s | 42.0 steps/s
Avg test loss: 5.16572, Avg test acc: 0.15323, Avg tpr: 0.73177, Avg fpr: 0.85728, total FA: 119032

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.83656 | acc=0.1270 | tpr=0.8142 | fpr=0.8854 | 4725.6 samples/s | 18.5 steps/s
[Step= 100] | Loss=6.82038 | acc=0.1271 | tpr=0.7804 | fpr=0.8851 | 8124.5 samples/s | 31.7 steps/s
[Step= 150] | Loss=6.82313 | acc=0.1279 | tpr=0.7896 | fpr=0.8843 | 7381.2 samples/s | 28.8 steps/s
[Step= 200] | Loss=6.81719 | acc=0.1279 | tpr=0.7880 | fpr=0.8841 | 8011.0 samples/s | 31.3 steps/s
[Step= 250] | Loss=6.81465 | acc=0.1289 | tpr=0.7904 | fpr=0.8831 | 8023.1 samples/s | 31.3 steps/s
[Step= 300] | Loss=6.81338 | acc=0.1293 | tpr=0.7956 | fpr=0.8828 | 7410.5 samples/s | 28.9 steps/s
[Step= 350] | Loss=6.82042 | acc=0.1288 | tpr=0.7927 | fpr=0.8832 | 8410.0 samples/s | 32.9 steps/s
[Step= 400] | Loss=6.82414 | acc=0.1289 | tpr=0.7899 | fpr=0.8831 | 7298.6 samples/s | 28.5 steps/s
[Step= 450] | Loss=6.82502 | acc=0.1289 | tpr=0.7877 | fpr=0.8831 | 8345.1 samples/s | 32.6 steps/s
[Step= 500] | Loss=6.82580 | acc=0.1289 | tpr=0.7828 | fpr=0.8829 | 8463.5 samples/s | 33.1 steps/s
[Step= 550] | Loss=6.82478 | acc=0.1292 | tpr=0.7875 | fpr=0.8828 | 10825.0 samples/s | 42.3 steps/s
Avg test loss: 6.82722, Avg test acc: 0.12906, Avg tpr: 0.78764, Avg fpr: 0.88292, total FA: 122591

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.85306 | acc=0.1357 | tpr=0.7920 | fpr=0.8761 | 4778.2 samples/s | 18.7 steps/s
[Step= 100] | Loss=5.82866 | acc=0.1381 | tpr=0.7527 | fpr=0.8733 | 7089.1 samples/s | 27.7 steps/s
[Step= 150] | Loss=5.83928 | acc=0.1396 | tpr=0.7622 | fpr=0.8719 | 7592.1 samples/s | 29.7 steps/s
[Step= 200] | Loss=5.82199 | acc=0.1404 | tpr=0.7628 | fpr=0.8709 | 8133.8 samples/s | 31.8 steps/s
[Step= 250] | Loss=5.81661 | acc=0.1410 | tpr=0.7555 | fpr=0.8702 | 8408.0 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.80871 | acc=0.1411 | tpr=0.7593 | fpr=0.8702 | 7988.4 samples/s | 31.2 steps/s
[Step= 350] | Loss=5.82031 | acc=0.1403 | tpr=0.7564 | fpr=0.8709 | 7747.4 samples/s | 30.3 steps/s
[Step= 400] | Loss=5.82266 | acc=0.1402 | tpr=0.7571 | fpr=0.8710 | 8270.6 samples/s | 32.3 steps/s
[Step= 450] | Loss=5.81925 | acc=0.1406 | tpr=0.7551 | fpr=0.8705 | 8242.3 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.81900 | acc=0.1409 | tpr=0.7537 | fpr=0.8701 | 7917.3 samples/s | 30.9 steps/s
[Step= 550] | Loss=5.81889 | acc=0.1409 | tpr=0.7537 | fpr=0.8702 | 11007.1 samples/s | 43.0 steps/s
Avg test loss: 5.81926, Avg test acc: 0.14081, Avg tpr: 0.75238, Avg fpr: 0.87030, total FA: 120840

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.95066 | acc=0.1497 | tpr=0.7699 | fpr=0.8615 | 4422.7 samples/s | 17.3 steps/s
[Step= 100] | Loss=6.92029 | acc=0.1511 | tpr=0.7505 | fpr=0.8601 | 8853.1 samples/s | 34.6 steps/s
[Step= 150] | Loss=6.92525 | acc=0.1519 | tpr=0.7478 | fpr=0.8591 | 8087.8 samples/s | 31.6 steps/s
[Step= 200] | Loss=6.91252 | acc=0.1520 | tpr=0.7454 | fpr=0.8588 | 7937.9 samples/s | 31.0 steps/s
[Step= 250] | Loss=6.91266 | acc=0.1522 | tpr=0.7432 | fpr=0.8585 | 7696.3 samples/s | 30.1 steps/s
[Step= 300] | Loss=6.90855 | acc=0.1529 | tpr=0.7425 | fpr=0.8578 | 7931.0 samples/s | 31.0 steps/s
[Step= 350] | Loss=6.91988 | acc=0.1522 | tpr=0.7470 | fpr=0.8586 | 8063.1 samples/s | 31.5 steps/s
[Step= 400] | Loss=6.92339 | acc=0.1521 | tpr=0.7429 | fpr=0.8587 | 7717.1 samples/s | 30.1 steps/s
[Step= 450] | Loss=6.92003 | acc=0.1522 | tpr=0.7410 | fpr=0.8585 | 8492.6 samples/s | 33.2 steps/s
[Step= 500] | Loss=6.92233 | acc=0.1525 | tpr=0.7379 | fpr=0.8581 | 7939.7 samples/s | 31.0 steps/s
[Step= 550] | Loss=6.92202 | acc=0.1526 | tpr=0.7398 | fpr=0.8581 | 9687.2 samples/s | 37.8 steps/s
Avg test loss: 6.92405, Avg test acc: 0.15243, Avg tpr: 0.73891, Avg fpr: 0.85823, total FA: 119164

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.50701 | acc=0.1374 | tpr=0.8230 | fpr=0.8749 | 4691.3 samples/s | 18.3 steps/s
[Step= 100] | Loss=5.48910 | acc=0.1397 | tpr=0.7974 | fpr=0.8725 | 7605.5 samples/s | 29.7 steps/s
[Step= 150] | Loss=5.48975 | acc=0.1412 | tpr=0.7911 | fpr=0.8708 | 7454.0 samples/s | 29.1 steps/s
[Step= 200] | Loss=5.48477 | acc=0.1415 | tpr=0.7836 | fpr=0.8702 | 8310.2 samples/s | 32.5 steps/s
[Step= 250] | Loss=5.48191 | acc=0.1422 | tpr=0.7860 | fpr=0.8695 | 8208.7 samples/s | 32.1 steps/s
[Step= 300] | Loss=5.47846 | acc=0.1428 | tpr=0.7876 | fpr=0.8690 | 8135.3 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.48648 | acc=0.1423 | tpr=0.7896 | fpr=0.8694 | 7584.5 samples/s | 29.6 steps/s
[Step= 400] | Loss=5.48590 | acc=0.1421 | tpr=0.7872 | fpr=0.8696 | 8277.9 samples/s | 32.3 steps/s
[Step= 450] | Loss=5.48488 | acc=0.1422 | tpr=0.7833 | fpr=0.8695 | 8351.3 samples/s | 32.6 steps/s
[Step= 500] | Loss=5.48946 | acc=0.1419 | tpr=0.7811 | fpr=0.8696 | 7636.1 samples/s | 29.8 steps/s
[Step= 550] | Loss=5.49074 | acc=0.1420 | tpr=0.7799 | fpr=0.8696 | 10648.4 samples/s | 41.6 steps/s
Avg test loss: 5.49157, Avg test acc: 0.14186, Avg tpr: 0.77932, Avg fpr: 0.86973, total FA: 120760

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.15719 | acc=0.9637 | tpr=0.9204 | fpr=0.0355 | 4551.6 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.15958 | acc=0.9620 | tpr=0.9275 | fpr=0.0374 | 7926.5 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.16249 | acc=0.9612 | tpr=0.9308 | fpr=0.0382 | 8211.7 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.16141 | acc=0.9613 | tpr=0.9333 | fpr=0.0381 | 7983.1 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.16285 | acc=0.9612 | tpr=0.9293 | fpr=0.0383 | 7966.1 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.16329 | acc=0.9609 | tpr=0.9309 | fpr=0.0386 | 8092.8 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.16382 | acc=0.9608 | tpr=0.9317 | fpr=0.0387 | 8092.2 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.16533 | acc=0.9603 | tpr=0.9251 | fpr=0.0390 | 7875.7 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.16573 | acc=0.9602 | tpr=0.9241 | fpr=0.0392 | 7095.0 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.16562 | acc=0.9603 | tpr=0.9256 | fpr=0.0391 | 8336.4 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.16558 | acc=0.9603 | tpr=0.9244 | fpr=0.0390 | 11525.5 samples/s | 45.0 steps/s
Avg test loss: 0.16544, Avg test acc: 0.96031, Avg tpr: 0.92433, Avg fpr: 0.03904, total FA: 5420

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14137 | acc=0.9640 | tpr=0.8850 | fpr=0.0346 | 4776.2 samples/s | 18.7 steps/s
[Step= 100] | Loss=0.14608 | acc=0.9629 | tpr=0.9019 | fpr=0.0359 | 7578.5 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.14958 | acc=0.9623 | tpr=0.9049 | fpr=0.0367 | 8022.8 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.14973 | acc=0.9623 | tpr=0.9082 | fpr=0.0367 | 7702.1 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.15156 | acc=0.9619 | tpr=0.9092 | fpr=0.0371 | 8446.3 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.15149 | acc=0.9618 | tpr=0.9098 | fpr=0.0373 | 7706.0 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.15217 | acc=0.9616 | tpr=0.9130 | fpr=0.0375 | 7661.5 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.15327 | acc=0.9614 | tpr=0.9092 | fpr=0.0377 | 8080.4 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.15417 | acc=0.9611 | tpr=0.9094 | fpr=0.0379 | 8369.2 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.15393 | acc=0.9612 | tpr=0.9128 | fpr=0.0379 | 8055.3 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.15395 | acc=0.9612 | tpr=0.9101 | fpr=0.0378 | 10489.4 samples/s | 41.0 steps/s
Avg test loss: 0.15379, Avg test acc: 0.96127, Avg tpr: 0.91046, Avg fpr: 0.03781, total FA: 5250

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.21230 | acc=0.9564 | tpr=0.9071 | fpr=0.0427 | 4668.7 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.21793 | acc=0.9568 | tpr=0.9126 | fpr=0.0424 | 7750.7 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.22347 | acc=0.9558 | tpr=0.9164 | fpr=0.0435 | 8363.9 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.22450 | acc=0.9560 | tpr=0.9213 | fpr=0.0434 | 7655.6 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.22645 | acc=0.9557 | tpr=0.9179 | fpr=0.0437 | 7481.9 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.22733 | acc=0.9552 | tpr=0.9171 | fpr=0.0441 | 8070.7 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.22712 | acc=0.9555 | tpr=0.9198 | fpr=0.0439 | 8024.6 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.22778 | acc=0.9552 | tpr=0.9179 | fpr=0.0441 | 8549.0 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.22882 | acc=0.9550 | tpr=0.9167 | fpr=0.0443 | 7926.6 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.22926 | acc=0.9551 | tpr=0.9207 | fpr=0.0443 | 7719.3 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.22807 | acc=0.9551 | tpr=0.9188 | fpr=0.0442 | 10455.9 samples/s | 40.8 steps/s
Avg test loss: 0.22751, Avg test acc: 0.95517, Avg tpr: 0.91878, Avg fpr: 0.04417, total FA: 6133

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15901 | acc=0.9655 | tpr=0.9115 | fpr=0.0335 | 4706.2 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.16597 | acc=0.9639 | tpr=0.9190 | fpr=0.0352 | 7821.8 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.17019 | acc=0.9631 | tpr=0.9236 | fpr=0.0362 | 8147.7 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.16949 | acc=0.9630 | tpr=0.9301 | fpr=0.0364 | 7820.0 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.17124 | acc=0.9628 | tpr=0.9310 | fpr=0.0366 | 7932.0 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.17333 | acc=0.9625 | tpr=0.9338 | fpr=0.0370 | 7992.8 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.17446 | acc=0.9622 | tpr=0.9330 | fpr=0.0373 | 8021.5 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.17566 | acc=0.9620 | tpr=0.9311 | fpr=0.0375 | 8483.9 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.17686 | acc=0.9617 | tpr=0.9294 | fpr=0.0377 | 7669.4 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.17645 | acc=0.9619 | tpr=0.9330 | fpr=0.0376 | 8181.3 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.17592 | acc=0.9621 | tpr=0.9327 | fpr=0.0373 | 9580.3 samples/s | 37.4 steps/s
Avg test loss: 0.17550, Avg test acc: 0.96216, Avg tpr: 0.93265, Avg fpr: 0.03730, total FA: 5179

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.24515 | acc=0.9507 | tpr=0.9292 | fpr=0.0489 | 4819.0 samples/s | 18.8 steps/s
[Step= 100] | Loss=0.25352 | acc=0.9502 | tpr=0.9424 | fpr=0.0497 | 7361.7 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.26007 | acc=0.9487 | tpr=0.9452 | fpr=0.0512 | 7614.8 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.26134 | acc=0.9485 | tpr=0.9443 | fpr=0.0514 | 7616.8 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.26468 | acc=0.9481 | tpr=0.9432 | fpr=0.0518 | 8614.8 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.26617 | acc=0.9478 | tpr=0.9425 | fpr=0.0521 | 7191.2 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.26690 | acc=0.9477 | tpr=0.9411 | fpr=0.0522 | 8237.5 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.26798 | acc=0.9475 | tpr=0.9387 | fpr=0.0523 | 8350.8 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.27010 | acc=0.9474 | tpr=0.9372 | fpr=0.0525 | 8070.1 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.27071 | acc=0.9471 | tpr=0.9388 | fpr=0.0527 | 8277.6 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.27046 | acc=0.9472 | tpr=0.9371 | fpr=0.0526 | 10554.8 samples/s | 41.2 steps/s
Avg test loss: 0.26999, Avg test acc: 0.94724, Avg tpr: 0.93740, Avg fpr: 0.05258, total FA: 7301

server round 19/50

clients selected: [0 1 5 6 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=28001 Epoch=136.5] | Loss=0.02442 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.709 | L2-Norm(final)=13.089 | 3153.0 samples/s | 49.3 steps/s
[Step=28050 Epoch=136.8] | Loss=0.05684 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.709 | L2-Norm(final)=13.064 | 4978.7 samples/s | 77.8 steps/s
[Step=28100 Epoch=137.0] | Loss=0.05198 | Reg=0.00137 | acc=0.9062 | L2-Norm=11.710 | L2-Norm(final)=13.055 | 5597.5 samples/s | 87.5 steps/s
[Step=28150 Epoch=137.3] | Loss=0.04968 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.710 | L2-Norm(final)=13.052 | 5378.9 samples/s | 84.0 steps/s
[Step=28200 Epoch=137.5] | Loss=0.04912 | Reg=0.00137 | acc=0.9375 | L2-Norm=11.710 | L2-Norm(final)=13.052 | 8546.4 samples/s | 133.5 steps/s
[Step=28250 Epoch=137.8] | Loss=0.04773 | Reg=0.00137 | acc=0.9531 | L2-Norm=11.710 | L2-Norm(final)=13.054 | 1467.5 samples/s | 22.9 steps/s
[Step=28300 Epoch=138.0] | Loss=0.04706 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.710 | L2-Norm(final)=13.059 | 5519.2 samples/s | 86.2 steps/s
[Step=28350 Epoch=138.2] | Loss=0.04646 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.710 | L2-Norm(final)=13.065 | 5570.4 samples/s | 87.0 steps/s
[Step=28400 Epoch=138.5] | Loss=0.04571 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.710 | L2-Norm(final)=13.072 | 7430.4 samples/s | 116.1 steps/s
[Step=28450 Epoch=138.7] | Loss=0.04563 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.710 | L2-Norm(final)=13.079 | 1508.8 samples/s | 23.6 steps/s
[Step=28500 Epoch=139.0] | Loss=0.04529 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.710 | L2-Norm(final)=13.086 | 5480.8 samples/s | 85.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=28501 Epoch=139.0] | Loss=0.07647 | Reg=0.00137 | acc=0.9375 | L2-Norm=11.710 | L2-Norm(final)=13.167 | 3251.0 samples/s | 50.8 steps/s
[Step=28550 Epoch=139.2] | Loss=0.03633 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.822 | L2-Norm(final)=13.168 | 4128.6 samples/s | 64.5 steps/s
[Step=28600 Epoch=139.5] | Loss=0.04243 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.923 | L2-Norm(final)=13.155 | 4669.0 samples/s | 73.0 steps/s
[Step=28650 Epoch=139.7] | Loss=0.04289 | Reg=0.00144 | acc=0.9531 | L2-Norm=11.997 | L2-Norm(final)=13.144 | 4687.8 samples/s | 73.2 steps/s
[Step=28700 Epoch=139.9] | Loss=0.04163 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.058 | L2-Norm(final)=13.136 | 6747.0 samples/s | 105.4 steps/s
[Step=28750 Epoch=140.2] | Loss=0.03714 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.108 | L2-Norm(final)=13.132 | 1423.8 samples/s | 22.2 steps/s
[Step=28800 Epoch=140.4] | Loss=0.03404 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=13.130 | 4740.0 samples/s | 74.1 steps/s
[Step=28850 Epoch=140.7] | Loss=0.03097 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.181 | L2-Norm(final)=13.130 | 4612.0 samples/s | 72.1 steps/s
[Step=28900 Epoch=140.9] | Loss=0.02948 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.210 | L2-Norm(final)=13.129 | 6148.5 samples/s | 96.1 steps/s
[Step=28950 Epoch=141.2] | Loss=0.02767 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.236 | L2-Norm(final)=13.129 | 1432.3 samples/s | 22.4 steps/s
[Step=29000 Epoch=141.4] | Loss=0.02575 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=13.130 | 4759.9 samples/s | 74.4 steps/s
[Step=29050 Epoch=141.7] | Loss=0.02436 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.278 | L2-Norm(final)=13.131 | 4619.0 samples/s | 72.2 steps/s
[Step=29100 Epoch=141.9] | Loss=0.02321 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=13.132 | 5602.2 samples/s | 87.5 steps/s
[Step=29150 Epoch=142.1] | Loss=0.02211 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.313 | L2-Norm(final)=13.133 | 1470.9 samples/s | 23.0 steps/s
[Step=29200 Epoch=142.4] | Loss=0.02104 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.327 | L2-Norm(final)=13.134 | 4738.8 samples/s | 74.0 steps/s
[Step=29250 Epoch=142.6] | Loss=0.02012 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.340 | L2-Norm(final)=13.135 | 4651.7 samples/s | 72.7 steps/s
[Step=29300 Epoch=142.9] | Loss=0.01948 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.352 | L2-Norm(final)=13.136 | 5182.1 samples/s | 81.0 steps/s
[Step=29350 Epoch=143.1] | Loss=0.01885 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.363 | L2-Norm(final)=13.137 | 1489.2 samples/s | 23.3 steps/s
[Step=29400 Epoch=143.4] | Loss=0.01818 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=13.138 | 4629.4 samples/s | 72.3 steps/s
[Step=29450 Epoch=143.6] | Loss=0.01754 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.383 | L2-Norm(final)=13.139 | 4739.2 samples/s | 74.0 steps/s
[Step=29500 Epoch=143.8] | Loss=0.01709 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=13.141 | 4795.3 samples/s | 74.9 steps/s
[Step=29550 Epoch=144.1] | Loss=0.01660 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.400 | L2-Norm(final)=13.142 | 1534.4 samples/s | 24.0 steps/s
[Step=29600 Epoch=144.3] | Loss=0.01606 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.409 | L2-Norm(final)=13.143 | 4711.0 samples/s | 73.6 steps/s
[Step=29650 Epoch=144.6] | Loss=0.01557 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=13.145 | 4703.9 samples/s | 73.5 steps/s
[Step=29700 Epoch=144.8] | Loss=0.01517 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.423 | L2-Norm(final)=13.147 | 4744.7 samples/s | 74.1 steps/s
[Step=29750 Epoch=145.1] | Loss=0.01477 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=13.148 | 1544.2 samples/s | 24.1 steps/s
[Step=29800 Epoch=145.3] | Loss=0.01436 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.436 | L2-Norm(final)=13.150 | 4678.9 samples/s | 73.1 steps/s
[Step=29850 Epoch=145.6] | Loss=0.01396 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.442 | L2-Norm(final)=13.152 | 4715.6 samples/s | 73.7 steps/s
[Step=29900 Epoch=145.8] | Loss=0.01362 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.448 | L2-Norm(final)=13.154 | 4702.8 samples/s | 73.5 steps/s
[Step=29950 Epoch=146.0] | Loss=0.01340 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.453 | L2-Norm(final)=13.155 | 1552.5 samples/s | 24.3 steps/s
[Step=30000 Epoch=146.3] | Loss=0.01318 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.458 | L2-Norm(final)=13.157 | 4692.9 samples/s | 73.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step30000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=68.3] | Loss=0.01552 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.709 | L2-Norm(final)=11.117 | 3294.2 samples/s | 51.5 steps/s
[Step=14050 Epoch=68.6] | Loss=0.05066 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.710 | L2-Norm(final)=11.125 | 4919.8 samples/s | 76.9 steps/s
[Step=14100 Epoch=68.8] | Loss=0.05132 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.710 | L2-Norm(final)=11.133 | 5519.0 samples/s | 86.2 steps/s
[Step=14150 Epoch=69.0] | Loss=0.04970 | Reg=0.00137 | acc=0.8906 | L2-Norm=11.710 | L2-Norm(final)=11.145 | 5320.5 samples/s | 83.1 steps/s
[Step=14200 Epoch=69.3] | Loss=0.04766 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.710 | L2-Norm(final)=11.162 | 8550.3 samples/s | 133.6 steps/s
[Step=14250 Epoch=69.5] | Loss=0.04752 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.710 | L2-Norm(final)=11.176 | 1489.1 samples/s | 23.3 steps/s
[Step=14300 Epoch=69.8] | Loss=0.04733 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.710 | L2-Norm(final)=11.190 | 5274.3 samples/s | 82.4 steps/s
[Step=14350 Epoch=70.0] | Loss=0.04771 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.710 | L2-Norm(final)=11.200 | 5485.0 samples/s | 85.7 steps/s
[Step=14400 Epoch=70.3] | Loss=0.04761 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.710 | L2-Norm(final)=11.211 | 7724.7 samples/s | 120.7 steps/s
[Step=14450 Epoch=70.5] | Loss=0.04713 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.710 | L2-Norm(final)=11.222 | 1483.9 samples/s | 23.2 steps/s
[Step=14500 Epoch=70.8] | Loss=0.04702 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.710 | L2-Norm(final)=11.234 | 5443.6 samples/s | 85.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=70.8] | Loss=0.05915 | Reg=0.00137 | acc=0.9531 | L2-Norm=11.710 | L2-Norm(final)=11.349 | 3247.7 samples/s | 50.7 steps/s
[Step=14550 Epoch=71.0] | Loss=0.06133 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.821 | L2-Norm(final)=11.335 | 4210.4 samples/s | 65.8 steps/s
[Step=14600 Epoch=71.2] | Loss=0.05232 | Reg=0.00143 | acc=0.9375 | L2-Norm=11.944 | L2-Norm(final)=11.322 | 4632.3 samples/s | 72.4 steps/s
[Step=14650 Epoch=71.5] | Loss=0.04763 | Reg=0.00145 | acc=0.9375 | L2-Norm=12.028 | L2-Norm(final)=11.318 | 4669.4 samples/s | 73.0 steps/s
[Step=14700 Epoch=71.7] | Loss=0.04388 | Reg=0.00146 | acc=0.9531 | L2-Norm=12.097 | L2-Norm(final)=11.317 | 6829.2 samples/s | 106.7 steps/s
[Step=14750 Epoch=72.0] | Loss=0.03813 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=11.318 | 1403.2 samples/s | 21.9 steps/s
[Step=14800 Epoch=72.2] | Loss=0.03440 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.193 | L2-Norm(final)=11.321 | 4723.6 samples/s | 73.8 steps/s
[Step=14850 Epoch=72.5] | Loss=0.03151 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=11.324 | 4748.0 samples/s | 74.2 steps/s
[Step=14900 Epoch=72.7] | Loss=0.02946 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.260 | L2-Norm(final)=11.329 | 6138.6 samples/s | 95.9 steps/s
[Step=14950 Epoch=72.9] | Loss=0.02787 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.287 | L2-Norm(final)=11.331 | 1413.4 samples/s | 22.1 steps/s
[Step=15000 Epoch=73.2] | Loss=0.02585 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.312 | L2-Norm(final)=11.335 | 4667.5 samples/s | 72.9 steps/s
[Step=15050 Epoch=73.4] | Loss=0.02460 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.333 | L2-Norm(final)=11.339 | 4689.0 samples/s | 73.3 steps/s
[Step=15100 Epoch=73.7] | Loss=0.02325 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.352 | L2-Norm(final)=11.341 | 5870.8 samples/s | 91.7 steps/s
[Step=15150 Epoch=73.9] | Loss=0.02201 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.370 | L2-Norm(final)=11.344 | 1478.9 samples/s | 23.1 steps/s
[Step=15200 Epoch=74.2] | Loss=0.02097 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.387 | L2-Norm(final)=11.348 | 4744.0 samples/s | 74.1 steps/s
[Step=15250 Epoch=74.4] | Loss=0.02022 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=11.351 | 4649.1 samples/s | 72.6 steps/s
[Step=15300 Epoch=74.7] | Loss=0.01946 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.417 | L2-Norm(final)=11.354 | 5416.9 samples/s | 84.6 steps/s
[Step=15350 Epoch=74.9] | Loss=0.01867 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.431 | L2-Norm(final)=11.357 | 1470.2 samples/s | 23.0 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01788 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.444 | L2-Norm(final)=11.360 | 4734.1 samples/s | 74.0 steps/s
[Step=15450 Epoch=75.4] | Loss=0.01727 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=11.364 | 4624.7 samples/s | 72.3 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01665 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.467 | L2-Norm(final)=11.367 | 5092.3 samples/s | 79.6 steps/s
[Step=15550 Epoch=75.9] | Loss=0.01616 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.477 | L2-Norm(final)=11.370 | 1500.5 samples/s | 23.4 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01569 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.486 | L2-Norm(final)=11.374 | 4661.4 samples/s | 72.8 steps/s
[Step=15650 Epoch=76.4] | Loss=0.01515 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=11.377 | 4669.2 samples/s | 73.0 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01467 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.503 | L2-Norm(final)=11.381 | 4809.0 samples/s | 75.1 steps/s
[Step=15750 Epoch=76.9] | Loss=0.01428 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.511 | L2-Norm(final)=11.384 | 1579.4 samples/s | 24.7 steps/s
[Step=15800 Epoch=77.1] | Loss=0.01387 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.518 | L2-Norm(final)=11.387 | 4701.0 samples/s | 73.5 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01358 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=11.390 | 4665.3 samples/s | 72.9 steps/s
[Step=15900 Epoch=77.6] | Loss=0.01328 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.531 | L2-Norm(final)=11.394 | 4746.6 samples/s | 74.2 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01294 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.538 | L2-Norm(final)=11.397 | 1534.3 samples/s | 24.0 steps/s
[Step=16000 Epoch=78.1] | Loss=0.01258 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.544 | L2-Norm(final)=11.400 | 4730.5 samples/s | 73.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_1/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=24001 Epoch=227.4] | Loss=0.00056 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.709 | L2-Norm(final)=16.501 | 3073.6 samples/s | 48.0 steps/s
[Step=24050 Epoch=227.9] | Loss=0.00093 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.706 | L2-Norm(final)=16.523 | 4628.1 samples/s | 72.3 steps/s
[Step=24100 Epoch=228.4] | Loss=0.00124 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=16.553 | 8195.1 samples/s | 128.0 steps/s
[Step=24150 Epoch=228.8] | Loss=0.00154 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=16.583 | 1467.2 samples/s | 22.9 steps/s
[Step=24200 Epoch=229.3] | Loss=0.00147 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=16.611 | 7252.9 samples/s | 113.3 steps/s
[Step=24250 Epoch=229.8] | Loss=0.00151 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=16.637 | 1460.6 samples/s | 22.8 steps/s
[Step=24300 Epoch=230.3] | Loss=0.00145 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=16.663 | 6435.3 samples/s | 100.6 steps/s
[Step=24350 Epoch=230.7] | Loss=0.00154 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=16.687 | 1566.4 samples/s | 24.5 steps/s
[Step=24400 Epoch=231.2] | Loss=0.00148 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=16.711 | 5841.6 samples/s | 91.3 steps/s
[Step=24450 Epoch=231.7] | Loss=0.00143 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=16.733 | 1560.9 samples/s | 24.4 steps/s
[Step=24500 Epoch=232.2] | Loss=0.00143 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=16.754 | 5229.2 samples/s | 81.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=232.2] | Loss=0.00160 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=16.964 | 3178.4 samples/s | 49.7 steps/s
[Step=24550 Epoch=232.6] | Loss=0.00032 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=16.981 | 4057.3 samples/s | 63.4 steps/s
[Step=24600 Epoch=233.1] | Loss=0.00171 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.745 | L2-Norm(final)=16.984 | 6167.7 samples/s | 96.4 steps/s
[Step=24650 Epoch=233.6] | Loss=0.00125 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=16.985 | 1366.0 samples/s | 21.3 steps/s
[Step=24700 Epoch=234.1] | Loss=0.00105 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.812 | L2-Norm(final)=16.988 | 5822.4 samples/s | 91.0 steps/s
[Step=24750 Epoch=234.5] | Loss=0.00178 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.841 | L2-Norm(final)=16.985 | 1405.1 samples/s | 22.0 steps/s
[Step=24800 Epoch=235.0] | Loss=0.00169 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.877 | L2-Norm(final)=16.979 | 5395.1 samples/s | 84.3 steps/s
[Step=24850 Epoch=235.5] | Loss=0.00282 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.916 | L2-Norm(final)=16.973 | 1441.5 samples/s | 22.5 steps/s
[Step=24900 Epoch=235.9] | Loss=0.00261 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.959 | L2-Norm(final)=16.964 | 4876.2 samples/s | 76.2 steps/s
[Step=24950 Epoch=236.4] | Loss=0.00234 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.992 | L2-Norm(final)=16.958 | 1486.9 samples/s | 23.2 steps/s
[Step=25000 Epoch=236.9] | Loss=0.00211 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.016 | L2-Norm(final)=16.953 | 4524.3 samples/s | 70.7 steps/s
[Step=25050 Epoch=237.4] | Loss=0.00192 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.034 | L2-Norm(final)=16.949 | 1521.9 samples/s | 23.8 steps/s
[Step=25100 Epoch=237.8] | Loss=0.00176 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.046 | L2-Norm(final)=16.946 | 4485.2 samples/s | 70.1 steps/s
[Step=25150 Epoch=238.3] | Loss=0.00162 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.055 | L2-Norm(final)=16.944 | 1522.4 samples/s | 23.8 steps/s
[Step=25200 Epoch=238.8] | Loss=0.00151 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.061 | L2-Norm(final)=16.942 | 4549.6 samples/s | 71.1 steps/s
[Step=25250 Epoch=239.3] | Loss=0.00141 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.064 | L2-Norm(final)=16.940 | 1525.9 samples/s | 23.8 steps/s
[Step=25300 Epoch=239.7] | Loss=0.00132 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.066 | L2-Norm(final)=16.939 | 4485.3 samples/s | 70.1 steps/s
[Step=25350 Epoch=240.2] | Loss=0.00124 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.066 | L2-Norm(final)=16.938 | 1612.0 samples/s | 25.2 steps/s
[Step=25400 Epoch=240.7] | Loss=0.00117 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.065 | L2-Norm(final)=16.937 | 3973.2 samples/s | 62.1 steps/s
[Step=25450 Epoch=241.2] | Loss=0.00111 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.063 | L2-Norm(final)=16.936 | 6725.9 samples/s | 105.1 steps/s
[Step=25500 Epoch=241.6] | Loss=0.00106 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.061 | L2-Norm(final)=16.935 | 1355.0 samples/s | 21.2 steps/s
[Step=25550 Epoch=242.1] | Loss=0.00101 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.057 | L2-Norm(final)=16.935 | 6058.0 samples/s | 94.7 steps/s
[Step=25600 Epoch=242.6] | Loss=0.00096 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.053 | L2-Norm(final)=16.934 | 1386.7 samples/s | 21.7 steps/s
[Step=25650 Epoch=243.1] | Loss=0.00092 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.048 | L2-Norm(final)=16.934 | 5587.9 samples/s | 87.3 steps/s
[Step=25700 Epoch=243.5] | Loss=0.00088 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.043 | L2-Norm(final)=16.933 | 1452.6 samples/s | 22.7 steps/s
[Step=25750 Epoch=244.0] | Loss=0.00085 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.037 | L2-Norm(final)=16.933 | 5067.8 samples/s | 79.2 steps/s
[Step=25800 Epoch=244.5] | Loss=0.00081 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.031 | L2-Norm(final)=16.933 | 1463.4 samples/s | 22.9 steps/s
[Step=25850 Epoch=245.0] | Loss=0.00078 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.025 | L2-Norm(final)=16.932 | 4706.5 samples/s | 73.5 steps/s
[Step=25900 Epoch=245.4] | Loss=0.00076 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.018 | L2-Norm(final)=16.932 | 1497.2 samples/s | 23.4 steps/s
[Step=25950 Epoch=245.9] | Loss=0.00073 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.012 | L2-Norm(final)=16.932 | 4459.0 samples/s | 69.7 steps/s
[Step=26000 Epoch=246.4] | Loss=0.00071 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.005 | L2-Norm(final)=16.932 | 1568.0 samples/s | 24.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step26000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=171.2] | Loss=0.00012 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.709 | L2-Norm(final)=12.012 | 3246.9 samples/s | 50.7 steps/s
[Step=18050 Epoch=171.7] | Loss=0.00219 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=12.031 | 4337.7 samples/s | 67.8 steps/s
[Step=18100 Epoch=172.2] | Loss=0.00281 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=12.060 | 8112.5 samples/s | 126.8 steps/s
[Step=18150 Epoch=172.7] | Loss=0.00281 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=12.087 | 1480.8 samples/s | 23.1 steps/s
[Step=18200 Epoch=173.1] | Loss=0.00272 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=12.112 | 7102.9 samples/s | 111.0 steps/s
[Step=18250 Epoch=173.6] | Loss=0.00287 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=12.139 | 1460.6 samples/s | 22.8 steps/s
[Step=18300 Epoch=174.1] | Loss=0.00284 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=12.164 | 6552.8 samples/s | 102.4 steps/s
[Step=18350 Epoch=174.6] | Loss=0.00299 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=12.188 | 1513.7 samples/s | 23.7 steps/s
[Step=18400 Epoch=175.0] | Loss=0.00293 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=12.214 | 5786.5 samples/s | 90.4 steps/s
[Step=18450 Epoch=175.5] | Loss=0.00288 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=12.238 | 1538.4 samples/s | 24.0 steps/s
[Step=18500 Epoch=176.0] | Loss=0.00286 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=12.261 | 5378.4 samples/s | 84.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=176.0] | Loss=0.00065 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=12.491 | 3126.5 samples/s | 48.9 steps/s
[Step=18550 Epoch=176.5] | Loss=0.00418 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.795 | L2-Norm(final)=12.504 | 4059.7 samples/s | 63.4 steps/s
[Step=18600 Epoch=176.9] | Loss=0.00524 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.938 | L2-Norm(final)=12.504 | 6567.0 samples/s | 102.6 steps/s
[Step=18650 Epoch=177.4] | Loss=0.00392 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.057 | L2-Norm(final)=12.494 | 1386.5 samples/s | 21.7 steps/s
[Step=18700 Epoch=177.9] | Loss=0.00303 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.124 | L2-Norm(final)=12.492 | 5947.9 samples/s | 92.9 steps/s
[Step=18750 Epoch=178.4] | Loss=0.00243 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=12.491 | 1411.8 samples/s | 22.1 steps/s
[Step=18800 Epoch=178.8] | Loss=0.00202 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=12.491 | 5439.1 samples/s | 85.0 steps/s
[Step=18850 Epoch=179.3] | Loss=0.00173 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=12.491 | 1451.7 samples/s | 22.7 steps/s
[Step=18900 Epoch=179.8] | Loss=0.00152 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=12.491 | 4983.7 samples/s | 77.9 steps/s
[Step=18950 Epoch=180.3] | Loss=0.00135 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=12.491 | 1498.3 samples/s | 23.4 steps/s
[Step=19000 Epoch=180.7] | Loss=0.00121 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=12.491 | 4621.4 samples/s | 72.2 steps/s
[Step=19050 Epoch=181.2] | Loss=0.00110 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=12.492 | 1505.8 samples/s | 23.5 steps/s
[Step=19100 Epoch=181.7] | Loss=0.00101 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=12.492 | 4463.1 samples/s | 69.7 steps/s
[Step=19150 Epoch=182.2] | Loss=0.00093 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=12.492 | 1543.8 samples/s | 24.1 steps/s
[Step=19200 Epoch=182.6] | Loss=0.00087 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=12.492 | 4388.7 samples/s | 68.6 steps/s
[Step=19250 Epoch=183.1] | Loss=0.00081 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.129 | L2-Norm(final)=12.493 | 1534.9 samples/s | 24.0 steps/s
[Step=19300 Epoch=183.6] | Loss=0.00076 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=12.493 | 4459.2 samples/s | 69.7 steps/s
[Step=19350 Epoch=184.1] | Loss=0.00072 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.107 | L2-Norm(final)=12.493 | 1594.1 samples/s | 24.9 steps/s
[Step=19400 Epoch=184.5] | Loss=0.00068 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.095 | L2-Norm(final)=12.493 | 4214.0 samples/s | 65.8 steps/s
[Step=19450 Epoch=185.0] | Loss=0.00064 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.084 | L2-Norm(final)=12.494 | 6772.0 samples/s | 105.8 steps/s
[Step=19500 Epoch=185.5] | Loss=0.00061 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.072 | L2-Norm(final)=12.494 | 1376.7 samples/s | 21.5 steps/s
[Step=19550 Epoch=186.0] | Loss=0.00058 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.059 | L2-Norm(final)=12.494 | 6052.8 samples/s | 94.6 steps/s
[Step=19600 Epoch=186.4] | Loss=0.00055 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.047 | L2-Norm(final)=12.494 | 1414.4 samples/s | 22.1 steps/s
[Step=19650 Epoch=186.9] | Loss=0.00053 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.035 | L2-Norm(final)=12.495 | 5564.6 samples/s | 86.9 steps/s
[Step=19700 Epoch=187.4] | Loss=0.00051 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.022 | L2-Norm(final)=12.495 | 1417.5 samples/s | 22.1 steps/s
[Step=19750 Epoch=187.9] | Loss=0.00049 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.010 | L2-Norm(final)=12.495 | 5036.4 samples/s | 78.7 steps/s
[Step=19800 Epoch=188.3] | Loss=0.00047 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.997 | L2-Norm(final)=12.495 | 1469.5 samples/s | 23.0 steps/s
[Step=19850 Epoch=188.8] | Loss=0.00045 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.985 | L2-Norm(final)=12.496 | 4589.1 samples/s | 71.7 steps/s
[Step=19900 Epoch=189.3] | Loss=0.00044 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=12.496 | 1508.1 samples/s | 23.6 steps/s
[Step=19950 Epoch=189.8] | Loss=0.00042 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.959 | L2-Norm(final)=12.496 | 4437.1 samples/s | 69.3 steps/s
[Step=20000 Epoch=190.2] | Loss=0.00041 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.946 | L2-Norm(final)=12.496 | 1520.8 samples/s | 23.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step20000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=190.6] | Loss=0.00338 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.709 | L2-Norm(final)=16.460 | 3060.1 samples/s | 47.8 steps/s
[Step=20050 Epoch=191.1] | Loss=0.00357 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=16.511 | 4710.6 samples/s | 73.6 steps/s
[Step=20100 Epoch=191.6] | Loss=0.00441 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=16.566 | 8325.8 samples/s | 130.1 steps/s
[Step=20150 Epoch=192.0] | Loss=0.00385 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=16.618 | 1432.7 samples/s | 22.4 steps/s
[Step=20200 Epoch=192.5] | Loss=0.00424 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=16.668 | 7413.4 samples/s | 115.8 steps/s
[Step=20250 Epoch=193.0] | Loss=0.00438 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=16.717 | 1487.7 samples/s | 23.2 steps/s
[Step=20300 Epoch=193.5] | Loss=0.00426 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=16.764 | 6688.4 samples/s | 104.5 steps/s
[Step=20350 Epoch=194.0] | Loss=0.00417 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=16.808 | 1510.7 samples/s | 23.6 steps/s
[Step=20400 Epoch=194.4] | Loss=0.00405 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=16.852 | 6153.0 samples/s | 96.1 steps/s
[Step=20450 Epoch=194.9] | Loss=0.00417 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=16.893 | 1546.0 samples/s | 24.2 steps/s
[Step=20500 Epoch=195.4] | Loss=0.00418 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=16.932 | 5577.9 samples/s | 87.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=195.4] | Loss=0.01087 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.704 | L2-Norm(final)=17.322 | 3180.5 samples/s | 49.7 steps/s
[Step=20550 Epoch=195.9] | Loss=0.01492 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.894 | L2-Norm(final)=17.314 | 4096.5 samples/s | 64.0 steps/s
[Step=20600 Epoch=196.3] | Loss=0.00863 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.086 | L2-Norm(final)=17.287 | 6329.6 samples/s | 98.9 steps/s
[Step=20650 Epoch=196.8] | Loss=0.00584 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=17.278 | 1376.5 samples/s | 21.5 steps/s
[Step=20700 Epoch=197.3] | Loss=0.00439 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=17.274 | 5966.3 samples/s | 93.2 steps/s
[Step=20750 Epoch=197.8] | Loss=0.00351 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=17.272 | 1438.8 samples/s | 22.5 steps/s
[Step=20800 Epoch=198.2] | Loss=0.00293 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=17.271 | 5492.2 samples/s | 85.8 steps/s
[Step=20850 Epoch=198.7] | Loss=0.00251 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.194 | L2-Norm(final)=17.271 | 1426.9 samples/s | 22.3 steps/s
[Step=20900 Epoch=199.2] | Loss=0.00220 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.188 | L2-Norm(final)=17.270 | 5149.1 samples/s | 80.5 steps/s
[Step=20950 Epoch=199.7] | Loss=0.00196 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=17.270 | 1473.3 samples/s | 23.0 steps/s
[Step=21000 Epoch=200.1] | Loss=0.00176 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=17.270 | 4847.2 samples/s | 75.7 steps/s
[Step=21050 Epoch=200.6] | Loss=0.00160 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=17.270 | 1508.3 samples/s | 23.6 steps/s
[Step=21100 Epoch=201.1] | Loss=0.00147 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=17.270 | 4582.8 samples/s | 71.6 steps/s
[Step=21150 Epoch=201.6] | Loss=0.00136 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=17.270 | 1535.1 samples/s | 24.0 steps/s
[Step=21200 Epoch=202.1] | Loss=0.00126 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=17.270 | 4445.1 samples/s | 69.5 steps/s
[Step=21250 Epoch=202.5] | Loss=0.00118 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.119 | L2-Norm(final)=17.270 | 1523.7 samples/s | 23.8 steps/s
[Step=21300 Epoch=203.0] | Loss=0.00110 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.108 | L2-Norm(final)=17.270 | 4445.2 samples/s | 69.5 steps/s
[Step=21350 Epoch=203.5] | Loss=0.00104 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.096 | L2-Norm(final)=17.271 | 1532.1 samples/s | 23.9 steps/s
[Step=21400 Epoch=204.0] | Loss=0.00098 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.084 | L2-Norm(final)=17.271 | 4348.4 samples/s | 67.9 steps/s
[Step=21450 Epoch=204.4] | Loss=0.00093 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=17.271 | 1522.1 samples/s | 23.8 steps/s
[Step=21500 Epoch=204.9] | Loss=0.00088 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.061 | L2-Norm(final)=17.271 | 4486.6 samples/s | 70.1 steps/s
[Step=21550 Epoch=205.4] | Loss=0.00084 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.049 | L2-Norm(final)=17.272 | 7198.2 samples/s | 112.5 steps/s
[Step=21600 Epoch=205.9] | Loss=0.00080 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.037 | L2-Norm(final)=17.272 | 1355.0 samples/s | 21.2 steps/s
[Step=21650 Epoch=206.3] | Loss=0.00077 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.025 | L2-Norm(final)=17.272 | 6541.9 samples/s | 102.2 steps/s
[Step=21700 Epoch=206.8] | Loss=0.00074 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.013 | L2-Norm(final)=17.272 | 1373.2 samples/s | 21.5 steps/s
[Step=21750 Epoch=207.3] | Loss=0.00071 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.001 | L2-Norm(final)=17.272 | 6032.0 samples/s | 94.3 steps/s
[Step=21800 Epoch=207.8] | Loss=0.00068 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.989 | L2-Norm(final)=17.273 | 1389.0 samples/s | 21.7 steps/s
[Step=21850 Epoch=208.3] | Loss=0.00065 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.977 | L2-Norm(final)=17.273 | 5568.9 samples/s | 87.0 steps/s
[Step=21900 Epoch=208.7] | Loss=0.00063 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.964 | L2-Norm(final)=17.273 | 1420.1 samples/s | 22.2 steps/s
[Step=21950 Epoch=209.2] | Loss=0.00061 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.952 | L2-Norm(final)=17.274 | 5225.1 samples/s | 81.6 steps/s
[Step=22000 Epoch=209.7] | Loss=0.00059 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.940 | L2-Norm(final)=17.274 | 1444.0 samples/s | 22.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4/client_state-step22000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11195 | acc=0.9470 | tpr=0.9489 | fpr=0.0572 | 4601.3 samples/s | 18.0 steps/s
Avg test loss: 0.11621, Avg test acc: 0.94619, Avg tpr: 0.94888, Avg fpr: 0.05974, total FA: 466

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.11903 | acc=0.9548 | tpr=0.9748 | fpr=0.0885 | 4760.9 samples/s | 18.6 steps/s
Avg test loss: 0.12328, Avg test acc: 0.95288, Avg tpr: 0.97325, Avg fpr: 0.09191, total FA: 717

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11102 | acc=0.9488 | tpr=0.9604 | fpr=0.0763 | 4715.5 samples/s | 18.4 steps/s
Avg test loss: 0.11593, Avg test acc: 0.94883, Avg tpr: 0.95978, Avg fpr: 0.07525, total FA: 587

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.12736 | acc=0.9501 | tpr=0.9550 | fpr=0.0607 | 4719.4 samples/s | 18.4 steps/s
Avg test loss: 0.13036, Avg test acc: 0.95032, Avg tpr: 0.95623, Avg fpr: 0.06268, total FA: 489

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10287 | acc=0.9495 | tpr=0.9637 | fpr=0.0815 | 4426.4 samples/s | 17.3 steps/s
Avg test loss: 0.10637, Avg test acc: 0.94903, Avg tpr: 0.96328, Avg fpr: 0.08230, total FA: 642

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.49053 | acc=0.3143 | tpr=0.0108 | fpr=0.0268 | 4656.7 samples/s | 18.2 steps/s
Avg test loss: 5.50695, Avg test acc: 0.31080, Avg tpr: 0.01072, Avg fpr: 0.02923, total FA: 228

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.81601 | acc=0.3085 | tpr=0.0241 | fpr=0.0738 | 4591.3 samples/s | 17.9 steps/s
Avg test loss: 4.84208, Avg test acc: 0.30563, Avg tpr: 0.02308, Avg fpr: 0.07294, total FA: 569

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.73506 | acc=0.3112 | tpr=0.0033 | fpr=0.0203 | 4581.4 samples/s | 17.9 steps/s
Avg test loss: 4.75639, Avg test acc: 0.30820, Avg tpr: 0.00332, Avg fpr: 0.02128, total FA: 166

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.64201 | acc=0.2994 | tpr=0.0260 | fpr=0.1070 | 4755.9 samples/s | 18.6 steps/s
Avg test loss: 4.66010, Avg test acc: 0.29562, Avg tpr: 0.02489, Avg fpr: 0.10896, total FA: 850

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.00645 | acc=0.3127 | tpr=0.0120 | fpr=0.0344 | 4643.4 samples/s | 18.1 steps/s
Avg test loss: 5.04263, Avg test acc: 0.31068, Avg tpr: 0.01294, Avg fpr: 0.03448, total FA: 269

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.52898 | acc=0.1523 | tpr=0.7699 | fpr=0.8588 | 4620.2 samples/s | 18.0 steps/s
[Step= 100] | Loss=5.49775 | acc=0.1545 | tpr=0.7420 | fpr=0.8565 | 7999.7 samples/s | 31.2 steps/s
[Step= 150] | Loss=5.50506 | acc=0.1556 | tpr=0.7594 | fpr=0.8555 | 8157.6 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.49456 | acc=0.1553 | tpr=0.7486 | fpr=0.8555 | 8368.8 samples/s | 32.7 steps/s
[Step= 250] | Loss=5.49050 | acc=0.1556 | tpr=0.7371 | fpr=0.8550 | 7732.3 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.48701 | acc=0.1560 | tpr=0.7367 | fpr=0.8546 | 7830.7 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.49491 | acc=0.1561 | tpr=0.7451 | fpr=0.8546 | 7704.3 samples/s | 30.1 steps/s
[Step= 400] | Loss=5.49526 | acc=0.1556 | tpr=0.7407 | fpr=0.8550 | 8450.2 samples/s | 33.0 steps/s
[Step= 450] | Loss=5.49538 | acc=0.1558 | tpr=0.7405 | fpr=0.8548 | 7913.4 samples/s | 30.9 steps/s
[Step= 500] | Loss=5.49824 | acc=0.1561 | tpr=0.7405 | fpr=0.8544 | 8097.6 samples/s | 31.6 steps/s
[Step= 550] | Loss=5.49564 | acc=0.1562 | tpr=0.7425 | fpr=0.8544 | 9734.1 samples/s | 38.0 steps/s
Avg test loss: 5.49602, Avg test acc: 0.15611, Avg tpr: 0.74247, Avg fpr: 0.85455, total FA: 118653

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.02653 | acc=0.1294 | tpr=0.7965 | fpr=0.8826 | 4602.5 samples/s | 18.0 steps/s
[Step= 100] | Loss=7.00723 | acc=0.1311 | tpr=0.8081 | fpr=0.8815 | 7500.9 samples/s | 29.3 steps/s
[Step= 150] | Loss=7.00466 | acc=0.1319 | tpr=0.8069 | fpr=0.8805 | 8428.6 samples/s | 32.9 steps/s
[Step= 200] | Loss=6.99574 | acc=0.1321 | tpr=0.8077 | fpr=0.8802 | 8176.0 samples/s | 31.9 steps/s
[Step= 250] | Loss=6.99351 | acc=0.1328 | tpr=0.8061 | fpr=0.8794 | 7695.6 samples/s | 30.1 steps/s
[Step= 300] | Loss=6.98917 | acc=0.1329 | tpr=0.8080 | fpr=0.8794 | 8274.1 samples/s | 32.3 steps/s
[Step= 350] | Loss=6.99878 | acc=0.1323 | tpr=0.8096 | fpr=0.8800 | 7995.2 samples/s | 31.2 steps/s
[Step= 400] | Loss=7.00063 | acc=0.1324 | tpr=0.8074 | fpr=0.8799 | 7668.7 samples/s | 30.0 steps/s
[Step= 450] | Loss=7.00076 | acc=0.1321 | tpr=0.8072 | fpr=0.8802 | 8078.0 samples/s | 31.6 steps/s
[Step= 500] | Loss=7.00215 | acc=0.1321 | tpr=0.8026 | fpr=0.8800 | 7480.5 samples/s | 29.2 steps/s
[Step= 550] | Loss=6.99903 | acc=0.1323 | tpr=0.8066 | fpr=0.8799 | 11736.7 samples/s | 45.8 steps/s
Avg test loss: 7.00106, Avg test acc: 0.13218, Avg tpr: 0.80626, Avg fpr: 0.88007, total FA: 122196

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.85306 | acc=0.1357 | tpr=0.7920 | fpr=0.8761 | 4678.7 samples/s | 18.3 steps/s
[Step= 100] | Loss=5.82866 | acc=0.1381 | tpr=0.7527 | fpr=0.8733 | 7885.9 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.83928 | acc=0.1396 | tpr=0.7622 | fpr=0.8719 | 7194.9 samples/s | 28.1 steps/s
[Step= 200] | Loss=5.82199 | acc=0.1404 | tpr=0.7628 | fpr=0.8709 | 8341.8 samples/s | 32.6 steps/s
[Step= 250] | Loss=5.81661 | acc=0.1410 | tpr=0.7555 | fpr=0.8702 | 8204.4 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.80871 | acc=0.1411 | tpr=0.7593 | fpr=0.8702 | 8281.2 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.82031 | acc=0.1403 | tpr=0.7564 | fpr=0.8709 | 7638.6 samples/s | 29.8 steps/s
[Step= 400] | Loss=5.82266 | acc=0.1402 | tpr=0.7571 | fpr=0.8710 | 8462.1 samples/s | 33.1 steps/s
[Step= 450] | Loss=5.81925 | acc=0.1406 | tpr=0.7551 | fpr=0.8705 | 7918.1 samples/s | 30.9 steps/s
[Step= 500] | Loss=5.81900 | acc=0.1409 | tpr=0.7537 | fpr=0.8701 | 7346.8 samples/s | 28.7 steps/s
[Step= 550] | Loss=5.81889 | acc=0.1409 | tpr=0.7537 | fpr=0.8702 | 10224.2 samples/s | 39.9 steps/s
Avg test loss: 5.81926, Avg test acc: 0.14081, Avg tpr: 0.75238, Avg fpr: 0.87030, total FA: 120840

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.95066 | acc=0.1497 | tpr=0.7699 | fpr=0.8615 | 4705.2 samples/s | 18.4 steps/s
[Step= 100] | Loss=6.92029 | acc=0.1511 | tpr=0.7505 | fpr=0.8601 | 8017.9 samples/s | 31.3 steps/s
[Step= 150] | Loss=6.92525 | acc=0.1519 | tpr=0.7478 | fpr=0.8591 | 7304.0 samples/s | 28.5 steps/s
[Step= 200] | Loss=6.91252 | acc=0.1520 | tpr=0.7454 | fpr=0.8588 | 8378.5 samples/s | 32.7 steps/s
[Step= 250] | Loss=6.91266 | acc=0.1522 | tpr=0.7432 | fpr=0.8585 | 8009.2 samples/s | 31.3 steps/s
[Step= 300] | Loss=6.90855 | acc=0.1529 | tpr=0.7425 | fpr=0.8578 | 8151.8 samples/s | 31.8 steps/s
[Step= 350] | Loss=6.91988 | acc=0.1522 | tpr=0.7470 | fpr=0.8586 | 7610.7 samples/s | 29.7 steps/s
[Step= 400] | Loss=6.92339 | acc=0.1521 | tpr=0.7429 | fpr=0.8587 | 8505.3 samples/s | 33.2 steps/s
[Step= 450] | Loss=6.92003 | acc=0.1522 | tpr=0.7410 | fpr=0.8585 | 8068.1 samples/s | 31.5 steps/s
[Step= 500] | Loss=6.92233 | acc=0.1525 | tpr=0.7379 | fpr=0.8581 | 7875.3 samples/s | 30.8 steps/s
[Step= 550] | Loss=6.92202 | acc=0.1526 | tpr=0.7398 | fpr=0.8581 | 9542.8 samples/s | 37.3 steps/s
Avg test loss: 6.92405, Avg test acc: 0.15243, Avg tpr: 0.73891, Avg fpr: 0.85823, total FA: 119164

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.50701 | acc=0.1374 | tpr=0.8230 | fpr=0.8749 | 4791.0 samples/s | 18.7 steps/s
[Step= 100] | Loss=5.48910 | acc=0.1397 | tpr=0.7974 | fpr=0.8725 | 7286.0 samples/s | 28.5 steps/s
[Step= 150] | Loss=5.48975 | acc=0.1412 | tpr=0.7911 | fpr=0.8708 | 8033.1 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.48477 | acc=0.1415 | tpr=0.7836 | fpr=0.8702 | 8143.8 samples/s | 31.8 steps/s
[Step= 250] | Loss=5.48191 | acc=0.1422 | tpr=0.7860 | fpr=0.8695 | 7261.5 samples/s | 28.4 steps/s
[Step= 300] | Loss=5.47846 | acc=0.1428 | tpr=0.7876 | fpr=0.8690 | 8055.2 samples/s | 31.5 steps/s
[Step= 350] | Loss=5.48648 | acc=0.1423 | tpr=0.7896 | fpr=0.8694 | 8130.5 samples/s | 31.8 steps/s
[Step= 400] | Loss=5.48590 | acc=0.1421 | tpr=0.7872 | fpr=0.8696 | 8211.3 samples/s | 32.1 steps/s
[Step= 450] | Loss=5.48488 | acc=0.1422 | tpr=0.7833 | fpr=0.8695 | 7544.3 samples/s | 29.5 steps/s
[Step= 500] | Loss=5.48946 | acc=0.1419 | tpr=0.7811 | fpr=0.8696 | 7835.8 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.49074 | acc=0.1420 | tpr=0.7799 | fpr=0.8696 | 11271.4 samples/s | 44.0 steps/s
Avg test loss: 5.49157, Avg test acc: 0.14186, Avg tpr: 0.77932, Avg fpr: 0.86973, total FA: 120760

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19648 | acc=0.9576 | tpr=0.8982 | fpr=0.0414 | 4534.9 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.20315 | acc=0.9565 | tpr=0.9168 | fpr=0.0427 | 7245.8 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.20574 | acc=0.9558 | tpr=0.9222 | fpr=0.0436 | 8205.4 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.20554 | acc=0.9557 | tpr=0.9257 | fpr=0.0437 | 8075.1 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.20747 | acc=0.9554 | tpr=0.9275 | fpr=0.0441 | 7787.4 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.20939 | acc=0.9547 | tpr=0.9280 | fpr=0.0449 | 8672.9 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.20941 | acc=0.9547 | tpr=0.9286 | fpr=0.0448 | 7760.5 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.21112 | acc=0.9544 | tpr=0.9251 | fpr=0.0451 | 8337.8 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.21252 | acc=0.9539 | tpr=0.9226 | fpr=0.0455 | 7467.7 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.21226 | acc=0.9540 | tpr=0.9251 | fpr=0.0454 | 7981.6 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.21173 | acc=0.9541 | tpr=0.9240 | fpr=0.0454 | 11335.2 samples/s | 44.3 steps/s
Avg test loss: 0.21153, Avg test acc: 0.95411, Avg tpr: 0.92433, Avg fpr: 0.04535, total FA: 6297

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11366 | acc=0.9702 | tpr=0.9159 | fpr=0.0289 | 4641.4 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.11497 | acc=0.9701 | tpr=0.9168 | fpr=0.0289 | 7944.4 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.11552 | acc=0.9695 | tpr=0.9193 | fpr=0.0295 | 7990.8 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.11635 | acc=0.9700 | tpr=0.9246 | fpr=0.0292 | 7820.9 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.11852 | acc=0.9695 | tpr=0.9214 | fpr=0.0297 | 8303.4 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.11908 | acc=0.9692 | tpr=0.9193 | fpr=0.0299 | 7763.3 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.12117 | acc=0.9688 | tpr=0.9180 | fpr=0.0303 | 7492.9 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.12245 | acc=0.9685 | tpr=0.9185 | fpr=0.0306 | 8153.3 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.12287 | acc=0.9683 | tpr=0.9172 | fpr=0.0307 | 8099.2 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.12199 | acc=0.9685 | tpr=0.9203 | fpr=0.0306 | 8013.7 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.12244 | acc=0.9685 | tpr=0.9180 | fpr=0.0306 | 9829.4 samples/s | 38.4 steps/s
Avg test loss: 0.12220, Avg test acc: 0.96853, Avg tpr: 0.91838, Avg fpr: 0.03056, total FA: 4243

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.21230 | acc=0.9564 | tpr=0.9071 | fpr=0.0427 | 4701.6 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.21793 | acc=0.9568 | tpr=0.9126 | fpr=0.0424 | 7320.2 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.22347 | acc=0.9558 | tpr=0.9164 | fpr=0.0435 | 8204.3 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.22450 | acc=0.9560 | tpr=0.9213 | fpr=0.0434 | 8298.6 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.22645 | acc=0.9557 | tpr=0.9179 | fpr=0.0437 | 7958.0 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.22733 | acc=0.9552 | tpr=0.9171 | fpr=0.0441 | 7847.5 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.22712 | acc=0.9555 | tpr=0.9198 | fpr=0.0439 | 7625.3 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.22778 | acc=0.9552 | tpr=0.9179 | fpr=0.0441 | 8204.6 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.22882 | acc=0.9550 | tpr=0.9167 | fpr=0.0443 | 8138.9 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.22926 | acc=0.9551 | tpr=0.9207 | fpr=0.0443 | 7535.4 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.22807 | acc=0.9551 | tpr=0.9188 | fpr=0.0442 | 10404.2 samples/s | 40.6 steps/s
Avg test loss: 0.22751, Avg test acc: 0.95517, Avg tpr: 0.91878, Avg fpr: 0.04417, total FA: 6133

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15901 | acc=0.9655 | tpr=0.9115 | fpr=0.0335 | 4715.5 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.16597 | acc=0.9639 | tpr=0.9190 | fpr=0.0352 | 7792.9 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.17019 | acc=0.9631 | tpr=0.9236 | fpr=0.0362 | 7708.7 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.16949 | acc=0.9630 | tpr=0.9301 | fpr=0.0364 | 7616.9 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.17124 | acc=0.9628 | tpr=0.9310 | fpr=0.0366 | 8141.4 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.17333 | acc=0.9625 | tpr=0.9338 | fpr=0.0370 | 8421.6 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.17446 | acc=0.9622 | tpr=0.9330 | fpr=0.0373 | 7846.8 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.17566 | acc=0.9620 | tpr=0.9311 | fpr=0.0375 | 8258.8 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.17686 | acc=0.9617 | tpr=0.9294 | fpr=0.0377 | 7593.3 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.17645 | acc=0.9619 | tpr=0.9330 | fpr=0.0376 | 8161.4 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.17592 | acc=0.9621 | tpr=0.9327 | fpr=0.0373 | 9615.3 samples/s | 37.6 steps/s
Avg test loss: 0.17550, Avg test acc: 0.96216, Avg tpr: 0.93265, Avg fpr: 0.03730, total FA: 5179

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.21622 | acc=0.9539 | tpr=0.8717 | fpr=0.0446 | 4784.6 samples/s | 18.7 steps/s
[Step= 100] | Loss=0.22725 | acc=0.9529 | tpr=0.8955 | fpr=0.0460 | 7482.4 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.23319 | acc=0.9520 | tpr=0.9063 | fpr=0.0472 | 8001.0 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.23597 | acc=0.9521 | tpr=0.9148 | fpr=0.0473 | 7614.7 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.23818 | acc=0.9518 | tpr=0.9162 | fpr=0.0475 | 7777.0 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.24066 | acc=0.9515 | tpr=0.9185 | fpr=0.0479 | 8082.1 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.24237 | acc=0.9513 | tpr=0.9161 | fpr=0.0481 | 8296.3 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.24329 | acc=0.9509 | tpr=0.9152 | fpr=0.0484 | 8221.0 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.24447 | acc=0.9506 | tpr=0.9133 | fpr=0.0487 | 8014.7 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.24506 | acc=0.9505 | tpr=0.9154 | fpr=0.0489 | 7769.0 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.24421 | acc=0.9507 | tpr=0.9148 | fpr=0.0487 | 9966.4 samples/s | 38.9 steps/s
Avg test loss: 0.24390, Avg test acc: 0.95072, Avg tpr: 0.91442, Avg fpr: 0.04862, total FA: 6751

server round 20/50

clients selected: [1 3 5 6 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=16001 Epoch=78.1] | Loss=0.02925 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.685 | L2-Norm(final)=11.497 | 3086.1 samples/s | 48.2 steps/s
[Step=16050 Epoch=78.3] | Loss=0.04271 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.685 | L2-Norm(final)=11.502 | 4960.9 samples/s | 77.5 steps/s
[Step=16100 Epoch=78.6] | Loss=0.04206 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.685 | L2-Norm(final)=11.508 | 5508.4 samples/s | 86.1 steps/s
[Step=16150 Epoch=78.8] | Loss=0.04044 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.685 | L2-Norm(final)=11.518 | 5225.9 samples/s | 81.7 steps/s
[Step=16200 Epoch=79.0] | Loss=0.04275 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.685 | L2-Norm(final)=11.527 | 8528.5 samples/s | 133.3 steps/s
[Step=16250 Epoch=79.3] | Loss=0.04188 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.685 | L2-Norm(final)=11.534 | 1438.9 samples/s | 22.5 steps/s
[Step=16300 Epoch=79.5] | Loss=0.04229 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.685 | L2-Norm(final)=11.541 | 5408.9 samples/s | 84.5 steps/s
[Step=16350 Epoch=79.8] | Loss=0.04260 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.685 | L2-Norm(final)=11.547 | 5388.4 samples/s | 84.2 steps/s
[Step=16400 Epoch=80.0] | Loss=0.04259 | Reg=0.00137 | acc=0.9219 | L2-Norm=11.685 | L2-Norm(final)=11.553 | 7687.9 samples/s | 120.1 steps/s
[Step=16450 Epoch=80.3] | Loss=0.04216 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.685 | L2-Norm(final)=11.561 | 1475.8 samples/s | 23.1 steps/s
[Step=16500 Epoch=80.5] | Loss=0.04220 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.685 | L2-Norm(final)=11.568 | 5607.4 samples/s | 87.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=16501 Epoch=80.5] | Loss=0.01966 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.685 | L2-Norm(final)=11.644 | 3157.2 samples/s | 49.3 steps/s
[Step=16550 Epoch=80.8] | Loss=0.04053 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.717 | L2-Norm(final)=11.650 | 4200.4 samples/s | 65.6 steps/s
[Step=16600 Epoch=81.0] | Loss=0.03613 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.749 | L2-Norm(final)=11.648 | 4559.1 samples/s | 71.2 steps/s
[Step=16650 Epoch=81.2] | Loss=0.03319 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.776 | L2-Norm(final)=11.649 | 4599.0 samples/s | 71.9 steps/s
[Step=16700 Epoch=81.5] | Loss=0.03027 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.799 | L2-Norm(final)=11.651 | 6713.5 samples/s | 104.9 steps/s
[Step=16750 Epoch=81.7] | Loss=0.02686 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.819 | L2-Norm(final)=11.654 | 1365.9 samples/s | 21.3 steps/s
[Step=16800 Epoch=82.0] | Loss=0.02408 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.836 | L2-Norm(final)=11.658 | 4685.4 samples/s | 73.2 steps/s
[Step=16850 Epoch=82.2] | Loss=0.02215 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.851 | L2-Norm(final)=11.662 | 4556.9 samples/s | 71.2 steps/s
[Step=16900 Epoch=82.5] | Loss=0.02073 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.864 | L2-Norm(final)=11.665 | 6151.0 samples/s | 96.1 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01910 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.875 | L2-Norm(final)=11.669 | 1407.1 samples/s | 22.0 steps/s
[Step=17000 Epoch=83.0] | Loss=0.01801 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.886 | L2-Norm(final)=11.673 | 4692.0 samples/s | 73.3 steps/s
[Step=17050 Epoch=83.2] | Loss=0.01723 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.895 | L2-Norm(final)=11.676 | 4537.7 samples/s | 70.9 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01633 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.904 | L2-Norm(final)=11.680 | 5659.5 samples/s | 88.4 steps/s
[Step=17150 Epoch=83.7] | Loss=0.01549 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.913 | L2-Norm(final)=11.683 | 1425.7 samples/s | 22.3 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01473 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.920 | L2-Norm(final)=11.686 | 4747.3 samples/s | 74.2 steps/s
[Step=17250 Epoch=84.2] | Loss=0.01407 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.928 | L2-Norm(final)=11.690 | 4714.4 samples/s | 73.7 steps/s
[Step=17300 Epoch=84.4] | Loss=0.01359 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.934 | L2-Norm(final)=11.694 | 5288.9 samples/s | 82.6 steps/s
[Step=17350 Epoch=84.7] | Loss=0.01312 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.940 | L2-Norm(final)=11.697 | 1456.7 samples/s | 22.8 steps/s
[Step=17400 Epoch=84.9] | Loss=0.01268 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.946 | L2-Norm(final)=11.700 | 4800.7 samples/s | 75.0 steps/s
[Step=17450 Epoch=85.1] | Loss=0.01217 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.951 | L2-Norm(final)=11.703 | 4697.9 samples/s | 73.4 steps/s
[Step=17500 Epoch=85.4] | Loss=0.01169 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.956 | L2-Norm(final)=11.707 | 4998.5 samples/s | 78.1 steps/s
[Step=17550 Epoch=85.6] | Loss=0.01136 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.961 | L2-Norm(final)=11.710 | 1517.4 samples/s | 23.7 steps/s
[Step=17600 Epoch=85.9] | Loss=0.01099 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.965 | L2-Norm(final)=11.713 | 4647.5 samples/s | 72.6 steps/s
[Step=17650 Epoch=86.1] | Loss=0.01070 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.970 | L2-Norm(final)=11.716 | 4729.3 samples/s | 73.9 steps/s
[Step=17700 Epoch=86.4] | Loss=0.01045 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.974 | L2-Norm(final)=11.719 | 4739.1 samples/s | 74.0 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01016 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.977 | L2-Norm(final)=11.722 | 1548.8 samples/s | 24.2 steps/s
[Step=17800 Epoch=86.9] | Loss=0.00988 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.981 | L2-Norm(final)=11.724 | 4717.1 samples/s | 73.7 steps/s
[Step=17850 Epoch=87.1] | Loss=0.00968 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.984 | L2-Norm(final)=11.727 | 4667.7 samples/s | 72.9 steps/s
[Step=17900 Epoch=87.3] | Loss=0.00946 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.988 | L2-Norm(final)=11.730 | 4679.2 samples/s | 73.1 steps/s
[Step=17950 Epoch=87.6] | Loss=0.00923 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.991 | L2-Norm(final)=11.733 | 1523.5 samples/s | 23.8 steps/s
[Step=18000 Epoch=87.8] | Loss=0.00903 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.994 | L2-Norm(final)=11.735 | 4684.6 samples/s | 73.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_1/client_state-step18000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=117.0] | Loss=0.01965 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.685 | L2-Norm(final)=14.176 | 3142.2 samples/s | 49.1 steps/s
[Step=24050 Epoch=117.3] | Loss=0.04558 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.684 | L2-Norm(final)=14.175 | 5060.8 samples/s | 79.1 steps/s
[Step=24100 Epoch=117.5] | Loss=0.04443 | Reg=0.00137 | acc=0.9062 | L2-Norm=11.684 | L2-Norm(final)=14.179 | 5397.5 samples/s | 84.3 steps/s
[Step=24150 Epoch=117.8] | Loss=0.04265 | Reg=0.00137 | acc=0.9531 | L2-Norm=11.684 | L2-Norm(final)=14.186 | 5456.7 samples/s | 85.3 steps/s
[Step=24200 Epoch=118.0] | Loss=0.04195 | Reg=0.00137 | acc=0.9531 | L2-Norm=11.684 | L2-Norm(final)=14.191 | 8615.4 samples/s | 134.6 steps/s
[Step=24250 Epoch=118.3] | Loss=0.04023 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.684 | L2-Norm(final)=14.198 | 1485.0 samples/s | 23.2 steps/s
[Step=24300 Epoch=118.5] | Loss=0.03984 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.684 | L2-Norm(final)=14.206 | 5590.4 samples/s | 87.3 steps/s
[Step=24350 Epoch=118.7] | Loss=0.03955 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.684 | L2-Norm(final)=14.213 | 5531.2 samples/s | 86.4 steps/s
[Step=24400 Epoch=119.0] | Loss=0.03946 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.684 | L2-Norm(final)=14.220 | 7307.6 samples/s | 114.2 steps/s
[Step=24450 Epoch=119.2] | Loss=0.03847 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.684 | L2-Norm(final)=14.226 | 1505.4 samples/s | 23.5 steps/s
[Step=24500 Epoch=119.5] | Loss=0.03858 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.684 | L2-Norm(final)=14.233 | 5424.9 samples/s | 84.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=119.5] | Loss=0.11975 | Reg=0.00137 | acc=0.9375 | L2-Norm=11.684 | L2-Norm(final)=14.296 | 3207.1 samples/s | 50.1 steps/s
[Step=24550 Epoch=119.7] | Loss=0.03379 | Reg=0.00137 | acc=0.9531 | L2-Norm=11.717 | L2-Norm(final)=14.296 | 4386.4 samples/s | 68.5 steps/s
[Step=24600 Epoch=120.0] | Loss=0.02834 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.751 | L2-Norm(final)=14.295 | 4700.9 samples/s | 73.5 steps/s
[Step=24650 Epoch=120.2] | Loss=0.02572 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.775 | L2-Norm(final)=14.295 | 4658.6 samples/s | 72.8 steps/s
[Step=24700 Epoch=120.5] | Loss=0.02509 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.793 | L2-Norm(final)=14.295 | 6762.2 samples/s | 105.7 steps/s
[Step=24750 Epoch=120.7] | Loss=0.02192 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.808 | L2-Norm(final)=14.295 | 1415.7 samples/s | 22.1 steps/s
[Step=24800 Epoch=120.9] | Loss=0.02004 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.821 | L2-Norm(final)=14.297 | 4661.9 samples/s | 72.8 steps/s
[Step=24850 Epoch=121.2] | Loss=0.01831 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.832 | L2-Norm(final)=14.299 | 4699.6 samples/s | 73.4 steps/s
[Step=24900 Epoch=121.4] | Loss=0.01710 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.841 | L2-Norm(final)=14.302 | 6138.8 samples/s | 95.9 steps/s
[Step=24950 Epoch=121.7] | Loss=0.01621 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.849 | L2-Norm(final)=14.304 | 1422.6 samples/s | 22.2 steps/s
[Step=25000 Epoch=121.9] | Loss=0.01516 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.857 | L2-Norm(final)=14.305 | 4690.3 samples/s | 73.3 steps/s
[Step=25050 Epoch=122.2] | Loss=0.01431 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.863 | L2-Norm(final)=14.307 | 4765.2 samples/s | 74.5 steps/s
[Step=25100 Epoch=122.4] | Loss=0.01351 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.869 | L2-Norm(final)=14.310 | 5559.8 samples/s | 86.9 steps/s
[Step=25150 Epoch=122.6] | Loss=0.01285 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.875 | L2-Norm(final)=14.312 | 1481.8 samples/s | 23.2 steps/s
[Step=25200 Epoch=122.9] | Loss=0.01222 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.880 | L2-Norm(final)=14.314 | 4698.6 samples/s | 73.4 steps/s
[Step=25250 Epoch=123.1] | Loss=0.01172 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.885 | L2-Norm(final)=14.316 | 4719.1 samples/s | 73.7 steps/s
[Step=25300 Epoch=123.4] | Loss=0.01141 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.889 | L2-Norm(final)=14.317 | 5159.3 samples/s | 80.6 steps/s
[Step=25350 Epoch=123.6] | Loss=0.01097 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.893 | L2-Norm(final)=14.319 | 1536.2 samples/s | 24.0 steps/s
[Step=25400 Epoch=123.9] | Loss=0.01056 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.897 | L2-Norm(final)=14.321 | 4633.3 samples/s | 72.4 steps/s
[Step=25450 Epoch=124.1] | Loss=0.01023 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.901 | L2-Norm(final)=14.323 | 4741.0 samples/s | 74.1 steps/s
[Step=25500 Epoch=124.4] | Loss=0.00982 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.905 | L2-Norm(final)=14.325 | 4784.7 samples/s | 74.8 steps/s
[Step=25550 Epoch=124.6] | Loss=0.00951 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.908 | L2-Norm(final)=14.327 | 1576.1 samples/s | 24.6 steps/s
[Step=25600 Epoch=124.8] | Loss=0.00913 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.911 | L2-Norm(final)=14.329 | 4611.7 samples/s | 72.1 steps/s
[Step=25650 Epoch=125.1] | Loss=0.00887 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.914 | L2-Norm(final)=14.331 | 4697.6 samples/s | 73.4 steps/s
[Step=25700 Epoch=125.3] | Loss=0.00870 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.917 | L2-Norm(final)=14.333 | 4788.7 samples/s | 74.8 steps/s
[Step=25750 Epoch=125.6] | Loss=0.00851 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.920 | L2-Norm(final)=14.335 | 1541.1 samples/s | 24.1 steps/s
[Step=25800 Epoch=125.8] | Loss=0.00830 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.923 | L2-Norm(final)=14.337 | 4663.2 samples/s | 72.9 steps/s
[Step=25850 Epoch=126.1] | Loss=0.00814 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.925 | L2-Norm(final)=14.339 | 4739.7 samples/s | 74.1 steps/s
[Step=25900 Epoch=126.3] | Loss=0.00793 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.928 | L2-Norm(final)=14.341 | 4634.8 samples/s | 72.4 steps/s
[Step=25950 Epoch=126.5] | Loss=0.00777 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.930 | L2-Norm(final)=14.343 | 1555.8 samples/s | 24.3 steps/s
[Step=26000 Epoch=126.8] | Loss=0.00761 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.932 | L2-Norm(final)=14.345 | 4742.3 samples/s | 74.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step26000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=246.4] | Loss=0.00011 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.685 | L2-Norm(final)=16.928 | 3131.2 samples/s | 48.9 steps/s
[Step=26050 Epoch=246.8] | Loss=0.00110 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.683 | L2-Norm(final)=16.934 | 4602.0 samples/s | 71.9 steps/s
[Step=26100 Epoch=247.3] | Loss=0.00093 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=16.941 | 7660.3 samples/s | 119.7 steps/s
[Step=26150 Epoch=247.8] | Loss=0.00102 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=16.947 | 1407.9 samples/s | 22.0 steps/s
[Step=26200 Epoch=248.3] | Loss=0.00094 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=16.954 | 7156.2 samples/s | 111.8 steps/s
[Step=26250 Epoch=248.7] | Loss=0.00098 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=16.961 | 1475.3 samples/s | 23.1 steps/s
[Step=26300 Epoch=249.2] | Loss=0.00094 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=16.968 | 6436.1 samples/s | 100.6 steps/s
[Step=26350 Epoch=249.7] | Loss=0.00090 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=16.975 | 1515.3 samples/s | 23.7 steps/s
[Step=26400 Epoch=250.2] | Loss=0.00094 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=16.983 | 5711.3 samples/s | 89.2 steps/s
[Step=26450 Epoch=250.6] | Loss=0.00090 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=16.990 | 1558.8 samples/s | 24.4 steps/s
[Step=26500 Epoch=251.1] | Loss=0.00091 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=16.996 | 5368.4 samples/s | 83.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=251.1] | Loss=0.00028 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=17.065 | 3121.0 samples/s | 48.8 steps/s
[Step=26550 Epoch=251.6] | Loss=0.00164 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.687 | L2-Norm(final)=17.071 | 4150.4 samples/s | 64.9 steps/s
[Step=26600 Epoch=252.1] | Loss=0.00091 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.691 | L2-Norm(final)=17.075 | 6297.2 samples/s | 98.4 steps/s
[Step=26650 Epoch=252.5] | Loss=0.00062 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.688 | L2-Norm(final)=17.078 | 1373.5 samples/s | 21.5 steps/s
[Step=26700 Epoch=253.0] | Loss=0.00047 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=17.080 | 5942.5 samples/s | 92.9 steps/s
[Step=26750 Epoch=253.5] | Loss=0.00038 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=17.081 | 1410.4 samples/s | 22.0 steps/s
[Step=26800 Epoch=254.0] | Loss=0.00032 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.666 | L2-Norm(final)=17.082 | 5287.7 samples/s | 82.6 steps/s
[Step=26850 Epoch=254.4] | Loss=0.00028 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.658 | L2-Norm(final)=17.083 | 1460.6 samples/s | 22.8 steps/s
[Step=26900 Epoch=254.9] | Loss=0.00024 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.650 | L2-Norm(final)=17.084 | 4908.3 samples/s | 76.7 steps/s
[Step=26950 Epoch=255.4] | Loss=0.00022 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.642 | L2-Norm(final)=17.085 | 1474.9 samples/s | 23.0 steps/s
[Step=27000 Epoch=255.8] | Loss=0.00020 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.634 | L2-Norm(final)=17.086 | 4576.3 samples/s | 71.5 steps/s
[Step=27050 Epoch=256.3] | Loss=0.00018 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.626 | L2-Norm(final)=17.087 | 1491.8 samples/s | 23.3 steps/s
[Step=27100 Epoch=256.8] | Loss=0.00017 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.618 | L2-Norm(final)=17.087 | 4508.1 samples/s | 70.4 steps/s
[Step=27150 Epoch=257.3] | Loss=0.00015 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.610 | L2-Norm(final)=17.088 | 1525.2 samples/s | 23.8 steps/s
[Step=27200 Epoch=257.7] | Loss=0.00014 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.602 | L2-Norm(final)=17.088 | 4443.0 samples/s | 69.4 steps/s
[Step=27250 Epoch=258.2] | Loss=0.00013 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.594 | L2-Norm(final)=17.089 | 1523.6 samples/s | 23.8 steps/s
[Step=27300 Epoch=258.7] | Loss=0.00013 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.586 | L2-Norm(final)=17.089 | 4516.8 samples/s | 70.6 steps/s
[Step=27350 Epoch=259.2] | Loss=0.00012 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.578 | L2-Norm(final)=17.090 | 1532.7 samples/s | 23.9 steps/s
[Step=27400 Epoch=259.6] | Loss=0.00011 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.570 | L2-Norm(final)=17.090 | 4304.4 samples/s | 67.3 steps/s
[Step=27450 Epoch=260.1] | Loss=0.00011 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.562 | L2-Norm(final)=17.091 | 6771.3 samples/s | 105.8 steps/s
[Step=27500 Epoch=260.6] | Loss=0.00010 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.554 | L2-Norm(final)=17.091 | 1386.5 samples/s | 21.7 steps/s
[Step=27550 Epoch=261.1] | Loss=0.00010 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.546 | L2-Norm(final)=17.092 | 5895.0 samples/s | 92.1 steps/s
[Step=27600 Epoch=261.5] | Loss=0.00009 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.538 | L2-Norm(final)=17.092 | 1390.8 samples/s | 21.7 steps/s
[Step=27650 Epoch=262.0] | Loss=0.00009 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.530 | L2-Norm(final)=17.093 | 5518.1 samples/s | 86.2 steps/s
[Step=27700 Epoch=262.5] | Loss=0.00009 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.522 | L2-Norm(final)=17.093 | 1424.3 samples/s | 22.3 steps/s
[Step=27750 Epoch=263.0] | Loss=0.00008 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.514 | L2-Norm(final)=17.094 | 5124.5 samples/s | 80.1 steps/s
[Step=27800 Epoch=263.4] | Loss=0.00008 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.506 | L2-Norm(final)=17.094 | 1493.5 samples/s | 23.3 steps/s
[Step=27850 Epoch=263.9] | Loss=0.00008 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.498 | L2-Norm(final)=17.095 | 4657.6 samples/s | 72.8 steps/s
[Step=27900 Epoch=264.4] | Loss=0.00007 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.490 | L2-Norm(final)=17.095 | 1489.0 samples/s | 23.3 steps/s
[Step=27950 Epoch=264.9] | Loss=0.00007 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.482 | L2-Norm(final)=17.095 | 4469.1 samples/s | 69.8 steps/s
[Step=28000 Epoch=265.3] | Loss=0.00007 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.473 | L2-Norm(final)=17.096 | 1511.7 samples/s | 23.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step28000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=190.3] | Loss=0.00281 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.685 | L2-Norm(final)=12.505 | 3234.1 samples/s | 50.5 steps/s
[Step=20050 Epoch=190.7] | Loss=0.00195 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=12.515 | 4639.5 samples/s | 72.5 steps/s
[Step=20100 Epoch=191.2] | Loss=0.00203 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=12.530 | 7804.2 samples/s | 121.9 steps/s
[Step=20150 Epoch=191.7] | Loss=0.00183 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=12.545 | 1434.2 samples/s | 22.4 steps/s
[Step=20200 Epoch=192.2] | Loss=0.00198 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=12.560 | 7349.0 samples/s | 114.8 steps/s
[Step=20250 Epoch=192.6] | Loss=0.00192 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=12.575 | 1494.3 samples/s | 23.3 steps/s
[Step=20300 Epoch=193.1] | Loss=0.00195 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=12.589 | 6484.2 samples/s | 101.3 steps/s
[Step=20350 Epoch=193.6] | Loss=0.00193 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.682 | L2-Norm(final)=12.603 | 1544.1 samples/s | 24.1 steps/s
[Step=20400 Epoch=194.1] | Loss=0.00196 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=12.617 | 5923.5 samples/s | 92.6 steps/s
[Step=20450 Epoch=194.5] | Loss=0.00191 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=12.630 | 1544.2 samples/s | 24.1 steps/s
[Step=20500 Epoch=195.0] | Loss=0.00188 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=12.643 | 5315.6 samples/s | 83.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=195.0] | Loss=0.00009 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=12.774 | 3179.7 samples/s | 49.7 steps/s
[Step=20550 Epoch=195.5] | Loss=0.00102 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.700 | L2-Norm(final)=12.787 | 4020.2 samples/s | 62.8 steps/s
[Step=20600 Epoch=196.0] | Loss=0.00060 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.703 | L2-Norm(final)=12.796 | 6437.2 samples/s | 100.6 steps/s
[Step=20650 Epoch=196.4] | Loss=0.00041 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=12.801 | 1398.4 samples/s | 21.8 steps/s
[Step=20700 Epoch=196.9] | Loss=0.00031 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.688 | L2-Norm(final)=12.804 | 5862.6 samples/s | 91.6 steps/s
[Step=20750 Epoch=197.4] | Loss=0.00025 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.677 | L2-Norm(final)=12.806 | 1396.7 samples/s | 21.8 steps/s
[Step=20800 Epoch=197.9] | Loss=0.00021 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.666 | L2-Norm(final)=12.808 | 5373.4 samples/s | 84.0 steps/s
[Step=20850 Epoch=198.3] | Loss=0.00018 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=12.809 | 1478.7 samples/s | 23.1 steps/s
[Step=20900 Epoch=198.8] | Loss=0.00016 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.644 | L2-Norm(final)=12.810 | 4943.9 samples/s | 77.2 steps/s
[Step=20950 Epoch=199.3] | Loss=0.00014 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.633 | L2-Norm(final)=12.811 | 1478.7 samples/s | 23.1 steps/s
[Step=21000 Epoch=199.8] | Loss=0.00013 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.622 | L2-Norm(final)=12.812 | 4590.2 samples/s | 71.7 steps/s
[Step=21050 Epoch=200.2] | Loss=0.00012 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.611 | L2-Norm(final)=12.813 | 1536.2 samples/s | 24.0 steps/s
[Step=21100 Epoch=200.7] | Loss=0.00011 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.599 | L2-Norm(final)=12.814 | 4459.4 samples/s | 69.7 steps/s
[Step=21150 Epoch=201.2] | Loss=0.00010 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.588 | L2-Norm(final)=12.814 | 1515.2 samples/s | 23.7 steps/s
[Step=21200 Epoch=201.7] | Loss=0.00009 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.577 | L2-Norm(final)=12.815 | 4497.0 samples/s | 70.3 steps/s
[Step=21250 Epoch=202.1] | Loss=0.00009 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.565 | L2-Norm(final)=12.815 | 1511.2 samples/s | 23.6 steps/s
[Step=21300 Epoch=202.6] | Loss=0.00008 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.554 | L2-Norm(final)=12.816 | 4542.9 samples/s | 71.0 steps/s
[Step=21350 Epoch=203.1] | Loss=0.00008 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.542 | L2-Norm(final)=12.816 | 1553.8 samples/s | 24.3 steps/s
[Step=21400 Epoch=203.6] | Loss=0.00007 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.531 | L2-Norm(final)=12.817 | 4264.4 samples/s | 66.6 steps/s
[Step=21450 Epoch=204.0] | Loss=0.00007 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.520 | L2-Norm(final)=12.817 | 6778.7 samples/s | 105.9 steps/s
[Step=21500 Epoch=204.5] | Loss=0.00007 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.508 | L2-Norm(final)=12.817 | 1372.1 samples/s | 21.4 steps/s
[Step=21550 Epoch=205.0] | Loss=0.00006 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.497 | L2-Norm(final)=12.818 | 6075.0 samples/s | 94.9 steps/s
[Step=21600 Epoch=205.5] | Loss=0.00006 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.486 | L2-Norm(final)=12.818 | 1403.5 samples/s | 21.9 steps/s
[Step=21650 Epoch=205.9] | Loss=0.00006 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.474 | L2-Norm(final)=12.819 | 5533.3 samples/s | 86.5 steps/s
[Step=21700 Epoch=206.4] | Loss=0.00005 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.463 | L2-Norm(final)=12.819 | 1448.6 samples/s | 22.6 steps/s
[Step=21750 Epoch=206.9] | Loss=0.00005 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.451 | L2-Norm(final)=12.819 | 5039.2 samples/s | 78.7 steps/s
[Step=21800 Epoch=207.4] | Loss=0.00005 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.440 | L2-Norm(final)=12.820 | 1464.4 samples/s | 22.9 steps/s
[Step=21850 Epoch=207.8] | Loss=0.00005 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.428 | L2-Norm(final)=12.820 | 4703.8 samples/s | 73.5 steps/s
[Step=21900 Epoch=208.3] | Loss=0.00005 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.417 | L2-Norm(final)=12.820 | 1506.6 samples/s | 23.5 steps/s
[Step=21950 Epoch=208.8] | Loss=0.00005 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=12.821 | 4470.6 samples/s | 69.9 steps/s
[Step=22000 Epoch=209.3] | Loss=0.00004 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.394 | L2-Norm(final)=12.821 | 1548.3 samples/s | 24.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step22000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=209.7] | Loss=0.00052 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.685 | L2-Norm(final)=17.282 | 3205.8 samples/s | 50.1 steps/s
[Step=22050 Epoch=210.2] | Loss=0.00264 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=17.300 | 4473.3 samples/s | 69.9 steps/s
[Step=22100 Epoch=210.6] | Loss=0.00407 | Reg=0.00136 | acc=0.9531 | L2-Norm=11.682 | L2-Norm(final)=17.321 | 8285.8 samples/s | 129.5 steps/s
[Step=22150 Epoch=211.1] | Loss=0.00401 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.682 | L2-Norm(final)=17.341 | 1429.6 samples/s | 22.3 steps/s
[Step=22200 Epoch=211.6] | Loss=0.00395 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=17.360 | 7492.7 samples/s | 117.1 steps/s
[Step=22250 Epoch=212.1] | Loss=0.00379 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=17.379 | 1474.7 samples/s | 23.0 steps/s
[Step=22300 Epoch=212.5] | Loss=0.00394 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=17.397 | 6687.2 samples/s | 104.5 steps/s
[Step=22350 Epoch=213.0] | Loss=0.00386 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=17.415 | 1520.4 samples/s | 23.8 steps/s
[Step=22400 Epoch=213.5] | Loss=0.00391 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=17.433 | 6203.2 samples/s | 96.9 steps/s
[Step=22450 Epoch=214.0] | Loss=0.00389 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=17.451 | 1539.2 samples/s | 24.1 steps/s
[Step=22500 Epoch=214.4] | Loss=0.00390 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=17.469 | 5777.0 samples/s | 90.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=214.5] | Loss=0.00649 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=17.643 | 3352.2 samples/s | 52.4 steps/s
[Step=22550 Epoch=214.9] | Loss=0.00165 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.707 | L2-Norm(final)=17.654 | 3767.7 samples/s | 58.9 steps/s
[Step=22600 Epoch=215.4] | Loss=0.00117 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.724 | L2-Norm(final)=17.663 | 6440.9 samples/s | 100.6 steps/s
[Step=22650 Epoch=215.9] | Loss=0.00079 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.728 | L2-Norm(final)=17.667 | 1363.0 samples/s | 21.3 steps/s
[Step=22700 Epoch=216.4] | Loss=0.00059 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.725 | L2-Norm(final)=17.670 | 6099.8 samples/s | 95.3 steps/s
[Step=22750 Epoch=216.8] | Loss=0.00048 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.719 | L2-Norm(final)=17.671 | 1408.4 samples/s | 22.0 steps/s
[Step=22800 Epoch=217.3] | Loss=0.00040 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.711 | L2-Norm(final)=17.673 | 5524.0 samples/s | 86.3 steps/s
[Step=22850 Epoch=217.8] | Loss=0.00034 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.702 | L2-Norm(final)=17.674 | 1422.6 samples/s | 22.2 steps/s
[Step=22900 Epoch=218.3] | Loss=0.00030 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.694 | L2-Norm(final)=17.674 | 5232.6 samples/s | 81.8 steps/s
[Step=22950 Epoch=218.7] | Loss=0.00027 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.685 | L2-Norm(final)=17.675 | 1488.0 samples/s | 23.2 steps/s
[Step=23000 Epoch=219.2] | Loss=0.00024 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=17.675 | 4869.9 samples/s | 76.1 steps/s
[Step=23050 Epoch=219.7] | Loss=0.00022 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.666 | L2-Norm(final)=17.676 | 1462.7 samples/s | 22.9 steps/s
[Step=23100 Epoch=220.2] | Loss=0.00020 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.657 | L2-Norm(final)=17.676 | 4597.7 samples/s | 71.8 steps/s
[Step=23150 Epoch=220.6] | Loss=0.00019 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.647 | L2-Norm(final)=17.677 | 1520.9 samples/s | 23.8 steps/s
[Step=23200 Epoch=221.1] | Loss=0.00017 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.638 | L2-Norm(final)=17.677 | 4372.0 samples/s | 68.3 steps/s
[Step=23250 Epoch=221.6] | Loss=0.00016 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.629 | L2-Norm(final)=17.678 | 1523.1 samples/s | 23.8 steps/s
[Step=23300 Epoch=222.1] | Loss=0.00015 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.619 | L2-Norm(final)=17.678 | 4527.0 samples/s | 70.7 steps/s
[Step=23350 Epoch=222.5] | Loss=0.00014 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.610 | L2-Norm(final)=17.678 | 1514.9 samples/s | 23.7 steps/s
[Step=23400 Epoch=223.0] | Loss=0.00014 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.600 | L2-Norm(final)=17.679 | 4443.8 samples/s | 69.4 steps/s
[Step=23450 Epoch=223.5] | Loss=0.00013 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.591 | L2-Norm(final)=17.679 | 1525.1 samples/s | 23.8 steps/s
[Step=23500 Epoch=224.0] | Loss=0.00012 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=17.679 | 4399.0 samples/s | 68.7 steps/s
[Step=23550 Epoch=224.5] | Loss=0.00012 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.572 | L2-Norm(final)=17.680 | 7251.7 samples/s | 113.3 steps/s
[Step=23600 Epoch=224.9] | Loss=0.00011 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.562 | L2-Norm(final)=17.680 | 1343.9 samples/s | 21.0 steps/s
[Step=23650 Epoch=225.4] | Loss=0.00011 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.553 | L2-Norm(final)=17.680 | 6556.3 samples/s | 102.4 steps/s
[Step=23700 Epoch=225.9] | Loss=0.00010 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.543 | L2-Norm(final)=17.680 | 1372.1 samples/s | 21.4 steps/s
[Step=23750 Epoch=226.4] | Loss=0.00010 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.533 | L2-Norm(final)=17.681 | 6034.9 samples/s | 94.3 steps/s
[Step=23800 Epoch=226.8] | Loss=0.00009 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=17.681 | 1398.3 samples/s | 21.8 steps/s
[Step=23850 Epoch=227.3] | Loss=0.00009 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.514 | L2-Norm(final)=17.681 | 5580.9 samples/s | 87.2 steps/s
[Step=23900 Epoch=227.8] | Loss=0.00009 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.504 | L2-Norm(final)=17.682 | 1441.5 samples/s | 22.5 steps/s
[Step=23950 Epoch=228.3] | Loss=0.00008 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.495 | L2-Norm(final)=17.682 | 5224.8 samples/s | 81.6 steps/s
[Step=24000 Epoch=228.7] | Loss=0.00008 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.485 | L2-Norm(final)=17.682 | 1446.3 samples/s | 22.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11195 | acc=0.9470 | tpr=0.9489 | fpr=0.0572 | 4686.6 samples/s | 18.3 steps/s
Avg test loss: 0.11621, Avg test acc: 0.94619, Avg tpr: 0.94888, Avg fpr: 0.05974, total FA: 466

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09355 | acc=0.9589 | tpr=0.9733 | fpr=0.0723 | 4646.5 samples/s | 18.2 steps/s
Avg test loss: 0.09591, Avg test acc: 0.95857, Avg tpr: 0.97360, Avg fpr: 0.07448, total FA: 581

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11102 | acc=0.9488 | tpr=0.9604 | fpr=0.0763 | 4714.3 samples/s | 18.4 steps/s
Avg test loss: 0.11593, Avg test acc: 0.94883, Avg tpr: 0.95978, Avg fpr: 0.07525, total FA: 587

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09843 | acc=0.9579 | tpr=0.9618 | fpr=0.0505 | 4780.4 samples/s | 18.7 steps/s
Avg test loss: 0.10257, Avg test acc: 0.95633, Avg tpr: 0.96083, Avg fpr: 0.05358, total FA: 418

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10287 | acc=0.9495 | tpr=0.9637 | fpr=0.0815 | 4703.9 samples/s | 18.4 steps/s
Avg test loss: 0.10637, Avg test acc: 0.94903, Avg tpr: 0.96328, Avg fpr: 0.08230, total FA: 642

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.30596 | acc=0.3065 | tpr=0.0135 | fpr=0.0572 | 4779.1 samples/s | 18.7 steps/s
Avg test loss: 5.32805, Avg test acc: 0.30247, Avg tpr: 0.01177, Avg fpr: 0.05820, total FA: 454

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.41126 | acc=0.2745 | tpr=0.0175 | fpr=0.1672 | 4816.7 samples/s | 18.8 steps/s
Avg test loss: 4.43039, Avg test acc: 0.27242, Avg tpr: 0.01673, Avg fpr: 0.16524, total FA: 1289

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.73506 | acc=0.3112 | tpr=0.0033 | fpr=0.0203 | 4745.3 samples/s | 18.5 steps/s
Avg test loss: 4.75639, Avg test acc: 0.30820, Avg tpr: 0.00332, Avg fpr: 0.02128, total FA: 166

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.64201 | acc=0.2994 | tpr=0.0260 | fpr=0.1070 | 4715.7 samples/s | 18.4 steps/s
Avg test loss: 4.66010, Avg test acc: 0.29562, Avg tpr: 0.02489, Avg fpr: 0.10896, total FA: 850

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.97781 | acc=0.3081 | tpr=0.0032 | fpr=0.0297 | 4612.9 samples/s | 18.0 steps/s
Avg test loss: 5.00531, Avg test acc: 0.30503, Avg tpr: 0.00326, Avg fpr: 0.03128, total FA: 244

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.52898 | acc=0.1523 | tpr=0.7699 | fpr=0.8588 | 4710.1 samples/s | 18.4 steps/s
[Step= 100] | Loss=5.49775 | acc=0.1545 | tpr=0.7420 | fpr=0.8565 | 7989.1 samples/s | 31.2 steps/s
[Step= 150] | Loss=5.50506 | acc=0.1556 | tpr=0.7594 | fpr=0.8555 | 8331.8 samples/s | 32.5 steps/s
[Step= 200] | Loss=5.49456 | acc=0.1553 | tpr=0.7486 | fpr=0.8555 | 7676.8 samples/s | 30.0 steps/s
[Step= 250] | Loss=5.49050 | acc=0.1556 | tpr=0.7371 | fpr=0.8550 | 7600.4 samples/s | 29.7 steps/s
[Step= 300] | Loss=5.48701 | acc=0.1560 | tpr=0.7367 | fpr=0.8546 | 7985.6 samples/s | 31.2 steps/s
[Step= 350] | Loss=5.49491 | acc=0.1561 | tpr=0.7451 | fpr=0.8546 | 8037.6 samples/s | 31.4 steps/s
[Step= 400] | Loss=5.49526 | acc=0.1556 | tpr=0.7407 | fpr=0.8550 | 8296.7 samples/s | 32.4 steps/s
[Step= 450] | Loss=5.49538 | acc=0.1558 | tpr=0.7405 | fpr=0.8548 | 8385.3 samples/s | 32.8 steps/s
[Step= 500] | Loss=5.49824 | acc=0.1561 | tpr=0.7405 | fpr=0.8544 | 7937.3 samples/s | 31.0 steps/s
[Step= 550] | Loss=5.49564 | acc=0.1562 | tpr=0.7425 | fpr=0.8544 | 9593.6 samples/s | 37.5 steps/s
Avg test loss: 5.49602, Avg test acc: 0.15611, Avg tpr: 0.74247, Avg fpr: 0.85455, total FA: 118653

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.97801 | acc=0.1351 | tpr=0.7699 | fpr=0.8763 | 4628.8 samples/s | 18.1 steps/s
[Step= 100] | Loss=5.95682 | acc=0.1366 | tpr=0.7612 | fpr=0.8751 | 7395.1 samples/s | 28.9 steps/s
[Step= 150] | Loss=5.95818 | acc=0.1379 | tpr=0.7565 | fpr=0.8735 | 8176.5 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.95163 | acc=0.1376 | tpr=0.7552 | fpr=0.8737 | 7783.7 samples/s | 30.4 steps/s
[Step= 250] | Loss=5.94872 | acc=0.1391 | tpr=0.7563 | fpr=0.8722 | 8540.6 samples/s | 33.4 steps/s
[Step= 300] | Loss=5.94490 | acc=0.1393 | tpr=0.7600 | fpr=0.8721 | 8043.9 samples/s | 31.4 steps/s
[Step= 350] | Loss=5.95204 | acc=0.1384 | tpr=0.7577 | fpr=0.8729 | 8107.1 samples/s | 31.7 steps/s
[Step= 400] | Loss=5.95390 | acc=0.1384 | tpr=0.7511 | fpr=0.8727 | 7918.6 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.95095 | acc=0.1383 | tpr=0.7454 | fpr=0.8727 | 7993.0 samples/s | 31.2 steps/s
[Step= 500] | Loss=5.95351 | acc=0.1386 | tpr=0.7383 | fpr=0.8723 | 7711.9 samples/s | 30.1 steps/s
[Step= 550] | Loss=5.95279 | acc=0.1387 | tpr=0.7421 | fpr=0.8722 | 10394.8 samples/s | 40.6 steps/s
Avg test loss: 5.95461, Avg test acc: 0.13863, Avg tpr: 0.74168, Avg fpr: 0.87234, total FA: 121122

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.85306 | acc=0.1357 | tpr=0.7920 | fpr=0.8761 | 4740.9 samples/s | 18.5 steps/s
[Step= 100] | Loss=5.82866 | acc=0.1381 | tpr=0.7527 | fpr=0.8733 | 7296.7 samples/s | 28.5 steps/s
[Step= 150] | Loss=5.83928 | acc=0.1396 | tpr=0.7622 | fpr=0.8719 | 7962.1 samples/s | 31.1 steps/s
[Step= 200] | Loss=5.82199 | acc=0.1404 | tpr=0.7628 | fpr=0.8709 | 7784.9 samples/s | 30.4 steps/s
[Step= 250] | Loss=5.81661 | acc=0.1410 | tpr=0.7555 | fpr=0.8702 | 8494.9 samples/s | 33.2 steps/s
[Step= 300] | Loss=5.80871 | acc=0.1411 | tpr=0.7593 | fpr=0.8702 | 7935.7 samples/s | 31.0 steps/s
[Step= 350] | Loss=5.82031 | acc=0.1403 | tpr=0.7564 | fpr=0.8709 | 7641.7 samples/s | 29.9 steps/s
[Step= 400] | Loss=5.82266 | acc=0.1402 | tpr=0.7571 | fpr=0.8710 | 8402.9 samples/s | 32.8 steps/s
[Step= 450] | Loss=5.81925 | acc=0.1406 | tpr=0.7551 | fpr=0.8705 | 8164.4 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.81900 | acc=0.1409 | tpr=0.7537 | fpr=0.8701 | 7835.7 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.81889 | acc=0.1409 | tpr=0.7537 | fpr=0.8702 | 10444.3 samples/s | 40.8 steps/s
Avg test loss: 5.81926, Avg test acc: 0.14081, Avg tpr: 0.75238, Avg fpr: 0.87030, total FA: 120840

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.24095 | acc=0.1588 | tpr=0.7699 | fpr=0.8522 | 4637.7 samples/s | 18.1 steps/s
[Step= 100] | Loss=6.21755 | acc=0.1618 | tpr=0.7846 | fpr=0.8498 | 8415.0 samples/s | 32.9 steps/s
[Step= 150] | Loss=6.22917 | acc=0.1632 | tpr=0.7810 | fpr=0.8481 | 7798.6 samples/s | 30.5 steps/s
[Step= 200] | Loss=6.21972 | acc=0.1631 | tpr=0.7738 | fpr=0.8480 | 7467.1 samples/s | 29.2 steps/s
[Step= 250] | Loss=6.21395 | acc=0.1639 | tpr=0.7686 | fpr=0.8471 | 8131.9 samples/s | 31.8 steps/s
[Step= 300] | Loss=6.20853 | acc=0.1642 | tpr=0.7680 | fpr=0.8468 | 8452.8 samples/s | 33.0 steps/s
[Step= 350] | Loss=6.21831 | acc=0.1637 | tpr=0.7727 | fpr=0.8474 | 7607.8 samples/s | 29.7 steps/s
[Step= 400] | Loss=6.21933 | acc=0.1633 | tpr=0.7675 | fpr=0.8477 | 7563.2 samples/s | 29.5 steps/s
[Step= 450] | Loss=6.21638 | acc=0.1632 | tpr=0.7644 | fpr=0.8477 | 8651.2 samples/s | 33.8 steps/s
[Step= 500] | Loss=6.21880 | acc=0.1633 | tpr=0.7634 | fpr=0.8475 | 8181.1 samples/s | 32.0 steps/s
[Step= 550] | Loss=6.21869 | acc=0.1635 | tpr=0.7644 | fpr=0.8474 | 9819.8 samples/s | 38.4 steps/s
Avg test loss: 6.21970, Avg test acc: 0.16335, Avg tpr: 0.76347, Avg fpr: 0.84756, total FA: 117682

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.50701 | acc=0.1374 | tpr=0.8230 | fpr=0.8749 | 4712.2 samples/s | 18.4 steps/s
[Step= 100] | Loss=5.48910 | acc=0.1397 | tpr=0.7974 | fpr=0.8725 | 7871.9 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.48975 | acc=0.1412 | tpr=0.7911 | fpr=0.8708 | 7880.9 samples/s | 30.8 steps/s
[Step= 200] | Loss=5.48477 | acc=0.1415 | tpr=0.7836 | fpr=0.8702 | 8031.2 samples/s | 31.4 steps/s
[Step= 250] | Loss=5.48191 | acc=0.1422 | tpr=0.7860 | fpr=0.8695 | 8165.2 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.47846 | acc=0.1428 | tpr=0.7876 | fpr=0.8690 | 8068.9 samples/s | 31.5 steps/s
[Step= 350] | Loss=5.48648 | acc=0.1423 | tpr=0.7896 | fpr=0.8694 | 7876.1 samples/s | 30.8 steps/s
[Step= 400] | Loss=5.48590 | acc=0.1421 | tpr=0.7872 | fpr=0.8696 | 7710.6 samples/s | 30.1 steps/s
[Step= 450] | Loss=5.48488 | acc=0.1422 | tpr=0.7833 | fpr=0.8695 | 8423.2 samples/s | 32.9 steps/s
[Step= 500] | Loss=5.48946 | acc=0.1419 | tpr=0.7811 | fpr=0.8696 | 7584.5 samples/s | 29.6 steps/s
[Step= 550] | Loss=5.49074 | acc=0.1420 | tpr=0.7799 | fpr=0.8696 | 10234.5 samples/s | 40.0 steps/s
Avg test loss: 5.49157, Avg test acc: 0.14186, Avg tpr: 0.77932, Avg fpr: 0.86973, total FA: 120760

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.17936 | acc=0.9595 | tpr=0.9336 | fpr=0.0400 | 4453.0 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.18267 | acc=0.9589 | tpr=0.9360 | fpr=0.0407 | 7976.3 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.18636 | acc=0.9580 | tpr=0.9438 | fpr=0.0418 | 8027.4 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.18681 | acc=0.9580 | tpr=0.9497 | fpr=0.0418 | 8323.6 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.18836 | acc=0.9578 | tpr=0.9520 | fpr=0.0421 | 7655.7 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.19015 | acc=0.9572 | tpr=0.9513 | fpr=0.0427 | 8014.4 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.19079 | acc=0.9570 | tpr=0.9493 | fpr=0.0428 | 8051.3 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.19190 | acc=0.9567 | tpr=0.9480 | fpr=0.0431 | 8281.7 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.19306 | acc=0.9564 | tpr=0.9450 | fpr=0.0434 | 7395.4 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.19261 | acc=0.9564 | tpr=0.9463 | fpr=0.0435 | 8472.0 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.19219 | acc=0.9565 | tpr=0.9439 | fpr=0.0433 | 10686.3 samples/s | 41.7 steps/s
Avg test loss: 0.19194, Avg test acc: 0.95651, Avg tpr: 0.94374, Avg fpr: 0.04326, total FA: 6006

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13611 | acc=0.9654 | tpr=0.9248 | fpr=0.0339 | 4596.5 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.13874 | acc=0.9656 | tpr=0.9318 | fpr=0.0338 | 8236.8 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.14020 | acc=0.9647 | tpr=0.9323 | fpr=0.0347 | 7918.8 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.13999 | acc=0.9649 | tpr=0.9399 | fpr=0.0346 | 7553.7 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.14187 | acc=0.9647 | tpr=0.9415 | fpr=0.0348 | 7797.6 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.14213 | acc=0.9646 | tpr=0.9440 | fpr=0.0350 | 7904.4 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.14179 | acc=0.9645 | tpr=0.9436 | fpr=0.0351 | 8068.3 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.14258 | acc=0.9642 | tpr=0.9420 | fpr=0.0354 | 7993.0 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.14278 | acc=0.9640 | tpr=0.9396 | fpr=0.0355 | 7559.5 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.14259 | acc=0.9641 | tpr=0.9410 | fpr=0.0355 | 8520.1 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.14237 | acc=0.9642 | tpr=0.9387 | fpr=0.0353 | 10898.5 samples/s | 42.6 steps/s
Avg test loss: 0.14209, Avg test acc: 0.96423, Avg tpr: 0.93899, Avg fpr: 0.03531, total FA: 4903

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.21230 | acc=0.9564 | tpr=0.9071 | fpr=0.0427 | 4594.3 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.21793 | acc=0.9568 | tpr=0.9126 | fpr=0.0424 | 7705.1 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.22347 | acc=0.9558 | tpr=0.9164 | fpr=0.0435 | 7783.1 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.22450 | acc=0.9560 | tpr=0.9213 | fpr=0.0434 | 8183.9 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.22645 | acc=0.9557 | tpr=0.9179 | fpr=0.0437 | 7614.6 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.22733 | acc=0.9552 | tpr=0.9171 | fpr=0.0441 | 8226.5 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.22712 | acc=0.9555 | tpr=0.9198 | fpr=0.0439 | 7635.6 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.22778 | acc=0.9552 | tpr=0.9179 | fpr=0.0441 | 8560.2 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.22882 | acc=0.9550 | tpr=0.9167 | fpr=0.0443 | 7880.9 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.22926 | acc=0.9551 | tpr=0.9207 | fpr=0.0443 | 8251.3 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.22807 | acc=0.9551 | tpr=0.9188 | fpr=0.0442 | 10512.2 samples/s | 41.1 steps/s
Avg test loss: 0.22751, Avg test acc: 0.95517, Avg tpr: 0.91878, Avg fpr: 0.04417, total FA: 6133

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15901 | acc=0.9655 | tpr=0.9115 | fpr=0.0335 | 4656.0 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.16597 | acc=0.9639 | tpr=0.9190 | fpr=0.0352 | 8393.7 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.17019 | acc=0.9631 | tpr=0.9236 | fpr=0.0362 | 7971.7 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.16949 | acc=0.9630 | tpr=0.9301 | fpr=0.0364 | 8216.5 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.17124 | acc=0.9628 | tpr=0.9310 | fpr=0.0366 | 7798.8 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.17333 | acc=0.9625 | tpr=0.9338 | fpr=0.0370 | 7311.7 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.17446 | acc=0.9622 | tpr=0.9330 | fpr=0.0373 | 8521.8 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.17566 | acc=0.9620 | tpr=0.9311 | fpr=0.0375 | 7471.6 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.17686 | acc=0.9617 | tpr=0.9294 | fpr=0.0377 | 8056.8 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.17645 | acc=0.9619 | tpr=0.9330 | fpr=0.0376 | 8038.1 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.17592 | acc=0.9621 | tpr=0.9327 | fpr=0.0373 | 10356.9 samples/s | 40.5 steps/s
Avg test loss: 0.17550, Avg test acc: 0.96216, Avg tpr: 0.93265, Avg fpr: 0.03730, total FA: 5179

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.19864 | acc=0.9580 | tpr=0.9027 | fpr=0.0410 | 4623.3 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.20448 | acc=0.9568 | tpr=0.9147 | fpr=0.0424 | 7846.1 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.20830 | acc=0.9558 | tpr=0.9179 | fpr=0.0435 | 7956.3 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.20937 | acc=0.9559 | tpr=0.9279 | fpr=0.0436 | 8194.1 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.21088 | acc=0.9559 | tpr=0.9293 | fpr=0.0437 | 8016.0 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.21222 | acc=0.9555 | tpr=0.9316 | fpr=0.0441 | 8562.9 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.21234 | acc=0.9553 | tpr=0.9324 | fpr=0.0442 | 7509.4 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.21349 | acc=0.9550 | tpr=0.9311 | fpr=0.0446 | 7620.3 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.21464 | acc=0.9547 | tpr=0.9279 | fpr=0.0448 | 8492.5 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.21500 | acc=0.9546 | tpr=0.9286 | fpr=0.0449 | 8237.4 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.21395 | acc=0.9548 | tpr=0.9276 | fpr=0.0448 | 9577.3 samples/s | 37.4 steps/s
Avg test loss: 0.21373, Avg test acc: 0.95478, Avg tpr: 0.92750, Avg fpr: 0.04473, total FA: 6210

server round 21/50

clients selected: [0 1 3 4 6]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=30001 Epoch=146.3] | Loss=0.01912 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.587 | L2-Norm(final)=13.202 | 3191.3 samples/s | 49.9 steps/s
[Step=30050 Epoch=146.5] | Loss=0.03130 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=13.204 | 4826.6 samples/s | 75.4 steps/s
[Step=30100 Epoch=146.8] | Loss=0.03287 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.587 | L2-Norm(final)=13.206 | 5478.1 samples/s | 85.6 steps/s
[Step=30150 Epoch=147.0] | Loss=0.03349 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.587 | L2-Norm(final)=13.207 | 5476.5 samples/s | 85.6 steps/s
[Step=30200 Epoch=147.3] | Loss=0.03243 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.587 | L2-Norm(final)=13.208 | 8593.2 samples/s | 134.3 steps/s
[Step=30250 Epoch=147.5] | Loss=0.03244 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.587 | L2-Norm(final)=13.211 | 1501.8 samples/s | 23.5 steps/s
[Step=30300 Epoch=147.7] | Loss=0.03174 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=13.215 | 5368.1 samples/s | 83.9 steps/s
[Step=30350 Epoch=148.0] | Loss=0.03170 | Reg=0.00134 | acc=0.9531 | L2-Norm=11.587 | L2-Norm(final)=13.219 | 5490.0 samples/s | 85.8 steps/s
[Step=30400 Epoch=148.2] | Loss=0.03151 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.587 | L2-Norm(final)=13.223 | 7474.2 samples/s | 116.8 steps/s
[Step=30450 Epoch=148.5] | Loss=0.03195 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=13.227 | 1539.1 samples/s | 24.0 steps/s
[Step=30500 Epoch=148.7] | Loss=0.03220 | Reg=0.00134 | acc=0.9531 | L2-Norm=11.587 | L2-Norm(final)=13.231 | 5522.5 samples/s | 86.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=30501 Epoch=148.7] | Loss=0.00390 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=13.267 | 3188.0 samples/s | 49.8 steps/s
[Step=30550 Epoch=149.0] | Loss=0.02924 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.616 | L2-Norm(final)=13.269 | 4218.2 samples/s | 65.9 steps/s
[Step=30600 Epoch=149.2] | Loss=0.02969 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.644 | L2-Norm(final)=13.265 | 4716.4 samples/s | 73.7 steps/s
[Step=30650 Epoch=149.5] | Loss=0.02686 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.665 | L2-Norm(final)=13.262 | 4709.1 samples/s | 73.6 steps/s
[Step=30700 Epoch=149.7] | Loss=0.02649 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=13.261 | 6599.1 samples/s | 103.1 steps/s
[Step=30750 Epoch=149.9] | Loss=0.02332 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.696 | L2-Norm(final)=13.260 | 1405.5 samples/s | 22.0 steps/s
[Step=30800 Epoch=150.2] | Loss=0.02083 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.708 | L2-Norm(final)=13.261 | 4702.3 samples/s | 73.5 steps/s
[Step=30850 Epoch=150.4] | Loss=0.01889 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.718 | L2-Norm(final)=13.263 | 4696.9 samples/s | 73.4 steps/s
[Step=30900 Epoch=150.7] | Loss=0.01787 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.727 | L2-Norm(final)=13.266 | 6131.7 samples/s | 95.8 steps/s
[Step=30950 Epoch=150.9] | Loss=0.01705 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.736 | L2-Norm(final)=13.268 | 1428.4 samples/s | 22.3 steps/s
[Step=31000 Epoch=151.2] | Loss=0.01611 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.745 | L2-Norm(final)=13.271 | 4667.7 samples/s | 72.9 steps/s
[Step=31050 Epoch=151.4] | Loss=0.01548 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.753 | L2-Norm(final)=13.273 | 4733.6 samples/s | 74.0 steps/s
[Step=31100 Epoch=151.6] | Loss=0.01489 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.761 | L2-Norm(final)=13.275 | 5633.1 samples/s | 88.0 steps/s
[Step=31150 Epoch=151.9] | Loss=0.01411 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.768 | L2-Norm(final)=13.277 | 1485.0 samples/s | 23.2 steps/s
[Step=31200 Epoch=152.1] | Loss=0.01350 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.774 | L2-Norm(final)=13.280 | 4696.7 samples/s | 73.4 steps/s
[Step=31250 Epoch=152.4] | Loss=0.01310 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.779 | L2-Norm(final)=13.282 | 4715.7 samples/s | 73.7 steps/s
[Step=31300 Epoch=152.6] | Loss=0.01268 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.784 | L2-Norm(final)=13.284 | 5183.3 samples/s | 81.0 steps/s
[Step=31350 Epoch=152.9] | Loss=0.01226 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.790 | L2-Norm(final)=13.285 | 1543.3 samples/s | 24.1 steps/s
[Step=31400 Epoch=153.1] | Loss=0.01181 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.794 | L2-Norm(final)=13.288 | 4699.0 samples/s | 73.4 steps/s
[Step=31450 Epoch=153.4] | Loss=0.01148 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.799 | L2-Norm(final)=13.289 | 4700.6 samples/s | 73.4 steps/s
[Step=31500 Epoch=153.6] | Loss=0.01112 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.803 | L2-Norm(final)=13.291 | 4820.4 samples/s | 75.3 steps/s
[Step=31550 Epoch=153.8] | Loss=0.01088 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.807 | L2-Norm(final)=13.293 | 1553.6 samples/s | 24.3 steps/s
[Step=31600 Epoch=154.1] | Loss=0.01053 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.811 | L2-Norm(final)=13.295 | 4681.2 samples/s | 73.1 steps/s
[Step=31650 Epoch=154.3] | Loss=0.01029 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.815 | L2-Norm(final)=13.297 | 4744.8 samples/s | 74.1 steps/s
[Step=31700 Epoch=154.6] | Loss=0.01008 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.818 | L2-Norm(final)=13.299 | 4621.5 samples/s | 72.2 steps/s
[Step=31750 Epoch=154.8] | Loss=0.00986 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.821 | L2-Norm(final)=13.301 | 1583.9 samples/s | 24.7 steps/s
[Step=31800 Epoch=155.1] | Loss=0.00960 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=13.302 | 4696.5 samples/s | 73.4 steps/s
[Step=31850 Epoch=155.3] | Loss=0.00934 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.827 | L2-Norm(final)=13.304 | 4785.6 samples/s | 74.8 steps/s
[Step=31900 Epoch=155.6] | Loss=0.00915 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.830 | L2-Norm(final)=13.306 | 4608.7 samples/s | 72.0 steps/s
[Step=31950 Epoch=155.8] | Loss=0.00901 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.833 | L2-Norm(final)=13.308 | 1546.6 samples/s | 24.2 steps/s
[Step=32000 Epoch=156.0] | Loss=0.00883 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.836 | L2-Norm(final)=13.310 | 4748.9 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step32000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=18001 Epoch=87.8] | Loss=0.04321 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.587 | L2-Norm(final)=11.812 | 3226.2 samples/s | 50.4 steps/s
[Step=18050 Epoch=88.1] | Loss=0.03725 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=11.804 | 4904.1 samples/s | 76.6 steps/s
[Step=18100 Epoch=88.3] | Loss=0.03841 | Reg=0.00134 | acc=0.9531 | L2-Norm=11.587 | L2-Norm(final)=11.792 | 5373.1 samples/s | 84.0 steps/s
[Step=18150 Epoch=88.6] | Loss=0.03678 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.587 | L2-Norm(final)=11.783 | 5473.1 samples/s | 85.5 steps/s
[Step=18200 Epoch=88.8] | Loss=0.03630 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=11.777 | 8471.6 samples/s | 132.4 steps/s
[Step=18250 Epoch=89.1] | Loss=0.03626 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.587 | L2-Norm(final)=11.772 | 1499.8 samples/s | 23.4 steps/s
[Step=18300 Epoch=89.3] | Loss=0.03609 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.587 | L2-Norm(final)=11.769 | 5464.2 samples/s | 85.4 steps/s
[Step=18350 Epoch=89.5] | Loss=0.03597 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=11.765 | 5484.9 samples/s | 85.7 steps/s
[Step=18400 Epoch=89.8] | Loss=0.03583 | Reg=0.00134 | acc=0.9375 | L2-Norm=11.587 | L2-Norm(final)=11.761 | 7784.8 samples/s | 121.6 steps/s
[Step=18450 Epoch=90.0] | Loss=0.03625 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.587 | L2-Norm(final)=11.757 | 1507.9 samples/s | 23.6 steps/s
[Step=18500 Epoch=90.3] | Loss=0.03633 | Reg=0.00134 | acc=0.9531 | L2-Norm=11.587 | L2-Norm(final)=11.752 | 5400.0 samples/s | 84.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=90.3] | Loss=0.03183 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.587 | L2-Norm(final)=11.709 | 3192.6 samples/s | 49.9 steps/s
[Step=18550 Epoch=90.5] | Loss=0.03237 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.620 | L2-Norm(final)=11.707 | 4236.9 samples/s | 66.2 steps/s
[Step=18600 Epoch=90.8] | Loss=0.03495 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.656 | L2-Norm(final)=11.703 | 4691.5 samples/s | 73.3 steps/s
[Step=18650 Epoch=91.0] | Loss=0.03111 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=11.701 | 4797.1 samples/s | 75.0 steps/s
[Step=18700 Epoch=91.2] | Loss=0.02905 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.701 | L2-Norm(final)=11.701 | 6596.0 samples/s | 103.1 steps/s
[Step=18750 Epoch=91.5] | Loss=0.02585 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.720 | L2-Norm(final)=11.703 | 1418.3 samples/s | 22.2 steps/s
[Step=18800 Epoch=91.7] | Loss=0.02317 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.736 | L2-Norm(final)=11.706 | 4640.3 samples/s | 72.5 steps/s
[Step=18850 Epoch=92.0] | Loss=0.02142 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.749 | L2-Norm(final)=11.710 | 4676.7 samples/s | 73.1 steps/s
[Step=18900 Epoch=92.2] | Loss=0.01981 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.761 | L2-Norm(final)=11.714 | 6228.9 samples/s | 97.3 steps/s
[Step=18950 Epoch=92.5] | Loss=0.01818 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.772 | L2-Norm(final)=11.719 | 1454.1 samples/s | 22.7 steps/s
[Step=19000 Epoch=92.7] | Loss=0.01692 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.781 | L2-Norm(final)=11.724 | 4807.6 samples/s | 75.1 steps/s
[Step=19050 Epoch=93.0] | Loss=0.01599 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.790 | L2-Norm(final)=11.729 | 4590.3 samples/s | 71.7 steps/s
[Step=19100 Epoch=93.2] | Loss=0.01523 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.798 | L2-Norm(final)=11.733 | 5817.5 samples/s | 90.9 steps/s
[Step=19150 Epoch=93.4] | Loss=0.01454 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.805 | L2-Norm(final)=11.737 | 1443.0 samples/s | 22.5 steps/s
[Step=19200 Epoch=93.7] | Loss=0.01389 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.811 | L2-Norm(final)=11.740 | 4671.6 samples/s | 73.0 steps/s
[Step=19250 Epoch=93.9] | Loss=0.01326 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.817 | L2-Norm(final)=11.744 | 4706.5 samples/s | 73.5 steps/s
[Step=19300 Epoch=94.2] | Loss=0.01275 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.823 | L2-Norm(final)=11.748 | 5422.2 samples/s | 84.7 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01221 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.828 | L2-Norm(final)=11.752 | 1503.3 samples/s | 23.5 steps/s
[Step=19400 Epoch=94.7] | Loss=0.01180 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.834 | L2-Norm(final)=11.755 | 4645.7 samples/s | 72.6 steps/s
[Step=19450 Epoch=94.9] | Loss=0.01144 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.839 | L2-Norm(final)=11.759 | 4691.4 samples/s | 73.3 steps/s
[Step=19500 Epoch=95.2] | Loss=0.01123 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.843 | L2-Norm(final)=11.762 | 5083.1 samples/s | 79.4 steps/s
[Step=19550 Epoch=95.4] | Loss=0.01081 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.848 | L2-Norm(final)=11.765 | 1501.1 samples/s | 23.5 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01047 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.852 | L2-Norm(final)=11.768 | 4706.2 samples/s | 73.5 steps/s
[Step=19650 Epoch=95.9] | Loss=0.01017 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.856 | L2-Norm(final)=11.771 | 4681.6 samples/s | 73.2 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00993 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.860 | L2-Norm(final)=11.775 | 4759.9 samples/s | 74.4 steps/s
[Step=19750 Epoch=96.4] | Loss=0.00968 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.864 | L2-Norm(final)=11.778 | 1525.2 samples/s | 23.8 steps/s
[Step=19800 Epoch=96.6] | Loss=0.00946 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.867 | L2-Norm(final)=11.781 | 4747.9 samples/s | 74.2 steps/s
[Step=19850 Epoch=96.9] | Loss=0.00926 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.871 | L2-Norm(final)=11.784 | 4673.9 samples/s | 73.0 steps/s
[Step=19900 Epoch=97.1] | Loss=0.00902 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.874 | L2-Norm(final)=11.787 | 4661.5 samples/s | 72.8 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00886 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.877 | L2-Norm(final)=11.790 | 1555.6 samples/s | 24.3 steps/s
[Step=20000 Epoch=97.6] | Loss=0.00865 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.880 | L2-Norm(final)=11.793 | 4651.8 samples/s | 72.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_1/client_state-step20000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=126.8] | Loss=0.00946 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=14.406 | 3215.1 samples/s | 50.2 steps/s
[Step=26050 Epoch=127.0] | Loss=0.02893 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.588 | L2-Norm(final)=14.407 | 4838.4 samples/s | 75.6 steps/s
[Step=26100 Epoch=127.3] | Loss=0.02882 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.588 | L2-Norm(final)=14.407 | 5418.0 samples/s | 84.7 steps/s
[Step=26150 Epoch=127.5] | Loss=0.02848 | Reg=0.00134 | acc=0.9531 | L2-Norm=11.588 | L2-Norm(final)=14.406 | 5489.4 samples/s | 85.8 steps/s
[Step=26200 Epoch=127.8] | Loss=0.02960 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.588 | L2-Norm(final)=14.403 | 8622.0 samples/s | 134.7 steps/s
[Step=26250 Epoch=128.0] | Loss=0.02882 | Reg=0.00134 | acc=0.9531 | L2-Norm=11.588 | L2-Norm(final)=14.400 | 1492.4 samples/s | 23.3 steps/s
[Step=26300 Epoch=128.3] | Loss=0.02871 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.588 | L2-Norm(final)=14.399 | 5462.2 samples/s | 85.3 steps/s
[Step=26350 Epoch=128.5] | Loss=0.02918 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.588 | L2-Norm(final)=14.397 | 5586.0 samples/s | 87.3 steps/s
[Step=26400 Epoch=128.7] | Loss=0.02882 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.588 | L2-Norm(final)=14.395 | 7368.1 samples/s | 115.1 steps/s
[Step=26450 Epoch=129.0] | Loss=0.02854 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.588 | L2-Norm(final)=14.395 | 1503.2 samples/s | 23.5 steps/s
[Step=26500 Epoch=129.2] | Loss=0.02889 | Reg=0.00134 | acc=0.9531 | L2-Norm=11.588 | L2-Norm(final)=14.394 | 5621.7 samples/s | 87.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=129.2] | Loss=0.01302 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.588 | L2-Norm(final)=14.390 | 3060.2 samples/s | 47.8 steps/s
[Step=26550 Epoch=129.5] | Loss=0.03331 | Reg=0.00135 | acc=0.9375 | L2-Norm=11.625 | L2-Norm(final)=14.389 | 4480.7 samples/s | 70.0 steps/s
[Step=26600 Epoch=129.7] | Loss=0.03017 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.661 | L2-Norm(final)=14.380 | 4731.3 samples/s | 73.9 steps/s
[Step=26650 Epoch=130.0] | Loss=0.02978 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.688 | L2-Norm(final)=14.376 | 4682.0 samples/s | 73.2 steps/s
[Step=26700 Epoch=130.2] | Loss=0.02738 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.712 | L2-Norm(final)=14.376 | 6854.6 samples/s | 107.1 steps/s
[Step=26750 Epoch=130.4] | Loss=0.02349 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.731 | L2-Norm(final)=14.377 | 1397.8 samples/s | 21.8 steps/s
[Step=26800 Epoch=130.7] | Loss=0.02088 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.746 | L2-Norm(final)=14.380 | 4681.0 samples/s | 73.1 steps/s
[Step=26850 Epoch=130.9] | Loss=0.01938 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.757 | L2-Norm(final)=14.382 | 4773.3 samples/s | 74.6 steps/s
[Step=26900 Epoch=131.2] | Loss=0.01807 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.768 | L2-Norm(final)=14.385 | 6047.0 samples/s | 94.5 steps/s
[Step=26950 Epoch=131.4] | Loss=0.01676 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.777 | L2-Norm(final)=14.388 | 1442.0 samples/s | 22.5 steps/s
[Step=27000 Epoch=131.7] | Loss=0.01556 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=14.391 | 4693.2 samples/s | 73.3 steps/s
[Step=27050 Epoch=131.9] | Loss=0.01457 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.793 | L2-Norm(final)=14.394 | 4671.2 samples/s | 73.0 steps/s
[Step=27100 Epoch=132.2] | Loss=0.01390 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.799 | L2-Norm(final)=14.397 | 5640.8 samples/s | 88.1 steps/s
[Step=27150 Epoch=132.4] | Loss=0.01333 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.805 | L2-Norm(final)=14.399 | 1476.3 samples/s | 23.1 steps/s
[Step=27200 Epoch=132.6] | Loss=0.01276 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=14.402 | 4625.8 samples/s | 72.3 steps/s
[Step=27250 Epoch=132.9] | Loss=0.01220 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.815 | L2-Norm(final)=14.404 | 4696.1 samples/s | 73.4 steps/s
[Step=27300 Epoch=133.1] | Loss=0.01174 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.820 | L2-Norm(final)=14.407 | 5189.4 samples/s | 81.1 steps/s
[Step=27350 Epoch=133.4] | Loss=0.01133 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.825 | L2-Norm(final)=14.409 | 1499.6 samples/s | 23.4 steps/s
[Step=27400 Epoch=133.6] | Loss=0.01096 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.829 | L2-Norm(final)=14.411 | 4710.1 samples/s | 73.6 steps/s
[Step=27450 Epoch=133.9] | Loss=0.01050 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.833 | L2-Norm(final)=14.414 | 4687.6 samples/s | 73.2 steps/s
[Step=27500 Epoch=134.1] | Loss=0.01022 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=14.416 | 4842.5 samples/s | 75.7 steps/s
[Step=27550 Epoch=134.3] | Loss=0.00999 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.841 | L2-Norm(final)=14.418 | 1531.8 samples/s | 23.9 steps/s
[Step=27600 Epoch=134.6] | Loss=0.00964 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.844 | L2-Norm(final)=14.420 | 4683.2 samples/s | 73.2 steps/s
[Step=27650 Epoch=134.8] | Loss=0.00936 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.847 | L2-Norm(final)=14.422 | 4693.2 samples/s | 73.3 steps/s
[Step=27700 Epoch=135.1] | Loss=0.00917 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.850 | L2-Norm(final)=14.424 | 4710.4 samples/s | 73.6 steps/s
[Step=27750 Epoch=135.3] | Loss=0.00892 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.853 | L2-Norm(final)=14.426 | 1536.7 samples/s | 24.0 steps/s
[Step=27800 Epoch=135.6] | Loss=0.00869 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.855 | L2-Norm(final)=14.428 | 4694.2 samples/s | 73.3 steps/s
[Step=27850 Epoch=135.8] | Loss=0.00845 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.858 | L2-Norm(final)=14.431 | 4682.8 samples/s | 73.2 steps/s
[Step=27900 Epoch=136.1] | Loss=0.00828 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.860 | L2-Norm(final)=14.433 | 4709.6 samples/s | 73.6 steps/s
[Step=27950 Epoch=136.3] | Loss=0.00808 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.863 | L2-Norm(final)=14.435 | 1536.2 samples/s | 24.0 steps/s
[Step=28000 Epoch=136.5] | Loss=0.00797 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.865 | L2-Norm(final)=14.437 | 4784.9 samples/s | 74.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step28000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=12001 Epoch=58.9] | Loss=0.02937 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.587 | L2-Norm(final)=10.568 | 3114.7 samples/s | 48.7 steps/s
[Step=12050 Epoch=59.1] | Loss=0.02997 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.587 | L2-Norm(final)=10.574 | 4706.2 samples/s | 73.5 steps/s
[Step=12100 Epoch=59.3] | Loss=0.03298 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=10.586 | 5508.3 samples/s | 86.1 steps/s
[Step=12150 Epoch=59.6] | Loss=0.03126 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.587 | L2-Norm(final)=10.598 | 5642.6 samples/s | 88.2 steps/s
[Step=12200 Epoch=59.8] | Loss=0.03148 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.587 | L2-Norm(final)=10.611 | 8279.1 samples/s | 129.4 steps/s
[Step=12250 Epoch=60.1] | Loss=0.03081 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.587 | L2-Norm(final)=10.624 | 1462.1 samples/s | 22.8 steps/s
[Step=12300 Epoch=60.3] | Loss=0.03086 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.587 | L2-Norm(final)=10.637 | 5444.8 samples/s | 85.1 steps/s
[Step=12350 Epoch=60.6] | Loss=0.03067 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.587 | L2-Norm(final)=10.650 | 5518.8 samples/s | 86.2 steps/s
[Step=12400 Epoch=60.8] | Loss=0.03118 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=10.662 | 7910.8 samples/s | 123.6 steps/s
[Step=12450 Epoch=61.1] | Loss=0.03139 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.587 | L2-Norm(final)=10.674 | 1535.7 samples/s | 24.0 steps/s
[Step=12500 Epoch=61.3] | Loss=0.03103 | Reg=0.00134 | acc=0.9531 | L2-Norm=11.587 | L2-Norm(final)=10.686 | 5555.8 samples/s | 86.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=12501 Epoch=61.3] | Loss=0.01652 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=10.809 | 3190.9 samples/s | 49.9 steps/s
[Step=12550 Epoch=61.5] | Loss=0.03456 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.617 | L2-Norm(final)=10.815 | 4213.8 samples/s | 65.8 steps/s
[Step=12600 Epoch=61.8] | Loss=0.03123 | Reg=0.00136 | acc=0.9531 | L2-Norm=11.649 | L2-Norm(final)=10.815 | 4699.4 samples/s | 73.4 steps/s
[Step=12650 Epoch=62.0] | Loss=0.02900 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.673 | L2-Norm(final)=10.817 | 4754.6 samples/s | 74.3 steps/s
[Step=12700 Epoch=62.3] | Loss=0.02655 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.692 | L2-Norm(final)=10.819 | 6750.6 samples/s | 105.5 steps/s
[Step=12750 Epoch=62.5] | Loss=0.02367 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.708 | L2-Norm(final)=10.823 | 1418.7 samples/s | 22.2 steps/s
[Step=12800 Epoch=62.8] | Loss=0.02143 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.722 | L2-Norm(final)=10.828 | 4715.1 samples/s | 73.7 steps/s
[Step=12850 Epoch=63.0] | Loss=0.01961 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.734 | L2-Norm(final)=10.833 | 4748.1 samples/s | 74.2 steps/s
[Step=12900 Epoch=63.3] | Loss=0.01818 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.746 | L2-Norm(final)=10.839 | 6378.7 samples/s | 99.7 steps/s
[Step=12950 Epoch=63.5] | Loss=0.01694 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.756 | L2-Norm(final)=10.844 | 1410.9 samples/s | 22.0 steps/s
[Step=13000 Epoch=63.7] | Loss=0.01596 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.765 | L2-Norm(final)=10.849 | 4729.6 samples/s | 73.9 steps/s
[Step=13050 Epoch=64.0] | Loss=0.01520 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.773 | L2-Norm(final)=10.853 | 4602.4 samples/s | 71.9 steps/s
[Step=13100 Epoch=64.2] | Loss=0.01429 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.781 | L2-Norm(final)=10.858 | 5913.6 samples/s | 92.4 steps/s
[Step=13150 Epoch=64.5] | Loss=0.01367 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.788 | L2-Norm(final)=10.863 | 1409.4 samples/s | 22.0 steps/s
[Step=13200 Epoch=64.7] | Loss=0.01307 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.794 | L2-Norm(final)=10.867 | 4628.6 samples/s | 72.3 steps/s
[Step=13250 Epoch=65.0] | Loss=0.01254 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.801 | L2-Norm(final)=10.872 | 4641.9 samples/s | 72.5 steps/s
[Step=13300 Epoch=65.2] | Loss=0.01212 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.807 | L2-Norm(final)=10.876 | 5569.3 samples/s | 87.0 steps/s
[Step=13350 Epoch=65.5] | Loss=0.01162 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.812 | L2-Norm(final)=10.880 | 1440.7 samples/s | 22.5 steps/s
[Step=13400 Epoch=65.7] | Loss=0.01123 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.817 | L2-Norm(final)=10.884 | 4620.5 samples/s | 72.2 steps/s
[Step=13450 Epoch=66.0] | Loss=0.01093 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.822 | L2-Norm(final)=10.888 | 4592.5 samples/s | 71.8 steps/s
[Step=13500 Epoch=66.2] | Loss=0.01061 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.828 | L2-Norm(final)=10.892 | 5373.7 samples/s | 84.0 steps/s
[Step=13550 Epoch=66.4] | Loss=0.01027 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.832 | L2-Norm(final)=10.896 | 1524.8 samples/s | 23.8 steps/s
[Step=13600 Epoch=66.7] | Loss=0.00997 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=10.900 | 4533.7 samples/s | 70.8 steps/s
[Step=13650 Epoch=66.9] | Loss=0.00984 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.842 | L2-Norm(final)=10.903 | 4669.7 samples/s | 73.0 steps/s
[Step=13700 Epoch=67.2] | Loss=0.00964 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.846 | L2-Norm(final)=10.907 | 5064.2 samples/s | 79.1 steps/s
[Step=13750 Epoch=67.4] | Loss=0.00941 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.851 | L2-Norm(final)=10.910 | 1463.3 samples/s | 22.9 steps/s
[Step=13800 Epoch=67.7] | Loss=0.00922 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.855 | L2-Norm(final)=10.914 | 4570.2 samples/s | 71.4 steps/s
[Step=13850 Epoch=67.9] | Loss=0.00900 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.859 | L2-Norm(final)=10.917 | 4725.3 samples/s | 73.8 steps/s
[Step=13900 Epoch=68.2] | Loss=0.00884 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.863 | L2-Norm(final)=10.920 | 4756.5 samples/s | 74.3 steps/s
[Step=13950 Epoch=68.4] | Loss=0.00863 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.868 | L2-Norm(final)=10.924 | 1510.8 samples/s | 23.6 steps/s
[Step=14000 Epoch=68.7] | Loss=0.00847 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.871 | L2-Norm(final)=10.927 | 4647.4 samples/s | 72.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_4/client_state-step14000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=209.3] | Loss=0.00025 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=12.831 | 3189.3 samples/s | 49.8 steps/s
[Step=22050 Epoch=209.8] | Loss=0.00256 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.583 | L2-Norm(final)=12.846 | 4349.6 samples/s | 68.0 steps/s
[Step=22100 Epoch=210.2] | Loss=0.00248 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.583 | L2-Norm(final)=12.866 | 8046.7 samples/s | 125.7 steps/s
[Step=22150 Epoch=210.7] | Loss=0.00235 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=12.882 | 1415.7 samples/s | 22.1 steps/s
[Step=22200 Epoch=211.2] | Loss=0.00229 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.582 | L2-Norm(final)=12.900 | 7024.6 samples/s | 109.8 steps/s
[Step=22250 Epoch=211.7] | Loss=0.00234 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=12.915 | 1449.3 samples/s | 22.6 steps/s
[Step=22300 Epoch=212.1] | Loss=0.00232 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.582 | L2-Norm(final)=12.930 | 6319.7 samples/s | 98.7 steps/s
[Step=22350 Epoch=212.6] | Loss=0.00242 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=12.943 | 1492.2 samples/s | 23.3 steps/s
[Step=22400 Epoch=213.1] | Loss=0.00233 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=12.955 | 5694.1 samples/s | 89.0 steps/s
[Step=22450 Epoch=213.6] | Loss=0.00230 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=12.968 | 1518.7 samples/s | 23.7 steps/s
[Step=22500 Epoch=214.0] | Loss=0.00235 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=12.980 | 5085.8 samples/s | 79.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=214.0] | Loss=0.00053 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=13.101 | 3203.3 samples/s | 50.1 steps/s
[Step=22550 Epoch=214.5] | Loss=0.00404 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.628 | L2-Norm(final)=13.112 | 3909.6 samples/s | 61.1 steps/s
[Step=22600 Epoch=215.0] | Loss=0.00255 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=13.113 | 6404.4 samples/s | 100.1 steps/s
[Step=22650 Epoch=215.5] | Loss=0.00172 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=13.116 | 1350.8 samples/s | 21.1 steps/s
[Step=22700 Epoch=215.9] | Loss=0.00130 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.712 | L2-Norm(final)=13.119 | 5836.5 samples/s | 91.2 steps/s
[Step=22750 Epoch=216.4] | Loss=0.00104 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.712 | L2-Norm(final)=13.120 | 1392.3 samples/s | 21.8 steps/s
[Step=22800 Epoch=216.9] | Loss=0.00087 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.708 | L2-Norm(final)=13.122 | 5284.5 samples/s | 82.6 steps/s
[Step=22850 Epoch=217.4] | Loss=0.00074 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.703 | L2-Norm(final)=13.123 | 1395.3 samples/s | 21.8 steps/s
[Step=22900 Epoch=217.8] | Loss=0.00065 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.696 | L2-Norm(final)=13.124 | 4910.0 samples/s | 76.7 steps/s
[Step=22950 Epoch=218.3] | Loss=0.00058 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.688 | L2-Norm(final)=13.124 | 1453.1 samples/s | 22.7 steps/s
[Step=23000 Epoch=218.8] | Loss=0.00052 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.681 | L2-Norm(final)=13.125 | 4477.2 samples/s | 70.0 steps/s
[Step=23050 Epoch=219.3] | Loss=0.00048 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.672 | L2-Norm(final)=13.126 | 1465.6 samples/s | 22.9 steps/s
[Step=23100 Epoch=219.7] | Loss=0.00044 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.664 | L2-Norm(final)=13.126 | 4458.5 samples/s | 69.7 steps/s
[Step=23150 Epoch=220.2] | Loss=0.00040 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=13.127 | 1480.6 samples/s | 23.1 steps/s
[Step=23200 Epoch=220.7] | Loss=0.00038 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.646 | L2-Norm(final)=13.128 | 4467.7 samples/s | 69.8 steps/s
[Step=23250 Epoch=221.2] | Loss=0.00035 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.637 | L2-Norm(final)=13.128 | 1503.9 samples/s | 23.5 steps/s
[Step=23300 Epoch=221.6] | Loss=0.00033 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.628 | L2-Norm(final)=13.129 | 4557.2 samples/s | 71.2 steps/s
[Step=23350 Epoch=222.1] | Loss=0.00031 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.619 | L2-Norm(final)=13.129 | 1519.5 samples/s | 23.7 steps/s
[Step=23400 Epoch=222.6] | Loss=0.00029 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.610 | L2-Norm(final)=13.130 | 4213.2 samples/s | 65.8 steps/s
[Step=23450 Epoch=223.1] | Loss=0.00028 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=13.131 | 6634.9 samples/s | 103.7 steps/s
[Step=23500 Epoch=223.5] | Loss=0.00026 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.592 | L2-Norm(final)=13.131 | 1342.5 samples/s | 21.0 steps/s
[Step=23550 Epoch=224.0] | Loss=0.00025 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=13.132 | 5995.7 samples/s | 93.7 steps/s
[Step=23600 Epoch=224.5] | Loss=0.00024 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.573 | L2-Norm(final)=13.133 | 1369.0 samples/s | 21.4 steps/s
[Step=23650 Epoch=225.0] | Loss=0.00023 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.563 | L2-Norm(final)=13.133 | 5450.6 samples/s | 85.2 steps/s
[Step=23700 Epoch=225.4] | Loss=0.00022 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.554 | L2-Norm(final)=13.134 | 1386.4 samples/s | 21.7 steps/s
[Step=23750 Epoch=225.9] | Loss=0.00021 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.544 | L2-Norm(final)=13.135 | 5024.0 samples/s | 78.5 steps/s
[Step=23800 Epoch=226.4] | Loss=0.00020 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.535 | L2-Norm(final)=13.136 | 1479.8 samples/s | 23.1 steps/s
[Step=23850 Epoch=226.9] | Loss=0.00020 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.525 | L2-Norm(final)=13.136 | 4671.3 samples/s | 73.0 steps/s
[Step=23900 Epoch=227.3] | Loss=0.00019 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.516 | L2-Norm(final)=13.137 | 1533.0 samples/s | 24.0 steps/s
[Step=23950 Epoch=227.8] | Loss=0.00018 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.506 | L2-Norm(final)=13.138 | 4355.2 samples/s | 68.1 steps/s
[Step=24000 Epoch=228.3] | Loss=0.00018 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.496 | L2-Norm(final)=13.139 | 1500.5 samples/s | 23.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09537 | acc=0.9600 | tpr=0.9723 | fpr=0.0667 | 4749.8 samples/s | 18.6 steps/s
Avg test loss: 0.10085, Avg test acc: 0.95849, Avg tpr: 0.97138, Avg fpr: 0.06986, total FA: 545

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09631 | acc=0.9600 | tpr=0.9715 | fpr=0.0649 | 4686.3 samples/s | 18.3 steps/s
Avg test loss: 0.09858, Avg test acc: 0.95845, Avg tpr: 0.97010, Avg fpr: 0.06717, total FA: 524

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11102 | acc=0.9488 | tpr=0.9604 | fpr=0.0763 | 4675.3 samples/s | 18.3 steps/s
Avg test loss: 0.11593, Avg test acc: 0.94883, Avg tpr: 0.95978, Avg fpr: 0.07525, total FA: 587

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10318 | acc=0.9600 | tpr=0.9730 | fpr=0.0681 | 4729.6 samples/s | 18.5 steps/s
Avg test loss: 0.10679, Avg test acc: 0.95893, Avg tpr: 0.97162, Avg fpr: 0.06897, total FA: 538

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08866 | acc=0.9602 | tpr=0.9658 | fpr=0.0518 | 4471.8 samples/s | 17.5 steps/s
Avg test loss: 0.09597, Avg test acc: 0.95821, Avg tpr: 0.96427, Avg fpr: 0.05512, total FA: 430

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.30596 | acc=0.3065 | tpr=0.0135 | fpr=0.0572 | 4503.2 samples/s | 17.6 steps/s
Avg test loss: 5.32805, Avg test acc: 0.30247, Avg tpr: 0.01177, Avg fpr: 0.05820, total FA: 454

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.61287 | acc=0.3028 | tpr=0.0103 | fpr=0.0619 | 4685.3 samples/s | 18.3 steps/s
Avg test loss: 4.63118, Avg test acc: 0.30038, Avg tpr: 0.00973, Avg fpr: 0.06038, total FA: 471

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.73506 | acc=0.3112 | tpr=0.0033 | fpr=0.0203 | 4632.0 samples/s | 18.1 steps/s
Avg test loss: 4.75639, Avg test acc: 0.30820, Avg tpr: 0.00332, Avg fpr: 0.02128, total FA: 166

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.64201 | acc=0.2994 | tpr=0.0260 | fpr=0.1070 | 4753.8 samples/s | 18.6 steps/s
Avg test loss: 4.66010, Avg test acc: 0.29562, Avg tpr: 0.02489, Avg fpr: 0.10896, total FA: 850

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.97781 | acc=0.3081 | tpr=0.0032 | fpr=0.0297 | 4576.4 samples/s | 17.9 steps/s
Avg test loss: 5.00531, Avg test acc: 0.30503, Avg tpr: 0.00326, Avg fpr: 0.03128, total FA: 244

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.87206 | acc=0.1371 | tpr=0.7699 | fpr=0.8743 | 4646.7 samples/s | 18.2 steps/s
[Step= 100] | Loss=5.84446 | acc=0.1394 | tpr=0.7505 | fpr=0.8720 | 6172.3 samples/s | 24.1 steps/s
[Step= 150] | Loss=5.85030 | acc=0.1405 | tpr=0.7565 | fpr=0.8709 | 8011.4 samples/s | 31.3 steps/s
[Step= 200] | Loss=5.84086 | acc=0.1405 | tpr=0.7541 | fpr=0.8706 | 8319.0 samples/s | 32.5 steps/s
[Step= 250] | Loss=5.83789 | acc=0.1411 | tpr=0.7467 | fpr=0.8699 | 8193.9 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.83372 | acc=0.1413 | tpr=0.7447 | fpr=0.8697 | 6978.2 samples/s | 27.3 steps/s
[Step= 350] | Loss=5.84206 | acc=0.1410 | tpr=0.7508 | fpr=0.8700 | 8029.5 samples/s | 31.4 steps/s
[Step= 400] | Loss=5.84048 | acc=0.1410 | tpr=0.7451 | fpr=0.8700 | 7961.5 samples/s | 31.1 steps/s
[Step= 450] | Loss=5.83725 | acc=0.1407 | tpr=0.7425 | fpr=0.8702 | 7574.1 samples/s | 29.6 steps/s
[Step= 500] | Loss=5.83841 | acc=0.1411 | tpr=0.7396 | fpr=0.8697 | 8148.3 samples/s | 31.8 steps/s
[Step= 550] | Loss=5.83644 | acc=0.1415 | tpr=0.7449 | fpr=0.8695 | 10145.5 samples/s | 39.6 steps/s
Avg test loss: 5.83721, Avg test acc: 0.14137, Avg tpr: 0.74445, Avg fpr: 0.86959, total FA: 120741

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.94081 | acc=0.1412 | tpr=0.7788 | fpr=0.8703 | 4741.0 samples/s | 18.5 steps/s
[Step= 100] | Loss=5.91486 | acc=0.1434 | tpr=0.7783 | fpr=0.8684 | 6273.5 samples/s | 24.5 steps/s
[Step= 150] | Loss=5.91650 | acc=0.1445 | tpr=0.7839 | fpr=0.8672 | 8215.7 samples/s | 32.1 steps/s
[Step= 200] | Loss=5.90731 | acc=0.1445 | tpr=0.7792 | fpr=0.8670 | 8018.6 samples/s | 31.3 steps/s
[Step= 250] | Loss=5.90672 | acc=0.1452 | tpr=0.7825 | fpr=0.8664 | 8125.0 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.90414 | acc=0.1452 | tpr=0.7789 | fpr=0.8663 | 6503.0 samples/s | 25.4 steps/s
[Step= 350] | Loss=5.91173 | acc=0.1449 | tpr=0.7790 | fpr=0.8666 | 7740.2 samples/s | 30.2 steps/s
[Step= 400] | Loss=5.91423 | acc=0.1448 | tpr=0.7752 | fpr=0.8666 | 8402.6 samples/s | 32.8 steps/s
[Step= 450] | Loss=5.91193 | acc=0.1447 | tpr=0.7741 | fpr=0.8667 | 7736.7 samples/s | 30.2 steps/s
[Step= 500] | Loss=5.91403 | acc=0.1447 | tpr=0.7696 | fpr=0.8665 | 8119.2 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.91287 | acc=0.1448 | tpr=0.7732 | fpr=0.8666 | 10104.8 samples/s | 39.5 steps/s
Avg test loss: 5.91432, Avg test acc: 0.14472, Avg tpr: 0.77338, Avg fpr: 0.86670, total FA: 120340

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.85306 | acc=0.1357 | tpr=0.7920 | fpr=0.8761 | 4740.1 samples/s | 18.5 steps/s
[Step= 100] | Loss=5.82866 | acc=0.1381 | tpr=0.7527 | fpr=0.8733 | 5958.6 samples/s | 23.3 steps/s
[Step= 150] | Loss=5.83928 | acc=0.1396 | tpr=0.7622 | fpr=0.8719 | 8029.6 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.82199 | acc=0.1404 | tpr=0.7628 | fpr=0.8709 | 8153.6 samples/s | 31.8 steps/s
[Step= 250] | Loss=5.81661 | acc=0.1410 | tpr=0.7555 | fpr=0.8702 | 7124.7 samples/s | 27.8 steps/s
[Step= 300] | Loss=5.80871 | acc=0.1411 | tpr=0.7593 | fpr=0.8702 | 8099.8 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.82031 | acc=0.1403 | tpr=0.7564 | fpr=0.8709 | 8070.8 samples/s | 31.5 steps/s
[Step= 400] | Loss=5.82266 | acc=0.1402 | tpr=0.7571 | fpr=0.8710 | 7827.0 samples/s | 30.6 steps/s
[Step= 450] | Loss=5.81925 | acc=0.1406 | tpr=0.7551 | fpr=0.8705 | 7551.3 samples/s | 29.5 steps/s
[Step= 500] | Loss=5.81900 | acc=0.1409 | tpr=0.7537 | fpr=0.8701 | 8540.9 samples/s | 33.4 steps/s
[Step= 550] | Loss=5.81889 | acc=0.1409 | tpr=0.7537 | fpr=0.8702 | 9415.0 samples/s | 36.8 steps/s
Avg test loss: 5.81926, Avg test acc: 0.14081, Avg tpr: 0.75238, Avg fpr: 0.87030, total FA: 120840

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.79571 | acc=0.1426 | tpr=0.7832 | fpr=0.8689 | 4747.9 samples/s | 18.5 steps/s
[Step= 100] | Loss=6.76289 | acc=0.1434 | tpr=0.7804 | fpr=0.8684 | 7490.3 samples/s | 29.3 steps/s
[Step= 150] | Loss=6.77116 | acc=0.1447 | tpr=0.7824 | fpr=0.8671 | 8467.5 samples/s | 33.1 steps/s
[Step= 200] | Loss=6.75530 | acc=0.1448 | tpr=0.7738 | fpr=0.8667 | 7423.4 samples/s | 29.0 steps/s
[Step= 250] | Loss=6.75393 | acc=0.1452 | tpr=0.7694 | fpr=0.8662 | 5888.8 samples/s | 23.0 steps/s
[Step= 300] | Loss=6.74868 | acc=0.1455 | tpr=0.7702 | fpr=0.8659 | 8410.9 samples/s | 32.9 steps/s
[Step= 350] | Loss=6.76126 | acc=0.1451 | tpr=0.7765 | fpr=0.8664 | 8226.8 samples/s | 32.1 steps/s
[Step= 400] | Loss=6.76171 | acc=0.1450 | tpr=0.7735 | fpr=0.8664 | 7808.8 samples/s | 30.5 steps/s
[Step= 450] | Loss=6.76031 | acc=0.1450 | tpr=0.7707 | fpr=0.8663 | 7477.7 samples/s | 29.2 steps/s
[Step= 500] | Loss=6.76396 | acc=0.1450 | tpr=0.7700 | fpr=0.8663 | 8077.4 samples/s | 31.6 steps/s
[Step= 550] | Loss=6.76437 | acc=0.1451 | tpr=0.7716 | fpr=0.8662 | 10747.6 samples/s | 42.0 steps/s
Avg test loss: 6.76567, Avg test acc: 0.14502, Avg tpr: 0.77139, Avg fpr: 0.86636, total FA: 120293

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.57024 | acc=0.1502 | tpr=0.7257 | fpr=0.8602 | 4695.0 samples/s | 18.3 steps/s
[Step= 100] | Loss=5.54961 | acc=0.1528 | tpr=0.6972 | fpr=0.8574 | 7725.1 samples/s | 30.2 steps/s
[Step= 150] | Loss=5.55481 | acc=0.1542 | tpr=0.7061 | fpr=0.8559 | 8088.3 samples/s | 31.6 steps/s
[Step= 200] | Loss=5.54803 | acc=0.1542 | tpr=0.7038 | fpr=0.8558 | 7791.8 samples/s | 30.4 steps/s
[Step= 250] | Loss=5.54646 | acc=0.1547 | tpr=0.7048 | fpr=0.8553 | 5932.6 samples/s | 23.2 steps/s
[Step= 300] | Loss=5.54246 | acc=0.1552 | tpr=0.7098 | fpr=0.8549 | 7613.5 samples/s | 29.7 steps/s
[Step= 350] | Loss=5.55099 | acc=0.1549 | tpr=0.7132 | fpr=0.8552 | 7589.1 samples/s | 29.6 steps/s
[Step= 400] | Loss=5.55146 | acc=0.1547 | tpr=0.7084 | fpr=0.8554 | 8644.3 samples/s | 33.8 steps/s
[Step= 450] | Loss=5.54998 | acc=0.1548 | tpr=0.7020 | fpr=0.8551 | 7231.0 samples/s | 28.2 steps/s
[Step= 500] | Loss=5.55480 | acc=0.1548 | tpr=0.7004 | fpr=0.8551 | 8223.8 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.55394 | acc=0.1553 | tpr=0.7027 | fpr=0.8547 | 11198.3 samples/s | 43.7 steps/s
Avg test loss: 5.55460, Avg test acc: 0.15517, Avg tpr: 0.70166, Avg fpr: 0.85476, total FA: 118682

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.17936 | acc=0.9595 | tpr=0.9336 | fpr=0.0400 | 4426.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.18267 | acc=0.9589 | tpr=0.9360 | fpr=0.0407 | 8483.3 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.18636 | acc=0.9580 | tpr=0.9438 | fpr=0.0418 | 7951.9 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.18681 | acc=0.9580 | tpr=0.9497 | fpr=0.0418 | 5587.6 samples/s | 21.8 steps/s
[Step= 250] | Loss=0.18836 | acc=0.9578 | tpr=0.9520 | fpr=0.0421 | 8395.6 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.19015 | acc=0.9572 | tpr=0.9513 | fpr=0.0427 | 8189.0 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.19079 | acc=0.9570 | tpr=0.9493 | fpr=0.0428 | 7867.4 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.19190 | acc=0.9567 | tpr=0.9480 | fpr=0.0431 | 7861.7 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.19306 | acc=0.9564 | tpr=0.9450 | fpr=0.0434 | 7508.1 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.19261 | acc=0.9564 | tpr=0.9463 | fpr=0.0435 | 8149.0 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.19219 | acc=0.9565 | tpr=0.9439 | fpr=0.0433 | 11103.2 samples/s | 43.4 steps/s
Avg test loss: 0.19194, Avg test acc: 0.95651, Avg tpr: 0.94374, Avg fpr: 0.04326, total FA: 6006

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13792 | acc=0.9642 | tpr=0.9204 | fpr=0.0350 | 4749.5 samples/s | 18.6 steps/s
[Step= 100] | Loss=0.14051 | acc=0.9636 | tpr=0.9318 | fpr=0.0358 | 7222.1 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.14453 | acc=0.9620 | tpr=0.9265 | fpr=0.0373 | 8242.2 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.14479 | acc=0.9618 | tpr=0.9311 | fpr=0.0376 | 6024.6 samples/s | 23.5 steps/s
[Step= 250] | Loss=0.14627 | acc=0.9615 | tpr=0.9293 | fpr=0.0379 | 7901.1 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.14670 | acc=0.9611 | tpr=0.9287 | fpr=0.0383 | 8075.3 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.14667 | acc=0.9611 | tpr=0.9299 | fpr=0.0384 | 7888.4 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.14796 | acc=0.9606 | tpr=0.9261 | fpr=0.0388 | 7234.8 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.14865 | acc=0.9603 | tpr=0.9231 | fpr=0.0391 | 8158.8 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.14837 | acc=0.9604 | tpr=0.9247 | fpr=0.0390 | 8163.2 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.14817 | acc=0.9604 | tpr=0.9224 | fpr=0.0389 | 10595.5 samples/s | 41.4 steps/s
Avg test loss: 0.14795, Avg test acc: 0.96047, Avg tpr: 0.92274, Avg fpr: 0.03885, total FA: 5394

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.21230 | acc=0.9564 | tpr=0.9071 | fpr=0.0427 | 4602.8 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.21793 | acc=0.9568 | tpr=0.9126 | fpr=0.0424 | 8222.7 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.22347 | acc=0.9558 | tpr=0.9164 | fpr=0.0435 | 8023.5 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.22450 | acc=0.9560 | tpr=0.9213 | fpr=0.0434 | 5789.2 samples/s | 22.6 steps/s
[Step= 250] | Loss=0.22645 | acc=0.9557 | tpr=0.9179 | fpr=0.0437 | 8025.5 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.22733 | acc=0.9552 | tpr=0.9171 | fpr=0.0441 | 8239.9 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.22712 | acc=0.9555 | tpr=0.9198 | fpr=0.0439 | 7751.4 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.22778 | acc=0.9552 | tpr=0.9179 | fpr=0.0441 | 7501.6 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.22882 | acc=0.9550 | tpr=0.9167 | fpr=0.0443 | 7419.7 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.22926 | acc=0.9551 | tpr=0.9207 | fpr=0.0443 | 8309.7 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.22807 | acc=0.9551 | tpr=0.9188 | fpr=0.0442 | 11201.7 samples/s | 43.8 steps/s
Avg test loss: 0.22751, Avg test acc: 0.95517, Avg tpr: 0.91878, Avg fpr: 0.04417, total FA: 6133

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15901 | acc=0.9655 | tpr=0.9115 | fpr=0.0335 | 4700.8 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.16597 | acc=0.9639 | tpr=0.9190 | fpr=0.0352 | 7995.9 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.17019 | acc=0.9631 | tpr=0.9236 | fpr=0.0362 | 5908.3 samples/s | 23.1 steps/s
[Step= 200] | Loss=0.16949 | acc=0.9630 | tpr=0.9301 | fpr=0.0364 | 7761.4 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.17124 | acc=0.9628 | tpr=0.9310 | fpr=0.0366 | 8129.5 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.17333 | acc=0.9625 | tpr=0.9338 | fpr=0.0370 | 8066.1 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.17446 | acc=0.9622 | tpr=0.9330 | fpr=0.0373 | 8210.6 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.17566 | acc=0.9620 | tpr=0.9311 | fpr=0.0375 | 7275.0 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.17686 | acc=0.9617 | tpr=0.9294 | fpr=0.0377 | 8251.9 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.17645 | acc=0.9619 | tpr=0.9330 | fpr=0.0376 | 7901.3 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.17592 | acc=0.9621 | tpr=0.9327 | fpr=0.0373 | 9810.0 samples/s | 38.3 steps/s
Avg test loss: 0.17550, Avg test acc: 0.96216, Avg tpr: 0.93265, Avg fpr: 0.03730, total FA: 5179

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.19864 | acc=0.9580 | tpr=0.9027 | fpr=0.0410 | 4458.2 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.20448 | acc=0.9568 | tpr=0.9147 | fpr=0.0424 | 8351.2 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.20830 | acc=0.9558 | tpr=0.9179 | fpr=0.0435 | 5697.6 samples/s | 22.3 steps/s
[Step= 200] | Loss=0.20937 | acc=0.9559 | tpr=0.9279 | fpr=0.0436 | 8127.9 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.21088 | acc=0.9559 | tpr=0.9293 | fpr=0.0437 | 7291.6 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.21222 | acc=0.9555 | tpr=0.9316 | fpr=0.0441 | 8430.1 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.21234 | acc=0.9553 | tpr=0.9324 | fpr=0.0442 | 7956.2 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.21349 | acc=0.9550 | tpr=0.9311 | fpr=0.0446 | 8017.6 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.21464 | acc=0.9547 | tpr=0.9279 | fpr=0.0448 | 8032.8 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.21500 | acc=0.9546 | tpr=0.9286 | fpr=0.0449 | 8141.5 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.21395 | acc=0.9548 | tpr=0.9276 | fpr=0.0448 | 10753.7 samples/s | 42.0 steps/s
Avg test loss: 0.21373, Avg test acc: 0.95478, Avg tpr: 0.92750, Avg fpr: 0.04473, total FA: 6210

server round 22/50

clients selected: [0 3 6 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=32001 Epoch=156.0] | Loss=0.02083 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.493 | L2-Norm(final)=13.370 | 3275.9 samples/s | 51.2 steps/s
[Step=32050 Epoch=156.3] | Loss=0.03496 | Reg=0.00132 | acc=0.9219 | L2-Norm=11.493 | L2-Norm(final)=13.359 | 4876.1 samples/s | 76.2 steps/s
[Step=32100 Epoch=156.5] | Loss=0.03270 | Reg=0.00132 | acc=0.9531 | L2-Norm=11.493 | L2-Norm(final)=13.358 | 5528.2 samples/s | 86.4 steps/s
[Step=32150 Epoch=156.8] | Loss=0.03068 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.493 | L2-Norm(final)=13.361 | 5408.6 samples/s | 84.5 steps/s
[Step=32200 Epoch=157.0] | Loss=0.03229 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.493 | L2-Norm(final)=13.366 | 8561.3 samples/s | 133.8 steps/s
[Step=32250 Epoch=157.3] | Loss=0.03218 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.493 | L2-Norm(final)=13.370 | 1507.2 samples/s | 23.5 steps/s
[Step=32300 Epoch=157.5] | Loss=0.03261 | Reg=0.00132 | acc=0.9375 | L2-Norm=11.493 | L2-Norm(final)=13.373 | 5433.7 samples/s | 84.9 steps/s
[Step=32350 Epoch=157.7] | Loss=0.03264 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.493 | L2-Norm(final)=13.375 | 5472.3 samples/s | 85.5 steps/s
[Step=32400 Epoch=158.0] | Loss=0.03214 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.493 | L2-Norm(final)=13.377 | 7527.4 samples/s | 117.6 steps/s
[Step=32450 Epoch=158.2] | Loss=0.03221 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.493 | L2-Norm(final)=13.380 | 1532.9 samples/s | 24.0 steps/s
[Step=32500 Epoch=158.5] | Loss=0.03201 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.493 | L2-Norm(final)=13.383 | 5626.7 samples/s | 87.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=32501 Epoch=158.5] | Loss=0.02828 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.493 | L2-Norm(final)=13.410 | 3198.4 samples/s | 50.0 steps/s
[Step=32550 Epoch=158.7] | Loss=0.02820 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.528 | L2-Norm(final)=13.410 | 4265.6 samples/s | 66.7 steps/s
[Step=32600 Epoch=159.0] | Loss=0.02958 | Reg=0.00134 | acc=0.9531 | L2-Norm=11.557 | L2-Norm(final)=13.406 | 4726.2 samples/s | 73.8 steps/s
[Step=32650 Epoch=159.2] | Loss=0.02876 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.580 | L2-Norm(final)=13.403 | 4636.3 samples/s | 72.4 steps/s
[Step=32700 Epoch=159.5] | Loss=0.02619 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.599 | L2-Norm(final)=13.402 | 6670.8 samples/s | 104.2 steps/s
[Step=32750 Epoch=159.7] | Loss=0.02308 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.616 | L2-Norm(final)=13.403 | 1404.0 samples/s | 21.9 steps/s
[Step=32800 Epoch=159.9] | Loss=0.02062 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.630 | L2-Norm(final)=13.406 | 4694.7 samples/s | 73.4 steps/s
[Step=32850 Epoch=160.2] | Loss=0.01881 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.642 | L2-Norm(final)=13.409 | 4703.2 samples/s | 73.5 steps/s
[Step=32900 Epoch=160.4] | Loss=0.01780 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.652 | L2-Norm(final)=13.411 | 6203.6 samples/s | 96.9 steps/s
[Step=32950 Epoch=160.7] | Loss=0.01655 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.661 | L2-Norm(final)=13.414 | 1451.9 samples/s | 22.7 steps/s
[Step=33000 Epoch=160.9] | Loss=0.01577 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.669 | L2-Norm(final)=13.416 | 4686.9 samples/s | 73.2 steps/s
[Step=33050 Epoch=161.2] | Loss=0.01498 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.676 | L2-Norm(final)=13.419 | 4751.0 samples/s | 74.2 steps/s
[Step=33100 Epoch=161.4] | Loss=0.01421 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=13.421 | 5515.1 samples/s | 86.2 steps/s
[Step=33150 Epoch=161.6] | Loss=0.01357 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.689 | L2-Norm(final)=13.424 | 1212.3 samples/s | 18.9 steps/s
[Step=33200 Epoch=161.9] | Loss=0.01288 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.695 | L2-Norm(final)=13.427 | 4684.7 samples/s | 73.2 steps/s
[Step=33250 Epoch=162.1] | Loss=0.01238 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.700 | L2-Norm(final)=13.429 | 4678.7 samples/s | 73.1 steps/s
[Step=33300 Epoch=162.4] | Loss=0.01195 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=13.432 | 4951.7 samples/s | 77.4 steps/s
[Step=33350 Epoch=162.6] | Loss=0.01154 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.710 | L2-Norm(final)=13.434 | 1479.0 samples/s | 23.1 steps/s
[Step=33400 Epoch=162.9] | Loss=0.01114 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.714 | L2-Norm(final)=13.437 | 4740.9 samples/s | 74.1 steps/s
[Step=33450 Epoch=163.1] | Loss=0.01081 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.719 | L2-Norm(final)=13.439 | 4627.6 samples/s | 72.3 steps/s
[Step=33500 Epoch=163.4] | Loss=0.01059 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.723 | L2-Norm(final)=13.441 | 4843.8 samples/s | 75.7 steps/s
[Step=33550 Epoch=163.6] | Loss=0.01028 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.727 | L2-Norm(final)=13.443 | 1541.7 samples/s | 24.1 steps/s
[Step=33600 Epoch=163.8] | Loss=0.01002 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.730 | L2-Norm(final)=13.445 | 4668.5 samples/s | 72.9 steps/s
[Step=33650 Epoch=164.1] | Loss=0.00973 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.734 | L2-Norm(final)=13.448 | 4708.2 samples/s | 73.6 steps/s
[Step=33700 Epoch=164.3] | Loss=0.00954 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.737 | L2-Norm(final)=13.450 | 4720.7 samples/s | 73.8 steps/s
[Step=33750 Epoch=164.6] | Loss=0.00930 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.741 | L2-Norm(final)=13.452 | 1520.6 samples/s | 23.8 steps/s
[Step=33800 Epoch=164.8] | Loss=0.00906 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.744 | L2-Norm(final)=13.454 | 4709.2 samples/s | 73.6 steps/s
[Step=33850 Epoch=165.1] | Loss=0.00889 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.747 | L2-Norm(final)=13.456 | 4736.2 samples/s | 74.0 steps/s
[Step=33900 Epoch=165.3] | Loss=0.00874 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.750 | L2-Norm(final)=13.458 | 4637.8 samples/s | 72.5 steps/s
[Step=33950 Epoch=165.5] | Loss=0.00856 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.752 | L2-Norm(final)=13.460 | 1561.1 samples/s | 24.4 steps/s
[Step=34000 Epoch=165.8] | Loss=0.00836 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.755 | L2-Norm(final)=13.462 | 4680.0 samples/s | 73.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step34000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=136.5] | Loss=0.03155 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.493 | L2-Norm(final)=14.494 | 3142.4 samples/s | 49.1 steps/s
[Step=28050 Epoch=136.8] | Loss=0.02408 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.493 | L2-Norm(final)=14.502 | 4987.1 samples/s | 77.9 steps/s
[Step=28100 Epoch=137.0] | Loss=0.02619 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.494 | L2-Norm(final)=14.509 | 5420.0 samples/s | 84.7 steps/s
[Step=28150 Epoch=137.3] | Loss=0.02920 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.494 | L2-Norm(final)=14.510 | 5474.6 samples/s | 85.5 steps/s
[Step=28200 Epoch=137.5] | Loss=0.02898 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.494 | L2-Norm(final)=14.506 | 8528.5 samples/s | 133.3 steps/s
[Step=28250 Epoch=137.8] | Loss=0.02912 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.494 | L2-Norm(final)=14.505 | 1484.0 samples/s | 23.2 steps/s
[Step=28300 Epoch=138.0] | Loss=0.02905 | Reg=0.00132 | acc=0.9531 | L2-Norm=11.494 | L2-Norm(final)=14.503 | 5412.1 samples/s | 84.6 steps/s
[Step=28350 Epoch=138.3] | Loss=0.02956 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.494 | L2-Norm(final)=14.501 | 5590.0 samples/s | 87.3 steps/s
[Step=28400 Epoch=138.5] | Loss=0.02909 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.494 | L2-Norm(final)=14.500 | 7458.8 samples/s | 116.5 steps/s
[Step=28450 Epoch=138.7] | Loss=0.02849 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.494 | L2-Norm(final)=14.500 | 1518.3 samples/s | 23.7 steps/s
[Step=28500 Epoch=139.0] | Loss=0.02859 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.494 | L2-Norm(final)=14.501 | 5475.4 samples/s | 85.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=139.0] | Loss=0.03030 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.494 | L2-Norm(final)=14.514 | 3260.6 samples/s | 50.9 steps/s
[Step=28550 Epoch=139.2] | Loss=0.02617 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.531 | L2-Norm(final)=14.510 | 4186.5 samples/s | 65.4 steps/s
[Step=28600 Epoch=139.5] | Loss=0.02882 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.570 | L2-Norm(final)=14.506 | 4633.4 samples/s | 72.4 steps/s
[Step=28650 Epoch=139.7] | Loss=0.02859 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.598 | L2-Norm(final)=14.500 | 4657.6 samples/s | 72.8 steps/s
[Step=28700 Epoch=140.0] | Loss=0.02671 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.619 | L2-Norm(final)=14.496 | 6782.3 samples/s | 106.0 steps/s
[Step=28750 Epoch=140.2] | Loss=0.02316 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.636 | L2-Norm(final)=14.496 | 1418.0 samples/s | 22.2 steps/s
[Step=28800 Epoch=140.4] | Loss=0.02107 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.651 | L2-Norm(final)=14.497 | 4733.9 samples/s | 74.0 steps/s
[Step=28850 Epoch=140.7] | Loss=0.01903 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.663 | L2-Norm(final)=14.499 | 4684.8 samples/s | 73.2 steps/s
[Step=28900 Epoch=140.9] | Loss=0.01772 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=14.502 | 6026.3 samples/s | 94.2 steps/s
[Step=28950 Epoch=141.2] | Loss=0.01655 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.684 | L2-Norm(final)=14.505 | 1429.3 samples/s | 22.3 steps/s
[Step=29000 Epoch=141.4] | Loss=0.01553 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.692 | L2-Norm(final)=14.507 | 4715.4 samples/s | 73.7 steps/s
[Step=29050 Epoch=141.7] | Loss=0.01461 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.700 | L2-Norm(final)=14.509 | 4805.5 samples/s | 75.1 steps/s
[Step=29100 Epoch=141.9] | Loss=0.01384 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.706 | L2-Norm(final)=14.512 | 5495.7 samples/s | 85.9 steps/s
[Step=29150 Epoch=142.2] | Loss=0.01303 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.712 | L2-Norm(final)=14.515 | 1489.0 samples/s | 23.3 steps/s
[Step=29200 Epoch=142.4] | Loss=0.01234 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.718 | L2-Norm(final)=14.517 | 4706.2 samples/s | 73.5 steps/s
[Step=29250 Epoch=142.6] | Loss=0.01190 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.723 | L2-Norm(final)=14.520 | 4731.2 samples/s | 73.9 steps/s
[Step=29300 Epoch=142.9] | Loss=0.01144 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.728 | L2-Norm(final)=14.522 | 5145.3 samples/s | 80.4 steps/s
[Step=29350 Epoch=143.1] | Loss=0.01088 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=14.524 | 1505.7 samples/s | 23.5 steps/s
[Step=29400 Epoch=143.4] | Loss=0.01064 | Reg=0.00138 | acc=0.9531 | L2-Norm=11.736 | L2-Norm(final)=14.527 | 4667.8 samples/s | 72.9 steps/s
[Step=29450 Epoch=143.6] | Loss=0.01042 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.740 | L2-Norm(final)=14.529 | 4837.9 samples/s | 75.6 steps/s
[Step=29500 Epoch=143.9] | Loss=0.01004 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.743 | L2-Norm(final)=14.531 | 4720.9 samples/s | 73.8 steps/s
[Step=29550 Epoch=144.1] | Loss=0.00972 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.747 | L2-Norm(final)=14.533 | 1556.3 samples/s | 24.3 steps/s
[Step=29600 Epoch=144.3] | Loss=0.00950 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.750 | L2-Norm(final)=14.535 | 4693.7 samples/s | 73.3 steps/s
[Step=29650 Epoch=144.6] | Loss=0.00923 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.753 | L2-Norm(final)=14.536 | 4731.1 samples/s | 73.9 steps/s
[Step=29700 Epoch=144.8] | Loss=0.00904 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.757 | L2-Norm(final)=14.538 | 4713.2 samples/s | 73.6 steps/s
[Step=29750 Epoch=145.1] | Loss=0.00891 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.760 | L2-Norm(final)=14.540 | 1542.4 samples/s | 24.1 steps/s
[Step=29800 Epoch=145.3] | Loss=0.00876 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.763 | L2-Norm(final)=14.542 | 4622.2 samples/s | 72.2 steps/s
[Step=29850 Epoch=145.6] | Loss=0.00859 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.766 | L2-Norm(final)=14.543 | 4661.0 samples/s | 72.8 steps/s
[Step=29900 Epoch=145.8] | Loss=0.00841 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.768 | L2-Norm(final)=14.545 | 4734.9 samples/s | 74.0 steps/s
[Step=29950 Epoch=146.1] | Loss=0.00823 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.771 | L2-Norm(final)=14.546 | 1544.4 samples/s | 24.1 steps/s
[Step=30000 Epoch=146.3] | Loss=0.00803 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.773 | L2-Norm(final)=14.548 | 4783.8 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step30000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=228.3] | Loss=0.00270 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.493 | L2-Norm(final)=13.161 | 3207.3 samples/s | 50.1 steps/s
[Step=24050 Epoch=228.8] | Loss=0.00177 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=13.167 | 4396.5 samples/s | 68.7 steps/s
[Step=24100 Epoch=229.3] | Loss=0.00147 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.489 | L2-Norm(final)=13.182 | 8259.1 samples/s | 129.0 steps/s
[Step=24150 Epoch=229.7] | Loss=0.00142 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=13.193 | 1461.4 samples/s | 22.8 steps/s
[Step=24200 Epoch=230.2] | Loss=0.00135 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=13.204 | 6885.1 samples/s | 107.6 steps/s
[Step=24250 Epoch=230.7] | Loss=0.00154 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=13.213 | 1500.0 samples/s | 23.4 steps/s
[Step=24300 Epoch=231.2] | Loss=0.00144 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=13.222 | 6440.9 samples/s | 100.6 steps/s
[Step=24350 Epoch=231.6] | Loss=0.00149 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=13.231 | 1529.5 samples/s | 23.9 steps/s
[Step=24400 Epoch=232.1] | Loss=0.00148 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=13.241 | 5841.5 samples/s | 91.3 steps/s
[Step=24450 Epoch=232.6] | Loss=0.00150 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=13.250 | 1557.4 samples/s | 24.3 steps/s
[Step=24500 Epoch=233.1] | Loss=0.00143 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=13.259 | 5365.8 samples/s | 83.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=233.1] | Loss=0.00235 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=13.345 | 3211.8 samples/s | 50.2 steps/s
[Step=24550 Epoch=233.5] | Loss=0.00096 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.522 | L2-Norm(final)=13.354 | 3958.0 samples/s | 61.8 steps/s
[Step=24600 Epoch=234.0] | Loss=0.00074 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.543 | L2-Norm(final)=13.361 | 6491.7 samples/s | 101.4 steps/s
[Step=24650 Epoch=234.5] | Loss=0.00055 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.554 | L2-Norm(final)=13.366 | 1385.7 samples/s | 21.7 steps/s
[Step=24700 Epoch=235.0] | Loss=0.00041 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.557 | L2-Norm(final)=13.370 | 5922.3 samples/s | 92.5 steps/s
[Step=24750 Epoch=235.4] | Loss=0.00033 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.553 | L2-Norm(final)=13.373 | 1400.1 samples/s | 21.9 steps/s
[Step=24800 Epoch=235.9] | Loss=0.00028 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.545 | L2-Norm(final)=13.375 | 5419.9 samples/s | 84.7 steps/s
[Step=24850 Epoch=236.4] | Loss=0.00024 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.536 | L2-Norm(final)=13.377 | 1463.7 samples/s | 22.9 steps/s
[Step=24900 Epoch=236.9] | Loss=0.00021 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.526 | L2-Norm(final)=13.378 | 4953.3 samples/s | 77.4 steps/s
[Step=24950 Epoch=237.3] | Loss=0.00019 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.516 | L2-Norm(final)=13.379 | 1495.8 samples/s | 23.4 steps/s
[Step=25000 Epoch=237.8] | Loss=0.00017 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.505 | L2-Norm(final)=13.381 | 4596.6 samples/s | 71.8 steps/s
[Step=25050 Epoch=238.3] | Loss=0.00015 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.493 | L2-Norm(final)=13.382 | 1539.6 samples/s | 24.1 steps/s
[Step=25100 Epoch=238.8] | Loss=0.00014 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.482 | L2-Norm(final)=13.383 | 4496.9 samples/s | 70.3 steps/s
[Step=25150 Epoch=239.2] | Loss=0.00013 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.470 | L2-Norm(final)=13.384 | 1510.0 samples/s | 23.6 steps/s
[Step=25200 Epoch=239.7] | Loss=0.00012 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.458 | L2-Norm(final)=13.385 | 4475.7 samples/s | 69.9 steps/s
[Step=25250 Epoch=240.2] | Loss=0.00011 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.447 | L2-Norm(final)=13.386 | 1529.6 samples/s | 23.9 steps/s
[Step=25300 Epoch=240.7] | Loss=0.00011 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=13.387 | 4447.8 samples/s | 69.5 steps/s
[Step=25350 Epoch=241.1] | Loss=0.00010 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.423 | L2-Norm(final)=13.388 | 1566.4 samples/s | 24.5 steps/s
[Step=25400 Epoch=241.6] | Loss=0.00009 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.411 | L2-Norm(final)=13.388 | 4247.8 samples/s | 66.4 steps/s
[Step=25450 Epoch=242.1] | Loss=0.00009 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.399 | L2-Norm(final)=13.389 | 6819.0 samples/s | 106.5 steps/s
[Step=25500 Epoch=242.6] | Loss=0.00009 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.387 | L2-Norm(final)=13.390 | 1353.5 samples/s | 21.1 steps/s
[Step=25550 Epoch=243.0] | Loss=0.00008 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.375 | L2-Norm(final)=13.391 | 6111.8 samples/s | 95.5 steps/s
[Step=25600 Epoch=243.5] | Loss=0.00008 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.363 | L2-Norm(final)=13.392 | 1405.8 samples/s | 22.0 steps/s
[Step=25650 Epoch=244.0] | Loss=0.00007 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.351 | L2-Norm(final)=13.392 | 5615.2 samples/s | 87.7 steps/s
[Step=25700 Epoch=244.5] | Loss=0.00007 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.338 | L2-Norm(final)=13.393 | 1437.1 samples/s | 22.5 steps/s
[Step=25750 Epoch=244.9] | Loss=0.00007 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.326 | L2-Norm(final)=13.394 | 5094.9 samples/s | 79.6 steps/s
[Step=25800 Epoch=245.4] | Loss=0.00007 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.314 | L2-Norm(final)=13.394 | 1488.9 samples/s | 23.3 steps/s
[Step=25850 Epoch=245.9] | Loss=0.00006 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.302 | L2-Norm(final)=13.395 | 4631.4 samples/s | 72.4 steps/s
[Step=25900 Epoch=246.4] | Loss=0.00006 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.289 | L2-Norm(final)=13.396 | 1482.4 samples/s | 23.2 steps/s
[Step=25950 Epoch=246.8] | Loss=0.00006 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.277 | L2-Norm(final)=13.397 | 4478.8 samples/s | 70.0 steps/s
[Step=26000 Epoch=247.3] | Loss=0.00006 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.265 | L2-Norm(final)=13.398 | 1532.1 samples/s | 23.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step26000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=14001 Epoch=131.9] | Loss=0.00042 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.493 | L2-Norm(final)=12.423 | 3233.3 samples/s | 50.5 steps/s
[Step=14050 Epoch=132.4] | Loss=0.00113 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=12.438 | 4562.6 samples/s | 71.3 steps/s
[Step=14100 Epoch=132.9] | Loss=0.00279 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=12.457 | 7983.2 samples/s | 124.7 steps/s
[Step=14150 Epoch=133.3] | Loss=0.00376 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=12.475 | 1452.2 samples/s | 22.7 steps/s
[Step=14200 Epoch=133.8] | Loss=0.00318 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=12.490 | 6945.1 samples/s | 108.5 steps/s
[Step=14250 Epoch=134.3] | Loss=0.00298 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=12.506 | 1520.8 samples/s | 23.8 steps/s
[Step=14300 Epoch=134.7] | Loss=0.00307 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=12.520 | 6161.8 samples/s | 96.3 steps/s
[Step=14350 Epoch=135.2] | Loss=0.00299 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=12.535 | 1561.5 samples/s | 24.4 steps/s
[Step=14400 Epoch=135.7] | Loss=0.00315 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=12.549 | 5446.3 samples/s | 85.1 steps/s
[Step=14450 Epoch=136.2] | Loss=0.00300 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=12.562 | 1602.4 samples/s | 25.0 steps/s
[Step=14500 Epoch=136.6] | Loss=0.00313 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=12.575 | 5334.1 samples/s | 83.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=14501 Epoch=136.6] | Loss=0.00092 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=12.696 | 3197.7 samples/s | 50.0 steps/s
[Step=14550 Epoch=137.1] | Loss=0.00213 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.514 | L2-Norm(final)=12.700 | 3964.8 samples/s | 61.9 steps/s
[Step=14600 Epoch=137.6] | Loss=0.00212 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.551 | L2-Norm(final)=12.702 | 6414.2 samples/s | 100.2 steps/s
[Step=14650 Epoch=138.0] | Loss=0.00161 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.576 | L2-Norm(final)=12.704 | 1373.4 samples/s | 21.5 steps/s
[Step=14700 Epoch=138.5] | Loss=0.00122 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=12.706 | 5703.0 samples/s | 89.1 steps/s
[Step=14750 Epoch=139.0] | Loss=0.00098 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.590 | L2-Norm(final)=12.708 | 1429.2 samples/s | 22.3 steps/s
[Step=14800 Epoch=139.5] | Loss=0.00082 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.590 | L2-Norm(final)=12.710 | 5200.8 samples/s | 81.3 steps/s
[Step=14850 Epoch=139.9] | Loss=0.00070 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=12.711 | 1445.4 samples/s | 22.6 steps/s
[Step=14900 Epoch=140.4] | Loss=0.00062 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.584 | L2-Norm(final)=12.712 | 4690.1 samples/s | 73.3 steps/s
[Step=14950 Epoch=140.9] | Loss=0.00055 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.579 | L2-Norm(final)=12.713 | 1499.5 samples/s | 23.4 steps/s
[Step=15000 Epoch=141.3] | Loss=0.00050 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.574 | L2-Norm(final)=12.714 | 4459.7 samples/s | 69.7 steps/s
[Step=15050 Epoch=141.8] | Loss=0.00045 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.569 | L2-Norm(final)=12.715 | 1542.6 samples/s | 24.1 steps/s
[Step=15100 Epoch=142.3] | Loss=0.00042 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.563 | L2-Norm(final)=12.715 | 4422.0 samples/s | 69.1 steps/s
[Step=15150 Epoch=142.8] | Loss=0.00038 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.557 | L2-Norm(final)=12.716 | 1541.7 samples/s | 24.1 steps/s
[Step=15200 Epoch=143.2] | Loss=0.00036 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.551 | L2-Norm(final)=12.717 | 4461.2 samples/s | 69.7 steps/s
[Step=15250 Epoch=143.7] | Loss=0.00033 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.544 | L2-Norm(final)=12.717 | 1611.6 samples/s | 25.2 steps/s
[Step=15300 Epoch=144.2] | Loss=0.00031 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.538 | L2-Norm(final)=12.718 | 3893.2 samples/s | 60.8 steps/s
[Step=15350 Epoch=144.6] | Loss=0.00030 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.531 | L2-Norm(final)=12.719 | 6578.1 samples/s | 102.8 steps/s
[Step=15400 Epoch=145.1] | Loss=0.00028 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=12.719 | 1391.5 samples/s | 21.7 steps/s
[Step=15450 Epoch=145.6] | Loss=0.00026 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.517 | L2-Norm(final)=12.720 | 5719.7 samples/s | 89.4 steps/s
[Step=15500 Epoch=146.1] | Loss=0.00025 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.510 | L2-Norm(final)=12.720 | 1417.7 samples/s | 22.2 steps/s
[Step=15550 Epoch=146.5] | Loss=0.00024 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=12.721 | 5197.6 samples/s | 81.2 steps/s
[Step=15600 Epoch=147.0] | Loss=0.00023 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.496 | L2-Norm(final)=12.721 | 1434.9 samples/s | 22.4 steps/s
[Step=15650 Epoch=147.5] | Loss=0.00022 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=12.722 | 4787.9 samples/s | 74.8 steps/s
[Step=15700 Epoch=147.9] | Loss=0.00021 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.482 | L2-Norm(final)=12.722 | 1529.0 samples/s | 23.9 steps/s
[Step=15750 Epoch=148.4] | Loss=0.00020 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.474 | L2-Norm(final)=12.723 | 4480.8 samples/s | 70.0 steps/s
[Step=15800 Epoch=148.9] | Loss=0.00019 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.467 | L2-Norm(final)=12.723 | 1513.2 samples/s | 23.6 steps/s
[Step=15850 Epoch=149.4] | Loss=0.00019 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.460 | L2-Norm(final)=12.724 | 4454.7 samples/s | 69.6 steps/s
[Step=15900 Epoch=149.8] | Loss=0.00018 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=12.724 | 1506.6 samples/s | 23.5 steps/s
[Step=15950 Epoch=150.3] | Loss=0.00018 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.445 | L2-Norm(final)=12.725 | 4499.6 samples/s | 70.3 steps/s
[Step=16000 Epoch=150.8] | Loss=0.00017 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.437 | L2-Norm(final)=12.725 | 1578.3 samples/s | 24.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_3/client_state-step16000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=228.8] | Loss=0.00154 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.493 | L2-Norm(final)=17.690 | 3182.3 samples/s | 49.7 steps/s
[Step=24050 Epoch=229.2] | Loss=0.00314 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.489 | L2-Norm(final)=17.706 | 4459.6 samples/s | 69.7 steps/s
[Step=24100 Epoch=229.7] | Loss=0.00317 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=17.733 | 8275.3 samples/s | 129.3 steps/s
[Step=24150 Epoch=230.2] | Loss=0.00341 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=17.756 | 1468.1 samples/s | 22.9 steps/s
[Step=24200 Epoch=230.6] | Loss=0.00337 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=17.780 | 7188.1 samples/s | 112.3 steps/s
[Step=24250 Epoch=231.1] | Loss=0.00328 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=17.798 | 1492.4 samples/s | 23.3 steps/s
[Step=24300 Epoch=231.6] | Loss=0.00327 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=17.815 | 6590.9 samples/s | 103.0 steps/s
[Step=24350 Epoch=232.1] | Loss=0.00317 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=17.834 | 1495.3 samples/s | 23.4 steps/s
[Step=24400 Epoch=232.6] | Loss=0.00323 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=17.852 | 6177.4 samples/s | 96.5 steps/s
[Step=24450 Epoch=233.0] | Loss=0.00327 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=17.869 | 1517.7 samples/s | 23.7 steps/s
[Step=24500 Epoch=233.5] | Loss=0.00320 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=17.886 | 5764.5 samples/s | 90.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=233.5] | Loss=0.00012 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=18.057 | 3177.7 samples/s | 49.7 steps/s
[Step=24550 Epoch=234.0] | Loss=0.00609 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.546 | L2-Norm(final)=18.069 | 3965.9 samples/s | 62.0 steps/s
[Step=24600 Epoch=234.5] | Loss=0.00739 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.625 | L2-Norm(final)=18.059 | 6620.3 samples/s | 103.4 steps/s
[Step=24650 Epoch=234.9] | Loss=0.00524 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.668 | L2-Norm(final)=18.052 | 1365.8 samples/s | 21.3 steps/s
[Step=24700 Epoch=235.4] | Loss=0.00394 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.689 | L2-Norm(final)=18.049 | 6009.0 samples/s | 93.9 steps/s
[Step=24750 Epoch=235.9] | Loss=0.00316 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.699 | L2-Norm(final)=18.047 | 1391.8 samples/s | 21.7 steps/s
[Step=24800 Epoch=236.4] | Loss=0.00264 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.703 | L2-Norm(final)=18.047 | 5533.2 samples/s | 86.5 steps/s
[Step=24850 Epoch=236.8] | Loss=0.00226 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=18.046 | 1438.8 samples/s | 22.5 steps/s
[Step=24900 Epoch=237.3] | Loss=0.00198 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=18.046 | 5168.0 samples/s | 80.7 steps/s
[Step=24950 Epoch=237.8] | Loss=0.00176 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=18.046 | 1456.1 samples/s | 22.8 steps/s
[Step=25000 Epoch=238.3] | Loss=0.00159 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.702 | L2-Norm(final)=18.046 | 4877.0 samples/s | 76.2 steps/s
[Step=25050 Epoch=238.7] | Loss=0.00144 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.699 | L2-Norm(final)=18.046 | 1482.5 samples/s | 23.2 steps/s
[Step=25100 Epoch=239.2] | Loss=0.00133 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.696 | L2-Norm(final)=18.046 | 4563.8 samples/s | 71.3 steps/s
[Step=25150 Epoch=239.7] | Loss=0.00122 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.693 | L2-Norm(final)=18.046 | 1522.3 samples/s | 23.8 steps/s
[Step=25200 Epoch=240.2] | Loss=0.00114 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.689 | L2-Norm(final)=18.046 | 4454.2 samples/s | 69.6 steps/s
[Step=25250 Epoch=240.7] | Loss=0.00106 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.685 | L2-Norm(final)=18.047 | 1507.8 samples/s | 23.6 steps/s
[Step=25300 Epoch=241.1] | Loss=0.00100 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.681 | L2-Norm(final)=18.047 | 4477.5 samples/s | 70.0 steps/s
[Step=25350 Epoch=241.6] | Loss=0.00094 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.677 | L2-Norm(final)=18.047 | 1561.8 samples/s | 24.4 steps/s
[Step=25400 Epoch=242.1] | Loss=0.00089 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.672 | L2-Norm(final)=18.047 | 4506.3 samples/s | 70.4 steps/s
[Step=25450 Epoch=242.6] | Loss=0.00084 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.668 | L2-Norm(final)=18.047 | 1511.8 samples/s | 23.6 steps/s
[Step=25500 Epoch=243.0] | Loss=0.00080 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.663 | L2-Norm(final)=18.048 | 4485.2 samples/s | 70.1 steps/s
[Step=25550 Epoch=243.5] | Loss=0.00076 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.659 | L2-Norm(final)=18.048 | 7148.5 samples/s | 111.7 steps/s
[Step=25600 Epoch=244.0] | Loss=0.00073 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=18.048 | 1368.1 samples/s | 21.4 steps/s
[Step=25650 Epoch=244.5] | Loss=0.00069 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.649 | L2-Norm(final)=18.048 | 6568.3 samples/s | 102.6 steps/s
[Step=25700 Epoch=244.9] | Loss=0.00067 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.644 | L2-Norm(final)=18.049 | 1397.7 samples/s | 21.8 steps/s
[Step=25750 Epoch=245.4] | Loss=0.00064 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.640 | L2-Norm(final)=18.049 | 6029.0 samples/s | 94.2 steps/s
[Step=25800 Epoch=245.9] | Loss=0.00062 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.635 | L2-Norm(final)=18.049 | 1403.0 samples/s | 21.9 steps/s
[Step=25850 Epoch=246.4] | Loss=0.00059 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.630 | L2-Norm(final)=18.049 | 5542.2 samples/s | 86.6 steps/s
[Step=25900 Epoch=246.9] | Loss=0.00057 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.625 | L2-Norm(final)=18.050 | 1451.8 samples/s | 22.7 steps/s
[Step=25950 Epoch=247.3] | Loss=0.00055 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=18.050 | 5187.0 samples/s | 81.0 steps/s
[Step=26000 Epoch=247.8] | Loss=0.00053 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.615 | L2-Norm(final)=18.050 | 1446.5 samples/s | 22.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4/client_state-step26000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09538 | acc=0.9594 | tpr=0.9682 | fpr=0.0597 | 4696.6 samples/s | 18.3 steps/s
Avg test loss: 0.10164, Avg test acc: 0.95693, Avg tpr: 0.96759, Avg fpr: 0.06653, total FA: 519

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09631 | acc=0.9600 | tpr=0.9715 | fpr=0.0649 | 4834.9 samples/s | 18.9 steps/s
Avg test loss: 0.09858, Avg test acc: 0.95845, Avg tpr: 0.97010, Avg fpr: 0.06717, total FA: 524

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11102 | acc=0.9488 | tpr=0.9604 | fpr=0.0763 | 4580.7 samples/s | 17.9 steps/s
Avg test loss: 0.11593, Avg test acc: 0.94883, Avg tpr: 0.95978, Avg fpr: 0.07525, total FA: 587

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09850 | acc=0.9577 | tpr=0.9621 | fpr=0.0518 | 4703.6 samples/s | 18.4 steps/s
Avg test loss: 0.10378, Avg test acc: 0.95725, Avg tpr: 0.96241, Avg fpr: 0.05410, total FA: 422

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08866 | acc=0.9602 | tpr=0.9658 | fpr=0.0518 | 4766.2 samples/s | 18.6 steps/s
Avg test loss: 0.09597, Avg test acc: 0.95821, Avg tpr: 0.96427, Avg fpr: 0.05512, total FA: 430

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.30596 | acc=0.3065 | tpr=0.0135 | fpr=0.0572 | 4758.1 samples/s | 18.6 steps/s
Avg test loss: 5.32805, Avg test acc: 0.30247, Avg tpr: 0.01177, Avg fpr: 0.05820, total FA: 454

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.64086 | acc=0.2929 | tpr=0.0163 | fpr=0.1065 | 4430.9 samples/s | 17.3 steps/s
Avg test loss: 4.66168, Avg test acc: 0.29061, Avg tpr: 0.01615, Avg fpr: 0.10576, total FA: 825

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.73506 | acc=0.3112 | tpr=0.0033 | fpr=0.0203 | 4733.5 samples/s | 18.5 steps/s
Avg test loss: 4.75639, Avg test acc: 0.30820, Avg tpr: 0.00332, Avg fpr: 0.02128, total FA: 166

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=3.92337 | acc=0.3088 | tpr=0.0286 | fpr=0.0828 | 4731.0 samples/s | 18.5 steps/s
Avg test loss: 3.93644, Avg test acc: 0.30664, Avg tpr: 0.02938, Avg fpr: 0.08358, total FA: 652

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.70606 | acc=0.3113 | tpr=0.0080 | fpr=0.0302 | 4563.3 samples/s | 17.8 steps/s
Avg test loss: 4.73503, Avg test acc: 0.30824, Avg tpr: 0.00723, Avg fpr: 0.02974, total FA: 232

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.97950 | acc=0.1471 | tpr=0.7035 | fpr=0.8629 | 4764.4 samples/s | 18.6 steps/s
[Step= 100] | Loss=5.95867 | acc=0.1493 | tpr=0.6780 | fpr=0.8606 | 7469.9 samples/s | 29.2 steps/s
[Step= 150] | Loss=5.96576 | acc=0.1507 | tpr=0.6844 | fpr=0.8591 | 7963.3 samples/s | 31.1 steps/s
[Step= 200] | Loss=5.95545 | acc=0.1507 | tpr=0.6896 | fpr=0.8591 | 7655.9 samples/s | 29.9 steps/s
[Step= 250] | Loss=5.95308 | acc=0.1513 | tpr=0.6882 | fpr=0.8585 | 7668.4 samples/s | 30.0 steps/s
[Step= 300] | Loss=5.94641 | acc=0.1520 | tpr=0.6873 | fpr=0.8577 | 8688.7 samples/s | 33.9 steps/s
[Step= 350] | Loss=5.95519 | acc=0.1517 | tpr=0.6888 | fpr=0.8580 | 7900.1 samples/s | 30.9 steps/s
[Step= 400] | Loss=5.95495 | acc=0.1515 | tpr=0.6844 | fpr=0.8582 | 8296.1 samples/s | 32.4 steps/s
[Step= 450] | Loss=5.95171 | acc=0.1516 | tpr=0.6850 | fpr=0.8580 | 7882.3 samples/s | 30.8 steps/s
[Step= 500] | Loss=5.95241 | acc=0.1519 | tpr=0.6802 | fpr=0.8576 | 7660.9 samples/s | 29.9 steps/s
[Step= 550] | Loss=5.95065 | acc=0.1522 | tpr=0.6868 | fpr=0.8575 | 10909.1 samples/s | 42.6 steps/s
Avg test loss: 5.95153, Avg test acc: 0.15213, Avg tpr: 0.68621, Avg fpr: 0.85758, total FA: 119073

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.94081 | acc=0.1412 | tpr=0.7788 | fpr=0.8703 | 4656.6 samples/s | 18.2 steps/s
[Step= 100] | Loss=5.91486 | acc=0.1434 | tpr=0.7783 | fpr=0.8684 | 7856.9 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.91650 | acc=0.1445 | tpr=0.7839 | fpr=0.8672 | 7611.5 samples/s | 29.7 steps/s
[Step= 200] | Loss=5.90731 | acc=0.1445 | tpr=0.7792 | fpr=0.8670 | 8414.6 samples/s | 32.9 steps/s
[Step= 250] | Loss=5.90672 | acc=0.1452 | tpr=0.7825 | fpr=0.8664 | 8206.9 samples/s | 32.1 steps/s
[Step= 300] | Loss=5.90414 | acc=0.1452 | tpr=0.7789 | fpr=0.8663 | 8127.6 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.91173 | acc=0.1449 | tpr=0.7790 | fpr=0.8666 | 7797.9 samples/s | 30.5 steps/s
[Step= 400] | Loss=5.91423 | acc=0.1448 | tpr=0.7752 | fpr=0.8666 | 7827.0 samples/s | 30.6 steps/s
[Step= 450] | Loss=5.91193 | acc=0.1447 | tpr=0.7741 | fpr=0.8667 | 8440.3 samples/s | 33.0 steps/s
[Step= 500] | Loss=5.91403 | acc=0.1447 | tpr=0.7696 | fpr=0.8665 | 7862.5 samples/s | 30.7 steps/s
[Step= 550] | Loss=5.91287 | acc=0.1448 | tpr=0.7732 | fpr=0.8666 | 9763.3 samples/s | 38.1 steps/s
Avg test loss: 5.91432, Avg test acc: 0.14472, Avg tpr: 0.77338, Avg fpr: 0.86670, total FA: 120340

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.85306 | acc=0.1357 | tpr=0.7920 | fpr=0.8761 | 4618.1 samples/s | 18.0 steps/s
[Step= 100] | Loss=5.82866 | acc=0.1381 | tpr=0.7527 | fpr=0.8733 | 7843.6 samples/s | 30.6 steps/s
[Step= 150] | Loss=5.83928 | acc=0.1396 | tpr=0.7622 | fpr=0.8719 | 8373.0 samples/s | 32.7 steps/s
[Step= 200] | Loss=5.82199 | acc=0.1404 | tpr=0.7628 | fpr=0.8709 | 7913.9 samples/s | 30.9 steps/s
[Step= 250] | Loss=5.81661 | acc=0.1410 | tpr=0.7555 | fpr=0.8702 | 7893.4 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.80871 | acc=0.1411 | tpr=0.7593 | fpr=0.8702 | 8122.4 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.82031 | acc=0.1403 | tpr=0.7564 | fpr=0.8709 | 8144.8 samples/s | 31.8 steps/s
[Step= 400] | Loss=5.82266 | acc=0.1402 | tpr=0.7571 | fpr=0.8710 | 7614.2 samples/s | 29.7 steps/s
[Step= 450] | Loss=5.81925 | acc=0.1406 | tpr=0.7551 | fpr=0.8705 | 7584.7 samples/s | 29.6 steps/s
[Step= 500] | Loss=5.81900 | acc=0.1409 | tpr=0.7537 | fpr=0.8701 | 8358.9 samples/s | 32.7 steps/s
[Step= 550] | Loss=5.81889 | acc=0.1409 | tpr=0.7537 | fpr=0.8702 | 10272.8 samples/s | 40.1 steps/s
Avg test loss: 5.81926, Avg test acc: 0.14081, Avg tpr: 0.75238, Avg fpr: 0.87030, total FA: 120840

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.32091 | acc=0.1559 | tpr=0.7566 | fpr=0.8549 | 4745.1 samples/s | 18.5 steps/s
[Step= 100] | Loss=6.28044 | acc=0.1573 | tpr=0.7548 | fpr=0.8539 | 7628.8 samples/s | 29.8 steps/s
[Step= 150] | Loss=6.28549 | acc=0.1587 | tpr=0.7464 | fpr=0.8521 | 7366.4 samples/s | 28.8 steps/s
[Step= 200] | Loss=6.27148 | acc=0.1591 | tpr=0.7355 | fpr=0.8513 | 8368.4 samples/s | 32.7 steps/s
[Step= 250] | Loss=6.26773 | acc=0.1599 | tpr=0.7389 | fpr=0.8506 | 8274.0 samples/s | 32.3 steps/s
[Step= 300] | Loss=6.26166 | acc=0.1604 | tpr=0.7367 | fpr=0.8501 | 8480.4 samples/s | 33.1 steps/s
[Step= 350] | Loss=6.27308 | acc=0.1598 | tpr=0.7420 | fpr=0.8508 | 8350.6 samples/s | 32.6 steps/s
[Step= 400] | Loss=6.27349 | acc=0.1597 | tpr=0.7380 | fpr=0.8508 | 7974.4 samples/s | 31.2 steps/s
[Step= 450] | Loss=6.27088 | acc=0.1598 | tpr=0.7361 | fpr=0.8506 | 8072.7 samples/s | 31.5 steps/s
[Step= 500] | Loss=6.27269 | acc=0.1599 | tpr=0.7361 | fpr=0.8506 | 7998.3 samples/s | 31.2 steps/s
[Step= 550] | Loss=6.27266 | acc=0.1601 | tpr=0.7370 | fpr=0.8504 | 9242.1 samples/s | 36.1 steps/s
Avg test loss: 6.27446, Avg test acc: 0.15999, Avg tpr: 0.73693, Avg fpr: 0.85050, total FA: 118090

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.57024 | acc=0.1502 | tpr=0.7257 | fpr=0.8602 | 4780.6 samples/s | 18.7 steps/s
[Step= 100] | Loss=5.54961 | acc=0.1528 | tpr=0.6972 | fpr=0.8574 | 7893.3 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.55481 | acc=0.1542 | tpr=0.7061 | fpr=0.8559 | 7885.5 samples/s | 30.8 steps/s
[Step= 200] | Loss=5.54803 | acc=0.1542 | tpr=0.7038 | fpr=0.8558 | 7328.7 samples/s | 28.6 steps/s
[Step= 250] | Loss=5.54646 | acc=0.1547 | tpr=0.7048 | fpr=0.8553 | 8312.8 samples/s | 32.5 steps/s
[Step= 300] | Loss=5.54246 | acc=0.1552 | tpr=0.7098 | fpr=0.8549 | 8599.9 samples/s | 33.6 steps/s
[Step= 350] | Loss=5.55099 | acc=0.1549 | tpr=0.7132 | fpr=0.8552 | 8103.4 samples/s | 31.7 steps/s
[Step= 400] | Loss=5.55146 | acc=0.1547 | tpr=0.7084 | fpr=0.8554 | 8003.7 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.54998 | acc=0.1548 | tpr=0.7020 | fpr=0.8551 | 8018.6 samples/s | 31.3 steps/s
[Step= 500] | Loss=5.55480 | acc=0.1548 | tpr=0.7004 | fpr=0.8551 | 7532.1 samples/s | 29.4 steps/s
[Step= 550] | Loss=5.55394 | acc=0.1553 | tpr=0.7027 | fpr=0.8547 | 10337.0 samples/s | 40.4 steps/s
Avg test loss: 5.55460, Avg test acc: 0.15517, Avg tpr: 0.70166, Avg fpr: 0.85476, total FA: 118682

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.17936 | acc=0.9595 | tpr=0.9336 | fpr=0.0400 | 4638.1 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.18267 | acc=0.9589 | tpr=0.9360 | fpr=0.0407 | 7474.3 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.18636 | acc=0.9580 | tpr=0.9438 | fpr=0.0418 | 8407.4 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.18681 | acc=0.9580 | tpr=0.9497 | fpr=0.0418 | 8196.1 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.18836 | acc=0.9578 | tpr=0.9520 | fpr=0.0421 | 7913.6 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.19015 | acc=0.9572 | tpr=0.9513 | fpr=0.0427 | 7861.0 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.19079 | acc=0.9570 | tpr=0.9493 | fpr=0.0428 | 7644.6 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.19190 | acc=0.9567 | tpr=0.9480 | fpr=0.0431 | 8332.3 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.19306 | acc=0.9564 | tpr=0.9450 | fpr=0.0434 | 7910.3 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.19261 | acc=0.9564 | tpr=0.9463 | fpr=0.0435 | 7546.3 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.19219 | acc=0.9565 | tpr=0.9439 | fpr=0.0433 | 11068.7 samples/s | 43.2 steps/s
Avg test loss: 0.19194, Avg test acc: 0.95651, Avg tpr: 0.94374, Avg fpr: 0.04326, total FA: 6006

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14610 | acc=0.9638 | tpr=0.9381 | fpr=0.0357 | 4591.1 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.14977 | acc=0.9630 | tpr=0.9296 | fpr=0.0364 | 7958.4 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.15161 | acc=0.9621 | tpr=0.9280 | fpr=0.0373 | 7671.6 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.15176 | acc=0.9624 | tpr=0.9333 | fpr=0.0370 | 8588.6 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.15309 | acc=0.9621 | tpr=0.9328 | fpr=0.0374 | 8001.1 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.15360 | acc=0.9618 | tpr=0.9345 | fpr=0.0377 | 7774.5 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.15346 | acc=0.9618 | tpr=0.9361 | fpr=0.0377 | 7903.2 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.15478 | acc=0.9615 | tpr=0.9316 | fpr=0.0380 | 8004.7 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.15495 | acc=0.9613 | tpr=0.9304 | fpr=0.0381 | 7293.1 samples/s | 28.5 steps/s
[Step= 500] | Loss=0.15476 | acc=0.9614 | tpr=0.9322 | fpr=0.0381 | 8074.1 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.15476 | acc=0.9615 | tpr=0.9300 | fpr=0.0380 | 11486.0 samples/s | 44.9 steps/s
Avg test loss: 0.15440, Avg test acc: 0.96149, Avg tpr: 0.93027, Avg fpr: 0.03794, total FA: 5268

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.21230 | acc=0.9564 | tpr=0.9071 | fpr=0.0427 | 4842.0 samples/s | 18.9 steps/s
[Step= 100] | Loss=0.21793 | acc=0.9568 | tpr=0.9126 | fpr=0.0424 | 7196.2 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.22347 | acc=0.9558 | tpr=0.9164 | fpr=0.0435 | 8344.0 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.22450 | acc=0.9560 | tpr=0.9213 | fpr=0.0434 | 8496.2 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.22645 | acc=0.9557 | tpr=0.9179 | fpr=0.0437 | 7957.0 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.22733 | acc=0.9552 | tpr=0.9171 | fpr=0.0441 | 7818.5 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.22712 | acc=0.9555 | tpr=0.9198 | fpr=0.0439 | 8215.8 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.22778 | acc=0.9552 | tpr=0.9179 | fpr=0.0441 | 7982.4 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.22882 | acc=0.9550 | tpr=0.9167 | fpr=0.0443 | 7805.4 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.22926 | acc=0.9551 | tpr=0.9207 | fpr=0.0443 | 7300.3 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.22807 | acc=0.9551 | tpr=0.9188 | fpr=0.0442 | 10632.3 samples/s | 41.5 steps/s
Avg test loss: 0.22751, Avg test acc: 0.95517, Avg tpr: 0.91878, Avg fpr: 0.04417, total FA: 6133

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.15232 | acc=0.9609 | tpr=0.9425 | fpr=0.0387 | 4724.9 samples/s | 18.5 steps/s
[Step= 100] | Loss=0.15516 | acc=0.9613 | tpr=0.9424 | fpr=0.0384 | 7991.3 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.15927 | acc=0.9605 | tpr=0.9424 | fpr=0.0391 | 7619.6 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.16015 | acc=0.9604 | tpr=0.9443 | fpr=0.0393 | 7633.7 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.16078 | acc=0.9603 | tpr=0.9424 | fpr=0.0393 | 8111.3 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.16222 | acc=0.9599 | tpr=0.9418 | fpr=0.0398 | 7348.2 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.16311 | acc=0.9597 | tpr=0.9411 | fpr=0.0399 | 8573.9 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.16402 | acc=0.9596 | tpr=0.9398 | fpr=0.0401 | 7899.1 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.16446 | acc=0.9593 | tpr=0.9387 | fpr=0.0403 | 7371.0 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.16372 | acc=0.9594 | tpr=0.9396 | fpr=0.0402 | 8069.6 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.16321 | acc=0.9595 | tpr=0.9379 | fpr=0.0401 | 12091.1 samples/s | 47.2 steps/s
Avg test loss: 0.16294, Avg test acc: 0.95955, Avg tpr: 0.93819, Avg fpr: 0.04006, total FA: 5562

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.20357 | acc=0.9570 | tpr=0.9027 | fpr=0.0420 | 4693.0 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.21095 | acc=0.9563 | tpr=0.9147 | fpr=0.0430 | 7858.4 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.21397 | acc=0.9554 | tpr=0.9236 | fpr=0.0441 | 7584.2 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.21490 | acc=0.9553 | tpr=0.9268 | fpr=0.0442 | 8400.8 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.21734 | acc=0.9549 | tpr=0.9284 | fpr=0.0446 | 8195.6 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.21962 | acc=0.9544 | tpr=0.9287 | fpr=0.0451 | 8053.1 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.21962 | acc=0.9545 | tpr=0.9299 | fpr=0.0450 | 7605.3 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.22105 | acc=0.9542 | tpr=0.9261 | fpr=0.0453 | 7787.2 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.22237 | acc=0.9539 | tpr=0.9270 | fpr=0.0456 | 8219.7 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.22317 | acc=0.9537 | tpr=0.9282 | fpr=0.0459 | 7916.4 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.22238 | acc=0.9538 | tpr=0.9256 | fpr=0.0457 | 9545.8 samples/s | 37.3 steps/s
Avg test loss: 0.22197, Avg test acc: 0.95384, Avg tpr: 0.92552, Avg fpr: 0.04565, total FA: 6338

server round 23/50

clients selected: [0 1 5 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=34001 Epoch=165.8] | Loss=0.05064 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.452 | L2-Norm(final)=13.526 | 3083.9 samples/s | 48.2 steps/s
[Step=34050 Epoch=166.0] | Loss=0.02653 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.452 | L2-Norm(final)=13.527 | 4916.3 samples/s | 76.8 steps/s
[Step=34100 Epoch=166.3] | Loss=0.02768 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=13.526 | 5401.3 samples/s | 84.4 steps/s
[Step=34150 Epoch=166.5] | Loss=0.02807 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.452 | L2-Norm(final)=13.524 | 5459.1 samples/s | 85.3 steps/s
[Step=34200 Epoch=166.8] | Loss=0.02912 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=13.523 | 8332.3 samples/s | 130.2 steps/s
[Step=34250 Epoch=167.0] | Loss=0.02915 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.452 | L2-Norm(final)=13.521 | 1459.1 samples/s | 22.8 steps/s
[Step=34300 Epoch=167.3] | Loss=0.02968 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.452 | L2-Norm(final)=13.519 | 5409.4 samples/s | 84.5 steps/s
[Step=34350 Epoch=167.5] | Loss=0.02964 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.452 | L2-Norm(final)=13.516 | 5363.2 samples/s | 83.8 steps/s
[Step=34400 Epoch=167.7] | Loss=0.02955 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=13.514 | 7511.3 samples/s | 117.4 steps/s
[Step=34450 Epoch=168.0] | Loss=0.02899 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.452 | L2-Norm(final)=13.512 | 1463.8 samples/s | 22.9 steps/s
[Step=34500 Epoch=168.2] | Loss=0.02924 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=13.512 | 5364.8 samples/s | 83.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=34501 Epoch=168.2] | Loss=0.03030 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.452 | L2-Norm(final)=13.502 | 3139.0 samples/s | 49.0 steps/s
[Step=34550 Epoch=168.5] | Loss=0.02843 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.485 | L2-Norm(final)=13.499 | 4218.6 samples/s | 65.9 steps/s
[Step=34600 Epoch=168.7] | Loss=0.02963 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.525 | L2-Norm(final)=13.494 | 4626.4 samples/s | 72.3 steps/s
[Step=34650 Epoch=169.0] | Loss=0.02708 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.556 | L2-Norm(final)=13.493 | 4633.7 samples/s | 72.4 steps/s
[Step=34700 Epoch=169.2] | Loss=0.02741 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.578 | L2-Norm(final)=13.492 | 6622.2 samples/s | 103.5 steps/s
[Step=34750 Epoch=169.4] | Loss=0.02365 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.596 | L2-Norm(final)=13.492 | 1383.0 samples/s | 21.6 steps/s
[Step=34800 Epoch=169.7] | Loss=0.02115 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.610 | L2-Norm(final)=13.494 | 4587.2 samples/s | 71.7 steps/s
[Step=34850 Epoch=169.9] | Loss=0.01954 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.622 | L2-Norm(final)=13.496 | 4603.4 samples/s | 71.9 steps/s
[Step=34900 Epoch=170.2] | Loss=0.01847 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.633 | L2-Norm(final)=13.498 | 6063.7 samples/s | 94.7 steps/s
[Step=34950 Epoch=170.4] | Loss=0.01700 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.642 | L2-Norm(final)=13.501 | 1452.0 samples/s | 22.7 steps/s
[Step=35000 Epoch=170.7] | Loss=0.01582 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.651 | L2-Norm(final)=13.504 | 4619.9 samples/s | 72.2 steps/s
[Step=35050 Epoch=170.9] | Loss=0.01499 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.659 | L2-Norm(final)=13.507 | 4643.5 samples/s | 72.6 steps/s
[Step=35100 Epoch=171.2] | Loss=0.01433 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.666 | L2-Norm(final)=13.509 | 5536.1 samples/s | 86.5 steps/s
[Step=35150 Epoch=171.4] | Loss=0.01363 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.672 | L2-Norm(final)=13.512 | 1461.3 samples/s | 22.8 steps/s
[Step=35200 Epoch=171.6] | Loss=0.01303 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.678 | L2-Norm(final)=13.514 | 4607.4 samples/s | 72.0 steps/s
[Step=35250 Epoch=171.9] | Loss=0.01260 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.684 | L2-Norm(final)=13.517 | 4617.1 samples/s | 72.1 steps/s
[Step=35300 Epoch=172.1] | Loss=0.01216 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.689 | L2-Norm(final)=13.519 | 5136.5 samples/s | 80.3 steps/s
[Step=35350 Epoch=172.4] | Loss=0.01164 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.693 | L2-Norm(final)=13.521 | 1462.2 samples/s | 22.8 steps/s
[Step=35400 Epoch=172.6] | Loss=0.01122 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=13.524 | 4606.4 samples/s | 72.0 steps/s
[Step=35450 Epoch=172.9] | Loss=0.01093 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.702 | L2-Norm(final)=13.526 | 4659.9 samples/s | 72.8 steps/s
[Step=35500 Epoch=173.1] | Loss=0.01068 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.706 | L2-Norm(final)=13.528 | 4697.6 samples/s | 73.4 steps/s
[Step=35550 Epoch=173.3] | Loss=0.01035 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.709 | L2-Norm(final)=13.530 | 1525.3 samples/s | 23.8 steps/s
[Step=35600 Epoch=173.6] | Loss=0.01010 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.713 | L2-Norm(final)=13.532 | 4559.3 samples/s | 71.2 steps/s
[Step=35650 Epoch=173.8] | Loss=0.00982 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.716 | L2-Norm(final)=13.534 | 4646.8 samples/s | 72.6 steps/s
[Step=35700 Epoch=174.1] | Loss=0.00959 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.719 | L2-Norm(final)=13.536 | 4644.5 samples/s | 72.6 steps/s
[Step=35750 Epoch=174.3] | Loss=0.00940 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.722 | L2-Norm(final)=13.537 | 1532.0 samples/s | 23.9 steps/s
[Step=35800 Epoch=174.6] | Loss=0.00919 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.725 | L2-Norm(final)=13.539 | 4636.3 samples/s | 72.4 steps/s
[Step=35850 Epoch=174.8] | Loss=0.00895 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.727 | L2-Norm(final)=13.541 | 4588.3 samples/s | 71.7 steps/s
[Step=35900 Epoch=175.1] | Loss=0.00879 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.730 | L2-Norm(final)=13.543 | 4628.3 samples/s | 72.3 steps/s
[Step=35950 Epoch=175.3] | Loss=0.00865 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.732 | L2-Norm(final)=13.545 | 1534.7 samples/s | 24.0 steps/s
[Step=36000 Epoch=175.5] | Loss=0.00845 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.734 | L2-Norm(final)=13.546 | 4615.1 samples/s | 72.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step36000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=97.6] | Loss=0.02846 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.452 | L2-Norm(final)=11.881 | 3061.2 samples/s | 47.8 steps/s
[Step=20050 Epoch=97.8] | Loss=0.03151 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.452 | L2-Norm(final)=11.876 | 4868.4 samples/s | 76.1 steps/s
[Step=20100 Epoch=98.1] | Loss=0.03283 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=11.871 | 5292.5 samples/s | 82.7 steps/s
[Step=20150 Epoch=98.3] | Loss=0.03416 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.452 | L2-Norm(final)=11.863 | 5400.1 samples/s | 84.4 steps/s
[Step=20200 Epoch=98.6] | Loss=0.03303 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.452 | L2-Norm(final)=11.853 | 8581.0 samples/s | 134.1 steps/s
[Step=20250 Epoch=98.8] | Loss=0.03319 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.453 | L2-Norm(final)=11.846 | 1460.2 samples/s | 22.8 steps/s
[Step=20300 Epoch=99.1] | Loss=0.03283 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.453 | L2-Norm(final)=11.840 | 5407.3 samples/s | 84.5 steps/s
[Step=20350 Epoch=99.3] | Loss=0.03345 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.453 | L2-Norm(final)=11.835 | 5358.8 samples/s | 83.7 steps/s
[Step=20400 Epoch=99.5] | Loss=0.03326 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.453 | L2-Norm(final)=11.829 | 7607.0 samples/s | 118.9 steps/s
[Step=20450 Epoch=99.8] | Loss=0.03275 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.453 | L2-Norm(final)=11.825 | 1482.4 samples/s | 23.2 steps/s
[Step=20500 Epoch=100.0] | Loss=0.03324 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.453 | L2-Norm(final)=11.821 | 5462.2 samples/s | 85.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=100.0] | Loss=0.01100 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.453 | L2-Norm(final)=11.783 | 3229.3 samples/s | 50.5 steps/s
[Step=20550 Epoch=100.3] | Loss=0.03600 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.484 | L2-Norm(final)=11.769 | 4039.9 samples/s | 63.1 steps/s
[Step=20600 Epoch=100.5] | Loss=0.03501 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.518 | L2-Norm(final)=11.763 | 4641.7 samples/s | 72.5 steps/s
[Step=20650 Epoch=100.8] | Loss=0.03110 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.546 | L2-Norm(final)=11.760 | 4589.3 samples/s | 71.7 steps/s
[Step=20700 Epoch=101.0] | Loss=0.02873 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.569 | L2-Norm(final)=11.761 | 6734.2 samples/s | 105.2 steps/s
[Step=20750 Epoch=101.3] | Loss=0.02518 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.589 | L2-Norm(final)=11.763 | 1371.3 samples/s | 21.4 steps/s
[Step=20800 Epoch=101.5] | Loss=0.02284 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.607 | L2-Norm(final)=11.768 | 4641.7 samples/s | 72.5 steps/s
[Step=20850 Epoch=101.7] | Loss=0.02090 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.622 | L2-Norm(final)=11.773 | 4707.3 samples/s | 73.6 steps/s
[Step=20900 Epoch=102.0] | Loss=0.01974 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.635 | L2-Norm(final)=11.777 | 6049.3 samples/s | 94.5 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01848 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.646 | L2-Norm(final)=11.780 | 1394.9 samples/s | 21.8 steps/s
[Step=21000 Epoch=102.5] | Loss=0.01728 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.657 | L2-Norm(final)=11.784 | 4604.2 samples/s | 71.9 steps/s
[Step=21050 Epoch=102.7] | Loss=0.01644 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.666 | L2-Norm(final)=11.788 | 4567.4 samples/s | 71.4 steps/s
[Step=21100 Epoch=103.0] | Loss=0.01554 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=11.792 | 5748.7 samples/s | 89.8 steps/s
[Step=21150 Epoch=103.2] | Loss=0.01476 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.684 | L2-Norm(final)=11.796 | 1415.9 samples/s | 22.1 steps/s
[Step=21200 Epoch=103.4] | Loss=0.01405 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.691 | L2-Norm(final)=11.800 | 4596.1 samples/s | 71.8 steps/s
[Step=21250 Epoch=103.7] | Loss=0.01343 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.699 | L2-Norm(final)=11.804 | 4680.9 samples/s | 73.1 steps/s
[Step=21300 Epoch=103.9] | Loss=0.01301 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=11.807 | 5326.5 samples/s | 83.2 steps/s
[Step=21350 Epoch=104.2] | Loss=0.01244 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.711 | L2-Norm(final)=11.810 | 1452.4 samples/s | 22.7 steps/s
[Step=21400 Epoch=104.4] | Loss=0.01202 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.717 | L2-Norm(final)=11.814 | 4682.5 samples/s | 73.2 steps/s
[Step=21450 Epoch=104.7] | Loss=0.01169 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.722 | L2-Norm(final)=11.817 | 4680.4 samples/s | 73.1 steps/s
[Step=21500 Epoch=104.9] | Loss=0.01141 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.727 | L2-Norm(final)=11.819 | 4928.2 samples/s | 77.0 steps/s
[Step=21550 Epoch=105.2] | Loss=0.01101 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=11.822 | 1469.6 samples/s | 23.0 steps/s
[Step=21600 Epoch=105.4] | Loss=0.01066 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.736 | L2-Norm(final)=11.825 | 4732.4 samples/s | 73.9 steps/s
[Step=21650 Epoch=105.6] | Loss=0.01035 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.741 | L2-Norm(final)=11.828 | 4575.4 samples/s | 71.5 steps/s
[Step=21700 Epoch=105.9] | Loss=0.01012 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.745 | L2-Norm(final)=11.831 | 4744.3 samples/s | 74.1 steps/s
[Step=21750 Epoch=106.1] | Loss=0.00982 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.749 | L2-Norm(final)=11.834 | 1493.0 samples/s | 23.3 steps/s
[Step=21800 Epoch=106.4] | Loss=0.00953 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.753 | L2-Norm(final)=11.837 | 4648.7 samples/s | 72.6 steps/s
[Step=21850 Epoch=106.6] | Loss=0.00926 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.756 | L2-Norm(final)=11.840 | 4616.4 samples/s | 72.1 steps/s
[Step=21900 Epoch=106.9] | Loss=0.00909 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.760 | L2-Norm(final)=11.843 | 4599.9 samples/s | 71.9 steps/s
[Step=21950 Epoch=107.1] | Loss=0.00896 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.763 | L2-Norm(final)=11.845 | 1502.4 samples/s | 23.5 steps/s
[Step=22000 Epoch=107.3] | Loss=0.00878 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.766 | L2-Norm(final)=11.848 | 4647.4 samples/s | 72.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_1/client_state-step22000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=265.3] | Loss=0.00036 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=17.108 | 3078.1 samples/s | 48.1 steps/s
[Step=28050 Epoch=265.8] | Loss=0.00129 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=17.118 | 4524.3 samples/s | 70.7 steps/s
[Step=28100 Epoch=266.3] | Loss=0.00118 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=17.129 | 8095.0 samples/s | 126.5 steps/s
[Step=28150 Epoch=266.7] | Loss=0.00099 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=17.140 | 1432.9 samples/s | 22.4 steps/s
[Step=28200 Epoch=267.2] | Loss=0.00113 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=17.150 | 7123.4 samples/s | 111.3 steps/s
[Step=28250 Epoch=267.7] | Loss=0.00109 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=17.161 | 1451.1 samples/s | 22.7 steps/s
[Step=28300 Epoch=268.2] | Loss=0.00104 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=17.171 | 6417.8 samples/s | 100.3 steps/s
[Step=28350 Epoch=268.6] | Loss=0.00112 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=17.180 | 1517.1 samples/s | 23.7 steps/s
[Step=28400 Epoch=269.1] | Loss=0.00114 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=17.189 | 5594.6 samples/s | 87.4 steps/s
[Step=28450 Epoch=269.6] | Loss=0.00109 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=17.197 | 1551.6 samples/s | 24.2 steps/s
[Step=28500 Epoch=270.1] | Loss=0.00110 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=17.205 | 5243.5 samples/s | 81.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=270.1] | Loss=0.00097 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=17.282 | 3135.8 samples/s | 49.0 steps/s
[Step=28550 Epoch=270.5] | Loss=0.00670 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.488 | L2-Norm(final)=17.272 | 4006.3 samples/s | 62.6 steps/s
[Step=28600 Epoch=271.0] | Loss=0.00523 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.543 | L2-Norm(final)=17.261 | 6295.8 samples/s | 98.4 steps/s
[Step=28650 Epoch=271.5] | Loss=0.00366 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.568 | L2-Norm(final)=17.257 | 1360.7 samples/s | 21.3 steps/s
[Step=28700 Epoch=272.0] | Loss=0.00279 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.579 | L2-Norm(final)=17.255 | 5940.8 samples/s | 92.8 steps/s
[Step=28750 Epoch=272.4] | Loss=0.00228 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.584 | L2-Norm(final)=17.256 | 1371.7 samples/s | 21.4 steps/s
[Step=28800 Epoch=272.9] | Loss=0.00190 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.586 | L2-Norm(final)=17.256 | 5310.0 samples/s | 83.0 steps/s
[Step=28850 Epoch=273.4] | Loss=0.00163 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.586 | L2-Norm(final)=17.257 | 1418.0 samples/s | 22.2 steps/s
[Step=28900 Epoch=273.9] | Loss=0.00143 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.584 | L2-Norm(final)=17.257 | 4906.9 samples/s | 76.7 steps/s
[Step=28950 Epoch=274.3] | Loss=0.00127 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=17.257 | 1479.2 samples/s | 23.1 steps/s
[Step=29000 Epoch=274.8] | Loss=0.00115 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.578 | L2-Norm(final)=17.257 | 4530.8 samples/s | 70.8 steps/s
[Step=29050 Epoch=275.3] | Loss=0.00104 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.574 | L2-Norm(final)=17.258 | 1485.2 samples/s | 23.2 steps/s
[Step=29100 Epoch=275.7] | Loss=0.00096 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.570 | L2-Norm(final)=17.258 | 4537.6 samples/s | 70.9 steps/s
[Step=29150 Epoch=276.2] | Loss=0.00088 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.565 | L2-Norm(final)=17.258 | 1465.6 samples/s | 22.9 steps/s
[Step=29200 Epoch=276.7] | Loss=0.00082 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.560 | L2-Norm(final)=17.259 | 4475.3 samples/s | 69.9 steps/s
[Step=29250 Epoch=277.2] | Loss=0.00077 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.556 | L2-Norm(final)=17.259 | 1506.0 samples/s | 23.5 steps/s
[Step=29300 Epoch=277.6] | Loss=0.00072 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.551 | L2-Norm(final)=17.259 | 4234.6 samples/s | 66.2 steps/s
[Step=29350 Epoch=278.1] | Loss=0.00068 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.545 | L2-Norm(final)=17.260 | 1507.7 samples/s | 23.6 steps/s
[Step=29400 Epoch=278.6] | Loss=0.00064 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.540 | L2-Norm(final)=17.260 | 4231.6 samples/s | 66.1 steps/s
[Step=29450 Epoch=279.1] | Loss=0.00061 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.535 | L2-Norm(final)=17.260 | 6665.4 samples/s | 104.1 steps/s
[Step=29500 Epoch=279.5] | Loss=0.00058 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.530 | L2-Norm(final)=17.261 | 1343.2 samples/s | 21.0 steps/s
[Step=29550 Epoch=280.0] | Loss=0.00055 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=17.261 | 6033.1 samples/s | 94.3 steps/s
[Step=29600 Epoch=280.5] | Loss=0.00052 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.519 | L2-Norm(final)=17.261 | 1362.7 samples/s | 21.3 steps/s
[Step=29650 Epoch=281.0] | Loss=0.00050 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.514 | L2-Norm(final)=17.262 | 5487.3 samples/s | 85.7 steps/s
[Step=29700 Epoch=281.4] | Loss=0.00048 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.508 | L2-Norm(final)=17.262 | 1394.0 samples/s | 21.8 steps/s
[Step=29750 Epoch=281.9] | Loss=0.00046 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=17.262 | 5020.0 samples/s | 78.4 steps/s
[Step=29800 Epoch=282.4] | Loss=0.00044 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.497 | L2-Norm(final)=17.263 | 1449.2 samples/s | 22.6 steps/s
[Step=29850 Epoch=282.9] | Loss=0.00043 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=17.263 | 4628.4 samples/s | 72.3 steps/s
[Step=29900 Epoch=283.3] | Loss=0.00041 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.486 | L2-Norm(final)=17.263 | 1457.8 samples/s | 22.8 steps/s
[Step=29950 Epoch=283.8] | Loss=0.00040 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.480 | L2-Norm(final)=17.264 | 4401.6 samples/s | 68.8 steps/s
[Step=30000 Epoch=284.3] | Loss=0.00038 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.474 | L2-Norm(final)=17.264 | 1488.7 samples/s | 23.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step30000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=248.3] | Loss=0.00030 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=15.866 | 3047.0 samples/s | 47.6 steps/s
[Step=26050 Epoch=248.8] | Loss=0.00074 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.450 | L2-Norm(final)=15.871 | 4664.4 samples/s | 72.9 steps/s
[Step=26100 Epoch=249.2] | Loss=0.00065 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.450 | L2-Norm(final)=15.879 | 8119.6 samples/s | 126.9 steps/s
[Step=26150 Epoch=249.7] | Loss=0.00060 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.450 | L2-Norm(final)=15.887 | 1408.6 samples/s | 22.0 steps/s
[Step=26200 Epoch=250.2] | Loss=0.00062 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.450 | L2-Norm(final)=15.894 | 7195.8 samples/s | 112.4 steps/s
[Step=26250 Epoch=250.7] | Loss=0.00059 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.450 | L2-Norm(final)=15.902 | 1452.7 samples/s | 22.7 steps/s
[Step=26300 Epoch=251.1] | Loss=0.00063 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.450 | L2-Norm(final)=15.910 | 6693.8 samples/s | 104.6 steps/s
[Step=26350 Epoch=251.6] | Loss=0.00064 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.450 | L2-Norm(final)=15.916 | 1465.0 samples/s | 22.9 steps/s
[Step=26400 Epoch=252.1] | Loss=0.00062 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.450 | L2-Norm(final)=15.923 | 6154.7 samples/s | 96.2 steps/s
[Step=26450 Epoch=252.6] | Loss=0.00061 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.450 | L2-Norm(final)=15.929 | 1499.9 samples/s | 23.4 steps/s
[Step=26500 Epoch=253.1] | Loss=0.00061 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.450 | L2-Norm(final)=15.935 | 5652.8 samples/s | 88.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=253.1] | Loss=0.00043 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.450 | L2-Norm(final)=15.994 | 3071.9 samples/s | 48.0 steps/s
[Step=26550 Epoch=253.5] | Loss=0.00159 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.448 | L2-Norm(final)=15.996 | 4008.3 samples/s | 62.6 steps/s
[Step=26600 Epoch=254.0] | Loss=0.00132 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.471 | L2-Norm(final)=15.993 | 6450.6 samples/s | 100.8 steps/s
[Step=26650 Epoch=254.5] | Loss=0.00136 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.487 | L2-Norm(final)=15.991 | 1368.8 samples/s | 21.4 steps/s
[Step=26700 Epoch=255.0] | Loss=0.00104 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.497 | L2-Norm(final)=15.989 | 6081.2 samples/s | 95.0 steps/s
[Step=26750 Epoch=255.4] | Loss=0.00083 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.499 | L2-Norm(final)=15.989 | 1384.1 samples/s | 21.6 steps/s
[Step=26800 Epoch=255.9] | Loss=0.00070 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.499 | L2-Norm(final)=15.989 | 5612.8 samples/s | 87.7 steps/s
[Step=26850 Epoch=256.4] | Loss=0.00060 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.497 | L2-Norm(final)=15.989 | 1450.0 samples/s | 22.7 steps/s
[Step=26900 Epoch=256.9] | Loss=0.00053 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.493 | L2-Norm(final)=15.989 | 5248.6 samples/s | 82.0 steps/s
[Step=26950 Epoch=257.4] | Loss=0.00047 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=15.989 | 1456.5 samples/s | 22.8 steps/s
[Step=27000 Epoch=257.8] | Loss=0.00042 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.485 | L2-Norm(final)=15.989 | 4824.2 samples/s | 75.4 steps/s
[Step=27050 Epoch=258.3] | Loss=0.00038 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.480 | L2-Norm(final)=15.990 | 1477.8 samples/s | 23.1 steps/s
[Step=27100 Epoch=258.8] | Loss=0.00035 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.475 | L2-Norm(final)=15.990 | 4565.9 samples/s | 71.3 steps/s
[Step=27150 Epoch=259.3] | Loss=0.00033 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.470 | L2-Norm(final)=15.991 | 1534.8 samples/s | 24.0 steps/s
[Step=27200 Epoch=259.7] | Loss=0.00030 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.464 | L2-Norm(final)=15.991 | 4474.6 samples/s | 69.9 steps/s
[Step=27250 Epoch=260.2] | Loss=0.00028 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.459 | L2-Norm(final)=15.991 | 1507.6 samples/s | 23.6 steps/s
[Step=27300 Epoch=260.7] | Loss=0.00027 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.453 | L2-Norm(final)=15.992 | 4569.3 samples/s | 71.4 steps/s
[Step=27350 Epoch=261.2] | Loss=0.00025 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.447 | L2-Norm(final)=15.992 | 1541.1 samples/s | 24.1 steps/s
[Step=27400 Epoch=261.7] | Loss=0.00024 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.441 | L2-Norm(final)=15.992 | 4455.3 samples/s | 69.6 steps/s
[Step=27450 Epoch=262.1] | Loss=0.00022 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.436 | L2-Norm(final)=15.993 | 1528.8 samples/s | 23.9 steps/s
[Step=27500 Epoch=262.6] | Loss=0.00021 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=15.993 | 4443.5 samples/s | 69.4 steps/s
[Step=27550 Epoch=263.1] | Loss=0.00020 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=15.994 | 7168.9 samples/s | 112.0 steps/s
[Step=27600 Epoch=263.6] | Loss=0.00019 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.418 | L2-Norm(final)=15.994 | 1358.2 samples/s | 21.2 steps/s
[Step=27650 Epoch=264.0] | Loss=0.00019 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.412 | L2-Norm(final)=15.994 | 6611.7 samples/s | 103.3 steps/s
[Step=27700 Epoch=264.5] | Loss=0.00018 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=15.995 | 1390.4 samples/s | 21.7 steps/s
[Step=27750 Epoch=265.0] | Loss=0.00017 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.399 | L2-Norm(final)=15.995 | 5923.1 samples/s | 92.5 steps/s
[Step=27800 Epoch=265.5] | Loss=0.00017 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.393 | L2-Norm(final)=15.995 | 1425.1 samples/s | 22.3 steps/s
[Step=27850 Epoch=266.0] | Loss=0.00016 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.387 | L2-Norm(final)=15.996 | 5401.4 samples/s | 84.4 steps/s
[Step=27900 Epoch=266.4] | Loss=0.00015 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=15.996 | 1442.8 samples/s | 22.5 steps/s
[Step=27950 Epoch=266.9] | Loss=0.00015 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=15.997 | 5199.1 samples/s | 81.2 steps/s
[Step=28000 Epoch=267.4] | Loss=0.00014 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.368 | L2-Norm(final)=15.997 | 1476.0 samples/s | 23.1 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step28000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=16001 Epoch=150.8] | Loss=0.00407 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=12.738 | 3281.5 samples/s | 51.3 steps/s
[Step=16050 Epoch=151.2] | Loss=0.00343 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=12.750 | 4331.2 samples/s | 67.7 steps/s
[Step=16100 Epoch=151.7] | Loss=0.00295 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=12.771 | 7933.5 samples/s | 124.0 steps/s
[Step=16150 Epoch=152.2] | Loss=0.00242 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=12.793 | 1460.5 samples/s | 22.8 steps/s
[Step=16200 Epoch=152.7] | Loss=0.00271 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.449 | L2-Norm(final)=12.812 | 6930.9 samples/s | 108.3 steps/s
[Step=16250 Epoch=153.1] | Loss=0.00288 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=12.831 | 1483.2 samples/s | 23.2 steps/s
[Step=16300 Epoch=153.6] | Loss=0.00297 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=12.849 | 6186.8 samples/s | 96.7 steps/s
[Step=16350 Epoch=154.1] | Loss=0.00276 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=12.866 | 1537.2 samples/s | 24.0 steps/s
[Step=16400 Epoch=154.5] | Loss=0.00282 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=12.884 | 5542.0 samples/s | 86.6 steps/s
[Step=16450 Epoch=155.0] | Loss=0.00287 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=12.901 | 1571.8 samples/s | 24.6 steps/s
[Step=16500 Epoch=155.5] | Loss=0.00285 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=12.915 | 5195.8 samples/s | 81.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=16501 Epoch=155.5] | Loss=0.00044 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=13.063 | 3248.1 samples/s | 50.8 steps/s
[Step=16550 Epoch=155.9] | Loss=0.00452 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.501 | L2-Norm(final)=13.070 | 3898.6 samples/s | 60.9 steps/s
[Step=16600 Epoch=156.4] | Loss=0.00277 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.552 | L2-Norm(final)=13.070 | 6359.4 samples/s | 99.4 steps/s
[Step=16650 Epoch=156.9] | Loss=0.00198 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.573 | L2-Norm(final)=13.072 | 1381.2 samples/s | 21.6 steps/s
[Step=16700 Epoch=157.4] | Loss=0.00152 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=13.075 | 5707.8 samples/s | 89.2 steps/s
[Step=16750 Epoch=157.8] | Loss=0.00122 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.584 | L2-Norm(final)=13.076 | 1404.4 samples/s | 21.9 steps/s
[Step=16800 Epoch=158.3] | Loss=0.00102 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=13.078 | 5212.6 samples/s | 81.4 steps/s
[Step=16850 Epoch=158.8] | Loss=0.00087 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.579 | L2-Norm(final)=13.079 | 1461.9 samples/s | 22.8 steps/s
[Step=16900 Epoch=159.2] | Loss=0.00076 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.574 | L2-Norm(final)=13.080 | 4709.9 samples/s | 73.6 steps/s
[Step=16950 Epoch=159.7] | Loss=0.00068 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.569 | L2-Norm(final)=13.081 | 1546.4 samples/s | 24.2 steps/s
[Step=17000 Epoch=160.2] | Loss=0.00061 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.563 | L2-Norm(final)=13.082 | 4407.0 samples/s | 68.9 steps/s
[Step=17050 Epoch=160.7] | Loss=0.00056 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.556 | L2-Norm(final)=13.082 | 1532.1 samples/s | 23.9 steps/s
[Step=17100 Epoch=161.1] | Loss=0.00051 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.550 | L2-Norm(final)=13.083 | 4466.7 samples/s | 69.8 steps/s
[Step=17150 Epoch=161.6] | Loss=0.00047 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.543 | L2-Norm(final)=13.084 | 1542.4 samples/s | 24.1 steps/s
[Step=17200 Epoch=162.1] | Loss=0.00044 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.535 | L2-Norm(final)=13.084 | 4496.6 samples/s | 70.3 steps/s
[Step=17250 Epoch=162.5] | Loss=0.00041 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.528 | L2-Norm(final)=13.085 | 1586.4 samples/s | 24.8 steps/s
[Step=17300 Epoch=163.0] | Loss=0.00039 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.521 | L2-Norm(final)=13.086 | 4019.1 samples/s | 62.8 steps/s
[Step=17350 Epoch=163.5] | Loss=0.00036 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.513 | L2-Norm(final)=13.086 | 6485.9 samples/s | 101.3 steps/s
[Step=17400 Epoch=164.0] | Loss=0.00034 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.506 | L2-Norm(final)=13.087 | 1400.5 samples/s | 21.9 steps/s
[Step=17450 Epoch=164.4] | Loss=0.00033 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.498 | L2-Norm(final)=13.087 | 5769.6 samples/s | 90.1 steps/s
[Step=17500 Epoch=164.9] | Loss=0.00031 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.490 | L2-Norm(final)=13.088 | 1421.9 samples/s | 22.2 steps/s
[Step=17550 Epoch=165.4] | Loss=0.00029 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.482 | L2-Norm(final)=13.088 | 5262.1 samples/s | 82.2 steps/s
[Step=17600 Epoch=165.8] | Loss=0.00028 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.474 | L2-Norm(final)=13.088 | 1492.8 samples/s | 23.3 steps/s
[Step=17650 Epoch=166.3] | Loss=0.00027 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.466 | L2-Norm(final)=13.089 | 4759.6 samples/s | 74.4 steps/s
[Step=17700 Epoch=166.8] | Loss=0.00026 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.458 | L2-Norm(final)=13.089 | 1502.7 samples/s | 23.5 steps/s
[Step=17750 Epoch=167.3] | Loss=0.00025 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.450 | L2-Norm(final)=13.090 | 4481.2 samples/s | 70.0 steps/s
[Step=17800 Epoch=167.7] | Loss=0.00024 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.442 | L2-Norm(final)=13.090 | 1517.9 samples/s | 23.7 steps/s
[Step=17850 Epoch=168.2] | Loss=0.00023 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.434 | L2-Norm(final)=13.091 | 4390.9 samples/s | 68.6 steps/s
[Step=17900 Epoch=168.7] | Loss=0.00022 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=13.091 | 1546.6 samples/s | 24.2 steps/s
[Step=17950 Epoch=169.1] | Loss=0.00021 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.417 | L2-Norm(final)=13.091 | 4479.9 samples/s | 70.0 steps/s
[Step=18000 Epoch=169.6] | Loss=0.00021 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.409 | L2-Norm(final)=13.092 | 1556.9 samples/s | 24.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_3/client_state-step18000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09548 | acc=0.9602 | tpr=0.9735 | fpr=0.0686 | 4635.1 samples/s | 18.1 steps/s
Avg test loss: 0.10027, Avg test acc: 0.95829, Avg tpr: 0.97249, Avg fpr: 0.07294, total FA: 569

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09862 | acc=0.9585 | tpr=0.9754 | fpr=0.0780 | 4730.7 samples/s | 18.5 steps/s
Avg test loss: 0.10234, Avg test acc: 0.95769, Avg tpr: 0.97540, Avg fpr: 0.08127, total FA: 634

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11102 | acc=0.9488 | tpr=0.9604 | fpr=0.0763 | 4429.8 samples/s | 17.3 steps/s
Avg test loss: 0.11593, Avg test acc: 0.94883, Avg tpr: 0.95978, Avg fpr: 0.07525, total FA: 587

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09850 | acc=0.9577 | tpr=0.9621 | fpr=0.0518 | 4598.5 samples/s | 18.0 steps/s
Avg test loss: 0.10378, Avg test acc: 0.95725, Avg tpr: 0.96241, Avg fpr: 0.05410, total FA: 422

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08866 | acc=0.9602 | tpr=0.9658 | fpr=0.0518 | 4668.9 samples/s | 18.2 steps/s
Avg test loss: 0.09597, Avg test acc: 0.95821, Avg tpr: 0.96427, Avg fpr: 0.05512, total FA: 430

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.88346 | acc=0.3045 | tpr=0.0098 | fpr=0.0557 | 4776.2 samples/s | 18.7 steps/s
Avg test loss: 4.90352, Avg test acc: 0.30175, Avg tpr: 0.00915, Avg fpr: 0.05474, total FA: 427

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.64086 | acc=0.2929 | tpr=0.0163 | fpr=0.1065 | 4535.5 samples/s | 17.7 steps/s
Avg test loss: 4.66168, Avg test acc: 0.29061, Avg tpr: 0.01615, Avg fpr: 0.10576, total FA: 825

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.37308 | acc=0.2890 | tpr=0.0208 | fpr=0.1286 | 4828.1 samples/s | 18.9 steps/s
Avg test loss: 4.39895, Avg test acc: 0.28768, Avg tpr: 0.02116, Avg fpr: 0.12614, total FA: 984

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.13278 | acc=0.3139 | tpr=0.0298 | fpr=0.0691 | 4756.9 samples/s | 18.6 steps/s
Avg test loss: 4.15146, Avg test acc: 0.31184, Avg tpr: 0.02996, Avg fpr: 0.06820, total FA: 532

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.70606 | acc=0.3113 | tpr=0.0080 | fpr=0.0302 | 4648.6 samples/s | 18.2 steps/s
Avg test loss: 4.73503, Avg test acc: 0.30824, Avg tpr: 0.00723, Avg fpr: 0.02974, total FA: 232

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.27347 | acc=0.1276 | tpr=0.7522 | fpr=0.8836 | 4610.4 samples/s | 18.0 steps/s
[Step= 100] | Loss=6.24091 | acc=0.1289 | tpr=0.7249 | fpr=0.8823 | 8294.6 samples/s | 32.4 steps/s
[Step= 150] | Loss=6.24382 | acc=0.1296 | tpr=0.7262 | fpr=0.8814 | 7937.1 samples/s | 31.0 steps/s
[Step= 200] | Loss=6.23239 | acc=0.1300 | tpr=0.7366 | fpr=0.8810 | 7783.8 samples/s | 30.4 steps/s
[Step= 250] | Loss=6.23270 | acc=0.1302 | tpr=0.7319 | fpr=0.8808 | 8160.0 samples/s | 31.9 steps/s
[Step= 300] | Loss=6.22408 | acc=0.1307 | tpr=0.7316 | fpr=0.8803 | 7647.0 samples/s | 29.9 steps/s
[Step= 350] | Loss=6.23134 | acc=0.1305 | tpr=0.7364 | fpr=0.8805 | 8244.9 samples/s | 32.2 steps/s
[Step= 400] | Loss=6.23069 | acc=0.1303 | tpr=0.7319 | fpr=0.8806 | 8090.5 samples/s | 31.6 steps/s
[Step= 450] | Loss=6.22787 | acc=0.1300 | tpr=0.7298 | fpr=0.8809 | 8299.6 samples/s | 32.4 steps/s
[Step= 500] | Loss=6.22879 | acc=0.1301 | tpr=0.7264 | fpr=0.8806 | 8066.6 samples/s | 31.5 steps/s
[Step= 550] | Loss=6.22639 | acc=0.1305 | tpr=0.7306 | fpr=0.8804 | 9244.5 samples/s | 36.1 steps/s
Avg test loss: 6.22700, Avg test acc: 0.13046, Avg tpr: 0.73019, Avg fpr: 0.88044, total FA: 122247

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.38612 | acc=0.1175 | tpr=0.7655 | fpr=0.8941 | 4535.3 samples/s | 17.7 steps/s
[Step= 100] | Loss=6.36729 | acc=0.1193 | tpr=0.7335 | fpr=0.8921 | 8072.5 samples/s | 31.5 steps/s
[Step= 150] | Loss=6.36866 | acc=0.1201 | tpr=0.7378 | fpr=0.8912 | 8280.8 samples/s | 32.3 steps/s
[Step= 200] | Loss=6.35815 | acc=0.1202 | tpr=0.7322 | fpr=0.8909 | 7999.8 samples/s | 31.2 steps/s
[Step= 250] | Loss=6.35661 | acc=0.1210 | tpr=0.7371 | fpr=0.8902 | 7715.3 samples/s | 30.1 steps/s
[Step= 300] | Loss=6.35379 | acc=0.1212 | tpr=0.7396 | fpr=0.8901 | 8194.3 samples/s | 32.0 steps/s
[Step= 350] | Loss=6.36134 | acc=0.1211 | tpr=0.7420 | fpr=0.8902 | 7576.8 samples/s | 29.6 steps/s
[Step= 400] | Loss=6.36428 | acc=0.1209 | tpr=0.7429 | fpr=0.8904 | 8230.3 samples/s | 32.1 steps/s
[Step= 450] | Loss=6.36319 | acc=0.1209 | tpr=0.7410 | fpr=0.8904 | 7687.8 samples/s | 30.0 steps/s
[Step= 500] | Loss=6.36444 | acc=0.1210 | tpr=0.7339 | fpr=0.8901 | 8495.5 samples/s | 33.2 steps/s
[Step= 550] | Loss=6.36248 | acc=0.1212 | tpr=0.7390 | fpr=0.8901 | 9966.1 samples/s | 38.9 steps/s
Avg test loss: 6.36382, Avg test acc: 0.12106, Avg tpr: 0.73851, Avg fpr: 0.89017, total FA: 123598

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.85306 | acc=0.1357 | tpr=0.7920 | fpr=0.8761 | 4602.2 samples/s | 18.0 steps/s
[Step= 100] | Loss=5.82866 | acc=0.1381 | tpr=0.7527 | fpr=0.8733 | 7944.0 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.83928 | acc=0.1396 | tpr=0.7622 | fpr=0.8719 | 8277.2 samples/s | 32.3 steps/s
[Step= 200] | Loss=5.82199 | acc=0.1404 | tpr=0.7628 | fpr=0.8709 | 7857.6 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.81661 | acc=0.1410 | tpr=0.7555 | fpr=0.8702 | 7937.5 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.80871 | acc=0.1411 | tpr=0.7593 | fpr=0.8702 | 7458.2 samples/s | 29.1 steps/s
[Step= 350] | Loss=5.82031 | acc=0.1403 | tpr=0.7564 | fpr=0.8709 | 8506.0 samples/s | 33.2 steps/s
[Step= 400] | Loss=5.82266 | acc=0.1402 | tpr=0.7571 | fpr=0.8710 | 7750.4 samples/s | 30.3 steps/s
[Step= 450] | Loss=5.81925 | acc=0.1406 | tpr=0.7551 | fpr=0.8705 | 8222.4 samples/s | 32.1 steps/s
[Step= 500] | Loss=5.81900 | acc=0.1409 | tpr=0.7537 | fpr=0.8701 | 7415.1 samples/s | 29.0 steps/s
[Step= 550] | Loss=5.81889 | acc=0.1409 | tpr=0.7537 | fpr=0.8702 | 11143.4 samples/s | 43.5 steps/s
Avg test loss: 5.81926, Avg test acc: 0.14081, Avg tpr: 0.75238, Avg fpr: 0.87030, total FA: 120840

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.32091 | acc=0.1559 | tpr=0.7566 | fpr=0.8549 | 4701.2 samples/s | 18.4 steps/s
[Step= 100] | Loss=6.28044 | acc=0.1573 | tpr=0.7548 | fpr=0.8539 | 7819.8 samples/s | 30.5 steps/s
[Step= 150] | Loss=6.28549 | acc=0.1587 | tpr=0.7464 | fpr=0.8521 | 7658.0 samples/s | 29.9 steps/s
[Step= 200] | Loss=6.27148 | acc=0.1591 | tpr=0.7355 | fpr=0.8513 | 7189.0 samples/s | 28.1 steps/s
[Step= 250] | Loss=6.26773 | acc=0.1599 | tpr=0.7389 | fpr=0.8506 | 8301.9 samples/s | 32.4 steps/s
[Step= 300] | Loss=6.26166 | acc=0.1604 | tpr=0.7367 | fpr=0.8501 | 8281.6 samples/s | 32.3 steps/s
[Step= 350] | Loss=6.27308 | acc=0.1598 | tpr=0.7420 | fpr=0.8508 | 7813.0 samples/s | 30.5 steps/s
[Step= 400] | Loss=6.27349 | acc=0.1597 | tpr=0.7380 | fpr=0.8508 | 8133.8 samples/s | 31.8 steps/s
[Step= 450] | Loss=6.27088 | acc=0.1598 | tpr=0.7361 | fpr=0.8506 | 7981.2 samples/s | 31.2 steps/s
[Step= 500] | Loss=6.27269 | acc=0.1599 | tpr=0.7361 | fpr=0.8506 | 7996.3 samples/s | 31.2 steps/s
[Step= 550] | Loss=6.27266 | acc=0.1601 | tpr=0.7370 | fpr=0.8504 | 11148.6 samples/s | 43.5 steps/s
Avg test loss: 6.27446, Avg test acc: 0.15999, Avg tpr: 0.73693, Avg fpr: 0.85050, total FA: 118090

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.57024 | acc=0.1502 | tpr=0.7257 | fpr=0.8602 | 4540.0 samples/s | 17.7 steps/s
[Step= 100] | Loss=5.54961 | acc=0.1528 | tpr=0.6972 | fpr=0.8574 | 7935.0 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.55481 | acc=0.1542 | tpr=0.7061 | fpr=0.8559 | 8310.8 samples/s | 32.5 steps/s
[Step= 200] | Loss=5.54803 | acc=0.1542 | tpr=0.7038 | fpr=0.8558 | 7870.8 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.54646 | acc=0.1547 | tpr=0.7048 | fpr=0.8553 | 7828.4 samples/s | 30.6 steps/s
[Step= 300] | Loss=5.54246 | acc=0.1552 | tpr=0.7098 | fpr=0.8549 | 7923.2 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.55099 | acc=0.1549 | tpr=0.7132 | fpr=0.8552 | 8264.2 samples/s | 32.3 steps/s
[Step= 400] | Loss=5.55146 | acc=0.1547 | tpr=0.7084 | fpr=0.8554 | 8111.8 samples/s | 31.7 steps/s
[Step= 450] | Loss=5.54998 | acc=0.1548 | tpr=0.7020 | fpr=0.8551 | 8219.1 samples/s | 32.1 steps/s
[Step= 500] | Loss=5.55480 | acc=0.1548 | tpr=0.7004 | fpr=0.8551 | 7789.0 samples/s | 30.4 steps/s
[Step= 550] | Loss=5.55394 | acc=0.1553 | tpr=0.7027 | fpr=0.8547 | 9900.8 samples/s | 38.7 steps/s
Avg test loss: 5.55460, Avg test acc: 0.15517, Avg tpr: 0.70166, Avg fpr: 0.85476, total FA: 118682

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.16279 | acc=0.9619 | tpr=0.9381 | fpr=0.0377 | 4634.2 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.16664 | acc=0.9600 | tpr=0.9254 | fpr=0.0394 | 7725.5 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.16966 | acc=0.9591 | tpr=0.9308 | fpr=0.0404 | 7867.8 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.17006 | acc=0.9596 | tpr=0.9388 | fpr=0.0401 | 7965.8 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.17138 | acc=0.9593 | tpr=0.9389 | fpr=0.0403 | 8314.5 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.17312 | acc=0.9586 | tpr=0.9367 | fpr=0.0410 | 7615.8 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.17355 | acc=0.9586 | tpr=0.9374 | fpr=0.0410 | 8385.0 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.17448 | acc=0.9584 | tpr=0.9365 | fpr=0.0412 | 7711.5 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.17559 | acc=0.9582 | tpr=0.9333 | fpr=0.0414 | 8177.0 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.17511 | acc=0.9581 | tpr=0.9344 | fpr=0.0414 | 7722.2 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.17495 | acc=0.9583 | tpr=0.9331 | fpr=0.0413 | 11056.8 samples/s | 43.2 steps/s
Avg test loss: 0.17461, Avg test acc: 0.95829, Avg tpr: 0.93265, Avg fpr: 0.04125, total FA: 5727

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14610 | acc=0.9638 | tpr=0.9381 | fpr=0.0357 | 4636.9 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.14977 | acc=0.9630 | tpr=0.9296 | fpr=0.0364 | 7858.3 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.15161 | acc=0.9621 | tpr=0.9280 | fpr=0.0373 | 7868.9 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.15176 | acc=0.9624 | tpr=0.9333 | fpr=0.0370 | 7986.6 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.15309 | acc=0.9621 | tpr=0.9328 | fpr=0.0374 | 7841.5 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.15360 | acc=0.9618 | tpr=0.9345 | fpr=0.0377 | 8132.1 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.15346 | acc=0.9618 | tpr=0.9361 | fpr=0.0377 | 7201.8 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.15478 | acc=0.9615 | tpr=0.9316 | fpr=0.0380 | 8169.6 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.15495 | acc=0.9613 | tpr=0.9304 | fpr=0.0381 | 8268.8 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.15476 | acc=0.9614 | tpr=0.9322 | fpr=0.0381 | 8127.2 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.15476 | acc=0.9615 | tpr=0.9300 | fpr=0.0380 | 11918.9 samples/s | 46.6 steps/s
Avg test loss: 0.15440, Avg test acc: 0.96149, Avg tpr: 0.93027, Avg fpr: 0.03794, total FA: 5268

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.18877 | acc=0.9611 | tpr=0.9513 | fpr=0.0387 | 4797.1 samples/s | 18.7 steps/s
[Step= 100] | Loss=0.19815 | acc=0.9601 | tpr=0.9488 | fpr=0.0397 | 7908.0 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.20415 | acc=0.9587 | tpr=0.9467 | fpr=0.0410 | 7629.7 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.20521 | acc=0.9585 | tpr=0.9530 | fpr=0.0414 | 8538.2 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.20652 | acc=0.9582 | tpr=0.9528 | fpr=0.0417 | 7595.8 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.20817 | acc=0.9577 | tpr=0.9520 | fpr=0.0422 | 7904.7 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.20953 | acc=0.9577 | tpr=0.9524 | fpr=0.0422 | 8431.2 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.21113 | acc=0.9573 | tpr=0.9513 | fpr=0.0426 | 8093.6 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.21213 | acc=0.9569 | tpr=0.9494 | fpr=0.0429 | 7939.6 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.21151 | acc=0.9570 | tpr=0.9507 | fpr=0.0429 | 7734.3 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.21073 | acc=0.9572 | tpr=0.9495 | fpr=0.0427 | 9819.6 samples/s | 38.4 steps/s
Avg test loss: 0.21047, Avg test acc: 0.95717, Avg tpr: 0.94929, Avg fpr: 0.04269, total FA: 5927

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14205 | acc=0.9613 | tpr=0.9425 | fpr=0.0383 | 4702.9 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.14441 | acc=0.9614 | tpr=0.9424 | fpr=0.0382 | 7871.5 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.14905 | acc=0.9602 | tpr=0.9424 | fpr=0.0395 | 7926.9 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.15025 | acc=0.9602 | tpr=0.9464 | fpr=0.0395 | 8017.3 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.15121 | acc=0.9601 | tpr=0.9450 | fpr=0.0396 | 7836.9 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.15277 | acc=0.9597 | tpr=0.9425 | fpr=0.0399 | 8119.7 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.15371 | acc=0.9596 | tpr=0.9418 | fpr=0.0401 | 8123.2 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.15530 | acc=0.9594 | tpr=0.9393 | fpr=0.0402 | 7256.4 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.15541 | acc=0.9592 | tpr=0.9387 | fpr=0.0404 | 8294.4 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.15480 | acc=0.9593 | tpr=0.9405 | fpr=0.0404 | 8407.9 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.15439 | acc=0.9594 | tpr=0.9371 | fpr=0.0402 | 9689.5 samples/s | 37.8 steps/s
Avg test loss: 0.15414, Avg test acc: 0.95945, Avg tpr: 0.93740, Avg fpr: 0.04015, total FA: 5575

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.20357 | acc=0.9570 | tpr=0.9027 | fpr=0.0420 | 4659.7 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.21095 | acc=0.9563 | tpr=0.9147 | fpr=0.0430 | 7877.7 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.21397 | acc=0.9554 | tpr=0.9236 | fpr=0.0441 | 7725.8 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.21490 | acc=0.9553 | tpr=0.9268 | fpr=0.0442 | 7866.1 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.21734 | acc=0.9549 | tpr=0.9284 | fpr=0.0446 | 7091.1 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.21962 | acc=0.9544 | tpr=0.9287 | fpr=0.0451 | 8342.3 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.21962 | acc=0.9545 | tpr=0.9299 | fpr=0.0450 | 8459.9 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.22105 | acc=0.9542 | tpr=0.9261 | fpr=0.0453 | 8121.7 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.22237 | acc=0.9539 | tpr=0.9270 | fpr=0.0456 | 7755.0 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.22317 | acc=0.9537 | tpr=0.9282 | fpr=0.0459 | 8248.9 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.22238 | acc=0.9538 | tpr=0.9256 | fpr=0.0457 | 10828.7 samples/s | 42.3 steps/s
Avg test loss: 0.22197, Avg test acc: 0.95384, Avg tpr: 0.92552, Avg fpr: 0.04565, total FA: 6338

server round 24/50

clients selected: [0 1 3 4 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=36001 Epoch=175.5] | Loss=0.00813 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=13.604 | 3211.1 samples/s | 50.2 steps/s
[Step=36050 Epoch=175.8] | Loss=0.02852 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=13.596 | 4786.5 samples/s | 74.8 steps/s
[Step=36100 Epoch=176.0] | Loss=0.03015 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.433 | L2-Norm(final)=13.587 | 5606.7 samples/s | 87.6 steps/s
[Step=36150 Epoch=176.3] | Loss=0.02785 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=13.579 | 5376.3 samples/s | 84.0 steps/s
[Step=36200 Epoch=176.5] | Loss=0.02756 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.433 | L2-Norm(final)=13.577 | 8421.7 samples/s | 131.6 steps/s
[Step=36250 Epoch=176.8] | Loss=0.02727 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=13.574 | 1467.4 samples/s | 22.9 steps/s
[Step=36300 Epoch=177.0] | Loss=0.02685 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=13.572 | 5512.7 samples/s | 86.1 steps/s
[Step=36350 Epoch=177.2] | Loss=0.02750 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=13.571 | 5353.7 samples/s | 83.7 steps/s
[Step=36400 Epoch=177.5] | Loss=0.02748 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=13.569 | 7632.8 samples/s | 119.3 steps/s
[Step=36450 Epoch=177.7] | Loss=0.02738 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.433 | L2-Norm(final)=13.567 | 1541.0 samples/s | 24.1 steps/s
[Step=36500 Epoch=178.0] | Loss=0.02736 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=13.565 | 5339.9 samples/s | 83.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=36501 Epoch=178.0] | Loss=0.04285 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=13.547 | 3198.4 samples/s | 50.0 steps/s
[Step=36550 Epoch=178.2] | Loss=0.02663 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.457 | L2-Norm(final)=13.542 | 4212.3 samples/s | 65.8 steps/s
[Step=36600 Epoch=178.5] | Loss=0.02816 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.487 | L2-Norm(final)=13.538 | 4698.9 samples/s | 73.4 steps/s
[Step=36650 Epoch=178.7] | Loss=0.02706 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.513 | L2-Norm(final)=13.534 | 4678.9 samples/s | 73.1 steps/s
[Step=36700 Epoch=179.0] | Loss=0.02523 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.533 | L2-Norm(final)=13.531 | 6782.1 samples/s | 106.0 steps/s
[Step=36750 Epoch=179.2] | Loss=0.02186 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.550 | L2-Norm(final)=13.532 | 1400.0 samples/s | 21.9 steps/s
[Step=36800 Epoch=179.4] | Loss=0.01967 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.564 | L2-Norm(final)=13.534 | 4700.4 samples/s | 73.4 steps/s
[Step=36850 Epoch=179.7] | Loss=0.01849 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.576 | L2-Norm(final)=13.536 | 4722.9 samples/s | 73.8 steps/s
[Step=36900 Epoch=179.9] | Loss=0.01764 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.586 | L2-Norm(final)=13.538 | 6094.5 samples/s | 95.2 steps/s
[Step=36950 Epoch=180.2] | Loss=0.01658 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.595 | L2-Norm(final)=13.540 | 1448.7 samples/s | 22.6 steps/s
[Step=37000 Epoch=180.4] | Loss=0.01553 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.603 | L2-Norm(final)=13.541 | 4683.9 samples/s | 73.2 steps/s
[Step=37050 Epoch=180.7] | Loss=0.01480 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.611 | L2-Norm(final)=13.544 | 4689.2 samples/s | 73.3 steps/s
[Step=37100 Epoch=180.9] | Loss=0.01393 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.617 | L2-Norm(final)=13.546 | 5609.0 samples/s | 87.6 steps/s
[Step=37150 Epoch=181.2] | Loss=0.01329 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.624 | L2-Norm(final)=13.548 | 1497.5 samples/s | 23.4 steps/s
[Step=37200 Epoch=181.4] | Loss=0.01278 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.629 | L2-Norm(final)=13.551 | 4624.1 samples/s | 72.3 steps/s
[Step=37250 Epoch=181.6] | Loss=0.01211 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.635 | L2-Norm(final)=13.553 | 4690.0 samples/s | 73.3 steps/s
[Step=37300 Epoch=181.9] | Loss=0.01160 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.640 | L2-Norm(final)=13.556 | 5160.5 samples/s | 80.6 steps/s
[Step=37350 Epoch=182.1] | Loss=0.01122 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.644 | L2-Norm(final)=13.558 | 1511.7 samples/s | 23.6 steps/s
[Step=37400 Epoch=182.4] | Loss=0.01085 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.648 | L2-Norm(final)=13.560 | 4784.2 samples/s | 74.8 steps/s
[Step=37450 Epoch=182.6] | Loss=0.01057 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.653 | L2-Norm(final)=13.563 | 4549.9 samples/s | 71.1 steps/s
[Step=37500 Epoch=182.9] | Loss=0.01041 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.656 | L2-Norm(final)=13.565 | 4859.0 samples/s | 75.9 steps/s
[Step=37550 Epoch=183.1] | Loss=0.01013 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.660 | L2-Norm(final)=13.567 | 1559.4 samples/s | 24.4 steps/s
[Step=37600 Epoch=183.3] | Loss=0.00986 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.663 | L2-Norm(final)=13.568 | 4644.7 samples/s | 72.6 steps/s
[Step=37650 Epoch=183.6] | Loss=0.00967 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.667 | L2-Norm(final)=13.570 | 4721.8 samples/s | 73.8 steps/s
[Step=37700 Epoch=183.8] | Loss=0.00942 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=13.572 | 4675.8 samples/s | 73.1 steps/s
[Step=37750 Epoch=184.1] | Loss=0.00918 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.673 | L2-Norm(final)=13.574 | 1554.3 samples/s | 24.3 steps/s
[Step=37800 Epoch=184.3] | Loss=0.00897 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.676 | L2-Norm(final)=13.575 | 4642.9 samples/s | 72.5 steps/s
[Step=37850 Epoch=184.6] | Loss=0.00883 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.679 | L2-Norm(final)=13.577 | 4654.8 samples/s | 72.7 steps/s
[Step=37900 Epoch=184.8] | Loss=0.00862 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=13.579 | 4708.4 samples/s | 73.6 steps/s
[Step=37950 Epoch=185.1] | Loss=0.00852 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.685 | L2-Norm(final)=13.581 | 1553.6 samples/s | 24.3 steps/s
[Step=38000 Epoch=185.3] | Loss=0.00836 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.688 | L2-Norm(final)=13.583 | 4695.0 samples/s | 73.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step38000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=107.4] | Loss=0.04225 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=11.928 | 3208.1 samples/s | 50.1 steps/s
[Step=22050 Epoch=107.6] | Loss=0.03029 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.433 | L2-Norm(final)=11.926 | 4843.7 samples/s | 75.7 steps/s
[Step=22100 Epoch=107.8] | Loss=0.03196 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.433 | L2-Norm(final)=11.922 | 5407.4 samples/s | 84.5 steps/s
[Step=22150 Epoch=108.1] | Loss=0.03117 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.433 | L2-Norm(final)=11.916 | 5473.1 samples/s | 85.5 steps/s
[Step=22200 Epoch=108.3] | Loss=0.02981 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.433 | L2-Norm(final)=11.912 | 8608.4 samples/s | 134.5 steps/s
[Step=22250 Epoch=108.6] | Loss=0.02885 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.433 | L2-Norm(final)=11.909 | 1510.5 samples/s | 23.6 steps/s
[Step=22300 Epoch=108.8] | Loss=0.02909 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=11.908 | 5461.3 samples/s | 85.3 steps/s
[Step=22350 Epoch=109.1] | Loss=0.02950 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=11.907 | 5318.5 samples/s | 83.1 steps/s
[Step=22400 Epoch=109.3] | Loss=0.02948 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=11.904 | 7819.6 samples/s | 122.2 steps/s
[Step=22450 Epoch=109.5] | Loss=0.02936 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.433 | L2-Norm(final)=11.901 | 1503.0 samples/s | 23.5 steps/s
[Step=22500 Epoch=109.8] | Loss=0.02969 | Reg=0.00131 | acc=0.9375 | L2-Norm=11.433 | L2-Norm(final)=11.898 | 5386.7 samples/s | 84.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=109.8] | Loss=0.02738 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=11.860 | 3160.7 samples/s | 49.4 steps/s
[Step=22550 Epoch=110.0] | Loss=0.03657 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.469 | L2-Norm(final)=11.849 | 4288.6 samples/s | 67.0 steps/s
[Step=22600 Epoch=110.3] | Loss=0.03202 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.499 | L2-Norm(final)=11.838 | 4679.0 samples/s | 73.1 steps/s
[Step=22650 Epoch=110.5] | Loss=0.02941 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.525 | L2-Norm(final)=11.835 | 4717.4 samples/s | 73.7 steps/s
[Step=22700 Epoch=110.8] | Loss=0.02797 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.546 | L2-Norm(final)=11.835 | 6785.7 samples/s | 106.0 steps/s
[Step=22750 Epoch=111.0] | Loss=0.02478 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.564 | L2-Norm(final)=11.837 | 1406.3 samples/s | 22.0 steps/s
[Step=22800 Epoch=111.3] | Loss=0.02252 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.580 | L2-Norm(final)=11.839 | 4644.9 samples/s | 72.6 steps/s
[Step=22850 Epoch=111.5] | Loss=0.02054 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.594 | L2-Norm(final)=11.843 | 4700.4 samples/s | 73.4 steps/s
[Step=22900 Epoch=111.7] | Loss=0.01920 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.606 | L2-Norm(final)=11.847 | 6180.2 samples/s | 96.6 steps/s
[Step=22950 Epoch=112.0] | Loss=0.01766 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.616 | L2-Norm(final)=11.850 | 1448.4 samples/s | 22.6 steps/s
[Step=23000 Epoch=112.2] | Loss=0.01651 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.626 | L2-Norm(final)=11.854 | 4709.6 samples/s | 73.6 steps/s
[Step=23050 Epoch=112.5] | Loss=0.01569 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.635 | L2-Norm(final)=11.858 | 4709.1 samples/s | 73.6 steps/s
[Step=23100 Epoch=112.7] | Loss=0.01500 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.642 | L2-Norm(final)=11.861 | 5771.9 samples/s | 90.2 steps/s
[Step=23150 Epoch=113.0] | Loss=0.01413 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.649 | L2-Norm(final)=11.864 | 1456.0 samples/s | 22.7 steps/s
[Step=23200 Epoch=113.2] | Loss=0.01344 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=11.867 | 4682.9 samples/s | 73.2 steps/s
[Step=23250 Epoch=113.4] | Loss=0.01298 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.661 | L2-Norm(final)=11.870 | 4663.9 samples/s | 72.9 steps/s
[Step=23300 Epoch=113.7] | Loss=0.01242 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.666 | L2-Norm(final)=11.874 | 5453.4 samples/s | 85.2 steps/s
[Step=23350 Epoch=113.9] | Loss=0.01197 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.672 | L2-Norm(final)=11.877 | 1495.0 samples/s | 23.4 steps/s
[Step=23400 Epoch=114.2] | Loss=0.01153 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.677 | L2-Norm(final)=11.880 | 4705.6 samples/s | 73.5 steps/s
[Step=23450 Epoch=114.4] | Loss=0.01113 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=11.883 | 4692.6 samples/s | 73.3 steps/s
[Step=23500 Epoch=114.7] | Loss=0.01075 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.686 | L2-Norm(final)=11.887 | 5115.7 samples/s | 79.9 steps/s
[Step=23550 Epoch=114.9] | Loss=0.01045 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.691 | L2-Norm(final)=11.890 | 1518.5 samples/s | 23.7 steps/s
[Step=23600 Epoch=115.2] | Loss=0.01012 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.695 | L2-Norm(final)=11.893 | 4728.6 samples/s | 73.9 steps/s
[Step=23650 Epoch=115.4] | Loss=0.00989 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.699 | L2-Norm(final)=11.896 | 4728.4 samples/s | 73.9 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00963 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.703 | L2-Norm(final)=11.899 | 4730.2 samples/s | 73.9 steps/s
[Step=23750 Epoch=115.9] | Loss=0.00942 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.707 | L2-Norm(final)=11.901 | 1517.8 samples/s | 23.7 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00921 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.711 | L2-Norm(final)=11.904 | 4714.2 samples/s | 73.7 steps/s
[Step=23850 Epoch=116.4] | Loss=0.00900 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.714 | L2-Norm(final)=11.907 | 4700.4 samples/s | 73.4 steps/s
[Step=23900 Epoch=116.6] | Loss=0.00880 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.718 | L2-Norm(final)=11.910 | 4669.2 samples/s | 73.0 steps/s
[Step=23950 Epoch=116.9] | Loss=0.00862 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.721 | L2-Norm(final)=11.912 | 1541.3 samples/s | 24.1 steps/s
[Step=24000 Epoch=117.1] | Loss=0.00841 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.725 | L2-Norm(final)=11.915 | 4654.8 samples/s | 72.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_1/client_state-step24000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=30001 Epoch=146.3] | Loss=0.03405 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.433 | L2-Norm(final)=14.598 | 3018.6 samples/s | 47.2 steps/s
[Step=30050 Epoch=146.5] | Loss=0.02498 | Reg=0.00131 | acc=0.9375 | L2-Norm=11.434 | L2-Norm(final)=14.599 | 5281.5 samples/s | 82.5 steps/s
[Step=30100 Epoch=146.8] | Loss=0.02678 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.434 | L2-Norm(final)=14.597 | 5434.8 samples/s | 84.9 steps/s
[Step=30150 Epoch=147.0] | Loss=0.02663 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.434 | L2-Norm(final)=14.597 | 5434.0 samples/s | 84.9 steps/s
[Step=30200 Epoch=147.3] | Loss=0.02520 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.434 | L2-Norm(final)=14.597 | 8583.5 samples/s | 134.1 steps/s
[Step=30250 Epoch=147.5] | Loss=0.02506 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.434 | L2-Norm(final)=14.597 | 1501.9 samples/s | 23.5 steps/s
[Step=30300 Epoch=147.8] | Loss=0.02576 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.434 | L2-Norm(final)=14.596 | 5423.2 samples/s | 84.7 steps/s
[Step=30350 Epoch=148.0] | Loss=0.02543 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.434 | L2-Norm(final)=14.596 | 5373.7 samples/s | 84.0 steps/s
[Step=30400 Epoch=148.2] | Loss=0.02497 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.434 | L2-Norm(final)=14.596 | 7645.0 samples/s | 119.5 steps/s
[Step=30450 Epoch=148.5] | Loss=0.02449 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.434 | L2-Norm(final)=14.596 | 1511.9 samples/s | 23.6 steps/s
[Step=30500 Epoch=148.7] | Loss=0.02497 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.434 | L2-Norm(final)=14.598 | 5588.4 samples/s | 87.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=30501 Epoch=148.7] | Loss=0.00907 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.434 | L2-Norm(final)=14.609 | 3192.1 samples/s | 49.9 steps/s
[Step=30550 Epoch=149.0] | Loss=0.02372 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.464 | L2-Norm(final)=14.608 | 4279.1 samples/s | 66.9 steps/s
[Step=30600 Epoch=149.2] | Loss=0.02553 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.497 | L2-Norm(final)=14.604 | 4624.1 samples/s | 72.3 steps/s
[Step=30650 Epoch=149.5] | Loss=0.02567 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.524 | L2-Norm(final)=14.598 | 4695.2 samples/s | 73.4 steps/s
[Step=30700 Epoch=149.7] | Loss=0.02442 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.545 | L2-Norm(final)=14.595 | 6738.5 samples/s | 105.3 steps/s
[Step=30750 Epoch=150.0] | Loss=0.02116 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.563 | L2-Norm(final)=14.595 | 1427.7 samples/s | 22.3 steps/s
[Step=30800 Epoch=150.2] | Loss=0.01915 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.578 | L2-Norm(final)=14.597 | 4693.8 samples/s | 73.3 steps/s
[Step=30850 Epoch=150.4] | Loss=0.01755 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.590 | L2-Norm(final)=14.600 | 4695.0 samples/s | 73.4 steps/s
[Step=30900 Epoch=150.7] | Loss=0.01642 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.601 | L2-Norm(final)=14.602 | 6089.1 samples/s | 95.1 steps/s
[Step=30950 Epoch=150.9] | Loss=0.01531 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.611 | L2-Norm(final)=14.605 | 1456.4 samples/s | 22.8 steps/s
[Step=31000 Epoch=151.2] | Loss=0.01426 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.620 | L2-Norm(final)=14.608 | 4782.5 samples/s | 74.7 steps/s
[Step=31050 Epoch=151.4] | Loss=0.01342 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.627 | L2-Norm(final)=14.611 | 4608.1 samples/s | 72.0 steps/s
[Step=31100 Epoch=151.7] | Loss=0.01283 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.634 | L2-Norm(final)=14.613 | 5628.6 samples/s | 87.9 steps/s
[Step=31150 Epoch=151.9] | Loss=0.01222 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.640 | L2-Norm(final)=14.616 | 1468.2 samples/s | 22.9 steps/s
[Step=31200 Epoch=152.1] | Loss=0.01153 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.645 | L2-Norm(final)=14.618 | 4647.5 samples/s | 72.6 steps/s
[Step=31250 Epoch=152.4] | Loss=0.01109 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.650 | L2-Norm(final)=14.621 | 4748.7 samples/s | 74.2 steps/s
[Step=31300 Epoch=152.6] | Loss=0.01063 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=14.624 | 5140.0 samples/s | 80.3 steps/s
[Step=31350 Epoch=152.9] | Loss=0.01020 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.660 | L2-Norm(final)=14.627 | 1502.9 samples/s | 23.5 steps/s
[Step=31400 Epoch=153.1] | Loss=0.00983 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.664 | L2-Norm(final)=14.630 | 4749.1 samples/s | 74.2 steps/s
[Step=31450 Epoch=153.4] | Loss=0.00963 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.668 | L2-Norm(final)=14.632 | 4624.9 samples/s | 72.3 steps/s
[Step=31500 Epoch=153.6] | Loss=0.00935 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.672 | L2-Norm(final)=14.635 | 4863.5 samples/s | 76.0 steps/s
[Step=31550 Epoch=153.9] | Loss=0.00914 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.676 | L2-Norm(final)=14.637 | 1583.9 samples/s | 24.7 steps/s
[Step=31600 Epoch=154.1] | Loss=0.00885 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.679 | L2-Norm(final)=14.639 | 4669.8 samples/s | 73.0 steps/s
[Step=31650 Epoch=154.3] | Loss=0.00866 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=14.642 | 4675.3 samples/s | 73.1 steps/s
[Step=31700 Epoch=154.6] | Loss=0.00842 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.686 | L2-Norm(final)=14.644 | 4715.8 samples/s | 73.7 steps/s
[Step=31750 Epoch=154.8] | Loss=0.00824 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.689 | L2-Norm(final)=14.647 | 1531.8 samples/s | 23.9 steps/s
[Step=31800 Epoch=155.1] | Loss=0.00810 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.692 | L2-Norm(final)=14.649 | 4665.5 samples/s | 72.9 steps/s
[Step=31850 Epoch=155.3] | Loss=0.00788 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.695 | L2-Norm(final)=14.651 | 4681.4 samples/s | 73.1 steps/s
[Step=31900 Epoch=155.6] | Loss=0.00770 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.698 | L2-Norm(final)=14.653 | 4666.0 samples/s | 72.9 steps/s
[Step=31950 Epoch=155.8] | Loss=0.00757 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.701 | L2-Norm(final)=14.656 | 1560.7 samples/s | 24.4 steps/s
[Step=32000 Epoch=156.0] | Loss=0.00742 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.703 | L2-Norm(final)=14.658 | 4753.3 samples/s | 74.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step32000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=14001 Epoch=68.7] | Loss=0.02352 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=11.031 | 3154.6 samples/s | 49.3 steps/s
[Step=14050 Epoch=68.9] | Loss=0.02664 | Reg=0.00131 | acc=0.9531 | L2-Norm=11.433 | L2-Norm(final)=11.035 | 4986.5 samples/s | 77.9 steps/s
[Step=14100 Epoch=69.1] | Loss=0.02676 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=11.043 | 5463.6 samples/s | 85.4 steps/s
[Step=14150 Epoch=69.4] | Loss=0.02709 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=11.049 | 5356.7 samples/s | 83.7 steps/s
[Step=14200 Epoch=69.6] | Loss=0.02668 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=11.053 | 8836.2 samples/s | 138.1 steps/s
[Step=14250 Epoch=69.9] | Loss=0.02691 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=11.058 | 1469.7 samples/s | 23.0 steps/s
[Step=14300 Epoch=70.1] | Loss=0.02711 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=11.062 | 5465.3 samples/s | 85.4 steps/s
[Step=14350 Epoch=70.4] | Loss=0.02630 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=11.067 | 5490.7 samples/s | 85.8 steps/s
[Step=14400 Epoch=70.6] | Loss=0.02662 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.433 | L2-Norm(final)=11.072 | 7961.9 samples/s | 124.4 steps/s
[Step=14450 Epoch=70.9] | Loss=0.02644 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=11.076 | 1472.2 samples/s | 23.0 steps/s
[Step=14500 Epoch=71.1] | Loss=0.02650 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=11.080 | 5498.2 samples/s | 85.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=14501 Epoch=71.1] | Loss=0.03922 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=11.122 | 3259.7 samples/s | 50.9 steps/s
[Step=14550 Epoch=71.4] | Loss=0.03122 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.465 | L2-Norm(final)=11.119 | 4128.2 samples/s | 64.5 steps/s
[Step=14600 Epoch=71.6] | Loss=0.03189 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.498 | L2-Norm(final)=11.109 | 4722.1 samples/s | 73.8 steps/s
[Step=14650 Epoch=71.8] | Loss=0.02960 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.526 | L2-Norm(final)=11.107 | 4697.4 samples/s | 73.4 steps/s
[Step=14700 Epoch=72.1] | Loss=0.02778 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.548 | L2-Norm(final)=11.107 | 6789.5 samples/s | 106.1 steps/s
[Step=14750 Epoch=72.3] | Loss=0.02390 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.568 | L2-Norm(final)=11.110 | 1382.6 samples/s | 21.6 steps/s
[Step=14800 Epoch=72.6] | Loss=0.02161 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.585 | L2-Norm(final)=11.115 | 4670.6 samples/s | 73.0 steps/s
[Step=14850 Epoch=72.8] | Loss=0.02014 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.599 | L2-Norm(final)=11.120 | 4693.5 samples/s | 73.3 steps/s
[Step=14900 Epoch=73.1] | Loss=0.01877 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.611 | L2-Norm(final)=11.124 | 6455.2 samples/s | 100.9 steps/s
[Step=14950 Epoch=73.3] | Loss=0.01731 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.622 | L2-Norm(final)=11.129 | 1447.4 samples/s | 22.6 steps/s
[Step=15000 Epoch=73.6] | Loss=0.01609 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.632 | L2-Norm(final)=11.134 | 4685.3 samples/s | 73.2 steps/s
[Step=15050 Epoch=73.8] | Loss=0.01536 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.640 | L2-Norm(final)=11.138 | 4708.4 samples/s | 73.6 steps/s
[Step=15100 Epoch=74.0] | Loss=0.01478 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.648 | L2-Norm(final)=11.142 | 6049.8 samples/s | 94.5 steps/s
[Step=15150 Epoch=74.3] | Loss=0.01400 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=11.146 | 1458.4 samples/s | 22.8 steps/s
[Step=15200 Epoch=74.5] | Loss=0.01340 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.662 | L2-Norm(final)=11.150 | 4804.5 samples/s | 75.1 steps/s
[Step=15250 Epoch=74.8] | Loss=0.01282 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.669 | L2-Norm(final)=11.154 | 4748.1 samples/s | 74.2 steps/s
[Step=15300 Epoch=75.0] | Loss=0.01234 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.675 | L2-Norm(final)=11.158 | 5560.2 samples/s | 86.9 steps/s
[Step=15350 Epoch=75.3] | Loss=0.01185 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=11.162 | 1504.2 samples/s | 23.5 steps/s
[Step=15400 Epoch=75.5] | Loss=0.01148 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.688 | L2-Norm(final)=11.166 | 4699.9 samples/s | 73.4 steps/s
[Step=15450 Epoch=75.8] | Loss=0.01107 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.693 | L2-Norm(final)=11.170 | 4659.4 samples/s | 72.8 steps/s
[Step=15500 Epoch=76.0] | Loss=0.01071 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.699 | L2-Norm(final)=11.174 | 5438.6 samples/s | 85.0 steps/s
[Step=15550 Epoch=76.3] | Loss=0.01038 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.703 | L2-Norm(final)=11.177 | 1473.3 samples/s | 23.0 steps/s
[Step=15600 Epoch=76.5] | Loss=0.01002 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.708 | L2-Norm(final)=11.181 | 4689.9 samples/s | 73.3 steps/s
[Step=15650 Epoch=76.7] | Loss=0.00972 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.713 | L2-Norm(final)=11.185 | 4722.9 samples/s | 73.8 steps/s
[Step=15700 Epoch=77.0] | Loss=0.00946 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.717 | L2-Norm(final)=11.189 | 5128.2 samples/s | 80.1 steps/s
[Step=15750 Epoch=77.2] | Loss=0.00930 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.722 | L2-Norm(final)=11.193 | 1515.2 samples/s | 23.7 steps/s
[Step=15800 Epoch=77.5] | Loss=0.00909 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.726 | L2-Norm(final)=11.196 | 4666.0 samples/s | 72.9 steps/s
[Step=15850 Epoch=77.7] | Loss=0.00892 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.730 | L2-Norm(final)=11.199 | 4772.0 samples/s | 74.6 steps/s
[Step=15900 Epoch=78.0] | Loss=0.00872 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.734 | L2-Norm(final)=11.202 | 4804.9 samples/s | 75.1 steps/s
[Step=15950 Epoch=78.2] | Loss=0.00860 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=11.206 | 1533.6 samples/s | 24.0 steps/s
[Step=16000 Epoch=78.5] | Loss=0.00844 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.741 | L2-Norm(final)=11.209 | 4652.8 samples/s | 72.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_4/client_state-step16000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=267.4] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=16.011 | 3116.4 samples/s | 48.7 steps/s
[Step=28050 Epoch=267.9] | Loss=0.00011 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.431 | L2-Norm(final)=16.015 | 4616.4 samples/s | 72.1 steps/s
[Step=28100 Epoch=268.3] | Loss=0.00025 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=16.022 | 8346.6 samples/s | 130.4 steps/s
[Step=28150 Epoch=268.8] | Loss=0.00023 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=16.030 | 1445.4 samples/s | 22.6 steps/s
[Step=28200 Epoch=269.3] | Loss=0.00025 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=16.039 | 7527.9 samples/s | 117.6 steps/s
[Step=28250 Epoch=269.8] | Loss=0.00024 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=16.047 | 1447.7 samples/s | 22.6 steps/s
[Step=28300 Epoch=270.2] | Loss=0.00022 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=16.055 | 6812.6 samples/s | 106.4 steps/s
[Step=28350 Epoch=270.7] | Loss=0.00023 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=16.063 | 1525.8 samples/s | 23.8 steps/s
[Step=28400 Epoch=271.2] | Loss=0.00024 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=16.071 | 6059.7 samples/s | 94.7 steps/s
[Step=28450 Epoch=271.7] | Loss=0.00025 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=16.079 | 1552.2 samples/s | 24.3 steps/s
[Step=28500 Epoch=272.2] | Loss=0.00024 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=16.086 | 5617.3 samples/s | 87.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=272.2] | Loss=0.00013 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=16.158 | 3068.2 samples/s | 47.9 steps/s
[Step=28550 Epoch=272.6] | Loss=0.00028 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=16.165 | 4166.6 samples/s | 65.1 steps/s
[Step=28600 Epoch=273.1] | Loss=0.00022 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=16.169 | 6582.1 samples/s | 102.8 steps/s
[Step=28650 Epoch=273.6] | Loss=0.00015 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.423 | L2-Norm(final)=16.172 | 1380.9 samples/s | 21.6 steps/s
[Step=28700 Epoch=274.1] | Loss=0.00011 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=16.174 | 5877.8 samples/s | 91.8 steps/s
[Step=28750 Epoch=274.5] | Loss=0.00009 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.402 | L2-Norm(final)=16.176 | 1440.3 samples/s | 22.5 steps/s
[Step=28800 Epoch=275.0] | Loss=0.00008 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.390 | L2-Norm(final)=16.177 | 5609.8 samples/s | 87.7 steps/s
[Step=28850 Epoch=275.5] | Loss=0.00006 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.378 | L2-Norm(final)=16.178 | 1418.5 samples/s | 22.2 steps/s
[Step=28900 Epoch=276.0] | Loss=0.00006 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=16.178 | 5227.4 samples/s | 81.7 steps/s
[Step=28950 Epoch=276.5] | Loss=0.00005 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=16.179 | 1449.4 samples/s | 22.6 steps/s
[Step=29000 Epoch=276.9] | Loss=0.00005 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.343 | L2-Norm(final)=16.179 | 4830.4 samples/s | 75.5 steps/s
[Step=29050 Epoch=277.4] | Loss=0.00004 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.332 | L2-Norm(final)=16.180 | 1482.8 samples/s | 23.2 steps/s
[Step=29100 Epoch=277.9] | Loss=0.00004 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.321 | L2-Norm(final)=16.180 | 4521.3 samples/s | 70.6 steps/s
[Step=29150 Epoch=278.4] | Loss=0.00004 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.309 | L2-Norm(final)=16.181 | 1501.7 samples/s | 23.5 steps/s
[Step=29200 Epoch=278.8] | Loss=0.00003 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.298 | L2-Norm(final)=16.181 | 4402.9 samples/s | 68.8 steps/s
[Step=29250 Epoch=279.3] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=16.181 | 1536.0 samples/s | 24.0 steps/s
[Step=29300 Epoch=279.8] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.275 | L2-Norm(final)=16.182 | 4563.4 samples/s | 71.3 steps/s
[Step=29350 Epoch=280.3] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.264 | L2-Norm(final)=16.182 | 1552.1 samples/s | 24.3 steps/s
[Step=29400 Epoch=280.8] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.253 | L2-Norm(final)=16.182 | 4515.6 samples/s | 70.6 steps/s
[Step=29450 Epoch=281.2] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.242 | L2-Norm(final)=16.182 | 1515.1 samples/s | 23.7 steps/s
[Step=29500 Epoch=281.7] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=16.183 | 4456.5 samples/s | 69.6 steps/s
[Step=29550 Epoch=282.2] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.219 | L2-Norm(final)=16.183 | 7263.0 samples/s | 113.5 steps/s
[Step=29600 Epoch=282.7] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.208 | L2-Norm(final)=16.183 | 1349.1 samples/s | 21.1 steps/s
[Step=29650 Epoch=283.1] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.197 | L2-Norm(final)=16.183 | 6550.1 samples/s | 102.3 steps/s
[Step=29700 Epoch=283.6] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.186 | L2-Norm(final)=16.184 | 1348.8 samples/s | 21.1 steps/s
[Step=29750 Epoch=284.1] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.175 | L2-Norm(final)=16.184 | 6061.7 samples/s | 94.7 steps/s
[Step=29800 Epoch=284.6] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.163 | L2-Norm(final)=16.184 | 1391.2 samples/s | 21.7 steps/s
[Step=29850 Epoch=285.0] | Loss=0.00002 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.152 | L2-Norm(final)=16.184 | 5575.2 samples/s | 87.1 steps/s
[Step=29900 Epoch=285.5] | Loss=0.00002 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.141 | L2-Norm(final)=16.185 | 1441.0 samples/s | 22.5 steps/s
[Step=29950 Epoch=286.0] | Loss=0.00002 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.129 | L2-Norm(final)=16.185 | 5234.2 samples/s | 81.8 steps/s
[Step=30000 Epoch=286.5] | Loss=0.00002 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.118 | L2-Norm(final)=16.185 | 1453.8 samples/s | 22.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step30000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08893 | acc=0.9599 | tpr=0.9675 | fpr=0.0565 | 4780.6 samples/s | 18.7 steps/s
Avg test loss: 0.09389, Avg test acc: 0.95821, Avg tpr: 0.96719, Avg fpr: 0.06153, total FA: 480

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09285 | acc=0.9601 | tpr=0.9709 | fpr=0.0634 | 4510.4 samples/s | 17.6 steps/s
Avg test loss: 0.09627, Avg test acc: 0.95841, Avg tpr: 0.97027, Avg fpr: 0.06768, total FA: 528

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11102 | acc=0.9488 | tpr=0.9604 | fpr=0.0763 | 4752.6 samples/s | 18.6 steps/s
Avg test loss: 0.11593, Avg test acc: 0.94883, Avg tpr: 0.95978, Avg fpr: 0.07525, total FA: 587

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09874 | acc=0.9620 | tpr=0.9788 | fpr=0.0746 | 4601.4 samples/s | 18.0 steps/s
Avg test loss: 0.10255, Avg test acc: 0.96037, Avg tpr: 0.97791, Avg fpr: 0.07820, total FA: 610

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08493 | acc=0.9610 | tpr=0.9715 | fpr=0.0617 | 4627.4 samples/s | 18.1 steps/s
Avg test loss: 0.09302, Avg test acc: 0.95993, Avg tpr: 0.97068, Avg fpr: 0.06371, total FA: 497

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.88346 | acc=0.3045 | tpr=0.0098 | fpr=0.0557 | 4592.1 samples/s | 17.9 steps/s
Avg test loss: 4.90352, Avg test acc: 0.30175, Avg tpr: 0.00915, Avg fpr: 0.05474, total FA: 427

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.64086 | acc=0.2929 | tpr=0.0163 | fpr=0.1065 | 4439.6 samples/s | 17.3 steps/s
Avg test loss: 4.66168, Avg test acc: 0.29061, Avg tpr: 0.01615, Avg fpr: 0.10576, total FA: 825

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.61627 | acc=0.2824 | tpr=0.0179 | fpr=0.1432 | 4691.7 samples/s | 18.3 steps/s
Avg test loss: 4.63470, Avg test acc: 0.27995, Avg tpr: 0.01795, Avg fpr: 0.14383, total FA: 1122

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.13278 | acc=0.3139 | tpr=0.0298 | fpr=0.0691 | 4451.8 samples/s | 17.4 steps/s
Avg test loss: 4.15146, Avg test acc: 0.31184, Avg tpr: 0.02996, Avg fpr: 0.06820, total FA: 532

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.70606 | acc=0.3113 | tpr=0.0080 | fpr=0.0302 | 4720.6 samples/s | 18.4 steps/s
Avg test loss: 4.73503, Avg test acc: 0.30824, Avg tpr: 0.00723, Avg fpr: 0.02974, total FA: 232

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.57374 | acc=0.1529 | tpr=0.7478 | fpr=0.8578 | 4708.0 samples/s | 18.4 steps/s
[Step= 100] | Loss=5.53975 | acc=0.1550 | tpr=0.7143 | fpr=0.8554 | 7860.4 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.54565 | acc=0.1561 | tpr=0.7176 | fpr=0.8542 | 7601.2 samples/s | 29.7 steps/s
[Step= 200] | Loss=5.53515 | acc=0.1564 | tpr=0.7148 | fpr=0.8537 | 7411.2 samples/s | 28.9 steps/s
[Step= 250] | Loss=5.52925 | acc=0.1570 | tpr=0.7092 | fpr=0.8530 | 8299.0 samples/s | 32.4 steps/s
[Step= 300] | Loss=5.52338 | acc=0.1575 | tpr=0.7127 | fpr=0.8526 | 8267.4 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.53185 | acc=0.1571 | tpr=0.7157 | fpr=0.8530 | 7823.6 samples/s | 30.6 steps/s
[Step= 400] | Loss=5.53274 | acc=0.1569 | tpr=0.7112 | fpr=0.8532 | 7537.3 samples/s | 29.4 steps/s
[Step= 450] | Loss=5.53071 | acc=0.1569 | tpr=0.7113 | fpr=0.8531 | 8289.7 samples/s | 32.4 steps/s
[Step= 500] | Loss=5.53100 | acc=0.1570 | tpr=0.7097 | fpr=0.8530 | 8134.9 samples/s | 31.8 steps/s
[Step= 550] | Loss=5.53012 | acc=0.1572 | tpr=0.7139 | fpr=0.8529 | 10428.1 samples/s | 40.7 steps/s
Avg test loss: 5.53057, Avg test acc: 0.15713, Avg tpr: 0.71315, Avg fpr: 0.85298, total FA: 118434

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.80009 | acc=0.1449 | tpr=0.6947 | fpr=0.8650 | 4737.7 samples/s | 18.5 steps/s
[Step= 100] | Loss=5.77401 | acc=0.1475 | tpr=0.6716 | fpr=0.8623 | 7639.3 samples/s | 29.8 steps/s
[Step= 150] | Loss=5.77825 | acc=0.1489 | tpr=0.6844 | fpr=0.8610 | 7701.3 samples/s | 30.1 steps/s
[Step= 200] | Loss=5.77064 | acc=0.1488 | tpr=0.6776 | fpr=0.8608 | 8119.7 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.76919 | acc=0.1495 | tpr=0.6786 | fpr=0.8601 | 7857.2 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.76450 | acc=0.1499 | tpr=0.6844 | fpr=0.8599 | 8423.8 samples/s | 32.9 steps/s
[Step= 350] | Loss=5.77318 | acc=0.1496 | tpr=0.6857 | fpr=0.8602 | 7583.0 samples/s | 29.6 steps/s
[Step= 400] | Loss=5.77585 | acc=0.1492 | tpr=0.6794 | fpr=0.8604 | 8120.6 samples/s | 31.7 steps/s
[Step= 450] | Loss=5.77455 | acc=0.1491 | tpr=0.6743 | fpr=0.8604 | 8232.3 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.77625 | acc=0.1491 | tpr=0.6700 | fpr=0.8603 | 7971.6 samples/s | 31.1 steps/s
[Step= 550] | Loss=5.77495 | acc=0.1494 | tpr=0.6733 | fpr=0.8602 | 9182.2 samples/s | 35.9 steps/s
Avg test loss: 5.77603, Avg test acc: 0.14924, Avg tpr: 0.67274, Avg fpr: 0.86028, total FA: 119448

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.85306 | acc=0.1357 | tpr=0.7920 | fpr=0.8761 | 4615.3 samples/s | 18.0 steps/s
[Step= 100] | Loss=5.82866 | acc=0.1381 | tpr=0.7527 | fpr=0.8733 | 8183.3 samples/s | 32.0 steps/s
[Step= 150] | Loss=5.83928 | acc=0.1396 | tpr=0.7622 | fpr=0.8719 | 7401.2 samples/s | 28.9 steps/s
[Step= 200] | Loss=5.82199 | acc=0.1404 | tpr=0.7628 | fpr=0.8709 | 8336.6 samples/s | 32.6 steps/s
[Step= 250] | Loss=5.81661 | acc=0.1410 | tpr=0.7555 | fpr=0.8702 | 8072.9 samples/s | 31.5 steps/s
[Step= 300] | Loss=5.80871 | acc=0.1411 | tpr=0.7593 | fpr=0.8702 | 7673.1 samples/s | 30.0 steps/s
[Step= 350] | Loss=5.82031 | acc=0.1403 | tpr=0.7564 | fpr=0.8709 | 7990.3 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.82266 | acc=0.1402 | tpr=0.7571 | fpr=0.8710 | 8147.8 samples/s | 31.8 steps/s
[Step= 450] | Loss=5.81925 | acc=0.1406 | tpr=0.7551 | fpr=0.8705 | 8102.9 samples/s | 31.7 steps/s
[Step= 500] | Loss=5.81900 | acc=0.1409 | tpr=0.7537 | fpr=0.8701 | 7205.8 samples/s | 28.1 steps/s
[Step= 550] | Loss=5.81889 | acc=0.1409 | tpr=0.7537 | fpr=0.8702 | 10544.4 samples/s | 41.2 steps/s
Avg test loss: 5.81926, Avg test acc: 0.14081, Avg tpr: 0.75238, Avg fpr: 0.87030, total FA: 120840

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=7.45509 | acc=0.1260 | tpr=0.7876 | fpr=0.8859 | 4552.1 samples/s | 17.8 steps/s
[Step= 100] | Loss=7.41939 | acc=0.1280 | tpr=0.7868 | fpr=0.8843 | 7920.1 samples/s | 30.9 steps/s
[Step= 150] | Loss=7.41972 | acc=0.1293 | tpr=0.7867 | fpr=0.8828 | 7490.7 samples/s | 29.3 steps/s
[Step= 200] | Loss=7.40957 | acc=0.1292 | tpr=0.7803 | fpr=0.8827 | 7764.9 samples/s | 30.3 steps/s
[Step= 250] | Loss=7.40446 | acc=0.1295 | tpr=0.7790 | fpr=0.8824 | 8286.3 samples/s | 32.4 steps/s
[Step= 300] | Loss=7.39936 | acc=0.1295 | tpr=0.7796 | fpr=0.8823 | 7883.3 samples/s | 30.8 steps/s
[Step= 350] | Loss=7.41262 | acc=0.1289 | tpr=0.7858 | fpr=0.8831 | 8172.3 samples/s | 31.9 steps/s
[Step= 400] | Loss=7.41332 | acc=0.1290 | tpr=0.7850 | fpr=0.8830 | 7896.4 samples/s | 30.8 steps/s
[Step= 450] | Loss=7.41165 | acc=0.1289 | tpr=0.7824 | fpr=0.8829 | 7472.8 samples/s | 29.2 steps/s
[Step= 500] | Loss=7.41259 | acc=0.1288 | tpr=0.7806 | fpr=0.8829 | 8623.8 samples/s | 33.7 steps/s
[Step= 550] | Loss=7.41190 | acc=0.1291 | tpr=0.7835 | fpr=0.8828 | 8446.2 samples/s | 33.0 steps/s
Avg test loss: 7.41328, Avg test acc: 0.12896, Avg tpr: 0.78249, Avg fpr: 0.88292, total FA: 122592

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.91328 | acc=0.1377 | tpr=0.7566 | fpr=0.8734 | 4650.7 samples/s | 18.2 steps/s
[Step= 100] | Loss=5.88643 | acc=0.1403 | tpr=0.7356 | fpr=0.8708 | 7359.3 samples/s | 28.7 steps/s
[Step= 150] | Loss=5.89297 | acc=0.1418 | tpr=0.7291 | fpr=0.8690 | 8235.5 samples/s | 32.2 steps/s
[Step= 200] | Loss=5.88647 | acc=0.1412 | tpr=0.7268 | fpr=0.8695 | 7858.4 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.88454 | acc=0.1419 | tpr=0.7284 | fpr=0.8688 | 8106.5 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.87860 | acc=0.1426 | tpr=0.7345 | fpr=0.8682 | 8190.0 samples/s | 32.0 steps/s
[Step= 350] | Loss=5.88702 | acc=0.1421 | tpr=0.7332 | fpr=0.8686 | 7937.7 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.88660 | acc=0.1418 | tpr=0.7281 | fpr=0.8688 | 7339.9 samples/s | 28.7 steps/s
[Step= 450] | Loss=5.88332 | acc=0.1419 | tpr=0.7215 | fpr=0.8686 | 7507.6 samples/s | 29.3 steps/s
[Step= 500] | Loss=5.88604 | acc=0.1417 | tpr=0.7185 | fpr=0.8687 | 8470.4 samples/s | 33.1 steps/s
[Step= 550] | Loss=5.88576 | acc=0.1423 | tpr=0.7207 | fpr=0.8682 | 7095.6 samples/s | 27.7 steps/s
Avg test loss: 5.88681, Avg test acc: 0.14219, Avg tpr: 0.72029, Avg fpr: 0.86832, total FA: 120565

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.16279 | acc=0.9619 | tpr=0.9381 | fpr=0.0377 | 4657.8 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.16664 | acc=0.9600 | tpr=0.9254 | fpr=0.0394 | 7772.6 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.16966 | acc=0.9591 | tpr=0.9308 | fpr=0.0404 | 7160.7 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.17006 | acc=0.9596 | tpr=0.9388 | fpr=0.0401 | 8490.4 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.17138 | acc=0.9593 | tpr=0.9389 | fpr=0.0403 | 8701.0 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.17312 | acc=0.9586 | tpr=0.9367 | fpr=0.0410 | 7786.1 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.17355 | acc=0.9586 | tpr=0.9374 | fpr=0.0410 | 7971.9 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.17448 | acc=0.9584 | tpr=0.9365 | fpr=0.0412 | 8215.9 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.17559 | acc=0.9582 | tpr=0.9333 | fpr=0.0414 | 7671.2 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.17511 | acc=0.9581 | tpr=0.9344 | fpr=0.0414 | 8254.8 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.17495 | acc=0.9583 | tpr=0.9331 | fpr=0.0413 | 6501.7 samples/s | 25.4 steps/s
Avg test loss: 0.17461, Avg test acc: 0.95829, Avg tpr: 0.93265, Avg fpr: 0.04125, total FA: 5727

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14610 | acc=0.9638 | tpr=0.9381 | fpr=0.0357 | 4745.0 samples/s | 18.5 steps/s
[Step= 100] | Loss=0.14977 | acc=0.9630 | tpr=0.9296 | fpr=0.0364 | 7343.1 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.15161 | acc=0.9621 | tpr=0.9280 | fpr=0.0373 | 8098.5 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.15176 | acc=0.9624 | tpr=0.9333 | fpr=0.0370 | 8154.7 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.15309 | acc=0.9621 | tpr=0.9328 | fpr=0.0374 | 8068.1 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.15360 | acc=0.9618 | tpr=0.9345 | fpr=0.0377 | 7963.6 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.15346 | acc=0.9618 | tpr=0.9361 | fpr=0.0377 | 8195.3 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.15478 | acc=0.9615 | tpr=0.9316 | fpr=0.0380 | 7497.0 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.15495 | acc=0.9613 | tpr=0.9304 | fpr=0.0381 | 7506.7 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.15476 | acc=0.9614 | tpr=0.9322 | fpr=0.0381 | 5824.9 samples/s | 22.8 steps/s
[Step= 550] | Loss=0.15476 | acc=0.9615 | tpr=0.9300 | fpr=0.0380 | 10519.8 samples/s | 41.1 steps/s
Avg test loss: 0.15440, Avg test acc: 0.96149, Avg tpr: 0.93027, Avg fpr: 0.03794, total FA: 5268

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.26552 | acc=0.9536 | tpr=0.9469 | fpr=0.0463 | 4740.5 samples/s | 18.5 steps/s
[Step= 100] | Loss=0.27504 | acc=0.9518 | tpr=0.9446 | fpr=0.0481 | 7377.9 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.28287 | acc=0.9507 | tpr=0.9438 | fpr=0.0492 | 8257.3 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.28364 | acc=0.9506 | tpr=0.9497 | fpr=0.0493 | 7873.3 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.28515 | acc=0.9504 | tpr=0.9511 | fpr=0.0496 | 7605.8 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.28771 | acc=0.9501 | tpr=0.9527 | fpr=0.0500 | 7930.3 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.28825 | acc=0.9501 | tpr=0.9530 | fpr=0.0500 | 7597.8 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.29057 | acc=0.9497 | tpr=0.9513 | fpr=0.0503 | 8422.3 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.29221 | acc=0.9493 | tpr=0.9484 | fpr=0.0506 | 8045.8 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.29190 | acc=0.9491 | tpr=0.9489 | fpr=0.0509 | 5827.0 samples/s | 22.8 steps/s
[Step= 550] | Loss=0.29096 | acc=0.9492 | tpr=0.9471 | fpr=0.0508 | 10108.2 samples/s | 39.5 steps/s
Avg test loss: 0.29053, Avg test acc: 0.94923, Avg tpr: 0.94731, Avg fpr: 0.05074, total FA: 7045

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14205 | acc=0.9613 | tpr=0.9425 | fpr=0.0383 | 4780.3 samples/s | 18.7 steps/s
[Step= 100] | Loss=0.14441 | acc=0.9614 | tpr=0.9424 | fpr=0.0382 | 7296.0 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.14905 | acc=0.9602 | tpr=0.9424 | fpr=0.0395 | 7909.1 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.15025 | acc=0.9602 | tpr=0.9464 | fpr=0.0395 | 8359.9 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.15121 | acc=0.9601 | tpr=0.9450 | fpr=0.0396 | 7687.6 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.15277 | acc=0.9597 | tpr=0.9425 | fpr=0.0399 | 7759.4 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.15371 | acc=0.9596 | tpr=0.9418 | fpr=0.0401 | 7863.5 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.15530 | acc=0.9594 | tpr=0.9393 | fpr=0.0402 | 7711.6 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.15541 | acc=0.9592 | tpr=0.9387 | fpr=0.0404 | 7943.8 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.15480 | acc=0.9593 | tpr=0.9405 | fpr=0.0404 | 6052.0 samples/s | 23.6 steps/s
[Step= 550] | Loss=0.15439 | acc=0.9594 | tpr=0.9371 | fpr=0.0402 | 10224.6 samples/s | 39.9 steps/s
Avg test loss: 0.15414, Avg test acc: 0.95945, Avg tpr: 0.93740, Avg fpr: 0.04015, total FA: 5575

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.20357 | acc=0.9570 | tpr=0.9027 | fpr=0.0420 | 4489.5 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.21095 | acc=0.9563 | tpr=0.9147 | fpr=0.0430 | 8442.7 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.21397 | acc=0.9554 | tpr=0.9236 | fpr=0.0441 | 7681.6 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.21490 | acc=0.9553 | tpr=0.9268 | fpr=0.0442 | 7899.6 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.21734 | acc=0.9549 | tpr=0.9284 | fpr=0.0446 | 7673.6 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.21962 | acc=0.9544 | tpr=0.9287 | fpr=0.0451 | 7488.7 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.21962 | acc=0.9545 | tpr=0.9299 | fpr=0.0450 | 8399.9 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.22105 | acc=0.9542 | tpr=0.9261 | fpr=0.0453 | 7873.8 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.22237 | acc=0.9539 | tpr=0.9270 | fpr=0.0456 | 5745.5 samples/s | 22.4 steps/s
[Step= 500] | Loss=0.22317 | acc=0.9537 | tpr=0.9282 | fpr=0.0459 | 8150.3 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.22238 | acc=0.9538 | tpr=0.9256 | fpr=0.0457 | 11112.6 samples/s | 43.4 steps/s
Avg test loss: 0.22197, Avg test acc: 0.95384, Avg tpr: 0.92552, Avg fpr: 0.04565, total FA: 6338

server round 25/50

clients selected: [0 1 2 5 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=38001 Epoch=185.3] | Loss=0.00665 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=13.637 | 3315.5 samples/s | 51.8 steps/s
[Step=38050 Epoch=185.5] | Loss=0.02457 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.369 | L2-Norm(final)=13.633 | 4557.9 samples/s | 71.2 steps/s
[Step=38100 Epoch=185.8] | Loss=0.02507 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.369 | L2-Norm(final)=13.631 | 5487.2 samples/s | 85.7 steps/s
[Step=38150 Epoch=186.0] | Loss=0.02482 | Reg=0.00129 | acc=0.9531 | L2-Norm=11.369 | L2-Norm(final)=13.631 | 5479.5 samples/s | 85.6 steps/s
[Step=38200 Epoch=186.3] | Loss=0.02510 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.369 | L2-Norm(final)=13.632 | 8499.1 samples/s | 132.8 steps/s
[Step=38250 Epoch=186.5] | Loss=0.02558 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.369 | L2-Norm(final)=13.632 | 1453.0 samples/s | 22.7 steps/s
[Step=38300 Epoch=186.8] | Loss=0.02560 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=13.631 | 5463.0 samples/s | 85.4 steps/s
[Step=38350 Epoch=187.0] | Loss=0.02538 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=13.630 | 5533.4 samples/s | 86.5 steps/s
[Step=38400 Epoch=187.2] | Loss=0.02521 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.369 | L2-Norm(final)=13.631 | 7404.2 samples/s | 115.7 steps/s
[Step=38450 Epoch=187.5] | Loss=0.02502 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.369 | L2-Norm(final)=13.631 | 1506.7 samples/s | 23.5 steps/s
[Step=38500 Epoch=187.7] | Loss=0.02496 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.369 | L2-Norm(final)=13.631 | 5466.5 samples/s | 85.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=38501 Epoch=187.7] | Loss=0.01156 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=13.634 | 3087.7 samples/s | 48.2 steps/s
[Step=38550 Epoch=188.0] | Loss=0.02693 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.399 | L2-Norm(final)=13.627 | 4462.6 samples/s | 69.7 steps/s
[Step=38600 Epoch=188.2] | Loss=0.02646 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.432 | L2-Norm(final)=13.622 | 4699.5 samples/s | 73.4 steps/s
[Step=38650 Epoch=188.5] | Loss=0.02606 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.457 | L2-Norm(final)=13.621 | 4664.2 samples/s | 72.9 steps/s
[Step=38700 Epoch=188.7] | Loss=0.02495 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.478 | L2-Norm(final)=13.621 | 6722.3 samples/s | 105.0 steps/s
[Step=38750 Epoch=189.0] | Loss=0.02215 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.496 | L2-Norm(final)=13.623 | 1393.9 samples/s | 21.8 steps/s
[Step=38800 Epoch=189.2] | Loss=0.02021 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.511 | L2-Norm(final)=13.626 | 4686.3 samples/s | 73.2 steps/s
[Step=38850 Epoch=189.4] | Loss=0.01855 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.524 | L2-Norm(final)=13.629 | 4684.8 samples/s | 73.2 steps/s
[Step=38900 Epoch=189.7] | Loss=0.01716 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.535 | L2-Norm(final)=13.633 | 6178.4 samples/s | 96.5 steps/s
[Step=38950 Epoch=189.9] | Loss=0.01570 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.544 | L2-Norm(final)=13.636 | 1462.3 samples/s | 22.8 steps/s
[Step=39000 Epoch=190.2] | Loss=0.01473 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.553 | L2-Norm(final)=13.639 | 4729.3 samples/s | 73.9 steps/s
[Step=39050 Epoch=190.4] | Loss=0.01427 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.560 | L2-Norm(final)=13.642 | 4677.4 samples/s | 73.1 steps/s
[Step=39100 Epoch=190.7] | Loss=0.01367 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.566 | L2-Norm(final)=13.645 | 5623.6 samples/s | 87.9 steps/s
[Step=39150 Epoch=190.9] | Loss=0.01298 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.573 | L2-Norm(final)=13.648 | 1478.0 samples/s | 23.1 steps/s
[Step=39200 Epoch=191.1] | Loss=0.01241 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.578 | L2-Norm(final)=13.651 | 4763.2 samples/s | 74.4 steps/s
[Step=39250 Epoch=191.4] | Loss=0.01189 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.583 | L2-Norm(final)=13.653 | 4654.0 samples/s | 72.7 steps/s
[Step=39300 Epoch=191.6] | Loss=0.01141 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.588 | L2-Norm(final)=13.656 | 5146.7 samples/s | 80.4 steps/s
[Step=39350 Epoch=191.9] | Loss=0.01102 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.592 | L2-Norm(final)=13.658 | 1500.4 samples/s | 23.4 steps/s
[Step=39400 Epoch=192.1] | Loss=0.01054 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.597 | L2-Norm(final)=13.661 | 4693.9 samples/s | 73.3 steps/s
[Step=39450 Epoch=192.4] | Loss=0.01030 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.601 | L2-Norm(final)=13.664 | 4715.9 samples/s | 73.7 steps/s
[Step=39500 Epoch=192.6] | Loss=0.01000 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.604 | L2-Norm(final)=13.666 | 4817.5 samples/s | 75.3 steps/s
[Step=39550 Epoch=192.9] | Loss=0.00973 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.608 | L2-Norm(final)=13.669 | 1533.6 samples/s | 24.0 steps/s
[Step=39600 Epoch=193.1] | Loss=0.00942 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.611 | L2-Norm(final)=13.671 | 4704.4 samples/s | 73.5 steps/s
[Step=39650 Epoch=193.3] | Loss=0.00919 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.614 | L2-Norm(final)=13.674 | 4675.9 samples/s | 73.1 steps/s
[Step=39700 Epoch=193.6] | Loss=0.00897 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.617 | L2-Norm(final)=13.676 | 4673.7 samples/s | 73.0 steps/s
[Step=39750 Epoch=193.8] | Loss=0.00876 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=13.679 | 1588.4 samples/s | 24.8 steps/s
[Step=39800 Epoch=194.1] | Loss=0.00853 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.623 | L2-Norm(final)=13.681 | 4713.1 samples/s | 73.6 steps/s
[Step=39850 Epoch=194.3] | Loss=0.00837 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.625 | L2-Norm(final)=13.684 | 4732.4 samples/s | 73.9 steps/s
[Step=39900 Epoch=194.6] | Loss=0.00821 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.628 | L2-Norm(final)=13.686 | 4716.3 samples/s | 73.7 steps/s
[Step=39950 Epoch=194.8] | Loss=0.00808 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.630 | L2-Norm(final)=13.688 | 1547.0 samples/s | 24.2 steps/s
[Step=40000 Epoch=195.0] | Loss=0.00788 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.632 | L2-Norm(final)=13.690 | 4642.8 samples/s | 72.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step40000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=117.1] | Loss=0.01381 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=11.999 | 3110.3 samples/s | 48.6 steps/s
[Step=24050 Epoch=117.4] | Loss=0.03200 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.370 | L2-Norm(final)=11.993 | 4953.0 samples/s | 77.4 steps/s
[Step=24100 Epoch=117.6] | Loss=0.02712 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.370 | L2-Norm(final)=11.995 | 5424.5 samples/s | 84.8 steps/s
[Step=24150 Epoch=117.8] | Loss=0.02810 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.370 | L2-Norm(final)=11.998 | 5481.0 samples/s | 85.6 steps/s
[Step=24200 Epoch=118.1] | Loss=0.02844 | Reg=0.00129 | acc=0.9531 | L2-Norm=11.370 | L2-Norm(final)=11.999 | 8660.1 samples/s | 135.3 steps/s
[Step=24250 Epoch=118.3] | Loss=0.02793 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=11.999 | 1513.9 samples/s | 23.7 steps/s
[Step=24300 Epoch=118.6] | Loss=0.02860 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.370 | L2-Norm(final)=12.000 | 5397.3 samples/s | 84.3 steps/s
[Step=24350 Epoch=118.8] | Loss=0.02903 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.370 | L2-Norm(final)=11.999 | 5481.1 samples/s | 85.6 steps/s
[Step=24400 Epoch=119.1] | Loss=0.02835 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=11.997 | 7703.2 samples/s | 120.4 steps/s
[Step=24450 Epoch=119.3] | Loss=0.02782 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=11.997 | 1511.4 samples/s | 23.6 steps/s
[Step=24500 Epoch=119.5] | Loss=0.02804 | Reg=0.00129 | acc=0.9375 | L2-Norm=11.370 | L2-Norm(final)=11.997 | 5449.8 samples/s | 85.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=119.6] | Loss=0.00554 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=11.995 | 3283.1 samples/s | 51.3 steps/s
[Step=24550 Epoch=119.8] | Loss=0.03534 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.408 | L2-Norm(final)=11.986 | 4089.0 samples/s | 63.9 steps/s
[Step=24600 Epoch=120.0] | Loss=0.03168 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.447 | L2-Norm(final)=11.980 | 4679.7 samples/s | 73.1 steps/s
[Step=24650 Epoch=120.3] | Loss=0.02932 | Reg=0.00132 | acc=0.9531 | L2-Norm=11.476 | L2-Norm(final)=11.980 | 4687.2 samples/s | 73.2 steps/s
[Step=24700 Epoch=120.5] | Loss=0.02733 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.499 | L2-Norm(final)=11.982 | 6767.6 samples/s | 105.7 steps/s
[Step=24750 Epoch=120.8] | Loss=0.02412 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.519 | L2-Norm(final)=11.984 | 1406.3 samples/s | 22.0 steps/s
[Step=24800 Epoch=121.0] | Loss=0.02185 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.535 | L2-Norm(final)=11.988 | 4687.5 samples/s | 73.2 steps/s
[Step=24850 Epoch=121.3] | Loss=0.01993 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.548 | L2-Norm(final)=11.991 | 4642.7 samples/s | 72.5 steps/s
[Step=24900 Epoch=121.5] | Loss=0.01861 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.559 | L2-Norm(final)=11.995 | 6294.2 samples/s | 98.3 steps/s
[Step=24950 Epoch=121.7] | Loss=0.01736 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.570 | L2-Norm(final)=11.999 | 1426.9 samples/s | 22.3 steps/s
[Step=25000 Epoch=122.0] | Loss=0.01649 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.579 | L2-Norm(final)=12.003 | 4683.8 samples/s | 73.2 steps/s
[Step=25050 Epoch=122.2] | Loss=0.01544 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.588 | L2-Norm(final)=12.006 | 4687.6 samples/s | 73.2 steps/s
[Step=25100 Epoch=122.5] | Loss=0.01469 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.595 | L2-Norm(final)=12.010 | 5828.4 samples/s | 91.1 steps/s
[Step=25150 Epoch=122.7] | Loss=0.01395 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.602 | L2-Norm(final)=12.013 | 1462.9 samples/s | 22.9 steps/s
[Step=25200 Epoch=123.0] | Loss=0.01327 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.609 | L2-Norm(final)=12.017 | 4688.6 samples/s | 73.3 steps/s
[Step=25250 Epoch=123.2] | Loss=0.01276 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.615 | L2-Norm(final)=12.020 | 4734.3 samples/s | 74.0 steps/s
[Step=25300 Epoch=123.5] | Loss=0.01234 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=12.024 | 5380.8 samples/s | 84.1 steps/s
[Step=25350 Epoch=123.7] | Loss=0.01182 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.626 | L2-Norm(final)=12.027 | 1475.1 samples/s | 23.0 steps/s
[Step=25400 Epoch=123.9] | Loss=0.01142 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.631 | L2-Norm(final)=12.030 | 4647.4 samples/s | 72.6 steps/s
[Step=25450 Epoch=124.2] | Loss=0.01099 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.636 | L2-Norm(final)=12.034 | 4657.3 samples/s | 72.8 steps/s
[Step=25500 Epoch=124.4] | Loss=0.01065 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.640 | L2-Norm(final)=12.037 | 5097.1 samples/s | 79.6 steps/s
[Step=25550 Epoch=124.7] | Loss=0.01034 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.645 | L2-Norm(final)=12.040 | 1525.3 samples/s | 23.8 steps/s
[Step=25600 Epoch=124.9] | Loss=0.01001 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.649 | L2-Norm(final)=12.044 | 4741.0 samples/s | 74.1 steps/s
[Step=25650 Epoch=125.2] | Loss=0.00982 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.653 | L2-Norm(final)=12.047 | 4615.6 samples/s | 72.1 steps/s
[Step=25700 Epoch=125.4] | Loss=0.00960 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.657 | L2-Norm(final)=12.050 | 4810.8 samples/s | 75.2 steps/s
[Step=25750 Epoch=125.6] | Loss=0.00937 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.661 | L2-Norm(final)=12.053 | 1528.6 samples/s | 23.9 steps/s
[Step=25800 Epoch=125.9] | Loss=0.00921 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.665 | L2-Norm(final)=12.056 | 4713.6 samples/s | 73.7 steps/s
[Step=25850 Epoch=126.1] | Loss=0.00896 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.668 | L2-Norm(final)=12.059 | 4667.4 samples/s | 72.9 steps/s
[Step=25900 Epoch=126.4] | Loss=0.00877 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.672 | L2-Norm(final)=12.062 | 4751.4 samples/s | 74.2 steps/s
[Step=25950 Epoch=126.6] | Loss=0.00860 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=12.065 | 1605.6 samples/s | 25.1 steps/s
[Step=26000 Epoch=126.9] | Loss=0.00840 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.679 | L2-Norm(final)=12.068 | 4633.3 samples/s | 72.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_1/client_state-step26000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=10001 Epoch=48.7] | Loss=0.03741 | Reg=0.00129 | acc=0.9531 | L2-Norm=11.369 | L2-Norm(final)=9.879 | 2996.3 samples/s | 46.8 steps/s
[Step=10050 Epoch=49.0] | Loss=0.02326 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=9.887 | 5374.3 samples/s | 84.0 steps/s
[Step=10100 Epoch=49.2] | Loss=0.02443 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.370 | L2-Norm(final)=9.897 | 5400.3 samples/s | 84.4 steps/s
[Step=10150 Epoch=49.5] | Loss=0.02588 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=9.905 | 5478.1 samples/s | 85.6 steps/s
[Step=10200 Epoch=49.7] | Loss=0.02577 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=9.911 | 8471.9 samples/s | 132.4 steps/s
[Step=10250 Epoch=49.9] | Loss=0.02608 | Reg=0.00129 | acc=0.9531 | L2-Norm=11.370 | L2-Norm(final)=9.918 | 1470.7 samples/s | 23.0 steps/s
[Step=10300 Epoch=50.2] | Loss=0.02605 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.370 | L2-Norm(final)=9.925 | 5442.7 samples/s | 85.0 steps/s
[Step=10350 Epoch=50.4] | Loss=0.02648 | Reg=0.00129 | acc=0.9531 | L2-Norm=11.370 | L2-Norm(final)=9.931 | 5611.6 samples/s | 87.7 steps/s
[Step=10400 Epoch=50.7] | Loss=0.02565 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=9.938 | 7373.0 samples/s | 115.2 steps/s
[Step=10450 Epoch=50.9] | Loss=0.02564 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.370 | L2-Norm(final)=9.945 | 1545.6 samples/s | 24.1 steps/s
[Step=10500 Epoch=51.2] | Loss=0.02582 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.370 | L2-Norm(final)=9.953 | 5548.7 samples/s | 86.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=10501 Epoch=51.2] | Loss=0.00743 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=10.022 | 3066.6 samples/s | 47.9 steps/s
[Step=10550 Epoch=51.4] | Loss=0.02562 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.401 | L2-Norm(final)=10.024 | 2718.6 samples/s | 42.5 steps/s
[Step=10600 Epoch=51.6] | Loss=0.02572 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.436 | L2-Norm(final)=10.025 | 4683.0 samples/s | 73.2 steps/s
[Step=10650 Epoch=51.9] | Loss=0.02503 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.463 | L2-Norm(final)=10.026 | 4481.8 samples/s | 70.0 steps/s
[Step=10700 Epoch=52.1] | Loss=0.02329 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.486 | L2-Norm(final)=10.027 | 6717.9 samples/s | 105.0 steps/s
[Step=10750 Epoch=52.4] | Loss=0.02027 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.505 | L2-Norm(final)=10.032 | 1393.1 samples/s | 21.8 steps/s
[Step=10800 Epoch=52.6] | Loss=0.01848 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.521 | L2-Norm(final)=10.037 | 4608.5 samples/s | 72.0 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01701 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.535 | L2-Norm(final)=10.042 | 4680.3 samples/s | 73.1 steps/s
[Step=10900 Epoch=53.1] | Loss=0.01610 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.547 | L2-Norm(final)=10.046 | 6166.0 samples/s | 96.3 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01496 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.558 | L2-Norm(final)=10.051 | 1496.3 samples/s | 23.4 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01412 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.568 | L2-Norm(final)=10.055 | 4702.4 samples/s | 73.5 steps/s
[Step=11050 Epoch=53.8] | Loss=0.01360 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.577 | L2-Norm(final)=10.059 | 4737.9 samples/s | 74.0 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01286 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.586 | L2-Norm(final)=10.064 | 5546.6 samples/s | 86.7 steps/s
[Step=11150 Epoch=54.3] | Loss=0.01234 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.594 | L2-Norm(final)=10.068 | 1466.7 samples/s | 22.9 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01205 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=10.072 | 4685.2 samples/s | 73.2 steps/s
[Step=11250 Epoch=54.8] | Loss=0.01157 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.608 | L2-Norm(final)=10.075 | 4717.0 samples/s | 73.7 steps/s
[Step=11300 Epoch=55.1] | Loss=0.01116 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.614 | L2-Norm(final)=10.078 | 5169.4 samples/s | 80.8 steps/s
[Step=11350 Epoch=55.3] | Loss=0.01072 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.620 | L2-Norm(final)=10.082 | 1521.6 samples/s | 23.8 steps/s
[Step=11400 Epoch=55.5] | Loss=0.01028 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.626 | L2-Norm(final)=10.085 | 4648.7 samples/s | 72.6 steps/s
[Step=11450 Epoch=55.8] | Loss=0.01000 | Reg=0.00135 | acc=0.9531 | L2-Norm=11.631 | L2-Norm(final)=10.089 | 4703.0 samples/s | 73.5 steps/s
[Step=11500 Epoch=56.0] | Loss=0.00983 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.636 | L2-Norm(final)=10.092 | 4796.2 samples/s | 74.9 steps/s
[Step=11550 Epoch=56.3] | Loss=0.00951 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.641 | L2-Norm(final)=10.096 | 1537.5 samples/s | 24.0 steps/s
[Step=11600 Epoch=56.5] | Loss=0.00933 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.646 | L2-Norm(final)=10.099 | 4714.9 samples/s | 73.7 steps/s
[Step=11650 Epoch=56.8] | Loss=0.00910 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.651 | L2-Norm(final)=10.102 | 4678.7 samples/s | 73.1 steps/s
[Step=11700 Epoch=57.0] | Loss=0.00895 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.656 | L2-Norm(final)=10.105 | 4696.6 samples/s | 73.4 steps/s
[Step=11750 Epoch=57.3] | Loss=0.00877 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.660 | L2-Norm(final)=10.108 | 1570.8 samples/s | 24.5 steps/s
[Step=11800 Epoch=57.5] | Loss=0.00852 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.665 | L2-Norm(final)=10.111 | 4688.9 samples/s | 73.3 steps/s
[Step=11850 Epoch=57.7] | Loss=0.00837 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.669 | L2-Norm(final)=10.114 | 4666.9 samples/s | 72.9 steps/s
[Step=11900 Epoch=58.0] | Loss=0.00826 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.673 | L2-Norm(final)=10.117 | 4657.8 samples/s | 72.8 steps/s
[Step=11950 Epoch=58.2] | Loss=0.00824 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.677 | L2-Norm(final)=10.120 | 1546.7 samples/s | 24.2 steps/s
[Step=12000 Epoch=58.5] | Loss=0.00811 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.681 | L2-Norm(final)=10.122 | 4780.2 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_2/client_state-step12000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=30001 Epoch=284.3] | Loss=0.00003 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=17.273 | 3162.1 samples/s | 49.4 steps/s
[Step=30050 Epoch=284.7] | Loss=0.00106 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=17.277 | 4537.1 samples/s | 70.9 steps/s
[Step=30100 Epoch=285.2] | Loss=0.00066 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=17.284 | 7779.5 samples/s | 121.6 steps/s
[Step=30150 Epoch=285.7] | Loss=0.00060 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=17.290 | 1455.3 samples/s | 22.7 steps/s
[Step=30200 Epoch=286.2] | Loss=0.00076 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=17.297 | 7226.1 samples/s | 112.9 steps/s
[Step=30250 Epoch=286.6] | Loss=0.00077 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=17.303 | 1518.3 samples/s | 23.7 steps/s
[Step=30300 Epoch=287.1] | Loss=0.00073 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=17.309 | 6410.7 samples/s | 100.2 steps/s
[Step=30350 Epoch=287.6] | Loss=0.00069 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=17.316 | 1533.0 samples/s | 24.0 steps/s
[Step=30400 Epoch=288.1] | Loss=0.00073 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=17.322 | 5772.8 samples/s | 90.2 steps/s
[Step=30450 Epoch=288.5] | Loss=0.00073 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=17.328 | 1549.4 samples/s | 24.2 steps/s
[Step=30500 Epoch=289.0] | Loss=0.00074 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=17.334 | 5281.1 samples/s | 82.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=30501 Epoch=289.0] | Loss=0.00046 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=17.392 | 3260.7 samples/s | 50.9 steps/s
[Step=30550 Epoch=289.5] | Loss=0.00131 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=17.397 | 3882.2 samples/s | 60.7 steps/s
[Step=30600 Epoch=290.0] | Loss=0.00108 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.399 | L2-Norm(final)=17.402 | 6377.3 samples/s | 99.6 steps/s
[Step=30650 Epoch=290.4] | Loss=0.00073 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=17.406 | 1404.9 samples/s | 22.0 steps/s
[Step=30700 Epoch=290.9] | Loss=0.00055 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=17.408 | 5835.4 samples/s | 91.2 steps/s
[Step=30750 Epoch=291.4] | Loss=0.00046 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=17.411 | 1451.5 samples/s | 22.7 steps/s
[Step=30800 Epoch=291.9] | Loss=0.00039 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.401 | L2-Norm(final)=17.412 | 5368.0 samples/s | 83.9 steps/s
[Step=30850 Epoch=292.3] | Loss=0.00033 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.396 | L2-Norm(final)=17.414 | 1449.1 samples/s | 22.6 steps/s
[Step=30900 Epoch=292.8] | Loss=0.00029 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.389 | L2-Norm(final)=17.415 | 4988.3 samples/s | 77.9 steps/s
[Step=30950 Epoch=293.3] | Loss=0.00026 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.382 | L2-Norm(final)=17.416 | 1468.9 samples/s | 23.0 steps/s
[Step=31000 Epoch=293.8] | Loss=0.00023 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.375 | L2-Norm(final)=17.417 | 4565.7 samples/s | 71.3 steps/s
[Step=31050 Epoch=294.2] | Loss=0.00021 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.368 | L2-Norm(final)=17.418 | 1526.4 samples/s | 23.9 steps/s
[Step=31100 Epoch=294.7] | Loss=0.00020 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.360 | L2-Norm(final)=17.419 | 4569.5 samples/s | 71.4 steps/s
[Step=31150 Epoch=295.2] | Loss=0.00018 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=17.419 | 1507.0 samples/s | 23.5 steps/s
[Step=31200 Epoch=295.6] | Loss=0.00017 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.344 | L2-Norm(final)=17.420 | 4382.3 samples/s | 68.5 steps/s
[Step=31250 Epoch=296.1] | Loss=0.00016 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.337 | L2-Norm(final)=17.421 | 1528.7 samples/s | 23.9 steps/s
[Step=31300 Epoch=296.6] | Loss=0.00015 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.329 | L2-Norm(final)=17.421 | 4454.6 samples/s | 69.6 steps/s
[Step=31350 Epoch=297.1] | Loss=0.00014 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.321 | L2-Norm(final)=17.422 | 1564.0 samples/s | 24.4 steps/s
[Step=31400 Epoch=297.5] | Loss=0.00013 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.313 | L2-Norm(final)=17.422 | 4165.7 samples/s | 65.1 steps/s
[Step=31450 Epoch=298.0] | Loss=0.00012 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.305 | L2-Norm(final)=17.423 | 6775.0 samples/s | 105.9 steps/s
[Step=31500 Epoch=298.5] | Loss=0.00012 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.297 | L2-Norm(final)=17.423 | 1368.5 samples/s | 21.4 steps/s
[Step=31550 Epoch=299.0] | Loss=0.00011 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.289 | L2-Norm(final)=17.423 | 5954.9 samples/s | 93.0 steps/s
[Step=31600 Epoch=299.4] | Loss=0.00011 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.281 | L2-Norm(final)=17.424 | 1426.5 samples/s | 22.3 steps/s
[Step=31650 Epoch=299.9] | Loss=0.00010 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.273 | L2-Norm(final)=17.424 | 5550.6 samples/s | 86.7 steps/s
[Step=31700 Epoch=300.4] | Loss=0.00010 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.265 | L2-Norm(final)=17.425 | 1425.8 samples/s | 22.3 steps/s
[Step=31750 Epoch=300.9] | Loss=0.00009 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.257 | L2-Norm(final)=17.425 | 5059.5 samples/s | 79.1 steps/s
[Step=31800 Epoch=301.3] | Loss=0.00009 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.249 | L2-Norm(final)=17.425 | 1477.5 samples/s | 23.1 steps/s
[Step=31850 Epoch=301.8] | Loss=0.00009 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.240 | L2-Norm(final)=17.426 | 4627.8 samples/s | 72.3 steps/s
[Step=31900 Epoch=302.3] | Loss=0.00008 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.232 | L2-Norm(final)=17.426 | 1484.3 samples/s | 23.2 steps/s
[Step=31950 Epoch=302.8] | Loss=0.00008 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=17.426 | 4459.1 samples/s | 69.7 steps/s
[Step=32000 Epoch=303.2] | Loss=0.00008 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.216 | L2-Norm(final)=17.427 | 1520.9 samples/s | 23.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step32000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=30001 Epoch=286.5] | Loss=0.00004 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=16.193 | 3273.4 samples/s | 51.1 steps/s
[Step=30050 Epoch=287.0] | Loss=0.00022 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.365 | L2-Norm(final)=16.199 | 4515.3 samples/s | 70.6 steps/s
[Step=30100 Epoch=287.4] | Loss=0.00020 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.365 | L2-Norm(final)=16.207 | 8220.0 samples/s | 128.4 steps/s
[Step=30150 Epoch=287.9] | Loss=0.00018 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=16.218 | 1450.7 samples/s | 22.7 steps/s
[Step=30200 Epoch=288.4] | Loss=0.00020 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=16.227 | 7350.4 samples/s | 114.9 steps/s
[Step=30250 Epoch=288.9] | Loss=0.00020 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=16.238 | 1476.6 samples/s | 23.1 steps/s
[Step=30300 Epoch=289.3] | Loss=0.00019 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=16.249 | 6517.3 samples/s | 101.8 steps/s
[Step=30350 Epoch=289.8] | Loss=0.00018 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=16.259 | 1495.0 samples/s | 23.4 steps/s
[Step=30400 Epoch=290.3] | Loss=0.00018 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=16.269 | 6237.6 samples/s | 97.5 steps/s
[Step=30450 Epoch=290.8] | Loss=0.00019 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=16.280 | 1517.3 samples/s | 23.7 steps/s
[Step=30500 Epoch=291.3] | Loss=0.00018 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=16.290 | 5649.6 samples/s | 88.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=30501 Epoch=291.3] | Loss=0.00007 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=16.396 | 3133.2 samples/s | 49.0 steps/s
[Step=30550 Epoch=291.7] | Loss=0.00270 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.397 | L2-Norm(final)=16.401 | 4030.8 samples/s | 63.0 steps/s
[Step=30600 Epoch=292.2] | Loss=0.00253 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=16.394 | 6599.6 samples/s | 103.1 steps/s
[Step=30650 Epoch=292.7] | Loss=0.00170 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.473 | L2-Norm(final)=16.391 | 1366.3 samples/s | 21.3 steps/s
[Step=30700 Epoch=293.2] | Loss=0.00130 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.480 | L2-Norm(final)=16.391 | 6075.9 samples/s | 94.9 steps/s
[Step=30750 Epoch=293.6] | Loss=0.00104 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.482 | L2-Norm(final)=16.390 | 1426.4 samples/s | 22.3 steps/s
[Step=30800 Epoch=294.1] | Loss=0.00087 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.480 | L2-Norm(final)=16.390 | 5622.7 samples/s | 87.9 steps/s
[Step=30850 Epoch=294.6] | Loss=0.00075 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.477 | L2-Norm(final)=16.391 | 1438.8 samples/s | 22.5 steps/s
[Step=30900 Epoch=295.1] | Loss=0.00065 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.473 | L2-Norm(final)=16.391 | 5103.6 samples/s | 79.7 steps/s
[Step=30950 Epoch=295.6] | Loss=0.00058 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.468 | L2-Norm(final)=16.391 | 1435.9 samples/s | 22.4 steps/s
[Step=31000 Epoch=296.0] | Loss=0.00052 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.463 | L2-Norm(final)=16.392 | 4865.0 samples/s | 76.0 steps/s
[Step=31050 Epoch=296.5] | Loss=0.00048 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.458 | L2-Norm(final)=16.392 | 1474.5 samples/s | 23.0 steps/s
[Step=31100 Epoch=297.0] | Loss=0.00044 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=16.392 | 4554.0 samples/s | 71.2 steps/s
[Step=31150 Epoch=297.5] | Loss=0.00040 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.446 | L2-Norm(final)=16.393 | 1510.6 samples/s | 23.6 steps/s
[Step=31200 Epoch=297.9] | Loss=0.00038 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.440 | L2-Norm(final)=16.393 | 4470.9 samples/s | 69.9 steps/s
[Step=31250 Epoch=298.4] | Loss=0.00035 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.434 | L2-Norm(final)=16.394 | 1534.1 samples/s | 24.0 steps/s
[Step=31300 Epoch=298.9] | Loss=0.00033 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=16.394 | 4414.7 samples/s | 69.0 steps/s
[Step=31350 Epoch=299.4] | Loss=0.00031 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.421 | L2-Norm(final)=16.394 | 1528.1 samples/s | 23.9 steps/s
[Step=31400 Epoch=299.9] | Loss=0.00029 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.414 | L2-Norm(final)=16.395 | 4542.9 samples/s | 71.0 steps/s
[Step=31450 Epoch=300.3] | Loss=0.00028 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=16.395 | 1518.4 samples/s | 23.7 steps/s
[Step=31500 Epoch=300.8] | Loss=0.00026 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.401 | L2-Norm(final)=16.396 | 4441.7 samples/s | 69.4 steps/s
[Step=31550 Epoch=301.3] | Loss=0.00025 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.395 | L2-Norm(final)=16.396 | 7289.0 samples/s | 113.9 steps/s
[Step=31600 Epoch=301.8] | Loss=0.00024 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.388 | L2-Norm(final)=16.397 | 1339.0 samples/s | 20.9 steps/s
[Step=31650 Epoch=302.2] | Loss=0.00023 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.382 | L2-Norm(final)=16.397 | 6585.1 samples/s | 102.9 steps/s
[Step=31700 Epoch=302.7] | Loss=0.00022 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.375 | L2-Norm(final)=16.398 | 1360.1 samples/s | 21.3 steps/s
[Step=31750 Epoch=303.2] | Loss=0.00021 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.368 | L2-Norm(final)=16.398 | 6099.2 samples/s | 95.3 steps/s
[Step=31800 Epoch=303.7] | Loss=0.00020 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.361 | L2-Norm(final)=16.398 | 1417.4 samples/s | 22.1 steps/s
[Step=31850 Epoch=304.1] | Loss=0.00020 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=16.399 | 5537.2 samples/s | 86.5 steps/s
[Step=31900 Epoch=304.6] | Loss=0.00019 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.348 | L2-Norm(final)=16.399 | 1422.1 samples/s | 22.2 steps/s
[Step=31950 Epoch=305.1] | Loss=0.00018 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=16.400 | 5228.2 samples/s | 81.7 steps/s
[Step=32000 Epoch=305.6] | Loss=0.00018 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.334 | L2-Norm(final)=16.400 | 1449.5 samples/s | 22.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09531 | acc=0.9612 | tpr=0.9728 | fpr=0.0642 | 4613.6 samples/s | 18.0 steps/s
Avg test loss: 0.09836, Avg test acc: 0.95973, Avg tpr: 0.97156, Avg fpr: 0.06627, total FA: 517

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09699 | acc=0.9601 | tpr=0.9805 | fpr=0.0842 | 4402.3 samples/s | 17.2 steps/s
Avg test loss: 0.10020, Avg test acc: 0.95901, Avg tpr: 0.98007, Avg fpr: 0.08730, total FA: 681

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08934 | acc=0.9602 | tpr=0.9744 | fpr=0.0706 | 4475.4 samples/s | 17.5 steps/s
Avg test loss: 0.09302, Avg test acc: 0.95965, Avg tpr: 0.97412, Avg fpr: 0.07217, total FA: 563

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09874 | acc=0.9620 | tpr=0.9788 | fpr=0.0746 | 4628.2 samples/s | 18.1 steps/s
Avg test loss: 0.10255, Avg test acc: 0.96037, Avg tpr: 0.97791, Avg fpr: 0.07820, total FA: 610

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08493 | acc=0.9610 | tpr=0.9715 | fpr=0.0617 | 4618.1 samples/s | 18.0 steps/s
Avg test loss: 0.09302, Avg test acc: 0.95993, Avg tpr: 0.97068, Avg fpr: 0.06371, total FA: 497

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.39096 | acc=0.3084 | tpr=0.0091 | fpr=0.0419 | 4700.8 samples/s | 18.4 steps/s
Avg test loss: 5.40666, Avg test acc: 0.30579, Avg tpr: 0.00903, Avg fpr: 0.04153, total FA: 324

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.64086 | acc=0.2929 | tpr=0.0163 | fpr=0.1065 | 4626.9 samples/s | 18.1 steps/s
Avg test loss: 4.66168, Avg test acc: 0.29061, Avg tpr: 0.01615, Avg fpr: 0.10576, total FA: 825

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.79138 | acc=0.3086 | tpr=0.0157 | fpr=0.0555 | 4709.7 samples/s | 18.4 steps/s
Avg test loss: 4.81048, Avg test acc: 0.30551, Avg tpr: 0.01504, Avg fpr: 0.05563, total FA: 434

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.13278 | acc=0.3139 | tpr=0.0298 | fpr=0.0691 | 4634.9 samples/s | 18.1 steps/s
Avg test loss: 4.15146, Avg test acc: 0.31184, Avg tpr: 0.02996, Avg fpr: 0.06820, total FA: 532

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.70606 | acc=0.3113 | tpr=0.0080 | fpr=0.0302 | 4548.6 samples/s | 17.8 steps/s
Avg test loss: 4.73503, Avg test acc: 0.30824, Avg tpr: 0.00723, Avg fpr: 0.02974, total FA: 232

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.22534 | acc=0.1420 | tpr=0.7389 | fpr=0.8687 | 4667.8 samples/s | 18.2 steps/s
[Step= 100] | Loss=6.19051 | acc=0.1446 | tpr=0.7079 | fpr=0.8659 | 8184.8 samples/s | 32.0 steps/s
[Step= 150] | Loss=6.19525 | acc=0.1454 | tpr=0.7118 | fpr=0.8650 | 7193.6 samples/s | 28.1 steps/s
[Step= 200] | Loss=6.18239 | acc=0.1456 | tpr=0.7158 | fpr=0.8648 | 8556.9 samples/s | 33.4 steps/s
[Step= 250] | Loss=6.17697 | acc=0.1465 | tpr=0.7074 | fpr=0.8637 | 7677.2 samples/s | 30.0 steps/s
[Step= 300] | Loss=6.16754 | acc=0.1474 | tpr=0.7076 | fpr=0.8628 | 8227.9 samples/s | 32.1 steps/s
[Step= 350] | Loss=6.17631 | acc=0.1471 | tpr=0.7107 | fpr=0.8631 | 7970.8 samples/s | 31.1 steps/s
[Step= 400] | Loss=6.17771 | acc=0.1471 | tpr=0.7090 | fpr=0.8632 | 8060.2 samples/s | 31.5 steps/s
[Step= 450] | Loss=6.17392 | acc=0.1470 | tpr=0.7079 | fpr=0.8632 | 7518.7 samples/s | 29.4 steps/s
[Step= 500] | Loss=6.17420 | acc=0.1472 | tpr=0.7031 | fpr=0.8628 | 7443.6 samples/s | 29.1 steps/s
[Step= 550] | Loss=6.17245 | acc=0.1476 | tpr=0.7087 | fpr=0.8625 | 11690.8 samples/s | 45.7 steps/s
Avg test loss: 6.17329, Avg test acc: 0.14756, Avg tpr: 0.70800, Avg fpr: 0.86263, total FA: 119774

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.75988 | acc=0.1191 | tpr=0.7788 | fpr=0.8927 | 4774.4 samples/s | 18.7 steps/s
[Step= 100] | Loss=6.72992 | acc=0.1217 | tpr=0.7676 | fpr=0.8904 | 7535.0 samples/s | 29.4 steps/s
[Step= 150] | Loss=6.72647 | acc=0.1235 | tpr=0.7781 | fpr=0.8886 | 8090.6 samples/s | 31.6 steps/s
[Step= 200] | Loss=6.71939 | acc=0.1234 | tpr=0.7705 | fpr=0.8884 | 7845.3 samples/s | 30.6 steps/s
[Step= 250] | Loss=6.71596 | acc=0.1238 | tpr=0.7712 | fpr=0.8880 | 7280.8 samples/s | 28.4 steps/s
[Step= 300] | Loss=6.71132 | acc=0.1242 | tpr=0.7716 | fpr=0.8876 | 7655.4 samples/s | 29.9 steps/s
[Step= 350] | Loss=6.72026 | acc=0.1237 | tpr=0.7714 | fpr=0.8881 | 8303.5 samples/s | 32.4 steps/s
[Step= 400] | Loss=6.72243 | acc=0.1235 | tpr=0.7702 | fpr=0.8882 | 8168.2 samples/s | 31.9 steps/s
[Step= 450] | Loss=6.72021 | acc=0.1235 | tpr=0.7648 | fpr=0.8882 | 8493.3 samples/s | 33.2 steps/s
[Step= 500] | Loss=6.72184 | acc=0.1235 | tpr=0.7581 | fpr=0.8880 | 8365.6 samples/s | 32.7 steps/s
[Step= 550] | Loss=6.72015 | acc=0.1237 | tpr=0.7636 | fpr=0.8880 | 9407.2 samples/s | 36.7 steps/s
Avg test loss: 6.72172, Avg test acc: 0.12355, Avg tpr: 0.76307, Avg fpr: 0.88807, total FA: 123307

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.96579 | acc=0.1300 | tpr=0.8053 | fpr=0.8821 | 4648.5 samples/s | 18.2 steps/s
[Step= 100] | Loss=5.93555 | acc=0.1326 | tpr=0.7761 | fpr=0.8794 | 7400.9 samples/s | 28.9 steps/s
[Step= 150] | Loss=5.93954 | acc=0.1334 | tpr=0.7867 | fpr=0.8786 | 7969.6 samples/s | 31.1 steps/s
[Step= 200] | Loss=5.92557 | acc=0.1335 | tpr=0.7869 | fpr=0.8784 | 8229.2 samples/s | 32.1 steps/s
[Step= 250] | Loss=5.92027 | acc=0.1339 | tpr=0.7808 | fpr=0.8779 | 8227.7 samples/s | 32.1 steps/s
[Step= 300] | Loss=5.91530 | acc=0.1340 | tpr=0.7825 | fpr=0.8778 | 7973.2 samples/s | 31.1 steps/s
[Step= 350] | Loss=5.92491 | acc=0.1336 | tpr=0.7815 | fpr=0.8782 | 7820.8 samples/s | 30.5 steps/s
[Step= 400] | Loss=5.92771 | acc=0.1334 | tpr=0.7839 | fpr=0.8784 | 7920.8 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.92470 | acc=0.1336 | tpr=0.7819 | fpr=0.8782 | 7712.6 samples/s | 30.1 steps/s
[Step= 500] | Loss=5.92485 | acc=0.1337 | tpr=0.7793 | fpr=0.8780 | 7501.6 samples/s | 29.3 steps/s
[Step= 550] | Loss=5.92428 | acc=0.1339 | tpr=0.7799 | fpr=0.8779 | 12341.2 samples/s | 48.2 steps/s
Avg test loss: 5.92474, Avg test acc: 0.13375, Avg tpr: 0.77932, Avg fpr: 0.87799, total FA: 121907

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=7.45509 | acc=0.1260 | tpr=0.7876 | fpr=0.8859 | 4611.2 samples/s | 18.0 steps/s
[Step= 100] | Loss=7.41939 | acc=0.1280 | tpr=0.7868 | fpr=0.8843 | 7965.9 samples/s | 31.1 steps/s
[Step= 150] | Loss=7.41972 | acc=0.1293 | tpr=0.7867 | fpr=0.8828 | 7776.7 samples/s | 30.4 steps/s
[Step= 200] | Loss=7.40957 | acc=0.1292 | tpr=0.7803 | fpr=0.8827 | 8065.6 samples/s | 31.5 steps/s
[Step= 250] | Loss=7.40446 | acc=0.1295 | tpr=0.7790 | fpr=0.8824 | 7958.5 samples/s | 31.1 steps/s
[Step= 300] | Loss=7.39936 | acc=0.1295 | tpr=0.7796 | fpr=0.8823 | 7519.1 samples/s | 29.4 steps/s
[Step= 350] | Loss=7.41262 | acc=0.1289 | tpr=0.7858 | fpr=0.8831 | 7901.3 samples/s | 30.9 steps/s
[Step= 400] | Loss=7.41332 | acc=0.1290 | tpr=0.7850 | fpr=0.8830 | 7579.6 samples/s | 29.6 steps/s
[Step= 450] | Loss=7.41165 | acc=0.1289 | tpr=0.7824 | fpr=0.8829 | 8204.0 samples/s | 32.0 steps/s
[Step= 500] | Loss=7.41259 | acc=0.1288 | tpr=0.7806 | fpr=0.8829 | 8539.6 samples/s | 33.4 steps/s
[Step= 550] | Loss=7.41190 | acc=0.1291 | tpr=0.7835 | fpr=0.8828 | 10226.8 samples/s | 39.9 steps/s
Avg test loss: 7.41328, Avg test acc: 0.12896, Avg tpr: 0.78249, Avg fpr: 0.88292, total FA: 122592

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.91328 | acc=0.1377 | tpr=0.7566 | fpr=0.8734 | 4715.9 samples/s | 18.4 steps/s
[Step= 100] | Loss=5.88643 | acc=0.1403 | tpr=0.7356 | fpr=0.8708 | 7954.7 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.89297 | acc=0.1418 | tpr=0.7291 | fpr=0.8690 | 7430.1 samples/s | 29.0 steps/s
[Step= 200] | Loss=5.88647 | acc=0.1412 | tpr=0.7268 | fpr=0.8695 | 7860.7 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.88454 | acc=0.1419 | tpr=0.7284 | fpr=0.8688 | 7738.4 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.87860 | acc=0.1426 | tpr=0.7345 | fpr=0.8682 | 7983.4 samples/s | 31.2 steps/s
[Step= 350] | Loss=5.88702 | acc=0.1421 | tpr=0.7332 | fpr=0.8686 | 7943.1 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.88660 | acc=0.1418 | tpr=0.7281 | fpr=0.8688 | 8000.9 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.88332 | acc=0.1419 | tpr=0.7215 | fpr=0.8686 | 8238.2 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.88604 | acc=0.1417 | tpr=0.7185 | fpr=0.8687 | 7803.0 samples/s | 30.5 steps/s
[Step= 550] | Loss=5.88576 | acc=0.1423 | tpr=0.7207 | fpr=0.8682 | 10692.0 samples/s | 41.8 steps/s
Avg test loss: 5.88681, Avg test acc: 0.14219, Avg tpr: 0.72029, Avg fpr: 0.86832, total FA: 120565

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19262 | acc=0.9615 | tpr=0.9292 | fpr=0.0379 | 4698.1 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.19465 | acc=0.9607 | tpr=0.9318 | fpr=0.0387 | 7680.4 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.19852 | acc=0.9594 | tpr=0.9366 | fpr=0.0402 | 8051.7 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.19957 | acc=0.9597 | tpr=0.9410 | fpr=0.0400 | 7018.7 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.20075 | acc=0.9593 | tpr=0.9389 | fpr=0.0404 | 8340.2 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.20234 | acc=0.9586 | tpr=0.9367 | fpr=0.0410 | 7775.9 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.20235 | acc=0.9585 | tpr=0.9374 | fpr=0.0411 | 7886.2 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.20348 | acc=0.9583 | tpr=0.9344 | fpr=0.0413 | 7729.5 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.20473 | acc=0.9580 | tpr=0.9314 | fpr=0.0415 | 8091.1 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.20443 | acc=0.9580 | tpr=0.9322 | fpr=0.0416 | 8270.9 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.20425 | acc=0.9580 | tpr=0.9292 | fpr=0.0415 | 11483.2 samples/s | 44.9 steps/s
Avg test loss: 0.20405, Avg test acc: 0.95799, Avg tpr: 0.92868, Avg fpr: 0.04148, total FA: 5759

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14610 | acc=0.9638 | tpr=0.9381 | fpr=0.0357 | 4483.8 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.14977 | acc=0.9630 | tpr=0.9296 | fpr=0.0364 | 8256.1 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.15161 | acc=0.9621 | tpr=0.9280 | fpr=0.0373 | 8257.0 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.15176 | acc=0.9624 | tpr=0.9333 | fpr=0.0370 | 7575.6 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.15309 | acc=0.9621 | tpr=0.9328 | fpr=0.0374 | 8334.6 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.15360 | acc=0.9618 | tpr=0.9345 | fpr=0.0377 | 8193.3 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.15346 | acc=0.9618 | tpr=0.9361 | fpr=0.0377 | 8060.2 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.15478 | acc=0.9615 | tpr=0.9316 | fpr=0.0380 | 7774.8 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.15495 | acc=0.9613 | tpr=0.9304 | fpr=0.0381 | 7390.3 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.15476 | acc=0.9614 | tpr=0.9322 | fpr=0.0381 | 8382.0 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.15476 | acc=0.9615 | tpr=0.9300 | fpr=0.0380 | 10324.3 samples/s | 40.3 steps/s
Avg test loss: 0.15440, Avg test acc: 0.96149, Avg tpr: 0.93027, Avg fpr: 0.03794, total FA: 5268

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.28746 | acc=0.9486 | tpr=0.9336 | fpr=0.0511 | 4652.7 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.29665 | acc=0.9470 | tpr=0.9424 | fpr=0.0529 | 7732.3 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.30329 | acc=0.9459 | tpr=0.9438 | fpr=0.0540 | 8099.3 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.30724 | acc=0.9453 | tpr=0.9454 | fpr=0.0547 | 7861.0 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.30896 | acc=0.9451 | tpr=0.9476 | fpr=0.0550 | 7881.6 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.31098 | acc=0.9447 | tpr=0.9476 | fpr=0.0554 | 8320.9 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.31177 | acc=0.9447 | tpr=0.9499 | fpr=0.0554 | 8271.7 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.31452 | acc=0.9444 | tpr=0.9480 | fpr=0.0557 | 7762.7 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.31499 | acc=0.9442 | tpr=0.9469 | fpr=0.0559 | 7800.8 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.31517 | acc=0.9439 | tpr=0.9480 | fpr=0.0562 | 8441.8 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.31408 | acc=0.9439 | tpr=0.9471 | fpr=0.0561 | 9272.6 samples/s | 36.2 steps/s
Avg test loss: 0.31365, Avg test acc: 0.94397, Avg tpr: 0.94731, Avg fpr: 0.05609, total FA: 7788

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.14205 | acc=0.9613 | tpr=0.9425 | fpr=0.0383 | 4739.8 samples/s | 18.5 steps/s
[Step= 100] | Loss=0.14441 | acc=0.9614 | tpr=0.9424 | fpr=0.0382 | 7948.5 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.14905 | acc=0.9602 | tpr=0.9424 | fpr=0.0395 | 7006.4 samples/s | 27.4 steps/s
[Step= 200] | Loss=0.15025 | acc=0.9602 | tpr=0.9464 | fpr=0.0395 | 8044.8 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.15121 | acc=0.9601 | tpr=0.9450 | fpr=0.0396 | 8051.1 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.15277 | acc=0.9597 | tpr=0.9425 | fpr=0.0399 | 8227.0 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.15371 | acc=0.9596 | tpr=0.9418 | fpr=0.0401 | 7280.0 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.15530 | acc=0.9594 | tpr=0.9393 | fpr=0.0402 | 8140.3 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.15541 | acc=0.9592 | tpr=0.9387 | fpr=0.0404 | 7983.6 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.15480 | acc=0.9593 | tpr=0.9405 | fpr=0.0404 | 7916.5 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.15439 | acc=0.9594 | tpr=0.9371 | fpr=0.0402 | 12017.3 samples/s | 46.9 steps/s
Avg test loss: 0.15414, Avg test acc: 0.95945, Avg tpr: 0.93740, Avg fpr: 0.04015, total FA: 5575

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.20357 | acc=0.9570 | tpr=0.9027 | fpr=0.0420 | 4757.6 samples/s | 18.6 steps/s
[Step= 100] | Loss=0.21095 | acc=0.9563 | tpr=0.9147 | fpr=0.0430 | 8017.1 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.21397 | acc=0.9554 | tpr=0.9236 | fpr=0.0441 | 7541.0 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.21490 | acc=0.9553 | tpr=0.9268 | fpr=0.0442 | 8210.5 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.21734 | acc=0.9549 | tpr=0.9284 | fpr=0.0446 | 8094.8 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.21962 | acc=0.9544 | tpr=0.9287 | fpr=0.0451 | 8059.0 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.21962 | acc=0.9545 | tpr=0.9299 | fpr=0.0450 | 8751.3 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.22105 | acc=0.9542 | tpr=0.9261 | fpr=0.0453 | 7984.4 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.22237 | acc=0.9539 | tpr=0.9270 | fpr=0.0456 | 7666.0 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.22317 | acc=0.9537 | tpr=0.9282 | fpr=0.0459 | 7327.3 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.22238 | acc=0.9538 | tpr=0.9256 | fpr=0.0457 | 11275.8 samples/s | 44.0 steps/s
Avg test loss: 0.22197, Avg test acc: 0.95384, Avg tpr: 0.92552, Avg fpr: 0.04565, total FA: 6338

server round 26/50

clients selected: [1 4 7 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=126.9] | Loss=0.05518 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.289 | L2-Norm(final)=12.159 | 3253.1 samples/s | 50.8 steps/s
[Step=26050 Epoch=127.1] | Loss=0.03046 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.290 | L2-Norm(final)=12.148 | 4663.2 samples/s | 72.9 steps/s
[Step=26100 Epoch=127.4] | Loss=0.03088 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.290 | L2-Norm(final)=12.138 | 5528.5 samples/s | 86.4 steps/s
[Step=26150 Epoch=127.6] | Loss=0.02897 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.290 | L2-Norm(final)=12.127 | 5386.8 samples/s | 84.2 steps/s
[Step=26200 Epoch=127.8] | Loss=0.02826 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.290 | L2-Norm(final)=12.120 | 8646.5 samples/s | 135.1 steps/s
[Step=26250 Epoch=128.1] | Loss=0.02759 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.290 | L2-Norm(final)=12.116 | 1494.9 samples/s | 23.4 steps/s
[Step=26300 Epoch=128.3] | Loss=0.02854 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.290 | L2-Norm(final)=12.110 | 5351.7 samples/s | 83.6 steps/s
[Step=26350 Epoch=128.6] | Loss=0.02865 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.290 | L2-Norm(final)=12.104 | 5439.1 samples/s | 85.0 steps/s
[Step=26400 Epoch=128.8] | Loss=0.02807 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.290 | L2-Norm(final)=12.098 | 7754.8 samples/s | 121.2 steps/s
[Step=26450 Epoch=129.1] | Loss=0.02786 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.290 | L2-Norm(final)=12.095 | 1512.0 samples/s | 23.6 steps/s
[Step=26500 Epoch=129.3] | Loss=0.02748 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.290 | L2-Norm(final)=12.092 | 5530.8 samples/s | 86.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=129.3] | Loss=0.05294 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.290 | L2-Norm(final)=12.072 | 3398.6 samples/s | 53.1 steps/s
[Step=26550 Epoch=129.6] | Loss=0.03215 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.324 | L2-Norm(final)=12.065 | 3902.4 samples/s | 61.0 steps/s
[Step=26600 Epoch=129.8] | Loss=0.03044 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.360 | L2-Norm(final)=12.059 | 4725.2 samples/s | 73.8 steps/s
[Step=26650 Epoch=130.0] | Loss=0.02777 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.388 | L2-Norm(final)=12.056 | 4638.1 samples/s | 72.5 steps/s
[Step=26700 Epoch=130.3] | Loss=0.02498 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.411 | L2-Norm(final)=12.057 | 6764.0 samples/s | 105.7 steps/s
[Step=26750 Epoch=130.5] | Loss=0.02197 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=12.060 | 1400.5 samples/s | 21.9 steps/s
[Step=26800 Epoch=130.8] | Loss=0.01971 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.445 | L2-Norm(final)=12.063 | 4686.5 samples/s | 73.2 steps/s
[Step=26850 Epoch=131.0] | Loss=0.01835 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.458 | L2-Norm(final)=12.066 | 4688.9 samples/s | 73.3 steps/s
[Step=26900 Epoch=131.3] | Loss=0.01704 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.469 | L2-Norm(final)=12.069 | 6280.0 samples/s | 98.1 steps/s
[Step=26950 Epoch=131.5] | Loss=0.01593 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.479 | L2-Norm(final)=12.073 | 1447.4 samples/s | 22.6 steps/s
[Step=27000 Epoch=131.7] | Loss=0.01489 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.488 | L2-Norm(final)=12.076 | 4713.1 samples/s | 73.6 steps/s
[Step=27050 Epoch=132.0] | Loss=0.01418 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.496 | L2-Norm(final)=12.079 | 4639.0 samples/s | 72.5 steps/s
[Step=27100 Epoch=132.2] | Loss=0.01354 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=12.082 | 5818.0 samples/s | 90.9 steps/s
[Step=27150 Epoch=132.5] | Loss=0.01288 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.510 | L2-Norm(final)=12.085 | 1478.8 samples/s | 23.1 steps/s
[Step=27200 Epoch=132.7] | Loss=0.01232 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.516 | L2-Norm(final)=12.087 | 4696.6 samples/s | 73.4 steps/s
[Step=27250 Epoch=133.0] | Loss=0.01184 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.521 | L2-Norm(final)=12.090 | 4713.0 samples/s | 73.6 steps/s
[Step=27300 Epoch=133.2] | Loss=0.01144 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.527 | L2-Norm(final)=12.093 | 5363.9 samples/s | 83.8 steps/s
[Step=27350 Epoch=133.5] | Loss=0.01109 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.532 | L2-Norm(final)=12.096 | 1465.3 samples/s | 22.9 steps/s
[Step=27400 Epoch=133.7] | Loss=0.01064 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.536 | L2-Norm(final)=12.098 | 4751.0 samples/s | 74.2 steps/s
[Step=27450 Epoch=133.9] | Loss=0.01033 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.540 | L2-Norm(final)=12.101 | 4662.9 samples/s | 72.9 steps/s
[Step=27500 Epoch=134.2] | Loss=0.01008 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.545 | L2-Norm(final)=12.103 | 5026.4 samples/s | 78.5 steps/s
[Step=27550 Epoch=134.4] | Loss=0.00985 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.548 | L2-Norm(final)=12.106 | 1536.0 samples/s | 24.0 steps/s
[Step=27600 Epoch=134.7] | Loss=0.00958 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.552 | L2-Norm(final)=12.108 | 4576.8 samples/s | 71.5 steps/s
[Step=27650 Epoch=134.9] | Loss=0.00932 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.556 | L2-Norm(final)=12.111 | 4756.3 samples/s | 74.3 steps/s
[Step=27700 Epoch=135.2] | Loss=0.00904 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.560 | L2-Norm(final)=12.114 | 4703.5 samples/s | 73.5 steps/s
[Step=27750 Epoch=135.4] | Loss=0.00884 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.563 | L2-Norm(final)=12.116 | 1521.1 samples/s | 23.8 steps/s
[Step=27800 Epoch=135.7] | Loss=0.00863 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.567 | L2-Norm(final)=12.119 | 4732.1 samples/s | 73.9 steps/s
[Step=27850 Epoch=135.9] | Loss=0.00847 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.570 | L2-Norm(final)=12.121 | 4645.3 samples/s | 72.6 steps/s
[Step=27900 Epoch=136.1] | Loss=0.00833 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.573 | L2-Norm(final)=12.124 | 4682.0 samples/s | 73.2 steps/s
[Step=27950 Epoch=136.4] | Loss=0.00816 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.576 | L2-Norm(final)=12.126 | 1590.6 samples/s | 24.9 steps/s
[Step=28000 Epoch=136.6] | Loss=0.00803 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.579 | L2-Norm(final)=12.128 | 4687.2 samples/s | 73.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_1/client_state-step28000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=16001 Epoch=78.5] | Loss=0.07402 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.289 | L2-Norm(final)=11.301 | 3063.5 samples/s | 47.9 steps/s
[Step=16050 Epoch=78.7] | Loss=0.02508 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.290 | L2-Norm(final)=11.301 | 5185.9 samples/s | 81.0 steps/s
[Step=16100 Epoch=79.0] | Loss=0.02293 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.290 | L2-Norm(final)=11.309 | 5321.9 samples/s | 83.2 steps/s
[Step=16150 Epoch=79.2] | Loss=0.02382 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.290 | L2-Norm(final)=11.319 | 5473.4 samples/s | 85.5 steps/s
[Step=16200 Epoch=79.4] | Loss=0.02505 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.290 | L2-Norm(final)=11.327 | 8856.9 samples/s | 138.4 steps/s
[Step=16250 Epoch=79.7] | Loss=0.02441 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.290 | L2-Norm(final)=11.333 | 1484.0 samples/s | 23.2 steps/s
[Step=16300 Epoch=79.9] | Loss=0.02456 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.290 | L2-Norm(final)=11.340 | 5439.0 samples/s | 85.0 steps/s
[Step=16350 Epoch=80.2] | Loss=0.02455 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.290 | L2-Norm(final)=11.347 | 5513.7 samples/s | 86.2 steps/s
[Step=16400 Epoch=80.4] | Loss=0.02484 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.291 | L2-Norm(final)=11.353 | 7972.5 samples/s | 124.6 steps/s
[Step=16450 Epoch=80.7] | Loss=0.02486 | Reg=0.00127 | acc=0.9375 | L2-Norm=11.291 | L2-Norm(final)=11.358 | 1496.8 samples/s | 23.4 steps/s
[Step=16500 Epoch=80.9] | Loss=0.02454 | Reg=0.00127 | acc=0.9531 | L2-Norm=11.291 | L2-Norm(final)=11.363 | 5333.8 samples/s | 83.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=16501 Epoch=80.9] | Loss=0.07852 | Reg=0.00127 | acc=0.9531 | L2-Norm=11.291 | L2-Norm(final)=11.419 | 3208.9 samples/s | 50.1 steps/s
[Step=16550 Epoch=81.2] | Loss=0.02864 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.325 | L2-Norm(final)=11.418 | 4174.2 samples/s | 65.2 steps/s
[Step=16600 Epoch=81.4] | Loss=0.02932 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=11.414 | 4693.0 samples/s | 73.3 steps/s
[Step=16650 Epoch=81.6] | Loss=0.02725 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.382 | L2-Norm(final)=11.414 | 4671.2 samples/s | 73.0 steps/s
[Step=16700 Epoch=81.9] | Loss=0.02536 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=11.417 | 6941.1 samples/s | 108.5 steps/s
[Step=16750 Epoch=82.1] | Loss=0.02224 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.429 | L2-Norm(final)=11.421 | 1402.7 samples/s | 21.9 steps/s
[Step=16800 Epoch=82.4] | Loss=0.01992 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.448 | L2-Norm(final)=11.425 | 4690.8 samples/s | 73.3 steps/s
[Step=16850 Epoch=82.6] | Loss=0.01856 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.463 | L2-Norm(final)=11.430 | 4727.1 samples/s | 73.9 steps/s
[Step=16900 Epoch=82.9] | Loss=0.01739 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.477 | L2-Norm(final)=11.435 | 6377.1 samples/s | 99.6 steps/s
[Step=16950 Epoch=83.1] | Loss=0.01637 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=11.439 | 1445.3 samples/s | 22.6 steps/s
[Step=17000 Epoch=83.4] | Loss=0.01529 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.500 | L2-Norm(final)=11.443 | 4649.6 samples/s | 72.7 steps/s
[Step=17050 Epoch=83.6] | Loss=0.01461 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.510 | L2-Norm(final)=11.447 | 4637.7 samples/s | 72.5 steps/s
[Step=17100 Epoch=83.9] | Loss=0.01391 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.519 | L2-Norm(final)=11.451 | 6074.9 samples/s | 94.9 steps/s
[Step=17150 Epoch=84.1] | Loss=0.01315 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.527 | L2-Norm(final)=11.455 | 1444.0 samples/s | 22.6 steps/s
[Step=17200 Epoch=84.3] | Loss=0.01259 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.535 | L2-Norm(final)=11.458 | 4761.0 samples/s | 74.4 steps/s
[Step=17250 Epoch=84.6] | Loss=0.01213 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.542 | L2-Norm(final)=11.462 | 4698.2 samples/s | 73.4 steps/s
[Step=17300 Epoch=84.8] | Loss=0.01184 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.548 | L2-Norm(final)=11.466 | 5599.3 samples/s | 87.5 steps/s
[Step=17350 Epoch=85.1] | Loss=0.01133 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.554 | L2-Norm(final)=11.469 | 1458.3 samples/s | 22.8 steps/s
[Step=17400 Epoch=85.3] | Loss=0.01092 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.560 | L2-Norm(final)=11.472 | 4671.5 samples/s | 73.0 steps/s
[Step=17450 Epoch=85.6] | Loss=0.01064 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.566 | L2-Norm(final)=11.475 | 4686.9 samples/s | 73.2 steps/s
[Step=17500 Epoch=85.8] | Loss=0.01038 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.571 | L2-Norm(final)=11.478 | 5379.1 samples/s | 84.0 steps/s
[Step=17550 Epoch=86.1] | Loss=0.01005 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.576 | L2-Norm(final)=11.481 | 1491.3 samples/s | 23.3 steps/s
[Step=17600 Epoch=86.3] | Loss=0.00974 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=11.485 | 4609.8 samples/s | 72.0 steps/s
[Step=17650 Epoch=86.6] | Loss=0.00949 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.585 | L2-Norm(final)=11.488 | 4689.5 samples/s | 73.3 steps/s
[Step=17700 Epoch=86.8] | Loss=0.00927 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.590 | L2-Norm(final)=11.491 | 5163.5 samples/s | 80.7 steps/s
[Step=17750 Epoch=87.0] | Loss=0.00906 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.594 | L2-Norm(final)=11.494 | 1492.8 samples/s | 23.3 steps/s
[Step=17800 Epoch=87.3] | Loss=0.00883 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.599 | L2-Norm(final)=11.498 | 4733.5 samples/s | 74.0 steps/s
[Step=17850 Epoch=87.5] | Loss=0.00861 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.603 | L2-Norm(final)=11.501 | 4601.4 samples/s | 71.9 steps/s
[Step=17900 Epoch=87.8] | Loss=0.00843 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.607 | L2-Norm(final)=11.504 | 4895.1 samples/s | 76.5 steps/s
[Step=17950 Epoch=88.0] | Loss=0.00826 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.610 | L2-Norm(final)=11.507 | 1555.6 samples/s | 24.3 steps/s
[Step=18000 Epoch=88.3] | Loss=0.00810 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.614 | L2-Norm(final)=11.510 | 4697.6 samples/s | 73.4 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_4/client_state-step18000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=32001 Epoch=305.6] | Loss=0.00013 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.289 | L2-Norm(final)=16.414 | 3227.1 samples/s | 50.4 steps/s
[Step=32050 Epoch=306.1] | Loss=0.00013 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=16.416 | 4548.2 samples/s | 71.1 steps/s
[Step=32100 Epoch=306.5] | Loss=0.00018 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=16.422 | 8259.1 samples/s | 129.0 steps/s
[Step=32150 Epoch=307.0] | Loss=0.00016 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=16.429 | 1493.2 samples/s | 23.3 steps/s
[Step=32200 Epoch=307.5] | Loss=0.00017 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=16.435 | 6945.1 samples/s | 108.5 steps/s
[Step=32250 Epoch=308.0] | Loss=0.00016 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=16.441 | 1480.1 samples/s | 23.1 steps/s
[Step=32300 Epoch=308.4] | Loss=0.00017 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=16.446 | 6830.9 samples/s | 106.7 steps/s
[Step=32350 Epoch=308.9] | Loss=0.00016 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=16.452 | 1477.6 samples/s | 23.1 steps/s
[Step=32400 Epoch=309.4] | Loss=0.00017 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=16.458 | 6251.8 samples/s | 97.7 steps/s
[Step=32450 Epoch=309.9] | Loss=0.00016 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=16.464 | 1577.4 samples/s | 24.6 steps/s
[Step=32500 Epoch=310.4] | Loss=0.00017 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=16.469 | 5691.4 samples/s | 88.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=32501 Epoch=310.4] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=16.528 | 3231.8 samples/s | 50.5 steps/s
[Step=32550 Epoch=310.8] | Loss=0.00007 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.277 | L2-Norm(final)=16.534 | 3968.0 samples/s | 62.0 steps/s
[Step=32600 Epoch=311.3] | Loss=0.00004 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.270 | L2-Norm(final)=16.538 | 6643.8 samples/s | 103.8 steps/s
[Step=32650 Epoch=311.8] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.258 | L2-Norm(final)=16.540 | 1386.0 samples/s | 21.7 steps/s
[Step=32700 Epoch=312.3] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=16.541 | 5927.6 samples/s | 92.6 steps/s
[Step=32750 Epoch=312.7] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.232 | L2-Norm(final)=16.542 | 1379.1 samples/s | 21.5 steps/s
[Step=32800 Epoch=313.2] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=16.543 | 5629.4 samples/s | 88.0 steps/s
[Step=32850 Epoch=313.7] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=16.543 | 1408.9 samples/s | 22.0 steps/s
[Step=32900 Epoch=314.2] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.192 | L2-Norm(final)=16.543 | 5215.8 samples/s | 81.5 steps/s
[Step=32950 Epoch=314.7] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.179 | L2-Norm(final)=16.544 | 1481.4 samples/s | 23.1 steps/s
[Step=33000 Epoch=315.1] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.166 | L2-Norm(final)=16.544 | 4784.6 samples/s | 74.8 steps/s
[Step=33050 Epoch=315.6] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.153 | L2-Norm(final)=16.545 | 1482.1 samples/s | 23.2 steps/s
[Step=33100 Epoch=316.1] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.141 | L2-Norm(final)=16.545 | 4549.8 samples/s | 71.1 steps/s
[Step=33150 Epoch=316.6] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.128 | L2-Norm(final)=16.546 | 1501.1 samples/s | 23.5 steps/s
[Step=33200 Epoch=317.0] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.115 | L2-Norm(final)=16.546 | 4505.1 samples/s | 70.4 steps/s
[Step=33250 Epoch=317.5] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.103 | L2-Norm(final)=16.546 | 1527.7 samples/s | 23.9 steps/s
[Step=33300 Epoch=318.0] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.090 | L2-Norm(final)=16.547 | 4314.4 samples/s | 67.4 steps/s
[Step=33350 Epoch=318.5] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.078 | L2-Norm(final)=16.547 | 1519.9 samples/s | 23.7 steps/s
[Step=33400 Epoch=318.9] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.065 | L2-Norm(final)=16.547 | 4489.4 samples/s | 70.1 steps/s
[Step=33450 Epoch=319.4] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.053 | L2-Norm(final)=16.548 | 1534.1 samples/s | 24.0 steps/s
[Step=33500 Epoch=319.9] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.041 | L2-Norm(final)=16.548 | 4479.4 samples/s | 70.0 steps/s
[Step=33550 Epoch=320.4] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.028 | L2-Norm(final)=16.549 | 7192.9 samples/s | 112.4 steps/s
[Step=33600 Epoch=320.9] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=16.549 | 1356.2 samples/s | 21.2 steps/s
[Step=33650 Epoch=321.3] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.003 | L2-Norm(final)=16.549 | 6592.5 samples/s | 103.0 steps/s
[Step=33700 Epoch=321.8] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.991 | L2-Norm(final)=16.550 | 1388.2 samples/s | 21.7 steps/s
[Step=33750 Epoch=322.3] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.978 | L2-Norm(final)=16.550 | 5922.2 samples/s | 92.5 steps/s
[Step=33800 Epoch=322.8] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.965 | L2-Norm(final)=16.551 | 1414.5 samples/s | 22.1 steps/s
[Step=33850 Epoch=323.2] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.953 | L2-Norm(final)=16.551 | 5656.2 samples/s | 88.4 steps/s
[Step=33900 Epoch=323.7] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.940 | L2-Norm(final)=16.551 | 1450.2 samples/s | 22.7 steps/s
[Step=33950 Epoch=324.2] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.928 | L2-Norm(final)=16.552 | 5166.9 samples/s | 80.7 steps/s
[Step=34000 Epoch=324.7] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.915 | L2-Norm(final)=16.552 | 1421.0 samples/s | 22.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step34000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=18001 Epoch=169.6] | Loss=0.00024 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.289 | L2-Norm(final)=13.104 | 3167.8 samples/s | 49.5 steps/s
[Step=18050 Epoch=170.1] | Loss=0.00199 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=13.114 | 4399.5 samples/s | 68.7 steps/s
[Step=18100 Epoch=170.6] | Loss=0.00164 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=13.125 | 7862.1 samples/s | 122.8 steps/s
[Step=18150 Epoch=171.0] | Loss=0.00163 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=13.137 | 1433.7 samples/s | 22.4 steps/s
[Step=18200 Epoch=171.5] | Loss=0.00161 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=13.151 | 6438.7 samples/s | 100.6 steps/s
[Step=18250 Epoch=172.0] | Loss=0.00162 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=13.164 | 1470.1 samples/s | 23.0 steps/s
[Step=18300 Epoch=172.4] | Loss=0.00150 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=13.177 | 6098.9 samples/s | 95.3 steps/s
[Step=18350 Epoch=172.9] | Loss=0.00162 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=13.190 | 1490.0 samples/s | 23.3 steps/s
[Step=18400 Epoch=173.4] | Loss=0.00157 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=13.204 | 5453.9 samples/s | 85.2 steps/s
[Step=18450 Epoch=173.9] | Loss=0.00150 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=13.217 | 1548.7 samples/s | 24.2 steps/s
[Step=18500 Epoch=174.3] | Loss=0.00149 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.285 | L2-Norm(final)=13.231 | 5098.5 samples/s | 79.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=174.3] | Loss=0.00018 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=13.363 | 3187.9 samples/s | 49.8 steps/s
[Step=18550 Epoch=174.8] | Loss=0.00201 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.316 | L2-Norm(final)=13.374 | 3796.4 samples/s | 59.3 steps/s
[Step=18600 Epoch=175.3] | Loss=0.00221 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.383 | L2-Norm(final)=13.377 | 6360.8 samples/s | 99.4 steps/s
[Step=18650 Epoch=175.7] | Loss=0.00156 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.421 | L2-Norm(final)=13.382 | 1361.4 samples/s | 21.3 steps/s
[Step=18700 Epoch=176.2] | Loss=0.00118 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.438 | L2-Norm(final)=13.384 | 5649.3 samples/s | 88.3 steps/s
[Step=18750 Epoch=176.7] | Loss=0.00095 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.445 | L2-Norm(final)=13.386 | 1390.2 samples/s | 21.7 steps/s
[Step=18800 Epoch=177.1] | Loss=0.00079 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.448 | L2-Norm(final)=13.388 | 5116.9 samples/s | 80.0 steps/s
[Step=18850 Epoch=177.6] | Loss=0.00068 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.447 | L2-Norm(final)=13.389 | 1423.6 samples/s | 22.2 steps/s
[Step=18900 Epoch=178.1] | Loss=0.00059 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.445 | L2-Norm(final)=13.390 | 4639.2 samples/s | 72.5 steps/s
[Step=18950 Epoch=178.6] | Loss=0.00053 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.442 | L2-Norm(final)=13.391 | 1478.8 samples/s | 23.1 steps/s
[Step=19000 Epoch=179.0] | Loss=0.00048 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.438 | L2-Norm(final)=13.392 | 4366.3 samples/s | 68.2 steps/s
[Step=19050 Epoch=179.5] | Loss=0.00043 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.434 | L2-Norm(final)=13.393 | 1488.9 samples/s | 23.3 steps/s
[Step=19100 Epoch=180.0] | Loss=0.00040 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=13.393 | 4464.4 samples/s | 69.8 steps/s
[Step=19150 Epoch=180.4] | Loss=0.00037 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=13.394 | 1506.5 samples/s | 23.5 steps/s
[Step=19200 Epoch=180.9] | Loss=0.00034 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.419 | L2-Norm(final)=13.394 | 4463.2 samples/s | 69.7 steps/s
[Step=19250 Epoch=181.4] | Loss=0.00032 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=13.395 | 1581.9 samples/s | 24.7 steps/s
[Step=19300 Epoch=181.9] | Loss=0.00030 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=13.395 | 3766.2 samples/s | 58.8 steps/s
[Step=19350 Epoch=182.3] | Loss=0.00028 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.401 | L2-Norm(final)=13.396 | 6401.0 samples/s | 100.0 steps/s
[Step=19400 Epoch=182.8] | Loss=0.00027 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.395 | L2-Norm(final)=13.396 | 1350.4 samples/s | 21.1 steps/s
[Step=19450 Epoch=183.3] | Loss=0.00025 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.389 | L2-Norm(final)=13.397 | 5701.4 samples/s | 89.1 steps/s
[Step=19500 Epoch=183.7] | Loss=0.00024 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.383 | L2-Norm(final)=13.397 | 1385.6 samples/s | 21.7 steps/s
[Step=19550 Epoch=184.2] | Loss=0.00023 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.376 | L2-Norm(final)=13.397 | 5146.9 samples/s | 80.4 steps/s
[Step=19600 Epoch=184.7] | Loss=0.00022 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=13.398 | 1415.1 samples/s | 22.1 steps/s
[Step=19650 Epoch=185.2] | Loss=0.00021 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.363 | L2-Norm(final)=13.398 | 4648.5 samples/s | 72.6 steps/s
[Step=19700 Epoch=185.6] | Loss=0.00020 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=13.398 | 1461.8 samples/s | 22.8 steps/s
[Step=19750 Epoch=186.1] | Loss=0.00019 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.350 | L2-Norm(final)=13.399 | 4407.3 samples/s | 68.9 steps/s
[Step=19800 Epoch=186.6] | Loss=0.00019 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.344 | L2-Norm(final)=13.399 | 1513.3 samples/s | 23.6 steps/s
[Step=19850 Epoch=187.0] | Loss=0.00018 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.337 | L2-Norm(final)=13.399 | 4369.0 samples/s | 68.3 steps/s
[Step=19900 Epoch=187.5] | Loss=0.00017 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.330 | L2-Norm(final)=13.400 | 1503.6 samples/s | 23.5 steps/s
[Step=19950 Epoch=188.0] | Loss=0.00017 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.323 | L2-Norm(final)=13.400 | 4381.9 samples/s | 68.5 steps/s
[Step=20000 Epoch=188.5] | Loss=0.00016 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.316 | L2-Norm(final)=13.400 | 1550.5 samples/s | 24.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_3/client_state-step20000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=247.8] | Loss=0.00093 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.289 | L2-Norm(final)=18.059 | 3085.5 samples/s | 48.2 steps/s
[Step=26050 Epoch=248.3] | Loss=0.00085 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=18.068 | 4499.7 samples/s | 70.3 steps/s
[Step=26100 Epoch=248.8] | Loss=0.00110 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=18.080 | 8195.6 samples/s | 128.1 steps/s
[Step=26150 Epoch=249.2] | Loss=0.00104 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=18.093 | 1415.4 samples/s | 22.1 steps/s
[Step=26200 Epoch=249.7] | Loss=0.00109 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=18.107 | 7329.6 samples/s | 114.5 steps/s
[Step=26250 Epoch=250.2] | Loss=0.00106 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=18.119 | 1439.8 samples/s | 22.5 steps/s
[Step=26300 Epoch=250.7] | Loss=0.00103 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=18.131 | 6738.4 samples/s | 105.3 steps/s
[Step=26350 Epoch=251.1] | Loss=0.00107 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=18.142 | 1468.5 samples/s | 22.9 steps/s
[Step=26400 Epoch=251.6] | Loss=0.00105 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=18.154 | 6160.1 samples/s | 96.3 steps/s
[Step=26450 Epoch=252.1] | Loss=0.00104 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=18.165 | 1480.3 samples/s | 23.1 steps/s
[Step=26500 Epoch=252.6] | Loss=0.00101 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=18.176 | 5643.4 samples/s | 88.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=252.6] | Loss=0.00104 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=18.288 | 3221.0 samples/s | 50.3 steps/s
[Step=26550 Epoch=253.0] | Loss=0.00070 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.305 | L2-Norm(final)=18.295 | 3770.6 samples/s | 58.9 steps/s
[Step=26600 Epoch=253.5] | Loss=0.00058 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.320 | L2-Norm(final)=18.298 | 6458.8 samples/s | 100.9 steps/s
[Step=26650 Epoch=254.0] | Loss=0.00043 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=18.301 | 1333.9 samples/s | 20.8 steps/s
[Step=26700 Epoch=254.5] | Loss=0.00033 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=18.302 | 5924.7 samples/s | 92.6 steps/s
[Step=26750 Epoch=255.0] | Loss=0.00026 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.324 | L2-Norm(final)=18.303 | 1360.1 samples/s | 21.3 steps/s
[Step=26800 Epoch=255.4] | Loss=0.00022 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.319 | L2-Norm(final)=18.304 | 5495.7 samples/s | 85.9 steps/s
[Step=26850 Epoch=255.9] | Loss=0.00019 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.314 | L2-Norm(final)=18.305 | 1415.5 samples/s | 22.1 steps/s
[Step=26900 Epoch=256.4] | Loss=0.00017 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.307 | L2-Norm(final)=18.306 | 5114.0 samples/s | 79.9 steps/s
[Step=26950 Epoch=256.9] | Loss=0.00015 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.301 | L2-Norm(final)=18.306 | 1408.7 samples/s | 22.0 steps/s
[Step=27000 Epoch=257.3] | Loss=0.00013 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=18.307 | 4785.7 samples/s | 74.8 steps/s
[Step=27050 Epoch=257.8] | Loss=0.00012 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=18.307 | 1452.8 samples/s | 22.7 steps/s
[Step=27100 Epoch=258.3] | Loss=0.00011 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.281 | L2-Norm(final)=18.308 | 4399.3 samples/s | 68.7 steps/s
[Step=27150 Epoch=258.8] | Loss=0.00010 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.274 | L2-Norm(final)=18.308 | 1486.1 samples/s | 23.2 steps/s
[Step=27200 Epoch=259.2] | Loss=0.00010 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.267 | L2-Norm(final)=18.308 | 4421.7 samples/s | 69.1 steps/s
[Step=27250 Epoch=259.7] | Loss=0.00009 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=18.309 | 1523.3 samples/s | 23.8 steps/s
[Step=27300 Epoch=260.2] | Loss=0.00009 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.253 | L2-Norm(final)=18.309 | 4414.4 samples/s | 69.0 steps/s
[Step=27350 Epoch=260.7] | Loss=0.00008 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=18.309 | 1477.1 samples/s | 23.1 steps/s
[Step=27400 Epoch=261.1] | Loss=0.00008 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.238 | L2-Norm(final)=18.310 | 4357.7 samples/s | 68.1 steps/s
[Step=27450 Epoch=261.6] | Loss=0.00007 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=18.310 | 1490.9 samples/s | 23.3 steps/s
[Step=27500 Epoch=262.1] | Loss=0.00007 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=18.310 | 4544.1 samples/s | 71.0 steps/s
[Step=27550 Epoch=262.6] | Loss=0.00007 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.217 | L2-Norm(final)=18.311 | 6964.0 samples/s | 108.8 steps/s
[Step=27600 Epoch=263.1] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.209 | L2-Norm(final)=18.311 | 1334.8 samples/s | 20.9 steps/s
[Step=27650 Epoch=263.5] | Loss=0.00006 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.202 | L2-Norm(final)=18.311 | 6382.2 samples/s | 99.7 steps/s
[Step=27700 Epoch=264.0] | Loss=0.00006 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.195 | L2-Norm(final)=18.312 | 1335.8 samples/s | 20.9 steps/s
[Step=27750 Epoch=264.5] | Loss=0.00006 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.187 | L2-Norm(final)=18.312 | 5988.8 samples/s | 93.6 steps/s
[Step=27800 Epoch=265.0] | Loss=0.00005 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.180 | L2-Norm(final)=18.312 | 1374.7 samples/s | 21.5 steps/s
[Step=27850 Epoch=265.4] | Loss=0.00005 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.172 | L2-Norm(final)=18.313 | 5503.1 samples/s | 86.0 steps/s
[Step=27900 Epoch=265.9] | Loss=0.00005 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.165 | L2-Norm(final)=18.313 | 1397.8 samples/s | 21.8 steps/s
[Step=27950 Epoch=266.4] | Loss=0.00005 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=18.313 | 5157.7 samples/s | 80.6 steps/s
[Step=28000 Epoch=266.9] | Loss=0.00005 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.149 | L2-Norm(final)=18.313 | 1407.6 samples/s | 22.0 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09531 | acc=0.9612 | tpr=0.9728 | fpr=0.0642 | 4692.5 samples/s | 18.3 steps/s
Avg test loss: 0.09836, Avg test acc: 0.95973, Avg tpr: 0.97156, Avg fpr: 0.06627, total FA: 517

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09131 | acc=0.9590 | tpr=0.9716 | fpr=0.0684 | 4704.6 samples/s | 18.4 steps/s
Avg test loss: 0.09315, Avg test acc: 0.95757, Avg tpr: 0.97068, Avg fpr: 0.07127, total FA: 556

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08934 | acc=0.9602 | tpr=0.9744 | fpr=0.0706 | 4631.6 samples/s | 18.1 steps/s
Avg test loss: 0.09302, Avg test acc: 0.95965, Avg tpr: 0.97412, Avg fpr: 0.07217, total FA: 563

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09874 | acc=0.9620 | tpr=0.9788 | fpr=0.0746 | 4690.8 samples/s | 18.3 steps/s
Avg test loss: 0.10255, Avg test acc: 0.96037, Avg tpr: 0.97791, Avg fpr: 0.07820, total FA: 610

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08866 | acc=0.9620 | tpr=0.9738 | fpr=0.0634 | 4763.2 samples/s | 18.6 steps/s
Avg test loss: 0.09481, Avg test acc: 0.96073, Avg tpr: 0.97301, Avg fpr: 0.06627, total FA: 517

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.39096 | acc=0.3084 | tpr=0.0091 | fpr=0.0419 | 4661.4 samples/s | 18.2 steps/s
Avg test loss: 5.40666, Avg test acc: 0.30579, Avg tpr: 0.00903, Avg fpr: 0.04153, total FA: 324

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.64086 | acc=0.2929 | tpr=0.0163 | fpr=0.1065 | 4825.4 samples/s | 18.8 steps/s
Avg test loss: 4.66168, Avg test acc: 0.29061, Avg tpr: 0.01615, Avg fpr: 0.10576, total FA: 825

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.96320 | acc=0.2886 | tpr=0.0140 | fpr=0.1152 | 4675.9 samples/s | 18.3 steps/s
Avg test loss: 4.98153, Avg test acc: 0.28632, Avg tpr: 0.01399, Avg fpr: 0.11473, total FA: 895

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.51452 | acc=0.3208 | tpr=0.0278 | fpr=0.0431 | 4407.4 samples/s | 17.2 steps/s
Avg test loss: 4.53416, Avg test acc: 0.31878, Avg tpr: 0.02804, Avg fpr: 0.04179, total FA: 326

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.91409 | acc=0.3064 | tpr=0.0084 | fpr=0.0466 | 4490.7 samples/s | 17.5 steps/s
Avg test loss: 4.93751, Avg test acc: 0.30467, Avg tpr: 0.00863, Avg fpr: 0.04423, total FA: 345

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.22534 | acc=0.1420 | tpr=0.7389 | fpr=0.8687 | 4525.9 samples/s | 17.7 steps/s
[Step= 100] | Loss=6.19051 | acc=0.1446 | tpr=0.7079 | fpr=0.8659 | 7776.2 samples/s | 30.4 steps/s
[Step= 150] | Loss=6.19525 | acc=0.1454 | tpr=0.7118 | fpr=0.8650 | 7598.9 samples/s | 29.7 steps/s
[Step= 200] | Loss=6.18239 | acc=0.1456 | tpr=0.7158 | fpr=0.8648 | 7966.6 samples/s | 31.1 steps/s
[Step= 250] | Loss=6.17697 | acc=0.1465 | tpr=0.7074 | fpr=0.8637 | 8058.7 samples/s | 31.5 steps/s
[Step= 300] | Loss=6.16754 | acc=0.1474 | tpr=0.7076 | fpr=0.8628 | 7523.2 samples/s | 29.4 steps/s
[Step= 350] | Loss=6.17631 | acc=0.1471 | tpr=0.7107 | fpr=0.8631 | 8307.5 samples/s | 32.5 steps/s
[Step= 400] | Loss=6.17771 | acc=0.1471 | tpr=0.7090 | fpr=0.8632 | 7907.0 samples/s | 30.9 steps/s
[Step= 450] | Loss=6.17392 | acc=0.1470 | tpr=0.7079 | fpr=0.8632 | 7788.3 samples/s | 30.4 steps/s
[Step= 500] | Loss=6.17420 | acc=0.1472 | tpr=0.7031 | fpr=0.8628 | 8168.7 samples/s | 31.9 steps/s
[Step= 550] | Loss=6.17245 | acc=0.1476 | tpr=0.7087 | fpr=0.8625 | 11134.8 samples/s | 43.5 steps/s
Avg test loss: 6.17329, Avg test acc: 0.14756, Avg tpr: 0.70800, Avg fpr: 0.86263, total FA: 119774

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.52818 | acc=0.1401 | tpr=0.7743 | fpr=0.8713 | 4769.9 samples/s | 18.6 steps/s
[Step= 100] | Loss=5.51307 | acc=0.1418 | tpr=0.7463 | fpr=0.8694 | 7365.1 samples/s | 28.8 steps/s
[Step= 150] | Loss=5.51594 | acc=0.1430 | tpr=0.7435 | fpr=0.8680 | 7765.2 samples/s | 30.3 steps/s
[Step= 200] | Loss=5.50918 | acc=0.1431 | tpr=0.7377 | fpr=0.8677 | 8081.2 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.50656 | acc=0.1441 | tpr=0.7380 | fpr=0.8667 | 8663.7 samples/s | 33.8 steps/s
[Step= 300] | Loss=5.50296 | acc=0.1445 | tpr=0.7367 | fpr=0.8663 | 7857.2 samples/s | 30.7 steps/s
[Step= 350] | Loss=5.51049 | acc=0.1441 | tpr=0.7383 | fpr=0.8667 | 7839.2 samples/s | 30.6 steps/s
[Step= 400] | Loss=5.51389 | acc=0.1437 | tpr=0.7352 | fpr=0.8671 | 7928.0 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.51191 | acc=0.1435 | tpr=0.7313 | fpr=0.8672 | 7502.8 samples/s | 29.3 steps/s
[Step= 500] | Loss=5.51330 | acc=0.1435 | tpr=0.7273 | fpr=0.8670 | 8118.2 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.51146 | acc=0.1437 | tpr=0.7322 | fpr=0.8670 | 10899.9 samples/s | 42.6 steps/s
Avg test loss: 5.51281, Avg test acc: 0.14361, Avg tpr: 0.73177, Avg fpr: 0.86708, total FA: 120393

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.96579 | acc=0.1300 | tpr=0.8053 | fpr=0.8821 | 4882.7 samples/s | 19.1 steps/s
[Step= 100] | Loss=5.93555 | acc=0.1326 | tpr=0.7761 | fpr=0.8794 | 7479.2 samples/s | 29.2 steps/s
[Step= 150] | Loss=5.93954 | acc=0.1334 | tpr=0.7867 | fpr=0.8786 | 7888.4 samples/s | 30.8 steps/s
[Step= 200] | Loss=5.92557 | acc=0.1335 | tpr=0.7869 | fpr=0.8784 | 7181.8 samples/s | 28.1 steps/s
[Step= 250] | Loss=5.92027 | acc=0.1339 | tpr=0.7808 | fpr=0.8779 | 8560.8 samples/s | 33.4 steps/s
[Step= 300] | Loss=5.91530 | acc=0.1340 | tpr=0.7825 | fpr=0.8778 | 8322.2 samples/s | 32.5 steps/s
[Step= 350] | Loss=5.92491 | acc=0.1336 | tpr=0.7815 | fpr=0.8782 | 7477.2 samples/s | 29.2 steps/s
[Step= 400] | Loss=5.92771 | acc=0.1334 | tpr=0.7839 | fpr=0.8784 | 8441.2 samples/s | 33.0 steps/s
[Step= 450] | Loss=5.92470 | acc=0.1336 | tpr=0.7819 | fpr=0.8782 | 7961.8 samples/s | 31.1 steps/s
[Step= 500] | Loss=5.92485 | acc=0.1337 | tpr=0.7793 | fpr=0.8780 | 7460.5 samples/s | 29.1 steps/s
[Step= 550] | Loss=5.92428 | acc=0.1339 | tpr=0.7799 | fpr=0.8779 | 11976.6 samples/s | 46.8 steps/s
Avg test loss: 5.92474, Avg test acc: 0.13375, Avg tpr: 0.77932, Avg fpr: 0.87799, total FA: 121907

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=7.45509 | acc=0.1260 | tpr=0.7876 | fpr=0.8859 | 4739.4 samples/s | 18.5 steps/s
[Step= 100] | Loss=7.41939 | acc=0.1280 | tpr=0.7868 | fpr=0.8843 | 7032.3 samples/s | 27.5 steps/s
[Step= 150] | Loss=7.41972 | acc=0.1293 | tpr=0.7867 | fpr=0.8828 | 8037.8 samples/s | 31.4 steps/s
[Step= 200] | Loss=7.40957 | acc=0.1292 | tpr=0.7803 | fpr=0.8827 | 7616.4 samples/s | 29.8 steps/s
[Step= 250] | Loss=7.40446 | acc=0.1295 | tpr=0.7790 | fpr=0.8824 | 8477.1 samples/s | 33.1 steps/s
[Step= 300] | Loss=7.39936 | acc=0.1295 | tpr=0.7796 | fpr=0.8823 | 8122.4 samples/s | 31.7 steps/s
[Step= 350] | Loss=7.41262 | acc=0.1289 | tpr=0.7858 | fpr=0.8831 | 8048.1 samples/s | 31.4 steps/s
[Step= 400] | Loss=7.41332 | acc=0.1290 | tpr=0.7850 | fpr=0.8830 | 7901.5 samples/s | 30.9 steps/s
[Step= 450] | Loss=7.41165 | acc=0.1289 | tpr=0.7824 | fpr=0.8829 | 8144.8 samples/s | 31.8 steps/s
[Step= 500] | Loss=7.41259 | acc=0.1288 | tpr=0.7806 | fpr=0.8829 | 7384.4 samples/s | 28.8 steps/s
[Step= 550] | Loss=7.41190 | acc=0.1291 | tpr=0.7835 | fpr=0.8828 | 11857.7 samples/s | 46.3 steps/s
Avg test loss: 7.41328, Avg test acc: 0.12896, Avg tpr: 0.78249, Avg fpr: 0.88292, total FA: 122592

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.01746 | acc=0.1335 | tpr=0.8009 | fpr=0.8785 | 4612.0 samples/s | 18.0 steps/s
[Step= 100] | Loss=5.98543 | acc=0.1350 | tpr=0.7655 | fpr=0.8768 | 7862.9 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.99662 | acc=0.1355 | tpr=0.7608 | fpr=0.8760 | 7931.7 samples/s | 31.0 steps/s
[Step= 200] | Loss=5.99325 | acc=0.1353 | tpr=0.7541 | fpr=0.8759 | 8018.3 samples/s | 31.3 steps/s
[Step= 250] | Loss=5.99228 | acc=0.1362 | tpr=0.7502 | fpr=0.8750 | 8017.4 samples/s | 31.3 steps/s
[Step= 300] | Loss=5.98568 | acc=0.1371 | tpr=0.7556 | fpr=0.8742 | 7473.5 samples/s | 29.2 steps/s
[Step= 350] | Loss=5.99478 | acc=0.1367 | tpr=0.7589 | fpr=0.8746 | 8512.6 samples/s | 33.3 steps/s
[Step= 400] | Loss=5.99525 | acc=0.1364 | tpr=0.7544 | fpr=0.8748 | 8045.5 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.99376 | acc=0.1365 | tpr=0.7522 | fpr=0.8746 | 7939.1 samples/s | 31.0 steps/s
[Step= 500] | Loss=5.99798 | acc=0.1368 | tpr=0.7493 | fpr=0.8743 | 8312.8 samples/s | 32.5 steps/s
[Step= 550] | Loss=5.99804 | acc=0.1370 | tpr=0.7505 | fpr=0.8742 | 10039.9 samples/s | 39.2 steps/s
Avg test loss: 5.99906, Avg test acc: 0.13687, Avg tpr: 0.74960, Avg fpr: 0.87427, total FA: 121390

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19262 | acc=0.9615 | tpr=0.9292 | fpr=0.0379 | 4514.7 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.19465 | acc=0.9607 | tpr=0.9318 | fpr=0.0387 | 8000.5 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.19852 | acc=0.9594 | tpr=0.9366 | fpr=0.0402 | 8501.8 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.19957 | acc=0.9597 | tpr=0.9410 | fpr=0.0400 | 7994.0 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.20075 | acc=0.9593 | tpr=0.9389 | fpr=0.0404 | 8026.1 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.20234 | acc=0.9586 | tpr=0.9367 | fpr=0.0410 | 7987.6 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.20235 | acc=0.9585 | tpr=0.9374 | fpr=0.0411 | 7786.1 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.20348 | acc=0.9583 | tpr=0.9344 | fpr=0.0413 | 8366.7 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.20473 | acc=0.9580 | tpr=0.9314 | fpr=0.0415 | 7373.5 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.20443 | acc=0.9580 | tpr=0.9322 | fpr=0.0416 | 8623.3 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.20425 | acc=0.9580 | tpr=0.9292 | fpr=0.0415 | 9786.4 samples/s | 38.2 steps/s
Avg test loss: 0.20405, Avg test acc: 0.95799, Avg tpr: 0.92868, Avg fpr: 0.04148, total FA: 5759

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14610 | acc=0.9638 | tpr=0.9381 | fpr=0.0357 | 4635.5 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.14977 | acc=0.9630 | tpr=0.9296 | fpr=0.0364 | 7989.6 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.15161 | acc=0.9621 | tpr=0.9280 | fpr=0.0373 | 7538.2 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.15176 | acc=0.9624 | tpr=0.9333 | fpr=0.0370 | 8072.2 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.15309 | acc=0.9621 | tpr=0.9328 | fpr=0.0374 | 8319.6 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.15360 | acc=0.9618 | tpr=0.9345 | fpr=0.0377 | 7431.0 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.15346 | acc=0.9618 | tpr=0.9361 | fpr=0.0377 | 8237.7 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.15478 | acc=0.9615 | tpr=0.9316 | fpr=0.0380 | 7823.6 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.15495 | acc=0.9613 | tpr=0.9304 | fpr=0.0381 | 8152.4 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.15476 | acc=0.9614 | tpr=0.9322 | fpr=0.0381 | 8254.4 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.15476 | acc=0.9615 | tpr=0.9300 | fpr=0.0380 | 10292.1 samples/s | 40.2 steps/s
Avg test loss: 0.15440, Avg test acc: 0.96149, Avg tpr: 0.93027, Avg fpr: 0.03794, total FA: 5268

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.25126 | acc=0.9552 | tpr=0.9469 | fpr=0.0447 | 4862.6 samples/s | 19.0 steps/s
[Step= 100] | Loss=0.25686 | acc=0.9542 | tpr=0.9467 | fpr=0.0456 | 7644.3 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.26429 | acc=0.9530 | tpr=0.9452 | fpr=0.0468 | 7429.8 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.26570 | acc=0.9532 | tpr=0.9530 | fpr=0.0468 | 7703.9 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.26736 | acc=0.9531 | tpr=0.9572 | fpr=0.0470 | 7794.7 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.26918 | acc=0.9526 | tpr=0.9585 | fpr=0.0475 | 8418.5 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.26914 | acc=0.9526 | tpr=0.9593 | fpr=0.0476 | 8152.9 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.27101 | acc=0.9522 | tpr=0.9568 | fpr=0.0479 | 8283.4 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.27227 | acc=0.9519 | tpr=0.9542 | fpr=0.0482 | 7848.9 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.27219 | acc=0.9518 | tpr=0.9551 | fpr=0.0483 | 7948.1 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.27149 | acc=0.9519 | tpr=0.9526 | fpr=0.0482 | 10265.0 samples/s | 40.1 steps/s
Avg test loss: 0.27110, Avg test acc: 0.95191, Avg tpr: 0.95285, Avg fpr: 0.04810, total FA: 6679

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.13159 | acc=0.9666 | tpr=0.9513 | fpr=0.0332 | 4526.7 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.13322 | acc=0.9659 | tpr=0.9467 | fpr=0.0337 | 7966.4 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.13723 | acc=0.9646 | tpr=0.9409 | fpr=0.0349 | 8530.5 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.13866 | acc=0.9646 | tpr=0.9454 | fpr=0.0351 | 7958.0 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.14058 | acc=0.9641 | tpr=0.9459 | fpr=0.0355 | 8136.2 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.14156 | acc=0.9638 | tpr=0.9433 | fpr=0.0358 | 8256.1 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.14255 | acc=0.9636 | tpr=0.9443 | fpr=0.0360 | 7818.3 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.14386 | acc=0.9632 | tpr=0.9431 | fpr=0.0364 | 7999.7 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.14425 | acc=0.9629 | tpr=0.9416 | fpr=0.0367 | 7332.8 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.14352 | acc=0.9630 | tpr=0.9427 | fpr=0.0366 | 8170.1 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.14311 | acc=0.9631 | tpr=0.9419 | fpr=0.0365 | 10257.4 samples/s | 40.1 steps/s
Avg test loss: 0.14282, Avg test acc: 0.96311, Avg tpr: 0.94216, Avg fpr: 0.03651, total FA: 5069

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.20561 | acc=0.9585 | tpr=0.9159 | fpr=0.0407 | 4721.1 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.21285 | acc=0.9573 | tpr=0.9211 | fpr=0.0420 | 7881.8 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.21715 | acc=0.9566 | tpr=0.9280 | fpr=0.0428 | 7376.0 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.21966 | acc=0.9564 | tpr=0.9322 | fpr=0.0431 | 8074.8 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.22067 | acc=0.9561 | tpr=0.9328 | fpr=0.0434 | 8011.8 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.22242 | acc=0.9555 | tpr=0.9324 | fpr=0.0440 | 7073.4 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.22259 | acc=0.9554 | tpr=0.9330 | fpr=0.0441 | 8635.9 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.22438 | acc=0.9551 | tpr=0.9300 | fpr=0.0445 | 7521.5 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.22512 | acc=0.9548 | tpr=0.9279 | fpr=0.0447 | 8248.8 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.22544 | acc=0.9546 | tpr=0.9286 | fpr=0.0449 | 8261.0 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.22485 | acc=0.9547 | tpr=0.9268 | fpr=0.0448 | 11404.7 samples/s | 44.5 steps/s
Avg test loss: 0.22456, Avg test acc: 0.95472, Avg tpr: 0.92631, Avg fpr: 0.04476, total FA: 6215

server round 27/50

clients selected: [4 6 7 8 9]

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=18001 Epoch=88.3] | Loss=0.04390 | Reg=0.00125 | acc=0.9688 | L2-Norm=11.162 | L2-Norm(final)=11.600 | 3276.2 samples/s | 51.2 steps/s
[Step=18050 Epoch=88.5] | Loss=0.02363 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.163 | L2-Norm(final)=11.595 | 4890.6 samples/s | 76.4 steps/s
[Step=18100 Epoch=88.8] | Loss=0.02175 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.163 | L2-Norm(final)=11.586 | 5490.9 samples/s | 85.8 steps/s
[Step=18150 Epoch=89.0] | Loss=0.02192 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.163 | L2-Norm(final)=11.585 | 5462.4 samples/s | 85.3 steps/s
[Step=18200 Epoch=89.2] | Loss=0.02195 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.163 | L2-Norm(final)=11.583 | 8678.3 samples/s | 135.6 steps/s
[Step=18250 Epoch=89.5] | Loss=0.02228 | Reg=0.00125 | acc=0.9219 | L2-Norm=11.163 | L2-Norm(final)=11.582 | 1474.0 samples/s | 23.0 steps/s
[Step=18300 Epoch=89.7] | Loss=0.02178 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.163 | L2-Norm(final)=11.580 | 5524.5 samples/s | 86.3 steps/s
[Step=18350 Epoch=90.0] | Loss=0.02231 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.163 | L2-Norm(final)=11.579 | 5440.0 samples/s | 85.0 steps/s
[Step=18400 Epoch=90.2] | Loss=0.02231 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.163 | L2-Norm(final)=11.577 | 8047.9 samples/s | 125.7 steps/s
[Step=18450 Epoch=90.5] | Loss=0.02213 | Reg=0.00125 | acc=0.9531 | L2-Norm=11.163 | L2-Norm(final)=11.576 | 1480.1 samples/s | 23.1 steps/s
[Step=18500 Epoch=90.7] | Loss=0.02184 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.163 | L2-Norm(final)=11.575 | 5482.2 samples/s | 85.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=90.7] | Loss=0.01347 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.163 | L2-Norm(final)=11.577 | 3196.5 samples/s | 49.9 steps/s
[Step=18550 Epoch=91.0] | Loss=0.02991 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.200 | L2-Norm(final)=11.568 | 4227.7 samples/s | 66.1 steps/s
[Step=18600 Epoch=91.2] | Loss=0.02822 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.234 | L2-Norm(final)=11.564 | 4683.4 samples/s | 73.2 steps/s
[Step=18650 Epoch=91.5] | Loss=0.02654 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=11.564 | 4720.8 samples/s | 73.8 steps/s
[Step=18700 Epoch=91.7] | Loss=0.02566 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=11.567 | 6811.6 samples/s | 106.4 steps/s
[Step=18750 Epoch=91.9] | Loss=0.02212 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.302 | L2-Norm(final)=11.570 | 1379.7 samples/s | 21.6 steps/s
[Step=18800 Epoch=92.2] | Loss=0.02029 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.318 | L2-Norm(final)=11.575 | 4800.7 samples/s | 75.0 steps/s
[Step=18850 Epoch=92.4] | Loss=0.01844 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.332 | L2-Norm(final)=11.580 | 4627.3 samples/s | 72.3 steps/s
[Step=18900 Epoch=92.7] | Loss=0.01727 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.345 | L2-Norm(final)=11.586 | 6440.0 samples/s | 100.6 steps/s
[Step=18950 Epoch=92.9] | Loss=0.01603 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.356 | L2-Norm(final)=11.590 | 1436.3 samples/s | 22.4 steps/s
[Step=19000 Epoch=93.2] | Loss=0.01495 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.366 | L2-Norm(final)=11.595 | 4706.0 samples/s | 73.5 steps/s
[Step=19050 Epoch=93.4] | Loss=0.01421 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.375 | L2-Norm(final)=11.600 | 4652.9 samples/s | 72.7 steps/s
[Step=19100 Epoch=93.7] | Loss=0.01357 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.383 | L2-Norm(final)=11.605 | 6096.1 samples/s | 95.3 steps/s
[Step=19150 Epoch=93.9] | Loss=0.01303 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.391 | L2-Norm(final)=11.609 | 1425.7 samples/s | 22.3 steps/s
[Step=19200 Epoch=94.2] | Loss=0.01242 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.398 | L2-Norm(final)=11.613 | 4680.6 samples/s | 73.1 steps/s
[Step=19250 Epoch=94.4] | Loss=0.01204 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=11.617 | 4683.5 samples/s | 73.2 steps/s
[Step=19300 Epoch=94.6] | Loss=0.01149 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.411 | L2-Norm(final)=11.621 | 5697.9 samples/s | 89.0 steps/s
[Step=19350 Epoch=94.9] | Loss=0.01113 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.417 | L2-Norm(final)=11.624 | 1457.3 samples/s | 22.8 steps/s
[Step=19400 Epoch=95.1] | Loss=0.01081 | Reg=0.00130 | acc=0.9531 | L2-Norm=11.423 | L2-Norm(final)=11.628 | 4696.2 samples/s | 73.4 steps/s
[Step=19450 Epoch=95.4] | Loss=0.01044 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.428 | L2-Norm(final)=11.632 | 4696.8 samples/s | 73.4 steps/s
[Step=19500 Epoch=95.6] | Loss=0.01007 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=11.636 | 5458.8 samples/s | 85.3 steps/s
[Step=19550 Epoch=95.9] | Loss=0.00970 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.438 | L2-Norm(final)=11.639 | 1502.8 samples/s | 23.5 steps/s
[Step=19600 Epoch=96.1] | Loss=0.00944 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.443 | L2-Norm(final)=11.643 | 4571.3 samples/s | 71.4 steps/s
[Step=19650 Epoch=96.4] | Loss=0.00928 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.448 | L2-Norm(final)=11.647 | 4695.9 samples/s | 73.4 steps/s
[Step=19700 Epoch=96.6] | Loss=0.00907 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=11.650 | 5165.3 samples/s | 80.7 steps/s
[Step=19750 Epoch=96.9] | Loss=0.00885 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.456 | L2-Norm(final)=11.653 | 1492.0 samples/s | 23.3 steps/s
[Step=19800 Epoch=97.1] | Loss=0.00864 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.460 | L2-Norm(final)=11.656 | 4697.6 samples/s | 73.4 steps/s
[Step=19850 Epoch=97.3] | Loss=0.00852 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.464 | L2-Norm(final)=11.659 | 4633.0 samples/s | 72.4 steps/s
[Step=19900 Epoch=97.6] | Loss=0.00829 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.468 | L2-Norm(final)=11.663 | 4905.7 samples/s | 76.7 steps/s
[Step=19950 Epoch=97.8] | Loss=0.00810 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.472 | L2-Norm(final)=11.666 | 1551.2 samples/s | 24.2 steps/s
[Step=20000 Epoch=98.1] | Loss=0.00797 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.475 | L2-Norm(final)=11.669 | 4725.6 samples/s | 73.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_4/client_state-step20000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=247.3] | Loss=0.00003 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.162 | L2-Norm(final)=13.425 | 3092.3 samples/s | 48.3 steps/s
[Step=26050 Epoch=247.8] | Loss=0.00090 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.158 | L2-Norm(final)=13.433 | 4640.0 samples/s | 72.5 steps/s
[Step=26100 Epoch=248.3] | Loss=0.00088 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.158 | L2-Norm(final)=13.441 | 8184.0 samples/s | 127.9 steps/s
[Step=26150 Epoch=248.8] | Loss=0.00088 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.158 | L2-Norm(final)=13.451 | 1460.1 samples/s | 22.8 steps/s
[Step=26200 Epoch=249.2] | Loss=0.00089 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.158 | L2-Norm(final)=13.462 | 7210.2 samples/s | 112.7 steps/s
[Step=26250 Epoch=249.7] | Loss=0.00093 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.158 | L2-Norm(final)=13.471 | 1481.2 samples/s | 23.1 steps/s
[Step=26300 Epoch=250.2] | Loss=0.00085 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.158 | L2-Norm(final)=13.480 | 6529.1 samples/s | 102.0 steps/s
[Step=26350 Epoch=250.7] | Loss=0.00092 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=13.489 | 1508.8 samples/s | 23.6 steps/s
[Step=26400 Epoch=251.1] | Loss=0.00086 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=13.498 | 5916.6 samples/s | 92.4 steps/s
[Step=26450 Epoch=251.6] | Loss=0.00088 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=13.507 | 1545.9 samples/s | 24.2 steps/s
[Step=26500 Epoch=252.1] | Loss=0.00087 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=13.515 | 5280.7 samples/s | 82.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=252.1] | Loss=0.00003 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=13.600 | 3284.8 samples/s | 51.3 steps/s
[Step=26550 Epoch=252.6] | Loss=0.00014 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=13.608 | 3813.3 samples/s | 59.6 steps/s
[Step=26600 Epoch=253.0] | Loss=0.00164 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.196 | L2-Norm(final)=13.610 | 6510.6 samples/s | 101.7 steps/s
[Step=26650 Epoch=253.5] | Loss=0.00142 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.243 | L2-Norm(final)=13.605 | 1398.7 samples/s | 21.9 steps/s
[Step=26700 Epoch=254.0] | Loss=0.00107 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.269 | L2-Norm(final)=13.604 | 5955.4 samples/s | 93.1 steps/s
[Step=26750 Epoch=254.5] | Loss=0.00086 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.281 | L2-Norm(final)=13.603 | 1432.5 samples/s | 22.4 steps/s
[Step=26800 Epoch=254.9] | Loss=0.00071 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=13.603 | 5338.6 samples/s | 83.4 steps/s
[Step=26850 Epoch=255.4] | Loss=0.00061 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=13.603 | 1457.7 samples/s | 22.8 steps/s
[Step=26900 Epoch=255.9] | Loss=0.00054 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=13.603 | 4867.7 samples/s | 76.1 steps/s
[Step=26950 Epoch=256.4] | Loss=0.00048 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.284 | L2-Norm(final)=13.603 | 1467.9 samples/s | 22.9 steps/s
[Step=27000 Epoch=256.8] | Loss=0.00043 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.281 | L2-Norm(final)=13.603 | 4601.5 samples/s | 71.9 steps/s
[Step=27050 Epoch=257.3] | Loss=0.00039 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.277 | L2-Norm(final)=13.603 | 1499.8 samples/s | 23.4 steps/s
[Step=27100 Epoch=257.8] | Loss=0.00036 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.272 | L2-Norm(final)=13.603 | 4517.3 samples/s | 70.6 steps/s
[Step=27150 Epoch=258.3] | Loss=0.00033 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.267 | L2-Norm(final)=13.604 | 1495.1 samples/s | 23.4 steps/s
[Step=27200 Epoch=258.7] | Loss=0.00031 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.261 | L2-Norm(final)=13.604 | 4432.6 samples/s | 69.3 steps/s
[Step=27250 Epoch=259.2] | Loss=0.00029 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.255 | L2-Norm(final)=13.604 | 1515.3 samples/s | 23.7 steps/s
[Step=27300 Epoch=259.7] | Loss=0.00027 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.249 | L2-Norm(final)=13.604 | 4468.6 samples/s | 69.8 steps/s
[Step=27350 Epoch=260.2] | Loss=0.00025 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.243 | L2-Norm(final)=13.605 | 1625.0 samples/s | 25.4 steps/s
[Step=27400 Epoch=260.6] | Loss=0.00024 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.237 | L2-Norm(final)=13.605 | 3922.8 samples/s | 61.3 steps/s
[Step=27450 Epoch=261.1] | Loss=0.00023 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.230 | L2-Norm(final)=13.605 | 6640.9 samples/s | 103.8 steps/s
[Step=27500 Epoch=261.6] | Loss=0.00022 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=13.605 | 1369.2 samples/s | 21.4 steps/s
[Step=27550 Epoch=262.1] | Loss=0.00021 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.217 | L2-Norm(final)=13.606 | 6133.9 samples/s | 95.8 steps/s
[Step=27600 Epoch=262.5] | Loss=0.00020 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.211 | L2-Norm(final)=13.606 | 1403.7 samples/s | 21.9 steps/s
[Step=27650 Epoch=263.0] | Loss=0.00019 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.204 | L2-Norm(final)=13.606 | 5586.8 samples/s | 87.3 steps/s
[Step=27700 Epoch=263.5] | Loss=0.00018 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.197 | L2-Norm(final)=13.606 | 1422.6 samples/s | 22.2 steps/s
[Step=27750 Epoch=264.0] | Loss=0.00017 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=13.607 | 5082.8 samples/s | 79.4 steps/s
[Step=27800 Epoch=264.4] | Loss=0.00017 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.183 | L2-Norm(final)=13.607 | 1457.4 samples/s | 22.8 steps/s
[Step=27850 Epoch=264.9] | Loss=0.00016 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=13.607 | 4747.7 samples/s | 74.2 steps/s
[Step=27900 Epoch=265.4] | Loss=0.00016 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.169 | L2-Norm(final)=13.607 | 1511.7 samples/s | 23.6 steps/s
[Step=27950 Epoch=265.9] | Loss=0.00015 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.161 | L2-Norm(final)=13.608 | 4553.9 samples/s | 71.2 steps/s
[Step=28000 Epoch=266.3] | Loss=0.00015 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.154 | L2-Norm(final)=13.608 | 1515.1 samples/s | 23.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step28000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=34001 Epoch=324.7] | Loss=0.00011 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.162 | L2-Norm(final)=16.565 | 3161.7 samples/s | 49.4 steps/s
[Step=34050 Epoch=325.2] | Loss=0.00048 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.158 | L2-Norm(final)=16.572 | 4503.6 samples/s | 70.4 steps/s
[Step=34100 Epoch=325.6] | Loss=0.00045 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=16.574 | 8267.7 samples/s | 129.2 steps/s
[Step=34150 Epoch=326.1] | Loss=0.00045 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.157 | L2-Norm(final)=16.576 | 1435.7 samples/s | 22.4 steps/s
[Step=34200 Epoch=326.6] | Loss=0.00042 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=16.581 | 7498.6 samples/s | 117.2 steps/s
[Step=34250 Epoch=327.1] | Loss=0.00040 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.157 | L2-Norm(final)=16.587 | 1486.8 samples/s | 23.2 steps/s
[Step=34300 Epoch=327.5] | Loss=0.00038 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=16.594 | 6540.3 samples/s | 102.2 steps/s
[Step=34350 Epoch=328.0] | Loss=0.00038 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=16.602 | 1492.8 samples/s | 23.3 steps/s
[Step=34400 Epoch=328.5] | Loss=0.00038 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=16.610 | 6212.1 samples/s | 97.1 steps/s
[Step=34450 Epoch=329.0] | Loss=0.00038 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=16.618 | 1533.1 samples/s | 24.0 steps/s
[Step=34500 Epoch=329.5] | Loss=0.00037 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=16.626 | 5534.3 samples/s | 86.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=34501 Epoch=329.5] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=16.709 | 3282.9 samples/s | 51.3 steps/s
[Step=34550 Epoch=329.9] | Loss=0.00244 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=16.705 | 3906.4 samples/s | 61.0 steps/s
[Step=34600 Epoch=330.4] | Loss=0.00221 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.252 | L2-Norm(final)=16.698 | 6381.0 samples/s | 99.7 steps/s
[Step=34650 Epoch=330.9] | Loss=0.00196 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.280 | L2-Norm(final)=16.693 | 1401.0 samples/s | 21.9 steps/s
[Step=34700 Epoch=331.4] | Loss=0.00148 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=16.690 | 6075.4 samples/s | 94.9 steps/s
[Step=34750 Epoch=331.8] | Loss=0.00118 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.297 | L2-Norm(final)=16.689 | 1430.2 samples/s | 22.3 steps/s
[Step=34800 Epoch=332.3] | Loss=0.00099 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.297 | L2-Norm(final)=16.688 | 5459.5 samples/s | 85.3 steps/s
[Step=34850 Epoch=332.8] | Loss=0.00085 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.295 | L2-Norm(final)=16.688 | 1423.2 samples/s | 22.2 steps/s
[Step=34900 Epoch=333.3] | Loss=0.00074 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.291 | L2-Norm(final)=16.688 | 5223.2 samples/s | 81.6 steps/s
[Step=34950 Epoch=333.8] | Loss=0.00066 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=16.688 | 1483.8 samples/s | 23.2 steps/s
[Step=35000 Epoch=334.2] | Loss=0.00059 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.281 | L2-Norm(final)=16.688 | 4901.2 samples/s | 76.6 steps/s
[Step=35050 Epoch=334.7] | Loss=0.00054 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.275 | L2-Norm(final)=16.688 | 1474.0 samples/s | 23.0 steps/s
[Step=35100 Epoch=335.2] | Loss=0.00050 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.269 | L2-Norm(final)=16.688 | 4554.2 samples/s | 71.2 steps/s
[Step=35150 Epoch=335.7] | Loss=0.00046 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.263 | L2-Norm(final)=16.688 | 1557.9 samples/s | 24.3 steps/s
[Step=35200 Epoch=336.1] | Loss=0.00043 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.257 | L2-Norm(final)=16.688 | 4566.0 samples/s | 71.3 steps/s
[Step=35250 Epoch=336.6] | Loss=0.00040 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.250 | L2-Norm(final)=16.688 | 1529.4 samples/s | 23.9 steps/s
[Step=35300 Epoch=337.1] | Loss=0.00037 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.243 | L2-Norm(final)=16.688 | 4497.7 samples/s | 70.3 steps/s
[Step=35350 Epoch=337.6] | Loss=0.00035 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.237 | L2-Norm(final)=16.689 | 1519.5 samples/s | 23.7 steps/s
[Step=35400 Epoch=338.0] | Loss=0.00033 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.230 | L2-Norm(final)=16.689 | 4473.2 samples/s | 69.9 steps/s
[Step=35450 Epoch=338.5] | Loss=0.00031 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.223 | L2-Norm(final)=16.689 | 1560.3 samples/s | 24.4 steps/s
[Step=35500 Epoch=339.0] | Loss=0.00030 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.216 | L2-Norm(final)=16.689 | 4427.8 samples/s | 69.2 steps/s
[Step=35550 Epoch=339.5] | Loss=0.00028 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.209 | L2-Norm(final)=16.689 | 7254.9 samples/s | 113.4 steps/s
[Step=35600 Epoch=340.0] | Loss=0.00027 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.202 | L2-Norm(final)=16.690 | 1357.7 samples/s | 21.2 steps/s
[Step=35650 Epoch=340.4] | Loss=0.00026 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.195 | L2-Norm(final)=16.690 | 6559.5 samples/s | 102.5 steps/s
[Step=35700 Epoch=340.9] | Loss=0.00025 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.187 | L2-Norm(final)=16.690 | 1368.0 samples/s | 21.4 steps/s
[Step=35750 Epoch=341.4] | Loss=0.00024 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.180 | L2-Norm(final)=16.690 | 6038.5 samples/s | 94.4 steps/s
[Step=35800 Epoch=341.9] | Loss=0.00023 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=16.691 | 1416.3 samples/s | 22.1 steps/s
[Step=35850 Epoch=342.3] | Loss=0.00022 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.166 | L2-Norm(final)=16.691 | 5615.1 samples/s | 87.7 steps/s
[Step=35900 Epoch=342.8] | Loss=0.00021 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.158 | L2-Norm(final)=16.691 | 1443.8 samples/s | 22.6 steps/s
[Step=35950 Epoch=343.3] | Loss=0.00021 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=16.692 | 5124.1 samples/s | 80.1 steps/s
[Step=36000 Epoch=343.8] | Loss=0.00020 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.143 | L2-Norm(final)=16.692 | 1458.5 samples/s | 22.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step36000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=188.5] | Loss=0.00015 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.162 | L2-Norm(final)=13.410 | 3080.1 samples/s | 48.1 steps/s
[Step=20050 Epoch=188.9] | Loss=0.00069 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=13.431 | 4701.0 samples/s | 73.5 steps/s
[Step=20100 Epoch=189.4] | Loss=0.00111 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=13.457 | 7762.1 samples/s | 121.3 steps/s
[Step=20150 Epoch=189.9] | Loss=0.00116 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=13.479 | 1442.7 samples/s | 22.5 steps/s
[Step=20200 Epoch=190.3] | Loss=0.00107 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=13.501 | 6747.9 samples/s | 105.4 steps/s
[Step=20250 Epoch=190.8] | Loss=0.00108 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=13.520 | 1504.2 samples/s | 23.5 steps/s
[Step=20300 Epoch=191.3] | Loss=0.00106 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=13.537 | 6199.6 samples/s | 96.9 steps/s
[Step=20350 Epoch=191.8] | Loss=0.00102 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=13.555 | 1510.9 samples/s | 23.6 steps/s
[Step=20400 Epoch=192.2] | Loss=0.00105 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=13.572 | 5551.5 samples/s | 86.7 steps/s
[Step=20450 Epoch=192.7] | Loss=0.00100 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=13.588 | 1584.9 samples/s | 24.8 steps/s
[Step=20500 Epoch=193.2] | Loss=0.00100 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=13.604 | 5120.6 samples/s | 80.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=193.2] | Loss=0.00167 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=13.759 | 3350.9 samples/s | 52.4 steps/s
[Step=20550 Epoch=193.6] | Loss=0.00033 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=13.773 | 3723.5 samples/s | 58.2 steps/s
[Step=20600 Epoch=194.1] | Loss=0.00047 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=13.778 | 6497.6 samples/s | 101.5 steps/s
[Step=20650 Epoch=194.6] | Loss=0.00046 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=13.782 | 1392.4 samples/s | 21.8 steps/s
[Step=20700 Epoch=195.1] | Loss=0.00038 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.204 | L2-Norm(final)=13.786 | 5755.9 samples/s | 89.9 steps/s
[Step=20750 Epoch=195.5] | Loss=0.00030 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.210 | L2-Norm(final)=13.789 | 1429.7 samples/s | 22.3 steps/s
[Step=20800 Epoch=196.0] | Loss=0.00026 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.211 | L2-Norm(final)=13.791 | 5185.0 samples/s | 81.0 steps/s
[Step=20850 Epoch=196.5] | Loss=0.00022 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.210 | L2-Norm(final)=13.793 | 1447.8 samples/s | 22.6 steps/s
[Step=20900 Epoch=196.9] | Loss=0.00020 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=13.795 | 4732.8 samples/s | 74.0 steps/s
[Step=20950 Epoch=197.4] | Loss=0.00017 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.201 | L2-Norm(final)=13.796 | 1509.3 samples/s | 23.6 steps/s
[Step=21000 Epoch=197.9] | Loss=0.00016 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.196 | L2-Norm(final)=13.797 | 4524.3 samples/s | 70.7 steps/s
[Step=21050 Epoch=198.4] | Loss=0.00014 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.189 | L2-Norm(final)=13.798 | 1492.4 samples/s | 23.3 steps/s
[Step=21100 Epoch=198.8] | Loss=0.00013 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.183 | L2-Norm(final)=13.799 | 4499.3 samples/s | 70.3 steps/s
[Step=21150 Epoch=199.3] | Loss=0.00012 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.175 | L2-Norm(final)=13.800 | 1514.6 samples/s | 23.7 steps/s
[Step=21200 Epoch=199.8] | Loss=0.00011 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.168 | L2-Norm(final)=13.800 | 4506.7 samples/s | 70.4 steps/s
[Step=21250 Epoch=200.2] | Loss=0.00011 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=13.801 | 1577.6 samples/s | 24.6 steps/s
[Step=21300 Epoch=200.7] | Loss=0.00010 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.153 | L2-Norm(final)=13.802 | 4049.5 samples/s | 63.3 steps/s
[Step=21350 Epoch=201.2] | Loss=0.00009 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.145 | L2-Norm(final)=13.802 | 6471.3 samples/s | 101.1 steps/s
[Step=21400 Epoch=201.6] | Loss=0.00009 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.137 | L2-Norm(final)=13.803 | 1370.7 samples/s | 21.4 steps/s
[Step=21450 Epoch=202.1] | Loss=0.00008 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.128 | L2-Norm(final)=13.803 | 5712.8 samples/s | 89.3 steps/s
[Step=21500 Epoch=202.6] | Loss=0.00008 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.120 | L2-Norm(final)=13.804 | 1424.9 samples/s | 22.3 steps/s
[Step=21550 Epoch=203.1] | Loss=0.00008 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.111 | L2-Norm(final)=13.804 | 5236.3 samples/s | 81.8 steps/s
[Step=21600 Epoch=203.5] | Loss=0.00007 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.103 | L2-Norm(final)=13.805 | 1482.1 samples/s | 23.2 steps/s
[Step=21650 Epoch=204.0] | Loss=0.00007 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=13.805 | 4719.0 samples/s | 73.7 steps/s
[Step=21700 Epoch=204.5] | Loss=0.00007 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.086 | L2-Norm(final)=13.805 | 1476.9 samples/s | 23.1 steps/s
[Step=21750 Epoch=204.9] | Loss=0.00006 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.077 | L2-Norm(final)=13.806 | 4367.9 samples/s | 68.2 steps/s
[Step=21800 Epoch=205.4] | Loss=0.00006 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.068 | L2-Norm(final)=13.806 | 1524.0 samples/s | 23.8 steps/s
[Step=21850 Epoch=205.9] | Loss=0.00006 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.059 | L2-Norm(final)=13.807 | 4386.3 samples/s | 68.5 steps/s
[Step=21900 Epoch=206.4] | Loss=0.00006 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.050 | L2-Norm(final)=13.807 | 1526.3 samples/s | 23.8 steps/s
[Step=21950 Epoch=206.8] | Loss=0.00006 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.041 | L2-Norm(final)=13.807 | 4491.9 samples/s | 70.2 steps/s
[Step=22000 Epoch=207.3] | Loss=0.00005 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.032 | L2-Norm(final)=13.808 | 1571.6 samples/s | 24.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_3/client_state-step22000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=266.9] | Loss=0.00161 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.162 | L2-Norm(final)=18.322 | 3159.6 samples/s | 49.4 steps/s
[Step=28050 Epoch=267.3] | Loss=0.00118 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=18.336 | 4500.4 samples/s | 70.3 steps/s
[Step=28100 Epoch=267.8] | Loss=0.00117 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=18.362 | 8089.3 samples/s | 126.4 steps/s
[Step=28150 Epoch=268.3] | Loss=0.00113 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.159 | L2-Norm(final)=18.382 | 1463.5 samples/s | 22.9 steps/s
[Step=28200 Epoch=268.8] | Loss=0.00119 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.159 | L2-Norm(final)=18.402 | 7267.5 samples/s | 113.6 steps/s
[Step=28250 Epoch=269.2] | Loss=0.00116 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.159 | L2-Norm(final)=18.421 | 1475.5 samples/s | 23.1 steps/s
[Step=28300 Epoch=269.7] | Loss=0.00111 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.159 | L2-Norm(final)=18.440 | 6814.1 samples/s | 106.5 steps/s
[Step=28350 Epoch=270.2] | Loss=0.00110 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.159 | L2-Norm(final)=18.457 | 1482.8 samples/s | 23.2 steps/s
[Step=28400 Epoch=270.7] | Loss=0.00110 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.159 | L2-Norm(final)=18.474 | 6188.3 samples/s | 96.7 steps/s
[Step=28450 Epoch=271.2] | Loss=0.00115 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.159 | L2-Norm(final)=18.490 | 1533.7 samples/s | 24.0 steps/s
[Step=28500 Epoch=271.6] | Loss=0.00114 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.159 | L2-Norm(final)=18.506 | 5515.2 samples/s | 86.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=271.6] | Loss=0.00024 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.159 | L2-Norm(final)=18.670 | 3124.2 samples/s | 48.8 steps/s
[Step=28550 Epoch=272.1] | Loss=0.00107 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.195 | L2-Norm(final)=18.678 | 4142.2 samples/s | 64.7 steps/s
[Step=28600 Epoch=272.6] | Loss=0.00122 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.250 | L2-Norm(final)=18.676 | 6367.8 samples/s | 99.5 steps/s
[Step=28650 Epoch=273.1] | Loss=0.00146 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=18.675 | 1380.3 samples/s | 21.6 steps/s
[Step=28700 Epoch=273.5] | Loss=0.00120 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.309 | L2-Norm(final)=18.674 | 6074.3 samples/s | 94.9 steps/s
[Step=28750 Epoch=274.0] | Loss=0.00100 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.325 | L2-Norm(final)=18.673 | 1433.8 samples/s | 22.4 steps/s
[Step=28800 Epoch=274.5] | Loss=0.00083 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.333 | L2-Norm(final)=18.674 | 5596.1 samples/s | 87.4 steps/s
[Step=28850 Epoch=275.0] | Loss=0.00071 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.337 | L2-Norm(final)=18.674 | 1447.4 samples/s | 22.6 steps/s
[Step=28900 Epoch=275.4] | Loss=0.00063 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.339 | L2-Norm(final)=18.674 | 5187.1 samples/s | 81.0 steps/s
[Step=28950 Epoch=275.9] | Loss=0.00056 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.339 | L2-Norm(final)=18.674 | 1474.3 samples/s | 23.0 steps/s
[Step=29000 Epoch=276.4] | Loss=0.00050 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.338 | L2-Norm(final)=18.674 | 4855.0 samples/s | 75.9 steps/s
[Step=29050 Epoch=276.9] | Loss=0.00046 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.336 | L2-Norm(final)=18.674 | 1484.5 samples/s | 23.2 steps/s
[Step=29100 Epoch=277.3] | Loss=0.00042 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.334 | L2-Norm(final)=18.674 | 4589.0 samples/s | 71.7 steps/s
[Step=29150 Epoch=277.8] | Loss=0.00039 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.331 | L2-Norm(final)=18.674 | 1527.8 samples/s | 23.9 steps/s
[Step=29200 Epoch=278.3] | Loss=0.00036 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=18.674 | 4345.8 samples/s | 67.9 steps/s
[Step=29250 Epoch=278.8] | Loss=0.00034 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.324 | L2-Norm(final)=18.675 | 1526.3 samples/s | 23.8 steps/s
[Step=29300 Epoch=279.3] | Loss=0.00031 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.320 | L2-Norm(final)=18.675 | 4418.6 samples/s | 69.0 steps/s
[Step=29350 Epoch=279.7] | Loss=0.00030 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.316 | L2-Norm(final)=18.675 | 1525.7 samples/s | 23.8 steps/s
[Step=29400 Epoch=280.2] | Loss=0.00028 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.311 | L2-Norm(final)=18.675 | 4359.0 samples/s | 68.1 steps/s
[Step=29450 Epoch=280.7] | Loss=0.00026 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.307 | L2-Norm(final)=18.675 | 1523.0 samples/s | 23.8 steps/s
[Step=29500 Epoch=281.2] | Loss=0.00025 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.302 | L2-Norm(final)=18.675 | 4425.3 samples/s | 69.1 steps/s
[Step=29550 Epoch=281.6] | Loss=0.00024 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.298 | L2-Norm(final)=18.676 | 7250.3 samples/s | 113.3 steps/s
[Step=29600 Epoch=282.1] | Loss=0.00023 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=18.676 | 1346.0 samples/s | 21.0 steps/s
[Step=29650 Epoch=282.6] | Loss=0.00022 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=18.676 | 6615.2 samples/s | 103.4 steps/s
[Step=29700 Epoch=283.1] | Loss=0.00021 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=18.676 | 1383.2 samples/s | 21.6 steps/s
[Step=29750 Epoch=283.5] | Loss=0.00020 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.278 | L2-Norm(final)=18.676 | 6036.2 samples/s | 94.3 steps/s
[Step=29800 Epoch=284.0] | Loss=0.00019 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.272 | L2-Norm(final)=18.677 | 1389.4 samples/s | 21.7 steps/s
[Step=29850 Epoch=284.5] | Loss=0.00019 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.267 | L2-Norm(final)=18.677 | 5591.8 samples/s | 87.4 steps/s
[Step=29900 Epoch=285.0] | Loss=0.00018 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.262 | L2-Norm(final)=18.677 | 1433.8 samples/s | 22.4 steps/s
[Step=29950 Epoch=285.5] | Loss=0.00017 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.256 | L2-Norm(final)=18.677 | 5202.7 samples/s | 81.3 steps/s
[Step=30000 Epoch=285.9] | Loss=0.00017 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.251 | L2-Norm(final)=18.677 | 1444.2 samples/s | 22.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4/client_state-step30000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09531 | acc=0.9612 | tpr=0.9728 | fpr=0.0642 | 4728.9 samples/s | 18.5 steps/s
Avg test loss: 0.09836, Avg test acc: 0.95973, Avg tpr: 0.97156, Avg fpr: 0.06627, total FA: 517

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09131 | acc=0.9590 | tpr=0.9716 | fpr=0.0684 | 4713.6 samples/s | 18.4 steps/s
Avg test loss: 0.09315, Avg test acc: 0.95757, Avg tpr: 0.97068, Avg fpr: 0.07127, total FA: 556

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08934 | acc=0.9602 | tpr=0.9744 | fpr=0.0706 | 4740.5 samples/s | 18.5 steps/s
Avg test loss: 0.09302, Avg test acc: 0.95965, Avg tpr: 0.97412, Avg fpr: 0.07217, total FA: 563

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09874 | acc=0.9620 | tpr=0.9788 | fpr=0.0746 | 4761.7 samples/s | 18.6 steps/s
Avg test loss: 0.10255, Avg test acc: 0.96037, Avg tpr: 0.97791, Avg fpr: 0.07820, total FA: 610

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08972 | acc=0.9609 | tpr=0.9698 | fpr=0.0585 | 4559.5 samples/s | 17.8 steps/s
Avg test loss: 0.09568, Avg test acc: 0.95925, Avg tpr: 0.96876, Avg fpr: 0.06166, total FA: 481

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.39096 | acc=0.3084 | tpr=0.0091 | fpr=0.0419 | 4703.7 samples/s | 18.4 steps/s
Avg test loss: 5.40666, Avg test acc: 0.30579, Avg tpr: 0.00903, Avg fpr: 0.04153, total FA: 324

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.89276 | acc=0.2976 | tpr=0.0283 | fpr=0.1177 | 4729.1 samples/s | 18.5 steps/s
Avg test loss: 4.91833, Avg test acc: 0.29618, Avg tpr: 0.02763, Avg fpr: 0.11319, total FA: 883

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.45022 | acc=0.3044 | tpr=0.0176 | fpr=0.0728 | 4703.5 samples/s | 18.4 steps/s
Avg test loss: 4.47356, Avg test acc: 0.30195, Avg tpr: 0.01848, Avg fpr: 0.07461, total FA: 582

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.14865 | acc=0.3195 | tpr=0.0353 | fpr=0.0634 | 4759.8 samples/s | 18.6 steps/s
Avg test loss: 4.16404, Avg test acc: 0.31749, Avg tpr: 0.03503, Avg fpr: 0.06127, total FA: 478

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.81238 | acc=0.3084 | tpr=0.0137 | fpr=0.0515 | 4639.6 samples/s | 18.1 steps/s
Avg test loss: 5.83533, Avg test acc: 0.30639, Avg tpr: 0.01364, Avg fpr: 0.04974, total FA: 388

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.22534 | acc=0.1420 | tpr=0.7389 | fpr=0.8687 | 4764.6 samples/s | 18.6 steps/s
[Step= 100] | Loss=6.19051 | acc=0.1446 | tpr=0.7079 | fpr=0.8659 | 7534.5 samples/s | 29.4 steps/s
[Step= 150] | Loss=6.19525 | acc=0.1454 | tpr=0.7118 | fpr=0.8650 | 7997.2 samples/s | 31.2 steps/s
[Step= 200] | Loss=6.18239 | acc=0.1456 | tpr=0.7158 | fpr=0.8648 | 7776.4 samples/s | 30.4 steps/s
[Step= 250] | Loss=6.17697 | acc=0.1465 | tpr=0.7074 | fpr=0.8637 | 8678.2 samples/s | 33.9 steps/s
[Step= 300] | Loss=6.16754 | acc=0.1474 | tpr=0.7076 | fpr=0.8628 | 7879.8 samples/s | 30.8 steps/s
[Step= 350] | Loss=6.17631 | acc=0.1471 | tpr=0.7107 | fpr=0.8631 | 7781.7 samples/s | 30.4 steps/s
[Step= 400] | Loss=6.17771 | acc=0.1471 | tpr=0.7090 | fpr=0.8632 | 7967.3 samples/s | 31.1 steps/s
[Step= 450] | Loss=6.17392 | acc=0.1470 | tpr=0.7079 | fpr=0.8632 | 8508.9 samples/s | 33.2 steps/s
[Step= 500] | Loss=6.17420 | acc=0.1472 | tpr=0.7031 | fpr=0.8628 | 7989.4 samples/s | 31.2 steps/s
[Step= 550] | Loss=6.17245 | acc=0.1476 | tpr=0.7087 | fpr=0.8625 | 9347.9 samples/s | 36.5 steps/s
Avg test loss: 6.17329, Avg test acc: 0.14756, Avg tpr: 0.70800, Avg fpr: 0.86263, total FA: 119774

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.52818 | acc=0.1401 | tpr=0.7743 | fpr=0.8713 | 4646.7 samples/s | 18.2 steps/s
[Step= 100] | Loss=5.51307 | acc=0.1418 | tpr=0.7463 | fpr=0.8694 | 7963.7 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.51594 | acc=0.1430 | tpr=0.7435 | fpr=0.8680 | 7911.6 samples/s | 30.9 steps/s
[Step= 200] | Loss=5.50918 | acc=0.1431 | tpr=0.7377 | fpr=0.8677 | 7798.4 samples/s | 30.5 steps/s
[Step= 250] | Loss=5.50656 | acc=0.1441 | tpr=0.7380 | fpr=0.8667 | 7937.5 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.50296 | acc=0.1445 | tpr=0.7367 | fpr=0.8663 | 7365.4 samples/s | 28.8 steps/s
[Step= 350] | Loss=5.51049 | acc=0.1441 | tpr=0.7383 | fpr=0.8667 | 8223.1 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.51389 | acc=0.1437 | tpr=0.7352 | fpr=0.8671 | 8189.9 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.51191 | acc=0.1435 | tpr=0.7313 | fpr=0.8672 | 8140.4 samples/s | 31.8 steps/s
[Step= 500] | Loss=5.51330 | acc=0.1435 | tpr=0.7273 | fpr=0.8670 | 7753.2 samples/s | 30.3 steps/s
[Step= 550] | Loss=5.51146 | acc=0.1437 | tpr=0.7322 | fpr=0.8670 | 11258.4 samples/s | 44.0 steps/s
Avg test loss: 5.51281, Avg test acc: 0.14361, Avg tpr: 0.73177, Avg fpr: 0.86708, total FA: 120393

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.96579 | acc=0.1300 | tpr=0.8053 | fpr=0.8821 | 4635.5 samples/s | 18.1 steps/s
[Step= 100] | Loss=5.93555 | acc=0.1326 | tpr=0.7761 | fpr=0.8794 | 8310.6 samples/s | 32.5 steps/s
[Step= 150] | Loss=5.93954 | acc=0.1334 | tpr=0.7867 | fpr=0.8786 | 8006.0 samples/s | 31.3 steps/s
[Step= 200] | Loss=5.92557 | acc=0.1335 | tpr=0.7869 | fpr=0.8784 | 7224.5 samples/s | 28.2 steps/s
[Step= 250] | Loss=5.92027 | acc=0.1339 | tpr=0.7808 | fpr=0.8779 | 8265.3 samples/s | 32.3 steps/s
[Step= 300] | Loss=5.91530 | acc=0.1340 | tpr=0.7825 | fpr=0.8778 | 8289.7 samples/s | 32.4 steps/s
[Step= 350] | Loss=5.92491 | acc=0.1336 | tpr=0.7815 | fpr=0.8782 | 7765.3 samples/s | 30.3 steps/s
[Step= 400] | Loss=5.92771 | acc=0.1334 | tpr=0.7839 | fpr=0.8784 | 8389.7 samples/s | 32.8 steps/s
[Step= 450] | Loss=5.92470 | acc=0.1336 | tpr=0.7819 | fpr=0.8782 | 8248.1 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.92485 | acc=0.1337 | tpr=0.7793 | fpr=0.8780 | 7949.5 samples/s | 31.1 steps/s
[Step= 550] | Loss=5.92428 | acc=0.1339 | tpr=0.7799 | fpr=0.8779 | 9609.4 samples/s | 37.5 steps/s
Avg test loss: 5.92474, Avg test acc: 0.13375, Avg tpr: 0.77932, Avg fpr: 0.87799, total FA: 121907

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=7.45509 | acc=0.1260 | tpr=0.7876 | fpr=0.8859 | 4795.5 samples/s | 18.7 steps/s
[Step= 100] | Loss=7.41939 | acc=0.1280 | tpr=0.7868 | fpr=0.8843 | 7173.4 samples/s | 28.0 steps/s
[Step= 150] | Loss=7.41972 | acc=0.1293 | tpr=0.7867 | fpr=0.8828 | 7543.2 samples/s | 29.5 steps/s
[Step= 200] | Loss=7.40957 | acc=0.1292 | tpr=0.7803 | fpr=0.8827 | 7873.8 samples/s | 30.8 steps/s
[Step= 250] | Loss=7.40446 | acc=0.1295 | tpr=0.7790 | fpr=0.8824 | 8368.0 samples/s | 32.7 steps/s
[Step= 300] | Loss=7.39936 | acc=0.1295 | tpr=0.7796 | fpr=0.8823 | 7761.3 samples/s | 30.3 steps/s
[Step= 350] | Loss=7.41262 | acc=0.1289 | tpr=0.7858 | fpr=0.8831 | 8273.5 samples/s | 32.3 steps/s
[Step= 400] | Loss=7.41332 | acc=0.1290 | tpr=0.7850 | fpr=0.8830 | 8171.3 samples/s | 31.9 steps/s
[Step= 450] | Loss=7.41165 | acc=0.1289 | tpr=0.7824 | fpr=0.8829 | 8233.9 samples/s | 32.2 steps/s
[Step= 500] | Loss=7.41259 | acc=0.1288 | tpr=0.7806 | fpr=0.8829 | 8135.0 samples/s | 31.8 steps/s
[Step= 550] | Loss=7.41190 | acc=0.1291 | tpr=0.7835 | fpr=0.8828 | 10208.6 samples/s | 39.9 steps/s
Avg test loss: 7.41328, Avg test acc: 0.12896, Avg tpr: 0.78249, Avg fpr: 0.88292, total FA: 122592

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.74583 | acc=0.1462 | tpr=0.6858 | fpr=0.8634 | 4502.2 samples/s | 17.6 steps/s
[Step= 100] | Loss=5.71887 | acc=0.1475 | tpr=0.6333 | fpr=0.8616 | 8267.7 samples/s | 32.3 steps/s
[Step= 150] | Loss=5.72950 | acc=0.1490 | tpr=0.6383 | fpr=0.8600 | 8608.5 samples/s | 33.6 steps/s
[Step= 200] | Loss=5.72276 | acc=0.1486 | tpr=0.6284 | fpr=0.8601 | 7686.3 samples/s | 30.0 steps/s
[Step= 250] | Loss=5.72015 | acc=0.1492 | tpr=0.6253 | fpr=0.8595 | 7678.7 samples/s | 30.0 steps/s
[Step= 300] | Loss=5.71357 | acc=0.1499 | tpr=0.6298 | fpr=0.8589 | 8328.2 samples/s | 32.5 steps/s
[Step= 350] | Loss=5.72394 | acc=0.1495 | tpr=0.6331 | fpr=0.8593 | 8139.0 samples/s | 31.8 steps/s
[Step= 400] | Loss=5.72416 | acc=0.1493 | tpr=0.6286 | fpr=0.8594 | 8003.0 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.72198 | acc=0.1495 | tpr=0.6280 | fpr=0.8592 | 7368.1 samples/s | 28.8 steps/s
[Step= 500] | Loss=5.72635 | acc=0.1494 | tpr=0.6238 | fpr=0.8592 | 8106.4 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.72524 | acc=0.1500 | tpr=0.6275 | fpr=0.8587 | 10406.2 samples/s | 40.6 steps/s
Avg test loss: 5.72689, Avg test acc: 0.14984, Avg tpr: 0.62718, Avg fpr: 0.85884, total FA: 119248

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19262 | acc=0.9615 | tpr=0.9292 | fpr=0.0379 | 4490.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.19465 | acc=0.9607 | tpr=0.9318 | fpr=0.0387 | 7978.0 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.19852 | acc=0.9594 | tpr=0.9366 | fpr=0.0402 | 8205.5 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.19957 | acc=0.9597 | tpr=0.9410 | fpr=0.0400 | 8226.8 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.20075 | acc=0.9593 | tpr=0.9389 | fpr=0.0404 | 7751.0 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.20234 | acc=0.9586 | tpr=0.9367 | fpr=0.0410 | 7912.1 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.20235 | acc=0.9585 | tpr=0.9374 | fpr=0.0411 | 7789.5 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.20348 | acc=0.9583 | tpr=0.9344 | fpr=0.0413 | 7958.9 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.20473 | acc=0.9580 | tpr=0.9314 | fpr=0.0415 | 7470.4 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.20443 | acc=0.9580 | tpr=0.9322 | fpr=0.0416 | 8385.8 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.20425 | acc=0.9580 | tpr=0.9292 | fpr=0.0415 | 11280.7 samples/s | 44.1 steps/s
Avg test loss: 0.20405, Avg test acc: 0.95799, Avg tpr: 0.92868, Avg fpr: 0.04148, total FA: 5759

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16601 | acc=0.9634 | tpr=0.9336 | fpr=0.0360 | 4627.6 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.17026 | acc=0.9629 | tpr=0.9296 | fpr=0.0365 | 8203.9 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.17166 | acc=0.9624 | tpr=0.9280 | fpr=0.0369 | 8052.1 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.17167 | acc=0.9624 | tpr=0.9311 | fpr=0.0370 | 7878.0 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.17437 | acc=0.9621 | tpr=0.9310 | fpr=0.0373 | 8166.9 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.17568 | acc=0.9617 | tpr=0.9316 | fpr=0.0378 | 7437.3 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.17608 | acc=0.9616 | tpr=0.9299 | fpr=0.0378 | 8136.4 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.17741 | acc=0.9612 | tpr=0.9272 | fpr=0.0382 | 7970.6 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.17826 | acc=0.9610 | tpr=0.9255 | fpr=0.0384 | 8354.7 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.17774 | acc=0.9609 | tpr=0.9269 | fpr=0.0385 | 8106.9 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.17738 | acc=0.9609 | tpr=0.9252 | fpr=0.0384 | 9508.5 samples/s | 37.1 steps/s
Avg test loss: 0.17708, Avg test acc: 0.96093, Avg tpr: 0.92552, Avg fpr: 0.03842, total FA: 5335

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.31623 | acc=0.9502 | tpr=0.9204 | fpr=0.0492 | 4514.2 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.32546 | acc=0.9489 | tpr=0.9254 | fpr=0.0507 | 8042.1 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.33509 | acc=0.9478 | tpr=0.9337 | fpr=0.0520 | 8011.6 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.33779 | acc=0.9477 | tpr=0.9388 | fpr=0.0522 | 7953.0 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.33866 | acc=0.9475 | tpr=0.9389 | fpr=0.0524 | 7861.9 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.34103 | acc=0.9469 | tpr=0.9360 | fpr=0.0529 | 7805.6 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.34192 | acc=0.9468 | tpr=0.9361 | fpr=0.0530 | 8039.0 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.34528 | acc=0.9465 | tpr=0.9327 | fpr=0.0532 | 8116.8 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.34630 | acc=0.9462 | tpr=0.9333 | fpr=0.0536 | 8072.3 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.34604 | acc=0.9461 | tpr=0.9348 | fpr=0.0537 | 7912.8 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.34456 | acc=0.9463 | tpr=0.9339 | fpr=0.0535 | 9672.4 samples/s | 37.8 steps/s
Avg test loss: 0.34411, Avg test acc: 0.94628, Avg tpr: 0.93344, Avg fpr: 0.05349, total FA: 7427

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.13846 | acc=0.9660 | tpr=0.9425 | fpr=0.0336 | 4515.2 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.14276 | acc=0.9656 | tpr=0.9360 | fpr=0.0339 | 8149.3 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.14687 | acc=0.9644 | tpr=0.9352 | fpr=0.0350 | 8614.8 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.14789 | acc=0.9646 | tpr=0.9377 | fpr=0.0349 | 7316.3 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.14939 | acc=0.9645 | tpr=0.9380 | fpr=0.0350 | 7550.1 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.15122 | acc=0.9640 | tpr=0.9360 | fpr=0.0354 | 7918.0 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.15212 | acc=0.9639 | tpr=0.9368 | fpr=0.0356 | 8316.9 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.15293 | acc=0.9636 | tpr=0.9354 | fpr=0.0359 | 8725.2 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.15322 | acc=0.9633 | tpr=0.9328 | fpr=0.0361 | 7635.9 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.15259 | acc=0.9635 | tpr=0.9348 | fpr=0.0360 | 8053.9 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.15198 | acc=0.9636 | tpr=0.9324 | fpr=0.0358 | 9621.8 samples/s | 37.6 steps/s
Avg test loss: 0.15169, Avg test acc: 0.96363, Avg tpr: 0.93225, Avg fpr: 0.03579, total FA: 4970

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.18736 | acc=0.9605 | tpr=0.8894 | fpr=0.0383 | 4621.1 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.19268 | acc=0.9601 | tpr=0.9062 | fpr=0.0389 | 7741.1 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.19630 | acc=0.9596 | tpr=0.9121 | fpr=0.0395 | 7824.9 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.19675 | acc=0.9596 | tpr=0.9191 | fpr=0.0396 | 7701.4 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.19777 | acc=0.9594 | tpr=0.9179 | fpr=0.0398 | 7338.2 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.19893 | acc=0.9592 | tpr=0.9149 | fpr=0.0400 | 8105.1 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.19950 | acc=0.9592 | tpr=0.9142 | fpr=0.0400 | 8346.1 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.20084 | acc=0.9590 | tpr=0.9125 | fpr=0.0402 | 7886.5 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.20194 | acc=0.9586 | tpr=0.9119 | fpr=0.0405 | 8234.6 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.20177 | acc=0.9586 | tpr=0.9119 | fpr=0.0406 | 8121.2 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.20098 | acc=0.9587 | tpr=0.9125 | fpr=0.0405 | 10380.8 samples/s | 40.5 steps/s
Avg test loss: 0.20065, Avg test acc: 0.95870, Avg tpr: 0.91244, Avg fpr: 0.04045, total FA: 5617

server round 28/50

clients selected: [0 2 4 5 6]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=40001 Epoch=195.1] | Loss=0.02707 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.154 | L2-Norm(final)=13.757 | 3080.9 samples/s | 48.1 steps/s
[Step=40050 Epoch=195.3] | Loss=0.02556 | Reg=0.00124 | acc=0.9688 | L2-Norm=11.154 | L2-Norm(final)=13.759 | 5109.6 samples/s | 79.8 steps/s
[Step=40100 Epoch=195.5] | Loss=0.02528 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=13.759 | 5382.4 samples/s | 84.1 steps/s
[Step=40150 Epoch=195.8] | Loss=0.02461 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.155 | L2-Norm(final)=13.759 | 5265.2 samples/s | 82.3 steps/s
[Step=40200 Epoch=196.0] | Loss=0.02404 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=13.759 | 8452.9 samples/s | 132.1 steps/s
[Step=40250 Epoch=196.3] | Loss=0.02495 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=13.759 | 1442.7 samples/s | 22.5 steps/s
[Step=40300 Epoch=196.5] | Loss=0.02461 | Reg=0.00124 | acc=0.9531 | L2-Norm=11.155 | L2-Norm(final)=13.758 | 5398.8 samples/s | 84.4 steps/s
[Step=40350 Epoch=196.8] | Loss=0.02407 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.155 | L2-Norm(final)=13.760 | 5352.6 samples/s | 83.6 steps/s
[Step=40400 Epoch=197.0] | Loss=0.02408 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.155 | L2-Norm(final)=13.761 | 7489.3 samples/s | 117.0 steps/s
[Step=40450 Epoch=197.2] | Loss=0.02390 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.155 | L2-Norm(final)=13.762 | 1475.6 samples/s | 23.1 steps/s
[Step=40500 Epoch=197.5] | Loss=0.02386 | Reg=0.00124 | acc=0.9688 | L2-Norm=11.155 | L2-Norm(final)=13.763 | 5413.9 samples/s | 84.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=40501 Epoch=197.5] | Loss=0.01979 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.155 | L2-Norm(final)=13.776 | 3178.1 samples/s | 49.7 steps/s
[Step=40550 Epoch=197.7] | Loss=0.02206 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.189 | L2-Norm(final)=13.775 | 4089.3 samples/s | 63.9 steps/s
[Step=40600 Epoch=198.0] | Loss=0.02405 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.221 | L2-Norm(final)=13.770 | 4607.4 samples/s | 72.0 steps/s
[Step=40650 Epoch=198.2] | Loss=0.02530 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.248 | L2-Norm(final)=13.764 | 4642.3 samples/s | 72.5 steps/s
[Step=40700 Epoch=198.5] | Loss=0.02456 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.270 | L2-Norm(final)=13.762 | 6610.3 samples/s | 103.3 steps/s
[Step=40750 Epoch=198.7] | Loss=0.02190 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=13.762 | 1377.4 samples/s | 21.5 steps/s
[Step=40800 Epoch=198.9] | Loss=0.01973 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=13.764 | 4597.7 samples/s | 71.8 steps/s
[Step=40850 Epoch=199.2] | Loss=0.01800 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.316 | L2-Norm(final)=13.766 | 4675.5 samples/s | 73.1 steps/s
[Step=40900 Epoch=199.4] | Loss=0.01688 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.328 | L2-Norm(final)=13.768 | 5990.3 samples/s | 93.6 steps/s
[Step=40950 Epoch=199.7] | Loss=0.01555 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.338 | L2-Norm(final)=13.771 | 1424.6 samples/s | 22.3 steps/s
[Step=41000 Epoch=199.9] | Loss=0.01458 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.347 | L2-Norm(final)=13.774 | 4675.9 samples/s | 73.1 steps/s
[Step=41050 Epoch=200.2] | Loss=0.01391 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.354 | L2-Norm(final)=13.777 | 4563.1 samples/s | 71.3 steps/s
[Step=41100 Epoch=200.4] | Loss=0.01326 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.361 | L2-Norm(final)=13.779 | 5578.5 samples/s | 87.2 steps/s
[Step=41150 Epoch=200.7] | Loss=0.01265 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=13.782 | 1446.0 samples/s | 22.6 steps/s
[Step=41200 Epoch=200.9] | Loss=0.01207 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.373 | L2-Norm(final)=13.785 | 4700.3 samples/s | 73.4 steps/s
[Step=41250 Epoch=201.1] | Loss=0.01159 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.379 | L2-Norm(final)=13.787 | 4565.6 samples/s | 71.3 steps/s
[Step=41300 Epoch=201.4] | Loss=0.01111 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.384 | L2-Norm(final)=13.790 | 5122.9 samples/s | 80.0 steps/s
[Step=41350 Epoch=201.6] | Loss=0.01066 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.389 | L2-Norm(final)=13.793 | 1494.5 samples/s | 23.4 steps/s
[Step=41400 Epoch=201.9] | Loss=0.01026 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.393 | L2-Norm(final)=13.795 | 4666.1 samples/s | 72.9 steps/s
[Step=41450 Epoch=202.1] | Loss=0.00994 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.398 | L2-Norm(final)=13.798 | 4647.4 samples/s | 72.6 steps/s
[Step=41500 Epoch=202.4] | Loss=0.00969 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.401 | L2-Norm(final)=13.800 | 4729.5 samples/s | 73.9 steps/s
[Step=41550 Epoch=202.6] | Loss=0.00941 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=13.803 | 1507.7 samples/s | 23.6 steps/s
[Step=41600 Epoch=202.8] | Loss=0.00914 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.409 | L2-Norm(final)=13.805 | 4639.9 samples/s | 72.5 steps/s
[Step=41650 Epoch=203.1] | Loss=0.00891 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.412 | L2-Norm(final)=13.807 | 4644.3 samples/s | 72.6 steps/s
[Step=41700 Epoch=203.3] | Loss=0.00877 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.415 | L2-Norm(final)=13.810 | 4639.8 samples/s | 72.5 steps/s
[Step=41750 Epoch=203.6] | Loss=0.00854 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.419 | L2-Norm(final)=13.812 | 1511.1 samples/s | 23.6 steps/s
[Step=41800 Epoch=203.8] | Loss=0.00829 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.422 | L2-Norm(final)=13.814 | 4609.3 samples/s | 72.0 steps/s
[Step=41850 Epoch=204.1] | Loss=0.00818 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=13.816 | 4644.9 samples/s | 72.6 steps/s
[Step=41900 Epoch=204.3] | Loss=0.00801 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=13.818 | 4618.0 samples/s | 72.2 steps/s
[Step=41950 Epoch=204.6] | Loss=0.00788 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=13.820 | 1500.6 samples/s | 23.4 steps/s
[Step=42000 Epoch=204.8] | Loss=0.00774 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=13.823 | 4627.2 samples/s | 72.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step42000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=12001 Epoch=58.5] | Loss=0.04211 | Reg=0.00124 | acc=0.9375 | L2-Norm=11.154 | L2-Norm(final)=10.200 | 3227.2 samples/s | 50.4 steps/s
[Step=12050 Epoch=58.7] | Loss=0.02508 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.154 | L2-Norm(final)=10.214 | 4818.5 samples/s | 75.3 steps/s
[Step=12100 Epoch=59.0] | Loss=0.02494 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=10.228 | 5371.7 samples/s | 83.9 steps/s
[Step=12150 Epoch=59.2] | Loss=0.02440 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=10.238 | 5353.7 samples/s | 83.7 steps/s
[Step=12200 Epoch=59.4] | Loss=0.02438 | Reg=0.00124 | acc=0.9688 | L2-Norm=11.155 | L2-Norm(final)=10.249 | 8377.2 samples/s | 130.9 steps/s
[Step=12250 Epoch=59.7] | Loss=0.02354 | Reg=0.00124 | acc=0.9688 | L2-Norm=11.155 | L2-Norm(final)=10.260 | 1432.2 samples/s | 22.4 steps/s
[Step=12300 Epoch=59.9] | Loss=0.02342 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.155 | L2-Norm(final)=10.272 | 5379.5 samples/s | 84.1 steps/s
[Step=12350 Epoch=60.2] | Loss=0.02332 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=10.283 | 5416.0 samples/s | 84.6 steps/s
[Step=12400 Epoch=60.4] | Loss=0.02420 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.155 | L2-Norm(final)=10.293 | 7429.1 samples/s | 116.1 steps/s
[Step=12450 Epoch=60.7] | Loss=0.02389 | Reg=0.00124 | acc=0.9375 | L2-Norm=11.155 | L2-Norm(final)=10.302 | 1499.7 samples/s | 23.4 steps/s
[Step=12500 Epoch=60.9] | Loss=0.02390 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=10.310 | 5408.6 samples/s | 84.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=12501 Epoch=60.9] | Loss=0.02390 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.155 | L2-Norm(final)=10.391 | 3137.7 samples/s | 49.0 steps/s
[Step=12550 Epoch=61.1] | Loss=0.02406 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=10.392 | 4220.2 samples/s | 65.9 steps/s
[Step=12600 Epoch=61.4] | Loss=0.02456 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.225 | L2-Norm(final)=10.394 | 4653.5 samples/s | 72.7 steps/s
[Step=12650 Epoch=61.6] | Loss=0.02446 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.254 | L2-Norm(final)=10.394 | 4592.2 samples/s | 71.8 steps/s
[Step=12700 Epoch=61.9] | Loss=0.02333 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.280 | L2-Norm(final)=10.397 | 6711.1 samples/s | 104.9 steps/s
[Step=12750 Epoch=62.1] | Loss=0.02016 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.302 | L2-Norm(final)=10.401 | 1364.9 samples/s | 21.3 steps/s
[Step=12800 Epoch=62.4] | Loss=0.01798 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.320 | L2-Norm(final)=10.407 | 4615.5 samples/s | 72.1 steps/s
[Step=12850 Epoch=62.6] | Loss=0.01681 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.336 | L2-Norm(final)=10.413 | 4656.8 samples/s | 72.8 steps/s
[Step=12900 Epoch=62.9] | Loss=0.01639 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.350 | L2-Norm(final)=10.418 | 5942.1 samples/s | 92.8 steps/s
[Step=12950 Epoch=63.1] | Loss=0.01534 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.363 | L2-Norm(final)=10.422 | 1403.8 samples/s | 21.9 steps/s
[Step=13000 Epoch=63.3] | Loss=0.01438 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=10.426 | 4725.5 samples/s | 73.8 steps/s
[Step=13050 Epoch=63.6] | Loss=0.01380 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.384 | L2-Norm(final)=10.430 | 4547.4 samples/s | 71.1 steps/s
[Step=13100 Epoch=63.8] | Loss=0.01328 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.393 | L2-Norm(final)=10.433 | 5512.4 samples/s | 86.1 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01267 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.402 | L2-Norm(final)=10.437 | 1449.2 samples/s | 22.6 steps/s
[Step=13200 Epoch=64.3] | Loss=0.01218 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.410 | L2-Norm(final)=10.440 | 4664.2 samples/s | 72.9 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01186 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.417 | L2-Norm(final)=10.443 | 4584.7 samples/s | 71.6 steps/s
[Step=13300 Epoch=64.8] | Loss=0.01142 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.424 | L2-Norm(final)=10.446 | 5116.0 samples/s | 79.9 steps/s
[Step=13350 Epoch=65.0] | Loss=0.01104 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.430 | L2-Norm(final)=10.450 | 1458.5 samples/s | 22.8 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01071 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.436 | L2-Norm(final)=10.453 | 4620.0 samples/s | 72.2 steps/s
[Step=13450 Epoch=65.5] | Loss=0.01038 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.442 | L2-Norm(final)=10.456 | 4662.7 samples/s | 72.9 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01016 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.447 | L2-Norm(final)=10.459 | 4719.3 samples/s | 73.7 steps/s
[Step=13550 Epoch=66.0] | Loss=0.00988 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=10.462 | 1501.1 samples/s | 23.5 steps/s
[Step=13600 Epoch=66.3] | Loss=0.00959 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.457 | L2-Norm(final)=10.465 | 4612.0 samples/s | 72.1 steps/s
[Step=13650 Epoch=66.5] | Loss=0.00950 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.462 | L2-Norm(final)=10.468 | 4693.8 samples/s | 73.3 steps/s
[Step=13700 Epoch=66.8] | Loss=0.00928 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.467 | L2-Norm(final)=10.470 | 4570.9 samples/s | 71.4 steps/s
[Step=13750 Epoch=67.0] | Loss=0.00907 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.471 | L2-Norm(final)=10.473 | 1519.2 samples/s | 23.7 steps/s
[Step=13800 Epoch=67.2] | Loss=0.00886 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.476 | L2-Norm(final)=10.476 | 4675.0 samples/s | 73.0 steps/s
[Step=13850 Epoch=67.5] | Loss=0.00869 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.480 | L2-Norm(final)=10.479 | 4639.5 samples/s | 72.5 steps/s
[Step=13900 Epoch=67.7] | Loss=0.00857 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.485 | L2-Norm(final)=10.482 | 4579.2 samples/s | 71.6 steps/s
[Step=13950 Epoch=68.0] | Loss=0.00840 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=10.484 | 1506.5 samples/s | 23.5 steps/s
[Step=14000 Epoch=68.2] | Loss=0.00817 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.493 | L2-Norm(final)=10.487 | 4645.4 samples/s | 72.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_2/client_state-step14000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=98.1] | Loss=0.02808 | Reg=0.00124 | acc=0.9688 | L2-Norm=11.154 | L2-Norm(final)=11.765 | 3241.3 samples/s | 50.6 steps/s
[Step=20050 Epoch=98.3] | Loss=0.02446 | Reg=0.00124 | acc=0.9531 | L2-Norm=11.155 | L2-Norm(final)=11.774 | 4580.3 samples/s | 71.6 steps/s
[Step=20100 Epoch=98.6] | Loss=0.02356 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=11.778 | 5357.4 samples/s | 83.7 steps/s
[Step=20150 Epoch=98.8] | Loss=0.02303 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=11.784 | 5487.2 samples/s | 85.7 steps/s
[Step=20200 Epoch=99.1] | Loss=0.02261 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.155 | L2-Norm(final)=11.790 | 8693.0 samples/s | 135.8 steps/s
[Step=20250 Epoch=99.3] | Loss=0.02290 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=11.796 | 1473.6 samples/s | 23.0 steps/s
[Step=20300 Epoch=99.5] | Loss=0.02225 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=11.801 | 5388.0 samples/s | 84.2 steps/s
[Step=20350 Epoch=99.8] | Loss=0.02214 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=11.808 | 5377.9 samples/s | 84.0 steps/s
[Step=20400 Epoch=100.0] | Loss=0.02217 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=11.813 | 7890.9 samples/s | 123.3 steps/s
[Step=20450 Epoch=100.3] | Loss=0.02213 | Reg=0.00124 | acc=0.9688 | L2-Norm=11.155 | L2-Norm(final)=11.819 | 1437.6 samples/s | 22.5 steps/s
[Step=20500 Epoch=100.5] | Loss=0.02231 | Reg=0.00124 | acc=0.9688 | L2-Norm=11.155 | L2-Norm(final)=11.825 | 5448.3 samples/s | 85.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=100.5] | Loss=0.00699 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=11.880 | 3166.8 samples/s | 49.5 steps/s
[Step=20550 Epoch=100.8] | Loss=0.02661 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.195 | L2-Norm(final)=11.873 | 4142.5 samples/s | 64.7 steps/s
[Step=20600 Epoch=101.0] | Loss=0.03096 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.233 | L2-Norm(final)=11.865 | 4675.6 samples/s | 73.1 steps/s
[Step=20650 Epoch=101.3] | Loss=0.02892 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.261 | L2-Norm(final)=11.861 | 4600.6 samples/s | 71.9 steps/s
[Step=20700 Epoch=101.5] | Loss=0.02619 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.283 | L2-Norm(final)=11.862 | 6742.6 samples/s | 105.4 steps/s
[Step=20750 Epoch=101.8] | Loss=0.02255 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.303 | L2-Norm(final)=11.866 | 1387.6 samples/s | 21.7 steps/s
[Step=20800 Epoch=102.0] | Loss=0.02045 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.320 | L2-Norm(final)=11.870 | 4612.3 samples/s | 72.1 steps/s
[Step=20850 Epoch=102.2] | Loss=0.01906 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.333 | L2-Norm(final)=11.874 | 4670.9 samples/s | 73.0 steps/s
[Step=20900 Epoch=102.5] | Loss=0.01771 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.345 | L2-Norm(final)=11.878 | 6364.9 samples/s | 99.5 steps/s
[Step=20950 Epoch=102.7] | Loss=0.01639 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.356 | L2-Norm(final)=11.883 | 1379.8 samples/s | 21.6 steps/s
[Step=21000 Epoch=103.0] | Loss=0.01538 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.366 | L2-Norm(final)=11.888 | 4655.0 samples/s | 72.7 steps/s
[Step=21050 Epoch=103.2] | Loss=0.01463 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.375 | L2-Norm(final)=11.892 | 4698.4 samples/s | 73.4 steps/s
[Step=21100 Epoch=103.5] | Loss=0.01390 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.383 | L2-Norm(final)=11.896 | 5959.8 samples/s | 93.1 steps/s
[Step=21150 Epoch=103.7] | Loss=0.01349 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.391 | L2-Norm(final)=11.900 | 1434.7 samples/s | 22.4 steps/s
[Step=21200 Epoch=104.0] | Loss=0.01298 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.399 | L2-Norm(final)=11.904 | 4569.3 samples/s | 71.4 steps/s
[Step=21250 Epoch=104.2] | Loss=0.01236 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.406 | L2-Norm(final)=11.907 | 4709.2 samples/s | 73.6 steps/s
[Step=21300 Epoch=104.5] | Loss=0.01201 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=11.911 | 5733.0 samples/s | 89.6 steps/s
[Step=21350 Epoch=104.7] | Loss=0.01151 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.419 | L2-Norm(final)=11.914 | 1445.0 samples/s | 22.6 steps/s
[Step=21400 Epoch=104.9] | Loss=0.01111 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.425 | L2-Norm(final)=11.918 | 4702.0 samples/s | 73.5 steps/s
[Step=21450 Epoch=105.2] | Loss=0.01082 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=11.921 | 4733.3 samples/s | 74.0 steps/s
[Step=21500 Epoch=105.4] | Loss=0.01043 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=11.924 | 5379.4 samples/s | 84.1 steps/s
[Step=21550 Epoch=105.7] | Loss=0.01014 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.440 | L2-Norm(final)=11.927 | 1496.9 samples/s | 23.4 steps/s
[Step=21600 Epoch=105.9] | Loss=0.00986 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.445 | L2-Norm(final)=11.930 | 4674.8 samples/s | 73.0 steps/s
[Step=21650 Epoch=106.2] | Loss=0.00959 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.449 | L2-Norm(final)=11.934 | 4704.4 samples/s | 73.5 steps/s
[Step=21700 Epoch=106.4] | Loss=0.00933 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.453 | L2-Norm(final)=11.937 | 5099.2 samples/s | 79.7 steps/s
[Step=21750 Epoch=106.7] | Loss=0.00906 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.457 | L2-Norm(final)=11.940 | 1522.9 samples/s | 23.8 steps/s
[Step=21800 Epoch=106.9] | Loss=0.00881 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.461 | L2-Norm(final)=11.943 | 4691.8 samples/s | 73.3 steps/s
[Step=21850 Epoch=107.1] | Loss=0.00859 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.465 | L2-Norm(final)=11.946 | 4706.6 samples/s | 73.5 steps/s
[Step=21900 Epoch=107.4] | Loss=0.00838 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.469 | L2-Norm(final)=11.949 | 4892.4 samples/s | 76.4 steps/s
[Step=21950 Epoch=107.6] | Loss=0.00820 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.472 | L2-Norm(final)=11.952 | 1538.4 samples/s | 24.0 steps/s
[Step=22000 Epoch=107.9] | Loss=0.00811 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.955 | 4693.5 samples/s | 73.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_4/client_state-step22000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=32001 Epoch=303.2] | Loss=0.00094 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.154 | L2-Norm(final)=17.437 | 3115.4 samples/s | 48.7 steps/s
[Step=32050 Epoch=303.7] | Loss=0.00046 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=17.432 | 4620.3 samples/s | 72.2 steps/s
[Step=32100 Epoch=304.2] | Loss=0.00050 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=17.428 | 8058.9 samples/s | 125.9 steps/s
[Step=32150 Epoch=304.6] | Loss=0.00045 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=17.427 | 1446.2 samples/s | 22.6 steps/s
[Step=32200 Epoch=305.1] | Loss=0.00044 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=17.427 | 7154.7 samples/s | 111.8 steps/s
[Step=32250 Epoch=305.6] | Loss=0.00046 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=17.428 | 1488.0 samples/s | 23.3 steps/s
[Step=32300 Epoch=306.1] | Loss=0.00048 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=17.429 | 6433.7 samples/s | 100.5 steps/s
[Step=32350 Epoch=306.5] | Loss=0.00045 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=17.432 | 1537.6 samples/s | 24.0 steps/s
[Step=32400 Epoch=307.0] | Loss=0.00047 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=17.435 | 5704.4 samples/s | 89.1 steps/s
[Step=32450 Epoch=307.5] | Loss=0.00045 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=17.440 | 1579.0 samples/s | 24.7 steps/s
[Step=32500 Epoch=308.0] | Loss=0.00046 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=17.445 | 5273.8 samples/s | 82.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=32501 Epoch=308.0] | Loss=0.00002 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=17.493 | 3215.5 samples/s | 50.2 steps/s
[Step=32550 Epoch=308.4] | Loss=0.00258 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.187 | L2-Norm(final)=17.503 | 3924.0 samples/s | 61.3 steps/s
[Step=32600 Epoch=308.9] | Loss=0.00143 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.239 | L2-Norm(final)=17.503 | 6509.6 samples/s | 101.7 steps/s
[Step=32650 Epoch=309.4] | Loss=0.00097 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.257 | L2-Norm(final)=17.505 | 1368.4 samples/s | 21.4 steps/s
[Step=32700 Epoch=309.9] | Loss=0.00073 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.262 | L2-Norm(final)=17.506 | 5908.5 samples/s | 92.3 steps/s
[Step=32750 Epoch=310.3] | Loss=0.00059 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.262 | L2-Norm(final)=17.508 | 1393.9 samples/s | 21.8 steps/s
[Step=32800 Epoch=310.8] | Loss=0.00049 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.259 | L2-Norm(final)=17.509 | 5377.7 samples/s | 84.0 steps/s
[Step=32850 Epoch=311.3] | Loss=0.00042 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.255 | L2-Norm(final)=17.509 | 1448.8 samples/s | 22.6 steps/s
[Step=32900 Epoch=311.8] | Loss=0.00037 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.250 | L2-Norm(final)=17.510 | 4985.7 samples/s | 77.9 steps/s
[Step=32950 Epoch=312.2] | Loss=0.00033 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=17.511 | 1222.0 samples/s | 19.1 steps/s
[Step=33000 Epoch=312.7] | Loss=0.00030 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.239 | L2-Norm(final)=17.511 | 4585.3 samples/s | 71.6 steps/s
[Step=33050 Epoch=313.2] | Loss=0.00027 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.232 | L2-Norm(final)=17.512 | 1480.2 samples/s | 23.1 steps/s
[Step=33100 Epoch=313.7] | Loss=0.00025 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.226 | L2-Norm(final)=17.512 | 4600.6 samples/s | 71.9 steps/s
[Step=33150 Epoch=314.1] | Loss=0.00023 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.219 | L2-Norm(final)=17.513 | 1536.5 samples/s | 24.0 steps/s
[Step=33200 Epoch=314.6] | Loss=0.00021 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.213 | L2-Norm(final)=17.513 | 4448.8 samples/s | 69.5 steps/s
[Step=33250 Epoch=315.1] | Loss=0.00020 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=17.513 | 1505.0 samples/s | 23.5 steps/s
[Step=33300 Epoch=315.5] | Loss=0.00019 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.199 | L2-Norm(final)=17.514 | 4492.3 samples/s | 70.2 steps/s
[Step=33350 Epoch=316.0] | Loss=0.00018 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.192 | L2-Norm(final)=17.514 | 1579.8 samples/s | 24.7 steps/s
[Step=33400 Epoch=316.5] | Loss=0.00017 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.185 | L2-Norm(final)=17.515 | 4056.2 samples/s | 63.4 steps/s
[Step=33450 Epoch=317.0] | Loss=0.00016 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=17.515 | 6702.6 samples/s | 104.7 steps/s
[Step=33500 Epoch=317.4] | Loss=0.00015 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.171 | L2-Norm(final)=17.515 | 1367.7 samples/s | 21.4 steps/s
[Step=33550 Epoch=317.9] | Loss=0.00014 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.164 | L2-Norm(final)=17.516 | 6119.4 samples/s | 95.6 steps/s
[Step=33600 Epoch=318.4] | Loss=0.00014 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.156 | L2-Norm(final)=17.516 | 1381.9 samples/s | 21.6 steps/s
[Step=33650 Epoch=318.9] | Loss=0.00013 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.149 | L2-Norm(final)=17.517 | 5551.2 samples/s | 86.7 steps/s
[Step=33700 Epoch=319.3] | Loss=0.00013 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.142 | L2-Norm(final)=17.517 | 1422.7 samples/s | 22.2 steps/s
[Step=33750 Epoch=319.8] | Loss=0.00012 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.134 | L2-Norm(final)=17.517 | 5013.0 samples/s | 78.3 steps/s
[Step=33800 Epoch=320.3] | Loss=0.00012 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.127 | L2-Norm(final)=17.518 | 1443.3 samples/s | 22.6 steps/s
[Step=33850 Epoch=320.8] | Loss=0.00011 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.119 | L2-Norm(final)=17.518 | 4692.9 samples/s | 73.3 steps/s
[Step=33900 Epoch=321.2] | Loss=0.00011 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.112 | L2-Norm(final)=17.518 | 1515.1 samples/s | 23.7 steps/s
[Step=33950 Epoch=321.7] | Loss=0.00010 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.104 | L2-Norm(final)=17.519 | 4487.3 samples/s | 70.1 steps/s
[Step=34000 Epoch=322.2] | Loss=0.00010 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.097 | L2-Norm(final)=17.519 | 1547.5 samples/s | 24.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step34000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=266.4] | Loss=0.00119 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.154 | L2-Norm(final)=13.615 | 3128.6 samples/s | 48.9 steps/s
[Step=28050 Epoch=266.8] | Loss=0.00067 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.152 | L2-Norm(final)=13.622 | 4708.8 samples/s | 73.6 steps/s
[Step=28100 Epoch=267.3] | Loss=0.00102 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=13.629 | 7750.8 samples/s | 121.1 steps/s
[Step=28150 Epoch=267.8] | Loss=0.00091 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=13.635 | 1431.5 samples/s | 22.4 steps/s
[Step=28200 Epoch=268.3] | Loss=0.00091 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=13.641 | 7229.7 samples/s | 113.0 steps/s
[Step=28250 Epoch=268.7] | Loss=0.00101 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=13.648 | 1482.3 samples/s | 23.2 steps/s
[Step=28300 Epoch=269.2] | Loss=0.00099 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=13.656 | 6418.1 samples/s | 100.3 steps/s
[Step=28350 Epoch=269.7] | Loss=0.00107 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=13.663 | 1503.0 samples/s | 23.5 steps/s
[Step=28400 Epoch=270.2] | Loss=0.00097 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=13.670 | 5877.9 samples/s | 91.8 steps/s
[Step=28450 Epoch=270.6] | Loss=0.00099 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=13.676 | 1570.4 samples/s | 24.5 steps/s
[Step=28500 Epoch=271.1] | Loss=0.00099 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=13.683 | 5218.0 samples/s | 81.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=271.1] | Loss=0.00067 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=13.752 | 3200.6 samples/s | 50.0 steps/s
[Step=28550 Epoch=271.6] | Loss=0.00104 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.179 | L2-Norm(final)=13.758 | 3923.6 samples/s | 61.3 steps/s
[Step=28600 Epoch=272.1] | Loss=0.00064 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.213 | L2-Norm(final)=13.760 | 6551.3 samples/s | 102.4 steps/s
[Step=28650 Epoch=272.5] | Loss=0.00043 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=13.763 | 1393.5 samples/s | 21.8 steps/s
[Step=28700 Epoch=273.0] | Loss=0.00033 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=13.765 | 5925.9 samples/s | 92.6 steps/s
[Step=28750 Epoch=273.5] | Loss=0.00026 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.220 | L2-Norm(final)=13.766 | 1407.4 samples/s | 22.0 steps/s
[Step=28800 Epoch=274.0] | Loss=0.00022 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.214 | L2-Norm(final)=13.768 | 5390.0 samples/s | 84.2 steps/s
[Step=28850 Epoch=274.4] | Loss=0.00019 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.207 | L2-Norm(final)=13.769 | 1428.2 samples/s | 22.3 steps/s
[Step=28900 Epoch=274.9] | Loss=0.00017 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.199 | L2-Norm(final)=13.770 | 4995.3 samples/s | 78.1 steps/s
[Step=28950 Epoch=275.4] | Loss=0.00015 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=13.770 | 1489.5 samples/s | 23.3 steps/s
[Step=29000 Epoch=275.9] | Loss=0.00014 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.183 | L2-Norm(final)=13.771 | 4526.8 samples/s | 70.7 steps/s
[Step=29050 Epoch=276.3] | Loss=0.00012 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=13.772 | 1552.9 samples/s | 24.3 steps/s
[Step=29100 Epoch=276.8] | Loss=0.00011 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.165 | L2-Norm(final)=13.773 | 4487.4 samples/s | 70.1 steps/s
[Step=29150 Epoch=277.3] | Loss=0.00010 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=13.773 | 1519.6 samples/s | 23.7 steps/s
[Step=29200 Epoch=277.8] | Loss=0.00010 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.148 | L2-Norm(final)=13.774 | 4410.8 samples/s | 68.9 steps/s
[Step=29250 Epoch=278.2] | Loss=0.00009 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.139 | L2-Norm(final)=13.775 | 1540.3 samples/s | 24.1 steps/s
[Step=29300 Epoch=278.7] | Loss=0.00009 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.130 | L2-Norm(final)=13.775 | 4539.2 samples/s | 70.9 steps/s
[Step=29350 Epoch=279.2] | Loss=0.00008 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.121 | L2-Norm(final)=13.776 | 1541.7 samples/s | 24.1 steps/s
[Step=29400 Epoch=279.7] | Loss=0.00008 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.112 | L2-Norm(final)=13.777 | 4217.5 samples/s | 65.9 steps/s
[Step=29450 Epoch=280.1] | Loss=0.00007 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.103 | L2-Norm(final)=13.777 | 6554.1 samples/s | 102.4 steps/s
[Step=29500 Epoch=280.6] | Loss=0.00007 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.093 | L2-Norm(final)=13.778 | 1387.8 samples/s | 21.7 steps/s
[Step=29550 Epoch=281.1] | Loss=0.00007 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.084 | L2-Norm(final)=13.778 | 6051.8 samples/s | 94.6 steps/s
[Step=29600 Epoch=281.6] | Loss=0.00006 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.075 | L2-Norm(final)=13.779 | 1394.4 samples/s | 21.8 steps/s
[Step=29650 Epoch=282.0] | Loss=0.00006 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.066 | L2-Norm(final)=13.779 | 5535.6 samples/s | 86.5 steps/s
[Step=29700 Epoch=282.5] | Loss=0.00006 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.057 | L2-Norm(final)=13.780 | 1430.1 samples/s | 22.3 steps/s
[Step=29750 Epoch=283.0] | Loss=0.00006 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.047 | L2-Norm(final)=13.781 | 5118.5 samples/s | 80.0 steps/s
[Step=29800 Epoch=283.5] | Loss=0.00005 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.038 | L2-Norm(final)=13.781 | 1499.4 samples/s | 23.4 steps/s
[Step=29850 Epoch=283.9] | Loss=0.00005 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.029 | L2-Norm(final)=13.782 | 4670.0 samples/s | 73.0 steps/s
[Step=29900 Epoch=284.4] | Loss=0.00005 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=13.782 | 1513.9 samples/s | 23.7 steps/s
[Step=29950 Epoch=284.9] | Loss=0.00005 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.010 | L2-Norm(final)=13.783 | 4491.9 samples/s | 70.2 steps/s
[Step=30000 Epoch=285.4] | Loss=0.00005 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.000 | L2-Norm(final)=13.783 | 1523.8 samples/s | 23.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step30000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08840 | acc=0.9619 | tpr=0.9684 | fpr=0.0523 | 4504.5 samples/s | 17.6 steps/s
Avg test loss: 0.09361, Avg test acc: 0.95969, Avg tpr: 0.96666, Avg fpr: 0.05563, total FA: 434

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09131 | acc=0.9590 | tpr=0.9716 | fpr=0.0684 | 4738.2 samples/s | 18.5 steps/s
Avg test loss: 0.09315, Avg test acc: 0.95757, Avg tpr: 0.97068, Avg fpr: 0.07127, total FA: 556

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09313 | acc=0.9595 | tpr=0.9699 | fpr=0.0632 | 4583.5 samples/s | 17.9 steps/s
Avg test loss: 0.09767, Avg test acc: 0.95893, Avg tpr: 0.96888, Avg fpr: 0.06294, total FA: 491

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09874 | acc=0.9620 | tpr=0.9788 | fpr=0.0746 | 4615.5 samples/s | 18.0 steps/s
Avg test loss: 0.10255, Avg test acc: 0.96037, Avg tpr: 0.97791, Avg fpr: 0.07820, total FA: 610

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08467 | acc=0.9624 | tpr=0.9768 | fpr=0.0689 | 4537.7 samples/s | 17.7 steps/s
Avg test loss: 0.09050, Avg test acc: 0.96113, Avg tpr: 0.97535, Avg fpr: 0.07012, total FA: 547

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.45485 | acc=0.3002 | tpr=0.0116 | fpr=0.0733 | 4696.9 samples/s | 18.3 steps/s
Avg test loss: 5.47370, Avg test acc: 0.29838, Avg tpr: 0.01230, Avg fpr: 0.07243, total FA: 565

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.31518 | acc=0.2873 | tpr=0.0177 | fpr=0.1274 | 4598.3 samples/s | 18.0 steps/s
Avg test loss: 4.33073, Avg test acc: 0.28560, Avg tpr: 0.01725, Avg fpr: 0.12421, total FA: 969

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.45022 | acc=0.3044 | tpr=0.0176 | fpr=0.0728 | 4786.9 samples/s | 18.7 steps/s
Avg test loss: 4.47356, Avg test acc: 0.30195, Avg tpr: 0.01848, Avg fpr: 0.07461, total FA: 582

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.14865 | acc=0.3195 | tpr=0.0353 | fpr=0.0634 | 4432.7 samples/s | 17.3 steps/s
Avg test loss: 4.16404, Avg test acc: 0.31749, Avg tpr: 0.03503, Avg fpr: 0.06127, total FA: 478

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.81238 | acc=0.3084 | tpr=0.0137 | fpr=0.0515 | 4729.7 samples/s | 18.5 steps/s
Avg test loss: 5.83533, Avg test acc: 0.30639, Avg tpr: 0.01364, Avg fpr: 0.04974, total FA: 388

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.68209 | acc=0.1560 | tpr=0.7168 | fpr=0.8541 | 4521.6 samples/s | 17.7 steps/s
[Step= 100] | Loss=5.65860 | acc=0.1569 | tpr=0.6994 | fpr=0.8532 | 7915.3 samples/s | 30.9 steps/s
[Step= 150] | Loss=5.66653 | acc=0.1582 | tpr=0.7118 | fpr=0.8520 | 7785.1 samples/s | 30.4 steps/s
[Step= 200] | Loss=5.65426 | acc=0.1582 | tpr=0.7137 | fpr=0.8519 | 8332.1 samples/s | 32.5 steps/s
[Step= 250] | Loss=5.64972 | acc=0.1587 | tpr=0.7039 | fpr=0.8513 | 7874.2 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.64121 | acc=0.1598 | tpr=0.7033 | fpr=0.8501 | 7889.0 samples/s | 30.8 steps/s
[Step= 350] | Loss=5.64821 | acc=0.1596 | tpr=0.7070 | fpr=0.8503 | 8038.6 samples/s | 31.4 steps/s
[Step= 400] | Loss=5.64876 | acc=0.1593 | tpr=0.7030 | fpr=0.8506 | 8387.4 samples/s | 32.8 steps/s
[Step= 450] | Loss=5.64559 | acc=0.1593 | tpr=0.7016 | fpr=0.8506 | 7470.2 samples/s | 29.2 steps/s
[Step= 500] | Loss=5.64620 | acc=0.1595 | tpr=0.6996 | fpr=0.8502 | 8270.2 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.64380 | acc=0.1598 | tpr=0.7031 | fpr=0.8501 | 11030.8 samples/s | 43.1 steps/s
Avg test loss: 5.64440, Avg test acc: 0.15968, Avg tpr: 0.70285, Avg fpr: 0.85020, total FA: 118048

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.52818 | acc=0.1401 | tpr=0.7743 | fpr=0.8713 | 4560.7 samples/s | 17.8 steps/s
[Step= 100] | Loss=5.51307 | acc=0.1418 | tpr=0.7463 | fpr=0.8694 | 7969.2 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.51594 | acc=0.1430 | tpr=0.7435 | fpr=0.8680 | 7610.8 samples/s | 29.7 steps/s
[Step= 200] | Loss=5.50918 | acc=0.1431 | tpr=0.7377 | fpr=0.8677 | 8797.6 samples/s | 34.4 steps/s
[Step= 250] | Loss=5.50656 | acc=0.1441 | tpr=0.7380 | fpr=0.8667 | 8320.8 samples/s | 32.5 steps/s
[Step= 300] | Loss=5.50296 | acc=0.1445 | tpr=0.7367 | fpr=0.8663 | 7618.6 samples/s | 29.8 steps/s
[Step= 350] | Loss=5.51049 | acc=0.1441 | tpr=0.7383 | fpr=0.8667 | 7747.2 samples/s | 30.3 steps/s
[Step= 400] | Loss=5.51389 | acc=0.1437 | tpr=0.7352 | fpr=0.8671 | 8491.2 samples/s | 33.2 steps/s
[Step= 450] | Loss=5.51191 | acc=0.1435 | tpr=0.7313 | fpr=0.8672 | 8090.0 samples/s | 31.6 steps/s
[Step= 500] | Loss=5.51330 | acc=0.1435 | tpr=0.7273 | fpr=0.8670 | 7978.2 samples/s | 31.2 steps/s
[Step= 550] | Loss=5.51146 | acc=0.1437 | tpr=0.7322 | fpr=0.8670 | 9533.9 samples/s | 37.2 steps/s
Avg test loss: 5.51281, Avg test acc: 0.14361, Avg tpr: 0.73177, Avg fpr: 0.86708, total FA: 120393

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.20476 | acc=0.1327 | tpr=0.8186 | fpr=0.8796 | 4591.5 samples/s | 17.9 steps/s
[Step= 100] | Loss=6.17807 | acc=0.1352 | tpr=0.8166 | fpr=0.8776 | 8267.7 samples/s | 32.3 steps/s
[Step= 150] | Loss=6.18483 | acc=0.1360 | tpr=0.8228 | fpr=0.8766 | 8304.1 samples/s | 32.4 steps/s
[Step= 200] | Loss=6.16682 | acc=0.1356 | tpr=0.8219 | fpr=0.8769 | 8145.5 samples/s | 31.8 steps/s
[Step= 250] | Loss=6.15862 | acc=0.1363 | tpr=0.8192 | fpr=0.8761 | 7844.8 samples/s | 30.6 steps/s
[Step= 300] | Loss=6.15018 | acc=0.1366 | tpr=0.8175 | fpr=0.8758 | 7907.6 samples/s | 30.9 steps/s
[Step= 350] | Loss=6.16018 | acc=0.1363 | tpr=0.8172 | fpr=0.8760 | 8159.4 samples/s | 31.9 steps/s
[Step= 400] | Loss=6.16418 | acc=0.1362 | tpr=0.8140 | fpr=0.8761 | 7872.6 samples/s | 30.8 steps/s
[Step= 450] | Loss=6.15898 | acc=0.1365 | tpr=0.8130 | fpr=0.8758 | 7794.7 samples/s | 30.4 steps/s
[Step= 500] | Loss=6.15909 | acc=0.1365 | tpr=0.8079 | fpr=0.8757 | 8447.9 samples/s | 33.0 steps/s
[Step= 550] | Loss=6.15762 | acc=0.1365 | tpr=0.8074 | fpr=0.8757 | 9194.7 samples/s | 35.9 steps/s
Avg test loss: 6.15849, Avg test acc: 0.13637, Avg tpr: 0.80705, Avg fpr: 0.87582, total FA: 121606

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=7.45509 | acc=0.1260 | tpr=0.7876 | fpr=0.8859 | 4515.3 samples/s | 17.6 steps/s
[Step= 100] | Loss=7.41939 | acc=0.1280 | tpr=0.7868 | fpr=0.8843 | 8278.9 samples/s | 32.3 steps/s
[Step= 150] | Loss=7.41972 | acc=0.1293 | tpr=0.7867 | fpr=0.8828 | 8058.3 samples/s | 31.5 steps/s
[Step= 200] | Loss=7.40957 | acc=0.1292 | tpr=0.7803 | fpr=0.8827 | 8013.1 samples/s | 31.3 steps/s
[Step= 250] | Loss=7.40446 | acc=0.1295 | tpr=0.7790 | fpr=0.8824 | 8464.5 samples/s | 33.1 steps/s
[Step= 300] | Loss=7.39936 | acc=0.1295 | tpr=0.7796 | fpr=0.8823 | 7611.0 samples/s | 29.7 steps/s
[Step= 350] | Loss=7.41262 | acc=0.1289 | tpr=0.7858 | fpr=0.8831 | 8126.0 samples/s | 31.7 steps/s
[Step= 400] | Loss=7.41332 | acc=0.1290 | tpr=0.7850 | fpr=0.8830 | 7999.4 samples/s | 31.2 steps/s
[Step= 450] | Loss=7.41165 | acc=0.1289 | tpr=0.7824 | fpr=0.8829 | 7264.0 samples/s | 28.4 steps/s
[Step= 500] | Loss=7.41259 | acc=0.1288 | tpr=0.7806 | fpr=0.8829 | 8312.1 samples/s | 32.5 steps/s
[Step= 550] | Loss=7.41190 | acc=0.1291 | tpr=0.7835 | fpr=0.8828 | 10439.1 samples/s | 40.8 steps/s
Avg test loss: 7.41328, Avg test acc: 0.12896, Avg tpr: 0.78249, Avg fpr: 0.88292, total FA: 122592

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.15358 | acc=0.1268 | tpr=0.7965 | fpr=0.8852 | 4691.1 samples/s | 18.3 steps/s
[Step= 100] | Loss=6.12784 | acc=0.1286 | tpr=0.7804 | fpr=0.8836 | 8270.9 samples/s | 32.3 steps/s
[Step= 150] | Loss=6.13440 | acc=0.1292 | tpr=0.7781 | fpr=0.8828 | 7583.3 samples/s | 29.6 steps/s
[Step= 200] | Loss=6.12742 | acc=0.1287 | tpr=0.7683 | fpr=0.8829 | 7453.7 samples/s | 29.1 steps/s
[Step= 250] | Loss=6.12634 | acc=0.1295 | tpr=0.7651 | fpr=0.8821 | 8946.6 samples/s | 34.9 steps/s
[Step= 300] | Loss=6.11913 | acc=0.1300 | tpr=0.7651 | fpr=0.8816 | 8002.5 samples/s | 31.3 steps/s
[Step= 350] | Loss=6.12686 | acc=0.1296 | tpr=0.7696 | fpr=0.8820 | 7938.9 samples/s | 31.0 steps/s
[Step= 400] | Loss=6.12883 | acc=0.1292 | tpr=0.7642 | fpr=0.8823 | 7578.4 samples/s | 29.6 steps/s
[Step= 450] | Loss=6.12575 | acc=0.1293 | tpr=0.7624 | fpr=0.8822 | 8222.6 samples/s | 32.1 steps/s
[Step= 500] | Loss=6.12891 | acc=0.1294 | tpr=0.7621 | fpr=0.8820 | 8437.1 samples/s | 33.0 steps/s
[Step= 550] | Loss=6.12820 | acc=0.1298 | tpr=0.7628 | fpr=0.8817 | 9360.9 samples/s | 36.6 steps/s
Avg test loss: 6.12955, Avg test acc: 0.12973, Avg tpr: 0.76268, Avg fpr: 0.88178, total FA: 122433

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.16666 | acc=0.9659 | tpr=0.9248 | fpr=0.0334 | 4542.4 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.17238 | acc=0.9650 | tpr=0.9254 | fpr=0.0343 | 8483.7 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.17798 | acc=0.9639 | tpr=0.9251 | fpr=0.0354 | 8302.6 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.17761 | acc=0.9644 | tpr=0.9290 | fpr=0.0349 | 8299.0 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.17850 | acc=0.9644 | tpr=0.9301 | fpr=0.0350 | 7505.1 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.18041 | acc=0.9639 | tpr=0.9287 | fpr=0.0355 | 8062.8 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.18169 | acc=0.9636 | tpr=0.9280 | fpr=0.0358 | 7771.7 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.18339 | acc=0.9632 | tpr=0.9245 | fpr=0.0361 | 7611.8 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.18559 | acc=0.9630 | tpr=0.9231 | fpr=0.0363 | 8158.7 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.18519 | acc=0.9629 | tpr=0.9225 | fpr=0.0364 | 8308.5 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.18504 | acc=0.9630 | tpr=0.9208 | fpr=0.0362 | 9777.9 samples/s | 38.2 steps/s
Avg test loss: 0.18482, Avg test acc: 0.96306, Avg tpr: 0.92076, Avg fpr: 0.03617, total FA: 5022

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16280 | acc=0.9612 | tpr=0.9381 | fpr=0.0384 | 4754.1 samples/s | 18.6 steps/s
[Step= 100] | Loss=0.16791 | acc=0.9611 | tpr=0.9424 | fpr=0.0386 | 8002.6 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.16955 | acc=0.9603 | tpr=0.9424 | fpr=0.0394 | 7561.5 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.17093 | acc=0.9603 | tpr=0.9454 | fpr=0.0395 | 7908.4 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.17213 | acc=0.9601 | tpr=0.9485 | fpr=0.0397 | 7410.4 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.17273 | acc=0.9596 | tpr=0.9455 | fpr=0.0402 | 8066.5 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.17284 | acc=0.9595 | tpr=0.9455 | fpr=0.0402 | 8167.4 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.17413 | acc=0.9591 | tpr=0.9431 | fpr=0.0406 | 8176.1 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.17478 | acc=0.9590 | tpr=0.9396 | fpr=0.0406 | 7647.0 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.17474 | acc=0.9590 | tpr=0.9414 | fpr=0.0407 | 8553.7 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.17483 | acc=0.9591 | tpr=0.9395 | fpr=0.0406 | 10238.8 samples/s | 40.0 steps/s
Avg test loss: 0.17452, Avg test acc: 0.95911, Avg tpr: 0.93978, Avg fpr: 0.04053, total FA: 5628

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.31623 | acc=0.9502 | tpr=0.9204 | fpr=0.0492 | 4788.4 samples/s | 18.7 steps/s
[Step= 100] | Loss=0.32546 | acc=0.9489 | tpr=0.9254 | fpr=0.0507 | 7601.0 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.33509 | acc=0.9478 | tpr=0.9337 | fpr=0.0520 | 7580.5 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.33779 | acc=0.9477 | tpr=0.9388 | fpr=0.0522 | 7665.1 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.33866 | acc=0.9475 | tpr=0.9389 | fpr=0.0524 | 7842.5 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.34103 | acc=0.9469 | tpr=0.9360 | fpr=0.0529 | 8518.7 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.34192 | acc=0.9468 | tpr=0.9361 | fpr=0.0530 | 8122.5 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.34528 | acc=0.9465 | tpr=0.9327 | fpr=0.0532 | 8197.9 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.34630 | acc=0.9462 | tpr=0.9333 | fpr=0.0536 | 8409.8 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.34604 | acc=0.9461 | tpr=0.9348 | fpr=0.0537 | 7733.1 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.34456 | acc=0.9463 | tpr=0.9339 | fpr=0.0535 | 9799.1 samples/s | 38.3 steps/s
Avg test loss: 0.34411, Avg test acc: 0.94628, Avg tpr: 0.93344, Avg fpr: 0.05349, total FA: 7427

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.13846 | acc=0.9660 | tpr=0.9425 | fpr=0.0336 | 4516.3 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.14276 | acc=0.9656 | tpr=0.9360 | fpr=0.0339 | 8331.0 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.14687 | acc=0.9644 | tpr=0.9352 | fpr=0.0350 | 8301.7 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.14789 | acc=0.9646 | tpr=0.9377 | fpr=0.0349 | 8195.2 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.14939 | acc=0.9645 | tpr=0.9380 | fpr=0.0350 | 7424.2 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.15122 | acc=0.9640 | tpr=0.9360 | fpr=0.0354 | 7745.6 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.15212 | acc=0.9639 | tpr=0.9368 | fpr=0.0356 | 8252.5 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.15293 | acc=0.9636 | tpr=0.9354 | fpr=0.0359 | 7770.1 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.15322 | acc=0.9633 | tpr=0.9328 | fpr=0.0361 | 8704.6 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.15259 | acc=0.9635 | tpr=0.9348 | fpr=0.0360 | 8409.4 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.15198 | acc=0.9636 | tpr=0.9324 | fpr=0.0358 | 9039.1 samples/s | 35.3 steps/s
Avg test loss: 0.15169, Avg test acc: 0.96363, Avg tpr: 0.93225, Avg fpr: 0.03579, total FA: 4970

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.18736 | acc=0.9605 | tpr=0.8894 | fpr=0.0383 | 4553.9 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.19268 | acc=0.9601 | tpr=0.9062 | fpr=0.0389 | 8580.7 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.19630 | acc=0.9596 | tpr=0.9121 | fpr=0.0395 | 8062.7 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.19675 | acc=0.9596 | tpr=0.9191 | fpr=0.0396 | 7756.0 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.19777 | acc=0.9594 | tpr=0.9179 | fpr=0.0398 | 7544.4 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.19893 | acc=0.9592 | tpr=0.9149 | fpr=0.0400 | 7969.1 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.19950 | acc=0.9592 | tpr=0.9142 | fpr=0.0400 | 8612.7 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.20084 | acc=0.9590 | tpr=0.9125 | fpr=0.0402 | 7946.9 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.20194 | acc=0.9586 | tpr=0.9119 | fpr=0.0405 | 8053.6 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.20177 | acc=0.9586 | tpr=0.9119 | fpr=0.0406 | 8111.1 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.20098 | acc=0.9587 | tpr=0.9125 | fpr=0.0405 | 9556.5 samples/s | 37.3 steps/s
Avg test loss: 0.20065, Avg test acc: 0.95870, Avg tpr: 0.91244, Avg fpr: 0.04045, total FA: 5617

server round 29/50

clients selected: [2 3 6 7 8]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=14001 Epoch=68.2] | Loss=0.06232 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.091 | L2-Norm(final)=10.573 | 3266.7 samples/s | 51.0 steps/s
[Step=14050 Epoch=68.5] | Loss=0.02352 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.092 | L2-Norm(final)=10.585 | 4779.4 samples/s | 74.7 steps/s
[Step=14100 Epoch=68.7] | Loss=0.02457 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.092 | L2-Norm(final)=10.591 | 5598.0 samples/s | 87.5 steps/s
[Step=14150 Epoch=68.9] | Loss=0.02354 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.092 | L2-Norm(final)=10.599 | 5434.8 samples/s | 84.9 steps/s
[Step=14200 Epoch=69.2] | Loss=0.02322 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.092 | L2-Norm(final)=10.609 | 8343.6 samples/s | 130.4 steps/s
[Step=14250 Epoch=69.4] | Loss=0.02323 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.092 | L2-Norm(final)=10.618 | 1508.4 samples/s | 23.6 steps/s
[Step=14300 Epoch=69.7] | Loss=0.02329 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.092 | L2-Norm(final)=10.625 | 5333.6 samples/s | 83.3 steps/s
[Step=14350 Epoch=69.9] | Loss=0.02323 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.092 | L2-Norm(final)=10.633 | 5527.2 samples/s | 86.4 steps/s
[Step=14400 Epoch=70.2] | Loss=0.02328 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.092 | L2-Norm(final)=10.641 | 7466.9 samples/s | 116.7 steps/s
[Step=14450 Epoch=70.4] | Loss=0.02308 | Reg=0.00123 | acc=0.9531 | L2-Norm=11.092 | L2-Norm(final)=10.649 | 1505.7 samples/s | 23.5 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02268 | Reg=0.00123 | acc=0.9531 | L2-Norm=11.092 | L2-Norm(final)=10.659 | 5643.0 samples/s | 88.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=14501 Epoch=70.7] | Loss=0.01682 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.092 | L2-Norm(final)=10.750 | 3243.7 samples/s | 50.7 steps/s
[Step=14550 Epoch=70.9] | Loss=0.02849 | Reg=0.00124 | acc=0.9688 | L2-Norm=11.127 | L2-Norm(final)=10.749 | 4137.0 samples/s | 64.6 steps/s
[Step=14600 Epoch=71.1] | Loss=0.02539 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.165 | L2-Norm(final)=10.746 | 4683.3 samples/s | 73.2 steps/s
[Step=14650 Epoch=71.4] | Loss=0.02476 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.197 | L2-Norm(final)=10.747 | 4756.1 samples/s | 74.3 steps/s
[Step=14700 Epoch=71.6] | Loss=0.02373 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.222 | L2-Norm(final)=10.748 | 6623.5 samples/s | 103.5 steps/s
[Step=14750 Epoch=71.9] | Loss=0.02100 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.243 | L2-Norm(final)=10.751 | 1431.3 samples/s | 22.4 steps/s
[Step=14800 Epoch=72.1] | Loss=0.01906 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=10.755 | 4695.2 samples/s | 73.4 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01765 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.275 | L2-Norm(final)=10.759 | 4654.2 samples/s | 72.7 steps/s
[Step=14900 Epoch=72.6] | Loss=0.01663 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=10.763 | 6079.5 samples/s | 95.0 steps/s
[Step=14950 Epoch=72.8] | Loss=0.01526 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.299 | L2-Norm(final)=10.768 | 1483.1 samples/s | 23.2 steps/s
[Step=15000 Epoch=73.1] | Loss=0.01436 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.309 | L2-Norm(final)=10.772 | 4773.4 samples/s | 74.6 steps/s
[Step=15050 Epoch=73.3] | Loss=0.01359 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.318 | L2-Norm(final)=10.776 | 4580.2 samples/s | 71.6 steps/s
[Step=15100 Epoch=73.6] | Loss=0.01320 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.326 | L2-Norm(final)=10.780 | 5649.2 samples/s | 88.3 steps/s
[Step=15150 Epoch=73.8] | Loss=0.01250 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.334 | L2-Norm(final)=10.784 | 1477.4 samples/s | 23.1 steps/s
[Step=15200 Epoch=74.1] | Loss=0.01207 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=10.788 | 4699.6 samples/s | 73.4 steps/s
[Step=15250 Epoch=74.3] | Loss=0.01163 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.347 | L2-Norm(final)=10.791 | 4752.0 samples/s | 74.2 steps/s
[Step=15300 Epoch=74.5] | Loss=0.01135 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=10.795 | 5123.6 samples/s | 80.1 steps/s
[Step=15350 Epoch=74.8] | Loss=0.01098 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.360 | L2-Norm(final)=10.798 | 1513.7 samples/s | 23.7 steps/s
[Step=15400 Epoch=75.0] | Loss=0.01066 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.366 | L2-Norm(final)=10.801 | 4697.6 samples/s | 73.4 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01028 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.371 | L2-Norm(final)=10.804 | 4748.5 samples/s | 74.2 steps/s
[Step=15500 Epoch=75.5] | Loss=0.01014 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.376 | L2-Norm(final)=10.807 | 4761.9 samples/s | 74.4 steps/s
[Step=15550 Epoch=75.8] | Loss=0.00984 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=10.810 | 1541.8 samples/s | 24.1 steps/s
[Step=15600 Epoch=76.0] | Loss=0.00968 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.386 | L2-Norm(final)=10.813 | 4684.6 samples/s | 73.2 steps/s
[Step=15650 Epoch=76.3] | Loss=0.00939 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.390 | L2-Norm(final)=10.815 | 4702.0 samples/s | 73.5 steps/s
[Step=15700 Epoch=76.5] | Loss=0.00916 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.394 | L2-Norm(final)=10.818 | 4682.2 samples/s | 73.2 steps/s
[Step=15750 Epoch=76.7] | Loss=0.00894 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.399 | L2-Norm(final)=10.821 | 1600.7 samples/s | 25.0 steps/s
[Step=15800 Epoch=77.0] | Loss=0.00877 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.403 | L2-Norm(final)=10.824 | 4730.5 samples/s | 73.9 steps/s
[Step=15850 Epoch=77.2] | Loss=0.00855 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=10.827 | 4675.6 samples/s | 73.1 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00848 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.411 | L2-Norm(final)=10.829 | 4694.7 samples/s | 73.4 steps/s
[Step=15950 Epoch=77.7] | Loss=0.00832 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.415 | L2-Norm(final)=10.832 | 1548.1 samples/s | 24.2 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00818 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.419 | L2-Norm(final)=10.835 | 4701.4 samples/s | 73.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_2/client_state-step16000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=32001 Epoch=156.1] | Loss=0.00648 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.091 | L2-Norm(final)=14.716 | 3201.2 samples/s | 50.0 steps/s
[Step=32050 Epoch=156.3] | Loss=0.01954 | Reg=0.00123 | acc=0.9531 | L2-Norm=11.091 | L2-Norm(final)=14.713 | 4769.2 samples/s | 74.5 steps/s
[Step=32100 Epoch=156.5] | Loss=0.02363 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.091 | L2-Norm(final)=14.701 | 5453.2 samples/s | 85.2 steps/s
[Step=32150 Epoch=156.8] | Loss=0.02244 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.091 | L2-Norm(final)=14.689 | 5474.3 samples/s | 85.5 steps/s
[Step=32200 Epoch=157.0] | Loss=0.02194 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.091 | L2-Norm(final)=14.682 | 8413.9 samples/s | 131.5 steps/s
[Step=32250 Epoch=157.3] | Loss=0.02189 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.091 | L2-Norm(final)=14.677 | 1531.2 samples/s | 23.9 steps/s
[Step=32300 Epoch=157.5] | Loss=0.02126 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.091 | L2-Norm(final)=14.673 | 5221.8 samples/s | 81.6 steps/s
[Step=32350 Epoch=157.8] | Loss=0.02133 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.091 | L2-Norm(final)=14.670 | 5457.2 samples/s | 85.3 steps/s
[Step=32400 Epoch=158.0] | Loss=0.02142 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.091 | L2-Norm(final)=14.667 | 7646.7 samples/s | 119.5 steps/s
[Step=32450 Epoch=158.2] | Loss=0.02122 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.091 | L2-Norm(final)=14.665 | 1490.9 samples/s | 23.3 steps/s
[Step=32500 Epoch=158.5] | Loss=0.02096 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.091 | L2-Norm(final)=14.664 | 5369.2 samples/s | 83.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=32501 Epoch=158.5] | Loss=0.00461 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.091 | L2-Norm(final)=14.651 | 3325.3 samples/s | 52.0 steps/s
[Step=32550 Epoch=158.7] | Loss=0.02606 | Reg=0.00124 | acc=0.9531 | L2-Norm=11.130 | L2-Norm(final)=14.647 | 3998.2 samples/s | 62.5 steps/s
[Step=32600 Epoch=159.0] | Loss=0.02664 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.170 | L2-Norm(final)=14.641 | 4703.9 samples/s | 73.5 steps/s
[Step=32650 Epoch=159.2] | Loss=0.02524 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.199 | L2-Norm(final)=14.638 | 4659.1 samples/s | 72.8 steps/s
[Step=32700 Epoch=159.5] | Loss=0.02391 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.221 | L2-Norm(final)=14.638 | 6766.1 samples/s | 105.7 steps/s
[Step=32750 Epoch=159.7] | Loss=0.02099 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.239 | L2-Norm(final)=14.638 | 1418.0 samples/s | 22.2 steps/s
[Step=32800 Epoch=160.0] | Loss=0.01885 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.255 | L2-Norm(final)=14.640 | 4702.1 samples/s | 73.5 steps/s
[Step=32850 Epoch=160.2] | Loss=0.01735 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.268 | L2-Norm(final)=14.642 | 4790.6 samples/s | 74.9 steps/s
[Step=32900 Epoch=160.4] | Loss=0.01611 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.279 | L2-Norm(final)=14.644 | 6055.1 samples/s | 94.6 steps/s
[Step=32950 Epoch=160.7] | Loss=0.01518 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=14.647 | 1441.6 samples/s | 22.5 steps/s
[Step=33000 Epoch=160.9] | Loss=0.01425 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.298 | L2-Norm(final)=14.650 | 4686.1 samples/s | 73.2 steps/s
[Step=33050 Epoch=161.2] | Loss=0.01342 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.306 | L2-Norm(final)=14.652 | 4725.3 samples/s | 73.8 steps/s
[Step=33100 Epoch=161.4] | Loss=0.01274 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.314 | L2-Norm(final)=14.655 | 5610.6 samples/s | 87.7 steps/s
[Step=33150 Epoch=161.7] | Loss=0.01241 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.322 | L2-Norm(final)=14.658 | 1492.9 samples/s | 23.3 steps/s
[Step=33200 Epoch=161.9] | Loss=0.01201 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.330 | L2-Norm(final)=14.661 | 4672.5 samples/s | 73.0 steps/s
[Step=33250 Epoch=162.1] | Loss=0.01186 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.337 | L2-Norm(final)=14.663 | 4672.3 samples/s | 73.0 steps/s
[Step=33300 Epoch=162.4] | Loss=0.01158 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.343 | L2-Norm(final)=14.664 | 5214.6 samples/s | 81.5 steps/s
[Step=33350 Epoch=162.6] | Loss=0.01114 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=14.665 | 1504.8 samples/s | 23.5 steps/s
[Step=33400 Epoch=162.9] | Loss=0.01073 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.354 | L2-Norm(final)=14.667 | 4661.8 samples/s | 72.8 steps/s
[Step=33450 Epoch=163.1] | Loss=0.01048 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.359 | L2-Norm(final)=14.669 | 4704.9 samples/s | 73.5 steps/s
[Step=33500 Epoch=163.4] | Loss=0.01010 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=14.670 | 4840.9 samples/s | 75.6 steps/s
[Step=33550 Epoch=163.6] | Loss=0.00974 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=14.671 | 1538.2 samples/s | 24.0 steps/s
[Step=33600 Epoch=163.9] | Loss=0.00951 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.373 | L2-Norm(final)=14.673 | 4733.4 samples/s | 74.0 steps/s
[Step=33650 Epoch=164.1] | Loss=0.00924 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.377 | L2-Norm(final)=14.675 | 4690.3 samples/s | 73.3 steps/s
[Step=33700 Epoch=164.3] | Loss=0.00899 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=14.676 | 4679.4 samples/s | 73.1 steps/s
[Step=33750 Epoch=164.6] | Loss=0.00883 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.384 | L2-Norm(final)=14.678 | 1563.0 samples/s | 24.4 steps/s
[Step=33800 Epoch=164.8] | Loss=0.00867 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.388 | L2-Norm(final)=14.679 | 4710.6 samples/s | 73.6 steps/s
[Step=33850 Epoch=165.1] | Loss=0.00843 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.392 | L2-Norm(final)=14.681 | 4733.4 samples/s | 74.0 steps/s
[Step=33900 Epoch=165.3] | Loss=0.00830 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.395 | L2-Norm(final)=14.682 | 4634.7 samples/s | 72.4 steps/s
[Step=33950 Epoch=165.6] | Loss=0.00818 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.398 | L2-Norm(final)=14.684 | 1555.3 samples/s | 24.3 steps/s
[Step=34000 Epoch=165.8] | Loss=0.00798 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.401 | L2-Norm(final)=14.685 | 4727.9 samples/s | 73.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step34000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=30001 Epoch=285.4] | Loss=0.00006 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.091 | L2-Norm(final)=13.800 | 3259.1 samples/s | 50.9 steps/s
[Step=30050 Epoch=285.9] | Loss=0.00093 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=13.818 | 4271.5 samples/s | 66.7 steps/s
[Step=30100 Epoch=286.3] | Loss=0.00078 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=13.831 | 8154.1 samples/s | 127.4 steps/s
[Step=30150 Epoch=286.8] | Loss=0.00082 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=13.842 | 1472.3 samples/s | 23.0 steps/s
[Step=30200 Epoch=287.3] | Loss=0.00078 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=13.854 | 7158.9 samples/s | 111.9 steps/s
[Step=30250 Epoch=287.8] | Loss=0.00070 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=13.865 | 1497.9 samples/s | 23.4 steps/s
[Step=30300 Epoch=288.2] | Loss=0.00075 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.087 | L2-Norm(final)=13.875 | 6544.8 samples/s | 102.3 steps/s
[Step=30350 Epoch=288.7] | Loss=0.00078 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=13.886 | 1520.2 samples/s | 23.8 steps/s
[Step=30400 Epoch=289.2] | Loss=0.00078 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=13.897 | 5891.1 samples/s | 92.0 steps/s
[Step=30450 Epoch=289.7] | Loss=0.00075 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=13.908 | 1541.5 samples/s | 24.1 steps/s
[Step=30500 Epoch=290.1] | Loss=0.00071 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=13.919 | 5362.9 samples/s | 83.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=30501 Epoch=290.1] | Loss=0.00012 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=14.025 | 2916.4 samples/s | 45.6 steps/s
[Step=30550 Epoch=290.6] | Loss=0.00074 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.134 | L2-Norm(final)=14.034 | 4560.0 samples/s | 71.2 steps/s
[Step=30600 Epoch=291.1] | Loss=0.00046 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=14.039 | 6355.9 samples/s | 99.3 steps/s
[Step=30650 Epoch=291.6] | Loss=0.00032 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.163 | L2-Norm(final)=14.042 | 1382.2 samples/s | 21.6 steps/s
[Step=30700 Epoch=292.0] | Loss=0.00027 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.162 | L2-Norm(final)=14.044 | 5850.0 samples/s | 91.4 steps/s
[Step=30750 Epoch=292.5] | Loss=0.00025 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.165 | L2-Norm(final)=14.047 | 1421.2 samples/s | 22.2 steps/s
[Step=30800 Epoch=293.0] | Loss=0.00021 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.165 | L2-Norm(final)=14.048 | 5407.3 samples/s | 84.5 steps/s
[Step=30850 Epoch=293.5] | Loss=0.00019 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.163 | L2-Norm(final)=14.050 | 1443.9 samples/s | 22.6 steps/s
[Step=30900 Epoch=293.9] | Loss=0.00016 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.159 | L2-Norm(final)=14.052 | 4967.5 samples/s | 77.6 steps/s
[Step=30950 Epoch=294.4] | Loss=0.00015 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.153 | L2-Norm(final)=14.053 | 1522.8 samples/s | 23.8 steps/s
[Step=31000 Epoch=294.9] | Loss=0.00013 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.147 | L2-Norm(final)=14.054 | 4518.7 samples/s | 70.6 steps/s
[Step=31050 Epoch=295.4] | Loss=0.00012 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.141 | L2-Norm(final)=14.054 | 1492.9 samples/s | 23.3 steps/s
[Step=31100 Epoch=295.8] | Loss=0.00011 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.134 | L2-Norm(final)=14.055 | 4482.9 samples/s | 70.0 steps/s
[Step=31150 Epoch=296.3] | Loss=0.00010 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.126 | L2-Norm(final)=14.056 | 1548.6 samples/s | 24.2 steps/s
[Step=31200 Epoch=296.8] | Loss=0.00009 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.118 | L2-Norm(final)=14.056 | 4325.7 samples/s | 67.6 steps/s
[Step=31250 Epoch=297.3] | Loss=0.00009 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.110 | L2-Norm(final)=14.057 | 1572.1 samples/s | 24.6 steps/s
[Step=31300 Epoch=297.7] | Loss=0.00008 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=14.057 | 4469.0 samples/s | 69.8 steps/s
[Step=31350 Epoch=298.2] | Loss=0.00008 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=14.057 | 1558.3 samples/s | 24.3 steps/s
[Step=31400 Epoch=298.7] | Loss=0.00007 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.086 | L2-Norm(final)=14.058 | 4364.5 samples/s | 68.2 steps/s
[Step=31450 Epoch=299.2] | Loss=0.00007 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.077 | L2-Norm(final)=14.058 | 6628.1 samples/s | 103.6 steps/s
[Step=31500 Epoch=299.6] | Loss=0.00007 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.069 | L2-Norm(final)=14.058 | 1387.8 samples/s | 21.7 steps/s
[Step=31550 Epoch=300.1] | Loss=0.00006 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.060 | L2-Norm(final)=14.059 | 5992.3 samples/s | 93.6 steps/s
[Step=31600 Epoch=300.6] | Loss=0.00006 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.051 | L2-Norm(final)=14.059 | 1407.9 samples/s | 22.0 steps/s
[Step=31650 Epoch=301.1] | Loss=0.00006 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.042 | L2-Norm(final)=14.059 | 5487.7 samples/s | 85.7 steps/s
[Step=31700 Epoch=301.5] | Loss=0.00006 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.033 | L2-Norm(final)=14.060 | 1433.0 samples/s | 22.4 steps/s
[Step=31750 Epoch=302.0] | Loss=0.00005 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=14.060 | 5157.2 samples/s | 80.6 steps/s
[Step=31800 Epoch=302.5] | Loss=0.00005 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.015 | L2-Norm(final)=14.060 | 1495.1 samples/s | 23.4 steps/s
[Step=31850 Epoch=303.0] | Loss=0.00005 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.006 | L2-Norm(final)=14.061 | 4679.1 samples/s | 73.1 steps/s
[Step=31900 Epoch=303.4] | Loss=0.00005 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.997 | L2-Norm(final)=14.061 | 1500.5 samples/s | 23.4 steps/s
[Step=31950 Epoch=303.9] | Loss=0.00005 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.988 | L2-Norm(final)=14.061 | 4338.3 samples/s | 67.8 steps/s
[Step=32000 Epoch=304.4] | Loss=0.00004 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.978 | L2-Norm(final)=14.061 | 1531.1 samples/s | 23.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step32000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=36001 Epoch=343.8] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.091 | L2-Norm(final)=16.702 | 3145.9 samples/s | 49.2 steps/s
[Step=36050 Epoch=344.3] | Loss=0.00009 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.089 | L2-Norm(final)=16.707 | 4669.8 samples/s | 73.0 steps/s
[Step=36100 Epoch=344.7] | Loss=0.00015 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=16.714 | 8392.0 samples/s | 131.1 steps/s
[Step=36150 Epoch=345.2] | Loss=0.00017 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=16.721 | 1423.2 samples/s | 22.2 steps/s
[Step=36200 Epoch=345.7] | Loss=0.00015 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=16.729 | 7496.8 samples/s | 117.1 steps/s
[Step=36250 Epoch=346.2] | Loss=0.00012 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=16.735 | 1495.2 samples/s | 23.4 steps/s
[Step=36300 Epoch=346.6] | Loss=0.00014 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=16.742 | 6708.3 samples/s | 104.8 steps/s
[Step=36350 Epoch=347.1] | Loss=0.00014 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=16.749 | 1475.0 samples/s | 23.0 steps/s
[Step=36400 Epoch=347.6] | Loss=0.00013 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=16.755 | 6199.0 samples/s | 96.9 steps/s
[Step=36450 Epoch=348.1] | Loss=0.00013 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=16.761 | 1514.3 samples/s | 23.7 steps/s
[Step=36500 Epoch=348.6] | Loss=0.00013 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=16.767 | 5662.7 samples/s | 88.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=36501 Epoch=348.6] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=16.826 | 3117.1 samples/s | 48.7 steps/s
[Step=36550 Epoch=349.0] | Loss=0.00005 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.082 | L2-Norm(final)=16.833 | 4034.9 samples/s | 63.0 steps/s
[Step=36600 Epoch=349.5] | Loss=0.00003 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.071 | L2-Norm(final)=16.835 | 6634.8 samples/s | 103.7 steps/s
[Step=36650 Epoch=350.0] | Loss=0.00002 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.056 | L2-Norm(final)=16.836 | 1373.9 samples/s | 21.5 steps/s
[Step=36700 Epoch=350.5] | Loss=0.00002 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.041 | L2-Norm(final)=16.837 | 6104.7 samples/s | 95.4 steps/s
[Step=36750 Epoch=350.9] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.026 | L2-Norm(final)=16.838 | 1406.8 samples/s | 22.0 steps/s
[Step=36800 Epoch=351.4] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.012 | L2-Norm(final)=16.839 | 5589.7 samples/s | 87.3 steps/s
[Step=36850 Epoch=351.9] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.997 | L2-Norm(final)=16.839 | 1431.7 samples/s | 22.4 steps/s
[Step=36900 Epoch=352.4] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.983 | L2-Norm(final)=16.840 | 5124.5 samples/s | 80.1 steps/s
[Step=36950 Epoch=352.8] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.969 | L2-Norm(final)=16.840 | 1459.2 samples/s | 22.8 steps/s
[Step=37000 Epoch=353.3] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=16.841 | 4920.2 samples/s | 76.9 steps/s
[Step=37050 Epoch=353.8] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.942 | L2-Norm(final)=16.841 | 1471.6 samples/s | 23.0 steps/s
[Step=37100 Epoch=354.3] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.929 | L2-Norm(final)=16.841 | 4499.2 samples/s | 70.3 steps/s
[Step=37150 Epoch=354.8] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.915 | L2-Norm(final)=16.842 | 1529.3 samples/s | 23.9 steps/s
[Step=37200 Epoch=355.2] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.902 | L2-Norm(final)=16.842 | 4363.1 samples/s | 68.2 steps/s
[Step=37250 Epoch=355.7] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.889 | L2-Norm(final)=16.843 | 1557.2 samples/s | 24.3 steps/s
[Step=37300 Epoch=356.2] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.875 | L2-Norm(final)=16.843 | 4396.1 samples/s | 68.7 steps/s
[Step=37350 Epoch=356.7] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.862 | L2-Norm(final)=16.843 | 1550.4 samples/s | 24.2 steps/s
[Step=37400 Epoch=357.1] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.849 | L2-Norm(final)=16.844 | 4434.9 samples/s | 69.3 steps/s
[Step=37450 Epoch=357.6] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.836 | L2-Norm(final)=16.844 | 1524.7 samples/s | 23.8 steps/s
[Step=37500 Epoch=358.1] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.823 | L2-Norm(final)=16.845 | 4599.7 samples/s | 71.9 steps/s
[Step=37550 Epoch=358.6] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=16.845 | 6964.8 samples/s | 108.8 steps/s
[Step=37600 Epoch=359.1] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.797 | L2-Norm(final)=16.845 | 1355.1 samples/s | 21.2 steps/s
[Step=37650 Epoch=359.5] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.784 | L2-Norm(final)=16.846 | 6627.9 samples/s | 103.6 steps/s
[Step=37700 Epoch=360.0] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.771 | L2-Norm(final)=16.846 | 1404.3 samples/s | 21.9 steps/s
[Step=37750 Epoch=360.5] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.757 | L2-Norm(final)=16.847 | 6037.6 samples/s | 94.3 steps/s
[Step=37800 Epoch=361.0] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.744 | L2-Norm(final)=16.847 | 1396.1 samples/s | 21.8 steps/s
[Step=37850 Epoch=361.4] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.731 | L2-Norm(final)=16.847 | 5640.6 samples/s | 88.1 steps/s
[Step=37900 Epoch=361.9] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.718 | L2-Norm(final)=16.848 | 1444.0 samples/s | 22.6 steps/s
[Step=37950 Epoch=362.4] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=16.848 | 5237.6 samples/s | 81.8 steps/s
[Step=38000 Epoch=362.9] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.692 | L2-Norm(final)=16.849 | 1485.5 samples/s | 23.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step38000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=207.3] | Loss=0.00076 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.091 | L2-Norm(final)=13.820 | 3078.5 samples/s | 48.1 steps/s
[Step=22050 Epoch=207.8] | Loss=0.00140 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=13.817 | 4475.8 samples/s | 69.9 steps/s
[Step=22100 Epoch=208.2] | Loss=0.00125 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=13.817 | 7803.6 samples/s | 121.9 steps/s
[Step=22150 Epoch=208.7] | Loss=0.00117 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=13.825 | 1436.6 samples/s | 22.4 steps/s
[Step=22200 Epoch=209.2] | Loss=0.00119 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=13.834 | 6981.2 samples/s | 109.1 steps/s
[Step=22250 Epoch=209.7] | Loss=0.00121 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.087 | L2-Norm(final)=13.845 | 1513.2 samples/s | 23.6 steps/s
[Step=22300 Epoch=210.1] | Loss=0.00117 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=13.857 | 6007.2 samples/s | 93.9 steps/s
[Step=22350 Epoch=210.6] | Loss=0.00111 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=13.871 | 1525.8 samples/s | 23.8 steps/s
[Step=22400 Epoch=211.1] | Loss=0.00112 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=13.884 | 5470.3 samples/s | 85.5 steps/s
[Step=22450 Epoch=211.5] | Loss=0.00112 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=13.898 | 1591.7 samples/s | 24.9 steps/s
[Step=22500 Epoch=212.0] | Loss=0.00109 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=13.912 | 5207.9 samples/s | 81.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=212.0] | Loss=0.00006 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=14.053 | 3141.9 samples/s | 49.1 steps/s
[Step=22550 Epoch=212.5] | Loss=0.00221 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.132 | L2-Norm(final)=14.053 | 4028.1 samples/s | 62.9 steps/s
[Step=22600 Epoch=213.0] | Loss=0.00159 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.177 | L2-Norm(final)=14.054 | 6424.2 samples/s | 100.4 steps/s
[Step=22650 Epoch=213.4] | Loss=0.00150 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=14.055 | 1401.6 samples/s | 21.9 steps/s
[Step=22700 Epoch=213.9] | Loss=0.00174 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=14.055 | 5647.7 samples/s | 88.2 steps/s
[Step=22750 Epoch=214.4] | Loss=0.00140 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.250 | L2-Norm(final)=14.055 | 1439.6 samples/s | 22.5 steps/s
[Step=22800 Epoch=214.8] | Loss=0.00117 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=14.055 | 5049.0 samples/s | 78.9 steps/s
[Step=22850 Epoch=215.3] | Loss=0.00105 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.266 | L2-Norm(final)=14.056 | 1471.1 samples/s | 23.0 steps/s
[Step=22900 Epoch=215.8] | Loss=0.00092 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.270 | L2-Norm(final)=14.056 | 4755.1 samples/s | 74.3 steps/s
[Step=22950 Epoch=216.3] | Loss=0.00082 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.273 | L2-Norm(final)=14.056 | 1479.4 samples/s | 23.1 steps/s
[Step=23000 Epoch=216.7] | Loss=0.00074 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.273 | L2-Norm(final)=14.057 | 4484.0 samples/s | 70.1 steps/s
[Step=23050 Epoch=217.2] | Loss=0.00067 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.272 | L2-Norm(final)=14.057 | 1526.3 samples/s | 23.8 steps/s
[Step=23100 Epoch=217.7] | Loss=0.00061 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.271 | L2-Norm(final)=14.058 | 4435.4 samples/s | 69.3 steps/s
[Step=23150 Epoch=218.1] | Loss=0.00057 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.269 | L2-Norm(final)=14.058 | 1562.3 samples/s | 24.4 steps/s
[Step=23200 Epoch=218.6] | Loss=0.00053 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.266 | L2-Norm(final)=14.058 | 4518.3 samples/s | 70.6 steps/s
[Step=23250 Epoch=219.1] | Loss=0.00049 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.263 | L2-Norm(final)=14.059 | 1582.2 samples/s | 24.7 steps/s
[Step=23300 Epoch=219.6] | Loss=0.00046 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=14.059 | 4078.6 samples/s | 63.7 steps/s
[Step=23350 Epoch=220.0] | Loss=0.00044 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.256 | L2-Norm(final)=14.059 | 6487.3 samples/s | 101.4 steps/s
[Step=23400 Epoch=220.5] | Loss=0.00041 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.252 | L2-Norm(final)=14.060 | 1393.4 samples/s | 21.8 steps/s
[Step=23450 Epoch=221.0] | Loss=0.00039 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.248 | L2-Norm(final)=14.060 | 5929.3 samples/s | 92.6 steps/s
[Step=23500 Epoch=221.4] | Loss=0.00037 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=14.060 | 1455.2 samples/s | 22.7 steps/s
[Step=23550 Epoch=221.9] | Loss=0.00035 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.239 | L2-Norm(final)=14.061 | 5229.6 samples/s | 81.7 steps/s
[Step=23600 Epoch=222.4] | Loss=0.00034 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=14.061 | 1445.3 samples/s | 22.6 steps/s
[Step=23650 Epoch=222.9] | Loss=0.00032 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.230 | L2-Norm(final)=14.062 | 4689.7 samples/s | 73.3 steps/s
[Step=23700 Epoch=223.3] | Loss=0.00031 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.225 | L2-Norm(final)=14.062 | 1474.1 samples/s | 23.0 steps/s
[Step=23750 Epoch=223.8] | Loss=0.00030 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.220 | L2-Norm(final)=14.062 | 4506.1 samples/s | 70.4 steps/s
[Step=23800 Epoch=224.3] | Loss=0.00029 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=14.063 | 1466.0 samples/s | 22.9 steps/s
[Step=23850 Epoch=224.7] | Loss=0.00028 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.210 | L2-Norm(final)=14.063 | 4429.2 samples/s | 69.2 steps/s
[Step=23900 Epoch=225.2] | Loss=0.00027 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=14.063 | 1485.0 samples/s | 23.2 steps/s
[Step=23950 Epoch=225.7] | Loss=0.00026 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.200 | L2-Norm(final)=14.064 | 4422.5 samples/s | 69.1 steps/s
[Step=24000 Epoch=226.1] | Loss=0.00025 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.195 | L2-Norm(final)=14.064 | 1528.7 samples/s | 23.9 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_3/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08840 | acc=0.9619 | tpr=0.9684 | fpr=0.0523 | 4656.2 samples/s | 18.2 steps/s
Avg test loss: 0.09361, Avg test acc: 0.95969, Avg tpr: 0.96666, Avg fpr: 0.05563, total FA: 434

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09131 | acc=0.9590 | tpr=0.9716 | fpr=0.0684 | 4360.4 samples/s | 17.0 steps/s
Avg test loss: 0.09315, Avg test acc: 0.95757, Avg tpr: 0.97068, Avg fpr: 0.07127, total FA: 556

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08991 | acc=0.9589 | tpr=0.9657 | fpr=0.0557 | 4820.6 samples/s | 18.8 steps/s
Avg test loss: 0.09468, Avg test acc: 0.95757, Avg tpr: 0.96433, Avg fpr: 0.05730, total FA: 447

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09226 | acc=0.9613 | tpr=0.9742 | fpr=0.0667 | 4818.4 samples/s | 18.8 steps/s
Avg test loss: 0.09629, Avg test acc: 0.96065, Avg tpr: 0.97366, Avg fpr: 0.06794, total FA: 530

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08467 | acc=0.9624 | tpr=0.9768 | fpr=0.0689 | 4637.9 samples/s | 18.1 steps/s
Avg test loss: 0.09050, Avg test acc: 0.96113, Avg tpr: 0.97535, Avg fpr: 0.07012, total FA: 547

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.45485 | acc=0.3002 | tpr=0.0116 | fpr=0.0733 | 4698.2 samples/s | 18.4 steps/s
Avg test loss: 5.47370, Avg test acc: 0.29838, Avg tpr: 0.01230, Avg fpr: 0.07243, total FA: 565

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.14846 | acc=0.2948 | tpr=0.0112 | fpr=0.0894 | 4582.2 samples/s | 17.9 steps/s
Avg test loss: 5.16440, Avg test acc: 0.29197, Avg tpr: 0.01154, Avg fpr: 0.09127, total FA: 712

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.73107 | acc=0.2903 | tpr=0.0155 | fpr=0.1130 | 4578.5 samples/s | 17.9 steps/s
Avg test loss: 4.74563, Avg test acc: 0.28828, Avg tpr: 0.01568, Avg fpr: 0.11217, total FA: 875

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.04252 | acc=0.3121 | tpr=0.0339 | fpr=0.0837 | 4463.6 samples/s | 17.4 steps/s
Avg test loss: 4.05955, Avg test acc: 0.30900, Avg tpr: 0.03392, Avg fpr: 0.08601, total FA: 671

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.81238 | acc=0.3084 | tpr=0.0137 | fpr=0.0515 | 4625.4 samples/s | 18.1 steps/s
Avg test loss: 5.83533, Avg test acc: 0.30639, Avg tpr: 0.01364, Avg fpr: 0.04974, total FA: 388

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.68209 | acc=0.1560 | tpr=0.7168 | fpr=0.8541 | 4510.5 samples/s | 17.6 steps/s
[Step= 100] | Loss=5.65860 | acc=0.1569 | tpr=0.6994 | fpr=0.8532 | 7964.4 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.66653 | acc=0.1582 | tpr=0.7118 | fpr=0.8520 | 7871.3 samples/s | 30.7 steps/s
[Step= 200] | Loss=5.65426 | acc=0.1582 | tpr=0.7137 | fpr=0.8519 | 7500.5 samples/s | 29.3 steps/s
[Step= 250] | Loss=5.64972 | acc=0.1587 | tpr=0.7039 | fpr=0.8513 | 8163.8 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.64121 | acc=0.1598 | tpr=0.7033 | fpr=0.8501 | 8455.0 samples/s | 33.0 steps/s
[Step= 350] | Loss=5.64821 | acc=0.1596 | tpr=0.7070 | fpr=0.8503 | 8136.5 samples/s | 31.8 steps/s
[Step= 400] | Loss=5.64876 | acc=0.1593 | tpr=0.7030 | fpr=0.8506 | 8058.9 samples/s | 31.5 steps/s
[Step= 450] | Loss=5.64559 | acc=0.1593 | tpr=0.7016 | fpr=0.8506 | 7145.6 samples/s | 27.9 steps/s
[Step= 500] | Loss=5.64620 | acc=0.1595 | tpr=0.6996 | fpr=0.8502 | 8122.2 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.64380 | acc=0.1598 | tpr=0.7031 | fpr=0.8501 | 11794.2 samples/s | 46.1 steps/s
Avg test loss: 5.64440, Avg test acc: 0.15968, Avg tpr: 0.70285, Avg fpr: 0.85020, total FA: 118048

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.52818 | acc=0.1401 | tpr=0.7743 | fpr=0.8713 | 4680.1 samples/s | 18.3 steps/s
[Step= 100] | Loss=5.51307 | acc=0.1418 | tpr=0.7463 | fpr=0.8694 | 7874.9 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.51594 | acc=0.1430 | tpr=0.7435 | fpr=0.8680 | 8039.8 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.50918 | acc=0.1431 | tpr=0.7377 | fpr=0.8677 | 8047.2 samples/s | 31.4 steps/s
[Step= 250] | Loss=5.50656 | acc=0.1441 | tpr=0.7380 | fpr=0.8667 | 7798.2 samples/s | 30.5 steps/s
[Step= 300] | Loss=5.50296 | acc=0.1445 | tpr=0.7367 | fpr=0.8663 | 7390.8 samples/s | 28.9 steps/s
[Step= 350] | Loss=5.51049 | acc=0.1441 | tpr=0.7383 | fpr=0.8667 | 7960.5 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.51389 | acc=0.1437 | tpr=0.7352 | fpr=0.8671 | 7475.9 samples/s | 29.2 steps/s
[Step= 450] | Loss=5.51191 | acc=0.1435 | tpr=0.7313 | fpr=0.8672 | 8069.3 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.51330 | acc=0.1435 | tpr=0.7273 | fpr=0.8670 | 8147.9 samples/s | 31.8 steps/s
[Step= 550] | Loss=5.51146 | acc=0.1437 | tpr=0.7322 | fpr=0.8670 | 10845.9 samples/s | 42.4 steps/s
Avg test loss: 5.51281, Avg test acc: 0.14361, Avg tpr: 0.73177, Avg fpr: 0.86708, total FA: 120393

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.82655 | acc=0.1394 | tpr=0.7699 | fpr=0.8720 | 4797.7 samples/s | 18.7 steps/s
[Step= 100] | Loss=5.79581 | acc=0.1418 | tpr=0.7463 | fpr=0.8694 | 7401.7 samples/s | 28.9 steps/s
[Step= 150] | Loss=5.79780 | acc=0.1430 | tpr=0.7493 | fpr=0.8681 | 8174.5 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.78277 | acc=0.1435 | tpr=0.7475 | fpr=0.8675 | 7877.9 samples/s | 30.8 steps/s
[Step= 250] | Loss=5.77674 | acc=0.1442 | tpr=0.7476 | fpr=0.8668 | 7762.4 samples/s | 30.3 steps/s
[Step= 300] | Loss=5.77122 | acc=0.1444 | tpr=0.7462 | fpr=0.8665 | 7712.7 samples/s | 30.1 steps/s
[Step= 350] | Loss=5.78157 | acc=0.1441 | tpr=0.7451 | fpr=0.8668 | 7373.9 samples/s | 28.8 steps/s
[Step= 400] | Loss=5.78380 | acc=0.1437 | tpr=0.7402 | fpr=0.8671 | 8152.0 samples/s | 31.8 steps/s
[Step= 450] | Loss=5.78007 | acc=0.1441 | tpr=0.7376 | fpr=0.8667 | 8040.7 samples/s | 31.4 steps/s
[Step= 500] | Loss=5.77920 | acc=0.1443 | tpr=0.7366 | fpr=0.8663 | 7211.4 samples/s | 28.2 steps/s
[Step= 550] | Loss=5.77760 | acc=0.1446 | tpr=0.7398 | fpr=0.8662 | 12953.1 samples/s | 50.6 steps/s
Avg test loss: 5.77843, Avg test acc: 0.14446, Avg tpr: 0.73930, Avg fpr: 0.86636, total FA: 120292

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.07357 | acc=0.1488 | tpr=0.7788 | fpr=0.8625 | 4684.7 samples/s | 18.3 steps/s
[Step= 100] | Loss=6.05390 | acc=0.1494 | tpr=0.7569 | fpr=0.8619 | 8183.6 samples/s | 32.0 steps/s
[Step= 150] | Loss=6.05943 | acc=0.1513 | tpr=0.7536 | fpr=0.8598 | 8318.9 samples/s | 32.5 steps/s
[Step= 200] | Loss=6.05009 | acc=0.1512 | tpr=0.7443 | fpr=0.8596 | 7268.6 samples/s | 28.4 steps/s
[Step= 250] | Loss=6.04738 | acc=0.1515 | tpr=0.7362 | fpr=0.8591 | 8170.8 samples/s | 31.9 steps/s
[Step= 300] | Loss=6.04367 | acc=0.1519 | tpr=0.7389 | fpr=0.8588 | 7824.5 samples/s | 30.6 steps/s
[Step= 350] | Loss=6.05462 | acc=0.1514 | tpr=0.7433 | fpr=0.8593 | 8027.4 samples/s | 31.4 steps/s
[Step= 400] | Loss=6.05465 | acc=0.1511 | tpr=0.7412 | fpr=0.8596 | 8249.0 samples/s | 32.2 steps/s
[Step= 450] | Loss=6.05234 | acc=0.1510 | tpr=0.7386 | fpr=0.8596 | 7909.9 samples/s | 30.9 steps/s
[Step= 500] | Loss=6.05390 | acc=0.1510 | tpr=0.7392 | fpr=0.8596 | 7587.5 samples/s | 29.6 steps/s
[Step= 550] | Loss=6.05337 | acc=0.1511 | tpr=0.7398 | fpr=0.8596 | 9859.7 samples/s | 38.5 steps/s
Avg test loss: 6.05468, Avg test acc: 0.15098, Avg tpr: 0.73930, Avg fpr: 0.85971, total FA: 119369

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.15358 | acc=0.1268 | tpr=0.7965 | fpr=0.8852 | 4849.8 samples/s | 18.9 steps/s
[Step= 100] | Loss=6.12784 | acc=0.1286 | tpr=0.7804 | fpr=0.8836 | 7022.6 samples/s | 27.4 steps/s
[Step= 150] | Loss=6.13440 | acc=0.1292 | tpr=0.7781 | fpr=0.8828 | 7721.4 samples/s | 30.2 steps/s
[Step= 200] | Loss=6.12742 | acc=0.1287 | tpr=0.7683 | fpr=0.8829 | 7867.5 samples/s | 30.7 steps/s
[Step= 250] | Loss=6.12634 | acc=0.1295 | tpr=0.7651 | fpr=0.8821 | 8045.8 samples/s | 31.4 steps/s
[Step= 300] | Loss=6.11913 | acc=0.1300 | tpr=0.7651 | fpr=0.8816 | 6767.8 samples/s | 26.4 steps/s
[Step= 350] | Loss=6.12686 | acc=0.1296 | tpr=0.7696 | fpr=0.8820 | 8509.6 samples/s | 33.2 steps/s
[Step= 400] | Loss=6.12883 | acc=0.1292 | tpr=0.7642 | fpr=0.8823 | 8111.7 samples/s | 31.7 steps/s
[Step= 450] | Loss=6.12575 | acc=0.1293 | tpr=0.7624 | fpr=0.8822 | 8180.7 samples/s | 32.0 steps/s
[Step= 500] | Loss=6.12891 | acc=0.1294 | tpr=0.7621 | fpr=0.8820 | 8137.9 samples/s | 31.8 steps/s
[Step= 550] | Loss=6.12820 | acc=0.1298 | tpr=0.7628 | fpr=0.8817 | 11533.1 samples/s | 45.1 steps/s
Avg test loss: 6.12955, Avg test acc: 0.12973, Avg tpr: 0.76268, Avg fpr: 0.88178, total FA: 122433

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.16666 | acc=0.9659 | tpr=0.9248 | fpr=0.0334 | 4665.3 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.17238 | acc=0.9650 | tpr=0.9254 | fpr=0.0343 | 7989.5 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.17798 | acc=0.9639 | tpr=0.9251 | fpr=0.0354 | 7953.0 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.17761 | acc=0.9644 | tpr=0.9290 | fpr=0.0349 | 7395.4 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.17850 | acc=0.9644 | tpr=0.9301 | fpr=0.0350 | 8444.3 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.18041 | acc=0.9639 | tpr=0.9287 | fpr=0.0355 | 8667.7 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.18169 | acc=0.9636 | tpr=0.9280 | fpr=0.0358 | 7536.1 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.18339 | acc=0.9632 | tpr=0.9245 | fpr=0.0361 | 7525.2 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.18559 | acc=0.9630 | tpr=0.9231 | fpr=0.0363 | 8681.2 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.18519 | acc=0.9629 | tpr=0.9225 | fpr=0.0364 | 8237.0 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.18504 | acc=0.9630 | tpr=0.9208 | fpr=0.0362 | 8989.1 samples/s | 35.1 steps/s
Avg test loss: 0.18482, Avg test acc: 0.96306, Avg tpr: 0.92076, Avg fpr: 0.03617, total FA: 5022

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15296 | acc=0.9629 | tpr=0.9159 | fpr=0.0363 | 4474.0 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.15954 | acc=0.9616 | tpr=0.9168 | fpr=0.0375 | 8093.4 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.16312 | acc=0.9611 | tpr=0.9222 | fpr=0.0381 | 8196.7 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.16388 | acc=0.9611 | tpr=0.9246 | fpr=0.0382 | 8297.8 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.16510 | acc=0.9610 | tpr=0.9258 | fpr=0.0383 | 7969.7 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.16569 | acc=0.9609 | tpr=0.9258 | fpr=0.0385 | 8049.7 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.16586 | acc=0.9608 | tpr=0.9274 | fpr=0.0386 | 7379.6 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.16783 | acc=0.9604 | tpr=0.9272 | fpr=0.0390 | 7548.1 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.16825 | acc=0.9603 | tpr=0.9250 | fpr=0.0391 | 8115.2 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.16812 | acc=0.9603 | tpr=0.9273 | fpr=0.0391 | 8684.9 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.16783 | acc=0.9604 | tpr=0.9260 | fpr=0.0390 | 10410.9 samples/s | 40.7 steps/s
Avg test loss: 0.16758, Avg test acc: 0.96045, Avg tpr: 0.92631, Avg fpr: 0.03893, total FA: 5405

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.25567 | acc=0.9550 | tpr=0.9469 | fpr=0.0449 | 4405.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.26262 | acc=0.9544 | tpr=0.9531 | fpr=0.0456 | 8283.2 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.27100 | acc=0.9532 | tpr=0.9539 | fpr=0.0468 | 8383.6 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.27229 | acc=0.9532 | tpr=0.9585 | fpr=0.0469 | 7939.0 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.27375 | acc=0.9530 | tpr=0.9616 | fpr=0.0472 | 7776.9 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.27601 | acc=0.9525 | tpr=0.9607 | fpr=0.0476 | 7837.3 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.27614 | acc=0.9524 | tpr=0.9599 | fpr=0.0477 | 7891.6 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.27808 | acc=0.9520 | tpr=0.9573 | fpr=0.0481 | 8652.5 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.27962 | acc=0.9516 | tpr=0.9552 | fpr=0.0484 | 8064.0 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.27952 | acc=0.9514 | tpr=0.9551 | fpr=0.0486 | 7231.2 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.27887 | acc=0.9515 | tpr=0.9526 | fpr=0.0485 | 11322.7 samples/s | 44.2 steps/s
Avg test loss: 0.27846, Avg test acc: 0.95160, Avg tpr: 0.95285, Avg fpr: 0.04843, total FA: 6724

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.13034 | acc=0.9675 | tpr=0.9292 | fpr=0.0318 | 4603.8 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.13489 | acc=0.9671 | tpr=0.9254 | fpr=0.0321 | 8325.2 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.13832 | acc=0.9667 | tpr=0.9280 | fpr=0.0326 | 7830.9 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.13844 | acc=0.9674 | tpr=0.9366 | fpr=0.0321 | 8001.9 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.13973 | acc=0.9671 | tpr=0.9406 | fpr=0.0324 | 7571.1 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.14174 | acc=0.9666 | tpr=0.9367 | fpr=0.0329 | 8119.7 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.14268 | acc=0.9665 | tpr=0.9374 | fpr=0.0330 | 7561.0 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.14394 | acc=0.9662 | tpr=0.9322 | fpr=0.0332 | 8026.8 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.14541 | acc=0.9659 | tpr=0.9304 | fpr=0.0335 | 8219.6 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.14428 | acc=0.9660 | tpr=0.9322 | fpr=0.0333 | 7854.5 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.14398 | acc=0.9662 | tpr=0.9304 | fpr=0.0332 | 10983.6 samples/s | 42.9 steps/s
Avg test loss: 0.14362, Avg test acc: 0.96622, Avg tpr: 0.92987, Avg fpr: 0.03312, total FA: 4599

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.18736 | acc=0.9605 | tpr=0.8894 | fpr=0.0383 | 4673.1 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.19268 | acc=0.9601 | tpr=0.9062 | fpr=0.0389 | 8060.0 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.19630 | acc=0.9596 | tpr=0.9121 | fpr=0.0395 | 7727.1 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.19675 | acc=0.9596 | tpr=0.9191 | fpr=0.0396 | 8309.3 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.19777 | acc=0.9594 | tpr=0.9179 | fpr=0.0398 | 7372.0 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.19893 | acc=0.9592 | tpr=0.9149 | fpr=0.0400 | 8103.4 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.19950 | acc=0.9592 | tpr=0.9142 | fpr=0.0400 | 8132.2 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.20084 | acc=0.9590 | tpr=0.9125 | fpr=0.0402 | 7919.6 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.20194 | acc=0.9586 | tpr=0.9119 | fpr=0.0405 | 8064.6 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.20177 | acc=0.9586 | tpr=0.9119 | fpr=0.0406 | 7930.4 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.20098 | acc=0.9587 | tpr=0.9125 | fpr=0.0405 | 10296.6 samples/s | 40.2 steps/s
Avg test loss: 0.20065, Avg test acc: 0.95870, Avg tpr: 0.91244, Avg fpr: 0.04045, total FA: 5617

server round 30/50

clients selected: [0 3 5 6 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=42001 Epoch=204.8] | Loss=0.02921 | Reg=0.00121 | acc=0.9688 | L2-Norm=11.018 | L2-Norm(final)=13.883 | 3152.2 samples/s | 49.3 steps/s
[Step=42050 Epoch=205.0] | Loss=0.02121 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.018 | L2-Norm(final)=13.883 | 5104.1 samples/s | 79.8 steps/s
[Step=42100 Epoch=205.3] | Loss=0.02097 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=13.884 | 5321.1 samples/s | 83.1 steps/s
[Step=42150 Epoch=205.5] | Loss=0.02175 | Reg=0.00121 | acc=0.9531 | L2-Norm=11.019 | L2-Norm(final)=13.884 | 5487.3 samples/s | 85.7 steps/s
[Step=42200 Epoch=205.8] | Loss=0.02224 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=13.883 | 8494.1 samples/s | 132.7 steps/s
[Step=42250 Epoch=206.0] | Loss=0.02231 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=13.883 | 1474.0 samples/s | 23.0 steps/s
[Step=42300 Epoch=206.3] | Loss=0.02157 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.019 | L2-Norm(final)=13.884 | 5597.6 samples/s | 87.5 steps/s
[Step=42350 Epoch=206.5] | Loss=0.02179 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=13.884 | 5462.8 samples/s | 85.4 steps/s
[Step=42400 Epoch=206.8] | Loss=0.02251 | Reg=0.00121 | acc=0.9688 | L2-Norm=11.019 | L2-Norm(final)=13.885 | 7487.6 samples/s | 117.0 steps/s
[Step=42450 Epoch=207.0] | Loss=0.02233 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=13.885 | 1512.3 samples/s | 23.6 steps/s
[Step=42500 Epoch=207.2] | Loss=0.02199 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=13.885 | 5468.4 samples/s | 85.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=42501 Epoch=207.2] | Loss=0.02565 | Reg=0.00121 | acc=0.9688 | L2-Norm=11.019 | L2-Norm(final)=13.890 | 3188.7 samples/s | 49.8 steps/s
[Step=42550 Epoch=207.5] | Loss=0.01663 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.030 | L2-Norm(final)=13.891 | 4236.4 samples/s | 66.2 steps/s
[Step=42600 Epoch=207.7] | Loss=0.01855 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.042 | L2-Norm(final)=13.892 | 4718.0 samples/s | 73.7 steps/s
[Step=42650 Epoch=208.0] | Loss=0.01794 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.051 | L2-Norm(final)=13.893 | 4688.5 samples/s | 73.3 steps/s
[Step=42700 Epoch=208.2] | Loss=0.01723 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.058 | L2-Norm(final)=13.893 | 6786.5 samples/s | 106.0 steps/s
[Step=42750 Epoch=208.5] | Loss=0.01498 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.065 | L2-Norm(final)=13.895 | 1431.9 samples/s | 22.4 steps/s
[Step=42800 Epoch=208.7] | Loss=0.01350 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.072 | L2-Norm(final)=13.898 | 4655.3 samples/s | 72.7 steps/s
[Step=42850 Epoch=208.9] | Loss=0.01252 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.078 | L2-Norm(final)=13.901 | 4739.5 samples/s | 74.1 steps/s
[Step=42900 Epoch=209.2] | Loss=0.01172 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.083 | L2-Norm(final)=13.904 | 6101.4 samples/s | 95.3 steps/s
[Step=42950 Epoch=209.4] | Loss=0.01094 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=13.907 | 1445.4 samples/s | 22.6 steps/s
[Step=43000 Epoch=209.7] | Loss=0.01027 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.092 | L2-Norm(final)=13.910 | 4622.6 samples/s | 72.2 steps/s
[Step=43050 Epoch=209.9] | Loss=0.00966 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.096 | L2-Norm(final)=13.912 | 4678.5 samples/s | 73.1 steps/s
[Step=43100 Epoch=210.2] | Loss=0.00931 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.100 | L2-Norm(final)=13.915 | 5640.9 samples/s | 88.1 steps/s
[Step=43150 Epoch=210.4] | Loss=0.00893 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.103 | L2-Norm(final)=13.918 | 1499.4 samples/s | 23.4 steps/s
[Step=43200 Epoch=210.7] | Loss=0.00869 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.107 | L2-Norm(final)=13.921 | 4691.5 samples/s | 73.3 steps/s
[Step=43250 Epoch=210.9] | Loss=0.00842 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.110 | L2-Norm(final)=13.923 | 4692.1 samples/s | 73.3 steps/s
[Step=43300 Epoch=211.1] | Loss=0.00818 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.113 | L2-Norm(final)=13.926 | 5212.7 samples/s | 81.4 steps/s
[Step=43350 Epoch=211.4] | Loss=0.00781 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.116 | L2-Norm(final)=13.929 | 1520.0 samples/s | 23.7 steps/s
[Step=43400 Epoch=211.6] | Loss=0.00755 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.119 | L2-Norm(final)=13.931 | 4686.7 samples/s | 73.2 steps/s
[Step=43450 Epoch=211.9] | Loss=0.00730 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.122 | L2-Norm(final)=13.934 | 4706.5 samples/s | 73.5 steps/s
[Step=43500 Epoch=212.1] | Loss=0.00712 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.125 | L2-Norm(final)=13.936 | 4819.0 samples/s | 75.3 steps/s
[Step=43550 Epoch=212.4] | Loss=0.00703 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.127 | L2-Norm(final)=13.939 | 1571.0 samples/s | 24.5 steps/s
[Step=43600 Epoch=212.6] | Loss=0.00689 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.130 | L2-Norm(final)=13.941 | 4749.2 samples/s | 74.2 steps/s
[Step=43650 Epoch=212.8] | Loss=0.00676 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.132 | L2-Norm(final)=13.943 | 4647.6 samples/s | 72.6 steps/s
[Step=43700 Epoch=213.1] | Loss=0.00659 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.134 | L2-Norm(final)=13.946 | 4734.8 samples/s | 74.0 steps/s
[Step=43750 Epoch=213.3] | Loss=0.00644 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.137 | L2-Norm(final)=13.948 | 1559.1 samples/s | 24.4 steps/s
[Step=43800 Epoch=213.6] | Loss=0.00630 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.139 | L2-Norm(final)=13.950 | 4711.0 samples/s | 73.6 steps/s
[Step=43850 Epoch=213.8] | Loss=0.00618 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.141 | L2-Norm(final)=13.952 | 4712.2 samples/s | 73.6 steps/s
[Step=43900 Epoch=214.1] | Loss=0.00615 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.143 | L2-Norm(final)=13.954 | 4646.1 samples/s | 72.6 steps/s
[Step=43950 Epoch=214.3] | Loss=0.00603 | Reg=0.00124 | acc=0.9688 | L2-Norm=11.145 | L2-Norm(final)=13.956 | 1572.0 samples/s | 24.6 steps/s
[Step=44000 Epoch=214.6] | Loss=0.00593 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.147 | L2-Norm(final)=13.958 | 4715.7 samples/s | 73.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step44000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=165.8] | Loss=0.00314 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.018 | L2-Norm(final)=14.731 | 3159.9 samples/s | 49.4 steps/s
[Step=34050 Epoch=166.0] | Loss=0.02052 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=14.729 | 4930.9 samples/s | 77.0 steps/s
[Step=34100 Epoch=166.3] | Loss=0.02046 | Reg=0.00121 | acc=0.9688 | L2-Norm=11.019 | L2-Norm(final)=14.728 | 5379.5 samples/s | 84.1 steps/s
[Step=34150 Epoch=166.5] | Loss=0.01994 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.019 | L2-Norm(final)=14.728 | 5528.8 samples/s | 86.4 steps/s
[Step=34200 Epoch=166.8] | Loss=0.01952 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.019 | L2-Norm(final)=14.728 | 8509.1 samples/s | 133.0 steps/s
[Step=34250 Epoch=167.0] | Loss=0.01924 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.019 | L2-Norm(final)=14.728 | 1497.5 samples/s | 23.4 steps/s
[Step=34300 Epoch=167.3] | Loss=0.01977 | Reg=0.00121 | acc=0.9688 | L2-Norm=11.019 | L2-Norm(final)=14.728 | 5321.5 samples/s | 83.1 steps/s
[Step=34350 Epoch=167.5] | Loss=0.01976 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.019 | L2-Norm(final)=14.727 | 5502.0 samples/s | 86.0 steps/s
[Step=34400 Epoch=167.8] | Loss=0.01959 | Reg=0.00121 | acc=0.9688 | L2-Norm=11.019 | L2-Norm(final)=14.727 | 7582.2 samples/s | 118.5 steps/s
[Step=34450 Epoch=168.0] | Loss=0.01975 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=14.727 | 1508.6 samples/s | 23.6 steps/s
[Step=34500 Epoch=168.2] | Loss=0.01931 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=14.727 | 5550.5 samples/s | 86.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=168.2] | Loss=0.01217 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.019 | L2-Norm(final)=14.729 | 3044.6 samples/s | 47.6 steps/s
[Step=34550 Epoch=168.5] | Loss=0.02010 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.028 | L2-Norm(final)=14.729 | 4517.4 samples/s | 70.6 steps/s
[Step=34600 Epoch=168.7] | Loss=0.01673 | Reg=0.00122 | acc=0.9688 | L2-Norm=11.039 | L2-Norm(final)=14.729 | 4695.1 samples/s | 73.4 steps/s
[Step=34650 Epoch=169.0] | Loss=0.01643 | Reg=0.00122 | acc=0.9688 | L2-Norm=11.048 | L2-Norm(final)=14.731 | 4790.4 samples/s | 74.9 steps/s
[Step=34700 Epoch=169.2] | Loss=0.01459 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.055 | L2-Norm(final)=14.733 | 6611.4 samples/s | 103.3 steps/s
[Step=34750 Epoch=169.5] | Loss=0.01299 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.062 | L2-Norm(final)=14.736 | 1404.6 samples/s | 21.9 steps/s
[Step=34800 Epoch=169.7] | Loss=0.01163 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.067 | L2-Norm(final)=14.740 | 4699.1 samples/s | 73.4 steps/s
[Step=34850 Epoch=169.9] | Loss=0.01069 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.072 | L2-Norm(final)=14.743 | 4660.4 samples/s | 72.8 steps/s
[Step=34900 Epoch=170.2] | Loss=0.01001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.077 | L2-Norm(final)=14.747 | 6154.0 samples/s | 96.2 steps/s
[Step=34950 Epoch=170.4] | Loss=0.00928 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.081 | L2-Norm(final)=14.750 | 1447.3 samples/s | 22.6 steps/s
[Step=35000 Epoch=170.7] | Loss=0.00884 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.085 | L2-Norm(final)=14.753 | 4689.5 samples/s | 73.3 steps/s
[Step=35050 Epoch=170.9] | Loss=0.00850 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=14.756 | 4683.9 samples/s | 73.2 steps/s
[Step=35100 Epoch=171.2] | Loss=0.00813 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.092 | L2-Norm(final)=14.759 | 5655.7 samples/s | 88.4 steps/s
[Step=35150 Epoch=171.4] | Loss=0.00770 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=14.762 | 1512.9 samples/s | 23.6 steps/s
[Step=35200 Epoch=171.7] | Loss=0.00738 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.098 | L2-Norm(final)=14.765 | 4571.5 samples/s | 71.4 steps/s
[Step=35250 Epoch=171.9] | Loss=0.00710 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.101 | L2-Norm(final)=14.768 | 4699.4 samples/s | 73.4 steps/s
[Step=35300 Epoch=172.1] | Loss=0.00681 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.104 | L2-Norm(final)=14.771 | 5207.8 samples/s | 81.4 steps/s
[Step=35350 Epoch=172.4] | Loss=0.00662 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.107 | L2-Norm(final)=14.774 | 1506.9 samples/s | 23.5 steps/s
[Step=35400 Epoch=172.6] | Loss=0.00640 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.109 | L2-Norm(final)=14.776 | 4689.6 samples/s | 73.3 steps/s
[Step=35450 Epoch=172.9] | Loss=0.00620 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.112 | L2-Norm(final)=14.779 | 4655.1 samples/s | 72.7 steps/s
[Step=35500 Epoch=173.1] | Loss=0.00600 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.114 | L2-Norm(final)=14.781 | 4841.2 samples/s | 75.6 steps/s
[Step=35550 Epoch=173.4] | Loss=0.00588 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.116 | L2-Norm(final)=14.784 | 1525.4 samples/s | 23.8 steps/s
[Step=35600 Epoch=173.6] | Loss=0.00571 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.118 | L2-Norm(final)=14.786 | 4710.8 samples/s | 73.6 steps/s
[Step=35650 Epoch=173.8] | Loss=0.00557 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.121 | L2-Norm(final)=14.789 | 4679.6 samples/s | 73.1 steps/s
[Step=35700 Epoch=174.1] | Loss=0.00543 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.123 | L2-Norm(final)=14.791 | 4689.4 samples/s | 73.3 steps/s
[Step=35750 Epoch=174.3] | Loss=0.00536 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.125 | L2-Norm(final)=14.794 | 1551.7 samples/s | 24.2 steps/s
[Step=35800 Epoch=174.6] | Loss=0.00529 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.127 | L2-Norm(final)=14.796 | 4642.6 samples/s | 72.5 steps/s
[Step=35850 Epoch=174.8] | Loss=0.00516 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.128 | L2-Norm(final)=14.798 | 4694.8 samples/s | 73.4 steps/s
[Step=35900 Epoch=175.1] | Loss=0.00511 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.130 | L2-Norm(final)=14.800 | 4693.7 samples/s | 73.3 steps/s
[Step=35950 Epoch=175.3] | Loss=0.00501 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.132 | L2-Norm(final)=14.803 | 1601.6 samples/s | 25.0 steps/s
[Step=36000 Epoch=175.6] | Loss=0.00498 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.134 | L2-Norm(final)=14.805 | 4716.4 samples/s | 73.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step36000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=322.2] | Loss=0.00013 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.018 | L2-Norm(final)=17.529 | 2981.0 samples/s | 46.6 steps/s
[Step=34050 Epoch=322.7] | Loss=0.00030 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=17.530 | 4887.9 samples/s | 76.4 steps/s
[Step=34100 Epoch=323.1] | Loss=0.00031 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=17.533 | 7806.2 samples/s | 122.0 steps/s
[Step=34150 Epoch=323.6] | Loss=0.00031 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=17.534 | 1428.1 samples/s | 22.3 steps/s
[Step=34200 Epoch=324.1] | Loss=0.00030 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=17.535 | 7267.1 samples/s | 113.5 steps/s
[Step=34250 Epoch=324.5] | Loss=0.00030 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=17.537 | 1498.0 samples/s | 23.4 steps/s
[Step=34300 Epoch=325.0] | Loss=0.00031 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=17.540 | 6409.2 samples/s | 100.1 steps/s
[Step=34350 Epoch=325.5] | Loss=0.00031 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=17.543 | 1459.1 samples/s | 22.8 steps/s
[Step=34400 Epoch=326.0] | Loss=0.00030 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=17.545 | 5877.7 samples/s | 91.8 steps/s
[Step=34450 Epoch=326.4] | Loss=0.00030 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=17.548 | 1571.9 samples/s | 24.6 steps/s
[Step=34500 Epoch=326.9] | Loss=0.00030 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=17.551 | 5275.8 samples/s | 82.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=326.9] | Loss=0.00038 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=17.583 | 3317.5 samples/s | 51.8 steps/s
[Step=34550 Epoch=327.4] | Loss=0.00012 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.014 | L2-Norm(final)=17.585 | 3760.3 samples/s | 58.8 steps/s
[Step=34600 Epoch=327.9] | Loss=0.00009 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.010 | L2-Norm(final)=17.588 | 6545.2 samples/s | 102.3 steps/s
[Step=34650 Epoch=328.3] | Loss=0.00007 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.005 | L2-Norm(final)=17.590 | 1417.7 samples/s | 22.2 steps/s
[Step=34700 Epoch=328.8] | Loss=0.00005 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.999 | L2-Norm(final)=17.591 | 5801.5 samples/s | 90.6 steps/s
[Step=34750 Epoch=329.3] | Loss=0.00004 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.993 | L2-Norm(final)=17.592 | 1417.4 samples/s | 22.1 steps/s
[Step=34800 Epoch=329.8] | Loss=0.00004 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.986 | L2-Norm(final)=17.593 | 5356.5 samples/s | 83.7 steps/s
[Step=34850 Epoch=330.2] | Loss=0.00003 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.979 | L2-Norm(final)=17.594 | 1439.1 samples/s | 22.5 steps/s
[Step=34900 Epoch=330.7] | Loss=0.00003 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.972 | L2-Norm(final)=17.595 | 4920.7 samples/s | 76.9 steps/s
[Step=34950 Epoch=331.2] | Loss=0.00003 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.965 | L2-Norm(final)=17.595 | 1464.8 samples/s | 22.9 steps/s
[Step=35000 Epoch=331.7] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=17.596 | 4593.7 samples/s | 71.8 steps/s
[Step=35050 Epoch=332.1] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.950 | L2-Norm(final)=17.596 | 1508.3 samples/s | 23.6 steps/s
[Step=35100 Epoch=332.6] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.943 | L2-Norm(final)=17.597 | 4563.3 samples/s | 71.3 steps/s
[Step=35150 Epoch=333.1] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.936 | L2-Norm(final)=17.597 | 1529.9 samples/s | 23.9 steps/s
[Step=35200 Epoch=333.6] | Loss=0.00002 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.928 | L2-Norm(final)=17.598 | 4450.0 samples/s | 69.5 steps/s
[Step=35250 Epoch=334.0] | Loss=0.00002 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.921 | L2-Norm(final)=17.598 | 1539.0 samples/s | 24.0 steps/s
[Step=35300 Epoch=334.5] | Loss=0.00002 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.914 | L2-Norm(final)=17.599 | 4497.0 samples/s | 70.3 steps/s
[Step=35350 Epoch=335.0] | Loss=0.00002 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.906 | L2-Norm(final)=17.599 | 1563.1 samples/s | 24.4 steps/s
[Step=35400 Epoch=335.4] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.899 | L2-Norm(final)=17.600 | 4185.1 samples/s | 65.4 steps/s
[Step=35450 Epoch=335.9] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.891 | L2-Norm(final)=17.600 | 6785.8 samples/s | 106.0 steps/s
[Step=35500 Epoch=336.4] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.884 | L2-Norm(final)=17.600 | 1399.3 samples/s | 21.9 steps/s
[Step=35550 Epoch=336.9] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.876 | L2-Norm(final)=17.601 | 5863.4 samples/s | 91.6 steps/s
[Step=35600 Epoch=337.3] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.869 | L2-Norm(final)=17.601 | 1410.6 samples/s | 22.0 steps/s
[Step=35650 Epoch=337.8] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.861 | L2-Norm(final)=17.602 | 5395.0 samples/s | 84.3 steps/s
[Step=35700 Epoch=338.3] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.853 | L2-Norm(final)=17.602 | 1433.6 samples/s | 22.4 steps/s
[Step=35750 Epoch=338.8] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.845 | L2-Norm(final)=17.603 | 5055.0 samples/s | 79.0 steps/s
[Step=35800 Epoch=339.2] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.838 | L2-Norm(final)=17.603 | 1482.3 samples/s | 23.2 steps/s
[Step=35850 Epoch=339.7] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.830 | L2-Norm(final)=17.603 | 4657.4 samples/s | 72.8 steps/s
[Step=35900 Epoch=340.2] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.822 | L2-Norm(final)=17.604 | 1512.2 samples/s | 23.6 steps/s
[Step=35950 Epoch=340.7] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.814 | L2-Norm(final)=17.604 | 4466.8 samples/s | 69.8 steps/s
[Step=36000 Epoch=341.1] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.806 | L2-Norm(final)=17.605 | 1522.3 samples/s | 23.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_0/client_state-step36000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=304.4] | Loss=0.00023 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.018 | L2-Norm(final)=14.069 | 3248.0 samples/s | 50.8 steps/s
[Step=32050 Epoch=304.9] | Loss=0.00118 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=14.074 | 4343.8 samples/s | 67.9 steps/s
[Step=32100 Epoch=305.4] | Loss=0.00095 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=14.077 | 8169.6 samples/s | 127.7 steps/s
[Step=32150 Epoch=305.8] | Loss=0.00099 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=14.080 | 1456.5 samples/s | 22.8 steps/s
[Step=32200 Epoch=306.3] | Loss=0.00094 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=14.084 | 7229.4 samples/s | 113.0 steps/s
[Step=32250 Epoch=306.8] | Loss=0.00090 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=14.087 | 1471.7 samples/s | 23.0 steps/s
[Step=32300 Epoch=307.3] | Loss=0.00094 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=14.089 | 6505.5 samples/s | 101.6 steps/s
[Step=32350 Epoch=307.7] | Loss=0.00096 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=14.092 | 1544.1 samples/s | 24.1 steps/s
[Step=32400 Epoch=308.2] | Loss=0.00091 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=14.094 | 5794.4 samples/s | 90.5 steps/s
[Step=32450 Epoch=308.7] | Loss=0.00088 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=14.097 | 1538.8 samples/s | 24.0 steps/s
[Step=32500 Epoch=309.2] | Loss=0.00082 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=14.099 | 5326.5 samples/s | 83.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=309.2] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=14.122 | 3106.4 samples/s | 48.5 steps/s
[Step=32550 Epoch=309.6] | Loss=0.00097 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.019 | L2-Norm(final)=14.124 | 4081.5 samples/s | 63.8 steps/s
[Step=32600 Epoch=310.1] | Loss=0.00064 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.027 | L2-Norm(final)=14.127 | 6549.2 samples/s | 102.3 steps/s
[Step=32650 Epoch=310.6] | Loss=0.00044 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.028 | L2-Norm(final)=14.129 | 1375.4 samples/s | 21.5 steps/s
[Step=32700 Epoch=311.1] | Loss=0.00033 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.026 | L2-Norm(final)=14.130 | 5928.9 samples/s | 92.6 steps/s
[Step=32750 Epoch=311.5] | Loss=0.00027 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=14.132 | 1413.4 samples/s | 22.1 steps/s
[Step=32800 Epoch=312.0] | Loss=0.00023 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.018 | L2-Norm(final)=14.132 | 5324.3 samples/s | 83.2 steps/s
[Step=32850 Epoch=312.5] | Loss=0.00020 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.014 | L2-Norm(final)=14.133 | 1459.1 samples/s | 22.8 steps/s
[Step=32900 Epoch=313.0] | Loss=0.00017 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.009 | L2-Norm(final)=14.134 | 4968.4 samples/s | 77.6 steps/s
[Step=32950 Epoch=313.4] | Loss=0.00015 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.004 | L2-Norm(final)=14.135 | 1466.9 samples/s | 22.9 steps/s
[Step=33000 Epoch=313.9] | Loss=0.00014 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.999 | L2-Norm(final)=14.135 | 4618.0 samples/s | 72.2 steps/s
[Step=33050 Epoch=314.4] | Loss=0.00013 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.994 | L2-Norm(final)=14.136 | 1518.3 samples/s | 23.7 steps/s
[Step=33100 Epoch=314.9] | Loss=0.00012 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.989 | L2-Norm(final)=14.136 | 4445.1 samples/s | 69.5 steps/s
[Step=33150 Epoch=315.3] | Loss=0.00011 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.984 | L2-Norm(final)=14.137 | 1551.3 samples/s | 24.2 steps/s
[Step=33200 Epoch=315.8] | Loss=0.00010 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.978 | L2-Norm(final)=14.137 | 4463.0 samples/s | 69.7 steps/s
[Step=33250 Epoch=316.3] | Loss=0.00009 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.973 | L2-Norm(final)=14.138 | 1527.3 samples/s | 23.9 steps/s
[Step=33300 Epoch=316.8] | Loss=0.00009 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.967 | L2-Norm(final)=14.138 | 4462.6 samples/s | 69.7 steps/s
[Step=33350 Epoch=317.2] | Loss=0.00008 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=14.138 | 1561.3 samples/s | 24.4 steps/s
[Step=33400 Epoch=317.7] | Loss=0.00008 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=14.139 | 4340.2 samples/s | 67.8 steps/s
[Step=33450 Epoch=318.2] | Loss=0.00008 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.951 | L2-Norm(final)=14.139 | 6710.1 samples/s | 104.8 steps/s
[Step=33500 Epoch=318.7] | Loss=0.00007 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=14.140 | 1367.3 samples/s | 21.4 steps/s
[Step=33550 Epoch=319.1] | Loss=0.00007 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.939 | L2-Norm(final)=14.140 | 6141.4 samples/s | 96.0 steps/s
[Step=33600 Epoch=319.6] | Loss=0.00007 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.934 | L2-Norm(final)=14.140 | 1403.8 samples/s | 21.9 steps/s
[Step=33650 Epoch=320.1] | Loss=0.00006 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.928 | L2-Norm(final)=14.141 | 5520.6 samples/s | 86.3 steps/s
[Step=33700 Epoch=320.6] | Loss=0.00006 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.922 | L2-Norm(final)=14.141 | 1417.8 samples/s | 22.2 steps/s
[Step=33750 Epoch=321.0] | Loss=0.00006 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.916 | L2-Norm(final)=14.142 | 5102.5 samples/s | 79.7 steps/s
[Step=33800 Epoch=321.5] | Loss=0.00006 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.910 | L2-Norm(final)=14.142 | 1474.9 samples/s | 23.0 steps/s
[Step=33850 Epoch=322.0] | Loss=0.00005 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.904 | L2-Norm(final)=14.142 | 4629.1 samples/s | 72.3 steps/s
[Step=33900 Epoch=322.5] | Loss=0.00005 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.898 | L2-Norm(final)=14.143 | 1523.9 samples/s | 23.8 steps/s
[Step=33950 Epoch=322.9] | Loss=0.00005 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.892 | L2-Norm(final)=14.143 | 4488.4 samples/s | 70.1 steps/s
[Step=34000 Epoch=323.4] | Loss=0.00005 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.886 | L2-Norm(final)=14.143 | 1553.8 samples/s | 24.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step34000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=38001 Epoch=362.9] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.018 | L2-Norm(final)=16.862 | 3185.6 samples/s | 49.8 steps/s
[Step=38050 Epoch=363.4] | Loss=0.00008 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=16.866 | 4454.0 samples/s | 69.6 steps/s
[Step=38100 Epoch=363.8] | Loss=0.00013 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=16.872 | 8364.6 samples/s | 130.7 steps/s
[Step=38150 Epoch=364.3] | Loss=0.00015 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=16.879 | 1451.0 samples/s | 22.7 steps/s
[Step=38200 Epoch=364.8] | Loss=0.00013 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=16.886 | 7562.9 samples/s | 118.2 steps/s
[Step=38250 Epoch=365.3] | Loss=0.00012 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.015 | L2-Norm(final)=16.892 | 1458.2 samples/s | 22.8 steps/s
[Step=38300 Epoch=365.7] | Loss=0.00012 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.015 | L2-Norm(final)=16.898 | 6822.5 samples/s | 106.6 steps/s
[Step=38350 Epoch=366.2] | Loss=0.00012 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.015 | L2-Norm(final)=16.903 | 1515.9 samples/s | 23.7 steps/s
[Step=38400 Epoch=366.7] | Loss=0.00012 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.015 | L2-Norm(final)=16.909 | 6146.0 samples/s | 96.0 steps/s
[Step=38450 Epoch=367.2] | Loss=0.00012 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.015 | L2-Norm(final)=16.914 | 1524.2 samples/s | 23.8 steps/s
[Step=38500 Epoch=367.7] | Loss=0.00012 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.015 | L2-Norm(final)=16.920 | 5767.2 samples/s | 90.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=367.7] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.015 | L2-Norm(final)=16.973 | 3211.0 samples/s | 50.2 steps/s
[Step=38550 Epoch=368.1] | Loss=0.00007 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.005 | L2-Norm(final)=16.978 | 3940.1 samples/s | 61.6 steps/s
[Step=38600 Epoch=368.6] | Loss=0.00004 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.993 | L2-Norm(final)=16.981 | 6573.2 samples/s | 102.7 steps/s
[Step=38650 Epoch=369.1] | Loss=0.00003 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.979 | L2-Norm(final)=16.982 | 1378.3 samples/s | 21.5 steps/s
[Step=38700 Epoch=369.6] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.964 | L2-Norm(final)=16.983 | 5900.9 samples/s | 92.2 steps/s
[Step=38750 Epoch=370.0] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.949 | L2-Norm(final)=16.984 | 1404.7 samples/s | 21.9 steps/s
[Step=38800 Epoch=370.5] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.935 | L2-Norm(final)=16.984 | 5526.2 samples/s | 86.3 steps/s
[Step=38850 Epoch=371.0] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.920 | L2-Norm(final)=16.985 | 1423.5 samples/s | 22.2 steps/s
[Step=38900 Epoch=371.5] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.906 | L2-Norm(final)=16.985 | 5206.5 samples/s | 81.4 steps/s
[Step=38950 Epoch=371.9] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.892 | L2-Norm(final)=16.986 | 1454.6 samples/s | 22.7 steps/s
[Step=39000 Epoch=372.4] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.878 | L2-Norm(final)=16.986 | 4884.1 samples/s | 76.3 steps/s
[Step=39050 Epoch=372.9] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.864 | L2-Norm(final)=16.986 | 1491.7 samples/s | 23.3 steps/s
[Step=39100 Epoch=373.4] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.850 | L2-Norm(final)=16.987 | 4551.9 samples/s | 71.1 steps/s
[Step=39150 Epoch=373.9] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.836 | L2-Norm(final)=16.987 | 1516.6 samples/s | 23.7 steps/s
[Step=39200 Epoch=374.3] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.822 | L2-Norm(final)=16.987 | 4474.6 samples/s | 69.9 steps/s
[Step=39250 Epoch=374.8] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.808 | L2-Norm(final)=16.988 | 1543.5 samples/s | 24.1 steps/s
[Step=39300 Epoch=375.3] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.794 | L2-Norm(final)=16.988 | 4531.7 samples/s | 70.8 steps/s
[Step=39350 Epoch=375.8] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.781 | L2-Norm(final)=16.988 | 1558.4 samples/s | 24.4 steps/s
[Step=39400 Epoch=376.2] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.767 | L2-Norm(final)=16.988 | 4472.1 samples/s | 69.9 steps/s
[Step=39450 Epoch=376.7] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.753 | L2-Norm(final)=16.989 | 1554.1 samples/s | 24.3 steps/s
[Step=39500 Epoch=377.2] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.739 | L2-Norm(final)=16.989 | 4344.5 samples/s | 67.9 steps/s
[Step=39550 Epoch=377.7] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.726 | L2-Norm(final)=16.989 | 7241.8 samples/s | 113.2 steps/s
[Step=39600 Epoch=378.2] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.712 | L2-Norm(final)=16.990 | 1367.9 samples/s | 21.4 steps/s
[Step=39650 Epoch=378.6] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.698 | L2-Norm(final)=16.990 | 6536.7 samples/s | 102.1 steps/s
[Step=39700 Epoch=379.1] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.684 | L2-Norm(final)=16.990 | 1367.6 samples/s | 21.4 steps/s
[Step=39750 Epoch=379.6] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.670 | L2-Norm(final)=16.991 | 6014.7 samples/s | 94.0 steps/s
[Step=39800 Epoch=380.1] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.656 | L2-Norm(final)=16.991 | 1406.6 samples/s | 22.0 steps/s
[Step=39850 Epoch=380.5] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.642 | L2-Norm(final)=16.991 | 5625.4 samples/s | 87.9 steps/s
[Step=39900 Epoch=381.0] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.628 | L2-Norm(final)=16.992 | 1450.3 samples/s | 22.7 steps/s
[Step=39950 Epoch=381.5] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.614 | L2-Norm(final)=16.992 | 5214.1 samples/s | 81.5 steps/s
[Step=40000 Epoch=382.0] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.600 | L2-Norm(final)=16.992 | 1445.6 samples/s | 22.6 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08596 | acc=0.9631 | tpr=0.9716 | fpr=0.0553 | 4657.1 samples/s | 18.2 steps/s
Avg test loss: 0.09005, Avg test acc: 0.96178, Avg tpr: 0.97121, Avg fpr: 0.05897, total FA: 460

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09131 | acc=0.9590 | tpr=0.9716 | fpr=0.0684 | 4733.3 samples/s | 18.5 steps/s
Avg test loss: 0.09315, Avg test acc: 0.95757, Avg tpr: 0.97068, Avg fpr: 0.07127, total FA: 556

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08991 | acc=0.9589 | tpr=0.9657 | fpr=0.0557 | 4743.9 samples/s | 18.5 steps/s
Avg test loss: 0.09468, Avg test acc: 0.95757, Avg tpr: 0.96433, Avg fpr: 0.05730, total FA: 447

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08321 | acc=0.9641 | tpr=0.9741 | fpr=0.0575 | 4681.5 samples/s | 18.3 steps/s
Avg test loss: 0.08761, Avg test acc: 0.96350, Avg tpr: 0.97319, Avg fpr: 0.05781, total FA: 451

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08467 | acc=0.9624 | tpr=0.9768 | fpr=0.0689 | 4485.4 samples/s | 17.5 steps/s
Avg test loss: 0.09050, Avg test acc: 0.96113, Avg tpr: 0.97535, Avg fpr: 0.07012, total FA: 547

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.22454 | acc=0.3057 | tpr=0.0135 | fpr=0.0597 | 4690.8 samples/s | 18.3 steps/s
Avg test loss: 5.23971, Avg test acc: 0.30307, Avg tpr: 0.01271, Avg fpr: 0.05833, total FA: 455

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.38189 | acc=0.2923 | tpr=0.0112 | fpr=0.0971 | 4605.0 samples/s | 18.0 steps/s
Avg test loss: 4.39613, Avg test acc: 0.29033, Avg tpr: 0.01201, Avg fpr: 0.09755, total FA: 761

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.89161 | acc=0.2952 | tpr=0.0140 | fpr=0.0944 | 4695.4 samples/s | 18.3 steps/s
Avg test loss: 4.90425, Avg test acc: 0.29277, Avg tpr: 0.01393, Avg fpr: 0.09396, total FA: 733

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.04252 | acc=0.3121 | tpr=0.0339 | fpr=0.0837 | 4785.2 samples/s | 18.7 steps/s
Avg test loss: 4.05955, Avg test acc: 0.30900, Avg tpr: 0.03392, Avg fpr: 0.08601, total FA: 671

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.81238 | acc=0.3084 | tpr=0.0137 | fpr=0.0515 | 4594.9 samples/s | 17.9 steps/s
Avg test loss: 5.83533, Avg test acc: 0.30639, Avg tpr: 0.01364, Avg fpr: 0.04974, total FA: 388

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.97391 | acc=0.1437 | tpr=0.7257 | fpr=0.8667 | 4712.8 samples/s | 18.4 steps/s
[Step= 100] | Loss=5.95231 | acc=0.1454 | tpr=0.6908 | fpr=0.8648 | 7757.1 samples/s | 30.3 steps/s
[Step= 150] | Loss=5.95908 | acc=0.1464 | tpr=0.7046 | fpr=0.8639 | 8463.1 samples/s | 33.1 steps/s
[Step= 200] | Loss=5.94835 | acc=0.1461 | tpr=0.7082 | fpr=0.8641 | 8040.3 samples/s | 31.4 steps/s
[Step= 250] | Loss=5.94591 | acc=0.1469 | tpr=0.7031 | fpr=0.8632 | 7661.8 samples/s | 29.9 steps/s
[Step= 300] | Loss=5.93892 | acc=0.1477 | tpr=0.7062 | fpr=0.8625 | 8146.1 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.94844 | acc=0.1472 | tpr=0.7038 | fpr=0.8629 | 8046.2 samples/s | 31.4 steps/s
[Step= 400] | Loss=5.94957 | acc=0.1473 | tpr=0.7035 | fpr=0.8628 | 7916.3 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.94455 | acc=0.1473 | tpr=0.7016 | fpr=0.8628 | 7592.0 samples/s | 29.7 steps/s
[Step= 500] | Loss=5.94418 | acc=0.1476 | tpr=0.6982 | fpr=0.8623 | 8433.4 samples/s | 32.9 steps/s
[Step= 550] | Loss=5.94190 | acc=0.1480 | tpr=0.7019 | fpr=0.8621 | 9424.9 samples/s | 36.8 steps/s
Avg test loss: 5.94278, Avg test acc: 0.14784, Avg tpr: 0.70087, Avg fpr: 0.86221, total FA: 119716

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.52818 | acc=0.1401 | tpr=0.7743 | fpr=0.8713 | 4762.7 samples/s | 18.6 steps/s
[Step= 100] | Loss=5.51307 | acc=0.1418 | tpr=0.7463 | fpr=0.8694 | 7640.2 samples/s | 29.8 steps/s
[Step= 150] | Loss=5.51594 | acc=0.1430 | tpr=0.7435 | fpr=0.8680 | 7618.9 samples/s | 29.8 steps/s
[Step= 200] | Loss=5.50918 | acc=0.1431 | tpr=0.7377 | fpr=0.8677 | 8820.7 samples/s | 34.5 steps/s
[Step= 250] | Loss=5.50656 | acc=0.1441 | tpr=0.7380 | fpr=0.8667 | 7893.2 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.50296 | acc=0.1445 | tpr=0.7367 | fpr=0.8663 | 7932.1 samples/s | 31.0 steps/s
[Step= 350] | Loss=5.51049 | acc=0.1441 | tpr=0.7383 | fpr=0.8667 | 7724.7 samples/s | 30.2 steps/s
[Step= 400] | Loss=5.51389 | acc=0.1437 | tpr=0.7352 | fpr=0.8671 | 7926.1 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.51191 | acc=0.1435 | tpr=0.7313 | fpr=0.8672 | 7862.1 samples/s | 30.7 steps/s
[Step= 500] | Loss=5.51330 | acc=0.1435 | tpr=0.7273 | fpr=0.8670 | 7985.7 samples/s | 31.2 steps/s
[Step= 550] | Loss=5.51146 | acc=0.1437 | tpr=0.7322 | fpr=0.8670 | 10501.1 samples/s | 41.0 steps/s
Avg test loss: 5.51281, Avg test acc: 0.14361, Avg tpr: 0.73177, Avg fpr: 0.86708, total FA: 120393

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.82655 | acc=0.1394 | tpr=0.7699 | fpr=0.8720 | 4390.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=5.79581 | acc=0.1418 | tpr=0.7463 | fpr=0.8694 | 8627.9 samples/s | 33.7 steps/s
[Step= 150] | Loss=5.79780 | acc=0.1430 | tpr=0.7493 | fpr=0.8681 | 7857.7 samples/s | 30.7 steps/s
[Step= 200] | Loss=5.78277 | acc=0.1435 | tpr=0.7475 | fpr=0.8675 | 8365.2 samples/s | 32.7 steps/s
[Step= 250] | Loss=5.77674 | acc=0.1442 | tpr=0.7476 | fpr=0.8668 | 8136.2 samples/s | 31.8 steps/s
[Step= 300] | Loss=5.77122 | acc=0.1444 | tpr=0.7462 | fpr=0.8665 | 7891.0 samples/s | 30.8 steps/s
[Step= 350] | Loss=5.78157 | acc=0.1441 | tpr=0.7451 | fpr=0.8668 | 8114.9 samples/s | 31.7 steps/s
[Step= 400] | Loss=5.78380 | acc=0.1437 | tpr=0.7402 | fpr=0.8671 | 7125.2 samples/s | 27.8 steps/s
[Step= 450] | Loss=5.78007 | acc=0.1441 | tpr=0.7376 | fpr=0.8667 | 8342.4 samples/s | 32.6 steps/s
[Step= 500] | Loss=5.77920 | acc=0.1443 | tpr=0.7366 | fpr=0.8663 | 8330.4 samples/s | 32.5 steps/s
[Step= 550] | Loss=5.77760 | acc=0.1446 | tpr=0.7398 | fpr=0.8662 | 10327.5 samples/s | 40.3 steps/s
Avg test loss: 5.77843, Avg test acc: 0.14446, Avg tpr: 0.73930, Avg fpr: 0.86636, total FA: 120292

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.07382 | acc=0.1549 | tpr=0.7212 | fpr=0.8553 | 4716.0 samples/s | 18.4 steps/s
[Step= 100] | Loss=6.03819 | acc=0.1562 | tpr=0.6994 | fpr=0.8539 | 8147.9 samples/s | 31.8 steps/s
[Step= 150] | Loss=6.04575 | acc=0.1585 | tpr=0.7089 | fpr=0.8517 | 7277.4 samples/s | 28.4 steps/s
[Step= 200] | Loss=6.03634 | acc=0.1586 | tpr=0.7016 | fpr=0.8512 | 8306.3 samples/s | 32.4 steps/s
[Step= 250] | Loss=6.03281 | acc=0.1591 | tpr=0.6961 | fpr=0.8507 | 8491.6 samples/s | 33.2 steps/s
[Step= 300] | Loss=6.02604 | acc=0.1595 | tpr=0.6975 | fpr=0.8503 | 8017.9 samples/s | 31.3 steps/s
[Step= 350] | Loss=6.03704 | acc=0.1591 | tpr=0.7019 | fpr=0.8508 | 7880.9 samples/s | 30.8 steps/s
[Step= 400] | Loss=6.03867 | acc=0.1589 | tpr=0.6997 | fpr=0.8509 | 8043.9 samples/s | 31.4 steps/s
[Step= 450] | Loss=6.03444 | acc=0.1590 | tpr=0.6967 | fpr=0.8508 | 7789.5 samples/s | 30.4 steps/s
[Step= 500] | Loss=6.03527 | acc=0.1592 | tpr=0.6943 | fpr=0.8505 | 8313.8 samples/s | 32.5 steps/s
[Step= 550] | Loss=6.03527 | acc=0.1592 | tpr=0.6960 | fpr=0.8506 | 9523.2 samples/s | 37.2 steps/s
Avg test loss: 6.03641, Avg test acc: 0.15908, Avg tpr: 0.69532, Avg fpr: 0.85067, total FA: 118114

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.15358 | acc=0.1268 | tpr=0.7965 | fpr=0.8852 | 4633.2 samples/s | 18.1 steps/s
[Step= 100] | Loss=6.12784 | acc=0.1286 | tpr=0.7804 | fpr=0.8836 | 7935.1 samples/s | 31.0 steps/s
[Step= 150] | Loss=6.13440 | acc=0.1292 | tpr=0.7781 | fpr=0.8828 | 7374.3 samples/s | 28.8 steps/s
[Step= 200] | Loss=6.12742 | acc=0.1287 | tpr=0.7683 | fpr=0.8829 | 8597.6 samples/s | 33.6 steps/s
[Step= 250] | Loss=6.12634 | acc=0.1295 | tpr=0.7651 | fpr=0.8821 | 7407.0 samples/s | 28.9 steps/s
[Step= 300] | Loss=6.11913 | acc=0.1300 | tpr=0.7651 | fpr=0.8816 | 8265.0 samples/s | 32.3 steps/s
[Step= 350] | Loss=6.12686 | acc=0.1296 | tpr=0.7696 | fpr=0.8820 | 8348.1 samples/s | 32.6 steps/s
[Step= 400] | Loss=6.12883 | acc=0.1292 | tpr=0.7642 | fpr=0.8823 | 7468.5 samples/s | 29.2 steps/s
[Step= 450] | Loss=6.12575 | acc=0.1293 | tpr=0.7624 | fpr=0.8822 | 8189.6 samples/s | 32.0 steps/s
[Step= 500] | Loss=6.12891 | acc=0.1294 | tpr=0.7621 | fpr=0.8820 | 8099.2 samples/s | 31.6 steps/s
[Step= 550] | Loss=6.12820 | acc=0.1298 | tpr=0.7628 | fpr=0.8817 | 10819.6 samples/s | 42.3 steps/s
Avg test loss: 6.12955, Avg test acc: 0.12973, Avg tpr: 0.76268, Avg fpr: 0.88178, total FA: 122433

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19833 | acc=0.9602 | tpr=0.9469 | fpr=0.0396 | 4635.9 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.20435 | acc=0.9596 | tpr=0.9488 | fpr=0.0402 | 7743.5 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.20988 | acc=0.9586 | tpr=0.9496 | fpr=0.0413 | 7772.7 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.21074 | acc=0.9587 | tpr=0.9541 | fpr=0.0412 | 8620.8 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.21180 | acc=0.9585 | tpr=0.9537 | fpr=0.0414 | 8256.7 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.21369 | acc=0.9580 | tpr=0.9527 | fpr=0.0419 | 7657.5 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.21361 | acc=0.9577 | tpr=0.9518 | fpr=0.0422 | 8016.3 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.21512 | acc=0.9574 | tpr=0.9486 | fpr=0.0424 | 7855.5 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.21636 | acc=0.9570 | tpr=0.9450 | fpr=0.0428 | 7609.9 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.21610 | acc=0.9570 | tpr=0.9458 | fpr=0.0428 | 8310.6 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.21577 | acc=0.9572 | tpr=0.9439 | fpr=0.0426 | 10089.7 samples/s | 39.4 steps/s
Avg test loss: 0.21548, Avg test acc: 0.95721, Avg tpr: 0.94374, Avg fpr: 0.04254, total FA: 5907

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14596 | acc=0.9627 | tpr=0.9425 | fpr=0.0369 | 4708.4 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.15054 | acc=0.9624 | tpr=0.9424 | fpr=0.0372 | 7781.7 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.15322 | acc=0.9615 | tpr=0.9424 | fpr=0.0381 | 7528.0 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.15408 | acc=0.9619 | tpr=0.9464 | fpr=0.0378 | 8171.8 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.15527 | acc=0.9616 | tpr=0.9450 | fpr=0.0381 | 8334.6 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.15612 | acc=0.9612 | tpr=0.9447 | fpr=0.0385 | 8399.6 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.15629 | acc=0.9611 | tpr=0.9455 | fpr=0.0386 | 8025.3 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.15776 | acc=0.9608 | tpr=0.9437 | fpr=0.0389 | 7994.0 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.15839 | acc=0.9605 | tpr=0.9406 | fpr=0.0391 | 8421.4 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.15819 | acc=0.9606 | tpr=0.9419 | fpr=0.0390 | 8033.6 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.15788 | acc=0.9607 | tpr=0.9399 | fpr=0.0389 | 9152.3 samples/s | 35.8 steps/s
Avg test loss: 0.15758, Avg test acc: 0.96076, Avg tpr: 0.93978, Avg fpr: 0.03886, total FA: 5395

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.25020 | acc=0.9545 | tpr=0.9469 | fpr=0.0454 | 4778.7 samples/s | 18.7 steps/s
[Step= 100] | Loss=0.25674 | acc=0.9546 | tpr=0.9531 | fpr=0.0453 | 7234.7 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.26503 | acc=0.9538 | tpr=0.9510 | fpr=0.0462 | 8065.4 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.26622 | acc=0.9538 | tpr=0.9563 | fpr=0.0462 | 8162.6 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.26758 | acc=0.9536 | tpr=0.9598 | fpr=0.0465 | 8556.8 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.26979 | acc=0.9532 | tpr=0.9593 | fpr=0.0469 | 7689.3 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.26989 | acc=0.9531 | tpr=0.9587 | fpr=0.0470 | 7730.0 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.27184 | acc=0.9527 | tpr=0.9568 | fpr=0.0474 | 8184.5 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.27335 | acc=0.9524 | tpr=0.9547 | fpr=0.0476 | 7655.2 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.27316 | acc=0.9523 | tpr=0.9555 | fpr=0.0478 | 8259.7 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.27252 | acc=0.9524 | tpr=0.9534 | fpr=0.0476 | 10277.8 samples/s | 40.1 steps/s
Avg test loss: 0.27211, Avg test acc: 0.95245, Avg tpr: 0.95285, Avg fpr: 0.04756, total FA: 6603

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.13034 | acc=0.9675 | tpr=0.9292 | fpr=0.0318 | 4798.9 samples/s | 18.7 steps/s
[Step= 100] | Loss=0.13489 | acc=0.9671 | tpr=0.9254 | fpr=0.0321 | 7469.9 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.13832 | acc=0.9667 | tpr=0.9280 | fpr=0.0326 | 8239.1 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.13844 | acc=0.9674 | tpr=0.9366 | fpr=0.0321 | 8241.4 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.13973 | acc=0.9671 | tpr=0.9406 | fpr=0.0324 | 7963.7 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.14174 | acc=0.9666 | tpr=0.9367 | fpr=0.0329 | 7027.7 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.14268 | acc=0.9665 | tpr=0.9374 | fpr=0.0330 | 8349.3 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.14394 | acc=0.9662 | tpr=0.9322 | fpr=0.0332 | 8276.0 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.14541 | acc=0.9659 | tpr=0.9304 | fpr=0.0335 | 8096.7 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.14428 | acc=0.9660 | tpr=0.9322 | fpr=0.0333 | 8332.8 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.14398 | acc=0.9662 | tpr=0.9304 | fpr=0.0332 | 9575.5 samples/s | 37.4 steps/s
Avg test loss: 0.14362, Avg test acc: 0.96622, Avg tpr: 0.92987, Avg fpr: 0.03312, total FA: 4599

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.18736 | acc=0.9605 | tpr=0.8894 | fpr=0.0383 | 4586.7 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.19268 | acc=0.9601 | tpr=0.9062 | fpr=0.0389 | 7977.8 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.19630 | acc=0.9596 | tpr=0.9121 | fpr=0.0395 | 7478.0 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.19675 | acc=0.9596 | tpr=0.9191 | fpr=0.0396 | 8209.7 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.19777 | acc=0.9594 | tpr=0.9179 | fpr=0.0398 | 7903.7 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.19893 | acc=0.9592 | tpr=0.9149 | fpr=0.0400 | 7962.0 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.19950 | acc=0.9592 | tpr=0.9142 | fpr=0.0400 | 8282.9 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.20084 | acc=0.9590 | tpr=0.9125 | fpr=0.0402 | 8096.0 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.20194 | acc=0.9586 | tpr=0.9119 | fpr=0.0405 | 7852.7 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.20177 | acc=0.9586 | tpr=0.9119 | fpr=0.0406 | 7864.8 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.20098 | acc=0.9587 | tpr=0.9125 | fpr=0.0405 | 10828.8 samples/s | 42.3 steps/s
Avg test loss: 0.20065, Avg test acc: 0.95870, Avg tpr: 0.91244, Avg fpr: 0.04045, total FA: 5617

server round 31/50

clients selected: [2 4 6 7 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=16001 Epoch=78.0] | Loss=0.02827 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.951 | L2-Norm(final)=10.915 | 3263.3 samples/s | 51.0 steps/s
[Step=16050 Epoch=78.2] | Loss=0.02295 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.952 | L2-Norm(final)=10.917 | 4727.1 samples/s | 73.9 steps/s
[Step=16100 Epoch=78.4] | Loss=0.02172 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=10.923 | 5570.9 samples/s | 87.0 steps/s
[Step=16150 Epoch=78.7] | Loss=0.02138 | Reg=0.00120 | acc=0.9531 | L2-Norm=10.952 | L2-Norm(final)=10.929 | 5463.4 samples/s | 85.4 steps/s
[Step=16200 Epoch=78.9] | Loss=0.02232 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.952 | L2-Norm(final)=10.934 | 8293.1 samples/s | 129.6 steps/s
[Step=16250 Epoch=79.2] | Loss=0.02235 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.952 | L2-Norm(final)=10.939 | 1471.9 samples/s | 23.0 steps/s
[Step=16300 Epoch=79.4] | Loss=0.02173 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.952 | L2-Norm(final)=10.943 | 5778.3 samples/s | 90.3 steps/s
[Step=16350 Epoch=79.7] | Loss=0.02212 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.952 | L2-Norm(final)=10.948 | 5172.5 samples/s | 80.8 steps/s
[Step=16400 Epoch=79.9] | Loss=0.02196 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=10.952 | 7608.2 samples/s | 118.9 steps/s
[Step=16450 Epoch=80.2] | Loss=0.02184 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=10.955 | 1497.0 samples/s | 23.4 steps/s
[Step=16500 Epoch=80.4] | Loss=0.02156 | Reg=0.00120 | acc=0.9375 | L2-Norm=10.952 | L2-Norm(final)=10.959 | 5442.7 samples/s | 85.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=16501 Epoch=80.4] | Loss=0.01617 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.952 | L2-Norm(final)=11.000 | 3195.3 samples/s | 49.9 steps/s
[Step=16550 Epoch=80.6] | Loss=0.01998 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.964 | L2-Norm(final)=11.003 | 4432.9 samples/s | 69.3 steps/s
[Step=16600 Epoch=80.9] | Loss=0.01785 | Reg=0.00121 | acc=0.9688 | L2-Norm=10.981 | L2-Norm(final)=11.007 | 4625.6 samples/s | 72.3 steps/s
[Step=16650 Epoch=81.1] | Loss=0.01716 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.994 | L2-Norm(final)=11.010 | 4684.6 samples/s | 73.2 steps/s
[Step=16700 Epoch=81.4] | Loss=0.01639 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.004 | L2-Norm(final)=11.012 | 6761.2 samples/s | 105.6 steps/s
[Step=16750 Epoch=81.6] | Loss=0.01546 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.013 | L2-Norm(final)=11.014 | 1420.5 samples/s | 22.2 steps/s
[Step=16800 Epoch=81.9] | Loss=0.01430 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.021 | L2-Norm(final)=11.016 | 4679.7 samples/s | 73.1 steps/s
[Step=16850 Epoch=82.1] | Loss=0.01342 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.027 | L2-Norm(final)=11.019 | 4703.4 samples/s | 73.5 steps/s
[Step=16900 Epoch=82.3] | Loss=0.01270 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.033 | L2-Norm(final)=11.021 | 6125.9 samples/s | 95.7 steps/s
[Step=16950 Epoch=82.6] | Loss=0.01182 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.038 | L2-Norm(final)=11.024 | 1447.5 samples/s | 22.6 steps/s
[Step=17000 Epoch=82.8] | Loss=0.01103 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.043 | L2-Norm(final)=11.028 | 4605.4 samples/s | 72.0 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01046 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.048 | L2-Norm(final)=11.031 | 4760.8 samples/s | 74.4 steps/s
[Step=17100 Epoch=83.3] | Loss=0.00997 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.052 | L2-Norm(final)=11.034 | 5549.9 samples/s | 86.7 steps/s
[Step=17150 Epoch=83.6] | Loss=0.00961 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.056 | L2-Norm(final)=11.037 | 1473.1 samples/s | 23.0 steps/s
[Step=17200 Epoch=83.8] | Loss=0.00920 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.060 | L2-Norm(final)=11.040 | 4741.5 samples/s | 74.1 steps/s
[Step=17250 Epoch=84.1] | Loss=0.00888 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.064 | L2-Norm(final)=11.043 | 4651.5 samples/s | 72.7 steps/s
[Step=17300 Epoch=84.3] | Loss=0.00848 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.067 | L2-Norm(final)=11.046 | 5203.9 samples/s | 81.3 steps/s
[Step=17350 Epoch=84.5] | Loss=0.00830 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.071 | L2-Norm(final)=11.049 | 1533.8 samples/s | 24.0 steps/s
[Step=17400 Epoch=84.8] | Loss=0.00809 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.074 | L2-Norm(final)=11.052 | 4717.8 samples/s | 73.7 steps/s
[Step=17450 Epoch=85.0] | Loss=0.00785 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.077 | L2-Norm(final)=11.055 | 4659.8 samples/s | 72.8 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00766 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.081 | L2-Norm(final)=11.058 | 4811.2 samples/s | 75.2 steps/s
[Step=17550 Epoch=85.5] | Loss=0.00746 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.084 | L2-Norm(final)=11.061 | 1541.6 samples/s | 24.1 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00733 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=11.064 | 4689.6 samples/s | 73.3 steps/s
[Step=17650 Epoch=86.0] | Loss=0.00715 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.090 | L2-Norm(final)=11.067 | 4698.7 samples/s | 73.4 steps/s
[Step=17700 Epoch=86.2] | Loss=0.00703 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.092 | L2-Norm(final)=11.069 | 4693.0 samples/s | 73.3 steps/s
[Step=17750 Epoch=86.5] | Loss=0.00688 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=11.072 | 1574.0 samples/s | 24.6 steps/s
[Step=17800 Epoch=86.7] | Loss=0.00676 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.098 | L2-Norm(final)=11.075 | 4706.8 samples/s | 73.5 steps/s
[Step=17850 Epoch=87.0] | Loss=0.00665 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.101 | L2-Norm(final)=11.077 | 4740.5 samples/s | 74.1 steps/s
[Step=17900 Epoch=87.2] | Loss=0.00657 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.103 | L2-Norm(final)=11.080 | 4618.0 samples/s | 72.2 steps/s
[Step=17950 Epoch=87.5] | Loss=0.00643 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.106 | L2-Norm(final)=11.082 | 1551.3 samples/s | 24.2 steps/s
[Step=18000 Epoch=87.7] | Loss=0.00630 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.108 | L2-Norm(final)=11.085 | 4706.5 samples/s | 73.5 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_2/client_state-step18000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=22001 Epoch=107.9] | Loss=0.02617 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.951 | L2-Norm(final)=12.039 | 3319.2 samples/s | 51.9 steps/s
[Step=22050 Epoch=108.1] | Loss=0.01748 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=12.037 | 4621.0 samples/s | 72.2 steps/s
[Step=22100 Epoch=108.4] | Loss=0.01968 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.952 | L2-Norm(final)=12.038 | 5462.9 samples/s | 85.4 steps/s
[Step=22150 Epoch=108.6] | Loss=0.02038 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.952 | L2-Norm(final)=12.035 | 5546.8 samples/s | 86.7 steps/s
[Step=22200 Epoch=108.9] | Loss=0.02031 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.952 | L2-Norm(final)=12.034 | 8664.5 samples/s | 135.4 steps/s
[Step=22250 Epoch=109.1] | Loss=0.02039 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.952 | L2-Norm(final)=12.033 | 1492.0 samples/s | 23.3 steps/s
[Step=22300 Epoch=109.4] | Loss=0.01973 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.952 | L2-Norm(final)=12.032 | 5486.9 samples/s | 85.7 steps/s
[Step=22350 Epoch=109.6] | Loss=0.01912 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.952 | L2-Norm(final)=12.033 | 5303.8 samples/s | 82.9 steps/s
[Step=22400 Epoch=109.8] | Loss=0.01969 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.952 | L2-Norm(final)=12.034 | 8039.8 samples/s | 125.6 steps/s
[Step=22450 Epoch=110.1] | Loss=0.01978 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.952 | L2-Norm(final)=12.034 | 1451.3 samples/s | 22.7 steps/s
[Step=22500 Epoch=110.3] | Loss=0.01962 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.952 | L2-Norm(final)=12.035 | 5402.1 samples/s | 84.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=22501 Epoch=110.3] | Loss=0.04101 | Reg=0.00120 | acc=0.9531 | L2-Norm=10.952 | L2-Norm(final)=12.043 | 3205.8 samples/s | 50.1 steps/s
[Step=22550 Epoch=110.6] | Loss=0.02025 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.963 | L2-Norm(final)=12.045 | 4128.7 samples/s | 64.5 steps/s
[Step=22600 Epoch=110.8] | Loss=0.01916 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.974 | L2-Norm(final)=12.045 | 4616.2 samples/s | 72.1 steps/s
[Step=22650 Epoch=111.1] | Loss=0.01872 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.984 | L2-Norm(final)=12.047 | 4615.5 samples/s | 72.1 steps/s
[Step=22700 Epoch=111.3] | Loss=0.01753 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.993 | L2-Norm(final)=12.049 | 6829.0 samples/s | 106.7 steps/s
[Step=22750 Epoch=111.6] | Loss=0.01549 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.000 | L2-Norm(final)=12.051 | 1372.8 samples/s | 21.4 steps/s
[Step=22800 Epoch=111.8] | Loss=0.01394 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.007 | L2-Norm(final)=12.055 | 4667.1 samples/s | 72.9 steps/s
[Step=22850 Epoch=112.1] | Loss=0.01291 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.013 | L2-Norm(final)=12.058 | 4571.7 samples/s | 71.4 steps/s
[Step=22900 Epoch=112.3] | Loss=0.01203 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=12.062 | 6377.4 samples/s | 99.6 steps/s
[Step=22950 Epoch=112.5] | Loss=0.01107 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=12.066 | 1380.4 samples/s | 21.6 steps/s
[Step=23000 Epoch=112.8] | Loss=0.01037 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.030 | L2-Norm(final)=12.071 | 4629.7 samples/s | 72.3 steps/s
[Step=23050 Epoch=113.0] | Loss=0.00986 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.034 | L2-Norm(final)=12.075 | 4623.1 samples/s | 72.2 steps/s
[Step=23100 Epoch=113.3] | Loss=0.00960 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.039 | L2-Norm(final)=12.079 | 5992.1 samples/s | 93.6 steps/s
[Step=23150 Epoch=113.5] | Loss=0.00915 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.043 | L2-Norm(final)=12.082 | 1397.2 samples/s | 21.8 steps/s
[Step=23200 Epoch=113.8] | Loss=0.00877 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.047 | L2-Norm(final)=12.086 | 4659.3 samples/s | 72.8 steps/s
[Step=23250 Epoch=114.0] | Loss=0.00845 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.051 | L2-Norm(final)=12.089 | 4617.8 samples/s | 72.2 steps/s
[Step=23300 Epoch=114.3] | Loss=0.00819 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.055 | L2-Norm(final)=12.093 | 5624.5 samples/s | 87.9 steps/s
[Step=23350 Epoch=114.5] | Loss=0.00785 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.059 | L2-Norm(final)=12.096 | 1423.8 samples/s | 22.2 steps/s
[Step=23400 Epoch=114.7] | Loss=0.00765 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.062 | L2-Norm(final)=12.100 | 4567.9 samples/s | 71.4 steps/s
[Step=23450 Epoch=115.0] | Loss=0.00740 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.066 | L2-Norm(final)=12.103 | 4603.1 samples/s | 71.9 steps/s
[Step=23500 Epoch=115.2] | Loss=0.00720 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.069 | L2-Norm(final)=12.106 | 5371.5 samples/s | 83.9 steps/s
[Step=23550 Epoch=115.5] | Loss=0.00700 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.072 | L2-Norm(final)=12.109 | 1443.1 samples/s | 22.5 steps/s
[Step=23600 Epoch=115.7] | Loss=0.00680 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.075 | L2-Norm(final)=12.112 | 4589.4 samples/s | 71.7 steps/s
[Step=23650 Epoch=116.0] | Loss=0.00665 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.078 | L2-Norm(final)=12.115 | 4609.8 samples/s | 72.0 steps/s
[Step=23700 Epoch=116.2] | Loss=0.00654 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.081 | L2-Norm(final)=12.118 | 5067.8 samples/s | 79.2 steps/s
[Step=23750 Epoch=116.5] | Loss=0.00638 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.084 | L2-Norm(final)=12.121 | 1463.6 samples/s | 22.9 steps/s
[Step=23800 Epoch=116.7] | Loss=0.00626 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.086 | L2-Norm(final)=12.124 | 4593.2 samples/s | 71.8 steps/s
[Step=23850 Epoch=117.0] | Loss=0.00611 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.089 | L2-Norm(final)=12.127 | 4678.6 samples/s | 73.1 steps/s
[Step=23900 Epoch=117.2] | Loss=0.00600 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.092 | L2-Norm(final)=12.130 | 4814.0 samples/s | 75.2 steps/s
[Step=23950 Epoch=117.4] | Loss=0.00590 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=12.133 | 1509.8 samples/s | 23.6 steps/s
[Step=24000 Epoch=117.7] | Loss=0.00581 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.097 | L2-Norm(final)=12.136 | 4661.6 samples/s | 72.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_4/client_state-step24000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=323.4] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.951 | L2-Norm(final)=14.154 | 3144.8 samples/s | 49.1 steps/s
[Step=34050 Epoch=323.9] | Loss=0.00080 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.949 | L2-Norm(final)=14.155 | 4657.9 samples/s | 72.8 steps/s
[Step=34100 Epoch=324.4] | Loss=0.00099 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.949 | L2-Norm(final)=14.158 | 7940.3 samples/s | 124.1 steps/s
[Step=34150 Epoch=324.9] | Loss=0.00093 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=14.161 | 1410.5 samples/s | 22.0 steps/s
[Step=34200 Epoch=325.3] | Loss=0.00098 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=14.164 | 7197.3 samples/s | 112.5 steps/s
[Step=34250 Epoch=325.8] | Loss=0.00091 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=14.167 | 1455.0 samples/s | 22.7 steps/s
[Step=34300 Epoch=326.3] | Loss=0.00093 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=14.169 | 6405.6 samples/s | 100.1 steps/s
[Step=34350 Epoch=326.8] | Loss=0.00089 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=14.172 | 1484.3 samples/s | 23.2 steps/s
[Step=34400 Epoch=327.2] | Loss=0.00087 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=14.175 | 5678.8 samples/s | 88.7 steps/s
[Step=34450 Epoch=327.7] | Loss=0.00094 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=14.178 | 1544.7 samples/s | 24.1 steps/s
[Step=34500 Epoch=328.2] | Loss=0.00097 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=14.181 | 5174.7 samples/s | 80.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=328.2] | Loss=0.00038 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=14.214 | 3188.4 samples/s | 49.8 steps/s
[Step=34550 Epoch=328.7] | Loss=0.00084 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.951 | L2-Norm(final)=14.216 | 3871.2 samples/s | 60.5 steps/s
[Step=34600 Epoch=329.1] | Loss=0.00044 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.949 | L2-Norm(final)=14.218 | 6467.5 samples/s | 101.1 steps/s
[Step=34650 Epoch=329.6] | Loss=0.00029 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.942 | L2-Norm(final)=14.220 | 1353.8 samples/s | 21.2 steps/s
[Step=34700 Epoch=330.1] | Loss=0.00022 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.934 | L2-Norm(final)=14.221 | 5722.9 samples/s | 89.4 steps/s
[Step=34750 Epoch=330.6] | Loss=0.00018 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.926 | L2-Norm(final)=14.222 | 1396.6 samples/s | 21.8 steps/s
[Step=34800 Epoch=331.0] | Loss=0.00015 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.917 | L2-Norm(final)=14.223 | 5284.8 samples/s | 82.6 steps/s
[Step=34850 Epoch=331.5] | Loss=0.00013 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.908 | L2-Norm(final)=14.223 | 1402.1 samples/s | 21.9 steps/s
[Step=34900 Epoch=332.0] | Loss=0.00011 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.899 | L2-Norm(final)=14.224 | 4931.7 samples/s | 77.1 steps/s
[Step=34950 Epoch=332.5] | Loss=0.00010 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.889 | L2-Norm(final)=14.225 | 1440.8 samples/s | 22.5 steps/s
[Step=35000 Epoch=332.9] | Loss=0.00009 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=14.225 | 4531.2 samples/s | 70.8 steps/s
[Step=35050 Epoch=333.4] | Loss=0.00008 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.871 | L2-Norm(final)=14.226 | 1477.4 samples/s | 23.1 steps/s
[Step=35100 Epoch=333.9] | Loss=0.00008 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.862 | L2-Norm(final)=14.227 | 4420.3 samples/s | 69.1 steps/s
[Step=35150 Epoch=334.4] | Loss=0.00007 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.852 | L2-Norm(final)=14.227 | 1489.2 samples/s | 23.3 steps/s
[Step=35200 Epoch=334.8] | Loss=0.00007 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.843 | L2-Norm(final)=14.228 | 4409.7 samples/s | 68.9 steps/s
[Step=35250 Epoch=335.3] | Loss=0.00006 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.833 | L2-Norm(final)=14.229 | 1497.8 samples/s | 23.4 steps/s
[Step=35300 Epoch=335.8] | Loss=0.00006 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.824 | L2-Norm(final)=14.229 | 4492.2 samples/s | 70.2 steps/s
[Step=35350 Epoch=336.3] | Loss=0.00006 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.814 | L2-Norm(final)=14.230 | 1567.9 samples/s | 24.5 steps/s
[Step=35400 Epoch=336.7] | Loss=0.00005 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.805 | L2-Norm(final)=14.230 | 3973.4 samples/s | 62.1 steps/s
[Step=35450 Epoch=337.2] | Loss=0.00005 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.795 | L2-Norm(final)=14.231 | 6622.9 samples/s | 103.5 steps/s
[Step=35500 Epoch=337.7] | Loss=0.00005 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.785 | L2-Norm(final)=14.231 | 1361.1 samples/s | 21.3 steps/s
[Step=35550 Epoch=338.2] | Loss=0.00005 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.775 | L2-Norm(final)=14.232 | 5956.2 samples/s | 93.1 steps/s
[Step=35600 Epoch=338.6] | Loss=0.00004 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.766 | L2-Norm(final)=14.232 | 1382.3 samples/s | 21.6 steps/s
[Step=35650 Epoch=339.1] | Loss=0.00004 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.756 | L2-Norm(final)=14.233 | 5493.4 samples/s | 85.8 steps/s
[Step=35700 Epoch=339.6] | Loss=0.00004 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.746 | L2-Norm(final)=14.233 | 1400.1 samples/s | 21.9 steps/s
[Step=35750 Epoch=340.1] | Loss=0.00004 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.736 | L2-Norm(final)=14.234 | 5024.8 samples/s | 78.5 steps/s
[Step=35800 Epoch=340.5] | Loss=0.00004 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.726 | L2-Norm(final)=14.235 | 1441.6 samples/s | 22.5 steps/s
[Step=35850 Epoch=341.0] | Loss=0.00004 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.716 | L2-Norm(final)=14.235 | 4662.1 samples/s | 72.8 steps/s
[Step=35900 Epoch=341.5] | Loss=0.00004 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=14.236 | 1488.0 samples/s | 23.2 steps/s
[Step=35950 Epoch=342.0] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.695 | L2-Norm(final)=14.236 | 4404.7 samples/s | 68.8 steps/s
[Step=36000 Epoch=342.4] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.685 | L2-Norm(final)=14.237 | 1492.3 samples/s | 23.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_1/client_state-step36000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=40001 Epoch=382.0] | Loss=0.00009 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.951 | L2-Norm(final)=17.003 | 3310.4 samples/s | 51.7 steps/s
[Step=40050 Epoch=382.5] | Loss=0.00004 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.946 | L2-Norm(final)=17.006 | 4488.9 samples/s | 70.1 steps/s
[Step=40100 Epoch=382.9] | Loss=0.00012 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=17.013 | 8258.1 samples/s | 129.0 steps/s
[Step=40150 Epoch=383.4] | Loss=0.00014 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=17.023 | 1407.7 samples/s | 22.0 steps/s
[Step=40200 Epoch=383.9] | Loss=0.00012 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=17.031 | 7321.1 samples/s | 114.4 steps/s
[Step=40250 Epoch=384.4] | Loss=0.00012 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=17.038 | 1446.9 samples/s | 22.6 steps/s
[Step=40300 Epoch=384.8] | Loss=0.00011 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=17.045 | 6704.2 samples/s | 104.8 steps/s
[Step=40350 Epoch=385.3] | Loss=0.00010 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=17.051 | 1455.8 samples/s | 22.7 steps/s
[Step=40400 Epoch=385.8] | Loss=0.00010 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=17.057 | 6076.6 samples/s | 94.9 steps/s
[Step=40450 Epoch=386.3] | Loss=0.00011 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=17.062 | 1511.4 samples/s | 23.6 steps/s
[Step=40500 Epoch=386.8] | Loss=0.00011 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=17.068 | 5591.1 samples/s | 87.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=40501 Epoch=386.8] | Loss=0.00025 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=17.126 | 3105.4 samples/s | 48.5 steps/s
[Step=40550 Epoch=387.2] | Loss=0.00002 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.924 | L2-Norm(final)=17.130 | 3998.5 samples/s | 62.5 steps/s
[Step=40600 Epoch=387.7] | Loss=0.00013 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.894 | L2-Norm(final)=17.131 | 6468.5 samples/s | 101.1 steps/s
[Step=40650 Epoch=388.2] | Loss=0.00026 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.887 | L2-Norm(final)=17.133 | 1350.6 samples/s | 21.1 steps/s
[Step=40700 Epoch=388.7] | Loss=0.00022 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.887 | L2-Norm(final)=17.133 | 5832.9 samples/s | 91.1 steps/s
[Step=40750 Epoch=389.1] | Loss=0.00017 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.886 | L2-Norm(final)=17.134 | 1388.0 samples/s | 21.7 steps/s
[Step=40800 Epoch=389.6] | Loss=0.00015 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.883 | L2-Norm(final)=17.134 | 5565.0 samples/s | 87.0 steps/s
[Step=40850 Epoch=390.1] | Loss=0.00013 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=17.135 | 1414.8 samples/s | 22.1 steps/s
[Step=40900 Epoch=390.6] | Loss=0.00011 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.877 | L2-Norm(final)=17.135 | 5146.3 samples/s | 80.4 steps/s
[Step=40950 Epoch=391.0] | Loss=0.00010 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.873 | L2-Norm(final)=17.135 | 1421.7 samples/s | 22.2 steps/s
[Step=41000 Epoch=391.5] | Loss=0.00009 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.869 | L2-Norm(final)=17.135 | 4816.0 samples/s | 75.3 steps/s
[Step=41050 Epoch=392.0] | Loss=0.00008 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.865 | L2-Norm(final)=17.135 | 1446.9 samples/s | 22.6 steps/s
[Step=41100 Epoch=392.5] | Loss=0.00007 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.860 | L2-Norm(final)=17.136 | 4490.3 samples/s | 70.2 steps/s
[Step=41150 Epoch=393.0] | Loss=0.00007 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=17.136 | 1470.7 samples/s | 23.0 steps/s
[Step=41200 Epoch=393.4] | Loss=0.00006 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.851 | L2-Norm(final)=17.136 | 4427.2 samples/s | 69.2 steps/s
[Step=41250 Epoch=393.9] | Loss=0.00006 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.847 | L2-Norm(final)=17.136 | 1490.9 samples/s | 23.3 steps/s
[Step=41300 Epoch=394.4] | Loss=0.00006 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.842 | L2-Norm(final)=17.136 | 4333.9 samples/s | 67.7 steps/s
[Step=41350 Epoch=394.9] | Loss=0.00005 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.837 | L2-Norm(final)=17.136 | 1510.0 samples/s | 23.6 steps/s
[Step=41400 Epoch=395.3] | Loss=0.00005 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.833 | L2-Norm(final)=17.137 | 4409.3 samples/s | 68.9 steps/s
[Step=41450 Epoch=395.8] | Loss=0.00005 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.828 | L2-Norm(final)=17.137 | 1529.0 samples/s | 23.9 steps/s
[Step=41500 Epoch=396.3] | Loss=0.00004 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.823 | L2-Norm(final)=17.137 | 4457.0 samples/s | 69.6 steps/s
[Step=41550 Epoch=396.8] | Loss=0.00004 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.818 | L2-Norm(final)=17.137 | 7020.2 samples/s | 109.7 steps/s
[Step=41600 Epoch=397.3] | Loss=0.00004 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.813 | L2-Norm(final)=17.137 | 1309.1 samples/s | 20.5 steps/s
[Step=41650 Epoch=397.7] | Loss=0.00004 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.808 | L2-Norm(final)=17.137 | 6515.9 samples/s | 101.8 steps/s
[Step=41700 Epoch=398.2] | Loss=0.00004 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.803 | L2-Norm(final)=17.137 | 1363.1 samples/s | 21.3 steps/s
[Step=41750 Epoch=398.7] | Loss=0.00004 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.798 | L2-Norm(final)=17.137 | 5901.7 samples/s | 92.2 steps/s
[Step=41800 Epoch=399.2] | Loss=0.00003 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.793 | L2-Norm(final)=17.137 | 1379.8 samples/s | 21.6 steps/s
[Step=41850 Epoch=399.6] | Loss=0.00003 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.788 | L2-Norm(final)=17.137 | 5550.1 samples/s | 86.7 steps/s
[Step=41900 Epoch=400.1] | Loss=0.00003 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.782 | L2-Norm(final)=17.138 | 1383.1 samples/s | 21.6 steps/s
[Step=41950 Epoch=400.6] | Loss=0.00003 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.777 | L2-Norm(final)=17.138 | 5139.4 samples/s | 80.3 steps/s
[Step=42000 Epoch=401.1] | Loss=0.00003 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=17.138 | 1194.2 samples/s | 18.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_2/client_state-step42000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=30001 Epoch=285.9] | Loss=0.00550 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.951 | L2-Norm(final)=18.684 | 2950.2 samples/s | 46.1 steps/s
[Step=30050 Epoch=286.4] | Loss=0.00107 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.950 | L2-Norm(final)=18.691 | 4871.4 samples/s | 76.1 steps/s
[Step=30100 Epoch=286.9] | Loss=0.00081 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.950 | L2-Norm(final)=18.699 | 8248.1 samples/s | 128.9 steps/s
[Step=30150 Epoch=287.4] | Loss=0.00089 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.950 | L2-Norm(final)=18.705 | 1430.9 samples/s | 22.4 steps/s
[Step=30200 Epoch=287.8] | Loss=0.00112 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.950 | L2-Norm(final)=18.712 | 7075.7 samples/s | 110.6 steps/s
[Step=30250 Epoch=288.3] | Loss=0.00116 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.950 | L2-Norm(final)=18.719 | 1428.3 samples/s | 22.3 steps/s
[Step=30300 Epoch=288.8] | Loss=0.00108 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.950 | L2-Norm(final)=18.726 | 6649.2 samples/s | 103.9 steps/s
[Step=30350 Epoch=289.3] | Loss=0.00114 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.950 | L2-Norm(final)=18.733 | 1452.8 samples/s | 22.7 steps/s
[Step=30400 Epoch=289.7] | Loss=0.00109 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.950 | L2-Norm(final)=18.739 | 6183.7 samples/s | 96.6 steps/s
[Step=30450 Epoch=290.2] | Loss=0.00103 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.950 | L2-Norm(final)=18.745 | 1473.4 samples/s | 23.0 steps/s
[Step=30500 Epoch=290.7] | Loss=0.00100 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.950 | L2-Norm(final)=18.751 | 5669.9 samples/s | 88.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=290.7] | Loss=0.00009 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.950 | L2-Norm(final)=18.810 | 3141.9 samples/s | 49.1 steps/s
[Step=30550 Epoch=291.2] | Loss=0.00137 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=18.814 | 3931.5 samples/s | 61.4 steps/s
[Step=30600 Epoch=291.6] | Loss=0.00092 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.972 | L2-Norm(final)=18.816 | 6536.3 samples/s | 102.1 steps/s
[Step=30650 Epoch=292.1] | Loss=0.00066 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.975 | L2-Norm(final)=18.817 | 1352.7 samples/s | 21.1 steps/s
[Step=30700 Epoch=292.6] | Loss=0.00050 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.976 | L2-Norm(final)=18.818 | 5970.8 samples/s | 93.3 steps/s
[Step=30750 Epoch=293.1] | Loss=0.00040 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.976 | L2-Norm(final)=18.819 | 1381.8 samples/s | 21.6 steps/s
[Step=30800 Epoch=293.6] | Loss=0.00034 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.975 | L2-Norm(final)=18.819 | 5413.3 samples/s | 84.6 steps/s
[Step=30850 Epoch=294.0] | Loss=0.00029 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.973 | L2-Norm(final)=18.820 | 1381.6 samples/s | 21.6 steps/s
[Step=30900 Epoch=294.5] | Loss=0.00026 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.971 | L2-Norm(final)=18.820 | 5165.4 samples/s | 80.7 steps/s
[Step=30950 Epoch=295.0] | Loss=0.00023 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.969 | L2-Norm(final)=18.821 | 1450.3 samples/s | 22.7 steps/s
[Step=31000 Epoch=295.5] | Loss=0.00021 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.967 | L2-Norm(final)=18.821 | 4761.1 samples/s | 74.4 steps/s
[Step=31050 Epoch=295.9] | Loss=0.00019 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.964 | L2-Norm(final)=18.821 | 1520.2 samples/s | 23.8 steps/s
[Step=31100 Epoch=296.4] | Loss=0.00017 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=18.822 | 4490.9 samples/s | 70.2 steps/s
[Step=31150 Epoch=296.9] | Loss=0.00016 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.959 | L2-Norm(final)=18.822 | 1556.2 samples/s | 24.3 steps/s
[Step=31200 Epoch=297.4] | Loss=0.00015 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=18.822 | 4363.4 samples/s | 68.2 steps/s
[Step=31250 Epoch=297.8] | Loss=0.00014 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=18.822 | 1537.8 samples/s | 24.0 steps/s
[Step=31300 Epoch=298.3] | Loss=0.00013 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.951 | L2-Norm(final)=18.823 | 4588.6 samples/s | 71.7 steps/s
[Step=31350 Epoch=298.8] | Loss=0.00012 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=18.823 | 1503.2 samples/s | 23.5 steps/s
[Step=31400 Epoch=299.3] | Loss=0.00012 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=18.823 | 4483.1 samples/s | 70.0 steps/s
[Step=31450 Epoch=299.7] | Loss=0.00011 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.942 | L2-Norm(final)=18.823 | 1526.9 samples/s | 23.9 steps/s
[Step=31500 Epoch=300.2] | Loss=0.00011 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.940 | L2-Norm(final)=18.824 | 4474.0 samples/s | 69.9 steps/s
[Step=31550 Epoch=300.7] | Loss=0.00010 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.937 | L2-Norm(final)=18.824 | 7264.4 samples/s | 113.5 steps/s
[Step=31600 Epoch=301.2] | Loss=0.00010 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.934 | L2-Norm(final)=18.824 | 1335.0 samples/s | 20.9 steps/s
[Step=31650 Epoch=301.7] | Loss=0.00009 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.930 | L2-Norm(final)=18.824 | 6600.4 samples/s | 103.1 steps/s
[Step=31700 Epoch=302.1] | Loss=0.00009 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.927 | L2-Norm(final)=18.824 | 1364.8 samples/s | 21.3 steps/s
[Step=31750 Epoch=302.6] | Loss=0.00009 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.924 | L2-Norm(final)=18.825 | 6031.7 samples/s | 94.2 steps/s
[Step=31800 Epoch=303.1] | Loss=0.00008 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.921 | L2-Norm(final)=18.825 | 1403.5 samples/s | 21.9 steps/s
[Step=31850 Epoch=303.6] | Loss=0.00008 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.918 | L2-Norm(final)=18.825 | 5543.2 samples/s | 86.6 steps/s
[Step=31900 Epoch=304.0] | Loss=0.00008 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.914 | L2-Norm(final)=18.825 | 1450.7 samples/s | 22.7 steps/s
[Step=31950 Epoch=304.5] | Loss=0.00007 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.911 | L2-Norm(final)=18.826 | 5186.5 samples/s | 81.0 steps/s
[Step=32000 Epoch=305.0] | Loss=0.00007 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.908 | L2-Norm(final)=18.826 | 1429.2 samples/s | 22.3 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08596 | acc=0.9631 | tpr=0.9716 | fpr=0.0553 | 4648.7 samples/s | 18.2 steps/s
Avg test loss: 0.09005, Avg test acc: 0.96178, Avg tpr: 0.97121, Avg fpr: 0.05897, total FA: 460

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09131 | acc=0.9590 | tpr=0.9716 | fpr=0.0684 | 4749.0 samples/s | 18.6 steps/s
Avg test loss: 0.09315, Avg test acc: 0.95757, Avg tpr: 0.97068, Avg fpr: 0.07127, total FA: 556

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08282 | acc=0.9644 | tpr=0.9750 | fpr=0.0587 | 4777.3 samples/s | 18.7 steps/s
Avg test loss: 0.08696, Avg test acc: 0.96298, Avg tpr: 0.97383, Avg fpr: 0.06089, total FA: 475

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08321 | acc=0.9641 | tpr=0.9741 | fpr=0.0575 | 4656.0 samples/s | 18.2 steps/s
Avg test loss: 0.08761, Avg test acc: 0.96350, Avg tpr: 0.97319, Avg fpr: 0.05781, total FA: 451

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.07875 | acc=0.9647 | tpr=0.9744 | fpr=0.0565 | 4684.7 samples/s | 18.3 steps/s
Avg test loss: 0.08487, Avg test acc: 0.96370, Avg tpr: 0.97389, Avg fpr: 0.05871, total FA: 458

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.22454 | acc=0.3057 | tpr=0.0135 | fpr=0.0597 | 4532.5 samples/s | 17.7 steps/s
Avg test loss: 5.23971, Avg test acc: 0.30307, Avg tpr: 0.01271, Avg fpr: 0.05833, total FA: 455

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.34376 | acc=0.2911 | tpr=0.0138 | fpr=0.1068 | 4600.3 samples/s | 18.0 steps/s
Avg test loss: 4.35390, Avg test acc: 0.28949, Avg tpr: 0.01387, Avg fpr: 0.10435, total FA: 814

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.40856 | acc=0.2863 | tpr=0.0139 | fpr=0.1224 | 4609.2 samples/s | 18.0 steps/s
Avg test loss: 5.41999, Avg test acc: 0.28660, Avg tpr: 0.01533, Avg fpr: 0.11678, total FA: 911

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.04252 | acc=0.3121 | tpr=0.0339 | fpr=0.0837 | 4797.9 samples/s | 18.7 steps/s
Avg test loss: 4.05955, Avg test acc: 0.30900, Avg tpr: 0.03392, Avg fpr: 0.08601, total FA: 671

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.72118 | acc=0.3071 | tpr=0.0082 | fpr=0.0439 | 4624.1 samples/s | 18.1 steps/s
Avg test loss: 4.74170, Avg test acc: 0.30411, Avg tpr: 0.00810, Avg fpr: 0.04487, total FA: 350

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.97391 | acc=0.1437 | tpr=0.7257 | fpr=0.8667 | 4629.6 samples/s | 18.1 steps/s
[Step= 100] | Loss=5.95231 | acc=0.1454 | tpr=0.6908 | fpr=0.8648 | 7977.0 samples/s | 31.2 steps/s
[Step= 150] | Loss=5.95908 | acc=0.1464 | tpr=0.7046 | fpr=0.8639 | 8028.1 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.94835 | acc=0.1461 | tpr=0.7082 | fpr=0.8641 | 8072.9 samples/s | 31.5 steps/s
[Step= 250] | Loss=5.94591 | acc=0.1469 | tpr=0.7031 | fpr=0.8632 | 7954.0 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.93892 | acc=0.1477 | tpr=0.7062 | fpr=0.8625 | 7835.8 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.94844 | acc=0.1472 | tpr=0.7038 | fpr=0.8629 | 7761.2 samples/s | 30.3 steps/s
[Step= 400] | Loss=5.94957 | acc=0.1473 | tpr=0.7035 | fpr=0.8628 | 7837.6 samples/s | 30.6 steps/s
[Step= 450] | Loss=5.94455 | acc=0.1473 | tpr=0.7016 | fpr=0.8628 | 8104.2 samples/s | 31.7 steps/s
[Step= 500] | Loss=5.94418 | acc=0.1476 | tpr=0.6982 | fpr=0.8623 | 7888.3 samples/s | 30.8 steps/s
[Step= 550] | Loss=5.94190 | acc=0.1480 | tpr=0.7019 | fpr=0.8621 | 10719.4 samples/s | 41.9 steps/s
Avg test loss: 5.94278, Avg test acc: 0.14784, Avg tpr: 0.70087, Avg fpr: 0.86221, total FA: 119716

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.52818 | acc=0.1401 | tpr=0.7743 | fpr=0.8713 | 4757.7 samples/s | 18.6 steps/s
[Step= 100] | Loss=5.51307 | acc=0.1418 | tpr=0.7463 | fpr=0.8694 | 7916.0 samples/s | 30.9 steps/s
[Step= 150] | Loss=5.51594 | acc=0.1430 | tpr=0.7435 | fpr=0.8680 | 7569.9 samples/s | 29.6 steps/s
[Step= 200] | Loss=5.50918 | acc=0.1431 | tpr=0.7377 | fpr=0.8677 | 8331.1 samples/s | 32.5 steps/s
[Step= 250] | Loss=5.50656 | acc=0.1441 | tpr=0.7380 | fpr=0.8667 | 8362.1 samples/s | 32.7 steps/s
[Step= 300] | Loss=5.50296 | acc=0.1445 | tpr=0.7367 | fpr=0.8663 | 7972.0 samples/s | 31.1 steps/s
[Step= 350] | Loss=5.51049 | acc=0.1441 | tpr=0.7383 | fpr=0.8667 | 7115.2 samples/s | 27.8 steps/s
[Step= 400] | Loss=5.51389 | acc=0.1437 | tpr=0.7352 | fpr=0.8671 | 8200.6 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.51191 | acc=0.1435 | tpr=0.7313 | fpr=0.8672 | 8372.2 samples/s | 32.7 steps/s
[Step= 500] | Loss=5.51330 | acc=0.1435 | tpr=0.7273 | fpr=0.8670 | 8236.2 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.51146 | acc=0.1437 | tpr=0.7322 | fpr=0.8670 | 10008.7 samples/s | 39.1 steps/s
Avg test loss: 5.51281, Avg test acc: 0.14361, Avg tpr: 0.73177, Avg fpr: 0.86708, total FA: 120393

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.07854 | acc=0.1344 | tpr=0.7611 | fpr=0.8769 | 4545.0 samples/s | 17.8 steps/s
[Step= 100] | Loss=6.05041 | acc=0.1359 | tpr=0.7228 | fpr=0.8751 | 7988.2 samples/s | 31.2 steps/s
[Step= 150] | Loss=6.05320 | acc=0.1373 | tpr=0.7363 | fpr=0.8737 | 8389.4 samples/s | 32.8 steps/s
[Step= 200] | Loss=6.03797 | acc=0.1373 | tpr=0.7311 | fpr=0.8735 | 7707.4 samples/s | 30.1 steps/s
[Step= 250] | Loss=6.03360 | acc=0.1377 | tpr=0.7319 | fpr=0.8731 | 8215.4 samples/s | 32.1 steps/s
[Step= 300] | Loss=6.02815 | acc=0.1383 | tpr=0.7338 | fpr=0.8725 | 7559.5 samples/s | 29.5 steps/s
[Step= 350] | Loss=6.03846 | acc=0.1379 | tpr=0.7326 | fpr=0.8729 | 8405.9 samples/s | 32.8 steps/s
[Step= 400] | Loss=6.04137 | acc=0.1376 | tpr=0.7319 | fpr=0.8732 | 7663.8 samples/s | 29.9 steps/s
[Step= 450] | Loss=6.03628 | acc=0.1377 | tpr=0.7283 | fpr=0.8730 | 8160.3 samples/s | 31.9 steps/s
[Step= 500] | Loss=6.03595 | acc=0.1377 | tpr=0.7256 | fpr=0.8729 | 7854.2 samples/s | 30.7 steps/s
[Step= 550] | Loss=6.03497 | acc=0.1381 | tpr=0.7294 | fpr=0.8727 | 10647.3 samples/s | 41.6 steps/s
Avg test loss: 6.03604, Avg test acc: 0.13796, Avg tpr: 0.72900, Avg fpr: 0.87278, total FA: 121184

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.07382 | acc=0.1549 | tpr=0.7212 | fpr=0.8553 | 4534.6 samples/s | 17.7 steps/s
[Step= 100] | Loss=6.03819 | acc=0.1562 | tpr=0.6994 | fpr=0.8539 | 8299.6 samples/s | 32.4 steps/s
[Step= 150] | Loss=6.04575 | acc=0.1585 | tpr=0.7089 | fpr=0.8517 | 7952.7 samples/s | 31.1 steps/s
[Step= 200] | Loss=6.03634 | acc=0.1586 | tpr=0.7016 | fpr=0.8512 | 8280.9 samples/s | 32.3 steps/s
[Step= 250] | Loss=6.03281 | acc=0.1591 | tpr=0.6961 | fpr=0.8507 | 8129.4 samples/s | 31.8 steps/s
[Step= 300] | Loss=6.02604 | acc=0.1595 | tpr=0.6975 | fpr=0.8503 | 7812.2 samples/s | 30.5 steps/s
[Step= 350] | Loss=6.03704 | acc=0.1591 | tpr=0.7019 | fpr=0.8508 | 8007.6 samples/s | 31.3 steps/s
[Step= 400] | Loss=6.03867 | acc=0.1589 | tpr=0.6997 | fpr=0.8509 | 7836.7 samples/s | 30.6 steps/s
[Step= 450] | Loss=6.03444 | acc=0.1590 | tpr=0.6967 | fpr=0.8508 | 8084.8 samples/s | 31.6 steps/s
[Step= 500] | Loss=6.03527 | acc=0.1592 | tpr=0.6943 | fpr=0.8505 | 8117.1 samples/s | 31.7 steps/s
[Step= 550] | Loss=6.03527 | acc=0.1592 | tpr=0.6960 | fpr=0.8506 | 9612.9 samples/s | 37.6 steps/s
Avg test loss: 6.03641, Avg test acc: 0.15908, Avg tpr: 0.69532, Avg fpr: 0.85067, total FA: 118114

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.86755 | acc=0.1344 | tpr=0.7699 | fpr=0.8770 | 4799.0 samples/s | 18.7 steps/s
[Step= 100] | Loss=5.84105 | acc=0.1363 | tpr=0.7399 | fpr=0.8750 | 7054.1 samples/s | 27.6 steps/s
[Step= 150] | Loss=5.84986 | acc=0.1373 | tpr=0.7392 | fpr=0.8737 | 8234.9 samples/s | 32.2 steps/s
[Step= 200] | Loss=5.84048 | acc=0.1368 | tpr=0.7355 | fpr=0.8741 | 8380.0 samples/s | 32.7 steps/s
[Step= 250] | Loss=5.83942 | acc=0.1379 | tpr=0.7319 | fpr=0.8729 | 8301.9 samples/s | 32.4 steps/s
[Step= 300] | Loss=5.83171 | acc=0.1390 | tpr=0.7353 | fpr=0.8718 | 8245.5 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.84078 | acc=0.1387 | tpr=0.7420 | fpr=0.8722 | 7598.3 samples/s | 29.7 steps/s
[Step= 400] | Loss=5.84122 | acc=0.1383 | tpr=0.7380 | fpr=0.8726 | 7531.6 samples/s | 29.4 steps/s
[Step= 450] | Loss=5.83656 | acc=0.1381 | tpr=0.7337 | fpr=0.8727 | 9006.2 samples/s | 35.2 steps/s
[Step= 500] | Loss=5.83931 | acc=0.1383 | tpr=0.7326 | fpr=0.8724 | 7333.8 samples/s | 28.6 steps/s
[Step= 550] | Loss=5.83841 | acc=0.1389 | tpr=0.7354 | fpr=0.8720 | 10370.3 samples/s | 40.5 steps/s
Avg test loss: 5.83941, Avg test acc: 0.13873, Avg tpr: 0.73455, Avg fpr: 0.87210, total FA: 121089

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19833 | acc=0.9602 | tpr=0.9469 | fpr=0.0396 | 4390.9 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.20435 | acc=0.9596 | tpr=0.9488 | fpr=0.0402 | 8158.9 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.20988 | acc=0.9586 | tpr=0.9496 | fpr=0.0413 | 8331.2 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.21074 | acc=0.9587 | tpr=0.9541 | fpr=0.0412 | 7927.5 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.21180 | acc=0.9585 | tpr=0.9537 | fpr=0.0414 | 8513.4 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.21369 | acc=0.9580 | tpr=0.9527 | fpr=0.0419 | 7987.8 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.21361 | acc=0.9577 | tpr=0.9518 | fpr=0.0422 | 8085.0 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.21512 | acc=0.9574 | tpr=0.9486 | fpr=0.0424 | 7937.5 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.21636 | acc=0.9570 | tpr=0.9450 | fpr=0.0428 | 7401.6 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.21610 | acc=0.9570 | tpr=0.9458 | fpr=0.0428 | 8313.6 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.21577 | acc=0.9572 | tpr=0.9439 | fpr=0.0426 | 10436.2 samples/s | 40.8 steps/s
Avg test loss: 0.21548, Avg test acc: 0.95721, Avg tpr: 0.94374, Avg fpr: 0.04254, total FA: 5907

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13970 | acc=0.9634 | tpr=0.9513 | fpr=0.0364 | 4687.2 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.14347 | acc=0.9631 | tpr=0.9510 | fpr=0.0367 | 7931.5 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.14626 | acc=0.9621 | tpr=0.9481 | fpr=0.0376 | 7700.6 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.14629 | acc=0.9625 | tpr=0.9541 | fpr=0.0373 | 8011.0 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.14724 | acc=0.9622 | tpr=0.9537 | fpr=0.0376 | 7592.0 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.14762 | acc=0.9620 | tpr=0.9527 | fpr=0.0379 | 8202.5 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.14741 | acc=0.9619 | tpr=0.9512 | fpr=0.0379 | 8084.6 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.14894 | acc=0.9615 | tpr=0.9497 | fpr=0.0383 | 7751.7 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.14924 | acc=0.9613 | tpr=0.9460 | fpr=0.0384 | 7737.5 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.14923 | acc=0.9614 | tpr=0.9471 | fpr=0.0384 | 8446.9 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.14910 | acc=0.9615 | tpr=0.9443 | fpr=0.0381 | 10535.5 samples/s | 41.2 steps/s
Avg test loss: 0.14878, Avg test acc: 0.96156, Avg tpr: 0.94414, Avg fpr: 0.03813, total FA: 5294

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.22376 | acc=0.9591 | tpr=0.9381 | fpr=0.0406 | 4662.1 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.23213 | acc=0.9586 | tpr=0.9403 | fpr=0.0411 | 7745.0 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.24001 | acc=0.9573 | tpr=0.9438 | fpr=0.0424 | 8215.7 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.24074 | acc=0.9572 | tpr=0.9486 | fpr=0.0426 | 8070.8 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.24218 | acc=0.9571 | tpr=0.9502 | fpr=0.0427 | 7646.9 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.24465 | acc=0.9566 | tpr=0.9484 | fpr=0.0433 | 7627.1 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.24520 | acc=0.9566 | tpr=0.9474 | fpr=0.0432 | 8852.5 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.24770 | acc=0.9562 | tpr=0.9453 | fpr=0.0436 | 7594.7 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.24894 | acc=0.9559 | tpr=0.9421 | fpr=0.0439 | 8100.3 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.24837 | acc=0.9559 | tpr=0.9432 | fpr=0.0439 | 8288.6 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.24764 | acc=0.9560 | tpr=0.9403 | fpr=0.0437 | 9742.0 samples/s | 38.1 steps/s
Avg test loss: 0.24722, Avg test acc: 0.95605, Avg tpr: 0.94057, Avg fpr: 0.04367, total FA: 6064

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.13034 | acc=0.9675 | tpr=0.9292 | fpr=0.0318 | 4602.8 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.13489 | acc=0.9671 | tpr=0.9254 | fpr=0.0321 | 7942.8 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.13832 | acc=0.9667 | tpr=0.9280 | fpr=0.0326 | 7547.9 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.13844 | acc=0.9674 | tpr=0.9366 | fpr=0.0321 | 7990.3 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.13973 | acc=0.9671 | tpr=0.9406 | fpr=0.0324 | 8201.4 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.14174 | acc=0.9666 | tpr=0.9367 | fpr=0.0329 | 7701.5 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.14268 | acc=0.9665 | tpr=0.9374 | fpr=0.0330 | 7709.9 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.14394 | acc=0.9662 | tpr=0.9322 | fpr=0.0332 | 8154.6 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.14541 | acc=0.9659 | tpr=0.9304 | fpr=0.0335 | 8014.1 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.14428 | acc=0.9660 | tpr=0.9322 | fpr=0.0333 | 8097.9 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.14398 | acc=0.9662 | tpr=0.9304 | fpr=0.0332 | 11287.8 samples/s | 44.1 steps/s
Avg test loss: 0.14362, Avg test acc: 0.96622, Avg tpr: 0.92987, Avg fpr: 0.03312, total FA: 4599

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.20079 | acc=0.9559 | tpr=0.9336 | fpr=0.0437 | 4787.1 samples/s | 18.7 steps/s
[Step= 100] | Loss=0.20653 | acc=0.9555 | tpr=0.9339 | fpr=0.0441 | 7826.3 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.21070 | acc=0.9547 | tpr=0.9366 | fpr=0.0450 | 8209.5 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.21206 | acc=0.9546 | tpr=0.9421 | fpr=0.0452 | 7749.9 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.21258 | acc=0.9544 | tpr=0.9406 | fpr=0.0453 | 7848.4 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.21444 | acc=0.9539 | tpr=0.9411 | fpr=0.0458 | 8252.7 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.21434 | acc=0.9539 | tpr=0.9424 | fpr=0.0459 | 7314.2 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.21569 | acc=0.9536 | tpr=0.9415 | fpr=0.0462 | 8358.8 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.21670 | acc=0.9534 | tpr=0.9387 | fpr=0.0464 | 8521.5 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.21688 | acc=0.9532 | tpr=0.9392 | fpr=0.0465 | 8023.6 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.21607 | acc=0.9533 | tpr=0.9375 | fpr=0.0464 | 9248.0 samples/s | 36.1 steps/s
Avg test loss: 0.21582, Avg test acc: 0.95334, Avg tpr: 0.93740, Avg fpr: 0.04637, total FA: 6438

server round 32/50

clients selected: [0 1 2 3 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=44001 Epoch=214.6] | Loss=0.01494 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.894 | L2-Norm(final)=14.020 | 3338.3 samples/s | 52.2 steps/s
[Step=44050 Epoch=214.8] | Loss=0.02258 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.894 | L2-Norm(final)=14.017 | 4548.0 samples/s | 71.1 steps/s
[Step=44100 Epoch=215.0] | Loss=0.02150 | Reg=0.00119 | acc=0.9688 | L2-Norm=10.894 | L2-Norm(final)=14.014 | 5477.8 samples/s | 85.6 steps/s
[Step=44150 Epoch=215.3] | Loss=0.02135 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.894 | L2-Norm(final)=14.012 | 5474.0 samples/s | 85.5 steps/s
[Step=44200 Epoch=215.5] | Loss=0.02060 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.894 | L2-Norm(final)=14.011 | 8523.4 samples/s | 133.2 steps/s
[Step=44250 Epoch=215.8] | Loss=0.02059 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.894 | L2-Norm(final)=14.010 | 1478.2 samples/s | 23.1 steps/s
[Step=44300 Epoch=216.0] | Loss=0.02057 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.894 | L2-Norm(final)=14.010 | 5392.8 samples/s | 84.3 steps/s
[Step=44350 Epoch=216.3] | Loss=0.02073 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.894 | L2-Norm(final)=14.009 | 5562.6 samples/s | 86.9 steps/s
[Step=44400 Epoch=216.5] | Loss=0.02003 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.894 | L2-Norm(final)=14.008 | 7320.7 samples/s | 114.4 steps/s
[Step=44450 Epoch=216.7] | Loss=0.02023 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.894 | L2-Norm(final)=14.007 | 1529.0 samples/s | 23.9 steps/s
[Step=44500 Epoch=217.0] | Loss=0.02048 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.894 | L2-Norm(final)=14.006 | 5424.8 samples/s | 84.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=44501 Epoch=217.0] | Loss=0.00793 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.894 | L2-Norm(final)=13.998 | 3244.5 samples/s | 50.7 steps/s
[Step=44550 Epoch=217.2] | Loss=0.01818 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.908 | L2-Norm(final)=13.998 | 4101.4 samples/s | 64.1 steps/s
[Step=44600 Epoch=217.5] | Loss=0.01806 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.919 | L2-Norm(final)=13.998 | 4715.3 samples/s | 73.7 steps/s
[Step=44650 Epoch=217.7] | Loss=0.01791 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.929 | L2-Norm(final)=13.999 | 4724.1 samples/s | 73.8 steps/s
[Step=44700 Epoch=218.0] | Loss=0.01680 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.938 | L2-Norm(final)=14.000 | 6678.7 samples/s | 104.4 steps/s
[Step=44750 Epoch=218.2] | Loss=0.01473 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.946 | L2-Norm(final)=14.002 | 1418.2 samples/s | 22.2 steps/s
[Step=44800 Epoch=218.5] | Loss=0.01341 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=14.005 | 4698.7 samples/s | 73.4 steps/s
[Step=44850 Epoch=218.7] | Loss=0.01235 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.958 | L2-Norm(final)=14.008 | 4721.7 samples/s | 73.8 steps/s
[Step=44900 Epoch=218.9] | Loss=0.01157 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=14.011 | 6104.9 samples/s | 95.4 steps/s
[Step=44950 Epoch=219.2] | Loss=0.01074 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.967 | L2-Norm(final)=14.013 | 1441.3 samples/s | 22.5 steps/s
[Step=45000 Epoch=219.4] | Loss=0.01005 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.971 | L2-Norm(final)=14.016 | 4672.5 samples/s | 73.0 steps/s
[Step=45050 Epoch=219.7] | Loss=0.00964 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.974 | L2-Norm(final)=14.018 | 4693.9 samples/s | 73.3 steps/s
[Step=45100 Epoch=219.9] | Loss=0.00921 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.978 | L2-Norm(final)=14.021 | 5670.8 samples/s | 88.6 steps/s
[Step=45150 Epoch=220.2] | Loss=0.00881 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.981 | L2-Norm(final)=14.023 | 1461.2 samples/s | 22.8 steps/s
[Step=45200 Epoch=220.4] | Loss=0.00846 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.984 | L2-Norm(final)=14.026 | 4683.2 samples/s | 73.2 steps/s
[Step=45250 Epoch=220.6] | Loss=0.00819 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.986 | L2-Norm(final)=14.028 | 4700.5 samples/s | 73.4 steps/s
[Step=45300 Epoch=220.9] | Loss=0.00789 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.989 | L2-Norm(final)=14.030 | 5178.6 samples/s | 80.9 steps/s
[Step=45350 Epoch=221.1] | Loss=0.00764 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.992 | L2-Norm(final)=14.033 | 1512.5 samples/s | 23.6 steps/s
[Step=45400 Epoch=221.4] | Loss=0.00736 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.994 | L2-Norm(final)=14.035 | 4759.7 samples/s | 74.4 steps/s
[Step=45450 Epoch=221.6] | Loss=0.00715 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.996 | L2-Norm(final)=14.037 | 4574.6 samples/s | 71.5 steps/s
[Step=45500 Epoch=221.9] | Loss=0.00700 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.999 | L2-Norm(final)=14.039 | 4799.6 samples/s | 75.0 steps/s
[Step=45550 Epoch=222.1] | Loss=0.00685 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.001 | L2-Norm(final)=14.041 | 1524.9 samples/s | 23.8 steps/s
[Step=45600 Epoch=222.4] | Loss=0.00670 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.003 | L2-Norm(final)=14.043 | 4732.5 samples/s | 73.9 steps/s
[Step=45650 Epoch=222.6] | Loss=0.00656 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.005 | L2-Norm(final)=14.046 | 4663.0 samples/s | 72.9 steps/s
[Step=45700 Epoch=222.8] | Loss=0.00642 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.007 | L2-Norm(final)=14.048 | 4698.4 samples/s | 73.4 steps/s
[Step=45750 Epoch=223.1] | Loss=0.00633 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.009 | L2-Norm(final)=14.050 | 1577.9 samples/s | 24.7 steps/s
[Step=45800 Epoch=223.3] | Loss=0.00617 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.011 | L2-Norm(final)=14.052 | 4693.0 samples/s | 73.3 steps/s
[Step=45850 Epoch=223.6] | Loss=0.00604 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.012 | L2-Norm(final)=14.054 | 4696.7 samples/s | 73.4 steps/s
[Step=45900 Epoch=223.8] | Loss=0.00593 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.014 | L2-Norm(final)=14.056 | 4681.2 samples/s | 73.1 steps/s
[Step=45950 Epoch=224.1] | Loss=0.00588 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=14.058 | 1543.8 samples/s | 24.1 steps/s
[Step=46000 Epoch=224.3] | Loss=0.00575 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.018 | L2-Norm(final)=14.060 | 4714.8 samples/s | 73.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_0/client_state-step46000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=28001 Epoch=136.6] | Loss=0.02346 | Reg=0.00119 | acc=0.9688 | L2-Norm=10.894 | L2-Norm(final)=12.193 | 3214.0 samples/s | 50.2 steps/s
[Step=28050 Epoch=136.9] | Loss=0.02296 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.895 | L2-Norm(final)=12.190 | 4826.3 samples/s | 75.4 steps/s
[Step=28100 Epoch=137.1] | Loss=0.02177 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.895 | L2-Norm(final)=12.190 | 5407.3 samples/s | 84.5 steps/s
[Step=28150 Epoch=137.4] | Loss=0.02003 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.895 | L2-Norm(final)=12.190 | 5590.7 samples/s | 87.4 steps/s
[Step=28200 Epoch=137.6] | Loss=0.01943 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=12.190 | 8312.6 samples/s | 129.9 steps/s
[Step=28250 Epoch=137.8] | Loss=0.01970 | Reg=0.00119 | acc=0.9688 | L2-Norm=10.895 | L2-Norm(final)=12.191 | 1467.5 samples/s | 22.9 steps/s
[Step=28300 Epoch=138.1] | Loss=0.01991 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.895 | L2-Norm(final)=12.191 | 5342.4 samples/s | 83.5 steps/s
[Step=28350 Epoch=138.3] | Loss=0.01974 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=12.190 | 5489.5 samples/s | 85.8 steps/s
[Step=28400 Epoch=138.6] | Loss=0.01945 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=12.190 | 7649.0 samples/s | 119.5 steps/s
[Step=28450 Epoch=138.8] | Loss=0.01975 | Reg=0.00119 | acc=0.9688 | L2-Norm=10.895 | L2-Norm(final)=12.190 | 1502.3 samples/s | 23.5 steps/s
[Step=28500 Epoch=139.1] | Loss=0.01987 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=12.190 | 5425.3 samples/s | 84.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=28501 Epoch=139.1] | Loss=0.03353 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.895 | L2-Norm(final)=12.185 | 3267.8 samples/s | 51.1 steps/s
[Step=28550 Epoch=139.3] | Loss=0.01695 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.904 | L2-Norm(final)=12.184 | 4045.8 samples/s | 63.2 steps/s
[Step=28600 Epoch=139.6] | Loss=0.01903 | Reg=0.00119 | acc=0.9688 | L2-Norm=10.916 | L2-Norm(final)=12.183 | 4749.3 samples/s | 74.2 steps/s
[Step=28650 Epoch=139.8] | Loss=0.01910 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.927 | L2-Norm(final)=12.182 | 4644.0 samples/s | 72.6 steps/s
[Step=28700 Epoch=140.0] | Loss=0.01822 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.936 | L2-Norm(final)=12.183 | 6787.5 samples/s | 106.1 steps/s
[Step=28750 Epoch=140.3] | Loss=0.01580 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.944 | L2-Norm(final)=12.185 | 1395.1 samples/s | 21.8 steps/s
[Step=28800 Epoch=140.5] | Loss=0.01435 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=12.188 | 4680.6 samples/s | 73.1 steps/s
[Step=28850 Epoch=140.8] | Loss=0.01294 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.959 | L2-Norm(final)=12.192 | 4693.0 samples/s | 73.3 steps/s
[Step=28900 Epoch=141.0] | Loss=0.01195 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.965 | L2-Norm(final)=12.195 | 6267.2 samples/s | 97.9 steps/s
[Step=28950 Epoch=141.3] | Loss=0.01108 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.970 | L2-Norm(final)=12.199 | 1459.1 samples/s | 22.8 steps/s
[Step=29000 Epoch=141.5] | Loss=0.01040 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.974 | L2-Norm(final)=12.202 | 4648.4 samples/s | 72.6 steps/s
[Step=29050 Epoch=141.8] | Loss=0.00979 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.979 | L2-Norm(final)=12.206 | 4666.8 samples/s | 72.9 steps/s
[Step=29100 Epoch=142.0] | Loss=0.00947 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.983 | L2-Norm(final)=12.209 | 5809.9 samples/s | 90.8 steps/s
[Step=29150 Epoch=142.2] | Loss=0.00898 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.986 | L2-Norm(final)=12.212 | 1441.1 samples/s | 22.5 steps/s
[Step=29200 Epoch=142.5] | Loss=0.00859 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.990 | L2-Norm(final)=12.215 | 4768.0 samples/s | 74.5 steps/s
[Step=29250 Epoch=142.7] | Loss=0.00828 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.993 | L2-Norm(final)=12.217 | 4624.0 samples/s | 72.3 steps/s
[Step=29300 Epoch=143.0] | Loss=0.00794 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.996 | L2-Norm(final)=12.220 | 5459.1 samples/s | 85.3 steps/s
[Step=29350 Epoch=143.2] | Loss=0.00762 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.999 | L2-Norm(final)=12.223 | 1504.0 samples/s | 23.5 steps/s
[Step=29400 Epoch=143.5] | Loss=0.00737 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.002 | L2-Norm(final)=12.226 | 4677.8 samples/s | 73.1 steps/s
[Step=29450 Epoch=143.7] | Loss=0.00722 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.005 | L2-Norm(final)=12.229 | 4710.5 samples/s | 73.6 steps/s
[Step=29500 Epoch=143.9] | Loss=0.00700 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.008 | L2-Norm(final)=12.232 | 5075.9 samples/s | 79.3 steps/s
[Step=29550 Epoch=144.2] | Loss=0.00682 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.010 | L2-Norm(final)=12.235 | 1502.2 samples/s | 23.5 steps/s
[Step=29600 Epoch=144.4] | Loss=0.00670 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.013 | L2-Norm(final)=12.237 | 4662.0 samples/s | 72.8 steps/s
[Step=29650 Epoch=144.7] | Loss=0.00649 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.015 | L2-Norm(final)=12.240 | 4616.6 samples/s | 72.1 steps/s
[Step=29700 Epoch=144.9] | Loss=0.00633 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.018 | L2-Norm(final)=12.243 | 4798.5 samples/s | 75.0 steps/s
[Step=29750 Epoch=145.2] | Loss=0.00616 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=12.245 | 1557.4 samples/s | 24.3 steps/s
[Step=29800 Epoch=145.4] | Loss=0.00602 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.022 | L2-Norm(final)=12.248 | 4608.9 samples/s | 72.0 steps/s
[Step=29850 Epoch=145.7] | Loss=0.00590 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=12.251 | 4693.3 samples/s | 73.3 steps/s
[Step=29900 Epoch=145.9] | Loss=0.00579 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.026 | L2-Norm(final)=12.253 | 4791.1 samples/s | 74.9 steps/s
[Step=29950 Epoch=146.1] | Loss=0.00563 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.029 | L2-Norm(final)=12.256 | 1532.7 samples/s | 23.9 steps/s
[Step=30000 Epoch=146.4] | Loss=0.00553 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.031 | L2-Norm(final)=12.259 | 4651.0 samples/s | 72.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_1/client_state-step30000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=18001 Epoch=87.7] | Loss=0.01041 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.894 | L2-Norm(final)=11.161 | 3272.5 samples/s | 51.1 steps/s
[Step=18050 Epoch=87.9] | Loss=0.01775 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.894 | L2-Norm(final)=11.162 | 4543.8 samples/s | 71.0 steps/s
[Step=18100 Epoch=88.2] | Loss=0.02137 | Reg=0.00119 | acc=0.9688 | L2-Norm=10.895 | L2-Norm(final)=11.157 | 5604.7 samples/s | 87.6 steps/s
[Step=18150 Epoch=88.4] | Loss=0.02169 | Reg=0.00119 | acc=0.9531 | L2-Norm=10.895 | L2-Norm(final)=11.153 | 5402.3 samples/s | 84.4 steps/s
[Step=18200 Epoch=88.7] | Loss=0.02114 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.895 | L2-Norm(final)=11.150 | 8432.0 samples/s | 131.7 steps/s
[Step=18250 Epoch=88.9] | Loss=0.02141 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.895 | L2-Norm(final)=11.148 | 1488.3 samples/s | 23.3 steps/s
[Step=18300 Epoch=89.2] | Loss=0.02136 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=11.147 | 5522.1 samples/s | 86.3 steps/s
[Step=18350 Epoch=89.4] | Loss=0.02105 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.895 | L2-Norm(final)=11.146 | 5374.0 samples/s | 84.0 steps/s
[Step=18400 Epoch=89.7] | Loss=0.02066 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=11.146 | 7545.5 samples/s | 117.9 steps/s
[Step=18450 Epoch=89.9] | Loss=0.02093 | Reg=0.00119 | acc=0.9531 | L2-Norm=10.895 | L2-Norm(final)=11.146 | 1536.8 samples/s | 24.0 steps/s
[Step=18500 Epoch=90.1] | Loss=0.02113 | Reg=0.00119 | acc=0.9375 | L2-Norm=10.895 | L2-Norm(final)=11.146 | 5397.7 samples/s | 84.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=18501 Epoch=90.1] | Loss=0.01859 | Reg=0.00119 | acc=0.9688 | L2-Norm=10.895 | L2-Norm(final)=11.144 | 3201.0 samples/s | 50.0 steps/s
[Step=18550 Epoch=90.4] | Loss=0.01740 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.909 | L2-Norm(final)=11.144 | 4202.1 samples/s | 65.7 steps/s
[Step=18600 Epoch=90.6] | Loss=0.01791 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.926 | L2-Norm(final)=11.145 | 4714.7 samples/s | 73.7 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01664 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.938 | L2-Norm(final)=11.147 | 4705.4 samples/s | 73.5 steps/s
[Step=18700 Epoch=91.1] | Loss=0.01616 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.949 | L2-Norm(final)=11.150 | 6757.5 samples/s | 105.6 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01453 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=11.153 | 1433.5 samples/s | 22.4 steps/s
[Step=18800 Epoch=91.6] | Loss=0.01326 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.964 | L2-Norm(final)=11.156 | 4761.5 samples/s | 74.4 steps/s
[Step=18850 Epoch=91.8] | Loss=0.01238 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.970 | L2-Norm(final)=11.159 | 4643.5 samples/s | 72.6 steps/s
[Step=18900 Epoch=92.1] | Loss=0.01170 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.977 | L2-Norm(final)=11.163 | 6163.9 samples/s | 96.3 steps/s
[Step=18950 Epoch=92.3] | Loss=0.01114 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.982 | L2-Norm(final)=11.166 | 1439.5 samples/s | 22.5 steps/s
[Step=19000 Epoch=92.6] | Loss=0.01058 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.987 | L2-Norm(final)=11.169 | 4706.3 samples/s | 73.5 steps/s
[Step=19050 Epoch=92.8] | Loss=0.00993 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.992 | L2-Norm(final)=11.172 | 4703.6 samples/s | 73.5 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00948 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.996 | L2-Norm(final)=11.176 | 5640.7 samples/s | 88.1 steps/s
[Step=19150 Epoch=93.3] | Loss=0.00901 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.001 | L2-Norm(final)=11.179 | 1503.9 samples/s | 23.5 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00872 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.005 | L2-Norm(final)=11.182 | 4681.8 samples/s | 73.2 steps/s
[Step=19250 Epoch=93.8] | Loss=0.00836 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.009 | L2-Norm(final)=11.185 | 4687.3 samples/s | 73.2 steps/s
[Step=19300 Epoch=94.0] | Loss=0.00824 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.012 | L2-Norm(final)=11.188 | 5198.5 samples/s | 81.2 steps/s
[Step=19350 Epoch=94.3] | Loss=0.00805 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=11.191 | 1487.3 samples/s | 23.2 steps/s
[Step=19400 Epoch=94.5] | Loss=0.00776 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=11.194 | 4727.5 samples/s | 73.9 steps/s
[Step=19450 Epoch=94.8] | Loss=0.00752 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=11.197 | 4710.9 samples/s | 73.6 steps/s
[Step=19500 Epoch=95.0] | Loss=0.00739 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.025 | L2-Norm(final)=11.199 | 4789.9 samples/s | 74.8 steps/s
[Step=19550 Epoch=95.3] | Loss=0.00718 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.028 | L2-Norm(final)=11.202 | 1552.8 samples/s | 24.3 steps/s
[Step=19600 Epoch=95.5] | Loss=0.00703 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.031 | L2-Norm(final)=11.205 | 4668.3 samples/s | 72.9 steps/s
[Step=19650 Epoch=95.7] | Loss=0.00693 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.034 | L2-Norm(final)=11.207 | 4701.9 samples/s | 73.5 steps/s
[Step=19700 Epoch=96.0] | Loss=0.00678 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.037 | L2-Norm(final)=11.210 | 4689.1 samples/s | 73.3 steps/s
[Step=19750 Epoch=96.2] | Loss=0.00665 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.040 | L2-Norm(final)=11.212 | 1545.5 samples/s | 24.1 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00650 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.042 | L2-Norm(final)=11.215 | 4696.2 samples/s | 73.4 steps/s
[Step=19850 Epoch=96.7] | Loss=0.00637 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.045 | L2-Norm(final)=11.217 | 4753.2 samples/s | 74.3 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00627 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.048 | L2-Norm(final)=11.220 | 4655.9 samples/s | 72.7 steps/s
[Step=19950 Epoch=97.2] | Loss=0.00620 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.050 | L2-Norm(final)=11.222 | 1584.2 samples/s | 24.8 steps/s
[Step=20000 Epoch=97.4] | Loss=0.00611 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.053 | L2-Norm(final)=11.225 | 4686.5 samples/s | 73.2 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_2/client_state-step20000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=36001 Epoch=175.6] | Loss=0.00760 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.894 | L2-Norm(final)=14.871 | 3129.7 samples/s | 48.9 steps/s
[Step=36050 Epoch=175.8] | Loss=0.02134 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.894 | L2-Norm(final)=14.872 | 4943.8 samples/s | 77.2 steps/s
[Step=36100 Epoch=176.0] | Loss=0.02073 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.895 | L2-Norm(final)=14.874 | 5603.5 samples/s | 87.6 steps/s
[Step=36150 Epoch=176.3] | Loss=0.02091 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=14.874 | 5388.0 samples/s | 84.2 steps/s
[Step=36200 Epoch=176.5] | Loss=0.02111 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=14.874 | 8491.5 samples/s | 132.7 steps/s
[Step=36250 Epoch=176.8] | Loss=0.02090 | Reg=0.00119 | acc=0.9531 | L2-Norm=10.895 | L2-Norm(final)=14.875 | 1475.6 samples/s | 23.1 steps/s
[Step=36300 Epoch=177.0] | Loss=0.02076 | Reg=0.00119 | acc=0.9688 | L2-Norm=10.895 | L2-Norm(final)=14.876 | 5394.4 samples/s | 84.3 steps/s
[Step=36350 Epoch=177.3] | Loss=0.02019 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=14.876 | 5608.6 samples/s | 87.6 steps/s
[Step=36400 Epoch=177.5] | Loss=0.02037 | Reg=0.00119 | acc=0.9688 | L2-Norm=10.895 | L2-Norm(final)=14.877 | 7366.1 samples/s | 115.1 steps/s
[Step=36450 Epoch=177.8] | Loss=0.02007 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=14.878 | 1506.9 samples/s | 23.5 steps/s
[Step=36500 Epoch=178.0] | Loss=0.02040 | Reg=0.00119 | acc=0.9531 | L2-Norm=10.895 | L2-Norm(final)=14.878 | 5514.0 samples/s | 86.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=178.0] | Loss=0.02197 | Reg=0.00119 | acc=0.9688 | L2-Norm=10.895 | L2-Norm(final)=14.878 | 3162.3 samples/s | 49.4 steps/s
[Step=36550 Epoch=178.2] | Loss=0.02060 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.908 | L2-Norm(final)=14.875 | 4291.8 samples/s | 67.1 steps/s
[Step=36600 Epoch=178.5] | Loss=0.01995 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.921 | L2-Norm(final)=14.874 | 4722.5 samples/s | 73.8 steps/s
[Step=36650 Epoch=178.7] | Loss=0.01767 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.932 | L2-Norm(final)=14.874 | 4679.2 samples/s | 73.1 steps/s
[Step=36700 Epoch=179.0] | Loss=0.01633 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.941 | L2-Norm(final)=14.875 | 6759.8 samples/s | 105.6 steps/s
[Step=36750 Epoch=179.2] | Loss=0.01461 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.949 | L2-Norm(final)=14.877 | 1414.3 samples/s | 22.1 steps/s
[Step=36800 Epoch=179.5] | Loss=0.01313 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=14.879 | 4697.9 samples/s | 73.4 steps/s
[Step=36850 Epoch=179.7] | Loss=0.01200 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.963 | L2-Norm(final)=14.882 | 4712.3 samples/s | 73.6 steps/s
[Step=36900 Epoch=179.9] | Loss=0.01128 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.968 | L2-Norm(final)=14.884 | 6086.5 samples/s | 95.1 steps/s
[Step=36950 Epoch=180.2] | Loss=0.01046 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.973 | L2-Norm(final)=14.887 | 1457.1 samples/s | 22.8 steps/s
[Step=37000 Epoch=180.4] | Loss=0.00989 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.978 | L2-Norm(final)=14.890 | 4696.9 samples/s | 73.4 steps/s
[Step=37050 Epoch=180.7] | Loss=0.00936 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.982 | L2-Norm(final)=14.892 | 4696.9 samples/s | 73.4 steps/s
[Step=37100 Epoch=180.9] | Loss=0.00885 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.986 | L2-Norm(final)=14.895 | 5638.6 samples/s | 88.1 steps/s
[Step=37150 Epoch=181.2] | Loss=0.00835 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.989 | L2-Norm(final)=14.897 | 1451.0 samples/s | 22.7 steps/s
[Step=37200 Epoch=181.4] | Loss=0.00801 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.993 | L2-Norm(final)=14.899 | 4675.4 samples/s | 73.1 steps/s
[Step=37250 Epoch=181.7] | Loss=0.00765 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.996 | L2-Norm(final)=14.902 | 4698.8 samples/s | 73.4 steps/s
[Step=37300 Epoch=181.9] | Loss=0.00754 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.999 | L2-Norm(final)=14.904 | 5166.8 samples/s | 80.7 steps/s
[Step=37350 Epoch=182.1] | Loss=0.00723 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.002 | L2-Norm(final)=14.906 | 1492.3 samples/s | 23.3 steps/s
[Step=37400 Epoch=182.4] | Loss=0.00700 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.004 | L2-Norm(final)=14.908 | 4751.1 samples/s | 74.2 steps/s
[Step=37450 Epoch=182.6] | Loss=0.00674 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.007 | L2-Norm(final)=14.910 | 4648.9 samples/s | 72.6 steps/s
[Step=37500 Epoch=182.9] | Loss=0.00657 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.010 | L2-Norm(final)=14.913 | 4797.3 samples/s | 75.0 steps/s
[Step=37550 Epoch=183.1] | Loss=0.00639 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.012 | L2-Norm(final)=14.915 | 1536.2 samples/s | 24.0 steps/s
[Step=37600 Epoch=183.4] | Loss=0.00622 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.014 | L2-Norm(final)=14.917 | 4664.2 samples/s | 72.9 steps/s
[Step=37650 Epoch=183.6] | Loss=0.00606 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=14.919 | 4670.3 samples/s | 73.0 steps/s
[Step=37700 Epoch=183.8] | Loss=0.00595 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=14.921 | 4720.6 samples/s | 73.8 steps/s
[Step=37750 Epoch=184.1] | Loss=0.00581 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.021 | L2-Norm(final)=14.923 | 1549.7 samples/s | 24.2 steps/s
[Step=37800 Epoch=184.3] | Loss=0.00565 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.023 | L2-Norm(final)=14.925 | 4690.7 samples/s | 73.3 steps/s
[Step=37850 Epoch=184.6] | Loss=0.00556 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.025 | L2-Norm(final)=14.927 | 4651.5 samples/s | 72.7 steps/s
[Step=37900 Epoch=184.8] | Loss=0.00543 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.027 | L2-Norm(final)=14.929 | 4699.5 samples/s | 73.4 steps/s
[Step=37950 Epoch=185.1] | Loss=0.00536 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.029 | L2-Norm(final)=14.931 | 1585.8 samples/s | 24.8 steps/s
[Step=38000 Epoch=185.3] | Loss=0.00529 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.030 | L2-Norm(final)=14.933 | 4782.8 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_asml1_3/client_state-step38000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=305.0] | Loss=0.00059 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.894 | L2-Norm(final)=18.832 | 3234.8 samples/s | 50.5 steps/s
[Step=32050 Epoch=305.5] | Loss=0.00057 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=18.839 | 4396.9 samples/s | 68.7 steps/s
[Step=32100 Epoch=305.9] | Loss=0.00071 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=18.848 | 8233.5 samples/s | 128.6 steps/s
[Step=32150 Epoch=306.4] | Loss=0.00065 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=18.856 | 1453.8 samples/s | 22.7 steps/s
[Step=32200 Epoch=306.9] | Loss=0.00071 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=18.863 | 7509.5 samples/s | 117.3 steps/s
[Step=32250 Epoch=307.4] | Loss=0.00072 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=18.871 | 1450.0 samples/s | 22.7 steps/s
[Step=32300 Epoch=307.8] | Loss=0.00068 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=18.878 | 6753.0 samples/s | 105.5 steps/s
[Step=32350 Epoch=308.3] | Loss=0.00066 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=18.885 | 1491.3 samples/s | 23.3 steps/s
[Step=32400 Epoch=308.8] | Loss=0.00069 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=18.892 | 5898.5 samples/s | 92.2 steps/s
[Step=32450 Epoch=309.3] | Loss=0.00068 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=18.899 | 1545.5 samples/s | 24.1 steps/s
[Step=32500 Epoch=309.8] | Loss=0.00068 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=18.905 | 5730.8 samples/s | 89.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=309.8] | Loss=0.00152 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=18.969 | 3270.0 samples/s | 51.1 steps/s
[Step=32550 Epoch=310.2] | Loss=0.00032 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.901 | L2-Norm(final)=18.974 | 3855.9 samples/s | 60.2 steps/s
[Step=32600 Epoch=310.7] | Loss=0.00024 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.904 | L2-Norm(final)=18.977 | 6542.4 samples/s | 102.2 steps/s
[Step=32650 Epoch=311.2] | Loss=0.00017 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.903 | L2-Norm(final)=18.978 | 1393.2 samples/s | 21.8 steps/s
[Step=32700 Epoch=311.7] | Loss=0.00013 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.901 | L2-Norm(final)=18.979 | 6033.4 samples/s | 94.3 steps/s
[Step=32750 Epoch=312.1] | Loss=0.00010 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.897 | L2-Norm(final)=18.980 | 1415.5 samples/s | 22.1 steps/s
[Step=32800 Epoch=312.6] | Loss=0.00009 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=18.980 | 5614.2 samples/s | 87.7 steps/s
[Step=32850 Epoch=313.1] | Loss=0.00008 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.888 | L2-Norm(final)=18.981 | 1419.3 samples/s | 22.2 steps/s
[Step=32900 Epoch=313.6] | Loss=0.00007 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.884 | L2-Norm(final)=18.981 | 5186.5 samples/s | 81.0 steps/s
[Step=32950 Epoch=314.0] | Loss=0.00006 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.879 | L2-Norm(final)=18.981 | 1465.7 samples/s | 22.9 steps/s
[Step=33000 Epoch=314.5] | Loss=0.00005 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.874 | L2-Norm(final)=18.982 | 4880.4 samples/s | 76.3 steps/s
[Step=33050 Epoch=315.0] | Loss=0.00005 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.870 | L2-Norm(final)=18.982 | 1491.5 samples/s | 23.3 steps/s
[Step=33100 Epoch=315.5] | Loss=0.00005 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.865 | L2-Norm(final)=18.982 | 4515.6 samples/s | 70.6 steps/s
[Step=33150 Epoch=315.9] | Loss=0.00004 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.860 | L2-Norm(final)=18.983 | 1506.1 samples/s | 23.5 steps/s
[Step=33200 Epoch=316.4] | Loss=0.00004 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.854 | L2-Norm(final)=18.983 | 4532.4 samples/s | 70.8 steps/s
[Step=33250 Epoch=316.9] | Loss=0.00004 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.849 | L2-Norm(final)=18.983 | 1564.9 samples/s | 24.5 steps/s
[Step=33300 Epoch=317.4] | Loss=0.00004 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.844 | L2-Norm(final)=18.983 | 4396.1 samples/s | 68.7 steps/s
[Step=33350 Epoch=317.9] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.839 | L2-Norm(final)=18.984 | 1538.3 samples/s | 24.0 steps/s
[Step=33400 Epoch=318.3] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.833 | L2-Norm(final)=18.984 | 4447.1 samples/s | 69.5 steps/s
[Step=33450 Epoch=318.8] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.828 | L2-Norm(final)=18.984 | 1549.2 samples/s | 24.2 steps/s
[Step=33500 Epoch=319.3] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.823 | L2-Norm(final)=18.984 | 4539.8 samples/s | 70.9 steps/s
[Step=33550 Epoch=319.8] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.817 | L2-Norm(final)=18.985 | 7096.0 samples/s | 110.9 steps/s
[Step=33600 Epoch=320.2] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.812 | L2-Norm(final)=18.985 | 1357.0 samples/s | 21.2 steps/s
[Step=33650 Epoch=320.7] | Loss=0.00003 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.806 | L2-Norm(final)=18.985 | 6524.6 samples/s | 101.9 steps/s
[Step=33700 Epoch=321.2] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.800 | L2-Norm(final)=18.985 | 1393.4 samples/s | 21.8 steps/s
[Step=33750 Epoch=321.7] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.794 | L2-Norm(final)=18.985 | 6044.4 samples/s | 94.4 steps/s
[Step=33800 Epoch=322.1] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.789 | L2-Norm(final)=18.986 | 1400.5 samples/s | 21.9 steps/s
[Step=33850 Epoch=322.6] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.783 | L2-Norm(final)=18.986 | 5613.4 samples/s | 87.7 steps/s
[Step=33900 Epoch=323.1] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.777 | L2-Norm(final)=18.986 | 1425.4 samples/s | 22.3 steps/s
[Step=33950 Epoch=323.6] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.771 | L2-Norm(final)=18.986 | 5247.2 samples/s | 82.0 steps/s
[Step=34000 Epoch=324.1] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.765 | L2-Norm(final)=18.987 | 1458.5 samples/s | 22.8 steps/s
Client model saved at models/model-local_fc2-a5i5-sel0.5-ch14/client_iccad2012_4/client_state-step34000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08601 | acc=0.9636 | tpr=0.9725 | fpr=0.0557 | 4698.2 samples/s | 18.4 steps/s
Avg test loss: 0.08925, Avg test acc: 0.96318, Avg tpr: 0.97301, Avg fpr: 0.05845, total FA: 456

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08731 | acc=0.9636 | tpr=0.9751 | fpr=0.0614 | 4611.4 samples/s | 18.0 steps/s
Avg test loss: 0.09013, Avg test acc: 0.96222, Avg tpr: 0.97400, Avg fpr: 0.06371, total FA: 497

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08452 | acc=0.9645 | tpr=0.9783 | fpr=0.0657 | 4336.5 samples/s | 16.9 steps/s
Avg test loss: 0.08892, Avg test acc: 0.96346, Avg tpr: 0.97727, Avg fpr: 0.06691, total FA: 522

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08645 | acc=0.9639 | tpr=0.9744 | fpr=0.0590 | 4592.7 samples/s | 17.9 steps/s
Avg test loss: 0.08958, Avg test acc: 0.96342, Avg tpr: 0.97348, Avg fpr: 0.05871, total FA: 458

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.07875 | acc=0.9647 | tpr=0.9744 | fpr=0.0565 | 4627.4 samples/s | 18.1 steps/s
Avg test loss: 0.08487, Avg test acc: 0.96370, Avg tpr: 0.97389, Avg fpr: 0.05871, total FA: 458

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.22454 | acc=0.3057 | tpr=0.0135 | fpr=0.0597 | 4659.8 samples/s | 18.2 steps/s
Avg test loss: 5.23971, Avg test acc: 0.30307, Avg tpr: 0.01271, Avg fpr: 0.05833, total FA: 455

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.34376 | acc=0.2911 | tpr=0.0138 | fpr=0.1068 | 4414.1 samples/s | 17.2 steps/s
Avg test loss: 4.35390, Avg test acc: 0.28949, Avg tpr: 0.01387, Avg fpr: 0.10435, total FA: 814

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.40856 | acc=0.2863 | tpr=0.0139 | fpr=0.1224 | 4791.7 samples/s | 18.7 steps/s
Avg test loss: 5.41999, Avg test acc: 0.28660, Avg tpr: 0.01533, Avg fpr: 0.11678, total FA: 911

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.04252 | acc=0.3121 | tpr=0.0339 | fpr=0.0837 | 4863.7 samples/s | 19.0 steps/s
Avg test loss: 4.05955, Avg test acc: 0.30900, Avg tpr: 0.03392, Avg fpr: 0.08601, total FA: 671

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.89511 | acc=0.3062 | tpr=0.0081 | fpr=0.0466 | 4715.5 samples/s | 18.4 steps/s
Avg test loss: 4.91051, Avg test acc: 0.30315, Avg tpr: 0.00851, Avg fpr: 0.04884, total FA: 381

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.96541 | acc=0.1449 | tpr=0.6903 | fpr=0.8649 | 4743.8 samples/s | 18.5 steps/s
[Step= 100] | Loss=5.93717 | acc=0.1483 | tpr=0.6588 | fpr=0.8612 | 7217.0 samples/s | 28.2 steps/s
[Step= 150] | Loss=5.94334 | acc=0.1500 | tpr=0.6686 | fpr=0.8595 | 8121.4 samples/s | 31.7 steps/s
[Step= 200] | Loss=5.93220 | acc=0.1496 | tpr=0.6689 | fpr=0.8599 | 7253.1 samples/s | 28.3 steps/s
[Step= 250] | Loss=5.92905 | acc=0.1504 | tpr=0.6734 | fpr=0.8591 | 8602.1 samples/s | 33.6 steps/s
[Step= 300] | Loss=5.92202 | acc=0.1514 | tpr=0.6778 | fpr=0.8582 | 8189.9 samples/s | 32.0 steps/s
[Step= 350] | Loss=5.93152 | acc=0.1509 | tpr=0.6763 | fpr=0.8586 | 8240.1 samples/s | 32.2 steps/s
[Step= 400] | Loss=5.93304 | acc=0.1508 | tpr=0.6756 | fpr=0.8587 | 6975.7 samples/s | 27.2 steps/s
[Step= 450] | Loss=5.92824 | acc=0.1508 | tpr=0.6733 | fpr=0.8587 | 8354.5 samples/s | 32.6 steps/s
[Step= 500] | Loss=5.92765 | acc=0.1511 | tpr=0.6700 | fpr=0.8583 | 8526.0 samples/s | 33.3 steps/s
[Step= 550] | Loss=5.92602 | acc=0.1516 | tpr=0.6733 | fpr=0.8579 | 11003.5 samples/s | 43.0 steps/s
Avg test loss: 5.92699, Avg test acc: 0.15142, Avg tpr: 0.67274, Avg fpr: 0.85805, total FA: 119139

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.98865 | acc=0.1373 | tpr=0.7788 | fpr=0.8743 | 4637.4 samples/s | 18.1 steps/s
[Step= 100] | Loss=5.97451 | acc=0.1406 | tpr=0.7548 | fpr=0.8709 | 8417.2 samples/s | 32.9 steps/s
[Step= 150] | Loss=5.98070 | acc=0.1418 | tpr=0.7695 | fpr=0.8697 | 7619.2 samples/s | 29.8 steps/s
[Step= 200] | Loss=5.97228 | acc=0.1420 | tpr=0.7585 | fpr=0.8692 | 7408.8 samples/s | 28.9 steps/s
[Step= 250] | Loss=5.96841 | acc=0.1427 | tpr=0.7555 | fpr=0.8684 | 7868.6 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.96473 | acc=0.1430 | tpr=0.7498 | fpr=0.8681 | 8391.7 samples/s | 32.8 steps/s
[Step= 350] | Loss=5.97346 | acc=0.1426 | tpr=0.7520 | fpr=0.8684 | 7540.5 samples/s | 29.5 steps/s
[Step= 400] | Loss=5.97634 | acc=0.1424 | tpr=0.7516 | fpr=0.8687 | 8027.3 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.97246 | acc=0.1422 | tpr=0.7468 | fpr=0.8687 | 8511.7 samples/s | 33.2 steps/s
[Step= 500] | Loss=5.97374 | acc=0.1424 | tpr=0.7436 | fpr=0.8684 | 8109.9 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.97222 | acc=0.1425 | tpr=0.7493 | fpr=0.8685 | 10544.9 samples/s | 41.2 steps/s
Avg test loss: 5.97324, Avg test acc: 0.14246, Avg tpr: 0.74921, Avg fpr: 0.86857, total FA: 120599

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.33328 | acc=0.1290 | tpr=0.7876 | fpr=0.8829 | 4705.3 samples/s | 18.4 steps/s
[Step= 100] | Loss=6.30194 | acc=0.1308 | tpr=0.7527 | fpr=0.8808 | 8567.4 samples/s | 33.5 steps/s
[Step= 150] | Loss=6.30711 | acc=0.1323 | tpr=0.7666 | fpr=0.8794 | 7868.1 samples/s | 30.7 steps/s
[Step= 200] | Loss=6.29386 | acc=0.1320 | tpr=0.7607 | fpr=0.8795 | 7568.4 samples/s | 29.6 steps/s
[Step= 250] | Loss=6.28863 | acc=0.1328 | tpr=0.7598 | fpr=0.8787 | 8126.9 samples/s | 31.7 steps/s
[Step= 300] | Loss=6.28374 | acc=0.1332 | tpr=0.7600 | fpr=0.8782 | 7874.6 samples/s | 30.8 steps/s
[Step= 350] | Loss=6.29419 | acc=0.1328 | tpr=0.7564 | fpr=0.8785 | 8104.6 samples/s | 31.7 steps/s
[Step= 400] | Loss=6.29737 | acc=0.1325 | tpr=0.7549 | fpr=0.8788 | 7796.8 samples/s | 30.5 steps/s
[Step= 450] | Loss=6.29303 | acc=0.1327 | tpr=0.7522 | fpr=0.8785 | 8562.1 samples/s | 33.4 steps/s
[Step= 500] | Loss=6.29278 | acc=0.1329 | tpr=0.7507 | fpr=0.8783 | 8079.7 samples/s | 31.6 steps/s
[Step= 550] | Loss=6.29161 | acc=0.1331 | tpr=0.7533 | fpr=0.8781 | 9301.6 samples/s | 36.3 steps/s
Avg test loss: 6.29258, Avg test acc: 0.13301, Avg tpr: 0.75238, Avg fpr: 0.87825, total FA: 121943

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=6.35642 | acc=0.1449 | tpr=0.7832 | fpr=0.8666 | 4714.0 samples/s | 18.4 steps/s
[Step= 100] | Loss=6.32546 | acc=0.1472 | tpr=0.7868 | fpr=0.8647 | 7849.3 samples/s | 30.7 steps/s
[Step= 150] | Loss=6.33110 | acc=0.1489 | tpr=0.7911 | fpr=0.8629 | 7151.7 samples/s | 27.9 steps/s
[Step= 200] | Loss=6.32065 | acc=0.1491 | tpr=0.7803 | fpr=0.8624 | 8086.9 samples/s | 31.6 steps/s
[Step= 250] | Loss=6.31905 | acc=0.1498 | tpr=0.7790 | fpr=0.8617 | 8168.8 samples/s | 31.9 steps/s
[Step= 300] | Loss=6.31284 | acc=0.1502 | tpr=0.7818 | fpr=0.8613 | 7474.8 samples/s | 29.2 steps/s
[Step= 350] | Loss=6.32383 | acc=0.1497 | tpr=0.7846 | fpr=0.8618 | 8403.2 samples/s | 32.8 steps/s
[Step= 400] | Loss=6.32590 | acc=0.1494 | tpr=0.7823 | fpr=0.8621 | 8187.9 samples/s | 32.0 steps/s
[Step= 450] | Loss=6.32119 | acc=0.1494 | tpr=0.7770 | fpr=0.8620 | 7796.1 samples/s | 30.5 steps/s
[Step= 500] | Loss=6.32198 | acc=0.1494 | tpr=0.7762 | fpr=0.8619 | 7837.3 samples/s | 30.6 steps/s
[Step= 550] | Loss=6.32111 | acc=0.1498 | tpr=0.7776 | fpr=0.8616 | 11950.3 samples/s | 46.7 steps/s
Avg test loss: 6.32218, Avg test acc: 0.14971, Avg tpr: 0.77734, Avg fpr: 0.86170, total FA: 119645

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.86755 | acc=0.1344 | tpr=0.7699 | fpr=0.8770 | 4687.6 samples/s | 18.3 steps/s
[Step= 100] | Loss=5.84105 | acc=0.1363 | tpr=0.7399 | fpr=0.8750 | 8057.5 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.84986 | acc=0.1373 | tpr=0.7392 | fpr=0.8737 | 7293.4 samples/s | 28.5 steps/s
[Step= 200] | Loss=5.84048 | acc=0.1368 | tpr=0.7355 | fpr=0.8741 | 7956.4 samples/s | 31.1 steps/s
[Step= 250] | Loss=5.83942 | acc=0.1379 | tpr=0.7319 | fpr=0.8729 | 7871.4 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.83171 | acc=0.1390 | tpr=0.7353 | fpr=0.8718 | 7848.5 samples/s | 30.7 steps/s
[Step= 350] | Loss=5.84078 | acc=0.1387 | tpr=0.7420 | fpr=0.8722 | 7982.5 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.84122 | acc=0.1383 | tpr=0.7380 | fpr=0.8726 | 7828.4 samples/s | 30.6 steps/s
[Step= 450] | Loss=5.83656 | acc=0.1381 | tpr=0.7337 | fpr=0.8727 | 7967.3 samples/s | 31.1 steps/s
[Step= 500] | Loss=5.83931 | acc=0.1383 | tpr=0.7326 | fpr=0.8724 | 8222.3 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.83841 | acc=0.1389 | tpr=0.7354 | fpr=0.8720 | 10492.4 samples/s | 41.0 steps/s
Avg test loss: 5.83941, Avg test acc: 0.13873, Avg tpr: 0.73455, Avg fpr: 0.87210, total FA: 121089

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19833 | acc=0.9602 | tpr=0.9469 | fpr=0.0396 | 4665.6 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.20435 | acc=0.9596 | tpr=0.9488 | fpr=0.0402 | 7955.0 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.20988 | acc=0.9586 | tpr=0.9496 | fpr=0.0413 | 7045.2 samples/s | 27.5 steps/s
[Step= 200] | Loss=0.21074 | acc=0.9587 | tpr=0.9541 | fpr=0.0412 | 8434.3 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.21180 | acc=0.9585 | tpr=0.9537 | fpr=0.0414 | 7798.7 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.21369 | acc=0.9580 | tpr=0.9527 | fpr=0.0419 | 8147.0 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.21361 | acc=0.9577 | tpr=0.9518 | fpr=0.0422 | 7935.4 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.21512 | acc=0.9574 | tpr=0.9486 | fpr=0.0424 | 7179.8 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.21636 | acc=0.9570 | tpr=0.9450 | fpr=0.0428 | 8389.9 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.21610 | acc=0.9570 | tpr=0.9458 | fpr=0.0428 | 8246.8 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.21577 | acc=0.9572 | tpr=0.9439 | fpr=0.0426 | 10553.7 samples/s | 41.2 steps/s
Avg test loss: 0.21548, Avg test acc: 0.95721, Avg tpr: 0.94374, Avg fpr: 0.04254, total FA: 5907

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13970 | acc=0.9634 | tpr=0.9513 | fpr=0.0364 | 4714.8 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.14347 | acc=0.9631 | tpr=0.9510 | fpr=0.0367 | 7439.7 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.14626 | acc=0.9621 | tpr=0.9481 | fpr=0.0376 | 8251.7 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.14629 | acc=0.9625 | tpr=0.9541 | fpr=0.0373 | 7892.0 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.14724 | acc=0.9622 | tpr=0.9537 | fpr=0.0376 | 7681.3 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.14762 | acc=0.9620 | tpr=0.9527 | fpr=0.0379 | 8587.4 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.14741 | acc=0.9619 | tpr=0.9512 | fpr=0.0379 | 7829.2 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.14894 | acc=0.9615 | tpr=0.9497 | fpr=0.0383 | 7549.3 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.14924 | acc=0.9613 | tpr=0.9460 | fpr=0.0384 | 7600.1 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.14923 | acc=0.9614 | tpr=0.9471 | fpr=0.0384 | 8098.5 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.14910 | acc=0.9615 | tpr=0.9443 | fpr=0.0381 | 10727.0 samples/s | 41.9 steps/s
Avg test loss: 0.14878, Avg test acc: 0.96156, Avg tpr: 0.94414, Avg fpr: 0.03813, total FA: 5294

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.22376 | acc=0.9591 | tpr=0.9381 | fpr=0.0406 | 4704.6 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.23213 | acc=0.9586 | tpr=0.9403 | fpr=0.0411 | 8029.3 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.24001 | acc=0.9573 | tpr=0.9438 | fpr=0.0424 | 7754.9 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.24074 | acc=0.9572 | tpr=0.9486 | fpr=0.0426 | 7959.7 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.24218 | acc=0.9571 | tpr=0.9502 | fpr=0.0427 | 7840.3 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.24465 | acc=0.9566 | tpr=0.9484 | fpr=0.0433 | 8049.1 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.24520 | acc=0.9566 | tpr=0.9474 | fpr=0.0432 | 8350.0 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.24770 | acc=0.9562 | tpr=0.9453 | fpr=0.0436 | 7850.9 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.24894 | acc=0.9559 | tpr=0.9421 | fpr=0.0439 | 7722.4 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.24837 | acc=0.9559 | tpr=0.9432 | fpr=0.0439 | 7864.6 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.24764 | acc=0.9560 | tpr=0.9403 | fpr=0.0437 | 9759.7 samples/s | 38.1 steps/s
Avg test loss: 0.24722, Avg test acc: 0.95605, Avg tpr: 0.94057, Avg fpr: 0.04367, total FA: 6064

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.13034 | acc=0.9675 | tpr=0.9292 | fpr=0.0318 | 4644.7 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.13489 | acc=0.9671 | tpr=0.9254 | fpr=0.0321 | 8060.9 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.13832 | acc=0.9667 | tpr=0.9280 | fpr=0.0326 | 7594.8 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.13844 | acc=0.9674 | tpr=0.9366 | fpr=0.0321 | 8374.5 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.13973 | acc=0.9671 | tpr=0.9406 | fpr=0.0324 | 8102.3 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.14174 | acc=0.9666 | tpr=0.9367 | fpr=0.0329 | 7905.0 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.14268 | acc=0.9665 | tpr=0.9374 | fpr=0.0330 | 7722.2 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.14394 | acc=0.9662 | tpr=0.9322 | fpr=0.0332 | 7654.4 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.14541 | acc=0.9659 | tpr=0.9304 | fpr=0.0335 | 8246.0 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.14428 | acc=0.9660 | tpr=0.9322 | fpr=0.0333 | 8043.1 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.14398 | acc=0.9662 | tpr=0.9304 | fpr=0.0332 | 9728.5 samples/s | 38.0 steps/s
Avg test loss: 0.14362, Avg test acc: 0.96622, Avg tpr: 0.92987, Avg fpr: 0.03312, total FA: 4599

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.19305 | acc=0.9578 | tpr=0.9292 | fpr=0.0417 | 4715.2 samples/s | 18.4 steps/s
[Step= 100] | Loss=0.19950 | acc=0.9578 | tpr=0.9318 | fpr=0.0417 | 7787.1 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.20446 | acc=0.9570 | tpr=0.9395 | fpr=0.0426 | 7904.8 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.20647 | acc=0.9569 | tpr=0.9443 | fpr=0.0428 | 7996.1 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.20732 | acc=0.9568 | tpr=0.9424 | fpr=0.0429 | 7874.9 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.20929 | acc=0.9564 | tpr=0.9425 | fpr=0.0434 | 7524.1 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.20899 | acc=0.9563 | tpr=0.9436 | fpr=0.0435 | 7988.6 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.21067 | acc=0.9560 | tpr=0.9409 | fpr=0.0438 | 8323.9 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.21181 | acc=0.9556 | tpr=0.9377 | fpr=0.0441 | 8122.3 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.21191 | acc=0.9555 | tpr=0.9392 | fpr=0.0442 | 7993.9 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.21104 | acc=0.9557 | tpr=0.9367 | fpr=0.0440 | 9527.6 samples/s | 37.2 steps/s
Avg test loss: 0.21074, Avg test acc: 0.95571, Avg tpr: 0.93621, Avg fpr: 0.04394, total FA: 6101

server round 33/50

clients selected: [2 4 5 6 7]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=20001 Epoch=97.5] | Loss=0.04393 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.801 | L2-Norm(final)=11.297 | 3067.5 samples/s | 47.9 steps/s
[Step=20050 Epoch=97.7] | Loss=0.01933 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.802 | L2-Norm(final)=11.297 | 4982.9 samples/s | 77.9 steps/s
[Step=20100 Epoch=97.9] | Loss=0.02075 | Reg=0.00117 | acc=0.9688 | L2-Norm=10.802 | L2-Norm(final)=11.297 | 5328.6 samples/s | 83.3 steps/s
[Step=20150 Epoch=98.2] | Loss=0.02088 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.802 | L2-Norm(final)=11.295 | 5391.5 samples/s | 84.2 steps/s
[Step=20200 Epoch=98.4] | Loss=0.02059 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.802 | L2-Norm(final)=11.296 | 8432.3 samples/s | 131.8 steps/s
[Step=20250 Epoch=98.7] | Loss=0.02027 | Reg=0.00117 | acc=0.9688 | L2-Norm=10.802 | L2-Norm(final)=11.297 | 1448.6 samples/s | 22.6 steps/s
[Step=20300 Epoch=98.9] | Loss=0.02037 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.802 | L2-Norm(final)=11.299 | 5441.3 samples/s | 85.0 steps/s
[Step=20350 Epoch=99.2] | Loss=0.02061 | Reg=0.00117 | acc=0.9375 | L2-Norm=10.802 | L2-Norm(final)=11.300 | 5370.3 samples/s | 83.9 steps/s
[Step=20400 Epoch=99.4] | Loss=0.02041 | Reg=0.00117 | acc=0.9688 | L2-Norm=10.802 | L2-Norm(final)=11.301 | 7418.1 samples/s | 115.9 steps/s
[Step=20450 Epoch=99.6] | Loss=0.02034 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.802 | L2-Norm(final)=11.303 | 1486.8 samples/s | 23.2 steps/s
[Step=20500 Epoch=99.9] | Loss=0.01989 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.802 | L2-Norm(final)=11.305 | 5250.9 samples/s | 82.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=20501 Epoch=99.9] | Loss=0.01806 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.802 | L2-Norm(final)=11.323 | 3277.7 samples/s | 51.2 steps/s
[Step=20550 Epoch=100.1] | Loss=0.02192 | Reg=0.00117 | acc=0.9531 | L2-Norm=10.816 | L2-Norm(final)=11.324 | 3981.4 samples/s | 62.2 steps/s
[Step=20600 Epoch=100.4] | Loss=0.01948 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.829 | L2-Norm(final)=11.325 | 4651.5 samples/s | 72.7 steps/s
[Step=20650 Epoch=100.6] | Loss=0.01802 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.841 | L2-Norm(final)=11.328 | 4648.6 samples/s | 72.6 steps/s
[Step=20700 Epoch=100.9] | Loss=0.01671 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.851 | L2-Norm(final)=11.330 | 6600.9 samples/s | 103.1 steps/s
[Step=20750 Epoch=101.1] | Loss=0.01499 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.861 | L2-Norm(final)=11.334 | 1373.7 samples/s | 21.5 steps/s
