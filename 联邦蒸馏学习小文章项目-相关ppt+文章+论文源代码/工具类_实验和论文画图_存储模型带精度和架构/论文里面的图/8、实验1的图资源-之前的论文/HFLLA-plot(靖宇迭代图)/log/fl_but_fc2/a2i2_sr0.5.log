#clients of iccad2012: 2
#clients of asml1: 2
select ratio: 0.5
Total num clients: 4
client model path: ['models/model-a2i2_sr0.5/client_asml1_0', 'models/model-a2i2_sr0.5/client_asml1_1', 'models/model-a2i2_sr0.5/client_iccad2012_0', 'models/model-a2i2_sr0.5/client_iccad2012_1']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32814, 144, 32)
Using transform option: train
#pos = 17102, #neg = 15712
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32737, 144, 32)
Using transform option: train
#pos = 17179, #neg = 15558
loading data into the main memory...
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16703, 144, 32)
Using transform option: train
#pos = 8134, #neg = 8569
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16626, 144, 32)
Using transform option: train
#pos = 8099, #neg = 8527
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34366 | Reg=0.00359 | acc=0.5312 | L2-Norm=18.935 | L2-Norm(final)=1.953 | 2610.1 samples/s | 40.8 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.34162 | Reg=0.00359 | acc=0.5156 | L2-Norm=18.935 | L2-Norm(final)=1.957 | 6513.9 samples/s | 101.8 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.33656 | Reg=0.00359 | acc=0.5938 | L2-Norm=18.935 | L2-Norm(final)=1.969 | 6298.2 samples/s | 98.4 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.33383 | Reg=0.00359 | acc=0.6250 | L2-Norm=18.935 | L2-Norm(final)=1.981 | 6218.3 samples/s | 97.2 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.33141 | Reg=0.00359 | acc=0.5156 | L2-Norm=18.935 | L2-Norm(final)=1.997 | 6296.7 samples/s | 98.4 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.33016 | Reg=0.00359 | acc=0.6875 | L2-Norm=18.935 | L2-Norm(final)=2.014 | 6149.5 samples/s | 96.1 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.32886 | Reg=0.00359 | acc=0.5469 | L2-Norm=18.935 | L2-Norm(final)=2.032 | 6163.5 samples/s | 96.3 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.32718 | Reg=0.00359 | acc=0.6875 | L2-Norm=18.935 | L2-Norm(final)=2.052 | 6143.5 samples/s | 96.0 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.32671 | Reg=0.00359 | acc=0.6250 | L2-Norm=18.935 | L2-Norm(final)=2.074 | 6366.6 samples/s | 99.5 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.32543 | Reg=0.00359 | acc=0.5938 | L2-Norm=18.935 | L2-Norm(final)=2.099 | 6195.9 samples/s | 96.8 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.32448 | Reg=0.00359 | acc=0.6406 | L2-Norm=18.935 | L2-Norm(final)=2.125 | 7631.9 samples/s | 119.2 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.0] | Loss=0.30712 | Reg=0.00359 | acc=0.6406 | L2-Norm=18.935 | L2-Norm(final)=2.406 | 3434.2 samples/s | 53.7 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.31649 | Reg=0.00341 | acc=0.6719 | L2-Norm=18.459 | L2-Norm(final)=2.385 | 4908.0 samples/s | 76.7 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.26761 | Reg=0.00336 | acc=0.8750 | L2-Norm=18.317 | L2-Norm(final)=2.406 | 4863.4 samples/s | 76.0 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.23872 | Reg=0.00333 | acc=0.7969 | L2-Norm=18.239 | L2-Norm(final)=2.425 | 4835.4 samples/s | 75.6 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.21652 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.189 | L2-Norm(final)=2.438 | 4918.0 samples/s | 76.8 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.20243 | Reg=0.00330 | acc=0.7500 | L2-Norm=18.155 | L2-Norm(final)=2.451 | 4970.5 samples/s | 77.7 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.18958 | Reg=0.00329 | acc=0.8438 | L2-Norm=18.128 | L2-Norm(final)=2.462 | 4978.8 samples/s | 77.8 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.18001 | Reg=0.00328 | acc=0.9375 | L2-Norm=18.107 | L2-Norm(final)=2.471 | 4910.5 samples/s | 76.7 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.17115 | Reg=0.00327 | acc=0.9219 | L2-Norm=18.091 | L2-Norm(final)=2.480 | 4812.0 samples/s | 75.2 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.16429 | Reg=0.00327 | acc=0.9062 | L2-Norm=18.078 | L2-Norm(final)=2.489 | 4827.6 samples/s | 75.4 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.15743 | Reg=0.00326 | acc=0.9219 | L2-Norm=18.068 | L2-Norm(final)=2.498 | 5449.2 samples/s | 85.1 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.15071 | Reg=0.00326 | acc=0.9062 | L2-Norm=18.063 | L2-Norm(final)=2.508 | 1835.1 samples/s | 28.7 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.14481 | Reg=0.00326 | acc=0.8906 | L2-Norm=18.059 | L2-Norm(final)=2.516 | 4765.8 samples/s | 74.5 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.13986 | Reg=0.00326 | acc=0.9062 | L2-Norm=18.056 | L2-Norm(final)=2.525 | 4915.3 samples/s | 76.8 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.13582 | Reg=0.00326 | acc=0.9531 | L2-Norm=18.055 | L2-Norm(final)=2.531 | 4894.4 samples/s | 76.5 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.13186 | Reg=0.00326 | acc=0.9375 | L2-Norm=18.052 | L2-Norm(final)=2.537 | 4825.2 samples/s | 75.4 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.12780 | Reg=0.00326 | acc=0.9062 | L2-Norm=18.050 | L2-Norm(final)=2.543 | 4921.9 samples/s | 76.9 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.12484 | Reg=0.00326 | acc=0.9531 | L2-Norm=18.047 | L2-Norm(final)=2.548 | 4724.6 samples/s | 73.8 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.12168 | Reg=0.00326 | acc=0.9375 | L2-Norm=18.045 | L2-Norm(final)=2.552 | 4580.2 samples/s | 71.6 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.11888 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.043 | L2-Norm(final)=2.557 | 4530.6 samples/s | 70.8 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.11613 | Reg=0.00326 | acc=0.9375 | L2-Norm=18.042 | L2-Norm(final)=2.561 | 5052.0 samples/s | 78.9 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.11349 | Reg=0.00325 | acc=0.9531 | L2-Norm=18.040 | L2-Norm(final)=2.565 | 1840.9 samples/s | 28.8 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.11045 | Reg=0.00325 | acc=0.9375 | L2-Norm=18.038 | L2-Norm(final)=2.570 | 5011.7 samples/s | 78.3 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.10776 | Reg=0.00325 | acc=0.9375 | L2-Norm=18.038 | L2-Norm(final)=2.575 | 4883.9 samples/s | 76.3 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.10561 | Reg=0.00325 | acc=0.9688 | L2-Norm=18.038 | L2-Norm(final)=2.579 | 4815.9 samples/s | 75.2 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.10368 | Reg=0.00325 | acc=0.9531 | L2-Norm=18.039 | L2-Norm(final)=2.583 | 4741.3 samples/s | 74.1 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.10176 | Reg=0.00325 | acc=0.9531 | L2-Norm=18.040 | L2-Norm(final)=2.587 | 4635.1 samples/s | 72.4 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.09980 | Reg=0.00325 | acc=0.9688 | L2-Norm=18.041 | L2-Norm(final)=2.591 | 4557.4 samples/s | 71.2 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.09806 | Reg=0.00326 | acc=0.9531 | L2-Norm=18.042 | L2-Norm(final)=2.595 | 4841.2 samples/s | 75.6 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.09680 | Reg=0.00326 | acc=0.8594 | L2-Norm=18.043 | L2-Norm(final)=2.598 | 4875.3 samples/s | 76.2 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.09513 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.044 | L2-Norm(final)=2.601 | 5017.8 samples/s | 78.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step2000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35139 | Reg=0.00359 | acc=0.5000 | L2-Norm=18.935 | L2-Norm(final)=1.953 | 4276.5 samples/s | 66.8 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.33966 | Reg=0.00359 | acc=0.5312 | L2-Norm=18.935 | L2-Norm(final)=1.962 | 5190.8 samples/s | 81.1 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.33598 | Reg=0.00359 | acc=0.6250 | L2-Norm=18.935 | L2-Norm(final)=1.976 | 6235.2 samples/s | 97.4 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.33362 | Reg=0.00359 | acc=0.6562 | L2-Norm=18.935 | L2-Norm(final)=1.987 | 6248.3 samples/s | 97.6 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.33069 | Reg=0.00359 | acc=0.6250 | L2-Norm=18.935 | L2-Norm(final)=2.002 | 5985.5 samples/s | 93.5 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.32960 | Reg=0.00359 | acc=0.7344 | L2-Norm=18.935 | L2-Norm(final)=2.021 | 5881.6 samples/s | 91.9 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.32808 | Reg=0.00359 | acc=0.6719 | L2-Norm=18.935 | L2-Norm(final)=2.041 | 5660.2 samples/s | 88.4 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.32654 | Reg=0.00359 | acc=0.5625 | L2-Norm=18.935 | L2-Norm(final)=2.065 | 5665.8 samples/s | 88.5 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.32515 | Reg=0.00359 | acc=0.6719 | L2-Norm=18.935 | L2-Norm(final)=2.089 | 6101.5 samples/s | 95.3 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.32461 | Reg=0.00359 | acc=0.6094 | L2-Norm=18.935 | L2-Norm(final)=2.115 | 6053.3 samples/s | 94.6 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.32361 | Reg=0.00359 | acc=0.6094 | L2-Norm=18.935 | L2-Norm(final)=2.141 | 7999.1 samples/s | 125.0 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.0] | Loss=0.32167 | Reg=0.00359 | acc=0.6094 | L2-Norm=18.935 | L2-Norm(final)=2.410 | 3899.9 samples/s | 60.9 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.28317 | Reg=0.00342 | acc=0.7969 | L2-Norm=18.498 | L2-Norm(final)=2.417 | 4707.4 samples/s | 73.6 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.25007 | Reg=0.00337 | acc=0.8594 | L2-Norm=18.355 | L2-Norm(final)=2.429 | 4969.2 samples/s | 77.6 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.23013 | Reg=0.00334 | acc=0.8906 | L2-Norm=18.282 | L2-Norm(final)=2.434 | 4973.4 samples/s | 77.7 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.20953 | Reg=0.00333 | acc=0.8594 | L2-Norm=18.241 | L2-Norm(final)=2.447 | 4758.7 samples/s | 74.4 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.19604 | Reg=0.00332 | acc=0.8906 | L2-Norm=18.216 | L2-Norm(final)=2.456 | 4576.6 samples/s | 71.5 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.18369 | Reg=0.00331 | acc=0.9219 | L2-Norm=18.199 | L2-Norm(final)=2.466 | 4516.6 samples/s | 70.6 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.17391 | Reg=0.00331 | acc=0.9219 | L2-Norm=18.187 | L2-Norm(final)=2.474 | 4721.1 samples/s | 73.8 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.16710 | Reg=0.00330 | acc=0.9219 | L2-Norm=18.177 | L2-Norm(final)=2.481 | 4734.9 samples/s | 74.0 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.16086 | Reg=0.00330 | acc=0.9062 | L2-Norm=18.171 | L2-Norm(final)=2.487 | 4755.7 samples/s | 74.3 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.15481 | Reg=0.00330 | acc=0.9062 | L2-Norm=18.166 | L2-Norm(final)=2.493 | 5891.1 samples/s | 92.0 steps/s
[Step=1050 Epoch= 2.1] | Loss=0.14883 | Reg=0.00330 | acc=0.9531 | L2-Norm=18.162 | L2-Norm(final)=2.498 | 1915.2 samples/s | 29.9 steps/s
[Step=1100 Epoch= 2.2] | Loss=0.14283 | Reg=0.00330 | acc=0.9062 | L2-Norm=18.161 | L2-Norm(final)=2.504 | 4942.2 samples/s | 77.2 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.13741 | Reg=0.00330 | acc=0.9219 | L2-Norm=18.162 | L2-Norm(final)=2.511 | 4713.1 samples/s | 73.6 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.13269 | Reg=0.00330 | acc=0.9531 | L2-Norm=18.163 | L2-Norm(final)=2.516 | 4570.2 samples/s | 71.4 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.12930 | Reg=0.00330 | acc=0.9062 | L2-Norm=18.163 | L2-Norm(final)=2.521 | 4603.6 samples/s | 71.9 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.12536 | Reg=0.00330 | acc=0.9688 | L2-Norm=18.164 | L2-Norm(final)=2.526 | 4769.2 samples/s | 74.5 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.12234 | Reg=0.00330 | acc=0.8750 | L2-Norm=18.165 | L2-Norm(final)=2.530 | 4768.3 samples/s | 74.5 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.12006 | Reg=0.00330 | acc=0.9531 | L2-Norm=18.167 | L2-Norm(final)=2.535 | 4918.8 samples/s | 76.9 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.11755 | Reg=0.00330 | acc=0.9375 | L2-Norm=18.168 | L2-Norm(final)=2.538 | 4872.1 samples/s | 76.1 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.11537 | Reg=0.00330 | acc=0.9844 | L2-Norm=18.171 | L2-Norm(final)=2.541 | 5274.9 samples/s | 82.4 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.11242 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.174 | L2-Norm(final)=2.544 | 1944.6 samples/s | 30.4 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.10959 | Reg=0.00330 | acc=0.9531 | L2-Norm=18.177 | L2-Norm(final)=2.548 | 4604.5 samples/s | 71.9 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.10717 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.181 | L2-Norm(final)=2.552 | 4477.7 samples/s | 70.0 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.10484 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.184 | L2-Norm(final)=2.555 | 4753.3 samples/s | 74.3 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.10309 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.187 | L2-Norm(final)=2.558 | 4729.2 samples/s | 73.9 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.10133 | Reg=0.00331 | acc=0.9531 | L2-Norm=18.191 | L2-Norm(final)=2.560 | 4835.9 samples/s | 75.6 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.09967 | Reg=0.00331 | acc=0.9375 | L2-Norm=18.194 | L2-Norm(final)=2.563 | 4858.0 samples/s | 75.9 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.09835 | Reg=0.00331 | acc=0.9219 | L2-Norm=18.198 | L2-Norm(final)=2.564 | 4881.7 samples/s | 76.3 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.09664 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.201 | L2-Norm(final)=2.566 | 4914.6 samples/s | 76.8 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.09507 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.206 | L2-Norm(final)=2.568 | 4925.3 samples/s | 77.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08931 | acc=0.9338 | tpr=0.9277 | fpr=0.0528 | 4232.0 samples/s | 16.5 steps/s
Avg test loss: 0.08982, Avg test acc: 0.93289, Avg tpr: 0.92639, Avg fpr: 0.05281, total FA: 412

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07860 | acc=0.9477 | tpr=0.9584 | fpr=0.0753 | 4315.5 samples/s | 16.9 steps/s
Avg test loss: 0.08003, Avg test acc: 0.94639, Avg tpr: 0.95739, Avg fpr: 0.07781, total FA: 607

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=0.37892 | acc=0.3908 | tpr=0.2147 | fpr=0.2270 | 4284.3 samples/s | 16.7 steps/s
Avg test loss: 0.37968, Avg test acc: 0.39042, Avg tpr: 0.21863, Avg fpr: 0.23177, total FA: 1808

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=0.37892 | acc=0.3908 | tpr=0.2147 | fpr=0.2270 | 4122.9 samples/s | 16.1 steps/s
Avg test loss: 0.37968, Avg test acc: 0.39042, Avg tpr: 0.21863, Avg fpr: 0.23177, total FA: 1808

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=2.10841 | acc=0.1646 | tpr=0.6327 | fpr=0.8438 | 4350.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=2.09493 | acc=0.1672 | tpr=0.6290 | fpr=0.8414 | 8432.4 samples/s | 32.9 steps/s
[Step= 150] | Loss=2.09342 | acc=0.1666 | tpr=0.6412 | fpr=0.8422 | 8153.6 samples/s | 31.9 steps/s
[Step= 200] | Loss=2.09277 | acc=0.1665 | tpr=0.6503 | fpr=0.8423 | 8538.2 samples/s | 33.4 steps/s
[Step= 250] | Loss=2.09644 | acc=0.1661 | tpr=0.6611 | fpr=0.8429 | 8756.0 samples/s | 34.2 steps/s
[Step= 300] | Loss=2.09444 | acc=0.1663 | tpr=0.6582 | fpr=0.8426 | 8883.9 samples/s | 34.7 steps/s
[Step= 350] | Loss=2.09488 | acc=0.1666 | tpr=0.6487 | fpr=0.8421 | 8082.0 samples/s | 31.6 steps/s
[Step= 400] | Loss=2.09403 | acc=0.1667 | tpr=0.6570 | fpr=0.8422 | 7186.1 samples/s | 28.1 steps/s
[Step= 450] | Loss=2.09381 | acc=0.1669 | tpr=0.6626 | fpr=0.8421 | 7397.0 samples/s | 28.9 steps/s
[Step= 500] | Loss=2.09449 | acc=0.1663 | tpr=0.6639 | fpr=0.8427 | 7792.6 samples/s | 30.4 steps/s
[Step= 550] | Loss=2.09700 | acc=0.1661 | tpr=0.6610 | fpr=0.8429 | 13810.7 samples/s | 53.9 steps/s
Avg test loss: 2.09784, Avg test acc: 0.16607, Avg tpr: 0.66125, Avg fpr: 0.84293, total FA: 117039

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=2.42765 | acc=0.1488 | tpr=0.8938 | fpr=0.8646 | 4210.4 samples/s | 16.4 steps/s
[Step= 100] | Loss=2.41546 | acc=0.1502 | tpr=0.8550 | fpr=0.8630 | 8447.1 samples/s | 33.0 steps/s
[Step= 150] | Loss=2.41857 | acc=0.1511 | tpr=0.8429 | fpr=0.8616 | 8597.9 samples/s | 33.6 steps/s
[Step= 200] | Loss=2.41954 | acc=0.1511 | tpr=0.8426 | fpr=0.8615 | 8014.4 samples/s | 31.3 steps/s
[Step= 250] | Loss=2.42034 | acc=0.1518 | tpr=0.8358 | fpr=0.8607 | 8509.6 samples/s | 33.2 steps/s
[Step= 300] | Loss=2.42208 | acc=0.1510 | tpr=0.8313 | fpr=0.8614 | 8645.6 samples/s | 33.8 steps/s
[Step= 350] | Loss=2.42156 | acc=0.1505 | tpr=0.8322 | fpr=0.8619 | 8569.8 samples/s | 33.5 steps/s
[Step= 400] | Loss=2.42061 | acc=0.1506 | tpr=0.8326 | fpr=0.8618 | 8095.4 samples/s | 31.6 steps/s
[Step= 450] | Loss=2.42185 | acc=0.1504 | tpr=0.8354 | fpr=0.8621 | 8649.6 samples/s | 33.8 steps/s
[Step= 500] | Loss=2.42355 | acc=0.1502 | tpr=0.8339 | fpr=0.8621 | 8578.2 samples/s | 33.5 steps/s
[Step= 550] | Loss=2.42474 | acc=0.1501 | tpr=0.8317 | fpr=0.8623 | 16062.9 samples/s | 62.7 steps/s
Avg test loss: 2.42506, Avg test acc: 0.15005, Avg tpr: 0.83122, Avg fpr: 0.86233, total FA: 119733

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.31344 | acc=0.7555 | tpr=0.2035 | fpr=0.2346 | 4093.5 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.31270 | acc=0.7617 | tpr=0.2004 | fpr=0.2278 | 8687.1 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.31297 | acc=0.7590 | tpr=0.2075 | fpr=0.2308 | 8345.2 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.31303 | acc=0.7591 | tpr=0.2164 | fpr=0.2310 | 8523.8 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.31307 | acc=0.7591 | tpr=0.2122 | fpr=0.2309 | 7919.4 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.31302 | acc=0.7594 | tpr=0.2124 | fpr=0.2306 | 8586.5 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.31303 | acc=0.7593 | tpr=0.2079 | fpr=0.2307 | 8682.8 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.31313 | acc=0.7585 | tpr=0.2024 | fpr=0.2314 | 8567.2 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.31304 | acc=0.7587 | tpr=0.2045 | fpr=0.2313 | 8382.7 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.31302 | acc=0.7585 | tpr=0.2022 | fpr=0.2315 | 8124.4 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.31298 | acc=0.7585 | tpr=0.2021 | fpr=0.2314 | 16213.8 samples/s | 63.3 steps/s
Avg test loss: 0.31297, Avg test acc: 0.75852, Avg tpr: 0.20166, Avg fpr: 0.23135, total FA: 32123

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.31344 | acc=0.7555 | tpr=0.2035 | fpr=0.2346 | 4320.6 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.31270 | acc=0.7617 | tpr=0.2004 | fpr=0.2278 | 7949.0 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.31297 | acc=0.7590 | tpr=0.2075 | fpr=0.2308 | 8387.3 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.31303 | acc=0.7591 | tpr=0.2164 | fpr=0.2310 | 8999.2 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.31307 | acc=0.7591 | tpr=0.2122 | fpr=0.2309 | 8419.2 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.31302 | acc=0.7594 | tpr=0.2124 | fpr=0.2306 | 8265.3 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.31303 | acc=0.7593 | tpr=0.2079 | fpr=0.2307 | 8564.1 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.31313 | acc=0.7585 | tpr=0.2024 | fpr=0.2314 | 8208.0 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.31304 | acc=0.7587 | tpr=0.2045 | fpr=0.2313 | 8611.2 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.31302 | acc=0.7585 | tpr=0.2022 | fpr=0.2315 | 8474.3 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.31298 | acc=0.7585 | tpr=0.2021 | fpr=0.2314 | 13644.5 samples/s | 53.3 steps/s
Avg test loss: 0.31297, Avg test acc: 0.75852, Avg tpr: 0.20166, Avg fpr: 0.23135, total FA: 32123

server round 1/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 3.9] | Loss=0.19711 | Reg=0.00307 | acc=0.8281 | L2-Norm=17.526 | L2-Norm(final)=2.700 | 3504.8 samples/s | 54.8 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.16507 | Reg=0.00307 | acc=0.8750 | L2-Norm=17.523 | L2-Norm(final)=2.786 | 5539.3 samples/s | 86.6 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.16362 | Reg=0.00307 | acc=0.9375 | L2-Norm=17.523 | L2-Norm(final)=2.883 | 5725.7 samples/s | 89.5 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.15825 | Reg=0.00307 | acc=0.9844 | L2-Norm=17.523 | L2-Norm(final)=2.969 | 5581.8 samples/s | 87.2 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.15500 | Reg=0.00307 | acc=0.8750 | L2-Norm=17.523 | L2-Norm(final)=3.053 | 5587.7 samples/s | 87.3 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.15274 | Reg=0.00307 | acc=0.8594 | L2-Norm=17.523 | L2-Norm(final)=3.130 | 5590.9 samples/s | 87.4 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.15126 | Reg=0.00307 | acc=0.8750 | L2-Norm=17.523 | L2-Norm(final)=3.203 | 5557.6 samples/s | 86.8 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.14912 | Reg=0.00307 | acc=0.8906 | L2-Norm=17.523 | L2-Norm(final)=3.273 | 5513.2 samples/s | 86.1 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.14748 | Reg=0.00307 | acc=0.8906 | L2-Norm=17.523 | L2-Norm(final)=3.339 | 5440.6 samples/s | 85.0 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.14697 | Reg=0.00307 | acc=0.8438 | L2-Norm=17.523 | L2-Norm(final)=3.403 | 5217.0 samples/s | 81.5 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.14554 | Reg=0.00307 | acc=0.9219 | L2-Norm=17.523 | L2-Norm(final)=3.464 | 6428.6 samples/s | 100.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 4.9] | Loss=0.12604 | Reg=0.00307 | acc=0.8750 | L2-Norm=17.523 | L2-Norm(final)=4.057 | 3628.5 samples/s | 56.7 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.13735 | Reg=0.00312 | acc=0.9375 | L2-Norm=17.670 | L2-Norm(final)=4.052 | 4646.1 samples/s | 72.6 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.12775 | Reg=0.00315 | acc=0.9062 | L2-Norm=17.752 | L2-Norm(final)=4.051 | 4886.9 samples/s | 76.4 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.12049 | Reg=0.00317 | acc=0.9062 | L2-Norm=17.800 | L2-Norm(final)=4.048 | 4817.9 samples/s | 75.3 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.11418 | Reg=0.00318 | acc=0.9531 | L2-Norm=17.824 | L2-Norm(final)=4.046 | 4799.6 samples/s | 75.0 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.10776 | Reg=0.00318 | acc=0.9375 | L2-Norm=17.840 | L2-Norm(final)=4.045 | 4964.9 samples/s | 77.6 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.10448 | Reg=0.00319 | acc=0.9219 | L2-Norm=17.852 | L2-Norm(final)=4.044 | 4748.3 samples/s | 74.2 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.10137 | Reg=0.00319 | acc=0.9062 | L2-Norm=17.862 | L2-Norm(final)=4.042 | 4625.5 samples/s | 72.3 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.09816 | Reg=0.00319 | acc=0.9375 | L2-Norm=17.870 | L2-Norm(final)=4.040 | 4544.8 samples/s | 71.0 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.09556 | Reg=0.00320 | acc=0.9531 | L2-Norm=17.877 | L2-Norm(final)=4.038 | 4924.0 samples/s | 76.9 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.09297 | Reg=0.00320 | acc=0.9375 | L2-Norm=17.883 | L2-Norm(final)=4.036 | 5808.8 samples/s | 90.8 steps/s
[Step=3050 Epoch= 5.9] | Loss=0.08971 | Reg=0.00320 | acc=0.9688 | L2-Norm=17.890 | L2-Norm(final)=4.035 | 1855.5 samples/s | 29.0 steps/s
[Step=3100 Epoch= 6.0] | Loss=0.08670 | Reg=0.00320 | acc=0.9531 | L2-Norm=17.897 | L2-Norm(final)=4.035 | 4808.9 samples/s | 75.1 steps/s
[Step=3150 Epoch= 6.1] | Loss=0.08471 | Reg=0.00321 | acc=0.9375 | L2-Norm=17.903 | L2-Norm(final)=4.035 | 4919.1 samples/s | 76.9 steps/s
[Step=3200 Epoch= 6.2] | Loss=0.08275 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.910 | L2-Norm(final)=4.034 | 4909.1 samples/s | 76.7 steps/s
[Step=3250 Epoch= 6.3] | Loss=0.08029 | Reg=0.00321 | acc=0.9219 | L2-Norm=17.916 | L2-Norm(final)=4.034 | 4661.7 samples/s | 72.8 steps/s
[Step=3300 Epoch= 6.4] | Loss=0.07843 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.921 | L2-Norm(final)=4.033 | 4550.3 samples/s | 71.1 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.07683 | Reg=0.00321 | acc=0.9531 | L2-Norm=17.926 | L2-Norm(final)=4.033 | 4717.8 samples/s | 73.7 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.07529 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.932 | L2-Norm(final)=4.032 | 5034.3 samples/s | 78.7 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.07429 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.939 | L2-Norm(final)=4.031 | 4966.9 samples/s | 77.6 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.07333 | Reg=0.00322 | acc=0.9219 | L2-Norm=17.945 | L2-Norm(final)=4.031 | 5281.3 samples/s | 82.5 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.07171 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.951 | L2-Norm(final)=4.030 | 1937.9 samples/s | 30.3 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.07024 | Reg=0.00322 | acc=0.9219 | L2-Norm=17.956 | L2-Norm(final)=4.030 | 4851.3 samples/s | 75.8 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.06894 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.962 | L2-Norm(final)=4.031 | 4800.2 samples/s | 75.0 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.06760 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.968 | L2-Norm(final)=4.030 | 4692.2 samples/s | 73.3 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.06642 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.974 | L2-Norm(final)=4.030 | 4444.7 samples/s | 69.4 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.06547 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.981 | L2-Norm(final)=4.030 | 4803.4 samples/s | 75.1 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.06457 | Reg=0.00324 | acc=0.9375 | L2-Norm=17.987 | L2-Norm(final)=4.030 | 4935.6 samples/s | 77.1 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.06372 | Reg=0.00324 | acc=0.9688 | L2-Norm=17.993 | L2-Norm(final)=4.029 | 4784.1 samples/s | 74.8 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.06282 | Reg=0.00324 | acc=0.9531 | L2-Norm=18.000 | L2-Norm(final)=4.029 | 4911.2 samples/s | 76.7 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.06195 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.008 | L2-Norm(final)=4.029 | 5026.9 samples/s | 78.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step4000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36402 | Reg=0.00307 | acc=0.4688 | L2-Norm=17.526 | L2-Norm(final)=1.952 | 4067.3 samples/s | 63.6 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.34060 | Reg=0.00307 | acc=0.5625 | L2-Norm=17.526 | L2-Norm(final)=1.962 | 5204.8 samples/s | 81.3 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.32003 | Reg=0.00307 | acc=0.7344 | L2-Norm=17.526 | L2-Norm(final)=2.010 | 5454.6 samples/s | 85.2 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.30311 | Reg=0.00307 | acc=0.7969 | L2-Norm=17.526 | L2-Norm(final)=2.093 | 5335.6 samples/s | 83.4 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.28898 | Reg=0.00307 | acc=0.9062 | L2-Norm=17.526 | L2-Norm(final)=2.195 | 5304.8 samples/s | 82.9 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.27672 | Reg=0.00307 | acc=0.9062 | L2-Norm=17.526 | L2-Norm(final)=2.306 | 7589.2 samples/s | 118.6 steps/s
[Step= 300 Epoch= 1.1] | Loss=0.26632 | Reg=0.00307 | acc=0.8906 | L2-Norm=17.526 | L2-Norm(final)=2.422 | 2011.2 samples/s | 31.4 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.25760 | Reg=0.00307 | acc=0.9062 | L2-Norm=17.526 | L2-Norm(final)=2.540 | 5651.9 samples/s | 88.3 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.24964 | Reg=0.00307 | acc=0.7969 | L2-Norm=17.526 | L2-Norm(final)=2.659 | 5699.0 samples/s | 89.0 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.24325 | Reg=0.00307 | acc=0.8438 | L2-Norm=17.526 | L2-Norm(final)=2.775 | 5884.4 samples/s | 91.9 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.23805 | Reg=0.00307 | acc=0.8281 | L2-Norm=17.526 | L2-Norm(final)=2.889 | 6588.1 samples/s | 102.9 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.9] | Loss=0.17919 | Reg=0.00307 | acc=0.8594 | L2-Norm=17.526 | L2-Norm(final)=4.005 | 3618.6 samples/s | 56.5 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.08240 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.382 | L2-Norm(final)=4.050 | 4316.9 samples/s | 67.5 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.05877 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.354 | L2-Norm(final)=4.058 | 4321.4 samples/s | 67.5 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.04851 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.347 | L2-Norm(final)=4.065 | 4591.0 samples/s | 71.7 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.03975 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.348 | L2-Norm(final)=4.066 | 4727.0 samples/s | 73.9 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.03388 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.345 | L2-Norm(final)=4.069 | 5940.8 samples/s | 92.8 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.02883 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.339 | L2-Norm(final)=4.073 | 1861.3 samples/s | 29.1 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.02491 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.328 | L2-Norm(final)=4.077 | 4706.2 samples/s | 73.5 steps/s
[Step= 900 Epoch= 3.4] | Loss=0.02206 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.313 | L2-Norm(final)=4.081 | 4554.9 samples/s | 71.2 steps/s
[Step= 950 Epoch= 3.6] | Loss=0.01984 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.297 | L2-Norm(final)=4.085 | 4369.1 samples/s | 68.3 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.01818 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.280 | L2-Norm(final)=4.089 | 4743.8 samples/s | 74.1 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.01666 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.263 | L2-Norm(final)=4.093 | 1905.8 samples/s | 29.8 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01529 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.245 | L2-Norm(final)=4.096 | 4635.3 samples/s | 72.4 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01414 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.226 | L2-Norm(final)=4.100 | 4571.7 samples/s | 71.4 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01314 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.204 | L2-Norm(final)=4.103 | 4582.5 samples/s | 71.6 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.01227 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.181 | L2-Norm(final)=4.106 | 4573.6 samples/s | 71.5 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.01152 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.157 | L2-Norm(final)=4.109 | 1928.5 samples/s | 30.1 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.01084 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.132 | L2-Norm(final)=4.111 | 4343.4 samples/s | 67.9 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.01024 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.105 | L2-Norm(final)=4.114 | 4557.3 samples/s | 71.2 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00970 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.077 | L2-Norm(final)=4.116 | 4652.5 samples/s | 72.7 steps/s
[Step=1500 Epoch= 5.7] | Loss=0.00922 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.049 | L2-Norm(final)=4.118 | 4635.0 samples/s | 72.4 steps/s
[Step=1550 Epoch= 5.9] | Loss=0.00878 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.020 | L2-Norm(final)=4.120 | 2005.9 samples/s | 31.3 steps/s
[Step=1600 Epoch= 6.1] | Loss=0.00838 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.990 | L2-Norm(final)=4.122 | 4739.8 samples/s | 74.1 steps/s
[Step=1650 Epoch= 6.3] | Loss=0.00802 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.959 | L2-Norm(final)=4.123 | 4464.0 samples/s | 69.7 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.00769 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.928 | L2-Norm(final)=4.125 | 4405.8 samples/s | 68.8 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.00738 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.896 | L2-Norm(final)=4.126 | 4344.3 samples/s | 67.9 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.00710 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.864 | L2-Norm(final)=4.128 | 6018.7 samples/s | 94.0 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00683 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.832 | L2-Norm(final)=4.129 | 1770.2 samples/s | 27.7 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00659 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.799 | L2-Norm(final)=4.130 | 4652.9 samples/s | 72.7 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00636 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.766 | L2-Norm(final)=4.131 | 4610.2 samples/s | 72.0 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00615 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.733 | L2-Norm(final)=4.132 | 4764.9 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07474 | acc=0.9485 | tpr=0.9532 | fpr=0.0617 | 4127.3 samples/s | 16.1 steps/s
Avg test loss: 0.07805, Avg test acc: 0.94471, Avg tpr: 0.94958, Avg fpr: 0.06602, total FA: 515

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07860 | acc=0.9477 | tpr=0.9584 | fpr=0.0753 | 4291.1 samples/s | 16.8 steps/s
Avg test loss: 0.08003, Avg test acc: 0.94639, Avg tpr: 0.95739, Avg fpr: 0.07781, total FA: 607

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.84307 | acc=0.2957 | tpr=0.0245 | fpr=0.1155 | 4139.3 samples/s | 16.2 steps/s
Avg test loss: 5.83296, Avg test acc: 0.29494, Avg tpr: 0.02594, Avg fpr: 0.11345, total FA: 885

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=0.37892 | acc=0.3908 | tpr=0.2147 | fpr=0.2270 | 4152.1 samples/s | 16.2 steps/s
Avg test loss: 0.37968, Avg test acc: 0.39042, Avg tpr: 0.21863, Avg fpr: 0.23177, total FA: 1808

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=2.88291 | acc=0.1279 | tpr=0.7876 | fpr=0.8840 | 4329.3 samples/s | 16.9 steps/s
[Step= 100] | Loss=2.86017 | acc=0.1338 | tpr=0.7569 | fpr=0.8779 | 8666.9 samples/s | 33.9 steps/s
[Step= 150] | Loss=2.86121 | acc=0.1351 | tpr=0.7406 | fpr=0.8761 | 8026.3 samples/s | 31.4 steps/s
[Step= 200] | Loss=2.85666 | acc=0.1349 | tpr=0.7301 | fpr=0.8759 | 9078.9 samples/s | 35.5 steps/s
[Step= 250] | Loss=2.85827 | acc=0.1354 | tpr=0.7319 | fpr=0.8755 | 8316.3 samples/s | 32.5 steps/s
[Step= 300] | Loss=2.85642 | acc=0.1354 | tpr=0.7316 | fpr=0.8755 | 8723.7 samples/s | 34.1 steps/s
[Step= 350] | Loss=2.85689 | acc=0.1346 | tpr=0.7270 | fpr=0.8761 | 8230.0 samples/s | 32.1 steps/s
[Step= 400] | Loss=2.85371 | acc=0.1341 | tpr=0.7254 | fpr=0.8767 | 8163.6 samples/s | 31.9 steps/s
[Step= 450] | Loss=2.85338 | acc=0.1344 | tpr=0.7269 | fpr=0.8763 | 7936.2 samples/s | 31.0 steps/s
[Step= 500] | Loss=2.85438 | acc=0.1340 | tpr=0.7251 | fpr=0.8767 | 9018.1 samples/s | 35.2 steps/s
[Step= 550] | Loss=2.85475 | acc=0.1336 | tpr=0.7214 | fpr=0.8771 | 14265.4 samples/s | 55.7 steps/s
Avg test loss: 2.85547, Avg test acc: 0.13355, Avg tpr: 0.72187, Avg fpr: 0.87715, total FA: 121790

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=2.42765 | acc=0.1488 | tpr=0.8938 | fpr=0.8646 | 4229.0 samples/s | 16.5 steps/s
[Step= 100] | Loss=2.41546 | acc=0.1502 | tpr=0.8550 | fpr=0.8630 | 8821.5 samples/s | 34.5 steps/s
[Step= 150] | Loss=2.41857 | acc=0.1511 | tpr=0.8429 | fpr=0.8616 | 8543.9 samples/s | 33.4 steps/s
[Step= 200] | Loss=2.41954 | acc=0.1511 | tpr=0.8426 | fpr=0.8615 | 8098.7 samples/s | 31.6 steps/s
[Step= 250] | Loss=2.42034 | acc=0.1518 | tpr=0.8358 | fpr=0.8607 | 8588.0 samples/s | 33.5 steps/s
[Step= 300] | Loss=2.42208 | acc=0.1510 | tpr=0.8313 | fpr=0.8614 | 8715.0 samples/s | 34.0 steps/s
[Step= 350] | Loss=2.42156 | acc=0.1505 | tpr=0.8322 | fpr=0.8619 | 8908.6 samples/s | 34.8 steps/s
[Step= 400] | Loss=2.42061 | acc=0.1506 | tpr=0.8326 | fpr=0.8618 | 8238.9 samples/s | 32.2 steps/s
[Step= 450] | Loss=2.42185 | acc=0.1504 | tpr=0.8354 | fpr=0.8621 | 8153.6 samples/s | 31.9 steps/s
[Step= 500] | Loss=2.42355 | acc=0.1502 | tpr=0.8339 | fpr=0.8621 | 8472.5 samples/s | 33.1 steps/s
[Step= 550] | Loss=2.42474 | acc=0.1501 | tpr=0.8317 | fpr=0.8623 | 15362.1 samples/s | 60.0 steps/s
Avg test loss: 2.42506, Avg test acc: 0.15005, Avg tpr: 0.83122, Avg fpr: 0.86233, total FA: 119733

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07821 | acc=0.9822 | tpr=0.9292 | fpr=0.0169 | 4276.4 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.07972 | acc=0.9814 | tpr=0.9254 | fpr=0.0175 | 7983.2 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.08228 | acc=0.9806 | tpr=0.9265 | fpr=0.0184 | 8587.9 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.08340 | acc=0.9808 | tpr=0.9322 | fpr=0.0183 | 8771.2 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.08203 | acc=0.9812 | tpr=0.9301 | fpr=0.0179 | 8775.1 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.08265 | acc=0.9810 | tpr=0.9295 | fpr=0.0181 | 7732.3 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.08298 | acc=0.9808 | tpr=0.9311 | fpr=0.0183 | 8222.5 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.08440 | acc=0.9806 | tpr=0.9272 | fpr=0.0185 | 8884.3 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.08640 | acc=0.9802 | tpr=0.9250 | fpr=0.0188 | 8449.7 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.08570 | acc=0.9803 | tpr=0.9282 | fpr=0.0188 | 7806.0 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.08513 | acc=0.9804 | tpr=0.9288 | fpr=0.0187 | 15426.4 samples/s | 60.3 steps/s
Avg test loss: 0.08512, Avg test acc: 0.98038, Avg tpr: 0.92868, Avg fpr: 0.01868, total FA: 2594

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.31344 | acc=0.7555 | tpr=0.2035 | fpr=0.2346 | 4330.1 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.31270 | acc=0.7617 | tpr=0.2004 | fpr=0.2278 | 8352.6 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.31297 | acc=0.7590 | tpr=0.2075 | fpr=0.2308 | 7958.7 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.31303 | acc=0.7591 | tpr=0.2164 | fpr=0.2310 | 8771.9 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.31307 | acc=0.7591 | tpr=0.2122 | fpr=0.2309 | 8565.8 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.31302 | acc=0.7594 | tpr=0.2124 | fpr=0.2306 | 8474.0 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.31303 | acc=0.7593 | tpr=0.2079 | fpr=0.2307 | 8018.3 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.31313 | acc=0.7585 | tpr=0.2024 | fpr=0.2314 | 8173.4 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.31304 | acc=0.7587 | tpr=0.2045 | fpr=0.2313 | 8544.0 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.31302 | acc=0.7585 | tpr=0.2022 | fpr=0.2315 | 8628.8 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.31298 | acc=0.7585 | tpr=0.2021 | fpr=0.2314 | 14111.5 samples/s | 55.1 steps/s
Avg test loss: 0.31297, Avg test acc: 0.75852, Avg tpr: 0.20166, Avg fpr: 0.23135, total FA: 32123

server round 2/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.07459 | Reg=0.00278 | acc=0.9219 | L2-Norm=16.672 | L2-Norm(final)=4.016 | 3528.4 samples/s | 55.1 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.09911 | Reg=0.00278 | acc=0.9062 | L2-Norm=16.674 | L2-Norm(final)=4.032 | 5444.8 samples/s | 85.1 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.10080 | Reg=0.00278 | acc=0.8750 | L2-Norm=16.674 | L2-Norm(final)=4.056 | 5608.2 samples/s | 87.6 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.09774 | Reg=0.00278 | acc=0.9531 | L2-Norm=16.674 | L2-Norm(final)=4.087 | 5590.2 samples/s | 87.3 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.09825 | Reg=0.00278 | acc=0.9375 | L2-Norm=16.674 | L2-Norm(final)=4.129 | 5732.8 samples/s | 89.6 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.09634 | Reg=0.00278 | acc=0.9062 | L2-Norm=16.674 | L2-Norm(final)=4.169 | 5744.6 samples/s | 89.8 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.09503 | Reg=0.00278 | acc=0.9375 | L2-Norm=16.674 | L2-Norm(final)=4.208 | 5836.2 samples/s | 91.2 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.09532 | Reg=0.00278 | acc=0.9375 | L2-Norm=16.674 | L2-Norm(final)=4.245 | 5761.6 samples/s | 90.0 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.09429 | Reg=0.00278 | acc=0.9375 | L2-Norm=16.674 | L2-Norm(final)=4.280 | 5568.6 samples/s | 87.0 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.09417 | Reg=0.00278 | acc=0.9219 | L2-Norm=16.674 | L2-Norm(final)=4.313 | 5466.3 samples/s | 85.4 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.09348 | Reg=0.00278 | acc=0.8750 | L2-Norm=16.674 | L2-Norm(final)=4.346 | 6650.5 samples/s | 103.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch= 8.8] | Loss=0.10456 | Reg=0.00278 | acc=0.9219 | L2-Norm=16.675 | L2-Norm(final)=4.687 | 3536.2 samples/s | 55.3 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.10545 | Reg=0.00284 | acc=0.9219 | L2-Norm=16.866 | L2-Norm(final)=4.678 | 4822.3 samples/s | 75.3 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.09775 | Reg=0.00289 | acc=0.9531 | L2-Norm=16.992 | L2-Norm(final)=4.670 | 4950.1 samples/s | 77.3 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.09438 | Reg=0.00291 | acc=0.9688 | L2-Norm=17.060 | L2-Norm(final)=4.667 | 4947.7 samples/s | 77.3 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.09131 | Reg=0.00293 | acc=0.9062 | L2-Norm=17.103 | L2-Norm(final)=4.661 | 4987.1 samples/s | 77.9 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.08759 | Reg=0.00294 | acc=0.9375 | L2-Norm=17.137 | L2-Norm(final)=4.658 | 4964.0 samples/s | 77.6 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.08564 | Reg=0.00295 | acc=0.9219 | L2-Norm=17.165 | L2-Norm(final)=4.652 | 4910.2 samples/s | 76.7 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.08357 | Reg=0.00296 | acc=0.9531 | L2-Norm=17.191 | L2-Norm(final)=4.648 | 4838.7 samples/s | 75.6 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.08094 | Reg=0.00296 | acc=0.9688 | L2-Norm=17.214 | L2-Norm(final)=4.645 | 4680.3 samples/s | 73.1 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.07951 | Reg=0.00297 | acc=0.9375 | L2-Norm=17.235 | L2-Norm(final)=4.640 | 4523.0 samples/s | 70.7 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.07736 | Reg=0.00298 | acc=0.8906 | L2-Norm=17.255 | L2-Norm(final)=4.636 | 5730.4 samples/s | 89.5 steps/s
[Step=5050 Epoch= 9.8] | Loss=0.07539 | Reg=0.00298 | acc=0.9375 | L2-Norm=17.275 | L2-Norm(final)=4.632 | 1806.0 samples/s | 28.2 steps/s
[Step=5100 Epoch= 9.9] | Loss=0.07324 | Reg=0.00299 | acc=0.9688 | L2-Norm=17.293 | L2-Norm(final)=4.630 | 4913.7 samples/s | 76.8 steps/s
[Step=5150 Epoch=10.0] | Loss=0.07125 | Reg=0.00300 | acc=0.9688 | L2-Norm=17.310 | L2-Norm(final)=4.627 | 4963.3 samples/s | 77.6 steps/s
[Step=5200 Epoch=10.1] | Loss=0.06962 | Reg=0.00300 | acc=0.9375 | L2-Norm=17.325 | L2-Norm(final)=4.626 | 4863.6 samples/s | 76.0 steps/s
[Step=5250 Epoch=10.2] | Loss=0.06801 | Reg=0.00301 | acc=0.9688 | L2-Norm=17.341 | L2-Norm(final)=4.624 | 4922.8 samples/s | 76.9 steps/s
[Step=5300 Epoch=10.3] | Loss=0.06667 | Reg=0.00301 | acc=0.9844 | L2-Norm=17.355 | L2-Norm(final)=4.623 | 4661.4 samples/s | 72.8 steps/s
[Step=5350 Epoch=10.4] | Loss=0.06573 | Reg=0.00302 | acc=0.9531 | L2-Norm=17.370 | L2-Norm(final)=4.622 | 4510.3 samples/s | 70.5 steps/s
[Step=5400 Epoch=10.5] | Loss=0.06516 | Reg=0.00302 | acc=0.9375 | L2-Norm=17.384 | L2-Norm(final)=4.620 | 4421.3 samples/s | 69.1 steps/s
[Step=5450 Epoch=10.6] | Loss=0.06398 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.398 | L2-Norm(final)=4.618 | 4930.9 samples/s | 77.0 steps/s
[Step=5500 Epoch=10.7] | Loss=0.06294 | Reg=0.00303 | acc=0.9375 | L2-Norm=17.412 | L2-Norm(final)=4.616 | 5315.8 samples/s | 83.1 steps/s
[Step=5550 Epoch=10.8] | Loss=0.06191 | Reg=0.00304 | acc=0.9219 | L2-Norm=17.425 | L2-Norm(final)=4.614 | 1947.4 samples/s | 30.4 steps/s
[Step=5600 Epoch=10.9] | Loss=0.06069 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.438 | L2-Norm(final)=4.612 | 5002.8 samples/s | 78.2 steps/s
[Step=5650 Epoch=11.0] | Loss=0.05955 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.450 | L2-Norm(final)=4.610 | 4975.6 samples/s | 77.7 steps/s
[Step=5700 Epoch=11.1] | Loss=0.05859 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.462 | L2-Norm(final)=4.608 | 4929.3 samples/s | 77.0 steps/s
[Step=5750 Epoch=11.2] | Loss=0.05763 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.474 | L2-Norm(final)=4.606 | 4580.8 samples/s | 71.6 steps/s
[Step=5800 Epoch=11.3] | Loss=0.05688 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.485 | L2-Norm(final)=4.605 | 4500.3 samples/s | 70.3 steps/s
[Step=5850 Epoch=11.4] | Loss=0.05651 | Reg=0.00306 | acc=0.9688 | L2-Norm=17.496 | L2-Norm(final)=4.604 | 4716.8 samples/s | 73.7 steps/s
[Step=5900 Epoch=11.5] | Loss=0.05573 | Reg=0.00307 | acc=0.9688 | L2-Norm=17.508 | L2-Norm(final)=4.602 | 4833.4 samples/s | 75.5 steps/s
[Step=5950 Epoch=11.6] | Loss=0.05512 | Reg=0.00307 | acc=0.9531 | L2-Norm=17.520 | L2-Norm(final)=4.601 | 4905.0 samples/s | 76.6 steps/s
[Step=6000 Epoch=11.7] | Loss=0.05441 | Reg=0.00307 | acc=0.9844 | L2-Norm=17.531 | L2-Norm(final)=4.600 | 4894.7 samples/s | 76.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step6000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.41915 | Reg=0.00278 | acc=0.4219 | L2-Norm=16.672 | L2-Norm(final)=1.952 | 3896.6 samples/s | 60.9 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.32933 | Reg=0.00278 | acc=0.7656 | L2-Norm=16.672 | L2-Norm(final)=1.976 | 5402.1 samples/s | 84.4 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.28041 | Reg=0.00278 | acc=0.8906 | L2-Norm=16.672 | L2-Norm(final)=2.069 | 5934.6 samples/s | 92.7 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.24942 | Reg=0.00278 | acc=0.9219 | L2-Norm=16.672 | L2-Norm(final)=2.189 | 5459.8 samples/s | 85.3 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.22733 | Reg=0.00278 | acc=0.8750 | L2-Norm=16.672 | L2-Norm(final)=2.316 | 5559.4 samples/s | 86.9 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.21248 | Reg=0.00278 | acc=0.9219 | L2-Norm=16.672 | L2-Norm(final)=2.443 | 7082.3 samples/s | 110.7 steps/s
[Step= 300 Epoch= 1.2] | Loss=0.20023 | Reg=0.00278 | acc=0.9531 | L2-Norm=16.672 | L2-Norm(final)=2.566 | 1918.8 samples/s | 30.0 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.19004 | Reg=0.00278 | acc=0.8750 | L2-Norm=16.672 | L2-Norm(final)=2.685 | 5794.2 samples/s | 90.5 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.18211 | Reg=0.00278 | acc=0.9844 | L2-Norm=16.672 | L2-Norm(final)=2.800 | 5785.4 samples/s | 90.4 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.17463 | Reg=0.00278 | acc=0.9062 | L2-Norm=16.672 | L2-Norm(final)=2.910 | 5796.9 samples/s | 90.6 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.16820 | Reg=0.00278 | acc=0.9375 | L2-Norm=16.672 | L2-Norm(final)=3.016 | 6943.6 samples/s | 108.5 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.9] | Loss=0.16138 | Reg=0.00278 | acc=0.8438 | L2-Norm=16.672 | L2-Norm(final)=4.059 | 3808.3 samples/s | 59.5 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.06347 | Reg=0.00275 | acc=0.9531 | L2-Norm=16.597 | L2-Norm(final)=4.073 | 4426.6 samples/s | 69.2 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.04619 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.599 | L2-Norm(final)=4.073 | 4412.4 samples/s | 68.9 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.03694 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.610 | L2-Norm(final)=4.074 | 4165.9 samples/s | 65.1 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.02972 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.614 | L2-Norm(final)=4.079 | 4539.1 samples/s | 70.9 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.02484 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.611 | L2-Norm(final)=4.084 | 6041.5 samples/s | 94.4 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.02139 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.604 | L2-Norm(final)=4.089 | 1798.1 samples/s | 28.1 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.01890 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.594 | L2-Norm(final)=4.093 | 4460.4 samples/s | 69.7 steps/s
[Step= 900 Epoch= 3.5] | Loss=0.01671 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.584 | L2-Norm(final)=4.098 | 4381.3 samples/s | 68.5 steps/s
[Step= 950 Epoch= 3.7] | Loss=0.01546 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.571 | L2-Norm(final)=4.101 | 4333.1 samples/s | 67.7 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.01412 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.559 | L2-Norm(final)=4.104 | 4885.6 samples/s | 76.3 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.01335 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.549 | L2-Norm(final)=4.106 | 1809.6 samples/s | 28.3 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01253 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.540 | L2-Norm(final)=4.109 | 4693.3 samples/s | 73.3 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01180 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.532 | L2-Norm(final)=4.111 | 4610.8 samples/s | 72.0 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01122 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.526 | L2-Norm(final)=4.113 | 4627.9 samples/s | 72.3 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.01057 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.520 | L2-Norm(final)=4.115 | 4678.6 samples/s | 73.1 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.00992 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.512 | L2-Norm(final)=4.117 | 1935.8 samples/s | 30.2 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.00935 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.502 | L2-Norm(final)=4.119 | 4446.3 samples/s | 69.5 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00883 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.489 | L2-Norm(final)=4.121 | 4360.5 samples/s | 68.1 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00837 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.475 | L2-Norm(final)=4.123 | 4682.3 samples/s | 73.2 steps/s
[Step=1500 Epoch= 5.8] | Loss=0.00795 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.458 | L2-Norm(final)=4.125 | 4600.1 samples/s | 71.9 steps/s
[Step=1550 Epoch= 6.0] | Loss=0.00758 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.441 | L2-Norm(final)=4.127 | 2018.9 samples/s | 31.5 steps/s
[Step=1600 Epoch= 6.2] | Loss=0.00724 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.422 | L2-Norm(final)=4.128 | 4581.3 samples/s | 71.6 steps/s
[Step=1650 Epoch= 6.4] | Loss=0.00692 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.401 | L2-Norm(final)=4.130 | 4620.6 samples/s | 72.2 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.00663 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.380 | L2-Norm(final)=4.131 | 4585.5 samples/s | 71.6 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.00637 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.358 | L2-Norm(final)=4.132 | 4367.5 samples/s | 68.2 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.00613 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.335 | L2-Norm(final)=4.134 | 6135.2 samples/s | 95.9 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00590 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.311 | L2-Norm(final)=4.135 | 1720.1 samples/s | 26.9 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00569 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.286 | L2-Norm(final)=4.136 | 4831.3 samples/s | 75.5 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00549 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.261 | L2-Norm(final)=4.137 | 4616.3 samples/s | 72.1 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00531 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.235 | L2-Norm(final)=4.138 | 4612.3 samples/s | 72.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08003 | acc=0.9505 | tpr=0.9540 | fpr=0.0572 | 4110.0 samples/s | 16.1 steps/s
Avg test loss: 0.07900, Avg test acc: 0.94939, Avg tpr: 0.95244, Avg fpr: 0.05730, total FA: 447

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07860 | acc=0.9477 | tpr=0.9584 | fpr=0.0753 | 4275.0 samples/s | 16.7 steps/s
Avg test loss: 0.08003, Avg test acc: 0.94639, Avg tpr: 0.95739, Avg fpr: 0.07781, total FA: 607

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.84307 | acc=0.2957 | tpr=0.0245 | fpr=0.1155 | 4124.5 samples/s | 16.1 steps/s
Avg test loss: 5.83296, Avg test acc: 0.29494, Avg tpr: 0.02594, Avg fpr: 0.11345, total FA: 885

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.43740 | acc=0.3077 | tpr=0.0187 | fpr=0.0649 | 4238.5 samples/s | 16.6 steps/s
Avg test loss: 6.41438, Avg test acc: 0.30800, Avg tpr: 0.02092, Avg fpr: 0.06063, total FA: 473

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.66772 | acc=0.1541 | tpr=0.8761 | fpr=0.8589 | 4424.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=3.64133 | acc=0.1567 | tpr=0.8635 | fpr=0.8565 | 8452.3 samples/s | 33.0 steps/s
[Step= 150] | Loss=3.64084 | acc=0.1570 | tpr=0.8732 | fpr=0.8562 | 8317.8 samples/s | 32.5 steps/s
[Step= 200] | Loss=3.63474 | acc=0.1567 | tpr=0.8721 | fpr=0.8563 | 8060.9 samples/s | 31.5 steps/s
[Step= 250] | Loss=3.63493 | acc=0.1568 | tpr=0.8638 | fpr=0.8560 | 8793.8 samples/s | 34.4 steps/s
[Step= 300] | Loss=3.63025 | acc=0.1566 | tpr=0.8575 | fpr=0.8562 | 7930.8 samples/s | 31.0 steps/s
[Step= 350] | Loss=3.62852 | acc=0.1562 | tpr=0.8585 | fpr=0.8565 | 7858.1 samples/s | 30.7 steps/s
[Step= 400] | Loss=3.62717 | acc=0.1561 | tpr=0.8561 | fpr=0.8566 | 8212.9 samples/s | 32.1 steps/s
[Step= 450] | Loss=3.62683 | acc=0.1560 | tpr=0.8583 | fpr=0.8568 | 8775.0 samples/s | 34.3 steps/s
[Step= 500] | Loss=3.62592 | acc=0.1557 | tpr=0.8586 | fpr=0.8570 | 8389.6 samples/s | 32.8 steps/s
[Step= 550] | Loss=3.62425 | acc=0.1557 | tpr=0.8579 | fpr=0.8570 | 15643.8 samples/s | 61.1 steps/s
Avg test loss: 3.62565, Avg test acc: 0.15565, Avg tpr: 0.85816, Avg fpr: 0.85712, total FA: 119010

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=2.42765 | acc=0.1488 | tpr=0.8938 | fpr=0.8646 | 4101.3 samples/s | 16.0 steps/s
[Step= 100] | Loss=2.41546 | acc=0.1502 | tpr=0.8550 | fpr=0.8630 | 8177.5 samples/s | 31.9 steps/s
[Step= 150] | Loss=2.41857 | acc=0.1511 | tpr=0.8429 | fpr=0.8616 | 8494.0 samples/s | 33.2 steps/s
[Step= 200] | Loss=2.41954 | acc=0.1511 | tpr=0.8426 | fpr=0.8615 | 8177.5 samples/s | 31.9 steps/s
[Step= 250] | Loss=2.42034 | acc=0.1518 | tpr=0.8358 | fpr=0.8607 | 8399.8 samples/s | 32.8 steps/s
[Step= 300] | Loss=2.42208 | acc=0.1510 | tpr=0.8313 | fpr=0.8614 | 8699.4 samples/s | 34.0 steps/s
[Step= 350] | Loss=2.42156 | acc=0.1505 | tpr=0.8322 | fpr=0.8619 | 9180.3 samples/s | 35.9 steps/s
[Step= 400] | Loss=2.42061 | acc=0.1506 | tpr=0.8326 | fpr=0.8618 | 7996.1 samples/s | 31.2 steps/s
[Step= 450] | Loss=2.42185 | acc=0.1504 | tpr=0.8354 | fpr=0.8621 | 8047.5 samples/s | 31.4 steps/s
[Step= 500] | Loss=2.42355 | acc=0.1502 | tpr=0.8339 | fpr=0.8621 | 8724.8 samples/s | 34.1 steps/s
[Step= 550] | Loss=2.42474 | acc=0.1501 | tpr=0.8317 | fpr=0.8623 | 15486.5 samples/s | 60.5 steps/s
Avg test loss: 2.42506, Avg test acc: 0.15005, Avg tpr: 0.83122, Avg fpr: 0.86233, total FA: 119733

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07821 | acc=0.9822 | tpr=0.9292 | fpr=0.0169 | 4267.9 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.07972 | acc=0.9814 | tpr=0.9254 | fpr=0.0175 | 8042.0 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.08228 | acc=0.9806 | tpr=0.9265 | fpr=0.0184 | 8960.6 samples/s | 35.0 steps/s
[Step= 200] | Loss=0.08340 | acc=0.9808 | tpr=0.9322 | fpr=0.0183 | 8752.6 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.08203 | acc=0.9812 | tpr=0.9301 | fpr=0.0179 | 8237.8 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.08265 | acc=0.9810 | tpr=0.9295 | fpr=0.0181 | 8239.1 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.08298 | acc=0.9808 | tpr=0.9311 | fpr=0.0183 | 8386.3 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.08440 | acc=0.9806 | tpr=0.9272 | fpr=0.0185 | 8733.2 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.08640 | acc=0.9802 | tpr=0.9250 | fpr=0.0188 | 8811.6 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.08570 | acc=0.9803 | tpr=0.9282 | fpr=0.0188 | 7731.1 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.08513 | acc=0.9804 | tpr=0.9288 | fpr=0.0187 | 14546.6 samples/s | 56.8 steps/s
Avg test loss: 0.08512, Avg test acc: 0.98038, Avg tpr: 0.92868, Avg fpr: 0.01868, total FA: 2594

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09700 | acc=0.9799 | tpr=0.9513 | fpr=0.0196 | 4213.9 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.10271 | acc=0.9791 | tpr=0.9467 | fpr=0.0203 | 8661.1 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.10558 | acc=0.9785 | tpr=0.9539 | fpr=0.0210 | 7810.2 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.10759 | acc=0.9786 | tpr=0.9574 | fpr=0.0210 | 8929.4 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.10609 | acc=0.9788 | tpr=0.9520 | fpr=0.0207 | 8694.8 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.10788 | acc=0.9785 | tpr=0.9484 | fpr=0.0209 | 8758.4 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.10828 | acc=0.9785 | tpr=0.9512 | fpr=0.0210 | 7738.7 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.10959 | acc=0.9782 | tpr=0.9469 | fpr=0.0212 | 8578.5 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.11144 | acc=0.9781 | tpr=0.9455 | fpr=0.0213 | 8867.5 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.11076 | acc=0.9781 | tpr=0.9445 | fpr=0.0212 | 8695.5 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.10957 | acc=0.9784 | tpr=0.9451 | fpr=0.0210 | 14650.1 samples/s | 57.2 steps/s
Avg test loss: 0.10943, Avg test acc: 0.97836, Avg tpr: 0.94493, Avg fpr: 0.02103, total FA: 2920

server round 3/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=11.7] | Loss=0.07483 | Reg=0.00253 | acc=0.9375 | L2-Norm=15.903 | L2-Norm(final)=4.566 | 3291.8 samples/s | 51.4 steps/s
[Step=6050 Epoch=11.8] | Loss=0.09783 | Reg=0.00253 | acc=0.9375 | L2-Norm=15.908 | L2-Norm(final)=4.513 | 5217.1 samples/s | 81.5 steps/s
[Step=6100 Epoch=11.9] | Loss=0.08920 | Reg=0.00253 | acc=0.9375 | L2-Norm=15.909 | L2-Norm(final)=4.481 | 5551.3 samples/s | 86.7 steps/s
[Step=6150 Epoch=12.0] | Loss=0.08778 | Reg=0.00253 | acc=0.9219 | L2-Norm=15.909 | L2-Norm(final)=4.453 | 5521.9 samples/s | 86.3 steps/s
[Step=6200 Epoch=12.1] | Loss=0.08638 | Reg=0.00253 | acc=0.8906 | L2-Norm=15.909 | L2-Norm(final)=4.426 | 5530.6 samples/s | 86.4 steps/s
[Step=6250 Epoch=12.2] | Loss=0.08584 | Reg=0.00253 | acc=0.9062 | L2-Norm=15.910 | L2-Norm(final)=4.410 | 5637.9 samples/s | 88.1 steps/s
[Step=6300 Epoch=12.3] | Loss=0.08494 | Reg=0.00253 | acc=0.9688 | L2-Norm=15.910 | L2-Norm(final)=4.397 | 5709.3 samples/s | 89.2 steps/s
[Step=6350 Epoch=12.4] | Loss=0.08353 | Reg=0.00253 | acc=0.9375 | L2-Norm=15.910 | L2-Norm(final)=4.389 | 5728.6 samples/s | 89.5 steps/s
[Step=6400 Epoch=12.5] | Loss=0.08265 | Reg=0.00253 | acc=0.9688 | L2-Norm=15.910 | L2-Norm(final)=4.388 | 5641.3 samples/s | 88.1 steps/s
[Step=6450 Epoch=12.6] | Loss=0.08208 | Reg=0.00253 | acc=0.9219 | L2-Norm=15.910 | L2-Norm(final)=4.393 | 5747.0 samples/s | 89.8 steps/s
[Step=6500 Epoch=12.7] | Loss=0.08203 | Reg=0.00253 | acc=0.9688 | L2-Norm=15.910 | L2-Norm(final)=4.397 | 6771.7 samples/s | 105.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=12.7] | Loss=0.07270 | Reg=0.00253 | acc=0.9219 | L2-Norm=15.910 | L2-Norm(final)=4.440 | 3409.6 samples/s | 53.3 steps/s
[Step=6550 Epoch=12.8] | Loss=0.08829 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.148 | L2-Norm(final)=4.433 | 4762.3 samples/s | 74.4 steps/s
[Step=6600 Epoch=12.9] | Loss=0.08549 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.304 | L2-Norm(final)=4.418 | 5042.0 samples/s | 78.8 steps/s
[Step=6650 Epoch=13.0] | Loss=0.08567 | Reg=0.00269 | acc=0.9219 | L2-Norm=16.392 | L2-Norm(final)=4.408 | 4829.3 samples/s | 75.5 steps/s
[Step=6700 Epoch=13.1] | Loss=0.08106 | Reg=0.00271 | acc=0.9375 | L2-Norm=16.453 | L2-Norm(final)=4.400 | 4846.0 samples/s | 75.7 steps/s
[Step=6750 Epoch=13.2] | Loss=0.07861 | Reg=0.00272 | acc=0.9375 | L2-Norm=16.499 | L2-Norm(final)=4.394 | 4924.6 samples/s | 76.9 steps/s
[Step=6800 Epoch=13.3] | Loss=0.07803 | Reg=0.00274 | acc=0.9062 | L2-Norm=16.540 | L2-Norm(final)=4.388 | 4995.8 samples/s | 78.1 steps/s
[Step=6850 Epoch=13.4] | Loss=0.07627 | Reg=0.00275 | acc=0.9688 | L2-Norm=16.576 | L2-Norm(final)=4.383 | 4928.9 samples/s | 77.0 steps/s
[Step=6900 Epoch=13.5] | Loss=0.07351 | Reg=0.00276 | acc=0.9531 | L2-Norm=16.607 | L2-Norm(final)=4.379 | 4926.3 samples/s | 77.0 steps/s
[Step=6950 Epoch=13.6] | Loss=0.07208 | Reg=0.00277 | acc=0.9375 | L2-Norm=16.635 | L2-Norm(final)=4.376 | 4679.9 samples/s | 73.1 steps/s
[Step=7000 Epoch=13.7] | Loss=0.07039 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.660 | L2-Norm(final)=4.373 | 5546.4 samples/s | 86.7 steps/s
[Step=7050 Epoch=13.8] | Loss=0.06756 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.683 | L2-Norm(final)=4.371 | 1805.4 samples/s | 28.2 steps/s
[Step=7100 Epoch=13.8] | Loss=0.06560 | Reg=0.00279 | acc=0.9688 | L2-Norm=16.705 | L2-Norm(final)=4.371 | 4960.6 samples/s | 77.5 steps/s
[Step=7150 Epoch=13.9] | Loss=0.06421 | Reg=0.00280 | acc=0.9375 | L2-Norm=16.726 | L2-Norm(final)=4.370 | 4817.7 samples/s | 75.3 steps/s
[Step=7200 Epoch=14.0] | Loss=0.06278 | Reg=0.00281 | acc=0.9219 | L2-Norm=16.747 | L2-Norm(final)=4.370 | 4907.7 samples/s | 76.7 steps/s
[Step=7250 Epoch=14.1] | Loss=0.06117 | Reg=0.00281 | acc=0.9531 | L2-Norm=16.767 | L2-Norm(final)=4.369 | 4849.1 samples/s | 75.8 steps/s
[Step=7300 Epoch=14.2] | Loss=0.06039 | Reg=0.00282 | acc=0.9531 | L2-Norm=16.787 | L2-Norm(final)=4.368 | 4800.3 samples/s | 75.0 steps/s
[Step=7350 Epoch=14.3] | Loss=0.05966 | Reg=0.00283 | acc=0.9375 | L2-Norm=16.808 | L2-Norm(final)=4.367 | 4731.1 samples/s | 73.9 steps/s
[Step=7400 Epoch=14.4] | Loss=0.05865 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.829 | L2-Norm(final)=4.366 | 4595.8 samples/s | 71.8 steps/s
[Step=7450 Epoch=14.5] | Loss=0.05786 | Reg=0.00284 | acc=0.9531 | L2-Norm=16.849 | L2-Norm(final)=4.366 | 4483.7 samples/s | 70.1 steps/s
[Step=7500 Epoch=14.6] | Loss=0.05733 | Reg=0.00285 | acc=0.9688 | L2-Norm=16.867 | L2-Norm(final)=4.364 | 5026.4 samples/s | 78.5 steps/s
[Step=7550 Epoch=14.7] | Loss=0.05633 | Reg=0.00285 | acc=0.9688 | L2-Norm=16.885 | L2-Norm(final)=4.362 | 1886.5 samples/s | 29.5 steps/s
[Step=7600 Epoch=14.8] | Loss=0.05513 | Reg=0.00286 | acc=0.9844 | L2-Norm=16.902 | L2-Norm(final)=4.360 | 4914.2 samples/s | 76.8 steps/s
[Step=7650 Epoch=14.9] | Loss=0.05425 | Reg=0.00286 | acc=0.9688 | L2-Norm=16.918 | L2-Norm(final)=4.359 | 4917.5 samples/s | 76.8 steps/s
[Step=7700 Epoch=15.0] | Loss=0.05320 | Reg=0.00287 | acc=0.9688 | L2-Norm=16.933 | L2-Norm(final)=4.358 | 4982.2 samples/s | 77.8 steps/s
[Step=7750 Epoch=15.1] | Loss=0.05240 | Reg=0.00287 | acc=0.9375 | L2-Norm=16.949 | L2-Norm(final)=4.357 | 4869.5 samples/s | 76.1 steps/s
[Step=7800 Epoch=15.2] | Loss=0.05199 | Reg=0.00288 | acc=0.9844 | L2-Norm=16.964 | L2-Norm(final)=4.356 | 4664.9 samples/s | 72.9 steps/s
[Step=7850 Epoch=15.3] | Loss=0.05139 | Reg=0.00288 | acc=0.9688 | L2-Norm=16.980 | L2-Norm(final)=4.354 | 4496.4 samples/s | 70.3 steps/s
[Step=7900 Epoch=15.4] | Loss=0.05071 | Reg=0.00289 | acc=0.9531 | L2-Norm=16.994 | L2-Norm(final)=4.353 | 4639.6 samples/s | 72.5 steps/s
[Step=7950 Epoch=15.5] | Loss=0.05020 | Reg=0.00289 | acc=0.9375 | L2-Norm=17.008 | L2-Norm(final)=4.352 | 4714.7 samples/s | 73.7 steps/s
[Step=8000 Epoch=15.6] | Loss=0.04975 | Reg=0.00290 | acc=0.9531 | L2-Norm=17.022 | L2-Norm(final)=4.350 | 4699.3 samples/s | 73.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step8000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 7.7] | Loss=0.12061 | Reg=0.00253 | acc=0.8594 | L2-Norm=15.903 | L2-Norm(final)=4.162 | 3906.0 samples/s | 61.0 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.05858 | Reg=0.00253 | acc=0.9375 | L2-Norm=15.892 | L2-Norm(final)=4.075 | 4628.2 samples/s | 72.3 steps/s
[Step=2100 Epoch= 8.0] | Loss=0.04845 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.891 | L2-Norm(final)=4.137 | 5516.7 samples/s | 86.2 steps/s
[Step=2150 Epoch= 8.2] | Loss=0.04361 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.890 | L2-Norm(final)=4.206 | 5260.4 samples/s | 82.2 steps/s
[Step=2200 Epoch= 8.4] | Loss=0.04269 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.890 | L2-Norm(final)=4.274 | 5100.0 samples/s | 79.7 steps/s
[Step=2250 Epoch= 8.6] | Loss=0.04088 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.890 | L2-Norm(final)=4.339 | 6377.8 samples/s | 99.7 steps/s
[Step=2300 Epoch= 8.8] | Loss=0.03967 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.890 | L2-Norm(final)=4.397 | 1849.6 samples/s | 28.9 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.03871 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.890 | L2-Norm(final)=4.456 | 5375.8 samples/s | 84.0 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.03796 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.890 | L2-Norm(final)=4.513 | 5333.3 samples/s | 83.3 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.03732 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.890 | L2-Norm(final)=4.565 | 5480.5 samples/s | 85.6 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.03711 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.890 | L2-Norm(final)=4.617 | 5869.7 samples/s | 91.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 9.6] | Loss=0.04079 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.889 | L2-Norm(final)=5.127 | 3792.3 samples/s | 59.3 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.05713 | Reg=0.00265 | acc=0.9688 | L2-Norm=16.283 | L2-Norm(final)=5.093 | 4409.3 samples/s | 68.9 steps/s
[Step=2600 Epoch=10.0] | Loss=0.03986 | Reg=0.00274 | acc=0.9844 | L2-Norm=16.554 | L2-Norm(final)=5.056 | 4379.9 samples/s | 68.4 steps/s
[Step=2650 Epoch=10.2] | Loss=0.02842 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.656 | L2-Norm(final)=5.042 | 4209.0 samples/s | 65.8 steps/s
[Step=2700 Epoch=10.3] | Loss=0.02266 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.699 | L2-Norm(final)=5.037 | 4486.4 samples/s | 70.1 steps/s
[Step=2750 Epoch=10.5] | Loss=0.01868 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.717 | L2-Norm(final)=5.035 | 5657.9 samples/s | 88.4 steps/s
[Step=2800 Epoch=10.7] | Loss=0.01590 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.720 | L2-Norm(final)=5.034 | 1824.3 samples/s | 28.5 steps/s
[Step=2850 Epoch=10.9] | Loss=0.01365 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.714 | L2-Norm(final)=5.035 | 4711.0 samples/s | 73.6 steps/s
[Step=2900 Epoch=11.1] | Loss=0.01198 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.700 | L2-Norm(final)=5.036 | 4749.8 samples/s | 74.2 steps/s
[Step=2950 Epoch=11.3] | Loss=0.01068 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.682 | L2-Norm(final)=5.037 | 4628.4 samples/s | 72.3 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00963 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.661 | L2-Norm(final)=5.038 | 4913.2 samples/s | 76.8 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00876 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.638 | L2-Norm(final)=5.039 | 1818.6 samples/s | 28.4 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00803 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.612 | L2-Norm(final)=5.040 | 4482.2 samples/s | 70.0 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00741 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.586 | L2-Norm(final)=5.041 | 4479.5 samples/s | 70.0 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00689 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.558 | L2-Norm(final)=5.042 | 4730.5 samples/s | 73.9 steps/s
[Step=3250 Epoch=12.5] | Loss=0.00643 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.529 | L2-Norm(final)=5.043 | 4673.2 samples/s | 73.0 steps/s
[Step=3300 Epoch=12.6] | Loss=0.00603 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.499 | L2-Norm(final)=5.044 | 2002.6 samples/s | 31.3 steps/s
[Step=3350 Epoch=12.8] | Loss=0.00567 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.469 | L2-Norm(final)=5.045 | 4427.4 samples/s | 69.2 steps/s
[Step=3400 Epoch=13.0] | Loss=0.00536 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.438 | L2-Norm(final)=5.045 | 4296.9 samples/s | 67.1 steps/s
[Step=3450 Epoch=13.2] | Loss=0.00508 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.407 | L2-Norm(final)=5.046 | 4530.5 samples/s | 70.8 steps/s
[Step=3500 Epoch=13.4] | Loss=0.00482 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.376 | L2-Norm(final)=5.047 | 4598.3 samples/s | 71.8 steps/s
[Step=3550 Epoch=13.6] | Loss=0.00460 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.344 | L2-Norm(final)=5.047 | 2020.8 samples/s | 31.6 steps/s
[Step=3600 Epoch=13.8] | Loss=0.00439 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.313 | L2-Norm(final)=5.048 | 4648.1 samples/s | 72.6 steps/s
[Step=3650 Epoch=14.0] | Loss=0.00420 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.280 | L2-Norm(final)=5.048 | 4740.0 samples/s | 74.1 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00402 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.248 | L2-Norm(final)=5.049 | 4608.0 samples/s | 72.0 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00386 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.216 | L2-Norm(final)=5.049 | 4437.6 samples/s | 69.3 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00371 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.183 | L2-Norm(final)=5.050 | 5664.2 samples/s | 88.5 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00358 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.151 | L2-Norm(final)=5.050 | 1722.9 samples/s | 26.9 steps/s
[Step=3900 Epoch=14.9] | Loss=0.00345 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.118 | L2-Norm(final)=5.051 | 4654.1 samples/s | 72.7 steps/s
[Step=3950 Epoch=15.1] | Loss=0.00333 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.085 | L2-Norm(final)=5.051 | 4586.1 samples/s | 71.7 steps/s
[Step=4000 Epoch=15.3] | Loss=0.00322 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.052 | L2-Norm(final)=5.052 | 4707.7 samples/s | 73.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08744 | acc=0.9377 | tpr=0.9277 | fpr=0.0404 | 4129.3 samples/s | 16.1 steps/s
Avg test loss: 0.08721, Avg test acc: 0.93854, Avg tpr: 0.92755, Avg fpr: 0.03730, total FA: 291

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07860 | acc=0.9477 | tpr=0.9584 | fpr=0.0753 | 4381.7 samples/s | 17.1 steps/s
Avg test loss: 0.08003, Avg test acc: 0.94639, Avg tpr: 0.95739, Avg fpr: 0.07781, total FA: 607

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.52809 | acc=0.3124 | tpr=0.0204 | fpr=0.0535 | 4144.2 samples/s | 16.2 steps/s
Avg test loss: 5.51967, Avg test acc: 0.30964, Avg tpr: 0.02017, Avg fpr: 0.05371, total FA: 419

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.43740 | acc=0.3077 | tpr=0.0187 | fpr=0.0649 | 4300.9 samples/s | 16.8 steps/s
Avg test loss: 6.41438, Avg test acc: 0.30800, Avg tpr: 0.02092, Avg fpr: 0.06063, total FA: 473

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=2.81306 | acc=0.1648 | tpr=0.7876 | fpr=0.8464 | 4232.9 samples/s | 16.5 steps/s
[Step= 100] | Loss=2.80433 | acc=0.1649 | tpr=0.7527 | fpr=0.8460 | 8366.8 samples/s | 32.7 steps/s
[Step= 150] | Loss=2.80377 | acc=0.1664 | tpr=0.7493 | fpr=0.8443 | 8506.5 samples/s | 33.2 steps/s
[Step= 200] | Loss=2.80187 | acc=0.1663 | tpr=0.7454 | fpr=0.8442 | 7802.2 samples/s | 30.5 steps/s
[Step= 250] | Loss=2.80226 | acc=0.1666 | tpr=0.7380 | fpr=0.8438 | 8573.2 samples/s | 33.5 steps/s
[Step= 300] | Loss=2.79837 | acc=0.1668 | tpr=0.7287 | fpr=0.8434 | 8717.1 samples/s | 34.1 steps/s
[Step= 350] | Loss=2.79604 | acc=0.1663 | tpr=0.7314 | fpr=0.8439 | 8155.8 samples/s | 31.9 steps/s
[Step= 400] | Loss=2.79355 | acc=0.1667 | tpr=0.7221 | fpr=0.8434 | 8584.6 samples/s | 33.5 steps/s
[Step= 450] | Loss=2.79413 | acc=0.1664 | tpr=0.7220 | fpr=0.8437 | 8228.2 samples/s | 32.1 steps/s
[Step= 500] | Loss=2.79386 | acc=0.1665 | tpr=0.7167 | fpr=0.8434 | 8594.1 samples/s | 33.6 steps/s
[Step= 550] | Loss=2.79454 | acc=0.1665 | tpr=0.7151 | fpr=0.8435 | 15716.1 samples/s | 61.4 steps/s
Avg test loss: 2.79540, Avg test acc: 0.16638, Avg tpr: 0.71513, Avg fpr: 0.84359, total FA: 117131

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=2.42765 | acc=0.1488 | tpr=0.8938 | fpr=0.8646 | 4067.7 samples/s | 15.9 steps/s
[Step= 100] | Loss=2.41546 | acc=0.1502 | tpr=0.8550 | fpr=0.8630 | 8224.4 samples/s | 32.1 steps/s
[Step= 150] | Loss=2.41857 | acc=0.1511 | tpr=0.8429 | fpr=0.8616 | 8908.0 samples/s | 34.8 steps/s
[Step= 200] | Loss=2.41954 | acc=0.1511 | tpr=0.8426 | fpr=0.8615 | 8191.8 samples/s | 32.0 steps/s
[Step= 250] | Loss=2.42034 | acc=0.1518 | tpr=0.8358 | fpr=0.8607 | 8224.2 samples/s | 32.1 steps/s
[Step= 300] | Loss=2.42208 | acc=0.1510 | tpr=0.8313 | fpr=0.8614 | 8738.8 samples/s | 34.1 steps/s
[Step= 350] | Loss=2.42156 | acc=0.1505 | tpr=0.8322 | fpr=0.8619 | 9160.5 samples/s | 35.8 steps/s
[Step= 400] | Loss=2.42061 | acc=0.1506 | tpr=0.8326 | fpr=0.8618 | 8418.8 samples/s | 32.9 steps/s
[Step= 450] | Loss=2.42185 | acc=0.1504 | tpr=0.8354 | fpr=0.8621 | 7888.8 samples/s | 30.8 steps/s
[Step= 500] | Loss=2.42355 | acc=0.1502 | tpr=0.8339 | fpr=0.8621 | 8600.8 samples/s | 33.6 steps/s
[Step= 550] | Loss=2.42474 | acc=0.1501 | tpr=0.8317 | fpr=0.8623 | 14908.2 samples/s | 58.2 steps/s
Avg test loss: 2.42506, Avg test acc: 0.15005, Avg tpr: 0.83122, Avg fpr: 0.86233, total FA: 119733

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12628 | acc=0.9819 | tpr=0.9381 | fpr=0.0173 | 4245.6 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.13259 | acc=0.9805 | tpr=0.9446 | fpr=0.0188 | 8195.6 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.13757 | acc=0.9793 | tpr=0.9452 | fpr=0.0200 | 8103.6 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.13953 | acc=0.9793 | tpr=0.9508 | fpr=0.0202 | 8584.8 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.13618 | acc=0.9796 | tpr=0.9493 | fpr=0.0198 | 8733.7 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.13811 | acc=0.9793 | tpr=0.9484 | fpr=0.0201 | 8508.6 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.13956 | acc=0.9790 | tpr=0.9505 | fpr=0.0204 | 8152.6 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.14124 | acc=0.9787 | tpr=0.9458 | fpr=0.0207 | 8750.4 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.14443 | acc=0.9783 | tpr=0.9430 | fpr=0.0211 | 8441.1 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.14330 | acc=0.9783 | tpr=0.9441 | fpr=0.0211 | 7879.2 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.14191 | acc=0.9784 | tpr=0.9435 | fpr=0.0210 | 15488.2 samples/s | 60.5 steps/s
Avg test loss: 0.14169, Avg test acc: 0.97840, Avg tpr: 0.94295, Avg fpr: 0.02096, total FA: 2910

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09700 | acc=0.9799 | tpr=0.9513 | fpr=0.0196 | 4392.3 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.10271 | acc=0.9791 | tpr=0.9467 | fpr=0.0203 | 8346.3 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.10558 | acc=0.9785 | tpr=0.9539 | fpr=0.0210 | 7930.8 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.10759 | acc=0.9786 | tpr=0.9574 | fpr=0.0210 | 8595.9 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.10609 | acc=0.9788 | tpr=0.9520 | fpr=0.0207 | 8613.4 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.10788 | acc=0.9785 | tpr=0.9484 | fpr=0.0209 | 8664.1 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.10828 | acc=0.9785 | tpr=0.9512 | fpr=0.0210 | 7743.5 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.10959 | acc=0.9782 | tpr=0.9469 | fpr=0.0212 | 8490.8 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.11144 | acc=0.9781 | tpr=0.9455 | fpr=0.0213 | 8615.8 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.11076 | acc=0.9781 | tpr=0.9445 | fpr=0.0212 | 8292.6 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.10957 | acc=0.9784 | tpr=0.9451 | fpr=0.0210 | 16212.2 samples/s | 63.3 steps/s
Avg test loss: 0.10943, Avg test acc: 0.97836, Avg tpr: 0.94493, Avg fpr: 0.02103, total FA: 2920

server round 4/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=15.6] | Loss=0.08985 | Reg=0.00242 | acc=0.9062 | L2-Norm=15.543 | L2-Norm(final)=4.305 | 3591.5 samples/s | 56.1 steps/s
[Step=8050 Epoch=15.7] | Loss=0.09278 | Reg=0.00242 | acc=0.9375 | L2-Norm=15.550 | L2-Norm(final)=4.293 | 4718.8 samples/s | 73.7 steps/s
[Step=8100 Epoch=15.8] | Loss=0.08774 | Reg=0.00242 | acc=0.8750 | L2-Norm=15.551 | L2-Norm(final)=4.292 | 5467.5 samples/s | 85.4 steps/s
[Step=8150 Epoch=15.9] | Loss=0.08449 | Reg=0.00242 | acc=0.9375 | L2-Norm=15.552 | L2-Norm(final)=4.298 | 5500.0 samples/s | 85.9 steps/s
[Step=8200 Epoch=16.0] | Loss=0.08414 | Reg=0.00242 | acc=0.9219 | L2-Norm=15.552 | L2-Norm(final)=4.305 | 5597.7 samples/s | 87.5 steps/s
[Step=8250 Epoch=16.1] | Loss=0.08351 | Reg=0.00242 | acc=0.8750 | L2-Norm=15.552 | L2-Norm(final)=4.314 | 5703.6 samples/s | 89.1 steps/s
[Step=8300 Epoch=16.2] | Loss=0.08179 | Reg=0.00242 | acc=0.9531 | L2-Norm=15.552 | L2-Norm(final)=4.323 | 5643.0 samples/s | 88.2 steps/s
[Step=8350 Epoch=16.3] | Loss=0.08178 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.552 | L2-Norm(final)=4.335 | 5687.1 samples/s | 88.9 steps/s
[Step=8400 Epoch=16.4] | Loss=0.08160 | Reg=0.00242 | acc=0.8906 | L2-Norm=15.552 | L2-Norm(final)=4.349 | 5785.6 samples/s | 90.4 steps/s
[Step=8450 Epoch=16.5] | Loss=0.08191 | Reg=0.00242 | acc=0.9375 | L2-Norm=15.552 | L2-Norm(final)=4.363 | 5646.3 samples/s | 88.2 steps/s
[Step=8500 Epoch=16.6] | Loss=0.08230 | Reg=0.00242 | acc=0.9219 | L2-Norm=15.552 | L2-Norm(final)=4.374 | 6828.2 samples/s | 106.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=16.6] | Loss=0.09811 | Reg=0.00242 | acc=0.9062 | L2-Norm=15.553 | L2-Norm(final)=4.481 | 3469.7 samples/s | 54.2 steps/s
[Step=8550 Epoch=16.7] | Loss=0.08843 | Reg=0.00248 | acc=0.8594 | L2-Norm=15.740 | L2-Norm(final)=4.470 | 4217.7 samples/s | 65.9 steps/s
[Step=8600 Epoch=16.8] | Loss=0.07921 | Reg=0.00253 | acc=0.9531 | L2-Norm=15.892 | L2-Norm(final)=4.455 | 4836.2 samples/s | 75.6 steps/s
[Step=8650 Epoch=16.9] | Loss=0.07679 | Reg=0.00255 | acc=0.9219 | L2-Norm=15.983 | L2-Norm(final)=4.440 | 4872.2 samples/s | 76.1 steps/s
[Step=8700 Epoch=17.0] | Loss=0.07354 | Reg=0.00258 | acc=0.9531 | L2-Norm=16.050 | L2-Norm(final)=4.428 | 4941.0 samples/s | 77.2 steps/s
[Step=8750 Epoch=17.1] | Loss=0.07167 | Reg=0.00259 | acc=0.9531 | L2-Norm=16.101 | L2-Norm(final)=4.420 | 4872.9 samples/s | 76.1 steps/s
[Step=8800 Epoch=17.2] | Loss=0.06930 | Reg=0.00261 | acc=0.9688 | L2-Norm=16.145 | L2-Norm(final)=4.414 | 4824.2 samples/s | 75.4 steps/s
[Step=8850 Epoch=17.3] | Loss=0.06739 | Reg=0.00262 | acc=0.9531 | L2-Norm=16.184 | L2-Norm(final)=4.409 | 4998.4 samples/s | 78.1 steps/s
[Step=8900 Epoch=17.4] | Loss=0.06643 | Reg=0.00263 | acc=0.9062 | L2-Norm=16.223 | L2-Norm(final)=4.403 | 4807.2 samples/s | 75.1 steps/s
[Step=8950 Epoch=17.5] | Loss=0.06551 | Reg=0.00264 | acc=0.9531 | L2-Norm=16.259 | L2-Norm(final)=4.398 | 4642.8 samples/s | 72.5 steps/s
[Step=9000 Epoch=17.6] | Loss=0.06432 | Reg=0.00266 | acc=0.9375 | L2-Norm=16.294 | L2-Norm(final)=4.395 | 5403.2 samples/s | 84.4 steps/s
[Step=9050 Epoch=17.7] | Loss=0.06258 | Reg=0.00267 | acc=0.9531 | L2-Norm=16.326 | L2-Norm(final)=4.392 | 1832.8 samples/s | 28.6 steps/s
[Step=9100 Epoch=17.7] | Loss=0.06140 | Reg=0.00268 | acc=0.9375 | L2-Norm=16.357 | L2-Norm(final)=4.390 | 4904.4 samples/s | 76.6 steps/s
[Step=9150 Epoch=17.8] | Loss=0.05949 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.386 | L2-Norm(final)=4.388 | 4789.2 samples/s | 74.8 steps/s
[Step=9200 Epoch=17.9] | Loss=0.05803 | Reg=0.00269 | acc=0.9219 | L2-Norm=16.413 | L2-Norm(final)=4.387 | 5033.3 samples/s | 78.6 steps/s
[Step=9250 Epoch=18.0] | Loss=0.05691 | Reg=0.00270 | acc=0.9844 | L2-Norm=16.438 | L2-Norm(final)=4.385 | 4972.2 samples/s | 77.7 steps/s
[Step=9300 Epoch=18.1] | Loss=0.05576 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.463 | L2-Norm(final)=4.384 | 4910.3 samples/s | 76.7 steps/s
[Step=9350 Epoch=18.2] | Loss=0.05507 | Reg=0.00272 | acc=0.9688 | L2-Norm=16.488 | L2-Norm(final)=4.383 | 4790.7 samples/s | 74.9 steps/s
[Step=9400 Epoch=18.3] | Loss=0.05444 | Reg=0.00273 | acc=0.9062 | L2-Norm=16.512 | L2-Norm(final)=4.382 | 4656.9 samples/s | 72.8 steps/s
[Step=9450 Epoch=18.4] | Loss=0.05352 | Reg=0.00274 | acc=0.9375 | L2-Norm=16.537 | L2-Norm(final)=4.381 | 4478.6 samples/s | 70.0 steps/s
[Step=9500 Epoch=18.5] | Loss=0.05302 | Reg=0.00274 | acc=0.9844 | L2-Norm=16.560 | L2-Norm(final)=4.379 | 5063.6 samples/s | 79.1 steps/s
[Step=9550 Epoch=18.6] | Loss=0.05205 | Reg=0.00275 | acc=0.9844 | L2-Norm=16.583 | L2-Norm(final)=4.378 | 1933.9 samples/s | 30.2 steps/s
[Step=9600 Epoch=18.7] | Loss=0.05087 | Reg=0.00276 | acc=0.9844 | L2-Norm=16.606 | L2-Norm(final)=4.377 | 5071.1 samples/s | 79.2 steps/s
[Step=9650 Epoch=18.8] | Loss=0.05044 | Reg=0.00277 | acc=0.9375 | L2-Norm=16.629 | L2-Norm(final)=4.375 | 4953.6 samples/s | 77.4 steps/s
[Step=9700 Epoch=18.9] | Loss=0.04968 | Reg=0.00277 | acc=0.9688 | L2-Norm=16.650 | L2-Norm(final)=4.373 | 4953.7 samples/s | 77.4 steps/s
[Step=9750 Epoch=19.0] | Loss=0.04914 | Reg=0.00278 | acc=0.9688 | L2-Norm=16.671 | L2-Norm(final)=4.372 | 4929.7 samples/s | 77.0 steps/s
[Step=9800 Epoch=19.1] | Loss=0.04854 | Reg=0.00279 | acc=0.9375 | L2-Norm=16.694 | L2-Norm(final)=4.370 | 4716.1 samples/s | 73.7 steps/s
[Step=9850 Epoch=19.2] | Loss=0.04807 | Reg=0.00280 | acc=0.9688 | L2-Norm=16.716 | L2-Norm(final)=4.369 | 4529.4 samples/s | 70.8 steps/s
[Step=9900 Epoch=19.3] | Loss=0.04776 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.738 | L2-Norm(final)=4.367 | 4659.2 samples/s | 72.8 steps/s
[Step=9950 Epoch=19.4] | Loss=0.04720 | Reg=0.00281 | acc=0.9844 | L2-Norm=16.760 | L2-Norm(final)=4.365 | 4735.5 samples/s | 74.0 steps/s
[Step=10000 Epoch=19.5] | Loss=0.04663 | Reg=0.00282 | acc=0.9844 | L2-Norm=16.782 | L2-Norm(final)=4.364 | 4883.6 samples/s | 76.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step10000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=15.3] | Loss=0.01984 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.543 | L2-Norm(final)=5.066 | 3706.0 samples/s | 57.9 steps/s
[Step=4050 Epoch=15.5] | Loss=0.02615 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.532 | L2-Norm(final)=5.094 | 5133.4 samples/s | 80.2 steps/s
[Step=4100 Epoch=15.7] | Loss=0.02502 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.531 | L2-Norm(final)=5.149 | 5306.2 samples/s | 82.9 steps/s
[Step=4150 Epoch=15.9] | Loss=0.02480 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.530 | L2-Norm(final)=5.213 | 5232.6 samples/s | 81.8 steps/s
[Step=4200 Epoch=16.1] | Loss=0.02398 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.530 | L2-Norm(final)=5.277 | 5109.5 samples/s | 79.8 steps/s
[Step=4250 Epoch=16.3] | Loss=0.02356 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.530 | L2-Norm(final)=5.338 | 6596.7 samples/s | 103.1 steps/s
[Step=4300 Epoch=16.5] | Loss=0.02313 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.530 | L2-Norm(final)=5.397 | 1834.3 samples/s | 28.7 steps/s
[Step=4350 Epoch=16.7] | Loss=0.02297 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.530 | L2-Norm(final)=5.452 | 5082.7 samples/s | 79.4 steps/s
[Step=4400 Epoch=16.9] | Loss=0.02325 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.530 | L2-Norm(final)=5.502 | 5117.6 samples/s | 80.0 steps/s
[Step=4450 Epoch=17.1] | Loss=0.02267 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.530 | L2-Norm(final)=5.548 | 5443.4 samples/s | 85.1 steps/s
[Step=4500 Epoch=17.2] | Loss=0.02197 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.529 | L2-Norm(final)=5.595 | 6027.9 samples/s | 94.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=17.2] | Loss=0.02507 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.529 | L2-Norm(final)=6.078 | 3983.4 samples/s | 62.2 steps/s
[Step=4550 Epoch=17.4] | Loss=0.03209 | Reg=0.00253 | acc=0.9531 | L2-Norm=15.890 | L2-Norm(final)=6.071 | 4209.5 samples/s | 65.8 steps/s
[Step=4600 Epoch=17.6] | Loss=0.02714 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.161 | L2-Norm(final)=6.042 | 4413.4 samples/s | 69.0 steps/s
[Step=4650 Epoch=17.8] | Loss=0.02209 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.290 | L2-Norm(final)=6.021 | 4303.2 samples/s | 67.2 steps/s
[Step=4700 Epoch=18.0] | Loss=0.01854 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.350 | L2-Norm(final)=6.010 | 4504.7 samples/s | 70.4 steps/s
[Step=4750 Epoch=18.2] | Loss=0.01668 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.386 | L2-Norm(final)=6.000 | 5796.0 samples/s | 90.6 steps/s
[Step=4800 Epoch=18.4] | Loss=0.01483 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.412 | L2-Norm(final)=5.994 | 1840.8 samples/s | 28.8 steps/s
[Step=4850 Epoch=18.6] | Loss=0.01303 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.430 | L2-Norm(final)=5.989 | 4723.9 samples/s | 73.8 steps/s
[Step=4900 Epoch=18.8] | Loss=0.01152 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.438 | L2-Norm(final)=5.987 | 4656.4 samples/s | 72.8 steps/s
[Step=4950 Epoch=19.0] | Loss=0.01030 | Reg=0.00270 | acc=0.9844 | L2-Norm=16.437 | L2-Norm(final)=5.986 | 4633.3 samples/s | 72.4 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00931 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.428 | L2-Norm(final)=5.985 | 4842.3 samples/s | 75.7 steps/s
[Step=5050 Epoch=19.3] | Loss=0.00848 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.415 | L2-Norm(final)=5.986 | 1830.6 samples/s | 28.6 steps/s
[Step=5100 Epoch=19.5] | Loss=0.00778 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.397 | L2-Norm(final)=5.986 | 4474.3 samples/s | 69.9 steps/s
[Step=5150 Epoch=19.7] | Loss=0.00718 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.375 | L2-Norm(final)=5.986 | 4458.7 samples/s | 69.7 steps/s
[Step=5200 Epoch=19.9] | Loss=0.00667 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.351 | L2-Norm(final)=5.987 | 4585.2 samples/s | 71.6 steps/s
[Step=5250 Epoch=20.1] | Loss=0.00623 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.324 | L2-Norm(final)=5.987 | 4559.2 samples/s | 71.2 steps/s
[Step=5300 Epoch=20.3] | Loss=0.00584 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.296 | L2-Norm(final)=5.988 | 1975.3 samples/s | 30.9 steps/s
[Step=5350 Epoch=20.5] | Loss=0.00550 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.266 | L2-Norm(final)=5.988 | 4537.3 samples/s | 70.9 steps/s
[Step=5400 Epoch=20.7] | Loss=0.00519 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.236 | L2-Norm(final)=5.989 | 4305.2 samples/s | 67.3 steps/s
[Step=5450 Epoch=20.9] | Loss=0.00492 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.204 | L2-Norm(final)=5.990 | 4450.0 samples/s | 69.5 steps/s
[Step=5500 Epoch=21.1] | Loss=0.00467 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.172 | L2-Norm(final)=5.990 | 4548.0 samples/s | 71.1 steps/s
[Step=5550 Epoch=21.3] | Loss=0.00445 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.139 | L2-Norm(final)=5.991 | 1999.3 samples/s | 31.2 steps/s
[Step=5600 Epoch=21.5] | Loss=0.00425 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.106 | L2-Norm(final)=5.992 | 4750.6 samples/s | 74.2 steps/s
[Step=5650 Epoch=21.6] | Loss=0.00407 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.072 | L2-Norm(final)=5.993 | 4790.8 samples/s | 74.9 steps/s
[Step=5700 Epoch=21.8] | Loss=0.00390 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.038 | L2-Norm(final)=5.993 | 4635.2 samples/s | 72.4 steps/s
[Step=5750 Epoch=22.0] | Loss=0.00374 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.004 | L2-Norm(final)=5.994 | 4497.1 samples/s | 70.3 steps/s
[Step=5800 Epoch=22.2] | Loss=0.00360 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.970 | L2-Norm(final)=5.995 | 5684.4 samples/s | 88.8 steps/s
[Step=5850 Epoch=22.4] | Loss=0.00346 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.935 | L2-Norm(final)=5.996 | 1753.1 samples/s | 27.4 steps/s
[Step=5900 Epoch=22.6] | Loss=0.00334 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.900 | L2-Norm(final)=5.996 | 4746.1 samples/s | 74.2 steps/s
[Step=5950 Epoch=22.8] | Loss=0.00323 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.865 | L2-Norm(final)=5.997 | 4749.4 samples/s | 74.2 steps/s
[Step=6000 Epoch=23.0] | Loss=0.00312 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.830 | L2-Norm(final)=5.998 | 4797.0 samples/s | 75.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07087 | acc=0.9555 | tpr=0.9665 | fpr=0.0681 | 4123.0 samples/s | 16.1 steps/s
Avg test loss: 0.06887, Avg test acc: 0.95524, Avg tpr: 0.96485, Avg fpr: 0.06589, total FA: 514

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07860 | acc=0.9477 | tpr=0.9584 | fpr=0.0753 | 4349.7 samples/s | 17.0 steps/s
Avg test loss: 0.08003, Avg test acc: 0.94639, Avg tpr: 0.95739, Avg fpr: 0.07781, total FA: 607

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.28459 | acc=0.3129 | tpr=0.0079 | fpr=0.0248 | 4174.6 samples/s | 16.3 steps/s
Avg test loss: 5.28167, Avg test acc: 0.31100, Avg tpr: 0.00863, Avg fpr: 0.02397, total FA: 187

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.43740 | acc=0.3077 | tpr=0.0187 | fpr=0.0649 | 4278.8 samples/s | 16.7 steps/s
Avg test loss: 6.41438, Avg test acc: 0.30800, Avg tpr: 0.02092, Avg fpr: 0.06063, total FA: 473

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.10888 | acc=0.1257 | tpr=0.8805 | fpr=0.8879 | 4313.0 samples/s | 16.8 steps/s
[Step= 100] | Loss=4.08118 | acc=0.1287 | tpr=0.8657 | fpr=0.8850 | 8642.6 samples/s | 33.8 steps/s
[Step= 150] | Loss=4.08464 | acc=0.1288 | tpr=0.8617 | fpr=0.8847 | 8248.3 samples/s | 32.2 steps/s
[Step= 200] | Loss=4.07735 | acc=0.1282 | tpr=0.8470 | fpr=0.8849 | 8139.0 samples/s | 31.8 steps/s
[Step= 250] | Loss=4.07247 | acc=0.1281 | tpr=0.8437 | fpr=0.8849 | 8749.3 samples/s | 34.2 steps/s
[Step= 300] | Loss=4.07017 | acc=0.1282 | tpr=0.8378 | fpr=0.8847 | 9010.9 samples/s | 35.2 steps/s
[Step= 350] | Loss=4.07197 | acc=0.1280 | tpr=0.8410 | fpr=0.8849 | 8255.1 samples/s | 32.2 steps/s
[Step= 400] | Loss=4.06888 | acc=0.1280 | tpr=0.8392 | fpr=0.8849 | 8126.1 samples/s | 31.7 steps/s
[Step= 450] | Loss=4.06952 | acc=0.1280 | tpr=0.8379 | fpr=0.8849 | 8076.6 samples/s | 31.5 steps/s
[Step= 500] | Loss=4.06952 | acc=0.1278 | tpr=0.8401 | fpr=0.8851 | 8535.9 samples/s | 33.3 steps/s
[Step= 550] | Loss=4.06925 | acc=0.1279 | tpr=0.8432 | fpr=0.8851 | 14876.5 samples/s | 58.1 steps/s
Avg test loss: 4.07091, Avg test acc: 0.12780, Avg tpr: 0.84350, Avg fpr: 0.88521, total FA: 122909

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=2.42765 | acc=0.1488 | tpr=0.8938 | fpr=0.8646 | 4105.3 samples/s | 16.0 steps/s
[Step= 100] | Loss=2.41546 | acc=0.1502 | tpr=0.8550 | fpr=0.8630 | 8810.9 samples/s | 34.4 steps/s
[Step= 150] | Loss=2.41857 | acc=0.1511 | tpr=0.8429 | fpr=0.8616 | 8638.4 samples/s | 33.7 steps/s
[Step= 200] | Loss=2.41954 | acc=0.1511 | tpr=0.8426 | fpr=0.8615 | 8439.5 samples/s | 33.0 steps/s
[Step= 250] | Loss=2.42034 | acc=0.1518 | tpr=0.8358 | fpr=0.8607 | 8117.5 samples/s | 31.7 steps/s
[Step= 300] | Loss=2.42208 | acc=0.1510 | tpr=0.8313 | fpr=0.8614 | 7877.8 samples/s | 30.8 steps/s
[Step= 350] | Loss=2.42156 | acc=0.1505 | tpr=0.8322 | fpr=0.8619 | 8800.6 samples/s | 34.4 steps/s
[Step= 400] | Loss=2.42061 | acc=0.1506 | tpr=0.8326 | fpr=0.8618 | 8314.3 samples/s | 32.5 steps/s
[Step= 450] | Loss=2.42185 | acc=0.1504 | tpr=0.8354 | fpr=0.8621 | 8068.4 samples/s | 31.5 steps/s
[Step= 500] | Loss=2.42355 | acc=0.1502 | tpr=0.8339 | fpr=0.8621 | 8055.9 samples/s | 31.5 steps/s
[Step= 550] | Loss=2.42474 | acc=0.1501 | tpr=0.8317 | fpr=0.8623 | 16157.2 samples/s | 63.1 steps/s
Avg test loss: 2.42506, Avg test acc: 0.15005, Avg tpr: 0.83122, Avg fpr: 0.86233, total FA: 119733

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12671 | acc=0.9827 | tpr=0.9204 | fpr=0.0161 | 4318.3 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.13006 | acc=0.9813 | tpr=0.9360 | fpr=0.0179 | 8120.6 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.13601 | acc=0.9805 | tpr=0.9409 | fpr=0.0188 | 9037.7 samples/s | 35.3 steps/s
[Step= 200] | Loss=0.13838 | acc=0.9804 | tpr=0.9464 | fpr=0.0189 | 8105.6 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.13440 | acc=0.9808 | tpr=0.9459 | fpr=0.0186 | 8637.7 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.13543 | acc=0.9808 | tpr=0.9447 | fpr=0.0186 | 8264.3 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.13580 | acc=0.9806 | tpr=0.9461 | fpr=0.0188 | 8093.6 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.13708 | acc=0.9802 | tpr=0.9409 | fpr=0.0191 | 8247.9 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.14002 | acc=0.9799 | tpr=0.9372 | fpr=0.0193 | 8754.4 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.13869 | acc=0.9800 | tpr=0.9379 | fpr=0.0193 | 8537.8 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.13744 | acc=0.9802 | tpr=0.9363 | fpr=0.0190 | 14313.9 samples/s | 55.9 steps/s
Avg test loss: 0.13724, Avg test acc: 0.98017, Avg tpr: 0.93582, Avg fpr: 0.01902, total FA: 2641

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09700 | acc=0.9799 | tpr=0.9513 | fpr=0.0196 | 4326.0 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.10271 | acc=0.9791 | tpr=0.9467 | fpr=0.0203 | 8637.8 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.10558 | acc=0.9785 | tpr=0.9539 | fpr=0.0210 | 8014.9 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.10759 | acc=0.9786 | tpr=0.9574 | fpr=0.0210 | 8273.7 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.10609 | acc=0.9788 | tpr=0.9520 | fpr=0.0207 | 8773.3 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.10788 | acc=0.9785 | tpr=0.9484 | fpr=0.0209 | 8640.1 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.10828 | acc=0.9785 | tpr=0.9512 | fpr=0.0210 | 8232.1 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.10959 | acc=0.9782 | tpr=0.9469 | fpr=0.0212 | 8303.5 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.11144 | acc=0.9781 | tpr=0.9455 | fpr=0.0213 | 8145.2 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.11076 | acc=0.9781 | tpr=0.9445 | fpr=0.0212 | 8506.5 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.10957 | acc=0.9784 | tpr=0.9451 | fpr=0.0210 | 15578.9 samples/s | 60.9 steps/s
Avg test loss: 0.10943, Avg test acc: 0.97836, Avg tpr: 0.94493, Avg fpr: 0.02103, total FA: 2920

server round 5/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 3.9] | Loss=0.13412 | Reg=0.00233 | acc=0.9062 | L2-Norm=15.273 | L2-Norm(final)=2.622 | 3940.4 samples/s | 61.6 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.10076 | Reg=0.00233 | acc=0.9062 | L2-Norm=15.280 | L2-Norm(final)=2.660 | 4725.6 samples/s | 73.8 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.10193 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.281 | L2-Norm(final)=2.731 | 5152.8 samples/s | 80.5 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.09930 | Reg=0.00234 | acc=0.9531 | L2-Norm=15.281 | L2-Norm(final)=2.803 | 5375.6 samples/s | 84.0 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.09780 | Reg=0.00234 | acc=0.9219 | L2-Norm=15.282 | L2-Norm(final)=2.871 | 5474.8 samples/s | 85.5 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.09605 | Reg=0.00234 | acc=0.9375 | L2-Norm=15.282 | L2-Norm(final)=2.935 | 5373.1 samples/s | 84.0 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.09490 | Reg=0.00234 | acc=0.9062 | L2-Norm=15.282 | L2-Norm(final)=2.998 | 5500.0 samples/s | 85.9 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.09382 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.282 | L2-Norm(final)=3.057 | 5614.3 samples/s | 87.7 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.09312 | Reg=0.00234 | acc=0.9375 | L2-Norm=15.282 | L2-Norm(final)=3.112 | 5721.6 samples/s | 89.4 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.09175 | Reg=0.00234 | acc=0.9531 | L2-Norm=15.282 | L2-Norm(final)=3.165 | 5698.7 samples/s | 89.0 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.09067 | Reg=0.00234 | acc=0.9531 | L2-Norm=15.282 | L2-Norm(final)=3.216 | 7034.0 samples/s | 109.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 4.9] | Loss=0.07351 | Reg=0.00234 | acc=0.9375 | L2-Norm=15.282 | L2-Norm(final)=3.718 | 3748.5 samples/s | 58.6 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.07071 | Reg=0.00238 | acc=0.9375 | L2-Norm=15.419 | L2-Norm(final)=3.721 | 4290.0 samples/s | 67.0 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.07180 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.511 | L2-Norm(final)=3.713 | 4610.1 samples/s | 72.0 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.07145 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.575 | L2-Norm(final)=3.707 | 4772.5 samples/s | 74.6 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.07231 | Reg=0.00244 | acc=0.9375 | L2-Norm=15.633 | L2-Norm(final)=3.702 | 4860.4 samples/s | 75.9 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.07061 | Reg=0.00246 | acc=0.9531 | L2-Norm=15.689 | L2-Norm(final)=3.700 | 4887.0 samples/s | 76.4 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.06940 | Reg=0.00248 | acc=0.9531 | L2-Norm=15.738 | L2-Norm(final)=3.700 | 4875.9 samples/s | 76.2 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.06767 | Reg=0.00249 | acc=0.9688 | L2-Norm=15.782 | L2-Norm(final)=3.699 | 4912.2 samples/s | 76.8 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.06602 | Reg=0.00250 | acc=0.9375 | L2-Norm=15.823 | L2-Norm(final)=3.698 | 4848.8 samples/s | 75.8 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.06516 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.861 | L2-Norm(final)=3.697 | 4794.8 samples/s | 74.9 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.06364 | Reg=0.00253 | acc=0.9219 | L2-Norm=15.898 | L2-Norm(final)=3.696 | 5783.9 samples/s | 90.4 steps/s
[Step=3050 Epoch= 6.0] | Loss=0.06241 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.932 | L2-Norm(final)=3.693 | 1790.9 samples/s | 28.0 steps/s
[Step=3100 Epoch= 6.1] | Loss=0.06044 | Reg=0.00255 | acc=0.9219 | L2-Norm=15.966 | L2-Norm(final)=3.690 | 4769.5 samples/s | 74.5 steps/s
[Step=3150 Epoch= 6.2] | Loss=0.05895 | Reg=0.00256 | acc=0.9688 | L2-Norm=15.997 | L2-Norm(final)=3.689 | 4919.8 samples/s | 76.9 steps/s
[Step=3200 Epoch= 6.3] | Loss=0.05765 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.025 | L2-Norm(final)=3.688 | 4936.0 samples/s | 77.1 steps/s
[Step=3250 Epoch= 6.4] | Loss=0.05617 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.051 | L2-Norm(final)=3.687 | 4964.2 samples/s | 77.6 steps/s
[Step=3300 Epoch= 6.5] | Loss=0.05495 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.076 | L2-Norm(final)=3.686 | 4933.6 samples/s | 77.1 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.05395 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.100 | L2-Norm(final)=3.685 | 4993.5 samples/s | 78.0 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.05308 | Reg=0.00260 | acc=0.9375 | L2-Norm=16.124 | L2-Norm(final)=3.684 | 4771.3 samples/s | 74.6 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.05223 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.148 | L2-Norm(final)=3.684 | 4553.8 samples/s | 71.2 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.05191 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.172 | L2-Norm(final)=3.684 | 4935.9 samples/s | 77.1 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.05121 | Reg=0.00262 | acc=0.9688 | L2-Norm=16.197 | L2-Norm(final)=3.684 | 1921.6 samples/s | 30.0 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.05039 | Reg=0.00263 | acc=0.9688 | L2-Norm=16.221 | L2-Norm(final)=3.683 | 4750.2 samples/s | 74.2 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.04961 | Reg=0.00264 | acc=0.9688 | L2-Norm=16.245 | L2-Norm(final)=3.683 | 4982.6 samples/s | 77.9 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.04912 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.269 | L2-Norm(final)=3.683 | 4916.4 samples/s | 76.8 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.04860 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.292 | L2-Norm(final)=3.683 | 4868.8 samples/s | 76.1 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.04813 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.315 | L2-Norm(final)=3.682 | 4756.0 samples/s | 74.3 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.04753 | Reg=0.00267 | acc=0.9375 | L2-Norm=16.338 | L2-Norm(final)=3.682 | 4749.1 samples/s | 74.2 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.04686 | Reg=0.00268 | acc=0.9688 | L2-Norm=16.360 | L2-Norm(final)=3.682 | 4411.2 samples/s | 68.9 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.04657 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.381 | L2-Norm(final)=3.681 | 4792.1 samples/s | 74.9 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.04588 | Reg=0.00269 | acc=0.9375 | L2-Norm=16.403 | L2-Norm(final)=3.681 | 4879.0 samples/s | 76.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step4000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 7.7] | Loss=0.07869 | Reg=0.00233 | acc=0.9531 | L2-Norm=15.273 | L2-Norm(final)=4.168 | 3764.6 samples/s | 58.8 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.06313 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.263 | L2-Norm(final)=4.160 | 5173.5 samples/s | 80.8 steps/s
[Step=2100 Epoch= 8.1] | Loss=0.05039 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.262 | L2-Norm(final)=4.249 | 5364.2 samples/s | 83.8 steps/s
[Step=2150 Epoch= 8.3] | Loss=0.04449 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.262 | L2-Norm(final)=4.354 | 5381.9 samples/s | 84.1 steps/s
[Step=2200 Epoch= 8.5] | Loss=0.04161 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.261 | L2-Norm(final)=4.455 | 5311.3 samples/s | 83.0 steps/s
[Step=2250 Epoch= 8.7] | Loss=0.03976 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.261 | L2-Norm(final)=4.552 | 6799.3 samples/s | 106.2 steps/s
[Step=2300 Epoch= 8.9] | Loss=0.03780 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.261 | L2-Norm(final)=4.645 | 1846.4 samples/s | 28.8 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.03632 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.261 | L2-Norm(final)=4.732 | 5394.2 samples/s | 84.3 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.03587 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.261 | L2-Norm(final)=4.814 | 5359.7 samples/s | 83.7 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.03536 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.261 | L2-Norm(final)=4.892 | 5415.3 samples/s | 84.6 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.03455 | Reg=0.00233 | acc=0.9531 | L2-Norm=15.261 | L2-Norm(final)=4.967 | 6159.7 samples/s | 96.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 9.6] | Loss=0.02557 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.261 | L2-Norm(final)=5.700 | 3683.1 samples/s | 57.5 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.02973 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.572 | L2-Norm(final)=5.687 | 4665.3 samples/s | 72.9 steps/s
[Step=2600 Epoch=10.0] | Loss=0.02288 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.824 | L2-Norm(final)=5.668 | 4637.9 samples/s | 72.5 steps/s
[Step=2650 Epoch=10.2] | Loss=0.01838 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.947 | L2-Norm(final)=5.657 | 4473.4 samples/s | 69.9 steps/s
[Step=2700 Epoch=10.4] | Loss=0.01533 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.020 | L2-Norm(final)=5.651 | 4210.2 samples/s | 65.8 steps/s
[Step=2750 Epoch=10.6] | Loss=0.01433 | Reg=0.00258 | acc=0.9844 | L2-Norm=16.067 | L2-Norm(final)=5.646 | 5843.9 samples/s | 91.3 steps/s
[Step=2800 Epoch=10.8] | Loss=0.01258 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.099 | L2-Norm(final)=5.640 | 1833.2 samples/s | 28.6 steps/s
[Step=2850 Epoch=11.0] | Loss=0.01090 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.118 | L2-Norm(final)=5.638 | 4597.2 samples/s | 71.8 steps/s
[Step=2900 Epoch=11.2] | Loss=0.00957 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.124 | L2-Norm(final)=5.636 | 4603.8 samples/s | 71.9 steps/s
[Step=2950 Epoch=11.4] | Loss=0.00876 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.122 | L2-Norm(final)=5.635 | 4690.1 samples/s | 73.3 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00824 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.120 | L2-Norm(final)=5.634 | 5236.8 samples/s | 81.8 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00769 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.119 | L2-Norm(final)=5.633 | 1799.8 samples/s | 28.1 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00707 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.116 | L2-Norm(final)=5.632 | 4439.0 samples/s | 69.4 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00654 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.108 | L2-Norm(final)=5.632 | 4662.1 samples/s | 72.8 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00609 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.097 | L2-Norm(final)=5.632 | 4751.6 samples/s | 74.2 steps/s
[Step=3250 Epoch=12.5] | Loss=0.00569 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.083 | L2-Norm(final)=5.633 | 4837.8 samples/s | 75.6 steps/s
[Step=3300 Epoch=12.7] | Loss=0.00533 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.067 | L2-Norm(final)=5.633 | 2006.0 samples/s | 31.3 steps/s
[Step=3350 Epoch=12.9] | Loss=0.00502 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.049 | L2-Norm(final)=5.633 | 4615.7 samples/s | 72.1 steps/s
[Step=3400 Epoch=13.1] | Loss=0.00474 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.030 | L2-Norm(final)=5.634 | 4408.0 samples/s | 68.9 steps/s
[Step=3450 Epoch=13.3] | Loss=0.00449 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.008 | L2-Norm(final)=5.634 | 4237.4 samples/s | 66.2 steps/s
[Step=3500 Epoch=13.5] | Loss=0.00427 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.986 | L2-Norm(final)=5.634 | 4649.1 samples/s | 72.6 steps/s
[Step=3550 Epoch=13.7] | Loss=0.00406 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.963 | L2-Norm(final)=5.635 | 1985.1 samples/s | 31.0 steps/s
[Step=3600 Epoch=13.9] | Loss=0.00388 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.939 | L2-Norm(final)=5.635 | 4789.6 samples/s | 74.8 steps/s
[Step=3650 Epoch=14.1] | Loss=0.00371 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.914 | L2-Norm(final)=5.635 | 4721.2 samples/s | 73.8 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00356 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.888 | L2-Norm(final)=5.635 | 4717.5 samples/s | 73.7 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00342 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.862 | L2-Norm(final)=5.636 | 4738.2 samples/s | 74.0 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00328 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.835 | L2-Norm(final)=5.636 | 6359.0 samples/s | 99.4 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00316 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.808 | L2-Norm(final)=5.636 | 1675.0 samples/s | 26.2 steps/s
[Step=3900 Epoch=15.0] | Loss=0.00305 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.781 | L2-Norm(final)=5.637 | 4455.7 samples/s | 69.6 steps/s
[Step=3950 Epoch=15.2] | Loss=0.00295 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.753 | L2-Norm(final)=5.637 | 4495.4 samples/s | 70.2 steps/s
[Step=4000 Epoch=15.4] | Loss=0.00285 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.725 | L2-Norm(final)=5.637 | 4477.0 samples/s | 70.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07087 | acc=0.9555 | tpr=0.9665 | fpr=0.0681 | 4168.5 samples/s | 16.3 steps/s
Avg test loss: 0.06887, Avg test acc: 0.95524, Avg tpr: 0.96485, Avg fpr: 0.06589, total FA: 514

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07732 | acc=0.9527 | tpr=0.9561 | fpr=0.0548 | 4376.8 samples/s | 17.1 steps/s
Avg test loss: 0.08262, Avg test acc: 0.95184, Avg tpr: 0.95518, Avg fpr: 0.05551, total FA: 433

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.28459 | acc=0.3129 | tpr=0.0079 | fpr=0.0248 | 4078.0 samples/s | 15.9 steps/s
Avg test loss: 5.28167, Avg test acc: 0.31100, Avg tpr: 0.00863, Avg fpr: 0.02397, total FA: 187

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.53374 | acc=0.3069 | tpr=0.0186 | fpr=0.0671 | 4268.3 samples/s | 16.7 steps/s
Avg test loss: 5.52581, Avg test acc: 0.30619, Avg tpr: 0.01988, Avg fpr: 0.06409, total FA: 500

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.10888 | acc=0.1257 | tpr=0.8805 | fpr=0.8879 | 4347.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=4.08118 | acc=0.1287 | tpr=0.8657 | fpr=0.8850 | 8559.4 samples/s | 33.4 steps/s
[Step= 150] | Loss=4.08464 | acc=0.1288 | tpr=0.8617 | fpr=0.8847 | 8464.5 samples/s | 33.1 steps/s
[Step= 200] | Loss=4.07735 | acc=0.1282 | tpr=0.8470 | fpr=0.8849 | 8440.9 samples/s | 33.0 steps/s
[Step= 250] | Loss=4.07247 | acc=0.1281 | tpr=0.8437 | fpr=0.8849 | 8770.3 samples/s | 34.3 steps/s
[Step= 300] | Loss=4.07017 | acc=0.1282 | tpr=0.8378 | fpr=0.8847 | 8260.8 samples/s | 32.3 steps/s
[Step= 350] | Loss=4.07197 | acc=0.1280 | tpr=0.8410 | fpr=0.8849 | 8831.5 samples/s | 34.5 steps/s
[Step= 400] | Loss=4.06888 | acc=0.1280 | tpr=0.8392 | fpr=0.8849 | 7869.9 samples/s | 30.7 steps/s
[Step= 450] | Loss=4.06952 | acc=0.1280 | tpr=0.8379 | fpr=0.8849 | 8801.3 samples/s | 34.4 steps/s
[Step= 500] | Loss=4.06952 | acc=0.1278 | tpr=0.8401 | fpr=0.8851 | 8317.3 samples/s | 32.5 steps/s
[Step= 550] | Loss=4.06925 | acc=0.1279 | tpr=0.8432 | fpr=0.8851 | 16070.5 samples/s | 62.8 steps/s
Avg test loss: 4.07091, Avg test acc: 0.12780, Avg tpr: 0.84350, Avg fpr: 0.88521, total FA: 122909

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.54809 | acc=0.1545 | tpr=0.7168 | fpr=0.8557 | 4148.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=4.51811 | acc=0.1548 | tpr=0.7377 | fpr=0.8561 | 9005.4 samples/s | 35.2 steps/s
[Step= 150] | Loss=4.51716 | acc=0.1549 | tpr=0.7161 | fpr=0.8554 | 9088.4 samples/s | 35.5 steps/s
[Step= 200] | Loss=4.50357 | acc=0.1543 | tpr=0.7191 | fpr=0.8560 | 8099.9 samples/s | 31.6 steps/s
[Step= 250] | Loss=4.50391 | acc=0.1538 | tpr=0.7170 | fpr=0.8564 | 8639.2 samples/s | 33.7 steps/s
[Step= 300] | Loss=4.50197 | acc=0.1537 | tpr=0.7127 | fpr=0.8565 | 8102.0 samples/s | 31.6 steps/s
[Step= 350] | Loss=4.49910 | acc=0.1530 | tpr=0.7107 | fpr=0.8572 | 8834.8 samples/s | 34.5 steps/s
[Step= 400] | Loss=4.49756 | acc=0.1536 | tpr=0.7150 | fpr=0.8566 | 8519.3 samples/s | 33.3 steps/s
[Step= 450] | Loss=4.49886 | acc=0.1537 | tpr=0.7137 | fpr=0.8565 | 7997.0 samples/s | 31.2 steps/s
[Step= 500] | Loss=4.50235 | acc=0.1533 | tpr=0.7167 | fpr=0.8568 | 8124.3 samples/s | 31.7 steps/s
[Step= 550] | Loss=4.50467 | acc=0.1533 | tpr=0.7151 | fpr=0.8569 | 15984.2 samples/s | 62.4 steps/s
Avg test loss: 4.50603, Avg test acc: 0.15329, Avg tpr: 0.71513, Avg fpr: 0.85692, total FA: 118982

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12671 | acc=0.9827 | tpr=0.9204 | fpr=0.0161 | 4287.0 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.13006 | acc=0.9813 | tpr=0.9360 | fpr=0.0179 | 8052.4 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.13601 | acc=0.9805 | tpr=0.9409 | fpr=0.0188 | 8336.6 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.13838 | acc=0.9804 | tpr=0.9464 | fpr=0.0189 | 8649.0 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.13440 | acc=0.9808 | tpr=0.9459 | fpr=0.0186 | 8545.5 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.13543 | acc=0.9808 | tpr=0.9447 | fpr=0.0186 | 8236.0 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.13580 | acc=0.9806 | tpr=0.9461 | fpr=0.0188 | 8485.6 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.13708 | acc=0.9802 | tpr=0.9409 | fpr=0.0191 | 8509.3 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.14002 | acc=0.9799 | tpr=0.9372 | fpr=0.0193 | 8598.3 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.13869 | acc=0.9800 | tpr=0.9379 | fpr=0.0193 | 8505.5 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.13744 | acc=0.9802 | tpr=0.9363 | fpr=0.0190 | 14132.1 samples/s | 55.2 steps/s
Avg test loss: 0.13724, Avg test acc: 0.98017, Avg tpr: 0.93582, Avg fpr: 0.01902, total FA: 2641

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10765 | acc=0.9821 | tpr=0.9248 | fpr=0.0169 | 4362.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.11110 | acc=0.9814 | tpr=0.9424 | fpr=0.0178 | 8404.4 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.11618 | acc=0.9807 | tpr=0.9467 | fpr=0.0187 | 8691.1 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.11802 | acc=0.9807 | tpr=0.9454 | fpr=0.0187 | 7980.0 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.11553 | acc=0.9811 | tpr=0.9459 | fpr=0.0183 | 8382.1 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.11720 | acc=0.9808 | tpr=0.9433 | fpr=0.0186 | 9587.5 samples/s | 37.5 steps/s
[Step= 350] | Loss=0.11855 | acc=0.9805 | tpr=0.9461 | fpr=0.0189 | 7890.5 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.12024 | acc=0.9803 | tpr=0.9464 | fpr=0.0191 | 7884.9 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.12327 | acc=0.9799 | tpr=0.9440 | fpr=0.0194 | 8383.5 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.12221 | acc=0.9799 | tpr=0.9445 | fpr=0.0194 | 8463.0 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.12124 | acc=0.9800 | tpr=0.9431 | fpr=0.0193 | 15641.1 samples/s | 61.1 steps/s
Avg test loss: 0.12104, Avg test acc: 0.98002, Avg tpr: 0.94295, Avg fpr: 0.01930, total FA: 2680

server round 6/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=19.5] | Loss=0.11579 | Reg=0.00225 | acc=0.9062 | L2-Norm=14.985 | L2-Norm(final)=4.312 | 3737.4 samples/s | 58.4 steps/s
[Step=10050 Epoch=19.6] | Loss=0.08628 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.989 | L2-Norm(final)=4.349 | 4620.9 samples/s | 72.2 steps/s
[Step=10100 Epoch=19.7] | Loss=0.08280 | Reg=0.00225 | acc=0.9219 | L2-Norm=14.990 | L2-Norm(final)=4.398 | 5199.9 samples/s | 81.2 steps/s
[Step=10150 Epoch=19.8] | Loss=0.07905 | Reg=0.00225 | acc=0.8906 | L2-Norm=14.991 | L2-Norm(final)=4.454 | 5332.8 samples/s | 83.3 steps/s
[Step=10200 Epoch=19.9] | Loss=0.07841 | Reg=0.00225 | acc=0.9375 | L2-Norm=14.991 | L2-Norm(final)=4.510 | 5391.8 samples/s | 84.2 steps/s
[Step=10250 Epoch=20.0] | Loss=0.07790 | Reg=0.00225 | acc=0.9062 | L2-Norm=14.991 | L2-Norm(final)=4.560 | 5419.4 samples/s | 84.7 steps/s
[Step=10300 Epoch=20.1] | Loss=0.07709 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.991 | L2-Norm(final)=4.606 | 5434.0 samples/s | 84.9 steps/s
[Step=10350 Epoch=20.2] | Loss=0.07663 | Reg=0.00225 | acc=0.9219 | L2-Norm=14.991 | L2-Norm(final)=4.652 | 5607.7 samples/s | 87.6 steps/s
[Step=10400 Epoch=20.3] | Loss=0.07557 | Reg=0.00225 | acc=0.9062 | L2-Norm=14.991 | L2-Norm(final)=4.695 | 5638.1 samples/s | 88.1 steps/s
[Step=10450 Epoch=20.4] | Loss=0.07524 | Reg=0.00225 | acc=0.9375 | L2-Norm=14.991 | L2-Norm(final)=4.738 | 5633.6 samples/s | 88.0 steps/s
[Step=10500 Epoch=20.5] | Loss=0.07441 | Reg=0.00225 | acc=0.9531 | L2-Norm=14.991 | L2-Norm(final)=4.782 | 7004.9 samples/s | 109.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=20.5] | Loss=0.08539 | Reg=0.00225 | acc=0.9375 | L2-Norm=14.992 | L2-Norm(final)=5.220 | 3427.2 samples/s | 53.5 steps/s
[Step=10550 Epoch=20.6] | Loss=0.06816 | Reg=0.00231 | acc=0.9219 | L2-Norm=15.209 | L2-Norm(final)=5.218 | 4436.6 samples/s | 69.3 steps/s
[Step=10600 Epoch=20.7] | Loss=0.06576 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.358 | L2-Norm(final)=5.197 | 4606.6 samples/s | 72.0 steps/s
[Step=10650 Epoch=20.8] | Loss=0.06257 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.456 | L2-Norm(final)=5.186 | 4891.1 samples/s | 76.4 steps/s
[Step=10700 Epoch=20.9] | Loss=0.06329 | Reg=0.00241 | acc=0.9375 | L2-Norm=15.531 | L2-Norm(final)=5.177 | 4874.9 samples/s | 76.2 steps/s
[Step=10750 Epoch=21.0] | Loss=0.06007 | Reg=0.00243 | acc=0.9219 | L2-Norm=15.593 | L2-Norm(final)=5.172 | 4900.4 samples/s | 76.6 steps/s
[Step=10800 Epoch=21.1] | Loss=0.05917 | Reg=0.00245 | acc=0.9375 | L2-Norm=15.647 | L2-Norm(final)=5.167 | 4894.2 samples/s | 76.5 steps/s
[Step=10850 Epoch=21.2] | Loss=0.05788 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.698 | L2-Norm(final)=5.160 | 4998.9 samples/s | 78.1 steps/s
[Step=10900 Epoch=21.3] | Loss=0.05730 | Reg=0.00248 | acc=0.9219 | L2-Norm=15.744 | L2-Norm(final)=5.153 | 4979.1 samples/s | 77.8 steps/s
[Step=10950 Epoch=21.4] | Loss=0.05622 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.788 | L2-Norm(final)=5.146 | 4955.4 samples/s | 77.4 steps/s
[Step=11000 Epoch=21.5] | Loss=0.05456 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.830 | L2-Norm(final)=5.140 | 5649.8 samples/s | 88.3 steps/s
[Step=11050 Epoch=21.6] | Loss=0.05320 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.870 | L2-Norm(final)=5.135 | 1772.5 samples/s | 27.7 steps/s
[Step=11100 Epoch=21.6] | Loss=0.05161 | Reg=0.00253 | acc=0.9688 | L2-Norm=15.908 | L2-Norm(final)=5.130 | 4885.0 samples/s | 76.3 steps/s
[Step=11150 Epoch=21.7] | Loss=0.05060 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.944 | L2-Norm(final)=5.127 | 4844.8 samples/s | 75.7 steps/s
[Step=11200 Epoch=21.8] | Loss=0.04988 | Reg=0.00255 | acc=0.9531 | L2-Norm=15.980 | L2-Norm(final)=5.124 | 4821.7 samples/s | 75.3 steps/s
[Step=11250 Epoch=21.9] | Loss=0.04871 | Reg=0.00257 | acc=0.9219 | L2-Norm=16.015 | L2-Norm(final)=5.120 | 4921.5 samples/s | 76.9 steps/s
[Step=11300 Epoch=22.0] | Loss=0.04814 | Reg=0.00258 | acc=0.9844 | L2-Norm=16.048 | L2-Norm(final)=5.116 | 5045.8 samples/s | 78.8 steps/s
[Step=11350 Epoch=22.1] | Loss=0.04761 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.079 | L2-Norm(final)=5.113 | 4979.0 samples/s | 77.8 steps/s
[Step=11400 Epoch=22.2] | Loss=0.04691 | Reg=0.00260 | acc=0.9688 | L2-Norm=16.109 | L2-Norm(final)=5.109 | 4734.3 samples/s | 74.0 steps/s
[Step=11450 Epoch=22.3] | Loss=0.04638 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.137 | L2-Norm(final)=5.105 | 4675.3 samples/s | 73.1 steps/s
[Step=11500 Epoch=22.4] | Loss=0.04562 | Reg=0.00261 | acc=0.9688 | L2-Norm=16.164 | L2-Norm(final)=5.101 | 4789.7 samples/s | 74.8 steps/s
[Step=11550 Epoch=22.5] | Loss=0.04498 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.191 | L2-Norm(final)=5.098 | 1848.2 samples/s | 28.9 steps/s
[Step=11600 Epoch=22.6] | Loss=0.04409 | Reg=0.00263 | acc=0.9844 | L2-Norm=16.217 | L2-Norm(final)=5.095 | 4824.4 samples/s | 75.4 steps/s
[Step=11650 Epoch=22.7] | Loss=0.04344 | Reg=0.00264 | acc=0.9844 | L2-Norm=16.241 | L2-Norm(final)=5.092 | 4655.1 samples/s | 72.7 steps/s
[Step=11700 Epoch=22.8] | Loss=0.04268 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.265 | L2-Norm(final)=5.089 | 4813.7 samples/s | 75.2 steps/s
[Step=11750 Epoch=22.9] | Loss=0.04215 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.287 | L2-Norm(final)=5.086 | 4825.9 samples/s | 75.4 steps/s
[Step=11800 Epoch=23.0] | Loss=0.04172 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.310 | L2-Norm(final)=5.083 | 4817.7 samples/s | 75.3 steps/s
[Step=11850 Epoch=23.1] | Loss=0.04113 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.332 | L2-Norm(final)=5.080 | 4681.8 samples/s | 73.2 steps/s
[Step=11900 Epoch=23.2] | Loss=0.04054 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.353 | L2-Norm(final)=5.078 | 4490.7 samples/s | 70.2 steps/s
[Step=11950 Epoch=23.3] | Loss=0.04026 | Reg=0.00268 | acc=0.9688 | L2-Norm=16.374 | L2-Norm(final)=5.075 | 4632.2 samples/s | 72.4 steps/s
[Step=12000 Epoch=23.4] | Loss=0.04010 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.395 | L2-Norm(final)=5.072 | 4868.2 samples/s | 76.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step12000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=23.0] | Loss=0.02806 | Reg=0.00225 | acc=0.9688 | L2-Norm=14.985 | L2-Norm(final)=6.021 | 3629.0 samples/s | 56.7 steps/s
[Step=6050 Epoch=23.2] | Loss=0.01857 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.974 | L2-Norm(final)=6.072 | 5356.5 samples/s | 83.7 steps/s
[Step=6100 Epoch=23.4] | Loss=0.01583 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.973 | L2-Norm(final)=6.163 | 5388.4 samples/s | 84.2 steps/s
[Step=6150 Epoch=23.6] | Loss=0.01510 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.972 | L2-Norm(final)=6.252 | 5312.0 samples/s | 83.0 steps/s
[Step=6200 Epoch=23.8] | Loss=0.01396 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.972 | L2-Norm(final)=6.338 | 5291.5 samples/s | 82.7 steps/s
[Step=6250 Epoch=23.9] | Loss=0.01371 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.972 | L2-Norm(final)=6.420 | 6284.6 samples/s | 98.2 steps/s
[Step=6300 Epoch=24.1] | Loss=0.01322 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.972 | L2-Norm(final)=6.498 | 1809.0 samples/s | 28.3 steps/s
[Step=6350 Epoch=24.3] | Loss=0.01273 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.972 | L2-Norm(final)=6.572 | 4992.9 samples/s | 78.0 steps/s
[Step=6400 Epoch=24.5] | Loss=0.01267 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.972 | L2-Norm(final)=6.642 | 5227.3 samples/s | 81.7 steps/s
[Step=6450 Epoch=24.7] | Loss=0.01250 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.972 | L2-Norm(final)=6.707 | 5179.2 samples/s | 80.9 steps/s
[Step=6500 Epoch=24.9] | Loss=0.01232 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.972 | L2-Norm(final)=6.769 | 6035.7 samples/s | 94.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=24.9] | Loss=0.00527 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.971 | L2-Norm(final)=7.389 | 3745.4 samples/s | 58.5 steps/s
[Step=6550 Epoch=25.1] | Loss=0.02135 | Reg=0.00233 | acc=0.9531 | L2-Norm=15.272 | L2-Norm(final)=7.386 | 4636.5 samples/s | 72.4 steps/s
[Step=6600 Epoch=25.3] | Loss=0.01923 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.657 | L2-Norm(final)=7.345 | 4571.6 samples/s | 71.4 steps/s
[Step=6650 Epoch=25.5] | Loss=0.01798 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.856 | L2-Norm(final)=7.315 | 4439.6 samples/s | 69.4 steps/s
[Step=6700 Epoch=25.7] | Loss=0.01527 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.973 | L2-Norm(final)=7.295 | 4228.1 samples/s | 66.1 steps/s
[Step=6750 Epoch=25.9] | Loss=0.01311 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.041 | L2-Norm(final)=7.285 | 5748.7 samples/s | 89.8 steps/s
[Step=6800 Epoch=26.1] | Loss=0.01149 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.083 | L2-Norm(final)=7.277 | 1854.8 samples/s | 29.0 steps/s
[Step=6850 Epoch=26.2] | Loss=0.00997 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.106 | L2-Norm(final)=7.272 | 4683.4 samples/s | 73.2 steps/s
[Step=6900 Epoch=26.4] | Loss=0.00876 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.114 | L2-Norm(final)=7.269 | 4696.2 samples/s | 73.4 steps/s
[Step=6950 Epoch=26.6] | Loss=0.00779 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.111 | L2-Norm(final)=7.268 | 4726.8 samples/s | 73.9 steps/s
[Step=7000 Epoch=26.8] | Loss=0.00709 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.101 | L2-Norm(final)=7.267 | 5147.2 samples/s | 80.4 steps/s
[Step=7050 Epoch=27.0] | Loss=0.00646 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.089 | L2-Norm(final)=7.267 | 1843.5 samples/s | 28.8 steps/s
[Step=7100 Epoch=27.2] | Loss=0.00595 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.072 | L2-Norm(final)=7.267 | 4633.3 samples/s | 72.4 steps/s
[Step=7150 Epoch=27.4] | Loss=0.00549 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.053 | L2-Norm(final)=7.268 | 4538.2 samples/s | 70.9 steps/s
[Step=7200 Epoch=27.6] | Loss=0.00510 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.031 | L2-Norm(final)=7.268 | 4697.7 samples/s | 73.4 steps/s
[Step=7250 Epoch=27.8] | Loss=0.00477 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.008 | L2-Norm(final)=7.269 | 4758.2 samples/s | 74.3 steps/s
[Step=7300 Epoch=28.0] | Loss=0.00447 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.983 | L2-Norm(final)=7.270 | 1994.8 samples/s | 31.2 steps/s
[Step=7350 Epoch=28.2] | Loss=0.00421 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.956 | L2-Norm(final)=7.271 | 4658.8 samples/s | 72.8 steps/s
[Step=7400 Epoch=28.4] | Loss=0.00397 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.928 | L2-Norm(final)=7.271 | 4499.0 samples/s | 70.3 steps/s
[Step=7450 Epoch=28.5] | Loss=0.00376 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.900 | L2-Norm(final)=7.272 | 4251.2 samples/s | 66.4 steps/s
[Step=7500 Epoch=28.7] | Loss=0.00358 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.870 | L2-Norm(final)=7.272 | 4548.9 samples/s | 71.1 steps/s
[Step=7550 Epoch=28.9] | Loss=0.00341 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.841 | L2-Norm(final)=7.273 | 1995.8 samples/s | 31.2 steps/s
[Step=7600 Epoch=29.1] | Loss=0.00325 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.810 | L2-Norm(final)=7.274 | 4642.5 samples/s | 72.5 steps/s
[Step=7650 Epoch=29.3] | Loss=0.00311 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.780 | L2-Norm(final)=7.274 | 4663.1 samples/s | 72.9 steps/s
[Step=7700 Epoch=29.5] | Loss=0.00298 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.749 | L2-Norm(final)=7.275 | 4657.7 samples/s | 72.8 steps/s
[Step=7750 Epoch=29.7] | Loss=0.00286 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.718 | L2-Norm(final)=7.275 | 4554.0 samples/s | 71.2 steps/s
[Step=7800 Epoch=29.9] | Loss=0.00275 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.687 | L2-Norm(final)=7.276 | 6059.5 samples/s | 94.7 steps/s
[Step=7850 Epoch=30.1] | Loss=0.00265 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.655 | L2-Norm(final)=7.276 | 1705.8 samples/s | 26.7 steps/s
[Step=7900 Epoch=30.3] | Loss=0.00256 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.624 | L2-Norm(final)=7.277 | 4690.4 samples/s | 73.3 steps/s
[Step=7950 Epoch=30.5] | Loss=0.00247 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.592 | L2-Norm(final)=7.277 | 4690.3 samples/s | 73.3 steps/s
[Step=8000 Epoch=30.7] | Loss=0.00239 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.560 | L2-Norm(final)=7.278 | 4710.2 samples/s | 73.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06799 | acc=0.9548 | tpr=0.9684 | fpr=0.0746 | 4155.8 samples/s | 16.2 steps/s
Avg test loss: 0.06802, Avg test acc: 0.95412, Avg tpr: 0.96713, Avg fpr: 0.07448, total FA: 581

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07732 | acc=0.9527 | tpr=0.9561 | fpr=0.0548 | 4300.4 samples/s | 16.8 steps/s
Avg test loss: 0.08262, Avg test acc: 0.95184, Avg tpr: 0.95518, Avg fpr: 0.05551, total FA: 433

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.26539 | acc=0.3119 | tpr=0.0023 | fpr=0.0159 | 4200.8 samples/s | 16.4 steps/s
Avg test loss: 6.28897, Avg test acc: 0.30880, Avg tpr: 0.00233, Avg fpr: 0.01718, total FA: 134

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.53374 | acc=0.3069 | tpr=0.0186 | fpr=0.0671 | 4493.6 samples/s | 17.6 steps/s
Avg test loss: 5.52581, Avg test acc: 0.30619, Avg tpr: 0.01988, Avg fpr: 0.06409, total FA: 500

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.30148 | acc=0.1138 | tpr=0.7788 | fpr=0.8981 | 4343.2 samples/s | 17.0 steps/s
[Step= 100] | Loss=3.28480 | acc=0.1146 | tpr=0.7804 | fpr=0.8979 | 8590.5 samples/s | 33.6 steps/s
[Step= 150] | Loss=3.28692 | acc=0.1139 | tpr=0.7723 | fpr=0.8982 | 8064.5 samples/s | 31.5 steps/s
[Step= 200] | Loss=3.28027 | acc=0.1142 | tpr=0.7661 | fpr=0.8977 | 8757.7 samples/s | 34.2 steps/s
[Step= 250] | Loss=3.27419 | acc=0.1141 | tpr=0.7520 | fpr=0.8976 | 7957.1 samples/s | 31.1 steps/s
[Step= 300] | Loss=3.27214 | acc=0.1140 | tpr=0.7462 | fpr=0.8975 | 8369.8 samples/s | 32.7 steps/s
[Step= 350] | Loss=3.27167 | acc=0.1135 | tpr=0.7451 | fpr=0.8980 | 8762.7 samples/s | 34.2 steps/s
[Step= 400] | Loss=3.26866 | acc=0.1137 | tpr=0.7478 | fpr=0.8978 | 7938.6 samples/s | 31.0 steps/s
[Step= 450] | Loss=3.26883 | acc=0.1138 | tpr=0.7493 | fpr=0.8977 | 8776.8 samples/s | 34.3 steps/s
[Step= 500] | Loss=3.27129 | acc=0.1137 | tpr=0.7480 | fpr=0.8977 | 8347.0 samples/s | 32.6 steps/s
[Step= 550] | Loss=3.27265 | acc=0.1137 | tpr=0.7501 | fpr=0.8978 | 16256.0 samples/s | 63.5 steps/s
Avg test loss: 3.27371, Avg test acc: 0.11368, Avg tpr: 0.75000, Avg fpr: 0.89789, total FA: 124670

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.54809 | acc=0.1545 | tpr=0.7168 | fpr=0.8557 | 4138.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=4.51811 | acc=0.1548 | tpr=0.7377 | fpr=0.8561 | 8871.5 samples/s | 34.7 steps/s
[Step= 150] | Loss=4.51716 | acc=0.1549 | tpr=0.7161 | fpr=0.8554 | 8620.4 samples/s | 33.7 steps/s
[Step= 200] | Loss=4.50357 | acc=0.1543 | tpr=0.7191 | fpr=0.8560 | 8733.6 samples/s | 34.1 steps/s
[Step= 250] | Loss=4.50391 | acc=0.1538 | tpr=0.7170 | fpr=0.8564 | 7897.1 samples/s | 30.8 steps/s
[Step= 300] | Loss=4.50197 | acc=0.1537 | tpr=0.7127 | fpr=0.8565 | 8412.6 samples/s | 32.9 steps/s
[Step= 350] | Loss=4.49910 | acc=0.1530 | tpr=0.7107 | fpr=0.8572 | 8760.9 samples/s | 34.2 steps/s
[Step= 400] | Loss=4.49756 | acc=0.1536 | tpr=0.7150 | fpr=0.8566 | 8700.4 samples/s | 34.0 steps/s
[Step= 450] | Loss=4.49886 | acc=0.1537 | tpr=0.7137 | fpr=0.8565 | 8398.7 samples/s | 32.8 steps/s
[Step= 500] | Loss=4.50235 | acc=0.1533 | tpr=0.7167 | fpr=0.8568 | 8035.5 samples/s | 31.4 steps/s
[Step= 550] | Loss=4.50467 | acc=0.1533 | tpr=0.7151 | fpr=0.8569 | 16115.9 samples/s | 63.0 steps/s
Avg test loss: 4.50603, Avg test acc: 0.15329, Avg tpr: 0.71513, Avg fpr: 0.85692, total FA: 118982

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13875 | acc=0.9827 | tpr=0.9159 | fpr=0.0161 | 4395.7 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.14701 | acc=0.9816 | tpr=0.9190 | fpr=0.0173 | 8016.7 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.15194 | acc=0.9811 | tpr=0.9294 | fpr=0.0179 | 8423.6 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.15439 | acc=0.9814 | tpr=0.9333 | fpr=0.0177 | 8717.2 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.15120 | acc=0.9816 | tpr=0.9328 | fpr=0.0175 | 8749.6 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.15248 | acc=0.9815 | tpr=0.9345 | fpr=0.0177 | 8281.9 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.15321 | acc=0.9813 | tpr=0.9368 | fpr=0.0179 | 7926.6 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.15407 | acc=0.9810 | tpr=0.9344 | fpr=0.0181 | 8853.9 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.15748 | acc=0.9807 | tpr=0.9318 | fpr=0.0184 | 8646.0 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.15739 | acc=0.9807 | tpr=0.9330 | fpr=0.0185 | 8316.8 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.15575 | acc=0.9808 | tpr=0.9331 | fpr=0.0183 | 14879.1 samples/s | 58.1 steps/s
Avg test loss: 0.15534, Avg test acc: 0.98083, Avg tpr: 0.93304, Avg fpr: 0.01830, total FA: 2541

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10765 | acc=0.9821 | tpr=0.9248 | fpr=0.0169 | 4398.7 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.11110 | acc=0.9814 | tpr=0.9424 | fpr=0.0178 | 8296.3 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.11618 | acc=0.9807 | tpr=0.9467 | fpr=0.0187 | 8416.4 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.11802 | acc=0.9807 | tpr=0.9454 | fpr=0.0187 | 8258.5 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.11553 | acc=0.9811 | tpr=0.9459 | fpr=0.0183 | 8542.5 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.11720 | acc=0.9808 | tpr=0.9433 | fpr=0.0186 | 8598.3 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.11855 | acc=0.9805 | tpr=0.9461 | fpr=0.0189 | 9103.2 samples/s | 35.6 steps/s
[Step= 400] | Loss=0.12024 | acc=0.9803 | tpr=0.9464 | fpr=0.0191 | 7844.3 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.12327 | acc=0.9799 | tpr=0.9440 | fpr=0.0194 | 8388.3 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.12221 | acc=0.9799 | tpr=0.9445 | fpr=0.0194 | 8678.0 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.12124 | acc=0.9800 | tpr=0.9431 | fpr=0.0193 | 15444.4 samples/s | 60.3 steps/s
Avg test loss: 0.12104, Avg test acc: 0.98002, Avg tpr: 0.94295, Avg fpr: 0.01930, total FA: 2680

server round 7/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=12001 Epoch=23.4] | Loss=0.10920 | Reg=0.00218 | acc=0.8594 | L2-Norm=14.761 | L2-Norm(final)=4.977 | 3594.9 samples/s | 56.2 steps/s
[Step=12050 Epoch=23.5] | Loss=0.08747 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.769 | L2-Norm(final)=5.066 | 5011.5 samples/s | 78.3 steps/s
[Step=12100 Epoch=23.6] | Loss=0.08202 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.771 | L2-Norm(final)=5.191 | 5291.3 samples/s | 82.7 steps/s
[Step=12150 Epoch=23.7] | Loss=0.07821 | Reg=0.00218 | acc=0.9375 | L2-Norm=14.771 | L2-Norm(final)=5.302 | 5409.1 samples/s | 84.5 steps/s
[Step=12200 Epoch=23.8] | Loss=0.07620 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.771 | L2-Norm(final)=5.406 | 5690.1 samples/s | 88.9 steps/s
[Step=12250 Epoch=23.9] | Loss=0.07604 | Reg=0.00218 | acc=0.9375 | L2-Norm=14.772 | L2-Norm(final)=5.498 | 5601.4 samples/s | 87.5 steps/s
[Step=12300 Epoch=24.0] | Loss=0.07533 | Reg=0.00218 | acc=0.9062 | L2-Norm=14.772 | L2-Norm(final)=5.581 | 5720.9 samples/s | 89.4 steps/s
[Step=12350 Epoch=24.1] | Loss=0.07417 | Reg=0.00218 | acc=0.9219 | L2-Norm=14.772 | L2-Norm(final)=5.655 | 5798.8 samples/s | 90.6 steps/s
[Step=12400 Epoch=24.2] | Loss=0.07345 | Reg=0.00218 | acc=0.9375 | L2-Norm=14.772 | L2-Norm(final)=5.724 | 5668.8 samples/s | 88.6 steps/s
[Step=12450 Epoch=24.3] | Loss=0.07270 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.772 | L2-Norm(final)=5.790 | 5832.5 samples/s | 91.1 steps/s
[Step=12500 Epoch=24.4] | Loss=0.07164 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.772 | L2-Norm(final)=5.854 | 7122.7 samples/s | 111.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=24.4] | Loss=0.06488 | Reg=0.00218 | acc=0.9375 | L2-Norm=14.772 | L2-Norm(final)=6.494 | 3687.7 samples/s | 57.6 steps/s
[Step=12550 Epoch=24.5] | Loss=0.06062 | Reg=0.00227 | acc=0.9375 | L2-Norm=15.059 | L2-Norm(final)=6.488 | 4441.2 samples/s | 69.4 steps/s
[Step=12600 Epoch=24.6] | Loss=0.06143 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.278 | L2-Norm(final)=6.452 | 4484.3 samples/s | 70.1 steps/s
[Step=12650 Epoch=24.7] | Loss=0.05961 | Reg=0.00238 | acc=0.9375 | L2-Norm=15.413 | L2-Norm(final)=6.432 | 4642.4 samples/s | 72.5 steps/s
[Step=12700 Epoch=24.8] | Loss=0.05930 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.511 | L2-Norm(final)=6.416 | 4724.3 samples/s | 73.8 steps/s
[Step=12750 Epoch=24.9] | Loss=0.05846 | Reg=0.00243 | acc=0.9531 | L2-Norm=15.594 | L2-Norm(final)=6.404 | 4730.1 samples/s | 73.9 steps/s
[Step=12800 Epoch=25.0] | Loss=0.05705 | Reg=0.00246 | acc=0.9531 | L2-Norm=15.669 | L2-Norm(final)=6.392 | 4710.0 samples/s | 73.6 steps/s
[Step=12850 Epoch=25.1] | Loss=0.05747 | Reg=0.00248 | acc=0.9688 | L2-Norm=15.735 | L2-Norm(final)=6.381 | 4737.7 samples/s | 74.0 steps/s
[Step=12900 Epoch=25.2] | Loss=0.05603 | Reg=0.00250 | acc=0.9531 | L2-Norm=15.793 | L2-Norm(final)=6.370 | 4867.4 samples/s | 76.1 steps/s
[Step=12950 Epoch=25.3] | Loss=0.05607 | Reg=0.00251 | acc=0.9688 | L2-Norm=15.847 | L2-Norm(final)=6.359 | 4856.2 samples/s | 75.9 steps/s
[Step=13000 Epoch=25.4] | Loss=0.05496 | Reg=0.00253 | acc=0.9688 | L2-Norm=15.895 | L2-Norm(final)=6.350 | 5853.6 samples/s | 91.5 steps/s
[Step=13050 Epoch=25.5] | Loss=0.05285 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.938 | L2-Norm(final)=6.343 | 1757.2 samples/s | 27.5 steps/s
[Step=13100 Epoch=25.6] | Loss=0.05134 | Reg=0.00255 | acc=0.9844 | L2-Norm=15.976 | L2-Norm(final)=6.338 | 4927.2 samples/s | 77.0 steps/s
[Step=13150 Epoch=25.6] | Loss=0.05022 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.011 | L2-Norm(final)=6.332 | 4912.5 samples/s | 76.8 steps/s
[Step=13200 Epoch=25.7] | Loss=0.04872 | Reg=0.00258 | acc=0.9844 | L2-Norm=16.043 | L2-Norm(final)=6.327 | 4834.3 samples/s | 75.5 steps/s
[Step=13250 Epoch=25.8] | Loss=0.04816 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.072 | L2-Norm(final)=6.322 | 4846.4 samples/s | 75.7 steps/s
[Step=13300 Epoch=25.9] | Loss=0.04740 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.100 | L2-Norm(final)=6.317 | 4826.7 samples/s | 75.4 steps/s
[Step=13350 Epoch=26.0] | Loss=0.04660 | Reg=0.00260 | acc=0.9688 | L2-Norm=16.126 | L2-Norm(final)=6.312 | 4872.9 samples/s | 76.1 steps/s
[Step=13400 Epoch=26.1] | Loss=0.04594 | Reg=0.00261 | acc=0.9531 | L2-Norm=16.152 | L2-Norm(final)=6.307 | 4857.4 samples/s | 75.9 steps/s
[Step=13450 Epoch=26.2] | Loss=0.04521 | Reg=0.00262 | acc=0.9688 | L2-Norm=16.178 | L2-Norm(final)=6.303 | 4592.2 samples/s | 71.8 steps/s
[Step=13500 Epoch=26.3] | Loss=0.04449 | Reg=0.00263 | acc=0.9375 | L2-Norm=16.203 | L2-Norm(final)=6.299 | 4760.4 samples/s | 74.4 steps/s
[Step=13550 Epoch=26.4] | Loss=0.04393 | Reg=0.00264 | acc=0.9688 | L2-Norm=16.228 | L2-Norm(final)=6.294 | 1860.8 samples/s | 29.1 steps/s
[Step=13600 Epoch=26.5] | Loss=0.04309 | Reg=0.00264 | acc=0.9688 | L2-Norm=16.252 | L2-Norm(final)=6.291 | 4910.1 samples/s | 76.7 steps/s
[Step=13650 Epoch=26.6] | Loss=0.04231 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.275 | L2-Norm(final)=6.288 | 4815.4 samples/s | 75.2 steps/s
[Step=13700 Epoch=26.7] | Loss=0.04186 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.297 | L2-Norm(final)=6.284 | 4866.9 samples/s | 76.0 steps/s
[Step=13750 Epoch=26.8] | Loss=0.04119 | Reg=0.00266 | acc=0.9375 | L2-Norm=16.318 | L2-Norm(final)=6.281 | 4864.2 samples/s | 76.0 steps/s
[Step=13800 Epoch=26.9] | Loss=0.04060 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.339 | L2-Norm(final)=6.278 | 4942.3 samples/s | 77.2 steps/s
[Step=13850 Epoch=27.0] | Loss=0.04013 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.359 | L2-Norm(final)=6.275 | 4797.8 samples/s | 75.0 steps/s
[Step=13900 Epoch=27.1] | Loss=0.03965 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.379 | L2-Norm(final)=6.272 | 4582.8 samples/s | 71.6 steps/s
[Step=13950 Epoch=27.2] | Loss=0.03943 | Reg=0.00269 | acc=0.9375 | L2-Norm=16.400 | L2-Norm(final)=6.269 | 4468.5 samples/s | 69.8 steps/s
[Step=14000 Epoch=27.3] | Loss=0.03920 | Reg=0.00270 | acc=0.9844 | L2-Norm=16.419 | L2-Norm(final)=6.266 | 4832.6 samples/s | 75.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step14000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.11382 | Reg=0.00218 | acc=0.8906 | L2-Norm=14.761 | L2-Norm(final)=3.685 | 3882.1 samples/s | 60.7 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.09501 | Reg=0.00218 | acc=0.9219 | L2-Norm=14.768 | L2-Norm(final)=3.767 | 5492.4 samples/s | 85.8 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.09460 | Reg=0.00218 | acc=0.9531 | L2-Norm=14.770 | L2-Norm(final)=3.872 | 5688.8 samples/s | 88.9 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.09348 | Reg=0.00218 | acc=0.9062 | L2-Norm=14.771 | L2-Norm(final)=3.966 | 5624.2 samples/s | 87.9 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.09429 | Reg=0.00218 | acc=0.9219 | L2-Norm=14.771 | L2-Norm(final)=4.048 | 5674.1 samples/s | 88.7 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.09384 | Reg=0.00218 | acc=0.9531 | L2-Norm=14.771 | L2-Norm(final)=4.123 | 5586.0 samples/s | 87.3 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.09391 | Reg=0.00218 | acc=0.9062 | L2-Norm=14.771 | L2-Norm(final)=4.195 | 5284.2 samples/s | 82.6 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.09249 | Reg=0.00218 | acc=0.9219 | L2-Norm=14.771 | L2-Norm(final)=4.263 | 5762.4 samples/s | 90.0 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.09144 | Reg=0.00218 | acc=0.9062 | L2-Norm=14.771 | L2-Norm(final)=4.330 | 4963.1 samples/s | 77.5 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.09030 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.771 | L2-Norm(final)=4.395 | 4515.4 samples/s | 70.6 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.09085 | Reg=0.00218 | acc=0.9219 | L2-Norm=14.771 | L2-Norm(final)=4.457 | 6770.5 samples/s | 105.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch= 8.8] | Loss=0.07021 | Reg=0.00218 | acc=0.9531 | L2-Norm=14.772 | L2-Norm(final)=5.050 | 3625.5 samples/s | 56.6 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.06458 | Reg=0.00224 | acc=0.9375 | L2-Norm=14.965 | L2-Norm(final)=5.039 | 5105.6 samples/s | 79.8 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.06444 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.115 | L2-Norm(final)=5.008 | 4939.8 samples/s | 77.2 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.06246 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.213 | L2-Norm(final)=4.992 | 4966.6 samples/s | 77.6 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.06222 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.292 | L2-Norm(final)=4.981 | 4961.8 samples/s | 77.5 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.06033 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.368 | L2-Norm(final)=4.971 | 4973.7 samples/s | 77.7 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.05881 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.433 | L2-Norm(final)=4.963 | 4994.4 samples/s | 78.0 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.05874 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.492 | L2-Norm(final)=4.955 | 4793.5 samples/s | 74.9 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.05794 | Reg=0.00242 | acc=0.9531 | L2-Norm=15.545 | L2-Norm(final)=4.947 | 4625.9 samples/s | 72.3 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.05698 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.594 | L2-Norm(final)=4.939 | 4630.6 samples/s | 72.4 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.05615 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.640 | L2-Norm(final)=4.932 | 5753.1 samples/s | 89.9 steps/s
[Step=5050 Epoch= 9.9] | Loss=0.05421 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.685 | L2-Norm(final)=4.926 | 1891.8 samples/s | 29.6 steps/s
[Step=5100 Epoch=10.0] | Loss=0.05243 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.726 | L2-Norm(final)=4.920 | 4916.9 samples/s | 76.8 steps/s
[Step=5150 Epoch=10.1] | Loss=0.05119 | Reg=0.00249 | acc=0.9531 | L2-Norm=15.763 | L2-Norm(final)=4.915 | 4899.2 samples/s | 76.5 steps/s
[Step=5200 Epoch=10.2] | Loss=0.04977 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.799 | L2-Norm(final)=4.911 | 5009.4 samples/s | 78.3 steps/s
[Step=5250 Epoch=10.3] | Loss=0.04873 | Reg=0.00251 | acc=0.9688 | L2-Norm=15.833 | L2-Norm(final)=4.907 | 4781.8 samples/s | 74.7 steps/s
[Step=5300 Epoch=10.4] | Loss=0.04789 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.866 | L2-Norm(final)=4.903 | 4856.5 samples/s | 75.9 steps/s
[Step=5350 Epoch=10.5] | Loss=0.04710 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.898 | L2-Norm(final)=4.899 | 4708.3 samples/s | 73.6 steps/s
[Step=5400 Epoch=10.6] | Loss=0.04620 | Reg=0.00254 | acc=0.9531 | L2-Norm=15.930 | L2-Norm(final)=4.896 | 4566.3 samples/s | 71.3 steps/s
[Step=5450 Epoch=10.7] | Loss=0.04560 | Reg=0.00255 | acc=0.9844 | L2-Norm=15.960 | L2-Norm(final)=4.893 | 4820.1 samples/s | 75.3 steps/s
[Step=5500 Epoch=10.8] | Loss=0.04510 | Reg=0.00256 | acc=0.9688 | L2-Norm=15.990 | L2-Norm(final)=4.890 | 5318.9 samples/s | 83.1 steps/s
[Step=5550 Epoch=10.9] | Loss=0.04451 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.020 | L2-Norm(final)=4.887 | 1971.4 samples/s | 30.8 steps/s
[Step=5600 Epoch=10.9] | Loss=0.04373 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.049 | L2-Norm(final)=4.885 | 4976.0 samples/s | 77.8 steps/s
[Step=5650 Epoch=11.0] | Loss=0.04307 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.078 | L2-Norm(final)=4.883 | 4889.9 samples/s | 76.4 steps/s
[Step=5700 Epoch=11.1] | Loss=0.04281 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.107 | L2-Norm(final)=4.881 | 4887.0 samples/s | 76.4 steps/s
[Step=5750 Epoch=11.2] | Loss=0.04231 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.134 | L2-Norm(final)=4.878 | 4684.4 samples/s | 73.2 steps/s
[Step=5800 Epoch=11.3] | Loss=0.04183 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.162 | L2-Norm(final)=4.876 | 4620.3 samples/s | 72.2 steps/s
[Step=5850 Epoch=11.4] | Loss=0.04121 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.189 | L2-Norm(final)=4.873 | 4547.0 samples/s | 71.0 steps/s
[Step=5900 Epoch=11.5] | Loss=0.04065 | Reg=0.00263 | acc=0.9844 | L2-Norm=16.215 | L2-Norm(final)=4.871 | 4789.6 samples/s | 74.8 steps/s
[Step=5950 Epoch=11.6] | Loss=0.04002 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.240 | L2-Norm(final)=4.869 | 4851.6 samples/s | 75.8 steps/s
[Step=6000 Epoch=11.7] | Loss=0.03988 | Reg=0.00265 | acc=0.9531 | L2-Norm=16.265 | L2-Norm(final)=4.866 | 4901.8 samples/s | 76.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06859 | acc=0.9575 | tpr=0.9665 | fpr=0.0619 | 4283.5 samples/s | 16.7 steps/s
Avg test loss: 0.06793, Avg test acc: 0.95769, Avg tpr: 0.96672, Avg fpr: 0.06217, total FA: 485

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06449 | acc=0.9575 | tpr=0.9661 | fpr=0.0612 | 4292.0 samples/s | 16.8 steps/s
Avg test loss: 0.06607, Avg test acc: 0.95649, Avg tpr: 0.96450, Avg fpr: 0.06115, total FA: 477

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.26539 | acc=0.3119 | tpr=0.0023 | fpr=0.0159 | 4110.0 samples/s | 16.1 steps/s
Avg test loss: 6.28897, Avg test acc: 0.30880, Avg tpr: 0.00233, Avg fpr: 0.01718, total FA: 134

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.53374 | acc=0.3069 | tpr=0.0186 | fpr=0.0671 | 4282.7 samples/s | 16.7 steps/s
Avg test loss: 5.52581, Avg test acc: 0.30619, Avg tpr: 0.01988, Avg fpr: 0.06409, total FA: 500

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.02819 | acc=0.1189 | tpr=0.8230 | fpr=0.8937 | 4146.7 samples/s | 16.2 steps/s
[Step= 100] | Loss=4.02195 | acc=0.1211 | tpr=0.7974 | fpr=0.8915 | 8232.8 samples/s | 32.2 steps/s
[Step= 150] | Loss=4.01864 | acc=0.1201 | tpr=0.7882 | fpr=0.8922 | 8612.2 samples/s | 33.6 steps/s
[Step= 200] | Loss=4.00731 | acc=0.1199 | tpr=0.7891 | fpr=0.8923 | 7956.2 samples/s | 31.1 steps/s
[Step= 250] | Loss=4.00182 | acc=0.1199 | tpr=0.7860 | fpr=0.8922 | 8344.4 samples/s | 32.6 steps/s
[Step= 300] | Loss=4.00137 | acc=0.1205 | tpr=0.7775 | fpr=0.8915 | 8662.4 samples/s | 33.8 steps/s
[Step= 350] | Loss=4.00149 | acc=0.1200 | tpr=0.7796 | fpr=0.8920 | 8880.2 samples/s | 34.7 steps/s
[Step= 400] | Loss=3.99964 | acc=0.1202 | tpr=0.7795 | fpr=0.8918 | 8101.3 samples/s | 31.6 steps/s
[Step= 450] | Loss=4.00000 | acc=0.1202 | tpr=0.7833 | fpr=0.8918 | 8003.8 samples/s | 31.3 steps/s
[Step= 500] | Loss=4.00143 | acc=0.1199 | tpr=0.7811 | fpr=0.8920 | 8100.5 samples/s | 31.6 steps/s
[Step= 550] | Loss=4.00295 | acc=0.1200 | tpr=0.7827 | fpr=0.8921 | 15963.5 samples/s | 62.4 steps/s
Avg test loss: 4.00447, Avg test acc: 0.11995, Avg tpr: 0.78328, Avg fpr: 0.89211, total FA: 123868

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.86124 | acc=0.1310 | tpr=0.7920 | fpr=0.8809 | 4131.7 samples/s | 16.1 steps/s
[Step= 100] | Loss=3.83303 | acc=0.1309 | tpr=0.7974 | fpr=0.8815 | 8828.7 samples/s | 34.5 steps/s
[Step= 150] | Loss=3.82966 | acc=0.1305 | tpr=0.7954 | fpr=0.8817 | 8503.1 samples/s | 33.2 steps/s
[Step= 200] | Loss=3.82124 | acc=0.1310 | tpr=0.7978 | fpr=0.8812 | 8399.7 samples/s | 32.8 steps/s
[Step= 250] | Loss=3.81726 | acc=0.1311 | tpr=0.7878 | fpr=0.8809 | 9037.6 samples/s | 35.3 steps/s
[Step= 300] | Loss=3.82334 | acc=0.1317 | tpr=0.7891 | fpr=0.8802 | 7471.8 samples/s | 29.2 steps/s
[Step= 350] | Loss=3.82107 | acc=0.1309 | tpr=0.7884 | fpr=0.8810 | 8872.5 samples/s | 34.7 steps/s
[Step= 400] | Loss=3.81935 | acc=0.1310 | tpr=0.7910 | fpr=0.8810 | 8521.6 samples/s | 33.3 steps/s
[Step= 450] | Loss=3.81811 | acc=0.1308 | tpr=0.7911 | fpr=0.8812 | 8492.8 samples/s | 33.2 steps/s
[Step= 500] | Loss=3.81908 | acc=0.1305 | tpr=0.7890 | fpr=0.8813 | 8066.0 samples/s | 31.5 steps/s
[Step= 550] | Loss=3.81891 | acc=0.1306 | tpr=0.7871 | fpr=0.8813 | 15559.4 samples/s | 60.8 steps/s
Avg test loss: 3.81915, Avg test acc: 0.13062, Avg tpr: 0.78685, Avg fpr: 0.88131, total FA: 122368

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13875 | acc=0.9827 | tpr=0.9159 | fpr=0.0161 | 4322.7 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.14701 | acc=0.9816 | tpr=0.9190 | fpr=0.0173 | 8365.1 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.15194 | acc=0.9811 | tpr=0.9294 | fpr=0.0179 | 8012.9 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.15439 | acc=0.9814 | tpr=0.9333 | fpr=0.0177 | 8625.9 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.15120 | acc=0.9816 | tpr=0.9328 | fpr=0.0175 | 8489.7 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.15248 | acc=0.9815 | tpr=0.9345 | fpr=0.0177 | 8476.5 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.15321 | acc=0.9813 | tpr=0.9368 | fpr=0.0179 | 8379.2 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.15407 | acc=0.9810 | tpr=0.9344 | fpr=0.0181 | 8164.1 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.15748 | acc=0.9807 | tpr=0.9318 | fpr=0.0184 | 8826.5 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.15739 | acc=0.9807 | tpr=0.9330 | fpr=0.0185 | 8450.6 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.15575 | acc=0.9808 | tpr=0.9331 | fpr=0.0183 | 14921.9 samples/s | 58.3 steps/s
Avg test loss: 0.15534, Avg test acc: 0.98083, Avg tpr: 0.93304, Avg fpr: 0.01830, total FA: 2541

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10765 | acc=0.9821 | tpr=0.9248 | fpr=0.0169 | 4256.9 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.11110 | acc=0.9814 | tpr=0.9424 | fpr=0.0178 | 8644.9 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.11618 | acc=0.9807 | tpr=0.9467 | fpr=0.0187 | 8610.8 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.11802 | acc=0.9807 | tpr=0.9454 | fpr=0.0187 | 7937.2 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.11553 | acc=0.9811 | tpr=0.9459 | fpr=0.0183 | 8397.6 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.11720 | acc=0.9808 | tpr=0.9433 | fpr=0.0186 | 8820.5 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.11855 | acc=0.9805 | tpr=0.9461 | fpr=0.0189 | 8540.0 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.12024 | acc=0.9803 | tpr=0.9464 | fpr=0.0191 | 8057.9 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.12327 | acc=0.9799 | tpr=0.9440 | fpr=0.0194 | 7967.3 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.12221 | acc=0.9799 | tpr=0.9445 | fpr=0.0194 | 8365.3 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.12124 | acc=0.9800 | tpr=0.9431 | fpr=0.0193 | 15928.3 samples/s | 62.2 steps/s
Avg test loss: 0.12104, Avg test acc: 0.98002, Avg tpr: 0.94295, Avg fpr: 0.01930, total FA: 2680

server round 8/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=14001 Epoch=27.3] | Loss=0.05500 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.690 | L2-Norm(final)=6.171 | 3661.5 samples/s | 57.2 steps/s
[Step=14050 Epoch=27.4] | Loss=0.07192 | Reg=0.00216 | acc=0.8906 | L2-Norm=14.696 | L2-Norm(final)=6.234 | 5136.3 samples/s | 80.3 steps/s
[Step=14100 Epoch=27.5] | Loss=0.07422 | Reg=0.00216 | acc=0.9062 | L2-Norm=14.697 | L2-Norm(final)=6.296 | 5329.2 samples/s | 83.3 steps/s
[Step=14150 Epoch=27.6] | Loss=0.07345 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.697 | L2-Norm(final)=6.351 | 5018.4 samples/s | 78.4 steps/s
[Step=14200 Epoch=27.7] | Loss=0.07099 | Reg=0.00216 | acc=0.9219 | L2-Norm=14.697 | L2-Norm(final)=6.408 | 5339.0 samples/s | 83.4 steps/s
[Step=14250 Epoch=27.8] | Loss=0.07067 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.697 | L2-Norm(final)=6.465 | 5489.9 samples/s | 85.8 steps/s
[Step=14300 Epoch=27.9] | Loss=0.06941 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.697 | L2-Norm(final)=6.520 | 5380.7 samples/s | 84.1 steps/s
[Step=14350 Epoch=28.0] | Loss=0.07016 | Reg=0.00216 | acc=0.9375 | L2-Norm=14.697 | L2-Norm(final)=6.571 | 5445.2 samples/s | 85.1 steps/s
[Step=14400 Epoch=28.1] | Loss=0.07029 | Reg=0.00216 | acc=0.9375 | L2-Norm=14.697 | L2-Norm(final)=6.618 | 5671.0 samples/s | 88.6 steps/s
[Step=14450 Epoch=28.2] | Loss=0.07041 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.697 | L2-Norm(final)=6.663 | 5469.8 samples/s | 85.5 steps/s
[Step=14500 Epoch=28.3] | Loss=0.07038 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.698 | L2-Norm(final)=6.706 | 7026.7 samples/s | 109.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=14501 Epoch=28.3] | Loss=0.08659 | Reg=0.00216 | acc=0.9375 | L2-Norm=14.698 | L2-Norm(final)=7.126 | 3523.8 samples/s | 55.1 steps/s
[Step=14550 Epoch=28.4] | Loss=0.06312 | Reg=0.00223 | acc=0.9375 | L2-Norm=14.917 | L2-Norm(final)=7.124 | 4448.8 samples/s | 69.5 steps/s
[Step=14600 Epoch=28.5] | Loss=0.06165 | Reg=0.00228 | acc=0.9531 | L2-Norm=15.104 | L2-Norm(final)=7.098 | 4450.4 samples/s | 69.5 steps/s
[Step=14650 Epoch=28.6] | Loss=0.06069 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.240 | L2-Norm(final)=7.076 | 4726.7 samples/s | 73.9 steps/s
[Step=14700 Epoch=28.7] | Loss=0.05696 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.347 | L2-Norm(final)=7.058 | 4887.4 samples/s | 76.4 steps/s
[Step=14750 Epoch=28.8] | Loss=0.05683 | Reg=0.00238 | acc=0.9062 | L2-Norm=15.434 | L2-Norm(final)=7.041 | 4836.1 samples/s | 75.6 steps/s
[Step=14800 Epoch=28.9] | Loss=0.05563 | Reg=0.00241 | acc=0.9531 | L2-Norm=15.512 | L2-Norm(final)=7.026 | 4850.0 samples/s | 75.8 steps/s
[Step=14850 Epoch=29.0] | Loss=0.05354 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.579 | L2-Norm(final)=7.013 | 4882.7 samples/s | 76.3 steps/s
[Step=14900 Epoch=29.1] | Loss=0.05262 | Reg=0.00245 | acc=0.9375 | L2-Norm=15.638 | L2-Norm(final)=7.003 | 4888.6 samples/s | 76.4 steps/s
[Step=14950 Epoch=29.2] | Loss=0.05183 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.692 | L2-Norm(final)=6.993 | 4877.3 samples/s | 76.2 steps/s
[Step=15000 Epoch=29.3] | Loss=0.05084 | Reg=0.00248 | acc=0.9688 | L2-Norm=15.741 | L2-Norm(final)=6.986 | 5898.7 samples/s | 92.2 steps/s
[Step=15050 Epoch=29.4] | Loss=0.05006 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.789 | L2-Norm(final)=6.978 | 1720.4 samples/s | 26.9 steps/s
[Step=15100 Epoch=29.5] | Loss=0.04830 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.834 | L2-Norm(final)=6.971 | 4780.4 samples/s | 74.7 steps/s
[Step=15150 Epoch=29.5] | Loss=0.04668 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.875 | L2-Norm(final)=6.965 | 4892.5 samples/s | 76.4 steps/s
[Step=15200 Epoch=29.6] | Loss=0.04580 | Reg=0.00253 | acc=0.9688 | L2-Norm=15.912 | L2-Norm(final)=6.958 | 4797.2 samples/s | 75.0 steps/s
[Step=15250 Epoch=29.7] | Loss=0.04468 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.947 | L2-Norm(final)=6.952 | 4831.6 samples/s | 75.5 steps/s
[Step=15300 Epoch=29.8] | Loss=0.04386 | Reg=0.00256 | acc=0.9531 | L2-Norm=15.981 | L2-Norm(final)=6.947 | 4841.5 samples/s | 75.6 steps/s
[Step=15350 Epoch=29.9] | Loss=0.04286 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.013 | L2-Norm(final)=6.943 | 4827.3 samples/s | 75.4 steps/s
[Step=15400 Epoch=30.0] | Loss=0.04240 | Reg=0.00258 | acc=0.9844 | L2-Norm=16.044 | L2-Norm(final)=6.937 | 4852.7 samples/s | 75.8 steps/s
[Step=15450 Epoch=30.1] | Loss=0.04169 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.074 | L2-Norm(final)=6.933 | 4703.1 samples/s | 73.5 steps/s
[Step=15500 Epoch=30.2] | Loss=0.04115 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.102 | L2-Norm(final)=6.928 | 4757.5 samples/s | 74.3 steps/s
[Step=15550 Epoch=30.3] | Loss=0.04050 | Reg=0.00260 | acc=0.9844 | L2-Norm=16.130 | L2-Norm(final)=6.923 | 1914.4 samples/s | 29.9 steps/s
[Step=15600 Epoch=30.4] | Loss=0.03979 | Reg=0.00261 | acc=0.9688 | L2-Norm=16.156 | L2-Norm(final)=6.919 | 4891.3 samples/s | 76.4 steps/s
[Step=15650 Epoch=30.5] | Loss=0.03928 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.182 | L2-Norm(final)=6.914 | 4891.3 samples/s | 76.4 steps/s
[Step=15700 Epoch=30.6] | Loss=0.03876 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.207 | L2-Norm(final)=6.910 | 4779.0 samples/s | 74.7 steps/s
[Step=15750 Epoch=30.7] | Loss=0.03849 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.232 | L2-Norm(final)=6.905 | 4894.2 samples/s | 76.5 steps/s
[Step=15800 Epoch=30.8] | Loss=0.03796 | Reg=0.00265 | acc=0.9688 | L2-Norm=16.257 | L2-Norm(final)=6.900 | 4832.6 samples/s | 75.5 steps/s
[Step=15850 Epoch=30.9] | Loss=0.03764 | Reg=0.00265 | acc=0.9688 | L2-Norm=16.280 | L2-Norm(final)=6.895 | 4752.3 samples/s | 74.3 steps/s
[Step=15900 Epoch=31.0] | Loss=0.03717 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.303 | L2-Norm(final)=6.891 | 4699.5 samples/s | 73.4 steps/s
[Step=15950 Epoch=31.1] | Loss=0.03686 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.327 | L2-Norm(final)=6.885 | 4506.2 samples/s | 70.4 steps/s
[Step=16000 Epoch=31.2] | Loss=0.03658 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.350 | L2-Norm(final)=6.880 | 4820.2 samples/s | 75.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step16000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=15.4] | Loss=0.02470 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.690 | L2-Norm(final)=5.646 | 3799.8 samples/s | 59.4 steps/s
[Step=4050 Epoch=15.6] | Loss=0.02915 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.683 | L2-Norm(final)=5.687 | 5038.3 samples/s | 78.7 steps/s
[Step=4100 Epoch=15.8] | Loss=0.02615 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.682 | L2-Norm(final)=5.759 | 5357.2 samples/s | 83.7 steps/s
[Step=4150 Epoch=16.0] | Loss=0.02506 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.681 | L2-Norm(final)=5.840 | 5349.0 samples/s | 83.6 steps/s
[Step=4200 Epoch=16.2] | Loss=0.02334 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.681 | L2-Norm(final)=5.922 | 5357.0 samples/s | 83.7 steps/s
[Step=4250 Epoch=16.4] | Loss=0.02243 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.681 | L2-Norm(final)=6.007 | 7290.4 samples/s | 113.9 steps/s
[Step=4300 Epoch=16.6] | Loss=0.02175 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.681 | L2-Norm(final)=6.092 | 1828.3 samples/s | 28.6 steps/s
[Step=4350 Epoch=16.7] | Loss=0.02136 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.681 | L2-Norm(final)=6.173 | 5248.7 samples/s | 82.0 steps/s
[Step=4400 Epoch=16.9] | Loss=0.02072 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.681 | L2-Norm(final)=6.251 | 5455.2 samples/s | 85.2 steps/s
[Step=4450 Epoch=17.1] | Loss=0.02033 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.681 | L2-Norm(final)=6.325 | 5352.2 samples/s | 83.6 steps/s
[Step=4500 Epoch=17.3] | Loss=0.01987 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.681 | L2-Norm(final)=6.397 | 6148.6 samples/s | 96.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=17.3] | Loss=0.02284 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.681 | L2-Norm(final)=7.104 | 3602.0 samples/s | 56.3 steps/s
[Step=4550 Epoch=17.5] | Loss=0.02262 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.895 | L2-Norm(final)=7.125 | 4864.6 samples/s | 76.0 steps/s
[Step=4600 Epoch=17.7] | Loss=0.02721 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.317 | L2-Norm(final)=7.054 | 4580.1 samples/s | 71.6 steps/s
[Step=4650 Epoch=17.9] | Loss=0.01998 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.542 | L2-Norm(final)=7.018 | 4471.5 samples/s | 69.9 steps/s
[Step=4700 Epoch=18.1] | Loss=0.01637 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.654 | L2-Norm(final)=7.002 | 4320.9 samples/s | 67.5 steps/s
[Step=4750 Epoch=18.3] | Loss=0.01439 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.723 | L2-Norm(final)=6.990 | 5470.8 samples/s | 85.5 steps/s
[Step=4800 Epoch=18.5] | Loss=0.01249 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.769 | L2-Norm(final)=6.980 | 1860.4 samples/s | 29.1 steps/s
[Step=4850 Epoch=18.7] | Loss=0.01077 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.797 | L2-Norm(final)=6.973 | 4698.8 samples/s | 73.4 steps/s
[Step=4900 Epoch=18.9] | Loss=0.00943 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.812 | L2-Norm(final)=6.969 | 4755.3 samples/s | 74.3 steps/s
[Step=4950 Epoch=19.1] | Loss=0.00839 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.817 | L2-Norm(final)=6.966 | 4533.8 samples/s | 70.8 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00757 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.816 | L2-Norm(final)=6.964 | 5254.2 samples/s | 82.1 steps/s
[Step=5050 Epoch=19.4] | Loss=0.00690 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.810 | L2-Norm(final)=6.962 | 1816.4 samples/s | 28.4 steps/s
[Step=5100 Epoch=19.6] | Loss=0.00632 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.800 | L2-Norm(final)=6.961 | 4315.4 samples/s | 67.4 steps/s
[Step=5150 Epoch=19.8] | Loss=0.00584 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.787 | L2-Norm(final)=6.961 | 4483.5 samples/s | 70.1 steps/s
[Step=5200 Epoch=20.0] | Loss=0.00542 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.772 | L2-Norm(final)=6.960 | 4454.9 samples/s | 69.6 steps/s
[Step=5250 Epoch=20.2] | Loss=0.00506 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.755 | L2-Norm(final)=6.960 | 4557.4 samples/s | 71.2 steps/s
[Step=5300 Epoch=20.4] | Loss=0.00475 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.737 | L2-Norm(final)=6.959 | 1954.1 samples/s | 30.5 steps/s
[Step=5350 Epoch=20.6] | Loss=0.00447 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.717 | L2-Norm(final)=6.959 | 4784.6 samples/s | 74.8 steps/s
[Step=5400 Epoch=20.8] | Loss=0.00422 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.697 | L2-Norm(final)=6.959 | 4449.9 samples/s | 69.5 steps/s
[Step=5450 Epoch=21.0] | Loss=0.00400 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.676 | L2-Norm(final)=6.959 | 4334.8 samples/s | 67.7 steps/s
[Step=5500 Epoch=21.2] | Loss=0.00380 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.654 | L2-Norm(final)=6.958 | 4508.4 samples/s | 70.4 steps/s
[Step=5550 Epoch=21.4] | Loss=0.00362 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.631 | L2-Norm(final)=6.958 | 2042.5 samples/s | 31.9 steps/s
[Step=5600 Epoch=21.6] | Loss=0.00345 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.609 | L2-Norm(final)=6.958 | 4644.4 samples/s | 72.6 steps/s
[Step=5650 Epoch=21.7] | Loss=0.00330 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.585 | L2-Norm(final)=6.958 | 4751.2 samples/s | 74.2 steps/s
[Step=5700 Epoch=21.9] | Loss=0.00317 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.562 | L2-Norm(final)=6.958 | 4699.9 samples/s | 73.4 steps/s
[Step=5750 Epoch=22.1] | Loss=0.00304 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.538 | L2-Norm(final)=6.958 | 4758.2 samples/s | 74.3 steps/s
[Step=5800 Epoch=22.3] | Loss=0.00292 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.514 | L2-Norm(final)=6.958 | 6606.5 samples/s | 103.2 steps/s
[Step=5850 Epoch=22.5] | Loss=0.00282 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.490 | L2-Norm(final)=6.959 | 1658.7 samples/s | 25.9 steps/s
[Step=5900 Epoch=22.7] | Loss=0.00271 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.465 | L2-Norm(final)=6.959 | 4461.4 samples/s | 69.7 steps/s
[Step=5950 Epoch=22.9] | Loss=0.00262 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.440 | L2-Norm(final)=6.959 | 4489.7 samples/s | 70.2 steps/s
[Step=6000 Epoch=23.1] | Loss=0.00253 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.416 | L2-Norm(final)=6.959 | 4582.0 samples/s | 71.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06582 | acc=0.9605 | tpr=0.9676 | fpr=0.0550 | 4225.6 samples/s | 16.5 steps/s
Avg test loss: 0.06568, Avg test acc: 0.95801, Avg tpr: 0.96503, Avg fpr: 0.05743, total FA: 448

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06449 | acc=0.9575 | tpr=0.9661 | fpr=0.0612 | 4303.4 samples/s | 16.8 steps/s
Avg test loss: 0.06607, Avg test acc: 0.95649, Avg tpr: 0.96450, Avg fpr: 0.06115, total FA: 477

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.26539 | acc=0.3119 | tpr=0.0023 | fpr=0.0159 | 4136.8 samples/s | 16.2 steps/s
Avg test loss: 6.28897, Avg test acc: 0.30880, Avg tpr: 0.00233, Avg fpr: 0.01718, total FA: 134

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.40259 | acc=0.3077 | tpr=0.0072 | fpr=0.0399 | 4360.9 samples/s | 17.0 steps/s
Avg test loss: 6.40952, Avg test acc: 0.30551, Avg tpr: 0.00775, Avg fpr: 0.03961, total FA: 309

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.03711 | acc=0.1507 | tpr=0.7788 | fpr=0.8606 | 4209.8 samples/s | 16.4 steps/s
[Step= 100] | Loss=4.02576 | acc=0.1513 | tpr=0.7569 | fpr=0.8600 | 8879.8 samples/s | 34.7 steps/s
[Step= 150] | Loss=4.03195 | acc=0.1505 | tpr=0.7522 | fpr=0.8605 | 8548.8 samples/s | 33.4 steps/s
[Step= 200] | Loss=4.02388 | acc=0.1495 | tpr=0.7475 | fpr=0.8614 | 7899.6 samples/s | 30.9 steps/s
[Step= 250] | Loss=4.01887 | acc=0.1504 | tpr=0.7502 | fpr=0.8606 | 8116.4 samples/s | 31.7 steps/s
[Step= 300] | Loss=4.02293 | acc=0.1504 | tpr=0.7382 | fpr=0.8604 | 8170.6 samples/s | 31.9 steps/s
[Step= 350] | Loss=4.02215 | acc=0.1495 | tpr=0.7420 | fpr=0.8612 | 8768.3 samples/s | 34.3 steps/s
[Step= 400] | Loss=4.01992 | acc=0.1494 | tpr=0.7418 | fpr=0.8614 | 8153.9 samples/s | 31.9 steps/s
[Step= 450] | Loss=4.01969 | acc=0.1489 | tpr=0.7498 | fpr=0.8620 | 8468.9 samples/s | 33.1 steps/s
[Step= 500] | Loss=4.02041 | acc=0.1486 | tpr=0.7511 | fpr=0.8623 | 7915.1 samples/s | 30.9 steps/s
[Step= 550] | Loss=4.02278 | acc=0.1484 | tpr=0.7505 | fpr=0.8625 | 16064.3 samples/s | 62.8 steps/s
Avg test loss: 4.02350, Avg test acc: 0.14839, Avg tpr: 0.75079, Avg fpr: 0.86256, total FA: 119765

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.86124 | acc=0.1310 | tpr=0.7920 | fpr=0.8809 | 4250.7 samples/s | 16.6 steps/s
[Step= 100] | Loss=3.83303 | acc=0.1309 | tpr=0.7974 | fpr=0.8815 | 8160.5 samples/s | 31.9 steps/s
[Step= 150] | Loss=3.82966 | acc=0.1305 | tpr=0.7954 | fpr=0.8817 | 9005.6 samples/s | 35.2 steps/s
[Step= 200] | Loss=3.82124 | acc=0.1310 | tpr=0.7978 | fpr=0.8812 | 8009.0 samples/s | 31.3 steps/s
[Step= 250] | Loss=3.81726 | acc=0.1311 | tpr=0.7878 | fpr=0.8809 | 8260.0 samples/s | 32.3 steps/s
[Step= 300] | Loss=3.82334 | acc=0.1317 | tpr=0.7891 | fpr=0.8802 | 8051.4 samples/s | 31.5 steps/s
[Step= 350] | Loss=3.82107 | acc=0.1309 | tpr=0.7884 | fpr=0.8810 | 8501.9 samples/s | 33.2 steps/s
[Step= 400] | Loss=3.81935 | acc=0.1310 | tpr=0.7910 | fpr=0.8810 | 8624.5 samples/s | 33.7 steps/s
[Step= 450] | Loss=3.81811 | acc=0.1308 | tpr=0.7911 | fpr=0.8812 | 8592.6 samples/s | 33.6 steps/s
[Step= 500] | Loss=3.81908 | acc=0.1305 | tpr=0.7890 | fpr=0.8813 | 7613.1 samples/s | 29.7 steps/s
[Step= 550] | Loss=3.81891 | acc=0.1306 | tpr=0.7871 | fpr=0.8813 | 15856.4 samples/s | 61.9 steps/s
Avg test loss: 3.81915, Avg test acc: 0.13062, Avg tpr: 0.78685, Avg fpr: 0.88131, total FA: 122368

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13875 | acc=0.9827 | tpr=0.9159 | fpr=0.0161 | 4286.1 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.14701 | acc=0.9816 | tpr=0.9190 | fpr=0.0173 | 8298.1 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.15194 | acc=0.9811 | tpr=0.9294 | fpr=0.0179 | 8118.3 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.15439 | acc=0.9814 | tpr=0.9333 | fpr=0.0177 | 8845.1 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.15120 | acc=0.9816 | tpr=0.9328 | fpr=0.0175 | 8681.4 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.15248 | acc=0.9815 | tpr=0.9345 | fpr=0.0177 | 8261.4 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.15321 | acc=0.9813 | tpr=0.9368 | fpr=0.0179 | 8640.8 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.15407 | acc=0.9810 | tpr=0.9344 | fpr=0.0181 | 8167.3 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.15748 | acc=0.9807 | tpr=0.9318 | fpr=0.0184 | 8597.0 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.15739 | acc=0.9807 | tpr=0.9330 | fpr=0.0185 | 8947.9 samples/s | 35.0 steps/s
[Step= 550] | Loss=0.15575 | acc=0.9808 | tpr=0.9331 | fpr=0.0183 | 14159.2 samples/s | 55.3 steps/s
Avg test loss: 0.15534, Avg test acc: 0.98083, Avg tpr: 0.93304, Avg fpr: 0.01830, total FA: 2541

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15185 | acc=0.9824 | tpr=0.9336 | fpr=0.0167 | 4321.3 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.16003 | acc=0.9808 | tpr=0.9424 | fpr=0.0185 | 8405.7 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.16576 | acc=0.9801 | tpr=0.9524 | fpr=0.0194 | 8411.6 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.16914 | acc=0.9800 | tpr=0.9552 | fpr=0.0195 | 7941.6 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.16539 | acc=0.9801 | tpr=0.9520 | fpr=0.0193 | 7867.2 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.16689 | acc=0.9799 | tpr=0.9476 | fpr=0.0195 | 8634.6 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.16941 | acc=0.9797 | tpr=0.9505 | fpr=0.0197 | 8377.9 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.17080 | acc=0.9795 | tpr=0.9469 | fpr=0.0199 | 8124.7 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.17474 | acc=0.9791 | tpr=0.9445 | fpr=0.0203 | 8193.0 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.17335 | acc=0.9793 | tpr=0.9454 | fpr=0.0201 | 7912.1 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.17182 | acc=0.9794 | tpr=0.9435 | fpr=0.0199 | 15468.7 samples/s | 60.4 steps/s
Avg test loss: 0.17143, Avg test acc: 0.97945, Avg tpr: 0.94374, Avg fpr: 0.01990, total FA: 2763

server round 9/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=16001 Epoch=31.2] | Loss=0.05324 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.704 | L2-Norm(final)=6.735 | 3468.3 samples/s | 54.2 steps/s
[Step=16050 Epoch=31.3] | Loss=0.07039 | Reg=0.00216 | acc=0.9375 | L2-Norm=14.709 | L2-Norm(final)=6.822 | 5293.2 samples/s | 82.7 steps/s
[Step=16100 Epoch=31.4] | Loss=0.06992 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.710 | L2-Norm(final)=6.927 | 5090.4 samples/s | 79.5 steps/s
[Step=16150 Epoch=31.5] | Loss=0.06854 | Reg=0.00216 | acc=0.9219 | L2-Norm=14.710 | L2-Norm(final)=7.018 | 5356.0 samples/s | 83.7 steps/s
[Step=16200 Epoch=31.6] | Loss=0.06806 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.710 | L2-Norm(final)=7.101 | 5575.4 samples/s | 87.1 steps/s
[Step=16250 Epoch=31.7] | Loss=0.06738 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.710 | L2-Norm(final)=7.181 | 5598.6 samples/s | 87.5 steps/s
[Step=16300 Epoch=31.8] | Loss=0.06704 | Reg=0.00216 | acc=0.9062 | L2-Norm=14.711 | L2-Norm(final)=7.251 | 5586.4 samples/s | 87.3 steps/s
[Step=16350 Epoch=31.9] | Loss=0.06600 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.711 | L2-Norm(final)=7.317 | 5617.1 samples/s | 87.8 steps/s
[Step=16400 Epoch=32.0] | Loss=0.06474 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.711 | L2-Norm(final)=7.381 | 5694.5 samples/s | 89.0 steps/s
[Step=16450 Epoch=32.1] | Loss=0.06459 | Reg=0.00216 | acc=0.9375 | L2-Norm=14.711 | L2-Norm(final)=7.443 | 5588.9 samples/s | 87.3 steps/s
[Step=16500 Epoch=32.2] | Loss=0.06440 | Reg=0.00216 | acc=0.9062 | L2-Norm=14.711 | L2-Norm(final)=7.502 | 7156.1 samples/s | 111.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=16501 Epoch=32.2] | Loss=0.03684 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.711 | L2-Norm(final)=8.077 | 3516.4 samples/s | 54.9 steps/s
[Step=16550 Epoch=32.3] | Loss=0.05851 | Reg=0.00223 | acc=0.9531 | L2-Norm=14.946 | L2-Norm(final)=8.073 | 4584.9 samples/s | 71.6 steps/s
[Step=16600 Epoch=32.4] | Loss=0.06211 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.154 | L2-Norm(final)=8.052 | 4442.2 samples/s | 69.4 steps/s
[Step=16650 Epoch=32.5] | Loss=0.06097 | Reg=0.00234 | acc=0.9219 | L2-Norm=15.299 | L2-Norm(final)=8.029 | 4698.3 samples/s | 73.4 steps/s
[Step=16700 Epoch=32.6] | Loss=0.05984 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.406 | L2-Norm(final)=8.011 | 4697.0 samples/s | 73.4 steps/s
[Step=16750 Epoch=32.7] | Loss=0.05746 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.492 | L2-Norm(final)=7.998 | 4692.1 samples/s | 73.3 steps/s
[Step=16800 Epoch=32.8] | Loss=0.05621 | Reg=0.00242 | acc=0.9531 | L2-Norm=15.565 | L2-Norm(final)=7.987 | 4959.2 samples/s | 77.5 steps/s
[Step=16850 Epoch=32.9] | Loss=0.05495 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.628 | L2-Norm(final)=7.977 | 4930.4 samples/s | 77.0 steps/s
[Step=16900 Epoch=33.0] | Loss=0.05380 | Reg=0.00246 | acc=0.8906 | L2-Norm=15.681 | L2-Norm(final)=7.967 | 4970.8 samples/s | 77.7 steps/s
[Step=16950 Epoch=33.1] | Loss=0.05258 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.728 | L2-Norm(final)=7.957 | 4877.5 samples/s | 76.2 steps/s
[Step=17000 Epoch=33.2] | Loss=0.05099 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.771 | L2-Norm(final)=7.948 | 5730.5 samples/s | 89.5 steps/s
[Step=17050 Epoch=33.3] | Loss=0.04910 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.808 | L2-Norm(final)=7.940 | 1764.3 samples/s | 27.6 steps/s
[Step=17100 Epoch=33.4] | Loss=0.04743 | Reg=0.00251 | acc=0.9531 | L2-Norm=15.843 | L2-Norm(final)=7.934 | 4696.7 samples/s | 73.4 steps/s
[Step=17150 Epoch=33.4] | Loss=0.04624 | Reg=0.00252 | acc=0.9531 | L2-Norm=15.877 | L2-Norm(final)=7.928 | 4729.4 samples/s | 73.9 steps/s
[Step=17200 Epoch=33.5] | Loss=0.04525 | Reg=0.00253 | acc=0.9688 | L2-Norm=15.909 | L2-Norm(final)=7.924 | 4983.6 samples/s | 77.9 steps/s
[Step=17250 Epoch=33.6] | Loss=0.04396 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.939 | L2-Norm(final)=7.920 | 4917.8 samples/s | 76.8 steps/s
[Step=17300 Epoch=33.7] | Loss=0.04289 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.970 | L2-Norm(final)=7.916 | 4897.2 samples/s | 76.5 steps/s
[Step=17350 Epoch=33.8] | Loss=0.04234 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.999 | L2-Norm(final)=7.912 | 4872.4 samples/s | 76.1 steps/s
[Step=17400 Epoch=33.9] | Loss=0.04200 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.028 | L2-Norm(final)=7.907 | 4744.6 samples/s | 74.1 steps/s
[Step=17450 Epoch=34.0] | Loss=0.04150 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.057 | L2-Norm(final)=7.902 | 4699.2 samples/s | 73.4 steps/s
[Step=17500 Epoch=34.1] | Loss=0.04106 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.085 | L2-Norm(final)=7.898 | 4724.9 samples/s | 73.8 steps/s
[Step=17550 Epoch=34.2] | Loss=0.04074 | Reg=0.00260 | acc=0.9844 | L2-Norm=16.113 | L2-Norm(final)=7.893 | 1884.1 samples/s | 29.4 steps/s
[Step=17600 Epoch=34.3] | Loss=0.03998 | Reg=0.00261 | acc=0.9688 | L2-Norm=16.140 | L2-Norm(final)=7.888 | 4921.1 samples/s | 76.9 steps/s
[Step=17650 Epoch=34.4] | Loss=0.03928 | Reg=0.00262 | acc=0.9375 | L2-Norm=16.166 | L2-Norm(final)=7.884 | 4952.6 samples/s | 77.4 steps/s
[Step=17700 Epoch=34.5] | Loss=0.03902 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.192 | L2-Norm(final)=7.879 | 4941.5 samples/s | 77.2 steps/s
[Step=17750 Epoch=34.6] | Loss=0.03882 | Reg=0.00263 | acc=0.9531 | L2-Norm=16.217 | L2-Norm(final)=7.874 | 4994.3 samples/s | 78.0 steps/s
[Step=17800 Epoch=34.7] | Loss=0.03812 | Reg=0.00264 | acc=0.9688 | L2-Norm=16.242 | L2-Norm(final)=7.869 | 5000.2 samples/s | 78.1 steps/s
[Step=17850 Epoch=34.8] | Loss=0.03764 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.266 | L2-Norm(final)=7.864 | 4657.3 samples/s | 72.8 steps/s
[Step=17900 Epoch=34.9] | Loss=0.03712 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.289 | L2-Norm(final)=7.860 | 4558.5 samples/s | 71.2 steps/s
[Step=17950 Epoch=35.0] | Loss=0.03673 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.312 | L2-Norm(final)=7.855 | 4601.2 samples/s | 71.9 steps/s
[Step=18000 Epoch=35.1] | Loss=0.03650 | Reg=0.00267 | acc=0.9688 | L2-Norm=16.333 | L2-Norm(final)=7.851 | 4871.1 samples/s | 76.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step18000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=23.1] | Loss=0.02171 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.704 | L2-Norm(final)=6.963 | 3665.5 samples/s | 57.3 steps/s
[Step=6050 Epoch=23.3] | Loss=0.01313 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.696 | L2-Norm(final)=7.046 | 5384.2 samples/s | 84.1 steps/s
[Step=6100 Epoch=23.5] | Loss=0.01413 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.695 | L2-Norm(final)=7.154 | 5437.4 samples/s | 85.0 steps/s
[Step=6150 Epoch=23.7] | Loss=0.01376 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.694 | L2-Norm(final)=7.260 | 5187.5 samples/s | 81.1 steps/s
[Step=6200 Epoch=23.9] | Loss=0.01323 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.694 | L2-Norm(final)=7.357 | 5343.8 samples/s | 83.5 steps/s
[Step=6250 Epoch=24.1] | Loss=0.01297 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.694 | L2-Norm(final)=7.449 | 7044.5 samples/s | 110.1 steps/s
[Step=6300 Epoch=24.3] | Loss=0.01257 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.694 | L2-Norm(final)=7.535 | 1790.8 samples/s | 28.0 steps/s
[Step=6350 Epoch=24.4] | Loss=0.01235 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.694 | L2-Norm(final)=7.618 | 5311.4 samples/s | 83.0 steps/s
[Step=6400 Epoch=24.6] | Loss=0.01234 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.694 | L2-Norm(final)=7.697 | 5412.0 samples/s | 84.6 steps/s
[Step=6450 Epoch=24.8] | Loss=0.01196 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.694 | L2-Norm(final)=7.773 | 5474.4 samples/s | 85.5 steps/s
[Step=6500 Epoch=25.0] | Loss=0.01173 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.694 | L2-Norm(final)=7.846 | 6095.2 samples/s | 95.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=25.0] | Loss=0.00626 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.694 | L2-Norm(final)=8.556 | 4088.4 samples/s | 63.9 steps/s
[Step=6550 Epoch=25.2] | Loss=0.02511 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.982 | L2-Norm(final)=8.542 | 4084.6 samples/s | 63.8 steps/s
[Step=6600 Epoch=25.4] | Loss=0.02033 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.327 | L2-Norm(final)=8.508 | 4608.8 samples/s | 72.0 steps/s
[Step=6650 Epoch=25.6] | Loss=0.01674 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.499 | L2-Norm(final)=8.485 | 4397.5 samples/s | 68.7 steps/s
[Step=6700 Epoch=25.8] | Loss=0.01403 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.590 | L2-Norm(final)=8.470 | 4246.7 samples/s | 66.4 steps/s
[Step=6750 Epoch=26.0] | Loss=0.01222 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.641 | L2-Norm(final)=8.459 | 5681.2 samples/s | 88.8 steps/s
[Step=6800 Epoch=26.2] | Loss=0.01061 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.676 | L2-Norm(final)=8.450 | 1827.8 samples/s | 28.6 steps/s
[Step=6850 Epoch=26.4] | Loss=0.00917 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.694 | L2-Norm(final)=8.445 | 4724.6 samples/s | 73.8 steps/s
[Step=6900 Epoch=26.6] | Loss=0.00809 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.701 | L2-Norm(final)=8.442 | 4674.4 samples/s | 73.0 steps/s
[Step=6950 Epoch=26.8] | Loss=0.00725 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.700 | L2-Norm(final)=8.440 | 4684.7 samples/s | 73.2 steps/s
[Step=7000 Epoch=26.9] | Loss=0.00655 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.695 | L2-Norm(final)=8.439 | 5233.0 samples/s | 81.8 steps/s
[Step=7050 Epoch=27.1] | Loss=0.00596 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.685 | L2-Norm(final)=8.439 | 1789.9 samples/s | 28.0 steps/s
[Step=7100 Epoch=27.3] | Loss=0.00548 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.671 | L2-Norm(final)=8.439 | 4340.9 samples/s | 67.8 steps/s
[Step=7150 Epoch=27.5] | Loss=0.00510 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.656 | L2-Norm(final)=8.439 | 4537.9 samples/s | 70.9 steps/s
[Step=7200 Epoch=27.7] | Loss=0.00544 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.648 | L2-Norm(final)=8.438 | 4454.5 samples/s | 69.6 steps/s
[Step=7250 Epoch=27.9] | Loss=0.00554 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.650 | L2-Norm(final)=8.433 | 4595.0 samples/s | 71.8 steps/s
[Step=7300 Epoch=28.1] | Loss=0.00536 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.652 | L2-Norm(final)=8.428 | 1992.8 samples/s | 31.1 steps/s
[Step=7350 Epoch=28.3] | Loss=0.00506 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.654 | L2-Norm(final)=8.424 | 4634.1 samples/s | 72.4 steps/s
[Step=7400 Epoch=28.5] | Loss=0.00485 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.652 | L2-Norm(final)=8.421 | 4405.1 samples/s | 68.8 steps/s
[Step=7450 Epoch=28.7] | Loss=0.00472 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.650 | L2-Norm(final)=8.417 | 4243.2 samples/s | 66.3 steps/s
[Step=7500 Epoch=28.9] | Loss=0.00453 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.646 | L2-Norm(final)=8.414 | 4446.3 samples/s | 69.5 steps/s
[Step=7550 Epoch=29.1] | Loss=0.00434 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.641 | L2-Norm(final)=8.411 | 1958.6 samples/s | 30.6 steps/s
[Step=7600 Epoch=29.3] | Loss=0.00414 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.634 | L2-Norm(final)=8.409 | 4380.8 samples/s | 68.4 steps/s
[Step=7650 Epoch=29.4] | Loss=0.00397 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.625 | L2-Norm(final)=8.407 | 4464.1 samples/s | 69.8 steps/s
[Step=7700 Epoch=29.6] | Loss=0.00380 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.616 | L2-Norm(final)=8.406 | 4615.5 samples/s | 72.1 steps/s
[Step=7750 Epoch=29.8] | Loss=0.00365 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.605 | L2-Norm(final)=8.404 | 4606.8 samples/s | 72.0 steps/s
[Step=7800 Epoch=30.0] | Loss=0.00351 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.593 | L2-Norm(final)=8.403 | 6402.1 samples/s | 100.0 steps/s
[Step=7850 Epoch=30.2] | Loss=0.00338 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.579 | L2-Norm(final)=8.402 | 1696.1 samples/s | 26.5 steps/s
[Step=7900 Epoch=30.4] | Loss=0.00326 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.565 | L2-Norm(final)=8.401 | 4547.3 samples/s | 71.1 steps/s
[Step=7950 Epoch=30.6] | Loss=0.00315 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.550 | L2-Norm(final)=8.400 | 4625.4 samples/s | 72.3 steps/s
[Step=8000 Epoch=30.8] | Loss=0.00305 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.534 | L2-Norm(final)=8.400 | 4587.1 samples/s | 71.7 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07083 | acc=0.9569 | tpr=0.9631 | fpr=0.0567 | 4147.8 samples/s | 16.2 steps/s
Avg test loss: 0.07359, Avg test acc: 0.95557, Avg tpr: 0.96107, Avg fpr: 0.05653, total FA: 441

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06449 | acc=0.9575 | tpr=0.9661 | fpr=0.0612 | 4246.9 samples/s | 16.6 steps/s
Avg test loss: 0.06607, Avg test acc: 0.95649, Avg tpr: 0.96450, Avg fpr: 0.06115, total FA: 477

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.26539 | acc=0.3119 | tpr=0.0023 | fpr=0.0159 | 4332.5 samples/s | 16.9 steps/s
Avg test loss: 6.28897, Avg test acc: 0.30880, Avg tpr: 0.00233, Avg fpr: 0.01718, total FA: 134

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.17722 | acc=0.3116 | tpr=0.0062 | fpr=0.0253 | 4357.5 samples/s | 17.0 steps/s
Avg test loss: 5.17703, Avg test acc: 0.30908, Avg tpr: 0.00635, Avg fpr: 0.02512, total FA: 196

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.04913 | acc=0.1577 | tpr=0.6372 | fpr=0.8510 | 4205.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=4.02117 | acc=0.1615 | tpr=0.6439 | fpr=0.8475 | 8767.2 samples/s | 34.2 steps/s
[Step= 150] | Loss=4.01810 | acc=0.1618 | tpr=0.6427 | fpr=0.8471 | 8587.3 samples/s | 33.5 steps/s
[Step= 200] | Loss=4.00934 | acc=0.1617 | tpr=0.6437 | fpr=0.8470 | 8029.8 samples/s | 31.4 steps/s
[Step= 250] | Loss=4.00362 | acc=0.1619 | tpr=0.6279 | fpr=0.8466 | 8798.6 samples/s | 34.4 steps/s
[Step= 300] | Loss=4.00144 | acc=0.1627 | tpr=0.6218 | fpr=0.8456 | 8523.2 samples/s | 33.3 steps/s
[Step= 350] | Loss=4.00189 | acc=0.1622 | tpr=0.6249 | fpr=0.8462 | 8592.4 samples/s | 33.6 steps/s
[Step= 400] | Loss=3.99921 | acc=0.1628 | tpr=0.6296 | fpr=0.8457 | 8141.7 samples/s | 31.8 steps/s
[Step= 450] | Loss=3.99829 | acc=0.1625 | tpr=0.6329 | fpr=0.8461 | 8430.5 samples/s | 32.9 steps/s
[Step= 500] | Loss=3.99842 | acc=0.1624 | tpr=0.6322 | fpr=0.8460 | 8775.7 samples/s | 34.3 steps/s
[Step= 550] | Loss=4.00172 | acc=0.1620 | tpr=0.6240 | fpr=0.8464 | 15656.1 samples/s | 61.2 steps/s
Avg test loss: 4.00218, Avg test acc: 0.16188, Avg tpr: 0.62480, Avg fpr: 0.84654, total FA: 117540

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.86124 | acc=0.1310 | tpr=0.7920 | fpr=0.8809 | 4132.8 samples/s | 16.1 steps/s
[Step= 100] | Loss=3.83303 | acc=0.1309 | tpr=0.7974 | fpr=0.8815 | 8875.3 samples/s | 34.7 steps/s
[Step= 150] | Loss=3.82966 | acc=0.1305 | tpr=0.7954 | fpr=0.8817 | 8549.0 samples/s | 33.4 steps/s
[Step= 200] | Loss=3.82124 | acc=0.1310 | tpr=0.7978 | fpr=0.8812 | 8967.3 samples/s | 35.0 steps/s
[Step= 250] | Loss=3.81726 | acc=0.1311 | tpr=0.7878 | fpr=0.8809 | 8255.9 samples/s | 32.2 steps/s
[Step= 300] | Loss=3.82334 | acc=0.1317 | tpr=0.7891 | fpr=0.8802 | 8617.8 samples/s | 33.7 steps/s
[Step= 350] | Loss=3.82107 | acc=0.1309 | tpr=0.7884 | fpr=0.8810 | 8397.9 samples/s | 32.8 steps/s
[Step= 400] | Loss=3.81935 | acc=0.1310 | tpr=0.7910 | fpr=0.8810 | 8472.0 samples/s | 33.1 steps/s
[Step= 450] | Loss=3.81811 | acc=0.1308 | tpr=0.7911 | fpr=0.8812 | 8824.7 samples/s | 34.5 steps/s
[Step= 500] | Loss=3.81908 | acc=0.1305 | tpr=0.7890 | fpr=0.8813 | 7954.8 samples/s | 31.1 steps/s
[Step= 550] | Loss=3.81891 | acc=0.1306 | tpr=0.7871 | fpr=0.8813 | 15041.6 samples/s | 58.8 steps/s
Avg test loss: 3.81915, Avg test acc: 0.13062, Avg tpr: 0.78685, Avg fpr: 0.88131, total FA: 122368

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13875 | acc=0.9827 | tpr=0.9159 | fpr=0.0161 | 4415.3 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.14701 | acc=0.9816 | tpr=0.9190 | fpr=0.0173 | 8441.1 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.15194 | acc=0.9811 | tpr=0.9294 | fpr=0.0179 | 7714.6 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.15439 | acc=0.9814 | tpr=0.9333 | fpr=0.0177 | 9153.6 samples/s | 35.8 steps/s
[Step= 250] | Loss=0.15120 | acc=0.9816 | tpr=0.9328 | fpr=0.0175 | 8079.8 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.15248 | acc=0.9815 | tpr=0.9345 | fpr=0.0177 | 8519.9 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.15321 | acc=0.9813 | tpr=0.9368 | fpr=0.0179 | 7984.6 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.15407 | acc=0.9810 | tpr=0.9344 | fpr=0.0181 | 8069.5 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.15748 | acc=0.9807 | tpr=0.9318 | fpr=0.0184 | 8390.7 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.15739 | acc=0.9807 | tpr=0.9330 | fpr=0.0185 | 8382.1 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.15575 | acc=0.9808 | tpr=0.9331 | fpr=0.0183 | 15048.6 samples/s | 58.8 steps/s
Avg test loss: 0.15534, Avg test acc: 0.98083, Avg tpr: 0.93304, Avg fpr: 0.01830, total FA: 2541

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14025 | acc=0.9820 | tpr=0.9381 | fpr=0.0173 | 4221.6 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.14573 | acc=0.9814 | tpr=0.9531 | fpr=0.0181 | 7962.2 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.15287 | acc=0.9801 | tpr=0.9582 | fpr=0.0195 | 8372.4 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.15349 | acc=0.9802 | tpr=0.9574 | fpr=0.0194 | 8627.9 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.15026 | acc=0.9803 | tpr=0.9546 | fpr=0.0193 | 8199.9 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.15251 | acc=0.9801 | tpr=0.9556 | fpr=0.0194 | 8753.1 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.15472 | acc=0.9797 | tpr=0.9568 | fpr=0.0199 | 8407.8 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.15657 | acc=0.9795 | tpr=0.9540 | fpr=0.0200 | 8207.8 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.15928 | acc=0.9793 | tpr=0.9542 | fpr=0.0203 | 8636.5 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.15866 | acc=0.9794 | tpr=0.9551 | fpr=0.0201 | 8389.2 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.15771 | acc=0.9796 | tpr=0.9522 | fpr=0.0200 | 15703.8 samples/s | 61.3 steps/s
Avg test loss: 0.15741, Avg test acc: 0.97957, Avg tpr: 0.95206, Avg fpr: 0.01993, total FA: 2767

server round 10/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=35.1] | Loss=0.09509 | Reg=0.00216 | acc=0.9219 | L2-Norm=14.681 | L2-Norm(final)=7.720 | 3566.6 samples/s | 55.7 steps/s
[Step=18050 Epoch=35.2] | Loss=0.08578 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.685 | L2-Norm(final)=7.747 | 5116.2 samples/s | 79.9 steps/s
[Step=18100 Epoch=35.3] | Loss=0.08390 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.686 | L2-Norm(final)=7.793 | 5173.2 samples/s | 80.8 steps/s
[Step=18150 Epoch=35.4] | Loss=0.08214 | Reg=0.00216 | acc=0.9062 | L2-Norm=14.686 | L2-Norm(final)=7.838 | 5470.9 samples/s | 85.5 steps/s
[Step=18200 Epoch=35.5] | Loss=0.08145 | Reg=0.00216 | acc=0.9375 | L2-Norm=14.686 | L2-Norm(final)=7.884 | 5469.9 samples/s | 85.5 steps/s
[Step=18250 Epoch=35.6] | Loss=0.08127 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.686 | L2-Norm(final)=7.927 | 5696.6 samples/s | 89.0 steps/s
[Step=18300 Epoch=35.7] | Loss=0.08138 | Reg=0.00216 | acc=0.9375 | L2-Norm=14.686 | L2-Norm(final)=7.968 | 5562.8 samples/s | 86.9 steps/s
[Step=18350 Epoch=35.8] | Loss=0.08160 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.686 | L2-Norm(final)=8.006 | 5719.3 samples/s | 89.4 steps/s
[Step=18400 Epoch=35.9] | Loss=0.08158 | Reg=0.00216 | acc=0.9375 | L2-Norm=14.686 | L2-Norm(final)=8.043 | 5757.7 samples/s | 90.0 steps/s
[Step=18450 Epoch=36.0] | Loss=0.08109 | Reg=0.00216 | acc=0.8906 | L2-Norm=14.686 | L2-Norm(final)=8.079 | 5686.9 samples/s | 88.9 steps/s
[Step=18500 Epoch=36.1] | Loss=0.08045 | Reg=0.00216 | acc=0.8750 | L2-Norm=14.686 | L2-Norm(final)=8.115 | 7147.4 samples/s | 111.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=36.1] | Loss=0.04218 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.686 | L2-Norm(final)=8.472 | 3570.4 samples/s | 55.8 steps/s
[Step=18550 Epoch=36.2] | Loss=0.06141 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.779 | L2-Norm(final)=8.481 | 4626.4 samples/s | 72.3 steps/s
[Step=18600 Epoch=36.3] | Loss=0.05130 | Reg=0.00220 | acc=0.9531 | L2-Norm=14.844 | L2-Norm(final)=8.475 | 4522.7 samples/s | 70.7 steps/s
[Step=18650 Epoch=36.4] | Loss=0.04652 | Reg=0.00221 | acc=0.9531 | L2-Norm=14.877 | L2-Norm(final)=8.475 | 4945.5 samples/s | 77.3 steps/s
[Step=18700 Epoch=36.5] | Loss=0.04433 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.901 | L2-Norm(final)=8.473 | 5015.1 samples/s | 78.4 steps/s
[Step=18750 Epoch=36.6] | Loss=0.04069 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.921 | L2-Norm(final)=8.471 | 4774.2 samples/s | 74.6 steps/s
[Step=18800 Epoch=36.7] | Loss=0.03961 | Reg=0.00223 | acc=0.9531 | L2-Norm=14.938 | L2-Norm(final)=8.469 | 4878.1 samples/s | 76.2 steps/s
[Step=18850 Epoch=36.8] | Loss=0.03809 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.953 | L2-Norm(final)=8.466 | 4904.6 samples/s | 76.6 steps/s
[Step=18900 Epoch=36.9] | Loss=0.03627 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.967 | L2-Norm(final)=8.465 | 4894.9 samples/s | 76.5 steps/s
[Step=18950 Epoch=37.0] | Loss=0.03549 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.979 | L2-Norm(final)=8.465 | 4917.6 samples/s | 76.8 steps/s
[Step=19000 Epoch=37.1] | Loss=0.03451 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.990 | L2-Norm(final)=8.464 | 5692.0 samples/s | 88.9 steps/s
[Step=19050 Epoch=37.2] | Loss=0.03363 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.001 | L2-Norm(final)=8.464 | 1757.1 samples/s | 27.5 steps/s
[Step=19100 Epoch=37.3] | Loss=0.03215 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.010 | L2-Norm(final)=8.464 | 4824.1 samples/s | 75.4 steps/s
[Step=19150 Epoch=37.3] | Loss=0.03128 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.019 | L2-Norm(final)=8.464 | 4928.6 samples/s | 77.0 steps/s
[Step=19200 Epoch=37.4] | Loss=0.03035 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.026 | L2-Norm(final)=8.464 | 4930.4 samples/s | 77.0 steps/s
[Step=19250 Epoch=37.5] | Loss=0.02964 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.034 | L2-Norm(final)=8.464 | 4842.1 samples/s | 75.7 steps/s
[Step=19300 Epoch=37.6] | Loss=0.02895 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.041 | L2-Norm(final)=8.464 | 4885.2 samples/s | 76.3 steps/s
[Step=19350 Epoch=37.7] | Loss=0.02809 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.049 | L2-Norm(final)=8.465 | 4815.1 samples/s | 75.2 steps/s
[Step=19400 Epoch=37.8] | Loss=0.02750 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.056 | L2-Norm(final)=8.465 | 4802.2 samples/s | 75.0 steps/s
[Step=19450 Epoch=37.9] | Loss=0.02713 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.063 | L2-Norm(final)=8.466 | 4661.1 samples/s | 72.8 steps/s
[Step=19500 Epoch=38.0] | Loss=0.02691 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.070 | L2-Norm(final)=8.466 | 4782.6 samples/s | 74.7 steps/s
[Step=19550 Epoch=38.1] | Loss=0.02639 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.077 | L2-Norm(final)=8.466 | 1918.3 samples/s | 30.0 steps/s
[Step=19600 Epoch=38.2] | Loss=0.02592 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.083 | L2-Norm(final)=8.467 | 4912.6 samples/s | 76.8 steps/s
[Step=19650 Epoch=38.3] | Loss=0.02547 | Reg=0.00228 | acc=0.9688 | L2-Norm=15.089 | L2-Norm(final)=8.467 | 4952.1 samples/s | 77.4 steps/s
[Step=19700 Epoch=38.4] | Loss=0.02503 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.095 | L2-Norm(final)=8.468 | 4977.8 samples/s | 77.8 steps/s
[Step=19750 Epoch=38.5] | Loss=0.02462 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.101 | L2-Norm(final)=8.469 | 4943.7 samples/s | 77.2 steps/s
[Step=19800 Epoch=38.6] | Loss=0.02438 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.107 | L2-Norm(final)=8.470 | 4918.2 samples/s | 76.8 steps/s
[Step=19850 Epoch=38.7] | Loss=0.02416 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.112 | L2-Norm(final)=8.470 | 4632.5 samples/s | 72.4 steps/s
[Step=19900 Epoch=38.8] | Loss=0.02382 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.118 | L2-Norm(final)=8.471 | 4553.7 samples/s | 71.2 steps/s
[Step=19950 Epoch=38.9] | Loss=0.02349 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.123 | L2-Norm(final)=8.471 | 4469.6 samples/s | 69.8 steps/s
[Step=20000 Epoch=39.0] | Loss=0.02325 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.128 | L2-Norm(final)=8.472 | 4710.9 samples/s | 73.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step20000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=8001 Epoch=30.7] | Loss=0.03873 | Reg=0.00216 | acc=0.9375 | L2-Norm=14.681 | L2-Norm(final)=7.293 | 3908.5 samples/s | 61.1 steps/s
[Step=8050 Epoch=30.8] | Loss=0.02042 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.676 | L2-Norm(final)=7.327 | 4946.5 samples/s | 77.3 steps/s
[Step=8100 Epoch=31.0] | Loss=0.01936 | Reg=0.00215 | acc=0.9531 | L2-Norm=14.676 | L2-Norm(final)=7.381 | 5377.9 samples/s | 84.0 steps/s
[Step=8150 Epoch=31.2] | Loss=0.01811 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.676 | L2-Norm(final)=7.439 | 5533.3 samples/s | 86.5 steps/s
[Step=8200 Epoch=31.4] | Loss=0.01731 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.675 | L2-Norm(final)=7.498 | 5278.0 samples/s | 82.5 steps/s
[Step=8250 Epoch=31.6] | Loss=0.01697 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.675 | L2-Norm(final)=7.561 | 6881.8 samples/s | 107.5 steps/s
[Step=8300 Epoch=31.8] | Loss=0.01639 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.675 | L2-Norm(final)=7.623 | 1808.3 samples/s | 28.3 steps/s
[Step=8350 Epoch=32.0] | Loss=0.01602 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.675 | L2-Norm(final)=7.685 | 5145.9 samples/s | 80.4 steps/s
[Step=8400 Epoch=32.2] | Loss=0.01560 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.675 | L2-Norm(final)=7.745 | 5048.8 samples/s | 78.9 steps/s
[Step=8450 Epoch=32.4] | Loss=0.01524 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.675 | L2-Norm(final)=7.803 | 5154.1 samples/s | 80.5 steps/s
[Step=8500 Epoch=32.6] | Loss=0.01483 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.675 | L2-Norm(final)=7.861 | 5629.0 samples/s | 88.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=32.6] | Loss=0.01197 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.675 | L2-Norm(final)=8.435 | 3965.7 samples/s | 62.0 steps/s
[Step=8550 Epoch=32.8] | Loss=0.00695 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.722 | L2-Norm(final)=8.464 | 4318.9 samples/s | 67.5 steps/s
[Step=8600 Epoch=33.0] | Loss=0.00552 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.764 | L2-Norm(final)=8.467 | 4636.6 samples/s | 72.4 steps/s
[Step=8650 Epoch=33.1] | Loss=0.00376 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.777 | L2-Norm(final)=8.467 | 4416.9 samples/s | 69.0 steps/s
[Step=8700 Epoch=33.3] | Loss=0.00285 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.773 | L2-Norm(final)=8.469 | 4302.5 samples/s | 67.2 steps/s
[Step=8750 Epoch=33.5] | Loss=0.00238 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.762 | L2-Norm(final)=8.470 | 5478.2 samples/s | 85.6 steps/s
[Step=8800 Epoch=33.7] | Loss=0.00294 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.755 | L2-Norm(final)=8.470 | 1853.7 samples/s | 29.0 steps/s
[Step=8850 Epoch=33.9] | Loss=0.00302 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.758 | L2-Norm(final)=8.469 | 4547.9 samples/s | 71.1 steps/s
[Step=8900 Epoch=34.1] | Loss=0.00291 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.763 | L2-Norm(final)=8.466 | 4461.6 samples/s | 69.7 steps/s
[Step=8950 Epoch=34.3] | Loss=0.00266 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.765 | L2-Norm(final)=8.465 | 4489.5 samples/s | 70.1 steps/s
[Step=9000 Epoch=34.5] | Loss=0.00240 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.764 | L2-Norm(final)=8.464 | 4972.8 samples/s | 77.7 steps/s
[Step=9050 Epoch=34.7] | Loss=0.00218 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.759 | L2-Norm(final)=8.464 | 1801.8 samples/s | 28.2 steps/s
[Step=9100 Epoch=34.9] | Loss=0.00201 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.752 | L2-Norm(final)=8.463 | 4564.8 samples/s | 71.3 steps/s
[Step=9150 Epoch=35.1] | Loss=0.00185 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.744 | L2-Norm(final)=8.463 | 4710.0 samples/s | 73.6 steps/s
[Step=9200 Epoch=35.3] | Loss=0.00172 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.734 | L2-Norm(final)=8.463 | 4793.8 samples/s | 74.9 steps/s
[Step=9250 Epoch=35.4] | Loss=0.00161 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.724 | L2-Norm(final)=8.464 | 4684.5 samples/s | 73.2 steps/s
[Step=9300 Epoch=35.6] | Loss=0.00151 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.712 | L2-Norm(final)=8.464 | 2009.8 samples/s | 31.4 steps/s
[Step=9350 Epoch=35.8] | Loss=0.00142 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.700 | L2-Norm(final)=8.464 | 4771.1 samples/s | 74.5 steps/s
[Step=9400 Epoch=36.0] | Loss=0.00134 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.687 | L2-Norm(final)=8.465 | 4515.6 samples/s | 70.6 steps/s
[Step=9450 Epoch=36.2] | Loss=0.00127 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.673 | L2-Norm(final)=8.465 | 4342.3 samples/s | 67.8 steps/s
[Step=9500 Epoch=36.4] | Loss=0.00121 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.660 | L2-Norm(final)=8.465 | 4369.1 samples/s | 68.3 steps/s
[Step=9550 Epoch=36.6] | Loss=0.00115 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.645 | L2-Norm(final)=8.466 | 1951.1 samples/s | 30.5 steps/s
[Step=9600 Epoch=36.8] | Loss=0.00110 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.631 | L2-Norm(final)=8.466 | 4599.7 samples/s | 71.9 steps/s
[Step=9650 Epoch=37.0] | Loss=0.00105 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.616 | L2-Norm(final)=8.466 | 4685.9 samples/s | 73.2 steps/s
[Step=9700 Epoch=37.2] | Loss=0.00101 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.601 | L2-Norm(final)=8.467 | 4752.9 samples/s | 74.3 steps/s
[Step=9750 Epoch=37.4] | Loss=0.00097 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.586 | L2-Norm(final)=8.467 | 4728.5 samples/s | 73.9 steps/s
[Step=9800 Epoch=37.6] | Loss=0.00093 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.570 | L2-Norm(final)=8.468 | 6030.2 samples/s | 94.2 steps/s
[Step=9850 Epoch=37.7] | Loss=0.00090 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.555 | L2-Norm(final)=8.468 | 1721.9 samples/s | 26.9 steps/s
[Step=9900 Epoch=37.9] | Loss=0.00087 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.539 | L2-Norm(final)=8.468 | 4766.0 samples/s | 74.5 steps/s
[Step=9950 Epoch=38.1] | Loss=0.00084 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.523 | L2-Norm(final)=8.469 | 4736.8 samples/s | 74.0 steps/s
[Step=10000 Epoch=38.3] | Loss=0.00081 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.507 | L2-Norm(final)=8.469 | 4673.2 samples/s | 73.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07134 | acc=0.9646 | tpr=0.9732 | fpr=0.0540 | 4319.8 samples/s | 16.9 steps/s
Avg test loss: 0.07056, Avg test acc: 0.96298, Avg tpr: 0.97226, Avg fpr: 0.05743, total FA: 448

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06449 | acc=0.9575 | tpr=0.9661 | fpr=0.0612 | 4314.9 samples/s | 16.9 steps/s
Avg test loss: 0.06607, Avg test acc: 0.95649, Avg tpr: 0.96450, Avg fpr: 0.06115, total FA: 477

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.81358 | acc=0.3049 | tpr=0.0041 | fpr=0.0419 | 4102.9 samples/s | 16.0 steps/s
Avg test loss: 5.81034, Avg test acc: 0.30347, Avg tpr: 0.00501, Avg fpr: 0.04012, total FA: 313

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.17722 | acc=0.3116 | tpr=0.0062 | fpr=0.0253 | 4259.4 samples/s | 16.6 steps/s
Avg test loss: 5.17703, Avg test acc: 0.30908, Avg tpr: 0.00635, Avg fpr: 0.02512, total FA: 196

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.05184 | acc=0.1251 | tpr=0.7788 | fpr=0.8867 | 4160.2 samples/s | 16.3 steps/s
[Step= 100] | Loss=5.01786 | acc=0.1288 | tpr=0.7953 | fpr=0.8837 | 8646.1 samples/s | 33.8 steps/s
[Step= 150] | Loss=5.02021 | acc=0.1284 | tpr=0.7896 | fpr=0.8837 | 8601.9 samples/s | 33.6 steps/s
[Step= 200] | Loss=5.00561 | acc=0.1284 | tpr=0.8011 | fpr=0.8838 | 8583.7 samples/s | 33.5 steps/s
[Step= 250] | Loss=5.00009 | acc=0.1284 | tpr=0.7860 | fpr=0.8836 | 7988.6 samples/s | 31.2 steps/s
[Step= 300] | Loss=4.99903 | acc=0.1287 | tpr=0.7876 | fpr=0.8833 | 8725.3 samples/s | 34.1 steps/s
[Step= 350] | Loss=4.99732 | acc=0.1283 | tpr=0.7915 | fpr=0.8837 | 8554.6 samples/s | 33.4 steps/s
[Step= 400] | Loss=4.99072 | acc=0.1284 | tpr=0.7905 | fpr=0.8836 | 8624.7 samples/s | 33.7 steps/s
[Step= 450] | Loss=4.99099 | acc=0.1282 | tpr=0.7989 | fpr=0.8839 | 7938.2 samples/s | 31.0 steps/s
[Step= 500] | Loss=4.99132 | acc=0.1282 | tpr=0.8026 | fpr=0.8840 | 8508.3 samples/s | 33.2 steps/s
[Step= 550] | Loss=4.99310 | acc=0.1283 | tpr=0.8030 | fpr=0.8840 | 15944.7 samples/s | 62.3 steps/s
Avg test loss: 4.99380, Avg test acc: 0.12818, Avg tpr: 0.80309, Avg fpr: 0.88409, total FA: 122754

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.86124 | acc=0.1310 | tpr=0.7920 | fpr=0.8809 | 4179.6 samples/s | 16.3 steps/s
[Step= 100] | Loss=3.83303 | acc=0.1309 | tpr=0.7974 | fpr=0.8815 | 8396.0 samples/s | 32.8 steps/s
[Step= 150] | Loss=3.82966 | acc=0.1305 | tpr=0.7954 | fpr=0.8817 | 8932.9 samples/s | 34.9 steps/s
[Step= 200] | Loss=3.82124 | acc=0.1310 | tpr=0.7978 | fpr=0.8812 | 8619.2 samples/s | 33.7 steps/s
[Step= 250] | Loss=3.81726 | acc=0.1311 | tpr=0.7878 | fpr=0.8809 | 8254.7 samples/s | 32.2 steps/s
[Step= 300] | Loss=3.82334 | acc=0.1317 | tpr=0.7891 | fpr=0.8802 | 8283.6 samples/s | 32.4 steps/s
[Step= 350] | Loss=3.82107 | acc=0.1309 | tpr=0.7884 | fpr=0.8810 | 8078.6 samples/s | 31.6 steps/s
[Step= 400] | Loss=3.81935 | acc=0.1310 | tpr=0.7910 | fpr=0.8810 | 8756.8 samples/s | 34.2 steps/s
[Step= 450] | Loss=3.81811 | acc=0.1308 | tpr=0.7911 | fpr=0.8812 | 8399.7 samples/s | 32.8 steps/s
[Step= 500] | Loss=3.81908 | acc=0.1305 | tpr=0.7890 | fpr=0.8813 | 7986.1 samples/s | 31.2 steps/s
[Step= 550] | Loss=3.81891 | acc=0.1306 | tpr=0.7871 | fpr=0.8813 | 15168.6 samples/s | 59.3 steps/s
Avg test loss: 3.81915, Avg test acc: 0.13062, Avg tpr: 0.78685, Avg fpr: 0.88131, total FA: 122368

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.15611 | acc=0.9798 | tpr=0.9336 | fpr=0.0194 | 4282.6 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.16186 | acc=0.9792 | tpr=0.9510 | fpr=0.0203 | 8677.0 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.16755 | acc=0.9787 | tpr=0.9553 | fpr=0.0209 | 8062.6 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.16863 | acc=0.9791 | tpr=0.9552 | fpr=0.0205 | 8705.1 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.16452 | acc=0.9792 | tpr=0.9572 | fpr=0.0204 | 8600.5 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.16633 | acc=0.9788 | tpr=0.9564 | fpr=0.0208 | 8719.9 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.16677 | acc=0.9786 | tpr=0.9562 | fpr=0.0210 | 7920.7 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.16823 | acc=0.9784 | tpr=0.9530 | fpr=0.0211 | 8694.0 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.17107 | acc=0.9782 | tpr=0.9499 | fpr=0.0213 | 8527.8 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.17069 | acc=0.9781 | tpr=0.9507 | fpr=0.0214 | 8514.8 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.16867 | acc=0.9783 | tpr=0.9507 | fpr=0.0212 | 14925.7 samples/s | 58.3 steps/s
Avg test loss: 0.16820, Avg test acc: 0.97829, Avg tpr: 0.95087, Avg fpr: 0.02121, total FA: 2945

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14025 | acc=0.9820 | tpr=0.9381 | fpr=0.0173 | 4134.7 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.14573 | acc=0.9814 | tpr=0.9531 | fpr=0.0181 | 8456.5 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.15287 | acc=0.9801 | tpr=0.9582 | fpr=0.0195 | 8583.6 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.15349 | acc=0.9802 | tpr=0.9574 | fpr=0.0194 | 8043.4 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.15026 | acc=0.9803 | tpr=0.9546 | fpr=0.0193 | 8163.6 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.15251 | acc=0.9801 | tpr=0.9556 | fpr=0.0194 | 9011.5 samples/s | 35.2 steps/s
[Step= 350] | Loss=0.15472 | acc=0.9797 | tpr=0.9568 | fpr=0.0199 | 7869.1 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.15657 | acc=0.9795 | tpr=0.9540 | fpr=0.0200 | 8105.5 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.15928 | acc=0.9793 | tpr=0.9542 | fpr=0.0203 | 8142.4 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.15866 | acc=0.9794 | tpr=0.9551 | fpr=0.0201 | 8368.4 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.15771 | acc=0.9796 | tpr=0.9522 | fpr=0.0200 | 15650.1 samples/s | 61.1 steps/s
Avg test loss: 0.15741, Avg test acc: 0.97957, Avg tpr: 0.95206, Avg fpr: 0.01993, total FA: 2767

server round 11/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=39.0] | Loss=0.09083 | Reg=0.00212 | acc=0.9062 | L2-Norm=14.571 | L2-Norm(final)=8.484 | 3710.7 samples/s | 58.0 steps/s
[Step=20050 Epoch=39.1] | Loss=0.05952 | Reg=0.00212 | acc=0.9531 | L2-Norm=14.572 | L2-Norm(final)=8.509 | 5022.4 samples/s | 78.5 steps/s
[Step=20100 Epoch=39.2] | Loss=0.05759 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.572 | L2-Norm(final)=8.536 | 5176.9 samples/s | 80.9 steps/s
[Step=20150 Epoch=39.3] | Loss=0.05807 | Reg=0.00212 | acc=0.9062 | L2-Norm=14.572 | L2-Norm(final)=8.563 | 5317.8 samples/s | 83.1 steps/s
[Step=20200 Epoch=39.4] | Loss=0.05881 | Reg=0.00212 | acc=0.9531 | L2-Norm=14.572 | L2-Norm(final)=8.586 | 5507.9 samples/s | 86.1 steps/s
[Step=20250 Epoch=39.5] | Loss=0.05857 | Reg=0.00212 | acc=0.9375 | L2-Norm=14.573 | L2-Norm(final)=8.607 | 5658.4 samples/s | 88.4 steps/s
[Step=20300 Epoch=39.6] | Loss=0.05870 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.573 | L2-Norm(final)=8.627 | 5620.4 samples/s | 87.8 steps/s
[Step=20350 Epoch=39.7] | Loss=0.05864 | Reg=0.00212 | acc=0.8906 | L2-Norm=14.573 | L2-Norm(final)=8.648 | 5567.2 samples/s | 87.0 steps/s
[Step=20400 Epoch=39.8] | Loss=0.05903 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.573 | L2-Norm(final)=8.667 | 5577.0 samples/s | 87.1 steps/s
[Step=20450 Epoch=39.9] | Loss=0.05893 | Reg=0.00212 | acc=0.8750 | L2-Norm=14.573 | L2-Norm(final)=8.686 | 5668.2 samples/s | 88.6 steps/s
[Step=20500 Epoch=40.0] | Loss=0.05873 | Reg=0.00212 | acc=0.9531 | L2-Norm=14.573 | L2-Norm(final)=8.704 | 7310.4 samples/s | 114.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=40.0] | Loss=0.04715 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.573 | L2-Norm(final)=8.888 | 3520.7 samples/s | 55.0 steps/s
[Step=20550 Epoch=40.1] | Loss=0.04903 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.629 | L2-Norm(final)=8.896 | 4540.9 samples/s | 71.0 steps/s
[Step=20600 Epoch=40.2] | Loss=0.04644 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.693 | L2-Norm(final)=8.884 | 4479.5 samples/s | 70.0 steps/s
[Step=20650 Epoch=40.3] | Loss=0.04449 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.737 | L2-Norm(final)=8.877 | 4621.8 samples/s | 72.2 steps/s
[Step=20700 Epoch=40.4] | Loss=0.04160 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.772 | L2-Norm(final)=8.873 | 4716.4 samples/s | 73.7 steps/s
[Step=20750 Epoch=40.5] | Loss=0.03898 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.800 | L2-Norm(final)=8.872 | 4687.6 samples/s | 73.2 steps/s
[Step=20800 Epoch=40.6] | Loss=0.03839 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.825 | L2-Norm(final)=8.870 | 4714.9 samples/s | 73.7 steps/s
[Step=20850 Epoch=40.7] | Loss=0.03684 | Reg=0.00220 | acc=0.9531 | L2-Norm=14.846 | L2-Norm(final)=8.869 | 4710.6 samples/s | 73.6 steps/s
[Step=20900 Epoch=40.8] | Loss=0.03663 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.865 | L2-Norm(final)=8.867 | 4793.4 samples/s | 74.9 steps/s
[Step=20950 Epoch=40.9] | Loss=0.03608 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.883 | L2-Norm(final)=8.864 | 4972.2 samples/s | 77.7 steps/s
[Step=21000 Epoch=41.0] | Loss=0.03541 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.900 | L2-Norm(final)=8.861 | 5737.0 samples/s | 89.6 steps/s
[Step=21050 Epoch=41.1] | Loss=0.03379 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.914 | L2-Norm(final)=8.859 | 1765.2 samples/s | 27.6 steps/s
[Step=21100 Epoch=41.2] | Loss=0.03245 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.927 | L2-Norm(final)=8.858 | 4996.0 samples/s | 78.1 steps/s
[Step=21150 Epoch=41.3] | Loss=0.03141 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.939 | L2-Norm(final)=8.857 | 4903.6 samples/s | 76.6 steps/s
[Step=21200 Epoch=41.3] | Loss=0.03085 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.949 | L2-Norm(final)=8.857 | 4890.3 samples/s | 76.4 steps/s
[Step=21250 Epoch=41.4] | Loss=0.02995 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.959 | L2-Norm(final)=8.857 | 4866.7 samples/s | 76.0 steps/s
[Step=21300 Epoch=41.5] | Loss=0.02927 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.968 | L2-Norm(final)=8.857 | 4900.5 samples/s | 76.6 steps/s
[Step=21350 Epoch=41.6] | Loss=0.02869 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.977 | L2-Norm(final)=8.856 | 4905.9 samples/s | 76.7 steps/s
[Step=21400 Epoch=41.7] | Loss=0.02808 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.985 | L2-Norm(final)=8.856 | 4819.2 samples/s | 75.3 steps/s
[Step=21450 Epoch=41.8] | Loss=0.02762 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.993 | L2-Norm(final)=8.856 | 4684.6 samples/s | 73.2 steps/s
[Step=21500 Epoch=41.9] | Loss=0.02726 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.001 | L2-Norm(final)=8.856 | 4747.4 samples/s | 74.2 steps/s
[Step=21550 Epoch=42.0] | Loss=0.02682 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.009 | L2-Norm(final)=8.856 | 1848.0 samples/s | 28.9 steps/s
[Step=21600 Epoch=42.1] | Loss=0.02632 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.017 | L2-Norm(final)=8.856 | 4864.5 samples/s | 76.0 steps/s
[Step=21650 Epoch=42.2] | Loss=0.02587 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.025 | L2-Norm(final)=8.856 | 4861.4 samples/s | 76.0 steps/s
[Step=21700 Epoch=42.3] | Loss=0.02542 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.032 | L2-Norm(final)=8.856 | 4862.1 samples/s | 76.0 steps/s
[Step=21750 Epoch=42.4] | Loss=0.02498 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.039 | L2-Norm(final)=8.857 | 4850.5 samples/s | 75.8 steps/s
[Step=21800 Epoch=42.5] | Loss=0.02453 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.046 | L2-Norm(final)=8.857 | 4883.2 samples/s | 76.3 steps/s
[Step=21850 Epoch=42.6] | Loss=0.02403 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.052 | L2-Norm(final)=8.858 | 4707.4 samples/s | 73.6 steps/s
[Step=21900 Epoch=42.7] | Loss=0.02361 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.059 | L2-Norm(final)=8.859 | 4584.7 samples/s | 71.6 steps/s
[Step=21950 Epoch=42.8] | Loss=0.02323 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.065 | L2-Norm(final)=8.860 | 4598.5 samples/s | 71.9 steps/s
[Step=22000 Epoch=42.9] | Loss=0.02308 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.072 | L2-Norm(final)=8.861 | 4950.9 samples/s | 77.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step22000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=8001 Epoch=30.8] | Loss=0.01038 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.571 | L2-Norm(final)=8.382 | 3745.2 samples/s | 58.5 steps/s
[Step=8050 Epoch=31.0] | Loss=0.00612 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.567 | L2-Norm(final)=8.405 | 5426.1 samples/s | 84.8 steps/s
[Step=8100 Epoch=31.2] | Loss=0.00599 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.566 | L2-Norm(final)=8.434 | 5176.2 samples/s | 80.9 steps/s
[Step=8150 Epoch=31.4] | Loss=0.00605 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.566 | L2-Norm(final)=8.465 | 5276.9 samples/s | 82.5 steps/s
[Step=8200 Epoch=31.6] | Loss=0.00568 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.566 | L2-Norm(final)=8.496 | 5241.4 samples/s | 81.9 steps/s
[Step=8250 Epoch=31.8] | Loss=0.00561 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.566 | L2-Norm(final)=8.526 | 7071.2 samples/s | 110.5 steps/s
[Step=8300 Epoch=31.9] | Loss=0.00579 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.566 | L2-Norm(final)=8.555 | 1791.8 samples/s | 28.0 steps/s
[Step=8350 Epoch=32.1] | Loss=0.00570 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.566 | L2-Norm(final)=8.582 | 5234.8 samples/s | 81.8 steps/s
[Step=8400 Epoch=32.3] | Loss=0.00557 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.566 | L2-Norm(final)=8.609 | 5261.8 samples/s | 82.2 steps/s
[Step=8450 Epoch=32.5] | Loss=0.00559 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.566 | L2-Norm(final)=8.637 | 5372.1 samples/s | 83.9 steps/s
[Step=8500 Epoch=32.7] | Loss=0.00547 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.566 | L2-Norm(final)=8.664 | 6238.5 samples/s | 97.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=32.7] | Loss=0.00276 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.566 | L2-Norm(final)=8.940 | 3705.7 samples/s | 57.9 steps/s
[Step=8550 Epoch=32.9] | Loss=0.00755 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.616 | L2-Norm(final)=8.948 | 4708.2 samples/s | 73.6 steps/s
[Step=8600 Epoch=33.1] | Loss=0.00501 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.661 | L2-Norm(final)=8.950 | 4674.5 samples/s | 73.0 steps/s
[Step=8650 Epoch=33.3] | Loss=0.00400 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.677 | L2-Norm(final)=8.954 | 4527.2 samples/s | 70.7 steps/s
[Step=8700 Epoch=33.5] | Loss=0.00314 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.684 | L2-Norm(final)=8.957 | 4407.4 samples/s | 68.9 steps/s
[Step=8750 Epoch=33.7] | Loss=0.00254 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.683 | L2-Norm(final)=8.960 | 5412.0 samples/s | 84.6 steps/s
[Step=8800 Epoch=33.9] | Loss=0.00214 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.675 | L2-Norm(final)=8.963 | 1787.3 samples/s | 27.9 steps/s
[Step=8850 Epoch=34.1] | Loss=0.00195 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.666 | L2-Norm(final)=8.965 | 4695.6 samples/s | 73.4 steps/s
[Step=8900 Epoch=34.3] | Loss=0.00171 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.655 | L2-Norm(final)=8.966 | 4657.9 samples/s | 72.8 steps/s
[Step=8950 Epoch=34.5] | Loss=0.00153 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.642 | L2-Norm(final)=8.968 | 4549.6 samples/s | 71.1 steps/s
[Step=9000 Epoch=34.6] | Loss=0.00138 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.629 | L2-Norm(final)=8.969 | 5201.8 samples/s | 81.3 steps/s
[Step=9050 Epoch=34.8] | Loss=0.00125 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.614 | L2-Norm(final)=8.970 | 1774.2 samples/s | 27.7 steps/s
[Step=9100 Epoch=35.0] | Loss=0.00115 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.598 | L2-Norm(final)=8.971 | 4404.4 samples/s | 68.8 steps/s
[Step=9150 Epoch=35.2] | Loss=0.00106 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.582 | L2-Norm(final)=8.972 | 4578.2 samples/s | 71.5 steps/s
[Step=9200 Epoch=35.4] | Loss=0.00098 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.566 | L2-Norm(final)=8.973 | 4549.8 samples/s | 71.1 steps/s
[Step=9250 Epoch=35.6] | Loss=0.00092 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.550 | L2-Norm(final)=8.974 | 4814.0 samples/s | 75.2 steps/s
[Step=9300 Epoch=35.8] | Loss=0.00086 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.533 | L2-Norm(final)=8.975 | 1999.7 samples/s | 31.2 steps/s
[Step=9350 Epoch=36.0] | Loss=0.00081 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.516 | L2-Norm(final)=8.975 | 4727.9 samples/s | 73.9 steps/s
[Step=9400 Epoch=36.2] | Loss=0.00077 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.499 | L2-Norm(final)=8.976 | 4385.9 samples/s | 68.5 steps/s
[Step=9450 Epoch=36.4] | Loss=0.00073 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.482 | L2-Norm(final)=8.977 | 4288.0 samples/s | 67.0 steps/s
[Step=9500 Epoch=36.6] | Loss=0.00069 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.464 | L2-Norm(final)=8.977 | 4513.8 samples/s | 70.5 steps/s
[Step=9550 Epoch=36.8] | Loss=0.00066 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.447 | L2-Norm(final)=8.978 | 2040.7 samples/s | 31.9 steps/s
[Step=9600 Epoch=37.0] | Loss=0.00063 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.430 | L2-Norm(final)=8.978 | 4657.2 samples/s | 72.8 steps/s
[Step=9650 Epoch=37.1] | Loss=0.00060 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.412 | L2-Norm(final)=8.979 | 4691.7 samples/s | 73.3 steps/s
[Step=9700 Epoch=37.3] | Loss=0.00058 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.395 | L2-Norm(final)=8.979 | 4758.5 samples/s | 74.4 steps/s
[Step=9750 Epoch=37.5] | Loss=0.00055 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.378 | L2-Norm(final)=8.980 | 4631.8 samples/s | 72.4 steps/s
[Step=9800 Epoch=37.7] | Loss=0.00053 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.360 | L2-Norm(final)=8.980 | 6633.4 samples/s | 103.6 steps/s
[Step=9850 Epoch=37.9] | Loss=0.00051 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.343 | L2-Norm(final)=8.981 | 1707.4 samples/s | 26.7 steps/s
[Step=9900 Epoch=38.1] | Loss=0.00049 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.325 | L2-Norm(final)=8.981 | 4694.0 samples/s | 73.3 steps/s
[Step=9950 Epoch=38.3] | Loss=0.00048 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.308 | L2-Norm(final)=8.981 | 4712.1 samples/s | 73.6 steps/s
[Step=10000 Epoch=38.5] | Loss=0.00046 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.290 | L2-Norm(final)=8.982 | 4749.4 samples/s | 74.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06896 | acc=0.9617 | tpr=0.9629 | fpr=0.0409 | 4242.1 samples/s | 16.6 steps/s
Avg test loss: 0.06975, Avg test acc: 0.96129, Avg tpr: 0.96311, Avg fpr: 0.04269, total FA: 333

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06449 | acc=0.9575 | tpr=0.9661 | fpr=0.0612 | 4325.1 samples/s | 16.9 steps/s
Avg test loss: 0.06607, Avg test acc: 0.95649, Avg tpr: 0.96450, Avg fpr: 0.06115, total FA: 477

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.81358 | acc=0.3049 | tpr=0.0041 | fpr=0.0419 | 4165.2 samples/s | 16.3 steps/s
Avg test loss: 5.81034, Avg test acc: 0.30347, Avg tpr: 0.00501, Avg fpr: 0.04012, total FA: 313

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.81722 | acc=0.3088 | tpr=0.0146 | fpr=0.0523 | 4325.4 samples/s | 16.9 steps/s
Avg test loss: 5.81820, Avg test acc: 0.30643, Avg tpr: 0.01515, Avg fpr: 0.05294, total FA: 413

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.46151 | acc=0.1393 | tpr=0.6991 | fpr=0.8708 | 4264.1 samples/s | 16.7 steps/s
[Step= 100] | Loss=4.44160 | acc=0.1411 | tpr=0.7164 | fpr=0.8696 | 8597.5 samples/s | 33.6 steps/s
[Step= 150] | Loss=4.44576 | acc=0.1414 | tpr=0.7176 | fpr=0.8692 | 8861.5 samples/s | 34.6 steps/s
[Step= 200] | Loss=4.43566 | acc=0.1416 | tpr=0.7268 | fpr=0.8691 | 8165.7 samples/s | 31.9 steps/s
[Step= 250] | Loss=4.43419 | acc=0.1418 | tpr=0.7162 | fpr=0.8687 | 8013.8 samples/s | 31.3 steps/s
[Step= 300] | Loss=4.43258 | acc=0.1415 | tpr=0.7200 | fpr=0.8691 | 7230.0 samples/s | 28.2 steps/s
[Step= 350] | Loss=4.43223 | acc=0.1402 | tpr=0.7226 | fpr=0.8704 | 5327.8 samples/s | 20.8 steps/s
[Step= 400] | Loss=4.42785 | acc=0.1406 | tpr=0.7276 | fpr=0.8701 | 8173.9 samples/s | 31.9 steps/s
[Step= 450] | Loss=4.42608 | acc=0.1404 | tpr=0.7322 | fpr=0.8704 | 8940.9 samples/s | 34.9 steps/s
[Step= 500] | Loss=4.42582 | acc=0.1405 | tpr=0.7322 | fpr=0.8702 | 8287.2 samples/s | 32.4 steps/s
[Step= 550] | Loss=4.42866 | acc=0.1403 | tpr=0.7262 | fpr=0.8703 | 15038.0 samples/s | 58.7 steps/s
Avg test loss: 4.42950, Avg test acc: 0.14021, Avg tpr: 0.72662, Avg fpr: 0.87045, total FA: 120860

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.86124 | acc=0.1310 | tpr=0.7920 | fpr=0.8809 | 4159.5 samples/s | 16.2 steps/s
[Step= 100] | Loss=3.83303 | acc=0.1309 | tpr=0.7974 | fpr=0.8815 | 8622.1 samples/s | 33.7 steps/s
[Step= 150] | Loss=3.82966 | acc=0.1305 | tpr=0.7954 | fpr=0.8817 | 9122.9 samples/s | 35.6 steps/s
[Step= 200] | Loss=3.82124 | acc=0.1310 | tpr=0.7978 | fpr=0.8812 | 8451.1 samples/s | 33.0 steps/s
[Step= 250] | Loss=3.81726 | acc=0.1311 | tpr=0.7878 | fpr=0.8809 | 7562.0 samples/s | 29.5 steps/s
[Step= 300] | Loss=3.82334 | acc=0.1317 | tpr=0.7891 | fpr=0.8802 | 5376.3 samples/s | 21.0 steps/s
[Step= 350] | Loss=3.82107 | acc=0.1309 | tpr=0.7884 | fpr=0.8810 | 8565.0 samples/s | 33.5 steps/s
[Step= 400] | Loss=3.81935 | acc=0.1310 | tpr=0.7910 | fpr=0.8810 | 8341.2 samples/s | 32.6 steps/s
[Step= 450] | Loss=3.81811 | acc=0.1308 | tpr=0.7911 | fpr=0.8812 | 8064.8 samples/s | 31.5 steps/s
[Step= 500] | Loss=3.81908 | acc=0.1305 | tpr=0.7890 | fpr=0.8813 | 7947.9 samples/s | 31.0 steps/s
[Step= 550] | Loss=3.81891 | acc=0.1306 | tpr=0.7871 | fpr=0.8813 | 15891.9 samples/s | 62.1 steps/s
Avg test loss: 3.81915, Avg test acc: 0.13062, Avg tpr: 0.78685, Avg fpr: 0.88131, total FA: 122368

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.15611 | acc=0.9798 | tpr=0.9336 | fpr=0.0194 | 4155.6 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.16186 | acc=0.9792 | tpr=0.9510 | fpr=0.0203 | 8247.3 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.16755 | acc=0.9787 | tpr=0.9553 | fpr=0.0209 | 8460.7 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.16863 | acc=0.9791 | tpr=0.9552 | fpr=0.0205 | 8575.3 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.16452 | acc=0.9792 | tpr=0.9572 | fpr=0.0204 | 8296.9 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.16633 | acc=0.9788 | tpr=0.9564 | fpr=0.0208 | 5301.8 samples/s | 20.7 steps/s
[Step= 350] | Loss=0.16677 | acc=0.9786 | tpr=0.9562 | fpr=0.0210 | 8765.6 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.16823 | acc=0.9784 | tpr=0.9530 | fpr=0.0211 | 8692.8 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.17107 | acc=0.9782 | tpr=0.9499 | fpr=0.0213 | 8252.0 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.17069 | acc=0.9781 | tpr=0.9507 | fpr=0.0214 | 7233.4 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.16867 | acc=0.9783 | tpr=0.9507 | fpr=0.0212 | 15721.0 samples/s | 61.4 steps/s
Avg test loss: 0.16820, Avg test acc: 0.97829, Avg tpr: 0.95087, Avg fpr: 0.02121, total FA: 2945

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13109 | acc=0.9814 | tpr=0.9381 | fpr=0.0178 | 4342.0 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.13886 | acc=0.9805 | tpr=0.9488 | fpr=0.0189 | 7898.8 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.14305 | acc=0.9800 | tpr=0.9524 | fpr=0.0195 | 8811.1 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.14355 | acc=0.9802 | tpr=0.9563 | fpr=0.0193 | 8938.2 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.13970 | acc=0.9806 | tpr=0.9546 | fpr=0.0189 | 8381.2 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.14125 | acc=0.9803 | tpr=0.9542 | fpr=0.0192 | 5311.2 samples/s | 20.7 steps/s
[Step= 350] | Loss=0.14260 | acc=0.9800 | tpr=0.9543 | fpr=0.0195 | 8738.8 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.14418 | acc=0.9798 | tpr=0.9508 | fpr=0.0197 | 8621.2 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.14755 | acc=0.9796 | tpr=0.9489 | fpr=0.0199 | 7183.0 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.14753 | acc=0.9796 | tpr=0.9493 | fpr=0.0199 | 7986.5 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.14648 | acc=0.9797 | tpr=0.9479 | fpr=0.0197 | 15345.3 samples/s | 59.9 steps/s
Avg test loss: 0.14614, Avg test acc: 0.97971, Avg tpr: 0.94731, Avg fpr: 0.01970, total FA: 2735

server round 12/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=38.3] | Loss=0.00345 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.465 | L2-Norm(final)=8.481 | 3793.3 samples/s | 59.3 steps/s
[Step=10050 Epoch=38.5] | Loss=0.00567 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.459 | L2-Norm(final)=8.518 | 4990.5 samples/s | 78.0 steps/s
[Step=10100 Epoch=38.7] | Loss=0.00489 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.458 | L2-Norm(final)=8.559 | 5201.1 samples/s | 81.3 steps/s
[Step=10150 Epoch=38.9] | Loss=0.00489 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.458 | L2-Norm(final)=8.599 | 5259.8 samples/s | 82.2 steps/s
[Step=10200 Epoch=39.1] | Loss=0.00474 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.458 | L2-Norm(final)=8.636 | 5227.7 samples/s | 81.7 steps/s
[Step=10250 Epoch=39.3] | Loss=0.00485 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.458 | L2-Norm(final)=8.671 | 6670.0 samples/s | 104.2 steps/s
[Step=10300 Epoch=39.5] | Loss=0.00488 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.458 | L2-Norm(final)=8.704 | 1829.5 samples/s | 28.6 steps/s
[Step=10350 Epoch=39.7] | Loss=0.00470 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.458 | L2-Norm(final)=8.735 | 5178.2 samples/s | 80.9 steps/s
[Step=10400 Epoch=39.8] | Loss=0.00466 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.458 | L2-Norm(final)=8.765 | 5132.5 samples/s | 80.2 steps/s
[Step=10450 Epoch=40.0] | Loss=0.00476 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.458 | L2-Norm(final)=8.795 | 5371.1 samples/s | 83.9 steps/s
[Step=10500 Epoch=40.2] | Loss=0.00479 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.458 | L2-Norm(final)=8.826 | 5947.0 samples/s | 92.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=40.2] | Loss=0.00348 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.458 | L2-Norm(final)=9.133 | 4256.9 samples/s | 66.5 steps/s
[Step=10550 Epoch=40.4] | Loss=0.00527 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.499 | L2-Norm(final)=9.149 | 4026.0 samples/s | 62.9 steps/s
[Step=10600 Epoch=40.6] | Loss=0.00574 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.587 | L2-Norm(final)=9.139 | 4513.5 samples/s | 70.5 steps/s
[Step=10650 Epoch=40.8] | Loss=0.00448 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.639 | L2-Norm(final)=9.132 | 4359.0 samples/s | 68.1 steps/s
[Step=10700 Epoch=41.0] | Loss=0.00359 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.664 | L2-Norm(final)=9.130 | 4315.5 samples/s | 67.4 steps/s
[Step=10750 Epoch=41.2] | Loss=0.00302 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.674 | L2-Norm(final)=9.129 | 5978.0 samples/s | 93.4 steps/s
[Step=10800 Epoch=41.4] | Loss=0.00254 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.677 | L2-Norm(final)=9.129 | 1863.7 samples/s | 29.1 steps/s
[Step=10850 Epoch=41.6] | Loss=0.00228 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.676 | L2-Norm(final)=9.130 | 4690.8 samples/s | 73.3 steps/s
[Step=10900 Epoch=41.8] | Loss=0.00202 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.671 | L2-Norm(final)=9.131 | 4730.7 samples/s | 73.9 steps/s
[Step=10950 Epoch=42.0] | Loss=0.00181 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.664 | L2-Norm(final)=9.132 | 4696.8 samples/s | 73.4 steps/s
[Step=11000 Epoch=42.1] | Loss=0.00163 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.655 | L2-Norm(final)=9.134 | 5202.5 samples/s | 81.3 steps/s
[Step=11050 Epoch=42.3] | Loss=0.00149 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.644 | L2-Norm(final)=9.135 | 1816.7 samples/s | 28.4 steps/s
[Step=11100 Epoch=42.5] | Loss=0.00137 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.632 | L2-Norm(final)=9.137 | 4407.9 samples/s | 68.9 steps/s
[Step=11150 Epoch=42.7] | Loss=0.00126 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.619 | L2-Norm(final)=9.138 | 4462.2 samples/s | 69.7 steps/s
[Step=11200 Epoch=42.9] | Loss=0.00117 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.605 | L2-Norm(final)=9.139 | 4628.6 samples/s | 72.3 steps/s
[Step=11250 Epoch=43.1] | Loss=0.00109 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.591 | L2-Norm(final)=9.140 | 4557.4 samples/s | 71.2 steps/s
[Step=11300 Epoch=43.3] | Loss=0.00103 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.576 | L2-Norm(final)=9.141 | 1974.0 samples/s | 30.8 steps/s
[Step=11350 Epoch=43.5] | Loss=0.00097 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.561 | L2-Norm(final)=9.141 | 4657.0 samples/s | 72.8 steps/s
[Step=11400 Epoch=43.7] | Loss=0.00091 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.545 | L2-Norm(final)=9.142 | 4421.0 samples/s | 69.1 steps/s
[Step=11450 Epoch=43.9] | Loss=0.00086 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.529 | L2-Norm(final)=9.143 | 4310.1 samples/s | 67.3 steps/s
[Step=11500 Epoch=44.1] | Loss=0.00082 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.514 | L2-Norm(final)=9.143 | 4463.7 samples/s | 69.7 steps/s
[Step=11550 Epoch=44.3] | Loss=0.00078 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.498 | L2-Norm(final)=9.144 | 1943.7 samples/s | 30.4 steps/s
[Step=11600 Epoch=44.4] | Loss=0.00075 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.481 | L2-Norm(final)=9.145 | 4492.0 samples/s | 70.2 steps/s
[Step=11650 Epoch=44.6] | Loss=0.00071 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.465 | L2-Norm(final)=9.145 | 4745.9 samples/s | 74.2 steps/s
[Step=11700 Epoch=44.8] | Loss=0.00068 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.449 | L2-Norm(final)=9.146 | 4791.5 samples/s | 74.9 steps/s
[Step=11750 Epoch=45.0] | Loss=0.00066 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.432 | L2-Norm(final)=9.146 | 4544.7 samples/s | 71.0 steps/s
[Step=11800 Epoch=45.2] | Loss=0.00063 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.416 | L2-Norm(final)=9.146 | 6031.3 samples/s | 94.2 steps/s
[Step=11850 Epoch=45.4] | Loss=0.00061 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.399 | L2-Norm(final)=9.147 | 1733.5 samples/s | 27.1 steps/s
[Step=11900 Epoch=45.6] | Loss=0.00059 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.382 | L2-Norm(final)=9.147 | 4837.2 samples/s | 75.6 steps/s
[Step=11950 Epoch=45.8] | Loss=0.00057 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.366 | L2-Norm(final)=9.148 | 4605.8 samples/s | 72.0 steps/s
[Step=12000 Epoch=46.0] | Loss=0.00055 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.349 | L2-Norm(final)=9.148 | 4647.8 samples/s | 72.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step12000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=38.5] | Loss=0.00098 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.465 | L2-Norm(final)=8.994 | 3804.3 samples/s | 59.4 steps/s
[Step=10050 Epoch=38.7] | Loss=0.00412 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.459 | L2-Norm(final)=9.034 | 5155.8 samples/s | 80.6 steps/s
[Step=10100 Epoch=38.9] | Loss=0.00376 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.458 | L2-Norm(final)=9.083 | 5087.2 samples/s | 79.5 steps/s
[Step=10150 Epoch=39.1] | Loss=0.00424 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.458 | L2-Norm(final)=9.128 | 5050.3 samples/s | 78.9 steps/s
[Step=10200 Epoch=39.3] | Loss=0.00435 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.458 | L2-Norm(final)=9.170 | 4885.5 samples/s | 76.3 steps/s
[Step=10250 Epoch=39.5] | Loss=0.00458 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.458 | L2-Norm(final)=9.209 | 6945.1 samples/s | 108.5 steps/s
[Step=10300 Epoch=39.6] | Loss=0.00468 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.458 | L2-Norm(final)=9.248 | 1925.6 samples/s | 30.1 steps/s
[Step=10350 Epoch=39.8] | Loss=0.00457 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.458 | L2-Norm(final)=9.285 | 5342.6 samples/s | 83.5 steps/s
[Step=10400 Epoch=40.0] | Loss=0.00460 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.458 | L2-Norm(final)=9.320 | 5400.6 samples/s | 84.4 steps/s
[Step=10450 Epoch=40.2] | Loss=0.00464 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.458 | L2-Norm(final)=9.354 | 5128.9 samples/s | 80.1 steps/s
[Step=10500 Epoch=40.4] | Loss=0.00452 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.458 | L2-Norm(final)=9.386 | 6147.8 samples/s | 96.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=40.4] | Loss=0.00116 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.457 | L2-Norm(final)=9.702 | 3739.8 samples/s | 58.4 steps/s
[Step=10550 Epoch=40.6] | Loss=0.00841 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.562 | L2-Norm(final)=9.709 | 4039.3 samples/s | 63.1 steps/s
[Step=10600 Epoch=40.8] | Loss=0.01030 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.679 | L2-Norm(final)=9.688 | 4425.3 samples/s | 69.1 steps/s
[Step=10650 Epoch=41.0] | Loss=0.00946 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.772 | L2-Norm(final)=9.663 | 4562.3 samples/s | 71.3 steps/s
[Step=10700 Epoch=41.2] | Loss=0.00789 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.830 | L2-Norm(final)=9.649 | 4607.5 samples/s | 72.0 steps/s
[Step=10750 Epoch=41.4] | Loss=0.00669 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.866 | L2-Norm(final)=9.641 | 5865.6 samples/s | 91.7 steps/s
[Step=10800 Epoch=41.6] | Loss=0.00559 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.888 | L2-Norm(final)=9.637 | 1843.4 samples/s | 28.8 steps/s
[Step=10850 Epoch=41.8] | Loss=0.00480 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.899 | L2-Norm(final)=9.634 | 4672.3 samples/s | 73.0 steps/s
[Step=10900 Epoch=42.0] | Loss=0.00420 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.903 | L2-Norm(final)=9.632 | 4453.3 samples/s | 69.6 steps/s
[Step=10950 Epoch=42.2] | Loss=0.00374 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.902 | L2-Norm(final)=9.631 | 4271.2 samples/s | 66.7 steps/s
[Step=11000 Epoch=42.3] | Loss=0.00337 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.899 | L2-Norm(final)=9.630 | 4950.6 samples/s | 77.4 steps/s
[Step=11050 Epoch=42.5] | Loss=0.00307 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.893 | L2-Norm(final)=9.630 | 1920.3 samples/s | 30.0 steps/s
[Step=11100 Epoch=42.7] | Loss=0.00281 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.886 | L2-Norm(final)=9.629 | 4672.1 samples/s | 73.0 steps/s
[Step=11150 Epoch=42.9] | Loss=0.00260 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.878 | L2-Norm(final)=9.629 | 4732.8 samples/s | 73.9 steps/s
[Step=11200 Epoch=43.1] | Loss=0.00241 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.869 | L2-Norm(final)=9.629 | 4599.9 samples/s | 71.9 steps/s
[Step=11250 Epoch=43.3] | Loss=0.00225 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.859 | L2-Norm(final)=9.629 | 4716.7 samples/s | 73.7 steps/s
[Step=11300 Epoch=43.5] | Loss=0.00211 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.848 | L2-Norm(final)=9.629 | 1892.9 samples/s | 29.6 steps/s
[Step=11350 Epoch=43.7] | Loss=0.00199 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.837 | L2-Norm(final)=9.629 | 4578.7 samples/s | 71.5 steps/s
[Step=11400 Epoch=43.9] | Loss=0.00188 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.826 | L2-Norm(final)=9.629 | 4765.8 samples/s | 74.5 steps/s
[Step=11450 Epoch=44.1] | Loss=0.00178 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.814 | L2-Norm(final)=9.629 | 4713.4 samples/s | 73.6 steps/s
[Step=11500 Epoch=44.3] | Loss=0.00169 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.802 | L2-Norm(final)=9.629 | 4655.0 samples/s | 72.7 steps/s
[Step=11550 Epoch=44.5] | Loss=0.00161 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.790 | L2-Norm(final)=9.629 | 1981.0 samples/s | 31.0 steps/s
[Step=11600 Epoch=44.7] | Loss=0.00154 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.777 | L2-Norm(final)=9.629 | 4665.9 samples/s | 72.9 steps/s
[Step=11650 Epoch=44.8] | Loss=0.00147 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.764 | L2-Norm(final)=9.629 | 4418.1 samples/s | 69.0 steps/s
[Step=11700 Epoch=45.0] | Loss=0.00141 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.752 | L2-Norm(final)=9.629 | 4299.6 samples/s | 67.2 steps/s
[Step=11750 Epoch=45.2] | Loss=0.00135 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.739 | L2-Norm(final)=9.629 | 4427.3 samples/s | 69.2 steps/s
[Step=11800 Epoch=45.4] | Loss=0.00130 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.726 | L2-Norm(final)=9.629 | 6982.4 samples/s | 109.1 steps/s
[Step=11850 Epoch=45.6] | Loss=0.00125 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.713 | L2-Norm(final)=9.630 | 1767.1 samples/s | 27.6 steps/s
[Step=11900 Epoch=45.8] | Loss=0.00121 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.699 | L2-Norm(final)=9.630 | 4599.8 samples/s | 71.9 steps/s
[Step=11950 Epoch=46.0] | Loss=0.00117 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.686 | L2-Norm(final)=9.630 | 4609.8 samples/s | 72.0 steps/s
[Step=12000 Epoch=46.2] | Loss=0.00113 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.673 | L2-Norm(final)=9.630 | 4700.7 samples/s | 73.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06896 | acc=0.9617 | tpr=0.9629 | fpr=0.0409 | 3109.8 samples/s | 12.1 steps/s
Avg test loss: 0.06975, Avg test acc: 0.96129, Avg tpr: 0.96311, Avg fpr: 0.04269, total FA: 333

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06449 | acc=0.9575 | tpr=0.9661 | fpr=0.0612 | 4206.6 samples/s | 16.4 steps/s
Avg test loss: 0.06607, Avg test acc: 0.95649, Avg tpr: 0.96450, Avg fpr: 0.06115, total FA: 477

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.56024 | acc=0.3066 | tpr=0.0049 | fpr=0.0384 | 4341.6 samples/s | 17.0 steps/s
Avg test loss: 6.56284, Avg test acc: 0.30427, Avg tpr: 0.00484, Avg fpr: 0.03717, total FA: 290

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.52352 | acc=0.3116 | tpr=0.0146 | fpr=0.0434 | 4166.7 samples/s | 16.3 steps/s
Avg test loss: 6.52731, Avg test acc: 0.30928, Avg tpr: 0.01597, Avg fpr: 0.04564, total FA: 356

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.46151 | acc=0.1393 | tpr=0.6991 | fpr=0.8708 | 4410.8 samples/s | 17.2 steps/s
[Step= 100] | Loss=4.44160 | acc=0.1411 | tpr=0.7164 | fpr=0.8696 | 7775.8 samples/s | 30.4 steps/s
[Step= 150] | Loss=4.44576 | acc=0.1414 | tpr=0.7176 | fpr=0.8692 | 8503.2 samples/s | 33.2 steps/s
[Step= 200] | Loss=4.43566 | acc=0.1416 | tpr=0.7268 | fpr=0.8691 | 8592.9 samples/s | 33.6 steps/s
[Step= 250] | Loss=4.43419 | acc=0.1418 | tpr=0.7162 | fpr=0.8687 | 8878.2 samples/s | 34.7 steps/s
[Step= 300] | Loss=4.43258 | acc=0.1415 | tpr=0.7200 | fpr=0.8691 | 8855.7 samples/s | 34.6 steps/s
[Step= 350] | Loss=4.43223 | acc=0.1402 | tpr=0.7226 | fpr=0.8704 | 7841.0 samples/s | 30.6 steps/s
[Step= 400] | Loss=4.42785 | acc=0.1406 | tpr=0.7276 | fpr=0.8701 | 9032.3 samples/s | 35.3 steps/s
[Step= 450] | Loss=4.42608 | acc=0.1404 | tpr=0.7322 | fpr=0.8704 | 8279.4 samples/s | 32.3 steps/s
[Step= 500] | Loss=4.42582 | acc=0.1405 | tpr=0.7322 | fpr=0.8702 | 8742.1 samples/s | 34.1 steps/s
[Step= 550] | Loss=4.42866 | acc=0.1403 | tpr=0.7262 | fpr=0.8703 | 13663.4 samples/s | 53.4 steps/s
Avg test loss: 4.42950, Avg test acc: 0.14021, Avg tpr: 0.72662, Avg fpr: 0.87045, total FA: 120860

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.86124 | acc=0.1310 | tpr=0.7920 | fpr=0.8809 | 4301.6 samples/s | 16.8 steps/s
[Step= 100] | Loss=3.83303 | acc=0.1309 | tpr=0.7974 | fpr=0.8815 | 8825.7 samples/s | 34.5 steps/s
[Step= 150] | Loss=3.82966 | acc=0.1305 | tpr=0.7954 | fpr=0.8817 | 8019.9 samples/s | 31.3 steps/s
[Step= 200] | Loss=3.82124 | acc=0.1310 | tpr=0.7978 | fpr=0.8812 | 8400.5 samples/s | 32.8 steps/s
[Step= 250] | Loss=3.81726 | acc=0.1311 | tpr=0.7878 | fpr=0.8809 | 8701.6 samples/s | 34.0 steps/s
[Step= 300] | Loss=3.82334 | acc=0.1317 | tpr=0.7891 | fpr=0.8802 | 8578.7 samples/s | 33.5 steps/s
[Step= 350] | Loss=3.82107 | acc=0.1309 | tpr=0.7884 | fpr=0.8810 | 8624.4 samples/s | 33.7 steps/s
[Step= 400] | Loss=3.81935 | acc=0.1310 | tpr=0.7910 | fpr=0.8810 | 7850.6 samples/s | 30.7 steps/s
[Step= 450] | Loss=3.81811 | acc=0.1308 | tpr=0.7911 | fpr=0.8812 | 8167.7 samples/s | 31.9 steps/s
[Step= 500] | Loss=3.81908 | acc=0.1305 | tpr=0.7890 | fpr=0.8813 | 8403.4 samples/s | 32.8 steps/s
[Step= 550] | Loss=3.81891 | acc=0.1306 | tpr=0.7871 | fpr=0.8813 | 16114.0 samples/s | 62.9 steps/s
Avg test loss: 3.81915, Avg test acc: 0.13062, Avg tpr: 0.78685, Avg fpr: 0.88131, total FA: 122368

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.15297 | acc=0.9827 | tpr=0.9292 | fpr=0.0164 | 4060.0 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.16097 | acc=0.9817 | tpr=0.9403 | fpr=0.0175 | 8261.7 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.16768 | acc=0.9810 | tpr=0.9438 | fpr=0.0183 | 8467.1 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.16906 | acc=0.9814 | tpr=0.9486 | fpr=0.0180 | 8266.4 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.16542 | acc=0.9818 | tpr=0.9502 | fpr=0.0176 | 8326.7 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.16676 | acc=0.9817 | tpr=0.9484 | fpr=0.0177 | 8812.0 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.16766 | acc=0.9814 | tpr=0.9480 | fpr=0.0180 | 8861.9 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.16954 | acc=0.9812 | tpr=0.9447 | fpr=0.0181 | 8396.6 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.17368 | acc=0.9810 | tpr=0.9411 | fpr=0.0183 | 7868.0 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.17297 | acc=0.9810 | tpr=0.9427 | fpr=0.0183 | 8416.0 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.17156 | acc=0.9811 | tpr=0.9403 | fpr=0.0181 | 14319.9 samples/s | 55.9 steps/s
Avg test loss: 0.17107, Avg test acc: 0.98116, Avg tpr: 0.93978, Avg fpr: 0.01808, total FA: 2511

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16509 | acc=0.9809 | tpr=0.9204 | fpr=0.0181 | 4215.4 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.17163 | acc=0.9797 | tpr=0.9424 | fpr=0.0196 | 8395.8 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.17761 | acc=0.9791 | tpr=0.9424 | fpr=0.0202 | 8611.7 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.17885 | acc=0.9794 | tpr=0.9443 | fpr=0.0200 | 8748.6 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.17498 | acc=0.9798 | tpr=0.9467 | fpr=0.0196 | 8360.4 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.17674 | acc=0.9795 | tpr=0.9462 | fpr=0.0199 | 8308.7 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.17867 | acc=0.9792 | tpr=0.9474 | fpr=0.0202 | 8321.3 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.17980 | acc=0.9791 | tpr=0.9447 | fpr=0.0203 | 9236.5 samples/s | 36.1 steps/s
[Step= 450] | Loss=0.18309 | acc=0.9790 | tpr=0.9450 | fpr=0.0204 | 8440.5 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.18248 | acc=0.9789 | tpr=0.9445 | fpr=0.0204 | 7837.7 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.18121 | acc=0.9791 | tpr=0.9423 | fpr=0.0203 | 15715.9 samples/s | 61.4 steps/s
Avg test loss: 0.18077, Avg test acc: 0.97908, Avg tpr: 0.94255, Avg fpr: 0.02026, total FA: 2813

server round 13/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=42.9] | Loss=0.04800 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.516 | L2-Norm(final)=8.889 | 3617.9 samples/s | 56.5 steps/s
[Step=22050 Epoch=43.0] | Loss=0.03809 | Reg=0.00211 | acc=0.9062 | L2-Norm=14.519 | L2-Norm(final)=8.890 | 5631.0 samples/s | 88.0 steps/s
[Step=22100 Epoch=43.1] | Loss=0.03797 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.519 | L2-Norm(final)=8.889 | 5768.9 samples/s | 90.1 steps/s
[Step=22150 Epoch=43.2] | Loss=0.03724 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.519 | L2-Norm(final)=8.889 | 5531.5 samples/s | 86.4 steps/s
[Step=22200 Epoch=43.3] | Loss=0.03831 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.519 | L2-Norm(final)=8.889 | 5715.2 samples/s | 89.3 steps/s
[Step=22250 Epoch=43.4] | Loss=0.03797 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.519 | L2-Norm(final)=8.888 | 5686.1 samples/s | 88.8 steps/s
[Step=22300 Epoch=43.5] | Loss=0.03817 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.519 | L2-Norm(final)=8.890 | 5581.6 samples/s | 87.2 steps/s
[Step=22350 Epoch=43.6] | Loss=0.03832 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.519 | L2-Norm(final)=8.890 | 5399.2 samples/s | 84.4 steps/s
[Step=22400 Epoch=43.7] | Loss=0.03853 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.519 | L2-Norm(final)=8.891 | 5191.7 samples/s | 81.1 steps/s
[Step=22450 Epoch=43.8] | Loss=0.03844 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.519 | L2-Norm(final)=8.892 | 5335.0 samples/s | 83.4 steps/s
[Step=22500 Epoch=43.9] | Loss=0.03844 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.519 | L2-Norm(final)=8.895 | 7318.9 samples/s | 114.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=43.9] | Loss=0.03780 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.520 | L2-Norm(final)=8.924 | 3491.0 samples/s | 54.5 steps/s
[Step=22550 Epoch=44.0] | Loss=0.03820 | Reg=0.00212 | acc=0.9531 | L2-Norm=14.575 | L2-Norm(final)=8.924 | 4754.9 samples/s | 74.3 steps/s
[Step=22600 Epoch=44.1] | Loss=0.03698 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.632 | L2-Norm(final)=8.915 | 4885.9 samples/s | 76.3 steps/s
[Step=22650 Epoch=44.2] | Loss=0.03524 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.668 | L2-Norm(final)=8.910 | 4868.7 samples/s | 76.1 steps/s
[Step=22700 Epoch=44.3] | Loss=0.03366 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.697 | L2-Norm(final)=8.907 | 4790.2 samples/s | 74.8 steps/s
[Step=22750 Epoch=44.4] | Loss=0.03237 | Reg=0.00217 | acc=0.9375 | L2-Norm=14.721 | L2-Norm(final)=8.904 | 4741.1 samples/s | 74.1 steps/s
[Step=22800 Epoch=44.5] | Loss=0.03222 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.742 | L2-Norm(final)=8.902 | 4618.7 samples/s | 72.2 steps/s
[Step=22850 Epoch=44.6] | Loss=0.03193 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.763 | L2-Norm(final)=8.898 | 4485.3 samples/s | 70.1 steps/s
[Step=22900 Epoch=44.7] | Loss=0.03179 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.783 | L2-Norm(final)=8.895 | 4821.8 samples/s | 75.3 steps/s
[Step=22950 Epoch=44.8] | Loss=0.03125 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.801 | L2-Norm(final)=8.892 | 4821.4 samples/s | 75.3 steps/s
[Step=23000 Epoch=44.9] | Loss=0.03057 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.818 | L2-Norm(final)=8.890 | 5901.6 samples/s | 92.2 steps/s
[Step=23050 Epoch=45.0] | Loss=0.02930 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.834 | L2-Norm(final)=8.889 | 1872.3 samples/s | 29.3 steps/s
[Step=23100 Epoch=45.1] | Loss=0.02812 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.848 | L2-Norm(final)=8.889 | 4924.1 samples/s | 76.9 steps/s
[Step=23150 Epoch=45.2] | Loss=0.02741 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.862 | L2-Norm(final)=8.889 | 4837.8 samples/s | 75.6 steps/s
[Step=23200 Epoch=45.2] | Loss=0.02661 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.875 | L2-Norm(final)=8.889 | 4591.0 samples/s | 71.7 steps/s
[Step=23250 Epoch=45.3] | Loss=0.02617 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.886 | L2-Norm(final)=8.890 | 4529.1 samples/s | 70.8 steps/s
[Step=23300 Epoch=45.4] | Loss=0.02572 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.898 | L2-Norm(final)=8.890 | 4569.9 samples/s | 71.4 steps/s
[Step=23350 Epoch=45.5] | Loss=0.02544 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.908 | L2-Norm(final)=8.890 | 4590.1 samples/s | 71.7 steps/s
[Step=23400 Epoch=45.6] | Loss=0.02501 | Reg=0.00223 | acc=0.9531 | L2-Norm=14.919 | L2-Norm(final)=8.890 | 4702.9 samples/s | 73.5 steps/s
[Step=23450 Epoch=45.7] | Loss=0.02457 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.929 | L2-Norm(final)=8.890 | 4831.4 samples/s | 75.5 steps/s
[Step=23500 Epoch=45.8] | Loss=0.02418 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.940 | L2-Norm(final)=8.890 | 5277.6 samples/s | 82.5 steps/s
[Step=23550 Epoch=45.9] | Loss=0.02393 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.950 | L2-Norm(final)=8.890 | 1949.9 samples/s | 30.5 steps/s
[Step=23600 Epoch=46.0] | Loss=0.02343 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.960 | L2-Norm(final)=8.890 | 4812.9 samples/s | 75.2 steps/s
[Step=23650 Epoch=46.1] | Loss=0.02297 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.970 | L2-Norm(final)=8.890 | 4596.6 samples/s | 71.8 steps/s
[Step=23700 Epoch=46.2] | Loss=0.02247 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.979 | L2-Norm(final)=8.890 | 4506.9 samples/s | 70.4 steps/s
[Step=23750 Epoch=46.3] | Loss=0.02219 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.987 | L2-Norm(final)=8.890 | 4787.1 samples/s | 74.8 steps/s
[Step=23800 Epoch=46.4] | Loss=0.02202 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.996 | L2-Norm(final)=8.890 | 4900.0 samples/s | 76.6 steps/s
[Step=23850 Epoch=46.5] | Loss=0.02167 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.004 | L2-Norm(final)=8.890 | 4886.4 samples/s | 76.3 steps/s
[Step=23900 Epoch=46.6] | Loss=0.02154 | Reg=0.00225 | acc=0.9688 | L2-Norm=15.013 | L2-Norm(final)=8.890 | 4910.4 samples/s | 76.7 steps/s
[Step=23950 Epoch=46.7] | Loss=0.02132 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.021 | L2-Norm(final)=8.890 | 4880.5 samples/s | 76.3 steps/s
[Step=24000 Epoch=46.8] | Loss=0.02109 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.029 | L2-Norm(final)=8.890 | 4875.1 samples/s | 76.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step24000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=6001 Epoch=11.7] | Loss=0.04313 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.516 | L2-Norm(final)=4.792 | 3833.5 samples/s | 59.9 steps/s
[Step=6050 Epoch=11.8] | Loss=0.07094 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.521 | L2-Norm(final)=4.818 | 5194.4 samples/s | 81.2 steps/s
[Step=6100 Epoch=11.9] | Loss=0.06283 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.521 | L2-Norm(final)=4.861 | 5104.6 samples/s | 79.8 steps/s
[Step=6150 Epoch=12.0] | Loss=0.05776 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.521 | L2-Norm(final)=4.906 | 5338.4 samples/s | 83.4 steps/s
[Step=6200 Epoch=12.1] | Loss=0.05578 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.522 | L2-Norm(final)=4.951 | 5519.3 samples/s | 86.2 steps/s
[Step=6250 Epoch=12.2] | Loss=0.05430 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.522 | L2-Norm(final)=4.995 | 5728.1 samples/s | 89.5 steps/s
[Step=6300 Epoch=12.3] | Loss=0.05265 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.522 | L2-Norm(final)=5.038 | 5707.7 samples/s | 89.2 steps/s
[Step=6350 Epoch=12.4] | Loss=0.05234 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.522 | L2-Norm(final)=5.079 | 5790.9 samples/s | 90.5 steps/s
[Step=6400 Epoch=12.5] | Loss=0.05201 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.522 | L2-Norm(final)=5.118 | 5722.4 samples/s | 89.4 steps/s
[Step=6450 Epoch=12.6] | Loss=0.05144 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.522 | L2-Norm(final)=5.156 | 5662.4 samples/s | 88.5 steps/s
[Step=6500 Epoch=12.7] | Loss=0.05088 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.522 | L2-Norm(final)=5.192 | 7380.2 samples/s | 115.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=6501 Epoch=12.7] | Loss=0.06794 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.522 | L2-Norm(final)=5.547 | 3782.8 samples/s | 59.1 steps/s
[Step=6550 Epoch=12.8] | Loss=0.03303 | Reg=0.00212 | acc=0.9531 | L2-Norm=14.576 | L2-Norm(final)=5.565 | 4533.3 samples/s | 70.8 steps/s
[Step=6600 Epoch=12.9] | Loss=0.03135 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.623 | L2-Norm(final)=5.565 | 4501.9 samples/s | 70.3 steps/s
[Step=6650 Epoch=13.0] | Loss=0.03262 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.655 | L2-Norm(final)=5.564 | 4600.7 samples/s | 71.9 steps/s
[Step=6700 Epoch=13.1] | Loss=0.03175 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.682 | L2-Norm(final)=5.564 | 4736.3 samples/s | 74.0 steps/s
[Step=6750 Epoch=13.2] | Loss=0.03055 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.706 | L2-Norm(final)=5.564 | 4804.1 samples/s | 75.1 steps/s
[Step=6800 Epoch=13.3] | Loss=0.02883 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.726 | L2-Norm(final)=5.566 | 4725.9 samples/s | 73.8 steps/s
[Step=6850 Epoch=13.4] | Loss=0.02802 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.743 | L2-Norm(final)=5.566 | 4826.3 samples/s | 75.4 steps/s
[Step=6900 Epoch=13.5] | Loss=0.02784 | Reg=0.00218 | acc=0.9531 | L2-Norm=14.760 | L2-Norm(final)=5.567 | 4895.9 samples/s | 76.5 steps/s
[Step=6950 Epoch=13.6] | Loss=0.02708 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.775 | L2-Norm(final)=5.568 | 4976.6 samples/s | 77.8 steps/s
[Step=7000 Epoch=13.7] | Loss=0.02688 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.790 | L2-Norm(final)=5.570 | 6119.8 samples/s | 95.6 steps/s
[Step=7050 Epoch=13.8] | Loss=0.02603 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.803 | L2-Norm(final)=5.571 | 1770.9 samples/s | 27.7 steps/s
[Step=7100 Epoch=13.9] | Loss=0.02509 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.816 | L2-Norm(final)=5.573 | 4899.8 samples/s | 76.6 steps/s
[Step=7150 Epoch=14.0] | Loss=0.02440 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.827 | L2-Norm(final)=5.575 | 4903.9 samples/s | 76.6 steps/s
[Step=7200 Epoch=14.1] | Loss=0.02378 | Reg=0.00220 | acc=0.9219 | L2-Norm=14.838 | L2-Norm(final)=5.576 | 4848.3 samples/s | 75.8 steps/s
[Step=7250 Epoch=14.2] | Loss=0.02335 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.848 | L2-Norm(final)=5.578 | 4890.2 samples/s | 76.4 steps/s
[Step=7300 Epoch=14.3] | Loss=0.02272 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.858 | L2-Norm(final)=5.580 | 4963.9 samples/s | 77.6 steps/s
[Step=7350 Epoch=14.4] | Loss=0.02257 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.867 | L2-Norm(final)=5.582 | 4868.8 samples/s | 76.1 steps/s
[Step=7400 Epoch=14.5] | Loss=0.02226 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.876 | L2-Norm(final)=5.583 | 4846.9 samples/s | 75.7 steps/s
[Step=7450 Epoch=14.6] | Loss=0.02226 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.885 | L2-Norm(final)=5.584 | 4709.6 samples/s | 73.6 steps/s
[Step=7500 Epoch=14.7] | Loss=0.02210 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.894 | L2-Norm(final)=5.586 | 5038.0 samples/s | 78.7 steps/s
[Step=7550 Epoch=14.8] | Loss=0.02170 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.904 | L2-Norm(final)=5.587 | 1902.7 samples/s | 29.7 steps/s
[Step=7600 Epoch=14.9] | Loss=0.02131 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.913 | L2-Norm(final)=5.589 | 5050.6 samples/s | 78.9 steps/s
[Step=7650 Epoch=15.0] | Loss=0.02094 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.921 | L2-Norm(final)=5.591 | 4951.3 samples/s | 77.4 steps/s
[Step=7700 Epoch=15.1] | Loss=0.02061 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.929 | L2-Norm(final)=5.592 | 4905.8 samples/s | 76.7 steps/s
[Step=7750 Epoch=15.2] | Loss=0.02023 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.937 | L2-Norm(final)=5.594 | 4953.7 samples/s | 77.4 steps/s
[Step=7800 Epoch=15.2] | Loss=0.01993 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.945 | L2-Norm(final)=5.596 | 4957.8 samples/s | 77.5 steps/s
[Step=7850 Epoch=15.3] | Loss=0.01977 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.953 | L2-Norm(final)=5.598 | 4862.1 samples/s | 76.0 steps/s
[Step=7900 Epoch=15.4] | Loss=0.01954 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.960 | L2-Norm(final)=5.599 | 4671.9 samples/s | 73.0 steps/s
[Step=7950 Epoch=15.5] | Loss=0.01934 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.967 | L2-Norm(final)=5.601 | 4479.7 samples/s | 70.0 steps/s
[Step=8000 Epoch=15.6] | Loss=0.01928 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.974 | L2-Norm(final)=5.602 | 4647.2 samples/s | 72.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07432 | acc=0.9645 | tpr=0.9747 | fpr=0.0577 | 4375.4 samples/s | 17.1 steps/s
Avg test loss: 0.07477, Avg test acc: 0.96430, Avg tpr: 0.97453, Avg fpr: 0.05820, total FA: 454

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06322 | acc=0.9626 | tpr=0.9691 | fpr=0.0515 | 4124.8 samples/s | 16.1 steps/s
Avg test loss: 0.06877, Avg test acc: 0.96037, Avg tpr: 0.96654, Avg fpr: 0.05320, total FA: 415

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.56024 | acc=0.3066 | tpr=0.0049 | fpr=0.0384 | 4258.3 samples/s | 16.6 steps/s
Avg test loss: 6.56284, Avg test acc: 0.30427, Avg tpr: 0.00484, Avg fpr: 0.03717, total FA: 290

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.52352 | acc=0.3116 | tpr=0.0146 | fpr=0.0434 | 4278.6 samples/s | 16.7 steps/s
Avg test loss: 6.52731, Avg test acc: 0.30928, Avg tpr: 0.01597, Avg fpr: 0.04564, total FA: 356

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.94157 | acc=0.1259 | tpr=0.8363 | fpr=0.8868 | 4340.2 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.92326 | acc=0.1269 | tpr=0.8486 | fpr=0.8866 | 8874.0 samples/s | 34.7 steps/s
[Step= 150] | Loss=5.93046 | acc=0.1262 | tpr=0.8401 | fpr=0.8869 | 8396.6 samples/s | 32.8 steps/s
[Step= 200] | Loss=5.91437 | acc=0.1255 | tpr=0.8372 | fpr=0.8874 | 8618.0 samples/s | 33.7 steps/s
[Step= 250] | Loss=5.91080 | acc=0.1262 | tpr=0.8279 | fpr=0.8866 | 8820.3 samples/s | 34.5 steps/s
[Step= 300] | Loss=5.91276 | acc=0.1263 | tpr=0.8269 | fpr=0.8865 | 8538.1 samples/s | 33.4 steps/s
[Step= 350] | Loss=5.90987 | acc=0.1250 | tpr=0.8278 | fpr=0.8878 | 8758.8 samples/s | 34.2 steps/s
[Step= 400] | Loss=5.90521 | acc=0.1252 | tpr=0.8288 | fpr=0.8876 | 8719.5 samples/s | 34.1 steps/s
[Step= 450] | Loss=5.90264 | acc=0.1249 | tpr=0.8335 | fpr=0.8879 | 8516.1 samples/s | 33.3 steps/s
[Step= 500] | Loss=5.90278 | acc=0.1248 | tpr=0.8361 | fpr=0.8880 | 8757.1 samples/s | 34.2 steps/s
[Step= 550] | Loss=5.90448 | acc=0.1250 | tpr=0.8345 | fpr=0.8879 | 15233.1 samples/s | 59.5 steps/s
Avg test loss: 5.90527, Avg test acc: 0.12492, Avg tpr: 0.83439, Avg fpr: 0.88798, total FA: 123294

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.45584 | acc=0.1346 | tpr=0.6903 | fpr=0.8754 | 4311.6 samples/s | 16.8 steps/s
[Step= 100] | Loss=5.42893 | acc=0.1371 | tpr=0.6994 | fpr=0.8734 | 8610.9 samples/s | 33.6 steps/s
[Step= 150] | Loss=5.42919 | acc=0.1365 | tpr=0.6974 | fpr=0.8739 | 8780.8 samples/s | 34.3 steps/s
[Step= 200] | Loss=5.41286 | acc=0.1363 | tpr=0.6907 | fpr=0.8738 | 8630.3 samples/s | 33.7 steps/s
[Step= 250] | Loss=5.40775 | acc=0.1364 | tpr=0.6786 | fpr=0.8735 | 8572.0 samples/s | 33.5 steps/s
[Step= 300] | Loss=5.40776 | acc=0.1365 | tpr=0.6836 | fpr=0.8735 | 8861.7 samples/s | 34.6 steps/s
[Step= 350] | Loss=5.40632 | acc=0.1356 | tpr=0.6875 | fpr=0.8744 | 7850.8 samples/s | 30.7 steps/s
[Step= 400] | Loss=5.40228 | acc=0.1355 | tpr=0.6865 | fpr=0.8745 | 8382.8 samples/s | 32.7 steps/s
[Step= 450] | Loss=5.40087 | acc=0.1352 | tpr=0.6928 | fpr=0.8749 | 7329.1 samples/s | 28.6 steps/s
[Step= 500] | Loss=5.40130 | acc=0.1349 | tpr=0.6956 | fpr=0.8752 | 7312.3 samples/s | 28.6 steps/s
[Step= 550] | Loss=5.40235 | acc=0.1348 | tpr=0.6940 | fpr=0.8754 | 12211.5 samples/s | 47.7 steps/s
Avg test loss: 5.40313, Avg test acc: 0.13468, Avg tpr: 0.69414, Avg fpr: 0.87549, total FA: 121560

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.15297 | acc=0.9827 | tpr=0.9292 | fpr=0.0164 | 4088.2 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.16097 | acc=0.9817 | tpr=0.9403 | fpr=0.0175 | 8742.0 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.16768 | acc=0.9810 | tpr=0.9438 | fpr=0.0183 | 8923.6 samples/s | 34.9 steps/s
[Step= 200] | Loss=0.16906 | acc=0.9814 | tpr=0.9486 | fpr=0.0180 | 8452.3 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.16542 | acc=0.9818 | tpr=0.9502 | fpr=0.0176 | 9181.9 samples/s | 35.9 steps/s
[Step= 300] | Loss=0.16676 | acc=0.9817 | tpr=0.9484 | fpr=0.0177 | 8245.9 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.16766 | acc=0.9814 | tpr=0.9480 | fpr=0.0180 | 8880.3 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.16954 | acc=0.9812 | tpr=0.9447 | fpr=0.0181 | 8576.2 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.17368 | acc=0.9810 | tpr=0.9411 | fpr=0.0183 | 8492.8 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.17297 | acc=0.9810 | tpr=0.9427 | fpr=0.0183 | 8523.3 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.17156 | acc=0.9811 | tpr=0.9403 | fpr=0.0181 | 16468.3 samples/s | 64.3 steps/s
Avg test loss: 0.17107, Avg test acc: 0.98116, Avg tpr: 0.93978, Avg fpr: 0.01808, total FA: 2511

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16509 | acc=0.9809 | tpr=0.9204 | fpr=0.0181 | 4359.4 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.17163 | acc=0.9797 | tpr=0.9424 | fpr=0.0196 | 8549.1 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.17761 | acc=0.9791 | tpr=0.9424 | fpr=0.0202 | 9253.8 samples/s | 36.1 steps/s
[Step= 200] | Loss=0.17885 | acc=0.9794 | tpr=0.9443 | fpr=0.0200 | 8782.1 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.17498 | acc=0.9798 | tpr=0.9467 | fpr=0.0196 | 8345.2 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.17674 | acc=0.9795 | tpr=0.9462 | fpr=0.0199 | 8521.1 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.17867 | acc=0.9792 | tpr=0.9474 | fpr=0.0202 | 8629.3 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.17980 | acc=0.9791 | tpr=0.9447 | fpr=0.0203 | 8849.2 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.18309 | acc=0.9790 | tpr=0.9450 | fpr=0.0204 | 8973.0 samples/s | 35.1 steps/s
[Step= 500] | Loss=0.18248 | acc=0.9789 | tpr=0.9445 | fpr=0.0204 | 8201.8 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.18121 | acc=0.9791 | tpr=0.9423 | fpr=0.0203 | 15755.1 samples/s | 61.5 steps/s
Avg test loss: 0.18077, Avg test acc: 0.97908, Avg tpr: 0.94255, Avg fpr: 0.02026, total FA: 2813

server round 14/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=8001 Epoch=15.6] | Loss=0.01532 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.240 | L2-Norm(final)=5.648 | 4109.6 samples/s | 64.2 steps/s
[Step=8050 Epoch=15.7] | Loss=0.04150 | Reg=0.00203 | acc=0.9219 | L2-Norm=14.243 | L2-Norm(final)=5.674 | 5120.6 samples/s | 80.0 steps/s
[Step=8100 Epoch=15.8] | Loss=0.04085 | Reg=0.00203 | acc=0.9531 | L2-Norm=14.243 | L2-Norm(final)=5.706 | 5553.0 samples/s | 86.8 steps/s
[Step=8150 Epoch=15.9] | Loss=0.04005 | Reg=0.00203 | acc=0.9531 | L2-Norm=14.244 | L2-Norm(final)=5.740 | 5698.3 samples/s | 89.0 steps/s
[Step=8200 Epoch=16.0] | Loss=0.03950 | Reg=0.00203 | acc=0.9531 | L2-Norm=14.244 | L2-Norm(final)=5.774 | 5757.5 samples/s | 90.0 steps/s
[Step=8250 Epoch=16.1] | Loss=0.03900 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.244 | L2-Norm(final)=5.807 | 5793.4 samples/s | 90.5 steps/s
[Step=8300 Epoch=16.2] | Loss=0.03996 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.244 | L2-Norm(final)=5.838 | 5589.6 samples/s | 87.3 steps/s
[Step=8350 Epoch=16.3] | Loss=0.03940 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.244 | L2-Norm(final)=5.867 | 5734.1 samples/s | 89.6 steps/s
[Step=8400 Epoch=16.4] | Loss=0.03930 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.244 | L2-Norm(final)=5.896 | 5816.9 samples/s | 90.9 steps/s
[Step=8450 Epoch=16.5] | Loss=0.03928 | Reg=0.00203 | acc=0.9531 | L2-Norm=14.244 | L2-Norm(final)=5.923 | 5610.0 samples/s | 87.7 steps/s
[Step=8500 Epoch=16.6] | Loss=0.03865 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.244 | L2-Norm(final)=5.951 | 7189.3 samples/s | 112.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=16.6] | Loss=0.01682 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.244 | L2-Norm(final)=6.232 | 3882.2 samples/s | 60.7 steps/s
[Step=8550 Epoch=16.7] | Loss=0.03276 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.296 | L2-Norm(final)=6.244 | 4871.3 samples/s | 76.1 steps/s
[Step=8600 Epoch=16.8] | Loss=0.02795 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.345 | L2-Norm(final)=6.250 | 4909.6 samples/s | 76.7 steps/s
[Step=8650 Epoch=16.9] | Loss=0.02804 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.384 | L2-Norm(final)=6.250 | 5020.4 samples/s | 78.4 steps/s
[Step=8700 Epoch=17.0] | Loss=0.02775 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.416 | L2-Norm(final)=6.247 | 4921.0 samples/s | 76.9 steps/s
[Step=8750 Epoch=17.1] | Loss=0.02881 | Reg=0.00209 | acc=0.9375 | L2-Norm=14.443 | L2-Norm(final)=6.245 | 4919.2 samples/s | 76.9 steps/s
[Step=8800 Epoch=17.2] | Loss=0.02837 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.468 | L2-Norm(final)=6.244 | 4926.2 samples/s | 77.0 steps/s
[Step=8850 Epoch=17.3] | Loss=0.02795 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.491 | L2-Norm(final)=6.244 | 5106.2 samples/s | 79.8 steps/s
[Step=8900 Epoch=17.4] | Loss=0.02791 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.512 | L2-Norm(final)=6.244 | 4770.8 samples/s | 74.5 steps/s
[Step=8950 Epoch=17.5] | Loss=0.02754 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.533 | L2-Norm(final)=6.244 | 4854.6 samples/s | 75.9 steps/s
[Step=9000 Epoch=17.6] | Loss=0.02737 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.553 | L2-Norm(final)=6.245 | 6031.1 samples/s | 94.2 steps/s
[Step=9050 Epoch=17.7] | Loss=0.02644 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.572 | L2-Norm(final)=6.245 | 1902.8 samples/s | 29.7 steps/s
[Step=9100 Epoch=17.8] | Loss=0.02581 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.589 | L2-Norm(final)=6.246 | 4899.0 samples/s | 76.5 steps/s
[Step=9150 Epoch=17.9] | Loss=0.02503 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.604 | L2-Norm(final)=6.246 | 4935.6 samples/s | 77.1 steps/s
[Step=9200 Epoch=18.0] | Loss=0.02442 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.619 | L2-Norm(final)=6.248 | 5029.2 samples/s | 78.6 steps/s
[Step=9250 Epoch=18.1] | Loss=0.02363 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.632 | L2-Norm(final)=6.249 | 4907.7 samples/s | 76.7 steps/s
[Step=9300 Epoch=18.2] | Loss=0.02331 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.644 | L2-Norm(final)=6.250 | 5019.7 samples/s | 78.4 steps/s
[Step=9350 Epoch=18.3] | Loss=0.02309 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.657 | L2-Norm(final)=6.251 | 5003.8 samples/s | 78.2 steps/s
[Step=9400 Epoch=18.4] | Loss=0.02293 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.669 | L2-Norm(final)=6.252 | 4987.5 samples/s | 77.9 steps/s
[Step=9450 Epoch=18.5] | Loss=0.02262 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.680 | L2-Norm(final)=6.252 | 4931.3 samples/s | 77.1 steps/s
[Step=9500 Epoch=18.6] | Loss=0.02230 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.691 | L2-Norm(final)=6.253 | 5403.9 samples/s | 84.4 steps/s
[Step=9550 Epoch=18.7] | Loss=0.02198 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.702 | L2-Norm(final)=6.254 | 2005.3 samples/s | 31.3 steps/s
[Step=9600 Epoch=18.8] | Loss=0.02170 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.712 | L2-Norm(final)=6.254 | 4974.1 samples/s | 77.7 steps/s
[Step=9650 Epoch=18.9] | Loss=0.02129 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.722 | L2-Norm(final)=6.255 | 4965.8 samples/s | 77.6 steps/s
[Step=9700 Epoch=19.0] | Loss=0.02092 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.732 | L2-Norm(final)=6.256 | 5004.2 samples/s | 78.2 steps/s
[Step=9750 Epoch=19.1] | Loss=0.02070 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.741 | L2-Norm(final)=6.257 | 4975.3 samples/s | 77.7 steps/s
[Step=9800 Epoch=19.2] | Loss=0.02051 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.751 | L2-Norm(final)=6.258 | 4971.6 samples/s | 77.7 steps/s
[Step=9850 Epoch=19.3] | Loss=0.02026 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.760 | L2-Norm(final)=6.259 | 5000.2 samples/s | 78.1 steps/s
[Step=9900 Epoch=19.4] | Loss=0.01989 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.770 | L2-Norm(final)=6.259 | 4944.2 samples/s | 77.3 steps/s
[Step=9950 Epoch=19.5] | Loss=0.01964 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.779 | L2-Norm(final)=6.261 | 5021.8 samples/s | 78.5 steps/s
[Step=10000 Epoch=19.5] | Loss=0.01956 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.787 | L2-Norm(final)=6.261 | 4922.8 samples/s | 76.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step10000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=46.2] | Loss=0.00029 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.240 | L2-Norm(final)=9.635 | 3782.7 samples/s | 59.1 steps/s
[Step=12050 Epoch=46.4] | Loss=0.00226 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.236 | L2-Norm(final)=9.644 | 5040.1 samples/s | 78.8 steps/s
[Step=12100 Epoch=46.6] | Loss=0.00168 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.236 | L2-Norm(final)=9.658 | 5439.4 samples/s | 85.0 steps/s
[Step=12150 Epoch=46.8] | Loss=0.00170 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.235 | L2-Norm(final)=9.672 | 5272.8 samples/s | 82.4 steps/s
[Step=12200 Epoch=47.0] | Loss=0.00197 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.235 | L2-Norm(final)=9.687 | 5389.8 samples/s | 84.2 steps/s
[Step=12250 Epoch=47.2] | Loss=0.00174 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.235 | L2-Norm(final)=9.702 | 7161.6 samples/s | 111.9 steps/s
[Step=12300 Epoch=47.3] | Loss=0.00172 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.235 | L2-Norm(final)=9.716 | 1953.9 samples/s | 30.5 steps/s
[Step=12350 Epoch=47.5] | Loss=0.00167 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.235 | L2-Norm(final)=9.731 | 5479.3 samples/s | 85.6 steps/s
[Step=12400 Epoch=47.7] | Loss=0.00166 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.235 | L2-Norm(final)=9.745 | 5172.7 samples/s | 80.8 steps/s
[Step=12450 Epoch=47.9] | Loss=0.00170 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.235 | L2-Norm(final)=9.759 | 5324.6 samples/s | 83.2 steps/s
[Step=12500 Epoch=48.1] | Loss=0.00173 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.235 | L2-Norm(final)=9.773 | 6245.8 samples/s | 97.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=48.1] | Loss=0.00017 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.235 | L2-Norm(final)=9.916 | 3727.5 samples/s | 58.2 steps/s
[Step=12550 Epoch=48.3] | Loss=0.00612 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.286 | L2-Norm(final)=9.926 | 4700.8 samples/s | 73.5 steps/s
[Step=12600 Epoch=48.5] | Loss=0.00770 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.388 | L2-Norm(final)=9.911 | 4740.7 samples/s | 74.1 steps/s
[Step=12650 Epoch=48.7] | Loss=0.00681 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.467 | L2-Norm(final)=9.895 | 4661.5 samples/s | 72.8 steps/s
[Step=12700 Epoch=48.9] | Loss=0.00618 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.521 | L2-Norm(final)=9.885 | 4722.4 samples/s | 73.8 steps/s
[Step=12750 Epoch=49.1] | Loss=0.00527 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.558 | L2-Norm(final)=9.880 | 5989.4 samples/s | 93.6 steps/s
[Step=12800 Epoch=49.3] | Loss=0.00456 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.585 | L2-Norm(final)=9.876 | 1846.0 samples/s | 28.8 steps/s
[Step=12850 Epoch=49.5] | Loss=0.00393 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.603 | L2-Norm(final)=9.874 | 4672.5 samples/s | 73.0 steps/s
[Step=12900 Epoch=49.7] | Loss=0.00345 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.614 | L2-Norm(final)=9.873 | 4715.7 samples/s | 73.7 steps/s
[Step=12950 Epoch=49.8] | Loss=0.00307 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.620 | L2-Norm(final)=9.872 | 4777.2 samples/s | 74.6 steps/s
[Step=13000 Epoch=50.0] | Loss=0.00276 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.621 | L2-Norm(final)=9.871 | 5310.4 samples/s | 83.0 steps/s
[Step=13050 Epoch=50.2] | Loss=0.00251 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.621 | L2-Norm(final)=9.871 | 1924.8 samples/s | 30.1 steps/s
[Step=13100 Epoch=50.4] | Loss=0.00230 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.618 | L2-Norm(final)=9.871 | 4729.9 samples/s | 73.9 steps/s
[Step=13150 Epoch=50.6] | Loss=0.00213 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.613 | L2-Norm(final)=9.870 | 4742.6 samples/s | 74.1 steps/s
[Step=13200 Epoch=50.8] | Loss=0.00198 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.608 | L2-Norm(final)=9.870 | 4767.6 samples/s | 74.5 steps/s
[Step=13250 Epoch=51.0] | Loss=0.00184 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.601 | L2-Norm(final)=9.870 | 4757.9 samples/s | 74.3 steps/s
[Step=13300 Epoch=51.2] | Loss=0.00173 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.594 | L2-Norm(final)=9.870 | 1993.6 samples/s | 31.1 steps/s
[Step=13350 Epoch=51.4] | Loss=0.00163 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.587 | L2-Norm(final)=9.870 | 4867.5 samples/s | 76.1 steps/s
[Step=13400 Epoch=51.6] | Loss=0.00154 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.578 | L2-Norm(final)=9.871 | 4613.4 samples/s | 72.1 steps/s
[Step=13450 Epoch=51.8] | Loss=0.00146 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.569 | L2-Norm(final)=9.871 | 4699.0 samples/s | 73.4 steps/s
[Step=13500 Epoch=52.0] | Loss=0.00138 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.560 | L2-Norm(final)=9.871 | 4759.6 samples/s | 74.4 steps/s
[Step=13550 Epoch=52.2] | Loss=0.00132 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.551 | L2-Norm(final)=9.871 | 2033.1 samples/s | 31.8 steps/s
[Step=13600 Epoch=52.4] | Loss=0.00126 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.541 | L2-Norm(final)=9.871 | 4653.5 samples/s | 72.7 steps/s
[Step=13650 Epoch=52.5] | Loss=0.00120 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.531 | L2-Norm(final)=9.871 | 4711.3 samples/s | 73.6 steps/s
[Step=13700 Epoch=52.7] | Loss=0.00115 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.521 | L2-Norm(final)=9.872 | 4775.0 samples/s | 74.6 steps/s
[Step=13750 Epoch=52.9] | Loss=0.00111 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.511 | L2-Norm(final)=9.872 | 4609.2 samples/s | 72.0 steps/s
[Step=13800 Epoch=53.1] | Loss=0.00107 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.500 | L2-Norm(final)=9.872 | 6964.9 samples/s | 108.8 steps/s
[Step=13850 Epoch=53.3] | Loss=0.00103 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.490 | L2-Norm(final)=9.872 | 1790.4 samples/s | 28.0 steps/s
[Step=13900 Epoch=53.5] | Loss=0.00099 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.479 | L2-Norm(final)=9.872 | 4637.7 samples/s | 72.5 steps/s
[Step=13950 Epoch=53.7] | Loss=0.00096 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.468 | L2-Norm(final)=9.873 | 4790.5 samples/s | 74.9 steps/s
[Step=14000 Epoch=53.9] | Loss=0.00092 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.457 | L2-Norm(final)=9.873 | 4637.7 samples/s | 72.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step14000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07432 | acc=0.9645 | tpr=0.9747 | fpr=0.0577 | 4328.7 samples/s | 16.9 steps/s
Avg test loss: 0.07477, Avg test acc: 0.96430, Avg tpr: 0.97453, Avg fpr: 0.05820, total FA: 454

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06597 | acc=0.9656 | tpr=0.9703 | fpr=0.0446 | 4378.7 samples/s | 17.1 steps/s
Avg test loss: 0.07154, Avg test acc: 0.96298, Avg tpr: 0.96806, Avg fpr: 0.04820, total FA: 376

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.56024 | acc=0.3066 | tpr=0.0049 | fpr=0.0384 | 4340.7 samples/s | 17.0 steps/s
Avg test loss: 6.56284, Avg test acc: 0.30427, Avg tpr: 0.00484, Avg fpr: 0.03717, total FA: 290

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.66154 | acc=0.3047 | tpr=0.0103 | fpr=0.0560 | 4366.0 samples/s | 17.1 steps/s
Avg test loss: 6.65961, Avg test acc: 0.30275, Avg tpr: 0.01201, Avg fpr: 0.05781, total FA: 451

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.94157 | acc=0.1259 | tpr=0.8363 | fpr=0.8868 | 4404.3 samples/s | 17.2 steps/s
[Step= 100] | Loss=5.92326 | acc=0.1269 | tpr=0.8486 | fpr=0.8866 | 8710.6 samples/s | 34.0 steps/s
[Step= 150] | Loss=5.93046 | acc=0.1262 | tpr=0.8401 | fpr=0.8869 | 8541.7 samples/s | 33.4 steps/s
[Step= 200] | Loss=5.91437 | acc=0.1255 | tpr=0.8372 | fpr=0.8874 | 8669.9 samples/s | 33.9 steps/s
[Step= 250] | Loss=5.91080 | acc=0.1262 | tpr=0.8279 | fpr=0.8866 | 8552.7 samples/s | 33.4 steps/s
[Step= 300] | Loss=5.91276 | acc=0.1263 | tpr=0.8269 | fpr=0.8865 | 8811.1 samples/s | 34.4 steps/s
[Step= 350] | Loss=5.90987 | acc=0.1250 | tpr=0.8278 | fpr=0.8878 | 8650.2 samples/s | 33.8 steps/s
[Step= 400] | Loss=5.90521 | acc=0.1252 | tpr=0.8288 | fpr=0.8876 | 8594.5 samples/s | 33.6 steps/s
[Step= 450] | Loss=5.90264 | acc=0.1249 | tpr=0.8335 | fpr=0.8879 | 8504.2 samples/s | 33.2 steps/s
[Step= 500] | Loss=5.90278 | acc=0.1248 | tpr=0.8361 | fpr=0.8880 | 8796.5 samples/s | 34.4 steps/s
[Step= 550] | Loss=5.90448 | acc=0.1250 | tpr=0.8345 | fpr=0.8879 | 15495.4 samples/s | 60.5 steps/s
Avg test loss: 5.90527, Avg test acc: 0.12492, Avg tpr: 0.83439, Avg fpr: 0.88798, total FA: 123294

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.11302 | acc=0.1479 | tpr=0.7035 | fpr=0.8621 | 4402.9 samples/s | 17.2 steps/s
[Step= 100] | Loss=5.08910 | acc=0.1473 | tpr=0.6972 | fpr=0.8629 | 8452.6 samples/s | 33.0 steps/s
[Step= 150] | Loss=5.08375 | acc=0.1469 | tpr=0.6888 | fpr=0.8631 | 8800.1 samples/s | 34.4 steps/s
[Step= 200] | Loss=5.06430 | acc=0.1466 | tpr=0.6962 | fpr=0.8634 | 8686.6 samples/s | 33.9 steps/s
[Step= 250] | Loss=5.06034 | acc=0.1467 | tpr=0.6943 | fpr=0.8633 | 8827.3 samples/s | 34.5 steps/s
[Step= 300] | Loss=5.06041 | acc=0.1471 | tpr=0.6975 | fpr=0.8630 | 8693.6 samples/s | 34.0 steps/s
[Step= 350] | Loss=5.05198 | acc=0.1466 | tpr=0.7032 | fpr=0.8635 | 8724.3 samples/s | 34.1 steps/s
[Step= 400] | Loss=5.04865 | acc=0.1467 | tpr=0.7090 | fpr=0.8636 | 8673.1 samples/s | 33.9 steps/s
[Step= 450] | Loss=5.04594 | acc=0.1461 | tpr=0.7128 | fpr=0.8642 | 8924.5 samples/s | 34.9 steps/s
[Step= 500] | Loss=5.04898 | acc=0.1456 | tpr=0.7167 | fpr=0.8647 | 8379.3 samples/s | 32.7 steps/s
[Step= 550] | Loss=5.04900 | acc=0.1457 | tpr=0.7183 | fpr=0.8647 | 15501.3 samples/s | 60.6 steps/s
Avg test loss: 5.04984, Avg test acc: 0.14561, Avg tpr: 0.71870, Avg fpr: 0.86481, total FA: 120077

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.15297 | acc=0.9827 | tpr=0.9292 | fpr=0.0164 | 4390.3 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.16097 | acc=0.9817 | tpr=0.9403 | fpr=0.0175 | 8547.0 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.16768 | acc=0.9810 | tpr=0.9438 | fpr=0.0183 | 8635.9 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.16906 | acc=0.9814 | tpr=0.9486 | fpr=0.0180 | 8421.4 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.16542 | acc=0.9818 | tpr=0.9502 | fpr=0.0176 | 8700.4 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.16676 | acc=0.9817 | tpr=0.9484 | fpr=0.0177 | 8699.9 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.16766 | acc=0.9814 | tpr=0.9480 | fpr=0.0180 | 8753.2 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.16954 | acc=0.9812 | tpr=0.9447 | fpr=0.0181 | 8798.5 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.17368 | acc=0.9810 | tpr=0.9411 | fpr=0.0183 | 8728.1 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.17297 | acc=0.9810 | tpr=0.9427 | fpr=0.0183 | 8533.6 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.17156 | acc=0.9811 | tpr=0.9403 | fpr=0.0181 | 15679.9 samples/s | 61.2 steps/s
Avg test loss: 0.17107, Avg test acc: 0.98116, Avg tpr: 0.93978, Avg fpr: 0.01808, total FA: 2511

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14242 | acc=0.9788 | tpr=0.9204 | fpr=0.0201 | 4358.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.14978 | acc=0.9786 | tpr=0.9403 | fpr=0.0207 | 8740.2 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.15372 | acc=0.9780 | tpr=0.9395 | fpr=0.0213 | 8713.8 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.15435 | acc=0.9785 | tpr=0.9454 | fpr=0.0209 | 8526.5 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.15091 | acc=0.9788 | tpr=0.9450 | fpr=0.0206 | 8646.8 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.15253 | acc=0.9786 | tpr=0.9462 | fpr=0.0209 | 8666.1 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.15318 | acc=0.9783 | tpr=0.9487 | fpr=0.0212 | 8786.0 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.15414 | acc=0.9780 | tpr=0.9469 | fpr=0.0214 | 8656.4 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.15740 | acc=0.9779 | tpr=0.9455 | fpr=0.0215 | 8996.1 samples/s | 35.1 steps/s
[Step= 500] | Loss=0.15719 | acc=0.9779 | tpr=0.9454 | fpr=0.0216 | 8457.7 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.15696 | acc=0.9780 | tpr=0.9447 | fpr=0.0214 | 15663.8 samples/s | 61.2 steps/s
Avg test loss: 0.15659, Avg test acc: 0.97798, Avg tpr: 0.94493, Avg fpr: 0.02142, total FA: 2974

server round 15/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=24001 Epoch=46.8] | Loss=0.01099 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.180 | L2-Norm(final)=8.890 | 3569.5 samples/s | 55.8 steps/s
[Step=24050 Epoch=46.9] | Loss=0.02635 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.183 | L2-Norm(final)=8.900 | 5522.4 samples/s | 86.3 steps/s
[Step=24100 Epoch=47.0] | Loss=0.02666 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.183 | L2-Norm(final)=8.911 | 5605.9 samples/s | 87.6 steps/s
[Step=24150 Epoch=47.1] | Loss=0.02647 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.183 | L2-Norm(final)=8.921 | 5602.4 samples/s | 87.5 steps/s
[Step=24200 Epoch=47.2] | Loss=0.02645 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.183 | L2-Norm(final)=8.932 | 5720.9 samples/s | 89.4 steps/s
[Step=24250 Epoch=47.3] | Loss=0.02606 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.183 | L2-Norm(final)=8.943 | 5708.0 samples/s | 89.2 steps/s
[Step=24300 Epoch=47.4] | Loss=0.02638 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.183 | L2-Norm(final)=8.954 | 5795.1 samples/s | 90.5 steps/s
[Step=24350 Epoch=47.5] | Loss=0.02644 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.183 | L2-Norm(final)=8.964 | 5673.3 samples/s | 88.6 steps/s
[Step=24400 Epoch=47.6] | Loss=0.02677 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.183 | L2-Norm(final)=8.974 | 5715.8 samples/s | 89.3 steps/s
[Step=24450 Epoch=47.7] | Loss=0.02661 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.183 | L2-Norm(final)=8.985 | 5675.4 samples/s | 88.7 steps/s
[Step=24500 Epoch=47.8] | Loss=0.02651 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.183 | L2-Norm(final)=8.995 | 7332.1 samples/s | 114.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=47.8] | Loss=0.03057 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.183 | L2-Norm(final)=9.096 | 3662.9 samples/s | 57.2 steps/s
[Step=24550 Epoch=47.9] | Loss=0.02595 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.227 | L2-Norm(final)=9.104 | 4692.5 samples/s | 73.3 steps/s
[Step=24600 Epoch=48.0] | Loss=0.02822 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.283 | L2-Norm(final)=9.098 | 4990.7 samples/s | 78.0 steps/s
[Step=24650 Epoch=48.1] | Loss=0.02881 | Reg=0.00205 | acc=0.9375 | L2-Norm=14.328 | L2-Norm(final)=9.096 | 4948.9 samples/s | 77.3 steps/s
[Step=24700 Epoch=48.2] | Loss=0.02884 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.367 | L2-Norm(final)=9.093 | 5022.4 samples/s | 78.5 steps/s
[Step=24750 Epoch=48.3] | Loss=0.02847 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.399 | L2-Norm(final)=9.092 | 4951.0 samples/s | 77.4 steps/s
[Step=24800 Epoch=48.4] | Loss=0.02830 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.427 | L2-Norm(final)=9.091 | 4986.6 samples/s | 77.9 steps/s
[Step=24850 Epoch=48.5] | Loss=0.02799 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.451 | L2-Norm(final)=9.088 | 4922.0 samples/s | 76.9 steps/s
[Step=24900 Epoch=48.6] | Loss=0.02769 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.474 | L2-Norm(final)=9.086 | 4978.4 samples/s | 77.8 steps/s
[Step=24950 Epoch=48.7] | Loss=0.02714 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.494 | L2-Norm(final)=9.084 | 4989.1 samples/s | 78.0 steps/s
[Step=25000 Epoch=48.8] | Loss=0.02637 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.513 | L2-Norm(final)=9.083 | 6040.2 samples/s | 94.4 steps/s
[Step=25050 Epoch=48.9] | Loss=0.02583 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.530 | L2-Norm(final)=9.081 | 1863.9 samples/s | 29.1 steps/s
[Step=25100 Epoch=49.0] | Loss=0.02500 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.547 | L2-Norm(final)=9.081 | 4982.2 samples/s | 77.8 steps/s
[Step=25150 Epoch=49.1] | Loss=0.02405 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.561 | L2-Norm(final)=9.080 | 4975.8 samples/s | 77.7 steps/s
[Step=25200 Epoch=49.1] | Loss=0.02360 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.575 | L2-Norm(final)=9.080 | 4897.9 samples/s | 76.5 steps/s
[Step=25250 Epoch=49.2] | Loss=0.02306 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.588 | L2-Norm(final)=9.080 | 4936.0 samples/s | 77.1 steps/s
[Step=25300 Epoch=49.3] | Loss=0.02286 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.600 | L2-Norm(final)=9.080 | 4826.2 samples/s | 75.4 steps/s
[Step=25350 Epoch=49.4] | Loss=0.02245 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.612 | L2-Norm(final)=9.080 | 4939.1 samples/s | 77.2 steps/s
[Step=25400 Epoch=49.5] | Loss=0.02209 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.623 | L2-Norm(final)=9.080 | 4833.6 samples/s | 75.5 steps/s
[Step=25450 Epoch=49.6] | Loss=0.02178 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.634 | L2-Norm(final)=9.080 | 5014.6 samples/s | 78.4 steps/s
[Step=25500 Epoch=49.7] | Loss=0.02153 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.644 | L2-Norm(final)=9.080 | 5164.4 samples/s | 80.7 steps/s
[Step=25550 Epoch=49.8] | Loss=0.02114 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.654 | L2-Norm(final)=9.080 | 1938.6 samples/s | 30.3 steps/s
[Step=25600 Epoch=49.9] | Loss=0.02074 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.664 | L2-Norm(final)=9.080 | 4172.4 samples/s | 65.2 steps/s
[Step=25650 Epoch=50.0] | Loss=0.02030 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.673 | L2-Norm(final)=9.081 | 4128.6 samples/s | 64.5 steps/s
[Step=25700 Epoch=50.1] | Loss=0.01990 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.682 | L2-Norm(final)=9.082 | 4190.1 samples/s | 65.5 steps/s
[Step=25750 Epoch=50.2] | Loss=0.01960 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.691 | L2-Norm(final)=9.082 | 4184.7 samples/s | 65.4 steps/s
[Step=25800 Epoch=50.3] | Loss=0.01942 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.699 | L2-Norm(final)=9.082 | 4216.2 samples/s | 65.9 steps/s
[Step=25850 Epoch=50.4] | Loss=0.01916 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.708 | L2-Norm(final)=9.083 | 4241.5 samples/s | 66.3 steps/s
[Step=25900 Epoch=50.5] | Loss=0.01902 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.716 | L2-Norm(final)=9.084 | 4276.6 samples/s | 66.8 steps/s
[Step=25950 Epoch=50.6] | Loss=0.01891 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.724 | L2-Norm(final)=9.084 | 4306.6 samples/s | 67.3 steps/s
[Step=26000 Epoch=50.7] | Loss=0.01887 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.733 | L2-Norm(final)=9.085 | 4328.4 samples/s | 67.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step26000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=53.9] | Loss=0.00006 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.180 | L2-Norm(final)=9.880 | 3867.4 samples/s | 60.4 steps/s
[Step=14050 Epoch=54.1] | Loss=0.00143 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.177 | L2-Norm(final)=9.894 | 5253.5 samples/s | 82.1 steps/s
[Step=14100 Epoch=54.3] | Loss=0.00117 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.176 | L2-Norm(final)=9.909 | 5455.7 samples/s | 85.2 steps/s
[Step=14150 Epoch=54.5] | Loss=0.00135 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.176 | L2-Norm(final)=9.925 | 5247.8 samples/s | 82.0 steps/s
[Step=14200 Epoch=54.7] | Loss=0.00140 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.176 | L2-Norm(final)=9.942 | 5396.5 samples/s | 84.3 steps/s
[Step=14250 Epoch=54.9] | Loss=0.00133 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.176 | L2-Norm(final)=9.960 | 7140.0 samples/s | 111.6 steps/s
[Step=14300 Epoch=55.0] | Loss=0.00124 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.176 | L2-Norm(final)=9.977 | 1917.6 samples/s | 30.0 steps/s
[Step=14350 Epoch=55.2] | Loss=0.00133 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.176 | L2-Norm(final)=9.993 | 5349.8 samples/s | 83.6 steps/s
[Step=14400 Epoch=55.4] | Loss=0.00131 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.176 | L2-Norm(final)=10.009 | 5446.3 samples/s | 85.1 steps/s
[Step=14450 Epoch=55.6] | Loss=0.00127 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.176 | L2-Norm(final)=10.025 | 5263.9 samples/s | 82.2 steps/s
[Step=14500 Epoch=55.8] | Loss=0.00119 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.176 | L2-Norm(final)=10.040 | 6246.3 samples/s | 97.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=55.8] | Loss=0.00060 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.176 | L2-Norm(final)=10.182 | 3722.0 samples/s | 58.2 steps/s
[Step=14550 Epoch=56.0] | Loss=0.00328 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.204 | L2-Norm(final)=10.189 | 4687.4 samples/s | 73.2 steps/s
[Step=14600 Epoch=56.2] | Loss=0.00543 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.331 | L2-Norm(final)=10.173 | 4713.0 samples/s | 73.6 steps/s
[Step=14650 Epoch=56.4] | Loss=0.00520 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.410 | L2-Norm(final)=10.156 | 4698.5 samples/s | 73.4 steps/s
[Step=14700 Epoch=56.6] | Loss=0.00437 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.457 | L2-Norm(final)=10.145 | 4765.8 samples/s | 74.5 steps/s
[Step=14750 Epoch=56.8] | Loss=0.00513 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.492 | L2-Norm(final)=10.135 | 5982.2 samples/s | 93.5 steps/s
[Step=14800 Epoch=57.0] | Loss=0.00437 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.521 | L2-Norm(final)=10.126 | 1851.2 samples/s | 28.9 steps/s
[Step=14850 Epoch=57.2] | Loss=0.00378 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.540 | L2-Norm(final)=10.120 | 4682.0 samples/s | 73.2 steps/s
[Step=14900 Epoch=57.4] | Loss=0.00331 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.551 | L2-Norm(final)=10.117 | 4727.5 samples/s | 73.9 steps/s
[Step=14950 Epoch=57.5] | Loss=0.00295 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.557 | L2-Norm(final)=10.114 | 4656.4 samples/s | 72.8 steps/s
[Step=15000 Epoch=57.7] | Loss=0.00266 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.560 | L2-Norm(final)=10.112 | 5357.2 samples/s | 83.7 steps/s
[Step=15050 Epoch=57.9] | Loss=0.00242 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.561 | L2-Norm(final)=10.111 | 1938.1 samples/s | 30.3 steps/s
[Step=15100 Epoch=58.1] | Loss=0.00222 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.559 | L2-Norm(final)=10.109 | 4681.0 samples/s | 73.1 steps/s
[Step=15150 Epoch=58.3] | Loss=0.00205 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.556 | L2-Norm(final)=10.109 | 4757.0 samples/s | 74.3 steps/s
[Step=15200 Epoch=58.5] | Loss=0.00190 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.551 | L2-Norm(final)=10.108 | 4700.7 samples/s | 73.4 steps/s
[Step=15250 Epoch=58.7] | Loss=0.00178 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.546 | L2-Norm(final)=10.107 | 4801.8 samples/s | 75.0 steps/s
[Step=15300 Epoch=58.9] | Loss=0.00167 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.540 | L2-Norm(final)=10.107 | 2007.8 samples/s | 31.4 steps/s
[Step=15350 Epoch=59.1] | Loss=0.00157 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.534 | L2-Norm(final)=10.107 | 4754.1 samples/s | 74.3 steps/s
[Step=15400 Epoch=59.3] | Loss=0.00148 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.527 | L2-Norm(final)=10.107 | 4725.8 samples/s | 73.8 steps/s
[Step=15450 Epoch=59.5] | Loss=0.00140 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.519 | L2-Norm(final)=10.107 | 4735.4 samples/s | 74.0 steps/s
[Step=15500 Epoch=59.7] | Loss=0.00133 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.511 | L2-Norm(final)=10.106 | 4688.7 samples/s | 73.3 steps/s
[Step=15550 Epoch=59.9] | Loss=0.00127 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.503 | L2-Norm(final)=10.106 | 2016.9 samples/s | 31.5 steps/s
[Step=15600 Epoch=60.1] | Loss=0.00121 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.495 | L2-Norm(final)=10.106 | 4816.9 samples/s | 75.3 steps/s
[Step=15650 Epoch=60.2] | Loss=0.00116 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.486 | L2-Norm(final)=10.106 | 4666.5 samples/s | 72.9 steps/s
[Step=15700 Epoch=60.4] | Loss=0.00111 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.477 | L2-Norm(final)=10.107 | 4685.3 samples/s | 73.2 steps/s
[Step=15750 Epoch=60.6] | Loss=0.00107 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.468 | L2-Norm(final)=10.107 | 4805.5 samples/s | 75.1 steps/s
[Step=15800 Epoch=60.8] | Loss=0.00103 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.459 | L2-Norm(final)=10.107 | 6768.0 samples/s | 105.8 steps/s
[Step=15850 Epoch=61.0] | Loss=0.00099 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.449 | L2-Norm(final)=10.107 | 1793.6 samples/s | 28.0 steps/s
[Step=15900 Epoch=61.2] | Loss=0.00095 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.440 | L2-Norm(final)=10.107 | 4726.9 samples/s | 73.9 steps/s
[Step=15950 Epoch=61.4] | Loss=0.00092 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.430 | L2-Norm(final)=10.107 | 4678.7 samples/s | 73.1 steps/s
[Step=16000 Epoch=61.6] | Loss=0.00089 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.420 | L2-Norm(final)=10.108 | 4714.8 samples/s | 73.7 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06870 | acc=0.9647 | tpr=0.9757 | fpr=0.0592 | 4365.4 samples/s | 17.1 steps/s
Avg test loss: 0.06694, Avg test acc: 0.96462, Avg tpr: 0.97575, Avg fpr: 0.05986, total FA: 467

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06597 | acc=0.9656 | tpr=0.9703 | fpr=0.0446 | 4368.1 samples/s | 17.1 steps/s
Avg test loss: 0.07154, Avg test acc: 0.96298, Avg tpr: 0.96806, Avg fpr: 0.04820, total FA: 376

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.56024 | acc=0.3066 | tpr=0.0049 | fpr=0.0384 | 4315.8 samples/s | 16.9 steps/s
Avg test loss: 6.56284, Avg test acc: 0.30427, Avg tpr: 0.00484, Avg fpr: 0.03717, total FA: 290

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.38777 | acc=0.3050 | tpr=0.0130 | fpr=0.0610 | 4388.8 samples/s | 17.1 steps/s
Avg test loss: 6.39634, Avg test acc: 0.30275, Avg tpr: 0.01364, Avg fpr: 0.06140, total FA: 479

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.63799 | acc=0.1113 | tpr=0.7522 | fpr=0.9003 | 4370.1 samples/s | 17.1 steps/s
[Step= 100] | Loss=5.61632 | acc=0.1143 | tpr=0.7697 | fpr=0.8979 | 8656.3 samples/s | 33.8 steps/s
[Step= 150] | Loss=5.61560 | acc=0.1148 | tpr=0.7781 | fpr=0.8974 | 8585.9 samples/s | 33.5 steps/s
[Step= 200] | Loss=5.60485 | acc=0.1147 | tpr=0.7803 | fpr=0.8974 | 8753.1 samples/s | 34.2 steps/s
[Step= 250] | Loss=5.60050 | acc=0.1149 | tpr=0.7659 | fpr=0.8970 | 8646.1 samples/s | 33.8 steps/s
[Step= 300] | Loss=5.59720 | acc=0.1148 | tpr=0.7709 | fpr=0.8972 | 8693.0 samples/s | 34.0 steps/s
[Step= 350] | Loss=5.59560 | acc=0.1140 | tpr=0.7727 | fpr=0.8980 | 8948.8 samples/s | 35.0 steps/s
[Step= 400] | Loss=5.58904 | acc=0.1143 | tpr=0.7735 | fpr=0.8977 | 8896.6 samples/s | 34.8 steps/s
[Step= 450] | Loss=5.58707 | acc=0.1138 | tpr=0.7780 | fpr=0.8982 | 8553.9 samples/s | 33.4 steps/s
[Step= 500] | Loss=5.58722 | acc=0.1139 | tpr=0.7811 | fpr=0.8981 | 8355.2 samples/s | 32.6 steps/s
[Step= 550] | Loss=5.59063 | acc=0.1141 | tpr=0.7807 | fpr=0.8980 | 16028.5 samples/s | 62.6 steps/s
Avg test loss: 5.59121, Avg test acc: 0.11398, Avg tpr: 0.78090, Avg fpr: 0.89815, total FA: 124706

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.11302 | acc=0.1479 | tpr=0.7035 | fpr=0.8621 | 4356.5 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.08910 | acc=0.1473 | tpr=0.6972 | fpr=0.8629 | 8707.9 samples/s | 34.0 steps/s
[Step= 150] | Loss=5.08375 | acc=0.1469 | tpr=0.6888 | fpr=0.8631 | 8496.7 samples/s | 33.2 steps/s
[Step= 200] | Loss=5.06430 | acc=0.1466 | tpr=0.6962 | fpr=0.8634 | 8819.3 samples/s | 34.5 steps/s
[Step= 250] | Loss=5.06034 | acc=0.1467 | tpr=0.6943 | fpr=0.8633 | 8703.5 samples/s | 34.0 steps/s
[Step= 300] | Loss=5.06041 | acc=0.1471 | tpr=0.6975 | fpr=0.8630 | 8642.0 samples/s | 33.8 steps/s
[Step= 350] | Loss=5.05198 | acc=0.1466 | tpr=0.7032 | fpr=0.8635 | 8459.6 samples/s | 33.0 steps/s
[Step= 400] | Loss=5.04865 | acc=0.1467 | tpr=0.7090 | fpr=0.8636 | 8715.5 samples/s | 34.0 steps/s
[Step= 450] | Loss=5.04594 | acc=0.1461 | tpr=0.7128 | fpr=0.8642 | 8953.5 samples/s | 35.0 steps/s
[Step= 500] | Loss=5.04898 | acc=0.1456 | tpr=0.7167 | fpr=0.8647 | 8320.0 samples/s | 32.5 steps/s
[Step= 550] | Loss=5.04900 | acc=0.1457 | tpr=0.7183 | fpr=0.8647 | 15906.4 samples/s | 62.1 steps/s
Avg test loss: 5.04984, Avg test acc: 0.14561, Avg tpr: 0.71870, Avg fpr: 0.86481, total FA: 120077

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.15297 | acc=0.9827 | tpr=0.9292 | fpr=0.0164 | 4305.7 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.16097 | acc=0.9817 | tpr=0.9403 | fpr=0.0175 | 8622.8 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.16768 | acc=0.9810 | tpr=0.9438 | fpr=0.0183 | 9178.7 samples/s | 35.9 steps/s
[Step= 200] | Loss=0.16906 | acc=0.9814 | tpr=0.9486 | fpr=0.0180 | 8337.1 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.16542 | acc=0.9818 | tpr=0.9502 | fpr=0.0176 | 8912.4 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.16676 | acc=0.9817 | tpr=0.9484 | fpr=0.0177 | 8722.0 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.16766 | acc=0.9814 | tpr=0.9480 | fpr=0.0180 | 9056.9 samples/s | 35.4 steps/s
[Step= 400] | Loss=0.16954 | acc=0.9812 | tpr=0.9447 | fpr=0.0181 | 8292.6 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.17368 | acc=0.9810 | tpr=0.9411 | fpr=0.0183 | 8899.4 samples/s | 34.8 steps/s
[Step= 500] | Loss=0.17297 | acc=0.9810 | tpr=0.9427 | fpr=0.0183 | 8568.6 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.17156 | acc=0.9811 | tpr=0.9403 | fpr=0.0181 | 15332.6 samples/s | 59.9 steps/s
Avg test loss: 0.17107, Avg test acc: 0.98116, Avg tpr: 0.93978, Avg fpr: 0.01808, total FA: 2511

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14914 | acc=0.9806 | tpr=0.9248 | fpr=0.0184 | 4370.8 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.15580 | acc=0.9793 | tpr=0.9339 | fpr=0.0199 | 8543.8 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.16342 | acc=0.9783 | tpr=0.9424 | fpr=0.0211 | 8474.8 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.16572 | acc=0.9787 | tpr=0.9464 | fpr=0.0207 | 9026.9 samples/s | 35.3 steps/s
[Step= 250] | Loss=0.16277 | acc=0.9788 | tpr=0.9467 | fpr=0.0207 | 8670.0 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.16452 | acc=0.9786 | tpr=0.9447 | fpr=0.0208 | 8880.6 samples/s | 34.7 steps/s
[Step= 350] | Loss=0.16543 | acc=0.9784 | tpr=0.9480 | fpr=0.0211 | 8445.7 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.16744 | acc=0.9782 | tpr=0.9469 | fpr=0.0213 | 8586.2 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.17057 | acc=0.9780 | tpr=0.9450 | fpr=0.0214 | 8729.5 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.17067 | acc=0.9781 | tpr=0.9454 | fpr=0.0214 | 8616.8 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.16960 | acc=0.9783 | tpr=0.9455 | fpr=0.0211 | 15587.0 samples/s | 60.9 steps/s
Avg test loss: 0.16928, Avg test acc: 0.97832, Avg tpr: 0.94572, Avg fpr: 0.02109, total FA: 2928

server round 16/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=26001 Epoch=50.7] | Loss=0.01764 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.125 | L2-Norm(final)=9.097 | 3558.4 samples/s | 55.6 steps/s
[Step=26050 Epoch=50.8] | Loss=0.03057 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.128 | L2-Norm(final)=9.102 | 5581.5 samples/s | 87.2 steps/s
[Step=26100 Epoch=50.9] | Loss=0.03176 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.128 | L2-Norm(final)=9.114 | 5699.7 samples/s | 89.1 steps/s
[Step=26150 Epoch=51.0] | Loss=0.03321 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.128 | L2-Norm(final)=9.129 | 5718.3 samples/s | 89.3 steps/s
[Step=26200 Epoch=51.1] | Loss=0.03260 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.128 | L2-Norm(final)=9.143 | 5693.5 samples/s | 89.0 steps/s
[Step=26250 Epoch=51.2] | Loss=0.03233 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.129 | L2-Norm(final)=9.159 | 5788.6 samples/s | 90.4 steps/s
[Step=26300 Epoch=51.3] | Loss=0.03270 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.129 | L2-Norm(final)=9.174 | 5588.2 samples/s | 87.3 steps/s
[Step=26350 Epoch=51.4] | Loss=0.03261 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.129 | L2-Norm(final)=9.189 | 5721.8 samples/s | 89.4 steps/s
[Step=26400 Epoch=51.5] | Loss=0.03232 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.129 | L2-Norm(final)=9.205 | 5764.4 samples/s | 90.1 steps/s
[Step=26450 Epoch=51.6] | Loss=0.03277 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.129 | L2-Norm(final)=9.221 | 5771.9 samples/s | 90.2 steps/s
[Step=26500 Epoch=51.7] | Loss=0.03253 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.129 | L2-Norm(final)=9.236 | 7184.4 samples/s | 112.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=26501 Epoch=51.7] | Loss=0.00495 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.129 | L2-Norm(final)=9.393 | 3570.9 samples/s | 55.8 steps/s
[Step=26550 Epoch=51.8] | Loss=0.02611 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.192 | L2-Norm(final)=9.405 | 4912.3 samples/s | 76.8 steps/s
[Step=26600 Epoch=51.9] | Loss=0.02580 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.247 | L2-Norm(final)=9.402 | 4892.6 samples/s | 76.4 steps/s
[Step=26650 Epoch=52.0] | Loss=0.02694 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.286 | L2-Norm(final)=9.400 | 4943.8 samples/s | 77.2 steps/s
[Step=26700 Epoch=52.1] | Loss=0.02574 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.320 | L2-Norm(final)=9.398 | 4997.7 samples/s | 78.1 steps/s
[Step=26750 Epoch=52.2] | Loss=0.02611 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.349 | L2-Norm(final)=9.397 | 4958.9 samples/s | 77.5 steps/s
[Step=26800 Epoch=52.3] | Loss=0.02601 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.374 | L2-Norm(final)=9.395 | 5001.8 samples/s | 78.2 steps/s
[Step=26850 Epoch=52.4] | Loss=0.02596 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.396 | L2-Norm(final)=9.393 | 4969.2 samples/s | 77.6 steps/s
[Step=26900 Epoch=52.5] | Loss=0.02624 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.416 | L2-Norm(final)=9.391 | 4968.3 samples/s | 77.6 steps/s
[Step=26950 Epoch=52.6] | Loss=0.02544 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.436 | L2-Norm(final)=9.389 | 4984.1 samples/s | 77.9 steps/s
[Step=27000 Epoch=52.7] | Loss=0.02540 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.454 | L2-Norm(final)=9.386 | 5976.7 samples/s | 93.4 steps/s
[Step=27050 Epoch=52.8] | Loss=0.02464 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.472 | L2-Norm(final)=9.385 | 1846.3 samples/s | 28.8 steps/s
[Step=27100 Epoch=52.9] | Loss=0.02398 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.489 | L2-Norm(final)=9.384 | 4914.7 samples/s | 76.8 steps/s
[Step=27150 Epoch=53.0] | Loss=0.02360 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.505 | L2-Norm(final)=9.383 | 4908.2 samples/s | 76.7 steps/s
[Step=27200 Epoch=53.1] | Loss=0.02319 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.519 | L2-Norm(final)=9.382 | 5006.5 samples/s | 78.2 steps/s
[Step=27250 Epoch=53.1] | Loss=0.02281 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.532 | L2-Norm(final)=9.382 | 4928.7 samples/s | 77.0 steps/s
[Step=27300 Epoch=53.2] | Loss=0.02225 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.545 | L2-Norm(final)=9.382 | 4997.3 samples/s | 78.1 steps/s
[Step=27350 Epoch=53.3] | Loss=0.02190 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.558 | L2-Norm(final)=9.381 | 4998.9 samples/s | 78.1 steps/s
[Step=27400 Epoch=53.4] | Loss=0.02164 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.569 | L2-Norm(final)=9.381 | 4951.7 samples/s | 77.4 steps/s
[Step=27450 Epoch=53.5] | Loss=0.02141 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.580 | L2-Norm(final)=9.381 | 4986.2 samples/s | 77.9 steps/s
[Step=27500 Epoch=53.6] | Loss=0.02112 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.591 | L2-Norm(final)=9.381 | 5279.6 samples/s | 82.5 steps/s
[Step=27550 Epoch=53.7] | Loss=0.02089 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.601 | L2-Norm(final)=9.380 | 1967.0 samples/s | 30.7 steps/s
[Step=27600 Epoch=53.8] | Loss=0.02057 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.611 | L2-Norm(final)=9.380 | 4989.6 samples/s | 78.0 steps/s
[Step=27650 Epoch=53.9] | Loss=0.02016 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.621 | L2-Norm(final)=9.380 | 4931.3 samples/s | 77.1 steps/s
[Step=27700 Epoch=54.0] | Loss=0.01983 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.630 | L2-Norm(final)=9.380 | 4958.3 samples/s | 77.5 steps/s
[Step=27750 Epoch=54.1] | Loss=0.01944 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.639 | L2-Norm(final)=9.380 | 4959.0 samples/s | 77.5 steps/s
[Step=27800 Epoch=54.2] | Loss=0.01922 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.647 | L2-Norm(final)=9.380 | 5051.8 samples/s | 78.9 steps/s
[Step=27850 Epoch=54.3] | Loss=0.01910 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.656 | L2-Norm(final)=9.380 | 4915.8 samples/s | 76.8 steps/s
[Step=27900 Epoch=54.4] | Loss=0.01890 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.664 | L2-Norm(final)=9.381 | 4962.4 samples/s | 77.5 steps/s
[Step=27950 Epoch=54.5] | Loss=0.01863 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.672 | L2-Norm(final)=9.381 | 5017.5 samples/s | 78.4 steps/s
[Step=28000 Epoch=54.6] | Loss=0.01844 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.679 | L2-Norm(final)=9.382 | 4988.5 samples/s | 77.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step28000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=61.6] | Loss=0.00001 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.125 | L2-Norm(final)=10.115 | 3782.3 samples/s | 59.1 steps/s
[Step=16050 Epoch=61.8] | Loss=0.00199 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.122 | L2-Norm(final)=10.124 | 5149.0 samples/s | 80.5 steps/s
[Step=16100 Epoch=62.0] | Loss=0.00141 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=10.137 | 5282.8 samples/s | 82.5 steps/s
[Step=16150 Epoch=62.2] | Loss=0.00140 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=10.152 | 5364.3 samples/s | 83.8 steps/s
[Step=16200 Epoch=62.4] | Loss=0.00123 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=10.166 | 5457.9 samples/s | 85.3 steps/s
[Step=16250 Epoch=62.6] | Loss=0.00114 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=10.180 | 7057.8 samples/s | 110.3 steps/s
[Step=16300 Epoch=62.7] | Loss=0.00114 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=10.194 | 1926.5 samples/s | 30.1 steps/s
[Step=16350 Epoch=62.9] | Loss=0.00118 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=10.207 | 5345.8 samples/s | 83.5 steps/s
[Step=16400 Epoch=63.1] | Loss=0.00124 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=10.220 | 5335.8 samples/s | 83.4 steps/s
[Step=16450 Epoch=63.3] | Loss=0.00120 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=10.232 | 5250.9 samples/s | 82.0 steps/s
[Step=16500 Epoch=63.5] | Loss=0.00118 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=10.245 | 6160.8 samples/s | 96.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=63.5] | Loss=0.00101 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=10.369 | 3749.4 samples/s | 58.6 steps/s
[Step=16550 Epoch=63.7] | Loss=0.00282 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.134 | L2-Norm(final)=10.376 | 4681.7 samples/s | 73.2 steps/s
[Step=16600 Epoch=63.9] | Loss=0.00719 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.238 | L2-Norm(final)=10.359 | 4763.1 samples/s | 74.4 steps/s
[Step=16650 Epoch=64.1] | Loss=0.00624 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.324 | L2-Norm(final)=10.341 | 4645.5 samples/s | 72.6 steps/s
[Step=16700 Epoch=64.3] | Loss=0.00534 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.377 | L2-Norm(final)=10.331 | 4686.8 samples/s | 73.2 steps/s
[Step=16750 Epoch=64.5] | Loss=0.00444 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.410 | L2-Norm(final)=10.325 | 6035.7 samples/s | 94.3 steps/s
[Step=16800 Epoch=64.7] | Loss=0.00377 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.430 | L2-Norm(final)=10.322 | 1866.5 samples/s | 29.2 steps/s
[Step=16850 Epoch=64.9] | Loss=0.00326 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.442 | L2-Norm(final)=10.320 | 4653.6 samples/s | 72.7 steps/s
[Step=16900 Epoch=65.1] | Loss=0.00287 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.449 | L2-Norm(final)=10.319 | 4745.0 samples/s | 74.1 steps/s
[Step=16950 Epoch=65.2] | Loss=0.00256 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.452 | L2-Norm(final)=10.319 | 4630.6 samples/s | 72.4 steps/s
[Step=17000 Epoch=65.4] | Loss=0.00231 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.452 | L2-Norm(final)=10.319 | 5339.9 samples/s | 83.4 steps/s
[Step=17050 Epoch=65.6] | Loss=0.00211 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.451 | L2-Norm(final)=10.319 | 1939.6 samples/s | 30.3 steps/s
[Step=17100 Epoch=65.8] | Loss=0.00193 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.448 | L2-Norm(final)=10.320 | 4615.4 samples/s | 72.1 steps/s
[Step=17150 Epoch=66.0] | Loss=0.00179 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.444 | L2-Norm(final)=10.320 | 4711.4 samples/s | 73.6 steps/s
[Step=17200 Epoch=66.2] | Loss=0.00166 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.439 | L2-Norm(final)=10.321 | 4692.7 samples/s | 73.3 steps/s
[Step=17250 Epoch=66.4] | Loss=0.00155 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.433 | L2-Norm(final)=10.321 | 4809.8 samples/s | 75.2 steps/s
[Step=17300 Epoch=66.6] | Loss=0.00145 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.427 | L2-Norm(final)=10.321 | 1979.7 samples/s | 30.9 steps/s
[Step=17350 Epoch=66.8] | Loss=0.00137 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.420 | L2-Norm(final)=10.322 | 4882.3 samples/s | 76.3 steps/s
[Step=17400 Epoch=67.0] | Loss=0.00129 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.413 | L2-Norm(final)=10.322 | 4657.4 samples/s | 72.8 steps/s
[Step=17450 Epoch=67.2] | Loss=0.00123 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.405 | L2-Norm(final)=10.323 | 4697.8 samples/s | 73.4 steps/s
[Step=17500 Epoch=67.4] | Loss=0.00116 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.398 | L2-Norm(final)=10.323 | 4762.4 samples/s | 74.4 steps/s
[Step=17550 Epoch=67.6] | Loss=0.00111 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.389 | L2-Norm(final)=10.324 | 2009.9 samples/s | 31.4 steps/s
[Step=17600 Epoch=67.7] | Loss=0.00106 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.381 | L2-Norm(final)=10.324 | 4759.7 samples/s | 74.4 steps/s
[Step=17650 Epoch=67.9] | Loss=0.00101 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.373 | L2-Norm(final)=10.325 | 4728.2 samples/s | 73.9 steps/s
[Step=17700 Epoch=68.1] | Loss=0.00097 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.364 | L2-Norm(final)=10.325 | 4691.2 samples/s | 73.3 steps/s
[Step=17750 Epoch=68.3] | Loss=0.00093 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=10.326 | 4696.2 samples/s | 73.4 steps/s
[Step=17800 Epoch=68.5] | Loss=0.00090 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.346 | L2-Norm(final)=10.326 | 6951.6 samples/s | 108.6 steps/s
[Step=17850 Epoch=68.7] | Loss=0.00086 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.337 | L2-Norm(final)=10.327 | 1778.1 samples/s | 27.8 steps/s
[Step=17900 Epoch=68.9] | Loss=0.00083 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.327 | L2-Norm(final)=10.327 | 4692.5 samples/s | 73.3 steps/s
[Step=17950 Epoch=69.1] | Loss=0.00080 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.318 | L2-Norm(final)=10.328 | 4672.5 samples/s | 73.0 steps/s
[Step=18000 Epoch=69.3] | Loss=0.00078 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.308 | L2-Norm(final)=10.328 | 4694.0 samples/s | 73.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step18000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07311 | acc=0.9643 | tpr=0.9661 | fpr=0.0396 | 4303.4 samples/s | 16.8 steps/s
Avg test loss: 0.07291, Avg test acc: 0.96358, Avg tpr: 0.96550, Avg fpr: 0.04064, total FA: 317

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06597 | acc=0.9656 | tpr=0.9703 | fpr=0.0446 | 4337.7 samples/s | 16.9 steps/s
Avg test loss: 0.07154, Avg test acc: 0.96298, Avg tpr: 0.96806, Avg fpr: 0.04820, total FA: 376

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.56024 | acc=0.3066 | tpr=0.0049 | fpr=0.0384 | 4415.8 samples/s | 17.2 steps/s
Avg test loss: 6.56284, Avg test acc: 0.30427, Avg tpr: 0.00484, Avg fpr: 0.03717, total FA: 290

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.51794 | acc=0.3048 | tpr=0.0210 | fpr=0.0790 | 4364.2 samples/s | 17.0 steps/s
Avg test loss: 6.53284, Avg test acc: 0.30291, Avg tpr: 0.02203, Avg fpr: 0.07935, total FA: 619

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.85240 | acc=0.1573 | tpr=0.6549 | fpr=0.8516 | 4337.4 samples/s | 16.9 steps/s
[Step= 100] | Loss=4.82298 | acc=0.1588 | tpr=0.6695 | fpr=0.8508 | 8563.5 samples/s | 33.5 steps/s
[Step= 150] | Loss=4.82254 | acc=0.1576 | tpr=0.6599 | fpr=0.8517 | 9064.4 samples/s | 35.4 steps/s
[Step= 200] | Loss=4.80671 | acc=0.1582 | tpr=0.6546 | fpr=0.8509 | 8526.9 samples/s | 33.3 steps/s
[Step= 250] | Loss=4.80233 | acc=0.1583 | tpr=0.6376 | fpr=0.8505 | 8359.9 samples/s | 32.7 steps/s
[Step= 300] | Loss=4.79989 | acc=0.1582 | tpr=0.6342 | fpr=0.8504 | 8960.3 samples/s | 35.0 steps/s
[Step= 350] | Loss=4.79428 | acc=0.1575 | tpr=0.6362 | fpr=0.8512 | 8591.0 samples/s | 33.6 steps/s
[Step= 400] | Loss=4.78813 | acc=0.1579 | tpr=0.6395 | fpr=0.8509 | 8641.0 samples/s | 33.8 steps/s
[Step= 450] | Loss=4.78574 | acc=0.1574 | tpr=0.6397 | fpr=0.8513 | 8294.3 samples/s | 32.4 steps/s
[Step= 500] | Loss=4.78787 | acc=0.1575 | tpr=0.6396 | fpr=0.8513 | 8608.6 samples/s | 33.6 steps/s
[Step= 550] | Loss=4.79200 | acc=0.1572 | tpr=0.6363 | fpr=0.8515 | 16010.2 samples/s | 62.5 steps/s
Avg test loss: 4.79280, Avg test acc: 0.15710, Avg tpr: 0.63629, Avg fpr: 0.85161, total FA: 118245

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.11302 | acc=0.1479 | tpr=0.7035 | fpr=0.8621 | 4299.6 samples/s | 16.8 steps/s
[Step= 100] | Loss=5.08910 | acc=0.1473 | tpr=0.6972 | fpr=0.8629 | 8973.2 samples/s | 35.1 steps/s
[Step= 150] | Loss=5.08375 | acc=0.1469 | tpr=0.6888 | fpr=0.8631 | 8498.6 samples/s | 33.2 steps/s
[Step= 200] | Loss=5.06430 | acc=0.1466 | tpr=0.6962 | fpr=0.8634 | 8513.5 samples/s | 33.3 steps/s
[Step= 250] | Loss=5.06034 | acc=0.1467 | tpr=0.6943 | fpr=0.8633 | 8694.8 samples/s | 34.0 steps/s
[Step= 300] | Loss=5.06041 | acc=0.1471 | tpr=0.6975 | fpr=0.8630 | 8583.8 samples/s | 33.5 steps/s
[Step= 350] | Loss=5.05198 | acc=0.1466 | tpr=0.7032 | fpr=0.8635 | 9170.2 samples/s | 35.8 steps/s
[Step= 400] | Loss=5.04865 | acc=0.1467 | tpr=0.7090 | fpr=0.8636 | 8330.5 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.04594 | acc=0.1461 | tpr=0.7128 | fpr=0.8642 | 9068.6 samples/s | 35.4 steps/s
[Step= 500] | Loss=5.04898 | acc=0.1456 | tpr=0.7167 | fpr=0.8647 | 8354.9 samples/s | 32.6 steps/s
[Step= 550] | Loss=5.04900 | acc=0.1457 | tpr=0.7183 | fpr=0.8647 | 16247.5 samples/s | 63.5 steps/s
Avg test loss: 5.04984, Avg test acc: 0.14561, Avg tpr: 0.71870, Avg fpr: 0.86481, total FA: 120077

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.15297 | acc=0.9827 | tpr=0.9292 | fpr=0.0164 | 4322.9 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.16097 | acc=0.9817 | tpr=0.9403 | fpr=0.0175 | 8681.8 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.16768 | acc=0.9810 | tpr=0.9438 | fpr=0.0183 | 8639.6 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.16906 | acc=0.9814 | tpr=0.9486 | fpr=0.0180 | 8652.6 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.16542 | acc=0.9818 | tpr=0.9502 | fpr=0.0176 | 8666.1 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.16676 | acc=0.9817 | tpr=0.9484 | fpr=0.0177 | 8986.3 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.16766 | acc=0.9814 | tpr=0.9480 | fpr=0.0180 | 8984.4 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.16954 | acc=0.9812 | tpr=0.9447 | fpr=0.0181 | 8185.7 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.17368 | acc=0.9810 | tpr=0.9411 | fpr=0.0183 | 8660.8 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.17297 | acc=0.9810 | tpr=0.9427 | fpr=0.0183 | 8837.7 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.17156 | acc=0.9811 | tpr=0.9403 | fpr=0.0181 | 15125.5 samples/s | 59.1 steps/s
Avg test loss: 0.17107, Avg test acc: 0.98116, Avg tpr: 0.93978, Avg fpr: 0.01808, total FA: 2511

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.21764 | acc=0.9784 | tpr=0.9469 | fpr=0.0211 | 4361.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.22294 | acc=0.9774 | tpr=0.9595 | fpr=0.0223 | 8669.5 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.23366 | acc=0.9765 | tpr=0.9597 | fpr=0.0232 | 8598.4 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.23686 | acc=0.9768 | tpr=0.9607 | fpr=0.0229 | 8673.8 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.23260 | acc=0.9771 | tpr=0.9624 | fpr=0.0226 | 8653.1 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.23426 | acc=0.9768 | tpr=0.9564 | fpr=0.0228 | 8757.1 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.23569 | acc=0.9765 | tpr=0.9568 | fpr=0.0231 | 8850.9 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.23789 | acc=0.9763 | tpr=0.9540 | fpr=0.0233 | 8705.1 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.24344 | acc=0.9759 | tpr=0.9518 | fpr=0.0236 | 8504.8 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.24227 | acc=0.9759 | tpr=0.9520 | fpr=0.0236 | 8802.2 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.24054 | acc=0.9760 | tpr=0.9526 | fpr=0.0235 | 14712.4 samples/s | 57.5 steps/s
Avg test loss: 0.23990, Avg test acc: 0.97605, Avg tpr: 0.95285, Avg fpr: 0.02353, total FA: 3267

server round 17/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=46.0] | Loss=0.00154 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=9.159 | 3819.9 samples/s | 59.7 steps/s
[Step=12050 Epoch=46.2] | Loss=0.00325 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.088 | L2-Norm(final)=9.173 | 5211.3 samples/s | 81.4 steps/s
[Step=12100 Epoch=46.4] | Loss=0.00237 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=9.189 | 5283.6 samples/s | 82.6 steps/s
[Step=12150 Epoch=46.6] | Loss=0.00207 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=9.204 | 5289.6 samples/s | 82.6 steps/s
[Step=12200 Epoch=46.7] | Loss=0.00217 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=9.218 | 5373.2 samples/s | 84.0 steps/s
[Step=12250 Epoch=46.9] | Loss=0.00193 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=9.229 | 7025.5 samples/s | 109.8 steps/s
[Step=12300 Epoch=47.1] | Loss=0.00213 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.087 | L2-Norm(final)=9.241 | 1943.6 samples/s | 30.4 steps/s
[Step=12350 Epoch=47.3] | Loss=0.00207 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=9.251 | 5331.8 samples/s | 83.3 steps/s
[Step=12400 Epoch=47.5] | Loss=0.00190 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=9.261 | 5357.1 samples/s | 83.7 steps/s
[Step=12450 Epoch=47.7] | Loss=0.00185 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=9.272 | 5340.3 samples/s | 83.4 steps/s
[Step=12500 Epoch=47.9] | Loss=0.00173 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=9.282 | 6050.3 samples/s | 94.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=47.9] | Loss=0.01410 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.087 | L2-Norm(final)=9.389 | 3701.6 samples/s | 57.8 steps/s
[Step=12550 Epoch=48.1] | Loss=0.00183 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.126 | L2-Norm(final)=9.395 | 4630.7 samples/s | 72.4 steps/s
[Step=12600 Epoch=48.3] | Loss=0.00380 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.185 | L2-Norm(final)=9.398 | 4738.4 samples/s | 74.0 steps/s
[Step=12650 Epoch=48.5] | Loss=0.00472 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.273 | L2-Norm(final)=9.388 | 4694.7 samples/s | 73.4 steps/s
[Step=12700 Epoch=48.7] | Loss=0.00395 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.339 | L2-Norm(final)=9.379 | 4708.5 samples/s | 73.6 steps/s
[Step=12750 Epoch=48.9] | Loss=0.00323 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.377 | L2-Norm(final)=9.375 | 5900.7 samples/s | 92.2 steps/s
[Step=12800 Epoch=49.0] | Loss=0.00271 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.399 | L2-Norm(final)=9.373 | 1860.8 samples/s | 29.1 steps/s
[Step=12850 Epoch=49.2] | Loss=0.00233 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.410 | L2-Norm(final)=9.372 | 4671.3 samples/s | 73.0 steps/s
[Step=12900 Epoch=49.4] | Loss=0.00216 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.416 | L2-Norm(final)=9.372 | 4716.9 samples/s | 73.7 steps/s
[Step=12950 Epoch=49.6] | Loss=0.00197 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.422 | L2-Norm(final)=9.371 | 4720.6 samples/s | 73.8 steps/s
[Step=13000 Epoch=49.8] | Loss=0.00179 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.426 | L2-Norm(final)=9.371 | 5202.6 samples/s | 81.3 steps/s
[Step=13050 Epoch=50.0] | Loss=0.00186 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.429 | L2-Norm(final)=9.371 | 1930.6 samples/s | 30.2 steps/s
[Step=13100 Epoch=50.2] | Loss=0.00179 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.434 | L2-Norm(final)=9.370 | 4680.5 samples/s | 73.1 steps/s
[Step=13150 Epoch=50.4] | Loss=0.00166 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.438 | L2-Norm(final)=9.369 | 4752.4 samples/s | 74.3 steps/s
[Step=13200 Epoch=50.6] | Loss=0.00156 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.440 | L2-Norm(final)=9.369 | 4649.8 samples/s | 72.7 steps/s
[Step=13250 Epoch=50.8] | Loss=0.00160 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.442 | L2-Norm(final)=9.369 | 4732.4 samples/s | 73.9 steps/s
[Step=13300 Epoch=51.0] | Loss=0.00155 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.444 | L2-Norm(final)=9.368 | 2015.4 samples/s | 31.5 steps/s
[Step=13350 Epoch=51.2] | Loss=0.00146 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.445 | L2-Norm(final)=9.367 | 4717.1 samples/s | 73.7 steps/s
[Step=13400 Epoch=51.3] | Loss=0.00138 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.445 | L2-Norm(final)=9.367 | 4699.3 samples/s | 73.4 steps/s
[Step=13450 Epoch=51.5] | Loss=0.00131 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.444 | L2-Norm(final)=9.366 | 4716.2 samples/s | 73.7 steps/s
[Step=13500 Epoch=51.7] | Loss=0.00124 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.442 | L2-Norm(final)=9.366 | 4749.4 samples/s | 74.2 steps/s
[Step=13550 Epoch=51.9] | Loss=0.00118 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.439 | L2-Norm(final)=9.366 | 2024.8 samples/s | 31.6 steps/s
[Step=13600 Epoch=52.1] | Loss=0.00113 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.435 | L2-Norm(final)=9.365 | 4754.0 samples/s | 74.3 steps/s
[Step=13650 Epoch=52.3] | Loss=0.00108 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.430 | L2-Norm(final)=9.365 | 4666.5 samples/s | 72.9 steps/s
[Step=13700 Epoch=52.5] | Loss=0.00104 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.425 | L2-Norm(final)=9.365 | 4693.2 samples/s | 73.3 steps/s
[Step=13750 Epoch=52.7] | Loss=0.00100 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.419 | L2-Norm(final)=9.365 | 4750.5 samples/s | 74.2 steps/s
[Step=13800 Epoch=52.9] | Loss=0.00096 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.413 | L2-Norm(final)=9.364 | 6363.2 samples/s | 99.4 steps/s
[Step=13850 Epoch=53.1] | Loss=0.00092 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.407 | L2-Norm(final)=9.364 | 1810.4 samples/s | 28.3 steps/s
[Step=13900 Epoch=53.3] | Loss=0.00089 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.400 | L2-Norm(final)=9.364 | 4683.2 samples/s | 73.2 steps/s
[Step=13950 Epoch=53.5] | Loss=0.00086 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.393 | L2-Norm(final)=9.364 | 4766.9 samples/s | 74.5 steps/s
[Step=14000 Epoch=53.6] | Loss=0.00083 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.385 | L2-Norm(final)=9.364 | 4624.1 samples/s | 72.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step14000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=69.3] | Loss=0.00287 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=10.343 | 3756.0 samples/s | 58.7 steps/s
[Step=18050 Epoch=69.5] | Loss=0.00180 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.090 | L2-Norm(final)=10.355 | 5222.1 samples/s | 81.6 steps/s
[Step=18100 Epoch=69.7] | Loss=0.00128 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=10.366 | 5422.9 samples/s | 84.7 steps/s
[Step=18150 Epoch=69.9] | Loss=0.00112 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=10.378 | 5263.6 samples/s | 82.2 steps/s
[Step=18200 Epoch=70.1] | Loss=0.00098 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=10.389 | 5515.0 samples/s | 86.2 steps/s
[Step=18250 Epoch=70.3] | Loss=0.00087 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=10.399 | 6905.9 samples/s | 107.9 steps/s
[Step=18300 Epoch=70.4] | Loss=0.00084 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=10.408 | 1922.5 samples/s | 30.0 steps/s
[Step=18350 Epoch=70.6] | Loss=0.00084 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=10.418 | 5360.4 samples/s | 83.8 steps/s
[Step=18400 Epoch=70.8] | Loss=0.00085 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=10.429 | 5363.3 samples/s | 83.8 steps/s
[Step=18450 Epoch=71.0] | Loss=0.00087 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=10.440 | 5384.5 samples/s | 84.1 steps/s
[Step=18500 Epoch=71.2] | Loss=0.00085 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=10.451 | 6117.0 samples/s | 95.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=71.2] | Loss=0.00140 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=10.558 | 3746.4 samples/s | 58.5 steps/s
[Step=18550 Epoch=71.4] | Loss=0.00155 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.095 | L2-Norm(final)=10.566 | 4687.8 samples/s | 73.2 steps/s
[Step=18600 Epoch=71.6] | Loss=0.00522 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.154 | L2-Norm(final)=10.561 | 4800.8 samples/s | 75.0 steps/s
[Step=18650 Epoch=71.8] | Loss=0.00488 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.224 | L2-Norm(final)=10.545 | 4654.4 samples/s | 72.7 steps/s
[Step=18700 Epoch=72.0] | Loss=0.00449 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.275 | L2-Norm(final)=10.536 | 4658.8 samples/s | 72.8 steps/s
[Step=18750 Epoch=72.2] | Loss=0.00385 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.308 | L2-Norm(final)=10.531 | 6041.1 samples/s | 94.4 steps/s
[Step=18800 Epoch=72.4] | Loss=0.00336 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.329 | L2-Norm(final)=10.528 | 1855.1 samples/s | 29.0 steps/s
[Step=18850 Epoch=72.6] | Loss=0.00292 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.344 | L2-Norm(final)=10.526 | 4740.3 samples/s | 74.1 steps/s
[Step=18900 Epoch=72.8] | Loss=0.00262 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=10.525 | 4614.9 samples/s | 72.1 steps/s
[Step=18950 Epoch=72.9] | Loss=0.00234 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.361 | L2-Norm(final)=10.525 | 4706.6 samples/s | 73.5 steps/s
[Step=19000 Epoch=73.1] | Loss=0.00211 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.363 | L2-Norm(final)=10.525 | 5314.8 samples/s | 83.0 steps/s
[Step=19050 Epoch=73.3] | Loss=0.00192 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.363 | L2-Norm(final)=10.525 | 1920.7 samples/s | 30.0 steps/s
[Step=19100 Epoch=73.5] | Loss=0.00176 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.361 | L2-Norm(final)=10.526 | 4770.7 samples/s | 74.5 steps/s
[Step=19150 Epoch=73.7] | Loss=0.00163 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.357 | L2-Norm(final)=10.526 | 4668.2 samples/s | 72.9 steps/s
[Step=19200 Epoch=73.9] | Loss=0.00151 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.352 | L2-Norm(final)=10.526 | 4716.7 samples/s | 73.7 steps/s
[Step=19250 Epoch=74.1] | Loss=0.00141 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.347 | L2-Norm(final)=10.527 | 4831.0 samples/s | 75.5 steps/s
[Step=19300 Epoch=74.3] | Loss=0.00132 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.340 | L2-Norm(final)=10.527 | 1990.3 samples/s | 31.1 steps/s
[Step=19350 Epoch=74.5] | Loss=0.00125 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.333 | L2-Norm(final)=10.527 | 4769.8 samples/s | 74.5 steps/s
[Step=19400 Epoch=74.7] | Loss=0.00118 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.326 | L2-Norm(final)=10.528 | 4707.0 samples/s | 73.5 steps/s
[Step=19450 Epoch=74.9] | Loss=0.00112 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.318 | L2-Norm(final)=10.528 | 4732.0 samples/s | 73.9 steps/s
[Step=19500 Epoch=75.1] | Loss=0.00106 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.309 | L2-Norm(final)=10.528 | 4694.5 samples/s | 73.4 steps/s
[Step=19550 Epoch=75.3] | Loss=0.00101 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.301 | L2-Norm(final)=10.529 | 2025.8 samples/s | 31.7 steps/s
[Step=19600 Epoch=75.4] | Loss=0.00096 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.292 | L2-Norm(final)=10.529 | 4682.4 samples/s | 73.2 steps/s
[Step=19650 Epoch=75.6] | Loss=0.00092 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.282 | L2-Norm(final)=10.530 | 4698.3 samples/s | 73.4 steps/s
[Step=19700 Epoch=75.8] | Loss=0.00088 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.273 | L2-Norm(final)=10.530 | 4669.2 samples/s | 73.0 steps/s
[Step=19750 Epoch=76.0] | Loss=0.00085 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.263 | L2-Norm(final)=10.531 | 4715.1 samples/s | 73.7 steps/s
[Step=19800 Epoch=76.2] | Loss=0.00082 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.254 | L2-Norm(final)=10.532 | 6887.6 samples/s | 107.6 steps/s
[Step=19850 Epoch=76.4] | Loss=0.00079 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.244 | L2-Norm(final)=10.533 | 1787.2 samples/s | 27.9 steps/s
[Step=19900 Epoch=76.6] | Loss=0.00076 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.234 | L2-Norm(final)=10.533 | 4691.7 samples/s | 73.3 steps/s
[Step=19950 Epoch=76.8] | Loss=0.00073 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.223 | L2-Norm(final)=10.534 | 4702.6 samples/s | 73.5 steps/s
[Step=20000 Epoch=77.0] | Loss=0.00071 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.213 | L2-Norm(final)=10.535 | 4698.4 samples/s | 73.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07311 | acc=0.9643 | tpr=0.9661 | fpr=0.0396 | 4359.9 samples/s | 17.0 steps/s
Avg test loss: 0.07291, Avg test acc: 0.96358, Avg tpr: 0.96550, Avg fpr: 0.04064, total FA: 317

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06597 | acc=0.9656 | tpr=0.9703 | fpr=0.0446 | 4359.4 samples/s | 17.0 steps/s
Avg test loss: 0.07154, Avg test acc: 0.96298, Avg tpr: 0.96806, Avg fpr: 0.04820, total FA: 376

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.06535 | acc=0.3057 | tpr=0.0082 | fpr=0.0483 | 4305.0 samples/s | 16.8 steps/s
Avg test loss: 6.06631, Avg test acc: 0.30275, Avg tpr: 0.00828, Avg fpr: 0.04961, total FA: 387

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.23242 | acc=0.2927 | tpr=0.0167 | fpr=0.1078 | 4362.2 samples/s | 17.0 steps/s
Avg test loss: 6.24462, Avg test acc: 0.29097, Avg tpr: 0.01655, Avg fpr: 0.10550, total FA: 823

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.85240 | acc=0.1573 | tpr=0.6549 | fpr=0.8516 | 4369.9 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.82298 | acc=0.1588 | tpr=0.6695 | fpr=0.8508 | 8641.5 samples/s | 33.8 steps/s
[Step= 150] | Loss=4.82254 | acc=0.1576 | tpr=0.6599 | fpr=0.8517 | 8625.0 samples/s | 33.7 steps/s
[Step= 200] | Loss=4.80671 | acc=0.1582 | tpr=0.6546 | fpr=0.8509 | 8923.0 samples/s | 34.9 steps/s
[Step= 250] | Loss=4.80233 | acc=0.1583 | tpr=0.6376 | fpr=0.8505 | 8429.8 samples/s | 32.9 steps/s
[Step= 300] | Loss=4.79989 | acc=0.1582 | tpr=0.6342 | fpr=0.8504 | 8772.0 samples/s | 34.3 steps/s
[Step= 350] | Loss=4.79428 | acc=0.1575 | tpr=0.6362 | fpr=0.8512 | 8878.1 samples/s | 34.7 steps/s
[Step= 400] | Loss=4.78813 | acc=0.1579 | tpr=0.6395 | fpr=0.8509 | 8179.7 samples/s | 32.0 steps/s
[Step= 450] | Loss=4.78574 | acc=0.1574 | tpr=0.6397 | fpr=0.8513 | 9118.2 samples/s | 35.6 steps/s
[Step= 500] | Loss=4.78787 | acc=0.1575 | tpr=0.6396 | fpr=0.8513 | 8351.2 samples/s | 32.6 steps/s
[Step= 550] | Loss=4.79200 | acc=0.1572 | tpr=0.6363 | fpr=0.8515 | 15244.0 samples/s | 59.5 steps/s
Avg test loss: 4.79280, Avg test acc: 0.15710, Avg tpr: 0.63629, Avg fpr: 0.85161, total FA: 118245

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.11302 | acc=0.1479 | tpr=0.7035 | fpr=0.8621 | 4308.4 samples/s | 16.8 steps/s
[Step= 100] | Loss=5.08910 | acc=0.1473 | tpr=0.6972 | fpr=0.8629 | 8571.6 samples/s | 33.5 steps/s
[Step= 150] | Loss=5.08375 | acc=0.1469 | tpr=0.6888 | fpr=0.8631 | 9159.0 samples/s | 35.8 steps/s
[Step= 200] | Loss=5.06430 | acc=0.1466 | tpr=0.6962 | fpr=0.8634 | 8243.8 samples/s | 32.2 steps/s
[Step= 250] | Loss=5.06034 | acc=0.1467 | tpr=0.6943 | fpr=0.8633 | 8612.8 samples/s | 33.6 steps/s
[Step= 300] | Loss=5.06041 | acc=0.1471 | tpr=0.6975 | fpr=0.8630 | 8832.3 samples/s | 34.5 steps/s
[Step= 350] | Loss=5.05198 | acc=0.1466 | tpr=0.7032 | fpr=0.8635 | 8625.3 samples/s | 33.7 steps/s
[Step= 400] | Loss=5.04865 | acc=0.1467 | tpr=0.7090 | fpr=0.8636 | 8386.3 samples/s | 32.8 steps/s
[Step= 450] | Loss=5.04594 | acc=0.1461 | tpr=0.7128 | fpr=0.8642 | 8638.4 samples/s | 33.7 steps/s
[Step= 500] | Loss=5.04898 | acc=0.1456 | tpr=0.7167 | fpr=0.8647 | 8787.5 samples/s | 34.3 steps/s
[Step= 550] | Loss=5.04900 | acc=0.1457 | tpr=0.7183 | fpr=0.8647 | 15732.9 samples/s | 61.5 steps/s
Avg test loss: 5.04984, Avg test acc: 0.14561, Avg tpr: 0.71870, Avg fpr: 0.86481, total FA: 120077

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.24115 | acc=0.9781 | tpr=0.9381 | fpr=0.0212 | 4391.8 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.25493 | acc=0.9769 | tpr=0.9424 | fpr=0.0224 | 8410.2 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.26554 | acc=0.9760 | tpr=0.9380 | fpr=0.0233 | 8752.0 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.26812 | acc=0.9764 | tpr=0.9432 | fpr=0.0230 | 8549.8 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.26321 | acc=0.9766 | tpr=0.9424 | fpr=0.0228 | 8600.1 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.26716 | acc=0.9762 | tpr=0.9425 | fpr=0.0232 | 8977.9 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.27002 | acc=0.9759 | tpr=0.9443 | fpr=0.0235 | 8333.1 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.27234 | acc=0.9756 | tpr=0.9409 | fpr=0.0238 | 8708.6 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.27682 | acc=0.9754 | tpr=0.9421 | fpr=0.0240 | 8851.1 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.27540 | acc=0.9754 | tpr=0.9427 | fpr=0.0240 | 8900.7 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.27283 | acc=0.9755 | tpr=0.9419 | fpr=0.0239 | 14668.3 samples/s | 57.3 steps/s
Avg test loss: 0.27212, Avg test acc: 0.97551, Avg tpr: 0.94176, Avg fpr: 0.02388, total FA: 3315

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13602 | acc=0.9815 | tpr=0.9381 | fpr=0.0177 | 4350.4 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.14399 | acc=0.9806 | tpr=0.9467 | fpr=0.0188 | 8680.2 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.15019 | acc=0.9795 | tpr=0.9467 | fpr=0.0199 | 8496.1 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.15013 | acc=0.9800 | tpr=0.9454 | fpr=0.0194 | 8759.5 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.14746 | acc=0.9802 | tpr=0.9450 | fpr=0.0192 | 8615.8 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.14910 | acc=0.9801 | tpr=0.9425 | fpr=0.0193 | 8528.1 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.15036 | acc=0.9797 | tpr=0.9436 | fpr=0.0197 | 8658.9 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.15173 | acc=0.9796 | tpr=0.9404 | fpr=0.0197 | 8560.7 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.15563 | acc=0.9794 | tpr=0.9396 | fpr=0.0199 | 8693.7 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.15602 | acc=0.9793 | tpr=0.9388 | fpr=0.0199 | 8468.7 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.15499 | acc=0.9795 | tpr=0.9375 | fpr=0.0197 | 15964.2 samples/s | 62.4 steps/s
Avg test loss: 0.15464, Avg test acc: 0.97953, Avg tpr: 0.93740, Avg fpr: 0.01971, total FA: 2736

server round 18/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=53.6] | Loss=0.01166 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.123 | L2-Norm(final)=9.361 | 3769.8 samples/s | 58.9 steps/s
[Step=14050 Epoch=53.8] | Loss=0.00180 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.120 | L2-Norm(final)=9.366 | 5183.4 samples/s | 81.0 steps/s
[Step=14100 Epoch=54.0] | Loss=0.00113 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=9.375 | 5338.6 samples/s | 83.4 steps/s
[Step=14150 Epoch=54.2] | Loss=0.00120 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=9.384 | 5510.6 samples/s | 86.1 steps/s
[Step=14200 Epoch=54.4] | Loss=0.00109 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=9.394 | 5149.1 samples/s | 80.5 steps/s
[Step=14250 Epoch=54.6] | Loss=0.00128 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=9.404 | 7065.4 samples/s | 110.4 steps/s
[Step=14300 Epoch=54.8] | Loss=0.00125 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=9.413 | 1931.4 samples/s | 30.2 steps/s
[Step=14350 Epoch=55.0] | Loss=0.00129 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=9.422 | 5311.4 samples/s | 83.0 steps/s
[Step=14400 Epoch=55.2] | Loss=0.00129 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=9.432 | 5358.5 samples/s | 83.7 steps/s
[Step=14450 Epoch=55.4] | Loss=0.00129 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.119 | L2-Norm(final)=9.441 | 5362.3 samples/s | 83.8 steps/s
[Step=14500 Epoch=55.6] | Loss=0.00121 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=9.449 | 6048.3 samples/s | 94.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=55.6] | Loss=0.00058 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=9.532 | 3787.5 samples/s | 59.2 steps/s
[Step=14550 Epoch=55.8] | Loss=0.00047 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.130 | L2-Norm(final)=9.541 | 4510.0 samples/s | 70.5 steps/s
[Step=14600 Epoch=55.9] | Loss=0.00042 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.126 | L2-Norm(final)=9.547 | 4709.3 samples/s | 73.6 steps/s
[Step=14650 Epoch=56.1] | Loss=0.00054 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.122 | L2-Norm(final)=9.551 | 4735.9 samples/s | 74.0 steps/s
[Step=14700 Epoch=56.3] | Loss=0.00057 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.124 | L2-Norm(final)=9.552 | 4730.9 samples/s | 73.9 steps/s
[Step=14750 Epoch=56.5] | Loss=0.00055 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.129 | L2-Norm(final)=9.554 | 5886.0 samples/s | 92.0 steps/s
[Step=14800 Epoch=56.7] | Loss=0.00060 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.136 | L2-Norm(final)=9.556 | 1845.4 samples/s | 28.8 steps/s
[Step=14850 Epoch=56.9] | Loss=0.00279 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.160 | L2-Norm(final)=9.553 | 4669.1 samples/s | 73.0 steps/s
[Step=14900 Epoch=57.1] | Loss=0.00273 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.200 | L2-Norm(final)=9.542 | 4736.5 samples/s | 74.0 steps/s
[Step=14950 Epoch=57.3] | Loss=0.00257 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.231 | L2-Norm(final)=9.533 | 4614.1 samples/s | 72.1 steps/s
[Step=15000 Epoch=57.5] | Loss=0.00244 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.255 | L2-Norm(final)=9.527 | 5119.9 samples/s | 80.0 steps/s
[Step=15050 Epoch=57.7] | Loss=0.00223 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.274 | L2-Norm(final)=9.522 | 1938.5 samples/s | 30.3 steps/s
[Step=15100 Epoch=57.9] | Loss=0.00205 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.287 | L2-Norm(final)=9.519 | 4828.2 samples/s | 75.4 steps/s
[Step=15150 Epoch=58.0] | Loss=0.00190 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.297 | L2-Norm(final)=9.516 | 4616.5 samples/s | 72.1 steps/s
[Step=15200 Epoch=58.2] | Loss=0.00176 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.303 | L2-Norm(final)=9.513 | 4749.3 samples/s | 74.2 steps/s
[Step=15250 Epoch=58.4] | Loss=0.00165 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.308 | L2-Norm(final)=9.512 | 4665.8 samples/s | 72.9 steps/s
[Step=15300 Epoch=58.6] | Loss=0.00155 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.310 | L2-Norm(final)=9.510 | 2008.4 samples/s | 31.4 steps/s
[Step=15350 Epoch=58.8] | Loss=0.00146 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.311 | L2-Norm(final)=9.509 | 4745.4 samples/s | 74.1 steps/s
[Step=15400 Epoch=59.0] | Loss=0.00138 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.310 | L2-Norm(final)=9.508 | 4753.4 samples/s | 74.3 steps/s
[Step=15450 Epoch=59.2] | Loss=0.00130 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.308 | L2-Norm(final)=9.507 | 4664.6 samples/s | 72.9 steps/s
[Step=15500 Epoch=59.4] | Loss=0.00124 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.306 | L2-Norm(final)=9.506 | 4699.5 samples/s | 73.4 steps/s
[Step=15550 Epoch=59.6] | Loss=0.00118 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.302 | L2-Norm(final)=9.506 | 2026.3 samples/s | 31.7 steps/s
[Step=15600 Epoch=59.8] | Loss=0.00113 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.298 | L2-Norm(final)=9.505 | 4715.0 samples/s | 73.7 steps/s
[Step=15650 Epoch=60.0] | Loss=0.00108 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.293 | L2-Norm(final)=9.505 | 4738.4 samples/s | 74.0 steps/s
[Step=15700 Epoch=60.2] | Loss=0.00103 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.288 | L2-Norm(final)=9.505 | 4696.0 samples/s | 73.4 steps/s
[Step=15750 Epoch=60.3] | Loss=0.00099 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.282 | L2-Norm(final)=9.504 | 4674.9 samples/s | 73.0 steps/s
[Step=15800 Epoch=60.5] | Loss=0.00095 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.276 | L2-Norm(final)=9.504 | 6331.6 samples/s | 98.9 steps/s
[Step=15850 Epoch=60.7] | Loss=0.00092 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.269 | L2-Norm(final)=9.504 | 1775.1 samples/s | 27.7 steps/s
[Step=15900 Epoch=60.9] | Loss=0.00089 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.262 | L2-Norm(final)=9.504 | 4618.3 samples/s | 72.2 steps/s
[Step=15950 Epoch=61.1] | Loss=0.00086 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.255 | L2-Norm(final)=9.504 | 4678.4 samples/s | 73.1 steps/s
[Step=16000 Epoch=61.3] | Loss=0.00083 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.247 | L2-Norm(final)=9.504 | 4771.2 samples/s | 74.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step16000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=77.0] | Loss=0.00029 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=10.559 | 3913.8 samples/s | 61.2 steps/s
[Step=20050 Epoch=77.2] | Loss=0.00088 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=10.566 | 4875.6 samples/s | 76.2 steps/s
[Step=20100 Epoch=77.4] | Loss=0.00103 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=10.581 | 5370.6 samples/s | 83.9 steps/s
[Step=20150 Epoch=77.6] | Loss=0.00084 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=10.595 | 5285.0 samples/s | 82.6 steps/s
[Step=20200 Epoch=77.8] | Loss=0.00080 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=10.608 | 5413.5 samples/s | 84.6 steps/s
[Step=20250 Epoch=78.0] | Loss=0.00089 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=10.621 | 7101.6 samples/s | 111.0 steps/s
[Step=20300 Epoch=78.1] | Loss=0.00079 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=10.634 | 1941.4 samples/s | 30.3 steps/s
[Step=20350 Epoch=78.3] | Loss=0.00081 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=10.647 | 5275.2 samples/s | 82.4 steps/s
[Step=20400 Epoch=78.5] | Loss=0.00081 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=10.660 | 5326.4 samples/s | 83.2 steps/s
[Step=20450 Epoch=78.7] | Loss=0.00088 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=10.673 | 5353.6 samples/s | 83.6 steps/s
[Step=20500 Epoch=78.9] | Loss=0.00083 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=10.686 | 6161.5 samples/s | 96.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=78.9] | Loss=0.00069 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.118 | L2-Norm(final)=10.816 | 3711.5 samples/s | 58.0 steps/s
[Step=20550 Epoch=79.1] | Loss=0.00146 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.161 | L2-Norm(final)=10.823 | 4671.3 samples/s | 73.0 steps/s
[Step=20600 Epoch=79.3] | Loss=0.00090 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.183 | L2-Norm(final)=10.830 | 4718.7 samples/s | 73.7 steps/s
[Step=20650 Epoch=79.5] | Loss=0.00082 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.191 | L2-Norm(final)=10.833 | 4717.6 samples/s | 73.7 steps/s
[Step=20700 Epoch=79.7] | Loss=0.00251 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.204 | L2-Norm(final)=10.827 | 4674.3 samples/s | 73.0 steps/s
[Step=20750 Epoch=79.9] | Loss=0.00312 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.245 | L2-Norm(final)=10.810 | 6037.5 samples/s | 94.3 steps/s
[Step=20800 Epoch=80.1] | Loss=0.00298 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.282 | L2-Norm(final)=10.797 | 1866.3 samples/s | 29.2 steps/s
[Step=20850 Epoch=80.3] | Loss=0.00264 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.306 | L2-Norm(final)=10.787 | 4604.6 samples/s | 71.9 steps/s
[Step=20900 Epoch=80.5] | Loss=0.00235 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.324 | L2-Norm(final)=10.781 | 4781.7 samples/s | 74.7 steps/s
[Step=20950 Epoch=80.6] | Loss=0.00220 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.337 | L2-Norm(final)=10.775 | 4617.8 samples/s | 72.2 steps/s
[Step=21000 Epoch=80.8] | Loss=0.00214 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.347 | L2-Norm(final)=10.771 | 5375.8 samples/s | 84.0 steps/s
[Step=21050 Epoch=81.0] | Loss=0.00233 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.361 | L2-Norm(final)=10.766 | 1941.6 samples/s | 30.3 steps/s
[Step=21100 Epoch=81.2] | Loss=0.00217 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.374 | L2-Norm(final)=10.762 | 4591.2 samples/s | 71.7 steps/s
[Step=21150 Epoch=81.4] | Loss=0.00201 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.384 | L2-Norm(final)=10.759 | 4729.0 samples/s | 73.9 steps/s
[Step=21200 Epoch=81.6] | Loss=0.00187 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.392 | L2-Norm(final)=10.756 | 4733.2 samples/s | 74.0 steps/s
[Step=21250 Epoch=81.8] | Loss=0.00179 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.397 | L2-Norm(final)=10.754 | 4748.4 samples/s | 74.2 steps/s
[Step=21300 Epoch=82.0] | Loss=0.00169 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.400 | L2-Norm(final)=10.752 | 1992.7 samples/s | 31.1 steps/s
[Step=21350 Epoch=82.2] | Loss=0.00159 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.402 | L2-Norm(final)=10.750 | 4817.0 samples/s | 75.3 steps/s
[Step=21400 Epoch=82.4] | Loss=0.00150 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.403 | L2-Norm(final)=10.749 | 4767.4 samples/s | 74.5 steps/s
[Step=21450 Epoch=82.6] | Loss=0.00142 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.402 | L2-Norm(final)=10.747 | 4640.9 samples/s | 72.5 steps/s
[Step=21500 Epoch=82.8] | Loss=0.00135 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.400 | L2-Norm(final)=10.746 | 4676.0 samples/s | 73.1 steps/s
[Step=21550 Epoch=83.0] | Loss=0.00129 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.398 | L2-Norm(final)=10.745 | 2034.4 samples/s | 31.8 steps/s
[Step=21600 Epoch=83.1] | Loss=0.00123 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.394 | L2-Norm(final)=10.744 | 4668.4 samples/s | 72.9 steps/s
[Step=21650 Epoch=83.3] | Loss=0.00118 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.391 | L2-Norm(final)=10.743 | 4727.5 samples/s | 73.9 steps/s
[Step=21700 Epoch=83.5] | Loss=0.00113 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.386 | L2-Norm(final)=10.743 | 4702.2 samples/s | 73.5 steps/s
[Step=21750 Epoch=83.7] | Loss=0.00108 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.381 | L2-Norm(final)=10.742 | 4689.0 samples/s | 73.3 steps/s
[Step=21800 Epoch=83.9] | Loss=0.00104 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.376 | L2-Norm(final)=10.742 | 6996.7 samples/s | 109.3 steps/s
[Step=21850 Epoch=84.1] | Loss=0.00100 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.370 | L2-Norm(final)=10.741 | 1761.2 samples/s | 27.5 steps/s
[Step=21900 Epoch=84.3] | Loss=0.00097 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.364 | L2-Norm(final)=10.741 | 4753.1 samples/s | 74.3 steps/s
[Step=21950 Epoch=84.5] | Loss=0.00093 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.357 | L2-Norm(final)=10.741 | 4670.5 samples/s | 73.0 steps/s
[Step=22000 Epoch=84.7] | Loss=0.00090 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.350 | L2-Norm(final)=10.741 | 4679.3 samples/s | 73.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step22000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07311 | acc=0.9643 | tpr=0.9661 | fpr=0.0396 | 4296.6 samples/s | 16.8 steps/s
Avg test loss: 0.07291, Avg test acc: 0.96358, Avg tpr: 0.96550, Avg fpr: 0.04064, total FA: 317

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06597 | acc=0.9656 | tpr=0.9703 | fpr=0.0446 | 4376.6 samples/s | 17.1 steps/s
Avg test loss: 0.07154, Avg test acc: 0.96298, Avg tpr: 0.96806, Avg fpr: 0.04820, total FA: 376

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.56367 | acc=0.3040 | tpr=0.0045 | fpr=0.0456 | 4313.0 samples/s | 16.8 steps/s
Avg test loss: 6.55270, Avg test acc: 0.30183, Avg tpr: 0.00565, Avg fpr: 0.04679, total FA: 365

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.77030 | acc=0.3128 | tpr=0.0212 | fpr=0.0540 | 4353.7 samples/s | 17.0 steps/s
Avg test loss: 6.77611, Avg test acc: 0.31100, Avg tpr: 0.02168, Avg fpr: 0.05269, total FA: 411

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.85240 | acc=0.1573 | tpr=0.6549 | fpr=0.8516 | 4343.4 samples/s | 17.0 steps/s
[Step= 100] | Loss=4.82298 | acc=0.1588 | tpr=0.6695 | fpr=0.8508 | 9080.4 samples/s | 35.5 steps/s
[Step= 150] | Loss=4.82254 | acc=0.1576 | tpr=0.6599 | fpr=0.8517 | 8251.2 samples/s | 32.2 steps/s
[Step= 200] | Loss=4.80671 | acc=0.1582 | tpr=0.6546 | fpr=0.8509 | 8605.4 samples/s | 33.6 steps/s
[Step= 250] | Loss=4.80233 | acc=0.1583 | tpr=0.6376 | fpr=0.8505 | 8806.6 samples/s | 34.4 steps/s
[Step= 300] | Loss=4.79989 | acc=0.1582 | tpr=0.6342 | fpr=0.8504 | 8363.9 samples/s | 32.7 steps/s
[Step= 350] | Loss=4.79428 | acc=0.1575 | tpr=0.6362 | fpr=0.8512 | 8799.7 samples/s | 34.4 steps/s
[Step= 400] | Loss=4.78813 | acc=0.1579 | tpr=0.6395 | fpr=0.8509 | 8713.7 samples/s | 34.0 steps/s
[Step= 450] | Loss=4.78574 | acc=0.1574 | tpr=0.6397 | fpr=0.8513 | 9100.7 samples/s | 35.5 steps/s
[Step= 500] | Loss=4.78787 | acc=0.1575 | tpr=0.6396 | fpr=0.8513 | 8571.5 samples/s | 33.5 steps/s
[Step= 550] | Loss=4.79200 | acc=0.1572 | tpr=0.6363 | fpr=0.8515 | 14398.8 samples/s | 56.2 steps/s
Avg test loss: 4.79280, Avg test acc: 0.15710, Avg tpr: 0.63629, Avg fpr: 0.85161, total FA: 118245

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.11302 | acc=0.1479 | tpr=0.7035 | fpr=0.8621 | 4282.6 samples/s | 16.7 steps/s
[Step= 100] | Loss=5.08910 | acc=0.1473 | tpr=0.6972 | fpr=0.8629 | 8937.1 samples/s | 34.9 steps/s
[Step= 150] | Loss=5.08375 | acc=0.1469 | tpr=0.6888 | fpr=0.8631 | 8501.4 samples/s | 33.2 steps/s
[Step= 200] | Loss=5.06430 | acc=0.1466 | tpr=0.6962 | fpr=0.8634 | 8632.4 samples/s | 33.7 steps/s
[Step= 250] | Loss=5.06034 | acc=0.1467 | tpr=0.6943 | fpr=0.8633 | 8968.2 samples/s | 35.0 steps/s
[Step= 300] | Loss=5.06041 | acc=0.1471 | tpr=0.6975 | fpr=0.8630 | 8614.0 samples/s | 33.6 steps/s
[Step= 350] | Loss=5.05198 | acc=0.1466 | tpr=0.7032 | fpr=0.8635 | 8611.2 samples/s | 33.6 steps/s
[Step= 400] | Loss=5.04865 | acc=0.1467 | tpr=0.7090 | fpr=0.8636 | 8556.3 samples/s | 33.4 steps/s
[Step= 450] | Loss=5.04594 | acc=0.1461 | tpr=0.7128 | fpr=0.8642 | 8708.4 samples/s | 34.0 steps/s
[Step= 500] | Loss=5.04898 | acc=0.1456 | tpr=0.7167 | fpr=0.8647 | 8667.4 samples/s | 33.9 steps/s
[Step= 550] | Loss=5.04900 | acc=0.1457 | tpr=0.7183 | fpr=0.8647 | 15302.0 samples/s | 59.8 steps/s
Avg test loss: 5.04984, Avg test acc: 0.14561, Avg tpr: 0.71870, Avg fpr: 0.86481, total FA: 120077

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14158 | acc=0.9799 | tpr=0.9248 | fpr=0.0191 | 4334.0 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.15406 | acc=0.9786 | tpr=0.9424 | fpr=0.0207 | 8616.2 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.16077 | acc=0.9781 | tpr=0.9452 | fpr=0.0213 | 8686.7 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.16282 | acc=0.9784 | tpr=0.9497 | fpr=0.0211 | 8550.0 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.16100 | acc=0.9788 | tpr=0.9502 | fpr=0.0206 | 8952.6 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.16312 | acc=0.9786 | tpr=0.9476 | fpr=0.0209 | 8390.9 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.16466 | acc=0.9784 | tpr=0.9468 | fpr=0.0210 | 8696.6 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.16648 | acc=0.9781 | tpr=0.9447 | fpr=0.0213 | 8658.6 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.16923 | acc=0.9780 | tpr=0.9445 | fpr=0.0214 | 8676.1 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.16854 | acc=0.9781 | tpr=0.9463 | fpr=0.0213 | 8637.4 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.16750 | acc=0.9783 | tpr=0.9439 | fpr=0.0211 | 14942.7 samples/s | 58.4 steps/s
Avg test loss: 0.16708, Avg test acc: 0.97828, Avg tpr: 0.94374, Avg fpr: 0.02110, total FA: 2929

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.20210 | acc=0.9823 | tpr=0.9469 | fpr=0.0171 | 4336.9 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.21598 | acc=0.9809 | tpr=0.9574 | fpr=0.0186 | 8515.0 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.22615 | acc=0.9798 | tpr=0.9553 | fpr=0.0198 | 8726.4 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.22924 | acc=0.9798 | tpr=0.9574 | fpr=0.0198 | 8597.4 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.22416 | acc=0.9799 | tpr=0.9563 | fpr=0.0197 | 8985.9 samples/s | 35.1 steps/s
[Step= 300] | Loss=0.22835 | acc=0.9796 | tpr=0.9556 | fpr=0.0200 | 8422.5 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.23161 | acc=0.9794 | tpr=0.9549 | fpr=0.0202 | 8687.5 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.23393 | acc=0.9791 | tpr=0.9524 | fpr=0.0204 | 8943.5 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.23828 | acc=0.9789 | tpr=0.9508 | fpr=0.0205 | 8466.4 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.23788 | acc=0.9789 | tpr=0.9515 | fpr=0.0206 | 9160.0 samples/s | 35.8 steps/s
[Step= 550] | Loss=0.23629 | acc=0.9790 | tpr=0.9503 | fpr=0.0205 | 14515.7 samples/s | 56.7 steps/s
Avg test loss: 0.23572, Avg test acc: 0.97904, Avg tpr: 0.95048, Avg fpr: 0.02044, total FA: 2838

server round 19/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=19.6] | Loss=0.01515 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.147 | L2-Norm(final)=6.285 | 4020.7 samples/s | 62.8 steps/s
[Step=10050 Epoch=19.6] | Loss=0.06667 | Reg=0.00200 | acc=0.9219 | L2-Norm=14.153 | L2-Norm(final)=6.300 | 5175.6 samples/s | 80.9 steps/s
[Step=10100 Epoch=19.7] | Loss=0.05765 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.154 | L2-Norm(final)=6.326 | 5711.8 samples/s | 89.2 steps/s
[Step=10150 Epoch=19.8] | Loss=0.05318 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.155 | L2-Norm(final)=6.358 | 5848.4 samples/s | 91.4 steps/s
[Step=10200 Epoch=19.9] | Loss=0.05054 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.155 | L2-Norm(final)=6.394 | 5482.2 samples/s | 85.7 steps/s
[Step=10250 Epoch=20.0] | Loss=0.04870 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.155 | L2-Norm(final)=6.431 | 5823.7 samples/s | 91.0 steps/s
[Step=10300 Epoch=20.1] | Loss=0.04709 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.155 | L2-Norm(final)=6.467 | 5565.0 samples/s | 87.0 steps/s
[Step=10350 Epoch=20.2] | Loss=0.04653 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.155 | L2-Norm(final)=6.504 | 5690.0 samples/s | 88.9 steps/s
[Step=10400 Epoch=20.3] | Loss=0.04648 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.155 | L2-Norm(final)=6.540 | 5750.9 samples/s | 89.9 steps/s
[Step=10450 Epoch=20.4] | Loss=0.04577 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.155 | L2-Norm(final)=6.574 | 5667.9 samples/s | 88.6 steps/s
[Step=10500 Epoch=20.5] | Loss=0.04558 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.155 | L2-Norm(final)=6.609 | 7308.7 samples/s | 114.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=20.5] | Loss=0.06021 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.155 | L2-Norm(final)=6.953 | 3924.6 samples/s | 61.3 steps/s
[Step=10550 Epoch=20.6] | Loss=0.03035 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.232 | L2-Norm(final)=6.966 | 4736.2 samples/s | 74.0 steps/s
[Step=10600 Epoch=20.7] | Loss=0.02785 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.297 | L2-Norm(final)=6.967 | 4928.6 samples/s | 77.0 steps/s
[Step=10650 Epoch=20.8] | Loss=0.02883 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.341 | L2-Norm(final)=6.964 | 4946.1 samples/s | 77.3 steps/s
[Step=10700 Epoch=20.9] | Loss=0.02855 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.375 | L2-Norm(final)=6.959 | 4927.9 samples/s | 77.0 steps/s
[Step=10750 Epoch=21.0] | Loss=0.02850 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.404 | L2-Norm(final)=6.955 | 4968.5 samples/s | 77.6 steps/s
[Step=10800 Epoch=21.1] | Loss=0.02809 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.432 | L2-Norm(final)=6.952 | 4934.6 samples/s | 77.1 steps/s
[Step=10850 Epoch=21.2] | Loss=0.02728 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.458 | L2-Norm(final)=6.950 | 4943.8 samples/s | 77.2 steps/s
[Step=10900 Epoch=21.3] | Loss=0.02684 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.482 | L2-Norm(final)=6.949 | 4967.2 samples/s | 77.6 steps/s
[Step=10950 Epoch=21.4] | Loss=0.02637 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.503 | L2-Norm(final)=6.948 | 4966.7 samples/s | 77.6 steps/s
[Step=11000 Epoch=21.5] | Loss=0.02530 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.523 | L2-Norm(final)=6.948 | 6128.7 samples/s | 95.8 steps/s
[Step=11050 Epoch=21.6] | Loss=0.02457 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.541 | L2-Norm(final)=6.947 | 1917.9 samples/s | 30.0 steps/s
[Step=11100 Epoch=21.7] | Loss=0.02377 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.558 | L2-Norm(final)=6.948 | 4944.7 samples/s | 77.3 steps/s
[Step=11150 Epoch=21.8] | Loss=0.02298 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.574 | L2-Norm(final)=6.948 | 4929.1 samples/s | 77.0 steps/s
[Step=11200 Epoch=21.9] | Loss=0.02238 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.588 | L2-Norm(final)=6.949 | 4942.3 samples/s | 77.2 steps/s
[Step=11250 Epoch=22.0] | Loss=0.02183 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.602 | L2-Norm(final)=6.950 | 5032.5 samples/s | 78.6 steps/s
[Step=11300 Epoch=22.1] | Loss=0.02126 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.615 | L2-Norm(final)=6.951 | 4902.6 samples/s | 76.6 steps/s
[Step=11350 Epoch=22.2] | Loss=0.02094 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.627 | L2-Norm(final)=6.952 | 4960.9 samples/s | 77.5 steps/s
[Step=11400 Epoch=22.3] | Loss=0.02069 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.638 | L2-Norm(final)=6.952 | 5028.5 samples/s | 78.6 steps/s
[Step=11450 Epoch=22.4] | Loss=0.02044 | Reg=0.00215 | acc=0.9531 | L2-Norm=14.648 | L2-Norm(final)=6.952 | 4969.2 samples/s | 77.6 steps/s
[Step=11500 Epoch=22.5] | Loss=0.02016 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.659 | L2-Norm(final)=6.953 | 5366.9 samples/s | 83.9 steps/s
[Step=11550 Epoch=22.6] | Loss=0.01991 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.669 | L2-Norm(final)=6.953 | 2006.7 samples/s | 31.4 steps/s
[Step=11600 Epoch=22.7] | Loss=0.01961 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.679 | L2-Norm(final)=6.954 | 5002.5 samples/s | 78.2 steps/s
[Step=11650 Epoch=22.8] | Loss=0.01923 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.688 | L2-Norm(final)=6.955 | 4932.5 samples/s | 77.1 steps/s
[Step=11700 Epoch=22.9] | Loss=0.01893 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.697 | L2-Norm(final)=6.955 | 4936.8 samples/s | 77.1 steps/s
[Step=11750 Epoch=23.0] | Loss=0.01875 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.705 | L2-Norm(final)=6.956 | 4954.8 samples/s | 77.4 steps/s
[Step=11800 Epoch=23.1] | Loss=0.01849 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.714 | L2-Norm(final)=6.957 | 4984.3 samples/s | 77.9 steps/s
[Step=11850 Epoch=23.2] | Loss=0.01826 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.722 | L2-Norm(final)=6.958 | 4971.3 samples/s | 77.7 steps/s
[Step=11900 Epoch=23.3] | Loss=0.01816 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.730 | L2-Norm(final)=6.959 | 4960.5 samples/s | 77.5 steps/s
[Step=11950 Epoch=23.4] | Loss=0.01807 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.739 | L2-Norm(final)=6.960 | 5014.2 samples/s | 78.3 steps/s
[Step=12000 Epoch=23.5] | Loss=0.01781 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.747 | L2-Norm(final)=6.960 | 4937.6 samples/s | 77.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step12000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=84.7] | Loss=0.00024 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.147 | L2-Norm(final)=10.739 | 3700.8 samples/s | 57.8 steps/s
[Step=22050 Epoch=84.9] | Loss=0.00084 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.144 | L2-Norm(final)=10.751 | 5380.8 samples/s | 84.1 steps/s
[Step=22100 Epoch=85.1] | Loss=0.00080 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.144 | L2-Norm(final)=10.766 | 5336.4 samples/s | 83.4 steps/s
[Step=22150 Epoch=85.3] | Loss=0.00075 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.144 | L2-Norm(final)=10.780 | 5410.5 samples/s | 84.5 steps/s
[Step=22200 Epoch=85.5] | Loss=0.00070 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.144 | L2-Norm(final)=10.793 | 5294.5 samples/s | 82.7 steps/s
[Step=22250 Epoch=85.6] | Loss=0.00072 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.143 | L2-Norm(final)=10.805 | 7119.5 samples/s | 111.2 steps/s
[Step=22300 Epoch=85.8] | Loss=0.00071 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.143 | L2-Norm(final)=10.817 | 1935.8 samples/s | 30.2 steps/s
[Step=22350 Epoch=86.0] | Loss=0.00068 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.143 | L2-Norm(final)=10.828 | 5321.1 samples/s | 83.1 steps/s
[Step=22400 Epoch=86.2] | Loss=0.00072 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.143 | L2-Norm(final)=10.841 | 5433.6 samples/s | 84.9 steps/s
[Step=22450 Epoch=86.4] | Loss=0.00072 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.143 | L2-Norm(final)=10.853 | 5345.9 samples/s | 83.5 steps/s
[Step=22500 Epoch=86.6] | Loss=0.00069 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.143 | L2-Norm(final)=10.866 | 6182.9 samples/s | 96.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=86.6] | Loss=0.00066 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.143 | L2-Norm(final)=10.990 | 3706.6 samples/s | 57.9 steps/s
[Step=22550 Epoch=86.8] | Loss=0.00077 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.148 | L2-Norm(final)=10.996 | 4674.0 samples/s | 73.0 steps/s
[Step=22600 Epoch=87.0] | Loss=0.00077 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.164 | L2-Norm(final)=11.002 | 4707.3 samples/s | 73.6 steps/s
[Step=22650 Epoch=87.2] | Loss=0.00223 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.203 | L2-Norm(final)=11.002 | 4691.8 samples/s | 73.3 steps/s
[Step=22700 Epoch=87.4] | Loss=0.00207 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.244 | L2-Norm(final)=10.996 | 4692.2 samples/s | 73.3 steps/s
[Step=22750 Epoch=87.6] | Loss=0.00247 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.276 | L2-Norm(final)=10.991 | 6063.8 samples/s | 94.7 steps/s
[Step=22800 Epoch=87.8] | Loss=0.00242 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.306 | L2-Norm(final)=10.983 | 1845.3 samples/s | 28.8 steps/s
[Step=22850 Epoch=88.0] | Loss=0.00212 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.328 | L2-Norm(final)=10.978 | 4643.6 samples/s | 72.6 steps/s
[Step=22900 Epoch=88.2] | Loss=0.00187 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.343 | L2-Norm(final)=10.975 | 4774.7 samples/s | 74.6 steps/s
[Step=22950 Epoch=88.3] | Loss=0.00176 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.353 | L2-Norm(final)=10.973 | 4639.4 samples/s | 72.5 steps/s
[Step=23000 Epoch=88.5] | Loss=0.00169 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.359 | L2-Norm(final)=10.971 | 5336.3 samples/s | 83.4 steps/s
[Step=23050 Epoch=88.7] | Loss=0.00155 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.365 | L2-Norm(final)=10.970 | 1912.4 samples/s | 29.9 steps/s
[Step=23100 Epoch=88.9] | Loss=0.00144 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.369 | L2-Norm(final)=10.969 | 4603.8 samples/s | 71.9 steps/s
[Step=23150 Epoch=89.1] | Loss=0.00133 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.371 | L2-Norm(final)=10.968 | 4586.9 samples/s | 71.7 steps/s
[Step=23200 Epoch=89.3] | Loss=0.00124 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.371 | L2-Norm(final)=10.968 | 4624.0 samples/s | 72.3 steps/s
[Step=23250 Epoch=89.5] | Loss=0.00116 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.370 | L2-Norm(final)=10.967 | 4811.9 samples/s | 75.2 steps/s
[Step=23300 Epoch=89.7] | Loss=0.00109 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.367 | L2-Norm(final)=10.967 | 2004.2 samples/s | 31.3 steps/s
[Step=23350 Epoch=89.9] | Loss=0.00102 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.364 | L2-Norm(final)=10.967 | 4753.7 samples/s | 74.3 steps/s
[Step=23400 Epoch=90.1] | Loss=0.00097 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.359 | L2-Norm(final)=10.967 | 4734.5 samples/s | 74.0 steps/s
[Step=23450 Epoch=90.3] | Loss=0.00092 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.354 | L2-Norm(final)=10.967 | 4666.5 samples/s | 72.9 steps/s
[Step=23500 Epoch=90.5] | Loss=0.00087 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.348 | L2-Norm(final)=10.967 | 4719.7 samples/s | 73.7 steps/s
[Step=23550 Epoch=90.7] | Loss=0.00083 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.342 | L2-Norm(final)=10.966 | 2033.1 samples/s | 31.8 steps/s
[Step=23600 Epoch=90.8] | Loss=0.00079 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.335 | L2-Norm(final)=10.966 | 4714.3 samples/s | 73.7 steps/s
[Step=23650 Epoch=91.0] | Loss=0.00076 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.328 | L2-Norm(final)=10.966 | 4702.7 samples/s | 73.5 steps/s
[Step=23700 Epoch=91.2] | Loss=0.00073 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.321 | L2-Norm(final)=10.966 | 4740.0 samples/s | 74.1 steps/s
[Step=23750 Epoch=91.4] | Loss=0.00070 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.313 | L2-Norm(final)=10.966 | 4657.4 samples/s | 72.8 steps/s
[Step=23800 Epoch=91.6] | Loss=0.00067 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.305 | L2-Norm(final)=10.966 | 6936.7 samples/s | 108.4 steps/s
[Step=23850 Epoch=91.8] | Loss=0.00065 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.297 | L2-Norm(final)=10.966 | 1784.1 samples/s | 27.9 steps/s
[Step=23900 Epoch=92.0] | Loss=0.00062 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.288 | L2-Norm(final)=10.966 | 4731.6 samples/s | 73.9 steps/s
[Step=23950 Epoch=92.2] | Loss=0.00060 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.280 | L2-Norm(final)=10.966 | 4785.4 samples/s | 74.8 steps/s
[Step=24000 Epoch=92.4] | Loss=0.00058 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.271 | L2-Norm(final)=10.966 | 4619.1 samples/s | 72.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07311 | acc=0.9643 | tpr=0.9661 | fpr=0.0396 | 4311.9 samples/s | 16.8 steps/s
Avg test loss: 0.07291, Avg test acc: 0.96358, Avg tpr: 0.96550, Avg fpr: 0.04064, total FA: 317

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07313 | acc=0.9673 | tpr=0.9819 | fpr=0.0644 | 4357.4 samples/s | 17.0 steps/s
Avg test loss: 0.07518, Avg test acc: 0.96534, Avg tpr: 0.97948, Avg fpr: 0.06576, total FA: 513

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.56367 | acc=0.3040 | tpr=0.0045 | fpr=0.0456 | 4373.5 samples/s | 17.1 steps/s
Avg test loss: 6.55270, Avg test acc: 0.30183, Avg tpr: 0.00565, Avg fpr: 0.04679, total FA: 365

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=8.10420 | acc=0.3094 | tpr=0.0050 | fpr=0.0297 | 4317.7 samples/s | 16.9 steps/s
Avg test loss: 8.11960, Avg test acc: 0.30627, Avg tpr: 0.00536, Avg fpr: 0.03192, total FA: 249

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.85240 | acc=0.1573 | tpr=0.6549 | fpr=0.8516 | 4304.0 samples/s | 16.8 steps/s
[Step= 100] | Loss=4.82298 | acc=0.1588 | tpr=0.6695 | fpr=0.8508 | 8811.0 samples/s | 34.4 steps/s
[Step= 150] | Loss=4.82254 | acc=0.1576 | tpr=0.6599 | fpr=0.8517 | 8821.6 samples/s | 34.5 steps/s
[Step= 200] | Loss=4.80671 | acc=0.1582 | tpr=0.6546 | fpr=0.8509 | 8659.9 samples/s | 33.8 steps/s
[Step= 250] | Loss=4.80233 | acc=0.1583 | tpr=0.6376 | fpr=0.8505 | 8616.9 samples/s | 33.7 steps/s
[Step= 300] | Loss=4.79989 | acc=0.1582 | tpr=0.6342 | fpr=0.8504 | 9025.0 samples/s | 35.3 steps/s
[Step= 350] | Loss=4.79428 | acc=0.1575 | tpr=0.6362 | fpr=0.8512 | 8288.9 samples/s | 32.4 steps/s
[Step= 400] | Loss=4.78813 | acc=0.1579 | tpr=0.6395 | fpr=0.8509 | 8606.5 samples/s | 33.6 steps/s
[Step= 450] | Loss=4.78574 | acc=0.1574 | tpr=0.6397 | fpr=0.8513 | 8692.2 samples/s | 34.0 steps/s
[Step= 500] | Loss=4.78787 | acc=0.1575 | tpr=0.6396 | fpr=0.8513 | 8777.5 samples/s | 34.3 steps/s
[Step= 550] | Loss=4.79200 | acc=0.1572 | tpr=0.6363 | fpr=0.8515 | 14971.8 samples/s | 58.5 steps/s
Avg test loss: 4.79280, Avg test acc: 0.15710, Avg tpr: 0.63629, Avg fpr: 0.85161, total FA: 118245

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.18737 | acc=0.1368 | tpr=0.7743 | fpr=0.8747 | 4346.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=6.16117 | acc=0.1395 | tpr=0.7719 | fpr=0.8723 | 9132.5 samples/s | 35.7 steps/s
[Step= 150] | Loss=6.14809 | acc=0.1397 | tpr=0.7752 | fpr=0.8720 | 8099.1 samples/s | 31.6 steps/s
[Step= 200] | Loss=6.12916 | acc=0.1397 | tpr=0.7716 | fpr=0.8718 | 9017.9 samples/s | 35.2 steps/s
[Step= 250] | Loss=6.12228 | acc=0.1393 | tpr=0.7642 | fpr=0.8721 | 8844.6 samples/s | 34.5 steps/s
[Step= 300] | Loss=6.12076 | acc=0.1401 | tpr=0.7658 | fpr=0.8713 | 8253.3 samples/s | 32.2 steps/s
[Step= 350] | Loss=6.11580 | acc=0.1395 | tpr=0.7708 | fpr=0.8720 | 8774.0 samples/s | 34.3 steps/s
[Step= 400] | Loss=6.10982 | acc=0.1394 | tpr=0.7735 | fpr=0.8721 | 8311.7 samples/s | 32.5 steps/s
[Step= 450] | Loss=6.10721 | acc=0.1393 | tpr=0.7799 | fpr=0.8723 | 8750.8 samples/s | 34.2 steps/s
[Step= 500] | Loss=6.10893 | acc=0.1394 | tpr=0.7855 | fpr=0.8723 | 9151.3 samples/s | 35.7 steps/s
[Step= 550] | Loss=6.10853 | acc=0.1393 | tpr=0.7859 | fpr=0.8725 | 14340.7 samples/s | 56.0 steps/s
Avg test loss: 6.11012, Avg test acc: 0.13920, Avg tpr: 0.78645, Avg fpr: 0.87257, total FA: 121154

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14158 | acc=0.9799 | tpr=0.9248 | fpr=0.0191 | 4364.9 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.15406 | acc=0.9786 | tpr=0.9424 | fpr=0.0207 | 8627.5 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.16077 | acc=0.9781 | tpr=0.9452 | fpr=0.0213 | 9121.0 samples/s | 35.6 steps/s
[Step= 200] | Loss=0.16282 | acc=0.9784 | tpr=0.9497 | fpr=0.0211 | 8308.5 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.16100 | acc=0.9788 | tpr=0.9502 | fpr=0.0206 | 8759.4 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.16312 | acc=0.9786 | tpr=0.9476 | fpr=0.0209 | 8687.2 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.16466 | acc=0.9784 | tpr=0.9468 | fpr=0.0210 | 8542.8 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.16648 | acc=0.9781 | tpr=0.9447 | fpr=0.0213 | 9100.3 samples/s | 35.5 steps/s
[Step= 450] | Loss=0.16923 | acc=0.9780 | tpr=0.9445 | fpr=0.0214 | 8467.8 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.16854 | acc=0.9781 | tpr=0.9463 | fpr=0.0213 | 8638.4 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.16750 | acc=0.9783 | tpr=0.9439 | fpr=0.0211 | 15802.2 samples/s | 61.7 steps/s
Avg test loss: 0.16708, Avg test acc: 0.97828, Avg tpr: 0.94374, Avg fpr: 0.02110, total FA: 2929

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12859 | acc=0.9840 | tpr=0.9292 | fpr=0.0150 | 4341.4 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.13328 | acc=0.9836 | tpr=0.9488 | fpr=0.0157 | 8502.3 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.13777 | acc=0.9829 | tpr=0.9496 | fpr=0.0165 | 9102.8 samples/s | 35.6 steps/s
[Step= 200] | Loss=0.13878 | acc=0.9829 | tpr=0.9508 | fpr=0.0165 | 8541.8 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.13558 | acc=0.9833 | tpr=0.9493 | fpr=0.0161 | 8547.7 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.13680 | acc=0.9831 | tpr=0.9484 | fpr=0.0163 | 8757.0 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.13857 | acc=0.9828 | tpr=0.9487 | fpr=0.0166 | 8985.9 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.14001 | acc=0.9825 | tpr=0.9458 | fpr=0.0168 | 8256.7 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.14322 | acc=0.9824 | tpr=0.9455 | fpr=0.0170 | 8869.8 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.14245 | acc=0.9824 | tpr=0.9449 | fpr=0.0169 | 8687.0 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.14148 | acc=0.9825 | tpr=0.9439 | fpr=0.0168 | 14641.8 samples/s | 57.2 steps/s
Avg test loss: 0.14113, Avg test acc: 0.98254, Avg tpr: 0.94414, Avg fpr: 0.01677, total FA: 2328

server round 20/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=12001 Epoch=23.5] | Loss=0.03581 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.126 | L2-Norm(final)=6.981 | 3999.0 samples/s | 62.5 steps/s
[Step=12050 Epoch=23.6] | Loss=0.03601 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.126 | L2-Norm(final)=6.992 | 5496.4 samples/s | 85.9 steps/s
[Step=12100 Epoch=23.7] | Loss=0.03346 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.126 | L2-Norm(final)=7.009 | 5711.1 samples/s | 89.2 steps/s
[Step=12150 Epoch=23.8] | Loss=0.03279 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.126 | L2-Norm(final)=7.025 | 5639.7 samples/s | 88.1 steps/s
[Step=12200 Epoch=23.9] | Loss=0.03158 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.126 | L2-Norm(final)=7.041 | 5655.4 samples/s | 88.4 steps/s
[Step=12250 Epoch=23.9] | Loss=0.03160 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.126 | L2-Norm(final)=7.057 | 5736.5 samples/s | 89.6 steps/s
[Step=12300 Epoch=24.0] | Loss=0.03145 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.126 | L2-Norm(final)=7.072 | 5684.2 samples/s | 88.8 steps/s
[Step=12350 Epoch=24.1] | Loss=0.03129 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.126 | L2-Norm(final)=7.087 | 5680.0 samples/s | 88.7 steps/s
[Step=12400 Epoch=24.2] | Loss=0.03169 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.126 | L2-Norm(final)=7.102 | 5730.5 samples/s | 89.5 steps/s
[Step=12450 Epoch=24.3] | Loss=0.03150 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.126 | L2-Norm(final)=7.116 | 5722.6 samples/s | 89.4 steps/s
[Step=12500 Epoch=24.4] | Loss=0.03118 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.126 | L2-Norm(final)=7.131 | 7264.7 samples/s | 113.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=12501 Epoch=24.4] | Loss=0.03507 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.126 | L2-Norm(final)=7.275 | 4027.0 samples/s | 62.9 steps/s
[Step=12550 Epoch=24.5] | Loss=0.02467 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.144 | L2-Norm(final)=7.286 | 4736.5 samples/s | 74.0 steps/s
[Step=12600 Epoch=24.6] | Loss=0.02283 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.160 | L2-Norm(final)=7.288 | 4896.8 samples/s | 76.5 steps/s
[Step=12650 Epoch=24.7] | Loss=0.02247 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.171 | L2-Norm(final)=7.286 | 4950.7 samples/s | 77.4 steps/s
[Step=12700 Epoch=24.8] | Loss=0.02050 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.180 | L2-Norm(final)=7.286 | 4948.5 samples/s | 77.3 steps/s
[Step=12750 Epoch=24.9] | Loss=0.02002 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.187 | L2-Norm(final)=7.287 | 4963.5 samples/s | 77.6 steps/s
[Step=12800 Epoch=25.0] | Loss=0.01922 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.194 | L2-Norm(final)=7.287 | 5003.3 samples/s | 78.2 steps/s
[Step=12850 Epoch=25.1] | Loss=0.01860 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.200 | L2-Norm(final)=7.288 | 4967.8 samples/s | 77.6 steps/s
[Step=12900 Epoch=25.2] | Loss=0.01810 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.206 | L2-Norm(final)=7.289 | 4928.7 samples/s | 77.0 steps/s
[Step=12950 Epoch=25.3] | Loss=0.01756 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.211 | L2-Norm(final)=7.291 | 4997.5 samples/s | 78.1 steps/s
[Step=13000 Epoch=25.4] | Loss=0.01734 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.215 | L2-Norm(final)=7.293 | 6112.2 samples/s | 95.5 steps/s
[Step=13050 Epoch=25.5] | Loss=0.01678 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.220 | L2-Norm(final)=7.294 | 1927.9 samples/s | 30.1 steps/s
[Step=13100 Epoch=25.6] | Loss=0.01625 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.224 | L2-Norm(final)=7.296 | 4862.2 samples/s | 76.0 steps/s
[Step=13150 Epoch=25.7] | Loss=0.01577 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.228 | L2-Norm(final)=7.297 | 5002.4 samples/s | 78.2 steps/s
[Step=13200 Epoch=25.8] | Loss=0.01530 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.232 | L2-Norm(final)=7.299 | 4920.6 samples/s | 76.9 steps/s
[Step=13250 Epoch=25.9] | Loss=0.01513 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.236 | L2-Norm(final)=7.301 | 4937.1 samples/s | 77.1 steps/s
[Step=13300 Epoch=26.0] | Loss=0.01489 | Reg=0.00203 | acc=0.9531 | L2-Norm=14.239 | L2-Norm(final)=7.302 | 4992.8 samples/s | 78.0 steps/s
[Step=13350 Epoch=26.1] | Loss=0.01453 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.242 | L2-Norm(final)=7.304 | 4974.4 samples/s | 77.7 steps/s
[Step=13400 Epoch=26.2] | Loss=0.01431 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.245 | L2-Norm(final)=7.305 | 4950.2 samples/s | 77.3 steps/s
[Step=13450 Epoch=26.3] | Loss=0.01406 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.248 | L2-Norm(final)=7.307 | 4977.8 samples/s | 77.8 steps/s
[Step=13500 Epoch=26.4] | Loss=0.01376 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.251 | L2-Norm(final)=7.308 | 5402.3 samples/s | 84.4 steps/s
[Step=13550 Epoch=26.5] | Loss=0.01351 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.253 | L2-Norm(final)=7.310 | 2008.4 samples/s | 31.4 steps/s
[Step=13600 Epoch=26.6] | Loss=0.01325 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.256 | L2-Norm(final)=7.311 | 4941.3 samples/s | 77.2 steps/s
[Step=13650 Epoch=26.7] | Loss=0.01296 | Reg=0.00203 | acc=0.9531 | L2-Norm=14.258 | L2-Norm(final)=7.313 | 4951.4 samples/s | 77.4 steps/s
[Step=13700 Epoch=26.8] | Loss=0.01274 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.261 | L2-Norm(final)=7.314 | 5005.1 samples/s | 78.2 steps/s
[Step=13750 Epoch=26.9] | Loss=0.01255 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.263 | L2-Norm(final)=7.316 | 4933.2 samples/s | 77.1 steps/s
[Step=13800 Epoch=27.0] | Loss=0.01238 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.266 | L2-Norm(final)=7.317 | 4988.7 samples/s | 77.9 steps/s
[Step=13850 Epoch=27.1] | Loss=0.01227 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.268 | L2-Norm(final)=7.318 | 4978.0 samples/s | 77.8 steps/s
[Step=13900 Epoch=27.2] | Loss=0.01222 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.270 | L2-Norm(final)=7.320 | 4919.0 samples/s | 76.9 steps/s
[Step=13950 Epoch=27.3] | Loss=0.01220 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.273 | L2-Norm(final)=7.321 | 5001.9 samples/s | 78.2 steps/s
[Step=14000 Epoch=27.4] | Loss=0.01210 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.275 | L2-Norm(final)=7.322 | 4983.9 samples/s | 77.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step14000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=92.4] | Loss=0.00094 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.126 | L2-Norm(final)=10.967 | 3810.8 samples/s | 59.5 steps/s
[Step=24050 Epoch=92.6] | Loss=0.00034 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.124 | L2-Norm(final)=10.971 | 5168.4 samples/s | 80.8 steps/s
[Step=24100 Epoch=92.8] | Loss=0.00050 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.124 | L2-Norm(final)=10.977 | 5323.8 samples/s | 83.2 steps/s
[Step=24150 Epoch=93.0] | Loss=0.00050 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.124 | L2-Norm(final)=10.983 | 5381.4 samples/s | 84.1 steps/s
[Step=24200 Epoch=93.2] | Loss=0.00052 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=10.989 | 5401.9 samples/s | 84.4 steps/s
[Step=24250 Epoch=93.3] | Loss=0.00052 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=10.994 | 7074.2 samples/s | 110.5 steps/s
[Step=24300 Epoch=93.5] | Loss=0.00049 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=11.000 | 1932.5 samples/s | 30.2 steps/s
[Step=24350 Epoch=93.7] | Loss=0.00050 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=11.005 | 5393.5 samples/s | 84.3 steps/s
[Step=24400 Epoch=93.9] | Loss=0.00051 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=11.010 | 5236.9 samples/s | 81.8 steps/s
[Step=24450 Epoch=94.1] | Loss=0.00051 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=11.016 | 5369.8 samples/s | 83.9 steps/s
[Step=24500 Epoch=94.3] | Loss=0.00051 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=11.022 | 6200.7 samples/s | 96.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=94.3] | Loss=0.00028 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=11.080 | 3768.6 samples/s | 58.9 steps/s
[Step=24550 Epoch=94.5] | Loss=0.00068 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=11.083 | 4663.1 samples/s | 72.9 steps/s
[Step=24600 Epoch=94.7] | Loss=0.00037 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.115 | L2-Norm(final)=11.086 | 4666.9 samples/s | 72.9 steps/s
[Step=24650 Epoch=94.9] | Loss=0.00027 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.107 | L2-Norm(final)=11.088 | 4796.9 samples/s | 75.0 steps/s
[Step=24700 Epoch=95.1] | Loss=0.00021 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.098 | L2-Norm(final)=11.090 | 4649.6 samples/s | 72.7 steps/s
[Step=24750 Epoch=95.3] | Loss=0.00017 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=11.092 | 6046.0 samples/s | 94.5 steps/s
[Step=24800 Epoch=95.5] | Loss=0.00015 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.080 | L2-Norm(final)=11.094 | 1863.7 samples/s | 29.1 steps/s
[Step=24850 Epoch=95.7] | Loss=0.00013 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.070 | L2-Norm(final)=11.096 | 4734.5 samples/s | 74.0 steps/s
[Step=24900 Epoch=95.8] | Loss=0.00011 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.060 | L2-Norm(final)=11.097 | 4708.3 samples/s | 73.6 steps/s
[Step=24950 Epoch=96.0] | Loss=0.00010 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.050 | L2-Norm(final)=11.098 | 4719.1 samples/s | 73.7 steps/s
[Step=25000 Epoch=96.2] | Loss=0.00009 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.041 | L2-Norm(final)=11.099 | 5260.9 samples/s | 82.2 steps/s
[Step=25050 Epoch=96.4] | Loss=0.00008 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.031 | L2-Norm(final)=11.099 | 1938.8 samples/s | 30.3 steps/s
[Step=25100 Epoch=96.6] | Loss=0.00008 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.021 | L2-Norm(final)=11.100 | 4769.7 samples/s | 74.5 steps/s
[Step=25150 Epoch=96.8] | Loss=0.00007 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.011 | L2-Norm(final)=11.101 | 4753.7 samples/s | 74.3 steps/s
[Step=25200 Epoch=97.0] | Loss=0.00007 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.001 | L2-Norm(final)=11.102 | 4631.0 samples/s | 72.4 steps/s
[Step=25250 Epoch=97.2] | Loss=0.00006 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.991 | L2-Norm(final)=11.102 | 4852.1 samples/s | 75.8 steps/s
[Step=25300 Epoch=97.4] | Loss=0.00006 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.982 | L2-Norm(final)=11.103 | 1991.1 samples/s | 31.1 steps/s
[Step=25350 Epoch=97.6] | Loss=0.00006 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.972 | L2-Norm(final)=11.104 | 4791.0 samples/s | 74.9 steps/s
[Step=25400 Epoch=97.8] | Loss=0.00005 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.962 | L2-Norm(final)=11.104 | 4761.9 samples/s | 74.4 steps/s
[Step=25450 Epoch=98.0] | Loss=0.00005 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.952 | L2-Norm(final)=11.105 | 4649.2 samples/s | 72.6 steps/s
[Step=25500 Epoch=98.2] | Loss=0.00005 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.942 | L2-Norm(final)=11.105 | 4709.5 samples/s | 73.6 steps/s
[Step=25550 Epoch=98.4] | Loss=0.00005 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.932 | L2-Norm(final)=11.106 | 2037.4 samples/s | 31.8 steps/s
[Step=25600 Epoch=98.5] | Loss=0.00004 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.922 | L2-Norm(final)=11.107 | 4565.3 samples/s | 71.3 steps/s
[Step=25650 Epoch=98.7] | Loss=0.00004 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.911 | L2-Norm(final)=11.107 | 4745.1 samples/s | 74.1 steps/s
[Step=25700 Epoch=98.9] | Loss=0.00004 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.901 | L2-Norm(final)=11.108 | 4666.3 samples/s | 72.9 steps/s
[Step=25750 Epoch=99.1] | Loss=0.00004 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.891 | L2-Norm(final)=11.109 | 4709.1 samples/s | 73.6 steps/s
[Step=25800 Epoch=99.3] | Loss=0.00004 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.881 | L2-Norm(final)=11.109 | 6934.7 samples/s | 108.4 steps/s
[Step=25850 Epoch=99.5] | Loss=0.00004 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.870 | L2-Norm(final)=11.110 | 1786.7 samples/s | 27.9 steps/s
[Step=25900 Epoch=99.7] | Loss=0.00004 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.860 | L2-Norm(final)=11.111 | 4743.4 samples/s | 74.1 steps/s
[Step=25950 Epoch=99.9] | Loss=0.00003 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.849 | L2-Norm(final)=11.111 | 4621.7 samples/s | 72.2 steps/s
[Step=26000 Epoch=100.1] | Loss=0.00003 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=11.112 | 4750.3 samples/s | 74.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step26000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07311 | acc=0.9643 | tpr=0.9661 | fpr=0.0396 | 4310.2 samples/s | 16.8 steps/s
Avg test loss: 0.07291, Avg test acc: 0.96358, Avg tpr: 0.96550, Avg fpr: 0.04064, total FA: 317

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06726 | acc=0.9690 | tpr=0.9792 | fpr=0.0533 | 4337.3 samples/s | 16.9 steps/s
Avg test loss: 0.07106, Avg test acc: 0.96827, Avg tpr: 0.97873, Avg fpr: 0.05474, total FA: 427

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.56367 | acc=0.3040 | tpr=0.0045 | fpr=0.0456 | 4326.8 samples/s | 16.9 steps/s
Avg test loss: 6.55270, Avg test acc: 0.30183, Avg tpr: 0.00565, Avg fpr: 0.04679, total FA: 365

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.14599 | acc=0.3002 | tpr=0.0226 | fpr=0.0969 | 4341.1 samples/s | 17.0 steps/s
Avg test loss: 6.13845, Avg test acc: 0.29634, Avg tpr: 0.02226, Avg fpr: 0.10088, total FA: 787

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.85240 | acc=0.1573 | tpr=0.6549 | fpr=0.8516 | 4345.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=4.82298 | acc=0.1588 | tpr=0.6695 | fpr=0.8508 | 8656.6 samples/s | 33.8 steps/s
[Step= 150] | Loss=4.82254 | acc=0.1576 | tpr=0.6599 | fpr=0.8517 | 8772.8 samples/s | 34.3 steps/s
[Step= 200] | Loss=4.80671 | acc=0.1582 | tpr=0.6546 | fpr=0.8509 | 8694.1 samples/s | 34.0 steps/s
[Step= 250] | Loss=4.80233 | acc=0.1583 | tpr=0.6376 | fpr=0.8505 | 8716.6 samples/s | 34.0 steps/s
[Step= 300] | Loss=4.79989 | acc=0.1582 | tpr=0.6342 | fpr=0.8504 | 8400.9 samples/s | 32.8 steps/s
[Step= 350] | Loss=4.79428 | acc=0.1575 | tpr=0.6362 | fpr=0.8512 | 8617.5 samples/s | 33.7 steps/s
[Step= 400] | Loss=4.78813 | acc=0.1579 | tpr=0.6395 | fpr=0.8509 | 8709.4 samples/s | 34.0 steps/s
[Step= 450] | Loss=4.78574 | acc=0.1574 | tpr=0.6397 | fpr=0.8513 | 8779.9 samples/s | 34.3 steps/s
[Step= 500] | Loss=4.78787 | acc=0.1575 | tpr=0.6396 | fpr=0.8513 | 8509.9 samples/s | 33.2 steps/s
[Step= 550] | Loss=4.79200 | acc=0.1572 | tpr=0.6363 | fpr=0.8515 | 16048.6 samples/s | 62.7 steps/s
Avg test loss: 4.79280, Avg test acc: 0.15710, Avg tpr: 0.63629, Avg fpr: 0.85161, total FA: 118245

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.24207 | acc=0.1321 | tpr=0.7876 | fpr=0.8797 | 4373.2 samples/s | 17.1 steps/s
[Step= 100] | Loss=6.21724 | acc=0.1339 | tpr=0.7996 | fpr=0.8785 | 8646.5 samples/s | 33.8 steps/s
[Step= 150] | Loss=6.21236 | acc=0.1321 | tpr=0.7997 | fpr=0.8802 | 8652.1 samples/s | 33.8 steps/s
[Step= 200] | Loss=6.19490 | acc=0.1327 | tpr=0.8033 | fpr=0.8795 | 9040.2 samples/s | 35.3 steps/s
[Step= 250] | Loss=6.19276 | acc=0.1325 | tpr=0.7895 | fpr=0.8794 | 8398.4 samples/s | 32.8 steps/s
[Step= 300] | Loss=6.18969 | acc=0.1328 | tpr=0.7905 | fpr=0.8792 | 8722.1 samples/s | 34.1 steps/s
[Step= 350] | Loss=6.18453 | acc=0.1321 | tpr=0.7927 | fpr=0.8798 | 8726.2 samples/s | 34.1 steps/s
[Step= 400] | Loss=6.17657 | acc=0.1321 | tpr=0.7927 | fpr=0.8799 | 8651.9 samples/s | 33.8 steps/s
[Step= 450] | Loss=6.17283 | acc=0.1320 | tpr=0.7955 | fpr=0.8801 | 8809.6 samples/s | 34.4 steps/s
[Step= 500] | Loss=6.17581 | acc=0.1318 | tpr=0.7982 | fpr=0.8802 | 8294.6 samples/s | 32.4 steps/s
[Step= 550] | Loss=6.17613 | acc=0.1320 | tpr=0.8018 | fpr=0.8802 | 15429.9 samples/s | 60.3 steps/s
Avg test loss: 6.17734, Avg test acc: 0.13191, Avg tpr: 0.80230, Avg fpr: 0.88027, total FA: 122224

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14158 | acc=0.9799 | tpr=0.9248 | fpr=0.0191 | 4361.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.15406 | acc=0.9786 | tpr=0.9424 | fpr=0.0207 | 8458.9 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.16077 | acc=0.9781 | tpr=0.9452 | fpr=0.0213 | 9005.2 samples/s | 35.2 steps/s
[Step= 200] | Loss=0.16282 | acc=0.9784 | tpr=0.9497 | fpr=0.0211 | 8487.2 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.16100 | acc=0.9788 | tpr=0.9502 | fpr=0.0206 | 8802.4 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.16312 | acc=0.9786 | tpr=0.9476 | fpr=0.0209 | 8294.3 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.16466 | acc=0.9784 | tpr=0.9468 | fpr=0.0210 | 9130.7 samples/s | 35.7 steps/s
[Step= 400] | Loss=0.16648 | acc=0.9781 | tpr=0.9447 | fpr=0.0213 | 8535.6 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.16923 | acc=0.9780 | tpr=0.9445 | fpr=0.0214 | 8646.2 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.16854 | acc=0.9781 | tpr=0.9463 | fpr=0.0213 | 8393.3 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.16750 | acc=0.9783 | tpr=0.9439 | fpr=0.0211 | 15202.9 samples/s | 59.4 steps/s
Avg test loss: 0.16708, Avg test acc: 0.97828, Avg tpr: 0.94374, Avg fpr: 0.02110, total FA: 2929

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15652 | acc=0.9798 | tpr=0.9558 | fpr=0.0197 | 4463.7 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.16725 | acc=0.9791 | tpr=0.9680 | fpr=0.0207 | 8145.4 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.17345 | acc=0.9781 | tpr=0.9683 | fpr=0.0217 | 8685.3 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.17495 | acc=0.9785 | tpr=0.9661 | fpr=0.0213 | 8596.2 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.17174 | acc=0.9787 | tpr=0.9642 | fpr=0.0210 | 8967.5 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.17358 | acc=0.9785 | tpr=0.9615 | fpr=0.0212 | 8558.8 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.17521 | acc=0.9783 | tpr=0.9624 | fpr=0.0214 | 8535.1 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.17696 | acc=0.9781 | tpr=0.9595 | fpr=0.0215 | 9003.6 samples/s | 35.2 steps/s
[Step= 450] | Loss=0.18063 | acc=0.9779 | tpr=0.9581 | fpr=0.0217 | 8423.4 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.17992 | acc=0.9779 | tpr=0.9586 | fpr=0.0218 | 8586.9 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.17858 | acc=0.9780 | tpr=0.9578 | fpr=0.0216 | 15614.2 samples/s | 61.0 steps/s
Avg test loss: 0.17816, Avg test acc: 0.97805, Avg tpr: 0.95761, Avg fpr: 0.02158, total FA: 2996

server round 21/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=16001 Epoch=61.3] | Loss=0.00008 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.982 | L2-Norm(final)=9.507 | 3741.6 samples/s | 58.5 steps/s
[Step=16050 Epoch=61.5] | Loss=0.00102 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.981 | L2-Norm(final)=9.516 | 5291.1 samples/s | 82.7 steps/s
[Step=16100 Epoch=61.7] | Loss=0.00071 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.980 | L2-Norm(final)=9.524 | 5387.2 samples/s | 84.2 steps/s
[Step=16150 Epoch=61.9] | Loss=0.00076 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.980 | L2-Norm(final)=9.532 | 5265.9 samples/s | 82.3 steps/s
[Step=16200 Epoch=62.1] | Loss=0.00090 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.980 | L2-Norm(final)=9.542 | 5282.2 samples/s | 82.5 steps/s
[Step=16250 Epoch=62.3] | Loss=0.00083 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.980 | L2-Norm(final)=9.551 | 7070.8 samples/s | 110.5 steps/s
[Step=16300 Epoch=62.5] | Loss=0.00080 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.980 | L2-Norm(final)=9.560 | 1948.7 samples/s | 30.4 steps/s
[Step=16350 Epoch=62.6] | Loss=0.00078 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.980 | L2-Norm(final)=9.568 | 5293.7 samples/s | 82.7 steps/s
[Step=16400 Epoch=62.8] | Loss=0.00076 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.980 | L2-Norm(final)=9.576 | 5433.4 samples/s | 84.9 steps/s
[Step=16450 Epoch=63.0] | Loss=0.00075 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.980 | L2-Norm(final)=9.584 | 5270.5 samples/s | 82.4 steps/s
[Step=16500 Epoch=63.2] | Loss=0.00072 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.980 | L2-Norm(final)=9.591 | 6011.5 samples/s | 93.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=16501 Epoch=63.2] | Loss=0.00047 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.980 | L2-Norm(final)=9.663 | 3735.9 samples/s | 58.4 steps/s
[Step=16550 Epoch=63.4] | Loss=0.00031 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.981 | L2-Norm(final)=9.670 | 4612.3 samples/s | 72.1 steps/s
[Step=16600 Epoch=63.6] | Loss=0.00030 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.976 | L2-Norm(final)=9.672 | 4748.1 samples/s | 74.2 steps/s
[Step=16650 Epoch=63.8] | Loss=0.00022 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.971 | L2-Norm(final)=9.673 | 4773.9 samples/s | 74.6 steps/s
[Step=16700 Epoch=64.0] | Loss=0.00017 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.964 | L2-Norm(final)=9.674 | 4604.8 samples/s | 72.0 steps/s
[Step=16750 Epoch=64.2] | Loss=0.00014 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.957 | L2-Norm(final)=9.675 | 5907.6 samples/s | 92.3 steps/s
[Step=16800 Epoch=64.4] | Loss=0.00012 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.949 | L2-Norm(final)=9.675 | 1852.1 samples/s | 28.9 steps/s
[Step=16850 Epoch=64.6] | Loss=0.00011 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.941 | L2-Norm(final)=9.676 | 4665.2 samples/s | 72.9 steps/s
[Step=16900 Epoch=64.8] | Loss=0.00009 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.933 | L2-Norm(final)=9.677 | 4808.0 samples/s | 75.1 steps/s
[Step=16950 Epoch=64.9] | Loss=0.00008 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.924 | L2-Norm(final)=9.678 | 4612.1 samples/s | 72.1 steps/s
[Step=17000 Epoch=65.1] | Loss=0.00008 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.916 | L2-Norm(final)=9.678 | 5230.5 samples/s | 81.7 steps/s
[Step=17050 Epoch=65.3] | Loss=0.00007 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.907 | L2-Norm(final)=9.679 | 1938.4 samples/s | 30.3 steps/s
[Step=17100 Epoch=65.5] | Loss=0.00006 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.898 | L2-Norm(final)=9.679 | 4743.6 samples/s | 74.1 steps/s
[Step=17150 Epoch=65.7] | Loss=0.00006 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.889 | L2-Norm(final)=9.679 | 4701.9 samples/s | 73.5 steps/s
[Step=17200 Epoch=65.9] | Loss=0.00006 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.880 | L2-Norm(final)=9.680 | 4692.8 samples/s | 73.3 steps/s
[Step=17250 Epoch=66.1] | Loss=0.00005 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.871 | L2-Norm(final)=9.680 | 4699.5 samples/s | 73.4 steps/s
[Step=17300 Epoch=66.3] | Loss=0.00005 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.862 | L2-Norm(final)=9.680 | 2010.2 samples/s | 31.4 steps/s
[Step=17350 Epoch=66.5] | Loss=0.00005 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.853 | L2-Norm(final)=9.681 | 4709.7 samples/s | 73.6 steps/s
[Step=17400 Epoch=66.7] | Loss=0.00004 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.844 | L2-Norm(final)=9.681 | 4703.2 samples/s | 73.5 steps/s
[Step=17450 Epoch=66.9] | Loss=0.00004 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.835 | L2-Norm(final)=9.681 | 4680.0 samples/s | 73.1 steps/s
[Step=17500 Epoch=67.1] | Loss=0.00004 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.826 | L2-Norm(final)=9.682 | 4706.3 samples/s | 73.5 steps/s
[Step=17550 Epoch=67.2] | Loss=0.00004 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.817 | L2-Norm(final)=9.682 | 2024.6 samples/s | 31.6 steps/s
[Step=17600 Epoch=67.4] | Loss=0.00004 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.807 | L2-Norm(final)=9.682 | 4663.1 samples/s | 72.9 steps/s
[Step=17650 Epoch=67.6] | Loss=0.00004 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.798 | L2-Norm(final)=9.683 | 4731.0 samples/s | 73.9 steps/s
[Step=17700 Epoch=67.8] | Loss=0.00003 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.788 | L2-Norm(final)=9.683 | 4660.6 samples/s | 72.8 steps/s
[Step=17750 Epoch=68.0] | Loss=0.00003 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.779 | L2-Norm(final)=9.683 | 4721.9 samples/s | 73.8 steps/s
[Step=17800 Epoch=68.2] | Loss=0.00003 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.769 | L2-Norm(final)=9.684 | 6442.0 samples/s | 100.7 steps/s
[Step=17850 Epoch=68.4] | Loss=0.00003 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.760 | L2-Norm(final)=9.684 | 1815.3 samples/s | 28.4 steps/s
[Step=17900 Epoch=68.6] | Loss=0.00003 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.750 | L2-Norm(final)=9.684 | 4725.6 samples/s | 73.8 steps/s
[Step=17950 Epoch=68.8] | Loss=0.00003 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=9.684 | 4759.2 samples/s | 74.4 steps/s
[Step=18000 Epoch=69.0] | Loss=0.00003 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.730 | L2-Norm(final)=9.685 | 4631.1 samples/s | 72.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step18000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=100.1] | Loss=0.00104 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.982 | L2-Norm(final)=11.131 | 3891.3 samples/s | 60.8 steps/s
[Step=26050 Epoch=100.3] | Loss=0.00158 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=11.140 | 4917.6 samples/s | 76.8 steps/s
[Step=26100 Epoch=100.5] | Loss=0.00103 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=11.150 | 5384.2 samples/s | 84.1 steps/s
[Step=26150 Epoch=100.7] | Loss=0.00106 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=11.162 | 5340.8 samples/s | 83.4 steps/s
[Step=26200 Epoch=100.9] | Loss=0.00098 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=11.175 | 5362.5 samples/s | 83.8 steps/s
[Step=26250 Epoch=101.0] | Loss=0.00089 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=11.186 | 6999.5 samples/s | 109.4 steps/s
[Step=26300 Epoch=101.2] | Loss=0.00084 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=11.197 | 1947.5 samples/s | 30.4 steps/s
[Step=26350 Epoch=101.4] | Loss=0.00091 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=11.208 | 5280.2 samples/s | 82.5 steps/s
[Step=26400 Epoch=101.6] | Loss=0.00089 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=11.218 | 5352.1 samples/s | 83.6 steps/s
[Step=26450 Epoch=101.8] | Loss=0.00090 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=11.229 | 5327.9 samples/s | 83.2 steps/s
[Step=26500 Epoch=102.0] | Loss=0.00086 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=11.239 | 6196.2 samples/s | 96.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=102.0] | Loss=0.00001 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=11.337 | 3979.2 samples/s | 62.2 steps/s
[Step=26550 Epoch=102.2] | Loss=0.00118 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.984 | L2-Norm(final)=11.342 | 4330.2 samples/s | 67.7 steps/s
[Step=26600 Epoch=102.4] | Loss=0.00152 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.007 | L2-Norm(final)=11.346 | 4736.6 samples/s | 74.0 steps/s
[Step=26650 Epoch=102.6] | Loss=0.00129 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.024 | L2-Norm(final)=11.346 | 4707.1 samples/s | 73.5 steps/s
[Step=26700 Epoch=102.8] | Loss=0.00098 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.030 | L2-Norm(final)=11.346 | 4765.7 samples/s | 74.5 steps/s
[Step=26750 Epoch=103.0] | Loss=0.00079 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.030 | L2-Norm(final)=11.347 | 5845.4 samples/s | 91.3 steps/s
[Step=26800 Epoch=103.2] | Loss=0.00066 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.027 | L2-Norm(final)=11.348 | 1852.7 samples/s | 28.9 steps/s
[Step=26850 Epoch=103.4] | Loss=0.00057 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.022 | L2-Norm(final)=11.349 | 4709.6 samples/s | 73.6 steps/s
[Step=26900 Epoch=103.5] | Loss=0.00050 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.015 | L2-Norm(final)=11.349 | 4759.6 samples/s | 74.4 steps/s
[Step=26950 Epoch=103.7] | Loss=0.00044 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.008 | L2-Norm(final)=11.350 | 4664.5 samples/s | 72.9 steps/s
[Step=27000 Epoch=103.9] | Loss=0.00040 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.001 | L2-Norm(final)=11.351 | 5303.5 samples/s | 82.9 steps/s
[Step=27050 Epoch=104.1] | Loss=0.00036 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.993 | L2-Norm(final)=11.351 | 1933.8 samples/s | 30.2 steps/s
[Step=27100 Epoch=104.3] | Loss=0.00033 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.984 | L2-Norm(final)=11.352 | 4736.5 samples/s | 74.0 steps/s
[Step=27150 Epoch=104.5] | Loss=0.00031 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.976 | L2-Norm(final)=11.353 | 4765.6 samples/s | 74.5 steps/s
[Step=27200 Epoch=104.7] | Loss=0.00029 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.967 | L2-Norm(final)=11.353 | 4668.1 samples/s | 72.9 steps/s
[Step=27250 Epoch=104.9] | Loss=0.00027 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.958 | L2-Norm(final)=11.354 | 4785.2 samples/s | 74.8 steps/s
[Step=27300 Epoch=105.1] | Loss=0.00025 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.949 | L2-Norm(final)=11.354 | 2002.4 samples/s | 31.3 steps/s
[Step=27350 Epoch=105.3] | Loss=0.00024 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.940 | L2-Norm(final)=11.355 | 4808.7 samples/s | 75.1 steps/s
[Step=27400 Epoch=105.5] | Loss=0.00022 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.931 | L2-Norm(final)=11.355 | 4733.5 samples/s | 74.0 steps/s
[Step=27450 Epoch=105.7] | Loss=0.00021 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.922 | L2-Norm(final)=11.356 | 4628.4 samples/s | 72.3 steps/s
[Step=27500 Epoch=105.9] | Loss=0.00020 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.913 | L2-Norm(final)=11.356 | 4689.5 samples/s | 73.3 steps/s
[Step=27550 Epoch=106.1] | Loss=0.00019 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.903 | L2-Norm(final)=11.357 | 2008.1 samples/s | 31.4 steps/s
[Step=27600 Epoch=106.2] | Loss=0.00018 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.894 | L2-Norm(final)=11.357 | 4841.4 samples/s | 75.6 steps/s
[Step=27650 Epoch=106.4] | Loss=0.00018 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.884 | L2-Norm(final)=11.358 | 4693.1 samples/s | 73.3 steps/s
[Step=27700 Epoch=106.6] | Loss=0.00017 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.874 | L2-Norm(final)=11.358 | 4704.8 samples/s | 73.5 steps/s
[Step=27750 Epoch=106.8] | Loss=0.00016 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.865 | L2-Norm(final)=11.358 | 4710.0 samples/s | 73.6 steps/s
[Step=27800 Epoch=107.0] | Loss=0.00016 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.855 | L2-Norm(final)=11.359 | 6960.3 samples/s | 108.8 steps/s
[Step=27850 Epoch=107.2] | Loss=0.00015 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.845 | L2-Norm(final)=11.359 | 1792.6 samples/s | 28.0 steps/s
[Step=27900 Epoch=107.4] | Loss=0.00014 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.835 | L2-Norm(final)=11.360 | 4670.4 samples/s | 73.0 steps/s
[Step=27950 Epoch=107.6] | Loss=0.00014 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.825 | L2-Norm(final)=11.360 | 4796.9 samples/s | 75.0 steps/s
[Step=28000 Epoch=107.8] | Loss=0.00013 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.815 | L2-Norm(final)=11.361 | 4645.1 samples/s | 72.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07311 | acc=0.9643 | tpr=0.9661 | fpr=0.0396 | 4401.1 samples/s | 17.2 steps/s
Avg test loss: 0.07291, Avg test acc: 0.96358, Avg tpr: 0.96550, Avg fpr: 0.04064, total FA: 317

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06726 | acc=0.9690 | tpr=0.9792 | fpr=0.0533 | 4405.6 samples/s | 17.2 steps/s
Avg test loss: 0.07106, Avg test acc: 0.96827, Avg tpr: 0.97873, Avg fpr: 0.05474, total FA: 427

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.34550 | acc=0.2991 | tpr=0.0184 | fpr=0.0912 | 4468.9 samples/s | 17.5 steps/s
Avg test loss: 6.33275, Avg test acc: 0.29590, Avg tpr: 0.01865, Avg fpr: 0.09435, total FA: 736

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.00880 | acc=0.2968 | tpr=0.0241 | fpr=0.1110 | 4322.6 samples/s | 16.9 steps/s
Avg test loss: 7.01611, Avg test acc: 0.29373, Avg tpr: 0.02343, Avg fpr: 0.11178, total FA: 872

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.85240 | acc=0.1573 | tpr=0.6549 | fpr=0.8516 | 4310.6 samples/s | 16.8 steps/s
[Step= 100] | Loss=4.82298 | acc=0.1588 | tpr=0.6695 | fpr=0.8508 | 8756.1 samples/s | 34.2 steps/s
[Step= 150] | Loss=4.82254 | acc=0.1576 | tpr=0.6599 | fpr=0.8517 | 8989.1 samples/s | 35.1 steps/s
[Step= 200] | Loss=4.80671 | acc=0.1582 | tpr=0.6546 | fpr=0.8509 | 8144.3 samples/s | 31.8 steps/s
[Step= 250] | Loss=4.80233 | acc=0.1583 | tpr=0.6376 | fpr=0.8505 | 9512.0 samples/s | 37.2 steps/s
[Step= 300] | Loss=4.79989 | acc=0.1582 | tpr=0.6342 | fpr=0.8504 | 8247.5 samples/s | 32.2 steps/s
[Step= 350] | Loss=4.79428 | acc=0.1575 | tpr=0.6362 | fpr=0.8512 | 8397.8 samples/s | 32.8 steps/s
[Step= 400] | Loss=4.78813 | acc=0.1579 | tpr=0.6395 | fpr=0.8509 | 8730.1 samples/s | 34.1 steps/s
[Step= 450] | Loss=4.78574 | acc=0.1574 | tpr=0.6397 | fpr=0.8513 | 8872.3 samples/s | 34.7 steps/s
[Step= 500] | Loss=4.78787 | acc=0.1575 | tpr=0.6396 | fpr=0.8513 | 8524.0 samples/s | 33.3 steps/s
[Step= 550] | Loss=4.79200 | acc=0.1572 | tpr=0.6363 | fpr=0.8515 | 15873.0 samples/s | 62.0 steps/s
Avg test loss: 4.79280, Avg test acc: 0.15710, Avg tpr: 0.63629, Avg fpr: 0.85161, total FA: 118245

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.24207 | acc=0.1321 | tpr=0.7876 | fpr=0.8797 | 4359.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=6.21724 | acc=0.1339 | tpr=0.7996 | fpr=0.8785 | 8632.5 samples/s | 33.7 steps/s
[Step= 150] | Loss=6.21236 | acc=0.1321 | tpr=0.7997 | fpr=0.8802 | 8731.7 samples/s | 34.1 steps/s
[Step= 200] | Loss=6.19490 | acc=0.1327 | tpr=0.8033 | fpr=0.8795 | 8526.3 samples/s | 33.3 steps/s
[Step= 250] | Loss=6.19276 | acc=0.1325 | tpr=0.7895 | fpr=0.8794 | 8560.4 samples/s | 33.4 steps/s
[Step= 300] | Loss=6.18969 | acc=0.1328 | tpr=0.7905 | fpr=0.8792 | 9481.5 samples/s | 37.0 steps/s
[Step= 350] | Loss=6.18453 | acc=0.1321 | tpr=0.7927 | fpr=0.8798 | 8089.7 samples/s | 31.6 steps/s
[Step= 400] | Loss=6.17657 | acc=0.1321 | tpr=0.7927 | fpr=0.8799 | 8837.4 samples/s | 34.5 steps/s
[Step= 450] | Loss=6.17283 | acc=0.1320 | tpr=0.7955 | fpr=0.8801 | 8457.7 samples/s | 33.0 steps/s
[Step= 500] | Loss=6.17581 | acc=0.1318 | tpr=0.7982 | fpr=0.8802 | 8482.7 samples/s | 33.1 steps/s
[Step= 550] | Loss=6.17613 | acc=0.1320 | tpr=0.8018 | fpr=0.8802 | 15942.0 samples/s | 62.3 steps/s
Avg test loss: 6.17734, Avg test acc: 0.13191, Avg tpr: 0.80230, Avg fpr: 0.88027, total FA: 122224

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14094 | acc=0.9798 | tpr=0.9469 | fpr=0.0196 | 4276.8 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.15047 | acc=0.9787 | tpr=0.9574 | fpr=0.0209 | 8638.0 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.15531 | acc=0.9782 | tpr=0.9597 | fpr=0.0215 | 9011.9 samples/s | 35.2 steps/s
[Step= 200] | Loss=0.15661 | acc=0.9785 | tpr=0.9596 | fpr=0.0211 | 8500.2 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.15453 | acc=0.9788 | tpr=0.9581 | fpr=0.0208 | 8729.9 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.15604 | acc=0.9785 | tpr=0.9593 | fpr=0.0211 | 9069.1 samples/s | 35.4 steps/s
[Step= 350] | Loss=0.15707 | acc=0.9785 | tpr=0.9606 | fpr=0.0212 | 8663.5 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.15893 | acc=0.9782 | tpr=0.9590 | fpr=0.0214 | 8504.7 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.16202 | acc=0.9781 | tpr=0.9576 | fpr=0.0216 | 8617.5 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.16144 | acc=0.9781 | tpr=0.9577 | fpr=0.0216 | 8707.9 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.16031 | acc=0.9782 | tpr=0.9566 | fpr=0.0214 | 15348.4 samples/s | 60.0 steps/s
Avg test loss: 0.15990, Avg test acc: 0.97823, Avg tpr: 0.95681, Avg fpr: 0.02138, total FA: 2969

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16783 | acc=0.9796 | tpr=0.9381 | fpr=0.0196 | 4313.8 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.18140 | acc=0.9782 | tpr=0.9446 | fpr=0.0211 | 8759.6 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.18823 | acc=0.9777 | tpr=0.9496 | fpr=0.0218 | 8956.8 samples/s | 35.0 steps/s
[Step= 200] | Loss=0.18924 | acc=0.9779 | tpr=0.9530 | fpr=0.0217 | 8401.4 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.18657 | acc=0.9782 | tpr=0.9546 | fpr=0.0213 | 8756.7 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.18858 | acc=0.9780 | tpr=0.9520 | fpr=0.0215 | 8720.4 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.18988 | acc=0.9779 | tpr=0.9524 | fpr=0.0217 | 8583.9 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.19168 | acc=0.9776 | tpr=0.9502 | fpr=0.0219 | 8609.1 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.19519 | acc=0.9775 | tpr=0.9479 | fpr=0.0220 | 8831.6 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.19448 | acc=0.9775 | tpr=0.9485 | fpr=0.0219 | 8819.7 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.19291 | acc=0.9776 | tpr=0.9475 | fpr=0.0218 | 15186.3 samples/s | 59.3 steps/s
Avg test loss: 0.19252, Avg test acc: 0.97766, Avg tpr: 0.94731, Avg fpr: 0.02179, total FA: 3025

server round 22/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=14001 Epoch=27.4] | Loss=0.01625 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.883 | L2-Norm(final)=7.357 | 3942.8 samples/s | 61.6 steps/s
[Step=14050 Epoch=27.5] | Loss=0.01911 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.884 | L2-Norm(final)=7.361 | 5401.4 samples/s | 84.4 steps/s
[Step=14100 Epoch=27.6] | Loss=0.01879 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.885 | L2-Norm(final)=7.363 | 5812.4 samples/s | 90.8 steps/s
[Step=14150 Epoch=27.7] | Loss=0.01878 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.885 | L2-Norm(final)=7.366 | 5683.2 samples/s | 88.8 steps/s
[Step=14200 Epoch=27.8] | Loss=0.01850 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.885 | L2-Norm(final)=7.368 | 5588.6 samples/s | 87.3 steps/s
[Step=14250 Epoch=27.9] | Loss=0.01884 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.885 | L2-Norm(final)=7.370 | 5800.9 samples/s | 90.6 steps/s
[Step=14300 Epoch=28.0] | Loss=0.01869 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.885 | L2-Norm(final)=7.373 | 5644.0 samples/s | 88.2 steps/s
[Step=14350 Epoch=28.1] | Loss=0.01837 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.885 | L2-Norm(final)=7.376 | 5696.7 samples/s | 89.0 steps/s
[Step=14400 Epoch=28.2] | Loss=0.01849 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.885 | L2-Norm(final)=7.378 | 5758.4 samples/s | 90.0 steps/s
[Step=14450 Epoch=28.2] | Loss=0.01916 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.885 | L2-Norm(final)=7.381 | 5787.5 samples/s | 90.4 steps/s
[Step=14500 Epoch=28.3] | Loss=0.01873 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.885 | L2-Norm(final)=7.383 | 7216.6 samples/s | 112.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=14501 Epoch=28.3] | Loss=0.05928 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.885 | L2-Norm(final)=7.403 | 3780.2 samples/s | 59.1 steps/s
[Step=14550 Epoch=28.4] | Loss=0.02292 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.898 | L2-Norm(final)=7.403 | 4904.8 samples/s | 76.6 steps/s
[Step=14600 Epoch=28.5] | Loss=0.02023 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.914 | L2-Norm(final)=7.403 | 4881.3 samples/s | 76.3 steps/s
[Step=14650 Epoch=28.6] | Loss=0.02038 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.928 | L2-Norm(final)=7.402 | 4930.1 samples/s | 77.0 steps/s
[Step=14700 Epoch=28.7] | Loss=0.01893 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.941 | L2-Norm(final)=7.403 | 4982.4 samples/s | 77.9 steps/s
[Step=14750 Epoch=28.8] | Loss=0.01775 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.952 | L2-Norm(final)=7.404 | 4961.1 samples/s | 77.5 steps/s
[Step=14800 Epoch=28.9] | Loss=0.01738 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.961 | L2-Norm(final)=7.406 | 4930.9 samples/s | 77.0 steps/s
[Step=14850 Epoch=29.0] | Loss=0.01693 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.969 | L2-Norm(final)=7.407 | 4974.3 samples/s | 77.7 steps/s
[Step=14900 Epoch=29.1] | Loss=0.01678 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.977 | L2-Norm(final)=7.407 | 5021.0 samples/s | 78.5 steps/s
[Step=14950 Epoch=29.2] | Loss=0.01649 | Reg=0.00196 | acc=0.9688 | L2-Norm=13.984 | L2-Norm(final)=7.408 | 4967.5 samples/s | 77.6 steps/s
[Step=15000 Epoch=29.3] | Loss=0.01641 | Reg=0.00196 | acc=0.9688 | L2-Norm=13.990 | L2-Norm(final)=7.409 | 6120.8 samples/s | 95.6 steps/s
[Step=15050 Epoch=29.4] | Loss=0.01589 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.996 | L2-Norm(final)=7.410 | 1926.8 samples/s | 30.1 steps/s
[Step=15100 Epoch=29.5] | Loss=0.01532 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.001 | L2-Norm(final)=7.412 | 4863.5 samples/s | 76.0 steps/s
[Step=15150 Epoch=29.6] | Loss=0.01494 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.006 | L2-Norm(final)=7.413 | 5017.3 samples/s | 78.4 steps/s
[Step=15200 Epoch=29.7] | Loss=0.01475 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.011 | L2-Norm(final)=7.414 | 4932.4 samples/s | 77.1 steps/s
[Step=15250 Epoch=29.8] | Loss=0.01436 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.016 | L2-Norm(final)=7.416 | 4918.7 samples/s | 76.9 steps/s
[Step=15300 Epoch=29.9] | Loss=0.01408 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.020 | L2-Norm(final)=7.417 | 5043.0 samples/s | 78.8 steps/s
[Step=15350 Epoch=30.0] | Loss=0.01369 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.024 | L2-Norm(final)=7.419 | 4983.3 samples/s | 77.9 steps/s
[Step=15400 Epoch=30.1] | Loss=0.01348 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.028 | L2-Norm(final)=7.420 | 4932.3 samples/s | 77.1 steps/s
[Step=15450 Epoch=30.2] | Loss=0.01329 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.032 | L2-Norm(final)=7.422 | 4950.9 samples/s | 77.4 steps/s
[Step=15500 Epoch=30.3] | Loss=0.01309 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.035 | L2-Norm(final)=7.423 | 5359.6 samples/s | 83.7 steps/s
[Step=15550 Epoch=30.4] | Loss=0.01301 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.039 | L2-Norm(final)=7.425 | 2018.9 samples/s | 31.5 steps/s
[Step=15600 Epoch=30.5] | Loss=0.01274 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.042 | L2-Norm(final)=7.426 | 4913.5 samples/s | 76.8 steps/s
[Step=15650 Epoch=30.6] | Loss=0.01242 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.045 | L2-Norm(final)=7.428 | 4975.3 samples/s | 77.7 steps/s
[Step=15700 Epoch=30.7] | Loss=0.01223 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.048 | L2-Norm(final)=7.430 | 5020.1 samples/s | 78.4 steps/s
[Step=15750 Epoch=30.8] | Loss=0.01210 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.051 | L2-Norm(final)=7.431 | 4931.4 samples/s | 77.1 steps/s
[Step=15800 Epoch=30.9] | Loss=0.01210 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.054 | L2-Norm(final)=7.433 | 4826.0 samples/s | 75.4 steps/s
[Step=15850 Epoch=31.0] | Loss=0.01197 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.057 | L2-Norm(final)=7.434 | 4933.5 samples/s | 77.1 steps/s
[Step=15900 Epoch=31.1] | Loss=0.01185 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.060 | L2-Norm(final)=7.435 | 4939.0 samples/s | 77.2 steps/s
[Step=15950 Epoch=31.2] | Loss=0.01186 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.062 | L2-Norm(final)=7.436 | 4822.5 samples/s | 75.4 steps/s
[Step=16000 Epoch=31.3] | Loss=0.01171 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.065 | L2-Norm(final)=7.438 | 4884.6 samples/s | 76.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step16000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=18001 Epoch=69.0] | Loss=0.00088 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.883 | L2-Norm(final)=9.693 | 3734.5 samples/s | 58.4 steps/s
[Step=18050 Epoch=69.2] | Loss=0.00053 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.880 | L2-Norm(final)=9.702 | 5245.0 samples/s | 82.0 steps/s
[Step=18100 Epoch=69.4] | Loss=0.00067 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.879 | L2-Norm(final)=9.715 | 5389.3 samples/s | 84.2 steps/s
[Step=18150 Epoch=69.5] | Loss=0.00062 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.879 | L2-Norm(final)=9.727 | 5315.7 samples/s | 83.1 steps/s
[Step=18200 Epoch=69.7] | Loss=0.00064 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.879 | L2-Norm(final)=9.739 | 5391.2 samples/s | 84.2 steps/s
[Step=18250 Epoch=69.9] | Loss=0.00068 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.879 | L2-Norm(final)=9.751 | 6942.5 samples/s | 108.5 steps/s
[Step=18300 Epoch=70.1] | Loss=0.00064 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.879 | L2-Norm(final)=9.763 | 1962.8 samples/s | 30.7 steps/s
[Step=18350 Epoch=70.3] | Loss=0.00069 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.879 | L2-Norm(final)=9.775 | 5293.3 samples/s | 82.7 steps/s
[Step=18400 Epoch=70.5] | Loss=0.00065 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.879 | L2-Norm(final)=9.786 | 5406.7 samples/s | 84.5 steps/s
[Step=18450 Epoch=70.7] | Loss=0.00064 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.879 | L2-Norm(final)=9.796 | 5369.4 samples/s | 83.9 steps/s
[Step=18500 Epoch=70.9] | Loss=0.00062 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.879 | L2-Norm(final)=9.806 | 5990.5 samples/s | 93.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=70.9] | Loss=0.00016 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.879 | L2-Norm(final)=9.905 | 3884.9 samples/s | 60.7 steps/s
[Step=18550 Epoch=71.1] | Loss=0.00105 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.889 | L2-Norm(final)=9.908 | 4541.6 samples/s | 71.0 steps/s
[Step=18600 Epoch=71.3] | Loss=0.00087 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.912 | L2-Norm(final)=9.911 | 4755.8 samples/s | 74.3 steps/s
[Step=18650 Epoch=71.5] | Loss=0.00090 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.922 | L2-Norm(final)=9.912 | 4616.3 samples/s | 72.1 steps/s
[Step=18700 Epoch=71.7] | Loss=0.00080 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.930 | L2-Norm(final)=9.913 | 4722.3 samples/s | 73.8 steps/s
[Step=18750 Epoch=71.8] | Loss=0.00072 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.933 | L2-Norm(final)=9.914 | 5920.8 samples/s | 92.5 steps/s
[Step=18800 Epoch=72.0] | Loss=0.00065 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.934 | L2-Norm(final)=9.915 | 1857.8 samples/s | 29.0 steps/s
[Step=18850 Epoch=72.2] | Loss=0.00056 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.933 | L2-Norm(final)=9.915 | 4704.1 samples/s | 73.5 steps/s
[Step=18900 Epoch=72.4] | Loss=0.00055 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.931 | L2-Norm(final)=9.915 | 4710.5 samples/s | 73.6 steps/s
[Step=18950 Epoch=72.6] | Loss=0.00051 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.929 | L2-Norm(final)=9.916 | 4799.1 samples/s | 75.0 steps/s
[Step=19000 Epoch=72.8] | Loss=0.00070 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.928 | L2-Norm(final)=9.915 | 5126.3 samples/s | 80.1 steps/s
[Step=19050 Epoch=73.0] | Loss=0.00066 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.929 | L2-Norm(final)=9.915 | 1939.9 samples/s | 30.3 steps/s
[Step=19100 Epoch=73.2] | Loss=0.00062 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.929 | L2-Norm(final)=9.914 | 4685.9 samples/s | 73.2 steps/s
[Step=19150 Epoch=73.4] | Loss=0.00059 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.929 | L2-Norm(final)=9.914 | 4712.3 samples/s | 73.6 steps/s
[Step=19200 Epoch=73.6] | Loss=0.00055 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.929 | L2-Norm(final)=9.914 | 4672.6 samples/s | 73.0 steps/s
[Step=19250 Epoch=73.8] | Loss=0.00057 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.928 | L2-Norm(final)=9.914 | 4764.9 samples/s | 74.5 steps/s
[Step=19300 Epoch=74.0] | Loss=0.00055 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.928 | L2-Norm(final)=9.915 | 2006.9 samples/s | 31.4 steps/s
[Step=19350 Epoch=74.1] | Loss=0.00052 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.927 | L2-Norm(final)=9.915 | 4836.2 samples/s | 75.6 steps/s
[Step=19400 Epoch=74.3] | Loss=0.00049 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.926 | L2-Norm(final)=9.915 | 4663.9 samples/s | 72.9 steps/s
[Step=19450 Epoch=74.5] | Loss=0.00046 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.924 | L2-Norm(final)=9.915 | 4787.5 samples/s | 74.8 steps/s
[Step=19500 Epoch=74.7] | Loss=0.00044 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.923 | L2-Norm(final)=9.916 | 4739.2 samples/s | 74.1 steps/s
[Step=19550 Epoch=74.9] | Loss=0.00042 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.920 | L2-Norm(final)=9.916 | 2009.4 samples/s | 31.4 steps/s
[Step=19600 Epoch=75.1] | Loss=0.00040 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.918 | L2-Norm(final)=9.916 | 4752.2 samples/s | 74.3 steps/s
[Step=19650 Epoch=75.3] | Loss=0.00038 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.915 | L2-Norm(final)=9.916 | 4671.3 samples/s | 73.0 steps/s
[Step=19700 Epoch=75.5] | Loss=0.00037 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.912 | L2-Norm(final)=9.917 | 4649.5 samples/s | 72.6 steps/s
[Step=19750 Epoch=75.7] | Loss=0.00035 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.909 | L2-Norm(final)=9.917 | 4757.5 samples/s | 74.3 steps/s
[Step=19800 Epoch=75.9] | Loss=0.00034 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.905 | L2-Norm(final)=9.917 | 6412.1 samples/s | 100.2 steps/s
[Step=19850 Epoch=76.1] | Loss=0.00033 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.901 | L2-Norm(final)=9.917 | 1812.5 samples/s | 28.3 steps/s
[Step=19900 Epoch=76.2] | Loss=0.00031 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.898 | L2-Norm(final)=9.917 | 4724.3 samples/s | 73.8 steps/s
[Step=19950 Epoch=76.4] | Loss=0.00030 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.894 | L2-Norm(final)=9.918 | 4659.8 samples/s | 72.8 steps/s
[Step=20000 Epoch=76.6] | Loss=0.00029 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.889 | L2-Norm(final)=9.918 | 4689.2 samples/s | 73.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07311 | acc=0.9643 | tpr=0.9661 | fpr=0.0396 | 4334.6 samples/s | 16.9 steps/s
Avg test loss: 0.07291, Avg test acc: 0.96358, Avg tpr: 0.96550, Avg fpr: 0.04064, total FA: 317

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07056 | acc=0.9681 | tpr=0.9779 | fpr=0.0530 | 4375.0 samples/s | 17.1 steps/s
Avg test loss: 0.07410, Avg test acc: 0.96694, Avg tpr: 0.97680, Avg fpr: 0.05474, total FA: 427

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.49598 | acc=0.2905 | tpr=0.0146 | fpr=0.1103 | 4310.7 samples/s | 16.8 steps/s
Avg test loss: 7.51408, Avg test acc: 0.28856, Avg tpr: 0.01451, Avg fpr: 0.10870, total FA: 848

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.00880 | acc=0.2968 | tpr=0.0241 | fpr=0.1110 | 4372.9 samples/s | 17.1 steps/s
Avg test loss: 7.01611, Avg test acc: 0.29373, Avg tpr: 0.02343, Avg fpr: 0.11178, total FA: 872

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.85240 | acc=0.1573 | tpr=0.6549 | fpr=0.8516 | 4364.0 samples/s | 17.0 steps/s
[Step= 100] | Loss=4.82298 | acc=0.1588 | tpr=0.6695 | fpr=0.8508 | 8772.3 samples/s | 34.3 steps/s
[Step= 150] | Loss=4.82254 | acc=0.1576 | tpr=0.6599 | fpr=0.8517 | 8733.2 samples/s | 34.1 steps/s
[Step= 200] | Loss=4.80671 | acc=0.1582 | tpr=0.6546 | fpr=0.8509 | 8238.0 samples/s | 32.2 steps/s
[Step= 250] | Loss=4.80233 | acc=0.1583 | tpr=0.6376 | fpr=0.8505 | 8711.8 samples/s | 34.0 steps/s
[Step= 300] | Loss=4.79989 | acc=0.1582 | tpr=0.6342 | fpr=0.8504 | 8914.2 samples/s | 34.8 steps/s
[Step= 350] | Loss=4.79428 | acc=0.1575 | tpr=0.6362 | fpr=0.8512 | 8560.3 samples/s | 33.4 steps/s
[Step= 400] | Loss=4.78813 | acc=0.1579 | tpr=0.6395 | fpr=0.8509 | 8238.5 samples/s | 32.2 steps/s
[Step= 450] | Loss=4.78574 | acc=0.1574 | tpr=0.6397 | fpr=0.8513 | 8850.8 samples/s | 34.6 steps/s
[Step= 500] | Loss=4.78787 | acc=0.1575 | tpr=0.6396 | fpr=0.8513 | 8516.5 samples/s | 33.3 steps/s
[Step= 550] | Loss=4.79200 | acc=0.1572 | tpr=0.6363 | fpr=0.8515 | 15639.7 samples/s | 61.1 steps/s
Avg test loss: 4.79280, Avg test acc: 0.15710, Avg tpr: 0.63629, Avg fpr: 0.85161, total FA: 118245

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.28115 | acc=0.1362 | tpr=0.7655 | fpr=0.8751 | 4411.7 samples/s | 17.2 steps/s
[Step= 100] | Loss=6.25804 | acc=0.1386 | tpr=0.7889 | fpr=0.8735 | 8475.1 samples/s | 33.1 steps/s
[Step= 150] | Loss=6.25179 | acc=0.1385 | tpr=0.7781 | fpr=0.8732 | 8613.6 samples/s | 33.6 steps/s
[Step= 200] | Loss=6.23219 | acc=0.1390 | tpr=0.7738 | fpr=0.8725 | 9070.7 samples/s | 35.4 steps/s
[Step= 250] | Loss=6.22669 | acc=0.1397 | tpr=0.7659 | fpr=0.8718 | 8037.0 samples/s | 31.4 steps/s
[Step= 300] | Loss=6.22531 | acc=0.1400 | tpr=0.7724 | fpr=0.8715 | 8585.1 samples/s | 33.5 steps/s
[Step= 350] | Loss=6.21921 | acc=0.1395 | tpr=0.7758 | fpr=0.8720 | 9130.0 samples/s | 35.7 steps/s
[Step= 400] | Loss=6.21357 | acc=0.1394 | tpr=0.7757 | fpr=0.8722 | 8436.5 samples/s | 33.0 steps/s
[Step= 450] | Loss=6.21007 | acc=0.1392 | tpr=0.7790 | fpr=0.8724 | 8728.2 samples/s | 34.1 steps/s
[Step= 500] | Loss=6.21090 | acc=0.1391 | tpr=0.7806 | fpr=0.8725 | 8686.7 samples/s | 33.9 steps/s
[Step= 550] | Loss=6.21171 | acc=0.1389 | tpr=0.7839 | fpr=0.8728 | 15497.5 samples/s | 60.5 steps/s
Avg test loss: 6.21281, Avg test acc: 0.13881, Avg tpr: 0.78447, Avg fpr: 0.87293, total FA: 121204

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.18857 | acc=0.9780 | tpr=0.9425 | fpr=0.0214 | 4336.7 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.20395 | acc=0.9772 | tpr=0.9574 | fpr=0.0224 | 8505.9 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.21103 | acc=0.9767 | tpr=0.9568 | fpr=0.0229 | 8845.2 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.21361 | acc=0.9773 | tpr=0.9617 | fpr=0.0224 | 8686.5 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.21070 | acc=0.9777 | tpr=0.9624 | fpr=0.0221 | 8644.8 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.21396 | acc=0.9774 | tpr=0.9593 | fpr=0.0223 | 8608.4 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.21554 | acc=0.9772 | tpr=0.9606 | fpr=0.0225 | 8898.0 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.21755 | acc=0.9769 | tpr=0.9573 | fpr=0.0227 | 8568.7 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.22201 | acc=0.9766 | tpr=0.9552 | fpr=0.0230 | 8731.0 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.22154 | acc=0.9766 | tpr=0.9559 | fpr=0.0230 | 8581.9 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.21954 | acc=0.9767 | tpr=0.9562 | fpr=0.0230 | 15434.9 samples/s | 60.3 steps/s
Avg test loss: 0.21908, Avg test acc: 0.97665, Avg tpr: 0.95602, Avg fpr: 0.02297, total FA: 3190

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16783 | acc=0.9796 | tpr=0.9381 | fpr=0.0196 | 4284.2 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.18140 | acc=0.9782 | tpr=0.9446 | fpr=0.0211 | 8901.2 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.18823 | acc=0.9777 | tpr=0.9496 | fpr=0.0218 | 8517.1 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.18924 | acc=0.9779 | tpr=0.9530 | fpr=0.0217 | 8522.5 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.18657 | acc=0.9782 | tpr=0.9546 | fpr=0.0213 | 9272.1 samples/s | 36.2 steps/s
[Step= 300] | Loss=0.18858 | acc=0.9780 | tpr=0.9520 | fpr=0.0215 | 8550.3 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.18988 | acc=0.9779 | tpr=0.9524 | fpr=0.0217 | 8311.6 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.19168 | acc=0.9776 | tpr=0.9502 | fpr=0.0219 | 8616.7 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.19519 | acc=0.9775 | tpr=0.9479 | fpr=0.0220 | 8622.4 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.19448 | acc=0.9775 | tpr=0.9485 | fpr=0.0219 | 8912.5 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.19291 | acc=0.9776 | tpr=0.9475 | fpr=0.0218 | 15217.6 samples/s | 59.4 steps/s
Avg test loss: 0.19252, Avg test acc: 0.97766, Avg tpr: 0.94731, Avg fpr: 0.02179, total FA: 3025

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=54.6] | Loss=0.02074 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.896 | L2-Norm(final)=9.392 | 3744.2 samples/s | 58.5 steps/s
[Step=28050 Epoch=54.7] | Loss=0.01985 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.897 | L2-Norm(final)=9.390 | 5272.4 samples/s | 82.4 steps/s
[Step=28100 Epoch=54.8] | Loss=0.01834 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.897 | L2-Norm(final)=9.391 | 5696.2 samples/s | 89.0 steps/s
[Step=28150 Epoch=54.9] | Loss=0.01606 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.897 | L2-Norm(final)=9.394 | 5762.7 samples/s | 90.0 steps/s
[Step=28200 Epoch=55.0] | Loss=0.01633 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.897 | L2-Norm(final)=9.397 | 5569.4 samples/s | 87.0 steps/s
[Step=28250 Epoch=55.1] | Loss=0.01593 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.897 | L2-Norm(final)=9.400 | 5759.9 samples/s | 90.0 steps/s
[Step=28300 Epoch=55.2] | Loss=0.01593 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.897 | L2-Norm(final)=9.403 | 5811.0 samples/s | 90.8 steps/s
[Step=28350 Epoch=55.3] | Loss=0.01638 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.897 | L2-Norm(final)=9.404 | 5704.7 samples/s | 89.1 steps/s
[Step=28400 Epoch=55.4] | Loss=0.01646 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.897 | L2-Norm(final)=9.406 | 5577.0 samples/s | 87.1 steps/s
[Step=28450 Epoch=55.5] | Loss=0.01628 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.897 | L2-Norm(final)=9.407 | 5747.9 samples/s | 89.8 steps/s
[Step=28500 Epoch=55.6] | Loss=0.01608 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.897 | L2-Norm(final)=9.409 | 7161.0 samples/s | 111.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=55.6] | Loss=0.01837 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.897 | L2-Norm(final)=9.426 | 3667.6 samples/s | 57.3 steps/s
[Step=28550 Epoch=55.7] | Loss=0.01608 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.909 | L2-Norm(final)=9.426 | 4924.9 samples/s | 77.0 steps/s
[Step=28600 Epoch=55.8] | Loss=0.01666 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.922 | L2-Norm(final)=9.425 | 4994.5 samples/s | 78.0 steps/s
[Step=28650 Epoch=55.9] | Loss=0.01514 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.932 | L2-Norm(final)=9.426 | 4888.7 samples/s | 76.4 steps/s
[Step=28700 Epoch=56.0] | Loss=0.01494 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.940 | L2-Norm(final)=9.426 | 5022.8 samples/s | 78.5 steps/s
[Step=28750 Epoch=56.1] | Loss=0.01416 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.946 | L2-Norm(final)=9.427 | 4921.5 samples/s | 76.9 steps/s
[Step=28800 Epoch=56.2] | Loss=0.01348 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.952 | L2-Norm(final)=9.428 | 4949.2 samples/s | 77.3 steps/s
[Step=28850 Epoch=56.3] | Loss=0.01322 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.957 | L2-Norm(final)=9.429 | 4983.4 samples/s | 77.9 steps/s
[Step=28900 Epoch=56.4] | Loss=0.01302 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.962 | L2-Norm(final)=9.430 | 4987.0 samples/s | 77.9 steps/s
[Step=28950 Epoch=56.5] | Loss=0.01305 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.966 | L2-Norm(final)=9.431 | 4973.4 samples/s | 77.7 steps/s
[Step=29000 Epoch=56.6] | Loss=0.01308 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.971 | L2-Norm(final)=9.432 | 6055.4 samples/s | 94.6 steps/s
[Step=29050 Epoch=56.7] | Loss=0.01269 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.975 | L2-Norm(final)=9.433 | 1830.0 samples/s | 28.6 steps/s
[Step=29100 Epoch=56.8] | Loss=0.01218 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.979 | L2-Norm(final)=9.434 | 4991.9 samples/s | 78.0 steps/s
[Step=29150 Epoch=56.9] | Loss=0.01214 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.984 | L2-Norm(final)=9.435 | 4773.1 samples/s | 74.6 steps/s
[Step=29200 Epoch=57.0] | Loss=0.01192 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.987 | L2-Norm(final)=9.436 | 4947.0 samples/s | 77.3 steps/s
[Step=29250 Epoch=57.0] | Loss=0.01189 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.991 | L2-Norm(final)=9.437 | 4179.9 samples/s | 65.3 steps/s
[Step=29300 Epoch=57.1] | Loss=0.01176 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.995 | L2-Norm(final)=9.438 | 4284.0 samples/s | 66.9 steps/s
[Step=29350 Epoch=57.2] | Loss=0.01158 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.998 | L2-Norm(final)=9.439 | 4956.0 samples/s | 77.4 steps/s
[Step=29400 Epoch=57.3] | Loss=0.01143 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.001 | L2-Norm(final)=9.441 | 4758.0 samples/s | 74.3 steps/s
[Step=29450 Epoch=57.4] | Loss=0.01124 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.004 | L2-Norm(final)=9.442 | 5041.8 samples/s | 78.8 steps/s
[Step=29500 Epoch=57.5] | Loss=0.01111 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.007 | L2-Norm(final)=9.443 | 5207.0 samples/s | 81.4 steps/s
[Step=29550 Epoch=57.6] | Loss=0.01097 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.009 | L2-Norm(final)=9.444 | 1943.7 samples/s | 30.4 steps/s
[Step=29600 Epoch=57.7] | Loss=0.01073 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.012 | L2-Norm(final)=9.445 | 4913.4 samples/s | 76.8 steps/s
[Step=29650 Epoch=57.8] | Loss=0.01058 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.014 | L2-Norm(final)=9.447 | 4890.6 samples/s | 76.4 steps/s
[Step=29700 Epoch=57.9] | Loss=0.01047 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.017 | L2-Norm(final)=9.448 | 4956.6 samples/s | 77.4 steps/s
[Step=29750 Epoch=58.0] | Loss=0.01040 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.019 | L2-Norm(final)=9.449 | 4985.8 samples/s | 77.9 steps/s
[Step=29800 Epoch=58.1] | Loss=0.01034 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.021 | L2-Norm(final)=9.450 | 4928.9 samples/s | 77.0 steps/s
[Step=29850 Epoch=58.2] | Loss=0.01021 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.024 | L2-Norm(final)=9.451 | 4976.8 samples/s | 77.8 steps/s
[Step=29900 Epoch=58.3] | Loss=0.01013 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.026 | L2-Norm(final)=9.453 | 4972.2 samples/s | 77.7 steps/s
[Step=29950 Epoch=58.4] | Loss=0.01005 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.028 | L2-Norm(final)=9.454 | 5035.4 samples/s | 78.7 steps/s
[Step=30000 Epoch=58.5] | Loss=0.00998 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.030 | L2-Norm(final)=9.455 | 4954.9 samples/s | 77.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step30000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=16001 Epoch=31.3] | Loss=0.01592 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.896 | L2-Norm(final)=7.477 | 4091.1 samples/s | 63.9 steps/s
[Step=16050 Epoch=31.4] | Loss=0.02235 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.897 | L2-Norm(final)=7.481 | 5190.2 samples/s | 81.1 steps/s
[Step=16100 Epoch=31.5] | Loss=0.02111 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.897 | L2-Norm(final)=7.484 | 5491.6 samples/s | 85.8 steps/s
[Step=16150 Epoch=31.6] | Loss=0.02250 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.897 | L2-Norm(final)=7.485 | 5713.4 samples/s | 89.3 steps/s
[Step=16200 Epoch=31.7] | Loss=0.02291 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.897 | L2-Norm(final)=7.485 | 5619.1 samples/s | 87.8 steps/s
[Step=16250 Epoch=31.8] | Loss=0.02217 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.897 | L2-Norm(final)=7.487 | 5684.1 samples/s | 88.8 steps/s
[Step=16300 Epoch=31.9] | Loss=0.02166 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.897 | L2-Norm(final)=7.489 | 5745.8 samples/s | 89.8 steps/s
[Step=16350 Epoch=32.0] | Loss=0.02118 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.897 | L2-Norm(final)=7.492 | 5638.8 samples/s | 88.1 steps/s
[Step=16400 Epoch=32.1] | Loss=0.02130 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.897 | L2-Norm(final)=7.495 | 5747.0 samples/s | 89.8 steps/s
[Step=16450 Epoch=32.2] | Loss=0.02085 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.897 | L2-Norm(final)=7.499 | 5658.2 samples/s | 88.4 steps/s
[Step=16500 Epoch=32.3] | Loss=0.02121 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.897 | L2-Norm(final)=7.502 | 7357.4 samples/s | 115.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=16501 Epoch=32.3] | Loss=0.02770 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.897 | L2-Norm(final)=7.537 | 3753.0 samples/s | 58.6 steps/s
[Step=16550 Epoch=32.4] | Loss=0.01863 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.912 | L2-Norm(final)=7.539 | 5034.1 samples/s | 78.7 steps/s
[Step=16600 Epoch=32.5] | Loss=0.02020 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.927 | L2-Norm(final)=7.539 | 4882.2 samples/s | 76.3 steps/s
[Step=16650 Epoch=32.6] | Loss=0.01872 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.939 | L2-Norm(final)=7.538 | 5047.9 samples/s | 78.9 steps/s
[Step=16700 Epoch=32.6] | Loss=0.01830 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.950 | L2-Norm(final)=7.538 | 4919.0 samples/s | 76.9 steps/s
[Step=16750 Epoch=32.7] | Loss=0.01747 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.960 | L2-Norm(final)=7.538 | 4924.0 samples/s | 76.9 steps/s
[Step=16800 Epoch=32.8] | Loss=0.01688 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.969 | L2-Norm(final)=7.538 | 5047.8 samples/s | 78.9 steps/s
[Step=16850 Epoch=32.9] | Loss=0.01701 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.978 | L2-Norm(final)=7.538 | 4897.1 samples/s | 76.5 steps/s
[Step=16900 Epoch=33.0] | Loss=0.01699 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.985 | L2-Norm(final)=7.538 | 4980.1 samples/s | 77.8 steps/s
[Step=16950 Epoch=33.1] | Loss=0.01678 | Reg=0.00196 | acc=0.9688 | L2-Norm=13.992 | L2-Norm(final)=7.538 | 4999.4 samples/s | 78.1 steps/s
[Step=17000 Epoch=33.2] | Loss=0.01647 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.998 | L2-Norm(final)=7.538 | 6122.6 samples/s | 95.7 steps/s
[Step=17050 Epoch=33.3] | Loss=0.01567 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.004 | L2-Norm(final)=7.539 | 1907.8 samples/s | 29.8 steps/s
[Step=17100 Epoch=33.4] | Loss=0.01520 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.009 | L2-Norm(final)=7.540 | 5013.9 samples/s | 78.3 steps/s
[Step=17150 Epoch=33.5] | Loss=0.01465 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.014 | L2-Norm(final)=7.542 | 4900.2 samples/s | 76.6 steps/s
[Step=17200 Epoch=33.6] | Loss=0.01407 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.019 | L2-Norm(final)=7.543 | 4969.1 samples/s | 77.6 steps/s
[Step=17250 Epoch=33.7] | Loss=0.01381 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.023 | L2-Norm(final)=7.545 | 4867.3 samples/s | 76.1 steps/s
[Step=17300 Epoch=33.8] | Loss=0.01362 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.027 | L2-Norm(final)=7.546 | 4944.8 samples/s | 77.3 steps/s
[Step=17350 Epoch=33.9] | Loss=0.01330 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.031 | L2-Norm(final)=7.548 | 4990.5 samples/s | 78.0 steps/s
[Step=17400 Epoch=34.0] | Loss=0.01317 | Reg=0.00197 | acc=0.9531 | L2-Norm=14.034 | L2-Norm(final)=7.549 | 4996.5 samples/s | 78.1 steps/s
[Step=17450 Epoch=34.1] | Loss=0.01302 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.038 | L2-Norm(final)=7.550 | 4993.7 samples/s | 78.0 steps/s
[Step=17500 Epoch=34.2] | Loss=0.01301 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.041 | L2-Norm(final)=7.551 | 5305.8 samples/s | 82.9 steps/s
[Step=17550 Epoch=34.3] | Loss=0.01296 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.045 | L2-Norm(final)=7.552 | 1987.5 samples/s | 31.1 steps/s
[Step=17600 Epoch=34.4] | Loss=0.01274 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.048 | L2-Norm(final)=7.553 | 4963.3 samples/s | 77.6 steps/s
[Step=17650 Epoch=34.5] | Loss=0.01258 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.051 | L2-Norm(final)=7.554 | 5002.8 samples/s | 78.2 steps/s
[Step=17700 Epoch=34.6] | Loss=0.01245 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.054 | L2-Norm(final)=7.555 | 4917.8 samples/s | 76.8 steps/s
[Step=17750 Epoch=34.7] | Loss=0.01221 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.057 | L2-Norm(final)=7.556 | 4941.3 samples/s | 77.2 steps/s
[Step=17800 Epoch=34.8] | Loss=0.01204 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.060 | L2-Norm(final)=7.557 | 4982.2 samples/s | 77.8 steps/s
[Step=17850 Epoch=34.9] | Loss=0.01181 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.063 | L2-Norm(final)=7.558 | 5023.6 samples/s | 78.5 steps/s
[Step=17900 Epoch=35.0] | Loss=0.01172 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.065 | L2-Norm(final)=7.560 | 4892.9 samples/s | 76.5 steps/s
[Step=17950 Epoch=35.1] | Loss=0.01163 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.068 | L2-Norm(final)=7.561 | 5049.3 samples/s | 78.9 steps/s
[Step=18000 Epoch=35.2] | Loss=0.01152 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.070 | L2-Norm(final)=7.562 | 4859.6 samples/s | 75.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step18000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07199 | acc=0.9670 | tpr=0.9712 | fpr=0.0421 | 4336.4 samples/s | 16.9 steps/s
Avg test loss: 0.07281, Avg test acc: 0.96658, Avg tpr: 0.97062, Avg fpr: 0.04230, total FA: 330

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07019 | acc=0.9695 | tpr=0.9795 | fpr=0.0523 | 4353.3 samples/s | 17.0 steps/s
Avg test loss: 0.07152, Avg test acc: 0.96815, Avg tpr: 0.97861, Avg fpr: 0.05486, total FA: 428

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.49598 | acc=0.2905 | tpr=0.0146 | fpr=0.1103 | 4429.0 samples/s | 17.3 steps/s
Avg test loss: 7.51408, Avg test acc: 0.28856, Avg tpr: 0.01451, Avg fpr: 0.10870, total FA: 848

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.00880 | acc=0.2968 | tpr=0.0241 | fpr=0.1110 | 4374.1 samples/s | 17.1 steps/s
Avg test loss: 7.01611, Avg test acc: 0.29373, Avg tpr: 0.02343, Avg fpr: 0.11178, total FA: 872

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.53230 | acc=0.1431 | tpr=0.7566 | fpr=0.8679 | 4363.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.50762 | acc=0.1464 | tpr=0.7697 | fpr=0.8653 | 8710.8 samples/s | 34.0 steps/s
[Step= 150] | Loss=5.50829 | acc=0.1454 | tpr=0.7550 | fpr=0.8659 | 8585.3 samples/s | 33.5 steps/s
[Step= 200] | Loss=5.49359 | acc=0.1456 | tpr=0.7530 | fpr=0.8654 | 8497.4 samples/s | 33.2 steps/s
[Step= 250] | Loss=5.48855 | acc=0.1456 | tpr=0.7424 | fpr=0.8652 | 8613.1 samples/s | 33.6 steps/s
[Step= 300] | Loss=5.48834 | acc=0.1459 | tpr=0.7425 | fpr=0.8650 | 9037.2 samples/s | 35.3 steps/s
[Step= 350] | Loss=5.48255 | acc=0.1452 | tpr=0.7470 | fpr=0.8657 | 8419.5 samples/s | 32.9 steps/s
[Step= 400] | Loss=5.47588 | acc=0.1451 | tpr=0.7495 | fpr=0.8659 | 8951.4 samples/s | 35.0 steps/s
[Step= 450] | Loss=5.47306 | acc=0.1450 | tpr=0.7537 | fpr=0.8661 | 8311.1 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.47428 | acc=0.1446 | tpr=0.7564 | fpr=0.8665 | 8827.5 samples/s | 34.5 steps/s
[Step= 550] | Loss=5.47677 | acc=0.1445 | tpr=0.7533 | fpr=0.8666 | 15462.8 samples/s | 60.4 steps/s
Avg test loss: 5.47764, Avg test acc: 0.14438, Avg tpr: 0.75317, Avg fpr: 0.86669, total FA: 120338

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.45033 | acc=0.1241 | tpr=0.7212 | fpr=0.8867 | 4405.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=6.42934 | acc=0.1280 | tpr=0.7527 | fpr=0.8836 | 8612.3 samples/s | 33.6 steps/s
[Step= 150] | Loss=6.42312 | acc=0.1266 | tpr=0.7421 | fpr=0.8847 | 8776.1 samples/s | 34.3 steps/s
[Step= 200] | Loss=6.40765 | acc=0.1267 | tpr=0.7388 | fpr=0.8844 | 8456.0 samples/s | 33.0 steps/s
[Step= 250] | Loss=6.40512 | acc=0.1266 | tpr=0.7266 | fpr=0.8843 | 8661.0 samples/s | 33.8 steps/s
[Step= 300] | Loss=6.40396 | acc=0.1267 | tpr=0.7302 | fpr=0.8843 | 9005.1 samples/s | 35.2 steps/s
[Step= 350] | Loss=6.39816 | acc=0.1260 | tpr=0.7326 | fpr=0.8850 | 8270.0 samples/s | 32.3 steps/s
[Step= 400] | Loss=6.39130 | acc=0.1260 | tpr=0.7341 | fpr=0.8850 | 8794.5 samples/s | 34.4 steps/s
[Step= 450] | Loss=6.38703 | acc=0.1259 | tpr=0.7371 | fpr=0.8852 | 8861.8 samples/s | 34.6 steps/s
[Step= 500] | Loss=6.38946 | acc=0.1256 | tpr=0.7383 | fpr=0.8855 | 8459.8 samples/s | 33.0 steps/s
[Step= 550] | Loss=6.38953 | acc=0.1255 | tpr=0.7394 | fpr=0.8857 | 14907.7 samples/s | 58.2 steps/s
Avg test loss: 6.39057, Avg test acc: 0.12542, Avg tpr: 0.73970, Avg fpr: 0.88575, total FA: 122984

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.18857 | acc=0.9780 | tpr=0.9425 | fpr=0.0214 | 4324.5 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.20395 | acc=0.9772 | tpr=0.9574 | fpr=0.0224 | 8657.1 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.21103 | acc=0.9767 | tpr=0.9568 | fpr=0.0229 | 8573.5 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.21361 | acc=0.9773 | tpr=0.9617 | fpr=0.0224 | 8777.0 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.21070 | acc=0.9777 | tpr=0.9624 | fpr=0.0221 | 8545.1 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.21396 | acc=0.9774 | tpr=0.9593 | fpr=0.0223 | 8650.8 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.21554 | acc=0.9772 | tpr=0.9606 | fpr=0.0225 | 8984.9 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.21755 | acc=0.9769 | tpr=0.9573 | fpr=0.0227 | 8408.8 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.22201 | acc=0.9766 | tpr=0.9552 | fpr=0.0230 | 8535.5 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.22154 | acc=0.9766 | tpr=0.9559 | fpr=0.0230 | 8797.0 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.21954 | acc=0.9767 | tpr=0.9562 | fpr=0.0230 | 15229.8 samples/s | 59.5 steps/s
Avg test loss: 0.21908, Avg test acc: 0.97665, Avg tpr: 0.95602, Avg fpr: 0.02297, total FA: 3190

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16783 | acc=0.9796 | tpr=0.9381 | fpr=0.0196 | 4368.5 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.18140 | acc=0.9782 | tpr=0.9446 | fpr=0.0211 | 8523.0 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.18823 | acc=0.9777 | tpr=0.9496 | fpr=0.0218 | 8865.3 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.18924 | acc=0.9779 | tpr=0.9530 | fpr=0.0217 | 8334.5 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.18657 | acc=0.9782 | tpr=0.9546 | fpr=0.0213 | 8860.3 samples/s | 34.6 steps/s
[Step= 300] | Loss=0.18858 | acc=0.9780 | tpr=0.9520 | fpr=0.0215 | 8528.6 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.18988 | acc=0.9779 | tpr=0.9524 | fpr=0.0217 | 8686.5 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.19168 | acc=0.9776 | tpr=0.9502 | fpr=0.0219 | 8782.7 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.19519 | acc=0.9775 | tpr=0.9479 | fpr=0.0220 | 9147.1 samples/s | 35.7 steps/s
[Step= 500] | Loss=0.19448 | acc=0.9775 | tpr=0.9485 | fpr=0.0219 | 8376.1 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.19291 | acc=0.9776 | tpr=0.9475 | fpr=0.0218 | 14620.7 samples/s | 57.1 steps/s
Avg test loss: 0.19252, Avg test acc: 0.97766, Avg tpr: 0.94731, Avg fpr: 0.02179, total FA: 3025

server round 24/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=18001 Epoch=35.2] | Loss=0.02499 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.760 | L2-Norm(final)=7.595 | 3851.6 samples/s | 60.2 steps/s
[Step=18050 Epoch=35.3] | Loss=0.01794 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.761 | L2-Norm(final)=7.597 | 5447.4 samples/s | 85.1 steps/s
[Step=18100 Epoch=35.4] | Loss=0.01724 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.761 | L2-Norm(final)=7.604 | 5621.0 samples/s | 87.8 steps/s
[Step=18150 Epoch=35.5] | Loss=0.01745 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.761 | L2-Norm(final)=7.611 | 5691.5 samples/s | 88.9 steps/s
[Step=18200 Epoch=35.6] | Loss=0.01810 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.761 | L2-Norm(final)=7.617 | 5612.3 samples/s | 87.7 steps/s
[Step=18250 Epoch=35.7] | Loss=0.01796 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.761 | L2-Norm(final)=7.621 | 5649.9 samples/s | 88.3 steps/s
[Step=18300 Epoch=35.8] | Loss=0.01824 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.761 | L2-Norm(final)=7.625 | 5691.1 samples/s | 88.9 steps/s
[Step=18350 Epoch=35.9] | Loss=0.01823 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.761 | L2-Norm(final)=7.629 | 5665.9 samples/s | 88.5 steps/s
[Step=18400 Epoch=36.0] | Loss=0.01797 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.761 | L2-Norm(final)=7.634 | 5688.4 samples/s | 88.9 steps/s
[Step=18450 Epoch=36.1] | Loss=0.01780 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.761 | L2-Norm(final)=7.639 | 5679.9 samples/s | 88.7 steps/s
[Step=18500 Epoch=36.2] | Loss=0.01824 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.761 | L2-Norm(final)=7.644 | 7353.2 samples/s | 114.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=36.2] | Loss=0.00312 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.761 | L2-Norm(final)=7.691 | 3827.6 samples/s | 59.8 steps/s
[Step=18550 Epoch=36.3] | Loss=0.01720 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.777 | L2-Norm(final)=7.691 | 4922.4 samples/s | 76.9 steps/s
[Step=18600 Epoch=36.4] | Loss=0.01587 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.793 | L2-Norm(final)=7.692 | 4966.7 samples/s | 77.6 steps/s
[Step=18650 Epoch=36.5] | Loss=0.01475 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.805 | L2-Norm(final)=7.694 | 4969.2 samples/s | 77.6 steps/s
[Step=18700 Epoch=36.6] | Loss=0.01474 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.815 | L2-Norm(final)=7.697 | 4916.4 samples/s | 76.8 steps/s
[Step=18750 Epoch=36.7] | Loss=0.01569 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.824 | L2-Norm(final)=7.698 | 4951.2 samples/s | 77.4 steps/s
[Step=18800 Epoch=36.8] | Loss=0.01603 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.833 | L2-Norm(final)=7.699 | 5006.8 samples/s | 78.2 steps/s
[Step=18850 Epoch=36.9] | Loss=0.01610 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.841 | L2-Norm(final)=7.699 | 4950.0 samples/s | 77.3 steps/s
[Step=18900 Epoch=36.9] | Loss=0.01591 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.849 | L2-Norm(final)=7.700 | 5029.3 samples/s | 78.6 steps/s
[Step=18950 Epoch=37.0] | Loss=0.01546 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.856 | L2-Norm(final)=7.701 | 4934.9 samples/s | 77.1 steps/s
[Step=19000 Epoch=37.1] | Loss=0.01512 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.863 | L2-Norm(final)=7.702 | 6163.4 samples/s | 96.3 steps/s
[Step=19050 Epoch=37.2] | Loss=0.01473 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.870 | L2-Norm(final)=7.704 | 1902.8 samples/s | 29.7 steps/s
[Step=19100 Epoch=37.3] | Loss=0.01429 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.876 | L2-Norm(final)=7.705 | 4945.1 samples/s | 77.3 steps/s
[Step=19150 Epoch=37.4] | Loss=0.01389 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.882 | L2-Norm(final)=7.707 | 4944.8 samples/s | 77.3 steps/s
[Step=19200 Epoch=37.5] | Loss=0.01349 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.887 | L2-Norm(final)=7.709 | 4976.1 samples/s | 77.8 steps/s
[Step=19250 Epoch=37.6] | Loss=0.01331 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.892 | L2-Norm(final)=7.711 | 4962.6 samples/s | 77.5 steps/s
[Step=19300 Epoch=37.7] | Loss=0.01327 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.897 | L2-Norm(final)=7.713 | 5019.5 samples/s | 78.4 steps/s
[Step=19350 Epoch=37.8] | Loss=0.01298 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.901 | L2-Norm(final)=7.714 | 4953.3 samples/s | 77.4 steps/s
[Step=19400 Epoch=37.9] | Loss=0.01288 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.905 | L2-Norm(final)=7.716 | 4958.3 samples/s | 77.5 steps/s
[Step=19450 Epoch=38.0] | Loss=0.01261 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.909 | L2-Norm(final)=7.718 | 4975.8 samples/s | 77.7 steps/s
[Step=19500 Epoch=38.1] | Loss=0.01252 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.913 | L2-Norm(final)=7.719 | 5383.0 samples/s | 84.1 steps/s
[Step=19550 Epoch=38.2] | Loss=0.01237 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.917 | L2-Norm(final)=7.721 | 2011.6 samples/s | 31.4 steps/s
[Step=19600 Epoch=38.3] | Loss=0.01219 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.921 | L2-Norm(final)=7.723 | 4950.8 samples/s | 77.4 steps/s
[Step=19650 Epoch=38.4] | Loss=0.01195 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.924 | L2-Norm(final)=7.724 | 4928.6 samples/s | 77.0 steps/s
[Step=19700 Epoch=38.5] | Loss=0.01171 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.927 | L2-Norm(final)=7.726 | 5030.1 samples/s | 78.6 steps/s
[Step=19750 Epoch=38.6] | Loss=0.01166 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.930 | L2-Norm(final)=7.728 | 4947.9 samples/s | 77.3 steps/s
[Step=19800 Epoch=38.7] | Loss=0.01148 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.933 | L2-Norm(final)=7.729 | 4932.5 samples/s | 77.1 steps/s
[Step=19850 Epoch=38.8] | Loss=0.01136 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.936 | L2-Norm(final)=7.731 | 5064.2 samples/s | 79.1 steps/s
[Step=19900 Epoch=38.9] | Loss=0.01128 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.939 | L2-Norm(final)=7.732 | 4941.6 samples/s | 77.2 steps/s
[Step=19950 Epoch=39.0] | Loss=0.01121 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.942 | L2-Norm(final)=7.734 | 4945.3 samples/s | 77.3 steps/s
[Step=20000 Epoch=39.1] | Loss=0.01109 | Reg=0.00194 | acc=0.9531 | L2-Norm=13.945 | L2-Norm(final)=7.736 | 5018.8 samples/s | 78.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step20000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=76.6] | Loss=0.00000 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.760 | L2-Norm(final)=9.922 | 3985.0 samples/s | 62.3 steps/s
[Step=20050 Epoch=76.8] | Loss=0.00012 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=9.926 | 4863.1 samples/s | 76.0 steps/s
[Step=20100 Epoch=77.0] | Loss=0.00009 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=9.929 | 5435.0 samples/s | 84.9 steps/s
[Step=20150 Epoch=77.2] | Loss=0.00013 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=9.933 | 5308.1 samples/s | 82.9 steps/s
[Step=20200 Epoch=77.4] | Loss=0.00014 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=9.937 | 5392.1 samples/s | 84.3 steps/s
[Step=20250 Epoch=77.6] | Loss=0.00014 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=9.941 | 7010.5 samples/s | 109.5 steps/s
[Step=20300 Epoch=77.8] | Loss=0.00015 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=9.944 | 1940.3 samples/s | 30.3 steps/s
[Step=20350 Epoch=78.0] | Loss=0.00014 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=9.948 | 5401.3 samples/s | 84.4 steps/s
[Step=20400 Epoch=78.2] | Loss=0.00013 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=9.951 | 5291.6 samples/s | 82.7 steps/s
[Step=20450 Epoch=78.4] | Loss=0.00014 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=9.954 | 5318.7 samples/s | 83.1 steps/s
[Step=20500 Epoch=78.5] | Loss=0.00014 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=9.958 | 6043.7 samples/s | 94.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=78.6] | Loss=0.00000 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=9.992 | 3939.1 samples/s | 61.5 steps/s
[Step=20550 Epoch=78.7] | Loss=0.00009 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.751 | L2-Norm(final)=9.995 | 4353.8 samples/s | 68.0 steps/s
[Step=20600 Epoch=78.9] | Loss=0.00007 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.749 | L2-Norm(final)=9.997 | 4704.1 samples/s | 73.5 steps/s
[Step=20650 Epoch=79.1] | Loss=0.00006 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.742 | L2-Norm(final)=9.998 | 4727.6 samples/s | 73.9 steps/s
[Step=20700 Epoch=79.3] | Loss=0.00005 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.735 | L2-Norm(final)=9.999 | 4678.9 samples/s | 73.1 steps/s
[Step=20750 Epoch=79.5] | Loss=0.00004 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.728 | L2-Norm(final)=10.000 | 5968.4 samples/s | 93.3 steps/s
[Step=20800 Epoch=79.7] | Loss=0.00004 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.719 | L2-Norm(final)=10.001 | 1855.9 samples/s | 29.0 steps/s
[Step=20850 Epoch=79.9] | Loss=0.00003 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.711 | L2-Norm(final)=10.002 | 4700.4 samples/s | 73.4 steps/s
[Step=20900 Epoch=80.1] | Loss=0.00003 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.702 | L2-Norm(final)=10.003 | 4692.3 samples/s | 73.3 steps/s
[Step=20950 Epoch=80.3] | Loss=0.00003 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.693 | L2-Norm(final)=10.003 | 4735.6 samples/s | 74.0 steps/s
[Step=21000 Epoch=80.5] | Loss=0.00002 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.685 | L2-Norm(final)=10.004 | 5163.6 samples/s | 80.7 steps/s
[Step=21050 Epoch=80.7] | Loss=0.00002 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.676 | L2-Norm(final)=10.004 | 1954.8 samples/s | 30.5 steps/s
[Step=21100 Epoch=80.8] | Loss=0.00002 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.667 | L2-Norm(final)=10.005 | 4745.8 samples/s | 74.2 steps/s
[Step=21150 Epoch=81.0] | Loss=0.00002 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.658 | L2-Norm(final)=10.005 | 4662.2 samples/s | 72.8 steps/s
[Step=21200 Epoch=81.2] | Loss=0.00002 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.649 | L2-Norm(final)=10.005 | 4722.2 samples/s | 73.8 steps/s
[Step=21250 Epoch=81.4] | Loss=0.00002 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.640 | L2-Norm(final)=10.006 | 4705.2 samples/s | 73.5 steps/s
[Step=21300 Epoch=81.6] | Loss=0.00002 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.630 | L2-Norm(final)=10.006 | 2008.0 samples/s | 31.4 steps/s
[Step=21350 Epoch=81.8] | Loss=0.00002 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.621 | L2-Norm(final)=10.007 | 4730.8 samples/s | 73.9 steps/s
[Step=21400 Epoch=82.0] | Loss=0.00001 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.612 | L2-Norm(final)=10.007 | 4799.2 samples/s | 75.0 steps/s
[Step=21450 Epoch=82.2] | Loss=0.00001 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.603 | L2-Norm(final)=10.007 | 4690.8 samples/s | 73.3 steps/s
[Step=21500 Epoch=82.4] | Loss=0.00001 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.593 | L2-Norm(final)=10.008 | 4647.6 samples/s | 72.6 steps/s
[Step=21550 Epoch=82.6] | Loss=0.00001 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.584 | L2-Norm(final)=10.008 | 2026.1 samples/s | 31.7 steps/s
[Step=21600 Epoch=82.8] | Loss=0.00001 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.574 | L2-Norm(final)=10.008 | 4752.4 samples/s | 74.3 steps/s
[Step=21650 Epoch=83.0] | Loss=0.00001 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=10.008 | 4621.6 samples/s | 72.2 steps/s
[Step=21700 Epoch=83.1] | Loss=0.00001 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.555 | L2-Norm(final)=10.009 | 4786.6 samples/s | 74.8 steps/s
[Step=21750 Epoch=83.3] | Loss=0.00001 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.545 | L2-Norm(final)=10.009 | 4636.2 samples/s | 72.4 steps/s
[Step=21800 Epoch=83.5] | Loss=0.00001 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.535 | L2-Norm(final)=10.009 | 6442.2 samples/s | 100.7 steps/s
[Step=21850 Epoch=83.7] | Loss=0.00001 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=10.010 | 1812.7 samples/s | 28.3 steps/s
[Step=21900 Epoch=83.9] | Loss=0.00001 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.515 | L2-Norm(final)=10.010 | 4728.2 samples/s | 73.9 steps/s
[Step=21950 Epoch=84.1] | Loss=0.00001 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.505 | L2-Norm(final)=10.010 | 4725.3 samples/s | 73.8 steps/s
[Step=22000 Epoch=84.3] | Loss=0.00001 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.495 | L2-Norm(final)=10.011 | 4782.0 samples/s | 74.7 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step22000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07199 | acc=0.9670 | tpr=0.9712 | fpr=0.0421 | 4329.0 samples/s | 16.9 steps/s
Avg test loss: 0.07281, Avg test acc: 0.96658, Avg tpr: 0.97062, Avg fpr: 0.04230, total FA: 330

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07321 | acc=0.9692 | tpr=0.9768 | fpr=0.0473 | 4379.8 samples/s | 17.1 steps/s
Avg test loss: 0.07728, Avg test acc: 0.96763, Avg tpr: 0.97552, Avg fpr: 0.04974, total FA: 388

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.16561 | acc=0.2805 | tpr=0.0170 | fpr=0.1472 | 4365.2 samples/s | 17.1 steps/s
Avg test loss: 7.16889, Avg test acc: 0.27959, Avg tpr: 0.01749, Avg fpr: 0.14396, total FA: 1123

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.00880 | acc=0.2968 | tpr=0.0241 | fpr=0.1110 | 4387.2 samples/s | 17.1 steps/s
Avg test loss: 7.01611, Avg test acc: 0.29373, Avg tpr: 0.02343, Avg fpr: 0.11178, total FA: 872

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.53230 | acc=0.1431 | tpr=0.7566 | fpr=0.8679 | 4350.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.50762 | acc=0.1464 | tpr=0.7697 | fpr=0.8653 | 8894.5 samples/s | 34.7 steps/s
[Step= 150] | Loss=5.50829 | acc=0.1454 | tpr=0.7550 | fpr=0.8659 | 8363.9 samples/s | 32.7 steps/s
[Step= 200] | Loss=5.49359 | acc=0.1456 | tpr=0.7530 | fpr=0.8654 | 8619.0 samples/s | 33.7 steps/s
[Step= 250] | Loss=5.48855 | acc=0.1456 | tpr=0.7424 | fpr=0.8652 | 8520.8 samples/s | 33.3 steps/s
[Step= 300] | Loss=5.48834 | acc=0.1459 | tpr=0.7425 | fpr=0.8650 | 8968.7 samples/s | 35.0 steps/s
[Step= 350] | Loss=5.48255 | acc=0.1452 | tpr=0.7470 | fpr=0.8657 | 8453.0 samples/s | 33.0 steps/s
[Step= 400] | Loss=5.47588 | acc=0.1451 | tpr=0.7495 | fpr=0.8659 | 8953.1 samples/s | 35.0 steps/s
[Step= 450] | Loss=5.47306 | acc=0.1450 | tpr=0.7537 | fpr=0.8661 | 8526.4 samples/s | 33.3 steps/s
[Step= 500] | Loss=5.47428 | acc=0.1446 | tpr=0.7564 | fpr=0.8665 | 8723.8 samples/s | 34.1 steps/s
[Step= 550] | Loss=5.47677 | acc=0.1445 | tpr=0.7533 | fpr=0.8666 | 15434.8 samples/s | 60.3 steps/s
Avg test loss: 5.47764, Avg test acc: 0.14438, Avg tpr: 0.75317, Avg fpr: 0.86669, total FA: 120338

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.28929 | acc=0.1360 | tpr=0.6770 | fpr=0.8737 | 4327.8 samples/s | 16.9 steps/s
[Step= 100] | Loss=6.27247 | acc=0.1396 | tpr=0.6951 | fpr=0.8708 | 8905.4 samples/s | 34.8 steps/s
[Step= 150] | Loss=6.26649 | acc=0.1397 | tpr=0.6844 | fpr=0.8703 | 8438.7 samples/s | 33.0 steps/s
[Step= 200] | Loss=6.25217 | acc=0.1404 | tpr=0.6820 | fpr=0.8694 | 8741.4 samples/s | 34.1 steps/s
[Step= 250] | Loss=6.24732 | acc=0.1403 | tpr=0.6699 | fpr=0.8694 | 8539.4 samples/s | 33.4 steps/s
[Step= 300] | Loss=6.24554 | acc=0.1409 | tpr=0.6735 | fpr=0.8688 | 8730.5 samples/s | 34.1 steps/s
[Step= 350] | Loss=6.23833 | acc=0.1404 | tpr=0.6756 | fpr=0.8693 | 8666.4 samples/s | 33.9 steps/s
[Step= 400] | Loss=6.22957 | acc=0.1404 | tpr=0.6778 | fpr=0.8693 | 8661.2 samples/s | 33.8 steps/s
[Step= 450] | Loss=6.22473 | acc=0.1404 | tpr=0.6801 | fpr=0.8694 | 8750.9 samples/s | 34.2 steps/s
[Step= 500] | Loss=6.22633 | acc=0.1403 | tpr=0.6811 | fpr=0.8695 | 8756.4 samples/s | 34.2 steps/s
[Step= 550] | Loss=6.22689 | acc=0.1402 | tpr=0.6793 | fpr=0.8696 | 15556.5 samples/s | 60.8 steps/s
Avg test loss: 6.22793, Avg test acc: 0.14008, Avg tpr: 0.67908, Avg fpr: 0.86971, total FA: 120758

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14990 | acc=0.9803 | tpr=0.9425 | fpr=0.0190 | 4367.7 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.16157 | acc=0.9789 | tpr=0.9552 | fpr=0.0207 | 8671.3 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.16659 | acc=0.9782 | tpr=0.9582 | fpr=0.0214 | 8709.2 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.16780 | acc=0.9786 | tpr=0.9585 | fpr=0.0210 | 8615.7 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.16553 | acc=0.9789 | tpr=0.9590 | fpr=0.0208 | 8774.8 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.16792 | acc=0.9786 | tpr=0.9578 | fpr=0.0210 | 8669.1 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.16890 | acc=0.9785 | tpr=0.9599 | fpr=0.0212 | 8973.9 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.17088 | acc=0.9781 | tpr=0.9573 | fpr=0.0215 | 8502.1 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.17477 | acc=0.9779 | tpr=0.9557 | fpr=0.0217 | 8769.0 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.17430 | acc=0.9779 | tpr=0.9559 | fpr=0.0217 | 8457.9 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.17289 | acc=0.9780 | tpr=0.9558 | fpr=0.0216 | 15773.1 samples/s | 61.6 steps/s
Avg test loss: 0.17246, Avg test acc: 0.97805, Avg tpr: 0.95563, Avg fpr: 0.02154, total FA: 2991

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16783 | acc=0.9796 | tpr=0.9381 | fpr=0.0196 | 4304.3 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.18140 | acc=0.9782 | tpr=0.9446 | fpr=0.0211 | 8805.9 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.18823 | acc=0.9777 | tpr=0.9496 | fpr=0.0218 | 8615.3 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.18924 | acc=0.9779 | tpr=0.9530 | fpr=0.0217 | 8823.5 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.18657 | acc=0.9782 | tpr=0.9546 | fpr=0.0213 | 9143.2 samples/s | 35.7 steps/s
[Step= 300] | Loss=0.18858 | acc=0.9780 | tpr=0.9520 | fpr=0.0215 | 7878.9 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.18988 | acc=0.9779 | tpr=0.9524 | fpr=0.0217 | 8887.1 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.19168 | acc=0.9776 | tpr=0.9502 | fpr=0.0219 | 8573.5 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.19519 | acc=0.9775 | tpr=0.9479 | fpr=0.0220 | 8591.5 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.19448 | acc=0.9775 | tpr=0.9485 | fpr=0.0219 | 8624.1 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.19291 | acc=0.9776 | tpr=0.9475 | fpr=0.0218 | 16097.0 samples/s | 62.9 steps/s
Avg test loss: 0.19252, Avg test acc: 0.97766, Avg tpr: 0.94731, Avg fpr: 0.02179, total FA: 3025

server round 25/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=30001 Epoch=58.5] | Loss=0.00141 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.614 | L2-Norm(final)=9.488 | 3602.7 samples/s | 56.3 steps/s
[Step=30050 Epoch=58.6] | Loss=0.01450 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=9.483 | 5531.3 samples/s | 86.4 steps/s
[Step=30100 Epoch=58.7] | Loss=0.01234 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.615 | L2-Norm(final)=9.482 | 5649.3 samples/s | 88.3 steps/s
[Step=30150 Epoch=58.8] | Loss=0.01352 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.615 | L2-Norm(final)=9.483 | 5720.3 samples/s | 89.4 steps/s
[Step=30200 Epoch=58.9] | Loss=0.01229 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=9.483 | 5761.8 samples/s | 90.0 steps/s
[Step=30250 Epoch=59.0] | Loss=0.01192 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=9.485 | 5685.9 samples/s | 88.8 steps/s
[Step=30300 Epoch=59.1] | Loss=0.01198 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=9.486 | 5747.8 samples/s | 89.8 steps/s
[Step=30350 Epoch=59.2] | Loss=0.01171 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.615 | L2-Norm(final)=9.487 | 5663.7 samples/s | 88.5 steps/s
[Step=30400 Epoch=59.3] | Loss=0.01164 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=9.489 | 5885.8 samples/s | 92.0 steps/s
[Step=30450 Epoch=59.4] | Loss=0.01149 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.615 | L2-Norm(final)=9.490 | 5588.5 samples/s | 87.3 steps/s
[Step=30500 Epoch=59.5] | Loss=0.01144 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=9.492 | 7076.4 samples/s | 110.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=30501 Epoch=59.5] | Loss=0.00671 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=9.510 | 4016.2 samples/s | 62.8 steps/s
[Step=30550 Epoch=59.6] | Loss=0.01390 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.636 | L2-Norm(final)=9.509 | 4502.2 samples/s | 70.3 steps/s
[Step=30600 Epoch=59.7] | Loss=0.01402 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.656 | L2-Norm(final)=9.507 | 4971.1 samples/s | 77.7 steps/s
[Step=30650 Epoch=59.8] | Loss=0.01388 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.669 | L2-Norm(final)=9.508 | 4902.5 samples/s | 76.6 steps/s
[Step=30700 Epoch=59.9] | Loss=0.01400 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.681 | L2-Norm(final)=9.509 | 4954.0 samples/s | 77.4 steps/s
[Step=30750 Epoch=60.0] | Loss=0.01443 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.691 | L2-Norm(final)=9.509 | 4913.2 samples/s | 76.8 steps/s
[Step=30800 Epoch=60.1] | Loss=0.01387 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.700 | L2-Norm(final)=9.509 | 5004.7 samples/s | 78.2 steps/s
[Step=30850 Epoch=60.2] | Loss=0.01358 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.709 | L2-Norm(final)=9.510 | 4933.4 samples/s | 77.1 steps/s
[Step=30900 Epoch=60.3] | Loss=0.01319 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.716 | L2-Norm(final)=9.511 | 4986.2 samples/s | 77.9 steps/s
[Step=30950 Epoch=60.4] | Loss=0.01357 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.723 | L2-Norm(final)=9.511 | 4986.7 samples/s | 77.9 steps/s
[Step=31000 Epoch=60.5] | Loss=0.01354 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.729 | L2-Norm(final)=9.511 | 6064.2 samples/s | 94.8 steps/s
[Step=31050 Epoch=60.6] | Loss=0.01343 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.735 | L2-Norm(final)=9.511 | 1886.9 samples/s | 29.5 steps/s
[Step=31100 Epoch=60.7] | Loss=0.01309 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.740 | L2-Norm(final)=9.512 | 4894.4 samples/s | 76.5 steps/s
[Step=31150 Epoch=60.8] | Loss=0.01265 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.745 | L2-Norm(final)=9.514 | 4948.7 samples/s | 77.3 steps/s
[Step=31200 Epoch=60.9] | Loss=0.01250 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.750 | L2-Norm(final)=9.516 | 4938.7 samples/s | 77.2 steps/s
[Step=31250 Epoch=60.9] | Loss=0.01226 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.754 | L2-Norm(final)=9.517 | 4998.2 samples/s | 78.1 steps/s
[Step=31300 Epoch=61.0] | Loss=0.01195 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.759 | L2-Norm(final)=9.518 | 5009.0 samples/s | 78.3 steps/s
[Step=31350 Epoch=61.1] | Loss=0.01165 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.763 | L2-Norm(final)=9.520 | 4922.7 samples/s | 76.9 steps/s
[Step=31400 Epoch=61.2] | Loss=0.01167 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.767 | L2-Norm(final)=9.522 | 4924.8 samples/s | 76.9 steps/s
[Step=31450 Epoch=61.3] | Loss=0.01144 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.770 | L2-Norm(final)=9.523 | 4997.0 samples/s | 78.1 steps/s
[Step=31500 Epoch=61.4] | Loss=0.01126 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.773 | L2-Norm(final)=9.524 | 5292.2 samples/s | 82.7 steps/s
[Step=31550 Epoch=61.5] | Loss=0.01119 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.777 | L2-Norm(final)=9.526 | 1947.2 samples/s | 30.4 steps/s
[Step=31600 Epoch=61.6] | Loss=0.01103 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.780 | L2-Norm(final)=9.527 | 4962.7 samples/s | 77.5 steps/s
[Step=31650 Epoch=61.7] | Loss=0.01086 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.783 | L2-Norm(final)=9.528 | 4984.3 samples/s | 77.9 steps/s
[Step=31700 Epoch=61.8] | Loss=0.01069 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.786 | L2-Norm(final)=9.530 | 4933.8 samples/s | 77.1 steps/s
[Step=31750 Epoch=61.9] | Loss=0.01050 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.789 | L2-Norm(final)=9.531 | 4962.0 samples/s | 77.5 steps/s
[Step=31800 Epoch=62.0] | Loss=0.01031 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.791 | L2-Norm(final)=9.532 | 5015.8 samples/s | 78.4 steps/s
[Step=31850 Epoch=62.1] | Loss=0.01022 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.794 | L2-Norm(final)=9.534 | 5034.8 samples/s | 78.7 steps/s
[Step=31900 Epoch=62.2] | Loss=0.01019 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.796 | L2-Norm(final)=9.535 | 4892.8 samples/s | 76.5 steps/s
[Step=31950 Epoch=62.3] | Loss=0.01014 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.799 | L2-Norm(final)=9.536 | 5037.1 samples/s | 78.7 steps/s
[Step=32000 Epoch=62.4] | Loss=0.01008 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.801 | L2-Norm(final)=9.537 | 4929.4 samples/s | 77.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step32000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=39.1] | Loss=0.00080 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.614 | L2-Norm(final)=7.785 | 3946.6 samples/s | 61.7 steps/s
[Step=20050 Epoch=39.2] | Loss=0.01133 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.615 | L2-Norm(final)=7.790 | 5528.8 samples/s | 86.4 steps/s
[Step=20100 Epoch=39.3] | Loss=0.01230 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=7.795 | 5631.2 samples/s | 88.0 steps/s
[Step=20150 Epoch=39.4] | Loss=0.01202 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.615 | L2-Norm(final)=7.802 | 5719.7 samples/s | 89.4 steps/s
[Step=20200 Epoch=39.5] | Loss=0.01308 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.615 | L2-Norm(final)=7.809 | 5656.0 samples/s | 88.4 steps/s
[Step=20250 Epoch=39.6] | Loss=0.01336 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.615 | L2-Norm(final)=7.813 | 5667.1 samples/s | 88.5 steps/s
[Step=20300 Epoch=39.7] | Loss=0.01349 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.615 | L2-Norm(final)=7.817 | 5698.6 samples/s | 89.0 steps/s
[Step=20350 Epoch=39.8] | Loss=0.01333 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.615 | L2-Norm(final)=7.821 | 5843.8 samples/s | 91.3 steps/s
[Step=20400 Epoch=39.9] | Loss=0.01324 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.615 | L2-Norm(final)=7.826 | 5650.3 samples/s | 88.3 steps/s
[Step=20450 Epoch=40.0] | Loss=0.01339 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=7.830 | 5625.7 samples/s | 87.9 steps/s
[Step=20500 Epoch=40.1] | Loss=0.01351 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=7.834 | 7228.9 samples/s | 113.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=40.1] | Loss=0.01364 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.615 | L2-Norm(final)=7.878 | 3861.8 samples/s | 60.3 steps/s
[Step=20550 Epoch=40.2] | Loss=0.01797 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.634 | L2-Norm(final)=7.875 | 4837.0 samples/s | 75.6 steps/s
[Step=20600 Epoch=40.3] | Loss=0.01688 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.652 | L2-Norm(final)=7.875 | 4924.2 samples/s | 76.9 steps/s
[Step=20650 Epoch=40.4] | Loss=0.01610 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.664 | L2-Norm(final)=7.875 | 5014.7 samples/s | 78.4 steps/s
[Step=20700 Epoch=40.5] | Loss=0.01572 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.675 | L2-Norm(final)=7.874 | 4920.0 samples/s | 76.9 steps/s
[Step=20750 Epoch=40.6] | Loss=0.01618 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.684 | L2-Norm(final)=7.874 | 4968.7 samples/s | 77.6 steps/s
[Step=20800 Epoch=40.7] | Loss=0.01585 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.693 | L2-Norm(final)=7.874 | 4920.2 samples/s | 76.9 steps/s
[Step=20850 Epoch=40.8] | Loss=0.01564 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.701 | L2-Norm(final)=7.874 | 4952.2 samples/s | 77.4 steps/s
[Step=20900 Epoch=40.9] | Loss=0.01514 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.709 | L2-Norm(final)=7.874 | 5008.4 samples/s | 78.3 steps/s
[Step=20950 Epoch=41.0] | Loss=0.01492 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.716 | L2-Norm(final)=7.875 | 4935.9 samples/s | 77.1 steps/s
[Step=21000 Epoch=41.1] | Loss=0.01466 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.722 | L2-Norm(final)=7.876 | 6133.7 samples/s | 95.8 steps/s
[Step=21050 Epoch=41.2] | Loss=0.01419 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.728 | L2-Norm(final)=7.877 | 1926.6 samples/s | 30.1 steps/s
[Step=21100 Epoch=41.2] | Loss=0.01368 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.734 | L2-Norm(final)=7.878 | 4978.9 samples/s | 77.8 steps/s
[Step=21150 Epoch=41.3] | Loss=0.01347 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.739 | L2-Norm(final)=7.880 | 4863.7 samples/s | 76.0 steps/s
[Step=21200 Epoch=41.4] | Loss=0.01321 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.744 | L2-Norm(final)=7.882 | 5002.9 samples/s | 78.2 steps/s
[Step=21250 Epoch=41.5] | Loss=0.01287 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.748 | L2-Norm(final)=7.883 | 4903.9 samples/s | 76.6 steps/s
[Step=21300 Epoch=41.6] | Loss=0.01264 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.752 | L2-Norm(final)=7.884 | 4972.9 samples/s | 77.7 steps/s
[Step=21350 Epoch=41.7] | Loss=0.01247 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.756 | L2-Norm(final)=7.886 | 4955.2 samples/s | 77.4 steps/s
[Step=21400 Epoch=41.8] | Loss=0.01225 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.759 | L2-Norm(final)=7.887 | 4988.4 samples/s | 77.9 steps/s
[Step=21450 Epoch=41.9] | Loss=0.01219 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.763 | L2-Norm(final)=7.888 | 4921.1 samples/s | 76.9 steps/s
[Step=21500 Epoch=42.0] | Loss=0.01207 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.766 | L2-Norm(final)=7.889 | 5396.7 samples/s | 84.3 steps/s
[Step=21550 Epoch=42.1] | Loss=0.01182 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.769 | L2-Norm(final)=7.891 | 2006.0 samples/s | 31.3 steps/s
[Step=21600 Epoch=42.2] | Loss=0.01165 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.772 | L2-Norm(final)=7.892 | 4945.4 samples/s | 77.3 steps/s
[Step=21650 Epoch=42.3] | Loss=0.01149 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.775 | L2-Norm(final)=7.893 | 4994.0 samples/s | 78.0 steps/s
[Step=21700 Epoch=42.4] | Loss=0.01135 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.778 | L2-Norm(final)=7.895 | 4907.8 samples/s | 76.7 steps/s
[Step=21750 Epoch=42.5] | Loss=0.01119 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=7.896 | 4962.3 samples/s | 77.5 steps/s
[Step=21800 Epoch=42.6] | Loss=0.01100 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.784 | L2-Norm(final)=7.898 | 5023.1 samples/s | 78.5 steps/s
[Step=21850 Epoch=42.7] | Loss=0.01099 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.787 | L2-Norm(final)=7.899 | 4987.9 samples/s | 77.9 steps/s
[Step=21900 Epoch=42.8] | Loss=0.01088 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.790 | L2-Norm(final)=7.901 | 4886.1 samples/s | 76.3 steps/s
[Step=21950 Epoch=42.9] | Loss=0.01078 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.792 | L2-Norm(final)=7.902 | 4959.2 samples/s | 77.5 steps/s
[Step=22000 Epoch=43.0] | Loss=0.01070 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.795 | L2-Norm(final)=7.903 | 5012.8 samples/s | 78.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step22000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07935 | acc=0.9674 | tpr=0.9785 | fpr=0.0567 | 4339.8 samples/s | 17.0 steps/s
Avg test loss: 0.07931, Avg test acc: 0.96582, Avg tpr: 0.97803, Avg fpr: 0.06102, total FA: 476

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07066 | acc=0.9693 | tpr=0.9783 | fpr=0.0503 | 4326.4 samples/s | 16.9 steps/s
Avg test loss: 0.07473, Avg test acc: 0.96735, Avg tpr: 0.97686, Avg fpr: 0.05358, total FA: 418

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.16561 | acc=0.2805 | tpr=0.0170 | fpr=0.1472 | 4359.2 samples/s | 17.0 steps/s
Avg test loss: 7.16889, Avg test acc: 0.27959, Avg tpr: 0.01749, Avg fpr: 0.14396, total FA: 1123

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.00880 | acc=0.2968 | tpr=0.0241 | fpr=0.1110 | 4329.0 samples/s | 16.9 steps/s
Avg test loss: 7.01611, Avg test acc: 0.29373, Avg tpr: 0.02343, Avg fpr: 0.11178, total FA: 872

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.85474 | acc=0.1291 | tpr=0.7920 | fpr=0.8828 | 4367.7 samples/s | 17.1 steps/s
[Step= 100] | Loss=5.84234 | acc=0.1325 | tpr=0.7910 | fpr=0.8798 | 8435.3 samples/s | 33.0 steps/s
[Step= 150] | Loss=5.84212 | acc=0.1313 | tpr=0.7767 | fpr=0.8806 | 8744.9 samples/s | 34.2 steps/s
[Step= 200] | Loss=5.82979 | acc=0.1317 | tpr=0.7694 | fpr=0.8799 | 8625.5 samples/s | 33.7 steps/s
[Step= 250] | Loss=5.82769 | acc=0.1313 | tpr=0.7537 | fpr=0.8801 | 8628.1 samples/s | 33.7 steps/s
[Step= 300] | Loss=5.82496 | acc=0.1317 | tpr=0.7578 | fpr=0.8797 | 8584.8 samples/s | 33.5 steps/s
[Step= 350] | Loss=5.82013 | acc=0.1310 | tpr=0.7639 | fpr=0.8805 | 9109.3 samples/s | 35.6 steps/s
[Step= 400] | Loss=5.81323 | acc=0.1309 | tpr=0.7659 | fpr=0.8806 | 8488.5 samples/s | 33.2 steps/s
[Step= 450] | Loss=5.81002 | acc=0.1309 | tpr=0.7722 | fpr=0.8808 | 8651.3 samples/s | 33.8 steps/s
[Step= 500] | Loss=5.81072 | acc=0.1309 | tpr=0.7731 | fpr=0.8807 | 8810.4 samples/s | 34.4 steps/s
[Step= 550] | Loss=5.81260 | acc=0.1311 | tpr=0.7728 | fpr=0.8806 | 15030.4 samples/s | 58.7 steps/s
Avg test loss: 5.81331, Avg test acc: 0.13096, Avg tpr: 0.77298, Avg fpr: 0.88071, total FA: 122285

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.21968 | acc=0.1245 | tpr=0.7434 | fpr=0.8866 | 4470.1 samples/s | 17.5 steps/s
[Step= 100] | Loss=6.19981 | acc=0.1277 | tpr=0.7633 | fpr=0.8841 | 8564.5 samples/s | 33.5 steps/s
[Step= 150] | Loss=6.19554 | acc=0.1273 | tpr=0.7579 | fpr=0.8843 | 8440.5 samples/s | 33.0 steps/s
[Step= 200] | Loss=6.18218 | acc=0.1270 | tpr=0.7596 | fpr=0.8845 | 8691.7 samples/s | 34.0 steps/s
[Step= 250] | Loss=6.17628 | acc=0.1272 | tpr=0.7476 | fpr=0.8841 | 8576.6 samples/s | 33.5 steps/s
[Step= 300] | Loss=6.17302 | acc=0.1277 | tpr=0.7491 | fpr=0.8836 | 8718.4 samples/s | 34.1 steps/s
[Step= 350] | Loss=6.16516 | acc=0.1274 | tpr=0.7545 | fpr=0.8840 | 8870.1 samples/s | 34.6 steps/s
[Step= 400] | Loss=6.15741 | acc=0.1274 | tpr=0.7527 | fpr=0.8839 | 9048.7 samples/s | 35.3 steps/s
[Step= 450] | Loss=6.15354 | acc=0.1274 | tpr=0.7575 | fpr=0.8840 | 8102.6 samples/s | 31.7 steps/s
[Step= 500] | Loss=6.15662 | acc=0.1273 | tpr=0.7590 | fpr=0.8841 | 8703.9 samples/s | 34.0 steps/s
[Step= 550] | Loss=6.15650 | acc=0.1275 | tpr=0.7573 | fpr=0.8839 | 15015.6 samples/s | 58.7 steps/s
Avg test loss: 6.15751, Avg test acc: 0.12740, Avg tpr: 0.75674, Avg fpr: 0.88404, total FA: 122747

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14990 | acc=0.9803 | tpr=0.9425 | fpr=0.0190 | 4323.5 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.16157 | acc=0.9789 | tpr=0.9552 | fpr=0.0207 | 8986.8 samples/s | 35.1 steps/s
[Step= 150] | Loss=0.16659 | acc=0.9782 | tpr=0.9582 | fpr=0.0214 | 8581.8 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.16780 | acc=0.9786 | tpr=0.9585 | fpr=0.0210 | 8501.6 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.16553 | acc=0.9789 | tpr=0.9590 | fpr=0.0208 | 8645.2 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.16792 | acc=0.9786 | tpr=0.9578 | fpr=0.0210 | 8793.4 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.16890 | acc=0.9785 | tpr=0.9599 | fpr=0.0212 | 9181.1 samples/s | 35.9 steps/s
[Step= 400] | Loss=0.17088 | acc=0.9781 | tpr=0.9573 | fpr=0.0215 | 8530.3 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.17477 | acc=0.9779 | tpr=0.9557 | fpr=0.0217 | 8461.4 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.17430 | acc=0.9779 | tpr=0.9559 | fpr=0.0217 | 8543.0 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.17289 | acc=0.9780 | tpr=0.9558 | fpr=0.0216 | 15481.3 samples/s | 60.5 steps/s
Avg test loss: 0.17246, Avg test acc: 0.97805, Avg tpr: 0.95563, Avg fpr: 0.02154, total FA: 2991

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16783 | acc=0.9796 | tpr=0.9381 | fpr=0.0196 | 4319.8 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.18140 | acc=0.9782 | tpr=0.9446 | fpr=0.0211 | 8861.2 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.18823 | acc=0.9777 | tpr=0.9496 | fpr=0.0218 | 8530.4 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.18924 | acc=0.9779 | tpr=0.9530 | fpr=0.0217 | 8621.7 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.18657 | acc=0.9782 | tpr=0.9546 | fpr=0.0213 | 8599.2 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.18858 | acc=0.9780 | tpr=0.9520 | fpr=0.0215 | 8867.6 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.18988 | acc=0.9779 | tpr=0.9524 | fpr=0.0217 | 8374.0 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.19168 | acc=0.9776 | tpr=0.9502 | fpr=0.0219 | 8676.9 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.19519 | acc=0.9775 | tpr=0.9479 | fpr=0.0220 | 8609.8 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.19448 | acc=0.9775 | tpr=0.9485 | fpr=0.0219 | 9156.1 samples/s | 35.8 steps/s
[Step= 550] | Loss=0.19291 | acc=0.9776 | tpr=0.9475 | fpr=0.0218 | 14562.3 samples/s | 56.9 steps/s
Avg test loss: 0.19252, Avg test acc: 0.97766, Avg tpr: 0.94731, Avg fpr: 0.02179, total FA: 3025

server round 26/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=32001 Epoch=62.4] | Loss=0.00949 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.523 | L2-Norm(final)=9.572 | 3476.4 samples/s | 54.3 steps/s
[Step=32050 Epoch=62.5] | Loss=0.01450 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.525 | L2-Norm(final)=9.571 | 5763.8 samples/s | 90.1 steps/s
[Step=32100 Epoch=62.6] | Loss=0.01372 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.525 | L2-Norm(final)=9.568 | 5759.8 samples/s | 90.0 steps/s
[Step=32150 Epoch=62.7] | Loss=0.01434 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.526 | L2-Norm(final)=9.566 | 5593.2 samples/s | 87.4 steps/s
[Step=32200 Epoch=62.8] | Loss=0.01488 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.526 | L2-Norm(final)=9.562 | 5761.7 samples/s | 90.0 steps/s
[Step=32250 Epoch=62.9] | Loss=0.01456 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.526 | L2-Norm(final)=9.558 | 5674.2 samples/s | 88.7 steps/s
[Step=32300 Epoch=63.0] | Loss=0.01468 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.526 | L2-Norm(final)=9.555 | 5675.8 samples/s | 88.7 steps/s
[Step=32350 Epoch=63.1] | Loss=0.01488 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.526 | L2-Norm(final)=9.553 | 5694.5 samples/s | 89.0 steps/s
[Step=32400 Epoch=63.2] | Loss=0.01484 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.526 | L2-Norm(final)=9.551 | 5696.6 samples/s | 89.0 steps/s
[Step=32450 Epoch=63.3] | Loss=0.01464 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.526 | L2-Norm(final)=9.549 | 5738.0 samples/s | 89.7 steps/s
[Step=32500 Epoch=63.4] | Loss=0.01449 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.526 | L2-Norm(final)=9.548 | 7124.4 samples/s | 111.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=32501 Epoch=63.4] | Loss=0.01411 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.526 | L2-Norm(final)=9.539 | 3562.1 samples/s | 55.7 steps/s
[Step=32550 Epoch=63.5] | Loss=0.01172 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.544 | L2-Norm(final)=9.540 | 4940.4 samples/s | 77.2 steps/s
[Step=32600 Epoch=63.6] | Loss=0.01396 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.563 | L2-Norm(final)=9.536 | 4967.7 samples/s | 77.6 steps/s
[Step=32650 Epoch=63.7] | Loss=0.01525 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.578 | L2-Norm(final)=9.531 | 4857.9 samples/s | 75.9 steps/s
[Step=32700 Epoch=63.8] | Loss=0.01510 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=9.528 | 5000.2 samples/s | 78.1 steps/s
[Step=32750 Epoch=63.9] | Loss=0.01492 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.600 | L2-Norm(final)=9.526 | 4979.0 samples/s | 77.8 steps/s
[Step=32800 Epoch=64.0] | Loss=0.01482 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.610 | L2-Norm(final)=9.525 | 5011.5 samples/s | 78.3 steps/s
[Step=32850 Epoch=64.1] | Loss=0.01455 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.618 | L2-Norm(final)=9.524 | 4931.2 samples/s | 77.0 steps/s
[Step=32900 Epoch=64.2] | Loss=0.01443 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.625 | L2-Norm(final)=9.524 | 4956.9 samples/s | 77.5 steps/s
[Step=32950 Epoch=64.3] | Loss=0.01404 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.632 | L2-Norm(final)=9.524 | 5001.3 samples/s | 78.1 steps/s
[Step=33000 Epoch=64.4] | Loss=0.01354 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=9.524 | 6085.7 samples/s | 95.1 steps/s
[Step=33050 Epoch=64.5] | Loss=0.01316 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.644 | L2-Norm(final)=9.525 | 1845.4 samples/s | 28.8 steps/s
[Step=33100 Epoch=64.6] | Loss=0.01281 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.649 | L2-Norm(final)=9.526 | 5006.8 samples/s | 78.2 steps/s
[Step=33150 Epoch=64.7] | Loss=0.01263 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.654 | L2-Norm(final)=9.527 | 4888.0 samples/s | 76.4 steps/s
[Step=33200 Epoch=64.8] | Loss=0.01224 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.658 | L2-Norm(final)=9.528 | 4995.4 samples/s | 78.1 steps/s
[Step=33250 Epoch=64.9] | Loss=0.01214 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.662 | L2-Norm(final)=9.529 | 4957.1 samples/s | 77.5 steps/s
[Step=33300 Epoch=64.9] | Loss=0.01205 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.666 | L2-Norm(final)=9.530 | 4970.0 samples/s | 77.7 steps/s
[Step=33350 Epoch=65.0] | Loss=0.01166 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.670 | L2-Norm(final)=9.531 | 4992.1 samples/s | 78.0 steps/s
[Step=33400 Epoch=65.1] | Loss=0.01142 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.674 | L2-Norm(final)=9.532 | 4976.3 samples/s | 77.8 steps/s
[Step=33450 Epoch=65.2] | Loss=0.01117 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.678 | L2-Norm(final)=9.533 | 4938.3 samples/s | 77.2 steps/s
[Step=33500 Epoch=65.3] | Loss=0.01098 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.682 | L2-Norm(final)=9.534 | 5261.6 samples/s | 82.2 steps/s
[Step=33550 Epoch=65.4] | Loss=0.01100 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.685 | L2-Norm(final)=9.535 | 1947.4 samples/s | 30.4 steps/s
[Step=33600 Epoch=65.5] | Loss=0.01079 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.688 | L2-Norm(final)=9.536 | 4892.5 samples/s | 76.4 steps/s
[Step=33650 Epoch=65.6] | Loss=0.01063 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.691 | L2-Norm(final)=9.538 | 4974.0 samples/s | 77.7 steps/s
[Step=33700 Epoch=65.7] | Loss=0.01049 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.694 | L2-Norm(final)=9.539 | 4921.8 samples/s | 76.9 steps/s
[Step=33750 Epoch=65.8] | Loss=0.01032 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.697 | L2-Norm(final)=9.540 | 4867.8 samples/s | 76.1 steps/s
[Step=33800 Epoch=65.9] | Loss=0.01022 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.700 | L2-Norm(final)=9.541 | 5000.7 samples/s | 78.1 steps/s
[Step=33850 Epoch=66.0] | Loss=0.01011 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.703 | L2-Norm(final)=9.542 | 4956.8 samples/s | 77.5 steps/s
[Step=33900 Epoch=66.1] | Loss=0.01008 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=9.543 | 4957.5 samples/s | 77.5 steps/s
[Step=33950 Epoch=66.2] | Loss=0.00999 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.709 | L2-Norm(final)=9.545 | 4968.7 samples/s | 77.6 steps/s
[Step=34000 Epoch=66.3] | Loss=0.00993 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.712 | L2-Norm(final)=9.546 | 4998.6 samples/s | 78.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step34000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=43.0] | Loss=0.03536 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.523 | L2-Norm(final)=7.945 | 3861.2 samples/s | 60.3 steps/s
[Step=22050 Epoch=43.1] | Loss=0.01487 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.524 | L2-Norm(final)=7.949 | 5606.9 samples/s | 87.6 steps/s
[Step=22100 Epoch=43.2] | Loss=0.01343 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.525 | L2-Norm(final)=7.956 | 5690.7 samples/s | 88.9 steps/s
[Step=22150 Epoch=43.3] | Loss=0.01368 | Reg=0.00183 | acc=0.9531 | L2-Norm=13.525 | L2-Norm(final)=7.965 | 5606.8 samples/s | 87.6 steps/s
[Step=22200 Epoch=43.4] | Loss=0.01387 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=7.973 | 5766.7 samples/s | 90.1 steps/s
[Step=22250 Epoch=43.5] | Loss=0.01393 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.525 | L2-Norm(final)=7.981 | 5639.9 samples/s | 88.1 steps/s
[Step=22300 Epoch=43.6] | Loss=0.01407 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=7.989 | 5664.2 samples/s | 88.5 steps/s
[Step=22350 Epoch=43.7] | Loss=0.01385 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.525 | L2-Norm(final)=7.997 | 5688.1 samples/s | 88.9 steps/s
[Step=22400 Epoch=43.8] | Loss=0.01381 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=8.005 | 5713.4 samples/s | 89.3 steps/s
[Step=22450 Epoch=43.9] | Loss=0.01353 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.525 | L2-Norm(final)=8.013 | 5732.6 samples/s | 89.6 steps/s
[Step=22500 Epoch=44.0] | Loss=0.01347 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=8.021 | 7261.5 samples/s | 113.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=44.0] | Loss=0.00317 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=8.103 | 3886.2 samples/s | 60.7 steps/s
[Step=22550 Epoch=44.1] | Loss=0.01493 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.537 | L2-Norm(final)=8.109 | 4803.5 samples/s | 75.1 steps/s
[Step=22600 Epoch=44.2] | Loss=0.01468 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.550 | L2-Norm(final)=8.108 | 4966.2 samples/s | 77.6 steps/s
[Step=22650 Epoch=44.3] | Loss=0.01513 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.560 | L2-Norm(final)=8.108 | 4974.9 samples/s | 77.7 steps/s
[Step=22700 Epoch=44.4] | Loss=0.01549 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.570 | L2-Norm(final)=8.107 | 5001.4 samples/s | 78.1 steps/s
[Step=22750 Epoch=44.5] | Loss=0.01520 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.579 | L2-Norm(final)=8.107 | 4903.1 samples/s | 76.6 steps/s
[Step=22800 Epoch=44.6] | Loss=0.01452 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.587 | L2-Norm(final)=8.108 | 4977.9 samples/s | 77.8 steps/s
[Step=22850 Epoch=44.7] | Loss=0.01399 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.595 | L2-Norm(final)=8.110 | 5022.9 samples/s | 78.5 steps/s
[Step=22900 Epoch=44.8] | Loss=0.01419 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.602 | L2-Norm(final)=8.111 | 4958.0 samples/s | 77.5 steps/s
[Step=22950 Epoch=44.9] | Loss=0.01402 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.609 | L2-Norm(final)=8.112 | 4893.6 samples/s | 76.5 steps/s
[Step=23000 Epoch=45.0] | Loss=0.01404 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.616 | L2-Norm(final)=8.113 | 6112.8 samples/s | 95.5 steps/s
[Step=23050 Epoch=45.1] | Loss=0.01367 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.622 | L2-Norm(final)=8.114 | 1929.9 samples/s | 30.2 steps/s
[Step=23100 Epoch=45.2] | Loss=0.01307 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.628 | L2-Norm(final)=8.116 | 4889.0 samples/s | 76.4 steps/s
[Step=23150 Epoch=45.3] | Loss=0.01266 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.633 | L2-Norm(final)=8.118 | 4955.7 samples/s | 77.4 steps/s
[Step=23200 Epoch=45.4] | Loss=0.01247 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=8.119 | 4889.4 samples/s | 76.4 steps/s
[Step=23250 Epoch=45.5] | Loss=0.01231 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.643 | L2-Norm(final)=8.120 | 4969.7 samples/s | 77.7 steps/s
[Step=23300 Epoch=45.6] | Loss=0.01214 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.648 | L2-Norm(final)=8.122 | 5013.7 samples/s | 78.3 steps/s
[Step=23350 Epoch=45.6] | Loss=0.01201 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.653 | L2-Norm(final)=8.123 | 4971.2 samples/s | 77.7 steps/s
[Step=23400 Epoch=45.7] | Loss=0.01199 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.658 | L2-Norm(final)=8.124 | 5011.1 samples/s | 78.3 steps/s
[Step=23450 Epoch=45.8] | Loss=0.01185 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.662 | L2-Norm(final)=8.125 | 4984.8 samples/s | 77.9 steps/s
[Step=23500 Epoch=45.9] | Loss=0.01181 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.666 | L2-Norm(final)=8.127 | 5398.1 samples/s | 84.3 steps/s
[Step=23550 Epoch=46.0] | Loss=0.01154 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.670 | L2-Norm(final)=8.128 | 1999.5 samples/s | 31.2 steps/s
[Step=23600 Epoch=46.1] | Loss=0.01144 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.674 | L2-Norm(final)=8.129 | 4991.7 samples/s | 78.0 steps/s
[Step=23650 Epoch=46.2] | Loss=0.01125 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.678 | L2-Norm(final)=8.131 | 4969.1 samples/s | 77.6 steps/s
[Step=23700 Epoch=46.3] | Loss=0.01103 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.681 | L2-Norm(final)=8.132 | 4985.2 samples/s | 77.9 steps/s
[Step=23750 Epoch=46.4] | Loss=0.01098 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.685 | L2-Norm(final)=8.134 | 4888.9 samples/s | 76.4 steps/s
[Step=23800 Epoch=46.5] | Loss=0.01084 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.688 | L2-Norm(final)=8.135 | 5007.3 samples/s | 78.2 steps/s
[Step=23850 Epoch=46.6] | Loss=0.01072 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.691 | L2-Norm(final)=8.137 | 4997.7 samples/s | 78.1 steps/s
[Step=23900 Epoch=46.7] | Loss=0.01077 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.694 | L2-Norm(final)=8.138 | 4953.1 samples/s | 77.4 steps/s
[Step=23950 Epoch=46.8] | Loss=0.01080 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=8.139 | 4930.0 samples/s | 77.0 steps/s
[Step=24000 Epoch=46.9] | Loss=0.01078 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.701 | L2-Norm(final)=8.140 | 4966.3 samples/s | 77.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07879 | acc=0.9691 | tpr=0.9777 | fpr=0.0498 | 4324.1 samples/s | 16.9 steps/s
Avg test loss: 0.07970, Avg test acc: 0.96771, Avg tpr: 0.97674, Avg fpr: 0.05217, total FA: 407

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06618 | acc=0.9698 | tpr=0.9741 | fpr=0.0394 | 4332.1 samples/s | 16.9 steps/s
Avg test loss: 0.07203, Avg test acc: 0.96706, Avg tpr: 0.97138, Avg fpr: 0.04243, total FA: 331

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.16561 | acc=0.2805 | tpr=0.0170 | fpr=0.1472 | 4384.1 samples/s | 17.1 steps/s
Avg test loss: 7.16889, Avg test acc: 0.27959, Avg tpr: 0.01749, Avg fpr: 0.14396, total FA: 1123

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.00880 | acc=0.2968 | tpr=0.0241 | fpr=0.1110 | 4327.8 samples/s | 16.9 steps/s
Avg test loss: 7.01611, Avg test acc: 0.29373, Avg tpr: 0.02343, Avg fpr: 0.11178, total FA: 872

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.38166 | acc=0.1225 | tpr=0.7345 | fpr=0.8885 | 4325.9 samples/s | 16.9 steps/s
[Step= 100] | Loss=6.36172 | acc=0.1243 | tpr=0.7463 | fpr=0.8873 | 8636.2 samples/s | 33.7 steps/s
[Step= 150] | Loss=6.36481 | acc=0.1233 | tpr=0.7305 | fpr=0.8879 | 8930.4 samples/s | 34.9 steps/s
[Step= 200] | Loss=6.34898 | acc=0.1239 | tpr=0.7322 | fpr=0.8872 | 8451.5 samples/s | 33.0 steps/s
[Step= 250] | Loss=6.34672 | acc=0.1240 | tpr=0.7205 | fpr=0.8869 | 9028.7 samples/s | 35.3 steps/s
[Step= 300] | Loss=6.34319 | acc=0.1244 | tpr=0.7236 | fpr=0.8865 | 8289.2 samples/s | 32.4 steps/s
[Step= 350] | Loss=6.33784 | acc=0.1235 | tpr=0.7289 | fpr=0.8875 | 8581.0 samples/s | 33.5 steps/s
[Step= 400] | Loss=6.33117 | acc=0.1236 | tpr=0.7319 | fpr=0.8875 | 8975.6 samples/s | 35.1 steps/s
[Step= 450] | Loss=6.32766 | acc=0.1236 | tpr=0.7342 | fpr=0.8875 | 8546.1 samples/s | 33.4 steps/s
[Step= 500] | Loss=6.32932 | acc=0.1237 | tpr=0.7370 | fpr=0.8873 | 9071.7 samples/s | 35.4 steps/s
[Step= 550] | Loss=6.33124 | acc=0.1238 | tpr=0.7362 | fpr=0.8873 | 14077.7 samples/s | 55.0 steps/s
Avg test loss: 6.33182, Avg test acc: 0.12365, Avg tpr: 0.73653, Avg fpr: 0.88749, total FA: 123226

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.33315 | acc=0.1464 | tpr=0.6283 | fpr=0.8623 | 4436.0 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.31819 | acc=0.1473 | tpr=0.6567 | fpr=0.8622 | 8253.8 samples/s | 32.2 steps/s
[Step= 150] | Loss=5.31468 | acc=0.1467 | tpr=0.6340 | fpr=0.8622 | 8754.9 samples/s | 34.2 steps/s
[Step= 200] | Loss=5.30131 | acc=0.1471 | tpr=0.6317 | fpr=0.8618 | 8705.1 samples/s | 34.0 steps/s
[Step= 250] | Loss=5.30001 | acc=0.1461 | tpr=0.6157 | fpr=0.8624 | 8703.5 samples/s | 34.0 steps/s
[Step= 300] | Loss=5.29775 | acc=0.1466 | tpr=0.6196 | fpr=0.8621 | 8933.6 samples/s | 34.9 steps/s
[Step= 350] | Loss=5.29243 | acc=0.1461 | tpr=0.6218 | fpr=0.8625 | 8309.9 samples/s | 32.5 steps/s
[Step= 400] | Loss=5.28594 | acc=0.1462 | tpr=0.6231 | fpr=0.8625 | 8582.1 samples/s | 33.5 steps/s
[Step= 450] | Loss=5.28227 | acc=0.1461 | tpr=0.6285 | fpr=0.8627 | 8772.7 samples/s | 34.3 steps/s
[Step= 500] | Loss=5.28450 | acc=0.1461 | tpr=0.6330 | fpr=0.8627 | 8701.7 samples/s | 34.0 steps/s
[Step= 550] | Loss=5.28470 | acc=0.1460 | tpr=0.6311 | fpr=0.8629 | 15226.7 samples/s | 59.5 steps/s
Avg test loss: 5.28560, Avg test acc: 0.14585, Avg tpr: 0.63074, Avg fpr: 0.86297, total FA: 119821

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14990 | acc=0.9803 | tpr=0.9425 | fpr=0.0190 | 4395.1 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.16157 | acc=0.9789 | tpr=0.9552 | fpr=0.0207 | 8617.0 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.16659 | acc=0.9782 | tpr=0.9582 | fpr=0.0214 | 8386.3 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.16780 | acc=0.9786 | tpr=0.9585 | fpr=0.0210 | 8772.6 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.16553 | acc=0.9789 | tpr=0.9590 | fpr=0.0208 | 8719.5 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.16792 | acc=0.9786 | tpr=0.9578 | fpr=0.0210 | 8526.2 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.16890 | acc=0.9785 | tpr=0.9599 | fpr=0.0212 | 8724.7 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.17088 | acc=0.9781 | tpr=0.9573 | fpr=0.0215 | 8913.3 samples/s | 34.8 steps/s
[Step= 450] | Loss=0.17477 | acc=0.9779 | tpr=0.9557 | fpr=0.0217 | 8490.3 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.17430 | acc=0.9779 | tpr=0.9559 | fpr=0.0217 | 8899.5 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.17289 | acc=0.9780 | tpr=0.9558 | fpr=0.0216 | 14790.7 samples/s | 57.8 steps/s
Avg test loss: 0.17246, Avg test acc: 0.97805, Avg tpr: 0.95563, Avg fpr: 0.02154, total FA: 2991

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16783 | acc=0.9796 | tpr=0.9381 | fpr=0.0196 | 4350.7 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.18140 | acc=0.9782 | tpr=0.9446 | fpr=0.0211 | 8496.3 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.18823 | acc=0.9777 | tpr=0.9496 | fpr=0.0218 | 9269.6 samples/s | 36.2 steps/s
[Step= 200] | Loss=0.18924 | acc=0.9779 | tpr=0.9530 | fpr=0.0217 | 8113.7 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.18657 | acc=0.9782 | tpr=0.9546 | fpr=0.0213 | 9489.7 samples/s | 37.1 steps/s
[Step= 300] | Loss=0.18858 | acc=0.9780 | tpr=0.9520 | fpr=0.0215 | 8025.4 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.18988 | acc=0.9779 | tpr=0.9524 | fpr=0.0217 | 8954.4 samples/s | 35.0 steps/s
[Step= 400] | Loss=0.19168 | acc=0.9776 | tpr=0.9502 | fpr=0.0219 | 8565.7 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.19519 | acc=0.9775 | tpr=0.9479 | fpr=0.0220 | 9011.6 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.19448 | acc=0.9775 | tpr=0.9485 | fpr=0.0219 | 8321.6 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.19291 | acc=0.9776 | tpr=0.9475 | fpr=0.0218 | 14949.1 samples/s | 58.4 steps/s
Avg test loss: 0.19252, Avg test acc: 0.97766, Avg tpr: 0.94731, Avg fpr: 0.02179, total FA: 3025

server round 27/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=34001 Epoch=66.3] | Loss=0.00221 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=9.578 | 3451.3 samples/s | 53.9 steps/s
[Step=34050 Epoch=66.4] | Loss=0.00924 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=9.581 | 5543.3 samples/s | 86.6 steps/s
[Step=34100 Epoch=66.5] | Loss=0.01168 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.485 | L2-Norm(final)=9.586 | 5681.3 samples/s | 88.8 steps/s
[Step=34150 Epoch=66.6] | Loss=0.01143 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.485 | L2-Norm(final)=9.589 | 5629.8 samples/s | 88.0 steps/s
[Step=34200 Epoch=66.7] | Loss=0.01183 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=9.592 | 5694.2 samples/s | 89.0 steps/s
[Step=34250 Epoch=66.8] | Loss=0.01154 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.485 | L2-Norm(final)=9.594 | 5621.0 samples/s | 87.8 steps/s
[Step=34300 Epoch=66.9] | Loss=0.01174 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.485 | L2-Norm(final)=9.596 | 5813.4 samples/s | 90.8 steps/s
[Step=34350 Epoch=67.0] | Loss=0.01165 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.485 | L2-Norm(final)=9.599 | 5658.9 samples/s | 88.4 steps/s
[Step=34400 Epoch=67.1] | Loss=0.01153 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=9.601 | 5636.1 samples/s | 88.1 steps/s
[Step=34450 Epoch=67.2] | Loss=0.01159 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.485 | L2-Norm(final)=9.604 | 5716.1 samples/s | 89.3 steps/s
[Step=34500 Epoch=67.3] | Loss=0.01133 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=9.608 | 7164.3 samples/s | 111.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=34501 Epoch=67.3] | Loss=0.00683 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=9.643 | 3550.5 samples/s | 55.5 steps/s
[Step=34550 Epoch=67.4] | Loss=0.01841 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.501 | L2-Norm(final)=9.642 | 4738.8 samples/s | 74.0 steps/s
[Step=34600 Epoch=67.5] | Loss=0.01466 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.517 | L2-Norm(final)=9.639 | 4970.0 samples/s | 77.7 steps/s
[Step=34650 Epoch=67.6] | Loss=0.01356 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.527 | L2-Norm(final)=9.638 | 4935.5 samples/s | 77.1 steps/s
[Step=34700 Epoch=67.7] | Loss=0.01248 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.536 | L2-Norm(final)=9.638 | 4919.7 samples/s | 76.9 steps/s
[Step=34750 Epoch=67.8] | Loss=0.01195 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.543 | L2-Norm(final)=9.639 | 4959.2 samples/s | 77.5 steps/s
[Step=34800 Epoch=67.9] | Loss=0.01241 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.550 | L2-Norm(final)=9.639 | 4998.1 samples/s | 78.1 steps/s
[Step=34850 Epoch=68.0] | Loss=0.01233 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=9.640 | 4980.1 samples/s | 77.8 steps/s
[Step=34900 Epoch=68.1] | Loss=0.01259 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=9.641 | 4950.9 samples/s | 77.4 steps/s
[Step=34950 Epoch=68.2] | Loss=0.01226 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.570 | L2-Norm(final)=9.642 | 5000.0 samples/s | 78.1 steps/s
[Step=35000 Epoch=68.3] | Loss=0.01236 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.576 | L2-Norm(final)=9.643 | 6031.2 samples/s | 94.2 steps/s
[Step=35050 Epoch=68.4] | Loss=0.01208 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.582 | L2-Norm(final)=9.644 | 1829.2 samples/s | 28.6 steps/s
[Step=35100 Epoch=68.5] | Loss=0.01169 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.588 | L2-Norm(final)=9.646 | 4936.7 samples/s | 77.1 steps/s
[Step=35150 Epoch=68.6] | Loss=0.01144 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.593 | L2-Norm(final)=9.647 | 4956.6 samples/s | 77.4 steps/s
[Step=35200 Epoch=68.7] | Loss=0.01130 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.598 | L2-Norm(final)=9.649 | 4980.1 samples/s | 77.8 steps/s
[Step=35250 Epoch=68.8] | Loss=0.01113 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.603 | L2-Norm(final)=9.651 | 4929.2 samples/s | 77.0 steps/s
[Step=35300 Epoch=68.8] | Loss=0.01100 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.607 | L2-Norm(final)=9.652 | 4943.9 samples/s | 77.2 steps/s
[Step=35350 Epoch=68.9] | Loss=0.01108 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.611 | L2-Norm(final)=9.653 | 4972.1 samples/s | 77.7 steps/s
[Step=35400 Epoch=69.0] | Loss=0.01087 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=9.654 | 4969.3 samples/s | 77.6 steps/s
[Step=35450 Epoch=69.1] | Loss=0.01082 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=9.655 | 4968.9 samples/s | 77.6 steps/s
[Step=35500 Epoch=69.2] | Loss=0.01076 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.623 | L2-Norm(final)=9.656 | 5257.8 samples/s | 82.2 steps/s
[Step=35550 Epoch=69.3] | Loss=0.01063 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.627 | L2-Norm(final)=9.657 | 1931.5 samples/s | 30.2 steps/s
[Step=35600 Epoch=69.4] | Loss=0.01057 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.631 | L2-Norm(final)=9.658 | 5019.8 samples/s | 78.4 steps/s
[Step=35650 Epoch=69.5] | Loss=0.01042 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.634 | L2-Norm(final)=9.659 | 4919.9 samples/s | 76.9 steps/s
[Step=35700 Epoch=69.6] | Loss=0.01030 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=9.660 | 4962.9 samples/s | 77.5 steps/s
[Step=35750 Epoch=69.7] | Loss=0.01017 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.641 | L2-Norm(final)=9.661 | 4968.9 samples/s | 77.6 steps/s
[Step=35800 Epoch=69.8] | Loss=0.01011 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.644 | L2-Norm(final)=9.663 | 4976.6 samples/s | 77.8 steps/s
[Step=35850 Epoch=69.9] | Loss=0.01005 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.647 | L2-Norm(final)=9.664 | 4968.5 samples/s | 77.6 steps/s
[Step=35900 Epoch=70.0] | Loss=0.00998 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.650 | L2-Norm(final)=9.665 | 4967.5 samples/s | 77.6 steps/s
[Step=35950 Epoch=70.1] | Loss=0.00984 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.653 | L2-Norm(final)=9.666 | 4976.0 samples/s | 77.8 steps/s
[Step=36000 Epoch=70.2] | Loss=0.00977 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.656 | L2-Norm(final)=9.667 | 4973.5 samples/s | 77.7 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step36000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=107.8] | Loss=0.00007 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=11.374 | 4133.5 samples/s | 64.6 steps/s
[Step=28050 Epoch=108.0] | Loss=0.00135 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=11.384 | 4944.5 samples/s | 77.3 steps/s
[Step=28100 Epoch=108.2] | Loss=0.00083 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=11.395 | 5167.6 samples/s | 80.7 steps/s
[Step=28150 Epoch=108.4] | Loss=0.00082 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=11.405 | 5392.6 samples/s | 84.3 steps/s
[Step=28200 Epoch=108.6] | Loss=0.00075 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.482 | L2-Norm(final)=11.415 | 5295.0 samples/s | 82.7 steps/s
[Step=28250 Epoch=108.7] | Loss=0.00083 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=11.426 | 7240.6 samples/s | 113.1 steps/s
[Step=28300 Epoch=108.9] | Loss=0.00088 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=11.435 | 1928.8 samples/s | 30.1 steps/s
[Step=28350 Epoch=109.1] | Loss=0.00083 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=11.444 | 5349.3 samples/s | 83.6 steps/s
[Step=28400 Epoch=109.3] | Loss=0.00081 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=11.452 | 5309.7 samples/s | 83.0 steps/s
[Step=28450 Epoch=109.5] | Loss=0.00076 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=11.461 | 5331.3 samples/s | 83.3 steps/s
[Step=28500 Epoch=109.7] | Loss=0.00073 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=11.468 | 6247.1 samples/s | 97.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=109.7] | Loss=0.00004 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=11.538 | 3861.1 samples/s | 60.3 steps/s
[Step=28550 Epoch=109.9] | Loss=0.00131 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.499 | L2-Norm(final)=11.539 | 4447.9 samples/s | 69.5 steps/s
[Step=28600 Epoch=110.1] | Loss=0.00112 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.531 | L2-Norm(final)=11.540 | 4704.6 samples/s | 73.5 steps/s
[Step=28650 Epoch=110.3] | Loss=0.00083 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.545 | L2-Norm(final)=11.540 | 4729.4 samples/s | 73.9 steps/s
[Step=28700 Epoch=110.5] | Loss=0.00063 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.551 | L2-Norm(final)=11.541 | 4698.8 samples/s | 73.4 steps/s
[Step=28750 Epoch=110.7] | Loss=0.00067 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.553 | L2-Norm(final)=11.541 | 6060.1 samples/s | 94.7 steps/s
[Step=28800 Epoch=110.9] | Loss=0.00057 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=11.540 | 1853.7 samples/s | 29.0 steps/s
[Step=28850 Epoch=111.1] | Loss=0.00050 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.559 | L2-Norm(final)=11.539 | 4656.1 samples/s | 72.8 steps/s
[Step=28900 Epoch=111.2] | Loss=0.00052 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.560 | L2-Norm(final)=11.539 | 4695.1 samples/s | 73.4 steps/s
[Step=28950 Epoch=111.4] | Loss=0.00047 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=11.539 | 4692.7 samples/s | 73.3 steps/s
[Step=29000 Epoch=111.6] | Loss=0.00042 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.560 | L2-Norm(final)=11.539 | 5360.9 samples/s | 83.8 steps/s
[Step=29050 Epoch=111.8] | Loss=0.00039 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.559 | L2-Norm(final)=11.539 | 1933.6 samples/s | 30.2 steps/s
[Step=29100 Epoch=112.0] | Loss=0.00036 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=11.539 | 4689.5 samples/s | 73.3 steps/s
[Step=29150 Epoch=112.2] | Loss=0.00033 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.554 | L2-Norm(final)=11.539 | 4696.3 samples/s | 73.4 steps/s
[Step=29200 Epoch=112.4] | Loss=0.00031 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.551 | L2-Norm(final)=11.539 | 4699.8 samples/s | 73.4 steps/s
[Step=29250 Epoch=112.6] | Loss=0.00029 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.548 | L2-Norm(final)=11.539 | 4794.0 samples/s | 74.9 steps/s
[Step=29300 Epoch=112.8] | Loss=0.00027 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.544 | L2-Norm(final)=11.539 | 2008.6 samples/s | 31.4 steps/s
[Step=29350 Epoch=113.0] | Loss=0.00025 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.540 | L2-Norm(final)=11.539 | 4797.6 samples/s | 75.0 steps/s
[Step=29400 Epoch=113.2] | Loss=0.00024 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.536 | L2-Norm(final)=11.539 | 4727.2 samples/s | 73.9 steps/s
[Step=29450 Epoch=113.4] | Loss=0.00023 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.531 | L2-Norm(final)=11.539 | 4695.8 samples/s | 73.4 steps/s
[Step=29500 Epoch=113.6] | Loss=0.00021 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.526 | L2-Norm(final)=11.539 | 4713.3 samples/s | 73.6 steps/s
[Step=29550 Epoch=113.7] | Loss=0.00020 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.522 | L2-Norm(final)=11.539 | 2019.8 samples/s | 31.6 steps/s
[Step=29600 Epoch=113.9] | Loss=0.00020 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.517 | L2-Norm(final)=11.539 | 4661.2 samples/s | 72.8 steps/s
[Step=29650 Epoch=114.1] | Loss=0.00019 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.512 | L2-Norm(final)=11.539 | 4724.7 samples/s | 73.8 steps/s
[Step=29700 Epoch=114.3] | Loss=0.00018 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.506 | L2-Norm(final)=11.539 | 4684.3 samples/s | 73.2 steps/s
[Step=29750 Epoch=114.5] | Loss=0.00017 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.501 | L2-Norm(final)=11.540 | 4786.7 samples/s | 74.8 steps/s
[Step=29800 Epoch=114.7] | Loss=0.00017 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.496 | L2-Norm(final)=11.540 | 6783.2 samples/s | 106.0 steps/s
[Step=29850 Epoch=114.9] | Loss=0.00016 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.490 | L2-Norm(final)=11.540 | 1787.3 samples/s | 27.9 steps/s
[Step=29900 Epoch=115.1] | Loss=0.00015 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=11.540 | 4714.6 samples/s | 73.7 steps/s
[Step=29950 Epoch=115.3] | Loss=0.00015 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=11.540 | 4673.7 samples/s | 73.0 steps/s
[Step=30000 Epoch=115.5] | Loss=0.00014 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.473 | L2-Norm(final)=11.540 | 4786.6 samples/s | 74.8 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step30000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08038 | acc=0.9698 | tpr=0.9791 | fpr=0.0505 | 4318.4 samples/s | 16.9 steps/s
Avg test loss: 0.08296, Avg test acc: 0.96775, Avg tpr: 0.97744, Avg fpr: 0.05358, total FA: 418

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06618 | acc=0.9698 | tpr=0.9741 | fpr=0.0394 | 4409.3 samples/s | 17.2 steps/s
Avg test loss: 0.07203, Avg test acc: 0.96706, Avg tpr: 0.97138, Avg fpr: 0.04243, total FA: 331

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.16561 | acc=0.2805 | tpr=0.0170 | fpr=0.1472 | 4349.2 samples/s | 17.0 steps/s
Avg test loss: 7.16889, Avg test acc: 0.27959, Avg tpr: 0.01749, Avg fpr: 0.14396, total FA: 1123

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.44014 | acc=0.2973 | tpr=0.0225 | fpr=0.1058 | 4354.0 samples/s | 17.0 steps/s
Avg test loss: 7.44663, Avg test acc: 0.29590, Avg tpr: 0.02361, Avg fpr: 0.10524, total FA: 821

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.26218 | acc=0.1337 | tpr=0.7257 | fpr=0.8770 | 4354.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=6.24547 | acc=0.1351 | tpr=0.7335 | fpr=0.8760 | 8811.9 samples/s | 34.4 steps/s
[Step= 150] | Loss=6.24793 | acc=0.1336 | tpr=0.7205 | fpr=0.8772 | 8711.4 samples/s | 34.0 steps/s
[Step= 200] | Loss=6.23392 | acc=0.1342 | tpr=0.7213 | fpr=0.8765 | 8454.3 samples/s | 33.0 steps/s
[Step= 250] | Loss=6.23345 | acc=0.1335 | tpr=0.7048 | fpr=0.8769 | 8651.3 samples/s | 33.8 steps/s
[Step= 300] | Loss=6.22926 | acc=0.1339 | tpr=0.7098 | fpr=0.8766 | 8728.7 samples/s | 34.1 steps/s
[Step= 350] | Loss=6.22474 | acc=0.1333 | tpr=0.7107 | fpr=0.8772 | 8820.5 samples/s | 34.5 steps/s
[Step= 400] | Loss=6.21804 | acc=0.1331 | tpr=0.7133 | fpr=0.8775 | 9014.0 samples/s | 35.2 steps/s
[Step= 450] | Loss=6.21456 | acc=0.1329 | tpr=0.7162 | fpr=0.8777 | 8175.7 samples/s | 31.9 steps/s
[Step= 500] | Loss=6.21637 | acc=0.1326 | tpr=0.7181 | fpr=0.8779 | 8747.2 samples/s | 34.2 steps/s
[Step= 550] | Loss=6.21872 | acc=0.1329 | tpr=0.7163 | fpr=0.8777 | 15951.1 samples/s | 62.3 steps/s
Avg test loss: 6.21927, Avg test acc: 0.13274, Avg tpr: 0.71593, Avg fpr: 0.87786, total FA: 121889

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.33315 | acc=0.1464 | tpr=0.6283 | fpr=0.8623 | 4322.0 samples/s | 16.9 steps/s
[Step= 100] | Loss=5.31819 | acc=0.1473 | tpr=0.6567 | fpr=0.8622 | 8680.3 samples/s | 33.9 steps/s
[Step= 150] | Loss=5.31468 | acc=0.1467 | tpr=0.6340 | fpr=0.8622 | 8699.0 samples/s | 34.0 steps/s
[Step= 200] | Loss=5.30131 | acc=0.1471 | tpr=0.6317 | fpr=0.8618 | 8858.7 samples/s | 34.6 steps/s
[Step= 250] | Loss=5.30001 | acc=0.1461 | tpr=0.6157 | fpr=0.8624 | 8580.3 samples/s | 33.5 steps/s
[Step= 300] | Loss=5.29775 | acc=0.1466 | tpr=0.6196 | fpr=0.8621 | 8623.3 samples/s | 33.7 steps/s
[Step= 350] | Loss=5.29243 | acc=0.1461 | tpr=0.6218 | fpr=0.8625 | 8802.3 samples/s | 34.4 steps/s
[Step= 400] | Loss=5.28594 | acc=0.1462 | tpr=0.6231 | fpr=0.8625 | 8425.3 samples/s | 32.9 steps/s
[Step= 450] | Loss=5.28227 | acc=0.1461 | tpr=0.6285 | fpr=0.8627 | 8729.1 samples/s | 34.1 steps/s
[Step= 500] | Loss=5.28450 | acc=0.1461 | tpr=0.6330 | fpr=0.8627 | 8727.2 samples/s | 34.1 steps/s
[Step= 550] | Loss=5.28470 | acc=0.1460 | tpr=0.6311 | fpr=0.8629 | 14885.2 samples/s | 58.1 steps/s
Avg test loss: 5.28560, Avg test acc: 0.14585, Avg tpr: 0.63074, Avg fpr: 0.86297, total FA: 119821

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14990 | acc=0.9803 | tpr=0.9425 | fpr=0.0190 | 4320.2 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.16157 | acc=0.9789 | tpr=0.9552 | fpr=0.0207 | 8642.3 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.16659 | acc=0.9782 | tpr=0.9582 | fpr=0.0214 | 8681.2 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.16780 | acc=0.9786 | tpr=0.9585 | fpr=0.0210 | 8750.3 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.16553 | acc=0.9789 | tpr=0.9590 | fpr=0.0208 | 8698.4 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.16792 | acc=0.9786 | tpr=0.9578 | fpr=0.0210 | 8850.0 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.16890 | acc=0.9785 | tpr=0.9599 | fpr=0.0212 | 8645.8 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.17088 | acc=0.9781 | tpr=0.9573 | fpr=0.0215 | 8741.3 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.17477 | acc=0.9779 | tpr=0.9557 | fpr=0.0217 | 8391.4 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.17430 | acc=0.9779 | tpr=0.9559 | fpr=0.0217 | 9312.9 samples/s | 36.4 steps/s
[Step= 550] | Loss=0.17289 | acc=0.9780 | tpr=0.9558 | fpr=0.0216 | 9327.3 samples/s | 36.4 steps/s
Avg test loss: 0.17246, Avg test acc: 0.97805, Avg tpr: 0.95563, Avg fpr: 0.02154, total FA: 2991

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16555 | acc=0.9802 | tpr=0.9425 | fpr=0.0191 | 4306.8 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.17464 | acc=0.9795 | tpr=0.9510 | fpr=0.0199 | 9155.7 samples/s | 35.8 steps/s
[Step= 150] | Loss=0.18456 | acc=0.9785 | tpr=0.9496 | fpr=0.0209 | 8729.2 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.18442 | acc=0.9792 | tpr=0.9519 | fpr=0.0203 | 8316.4 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.18041 | acc=0.9796 | tpr=0.9520 | fpr=0.0199 | 8712.8 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.18207 | acc=0.9796 | tpr=0.9513 | fpr=0.0199 | 8513.4 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.18352 | acc=0.9794 | tpr=0.9512 | fpr=0.0201 | 8870.4 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.18517 | acc=0.9792 | tpr=0.9486 | fpr=0.0202 | 8687.9 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.18928 | acc=0.9791 | tpr=0.9489 | fpr=0.0204 | 8707.3 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.18883 | acc=0.9791 | tpr=0.9498 | fpr=0.0204 | 8694.9 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.18755 | acc=0.9792 | tpr=0.9499 | fpr=0.0202 | 7190.2 samples/s | 28.1 steps/s
Avg test loss: 0.18710, Avg test acc: 0.97925, Avg tpr: 0.94968, Avg fpr: 0.02022, total FA: 2807

server round 28/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=36001 Epoch=70.2] | Loss=0.00694 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.416 | L2-Norm(final)=9.705 | 3725.7 samples/s | 58.2 steps/s
[Step=36050 Epoch=70.3] | Loss=0.00967 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.416 | L2-Norm(final)=9.711 | 5381.0 samples/s | 84.1 steps/s
[Step=36100 Epoch=70.4] | Loss=0.01137 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=9.717 | 5582.1 samples/s | 87.2 steps/s
[Step=36150 Epoch=70.5] | Loss=0.01150 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=9.722 | 5712.9 samples/s | 89.3 steps/s
[Step=36200 Epoch=70.6] | Loss=0.01141 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=9.727 | 5648.0 samples/s | 88.2 steps/s
[Step=36250 Epoch=70.7] | Loss=0.01120 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=9.732 | 5863.8 samples/s | 91.6 steps/s
[Step=36300 Epoch=70.8] | Loss=0.01101 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=9.737 | 5585.7 samples/s | 87.3 steps/s
[Step=36350 Epoch=70.9] | Loss=0.01081 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=9.743 | 5706.7 samples/s | 89.2 steps/s
[Step=36400 Epoch=71.0] | Loss=0.01082 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=9.748 | 5800.7 samples/s | 90.6 steps/s
[Step=36450 Epoch=71.1] | Loss=0.01069 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=9.753 | 5605.4 samples/s | 87.6 steps/s
[Step=36500 Epoch=71.2] | Loss=0.01064 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=9.758 | 7098.6 samples/s | 110.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=36501 Epoch=71.2] | Loss=0.00703 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=9.810 | 3804.2 samples/s | 59.4 steps/s
[Step=36550 Epoch=71.3] | Loss=0.01247 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.432 | L2-Norm(final)=9.812 | 4731.4 samples/s | 73.9 steps/s
[Step=36600 Epoch=71.4] | Loss=0.01286 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.448 | L2-Norm(final)=9.811 | 4914.4 samples/s | 76.8 steps/s
[Step=36650 Epoch=71.5] | Loss=0.01300 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=9.810 | 4976.7 samples/s | 77.8 steps/s
[Step=36700 Epoch=71.6] | Loss=0.01337 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.473 | L2-Norm(final)=9.810 | 4939.6 samples/s | 77.2 steps/s
[Step=36750 Epoch=71.7] | Loss=0.01342 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.483 | L2-Norm(final)=9.811 | 4970.1 samples/s | 77.7 steps/s
[Step=36800 Epoch=71.8] | Loss=0.01366 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.490 | L2-Norm(final)=9.811 | 4995.8 samples/s | 78.1 steps/s
[Step=36850 Epoch=71.9] | Loss=0.01317 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.497 | L2-Norm(final)=9.811 | 4955.9 samples/s | 77.4 steps/s
[Step=36900 Epoch=72.0] | Loss=0.01263 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.504 | L2-Norm(final)=9.813 | 4986.6 samples/s | 77.9 steps/s
[Step=36950 Epoch=72.1] | Loss=0.01270 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.510 | L2-Norm(final)=9.814 | 4972.2 samples/s | 77.7 steps/s
[Step=37000 Epoch=72.2] | Loss=0.01253 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.516 | L2-Norm(final)=9.815 | 6073.0 samples/s | 94.9 steps/s
[Step=37050 Epoch=72.3] | Loss=0.01226 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.522 | L2-Norm(final)=9.816 | 1892.4 samples/s | 29.6 steps/s
[Step=37100 Epoch=72.4] | Loss=0.01201 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.528 | L2-Norm(final)=9.817 | 4936.6 samples/s | 77.1 steps/s
[Step=37150 Epoch=72.5] | Loss=0.01160 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.533 | L2-Norm(final)=9.818 | 4902.3 samples/s | 76.6 steps/s
[Step=37200 Epoch=72.6] | Loss=0.01131 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.538 | L2-Norm(final)=9.819 | 4957.2 samples/s | 77.5 steps/s
[Step=37250 Epoch=72.7] | Loss=0.01121 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.543 | L2-Norm(final)=9.821 | 4981.8 samples/s | 77.8 steps/s
[Step=37300 Epoch=72.7] | Loss=0.01113 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=9.822 | 4955.7 samples/s | 77.4 steps/s
[Step=37350 Epoch=72.8] | Loss=0.01098 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.551 | L2-Norm(final)=9.823 | 5012.5 samples/s | 78.3 steps/s
[Step=37400 Epoch=72.9] | Loss=0.01078 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.555 | L2-Norm(final)=9.824 | 4929.2 samples/s | 77.0 steps/s
[Step=37450 Epoch=73.0] | Loss=0.01080 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.559 | L2-Norm(final)=9.826 | 4980.5 samples/s | 77.8 steps/s
[Step=37500 Epoch=73.1] | Loss=0.01070 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.563 | L2-Norm(final)=9.827 | 5252.8 samples/s | 82.1 steps/s
[Step=37550 Epoch=73.2] | Loss=0.01055 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=9.828 | 1959.4 samples/s | 30.6 steps/s
[Step=37600 Epoch=73.3] | Loss=0.01033 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.570 | L2-Norm(final)=9.830 | 5012.0 samples/s | 78.3 steps/s
[Step=37650 Epoch=73.4] | Loss=0.01019 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.573 | L2-Norm(final)=9.831 | 4991.8 samples/s | 78.0 steps/s
[Step=37700 Epoch=73.5] | Loss=0.01005 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.576 | L2-Norm(final)=9.833 | 4896.7 samples/s | 76.5 steps/s
[Step=37750 Epoch=73.6] | Loss=0.00993 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.579 | L2-Norm(final)=9.834 | 4972.6 samples/s | 77.7 steps/s
[Step=37800 Epoch=73.7] | Loss=0.00986 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.582 | L2-Norm(final)=9.835 | 4934.2 samples/s | 77.1 steps/s
[Step=37850 Epoch=73.8] | Loss=0.00981 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.585 | L2-Norm(final)=9.837 | 4997.1 samples/s | 78.1 steps/s
[Step=37900 Epoch=73.9] | Loss=0.00974 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.587 | L2-Norm(final)=9.838 | 4978.0 samples/s | 77.8 steps/s
[Step=37950 Epoch=74.0] | Loss=0.00970 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=9.839 | 5005.9 samples/s | 78.2 steps/s
[Step=38000 Epoch=74.1] | Loss=0.00969 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.593 | L2-Norm(final)=9.841 | 4970.7 samples/s | 77.7 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step38000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=46.9] | Loss=0.01408 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.416 | L2-Norm(final)=8.175 | 3793.7 samples/s | 59.3 steps/s
[Step=24050 Epoch=47.0] | Loss=0.01470 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.417 | L2-Norm(final)=8.181 | 5633.6 samples/s | 88.0 steps/s
[Step=24100 Epoch=47.1] | Loss=0.01490 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.418 | L2-Norm(final)=8.189 | 5719.9 samples/s | 89.4 steps/s
[Step=24150 Epoch=47.2] | Loss=0.01395 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=8.196 | 5602.4 samples/s | 87.5 steps/s
[Step=24200 Epoch=47.3] | Loss=0.01383 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.418 | L2-Norm(final)=8.203 | 5704.2 samples/s | 89.1 steps/s
[Step=24250 Epoch=47.4] | Loss=0.01385 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=8.211 | 5762.9 samples/s | 90.0 steps/s
[Step=24300 Epoch=47.5] | Loss=0.01385 | Reg=0.00180 | acc=0.9531 | L2-Norm=13.418 | L2-Norm(final)=8.219 | 5651.9 samples/s | 88.3 steps/s
[Step=24350 Epoch=47.6] | Loss=0.01367 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.418 | L2-Norm(final)=8.225 | 5705.7 samples/s | 89.2 steps/s
[Step=24400 Epoch=47.7] | Loss=0.01363 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=8.232 | 5716.8 samples/s | 89.3 steps/s
[Step=24450 Epoch=47.8] | Loss=0.01360 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=8.238 | 5639.4 samples/s | 88.1 steps/s
[Step=24500 Epoch=47.9] | Loss=0.01334 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.418 | L2-Norm(final)=8.244 | 7361.6 samples/s | 115.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=47.9] | Loss=0.01010 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.418 | L2-Norm(final)=8.304 | 3820.8 samples/s | 59.7 steps/s
[Step=24550 Epoch=48.0] | Loss=0.01458 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.431 | L2-Norm(final)=8.308 | 4887.5 samples/s | 76.4 steps/s
[Step=24600 Epoch=48.1] | Loss=0.01304 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.449 | L2-Norm(final)=8.310 | 4923.5 samples/s | 76.9 steps/s
[Step=24650 Epoch=48.2] | Loss=0.01246 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.463 | L2-Norm(final)=8.312 | 5016.0 samples/s | 78.4 steps/s
[Step=24700 Epoch=48.3] | Loss=0.01283 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.473 | L2-Norm(final)=8.314 | 4947.8 samples/s | 77.3 steps/s
[Step=24750 Epoch=48.4] | Loss=0.01345 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.482 | L2-Norm(final)=8.315 | 5004.3 samples/s | 78.2 steps/s
[Step=24800 Epoch=48.5] | Loss=0.01328 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.489 | L2-Norm(final)=8.316 | 4979.3 samples/s | 77.8 steps/s
[Step=24850 Epoch=48.6] | Loss=0.01306 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.496 | L2-Norm(final)=8.317 | 4937.0 samples/s | 77.1 steps/s
[Step=24900 Epoch=48.7] | Loss=0.01274 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.503 | L2-Norm(final)=8.318 | 5009.3 samples/s | 78.3 steps/s
[Step=24950 Epoch=48.8] | Loss=0.01296 | Reg=0.00183 | acc=0.9531 | L2-Norm=13.509 | L2-Norm(final)=8.320 | 4944.8 samples/s | 77.3 steps/s
[Step=25000 Epoch=48.9] | Loss=0.01275 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.516 | L2-Norm(final)=8.321 | 6122.7 samples/s | 95.7 steps/s
[Step=25050 Epoch=49.0] | Loss=0.01241 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.521 | L2-Norm(final)=8.323 | 1917.3 samples/s | 30.0 steps/s
[Step=25100 Epoch=49.1] | Loss=0.01215 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.527 | L2-Norm(final)=8.325 | 4924.4 samples/s | 76.9 steps/s
[Step=25150 Epoch=49.2] | Loss=0.01199 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.532 | L2-Norm(final)=8.327 | 4977.5 samples/s | 77.8 steps/s
[Step=25200 Epoch=49.3] | Loss=0.01172 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.537 | L2-Norm(final)=8.329 | 4948.3 samples/s | 77.3 steps/s
[Step=25250 Epoch=49.4] | Loss=0.01178 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.541 | L2-Norm(final)=8.330 | 5029.8 samples/s | 78.6 steps/s
[Step=25300 Epoch=49.5] | Loss=0.01149 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=8.332 | 4929.1 samples/s | 77.0 steps/s
[Step=25350 Epoch=49.6] | Loss=0.01144 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.550 | L2-Norm(final)=8.333 | 4979.3 samples/s | 77.8 steps/s
[Step=25400 Epoch=49.7] | Loss=0.01140 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.554 | L2-Norm(final)=8.335 | 4914.5 samples/s | 76.8 steps/s
[Step=25450 Epoch=49.8] | Loss=0.01133 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.558 | L2-Norm(final)=8.336 | 4979.4 samples/s | 77.8 steps/s
[Step=25500 Epoch=49.9] | Loss=0.01114 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.562 | L2-Norm(final)=8.338 | 5391.9 samples/s | 84.2 steps/s
[Step=25550 Epoch=49.9] | Loss=0.01098 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.566 | L2-Norm(final)=8.339 | 2021.5 samples/s | 31.6 steps/s
[Step=25600 Epoch=50.0] | Loss=0.01084 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.569 | L2-Norm(final)=8.341 | 4969.7 samples/s | 77.7 steps/s
[Step=25650 Epoch=50.1] | Loss=0.01073 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.573 | L2-Norm(final)=8.342 | 4959.5 samples/s | 77.5 steps/s
[Step=25700 Epoch=50.2] | Loss=0.01056 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.576 | L2-Norm(final)=8.344 | 4972.4 samples/s | 77.7 steps/s
[Step=25750 Epoch=50.3] | Loss=0.01034 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.580 | L2-Norm(final)=8.346 | 4842.0 samples/s | 75.7 steps/s
[Step=25800 Epoch=50.4] | Loss=0.01020 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.583 | L2-Norm(final)=8.347 | 4932.6 samples/s | 77.1 steps/s
[Step=25850 Epoch=50.5] | Loss=0.01006 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.586 | L2-Norm(final)=8.349 | 5076.2 samples/s | 79.3 steps/s
[Step=25900 Epoch=50.6] | Loss=0.01000 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.589 | L2-Norm(final)=8.351 | 4964.6 samples/s | 77.6 steps/s
[Step=25950 Epoch=50.7] | Loss=0.00990 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.592 | L2-Norm(final)=8.352 | 4947.0 samples/s | 77.3 steps/s
[Step=26000 Epoch=50.8] | Loss=0.00991 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.595 | L2-Norm(final)=8.354 | 4997.1 samples/s | 78.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step26000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07540 | acc=0.9685 | tpr=0.9738 | fpr=0.0429 | 4328.5 samples/s | 16.9 steps/s
Avg test loss: 0.07776, Avg test acc: 0.96690, Avg tpr: 0.97185, Avg fpr: 0.04397, total FA: 343

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07311 | acc=0.9705 | tpr=0.9796 | fpr=0.0493 | 4336.1 samples/s | 16.9 steps/s
Avg test loss: 0.07579, Avg test acc: 0.96887, Avg tpr: 0.97820, Avg fpr: 0.05166, total FA: 403

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.16561 | acc=0.2805 | tpr=0.0170 | fpr=0.1472 | 4312.2 samples/s | 16.8 steps/s
Avg test loss: 7.16889, Avg test acc: 0.27959, Avg tpr: 0.01749, Avg fpr: 0.14396, total FA: 1123

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.44014 | acc=0.2973 | tpr=0.0225 | fpr=0.1058 | 4377.2 samples/s | 17.1 steps/s
Avg test loss: 7.44663, Avg test acc: 0.29590, Avg tpr: 0.02361, Avg fpr: 0.10524, total FA: 821

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.63830 | acc=0.1420 | tpr=0.7035 | fpr=0.8681 | 4298.1 samples/s | 16.8 steps/s
[Step= 100] | Loss=5.62252 | acc=0.1455 | tpr=0.7228 | fpr=0.8653 | 9206.5 samples/s | 36.0 steps/s
[Step= 150] | Loss=5.62264 | acc=0.1448 | tpr=0.6974 | fpr=0.8654 | 8287.5 samples/s | 32.4 steps/s
[Step= 200] | Loss=5.60897 | acc=0.1457 | tpr=0.6907 | fpr=0.8642 | 8597.7 samples/s | 33.6 steps/s
[Step= 250] | Loss=5.60502 | acc=0.1450 | tpr=0.6795 | fpr=0.8647 | 9327.7 samples/s | 36.4 steps/s
[Step= 300] | Loss=5.59932 | acc=0.1459 | tpr=0.6822 | fpr=0.8639 | 7436.9 samples/s | 29.1 steps/s
[Step= 350] | Loss=5.59408 | acc=0.1449 | tpr=0.6844 | fpr=0.8649 | 5394.2 samples/s | 21.1 steps/s
[Step= 400] | Loss=5.58705 | acc=0.1449 | tpr=0.6887 | fpr=0.8650 | 8732.8 samples/s | 34.1 steps/s
[Step= 450] | Loss=5.58420 | acc=0.1449 | tpr=0.6923 | fpr=0.8651 | 8819.7 samples/s | 34.5 steps/s
[Step= 500] | Loss=5.58649 | acc=0.1448 | tpr=0.6960 | fpr=0.8652 | 8440.4 samples/s | 33.0 steps/s
[Step= 550] | Loss=5.58896 | acc=0.1448 | tpr=0.6952 | fpr=0.8652 | 16191.3 samples/s | 63.2 steps/s
Avg test loss: 5.58955, Avg test acc: 0.14475, Avg tpr: 0.69493, Avg fpr: 0.86526, total FA: 120139

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.93994 | acc=0.1382 | tpr=0.7124 | fpr=0.8721 | 4440.6 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.93147 | acc=0.1407 | tpr=0.7271 | fpr=0.8702 | 8303.9 samples/s | 32.4 steps/s
[Step= 150] | Loss=5.92731 | acc=0.1401 | tpr=0.7104 | fpr=0.8704 | 8712.3 samples/s | 34.0 steps/s
[Step= 200] | Loss=5.91304 | acc=0.1405 | tpr=0.7027 | fpr=0.8697 | 9197.5 samples/s | 35.9 steps/s
[Step= 250] | Loss=5.91188 | acc=0.1400 | tpr=0.6882 | fpr=0.8699 | 8515.7 samples/s | 33.3 steps/s
[Step= 300] | Loss=5.90916 | acc=0.1404 | tpr=0.6945 | fpr=0.8697 | 4971.3 samples/s | 19.4 steps/s
[Step= 350] | Loss=5.90359 | acc=0.1398 | tpr=0.6951 | fpr=0.8702 | 8760.3 samples/s | 34.2 steps/s
[Step= 400] | Loss=5.89688 | acc=0.1398 | tpr=0.6969 | fpr=0.8703 | 8424.5 samples/s | 32.9 steps/s
[Step= 450] | Loss=5.89252 | acc=0.1398 | tpr=0.7020 | fpr=0.8704 | 9497.3 samples/s | 37.1 steps/s
[Step= 500] | Loss=5.89377 | acc=0.1399 | tpr=0.7057 | fpr=0.8704 | 8122.8 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.89439 | acc=0.1397 | tpr=0.7035 | fpr=0.8705 | 14476.8 samples/s | 56.6 steps/s
Avg test loss: 5.89565, Avg test acc: 0.13962, Avg tpr: 0.70325, Avg fpr: 0.87062, total FA: 120884

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14990 | acc=0.9803 | tpr=0.9425 | fpr=0.0190 | 4342.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.16157 | acc=0.9789 | tpr=0.9552 | fpr=0.0207 | 8565.1 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.16659 | acc=0.9782 | tpr=0.9582 | fpr=0.0214 | 8868.7 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.16780 | acc=0.9786 | tpr=0.9585 | fpr=0.0210 | 8334.0 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.16553 | acc=0.9789 | tpr=0.9590 | fpr=0.0208 | 8540.0 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.16792 | acc=0.9786 | tpr=0.9578 | fpr=0.0210 | 5148.0 samples/s | 20.1 steps/s
[Step= 350] | Loss=0.16890 | acc=0.9785 | tpr=0.9599 | fpr=0.0212 | 8684.7 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.17088 | acc=0.9781 | tpr=0.9573 | fpr=0.0215 | 8589.0 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.17477 | acc=0.9779 | tpr=0.9557 | fpr=0.0217 | 9109.4 samples/s | 35.6 steps/s
[Step= 500] | Loss=0.17430 | acc=0.9779 | tpr=0.9559 | fpr=0.0217 | 8043.7 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.17289 | acc=0.9780 | tpr=0.9558 | fpr=0.0216 | 15980.9 samples/s | 62.4 steps/s
Avg test loss: 0.17246, Avg test acc: 0.97805, Avg tpr: 0.95563, Avg fpr: 0.02154, total FA: 2991

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16555 | acc=0.9802 | tpr=0.9425 | fpr=0.0191 | 4293.0 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.17464 | acc=0.9795 | tpr=0.9510 | fpr=0.0199 | 8834.8 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.18456 | acc=0.9785 | tpr=0.9496 | fpr=0.0209 | 8766.6 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.18442 | acc=0.9792 | tpr=0.9519 | fpr=0.0203 | 8554.4 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.18041 | acc=0.9796 | tpr=0.9520 | fpr=0.0199 | 8315.2 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.18207 | acc=0.9796 | tpr=0.9513 | fpr=0.0199 | 5258.8 samples/s | 20.5 steps/s
[Step= 350] | Loss=0.18352 | acc=0.9794 | tpr=0.9512 | fpr=0.0201 | 8618.8 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.18517 | acc=0.9792 | tpr=0.9486 | fpr=0.0202 | 8828.0 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.18928 | acc=0.9791 | tpr=0.9489 | fpr=0.0204 | 8506.0 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.18883 | acc=0.9791 | tpr=0.9498 | fpr=0.0204 | 8570.2 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.18755 | acc=0.9792 | tpr=0.9499 | fpr=0.0202 | 16287.7 samples/s | 63.6 steps/s
Avg test loss: 0.18710, Avg test acc: 0.97925, Avg tpr: 0.94968, Avg fpr: 0.02022, total FA: 2807

server round 29/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=38001 Epoch=74.1] | Loss=0.02682 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.373 | L2-Norm(final)=9.880 | 3726.4 samples/s | 58.2 steps/s
[Step=38050 Epoch=74.2] | Loss=0.00919 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.373 | L2-Norm(final)=9.886 | 5480.7 samples/s | 85.6 steps/s
[Step=38100 Epoch=74.3] | Loss=0.00950 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.373 | L2-Norm(final)=9.889 | 5679.4 samples/s | 88.7 steps/s
[Step=38150 Epoch=74.4] | Loss=0.00984 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=9.892 | 5656.0 samples/s | 88.4 steps/s
[Step=38200 Epoch=74.5] | Loss=0.01004 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.373 | L2-Norm(final)=9.894 | 5776.2 samples/s | 90.3 steps/s
[Step=38250 Epoch=74.6] | Loss=0.01001 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=9.896 | 5692.3 samples/s | 88.9 steps/s
[Step=38300 Epoch=74.7] | Loss=0.01024 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.373 | L2-Norm(final)=9.898 | 5674.0 samples/s | 88.7 steps/s
[Step=38350 Epoch=74.8] | Loss=0.01056 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.373 | L2-Norm(final)=9.900 | 5734.6 samples/s | 89.6 steps/s
[Step=38400 Epoch=74.9] | Loss=0.01019 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.373 | L2-Norm(final)=9.902 | 5704.7 samples/s | 89.1 steps/s
[Step=38450 Epoch=75.0] | Loss=0.01015 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.373 | L2-Norm(final)=9.904 | 5813.9 samples/s | 90.8 steps/s
[Step=38500 Epoch=75.1] | Loss=0.01018 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=9.906 | 7038.1 samples/s | 110.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=38501 Epoch=75.1] | Loss=0.00426 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=9.930 | 3601.1 samples/s | 56.3 steps/s
[Step=38550 Epoch=75.2] | Loss=0.00891 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.388 | L2-Norm(final)=9.932 | 5029.6 samples/s | 78.6 steps/s
[Step=38600 Epoch=75.3] | Loss=0.01171 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.404 | L2-Norm(final)=9.930 | 4953.7 samples/s | 77.4 steps/s
[Step=38650 Epoch=75.4] | Loss=0.01179 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=9.930 | 4947.3 samples/s | 77.3 steps/s
[Step=38700 Epoch=75.5] | Loss=0.01196 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.429 | L2-Norm(final)=9.931 | 4848.7 samples/s | 75.8 steps/s
[Step=38750 Epoch=75.6] | Loss=0.01232 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.440 | L2-Norm(final)=9.930 | 4972.5 samples/s | 77.7 steps/s
[Step=38800 Epoch=75.7] | Loss=0.01233 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.450 | L2-Norm(final)=9.930 | 4986.7 samples/s | 77.9 steps/s
[Step=38850 Epoch=75.8] | Loss=0.01254 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.458 | L2-Norm(final)=9.930 | 5029.4 samples/s | 78.6 steps/s
[Step=38900 Epoch=75.9] | Loss=0.01236 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.465 | L2-Norm(final)=9.930 | 4891.4 samples/s | 76.4 steps/s
[Step=38950 Epoch=76.0] | Loss=0.01278 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.472 | L2-Norm(final)=9.930 | 4987.4 samples/s | 77.9 steps/s
[Step=39000 Epoch=76.1] | Loss=0.01280 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=9.930 | 6072.2 samples/s | 94.9 steps/s
[Step=39050 Epoch=76.2] | Loss=0.01254 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.485 | L2-Norm(final)=9.931 | 1868.5 samples/s | 29.2 steps/s
[Step=39100 Epoch=76.3] | Loss=0.01202 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.491 | L2-Norm(final)=9.932 | 4961.0 samples/s | 77.5 steps/s
[Step=39150 Epoch=76.4] | Loss=0.01179 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.496 | L2-Norm(final)=9.933 | 4973.6 samples/s | 77.7 steps/s
[Step=39200 Epoch=76.5] | Loss=0.01150 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.501 | L2-Norm(final)=9.934 | 4946.1 samples/s | 77.3 steps/s
[Step=39250 Epoch=76.6] | Loss=0.01128 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.506 | L2-Norm(final)=9.936 | 4921.8 samples/s | 76.9 steps/s
[Step=39300 Epoch=76.7] | Loss=0.01113 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.510 | L2-Norm(final)=9.937 | 5009.2 samples/s | 78.3 steps/s
[Step=39350 Epoch=76.7] | Loss=0.01092 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.514 | L2-Norm(final)=9.938 | 4975.2 samples/s | 77.7 steps/s
[Step=39400 Epoch=76.8] | Loss=0.01089 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=9.939 | 4956.6 samples/s | 77.4 steps/s
[Step=39450 Epoch=76.9] | Loss=0.01082 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.522 | L2-Norm(final)=9.940 | 4995.9 samples/s | 78.1 steps/s
[Step=39500 Epoch=77.0] | Loss=0.01062 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.526 | L2-Norm(final)=9.942 | 5271.6 samples/s | 82.4 steps/s
[Step=39550 Epoch=77.1] | Loss=0.01057 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.529 | L2-Norm(final)=9.943 | 1959.3 samples/s | 30.6 steps/s
[Step=39600 Epoch=77.2] | Loss=0.01041 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.533 | L2-Norm(final)=9.944 | 4899.1 samples/s | 76.5 steps/s
[Step=39650 Epoch=77.3] | Loss=0.01028 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.536 | L2-Norm(final)=9.945 | 4928.3 samples/s | 77.0 steps/s
[Step=39700 Epoch=77.4] | Loss=0.01012 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.539 | L2-Norm(final)=9.947 | 4978.6 samples/s | 77.8 steps/s
[Step=39750 Epoch=77.5] | Loss=0.01002 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.543 | L2-Norm(final)=9.948 | 4940.9 samples/s | 77.2 steps/s
[Step=39800 Epoch=77.6] | Loss=0.00995 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=9.950 | 5007.4 samples/s | 78.2 steps/s
[Step=39850 Epoch=77.7] | Loss=0.00985 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.548 | L2-Norm(final)=9.951 | 4992.4 samples/s | 78.0 steps/s
[Step=39900 Epoch=77.8] | Loss=0.00977 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.551 | L2-Norm(final)=9.952 | 5005.5 samples/s | 78.2 steps/s
[Step=39950 Epoch=77.9] | Loss=0.00963 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.554 | L2-Norm(final)=9.954 | 4980.0 samples/s | 77.8 steps/s
[Step=40000 Epoch=78.0] | Loss=0.00954 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=9.955 | 4920.4 samples/s | 76.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step40000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=84.3] | Loss=0.00307 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=10.019 | 3924.8 samples/s | 61.3 steps/s
[Step=22050 Epoch=84.5] | Loss=0.00040 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=10.026 | 5028.9 samples/s | 78.6 steps/s
[Step=22100 Epoch=84.7] | Loss=0.00043 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=10.036 | 5363.5 samples/s | 83.8 steps/s
[Step=22150 Epoch=84.9] | Loss=0.00036 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=10.046 | 5395.9 samples/s | 84.3 steps/s
[Step=22200 Epoch=85.1] | Loss=0.00031 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=10.055 | 5284.5 samples/s | 82.6 steps/s
[Step=22250 Epoch=85.3] | Loss=0.00028 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=10.063 | 7061.7 samples/s | 110.3 steps/s
[Step=22300 Epoch=85.4] | Loss=0.00029 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=10.070 | 1910.7 samples/s | 29.9 steps/s
[Step=22350 Epoch=85.6] | Loss=0.00027 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=10.078 | 5352.4 samples/s | 83.6 steps/s
[Step=22400 Epoch=85.8] | Loss=0.00026 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=10.085 | 5358.2 samples/s | 83.7 steps/s
[Step=22450 Epoch=86.0] | Loss=0.00027 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=10.092 | 5451.7 samples/s | 85.2 steps/s
[Step=22500 Epoch=86.2] | Loss=0.00027 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=10.099 | 5918.1 samples/s | 92.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=86.2] | Loss=0.00001 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=10.168 | 3848.4 samples/s | 60.1 steps/s
[Step=22550 Epoch=86.4] | Loss=0.00006 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=10.172 | 4465.4 samples/s | 69.8 steps/s
[Step=22600 Epoch=86.6] | Loss=0.00063 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=10.173 | 4737.5 samples/s | 74.0 steps/s
[Step=22650 Epoch=86.8] | Loss=0.00068 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=10.170 | 4675.4 samples/s | 73.1 steps/s
[Step=22700 Epoch=87.0] | Loss=0.00059 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.377 | L2-Norm(final)=10.169 | 4733.8 samples/s | 74.0 steps/s
[Step=22750 Epoch=87.2] | Loss=0.00078 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=10.168 | 5938.8 samples/s | 92.8 steps/s
[Step=22800 Epoch=87.4] | Loss=0.00081 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.395 | L2-Norm(final)=10.168 | 1870.2 samples/s | 29.2 steps/s
[Step=22850 Epoch=87.6] | Loss=0.00082 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.403 | L2-Norm(final)=10.167 | 4719.7 samples/s | 73.7 steps/s
[Step=22900 Epoch=87.7] | Loss=0.00101 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.412 | L2-Norm(final)=10.165 | 4654.3 samples/s | 72.7 steps/s
[Step=22950 Epoch=87.9] | Loss=0.00104 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.422 | L2-Norm(final)=10.164 | 4707.3 samples/s | 73.6 steps/s
[Step=23000 Epoch=88.1] | Loss=0.00097 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.430 | L2-Norm(final)=10.163 | 5230.2 samples/s | 81.7 steps/s
[Step=23050 Epoch=88.3] | Loss=0.00089 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.437 | L2-Norm(final)=10.162 | 1940.0 samples/s | 30.3 steps/s
[Step=23100 Epoch=88.5] | Loss=0.00081 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.442 | L2-Norm(final)=10.161 | 4787.8 samples/s | 74.8 steps/s
[Step=23150 Epoch=88.7] | Loss=0.00075 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.446 | L2-Norm(final)=10.161 | 4670.9 samples/s | 73.0 steps/s
[Step=23200 Epoch=88.9] | Loss=0.00070 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.449 | L2-Norm(final)=10.161 | 4829.0 samples/s | 75.5 steps/s
[Step=23250 Epoch=89.1] | Loss=0.00065 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.450 | L2-Norm(final)=10.161 | 4642.7 samples/s | 72.5 steps/s
[Step=23300 Epoch=89.3] | Loss=0.00061 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.451 | L2-Norm(final)=10.160 | 2000.2 samples/s | 31.3 steps/s
[Step=23350 Epoch=89.5] | Loss=0.00058 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=10.160 | 4769.7 samples/s | 74.5 steps/s
[Step=23400 Epoch=89.7] | Loss=0.00054 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=10.160 | 4773.6 samples/s | 74.6 steps/s
[Step=23450 Epoch=89.9] | Loss=0.00052 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.451 | L2-Norm(final)=10.160 | 4675.5 samples/s | 73.1 steps/s
[Step=23500 Epoch=90.0] | Loss=0.00049 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.450 | L2-Norm(final)=10.160 | 4707.5 samples/s | 73.6 steps/s
[Step=23550 Epoch=90.2] | Loss=0.00047 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.449 | L2-Norm(final)=10.160 | 2015.5 samples/s | 31.5 steps/s
[Step=23600 Epoch=90.4] | Loss=0.00045 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.447 | L2-Norm(final)=10.160 | 4656.7 samples/s | 72.8 steps/s
[Step=23650 Epoch=90.6] | Loss=0.00043 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.446 | L2-Norm(final)=10.161 | 4745.7 samples/s | 74.2 steps/s
[Step=23700 Epoch=90.8] | Loss=0.00041 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.444 | L2-Norm(final)=10.161 | 4741.8 samples/s | 74.1 steps/s
[Step=23750 Epoch=91.0] | Loss=0.00039 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.441 | L2-Norm(final)=10.161 | 4646.3 samples/s | 72.6 steps/s
[Step=23800 Epoch=91.2] | Loss=0.00038 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.439 | L2-Norm(final)=10.162 | 6434.9 samples/s | 100.5 steps/s
[Step=23850 Epoch=91.4] | Loss=0.00036 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.436 | L2-Norm(final)=10.162 | 1829.0 samples/s | 28.6 steps/s
[Step=23900 Epoch=91.6] | Loss=0.00035 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.434 | L2-Norm(final)=10.162 | 4692.5 samples/s | 73.3 steps/s
[Step=23950 Epoch=91.8] | Loss=0.00034 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.431 | L2-Norm(final)=10.163 | 4690.4 samples/s | 73.3 steps/s
[Step=24000 Epoch=92.0] | Loss=0.00033 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.428 | L2-Norm(final)=10.163 | 4724.9 samples/s | 73.8 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08947 | acc=0.9684 | tpr=0.9814 | fpr=0.0600 | 3297.3 samples/s | 12.9 steps/s
Avg test loss: 0.08990, Avg test acc: 0.96690, Avg tpr: 0.98059, Avg fpr: 0.06320, total FA: 493

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07311 | acc=0.9705 | tpr=0.9796 | fpr=0.0493 | 3232.5 samples/s | 12.6 steps/s
Avg test loss: 0.07579, Avg test acc: 0.96887, Avg tpr: 0.97820, Avg fpr: 0.05166, total FA: 403

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.23462 | acc=0.2880 | tpr=0.0130 | fpr=0.1147 | 3222.3 samples/s | 12.6 steps/s
Avg test loss: 7.24985, Avg test acc: 0.28564, Avg tpr: 0.01317, Avg fpr: 0.11511, total FA: 898

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.44014 | acc=0.2973 | tpr=0.0225 | fpr=0.1058 | 3234.7 samples/s | 12.6 steps/s
Avg test loss: 7.44663, Avg test acc: 0.29590, Avg tpr: 0.02361, Avg fpr: 0.10524, total FA: 821

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.86897 | acc=0.1119 | tpr=0.7566 | fpr=0.8997 | 3169.6 samples/s | 12.4 steps/s
[Step= 100] | Loss=6.86029 | acc=0.1149 | tpr=0.7719 | fpr=0.8973 | 8857.9 samples/s | 34.6 steps/s
[Step= 150] | Loss=6.86590 | acc=0.1142 | tpr=0.7637 | fpr=0.8977 | 8981.1 samples/s | 35.1 steps/s
[Step= 200] | Loss=6.85207 | acc=0.1152 | tpr=0.7596 | fpr=0.8966 | 8283.5 samples/s | 32.4 steps/s
[Step= 250] | Loss=6.84786 | acc=0.1151 | tpr=0.7441 | fpr=0.8964 | 9167.0 samples/s | 35.8 steps/s
[Step= 300] | Loss=6.84413 | acc=0.1151 | tpr=0.7462 | fpr=0.8964 | 8416.7 samples/s | 32.9 steps/s
[Step= 350] | Loss=6.83912 | acc=0.1143 | tpr=0.7527 | fpr=0.8972 | 8573.6 samples/s | 33.5 steps/s
[Step= 400] | Loss=6.83339 | acc=0.1141 | tpr=0.7533 | fpr=0.8975 | 8878.1 samples/s | 34.7 steps/s
[Step= 450] | Loss=6.83041 | acc=0.1141 | tpr=0.7580 | fpr=0.8976 | 8947.4 samples/s | 35.0 steps/s
[Step= 500] | Loss=6.83319 | acc=0.1139 | tpr=0.7604 | fpr=0.8978 | 8467.9 samples/s | 33.1 steps/s
[Step= 550] | Loss=6.83449 | acc=0.1140 | tpr=0.7585 | fpr=0.8978 | 16088.3 samples/s | 62.8 steps/s
Avg test loss: 6.83534, Avg test acc: 0.11386, Avg tpr: 0.75832, Avg fpr: 0.89786, total FA: 124666

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.93994 | acc=0.1382 | tpr=0.7124 | fpr=0.8721 | 4339.0 samples/s | 16.9 steps/s
[Step= 100] | Loss=5.93147 | acc=0.1407 | tpr=0.7271 | fpr=0.8702 | 8699.9 samples/s | 34.0 steps/s
[Step= 150] | Loss=5.92731 | acc=0.1401 | tpr=0.7104 | fpr=0.8704 | 8572.5 samples/s | 33.5 steps/s
[Step= 200] | Loss=5.91304 | acc=0.1405 | tpr=0.7027 | fpr=0.8697 | 8786.4 samples/s | 34.3 steps/s
[Step= 250] | Loss=5.91188 | acc=0.1400 | tpr=0.6882 | fpr=0.8699 | 8634.4 samples/s | 33.7 steps/s
[Step= 300] | Loss=5.90916 | acc=0.1404 | tpr=0.6945 | fpr=0.8697 | 8719.9 samples/s | 34.1 steps/s
[Step= 350] | Loss=5.90359 | acc=0.1398 | tpr=0.6951 | fpr=0.8702 | 8488.2 samples/s | 33.2 steps/s
[Step= 400] | Loss=5.89688 | acc=0.1398 | tpr=0.6969 | fpr=0.8703 | 8841.4 samples/s | 34.5 steps/s
[Step= 450] | Loss=5.89252 | acc=0.1398 | tpr=0.7020 | fpr=0.8704 | 8601.8 samples/s | 33.6 steps/s
[Step= 500] | Loss=5.89377 | acc=0.1399 | tpr=0.7057 | fpr=0.8704 | 8662.8 samples/s | 33.8 steps/s
[Step= 550] | Loss=5.89439 | acc=0.1397 | tpr=0.7035 | fpr=0.8705 | 15402.5 samples/s | 60.2 steps/s
Avg test loss: 5.89565, Avg test acc: 0.13962, Avg tpr: 0.70325, Avg fpr: 0.87062, total FA: 120884

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.16758 | acc=0.9805 | tpr=0.9513 | fpr=0.0189 | 4397.8 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.17988 | acc=0.9792 | tpr=0.9680 | fpr=0.0206 | 8400.3 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.18814 | acc=0.9780 | tpr=0.9640 | fpr=0.0217 | 8611.0 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.18989 | acc=0.9785 | tpr=0.9639 | fpr=0.0213 | 8779.6 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.18649 | acc=0.9787 | tpr=0.9598 | fpr=0.0209 | 8996.8 samples/s | 35.1 steps/s
[Step= 300] | Loss=0.18909 | acc=0.9785 | tpr=0.9571 | fpr=0.0211 | 8242.2 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.19111 | acc=0.9783 | tpr=0.9599 | fpr=0.0214 | 9097.0 samples/s | 35.5 steps/s
[Step= 400] | Loss=0.19332 | acc=0.9779 | tpr=0.9579 | fpr=0.0217 | 8939.9 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.19710 | acc=0.9777 | tpr=0.9562 | fpr=0.0219 | 8220.0 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.19616 | acc=0.9778 | tpr=0.9564 | fpr=0.0218 | 8358.4 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.19447 | acc=0.9779 | tpr=0.9562 | fpr=0.0217 | 15893.9 samples/s | 62.1 steps/s
Avg test loss: 0.19396, Avg test acc: 0.97796, Avg tpr: 0.95602, Avg fpr: 0.02164, total FA: 3005

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16555 | acc=0.9802 | tpr=0.9425 | fpr=0.0191 | 4341.6 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.17464 | acc=0.9795 | tpr=0.9510 | fpr=0.0199 | 8511.0 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.18456 | acc=0.9785 | tpr=0.9496 | fpr=0.0209 | 8821.3 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.18442 | acc=0.9792 | tpr=0.9519 | fpr=0.0203 | 8501.9 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.18041 | acc=0.9796 | tpr=0.9520 | fpr=0.0199 | 8921.5 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.18207 | acc=0.9796 | tpr=0.9513 | fpr=0.0199 | 8564.6 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.18352 | acc=0.9794 | tpr=0.9512 | fpr=0.0201 | 8661.0 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.18517 | acc=0.9792 | tpr=0.9486 | fpr=0.0202 | 8837.3 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.18928 | acc=0.9791 | tpr=0.9489 | fpr=0.0204 | 8479.9 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.18883 | acc=0.9791 | tpr=0.9498 | fpr=0.0204 | 8756.7 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.18755 | acc=0.9792 | tpr=0.9499 | fpr=0.0202 | 15802.5 samples/s | 61.7 steps/s
Avg test loss: 0.18710, Avg test acc: 0.97925, Avg tpr: 0.94968, Avg fpr: 0.02022, total FA: 2807

server round 30/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=40001 Epoch=78.0] | Loss=0.03190 | Reg=0.00179 | acc=0.9531 | L2-Norm=13.375 | L2-Norm(final)=9.999 | 3450.4 samples/s | 53.9 steps/s
[Step=40050 Epoch=78.1] | Loss=0.01421 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.375 | L2-Norm(final)=10.003 | 5567.0 samples/s | 87.0 steps/s
[Step=40100 Epoch=78.2] | Loss=0.01404 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=10.007 | 5690.6 samples/s | 88.9 steps/s
[Step=40150 Epoch=78.3] | Loss=0.01493 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.375 | L2-Norm(final)=10.011 | 5771.1 samples/s | 90.2 steps/s
[Step=40200 Epoch=78.4] | Loss=0.01383 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=10.015 | 5461.9 samples/s | 85.3 steps/s
[Step=40250 Epoch=78.5] | Loss=0.01406 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=10.020 | 5647.0 samples/s | 88.2 steps/s
[Step=40300 Epoch=78.6] | Loss=0.01399 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.375 | L2-Norm(final)=10.024 | 5817.4 samples/s | 90.9 steps/s
[Step=40350 Epoch=78.7] | Loss=0.01391 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=10.028 | 5723.1 samples/s | 89.4 steps/s
[Step=40400 Epoch=78.8] | Loss=0.01393 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.375 | L2-Norm(final)=10.032 | 5684.4 samples/s | 88.8 steps/s
[Step=40450 Epoch=78.9] | Loss=0.01342 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.375 | L2-Norm(final)=10.036 | 5668.2 samples/s | 88.6 steps/s
[Step=40500 Epoch=79.0] | Loss=0.01330 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.375 | L2-Norm(final)=10.040 | 7048.1 samples/s | 110.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=40501 Epoch=79.0] | Loss=0.00605 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=10.077 | 3549.9 samples/s | 55.5 steps/s
[Step=40550 Epoch=79.1] | Loss=0.01117 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.381 | L2-Norm(final)=10.080 | 4778.1 samples/s | 74.7 steps/s
[Step=40600 Epoch=79.2] | Loss=0.01051 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=10.081 | 4899.3 samples/s | 76.6 steps/s
[Step=40650 Epoch=79.3] | Loss=0.01104 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.391 | L2-Norm(final)=10.080 | 4933.4 samples/s | 77.1 steps/s
[Step=40700 Epoch=79.4] | Loss=0.01052 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.395 | L2-Norm(final)=10.080 | 4959.5 samples/s | 77.5 steps/s
[Step=40750 Epoch=79.5] | Loss=0.01016 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.398 | L2-Norm(final)=10.081 | 4952.3 samples/s | 77.4 steps/s
[Step=40800 Epoch=79.6] | Loss=0.00994 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.400 | L2-Norm(final)=10.081 | 5001.9 samples/s | 78.2 steps/s
[Step=40850 Epoch=79.7] | Loss=0.00976 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.403 | L2-Norm(final)=10.082 | 4923.1 samples/s | 76.9 steps/s
[Step=40900 Epoch=79.8] | Loss=0.00970 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.405 | L2-Norm(final)=10.083 | 4929.8 samples/s | 77.0 steps/s
[Step=40950 Epoch=79.9] | Loss=0.00956 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.408 | L2-Norm(final)=10.084 | 4973.8 samples/s | 77.7 steps/s
[Step=41000 Epoch=80.0] | Loss=0.00946 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.410 | L2-Norm(final)=10.084 | 6024.0 samples/s | 94.1 steps/s
[Step=41050 Epoch=80.1] | Loss=0.00920 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.412 | L2-Norm(final)=10.085 | 1854.3 samples/s | 29.0 steps/s
[Step=41100 Epoch=80.2] | Loss=0.00873 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.414 | L2-Norm(final)=10.086 | 4905.8 samples/s | 76.7 steps/s
[Step=41150 Epoch=80.3] | Loss=0.00856 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=10.088 | 4911.5 samples/s | 76.7 steps/s
[Step=41200 Epoch=80.4] | Loss=0.00839 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.417 | L2-Norm(final)=10.089 | 4954.5 samples/s | 77.4 steps/s
[Step=41250 Epoch=80.5] | Loss=0.00826 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=10.090 | 4920.8 samples/s | 76.9 steps/s
[Step=41300 Epoch=80.6] | Loss=0.00820 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=10.091 | 4931.7 samples/s | 77.1 steps/s
[Step=41350 Epoch=80.6] | Loss=0.00816 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.421 | L2-Norm(final)=10.092 | 4991.7 samples/s | 78.0 steps/s
[Step=41400 Epoch=80.7] | Loss=0.00810 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.422 | L2-Norm(final)=10.092 | 4959.9 samples/s | 77.5 steps/s
[Step=41450 Epoch=80.8] | Loss=0.00794 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.423 | L2-Norm(final)=10.093 | 5027.6 samples/s | 78.6 steps/s
[Step=41500 Epoch=80.9] | Loss=0.00799 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.424 | L2-Norm(final)=10.094 | 5185.9 samples/s | 81.0 steps/s
[Step=41550 Epoch=81.0] | Loss=0.00782 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.425 | L2-Norm(final)=10.095 | 1994.1 samples/s | 31.2 steps/s
[Step=41600 Epoch=81.1] | Loss=0.00766 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.426 | L2-Norm(final)=10.096 | 4909.2 samples/s | 76.7 steps/s
[Step=41650 Epoch=81.2] | Loss=0.00755 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.427 | L2-Norm(final)=10.097 | 4962.9 samples/s | 77.5 steps/s
[Step=41700 Epoch=81.3] | Loss=0.00749 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.428 | L2-Norm(final)=10.098 | 4912.2 samples/s | 76.8 steps/s
[Step=41750 Epoch=81.4] | Loss=0.00741 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.429 | L2-Norm(final)=10.099 | 4935.4 samples/s | 77.1 steps/s
[Step=41800 Epoch=81.5] | Loss=0.00732 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.430 | L2-Norm(final)=10.100 | 4962.6 samples/s | 77.5 steps/s
[Step=41850 Epoch=81.6] | Loss=0.00731 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.431 | L2-Norm(final)=10.102 | 4947.3 samples/s | 77.3 steps/s
[Step=41900 Epoch=81.7] | Loss=0.00725 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.432 | L2-Norm(final)=10.103 | 4958.1 samples/s | 77.5 steps/s
[Step=41950 Epoch=81.8] | Loss=0.00714 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.433 | L2-Norm(final)=10.104 | 4930.4 samples/s | 77.0 steps/s
[Step=42000 Epoch=81.9] | Loss=0.00712 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.434 | L2-Norm(final)=10.105 | 5004.6 samples/s | 78.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step42000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=26001 Epoch=50.8] | Loss=0.00243 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=8.399 | 4051.3 samples/s | 63.3 steps/s
[Step=26050 Epoch=50.9] | Loss=0.01444 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.375 | L2-Norm(final)=8.402 | 5072.9 samples/s | 79.3 steps/s
[Step=26100 Epoch=51.0] | Loss=0.01415 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.375 | L2-Norm(final)=8.405 | 5561.7 samples/s | 86.9 steps/s
[Step=26150 Epoch=51.1] | Loss=0.01430 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=8.409 | 5695.4 samples/s | 89.0 steps/s
[Step=26200 Epoch=51.2] | Loss=0.01414 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.375 | L2-Norm(final)=8.413 | 5696.8 samples/s | 89.0 steps/s
[Step=26250 Epoch=51.3] | Loss=0.01469 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=8.416 | 5659.5 samples/s | 88.4 steps/s
[Step=26300 Epoch=51.4] | Loss=0.01474 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=8.420 | 5721.1 samples/s | 89.4 steps/s
[Step=26350 Epoch=51.5] | Loss=0.01454 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=8.424 | 5686.4 samples/s | 88.8 steps/s
[Step=26400 Epoch=51.6] | Loss=0.01450 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.375 | L2-Norm(final)=8.427 | 5686.1 samples/s | 88.8 steps/s
[Step=26450 Epoch=51.7] | Loss=0.01475 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.375 | L2-Norm(final)=8.431 | 5845.4 samples/s | 91.3 steps/s
[Step=26500 Epoch=51.8] | Loss=0.01488 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.375 | L2-Norm(final)=8.434 | 7181.4 samples/s | 112.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=26501 Epoch=51.8] | Loss=0.02509 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.375 | L2-Norm(final)=8.468 | 3808.2 samples/s | 59.5 steps/s
[Step=26550 Epoch=51.9] | Loss=0.01458 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.381 | L2-Norm(final)=8.470 | 4906.2 samples/s | 76.7 steps/s
[Step=26600 Epoch=52.0] | Loss=0.01225 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=8.472 | 5011.7 samples/s | 78.3 steps/s
[Step=26650 Epoch=52.1] | Loss=0.01158 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.389 | L2-Norm(final)=8.474 | 4932.2 samples/s | 77.1 steps/s
[Step=26700 Epoch=52.2] | Loss=0.01113 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.392 | L2-Norm(final)=8.475 | 4874.7 samples/s | 76.2 steps/s
[Step=26750 Epoch=52.3] | Loss=0.01095 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.395 | L2-Norm(final)=8.477 | 4924.0 samples/s | 76.9 steps/s
[Step=26800 Epoch=52.4] | Loss=0.01078 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.397 | L2-Norm(final)=8.479 | 4995.1 samples/s | 78.0 steps/s
[Step=26850 Epoch=52.5] | Loss=0.01038 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.400 | L2-Norm(final)=8.480 | 4931.9 samples/s | 77.1 steps/s
[Step=26900 Epoch=52.6] | Loss=0.01015 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=8.482 | 4975.2 samples/s | 77.7 steps/s
[Step=26950 Epoch=52.7] | Loss=0.01030 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.404 | L2-Norm(final)=8.483 | 4953.1 samples/s | 77.4 steps/s
[Step=27000 Epoch=52.8] | Loss=0.01001 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.406 | L2-Norm(final)=8.484 | 6153.9 samples/s | 96.2 steps/s
[Step=27050 Epoch=52.9] | Loss=0.00960 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.408 | L2-Norm(final)=8.486 | 1916.8 samples/s | 29.9 steps/s
[Step=27100 Epoch=53.0] | Loss=0.00933 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.410 | L2-Norm(final)=8.487 | 4919.5 samples/s | 76.9 steps/s
[Step=27150 Epoch=53.1] | Loss=0.00913 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.412 | L2-Norm(final)=8.489 | 4935.5 samples/s | 77.1 steps/s
[Step=27200 Epoch=53.2] | Loss=0.00878 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.413 | L2-Norm(final)=8.490 | 5022.6 samples/s | 78.5 steps/s
[Step=27250 Epoch=53.3] | Loss=0.00859 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=8.492 | 4849.0 samples/s | 75.8 steps/s
[Step=27300 Epoch=53.4] | Loss=0.00852 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.416 | L2-Norm(final)=8.493 | 4934.1 samples/s | 77.1 steps/s
[Step=27350 Epoch=53.5] | Loss=0.00845 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=8.495 | 4952.3 samples/s | 77.4 steps/s
[Step=27400 Epoch=53.6] | Loss=0.00827 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.419 | L2-Norm(final)=8.496 | 4977.8 samples/s | 77.8 steps/s
[Step=27450 Epoch=53.7] | Loss=0.00821 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.421 | L2-Norm(final)=8.497 | 4973.3 samples/s | 77.7 steps/s
[Step=27500 Epoch=53.8] | Loss=0.00821 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.422 | L2-Norm(final)=8.499 | 5412.7 samples/s | 84.6 steps/s
[Step=27550 Epoch=53.9] | Loss=0.00806 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.424 | L2-Norm(final)=8.500 | 2017.1 samples/s | 31.5 steps/s
[Step=27600 Epoch=54.0] | Loss=0.00787 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.425 | L2-Norm(final)=8.501 | 4853.8 samples/s | 75.8 steps/s
[Step=27650 Epoch=54.1] | Loss=0.00781 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.426 | L2-Norm(final)=8.503 | 4913.8 samples/s | 76.8 steps/s
[Step=27700 Epoch=54.2] | Loss=0.00769 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.427 | L2-Norm(final)=8.504 | 4950.6 samples/s | 77.4 steps/s
[Step=27750 Epoch=54.3] | Loss=0.00765 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.429 | L2-Norm(final)=8.506 | 4955.9 samples/s | 77.4 steps/s
[Step=27800 Epoch=54.3] | Loss=0.00761 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.430 | L2-Norm(final)=8.507 | 4966.5 samples/s | 77.6 steps/s
[Step=27850 Epoch=54.4] | Loss=0.00757 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.431 | L2-Norm(final)=8.508 | 4983.3 samples/s | 77.9 steps/s
[Step=27900 Epoch=54.5] | Loss=0.00747 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.432 | L2-Norm(final)=8.510 | 4928.5 samples/s | 77.0 steps/s
[Step=27950 Epoch=54.6] | Loss=0.00742 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.433 | L2-Norm(final)=8.511 | 4958.2 samples/s | 77.5 steps/s
[Step=28000 Epoch=54.7] | Loss=0.00732 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.434 | L2-Norm(final)=8.512 | 5021.5 samples/s | 78.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08322 | acc=0.9702 | tpr=0.9768 | fpr=0.0441 | 4314.5 samples/s | 16.9 steps/s
Avg test loss: 0.08589, Avg test acc: 0.96831, Avg tpr: 0.97488, Avg fpr: 0.04615, total FA: 360

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07825 | acc=0.9708 | tpr=0.9804 | fpr=0.0500 | 4303.1 samples/s | 16.8 steps/s
Avg test loss: 0.08228, Avg test acc: 0.96951, Avg tpr: 0.97896, Avg fpr: 0.05128, total FA: 400

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.23462 | acc=0.2880 | tpr=0.0130 | fpr=0.1147 | 4301.1 samples/s | 16.8 steps/s
Avg test loss: 7.24985, Avg test acc: 0.28564, Avg tpr: 0.01317, Avg fpr: 0.11511, total FA: 898

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.44014 | acc=0.2973 | tpr=0.0225 | fpr=0.1058 | 4365.1 samples/s | 17.1 steps/s
Avg test loss: 7.44663, Avg test acc: 0.29590, Avg tpr: 0.02361, Avg fpr: 0.10524, total FA: 821

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.60114 | acc=0.1304 | tpr=0.6991 | fpr=0.8798 | 4363.0 samples/s | 17.0 steps/s
[Step= 100] | Loss=6.59213 | acc=0.1333 | tpr=0.7249 | fpr=0.8777 | 8770.8 samples/s | 34.3 steps/s
[Step= 150] | Loss=6.59314 | acc=0.1333 | tpr=0.7061 | fpr=0.8772 | 8679.0 samples/s | 33.9 steps/s
[Step= 200] | Loss=6.57944 | acc=0.1333 | tpr=0.6984 | fpr=0.8770 | 8523.2 samples/s | 33.3 steps/s
[Step= 250] | Loss=6.57607 | acc=0.1330 | tpr=0.6856 | fpr=0.8770 | 8898.9 samples/s | 34.8 steps/s
[Step= 300] | Loss=6.56821 | acc=0.1334 | tpr=0.6880 | fpr=0.8767 | 8554.3 samples/s | 33.4 steps/s
[Step= 350] | Loss=6.56265 | acc=0.1327 | tpr=0.6900 | fpr=0.8774 | 8606.2 samples/s | 33.6 steps/s
[Step= 400] | Loss=6.55692 | acc=0.1325 | tpr=0.6915 | fpr=0.8777 | 8792.9 samples/s | 34.3 steps/s
[Step= 450] | Loss=6.55319 | acc=0.1324 | tpr=0.6947 | fpr=0.8778 | 8989.0 samples/s | 35.1 steps/s
[Step= 500] | Loss=6.55514 | acc=0.1323 | tpr=0.6978 | fpr=0.8779 | 8287.1 samples/s | 32.4 steps/s
[Step= 550] | Loss=6.55639 | acc=0.1326 | tpr=0.6968 | fpr=0.8777 | 15651.9 samples/s | 61.1 steps/s
Avg test loss: 6.55752, Avg test acc: 0.13244, Avg tpr: 0.69612, Avg fpr: 0.87780, total FA: 121881

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.40857 | acc=0.1352 | tpr=0.7124 | fpr=0.8751 | 4325.3 samples/s | 16.9 steps/s
[Step= 100] | Loss=6.39836 | acc=0.1375 | tpr=0.7313 | fpr=0.8736 | 8919.2 samples/s | 34.8 steps/s
[Step= 150] | Loss=6.39891 | acc=0.1366 | tpr=0.7118 | fpr=0.8740 | 8388.6 samples/s | 32.8 steps/s
[Step= 200] | Loss=6.38424 | acc=0.1375 | tpr=0.7093 | fpr=0.8729 | 8735.5 samples/s | 34.1 steps/s
[Step= 250] | Loss=6.38315 | acc=0.1374 | tpr=0.7013 | fpr=0.8729 | 8560.4 samples/s | 33.4 steps/s
[Step= 300] | Loss=6.37910 | acc=0.1376 | tpr=0.7047 | fpr=0.8727 | 8909.8 samples/s | 34.8 steps/s
[Step= 350] | Loss=6.37353 | acc=0.1370 | tpr=0.7063 | fpr=0.8733 | 8443.1 samples/s | 33.0 steps/s
[Step= 400] | Loss=6.36540 | acc=0.1370 | tpr=0.7117 | fpr=0.8734 | 8692.7 samples/s | 34.0 steps/s
[Step= 450] | Loss=6.36129 | acc=0.1371 | tpr=0.7137 | fpr=0.8734 | 9251.9 samples/s | 36.1 steps/s
[Step= 500] | Loss=6.36414 | acc=0.1369 | tpr=0.7159 | fpr=0.8736 | 8217.1 samples/s | 32.1 steps/s
[Step= 550] | Loss=6.36332 | acc=0.1368 | tpr=0.7135 | fpr=0.8736 | 15342.5 samples/s | 59.9 steps/s
Avg test loss: 6.36439, Avg test acc: 0.13670, Avg tpr: 0.71315, Avg fpr: 0.87378, total FA: 121323

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.16758 | acc=0.9805 | tpr=0.9513 | fpr=0.0189 | 4331.7 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.17988 | acc=0.9792 | tpr=0.9680 | fpr=0.0206 | 8581.4 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.18814 | acc=0.9780 | tpr=0.9640 | fpr=0.0217 | 8983.5 samples/s | 35.1 steps/s
[Step= 200] | Loss=0.18989 | acc=0.9785 | tpr=0.9639 | fpr=0.0213 | 8701.9 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.18649 | acc=0.9787 | tpr=0.9598 | fpr=0.0209 | 8227.7 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.18909 | acc=0.9785 | tpr=0.9571 | fpr=0.0211 | 9021.2 samples/s | 35.2 steps/s
[Step= 350] | Loss=0.19111 | acc=0.9783 | tpr=0.9599 | fpr=0.0214 | 8487.1 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.19332 | acc=0.9779 | tpr=0.9579 | fpr=0.0217 | 8730.6 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.19710 | acc=0.9777 | tpr=0.9562 | fpr=0.0219 | 8557.5 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.19616 | acc=0.9778 | tpr=0.9564 | fpr=0.0218 | 9249.9 samples/s | 36.1 steps/s
[Step= 550] | Loss=0.19447 | acc=0.9779 | tpr=0.9562 | fpr=0.0217 | 14344.1 samples/s | 56.0 steps/s
Avg test loss: 0.19396, Avg test acc: 0.97796, Avg tpr: 0.95602, Avg fpr: 0.02164, total FA: 3005

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16555 | acc=0.9802 | tpr=0.9425 | fpr=0.0191 | 4313.0 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.17464 | acc=0.9795 | tpr=0.9510 | fpr=0.0199 | 8765.5 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.18456 | acc=0.9785 | tpr=0.9496 | fpr=0.0209 | 8494.0 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.18442 | acc=0.9792 | tpr=0.9519 | fpr=0.0203 | 8860.3 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.18041 | acc=0.9796 | tpr=0.9520 | fpr=0.0199 | 8718.2 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.18207 | acc=0.9796 | tpr=0.9513 | fpr=0.0199 | 8880.5 samples/s | 34.7 steps/s
[Step= 350] | Loss=0.18352 | acc=0.9794 | tpr=0.9512 | fpr=0.0201 | 8602.4 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.18517 | acc=0.9792 | tpr=0.9486 | fpr=0.0202 | 8633.7 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.18928 | acc=0.9791 | tpr=0.9489 | fpr=0.0204 | 8804.9 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.18883 | acc=0.9791 | tpr=0.9498 | fpr=0.0204 | 8543.0 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.18755 | acc=0.9792 | tpr=0.9499 | fpr=0.0202 | 15834.4 samples/s | 61.9 steps/s
Avg test loss: 0.18710, Avg test acc: 0.97925, Avg tpr: 0.94968, Avg fpr: 0.02022, total FA: 2807

server round 31/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=24001 Epoch=92.0] | Loss=0.00000 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.319 | L2-Norm(final)=10.176 | 3881.3 samples/s | 60.6 steps/s
[Step=24050 Epoch=92.2] | Loss=0.00008 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.319 | L2-Norm(final)=10.177 | 4934.2 samples/s | 77.1 steps/s
[Step=24100 Epoch=92.3] | Loss=0.00017 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.319 | L2-Norm(final)=10.179 | 5343.3 samples/s | 83.5 steps/s
[Step=24150 Epoch=92.5] | Loss=0.00013 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=10.181 | 5447.1 samples/s | 85.1 steps/s
[Step=24200 Epoch=92.7] | Loss=0.00011 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=10.182 | 5452.3 samples/s | 85.2 steps/s
[Step=24250 Epoch=92.9] | Loss=0.00011 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=10.184 | 6877.7 samples/s | 107.5 steps/s
[Step=24300 Epoch=93.1] | Loss=0.00010 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=10.185 | 1987.5 samples/s | 31.1 steps/s
[Step=24350 Epoch=93.3] | Loss=0.00011 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=10.187 | 5363.1 samples/s | 83.8 steps/s
[Step=24400 Epoch=93.5] | Loss=0.00012 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=10.189 | 5211.1 samples/s | 81.4 steps/s
[Step=24450 Epoch=93.7] | Loss=0.00011 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=10.190 | 5331.0 samples/s | 83.3 steps/s
[Step=24500 Epoch=93.9] | Loss=0.00010 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=10.192 | 6038.8 samples/s | 94.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=24501 Epoch=93.9] | Loss=0.00005 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=10.207 | 3793.0 samples/s | 59.3 steps/s
[Step=24550 Epoch=94.1] | Loss=0.00010 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.316 | L2-Norm(final)=10.209 | 4566.2 samples/s | 71.3 steps/s
[Step=24600 Epoch=94.3] | Loss=0.00006 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.314 | L2-Norm(final)=10.210 | 4741.4 samples/s | 74.1 steps/s
[Step=24650 Epoch=94.5] | Loss=0.00005 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=10.211 | 4699.4 samples/s | 73.4 steps/s
[Step=24700 Epoch=94.6] | Loss=0.00004 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.308 | L2-Norm(final)=10.212 | 4825.5 samples/s | 75.4 steps/s
[Step=24750 Epoch=94.8] | Loss=0.00003 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.305 | L2-Norm(final)=10.212 | 5705.6 samples/s | 89.1 steps/s
[Step=24800 Epoch=95.0] | Loss=0.00003 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.302 | L2-Norm(final)=10.213 | 1863.1 samples/s | 29.1 steps/s
[Step=24850 Epoch=95.2] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.298 | L2-Norm(final)=10.213 | 4673.9 samples/s | 73.0 steps/s
[Step=24900 Epoch=95.4] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.295 | L2-Norm(final)=10.214 | 4671.9 samples/s | 73.0 steps/s
[Step=24950 Epoch=95.6] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.291 | L2-Norm(final)=10.214 | 4724.2 samples/s | 73.8 steps/s
[Step=25000 Epoch=95.8] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.288 | L2-Norm(final)=10.215 | 5203.5 samples/s | 81.3 steps/s
[Step=25050 Epoch=96.0] | Loss=0.00002 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=10.215 | 1928.2 samples/s | 30.1 steps/s
[Step=25100 Epoch=96.2] | Loss=0.00002 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.281 | L2-Norm(final)=10.215 | 4800.9 samples/s | 75.0 steps/s
[Step=25150 Epoch=96.4] | Loss=0.00002 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.277 | L2-Norm(final)=10.216 | 4611.3 samples/s | 72.1 steps/s
[Step=25200 Epoch=96.6] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.273 | L2-Norm(final)=10.216 | 4716.9 samples/s | 73.7 steps/s
[Step=25250 Epoch=96.7] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.269 | L2-Norm(final)=10.216 | 4746.2 samples/s | 74.2 steps/s
[Step=25300 Epoch=96.9] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.265 | L2-Norm(final)=10.217 | 2013.1 samples/s | 31.5 steps/s
[Step=25350 Epoch=97.1] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.262 | L2-Norm(final)=10.217 | 4729.5 samples/s | 73.9 steps/s
[Step=25400 Epoch=97.3] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.258 | L2-Norm(final)=10.217 | 4707.2 samples/s | 73.5 steps/s
[Step=25450 Epoch=97.5] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.254 | L2-Norm(final)=10.218 | 4740.8 samples/s | 74.1 steps/s
[Step=25500 Epoch=97.7] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.250 | L2-Norm(final)=10.218 | 4700.3 samples/s | 73.4 steps/s
[Step=25550 Epoch=97.9] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.246 | L2-Norm(final)=10.218 | 2026.3 samples/s | 31.7 steps/s
[Step=25600 Epoch=98.1] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=10.219 | 4726.7 samples/s | 73.9 steps/s
[Step=25650 Epoch=98.3] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.237 | L2-Norm(final)=10.219 | 4719.2 samples/s | 73.7 steps/s
[Step=25700 Epoch=98.5] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.233 | L2-Norm(final)=10.219 | 4665.7 samples/s | 72.9 steps/s
[Step=25750 Epoch=98.7] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.229 | L2-Norm(final)=10.219 | 4724.5 samples/s | 73.8 steps/s
[Step=25800 Epoch=98.9] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.224 | L2-Norm(final)=10.220 | 6415.6 samples/s | 100.2 steps/s
[Step=25850 Epoch=99.0] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.220 | L2-Norm(final)=10.220 | 1823.2 samples/s | 28.5 steps/s
[Step=25900 Epoch=99.2] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.216 | L2-Norm(final)=10.220 | 4805.2 samples/s | 75.1 steps/s
[Step=25950 Epoch=99.4] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.211 | L2-Norm(final)=10.221 | 4607.5 samples/s | 72.0 steps/s
[Step=26000 Epoch=99.6] | Loss=0.00001 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.206 | L2-Norm(final)=10.221 | 4754.2 samples/s | 74.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step26000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=30001 Epoch=115.5] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.319 | L2-Norm(final)=11.543 | 3834.9 samples/s | 59.9 steps/s
[Step=30050 Epoch=115.7] | Loss=0.00011 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=11.545 | 5088.7 samples/s | 79.5 steps/s
[Step=30100 Epoch=115.9] | Loss=0.00029 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=11.548 | 5317.0 samples/s | 83.1 steps/s
[Step=30150 Epoch=116.1] | Loss=0.00090 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=11.551 | 5333.4 samples/s | 83.3 steps/s
[Step=30200 Epoch=116.3] | Loss=0.00071 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=11.555 | 5343.5 samples/s | 83.5 steps/s
[Step=30250 Epoch=116.4] | Loss=0.00066 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=11.559 | 7173.3 samples/s | 112.1 steps/s
[Step=30300 Epoch=116.6] | Loss=0.00057 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=11.561 | 1925.4 samples/s | 30.1 steps/s
[Step=30350 Epoch=116.8] | Loss=0.00077 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=11.564 | 5383.9 samples/s | 84.1 steps/s
[Step=30400 Epoch=117.0] | Loss=0.00072 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=11.567 | 5325.8 samples/s | 83.2 steps/s
[Step=30450 Epoch=117.2] | Loss=0.00069 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=11.570 | 5444.2 samples/s | 85.1 steps/s
[Step=30500 Epoch=117.4] | Loss=0.00063 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=11.573 | 6074.0 samples/s | 94.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=117.4] | Loss=0.00000 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=11.601 | 3992.8 samples/s | 62.4 steps/s
[Step=30550 Epoch=117.6] | Loss=0.00027 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.316 | L2-Norm(final)=11.604 | 4251.3 samples/s | 66.4 steps/s
[Step=30600 Epoch=117.8] | Loss=0.00015 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.315 | L2-Norm(final)=11.605 | 4623.3 samples/s | 72.2 steps/s
[Step=30650 Epoch=118.0] | Loss=0.00027 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.315 | L2-Norm(final)=11.606 | 4639.7 samples/s | 72.5 steps/s
[Step=30700 Epoch=118.2] | Loss=0.00020 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.316 | L2-Norm(final)=11.606 | 4313.9 samples/s | 67.4 steps/s
[Step=30750 Epoch=118.4] | Loss=0.00017 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.314 | L2-Norm(final)=11.606 | 5380.9 samples/s | 84.1 steps/s
[Step=30800 Epoch=118.6] | Loss=0.00014 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.312 | L2-Norm(final)=11.606 | 1816.8 samples/s | 28.4 steps/s
[Step=30850 Epoch=118.8] | Loss=0.00012 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=11.607 | 3845.9 samples/s | 60.1 steps/s
[Step=30900 Epoch=118.9] | Loss=0.00011 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.307 | L2-Norm(final)=11.607 | 3998.1 samples/s | 62.5 steps/s
[Step=30950 Epoch=119.1] | Loss=0.00009 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.304 | L2-Norm(final)=11.607 | 4023.9 samples/s | 62.9 steps/s
[Step=31000 Epoch=119.3] | Loss=0.00009 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.301 | L2-Norm(final)=11.607 | 5242.6 samples/s | 81.9 steps/s
[Step=31050 Epoch=119.5] | Loss=0.00008 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.298 | L2-Norm(final)=11.607 | 1933.6 samples/s | 30.2 steps/s
[Step=31100 Epoch=119.7] | Loss=0.00007 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.294 | L2-Norm(final)=11.607 | 4708.8 samples/s | 73.6 steps/s
[Step=31150 Epoch=119.9] | Loss=0.00007 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.291 | L2-Norm(final)=11.608 | 4742.8 samples/s | 74.1 steps/s
[Step=31200 Epoch=120.1] | Loss=0.00006 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.287 | L2-Norm(final)=11.608 | 4731.8 samples/s | 73.9 steps/s
[Step=31250 Epoch=120.3] | Loss=0.00006 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=11.608 | 4740.3 samples/s | 74.1 steps/s
[Step=31300 Epoch=120.5] | Loss=0.00005 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.280 | L2-Norm(final)=11.608 | 2004.8 samples/s | 31.3 steps/s
[Step=31350 Epoch=120.7] | Loss=0.00005 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.277 | L2-Norm(final)=11.608 | 4778.9 samples/s | 74.7 steps/s
[Step=31400 Epoch=120.9] | Loss=0.00005 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.273 | L2-Norm(final)=11.608 | 4723.5 samples/s | 73.8 steps/s
[Step=31450 Epoch=121.1] | Loss=0.00005 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.269 | L2-Norm(final)=11.608 | 4710.8 samples/s | 73.6 steps/s
[Step=31500 Epoch=121.3] | Loss=0.00004 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.265 | L2-Norm(final)=11.608 | 4688.5 samples/s | 73.3 steps/s
[Step=31550 Epoch=121.4] | Loss=0.00004 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.261 | L2-Norm(final)=11.608 | 2019.1 samples/s | 31.5 steps/s
[Step=31600 Epoch=121.6] | Loss=0.00004 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.257 | L2-Norm(final)=11.608 | 4750.5 samples/s | 74.2 steps/s
[Step=31650 Epoch=121.8] | Loss=0.00004 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.253 | L2-Norm(final)=11.609 | 4738.6 samples/s | 74.0 steps/s
[Step=31700 Epoch=122.0] | Loss=0.00004 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.249 | L2-Norm(final)=11.609 | 4679.2 samples/s | 73.1 steps/s
[Step=31750 Epoch=122.2] | Loss=0.00004 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.245 | L2-Norm(final)=11.609 | 4713.3 samples/s | 73.6 steps/s
[Step=31800 Epoch=122.4] | Loss=0.00003 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=11.609 | 6914.8 samples/s | 108.0 steps/s
[Step=31850 Epoch=122.6] | Loss=0.00003 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.236 | L2-Norm(final)=11.609 | 1785.8 samples/s | 27.9 steps/s
[Step=31900 Epoch=122.8] | Loss=0.00003 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.232 | L2-Norm(final)=11.609 | 4646.1 samples/s | 72.6 steps/s
[Step=31950 Epoch=123.0] | Loss=0.00003 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.228 | L2-Norm(final)=11.609 | 4711.2 samples/s | 73.6 steps/s
[Step=32000 Epoch=123.2] | Loss=0.00003 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.223 | L2-Norm(final)=11.609 | 4697.6 samples/s | 73.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08322 | acc=0.9702 | tpr=0.9768 | fpr=0.0441 | 4352.1 samples/s | 17.0 steps/s
Avg test loss: 0.08589, Avg test acc: 0.96831, Avg tpr: 0.97488, Avg fpr: 0.04615, total FA: 360

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07825 | acc=0.9708 | tpr=0.9804 | fpr=0.0500 | 4316.7 samples/s | 16.9 steps/s
Avg test loss: 0.08228, Avg test acc: 0.96951, Avg tpr: 0.97896, Avg fpr: 0.05128, total FA: 400

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.96469 | acc=0.2815 | tpr=0.0196 | fpr=0.1499 | 4378.1 samples/s | 17.1 steps/s
Avg test loss: 6.96610, Avg test acc: 0.27895, Avg tpr: 0.02028, Avg fpr: 0.15216, total FA: 1187

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.38161 | acc=0.2913 | tpr=0.0191 | fpr=0.1174 | 4358.3 samples/s | 17.0 steps/s
Avg test loss: 7.38978, Avg test acc: 0.28877, Avg tpr: 0.01964, Avg fpr: 0.11934, total FA: 931

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.60114 | acc=0.1304 | tpr=0.6991 | fpr=0.8798 | 4350.3 samples/s | 17.0 steps/s
[Step= 100] | Loss=6.59213 | acc=0.1333 | tpr=0.7249 | fpr=0.8777 | 8652.4 samples/s | 33.8 steps/s
[Step= 150] | Loss=6.59314 | acc=0.1333 | tpr=0.7061 | fpr=0.8772 | 8719.8 samples/s | 34.1 steps/s
[Step= 200] | Loss=6.57944 | acc=0.1333 | tpr=0.6984 | fpr=0.8770 | 8552.0 samples/s | 33.4 steps/s
[Step= 250] | Loss=6.57607 | acc=0.1330 | tpr=0.6856 | fpr=0.8770 | 8608.0 samples/s | 33.6 steps/s
[Step= 300] | Loss=6.56821 | acc=0.1334 | tpr=0.6880 | fpr=0.8767 | 8944.4 samples/s | 34.9 steps/s
[Step= 350] | Loss=6.56265 | acc=0.1327 | tpr=0.6900 | fpr=0.8774 | 8706.3 samples/s | 34.0 steps/s
[Step= 400] | Loss=6.55692 | acc=0.1325 | tpr=0.6915 | fpr=0.8777 | 8562.5 samples/s | 33.4 steps/s
[Step= 450] | Loss=6.55319 | acc=0.1324 | tpr=0.6947 | fpr=0.8778 | 8615.7 samples/s | 33.7 steps/s
[Step= 500] | Loss=6.55514 | acc=0.1323 | tpr=0.6978 | fpr=0.8779 | 8659.3 samples/s | 33.8 steps/s
[Step= 550] | Loss=6.55639 | acc=0.1326 | tpr=0.6968 | fpr=0.8777 | 15212.1 samples/s | 59.4 steps/s
Avg test loss: 6.55752, Avg test acc: 0.13244, Avg tpr: 0.69612, Avg fpr: 0.87780, total FA: 121881

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.40857 | acc=0.1352 | tpr=0.7124 | fpr=0.8751 | 4380.6 samples/s | 17.1 steps/s
[Step= 100] | Loss=6.39836 | acc=0.1375 | tpr=0.7313 | fpr=0.8736 | 8523.9 samples/s | 33.3 steps/s
[Step= 150] | Loss=6.39891 | acc=0.1366 | tpr=0.7118 | fpr=0.8740 | 8699.0 samples/s | 34.0 steps/s
[Step= 200] | Loss=6.38424 | acc=0.1375 | tpr=0.7093 | fpr=0.8729 | 8815.9 samples/s | 34.4 steps/s
[Step= 250] | Loss=6.38315 | acc=0.1374 | tpr=0.7013 | fpr=0.8729 | 8674.6 samples/s | 33.9 steps/s
[Step= 300] | Loss=6.37910 | acc=0.1376 | tpr=0.7047 | fpr=0.8727 | 8795.1 samples/s | 34.4 steps/s
[Step= 350] | Loss=6.37353 | acc=0.1370 | tpr=0.7063 | fpr=0.8733 | 8692.5 samples/s | 34.0 steps/s
[Step= 400] | Loss=6.36540 | acc=0.1370 | tpr=0.7117 | fpr=0.8734 | 8526.3 samples/s | 33.3 steps/s
[Step= 450] | Loss=6.36129 | acc=0.1371 | tpr=0.7137 | fpr=0.8734 | 8471.2 samples/s | 33.1 steps/s
[Step= 500] | Loss=6.36414 | acc=0.1369 | tpr=0.7159 | fpr=0.8736 | 8752.6 samples/s | 34.2 steps/s
[Step= 550] | Loss=6.36332 | acc=0.1368 | tpr=0.7135 | fpr=0.8736 | 15525.7 samples/s | 60.6 steps/s
Avg test loss: 6.36439, Avg test acc: 0.13670, Avg tpr: 0.71315, Avg fpr: 0.87378, total FA: 121323

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.15566 | acc=0.9804 | tpr=0.9513 | fpr=0.0191 | 4432.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.16616 | acc=0.9789 | tpr=0.9616 | fpr=0.0208 | 8643.0 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.17346 | acc=0.9783 | tpr=0.9625 | fpr=0.0214 | 8467.7 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.17446 | acc=0.9787 | tpr=0.9628 | fpr=0.0211 | 8441.2 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.17153 | acc=0.9790 | tpr=0.9642 | fpr=0.0207 | 8847.7 samples/s | 34.6 steps/s
[Step= 300] | Loss=0.17336 | acc=0.9790 | tpr=0.9636 | fpr=0.0207 | 8628.0 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.17486 | acc=0.9789 | tpr=0.9656 | fpr=0.0209 | 8948.8 samples/s | 35.0 steps/s
[Step= 400] | Loss=0.17676 | acc=0.9786 | tpr=0.9628 | fpr=0.0211 | 8385.6 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.18050 | acc=0.9784 | tpr=0.9611 | fpr=0.0213 | 8754.5 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.17982 | acc=0.9784 | tpr=0.9617 | fpr=0.0213 | 8524.6 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.17850 | acc=0.9785 | tpr=0.9614 | fpr=0.0212 | 16279.1 samples/s | 63.6 steps/s
Avg test loss: 0.17804, Avg test acc: 0.97850, Avg tpr: 0.96157, Avg fpr: 0.02120, total FA: 2943

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14984 | acc=0.9818 | tpr=0.9469 | fpr=0.0176 | 4382.1 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.16075 | acc=0.9803 | tpr=0.9531 | fpr=0.0192 | 8387.9 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.16733 | acc=0.9796 | tpr=0.9539 | fpr=0.0199 | 8620.6 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.16770 | acc=0.9799 | tpr=0.9563 | fpr=0.0197 | 8776.1 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.16487 | acc=0.9802 | tpr=0.9563 | fpr=0.0193 | 9249.7 samples/s | 36.1 steps/s
[Step= 300] | Loss=0.16644 | acc=0.9802 | tpr=0.9571 | fpr=0.0194 | 8155.8 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.16745 | acc=0.9801 | tpr=0.9587 | fpr=0.0196 | 9130.4 samples/s | 35.7 steps/s
[Step= 400] | Loss=0.16910 | acc=0.9798 | tpr=0.9551 | fpr=0.0198 | 8539.3 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.17321 | acc=0.9796 | tpr=0.9537 | fpr=0.0199 | 8619.5 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.17278 | acc=0.9796 | tpr=0.9551 | fpr=0.0199 | 8365.3 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.17142 | acc=0.9797 | tpr=0.9546 | fpr=0.0199 | 15729.0 samples/s | 61.4 steps/s
Avg test loss: 0.17099, Avg test acc: 0.97970, Avg tpr: 0.95444, Avg fpr: 0.01984, total FA: 2755

server round 32/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=28001 Epoch=54.7] | Loss=0.00065 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=8.553 | 4012.0 samples/s | 62.7 steps/s
[Step=28050 Epoch=54.8] | Loss=0.00989 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=8.555 | 5281.7 samples/s | 82.5 steps/s
[Step=28100 Epoch=54.9] | Loss=0.00947 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=8.559 | 5560.8 samples/s | 86.9 steps/s
[Step=28150 Epoch=55.0] | Loss=0.00940 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=8.563 | 5641.6 samples/s | 88.2 steps/s
[Step=28200 Epoch=55.1] | Loss=0.00922 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=8.566 | 5705.7 samples/s | 89.2 steps/s
[Step=28250 Epoch=55.2] | Loss=0.00898 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=8.570 | 5608.5 samples/s | 87.6 steps/s
[Step=28300 Epoch=55.3] | Loss=0.00981 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=8.573 | 5663.4 samples/s | 88.5 steps/s
[Step=28350 Epoch=55.4] | Loss=0.00946 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=8.577 | 5705.1 samples/s | 89.1 steps/s
[Step=28400 Epoch=55.5] | Loss=0.00936 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=8.580 | 5631.4 samples/s | 88.0 steps/s
[Step=28450 Epoch=55.6] | Loss=0.00934 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=8.584 | 5703.8 samples/s | 89.1 steps/s
[Step=28500 Epoch=55.7] | Loss=0.00934 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.243 | L2-Norm(final)=8.587 | 7376.6 samples/s | 115.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=28501 Epoch=55.7] | Loss=0.00142 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=8.623 | 4056.4 samples/s | 63.4 steps/s
[Step=28550 Epoch=55.8] | Loss=0.00858 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.247 | L2-Norm(final)=8.625 | 4578.8 samples/s | 71.5 steps/s
[Step=28600 Epoch=55.9] | Loss=0.01030 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.253 | L2-Norm(final)=8.627 | 4877.2 samples/s | 76.2 steps/s
[Step=28650 Epoch=56.0] | Loss=0.01001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.257 | L2-Norm(final)=8.628 | 4946.7 samples/s | 77.3 steps/s
[Step=28700 Epoch=56.1] | Loss=0.00996 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.261 | L2-Norm(final)=8.629 | 5026.0 samples/s | 78.5 steps/s
[Step=28750 Epoch=56.2] | Loss=0.01005 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.264 | L2-Norm(final)=8.630 | 4916.9 samples/s | 76.8 steps/s
[Step=28800 Epoch=56.3] | Loss=0.00974 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.267 | L2-Norm(final)=8.631 | 4895.6 samples/s | 76.5 steps/s
[Step=28850 Epoch=56.4] | Loss=0.00960 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=8.632 | 4980.0 samples/s | 77.8 steps/s
[Step=28900 Epoch=56.5] | Loss=0.00953 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.272 | L2-Norm(final)=8.634 | 4994.1 samples/s | 78.0 steps/s
[Step=28950 Epoch=56.6] | Loss=0.00929 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=8.635 | 4873.3 samples/s | 76.1 steps/s
[Step=29000 Epoch=56.7] | Loss=0.00903 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.277 | L2-Norm(final)=8.636 | 6124.4 samples/s | 95.7 steps/s
[Step=29050 Epoch=56.8] | Loss=0.00870 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.278 | L2-Norm(final)=8.637 | 1925.5 samples/s | 30.1 steps/s
[Step=29100 Epoch=56.9] | Loss=0.00843 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.280 | L2-Norm(final)=8.639 | 4881.3 samples/s | 76.3 steps/s
[Step=29150 Epoch=57.0] | Loss=0.00827 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.282 | L2-Norm(final)=8.640 | 4907.1 samples/s | 76.7 steps/s
[Step=29200 Epoch=57.1] | Loss=0.00820 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=8.642 | 4954.4 samples/s | 77.4 steps/s
[Step=29250 Epoch=57.2] | Loss=0.00797 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.285 | L2-Norm(final)=8.643 | 4997.0 samples/s | 78.1 steps/s
[Step=29300 Epoch=57.3] | Loss=0.00783 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.287 | L2-Norm(final)=8.645 | 4963.7 samples/s | 77.6 steps/s
[Step=29350 Epoch=57.4] | Loss=0.00774 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.288 | L2-Norm(final)=8.646 | 4951.8 samples/s | 77.4 steps/s
[Step=29400 Epoch=57.5] | Loss=0.00768 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=8.648 | 4957.9 samples/s | 77.5 steps/s
[Step=29450 Epoch=57.6] | Loss=0.00770 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.292 | L2-Norm(final)=8.649 | 4930.2 samples/s | 77.0 steps/s
[Step=29500 Epoch=57.7] | Loss=0.00772 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.293 | L2-Norm(final)=8.650 | 5348.7 samples/s | 83.6 steps/s
[Step=29550 Epoch=57.8] | Loss=0.00764 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.295 | L2-Norm(final)=8.652 | 1986.5 samples/s | 31.0 steps/s
[Step=29600 Epoch=57.9] | Loss=0.00754 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.296 | L2-Norm(final)=8.653 | 4930.3 samples/s | 77.0 steps/s
[Step=29650 Epoch=58.0] | Loss=0.00734 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.298 | L2-Norm(final)=8.654 | 4922.0 samples/s | 76.9 steps/s
[Step=29700 Epoch=58.1] | Loss=0.00731 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.299 | L2-Norm(final)=8.656 | 4925.1 samples/s | 77.0 steps/s
[Step=29750 Epoch=58.2] | Loss=0.00725 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.300 | L2-Norm(final)=8.657 | 4961.1 samples/s | 77.5 steps/s
[Step=29800 Epoch=58.3] | Loss=0.00720 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.302 | L2-Norm(final)=8.658 | 4961.0 samples/s | 77.5 steps/s
[Step=29850 Epoch=58.4] | Loss=0.00710 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.303 | L2-Norm(final)=8.660 | 4971.4 samples/s | 77.7 steps/s
[Step=29900 Epoch=58.5] | Loss=0.00705 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.304 | L2-Norm(final)=8.661 | 4972.7 samples/s | 77.7 steps/s
[Step=29950 Epoch=58.6] | Loss=0.00704 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.306 | L2-Norm(final)=8.662 | 4946.2 samples/s | 77.3 steps/s
[Step=30000 Epoch=58.6] | Loss=0.00703 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.307 | L2-Norm(final)=8.663 | 4961.6 samples/s | 77.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step30000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=26001 Epoch=99.6] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=10.230 | 3651.3 samples/s | 57.1 steps/s
[Step=26050 Epoch=99.8] | Loss=0.00008 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=10.234 | 5367.2 samples/s | 83.9 steps/s
[Step=26100 Epoch=100.0] | Loss=0.00005 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=10.238 | 5412.0 samples/s | 84.6 steps/s
[Step=26150 Epoch=100.2] | Loss=0.00004 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=10.240 | 5322.5 samples/s | 83.2 steps/s
[Step=26200 Epoch=100.4] | Loss=0.00004 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=10.243 | 5344.4 samples/s | 83.5 steps/s
[Step=26250 Epoch=100.6] | Loss=0.00005 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=10.246 | 7026.7 samples/s | 109.8 steps/s
[Step=26300 Epoch=100.8] | Loss=0.00006 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=10.249 | 1935.9 samples/s | 30.2 steps/s
[Step=26350 Epoch=101.0] | Loss=0.00005 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=10.252 | 5286.4 samples/s | 82.6 steps/s
[Step=26400 Epoch=101.2] | Loss=0.00005 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=10.255 | 5450.6 samples/s | 85.2 steps/s
[Step=26450 Epoch=101.3] | Loss=0.00006 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=10.259 | 5458.4 samples/s | 85.3 steps/s
[Step=26500 Epoch=101.5] | Loss=0.00005 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=10.262 | 5847.7 samples/s | 91.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=26501 Epoch=101.5] | Loss=0.00006 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=10.292 | 3690.2 samples/s | 57.7 steps/s
[Step=26550 Epoch=101.7] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.234 | L2-Norm(final)=10.293 | 4713.0 samples/s | 73.6 steps/s
[Step=26600 Epoch=101.9] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.227 | L2-Norm(final)=10.295 | 4700.5 samples/s | 73.4 steps/s
[Step=26650 Epoch=102.1] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.219 | L2-Norm(final)=10.296 | 4667.1 samples/s | 72.9 steps/s
[Step=26700 Epoch=102.3] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.212 | L2-Norm(final)=10.297 | 4749.7 samples/s | 74.2 steps/s
[Step=26750 Epoch=102.5] | Loss=0.00001 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.204 | L2-Norm(final)=10.298 | 5906.4 samples/s | 92.3 steps/s
[Step=26800 Epoch=102.7] | Loss=0.00001 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.196 | L2-Norm(final)=10.300 | 1865.3 samples/s | 29.1 steps/s
[Step=26850 Epoch=102.9] | Loss=0.00001 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.188 | L2-Norm(final)=10.300 | 4682.1 samples/s | 73.2 steps/s
[Step=26900 Epoch=103.1] | Loss=0.00001 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.180 | L2-Norm(final)=10.301 | 4763.8 samples/s | 74.4 steps/s
[Step=26950 Epoch=103.3] | Loss=0.00001 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.171 | L2-Norm(final)=10.302 | 4771.1 samples/s | 74.5 steps/s
[Step=27000 Epoch=103.5] | Loss=0.00001 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.163 | L2-Norm(final)=10.302 | 5122.1 samples/s | 80.0 steps/s
[Step=27050 Epoch=103.6] | Loss=0.00001 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.154 | L2-Norm(final)=10.303 | 1913.3 samples/s | 29.9 steps/s
[Step=27100 Epoch=103.8] | Loss=0.00001 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.146 | L2-Norm(final)=10.304 | 4773.6 samples/s | 74.6 steps/s
[Step=27150 Epoch=104.0] | Loss=0.00001 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.137 | L2-Norm(final)=10.304 | 4682.1 samples/s | 73.2 steps/s
[Step=27200 Epoch=104.2] | Loss=0.00001 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.128 | L2-Norm(final)=10.305 | 4739.8 samples/s | 74.1 steps/s
[Step=27250 Epoch=104.4] | Loss=0.00001 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.119 | L2-Norm(final)=10.305 | 4718.3 samples/s | 73.7 steps/s
[Step=27300 Epoch=104.6] | Loss=0.00001 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.110 | L2-Norm(final)=10.306 | 1985.6 samples/s | 31.0 steps/s
[Step=27350 Epoch=104.8] | Loss=0.00000 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=10.306 | 4818.0 samples/s | 75.3 steps/s
[Step=27400 Epoch=105.0] | Loss=0.00000 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.092 | L2-Norm(final)=10.306 | 4758.2 samples/s | 74.3 steps/s
[Step=27450 Epoch=105.2] | Loss=0.00000 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.082 | L2-Norm(final)=10.307 | 4709.5 samples/s | 73.6 steps/s
[Step=27500 Epoch=105.4] | Loss=0.00000 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.073 | L2-Norm(final)=10.307 | 4709.9 samples/s | 73.6 steps/s
[Step=27550 Epoch=105.6] | Loss=0.00000 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.063 | L2-Norm(final)=10.308 | 2012.1 samples/s | 31.4 steps/s
[Step=27600 Epoch=105.8] | Loss=0.00000 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.054 | L2-Norm(final)=10.308 | 4685.3 samples/s | 73.2 steps/s
[Step=27650 Epoch=105.9] | Loss=0.00000 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.044 | L2-Norm(final)=10.309 | 4700.5 samples/s | 73.4 steps/s
[Step=27700 Epoch=106.1] | Loss=0.00000 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.035 | L2-Norm(final)=10.309 | 4774.7 samples/s | 74.6 steps/s
[Step=27750 Epoch=106.3] | Loss=0.00000 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.025 | L2-Norm(final)=10.309 | 4715.6 samples/s | 73.7 steps/s
[Step=27800 Epoch=106.5] | Loss=0.00000 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.015 | L2-Norm(final)=10.310 | 6411.1 samples/s | 100.2 steps/s
[Step=27850 Epoch=106.7] | Loss=0.00000 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.005 | L2-Norm(final)=10.310 | 1825.5 samples/s | 28.5 steps/s
[Step=27900 Epoch=106.9] | Loss=0.00000 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=10.311 | 4666.0 samples/s | 72.9 steps/s
[Step=27950 Epoch=107.1] | Loss=0.00000 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.985 | L2-Norm(final)=10.311 | 4752.7 samples/s | 74.3 steps/s
[Step=28000 Epoch=107.3] | Loss=0.00000 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.974 | L2-Norm(final)=10.311 | 4664.4 samples/s | 72.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08322 | acc=0.9702 | tpr=0.9768 | fpr=0.0441 | 4323.3 samples/s | 16.9 steps/s
Avg test loss: 0.08589, Avg test acc: 0.96831, Avg tpr: 0.97488, Avg fpr: 0.04615, total FA: 360

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07761 | acc=0.9709 | tpr=0.9804 | fpr=0.0496 | 4399.9 samples/s | 17.2 steps/s
Avg test loss: 0.08118, Avg test acc: 0.96927, Avg tpr: 0.97937, Avg fpr: 0.05294, total FA: 413

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.70188 | acc=0.2820 | tpr=0.0195 | fpr=0.1479 | 4346.9 samples/s | 17.0 steps/s
Avg test loss: 6.70452, Avg test acc: 0.28023, Avg tpr: 0.02052, Avg fpr: 0.14857, total FA: 1159

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.38161 | acc=0.2913 | tpr=0.0191 | fpr=0.1174 | 4353.6 samples/s | 17.0 steps/s
Avg test loss: 7.38978, Avg test acc: 0.28877, Avg tpr: 0.01964, Avg fpr: 0.11934, total FA: 931

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.60114 | acc=0.1304 | tpr=0.6991 | fpr=0.8798 | 4362.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=6.59213 | acc=0.1333 | tpr=0.7249 | fpr=0.8777 | 8820.4 samples/s | 34.5 steps/s
[Step= 150] | Loss=6.59314 | acc=0.1333 | tpr=0.7061 | fpr=0.8772 | 8260.3 samples/s | 32.3 steps/s
[Step= 200] | Loss=6.57944 | acc=0.1333 | tpr=0.6984 | fpr=0.8770 | 8853.7 samples/s | 34.6 steps/s
[Step= 250] | Loss=6.57607 | acc=0.1330 | tpr=0.6856 | fpr=0.8770 | 8676.6 samples/s | 33.9 steps/s
[Step= 300] | Loss=6.56821 | acc=0.1334 | tpr=0.6880 | fpr=0.8767 | 8669.0 samples/s | 33.9 steps/s
[Step= 350] | Loss=6.56265 | acc=0.1327 | tpr=0.6900 | fpr=0.8774 | 9172.7 samples/s | 35.8 steps/s
[Step= 400] | Loss=6.55692 | acc=0.1325 | tpr=0.6915 | fpr=0.8777 | 8154.9 samples/s | 31.9 steps/s
[Step= 450] | Loss=6.55319 | acc=0.1324 | tpr=0.6947 | fpr=0.8778 | 8671.1 samples/s | 33.9 steps/s
[Step= 500] | Loss=6.55514 | acc=0.1323 | tpr=0.6978 | fpr=0.8779 | 8966.1 samples/s | 35.0 steps/s
[Step= 550] | Loss=6.55639 | acc=0.1326 | tpr=0.6968 | fpr=0.8777 | 15132.4 samples/s | 59.1 steps/s
Avg test loss: 6.55752, Avg test acc: 0.13244, Avg tpr: 0.69612, Avg fpr: 0.87780, total FA: 121881

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.16947 | acc=0.1365 | tpr=0.7080 | fpr=0.8738 | 4353.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=6.15314 | acc=0.1395 | tpr=0.7228 | fpr=0.8714 | 8792.1 samples/s | 34.3 steps/s
[Step= 150] | Loss=6.15201 | acc=0.1389 | tpr=0.7061 | fpr=0.8715 | 8593.6 samples/s | 33.6 steps/s
[Step= 200] | Loss=6.13861 | acc=0.1395 | tpr=0.6984 | fpr=0.8707 | 8883.5 samples/s | 34.7 steps/s
[Step= 250] | Loss=6.13658 | acc=0.1395 | tpr=0.6891 | fpr=0.8705 | 8576.1 samples/s | 33.5 steps/s
[Step= 300] | Loss=6.13277 | acc=0.1399 | tpr=0.6924 | fpr=0.8701 | 8700.2 samples/s | 34.0 steps/s
[Step= 350] | Loss=6.12629 | acc=0.1397 | tpr=0.6976 | fpr=0.8704 | 8584.5 samples/s | 33.5 steps/s
[Step= 400] | Loss=6.11886 | acc=0.1399 | tpr=0.6997 | fpr=0.8703 | 8626.1 samples/s | 33.7 steps/s
[Step= 450] | Loss=6.11535 | acc=0.1397 | tpr=0.7011 | fpr=0.8704 | 8685.1 samples/s | 33.9 steps/s
[Step= 500] | Loss=6.11809 | acc=0.1398 | tpr=0.7035 | fpr=0.8704 | 8783.0 samples/s | 34.3 steps/s
[Step= 550] | Loss=6.11718 | acc=0.1399 | tpr=0.7039 | fpr=0.8703 | 15688.7 samples/s | 61.3 steps/s
Avg test loss: 6.11830, Avg test acc: 0.13979, Avg tpr: 0.70365, Avg fpr: 0.87046, total FA: 120861

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14663 | acc=0.9807 | tpr=0.9558 | fpr=0.0188 | 4300.6 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.15668 | acc=0.9791 | tpr=0.9659 | fpr=0.0207 | 8920.4 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.16268 | acc=0.9784 | tpr=0.9654 | fpr=0.0214 | 8491.6 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.16311 | acc=0.9787 | tpr=0.9639 | fpr=0.0210 | 8960.8 samples/s | 35.0 steps/s
[Step= 250] | Loss=0.16077 | acc=0.9790 | tpr=0.9651 | fpr=0.0207 | 8486.2 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.16235 | acc=0.9790 | tpr=0.9658 | fpr=0.0208 | 8638.5 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.16331 | acc=0.9788 | tpr=0.9668 | fpr=0.0209 | 8582.7 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.16511 | acc=0.9785 | tpr=0.9639 | fpr=0.0212 | 9106.2 samples/s | 35.6 steps/s
[Step= 450] | Loss=0.16885 | acc=0.9784 | tpr=0.9615 | fpr=0.0213 | 8676.1 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.16813 | acc=0.9784 | tpr=0.9621 | fpr=0.0213 | 8529.8 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.16684 | acc=0.9785 | tpr=0.9618 | fpr=0.0212 | 15375.5 samples/s | 60.1 steps/s
Avg test loss: 0.16645, Avg test acc: 0.97851, Avg tpr: 0.96197, Avg fpr: 0.02119, total FA: 2942

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14984 | acc=0.9818 | tpr=0.9469 | fpr=0.0176 | 4390.4 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.16075 | acc=0.9803 | tpr=0.9531 | fpr=0.0192 | 8600.0 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.16733 | acc=0.9796 | tpr=0.9539 | fpr=0.0199 | 8682.3 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.16770 | acc=0.9799 | tpr=0.9563 | fpr=0.0197 | 8752.3 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.16487 | acc=0.9802 | tpr=0.9563 | fpr=0.0193 | 8422.6 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.16644 | acc=0.9802 | tpr=0.9571 | fpr=0.0194 | 8704.3 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.16745 | acc=0.9801 | tpr=0.9587 | fpr=0.0196 | 8617.0 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.16910 | acc=0.9798 | tpr=0.9551 | fpr=0.0198 | 8687.6 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.17321 | acc=0.9796 | tpr=0.9537 | fpr=0.0199 | 8619.9 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.17278 | acc=0.9796 | tpr=0.9551 | fpr=0.0199 | 8868.1 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.17142 | acc=0.9797 | tpr=0.9546 | fpr=0.0199 | 15108.3 samples/s | 59.0 steps/s
Avg test loss: 0.17099, Avg test acc: 0.97970, Avg tpr: 0.95444, Avg fpr: 0.01984, total FA: 2755

server round 33/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=28001 Epoch=107.3] | Loss=0.00006 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.106 | L2-Norm(final)=10.324 | 3900.9 samples/s | 61.0 steps/s
[Step=28050 Epoch=107.5] | Loss=0.00004 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=10.330 | 5043.2 samples/s | 78.8 steps/s
[Step=28100 Epoch=107.7] | Loss=0.00005 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=10.335 | 5313.5 samples/s | 83.0 steps/s
[Step=28150 Epoch=107.9] | Loss=0.00005 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=10.342 | 5518.9 samples/s | 86.2 steps/s
[Step=28200 Epoch=108.1] | Loss=0.00005 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=10.348 | 5257.6 samples/s | 82.1 steps/s
[Step=28250 Epoch=108.2] | Loss=0.00005 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=10.354 | 7012.3 samples/s | 109.6 steps/s
[Step=28300 Epoch=108.4] | Loss=0.00005 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=10.359 | 1900.4 samples/s | 29.7 steps/s
[Step=28350 Epoch=108.6] | Loss=0.00005 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=10.364 | 5293.7 samples/s | 82.7 steps/s
[Step=28400 Epoch=108.8] | Loss=0.00005 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=10.369 | 5456.9 samples/s | 85.3 steps/s
[Step=28450 Epoch=109.0] | Loss=0.00005 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=10.374 | 5281.3 samples/s | 82.5 steps/s
[Step=28500 Epoch=109.2] | Loss=0.00005 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=10.378 | 6086.9 samples/s | 95.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=28501 Epoch=109.2] | Loss=0.00011 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=10.421 | 3945.0 samples/s | 61.6 steps/s
[Step=28550 Epoch=109.4] | Loss=0.00003 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.090 | L2-Norm(final)=10.424 | 4339.2 samples/s | 67.8 steps/s
[Step=28600 Epoch=109.6] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.075 | L2-Norm(final)=10.426 | 4738.5 samples/s | 74.0 steps/s
[Step=28650 Epoch=109.8] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.057 | L2-Norm(final)=10.427 | 4652.3 samples/s | 72.7 steps/s
[Step=28700 Epoch=110.0] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.039 | L2-Norm(final)=10.428 | 4713.6 samples/s | 73.6 steps/s
[Step=28750 Epoch=110.2] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.021 | L2-Norm(final)=10.429 | 5978.3 samples/s | 93.4 steps/s
[Step=28800 Epoch=110.4] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.003 | L2-Norm(final)=10.429 | 1866.5 samples/s | 29.2 steps/s
[Step=28850 Epoch=110.5] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.984 | L2-Norm(final)=10.430 | 4712.8 samples/s | 73.6 steps/s
[Step=28900 Epoch=110.7] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.966 | L2-Norm(final)=10.431 | 4743.4 samples/s | 74.1 steps/s
[Step=28950 Epoch=110.9] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.947 | L2-Norm(final)=10.431 | 4742.4 samples/s | 74.1 steps/s
[Step=29000 Epoch=111.1] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.928 | L2-Norm(final)=10.432 | 5131.0 samples/s | 80.2 steps/s
[Step=29050 Epoch=111.3] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.910 | L2-Norm(final)=10.432 | 1946.2 samples/s | 30.4 steps/s
[Step=29100 Epoch=111.5] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=10.432 | 4674.8 samples/s | 73.0 steps/s
[Step=29150 Epoch=111.7] | Loss=0.00000 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.872 | L2-Norm(final)=10.433 | 4731.9 samples/s | 73.9 steps/s
[Step=29200 Epoch=111.9] | Loss=0.00000 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.853 | L2-Norm(final)=10.433 | 4750.7 samples/s | 74.2 steps/s
[Step=29250 Epoch=112.1] | Loss=0.00000 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.833 | L2-Norm(final)=10.434 | 4677.6 samples/s | 73.1 steps/s
[Step=29300 Epoch=112.3] | Loss=0.00000 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.814 | L2-Norm(final)=10.434 | 2025.2 samples/s | 31.6 steps/s
[Step=29350 Epoch=112.5] | Loss=0.00000 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=10.434 | 4719.9 samples/s | 73.7 steps/s
[Step=29400 Epoch=112.7] | Loss=0.00000 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.775 | L2-Norm(final)=10.435 | 4732.9 samples/s | 74.0 steps/s
[Step=29450 Epoch=112.8] | Loss=0.00000 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.756 | L2-Norm(final)=10.435 | 4660.6 samples/s | 72.8 steps/s
[Step=29500 Epoch=113.0] | Loss=0.00000 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.736 | L2-Norm(final)=10.436 | 4721.8 samples/s | 73.8 steps/s
[Step=29550 Epoch=113.2] | Loss=0.00000 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.717 | L2-Norm(final)=10.436 | 2020.9 samples/s | 31.6 steps/s
[Step=29600 Epoch=113.4] | Loss=0.00000 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.697 | L2-Norm(final)=10.436 | 4735.5 samples/s | 74.0 steps/s
[Step=29650 Epoch=113.6] | Loss=0.00000 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.677 | L2-Norm(final)=10.437 | 4650.9 samples/s | 72.7 steps/s
[Step=29700 Epoch=113.8] | Loss=0.00000 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.657 | L2-Norm(final)=10.437 | 4692.9 samples/s | 73.3 steps/s
[Step=29750 Epoch=114.0] | Loss=0.00000 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.637 | L2-Norm(final)=10.438 | 4726.8 samples/s | 73.9 steps/s
[Step=29800 Epoch=114.2] | Loss=0.00000 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.617 | L2-Norm(final)=10.438 | 6456.4 samples/s | 100.9 steps/s
[Step=29850 Epoch=114.4] | Loss=0.00000 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.597 | L2-Norm(final)=10.439 | 1812.2 samples/s | 28.3 steps/s
[Step=29900 Epoch=114.6] | Loss=0.00000 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=10.439 | 4704.5 samples/s | 73.5 steps/s
[Step=29950 Epoch=114.8] | Loss=0.00000 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.556 | L2-Norm(final)=10.439 | 4709.3 samples/s | 73.6 steps/s
[Step=30000 Epoch=114.9] | Loss=0.00000 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=10.440 | 4711.6 samples/s | 73.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step30000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=123.2] | Loss=0.00203 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.106 | L2-Norm(final)=11.613 | 3898.6 samples/s | 60.9 steps/s
[Step=32050 Epoch=123.4] | Loss=0.00010 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=11.619 | 5008.0 samples/s | 78.3 steps/s
[Step=32100 Epoch=123.6] | Loss=0.00028 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=11.627 | 5342.4 samples/s | 83.5 steps/s
[Step=32150 Epoch=123.8] | Loss=0.00024 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=11.635 | 5245.7 samples/s | 82.0 steps/s
[Step=32200 Epoch=124.0] | Loss=0.00022 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=11.642 | 5399.7 samples/s | 84.4 steps/s
[Step=32250 Epoch=124.1] | Loss=0.00019 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=11.647 | 7170.4 samples/s | 112.0 steps/s
[Step=32300 Epoch=124.3] | Loss=0.00019 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=11.651 | 1930.3 samples/s | 30.2 steps/s
[Step=32350 Epoch=124.5] | Loss=0.00018 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=11.655 | 5310.4 samples/s | 83.0 steps/s
[Step=32400 Epoch=124.7] | Loss=0.00021 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=11.659 | 5433.5 samples/s | 84.9 steps/s
[Step=32450 Epoch=124.9] | Loss=0.00020 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=11.663 | 5308.3 samples/s | 82.9 steps/s
[Step=32500 Epoch=125.1] | Loss=0.00020 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=11.668 | 6172.6 samples/s | 96.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=125.1] | Loss=0.00012 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=11.713 | 3709.0 samples/s | 58.0 steps/s
[Step=32550 Epoch=125.3] | Loss=0.00004 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=11.715 | 4689.7 samples/s | 73.3 steps/s
[Step=32600 Epoch=125.5] | Loss=0.00003 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.095 | L2-Norm(final)=11.716 | 4660.0 samples/s | 72.8 steps/s
[Step=32650 Epoch=125.7] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.089 | L2-Norm(final)=11.716 | 4718.3 samples/s | 73.7 steps/s
[Step=32700 Epoch=125.9] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=11.716 | 4707.5 samples/s | 73.6 steps/s
[Step=32750 Epoch=126.1] | Loss=0.00001 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.076 | L2-Norm(final)=11.717 | 6083.5 samples/s | 95.1 steps/s
[Step=32800 Epoch=126.3] | Loss=0.00001 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.068 | L2-Norm(final)=11.717 | 1849.5 samples/s | 28.9 steps/s
[Step=32850 Epoch=126.5] | Loss=0.00001 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=11.717 | 4694.2 samples/s | 73.3 steps/s
[Step=32900 Epoch=126.6] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.053 | L2-Norm(final)=11.717 | 4744.1 samples/s | 74.1 steps/s
[Step=32950 Epoch=126.8] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.046 | L2-Norm(final)=11.717 | 4717.7 samples/s | 73.7 steps/s
[Step=33000 Epoch=127.0] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.038 | L2-Norm(final)=11.717 | 5305.1 samples/s | 82.9 steps/s
[Step=33050 Epoch=127.2] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=11.718 | 1920.0 samples/s | 30.0 steps/s
[Step=33100 Epoch=127.4] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.023 | L2-Norm(final)=11.718 | 4718.6 samples/s | 73.7 steps/s
[Step=33150 Epoch=127.6] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.015 | L2-Norm(final)=11.718 | 4728.0 samples/s | 73.9 steps/s
[Step=33200 Epoch=127.8] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.007 | L2-Norm(final)=11.718 | 4771.1 samples/s | 74.5 steps/s
[Step=33250 Epoch=128.0] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=11.718 | 4722.5 samples/s | 73.8 steps/s
[Step=33300 Epoch=128.2] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.990 | L2-Norm(final)=11.718 | 1999.9 samples/s | 31.2 steps/s
[Step=33350 Epoch=128.4] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.982 | L2-Norm(final)=11.718 | 4809.2 samples/s | 75.1 steps/s
[Step=33400 Epoch=128.6] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.974 | L2-Norm(final)=11.718 | 4675.0 samples/s | 73.0 steps/s
[Step=33450 Epoch=128.8] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.965 | L2-Norm(final)=11.719 | 4731.0 samples/s | 73.9 steps/s
[Step=33500 Epoch=129.0] | Loss=0.00000 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.957 | L2-Norm(final)=11.719 | 4717.5 samples/s | 73.7 steps/s
[Step=33550 Epoch=129.1] | Loss=0.00000 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=11.719 | 2014.1 samples/s | 31.5 steps/s
[Step=33600 Epoch=129.3] | Loss=0.00000 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=11.719 | 4755.6 samples/s | 74.3 steps/s
[Step=33650 Epoch=129.5] | Loss=0.00000 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=11.719 | 4676.0 samples/s | 73.1 steps/s
[Step=33700 Epoch=129.7] | Loss=0.00000 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=11.719 | 4768.0 samples/s | 74.5 steps/s
[Step=33750 Epoch=129.9] | Loss=0.00000 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.913 | L2-Norm(final)=11.719 | 4631.6 samples/s | 72.4 steps/s
[Step=33800 Epoch=130.1] | Loss=0.00000 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=11.719 | 6914.3 samples/s | 108.0 steps/s
[Step=33850 Epoch=130.3] | Loss=0.00000 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.895 | L2-Norm(final)=11.720 | 1781.8 samples/s | 27.8 steps/s
[Step=33900 Epoch=130.5] | Loss=0.00000 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=11.720 | 4770.4 samples/s | 74.5 steps/s
[Step=33950 Epoch=130.7] | Loss=0.00000 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.877 | L2-Norm(final)=11.720 | 4701.6 samples/s | 73.5 steps/s
[Step=34000 Epoch=130.9] | Loss=0.00000 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.867 | L2-Norm(final)=11.720 | 4665.8 samples/s | 72.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step34000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08322 | acc=0.9702 | tpr=0.9768 | fpr=0.0441 | 4332.1 samples/s | 16.9 steps/s
Avg test loss: 0.08589, Avg test acc: 0.96831, Avg tpr: 0.97488, Avg fpr: 0.04615, total FA: 360

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07761 | acc=0.9709 | tpr=0.9804 | fpr=0.0496 | 4339.3 samples/s | 17.0 steps/s
Avg test loss: 0.08118, Avg test acc: 0.96927, Avg tpr: 0.97937, Avg fpr: 0.05294, total FA: 413

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.46246 | acc=0.2812 | tpr=0.0162 | fpr=0.1435 | 4323.5 samples/s | 16.9 steps/s
Avg test loss: 6.46670, Avg test acc: 0.27951, Avg tpr: 0.01754, Avg fpr: 0.14434, total FA: 1126

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.06537 | acc=0.2948 | tpr=0.0200 | fpr=0.1083 | 4403.5 samples/s | 17.2 steps/s
Avg test loss: 7.07091, Avg test acc: 0.29241, Avg tpr: 0.02092, Avg fpr: 0.11050, total FA: 862

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.60114 | acc=0.1304 | tpr=0.6991 | fpr=0.8798 | 4384.1 samples/s | 17.1 steps/s
[Step= 100] | Loss=6.59213 | acc=0.1333 | tpr=0.7249 | fpr=0.8777 | 8469.5 samples/s | 33.1 steps/s
[Step= 150] | Loss=6.59314 | acc=0.1333 | tpr=0.7061 | fpr=0.8772 | 9671.4 samples/s | 37.8 steps/s
[Step= 200] | Loss=6.57944 | acc=0.1333 | tpr=0.6984 | fpr=0.8770 | 7986.4 samples/s | 31.2 steps/s
[Step= 250] | Loss=6.57607 | acc=0.1330 | tpr=0.6856 | fpr=0.8770 | 8495.2 samples/s | 33.2 steps/s
[Step= 300] | Loss=6.56821 | acc=0.1334 | tpr=0.6880 | fpr=0.8767 | 8893.3 samples/s | 34.7 steps/s
[Step= 350] | Loss=6.56265 | acc=0.1327 | tpr=0.6900 | fpr=0.8774 | 8486.3 samples/s | 33.1 steps/s
[Step= 400] | Loss=6.55692 | acc=0.1325 | tpr=0.6915 | fpr=0.8777 | 9057.3 samples/s | 35.4 steps/s
[Step= 450] | Loss=6.55319 | acc=0.1324 | tpr=0.6947 | fpr=0.8778 | 8335.6 samples/s | 32.6 steps/s
[Step= 500] | Loss=6.55514 | acc=0.1323 | tpr=0.6978 | fpr=0.8779 | 8686.7 samples/s | 33.9 steps/s
[Step= 550] | Loss=6.55639 | acc=0.1326 | tpr=0.6968 | fpr=0.8777 | 15212.3 samples/s | 59.4 steps/s
Avg test loss: 6.55752, Avg test acc: 0.13244, Avg tpr: 0.69612, Avg fpr: 0.87780, total FA: 121881

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.16947 | acc=0.1365 | tpr=0.7080 | fpr=0.8738 | 4464.2 samples/s | 17.4 steps/s
[Step= 100] | Loss=6.15314 | acc=0.1395 | tpr=0.7228 | fpr=0.8714 | 8425.4 samples/s | 32.9 steps/s
[Step= 150] | Loss=6.15201 | acc=0.1389 | tpr=0.7061 | fpr=0.8715 | 8352.9 samples/s | 32.6 steps/s
[Step= 200] | Loss=6.13861 | acc=0.1395 | tpr=0.6984 | fpr=0.8707 | 9219.4 samples/s | 36.0 steps/s
[Step= 250] | Loss=6.13658 | acc=0.1395 | tpr=0.6891 | fpr=0.8705 | 8144.1 samples/s | 31.8 steps/s
[Step= 300] | Loss=6.13277 | acc=0.1399 | tpr=0.6924 | fpr=0.8701 | 8916.3 samples/s | 34.8 steps/s
[Step= 350] | Loss=6.12629 | acc=0.1397 | tpr=0.6976 | fpr=0.8704 | 8911.2 samples/s | 34.8 steps/s
[Step= 400] | Loss=6.11886 | acc=0.1399 | tpr=0.6997 | fpr=0.8703 | 8259.2 samples/s | 32.3 steps/s
[Step= 450] | Loss=6.11535 | acc=0.1397 | tpr=0.7011 | fpr=0.8704 | 8946.3 samples/s | 34.9 steps/s
[Step= 500] | Loss=6.11809 | acc=0.1398 | tpr=0.7035 | fpr=0.8704 | 8686.1 samples/s | 33.9 steps/s
[Step= 550] | Loss=6.11718 | acc=0.1399 | tpr=0.7039 | fpr=0.8703 | 15417.9 samples/s | 60.2 steps/s
Avg test loss: 6.11830, Avg test acc: 0.13979, Avg tpr: 0.70365, Avg fpr: 0.87046, total FA: 120861

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13414 | acc=0.9807 | tpr=0.9602 | fpr=0.0189 | 4455.2 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.14356 | acc=0.9792 | tpr=0.9659 | fpr=0.0205 | 8188.6 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.14880 | acc=0.9785 | tpr=0.9654 | fpr=0.0213 | 8650.8 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.14903 | acc=0.9791 | tpr=0.9650 | fpr=0.0207 | 8777.8 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.14704 | acc=0.9794 | tpr=0.9659 | fpr=0.0203 | 8896.2 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.14851 | acc=0.9793 | tpr=0.9665 | fpr=0.0204 | 8497.1 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.14926 | acc=0.9792 | tpr=0.9674 | fpr=0.0206 | 8565.4 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.15081 | acc=0.9789 | tpr=0.9639 | fpr=0.0208 | 8805.3 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.15435 | acc=0.9787 | tpr=0.9611 | fpr=0.0209 | 8581.4 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.15356 | acc=0.9787 | tpr=0.9617 | fpr=0.0210 | 8766.7 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.15230 | acc=0.9788 | tpr=0.9614 | fpr=0.0208 | 15334.8 samples/s | 59.9 steps/s
Avg test loss: 0.15194, Avg test acc: 0.97887, Avg tpr: 0.96157, Avg fpr: 0.02081, total FA: 2890

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15976 | acc=0.9805 | tpr=0.9558 | fpr=0.0191 | 4355.4 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.17124 | acc=0.9788 | tpr=0.9638 | fpr=0.0209 | 8707.6 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.17799 | acc=0.9781 | tpr=0.9611 | fpr=0.0216 | 8586.0 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.17839 | acc=0.9786 | tpr=0.9607 | fpr=0.0211 | 8770.4 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.17556 | acc=0.9789 | tpr=0.9607 | fpr=0.0207 | 8687.6 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.17747 | acc=0.9788 | tpr=0.9607 | fpr=0.0209 | 8575.5 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.17852 | acc=0.9788 | tpr=0.9618 | fpr=0.0209 | 8992.9 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.18020 | acc=0.9784 | tpr=0.9590 | fpr=0.0212 | 8304.4 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.18455 | acc=0.9783 | tpr=0.9567 | fpr=0.0213 | 8810.5 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.18379 | acc=0.9783 | tpr=0.9581 | fpr=0.0214 | 8547.1 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.18240 | acc=0.9784 | tpr=0.9582 | fpr=0.0213 | 15744.3 samples/s | 61.5 steps/s
Avg test loss: 0.18193, Avg test acc: 0.97840, Avg tpr: 0.95840, Avg fpr: 0.02123, total FA: 2948

server round 34/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=42001 Epoch=81.9] | Loss=0.00052 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=10.135 | 3754.9 samples/s | 58.7 steps/s
[Step=42050 Epoch=82.0] | Loss=0.00903 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.773 | L2-Norm(final)=10.139 | 5320.5 samples/s | 83.1 steps/s
[Step=42100 Epoch=82.1] | Loss=0.00862 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.773 | L2-Norm(final)=10.140 | 5721.9 samples/s | 89.4 steps/s
[Step=42150 Epoch=82.2] | Loss=0.00862 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=10.141 | 5528.3 samples/s | 86.4 steps/s
[Step=42200 Epoch=82.3] | Loss=0.00866 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.773 | L2-Norm(final)=10.143 | 5654.8 samples/s | 88.4 steps/s
[Step=42250 Epoch=82.4] | Loss=0.00844 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.773 | L2-Norm(final)=10.146 | 5800.5 samples/s | 90.6 steps/s
[Step=42300 Epoch=82.5] | Loss=0.00808 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=10.148 | 5567.7 samples/s | 87.0 steps/s
[Step=42350 Epoch=82.6] | Loss=0.00811 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.773 | L2-Norm(final)=10.150 | 5722.2 samples/s | 89.4 steps/s
[Step=42400 Epoch=82.7] | Loss=0.00816 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=10.152 | 5666.7 samples/s | 88.5 steps/s
[Step=42450 Epoch=82.8] | Loss=0.00812 | Reg=0.00163 | acc=0.9688 | L2-Norm=12.773 | L2-Norm(final)=10.153 | 5664.5 samples/s | 88.5 steps/s
[Step=42500 Epoch=82.9] | Loss=0.00823 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=10.155 | 7268.7 samples/s | 113.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=42501 Epoch=82.9] | Loss=0.00537 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=10.174 | 3526.5 samples/s | 55.1 steps/s
[Step=42550 Epoch=83.0] | Loss=0.00944 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.780 | L2-Norm(final)=10.173 | 4755.5 samples/s | 74.3 steps/s
[Step=42600 Epoch=83.1] | Loss=0.00917 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.786 | L2-Norm(final)=10.174 | 4950.4 samples/s | 77.3 steps/s
[Step=42650 Epoch=83.2] | Loss=0.00946 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.790 | L2-Norm(final)=10.174 | 4956.9 samples/s | 77.5 steps/s
[Step=42700 Epoch=83.3] | Loss=0.00948 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.794 | L2-Norm(final)=10.174 | 4989.5 samples/s | 78.0 steps/s
[Step=42750 Epoch=83.4] | Loss=0.00940 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.798 | L2-Norm(final)=10.175 | 4893.4 samples/s | 76.5 steps/s
[Step=42800 Epoch=83.5] | Loss=0.00958 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.802 | L2-Norm(final)=10.176 | 4955.7 samples/s | 77.4 steps/s
[Step=42850 Epoch=83.6] | Loss=0.00938 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.805 | L2-Norm(final)=10.177 | 5018.0 samples/s | 78.4 steps/s
[Step=42900 Epoch=83.7] | Loss=0.00924 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.808 | L2-Norm(final)=10.178 | 4913.2 samples/s | 76.8 steps/s
[Step=42950 Epoch=83.8] | Loss=0.00906 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.811 | L2-Norm(final)=10.180 | 4964.4 samples/s | 77.6 steps/s
[Step=43000 Epoch=83.9] | Loss=0.00886 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.815 | L2-Norm(final)=10.181 | 6091.3 samples/s | 95.2 steps/s
[Step=43050 Epoch=84.0] | Loss=0.00856 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.818 | L2-Norm(final)=10.183 | 1861.8 samples/s | 29.1 steps/s
[Step=43100 Epoch=84.1] | Loss=0.00837 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.820 | L2-Norm(final)=10.184 | 4937.3 samples/s | 77.1 steps/s
[Step=43150 Epoch=84.2] | Loss=0.00821 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.823 | L2-Norm(final)=10.186 | 4886.4 samples/s | 76.3 steps/s
[Step=43200 Epoch=84.3] | Loss=0.00818 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.825 | L2-Norm(final)=10.187 | 4972.1 samples/s | 77.7 steps/s
[Step=43250 Epoch=84.4] | Loss=0.00802 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.827 | L2-Norm(final)=10.188 | 4948.6 samples/s | 77.3 steps/s
[Step=43300 Epoch=84.5] | Loss=0.00791 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.829 | L2-Norm(final)=10.190 | 4940.9 samples/s | 77.2 steps/s
[Step=43350 Epoch=84.5] | Loss=0.00791 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.831 | L2-Norm(final)=10.191 | 5003.4 samples/s | 78.2 steps/s
[Step=43400 Epoch=84.6] | Loss=0.00778 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.833 | L2-Norm(final)=10.192 | 4974.6 samples/s | 77.7 steps/s
[Step=43450 Epoch=84.7] | Loss=0.00766 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.835 | L2-Norm(final)=10.193 | 4905.8 samples/s | 76.7 steps/s
[Step=43500 Epoch=84.8] | Loss=0.00755 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.836 | L2-Norm(final)=10.195 | 5283.4 samples/s | 82.6 steps/s
[Step=43550 Epoch=84.9] | Loss=0.00743 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.838 | L2-Norm(final)=10.196 | 1924.2 samples/s | 30.1 steps/s
[Step=43600 Epoch=85.0] | Loss=0.00736 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.840 | L2-Norm(final)=10.198 | 5043.3 samples/s | 78.8 steps/s
[Step=43650 Epoch=85.1] | Loss=0.00728 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.841 | L2-Norm(final)=10.199 | 4882.4 samples/s | 76.3 steps/s
[Step=43700 Epoch=85.2] | Loss=0.00728 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.843 | L2-Norm(final)=10.200 | 4963.1 samples/s | 77.5 steps/s
[Step=43750 Epoch=85.3] | Loss=0.00718 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.844 | L2-Norm(final)=10.202 | 4938.3 samples/s | 77.2 steps/s
[Step=43800 Epoch=85.4] | Loss=0.00709 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.846 | L2-Norm(final)=10.203 | 4960.5 samples/s | 77.5 steps/s
[Step=43850 Epoch=85.5] | Loss=0.00704 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.847 | L2-Norm(final)=10.204 | 4943.0 samples/s | 77.2 steps/s
[Step=43900 Epoch=85.6] | Loss=0.00703 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.848 | L2-Norm(final)=10.206 | 4951.4 samples/s | 77.4 steps/s
[Step=43950 Epoch=85.7] | Loss=0.00692 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.850 | L2-Norm(final)=10.207 | 4977.1 samples/s | 77.8 steps/s
[Step=44000 Epoch=85.8] | Loss=0.00686 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.851 | L2-Norm(final)=10.208 | 4939.2 samples/s | 77.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step44000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=30001 Epoch=58.7] | Loss=0.00286 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=8.699 | 3868.5 samples/s | 60.4 steps/s
[Step=30050 Epoch=58.7] | Loss=0.00974 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=8.700 | 5382.7 samples/s | 84.1 steps/s
[Step=30100 Epoch=58.8] | Loss=0.00914 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=8.702 | 5712.6 samples/s | 89.3 steps/s
[Step=30150 Epoch=58.9] | Loss=0.00856 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=8.706 | 5599.2 samples/s | 87.5 steps/s
[Step=30200 Epoch=59.0] | Loss=0.00856 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.773 | L2-Norm(final)=8.710 | 5677.0 samples/s | 88.7 steps/s
[Step=30250 Epoch=59.1] | Loss=0.00884 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.773 | L2-Norm(final)=8.714 | 5655.4 samples/s | 88.4 steps/s
[Step=30300 Epoch=59.2] | Loss=0.00906 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.773 | L2-Norm(final)=8.717 | 5714.6 samples/s | 89.3 steps/s
[Step=30350 Epoch=59.3] | Loss=0.00897 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=8.721 | 5781.5 samples/s | 90.3 steps/s
[Step=30400 Epoch=59.4] | Loss=0.00890 | Reg=0.00163 | acc=0.9688 | L2-Norm=12.773 | L2-Norm(final)=8.724 | 5641.5 samples/s | 88.1 steps/s
[Step=30450 Epoch=59.5] | Loss=0.00877 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=8.728 | 5609.4 samples/s | 87.6 steps/s
[Step=30500 Epoch=59.6] | Loss=0.00865 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=8.731 | 7364.2 samples/s | 115.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=59.6] | Loss=0.00144 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=8.765 | 3836.0 samples/s | 59.9 steps/s
[Step=30550 Epoch=59.7] | Loss=0.00914 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.779 | L2-Norm(final)=8.768 | 4882.7 samples/s | 76.3 steps/s
[Step=30600 Epoch=59.8] | Loss=0.01058 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.785 | L2-Norm(final)=8.768 | 4977.2 samples/s | 77.8 steps/s
[Step=30650 Epoch=59.9] | Loss=0.00995 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.789 | L2-Norm(final)=8.769 | 4885.0 samples/s | 76.3 steps/s
[Step=30700 Epoch=60.0] | Loss=0.00971 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.793 | L2-Norm(final)=8.771 | 4954.1 samples/s | 77.4 steps/s
[Step=30750 Epoch=60.1] | Loss=0.00957 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.797 | L2-Norm(final)=8.772 | 5017.9 samples/s | 78.4 steps/s
[Step=30800 Epoch=60.2] | Loss=0.00934 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.801 | L2-Norm(final)=8.775 | 4902.8 samples/s | 76.6 steps/s
[Step=30850 Epoch=60.3] | Loss=0.00918 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.804 | L2-Norm(final)=8.776 | 4988.0 samples/s | 77.9 steps/s
[Step=30900 Epoch=60.4] | Loss=0.00889 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.808 | L2-Norm(final)=8.779 | 4947.8 samples/s | 77.3 steps/s
[Step=30950 Epoch=60.5] | Loss=0.00885 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.811 | L2-Norm(final)=8.780 | 4939.8 samples/s | 77.2 steps/s
[Step=31000 Epoch=60.6] | Loss=0.00875 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.815 | L2-Norm(final)=8.782 | 6125.2 samples/s | 95.7 steps/s
[Step=31050 Epoch=60.7] | Loss=0.00862 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.818 | L2-Norm(final)=8.784 | 1925.6 samples/s | 30.1 steps/s
[Step=31100 Epoch=60.8] | Loss=0.00845 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.821 | L2-Norm(final)=8.786 | 4922.2 samples/s | 76.9 steps/s
[Step=31150 Epoch=60.9] | Loss=0.00822 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.824 | L2-Norm(final)=8.788 | 4951.4 samples/s | 77.4 steps/s
[Step=31200 Epoch=61.0] | Loss=0.00798 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.826 | L2-Norm(final)=8.790 | 4939.6 samples/s | 77.2 steps/s
[Step=31250 Epoch=61.1] | Loss=0.00780 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.829 | L2-Norm(final)=8.792 | 4952.4 samples/s | 77.4 steps/s
[Step=31300 Epoch=61.2] | Loss=0.00767 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.831 | L2-Norm(final)=8.794 | 4968.4 samples/s | 77.6 steps/s
[Step=31350 Epoch=61.3] | Loss=0.00767 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.834 | L2-Norm(final)=8.795 | 4920.0 samples/s | 76.9 steps/s
[Step=31400 Epoch=61.4] | Loss=0.00764 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.836 | L2-Norm(final)=8.797 | 4973.8 samples/s | 77.7 steps/s
[Step=31450 Epoch=61.5] | Loss=0.00754 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.838 | L2-Norm(final)=8.799 | 4887.2 samples/s | 76.4 steps/s
[Step=31500 Epoch=61.6] | Loss=0.00751 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.840 | L2-Norm(final)=8.801 | 5250.9 samples/s | 82.0 steps/s
[Step=31550 Epoch=61.7] | Loss=0.00750 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.842 | L2-Norm(final)=8.802 | 2002.5 samples/s | 31.3 steps/s
[Step=31600 Epoch=61.8] | Loss=0.00737 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.844 | L2-Norm(final)=8.804 | 4865.9 samples/s | 76.0 steps/s
[Step=31650 Epoch=61.9] | Loss=0.00729 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.846 | L2-Norm(final)=8.806 | 4869.0 samples/s | 76.1 steps/s
[Step=31700 Epoch=62.0] | Loss=0.00717 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.848 | L2-Norm(final)=8.807 | 4862.1 samples/s | 76.0 steps/s
[Step=31750 Epoch=62.1] | Loss=0.00709 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.850 | L2-Norm(final)=8.809 | 4766.5 samples/s | 74.5 steps/s
[Step=31800 Epoch=62.2] | Loss=0.00702 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.851 | L2-Norm(final)=8.811 | 4853.8 samples/s | 75.8 steps/s
[Step=31850 Epoch=62.3] | Loss=0.00697 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.853 | L2-Norm(final)=8.812 | 4948.2 samples/s | 77.3 steps/s
[Step=31900 Epoch=62.4] | Loss=0.00690 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=8.814 | 5003.9 samples/s | 78.2 steps/s
[Step=31950 Epoch=62.5] | Loss=0.00686 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.856 | L2-Norm(final)=8.816 | 4924.4 samples/s | 76.9 steps/s
[Step=32000 Epoch=62.6] | Loss=0.00678 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.858 | L2-Norm(final)=8.818 | 4954.7 samples/s | 77.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08525 | acc=0.9704 | tpr=0.9800 | fpr=0.0505 | 4377.2 samples/s | 17.1 steps/s
Avg test loss: 0.08717, Avg test acc: 0.96767, Avg tpr: 0.97791, Avg fpr: 0.05486, total FA: 428

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07642 | acc=0.9711 | tpr=0.9762 | fpr=0.0399 | 4326.2 samples/s | 16.9 steps/s
Avg test loss: 0.08054, Avg test acc: 0.96891, Avg tpr: 0.97418, Avg fpr: 0.04269, total FA: 333

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.46246 | acc=0.2812 | tpr=0.0162 | fpr=0.1435 | 4344.6 samples/s | 17.0 steps/s
Avg test loss: 6.46670, Avg test acc: 0.27951, Avg tpr: 0.01754, Avg fpr: 0.14434, total FA: 1126

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.06537 | acc=0.2948 | tpr=0.0200 | fpr=0.1083 | 4347.9 samples/s | 17.0 steps/s
Avg test loss: 7.07091, Avg test acc: 0.29241, Avg tpr: 0.02092, Avg fpr: 0.11050, total FA: 862

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.51669 | acc=0.1221 | tpr=0.6991 | fpr=0.8883 | 4390.9 samples/s | 17.2 steps/s
[Step= 100] | Loss=6.50387 | acc=0.1243 | tpr=0.7335 | fpr=0.8871 | 8522.6 samples/s | 33.3 steps/s
[Step= 150] | Loss=6.50651 | acc=0.1231 | tpr=0.7176 | fpr=0.8878 | 8853.0 samples/s | 34.6 steps/s
[Step= 200] | Loss=6.49276 | acc=0.1240 | tpr=0.7158 | fpr=0.8868 | 8470.1 samples/s | 33.1 steps/s
[Step= 250] | Loss=6.49098 | acc=0.1237 | tpr=0.7039 | fpr=0.8868 | 9350.9 samples/s | 36.5 steps/s
[Step= 300] | Loss=6.48510 | acc=0.1243 | tpr=0.7091 | fpr=0.8864 | 8105.6 samples/s | 31.7 steps/s
[Step= 350] | Loss=6.48084 | acc=0.1237 | tpr=0.7126 | fpr=0.8870 | 8978.9 samples/s | 35.1 steps/s
[Step= 400] | Loss=6.47504 | acc=0.1235 | tpr=0.7128 | fpr=0.8872 | 8464.6 samples/s | 33.1 steps/s
[Step= 450] | Loss=6.47108 | acc=0.1235 | tpr=0.7157 | fpr=0.8872 | 8801.9 samples/s | 34.4 steps/s
[Step= 500] | Loss=6.47396 | acc=0.1235 | tpr=0.7194 | fpr=0.8873 | 8637.3 samples/s | 33.7 steps/s
[Step= 550] | Loss=6.47488 | acc=0.1238 | tpr=0.7207 | fpr=0.8870 | 15665.2 samples/s | 61.2 steps/s
Avg test loss: 6.47609, Avg test acc: 0.12367, Avg tpr: 0.72029, Avg fpr: 0.88718, total FA: 123183

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.83173 | acc=0.1454 | tpr=0.6416 | fpr=0.8635 | 4440.7 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.81401 | acc=0.1473 | tpr=0.6631 | fpr=0.8624 | 9043.1 samples/s | 35.3 steps/s
[Step= 150] | Loss=5.81492 | acc=0.1462 | tpr=0.6427 | fpr=0.8630 | 8156.0 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.80181 | acc=0.1472 | tpr=0.6426 | fpr=0.8618 | 8960.8 samples/s | 35.0 steps/s
[Step= 250] | Loss=5.79979 | acc=0.1470 | tpr=0.6279 | fpr=0.8618 | 8778.5 samples/s | 34.3 steps/s
[Step= 300] | Loss=5.79620 | acc=0.1473 | tpr=0.6320 | fpr=0.8615 | 8314.9 samples/s | 32.5 steps/s
[Step= 350] | Loss=5.79106 | acc=0.1469 | tpr=0.6381 | fpr=0.8621 | 8783.7 samples/s | 34.3 steps/s
[Step= 400] | Loss=5.78382 | acc=0.1470 | tpr=0.6411 | fpr=0.8620 | 8713.5 samples/s | 34.0 steps/s
[Step= 450] | Loss=5.78020 | acc=0.1470 | tpr=0.6465 | fpr=0.8621 | 8861.9 samples/s | 34.6 steps/s
[Step= 500] | Loss=5.78283 | acc=0.1468 | tpr=0.6489 | fpr=0.8623 | 8639.6 samples/s | 33.7 steps/s
[Step= 550] | Loss=5.78258 | acc=0.1466 | tpr=0.6450 | fpr=0.8624 | 15364.6 samples/s | 60.0 steps/s
Avg test loss: 5.78372, Avg test acc: 0.14651, Avg tpr: 0.64501, Avg fpr: 0.86255, total FA: 119764

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13414 | acc=0.9807 | tpr=0.9602 | fpr=0.0189 | 4318.0 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.14356 | acc=0.9792 | tpr=0.9659 | fpr=0.0205 | 8663.5 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.14880 | acc=0.9785 | tpr=0.9654 | fpr=0.0213 | 8569.7 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.14903 | acc=0.9791 | tpr=0.9650 | fpr=0.0207 | 8994.1 samples/s | 35.1 steps/s
[Step= 250] | Loss=0.14704 | acc=0.9794 | tpr=0.9659 | fpr=0.0203 | 8561.5 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.14851 | acc=0.9793 | tpr=0.9665 | fpr=0.0204 | 8541.9 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.14926 | acc=0.9792 | tpr=0.9674 | fpr=0.0206 | 8862.3 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.15081 | acc=0.9789 | tpr=0.9639 | fpr=0.0208 | 8489.1 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.15435 | acc=0.9787 | tpr=0.9611 | fpr=0.0209 | 8811.7 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.15356 | acc=0.9787 | tpr=0.9617 | fpr=0.0210 | 8760.7 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.15230 | acc=0.9788 | tpr=0.9614 | fpr=0.0208 | 14793.8 samples/s | 57.8 steps/s
Avg test loss: 0.15194, Avg test acc: 0.97887, Avg tpr: 0.96157, Avg fpr: 0.02081, total FA: 2890

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15976 | acc=0.9805 | tpr=0.9558 | fpr=0.0191 | 4339.2 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.17124 | acc=0.9788 | tpr=0.9638 | fpr=0.0209 | 8652.3 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.17799 | acc=0.9781 | tpr=0.9611 | fpr=0.0216 | 8825.6 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.17839 | acc=0.9786 | tpr=0.9607 | fpr=0.0211 | 9058.9 samples/s | 35.4 steps/s
[Step= 250] | Loss=0.17556 | acc=0.9789 | tpr=0.9607 | fpr=0.0207 | 8500.7 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.17747 | acc=0.9788 | tpr=0.9607 | fpr=0.0209 | 8617.4 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.17852 | acc=0.9788 | tpr=0.9618 | fpr=0.0209 | 8785.2 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.18020 | acc=0.9784 | tpr=0.9590 | fpr=0.0212 | 8605.9 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.18455 | acc=0.9783 | tpr=0.9567 | fpr=0.0213 | 9091.3 samples/s | 35.5 steps/s
[Step= 500] | Loss=0.18379 | acc=0.9783 | tpr=0.9581 | fpr=0.0214 | 7958.1 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.18240 | acc=0.9784 | tpr=0.9582 | fpr=0.0213 | 16074.0 samples/s | 62.8 steps/s
Avg test loss: 0.18193, Avg test acc: 0.97840, Avg tpr: 0.95840, Avg fpr: 0.02123, total FA: 2948

server round 35/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=62.6] | Loss=0.00624 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=8.870 | 3799.5 samples/s | 59.4 steps/s
[Step=32050 Epoch=62.7] | Loss=0.00651 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=8.874 | 5624.8 samples/s | 87.9 steps/s
[Step=32100 Epoch=62.8] | Loss=0.00797 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=8.877 | 5770.1 samples/s | 90.2 steps/s
[Step=32150 Epoch=62.9] | Loss=0.00829 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=8.879 | 5537.1 samples/s | 86.5 steps/s
[Step=32200 Epoch=63.0] | Loss=0.00831 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=8.881 | 5837.7 samples/s | 91.2 steps/s
[Step=32250 Epoch=63.0] | Loss=0.00805 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=8.884 | 5505.4 samples/s | 86.0 steps/s
[Step=32300 Epoch=63.1] | Loss=0.00815 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.536 | L2-Norm(final)=8.886 | 5738.6 samples/s | 89.7 steps/s
[Step=32350 Epoch=63.2] | Loss=0.00840 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=8.889 | 5634.6 samples/s | 88.0 steps/s
[Step=32400 Epoch=63.3] | Loss=0.00839 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=8.892 | 5685.6 samples/s | 88.8 steps/s
[Step=32450 Epoch=63.4] | Loss=0.00832 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=8.895 | 5664.9 samples/s | 88.5 steps/s
[Step=32500 Epoch=63.5] | Loss=0.00822 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.536 | L2-Norm(final)=8.898 | 7367.6 samples/s | 115.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=63.5] | Loss=0.00987 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.536 | L2-Norm(final)=8.930 | 3796.7 samples/s | 59.3 steps/s
[Step=32550 Epoch=63.6] | Loss=0.01022 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.541 | L2-Norm(final)=8.931 | 4868.5 samples/s | 76.1 steps/s
[Step=32600 Epoch=63.7] | Loss=0.01049 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.547 | L2-Norm(final)=8.932 | 4968.8 samples/s | 77.6 steps/s
[Step=32650 Epoch=63.8] | Loss=0.01038 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=8.934 | 4911.9 samples/s | 76.7 steps/s
[Step=32700 Epoch=63.9] | Loss=0.01022 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=8.936 | 5001.7 samples/s | 78.2 steps/s
[Step=32750 Epoch=64.0] | Loss=0.00929 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=8.938 | 4876.6 samples/s | 76.2 steps/s
[Step=32800 Epoch=64.1] | Loss=0.00911 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.567 | L2-Norm(final)=8.941 | 4962.7 samples/s | 77.5 steps/s
[Step=32850 Epoch=64.2] | Loss=0.00890 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.571 | L2-Norm(final)=8.943 | 4937.7 samples/s | 77.2 steps/s
[Step=32900 Epoch=64.3] | Loss=0.00867 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.575 | L2-Norm(final)=8.945 | 4958.3 samples/s | 77.5 steps/s
[Step=32950 Epoch=64.4] | Loss=0.00858 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.578 | L2-Norm(final)=8.947 | 4970.5 samples/s | 77.7 steps/s
[Step=33000 Epoch=64.5] | Loss=0.00839 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.581 | L2-Norm(final)=8.949 | 6081.5 samples/s | 95.0 steps/s
[Step=33050 Epoch=64.6] | Loss=0.00842 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.584 | L2-Norm(final)=8.951 | 1919.0 samples/s | 30.0 steps/s
[Step=33100 Epoch=64.7] | Loss=0.00829 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.586 | L2-Norm(final)=8.953 | 4930.5 samples/s | 77.0 steps/s
[Step=33150 Epoch=64.8] | Loss=0.00811 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.589 | L2-Norm(final)=8.954 | 4949.6 samples/s | 77.3 steps/s
[Step=33200 Epoch=64.9] | Loss=0.00791 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.591 | L2-Norm(final)=8.956 | 4948.8 samples/s | 77.3 steps/s
[Step=33250 Epoch=65.0] | Loss=0.00774 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.594 | L2-Norm(final)=8.958 | 4986.5 samples/s | 77.9 steps/s
[Step=33300 Epoch=65.1] | Loss=0.00770 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.596 | L2-Norm(final)=8.959 | 4902.5 samples/s | 76.6 steps/s
[Step=33350 Epoch=65.2] | Loss=0.00769 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.598 | L2-Norm(final)=8.961 | 4968.4 samples/s | 77.6 steps/s
[Step=33400 Epoch=65.3] | Loss=0.00764 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.600 | L2-Norm(final)=8.963 | 4931.7 samples/s | 77.1 steps/s
[Step=33450 Epoch=65.4] | Loss=0.00756 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.602 | L2-Norm(final)=8.964 | 4942.4 samples/s | 77.2 steps/s
[Step=33500 Epoch=65.5] | Loss=0.00753 | Reg=0.00159 | acc=0.9688 | L2-Norm=12.604 | L2-Norm(final)=8.966 | 5372.9 samples/s | 84.0 steps/s
[Step=33550 Epoch=65.6] | Loss=0.00746 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.606 | L2-Norm(final)=8.967 | 1993.8 samples/s | 31.2 steps/s
[Step=33600 Epoch=65.7] | Loss=0.00733 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.608 | L2-Norm(final)=8.969 | 4973.9 samples/s | 77.7 steps/s
[Step=33650 Epoch=65.8] | Loss=0.00721 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.610 | L2-Norm(final)=8.971 | 4854.3 samples/s | 75.8 steps/s
[Step=33700 Epoch=65.9] | Loss=0.00721 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.612 | L2-Norm(final)=8.972 | 4950.1 samples/s | 77.3 steps/s
[Step=33750 Epoch=66.0] | Loss=0.00715 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.613 | L2-Norm(final)=8.974 | 4898.4 samples/s | 76.5 steps/s
[Step=33800 Epoch=66.1] | Loss=0.00710 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.615 | L2-Norm(final)=8.976 | 5009.4 samples/s | 78.3 steps/s
[Step=33850 Epoch=66.2] | Loss=0.00701 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.617 | L2-Norm(final)=8.977 | 4946.5 samples/s | 77.3 steps/s
[Step=33900 Epoch=66.3] | Loss=0.00696 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.619 | L2-Norm(final)=8.979 | 4979.0 samples/s | 77.8 steps/s
[Step=33950 Epoch=66.4] | Loss=0.00693 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.620 | L2-Norm(final)=8.980 | 4998.1 samples/s | 78.1 steps/s
[Step=34000 Epoch=66.5] | Loss=0.00694 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.622 | L2-Norm(final)=8.982 | 4901.5 samples/s | 76.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step34000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=30001 Epoch=115.0] | Loss=0.00002 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=10.455 | 3919.9 samples/s | 61.2 steps/s
[Step=30050 Epoch=115.1] | Loss=0.00007 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=10.464 | 5000.5 samples/s | 78.1 steps/s
[Step=30100 Epoch=115.3] | Loss=0.00005 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=10.474 | 5308.3 samples/s | 82.9 steps/s
[Step=30150 Epoch=115.5] | Loss=0.00004 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=10.482 | 5425.5 samples/s | 84.8 steps/s
[Step=30200 Epoch=115.7] | Loss=0.00005 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=10.490 | 5275.8 samples/s | 82.4 steps/s
[Step=30250 Epoch=115.9] | Loss=0.00005 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=10.498 | 7009.0 samples/s | 109.5 steps/s
[Step=30300 Epoch=116.1] | Loss=0.00005 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=10.506 | 1920.4 samples/s | 30.0 steps/s
[Step=30350 Epoch=116.3] | Loss=0.00004 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=10.513 | 5422.3 samples/s | 84.7 steps/s
[Step=30400 Epoch=116.5] | Loss=0.00004 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=10.520 | 5476.5 samples/s | 85.6 steps/s
[Step=30450 Epoch=116.7] | Loss=0.00004 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=10.526 | 5275.0 samples/s | 82.4 steps/s
[Step=30500 Epoch=116.9] | Loss=0.00004 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=10.533 | 5971.7 samples/s | 93.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=116.9] | Loss=0.00000 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=10.598 | 4031.1 samples/s | 63.0 steps/s
[Step=30550 Epoch=117.1] | Loss=0.00003 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=10.602 | 4401.0 samples/s | 68.8 steps/s
[Step=30600 Epoch=117.2] | Loss=0.00005 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=10.603 | 4698.0 samples/s | 73.4 steps/s
[Step=30650 Epoch=117.4] | Loss=0.00005 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.469 | L2-Norm(final)=10.606 | 4739.0 samples/s | 74.0 steps/s
[Step=30700 Epoch=117.6] | Loss=0.00004 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.455 | L2-Norm(final)=10.608 | 4713.5 samples/s | 73.6 steps/s
[Step=30750 Epoch=117.8] | Loss=0.00003 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=10.609 | 5982.5 samples/s | 93.5 steps/s
[Step=30800 Epoch=118.0] | Loss=0.00003 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.424 | L2-Norm(final)=10.610 | 1857.7 samples/s | 29.0 steps/s
[Step=30850 Epoch=118.2] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.407 | L2-Norm(final)=10.611 | 4740.6 samples/s | 74.1 steps/s
[Step=30900 Epoch=118.4] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.390 | L2-Norm(final)=10.612 | 4666.2 samples/s | 72.9 steps/s
[Step=30950 Epoch=118.6] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=10.613 | 4721.4 samples/s | 73.8 steps/s
[Step=31000 Epoch=118.8] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.355 | L2-Norm(final)=10.613 | 5235.6 samples/s | 81.8 steps/s
[Step=31050 Epoch=119.0] | Loss=0.00002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.337 | L2-Norm(final)=10.614 | 1943.6 samples/s | 30.4 steps/s
[Step=31100 Epoch=119.2] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.319 | L2-Norm(final)=10.614 | 4739.9 samples/s | 74.1 steps/s
[Step=31150 Epoch=119.4] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=10.615 | 4736.3 samples/s | 74.0 steps/s
[Step=31200 Epoch=119.5] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=10.615 | 4677.2 samples/s | 73.1 steps/s
[Step=31250 Epoch=119.7] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=10.615 | 4709.3 samples/s | 73.6 steps/s
[Step=31300 Epoch=119.9] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.245 | L2-Norm(final)=10.616 | 2019.4 samples/s | 31.6 steps/s
[Step=31350 Epoch=120.1] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=10.616 | 4814.8 samples/s | 75.2 steps/s
[Step=31400 Epoch=120.3] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.207 | L2-Norm(final)=10.616 | 4700.3 samples/s | 73.4 steps/s
[Step=31450 Epoch=120.5] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.188 | L2-Norm(final)=10.616 | 4751.9 samples/s | 74.2 steps/s
[Step=31500 Epoch=120.7] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=10.617 | 4705.8 samples/s | 73.5 steps/s
[Step=31550 Epoch=120.9] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=10.617 | 2010.2 samples/s | 31.4 steps/s
[Step=31600 Epoch=121.1] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=10.617 | 4668.4 samples/s | 72.9 steps/s
[Step=31650 Epoch=121.3] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.111 | L2-Norm(final)=10.618 | 4758.6 samples/s | 74.4 steps/s
[Step=31700 Epoch=121.5] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.091 | L2-Norm(final)=10.618 | 4706.4 samples/s | 73.5 steps/s
[Step=31750 Epoch=121.7] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.071 | L2-Norm(final)=10.618 | 4693.8 samples/s | 73.3 steps/s
[Step=31800 Epoch=121.8] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.051 | L2-Norm(final)=10.619 | 6457.5 samples/s | 100.9 steps/s
[Step=31850 Epoch=122.0] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.031 | L2-Norm(final)=10.619 | 1814.6 samples/s | 28.4 steps/s
[Step=31900 Epoch=122.2] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.011 | L2-Norm(final)=10.619 | 4703.9 samples/s | 73.5 steps/s
[Step=31950 Epoch=122.4] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.990 | L2-Norm(final)=10.620 | 4683.0 samples/s | 73.2 steps/s
[Step=32000 Epoch=122.6] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.970 | L2-Norm(final)=10.620 | 4662.7 samples/s | 72.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08525 | acc=0.9704 | tpr=0.9800 | fpr=0.0505 | 4369.5 samples/s | 17.1 steps/s
Avg test loss: 0.08717, Avg test acc: 0.96767, Avg tpr: 0.97791, Avg fpr: 0.05486, total FA: 428

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07318 | acc=0.9703 | tpr=0.9777 | fpr=0.0458 | 4346.5 samples/s | 17.0 steps/s
Avg test loss: 0.07685, Avg test acc: 0.96839, Avg tpr: 0.97593, Avg fpr: 0.04820, total FA: 376

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.37611 | acc=0.2823 | tpr=0.0164 | fpr=0.1402 | 4344.3 samples/s | 17.0 steps/s
Avg test loss: 6.37533, Avg test acc: 0.27955, Avg tpr: 0.01632, Avg fpr: 0.14152, total FA: 1104

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.06537 | acc=0.2948 | tpr=0.0200 | fpr=0.1083 | 4326.9 samples/s | 16.9 steps/s
Avg test loss: 7.07091, Avg test acc: 0.29241, Avg tpr: 0.02092, Avg fpr: 0.11050, total FA: 862

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.51669 | acc=0.1221 | tpr=0.6991 | fpr=0.8883 | 4407.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=6.50387 | acc=0.1243 | tpr=0.7335 | fpr=0.8871 | 8500.7 samples/s | 33.2 steps/s
[Step= 150] | Loss=6.50651 | acc=0.1231 | tpr=0.7176 | fpr=0.8878 | 9006.2 samples/s | 35.2 steps/s
[Step= 200] | Loss=6.49276 | acc=0.1240 | tpr=0.7158 | fpr=0.8868 | 8517.5 samples/s | 33.3 steps/s
[Step= 250] | Loss=6.49098 | acc=0.1237 | tpr=0.7039 | fpr=0.8868 | 8303.2 samples/s | 32.4 steps/s
[Step= 300] | Loss=6.48510 | acc=0.1243 | tpr=0.7091 | fpr=0.8864 | 9481.1 samples/s | 37.0 steps/s
[Step= 350] | Loss=6.48084 | acc=0.1237 | tpr=0.7126 | fpr=0.8870 | 8331.1 samples/s | 32.5 steps/s
[Step= 400] | Loss=6.47504 | acc=0.1235 | tpr=0.7128 | fpr=0.8872 | 8586.1 samples/s | 33.5 steps/s
[Step= 450] | Loss=6.47108 | acc=0.1235 | tpr=0.7157 | fpr=0.8872 | 9096.3 samples/s | 35.5 steps/s
[Step= 500] | Loss=6.47396 | acc=0.1235 | tpr=0.7194 | fpr=0.8873 | 8226.5 samples/s | 32.1 steps/s
[Step= 550] | Loss=6.47488 | acc=0.1238 | tpr=0.7207 | fpr=0.8870 | 15526.9 samples/s | 60.7 steps/s
Avg test loss: 6.47609, Avg test acc: 0.12367, Avg tpr: 0.72029, Avg fpr: 0.88718, total FA: 123183

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.75469 | acc=0.1431 | tpr=0.6637 | fpr=0.8662 | 4367.7 samples/s | 17.1 steps/s
[Step= 100] | Loss=5.74009 | acc=0.1454 | tpr=0.6887 | fpr=0.8647 | 8968.4 samples/s | 35.0 steps/s
[Step= 150] | Loss=5.74185 | acc=0.1442 | tpr=0.6671 | fpr=0.8654 | 8227.8 samples/s | 32.1 steps/s
[Step= 200] | Loss=5.72739 | acc=0.1450 | tpr=0.6634 | fpr=0.8644 | 8884.7 samples/s | 34.7 steps/s
[Step= 250] | Loss=5.72552 | acc=0.1448 | tpr=0.6472 | fpr=0.8644 | 8774.7 samples/s | 34.3 steps/s
[Step= 300] | Loss=5.72188 | acc=0.1454 | tpr=0.6495 | fpr=0.8638 | 8452.1 samples/s | 33.0 steps/s
[Step= 350] | Loss=5.71651 | acc=0.1451 | tpr=0.6531 | fpr=0.8641 | 8977.0 samples/s | 35.1 steps/s
[Step= 400] | Loss=5.70940 | acc=0.1452 | tpr=0.6543 | fpr=0.8640 | 9209.5 samples/s | 36.0 steps/s
[Step= 450] | Loss=5.70556 | acc=0.1450 | tpr=0.6558 | fpr=0.8643 | 8296.6 samples/s | 32.4 steps/s
[Step= 500] | Loss=5.70795 | acc=0.1449 | tpr=0.6586 | fpr=0.8644 | 8429.2 samples/s | 32.9 steps/s
[Step= 550] | Loss=5.70842 | acc=0.1449 | tpr=0.6550 | fpr=0.8643 | 15636.3 samples/s | 61.1 steps/s
Avg test loss: 5.70943, Avg test acc: 0.14478, Avg tpr: 0.65491, Avg fpr: 0.86449, total FA: 120033

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11887 | acc=0.9816 | tpr=0.9602 | fpr=0.0180 | 4382.6 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.12723 | acc=0.9802 | tpr=0.9659 | fpr=0.0195 | 9103.2 samples/s | 35.6 steps/s
[Step= 150] | Loss=0.13201 | acc=0.9792 | tpr=0.9640 | fpr=0.0205 | 8474.0 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.13194 | acc=0.9797 | tpr=0.9650 | fpr=0.0201 | 8450.7 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.13065 | acc=0.9801 | tpr=0.9668 | fpr=0.0196 | 8927.2 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.13221 | acc=0.9800 | tpr=0.9680 | fpr=0.0198 | 8837.7 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.13300 | acc=0.9798 | tpr=0.9681 | fpr=0.0200 | 8407.2 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.13485 | acc=0.9794 | tpr=0.9650 | fpr=0.0203 | 8773.6 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.13801 | acc=0.9792 | tpr=0.9620 | fpr=0.0205 | 8722.0 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.13745 | acc=0.9792 | tpr=0.9630 | fpr=0.0205 | 8787.7 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.13638 | acc=0.9793 | tpr=0.9622 | fpr=0.0204 | 15500.3 samples/s | 60.5 steps/s
Avg test loss: 0.13608, Avg test acc: 0.97932, Avg tpr: 0.96236, Avg fpr: 0.02037, total FA: 2828

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15976 | acc=0.9805 | tpr=0.9558 | fpr=0.0191 | 4333.6 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.17124 | acc=0.9788 | tpr=0.9638 | fpr=0.0209 | 8806.1 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.17799 | acc=0.9781 | tpr=0.9611 | fpr=0.0216 | 8760.4 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.17839 | acc=0.9786 | tpr=0.9607 | fpr=0.0211 | 8570.8 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.17556 | acc=0.9789 | tpr=0.9607 | fpr=0.0207 | 8592.4 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.17747 | acc=0.9788 | tpr=0.9607 | fpr=0.0209 | 8632.2 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.17852 | acc=0.9788 | tpr=0.9618 | fpr=0.0209 | 8999.5 samples/s | 35.2 steps/s
[Step= 400] | Loss=0.18020 | acc=0.9784 | tpr=0.9590 | fpr=0.0212 | 8507.2 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.18455 | acc=0.9783 | tpr=0.9567 | fpr=0.0213 | 8692.1 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.18379 | acc=0.9783 | tpr=0.9581 | fpr=0.0214 | 8740.9 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.18240 | acc=0.9784 | tpr=0.9582 | fpr=0.0213 | 15478.8 samples/s | 60.5 steps/s
Avg test loss: 0.18193, Avg test acc: 0.97840, Avg tpr: 0.95840, Avg fpr: 0.02123, total FA: 2948

server round 36/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=122.6] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=10.631 | 3901.7 samples/s | 61.0 steps/s
[Step=32050 Epoch=122.8] | Loss=0.00004 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.319 | L2-Norm(final)=10.637 | 4920.8 samples/s | 76.9 steps/s
[Step=32100 Epoch=123.0] | Loss=0.00003 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.318 | L2-Norm(final)=10.645 | 5611.4 samples/s | 87.7 steps/s
[Step=32150 Epoch=123.2] | Loss=0.00003 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.318 | L2-Norm(final)=10.652 | 5175.7 samples/s | 80.9 steps/s
[Step=32200 Epoch=123.4] | Loss=0.00003 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.318 | L2-Norm(final)=10.659 | 5336.5 samples/s | 83.4 steps/s
[Step=32250 Epoch=123.6] | Loss=0.00003 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.318 | L2-Norm(final)=10.665 | 7090.3 samples/s | 110.8 steps/s
[Step=32300 Epoch=123.8] | Loss=0.00003 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=10.670 | 1949.3 samples/s | 30.5 steps/s
[Step=32350 Epoch=124.0] | Loss=0.00002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=10.676 | 5392.7 samples/s | 84.3 steps/s
[Step=32400 Epoch=124.1] | Loss=0.00002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=10.681 | 5353.0 samples/s | 83.6 steps/s
[Step=32450 Epoch=124.3] | Loss=0.00003 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=10.687 | 5451.1 samples/s | 85.2 steps/s
[Step=32500 Epoch=124.5] | Loss=0.00002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=10.692 | 5958.8 samples/s | 93.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=124.5] | Loss=0.00004 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=10.749 | 3783.8 samples/s | 59.1 steps/s
[Step=32550 Epoch=124.7] | Loss=0.00004 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=10.753 | 4520.8 samples/s | 70.6 steps/s
[Step=32600 Epoch=124.9] | Loss=0.00002 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.273 | L2-Norm(final)=10.754 | 4734.0 samples/s | 74.0 steps/s
[Step=32650 Epoch=125.1] | Loss=0.00002 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.247 | L2-Norm(final)=10.756 | 4752.5 samples/s | 74.3 steps/s
[Step=32700 Epoch=125.3] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=10.758 | 4690.7 samples/s | 73.3 steps/s
[Step=32750 Epoch=125.5] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.191 | L2-Norm(final)=10.759 | 5910.4 samples/s | 92.4 steps/s
[Step=32800 Epoch=125.7] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=10.760 | 1861.4 samples/s | 29.1 steps/s
[Step=32850 Epoch=125.9] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=10.761 | 4743.8 samples/s | 74.1 steps/s
[Step=32900 Epoch=126.1] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=10.762 | 4688.7 samples/s | 73.3 steps/s
[Step=32950 Epoch=126.3] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.075 | L2-Norm(final)=10.763 | 4720.1 samples/s | 73.8 steps/s
[Step=33000 Epoch=126.4] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.046 | L2-Norm(final)=10.764 | 5270.6 samples/s | 82.4 steps/s
[Step=33050 Epoch=126.6] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.017 | L2-Norm(final)=10.764 | 1957.5 samples/s | 30.6 steps/s
[Step=33100 Epoch=126.8] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.988 | L2-Norm(final)=10.765 | 4635.2 samples/s | 72.4 steps/s
[Step=33150 Epoch=127.0] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.958 | L2-Norm(final)=10.766 | 4710.6 samples/s | 73.6 steps/s
[Step=33200 Epoch=127.2] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.929 | L2-Norm(final)=10.766 | 4731.6 samples/s | 73.9 steps/s
[Step=33250 Epoch=127.4] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=10.767 | 4709.7 samples/s | 73.6 steps/s
[Step=33300 Epoch=127.6] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.870 | L2-Norm(final)=10.768 | 2025.5 samples/s | 31.6 steps/s
[Step=33350 Epoch=127.8] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.841 | L2-Norm(final)=10.768 | 4779.0 samples/s | 74.7 steps/s
[Step=33400 Epoch=128.0] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.812 | L2-Norm(final)=10.769 | 4640.2 samples/s | 72.5 steps/s
[Step=33450 Epoch=128.2] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.782 | L2-Norm(final)=10.770 | 4730.7 samples/s | 73.9 steps/s
[Step=33500 Epoch=128.4] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.752 | L2-Norm(final)=10.771 | 4686.0 samples/s | 73.2 steps/s
[Step=33550 Epoch=128.6] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.723 | L2-Norm(final)=10.771 | 2011.1 samples/s | 31.4 steps/s
[Step=33600 Epoch=128.7] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.693 | L2-Norm(final)=10.772 | 4673.6 samples/s | 73.0 steps/s
[Step=33650 Epoch=128.9] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.663 | L2-Norm(final)=10.773 | 4698.5 samples/s | 73.4 steps/s
[Step=33700 Epoch=129.1] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.633 | L2-Norm(final)=10.774 | 4709.8 samples/s | 73.6 steps/s
[Step=33750 Epoch=129.3] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.603 | L2-Norm(final)=10.775 | 4743.7 samples/s | 74.1 steps/s
[Step=33800 Epoch=129.5] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.573 | L2-Norm(final)=10.776 | 6324.1 samples/s | 98.8 steps/s
[Step=33850 Epoch=129.7] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.543 | L2-Norm(final)=10.777 | 1793.9 samples/s | 28.0 steps/s
[Step=33900 Epoch=129.9] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.512 | L2-Norm(final)=10.778 | 4751.1 samples/s | 74.2 steps/s
[Step=33950 Epoch=130.1] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.482 | L2-Norm(final)=10.779 | 4638.2 samples/s | 72.5 steps/s
[Step=34000 Epoch=130.3] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=10.780 | 4719.9 samples/s | 73.7 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step34000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=130.9] | Loss=0.00000 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=11.724 | 3966.9 samples/s | 62.0 steps/s
[Step=34050 Epoch=131.1] | Loss=0.00024 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=11.736 | 4813.4 samples/s | 75.2 steps/s
[Step=34100 Epoch=131.3] | Loss=0.00021 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=11.744 | 5372.4 samples/s | 83.9 steps/s
[Step=34150 Epoch=131.5] | Loss=0.00022 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=11.752 | 5425.2 samples/s | 84.8 steps/s
[Step=34200 Epoch=131.6] | Loss=0.00027 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=11.760 | 5422.2 samples/s | 84.7 steps/s
[Step=34250 Epoch=131.8] | Loss=0.00024 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=11.769 | 7011.1 samples/s | 109.5 steps/s
[Step=34300 Epoch=132.0] | Loss=0.00024 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=11.776 | 1931.3 samples/s | 30.2 steps/s
[Step=34350 Epoch=132.2] | Loss=0.00022 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=11.783 | 5389.3 samples/s | 84.2 steps/s
[Step=34400 Epoch=132.4] | Loss=0.00021 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=11.789 | 5336.7 samples/s | 83.4 steps/s
[Step=34450 Epoch=132.6] | Loss=0.00022 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=11.795 | 5407.7 samples/s | 84.5 steps/s
[Step=34500 Epoch=132.8] | Loss=0.00021 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=11.800 | 6138.0 samples/s | 95.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=132.8] | Loss=0.00000 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=11.857 | 3948.7 samples/s | 61.7 steps/s
[Step=34550 Epoch=133.0] | Loss=0.00003 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=11.859 | 4318.9 samples/s | 67.5 steps/s
[Step=34600 Epoch=133.2] | Loss=0.00003 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=11.859 | 4813.8 samples/s | 75.2 steps/s
[Step=34650 Epoch=133.4] | Loss=0.00002 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.295 | L2-Norm(final)=11.860 | 4634.9 samples/s | 72.4 steps/s
[Step=34700 Epoch=133.6] | Loss=0.00002 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=11.860 | 4724.4 samples/s | 73.8 steps/s
[Step=34750 Epoch=133.8] | Loss=0.00002 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=11.860 | 6031.6 samples/s | 94.2 steps/s
[Step=34800 Epoch=134.0] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=11.860 | 1873.9 samples/s | 29.3 steps/s
[Step=34850 Epoch=134.2] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.250 | L2-Norm(final)=11.860 | 4657.1 samples/s | 72.8 steps/s
[Step=34900 Epoch=134.3] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=11.861 | 4665.4 samples/s | 72.9 steps/s
[Step=34950 Epoch=134.5] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.225 | L2-Norm(final)=11.861 | 4720.2 samples/s | 73.8 steps/s
[Step=35000 Epoch=134.7] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=11.861 | 5359.6 samples/s | 83.7 steps/s
[Step=35050 Epoch=134.9] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.200 | L2-Norm(final)=11.861 | 1930.5 samples/s | 30.2 steps/s
[Step=35100 Epoch=135.1] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.187 | L2-Norm(final)=11.861 | 4708.9 samples/s | 73.6 steps/s
[Step=35150 Epoch=135.3] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=11.861 | 4709.9 samples/s | 73.6 steps/s
[Step=35200 Epoch=135.5] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=11.861 | 4739.6 samples/s | 74.1 steps/s
[Step=35250 Epoch=135.7] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=11.862 | 4816.7 samples/s | 75.3 steps/s
[Step=35300 Epoch=135.9] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=11.862 | 1992.5 samples/s | 31.1 steps/s
[Step=35350 Epoch=136.1] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.119 | L2-Norm(final)=11.862 | 4836.2 samples/s | 75.6 steps/s
[Step=35400 Epoch=136.3] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.105 | L2-Norm(final)=11.862 | 4618.0 samples/s | 72.2 steps/s
[Step=35450 Epoch=136.5] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.091 | L2-Norm(final)=11.862 | 4766.7 samples/s | 74.5 steps/s
[Step=35500 Epoch=136.7] | Loss=0.00000 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.077 | L2-Norm(final)=11.862 | 4752.6 samples/s | 74.3 steps/s
[Step=35550 Epoch=136.8] | Loss=0.00000 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.063 | L2-Norm(final)=11.862 | 2031.1 samples/s | 31.7 steps/s
[Step=35600 Epoch=137.0] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.049 | L2-Norm(final)=11.862 | 4766.1 samples/s | 74.5 steps/s
[Step=35650 Epoch=137.2] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.034 | L2-Norm(final)=11.863 | 4709.4 samples/s | 73.6 steps/s
[Step=35700 Epoch=137.4] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.019 | L2-Norm(final)=11.863 | 4671.1 samples/s | 73.0 steps/s
[Step=35750 Epoch=137.6] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.005 | L2-Norm(final)=11.863 | 4795.8 samples/s | 74.9 steps/s
[Step=35800 Epoch=137.8] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.990 | L2-Norm(final)=11.863 | 6785.1 samples/s | 106.0 steps/s
[Step=35850 Epoch=138.0] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.975 | L2-Norm(final)=11.863 | 1770.3 samples/s | 27.7 steps/s
[Step=35900 Epoch=138.2] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.959 | L2-Norm(final)=11.863 | 4729.5 samples/s | 73.9 steps/s
[Step=35950 Epoch=138.4] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.944 | L2-Norm(final)=11.863 | 4744.5 samples/s | 74.1 steps/s
[Step=36000 Epoch=138.6] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.929 | L2-Norm(final)=11.864 | 4626.6 samples/s | 72.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08525 | acc=0.9704 | tpr=0.9800 | fpr=0.0505 | 4367.3 samples/s | 17.1 steps/s
Avg test loss: 0.08717, Avg test acc: 0.96767, Avg tpr: 0.97791, Avg fpr: 0.05486, total FA: 428

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07318 | acc=0.9703 | tpr=0.9777 | fpr=0.0458 | 4363.5 samples/s | 17.0 steps/s
Avg test loss: 0.07685, Avg test acc: 0.96839, Avg tpr: 0.97593, Avg fpr: 0.04820, total FA: 376

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.38829 | acc=0.2962 | tpr=0.0098 | fpr=0.0820 | 4371.5 samples/s | 17.1 steps/s
Avg test loss: 6.39637, Avg test acc: 0.29349, Avg tpr: 0.01043, Avg fpr: 0.08396, total FA: 655

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.67333 | acc=0.2990 | tpr=0.0177 | fpr=0.0902 | 4338.2 samples/s | 16.9 steps/s
Avg test loss: 6.68193, Avg test acc: 0.29630, Avg tpr: 0.01883, Avg fpr: 0.09345, total FA: 729

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.51669 | acc=0.1221 | tpr=0.6991 | fpr=0.8883 | 4338.3 samples/s | 16.9 steps/s
[Step= 100] | Loss=6.50387 | acc=0.1243 | tpr=0.7335 | fpr=0.8871 | 8590.0 samples/s | 33.6 steps/s
[Step= 150] | Loss=6.50651 | acc=0.1231 | tpr=0.7176 | fpr=0.8878 | 8889.2 samples/s | 34.7 steps/s
[Step= 200] | Loss=6.49276 | acc=0.1240 | tpr=0.7158 | fpr=0.8868 | 8459.6 samples/s | 33.0 steps/s
[Step= 250] | Loss=6.49098 | acc=0.1237 | tpr=0.7039 | fpr=0.8868 | 8736.2 samples/s | 34.1 steps/s
[Step= 300] | Loss=6.48510 | acc=0.1243 | tpr=0.7091 | fpr=0.8864 | 8819.2 samples/s | 34.5 steps/s
[Step= 350] | Loss=6.48084 | acc=0.1237 | tpr=0.7126 | fpr=0.8870 | 8744.1 samples/s | 34.2 steps/s
[Step= 400] | Loss=6.47504 | acc=0.1235 | tpr=0.7128 | fpr=0.8872 | 8846.6 samples/s | 34.6 steps/s
[Step= 450] | Loss=6.47108 | acc=0.1235 | tpr=0.7157 | fpr=0.8872 | 8528.3 samples/s | 33.3 steps/s
[Step= 500] | Loss=6.47396 | acc=0.1235 | tpr=0.7194 | fpr=0.8873 | 8552.8 samples/s | 33.4 steps/s
[Step= 550] | Loss=6.47488 | acc=0.1238 | tpr=0.7207 | fpr=0.8870 | 16060.9 samples/s | 62.7 steps/s
Avg test loss: 6.47609, Avg test acc: 0.12367, Avg tpr: 0.72029, Avg fpr: 0.88718, total FA: 123183

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.75469 | acc=0.1431 | tpr=0.6637 | fpr=0.8662 | 4415.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=5.74009 | acc=0.1454 | tpr=0.6887 | fpr=0.8647 | 8879.1 samples/s | 34.7 steps/s
[Step= 150] | Loss=5.74185 | acc=0.1442 | tpr=0.6671 | fpr=0.8654 | 8202.1 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.72739 | acc=0.1450 | tpr=0.6634 | fpr=0.8644 | 8568.8 samples/s | 33.5 steps/s
[Step= 250] | Loss=5.72552 | acc=0.1448 | tpr=0.6472 | fpr=0.8644 | 9273.7 samples/s | 36.2 steps/s
[Step= 300] | Loss=5.72188 | acc=0.1454 | tpr=0.6495 | fpr=0.8638 | 8284.0 samples/s | 32.4 steps/s
[Step= 350] | Loss=5.71651 | acc=0.1451 | tpr=0.6531 | fpr=0.8641 | 8576.6 samples/s | 33.5 steps/s
[Step= 400] | Loss=5.70940 | acc=0.1452 | tpr=0.6543 | fpr=0.8640 | 9084.7 samples/s | 35.5 steps/s
[Step= 450] | Loss=5.70556 | acc=0.1450 | tpr=0.6558 | fpr=0.8643 | 8421.8 samples/s | 32.9 steps/s
[Step= 500] | Loss=5.70795 | acc=0.1449 | tpr=0.6586 | fpr=0.8644 | 8639.8 samples/s | 33.7 steps/s
[Step= 550] | Loss=5.70842 | acc=0.1449 | tpr=0.6550 | fpr=0.8643 | 16267.8 samples/s | 63.5 steps/s
Avg test loss: 5.70943, Avg test acc: 0.14478, Avg tpr: 0.65491, Avg fpr: 0.86449, total FA: 120033

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11171 | acc=0.9827 | tpr=0.9602 | fpr=0.0169 | 4414.7 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.11952 | acc=0.9815 | tpr=0.9680 | fpr=0.0183 | 8270.5 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.12443 | acc=0.9805 | tpr=0.9640 | fpr=0.0192 | 8602.6 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.12473 | acc=0.9808 | tpr=0.9628 | fpr=0.0189 | 8709.8 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.12318 | acc=0.9810 | tpr=0.9633 | fpr=0.0187 | 8629.5 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.12444 | acc=0.9808 | tpr=0.9629 | fpr=0.0189 | 8783.9 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.12525 | acc=0.9806 | tpr=0.9637 | fpr=0.0191 | 8768.4 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.12664 | acc=0.9803 | tpr=0.9606 | fpr=0.0193 | 8577.6 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.12987 | acc=0.9801 | tpr=0.9576 | fpr=0.0195 | 8736.6 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.12911 | acc=0.9801 | tpr=0.9586 | fpr=0.0195 | 8494.9 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.12798 | acc=0.9802 | tpr=0.9582 | fpr=0.0194 | 16037.6 samples/s | 62.6 steps/s
Avg test loss: 0.12766, Avg test acc: 0.98026, Avg tpr: 0.95840, Avg fpr: 0.01934, total FA: 2686

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14603 | acc=0.9807 | tpr=0.9513 | fpr=0.0188 | 4341.5 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.15626 | acc=0.9793 | tpr=0.9680 | fpr=0.0205 | 8740.7 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.16210 | acc=0.9785 | tpr=0.9654 | fpr=0.0213 | 8617.9 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.16256 | acc=0.9790 | tpr=0.9639 | fpr=0.0207 | 9267.3 samples/s | 36.2 steps/s
[Step= 250] | Loss=0.15986 | acc=0.9793 | tpr=0.9633 | fpr=0.0204 | 8452.3 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.16178 | acc=0.9792 | tpr=0.9636 | fpr=0.0205 | 8517.2 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.16266 | acc=0.9791 | tpr=0.9643 | fpr=0.0206 | 8692.9 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.16436 | acc=0.9788 | tpr=0.9612 | fpr=0.0209 | 8926.1 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.16852 | acc=0.9785 | tpr=0.9586 | fpr=0.0211 | 8486.4 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.16785 | acc=0.9784 | tpr=0.9599 | fpr=0.0212 | 8908.0 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.16654 | acc=0.9786 | tpr=0.9598 | fpr=0.0211 | 14760.8 samples/s | 57.7 steps/s
Avg test loss: 0.16616, Avg test acc: 0.97857, Avg tpr: 0.95998, Avg fpr: 0.02109, total FA: 2928

server round 37/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=66.5] | Loss=0.00133 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.817 | L2-Norm(final)=9.026 | 3973.2 samples/s | 62.1 steps/s
[Step=34050 Epoch=66.6] | Loss=0.01019 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.818 | L2-Norm(final)=9.033 | 5302.0 samples/s | 82.8 steps/s
[Step=34100 Epoch=66.7] | Loss=0.01075 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.818 | L2-Norm(final)=9.042 | 5646.0 samples/s | 88.2 steps/s
[Step=34150 Epoch=66.8] | Loss=0.01139 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.818 | L2-Norm(final)=9.051 | 5800.8 samples/s | 90.6 steps/s
[Step=34200 Epoch=66.9] | Loss=0.01101 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.818 | L2-Norm(final)=9.058 | 5564.2 samples/s | 86.9 steps/s
[Step=34250 Epoch=67.0] | Loss=0.01146 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.818 | L2-Norm(final)=9.066 | 5664.9 samples/s | 88.5 steps/s
[Step=34300 Epoch=67.1] | Loss=0.01152 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.818 | L2-Norm(final)=9.072 | 5738.9 samples/s | 89.7 steps/s
[Step=34350 Epoch=67.2] | Loss=0.01112 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.818 | L2-Norm(final)=9.078 | 5701.1 samples/s | 89.1 steps/s
[Step=34400 Epoch=67.3] | Loss=0.01076 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.818 | L2-Norm(final)=9.084 | 5661.2 samples/s | 88.5 steps/s
[Step=34450 Epoch=67.3] | Loss=0.01081 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.818 | L2-Norm(final)=9.090 | 5748.0 samples/s | 89.8 steps/s
[Step=34500 Epoch=67.4] | Loss=0.01105 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.818 | L2-Norm(final)=9.096 | 7291.2 samples/s | 113.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=67.4] | Loss=0.00149 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.818 | L2-Norm(final)=9.152 | 3985.3 samples/s | 62.3 steps/s
[Step=34550 Epoch=67.5] | Loss=0.00839 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.827 | L2-Norm(final)=9.155 | 4630.5 samples/s | 72.4 steps/s
[Step=34600 Epoch=67.6] | Loss=0.00971 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.835 | L2-Norm(final)=9.157 | 4978.5 samples/s | 77.8 steps/s
[Step=34650 Epoch=67.7] | Loss=0.01077 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.842 | L2-Norm(final)=9.158 | 4934.8 samples/s | 77.1 steps/s
[Step=34700 Epoch=67.8] | Loss=0.01134 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.848 | L2-Norm(final)=9.160 | 4943.1 samples/s | 77.2 steps/s
[Step=34750 Epoch=67.9] | Loss=0.01060 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.854 | L2-Norm(final)=9.162 | 5012.3 samples/s | 78.3 steps/s
[Step=34800 Epoch=68.0] | Loss=0.01001 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.859 | L2-Norm(final)=9.165 | 4867.7 samples/s | 76.1 steps/s
[Step=34850 Epoch=68.1] | Loss=0.01008 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.864 | L2-Norm(final)=9.168 | 4999.5 samples/s | 78.1 steps/s
[Step=34900 Epoch=68.2] | Loss=0.01015 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.869 | L2-Norm(final)=9.171 | 4947.4 samples/s | 77.3 steps/s
[Step=34950 Epoch=68.3] | Loss=0.01010 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.874 | L2-Norm(final)=9.173 | 4989.7 samples/s | 78.0 steps/s
[Step=35000 Epoch=68.4] | Loss=0.00992 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.878 | L2-Norm(final)=9.175 | 6125.8 samples/s | 95.7 steps/s
[Step=35050 Epoch=68.5] | Loss=0.00983 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.882 | L2-Norm(final)=9.178 | 1907.7 samples/s | 29.8 steps/s
[Step=35100 Epoch=68.6] | Loss=0.00962 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.886 | L2-Norm(final)=9.180 | 4955.5 samples/s | 77.4 steps/s
[Step=35150 Epoch=68.7] | Loss=0.00939 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.890 | L2-Norm(final)=9.183 | 4960.1 samples/s | 77.5 steps/s
[Step=35200 Epoch=68.8] | Loss=0.00913 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.893 | L2-Norm(final)=9.186 | 4912.1 samples/s | 76.8 steps/s
[Step=35250 Epoch=68.9] | Loss=0.00901 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.896 | L2-Norm(final)=9.188 | 4929.9 samples/s | 77.0 steps/s
[Step=35300 Epoch=69.0] | Loss=0.00893 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.899 | L2-Norm(final)=9.191 | 4991.4 samples/s | 78.0 steps/s
[Step=35350 Epoch=69.1] | Loss=0.00893 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=9.193 | 4929.1 samples/s | 77.0 steps/s
[Step=35400 Epoch=69.2] | Loss=0.00878 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.905 | L2-Norm(final)=9.195 | 4993.8 samples/s | 78.0 steps/s
[Step=35450 Epoch=69.3] | Loss=0.00866 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.908 | L2-Norm(final)=9.197 | 4966.2 samples/s | 77.6 steps/s
[Step=35500 Epoch=69.4] | Loss=0.00847 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.910 | L2-Norm(final)=9.199 | 5353.0 samples/s | 83.6 steps/s
[Step=35550 Epoch=69.5] | Loss=0.00827 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.913 | L2-Norm(final)=9.201 | 1990.6 samples/s | 31.1 steps/s
[Step=35600 Epoch=69.6] | Loss=0.00813 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.915 | L2-Norm(final)=9.204 | 4981.7 samples/s | 77.8 steps/s
[Step=35650 Epoch=69.7] | Loss=0.00812 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.918 | L2-Norm(final)=9.206 | 4941.9 samples/s | 77.2 steps/s
[Step=35700 Epoch=69.8] | Loss=0.00803 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.920 | L2-Norm(final)=9.208 | 4888.1 samples/s | 76.4 steps/s
[Step=35750 Epoch=69.9] | Loss=0.00791 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.923 | L2-Norm(final)=9.210 | 4980.6 samples/s | 77.8 steps/s
[Step=35800 Epoch=70.0] | Loss=0.00789 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.925 | L2-Norm(final)=9.212 | 4915.3 samples/s | 76.8 steps/s
[Step=35850 Epoch=70.1] | Loss=0.00782 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.927 | L2-Norm(final)=9.214 | 4995.7 samples/s | 78.1 steps/s
[Step=35900 Epoch=70.2] | Loss=0.00776 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.930 | L2-Norm(final)=9.216 | 4987.3 samples/s | 77.9 steps/s
[Step=35950 Epoch=70.3] | Loss=0.00771 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.932 | L2-Norm(final)=9.218 | 5010.1 samples/s | 78.3 steps/s
[Step=36000 Epoch=70.4] | Loss=0.00761 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.934 | L2-Norm(final)=9.220 | 4940.8 samples/s | 77.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step36000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=36001 Epoch=138.6] | Loss=0.00010 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.817 | L2-Norm(final)=11.869 | 3762.2 samples/s | 58.8 steps/s
[Step=36050 Epoch=138.8] | Loss=0.00020 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.812 | L2-Norm(final)=11.874 | 5116.3 samples/s | 79.9 steps/s
[Step=36100 Epoch=139.0] | Loss=0.00023 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.811 | L2-Norm(final)=11.887 | 5569.4 samples/s | 87.0 steps/s
[Step=36150 Epoch=139.2] | Loss=0.00022 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.811 | L2-Norm(final)=11.897 | 5169.0 samples/s | 80.8 steps/s
[Step=36200 Epoch=139.3] | Loss=0.00023 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.811 | L2-Norm(final)=11.906 | 5300.0 samples/s | 82.8 steps/s
[Step=36250 Epoch=139.5] | Loss=0.00020 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=11.914 | 7280.6 samples/s | 113.8 steps/s
[Step=36300 Epoch=139.7] | Loss=0.00018 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=11.921 | 1965.2 samples/s | 30.7 steps/s
[Step=36350 Epoch=139.9] | Loss=0.00018 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=11.927 | 5264.6 samples/s | 82.3 steps/s
[Step=36400 Epoch=140.1] | Loss=0.00018 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=11.933 | 5371.5 samples/s | 83.9 steps/s
[Step=36450 Epoch=140.3] | Loss=0.00018 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=11.940 | 5379.2 samples/s | 84.0 steps/s
[Step=36500 Epoch=140.5] | Loss=0.00017 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=11.946 | 6165.7 samples/s | 96.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=140.5] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=12.004 | 3832.6 samples/s | 59.9 steps/s
[Step=36550 Epoch=140.7] | Loss=0.00002 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.797 | L2-Norm(final)=12.005 | 4483.9 samples/s | 70.1 steps/s
[Step=36600 Epoch=140.9] | Loss=0.00002 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.777 | L2-Norm(final)=12.006 | 4743.2 samples/s | 74.1 steps/s
[Step=36650 Epoch=141.1] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.755 | L2-Norm(final)=12.006 | 4677.9 samples/s | 73.1 steps/s
[Step=36700 Epoch=141.3] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.731 | L2-Norm(final)=12.007 | 4728.3 samples/s | 73.9 steps/s
[Step=36750 Epoch=141.5] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.707 | L2-Norm(final)=12.007 | 6066.2 samples/s | 94.8 steps/s
[Step=36800 Epoch=141.7] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=12.007 | 1857.2 samples/s | 29.0 steps/s
[Step=36850 Epoch=141.9] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.658 | L2-Norm(final)=12.007 | 4688.6 samples/s | 73.3 steps/s
[Step=36900 Epoch=142.0] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.633 | L2-Norm(final)=12.007 | 4731.2 samples/s | 73.9 steps/s
[Step=36950 Epoch=142.2] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.608 | L2-Norm(final)=12.008 | 4752.2 samples/s | 74.3 steps/s
[Step=37000 Epoch=142.4] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.583 | L2-Norm(final)=12.008 | 5307.0 samples/s | 82.9 steps/s
[Step=37050 Epoch=142.6] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.558 | L2-Norm(final)=12.008 | 1916.1 samples/s | 29.9 steps/s
[Step=37100 Epoch=142.8] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.532 | L2-Norm(final)=12.008 | 4743.5 samples/s | 74.1 steps/s
[Step=37150 Epoch=143.0] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=12.008 | 4688.2 samples/s | 73.3 steps/s
[Step=37200 Epoch=143.2] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.481 | L2-Norm(final)=12.009 | 4695.3 samples/s | 73.4 steps/s
[Step=37250 Epoch=143.4] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.455 | L2-Norm(final)=12.009 | 4835.6 samples/s | 75.6 steps/s
[Step=37300 Epoch=143.6] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=12.009 | 2001.0 samples/s | 31.3 steps/s
[Step=37350 Epoch=143.8] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.403 | L2-Norm(final)=12.009 | 4692.3 samples/s | 73.3 steps/s
[Step=37400 Epoch=144.0] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.377 | L2-Norm(final)=12.009 | 4709.1 samples/s | 73.6 steps/s
[Step=37450 Epoch=144.2] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.351 | L2-Norm(final)=12.009 | 4756.7 samples/s | 74.3 steps/s
[Step=37500 Epoch=144.4] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.325 | L2-Norm(final)=12.010 | 4737.3 samples/s | 74.0 steps/s
[Step=37550 Epoch=144.5] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.298 | L2-Norm(final)=12.010 | 2007.3 samples/s | 31.4 steps/s
[Step=37600 Epoch=144.7] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.272 | L2-Norm(final)=12.010 | 4764.6 samples/s | 74.4 steps/s
[Step=37650 Epoch=144.9] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=12.010 | 4631.2 samples/s | 72.4 steps/s
[Step=37700 Epoch=145.1] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=12.011 | 4822.0 samples/s | 75.3 steps/s
[Step=37750 Epoch=145.3] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=12.011 | 4639.0 samples/s | 72.5 steps/s
[Step=37800 Epoch=145.5] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.164 | L2-Norm(final)=12.011 | 6913.7 samples/s | 108.0 steps/s
[Step=37850 Epoch=145.7] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.137 | L2-Norm(final)=12.012 | 1775.5 samples/s | 27.7 steps/s
[Step=37900 Epoch=145.9] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.110 | L2-Norm(final)=12.012 | 4810.5 samples/s | 75.2 steps/s
[Step=37950 Epoch=146.1] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.083 | L2-Norm(final)=12.012 | 4636.1 samples/s | 72.4 steps/s
[Step=38000 Epoch=146.3] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.055 | L2-Norm(final)=12.013 | 4764.1 samples/s | 74.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step38000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08525 | acc=0.9704 | tpr=0.9800 | fpr=0.0505 | 4331.7 samples/s | 16.9 steps/s
Avg test loss: 0.08717, Avg test acc: 0.96767, Avg tpr: 0.97791, Avg fpr: 0.05486, total FA: 428

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07302 | acc=0.9697 | tpr=0.9807 | fpr=0.0543 | 4374.9 samples/s | 17.1 steps/s
Avg test loss: 0.07678, Avg test acc: 0.96819, Avg tpr: 0.98047, Avg fpr: 0.05884, total FA: 459

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.38829 | acc=0.2962 | tpr=0.0098 | fpr=0.0820 | 4334.3 samples/s | 16.9 steps/s
Avg test loss: 6.39637, Avg test acc: 0.29349, Avg tpr: 0.01043, Avg fpr: 0.08396, total FA: 655

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.18633 | acc=0.2995 | tpr=0.0115 | fpr=0.0751 | 4494.4 samples/s | 17.6 steps/s
Avg test loss: 6.19639, Avg test acc: 0.29714, Avg tpr: 0.01265, Avg fpr: 0.07717, total FA: 602

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.51669 | acc=0.1221 | tpr=0.6991 | fpr=0.8883 | 4421.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=6.50387 | acc=0.1243 | tpr=0.7335 | fpr=0.8871 | 8287.3 samples/s | 32.4 steps/s
[Step= 150] | Loss=6.50651 | acc=0.1231 | tpr=0.7176 | fpr=0.8878 | 9062.9 samples/s | 35.4 steps/s
[Step= 200] | Loss=6.49276 | acc=0.1240 | tpr=0.7158 | fpr=0.8868 | 8412.3 samples/s | 32.9 steps/s
[Step= 250] | Loss=6.49098 | acc=0.1237 | tpr=0.7039 | fpr=0.8868 | 8616.8 samples/s | 33.7 steps/s
[Step= 300] | Loss=6.48510 | acc=0.1243 | tpr=0.7091 | fpr=0.8864 | 8837.6 samples/s | 34.5 steps/s
[Step= 350] | Loss=6.48084 | acc=0.1237 | tpr=0.7126 | fpr=0.8870 | 8605.8 samples/s | 33.6 steps/s
[Step= 400] | Loss=6.47504 | acc=0.1235 | tpr=0.7128 | fpr=0.8872 | 8483.5 samples/s | 33.1 steps/s
[Step= 450] | Loss=6.47108 | acc=0.1235 | tpr=0.7157 | fpr=0.8872 | 8820.7 samples/s | 34.5 steps/s
[Step= 500] | Loss=6.47396 | acc=0.1235 | tpr=0.7194 | fpr=0.8873 | 8794.9 samples/s | 34.4 steps/s
[Step= 550] | Loss=6.47488 | acc=0.1238 | tpr=0.7207 | fpr=0.8870 | 15428.0 samples/s | 60.3 steps/s
Avg test loss: 6.47609, Avg test acc: 0.12367, Avg tpr: 0.72029, Avg fpr: 0.88718, total FA: 123183

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.84931 | acc=0.1216 | tpr=0.6903 | fpr=0.8886 | 4358.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.83127 | acc=0.1247 | tpr=0.6994 | fpr=0.8860 | 8918.1 samples/s | 34.8 steps/s
[Step= 150] | Loss=5.83161 | acc=0.1240 | tpr=0.6873 | fpr=0.8864 | 8329.4 samples/s | 32.5 steps/s
[Step= 200] | Loss=5.81891 | acc=0.1252 | tpr=0.6798 | fpr=0.8849 | 8662.7 samples/s | 33.8 steps/s
[Step= 250] | Loss=5.81802 | acc=0.1250 | tpr=0.6681 | fpr=0.8849 | 8485.2 samples/s | 33.1 steps/s
[Step= 300] | Loss=5.81485 | acc=0.1255 | tpr=0.6720 | fpr=0.8845 | 9290.5 samples/s | 36.3 steps/s
[Step= 350] | Loss=5.81097 | acc=0.1251 | tpr=0.6763 | fpr=0.8849 | 8343.8 samples/s | 32.6 steps/s
[Step= 400] | Loss=5.80594 | acc=0.1248 | tpr=0.6778 | fpr=0.8853 | 8533.9 samples/s | 33.3 steps/s
[Step= 450] | Loss=5.80283 | acc=0.1247 | tpr=0.6826 | fpr=0.8854 | 8725.3 samples/s | 34.1 steps/s
[Step= 500] | Loss=5.80554 | acc=0.1247 | tpr=0.6855 | fpr=0.8854 | 8568.6 samples/s | 33.5 steps/s
[Step= 550] | Loss=5.80546 | acc=0.1247 | tpr=0.6848 | fpr=0.8855 | 15652.8 samples/s | 61.1 steps/s
Avg test loss: 5.80656, Avg test acc: 0.12454, Avg tpr: 0.68463, Avg fpr: 0.88564, total FA: 122969

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11171 | acc=0.9827 | tpr=0.9602 | fpr=0.0169 | 4321.8 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.11952 | acc=0.9815 | tpr=0.9680 | fpr=0.0183 | 8810.1 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.12443 | acc=0.9805 | tpr=0.9640 | fpr=0.0192 | 8538.4 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.12473 | acc=0.9808 | tpr=0.9628 | fpr=0.0189 | 8632.7 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.12318 | acc=0.9810 | tpr=0.9633 | fpr=0.0187 | 9194.8 samples/s | 35.9 steps/s
[Step= 300] | Loss=0.12444 | acc=0.9808 | tpr=0.9629 | fpr=0.0189 | 8396.5 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.12525 | acc=0.9806 | tpr=0.9637 | fpr=0.0191 | 8398.7 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.12664 | acc=0.9803 | tpr=0.9606 | fpr=0.0193 | 9280.6 samples/s | 36.3 steps/s
[Step= 450] | Loss=0.12987 | acc=0.9801 | tpr=0.9576 | fpr=0.0195 | 8275.7 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.12911 | acc=0.9801 | tpr=0.9586 | fpr=0.0195 | 8806.3 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.12798 | acc=0.9802 | tpr=0.9582 | fpr=0.0194 | 14974.8 samples/s | 58.5 steps/s
Avg test loss: 0.12766, Avg test acc: 0.98026, Avg tpr: 0.95840, Avg fpr: 0.01934, total FA: 2686

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12410 | acc=0.9812 | tpr=0.9558 | fpr=0.0183 | 4312.6 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.13303 | acc=0.9801 | tpr=0.9680 | fpr=0.0197 | 8775.7 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.13822 | acc=0.9792 | tpr=0.9654 | fpr=0.0205 | 8649.6 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.13855 | acc=0.9796 | tpr=0.9650 | fpr=0.0201 | 8727.9 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.13636 | acc=0.9799 | tpr=0.9651 | fpr=0.0198 | 8719.8 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.13807 | acc=0.9797 | tpr=0.9636 | fpr=0.0200 | 8825.5 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.13885 | acc=0.9795 | tpr=0.9643 | fpr=0.0202 | 8619.9 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.14031 | acc=0.9792 | tpr=0.9601 | fpr=0.0204 | 8457.6 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.14379 | acc=0.9790 | tpr=0.9576 | fpr=0.0206 | 8538.4 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.14314 | acc=0.9790 | tpr=0.9586 | fpr=0.0206 | 8698.8 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.14186 | acc=0.9791 | tpr=0.9582 | fpr=0.0205 | 16345.8 samples/s | 63.9 steps/s
Avg test loss: 0.14152, Avg test acc: 0.97911, Avg tpr: 0.95840, Avg fpr: 0.02051, total FA: 2848

server round 38/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=36001 Epoch=70.4] | Loss=0.02288 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.327 | L2-Norm(final)=9.283 | 3946.9 samples/s | 61.7 steps/s
[Step=36050 Epoch=70.5] | Loss=0.01220 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.327 | L2-Norm(final)=9.286 | 5238.2 samples/s | 81.8 steps/s
[Step=36100 Epoch=70.6] | Loss=0.01304 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.327 | L2-Norm(final)=9.292 | 5662.9 samples/s | 88.5 steps/s
[Step=36150 Epoch=70.7] | Loss=0.01327 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.327 | L2-Norm(final)=9.299 | 5653.5 samples/s | 88.3 steps/s
[Step=36200 Epoch=70.8] | Loss=0.01316 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.327 | L2-Norm(final)=9.307 | 5640.7 samples/s | 88.1 steps/s
[Step=36250 Epoch=70.9] | Loss=0.01286 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.327 | L2-Norm(final)=9.314 | 5704.8 samples/s | 89.1 steps/s
[Step=36300 Epoch=71.0] | Loss=0.01275 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=9.320 | 5710.7 samples/s | 89.2 steps/s
[Step=36350 Epoch=71.1] | Loss=0.01266 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=9.326 | 5638.8 samples/s | 88.1 steps/s
[Step=36400 Epoch=71.2] | Loss=0.01245 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=9.332 | 5576.8 samples/s | 87.1 steps/s
[Step=36450 Epoch=71.3] | Loss=0.01261 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=9.338 | 5680.4 samples/s | 88.8 steps/s
[Step=36500 Epoch=71.4] | Loss=0.01239 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=9.343 | 7349.9 samples/s | 114.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=71.4] | Loss=0.02232 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.327 | L2-Norm(final)=9.400 | 3934.0 samples/s | 61.5 steps/s
[Step=36550 Epoch=71.5] | Loss=0.01321 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.339 | L2-Norm(final)=9.403 | 4665.2 samples/s | 72.9 steps/s
[Step=36600 Epoch=71.6] | Loss=0.01306 | Reg=0.00129 | acc=0.9531 | L2-Norm=11.350 | L2-Norm(final)=9.405 | 4970.4 samples/s | 77.7 steps/s
[Step=36650 Epoch=71.6] | Loss=0.01291 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.359 | L2-Norm(final)=9.408 | 4952.1 samples/s | 77.4 steps/s
[Step=36700 Epoch=71.7] | Loss=0.01251 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.366 | L2-Norm(final)=9.411 | 4916.1 samples/s | 76.8 steps/s
[Step=36750 Epoch=71.8] | Loss=0.01198 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.373 | L2-Norm(final)=9.414 | 4930.9 samples/s | 77.0 steps/s
[Step=36800 Epoch=71.9] | Loss=0.01176 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.379 | L2-Norm(final)=9.418 | 4937.3 samples/s | 77.1 steps/s
[Step=36850 Epoch=72.0] | Loss=0.01148 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.385 | L2-Norm(final)=9.421 | 4955.8 samples/s | 77.4 steps/s
[Step=36900 Epoch=72.1] | Loss=0.01121 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.390 | L2-Norm(final)=9.425 | 4950.4 samples/s | 77.4 steps/s
[Step=36950 Epoch=72.2] | Loss=0.01098 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.396 | L2-Norm(final)=9.428 | 5035.7 samples/s | 78.7 steps/s
[Step=37000 Epoch=72.3] | Loss=0.01088 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.401 | L2-Norm(final)=9.431 | 6039.8 samples/s | 94.4 steps/s
[Step=37050 Epoch=72.4] | Loss=0.01047 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=9.434 | 1910.6 samples/s | 29.9 steps/s
[Step=37100 Epoch=72.5] | Loss=0.01023 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.410 | L2-Norm(final)=9.438 | 4925.6 samples/s | 77.0 steps/s
[Step=37150 Epoch=72.6] | Loss=0.00988 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.414 | L2-Norm(final)=9.441 | 4859.7 samples/s | 75.9 steps/s
[Step=37200 Epoch=72.7] | Loss=0.00966 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.418 | L2-Norm(final)=9.444 | 4954.2 samples/s | 77.4 steps/s
[Step=37250 Epoch=72.8] | Loss=0.00951 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.422 | L2-Norm(final)=9.447 | 4921.0 samples/s | 76.9 steps/s
[Step=37300 Epoch=72.9] | Loss=0.00933 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.426 | L2-Norm(final)=9.451 | 4989.0 samples/s | 78.0 steps/s
[Step=37350 Epoch=73.0] | Loss=0.00921 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=9.453 | 4874.6 samples/s | 76.2 steps/s
[Step=37400 Epoch=73.1] | Loss=0.00916 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=9.456 | 4957.9 samples/s | 77.5 steps/s
[Step=37450 Epoch=73.2] | Loss=0.00910 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.436 | L2-Norm(final)=9.459 | 5050.6 samples/s | 78.9 steps/s
[Step=37500 Epoch=73.3] | Loss=0.00910 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.439 | L2-Norm(final)=9.461 | 5276.2 samples/s | 82.4 steps/s
[Step=37550 Epoch=73.4] | Loss=0.00894 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.442 | L2-Norm(final)=9.464 | 2017.7 samples/s | 31.5 steps/s
[Step=37600 Epoch=73.5] | Loss=0.00876 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.445 | L2-Norm(final)=9.466 | 4899.1 samples/s | 76.5 steps/s
[Step=37650 Epoch=73.6] | Loss=0.00866 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.448 | L2-Norm(final)=9.469 | 4910.9 samples/s | 76.7 steps/s
[Step=37700 Epoch=73.7] | Loss=0.00858 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.451 | L2-Norm(final)=9.471 | 4955.6 samples/s | 77.4 steps/s
[Step=37750 Epoch=73.8] | Loss=0.00852 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.453 | L2-Norm(final)=9.474 | 5010.8 samples/s | 78.3 steps/s
[Step=37800 Epoch=73.9] | Loss=0.00842 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.456 | L2-Norm(final)=9.476 | 4854.8 samples/s | 75.9 steps/s
[Step=37850 Epoch=74.0] | Loss=0.00840 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.458 | L2-Norm(final)=9.479 | 4978.2 samples/s | 77.8 steps/s
[Step=37900 Epoch=74.1] | Loss=0.00831 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.461 | L2-Norm(final)=9.481 | 4973.7 samples/s | 77.7 steps/s
[Step=37950 Epoch=74.2] | Loss=0.00819 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.463 | L2-Norm(final)=9.483 | 5007.8 samples/s | 78.2 steps/s
[Step=38000 Epoch=74.3] | Loss=0.00808 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.466 | L2-Norm(final)=9.486 | 4954.9 samples/s | 77.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step38000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=130.3] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=10.814 | 3959.9 samples/s | 61.9 steps/s
[Step=34050 Epoch=130.5] | Loss=0.00007 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.317 | L2-Norm(final)=10.829 | 4782.5 samples/s | 74.7 steps/s
[Step=34100 Epoch=130.7] | Loss=0.00005 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.316 | L2-Norm(final)=10.841 | 5355.2 samples/s | 83.7 steps/s
[Step=34150 Epoch=130.9] | Loss=0.00005 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=10.852 | 5369.2 samples/s | 83.9 steps/s
[Step=34200 Epoch=131.0] | Loss=0.00006 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=10.865 | 5390.2 samples/s | 84.2 steps/s
[Step=34250 Epoch=131.2] | Loss=0.00005 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=10.877 | 6983.4 samples/s | 109.1 steps/s
[Step=34300 Epoch=131.4] | Loss=0.00005 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=10.888 | 1920.1 samples/s | 30.0 steps/s
[Step=34350 Epoch=131.6] | Loss=0.00005 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=10.898 | 5327.1 samples/s | 83.2 steps/s
[Step=34400 Epoch=131.8] | Loss=0.00005 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=10.908 | 5409.8 samples/s | 84.5 steps/s
[Step=34450 Epoch=132.0] | Loss=0.00005 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=10.917 | 5354.0 samples/s | 83.7 steps/s
[Step=34500 Epoch=132.2] | Loss=0.00005 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=10.926 | 5956.3 samples/s | 93.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=132.2] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.314 | L2-Norm(final)=11.017 | 3652.8 samples/s | 57.1 steps/s
[Step=34550 Epoch=132.4] | Loss=0.00002 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=11.021 | 4693.8 samples/s | 73.3 steps/s
[Step=34600 Epoch=132.6] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.263 | L2-Norm(final)=11.024 | 4753.1 samples/s | 74.3 steps/s
[Step=34650 Epoch=132.8] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.238 | L2-Norm(final)=11.027 | 4653.5 samples/s | 72.7 steps/s
[Step=34700 Epoch=133.0] | Loss=0.00056 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.225 | L2-Norm(final)=11.029 | 4770.8 samples/s | 74.5 steps/s
[Step=34750 Epoch=133.1] | Loss=0.00061 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.223 | L2-Norm(final)=11.027 | 5840.5 samples/s | 91.3 steps/s
[Step=34800 Epoch=133.3] | Loss=0.00052 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.223 | L2-Norm(final)=11.026 | 1838.6 samples/s | 28.7 steps/s
[Step=34850 Epoch=133.5] | Loss=0.00045 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.223 | L2-Norm(final)=11.026 | 4667.1 samples/s | 72.9 steps/s
[Step=34900 Epoch=133.7] | Loss=0.00039 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.222 | L2-Norm(final)=11.025 | 4706.2 samples/s | 73.5 steps/s
[Step=34950 Epoch=133.9] | Loss=0.00035 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.221 | L2-Norm(final)=11.025 | 4742.8 samples/s | 74.1 steps/s
[Step=35000 Epoch=134.1] | Loss=0.00032 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.221 | L2-Norm(final)=11.025 | 5117.4 samples/s | 80.0 steps/s
[Step=35050 Epoch=134.3] | Loss=0.00029 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.220 | L2-Norm(final)=11.025 | 1935.4 samples/s | 30.2 steps/s
[Step=35100 Epoch=134.5] | Loss=0.00026 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.219 | L2-Norm(final)=11.025 | 4693.6 samples/s | 73.3 steps/s
[Step=35150 Epoch=134.7] | Loss=0.00024 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.217 | L2-Norm(final)=11.025 | 4759.1 samples/s | 74.4 steps/s
[Step=35200 Epoch=134.9] | Loss=0.00023 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.216 | L2-Norm(final)=11.026 | 4681.4 samples/s | 73.1 steps/s
[Step=35250 Epoch=135.1] | Loss=0.00021 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=11.026 | 4722.4 samples/s | 73.8 steps/s
[Step=35300 Epoch=135.3] | Loss=0.00020 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.214 | L2-Norm(final)=11.026 | 2005.6 samples/s | 31.3 steps/s
[Step=35350 Epoch=135.4] | Loss=0.00019 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.212 | L2-Norm(final)=11.027 | 4702.5 samples/s | 73.5 steps/s
[Step=35400 Epoch=135.6] | Loss=0.00018 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.211 | L2-Norm(final)=11.027 | 4691.6 samples/s | 73.3 steps/s
[Step=35450 Epoch=135.8] | Loss=0.00017 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.210 | L2-Norm(final)=11.028 | 4689.5 samples/s | 73.3 steps/s
[Step=35500 Epoch=136.0] | Loss=0.00016 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.208 | L2-Norm(final)=11.028 | 4783.9 samples/s | 74.7 steps/s
[Step=35550 Epoch=136.2] | Loss=0.00015 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.207 | L2-Norm(final)=11.029 | 2011.3 samples/s | 31.4 steps/s
[Step=35600 Epoch=136.4] | Loss=0.00015 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=11.029 | 4695.8 samples/s | 73.4 steps/s
[Step=35650 Epoch=136.6] | Loss=0.00014 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.204 | L2-Norm(final)=11.030 | 4648.0 samples/s | 72.6 steps/s
[Step=35700 Epoch=136.8] | Loss=0.00013 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.202 | L2-Norm(final)=11.031 | 4742.8 samples/s | 74.1 steps/s
[Step=35750 Epoch=137.0] | Loss=0.00013 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.201 | L2-Norm(final)=11.031 | 4672.4 samples/s | 73.0 steps/s
[Step=35800 Epoch=137.2] | Loss=0.00012 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.199 | L2-Norm(final)=11.032 | 6166.2 samples/s | 96.3 steps/s
[Step=35850 Epoch=137.4] | Loss=0.00012 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.197 | L2-Norm(final)=11.033 | 1801.8 samples/s | 28.2 steps/s
[Step=35900 Epoch=137.6] | Loss=0.00012 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.196 | L2-Norm(final)=11.033 | 4523.4 samples/s | 70.7 steps/s
[Step=35950 Epoch=137.7] | Loss=0.00011 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=11.034 | 4595.6 samples/s | 71.8 steps/s
[Step=36000 Epoch=137.9] | Loss=0.00011 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.192 | L2-Norm(final)=11.034 | 4658.8 samples/s | 72.8 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08525 | acc=0.9704 | tpr=0.9800 | fpr=0.0505 | 4325.4 samples/s | 16.9 steps/s
Avg test loss: 0.08717, Avg test acc: 0.96767, Avg tpr: 0.97791, Avg fpr: 0.05486, total FA: 428

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07126 | acc=0.9680 | tpr=0.9709 | fpr=0.0382 | 4304.7 samples/s | 16.8 steps/s
Avg test loss: 0.07532, Avg test acc: 0.96594, Avg tpr: 0.96952, Avg fpr: 0.04192, total FA: 327

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.55520 | acc=0.2955 | tpr=0.0073 | fpr=0.0788 | 4377.1 samples/s | 17.1 steps/s
Avg test loss: 6.55520, Avg test acc: 0.29229, Avg tpr: 0.00863, Avg fpr: 0.08384, total FA: 654

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.18633 | acc=0.2995 | tpr=0.0115 | fpr=0.0751 | 4325.9 samples/s | 16.9 steps/s
Avg test loss: 6.19639, Avg test acc: 0.29714, Avg tpr: 0.01265, Avg fpr: 0.07717, total FA: 602

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.51669 | acc=0.1221 | tpr=0.6991 | fpr=0.8883 | 4398.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=6.50387 | acc=0.1243 | tpr=0.7335 | fpr=0.8871 | 8385.3 samples/s | 32.8 steps/s
[Step= 150] | Loss=6.50651 | acc=0.1231 | tpr=0.7176 | fpr=0.8878 | 8967.5 samples/s | 35.0 steps/s
[Step= 200] | Loss=6.49276 | acc=0.1240 | tpr=0.7158 | fpr=0.8868 | 8610.6 samples/s | 33.6 steps/s
[Step= 250] | Loss=6.49098 | acc=0.1237 | tpr=0.7039 | fpr=0.8868 | 8905.0 samples/s | 34.8 steps/s
[Step= 300] | Loss=6.48510 | acc=0.1243 | tpr=0.7091 | fpr=0.8864 | 8491.6 samples/s | 33.2 steps/s
[Step= 350] | Loss=6.48084 | acc=0.1237 | tpr=0.7126 | fpr=0.8870 | 8583.6 samples/s | 33.5 steps/s
[Step= 400] | Loss=6.47504 | acc=0.1235 | tpr=0.7128 | fpr=0.8872 | 8686.3 samples/s | 33.9 steps/s
[Step= 450] | Loss=6.47108 | acc=0.1235 | tpr=0.7157 | fpr=0.8872 | 8903.2 samples/s | 34.8 steps/s
[Step= 500] | Loss=6.47396 | acc=0.1235 | tpr=0.7194 | fpr=0.8873 | 8647.8 samples/s | 33.8 steps/s
[Step= 550] | Loss=6.47488 | acc=0.1238 | tpr=0.7207 | fpr=0.8870 | 15681.2 samples/s | 61.3 steps/s
Avg test loss: 6.47609, Avg test acc: 0.12367, Avg tpr: 0.72029, Avg fpr: 0.88718, total FA: 123183

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.96672 | acc=0.1459 | tpr=0.5841 | fpr=0.8620 | 4321.4 samples/s | 16.9 steps/s
[Step= 100] | Loss=4.94955 | acc=0.1483 | tpr=0.6013 | fpr=0.8602 | 9081.2 samples/s | 35.5 steps/s
[Step= 150] | Loss=4.94855 | acc=0.1482 | tpr=0.5836 | fpr=0.8598 | 8504.7 samples/s | 33.2 steps/s
[Step= 200] | Loss=4.93666 | acc=0.1485 | tpr=0.5760 | fpr=0.8593 | 8770.4 samples/s | 34.3 steps/s
[Step= 250] | Loss=4.93519 | acc=0.1491 | tpr=0.5668 | fpr=0.8585 | 8683.3 samples/s | 33.9 steps/s
[Step= 300] | Loss=4.93219 | acc=0.1494 | tpr=0.5702 | fpr=0.8583 | 8621.7 samples/s | 33.7 steps/s
[Step= 350] | Loss=4.92808 | acc=0.1489 | tpr=0.5711 | fpr=0.8588 | 8634.7 samples/s | 33.7 steps/s
[Step= 400] | Loss=4.92272 | acc=0.1490 | tpr=0.5739 | fpr=0.8587 | 8760.3 samples/s | 34.2 steps/s
[Step= 450] | Loss=4.91908 | acc=0.1492 | tpr=0.5784 | fpr=0.8586 | 9148.9 samples/s | 35.7 steps/s
[Step= 500] | Loss=4.92111 | acc=0.1492 | tpr=0.5797 | fpr=0.8586 | 8171.4 samples/s | 31.9 steps/s
[Step= 550] | Loss=4.92137 | acc=0.1493 | tpr=0.5770 | fpr=0.8585 | 15799.4 samples/s | 61.7 steps/s
Avg test loss: 4.92233, Avg test acc: 0.14916, Avg tpr: 0.57686, Avg fpr: 0.85862, total FA: 119217

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12095 | acc=0.9812 | tpr=0.9336 | fpr=0.0179 | 4354.3 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.12999 | acc=0.9796 | tpr=0.9574 | fpr=0.0200 | 8709.9 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.13489 | acc=0.9784 | tpr=0.9568 | fpr=0.0212 | 8611.5 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.13506 | acc=0.9790 | tpr=0.9607 | fpr=0.0207 | 9096.7 samples/s | 35.5 steps/s
[Step= 250] | Loss=0.13306 | acc=0.9794 | tpr=0.9624 | fpr=0.0203 | 8164.3 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.13512 | acc=0.9792 | tpr=0.9629 | fpr=0.0205 | 8781.6 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.13615 | acc=0.9791 | tpr=0.9643 | fpr=0.0207 | 8605.0 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.13801 | acc=0.9787 | tpr=0.9595 | fpr=0.0210 | 8723.5 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.14100 | acc=0.9785 | tpr=0.9562 | fpr=0.0211 | 8805.2 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.14056 | acc=0.9785 | tpr=0.9568 | fpr=0.0211 | 8602.3 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.13943 | acc=0.9786 | tpr=0.9566 | fpr=0.0210 | 15753.8 samples/s | 61.5 steps/s
Avg test loss: 0.13910, Avg test acc: 0.97862, Avg tpr: 0.95681, Avg fpr: 0.02098, total FA: 2913

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12410 | acc=0.9812 | tpr=0.9558 | fpr=0.0183 | 4354.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.13303 | acc=0.9801 | tpr=0.9680 | fpr=0.0197 | 8563.3 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.13822 | acc=0.9792 | tpr=0.9654 | fpr=0.0205 | 8780.3 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.13855 | acc=0.9796 | tpr=0.9650 | fpr=0.0201 | 8507.6 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.13636 | acc=0.9799 | tpr=0.9651 | fpr=0.0198 | 8952.8 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.13807 | acc=0.9797 | tpr=0.9636 | fpr=0.0200 | 8486.2 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.13885 | acc=0.9795 | tpr=0.9643 | fpr=0.0202 | 8773.7 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.14031 | acc=0.9792 | tpr=0.9601 | fpr=0.0204 | 8665.0 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.14379 | acc=0.9790 | tpr=0.9576 | fpr=0.0206 | 8619.0 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.14314 | acc=0.9790 | tpr=0.9586 | fpr=0.0206 | 8770.7 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.14186 | acc=0.9791 | tpr=0.9582 | fpr=0.0205 | 15392.6 samples/s | 60.1 steps/s
Avg test loss: 0.14152, Avg test acc: 0.97911, Avg tpr: 0.95840, Avg fpr: 0.02051, total FA: 2848

server round 39/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=38001 Epoch=74.3] | Loss=0.00807 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=9.553 | 3675.5 samples/s | 57.4 steps/s
[Step=38050 Epoch=74.4] | Loss=0.01117 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.370 | L2-Norm(final)=9.558 | 5747.1 samples/s | 89.8 steps/s
[Step=38100 Epoch=74.5] | Loss=0.01032 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=9.564 | 5689.9 samples/s | 88.9 steps/s
[Step=38150 Epoch=74.6] | Loss=0.01071 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.370 | L2-Norm(final)=9.572 | 5663.1 samples/s | 88.5 steps/s
[Step=38200 Epoch=74.7] | Loss=0.01125 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.370 | L2-Norm(final)=9.578 | 5836.1 samples/s | 91.2 steps/s
[Step=38250 Epoch=74.8] | Loss=0.01117 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=9.584 | 5583.5 samples/s | 87.2 steps/s
[Step=38300 Epoch=74.9] | Loss=0.01111 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=9.590 | 5818.4 samples/s | 90.9 steps/s
[Step=38350 Epoch=75.0] | Loss=0.01109 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=9.596 | 5581.5 samples/s | 87.2 steps/s
[Step=38400 Epoch=75.1] | Loss=0.01139 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.370 | L2-Norm(final)=9.602 | 5686.9 samples/s | 88.9 steps/s
[Step=38450 Epoch=75.2] | Loss=0.01141 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.370 | L2-Norm(final)=9.608 | 5768.0 samples/s | 90.1 steps/s
[Step=38500 Epoch=75.3] | Loss=0.01121 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=9.614 | 7247.9 samples/s | 113.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=75.3] | Loss=0.00782 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=9.676 | 3751.7 samples/s | 58.6 steps/s
[Step=38550 Epoch=75.4] | Loss=0.01333 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.382 | L2-Norm(final)=9.679 | 4952.2 samples/s | 77.4 steps/s
[Step=38600 Epoch=75.5] | Loss=0.01352 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.392 | L2-Norm(final)=9.681 | 4979.5 samples/s | 77.8 steps/s
[Step=38650 Epoch=75.6] | Loss=0.01205 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.400 | L2-Norm(final)=9.683 | 4879.5 samples/s | 76.2 steps/s
[Step=38700 Epoch=75.7] | Loss=0.01118 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.406 | L2-Norm(final)=9.686 | 4962.3 samples/s | 77.5 steps/s
[Step=38750 Epoch=75.8] | Loss=0.01103 | Reg=0.00130 | acc=0.9531 | L2-Norm=11.412 | L2-Norm(final)=9.689 | 4939.1 samples/s | 77.2 steps/s
[Step=38800 Epoch=75.9] | Loss=0.01037 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.417 | L2-Norm(final)=9.692 | 4943.0 samples/s | 77.2 steps/s
[Step=38850 Epoch=76.0] | Loss=0.01038 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.422 | L2-Norm(final)=9.695 | 4946.4 samples/s | 77.3 steps/s
[Step=38900 Epoch=76.0] | Loss=0.01051 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.427 | L2-Norm(final)=9.698 | 4970.0 samples/s | 77.7 steps/s
[Step=38950 Epoch=76.1] | Loss=0.01071 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.431 | L2-Norm(final)=9.701 | 5024.0 samples/s | 78.5 steps/s
[Step=39000 Epoch=76.2] | Loss=0.01059 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.435 | L2-Norm(final)=9.703 | 6032.6 samples/s | 94.3 steps/s
[Step=39050 Epoch=76.3] | Loss=0.01084 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.439 | L2-Norm(final)=9.705 | 1898.9 samples/s | 29.7 steps/s
[Step=39100 Epoch=76.4] | Loss=0.01070 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.442 | L2-Norm(final)=9.707 | 4910.8 samples/s | 76.7 steps/s
[Step=39150 Epoch=76.5] | Loss=0.01031 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.446 | L2-Norm(final)=9.709 | 4935.3 samples/s | 77.1 steps/s
[Step=39200 Epoch=76.6] | Loss=0.00999 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=9.712 | 4941.4 samples/s | 77.2 steps/s
[Step=39250 Epoch=76.7] | Loss=0.00977 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=9.714 | 4880.6 samples/s | 76.3 steps/s
[Step=39300 Epoch=76.8] | Loss=0.00958 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.456 | L2-Norm(final)=9.717 | 4958.2 samples/s | 77.5 steps/s
[Step=39350 Epoch=76.9] | Loss=0.00932 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.459 | L2-Norm(final)=9.719 | 4958.3 samples/s | 77.5 steps/s
[Step=39400 Epoch=77.0] | Loss=0.00914 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.462 | L2-Norm(final)=9.722 | 4956.2 samples/s | 77.4 steps/s
[Step=39450 Epoch=77.1] | Loss=0.00901 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.465 | L2-Norm(final)=9.724 | 4950.1 samples/s | 77.3 steps/s
[Step=39500 Epoch=77.2] | Loss=0.00895 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.467 | L2-Norm(final)=9.727 | 5357.0 samples/s | 83.7 steps/s
[Step=39550 Epoch=77.3] | Loss=0.00895 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.470 | L2-Norm(final)=9.729 | 1984.7 samples/s | 31.0 steps/s
[Step=39600 Epoch=77.4] | Loss=0.00875 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.473 | L2-Norm(final)=9.732 | 4991.9 samples/s | 78.0 steps/s
[Step=39650 Epoch=77.5] | Loss=0.00864 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.475 | L2-Norm(final)=9.734 | 4941.9 samples/s | 77.2 steps/s
[Step=39700 Epoch=77.6] | Loss=0.00846 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.478 | L2-Norm(final)=9.736 | 4960.0 samples/s | 77.5 steps/s
[Step=39750 Epoch=77.7] | Loss=0.00839 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.480 | L2-Norm(final)=9.738 | 4998.2 samples/s | 78.1 steps/s
[Step=39800 Epoch=77.8] | Loss=0.00830 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.482 | L2-Norm(final)=9.740 | 4857.9 samples/s | 75.9 steps/s
[Step=39850 Epoch=77.9] | Loss=0.00821 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.485 | L2-Norm(final)=9.743 | 4993.3 samples/s | 78.0 steps/s
[Step=39900 Epoch=78.0] | Loss=0.00815 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.487 | L2-Norm(final)=9.745 | 4955.4 samples/s | 77.4 steps/s
[Step=39950 Epoch=78.1] | Loss=0.00804 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=9.747 | 4969.6 samples/s | 77.7 steps/s
[Step=40000 Epoch=78.2] | Loss=0.00801 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.491 | L2-Norm(final)=9.749 | 4965.8 samples/s | 77.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step40000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=38001 Epoch=146.3] | Loss=0.00199 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=12.026 | 3681.8 samples/s | 57.5 steps/s
[Step=38050 Epoch=146.5] | Loss=0.00009 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.359 | L2-Norm(final)=12.033 | 5393.5 samples/s | 84.3 steps/s
[Step=38100 Epoch=146.7] | Loss=0.00007 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=12.038 | 5358.6 samples/s | 83.7 steps/s
[Step=38150 Epoch=146.9] | Loss=0.00007 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=12.044 | 5464.2 samples/s | 85.4 steps/s
[Step=38200 Epoch=147.0] | Loss=0.00007 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=12.048 | 5271.3 samples/s | 82.4 steps/s
[Step=38250 Epoch=147.2] | Loss=0.00007 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=12.054 | 7070.6 samples/s | 110.5 steps/s
[Step=38300 Epoch=147.4] | Loss=0.00007 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=12.060 | 1936.3 samples/s | 30.3 steps/s
[Step=38350 Epoch=147.6] | Loss=0.00007 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=12.066 | 5193.3 samples/s | 81.1 steps/s
[Step=38400 Epoch=147.8] | Loss=0.00006 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=12.071 | 5289.3 samples/s | 82.6 steps/s
[Step=38450 Epoch=148.0] | Loss=0.00006 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=12.076 | 5353.6 samples/s | 83.7 steps/s
[Step=38500 Epoch=148.2] | Loss=0.00006 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=12.081 | 6240.3 samples/s | 97.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=148.2] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=12.132 | 3762.8 samples/s | 58.8 steps/s
[Step=38550 Epoch=148.4] | Loss=0.00043 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.339 | L2-Norm(final)=12.133 | 4524.9 samples/s | 70.7 steps/s
[Step=38600 Epoch=148.6] | Loss=0.00044 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.343 | L2-Norm(final)=12.134 | 4682.7 samples/s | 73.2 steps/s
[Step=38650 Epoch=148.8] | Loss=0.00037 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.348 | L2-Norm(final)=12.135 | 4702.2 samples/s | 73.5 steps/s
[Step=38700 Epoch=149.0] | Loss=0.00047 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=12.136 | 4742.2 samples/s | 74.1 steps/s
[Step=38750 Epoch=149.2] | Loss=0.00046 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=12.136 | 6005.0 samples/s | 93.8 steps/s
[Step=38800 Epoch=149.4] | Loss=0.00039 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.362 | L2-Norm(final)=12.136 | 1851.0 samples/s | 28.9 steps/s
[Step=38850 Epoch=149.5] | Loss=0.00033 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=12.136 | 4697.0 samples/s | 73.4 steps/s
[Step=38900 Epoch=149.7] | Loss=0.00029 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.365 | L2-Norm(final)=12.137 | 4705.2 samples/s | 73.5 steps/s
[Step=38950 Epoch=149.9] | Loss=0.00029 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.365 | L2-Norm(final)=12.137 | 4720.3 samples/s | 73.8 steps/s
[Step=39000 Epoch=150.1] | Loss=0.00026 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.366 | L2-Norm(final)=12.137 | 5123.9 samples/s | 80.1 steps/s
[Step=39050 Epoch=150.3] | Loss=0.00024 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.366 | L2-Norm(final)=12.137 | 1882.2 samples/s | 29.4 steps/s
[Step=39100 Epoch=150.5] | Loss=0.00022 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.366 | L2-Norm(final)=12.137 | 4668.1 samples/s | 72.9 steps/s
[Step=39150 Epoch=150.7] | Loss=0.00020 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.366 | L2-Norm(final)=12.138 | 4677.1 samples/s | 73.1 steps/s
[Step=39200 Epoch=150.9] | Loss=0.00019 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.365 | L2-Norm(final)=12.138 | 4710.2 samples/s | 73.6 steps/s
[Step=39250 Epoch=151.1] | Loss=0.00018 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=12.138 | 4647.1 samples/s | 72.6 steps/s
[Step=39300 Epoch=151.3] | Loss=0.00017 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=12.138 | 1995.7 samples/s | 31.2 steps/s
[Step=39350 Epoch=151.5] | Loss=0.00016 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.363 | L2-Norm(final)=12.138 | 4800.9 samples/s | 75.0 steps/s
[Step=39400 Epoch=151.7] | Loss=0.00015 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.361 | L2-Norm(final)=12.138 | 4755.7 samples/s | 74.3 steps/s
[Step=39450 Epoch=151.9] | Loss=0.00014 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.360 | L2-Norm(final)=12.138 | 4693.1 samples/s | 73.3 steps/s
[Step=39500 Epoch=152.1] | Loss=0.00013 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.359 | L2-Norm(final)=12.139 | 4735.8 samples/s | 74.0 steps/s
[Step=39550 Epoch=152.2] | Loss=0.00013 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=12.139 | 2021.3 samples/s | 31.6 steps/s
[Step=39600 Epoch=152.4] | Loss=0.00012 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.356 | L2-Norm(final)=12.139 | 4759.3 samples/s | 74.4 steps/s
[Step=39650 Epoch=152.6] | Loss=0.00012 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=12.139 | 4779.6 samples/s | 74.7 steps/s
[Step=39700 Epoch=152.8] | Loss=0.00011 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=12.139 | 4628.8 samples/s | 72.3 steps/s
[Step=39750 Epoch=153.0] | Loss=0.00011 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=12.139 | 4722.4 samples/s | 73.8 steps/s
[Step=39800 Epoch=153.2] | Loss=0.00010 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.350 | L2-Norm(final)=12.139 | 6950.1 samples/s | 108.6 steps/s
[Step=39850 Epoch=153.4] | Loss=0.00010 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=12.140 | 1765.3 samples/s | 27.6 steps/s
[Step=39900 Epoch=153.6] | Loss=0.00010 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.347 | L2-Norm(final)=12.140 | 4661.6 samples/s | 72.8 steps/s
[Step=39950 Epoch=153.8] | Loss=0.00009 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.345 | L2-Norm(final)=12.140 | 4711.3 samples/s | 73.6 steps/s
[Step=40000 Epoch=154.0] | Loss=0.00009 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.344 | L2-Norm(final)=12.140 | 4765.3 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08525 | acc=0.9704 | tpr=0.9800 | fpr=0.0505 | 4415.1 samples/s | 17.2 steps/s
Avg test loss: 0.08717, Avg test acc: 0.96767, Avg tpr: 0.97791, Avg fpr: 0.05486, total FA: 428

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07403 | acc=0.9686 | tpr=0.9811 | fpr=0.0585 | 4376.5 samples/s | 17.1 steps/s
Avg test loss: 0.07687, Avg test acc: 0.96698, Avg tpr: 0.98047, Avg fpr: 0.06268, total FA: 489

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.55520 | acc=0.2955 | tpr=0.0073 | fpr=0.0788 | 4371.1 samples/s | 17.1 steps/s
Avg test loss: 6.55520, Avg test acc: 0.29229, Avg tpr: 0.00863, Avg fpr: 0.08384, total FA: 654

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.52909 | acc=0.2994 | tpr=0.0111 | fpr=0.0746 | 4295.0 samples/s | 16.8 steps/s
Avg test loss: 7.53419, Avg test acc: 0.29750, Avg tpr: 0.01276, Avg fpr: 0.07627, total FA: 595

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.51669 | acc=0.1221 | tpr=0.6991 | fpr=0.8883 | 4322.9 samples/s | 16.9 steps/s
[Step= 100] | Loss=6.50387 | acc=0.1243 | tpr=0.7335 | fpr=0.8871 | 8674.4 samples/s | 33.9 steps/s
[Step= 150] | Loss=6.50651 | acc=0.1231 | tpr=0.7176 | fpr=0.8878 | 9193.6 samples/s | 35.9 steps/s
[Step= 200] | Loss=6.49276 | acc=0.1240 | tpr=0.7158 | fpr=0.8868 | 8926.8 samples/s | 34.9 steps/s
[Step= 250] | Loss=6.49098 | acc=0.1237 | tpr=0.7039 | fpr=0.8868 | 8182.9 samples/s | 32.0 steps/s
[Step= 300] | Loss=6.48510 | acc=0.1243 | tpr=0.7091 | fpr=0.8864 | 8483.9 samples/s | 33.1 steps/s
[Step= 350] | Loss=6.48084 | acc=0.1237 | tpr=0.7126 | fpr=0.8870 | 8837.1 samples/s | 34.5 steps/s
[Step= 400] | Loss=6.47504 | acc=0.1235 | tpr=0.7128 | fpr=0.8872 | 8824.4 samples/s | 34.5 steps/s
[Step= 450] | Loss=6.47108 | acc=0.1235 | tpr=0.7157 | fpr=0.8872 | 8441.2 samples/s | 33.0 steps/s
[Step= 500] | Loss=6.47396 | acc=0.1235 | tpr=0.7194 | fpr=0.8873 | 8832.3 samples/s | 34.5 steps/s
[Step= 550] | Loss=6.47488 | acc=0.1238 | tpr=0.7207 | fpr=0.8870 | 14877.5 samples/s | 58.1 steps/s
Avg test loss: 6.47609, Avg test acc: 0.12367, Avg tpr: 0.72029, Avg fpr: 0.88718, total FA: 123183

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.69380 | acc=0.1209 | tpr=0.6637 | fpr=0.8888 | 4320.9 samples/s | 16.9 steps/s
[Step= 100] | Loss=5.67437 | acc=0.1241 | tpr=0.6759 | fpr=0.8862 | 8801.7 samples/s | 34.4 steps/s
[Step= 150] | Loss=5.67255 | acc=0.1236 | tpr=0.6628 | fpr=0.8863 | 8642.4 samples/s | 33.8 steps/s
[Step= 200] | Loss=5.66108 | acc=0.1241 | tpr=0.6546 | fpr=0.8856 | 8636.3 samples/s | 33.7 steps/s
[Step= 250] | Loss=5.65920 | acc=0.1243 | tpr=0.6410 | fpr=0.8851 | 8803.8 samples/s | 34.4 steps/s
[Step= 300] | Loss=5.65529 | acc=0.1249 | tpr=0.6451 | fpr=0.8846 | 8651.7 samples/s | 33.8 steps/s
[Step= 350] | Loss=5.65284 | acc=0.1245 | tpr=0.6487 | fpr=0.8851 | 9340.3 samples/s | 36.5 steps/s
[Step= 400] | Loss=5.64749 | acc=0.1242 | tpr=0.6493 | fpr=0.8854 | 8735.2 samples/s | 34.1 steps/s
[Step= 450] | Loss=5.64454 | acc=0.1242 | tpr=0.6514 | fpr=0.8853 | 7956.5 samples/s | 31.1 steps/s
[Step= 500] | Loss=5.64616 | acc=0.1242 | tpr=0.6533 | fpr=0.8853 | 8934.1 samples/s | 34.9 steps/s
[Step= 550] | Loss=5.64650 | acc=0.1243 | tpr=0.6534 | fpr=0.8854 | 14781.1 samples/s | 57.7 steps/s
Avg test loss: 5.64748, Avg test acc: 0.12415, Avg tpr: 0.65333, Avg fpr: 0.88547, total FA: 122946

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12095 | acc=0.9812 | tpr=0.9336 | fpr=0.0179 | 4393.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.12999 | acc=0.9796 | tpr=0.9574 | fpr=0.0200 | 8341.3 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.13489 | acc=0.9784 | tpr=0.9568 | fpr=0.0212 | 8621.9 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.13506 | acc=0.9790 | tpr=0.9607 | fpr=0.0207 | 9171.7 samples/s | 35.8 steps/s
[Step= 250] | Loss=0.13306 | acc=0.9794 | tpr=0.9624 | fpr=0.0203 | 8351.0 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.13512 | acc=0.9792 | tpr=0.9629 | fpr=0.0205 | 8596.9 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.13615 | acc=0.9791 | tpr=0.9643 | fpr=0.0207 | 8803.2 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.13801 | acc=0.9787 | tpr=0.9595 | fpr=0.0210 | 9129.5 samples/s | 35.7 steps/s
[Step= 450] | Loss=0.14100 | acc=0.9785 | tpr=0.9562 | fpr=0.0211 | 8347.3 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.14056 | acc=0.9785 | tpr=0.9568 | fpr=0.0211 | 8529.2 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.13943 | acc=0.9786 | tpr=0.9566 | fpr=0.0210 | 15806.7 samples/s | 61.7 steps/s
Avg test loss: 0.13910, Avg test acc: 0.97862, Avg tpr: 0.95681, Avg fpr: 0.02098, total FA: 2913

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14951 | acc=0.9820 | tpr=0.9513 | fpr=0.0174 | 4366.0 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.15754 | acc=0.9807 | tpr=0.9638 | fpr=0.0190 | 8549.1 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.16523 | acc=0.9797 | tpr=0.9625 | fpr=0.0200 | 8930.2 samples/s | 34.9 steps/s
[Step= 200] | Loss=0.16633 | acc=0.9801 | tpr=0.9628 | fpr=0.0196 | 8647.6 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.16346 | acc=0.9802 | tpr=0.9607 | fpr=0.0194 | 8302.1 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.16512 | acc=0.9801 | tpr=0.9600 | fpr=0.0195 | 8711.1 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.16606 | acc=0.9800 | tpr=0.9606 | fpr=0.0197 | 8599.6 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.16765 | acc=0.9797 | tpr=0.9557 | fpr=0.0199 | 8658.6 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.17169 | acc=0.9795 | tpr=0.9542 | fpr=0.0200 | 8684.8 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.17080 | acc=0.9796 | tpr=0.9555 | fpr=0.0200 | 8530.6 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.16954 | acc=0.9797 | tpr=0.9542 | fpr=0.0199 | 16035.0 samples/s | 62.6 steps/s
Avg test loss: 0.16914, Avg test acc: 0.97968, Avg tpr: 0.95444, Avg fpr: 0.01986, total FA: 2758

server round 40/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=40001 Epoch=78.2] | Loss=0.00885 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.655 | L2-Norm(final)=9.813 | 3885.7 samples/s | 60.7 steps/s
[Step=40050 Epoch=78.3] | Loss=0.01308 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.655 | L2-Norm(final)=9.814 | 5600.6 samples/s | 87.5 steps/s
[Step=40100 Epoch=78.4] | Loss=0.01218 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=9.816 | 5540.5 samples/s | 86.6 steps/s
[Step=40150 Epoch=78.5] | Loss=0.01075 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=9.819 | 5812.3 samples/s | 90.8 steps/s
[Step=40200 Epoch=78.6] | Loss=0.01040 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=9.821 | 5554.6 samples/s | 86.8 steps/s
[Step=40250 Epoch=78.7] | Loss=0.01048 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=9.823 | 5689.1 samples/s | 88.9 steps/s
[Step=40300 Epoch=78.8] | Loss=0.01035 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=9.826 | 5674.7 samples/s | 88.7 steps/s
[Step=40350 Epoch=78.9] | Loss=0.01012 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=9.829 | 5676.8 samples/s | 88.7 steps/s
[Step=40400 Epoch=79.0] | Loss=0.01028 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.655 | L2-Norm(final)=9.831 | 5674.8 samples/s | 88.7 steps/s
[Step=40450 Epoch=79.1] | Loss=0.01033 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=9.834 | 5844.5 samples/s | 91.3 steps/s
[Step=40500 Epoch=79.2] | Loss=0.01035 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.655 | L2-Norm(final)=9.836 | 7135.4 samples/s | 111.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=79.2] | Loss=0.00419 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=9.862 | 3792.5 samples/s | 59.3 steps/s
[Step=40550 Epoch=79.3] | Loss=0.00948 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.659 | L2-Norm(final)=9.863 | 4943.5 samples/s | 77.2 steps/s
[Step=40600 Epoch=79.4] | Loss=0.00937 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.662 | L2-Norm(final)=9.865 | 4911.3 samples/s | 76.7 steps/s
[Step=40650 Epoch=79.5] | Loss=0.00915 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.665 | L2-Norm(final)=9.867 | 4973.1 samples/s | 77.7 steps/s
[Step=40700 Epoch=79.6] | Loss=0.00885 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.668 | L2-Norm(final)=9.869 | 4962.7 samples/s | 77.5 steps/s
[Step=40750 Epoch=79.7] | Loss=0.00932 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=9.871 | 4913.9 samples/s | 76.8 steps/s
[Step=40800 Epoch=79.8] | Loss=0.00907 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.672 | L2-Norm(final)=9.872 | 4948.7 samples/s | 77.3 steps/s
[Step=40850 Epoch=79.9] | Loss=0.00856 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=9.874 | 5009.5 samples/s | 78.3 steps/s
[Step=40900 Epoch=80.0] | Loss=0.00822 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.676 | L2-Norm(final)=9.876 | 4882.8 samples/s | 76.3 steps/s
[Step=40950 Epoch=80.1] | Loss=0.00810 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.678 | L2-Norm(final)=9.878 | 4984.4 samples/s | 77.9 steps/s
[Step=41000 Epoch=80.2] | Loss=0.00818 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.680 | L2-Norm(final)=9.880 | 6104.7 samples/s | 95.4 steps/s
[Step=41050 Epoch=80.3] | Loss=0.00794 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.681 | L2-Norm(final)=9.881 | 1912.7 samples/s | 29.9 steps/s
[Step=41100 Epoch=80.3] | Loss=0.00759 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=9.883 | 5008.6 samples/s | 78.3 steps/s
[Step=41150 Epoch=80.4] | Loss=0.00739 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.684 | L2-Norm(final)=9.885 | 4859.1 samples/s | 75.9 steps/s
[Step=41200 Epoch=80.5] | Loss=0.00731 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.686 | L2-Norm(final)=9.886 | 4971.5 samples/s | 77.7 steps/s
[Step=41250 Epoch=80.6] | Loss=0.00723 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.687 | L2-Norm(final)=9.888 | 4950.7 samples/s | 77.4 steps/s
[Step=41300 Epoch=80.7] | Loss=0.00718 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.689 | L2-Norm(final)=9.890 | 4970.0 samples/s | 77.7 steps/s
[Step=41350 Epoch=80.8] | Loss=0.00704 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.690 | L2-Norm(final)=9.891 | 4954.4 samples/s | 77.4 steps/s
[Step=41400 Epoch=80.9] | Loss=0.00694 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.691 | L2-Norm(final)=9.893 | 4969.6 samples/s | 77.7 steps/s
[Step=41450 Epoch=81.0] | Loss=0.00688 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.693 | L2-Norm(final)=9.894 | 4926.0 samples/s | 77.0 steps/s
[Step=41500 Epoch=81.1] | Loss=0.00684 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.694 | L2-Norm(final)=9.896 | 5353.9 samples/s | 83.7 steps/s
[Step=41550 Epoch=81.2] | Loss=0.00673 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.695 | L2-Norm(final)=9.897 | 2029.4 samples/s | 31.7 steps/s
[Step=41600 Epoch=81.3] | Loss=0.00661 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=9.899 | 4873.8 samples/s | 76.2 steps/s
[Step=41650 Epoch=81.4] | Loss=0.00654 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.698 | L2-Norm(final)=9.900 | 4965.6 samples/s | 77.6 steps/s
[Step=41700 Epoch=81.5] | Loss=0.00648 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.699 | L2-Norm(final)=9.902 | 4896.4 samples/s | 76.5 steps/s
[Step=41750 Epoch=81.6] | Loss=0.00641 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.700 | L2-Norm(final)=9.903 | 4976.3 samples/s | 77.8 steps/s
[Step=41800 Epoch=81.7] | Loss=0.00632 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.701 | L2-Norm(final)=9.905 | 4927.5 samples/s | 77.0 steps/s
[Step=41850 Epoch=81.8] | Loss=0.00621 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.702 | L2-Norm(final)=9.906 | 4954.3 samples/s | 77.4 steps/s
[Step=41900 Epoch=81.9] | Loss=0.00618 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.703 | L2-Norm(final)=9.908 | 4974.2 samples/s | 77.7 steps/s
[Step=41950 Epoch=82.0] | Loss=0.00615 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.705 | L2-Norm(final)=9.909 | 4938.8 samples/s | 77.2 steps/s
[Step=42000 Epoch=82.1] | Loss=0.00614 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.706 | L2-Norm(final)=9.911 | 4991.1 samples/s | 78.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step42000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=36001 Epoch=137.9] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=11.054 | 3766.0 samples/s | 58.8 steps/s
[Step=36050 Epoch=138.1] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=11.055 | 5355.3 samples/s | 83.7 steps/s
[Step=36100 Epoch=138.3] | Loss=0.00003 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=11.056 | 5310.2 samples/s | 83.0 steps/s
[Step=36150 Epoch=138.5] | Loss=0.00004 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=11.057 | 5286.1 samples/s | 82.6 steps/s
[Step=36200 Epoch=138.7] | Loss=0.00003 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=11.058 | 5300.1 samples/s | 82.8 steps/s
[Step=36250 Epoch=138.9] | Loss=0.00003 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=11.058 | 7129.9 samples/s | 111.4 steps/s
[Step=36300 Epoch=139.1] | Loss=0.00003 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=11.059 | 1926.2 samples/s | 30.1 steps/s
[Step=36350 Epoch=139.3] | Loss=0.00003 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=11.060 | 5357.7 samples/s | 83.7 steps/s
[Step=36400 Epoch=139.5] | Loss=0.00003 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=11.060 | 5399.3 samples/s | 84.4 steps/s
[Step=36450 Epoch=139.7] | Loss=0.00003 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=11.061 | 5389.1 samples/s | 84.2 steps/s
[Step=36500 Epoch=139.9] | Loss=0.00003 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=11.062 | 6055.1 samples/s | 94.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=36501 Epoch=139.9] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=11.069 | 3682.3 samples/s | 57.5 steps/s
[Step=36550 Epoch=140.0] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=11.070 | 4659.5 samples/s | 72.8 steps/s
[Step=36600 Epoch=140.2] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.652 | L2-Norm(final)=11.070 | 4753.2 samples/s | 74.3 steps/s
[Step=36650 Epoch=140.4] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.651 | L2-Norm(final)=11.071 | 4700.0 samples/s | 73.4 steps/s
[Step=36700 Epoch=140.6] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.650 | L2-Norm(final)=11.072 | 4722.3 samples/s | 73.8 steps/s
[Step=36750 Epoch=140.8] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.648 | L2-Norm(final)=11.072 | 5878.5 samples/s | 91.9 steps/s
[Step=36800 Epoch=141.0] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.646 | L2-Norm(final)=11.073 | 1852.4 samples/s | 28.9 steps/s
[Step=36850 Epoch=141.2] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.645 | L2-Norm(final)=11.073 | 4701.6 samples/s | 73.5 steps/s
[Step=36900 Epoch=141.4] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.643 | L2-Norm(final)=11.074 | 4685.8 samples/s | 73.2 steps/s
[Step=36950 Epoch=141.6] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.641 | L2-Norm(final)=11.074 | 4735.1 samples/s | 74.0 steps/s
[Step=37000 Epoch=141.8] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.639 | L2-Norm(final)=11.075 | 5194.5 samples/s | 81.2 steps/s
[Step=37050 Epoch=142.0] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.637 | L2-Norm(final)=11.075 | 1938.8 samples/s | 30.3 steps/s
[Step=37100 Epoch=142.2] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.635 | L2-Norm(final)=11.076 | 4680.4 samples/s | 73.1 steps/s
[Step=37150 Epoch=142.3] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.634 | L2-Norm(final)=11.077 | 4687.5 samples/s | 73.2 steps/s
[Step=37200 Epoch=142.5] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.632 | L2-Norm(final)=11.077 | 4743.6 samples/s | 74.1 steps/s
[Step=37250 Epoch=142.7] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.630 | L2-Norm(final)=11.078 | 4718.9 samples/s | 73.7 steps/s
[Step=37300 Epoch=142.9] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.627 | L2-Norm(final)=11.078 | 2007.5 samples/s | 31.4 steps/s
[Step=37350 Epoch=143.1] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.625 | L2-Norm(final)=11.079 | 4808.6 samples/s | 75.1 steps/s
[Step=37400 Epoch=143.3] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.623 | L2-Norm(final)=11.079 | 4788.0 samples/s | 74.8 steps/s
[Step=37450 Epoch=143.5] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=11.080 | 4626.6 samples/s | 72.3 steps/s
[Step=37500 Epoch=143.7] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.619 | L2-Norm(final)=11.080 | 4724.9 samples/s | 73.8 steps/s
[Step=37550 Epoch=143.9] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.617 | L2-Norm(final)=11.081 | 2015.2 samples/s | 31.5 steps/s
[Step=37600 Epoch=144.1] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.614 | L2-Norm(final)=11.081 | 4706.8 samples/s | 73.5 steps/s
[Step=37650 Epoch=144.3] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.612 | L2-Norm(final)=11.082 | 4676.8 samples/s | 73.1 steps/s
[Step=37700 Epoch=144.5] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.610 | L2-Norm(final)=11.082 | 4734.0 samples/s | 74.0 steps/s
[Step=37750 Epoch=144.6] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.607 | L2-Norm(final)=11.083 | 4762.7 samples/s | 74.4 steps/s
[Step=37800 Epoch=144.8] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.605 | L2-Norm(final)=11.084 | 6330.8 samples/s | 98.9 steps/s
[Step=37850 Epoch=145.0] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.603 | L2-Norm(final)=11.084 | 1837.3 samples/s | 28.7 steps/s
[Step=37900 Epoch=145.2] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.600 | L2-Norm(final)=11.085 | 4602.5 samples/s | 71.9 steps/s
[Step=37950 Epoch=145.4] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.598 | L2-Norm(final)=11.085 | 4678.5 samples/s | 73.1 steps/s
[Step=38000 Epoch=145.6] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.595 | L2-Norm(final)=11.086 | 4731.2 samples/s | 73.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step38000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08525 | acc=0.9704 | tpr=0.9800 | fpr=0.0505 | 4342.3 samples/s | 17.0 steps/s
Avg test loss: 0.08717, Avg test acc: 0.96767, Avg tpr: 0.97791, Avg fpr: 0.05486, total FA: 428

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07296 | acc=0.9704 | tpr=0.9799 | fpr=0.0503 | 4375.3 samples/s | 17.1 steps/s
Avg test loss: 0.07659, Avg test acc: 0.96851, Avg tpr: 0.97943, Avg fpr: 0.05551, total FA: 433

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.25805 | acc=0.2877 | tpr=0.0143 | fpr=0.1184 | 4349.9 samples/s | 17.0 steps/s
Avg test loss: 6.25862, Avg test acc: 0.28568, Avg tpr: 0.01545, Avg fpr: 0.11998, total FA: 936

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.52909 | acc=0.2994 | tpr=0.0111 | fpr=0.0746 | 4395.1 samples/s | 17.2 steps/s
Avg test loss: 7.53419, Avg test acc: 0.29750, Avg tpr: 0.01276, Avg fpr: 0.07627, total FA: 595

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.51669 | acc=0.1221 | tpr=0.6991 | fpr=0.8883 | 4394.1 samples/s | 17.2 steps/s
[Step= 100] | Loss=6.50387 | acc=0.1243 | tpr=0.7335 | fpr=0.8871 | 8464.5 samples/s | 33.1 steps/s
[Step= 150] | Loss=6.50651 | acc=0.1231 | tpr=0.7176 | fpr=0.8878 | 9166.6 samples/s | 35.8 steps/s
[Step= 200] | Loss=6.49276 | acc=0.1240 | tpr=0.7158 | fpr=0.8868 | 8097.6 samples/s | 31.6 steps/s
[Step= 250] | Loss=6.49098 | acc=0.1237 | tpr=0.7039 | fpr=0.8868 | 9026.8 samples/s | 35.3 steps/s
[Step= 300] | Loss=6.48510 | acc=0.1243 | tpr=0.7091 | fpr=0.8864 | 8354.3 samples/s | 32.6 steps/s
[Step= 350] | Loss=6.48084 | acc=0.1237 | tpr=0.7126 | fpr=0.8870 | 8622.5 samples/s | 33.7 steps/s
[Step= 400] | Loss=6.47504 | acc=0.1235 | tpr=0.7128 | fpr=0.8872 | 8887.0 samples/s | 34.7 steps/s
[Step= 450] | Loss=6.47108 | acc=0.1235 | tpr=0.7157 | fpr=0.8872 | 8454.6 samples/s | 33.0 steps/s
[Step= 500] | Loss=6.47396 | acc=0.1235 | tpr=0.7194 | fpr=0.8873 | 8822.2 samples/s | 34.5 steps/s
[Step= 550] | Loss=6.47488 | acc=0.1238 | tpr=0.7207 | fpr=0.8870 | 15018.7 samples/s | 58.7 steps/s
Avg test loss: 6.47609, Avg test acc: 0.12367, Avg tpr: 0.72029, Avg fpr: 0.88718, total FA: 123183

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.64118 | acc=0.1310 | tpr=0.6195 | fpr=0.8778 | 4442.8 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.62076 | acc=0.1339 | tpr=0.6461 | fpr=0.8757 | 8514.4 samples/s | 33.3 steps/s
[Step= 150] | Loss=5.62105 | acc=0.1336 | tpr=0.6326 | fpr=0.8756 | 8554.2 samples/s | 33.4 steps/s
[Step= 200] | Loss=5.60988 | acc=0.1338 | tpr=0.6251 | fpr=0.8751 | 8689.5 samples/s | 33.9 steps/s
[Step= 250] | Loss=5.60885 | acc=0.1339 | tpr=0.6114 | fpr=0.8748 | 8859.0 samples/s | 34.6 steps/s
[Step= 300] | Loss=5.60507 | acc=0.1341 | tpr=0.6145 | fpr=0.8746 | 8670.4 samples/s | 33.9 steps/s
[Step= 350] | Loss=5.60168 | acc=0.1337 | tpr=0.6199 | fpr=0.8752 | 8491.6 samples/s | 33.2 steps/s
[Step= 400] | Loss=5.59529 | acc=0.1335 | tpr=0.6209 | fpr=0.8753 | 8663.9 samples/s | 33.8 steps/s
[Step= 450] | Loss=5.59184 | acc=0.1335 | tpr=0.6246 | fpr=0.8754 | 8905.5 samples/s | 34.8 steps/s
[Step= 500] | Loss=5.59375 | acc=0.1334 | tpr=0.6273 | fpr=0.8755 | 8672.2 samples/s | 33.9 steps/s
[Step= 550] | Loss=5.59408 | acc=0.1335 | tpr=0.6244 | fpr=0.8754 | 15192.6 samples/s | 59.3 steps/s
Avg test loss: 5.59498, Avg test acc: 0.13338, Avg tpr: 0.62441, Avg fpr: 0.87555, total FA: 121568

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12763 | acc=0.9804 | tpr=0.9602 | fpr=0.0192 | 4342.5 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.13630 | acc=0.9791 | tpr=0.9701 | fpr=0.0208 | 8701.7 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.14170 | acc=0.9782 | tpr=0.9654 | fpr=0.0215 | 8646.6 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.14185 | acc=0.9788 | tpr=0.9661 | fpr=0.0210 | 8602.4 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.13982 | acc=0.9791 | tpr=0.9659 | fpr=0.0207 | 8483.2 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.14128 | acc=0.9790 | tpr=0.9665 | fpr=0.0208 | 8815.7 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.14203 | acc=0.9788 | tpr=0.9674 | fpr=0.0210 | 8528.7 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.14368 | acc=0.9784 | tpr=0.9639 | fpr=0.0213 | 8780.8 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.14712 | acc=0.9783 | tpr=0.9615 | fpr=0.0214 | 8581.4 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.14640 | acc=0.9782 | tpr=0.9626 | fpr=0.0215 | 8843.1 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.14513 | acc=0.9784 | tpr=0.9622 | fpr=0.0213 | 15174.8 samples/s | 59.3 steps/s
Avg test loss: 0.14480, Avg test acc: 0.97841, Avg tpr: 0.96236, Avg fpr: 0.02130, total FA: 2957

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14951 | acc=0.9820 | tpr=0.9513 | fpr=0.0174 | 4346.0 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.15754 | acc=0.9807 | tpr=0.9638 | fpr=0.0190 | 8982.2 samples/s | 35.1 steps/s
[Step= 150] | Loss=0.16523 | acc=0.9797 | tpr=0.9625 | fpr=0.0200 | 8425.2 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.16633 | acc=0.9801 | tpr=0.9628 | fpr=0.0196 | 8848.1 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.16346 | acc=0.9802 | tpr=0.9607 | fpr=0.0194 | 8343.7 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.16512 | acc=0.9801 | tpr=0.9600 | fpr=0.0195 | 8984.1 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.16606 | acc=0.9800 | tpr=0.9606 | fpr=0.0197 | 8915.1 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.16765 | acc=0.9797 | tpr=0.9557 | fpr=0.0199 | 8256.3 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.17169 | acc=0.9795 | tpr=0.9542 | fpr=0.0200 | 8777.6 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.17080 | acc=0.9796 | tpr=0.9555 | fpr=0.0200 | 8599.3 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.16954 | acc=0.9797 | tpr=0.9542 | fpr=0.0199 | 15520.5 samples/s | 60.6 steps/s
Avg test loss: 0.16914, Avg test acc: 0.97968, Avg tpr: 0.95444, Avg fpr: 0.01986, total FA: 2758

server round 41/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=44001 Epoch=85.8] | Loss=0.01437 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.819 | L2-Norm(final)=10.248 | 3541.2 samples/s | 55.3 steps/s
[Step=44050 Epoch=85.9] | Loss=0.01111 | Reg=0.00140 | acc=0.9531 | L2-Norm=11.820 | L2-Norm(final)=10.250 | 5367.7 samples/s | 83.9 steps/s
[Step=44100 Epoch=86.0] | Loss=0.01026 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.820 | L2-Norm(final)=10.255 | 5742.4 samples/s | 89.7 steps/s
[Step=44150 Epoch=86.1] | Loss=0.01180 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.820 | L2-Norm(final)=10.260 | 5616.0 samples/s | 87.8 steps/s
[Step=44200 Epoch=86.2] | Loss=0.01106 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.820 | L2-Norm(final)=10.264 | 5718.5 samples/s | 89.4 steps/s
[Step=44250 Epoch=86.3] | Loss=0.01062 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.820 | L2-Norm(final)=10.268 | 5619.3 samples/s | 87.8 steps/s
[Step=44300 Epoch=86.4] | Loss=0.01060 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.820 | L2-Norm(final)=10.272 | 5677.2 samples/s | 88.7 steps/s
[Step=44350 Epoch=86.5] | Loss=0.01038 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.820 | L2-Norm(final)=10.275 | 5690.0 samples/s | 88.9 steps/s
[Step=44400 Epoch=86.6] | Loss=0.01058 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.820 | L2-Norm(final)=10.278 | 5705.9 samples/s | 89.2 steps/s
[Step=44450 Epoch=86.7] | Loss=0.01066 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.820 | L2-Norm(final)=10.281 | 5717.0 samples/s | 89.3 steps/s
[Step=44500 Epoch=86.8] | Loss=0.01061 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.820 | L2-Norm(final)=10.284 | 7145.3 samples/s | 111.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=86.8] | Loss=0.03709 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.820 | L2-Norm(final)=10.316 | 3868.9 samples/s | 60.5 steps/s
[Step=44550 Epoch=86.9] | Loss=0.01053 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=10.316 | 4602.6 samples/s | 71.9 steps/s
[Step=44600 Epoch=87.0] | Loss=0.01016 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.827 | L2-Norm(final)=10.316 | 4891.2 samples/s | 76.4 steps/s
[Step=44650 Epoch=87.1] | Loss=0.00966 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.830 | L2-Norm(final)=10.317 | 4997.1 samples/s | 78.1 steps/s
[Step=44700 Epoch=87.2] | Loss=0.00921 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.833 | L2-Norm(final)=10.318 | 4924.3 samples/s | 76.9 steps/s
[Step=44750 Epoch=87.3] | Loss=0.00890 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.835 | L2-Norm(final)=10.319 | 4991.7 samples/s | 78.0 steps/s
[Step=44800 Epoch=87.4] | Loss=0.00884 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.837 | L2-Norm(final)=10.320 | 4959.3 samples/s | 77.5 steps/s
[Step=44850 Epoch=87.5] | Loss=0.00847 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.839 | L2-Norm(final)=10.321 | 4869.9 samples/s | 76.1 steps/s
[Step=44900 Epoch=87.6] | Loss=0.00824 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.841 | L2-Norm(final)=10.322 | 4950.3 samples/s | 77.3 steps/s
[Step=44950 Epoch=87.7] | Loss=0.00815 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.844 | L2-Norm(final)=10.324 | 4978.6 samples/s | 77.8 steps/s
[Step=45000 Epoch=87.8] | Loss=0.00794 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.846 | L2-Norm(final)=10.325 | 6042.6 samples/s | 94.4 steps/s
[Step=45050 Epoch=87.9] | Loss=0.00761 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.847 | L2-Norm(final)=10.326 | 1865.6 samples/s | 29.1 steps/s
[Step=45100 Epoch=88.0] | Loss=0.00748 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.849 | L2-Norm(final)=10.328 | 4954.2 samples/s | 77.4 steps/s
[Step=45150 Epoch=88.1] | Loss=0.00733 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.851 | L2-Norm(final)=10.329 | 4904.8 samples/s | 76.6 steps/s
[Step=45200 Epoch=88.2] | Loss=0.00711 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.853 | L2-Norm(final)=10.330 | 4951.2 samples/s | 77.4 steps/s
[Step=45250 Epoch=88.3] | Loss=0.00697 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.854 | L2-Norm(final)=10.332 | 4964.5 samples/s | 77.6 steps/s
[Step=45300 Epoch=88.4] | Loss=0.00685 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.856 | L2-Norm(final)=10.333 | 4930.3 samples/s | 77.0 steps/s
[Step=45350 Epoch=88.5] | Loss=0.00684 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.857 | L2-Norm(final)=10.334 | 4956.5 samples/s | 77.4 steps/s
[Step=45400 Epoch=88.5] | Loss=0.00685 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.858 | L2-Norm(final)=10.336 | 5010.3 samples/s | 78.3 steps/s
[Step=45450 Epoch=88.6] | Loss=0.00687 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.860 | L2-Norm(final)=10.337 | 4930.5 samples/s | 77.0 steps/s
[Step=45500 Epoch=88.7] | Loss=0.00680 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.861 | L2-Norm(final)=10.338 | 5246.0 samples/s | 82.0 steps/s
[Step=45550 Epoch=88.8] | Loss=0.00671 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.862 | L2-Norm(final)=10.339 | 1934.9 samples/s | 30.2 steps/s
[Step=45600 Epoch=88.9] | Loss=0.00657 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.864 | L2-Norm(final)=10.340 | 4934.6 samples/s | 77.1 steps/s
[Step=45650 Epoch=89.0] | Loss=0.00652 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.865 | L2-Norm(final)=10.342 | 4946.0 samples/s | 77.3 steps/s
[Step=45700 Epoch=89.1] | Loss=0.00636 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.866 | L2-Norm(final)=10.343 | 4989.5 samples/s | 78.0 steps/s
[Step=45750 Epoch=89.2] | Loss=0.00627 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.867 | L2-Norm(final)=10.344 | 4919.8 samples/s | 76.9 steps/s
[Step=45800 Epoch=89.3] | Loss=0.00623 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.868 | L2-Norm(final)=10.345 | 4965.3 samples/s | 77.6 steps/s
[Step=45850 Epoch=89.4] | Loss=0.00621 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.869 | L2-Norm(final)=10.347 | 4944.9 samples/s | 77.3 steps/s
[Step=45900 Epoch=89.5] | Loss=0.00614 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.871 | L2-Norm(final)=10.348 | 4960.2 samples/s | 77.5 steps/s
[Step=45950 Epoch=89.6] | Loss=0.00610 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.872 | L2-Norm(final)=10.349 | 5014.6 samples/s | 78.4 steps/s
[Step=46000 Epoch=89.7] | Loss=0.00610 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.873 | L2-Norm(final)=10.350 | 4894.6 samples/s | 76.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step46000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=40001 Epoch=154.0] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.819 | L2-Norm(final)=12.146 | 3776.0 samples/s | 59.0 steps/s
[Step=40050 Epoch=154.2] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.819 | L2-Norm(final)=12.146 | 5308.4 samples/s | 82.9 steps/s
[Step=40100 Epoch=154.4] | Loss=0.00005 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.819 | L2-Norm(final)=12.147 | 5320.8 samples/s | 83.1 steps/s
[Step=40150 Epoch=154.6] | Loss=0.00004 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.819 | L2-Norm(final)=12.149 | 5348.4 samples/s | 83.6 steps/s
[Step=40200 Epoch=154.7] | Loss=0.00004 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.819 | L2-Norm(final)=12.150 | 5397.3 samples/s | 84.3 steps/s
[Step=40250 Epoch=154.9] | Loss=0.00004 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.819 | L2-Norm(final)=12.152 | 7083.4 samples/s | 110.7 steps/s
[Step=40300 Epoch=155.1] | Loss=0.00004 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.819 | L2-Norm(final)=12.153 | 1918.9 samples/s | 30.0 steps/s
[Step=40350 Epoch=155.3] | Loss=0.00004 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.819 | L2-Norm(final)=12.154 | 5384.3 samples/s | 84.1 steps/s
[Step=40400 Epoch=155.5] | Loss=0.00004 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.819 | L2-Norm(final)=12.155 | 5353.4 samples/s | 83.6 steps/s
[Step=40450 Epoch=155.7] | Loss=0.00004 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.819 | L2-Norm(final)=12.156 | 5478.9 samples/s | 85.6 steps/s
[Step=40500 Epoch=155.9] | Loss=0.00004 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.819 | L2-Norm(final)=12.157 | 6144.2 samples/s | 96.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=155.9] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.819 | L2-Norm(final)=12.168 | 3913.7 samples/s | 61.2 steps/s
[Step=40550 Epoch=156.1] | Loss=0.00005 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.818 | L2-Norm(final)=12.171 | 4401.2 samples/s | 68.8 steps/s
[Step=40600 Epoch=156.3] | Loss=0.00003 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.817 | L2-Norm(final)=12.171 | 4682.9 samples/s | 73.2 steps/s
[Step=40650 Epoch=156.5] | Loss=0.00002 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.815 | L2-Norm(final)=12.172 | 4712.5 samples/s | 73.6 steps/s
[Step=40700 Epoch=156.7] | Loss=0.00002 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.813 | L2-Norm(final)=12.172 | 4748.3 samples/s | 74.2 steps/s
[Step=40750 Epoch=156.9] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.811 | L2-Norm(final)=12.172 | 6055.7 samples/s | 94.6 steps/s
[Step=40800 Epoch=157.1] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.809 | L2-Norm(final)=12.172 | 1852.7 samples/s | 28.9 steps/s
[Step=40850 Epoch=157.2] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.807 | L2-Norm(final)=12.173 | 4715.6 samples/s | 73.7 steps/s
[Step=40900 Epoch=157.4] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.805 | L2-Norm(final)=12.173 | 4738.9 samples/s | 74.0 steps/s
[Step=40950 Epoch=157.6] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.803 | L2-Norm(final)=12.173 | 4728.6 samples/s | 73.9 steps/s
[Step=41000 Epoch=157.8] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.801 | L2-Norm(final)=12.173 | 5332.2 samples/s | 83.3 steps/s
[Step=41050 Epoch=158.0] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.799 | L2-Norm(final)=12.173 | 1926.3 samples/s | 30.1 steps/s
[Step=41100 Epoch=158.2] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.797 | L2-Norm(final)=12.174 | 4736.2 samples/s | 74.0 steps/s
[Step=41150 Epoch=158.4] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.795 | L2-Norm(final)=12.174 | 4716.9 samples/s | 73.7 steps/s
[Step=41200 Epoch=158.6] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=12.174 | 4694.2 samples/s | 73.3 steps/s
[Step=41250 Epoch=158.8] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.791 | L2-Norm(final)=12.174 | 4853.6 samples/s | 75.8 steps/s
[Step=41300 Epoch=159.0] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.789 | L2-Norm(final)=12.175 | 1998.9 samples/s | 31.2 steps/s
[Step=41350 Epoch=159.2] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.786 | L2-Norm(final)=12.175 | 4758.1 samples/s | 74.3 steps/s
[Step=41400 Epoch=159.4] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.784 | L2-Norm(final)=12.175 | 4736.6 samples/s | 74.0 steps/s
[Step=41450 Epoch=159.6] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.782 | L2-Norm(final)=12.175 | 4732.3 samples/s | 73.9 steps/s
[Step=41500 Epoch=159.7] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.780 | L2-Norm(final)=12.176 | 4759.8 samples/s | 74.4 steps/s
[Step=41550 Epoch=159.9] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.777 | L2-Norm(final)=12.176 | 2033.6 samples/s | 31.8 steps/s
[Step=41600 Epoch=160.1] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.775 | L2-Norm(final)=12.176 | 4726.9 samples/s | 73.9 steps/s
[Step=41650 Epoch=160.3] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.773 | L2-Norm(final)=12.176 | 4680.2 samples/s | 73.1 steps/s
[Step=41700 Epoch=160.5] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.770 | L2-Norm(final)=12.177 | 4671.1 samples/s | 73.0 steps/s
[Step=41750 Epoch=160.7] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.768 | L2-Norm(final)=12.177 | 4702.7 samples/s | 73.5 steps/s
[Step=41800 Epoch=160.9] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.765 | L2-Norm(final)=12.177 | 7031.8 samples/s | 109.9 steps/s
[Step=41850 Epoch=161.1] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.763 | L2-Norm(final)=12.177 | 1773.8 samples/s | 27.7 steps/s
[Step=41900 Epoch=161.3] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.760 | L2-Norm(final)=12.178 | 4624.8 samples/s | 72.3 steps/s
[Step=41950 Epoch=161.5] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.758 | L2-Norm(final)=12.178 | 4727.6 samples/s | 73.9 steps/s
[Step=42000 Epoch=161.7] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.755 | L2-Norm(final)=12.178 | 4760.3 samples/s | 74.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step42000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07546 | acc=0.9701 | tpr=0.9758 | fpr=0.0424 | 4339.5 samples/s | 17.0 steps/s
Avg test loss: 0.07800, Avg test acc: 0.96803, Avg tpr: 0.97400, Avg fpr: 0.04512, total FA: 352

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07296 | acc=0.9704 | tpr=0.9799 | fpr=0.0503 | 4368.2 samples/s | 17.1 steps/s
Avg test loss: 0.07659, Avg test acc: 0.96851, Avg tpr: 0.97943, Avg fpr: 0.05551, total FA: 433

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.25805 | acc=0.2877 | tpr=0.0143 | fpr=0.1184 | 4355.7 samples/s | 17.0 steps/s
Avg test loss: 6.25862, Avg test acc: 0.28568, Avg tpr: 0.01545, Avg fpr: 0.11998, total FA: 936

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.64591 | acc=0.2956 | tpr=0.0159 | fpr=0.0969 | 4333.6 samples/s | 16.9 steps/s
Avg test loss: 6.65067, Avg test acc: 0.29349, Avg tpr: 0.01708, Avg fpr: 0.09858, total FA: 769

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.30135 | acc=0.1437 | tpr=0.5973 | fpr=0.8645 | 4370.3 samples/s | 17.1 steps/s
[Step= 100] | Loss=5.28247 | acc=0.1472 | tpr=0.6183 | fpr=0.8616 | 8592.9 samples/s | 33.6 steps/s
[Step= 150] | Loss=5.28392 | acc=0.1468 | tpr=0.6138 | fpr=0.8617 | 8838.1 samples/s | 34.5 steps/s
[Step= 200] | Loss=5.27345 | acc=0.1472 | tpr=0.6066 | fpr=0.8612 | 8625.7 samples/s | 33.7 steps/s
[Step= 250] | Loss=5.27111 | acc=0.1471 | tpr=0.5948 | fpr=0.8610 | 8710.4 samples/s | 34.0 steps/s
[Step= 300] | Loss=5.26578 | acc=0.1476 | tpr=0.5978 | fpr=0.8606 | 8897.6 samples/s | 34.8 steps/s
[Step= 350] | Loss=5.26159 | acc=0.1471 | tpr=0.6024 | fpr=0.8612 | 8554.4 samples/s | 33.4 steps/s
[Step= 400] | Loss=5.25542 | acc=0.1469 | tpr=0.6072 | fpr=0.8614 | 8798.3 samples/s | 34.4 steps/s
[Step= 450] | Loss=5.25186 | acc=0.1470 | tpr=0.6134 | fpr=0.8614 | 8708.3 samples/s | 34.0 steps/s
[Step= 500] | Loss=5.25432 | acc=0.1471 | tpr=0.6159 | fpr=0.8614 | 8802.0 samples/s | 34.4 steps/s
[Step= 550] | Loss=5.25530 | acc=0.1474 | tpr=0.6128 | fpr=0.8610 | 15138.3 samples/s | 59.1 steps/s
Avg test loss: 5.25632, Avg test acc: 0.14731, Avg tpr: 0.61252, Avg fpr: 0.86114, total FA: 119568

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.64118 | acc=0.1310 | tpr=0.6195 | fpr=0.8778 | 4343.2 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.62076 | acc=0.1339 | tpr=0.6461 | fpr=0.8757 | 8722.7 samples/s | 34.1 steps/s
[Step= 150] | Loss=5.62105 | acc=0.1336 | tpr=0.6326 | fpr=0.8756 | 8386.1 samples/s | 32.8 steps/s
[Step= 200] | Loss=5.60988 | acc=0.1338 | tpr=0.6251 | fpr=0.8751 | 8752.0 samples/s | 34.2 steps/s
[Step= 250] | Loss=5.60885 | acc=0.1339 | tpr=0.6114 | fpr=0.8748 | 8917.2 samples/s | 34.8 steps/s
[Step= 300] | Loss=5.60507 | acc=0.1341 | tpr=0.6145 | fpr=0.8746 | 8512.5 samples/s | 33.3 steps/s
[Step= 350] | Loss=5.60168 | acc=0.1337 | tpr=0.6199 | fpr=0.8752 | 8570.8 samples/s | 33.5 steps/s
[Step= 400] | Loss=5.59529 | acc=0.1335 | tpr=0.6209 | fpr=0.8753 | 8526.9 samples/s | 33.3 steps/s
[Step= 450] | Loss=5.59184 | acc=0.1335 | tpr=0.6246 | fpr=0.8754 | 8915.7 samples/s | 34.8 steps/s
[Step= 500] | Loss=5.59375 | acc=0.1334 | tpr=0.6273 | fpr=0.8755 | 8496.3 samples/s | 33.2 steps/s
[Step= 550] | Loss=5.59408 | acc=0.1335 | tpr=0.6244 | fpr=0.8754 | 16275.3 samples/s | 63.6 steps/s
Avg test loss: 5.59498, Avg test acc: 0.13338, Avg tpr: 0.62441, Avg fpr: 0.87555, total FA: 121568

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12763 | acc=0.9804 | tpr=0.9602 | fpr=0.0192 | 4334.0 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.13630 | acc=0.9791 | tpr=0.9701 | fpr=0.0208 | 8896.6 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.14170 | acc=0.9782 | tpr=0.9654 | fpr=0.0215 | 8456.7 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.14185 | acc=0.9788 | tpr=0.9661 | fpr=0.0210 | 8517.9 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.13982 | acc=0.9791 | tpr=0.9659 | fpr=0.0207 | 8932.0 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.14128 | acc=0.9790 | tpr=0.9665 | fpr=0.0208 | 9278.1 samples/s | 36.2 steps/s
[Step= 350] | Loss=0.14203 | acc=0.9788 | tpr=0.9674 | fpr=0.0210 | 8103.1 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.14368 | acc=0.9784 | tpr=0.9639 | fpr=0.0213 | 8827.4 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.14712 | acc=0.9783 | tpr=0.9615 | fpr=0.0214 | 8851.7 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.14640 | acc=0.9782 | tpr=0.9626 | fpr=0.0215 | 8789.2 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.14513 | acc=0.9784 | tpr=0.9622 | fpr=0.0213 | 14243.8 samples/s | 55.6 steps/s
Avg test loss: 0.14480, Avg test acc: 0.97841, Avg tpr: 0.96236, Avg fpr: 0.02130, total FA: 2957

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14737 | acc=0.9803 | tpr=0.9513 | fpr=0.0192 | 4323.6 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.15684 | acc=0.9789 | tpr=0.9680 | fpr=0.0209 | 8850.7 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.16348 | acc=0.9780 | tpr=0.9640 | fpr=0.0218 | 8477.0 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.16377 | acc=0.9784 | tpr=0.9639 | fpr=0.0214 | 8832.7 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.16132 | acc=0.9787 | tpr=0.9624 | fpr=0.0210 | 8774.1 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.16289 | acc=0.9785 | tpr=0.9636 | fpr=0.0212 | 8541.5 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.16365 | acc=0.9783 | tpr=0.9649 | fpr=0.0214 | 8793.9 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.16536 | acc=0.9781 | tpr=0.9617 | fpr=0.0216 | 8861.4 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.16936 | acc=0.9779 | tpr=0.9596 | fpr=0.0218 | 8741.5 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.16850 | acc=0.9778 | tpr=0.9608 | fpr=0.0218 | 8710.5 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.16716 | acc=0.9780 | tpr=0.9606 | fpr=0.0217 | 14944.6 samples/s | 58.4 steps/s
Avg test loss: 0.16676, Avg test acc: 0.97799, Avg tpr: 0.96078, Avg fpr: 0.02169, total FA: 3012

server round 42/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=46001 Epoch=89.7] | Loss=0.03703 | Reg=0.00137 | acc=0.9531 | L2-Norm=11.698 | L2-Norm(final)=10.385 | 3753.2 samples/s | 58.6 steps/s
[Step=46050 Epoch=89.8] | Loss=0.00828 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=10.387 | 5233.9 samples/s | 81.8 steps/s
[Step=46100 Epoch=89.9] | Loss=0.00780 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=10.390 | 5694.7 samples/s | 89.0 steps/s
[Step=46150 Epoch=90.0] | Loss=0.00772 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.698 | L2-Norm(final)=10.392 | 5634.5 samples/s | 88.0 steps/s
[Step=46200 Epoch=90.1] | Loss=0.00810 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=10.394 | 5667.5 samples/s | 88.6 steps/s
[Step=46250 Epoch=90.2] | Loss=0.00827 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.698 | L2-Norm(final)=10.395 | 5779.0 samples/s | 90.3 steps/s
[Step=46300 Epoch=90.3] | Loss=0.00819 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=10.397 | 5594.2 samples/s | 87.4 steps/s
[Step=46350 Epoch=90.4] | Loss=0.00817 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=10.399 | 5642.1 samples/s | 88.2 steps/s
[Step=46400 Epoch=90.5] | Loss=0.00824 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=10.401 | 5688.5 samples/s | 88.9 steps/s
[Step=46450 Epoch=90.6] | Loss=0.00808 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.698 | L2-Norm(final)=10.404 | 5671.2 samples/s | 88.6 steps/s
[Step=46500 Epoch=90.7] | Loss=0.00829 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=10.406 | 7199.5 samples/s | 112.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=90.7] | Loss=0.01600 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.698 | L2-Norm(final)=10.427 | 3768.9 samples/s | 58.9 steps/s
[Step=46550 Epoch=90.8] | Loss=0.00834 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.701 | L2-Norm(final)=10.428 | 4560.2 samples/s | 71.3 steps/s
[Step=46600 Epoch=90.9] | Loss=0.00846 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=10.429 | 4967.6 samples/s | 77.6 steps/s
[Step=46650 Epoch=91.0] | Loss=0.00849 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.707 | L2-Norm(final)=10.430 | 4973.1 samples/s | 77.7 steps/s
[Step=46700 Epoch=91.1] | Loss=0.00788 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.710 | L2-Norm(final)=10.431 | 4890.0 samples/s | 76.4 steps/s
[Step=46750 Epoch=91.2] | Loss=0.00775 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.712 | L2-Norm(final)=10.432 | 4955.7 samples/s | 77.4 steps/s
[Step=46800 Epoch=91.3] | Loss=0.00785 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.714 | L2-Norm(final)=10.434 | 4953.6 samples/s | 77.4 steps/s
[Step=46850 Epoch=91.4] | Loss=0.00766 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.717 | L2-Norm(final)=10.435 | 4958.8 samples/s | 77.5 steps/s
[Step=46900 Epoch=91.5] | Loss=0.00742 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.719 | L2-Norm(final)=10.437 | 4930.8 samples/s | 77.0 steps/s
[Step=46950 Epoch=91.6] | Loss=0.00722 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.721 | L2-Norm(final)=10.438 | 4983.4 samples/s | 77.9 steps/s
[Step=47000 Epoch=91.7] | Loss=0.00735 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.723 | L2-Norm(final)=10.440 | 5992.8 samples/s | 93.6 steps/s
[Step=47050 Epoch=91.8] | Loss=0.00713 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.724 | L2-Norm(final)=10.441 | 1856.8 samples/s | 29.0 steps/s
[Step=47100 Epoch=91.9] | Loss=0.00694 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.726 | L2-Norm(final)=10.443 | 4938.4 samples/s | 77.2 steps/s
[Step=47150 Epoch=92.0] | Loss=0.00669 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.728 | L2-Norm(final)=10.444 | 4917.1 samples/s | 76.8 steps/s
[Step=47200 Epoch=92.1] | Loss=0.00660 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=10.446 | 4963.0 samples/s | 77.5 steps/s
[Step=47250 Epoch=92.2] | Loss=0.00654 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.731 | L2-Norm(final)=10.447 | 5030.1 samples/s | 78.6 steps/s
[Step=47300 Epoch=92.3] | Loss=0.00642 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.732 | L2-Norm(final)=10.448 | 4899.8 samples/s | 76.6 steps/s
[Step=47350 Epoch=92.4] | Loss=0.00637 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.734 | L2-Norm(final)=10.450 | 4991.5 samples/s | 78.0 steps/s
[Step=47400 Epoch=92.4] | Loss=0.00637 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.735 | L2-Norm(final)=10.451 | 4996.7 samples/s | 78.1 steps/s
[Step=47450 Epoch=92.5] | Loss=0.00629 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.736 | L2-Norm(final)=10.452 | 4922.9 samples/s | 76.9 steps/s
[Step=47500 Epoch=92.6] | Loss=0.00626 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=10.454 | 5278.7 samples/s | 82.5 steps/s
[Step=47550 Epoch=92.7] | Loss=0.00625 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.739 | L2-Norm(final)=10.455 | 1930.3 samples/s | 30.2 steps/s
[Step=47600 Epoch=92.8] | Loss=0.00619 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.740 | L2-Norm(final)=10.456 | 4891.2 samples/s | 76.4 steps/s
[Step=47650 Epoch=92.9] | Loss=0.00609 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.741 | L2-Norm(final)=10.458 | 4916.4 samples/s | 76.8 steps/s
[Step=47700 Epoch=93.0] | Loss=0.00607 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.743 | L2-Norm(final)=10.459 | 4971.3 samples/s | 77.7 steps/s
[Step=47750 Epoch=93.1] | Loss=0.00604 | Reg=0.00138 | acc=0.9531 | L2-Norm=11.744 | L2-Norm(final)=10.460 | 4923.9 samples/s | 76.9 steps/s
[Step=47800 Epoch=93.2] | Loss=0.00594 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.745 | L2-Norm(final)=10.462 | 4910.4 samples/s | 76.7 steps/s
[Step=47850 Epoch=93.3] | Loss=0.00586 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.746 | L2-Norm(final)=10.463 | 4955.2 samples/s | 77.4 steps/s
[Step=47900 Epoch=93.4] | Loss=0.00587 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.747 | L2-Norm(final)=10.464 | 4936.7 samples/s | 77.1 steps/s
[Step=47950 Epoch=93.5] | Loss=0.00587 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.748 | L2-Norm(final)=10.466 | 4983.8 samples/s | 77.9 steps/s
[Step=48000 Epoch=93.6] | Loss=0.00585 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.749 | L2-Norm(final)=10.467 | 4946.3 samples/s | 77.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step48000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=42001 Epoch=82.1] | Loss=0.00853 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=9.953 | 3933.1 samples/s | 61.5 steps/s
[Step=42050 Epoch=82.2] | Loss=0.00783 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=9.954 | 5523.4 samples/s | 86.3 steps/s
[Step=42100 Epoch=82.3] | Loss=0.00708 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=9.957 | 5676.8 samples/s | 88.7 steps/s
[Step=42150 Epoch=82.4] | Loss=0.00749 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.698 | L2-Norm(final)=9.959 | 5670.1 samples/s | 88.6 steps/s
[Step=42200 Epoch=82.5] | Loss=0.00753 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.698 | L2-Norm(final)=9.962 | 5715.6 samples/s | 89.3 steps/s
[Step=42250 Epoch=82.6] | Loss=0.00715 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=9.965 | 5664.0 samples/s | 88.5 steps/s
[Step=42300 Epoch=82.7] | Loss=0.00752 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.698 | L2-Norm(final)=9.967 | 5716.7 samples/s | 89.3 steps/s
[Step=42350 Epoch=82.8] | Loss=0.00728 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=9.970 | 5703.9 samples/s | 89.1 steps/s
[Step=42400 Epoch=82.9] | Loss=0.00727 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=9.972 | 5699.4 samples/s | 89.1 steps/s
[Step=42450 Epoch=83.0] | Loss=0.00736 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=9.974 | 5616.9 samples/s | 87.8 steps/s
[Step=42500 Epoch=83.1] | Loss=0.00740 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=9.976 | 7360.1 samples/s | 115.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=83.1] | Loss=0.00532 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=9.998 | 3922.5 samples/s | 61.3 steps/s
[Step=42550 Epoch=83.2] | Loss=0.00947 | Reg=0.00137 | acc=0.9375 | L2-Norm=11.700 | L2-Norm(final)=9.999 | 4661.8 samples/s | 72.8 steps/s
[Step=42600 Epoch=83.3] | Loss=0.00911 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.703 | L2-Norm(final)=10.000 | 4956.3 samples/s | 77.4 steps/s
[Step=42650 Epoch=83.4] | Loss=0.00871 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.704 | L2-Norm(final)=10.001 | 4937.7 samples/s | 77.2 steps/s
[Step=42700 Epoch=83.5] | Loss=0.00839 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.706 | L2-Norm(final)=10.002 | 4907.4 samples/s | 76.7 steps/s
[Step=42750 Epoch=83.6] | Loss=0.00819 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.708 | L2-Norm(final)=10.003 | 4995.3 samples/s | 78.1 steps/s
[Step=42800 Epoch=83.7] | Loss=0.00764 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.710 | L2-Norm(final)=10.004 | 4947.7 samples/s | 77.3 steps/s
[Step=42850 Epoch=83.8] | Loss=0.00744 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.712 | L2-Norm(final)=10.005 | 4998.6 samples/s | 78.1 steps/s
[Step=42900 Epoch=83.9] | Loss=0.00741 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.713 | L2-Norm(final)=10.006 | 4914.6 samples/s | 76.8 steps/s
[Step=42950 Epoch=84.0] | Loss=0.00729 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.715 | L2-Norm(final)=10.007 | 4990.1 samples/s | 78.0 steps/s
[Step=43000 Epoch=84.1] | Loss=0.00730 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.716 | L2-Norm(final)=10.009 | 6125.6 samples/s | 95.7 steps/s
[Step=43050 Epoch=84.2] | Loss=0.00709 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.718 | L2-Norm(final)=10.010 | 1929.6 samples/s | 30.1 steps/s
[Step=43100 Epoch=84.3] | Loss=0.00702 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.719 | L2-Norm(final)=10.011 | 4940.5 samples/s | 77.2 steps/s
[Step=43150 Epoch=84.4] | Loss=0.00693 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.720 | L2-Norm(final)=10.013 | 4865.9 samples/s | 76.0 steps/s
[Step=43200 Epoch=84.5] | Loss=0.00679 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.722 | L2-Norm(final)=10.014 | 4813.4 samples/s | 75.2 steps/s
[Step=43250 Epoch=84.6] | Loss=0.00661 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.723 | L2-Norm(final)=10.015 | 4816.2 samples/s | 75.3 steps/s
[Step=43300 Epoch=84.7] | Loss=0.00650 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.724 | L2-Norm(final)=10.017 | 4877.2 samples/s | 76.2 steps/s
[Step=43350 Epoch=84.7] | Loss=0.00640 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.725 | L2-Norm(final)=10.018 | 4805.1 samples/s | 75.1 steps/s
[Step=43400 Epoch=84.8] | Loss=0.00628 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.727 | L2-Norm(final)=10.020 | 4973.0 samples/s | 77.7 steps/s
[Step=43450 Epoch=84.9] | Loss=0.00626 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.728 | L2-Norm(final)=10.021 | 4922.3 samples/s | 76.9 steps/s
[Step=43500 Epoch=85.0] | Loss=0.00623 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=10.022 | 5384.5 samples/s | 84.1 steps/s
[Step=43550 Epoch=85.1] | Loss=0.00613 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.730 | L2-Norm(final)=10.024 | 2013.5 samples/s | 31.5 steps/s
[Step=43600 Epoch=85.2] | Loss=0.00604 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.731 | L2-Norm(final)=10.025 | 4901.1 samples/s | 76.6 steps/s
[Step=43650 Epoch=85.3] | Loss=0.00600 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.732 | L2-Norm(final)=10.026 | 4944.3 samples/s | 77.3 steps/s
[Step=43700 Epoch=85.4] | Loss=0.00601 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.733 | L2-Norm(final)=10.028 | 4963.6 samples/s | 77.6 steps/s
[Step=43750 Epoch=85.5] | Loss=0.00591 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.734 | L2-Norm(final)=10.029 | 4919.9 samples/s | 76.9 steps/s
[Step=43800 Epoch=85.6] | Loss=0.00587 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.735 | L2-Norm(final)=10.030 | 4940.2 samples/s | 77.2 steps/s
[Step=43850 Epoch=85.7] | Loss=0.00580 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.736 | L2-Norm(final)=10.032 | 4971.6 samples/s | 77.7 steps/s
[Step=43900 Epoch=85.8] | Loss=0.00570 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.737 | L2-Norm(final)=10.033 | 4955.8 samples/s | 77.4 steps/s
[Step=43950 Epoch=85.9] | Loss=0.00566 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=10.035 | 4955.2 samples/s | 77.4 steps/s
[Step=44000 Epoch=86.0] | Loss=0.00560 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.739 | L2-Norm(final)=10.036 | 4958.9 samples/s | 77.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step44000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07651 | acc=0.9711 | tpr=0.9785 | fpr=0.0451 | 4491.2 samples/s | 17.5 steps/s
Avg test loss: 0.07873, Avg test acc: 0.96911, Avg tpr: 0.97692, Avg fpr: 0.04807, total FA: 375

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07710 | acc=0.9706 | tpr=0.9747 | fpr=0.0382 | 4302.7 samples/s | 16.8 steps/s
Avg test loss: 0.08060, Avg test acc: 0.96831, Avg tpr: 0.97307, Avg fpr: 0.04217, total FA: 329

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.25805 | acc=0.2877 | tpr=0.0143 | fpr=0.1184 | 4358.9 samples/s | 17.0 steps/s
Avg test loss: 6.25862, Avg test acc: 0.28568, Avg tpr: 0.01545, Avg fpr: 0.11998, total FA: 936

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.64591 | acc=0.2956 | tpr=0.0159 | fpr=0.0969 | 4368.4 samples/s | 17.1 steps/s
Avg test loss: 6.65067, Avg test acc: 0.29349, Avg tpr: 0.01708, Avg fpr: 0.09858, total FA: 769

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.65375 | acc=0.1311 | tpr=0.6195 | fpr=0.8777 | 4321.9 samples/s | 16.9 steps/s
[Step= 100] | Loss=5.63285 | acc=0.1341 | tpr=0.6503 | fpr=0.8756 | 8821.4 samples/s | 34.5 steps/s
[Step= 150] | Loss=5.63580 | acc=0.1335 | tpr=0.6412 | fpr=0.8758 | 8707.0 samples/s | 34.0 steps/s
[Step= 200] | Loss=5.62460 | acc=0.1344 | tpr=0.6350 | fpr=0.8747 | 8874.7 samples/s | 34.7 steps/s
[Step= 250] | Loss=5.62242 | acc=0.1344 | tpr=0.6183 | fpr=0.8744 | 8421.1 samples/s | 32.9 steps/s
[Step= 300] | Loss=5.61732 | acc=0.1348 | tpr=0.6240 | fpr=0.8741 | 8721.8 samples/s | 34.1 steps/s
[Step= 350] | Loss=5.61350 | acc=0.1341 | tpr=0.6268 | fpr=0.8748 | 9068.3 samples/s | 35.4 steps/s
[Step= 400] | Loss=5.60749 | acc=0.1336 | tpr=0.6302 | fpr=0.8754 | 8315.6 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.60401 | acc=0.1338 | tpr=0.6349 | fpr=0.8753 | 8765.6 samples/s | 34.2 steps/s
[Step= 500] | Loss=5.60655 | acc=0.1337 | tpr=0.6366 | fpr=0.8754 | 9055.4 samples/s | 35.4 steps/s
[Step= 550] | Loss=5.60732 | acc=0.1342 | tpr=0.6355 | fpr=0.8749 | 14628.0 samples/s | 57.1 steps/s
Avg test loss: 5.60845, Avg test acc: 0.13403, Avg tpr: 0.63550, Avg fpr: 0.87509, total FA: 121504

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.49855 | acc=0.1509 | tpr=0.5752 | fpr=0.8568 | 4313.5 samples/s | 16.8 steps/s
[Step= 100] | Loss=5.47768 | acc=0.1535 | tpr=0.5949 | fpr=0.8547 | 8799.7 samples/s | 34.4 steps/s
[Step= 150] | Loss=5.47909 | acc=0.1539 | tpr=0.5735 | fpr=0.8538 | 9114.5 samples/s | 35.6 steps/s
[Step= 200] | Loss=5.46789 | acc=0.1542 | tpr=0.5705 | fpr=0.8533 | 8215.8 samples/s | 32.1 steps/s
[Step= 250] | Loss=5.46656 | acc=0.1545 | tpr=0.5590 | fpr=0.8529 | 8785.8 samples/s | 34.3 steps/s
[Step= 300] | Loss=5.46199 | acc=0.1549 | tpr=0.5658 | fpr=0.8526 | 8742.2 samples/s | 34.1 steps/s
[Step= 350] | Loss=5.45806 | acc=0.1540 | tpr=0.5686 | fpr=0.8536 | 8691.4 samples/s | 34.0 steps/s
[Step= 400] | Loss=5.45117 | acc=0.1541 | tpr=0.5706 | fpr=0.8535 | 8676.4 samples/s | 33.9 steps/s
[Step= 450] | Loss=5.44686 | acc=0.1542 | tpr=0.5730 | fpr=0.8534 | 8706.6 samples/s | 34.0 steps/s
[Step= 500] | Loss=5.44889 | acc=0.1542 | tpr=0.5753 | fpr=0.8534 | 8727.2 samples/s | 34.1 steps/s
[Step= 550] | Loss=5.44981 | acc=0.1543 | tpr=0.5718 | fpr=0.8533 | 14974.4 samples/s | 58.5 steps/s
Avg test loss: 5.45071, Avg test acc: 0.15420, Avg tpr: 0.57211, Avg fpr: 0.85340, total FA: 118493

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12763 | acc=0.9804 | tpr=0.9602 | fpr=0.0192 | 4375.3 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.13630 | acc=0.9791 | tpr=0.9701 | fpr=0.0208 | 8608.1 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.14170 | acc=0.9782 | tpr=0.9654 | fpr=0.0215 | 8713.3 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.14185 | acc=0.9788 | tpr=0.9661 | fpr=0.0210 | 8839.0 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.13982 | acc=0.9791 | tpr=0.9659 | fpr=0.0207 | 8614.2 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.14128 | acc=0.9790 | tpr=0.9665 | fpr=0.0208 | 8851.0 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.14203 | acc=0.9788 | tpr=0.9674 | fpr=0.0210 | 9169.1 samples/s | 35.8 steps/s
[Step= 400] | Loss=0.14368 | acc=0.9784 | tpr=0.9639 | fpr=0.0213 | 8329.7 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.14712 | acc=0.9783 | tpr=0.9615 | fpr=0.0214 | 8996.9 samples/s | 35.1 steps/s
[Step= 500] | Loss=0.14640 | acc=0.9782 | tpr=0.9626 | fpr=0.0215 | 8255.1 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.14513 | acc=0.9784 | tpr=0.9622 | fpr=0.0213 | 15955.0 samples/s | 62.3 steps/s
Avg test loss: 0.14480, Avg test acc: 0.97841, Avg tpr: 0.96236, Avg fpr: 0.02130, total FA: 2957

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14737 | acc=0.9803 | tpr=0.9513 | fpr=0.0192 | 4357.5 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.15684 | acc=0.9789 | tpr=0.9680 | fpr=0.0209 | 8570.4 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.16348 | acc=0.9780 | tpr=0.9640 | fpr=0.0218 | 8636.8 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.16377 | acc=0.9784 | tpr=0.9639 | fpr=0.0214 | 9060.8 samples/s | 35.4 steps/s
[Step= 250] | Loss=0.16132 | acc=0.9787 | tpr=0.9624 | fpr=0.0210 | 8740.8 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.16289 | acc=0.9785 | tpr=0.9636 | fpr=0.0212 | 8741.0 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.16365 | acc=0.9783 | tpr=0.9649 | fpr=0.0214 | 8451.5 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.16536 | acc=0.9781 | tpr=0.9617 | fpr=0.0216 | 8448.3 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.16936 | acc=0.9779 | tpr=0.9596 | fpr=0.0218 | 8886.3 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.16850 | acc=0.9778 | tpr=0.9608 | fpr=0.0218 | 8595.0 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.16716 | acc=0.9780 | tpr=0.9606 | fpr=0.0217 | 16149.0 samples/s | 63.1 steps/s
Avg test loss: 0.16676, Avg test acc: 0.97799, Avg tpr: 0.96078, Avg fpr: 0.02169, total FA: 3012

server round 43/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=44001 Epoch=86.0] | Loss=0.00129 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=10.075 | 4029.9 samples/s | 63.0 steps/s
[Step=44050 Epoch=86.1] | Loss=0.00631 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=10.077 | 5241.4 samples/s | 81.9 steps/s
[Step=44100 Epoch=86.2] | Loss=0.00688 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=10.077 | 5682.1 samples/s | 88.8 steps/s
[Step=44150 Epoch=86.3] | Loss=0.00734 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=10.079 | 5638.3 samples/s | 88.1 steps/s
[Step=44200 Epoch=86.4] | Loss=0.00710 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.675 | L2-Norm(final)=10.080 | 5675.9 samples/s | 88.7 steps/s
[Step=44250 Epoch=86.5] | Loss=0.00733 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.675 | L2-Norm(final)=10.081 | 5725.0 samples/s | 89.5 steps/s
[Step=44300 Epoch=86.6] | Loss=0.00745 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.675 | L2-Norm(final)=10.083 | 5636.0 samples/s | 88.1 steps/s
[Step=44350 Epoch=86.7] | Loss=0.00738 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=10.085 | 5654.3 samples/s | 88.3 steps/s
[Step=44400 Epoch=86.8] | Loss=0.00733 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=10.086 | 5688.1 samples/s | 88.9 steps/s
[Step=44450 Epoch=86.9] | Loss=0.00722 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.675 | L2-Norm(final)=10.088 | 5735.5 samples/s | 89.6 steps/s
[Step=44500 Epoch=87.0] | Loss=0.00732 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=10.089 | 7251.7 samples/s | 113.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=87.0] | Loss=0.00127 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=10.104 | 3757.9 samples/s | 58.7 steps/s
[Step=44550 Epoch=87.1] | Loss=0.00741 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.678 | L2-Norm(final)=10.105 | 4876.8 samples/s | 76.2 steps/s
[Step=44600 Epoch=87.2] | Loss=0.00790 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.680 | L2-Norm(final)=10.106 | 4919.3 samples/s | 76.9 steps/s
[Step=44650 Epoch=87.3] | Loss=0.00818 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.682 | L2-Norm(final)=10.108 | 4948.0 samples/s | 77.3 steps/s
[Step=44700 Epoch=87.4] | Loss=0.00802 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.684 | L2-Norm(final)=10.109 | 4918.0 samples/s | 76.8 steps/s
[Step=44750 Epoch=87.5] | Loss=0.00754 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.686 | L2-Norm(final)=10.110 | 4939.6 samples/s | 77.2 steps/s
[Step=44800 Epoch=87.6] | Loss=0.00741 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.688 | L2-Norm(final)=10.112 | 4995.7 samples/s | 78.1 steps/s
[Step=44850 Epoch=87.7] | Loss=0.00738 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.690 | L2-Norm(final)=10.113 | 4903.5 samples/s | 76.6 steps/s
[Step=44900 Epoch=87.8] | Loss=0.00735 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.691 | L2-Norm(final)=10.114 | 4996.8 samples/s | 78.1 steps/s
[Step=44950 Epoch=87.9] | Loss=0.00707 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.693 | L2-Norm(final)=10.115 | 5002.9 samples/s | 78.2 steps/s
[Step=45000 Epoch=88.0] | Loss=0.00691 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.694 | L2-Norm(final)=10.117 | 6042.1 samples/s | 94.4 steps/s
[Step=45050 Epoch=88.1] | Loss=0.00684 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.696 | L2-Norm(final)=10.118 | 1925.8 samples/s | 30.1 steps/s
[Step=45100 Epoch=88.2] | Loss=0.00652 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=10.119 | 4907.3 samples/s | 76.7 steps/s
[Step=45150 Epoch=88.3] | Loss=0.00636 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.699 | L2-Norm(final)=10.121 | 4912.9 samples/s | 76.8 steps/s
[Step=45200 Epoch=88.4] | Loss=0.00626 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.700 | L2-Norm(final)=10.122 | 4977.4 samples/s | 77.8 steps/s
[Step=45250 Epoch=88.5] | Loss=0.00618 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.701 | L2-Norm(final)=10.124 | 4903.5 samples/s | 76.6 steps/s
[Step=45300 Epoch=88.6] | Loss=0.00612 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.702 | L2-Norm(final)=10.125 | 4957.2 samples/s | 77.5 steps/s
[Step=45350 Epoch=88.7] | Loss=0.00610 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.704 | L2-Norm(final)=10.126 | 4972.7 samples/s | 77.7 steps/s
[Step=45400 Epoch=88.8] | Loss=0.00613 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=10.128 | 4929.9 samples/s | 77.0 steps/s
[Step=45450 Epoch=88.9] | Loss=0.00608 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.706 | L2-Norm(final)=10.129 | 5056.9 samples/s | 79.0 steps/s
[Step=45500 Epoch=89.0] | Loss=0.00603 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.707 | L2-Norm(final)=10.130 | 5291.2 samples/s | 82.7 steps/s
[Step=45550 Epoch=89.0] | Loss=0.00602 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.708 | L2-Norm(final)=10.131 | 2014.0 samples/s | 31.5 steps/s
[Step=45600 Epoch=89.1] | Loss=0.00598 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.709 | L2-Norm(final)=10.132 | 4943.2 samples/s | 77.2 steps/s
[Step=45650 Epoch=89.2] | Loss=0.00591 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.710 | L2-Norm(final)=10.134 | 4970.9 samples/s | 77.7 steps/s
[Step=45700 Epoch=89.3] | Loss=0.00584 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.711 | L2-Norm(final)=10.135 | 4900.4 samples/s | 76.6 steps/s
[Step=45750 Epoch=89.4] | Loss=0.00576 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.712 | L2-Norm(final)=10.136 | 5020.0 samples/s | 78.4 steps/s
[Step=45800 Epoch=89.5] | Loss=0.00569 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.713 | L2-Norm(final)=10.137 | 4900.9 samples/s | 76.6 steps/s
[Step=45850 Epoch=89.6] | Loss=0.00567 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.714 | L2-Norm(final)=10.138 | 5001.1 samples/s | 78.1 steps/s
[Step=45900 Epoch=89.7] | Loss=0.00561 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.715 | L2-Norm(final)=10.140 | 4974.6 samples/s | 77.7 steps/s
[Step=45950 Epoch=89.8] | Loss=0.00562 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.716 | L2-Norm(final)=10.141 | 4992.6 samples/s | 78.0 steps/s
[Step=46000 Epoch=89.9] | Loss=0.00556 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.717 | L2-Norm(final)=10.142 | 4968.3 samples/s | 77.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step46000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=42001 Epoch=161.7] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=12.186 | 3800.1 samples/s | 59.4 steps/s
[Step=42050 Epoch=161.9] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=12.187 | 5216.6 samples/s | 81.5 steps/s
[Step=42100 Epoch=162.1] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=12.189 | 5461.8 samples/s | 85.3 steps/s
[Step=42150 Epoch=162.3] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=12.191 | 5336.8 samples/s | 83.4 steps/s
[Step=42200 Epoch=162.4] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=12.193 | 5361.5 samples/s | 83.8 steps/s
[Step=42250 Epoch=162.6] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=12.194 | 7063.1 samples/s | 110.4 steps/s
[Step=42300 Epoch=162.8] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=12.196 | 1914.2 samples/s | 29.9 steps/s
[Step=42350 Epoch=163.0] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=12.197 | 5371.1 samples/s | 83.9 steps/s
[Step=42400 Epoch=163.2] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=12.198 | 5291.8 samples/s | 82.7 steps/s
[Step=42450 Epoch=163.4] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=12.200 | 5373.7 samples/s | 84.0 steps/s
[Step=42500 Epoch=163.6] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=12.201 | 6233.1 samples/s | 97.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=163.6] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=12.216 | 3715.7 samples/s | 58.1 steps/s
[Step=42550 Epoch=163.8] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=12.217 | 4674.5 samples/s | 73.0 steps/s
[Step=42600 Epoch=164.0] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.667 | L2-Norm(final)=12.217 | 4700.3 samples/s | 73.4 steps/s
[Step=42650 Epoch=164.2] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.663 | L2-Norm(final)=12.218 | 4694.7 samples/s | 73.4 steps/s
[Step=42700 Epoch=164.4] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.659 | L2-Norm(final)=12.219 | 4672.1 samples/s | 73.0 steps/s
[Step=42750 Epoch=164.6] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=12.220 | 6027.3 samples/s | 94.2 steps/s
[Step=42800 Epoch=164.8] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.651 | L2-Norm(final)=12.221 | 1845.1 samples/s | 28.8 steps/s
[Step=42850 Epoch=164.9] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.646 | L2-Norm(final)=12.221 | 4758.0 samples/s | 74.3 steps/s
[Step=42900 Epoch=165.1] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.642 | L2-Norm(final)=12.222 | 4691.8 samples/s | 73.3 steps/s
[Step=42950 Epoch=165.3] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.637 | L2-Norm(final)=12.223 | 4734.4 samples/s | 74.0 steps/s
[Step=43000 Epoch=165.5] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.632 | L2-Norm(final)=12.223 | 5343.3 samples/s | 83.5 steps/s
[Step=43050 Epoch=165.7] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.627 | L2-Norm(final)=12.224 | 1955.2 samples/s | 30.6 steps/s
[Step=43100 Epoch=165.9] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.623 | L2-Norm(final)=12.224 | 4674.9 samples/s | 73.0 steps/s
[Step=43150 Epoch=166.1] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.618 | L2-Norm(final)=12.225 | 4654.6 samples/s | 72.7 steps/s
[Step=43200 Epoch=166.3] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.613 | L2-Norm(final)=12.225 | 4724.9 samples/s | 73.8 steps/s
[Step=43250 Epoch=166.5] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.608 | L2-Norm(final)=12.226 | 4800.3 samples/s | 75.0 steps/s
[Step=43300 Epoch=166.7] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.603 | L2-Norm(final)=12.227 | 2019.3 samples/s | 31.6 steps/s
[Step=43350 Epoch=166.9] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.597 | L2-Norm(final)=12.227 | 4667.2 samples/s | 72.9 steps/s
[Step=43400 Epoch=167.1] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.592 | L2-Norm(final)=12.228 | 4706.6 samples/s | 73.5 steps/s
[Step=43450 Epoch=167.3] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=12.228 | 4759.8 samples/s | 74.4 steps/s
[Step=43500 Epoch=167.4] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=12.229 | 4693.7 samples/s | 73.3 steps/s
[Step=43550 Epoch=167.6] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.576 | L2-Norm(final)=12.229 | 2026.2 samples/s | 31.7 steps/s
[Step=43600 Epoch=167.8] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.571 | L2-Norm(final)=12.230 | 4733.8 samples/s | 74.0 steps/s
[Step=43650 Epoch=168.0] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.565 | L2-Norm(final)=12.230 | 4719.6 samples/s | 73.7 steps/s
[Step=43700 Epoch=168.2] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.560 | L2-Norm(final)=12.231 | 4665.0 samples/s | 72.9 steps/s
[Step=43750 Epoch=168.4] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.554 | L2-Norm(final)=12.231 | 4793.6 samples/s | 74.9 steps/s
[Step=43800 Epoch=168.6] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.548 | L2-Norm(final)=12.232 | 6817.2 samples/s | 106.5 steps/s
[Step=43850 Epoch=168.8] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.542 | L2-Norm(final)=12.232 | 1787.4 samples/s | 27.9 steps/s
[Step=43900 Epoch=169.0] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.536 | L2-Norm(final)=12.233 | 4659.4 samples/s | 72.8 steps/s
[Step=43950 Epoch=169.2] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.530 | L2-Norm(final)=12.233 | 4720.8 samples/s | 73.8 steps/s
[Step=44000 Epoch=169.4] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=12.234 | 4794.0 samples/s | 74.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step44000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07651 | acc=0.9711 | tpr=0.9785 | fpr=0.0451 | 4301.8 samples/s | 16.8 steps/s
Avg test loss: 0.07873, Avg test acc: 0.96911, Avg tpr: 0.97692, Avg fpr: 0.04807, total FA: 375

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07820 | acc=0.9702 | tpr=0.9789 | fpr=0.0488 | 4323.3 samples/s | 16.9 steps/s
Avg test loss: 0.08191, Avg test acc: 0.96871, Avg tpr: 0.97843, Avg fpr: 0.05269, total FA: 411

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.25805 | acc=0.2877 | tpr=0.0143 | fpr=0.1184 | 4350.6 samples/s | 17.0 steps/s
Avg test loss: 6.25862, Avg test acc: 0.28568, Avg tpr: 0.01545, Avg fpr: 0.11998, total FA: 936

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.40504 | acc=0.2976 | tpr=0.0165 | fpr=0.0922 | 4374.2 samples/s | 17.1 steps/s
Avg test loss: 6.41155, Avg test acc: 0.29498, Avg tpr: 0.01807, Avg fpr: 0.09601, total FA: 749

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.65375 | acc=0.1311 | tpr=0.6195 | fpr=0.8777 | 4317.3 samples/s | 16.9 steps/s
[Step= 100] | Loss=5.63285 | acc=0.1341 | tpr=0.6503 | fpr=0.8756 | 9100.6 samples/s | 35.5 steps/s
[Step= 150] | Loss=5.63580 | acc=0.1335 | tpr=0.6412 | fpr=0.8758 | 8319.8 samples/s | 32.5 steps/s
[Step= 200] | Loss=5.62460 | acc=0.1344 | tpr=0.6350 | fpr=0.8747 | 8987.7 samples/s | 35.1 steps/s
[Step= 250] | Loss=5.62242 | acc=0.1344 | tpr=0.6183 | fpr=0.8744 | 8571.0 samples/s | 33.5 steps/s
[Step= 300] | Loss=5.61732 | acc=0.1348 | tpr=0.6240 | fpr=0.8741 | 8518.3 samples/s | 33.3 steps/s
[Step= 350] | Loss=5.61350 | acc=0.1341 | tpr=0.6268 | fpr=0.8748 | 8649.8 samples/s | 33.8 steps/s
[Step= 400] | Loss=5.60749 | acc=0.1336 | tpr=0.6302 | fpr=0.8754 | 8756.7 samples/s | 34.2 steps/s
[Step= 450] | Loss=5.60401 | acc=0.1338 | tpr=0.6349 | fpr=0.8753 | 8641.2 samples/s | 33.8 steps/s
[Step= 500] | Loss=5.60655 | acc=0.1337 | tpr=0.6366 | fpr=0.8754 | 8766.6 samples/s | 34.2 steps/s
[Step= 550] | Loss=5.60732 | acc=0.1342 | tpr=0.6355 | fpr=0.8749 | 15490.5 samples/s | 60.5 steps/s
Avg test loss: 5.60845, Avg test acc: 0.13403, Avg tpr: 0.63550, Avg fpr: 0.87509, total FA: 121504

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.04414 | acc=0.1334 | tpr=0.6018 | fpr=0.8751 | 4364.2 samples/s | 17.0 steps/s
[Step= 100] | Loss=6.02328 | acc=0.1355 | tpr=0.6247 | fpr=0.8737 | 8728.1 samples/s | 34.1 steps/s
[Step= 150] | Loss=6.02427 | acc=0.1348 | tpr=0.6110 | fpr=0.8739 | 8887.5 samples/s | 34.7 steps/s
[Step= 200] | Loss=6.01252 | acc=0.1356 | tpr=0.6022 | fpr=0.8729 | 8970.2 samples/s | 35.0 steps/s
[Step= 250] | Loss=6.01157 | acc=0.1357 | tpr=0.5886 | fpr=0.8726 | 8619.0 samples/s | 33.7 steps/s
[Step= 300] | Loss=6.00698 | acc=0.1362 | tpr=0.5927 | fpr=0.8721 | 8217.8 samples/s | 32.1 steps/s
[Step= 350] | Loss=6.00279 | acc=0.1357 | tpr=0.5980 | fpr=0.8727 | 8630.5 samples/s | 33.7 steps/s
[Step= 400] | Loss=5.99598 | acc=0.1355 | tpr=0.5985 | fpr=0.8729 | 9010.4 samples/s | 35.2 steps/s
[Step= 450] | Loss=5.99195 | acc=0.1354 | tpr=0.6013 | fpr=0.8731 | 8432.0 samples/s | 32.9 steps/s
[Step= 500] | Loss=5.99442 | acc=0.1352 | tpr=0.6035 | fpr=0.8733 | 8706.7 samples/s | 34.0 steps/s
[Step= 550] | Loss=5.99541 | acc=0.1352 | tpr=0.5997 | fpr=0.8732 | 15472.3 samples/s | 60.4 steps/s
Avg test loss: 5.99637, Avg test acc: 0.13506, Avg tpr: 0.59984, Avg fpr: 0.87339, total FA: 121268

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12763 | acc=0.9804 | tpr=0.9602 | fpr=0.0192 | 4352.7 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.13630 | acc=0.9791 | tpr=0.9701 | fpr=0.0208 | 8770.1 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.14170 | acc=0.9782 | tpr=0.9654 | fpr=0.0215 | 8632.7 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.14185 | acc=0.9788 | tpr=0.9661 | fpr=0.0210 | 8763.8 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.13982 | acc=0.9791 | tpr=0.9659 | fpr=0.0207 | 8751.6 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.14128 | acc=0.9790 | tpr=0.9665 | fpr=0.0208 | 8935.6 samples/s | 34.9 steps/s
[Step= 350] | Loss=0.14203 | acc=0.9788 | tpr=0.9674 | fpr=0.0210 | 8467.0 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.14368 | acc=0.9784 | tpr=0.9639 | fpr=0.0213 | 8434.4 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.14712 | acc=0.9783 | tpr=0.9615 | fpr=0.0214 | 8633.5 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.14640 | acc=0.9782 | tpr=0.9626 | fpr=0.0215 | 8626.9 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.14513 | acc=0.9784 | tpr=0.9622 | fpr=0.0213 | 15470.6 samples/s | 60.4 steps/s
Avg test loss: 0.14480, Avg test acc: 0.97841, Avg tpr: 0.96236, Avg fpr: 0.02130, total FA: 2957

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14258 | acc=0.9797 | tpr=0.9558 | fpr=0.0199 | 4361.7 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.15248 | acc=0.9786 | tpr=0.9701 | fpr=0.0213 | 8678.1 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.15882 | acc=0.9776 | tpr=0.9654 | fpr=0.0222 | 8552.4 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.15886 | acc=0.9780 | tpr=0.9650 | fpr=0.0217 | 8878.9 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.15649 | acc=0.9784 | tpr=0.9642 | fpr=0.0213 | 8443.7 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.15812 | acc=0.9782 | tpr=0.9651 | fpr=0.0216 | 8559.9 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.15887 | acc=0.9780 | tpr=0.9662 | fpr=0.0218 | 8790.5 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.16063 | acc=0.9777 | tpr=0.9628 | fpr=0.0220 | 8652.1 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.16448 | acc=0.9775 | tpr=0.9606 | fpr=0.0222 | 9304.1 samples/s | 36.3 steps/s
[Step= 500] | Loss=0.16369 | acc=0.9775 | tpr=0.9617 | fpr=0.0222 | 8434.8 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.16233 | acc=0.9777 | tpr=0.9614 | fpr=0.0220 | 14731.6 samples/s | 57.5 steps/s
Avg test loss: 0.16197, Avg test acc: 0.97769, Avg tpr: 0.96157, Avg fpr: 0.02202, total FA: 3057

server round 44/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=46001 Epoch=89.9] | Loss=0.01539 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.584 | L2-Norm(final)=10.177 | 3804.8 samples/s | 59.4 steps/s
[Step=46050 Epoch=90.0] | Loss=0.00683 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.584 | L2-Norm(final)=10.181 | 5664.3 samples/s | 88.5 steps/s
[Step=46100 Epoch=90.1] | Loss=0.00729 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.585 | L2-Norm(final)=10.186 | 5824.1 samples/s | 91.0 steps/s
[Step=46150 Epoch=90.2] | Loss=0.00682 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.585 | L2-Norm(final)=10.190 | 5625.8 samples/s | 87.9 steps/s
[Step=46200 Epoch=90.3] | Loss=0.00741 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.585 | L2-Norm(final)=10.194 | 5562.3 samples/s | 86.9 steps/s
[Step=46250 Epoch=90.4] | Loss=0.00750 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.585 | L2-Norm(final)=10.198 | 5731.7 samples/s | 89.6 steps/s
[Step=46300 Epoch=90.5] | Loss=0.00746 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.585 | L2-Norm(final)=10.201 | 5696.2 samples/s | 89.0 steps/s
[Step=46350 Epoch=90.6] | Loss=0.00767 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.585 | L2-Norm(final)=10.204 | 5688.2 samples/s | 88.9 steps/s
[Step=46400 Epoch=90.7] | Loss=0.00786 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.585 | L2-Norm(final)=10.207 | 5653.4 samples/s | 88.3 steps/s
[Step=46450 Epoch=90.8] | Loss=0.00788 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.585 | L2-Norm(final)=10.210 | 5750.3 samples/s | 89.8 steps/s
[Step=46500 Epoch=90.9] | Loss=0.00779 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.585 | L2-Norm(final)=10.213 | 7194.3 samples/s | 112.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=90.9] | Loss=0.00926 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.585 | L2-Norm(final)=10.241 | 3957.2 samples/s | 61.8 steps/s
[Step=46550 Epoch=91.0] | Loss=0.00674 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.587 | L2-Norm(final)=10.243 | 4671.9 samples/s | 73.0 steps/s
[Step=46600 Epoch=91.1] | Loss=0.00690 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.590 | L2-Norm(final)=10.245 | 4982.5 samples/s | 77.9 steps/s
[Step=46650 Epoch=91.2] | Loss=0.00665 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.592 | L2-Norm(final)=10.246 | 4915.8 samples/s | 76.8 steps/s
[Step=46700 Epoch=91.3] | Loss=0.00663 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.595 | L2-Norm(final)=10.248 | 5029.2 samples/s | 78.6 steps/s
[Step=46750 Epoch=91.4] | Loss=0.00674 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.597 | L2-Norm(final)=10.249 | 4888.8 samples/s | 76.4 steps/s
[Step=46800 Epoch=91.5] | Loss=0.00689 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.599 | L2-Norm(final)=10.250 | 4950.9 samples/s | 77.4 steps/s
[Step=46850 Epoch=91.6] | Loss=0.00685 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=10.251 | 4931.8 samples/s | 77.1 steps/s
[Step=46900 Epoch=91.7] | Loss=0.00691 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.602 | L2-Norm(final)=10.252 | 5008.4 samples/s | 78.3 steps/s
[Step=46950 Epoch=91.8] | Loss=0.00692 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.604 | L2-Norm(final)=10.253 | 4978.9 samples/s | 77.8 steps/s
[Step=47000 Epoch=91.9] | Loss=0.00681 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.606 | L2-Norm(final)=10.254 | 6121.6 samples/s | 95.6 steps/s
[Step=47050 Epoch=92.0] | Loss=0.00662 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.607 | L2-Norm(final)=10.255 | 1928.5 samples/s | 30.1 steps/s
[Step=47100 Epoch=92.1] | Loss=0.00643 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.608 | L2-Norm(final)=10.256 | 4850.8 samples/s | 75.8 steps/s
[Step=47150 Epoch=92.2] | Loss=0.00634 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.610 | L2-Norm(final)=10.257 | 4938.4 samples/s | 77.2 steps/s
[Step=47200 Epoch=92.3] | Loss=0.00620 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.611 | L2-Norm(final)=10.258 | 4964.1 samples/s | 77.6 steps/s
[Step=47250 Epoch=92.4] | Loss=0.00627 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.612 | L2-Norm(final)=10.260 | 4951.1 samples/s | 77.4 steps/s
[Step=47300 Epoch=92.5] | Loss=0.00617 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.613 | L2-Norm(final)=10.261 | 5029.8 samples/s | 78.6 steps/s
[Step=47350 Epoch=92.6] | Loss=0.00613 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.615 | L2-Norm(final)=10.262 | 4884.9 samples/s | 76.3 steps/s
[Step=47400 Epoch=92.7] | Loss=0.00602 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.616 | L2-Norm(final)=10.263 | 4948.2 samples/s | 77.3 steps/s
[Step=47450 Epoch=92.8] | Loss=0.00599 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.617 | L2-Norm(final)=10.264 | 4927.8 samples/s | 77.0 steps/s
[Step=47500 Epoch=92.9] | Loss=0.00594 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.618 | L2-Norm(final)=10.266 | 5405.4 samples/s | 84.5 steps/s
[Step=47550 Epoch=93.0] | Loss=0.00585 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.619 | L2-Norm(final)=10.267 | 2000.3 samples/s | 31.3 steps/s
[Step=47600 Epoch=93.1] | Loss=0.00576 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=10.268 | 5041.6 samples/s | 78.8 steps/s
[Step=47650 Epoch=93.2] | Loss=0.00562 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=10.269 | 4882.4 samples/s | 76.3 steps/s
[Step=47700 Epoch=93.3] | Loss=0.00555 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.622 | L2-Norm(final)=10.270 | 4933.0 samples/s | 77.1 steps/s
[Step=47750 Epoch=93.4] | Loss=0.00556 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.623 | L2-Norm(final)=10.272 | 4959.1 samples/s | 77.5 steps/s
[Step=47800 Epoch=93.4] | Loss=0.00552 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.624 | L2-Norm(final)=10.273 | 5003.9 samples/s | 78.2 steps/s
[Step=47850 Epoch=93.5] | Loss=0.00546 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.625 | L2-Norm(final)=10.274 | 4898.8 samples/s | 76.5 steps/s
[Step=47900 Epoch=93.6] | Loss=0.00548 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.626 | L2-Norm(final)=10.275 | 5017.1 samples/s | 78.4 steps/s
[Step=47950 Epoch=93.7] | Loss=0.00549 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.627 | L2-Norm(final)=10.277 | 4902.9 samples/s | 76.6 steps/s
[Step=48000 Epoch=93.8] | Loss=0.00545 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.628 | L2-Norm(final)=10.278 | 4935.7 samples/s | 77.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step48000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=44001 Epoch=169.4] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.584 | L2-Norm(final)=12.249 | 3659.5 samples/s | 57.2 steps/s
[Step=44050 Epoch=169.6] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=12.252 | 5366.5 samples/s | 83.9 steps/s
[Step=44100 Epoch=169.8] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=12.254 | 5251.3 samples/s | 82.1 steps/s
[Step=44150 Epoch=170.0] | Loss=0.00002 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=12.257 | 5361.8 samples/s | 83.8 steps/s
[Step=44200 Epoch=170.1] | Loss=0.00002 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=12.260 | 5268.6 samples/s | 82.3 steps/s
[Step=44250 Epoch=170.3] | Loss=0.00002 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=12.263 | 7216.5 samples/s | 112.8 steps/s
[Step=44300 Epoch=170.5] | Loss=0.00002 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=12.267 | 1915.8 samples/s | 29.9 steps/s
[Step=44350 Epoch=170.7] | Loss=0.00002 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=12.270 | 5281.4 samples/s | 82.5 steps/s
[Step=44400 Epoch=170.9] | Loss=0.00002 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=12.274 | 5363.8 samples/s | 83.8 steps/s
[Step=44450 Epoch=171.1] | Loss=0.00002 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=12.277 | 5370.4 samples/s | 83.9 steps/s
[Step=44500 Epoch=171.3] | Loss=0.00002 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=12.280 | 6296.8 samples/s | 98.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=171.3] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=12.310 | 3658.2 samples/s | 57.2 steps/s
[Step=44550 Epoch=171.5] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.574 | L2-Norm(final)=12.312 | 4770.9 samples/s | 74.5 steps/s
[Step=44600 Epoch=171.7] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.565 | L2-Norm(final)=12.313 | 4676.1 samples/s | 73.1 steps/s
[Step=44650 Epoch=171.9] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.555 | L2-Norm(final)=12.314 | 4733.9 samples/s | 74.0 steps/s
[Step=44700 Epoch=172.1] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.545 | L2-Norm(final)=12.315 | 4686.0 samples/s | 73.2 steps/s
[Step=44750 Epoch=172.3] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.534 | L2-Norm(final)=12.316 | 5960.0 samples/s | 93.1 steps/s
[Step=44800 Epoch=172.5] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.523 | L2-Norm(final)=12.317 | 1860.9 samples/s | 29.1 steps/s
[Step=44850 Epoch=172.6] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.513 | L2-Norm(final)=12.317 | 4652.2 samples/s | 72.7 steps/s
[Step=44900 Epoch=172.8] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.502 | L2-Norm(final)=12.318 | 4694.6 samples/s | 73.4 steps/s
[Step=44950 Epoch=173.0] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=12.319 | 4819.0 samples/s | 75.3 steps/s
[Step=45000 Epoch=173.2] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.480 | L2-Norm(final)=12.319 | 5243.7 samples/s | 81.9 steps/s
[Step=45050 Epoch=173.4] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.468 | L2-Norm(final)=12.320 | 1926.8 samples/s | 30.1 steps/s
[Step=45100 Epoch=173.6] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.457 | L2-Norm(final)=12.320 | 4830.9 samples/s | 75.5 steps/s
[Step=45150 Epoch=173.8] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.445 | L2-Norm(final)=12.321 | 4596.6 samples/s | 71.8 steps/s
[Step=45200 Epoch=174.0] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.434 | L2-Norm(final)=12.322 | 4697.3 samples/s | 73.4 steps/s
[Step=45250 Epoch=174.2] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.422 | L2-Norm(final)=12.322 | 4849.0 samples/s | 75.8 steps/s
[Step=45300 Epoch=174.4] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.410 | L2-Norm(final)=12.323 | 2007.6 samples/s | 31.4 steps/s
[Step=45350 Epoch=174.6] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.398 | L2-Norm(final)=12.323 | 4767.9 samples/s | 74.5 steps/s
[Step=45400 Epoch=174.8] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.386 | L2-Norm(final)=12.324 | 4810.0 samples/s | 75.2 steps/s
[Step=45450 Epoch=175.0] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=12.324 | 4620.7 samples/s | 72.2 steps/s
[Step=45500 Epoch=175.1] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.362 | L2-Norm(final)=12.325 | 4804.4 samples/s | 75.1 steps/s
[Step=45550 Epoch=175.3] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.350 | L2-Norm(final)=12.326 | 1997.2 samples/s | 31.2 steps/s
[Step=45600 Epoch=175.5] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.337 | L2-Norm(final)=12.326 | 4771.2 samples/s | 74.5 steps/s
[Step=45650 Epoch=175.7] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.325 | L2-Norm(final)=12.327 | 4722.7 samples/s | 73.8 steps/s
[Step=45700 Epoch=175.9] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.312 | L2-Norm(final)=12.327 | 4719.3 samples/s | 73.7 steps/s
[Step=45750 Epoch=176.1] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.299 | L2-Norm(final)=12.328 | 4736.3 samples/s | 74.0 steps/s
[Step=45800 Epoch=176.3] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=12.329 | 6915.3 samples/s | 108.1 steps/s
[Step=45850 Epoch=176.5] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.274 | L2-Norm(final)=12.329 | 1784.0 samples/s | 27.9 steps/s
[Step=45900 Epoch=176.7] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=12.330 | 4730.3 samples/s | 73.9 steps/s
[Step=45950 Epoch=176.9] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.247 | L2-Norm(final)=12.331 | 4693.4 samples/s | 73.3 steps/s
[Step=46000 Epoch=177.1] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.234 | L2-Norm(final)=12.331 | 4763.5 samples/s | 74.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step46000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07651 | acc=0.9711 | tpr=0.9785 | fpr=0.0451 | 4417.4 samples/s | 17.3 steps/s
Avg test loss: 0.07873, Avg test acc: 0.96911, Avg tpr: 0.97692, Avg fpr: 0.04807, total FA: 375

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07560 | acc=0.9706 | tpr=0.9768 | fpr=0.0429 | 4321.2 samples/s | 16.9 steps/s
Avg test loss: 0.07885, Avg test acc: 0.96859, Avg tpr: 0.97570, Avg fpr: 0.04705, total FA: 367

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.25805 | acc=0.2877 | tpr=0.0143 | fpr=0.1184 | 4388.0 samples/s | 17.1 steps/s
Avg test loss: 6.25862, Avg test acc: 0.28568, Avg tpr: 0.01545, Avg fpr: 0.11998, total FA: 936

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.38017 | acc=0.2982 | tpr=0.0130 | fpr=0.0825 | 4364.8 samples/s | 17.0 steps/s
Avg test loss: 6.38805, Avg test acc: 0.29562, Avg tpr: 0.01440, Avg fpr: 0.08589, total FA: 670

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.65375 | acc=0.1311 | tpr=0.6195 | fpr=0.8777 | 4331.9 samples/s | 16.9 steps/s
[Step= 100] | Loss=5.63285 | acc=0.1341 | tpr=0.6503 | fpr=0.8756 | 9048.3 samples/s | 35.3 steps/s
[Step= 150] | Loss=5.63580 | acc=0.1335 | tpr=0.6412 | fpr=0.8758 | 8213.5 samples/s | 32.1 steps/s
[Step= 200] | Loss=5.62460 | acc=0.1344 | tpr=0.6350 | fpr=0.8747 | 8630.0 samples/s | 33.7 steps/s
[Step= 250] | Loss=5.62242 | acc=0.1344 | tpr=0.6183 | fpr=0.8744 | 9152.8 samples/s | 35.8 steps/s
[Step= 300] | Loss=5.61732 | acc=0.1348 | tpr=0.6240 | fpr=0.8741 | 8729.8 samples/s | 34.1 steps/s
[Step= 350] | Loss=5.61350 | acc=0.1341 | tpr=0.6268 | fpr=0.8748 | 8545.4 samples/s | 33.4 steps/s
[Step= 400] | Loss=5.60749 | acc=0.1336 | tpr=0.6302 | fpr=0.8754 | 7199.2 samples/s | 28.1 steps/s
[Step= 450] | Loss=5.60401 | acc=0.1338 | tpr=0.6349 | fpr=0.8753 | 8697.2 samples/s | 34.0 steps/s
[Step= 500] | Loss=5.60655 | acc=0.1337 | tpr=0.6366 | fpr=0.8754 | 8596.5 samples/s | 33.6 steps/s
[Step= 550] | Loss=5.60732 | acc=0.1342 | tpr=0.6355 | fpr=0.8749 | 16438.8 samples/s | 64.2 steps/s
Avg test loss: 5.60845, Avg test acc: 0.13403, Avg tpr: 0.63550, Avg fpr: 0.87509, total FA: 121504

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.51382 | acc=0.1469 | tpr=0.5973 | fpr=0.8612 | 4378.1 samples/s | 17.1 steps/s
[Step= 100] | Loss=5.49209 | acc=0.1486 | tpr=0.6290 | fpr=0.8604 | 8581.2 samples/s | 33.5 steps/s
[Step= 150] | Loss=5.49418 | acc=0.1480 | tpr=0.6066 | fpr=0.8605 | 8670.0 samples/s | 33.9 steps/s
[Step= 200] | Loss=5.48277 | acc=0.1487 | tpr=0.6033 | fpr=0.8596 | 8806.9 samples/s | 34.4 steps/s
[Step= 250] | Loss=5.48168 | acc=0.1486 | tpr=0.5904 | fpr=0.8595 | 8324.5 samples/s | 32.5 steps/s
[Step= 300] | Loss=5.47724 | acc=0.1489 | tpr=0.5920 | fpr=0.8592 | 8835.8 samples/s | 34.5 steps/s
[Step= 350] | Loss=5.47304 | acc=0.1482 | tpr=0.5992 | fpr=0.8600 | 8614.8 samples/s | 33.7 steps/s
[Step= 400] | Loss=5.46587 | acc=0.1481 | tpr=0.5996 | fpr=0.8601 | 7463.4 samples/s | 29.2 steps/s
[Step= 450] | Loss=5.46182 | acc=0.1482 | tpr=0.6032 | fpr=0.8600 | 8908.2 samples/s | 34.8 steps/s
[Step= 500] | Loss=5.46418 | acc=0.1481 | tpr=0.6048 | fpr=0.8601 | 8677.4 samples/s | 33.9 steps/s
[Step= 550] | Loss=5.46496 | acc=0.1482 | tpr=0.6017 | fpr=0.8600 | 14328.1 samples/s | 56.0 steps/s
Avg test loss: 5.46589, Avg test acc: 0.14813, Avg tpr: 0.60182, Avg fpr: 0.86011, total FA: 119425

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12763 | acc=0.9804 | tpr=0.9602 | fpr=0.0192 | 4343.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.13630 | acc=0.9791 | tpr=0.9701 | fpr=0.0208 | 8547.9 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.14170 | acc=0.9782 | tpr=0.9654 | fpr=0.0215 | 8800.5 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.14185 | acc=0.9788 | tpr=0.9661 | fpr=0.0210 | 8776.7 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.13982 | acc=0.9791 | tpr=0.9659 | fpr=0.0207 | 8722.7 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.14128 | acc=0.9790 | tpr=0.9665 | fpr=0.0208 | 8518.9 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.14203 | acc=0.9788 | tpr=0.9674 | fpr=0.0210 | 8207.4 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.14368 | acc=0.9784 | tpr=0.9639 | fpr=0.0213 | 8511.4 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.14712 | acc=0.9783 | tpr=0.9615 | fpr=0.0214 | 8656.7 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.14640 | acc=0.9782 | tpr=0.9626 | fpr=0.0215 | 8547.2 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.14513 | acc=0.9784 | tpr=0.9622 | fpr=0.0213 | 9458.5 samples/s | 36.9 steps/s
Avg test loss: 0.14480, Avg test acc: 0.97841, Avg tpr: 0.96236, Avg fpr: 0.02130, total FA: 2957

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13250 | acc=0.9810 | tpr=0.9558 | fpr=0.0185 | 4281.3 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.14185 | acc=0.9799 | tpr=0.9701 | fpr=0.0199 | 8910.3 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.14781 | acc=0.9790 | tpr=0.9654 | fpr=0.0208 | 9023.0 samples/s | 35.2 steps/s
[Step= 200] | Loss=0.14806 | acc=0.9793 | tpr=0.9661 | fpr=0.0204 | 8300.7 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.14589 | acc=0.9796 | tpr=0.9642 | fpr=0.0201 | 8597.8 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.14741 | acc=0.9792 | tpr=0.9651 | fpr=0.0205 | 8620.9 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.14818 | acc=0.9791 | tpr=0.9656 | fpr=0.0207 | 8484.8 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.14981 | acc=0.9788 | tpr=0.9617 | fpr=0.0209 | 8671.2 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.15354 | acc=0.9786 | tpr=0.9596 | fpr=0.0211 | 8660.1 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.15281 | acc=0.9785 | tpr=0.9599 | fpr=0.0211 | 8535.9 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.15149 | acc=0.9787 | tpr=0.9594 | fpr=0.0210 | 7198.6 samples/s | 28.1 steps/s
Avg test loss: 0.15114, Avg test acc: 0.97868, Avg tpr: 0.95959, Avg fpr: 0.02097, total FA: 2912

server round 45/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=48001 Epoch=93.6] | Loss=0.02244 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.426 | L2-Norm(final)=10.504 | 3643.5 samples/s | 56.9 steps/s
[Step=48050 Epoch=93.7] | Loss=0.00790 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.426 | L2-Norm(final)=10.509 | 5560.7 samples/s | 86.9 steps/s
[Step=48100 Epoch=93.8] | Loss=0.00838 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.426 | L2-Norm(final)=10.513 | 5605.2 samples/s | 87.6 steps/s
[Step=48150 Epoch=93.9] | Loss=0.00862 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=10.517 | 5706.3 samples/s | 89.2 steps/s
[Step=48200 Epoch=94.0] | Loss=0.00842 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=10.521 | 5674.6 samples/s | 88.7 steps/s
[Step=48250 Epoch=94.1] | Loss=0.00835 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.427 | L2-Norm(final)=10.526 | 5697.1 samples/s | 89.0 steps/s
[Step=48300 Epoch=94.2] | Loss=0.00841 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.427 | L2-Norm(final)=10.530 | 5675.3 samples/s | 88.7 steps/s
[Step=48350 Epoch=94.3] | Loss=0.00814 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=10.534 | 5705.5 samples/s | 89.1 steps/s
[Step=48400 Epoch=94.4] | Loss=0.00827 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.427 | L2-Norm(final)=10.538 | 5759.9 samples/s | 90.0 steps/s
[Step=48450 Epoch=94.5] | Loss=0.00828 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=10.542 | 5681.6 samples/s | 88.8 steps/s
[Step=48500 Epoch=94.6] | Loss=0.00818 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=10.545 | 7181.2 samples/s | 112.2 steps/s
All layers training...
LR=0.00006, len=1
[Step=48501 Epoch=94.6] | Loss=0.00057 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=10.576 | 3678.2 samples/s | 57.5 steps/s
[Step=48550 Epoch=94.7] | Loss=0.00952 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.429 | L2-Norm(final)=10.577 | 4635.3 samples/s | 72.4 steps/s
[Step=48600 Epoch=94.8] | Loss=0.00874 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.433 | L2-Norm(final)=10.577 | 4967.8 samples/s | 77.6 steps/s
[Step=48650 Epoch=94.9] | Loss=0.00850 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.437 | L2-Norm(final)=10.578 | 4875.3 samples/s | 76.2 steps/s
[Step=48700 Epoch=95.0] | Loss=0.00851 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.440 | L2-Norm(final)=10.580 | 5007.3 samples/s | 78.2 steps/s
[Step=48750 Epoch=95.1] | Loss=0.00811 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.442 | L2-Norm(final)=10.581 | 4879.5 samples/s | 76.2 steps/s
[Step=48800 Epoch=95.2] | Loss=0.00778 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.445 | L2-Norm(final)=10.582 | 4958.4 samples/s | 77.5 steps/s
[Step=48850 Epoch=95.3] | Loss=0.00779 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.447 | L2-Norm(final)=10.584 | 4930.7 samples/s | 77.0 steps/s
[Step=48900 Epoch=95.4] | Loss=0.00761 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.450 | L2-Norm(final)=10.586 | 4971.1 samples/s | 77.7 steps/s
[Step=48950 Epoch=95.5] | Loss=0.00747 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=10.587 | 4983.8 samples/s | 77.9 steps/s
[Step=49000 Epoch=95.6] | Loss=0.00743 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.454 | L2-Norm(final)=10.589 | 6036.8 samples/s | 94.3 steps/s
[Step=49050 Epoch=95.7] | Loss=0.00720 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.456 | L2-Norm(final)=10.591 | 1887.2 samples/s | 29.5 steps/s
[Step=49100 Epoch=95.8] | Loss=0.00718 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.458 | L2-Norm(final)=10.592 | 4950.9 samples/s | 77.4 steps/s
[Step=49150 Epoch=95.9] | Loss=0.00704 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.460 | L2-Norm(final)=10.594 | 4943.1 samples/s | 77.2 steps/s
[Step=49200 Epoch=96.0] | Loss=0.00692 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.462 | L2-Norm(final)=10.596 | 4965.2 samples/s | 77.6 steps/s
[Step=49250 Epoch=96.1] | Loss=0.00680 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.463 | L2-Norm(final)=10.597 | 4926.5 samples/s | 77.0 steps/s
[Step=49300 Epoch=96.2] | Loss=0.00668 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.465 | L2-Norm(final)=10.599 | 4964.2 samples/s | 77.6 steps/s
[Step=49350 Epoch=96.3] | Loss=0.00663 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.467 | L2-Norm(final)=10.600 | 4977.2 samples/s | 77.8 steps/s
[Step=49400 Epoch=96.3] | Loss=0.00664 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.468 | L2-Norm(final)=10.602 | 4963.6 samples/s | 77.6 steps/s
[Step=49450 Epoch=96.4] | Loss=0.00652 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.470 | L2-Norm(final)=10.603 | 4954.0 samples/s | 77.4 steps/s
[Step=49500 Epoch=96.5] | Loss=0.00643 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.471 | L2-Norm(final)=10.605 | 5276.1 samples/s | 82.4 steps/s
[Step=49550 Epoch=96.6] | Loss=0.00635 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.473 | L2-Norm(final)=10.606 | 2014.6 samples/s | 31.5 steps/s
[Step=49600 Epoch=96.7] | Loss=0.00628 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.474 | L2-Norm(final)=10.608 | 4937.6 samples/s | 77.2 steps/s
[Step=49650 Epoch=96.8] | Loss=0.00626 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=10.609 | 4948.5 samples/s | 77.3 steps/s
[Step=49700 Epoch=96.9] | Loss=0.00622 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.477 | L2-Norm(final)=10.611 | 4952.6 samples/s | 77.4 steps/s
[Step=49750 Epoch=97.0] | Loss=0.00621 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.478 | L2-Norm(final)=10.612 | 4939.5 samples/s | 77.2 steps/s
[Step=49800 Epoch=97.1] | Loss=0.00619 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.480 | L2-Norm(final)=10.614 | 4962.4 samples/s | 77.5 steps/s
[Step=49850 Epoch=97.2] | Loss=0.00613 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.481 | L2-Norm(final)=10.615 | 4969.0 samples/s | 77.6 steps/s
[Step=49900 Epoch=97.3] | Loss=0.00604 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.482 | L2-Norm(final)=10.617 | 5002.5 samples/s | 78.2 steps/s
[Step=49950 Epoch=97.4] | Loss=0.00598 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.483 | L2-Norm(final)=10.618 | 4893.7 samples/s | 76.5 steps/s
[Step=50000 Epoch=97.5] | Loss=0.00590 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.485 | L2-Norm(final)=10.620 | 4940.1 samples/s | 77.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step50000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=38001 Epoch=145.6] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.426 | L2-Norm(final)=11.104 | 3845.2 samples/s | 60.1 steps/s
[Step=38050 Epoch=145.8] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=11.104 | 5035.0 samples/s | 78.7 steps/s
[Step=38100 Epoch=146.0] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=11.106 | 5381.9 samples/s | 84.1 steps/s
[Step=38150 Epoch=146.2] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=11.108 | 5353.5 samples/s | 83.6 steps/s
[Step=38200 Epoch=146.4] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=11.110 | 5404.3 samples/s | 84.4 steps/s
[Step=38250 Epoch=146.6] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=11.112 | 6908.9 samples/s | 108.0 steps/s
[Step=38300 Epoch=146.8] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=11.114 | 1937.5 samples/s | 30.3 steps/s
[Step=38350 Epoch=146.9] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=11.116 | 5331.8 samples/s | 83.3 steps/s
[Step=38400 Epoch=147.1] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=11.118 | 5284.4 samples/s | 82.6 steps/s
[Step=38450 Epoch=147.3] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=11.120 | 5503.4 samples/s | 86.0 steps/s
[Step=38500 Epoch=147.5] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=11.122 | 5878.6 samples/s | 91.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=38501 Epoch=147.5] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=11.141 | 3881.7 samples/s | 60.7 steps/s
[Step=38550 Epoch=147.7] | Loss=0.00002 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.423 | L2-Norm(final)=11.143 | 4440.6 samples/s | 69.4 steps/s
[Step=38600 Epoch=147.9] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.420 | L2-Norm(final)=11.144 | 4697.8 samples/s | 73.4 steps/s
[Step=38650 Epoch=148.1] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.417 | L2-Norm(final)=11.146 | 4705.2 samples/s | 73.5 steps/s
[Step=38700 Epoch=148.3] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=11.147 | 4674.3 samples/s | 73.0 steps/s
[Step=38750 Epoch=148.5] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.409 | L2-Norm(final)=11.149 | 5964.0 samples/s | 93.2 steps/s
[Step=38800 Epoch=148.7] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=11.150 | 1861.4 samples/s | 29.1 steps/s
[Step=38850 Epoch=148.9] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.401 | L2-Norm(final)=11.151 | 4635.7 samples/s | 72.4 steps/s
[Step=38900 Epoch=149.1] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.397 | L2-Norm(final)=11.153 | 4749.1 samples/s | 74.2 steps/s
[Step=38950 Epoch=149.2] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.392 | L2-Norm(final)=11.154 | 4685.7 samples/s | 73.2 steps/s
[Step=39000 Epoch=149.4] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.388 | L2-Norm(final)=11.155 | 5194.2 samples/s | 81.2 steps/s
[Step=39050 Epoch=149.6] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.383 | L2-Norm(final)=11.156 | 1945.7 samples/s | 30.4 steps/s
[Step=39100 Epoch=149.8] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.379 | L2-Norm(final)=11.157 | 4711.7 samples/s | 73.6 steps/s
[Step=39150 Epoch=150.0] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=11.158 | 4700.5 samples/s | 73.4 steps/s
[Step=39200 Epoch=150.2] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=11.159 | 4722.3 samples/s | 73.8 steps/s
[Step=39250 Epoch=150.4] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.365 | L2-Norm(final)=11.160 | 4724.3 samples/s | 73.8 steps/s
[Step=39300 Epoch=150.6] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.360 | L2-Norm(final)=11.161 | 2015.6 samples/s | 31.5 steps/s
[Step=39350 Epoch=150.8] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=11.161 | 4801.2 samples/s | 75.0 steps/s
[Step=39400 Epoch=151.0] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.350 | L2-Norm(final)=11.162 | 4723.5 samples/s | 73.8 steps/s
[Step=39450 Epoch=151.2] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.345 | L2-Norm(final)=11.163 | 4657.6 samples/s | 72.8 steps/s
[Step=39500 Epoch=151.4] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.339 | L2-Norm(final)=11.164 | 4729.0 samples/s | 73.9 steps/s
[Step=39550 Epoch=151.5] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.334 | L2-Norm(final)=11.165 | 2023.2 samples/s | 31.6 steps/s
[Step=39600 Epoch=151.7] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.329 | L2-Norm(final)=11.166 | 4761.3 samples/s | 74.4 steps/s
[Step=39650 Epoch=151.9] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.323 | L2-Norm(final)=11.166 | 4726.6 samples/s | 73.9 steps/s
[Step=39700 Epoch=152.1] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.318 | L2-Norm(final)=11.167 | 4651.1 samples/s | 72.7 steps/s
[Step=39750 Epoch=152.3] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.312 | L2-Norm(final)=11.168 | 4765.1 samples/s | 74.5 steps/s
[Step=39800 Epoch=152.5] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.307 | L2-Norm(final)=11.169 | 6388.8 samples/s | 99.8 steps/s
[Step=39850 Epoch=152.7] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.301 | L2-Norm(final)=11.170 | 1817.3 samples/s | 28.4 steps/s
[Step=39900 Epoch=152.9] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.295 | L2-Norm(final)=11.170 | 4684.6 samples/s | 73.2 steps/s
[Step=39950 Epoch=153.1] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.289 | L2-Norm(final)=11.171 | 4715.9 samples/s | 73.7 steps/s
[Step=40000 Epoch=153.3] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.284 | L2-Norm(final)=11.172 | 4739.0 samples/s | 74.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07583 | acc=0.9702 | tpr=0.9767 | fpr=0.0439 | 4330.5 samples/s | 16.9 steps/s
Avg test loss: 0.07813, Avg test acc: 0.96831, Avg tpr: 0.97505, Avg fpr: 0.04653, total FA: 363

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07560 | acc=0.9706 | tpr=0.9768 | fpr=0.0429 | 4408.4 samples/s | 17.2 steps/s
Avg test loss: 0.07885, Avg test acc: 0.96859, Avg tpr: 0.97570, Avg fpr: 0.04705, total FA: 367

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.23295 | acc=0.2898 | tpr=0.0131 | fpr=0.1093 | 4433.0 samples/s | 17.3 steps/s
Avg test loss: 6.23601, Avg test acc: 0.28784, Avg tpr: 0.01480, Avg fpr: 0.11165, total FA: 871

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.38017 | acc=0.2982 | tpr=0.0130 | fpr=0.0825 | 4331.0 samples/s | 16.9 steps/s
Avg test loss: 6.38805, Avg test acc: 0.29562, Avg tpr: 0.01440, Avg fpr: 0.08589, total FA: 670

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.42269 | acc=0.1375 | tpr=0.5885 | fpr=0.8706 | 4047.4 samples/s | 15.8 steps/s
[Step= 100] | Loss=5.39935 | acc=0.1407 | tpr=0.6119 | fpr=0.8681 | 6536.6 samples/s | 25.5 steps/s
[Step= 150] | Loss=5.40318 | acc=0.1399 | tpr=0.5951 | fpr=0.8685 | 8725.8 samples/s | 34.1 steps/s
[Step= 200] | Loss=5.39289 | acc=0.1406 | tpr=0.5880 | fpr=0.8676 | 8719.9 samples/s | 34.1 steps/s
[Step= 250] | Loss=5.39085 | acc=0.1407 | tpr=0.5747 | fpr=0.8672 | 6999.4 samples/s | 27.3 steps/s
[Step= 300] | Loss=5.38571 | acc=0.1413 | tpr=0.5767 | fpr=0.8666 | 8665.4 samples/s | 33.8 steps/s
[Step= 350] | Loss=5.38194 | acc=0.1408 | tpr=0.5792 | fpr=0.8672 | 8942.0 samples/s | 34.9 steps/s
[Step= 400] | Loss=5.37575 | acc=0.1404 | tpr=0.5837 | fpr=0.8676 | 8676.3 samples/s | 33.9 steps/s
[Step= 450] | Loss=5.37224 | acc=0.1405 | tpr=0.5891 | fpr=0.8676 | 8554.5 samples/s | 33.4 steps/s
[Step= 500] | Loss=5.37476 | acc=0.1405 | tpr=0.5907 | fpr=0.8677 | 8450.4 samples/s | 33.0 steps/s
[Step= 550] | Loss=5.37577 | acc=0.1408 | tpr=0.5893 | fpr=0.8674 | 16195.2 samples/s | 63.3 steps/s
Avg test loss: 5.37668, Avg test acc: 0.14067, Avg tpr: 0.58954, Avg fpr: 0.86749, total FA: 120449

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.51382 | acc=0.1469 | tpr=0.5973 | fpr=0.8612 | 3340.9 samples/s | 13.1 steps/s
[Step= 100] | Loss=5.49209 | acc=0.1486 | tpr=0.6290 | fpr=0.8604 | 8683.8 samples/s | 33.9 steps/s
[Step= 150] | Loss=5.49418 | acc=0.1480 | tpr=0.6066 | fpr=0.8605 | 8783.3 samples/s | 34.3 steps/s
[Step= 200] | Loss=5.48277 | acc=0.1487 | tpr=0.6033 | fpr=0.8596 | 8436.2 samples/s | 33.0 steps/s
[Step= 250] | Loss=5.48168 | acc=0.1486 | tpr=0.5904 | fpr=0.8595 | 8086.7 samples/s | 31.6 steps/s
[Step= 300] | Loss=5.47724 | acc=0.1489 | tpr=0.5920 | fpr=0.8592 | 8841.6 samples/s | 34.5 steps/s
[Step= 350] | Loss=5.47304 | acc=0.1482 | tpr=0.5992 | fpr=0.8600 | 8382.9 samples/s | 32.7 steps/s
[Step= 400] | Loss=5.46587 | acc=0.1481 | tpr=0.5996 | fpr=0.8601 | 8652.8 samples/s | 33.8 steps/s
[Step= 450] | Loss=5.46182 | acc=0.1482 | tpr=0.6032 | fpr=0.8600 | 8754.0 samples/s | 34.2 steps/s
[Step= 500] | Loss=5.46418 | acc=0.1481 | tpr=0.6048 | fpr=0.8601 | 8610.8 samples/s | 33.6 steps/s
[Step= 550] | Loss=5.46496 | acc=0.1482 | tpr=0.6017 | fpr=0.8600 | 15300.5 samples/s | 59.8 steps/s
Avg test loss: 5.46589, Avg test acc: 0.14813, Avg tpr: 0.60182, Avg fpr: 0.86011, total FA: 119425

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12472 | acc=0.9809 | tpr=0.9558 | fpr=0.0187 | 3836.0 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.13356 | acc=0.9794 | tpr=0.9638 | fpr=0.0203 | 9013.2 samples/s | 35.2 steps/s
[Step= 150] | Loss=0.13876 | acc=0.9785 | tpr=0.9611 | fpr=0.0212 | 8592.7 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.13882 | acc=0.9790 | tpr=0.9628 | fpr=0.0207 | 7785.9 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.13696 | acc=0.9793 | tpr=0.9624 | fpr=0.0204 | 6445.5 samples/s | 25.2 steps/s
[Step= 300] | Loss=0.13829 | acc=0.9791 | tpr=0.9644 | fpr=0.0206 | 8754.8 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.13896 | acc=0.9790 | tpr=0.9656 | fpr=0.0208 | 8718.0 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.14056 | acc=0.9786 | tpr=0.9617 | fpr=0.0211 | 8762.9 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.14398 | acc=0.9784 | tpr=0.9596 | fpr=0.0213 | 8689.1 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.14318 | acc=0.9784 | tpr=0.9604 | fpr=0.0213 | 8559.1 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.14192 | acc=0.9785 | tpr=0.9602 | fpr=0.0211 | 15684.1 samples/s | 61.3 steps/s
Avg test loss: 0.14163, Avg test acc: 0.97855, Avg tpr: 0.96038, Avg fpr: 0.02112, total FA: 2932

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13250 | acc=0.9810 | tpr=0.9558 | fpr=0.0185 | 4300.9 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.14185 | acc=0.9799 | tpr=0.9701 | fpr=0.0199 | 8639.2 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.14781 | acc=0.9790 | tpr=0.9654 | fpr=0.0208 | 8823.5 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.14806 | acc=0.9793 | tpr=0.9661 | fpr=0.0204 | 5253.7 samples/s | 20.5 steps/s
[Step= 250] | Loss=0.14589 | acc=0.9796 | tpr=0.9642 | fpr=0.0201 | 8570.6 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.14741 | acc=0.9792 | tpr=0.9651 | fpr=0.0205 | 8426.2 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.14818 | acc=0.9791 | tpr=0.9656 | fpr=0.0207 | 8745.1 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.14981 | acc=0.9788 | tpr=0.9617 | fpr=0.0209 | 8465.4 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.15354 | acc=0.9786 | tpr=0.9596 | fpr=0.0211 | 8865.0 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.15281 | acc=0.9785 | tpr=0.9599 | fpr=0.0211 | 8503.7 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.15149 | acc=0.9787 | tpr=0.9594 | fpr=0.0210 | 15864.1 samples/s | 62.0 steps/s
Avg test loss: 0.15114, Avg test acc: 0.97868, Avg tpr: 0.95959, Avg fpr: 0.02097, total FA: 2912

server round 46/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=48001 Epoch=93.8] | Loss=0.01827 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.260 | L2-Norm(final)=10.312 | 4453.7 samples/s | 69.6 steps/s
[Step=48050 Epoch=93.9] | Loss=0.00792 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=10.311 | 4623.0 samples/s | 72.2 steps/s
[Step=48100 Epoch=94.0] | Loss=0.00870 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.260 | L2-Norm(final)=10.310 | 5696.8 samples/s | 89.0 steps/s
[Step=48150 Epoch=94.1] | Loss=0.00896 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.260 | L2-Norm(final)=10.308 | 5583.7 samples/s | 87.2 steps/s
[Step=48200 Epoch=94.2] | Loss=0.00827 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=10.307 | 5701.2 samples/s | 89.1 steps/s
[Step=48250 Epoch=94.3] | Loss=0.00815 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.260 | L2-Norm(final)=10.307 | 5647.7 samples/s | 88.2 steps/s
[Step=48300 Epoch=94.4] | Loss=0.00800 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=10.306 | 5667.3 samples/s | 88.6 steps/s
[Step=48350 Epoch=94.5] | Loss=0.00797 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=10.306 | 5743.6 samples/s | 89.7 steps/s
[Step=48400 Epoch=94.6] | Loss=0.00784 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=10.307 | 5646.5 samples/s | 88.2 steps/s
[Step=48450 Epoch=94.7] | Loss=0.00758 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=10.307 | 5809.1 samples/s | 90.8 steps/s
[Step=48500 Epoch=94.8] | Loss=0.00752 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=10.308 | 7156.6 samples/s | 111.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=48501 Epoch=94.8] | Loss=0.00762 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=10.314 | 3838.7 samples/s | 60.0 steps/s
[Step=48550 Epoch=94.9] | Loss=0.00766 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.263 | L2-Norm(final)=10.316 | 4855.5 samples/s | 75.9 steps/s
[Step=48600 Epoch=95.0] | Loss=0.00750 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.267 | L2-Norm(final)=10.318 | 4918.2 samples/s | 76.8 steps/s
[Step=48650 Epoch=95.1] | Loss=0.00689 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.270 | L2-Norm(final)=10.319 | 4983.0 samples/s | 77.9 steps/s
[Step=48700 Epoch=95.2] | Loss=0.00725 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.272 | L2-Norm(final)=10.321 | 4934.9 samples/s | 77.1 steps/s
[Step=48750 Epoch=95.3] | Loss=0.00716 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.275 | L2-Norm(final)=10.322 | 4996.5 samples/s | 78.1 steps/s
[Step=48800 Epoch=95.4] | Loss=0.00702 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.277 | L2-Norm(final)=10.323 | 4951.3 samples/s | 77.4 steps/s
[Step=48850 Epoch=95.5] | Loss=0.00708 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.279 | L2-Norm(final)=10.325 | 4974.0 samples/s | 77.7 steps/s
[Step=48900 Epoch=95.6] | Loss=0.00726 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.281 | L2-Norm(final)=10.326 | 4932.9 samples/s | 77.1 steps/s
[Step=48950 Epoch=95.7] | Loss=0.00724 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.283 | L2-Norm(final)=10.327 | 5017.5 samples/s | 78.4 steps/s
[Step=49000 Epoch=95.8] | Loss=0.00731 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=10.328 | 6102.4 samples/s | 95.3 steps/s
[Step=49050 Epoch=95.9] | Loss=0.00721 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=10.330 | 1917.6 samples/s | 30.0 steps/s
[Step=49100 Epoch=96.0] | Loss=0.00712 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=10.331 | 4920.4 samples/s | 76.9 steps/s
[Step=49150 Epoch=96.1] | Loss=0.00686 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.290 | L2-Norm(final)=10.332 | 4919.0 samples/s | 76.9 steps/s
[Step=49200 Epoch=96.2] | Loss=0.00670 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.292 | L2-Norm(final)=10.334 | 4933.7 samples/s | 77.1 steps/s
[Step=49250 Epoch=96.3] | Loss=0.00670 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=10.335 | 4914.4 samples/s | 76.8 steps/s
[Step=49300 Epoch=96.4] | Loss=0.00659 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.295 | L2-Norm(final)=10.337 | 4996.1 samples/s | 78.1 steps/s
[Step=49350 Epoch=96.5] | Loss=0.00650 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.296 | L2-Norm(final)=10.338 | 4981.0 samples/s | 77.8 steps/s
[Step=49400 Epoch=96.6] | Loss=0.00647 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.298 | L2-Norm(final)=10.339 | 4920.8 samples/s | 76.9 steps/s
[Step=49450 Epoch=96.7] | Loss=0.00647 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.299 | L2-Norm(final)=10.341 | 5023.0 samples/s | 78.5 steps/s
[Step=49500 Epoch=96.8] | Loss=0.00637 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.300 | L2-Norm(final)=10.342 | 5311.1 samples/s | 83.0 steps/s
[Step=49550 Epoch=96.9] | Loss=0.00627 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.301 | L2-Norm(final)=10.343 | 1989.5 samples/s | 31.1 steps/s
[Step=49600 Epoch=97.0] | Loss=0.00626 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=10.345 | 5011.1 samples/s | 78.3 steps/s
[Step=49650 Epoch=97.1] | Loss=0.00618 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.304 | L2-Norm(final)=10.346 | 4943.6 samples/s | 77.2 steps/s
[Step=49700 Epoch=97.2] | Loss=0.00612 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.305 | L2-Norm(final)=10.347 | 4962.3 samples/s | 77.5 steps/s
[Step=49750 Epoch=97.3] | Loss=0.00604 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.306 | L2-Norm(final)=10.349 | 4884.6 samples/s | 76.3 steps/s
[Step=49800 Epoch=97.4] | Loss=0.00603 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.307 | L2-Norm(final)=10.350 | 4954.4 samples/s | 77.4 steps/s
[Step=49850 Epoch=97.5] | Loss=0.00597 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.309 | L2-Norm(final)=10.351 | 4983.7 samples/s | 77.9 steps/s
[Step=49900 Epoch=97.6] | Loss=0.00588 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.310 | L2-Norm(final)=10.352 | 4938.0 samples/s | 77.2 steps/s
[Step=49950 Epoch=97.7] | Loss=0.00583 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.311 | L2-Norm(final)=10.354 | 4964.3 samples/s | 77.6 steps/s
[Step=50000 Epoch=97.7] | Loss=0.00577 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.312 | L2-Norm(final)=10.355 | 4975.5 samples/s | 77.7 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step50000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=46001 Epoch=177.1] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=12.352 | 3808.1 samples/s | 59.5 steps/s
[Step=46050 Epoch=177.3] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.255 | L2-Norm(final)=12.354 | 5470.0 samples/s | 85.5 steps/s
[Step=46100 Epoch=177.5] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.255 | L2-Norm(final)=12.357 | 5257.3 samples/s | 82.1 steps/s
[Step=46150 Epoch=177.6] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.255 | L2-Norm(final)=12.362 | 5285.7 samples/s | 82.6 steps/s
[Step=46200 Epoch=177.8] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.255 | L2-Norm(final)=12.367 | 5388.4 samples/s | 84.2 steps/s
[Step=46250 Epoch=178.0] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.254 | L2-Norm(final)=12.372 | 7141.5 samples/s | 111.6 steps/s
[Step=46300 Epoch=178.2] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.254 | L2-Norm(final)=12.377 | 1955.0 samples/s | 30.5 steps/s
[Step=46350 Epoch=178.4] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.254 | L2-Norm(final)=12.381 | 5357.6 samples/s | 83.7 steps/s
[Step=46400 Epoch=178.6] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.254 | L2-Norm(final)=12.385 | 5450.6 samples/s | 85.2 steps/s
[Step=46450 Epoch=178.8] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.254 | L2-Norm(final)=12.390 | 5470.4 samples/s | 85.5 steps/s
[Step=46500 Epoch=179.0] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.254 | L2-Norm(final)=12.394 | 6063.3 samples/s | 94.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=179.0] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.254 | L2-Norm(final)=12.438 | 3739.6 samples/s | 58.4 steps/s
[Step=46550 Epoch=179.2] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.239 | L2-Norm(final)=12.441 | 4620.8 samples/s | 72.2 steps/s
[Step=46600 Epoch=179.4] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=12.443 | 4759.7 samples/s | 74.4 steps/s
[Step=46650 Epoch=179.6] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.195 | L2-Norm(final)=12.444 | 4667.8 samples/s | 72.9 steps/s
[Step=46700 Epoch=179.8] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.172 | L2-Norm(final)=12.445 | 4794.9 samples/s | 74.9 steps/s
[Step=46750 Epoch=180.0] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.150 | L2-Norm(final)=12.447 | 5893.1 samples/s | 92.1 steps/s
[Step=46800 Epoch=180.2] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.129 | L2-Norm(final)=12.448 | 1851.8 samples/s | 28.9 steps/s
[Step=46850 Epoch=180.3] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.107 | L2-Norm(final)=12.449 | 4746.0 samples/s | 74.2 steps/s
[Step=46900 Epoch=180.5] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.085 | L2-Norm(final)=12.450 | 4654.7 samples/s | 72.7 steps/s
[Step=46950 Epoch=180.7] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.063 | L2-Norm(final)=12.451 | 4707.3 samples/s | 73.6 steps/s
[Step=47000 Epoch=180.9] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.041 | L2-Norm(final)=12.452 | 5357.0 samples/s | 83.7 steps/s
[Step=47050 Epoch=181.1] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=12.453 | 1923.2 samples/s | 30.0 steps/s
[Step=47100 Epoch=181.3] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.997 | L2-Norm(final)=12.454 | 4767.7 samples/s | 74.5 steps/s
[Step=47150 Epoch=181.5] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.975 | L2-Norm(final)=12.455 | 4672.9 samples/s | 73.0 steps/s
[Step=47200 Epoch=181.7] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.953 | L2-Norm(final)=12.456 | 4701.0 samples/s | 73.5 steps/s
[Step=47250 Epoch=181.9] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.930 | L2-Norm(final)=12.457 | 4775.5 samples/s | 74.6 steps/s
[Step=47300 Epoch=182.1] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.908 | L2-Norm(final)=12.458 | 1971.3 samples/s | 30.8 steps/s
[Step=47350 Epoch=182.3] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.885 | L2-Norm(final)=12.459 | 4702.9 samples/s | 73.5 steps/s
[Step=47400 Epoch=182.5] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.862 | L2-Norm(final)=12.460 | 4523.2 samples/s | 70.7 steps/s
[Step=47450 Epoch=182.7] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.840 | L2-Norm(final)=12.461 | 4718.0 samples/s | 73.7 steps/s
[Step=47500 Epoch=182.8] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.817 | L2-Norm(final)=12.462 | 4591.8 samples/s | 71.7 steps/s
[Step=47550 Epoch=183.0] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.794 | L2-Norm(final)=12.463 | 2007.5 samples/s | 31.4 steps/s
[Step=47600 Epoch=183.2] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=12.464 | 4542.9 samples/s | 71.0 steps/s
[Step=47650 Epoch=183.4] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.747 | L2-Norm(final)=12.465 | 4595.8 samples/s | 71.8 steps/s
[Step=47700 Epoch=183.6] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.724 | L2-Norm(final)=12.466 | 4669.6 samples/s | 73.0 steps/s
[Step=47750 Epoch=183.8] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.700 | L2-Norm(final)=12.467 | 4719.1 samples/s | 73.7 steps/s
[Step=47800 Epoch=184.0] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.676 | L2-Norm(final)=12.469 | 6951.5 samples/s | 108.6 steps/s
[Step=47850 Epoch=184.2] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.653 | L2-Norm(final)=12.470 | 1785.2 samples/s | 27.9 steps/s
[Step=47900 Epoch=184.4] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=12.471 | 4664.7 samples/s | 72.9 steps/s
[Step=47950 Epoch=184.6] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.605 | L2-Norm(final)=12.473 | 4664.7 samples/s | 72.9 steps/s
[Step=48000 Epoch=184.8] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.581 | L2-Norm(final)=12.474 | 4706.1 samples/s | 73.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step48000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07583 | acc=0.9702 | tpr=0.9767 | fpr=0.0439 | 3173.0 samples/s | 12.4 steps/s
Avg test loss: 0.07813, Avg test acc: 0.96831, Avg tpr: 0.97505, Avg fpr: 0.04653, total FA: 363

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07263 | acc=0.9705 | tpr=0.9787 | fpr=0.0473 | 4331.7 samples/s | 16.9 steps/s
Avg test loss: 0.07632, Avg test acc: 0.96919, Avg tpr: 0.97849, Avg fpr: 0.05128, total FA: 400

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.23295 | acc=0.2898 | tpr=0.0131 | fpr=0.1093 | 4356.5 samples/s | 17.0 steps/s
Avg test loss: 6.23601, Avg test acc: 0.28784, Avg tpr: 0.01480, Avg fpr: 0.11165, total FA: 871

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.88313 | acc=0.2929 | tpr=0.0131 | fpr=0.0996 | 4492.2 samples/s | 17.5 steps/s
Avg test loss: 5.89095, Avg test acc: 0.29025, Avg tpr: 0.01504, Avg fpr: 0.10447, total FA: 815

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.42269 | acc=0.1375 | tpr=0.5885 | fpr=0.8706 | 4341.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.39935 | acc=0.1407 | tpr=0.6119 | fpr=0.8681 | 8540.9 samples/s | 33.4 steps/s
[Step= 150] | Loss=5.40318 | acc=0.1399 | tpr=0.5951 | fpr=0.8685 | 8795.9 samples/s | 34.4 steps/s
[Step= 200] | Loss=5.39289 | acc=0.1406 | tpr=0.5880 | fpr=0.8676 | 8786.9 samples/s | 34.3 steps/s
[Step= 250] | Loss=5.39085 | acc=0.1407 | tpr=0.5747 | fpr=0.8672 | 8626.0 samples/s | 33.7 steps/s
[Step= 300] | Loss=5.38571 | acc=0.1413 | tpr=0.5767 | fpr=0.8666 | 8711.6 samples/s | 34.0 steps/s
[Step= 350] | Loss=5.38194 | acc=0.1408 | tpr=0.5792 | fpr=0.8672 | 8922.6 samples/s | 34.9 steps/s
[Step= 400] | Loss=5.37575 | acc=0.1404 | tpr=0.5837 | fpr=0.8676 | 8558.4 samples/s | 33.4 steps/s
[Step= 450] | Loss=5.37224 | acc=0.1405 | tpr=0.5891 | fpr=0.8676 | 9264.4 samples/s | 36.2 steps/s
[Step= 500] | Loss=5.37476 | acc=0.1405 | tpr=0.5907 | fpr=0.8677 | 8226.3 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.37577 | acc=0.1408 | tpr=0.5893 | fpr=0.8674 | 15517.4 samples/s | 60.6 steps/s
Avg test loss: 5.37668, Avg test acc: 0.14067, Avg tpr: 0.58954, Avg fpr: 0.86749, total FA: 120449

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.48876 | acc=0.1430 | tpr=0.6150 | fpr=0.8655 | 4347.5 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.46354 | acc=0.1454 | tpr=0.6333 | fpr=0.8637 | 8901.6 samples/s | 34.8 steps/s
[Step= 150] | Loss=5.46435 | acc=0.1450 | tpr=0.6268 | fpr=0.8639 | 8604.5 samples/s | 33.6 steps/s
[Step= 200] | Loss=5.45327 | acc=0.1455 | tpr=0.6197 | fpr=0.8631 | 8693.6 samples/s | 34.0 steps/s
[Step= 250] | Loss=5.45142 | acc=0.1457 | tpr=0.6079 | fpr=0.8627 | 8587.1 samples/s | 33.5 steps/s
[Step= 300] | Loss=5.44700 | acc=0.1461 | tpr=0.6095 | fpr=0.8623 | 8617.6 samples/s | 33.7 steps/s
[Step= 350] | Loss=5.44335 | acc=0.1454 | tpr=0.6149 | fpr=0.8632 | 8630.0 samples/s | 33.7 steps/s
[Step= 400] | Loss=5.43663 | acc=0.1454 | tpr=0.6176 | fpr=0.8632 | 8761.3 samples/s | 34.2 steps/s
[Step= 450] | Loss=5.43316 | acc=0.1454 | tpr=0.6217 | fpr=0.8632 | 8673.5 samples/s | 33.9 steps/s
[Step= 500] | Loss=5.43546 | acc=0.1454 | tpr=0.6238 | fpr=0.8632 | 8921.5 samples/s | 34.8 steps/s
[Step= 550] | Loss=5.43623 | acc=0.1455 | tpr=0.6232 | fpr=0.8632 | 14655.6 samples/s | 57.2 steps/s
Avg test loss: 5.43718, Avg test acc: 0.14537, Avg tpr: 0.62322, Avg fpr: 0.86332, total FA: 119870

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12472 | acc=0.9809 | tpr=0.9558 | fpr=0.0187 | 4370.2 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.13356 | acc=0.9794 | tpr=0.9638 | fpr=0.0203 | 8917.6 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.13876 | acc=0.9785 | tpr=0.9611 | fpr=0.0212 | 8438.1 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.13882 | acc=0.9790 | tpr=0.9628 | fpr=0.0207 | 8780.1 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.13696 | acc=0.9793 | tpr=0.9624 | fpr=0.0204 | 8409.8 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.13829 | acc=0.9791 | tpr=0.9644 | fpr=0.0206 | 8848.4 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.13896 | acc=0.9790 | tpr=0.9656 | fpr=0.0208 | 8722.7 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.14056 | acc=0.9786 | tpr=0.9617 | fpr=0.0211 | 8355.4 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.14398 | acc=0.9784 | tpr=0.9596 | fpr=0.0213 | 9216.6 samples/s | 36.0 steps/s
[Step= 500] | Loss=0.14318 | acc=0.9784 | tpr=0.9604 | fpr=0.0213 | 8523.1 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.14192 | acc=0.9785 | tpr=0.9602 | fpr=0.0211 | 15236.1 samples/s | 59.5 steps/s
Avg test loss: 0.14163, Avg test acc: 0.97855, Avg tpr: 0.96038, Avg fpr: 0.02112, total FA: 2932

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12677 | acc=0.9800 | tpr=0.9558 | fpr=0.0196 | 4285.3 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.13589 | acc=0.9789 | tpr=0.9680 | fpr=0.0209 | 8968.2 samples/s | 35.0 steps/s
[Step= 150] | Loss=0.14163 | acc=0.9780 | tpr=0.9654 | fpr=0.0218 | 8610.6 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.14164 | acc=0.9783 | tpr=0.9661 | fpr=0.0215 | 8621.3 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.13937 | acc=0.9786 | tpr=0.9651 | fpr=0.0212 | 8635.1 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.14095 | acc=0.9782 | tpr=0.9658 | fpr=0.0215 | 8619.9 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.14188 | acc=0.9781 | tpr=0.9662 | fpr=0.0217 | 8712.7 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.14345 | acc=0.9777 | tpr=0.9623 | fpr=0.0220 | 8980.1 samples/s | 35.1 steps/s
[Step= 450] | Loss=0.14674 | acc=0.9776 | tpr=0.9601 | fpr=0.0221 | 8580.8 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.14616 | acc=0.9776 | tpr=0.9612 | fpr=0.0221 | 8531.3 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.14487 | acc=0.9777 | tpr=0.9602 | fpr=0.0220 | 16100.1 samples/s | 62.9 steps/s
Avg test loss: 0.14455, Avg test acc: 0.97767, Avg tpr: 0.96038, Avg fpr: 0.02202, total FA: 3057

server round 47/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=50001 Epoch=97.5] | Loss=0.00243 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=10.664 | 3858.8 samples/s | 60.3 steps/s
[Step=50050 Epoch=97.6] | Loss=0.00852 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=10.669 | 5478.8 samples/s | 85.6 steps/s
[Step=50100 Epoch=97.7] | Loss=0.00817 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=10.672 | 5439.7 samples/s | 85.0 steps/s
[Step=50150 Epoch=97.8] | Loss=0.00903 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.923 | L2-Norm(final)=10.674 | 5796.2 samples/s | 90.6 steps/s
[Step=50200 Epoch=97.9] | Loss=0.00970 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=10.674 | 5748.2 samples/s | 89.8 steps/s
[Step=50250 Epoch=98.0] | Loss=0.00979 | Reg=0.00119 | acc=0.9688 | L2-Norm=10.923 | L2-Norm(final)=10.676 | 5554.8 samples/s | 86.8 steps/s
[Step=50300 Epoch=98.1] | Loss=0.00967 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=10.677 | 5726.5 samples/s | 89.5 steps/s
[Step=50350 Epoch=98.2] | Loss=0.00933 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=10.679 | 5671.6 samples/s | 88.6 steps/s
[Step=50400 Epoch=98.3] | Loss=0.00924 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.923 | L2-Norm(final)=10.681 | 5715.9 samples/s | 89.3 steps/s
[Step=50450 Epoch=98.4] | Loss=0.00915 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=10.682 | 5705.5 samples/s | 89.1 steps/s
[Step=50500 Epoch=98.5] | Loss=0.00919 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=10.684 | 7302.6 samples/s | 114.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=50501 Epoch=98.5] | Loss=0.00196 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=10.701 | 3534.5 samples/s | 55.2 steps/s
[Step=50550 Epoch=98.6] | Loss=0.00844 | Reg=0.00119 | acc=0.9531 | L2-Norm=10.927 | L2-Norm(final)=10.702 | 4738.8 samples/s | 74.0 steps/s
[Step=50600 Epoch=98.7] | Loss=0.00907 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.933 | L2-Norm(final)=10.703 | 4988.2 samples/s | 77.9 steps/s
[Step=50650 Epoch=98.8] | Loss=0.00885 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.937 | L2-Norm(final)=10.705 | 4923.5 samples/s | 76.9 steps/s
[Step=50700 Epoch=98.9] | Loss=0.00880 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.941 | L2-Norm(final)=10.706 | 4959.1 samples/s | 77.5 steps/s
[Step=50750 Epoch=99.0] | Loss=0.00878 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=10.708 | 4955.1 samples/s | 77.4 steps/s
[Step=50800 Epoch=99.1] | Loss=0.00874 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=10.710 | 4988.4 samples/s | 77.9 steps/s
[Step=50850 Epoch=99.2] | Loss=0.00883 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.951 | L2-Norm(final)=10.712 | 4932.9 samples/s | 77.1 steps/s
[Step=50900 Epoch=99.3] | Loss=0.00873 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=10.714 | 4970.3 samples/s | 77.7 steps/s
[Step=50950 Epoch=99.4] | Loss=0.00864 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=10.715 | 4999.9 samples/s | 78.1 steps/s
[Step=51000 Epoch=99.5] | Loss=0.00849 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.960 | L2-Norm(final)=10.717 | 6047.1 samples/s | 94.5 steps/s
[Step=51050 Epoch=99.6] | Loss=0.00816 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=10.719 | 1833.6 samples/s | 28.7 steps/s
[Step=51100 Epoch=99.7] | Loss=0.00806 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.965 | L2-Norm(final)=10.721 | 4927.2 samples/s | 77.0 steps/s
[Step=51150 Epoch=99.8] | Loss=0.00790 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.967 | L2-Norm(final)=10.723 | 4982.6 samples/s | 77.9 steps/s
[Step=51200 Epoch=99.9] | Loss=0.00770 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.970 | L2-Norm(final)=10.725 | 4922.4 samples/s | 76.9 steps/s
[Step=51250 Epoch=100.0] | Loss=0.00763 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.972 | L2-Norm(final)=10.727 | 4957.3 samples/s | 77.5 steps/s
[Step=51300 Epoch=100.1] | Loss=0.00752 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.974 | L2-Norm(final)=10.729 | 5045.2 samples/s | 78.8 steps/s
[Step=51350 Epoch=100.2] | Loss=0.00735 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.976 | L2-Norm(final)=10.730 | 4968.8 samples/s | 77.6 steps/s
[Step=51400 Epoch=100.2] | Loss=0.00719 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.978 | L2-Norm(final)=10.732 | 4891.4 samples/s | 76.4 steps/s
[Step=51450 Epoch=100.3] | Loss=0.00716 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.980 | L2-Norm(final)=10.734 | 5018.3 samples/s | 78.4 steps/s
[Step=51500 Epoch=100.4] | Loss=0.00707 | Reg=0.00121 | acc=0.9688 | L2-Norm=10.982 | L2-Norm(final)=10.736 | 5262.6 samples/s | 82.2 steps/s
[Step=51550 Epoch=100.5] | Loss=0.00703 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.983 | L2-Norm(final)=10.738 | 1942.2 samples/s | 30.3 steps/s
[Step=51600 Epoch=100.6] | Loss=0.00695 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.985 | L2-Norm(final)=10.740 | 4958.1 samples/s | 77.5 steps/s
[Step=51650 Epoch=100.7] | Loss=0.00683 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.987 | L2-Norm(final)=10.742 | 4963.1 samples/s | 77.5 steps/s
[Step=51700 Epoch=100.8] | Loss=0.00671 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.989 | L2-Norm(final)=10.743 | 4967.8 samples/s | 77.6 steps/s
[Step=51750 Epoch=100.9] | Loss=0.00662 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.990 | L2-Norm(final)=10.745 | 5024.6 samples/s | 78.5 steps/s
[Step=51800 Epoch=101.0] | Loss=0.00660 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.992 | L2-Norm(final)=10.747 | 4939.8 samples/s | 77.2 steps/s
[Step=51850 Epoch=101.1] | Loss=0.00660 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.994 | L2-Norm(final)=10.749 | 4973.2 samples/s | 77.7 steps/s
[Step=51900 Epoch=101.2] | Loss=0.00660 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.995 | L2-Norm(final)=10.751 | 5006.8 samples/s | 78.2 steps/s
[Step=51950 Epoch=101.3] | Loss=0.00656 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.997 | L2-Norm(final)=10.752 | 4934.4 samples/s | 77.1 steps/s
[Step=52000 Epoch=101.4] | Loss=0.00653 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.998 | L2-Norm(final)=10.754 | 4962.6 samples/s | 77.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step52000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=50001 Epoch=97.8] | Loss=0.00528 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=10.396 | 3964.2 samples/s | 61.9 steps/s
[Step=50050 Epoch=97.8] | Loss=0.00869 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.923 | L2-Norm(final)=10.399 | 5208.0 samples/s | 81.4 steps/s
[Step=50100 Epoch=97.9] | Loss=0.00885 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=10.403 | 5710.1 samples/s | 89.2 steps/s
[Step=50150 Epoch=98.0] | Loss=0.00931 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=10.406 | 5736.4 samples/s | 89.6 steps/s
[Step=50200 Epoch=98.1] | Loss=0.00903 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.923 | L2-Norm(final)=10.409 | 5600.0 samples/s | 87.5 steps/s
[Step=50250 Epoch=98.2] | Loss=0.00850 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=10.412 | 5673.1 samples/s | 88.6 steps/s
[Step=50300 Epoch=98.3] | Loss=0.00856 | Reg=0.00119 | acc=0.9688 | L2-Norm=10.923 | L2-Norm(final)=10.415 | 5744.5 samples/s | 89.8 steps/s
[Step=50350 Epoch=98.4] | Loss=0.00868 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=10.418 | 5677.6 samples/s | 88.7 steps/s
[Step=50400 Epoch=98.5] | Loss=0.00891 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.923 | L2-Norm(final)=10.421 | 5606.2 samples/s | 87.6 steps/s
[Step=50450 Epoch=98.6] | Loss=0.00878 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=10.423 | 5675.8 samples/s | 88.7 steps/s
[Step=50500 Epoch=98.7] | Loss=0.00858 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=10.426 | 7377.1 samples/s | 115.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=50501 Epoch=98.7] | Loss=0.02933 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.923 | L2-Norm(final)=10.454 | 3947.7 samples/s | 61.7 steps/s
[Step=50550 Epoch=98.8] | Loss=0.00893 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.926 | L2-Norm(final)=10.455 | 4768.8 samples/s | 74.5 steps/s
[Step=50600 Epoch=98.9] | Loss=0.00887 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.931 | L2-Norm(final)=10.456 | 4802.5 samples/s | 75.0 steps/s
[Step=50650 Epoch=99.0] | Loss=0.00873 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.935 | L2-Norm(final)=10.458 | 4939.7 samples/s | 77.2 steps/s
[Step=50700 Epoch=99.1] | Loss=0.00935 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.938 | L2-Norm(final)=10.460 | 4986.2 samples/s | 77.9 steps/s
[Step=50750 Epoch=99.2] | Loss=0.00915 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.941 | L2-Norm(final)=10.462 | 4994.0 samples/s | 78.0 steps/s
[Step=50800 Epoch=99.3] | Loss=0.00879 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.944 | L2-Norm(final)=10.463 | 5073.8 samples/s | 79.3 steps/s
[Step=50850 Epoch=99.4] | Loss=0.00855 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.947 | L2-Norm(final)=10.465 | 4940.0 samples/s | 77.2 steps/s
[Step=50900 Epoch=99.5] | Loss=0.00838 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.950 | L2-Norm(final)=10.467 | 4899.2 samples/s | 76.5 steps/s
[Step=50950 Epoch=99.6] | Loss=0.00816 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=10.469 | 5018.0 samples/s | 78.4 steps/s
[Step=51000 Epoch=99.7] | Loss=0.00806 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=10.471 | 6113.5 samples/s | 95.5 steps/s
[Step=51050 Epoch=99.8] | Loss=0.00786 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.957 | L2-Norm(final)=10.473 | 1924.7 samples/s | 30.1 steps/s
[Step=51100 Epoch=99.9] | Loss=0.00766 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.959 | L2-Norm(final)=10.475 | 4930.4 samples/s | 77.0 steps/s
[Step=51150 Epoch=100.0] | Loss=0.00750 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.961 | L2-Norm(final)=10.477 | 5030.3 samples/s | 78.6 steps/s
[Step=51200 Epoch=100.1] | Loss=0.00729 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.963 | L2-Norm(final)=10.479 | 4905.5 samples/s | 76.6 steps/s
[Step=51250 Epoch=100.2] | Loss=0.00722 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.965 | L2-Norm(final)=10.481 | 4959.7 samples/s | 77.5 steps/s
[Step=51300 Epoch=100.3] | Loss=0.00708 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.967 | L2-Norm(final)=10.482 | 4994.8 samples/s | 78.0 steps/s
[Step=51350 Epoch=100.4] | Loss=0.00702 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.969 | L2-Norm(final)=10.484 | 4935.5 samples/s | 77.1 steps/s
[Step=51400 Epoch=100.5] | Loss=0.00692 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.970 | L2-Norm(final)=10.486 | 4983.8 samples/s | 77.9 steps/s
[Step=51450 Epoch=100.6] | Loss=0.00684 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.972 | L2-Norm(final)=10.488 | 4948.7 samples/s | 77.3 steps/s
[Step=51500 Epoch=100.7] | Loss=0.00674 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.974 | L2-Norm(final)=10.489 | 5364.2 samples/s | 83.8 steps/s
[Step=51550 Epoch=100.8] | Loss=0.00662 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.975 | L2-Norm(final)=10.491 | 2010.0 samples/s | 31.4 steps/s
[Step=51600 Epoch=100.9] | Loss=0.00655 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.977 | L2-Norm(final)=10.493 | 5016.5 samples/s | 78.4 steps/s
[Step=51650 Epoch=101.0] | Loss=0.00645 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.979 | L2-Norm(final)=10.495 | 4983.0 samples/s | 77.9 steps/s
[Step=51700 Epoch=101.1] | Loss=0.00637 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.980 | L2-Norm(final)=10.497 | 4884.5 samples/s | 76.3 steps/s
[Step=51750 Epoch=101.2] | Loss=0.00636 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.982 | L2-Norm(final)=10.498 | 4994.3 samples/s | 78.0 steps/s
[Step=51800 Epoch=101.3] | Loss=0.00627 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.983 | L2-Norm(final)=10.500 | 4939.2 samples/s | 77.2 steps/s
[Step=51850 Epoch=101.4] | Loss=0.00627 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.985 | L2-Norm(final)=10.502 | 4917.9 samples/s | 76.8 steps/s
[Step=51900 Epoch=101.5] | Loss=0.00623 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.986 | L2-Norm(final)=10.504 | 4979.8 samples/s | 77.8 steps/s
[Step=51950 Epoch=101.6] | Loss=0.00618 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.988 | L2-Norm(final)=10.505 | 4902.0 samples/s | 76.6 steps/s
[Step=52000 Epoch=101.7] | Loss=0.00611 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.989 | L2-Norm(final)=10.507 | 4976.0 samples/s | 77.7 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step52000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07150 | acc=0.9703 | tpr=0.9807 | fpr=0.0523 | 4122.7 samples/s | 16.1 steps/s
Avg test loss: 0.07379, Avg test acc: 0.96835, Avg tpr: 0.97873, Avg fpr: 0.05448, total FA: 425

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07254 | acc=0.9694 | tpr=0.9764 | fpr=0.0458 | 4128.0 samples/s | 16.1 steps/s
Avg test loss: 0.07565, Avg test acc: 0.96795, Avg tpr: 0.97622, Avg fpr: 0.05025, total FA: 392

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.23295 | acc=0.2898 | tpr=0.0131 | fpr=0.1093 | 4369.1 samples/s | 17.1 steps/s
Avg test loss: 6.23601, Avg test acc: 0.28784, Avg tpr: 0.01480, Avg fpr: 0.11165, total FA: 871

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.88313 | acc=0.2929 | tpr=0.0131 | fpr=0.0996 | 4409.0 samples/s | 17.2 steps/s
Avg test loss: 5.89095, Avg test acc: 0.29025, Avg tpr: 0.01504, Avg fpr: 0.10447, total FA: 815

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.22211 | acc=0.1310 | tpr=0.6239 | fpr=0.8778 | 4371.8 samples/s | 17.1 steps/s
[Step= 100] | Loss=5.19852 | acc=0.1326 | tpr=0.6525 | fpr=0.8771 | 8776.9 samples/s | 34.3 steps/s
[Step= 150] | Loss=5.20361 | acc=0.1320 | tpr=0.6398 | fpr=0.8774 | 8473.8 samples/s | 33.1 steps/s
[Step= 200] | Loss=5.19337 | acc=0.1323 | tpr=0.6361 | fpr=0.8769 | 9397.5 samples/s | 36.7 steps/s
[Step= 250] | Loss=5.19078 | acc=0.1321 | tpr=0.6192 | fpr=0.8767 | 7959.4 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.18611 | acc=0.1326 | tpr=0.6218 | fpr=0.8763 | 8955.2 samples/s | 35.0 steps/s
[Step= 350] | Loss=5.18285 | acc=0.1321 | tpr=0.6255 | fpr=0.8769 | 8826.5 samples/s | 34.5 steps/s
[Step= 400] | Loss=5.17757 | acc=0.1316 | tpr=0.6275 | fpr=0.8775 | 8586.3 samples/s | 33.5 steps/s
[Step= 450] | Loss=5.17464 | acc=0.1316 | tpr=0.6344 | fpr=0.8775 | 8569.7 samples/s | 33.5 steps/s
[Step= 500] | Loss=5.17727 | acc=0.1317 | tpr=0.6357 | fpr=0.8774 | 8651.5 samples/s | 33.8 steps/s
[Step= 550] | Loss=5.17795 | acc=0.1320 | tpr=0.6343 | fpr=0.8771 | 15266.2 samples/s | 59.6 steps/s
Avg test loss: 5.17877, Avg test acc: 0.13190, Avg tpr: 0.63431, Avg fpr: 0.87723, total FA: 121802

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.31480 | acc=0.1382 | tpr=0.6018 | fpr=0.8701 | 4338.2 samples/s | 16.9 steps/s
[Step= 100] | Loss=5.29074 | acc=0.1407 | tpr=0.6205 | fpr=0.8683 | 8757.4 samples/s | 34.2 steps/s
[Step= 150] | Loss=5.29139 | acc=0.1410 | tpr=0.6110 | fpr=0.8677 | 8572.9 samples/s | 33.5 steps/s
[Step= 200] | Loss=5.28112 | acc=0.1417 | tpr=0.6077 | fpr=0.8668 | 8906.6 samples/s | 34.8 steps/s
[Step= 250] | Loss=5.28021 | acc=0.1417 | tpr=0.5948 | fpr=0.8665 | 8460.3 samples/s | 33.0 steps/s
[Step= 300] | Loss=5.27669 | acc=0.1420 | tpr=0.5971 | fpr=0.8663 | 8874.8 samples/s | 34.7 steps/s
[Step= 350] | Loss=5.27263 | acc=0.1414 | tpr=0.6018 | fpr=0.8669 | 8565.5 samples/s | 33.5 steps/s
[Step= 400] | Loss=5.26581 | acc=0.1413 | tpr=0.6034 | fpr=0.8671 | 8852.6 samples/s | 34.6 steps/s
[Step= 450] | Loss=5.26234 | acc=0.1413 | tpr=0.6086 | fpr=0.8672 | 8782.1 samples/s | 34.3 steps/s
[Step= 500] | Loss=5.26500 | acc=0.1413 | tpr=0.6110 | fpr=0.8672 | 8528.8 samples/s | 33.3 steps/s
[Step= 550] | Loss=5.26556 | acc=0.1414 | tpr=0.6080 | fpr=0.8670 | 15712.6 samples/s | 61.4 steps/s
Avg test loss: 5.26644, Avg test acc: 0.14136, Avg tpr: 0.60816, Avg fpr: 0.86713, total FA: 120399

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12472 | acc=0.9809 | tpr=0.9558 | fpr=0.0187 | 4337.1 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.13356 | acc=0.9794 | tpr=0.9638 | fpr=0.0203 | 8704.6 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.13876 | acc=0.9785 | tpr=0.9611 | fpr=0.0212 | 8840.5 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.13882 | acc=0.9790 | tpr=0.9628 | fpr=0.0207 | 8667.9 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.13696 | acc=0.9793 | tpr=0.9624 | fpr=0.0204 | 8764.6 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.13829 | acc=0.9791 | tpr=0.9644 | fpr=0.0206 | 8717.2 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.13896 | acc=0.9790 | tpr=0.9656 | fpr=0.0208 | 8391.5 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.14056 | acc=0.9786 | tpr=0.9617 | fpr=0.0211 | 9049.1 samples/s | 35.3 steps/s
[Step= 450] | Loss=0.14398 | acc=0.9784 | tpr=0.9596 | fpr=0.0213 | 8436.0 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.14318 | acc=0.9784 | tpr=0.9604 | fpr=0.0213 | 8709.2 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.14192 | acc=0.9785 | tpr=0.9602 | fpr=0.0211 | 15241.2 samples/s | 59.5 steps/s
Avg test loss: 0.14163, Avg test acc: 0.97855, Avg tpr: 0.96038, Avg fpr: 0.02112, total FA: 2932

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12677 | acc=0.9800 | tpr=0.9558 | fpr=0.0196 | 4332.1 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.13589 | acc=0.9789 | tpr=0.9680 | fpr=0.0209 | 8841.3 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.14163 | acc=0.9780 | tpr=0.9654 | fpr=0.0218 | 8521.5 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.14164 | acc=0.9783 | tpr=0.9661 | fpr=0.0215 | 8690.4 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.13937 | acc=0.9786 | tpr=0.9651 | fpr=0.0212 | 8752.2 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.14095 | acc=0.9782 | tpr=0.9658 | fpr=0.0215 | 8734.1 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.14188 | acc=0.9781 | tpr=0.9662 | fpr=0.0217 | 8424.5 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.14345 | acc=0.9777 | tpr=0.9623 | fpr=0.0220 | 8892.3 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.14674 | acc=0.9776 | tpr=0.9601 | fpr=0.0221 | 8503.8 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.14616 | acc=0.9776 | tpr=0.9612 | fpr=0.0221 | 9224.7 samples/s | 36.0 steps/s
[Step= 550] | Loss=0.14487 | acc=0.9777 | tpr=0.9602 | fpr=0.0220 | 14732.2 samples/s | 57.5 steps/s
Avg test loss: 0.14455, Avg test acc: 0.97767, Avg tpr: 0.96038, Avg fpr: 0.02202, total FA: 3057

server round 48/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=52001 Epoch=101.4] | Loss=0.00293 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=10.805 | 3732.0 samples/s | 58.3 steps/s
[Step=52050 Epoch=101.5] | Loss=0.01090 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.730 | L2-Norm(final)=10.807 | 5296.0 samples/s | 82.7 steps/s
[Step=52100 Epoch=101.6] | Loss=0.00995 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=10.808 | 5636.2 samples/s | 88.1 steps/s
[Step=52150 Epoch=101.7] | Loss=0.00989 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=10.810 | 5645.7 samples/s | 88.2 steps/s
[Step=52200 Epoch=101.8] | Loss=0.01000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=10.811 | 5750.3 samples/s | 89.8 steps/s
[Step=52250 Epoch=101.9] | Loss=0.00988 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.730 | L2-Norm(final)=10.812 | 5673.0 samples/s | 88.6 steps/s
[Step=52300 Epoch=102.0] | Loss=0.01008 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=10.812 | 5730.0 samples/s | 89.5 steps/s
[Step=52350 Epoch=102.1] | Loss=0.00981 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.730 | L2-Norm(final)=10.813 | 5655.8 samples/s | 88.4 steps/s
[Step=52400 Epoch=102.2] | Loss=0.00959 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.730 | L2-Norm(final)=10.815 | 5712.1 samples/s | 89.3 steps/s
[Step=52450 Epoch=102.3] | Loss=0.00954 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=10.816 | 5721.3 samples/s | 89.4 steps/s
[Step=52500 Epoch=102.4] | Loss=0.00954 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=10.817 | 7214.0 samples/s | 112.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=52501 Epoch=102.4] | Loss=0.00806 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=10.830 | 3512.1 samples/s | 54.9 steps/s
[Step=52550 Epoch=102.5] | Loss=0.01002 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.734 | L2-Norm(final)=10.831 | 4968.7 samples/s | 77.6 steps/s
[Step=52600 Epoch=102.6] | Loss=0.00868 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.739 | L2-Norm(final)=10.833 | 5015.8 samples/s | 78.4 steps/s
[Step=52650 Epoch=102.7] | Loss=0.00894 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.743 | L2-Norm(final)=10.834 | 4949.5 samples/s | 77.3 steps/s
[Step=52700 Epoch=102.8] | Loss=0.00874 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.746 | L2-Norm(final)=10.836 | 4907.7 samples/s | 76.7 steps/s
[Step=52750 Epoch=102.9] | Loss=0.00889 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.750 | L2-Norm(final)=10.838 | 4943.8 samples/s | 77.2 steps/s
[Step=52800 Epoch=103.0] | Loss=0.00901 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.753 | L2-Norm(final)=10.839 | 5019.9 samples/s | 78.4 steps/s
[Step=52850 Epoch=103.1] | Loss=0.00887 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.757 | L2-Norm(final)=10.841 | 4966.7 samples/s | 77.6 steps/s
[Step=52900 Epoch=103.2] | Loss=0.00877 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.760 | L2-Norm(final)=10.843 | 5039.4 samples/s | 78.7 steps/s
[Step=52950 Epoch=103.3] | Loss=0.00877 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.763 | L2-Norm(final)=10.845 | 4938.0 samples/s | 77.2 steps/s
[Step=53000 Epoch=103.4] | Loss=0.00847 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.765 | L2-Norm(final)=10.847 | 6044.8 samples/s | 94.4 steps/s
[Step=53050 Epoch=103.5] | Loss=0.00827 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.768 | L2-Norm(final)=10.849 | 1845.2 samples/s | 28.8 steps/s
[Step=53100 Epoch=103.6] | Loss=0.00806 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.771 | L2-Norm(final)=10.852 | 4948.0 samples/s | 77.3 steps/s
[Step=53150 Epoch=103.7] | Loss=0.00784 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.773 | L2-Norm(final)=10.854 | 4961.4 samples/s | 77.5 steps/s
[Step=53200 Epoch=103.8] | Loss=0.00774 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.775 | L2-Norm(final)=10.856 | 4927.1 samples/s | 77.0 steps/s
[Step=53250 Epoch=103.9] | Loss=0.00765 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.777 | L2-Norm(final)=10.858 | 5049.3 samples/s | 78.9 steps/s
[Step=53300 Epoch=104.0] | Loss=0.00745 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.780 | L2-Norm(final)=10.860 | 5006.6 samples/s | 78.2 steps/s
[Step=53350 Epoch=104.1] | Loss=0.00737 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.782 | L2-Norm(final)=10.862 | 4888.5 samples/s | 76.4 steps/s
[Step=53400 Epoch=104.2] | Loss=0.00727 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.784 | L2-Norm(final)=10.864 | 5002.3 samples/s | 78.2 steps/s
[Step=53450 Epoch=104.2] | Loss=0.00719 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.786 | L2-Norm(final)=10.866 | 4967.9 samples/s | 77.6 steps/s
[Step=53500 Epoch=104.3] | Loss=0.00723 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.788 | L2-Norm(final)=10.868 | 5315.7 samples/s | 83.1 steps/s
[Step=53550 Epoch=104.4] | Loss=0.00712 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.789 | L2-Norm(final)=10.870 | 1987.5 samples/s | 31.1 steps/s
[Step=53600 Epoch=104.5] | Loss=0.00697 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.791 | L2-Norm(final)=10.872 | 4935.6 samples/s | 77.1 steps/s
[Step=53650 Epoch=104.6] | Loss=0.00688 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.793 | L2-Norm(final)=10.873 | 4979.4 samples/s | 77.8 steps/s
[Step=53700 Epoch=104.7] | Loss=0.00691 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.795 | L2-Norm(final)=10.875 | 4980.3 samples/s | 77.8 steps/s
[Step=53750 Epoch=104.8] | Loss=0.00688 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.796 | L2-Norm(final)=10.877 | 4908.8 samples/s | 76.7 steps/s
[Step=53800 Epoch=104.9] | Loss=0.00680 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.798 | L2-Norm(final)=10.879 | 5002.0 samples/s | 78.2 steps/s
[Step=53850 Epoch=105.0] | Loss=0.00677 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.800 | L2-Norm(final)=10.880 | 4940.0 samples/s | 77.2 steps/s
[Step=53900 Epoch=105.1] | Loss=0.00669 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.801 | L2-Norm(final)=10.882 | 4973.7 samples/s | 77.7 steps/s
[Step=53950 Epoch=105.2] | Loss=0.00659 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.803 | L2-Norm(final)=10.884 | 4968.8 samples/s | 77.6 steps/s
[Step=54000 Epoch=105.3] | Loss=0.00654 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.804 | L2-Norm(final)=10.886 | 4966.8 samples/s | 77.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step54000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=52001 Epoch=101.7] | Loss=0.00255 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=10.557 | 3851.8 samples/s | 60.2 steps/s
[Step=52050 Epoch=101.8] | Loss=0.00857 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=10.561 | 5509.7 samples/s | 86.1 steps/s
[Step=52100 Epoch=101.9] | Loss=0.00893 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.730 | L2-Norm(final)=10.564 | 5727.6 samples/s | 89.5 steps/s
[Step=52150 Epoch=102.0] | Loss=0.00927 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.730 | L2-Norm(final)=10.566 | 5646.7 samples/s | 88.2 steps/s
[Step=52200 Epoch=102.0] | Loss=0.00972 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=10.569 | 5715.8 samples/s | 89.3 steps/s
[Step=52250 Epoch=102.1] | Loss=0.00977 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=10.572 | 5698.6 samples/s | 89.0 steps/s
[Step=52300 Epoch=102.2] | Loss=0.00978 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.730 | L2-Norm(final)=10.574 | 5705.8 samples/s | 89.2 steps/s
[Step=52350 Epoch=102.3] | Loss=0.00961 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.730 | L2-Norm(final)=10.577 | 5625.1 samples/s | 87.9 steps/s
[Step=52400 Epoch=102.4] | Loss=0.00943 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=10.579 | 5733.7 samples/s | 89.6 steps/s
[Step=52450 Epoch=102.5] | Loss=0.00920 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=10.582 | 5780.7 samples/s | 90.3 steps/s
[Step=52500 Epoch=102.6] | Loss=0.00918 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.730 | L2-Norm(final)=10.585 | 7334.1 samples/s | 114.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=52501 Epoch=102.6] | Loss=0.00439 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=10.613 | 4049.9 samples/s | 63.3 steps/s
[Step=52550 Epoch=102.7] | Loss=0.00874 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.733 | L2-Norm(final)=10.616 | 4614.4 samples/s | 72.1 steps/s
[Step=52600 Epoch=102.8] | Loss=0.00797 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.738 | L2-Norm(final)=10.618 | 4952.2 samples/s | 77.4 steps/s
[Step=52650 Epoch=102.9] | Loss=0.00859 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.743 | L2-Norm(final)=10.621 | 4985.4 samples/s | 77.9 steps/s
[Step=52700 Epoch=103.0] | Loss=0.00859 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.746 | L2-Norm(final)=10.622 | 4938.4 samples/s | 77.2 steps/s
[Step=52750 Epoch=103.1] | Loss=0.00865 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.749 | L2-Norm(final)=10.624 | 4944.8 samples/s | 77.3 steps/s
[Step=52800 Epoch=103.2] | Loss=0.00851 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.752 | L2-Norm(final)=10.626 | 4967.1 samples/s | 77.6 steps/s
[Step=52850 Epoch=103.3] | Loss=0.00842 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=10.628 | 4985.4 samples/s | 77.9 steps/s
[Step=52900 Epoch=103.4] | Loss=0.00835 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.757 | L2-Norm(final)=10.629 | 4978.6 samples/s | 77.8 steps/s
[Step=52950 Epoch=103.5] | Loss=0.00812 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.760 | L2-Norm(final)=10.631 | 5066.9 samples/s | 79.2 steps/s
[Step=53000 Epoch=103.6] | Loss=0.00825 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.762 | L2-Norm(final)=10.633 | 6073.9 samples/s | 94.9 steps/s
[Step=53050 Epoch=103.7] | Loss=0.00805 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.764 | L2-Norm(final)=10.635 | 1940.2 samples/s | 30.3 steps/s
[Step=53100 Epoch=103.8] | Loss=0.00780 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.766 | L2-Norm(final)=10.637 | 4885.9 samples/s | 76.3 steps/s
[Step=53150 Epoch=103.9] | Loss=0.00760 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=10.639 | 4916.4 samples/s | 76.8 steps/s
[Step=53200 Epoch=104.0] | Loss=0.00764 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.771 | L2-Norm(final)=10.641 | 4933.0 samples/s | 77.1 steps/s
[Step=53250 Epoch=104.1] | Loss=0.00745 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.773 | L2-Norm(final)=10.643 | 4950.9 samples/s | 77.4 steps/s
[Step=53300 Epoch=104.2] | Loss=0.00733 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.775 | L2-Norm(final)=10.645 | 5049.0 samples/s | 78.9 steps/s
[Step=53350 Epoch=104.3] | Loss=0.00720 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.776 | L2-Norm(final)=10.647 | 4910.8 samples/s | 76.7 steps/s
[Step=53400 Epoch=104.4] | Loss=0.00710 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.778 | L2-Norm(final)=10.648 | 5019.6 samples/s | 78.4 steps/s
[Step=53450 Epoch=104.5] | Loss=0.00707 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.780 | L2-Norm(final)=10.650 | 4900.6 samples/s | 76.6 steps/s
[Step=53500 Epoch=104.6] | Loss=0.00698 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.782 | L2-Norm(final)=10.652 | 5426.3 samples/s | 84.8 steps/s
[Step=53550 Epoch=104.7] | Loss=0.00693 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.783 | L2-Norm(final)=10.654 | 2000.4 samples/s | 31.3 steps/s
[Step=53600 Epoch=104.8] | Loss=0.00689 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.785 | L2-Norm(final)=10.656 | 4948.5 samples/s | 77.3 steps/s
[Step=53650 Epoch=104.9] | Loss=0.00683 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.787 | L2-Norm(final)=10.657 | 4943.3 samples/s | 77.2 steps/s
[Step=53700 Epoch=105.0] | Loss=0.00682 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.788 | L2-Norm(final)=10.659 | 5008.5 samples/s | 78.3 steps/s
[Step=53750 Epoch=105.1] | Loss=0.00668 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.790 | L2-Norm(final)=10.661 | 4948.3 samples/s | 77.3 steps/s
[Step=53800 Epoch=105.2] | Loss=0.00658 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.791 | L2-Norm(final)=10.663 | 4932.3 samples/s | 77.1 steps/s
[Step=53850 Epoch=105.3] | Loss=0.00656 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.793 | L2-Norm(final)=10.664 | 4992.8 samples/s | 78.0 steps/s
[Step=53900 Epoch=105.4] | Loss=0.00652 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.794 | L2-Norm(final)=10.666 | 4938.7 samples/s | 77.2 steps/s
[Step=53950 Epoch=105.5] | Loss=0.00642 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.796 | L2-Norm(final)=10.668 | 4976.3 samples/s | 77.8 steps/s
[Step=54000 Epoch=105.6] | Loss=0.00636 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.797 | L2-Norm(final)=10.670 | 4976.4 samples/s | 77.8 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step54000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07241 | acc=0.9699 | tpr=0.9787 | fpr=0.0491 | 4419.1 samples/s | 17.3 steps/s
Avg test loss: 0.07421, Avg test acc: 0.96747, Avg tpr: 0.97634, Avg fpr: 0.05204, total FA: 406

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06902 | acc=0.9698 | tpr=0.9760 | fpr=0.0436 | 4379.0 samples/s | 17.1 steps/s
Avg test loss: 0.07339, Avg test acc: 0.96759, Avg tpr: 0.97505, Avg fpr: 0.04884, total FA: 381

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.23295 | acc=0.2898 | tpr=0.0131 | fpr=0.1093 | 4367.2 samples/s | 17.1 steps/s
Avg test loss: 6.23601, Avg test acc: 0.28784, Avg tpr: 0.01480, Avg fpr: 0.11165, total FA: 871

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.88313 | acc=0.2929 | tpr=0.0131 | fpr=0.0996 | 4355.7 samples/s | 17.0 steps/s
Avg test loss: 5.89095, Avg test acc: 0.29025, Avg tpr: 0.01504, Avg fpr: 0.10447, total FA: 815

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.18278 | acc=0.1300 | tpr=0.6106 | fpr=0.8786 | 4328.4 samples/s | 16.9 steps/s
[Step= 100] | Loss=5.15906 | acc=0.1327 | tpr=0.6397 | fpr=0.8767 | 8664.9 samples/s | 33.8 steps/s
[Step= 150] | Loss=5.16270 | acc=0.1324 | tpr=0.6254 | fpr=0.8767 | 8900.2 samples/s | 34.8 steps/s
[Step= 200] | Loss=5.15323 | acc=0.1331 | tpr=0.6175 | fpr=0.8757 | 8978.8 samples/s | 35.1 steps/s
[Step= 250] | Loss=5.15114 | acc=0.1331 | tpr=0.6026 | fpr=0.8754 | 8095.1 samples/s | 31.6 steps/s
[Step= 300] | Loss=5.14616 | acc=0.1336 | tpr=0.6036 | fpr=0.8750 | 8760.2 samples/s | 34.2 steps/s
[Step= 350] | Loss=5.14305 | acc=0.1330 | tpr=0.6074 | fpr=0.8756 | 8767.0 samples/s | 34.2 steps/s
[Step= 400] | Loss=5.13771 | acc=0.1326 | tpr=0.6111 | fpr=0.8761 | 8524.7 samples/s | 33.3 steps/s
[Step= 450] | Loss=5.13469 | acc=0.1326 | tpr=0.6159 | fpr=0.8762 | 8854.7 samples/s | 34.6 steps/s
[Step= 500] | Loss=5.13722 | acc=0.1326 | tpr=0.6167 | fpr=0.8761 | 8574.9 samples/s | 33.5 steps/s
[Step= 550] | Loss=5.13791 | acc=0.1328 | tpr=0.6144 | fpr=0.8759 | 15726.2 samples/s | 61.4 steps/s
Avg test loss: 5.13872, Avg test acc: 0.13270, Avg tpr: 0.61450, Avg fpr: 0.87606, total FA: 121639

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.04458 | acc=0.1436 | tpr=0.5929 | fpr=0.8645 | 4333.7 samples/s | 16.9 steps/s
[Step= 100] | Loss=5.02315 | acc=0.1460 | tpr=0.6183 | fpr=0.8628 | 8505.8 samples/s | 33.2 steps/s
[Step= 150] | Loss=5.02487 | acc=0.1461 | tpr=0.6066 | fpr=0.8624 | 8850.1 samples/s | 34.6 steps/s
[Step= 200] | Loss=5.01509 | acc=0.1470 | tpr=0.5989 | fpr=0.8612 | 8546.9 samples/s | 33.4 steps/s
[Step= 250] | Loss=5.01355 | acc=0.1471 | tpr=0.5878 | fpr=0.8609 | 8719.9 samples/s | 34.1 steps/s
[Step= 300] | Loss=5.00941 | acc=0.1477 | tpr=0.5898 | fpr=0.8604 | 8593.0 samples/s | 33.6 steps/s
[Step= 350] | Loss=5.00577 | acc=0.1470 | tpr=0.5911 | fpr=0.8610 | 8896.7 samples/s | 34.8 steps/s
[Step= 400] | Loss=4.99963 | acc=0.1470 | tpr=0.5935 | fpr=0.8611 | 8607.5 samples/s | 33.6 steps/s
[Step= 450] | Loss=4.99601 | acc=0.1472 | tpr=0.5993 | fpr=0.8610 | 8726.4 samples/s | 34.1 steps/s
[Step= 500] | Loss=4.99866 | acc=0.1472 | tpr=0.6013 | fpr=0.8610 | 8800.7 samples/s | 34.4 steps/s
[Step= 550] | Loss=4.99944 | acc=0.1473 | tpr=0.5993 | fpr=0.8609 | 15448.6 samples/s | 60.3 steps/s
Avg test loss: 5.00032, Avg test acc: 0.14714, Avg tpr: 0.59945, Avg fpr: 0.86108, total FA: 119559

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12472 | acc=0.9809 | tpr=0.9558 | fpr=0.0187 | 4349.3 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.13356 | acc=0.9794 | tpr=0.9638 | fpr=0.0203 | 8986.2 samples/s | 35.1 steps/s
[Step= 150] | Loss=0.13876 | acc=0.9785 | tpr=0.9611 | fpr=0.0212 | 8404.6 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.13882 | acc=0.9790 | tpr=0.9628 | fpr=0.0207 | 8759.5 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.13696 | acc=0.9793 | tpr=0.9624 | fpr=0.0204 | 8651.7 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.13829 | acc=0.9791 | tpr=0.9644 | fpr=0.0206 | 8531.0 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.13896 | acc=0.9790 | tpr=0.9656 | fpr=0.0208 | 8995.1 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.14056 | acc=0.9786 | tpr=0.9617 | fpr=0.0211 | 8428.8 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.14398 | acc=0.9784 | tpr=0.9596 | fpr=0.0213 | 8805.1 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.14318 | acc=0.9784 | tpr=0.9604 | fpr=0.0213 | 8628.8 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.14192 | acc=0.9785 | tpr=0.9602 | fpr=0.0211 | 15590.9 samples/s | 60.9 steps/s
Avg test loss: 0.14163, Avg test acc: 0.97855, Avg tpr: 0.96038, Avg fpr: 0.02112, total FA: 2932

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12677 | acc=0.9800 | tpr=0.9558 | fpr=0.0196 | 4353.4 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.13589 | acc=0.9789 | tpr=0.9680 | fpr=0.0209 | 8589.9 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.14163 | acc=0.9780 | tpr=0.9654 | fpr=0.0218 | 8718.2 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.14164 | acc=0.9783 | tpr=0.9661 | fpr=0.0215 | 8705.5 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.13937 | acc=0.9786 | tpr=0.9651 | fpr=0.0212 | 8567.3 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.14095 | acc=0.9782 | tpr=0.9658 | fpr=0.0215 | 8564.5 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.14188 | acc=0.9781 | tpr=0.9662 | fpr=0.0217 | 8899.2 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.14345 | acc=0.9777 | tpr=0.9623 | fpr=0.0220 | 8595.0 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.14674 | acc=0.9776 | tpr=0.9601 | fpr=0.0221 | 8860.2 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.14616 | acc=0.9776 | tpr=0.9612 | fpr=0.0221 | 8602.9 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.14487 | acc=0.9777 | tpr=0.9602 | fpr=0.0220 | 15634.3 samples/s | 61.1 steps/s
Avg test loss: 0.14455, Avg test acc: 0.97767, Avg tpr: 0.96038, Avg fpr: 0.02202, total FA: 3057

server round 49/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=54001 Epoch=105.6] | Loss=0.00509 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.635 | L2-Norm(final)=10.721 | 3922.6 samples/s | 61.3 steps/s
[Step=54050 Epoch=105.7] | Loss=0.00868 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.635 | L2-Norm(final)=10.723 | 5307.6 samples/s | 82.9 steps/s
[Step=54100 Epoch=105.8] | Loss=0.00902 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.635 | L2-Norm(final)=10.722 | 5699.7 samples/s | 89.1 steps/s
[Step=54150 Epoch=105.9] | Loss=0.00853 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.635 | L2-Norm(final)=10.721 | 5693.4 samples/s | 89.0 steps/s
[Step=54200 Epoch=106.0] | Loss=0.00876 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.636 | L2-Norm(final)=10.721 | 5655.0 samples/s | 88.4 steps/s
[Step=54250 Epoch=106.1] | Loss=0.00888 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.636 | L2-Norm(final)=10.720 | 5729.0 samples/s | 89.5 steps/s
[Step=54300 Epoch=106.2] | Loss=0.00871 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.636 | L2-Norm(final)=10.720 | 5686.2 samples/s | 88.8 steps/s
[Step=54350 Epoch=106.3] | Loss=0.00888 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.636 | L2-Norm(final)=10.719 | 5709.5 samples/s | 89.2 steps/s
[Step=54400 Epoch=106.4] | Loss=0.00914 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.636 | L2-Norm(final)=10.718 | 5724.3 samples/s | 89.4 steps/s
[Step=54450 Epoch=106.4] | Loss=0.00949 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.636 | L2-Norm(final)=10.718 | 5715.9 samples/s | 89.3 steps/s
[Step=54500 Epoch=106.5] | Loss=0.00940 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.636 | L2-Norm(final)=10.717 | 7315.7 samples/s | 114.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step54500.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=48001 Epoch=184.8] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.635 | L2-Norm(final)=12.518 | 3789.4 samples/s | 59.2 steps/s
[Step=48050 Epoch=185.0] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=12.524 | 5062.5 samples/s | 79.1 steps/s
[Step=48100 Epoch=185.2] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=12.531 | 5437.1 samples/s | 85.0 steps/s
[Step=48150 Epoch=185.3] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=12.538 | 5288.8 samples/s | 82.6 steps/s
[Step=48200 Epoch=185.5] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=12.544 | 5454.9 samples/s | 85.2 steps/s
[Step=48250 Epoch=185.7] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=12.550 | 6994.9 samples/s | 109.3 steps/s
[Step=48300 Epoch=185.9] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=12.556 | 1928.2 samples/s | 30.1 steps/s
[Step=48350 Epoch=186.1] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=12.562 | 5187.7 samples/s | 81.1 steps/s
[Step=48400 Epoch=186.3] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.625 | L2-Norm(final)=12.568 | 5273.8 samples/s | 82.4 steps/s
[Step=48450 Epoch=186.5] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.625 | L2-Norm(final)=12.574 | 5413.7 samples/s | 84.6 steps/s
[Step=48500 Epoch=186.7] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.625 | L2-Norm(final)=12.580 | 6084.7 samples/s | 95.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step48500.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07241 | acc=0.9699 | tpr=0.9787 | fpr=0.0491 | 4303.2 samples/s | 16.8 steps/s
Avg test loss: 0.07421, Avg test acc: 0.96747, Avg tpr: 0.97634, Avg fpr: 0.05204, total FA: 406

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06545 | acc=0.9682 | tpr=0.9723 | fpr=0.0406 | 4408.0 samples/s | 17.2 steps/s
Avg test loss: 0.06853, Avg test acc: 0.96646, Avg tpr: 0.97074, Avg fpr: 0.04294, total FA: 335

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.23295 | acc=0.2898 | tpr=0.0131 | fpr=0.1093 | 4435.3 samples/s | 17.3 steps/s
Avg test loss: 6.23601, Avg test acc: 0.28784, Avg tpr: 0.01480, Avg fpr: 0.11165, total FA: 871

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.36548 | acc=0.2952 | tpr=0.0180 | fpr=0.1031 | 4319.5 samples/s | 16.9 steps/s
Avg test loss: 5.37108, Avg test acc: 0.29305, Avg tpr: 0.01929, Avg fpr: 0.10486, total FA: 818

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.18278 | acc=0.1300 | tpr=0.6106 | fpr=0.8786 | 4344.2 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.15906 | acc=0.1327 | tpr=0.6397 | fpr=0.8767 | 8723.4 samples/s | 34.1 steps/s
[Step= 150] | Loss=5.16270 | acc=0.1324 | tpr=0.6254 | fpr=0.8767 | 8720.7 samples/s | 34.1 steps/s
[Step= 200] | Loss=5.15323 | acc=0.1331 | tpr=0.6175 | fpr=0.8757 | 8587.8 samples/s | 33.5 steps/s
[Step= 250] | Loss=5.15114 | acc=0.1331 | tpr=0.6026 | fpr=0.8754 | 8500.6 samples/s | 33.2 steps/s
[Step= 300] | Loss=5.14616 | acc=0.1336 | tpr=0.6036 | fpr=0.8750 | 8874.6 samples/s | 34.7 steps/s
[Step= 350] | Loss=5.14305 | acc=0.1330 | tpr=0.6074 | fpr=0.8756 | 8577.0 samples/s | 33.5 steps/s
[Step= 400] | Loss=5.13771 | acc=0.1326 | tpr=0.6111 | fpr=0.8761 | 8729.5 samples/s | 34.1 steps/s
[Step= 450] | Loss=5.13469 | acc=0.1326 | tpr=0.6159 | fpr=0.8762 | 9094.1 samples/s | 35.5 steps/s
[Step= 500] | Loss=5.13722 | acc=0.1326 | tpr=0.6167 | fpr=0.8761 | 8379.6 samples/s | 32.7 steps/s
[Step= 550] | Loss=5.13791 | acc=0.1328 | tpr=0.6144 | fpr=0.8759 | 15565.4 samples/s | 60.8 steps/s
Avg test loss: 5.13872, Avg test acc: 0.13270, Avg tpr: 0.61450, Avg fpr: 0.87606, total FA: 121639

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.08196 | acc=0.1555 | tpr=0.5664 | fpr=0.8519 | 4350.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=4.06362 | acc=0.1581 | tpr=0.5928 | fpr=0.8500 | 8585.0 samples/s | 33.5 steps/s
[Step= 150] | Loss=4.06854 | acc=0.1578 | tpr=0.5793 | fpr=0.8499 | 8683.0 samples/s | 33.9 steps/s
[Step= 200] | Loss=4.05986 | acc=0.1583 | tpr=0.5694 | fpr=0.8492 | 8631.4 samples/s | 33.7 steps/s
[Step= 250] | Loss=4.05775 | acc=0.1584 | tpr=0.5598 | fpr=0.8489 | 8677.1 samples/s | 33.9 steps/s
[Step= 300] | Loss=4.05352 | acc=0.1591 | tpr=0.5651 | fpr=0.8483 | 8932.0 samples/s | 34.9 steps/s
[Step= 350] | Loss=4.04966 | acc=0.1585 | tpr=0.5654 | fpr=0.8489 | 8565.6 samples/s | 33.5 steps/s
[Step= 400] | Loss=4.04453 | acc=0.1583 | tpr=0.5684 | fpr=0.8491 | 8737.9 samples/s | 34.1 steps/s
[Step= 450] | Loss=4.04159 | acc=0.1586 | tpr=0.5740 | fpr=0.8490 | 9482.4 samples/s | 37.0 steps/s
[Step= 500] | Loss=4.04433 | acc=0.1587 | tpr=0.5749 | fpr=0.8488 | 8438.8 samples/s | 33.0 steps/s
[Step= 550] | Loss=4.04532 | acc=0.1588 | tpr=0.5710 | fpr=0.8487 | 14295.1 samples/s | 55.8 steps/s
Avg test loss: 4.04583, Avg test acc: 0.15862, Avg tpr: 0.57132, Avg fpr: 0.84888, total FA: 117865

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12472 | acc=0.9809 | tpr=0.9558 | fpr=0.0187 | 4378.5 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.13356 | acc=0.9794 | tpr=0.9638 | fpr=0.0203 | 8551.6 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.13876 | acc=0.9785 | tpr=0.9611 | fpr=0.0212 | 8880.4 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.13882 | acc=0.9790 | tpr=0.9628 | fpr=0.0207 | 8656.9 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.13696 | acc=0.9793 | tpr=0.9624 | fpr=0.0204 | 8758.7 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.13829 | acc=0.9791 | tpr=0.9644 | fpr=0.0206 | 8449.4 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.13896 | acc=0.9790 | tpr=0.9656 | fpr=0.0208 | 8609.2 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.14056 | acc=0.9786 | tpr=0.9617 | fpr=0.0211 | 8715.8 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.14398 | acc=0.9784 | tpr=0.9596 | fpr=0.0213 | 8977.1 samples/s | 35.1 steps/s
[Step= 500] | Loss=0.14318 | acc=0.9784 | tpr=0.9604 | fpr=0.0213 | 8374.2 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.14192 | acc=0.9785 | tpr=0.9602 | fpr=0.0211 | 15569.1 samples/s | 60.8 steps/s
Avg test loss: 0.14163, Avg test acc: 0.97855, Avg tpr: 0.96038, Avg fpr: 0.02112, total FA: 2932

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12222 | acc=0.9789 | tpr=0.9558 | fpr=0.0207 | 4348.3 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.13077 | acc=0.9776 | tpr=0.9701 | fpr=0.0222 | 8512.3 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.13612 | acc=0.9767 | tpr=0.9654 | fpr=0.0231 | 8578.5 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.13583 | acc=0.9771 | tpr=0.9650 | fpr=0.0226 | 8958.4 samples/s | 35.0 steps/s
[Step= 250] | Loss=0.13402 | acc=0.9775 | tpr=0.9642 | fpr=0.0223 | 8597.2 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.13544 | acc=0.9772 | tpr=0.9651 | fpr=0.0226 | 8604.9 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.13613 | acc=0.9770 | tpr=0.9656 | fpr=0.0228 | 8833.7 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.13765 | acc=0.9767 | tpr=0.9623 | fpr=0.0231 | 8760.4 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.14078 | acc=0.9765 | tpr=0.9601 | fpr=0.0232 | 8389.8 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.14014 | acc=0.9765 | tpr=0.9612 | fpr=0.0232 | 8811.6 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.13893 | acc=0.9767 | tpr=0.9610 | fpr=0.0231 | 15123.3 samples/s | 59.1 steps/s
Avg test loss: 0.13863, Avg test acc: 0.97666, Avg tpr: 0.96117, Avg fpr: 0.02305, total FA: 3201
